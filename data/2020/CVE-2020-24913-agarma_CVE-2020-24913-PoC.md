# CVE-2020-24913

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-24913-agarma_CVE-2020-24913-PoC.md](../2020/CVE-2020-24913-agarma_CVE-2020-24913-PoC.md)

# CVE-2020-24913

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-24913-agarma_CVE-2020-24913-PoC.md](../2020/CVE-2020-24913-agarma_CVE-2020-24913-PoC.md)

## CVE-2020-24913-QCubed-SQL注入

**漏洞编号:** CVE-2020-24913

**漏洞类型:** SQL注入

**影响应用:** QCubed

**危害等级:** 高危，可能导致数据泄露

**影响版本:** <= 3.1.1

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-24913是QCubed框架中profile.php文件存在的一个SQL注入漏洞，影响所有版本，包括3.1.1。该漏洞位于profile.php文件的`strQuery`参数，攻击者可以通过构造恶意SQL代码的POST请求，未经身份验证即可访问数据库。

**有效性：**

提供的PoC代码是有效的。PoC使用基于时间的盲注方法，因为无法使用堆叠查询。它展示了如何通过注入`SLEEP()`函数来判断条件是否为真，以此来提取数据库信息。通过控制`strProfileData`参数中的序列化数据和base64编码，攻击者可以执行任意SQL查询。

**投毒风险：**

该PoC仓库的主要目的是演示CVE-2020-24913漏洞，并没有明显的恶意代码。但是，任何公开的PoC都存在被修改并加入恶意代码的风险。该仓库的投毒风险评估为10%，主要考虑以下因素：

*   **代码复杂性：** PoC代码相对简单，更容易审查，降低了隐藏恶意代码的可能性。
*   **开发者信誉：** 开发者agarma在GitHub上公开了PoC，表明其意图是公开漏洞信息而非恶意攻击。
*   **社区审查：** 任何公开的PoC都会受到安全社区的审查，有助于发现潜在的恶意代码。

即便如此，用户在使用任何第三方PoC时都应该谨慎，仔细审查代码，并在隔离环境中进行测试，以避免潜在的风险。

**利用方式：**

1.  攻击者向`profile.php`发送一个POST请求，其中包含名为`strProfileData`的参数。
2.  `strProfileData`参数的值是一个经过base64编码的PHP序列化数组。
3.  该数组包含一个键为`strQuery`的元素，其值是攻击者注入的恶意SQL代码。
4.  服务器在处理`strQuery`参数时没有进行充分的过滤或转义，导致SQL注入漏洞。
5.  攻击者可以使用基于时间的盲注来提取数据库信息，例如数据库版本、表名、列名和数据。
6. PoC中使用 `SLEEP()` 函数来判断SQL查询条件真假，从而推断出数据库信息。

**修复建议：**

*   对所有用户输入进行严格的验证和过滤。
*   使用参数化查询或预编译语句来防止SQL注入。
*   升级到QCubed的最新版本，或应用官方提供的安全补丁。

**项目地址:** [agarma/CVE-2020-24913-PoC](https://github.com/agarma/CVE-2020-24913-PoC)

**漏洞详情:** [CVE-2020-24913](https://nvd.nist.gov/vuln/detail/CVE-2020-24913)

---

## POC #2

**来源**: [CVE-2020-24913-shpaw415_CVE-2020-24913-exploit.md](../2020/CVE-2020-24913-shpaw415_CVE-2020-24913-exploit.md)

## CVE-2020-24913-QCubed-SQL注入

**漏洞编号:** CVE-2020-24913

**漏洞类型:** SQL注入

**影响应用:** QCubed

**危害等级:** 高危，可能导致数据库信息泄露

**影响版本:** <= 3.1.1 (所有版本)

**利用条件:** 目标系统运行QCubed框架，且profile.php文件可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2020-24913是QCubed框架profile.php文件中strQuery参数存在的SQL注入漏洞。该漏洞允许未经身份验证的攻击者通过构造恶意SQL语句来访问数据库。

**有效性：**
提供的PoC代码看起来有效，因为它提供了测试漏洞是否存在、创建会话、暴力破解表名和列名、以及提取数据的工具。PoC代码中的不同模式针对SQL注入漏洞利用的不同阶段。

**投毒风险：**
PoC代码的投毒风险较低，大约为10%。虽然代码本身看起来是为漏洞利用而设计的，但仍存在潜在的风险：
*   `args.ts`文件中的参数解析部分存在一定的风险。如果目标URL或其他参数被恶意构造，可能会导致意外行为。例如，虽然目前没有直接的`eval`或`exec`函数，但代码如果被修改，攻击者可能会引入恶意代码。
*   依赖管理：该PoC使用`bun install`安装依赖。依赖项本身可能包含恶意代码。
*   文件名/目录名：虽然不太可能，但目录名`/tmp/57a29f3a9a33fab6ea96bbdef1d41a85/`本身很奇怪。这可能是为了隐藏恶意活动，或者只是自动生成的名字。

**利用方式：**
漏洞利用方式如下：
1.  **漏洞检测：** 使用`bun run exploit vulnerable -u <target_url>`检测目标系统是否存在漏洞。
2.  **创建会话：** 使用`bun run exploit create -n <session_name> -u <target_url>`创建一个新的会话，用于存储目标信息。
3.  **表名暴力破解：** 使用`bun run exploit brute-table -n <session_name> -w <wordlist_path>`暴力破解数据库表名。需要提供一个包含常见表名的字典文件。
4.  **列名暴力破解：** 使用`bun run exploit brute-column -n <session_name> -t <table_name> -c <column_name> -i 1`暴力破解指定表的列名。 
5.  **数据提取：** 使用`bun run exploit show-rows -n <session_name> -t <table_name>`提取指定表的数据。

通过上述步骤，攻击者可以逐步获取数据库中的敏感信息。

**项目地址:** [shpaw415/CVE-2020-24913-exploit](https://github.com/shpaw415/CVE-2020-24913-exploit)

**漏洞详情:** [CVE-2020-24913](https://nvd.nist.gov/vuln/detail/CVE-2020-24913)

---



---

## POC #2

**来源**: [CVE-2020-24913-shpaw415_CVE-2020-24913-exploit.md](../2020/CVE-2020-24913-shpaw415_CVE-2020-24913-exploit.md)

## CVE-2020-24913-QCubed-SQL注入

**漏洞编号:** CVE-2020-24913

**漏洞类型:** SQL注入

**影响应用:** QCubed

**危害等级:** 高危，可能导致数据库信息泄露

**影响版本:** <= 3.1.1 (所有版本)

**利用条件:** 目标系统运行QCubed框架，且profile.php文件可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2020-24913是QCubed框架profile.php文件中strQuery参数存在的SQL注入漏洞。该漏洞允许未经身份验证的攻击者通过构造恶意SQL语句来访问数据库。

**有效性：**
提供的PoC代码看起来有效，因为它提供了测试漏洞是否存在、创建会话、暴力破解表名和列名、以及提取数据的工具。PoC代码中的不同模式针对SQL注入漏洞利用的不同阶段。

**投毒风险：**
PoC代码的投毒风险较低，大约为10%。虽然代码本身看起来是为漏洞利用而设计的，但仍存在潜在的风险：
*   `args.ts`文件中的参数解析部分存在一定的风险。如果目标URL或其他参数被恶意构造，可能会导致意外行为。例如，虽然目前没有直接的`eval`或`exec`函数，但代码如果被修改，攻击者可能会引入恶意代码。
*   依赖管理：该PoC使用`bun install`安装依赖。依赖项本身可能包含恶意代码。
*   文件名/目录名：虽然不太可能，但目录名`/tmp/57a29f3a9a33fab6ea96bbdef1d41a85/`本身很奇怪。这可能是为了隐藏恶意活动，或者只是自动生成的名字。

**利用方式：**
漏洞利用方式如下：
1.  **漏洞检测：** 使用`bun run exploit vulnerable -u <target_url>`检测目标系统是否存在漏洞。
2.  **创建会话：** 使用`bun run exploit create -n <session_name> -u <target_url>`创建一个新的会话，用于存储目标信息。
3.  **表名暴力破解：** 使用`bun run exploit brute-table -n <session_name> -w <wordlist_path>`暴力破解数据库表名。需要提供一个包含常见表名的字典文件。
4.  **列名暴力破解：** 使用`bun run exploit brute-column -n <session_name> -t <table_name> -c <column_name> -i 1`暴力破解指定表的列名。 
5.  **数据提取：** 使用`bun run exploit show-rows -n <session_name> -t <table_name>`提取指定表的数据。

通过上述步骤，攻击者可以逐步获取数据库中的敏感信息。

**项目地址:** [shpaw415/CVE-2020-24913-exploit](https://github.com/shpaw415/CVE-2020-24913-exploit)

**漏洞详情:** [CVE-2020-24913](https://nvd.nist.gov/vuln/detail/CVE-2020-24913)

---

