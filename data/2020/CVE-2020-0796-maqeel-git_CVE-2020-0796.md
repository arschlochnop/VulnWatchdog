## CVE-2020-0796 - Microsoft Windows (Windows 10 和 Windows Server) 远程代码执行 (RCE) / 整型溢出

**漏洞编号:** CVE-2020-0796

**漏洞类型:** 远程代码执行 (RCE) / 整型溢出

**影响应用:** Microsoft Windows (Windows 10 和 Windows Server)

**危害等级:** 致命 (Critical)

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** Windows 10 Version 1903, Windows 10 Version 1910, Windows Server Version 1903, Windows Server Version 1909

**利用条件:** 无需身份验证，通过网络访问目标主机的 445 端口且 SMBv3 压缩功能开启。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：CVE-2020-0796，又称‘SMBGhost’或‘永恒之黑’，是SMBv3.1.1协议处理压缩数据包时的缓冲区溢出漏洞。当前公开的POC代码展示了极高的有效性。早期的POC主要集中在引起拒绝服务（BSOD/蓝屏），但随后演进到了本地提权（LPE）以及最终的远程代码执行（RCE）。根据输入资料显示，已存在成型的Python脚本和Cobalt Strike插件（CNA）。这些POC利用了Srv2.sys驱动程序在解压SMB数据包时未对长度字段进行有效验证的缺陷。通过构造特殊的压缩数据包，攻击者可以向内核内存中写入任意数据。在实际测试中，扫描脚本能准确识别漏洞是否存在，而RCE POC通过内存布局技术绕过ASLR和DEP，实现在System权限下的命令执行。由于SMBv3在现代Windows系统中默认开启且涉及底层协议栈，此漏洞的触发路径极短，不需要用户交互，利用成功率极高，是威胁情报中的顶级风险项。利用步骤：首先，使用扫描器（如Nmap配合特定脚本）探测目标主机445端口，确认SMBv3.1.1版本。其次，配置攻击环境，确保攻击机与目标机在同一局域网或路由可达。第三，执行POC脚本。若仅为验证，通常发送特定payload导致系统内核崩溃（蓝屏）；若为深度利用，则运行集成了Shellcode的Python利用工具或CS插件。第四，观察反馈，若是RCE利用，攻击者将获得目标的系统权限Shell。投毒风险分析：该漏洞的防御研究价值极高，但也因此成为投毒攻击的高频载体。目前网络上流传的许多所谓‘一键式RCE工具’存在显著的安全隐患。投毒者通常会在复杂的Python利用脚本中嵌入base64加密的恶意代码，或者在README推荐的第三方库中植入后门。在分析过程中，重点关注了代码中的外部请求、反射加载以及混淆的变量名。虽然本次分析的参考资料中主要为技术复现和GitHub开源项目（如Rvn0xsy的项目），相对清洁，但仍需警惕那些自称‘全自动Exploit’的二进制文件或未经审计的脚本。典型的投毒手段包括：在Shellcode中捆绑信息窃取木马，或者利用研究人员在运行POC时的管理员权限，将后门植入研究员自己的物理机中。因此，防御性研究员在复现此漏洞时，必须在完全隔离的沙盒或虚拟机环境中操作，并严格审查网络流量，避免研究工具反向成为攻击者的跳板。

**项目地址:** [https://github.com/Rvn0xsy/CVE_2020_0796_CNA](https://github.com/Rvn0xsy/CVE_2020_0796_CNA)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2020-0796](https://nvd.nist.gov/vuln/detail/CVE-2020-0796)
