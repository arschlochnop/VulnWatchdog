# CVE-2020-16898

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-16898-0xeb-bp_cve-2020-16898.md](../2020/CVE-2020-16898-0xeb-bp_cve-2020-16898.md)

## CVE-2020-16898-Windows TCP/IP远程代码执行

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows TCP/IP 栈

**危害等级:** 高危，可能导致远程代码执行和系统崩溃（蓝屏）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, 1909, 2004

**利用条件:** 目标系统需要启用IPv6，且攻击者需要位于与目标系统相同的网络段或能够发送ICMPv6 Router Advertisement 数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898是一个Windows TCP/IP栈中的远程代码执行漏洞。当Windows TCP/IP栈不正确地处理ICMPv6 Router Advertisement数据包时，存在此漏洞。攻击者可以通过发送特制的ICMPv6 Router Advertisement数据包到远程Windows计算机来利用此漏洞。 

**利用方式：**

1.  **发送恶意ICMPv6 RA数据包：** 攻击者构造包含特制选项类型25的ICMPv6 Router Advertisement (RA) 数据包。根据搜索引擎返回的信息，该数据包是利用Option Type 25。从PoC代码来看，它使用了类型18和19的选项，并结合了IPv6扩展头部的分片功能。
2.  **触发栈溢出：** 恶意数据包中的错误处理会导致栈溢出。
3.  **远程代码执行或拒绝服务：** 成功利用此漏洞可能允许攻击者在目标系统上执行任意代码（RCE），或导致系统崩溃（蓝屏）。PoC 代码旨在触发蓝屏死机 (BSOD)，这意味着它主要关注拒绝服务。

**POC代码分析：**

*   该PoC使用`scapy`库来构建和发送ICMPv6数据包。
*   它首先构造一个IPv6头部，设置目标IPv6地址和跳数限制。
*   然后，它创建一个ICMPv6 Router Advertisement数据包。
*   该PoC包含两个ICMPv6NDOptRDNSS选项，用于利用漏洞。第一个数据包设置长度，第二个数据包触发溢出。
*   `overwrite`变量包含用于覆盖堆栈的字符。
*   该PoC使用IPv6分片来绕过某些限制并触发漏洞。
*   最后，它将数据包分片并通过网络发送。

**有效性：**

根据PoC的描述和相关搜索结果，该PoC代码能够触发Windows 10 version 2004的蓝屏死机，表明其具有一定的有效性。PoC代码针对性较强，依赖于特定的payload和触发方式，因此可能在不同版本的Windows上有效性有所不同。漏洞库信息也显示漏洞影响多个Windows版本。

**投毒风险：**

PoC代码中存在投毒的风险较低，约为10%。主要基于以下几点：

*   该代码的目的是触发蓝屏，这本身就是一种破坏行为，但并非隐蔽的后门植入。
*   代码比较清晰，主要由scapy库的调用组成，用于构造和发送网络数据包，功能单一，专注于漏洞利用。
*   虽然可能存在隐藏恶意代码的空间（例如在`overwrite`变量中插入shellcode），但当前PoC并未发现此类行为，主要目的是系统崩溃。
*   README.md文件描述了PoC的目的和测试环境，没有迹象表明作者有意隐藏恶意功能。

然而，仍然存在一定的风险，例如：

*   攻击者可能修改PoC代码，添加恶意功能，例如植入后门，然后传播修改后的PoC。
*   即使是蓝屏攻击也可能被滥用，例如用于勒索或破坏系统。

因此，虽然直接投毒的风险较低，但仍需警惕PoC代码被恶意修改和滥用的可能性。

**项目地址:** [0xeb-bp/cve-2020-16898](https://github.com/0xeb-bp/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #2

**来源**: [CVE-2020-16898-CPO-EH_CVE-2020-16898_Checker.md](../2020/CVE-2020-16898-CPO-EH_CVE-2020-16898_Checker.md)

## CVE-2020-16898 "Bad Neighbor" Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，允许远程代码执行

**影响版本:** 受影响的Windows版本包括 Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 以及 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要能够发送特制的ICMPv6 Router Advertisement数据包到目标Windows计算机。目标系统需要启用IPv6 RDNSS。

**POC 可用性:** 是，但提供的代码仅为检测脚本

**投毒风险:** 0%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是一个存在于Windows TCP/IP栈中的远程代码执行漏洞。此漏洞是由于Windows TCP/IP栈未能正确处理ICMPv6 Router Advertisement数据包中的Option Type 25字段造成的。攻击者可以发送特制的ICMPv6 Router Advertisement数据包来触发此漏洞，从而在目标系统上执行任意代码。

**漏洞利用方式：**

1.  攻击者需要构造恶意的ICMPv6 Router Advertisement数据包，该数据包的Option Type 25字段包含畸形或过长的数据。
2.  攻击者将构造的数据包发送到目标Windows系统。
3.  目标系统在处理该数据包时，TCP/IP栈会发生错误，导致缓冲区溢出或内存损坏。
4.  攻击者可以利用此漏洞执行任意代码。

**提供的POC代码分析：**

提供的PowerShell脚本 `CVE-2020-16898_Checker.ps1` 并不是一个漏洞利用代码，而是一个检测脚本，用于检查目标系统的网络接口是否容易受到CVE-2020-16898和CVE-2020-16899的影响。它通过检查网络接口的配置，特别是IPv6 6106选项是否启用，来判断接口是否存在漏洞。该脚本本身不包含任何恶意代码，因此不存在投毒风险。

**投毒风险评估：**

根据对提供的POC代码的分析，未发现任何恶意或隐藏的代码，因此投毒风险为0%。该脚本仅用于检测漏洞的存在，而不是利用漏洞。

**项目地址:** [CPO-EH/CVE-2020-16898_Checker](https://github.com/CPO-EH/CVE-2020-16898_Checker)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #3

**来源**: [CVE-2020-16898-CPO-EH_CVE-2020-16898_Workaround.md](../2020/CVE-2020-16898-CPO-EH_CVE-2020-16898_Workaround.md)

## CVE-2020-16898

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，允许远程攻击者在目标系统上执行代码

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, Windows Server version 2004

**利用条件:** 攻击者需要与目标系统位于同一网络或能够发送 IPv6 数据包到目标系统。

**POC 可用性:** 是，存在利用代码，可触发蓝屏 (BSOD)。

**投毒风险:** 0%

## 详情

CVE-2020-16898 是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞，由于 Windows TCP/IP 协议栈对 ICMPv6 路由器通告数据包处理不当导致。攻击者通过发送特制的 ICMPv6 路由器通告数据包到远程 Windows 计算机，可能导致远程代码执行。根据搜索结果，该漏洞也被称为“Bad Neighbor”，可导致蓝屏死机 (BSOD)。 提供的 PowerShell 脚本 `VCE-2020-16898_QuickWin.ps1`  是官方提供的临时缓解方案，用于禁用受影响网络接口上的基于路由器的 DNS 配置 (RABasedDNSConfig)， 以避免受到攻击，并不是漏洞利用代码。 该脚本的目的是通过禁用受影响接口的 `rabaseddnsconfig` 来缓解漏洞，脚本功能单一，没有发现投毒代码，因此投毒风险为 0%。利用方式主要是发送恶意构造的ICMPv6路由器通告数据包，其中Option Type 25字段存在问题。

**项目地址:** [CPO-EH/CVE-2020-16898_Workaround](https://github.com/CPO-EH/CVE-2020-16898_Workaround)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #4

**来源**: [CVE-2020-16898-Maliek_CVE-2020-16898_Check.md](../2020/CVE-2020-16898-Maliek_CVE-2020-16898_Check.md)

## CVE-2020-16898 "Bad Neighbor"

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 需要与目标系统在同一网络或可路由的网络中，目标系统启用IPv6，且未安装补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-16898 是一个Windows TCP/IP 堆栈远程代码执行漏洞，存在于Windows 系统处理 ICMPv6 路由通告包时。攻击者可以通过发送特制的 ICMPv6 路由通告包到远程Windows 计算机来利用此漏洞。

**有效性：**
根据漏洞描述和搜索结果，此漏洞真实存在，并且有公开的POC。提供的 PowerShell 脚本用于检测目标系统是否存在漏洞，通过检测网卡是否启用了基于RA的DNS配置(RABasedDNSConfig)，以及Windows版本是否是受影响版本。脚本本身并不能直接利用漏洞执行代码，而是用于判断漏洞是否存在。

**投毒风险：**
查看了脚本内容，该脚本主要功能是检测目标系统是否存在CVE-2020-16898漏洞。脚本通过查询注册表和网络接口配置来判断系统和网卡是否在受影响的范围内。未发现任何可以执行恶意代码或进行后门连接的部分。因此，投毒风险为0%。

**利用方式：**
1.  **漏洞触发：** 攻击者需要发送特制的 ICMPv6 路由通告包到目标Windows 计算机。
2.  **漏洞成因：** Windows TCP/IP 堆栈在处理 ICMPv6 路由通告包时，没有正确处理Option Type 25字段，导致缓冲区溢出。
3.  **攻击效果：** 成功的利用可能导致远程代码执行，攻击者可以在目标系统上执行任意代码。
4.  **缓解措施：** 安装 Microsoft 提供的安全更新。禁用 IPv6 RDNSS 配置也可缓解此漏洞，但可能影响IPv6 功能。

**搜索结果总结：**
搜索结果证实了该漏洞的存在和严重性，并提供了关于受影响系统、利用方式和缓解措施的信息。 该漏洞也被称为“Bad Neighbor”，需要及时修复。


**项目地址:** [Maliek/CVE-2020-16898_Check](https://github.com/Maliek/CVE-2020-16898_Check)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #5

**来源**: [CVE-2020-16898-Q1984_CVE-2020-16898.md](../2020/CVE-2020-16898-Q1984_CVE-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** Windows TCP/IP 堆栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709 - 2004, Windows Server 2019, Windows Server version 2004, Windows Server, version 1903/1909

**利用条件:** 需要与目标主机处于同一网络或可发送ICMPv6 Router Advertisement数据包到目标主机。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是Windows TCP/IP堆栈中的一个远程代码执行漏洞。当Windows TCP/IP堆栈不正确地处理ICMPv6 Router Advertisement数据包时，就会出现此漏洞。攻击者可以通过发送特制的ICMPv6 Router Advertisement数据包到远程Windows计算机来利用此漏洞。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响多个Windows版本，且存在公开的PoC代码。搜索结果显示，该漏洞可能导致蓝屏死机（BSOD），进一步说明了其可能导致拒绝服务。尽管有些描述中提到远程代码执行的可能性，但提供的PoC代码的README.md文件表明该PoC主要用于触发BSOD (DoS)。因此，该PoC代码被认为是有效的，至少可以触发拒绝服务攻击。

**投毒风险：**
提供的PoC代码只包含README.md文件，文件内容描述了如何使用`CVE-2020-16898.exe`，并声明“Use at own risk!”。仅凭此信息无法判断`CVE-2020-16898.exe`是否存在恶意代码。但是，考虑到漏洞利用的敏感性，存在一定的投毒风险。由于缺少实际的可执行文件代码，投毒风险评估为低，约为10%。主要原因是无法验证可执行文件的真实功能。

**利用方式：**
1.  **目标确定：** 确定运行受影响Windows版本的计算机。
2.  **网络连接：** 攻击者需要与目标计算机位于同一网络中，或者能够向目标计算机发送ICMPv6 Router Advertisement数据包。
3.  **数据包构造：** 攻击者需要构造特制的ICMPv6 Router Advertisement数据包，其中包含恶意数据，特别是Option Type 25，可能导致缓冲区溢出。
4.  **攻击执行：** 将构造的数据包发送到目标计算机。
5.  **结果：** 成功利用此漏洞可能导致目标计算机蓝屏死机（拒绝服务），或者，如果攻击者能够绕过缓解措施，则可能执行任意代码。快速修复的可用性表示该漏洞可能会导致DoS。

**项目地址:** [Q1984/CVE-2020-16898](https://github.com/Q1984/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #6

**来源**: [CVE-2020-16898-ZephrFish_CVE-2020-16898.md](../2020/CVE-2020-16898-ZephrFish_CVE-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 目标主机开启IPv6，且与攻击者处于同一网络或攻击者能够发送ICMPv6 Router Advertisement报文到目标主机

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2020-16898 "Bad Neighbor" 漏洞存在于 Windows TCP/IP 协议栈中，当其不正确地处理 ICMPv6 路由器通告 (Router Advertisement) 报文时，可能导致远程代码执行。攻击者需要发送特制的 ICMPv6 报文到目标系统，利用Option Type 25触发漏洞。 根据提供的 exploit 代码的 README.md 文件中的描述, 该 exploit 为一个 Windows 可执行文件，需要指定目标主机和用户名。README 中特别提示 "This is a lesson as to why you should not trust binaries on the internet." 以及 "This is an educational exercise. Use at your own risk."，这暗示了此二进制文件可能存在恶意代码或后门. 因此，存在很高的投毒风险。虽然无法直接从提供的文件内容确定其是否恶意，但基于作者的明确警告，投毒的可能性较高。利用方式为，攻击者编译或直接运行提供的二进制文件，并指定目标 IP 地址和用户名，程序会发送恶意 ICMPv6 报文来尝试触发漏洞，实现远程代码执行。

根据搜索结果,此漏洞影响多个windows版本，通过发送恶意的ICMPv6数据包可以触发远程代码执行. 多个安全厂商博客都提到了这个漏洞。

综合分析，漏洞利用的有效性取决于目标系统是否存在漏洞，而投毒风险较高，建议在隔离环境中分析和测试POC。


**项目地址:** [ZephrFish/CVE-2020-16898](https://github.com/ZephrFish/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #7

**来源**: [CVE-2020-16898-advanced-threat-research_CVE-2020-16898.md](../2020/CVE-2020-16898-advanced-threat-research_CVE-2020-16898.md)

# CVE-2020-16898

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-16898-0xeb-bp_cve-2020-16898.md](../2020/CVE-2020-16898-0xeb-bp_cve-2020-16898.md)

## CVE-2020-16898-Windows TCP/IP远程代码执行

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows TCP/IP 栈

**危害等级:** 高危，可能导致远程代码执行和系统崩溃（蓝屏）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, 1909, 2004

**利用条件:** 目标系统需要启用IPv6，且攻击者需要位于与目标系统相同的网络段或能够发送ICMPv6 Router Advertisement 数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898是一个Windows TCP/IP栈中的远程代码执行漏洞。当Windows TCP/IP栈不正确地处理ICMPv6 Router Advertisement数据包时，存在此漏洞。攻击者可以通过发送特制的ICMPv6 Router Advertisement数据包到远程Windows计算机来利用此漏洞。 

**利用方式：**

1.  **发送恶意ICMPv6 RA数据包：** 攻击者构造包含特制选项类型25的ICMPv6 Router Advertisement (RA) 数据包。根据搜索引擎返回的信息，该数据包是利用Option Type 25。从PoC代码来看，它使用了类型18和19的选项，并结合了IPv6扩展头部的分片功能。
2.  **触发栈溢出：** 恶意数据包中的错误处理会导致栈溢出。
3.  **远程代码执行或拒绝服务：** 成功利用此漏洞可能允许攻击者在目标系统上执行任意代码（RCE），或导致系统崩溃（蓝屏）。PoC 代码旨在触发蓝屏死机 (BSOD)，这意味着它主要关注拒绝服务。

**POC代码分析：**

*   该PoC使用`scapy`库来构建和发送ICMPv6数据包。
*   它首先构造一个IPv6头部，设置目标IPv6地址和跳数限制。
*   然后，它创建一个ICMPv6 Router Advertisement数据包。
*   该PoC包含两个ICMPv6NDOptRDNSS选项，用于利用漏洞。第一个数据包设置长度，第二个数据包触发溢出。
*   `overwrite`变量包含用于覆盖堆栈的字符。
*   该PoC使用IPv6分片来绕过某些限制并触发漏洞。
*   最后，它将数据包分片并通过网络发送。

**有效性：**

根据PoC的描述和相关搜索结果，该PoC代码能够触发Windows 10 version 2004的蓝屏死机，表明其具有一定的有效性。PoC代码针对性较强，依赖于特定的payload和触发方式，因此可能在不同版本的Windows上有效性有所不同。漏洞库信息也显示漏洞影响多个Windows版本。

**投毒风险：**

PoC代码中存在投毒的风险较低，约为10%。主要基于以下几点：

*   该代码的目的是触发蓝屏，这本身就是一种破坏行为，但并非隐蔽的后门植入。
*   代码比较清晰，主要由scapy库的调用组成，用于构造和发送网络数据包，功能单一，专注于漏洞利用。
*   虽然可能存在隐藏恶意代码的空间（例如在`overwrite`变量中插入shellcode），但当前PoC并未发现此类行为，主要目的是系统崩溃。
*   README.md文件描述了PoC的目的和测试环境，没有迹象表明作者有意隐藏恶意功能。

然而，仍然存在一定的风险，例如：

*   攻击者可能修改PoC代码，添加恶意功能，例如植入后门，然后传播修改后的PoC。
*   即使是蓝屏攻击也可能被滥用，例如用于勒索或破坏系统。

因此，虽然直接投毒的风险较低，但仍需警惕PoC代码被恶意修改和滥用的可能性。

**项目地址:** [0xeb-bp/cve-2020-16898](https://github.com/0xeb-bp/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #2

**来源**: [CVE-2020-16898-CPO-EH_CVE-2020-16898_Checker.md](../2020/CVE-2020-16898-CPO-EH_CVE-2020-16898_Checker.md)

## CVE-2020-16898 "Bad Neighbor" Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，允许远程代码执行

**影响版本:** 受影响的Windows版本包括 Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 以及 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要能够发送特制的ICMPv6 Router Advertisement数据包到目标Windows计算机。目标系统需要启用IPv6 RDNSS。

**POC 可用性:** 是，但提供的代码仅为检测脚本

**投毒风险:** 0%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是一个存在于Windows TCP/IP栈中的远程代码执行漏洞。此漏洞是由于Windows TCP/IP栈未能正确处理ICMPv6 Router Advertisement数据包中的Option Type 25字段造成的。攻击者可以发送特制的ICMPv6 Router Advertisement数据包来触发此漏洞，从而在目标系统上执行任意代码。

**漏洞利用方式：**

1.  攻击者需要构造恶意的ICMPv6 Router Advertisement数据包，该数据包的Option Type 25字段包含畸形或过长的数据。
2.  攻击者将构造的数据包发送到目标Windows系统。
3.  目标系统在处理该数据包时，TCP/IP栈会发生错误，导致缓冲区溢出或内存损坏。
4.  攻击者可以利用此漏洞执行任意代码。

**提供的POC代码分析：**

提供的PowerShell脚本 `CVE-2020-16898_Checker.ps1` 并不是一个漏洞利用代码，而是一个检测脚本，用于检查目标系统的网络接口是否容易受到CVE-2020-16898和CVE-2020-16899的影响。它通过检查网络接口的配置，特别是IPv6 6106选项是否启用，来判断接口是否存在漏洞。该脚本本身不包含任何恶意代码，因此不存在投毒风险。

**投毒风险评估：**

根据对提供的POC代码的分析，未发现任何恶意或隐藏的代码，因此投毒风险为0%。该脚本仅用于检测漏洞的存在，而不是利用漏洞。

**项目地址:** [CPO-EH/CVE-2020-16898_Checker](https://github.com/CPO-EH/CVE-2020-16898_Checker)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #3

**来源**: [CVE-2020-16898-CPO-EH_CVE-2020-16898_Workaround.md](../2020/CVE-2020-16898-CPO-EH_CVE-2020-16898_Workaround.md)

## CVE-2020-16898

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，允许远程攻击者在目标系统上执行代码

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, Windows Server version 2004

**利用条件:** 攻击者需要与目标系统位于同一网络或能够发送 IPv6 数据包到目标系统。

**POC 可用性:** 是，存在利用代码，可触发蓝屏 (BSOD)。

**投毒风险:** 0%

## 详情

CVE-2020-16898 是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞，由于 Windows TCP/IP 协议栈对 ICMPv6 路由器通告数据包处理不当导致。攻击者通过发送特制的 ICMPv6 路由器通告数据包到远程 Windows 计算机，可能导致远程代码执行。根据搜索结果，该漏洞也被称为“Bad Neighbor”，可导致蓝屏死机 (BSOD)。 提供的 PowerShell 脚本 `VCE-2020-16898_QuickWin.ps1`  是官方提供的临时缓解方案，用于禁用受影响网络接口上的基于路由器的 DNS 配置 (RABasedDNSConfig)， 以避免受到攻击，并不是漏洞利用代码。 该脚本的目的是通过禁用受影响接口的 `rabaseddnsconfig` 来缓解漏洞，脚本功能单一，没有发现投毒代码，因此投毒风险为 0%。利用方式主要是发送恶意构造的ICMPv6路由器通告数据包，其中Option Type 25字段存在问题。

**项目地址:** [CPO-EH/CVE-2020-16898_Workaround](https://github.com/CPO-EH/CVE-2020-16898_Workaround)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #4

**来源**: [CVE-2020-16898-Maliek_CVE-2020-16898_Check.md](../2020/CVE-2020-16898-Maliek_CVE-2020-16898_Check.md)

## CVE-2020-16898 "Bad Neighbor"

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 需要与目标系统在同一网络或可路由的网络中，目标系统启用IPv6，且未安装补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-16898 是一个Windows TCP/IP 堆栈远程代码执行漏洞，存在于Windows 系统处理 ICMPv6 路由通告包时。攻击者可以通过发送特制的 ICMPv6 路由通告包到远程Windows 计算机来利用此漏洞。

**有效性：**
根据漏洞描述和搜索结果，此漏洞真实存在，并且有公开的POC。提供的 PowerShell 脚本用于检测目标系统是否存在漏洞，通过检测网卡是否启用了基于RA的DNS配置(RABasedDNSConfig)，以及Windows版本是否是受影响版本。脚本本身并不能直接利用漏洞执行代码，而是用于判断漏洞是否存在。

**投毒风险：**
查看了脚本内容，该脚本主要功能是检测目标系统是否存在CVE-2020-16898漏洞。脚本通过查询注册表和网络接口配置来判断系统和网卡是否在受影响的范围内。未发现任何可以执行恶意代码或进行后门连接的部分。因此，投毒风险为0%。

**利用方式：**
1.  **漏洞触发：** 攻击者需要发送特制的 ICMPv6 路由通告包到目标Windows 计算机。
2.  **漏洞成因：** Windows TCP/IP 堆栈在处理 ICMPv6 路由通告包时，没有正确处理Option Type 25字段，导致缓冲区溢出。
3.  **攻击效果：** 成功的利用可能导致远程代码执行，攻击者可以在目标系统上执行任意代码。
4.  **缓解措施：** 安装 Microsoft 提供的安全更新。禁用 IPv6 RDNSS 配置也可缓解此漏洞，但可能影响IPv6 功能。

**搜索结果总结：**
搜索结果证实了该漏洞的存在和严重性，并提供了关于受影响系统、利用方式和缓解措施的信息。 该漏洞也被称为“Bad Neighbor”，需要及时修复。


**项目地址:** [Maliek/CVE-2020-16898_Check](https://github.com/Maliek/CVE-2020-16898_Check)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #5

**来源**: [CVE-2020-16898-Q1984_CVE-2020-16898.md](../2020/CVE-2020-16898-Q1984_CVE-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** Windows TCP/IP 堆栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709 - 2004, Windows Server 2019, Windows Server version 2004, Windows Server, version 1903/1909

**利用条件:** 需要与目标主机处于同一网络或可发送ICMPv6 Router Advertisement数据包到目标主机。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是Windows TCP/IP堆栈中的一个远程代码执行漏洞。当Windows TCP/IP堆栈不正确地处理ICMPv6 Router Advertisement数据包时，就会出现此漏洞。攻击者可以通过发送特制的ICMPv6 Router Advertisement数据包到远程Windows计算机来利用此漏洞。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响多个Windows版本，且存在公开的PoC代码。搜索结果显示，该漏洞可能导致蓝屏死机（BSOD），进一步说明了其可能导致拒绝服务。尽管有些描述中提到远程代码执行的可能性，但提供的PoC代码的README.md文件表明该PoC主要用于触发BSOD (DoS)。因此，该PoC代码被认为是有效的，至少可以触发拒绝服务攻击。

**投毒风险：**
提供的PoC代码只包含README.md文件，文件内容描述了如何使用`CVE-2020-16898.exe`，并声明“Use at own risk!”。仅凭此信息无法判断`CVE-2020-16898.exe`是否存在恶意代码。但是，考虑到漏洞利用的敏感性，存在一定的投毒风险。由于缺少实际的可执行文件代码，投毒风险评估为低，约为10%。主要原因是无法验证可执行文件的真实功能。

**利用方式：**
1.  **目标确定：** 确定运行受影响Windows版本的计算机。
2.  **网络连接：** 攻击者需要与目标计算机位于同一网络中，或者能够向目标计算机发送ICMPv6 Router Advertisement数据包。
3.  **数据包构造：** 攻击者需要构造特制的ICMPv6 Router Advertisement数据包，其中包含恶意数据，特别是Option Type 25，可能导致缓冲区溢出。
4.  **攻击执行：** 将构造的数据包发送到目标计算机。
5.  **结果：** 成功利用此漏洞可能导致目标计算机蓝屏死机（拒绝服务），或者，如果攻击者能够绕过缓解措施，则可能执行任意代码。快速修复的可用性表示该漏洞可能会导致DoS。

**项目地址:** [Q1984/CVE-2020-16898](https://github.com/Q1984/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #6

**来源**: [CVE-2020-16898-ZephrFish_CVE-2020-16898.md](../2020/CVE-2020-16898-ZephrFish_CVE-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 目标主机开启IPv6，且与攻击者处于同一网络或攻击者能够发送ICMPv6 Router Advertisement报文到目标主机

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2020-16898 "Bad Neighbor" 漏洞存在于 Windows TCP/IP 协议栈中，当其不正确地处理 ICMPv6 路由器通告 (Router Advertisement) 报文时，可能导致远程代码执行。攻击者需要发送特制的 ICMPv6 报文到目标系统，利用Option Type 25触发漏洞。 根据提供的 exploit 代码的 README.md 文件中的描述, 该 exploit 为一个 Windows 可执行文件，需要指定目标主机和用户名。README 中特别提示 "This is a lesson as to why you should not trust binaries on the internet." 以及 "This is an educational exercise. Use at your own risk."，这暗示了此二进制文件可能存在恶意代码或后门. 因此，存在很高的投毒风险。虽然无法直接从提供的文件内容确定其是否恶意，但基于作者的明确警告，投毒的可能性较高。利用方式为，攻击者编译或直接运行提供的二进制文件，并指定目标 IP 地址和用户名，程序会发送恶意 ICMPv6 报文来尝试触发漏洞，实现远程代码执行。

根据搜索结果,此漏洞影响多个windows版本，通过发送恶意的ICMPv6数据包可以触发远程代码执行. 多个安全厂商博客都提到了这个漏洞。

综合分析，漏洞利用的有效性取决于目标系统是否存在漏洞，而投毒风险较高，建议在隔离环境中分析和测试POC。


**项目地址:** [ZephrFish/CVE-2020-16898](https://github.com/ZephrFish/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #7

**来源**: [CVE-2020-16898-advanced-threat-research_CVE-2020-16898.md](../2020/CVE-2020-16898-advanced-threat-research_CVE-2020-16898.md)

# CVE-2020-16898

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-16898-0xeb-bp_cve-2020-16898.md](../2020/CVE-2020-16898-0xeb-bp_cve-2020-16898.md)

## CVE-2020-16898-Windows TCP/IP远程代码执行

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows TCP/IP 栈

**危害等级:** 高危，可能导致远程代码执行和系统崩溃（蓝屏）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, 1909, 2004

**利用条件:** 目标系统需要启用IPv6，且攻击者需要位于与目标系统相同的网络段或能够发送ICMPv6 Router Advertisement 数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898是一个Windows TCP/IP栈中的远程代码执行漏洞。当Windows TCP/IP栈不正确地处理ICMPv6 Router Advertisement数据包时，存在此漏洞。攻击者可以通过发送特制的ICMPv6 Router Advertisement数据包到远程Windows计算机来利用此漏洞。 

**利用方式：**

1.  **发送恶意ICMPv6 RA数据包：** 攻击者构造包含特制选项类型25的ICMPv6 Router Advertisement (RA) 数据包。根据搜索引擎返回的信息，该数据包是利用Option Type 25。从PoC代码来看，它使用了类型18和19的选项，并结合了IPv6扩展头部的分片功能。
2.  **触发栈溢出：** 恶意数据包中的错误处理会导致栈溢出。
3.  **远程代码执行或拒绝服务：** 成功利用此漏洞可能允许攻击者在目标系统上执行任意代码（RCE），或导致系统崩溃（蓝屏）。PoC 代码旨在触发蓝屏死机 (BSOD)，这意味着它主要关注拒绝服务。

**POC代码分析：**

*   该PoC使用`scapy`库来构建和发送ICMPv6数据包。
*   它首先构造一个IPv6头部，设置目标IPv6地址和跳数限制。
*   然后，它创建一个ICMPv6 Router Advertisement数据包。
*   该PoC包含两个ICMPv6NDOptRDNSS选项，用于利用漏洞。第一个数据包设置长度，第二个数据包触发溢出。
*   `overwrite`变量包含用于覆盖堆栈的字符。
*   该PoC使用IPv6分片来绕过某些限制并触发漏洞。
*   最后，它将数据包分片并通过网络发送。

**有效性：**

根据PoC的描述和相关搜索结果，该PoC代码能够触发Windows 10 version 2004的蓝屏死机，表明其具有一定的有效性。PoC代码针对性较强，依赖于特定的payload和触发方式，因此可能在不同版本的Windows上有效性有所不同。漏洞库信息也显示漏洞影响多个Windows版本。

**投毒风险：**

PoC代码中存在投毒的风险较低，约为10%。主要基于以下几点：

*   该代码的目的是触发蓝屏，这本身就是一种破坏行为，但并非隐蔽的后门植入。
*   代码比较清晰，主要由scapy库的调用组成，用于构造和发送网络数据包，功能单一，专注于漏洞利用。
*   虽然可能存在隐藏恶意代码的空间（例如在`overwrite`变量中插入shellcode），但当前PoC并未发现此类行为，主要目的是系统崩溃。
*   README.md文件描述了PoC的目的和测试环境，没有迹象表明作者有意隐藏恶意功能。

然而，仍然存在一定的风险，例如：

*   攻击者可能修改PoC代码，添加恶意功能，例如植入后门，然后传播修改后的PoC。
*   即使是蓝屏攻击也可能被滥用，例如用于勒索或破坏系统。

因此，虽然直接投毒的风险较低，但仍需警惕PoC代码被恶意修改和滥用的可能性。

**项目地址:** [0xeb-bp/cve-2020-16898](https://github.com/0xeb-bp/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #2

**来源**: [CVE-2020-16898-CPO-EH_CVE-2020-16898_Checker.md](../2020/CVE-2020-16898-CPO-EH_CVE-2020-16898_Checker.md)

## CVE-2020-16898 "Bad Neighbor" Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，允许远程代码执行

**影响版本:** 受影响的Windows版本包括 Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 以及 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要能够发送特制的ICMPv6 Router Advertisement数据包到目标Windows计算机。目标系统需要启用IPv6 RDNSS。

**POC 可用性:** 是，但提供的代码仅为检测脚本

**投毒风险:** 0%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是一个存在于Windows TCP/IP栈中的远程代码执行漏洞。此漏洞是由于Windows TCP/IP栈未能正确处理ICMPv6 Router Advertisement数据包中的Option Type 25字段造成的。攻击者可以发送特制的ICMPv6 Router Advertisement数据包来触发此漏洞，从而在目标系统上执行任意代码。

**漏洞利用方式：**

1.  攻击者需要构造恶意的ICMPv6 Router Advertisement数据包，该数据包的Option Type 25字段包含畸形或过长的数据。
2.  攻击者将构造的数据包发送到目标Windows系统。
3.  目标系统在处理该数据包时，TCP/IP栈会发生错误，导致缓冲区溢出或内存损坏。
4.  攻击者可以利用此漏洞执行任意代码。

**提供的POC代码分析：**

提供的PowerShell脚本 `CVE-2020-16898_Checker.ps1` 并不是一个漏洞利用代码，而是一个检测脚本，用于检查目标系统的网络接口是否容易受到CVE-2020-16898和CVE-2020-16899的影响。它通过检查网络接口的配置，特别是IPv6 6106选项是否启用，来判断接口是否存在漏洞。该脚本本身不包含任何恶意代码，因此不存在投毒风险。

**投毒风险评估：**

根据对提供的POC代码的分析，未发现任何恶意或隐藏的代码，因此投毒风险为0%。该脚本仅用于检测漏洞的存在，而不是利用漏洞。

**项目地址:** [CPO-EH/CVE-2020-16898_Checker](https://github.com/CPO-EH/CVE-2020-16898_Checker)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #3

**来源**: [CVE-2020-16898-CPO-EH_CVE-2020-16898_Workaround.md](../2020/CVE-2020-16898-CPO-EH_CVE-2020-16898_Workaround.md)

## CVE-2020-16898

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，允许远程攻击者在目标系统上执行代码

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, Windows Server version 2004

**利用条件:** 攻击者需要与目标系统位于同一网络或能够发送 IPv6 数据包到目标系统。

**POC 可用性:** 是，存在利用代码，可触发蓝屏 (BSOD)。

**投毒风险:** 0%

## 详情

CVE-2020-16898 是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞，由于 Windows TCP/IP 协议栈对 ICMPv6 路由器通告数据包处理不当导致。攻击者通过发送特制的 ICMPv6 路由器通告数据包到远程 Windows 计算机，可能导致远程代码执行。根据搜索结果，该漏洞也被称为“Bad Neighbor”，可导致蓝屏死机 (BSOD)。 提供的 PowerShell 脚本 `VCE-2020-16898_QuickWin.ps1`  是官方提供的临时缓解方案，用于禁用受影响网络接口上的基于路由器的 DNS 配置 (RABasedDNSConfig)， 以避免受到攻击，并不是漏洞利用代码。 该脚本的目的是通过禁用受影响接口的 `rabaseddnsconfig` 来缓解漏洞，脚本功能单一，没有发现投毒代码，因此投毒风险为 0%。利用方式主要是发送恶意构造的ICMPv6路由器通告数据包，其中Option Type 25字段存在问题。

**项目地址:** [CPO-EH/CVE-2020-16898_Workaround](https://github.com/CPO-EH/CVE-2020-16898_Workaround)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #4

**来源**: [CVE-2020-16898-Maliek_CVE-2020-16898_Check.md](../2020/CVE-2020-16898-Maliek_CVE-2020-16898_Check.md)

## CVE-2020-16898 "Bad Neighbor"

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 需要与目标系统在同一网络或可路由的网络中，目标系统启用IPv6，且未安装补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-16898 是一个Windows TCP/IP 堆栈远程代码执行漏洞，存在于Windows 系统处理 ICMPv6 路由通告包时。攻击者可以通过发送特制的 ICMPv6 路由通告包到远程Windows 计算机来利用此漏洞。

**有效性：**
根据漏洞描述和搜索结果，此漏洞真实存在，并且有公开的POC。提供的 PowerShell 脚本用于检测目标系统是否存在漏洞，通过检测网卡是否启用了基于RA的DNS配置(RABasedDNSConfig)，以及Windows版本是否是受影响版本。脚本本身并不能直接利用漏洞执行代码，而是用于判断漏洞是否存在。

**投毒风险：**
查看了脚本内容，该脚本主要功能是检测目标系统是否存在CVE-2020-16898漏洞。脚本通过查询注册表和网络接口配置来判断系统和网卡是否在受影响的范围内。未发现任何可以执行恶意代码或进行后门连接的部分。因此，投毒风险为0%。

**利用方式：**
1.  **漏洞触发：** 攻击者需要发送特制的 ICMPv6 路由通告包到目标Windows 计算机。
2.  **漏洞成因：** Windows TCP/IP 堆栈在处理 ICMPv6 路由通告包时，没有正确处理Option Type 25字段，导致缓冲区溢出。
3.  **攻击效果：** 成功的利用可能导致远程代码执行，攻击者可以在目标系统上执行任意代码。
4.  **缓解措施：** 安装 Microsoft 提供的安全更新。禁用 IPv6 RDNSS 配置也可缓解此漏洞，但可能影响IPv6 功能。

**搜索结果总结：**
搜索结果证实了该漏洞的存在和严重性，并提供了关于受影响系统、利用方式和缓解措施的信息。 该漏洞也被称为“Bad Neighbor”，需要及时修复。


**项目地址:** [Maliek/CVE-2020-16898_Check](https://github.com/Maliek/CVE-2020-16898_Check)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #5

**来源**: [CVE-2020-16898-Q1984_CVE-2020-16898.md](../2020/CVE-2020-16898-Q1984_CVE-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** Windows TCP/IP 堆栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709 - 2004, Windows Server 2019, Windows Server version 2004, Windows Server, version 1903/1909

**利用条件:** 需要与目标主机处于同一网络或可发送ICMPv6 Router Advertisement数据包到目标主机。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是Windows TCP/IP堆栈中的一个远程代码执行漏洞。当Windows TCP/IP堆栈不正确地处理ICMPv6 Router Advertisement数据包时，就会出现此漏洞。攻击者可以通过发送特制的ICMPv6 Router Advertisement数据包到远程Windows计算机来利用此漏洞。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响多个Windows版本，且存在公开的PoC代码。搜索结果显示，该漏洞可能导致蓝屏死机（BSOD），进一步说明了其可能导致拒绝服务。尽管有些描述中提到远程代码执行的可能性，但提供的PoC代码的README.md文件表明该PoC主要用于触发BSOD (DoS)。因此，该PoC代码被认为是有效的，至少可以触发拒绝服务攻击。

**投毒风险：**
提供的PoC代码只包含README.md文件，文件内容描述了如何使用`CVE-2020-16898.exe`，并声明“Use at own risk!”。仅凭此信息无法判断`CVE-2020-16898.exe`是否存在恶意代码。但是，考虑到漏洞利用的敏感性，存在一定的投毒风险。由于缺少实际的可执行文件代码，投毒风险评估为低，约为10%。主要原因是无法验证可执行文件的真实功能。

**利用方式：**
1.  **目标确定：** 确定运行受影响Windows版本的计算机。
2.  **网络连接：** 攻击者需要与目标计算机位于同一网络中，或者能够向目标计算机发送ICMPv6 Router Advertisement数据包。
3.  **数据包构造：** 攻击者需要构造特制的ICMPv6 Router Advertisement数据包，其中包含恶意数据，特别是Option Type 25，可能导致缓冲区溢出。
4.  **攻击执行：** 将构造的数据包发送到目标计算机。
5.  **结果：** 成功利用此漏洞可能导致目标计算机蓝屏死机（拒绝服务），或者，如果攻击者能够绕过缓解措施，则可能执行任意代码。快速修复的可用性表示该漏洞可能会导致DoS。

**项目地址:** [Q1984/CVE-2020-16898](https://github.com/Q1984/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #6

**来源**: [CVE-2020-16898-ZephrFish_CVE-2020-16898.md](../2020/CVE-2020-16898-ZephrFish_CVE-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 目标主机开启IPv6，且与攻击者处于同一网络或攻击者能够发送ICMPv6 Router Advertisement报文到目标主机

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2020-16898 "Bad Neighbor" 漏洞存在于 Windows TCP/IP 协议栈中，当其不正确地处理 ICMPv6 路由器通告 (Router Advertisement) 报文时，可能导致远程代码执行。攻击者需要发送特制的 ICMPv6 报文到目标系统，利用Option Type 25触发漏洞。 根据提供的 exploit 代码的 README.md 文件中的描述, 该 exploit 为一个 Windows 可执行文件，需要指定目标主机和用户名。README 中特别提示 "This is a lesson as to why you should not trust binaries on the internet." 以及 "This is an educational exercise. Use at your own risk."，这暗示了此二进制文件可能存在恶意代码或后门. 因此，存在很高的投毒风险。虽然无法直接从提供的文件内容确定其是否恶意，但基于作者的明确警告，投毒的可能性较高。利用方式为，攻击者编译或直接运行提供的二进制文件，并指定目标 IP 地址和用户名，程序会发送恶意 ICMPv6 报文来尝试触发漏洞，实现远程代码执行。

根据搜索结果,此漏洞影响多个windows版本，通过发送恶意的ICMPv6数据包可以触发远程代码执行. 多个安全厂商博客都提到了这个漏洞。

综合分析，漏洞利用的有效性取决于目标系统是否存在漏洞，而投毒风险较高，建议在隔离环境中分析和测试POC。


**项目地址:** [ZephrFish/CVE-2020-16898](https://github.com/ZephrFish/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #7

**来源**: [CVE-2020-16898-advanced-threat-research_CVE-2020-16898.md](../2020/CVE-2020-16898-advanced-threat-research_CVE-2020-16898.md)

# CVE-2020-16898

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-16898-0xeb-bp_cve-2020-16898.md](../2020/CVE-2020-16898-0xeb-bp_cve-2020-16898.md)

## CVE-2020-16898-Windows TCP/IP远程代码执行

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows TCP/IP 栈

**危害等级:** 高危，可能导致远程代码执行和系统崩溃（蓝屏）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, 1909, 2004

**利用条件:** 目标系统需要启用IPv6，且攻击者需要位于与目标系统相同的网络段或能够发送ICMPv6 Router Advertisement 数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898是一个Windows TCP/IP栈中的远程代码执行漏洞。当Windows TCP/IP栈不正确地处理ICMPv6 Router Advertisement数据包时，存在此漏洞。攻击者可以通过发送特制的ICMPv6 Router Advertisement数据包到远程Windows计算机来利用此漏洞。 

**利用方式：**

1.  **发送恶意ICMPv6 RA数据包：** 攻击者构造包含特制选项类型25的ICMPv6 Router Advertisement (RA) 数据包。根据搜索引擎返回的信息，该数据包是利用Option Type 25。从PoC代码来看，它使用了类型18和19的选项，并结合了IPv6扩展头部的分片功能。
2.  **触发栈溢出：** 恶意数据包中的错误处理会导致栈溢出。
3.  **远程代码执行或拒绝服务：** 成功利用此漏洞可能允许攻击者在目标系统上执行任意代码（RCE），或导致系统崩溃（蓝屏）。PoC 代码旨在触发蓝屏死机 (BSOD)，这意味着它主要关注拒绝服务。

**POC代码分析：**

*   该PoC使用`scapy`库来构建和发送ICMPv6数据包。
*   它首先构造一个IPv6头部，设置目标IPv6地址和跳数限制。
*   然后，它创建一个ICMPv6 Router Advertisement数据包。
*   该PoC包含两个ICMPv6NDOptRDNSS选项，用于利用漏洞。第一个数据包设置长度，第二个数据包触发溢出。
*   `overwrite`变量包含用于覆盖堆栈的字符。
*   该PoC使用IPv6分片来绕过某些限制并触发漏洞。
*   最后，它将数据包分片并通过网络发送。

**有效性：**

根据PoC的描述和相关搜索结果，该PoC代码能够触发Windows 10 version 2004的蓝屏死机，表明其具有一定的有效性。PoC代码针对性较强，依赖于特定的payload和触发方式，因此可能在不同版本的Windows上有效性有所不同。漏洞库信息也显示漏洞影响多个Windows版本。

**投毒风险：**

PoC代码中存在投毒的风险较低，约为10%。主要基于以下几点：

*   该代码的目的是触发蓝屏，这本身就是一种破坏行为，但并非隐蔽的后门植入。
*   代码比较清晰，主要由scapy库的调用组成，用于构造和发送网络数据包，功能单一，专注于漏洞利用。
*   虽然可能存在隐藏恶意代码的空间（例如在`overwrite`变量中插入shellcode），但当前PoC并未发现此类行为，主要目的是系统崩溃。
*   README.md文件描述了PoC的目的和测试环境，没有迹象表明作者有意隐藏恶意功能。

然而，仍然存在一定的风险，例如：

*   攻击者可能修改PoC代码，添加恶意功能，例如植入后门，然后传播修改后的PoC。
*   即使是蓝屏攻击也可能被滥用，例如用于勒索或破坏系统。

因此，虽然直接投毒的风险较低，但仍需警惕PoC代码被恶意修改和滥用的可能性。

**项目地址:** [0xeb-bp/cve-2020-16898](https://github.com/0xeb-bp/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #2

**来源**: [CVE-2020-16898-CPO-EH_CVE-2020-16898_Checker.md](../2020/CVE-2020-16898-CPO-EH_CVE-2020-16898_Checker.md)

## CVE-2020-16898 "Bad Neighbor" Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，允许远程代码执行

**影响版本:** 受影响的Windows版本包括 Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 以及 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要能够发送特制的ICMPv6 Router Advertisement数据包到目标Windows计算机。目标系统需要启用IPv6 RDNSS。

**POC 可用性:** 是，但提供的代码仅为检测脚本

**投毒风险:** 0%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是一个存在于Windows TCP/IP栈中的远程代码执行漏洞。此漏洞是由于Windows TCP/IP栈未能正确处理ICMPv6 Router Advertisement数据包中的Option Type 25字段造成的。攻击者可以发送特制的ICMPv6 Router Advertisement数据包来触发此漏洞，从而在目标系统上执行任意代码。

**漏洞利用方式：**

1.  攻击者需要构造恶意的ICMPv6 Router Advertisement数据包，该数据包的Option Type 25字段包含畸形或过长的数据。
2.  攻击者将构造的数据包发送到目标Windows系统。
3.  目标系统在处理该数据包时，TCP/IP栈会发生错误，导致缓冲区溢出或内存损坏。
4.  攻击者可以利用此漏洞执行任意代码。

**提供的POC代码分析：**

提供的PowerShell脚本 `CVE-2020-16898_Checker.ps1` 并不是一个漏洞利用代码，而是一个检测脚本，用于检查目标系统的网络接口是否容易受到CVE-2020-16898和CVE-2020-16899的影响。它通过检查网络接口的配置，特别是IPv6 6106选项是否启用，来判断接口是否存在漏洞。该脚本本身不包含任何恶意代码，因此不存在投毒风险。

**投毒风险评估：**

根据对提供的POC代码的分析，未发现任何恶意或隐藏的代码，因此投毒风险为0%。该脚本仅用于检测漏洞的存在，而不是利用漏洞。

**项目地址:** [CPO-EH/CVE-2020-16898_Checker](https://github.com/CPO-EH/CVE-2020-16898_Checker)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #3

**来源**: [CVE-2020-16898-CPO-EH_CVE-2020-16898_Workaround.md](../2020/CVE-2020-16898-CPO-EH_CVE-2020-16898_Workaround.md)

## CVE-2020-16898

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，允许远程攻击者在目标系统上执行代码

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, Windows Server version 2004

**利用条件:** 攻击者需要与目标系统位于同一网络或能够发送 IPv6 数据包到目标系统。

**POC 可用性:** 是，存在利用代码，可触发蓝屏 (BSOD)。

**投毒风险:** 0%

## 详情

CVE-2020-16898 是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞，由于 Windows TCP/IP 协议栈对 ICMPv6 路由器通告数据包处理不当导致。攻击者通过发送特制的 ICMPv6 路由器通告数据包到远程 Windows 计算机，可能导致远程代码执行。根据搜索结果，该漏洞也被称为“Bad Neighbor”，可导致蓝屏死机 (BSOD)。 提供的 PowerShell 脚本 `VCE-2020-16898_QuickWin.ps1`  是官方提供的临时缓解方案，用于禁用受影响网络接口上的基于路由器的 DNS 配置 (RABasedDNSConfig)， 以避免受到攻击，并不是漏洞利用代码。 该脚本的目的是通过禁用受影响接口的 `rabaseddnsconfig` 来缓解漏洞，脚本功能单一，没有发现投毒代码，因此投毒风险为 0%。利用方式主要是发送恶意构造的ICMPv6路由器通告数据包，其中Option Type 25字段存在问题。

**项目地址:** [CPO-EH/CVE-2020-16898_Workaround](https://github.com/CPO-EH/CVE-2020-16898_Workaround)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #4

**来源**: [CVE-2020-16898-Maliek_CVE-2020-16898_Check.md](../2020/CVE-2020-16898-Maliek_CVE-2020-16898_Check.md)

## CVE-2020-16898 "Bad Neighbor"

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 需要与目标系统在同一网络或可路由的网络中，目标系统启用IPv6，且未安装补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-16898 是一个Windows TCP/IP 堆栈远程代码执行漏洞，存在于Windows 系统处理 ICMPv6 路由通告包时。攻击者可以通过发送特制的 ICMPv6 路由通告包到远程Windows 计算机来利用此漏洞。

**有效性：**
根据漏洞描述和搜索结果，此漏洞真实存在，并且有公开的POC。提供的 PowerShell 脚本用于检测目标系统是否存在漏洞，通过检测网卡是否启用了基于RA的DNS配置(RABasedDNSConfig)，以及Windows版本是否是受影响版本。脚本本身并不能直接利用漏洞执行代码，而是用于判断漏洞是否存在。

**投毒风险：**
查看了脚本内容，该脚本主要功能是检测目标系统是否存在CVE-2020-16898漏洞。脚本通过查询注册表和网络接口配置来判断系统和网卡是否在受影响的范围内。未发现任何可以执行恶意代码或进行后门连接的部分。因此，投毒风险为0%。

**利用方式：**
1.  **漏洞触发：** 攻击者需要发送特制的 ICMPv6 路由通告包到目标Windows 计算机。
2.  **漏洞成因：** Windows TCP/IP 堆栈在处理 ICMPv6 路由通告包时，没有正确处理Option Type 25字段，导致缓冲区溢出。
3.  **攻击效果：** 成功的利用可能导致远程代码执行，攻击者可以在目标系统上执行任意代码。
4.  **缓解措施：** 安装 Microsoft 提供的安全更新。禁用 IPv6 RDNSS 配置也可缓解此漏洞，但可能影响IPv6 功能。

**搜索结果总结：**
搜索结果证实了该漏洞的存在和严重性，并提供了关于受影响系统、利用方式和缓解措施的信息。 该漏洞也被称为“Bad Neighbor”，需要及时修复。


**项目地址:** [Maliek/CVE-2020-16898_Check](https://github.com/Maliek/CVE-2020-16898_Check)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #5

**来源**: [CVE-2020-16898-Q1984_CVE-2020-16898.md](../2020/CVE-2020-16898-Q1984_CVE-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** Windows TCP/IP 堆栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709 - 2004, Windows Server 2019, Windows Server version 2004, Windows Server, version 1903/1909

**利用条件:** 需要与目标主机处于同一网络或可发送ICMPv6 Router Advertisement数据包到目标主机。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是Windows TCP/IP堆栈中的一个远程代码执行漏洞。当Windows TCP/IP堆栈不正确地处理ICMPv6 Router Advertisement数据包时，就会出现此漏洞。攻击者可以通过发送特制的ICMPv6 Router Advertisement数据包到远程Windows计算机来利用此漏洞。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响多个Windows版本，且存在公开的PoC代码。搜索结果显示，该漏洞可能导致蓝屏死机（BSOD），进一步说明了其可能导致拒绝服务。尽管有些描述中提到远程代码执行的可能性，但提供的PoC代码的README.md文件表明该PoC主要用于触发BSOD (DoS)。因此，该PoC代码被认为是有效的，至少可以触发拒绝服务攻击。

**投毒风险：**
提供的PoC代码只包含README.md文件，文件内容描述了如何使用`CVE-2020-16898.exe`，并声明“Use at own risk!”。仅凭此信息无法判断`CVE-2020-16898.exe`是否存在恶意代码。但是，考虑到漏洞利用的敏感性，存在一定的投毒风险。由于缺少实际的可执行文件代码，投毒风险评估为低，约为10%。主要原因是无法验证可执行文件的真实功能。

**利用方式：**
1.  **目标确定：** 确定运行受影响Windows版本的计算机。
2.  **网络连接：** 攻击者需要与目标计算机位于同一网络中，或者能够向目标计算机发送ICMPv6 Router Advertisement数据包。
3.  **数据包构造：** 攻击者需要构造特制的ICMPv6 Router Advertisement数据包，其中包含恶意数据，特别是Option Type 25，可能导致缓冲区溢出。
4.  **攻击执行：** 将构造的数据包发送到目标计算机。
5.  **结果：** 成功利用此漏洞可能导致目标计算机蓝屏死机（拒绝服务），或者，如果攻击者能够绕过缓解措施，则可能执行任意代码。快速修复的可用性表示该漏洞可能会导致DoS。

**项目地址:** [Q1984/CVE-2020-16898](https://github.com/Q1984/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #6

**来源**: [CVE-2020-16898-ZephrFish_CVE-2020-16898.md](../2020/CVE-2020-16898-ZephrFish_CVE-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 目标主机开启IPv6，且与攻击者处于同一网络或攻击者能够发送ICMPv6 Router Advertisement报文到目标主机

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2020-16898 "Bad Neighbor" 漏洞存在于 Windows TCP/IP 协议栈中，当其不正确地处理 ICMPv6 路由器通告 (Router Advertisement) 报文时，可能导致远程代码执行。攻击者需要发送特制的 ICMPv6 报文到目标系统，利用Option Type 25触发漏洞。 根据提供的 exploit 代码的 README.md 文件中的描述, 该 exploit 为一个 Windows 可执行文件，需要指定目标主机和用户名。README 中特别提示 "This is a lesson as to why you should not trust binaries on the internet." 以及 "This is an educational exercise. Use at your own risk."，这暗示了此二进制文件可能存在恶意代码或后门. 因此，存在很高的投毒风险。虽然无法直接从提供的文件内容确定其是否恶意，但基于作者的明确警告，投毒的可能性较高。利用方式为，攻击者编译或直接运行提供的二进制文件，并指定目标 IP 地址和用户名，程序会发送恶意 ICMPv6 报文来尝试触发漏洞，实现远程代码执行。

根据搜索结果,此漏洞影响多个windows版本，通过发送恶意的ICMPv6数据包可以触发远程代码执行. 多个安全厂商博客都提到了这个漏洞。

综合分析，漏洞利用的有效性取决于目标系统是否存在漏洞，而投毒风险较高，建议在隔离环境中分析和测试POC。


**项目地址:** [ZephrFish/CVE-2020-16898](https://github.com/ZephrFish/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #7

**来源**: [CVE-2020-16898-advanced-threat-research_CVE-2020-16898.md](../2020/CVE-2020-16898-advanced-threat-research_CVE-2020-16898.md)

# CVE-2020-16898

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-16898-0xeb-bp_cve-2020-16898.md](../2020/CVE-2020-16898-0xeb-bp_cve-2020-16898.md)

## CVE-2020-16898-Windows TCP/IP远程代码执行

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows TCP/IP 栈

**危害等级:** 高危，可能导致远程代码执行和系统崩溃（蓝屏）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, 1909, 2004

**利用条件:** 目标系统需要启用IPv6，且攻击者需要位于与目标系统相同的网络段或能够发送ICMPv6 Router Advertisement 数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898是一个Windows TCP/IP栈中的远程代码执行漏洞。当Windows TCP/IP栈不正确地处理ICMPv6 Router Advertisement数据包时，存在此漏洞。攻击者可以通过发送特制的ICMPv6 Router Advertisement数据包到远程Windows计算机来利用此漏洞。 

**利用方式：**

1.  **发送恶意ICMPv6 RA数据包：** 攻击者构造包含特制选项类型25的ICMPv6 Router Advertisement (RA) 数据包。根据搜索引擎返回的信息，该数据包是利用Option Type 25。从PoC代码来看，它使用了类型18和19的选项，并结合了IPv6扩展头部的分片功能。
2.  **触发栈溢出：** 恶意数据包中的错误处理会导致栈溢出。
3.  **远程代码执行或拒绝服务：** 成功利用此漏洞可能允许攻击者在目标系统上执行任意代码（RCE），或导致系统崩溃（蓝屏）。PoC 代码旨在触发蓝屏死机 (BSOD)，这意味着它主要关注拒绝服务。

**POC代码分析：**

*   该PoC使用`scapy`库来构建和发送ICMPv6数据包。
*   它首先构造一个IPv6头部，设置目标IPv6地址和跳数限制。
*   然后，它创建一个ICMPv6 Router Advertisement数据包。
*   该PoC包含两个ICMPv6NDOptRDNSS选项，用于利用漏洞。第一个数据包设置长度，第二个数据包触发溢出。
*   `overwrite`变量包含用于覆盖堆栈的字符。
*   该PoC使用IPv6分片来绕过某些限制并触发漏洞。
*   最后，它将数据包分片并通过网络发送。

**有效性：**

根据PoC的描述和相关搜索结果，该PoC代码能够触发Windows 10 version 2004的蓝屏死机，表明其具有一定的有效性。PoC代码针对性较强，依赖于特定的payload和触发方式，因此可能在不同版本的Windows上有效性有所不同。漏洞库信息也显示漏洞影响多个Windows版本。

**投毒风险：**

PoC代码中存在投毒的风险较低，约为10%。主要基于以下几点：

*   该代码的目的是触发蓝屏，这本身就是一种破坏行为，但并非隐蔽的后门植入。
*   代码比较清晰，主要由scapy库的调用组成，用于构造和发送网络数据包，功能单一，专注于漏洞利用。
*   虽然可能存在隐藏恶意代码的空间（例如在`overwrite`变量中插入shellcode），但当前PoC并未发现此类行为，主要目的是系统崩溃。
*   README.md文件描述了PoC的目的和测试环境，没有迹象表明作者有意隐藏恶意功能。

然而，仍然存在一定的风险，例如：

*   攻击者可能修改PoC代码，添加恶意功能，例如植入后门，然后传播修改后的PoC。
*   即使是蓝屏攻击也可能被滥用，例如用于勒索或破坏系统。

因此，虽然直接投毒的风险较低，但仍需警惕PoC代码被恶意修改和滥用的可能性。

**项目地址:** [0xeb-bp/cve-2020-16898](https://github.com/0xeb-bp/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #2

**来源**: [CVE-2020-16898-CPO-EH_CVE-2020-16898_Checker.md](../2020/CVE-2020-16898-CPO-EH_CVE-2020-16898_Checker.md)

## CVE-2020-16898 "Bad Neighbor" Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，允许远程代码执行

**影响版本:** 受影响的Windows版本包括 Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 以及 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要能够发送特制的ICMPv6 Router Advertisement数据包到目标Windows计算机。目标系统需要启用IPv6 RDNSS。

**POC 可用性:** 是，但提供的代码仅为检测脚本

**投毒风险:** 0%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是一个存在于Windows TCP/IP栈中的远程代码执行漏洞。此漏洞是由于Windows TCP/IP栈未能正确处理ICMPv6 Router Advertisement数据包中的Option Type 25字段造成的。攻击者可以发送特制的ICMPv6 Router Advertisement数据包来触发此漏洞，从而在目标系统上执行任意代码。

**漏洞利用方式：**

1.  攻击者需要构造恶意的ICMPv6 Router Advertisement数据包，该数据包的Option Type 25字段包含畸形或过长的数据。
2.  攻击者将构造的数据包发送到目标Windows系统。
3.  目标系统在处理该数据包时，TCP/IP栈会发生错误，导致缓冲区溢出或内存损坏。
4.  攻击者可以利用此漏洞执行任意代码。

**提供的POC代码分析：**

提供的PowerShell脚本 `CVE-2020-16898_Checker.ps1` 并不是一个漏洞利用代码，而是一个检测脚本，用于检查目标系统的网络接口是否容易受到CVE-2020-16898和CVE-2020-16899的影响。它通过检查网络接口的配置，特别是IPv6 6106选项是否启用，来判断接口是否存在漏洞。该脚本本身不包含任何恶意代码，因此不存在投毒风险。

**投毒风险评估：**

根据对提供的POC代码的分析，未发现任何恶意或隐藏的代码，因此投毒风险为0%。该脚本仅用于检测漏洞的存在，而不是利用漏洞。

**项目地址:** [CPO-EH/CVE-2020-16898_Checker](https://github.com/CPO-EH/CVE-2020-16898_Checker)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #3

**来源**: [CVE-2020-16898-CPO-EH_CVE-2020-16898_Workaround.md](../2020/CVE-2020-16898-CPO-EH_CVE-2020-16898_Workaround.md)

## CVE-2020-16898

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，允许远程攻击者在目标系统上执行代码

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, Windows Server version 2004

**利用条件:** 攻击者需要与目标系统位于同一网络或能够发送 IPv6 数据包到目标系统。

**POC 可用性:** 是，存在利用代码，可触发蓝屏 (BSOD)。

**投毒风险:** 0%

## 详情

CVE-2020-16898 是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞，由于 Windows TCP/IP 协议栈对 ICMPv6 路由器通告数据包处理不当导致。攻击者通过发送特制的 ICMPv6 路由器通告数据包到远程 Windows 计算机，可能导致远程代码执行。根据搜索结果，该漏洞也被称为“Bad Neighbor”，可导致蓝屏死机 (BSOD)。 提供的 PowerShell 脚本 `VCE-2020-16898_QuickWin.ps1`  是官方提供的临时缓解方案，用于禁用受影响网络接口上的基于路由器的 DNS 配置 (RABasedDNSConfig)， 以避免受到攻击，并不是漏洞利用代码。 该脚本的目的是通过禁用受影响接口的 `rabaseddnsconfig` 来缓解漏洞，脚本功能单一，没有发现投毒代码，因此投毒风险为 0%。利用方式主要是发送恶意构造的ICMPv6路由器通告数据包，其中Option Type 25字段存在问题。

**项目地址:** [CPO-EH/CVE-2020-16898_Workaround](https://github.com/CPO-EH/CVE-2020-16898_Workaround)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #4

**来源**: [CVE-2020-16898-Maliek_CVE-2020-16898_Check.md](../2020/CVE-2020-16898-Maliek_CVE-2020-16898_Check.md)

## CVE-2020-16898 "Bad Neighbor"

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 需要与目标系统在同一网络或可路由的网络中，目标系统启用IPv6，且未安装补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-16898 是一个Windows TCP/IP 堆栈远程代码执行漏洞，存在于Windows 系统处理 ICMPv6 路由通告包时。攻击者可以通过发送特制的 ICMPv6 路由通告包到远程Windows 计算机来利用此漏洞。

**有效性：**
根据漏洞描述和搜索结果，此漏洞真实存在，并且有公开的POC。提供的 PowerShell 脚本用于检测目标系统是否存在漏洞，通过检测网卡是否启用了基于RA的DNS配置(RABasedDNSConfig)，以及Windows版本是否是受影响版本。脚本本身并不能直接利用漏洞执行代码，而是用于判断漏洞是否存在。

**投毒风险：**
查看了脚本内容，该脚本主要功能是检测目标系统是否存在CVE-2020-16898漏洞。脚本通过查询注册表和网络接口配置来判断系统和网卡是否在受影响的范围内。未发现任何可以执行恶意代码或进行后门连接的部分。因此，投毒风险为0%。

**利用方式：**
1.  **漏洞触发：** 攻击者需要发送特制的 ICMPv6 路由通告包到目标Windows 计算机。
2.  **漏洞成因：** Windows TCP/IP 堆栈在处理 ICMPv6 路由通告包时，没有正确处理Option Type 25字段，导致缓冲区溢出。
3.  **攻击效果：** 成功的利用可能导致远程代码执行，攻击者可以在目标系统上执行任意代码。
4.  **缓解措施：** 安装 Microsoft 提供的安全更新。禁用 IPv6 RDNSS 配置也可缓解此漏洞，但可能影响IPv6 功能。

**搜索结果总结：**
搜索结果证实了该漏洞的存在和严重性，并提供了关于受影响系统、利用方式和缓解措施的信息。 该漏洞也被称为“Bad Neighbor”，需要及时修复。


**项目地址:** [Maliek/CVE-2020-16898_Check](https://github.com/Maliek/CVE-2020-16898_Check)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #5

**来源**: [CVE-2020-16898-Q1984_CVE-2020-16898.md](../2020/CVE-2020-16898-Q1984_CVE-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** Windows TCP/IP 堆栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709 - 2004, Windows Server 2019, Windows Server version 2004, Windows Server, version 1903/1909

**利用条件:** 需要与目标主机处于同一网络或可发送ICMPv6 Router Advertisement数据包到目标主机。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是Windows TCP/IP堆栈中的一个远程代码执行漏洞。当Windows TCP/IP堆栈不正确地处理ICMPv6 Router Advertisement数据包时，就会出现此漏洞。攻击者可以通过发送特制的ICMPv6 Router Advertisement数据包到远程Windows计算机来利用此漏洞。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响多个Windows版本，且存在公开的PoC代码。搜索结果显示，该漏洞可能导致蓝屏死机（BSOD），进一步说明了其可能导致拒绝服务。尽管有些描述中提到远程代码执行的可能性，但提供的PoC代码的README.md文件表明该PoC主要用于触发BSOD (DoS)。因此，该PoC代码被认为是有效的，至少可以触发拒绝服务攻击。

**投毒风险：**
提供的PoC代码只包含README.md文件，文件内容描述了如何使用`CVE-2020-16898.exe`，并声明“Use at own risk!”。仅凭此信息无法判断`CVE-2020-16898.exe`是否存在恶意代码。但是，考虑到漏洞利用的敏感性，存在一定的投毒风险。由于缺少实际的可执行文件代码，投毒风险评估为低，约为10%。主要原因是无法验证可执行文件的真实功能。

**利用方式：**
1.  **目标确定：** 确定运行受影响Windows版本的计算机。
2.  **网络连接：** 攻击者需要与目标计算机位于同一网络中，或者能够向目标计算机发送ICMPv6 Router Advertisement数据包。
3.  **数据包构造：** 攻击者需要构造特制的ICMPv6 Router Advertisement数据包，其中包含恶意数据，特别是Option Type 25，可能导致缓冲区溢出。
4.  **攻击执行：** 将构造的数据包发送到目标计算机。
5.  **结果：** 成功利用此漏洞可能导致目标计算机蓝屏死机（拒绝服务），或者，如果攻击者能够绕过缓解措施，则可能执行任意代码。快速修复的可用性表示该漏洞可能会导致DoS。

**项目地址:** [Q1984/CVE-2020-16898](https://github.com/Q1984/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #6

**来源**: [CVE-2020-16898-ZephrFish_CVE-2020-16898.md](../2020/CVE-2020-16898-ZephrFish_CVE-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 目标主机开启IPv6，且与攻击者处于同一网络或攻击者能够发送ICMPv6 Router Advertisement报文到目标主机

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2020-16898 "Bad Neighbor" 漏洞存在于 Windows TCP/IP 协议栈中，当其不正确地处理 ICMPv6 路由器通告 (Router Advertisement) 报文时，可能导致远程代码执行。攻击者需要发送特制的 ICMPv6 报文到目标系统，利用Option Type 25触发漏洞。 根据提供的 exploit 代码的 README.md 文件中的描述, 该 exploit 为一个 Windows 可执行文件，需要指定目标主机和用户名。README 中特别提示 "This is a lesson as to why you should not trust binaries on the internet." 以及 "This is an educational exercise. Use at your own risk."，这暗示了此二进制文件可能存在恶意代码或后门. 因此，存在很高的投毒风险。虽然无法直接从提供的文件内容确定其是否恶意，但基于作者的明确警告，投毒的可能性较高。利用方式为，攻击者编译或直接运行提供的二进制文件，并指定目标 IP 地址和用户名，程序会发送恶意 ICMPv6 报文来尝试触发漏洞，实现远程代码执行。

根据搜索结果,此漏洞影响多个windows版本，通过发送恶意的ICMPv6数据包可以触发远程代码执行. 多个安全厂商博客都提到了这个漏洞。

综合分析，漏洞利用的有效性取决于目标系统是否存在漏洞，而投毒风险较高，建议在隔离环境中分析和测试POC。


**项目地址:** [ZephrFish/CVE-2020-16898](https://github.com/ZephrFish/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #7

**来源**: [CVE-2020-16898-advanced-threat-research_CVE-2020-16898.md](../2020/CVE-2020-16898-advanced-threat-research_CVE-2020-16898.md)

# CVE-2020-16898

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-16898-0xeb-bp_cve-2020-16898.md](../2020/CVE-2020-16898-0xeb-bp_cve-2020-16898.md)

## CVE-2020-16898-Windows TCP/IP远程代码执行

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows TCP/IP 栈

**危害等级:** 高危，可能导致远程代码执行和系统崩溃（蓝屏）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, 1909, 2004

**利用条件:** 目标系统需要启用IPv6，且攻击者需要位于与目标系统相同的网络段或能够发送ICMPv6 Router Advertisement 数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898是一个Windows TCP/IP栈中的远程代码执行漏洞。当Windows TCP/IP栈不正确地处理ICMPv6 Router Advertisement数据包时，存在此漏洞。攻击者可以通过发送特制的ICMPv6 Router Advertisement数据包到远程Windows计算机来利用此漏洞。 

**利用方式：**

1.  **发送恶意ICMPv6 RA数据包：** 攻击者构造包含特制选项类型25的ICMPv6 Router Advertisement (RA) 数据包。根据搜索引擎返回的信息，该数据包是利用Option Type 25。从PoC代码来看，它使用了类型18和19的选项，并结合了IPv6扩展头部的分片功能。
2.  **触发栈溢出：** 恶意数据包中的错误处理会导致栈溢出。
3.  **远程代码执行或拒绝服务：** 成功利用此漏洞可能允许攻击者在目标系统上执行任意代码（RCE），或导致系统崩溃（蓝屏）。PoC 代码旨在触发蓝屏死机 (BSOD)，这意味着它主要关注拒绝服务。

**POC代码分析：**

*   该PoC使用`scapy`库来构建和发送ICMPv6数据包。
*   它首先构造一个IPv6头部，设置目标IPv6地址和跳数限制。
*   然后，它创建一个ICMPv6 Router Advertisement数据包。
*   该PoC包含两个ICMPv6NDOptRDNSS选项，用于利用漏洞。第一个数据包设置长度，第二个数据包触发溢出。
*   `overwrite`变量包含用于覆盖堆栈的字符。
*   该PoC使用IPv6分片来绕过某些限制并触发漏洞。
*   最后，它将数据包分片并通过网络发送。

**有效性：**

根据PoC的描述和相关搜索结果，该PoC代码能够触发Windows 10 version 2004的蓝屏死机，表明其具有一定的有效性。PoC代码针对性较强，依赖于特定的payload和触发方式，因此可能在不同版本的Windows上有效性有所不同。漏洞库信息也显示漏洞影响多个Windows版本。

**投毒风险：**

PoC代码中存在投毒的风险较低，约为10%。主要基于以下几点：

*   该代码的目的是触发蓝屏，这本身就是一种破坏行为，但并非隐蔽的后门植入。
*   代码比较清晰，主要由scapy库的调用组成，用于构造和发送网络数据包，功能单一，专注于漏洞利用。
*   虽然可能存在隐藏恶意代码的空间（例如在`overwrite`变量中插入shellcode），但当前PoC并未发现此类行为，主要目的是系统崩溃。
*   README.md文件描述了PoC的目的和测试环境，没有迹象表明作者有意隐藏恶意功能。

然而，仍然存在一定的风险，例如：

*   攻击者可能修改PoC代码，添加恶意功能，例如植入后门，然后传播修改后的PoC。
*   即使是蓝屏攻击也可能被滥用，例如用于勒索或破坏系统。

因此，虽然直接投毒的风险较低，但仍需警惕PoC代码被恶意修改和滥用的可能性。

**项目地址:** [0xeb-bp/cve-2020-16898](https://github.com/0xeb-bp/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #2

**来源**: [CVE-2020-16898-CPO-EH_CVE-2020-16898_Checker.md](../2020/CVE-2020-16898-CPO-EH_CVE-2020-16898_Checker.md)

## CVE-2020-16898 "Bad Neighbor" Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，允许远程代码执行

**影响版本:** 受影响的Windows版本包括 Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 以及 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要能够发送特制的ICMPv6 Router Advertisement数据包到目标Windows计算机。目标系统需要启用IPv6 RDNSS。

**POC 可用性:** 是，但提供的代码仅为检测脚本

**投毒风险:** 0%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是一个存在于Windows TCP/IP栈中的远程代码执行漏洞。此漏洞是由于Windows TCP/IP栈未能正确处理ICMPv6 Router Advertisement数据包中的Option Type 25字段造成的。攻击者可以发送特制的ICMPv6 Router Advertisement数据包来触发此漏洞，从而在目标系统上执行任意代码。

**漏洞利用方式：**

1.  攻击者需要构造恶意的ICMPv6 Router Advertisement数据包，该数据包的Option Type 25字段包含畸形或过长的数据。
2.  攻击者将构造的数据包发送到目标Windows系统。
3.  目标系统在处理该数据包时，TCP/IP栈会发生错误，导致缓冲区溢出或内存损坏。
4.  攻击者可以利用此漏洞执行任意代码。

**提供的POC代码分析：**

提供的PowerShell脚本 `CVE-2020-16898_Checker.ps1` 并不是一个漏洞利用代码，而是一个检测脚本，用于检查目标系统的网络接口是否容易受到CVE-2020-16898和CVE-2020-16899的影响。它通过检查网络接口的配置，特别是IPv6 6106选项是否启用，来判断接口是否存在漏洞。该脚本本身不包含任何恶意代码，因此不存在投毒风险。

**投毒风险评估：**

根据对提供的POC代码的分析，未发现任何恶意或隐藏的代码，因此投毒风险为0%。该脚本仅用于检测漏洞的存在，而不是利用漏洞。

**项目地址:** [CPO-EH/CVE-2020-16898_Checker](https://github.com/CPO-EH/CVE-2020-16898_Checker)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #3

**来源**: [CVE-2020-16898-CPO-EH_CVE-2020-16898_Workaround.md](../2020/CVE-2020-16898-CPO-EH_CVE-2020-16898_Workaround.md)

## CVE-2020-16898

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，允许远程攻击者在目标系统上执行代码

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, Windows Server version 2004

**利用条件:** 攻击者需要与目标系统位于同一网络或能够发送 IPv6 数据包到目标系统。

**POC 可用性:** 是，存在利用代码，可触发蓝屏 (BSOD)。

**投毒风险:** 0%

## 详情

CVE-2020-16898 是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞，由于 Windows TCP/IP 协议栈对 ICMPv6 路由器通告数据包处理不当导致。攻击者通过发送特制的 ICMPv6 路由器通告数据包到远程 Windows 计算机，可能导致远程代码执行。根据搜索结果，该漏洞也被称为“Bad Neighbor”，可导致蓝屏死机 (BSOD)。 提供的 PowerShell 脚本 `VCE-2020-16898_QuickWin.ps1`  是官方提供的临时缓解方案，用于禁用受影响网络接口上的基于路由器的 DNS 配置 (RABasedDNSConfig)， 以避免受到攻击，并不是漏洞利用代码。 该脚本的目的是通过禁用受影响接口的 `rabaseddnsconfig` 来缓解漏洞，脚本功能单一，没有发现投毒代码，因此投毒风险为 0%。利用方式主要是发送恶意构造的ICMPv6路由器通告数据包，其中Option Type 25字段存在问题。

**项目地址:** [CPO-EH/CVE-2020-16898_Workaround](https://github.com/CPO-EH/CVE-2020-16898_Workaround)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #4

**来源**: [CVE-2020-16898-Maliek_CVE-2020-16898_Check.md](../2020/CVE-2020-16898-Maliek_CVE-2020-16898_Check.md)

## CVE-2020-16898 "Bad Neighbor"

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 需要与目标系统在同一网络或可路由的网络中，目标系统启用IPv6，且未安装补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-16898 是一个Windows TCP/IP 堆栈远程代码执行漏洞，存在于Windows 系统处理 ICMPv6 路由通告包时。攻击者可以通过发送特制的 ICMPv6 路由通告包到远程Windows 计算机来利用此漏洞。

**有效性：**
根据漏洞描述和搜索结果，此漏洞真实存在，并且有公开的POC。提供的 PowerShell 脚本用于检测目标系统是否存在漏洞，通过检测网卡是否启用了基于RA的DNS配置(RABasedDNSConfig)，以及Windows版本是否是受影响版本。脚本本身并不能直接利用漏洞执行代码，而是用于判断漏洞是否存在。

**投毒风险：**
查看了脚本内容，该脚本主要功能是检测目标系统是否存在CVE-2020-16898漏洞。脚本通过查询注册表和网络接口配置来判断系统和网卡是否在受影响的范围内。未发现任何可以执行恶意代码或进行后门连接的部分。因此，投毒风险为0%。

**利用方式：**
1.  **漏洞触发：** 攻击者需要发送特制的 ICMPv6 路由通告包到目标Windows 计算机。
2.  **漏洞成因：** Windows TCP/IP 堆栈在处理 ICMPv6 路由通告包时，没有正确处理Option Type 25字段，导致缓冲区溢出。
3.  **攻击效果：** 成功的利用可能导致远程代码执行，攻击者可以在目标系统上执行任意代码。
4.  **缓解措施：** 安装 Microsoft 提供的安全更新。禁用 IPv6 RDNSS 配置也可缓解此漏洞，但可能影响IPv6 功能。

**搜索结果总结：**
搜索结果证实了该漏洞的存在和严重性，并提供了关于受影响系统、利用方式和缓解措施的信息。 该漏洞也被称为“Bad Neighbor”，需要及时修复。


**项目地址:** [Maliek/CVE-2020-16898_Check](https://github.com/Maliek/CVE-2020-16898_Check)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #5

**来源**: [CVE-2020-16898-Q1984_CVE-2020-16898.md](../2020/CVE-2020-16898-Q1984_CVE-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** Windows TCP/IP 堆栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709 - 2004, Windows Server 2019, Windows Server version 2004, Windows Server, version 1903/1909

**利用条件:** 需要与目标主机处于同一网络或可发送ICMPv6 Router Advertisement数据包到目标主机。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是Windows TCP/IP堆栈中的一个远程代码执行漏洞。当Windows TCP/IP堆栈不正确地处理ICMPv6 Router Advertisement数据包时，就会出现此漏洞。攻击者可以通过发送特制的ICMPv6 Router Advertisement数据包到远程Windows计算机来利用此漏洞。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响多个Windows版本，且存在公开的PoC代码。搜索结果显示，该漏洞可能导致蓝屏死机（BSOD），进一步说明了其可能导致拒绝服务。尽管有些描述中提到远程代码执行的可能性，但提供的PoC代码的README.md文件表明该PoC主要用于触发BSOD (DoS)。因此，该PoC代码被认为是有效的，至少可以触发拒绝服务攻击。

**投毒风险：**
提供的PoC代码只包含README.md文件，文件内容描述了如何使用`CVE-2020-16898.exe`，并声明“Use at own risk!”。仅凭此信息无法判断`CVE-2020-16898.exe`是否存在恶意代码。但是，考虑到漏洞利用的敏感性，存在一定的投毒风险。由于缺少实际的可执行文件代码，投毒风险评估为低，约为10%。主要原因是无法验证可执行文件的真实功能。

**利用方式：**
1.  **目标确定：** 确定运行受影响Windows版本的计算机。
2.  **网络连接：** 攻击者需要与目标计算机位于同一网络中，或者能够向目标计算机发送ICMPv6 Router Advertisement数据包。
3.  **数据包构造：** 攻击者需要构造特制的ICMPv6 Router Advertisement数据包，其中包含恶意数据，特别是Option Type 25，可能导致缓冲区溢出。
4.  **攻击执行：** 将构造的数据包发送到目标计算机。
5.  **结果：** 成功利用此漏洞可能导致目标计算机蓝屏死机（拒绝服务），或者，如果攻击者能够绕过缓解措施，则可能执行任意代码。快速修复的可用性表示该漏洞可能会导致DoS。

**项目地址:** [Q1984/CVE-2020-16898](https://github.com/Q1984/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #6

**来源**: [CVE-2020-16898-ZephrFish_CVE-2020-16898.md](../2020/CVE-2020-16898-ZephrFish_CVE-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 目标主机开启IPv6，且与攻击者处于同一网络或攻击者能够发送ICMPv6 Router Advertisement报文到目标主机

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2020-16898 "Bad Neighbor" 漏洞存在于 Windows TCP/IP 协议栈中，当其不正确地处理 ICMPv6 路由器通告 (Router Advertisement) 报文时，可能导致远程代码执行。攻击者需要发送特制的 ICMPv6 报文到目标系统，利用Option Type 25触发漏洞。 根据提供的 exploit 代码的 README.md 文件中的描述, 该 exploit 为一个 Windows 可执行文件，需要指定目标主机和用户名。README 中特别提示 "This is a lesson as to why you should not trust binaries on the internet." 以及 "This is an educational exercise. Use at your own risk."，这暗示了此二进制文件可能存在恶意代码或后门. 因此，存在很高的投毒风险。虽然无法直接从提供的文件内容确定其是否恶意，但基于作者的明确警告，投毒的可能性较高。利用方式为，攻击者编译或直接运行提供的二进制文件，并指定目标 IP 地址和用户名，程序会发送恶意 ICMPv6 报文来尝试触发漏洞，实现远程代码执行。

根据搜索结果,此漏洞影响多个windows版本，通过发送恶意的ICMPv6数据包可以触发远程代码执行. 多个安全厂商博客都提到了这个漏洞。

综合分析，漏洞利用的有效性取决于目标系统是否存在漏洞，而投毒风险较高，建议在隔离环境中分析和测试POC。


**项目地址:** [ZephrFish/CVE-2020-16898](https://github.com/ZephrFish/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #7

**来源**: [CVE-2020-16898-advanced-threat-research_CVE-2020-16898.md](../2020/CVE-2020-16898-advanced-threat-research_CVE-2020-16898.md)

# CVE-2020-16898

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-16898-0xeb-bp_cve-2020-16898.md](../2020/CVE-2020-16898-0xeb-bp_cve-2020-16898.md)

## CVE-2020-16898-Windows TCP/IP远程代码执行

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows TCP/IP 栈

**危害等级:** 高危，可能导致远程代码执行和系统崩溃（蓝屏）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, 1909, 2004

**利用条件:** 目标系统需要启用IPv6，且攻击者需要位于与目标系统相同的网络段或能够发送ICMPv6 Router Advertisement 数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898是一个Windows TCP/IP栈中的远程代码执行漏洞。当Windows TCP/IP栈不正确地处理ICMPv6 Router Advertisement数据包时，存在此漏洞。攻击者可以通过发送特制的ICMPv6 Router Advertisement数据包到远程Windows计算机来利用此漏洞。 

**利用方式：**

1.  **发送恶意ICMPv6 RA数据包：** 攻击者构造包含特制选项类型25的ICMPv6 Router Advertisement (RA) 数据包。根据搜索引擎返回的信息，该数据包是利用Option Type 25。从PoC代码来看，它使用了类型18和19的选项，并结合了IPv6扩展头部的分片功能。
2.  **触发栈溢出：** 恶意数据包中的错误处理会导致栈溢出。
3.  **远程代码执行或拒绝服务：** 成功利用此漏洞可能允许攻击者在目标系统上执行任意代码（RCE），或导致系统崩溃（蓝屏）。PoC 代码旨在触发蓝屏死机 (BSOD)，这意味着它主要关注拒绝服务。

**POC代码分析：**

*   该PoC使用`scapy`库来构建和发送ICMPv6数据包。
*   它首先构造一个IPv6头部，设置目标IPv6地址和跳数限制。
*   然后，它创建一个ICMPv6 Router Advertisement数据包。
*   该PoC包含两个ICMPv6NDOptRDNSS选项，用于利用漏洞。第一个数据包设置长度，第二个数据包触发溢出。
*   `overwrite`变量包含用于覆盖堆栈的字符。
*   该PoC使用IPv6分片来绕过某些限制并触发漏洞。
*   最后，它将数据包分片并通过网络发送。

**有效性：**

根据PoC的描述和相关搜索结果，该PoC代码能够触发Windows 10 version 2004的蓝屏死机，表明其具有一定的有效性。PoC代码针对性较强，依赖于特定的payload和触发方式，因此可能在不同版本的Windows上有效性有所不同。漏洞库信息也显示漏洞影响多个Windows版本。

**投毒风险：**

PoC代码中存在投毒的风险较低，约为10%。主要基于以下几点：

*   该代码的目的是触发蓝屏，这本身就是一种破坏行为，但并非隐蔽的后门植入。
*   代码比较清晰，主要由scapy库的调用组成，用于构造和发送网络数据包，功能单一，专注于漏洞利用。
*   虽然可能存在隐藏恶意代码的空间（例如在`overwrite`变量中插入shellcode），但当前PoC并未发现此类行为，主要目的是系统崩溃。
*   README.md文件描述了PoC的目的和测试环境，没有迹象表明作者有意隐藏恶意功能。

然而，仍然存在一定的风险，例如：

*   攻击者可能修改PoC代码，添加恶意功能，例如植入后门，然后传播修改后的PoC。
*   即使是蓝屏攻击也可能被滥用，例如用于勒索或破坏系统。

因此，虽然直接投毒的风险较低，但仍需警惕PoC代码被恶意修改和滥用的可能性。

**项目地址:** [0xeb-bp/cve-2020-16898](https://github.com/0xeb-bp/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #2

**来源**: [CVE-2020-16898-CPO-EH_CVE-2020-16898_Checker.md](../2020/CVE-2020-16898-CPO-EH_CVE-2020-16898_Checker.md)

## CVE-2020-16898 "Bad Neighbor" Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，允许远程代码执行

**影响版本:** 受影响的Windows版本包括 Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 以及 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要能够发送特制的ICMPv6 Router Advertisement数据包到目标Windows计算机。目标系统需要启用IPv6 RDNSS。

**POC 可用性:** 是，但提供的代码仅为检测脚本

**投毒风险:** 0%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是一个存在于Windows TCP/IP栈中的远程代码执行漏洞。此漏洞是由于Windows TCP/IP栈未能正确处理ICMPv6 Router Advertisement数据包中的Option Type 25字段造成的。攻击者可以发送特制的ICMPv6 Router Advertisement数据包来触发此漏洞，从而在目标系统上执行任意代码。

**漏洞利用方式：**

1.  攻击者需要构造恶意的ICMPv6 Router Advertisement数据包，该数据包的Option Type 25字段包含畸形或过长的数据。
2.  攻击者将构造的数据包发送到目标Windows系统。
3.  目标系统在处理该数据包时，TCP/IP栈会发生错误，导致缓冲区溢出或内存损坏。
4.  攻击者可以利用此漏洞执行任意代码。

**提供的POC代码分析：**

提供的PowerShell脚本 `CVE-2020-16898_Checker.ps1` 并不是一个漏洞利用代码，而是一个检测脚本，用于检查目标系统的网络接口是否容易受到CVE-2020-16898和CVE-2020-16899的影响。它通过检查网络接口的配置，特别是IPv6 6106选项是否启用，来判断接口是否存在漏洞。该脚本本身不包含任何恶意代码，因此不存在投毒风险。

**投毒风险评估：**

根据对提供的POC代码的分析，未发现任何恶意或隐藏的代码，因此投毒风险为0%。该脚本仅用于检测漏洞的存在，而不是利用漏洞。

**项目地址:** [CPO-EH/CVE-2020-16898_Checker](https://github.com/CPO-EH/CVE-2020-16898_Checker)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #3

**来源**: [CVE-2020-16898-CPO-EH_CVE-2020-16898_Workaround.md](../2020/CVE-2020-16898-CPO-EH_CVE-2020-16898_Workaround.md)

## CVE-2020-16898

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，允许远程攻击者在目标系统上执行代码

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, Windows Server version 2004

**利用条件:** 攻击者需要与目标系统位于同一网络或能够发送 IPv6 数据包到目标系统。

**POC 可用性:** 是，存在利用代码，可触发蓝屏 (BSOD)。

**投毒风险:** 0%

## 详情

CVE-2020-16898 是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞，由于 Windows TCP/IP 协议栈对 ICMPv6 路由器通告数据包处理不当导致。攻击者通过发送特制的 ICMPv6 路由器通告数据包到远程 Windows 计算机，可能导致远程代码执行。根据搜索结果，该漏洞也被称为“Bad Neighbor”，可导致蓝屏死机 (BSOD)。 提供的 PowerShell 脚本 `VCE-2020-16898_QuickWin.ps1`  是官方提供的临时缓解方案，用于禁用受影响网络接口上的基于路由器的 DNS 配置 (RABasedDNSConfig)， 以避免受到攻击，并不是漏洞利用代码。 该脚本的目的是通过禁用受影响接口的 `rabaseddnsconfig` 来缓解漏洞，脚本功能单一，没有发现投毒代码，因此投毒风险为 0%。利用方式主要是发送恶意构造的ICMPv6路由器通告数据包，其中Option Type 25字段存在问题。

**项目地址:** [CPO-EH/CVE-2020-16898_Workaround](https://github.com/CPO-EH/CVE-2020-16898_Workaround)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #4

**来源**: [CVE-2020-16898-Maliek_CVE-2020-16898_Check.md](../2020/CVE-2020-16898-Maliek_CVE-2020-16898_Check.md)

## CVE-2020-16898 "Bad Neighbor"

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 需要与目标系统在同一网络或可路由的网络中，目标系统启用IPv6，且未安装补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-16898 是一个Windows TCP/IP 堆栈远程代码执行漏洞，存在于Windows 系统处理 ICMPv6 路由通告包时。攻击者可以通过发送特制的 ICMPv6 路由通告包到远程Windows 计算机来利用此漏洞。

**有效性：**
根据漏洞描述和搜索结果，此漏洞真实存在，并且有公开的POC。提供的 PowerShell 脚本用于检测目标系统是否存在漏洞，通过检测网卡是否启用了基于RA的DNS配置(RABasedDNSConfig)，以及Windows版本是否是受影响版本。脚本本身并不能直接利用漏洞执行代码，而是用于判断漏洞是否存在。

**投毒风险：**
查看了脚本内容，该脚本主要功能是检测目标系统是否存在CVE-2020-16898漏洞。脚本通过查询注册表和网络接口配置来判断系统和网卡是否在受影响的范围内。未发现任何可以执行恶意代码或进行后门连接的部分。因此，投毒风险为0%。

**利用方式：**
1.  **漏洞触发：** 攻击者需要发送特制的 ICMPv6 路由通告包到目标Windows 计算机。
2.  **漏洞成因：** Windows TCP/IP 堆栈在处理 ICMPv6 路由通告包时，没有正确处理Option Type 25字段，导致缓冲区溢出。
3.  **攻击效果：** 成功的利用可能导致远程代码执行，攻击者可以在目标系统上执行任意代码。
4.  **缓解措施：** 安装 Microsoft 提供的安全更新。禁用 IPv6 RDNSS 配置也可缓解此漏洞，但可能影响IPv6 功能。

**搜索结果总结：**
搜索结果证实了该漏洞的存在和严重性，并提供了关于受影响系统、利用方式和缓解措施的信息。 该漏洞也被称为“Bad Neighbor”，需要及时修复。


**项目地址:** [Maliek/CVE-2020-16898_Check](https://github.com/Maliek/CVE-2020-16898_Check)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #5

**来源**: [CVE-2020-16898-Q1984_CVE-2020-16898.md](../2020/CVE-2020-16898-Q1984_CVE-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** Windows TCP/IP 堆栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709 - 2004, Windows Server 2019, Windows Server version 2004, Windows Server, version 1903/1909

**利用条件:** 需要与目标主机处于同一网络或可发送ICMPv6 Router Advertisement数据包到目标主机。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是Windows TCP/IP堆栈中的一个远程代码执行漏洞。当Windows TCP/IP堆栈不正确地处理ICMPv6 Router Advertisement数据包时，就会出现此漏洞。攻击者可以通过发送特制的ICMPv6 Router Advertisement数据包到远程Windows计算机来利用此漏洞。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响多个Windows版本，且存在公开的PoC代码。搜索结果显示，该漏洞可能导致蓝屏死机（BSOD），进一步说明了其可能导致拒绝服务。尽管有些描述中提到远程代码执行的可能性，但提供的PoC代码的README.md文件表明该PoC主要用于触发BSOD (DoS)。因此，该PoC代码被认为是有效的，至少可以触发拒绝服务攻击。

**投毒风险：**
提供的PoC代码只包含README.md文件，文件内容描述了如何使用`CVE-2020-16898.exe`，并声明“Use at own risk!”。仅凭此信息无法判断`CVE-2020-16898.exe`是否存在恶意代码。但是，考虑到漏洞利用的敏感性，存在一定的投毒风险。由于缺少实际的可执行文件代码，投毒风险评估为低，约为10%。主要原因是无法验证可执行文件的真实功能。

**利用方式：**
1.  **目标确定：** 确定运行受影响Windows版本的计算机。
2.  **网络连接：** 攻击者需要与目标计算机位于同一网络中，或者能够向目标计算机发送ICMPv6 Router Advertisement数据包。
3.  **数据包构造：** 攻击者需要构造特制的ICMPv6 Router Advertisement数据包，其中包含恶意数据，特别是Option Type 25，可能导致缓冲区溢出。
4.  **攻击执行：** 将构造的数据包发送到目标计算机。
5.  **结果：** 成功利用此漏洞可能导致目标计算机蓝屏死机（拒绝服务），或者，如果攻击者能够绕过缓解措施，则可能执行任意代码。快速修复的可用性表示该漏洞可能会导致DoS。

**项目地址:** [Q1984/CVE-2020-16898](https://github.com/Q1984/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #6

**来源**: [CVE-2020-16898-ZephrFish_CVE-2020-16898.md](../2020/CVE-2020-16898-ZephrFish_CVE-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 目标主机开启IPv6，且与攻击者处于同一网络或攻击者能够发送ICMPv6 Router Advertisement报文到目标主机

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2020-16898 "Bad Neighbor" 漏洞存在于 Windows TCP/IP 协议栈中，当其不正确地处理 ICMPv6 路由器通告 (Router Advertisement) 报文时，可能导致远程代码执行。攻击者需要发送特制的 ICMPv6 报文到目标系统，利用Option Type 25触发漏洞。 根据提供的 exploit 代码的 README.md 文件中的描述, 该 exploit 为一个 Windows 可执行文件，需要指定目标主机和用户名。README 中特别提示 "This is a lesson as to why you should not trust binaries on the internet." 以及 "This is an educational exercise. Use at your own risk."，这暗示了此二进制文件可能存在恶意代码或后门. 因此，存在很高的投毒风险。虽然无法直接从提供的文件内容确定其是否恶意，但基于作者的明确警告，投毒的可能性较高。利用方式为，攻击者编译或直接运行提供的二进制文件，并指定目标 IP 地址和用户名，程序会发送恶意 ICMPv6 报文来尝试触发漏洞，实现远程代码执行。

根据搜索结果,此漏洞影响多个windows版本，通过发送恶意的ICMPv6数据包可以触发远程代码执行. 多个安全厂商博客都提到了这个漏洞。

综合分析，漏洞利用的有效性取决于目标系统是否存在漏洞，而投毒风险较高，建议在隔离环境中分析和测试POC。


**项目地址:** [ZephrFish/CVE-2020-16898](https://github.com/ZephrFish/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #7

**来源**: [CVE-2020-16898-advanced-threat-research_CVE-2020-16898.md](../2020/CVE-2020-16898-advanced-threat-research_CVE-2020-16898.md)

# CVE-2020-16898

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-16898-0xeb-bp_cve-2020-16898.md](../2020/CVE-2020-16898-0xeb-bp_cve-2020-16898.md)

## CVE-2020-16898-Windows TCP/IP远程代码执行

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows TCP/IP 栈

**危害等级:** 高危，可能导致远程代码执行和系统崩溃（蓝屏）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, 1909, 2004

**利用条件:** 目标系统需要启用IPv6，且攻击者需要位于与目标系统相同的网络段或能够发送ICMPv6 Router Advertisement 数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898是一个Windows TCP/IP栈中的远程代码执行漏洞。当Windows TCP/IP栈不正确地处理ICMPv6 Router Advertisement数据包时，存在此漏洞。攻击者可以通过发送特制的ICMPv6 Router Advertisement数据包到远程Windows计算机来利用此漏洞。 

**利用方式：**

1.  **发送恶意ICMPv6 RA数据包：** 攻击者构造包含特制选项类型25的ICMPv6 Router Advertisement (RA) 数据包。根据搜索引擎返回的信息，该数据包是利用Option Type 25。从PoC代码来看，它使用了类型18和19的选项，并结合了IPv6扩展头部的分片功能。
2.  **触发栈溢出：** 恶意数据包中的错误处理会导致栈溢出。
3.  **远程代码执行或拒绝服务：** 成功利用此漏洞可能允许攻击者在目标系统上执行任意代码（RCE），或导致系统崩溃（蓝屏）。PoC 代码旨在触发蓝屏死机 (BSOD)，这意味着它主要关注拒绝服务。

**POC代码分析：**

*   该PoC使用`scapy`库来构建和发送ICMPv6数据包。
*   它首先构造一个IPv6头部，设置目标IPv6地址和跳数限制。
*   然后，它创建一个ICMPv6 Router Advertisement数据包。
*   该PoC包含两个ICMPv6NDOptRDNSS选项，用于利用漏洞。第一个数据包设置长度，第二个数据包触发溢出。
*   `overwrite`变量包含用于覆盖堆栈的字符。
*   该PoC使用IPv6分片来绕过某些限制并触发漏洞。
*   最后，它将数据包分片并通过网络发送。

**有效性：**

根据PoC的描述和相关搜索结果，该PoC代码能够触发Windows 10 version 2004的蓝屏死机，表明其具有一定的有效性。PoC代码针对性较强，依赖于特定的payload和触发方式，因此可能在不同版本的Windows上有效性有所不同。漏洞库信息也显示漏洞影响多个Windows版本。

**投毒风险：**

PoC代码中存在投毒的风险较低，约为10%。主要基于以下几点：

*   该代码的目的是触发蓝屏，这本身就是一种破坏行为，但并非隐蔽的后门植入。
*   代码比较清晰，主要由scapy库的调用组成，用于构造和发送网络数据包，功能单一，专注于漏洞利用。
*   虽然可能存在隐藏恶意代码的空间（例如在`overwrite`变量中插入shellcode），但当前PoC并未发现此类行为，主要目的是系统崩溃。
*   README.md文件描述了PoC的目的和测试环境，没有迹象表明作者有意隐藏恶意功能。

然而，仍然存在一定的风险，例如：

*   攻击者可能修改PoC代码，添加恶意功能，例如植入后门，然后传播修改后的PoC。
*   即使是蓝屏攻击也可能被滥用，例如用于勒索或破坏系统。

因此，虽然直接投毒的风险较低，但仍需警惕PoC代码被恶意修改和滥用的可能性。

**项目地址:** [0xeb-bp/cve-2020-16898](https://github.com/0xeb-bp/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #2

**来源**: [CVE-2020-16898-CPO-EH_CVE-2020-16898_Checker.md](../2020/CVE-2020-16898-CPO-EH_CVE-2020-16898_Checker.md)

## CVE-2020-16898 "Bad Neighbor" Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，允许远程代码执行

**影响版本:** 受影响的Windows版本包括 Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 以及 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要能够发送特制的ICMPv6 Router Advertisement数据包到目标Windows计算机。目标系统需要启用IPv6 RDNSS。

**POC 可用性:** 是，但提供的代码仅为检测脚本

**投毒风险:** 0%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是一个存在于Windows TCP/IP栈中的远程代码执行漏洞。此漏洞是由于Windows TCP/IP栈未能正确处理ICMPv6 Router Advertisement数据包中的Option Type 25字段造成的。攻击者可以发送特制的ICMPv6 Router Advertisement数据包来触发此漏洞，从而在目标系统上执行任意代码。

**漏洞利用方式：**

1.  攻击者需要构造恶意的ICMPv6 Router Advertisement数据包，该数据包的Option Type 25字段包含畸形或过长的数据。
2.  攻击者将构造的数据包发送到目标Windows系统。
3.  目标系统在处理该数据包时，TCP/IP栈会发生错误，导致缓冲区溢出或内存损坏。
4.  攻击者可以利用此漏洞执行任意代码。

**提供的POC代码分析：**

提供的PowerShell脚本 `CVE-2020-16898_Checker.ps1` 并不是一个漏洞利用代码，而是一个检测脚本，用于检查目标系统的网络接口是否容易受到CVE-2020-16898和CVE-2020-16899的影响。它通过检查网络接口的配置，特别是IPv6 6106选项是否启用，来判断接口是否存在漏洞。该脚本本身不包含任何恶意代码，因此不存在投毒风险。

**投毒风险评估：**

根据对提供的POC代码的分析，未发现任何恶意或隐藏的代码，因此投毒风险为0%。该脚本仅用于检测漏洞的存在，而不是利用漏洞。

**项目地址:** [CPO-EH/CVE-2020-16898_Checker](https://github.com/CPO-EH/CVE-2020-16898_Checker)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #3

**来源**: [CVE-2020-16898-CPO-EH_CVE-2020-16898_Workaround.md](../2020/CVE-2020-16898-CPO-EH_CVE-2020-16898_Workaround.md)

## CVE-2020-16898

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，允许远程攻击者在目标系统上执行代码

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, Windows Server version 2004

**利用条件:** 攻击者需要与目标系统位于同一网络或能够发送 IPv6 数据包到目标系统。

**POC 可用性:** 是，存在利用代码，可触发蓝屏 (BSOD)。

**投毒风险:** 0%

## 详情

CVE-2020-16898 是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞，由于 Windows TCP/IP 协议栈对 ICMPv6 路由器通告数据包处理不当导致。攻击者通过发送特制的 ICMPv6 路由器通告数据包到远程 Windows 计算机，可能导致远程代码执行。根据搜索结果，该漏洞也被称为“Bad Neighbor”，可导致蓝屏死机 (BSOD)。 提供的 PowerShell 脚本 `VCE-2020-16898_QuickWin.ps1`  是官方提供的临时缓解方案，用于禁用受影响网络接口上的基于路由器的 DNS 配置 (RABasedDNSConfig)， 以避免受到攻击，并不是漏洞利用代码。 该脚本的目的是通过禁用受影响接口的 `rabaseddnsconfig` 来缓解漏洞，脚本功能单一，没有发现投毒代码，因此投毒风险为 0%。利用方式主要是发送恶意构造的ICMPv6路由器通告数据包，其中Option Type 25字段存在问题。

**项目地址:** [CPO-EH/CVE-2020-16898_Workaround](https://github.com/CPO-EH/CVE-2020-16898_Workaround)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #4

**来源**: [CVE-2020-16898-Maliek_CVE-2020-16898_Check.md](../2020/CVE-2020-16898-Maliek_CVE-2020-16898_Check.md)

## CVE-2020-16898 "Bad Neighbor"

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 需要与目标系统在同一网络或可路由的网络中，目标系统启用IPv6，且未安装补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-16898 是一个Windows TCP/IP 堆栈远程代码执行漏洞，存在于Windows 系统处理 ICMPv6 路由通告包时。攻击者可以通过发送特制的 ICMPv6 路由通告包到远程Windows 计算机来利用此漏洞。

**有效性：**
根据漏洞描述和搜索结果，此漏洞真实存在，并且有公开的POC。提供的 PowerShell 脚本用于检测目标系统是否存在漏洞，通过检测网卡是否启用了基于RA的DNS配置(RABasedDNSConfig)，以及Windows版本是否是受影响版本。脚本本身并不能直接利用漏洞执行代码，而是用于判断漏洞是否存在。

**投毒风险：**
查看了脚本内容，该脚本主要功能是检测目标系统是否存在CVE-2020-16898漏洞。脚本通过查询注册表和网络接口配置来判断系统和网卡是否在受影响的范围内。未发现任何可以执行恶意代码或进行后门连接的部分。因此，投毒风险为0%。

**利用方式：**
1.  **漏洞触发：** 攻击者需要发送特制的 ICMPv6 路由通告包到目标Windows 计算机。
2.  **漏洞成因：** Windows TCP/IP 堆栈在处理 ICMPv6 路由通告包时，没有正确处理Option Type 25字段，导致缓冲区溢出。
3.  **攻击效果：** 成功的利用可能导致远程代码执行，攻击者可以在目标系统上执行任意代码。
4.  **缓解措施：** 安装 Microsoft 提供的安全更新。禁用 IPv6 RDNSS 配置也可缓解此漏洞，但可能影响IPv6 功能。

**搜索结果总结：**
搜索结果证实了该漏洞的存在和严重性，并提供了关于受影响系统、利用方式和缓解措施的信息。 该漏洞也被称为“Bad Neighbor”，需要及时修复。


**项目地址:** [Maliek/CVE-2020-16898_Check](https://github.com/Maliek/CVE-2020-16898_Check)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #5

**来源**: [CVE-2020-16898-Q1984_CVE-2020-16898.md](../2020/CVE-2020-16898-Q1984_CVE-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** Windows TCP/IP 堆栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709 - 2004, Windows Server 2019, Windows Server version 2004, Windows Server, version 1903/1909

**利用条件:** 需要与目标主机处于同一网络或可发送ICMPv6 Router Advertisement数据包到目标主机。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是Windows TCP/IP堆栈中的一个远程代码执行漏洞。当Windows TCP/IP堆栈不正确地处理ICMPv6 Router Advertisement数据包时，就会出现此漏洞。攻击者可以通过发送特制的ICMPv6 Router Advertisement数据包到远程Windows计算机来利用此漏洞。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响多个Windows版本，且存在公开的PoC代码。搜索结果显示，该漏洞可能导致蓝屏死机（BSOD），进一步说明了其可能导致拒绝服务。尽管有些描述中提到远程代码执行的可能性，但提供的PoC代码的README.md文件表明该PoC主要用于触发BSOD (DoS)。因此，该PoC代码被认为是有效的，至少可以触发拒绝服务攻击。

**投毒风险：**
提供的PoC代码只包含README.md文件，文件内容描述了如何使用`CVE-2020-16898.exe`，并声明“Use at own risk!”。仅凭此信息无法判断`CVE-2020-16898.exe`是否存在恶意代码。但是，考虑到漏洞利用的敏感性，存在一定的投毒风险。由于缺少实际的可执行文件代码，投毒风险评估为低，约为10%。主要原因是无法验证可执行文件的真实功能。

**利用方式：**
1.  **目标确定：** 确定运行受影响Windows版本的计算机。
2.  **网络连接：** 攻击者需要与目标计算机位于同一网络中，或者能够向目标计算机发送ICMPv6 Router Advertisement数据包。
3.  **数据包构造：** 攻击者需要构造特制的ICMPv6 Router Advertisement数据包，其中包含恶意数据，特别是Option Type 25，可能导致缓冲区溢出。
4.  **攻击执行：** 将构造的数据包发送到目标计算机。
5.  **结果：** 成功利用此漏洞可能导致目标计算机蓝屏死机（拒绝服务），或者，如果攻击者能够绕过缓解措施，则可能执行任意代码。快速修复的可用性表示该漏洞可能会导致DoS。

**项目地址:** [Q1984/CVE-2020-16898](https://github.com/Q1984/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #6

**来源**: [CVE-2020-16898-ZephrFish_CVE-2020-16898.md](../2020/CVE-2020-16898-ZephrFish_CVE-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 目标主机开启IPv6，且与攻击者处于同一网络或攻击者能够发送ICMPv6 Router Advertisement报文到目标主机

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2020-16898 "Bad Neighbor" 漏洞存在于 Windows TCP/IP 协议栈中，当其不正确地处理 ICMPv6 路由器通告 (Router Advertisement) 报文时，可能导致远程代码执行。攻击者需要发送特制的 ICMPv6 报文到目标系统，利用Option Type 25触发漏洞。 根据提供的 exploit 代码的 README.md 文件中的描述, 该 exploit 为一个 Windows 可执行文件，需要指定目标主机和用户名。README 中特别提示 "This is a lesson as to why you should not trust binaries on the internet." 以及 "This is an educational exercise. Use at your own risk."，这暗示了此二进制文件可能存在恶意代码或后门. 因此，存在很高的投毒风险。虽然无法直接从提供的文件内容确定其是否恶意，但基于作者的明确警告，投毒的可能性较高。利用方式为，攻击者编译或直接运行提供的二进制文件，并指定目标 IP 地址和用户名，程序会发送恶意 ICMPv6 报文来尝试触发漏洞，实现远程代码执行。

根据搜索结果,此漏洞影响多个windows版本，通过发送恶意的ICMPv6数据包可以触发远程代码执行. 多个安全厂商博客都提到了这个漏洞。

综合分析，漏洞利用的有效性取决于目标系统是否存在漏洞，而投毒风险较高，建议在隔离环境中分析和测试POC。


**项目地址:** [ZephrFish/CVE-2020-16898](https://github.com/ZephrFish/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #7

**来源**: [CVE-2020-16898-advanced-threat-research_CVE-2020-16898.md](../2020/CVE-2020-16898-advanced-threat-research_CVE-2020-16898.md)

# CVE-2020-16898

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-16898-0xeb-bp_cve-2020-16898.md](../2020/CVE-2020-16898-0xeb-bp_cve-2020-16898.md)

## CVE-2020-16898-Windows TCP/IP远程代码执行

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows TCP/IP 栈

**危害等级:** 高危，可能导致远程代码执行和系统崩溃（蓝屏）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, 1909, 2004

**利用条件:** 目标系统需要启用IPv6，且攻击者需要位于与目标系统相同的网络段或能够发送ICMPv6 Router Advertisement 数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898是一个Windows TCP/IP栈中的远程代码执行漏洞。当Windows TCP/IP栈不正确地处理ICMPv6 Router Advertisement数据包时，存在此漏洞。攻击者可以通过发送特制的ICMPv6 Router Advertisement数据包到远程Windows计算机来利用此漏洞。 

**利用方式：**

1.  **发送恶意ICMPv6 RA数据包：** 攻击者构造包含特制选项类型25的ICMPv6 Router Advertisement (RA) 数据包。根据搜索引擎返回的信息，该数据包是利用Option Type 25。从PoC代码来看，它使用了类型18和19的选项，并结合了IPv6扩展头部的分片功能。
2.  **触发栈溢出：** 恶意数据包中的错误处理会导致栈溢出。
3.  **远程代码执行或拒绝服务：** 成功利用此漏洞可能允许攻击者在目标系统上执行任意代码（RCE），或导致系统崩溃（蓝屏）。PoC 代码旨在触发蓝屏死机 (BSOD)，这意味着它主要关注拒绝服务。

**POC代码分析：**

*   该PoC使用`scapy`库来构建和发送ICMPv6数据包。
*   它首先构造一个IPv6头部，设置目标IPv6地址和跳数限制。
*   然后，它创建一个ICMPv6 Router Advertisement数据包。
*   该PoC包含两个ICMPv6NDOptRDNSS选项，用于利用漏洞。第一个数据包设置长度，第二个数据包触发溢出。
*   `overwrite`变量包含用于覆盖堆栈的字符。
*   该PoC使用IPv6分片来绕过某些限制并触发漏洞。
*   最后，它将数据包分片并通过网络发送。

**有效性：**

根据PoC的描述和相关搜索结果，该PoC代码能够触发Windows 10 version 2004的蓝屏死机，表明其具有一定的有效性。PoC代码针对性较强，依赖于特定的payload和触发方式，因此可能在不同版本的Windows上有效性有所不同。漏洞库信息也显示漏洞影响多个Windows版本。

**投毒风险：**

PoC代码中存在投毒的风险较低，约为10%。主要基于以下几点：

*   该代码的目的是触发蓝屏，这本身就是一种破坏行为，但并非隐蔽的后门植入。
*   代码比较清晰，主要由scapy库的调用组成，用于构造和发送网络数据包，功能单一，专注于漏洞利用。
*   虽然可能存在隐藏恶意代码的空间（例如在`overwrite`变量中插入shellcode），但当前PoC并未发现此类行为，主要目的是系统崩溃。
*   README.md文件描述了PoC的目的和测试环境，没有迹象表明作者有意隐藏恶意功能。

然而，仍然存在一定的风险，例如：

*   攻击者可能修改PoC代码，添加恶意功能，例如植入后门，然后传播修改后的PoC。
*   即使是蓝屏攻击也可能被滥用，例如用于勒索或破坏系统。

因此，虽然直接投毒的风险较低，但仍需警惕PoC代码被恶意修改和滥用的可能性。

**项目地址:** [0xeb-bp/cve-2020-16898](https://github.com/0xeb-bp/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #2

**来源**: [CVE-2020-16898-CPO-EH_CVE-2020-16898_Checker.md](../2020/CVE-2020-16898-CPO-EH_CVE-2020-16898_Checker.md)

## CVE-2020-16898 "Bad Neighbor" Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，允许远程代码执行

**影响版本:** 受影响的Windows版本包括 Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 以及 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要能够发送特制的ICMPv6 Router Advertisement数据包到目标Windows计算机。目标系统需要启用IPv6 RDNSS。

**POC 可用性:** 是，但提供的代码仅为检测脚本

**投毒风险:** 0%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是一个存在于Windows TCP/IP栈中的远程代码执行漏洞。此漏洞是由于Windows TCP/IP栈未能正确处理ICMPv6 Router Advertisement数据包中的Option Type 25字段造成的。攻击者可以发送特制的ICMPv6 Router Advertisement数据包来触发此漏洞，从而在目标系统上执行任意代码。

**漏洞利用方式：**

1.  攻击者需要构造恶意的ICMPv6 Router Advertisement数据包，该数据包的Option Type 25字段包含畸形或过长的数据。
2.  攻击者将构造的数据包发送到目标Windows系统。
3.  目标系统在处理该数据包时，TCP/IP栈会发生错误，导致缓冲区溢出或内存损坏。
4.  攻击者可以利用此漏洞执行任意代码。

**提供的POC代码分析：**

提供的PowerShell脚本 `CVE-2020-16898_Checker.ps1` 并不是一个漏洞利用代码，而是一个检测脚本，用于检查目标系统的网络接口是否容易受到CVE-2020-16898和CVE-2020-16899的影响。它通过检查网络接口的配置，特别是IPv6 6106选项是否启用，来判断接口是否存在漏洞。该脚本本身不包含任何恶意代码，因此不存在投毒风险。

**投毒风险评估：**

根据对提供的POC代码的分析，未发现任何恶意或隐藏的代码，因此投毒风险为0%。该脚本仅用于检测漏洞的存在，而不是利用漏洞。

**项目地址:** [CPO-EH/CVE-2020-16898_Checker](https://github.com/CPO-EH/CVE-2020-16898_Checker)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #3

**来源**: [CVE-2020-16898-CPO-EH_CVE-2020-16898_Workaround.md](../2020/CVE-2020-16898-CPO-EH_CVE-2020-16898_Workaround.md)

## CVE-2020-16898

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，允许远程攻击者在目标系统上执行代码

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, Windows Server version 2004

**利用条件:** 攻击者需要与目标系统位于同一网络或能够发送 IPv6 数据包到目标系统。

**POC 可用性:** 是，存在利用代码，可触发蓝屏 (BSOD)。

**投毒风险:** 0%

## 详情

CVE-2020-16898 是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞，由于 Windows TCP/IP 协议栈对 ICMPv6 路由器通告数据包处理不当导致。攻击者通过发送特制的 ICMPv6 路由器通告数据包到远程 Windows 计算机，可能导致远程代码执行。根据搜索结果，该漏洞也被称为“Bad Neighbor”，可导致蓝屏死机 (BSOD)。 提供的 PowerShell 脚本 `VCE-2020-16898_QuickWin.ps1`  是官方提供的临时缓解方案，用于禁用受影响网络接口上的基于路由器的 DNS 配置 (RABasedDNSConfig)， 以避免受到攻击，并不是漏洞利用代码。 该脚本的目的是通过禁用受影响接口的 `rabaseddnsconfig` 来缓解漏洞，脚本功能单一，没有发现投毒代码，因此投毒风险为 0%。利用方式主要是发送恶意构造的ICMPv6路由器通告数据包，其中Option Type 25字段存在问题。

**项目地址:** [CPO-EH/CVE-2020-16898_Workaround](https://github.com/CPO-EH/CVE-2020-16898_Workaround)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #4

**来源**: [CVE-2020-16898-Maliek_CVE-2020-16898_Check.md](../2020/CVE-2020-16898-Maliek_CVE-2020-16898_Check.md)

## CVE-2020-16898 "Bad Neighbor"

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 需要与目标系统在同一网络或可路由的网络中，目标系统启用IPv6，且未安装补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-16898 是一个Windows TCP/IP 堆栈远程代码执行漏洞，存在于Windows 系统处理 ICMPv6 路由通告包时。攻击者可以通过发送特制的 ICMPv6 路由通告包到远程Windows 计算机来利用此漏洞。

**有效性：**
根据漏洞描述和搜索结果，此漏洞真实存在，并且有公开的POC。提供的 PowerShell 脚本用于检测目标系统是否存在漏洞，通过检测网卡是否启用了基于RA的DNS配置(RABasedDNSConfig)，以及Windows版本是否是受影响版本。脚本本身并不能直接利用漏洞执行代码，而是用于判断漏洞是否存在。

**投毒风险：**
查看了脚本内容，该脚本主要功能是检测目标系统是否存在CVE-2020-16898漏洞。脚本通过查询注册表和网络接口配置来判断系统和网卡是否在受影响的范围内。未发现任何可以执行恶意代码或进行后门连接的部分。因此，投毒风险为0%。

**利用方式：**
1.  **漏洞触发：** 攻击者需要发送特制的 ICMPv6 路由通告包到目标Windows 计算机。
2.  **漏洞成因：** Windows TCP/IP 堆栈在处理 ICMPv6 路由通告包时，没有正确处理Option Type 25字段，导致缓冲区溢出。
3.  **攻击效果：** 成功的利用可能导致远程代码执行，攻击者可以在目标系统上执行任意代码。
4.  **缓解措施：** 安装 Microsoft 提供的安全更新。禁用 IPv6 RDNSS 配置也可缓解此漏洞，但可能影响IPv6 功能。

**搜索结果总结：**
搜索结果证实了该漏洞的存在和严重性，并提供了关于受影响系统、利用方式和缓解措施的信息。 该漏洞也被称为“Bad Neighbor”，需要及时修复。


**项目地址:** [Maliek/CVE-2020-16898_Check](https://github.com/Maliek/CVE-2020-16898_Check)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #5

**来源**: [CVE-2020-16898-Q1984_CVE-2020-16898.md](../2020/CVE-2020-16898-Q1984_CVE-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** Windows TCP/IP 堆栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709 - 2004, Windows Server 2019, Windows Server version 2004, Windows Server, version 1903/1909

**利用条件:** 需要与目标主机处于同一网络或可发送ICMPv6 Router Advertisement数据包到目标主机。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是Windows TCP/IP堆栈中的一个远程代码执行漏洞。当Windows TCP/IP堆栈不正确地处理ICMPv6 Router Advertisement数据包时，就会出现此漏洞。攻击者可以通过发送特制的ICMPv6 Router Advertisement数据包到远程Windows计算机来利用此漏洞。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响多个Windows版本，且存在公开的PoC代码。搜索结果显示，该漏洞可能导致蓝屏死机（BSOD），进一步说明了其可能导致拒绝服务。尽管有些描述中提到远程代码执行的可能性，但提供的PoC代码的README.md文件表明该PoC主要用于触发BSOD (DoS)。因此，该PoC代码被认为是有效的，至少可以触发拒绝服务攻击。

**投毒风险：**
提供的PoC代码只包含README.md文件，文件内容描述了如何使用`CVE-2020-16898.exe`，并声明“Use at own risk!”。仅凭此信息无法判断`CVE-2020-16898.exe`是否存在恶意代码。但是，考虑到漏洞利用的敏感性，存在一定的投毒风险。由于缺少实际的可执行文件代码，投毒风险评估为低，约为10%。主要原因是无法验证可执行文件的真实功能。

**利用方式：**
1.  **目标确定：** 确定运行受影响Windows版本的计算机。
2.  **网络连接：** 攻击者需要与目标计算机位于同一网络中，或者能够向目标计算机发送ICMPv6 Router Advertisement数据包。
3.  **数据包构造：** 攻击者需要构造特制的ICMPv6 Router Advertisement数据包，其中包含恶意数据，特别是Option Type 25，可能导致缓冲区溢出。
4.  **攻击执行：** 将构造的数据包发送到目标计算机。
5.  **结果：** 成功利用此漏洞可能导致目标计算机蓝屏死机（拒绝服务），或者，如果攻击者能够绕过缓解措施，则可能执行任意代码。快速修复的可用性表示该漏洞可能会导致DoS。

**项目地址:** [Q1984/CVE-2020-16898](https://github.com/Q1984/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #6

**来源**: [CVE-2020-16898-ZephrFish_CVE-2020-16898.md](../2020/CVE-2020-16898-ZephrFish_CVE-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 目标主机开启IPv6，且与攻击者处于同一网络或攻击者能够发送ICMPv6 Router Advertisement报文到目标主机

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2020-16898 "Bad Neighbor" 漏洞存在于 Windows TCP/IP 协议栈中，当其不正确地处理 ICMPv6 路由器通告 (Router Advertisement) 报文时，可能导致远程代码执行。攻击者需要发送特制的 ICMPv6 报文到目标系统，利用Option Type 25触发漏洞。 根据提供的 exploit 代码的 README.md 文件中的描述, 该 exploit 为一个 Windows 可执行文件，需要指定目标主机和用户名。README 中特别提示 "This is a lesson as to why you should not trust binaries on the internet." 以及 "This is an educational exercise. Use at your own risk."，这暗示了此二进制文件可能存在恶意代码或后门. 因此，存在很高的投毒风险。虽然无法直接从提供的文件内容确定其是否恶意，但基于作者的明确警告，投毒的可能性较高。利用方式为，攻击者编译或直接运行提供的二进制文件，并指定目标 IP 地址和用户名，程序会发送恶意 ICMPv6 报文来尝试触发漏洞，实现远程代码执行。

根据搜索结果,此漏洞影响多个windows版本，通过发送恶意的ICMPv6数据包可以触发远程代码执行. 多个安全厂商博客都提到了这个漏洞。

综合分析，漏洞利用的有效性取决于目标系统是否存在漏洞，而投毒风险较高，建议在隔离环境中分析和测试POC。


**项目地址:** [ZephrFish/CVE-2020-16898](https://github.com/ZephrFish/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #7

**来源**: [CVE-2020-16898-advanced-threat-research_CVE-2020-16898.md](../2020/CVE-2020-16898-advanced-threat-research_CVE-2020-16898.md)

# CVE-2020-16898

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-16898-0xeb-bp_cve-2020-16898.md](../2020/CVE-2020-16898-0xeb-bp_cve-2020-16898.md)

## CVE-2020-16898-Windows TCP/IP远程代码执行

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows TCP/IP 栈

**危害等级:** 高危，可能导致远程代码执行和系统崩溃（蓝屏）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, 1909, 2004

**利用条件:** 目标系统需要启用IPv6，且攻击者需要位于与目标系统相同的网络段或能够发送ICMPv6 Router Advertisement 数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898是一个Windows TCP/IP栈中的远程代码执行漏洞。当Windows TCP/IP栈不正确地处理ICMPv6 Router Advertisement数据包时，存在此漏洞。攻击者可以通过发送特制的ICMPv6 Router Advertisement数据包到远程Windows计算机来利用此漏洞。 

**利用方式：**

1.  **发送恶意ICMPv6 RA数据包：** 攻击者构造包含特制选项类型25的ICMPv6 Router Advertisement (RA) 数据包。根据搜索引擎返回的信息，该数据包是利用Option Type 25。从PoC代码来看，它使用了类型18和19的选项，并结合了IPv6扩展头部的分片功能。
2.  **触发栈溢出：** 恶意数据包中的错误处理会导致栈溢出。
3.  **远程代码执行或拒绝服务：** 成功利用此漏洞可能允许攻击者在目标系统上执行任意代码（RCE），或导致系统崩溃（蓝屏）。PoC 代码旨在触发蓝屏死机 (BSOD)，这意味着它主要关注拒绝服务。

**POC代码分析：**

*   该PoC使用`scapy`库来构建和发送ICMPv6数据包。
*   它首先构造一个IPv6头部，设置目标IPv6地址和跳数限制。
*   然后，它创建一个ICMPv6 Router Advertisement数据包。
*   该PoC包含两个ICMPv6NDOptRDNSS选项，用于利用漏洞。第一个数据包设置长度，第二个数据包触发溢出。
*   `overwrite`变量包含用于覆盖堆栈的字符。
*   该PoC使用IPv6分片来绕过某些限制并触发漏洞。
*   最后，它将数据包分片并通过网络发送。

**有效性：**

根据PoC的描述和相关搜索结果，该PoC代码能够触发Windows 10 version 2004的蓝屏死机，表明其具有一定的有效性。PoC代码针对性较强，依赖于特定的payload和触发方式，因此可能在不同版本的Windows上有效性有所不同。漏洞库信息也显示漏洞影响多个Windows版本。

**投毒风险：**

PoC代码中存在投毒的风险较低，约为10%。主要基于以下几点：

*   该代码的目的是触发蓝屏，这本身就是一种破坏行为，但并非隐蔽的后门植入。
*   代码比较清晰，主要由scapy库的调用组成，用于构造和发送网络数据包，功能单一，专注于漏洞利用。
*   虽然可能存在隐藏恶意代码的空间（例如在`overwrite`变量中插入shellcode），但当前PoC并未发现此类行为，主要目的是系统崩溃。
*   README.md文件描述了PoC的目的和测试环境，没有迹象表明作者有意隐藏恶意功能。

然而，仍然存在一定的风险，例如：

*   攻击者可能修改PoC代码，添加恶意功能，例如植入后门，然后传播修改后的PoC。
*   即使是蓝屏攻击也可能被滥用，例如用于勒索或破坏系统。

因此，虽然直接投毒的风险较低，但仍需警惕PoC代码被恶意修改和滥用的可能性。

**项目地址:** [0xeb-bp/cve-2020-16898](https://github.com/0xeb-bp/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #2

**来源**: [CVE-2020-16898-CPO-EH_CVE-2020-16898_Checker.md](../2020/CVE-2020-16898-CPO-EH_CVE-2020-16898_Checker.md)

## CVE-2020-16898 "Bad Neighbor" Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，允许远程代码执行

**影响版本:** 受影响的Windows版本包括 Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 以及 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要能够发送特制的ICMPv6 Router Advertisement数据包到目标Windows计算机。目标系统需要启用IPv6 RDNSS。

**POC 可用性:** 是，但提供的代码仅为检测脚本

**投毒风险:** 0%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是一个存在于Windows TCP/IP栈中的远程代码执行漏洞。此漏洞是由于Windows TCP/IP栈未能正确处理ICMPv6 Router Advertisement数据包中的Option Type 25字段造成的。攻击者可以发送特制的ICMPv6 Router Advertisement数据包来触发此漏洞，从而在目标系统上执行任意代码。

**漏洞利用方式：**

1.  攻击者需要构造恶意的ICMPv6 Router Advertisement数据包，该数据包的Option Type 25字段包含畸形或过长的数据。
2.  攻击者将构造的数据包发送到目标Windows系统。
3.  目标系统在处理该数据包时，TCP/IP栈会发生错误，导致缓冲区溢出或内存损坏。
4.  攻击者可以利用此漏洞执行任意代码。

**提供的POC代码分析：**

提供的PowerShell脚本 `CVE-2020-16898_Checker.ps1` 并不是一个漏洞利用代码，而是一个检测脚本，用于检查目标系统的网络接口是否容易受到CVE-2020-16898和CVE-2020-16899的影响。它通过检查网络接口的配置，特别是IPv6 6106选项是否启用，来判断接口是否存在漏洞。该脚本本身不包含任何恶意代码，因此不存在投毒风险。

**投毒风险评估：**

根据对提供的POC代码的分析，未发现任何恶意或隐藏的代码，因此投毒风险为0%。该脚本仅用于检测漏洞的存在，而不是利用漏洞。

**项目地址:** [CPO-EH/CVE-2020-16898_Checker](https://github.com/CPO-EH/CVE-2020-16898_Checker)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #3

**来源**: [CVE-2020-16898-CPO-EH_CVE-2020-16898_Workaround.md](../2020/CVE-2020-16898-CPO-EH_CVE-2020-16898_Workaround.md)

## CVE-2020-16898

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，允许远程攻击者在目标系统上执行代码

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, Windows Server version 2004

**利用条件:** 攻击者需要与目标系统位于同一网络或能够发送 IPv6 数据包到目标系统。

**POC 可用性:** 是，存在利用代码，可触发蓝屏 (BSOD)。

**投毒风险:** 0%

## 详情

CVE-2020-16898 是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞，由于 Windows TCP/IP 协议栈对 ICMPv6 路由器通告数据包处理不当导致。攻击者通过发送特制的 ICMPv6 路由器通告数据包到远程 Windows 计算机，可能导致远程代码执行。根据搜索结果，该漏洞也被称为“Bad Neighbor”，可导致蓝屏死机 (BSOD)。 提供的 PowerShell 脚本 `VCE-2020-16898_QuickWin.ps1`  是官方提供的临时缓解方案，用于禁用受影响网络接口上的基于路由器的 DNS 配置 (RABasedDNSConfig)， 以避免受到攻击，并不是漏洞利用代码。 该脚本的目的是通过禁用受影响接口的 `rabaseddnsconfig` 来缓解漏洞，脚本功能单一，没有发现投毒代码，因此投毒风险为 0%。利用方式主要是发送恶意构造的ICMPv6路由器通告数据包，其中Option Type 25字段存在问题。

**项目地址:** [CPO-EH/CVE-2020-16898_Workaround](https://github.com/CPO-EH/CVE-2020-16898_Workaround)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #4

**来源**: [CVE-2020-16898-Maliek_CVE-2020-16898_Check.md](../2020/CVE-2020-16898-Maliek_CVE-2020-16898_Check.md)

## CVE-2020-16898 "Bad Neighbor"

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 需要与目标系统在同一网络或可路由的网络中，目标系统启用IPv6，且未安装补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-16898 是一个Windows TCP/IP 堆栈远程代码执行漏洞，存在于Windows 系统处理 ICMPv6 路由通告包时。攻击者可以通过发送特制的 ICMPv6 路由通告包到远程Windows 计算机来利用此漏洞。

**有效性：**
根据漏洞描述和搜索结果，此漏洞真实存在，并且有公开的POC。提供的 PowerShell 脚本用于检测目标系统是否存在漏洞，通过检测网卡是否启用了基于RA的DNS配置(RABasedDNSConfig)，以及Windows版本是否是受影响版本。脚本本身并不能直接利用漏洞执行代码，而是用于判断漏洞是否存在。

**投毒风险：**
查看了脚本内容，该脚本主要功能是检测目标系统是否存在CVE-2020-16898漏洞。脚本通过查询注册表和网络接口配置来判断系统和网卡是否在受影响的范围内。未发现任何可以执行恶意代码或进行后门连接的部分。因此，投毒风险为0%。

**利用方式：**
1.  **漏洞触发：** 攻击者需要发送特制的 ICMPv6 路由通告包到目标Windows 计算机。
2.  **漏洞成因：** Windows TCP/IP 堆栈在处理 ICMPv6 路由通告包时，没有正确处理Option Type 25字段，导致缓冲区溢出。
3.  **攻击效果：** 成功的利用可能导致远程代码执行，攻击者可以在目标系统上执行任意代码。
4.  **缓解措施：** 安装 Microsoft 提供的安全更新。禁用 IPv6 RDNSS 配置也可缓解此漏洞，但可能影响IPv6 功能。

**搜索结果总结：**
搜索结果证实了该漏洞的存在和严重性，并提供了关于受影响系统、利用方式和缓解措施的信息。 该漏洞也被称为“Bad Neighbor”，需要及时修复。


**项目地址:** [Maliek/CVE-2020-16898_Check](https://github.com/Maliek/CVE-2020-16898_Check)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #5

**来源**: [CVE-2020-16898-Q1984_CVE-2020-16898.md](../2020/CVE-2020-16898-Q1984_CVE-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** Windows TCP/IP 堆栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709 - 2004, Windows Server 2019, Windows Server version 2004, Windows Server, version 1903/1909

**利用条件:** 需要与目标主机处于同一网络或可发送ICMPv6 Router Advertisement数据包到目标主机。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是Windows TCP/IP堆栈中的一个远程代码执行漏洞。当Windows TCP/IP堆栈不正确地处理ICMPv6 Router Advertisement数据包时，就会出现此漏洞。攻击者可以通过发送特制的ICMPv6 Router Advertisement数据包到远程Windows计算机来利用此漏洞。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响多个Windows版本，且存在公开的PoC代码。搜索结果显示，该漏洞可能导致蓝屏死机（BSOD），进一步说明了其可能导致拒绝服务。尽管有些描述中提到远程代码执行的可能性，但提供的PoC代码的README.md文件表明该PoC主要用于触发BSOD (DoS)。因此，该PoC代码被认为是有效的，至少可以触发拒绝服务攻击。

**投毒风险：**
提供的PoC代码只包含README.md文件，文件内容描述了如何使用`CVE-2020-16898.exe`，并声明“Use at own risk!”。仅凭此信息无法判断`CVE-2020-16898.exe`是否存在恶意代码。但是，考虑到漏洞利用的敏感性，存在一定的投毒风险。由于缺少实际的可执行文件代码，投毒风险评估为低，约为10%。主要原因是无法验证可执行文件的真实功能。

**利用方式：**
1.  **目标确定：** 确定运行受影响Windows版本的计算机。
2.  **网络连接：** 攻击者需要与目标计算机位于同一网络中，或者能够向目标计算机发送ICMPv6 Router Advertisement数据包。
3.  **数据包构造：** 攻击者需要构造特制的ICMPv6 Router Advertisement数据包，其中包含恶意数据，特别是Option Type 25，可能导致缓冲区溢出。
4.  **攻击执行：** 将构造的数据包发送到目标计算机。
5.  **结果：** 成功利用此漏洞可能导致目标计算机蓝屏死机（拒绝服务），或者，如果攻击者能够绕过缓解措施，则可能执行任意代码。快速修复的可用性表示该漏洞可能会导致DoS。

**项目地址:** [Q1984/CVE-2020-16898](https://github.com/Q1984/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #6

**来源**: [CVE-2020-16898-ZephrFish_CVE-2020-16898.md](../2020/CVE-2020-16898-ZephrFish_CVE-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 目标主机开启IPv6，且与攻击者处于同一网络或攻击者能够发送ICMPv6 Router Advertisement报文到目标主机

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2020-16898 "Bad Neighbor" 漏洞存在于 Windows TCP/IP 协议栈中，当其不正确地处理 ICMPv6 路由器通告 (Router Advertisement) 报文时，可能导致远程代码执行。攻击者需要发送特制的 ICMPv6 报文到目标系统，利用Option Type 25触发漏洞。 根据提供的 exploit 代码的 README.md 文件中的描述, 该 exploit 为一个 Windows 可执行文件，需要指定目标主机和用户名。README 中特别提示 "This is a lesson as to why you should not trust binaries on the internet." 以及 "This is an educational exercise. Use at your own risk."，这暗示了此二进制文件可能存在恶意代码或后门. 因此，存在很高的投毒风险。虽然无法直接从提供的文件内容确定其是否恶意，但基于作者的明确警告，投毒的可能性较高。利用方式为，攻击者编译或直接运行提供的二进制文件，并指定目标 IP 地址和用户名，程序会发送恶意 ICMPv6 报文来尝试触发漏洞，实现远程代码执行。

根据搜索结果,此漏洞影响多个windows版本，通过发送恶意的ICMPv6数据包可以触发远程代码执行. 多个安全厂商博客都提到了这个漏洞。

综合分析，漏洞利用的有效性取决于目标系统是否存在漏洞，而投毒风险较高，建议在隔离环境中分析和测试POC。


**项目地址:** [ZephrFish/CVE-2020-16898](https://github.com/ZephrFish/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #7

**来源**: [CVE-2020-16898-advanced-threat-research_CVE-2020-16898.md](../2020/CVE-2020-16898-advanced-threat-research_CVE-2020-16898.md)

# CVE-2020-16898

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-16898-0xeb-bp_cve-2020-16898.md](../2020/CVE-2020-16898-0xeb-bp_cve-2020-16898.md)

## CVE-2020-16898-Windows TCP/IP远程代码执行

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows TCP/IP 栈

**危害等级:** 高危，可能导致远程代码执行和系统崩溃（蓝屏）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, 1909, 2004

**利用条件:** 目标系统需要启用IPv6，且攻击者需要位于与目标系统相同的网络段或能够发送ICMPv6 Router Advertisement 数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898是一个Windows TCP/IP栈中的远程代码执行漏洞。当Windows TCP/IP栈不正确地处理ICMPv6 Router Advertisement数据包时，存在此漏洞。攻击者可以通过发送特制的ICMPv6 Router Advertisement数据包到远程Windows计算机来利用此漏洞。 

**利用方式：**

1.  **发送恶意ICMPv6 RA数据包：** 攻击者构造包含特制选项类型25的ICMPv6 Router Advertisement (RA) 数据包。根据搜索引擎返回的信息，该数据包是利用Option Type 25。从PoC代码来看，它使用了类型18和19的选项，并结合了IPv6扩展头部的分片功能。
2.  **触发栈溢出：** 恶意数据包中的错误处理会导致栈溢出。
3.  **远程代码执行或拒绝服务：** 成功利用此漏洞可能允许攻击者在目标系统上执行任意代码（RCE），或导致系统崩溃（蓝屏）。PoC 代码旨在触发蓝屏死机 (BSOD)，这意味着它主要关注拒绝服务。

**POC代码分析：**

*   该PoC使用`scapy`库来构建和发送ICMPv6数据包。
*   它首先构造一个IPv6头部，设置目标IPv6地址和跳数限制。
*   然后，它创建一个ICMPv6 Router Advertisement数据包。
*   该PoC包含两个ICMPv6NDOptRDNSS选项，用于利用漏洞。第一个数据包设置长度，第二个数据包触发溢出。
*   `overwrite`变量包含用于覆盖堆栈的字符。
*   该PoC使用IPv6分片来绕过某些限制并触发漏洞。
*   最后，它将数据包分片并通过网络发送。

**有效性：**

根据PoC的描述和相关搜索结果，该PoC代码能够触发Windows 10 version 2004的蓝屏死机，表明其具有一定的有效性。PoC代码针对性较强，依赖于特定的payload和触发方式，因此可能在不同版本的Windows上有效性有所不同。漏洞库信息也显示漏洞影响多个Windows版本。

**投毒风险：**

PoC代码中存在投毒的风险较低，约为10%。主要基于以下几点：

*   该代码的目的是触发蓝屏，这本身就是一种破坏行为，但并非隐蔽的后门植入。
*   代码比较清晰，主要由scapy库的调用组成，用于构造和发送网络数据包，功能单一，专注于漏洞利用。
*   虽然可能存在隐藏恶意代码的空间（例如在`overwrite`变量中插入shellcode），但当前PoC并未发现此类行为，主要目的是系统崩溃。
*   README.md文件描述了PoC的目的和测试环境，没有迹象表明作者有意隐藏恶意功能。

然而，仍然存在一定的风险，例如：

*   攻击者可能修改PoC代码，添加恶意功能，例如植入后门，然后传播修改后的PoC。
*   即使是蓝屏攻击也可能被滥用，例如用于勒索或破坏系统。

因此，虽然直接投毒的风险较低，但仍需警惕PoC代码被恶意修改和滥用的可能性。

**项目地址:** [0xeb-bp/cve-2020-16898](https://github.com/0xeb-bp/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #2

**来源**: [CVE-2020-16898-CPO-EH_CVE-2020-16898_Checker.md](../2020/CVE-2020-16898-CPO-EH_CVE-2020-16898_Checker.md)

## CVE-2020-16898 "Bad Neighbor" Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，允许远程代码执行

**影响版本:** 受影响的Windows版本包括 Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 以及 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要能够发送特制的ICMPv6 Router Advertisement数据包到目标Windows计算机。目标系统需要启用IPv6 RDNSS。

**POC 可用性:** 是，但提供的代码仅为检测脚本

**投毒风险:** 0%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是一个存在于Windows TCP/IP栈中的远程代码执行漏洞。此漏洞是由于Windows TCP/IP栈未能正确处理ICMPv6 Router Advertisement数据包中的Option Type 25字段造成的。攻击者可以发送特制的ICMPv6 Router Advertisement数据包来触发此漏洞，从而在目标系统上执行任意代码。

**漏洞利用方式：**

1.  攻击者需要构造恶意的ICMPv6 Router Advertisement数据包，该数据包的Option Type 25字段包含畸形或过长的数据。
2.  攻击者将构造的数据包发送到目标Windows系统。
3.  目标系统在处理该数据包时，TCP/IP栈会发生错误，导致缓冲区溢出或内存损坏。
4.  攻击者可以利用此漏洞执行任意代码。

**提供的POC代码分析：**

提供的PowerShell脚本 `CVE-2020-16898_Checker.ps1` 并不是一个漏洞利用代码，而是一个检测脚本，用于检查目标系统的网络接口是否容易受到CVE-2020-16898和CVE-2020-16899的影响。它通过检查网络接口的配置，特别是IPv6 6106选项是否启用，来判断接口是否存在漏洞。该脚本本身不包含任何恶意代码，因此不存在投毒风险。

**投毒风险评估：**

根据对提供的POC代码的分析，未发现任何恶意或隐藏的代码，因此投毒风险为0%。该脚本仅用于检测漏洞的存在，而不是利用漏洞。

**项目地址:** [CPO-EH/CVE-2020-16898_Checker](https://github.com/CPO-EH/CVE-2020-16898_Checker)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #3

**来源**: [CVE-2020-16898-CPO-EH_CVE-2020-16898_Workaround.md](../2020/CVE-2020-16898-CPO-EH_CVE-2020-16898_Workaround.md)

## CVE-2020-16898

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，允许远程攻击者在目标系统上执行代码

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, Windows Server version 2004

**利用条件:** 攻击者需要与目标系统位于同一网络或能够发送 IPv6 数据包到目标系统。

**POC 可用性:** 是，存在利用代码，可触发蓝屏 (BSOD)。

**投毒风险:** 0%

## 详情

CVE-2020-16898 是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞，由于 Windows TCP/IP 协议栈对 ICMPv6 路由器通告数据包处理不当导致。攻击者通过发送特制的 ICMPv6 路由器通告数据包到远程 Windows 计算机，可能导致远程代码执行。根据搜索结果，该漏洞也被称为“Bad Neighbor”，可导致蓝屏死机 (BSOD)。 提供的 PowerShell 脚本 `VCE-2020-16898_QuickWin.ps1`  是官方提供的临时缓解方案，用于禁用受影响网络接口上的基于路由器的 DNS 配置 (RABasedDNSConfig)， 以避免受到攻击，并不是漏洞利用代码。 该脚本的目的是通过禁用受影响接口的 `rabaseddnsconfig` 来缓解漏洞，脚本功能单一，没有发现投毒代码，因此投毒风险为 0%。利用方式主要是发送恶意构造的ICMPv6路由器通告数据包，其中Option Type 25字段存在问题。

**项目地址:** [CPO-EH/CVE-2020-16898_Workaround](https://github.com/CPO-EH/CVE-2020-16898_Workaround)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #4

**来源**: [CVE-2020-16898-Maliek_CVE-2020-16898_Check.md](../2020/CVE-2020-16898-Maliek_CVE-2020-16898_Check.md)

## CVE-2020-16898 "Bad Neighbor"

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 需要与目标系统在同一网络或可路由的网络中，目标系统启用IPv6，且未安装补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-16898 是一个Windows TCP/IP 堆栈远程代码执行漏洞，存在于Windows 系统处理 ICMPv6 路由通告包时。攻击者可以通过发送特制的 ICMPv6 路由通告包到远程Windows 计算机来利用此漏洞。

**有效性：**
根据漏洞描述和搜索结果，此漏洞真实存在，并且有公开的POC。提供的 PowerShell 脚本用于检测目标系统是否存在漏洞，通过检测网卡是否启用了基于RA的DNS配置(RABasedDNSConfig)，以及Windows版本是否是受影响版本。脚本本身并不能直接利用漏洞执行代码，而是用于判断漏洞是否存在。

**投毒风险：**
查看了脚本内容，该脚本主要功能是检测目标系统是否存在CVE-2020-16898漏洞。脚本通过查询注册表和网络接口配置来判断系统和网卡是否在受影响的范围内。未发现任何可以执行恶意代码或进行后门连接的部分。因此，投毒风险为0%。

**利用方式：**
1.  **漏洞触发：** 攻击者需要发送特制的 ICMPv6 路由通告包到目标Windows 计算机。
2.  **漏洞成因：** Windows TCP/IP 堆栈在处理 ICMPv6 路由通告包时，没有正确处理Option Type 25字段，导致缓冲区溢出。
3.  **攻击效果：** 成功的利用可能导致远程代码执行，攻击者可以在目标系统上执行任意代码。
4.  **缓解措施：** 安装 Microsoft 提供的安全更新。禁用 IPv6 RDNSS 配置也可缓解此漏洞，但可能影响IPv6 功能。

**搜索结果总结：**
搜索结果证实了该漏洞的存在和严重性，并提供了关于受影响系统、利用方式和缓解措施的信息。 该漏洞也被称为“Bad Neighbor”，需要及时修复。


**项目地址:** [Maliek/CVE-2020-16898_Check](https://github.com/Maliek/CVE-2020-16898_Check)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #5

**来源**: [CVE-2020-16898-Q1984_CVE-2020-16898.md](../2020/CVE-2020-16898-Q1984_CVE-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** Windows TCP/IP 堆栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709 - 2004, Windows Server 2019, Windows Server version 2004, Windows Server, version 1903/1909

**利用条件:** 需要与目标主机处于同一网络或可发送ICMPv6 Router Advertisement数据包到目标主机。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是Windows TCP/IP堆栈中的一个远程代码执行漏洞。当Windows TCP/IP堆栈不正确地处理ICMPv6 Router Advertisement数据包时，就会出现此漏洞。攻击者可以通过发送特制的ICMPv6 Router Advertisement数据包到远程Windows计算机来利用此漏洞。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响多个Windows版本，且存在公开的PoC代码。搜索结果显示，该漏洞可能导致蓝屏死机（BSOD），进一步说明了其可能导致拒绝服务。尽管有些描述中提到远程代码执行的可能性，但提供的PoC代码的README.md文件表明该PoC主要用于触发BSOD (DoS)。因此，该PoC代码被认为是有效的，至少可以触发拒绝服务攻击。

**投毒风险：**
提供的PoC代码只包含README.md文件，文件内容描述了如何使用`CVE-2020-16898.exe`，并声明“Use at own risk!”。仅凭此信息无法判断`CVE-2020-16898.exe`是否存在恶意代码。但是，考虑到漏洞利用的敏感性，存在一定的投毒风险。由于缺少实际的可执行文件代码，投毒风险评估为低，约为10%。主要原因是无法验证可执行文件的真实功能。

**利用方式：**
1.  **目标确定：** 确定运行受影响Windows版本的计算机。
2.  **网络连接：** 攻击者需要与目标计算机位于同一网络中，或者能够向目标计算机发送ICMPv6 Router Advertisement数据包。
3.  **数据包构造：** 攻击者需要构造特制的ICMPv6 Router Advertisement数据包，其中包含恶意数据，特别是Option Type 25，可能导致缓冲区溢出。
4.  **攻击执行：** 将构造的数据包发送到目标计算机。
5.  **结果：** 成功利用此漏洞可能导致目标计算机蓝屏死机（拒绝服务），或者，如果攻击者能够绕过缓解措施，则可能执行任意代码。快速修复的可用性表示该漏洞可能会导致DoS。

**项目地址:** [Q1984/CVE-2020-16898](https://github.com/Q1984/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #6

**来源**: [CVE-2020-16898-ZephrFish_CVE-2020-16898.md](../2020/CVE-2020-16898-ZephrFish_CVE-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 目标主机开启IPv6，且与攻击者处于同一网络或攻击者能够发送ICMPv6 Router Advertisement报文到目标主机

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2020-16898 "Bad Neighbor" 漏洞存在于 Windows TCP/IP 协议栈中，当其不正确地处理 ICMPv6 路由器通告 (Router Advertisement) 报文时，可能导致远程代码执行。攻击者需要发送特制的 ICMPv6 报文到目标系统，利用Option Type 25触发漏洞。 根据提供的 exploit 代码的 README.md 文件中的描述, 该 exploit 为一个 Windows 可执行文件，需要指定目标主机和用户名。README 中特别提示 "This is a lesson as to why you should not trust binaries on the internet." 以及 "This is an educational exercise. Use at your own risk."，这暗示了此二进制文件可能存在恶意代码或后门. 因此，存在很高的投毒风险。虽然无法直接从提供的文件内容确定其是否恶意，但基于作者的明确警告，投毒的可能性较高。利用方式为，攻击者编译或直接运行提供的二进制文件，并指定目标 IP 地址和用户名，程序会发送恶意 ICMPv6 报文来尝试触发漏洞，实现远程代码执行。

根据搜索结果,此漏洞影响多个windows版本，通过发送恶意的ICMPv6数据包可以触发远程代码执行. 多个安全厂商博客都提到了这个漏洞。

综合分析，漏洞利用的有效性取决于目标系统是否存在漏洞，而投毒风险较高，建议在隔离环境中分析和测试POC。


**项目地址:** [ZephrFish/CVE-2020-16898](https://github.com/ZephrFish/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #7

**来源**: [CVE-2020-16898-advanced-threat-research_CVE-2020-16898.md](../2020/CVE-2020-16898-advanced-threat-research_CVE-2020-16898.md)

# CVE-2020-16898

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-16898-0xeb-bp_cve-2020-16898.md](../2020/CVE-2020-16898-0xeb-bp_cve-2020-16898.md)

## CVE-2020-16898-Windows TCP/IP远程代码执行

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows TCP/IP 栈

**危害等级:** 高危，可能导致远程代码执行和系统崩溃（蓝屏）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, 1909, 2004

**利用条件:** 目标系统需要启用IPv6，且攻击者需要位于与目标系统相同的网络段或能够发送ICMPv6 Router Advertisement 数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898是一个Windows TCP/IP栈中的远程代码执行漏洞。当Windows TCP/IP栈不正确地处理ICMPv6 Router Advertisement数据包时，存在此漏洞。攻击者可以通过发送特制的ICMPv6 Router Advertisement数据包到远程Windows计算机来利用此漏洞。 

**利用方式：**

1.  **发送恶意ICMPv6 RA数据包：** 攻击者构造包含特制选项类型25的ICMPv6 Router Advertisement (RA) 数据包。根据搜索引擎返回的信息，该数据包是利用Option Type 25。从PoC代码来看，它使用了类型18和19的选项，并结合了IPv6扩展头部的分片功能。
2.  **触发栈溢出：** 恶意数据包中的错误处理会导致栈溢出。
3.  **远程代码执行或拒绝服务：** 成功利用此漏洞可能允许攻击者在目标系统上执行任意代码（RCE），或导致系统崩溃（蓝屏）。PoC 代码旨在触发蓝屏死机 (BSOD)，这意味着它主要关注拒绝服务。

**POC代码分析：**

*   该PoC使用`scapy`库来构建和发送ICMPv6数据包。
*   它首先构造一个IPv6头部，设置目标IPv6地址和跳数限制。
*   然后，它创建一个ICMPv6 Router Advertisement数据包。
*   该PoC包含两个ICMPv6NDOptRDNSS选项，用于利用漏洞。第一个数据包设置长度，第二个数据包触发溢出。
*   `overwrite`变量包含用于覆盖堆栈的字符。
*   该PoC使用IPv6分片来绕过某些限制并触发漏洞。
*   最后，它将数据包分片并通过网络发送。

**有效性：**

根据PoC的描述和相关搜索结果，该PoC代码能够触发Windows 10 version 2004的蓝屏死机，表明其具有一定的有效性。PoC代码针对性较强，依赖于特定的payload和触发方式，因此可能在不同版本的Windows上有效性有所不同。漏洞库信息也显示漏洞影响多个Windows版本。

**投毒风险：**

PoC代码中存在投毒的风险较低，约为10%。主要基于以下几点：

*   该代码的目的是触发蓝屏，这本身就是一种破坏行为，但并非隐蔽的后门植入。
*   代码比较清晰，主要由scapy库的调用组成，用于构造和发送网络数据包，功能单一，专注于漏洞利用。
*   虽然可能存在隐藏恶意代码的空间（例如在`overwrite`变量中插入shellcode），但当前PoC并未发现此类行为，主要目的是系统崩溃。
*   README.md文件描述了PoC的目的和测试环境，没有迹象表明作者有意隐藏恶意功能。

然而，仍然存在一定的风险，例如：

*   攻击者可能修改PoC代码，添加恶意功能，例如植入后门，然后传播修改后的PoC。
*   即使是蓝屏攻击也可能被滥用，例如用于勒索或破坏系统。

因此，虽然直接投毒的风险较低，但仍需警惕PoC代码被恶意修改和滥用的可能性。

**项目地址:** [0xeb-bp/cve-2020-16898](https://github.com/0xeb-bp/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #2

**来源**: [CVE-2020-16898-CPO-EH_CVE-2020-16898_Checker.md](../2020/CVE-2020-16898-CPO-EH_CVE-2020-16898_Checker.md)

## CVE-2020-16898 "Bad Neighbor" Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，允许远程代码执行

**影响版本:** 受影响的Windows版本包括 Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 以及 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要能够发送特制的ICMPv6 Router Advertisement数据包到目标Windows计算机。目标系统需要启用IPv6 RDNSS。

**POC 可用性:** 是，但提供的代码仅为检测脚本

**投毒风险:** 0%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是一个存在于Windows TCP/IP栈中的远程代码执行漏洞。此漏洞是由于Windows TCP/IP栈未能正确处理ICMPv6 Router Advertisement数据包中的Option Type 25字段造成的。攻击者可以发送特制的ICMPv6 Router Advertisement数据包来触发此漏洞，从而在目标系统上执行任意代码。

**漏洞利用方式：**

1.  攻击者需要构造恶意的ICMPv6 Router Advertisement数据包，该数据包的Option Type 25字段包含畸形或过长的数据。
2.  攻击者将构造的数据包发送到目标Windows系统。
3.  目标系统在处理该数据包时，TCP/IP栈会发生错误，导致缓冲区溢出或内存损坏。
4.  攻击者可以利用此漏洞执行任意代码。

**提供的POC代码分析：**

提供的PowerShell脚本 `CVE-2020-16898_Checker.ps1` 并不是一个漏洞利用代码，而是一个检测脚本，用于检查目标系统的网络接口是否容易受到CVE-2020-16898和CVE-2020-16899的影响。它通过检查网络接口的配置，特别是IPv6 6106选项是否启用，来判断接口是否存在漏洞。该脚本本身不包含任何恶意代码，因此不存在投毒风险。

**投毒风险评估：**

根据对提供的POC代码的分析，未发现任何恶意或隐藏的代码，因此投毒风险为0%。该脚本仅用于检测漏洞的存在，而不是利用漏洞。

**项目地址:** [CPO-EH/CVE-2020-16898_Checker](https://github.com/CPO-EH/CVE-2020-16898_Checker)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #3

**来源**: [CVE-2020-16898-CPO-EH_CVE-2020-16898_Workaround.md](../2020/CVE-2020-16898-CPO-EH_CVE-2020-16898_Workaround.md)

## CVE-2020-16898

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，允许远程攻击者在目标系统上执行代码

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, Windows Server version 2004

**利用条件:** 攻击者需要与目标系统位于同一网络或能够发送 IPv6 数据包到目标系统。

**POC 可用性:** 是，存在利用代码，可触发蓝屏 (BSOD)。

**投毒风险:** 0%

## 详情

CVE-2020-16898 是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞，由于 Windows TCP/IP 协议栈对 ICMPv6 路由器通告数据包处理不当导致。攻击者通过发送特制的 ICMPv6 路由器通告数据包到远程 Windows 计算机，可能导致远程代码执行。根据搜索结果，该漏洞也被称为“Bad Neighbor”，可导致蓝屏死机 (BSOD)。 提供的 PowerShell 脚本 `VCE-2020-16898_QuickWin.ps1`  是官方提供的临时缓解方案，用于禁用受影响网络接口上的基于路由器的 DNS 配置 (RABasedDNSConfig)， 以避免受到攻击，并不是漏洞利用代码。 该脚本的目的是通过禁用受影响接口的 `rabaseddnsconfig` 来缓解漏洞，脚本功能单一，没有发现投毒代码，因此投毒风险为 0%。利用方式主要是发送恶意构造的ICMPv6路由器通告数据包，其中Option Type 25字段存在问题。

**项目地址:** [CPO-EH/CVE-2020-16898_Workaround](https://github.com/CPO-EH/CVE-2020-16898_Workaround)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #4

**来源**: [CVE-2020-16898-Maliek_CVE-2020-16898_Check.md](../2020/CVE-2020-16898-Maliek_CVE-2020-16898_Check.md)

## CVE-2020-16898 "Bad Neighbor"

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 需要与目标系统在同一网络或可路由的网络中，目标系统启用IPv6，且未安装补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-16898 是一个Windows TCP/IP 堆栈远程代码执行漏洞，存在于Windows 系统处理 ICMPv6 路由通告包时。攻击者可以通过发送特制的 ICMPv6 路由通告包到远程Windows 计算机来利用此漏洞。

**有效性：**
根据漏洞描述和搜索结果，此漏洞真实存在，并且有公开的POC。提供的 PowerShell 脚本用于检测目标系统是否存在漏洞，通过检测网卡是否启用了基于RA的DNS配置(RABasedDNSConfig)，以及Windows版本是否是受影响版本。脚本本身并不能直接利用漏洞执行代码，而是用于判断漏洞是否存在。

**投毒风险：**
查看了脚本内容，该脚本主要功能是检测目标系统是否存在CVE-2020-16898漏洞。脚本通过查询注册表和网络接口配置来判断系统和网卡是否在受影响的范围内。未发现任何可以执行恶意代码或进行后门连接的部分。因此，投毒风险为0%。

**利用方式：**
1.  **漏洞触发：** 攻击者需要发送特制的 ICMPv6 路由通告包到目标Windows 计算机。
2.  **漏洞成因：** Windows TCP/IP 堆栈在处理 ICMPv6 路由通告包时，没有正确处理Option Type 25字段，导致缓冲区溢出。
3.  **攻击效果：** 成功的利用可能导致远程代码执行，攻击者可以在目标系统上执行任意代码。
4.  **缓解措施：** 安装 Microsoft 提供的安全更新。禁用 IPv6 RDNSS 配置也可缓解此漏洞，但可能影响IPv6 功能。

**搜索结果总结：**
搜索结果证实了该漏洞的存在和严重性，并提供了关于受影响系统、利用方式和缓解措施的信息。 该漏洞也被称为“Bad Neighbor”，需要及时修复。


**项目地址:** [Maliek/CVE-2020-16898_Check](https://github.com/Maliek/CVE-2020-16898_Check)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #5

**来源**: [CVE-2020-16898-Q1984_CVE-2020-16898.md](../2020/CVE-2020-16898-Q1984_CVE-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** Windows TCP/IP 堆栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709 - 2004, Windows Server 2019, Windows Server version 2004, Windows Server, version 1903/1909

**利用条件:** 需要与目标主机处于同一网络或可发送ICMPv6 Router Advertisement数据包到目标主机。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是Windows TCP/IP堆栈中的一个远程代码执行漏洞。当Windows TCP/IP堆栈不正确地处理ICMPv6 Router Advertisement数据包时，就会出现此漏洞。攻击者可以通过发送特制的ICMPv6 Router Advertisement数据包到远程Windows计算机来利用此漏洞。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响多个Windows版本，且存在公开的PoC代码。搜索结果显示，该漏洞可能导致蓝屏死机（BSOD），进一步说明了其可能导致拒绝服务。尽管有些描述中提到远程代码执行的可能性，但提供的PoC代码的README.md文件表明该PoC主要用于触发BSOD (DoS)。因此，该PoC代码被认为是有效的，至少可以触发拒绝服务攻击。

**投毒风险：**
提供的PoC代码只包含README.md文件，文件内容描述了如何使用`CVE-2020-16898.exe`，并声明“Use at own risk!”。仅凭此信息无法判断`CVE-2020-16898.exe`是否存在恶意代码。但是，考虑到漏洞利用的敏感性，存在一定的投毒风险。由于缺少实际的可执行文件代码，投毒风险评估为低，约为10%。主要原因是无法验证可执行文件的真实功能。

**利用方式：**
1.  **目标确定：** 确定运行受影响Windows版本的计算机。
2.  **网络连接：** 攻击者需要与目标计算机位于同一网络中，或者能够向目标计算机发送ICMPv6 Router Advertisement数据包。
3.  **数据包构造：** 攻击者需要构造特制的ICMPv6 Router Advertisement数据包，其中包含恶意数据，特别是Option Type 25，可能导致缓冲区溢出。
4.  **攻击执行：** 将构造的数据包发送到目标计算机。
5.  **结果：** 成功利用此漏洞可能导致目标计算机蓝屏死机（拒绝服务），或者，如果攻击者能够绕过缓解措施，则可能执行任意代码。快速修复的可用性表示该漏洞可能会导致DoS。

**项目地址:** [Q1984/CVE-2020-16898](https://github.com/Q1984/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #6

**来源**: [CVE-2020-16898-ZephrFish_CVE-2020-16898.md](../2020/CVE-2020-16898-ZephrFish_CVE-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 目标主机开启IPv6，且与攻击者处于同一网络或攻击者能够发送ICMPv6 Router Advertisement报文到目标主机

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2020-16898 "Bad Neighbor" 漏洞存在于 Windows TCP/IP 协议栈中，当其不正确地处理 ICMPv6 路由器通告 (Router Advertisement) 报文时，可能导致远程代码执行。攻击者需要发送特制的 ICMPv6 报文到目标系统，利用Option Type 25触发漏洞。 根据提供的 exploit 代码的 README.md 文件中的描述, 该 exploit 为一个 Windows 可执行文件，需要指定目标主机和用户名。README 中特别提示 "This is a lesson as to why you should not trust binaries on the internet." 以及 "This is an educational exercise. Use at your own risk."，这暗示了此二进制文件可能存在恶意代码或后门. 因此，存在很高的投毒风险。虽然无法直接从提供的文件内容确定其是否恶意，但基于作者的明确警告，投毒的可能性较高。利用方式为，攻击者编译或直接运行提供的二进制文件，并指定目标 IP 地址和用户名，程序会发送恶意 ICMPv6 报文来尝试触发漏洞，实现远程代码执行。

根据搜索结果,此漏洞影响多个windows版本，通过发送恶意的ICMPv6数据包可以触发远程代码执行. 多个安全厂商博客都提到了这个漏洞。

综合分析，漏洞利用的有效性取决于目标系统是否存在漏洞，而投毒风险较高，建议在隔离环境中分析和测试POC。


**项目地址:** [ZephrFish/CVE-2020-16898](https://github.com/ZephrFish/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #7

**来源**: [CVE-2020-16898-advanced-threat-research_CVE-2020-16898.md](../2020/CVE-2020-16898-advanced-threat-research_CVE-2020-16898.md)

# CVE-2020-16898

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-16898-0xeb-bp_cve-2020-16898.md](../2020/CVE-2020-16898-0xeb-bp_cve-2020-16898.md)

## CVE-2020-16898-Windows TCP/IP远程代码执行

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows TCP/IP 栈

**危害等级:** 高危，可能导致远程代码执行和系统崩溃（蓝屏）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, 1909, 2004

**利用条件:** 目标系统需要启用IPv6，且攻击者需要位于与目标系统相同的网络段或能够发送ICMPv6 Router Advertisement 数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898是一个Windows TCP/IP栈中的远程代码执行漏洞。当Windows TCP/IP栈不正确地处理ICMPv6 Router Advertisement数据包时，存在此漏洞。攻击者可以通过发送特制的ICMPv6 Router Advertisement数据包到远程Windows计算机来利用此漏洞。 

**利用方式：**

1.  **发送恶意ICMPv6 RA数据包：** 攻击者构造包含特制选项类型25的ICMPv6 Router Advertisement (RA) 数据包。根据搜索引擎返回的信息，该数据包是利用Option Type 25。从PoC代码来看，它使用了类型18和19的选项，并结合了IPv6扩展头部的分片功能。
2.  **触发栈溢出：** 恶意数据包中的错误处理会导致栈溢出。
3.  **远程代码执行或拒绝服务：** 成功利用此漏洞可能允许攻击者在目标系统上执行任意代码（RCE），或导致系统崩溃（蓝屏）。PoC 代码旨在触发蓝屏死机 (BSOD)，这意味着它主要关注拒绝服务。

**POC代码分析：**

*   该PoC使用`scapy`库来构建和发送ICMPv6数据包。
*   它首先构造一个IPv6头部，设置目标IPv6地址和跳数限制。
*   然后，它创建一个ICMPv6 Router Advertisement数据包。
*   该PoC包含两个ICMPv6NDOptRDNSS选项，用于利用漏洞。第一个数据包设置长度，第二个数据包触发溢出。
*   `overwrite`变量包含用于覆盖堆栈的字符。
*   该PoC使用IPv6分片来绕过某些限制并触发漏洞。
*   最后，它将数据包分片并通过网络发送。

**有效性：**

根据PoC的描述和相关搜索结果，该PoC代码能够触发Windows 10 version 2004的蓝屏死机，表明其具有一定的有效性。PoC代码针对性较强，依赖于特定的payload和触发方式，因此可能在不同版本的Windows上有效性有所不同。漏洞库信息也显示漏洞影响多个Windows版本。

**投毒风险：**

PoC代码中存在投毒的风险较低，约为10%。主要基于以下几点：

*   该代码的目的是触发蓝屏，这本身就是一种破坏行为，但并非隐蔽的后门植入。
*   代码比较清晰，主要由scapy库的调用组成，用于构造和发送网络数据包，功能单一，专注于漏洞利用。
*   虽然可能存在隐藏恶意代码的空间（例如在`overwrite`变量中插入shellcode），但当前PoC并未发现此类行为，主要目的是系统崩溃。
*   README.md文件描述了PoC的目的和测试环境，没有迹象表明作者有意隐藏恶意功能。

然而，仍然存在一定的风险，例如：

*   攻击者可能修改PoC代码，添加恶意功能，例如植入后门，然后传播修改后的PoC。
*   即使是蓝屏攻击也可能被滥用，例如用于勒索或破坏系统。

因此，虽然直接投毒的风险较低，但仍需警惕PoC代码被恶意修改和滥用的可能性。

**项目地址:** [0xeb-bp/cve-2020-16898](https://github.com/0xeb-bp/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #2

**来源**: [CVE-2020-16898-CPO-EH_CVE-2020-16898_Checker.md](../2020/CVE-2020-16898-CPO-EH_CVE-2020-16898_Checker.md)

## CVE-2020-16898 "Bad Neighbor" Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，允许远程代码执行

**影响版本:** 受影响的Windows版本包括 Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 以及 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要能够发送特制的ICMPv6 Router Advertisement数据包到目标Windows计算机。目标系统需要启用IPv6 RDNSS。

**POC 可用性:** 是，但提供的代码仅为检测脚本

**投毒风险:** 0%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是一个存在于Windows TCP/IP栈中的远程代码执行漏洞。此漏洞是由于Windows TCP/IP栈未能正确处理ICMPv6 Router Advertisement数据包中的Option Type 25字段造成的。攻击者可以发送特制的ICMPv6 Router Advertisement数据包来触发此漏洞，从而在目标系统上执行任意代码。

**漏洞利用方式：**

1.  攻击者需要构造恶意的ICMPv6 Router Advertisement数据包，该数据包的Option Type 25字段包含畸形或过长的数据。
2.  攻击者将构造的数据包发送到目标Windows系统。
3.  目标系统在处理该数据包时，TCP/IP栈会发生错误，导致缓冲区溢出或内存损坏。
4.  攻击者可以利用此漏洞执行任意代码。

**提供的POC代码分析：**

提供的PowerShell脚本 `CVE-2020-16898_Checker.ps1` 并不是一个漏洞利用代码，而是一个检测脚本，用于检查目标系统的网络接口是否容易受到CVE-2020-16898和CVE-2020-16899的影响。它通过检查网络接口的配置，特别是IPv6 6106选项是否启用，来判断接口是否存在漏洞。该脚本本身不包含任何恶意代码，因此不存在投毒风险。

**投毒风险评估：**

根据对提供的POC代码的分析，未发现任何恶意或隐藏的代码，因此投毒风险为0%。该脚本仅用于检测漏洞的存在，而不是利用漏洞。

**项目地址:** [CPO-EH/CVE-2020-16898_Checker](https://github.com/CPO-EH/CVE-2020-16898_Checker)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #3

**来源**: [CVE-2020-16898-CPO-EH_CVE-2020-16898_Workaround.md](../2020/CVE-2020-16898-CPO-EH_CVE-2020-16898_Workaround.md)

## CVE-2020-16898

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，允许远程攻击者在目标系统上执行代码

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, Windows Server version 2004

**利用条件:** 攻击者需要与目标系统位于同一网络或能够发送 IPv6 数据包到目标系统。

**POC 可用性:** 是，存在利用代码，可触发蓝屏 (BSOD)。

**投毒风险:** 0%

## 详情

CVE-2020-16898 是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞，由于 Windows TCP/IP 协议栈对 ICMPv6 路由器通告数据包处理不当导致。攻击者通过发送特制的 ICMPv6 路由器通告数据包到远程 Windows 计算机，可能导致远程代码执行。根据搜索结果，该漏洞也被称为“Bad Neighbor”，可导致蓝屏死机 (BSOD)。 提供的 PowerShell 脚本 `VCE-2020-16898_QuickWin.ps1`  是官方提供的临时缓解方案，用于禁用受影响网络接口上的基于路由器的 DNS 配置 (RABasedDNSConfig)， 以避免受到攻击，并不是漏洞利用代码。 该脚本的目的是通过禁用受影响接口的 `rabaseddnsconfig` 来缓解漏洞，脚本功能单一，没有发现投毒代码，因此投毒风险为 0%。利用方式主要是发送恶意构造的ICMPv6路由器通告数据包，其中Option Type 25字段存在问题。

**项目地址:** [CPO-EH/CVE-2020-16898_Workaround](https://github.com/CPO-EH/CVE-2020-16898_Workaround)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #4

**来源**: [CVE-2020-16898-Maliek_CVE-2020-16898_Check.md](../2020/CVE-2020-16898-Maliek_CVE-2020-16898_Check.md)

## CVE-2020-16898 "Bad Neighbor"

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 需要与目标系统在同一网络或可路由的网络中，目标系统启用IPv6，且未安装补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-16898 是一个Windows TCP/IP 堆栈远程代码执行漏洞，存在于Windows 系统处理 ICMPv6 路由通告包时。攻击者可以通过发送特制的 ICMPv6 路由通告包到远程Windows 计算机来利用此漏洞。

**有效性：**
根据漏洞描述和搜索结果，此漏洞真实存在，并且有公开的POC。提供的 PowerShell 脚本用于检测目标系统是否存在漏洞，通过检测网卡是否启用了基于RA的DNS配置(RABasedDNSConfig)，以及Windows版本是否是受影响版本。脚本本身并不能直接利用漏洞执行代码，而是用于判断漏洞是否存在。

**投毒风险：**
查看了脚本内容，该脚本主要功能是检测目标系统是否存在CVE-2020-16898漏洞。脚本通过查询注册表和网络接口配置来判断系统和网卡是否在受影响的范围内。未发现任何可以执行恶意代码或进行后门连接的部分。因此，投毒风险为0%。

**利用方式：**
1.  **漏洞触发：** 攻击者需要发送特制的 ICMPv6 路由通告包到目标Windows 计算机。
2.  **漏洞成因：** Windows TCP/IP 堆栈在处理 ICMPv6 路由通告包时，没有正确处理Option Type 25字段，导致缓冲区溢出。
3.  **攻击效果：** 成功的利用可能导致远程代码执行，攻击者可以在目标系统上执行任意代码。
4.  **缓解措施：** 安装 Microsoft 提供的安全更新。禁用 IPv6 RDNSS 配置也可缓解此漏洞，但可能影响IPv6 功能。

**搜索结果总结：**
搜索结果证实了该漏洞的存在和严重性，并提供了关于受影响系统、利用方式和缓解措施的信息。 该漏洞也被称为“Bad Neighbor”，需要及时修复。


**项目地址:** [Maliek/CVE-2020-16898_Check](https://github.com/Maliek/CVE-2020-16898_Check)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #5

**来源**: [CVE-2020-16898-Q1984_CVE-2020-16898.md](../2020/CVE-2020-16898-Q1984_CVE-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** Windows TCP/IP 堆栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709 - 2004, Windows Server 2019, Windows Server version 2004, Windows Server, version 1903/1909

**利用条件:** 需要与目标主机处于同一网络或可发送ICMPv6 Router Advertisement数据包到目标主机。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是Windows TCP/IP堆栈中的一个远程代码执行漏洞。当Windows TCP/IP堆栈不正确地处理ICMPv6 Router Advertisement数据包时，就会出现此漏洞。攻击者可以通过发送特制的ICMPv6 Router Advertisement数据包到远程Windows计算机来利用此漏洞。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响多个Windows版本，且存在公开的PoC代码。搜索结果显示，该漏洞可能导致蓝屏死机（BSOD），进一步说明了其可能导致拒绝服务。尽管有些描述中提到远程代码执行的可能性，但提供的PoC代码的README.md文件表明该PoC主要用于触发BSOD (DoS)。因此，该PoC代码被认为是有效的，至少可以触发拒绝服务攻击。

**投毒风险：**
提供的PoC代码只包含README.md文件，文件内容描述了如何使用`CVE-2020-16898.exe`，并声明“Use at own risk!”。仅凭此信息无法判断`CVE-2020-16898.exe`是否存在恶意代码。但是，考虑到漏洞利用的敏感性，存在一定的投毒风险。由于缺少实际的可执行文件代码，投毒风险评估为低，约为10%。主要原因是无法验证可执行文件的真实功能。

**利用方式：**
1.  **目标确定：** 确定运行受影响Windows版本的计算机。
2.  **网络连接：** 攻击者需要与目标计算机位于同一网络中，或者能够向目标计算机发送ICMPv6 Router Advertisement数据包。
3.  **数据包构造：** 攻击者需要构造特制的ICMPv6 Router Advertisement数据包，其中包含恶意数据，特别是Option Type 25，可能导致缓冲区溢出。
4.  **攻击执行：** 将构造的数据包发送到目标计算机。
5.  **结果：** 成功利用此漏洞可能导致目标计算机蓝屏死机（拒绝服务），或者，如果攻击者能够绕过缓解措施，则可能执行任意代码。快速修复的可用性表示该漏洞可能会导致DoS。

**项目地址:** [Q1984/CVE-2020-16898](https://github.com/Q1984/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #6

**来源**: [CVE-2020-16898-ZephrFish_CVE-2020-16898.md](../2020/CVE-2020-16898-ZephrFish_CVE-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 目标主机开启IPv6，且与攻击者处于同一网络或攻击者能够发送ICMPv6 Router Advertisement报文到目标主机

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2020-16898 "Bad Neighbor" 漏洞存在于 Windows TCP/IP 协议栈中，当其不正确地处理 ICMPv6 路由器通告 (Router Advertisement) 报文时，可能导致远程代码执行。攻击者需要发送特制的 ICMPv6 报文到目标系统，利用Option Type 25触发漏洞。 根据提供的 exploit 代码的 README.md 文件中的描述, 该 exploit 为一个 Windows 可执行文件，需要指定目标主机和用户名。README 中特别提示 "This is a lesson as to why you should not trust binaries on the internet." 以及 "This is an educational exercise. Use at your own risk."，这暗示了此二进制文件可能存在恶意代码或后门. 因此，存在很高的投毒风险。虽然无法直接从提供的文件内容确定其是否恶意，但基于作者的明确警告，投毒的可能性较高。利用方式为，攻击者编译或直接运行提供的二进制文件，并指定目标 IP 地址和用户名，程序会发送恶意 ICMPv6 报文来尝试触发漏洞，实现远程代码执行。

根据搜索结果,此漏洞影响多个windows版本，通过发送恶意的ICMPv6数据包可以触发远程代码执行. 多个安全厂商博客都提到了这个漏洞。

综合分析，漏洞利用的有效性取决于目标系统是否存在漏洞，而投毒风险较高，建议在隔离环境中分析和测试POC。


**项目地址:** [ZephrFish/CVE-2020-16898](https://github.com/ZephrFish/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #7

**来源**: [CVE-2020-16898-advanced-threat-research_CVE-2020-16898.md](../2020/CVE-2020-16898-advanced-threat-research_CVE-2020-16898.md)

## CVE-2020-16898: Windows TCP/IP 远程代码执行漏洞 ("Bad Neighbor")

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行、拒绝服务

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要与目标系统处于同一网络邻接，发送特制的 ICMPv6 路由器通告数据包

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-16898 "Bad Neighbor" 漏洞存在于 Windows TCP/IP 堆栈中，当其不正确地处理 ICMPv6 路由器通告数据包时，可能导致远程代码执行。攻击者可以通过发送特制的 ICMPv6 数据包利用此漏洞。

**有效性：**
提供的 POC 代码（Suricata 规则和 Lua 脚本）旨在检测利用 CVE-2020-16898 的攻击，而非直接利用该漏洞。它通过检查 ICMPv6 路由器通告数据包中的 RDNSS 选项长度是否为偶数来识别潜在的攻击行为。根据漏洞描述，偶数长度的 RDNSS 选项是非法的，可能触发漏洞。搜索引擎结果显示该漏洞存在PoC，可导致蓝屏死机（BSOD），因此可以判断存在有效的利用方式。

**投毒风险：**
该仓库主要提供的是检测规则和相关的lua脚本，用于检测尝试利用漏洞的流量。Lua 脚本的功能是解析 ICMPv6 数据包并检查 RDNSS 选项的长度。代码逻辑相对简单，没有发现明显的恶意行为或后门。但是，任何代码都存在被恶意修改的风险，尽管此仓库中直接植入恶意代码的可能性较低。可以判定存在极低的投毒风险。

**利用方式：**
1.  攻击者需要与目标 Windows 系统处于同一网络邻接（因为 ICMPv6 邻居发现协议在本地链路操作）。
2.  攻击者发送特制的 ICMPv6 路由器通告数据包。
3.  此数据包包含一个 RDNSS 选项（类型 25），其长度字段被设置为偶数。这违反了 RFC 规定。
4.  Windows TCP/IP 堆栈在处理此非法 RDNSS 选项时，由于不正确的边界检查或缓冲区溢出，导致崩溃或执行任意代码。利用的根本原因是由于ICMPv6 Router Advertisement报文处理不当，Option Type 25长度校验存在缺陷。
5.  如果攻击成功，攻击者可以在目标系统上执行任意代码，或者造成拒绝服务（BSOD）。

**项目地址:** [advanced-threat-research/CVE-2020-16898](https://github.com/advanced-threat-research/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #8

**来源**: [CVE-2020-16898-corelight_CVE-2020-16898.md](../2020/CVE-2020-16898-corelight_CVE-2020-16898.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞（Bad Neighbor）

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行，完全控制受影响系统

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, Windows Server version 2004 等多个版本受影响

**利用条件:** 攻击者需要与目标主机处于同一网络邻域，或者能够发送伪造的 ICMPv6 路由通告数据包到目标主机

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Windows TCP/IP 协议栈中，当其处理 ICMPv6 路由通告数据包时，未能正确解析其中的 RDNSS 选项（Option Type 25），导致内存损坏，进而允许攻击者执行任意代码。攻击者通过发送特制的 ICMPv6 路由通告数据包来触发此漏洞。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞是一个真实存在的远程代码执行漏洞，并且已经有公开的PoC代码。提供的Zeek脚本是一个网络检测包，用于检测利用此漏洞的恶意流量。它通过分析 ICMPv6 路由通告数据包，特别是检查 RDNSS 选项的长度是否为偶数来判断是否存在攻击。

**投毒风险分析：**

提供的PoC代码（Zeek脚本）主要用于检测攻击，而不是利用攻击。仔细检查提供的文件，包括`LICENSE`, `README.md`, `bro-pkg.meta`, `zkg.meta`, `scripts/CVE-2020-16898.zeek`, 和 `scripts/__load__.zeek`，没有发现明显的恶意代码或后门。代码逻辑清晰，主要是检测 ICMPv6 路由通告消息中 RDNSS 选项的长度是否合法。脚本通过生成 Notice 日志来告知管理员存在潜在的攻击行为。投毒的风险较低，但仍存在微小可能性，例如利用 Zeek 脚本的复杂性进行隐藏，或者利用 Zeek 本身的漏洞执行恶意操作。因此，保守估计投毒风险为5%。

**利用方式分析：**

1.  **攻击者构造恶意的 ICMPv6 路由通告数据包：** 数据包中包含一个格式错误的 RDNSS 选项（Option Type 25），其长度为非偶数。
2.  **攻击者将恶意数据包发送给目标 Windows 主机：** 可以通过本地网络发送，也可以通过中间人攻击等方式。
3.  **目标主机处理恶意数据包：** Windows TCP/IP 协议栈在处理该数据包时，由于 RDNSS 选项的长度错误，导致内存溢出。
4.  **攻击者利用内存溢出执行任意代码：** 攻击者可以在溢出的内存中写入恶意代码，并控制程序的执行流程，最终实现远程代码执行。

提供的 Zeek 脚本并不能直接利用漏洞，而是用于检测网络流量中是否存在利用此漏洞的攻击行为。 它通过检测 ICMPv6 路由通告消息中的 Recursive_DNS_Server_Option (RDNSS) 是否存在长度异常的情况（长度不为偶数）来进行判断。 如果发现异常，则会产生一个Notice告警。

**项目地址:** [corelight/CVE-2020-16898](https://github.com/corelight/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #9

**来源**: [CVE-2020-16898-esnet-security_cve-2020-16898.md](../2020/CVE-2020-16898-esnet-security_cve-2020-16898.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞 (Bad Neighbor)

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行，系统控制

**影响版本:** Windows 10 版本 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, 版本 1903, 版本 2004

**利用条件:** 攻击者需要与目标系统处于同一网络段，并发送特制的 ICMPv6 路由器通告数据包。

**POC 可用性:** 是，网络上已存在公开的PoC

**投毒风险:** 10%

## 详情

CVE-2020-16898 是一个存在于 Windows TCP/IP 协议栈中的远程代码执行漏洞。当 Windows TCP/IP 协议栈未正确处理 ICMPv6 路由器通告 (Router Advertisement) 数据包时，会导致此漏洞。攻击者可以通过向远程 Windows 计算机发送特制的 ICMPv6 路由器通告数据包来利用此漏洞。

**有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞真实存在，并且有公开可用的 PoC 代码。从搜索结果来看，该漏洞被称为"Bad Neighbor"，影响多个Windows版本，包括Windows 10和Windows Server 2019。

**投毒风险：**
提供的代码片段是Zeek (原 Bro) 网络安全监控平台的包，用于检测 CVE-2020-16898 和 CVE-2020-16899 漏洞的利用。这段代码本身是用于安全检测的，而不是漏洞利用的 PoC 代码。但是，由于攻击者可能修改或替换该Zeek包，以达到隐藏恶意行为或进行进一步攻击的目的，因此存在一定的投毒风险。

风险评估：
- 代码用途：用于检测漏洞，本身不包含漏洞利用代码。
- 代码来源：esnet-security，看似合法的组织，但无法完全排除风险。
- 代码行为：检测 ICMPv6 数据包，并记录相关信息。
- 潜在风险：修改后的 Zeek 包可能绕过检测，或者执行恶意操作。

综合考虑，认为存在10%的投毒风险。

**利用方式：**
1.  **攻击者发送特制的 ICMPv6 路由器通告数据包：** 该数据包包含一个畸形的或超出预期的 RDNSS (Recursive DNS Server) 选项。
2.  **Windows TCP/IP 协议栈处理数据包：**  当 TCP/IP 协议栈解析这个畸形 RDNSS 选项时，由于缺乏适当的边界检查，会发生缓冲区溢出。
3.  **远程代码执行：**  缓冲区溢出允许攻击者覆盖内存，最终导致在目标系统上执行任意代码。
4.  **权限提升：**  由于 TCP/IP 协议栈运行在内核模式，成功利用此漏洞可以获得系统级别的权限。

**项目地址:** [esnet-security/cve-2020-16898](https://github.com/esnet-security/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #10

**来源**: [CVE-2020-16898-initconf_CVE-2020-16898-Bad-Neighbor.md](../2020/CVE-2020-16898-initconf_CVE-2020-16898-Bad-Neighbor.md)

## CVE-2020-16898: Bad Neighbor - Windows TCP/IP远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行或拒绝服务 (DoS)

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要与目标系统处于同一网络或能够发送 ICMPv6 路由通告数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898，又名"Bad Neighbor"，是一个Windows TCP/IP堆栈中的远程代码执行漏洞。该漏洞源于Windows TCP/IP堆栈不正确地处理 ICMPv6 路由器通告数据包。攻击者可以通过发送特制的 ICMPv6 路由器通告数据包到远程Windows计算机来利用此漏洞。成功利用此漏洞的攻击者可以在目标服务器或客户端上执行代码。

根据漏洞信息和搜索结果，该漏洞可以通过发送包含畸形 RDNSS 选项的 ICMPv6 路由器通告数据包来触发。具体来说，当 RDNSS 选项的长度字段为偶数时，会触发漏洞。

提供的 Zeek 脚本实现了对该漏洞的检测。它会检查所有传入的 ICMPv6 流量，查找 ICMPv6 类型字段为 134 (表示路由器通告) 且 ICMPv6 选项字段为 25 (表示递归 DNS 服务器 RDNSS) 的数据包。如果此 RDNSS 选项的长度字段值为偶数，则该脚本会发出警报。

**有效性：**

提供的Zeek脚本并非漏洞利用代码，而是用于检测攻击的签名。其有效性在于检测到潜在的攻击流量，但它本身无法触发漏洞。

**投毒风险：**

该Zeek脚本的目的是检测恶意流量，本身不太可能包含投毒代码。 风险评估为10%。原因包括：
   * Zeek 脚本的主要功能是网络流量分析和检测，用于安全监控。因此，直接嵌入恶意代码的可能性较低。
   * 该脚本相对简单，主要基于对 ICMPv6 报文特定字段的检查，易于人工审查，从而降低了隐藏恶意代码的风险。

**利用方式：**

1.  攻击者需要与目标系统处于同一网络或能够向目标系统发送 ICMPv6 路由通告数据包。
2.  攻击者构造一个包含畸形 RDNSS 选项的 ICMPv6 路由通告数据包。RDNSS 选项的长度字段必须是偶数。
3.  攻击者将构造的数据包发送到目标系统。
4.  如果目标系统未打补丁，则可能导致远程代码执行或者拒绝服务。

**项目地址:** [initconf/CVE-2020-16898-Bad-Neighbor](https://github.com/initconf/CVE-2020-16898-Bad-Neighbor)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #11

**来源**: [CVE-2020-16898-jiansiting_cve-2020-16898.md](../2020/CVE-2020-16898-jiansiting_cve-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709 及以上，未安装相应补丁

**利用条件:** 需要目标系统开启 IPv6 且与攻击者处于同一网络或攻击者可发送 ICMPv6 报文到目标。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞。该漏洞源于 Windows TCP/IP 协议栈在处理 ICMPv6 路由器通告 (Router Advertisement) 报文时，没有正确处理 RDNSS 选项（递归 DNS 服务器）。攻击者可以通过发送特制的 ICMPv6 路由器通告报文，利用 Option Type 25 触发缓冲区溢出，从而导致蓝屏死机 (BSOD) 或者远程代码执行。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断此POC代码是有效的，因为该代码能够触发蓝屏死机（BSOD）。但是否能执行任意代码取决于目标系统的具体配置和缓解措施。

**投毒风险：**
分析提供的 `bsod-poc.py` 脚本，该脚本主要用于发送精心构造的 ICMPv6 报文，以触发目标系统的漏洞。代码主要使用了 `scapy` 库来构建和发送网络报文。代码逻辑相对清晰，没有发现明显的恶意代码或者后门，因此判断投毒风险较低。

**漏洞利用方式：**
1.  攻击者首先需要确定目标系统的 IPv6 地址。
2.  攻击者使用 `scapy` 库构建一个恶意的 ICMPv6 路由器通告报文。
3.  该报文中包含一个畸形的 RDNSS 选项，特别是 Option Type 25。
4.  通过 `fragment6` 函数对报文进行分片，然后将分片后的报文发送到目标系统。
5.  目标系统接收到这些报文后，由于 TCP/IP 协议栈处理 RDNSS 选项时存在漏洞，导致缓冲区溢出。
6.  攻击者可导致目标系统蓝屏死机，可能情况下实现远程代码执行。

**总而言之，提供的POC主要目的是触发BSOD，没有发现植入恶意代码的痕迹，投毒风险为0%。**

**项目地址:** [jiansiting/cve-2020-16898](https://github.com/jiansiting/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #12

**来源**: [CVE-2020-16898-komomon_CVE-2020-16898--EXP-POC.md](../2020/CVE-2020-16898-komomon_CVE-2020-16898--EXP-POC.md)

## CVE-2020-16898 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可导致远程代码执行甚至蓝屏死机（BSOD）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要与目标主机在同一网络中，并知道目标主机的IPv6地址（特别是本地链路地址）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-16898 是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞，当协议栈不正确处理 ICMPv6 路由器通告（Router Advertisement）数据包时，可能触发此漏洞。攻击者可以发送特制的 ICMPv6 路由器通告数据包到目标 Windows 计算机，从而获得在目标服务器或客户端上执行代码的能力。根据搜索结果，成功利用此漏洞可能导致蓝屏死机（BSOD），并可能被用于远程代码执行。漏洞出现在处理Option Type 25的ICMPv6 RA包时。

**漏洞利用方式：**

1.  **发送特制的 ICMPv6 数据包：** 攻击者需要构造包含恶意选项的 ICMPv6 路由器通告数据包。
2.  **利用 RDNSS 选项：** 漏洞利用通常涉及操纵 RDNSS (Recursive DNS Server) 选项，通过修改其长度和内容，来触发栈溢出。
3.  **碎片化处理：** 漏洞利用代码中使用了 IPv6 碎片化，将数据包分成小片段发送，以便绕过某些安全检测机制或更有效地触发漏洞。
4.  **覆盖返回地址：** 成功利用漏洞需要覆盖栈上的返回地址，以便在函数返回时执行攻击者控制的代码。

**有效性评估：**

提供的漏洞利用代码 (CVE-2020-16898-exp1.py 和 CVE-2020-16898.py) 似乎有效，至少可以触发蓝屏死机。根据 README 文件和代码注释，这些代码经过测试，并且需要修改目标 IPv6 地址才能使用。exp1 通过构造包含特定长度和内容的 ICMPv6 路由器通告数据包来利用漏洞，exp2 则是通过发送两个精心构造的 RDNSS 选项，触发栈溢出。

**投毒风险评估：**

虽然提供的代码主要用于触发 BSOD，但如果恶意修改，也可能被用于执行任意代码。仓库中的投毒风险较低，约为5%。主要风险点在于:

*   **payload的植入：** 攻击者可能会修改exp, 在exp的Overwrite部分植入恶意payload,当触发漏洞时,执行攻击者植入的payload.
*   **源地址欺骗：** 虽然exp文件注释显示可以伪造源地址，可能被用于中间人攻击或放大攻击。

总体来说，虽然直接的投毒代码并不明显，但攻击者可能通过修改提供的 PoC 代码来实现恶意目的。因此，在使用这些代码时需要格外小心，并在隔离环境中进行测试。

**项目地址:** [komomon/CVE-2020-16898--EXP-POC](https://github.com/komomon/CVE-2020-16898--EXP-POC)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #13

**来源**: [CVE-2020-16898-komomon_CVE-2020-16898-EXP-POC.md](../2020/CVE-2020-16898-komomon_CVE-2020-16898-EXP-POC.md)

## CVE-2020-16898 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务（蓝屏）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 攻击者需要能够向目标 Windows 计算机发送特制的 ICMPv6 路由器通告数据包，需要知道目标的 IPv6 地址（包括本地链路 IPv6 地址，全球 IPv6 地址，临时 IPv6 地址）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Windows TCP/IP栈中，由于对ICMPv6路由器通告报文处理不当导致。攻击者通过发送特制的ICMPv6报文，利用Option Type 25 触发漏洞。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的PoC已经公开，并且已被证实可以触发蓝屏死机（BSOD），表明漏洞利用是有效的。提供的漏洞利用代码中存在两个exp， exp1可以直接远程代码执行,exp2可以直接导致目标系统崩溃。

**投毒风险：**
检查了提供的PoC代码，未发现明显的恶意代码，但是，考虑到攻击者可能修改代码以进行恶意活动，例如植入后门或执行其他恶意操作，仍然存在一定的风险。

**利用方式：**
1.  攻击者需要确定目标系统的IPv6地址。
2.  攻击者使用PoC代码（例如，`CVE-2020-16898-exp1.py` 或 `CVE-2020-16898.py`），修改目标IP地址为攻击目标的IPv6地址。
3.  攻击者运行PoC代码，发送特制的ICMPv6路由器通告报文到目标系统。
4.  如果目标系统存在漏洞，可能会触发远程代码执行或者导致系统崩溃（BSOD）。

**缓解措施：**
*   及时安装Microsoft发布的补丁。
*   禁用IPv6，如果不需要使用IPv6网络。
*   配置防火墙规则，限制ICMPv6流量。

**项目地址:** [komomon/CVE-2020-16898-EXP-POC](https://github.com/komomon/CVE-2020-16898-EXP-POC)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #14

**来源**: [CVE-2020-16898-momika233_CVE-2020-16898-exp.md](../2020/CVE-2020-16898-momika233_CVE-2020-16898-exp.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞（Bad Neighbor）

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要在与目标系统相同的网络上或能够发送 ICMPv6 路由通告数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-16898 是一个存在于 Windows TCP/IP 协议栈中的远程代码执行漏洞。该漏洞是由于 Windows TCP/IP 协议栈不正确地处理 ICMPv6 路由通告数据包所致。 攻击者可以通过发送特制的 ICMPv6 路由通告数据包到远程 Windows 计算机来利用此漏洞，成功利用此漏洞的攻击者可以在目标服务器或客户端上执行任意代码。 

根据漏洞信息和搜索结果，该漏洞影响多个 Windows 版本，包括 Windows 10 和 Windows Server。该漏洞利用涉及发送特制的 ICMPv6 数据包。PoC 代码使用 Scapy 库构造这些数据包，并发送给目标。PoC代码通过填充 `ICMPv6NDOptRDNSS` 选项的 `dns` 字段来触发漏洞。根据搜索结果和漏洞描述，该漏洞有可能导致远程代码执行或者拒绝服务（BSOD）。

**有效性：**
根据漏洞信息，该漏洞的 PoC 是可用的，提供的代码可以触发蓝屏死机（BSOD），表明 PoC 具有一定的有效性。

**投毒风险：**
该 PoC 代码主要使用 Scapy 库构造和发送 ICMPv6 数据包，未发现明显的恶意代码或后门。但是，所有来源不明的代码都存在一定的风险，建议在隔离环境中运行。
仔细审查代码，发现其逻辑主要是构造畸形的ICMPv6数据包以触发TCP/IP协议栈中的漏洞，目的是导致BSOD。其中最可疑的地方是大量的"AAAA:AAAA:AAAA:AAAA:AAAA:AAAA:AAAA:AAAA"字符串。这部分代码是在利用漏洞，而非添加恶意代码。因此，判定投毒风险较低，估计在5%左右，主要是考虑作者可能会植入一些不易察觉的payload。

**利用方式：**
1.  攻击者需要位于与目标系统相同的网络或者能够向目标系统发送 IPv6 数据包。
2.  攻击者利用 Scapy 等工具构造恶意的 ICMPv6 路由通告 (RA) 数据包，特别是 `ICMPv6NDOptRDNSS` 选项。
3.  构造的 ICMPv6 RA 数据包被发送到目标 Windows 系统。
4.  Windows TCP/IP 协议栈处理畸形的 ICMPv6 RA 数据包时，触发漏洞，可能导致远程代码执行或拒绝服务攻击（BSOD）。

**项目地址:** [momika233/CVE-2020-16898-exp](https://github.com/momika233/CVE-2020-16898-exp)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---



---

## POC #8

**来源**: [CVE-2020-16898-corelight_CVE-2020-16898.md](../2020/CVE-2020-16898-corelight_CVE-2020-16898.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞（Bad Neighbor）

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行，完全控制受影响系统

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, Windows Server version 2004 等多个版本受影响

**利用条件:** 攻击者需要与目标主机处于同一网络邻域，或者能够发送伪造的 ICMPv6 路由通告数据包到目标主机

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Windows TCP/IP 协议栈中，当其处理 ICMPv6 路由通告数据包时，未能正确解析其中的 RDNSS 选项（Option Type 25），导致内存损坏，进而允许攻击者执行任意代码。攻击者通过发送特制的 ICMPv6 路由通告数据包来触发此漏洞。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞是一个真实存在的远程代码执行漏洞，并且已经有公开的PoC代码。提供的Zeek脚本是一个网络检测包，用于检测利用此漏洞的恶意流量。它通过分析 ICMPv6 路由通告数据包，特别是检查 RDNSS 选项的长度是否为偶数来判断是否存在攻击。

**投毒风险分析：**

提供的PoC代码（Zeek脚本）主要用于检测攻击，而不是利用攻击。仔细检查提供的文件，包括`LICENSE`, `README.md`, `bro-pkg.meta`, `zkg.meta`, `scripts/CVE-2020-16898.zeek`, 和 `scripts/__load__.zeek`，没有发现明显的恶意代码或后门。代码逻辑清晰，主要是检测 ICMPv6 路由通告消息中 RDNSS 选项的长度是否合法。脚本通过生成 Notice 日志来告知管理员存在潜在的攻击行为。投毒的风险较低，但仍存在微小可能性，例如利用 Zeek 脚本的复杂性进行隐藏，或者利用 Zeek 本身的漏洞执行恶意操作。因此，保守估计投毒风险为5%。

**利用方式分析：**

1.  **攻击者构造恶意的 ICMPv6 路由通告数据包：** 数据包中包含一个格式错误的 RDNSS 选项（Option Type 25），其长度为非偶数。
2.  **攻击者将恶意数据包发送给目标 Windows 主机：** 可以通过本地网络发送，也可以通过中间人攻击等方式。
3.  **目标主机处理恶意数据包：** Windows TCP/IP 协议栈在处理该数据包时，由于 RDNSS 选项的长度错误，导致内存溢出。
4.  **攻击者利用内存溢出执行任意代码：** 攻击者可以在溢出的内存中写入恶意代码，并控制程序的执行流程，最终实现远程代码执行。

提供的 Zeek 脚本并不能直接利用漏洞，而是用于检测网络流量中是否存在利用此漏洞的攻击行为。 它通过检测 ICMPv6 路由通告消息中的 Recursive_DNS_Server_Option (RDNSS) 是否存在长度异常的情况（长度不为偶数）来进行判断。 如果发现异常，则会产生一个Notice告警。

**项目地址:** [corelight/CVE-2020-16898](https://github.com/corelight/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #9

**来源**: [CVE-2020-16898-esnet-security_cve-2020-16898.md](../2020/CVE-2020-16898-esnet-security_cve-2020-16898.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞 (Bad Neighbor)

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行，系统控制

**影响版本:** Windows 10 版本 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, 版本 1903, 版本 2004

**利用条件:** 攻击者需要与目标系统处于同一网络段，并发送特制的 ICMPv6 路由器通告数据包。

**POC 可用性:** 是，网络上已存在公开的PoC

**投毒风险:** 10%

## 详情

CVE-2020-16898 是一个存在于 Windows TCP/IP 协议栈中的远程代码执行漏洞。当 Windows TCP/IP 协议栈未正确处理 ICMPv6 路由器通告 (Router Advertisement) 数据包时，会导致此漏洞。攻击者可以通过向远程 Windows 计算机发送特制的 ICMPv6 路由器通告数据包来利用此漏洞。

**有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞真实存在，并且有公开可用的 PoC 代码。从搜索结果来看，该漏洞被称为"Bad Neighbor"，影响多个Windows版本，包括Windows 10和Windows Server 2019。

**投毒风险：**
提供的代码片段是Zeek (原 Bro) 网络安全监控平台的包，用于检测 CVE-2020-16898 和 CVE-2020-16899 漏洞的利用。这段代码本身是用于安全检测的，而不是漏洞利用的 PoC 代码。但是，由于攻击者可能修改或替换该Zeek包，以达到隐藏恶意行为或进行进一步攻击的目的，因此存在一定的投毒风险。

风险评估：
- 代码用途：用于检测漏洞，本身不包含漏洞利用代码。
- 代码来源：esnet-security，看似合法的组织，但无法完全排除风险。
- 代码行为：检测 ICMPv6 数据包，并记录相关信息。
- 潜在风险：修改后的 Zeek 包可能绕过检测，或者执行恶意操作。

综合考虑，认为存在10%的投毒风险。

**利用方式：**
1.  **攻击者发送特制的 ICMPv6 路由器通告数据包：** 该数据包包含一个畸形的或超出预期的 RDNSS (Recursive DNS Server) 选项。
2.  **Windows TCP/IP 协议栈处理数据包：**  当 TCP/IP 协议栈解析这个畸形 RDNSS 选项时，由于缺乏适当的边界检查，会发生缓冲区溢出。
3.  **远程代码执行：**  缓冲区溢出允许攻击者覆盖内存，最终导致在目标系统上执行任意代码。
4.  **权限提升：**  由于 TCP/IP 协议栈运行在内核模式，成功利用此漏洞可以获得系统级别的权限。

**项目地址:** [esnet-security/cve-2020-16898](https://github.com/esnet-security/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #10

**来源**: [CVE-2020-16898-initconf_CVE-2020-16898-Bad-Neighbor.md](../2020/CVE-2020-16898-initconf_CVE-2020-16898-Bad-Neighbor.md)

## CVE-2020-16898: Bad Neighbor - Windows TCP/IP远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行或拒绝服务 (DoS)

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要与目标系统处于同一网络或能够发送 ICMPv6 路由通告数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898，又名"Bad Neighbor"，是一个Windows TCP/IP堆栈中的远程代码执行漏洞。该漏洞源于Windows TCP/IP堆栈不正确地处理 ICMPv6 路由器通告数据包。攻击者可以通过发送特制的 ICMPv6 路由器通告数据包到远程Windows计算机来利用此漏洞。成功利用此漏洞的攻击者可以在目标服务器或客户端上执行代码。

根据漏洞信息和搜索结果，该漏洞可以通过发送包含畸形 RDNSS 选项的 ICMPv6 路由器通告数据包来触发。具体来说，当 RDNSS 选项的长度字段为偶数时，会触发漏洞。

提供的 Zeek 脚本实现了对该漏洞的检测。它会检查所有传入的 ICMPv6 流量，查找 ICMPv6 类型字段为 134 (表示路由器通告) 且 ICMPv6 选项字段为 25 (表示递归 DNS 服务器 RDNSS) 的数据包。如果此 RDNSS 选项的长度字段值为偶数，则该脚本会发出警报。

**有效性：**

提供的Zeek脚本并非漏洞利用代码，而是用于检测攻击的签名。其有效性在于检测到潜在的攻击流量，但它本身无法触发漏洞。

**投毒风险：**

该Zeek脚本的目的是检测恶意流量，本身不太可能包含投毒代码。 风险评估为10%。原因包括：
   * Zeek 脚本的主要功能是网络流量分析和检测，用于安全监控。因此，直接嵌入恶意代码的可能性较低。
   * 该脚本相对简单，主要基于对 ICMPv6 报文特定字段的检查，易于人工审查，从而降低了隐藏恶意代码的风险。

**利用方式：**

1.  攻击者需要与目标系统处于同一网络或能够向目标系统发送 ICMPv6 路由通告数据包。
2.  攻击者构造一个包含畸形 RDNSS 选项的 ICMPv6 路由通告数据包。RDNSS 选项的长度字段必须是偶数。
3.  攻击者将构造的数据包发送到目标系统。
4.  如果目标系统未打补丁，则可能导致远程代码执行或者拒绝服务。

**项目地址:** [initconf/CVE-2020-16898-Bad-Neighbor](https://github.com/initconf/CVE-2020-16898-Bad-Neighbor)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #11

**来源**: [CVE-2020-16898-jiansiting_cve-2020-16898.md](../2020/CVE-2020-16898-jiansiting_cve-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709 及以上，未安装相应补丁

**利用条件:** 需要目标系统开启 IPv6 且与攻击者处于同一网络或攻击者可发送 ICMPv6 报文到目标。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞。该漏洞源于 Windows TCP/IP 协议栈在处理 ICMPv6 路由器通告 (Router Advertisement) 报文时，没有正确处理 RDNSS 选项（递归 DNS 服务器）。攻击者可以通过发送特制的 ICMPv6 路由器通告报文，利用 Option Type 25 触发缓冲区溢出，从而导致蓝屏死机 (BSOD) 或者远程代码执行。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断此POC代码是有效的，因为该代码能够触发蓝屏死机（BSOD）。但是否能执行任意代码取决于目标系统的具体配置和缓解措施。

**投毒风险：**
分析提供的 `bsod-poc.py` 脚本，该脚本主要用于发送精心构造的 ICMPv6 报文，以触发目标系统的漏洞。代码主要使用了 `scapy` 库来构建和发送网络报文。代码逻辑相对清晰，没有发现明显的恶意代码或者后门，因此判断投毒风险较低。

**漏洞利用方式：**
1.  攻击者首先需要确定目标系统的 IPv6 地址。
2.  攻击者使用 `scapy` 库构建一个恶意的 ICMPv6 路由器通告报文。
3.  该报文中包含一个畸形的 RDNSS 选项，特别是 Option Type 25。
4.  通过 `fragment6` 函数对报文进行分片，然后将分片后的报文发送到目标系统。
5.  目标系统接收到这些报文后，由于 TCP/IP 协议栈处理 RDNSS 选项时存在漏洞，导致缓冲区溢出。
6.  攻击者可导致目标系统蓝屏死机，可能情况下实现远程代码执行。

**总而言之，提供的POC主要目的是触发BSOD，没有发现植入恶意代码的痕迹，投毒风险为0%。**

**项目地址:** [jiansiting/cve-2020-16898](https://github.com/jiansiting/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #12

**来源**: [CVE-2020-16898-komomon_CVE-2020-16898--EXP-POC.md](../2020/CVE-2020-16898-komomon_CVE-2020-16898--EXP-POC.md)

## CVE-2020-16898 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可导致远程代码执行甚至蓝屏死机（BSOD）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要与目标主机在同一网络中，并知道目标主机的IPv6地址（特别是本地链路地址）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-16898 是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞，当协议栈不正确处理 ICMPv6 路由器通告（Router Advertisement）数据包时，可能触发此漏洞。攻击者可以发送特制的 ICMPv6 路由器通告数据包到目标 Windows 计算机，从而获得在目标服务器或客户端上执行代码的能力。根据搜索结果，成功利用此漏洞可能导致蓝屏死机（BSOD），并可能被用于远程代码执行。漏洞出现在处理Option Type 25的ICMPv6 RA包时。

**漏洞利用方式：**

1.  **发送特制的 ICMPv6 数据包：** 攻击者需要构造包含恶意选项的 ICMPv6 路由器通告数据包。
2.  **利用 RDNSS 选项：** 漏洞利用通常涉及操纵 RDNSS (Recursive DNS Server) 选项，通过修改其长度和内容，来触发栈溢出。
3.  **碎片化处理：** 漏洞利用代码中使用了 IPv6 碎片化，将数据包分成小片段发送，以便绕过某些安全检测机制或更有效地触发漏洞。
4.  **覆盖返回地址：** 成功利用漏洞需要覆盖栈上的返回地址，以便在函数返回时执行攻击者控制的代码。

**有效性评估：**

提供的漏洞利用代码 (CVE-2020-16898-exp1.py 和 CVE-2020-16898.py) 似乎有效，至少可以触发蓝屏死机。根据 README 文件和代码注释，这些代码经过测试，并且需要修改目标 IPv6 地址才能使用。exp1 通过构造包含特定长度和内容的 ICMPv6 路由器通告数据包来利用漏洞，exp2 则是通过发送两个精心构造的 RDNSS 选项，触发栈溢出。

**投毒风险评估：**

虽然提供的代码主要用于触发 BSOD，但如果恶意修改，也可能被用于执行任意代码。仓库中的投毒风险较低，约为5%。主要风险点在于:

*   **payload的植入：** 攻击者可能会修改exp, 在exp的Overwrite部分植入恶意payload,当触发漏洞时,执行攻击者植入的payload.
*   **源地址欺骗：** 虽然exp文件注释显示可以伪造源地址，可能被用于中间人攻击或放大攻击。

总体来说，虽然直接的投毒代码并不明显，但攻击者可能通过修改提供的 PoC 代码来实现恶意目的。因此，在使用这些代码时需要格外小心，并在隔离环境中进行测试。

**项目地址:** [komomon/CVE-2020-16898--EXP-POC](https://github.com/komomon/CVE-2020-16898--EXP-POC)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #13

**来源**: [CVE-2020-16898-komomon_CVE-2020-16898-EXP-POC.md](../2020/CVE-2020-16898-komomon_CVE-2020-16898-EXP-POC.md)

## CVE-2020-16898 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务（蓝屏）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 攻击者需要能够向目标 Windows 计算机发送特制的 ICMPv6 路由器通告数据包，需要知道目标的 IPv6 地址（包括本地链路 IPv6 地址，全球 IPv6 地址，临时 IPv6 地址）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Windows TCP/IP栈中，由于对ICMPv6路由器通告报文处理不当导致。攻击者通过发送特制的ICMPv6报文，利用Option Type 25 触发漏洞。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的PoC已经公开，并且已被证实可以触发蓝屏死机（BSOD），表明漏洞利用是有效的。提供的漏洞利用代码中存在两个exp， exp1可以直接远程代码执行,exp2可以直接导致目标系统崩溃。

**投毒风险：**
检查了提供的PoC代码，未发现明显的恶意代码，但是，考虑到攻击者可能修改代码以进行恶意活动，例如植入后门或执行其他恶意操作，仍然存在一定的风险。

**利用方式：**
1.  攻击者需要确定目标系统的IPv6地址。
2.  攻击者使用PoC代码（例如，`CVE-2020-16898-exp1.py` 或 `CVE-2020-16898.py`），修改目标IP地址为攻击目标的IPv6地址。
3.  攻击者运行PoC代码，发送特制的ICMPv6路由器通告报文到目标系统。
4.  如果目标系统存在漏洞，可能会触发远程代码执行或者导致系统崩溃（BSOD）。

**缓解措施：**
*   及时安装Microsoft发布的补丁。
*   禁用IPv6，如果不需要使用IPv6网络。
*   配置防火墙规则，限制ICMPv6流量。

**项目地址:** [komomon/CVE-2020-16898-EXP-POC](https://github.com/komomon/CVE-2020-16898-EXP-POC)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #14

**来源**: [CVE-2020-16898-momika233_CVE-2020-16898-exp.md](../2020/CVE-2020-16898-momika233_CVE-2020-16898-exp.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞（Bad Neighbor）

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要在与目标系统相同的网络上或能够发送 ICMPv6 路由通告数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-16898 是一个存在于 Windows TCP/IP 协议栈中的远程代码执行漏洞。该漏洞是由于 Windows TCP/IP 协议栈不正确地处理 ICMPv6 路由通告数据包所致。 攻击者可以通过发送特制的 ICMPv6 路由通告数据包到远程 Windows 计算机来利用此漏洞，成功利用此漏洞的攻击者可以在目标服务器或客户端上执行任意代码。 

根据漏洞信息和搜索结果，该漏洞影响多个 Windows 版本，包括 Windows 10 和 Windows Server。该漏洞利用涉及发送特制的 ICMPv6 数据包。PoC 代码使用 Scapy 库构造这些数据包，并发送给目标。PoC代码通过填充 `ICMPv6NDOptRDNSS` 选项的 `dns` 字段来触发漏洞。根据搜索结果和漏洞描述，该漏洞有可能导致远程代码执行或者拒绝服务（BSOD）。

**有效性：**
根据漏洞信息，该漏洞的 PoC 是可用的，提供的代码可以触发蓝屏死机（BSOD），表明 PoC 具有一定的有效性。

**投毒风险：**
该 PoC 代码主要使用 Scapy 库构造和发送 ICMPv6 数据包，未发现明显的恶意代码或后门。但是，所有来源不明的代码都存在一定的风险，建议在隔离环境中运行。
仔细审查代码，发现其逻辑主要是构造畸形的ICMPv6数据包以触发TCP/IP协议栈中的漏洞，目的是导致BSOD。其中最可疑的地方是大量的"AAAA:AAAA:AAAA:AAAA:AAAA:AAAA:AAAA:AAAA"字符串。这部分代码是在利用漏洞，而非添加恶意代码。因此，判定投毒风险较低，估计在5%左右，主要是考虑作者可能会植入一些不易察觉的payload。

**利用方式：**
1.  攻击者需要位于与目标系统相同的网络或者能够向目标系统发送 IPv6 数据包。
2.  攻击者利用 Scapy 等工具构造恶意的 ICMPv6 路由通告 (RA) 数据包，特别是 `ICMPv6NDOptRDNSS` 选项。
3.  构造的 ICMPv6 RA 数据包被发送到目标 Windows 系统。
4.  Windows TCP/IP 协议栈处理畸形的 ICMPv6 RA 数据包时，触发漏洞，可能导致远程代码执行或拒绝服务攻击（BSOD）。

**项目地址:** [momika233/CVE-2020-16898-exp](https://github.com/momika233/CVE-2020-16898-exp)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---



---

## POC #8

**来源**: [CVE-2020-16898-corelight_CVE-2020-16898.md](../2020/CVE-2020-16898-corelight_CVE-2020-16898.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞（Bad Neighbor）

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行，完全控制受影响系统

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, Windows Server version 2004 等多个版本受影响

**利用条件:** 攻击者需要与目标主机处于同一网络邻域，或者能够发送伪造的 ICMPv6 路由通告数据包到目标主机

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Windows TCP/IP 协议栈中，当其处理 ICMPv6 路由通告数据包时，未能正确解析其中的 RDNSS 选项（Option Type 25），导致内存损坏，进而允许攻击者执行任意代码。攻击者通过发送特制的 ICMPv6 路由通告数据包来触发此漏洞。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞是一个真实存在的远程代码执行漏洞，并且已经有公开的PoC代码。提供的Zeek脚本是一个网络检测包，用于检测利用此漏洞的恶意流量。它通过分析 ICMPv6 路由通告数据包，特别是检查 RDNSS 选项的长度是否为偶数来判断是否存在攻击。

**投毒风险分析：**

提供的PoC代码（Zeek脚本）主要用于检测攻击，而不是利用攻击。仔细检查提供的文件，包括`LICENSE`, `README.md`, `bro-pkg.meta`, `zkg.meta`, `scripts/CVE-2020-16898.zeek`, 和 `scripts/__load__.zeek`，没有发现明显的恶意代码或后门。代码逻辑清晰，主要是检测 ICMPv6 路由通告消息中 RDNSS 选项的长度是否合法。脚本通过生成 Notice 日志来告知管理员存在潜在的攻击行为。投毒的风险较低，但仍存在微小可能性，例如利用 Zeek 脚本的复杂性进行隐藏，或者利用 Zeek 本身的漏洞执行恶意操作。因此，保守估计投毒风险为5%。

**利用方式分析：**

1.  **攻击者构造恶意的 ICMPv6 路由通告数据包：** 数据包中包含一个格式错误的 RDNSS 选项（Option Type 25），其长度为非偶数。
2.  **攻击者将恶意数据包发送给目标 Windows 主机：** 可以通过本地网络发送，也可以通过中间人攻击等方式。
3.  **目标主机处理恶意数据包：** Windows TCP/IP 协议栈在处理该数据包时，由于 RDNSS 选项的长度错误，导致内存溢出。
4.  **攻击者利用内存溢出执行任意代码：** 攻击者可以在溢出的内存中写入恶意代码，并控制程序的执行流程，最终实现远程代码执行。

提供的 Zeek 脚本并不能直接利用漏洞，而是用于检测网络流量中是否存在利用此漏洞的攻击行为。 它通过检测 ICMPv6 路由通告消息中的 Recursive_DNS_Server_Option (RDNSS) 是否存在长度异常的情况（长度不为偶数）来进行判断。 如果发现异常，则会产生一个Notice告警。

**项目地址:** [corelight/CVE-2020-16898](https://github.com/corelight/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #9

**来源**: [CVE-2020-16898-esnet-security_cve-2020-16898.md](../2020/CVE-2020-16898-esnet-security_cve-2020-16898.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞 (Bad Neighbor)

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行，系统控制

**影响版本:** Windows 10 版本 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, 版本 1903, 版本 2004

**利用条件:** 攻击者需要与目标系统处于同一网络段，并发送特制的 ICMPv6 路由器通告数据包。

**POC 可用性:** 是，网络上已存在公开的PoC

**投毒风险:** 10%

## 详情

CVE-2020-16898 是一个存在于 Windows TCP/IP 协议栈中的远程代码执行漏洞。当 Windows TCP/IP 协议栈未正确处理 ICMPv6 路由器通告 (Router Advertisement) 数据包时，会导致此漏洞。攻击者可以通过向远程 Windows 计算机发送特制的 ICMPv6 路由器通告数据包来利用此漏洞。

**有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞真实存在，并且有公开可用的 PoC 代码。从搜索结果来看，该漏洞被称为"Bad Neighbor"，影响多个Windows版本，包括Windows 10和Windows Server 2019。

**投毒风险：**
提供的代码片段是Zeek (原 Bro) 网络安全监控平台的包，用于检测 CVE-2020-16898 和 CVE-2020-16899 漏洞的利用。这段代码本身是用于安全检测的，而不是漏洞利用的 PoC 代码。但是，由于攻击者可能修改或替换该Zeek包，以达到隐藏恶意行为或进行进一步攻击的目的，因此存在一定的投毒风险。

风险评估：
- 代码用途：用于检测漏洞，本身不包含漏洞利用代码。
- 代码来源：esnet-security，看似合法的组织，但无法完全排除风险。
- 代码行为：检测 ICMPv6 数据包，并记录相关信息。
- 潜在风险：修改后的 Zeek 包可能绕过检测，或者执行恶意操作。

综合考虑，认为存在10%的投毒风险。

**利用方式：**
1.  **攻击者发送特制的 ICMPv6 路由器通告数据包：** 该数据包包含一个畸形的或超出预期的 RDNSS (Recursive DNS Server) 选项。
2.  **Windows TCP/IP 协议栈处理数据包：**  当 TCP/IP 协议栈解析这个畸形 RDNSS 选项时，由于缺乏适当的边界检查，会发生缓冲区溢出。
3.  **远程代码执行：**  缓冲区溢出允许攻击者覆盖内存，最终导致在目标系统上执行任意代码。
4.  **权限提升：**  由于 TCP/IP 协议栈运行在内核模式，成功利用此漏洞可以获得系统级别的权限。

**项目地址:** [esnet-security/cve-2020-16898](https://github.com/esnet-security/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #10

**来源**: [CVE-2020-16898-initconf_CVE-2020-16898-Bad-Neighbor.md](../2020/CVE-2020-16898-initconf_CVE-2020-16898-Bad-Neighbor.md)

## CVE-2020-16898: Bad Neighbor - Windows TCP/IP远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行或拒绝服务 (DoS)

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要与目标系统处于同一网络或能够发送 ICMPv6 路由通告数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898，又名"Bad Neighbor"，是一个Windows TCP/IP堆栈中的远程代码执行漏洞。该漏洞源于Windows TCP/IP堆栈不正确地处理 ICMPv6 路由器通告数据包。攻击者可以通过发送特制的 ICMPv6 路由器通告数据包到远程Windows计算机来利用此漏洞。成功利用此漏洞的攻击者可以在目标服务器或客户端上执行代码。

根据漏洞信息和搜索结果，该漏洞可以通过发送包含畸形 RDNSS 选项的 ICMPv6 路由器通告数据包来触发。具体来说，当 RDNSS 选项的长度字段为偶数时，会触发漏洞。

提供的 Zeek 脚本实现了对该漏洞的检测。它会检查所有传入的 ICMPv6 流量，查找 ICMPv6 类型字段为 134 (表示路由器通告) 且 ICMPv6 选项字段为 25 (表示递归 DNS 服务器 RDNSS) 的数据包。如果此 RDNSS 选项的长度字段值为偶数，则该脚本会发出警报。

**有效性：**

提供的Zeek脚本并非漏洞利用代码，而是用于检测攻击的签名。其有效性在于检测到潜在的攻击流量，但它本身无法触发漏洞。

**投毒风险：**

该Zeek脚本的目的是检测恶意流量，本身不太可能包含投毒代码。 风险评估为10%。原因包括：
   * Zeek 脚本的主要功能是网络流量分析和检测，用于安全监控。因此，直接嵌入恶意代码的可能性较低。
   * 该脚本相对简单，主要基于对 ICMPv6 报文特定字段的检查，易于人工审查，从而降低了隐藏恶意代码的风险。

**利用方式：**

1.  攻击者需要与目标系统处于同一网络或能够向目标系统发送 ICMPv6 路由通告数据包。
2.  攻击者构造一个包含畸形 RDNSS 选项的 ICMPv6 路由通告数据包。RDNSS 选项的长度字段必须是偶数。
3.  攻击者将构造的数据包发送到目标系统。
4.  如果目标系统未打补丁，则可能导致远程代码执行或者拒绝服务。

**项目地址:** [initconf/CVE-2020-16898-Bad-Neighbor](https://github.com/initconf/CVE-2020-16898-Bad-Neighbor)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #11

**来源**: [CVE-2020-16898-jiansiting_cve-2020-16898.md](../2020/CVE-2020-16898-jiansiting_cve-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709 及以上，未安装相应补丁

**利用条件:** 需要目标系统开启 IPv6 且与攻击者处于同一网络或攻击者可发送 ICMPv6 报文到目标。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞。该漏洞源于 Windows TCP/IP 协议栈在处理 ICMPv6 路由器通告 (Router Advertisement) 报文时，没有正确处理 RDNSS 选项（递归 DNS 服务器）。攻击者可以通过发送特制的 ICMPv6 路由器通告报文，利用 Option Type 25 触发缓冲区溢出，从而导致蓝屏死机 (BSOD) 或者远程代码执行。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断此POC代码是有效的，因为该代码能够触发蓝屏死机（BSOD）。但是否能执行任意代码取决于目标系统的具体配置和缓解措施。

**投毒风险：**
分析提供的 `bsod-poc.py` 脚本，该脚本主要用于发送精心构造的 ICMPv6 报文，以触发目标系统的漏洞。代码主要使用了 `scapy` 库来构建和发送网络报文。代码逻辑相对清晰，没有发现明显的恶意代码或者后门，因此判断投毒风险较低。

**漏洞利用方式：**
1.  攻击者首先需要确定目标系统的 IPv6 地址。
2.  攻击者使用 `scapy` 库构建一个恶意的 ICMPv6 路由器通告报文。
3.  该报文中包含一个畸形的 RDNSS 选项，特别是 Option Type 25。
4.  通过 `fragment6` 函数对报文进行分片，然后将分片后的报文发送到目标系统。
5.  目标系统接收到这些报文后，由于 TCP/IP 协议栈处理 RDNSS 选项时存在漏洞，导致缓冲区溢出。
6.  攻击者可导致目标系统蓝屏死机，可能情况下实现远程代码执行。

**总而言之，提供的POC主要目的是触发BSOD，没有发现植入恶意代码的痕迹，投毒风险为0%。**

**项目地址:** [jiansiting/cve-2020-16898](https://github.com/jiansiting/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #12

**来源**: [CVE-2020-16898-komomon_CVE-2020-16898--EXP-POC.md](../2020/CVE-2020-16898-komomon_CVE-2020-16898--EXP-POC.md)

## CVE-2020-16898 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可导致远程代码执行甚至蓝屏死机（BSOD）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要与目标主机在同一网络中，并知道目标主机的IPv6地址（特别是本地链路地址）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-16898 是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞，当协议栈不正确处理 ICMPv6 路由器通告（Router Advertisement）数据包时，可能触发此漏洞。攻击者可以发送特制的 ICMPv6 路由器通告数据包到目标 Windows 计算机，从而获得在目标服务器或客户端上执行代码的能力。根据搜索结果，成功利用此漏洞可能导致蓝屏死机（BSOD），并可能被用于远程代码执行。漏洞出现在处理Option Type 25的ICMPv6 RA包时。

**漏洞利用方式：**

1.  **发送特制的 ICMPv6 数据包：** 攻击者需要构造包含恶意选项的 ICMPv6 路由器通告数据包。
2.  **利用 RDNSS 选项：** 漏洞利用通常涉及操纵 RDNSS (Recursive DNS Server) 选项，通过修改其长度和内容，来触发栈溢出。
3.  **碎片化处理：** 漏洞利用代码中使用了 IPv6 碎片化，将数据包分成小片段发送，以便绕过某些安全检测机制或更有效地触发漏洞。
4.  **覆盖返回地址：** 成功利用漏洞需要覆盖栈上的返回地址，以便在函数返回时执行攻击者控制的代码。

**有效性评估：**

提供的漏洞利用代码 (CVE-2020-16898-exp1.py 和 CVE-2020-16898.py) 似乎有效，至少可以触发蓝屏死机。根据 README 文件和代码注释，这些代码经过测试，并且需要修改目标 IPv6 地址才能使用。exp1 通过构造包含特定长度和内容的 ICMPv6 路由器通告数据包来利用漏洞，exp2 则是通过发送两个精心构造的 RDNSS 选项，触发栈溢出。

**投毒风险评估：**

虽然提供的代码主要用于触发 BSOD，但如果恶意修改，也可能被用于执行任意代码。仓库中的投毒风险较低，约为5%。主要风险点在于:

*   **payload的植入：** 攻击者可能会修改exp, 在exp的Overwrite部分植入恶意payload,当触发漏洞时,执行攻击者植入的payload.
*   **源地址欺骗：** 虽然exp文件注释显示可以伪造源地址，可能被用于中间人攻击或放大攻击。

总体来说，虽然直接的投毒代码并不明显，但攻击者可能通过修改提供的 PoC 代码来实现恶意目的。因此，在使用这些代码时需要格外小心，并在隔离环境中进行测试。

**项目地址:** [komomon/CVE-2020-16898--EXP-POC](https://github.com/komomon/CVE-2020-16898--EXP-POC)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #13

**来源**: [CVE-2020-16898-komomon_CVE-2020-16898-EXP-POC.md](../2020/CVE-2020-16898-komomon_CVE-2020-16898-EXP-POC.md)

## CVE-2020-16898 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务（蓝屏）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 攻击者需要能够向目标 Windows 计算机发送特制的 ICMPv6 路由器通告数据包，需要知道目标的 IPv6 地址（包括本地链路 IPv6 地址，全球 IPv6 地址，临时 IPv6 地址）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Windows TCP/IP栈中，由于对ICMPv6路由器通告报文处理不当导致。攻击者通过发送特制的ICMPv6报文，利用Option Type 25 触发漏洞。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的PoC已经公开，并且已被证实可以触发蓝屏死机（BSOD），表明漏洞利用是有效的。提供的漏洞利用代码中存在两个exp， exp1可以直接远程代码执行,exp2可以直接导致目标系统崩溃。

**投毒风险：**
检查了提供的PoC代码，未发现明显的恶意代码，但是，考虑到攻击者可能修改代码以进行恶意活动，例如植入后门或执行其他恶意操作，仍然存在一定的风险。

**利用方式：**
1.  攻击者需要确定目标系统的IPv6地址。
2.  攻击者使用PoC代码（例如，`CVE-2020-16898-exp1.py` 或 `CVE-2020-16898.py`），修改目标IP地址为攻击目标的IPv6地址。
3.  攻击者运行PoC代码，发送特制的ICMPv6路由器通告报文到目标系统。
4.  如果目标系统存在漏洞，可能会触发远程代码执行或者导致系统崩溃（BSOD）。

**缓解措施：**
*   及时安装Microsoft发布的补丁。
*   禁用IPv6，如果不需要使用IPv6网络。
*   配置防火墙规则，限制ICMPv6流量。

**项目地址:** [komomon/CVE-2020-16898-EXP-POC](https://github.com/komomon/CVE-2020-16898-EXP-POC)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #14

**来源**: [CVE-2020-16898-momika233_CVE-2020-16898-exp.md](../2020/CVE-2020-16898-momika233_CVE-2020-16898-exp.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞（Bad Neighbor）

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要在与目标系统相同的网络上或能够发送 ICMPv6 路由通告数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-16898 是一个存在于 Windows TCP/IP 协议栈中的远程代码执行漏洞。该漏洞是由于 Windows TCP/IP 协议栈不正确地处理 ICMPv6 路由通告数据包所致。 攻击者可以通过发送特制的 ICMPv6 路由通告数据包到远程 Windows 计算机来利用此漏洞，成功利用此漏洞的攻击者可以在目标服务器或客户端上执行任意代码。 

根据漏洞信息和搜索结果，该漏洞影响多个 Windows 版本，包括 Windows 10 和 Windows Server。该漏洞利用涉及发送特制的 ICMPv6 数据包。PoC 代码使用 Scapy 库构造这些数据包，并发送给目标。PoC代码通过填充 `ICMPv6NDOptRDNSS` 选项的 `dns` 字段来触发漏洞。根据搜索结果和漏洞描述，该漏洞有可能导致远程代码执行或者拒绝服务（BSOD）。

**有效性：**
根据漏洞信息，该漏洞的 PoC 是可用的，提供的代码可以触发蓝屏死机（BSOD），表明 PoC 具有一定的有效性。

**投毒风险：**
该 PoC 代码主要使用 Scapy 库构造和发送 ICMPv6 数据包，未发现明显的恶意代码或后门。但是，所有来源不明的代码都存在一定的风险，建议在隔离环境中运行。
仔细审查代码，发现其逻辑主要是构造畸形的ICMPv6数据包以触发TCP/IP协议栈中的漏洞，目的是导致BSOD。其中最可疑的地方是大量的"AAAA:AAAA:AAAA:AAAA:AAAA:AAAA:AAAA:AAAA"字符串。这部分代码是在利用漏洞，而非添加恶意代码。因此，判定投毒风险较低，估计在5%左右，主要是考虑作者可能会植入一些不易察觉的payload。

**利用方式：**
1.  攻击者需要位于与目标系统相同的网络或者能够向目标系统发送 IPv6 数据包。
2.  攻击者利用 Scapy 等工具构造恶意的 ICMPv6 路由通告 (RA) 数据包，特别是 `ICMPv6NDOptRDNSS` 选项。
3.  构造的 ICMPv6 RA 数据包被发送到目标 Windows 系统。
4.  Windows TCP/IP 协议栈处理畸形的 ICMPv6 RA 数据包时，触发漏洞，可能导致远程代码执行或拒绝服务攻击（BSOD）。

**项目地址:** [momika233/CVE-2020-16898-exp](https://github.com/momika233/CVE-2020-16898-exp)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---



---

## POC #8

**来源**: [CVE-2020-16898-corelight_CVE-2020-16898.md](../2020/CVE-2020-16898-corelight_CVE-2020-16898.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞（Bad Neighbor）

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行，完全控制受影响系统

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, Windows Server version 2004 等多个版本受影响

**利用条件:** 攻击者需要与目标主机处于同一网络邻域，或者能够发送伪造的 ICMPv6 路由通告数据包到目标主机

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Windows TCP/IP 协议栈中，当其处理 ICMPv6 路由通告数据包时，未能正确解析其中的 RDNSS 选项（Option Type 25），导致内存损坏，进而允许攻击者执行任意代码。攻击者通过发送特制的 ICMPv6 路由通告数据包来触发此漏洞。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞是一个真实存在的远程代码执行漏洞，并且已经有公开的PoC代码。提供的Zeek脚本是一个网络检测包，用于检测利用此漏洞的恶意流量。它通过分析 ICMPv6 路由通告数据包，特别是检查 RDNSS 选项的长度是否为偶数来判断是否存在攻击。

**投毒风险分析：**

提供的PoC代码（Zeek脚本）主要用于检测攻击，而不是利用攻击。仔细检查提供的文件，包括`LICENSE`, `README.md`, `bro-pkg.meta`, `zkg.meta`, `scripts/CVE-2020-16898.zeek`, 和 `scripts/__load__.zeek`，没有发现明显的恶意代码或后门。代码逻辑清晰，主要是检测 ICMPv6 路由通告消息中 RDNSS 选项的长度是否合法。脚本通过生成 Notice 日志来告知管理员存在潜在的攻击行为。投毒的风险较低，但仍存在微小可能性，例如利用 Zeek 脚本的复杂性进行隐藏，或者利用 Zeek 本身的漏洞执行恶意操作。因此，保守估计投毒风险为5%。

**利用方式分析：**

1.  **攻击者构造恶意的 ICMPv6 路由通告数据包：** 数据包中包含一个格式错误的 RDNSS 选项（Option Type 25），其长度为非偶数。
2.  **攻击者将恶意数据包发送给目标 Windows 主机：** 可以通过本地网络发送，也可以通过中间人攻击等方式。
3.  **目标主机处理恶意数据包：** Windows TCP/IP 协议栈在处理该数据包时，由于 RDNSS 选项的长度错误，导致内存溢出。
4.  **攻击者利用内存溢出执行任意代码：** 攻击者可以在溢出的内存中写入恶意代码，并控制程序的执行流程，最终实现远程代码执行。

提供的 Zeek 脚本并不能直接利用漏洞，而是用于检测网络流量中是否存在利用此漏洞的攻击行为。 它通过检测 ICMPv6 路由通告消息中的 Recursive_DNS_Server_Option (RDNSS) 是否存在长度异常的情况（长度不为偶数）来进行判断。 如果发现异常，则会产生一个Notice告警。

**项目地址:** [corelight/CVE-2020-16898](https://github.com/corelight/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #9

**来源**: [CVE-2020-16898-esnet-security_cve-2020-16898.md](../2020/CVE-2020-16898-esnet-security_cve-2020-16898.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞 (Bad Neighbor)

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行，系统控制

**影响版本:** Windows 10 版本 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, 版本 1903, 版本 2004

**利用条件:** 攻击者需要与目标系统处于同一网络段，并发送特制的 ICMPv6 路由器通告数据包。

**POC 可用性:** 是，网络上已存在公开的PoC

**投毒风险:** 10%

## 详情

CVE-2020-16898 是一个存在于 Windows TCP/IP 协议栈中的远程代码执行漏洞。当 Windows TCP/IP 协议栈未正确处理 ICMPv6 路由器通告 (Router Advertisement) 数据包时，会导致此漏洞。攻击者可以通过向远程 Windows 计算机发送特制的 ICMPv6 路由器通告数据包来利用此漏洞。

**有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞真实存在，并且有公开可用的 PoC 代码。从搜索结果来看，该漏洞被称为"Bad Neighbor"，影响多个Windows版本，包括Windows 10和Windows Server 2019。

**投毒风险：**
提供的代码片段是Zeek (原 Bro) 网络安全监控平台的包，用于检测 CVE-2020-16898 和 CVE-2020-16899 漏洞的利用。这段代码本身是用于安全检测的，而不是漏洞利用的 PoC 代码。但是，由于攻击者可能修改或替换该Zeek包，以达到隐藏恶意行为或进行进一步攻击的目的，因此存在一定的投毒风险。

风险评估：
- 代码用途：用于检测漏洞，本身不包含漏洞利用代码。
- 代码来源：esnet-security，看似合法的组织，但无法完全排除风险。
- 代码行为：检测 ICMPv6 数据包，并记录相关信息。
- 潜在风险：修改后的 Zeek 包可能绕过检测，或者执行恶意操作。

综合考虑，认为存在10%的投毒风险。

**利用方式：**
1.  **攻击者发送特制的 ICMPv6 路由器通告数据包：** 该数据包包含一个畸形的或超出预期的 RDNSS (Recursive DNS Server) 选项。
2.  **Windows TCP/IP 协议栈处理数据包：**  当 TCP/IP 协议栈解析这个畸形 RDNSS 选项时，由于缺乏适当的边界检查，会发生缓冲区溢出。
3.  **远程代码执行：**  缓冲区溢出允许攻击者覆盖内存，最终导致在目标系统上执行任意代码。
4.  **权限提升：**  由于 TCP/IP 协议栈运行在内核模式，成功利用此漏洞可以获得系统级别的权限。

**项目地址:** [esnet-security/cve-2020-16898](https://github.com/esnet-security/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #10

**来源**: [CVE-2020-16898-initconf_CVE-2020-16898-Bad-Neighbor.md](../2020/CVE-2020-16898-initconf_CVE-2020-16898-Bad-Neighbor.md)

## CVE-2020-16898: Bad Neighbor - Windows TCP/IP远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行或拒绝服务 (DoS)

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要与目标系统处于同一网络或能够发送 ICMPv6 路由通告数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898，又名"Bad Neighbor"，是一个Windows TCP/IP堆栈中的远程代码执行漏洞。该漏洞源于Windows TCP/IP堆栈不正确地处理 ICMPv6 路由器通告数据包。攻击者可以通过发送特制的 ICMPv6 路由器通告数据包到远程Windows计算机来利用此漏洞。成功利用此漏洞的攻击者可以在目标服务器或客户端上执行代码。

根据漏洞信息和搜索结果，该漏洞可以通过发送包含畸形 RDNSS 选项的 ICMPv6 路由器通告数据包来触发。具体来说，当 RDNSS 选项的长度字段为偶数时，会触发漏洞。

提供的 Zeek 脚本实现了对该漏洞的检测。它会检查所有传入的 ICMPv6 流量，查找 ICMPv6 类型字段为 134 (表示路由器通告) 且 ICMPv6 选项字段为 25 (表示递归 DNS 服务器 RDNSS) 的数据包。如果此 RDNSS 选项的长度字段值为偶数，则该脚本会发出警报。

**有效性：**

提供的Zeek脚本并非漏洞利用代码，而是用于检测攻击的签名。其有效性在于检测到潜在的攻击流量，但它本身无法触发漏洞。

**投毒风险：**

该Zeek脚本的目的是检测恶意流量，本身不太可能包含投毒代码。 风险评估为10%。原因包括：
   * Zeek 脚本的主要功能是网络流量分析和检测，用于安全监控。因此，直接嵌入恶意代码的可能性较低。
   * 该脚本相对简单，主要基于对 ICMPv6 报文特定字段的检查，易于人工审查，从而降低了隐藏恶意代码的风险。

**利用方式：**

1.  攻击者需要与目标系统处于同一网络或能够向目标系统发送 ICMPv6 路由通告数据包。
2.  攻击者构造一个包含畸形 RDNSS 选项的 ICMPv6 路由通告数据包。RDNSS 选项的长度字段必须是偶数。
3.  攻击者将构造的数据包发送到目标系统。
4.  如果目标系统未打补丁，则可能导致远程代码执行或者拒绝服务。

**项目地址:** [initconf/CVE-2020-16898-Bad-Neighbor](https://github.com/initconf/CVE-2020-16898-Bad-Neighbor)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #11

**来源**: [CVE-2020-16898-jiansiting_cve-2020-16898.md](../2020/CVE-2020-16898-jiansiting_cve-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709 及以上，未安装相应补丁

**利用条件:** 需要目标系统开启 IPv6 且与攻击者处于同一网络或攻击者可发送 ICMPv6 报文到目标。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞。该漏洞源于 Windows TCP/IP 协议栈在处理 ICMPv6 路由器通告 (Router Advertisement) 报文时，没有正确处理 RDNSS 选项（递归 DNS 服务器）。攻击者可以通过发送特制的 ICMPv6 路由器通告报文，利用 Option Type 25 触发缓冲区溢出，从而导致蓝屏死机 (BSOD) 或者远程代码执行。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断此POC代码是有效的，因为该代码能够触发蓝屏死机（BSOD）。但是否能执行任意代码取决于目标系统的具体配置和缓解措施。

**投毒风险：**
分析提供的 `bsod-poc.py` 脚本，该脚本主要用于发送精心构造的 ICMPv6 报文，以触发目标系统的漏洞。代码主要使用了 `scapy` 库来构建和发送网络报文。代码逻辑相对清晰，没有发现明显的恶意代码或者后门，因此判断投毒风险较低。

**漏洞利用方式：**
1.  攻击者首先需要确定目标系统的 IPv6 地址。
2.  攻击者使用 `scapy` 库构建一个恶意的 ICMPv6 路由器通告报文。
3.  该报文中包含一个畸形的 RDNSS 选项，特别是 Option Type 25。
4.  通过 `fragment6` 函数对报文进行分片，然后将分片后的报文发送到目标系统。
5.  目标系统接收到这些报文后，由于 TCP/IP 协议栈处理 RDNSS 选项时存在漏洞，导致缓冲区溢出。
6.  攻击者可导致目标系统蓝屏死机，可能情况下实现远程代码执行。

**总而言之，提供的POC主要目的是触发BSOD，没有发现植入恶意代码的痕迹，投毒风险为0%。**

**项目地址:** [jiansiting/cve-2020-16898](https://github.com/jiansiting/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #12

**来源**: [CVE-2020-16898-komomon_CVE-2020-16898--EXP-POC.md](../2020/CVE-2020-16898-komomon_CVE-2020-16898--EXP-POC.md)

## CVE-2020-16898 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可导致远程代码执行甚至蓝屏死机（BSOD）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要与目标主机在同一网络中，并知道目标主机的IPv6地址（特别是本地链路地址）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-16898 是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞，当协议栈不正确处理 ICMPv6 路由器通告（Router Advertisement）数据包时，可能触发此漏洞。攻击者可以发送特制的 ICMPv6 路由器通告数据包到目标 Windows 计算机，从而获得在目标服务器或客户端上执行代码的能力。根据搜索结果，成功利用此漏洞可能导致蓝屏死机（BSOD），并可能被用于远程代码执行。漏洞出现在处理Option Type 25的ICMPv6 RA包时。

**漏洞利用方式：**

1.  **发送特制的 ICMPv6 数据包：** 攻击者需要构造包含恶意选项的 ICMPv6 路由器通告数据包。
2.  **利用 RDNSS 选项：** 漏洞利用通常涉及操纵 RDNSS (Recursive DNS Server) 选项，通过修改其长度和内容，来触发栈溢出。
3.  **碎片化处理：** 漏洞利用代码中使用了 IPv6 碎片化，将数据包分成小片段发送，以便绕过某些安全检测机制或更有效地触发漏洞。
4.  **覆盖返回地址：** 成功利用漏洞需要覆盖栈上的返回地址，以便在函数返回时执行攻击者控制的代码。

**有效性评估：**

提供的漏洞利用代码 (CVE-2020-16898-exp1.py 和 CVE-2020-16898.py) 似乎有效，至少可以触发蓝屏死机。根据 README 文件和代码注释，这些代码经过测试，并且需要修改目标 IPv6 地址才能使用。exp1 通过构造包含特定长度和内容的 ICMPv6 路由器通告数据包来利用漏洞，exp2 则是通过发送两个精心构造的 RDNSS 选项，触发栈溢出。

**投毒风险评估：**

虽然提供的代码主要用于触发 BSOD，但如果恶意修改，也可能被用于执行任意代码。仓库中的投毒风险较低，约为5%。主要风险点在于:

*   **payload的植入：** 攻击者可能会修改exp, 在exp的Overwrite部分植入恶意payload,当触发漏洞时,执行攻击者植入的payload.
*   **源地址欺骗：** 虽然exp文件注释显示可以伪造源地址，可能被用于中间人攻击或放大攻击。

总体来说，虽然直接的投毒代码并不明显，但攻击者可能通过修改提供的 PoC 代码来实现恶意目的。因此，在使用这些代码时需要格外小心，并在隔离环境中进行测试。

**项目地址:** [komomon/CVE-2020-16898--EXP-POC](https://github.com/komomon/CVE-2020-16898--EXP-POC)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #13

**来源**: [CVE-2020-16898-komomon_CVE-2020-16898-EXP-POC.md](../2020/CVE-2020-16898-komomon_CVE-2020-16898-EXP-POC.md)

## CVE-2020-16898 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务（蓝屏）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 攻击者需要能够向目标 Windows 计算机发送特制的 ICMPv6 路由器通告数据包，需要知道目标的 IPv6 地址（包括本地链路 IPv6 地址，全球 IPv6 地址，临时 IPv6 地址）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Windows TCP/IP栈中，由于对ICMPv6路由器通告报文处理不当导致。攻击者通过发送特制的ICMPv6报文，利用Option Type 25 触发漏洞。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的PoC已经公开，并且已被证实可以触发蓝屏死机（BSOD），表明漏洞利用是有效的。提供的漏洞利用代码中存在两个exp， exp1可以直接远程代码执行,exp2可以直接导致目标系统崩溃。

**投毒风险：**
检查了提供的PoC代码，未发现明显的恶意代码，但是，考虑到攻击者可能修改代码以进行恶意活动，例如植入后门或执行其他恶意操作，仍然存在一定的风险。

**利用方式：**
1.  攻击者需要确定目标系统的IPv6地址。
2.  攻击者使用PoC代码（例如，`CVE-2020-16898-exp1.py` 或 `CVE-2020-16898.py`），修改目标IP地址为攻击目标的IPv6地址。
3.  攻击者运行PoC代码，发送特制的ICMPv6路由器通告报文到目标系统。
4.  如果目标系统存在漏洞，可能会触发远程代码执行或者导致系统崩溃（BSOD）。

**缓解措施：**
*   及时安装Microsoft发布的补丁。
*   禁用IPv6，如果不需要使用IPv6网络。
*   配置防火墙规则，限制ICMPv6流量。

**项目地址:** [komomon/CVE-2020-16898-EXP-POC](https://github.com/komomon/CVE-2020-16898-EXP-POC)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #14

**来源**: [CVE-2020-16898-momika233_CVE-2020-16898-exp.md](../2020/CVE-2020-16898-momika233_CVE-2020-16898-exp.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞（Bad Neighbor）

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要在与目标系统相同的网络上或能够发送 ICMPv6 路由通告数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-16898 是一个存在于 Windows TCP/IP 协议栈中的远程代码执行漏洞。该漏洞是由于 Windows TCP/IP 协议栈不正确地处理 ICMPv6 路由通告数据包所致。 攻击者可以通过发送特制的 ICMPv6 路由通告数据包到远程 Windows 计算机来利用此漏洞，成功利用此漏洞的攻击者可以在目标服务器或客户端上执行任意代码。 

根据漏洞信息和搜索结果，该漏洞影响多个 Windows 版本，包括 Windows 10 和 Windows Server。该漏洞利用涉及发送特制的 ICMPv6 数据包。PoC 代码使用 Scapy 库构造这些数据包，并发送给目标。PoC代码通过填充 `ICMPv6NDOptRDNSS` 选项的 `dns` 字段来触发漏洞。根据搜索结果和漏洞描述，该漏洞有可能导致远程代码执行或者拒绝服务（BSOD）。

**有效性：**
根据漏洞信息，该漏洞的 PoC 是可用的，提供的代码可以触发蓝屏死机（BSOD），表明 PoC 具有一定的有效性。

**投毒风险：**
该 PoC 代码主要使用 Scapy 库构造和发送 ICMPv6 数据包，未发现明显的恶意代码或后门。但是，所有来源不明的代码都存在一定的风险，建议在隔离环境中运行。
仔细审查代码，发现其逻辑主要是构造畸形的ICMPv6数据包以触发TCP/IP协议栈中的漏洞，目的是导致BSOD。其中最可疑的地方是大量的"AAAA:AAAA:AAAA:AAAA:AAAA:AAAA:AAAA:AAAA"字符串。这部分代码是在利用漏洞，而非添加恶意代码。因此，判定投毒风险较低，估计在5%左右，主要是考虑作者可能会植入一些不易察觉的payload。

**利用方式：**
1.  攻击者需要位于与目标系统相同的网络或者能够向目标系统发送 IPv6 数据包。
2.  攻击者利用 Scapy 等工具构造恶意的 ICMPv6 路由通告 (RA) 数据包，特别是 `ICMPv6NDOptRDNSS` 选项。
3.  构造的 ICMPv6 RA 数据包被发送到目标 Windows 系统。
4.  Windows TCP/IP 协议栈处理畸形的 ICMPv6 RA 数据包时，触发漏洞，可能导致远程代码执行或拒绝服务攻击（BSOD）。

**项目地址:** [momika233/CVE-2020-16898-exp](https://github.com/momika233/CVE-2020-16898-exp)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---



---

## POC #8

**来源**: [CVE-2020-16898-corelight_CVE-2020-16898.md](../2020/CVE-2020-16898-corelight_CVE-2020-16898.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞（Bad Neighbor）

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行，完全控制受影响系统

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, Windows Server version 2004 等多个版本受影响

**利用条件:** 攻击者需要与目标主机处于同一网络邻域，或者能够发送伪造的 ICMPv6 路由通告数据包到目标主机

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Windows TCP/IP 协议栈中，当其处理 ICMPv6 路由通告数据包时，未能正确解析其中的 RDNSS 选项（Option Type 25），导致内存损坏，进而允许攻击者执行任意代码。攻击者通过发送特制的 ICMPv6 路由通告数据包来触发此漏洞。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞是一个真实存在的远程代码执行漏洞，并且已经有公开的PoC代码。提供的Zeek脚本是一个网络检测包，用于检测利用此漏洞的恶意流量。它通过分析 ICMPv6 路由通告数据包，特别是检查 RDNSS 选项的长度是否为偶数来判断是否存在攻击。

**投毒风险分析：**

提供的PoC代码（Zeek脚本）主要用于检测攻击，而不是利用攻击。仔细检查提供的文件，包括`LICENSE`, `README.md`, `bro-pkg.meta`, `zkg.meta`, `scripts/CVE-2020-16898.zeek`, 和 `scripts/__load__.zeek`，没有发现明显的恶意代码或后门。代码逻辑清晰，主要是检测 ICMPv6 路由通告消息中 RDNSS 选项的长度是否合法。脚本通过生成 Notice 日志来告知管理员存在潜在的攻击行为。投毒的风险较低，但仍存在微小可能性，例如利用 Zeek 脚本的复杂性进行隐藏，或者利用 Zeek 本身的漏洞执行恶意操作。因此，保守估计投毒风险为5%。

**利用方式分析：**

1.  **攻击者构造恶意的 ICMPv6 路由通告数据包：** 数据包中包含一个格式错误的 RDNSS 选项（Option Type 25），其长度为非偶数。
2.  **攻击者将恶意数据包发送给目标 Windows 主机：** 可以通过本地网络发送，也可以通过中间人攻击等方式。
3.  **目标主机处理恶意数据包：** Windows TCP/IP 协议栈在处理该数据包时，由于 RDNSS 选项的长度错误，导致内存溢出。
4.  **攻击者利用内存溢出执行任意代码：** 攻击者可以在溢出的内存中写入恶意代码，并控制程序的执行流程，最终实现远程代码执行。

提供的 Zeek 脚本并不能直接利用漏洞，而是用于检测网络流量中是否存在利用此漏洞的攻击行为。 它通过检测 ICMPv6 路由通告消息中的 Recursive_DNS_Server_Option (RDNSS) 是否存在长度异常的情况（长度不为偶数）来进行判断。 如果发现异常，则会产生一个Notice告警。

**项目地址:** [corelight/CVE-2020-16898](https://github.com/corelight/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #9

**来源**: [CVE-2020-16898-esnet-security_cve-2020-16898.md](../2020/CVE-2020-16898-esnet-security_cve-2020-16898.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞 (Bad Neighbor)

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行，系统控制

**影响版本:** Windows 10 版本 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, 版本 1903, 版本 2004

**利用条件:** 攻击者需要与目标系统处于同一网络段，并发送特制的 ICMPv6 路由器通告数据包。

**POC 可用性:** 是，网络上已存在公开的PoC

**投毒风险:** 10%

## 详情

CVE-2020-16898 是一个存在于 Windows TCP/IP 协议栈中的远程代码执行漏洞。当 Windows TCP/IP 协议栈未正确处理 ICMPv6 路由器通告 (Router Advertisement) 数据包时，会导致此漏洞。攻击者可以通过向远程 Windows 计算机发送特制的 ICMPv6 路由器通告数据包来利用此漏洞。

**有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞真实存在，并且有公开可用的 PoC 代码。从搜索结果来看，该漏洞被称为"Bad Neighbor"，影响多个Windows版本，包括Windows 10和Windows Server 2019。

**投毒风险：**
提供的代码片段是Zeek (原 Bro) 网络安全监控平台的包，用于检测 CVE-2020-16898 和 CVE-2020-16899 漏洞的利用。这段代码本身是用于安全检测的，而不是漏洞利用的 PoC 代码。但是，由于攻击者可能修改或替换该Zeek包，以达到隐藏恶意行为或进行进一步攻击的目的，因此存在一定的投毒风险。

风险评估：
- 代码用途：用于检测漏洞，本身不包含漏洞利用代码。
- 代码来源：esnet-security，看似合法的组织，但无法完全排除风险。
- 代码行为：检测 ICMPv6 数据包，并记录相关信息。
- 潜在风险：修改后的 Zeek 包可能绕过检测，或者执行恶意操作。

综合考虑，认为存在10%的投毒风险。

**利用方式：**
1.  **攻击者发送特制的 ICMPv6 路由器通告数据包：** 该数据包包含一个畸形的或超出预期的 RDNSS (Recursive DNS Server) 选项。
2.  **Windows TCP/IP 协议栈处理数据包：**  当 TCP/IP 协议栈解析这个畸形 RDNSS 选项时，由于缺乏适当的边界检查，会发生缓冲区溢出。
3.  **远程代码执行：**  缓冲区溢出允许攻击者覆盖内存，最终导致在目标系统上执行任意代码。
4.  **权限提升：**  由于 TCP/IP 协议栈运行在内核模式，成功利用此漏洞可以获得系统级别的权限。

**项目地址:** [esnet-security/cve-2020-16898](https://github.com/esnet-security/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #10

**来源**: [CVE-2020-16898-initconf_CVE-2020-16898-Bad-Neighbor.md](../2020/CVE-2020-16898-initconf_CVE-2020-16898-Bad-Neighbor.md)

## CVE-2020-16898: Bad Neighbor - Windows TCP/IP远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行或拒绝服务 (DoS)

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要与目标系统处于同一网络或能够发送 ICMPv6 路由通告数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898，又名"Bad Neighbor"，是一个Windows TCP/IP堆栈中的远程代码执行漏洞。该漏洞源于Windows TCP/IP堆栈不正确地处理 ICMPv6 路由器通告数据包。攻击者可以通过发送特制的 ICMPv6 路由器通告数据包到远程Windows计算机来利用此漏洞。成功利用此漏洞的攻击者可以在目标服务器或客户端上执行代码。

根据漏洞信息和搜索结果，该漏洞可以通过发送包含畸形 RDNSS 选项的 ICMPv6 路由器通告数据包来触发。具体来说，当 RDNSS 选项的长度字段为偶数时，会触发漏洞。

提供的 Zeek 脚本实现了对该漏洞的检测。它会检查所有传入的 ICMPv6 流量，查找 ICMPv6 类型字段为 134 (表示路由器通告) 且 ICMPv6 选项字段为 25 (表示递归 DNS 服务器 RDNSS) 的数据包。如果此 RDNSS 选项的长度字段值为偶数，则该脚本会发出警报。

**有效性：**

提供的Zeek脚本并非漏洞利用代码，而是用于检测攻击的签名。其有效性在于检测到潜在的攻击流量，但它本身无法触发漏洞。

**投毒风险：**

该Zeek脚本的目的是检测恶意流量，本身不太可能包含投毒代码。 风险评估为10%。原因包括：
   * Zeek 脚本的主要功能是网络流量分析和检测，用于安全监控。因此，直接嵌入恶意代码的可能性较低。
   * 该脚本相对简单，主要基于对 ICMPv6 报文特定字段的检查，易于人工审查，从而降低了隐藏恶意代码的风险。

**利用方式：**

1.  攻击者需要与目标系统处于同一网络或能够向目标系统发送 ICMPv6 路由通告数据包。
2.  攻击者构造一个包含畸形 RDNSS 选项的 ICMPv6 路由通告数据包。RDNSS 选项的长度字段必须是偶数。
3.  攻击者将构造的数据包发送到目标系统。
4.  如果目标系统未打补丁，则可能导致远程代码执行或者拒绝服务。

**项目地址:** [initconf/CVE-2020-16898-Bad-Neighbor](https://github.com/initconf/CVE-2020-16898-Bad-Neighbor)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #11

**来源**: [CVE-2020-16898-jiansiting_cve-2020-16898.md](../2020/CVE-2020-16898-jiansiting_cve-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709 及以上，未安装相应补丁

**利用条件:** 需要目标系统开启 IPv6 且与攻击者处于同一网络或攻击者可发送 ICMPv6 报文到目标。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞。该漏洞源于 Windows TCP/IP 协议栈在处理 ICMPv6 路由器通告 (Router Advertisement) 报文时，没有正确处理 RDNSS 选项（递归 DNS 服务器）。攻击者可以通过发送特制的 ICMPv6 路由器通告报文，利用 Option Type 25 触发缓冲区溢出，从而导致蓝屏死机 (BSOD) 或者远程代码执行。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断此POC代码是有效的，因为该代码能够触发蓝屏死机（BSOD）。但是否能执行任意代码取决于目标系统的具体配置和缓解措施。

**投毒风险：**
分析提供的 `bsod-poc.py` 脚本，该脚本主要用于发送精心构造的 ICMPv6 报文，以触发目标系统的漏洞。代码主要使用了 `scapy` 库来构建和发送网络报文。代码逻辑相对清晰，没有发现明显的恶意代码或者后门，因此判断投毒风险较低。

**漏洞利用方式：**
1.  攻击者首先需要确定目标系统的 IPv6 地址。
2.  攻击者使用 `scapy` 库构建一个恶意的 ICMPv6 路由器通告报文。
3.  该报文中包含一个畸形的 RDNSS 选项，特别是 Option Type 25。
4.  通过 `fragment6` 函数对报文进行分片，然后将分片后的报文发送到目标系统。
5.  目标系统接收到这些报文后，由于 TCP/IP 协议栈处理 RDNSS 选项时存在漏洞，导致缓冲区溢出。
6.  攻击者可导致目标系统蓝屏死机，可能情况下实现远程代码执行。

**总而言之，提供的POC主要目的是触发BSOD，没有发现植入恶意代码的痕迹，投毒风险为0%。**

**项目地址:** [jiansiting/cve-2020-16898](https://github.com/jiansiting/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #12

**来源**: [CVE-2020-16898-komomon_CVE-2020-16898--EXP-POC.md](../2020/CVE-2020-16898-komomon_CVE-2020-16898--EXP-POC.md)

## CVE-2020-16898 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可导致远程代码执行甚至蓝屏死机（BSOD）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要与目标主机在同一网络中，并知道目标主机的IPv6地址（特别是本地链路地址）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-16898 是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞，当协议栈不正确处理 ICMPv6 路由器通告（Router Advertisement）数据包时，可能触发此漏洞。攻击者可以发送特制的 ICMPv6 路由器通告数据包到目标 Windows 计算机，从而获得在目标服务器或客户端上执行代码的能力。根据搜索结果，成功利用此漏洞可能导致蓝屏死机（BSOD），并可能被用于远程代码执行。漏洞出现在处理Option Type 25的ICMPv6 RA包时。

**漏洞利用方式：**

1.  **发送特制的 ICMPv6 数据包：** 攻击者需要构造包含恶意选项的 ICMPv6 路由器通告数据包。
2.  **利用 RDNSS 选项：** 漏洞利用通常涉及操纵 RDNSS (Recursive DNS Server) 选项，通过修改其长度和内容，来触发栈溢出。
3.  **碎片化处理：** 漏洞利用代码中使用了 IPv6 碎片化，将数据包分成小片段发送，以便绕过某些安全检测机制或更有效地触发漏洞。
4.  **覆盖返回地址：** 成功利用漏洞需要覆盖栈上的返回地址，以便在函数返回时执行攻击者控制的代码。

**有效性评估：**

提供的漏洞利用代码 (CVE-2020-16898-exp1.py 和 CVE-2020-16898.py) 似乎有效，至少可以触发蓝屏死机。根据 README 文件和代码注释，这些代码经过测试，并且需要修改目标 IPv6 地址才能使用。exp1 通过构造包含特定长度和内容的 ICMPv6 路由器通告数据包来利用漏洞，exp2 则是通过发送两个精心构造的 RDNSS 选项，触发栈溢出。

**投毒风险评估：**

虽然提供的代码主要用于触发 BSOD，但如果恶意修改，也可能被用于执行任意代码。仓库中的投毒风险较低，约为5%。主要风险点在于:

*   **payload的植入：** 攻击者可能会修改exp, 在exp的Overwrite部分植入恶意payload,当触发漏洞时,执行攻击者植入的payload.
*   **源地址欺骗：** 虽然exp文件注释显示可以伪造源地址，可能被用于中间人攻击或放大攻击。

总体来说，虽然直接的投毒代码并不明显，但攻击者可能通过修改提供的 PoC 代码来实现恶意目的。因此，在使用这些代码时需要格外小心，并在隔离环境中进行测试。

**项目地址:** [komomon/CVE-2020-16898--EXP-POC](https://github.com/komomon/CVE-2020-16898--EXP-POC)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #13

**来源**: [CVE-2020-16898-komomon_CVE-2020-16898-EXP-POC.md](../2020/CVE-2020-16898-komomon_CVE-2020-16898-EXP-POC.md)

## CVE-2020-16898 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务（蓝屏）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 攻击者需要能够向目标 Windows 计算机发送特制的 ICMPv6 路由器通告数据包，需要知道目标的 IPv6 地址（包括本地链路 IPv6 地址，全球 IPv6 地址，临时 IPv6 地址）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Windows TCP/IP栈中，由于对ICMPv6路由器通告报文处理不当导致。攻击者通过发送特制的ICMPv6报文，利用Option Type 25 触发漏洞。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的PoC已经公开，并且已被证实可以触发蓝屏死机（BSOD），表明漏洞利用是有效的。提供的漏洞利用代码中存在两个exp， exp1可以直接远程代码执行,exp2可以直接导致目标系统崩溃。

**投毒风险：**
检查了提供的PoC代码，未发现明显的恶意代码，但是，考虑到攻击者可能修改代码以进行恶意活动，例如植入后门或执行其他恶意操作，仍然存在一定的风险。

**利用方式：**
1.  攻击者需要确定目标系统的IPv6地址。
2.  攻击者使用PoC代码（例如，`CVE-2020-16898-exp1.py` 或 `CVE-2020-16898.py`），修改目标IP地址为攻击目标的IPv6地址。
3.  攻击者运行PoC代码，发送特制的ICMPv6路由器通告报文到目标系统。
4.  如果目标系统存在漏洞，可能会触发远程代码执行或者导致系统崩溃（BSOD）。

**缓解措施：**
*   及时安装Microsoft发布的补丁。
*   禁用IPv6，如果不需要使用IPv6网络。
*   配置防火墙规则，限制ICMPv6流量。

**项目地址:** [komomon/CVE-2020-16898-EXP-POC](https://github.com/komomon/CVE-2020-16898-EXP-POC)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #14

**来源**: [CVE-2020-16898-momika233_CVE-2020-16898-exp.md](../2020/CVE-2020-16898-momika233_CVE-2020-16898-exp.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞（Bad Neighbor）

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要在与目标系统相同的网络上或能够发送 ICMPv6 路由通告数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-16898 是一个存在于 Windows TCP/IP 协议栈中的远程代码执行漏洞。该漏洞是由于 Windows TCP/IP 协议栈不正确地处理 ICMPv6 路由通告数据包所致。 攻击者可以通过发送特制的 ICMPv6 路由通告数据包到远程 Windows 计算机来利用此漏洞，成功利用此漏洞的攻击者可以在目标服务器或客户端上执行任意代码。 

根据漏洞信息和搜索结果，该漏洞影响多个 Windows 版本，包括 Windows 10 和 Windows Server。该漏洞利用涉及发送特制的 ICMPv6 数据包。PoC 代码使用 Scapy 库构造这些数据包，并发送给目标。PoC代码通过填充 `ICMPv6NDOptRDNSS` 选项的 `dns` 字段来触发漏洞。根据搜索结果和漏洞描述，该漏洞有可能导致远程代码执行或者拒绝服务（BSOD）。

**有效性：**
根据漏洞信息，该漏洞的 PoC 是可用的，提供的代码可以触发蓝屏死机（BSOD），表明 PoC 具有一定的有效性。

**投毒风险：**
该 PoC 代码主要使用 Scapy 库构造和发送 ICMPv6 数据包，未发现明显的恶意代码或后门。但是，所有来源不明的代码都存在一定的风险，建议在隔离环境中运行。
仔细审查代码，发现其逻辑主要是构造畸形的ICMPv6数据包以触发TCP/IP协议栈中的漏洞，目的是导致BSOD。其中最可疑的地方是大量的"AAAA:AAAA:AAAA:AAAA:AAAA:AAAA:AAAA:AAAA"字符串。这部分代码是在利用漏洞，而非添加恶意代码。因此，判定投毒风险较低，估计在5%左右，主要是考虑作者可能会植入一些不易察觉的payload。

**利用方式：**
1.  攻击者需要位于与目标系统相同的网络或者能够向目标系统发送 IPv6 数据包。
2.  攻击者利用 Scapy 等工具构造恶意的 ICMPv6 路由通告 (RA) 数据包，特别是 `ICMPv6NDOptRDNSS` 选项。
3.  构造的 ICMPv6 RA 数据包被发送到目标 Windows 系统。
4.  Windows TCP/IP 协议栈处理畸形的 ICMPv6 RA 数据包时，触发漏洞，可能导致远程代码执行或拒绝服务攻击（BSOD）。

**项目地址:** [momika233/CVE-2020-16898-exp](https://github.com/momika233/CVE-2020-16898-exp)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---



---

## POC #8

**来源**: [CVE-2020-16898-corelight_CVE-2020-16898.md](../2020/CVE-2020-16898-corelight_CVE-2020-16898.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞（Bad Neighbor）

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行，完全控制受影响系统

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, Windows Server version 2004 等多个版本受影响

**利用条件:** 攻击者需要与目标主机处于同一网络邻域，或者能够发送伪造的 ICMPv6 路由通告数据包到目标主机

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Windows TCP/IP 协议栈中，当其处理 ICMPv6 路由通告数据包时，未能正确解析其中的 RDNSS 选项（Option Type 25），导致内存损坏，进而允许攻击者执行任意代码。攻击者通过发送特制的 ICMPv6 路由通告数据包来触发此漏洞。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞是一个真实存在的远程代码执行漏洞，并且已经有公开的PoC代码。提供的Zeek脚本是一个网络检测包，用于检测利用此漏洞的恶意流量。它通过分析 ICMPv6 路由通告数据包，特别是检查 RDNSS 选项的长度是否为偶数来判断是否存在攻击。

**投毒风险分析：**

提供的PoC代码（Zeek脚本）主要用于检测攻击，而不是利用攻击。仔细检查提供的文件，包括`LICENSE`, `README.md`, `bro-pkg.meta`, `zkg.meta`, `scripts/CVE-2020-16898.zeek`, 和 `scripts/__load__.zeek`，没有发现明显的恶意代码或后门。代码逻辑清晰，主要是检测 ICMPv6 路由通告消息中 RDNSS 选项的长度是否合法。脚本通过生成 Notice 日志来告知管理员存在潜在的攻击行为。投毒的风险较低，但仍存在微小可能性，例如利用 Zeek 脚本的复杂性进行隐藏，或者利用 Zeek 本身的漏洞执行恶意操作。因此，保守估计投毒风险为5%。

**利用方式分析：**

1.  **攻击者构造恶意的 ICMPv6 路由通告数据包：** 数据包中包含一个格式错误的 RDNSS 选项（Option Type 25），其长度为非偶数。
2.  **攻击者将恶意数据包发送给目标 Windows 主机：** 可以通过本地网络发送，也可以通过中间人攻击等方式。
3.  **目标主机处理恶意数据包：** Windows TCP/IP 协议栈在处理该数据包时，由于 RDNSS 选项的长度错误，导致内存溢出。
4.  **攻击者利用内存溢出执行任意代码：** 攻击者可以在溢出的内存中写入恶意代码，并控制程序的执行流程，最终实现远程代码执行。

提供的 Zeek 脚本并不能直接利用漏洞，而是用于检测网络流量中是否存在利用此漏洞的攻击行为。 它通过检测 ICMPv6 路由通告消息中的 Recursive_DNS_Server_Option (RDNSS) 是否存在长度异常的情况（长度不为偶数）来进行判断。 如果发现异常，则会产生一个Notice告警。

**项目地址:** [corelight/CVE-2020-16898](https://github.com/corelight/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #9

**来源**: [CVE-2020-16898-esnet-security_cve-2020-16898.md](../2020/CVE-2020-16898-esnet-security_cve-2020-16898.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞 (Bad Neighbor)

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行，系统控制

**影响版本:** Windows 10 版本 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, 版本 1903, 版本 2004

**利用条件:** 攻击者需要与目标系统处于同一网络段，并发送特制的 ICMPv6 路由器通告数据包。

**POC 可用性:** 是，网络上已存在公开的PoC

**投毒风险:** 10%

## 详情

CVE-2020-16898 是一个存在于 Windows TCP/IP 协议栈中的远程代码执行漏洞。当 Windows TCP/IP 协议栈未正确处理 ICMPv6 路由器通告 (Router Advertisement) 数据包时，会导致此漏洞。攻击者可以通过向远程 Windows 计算机发送特制的 ICMPv6 路由器通告数据包来利用此漏洞。

**有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞真实存在，并且有公开可用的 PoC 代码。从搜索结果来看，该漏洞被称为"Bad Neighbor"，影响多个Windows版本，包括Windows 10和Windows Server 2019。

**投毒风险：**
提供的代码片段是Zeek (原 Bro) 网络安全监控平台的包，用于检测 CVE-2020-16898 和 CVE-2020-16899 漏洞的利用。这段代码本身是用于安全检测的，而不是漏洞利用的 PoC 代码。但是，由于攻击者可能修改或替换该Zeek包，以达到隐藏恶意行为或进行进一步攻击的目的，因此存在一定的投毒风险。

风险评估：
- 代码用途：用于检测漏洞，本身不包含漏洞利用代码。
- 代码来源：esnet-security，看似合法的组织，但无法完全排除风险。
- 代码行为：检测 ICMPv6 数据包，并记录相关信息。
- 潜在风险：修改后的 Zeek 包可能绕过检测，或者执行恶意操作。

综合考虑，认为存在10%的投毒风险。

**利用方式：**
1.  **攻击者发送特制的 ICMPv6 路由器通告数据包：** 该数据包包含一个畸形的或超出预期的 RDNSS (Recursive DNS Server) 选项。
2.  **Windows TCP/IP 协议栈处理数据包：**  当 TCP/IP 协议栈解析这个畸形 RDNSS 选项时，由于缺乏适当的边界检查，会发生缓冲区溢出。
3.  **远程代码执行：**  缓冲区溢出允许攻击者覆盖内存，最终导致在目标系统上执行任意代码。
4.  **权限提升：**  由于 TCP/IP 协议栈运行在内核模式，成功利用此漏洞可以获得系统级别的权限。

**项目地址:** [esnet-security/cve-2020-16898](https://github.com/esnet-security/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #10

**来源**: [CVE-2020-16898-initconf_CVE-2020-16898-Bad-Neighbor.md](../2020/CVE-2020-16898-initconf_CVE-2020-16898-Bad-Neighbor.md)

## CVE-2020-16898: Bad Neighbor - Windows TCP/IP远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行或拒绝服务 (DoS)

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要与目标系统处于同一网络或能够发送 ICMPv6 路由通告数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898，又名"Bad Neighbor"，是一个Windows TCP/IP堆栈中的远程代码执行漏洞。该漏洞源于Windows TCP/IP堆栈不正确地处理 ICMPv6 路由器通告数据包。攻击者可以通过发送特制的 ICMPv6 路由器通告数据包到远程Windows计算机来利用此漏洞。成功利用此漏洞的攻击者可以在目标服务器或客户端上执行代码。

根据漏洞信息和搜索结果，该漏洞可以通过发送包含畸形 RDNSS 选项的 ICMPv6 路由器通告数据包来触发。具体来说，当 RDNSS 选项的长度字段为偶数时，会触发漏洞。

提供的 Zeek 脚本实现了对该漏洞的检测。它会检查所有传入的 ICMPv6 流量，查找 ICMPv6 类型字段为 134 (表示路由器通告) 且 ICMPv6 选项字段为 25 (表示递归 DNS 服务器 RDNSS) 的数据包。如果此 RDNSS 选项的长度字段值为偶数，则该脚本会发出警报。

**有效性：**

提供的Zeek脚本并非漏洞利用代码，而是用于检测攻击的签名。其有效性在于检测到潜在的攻击流量，但它本身无法触发漏洞。

**投毒风险：**

该Zeek脚本的目的是检测恶意流量，本身不太可能包含投毒代码。 风险评估为10%。原因包括：
   * Zeek 脚本的主要功能是网络流量分析和检测，用于安全监控。因此，直接嵌入恶意代码的可能性较低。
   * 该脚本相对简单，主要基于对 ICMPv6 报文特定字段的检查，易于人工审查，从而降低了隐藏恶意代码的风险。

**利用方式：**

1.  攻击者需要与目标系统处于同一网络或能够向目标系统发送 ICMPv6 路由通告数据包。
2.  攻击者构造一个包含畸形 RDNSS 选项的 ICMPv6 路由通告数据包。RDNSS 选项的长度字段必须是偶数。
3.  攻击者将构造的数据包发送到目标系统。
4.  如果目标系统未打补丁，则可能导致远程代码执行或者拒绝服务。

**项目地址:** [initconf/CVE-2020-16898-Bad-Neighbor](https://github.com/initconf/CVE-2020-16898-Bad-Neighbor)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #11

**来源**: [CVE-2020-16898-jiansiting_cve-2020-16898.md](../2020/CVE-2020-16898-jiansiting_cve-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709 及以上，未安装相应补丁

**利用条件:** 需要目标系统开启 IPv6 且与攻击者处于同一网络或攻击者可发送 ICMPv6 报文到目标。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞。该漏洞源于 Windows TCP/IP 协议栈在处理 ICMPv6 路由器通告 (Router Advertisement) 报文时，没有正确处理 RDNSS 选项（递归 DNS 服务器）。攻击者可以通过发送特制的 ICMPv6 路由器通告报文，利用 Option Type 25 触发缓冲区溢出，从而导致蓝屏死机 (BSOD) 或者远程代码执行。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断此POC代码是有效的，因为该代码能够触发蓝屏死机（BSOD）。但是否能执行任意代码取决于目标系统的具体配置和缓解措施。

**投毒风险：**
分析提供的 `bsod-poc.py` 脚本，该脚本主要用于发送精心构造的 ICMPv6 报文，以触发目标系统的漏洞。代码主要使用了 `scapy` 库来构建和发送网络报文。代码逻辑相对清晰，没有发现明显的恶意代码或者后门，因此判断投毒风险较低。

**漏洞利用方式：**
1.  攻击者首先需要确定目标系统的 IPv6 地址。
2.  攻击者使用 `scapy` 库构建一个恶意的 ICMPv6 路由器通告报文。
3.  该报文中包含一个畸形的 RDNSS 选项，特别是 Option Type 25。
4.  通过 `fragment6` 函数对报文进行分片，然后将分片后的报文发送到目标系统。
5.  目标系统接收到这些报文后，由于 TCP/IP 协议栈处理 RDNSS 选项时存在漏洞，导致缓冲区溢出。
6.  攻击者可导致目标系统蓝屏死机，可能情况下实现远程代码执行。

**总而言之，提供的POC主要目的是触发BSOD，没有发现植入恶意代码的痕迹，投毒风险为0%。**

**项目地址:** [jiansiting/cve-2020-16898](https://github.com/jiansiting/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #12

**来源**: [CVE-2020-16898-komomon_CVE-2020-16898--EXP-POC.md](../2020/CVE-2020-16898-komomon_CVE-2020-16898--EXP-POC.md)

## CVE-2020-16898 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可导致远程代码执行甚至蓝屏死机（BSOD）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要与目标主机在同一网络中，并知道目标主机的IPv6地址（特别是本地链路地址）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-16898 是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞，当协议栈不正确处理 ICMPv6 路由器通告（Router Advertisement）数据包时，可能触发此漏洞。攻击者可以发送特制的 ICMPv6 路由器通告数据包到目标 Windows 计算机，从而获得在目标服务器或客户端上执行代码的能力。根据搜索结果，成功利用此漏洞可能导致蓝屏死机（BSOD），并可能被用于远程代码执行。漏洞出现在处理Option Type 25的ICMPv6 RA包时。

**漏洞利用方式：**

1.  **发送特制的 ICMPv6 数据包：** 攻击者需要构造包含恶意选项的 ICMPv6 路由器通告数据包。
2.  **利用 RDNSS 选项：** 漏洞利用通常涉及操纵 RDNSS (Recursive DNS Server) 选项，通过修改其长度和内容，来触发栈溢出。
3.  **碎片化处理：** 漏洞利用代码中使用了 IPv6 碎片化，将数据包分成小片段发送，以便绕过某些安全检测机制或更有效地触发漏洞。
4.  **覆盖返回地址：** 成功利用漏洞需要覆盖栈上的返回地址，以便在函数返回时执行攻击者控制的代码。

**有效性评估：**

提供的漏洞利用代码 (CVE-2020-16898-exp1.py 和 CVE-2020-16898.py) 似乎有效，至少可以触发蓝屏死机。根据 README 文件和代码注释，这些代码经过测试，并且需要修改目标 IPv6 地址才能使用。exp1 通过构造包含特定长度和内容的 ICMPv6 路由器通告数据包来利用漏洞，exp2 则是通过发送两个精心构造的 RDNSS 选项，触发栈溢出。

**投毒风险评估：**

虽然提供的代码主要用于触发 BSOD，但如果恶意修改，也可能被用于执行任意代码。仓库中的投毒风险较低，约为5%。主要风险点在于:

*   **payload的植入：** 攻击者可能会修改exp, 在exp的Overwrite部分植入恶意payload,当触发漏洞时,执行攻击者植入的payload.
*   **源地址欺骗：** 虽然exp文件注释显示可以伪造源地址，可能被用于中间人攻击或放大攻击。

总体来说，虽然直接的投毒代码并不明显，但攻击者可能通过修改提供的 PoC 代码来实现恶意目的。因此，在使用这些代码时需要格外小心，并在隔离环境中进行测试。

**项目地址:** [komomon/CVE-2020-16898--EXP-POC](https://github.com/komomon/CVE-2020-16898--EXP-POC)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #13

**来源**: [CVE-2020-16898-komomon_CVE-2020-16898-EXP-POC.md](../2020/CVE-2020-16898-komomon_CVE-2020-16898-EXP-POC.md)

## CVE-2020-16898 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务（蓝屏）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 攻击者需要能够向目标 Windows 计算机发送特制的 ICMPv6 路由器通告数据包，需要知道目标的 IPv6 地址（包括本地链路 IPv6 地址，全球 IPv6 地址，临时 IPv6 地址）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Windows TCP/IP栈中，由于对ICMPv6路由器通告报文处理不当导致。攻击者通过发送特制的ICMPv6报文，利用Option Type 25 触发漏洞。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的PoC已经公开，并且已被证实可以触发蓝屏死机（BSOD），表明漏洞利用是有效的。提供的漏洞利用代码中存在两个exp， exp1可以直接远程代码执行,exp2可以直接导致目标系统崩溃。

**投毒风险：**
检查了提供的PoC代码，未发现明显的恶意代码，但是，考虑到攻击者可能修改代码以进行恶意活动，例如植入后门或执行其他恶意操作，仍然存在一定的风险。

**利用方式：**
1.  攻击者需要确定目标系统的IPv6地址。
2.  攻击者使用PoC代码（例如，`CVE-2020-16898-exp1.py` 或 `CVE-2020-16898.py`），修改目标IP地址为攻击目标的IPv6地址。
3.  攻击者运行PoC代码，发送特制的ICMPv6路由器通告报文到目标系统。
4.  如果目标系统存在漏洞，可能会触发远程代码执行或者导致系统崩溃（BSOD）。

**缓解措施：**
*   及时安装Microsoft发布的补丁。
*   禁用IPv6，如果不需要使用IPv6网络。
*   配置防火墙规则，限制ICMPv6流量。

**项目地址:** [komomon/CVE-2020-16898-EXP-POC](https://github.com/komomon/CVE-2020-16898-EXP-POC)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #14

**来源**: [CVE-2020-16898-momika233_CVE-2020-16898-exp.md](../2020/CVE-2020-16898-momika233_CVE-2020-16898-exp.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞（Bad Neighbor）

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要在与目标系统相同的网络上或能够发送 ICMPv6 路由通告数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-16898 是一个存在于 Windows TCP/IP 协议栈中的远程代码执行漏洞。该漏洞是由于 Windows TCP/IP 协议栈不正确地处理 ICMPv6 路由通告数据包所致。 攻击者可以通过发送特制的 ICMPv6 路由通告数据包到远程 Windows 计算机来利用此漏洞，成功利用此漏洞的攻击者可以在目标服务器或客户端上执行任意代码。 

根据漏洞信息和搜索结果，该漏洞影响多个 Windows 版本，包括 Windows 10 和 Windows Server。该漏洞利用涉及发送特制的 ICMPv6 数据包。PoC 代码使用 Scapy 库构造这些数据包，并发送给目标。PoC代码通过填充 `ICMPv6NDOptRDNSS` 选项的 `dns` 字段来触发漏洞。根据搜索结果和漏洞描述，该漏洞有可能导致远程代码执行或者拒绝服务（BSOD）。

**有效性：**
根据漏洞信息，该漏洞的 PoC 是可用的，提供的代码可以触发蓝屏死机（BSOD），表明 PoC 具有一定的有效性。

**投毒风险：**
该 PoC 代码主要使用 Scapy 库构造和发送 ICMPv6 数据包，未发现明显的恶意代码或后门。但是，所有来源不明的代码都存在一定的风险，建议在隔离环境中运行。
仔细审查代码，发现其逻辑主要是构造畸形的ICMPv6数据包以触发TCP/IP协议栈中的漏洞，目的是导致BSOD。其中最可疑的地方是大量的"AAAA:AAAA:AAAA:AAAA:AAAA:AAAA:AAAA:AAAA"字符串。这部分代码是在利用漏洞，而非添加恶意代码。因此，判定投毒风险较低，估计在5%左右，主要是考虑作者可能会植入一些不易察觉的payload。

**利用方式：**
1.  攻击者需要位于与目标系统相同的网络或者能够向目标系统发送 IPv6 数据包。
2.  攻击者利用 Scapy 等工具构造恶意的 ICMPv6 路由通告 (RA) 数据包，特别是 `ICMPv6NDOptRDNSS` 选项。
3.  构造的 ICMPv6 RA 数据包被发送到目标 Windows 系统。
4.  Windows TCP/IP 协议栈处理畸形的 ICMPv6 RA 数据包时，触发漏洞，可能导致远程代码执行或拒绝服务攻击（BSOD）。

**项目地址:** [momika233/CVE-2020-16898-exp](https://github.com/momika233/CVE-2020-16898-exp)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---



---

## POC #8

**来源**: [CVE-2020-16898-corelight_CVE-2020-16898.md](../2020/CVE-2020-16898-corelight_CVE-2020-16898.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞（Bad Neighbor）

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行，完全控制受影响系统

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, Windows Server version 2004 等多个版本受影响

**利用条件:** 攻击者需要与目标主机处于同一网络邻域，或者能够发送伪造的 ICMPv6 路由通告数据包到目标主机

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Windows TCP/IP 协议栈中，当其处理 ICMPv6 路由通告数据包时，未能正确解析其中的 RDNSS 选项（Option Type 25），导致内存损坏，进而允许攻击者执行任意代码。攻击者通过发送特制的 ICMPv6 路由通告数据包来触发此漏洞。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞是一个真实存在的远程代码执行漏洞，并且已经有公开的PoC代码。提供的Zeek脚本是一个网络检测包，用于检测利用此漏洞的恶意流量。它通过分析 ICMPv6 路由通告数据包，特别是检查 RDNSS 选项的长度是否为偶数来判断是否存在攻击。

**投毒风险分析：**

提供的PoC代码（Zeek脚本）主要用于检测攻击，而不是利用攻击。仔细检查提供的文件，包括`LICENSE`, `README.md`, `bro-pkg.meta`, `zkg.meta`, `scripts/CVE-2020-16898.zeek`, 和 `scripts/__load__.zeek`，没有发现明显的恶意代码或后门。代码逻辑清晰，主要是检测 ICMPv6 路由通告消息中 RDNSS 选项的长度是否合法。脚本通过生成 Notice 日志来告知管理员存在潜在的攻击行为。投毒的风险较低，但仍存在微小可能性，例如利用 Zeek 脚本的复杂性进行隐藏，或者利用 Zeek 本身的漏洞执行恶意操作。因此，保守估计投毒风险为5%。

**利用方式分析：**

1.  **攻击者构造恶意的 ICMPv6 路由通告数据包：** 数据包中包含一个格式错误的 RDNSS 选项（Option Type 25），其长度为非偶数。
2.  **攻击者将恶意数据包发送给目标 Windows 主机：** 可以通过本地网络发送，也可以通过中间人攻击等方式。
3.  **目标主机处理恶意数据包：** Windows TCP/IP 协议栈在处理该数据包时，由于 RDNSS 选项的长度错误，导致内存溢出。
4.  **攻击者利用内存溢出执行任意代码：** 攻击者可以在溢出的内存中写入恶意代码，并控制程序的执行流程，最终实现远程代码执行。

提供的 Zeek 脚本并不能直接利用漏洞，而是用于检测网络流量中是否存在利用此漏洞的攻击行为。 它通过检测 ICMPv6 路由通告消息中的 Recursive_DNS_Server_Option (RDNSS) 是否存在长度异常的情况（长度不为偶数）来进行判断。 如果发现异常，则会产生一个Notice告警。

**项目地址:** [corelight/CVE-2020-16898](https://github.com/corelight/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #9

**来源**: [CVE-2020-16898-esnet-security_cve-2020-16898.md](../2020/CVE-2020-16898-esnet-security_cve-2020-16898.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞 (Bad Neighbor)

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行，系统控制

**影响版本:** Windows 10 版本 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, 版本 1903, 版本 2004

**利用条件:** 攻击者需要与目标系统处于同一网络段，并发送特制的 ICMPv6 路由器通告数据包。

**POC 可用性:** 是，网络上已存在公开的PoC

**投毒风险:** 10%

## 详情

CVE-2020-16898 是一个存在于 Windows TCP/IP 协议栈中的远程代码执行漏洞。当 Windows TCP/IP 协议栈未正确处理 ICMPv6 路由器通告 (Router Advertisement) 数据包时，会导致此漏洞。攻击者可以通过向远程 Windows 计算机发送特制的 ICMPv6 路由器通告数据包来利用此漏洞。

**有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞真实存在，并且有公开可用的 PoC 代码。从搜索结果来看，该漏洞被称为"Bad Neighbor"，影响多个Windows版本，包括Windows 10和Windows Server 2019。

**投毒风险：**
提供的代码片段是Zeek (原 Bro) 网络安全监控平台的包，用于检测 CVE-2020-16898 和 CVE-2020-16899 漏洞的利用。这段代码本身是用于安全检测的，而不是漏洞利用的 PoC 代码。但是，由于攻击者可能修改或替换该Zeek包，以达到隐藏恶意行为或进行进一步攻击的目的，因此存在一定的投毒风险。

风险评估：
- 代码用途：用于检测漏洞，本身不包含漏洞利用代码。
- 代码来源：esnet-security，看似合法的组织，但无法完全排除风险。
- 代码行为：检测 ICMPv6 数据包，并记录相关信息。
- 潜在风险：修改后的 Zeek 包可能绕过检测，或者执行恶意操作。

综合考虑，认为存在10%的投毒风险。

**利用方式：**
1.  **攻击者发送特制的 ICMPv6 路由器通告数据包：** 该数据包包含一个畸形的或超出预期的 RDNSS (Recursive DNS Server) 选项。
2.  **Windows TCP/IP 协议栈处理数据包：**  当 TCP/IP 协议栈解析这个畸形 RDNSS 选项时，由于缺乏适当的边界检查，会发生缓冲区溢出。
3.  **远程代码执行：**  缓冲区溢出允许攻击者覆盖内存，最终导致在目标系统上执行任意代码。
4.  **权限提升：**  由于 TCP/IP 协议栈运行在内核模式，成功利用此漏洞可以获得系统级别的权限。

**项目地址:** [esnet-security/cve-2020-16898](https://github.com/esnet-security/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #10

**来源**: [CVE-2020-16898-initconf_CVE-2020-16898-Bad-Neighbor.md](../2020/CVE-2020-16898-initconf_CVE-2020-16898-Bad-Neighbor.md)

## CVE-2020-16898: Bad Neighbor - Windows TCP/IP远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行或拒绝服务 (DoS)

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要与目标系统处于同一网络或能够发送 ICMPv6 路由通告数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898，又名"Bad Neighbor"，是一个Windows TCP/IP堆栈中的远程代码执行漏洞。该漏洞源于Windows TCP/IP堆栈不正确地处理 ICMPv6 路由器通告数据包。攻击者可以通过发送特制的 ICMPv6 路由器通告数据包到远程Windows计算机来利用此漏洞。成功利用此漏洞的攻击者可以在目标服务器或客户端上执行代码。

根据漏洞信息和搜索结果，该漏洞可以通过发送包含畸形 RDNSS 选项的 ICMPv6 路由器通告数据包来触发。具体来说，当 RDNSS 选项的长度字段为偶数时，会触发漏洞。

提供的 Zeek 脚本实现了对该漏洞的检测。它会检查所有传入的 ICMPv6 流量，查找 ICMPv6 类型字段为 134 (表示路由器通告) 且 ICMPv6 选项字段为 25 (表示递归 DNS 服务器 RDNSS) 的数据包。如果此 RDNSS 选项的长度字段值为偶数，则该脚本会发出警报。

**有效性：**

提供的Zeek脚本并非漏洞利用代码，而是用于检测攻击的签名。其有效性在于检测到潜在的攻击流量，但它本身无法触发漏洞。

**投毒风险：**

该Zeek脚本的目的是检测恶意流量，本身不太可能包含投毒代码。 风险评估为10%。原因包括：
   * Zeek 脚本的主要功能是网络流量分析和检测，用于安全监控。因此，直接嵌入恶意代码的可能性较低。
   * 该脚本相对简单，主要基于对 ICMPv6 报文特定字段的检查，易于人工审查，从而降低了隐藏恶意代码的风险。

**利用方式：**

1.  攻击者需要与目标系统处于同一网络或能够向目标系统发送 ICMPv6 路由通告数据包。
2.  攻击者构造一个包含畸形 RDNSS 选项的 ICMPv6 路由通告数据包。RDNSS 选项的长度字段必须是偶数。
3.  攻击者将构造的数据包发送到目标系统。
4.  如果目标系统未打补丁，则可能导致远程代码执行或者拒绝服务。

**项目地址:** [initconf/CVE-2020-16898-Bad-Neighbor](https://github.com/initconf/CVE-2020-16898-Bad-Neighbor)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #11

**来源**: [CVE-2020-16898-jiansiting_cve-2020-16898.md](../2020/CVE-2020-16898-jiansiting_cve-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709 及以上，未安装相应补丁

**利用条件:** 需要目标系统开启 IPv6 且与攻击者处于同一网络或攻击者可发送 ICMPv6 报文到目标。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞。该漏洞源于 Windows TCP/IP 协议栈在处理 ICMPv6 路由器通告 (Router Advertisement) 报文时，没有正确处理 RDNSS 选项（递归 DNS 服务器）。攻击者可以通过发送特制的 ICMPv6 路由器通告报文，利用 Option Type 25 触发缓冲区溢出，从而导致蓝屏死机 (BSOD) 或者远程代码执行。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断此POC代码是有效的，因为该代码能够触发蓝屏死机（BSOD）。但是否能执行任意代码取决于目标系统的具体配置和缓解措施。

**投毒风险：**
分析提供的 `bsod-poc.py` 脚本，该脚本主要用于发送精心构造的 ICMPv6 报文，以触发目标系统的漏洞。代码主要使用了 `scapy` 库来构建和发送网络报文。代码逻辑相对清晰，没有发现明显的恶意代码或者后门，因此判断投毒风险较低。

**漏洞利用方式：**
1.  攻击者首先需要确定目标系统的 IPv6 地址。
2.  攻击者使用 `scapy` 库构建一个恶意的 ICMPv6 路由器通告报文。
3.  该报文中包含一个畸形的 RDNSS 选项，特别是 Option Type 25。
4.  通过 `fragment6` 函数对报文进行分片，然后将分片后的报文发送到目标系统。
5.  目标系统接收到这些报文后，由于 TCP/IP 协议栈处理 RDNSS 选项时存在漏洞，导致缓冲区溢出。
6.  攻击者可导致目标系统蓝屏死机，可能情况下实现远程代码执行。

**总而言之，提供的POC主要目的是触发BSOD，没有发现植入恶意代码的痕迹，投毒风险为0%。**

**项目地址:** [jiansiting/cve-2020-16898](https://github.com/jiansiting/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #12

**来源**: [CVE-2020-16898-komomon_CVE-2020-16898--EXP-POC.md](../2020/CVE-2020-16898-komomon_CVE-2020-16898--EXP-POC.md)

## CVE-2020-16898 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可导致远程代码执行甚至蓝屏死机（BSOD）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要与目标主机在同一网络中，并知道目标主机的IPv6地址（特别是本地链路地址）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-16898 是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞，当协议栈不正确处理 ICMPv6 路由器通告（Router Advertisement）数据包时，可能触发此漏洞。攻击者可以发送特制的 ICMPv6 路由器通告数据包到目标 Windows 计算机，从而获得在目标服务器或客户端上执行代码的能力。根据搜索结果，成功利用此漏洞可能导致蓝屏死机（BSOD），并可能被用于远程代码执行。漏洞出现在处理Option Type 25的ICMPv6 RA包时。

**漏洞利用方式：**

1.  **发送特制的 ICMPv6 数据包：** 攻击者需要构造包含恶意选项的 ICMPv6 路由器通告数据包。
2.  **利用 RDNSS 选项：** 漏洞利用通常涉及操纵 RDNSS (Recursive DNS Server) 选项，通过修改其长度和内容，来触发栈溢出。
3.  **碎片化处理：** 漏洞利用代码中使用了 IPv6 碎片化，将数据包分成小片段发送，以便绕过某些安全检测机制或更有效地触发漏洞。
4.  **覆盖返回地址：** 成功利用漏洞需要覆盖栈上的返回地址，以便在函数返回时执行攻击者控制的代码。

**有效性评估：**

提供的漏洞利用代码 (CVE-2020-16898-exp1.py 和 CVE-2020-16898.py) 似乎有效，至少可以触发蓝屏死机。根据 README 文件和代码注释，这些代码经过测试，并且需要修改目标 IPv6 地址才能使用。exp1 通过构造包含特定长度和内容的 ICMPv6 路由器通告数据包来利用漏洞，exp2 则是通过发送两个精心构造的 RDNSS 选项，触发栈溢出。

**投毒风险评估：**

虽然提供的代码主要用于触发 BSOD，但如果恶意修改，也可能被用于执行任意代码。仓库中的投毒风险较低，约为5%。主要风险点在于:

*   **payload的植入：** 攻击者可能会修改exp, 在exp的Overwrite部分植入恶意payload,当触发漏洞时,执行攻击者植入的payload.
*   **源地址欺骗：** 虽然exp文件注释显示可以伪造源地址，可能被用于中间人攻击或放大攻击。

总体来说，虽然直接的投毒代码并不明显，但攻击者可能通过修改提供的 PoC 代码来实现恶意目的。因此，在使用这些代码时需要格外小心，并在隔离环境中进行测试。

**项目地址:** [komomon/CVE-2020-16898--EXP-POC](https://github.com/komomon/CVE-2020-16898--EXP-POC)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #13

**来源**: [CVE-2020-16898-komomon_CVE-2020-16898-EXP-POC.md](../2020/CVE-2020-16898-komomon_CVE-2020-16898-EXP-POC.md)

## CVE-2020-16898 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务（蓝屏）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 攻击者需要能够向目标 Windows 计算机发送特制的 ICMPv6 路由器通告数据包，需要知道目标的 IPv6 地址（包括本地链路 IPv6 地址，全球 IPv6 地址，临时 IPv6 地址）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Windows TCP/IP栈中，由于对ICMPv6路由器通告报文处理不当导致。攻击者通过发送特制的ICMPv6报文，利用Option Type 25 触发漏洞。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的PoC已经公开，并且已被证实可以触发蓝屏死机（BSOD），表明漏洞利用是有效的。提供的漏洞利用代码中存在两个exp， exp1可以直接远程代码执行,exp2可以直接导致目标系统崩溃。

**投毒风险：**
检查了提供的PoC代码，未发现明显的恶意代码，但是，考虑到攻击者可能修改代码以进行恶意活动，例如植入后门或执行其他恶意操作，仍然存在一定的风险。

**利用方式：**
1.  攻击者需要确定目标系统的IPv6地址。
2.  攻击者使用PoC代码（例如，`CVE-2020-16898-exp1.py` 或 `CVE-2020-16898.py`），修改目标IP地址为攻击目标的IPv6地址。
3.  攻击者运行PoC代码，发送特制的ICMPv6路由器通告报文到目标系统。
4.  如果目标系统存在漏洞，可能会触发远程代码执行或者导致系统崩溃（BSOD）。

**缓解措施：**
*   及时安装Microsoft发布的补丁。
*   禁用IPv6，如果不需要使用IPv6网络。
*   配置防火墙规则，限制ICMPv6流量。

**项目地址:** [komomon/CVE-2020-16898-EXP-POC](https://github.com/komomon/CVE-2020-16898-EXP-POC)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #14

**来源**: [CVE-2020-16898-momika233_CVE-2020-16898-exp.md](../2020/CVE-2020-16898-momika233_CVE-2020-16898-exp.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞（Bad Neighbor）

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要在与目标系统相同的网络上或能够发送 ICMPv6 路由通告数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-16898 是一个存在于 Windows TCP/IP 协议栈中的远程代码执行漏洞。该漏洞是由于 Windows TCP/IP 协议栈不正确地处理 ICMPv6 路由通告数据包所致。 攻击者可以通过发送特制的 ICMPv6 路由通告数据包到远程 Windows 计算机来利用此漏洞，成功利用此漏洞的攻击者可以在目标服务器或客户端上执行任意代码。 

根据漏洞信息和搜索结果，该漏洞影响多个 Windows 版本，包括 Windows 10 和 Windows Server。该漏洞利用涉及发送特制的 ICMPv6 数据包。PoC 代码使用 Scapy 库构造这些数据包，并发送给目标。PoC代码通过填充 `ICMPv6NDOptRDNSS` 选项的 `dns` 字段来触发漏洞。根据搜索结果和漏洞描述，该漏洞有可能导致远程代码执行或者拒绝服务（BSOD）。

**有效性：**
根据漏洞信息，该漏洞的 PoC 是可用的，提供的代码可以触发蓝屏死机（BSOD），表明 PoC 具有一定的有效性。

**投毒风险：**
该 PoC 代码主要使用 Scapy 库构造和发送 ICMPv6 数据包，未发现明显的恶意代码或后门。但是，所有来源不明的代码都存在一定的风险，建议在隔离环境中运行。
仔细审查代码，发现其逻辑主要是构造畸形的ICMPv6数据包以触发TCP/IP协议栈中的漏洞，目的是导致BSOD。其中最可疑的地方是大量的"AAAA:AAAA:AAAA:AAAA:AAAA:AAAA:AAAA:AAAA"字符串。这部分代码是在利用漏洞，而非添加恶意代码。因此，判定投毒风险较低，估计在5%左右，主要是考虑作者可能会植入一些不易察觉的payload。

**利用方式：**
1.  攻击者需要位于与目标系统相同的网络或者能够向目标系统发送 IPv6 数据包。
2.  攻击者利用 Scapy 等工具构造恶意的 ICMPv6 路由通告 (RA) 数据包，特别是 `ICMPv6NDOptRDNSS` 选项。
3.  构造的 ICMPv6 RA 数据包被发送到目标 Windows 系统。
4.  Windows TCP/IP 协议栈处理畸形的 ICMPv6 RA 数据包时，触发漏洞，可能导致远程代码执行或拒绝服务攻击（BSOD）。

**项目地址:** [momika233/CVE-2020-16898-exp](https://github.com/momika233/CVE-2020-16898-exp)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---



---

## POC #8

**来源**: [CVE-2020-16898-corelight_CVE-2020-16898.md](../2020/CVE-2020-16898-corelight_CVE-2020-16898.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞（Bad Neighbor）

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行，完全控制受影响系统

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, Windows Server version 2004 等多个版本受影响

**利用条件:** 攻击者需要与目标主机处于同一网络邻域，或者能够发送伪造的 ICMPv6 路由通告数据包到目标主机

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Windows TCP/IP 协议栈中，当其处理 ICMPv6 路由通告数据包时，未能正确解析其中的 RDNSS 选项（Option Type 25），导致内存损坏，进而允许攻击者执行任意代码。攻击者通过发送特制的 ICMPv6 路由通告数据包来触发此漏洞。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞是一个真实存在的远程代码执行漏洞，并且已经有公开的PoC代码。提供的Zeek脚本是一个网络检测包，用于检测利用此漏洞的恶意流量。它通过分析 ICMPv6 路由通告数据包，特别是检查 RDNSS 选项的长度是否为偶数来判断是否存在攻击。

**投毒风险分析：**

提供的PoC代码（Zeek脚本）主要用于检测攻击，而不是利用攻击。仔细检查提供的文件，包括`LICENSE`, `README.md`, `bro-pkg.meta`, `zkg.meta`, `scripts/CVE-2020-16898.zeek`, 和 `scripts/__load__.zeek`，没有发现明显的恶意代码或后门。代码逻辑清晰，主要是检测 ICMPv6 路由通告消息中 RDNSS 选项的长度是否合法。脚本通过生成 Notice 日志来告知管理员存在潜在的攻击行为。投毒的风险较低，但仍存在微小可能性，例如利用 Zeek 脚本的复杂性进行隐藏，或者利用 Zeek 本身的漏洞执行恶意操作。因此，保守估计投毒风险为5%。

**利用方式分析：**

1.  **攻击者构造恶意的 ICMPv6 路由通告数据包：** 数据包中包含一个格式错误的 RDNSS 选项（Option Type 25），其长度为非偶数。
2.  **攻击者将恶意数据包发送给目标 Windows 主机：** 可以通过本地网络发送，也可以通过中间人攻击等方式。
3.  **目标主机处理恶意数据包：** Windows TCP/IP 协议栈在处理该数据包时，由于 RDNSS 选项的长度错误，导致内存溢出。
4.  **攻击者利用内存溢出执行任意代码：** 攻击者可以在溢出的内存中写入恶意代码，并控制程序的执行流程，最终实现远程代码执行。

提供的 Zeek 脚本并不能直接利用漏洞，而是用于检测网络流量中是否存在利用此漏洞的攻击行为。 它通过检测 ICMPv6 路由通告消息中的 Recursive_DNS_Server_Option (RDNSS) 是否存在长度异常的情况（长度不为偶数）来进行判断。 如果发现异常，则会产生一个Notice告警。

**项目地址:** [corelight/CVE-2020-16898](https://github.com/corelight/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #9

**来源**: [CVE-2020-16898-esnet-security_cve-2020-16898.md](../2020/CVE-2020-16898-esnet-security_cve-2020-16898.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞 (Bad Neighbor)

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行，系统控制

**影响版本:** Windows 10 版本 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, 版本 1903, 版本 2004

**利用条件:** 攻击者需要与目标系统处于同一网络段，并发送特制的 ICMPv6 路由器通告数据包。

**POC 可用性:** 是，网络上已存在公开的PoC

**投毒风险:** 10%

## 详情

CVE-2020-16898 是一个存在于 Windows TCP/IP 协议栈中的远程代码执行漏洞。当 Windows TCP/IP 协议栈未正确处理 ICMPv6 路由器通告 (Router Advertisement) 数据包时，会导致此漏洞。攻击者可以通过向远程 Windows 计算机发送特制的 ICMPv6 路由器通告数据包来利用此漏洞。

**有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞真实存在，并且有公开可用的 PoC 代码。从搜索结果来看，该漏洞被称为"Bad Neighbor"，影响多个Windows版本，包括Windows 10和Windows Server 2019。

**投毒风险：**
提供的代码片段是Zeek (原 Bro) 网络安全监控平台的包，用于检测 CVE-2020-16898 和 CVE-2020-16899 漏洞的利用。这段代码本身是用于安全检测的，而不是漏洞利用的 PoC 代码。但是，由于攻击者可能修改或替换该Zeek包，以达到隐藏恶意行为或进行进一步攻击的目的，因此存在一定的投毒风险。

风险评估：
- 代码用途：用于检测漏洞，本身不包含漏洞利用代码。
- 代码来源：esnet-security，看似合法的组织，但无法完全排除风险。
- 代码行为：检测 ICMPv6 数据包，并记录相关信息。
- 潜在风险：修改后的 Zeek 包可能绕过检测，或者执行恶意操作。

综合考虑，认为存在10%的投毒风险。

**利用方式：**
1.  **攻击者发送特制的 ICMPv6 路由器通告数据包：** 该数据包包含一个畸形的或超出预期的 RDNSS (Recursive DNS Server) 选项。
2.  **Windows TCP/IP 协议栈处理数据包：**  当 TCP/IP 协议栈解析这个畸形 RDNSS 选项时，由于缺乏适当的边界检查，会发生缓冲区溢出。
3.  **远程代码执行：**  缓冲区溢出允许攻击者覆盖内存，最终导致在目标系统上执行任意代码。
4.  **权限提升：**  由于 TCP/IP 协议栈运行在内核模式，成功利用此漏洞可以获得系统级别的权限。

**项目地址:** [esnet-security/cve-2020-16898](https://github.com/esnet-security/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #10

**来源**: [CVE-2020-16898-initconf_CVE-2020-16898-Bad-Neighbor.md](../2020/CVE-2020-16898-initconf_CVE-2020-16898-Bad-Neighbor.md)

## CVE-2020-16898: Bad Neighbor - Windows TCP/IP远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行或拒绝服务 (DoS)

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要与目标系统处于同一网络或能够发送 ICMPv6 路由通告数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898，又名"Bad Neighbor"，是一个Windows TCP/IP堆栈中的远程代码执行漏洞。该漏洞源于Windows TCP/IP堆栈不正确地处理 ICMPv6 路由器通告数据包。攻击者可以通过发送特制的 ICMPv6 路由器通告数据包到远程Windows计算机来利用此漏洞。成功利用此漏洞的攻击者可以在目标服务器或客户端上执行代码。

根据漏洞信息和搜索结果，该漏洞可以通过发送包含畸形 RDNSS 选项的 ICMPv6 路由器通告数据包来触发。具体来说，当 RDNSS 选项的长度字段为偶数时，会触发漏洞。

提供的 Zeek 脚本实现了对该漏洞的检测。它会检查所有传入的 ICMPv6 流量，查找 ICMPv6 类型字段为 134 (表示路由器通告) 且 ICMPv6 选项字段为 25 (表示递归 DNS 服务器 RDNSS) 的数据包。如果此 RDNSS 选项的长度字段值为偶数，则该脚本会发出警报。

**有效性：**

提供的Zeek脚本并非漏洞利用代码，而是用于检测攻击的签名。其有效性在于检测到潜在的攻击流量，但它本身无法触发漏洞。

**投毒风险：**

该Zeek脚本的目的是检测恶意流量，本身不太可能包含投毒代码。 风险评估为10%。原因包括：
   * Zeek 脚本的主要功能是网络流量分析和检测，用于安全监控。因此，直接嵌入恶意代码的可能性较低。
   * 该脚本相对简单，主要基于对 ICMPv6 报文特定字段的检查，易于人工审查，从而降低了隐藏恶意代码的风险。

**利用方式：**

1.  攻击者需要与目标系统处于同一网络或能够向目标系统发送 ICMPv6 路由通告数据包。
2.  攻击者构造一个包含畸形 RDNSS 选项的 ICMPv6 路由通告数据包。RDNSS 选项的长度字段必须是偶数。
3.  攻击者将构造的数据包发送到目标系统。
4.  如果目标系统未打补丁，则可能导致远程代码执行或者拒绝服务。

**项目地址:** [initconf/CVE-2020-16898-Bad-Neighbor](https://github.com/initconf/CVE-2020-16898-Bad-Neighbor)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #11

**来源**: [CVE-2020-16898-jiansiting_cve-2020-16898.md](../2020/CVE-2020-16898-jiansiting_cve-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709 及以上，未安装相应补丁

**利用条件:** 需要目标系统开启 IPv6 且与攻击者处于同一网络或攻击者可发送 ICMPv6 报文到目标。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞。该漏洞源于 Windows TCP/IP 协议栈在处理 ICMPv6 路由器通告 (Router Advertisement) 报文时，没有正确处理 RDNSS 选项（递归 DNS 服务器）。攻击者可以通过发送特制的 ICMPv6 路由器通告报文，利用 Option Type 25 触发缓冲区溢出，从而导致蓝屏死机 (BSOD) 或者远程代码执行。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断此POC代码是有效的，因为该代码能够触发蓝屏死机（BSOD）。但是否能执行任意代码取决于目标系统的具体配置和缓解措施。

**投毒风险：**
分析提供的 `bsod-poc.py` 脚本，该脚本主要用于发送精心构造的 ICMPv6 报文，以触发目标系统的漏洞。代码主要使用了 `scapy` 库来构建和发送网络报文。代码逻辑相对清晰，没有发现明显的恶意代码或者后门，因此判断投毒风险较低。

**漏洞利用方式：**
1.  攻击者首先需要确定目标系统的 IPv6 地址。
2.  攻击者使用 `scapy` 库构建一个恶意的 ICMPv6 路由器通告报文。
3.  该报文中包含一个畸形的 RDNSS 选项，特别是 Option Type 25。
4.  通过 `fragment6` 函数对报文进行分片，然后将分片后的报文发送到目标系统。
5.  目标系统接收到这些报文后，由于 TCP/IP 协议栈处理 RDNSS 选项时存在漏洞，导致缓冲区溢出。
6.  攻击者可导致目标系统蓝屏死机，可能情况下实现远程代码执行。

**总而言之，提供的POC主要目的是触发BSOD，没有发现植入恶意代码的痕迹，投毒风险为0%。**

**项目地址:** [jiansiting/cve-2020-16898](https://github.com/jiansiting/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #12

**来源**: [CVE-2020-16898-komomon_CVE-2020-16898--EXP-POC.md](../2020/CVE-2020-16898-komomon_CVE-2020-16898--EXP-POC.md)

## CVE-2020-16898 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可导致远程代码执行甚至蓝屏死机（BSOD）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要与目标主机在同一网络中，并知道目标主机的IPv6地址（特别是本地链路地址）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-16898 是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞，当协议栈不正确处理 ICMPv6 路由器通告（Router Advertisement）数据包时，可能触发此漏洞。攻击者可以发送特制的 ICMPv6 路由器通告数据包到目标 Windows 计算机，从而获得在目标服务器或客户端上执行代码的能力。根据搜索结果，成功利用此漏洞可能导致蓝屏死机（BSOD），并可能被用于远程代码执行。漏洞出现在处理Option Type 25的ICMPv6 RA包时。

**漏洞利用方式：**

1.  **发送特制的 ICMPv6 数据包：** 攻击者需要构造包含恶意选项的 ICMPv6 路由器通告数据包。
2.  **利用 RDNSS 选项：** 漏洞利用通常涉及操纵 RDNSS (Recursive DNS Server) 选项，通过修改其长度和内容，来触发栈溢出。
3.  **碎片化处理：** 漏洞利用代码中使用了 IPv6 碎片化，将数据包分成小片段发送，以便绕过某些安全检测机制或更有效地触发漏洞。
4.  **覆盖返回地址：** 成功利用漏洞需要覆盖栈上的返回地址，以便在函数返回时执行攻击者控制的代码。

**有效性评估：**

提供的漏洞利用代码 (CVE-2020-16898-exp1.py 和 CVE-2020-16898.py) 似乎有效，至少可以触发蓝屏死机。根据 README 文件和代码注释，这些代码经过测试，并且需要修改目标 IPv6 地址才能使用。exp1 通过构造包含特定长度和内容的 ICMPv6 路由器通告数据包来利用漏洞，exp2 则是通过发送两个精心构造的 RDNSS 选项，触发栈溢出。

**投毒风险评估：**

虽然提供的代码主要用于触发 BSOD，但如果恶意修改，也可能被用于执行任意代码。仓库中的投毒风险较低，约为5%。主要风险点在于:

*   **payload的植入：** 攻击者可能会修改exp, 在exp的Overwrite部分植入恶意payload,当触发漏洞时,执行攻击者植入的payload.
*   **源地址欺骗：** 虽然exp文件注释显示可以伪造源地址，可能被用于中间人攻击或放大攻击。

总体来说，虽然直接的投毒代码并不明显，但攻击者可能通过修改提供的 PoC 代码来实现恶意目的。因此，在使用这些代码时需要格外小心，并在隔离环境中进行测试。

**项目地址:** [komomon/CVE-2020-16898--EXP-POC](https://github.com/komomon/CVE-2020-16898--EXP-POC)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #13

**来源**: [CVE-2020-16898-komomon_CVE-2020-16898-EXP-POC.md](../2020/CVE-2020-16898-komomon_CVE-2020-16898-EXP-POC.md)

## CVE-2020-16898 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务（蓝屏）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 攻击者需要能够向目标 Windows 计算机发送特制的 ICMPv6 路由器通告数据包，需要知道目标的 IPv6 地址（包括本地链路 IPv6 地址，全球 IPv6 地址，临时 IPv6 地址）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Windows TCP/IP栈中，由于对ICMPv6路由器通告报文处理不当导致。攻击者通过发送特制的ICMPv6报文，利用Option Type 25 触发漏洞。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的PoC已经公开，并且已被证实可以触发蓝屏死机（BSOD），表明漏洞利用是有效的。提供的漏洞利用代码中存在两个exp， exp1可以直接远程代码执行,exp2可以直接导致目标系统崩溃。

**投毒风险：**
检查了提供的PoC代码，未发现明显的恶意代码，但是，考虑到攻击者可能修改代码以进行恶意活动，例如植入后门或执行其他恶意操作，仍然存在一定的风险。

**利用方式：**
1.  攻击者需要确定目标系统的IPv6地址。
2.  攻击者使用PoC代码（例如，`CVE-2020-16898-exp1.py` 或 `CVE-2020-16898.py`），修改目标IP地址为攻击目标的IPv6地址。
3.  攻击者运行PoC代码，发送特制的ICMPv6路由器通告报文到目标系统。
4.  如果目标系统存在漏洞，可能会触发远程代码执行或者导致系统崩溃（BSOD）。

**缓解措施：**
*   及时安装Microsoft发布的补丁。
*   禁用IPv6，如果不需要使用IPv6网络。
*   配置防火墙规则，限制ICMPv6流量。

**项目地址:** [komomon/CVE-2020-16898-EXP-POC](https://github.com/komomon/CVE-2020-16898-EXP-POC)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #14

**来源**: [CVE-2020-16898-momika233_CVE-2020-16898-exp.md](../2020/CVE-2020-16898-momika233_CVE-2020-16898-exp.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞（Bad Neighbor）

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要在与目标系统相同的网络上或能够发送 ICMPv6 路由通告数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-16898 是一个存在于 Windows TCP/IP 协议栈中的远程代码执行漏洞。该漏洞是由于 Windows TCP/IP 协议栈不正确地处理 ICMPv6 路由通告数据包所致。 攻击者可以通过发送特制的 ICMPv6 路由通告数据包到远程 Windows 计算机来利用此漏洞，成功利用此漏洞的攻击者可以在目标服务器或客户端上执行任意代码。 

根据漏洞信息和搜索结果，该漏洞影响多个 Windows 版本，包括 Windows 10 和 Windows Server。该漏洞利用涉及发送特制的 ICMPv6 数据包。PoC 代码使用 Scapy 库构造这些数据包，并发送给目标。PoC代码通过填充 `ICMPv6NDOptRDNSS` 选项的 `dns` 字段来触发漏洞。根据搜索结果和漏洞描述，该漏洞有可能导致远程代码执行或者拒绝服务（BSOD）。

**有效性：**
根据漏洞信息，该漏洞的 PoC 是可用的，提供的代码可以触发蓝屏死机（BSOD），表明 PoC 具有一定的有效性。

**投毒风险：**
该 PoC 代码主要使用 Scapy 库构造和发送 ICMPv6 数据包，未发现明显的恶意代码或后门。但是，所有来源不明的代码都存在一定的风险，建议在隔离环境中运行。
仔细审查代码，发现其逻辑主要是构造畸形的ICMPv6数据包以触发TCP/IP协议栈中的漏洞，目的是导致BSOD。其中最可疑的地方是大量的"AAAA:AAAA:AAAA:AAAA:AAAA:AAAA:AAAA:AAAA"字符串。这部分代码是在利用漏洞，而非添加恶意代码。因此，判定投毒风险较低，估计在5%左右，主要是考虑作者可能会植入一些不易察觉的payload。

**利用方式：**
1.  攻击者需要位于与目标系统相同的网络或者能够向目标系统发送 IPv6 数据包。
2.  攻击者利用 Scapy 等工具构造恶意的 ICMPv6 路由通告 (RA) 数据包，特别是 `ICMPv6NDOptRDNSS` 选项。
3.  构造的 ICMPv6 RA 数据包被发送到目标 Windows 系统。
4.  Windows TCP/IP 协议栈处理畸形的 ICMPv6 RA 数据包时，触发漏洞，可能导致远程代码执行或拒绝服务攻击（BSOD）。

**项目地址:** [momika233/CVE-2020-16898-exp](https://github.com/momika233/CVE-2020-16898-exp)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---



---

## POC #8

**来源**: [CVE-2020-16898-corelight_CVE-2020-16898.md](../2020/CVE-2020-16898-corelight_CVE-2020-16898.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞（Bad Neighbor）

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行，完全控制受影响系统

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, Windows Server version 2004 等多个版本受影响

**利用条件:** 攻击者需要与目标主机处于同一网络邻域，或者能够发送伪造的 ICMPv6 路由通告数据包到目标主机

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Windows TCP/IP 协议栈中，当其处理 ICMPv6 路由通告数据包时，未能正确解析其中的 RDNSS 选项（Option Type 25），导致内存损坏，进而允许攻击者执行任意代码。攻击者通过发送特制的 ICMPv6 路由通告数据包来触发此漏洞。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞是一个真实存在的远程代码执行漏洞，并且已经有公开的PoC代码。提供的Zeek脚本是一个网络检测包，用于检测利用此漏洞的恶意流量。它通过分析 ICMPv6 路由通告数据包，特别是检查 RDNSS 选项的长度是否为偶数来判断是否存在攻击。

**投毒风险分析：**

提供的PoC代码（Zeek脚本）主要用于检测攻击，而不是利用攻击。仔细检查提供的文件，包括`LICENSE`, `README.md`, `bro-pkg.meta`, `zkg.meta`, `scripts/CVE-2020-16898.zeek`, 和 `scripts/__load__.zeek`，没有发现明显的恶意代码或后门。代码逻辑清晰，主要是检测 ICMPv6 路由通告消息中 RDNSS 选项的长度是否合法。脚本通过生成 Notice 日志来告知管理员存在潜在的攻击行为。投毒的风险较低，但仍存在微小可能性，例如利用 Zeek 脚本的复杂性进行隐藏，或者利用 Zeek 本身的漏洞执行恶意操作。因此，保守估计投毒风险为5%。

**利用方式分析：**

1.  **攻击者构造恶意的 ICMPv6 路由通告数据包：** 数据包中包含一个格式错误的 RDNSS 选项（Option Type 25），其长度为非偶数。
2.  **攻击者将恶意数据包发送给目标 Windows 主机：** 可以通过本地网络发送，也可以通过中间人攻击等方式。
3.  **目标主机处理恶意数据包：** Windows TCP/IP 协议栈在处理该数据包时，由于 RDNSS 选项的长度错误，导致内存溢出。
4.  **攻击者利用内存溢出执行任意代码：** 攻击者可以在溢出的内存中写入恶意代码，并控制程序的执行流程，最终实现远程代码执行。

提供的 Zeek 脚本并不能直接利用漏洞，而是用于检测网络流量中是否存在利用此漏洞的攻击行为。 它通过检测 ICMPv6 路由通告消息中的 Recursive_DNS_Server_Option (RDNSS) 是否存在长度异常的情况（长度不为偶数）来进行判断。 如果发现异常，则会产生一个Notice告警。

**项目地址:** [corelight/CVE-2020-16898](https://github.com/corelight/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #9

**来源**: [CVE-2020-16898-esnet-security_cve-2020-16898.md](../2020/CVE-2020-16898-esnet-security_cve-2020-16898.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞 (Bad Neighbor)

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行，系统控制

**影响版本:** Windows 10 版本 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, 版本 1903, 版本 2004

**利用条件:** 攻击者需要与目标系统处于同一网络段，并发送特制的 ICMPv6 路由器通告数据包。

**POC 可用性:** 是，网络上已存在公开的PoC

**投毒风险:** 10%

## 详情

CVE-2020-16898 是一个存在于 Windows TCP/IP 协议栈中的远程代码执行漏洞。当 Windows TCP/IP 协议栈未正确处理 ICMPv6 路由器通告 (Router Advertisement) 数据包时，会导致此漏洞。攻击者可以通过向远程 Windows 计算机发送特制的 ICMPv6 路由器通告数据包来利用此漏洞。

**有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞真实存在，并且有公开可用的 PoC 代码。从搜索结果来看，该漏洞被称为"Bad Neighbor"，影响多个Windows版本，包括Windows 10和Windows Server 2019。

**投毒风险：**
提供的代码片段是Zeek (原 Bro) 网络安全监控平台的包，用于检测 CVE-2020-16898 和 CVE-2020-16899 漏洞的利用。这段代码本身是用于安全检测的，而不是漏洞利用的 PoC 代码。但是，由于攻击者可能修改或替换该Zeek包，以达到隐藏恶意行为或进行进一步攻击的目的，因此存在一定的投毒风险。

风险评估：
- 代码用途：用于检测漏洞，本身不包含漏洞利用代码。
- 代码来源：esnet-security，看似合法的组织，但无法完全排除风险。
- 代码行为：检测 ICMPv6 数据包，并记录相关信息。
- 潜在风险：修改后的 Zeek 包可能绕过检测，或者执行恶意操作。

综合考虑，认为存在10%的投毒风险。

**利用方式：**
1.  **攻击者发送特制的 ICMPv6 路由器通告数据包：** 该数据包包含一个畸形的或超出预期的 RDNSS (Recursive DNS Server) 选项。
2.  **Windows TCP/IP 协议栈处理数据包：**  当 TCP/IP 协议栈解析这个畸形 RDNSS 选项时，由于缺乏适当的边界检查，会发生缓冲区溢出。
3.  **远程代码执行：**  缓冲区溢出允许攻击者覆盖内存，最终导致在目标系统上执行任意代码。
4.  **权限提升：**  由于 TCP/IP 协议栈运行在内核模式，成功利用此漏洞可以获得系统级别的权限。

**项目地址:** [esnet-security/cve-2020-16898](https://github.com/esnet-security/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #10

**来源**: [CVE-2020-16898-initconf_CVE-2020-16898-Bad-Neighbor.md](../2020/CVE-2020-16898-initconf_CVE-2020-16898-Bad-Neighbor.md)

## CVE-2020-16898: Bad Neighbor - Windows TCP/IP远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行或拒绝服务 (DoS)

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要与目标系统处于同一网络或能够发送 ICMPv6 路由通告数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898，又名"Bad Neighbor"，是一个Windows TCP/IP堆栈中的远程代码执行漏洞。该漏洞源于Windows TCP/IP堆栈不正确地处理 ICMPv6 路由器通告数据包。攻击者可以通过发送特制的 ICMPv6 路由器通告数据包到远程Windows计算机来利用此漏洞。成功利用此漏洞的攻击者可以在目标服务器或客户端上执行代码。

根据漏洞信息和搜索结果，该漏洞可以通过发送包含畸形 RDNSS 选项的 ICMPv6 路由器通告数据包来触发。具体来说，当 RDNSS 选项的长度字段为偶数时，会触发漏洞。

提供的 Zeek 脚本实现了对该漏洞的检测。它会检查所有传入的 ICMPv6 流量，查找 ICMPv6 类型字段为 134 (表示路由器通告) 且 ICMPv6 选项字段为 25 (表示递归 DNS 服务器 RDNSS) 的数据包。如果此 RDNSS 选项的长度字段值为偶数，则该脚本会发出警报。

**有效性：**

提供的Zeek脚本并非漏洞利用代码，而是用于检测攻击的签名。其有效性在于检测到潜在的攻击流量，但它本身无法触发漏洞。

**投毒风险：**

该Zeek脚本的目的是检测恶意流量，本身不太可能包含投毒代码。 风险评估为10%。原因包括：
   * Zeek 脚本的主要功能是网络流量分析和检测，用于安全监控。因此，直接嵌入恶意代码的可能性较低。
   * 该脚本相对简单，主要基于对 ICMPv6 报文特定字段的检查，易于人工审查，从而降低了隐藏恶意代码的风险。

**利用方式：**

1.  攻击者需要与目标系统处于同一网络或能够向目标系统发送 ICMPv6 路由通告数据包。
2.  攻击者构造一个包含畸形 RDNSS 选项的 ICMPv6 路由通告数据包。RDNSS 选项的长度字段必须是偶数。
3.  攻击者将构造的数据包发送到目标系统。
4.  如果目标系统未打补丁，则可能导致远程代码执行或者拒绝服务。

**项目地址:** [initconf/CVE-2020-16898-Bad-Neighbor](https://github.com/initconf/CVE-2020-16898-Bad-Neighbor)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #11

**来源**: [CVE-2020-16898-jiansiting_cve-2020-16898.md](../2020/CVE-2020-16898-jiansiting_cve-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709 及以上，未安装相应补丁

**利用条件:** 需要目标系统开启 IPv6 且与攻击者处于同一网络或攻击者可发送 ICMPv6 报文到目标。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞。该漏洞源于 Windows TCP/IP 协议栈在处理 ICMPv6 路由器通告 (Router Advertisement) 报文时，没有正确处理 RDNSS 选项（递归 DNS 服务器）。攻击者可以通过发送特制的 ICMPv6 路由器通告报文，利用 Option Type 25 触发缓冲区溢出，从而导致蓝屏死机 (BSOD) 或者远程代码执行。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断此POC代码是有效的，因为该代码能够触发蓝屏死机（BSOD）。但是否能执行任意代码取决于目标系统的具体配置和缓解措施。

**投毒风险：**
分析提供的 `bsod-poc.py` 脚本，该脚本主要用于发送精心构造的 ICMPv6 报文，以触发目标系统的漏洞。代码主要使用了 `scapy` 库来构建和发送网络报文。代码逻辑相对清晰，没有发现明显的恶意代码或者后门，因此判断投毒风险较低。

**漏洞利用方式：**
1.  攻击者首先需要确定目标系统的 IPv6 地址。
2.  攻击者使用 `scapy` 库构建一个恶意的 ICMPv6 路由器通告报文。
3.  该报文中包含一个畸形的 RDNSS 选项，特别是 Option Type 25。
4.  通过 `fragment6` 函数对报文进行分片，然后将分片后的报文发送到目标系统。
5.  目标系统接收到这些报文后，由于 TCP/IP 协议栈处理 RDNSS 选项时存在漏洞，导致缓冲区溢出。
6.  攻击者可导致目标系统蓝屏死机，可能情况下实现远程代码执行。

**总而言之，提供的POC主要目的是触发BSOD，没有发现植入恶意代码的痕迹，投毒风险为0%。**

**项目地址:** [jiansiting/cve-2020-16898](https://github.com/jiansiting/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #12

**来源**: [CVE-2020-16898-komomon_CVE-2020-16898--EXP-POC.md](../2020/CVE-2020-16898-komomon_CVE-2020-16898--EXP-POC.md)

## CVE-2020-16898 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可导致远程代码执行甚至蓝屏死机（BSOD）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要与目标主机在同一网络中，并知道目标主机的IPv6地址（特别是本地链路地址）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-16898 是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞，当协议栈不正确处理 ICMPv6 路由器通告（Router Advertisement）数据包时，可能触发此漏洞。攻击者可以发送特制的 ICMPv6 路由器通告数据包到目标 Windows 计算机，从而获得在目标服务器或客户端上执行代码的能力。根据搜索结果，成功利用此漏洞可能导致蓝屏死机（BSOD），并可能被用于远程代码执行。漏洞出现在处理Option Type 25的ICMPv6 RA包时。

**漏洞利用方式：**

1.  **发送特制的 ICMPv6 数据包：** 攻击者需要构造包含恶意选项的 ICMPv6 路由器通告数据包。
2.  **利用 RDNSS 选项：** 漏洞利用通常涉及操纵 RDNSS (Recursive DNS Server) 选项，通过修改其长度和内容，来触发栈溢出。
3.  **碎片化处理：** 漏洞利用代码中使用了 IPv6 碎片化，将数据包分成小片段发送，以便绕过某些安全检测机制或更有效地触发漏洞。
4.  **覆盖返回地址：** 成功利用漏洞需要覆盖栈上的返回地址，以便在函数返回时执行攻击者控制的代码。

**有效性评估：**

提供的漏洞利用代码 (CVE-2020-16898-exp1.py 和 CVE-2020-16898.py) 似乎有效，至少可以触发蓝屏死机。根据 README 文件和代码注释，这些代码经过测试，并且需要修改目标 IPv6 地址才能使用。exp1 通过构造包含特定长度和内容的 ICMPv6 路由器通告数据包来利用漏洞，exp2 则是通过发送两个精心构造的 RDNSS 选项，触发栈溢出。

**投毒风险评估：**

虽然提供的代码主要用于触发 BSOD，但如果恶意修改，也可能被用于执行任意代码。仓库中的投毒风险较低，约为5%。主要风险点在于:

*   **payload的植入：** 攻击者可能会修改exp, 在exp的Overwrite部分植入恶意payload,当触发漏洞时,执行攻击者植入的payload.
*   **源地址欺骗：** 虽然exp文件注释显示可以伪造源地址，可能被用于中间人攻击或放大攻击。

总体来说，虽然直接的投毒代码并不明显，但攻击者可能通过修改提供的 PoC 代码来实现恶意目的。因此，在使用这些代码时需要格外小心，并在隔离环境中进行测试。

**项目地址:** [komomon/CVE-2020-16898--EXP-POC](https://github.com/komomon/CVE-2020-16898--EXP-POC)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #13

**来源**: [CVE-2020-16898-komomon_CVE-2020-16898-EXP-POC.md](../2020/CVE-2020-16898-komomon_CVE-2020-16898-EXP-POC.md)

## CVE-2020-16898 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务（蓝屏）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 攻击者需要能够向目标 Windows 计算机发送特制的 ICMPv6 路由器通告数据包，需要知道目标的 IPv6 地址（包括本地链路 IPv6 地址，全球 IPv6 地址，临时 IPv6 地址）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Windows TCP/IP栈中，由于对ICMPv6路由器通告报文处理不当导致。攻击者通过发送特制的ICMPv6报文，利用Option Type 25 触发漏洞。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的PoC已经公开，并且已被证实可以触发蓝屏死机（BSOD），表明漏洞利用是有效的。提供的漏洞利用代码中存在两个exp， exp1可以直接远程代码执行,exp2可以直接导致目标系统崩溃。

**投毒风险：**
检查了提供的PoC代码，未发现明显的恶意代码，但是，考虑到攻击者可能修改代码以进行恶意活动，例如植入后门或执行其他恶意操作，仍然存在一定的风险。

**利用方式：**
1.  攻击者需要确定目标系统的IPv6地址。
2.  攻击者使用PoC代码（例如，`CVE-2020-16898-exp1.py` 或 `CVE-2020-16898.py`），修改目标IP地址为攻击目标的IPv6地址。
3.  攻击者运行PoC代码，发送特制的ICMPv6路由器通告报文到目标系统。
4.  如果目标系统存在漏洞，可能会触发远程代码执行或者导致系统崩溃（BSOD）。

**缓解措施：**
*   及时安装Microsoft发布的补丁。
*   禁用IPv6，如果不需要使用IPv6网络。
*   配置防火墙规则，限制ICMPv6流量。

**项目地址:** [komomon/CVE-2020-16898-EXP-POC](https://github.com/komomon/CVE-2020-16898-EXP-POC)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #14

**来源**: [CVE-2020-16898-momika233_CVE-2020-16898-exp.md](../2020/CVE-2020-16898-momika233_CVE-2020-16898-exp.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞（Bad Neighbor）

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要在与目标系统相同的网络上或能够发送 ICMPv6 路由通告数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-16898 是一个存在于 Windows TCP/IP 协议栈中的远程代码执行漏洞。该漏洞是由于 Windows TCP/IP 协议栈不正确地处理 ICMPv6 路由通告数据包所致。 攻击者可以通过发送特制的 ICMPv6 路由通告数据包到远程 Windows 计算机来利用此漏洞，成功利用此漏洞的攻击者可以在目标服务器或客户端上执行任意代码。 

根据漏洞信息和搜索结果，该漏洞影响多个 Windows 版本，包括 Windows 10 和 Windows Server。该漏洞利用涉及发送特制的 ICMPv6 数据包。PoC 代码使用 Scapy 库构造这些数据包，并发送给目标。PoC代码通过填充 `ICMPv6NDOptRDNSS` 选项的 `dns` 字段来触发漏洞。根据搜索结果和漏洞描述，该漏洞有可能导致远程代码执行或者拒绝服务（BSOD）。

**有效性：**
根据漏洞信息，该漏洞的 PoC 是可用的，提供的代码可以触发蓝屏死机（BSOD），表明 PoC 具有一定的有效性。

**投毒风险：**
该 PoC 代码主要使用 Scapy 库构造和发送 ICMPv6 数据包，未发现明显的恶意代码或后门。但是，所有来源不明的代码都存在一定的风险，建议在隔离环境中运行。
仔细审查代码，发现其逻辑主要是构造畸形的ICMPv6数据包以触发TCP/IP协议栈中的漏洞，目的是导致BSOD。其中最可疑的地方是大量的"AAAA:AAAA:AAAA:AAAA:AAAA:AAAA:AAAA:AAAA"字符串。这部分代码是在利用漏洞，而非添加恶意代码。因此，判定投毒风险较低，估计在5%左右，主要是考虑作者可能会植入一些不易察觉的payload。

**利用方式：**
1.  攻击者需要位于与目标系统相同的网络或者能够向目标系统发送 IPv6 数据包。
2.  攻击者利用 Scapy 等工具构造恶意的 ICMPv6 路由通告 (RA) 数据包，特别是 `ICMPv6NDOptRDNSS` 选项。
3.  构造的 ICMPv6 RA 数据包被发送到目标 Windows 系统。
4.  Windows TCP/IP 协议栈处理畸形的 ICMPv6 RA 数据包时，触发漏洞，可能导致远程代码执行或拒绝服务攻击（BSOD）。

**项目地址:** [momika233/CVE-2020-16898-exp](https://github.com/momika233/CVE-2020-16898-exp)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---



---

## POC #8

**来源**: [CVE-2020-16898-corelight_CVE-2020-16898.md](../2020/CVE-2020-16898-corelight_CVE-2020-16898.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞（Bad Neighbor）

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行，完全控制受影响系统

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, Windows Server version 2004 等多个版本受影响

**利用条件:** 攻击者需要与目标主机处于同一网络邻域，或者能够发送伪造的 ICMPv6 路由通告数据包到目标主机

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Windows TCP/IP 协议栈中，当其处理 ICMPv6 路由通告数据包时，未能正确解析其中的 RDNSS 选项（Option Type 25），导致内存损坏，进而允许攻击者执行任意代码。攻击者通过发送特制的 ICMPv6 路由通告数据包来触发此漏洞。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞是一个真实存在的远程代码执行漏洞，并且已经有公开的PoC代码。提供的Zeek脚本是一个网络检测包，用于检测利用此漏洞的恶意流量。它通过分析 ICMPv6 路由通告数据包，特别是检查 RDNSS 选项的长度是否为偶数来判断是否存在攻击。

**投毒风险分析：**

提供的PoC代码（Zeek脚本）主要用于检测攻击，而不是利用攻击。仔细检查提供的文件，包括`LICENSE`, `README.md`, `bro-pkg.meta`, `zkg.meta`, `scripts/CVE-2020-16898.zeek`, 和 `scripts/__load__.zeek`，没有发现明显的恶意代码或后门。代码逻辑清晰，主要是检测 ICMPv6 路由通告消息中 RDNSS 选项的长度是否合法。脚本通过生成 Notice 日志来告知管理员存在潜在的攻击行为。投毒的风险较低，但仍存在微小可能性，例如利用 Zeek 脚本的复杂性进行隐藏，或者利用 Zeek 本身的漏洞执行恶意操作。因此，保守估计投毒风险为5%。

**利用方式分析：**

1.  **攻击者构造恶意的 ICMPv6 路由通告数据包：** 数据包中包含一个格式错误的 RDNSS 选项（Option Type 25），其长度为非偶数。
2.  **攻击者将恶意数据包发送给目标 Windows 主机：** 可以通过本地网络发送，也可以通过中间人攻击等方式。
3.  **目标主机处理恶意数据包：** Windows TCP/IP 协议栈在处理该数据包时，由于 RDNSS 选项的长度错误，导致内存溢出。
4.  **攻击者利用内存溢出执行任意代码：** 攻击者可以在溢出的内存中写入恶意代码，并控制程序的执行流程，最终实现远程代码执行。

提供的 Zeek 脚本并不能直接利用漏洞，而是用于检测网络流量中是否存在利用此漏洞的攻击行为。 它通过检测 ICMPv6 路由通告消息中的 Recursive_DNS_Server_Option (RDNSS) 是否存在长度异常的情况（长度不为偶数）来进行判断。 如果发现异常，则会产生一个Notice告警。

**项目地址:** [corelight/CVE-2020-16898](https://github.com/corelight/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #9

**来源**: [CVE-2020-16898-esnet-security_cve-2020-16898.md](../2020/CVE-2020-16898-esnet-security_cve-2020-16898.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞 (Bad Neighbor)

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行，系统控制

**影响版本:** Windows 10 版本 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, 版本 1903, 版本 2004

**利用条件:** 攻击者需要与目标系统处于同一网络段，并发送特制的 ICMPv6 路由器通告数据包。

**POC 可用性:** 是，网络上已存在公开的PoC

**投毒风险:** 10%

## 详情

CVE-2020-16898 是一个存在于 Windows TCP/IP 协议栈中的远程代码执行漏洞。当 Windows TCP/IP 协议栈未正确处理 ICMPv6 路由器通告 (Router Advertisement) 数据包时，会导致此漏洞。攻击者可以通过向远程 Windows 计算机发送特制的 ICMPv6 路由器通告数据包来利用此漏洞。

**有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞真实存在，并且有公开可用的 PoC 代码。从搜索结果来看，该漏洞被称为"Bad Neighbor"，影响多个Windows版本，包括Windows 10和Windows Server 2019。

**投毒风险：**
提供的代码片段是Zeek (原 Bro) 网络安全监控平台的包，用于检测 CVE-2020-16898 和 CVE-2020-16899 漏洞的利用。这段代码本身是用于安全检测的，而不是漏洞利用的 PoC 代码。但是，由于攻击者可能修改或替换该Zeek包，以达到隐藏恶意行为或进行进一步攻击的目的，因此存在一定的投毒风险。

风险评估：
- 代码用途：用于检测漏洞，本身不包含漏洞利用代码。
- 代码来源：esnet-security，看似合法的组织，但无法完全排除风险。
- 代码行为：检测 ICMPv6 数据包，并记录相关信息。
- 潜在风险：修改后的 Zeek 包可能绕过检测，或者执行恶意操作。

综合考虑，认为存在10%的投毒风险。

**利用方式：**
1.  **攻击者发送特制的 ICMPv6 路由器通告数据包：** 该数据包包含一个畸形的或超出预期的 RDNSS (Recursive DNS Server) 选项。
2.  **Windows TCP/IP 协议栈处理数据包：**  当 TCP/IP 协议栈解析这个畸形 RDNSS 选项时，由于缺乏适当的边界检查，会发生缓冲区溢出。
3.  **远程代码执行：**  缓冲区溢出允许攻击者覆盖内存，最终导致在目标系统上执行任意代码。
4.  **权限提升：**  由于 TCP/IP 协议栈运行在内核模式，成功利用此漏洞可以获得系统级别的权限。

**项目地址:** [esnet-security/cve-2020-16898](https://github.com/esnet-security/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #10

**来源**: [CVE-2020-16898-initconf_CVE-2020-16898-Bad-Neighbor.md](../2020/CVE-2020-16898-initconf_CVE-2020-16898-Bad-Neighbor.md)

## CVE-2020-16898: Bad Neighbor - Windows TCP/IP远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行或拒绝服务 (DoS)

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要与目标系统处于同一网络或能够发送 ICMPv6 路由通告数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898，又名"Bad Neighbor"，是一个Windows TCP/IP堆栈中的远程代码执行漏洞。该漏洞源于Windows TCP/IP堆栈不正确地处理 ICMPv6 路由器通告数据包。攻击者可以通过发送特制的 ICMPv6 路由器通告数据包到远程Windows计算机来利用此漏洞。成功利用此漏洞的攻击者可以在目标服务器或客户端上执行代码。

根据漏洞信息和搜索结果，该漏洞可以通过发送包含畸形 RDNSS 选项的 ICMPv6 路由器通告数据包来触发。具体来说，当 RDNSS 选项的长度字段为偶数时，会触发漏洞。

提供的 Zeek 脚本实现了对该漏洞的检测。它会检查所有传入的 ICMPv6 流量，查找 ICMPv6 类型字段为 134 (表示路由器通告) 且 ICMPv6 选项字段为 25 (表示递归 DNS 服务器 RDNSS) 的数据包。如果此 RDNSS 选项的长度字段值为偶数，则该脚本会发出警报。

**有效性：**

提供的Zeek脚本并非漏洞利用代码，而是用于检测攻击的签名。其有效性在于检测到潜在的攻击流量，但它本身无法触发漏洞。

**投毒风险：**

该Zeek脚本的目的是检测恶意流量，本身不太可能包含投毒代码。 风险评估为10%。原因包括：
   * Zeek 脚本的主要功能是网络流量分析和检测，用于安全监控。因此，直接嵌入恶意代码的可能性较低。
   * 该脚本相对简单，主要基于对 ICMPv6 报文特定字段的检查，易于人工审查，从而降低了隐藏恶意代码的风险。

**利用方式：**

1.  攻击者需要与目标系统处于同一网络或能够向目标系统发送 ICMPv6 路由通告数据包。
2.  攻击者构造一个包含畸形 RDNSS 选项的 ICMPv6 路由通告数据包。RDNSS 选项的长度字段必须是偶数。
3.  攻击者将构造的数据包发送到目标系统。
4.  如果目标系统未打补丁，则可能导致远程代码执行或者拒绝服务。

**项目地址:** [initconf/CVE-2020-16898-Bad-Neighbor](https://github.com/initconf/CVE-2020-16898-Bad-Neighbor)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #11

**来源**: [CVE-2020-16898-jiansiting_cve-2020-16898.md](../2020/CVE-2020-16898-jiansiting_cve-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709 及以上，未安装相应补丁

**利用条件:** 需要目标系统开启 IPv6 且与攻击者处于同一网络或攻击者可发送 ICMPv6 报文到目标。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞。该漏洞源于 Windows TCP/IP 协议栈在处理 ICMPv6 路由器通告 (Router Advertisement) 报文时，没有正确处理 RDNSS 选项（递归 DNS 服务器）。攻击者可以通过发送特制的 ICMPv6 路由器通告报文，利用 Option Type 25 触发缓冲区溢出，从而导致蓝屏死机 (BSOD) 或者远程代码执行。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断此POC代码是有效的，因为该代码能够触发蓝屏死机（BSOD）。但是否能执行任意代码取决于目标系统的具体配置和缓解措施。

**投毒风险：**
分析提供的 `bsod-poc.py` 脚本，该脚本主要用于发送精心构造的 ICMPv6 报文，以触发目标系统的漏洞。代码主要使用了 `scapy` 库来构建和发送网络报文。代码逻辑相对清晰，没有发现明显的恶意代码或者后门，因此判断投毒风险较低。

**漏洞利用方式：**
1.  攻击者首先需要确定目标系统的 IPv6 地址。
2.  攻击者使用 `scapy` 库构建一个恶意的 ICMPv6 路由器通告报文。
3.  该报文中包含一个畸形的 RDNSS 选项，特别是 Option Type 25。
4.  通过 `fragment6` 函数对报文进行分片，然后将分片后的报文发送到目标系统。
5.  目标系统接收到这些报文后，由于 TCP/IP 协议栈处理 RDNSS 选项时存在漏洞，导致缓冲区溢出。
6.  攻击者可导致目标系统蓝屏死机，可能情况下实现远程代码执行。

**总而言之，提供的POC主要目的是触发BSOD，没有发现植入恶意代码的痕迹，投毒风险为0%。**

**项目地址:** [jiansiting/cve-2020-16898](https://github.com/jiansiting/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #12

**来源**: [CVE-2020-16898-komomon_CVE-2020-16898--EXP-POC.md](../2020/CVE-2020-16898-komomon_CVE-2020-16898--EXP-POC.md)

## CVE-2020-16898 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可导致远程代码执行甚至蓝屏死机（BSOD）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要与目标主机在同一网络中，并知道目标主机的IPv6地址（特别是本地链路地址）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-16898 是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞，当协议栈不正确处理 ICMPv6 路由器通告（Router Advertisement）数据包时，可能触发此漏洞。攻击者可以发送特制的 ICMPv6 路由器通告数据包到目标 Windows 计算机，从而获得在目标服务器或客户端上执行代码的能力。根据搜索结果，成功利用此漏洞可能导致蓝屏死机（BSOD），并可能被用于远程代码执行。漏洞出现在处理Option Type 25的ICMPv6 RA包时。

**漏洞利用方式：**

1.  **发送特制的 ICMPv6 数据包：** 攻击者需要构造包含恶意选项的 ICMPv6 路由器通告数据包。
2.  **利用 RDNSS 选项：** 漏洞利用通常涉及操纵 RDNSS (Recursive DNS Server) 选项，通过修改其长度和内容，来触发栈溢出。
3.  **碎片化处理：** 漏洞利用代码中使用了 IPv6 碎片化，将数据包分成小片段发送，以便绕过某些安全检测机制或更有效地触发漏洞。
4.  **覆盖返回地址：** 成功利用漏洞需要覆盖栈上的返回地址，以便在函数返回时执行攻击者控制的代码。

**有效性评估：**

提供的漏洞利用代码 (CVE-2020-16898-exp1.py 和 CVE-2020-16898.py) 似乎有效，至少可以触发蓝屏死机。根据 README 文件和代码注释，这些代码经过测试，并且需要修改目标 IPv6 地址才能使用。exp1 通过构造包含特定长度和内容的 ICMPv6 路由器通告数据包来利用漏洞，exp2 则是通过发送两个精心构造的 RDNSS 选项，触发栈溢出。

**投毒风险评估：**

虽然提供的代码主要用于触发 BSOD，但如果恶意修改，也可能被用于执行任意代码。仓库中的投毒风险较低，约为5%。主要风险点在于:

*   **payload的植入：** 攻击者可能会修改exp, 在exp的Overwrite部分植入恶意payload,当触发漏洞时,执行攻击者植入的payload.
*   **源地址欺骗：** 虽然exp文件注释显示可以伪造源地址，可能被用于中间人攻击或放大攻击。

总体来说，虽然直接的投毒代码并不明显，但攻击者可能通过修改提供的 PoC 代码来实现恶意目的。因此，在使用这些代码时需要格外小心，并在隔离环境中进行测试。

**项目地址:** [komomon/CVE-2020-16898--EXP-POC](https://github.com/komomon/CVE-2020-16898--EXP-POC)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #13

**来源**: [CVE-2020-16898-komomon_CVE-2020-16898-EXP-POC.md](../2020/CVE-2020-16898-komomon_CVE-2020-16898-EXP-POC.md)

## CVE-2020-16898 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务（蓝屏）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 攻击者需要能够向目标 Windows 计算机发送特制的 ICMPv6 路由器通告数据包，需要知道目标的 IPv6 地址（包括本地链路 IPv6 地址，全球 IPv6 地址，临时 IPv6 地址）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Windows TCP/IP栈中，由于对ICMPv6路由器通告报文处理不当导致。攻击者通过发送特制的ICMPv6报文，利用Option Type 25 触发漏洞。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的PoC已经公开，并且已被证实可以触发蓝屏死机（BSOD），表明漏洞利用是有效的。提供的漏洞利用代码中存在两个exp， exp1可以直接远程代码执行,exp2可以直接导致目标系统崩溃。

**投毒风险：**
检查了提供的PoC代码，未发现明显的恶意代码，但是，考虑到攻击者可能修改代码以进行恶意活动，例如植入后门或执行其他恶意操作，仍然存在一定的风险。

**利用方式：**
1.  攻击者需要确定目标系统的IPv6地址。
2.  攻击者使用PoC代码（例如，`CVE-2020-16898-exp1.py` 或 `CVE-2020-16898.py`），修改目标IP地址为攻击目标的IPv6地址。
3.  攻击者运行PoC代码，发送特制的ICMPv6路由器通告报文到目标系统。
4.  如果目标系统存在漏洞，可能会触发远程代码执行或者导致系统崩溃（BSOD）。

**缓解措施：**
*   及时安装Microsoft发布的补丁。
*   禁用IPv6，如果不需要使用IPv6网络。
*   配置防火墙规则，限制ICMPv6流量。

**项目地址:** [komomon/CVE-2020-16898-EXP-POC](https://github.com/komomon/CVE-2020-16898-EXP-POC)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #14

**来源**: [CVE-2020-16898-momika233_CVE-2020-16898-exp.md](../2020/CVE-2020-16898-momika233_CVE-2020-16898-exp.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞（Bad Neighbor）

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要在与目标系统相同的网络上或能够发送 ICMPv6 路由通告数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-16898 是一个存在于 Windows TCP/IP 协议栈中的远程代码执行漏洞。该漏洞是由于 Windows TCP/IP 协议栈不正确地处理 ICMPv6 路由通告数据包所致。 攻击者可以通过发送特制的 ICMPv6 路由通告数据包到远程 Windows 计算机来利用此漏洞，成功利用此漏洞的攻击者可以在目标服务器或客户端上执行任意代码。 

根据漏洞信息和搜索结果，该漏洞影响多个 Windows 版本，包括 Windows 10 和 Windows Server。该漏洞利用涉及发送特制的 ICMPv6 数据包。PoC 代码使用 Scapy 库构造这些数据包，并发送给目标。PoC代码通过填充 `ICMPv6NDOptRDNSS` 选项的 `dns` 字段来触发漏洞。根据搜索结果和漏洞描述，该漏洞有可能导致远程代码执行或者拒绝服务（BSOD）。

**有效性：**
根据漏洞信息，该漏洞的 PoC 是可用的，提供的代码可以触发蓝屏死机（BSOD），表明 PoC 具有一定的有效性。

**投毒风险：**
该 PoC 代码主要使用 Scapy 库构造和发送 ICMPv6 数据包，未发现明显的恶意代码或后门。但是，所有来源不明的代码都存在一定的风险，建议在隔离环境中运行。
仔细审查代码，发现其逻辑主要是构造畸形的ICMPv6数据包以触发TCP/IP协议栈中的漏洞，目的是导致BSOD。其中最可疑的地方是大量的"AAAA:AAAA:AAAA:AAAA:AAAA:AAAA:AAAA:AAAA"字符串。这部分代码是在利用漏洞，而非添加恶意代码。因此，判定投毒风险较低，估计在5%左右，主要是考虑作者可能会植入一些不易察觉的payload。

**利用方式：**
1.  攻击者需要位于与目标系统相同的网络或者能够向目标系统发送 IPv6 数据包。
2.  攻击者利用 Scapy 等工具构造恶意的 ICMPv6 路由通告 (RA) 数据包，特别是 `ICMPv6NDOptRDNSS` 选项。
3.  构造的 ICMPv6 RA 数据包被发送到目标 Windows 系统。
4.  Windows TCP/IP 协议栈处理畸形的 ICMPv6 RA 数据包时，触发漏洞，可能导致远程代码执行或拒绝服务攻击（BSOD）。

**项目地址:** [momika233/CVE-2020-16898-exp](https://github.com/momika233/CVE-2020-16898-exp)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---



---

## POC #8

**来源**: [CVE-2020-16898-corelight_CVE-2020-16898.md](../2020/CVE-2020-16898-corelight_CVE-2020-16898.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞（Bad Neighbor）

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行，完全控制受影响系统

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, Windows Server version 2004 等多个版本受影响

**利用条件:** 攻击者需要与目标主机处于同一网络邻域，或者能够发送伪造的 ICMPv6 路由通告数据包到目标主机

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Windows TCP/IP 协议栈中，当其处理 ICMPv6 路由通告数据包时，未能正确解析其中的 RDNSS 选项（Option Type 25），导致内存损坏，进而允许攻击者执行任意代码。攻击者通过发送特制的 ICMPv6 路由通告数据包来触发此漏洞。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞是一个真实存在的远程代码执行漏洞，并且已经有公开的PoC代码。提供的Zeek脚本是一个网络检测包，用于检测利用此漏洞的恶意流量。它通过分析 ICMPv6 路由通告数据包，特别是检查 RDNSS 选项的长度是否为偶数来判断是否存在攻击。

**投毒风险分析：**

提供的PoC代码（Zeek脚本）主要用于检测攻击，而不是利用攻击。仔细检查提供的文件，包括`LICENSE`, `README.md`, `bro-pkg.meta`, `zkg.meta`, `scripts/CVE-2020-16898.zeek`, 和 `scripts/__load__.zeek`，没有发现明显的恶意代码或后门。代码逻辑清晰，主要是检测 ICMPv6 路由通告消息中 RDNSS 选项的长度是否合法。脚本通过生成 Notice 日志来告知管理员存在潜在的攻击行为。投毒的风险较低，但仍存在微小可能性，例如利用 Zeek 脚本的复杂性进行隐藏，或者利用 Zeek 本身的漏洞执行恶意操作。因此，保守估计投毒风险为5%。

**利用方式分析：**

1.  **攻击者构造恶意的 ICMPv6 路由通告数据包：** 数据包中包含一个格式错误的 RDNSS 选项（Option Type 25），其长度为非偶数。
2.  **攻击者将恶意数据包发送给目标 Windows 主机：** 可以通过本地网络发送，也可以通过中间人攻击等方式。
3.  **目标主机处理恶意数据包：** Windows TCP/IP 协议栈在处理该数据包时，由于 RDNSS 选项的长度错误，导致内存溢出。
4.  **攻击者利用内存溢出执行任意代码：** 攻击者可以在溢出的内存中写入恶意代码，并控制程序的执行流程，最终实现远程代码执行。

提供的 Zeek 脚本并不能直接利用漏洞，而是用于检测网络流量中是否存在利用此漏洞的攻击行为。 它通过检测 ICMPv6 路由通告消息中的 Recursive_DNS_Server_Option (RDNSS) 是否存在长度异常的情况（长度不为偶数）来进行判断。 如果发现异常，则会产生一个Notice告警。

**项目地址:** [corelight/CVE-2020-16898](https://github.com/corelight/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #9

**来源**: [CVE-2020-16898-esnet-security_cve-2020-16898.md](../2020/CVE-2020-16898-esnet-security_cve-2020-16898.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞 (Bad Neighbor)

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行，系统控制

**影响版本:** Windows 10 版本 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, 版本 1903, 版本 2004

**利用条件:** 攻击者需要与目标系统处于同一网络段，并发送特制的 ICMPv6 路由器通告数据包。

**POC 可用性:** 是，网络上已存在公开的PoC

**投毒风险:** 10%

## 详情

CVE-2020-16898 是一个存在于 Windows TCP/IP 协议栈中的远程代码执行漏洞。当 Windows TCP/IP 协议栈未正确处理 ICMPv6 路由器通告 (Router Advertisement) 数据包时，会导致此漏洞。攻击者可以通过向远程 Windows 计算机发送特制的 ICMPv6 路由器通告数据包来利用此漏洞。

**有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞真实存在，并且有公开可用的 PoC 代码。从搜索结果来看，该漏洞被称为"Bad Neighbor"，影响多个Windows版本，包括Windows 10和Windows Server 2019。

**投毒风险：**
提供的代码片段是Zeek (原 Bro) 网络安全监控平台的包，用于检测 CVE-2020-16898 和 CVE-2020-16899 漏洞的利用。这段代码本身是用于安全检测的，而不是漏洞利用的 PoC 代码。但是，由于攻击者可能修改或替换该Zeek包，以达到隐藏恶意行为或进行进一步攻击的目的，因此存在一定的投毒风险。

风险评估：
- 代码用途：用于检测漏洞，本身不包含漏洞利用代码。
- 代码来源：esnet-security，看似合法的组织，但无法完全排除风险。
- 代码行为：检测 ICMPv6 数据包，并记录相关信息。
- 潜在风险：修改后的 Zeek 包可能绕过检测，或者执行恶意操作。

综合考虑，认为存在10%的投毒风险。

**利用方式：**
1.  **攻击者发送特制的 ICMPv6 路由器通告数据包：** 该数据包包含一个畸形的或超出预期的 RDNSS (Recursive DNS Server) 选项。
2.  **Windows TCP/IP 协议栈处理数据包：**  当 TCP/IP 协议栈解析这个畸形 RDNSS 选项时，由于缺乏适当的边界检查，会发生缓冲区溢出。
3.  **远程代码执行：**  缓冲区溢出允许攻击者覆盖内存，最终导致在目标系统上执行任意代码。
4.  **权限提升：**  由于 TCP/IP 协议栈运行在内核模式，成功利用此漏洞可以获得系统级别的权限。

**项目地址:** [esnet-security/cve-2020-16898](https://github.com/esnet-security/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #10

**来源**: [CVE-2020-16898-initconf_CVE-2020-16898-Bad-Neighbor.md](../2020/CVE-2020-16898-initconf_CVE-2020-16898-Bad-Neighbor.md)

## CVE-2020-16898: Bad Neighbor - Windows TCP/IP远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行或拒绝服务 (DoS)

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要与目标系统处于同一网络或能够发送 ICMPv6 路由通告数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898，又名"Bad Neighbor"，是一个Windows TCP/IP堆栈中的远程代码执行漏洞。该漏洞源于Windows TCP/IP堆栈不正确地处理 ICMPv6 路由器通告数据包。攻击者可以通过发送特制的 ICMPv6 路由器通告数据包到远程Windows计算机来利用此漏洞。成功利用此漏洞的攻击者可以在目标服务器或客户端上执行代码。

根据漏洞信息和搜索结果，该漏洞可以通过发送包含畸形 RDNSS 选项的 ICMPv6 路由器通告数据包来触发。具体来说，当 RDNSS 选项的长度字段为偶数时，会触发漏洞。

提供的 Zeek 脚本实现了对该漏洞的检测。它会检查所有传入的 ICMPv6 流量，查找 ICMPv6 类型字段为 134 (表示路由器通告) 且 ICMPv6 选项字段为 25 (表示递归 DNS 服务器 RDNSS) 的数据包。如果此 RDNSS 选项的长度字段值为偶数，则该脚本会发出警报。

**有效性：**

提供的Zeek脚本并非漏洞利用代码，而是用于检测攻击的签名。其有效性在于检测到潜在的攻击流量，但它本身无法触发漏洞。

**投毒风险：**

该Zeek脚本的目的是检测恶意流量，本身不太可能包含投毒代码。 风险评估为10%。原因包括：
   * Zeek 脚本的主要功能是网络流量分析和检测，用于安全监控。因此，直接嵌入恶意代码的可能性较低。
   * 该脚本相对简单，主要基于对 ICMPv6 报文特定字段的检查，易于人工审查，从而降低了隐藏恶意代码的风险。

**利用方式：**

1.  攻击者需要与目标系统处于同一网络或能够向目标系统发送 ICMPv6 路由通告数据包。
2.  攻击者构造一个包含畸形 RDNSS 选项的 ICMPv6 路由通告数据包。RDNSS 选项的长度字段必须是偶数。
3.  攻击者将构造的数据包发送到目标系统。
4.  如果目标系统未打补丁，则可能导致远程代码执行或者拒绝服务。

**项目地址:** [initconf/CVE-2020-16898-Bad-Neighbor](https://github.com/initconf/CVE-2020-16898-Bad-Neighbor)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #11

**来源**: [CVE-2020-16898-jiansiting_cve-2020-16898.md](../2020/CVE-2020-16898-jiansiting_cve-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709 及以上，未安装相应补丁

**利用条件:** 需要目标系统开启 IPv6 且与攻击者处于同一网络或攻击者可发送 ICMPv6 报文到目标。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞。该漏洞源于 Windows TCP/IP 协议栈在处理 ICMPv6 路由器通告 (Router Advertisement) 报文时，没有正确处理 RDNSS 选项（递归 DNS 服务器）。攻击者可以通过发送特制的 ICMPv6 路由器通告报文，利用 Option Type 25 触发缓冲区溢出，从而导致蓝屏死机 (BSOD) 或者远程代码执行。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断此POC代码是有效的，因为该代码能够触发蓝屏死机（BSOD）。但是否能执行任意代码取决于目标系统的具体配置和缓解措施。

**投毒风险：**
分析提供的 `bsod-poc.py` 脚本，该脚本主要用于发送精心构造的 ICMPv6 报文，以触发目标系统的漏洞。代码主要使用了 `scapy` 库来构建和发送网络报文。代码逻辑相对清晰，没有发现明显的恶意代码或者后门，因此判断投毒风险较低。

**漏洞利用方式：**
1.  攻击者首先需要确定目标系统的 IPv6 地址。
2.  攻击者使用 `scapy` 库构建一个恶意的 ICMPv6 路由器通告报文。
3.  该报文中包含一个畸形的 RDNSS 选项，特别是 Option Type 25。
4.  通过 `fragment6` 函数对报文进行分片，然后将分片后的报文发送到目标系统。
5.  目标系统接收到这些报文后，由于 TCP/IP 协议栈处理 RDNSS 选项时存在漏洞，导致缓冲区溢出。
6.  攻击者可导致目标系统蓝屏死机，可能情况下实现远程代码执行。

**总而言之，提供的POC主要目的是触发BSOD，没有发现植入恶意代码的痕迹，投毒风险为0%。**

**项目地址:** [jiansiting/cve-2020-16898](https://github.com/jiansiting/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #12

**来源**: [CVE-2020-16898-komomon_CVE-2020-16898--EXP-POC.md](../2020/CVE-2020-16898-komomon_CVE-2020-16898--EXP-POC.md)

## CVE-2020-16898 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可导致远程代码执行甚至蓝屏死机（BSOD）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要与目标主机在同一网络中，并知道目标主机的IPv6地址（特别是本地链路地址）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-16898 是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞，当协议栈不正确处理 ICMPv6 路由器通告（Router Advertisement）数据包时，可能触发此漏洞。攻击者可以发送特制的 ICMPv6 路由器通告数据包到目标 Windows 计算机，从而获得在目标服务器或客户端上执行代码的能力。根据搜索结果，成功利用此漏洞可能导致蓝屏死机（BSOD），并可能被用于远程代码执行。漏洞出现在处理Option Type 25的ICMPv6 RA包时。

**漏洞利用方式：**

1.  **发送特制的 ICMPv6 数据包：** 攻击者需要构造包含恶意选项的 ICMPv6 路由器通告数据包。
2.  **利用 RDNSS 选项：** 漏洞利用通常涉及操纵 RDNSS (Recursive DNS Server) 选项，通过修改其长度和内容，来触发栈溢出。
3.  **碎片化处理：** 漏洞利用代码中使用了 IPv6 碎片化，将数据包分成小片段发送，以便绕过某些安全检测机制或更有效地触发漏洞。
4.  **覆盖返回地址：** 成功利用漏洞需要覆盖栈上的返回地址，以便在函数返回时执行攻击者控制的代码。

**有效性评估：**

提供的漏洞利用代码 (CVE-2020-16898-exp1.py 和 CVE-2020-16898.py) 似乎有效，至少可以触发蓝屏死机。根据 README 文件和代码注释，这些代码经过测试，并且需要修改目标 IPv6 地址才能使用。exp1 通过构造包含特定长度和内容的 ICMPv6 路由器通告数据包来利用漏洞，exp2 则是通过发送两个精心构造的 RDNSS 选项，触发栈溢出。

**投毒风险评估：**

虽然提供的代码主要用于触发 BSOD，但如果恶意修改，也可能被用于执行任意代码。仓库中的投毒风险较低，约为5%。主要风险点在于:

*   **payload的植入：** 攻击者可能会修改exp, 在exp的Overwrite部分植入恶意payload,当触发漏洞时,执行攻击者植入的payload.
*   **源地址欺骗：** 虽然exp文件注释显示可以伪造源地址，可能被用于中间人攻击或放大攻击。

总体来说，虽然直接的投毒代码并不明显，但攻击者可能通过修改提供的 PoC 代码来实现恶意目的。因此，在使用这些代码时需要格外小心，并在隔离环境中进行测试。

**项目地址:** [komomon/CVE-2020-16898--EXP-POC](https://github.com/komomon/CVE-2020-16898--EXP-POC)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #13

**来源**: [CVE-2020-16898-komomon_CVE-2020-16898-EXP-POC.md](../2020/CVE-2020-16898-komomon_CVE-2020-16898-EXP-POC.md)

## CVE-2020-16898 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务（蓝屏）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 攻击者需要能够向目标 Windows 计算机发送特制的 ICMPv6 路由器通告数据包，需要知道目标的 IPv6 地址（包括本地链路 IPv6 地址，全球 IPv6 地址，临时 IPv6 地址）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Windows TCP/IP栈中，由于对ICMPv6路由器通告报文处理不当导致。攻击者通过发送特制的ICMPv6报文，利用Option Type 25 触发漏洞。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的PoC已经公开，并且已被证实可以触发蓝屏死机（BSOD），表明漏洞利用是有效的。提供的漏洞利用代码中存在两个exp， exp1可以直接远程代码执行,exp2可以直接导致目标系统崩溃。

**投毒风险：**
检查了提供的PoC代码，未发现明显的恶意代码，但是，考虑到攻击者可能修改代码以进行恶意活动，例如植入后门或执行其他恶意操作，仍然存在一定的风险。

**利用方式：**
1.  攻击者需要确定目标系统的IPv6地址。
2.  攻击者使用PoC代码（例如，`CVE-2020-16898-exp1.py` 或 `CVE-2020-16898.py`），修改目标IP地址为攻击目标的IPv6地址。
3.  攻击者运行PoC代码，发送特制的ICMPv6路由器通告报文到目标系统。
4.  如果目标系统存在漏洞，可能会触发远程代码执行或者导致系统崩溃（BSOD）。

**缓解措施：**
*   及时安装Microsoft发布的补丁。
*   禁用IPv6，如果不需要使用IPv6网络。
*   配置防火墙规则，限制ICMPv6流量。

**项目地址:** [komomon/CVE-2020-16898-EXP-POC](https://github.com/komomon/CVE-2020-16898-EXP-POC)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #14

**来源**: [CVE-2020-16898-momika233_CVE-2020-16898-exp.md](../2020/CVE-2020-16898-momika233_CVE-2020-16898-exp.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞（Bad Neighbor）

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要在与目标系统相同的网络上或能够发送 ICMPv6 路由通告数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-16898 是一个存在于 Windows TCP/IP 协议栈中的远程代码执行漏洞。该漏洞是由于 Windows TCP/IP 协议栈不正确地处理 ICMPv6 路由通告数据包所致。 攻击者可以通过发送特制的 ICMPv6 路由通告数据包到远程 Windows 计算机来利用此漏洞，成功利用此漏洞的攻击者可以在目标服务器或客户端上执行任意代码。 

根据漏洞信息和搜索结果，该漏洞影响多个 Windows 版本，包括 Windows 10 和 Windows Server。该漏洞利用涉及发送特制的 ICMPv6 数据包。PoC 代码使用 Scapy 库构造这些数据包，并发送给目标。PoC代码通过填充 `ICMPv6NDOptRDNSS` 选项的 `dns` 字段来触发漏洞。根据搜索结果和漏洞描述，该漏洞有可能导致远程代码执行或者拒绝服务（BSOD）。

**有效性：**
根据漏洞信息，该漏洞的 PoC 是可用的，提供的代码可以触发蓝屏死机（BSOD），表明 PoC 具有一定的有效性。

**投毒风险：**
该 PoC 代码主要使用 Scapy 库构造和发送 ICMPv6 数据包，未发现明显的恶意代码或后门。但是，所有来源不明的代码都存在一定的风险，建议在隔离环境中运行。
仔细审查代码，发现其逻辑主要是构造畸形的ICMPv6数据包以触发TCP/IP协议栈中的漏洞，目的是导致BSOD。其中最可疑的地方是大量的"AAAA:AAAA:AAAA:AAAA:AAAA:AAAA:AAAA:AAAA"字符串。这部分代码是在利用漏洞，而非添加恶意代码。因此，判定投毒风险较低，估计在5%左右，主要是考虑作者可能会植入一些不易察觉的payload。

**利用方式：**
1.  攻击者需要位于与目标系统相同的网络或者能够向目标系统发送 IPv6 数据包。
2.  攻击者利用 Scapy 等工具构造恶意的 ICMPv6 路由通告 (RA) 数据包，特别是 `ICMPv6NDOptRDNSS` 选项。
3.  构造的 ICMPv6 RA 数据包被发送到目标 Windows 系统。
4.  Windows TCP/IP 协议栈处理畸形的 ICMPv6 RA 数据包时，触发漏洞，可能导致远程代码执行或拒绝服务攻击（BSOD）。

**项目地址:** [momika233/CVE-2020-16898-exp](https://github.com/momika233/CVE-2020-16898-exp)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---



---

## POC #8

**来源**: [CVE-2020-16898-corelight_CVE-2020-16898.md](../2020/CVE-2020-16898-corelight_CVE-2020-16898.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞（Bad Neighbor）

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行，完全控制受影响系统

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, Windows Server version 2004 等多个版本受影响

**利用条件:** 攻击者需要与目标主机处于同一网络邻域，或者能够发送伪造的 ICMPv6 路由通告数据包到目标主机

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Windows TCP/IP 协议栈中，当其处理 ICMPv6 路由通告数据包时，未能正确解析其中的 RDNSS 选项（Option Type 25），导致内存损坏，进而允许攻击者执行任意代码。攻击者通过发送特制的 ICMPv6 路由通告数据包来触发此漏洞。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞是一个真实存在的远程代码执行漏洞，并且已经有公开的PoC代码。提供的Zeek脚本是一个网络检测包，用于检测利用此漏洞的恶意流量。它通过分析 ICMPv6 路由通告数据包，特别是检查 RDNSS 选项的长度是否为偶数来判断是否存在攻击。

**投毒风险分析：**

提供的PoC代码（Zeek脚本）主要用于检测攻击，而不是利用攻击。仔细检查提供的文件，包括`LICENSE`, `README.md`, `bro-pkg.meta`, `zkg.meta`, `scripts/CVE-2020-16898.zeek`, 和 `scripts/__load__.zeek`，没有发现明显的恶意代码或后门。代码逻辑清晰，主要是检测 ICMPv6 路由通告消息中 RDNSS 选项的长度是否合法。脚本通过生成 Notice 日志来告知管理员存在潜在的攻击行为。投毒的风险较低，但仍存在微小可能性，例如利用 Zeek 脚本的复杂性进行隐藏，或者利用 Zeek 本身的漏洞执行恶意操作。因此，保守估计投毒风险为5%。

**利用方式分析：**

1.  **攻击者构造恶意的 ICMPv6 路由通告数据包：** 数据包中包含一个格式错误的 RDNSS 选项（Option Type 25），其长度为非偶数。
2.  **攻击者将恶意数据包发送给目标 Windows 主机：** 可以通过本地网络发送，也可以通过中间人攻击等方式。
3.  **目标主机处理恶意数据包：** Windows TCP/IP 协议栈在处理该数据包时，由于 RDNSS 选项的长度错误，导致内存溢出。
4.  **攻击者利用内存溢出执行任意代码：** 攻击者可以在溢出的内存中写入恶意代码，并控制程序的执行流程，最终实现远程代码执行。

提供的 Zeek 脚本并不能直接利用漏洞，而是用于检测网络流量中是否存在利用此漏洞的攻击行为。 它通过检测 ICMPv6 路由通告消息中的 Recursive_DNS_Server_Option (RDNSS) 是否存在长度异常的情况（长度不为偶数）来进行判断。 如果发现异常，则会产生一个Notice告警。

**项目地址:** [corelight/CVE-2020-16898](https://github.com/corelight/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #9

**来源**: [CVE-2020-16898-esnet-security_cve-2020-16898.md](../2020/CVE-2020-16898-esnet-security_cve-2020-16898.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞 (Bad Neighbor)

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行，系统控制

**影响版本:** Windows 10 版本 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, 版本 1903, 版本 2004

**利用条件:** 攻击者需要与目标系统处于同一网络段，并发送特制的 ICMPv6 路由器通告数据包。

**POC 可用性:** 是，网络上已存在公开的PoC

**投毒风险:** 10%

## 详情

CVE-2020-16898 是一个存在于 Windows TCP/IP 协议栈中的远程代码执行漏洞。当 Windows TCP/IP 协议栈未正确处理 ICMPv6 路由器通告 (Router Advertisement) 数据包时，会导致此漏洞。攻击者可以通过向远程 Windows 计算机发送特制的 ICMPv6 路由器通告数据包来利用此漏洞。

**有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞真实存在，并且有公开可用的 PoC 代码。从搜索结果来看，该漏洞被称为"Bad Neighbor"，影响多个Windows版本，包括Windows 10和Windows Server 2019。

**投毒风险：**
提供的代码片段是Zeek (原 Bro) 网络安全监控平台的包，用于检测 CVE-2020-16898 和 CVE-2020-16899 漏洞的利用。这段代码本身是用于安全检测的，而不是漏洞利用的 PoC 代码。但是，由于攻击者可能修改或替换该Zeek包，以达到隐藏恶意行为或进行进一步攻击的目的，因此存在一定的投毒风险。

风险评估：
- 代码用途：用于检测漏洞，本身不包含漏洞利用代码。
- 代码来源：esnet-security，看似合法的组织，但无法完全排除风险。
- 代码行为：检测 ICMPv6 数据包，并记录相关信息。
- 潜在风险：修改后的 Zeek 包可能绕过检测，或者执行恶意操作。

综合考虑，认为存在10%的投毒风险。

**利用方式：**
1.  **攻击者发送特制的 ICMPv6 路由器通告数据包：** 该数据包包含一个畸形的或超出预期的 RDNSS (Recursive DNS Server) 选项。
2.  **Windows TCP/IP 协议栈处理数据包：**  当 TCP/IP 协议栈解析这个畸形 RDNSS 选项时，由于缺乏适当的边界检查，会发生缓冲区溢出。
3.  **远程代码执行：**  缓冲区溢出允许攻击者覆盖内存，最终导致在目标系统上执行任意代码。
4.  **权限提升：**  由于 TCP/IP 协议栈运行在内核模式，成功利用此漏洞可以获得系统级别的权限。

**项目地址:** [esnet-security/cve-2020-16898](https://github.com/esnet-security/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #10

**来源**: [CVE-2020-16898-initconf_CVE-2020-16898-Bad-Neighbor.md](../2020/CVE-2020-16898-initconf_CVE-2020-16898-Bad-Neighbor.md)

## CVE-2020-16898: Bad Neighbor - Windows TCP/IP远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行或拒绝服务 (DoS)

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要与目标系统处于同一网络或能够发送 ICMPv6 路由通告数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898，又名"Bad Neighbor"，是一个Windows TCP/IP堆栈中的远程代码执行漏洞。该漏洞源于Windows TCP/IP堆栈不正确地处理 ICMPv6 路由器通告数据包。攻击者可以通过发送特制的 ICMPv6 路由器通告数据包到远程Windows计算机来利用此漏洞。成功利用此漏洞的攻击者可以在目标服务器或客户端上执行代码。

根据漏洞信息和搜索结果，该漏洞可以通过发送包含畸形 RDNSS 选项的 ICMPv6 路由器通告数据包来触发。具体来说，当 RDNSS 选项的长度字段为偶数时，会触发漏洞。

提供的 Zeek 脚本实现了对该漏洞的检测。它会检查所有传入的 ICMPv6 流量，查找 ICMPv6 类型字段为 134 (表示路由器通告) 且 ICMPv6 选项字段为 25 (表示递归 DNS 服务器 RDNSS) 的数据包。如果此 RDNSS 选项的长度字段值为偶数，则该脚本会发出警报。

**有效性：**

提供的Zeek脚本并非漏洞利用代码，而是用于检测攻击的签名。其有效性在于检测到潜在的攻击流量，但它本身无法触发漏洞。

**投毒风险：**

该Zeek脚本的目的是检测恶意流量，本身不太可能包含投毒代码。 风险评估为10%。原因包括：
   * Zeek 脚本的主要功能是网络流量分析和检测，用于安全监控。因此，直接嵌入恶意代码的可能性较低。
   * 该脚本相对简单，主要基于对 ICMPv6 报文特定字段的检查，易于人工审查，从而降低了隐藏恶意代码的风险。

**利用方式：**

1.  攻击者需要与目标系统处于同一网络或能够向目标系统发送 ICMPv6 路由通告数据包。
2.  攻击者构造一个包含畸形 RDNSS 选项的 ICMPv6 路由通告数据包。RDNSS 选项的长度字段必须是偶数。
3.  攻击者将构造的数据包发送到目标系统。
4.  如果目标系统未打补丁，则可能导致远程代码执行或者拒绝服务。

**项目地址:** [initconf/CVE-2020-16898-Bad-Neighbor](https://github.com/initconf/CVE-2020-16898-Bad-Neighbor)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #11

**来源**: [CVE-2020-16898-jiansiting_cve-2020-16898.md](../2020/CVE-2020-16898-jiansiting_cve-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709 及以上，未安装相应补丁

**利用条件:** 需要目标系统开启 IPv6 且与攻击者处于同一网络或攻击者可发送 ICMPv6 报文到目标。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞。该漏洞源于 Windows TCP/IP 协议栈在处理 ICMPv6 路由器通告 (Router Advertisement) 报文时，没有正确处理 RDNSS 选项（递归 DNS 服务器）。攻击者可以通过发送特制的 ICMPv6 路由器通告报文，利用 Option Type 25 触发缓冲区溢出，从而导致蓝屏死机 (BSOD) 或者远程代码执行。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断此POC代码是有效的，因为该代码能够触发蓝屏死机（BSOD）。但是否能执行任意代码取决于目标系统的具体配置和缓解措施。

**投毒风险：**
分析提供的 `bsod-poc.py` 脚本，该脚本主要用于发送精心构造的 ICMPv6 报文，以触发目标系统的漏洞。代码主要使用了 `scapy` 库来构建和发送网络报文。代码逻辑相对清晰，没有发现明显的恶意代码或者后门，因此判断投毒风险较低。

**漏洞利用方式：**
1.  攻击者首先需要确定目标系统的 IPv6 地址。
2.  攻击者使用 `scapy` 库构建一个恶意的 ICMPv6 路由器通告报文。
3.  该报文中包含一个畸形的 RDNSS 选项，特别是 Option Type 25。
4.  通过 `fragment6` 函数对报文进行分片，然后将分片后的报文发送到目标系统。
5.  目标系统接收到这些报文后，由于 TCP/IP 协议栈处理 RDNSS 选项时存在漏洞，导致缓冲区溢出。
6.  攻击者可导致目标系统蓝屏死机，可能情况下实现远程代码执行。

**总而言之，提供的POC主要目的是触发BSOD，没有发现植入恶意代码的痕迹，投毒风险为0%。**

**项目地址:** [jiansiting/cve-2020-16898](https://github.com/jiansiting/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #12

**来源**: [CVE-2020-16898-komomon_CVE-2020-16898--EXP-POC.md](../2020/CVE-2020-16898-komomon_CVE-2020-16898--EXP-POC.md)

## CVE-2020-16898 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可导致远程代码执行甚至蓝屏死机（BSOD）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要与目标主机在同一网络中，并知道目标主机的IPv6地址（特别是本地链路地址）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-16898 是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞，当协议栈不正确处理 ICMPv6 路由器通告（Router Advertisement）数据包时，可能触发此漏洞。攻击者可以发送特制的 ICMPv6 路由器通告数据包到目标 Windows 计算机，从而获得在目标服务器或客户端上执行代码的能力。根据搜索结果，成功利用此漏洞可能导致蓝屏死机（BSOD），并可能被用于远程代码执行。漏洞出现在处理Option Type 25的ICMPv6 RA包时。

**漏洞利用方式：**

1.  **发送特制的 ICMPv6 数据包：** 攻击者需要构造包含恶意选项的 ICMPv6 路由器通告数据包。
2.  **利用 RDNSS 选项：** 漏洞利用通常涉及操纵 RDNSS (Recursive DNS Server) 选项，通过修改其长度和内容，来触发栈溢出。
3.  **碎片化处理：** 漏洞利用代码中使用了 IPv6 碎片化，将数据包分成小片段发送，以便绕过某些安全检测机制或更有效地触发漏洞。
4.  **覆盖返回地址：** 成功利用漏洞需要覆盖栈上的返回地址，以便在函数返回时执行攻击者控制的代码。

**有效性评估：**

提供的漏洞利用代码 (CVE-2020-16898-exp1.py 和 CVE-2020-16898.py) 似乎有效，至少可以触发蓝屏死机。根据 README 文件和代码注释，这些代码经过测试，并且需要修改目标 IPv6 地址才能使用。exp1 通过构造包含特定长度和内容的 ICMPv6 路由器通告数据包来利用漏洞，exp2 则是通过发送两个精心构造的 RDNSS 选项，触发栈溢出。

**投毒风险评估：**

虽然提供的代码主要用于触发 BSOD，但如果恶意修改，也可能被用于执行任意代码。仓库中的投毒风险较低，约为5%。主要风险点在于:

*   **payload的植入：** 攻击者可能会修改exp, 在exp的Overwrite部分植入恶意payload,当触发漏洞时,执行攻击者植入的payload.
*   **源地址欺骗：** 虽然exp文件注释显示可以伪造源地址，可能被用于中间人攻击或放大攻击。

总体来说，虽然直接的投毒代码并不明显，但攻击者可能通过修改提供的 PoC 代码来实现恶意目的。因此，在使用这些代码时需要格外小心，并在隔离环境中进行测试。

**项目地址:** [komomon/CVE-2020-16898--EXP-POC](https://github.com/komomon/CVE-2020-16898--EXP-POC)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #13

**来源**: [CVE-2020-16898-komomon_CVE-2020-16898-EXP-POC.md](../2020/CVE-2020-16898-komomon_CVE-2020-16898-EXP-POC.md)

## CVE-2020-16898 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务（蓝屏）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 攻击者需要能够向目标 Windows 计算机发送特制的 ICMPv6 路由器通告数据包，需要知道目标的 IPv6 地址（包括本地链路 IPv6 地址，全球 IPv6 地址，临时 IPv6 地址）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Windows TCP/IP栈中，由于对ICMPv6路由器通告报文处理不当导致。攻击者通过发送特制的ICMPv6报文，利用Option Type 25 触发漏洞。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的PoC已经公开，并且已被证实可以触发蓝屏死机（BSOD），表明漏洞利用是有效的。提供的漏洞利用代码中存在两个exp， exp1可以直接远程代码执行,exp2可以直接导致目标系统崩溃。

**投毒风险：**
检查了提供的PoC代码，未发现明显的恶意代码，但是，考虑到攻击者可能修改代码以进行恶意活动，例如植入后门或执行其他恶意操作，仍然存在一定的风险。

**利用方式：**
1.  攻击者需要确定目标系统的IPv6地址。
2.  攻击者使用PoC代码（例如，`CVE-2020-16898-exp1.py` 或 `CVE-2020-16898.py`），修改目标IP地址为攻击目标的IPv6地址。
3.  攻击者运行PoC代码，发送特制的ICMPv6路由器通告报文到目标系统。
4.  如果目标系统存在漏洞，可能会触发远程代码执行或者导致系统崩溃（BSOD）。

**缓解措施：**
*   及时安装Microsoft发布的补丁。
*   禁用IPv6，如果不需要使用IPv6网络。
*   配置防火墙规则，限制ICMPv6流量。

**项目地址:** [komomon/CVE-2020-16898-EXP-POC](https://github.com/komomon/CVE-2020-16898-EXP-POC)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #14

**来源**: [CVE-2020-16898-momika233_CVE-2020-16898-exp.md](../2020/CVE-2020-16898-momika233_CVE-2020-16898-exp.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞（Bad Neighbor）

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要在与目标系统相同的网络上或能够发送 ICMPv6 路由通告数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-16898 是一个存在于 Windows TCP/IP 协议栈中的远程代码执行漏洞。该漏洞是由于 Windows TCP/IP 协议栈不正确地处理 ICMPv6 路由通告数据包所致。 攻击者可以通过发送特制的 ICMPv6 路由通告数据包到远程 Windows 计算机来利用此漏洞，成功利用此漏洞的攻击者可以在目标服务器或客户端上执行任意代码。 

根据漏洞信息和搜索结果，该漏洞影响多个 Windows 版本，包括 Windows 10 和 Windows Server。该漏洞利用涉及发送特制的 ICMPv6 数据包。PoC 代码使用 Scapy 库构造这些数据包，并发送给目标。PoC代码通过填充 `ICMPv6NDOptRDNSS` 选项的 `dns` 字段来触发漏洞。根据搜索结果和漏洞描述，该漏洞有可能导致远程代码执行或者拒绝服务（BSOD）。

**有效性：**
根据漏洞信息，该漏洞的 PoC 是可用的，提供的代码可以触发蓝屏死机（BSOD），表明 PoC 具有一定的有效性。

**投毒风险：**
该 PoC 代码主要使用 Scapy 库构造和发送 ICMPv6 数据包，未发现明显的恶意代码或后门。但是，所有来源不明的代码都存在一定的风险，建议在隔离环境中运行。
仔细审查代码，发现其逻辑主要是构造畸形的ICMPv6数据包以触发TCP/IP协议栈中的漏洞，目的是导致BSOD。其中最可疑的地方是大量的"AAAA:AAAA:AAAA:AAAA:AAAA:AAAA:AAAA:AAAA"字符串。这部分代码是在利用漏洞，而非添加恶意代码。因此，判定投毒风险较低，估计在5%左右，主要是考虑作者可能会植入一些不易察觉的payload。

**利用方式：**
1.  攻击者需要位于与目标系统相同的网络或者能够向目标系统发送 IPv6 数据包。
2.  攻击者利用 Scapy 等工具构造恶意的 ICMPv6 路由通告 (RA) 数据包，特别是 `ICMPv6NDOptRDNSS` 选项。
3.  构造的 ICMPv6 RA 数据包被发送到目标 Windows 系统。
4.  Windows TCP/IP 协议栈处理畸形的 ICMPv6 RA 数据包时，触发漏洞，可能导致远程代码执行或拒绝服务攻击（BSOD）。

**项目地址:** [momika233/CVE-2020-16898-exp](https://github.com/momika233/CVE-2020-16898-exp)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---



---

## POC #8

**来源**: [CVE-2020-16898-corelight_CVE-2020-16898.md](../2020/CVE-2020-16898-corelight_CVE-2020-16898.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞（Bad Neighbor）

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行，完全控制受影响系统

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, Windows Server version 2004 等多个版本受影响

**利用条件:** 攻击者需要与目标主机处于同一网络邻域，或者能够发送伪造的 ICMPv6 路由通告数据包到目标主机

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Windows TCP/IP 协议栈中，当其处理 ICMPv6 路由通告数据包时，未能正确解析其中的 RDNSS 选项（Option Type 25），导致内存损坏，进而允许攻击者执行任意代码。攻击者通过发送特制的 ICMPv6 路由通告数据包来触发此漏洞。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞是一个真实存在的远程代码执行漏洞，并且已经有公开的PoC代码。提供的Zeek脚本是一个网络检测包，用于检测利用此漏洞的恶意流量。它通过分析 ICMPv6 路由通告数据包，特别是检查 RDNSS 选项的长度是否为偶数来判断是否存在攻击。

**投毒风险分析：**

提供的PoC代码（Zeek脚本）主要用于检测攻击，而不是利用攻击。仔细检查提供的文件，包括`LICENSE`, `README.md`, `bro-pkg.meta`, `zkg.meta`, `scripts/CVE-2020-16898.zeek`, 和 `scripts/__load__.zeek`，没有发现明显的恶意代码或后门。代码逻辑清晰，主要是检测 ICMPv6 路由通告消息中 RDNSS 选项的长度是否合法。脚本通过生成 Notice 日志来告知管理员存在潜在的攻击行为。投毒的风险较低，但仍存在微小可能性，例如利用 Zeek 脚本的复杂性进行隐藏，或者利用 Zeek 本身的漏洞执行恶意操作。因此，保守估计投毒风险为5%。

**利用方式分析：**

1.  **攻击者构造恶意的 ICMPv6 路由通告数据包：** 数据包中包含一个格式错误的 RDNSS 选项（Option Type 25），其长度为非偶数。
2.  **攻击者将恶意数据包发送给目标 Windows 主机：** 可以通过本地网络发送，也可以通过中间人攻击等方式。
3.  **目标主机处理恶意数据包：** Windows TCP/IP 协议栈在处理该数据包时，由于 RDNSS 选项的长度错误，导致内存溢出。
4.  **攻击者利用内存溢出执行任意代码：** 攻击者可以在溢出的内存中写入恶意代码，并控制程序的执行流程，最终实现远程代码执行。

提供的 Zeek 脚本并不能直接利用漏洞，而是用于检测网络流量中是否存在利用此漏洞的攻击行为。 它通过检测 ICMPv6 路由通告消息中的 Recursive_DNS_Server_Option (RDNSS) 是否存在长度异常的情况（长度不为偶数）来进行判断。 如果发现异常，则会产生一个Notice告警。

**项目地址:** [corelight/CVE-2020-16898](https://github.com/corelight/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #9

**来源**: [CVE-2020-16898-esnet-security_cve-2020-16898.md](../2020/CVE-2020-16898-esnet-security_cve-2020-16898.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞 (Bad Neighbor)

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行，系统控制

**影响版本:** Windows 10 版本 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, 版本 1903, 版本 2004

**利用条件:** 攻击者需要与目标系统处于同一网络段，并发送特制的 ICMPv6 路由器通告数据包。

**POC 可用性:** 是，网络上已存在公开的PoC

**投毒风险:** 10%

## 详情

CVE-2020-16898 是一个存在于 Windows TCP/IP 协议栈中的远程代码执行漏洞。当 Windows TCP/IP 协议栈未正确处理 ICMPv6 路由器通告 (Router Advertisement) 数据包时，会导致此漏洞。攻击者可以通过向远程 Windows 计算机发送特制的 ICMPv6 路由器通告数据包来利用此漏洞。

**有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞真实存在，并且有公开可用的 PoC 代码。从搜索结果来看，该漏洞被称为"Bad Neighbor"，影响多个Windows版本，包括Windows 10和Windows Server 2019。

**投毒风险：**
提供的代码片段是Zeek (原 Bro) 网络安全监控平台的包，用于检测 CVE-2020-16898 和 CVE-2020-16899 漏洞的利用。这段代码本身是用于安全检测的，而不是漏洞利用的 PoC 代码。但是，由于攻击者可能修改或替换该Zeek包，以达到隐藏恶意行为或进行进一步攻击的目的，因此存在一定的投毒风险。

风险评估：
- 代码用途：用于检测漏洞，本身不包含漏洞利用代码。
- 代码来源：esnet-security，看似合法的组织，但无法完全排除风险。
- 代码行为：检测 ICMPv6 数据包，并记录相关信息。
- 潜在风险：修改后的 Zeek 包可能绕过检测，或者执行恶意操作。

综合考虑，认为存在10%的投毒风险。

**利用方式：**
1.  **攻击者发送特制的 ICMPv6 路由器通告数据包：** 该数据包包含一个畸形的或超出预期的 RDNSS (Recursive DNS Server) 选项。
2.  **Windows TCP/IP 协议栈处理数据包：**  当 TCP/IP 协议栈解析这个畸形 RDNSS 选项时，由于缺乏适当的边界检查，会发生缓冲区溢出。
3.  **远程代码执行：**  缓冲区溢出允许攻击者覆盖内存，最终导致在目标系统上执行任意代码。
4.  **权限提升：**  由于 TCP/IP 协议栈运行在内核模式，成功利用此漏洞可以获得系统级别的权限。

**项目地址:** [esnet-security/cve-2020-16898](https://github.com/esnet-security/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #10

**来源**: [CVE-2020-16898-initconf_CVE-2020-16898-Bad-Neighbor.md](../2020/CVE-2020-16898-initconf_CVE-2020-16898-Bad-Neighbor.md)

## CVE-2020-16898: Bad Neighbor - Windows TCP/IP远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，可能导致远程代码执行或拒绝服务 (DoS)

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要与目标系统处于同一网络或能够发送 ICMPv6 路由通告数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898，又名"Bad Neighbor"，是一个Windows TCP/IP堆栈中的远程代码执行漏洞。该漏洞源于Windows TCP/IP堆栈不正确地处理 ICMPv6 路由器通告数据包。攻击者可以通过发送特制的 ICMPv6 路由器通告数据包到远程Windows计算机来利用此漏洞。成功利用此漏洞的攻击者可以在目标服务器或客户端上执行代码。

根据漏洞信息和搜索结果，该漏洞可以通过发送包含畸形 RDNSS 选项的 ICMPv6 路由器通告数据包来触发。具体来说，当 RDNSS 选项的长度字段为偶数时，会触发漏洞。

提供的 Zeek 脚本实现了对该漏洞的检测。它会检查所有传入的 ICMPv6 流量，查找 ICMPv6 类型字段为 134 (表示路由器通告) 且 ICMPv6 选项字段为 25 (表示递归 DNS 服务器 RDNSS) 的数据包。如果此 RDNSS 选项的长度字段值为偶数，则该脚本会发出警报。

**有效性：**

提供的Zeek脚本并非漏洞利用代码，而是用于检测攻击的签名。其有效性在于检测到潜在的攻击流量，但它本身无法触发漏洞。

**投毒风险：**

该Zeek脚本的目的是检测恶意流量，本身不太可能包含投毒代码。 风险评估为10%。原因包括：
   * Zeek 脚本的主要功能是网络流量分析和检测，用于安全监控。因此，直接嵌入恶意代码的可能性较低。
   * 该脚本相对简单，主要基于对 ICMPv6 报文特定字段的检查，易于人工审查，从而降低了隐藏恶意代码的风险。

**利用方式：**

1.  攻击者需要与目标系统处于同一网络或能够向目标系统发送 ICMPv6 路由通告数据包。
2.  攻击者构造一个包含畸形 RDNSS 选项的 ICMPv6 路由通告数据包。RDNSS 选项的长度字段必须是偶数。
3.  攻击者将构造的数据包发送到目标系统。
4.  如果目标系统未打补丁，则可能导致远程代码执行或者拒绝服务。

**项目地址:** [initconf/CVE-2020-16898-Bad-Neighbor](https://github.com/initconf/CVE-2020-16898-Bad-Neighbor)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #11

**来源**: [CVE-2020-16898-jiansiting_cve-2020-16898.md](../2020/CVE-2020-16898-jiansiting_cve-2020-16898.md)

## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709 及以上，未安装相应补丁

**利用条件:** 需要目标系统开启 IPv6 且与攻击者处于同一网络或攻击者可发送 ICMPv6 报文到目标。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞。该漏洞源于 Windows TCP/IP 协议栈在处理 ICMPv6 路由器通告 (Router Advertisement) 报文时，没有正确处理 RDNSS 选项（递归 DNS 服务器）。攻击者可以通过发送特制的 ICMPv6 路由器通告报文，利用 Option Type 25 触发缓冲区溢出，从而导致蓝屏死机 (BSOD) 或者远程代码执行。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断此POC代码是有效的，因为该代码能够触发蓝屏死机（BSOD）。但是否能执行任意代码取决于目标系统的具体配置和缓解措施。

**投毒风险：**
分析提供的 `bsod-poc.py` 脚本，该脚本主要用于发送精心构造的 ICMPv6 报文，以触发目标系统的漏洞。代码主要使用了 `scapy` 库来构建和发送网络报文。代码逻辑相对清晰，没有发现明显的恶意代码或者后门，因此判断投毒风险较低。

**漏洞利用方式：**
1.  攻击者首先需要确定目标系统的 IPv6 地址。
2.  攻击者使用 `scapy` 库构建一个恶意的 ICMPv6 路由器通告报文。
3.  该报文中包含一个畸形的 RDNSS 选项，特别是 Option Type 25。
4.  通过 `fragment6` 函数对报文进行分片，然后将分片后的报文发送到目标系统。
5.  目标系统接收到这些报文后，由于 TCP/IP 协议栈处理 RDNSS 选项时存在漏洞，导致缓冲区溢出。
6.  攻击者可导致目标系统蓝屏死机，可能情况下实现远程代码执行。

**总而言之，提供的POC主要目的是触发BSOD，没有发现植入恶意代码的痕迹，投毒风险为0%。**

**项目地址:** [jiansiting/cve-2020-16898](https://github.com/jiansiting/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #12

**来源**: [CVE-2020-16898-komomon_CVE-2020-16898--EXP-POC.md](../2020/CVE-2020-16898-komomon_CVE-2020-16898--EXP-POC.md)

## CVE-2020-16898 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可导致远程代码执行甚至蓝屏死机（BSOD）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要与目标主机在同一网络中，并知道目标主机的IPv6地址（特别是本地链路地址）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-16898 是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞，当协议栈不正确处理 ICMPv6 路由器通告（Router Advertisement）数据包时，可能触发此漏洞。攻击者可以发送特制的 ICMPv6 路由器通告数据包到目标 Windows 计算机，从而获得在目标服务器或客户端上执行代码的能力。根据搜索结果，成功利用此漏洞可能导致蓝屏死机（BSOD），并可能被用于远程代码执行。漏洞出现在处理Option Type 25的ICMPv6 RA包时。

**漏洞利用方式：**

1.  **发送特制的 ICMPv6 数据包：** 攻击者需要构造包含恶意选项的 ICMPv6 路由器通告数据包。
2.  **利用 RDNSS 选项：** 漏洞利用通常涉及操纵 RDNSS (Recursive DNS Server) 选项，通过修改其长度和内容，来触发栈溢出。
3.  **碎片化处理：** 漏洞利用代码中使用了 IPv6 碎片化，将数据包分成小片段发送，以便绕过某些安全检测机制或更有效地触发漏洞。
4.  **覆盖返回地址：** 成功利用漏洞需要覆盖栈上的返回地址，以便在函数返回时执行攻击者控制的代码。

**有效性评估：**

提供的漏洞利用代码 (CVE-2020-16898-exp1.py 和 CVE-2020-16898.py) 似乎有效，至少可以触发蓝屏死机。根据 README 文件和代码注释，这些代码经过测试，并且需要修改目标 IPv6 地址才能使用。exp1 通过构造包含特定长度和内容的 ICMPv6 路由器通告数据包来利用漏洞，exp2 则是通过发送两个精心构造的 RDNSS 选项，触发栈溢出。

**投毒风险评估：**

虽然提供的代码主要用于触发 BSOD，但如果恶意修改，也可能被用于执行任意代码。仓库中的投毒风险较低，约为5%。主要风险点在于:

*   **payload的植入：** 攻击者可能会修改exp, 在exp的Overwrite部分植入恶意payload,当触发漏洞时,执行攻击者植入的payload.
*   **源地址欺骗：** 虽然exp文件注释显示可以伪造源地址，可能被用于中间人攻击或放大攻击。

总体来说，虽然直接的投毒代码并不明显，但攻击者可能通过修改提供的 PoC 代码来实现恶意目的。因此，在使用这些代码时需要格外小心，并在隔离环境中进行测试。

**项目地址:** [komomon/CVE-2020-16898--EXP-POC](https://github.com/komomon/CVE-2020-16898--EXP-POC)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #13

**来源**: [CVE-2020-16898-komomon_CVE-2020-16898-EXP-POC.md](../2020/CVE-2020-16898-komomon_CVE-2020-16898-EXP-POC.md)

## CVE-2020-16898 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务（蓝屏）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 攻击者需要能够向目标 Windows 计算机发送特制的 ICMPv6 路由器通告数据包，需要知道目标的 IPv6 地址（包括本地链路 IPv6 地址，全球 IPv6 地址，临时 IPv6 地址）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Windows TCP/IP栈中，由于对ICMPv6路由器通告报文处理不当导致。攻击者通过发送特制的ICMPv6报文，利用Option Type 25 触发漏洞。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的PoC已经公开，并且已被证实可以触发蓝屏死机（BSOD），表明漏洞利用是有效的。提供的漏洞利用代码中存在两个exp， exp1可以直接远程代码执行,exp2可以直接导致目标系统崩溃。

**投毒风险：**
检查了提供的PoC代码，未发现明显的恶意代码，但是，考虑到攻击者可能修改代码以进行恶意活动，例如植入后门或执行其他恶意操作，仍然存在一定的风险。

**利用方式：**
1.  攻击者需要确定目标系统的IPv6地址。
2.  攻击者使用PoC代码（例如，`CVE-2020-16898-exp1.py` 或 `CVE-2020-16898.py`），修改目标IP地址为攻击目标的IPv6地址。
3.  攻击者运行PoC代码，发送特制的ICMPv6路由器通告报文到目标系统。
4.  如果目标系统存在漏洞，可能会触发远程代码执行或者导致系统崩溃（BSOD）。

**缓解措施：**
*   及时安装Microsoft发布的补丁。
*   禁用IPv6，如果不需要使用IPv6网络。
*   配置防火墙规则，限制ICMPv6流量。

**项目地址:** [komomon/CVE-2020-16898-EXP-POC](https://github.com/komomon/CVE-2020-16898-EXP-POC)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

## POC #14

**来源**: [CVE-2020-16898-momika233_CVE-2020-16898-exp.md](../2020/CVE-2020-16898-momika233_CVE-2020-16898-exp.md)

## CVE-2020-16898 - Windows TCP/IP 远程代码执行漏洞（Bad Neighbor）

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要在与目标系统相同的网络上或能够发送 ICMPv6 路由通告数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-16898 是一个存在于 Windows TCP/IP 协议栈中的远程代码执行漏洞。该漏洞是由于 Windows TCP/IP 协议栈不正确地处理 ICMPv6 路由通告数据包所致。 攻击者可以通过发送特制的 ICMPv6 路由通告数据包到远程 Windows 计算机来利用此漏洞，成功利用此漏洞的攻击者可以在目标服务器或客户端上执行任意代码。 

根据漏洞信息和搜索结果，该漏洞影响多个 Windows 版本，包括 Windows 10 和 Windows Server。该漏洞利用涉及发送特制的 ICMPv6 数据包。PoC 代码使用 Scapy 库构造这些数据包，并发送给目标。PoC代码通过填充 `ICMPv6NDOptRDNSS` 选项的 `dns` 字段来触发漏洞。根据搜索结果和漏洞描述，该漏洞有可能导致远程代码执行或者拒绝服务（BSOD）。

**有效性：**
根据漏洞信息，该漏洞的 PoC 是可用的，提供的代码可以触发蓝屏死机（BSOD），表明 PoC 具有一定的有效性。

**投毒风险：**
该 PoC 代码主要使用 Scapy 库构造和发送 ICMPv6 数据包，未发现明显的恶意代码或后门。但是，所有来源不明的代码都存在一定的风险，建议在隔离环境中运行。
仔细审查代码，发现其逻辑主要是构造畸形的ICMPv6数据包以触发TCP/IP协议栈中的漏洞，目的是导致BSOD。其中最可疑的地方是大量的"AAAA:AAAA:AAAA:AAAA:AAAA:AAAA:AAAA:AAAA"字符串。这部分代码是在利用漏洞，而非添加恶意代码。因此，判定投毒风险较低，估计在5%左右，主要是考虑作者可能会植入一些不易察觉的payload。

**利用方式：**
1.  攻击者需要位于与目标系统相同的网络或者能够向目标系统发送 IPv6 数据包。
2.  攻击者利用 Scapy 等工具构造恶意的 ICMPv6 路由通告 (RA) 数据包，特别是 `ICMPv6NDOptRDNSS` 选项。
3.  构造的 ICMPv6 RA 数据包被发送到目标 Windows 系统。
4.  Windows TCP/IP 协议栈处理畸形的 ICMPv6 RA 数据包时，触发漏洞，可能导致远程代码执行或拒绝服务攻击（BSOD）。

**项目地址:** [momika233/CVE-2020-16898-exp](https://github.com/momika233/CVE-2020-16898-exp)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)

---

