## CVE-2020-1472 - Microsoft Windows Server (Active Directory Domain Controller) 身份验证绕过/提权

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 身份验证绕过/提权

**影响应用:** Microsoft Windows Server (Active Directory Domain Controller)

**危害等级:** Critical

**CVSS评分:** 10.0

**影响版本:** Windows Server 2008 R2, 2012, 2012 R2, 2016, 2019; Samba 4.0及更高版本

**利用条件:** 无需身份验证，但需要能够通过TCP/IP连接到目标域控制器的网络访问权限。

**POC 可用性:** 4/10

**POC 类型:** 概念验证/仅说明

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：本研究所分析的POC代码主要是一个实验记录和环境测试说明。该POC的核心逻辑基于Netlogon协议中AES-CFB8加密算法的错误实现。在Netlogon安全通道身份验证过程中，由于初始化向量（IV）被错误地硬编码为全零，攻击者可以通过发送特定的挑战值，以1/256的概率在不知道计算机账户密码的情况下通过身份验证。该POC展示了如何利用zerologon_tester.py进行漏洞检测，但开发者明确指出在实际利用阶段（重置DC机器账户密码）由于Python库Impacket的兼容性问题未能成功执行完整链条。这表明该特定存储库的代码并不能作为开箱即用的攻击武器，更多是作为学习和防御测试的参考，对于防御者而言，其提供的检测脚本是有效的。利用步骤：首先，攻击者利用TCP端口135或445定位目标域控制器；其次，通过RPC调用发送包含全零挑战值的Netlogon认证请求，循环尝试约256次直至绕过认证；随后，利用NetrServerPasswordSet2函数将DC的机器账户密码重置为空字符串；最后，攻击者可以使用空密码登录DC，并通过Secretsdump等工具导出所有域哈希，实现完全接管。投毒风险分析：经过对提供的代码结构和描述的审查，该POC项目的投毒风险极低，评分为5%。其内容主要由Markdown说明文档组成，引用的外部工具如Impacket和zerologon_tester均为安全社区广泛认可的开源工具。仓库作者坦诚地记录了失败的利用尝试和遇到的环境问题，这种行为不符合恶意投毒者通常表现出的‘一键利用’虚假承诺。代码中没有发现混淆脚本、自动执行的恶意二进制文件或异常的远程连接请求。唯一的潜在风险在于用户在使用该POC描述的方法时，可能会由于操作不当（如重置了DC密码而未能正确恢复）导致生产环境域控服务瘫痪。建议防御研究人员在使用此类利用逻辑时，在完全隔离的虚拟化环境中进行，并密切监控Event ID 5805等特定安全日志，以建立有效的入侵检测指标。

**项目地址:** [https://github.com/JeNilSE](https://github.com/JeNilSE)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/cve-2020-1472](https://nvd.nist.gov/vuln/detail/cve-2020-1472)
