## CVE-2020-1472 - Microsoft Windows Server (Active Directory Domain Controllers) 特权提升/加密实现缺陷

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升/加密实现缺陷

**影响应用:** Microsoft Windows Server (Active Directory Domain Controllers)

**危害等级:** CRITICAL

**CVSS评分:** 10.0

**影响版本:** Windows Server 2008 R2, 2012, 2012 R2, 2016, 2019, 2022及Windows 10等相关版本

**利用条件:** 攻击者需能通过TCP/IP连接到域控制器（DC），无需经过身份验证。

**POC 可用性:** 4/10

**POC 类型:** 概念验证/仅说明

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

【POC有效性分析】该提供的POC文档描述了一个针对CVE-2020-1472（ZeroLogon）的研究过程。该漏洞的核心在于Netlogon远程协议在执行加密握手时使用了不安全的AES-CFB8模式，且初始化向量（IV）固定为全零。由于AES-CFB8的特性，在IV为零的情况下，每256个猜测中就有一个会导致密文全为零。攻击者可以通过发送虚假的身份认证请求（连续发送全零的挑战），在不需要知道计算机账户密码的情况下，成功欺骗域控制器建立安全通道。一旦安全通道建立，攻击者即可调用Netlogon协议中的敏感RPC函数，如`NetrServerPasswordSet2`，将域控制器的计算机账户（通常是机器名后面带$）的密码重置为空字符串或其他已知值，从而实现对整个域控的完全控制。输入的数据显示，该POC作者在实验中遇到了Impacket库的兼容性问题，这在安全研究中非常常见。此类漏洞的POC通常依赖特定的加密库实现，若环境中`pycryptodome`或`impacket`版本不匹配，会导致AES-CFB8的计算逻辑出错，从而使利用失败。因此，虽然该文档提供了利用思路，但并未提供可立即执行的高质量自动化脚本，仅属于较低程度的实验记录。利用步骤如下：1. 使用扫描工具（如zerologon_tester.py）确认目标DC是否存在漏洞；2. 向DC发送伪造的Netlogon认证请求，直到通过全零IV碰撞成功绕过认证；3. 利用建立的安全通道发送RPC请求，强制重置DC机器账户密码；4. 使用空密码登录并导出域内的NTDS.dit数据库，获取所有域用户的Hash。 【投毒风险分析】从提供的POC文档和代码片段来看，该项目属于典型的个人安全学习研究记录，投毒风险极低。分析理由如下：首先，文档内容公开透明，详细描述了实验环境（Windows Server 2019）、攻击机（Kali Linux）以及所使用的第三方标准库（Impacket），其行为模式符合学术研究特征。其次，作者明确指出了在执行过程中遇到的环境依赖问题和失败点，这与旨在诱导用户运行恶意代码的“一键利用脚本”有本质区别。投毒脚本通常会极力掩饰错误，引导用户赋予高权限或关闭安全软件，而此处文档反而提供了防御建议和日志监测方法（如Event ID 5805）。再次，代码逻辑（虽未详尽列出，但根据README判断）主要是调用已知的安全工具库，并没有引入经过混淆的Base64载荷、远程Shell下载指令或未知的二进制文件。虽然在分析此类漏洞时必须警惕由于攻击者将DC密码置为空而导致的“拒绝服务”风险（这并非投毒，而是漏洞利用的副作用），但就POC分发过程而言，该项目不包含恶意后门或针对研究员的定向攻击组件，属于安全的参考资料。

**项目地址:** [https://github.com/JeNilSE/CVE-2020-1472-Analysis](https://www.google.com/search?q=https://github.com/JeNilSE/CVE-2020-1472-Analysis)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)
