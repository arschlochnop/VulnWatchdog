## CVE-2020-1472 - Microsoft Windows Server 特权提升 (Elevation of Privilege)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升 (Elevation of Privilege)

**影响应用:** Microsoft Windows Server

**危害等级:** CRITICAL

**CVSS评分:** 10.0

**影响版本:** Windows Server 2008 R2 up to Windows Server 2019

**利用条件:** 攻击者需能通过网络访问域控制器(DC)，无需域用户认证凭据

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：该POC实现了针对CVE-2020-1472（Zerologon）的完整攻击流程。该漏洞根源于Netlogon远程协议中AES-CFB8加密算法的错误实现，其初始向量(IV)被错误地硬编码为全零。由于AES-CFB8的特性，当明文为全零且IV也为全零时，存在1/256的概率产生全零的密文。POC通过向域控制器发送约2000次伪造的认证尝试（I_NetServerReqChallenge和I_NetServerAuthenticate2），利用全零Client Challenge绕过认证。一旦认证成功，POC调用NetServerPasswordSet2接口，将域控制器的机器账户（如DC01$）密码设置为空字符串。经过分析，该POC逻辑清晰，直接调用了Windows RPC接口，具有极高的利用成功率，且不依赖于任何特定的用户凭据，是内网渗透中极具杀伤力的工具。利用步骤如下：首先，定位目标域控制器的FQDN和NetBIOS名；其次，运行编译后的Zerologon.exe，程序会自动化执行爆破认证过程；一旦显示SUCCESS，DC的机器账户密码已被置空；最后，攻击者可以使用空密码通过Pass-the-Hash（PtH）方式获取域控权限，并使用secretsdump等工具导出整个域的哈希。这种攻击会导致整个Active Directory林被完全接管。投毒风险分析：该POC项目主要由C#或Python编写（此处提供的片段包含C++编译指导和Python引用），代码结构透明，主要依赖于标准库和Windows SDK。在投毒风险评估中，该项目被标记为低风险（10%）。代码中未发现明显的恶意混淆、未授权的外联请求或隐蔽的二进制Payload植入。风险主要集中在两个方面：一是编译环境的安全性，如果用户下载了预编译的exe文件，可能存在被第三方篡改注入后门的风险；二是脚本本身对域控密码的置空操作具有破坏性，若无恢复脚本（restorepassword.py），会导致域控无法正常同步。但从POC代码逻辑来看，其行为完全符合安全研究和合规渗透测试的范畴，不具备典型的软件供应链投毒特征。建议研究人员在受控隔离环境中使用，并确保拥有对应的密码恢复方案，以防止对生产环境造成不可逆的拒绝服务影响。

**项目地址:** [https://github.com/dirkjanm/CVE-2020-1472](https://github.com/dirkjanm/CVE-2020-1472)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)
