## CVE-2020-1472 - Microsoft Windows Server 权限提升/加密缺陷

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升/加密缺陷

**影响应用:** Microsoft Windows Server

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** Windows Server 2008 R2 up to Windows Server 2019

**利用条件:** 攻击者需要能够通过网络连接到目标域控制器(DC)并与其进行Netlogon协议通信，无需任何认证凭据。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是针对微软Netlogon远程协议（MS-NRPC）的一个极其严重的加密漏洞。该漏洞源于Netlogon在AES-CFB8加密实现中的逻辑缺陷：它错误地使用了一个全零的固定初始化向量（IV），而不是随机生成的IV。由于AES-CFB8的特性，当明文和IV均为全零时，存在1/256的概率生成的密文也是全零。攻击者通过向域控制器发送连续约2000次的伪造挑战响应（Challenge-Response），即可绕过身份验证。一旦认证成功，攻击者可以调用I_NetServerPasswordSet2函数，将域控制器的机器账户（如DC01$）密码重置为空（即NTLM哈希为31d6cfe0d16ae931b73c59d7e0c089c0）。POC有效性分析：本项目的POC代码逻辑非常完整且具有实战价值。它详细实现了从目标探测、挑战欺骗、暴力破解身份验证到最终密码重置的完整链路。代码中明确指出了利用步骤：1. 通过Netlogon接口建立连接；2. 发送8字节全零的Client Challenge；3. 循环尝试认证直到成功；4. 调用密码重置接口。该POC不仅提供了编译好的执行逻辑说明，还附带了后续利用建议，如结合impacket套件中的secretsdump进行域内凭据提取。由于该漏洞利用的是协议层的逻辑缺陷，POC在未修复的系统上成功率极高，几乎达到100%。利用步骤：首先确定目标DC的FQDN和机器名，运行Zerologon.exe进行密码重置；随后利用空密码的哈希值通过Pass-the-Hash方式登录DC；最后导出域内所有用户的Hash完成全域接管。 投毒风险分析：该POC代码主要基于标准的Windows API和C++编写，其提供的README和逻辑流程非常清晰，不具备混淆特征。在分析中未发现恶意外部链接、远程代码执行后门或非法信息回传逻辑。其提供的代码片段和编译说明均围绕漏洞复现展开。风险点主要在于：攻击者可能在预编译的二进制文件（如Zerologon.exe）中植入恶意代码，但在源码层面，该实现遵循了安全研究的标准规范。对于防御者而言，最大的风险在于利用代码本身的高度自动化可能导致在生产环境测试时意外重置生产域控密码，从而引发大规模的服务中断（如DNS故障、认证失效）。此外，此类POC在GitHub等平台的克隆版本中，可能会被第三方恶意篡改，在执行漏洞利用逻辑的同时静默安装键盘记录器或远控木马。总体而言，当前POC源码本身投毒风险较低，但使用预编译版本时需保持高度警惕。

**项目地址:** [https://github.com/RISK-RESEARCH/Zerologon-Exploit](https://www.google.com/search?q=https://github.com/RISK-RESEARCH/Zerologon-Exploit)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)
