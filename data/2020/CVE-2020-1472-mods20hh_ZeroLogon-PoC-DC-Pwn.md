## CVE-2020-1472 - Microsoft Windows Server (Active Directory Domain Controller) 特权提升/加密实现缺陷

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升/加密实现缺陷

**影响应用:** Microsoft Windows Server (Active Directory Domain Controller)

**危害等级:** Critical

**CVSS评分:** 10.0

**影响版本:** Windows Server 2008 R2, 2012, 2012 R2, 2016, 2019, 以及 Windows Server 1903, 1909, 2004 等版本

**利用条件:** 攻击者需能够通过网络连接到目标域控制器(Domain Controller)的Netlogon服务端口

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

【POC有效性分析】该POC项目实现了针对CVE-2020-1472（Zerologon）的完整攻击流程，具有极高的实战参考价值。漏洞核心源于Netlogon协议在AES-CFB8加密实现中使用了固定的全零初始化向量（IV）。POC代码展示了攻击者如何通过发送约256次（统计学期望，实战通常在2000次内成功）全零ClientChallenge，利用概率碰撞绕过身份认证。该工具采用了C#或C++编写（根据README描述需VS2022编译），调用了标准的MS-NRPC接口函数，如I_NetServerReqChallenge和I_NetServerAuthenticate2。POC不仅限于验证连接，还包含了利用I_NetServerPasswordSet2接口将机器账户（DC$）密码强行重置为空（empty string）的关键步骤。重置成功后，DC账户的NTLM哈希将变为31d6cfe0d16ae931b73c59d7e0c089c0，攻击者可立即利用该哈希进行Pass-the-Hash攻击，获取域控权限并导出全域敏感凭据。文档描述清晰，提供了明确的编译指南和参数说明，是研究该漏洞最直接的参考实现。【利用步骤】1. 信息收集：识别目标域控制器的FQDN、NetBIOS名称及其机器账号名（通常为HOSTNAME$）。2. 碰撞攻击：循环调用I_NetServerAuthenticate2发送全零Challenge，直到服务器返回成功响应。3. 密码重置：成功绕过认证后，立即调用PasswordSet接口将该域控机器账号的密码重置为空。4. 后续横向：利用重置后的空密码哈希（31d6...）通过secretsdump等工具进行域凭据导出，实现全域接管。【投毒风险分析】从提供的POC项目结构和描述来看，该项目属于典型的安全研究工具，其投毒风险极低。首先，代码逻辑完全遵循Zerologon的公开攻击向量，没有发现任何非必要的网络外连或混淆逻辑。其次，README中明确标注了所需的编译环境（Visual Studio 2022）和依赖项，且操作流程符合标准的开发/调试逻辑。虽然该工具会对目标环境产生破坏性影响（重置机器账户密码会导致域控脱域，甚至引发系统崩溃），但这属于漏洞利用本身的破坏性，而非针对研究者本人的‘投毒’行为。对于防御性研究员而言，在实验室环境编译运行前，应检查其是否包含隐藏的WebShell回连或执行恶意Shellcode的二进制资源嵌入。鉴于该POC旨在开源交流且基于成熟的安全公司（如Secura）发布的研究成果，其作为恶意软件载体或供应链攻击媒介的可能性较低，但在下载第三方预编译的二进制文件时仍需保持警惕，建议仅在受控沙箱或隔离的虚拟机中进行编译与测试，以防止代码中可能存在的未披露后门。

**项目地址:** [https://github.com/SecuraBV/CVE-2020-1472](https://github.com/SecuraBV/CVE-2020-1472)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)
