## CVE-2020-1472 - Microsoft Windows Server 特权提升 (Elevation of Privilege)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升 (Elevation of Privilege)

**影响应用:** Microsoft Windows Server

**危害等级:** CRITICAL

**CVSS评分:** 10.0

**影响版本:** Windows Server 2008 R2 up to Windows Server 2019

**利用条件:** 需要能够通过网络访问域控制器(DC)，无需域用户凭据

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC代码是针对CVE-2020-1472（Zerologon）漏洞的高度完整实现。漏洞核心在于Netlogon远程协议（MS-NRPC）在使用AES-CFB8加密时，错误地使用了全零的初始向量（IV），导致加密强度大幅降低。分析POC代码可知，它通过向域控制器发送约2000次包含全零Challenge的Netlogon认证请求，利用1/256的统计概率尝试绕过身份验证。一旦验证成功，POC调用I_NetServerPasswordSet2接口，将域控机器账户（如DC01$）的密码重置为空（即对应的NTLM Hash为31d6cfe0d16ae931b73c59d7e0c089c0）。此POC不仅包含了核心的加密绕过逻辑，还提供了后续利用指引（如Pass-the-Hash），具有极高的实战价值。其逻辑符合微软官方及安全社区披露的漏洞原理，能够稳定触发。利用步骤：1. 获取目标域控的FQDN、NetBIOS名称及机器账户名；2. 运行编译后的Zerologon.exe发送大量零挑战请求进行碰撞攻击；3. 碰撞成功后，域控机器账户密码被置为空；4. 使用Impacket等工具通过空密码Hash进行域管权限获取；5. 导出域内所有用户Hash，达成全域控。 【投毒风险分析】当前提供的POC代码结构清晰，主要基于标准Windows SDK开发，未发现明显的恶意混淆或外部异常请求，属于高质量的安全研究代码。然而，作为威胁情报研究员，需警惕此类高影响力漏洞POC在公开分发过程中的‘二次投毒’风险。该漏洞利用通常需要通过RPC协议与DC通信，攻击者可能在编译后的二进制文件中嵌入恶意后门，或者在Python版本的PoC中修改restorepassword.py脚本，使其在尝试‘恢复密码’时将凭据外发至第三方服务器。此外，由于该漏洞利用涉及重置域控密码，操作具有不可逆性（若不及时恢复会导致域环境崩溃），一些冒充POC的脚本可能会在不提示的情况下执行破坏性操作，干扰防御者的应急响应流程。综合评估，源代码层面投毒风险较低，但直接运行未经验证的预编译版（.exe）存在中高风险，建议在隔离环境审计源码并自行编译使用。

**项目地址:** [https://github.com/dirkjanm/CVE-2020-1472](https://github.com/dirkjanm/CVE-2020-1472)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)
