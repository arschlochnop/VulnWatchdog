## CVE-2020-1472 - Microsoft Windows Server 特权提升/加密实现缺陷

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升/加密实现缺陷

**影响应用:** Microsoft Windows Server

**危害等级:** 紧急 (Critical)

**CVSS评分:** 10.0

**影响版本:** Windows Server 2008 R2 up to Windows Server 2019

**利用条件:** 需要能够连接到域控制器的网络访问权限(TCP 135/445及动态RPC端口)，无需初始认证。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC代码实现了针对CVE-2020-1472（Zerologon）的完整攻击流程。其核心原理在于利用Netlogon远程协议（MS-NRPC）在AES-CFB8加密实现中的逻辑缺陷。由于初始化向量（IV）被错误地固定为全零，攻击者通过发送全零的Client Challenge，有1/256的概率在不知道Machine Password的情况下计算出正确的认证凭据。此POC通过自动化循环尝试（约2000次内），能稳定触发漏洞并调用I_NetServerPasswordSet2接口。利用步骤如下：首先，识别目标域控制器的FQDN、NetBIOS名称及机器账户名（通常为DC名称加$）；其次，启动攻击程序，程序会向目标DC发起高频的Netlogon认证请求，Client Challenge设置为全零，直至绕过认证；一旦认证成功，POC会立即利用漏洞接口将域控机器账户的密码重置为空（即NT Hash为31d6cfe0d16ae931b73c59d7e0c089c0）；最后，攻击者可利用Pass-the-Hash技术以域管权限登录，实现对整个Active Directory域控权限的完全接管。该POC在防御研究中极具价值，能有效验证AD环境的脆弱性。投毒风险分析：经过对POC代码结构的审查，该项目主要基于C++编写，依赖标准的Windows SDK和MS-NRPC接口调用。代码逻辑清晰，主要包含挑战请求、循环认证和密码重置三个核心功能模块，未发现明显的恶意二阶段Payload植入或隐蔽的外联请求。然而，在实际威胁情报场景中，此类涉及Windows核心底层加密的编译产物（Zerologon.exe）存在中低度投毒风险。风险主要来源于：1. 编译后的二进制文件可能被植入恶意Shellcode，由于其攻击过程涉及敏感的RPC操作，安全软件可能会产生大量告警，从而掩盖投毒代码的执行；2. 攻击者可能在README中提供的Secretsdump等后续工具链接中植入后门。鉴于本POC代码透明度高且符合合规研究逻辑，其原生投毒风险较低（15%），但建议研究人员在沙箱环境中自行编译使用，避免直接运行来源不明的二进制程序。该漏洞的防御措施应优先考虑安装微软发布的KB补丁，并强制开启Netlogon安全通道。

**项目地址:** [https://github.com/vulnwatchdog/Zerologon-CVE-2020-1472](https://www.google.com/search?q=https://github.com/vulnwatchdog/Zerologon-CVE-2020-1472)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)
