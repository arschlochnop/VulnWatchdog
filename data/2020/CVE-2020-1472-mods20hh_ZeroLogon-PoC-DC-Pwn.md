## CVE-2020-1472 - Microsoft Windows Server 权限提升 (Elevation of Privilege)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升 (Elevation of Privilege)

**影响应用:** Microsoft Windows Server

**危害等级:** Critical

**CVSS评分:** 10.0

**影响版本:** Windows Server 2008 R2 up to Windows Server 2019

**利用条件:** 攻击者需要能够通过 TCP/IP 与域控制器（DC）建立 Netlogon 协议连接，无需预先认证。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

【POC有效性分析】该POC代码实现了针对CVE-2020-1472（Zerologon）的完整攻击流程。通过对Netlogon远程协议（MS-NRPC）中加密缺陷的利用，该POC具有极高的实用性。技术核心在于Netlogon在AES-CFB8模式下错误地使用了全零的初始向量（IV），使得攻击者通过发送约2000次全零的Client Challenge，就有1/256的概率绕过认证。提供的POC代码结构清晰，涵盖了从挑战请求（I_NetServerReqChallenge）到认证尝试（I_NetServerAuthenticate2），再到最后关键的密码重置（I_NetServerPasswordSet2）全过程。脚本成功运行后可将域控机器账户密码置为空（NT Hash: 31d6cfe0d16ae931b73c59d7e0c089c0），配合impacket工具包中的secretsdump即可实现全域权限获取。该POC属于工业级利用工具的复现，验证逻辑严密，是防御性研究中评估内网安全风险的重要参考。利用步骤：1. 识别目标域控制器的FQDN、NetBIOS名称及机器账号；2. 运行脚本进行暴力循环认证尝试（约256-2000次）；3. 认证成功后触发RPC调用重置DC密码；4. 使用空密码进行Pass-the-Hash攻击导出域哈希。【投毒风险分析】由于该漏洞属于极其敏感的红队攻击向量，其公开POC常被恶意攻击者用于二次封装。本次分析的POC代码主要基于标准的C#/.NET开发环境，代码逻辑透明，使用了标准的Windows SDK和RPC调用接口，未发现明显的代码混淆、外部非法连接或Shellcode隐藏行为。然而，在野外的GitHub仓库或安全论坛中，此类POC极易被植入恶意后门（如在编译好的二进制文件中加入木马、在Python脚本中添加Base64加密的恶意Payload）。针对本POC，风险点在于利用成功后的‘Post-Exploitation’阶段，部分自动化脚本可能会诱导下载非官方的secretsdump工具。防御人员在使用此类POC进行渗透测试或漏洞验证时，应严格审查二进制文件的Hash，建议仅在受控的沙箱环境或虚拟机中编译和运行源代码。当前分析的源码版本表现为纯粹的技术验证工具，投毒风险较低，但必须警惕其被集成到自动化蠕虫病毒或僵尸网络中的可能性。

**项目地址:** [https://github.com/dirkjanm/CVE-2020-1472](https://github.com/dirkjanm/CVE-2020-1472)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)
