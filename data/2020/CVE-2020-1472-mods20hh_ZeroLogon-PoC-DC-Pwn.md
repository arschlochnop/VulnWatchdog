## CVE-2020-1472 - Microsoft Windows Server 特权提升

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Microsoft Windows Server

**危害等级:** 关键 (Critical)

**CVSS评分:** 10.0

**影响版本:** Windows Server 2008 R2 up to Windows Server 2019

**利用条件:** 攻击者需能够通过 TCP/IP 与目标域控制器进行通信（通常在内网环境），无需任何用户凭据。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：本POC针对CVE-2020-1472（Zerologon）漏洞提供了完整的利用逻辑。该漏洞的核心在于Netlogon远程协议（MS-NRPC）在AES-CFB8加密实现中使用了固定的全零初始化向量（IV）。POC通过向域控制器（DC）发送约2000次包含全零Challenge的身份验证请求，利用密码学概率（1/256）成功绕过验证。一旦通过验证，POC调用I_NetServerPasswordSet2接口将DC的机器账户密码重置为空。经评估，该POC代码逻辑清晰，包含了目标探测、循环碰撞、密码重置及后期清理指引（restorepassword.py），具有极高的实战化利用价值，能够直接导致整个Active Directory域控权限沦陷。利用步骤：1. 侦察阶段：获取目标DC的FQDN、NetBIOS名称及机器账户名（如DC01$）。2. 碰撞阶段：运行漏洞利用程序，持续发送伪造的Netlogon请求，直到DC接受全零的Client Credential。3. 提权阶段：利用建立的特权会话重置DC机器账户密码为空字符串（NT hash为31d6cfe0d16ae931b73c59d7e0c089c0）。4. 后渗透阶段：使用Pass-the-Hash技术（如secretsdump.py）配合空密码Hash导出域内所有账户凭据。5. 恢复阶段：攻击完成后需及时恢复原始账户密码以维持隐蔽性。投毒风险分析：该POC项目主要由C++和Python编写，代码结构透明，主要依赖标准的Windows API和网络套件，未发现明显的恶意混淆、加密shellcode或隐蔽的远程外部连接请求。风险点在于该漏洞威力巨大且GitHub上存在大量复现项目，防御者在下载预编译二进制文件（如Zerologon.exe）时存在被植入后门的潜在风险。建议研究人员仅从知名安全研究员（如dirkjanm）的源码仓库获取代码，并在隔离环境自行编译。目前分析的代码段符合标准漏洞研究工具特征，未见投毒迹象，但由于其涉及重置域控密码等破坏性操作，误操作风险远高于投毒风险。建议在部署防御措施前，优先通过zerologon_tester.py进行无损检测，而非直接运行重置密码的POC。

**项目地址:** [https://github.com/dirkjanm/CVE-2020-1472](https://github.com/dirkjanm/CVE-2020-1472)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)
