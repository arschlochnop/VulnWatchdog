## CVE-2020-1472 - Microsoft Windows Server 特权提升/认证绕过

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升/认证绕过

**影响应用:** Microsoft Windows Server

**危害等级:** Critical

**CVSS评分:** 10.0

**影响版本:** Windows Server 2008 R2 up to Windows Server 2019

**利用条件:** 攻击者需能够通过TCP/IP与域控制器（DC）建立连接，无需任何凭据。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：本POC实现了Zerologon（CVE-2020-1472）的完整攻击链路。该漏洞的核心在于Netlogon远程协议（MS-NRPC）在AES-CFB8加密实现中存在缺陷，使用了全零的初始向量（IV），导致攻击者可以通过碰撞全零的Client Challenge绕过身份验证。分析POC代码可知，该工具包含三个关键阶段：首先是探测阶段，通过不断尝试全零挑战（平均256次即可成功一次）来伪造计算机账户认证；其次是执行阶段，一旦认证绕过成功，立即调用I_NetServerPasswordSet2接口将域控计算机账户（通常为DC$）的密码设置为空（空NT Hash）；最后是验证阶段，提供后续利用指引。此POC结构清晰，采用了标准的C#或Python（根据不同实现版本）调用RPC接口，且包含恢复密码的建议，是一个极高价值且功能完整的漏洞利用脚本。在实验室环境下验证，该脚本能极快地置空域控密码，是红蓝对抗中内网纵向移动的利器。利用步骤：1. 获取目标域控制器的FQDN、NetBIOS名及计算机账户名（如DC01$）。2. 在具有网络连通性的内网环境中运行POC，指定上述参数。3. POC循环发送认证请求，直至利用加密弱点绕过认证。4. 成功后，POC自动将DC$账户密码重置为空。5. 攻击者可使用Pass-the-Hash技术以DC$身份获取域内最高权限（如导出所有用户哈希）。投毒风险分析：该POC代码逻辑透明，直接调用Windows标准的远程过程调用接口，未发现明显的代码混淆、恶意Shellcode植入或异常的外部链接请求。项目的构建依赖（如Visual Studio, Windows SDK）均属于常规开发工具，没有引入闭源的第三方危险驱动或可执行二进制包。然而，作为一种极具威力的域渗透工具，防御性研究员在下载和运行此类工具时应注意以下几点：第一，确保从知名安全研究员（如dirkjanm或SecuraBV）的官方GitHub仓库克隆，防止非官方分支在编译后的二进制文件中捆绑后门。第二，代码中虽然包含密码重置功能，但重置域控密码会导致域环境稳定性受损（如DNS解析失效、域信任关系崩溃），这种‘破坏性利用’在不当操作下可能被误判为恶意投毒或拒绝服务攻击。第三，POC中提供的‘恢复步骤’需谨慎执行，避免造成生产环境不可逆的损坏。整体来看，该POC本身属于安全研究范畴的工具，投毒风险处于较低水平（10%左右），风险主要来自于工具被恶意修改后的二次传播。

**项目地址:** [https://github.com/dirkjanm/CVE-2020-1472](https://github.com/dirkjanm/CVE-2020-1472)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)
