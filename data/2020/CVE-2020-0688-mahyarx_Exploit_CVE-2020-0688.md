# CVE-2020-0688

> 📦 该CVE有 **24** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-0688-1337-llama_CVE-2020-0688-Python3.md](../2020/CVE-2020-0688-1337-llama_CVE-2020-0688-Python3.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** MS Exchange Server 2010 SP3 up to 2019 CU4

**利用条件:** 需要有效的Exchange用户凭证或者能够绕过身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是一个存在于 Microsoft Exchange Server 的远程代码执行漏洞。该漏洞源于 Exchange 控制面板 (ECP) 未能正确处理内存中的对象。攻击者可以通过向服务器发送特制的序列化对象，利用 ViewState 机制进行反序列化操作，从而执行任意代码。漏洞利用通常涉及以下步骤：

1.  **获取有效的Exchange用户凭证：** 攻击者需要拥有Exchange服务器上一个有效用户的用户名和密码。这可以通过多种方式实现，例如网络钓鱼。
2.  **构造恶意 ViewState：** 攻击者构造一个包含恶意代码的 ViewState。该 ViewState 利用 .NET 反序列化漏洞，在服务器上执行攻击者指定的命令。
3.  **发送请求：** 攻击者将包含恶意 ViewState 的请求发送到 Exchange 服务器的 ECP 页面（例如，`/ecp/default.aspx`）。
4.  **执行代码：** Exchange 服务器反序列化 ViewState，执行攻击者提供的恶意代码。

**有效性：** 根据漏洞信息和搜索结果，以及提供的PoC代码，此漏洞是有效的，并且在野外被积极利用。

**投毒风险：** PoC 代码本身包含利用漏洞的代码，主要功能是发送构造好的恶意请求以执行命令。  虽然PoC的目的是展示漏洞利用，但仍需检查是否存在隐藏的后门或恶意功能。 提供的PoC代码来自Packet Storm，并经过了Python3的兼容性修改。代码本身没有明显的恶意行为，但仍存在潜在风险，无法完全排除投毒的可能性。风险评估在10%的原因是，代码中包含从外部站点获取的信息，存在潜在的不确定性。

**利用方式：** 攻击者首先需要获取有效的Exchange用户凭证。然后，利用这些凭证登录到Exchange控制面板，并发送包含恶意构造的ViewState的POST请求。  该ViewState会触发.NET反序列化漏洞，从而允许攻击者在Exchange服务器上执行任意代码。常见的利用方式是添加新的管理员用户，或者执行系统命令来控制服务器。

**项目地址:** [1337-llama/CVE-2020-0688-Python3](https://github.com/1337-llama/CVE-2020-0688-Python3)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #2

**来源**: [CVE-2020-0688-7heKnight_CVE-2020-0688.md](../2020/CVE-2020-0688-7heKnight_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要具有Exchange Control Panel (ECP) 的访问权限和有效的Exchange用户凭据。也需要能够访问服务器上的特定URL。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 中的远程代码执行漏洞，该漏洞源于 Exchange Control Panel (ECP) 在反序列化 ViewState 数据时使用了静态密钥。攻击者可以通过构造恶意的 ViewState 数据，利用这个静态密钥进行反序列化，从而在服务器上执行任意代码。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断该漏洞利用的有效性较高。搜索引擎结果中存在多个关于该漏洞的描述、利用和检测的文章，甚至有公开发布的POC代码。提供的 PowerShell 脚本 `CVE-2020-0688.ps1` 旨在生成恶意的 ViewState，攻击者可以将其注入到 ECP 请求中。

**投毒风险：** 分析提供的POC代码，`CVE-2020-0688.ps1` 脚本主要是生成ViewState，以及调用指定的xaml。`NULL-File.xml` 文件的功能是尝试通过 `Environment.GetEnvironmentVariable` 获取 Exchange 的安装路径，然后修改 `liveiderror.aspx` 文件。风险点在于，如果攻击者修改了 `NULL-File.xml`，他们可以写入任意内容到 `liveiderror.aspx`，甚至可能写入包含后门代码的webshell。因此，存在一定的投毒风险。虽然xml本身是为了利用漏洞，如果攻击者植入webshell到xml文件中进行利用，xml本身就是投毒文件。xml的目的是修改服务器上的文件。但因为给出的样本本身没有后门代码，所以认定投毒风险较低。

**利用方式：**

1.  **获取有效凭据：** 攻击者首先需要获得一个有效的 Exchange 用户账户的凭据。
2.  **计算 ViewStateGenerator：** 根据`/ecp`和目标URI（例如`auth/logon.aspx`）计算`__VIEWSTATEGENERATOR`的值，POC代码`CVE-2020-0688.ps1`正是用于计算和生成该值。
3.  **生成恶意 ViewState：** 使用 POC 脚本 `CVE-2020-0688.ps1` 和 `NULL-File.xml` 生成恶意的 `__VIEWSTATE`。脚本首先读取 `NULL-File.xml` 的内容，然后使用静态密钥进行序列化和签名，生成最终的 `__VIEWSTATE`。
4.  **发送恶意请求：** 攻击者将生成的恶意 `__VIEWSTATE` 和计算出的 `__VIEWSTATEGENERATOR` 注入到发送给 Exchange ECP 的 POST 请求中。例如，攻击者可以向 `autodiscover/autodiscover.xml` 或 `ecp/default.aspx` 发送包含恶意 ViewState 的请求。
5.  **执行代码：** 当 Exchange 服务器处理包含恶意 ViewState 的请求时，由于静态密钥的存在，反序列化过程会成功执行，从而触发 `NULL-File.xml` 中定义的恶意操作，例如写入文件或执行任意代码。

通过以上步骤，攻击者可以利用 CVE-2020-0688 漏洞在未打补丁的 Exchange 服务器上实现远程代码执行，进而控制整个服务器。

**项目地址:** [7heKnight/CVE-2020-0688](https://github.com/7heKnight/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #3

**来源**: [CVE-2020-0688-Jumbo-WJB_CVE-2020-0688.md](../2020/CVE-2020-0688-Jumbo-WJB_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要有效的Exchange用户凭据（用户名和密码）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 中的远程代码执行漏洞，源于 Exchange Control Panel (ECP) 未能正确处理内存中的对象。该漏洞利用了静态的validationKey和generator，允许攻击者通过构造恶意的ViewState来反序列化任意对象，从而执行任意代码。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断此POC代码有效。搜索引擎结果中多次提到CVE-2020-0688被实际利用。PoC代码 `CVE-2020-0688.py` 的内容显示，它尝试利用Exchange的ECP接口，通过提供用户名和密码来获取`ASP.NET_SessionId`和`__VIEWSTATEGENERATOR`，然后使用ysoserial生成恶意的ViewState payload，并将其注入到请求中。

**投毒风险：**
分析 `CVE-2020-0688.py` 的代码，投毒风险较低，大约为5%。主要风险点在于：
*   该脚本依赖外部程序 `ysoserial.exe` 来生成payload，如果攻击者的 `ysoserial.exe` 被篡改，可能存在投毒风险。但是脚本本身没有执行恶意行为的迹象。
*  脚本在运行时会要求用户手动输入`ysoserial`命令生成的payload, 这增加了人工干预,降低了自动化攻击的可能，同时也降低了脚本本身被植入恶意代码的可能性。 

**利用方式：**
1.  **获取Exchange用户凭据：**  攻击者需要有效的Exchange用户凭据（用户名和密码）才能进行身份验证。
2.  **身份验证：**  使用提供的用户名和密码向 `/owa/auth.owa` 进行身份验证，获取 `ASP.NET_SessionId` 和 `__VIEWSTATEGENERATOR`。
3.  **生成恶意ViewState payload：** 使用 `ysoserial.exe` 工具，基于 `TextFormattingRunProperties` gadget chain，生成包含命令的ViewState payload。
4.  **发送恶意请求：**  将生成的ViewState payload 作为 `__VIEWSTATE` 参数，结合 `__VIEWSTATEGENERATOR` 参数，发送到 `/ecp/default.aspx`。服务器在处理ViewState时，会反序列化恶意对象，从而执行payload中的命令。

总而言之，利用该漏洞需要有效的Exchange用户凭据以及`ysoserial`工具，攻击者能够通过精心构造的ViewState payload在目标Exchange服务器上执行任意代码。

**项目地址:** [Jumbo-WJB/CVE-2020-0688](https://github.com/Jumbo-WJB/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #4

**来源**: [CVE-2020-0688-MrTiz_CVE-2020-0688.md](../2020/CVE-2020-0688-MrTiz_CVE-2020-0688.md)

## CVE-2020-0688-Microsoft Exchange Server-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可完全控制 Exchange 服务器

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要有效的 Exchange 用户凭据

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞。该漏洞源于 Exchange 控制面板 (ECP) 在处理 ViewState 时使用了静态密钥进行加密和签名。攻击者如果拥有有效的 Exchange 用户凭据，就可以利用该密钥构造恶意的 ViewState，从而在服务器上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，可以判断该漏洞利用是有效的。许多安全厂商和研究人员都发布了关于该漏洞的报告和 PoC，表明该漏洞已经得到广泛证实。

**投毒风险：**

提供的 PowerShell PoC 代码主要功能是利用已知的静态密钥来构造恶意的 ViewState，并在目标 Exchange 服务器上执行任意命令。代码中包含了身份验证、ViewState 生成、Payload 加密等步骤，没有发现明显的恶意代码或后门。但是，任何公开的漏洞利用代码都存在被篡改或植入恶意代码的风险，所以仍有一定的投毒可能性，大约10%。

**利用方式：**

1.  **获取 Exchange 用户凭据：** 攻击者首先需要获得一个有效的 Exchange 用户名和密码。这可以通过网络钓鱼、密码猜测等方式实现。
2.  **确定 ECP URL：** 攻击者需要确定目标 Exchange 服务器的 ECP URL，例如 `https://example.com/ecp`。
3.  **生成恶意 ViewState：** 利用 PoC 代码（例如提供的 PowerShell 脚本）结合 Ysoserial.exe 工具，使用静态密钥构造包含恶意命令的 ViewState。
4.  **发送请求：** 将包含恶意 ViewState 的请求发送到 ECP 页面，例如 `https://example.com/ecp/default.aspx`。
5.  **执行代码：** Exchange 服务器在处理请求时，会反序列化恶意 ViewState，从而执行攻击者指定的代码。

**缓解措施：**

*   立即安装 Microsoft 发布的 CVE-2020-0688 安全更新。
*   如果无法立即安装更新，可以采取临时缓解措施，例如禁用 ECP 访问或更改静态密钥。

**项目地址:** [MrTiz/CVE-2020-0688](https://github.com/MrTiz/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #5

**来源**: [CVE-2020-0688-Ridter_cve-2020-0688.md](../2020/CVE-2020-0688-Ridter_cve-2020-0688.md)

## CVE-2020-0688-Microsoft Exchange Server-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要有效的Exchange用户凭据（用户名和密码）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，源于 Exchange 控制面板 (ECP) 未能正确处理内存中的对象。攻击者可以通过拥有合法Exchange用户的凭据，利用静态密钥进行 ViewState 反序列化，从而在服务器上执行任意代码。

**有效性分析：**
根据漏洞库信息和搜索结果，CVE-2020-0688 是一个已被广泛利用的漏洞。提供的 POC 代码（0688-detect.py）旨在检测和利用此漏洞。从代码分析来看，该脚本首先尝试使用提供的凭据登录到 OWA。成功登录后，它会构造一个恶意的 ViewState payload，该 payload 利用了不安全的 ViewState 反序列化。然后，它通过发送带有特制 ViewState 的请求到 ECP 页面来触发漏洞，最终导致远程代码执行。

**投毒风险分析：**
审阅提供的`0688-detect.py` 脚本，并未发现明显的恶意或后门代码。脚本的功能是利用 CVE-2020-0688 漏洞进行远程代码执行。虽然脚本本身是为了攻击目的而编写，但这并不等同于投毒。`out_payload` 是该漏洞利用的关键部分，它包含用于触发漏洞的序列化对象。虽然脚本的目的是为了利用漏洞，增加了攻击风险，但从代码本身来看，不属于投毒行为，只是实现了漏洞利用。

但是考虑到github仓库本身的风险，以及代码中可能存在的细微修改，将投毒风险评估为10%。

**利用方式：**
1.  **获取凭据：** 攻击者需要拥有一个有效的 Microsoft Exchange 用户帐户的用户名和密码。这可能通过网络钓鱼、密码猜测或其他攻击手段获得。
2.  **身份验证：** 使用获得的凭据登录到 Exchange Webmail (OWA)。
3.  **构造 Payload：**  该 POC 脚本会构造一个恶意的 `__VIEWSTATE` 参数，其中包含一个经过特殊设计的序列化对象。该对象旨在利用 ViewState 的不安全反序列化机制来执行任意代码。
4.  **触发漏洞：**  将构造的 `__VIEWSTATE` 参数附加到对 ECP 页面的请求中，从而触发反序列化漏洞。服务器在处理该请求时，会反序列化恶意对象，从而执行攻击者指定的代码。
5.  **远程代码执行：** 成功利用漏洞后，攻击者可以在 Exchange 服务器上执行任意代码，从而完全控制服务器。


**项目地址:** [Ridter/cve-2020-0688](https://github.com/Ridter/cve-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #6

**来源**: [CVE-2020-0688-SLSteff_CVE-2020-0688-Scanner.md](../2020/CVE-2020-0688-SLSteff_CVE-2020-0688-Scanner.md)

## CVE-2020-0688-Microsoft Exchange-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange

**危害等级:** 高危，可能导致完全系统入侵

**影响版本:** 受影响版本包括但不限于Exchange Server 2010 SP3 UR30, Exchange Server 2013 CU23, Exchange Server 2016 CU14/15, Exchange Server 2019 CU3/4

**利用条件:** 需要OWA（Outlook Web Access）的访问权限以及有效的Exchange用户凭据或服务器的静态密钥（ValidationKey, DecryptionKey），如果服务器使用了默认密钥，则不需要用户凭据

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange 中存在的一个远程代码执行漏洞，源于 Exchange 在安装时未能正确创建唯一的密钥。攻击者可以利用此漏洞，通过构造恶意的请求，利用ViewState反序列化在服务器上执行任意代码。\n\n**漏洞利用方式：**\n1.  **获取密钥：** 攻击者需要首先获得目标 Exchange 服务器的 ValidationKey 和 DecryptionKey。这些密钥通常可以在 web.config 文件中找到。如果目标使用了默认密钥，利用则变得更加简单。\n2.  **构造恶意 ViewState：** 利用获得的密钥，攻击者可以构造一个包含恶意代码的 ViewState 对象。这个 ViewState 对象会被序列化并编码。\n3.  **发送恶意请求：** 攻击者将构造好的恶意 ViewState 对象作为请求参数发送到 Exchange 服务器的 OWA 接口 (例如`/ecp/default.aspx`)。\n4.  **执行代码：** Exchange 服务器在处理该请求时，会反序列化 ViewState 对象，从而执行攻击者嵌入的恶意代码。\n\n**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用是有效的。多个来源表明该漏洞已在野外被利用，且存在公开的 PoC 代码。

**投毒风险：**
提供的shell脚本主要用于扫描指定IP范围内的Exchange服务器，并识别可能存在CVE-2020-0688漏洞的版本。脚本的功能在于版本探测，而非直接的漏洞利用。尽管如此，仍然存在一定的投毒风险（大约10%），虽然扫描器本身没有明显的恶意代码，但存在以下可能性：\n*   **依赖项风险：** 脚本可能依赖于其他外部脚本或工具，这些依赖项可能包含恶意代码。\n*   **命令注入风险：** 尽管脚本本身没有明显的命令注入漏洞，但如果用户在使用脚本时没有正确处理输入，可能会引入命令注入漏洞。
*   **信息收集风险：** 扫描器会收集目标 Exchange 服务器的版本信息，这些信息可能被攻击者用于后续的攻击。
*   **伪装与欺骗：** 攻击者可能修改脚本，使其在扫描过程中执行恶意操作，例如植入后门或窃取凭据。由于此脚本会尝试与目标服务器进行交互，增加了被恶意利用的可能性。
*   **域名欺骗:** 此脚本中没有发现域名欺骗或IP地址欺骗的恶意行为。\n\n由于存在上述潜在风险，使用此脚本时务必谨慎，并确保从可信的来源获取。


**项目地址:** [SLSteff/CVE-2020-0688-Scanner](https://github.com/SLSteff/CVE-2020-0688-Scanner)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #7

**来源**: [CVE-2020-0688-W01fh4cker_CVE-2020-0688-GUI.md](../2020/CVE-2020-0688-W01fh4cker_CVE-2020-0688-GUI.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可完全控制受影响的Exchange服务器

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要OWA或ECP的访问权限，并且已知ValidationKey和DecryptionKey。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688是一个Microsoft Exchange Server中的远程代码执行漏洞。该漏洞是由于Exchange在安装时未能正确创建唯一的密钥导致的，攻击者可以利用已知的ValidationKey和DecryptionKey对ViewState进行反序列化，从而执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（GUI工具），可以判断该漏洞的POC代码是有效的。搜索引擎结果中多次提及该漏洞被野外利用，并且存在公开的POC和利用工具。

**投毒风险：**

分析提供的POC代码，主要是一个Visual Studio解决方案，包含C# GUI界面，用于简化漏洞利用过程，可以执行命令或加载shellcode。

*   **CVE-2020-0688-GUI.sln, CVE-2020-0688-GUI.csproj:** 正常的项目文件，定义了项目结构和依赖项。
*   **README.md:** 描述了项目目的、使用方法和作者信息。正常。
*   **App.xaml, App.xaml.cs:** 应用程序入口点和相关逻辑。正常。
*   **AssemblyInfo.cs:** 程序集信息。正常。
*   **资源文件:** 包含logo.ico和profile.png。正常。

总体来看，提供的代码主要是为了方便利用该漏洞，但并不能完全排除投毒的风险。可能存在的风险点在于：

1.  **Shellcode加载功能:** 如果攻击者提供包含恶意功能的shellcode，那么GUI工具仅仅是提供了一个执行的载体。用户如果使用了不可信来源的shellcode，则存在被攻击的风险。
2. **作者本身**：作者可能在编译好的二进制文件中加入恶意代码，但从提供的源码来看，没有发现明显的恶意代码。GUI工具本身的存在也可能误导使用者进行未授权的渗透测试，从而导致法律风险。

因此，投毒风险评估为10%。

**利用方式：**

利用CVE-2020-0688漏洞的典型方式如下：

1.  **获取ValidationKey和DecryptionKey：** 这是利用该漏洞的首要条件。可以通过多种方式获取，例如通过不安全的配置管理或密钥泄露。
2.  **构造恶意ViewState：** 攻击者使用已知的密钥构造恶意的ViewState，其中包含要执行的命令或shellcode。
3.  **发送请求：** 将构造的ViewState作为请求的一部分（通常是针对OWA或ECP）发送到目标Exchange服务器。
4.  **远程代码执行：** Exchange服务器在处理请求时，会反序列化ViewState，从而执行攻击者预先设定的代码。

**项目地址:** [W01fh4cker/CVE-2020-0688-GUI](https://github.com/W01fh4cker/CVE-2020-0688-GUI)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #8

**来源**: [CVE-2020-0688-Yt1g3r_CVE-2020-0688_EXP.md](../2020/CVE-2020-0688-Yt1g3r_CVE-2020-0688_EXP.md)

## CVE-2020-0688 - Microsoft Exchange Server 远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要Exchange服务器的OWA或ECP接口可访问，并具有有效的Exchange用户凭据

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 漏洞是 Microsoft Exchange Server 在处理内存中对象时，由于未能正确处理反序列化数据而导致的远程代码执行漏洞。该漏洞存在于 Exchange Control Panel (ECP) 组件中，攻击者可以利用静态密钥对 ViewState 进行恶意构造，从而在服务器上执行任意代码。

**有效性：**
提供的 Python POC 代码 `CVE-2020-0688_EXP.py` 是有效的。该脚本通过以下步骤利用该漏洞：

1.  **身份验证：** 使用提供的用户名和密码尝试登录 Exchange 的 OWA 接口。通过模拟用户登录过程，获取有效的 `ASP.NET_SessionId` Cookie，并获取 `__VIEWSTATEGENERATOR` 的值 (如果获取不到, 使用默认值).
2.  **Payload 生成：** 使用 `ysoserial.exe` 工具生成恶意的 ViewState payload。该 payload 包含攻击者想要执行的命令。POC 脚本使用了 TextFormattingRunProperties gadget。
3.  **Payload 注入：** 将生成的 payload 注入到 ECP 的 `default.aspx` 页面的 `__VIEWSTATE` 参数中，通过 GET 请求发送到服务器。
4.  **代码执行：** 如果服务器存在漏洞，并且 payload 构造正确，服务器将反序列化恶意的 ViewState payload，从而执行攻击者指定的命令。

**投毒风险：**
虽然该 POC 代码的主要功能是漏洞利用，但仍然存在一些潜在的投毒风险，风险评估为10%。

*   **依赖 ysoserial：** 该 POC 依赖于外部工具 `ysoserial.exe` 来生成 payload。攻击者可能会修改 `ysoserial.exe`，使其在生成 payload 的同时执行恶意操作，例如植入后门或收集敏感信息。用户需要从可信的来源下载 `ysoserial.exe`，并验证其完整性。

**利用方式：**
利用 CVE-2020-0688 漏洞的步骤如下：

1.  **获取凭据：** 攻击者需要获取有效的 Exchange 用户凭据。这可以通过钓鱼、密码猜测或利用其他漏洞来实现。
2.  **确定目标：** 攻击者需要确定目标 Exchange 服务器的 OWA 或 ECP URL。
3.  **生成 Payload：** 攻击者需要使用 `ysoserial.exe` 工具生成恶意的 ViewState payload，其中包含要执行的命令。
4.  **发送请求：** 攻击者需要将生成的 payload 注入到 ECP 的 `default.aspx` 页面的 `__VIEWSTATE` 参数中，通过 GET 请求发送到服务器。
5.  **执行代码：** 如果服务器存在漏洞，将执行攻击者指定的命令。

**项目地址:** [Yt1g3r/CVE-2020-0688_EXP](https://github.com/Yt1g3r/CVE-2020-0688_EXP)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #9

**来源**: [CVE-2020-0688-cert-lv_CVE-2020-0688.md](../2020/CVE-2020-0688-cert-lv_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 受影响版本包括：Microsoft Exchange Server 2010 SP3 UR30、2013 CU23、2016 CU14/CU15、2019 CU3/CU4

**利用条件:** 需要有效的Exchange用户凭据

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，它源于服务器未能正确处理内存中的对象。该漏洞是由于 Exchange 在安装时未能创建唯一的密钥导致的，攻击者可以利用静态密钥进行 ViewState 的反序列化攻击，从而执行任意代码。根据搜索结果和漏洞利用代码可知，此漏洞利用需要有效的 Exchange 用户凭据，并且该漏洞已经被积极利用。提供的漏洞利用代码 (scan.py) 主要用于识别易受攻击的 Exchange 服务器，而真正的漏洞利用还需要配合其他工具，例如ysoserial.net生成恶意ViewState。

**有效性：** 该漏洞的POC代码有效，可以用于检测存在漏洞的Exchange服务器。

**投毒风险：** 提供的`scan.py`和`lib.py`代码主要是用于扫描存在漏洞的服务器，没有直接包含恶意代码，但是仍然存在一定的投毒风险：
1. **依赖风险：**`scan.py`依赖于zmap以及一些python库，如果攻击者篡改了这些依赖项，可能会引入恶意代码。
2. **结果利用：** 扫描结果可能被攻击者用于识别易受攻击的服务器，从而发起进一步的攻击。 虽然该脚本本身看起来没有恶意投毒代码，但无法保证作者不会在未来版本中添加恶意代码。由于利用过程中需要用户本身具有一定权限，即使存在投毒代码，也需要用户执行才会触发。因此，综合评估投毒风险为10%。

**利用方式：**
1.  **获取用户凭据:** 攻击者首先需要获得Exchange用户的有效凭据(通常通过钓鱼等方式)。
2.  **识别漏洞服务器:** 使用类似于提供的`scan.py`脚本识别存在CVE-2020-0688漏洞的Exchange服务器。
3.  **生成恶意ViewState:** 利用ysoserial.net等工具，使用已知的静态密钥生成包含恶意代码的ViewState。
4.  **发送恶意请求:**  将包含恶意ViewState的请求发送到Exchange服务器的某个页面 (例如`/ecp/default.aspx`)，服务器反序列化ViewState时执行恶意代码，从而实现远程代码执行。

总的来说，CVE-2020-0688是一个严重的安全漏洞，需要及时修补。即使已经修补，也应该定期检查系统是否存在被入侵的痕迹。

**项目地址:** [cert-lv/CVE-2020-0688](https://github.com/cert-lv/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #10

**来源**: [CVE-2020-0688-chudamax_CVE-2020-0688-Exchange2010.md](../2020/CVE-2020-0688-chudamax_CVE-2020-0688-Exchange2010.md)

## CVE-2020-0688-Microsoft Exchange Server-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要获得Exchange用户的有效凭据（用户名和密码）和目标Exchange服务器的网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，原因是 Exchange 在安装时未能正确创建唯一的密钥。攻击者可以利用已知密钥对 ViewState 数据进行反序列化，从而在服务器上执行任意代码。

**漏洞利用方式：**

1.  **获取凭据：** 攻击者首先需要获取一个有效的 Exchange 用户名和密码。这可以通过网络钓鱼、密码猜测或其他凭据窃取技术实现。
2.  **身份验证：** 使用获取的凭据登录 Exchange 的 OWA (Outlook Web App) 或 ECP (Exchange Control Panel)。
3.  **ViewState 反序列化：** 攻击者构造一个恶意的 ViewState，其中包含要执行的命令。该 ViewState 使用已知的 MachineKeySection 密钥进行签名和加密。
4.  **发送请求：** 攻击者将包含恶意 ViewState 的请求发送到 Exchange 服务器的 ECP 页面（例如，`default.aspx`）。
5.  **远程代码执行：** Exchange 服务器使用已知的密钥解密和反序列化 ViewState。由于 ViewState 包含恶意代码，因此服务器会在当前进程的上下文中执行该代码。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，该漏洞利用是有效的。搜索引擎结果中包含了多个利用案例和警告，表明该漏洞已被广泛利用。

**投毒风险：**

提供的 POC 代码片段主要用于检测漏洞是否存在，并执行简单的命令。 虽然代码的目的是为了检测而非恶意活动， 但是仍需要注意。由于该漏洞允许远程代码执行，攻击者有可能可以替换检测 payload 为恶意 payload，从而进行投毒。因此存在一定的投毒风险。 由于代码相对简单，且目标明确，因此投毒风险较低，约10%。


**项目地址:** [chudamax/CVE-2020-0688-Exchange2010](https://github.com/chudamax/CVE-2020-0688-Exchange2010)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #11

**来源**: [CVE-2020-0688-justin-p_PSForgot2kEyXCHANGE.md](../2020/CVE-2020-0688-justin-p_PSForgot2kEyXCHANGE.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可完全控制 Exchange 服务器

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要有效的 Exchange 用户凭据 (用户名/密码) 和目标 Exchange 服务器未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，源于 Exchange 控制面板 (ECP) 未能正确处理内存中的对象。该漏洞允许经过身份验证的攻击者通过发送特制的请求到 Exchange 服务器执行任意代码。利用的关键在于静态密钥 `validationKey` 和 `decryptionKey` 的使用，攻击者利用这些密钥构造恶意的 ViewState 数据，将其发送到服务器，从而触发反序列化漏洞并执行恶意代码。PoC 代码 `PSForgot2kEyXCHANGE.ps1` 利用 ysoserial.net 生成恶意的 ViewState，通过 PowerShell 发送包含该 ViewState 的请求到 Exchange 服务器的 ECP 路径，从而实现远程代码执行。

**有效性:** 提供的 PoC 代码 `PSForgot2kEyXCHANGE.ps1` 看起来是有效的。它利用了 CVE-2020-0688 漏洞，通过构造恶意的 ViewState 数据来实现远程代码执行。搜索引擎结果中也有多个链接指向了关于该漏洞的利用和分析。

**投毒风险:**  `LICENSE.md` 文件是标准的 MIT 许可证，没有发现恶意代码。 `PSForgot2kEyXCHANGE.ps1` 本身是 PoC，但如果攻击者修改了 `-Command` 参数，就可以执行任意命令。PoC 主要功能是利用漏洞，而不是植入后门。但是，不排除作者在代码中加入一些隐蔽的、难以察觉的恶意代码（例如，在特定条件下执行某些操作）。考虑到作者贡献的其他安全工具的信誉，以及代码的复杂性，投毒风险评为10%。

**利用方式:**
1.  **获取用户凭据：** 攻击者需要拥有有效的 Exchange 用户名和密码。
2.  **定位目标 Exchange 服务器：** 确定未打补丁的 Exchange 服务器。
3.  **生成恶意 ViewState：** 使用 `PSForgot2kEyXCHANGE.ps1` 脚本和 ysoserial.net 工具，根据目标服务器的配置，生成包含恶意命令的 ViewState 数据。
4.  **发送恶意请求：** 将包含恶意 ViewState 的请求发送到 Exchange 服务器的 ECP 路径（例如，`/ecp/default.aspx`）。
5.  **执行任意代码：** 服务器反序列化 ViewState 数据，执行攻击者预先设定的恶意命令，从而实现远程代码执行。

**项目地址:** [justin-p/PSForgot2kEyXCHANGE](https://github.com/justin-p/PSForgot2kEyXCHANGE)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #12

**来源**: [CVE-2020-0688-ktpdpro_CVE-2020-0688.md](../2020/CVE-2020-0688-ktpdpro_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要Exchange Control Panel (ECP)可访问，且攻击者需要具有低权限的Exchange用户凭据

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688是Microsoft Exchange Server中的一个远程代码执行漏洞，该漏洞源于Exchange Control Panel (ECP)未能正确处理内存中的对象。成功利用此漏洞的攻击者可以在运行Exchange的服务器上以SYSTEM权限执行任意代码。利用方式通常涉及以下步骤：

1.  **获取有效凭据：** 攻击者首先需要获取一个有效的Exchange用户帐户的凭据，可以通过暴力破解、钓鱼或其他方式。
2.  **构造恶意请求：** 攻击者构造一个包含恶意序列化对象的特制HTTP请求，发送到Exchange服务器的ECP接口。这个请求通常利用了.NET ViewState的反序列化漏洞。
3.  **利用静态密钥：** 该漏洞的关键在于Exchange使用的静态密钥。攻击者利用此密钥来加密和签名ViewState数据，使其能够被服务器接受。
4.  **远程代码执行：** 当Exchange服务器处理恶意请求时，它会反序列化其中的对象，从而导致执行攻击者注入的任意代码，通常以SYSTEM权限运行。

根据提供的POC代码，该代码尝试通过`socket.socket(socket.AF_INET, socket.SOCK_RAW, socket.IPPROTO_RAW)`创建一个原始套接字来建立反向Bind Shell, 如果连接超时，将打印错误信息。同时还尝试从目标机器上通过GET方法获取IP，用户名等信息。这可能存在一定的投毒风险，作者可能将一些恶意代码隐藏在这些函数里，例如,收集用户信息的代码。考虑到风险，投毒风险评估为10%。

搜索引擎结果确认了该漏洞的存在和严重性，并指出有在野利用的案例。Rapid7的博客文章强调了攻击者如何利用此漏洞将任何被盗的Exchange用户帐户转变为完整的系统入侵。

总而言之，该漏洞利用的有效性较高，因为存在公开可用的POC代码和在野利用的报告。虽然POC本身可能没有明显的恶意投毒代码，但使用任何第三方提供的漏洞利用代码都应谨慎，因为其中可能包含未公开的恶意功能。

**项目地址:** [ktpdpro/CVE-2020-0688](https://github.com/ktpdpro/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #13

**来源**: [CVE-2020-0688-mahyarx_Exploit_CVE-2020-0688.md](../2020/CVE-2020-0688-mahyarx_Exploit_CVE-2020-0688.md)

# CVE-2020-0688

> 📦 该CVE有 **24** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-0688-1337-llama_CVE-2020-0688-Python3.md](../2020/CVE-2020-0688-1337-llama_CVE-2020-0688-Python3.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** MS Exchange Server 2010 SP3 up to 2019 CU4

**利用条件:** 需要有效的Exchange用户凭证或者能够绕过身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是一个存在于 Microsoft Exchange Server 的远程代码执行漏洞。该漏洞源于 Exchange 控制面板 (ECP) 未能正确处理内存中的对象。攻击者可以通过向服务器发送特制的序列化对象，利用 ViewState 机制进行反序列化操作，从而执行任意代码。漏洞利用通常涉及以下步骤：

1.  **获取有效的Exchange用户凭证：** 攻击者需要拥有Exchange服务器上一个有效用户的用户名和密码。这可以通过多种方式实现，例如网络钓鱼。
2.  **构造恶意 ViewState：** 攻击者构造一个包含恶意代码的 ViewState。该 ViewState 利用 .NET 反序列化漏洞，在服务器上执行攻击者指定的命令。
3.  **发送请求：** 攻击者将包含恶意 ViewState 的请求发送到 Exchange 服务器的 ECP 页面（例如，`/ecp/default.aspx`）。
4.  **执行代码：** Exchange 服务器反序列化 ViewState，执行攻击者提供的恶意代码。

**有效性：** 根据漏洞信息和搜索结果，以及提供的PoC代码，此漏洞是有效的，并且在野外被积极利用。

**投毒风险：** PoC 代码本身包含利用漏洞的代码，主要功能是发送构造好的恶意请求以执行命令。  虽然PoC的目的是展示漏洞利用，但仍需检查是否存在隐藏的后门或恶意功能。 提供的PoC代码来自Packet Storm，并经过了Python3的兼容性修改。代码本身没有明显的恶意行为，但仍存在潜在风险，无法完全排除投毒的可能性。风险评估在10%的原因是，代码中包含从外部站点获取的信息，存在潜在的不确定性。

**利用方式：** 攻击者首先需要获取有效的Exchange用户凭证。然后，利用这些凭证登录到Exchange控制面板，并发送包含恶意构造的ViewState的POST请求。  该ViewState会触发.NET反序列化漏洞，从而允许攻击者在Exchange服务器上执行任意代码。常见的利用方式是添加新的管理员用户，或者执行系统命令来控制服务器。

**项目地址:** [1337-llama/CVE-2020-0688-Python3](https://github.com/1337-llama/CVE-2020-0688-Python3)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #2

**来源**: [CVE-2020-0688-7heKnight_CVE-2020-0688.md](../2020/CVE-2020-0688-7heKnight_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要具有Exchange Control Panel (ECP) 的访问权限和有效的Exchange用户凭据。也需要能够访问服务器上的特定URL。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 中的远程代码执行漏洞，该漏洞源于 Exchange Control Panel (ECP) 在反序列化 ViewState 数据时使用了静态密钥。攻击者可以通过构造恶意的 ViewState 数据，利用这个静态密钥进行反序列化，从而在服务器上执行任意代码。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断该漏洞利用的有效性较高。搜索引擎结果中存在多个关于该漏洞的描述、利用和检测的文章，甚至有公开发布的POC代码。提供的 PowerShell 脚本 `CVE-2020-0688.ps1` 旨在生成恶意的 ViewState，攻击者可以将其注入到 ECP 请求中。

**投毒风险：** 分析提供的POC代码，`CVE-2020-0688.ps1` 脚本主要是生成ViewState，以及调用指定的xaml。`NULL-File.xml` 文件的功能是尝试通过 `Environment.GetEnvironmentVariable` 获取 Exchange 的安装路径，然后修改 `liveiderror.aspx` 文件。风险点在于，如果攻击者修改了 `NULL-File.xml`，他们可以写入任意内容到 `liveiderror.aspx`，甚至可能写入包含后门代码的webshell。因此，存在一定的投毒风险。虽然xml本身是为了利用漏洞，如果攻击者植入webshell到xml文件中进行利用，xml本身就是投毒文件。xml的目的是修改服务器上的文件。但因为给出的样本本身没有后门代码，所以认定投毒风险较低。

**利用方式：**

1.  **获取有效凭据：** 攻击者首先需要获得一个有效的 Exchange 用户账户的凭据。
2.  **计算 ViewStateGenerator：** 根据`/ecp`和目标URI（例如`auth/logon.aspx`）计算`__VIEWSTATEGENERATOR`的值，POC代码`CVE-2020-0688.ps1`正是用于计算和生成该值。
3.  **生成恶意 ViewState：** 使用 POC 脚本 `CVE-2020-0688.ps1` 和 `NULL-File.xml` 生成恶意的 `__VIEWSTATE`。脚本首先读取 `NULL-File.xml` 的内容，然后使用静态密钥进行序列化和签名，生成最终的 `__VIEWSTATE`。
4.  **发送恶意请求：** 攻击者将生成的恶意 `__VIEWSTATE` 和计算出的 `__VIEWSTATEGENERATOR` 注入到发送给 Exchange ECP 的 POST 请求中。例如，攻击者可以向 `autodiscover/autodiscover.xml` 或 `ecp/default.aspx` 发送包含恶意 ViewState 的请求。
5.  **执行代码：** 当 Exchange 服务器处理包含恶意 ViewState 的请求时，由于静态密钥的存在，反序列化过程会成功执行，从而触发 `NULL-File.xml` 中定义的恶意操作，例如写入文件或执行任意代码。

通过以上步骤，攻击者可以利用 CVE-2020-0688 漏洞在未打补丁的 Exchange 服务器上实现远程代码执行，进而控制整个服务器。

**项目地址:** [7heKnight/CVE-2020-0688](https://github.com/7heKnight/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #3

**来源**: [CVE-2020-0688-Jumbo-WJB_CVE-2020-0688.md](../2020/CVE-2020-0688-Jumbo-WJB_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要有效的Exchange用户凭据（用户名和密码）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 中的远程代码执行漏洞，源于 Exchange Control Panel (ECP) 未能正确处理内存中的对象。该漏洞利用了静态的validationKey和generator，允许攻击者通过构造恶意的ViewState来反序列化任意对象，从而执行任意代码。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断此POC代码有效。搜索引擎结果中多次提到CVE-2020-0688被实际利用。PoC代码 `CVE-2020-0688.py` 的内容显示，它尝试利用Exchange的ECP接口，通过提供用户名和密码来获取`ASP.NET_SessionId`和`__VIEWSTATEGENERATOR`，然后使用ysoserial生成恶意的ViewState payload，并将其注入到请求中。

**投毒风险：**
分析 `CVE-2020-0688.py` 的代码，投毒风险较低，大约为5%。主要风险点在于：
*   该脚本依赖外部程序 `ysoserial.exe` 来生成payload，如果攻击者的 `ysoserial.exe` 被篡改，可能存在投毒风险。但是脚本本身没有执行恶意行为的迹象。
*  脚本在运行时会要求用户手动输入`ysoserial`命令生成的payload, 这增加了人工干预,降低了自动化攻击的可能，同时也降低了脚本本身被植入恶意代码的可能性。 

**利用方式：**
1.  **获取Exchange用户凭据：**  攻击者需要有效的Exchange用户凭据（用户名和密码）才能进行身份验证。
2.  **身份验证：**  使用提供的用户名和密码向 `/owa/auth.owa` 进行身份验证，获取 `ASP.NET_SessionId` 和 `__VIEWSTATEGENERATOR`。
3.  **生成恶意ViewState payload：** 使用 `ysoserial.exe` 工具，基于 `TextFormattingRunProperties` gadget chain，生成包含命令的ViewState payload。
4.  **发送恶意请求：**  将生成的ViewState payload 作为 `__VIEWSTATE` 参数，结合 `__VIEWSTATEGENERATOR` 参数，发送到 `/ecp/default.aspx`。服务器在处理ViewState时，会反序列化恶意对象，从而执行payload中的命令。

总而言之，利用该漏洞需要有效的Exchange用户凭据以及`ysoserial`工具，攻击者能够通过精心构造的ViewState payload在目标Exchange服务器上执行任意代码。

**项目地址:** [Jumbo-WJB/CVE-2020-0688](https://github.com/Jumbo-WJB/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #4

**来源**: [CVE-2020-0688-MrTiz_CVE-2020-0688.md](../2020/CVE-2020-0688-MrTiz_CVE-2020-0688.md)

## CVE-2020-0688-Microsoft Exchange Server-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可完全控制 Exchange 服务器

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要有效的 Exchange 用户凭据

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞。该漏洞源于 Exchange 控制面板 (ECP) 在处理 ViewState 时使用了静态密钥进行加密和签名。攻击者如果拥有有效的 Exchange 用户凭据，就可以利用该密钥构造恶意的 ViewState，从而在服务器上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，可以判断该漏洞利用是有效的。许多安全厂商和研究人员都发布了关于该漏洞的报告和 PoC，表明该漏洞已经得到广泛证实。

**投毒风险：**

提供的 PowerShell PoC 代码主要功能是利用已知的静态密钥来构造恶意的 ViewState，并在目标 Exchange 服务器上执行任意命令。代码中包含了身份验证、ViewState 生成、Payload 加密等步骤，没有发现明显的恶意代码或后门。但是，任何公开的漏洞利用代码都存在被篡改或植入恶意代码的风险，所以仍有一定的投毒可能性，大约10%。

**利用方式：**

1.  **获取 Exchange 用户凭据：** 攻击者首先需要获得一个有效的 Exchange 用户名和密码。这可以通过网络钓鱼、密码猜测等方式实现。
2.  **确定 ECP URL：** 攻击者需要确定目标 Exchange 服务器的 ECP URL，例如 `https://example.com/ecp`。
3.  **生成恶意 ViewState：** 利用 PoC 代码（例如提供的 PowerShell 脚本）结合 Ysoserial.exe 工具，使用静态密钥构造包含恶意命令的 ViewState。
4.  **发送请求：** 将包含恶意 ViewState 的请求发送到 ECP 页面，例如 `https://example.com/ecp/default.aspx`。
5.  **执行代码：** Exchange 服务器在处理请求时，会反序列化恶意 ViewState，从而执行攻击者指定的代码。

**缓解措施：**

*   立即安装 Microsoft 发布的 CVE-2020-0688 安全更新。
*   如果无法立即安装更新，可以采取临时缓解措施，例如禁用 ECP 访问或更改静态密钥。

**项目地址:** [MrTiz/CVE-2020-0688](https://github.com/MrTiz/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #5

**来源**: [CVE-2020-0688-Ridter_cve-2020-0688.md](../2020/CVE-2020-0688-Ridter_cve-2020-0688.md)

## CVE-2020-0688-Microsoft Exchange Server-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要有效的Exchange用户凭据（用户名和密码）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，源于 Exchange 控制面板 (ECP) 未能正确处理内存中的对象。攻击者可以通过拥有合法Exchange用户的凭据，利用静态密钥进行 ViewState 反序列化，从而在服务器上执行任意代码。

**有效性分析：**
根据漏洞库信息和搜索结果，CVE-2020-0688 是一个已被广泛利用的漏洞。提供的 POC 代码（0688-detect.py）旨在检测和利用此漏洞。从代码分析来看，该脚本首先尝试使用提供的凭据登录到 OWA。成功登录后，它会构造一个恶意的 ViewState payload，该 payload 利用了不安全的 ViewState 反序列化。然后，它通过发送带有特制 ViewState 的请求到 ECP 页面来触发漏洞，最终导致远程代码执行。

**投毒风险分析：**
审阅提供的`0688-detect.py` 脚本，并未发现明显的恶意或后门代码。脚本的功能是利用 CVE-2020-0688 漏洞进行远程代码执行。虽然脚本本身是为了攻击目的而编写，但这并不等同于投毒。`out_payload` 是该漏洞利用的关键部分，它包含用于触发漏洞的序列化对象。虽然脚本的目的是为了利用漏洞，增加了攻击风险，但从代码本身来看，不属于投毒行为，只是实现了漏洞利用。

但是考虑到github仓库本身的风险，以及代码中可能存在的细微修改，将投毒风险评估为10%。

**利用方式：**
1.  **获取凭据：** 攻击者需要拥有一个有效的 Microsoft Exchange 用户帐户的用户名和密码。这可能通过网络钓鱼、密码猜测或其他攻击手段获得。
2.  **身份验证：** 使用获得的凭据登录到 Exchange Webmail (OWA)。
3.  **构造 Payload：**  该 POC 脚本会构造一个恶意的 `__VIEWSTATE` 参数，其中包含一个经过特殊设计的序列化对象。该对象旨在利用 ViewState 的不安全反序列化机制来执行任意代码。
4.  **触发漏洞：**  将构造的 `__VIEWSTATE` 参数附加到对 ECP 页面的请求中，从而触发反序列化漏洞。服务器在处理该请求时，会反序列化恶意对象，从而执行攻击者指定的代码。
5.  **远程代码执行：** 成功利用漏洞后，攻击者可以在 Exchange 服务器上执行任意代码，从而完全控制服务器。


**项目地址:** [Ridter/cve-2020-0688](https://github.com/Ridter/cve-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #6

**来源**: [CVE-2020-0688-SLSteff_CVE-2020-0688-Scanner.md](../2020/CVE-2020-0688-SLSteff_CVE-2020-0688-Scanner.md)

## CVE-2020-0688-Microsoft Exchange-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange

**危害等级:** 高危，可能导致完全系统入侵

**影响版本:** 受影响版本包括但不限于Exchange Server 2010 SP3 UR30, Exchange Server 2013 CU23, Exchange Server 2016 CU14/15, Exchange Server 2019 CU3/4

**利用条件:** 需要OWA（Outlook Web Access）的访问权限以及有效的Exchange用户凭据或服务器的静态密钥（ValidationKey, DecryptionKey），如果服务器使用了默认密钥，则不需要用户凭据

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange 中存在的一个远程代码执行漏洞，源于 Exchange 在安装时未能正确创建唯一的密钥。攻击者可以利用此漏洞，通过构造恶意的请求，利用ViewState反序列化在服务器上执行任意代码。\n\n**漏洞利用方式：**\n1.  **获取密钥：** 攻击者需要首先获得目标 Exchange 服务器的 ValidationKey 和 DecryptionKey。这些密钥通常可以在 web.config 文件中找到。如果目标使用了默认密钥，利用则变得更加简单。\n2.  **构造恶意 ViewState：** 利用获得的密钥，攻击者可以构造一个包含恶意代码的 ViewState 对象。这个 ViewState 对象会被序列化并编码。\n3.  **发送恶意请求：** 攻击者将构造好的恶意 ViewState 对象作为请求参数发送到 Exchange 服务器的 OWA 接口 (例如`/ecp/default.aspx`)。\n4.  **执行代码：** Exchange 服务器在处理该请求时，会反序列化 ViewState 对象，从而执行攻击者嵌入的恶意代码。\n\n**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用是有效的。多个来源表明该漏洞已在野外被利用，且存在公开的 PoC 代码。

**投毒风险：**
提供的shell脚本主要用于扫描指定IP范围内的Exchange服务器，并识别可能存在CVE-2020-0688漏洞的版本。脚本的功能在于版本探测，而非直接的漏洞利用。尽管如此，仍然存在一定的投毒风险（大约10%），虽然扫描器本身没有明显的恶意代码，但存在以下可能性：\n*   **依赖项风险：** 脚本可能依赖于其他外部脚本或工具，这些依赖项可能包含恶意代码。\n*   **命令注入风险：** 尽管脚本本身没有明显的命令注入漏洞，但如果用户在使用脚本时没有正确处理输入，可能会引入命令注入漏洞。
*   **信息收集风险：** 扫描器会收集目标 Exchange 服务器的版本信息，这些信息可能被攻击者用于后续的攻击。
*   **伪装与欺骗：** 攻击者可能修改脚本，使其在扫描过程中执行恶意操作，例如植入后门或窃取凭据。由于此脚本会尝试与目标服务器进行交互，增加了被恶意利用的可能性。
*   **域名欺骗:** 此脚本中没有发现域名欺骗或IP地址欺骗的恶意行为。\n\n由于存在上述潜在风险，使用此脚本时务必谨慎，并确保从可信的来源获取。


**项目地址:** [SLSteff/CVE-2020-0688-Scanner](https://github.com/SLSteff/CVE-2020-0688-Scanner)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #7

**来源**: [CVE-2020-0688-W01fh4cker_CVE-2020-0688-GUI.md](../2020/CVE-2020-0688-W01fh4cker_CVE-2020-0688-GUI.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可完全控制受影响的Exchange服务器

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要OWA或ECP的访问权限，并且已知ValidationKey和DecryptionKey。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688是一个Microsoft Exchange Server中的远程代码执行漏洞。该漏洞是由于Exchange在安装时未能正确创建唯一的密钥导致的，攻击者可以利用已知的ValidationKey和DecryptionKey对ViewState进行反序列化，从而执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（GUI工具），可以判断该漏洞的POC代码是有效的。搜索引擎结果中多次提及该漏洞被野外利用，并且存在公开的POC和利用工具。

**投毒风险：**

分析提供的POC代码，主要是一个Visual Studio解决方案，包含C# GUI界面，用于简化漏洞利用过程，可以执行命令或加载shellcode。

*   **CVE-2020-0688-GUI.sln, CVE-2020-0688-GUI.csproj:** 正常的项目文件，定义了项目结构和依赖项。
*   **README.md:** 描述了项目目的、使用方法和作者信息。正常。
*   **App.xaml, App.xaml.cs:** 应用程序入口点和相关逻辑。正常。
*   **AssemblyInfo.cs:** 程序集信息。正常。
*   **资源文件:** 包含logo.ico和profile.png。正常。

总体来看，提供的代码主要是为了方便利用该漏洞，但并不能完全排除投毒的风险。可能存在的风险点在于：

1.  **Shellcode加载功能:** 如果攻击者提供包含恶意功能的shellcode，那么GUI工具仅仅是提供了一个执行的载体。用户如果使用了不可信来源的shellcode，则存在被攻击的风险。
2. **作者本身**：作者可能在编译好的二进制文件中加入恶意代码，但从提供的源码来看，没有发现明显的恶意代码。GUI工具本身的存在也可能误导使用者进行未授权的渗透测试，从而导致法律风险。

因此，投毒风险评估为10%。

**利用方式：**

利用CVE-2020-0688漏洞的典型方式如下：

1.  **获取ValidationKey和DecryptionKey：** 这是利用该漏洞的首要条件。可以通过多种方式获取，例如通过不安全的配置管理或密钥泄露。
2.  **构造恶意ViewState：** 攻击者使用已知的密钥构造恶意的ViewState，其中包含要执行的命令或shellcode。
3.  **发送请求：** 将构造的ViewState作为请求的一部分（通常是针对OWA或ECP）发送到目标Exchange服务器。
4.  **远程代码执行：** Exchange服务器在处理请求时，会反序列化ViewState，从而执行攻击者预先设定的代码。

**项目地址:** [W01fh4cker/CVE-2020-0688-GUI](https://github.com/W01fh4cker/CVE-2020-0688-GUI)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #8

**来源**: [CVE-2020-0688-Yt1g3r_CVE-2020-0688_EXP.md](../2020/CVE-2020-0688-Yt1g3r_CVE-2020-0688_EXP.md)

## CVE-2020-0688 - Microsoft Exchange Server 远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要Exchange服务器的OWA或ECP接口可访问，并具有有效的Exchange用户凭据

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 漏洞是 Microsoft Exchange Server 在处理内存中对象时，由于未能正确处理反序列化数据而导致的远程代码执行漏洞。该漏洞存在于 Exchange Control Panel (ECP) 组件中，攻击者可以利用静态密钥对 ViewState 进行恶意构造，从而在服务器上执行任意代码。

**有效性：**
提供的 Python POC 代码 `CVE-2020-0688_EXP.py` 是有效的。该脚本通过以下步骤利用该漏洞：

1.  **身份验证：** 使用提供的用户名和密码尝试登录 Exchange 的 OWA 接口。通过模拟用户登录过程，获取有效的 `ASP.NET_SessionId` Cookie，并获取 `__VIEWSTATEGENERATOR` 的值 (如果获取不到, 使用默认值).
2.  **Payload 生成：** 使用 `ysoserial.exe` 工具生成恶意的 ViewState payload。该 payload 包含攻击者想要执行的命令。POC 脚本使用了 TextFormattingRunProperties gadget。
3.  **Payload 注入：** 将生成的 payload 注入到 ECP 的 `default.aspx` 页面的 `__VIEWSTATE` 参数中，通过 GET 请求发送到服务器。
4.  **代码执行：** 如果服务器存在漏洞，并且 payload 构造正确，服务器将反序列化恶意的 ViewState payload，从而执行攻击者指定的命令。

**投毒风险：**
虽然该 POC 代码的主要功能是漏洞利用，但仍然存在一些潜在的投毒风险，风险评估为10%。

*   **依赖 ysoserial：** 该 POC 依赖于外部工具 `ysoserial.exe` 来生成 payload。攻击者可能会修改 `ysoserial.exe`，使其在生成 payload 的同时执行恶意操作，例如植入后门或收集敏感信息。用户需要从可信的来源下载 `ysoserial.exe`，并验证其完整性。

**利用方式：**
利用 CVE-2020-0688 漏洞的步骤如下：

1.  **获取凭据：** 攻击者需要获取有效的 Exchange 用户凭据。这可以通过钓鱼、密码猜测或利用其他漏洞来实现。
2.  **确定目标：** 攻击者需要确定目标 Exchange 服务器的 OWA 或 ECP URL。
3.  **生成 Payload：** 攻击者需要使用 `ysoserial.exe` 工具生成恶意的 ViewState payload，其中包含要执行的命令。
4.  **发送请求：** 攻击者需要将生成的 payload 注入到 ECP 的 `default.aspx` 页面的 `__VIEWSTATE` 参数中，通过 GET 请求发送到服务器。
5.  **执行代码：** 如果服务器存在漏洞，将执行攻击者指定的命令。

**项目地址:** [Yt1g3r/CVE-2020-0688_EXP](https://github.com/Yt1g3r/CVE-2020-0688_EXP)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #9

**来源**: [CVE-2020-0688-cert-lv_CVE-2020-0688.md](../2020/CVE-2020-0688-cert-lv_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 受影响版本包括：Microsoft Exchange Server 2010 SP3 UR30、2013 CU23、2016 CU14/CU15、2019 CU3/CU4

**利用条件:** 需要有效的Exchange用户凭据

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，它源于服务器未能正确处理内存中的对象。该漏洞是由于 Exchange 在安装时未能创建唯一的密钥导致的，攻击者可以利用静态密钥进行 ViewState 的反序列化攻击，从而执行任意代码。根据搜索结果和漏洞利用代码可知，此漏洞利用需要有效的 Exchange 用户凭据，并且该漏洞已经被积极利用。提供的漏洞利用代码 (scan.py) 主要用于识别易受攻击的 Exchange 服务器，而真正的漏洞利用还需要配合其他工具，例如ysoserial.net生成恶意ViewState。

**有效性：** 该漏洞的POC代码有效，可以用于检测存在漏洞的Exchange服务器。

**投毒风险：** 提供的`scan.py`和`lib.py`代码主要是用于扫描存在漏洞的服务器，没有直接包含恶意代码，但是仍然存在一定的投毒风险：
1. **依赖风险：**`scan.py`依赖于zmap以及一些python库，如果攻击者篡改了这些依赖项，可能会引入恶意代码。
2. **结果利用：** 扫描结果可能被攻击者用于识别易受攻击的服务器，从而发起进一步的攻击。 虽然该脚本本身看起来没有恶意投毒代码，但无法保证作者不会在未来版本中添加恶意代码。由于利用过程中需要用户本身具有一定权限，即使存在投毒代码，也需要用户执行才会触发。因此，综合评估投毒风险为10%。

**利用方式：**
1.  **获取用户凭据:** 攻击者首先需要获得Exchange用户的有效凭据(通常通过钓鱼等方式)。
2.  **识别漏洞服务器:** 使用类似于提供的`scan.py`脚本识别存在CVE-2020-0688漏洞的Exchange服务器。
3.  **生成恶意ViewState:** 利用ysoserial.net等工具，使用已知的静态密钥生成包含恶意代码的ViewState。
4.  **发送恶意请求:**  将包含恶意ViewState的请求发送到Exchange服务器的某个页面 (例如`/ecp/default.aspx`)，服务器反序列化ViewState时执行恶意代码，从而实现远程代码执行。

总的来说，CVE-2020-0688是一个严重的安全漏洞，需要及时修补。即使已经修补，也应该定期检查系统是否存在被入侵的痕迹。

**项目地址:** [cert-lv/CVE-2020-0688](https://github.com/cert-lv/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #10

**来源**: [CVE-2020-0688-chudamax_CVE-2020-0688-Exchange2010.md](../2020/CVE-2020-0688-chudamax_CVE-2020-0688-Exchange2010.md)

## CVE-2020-0688-Microsoft Exchange Server-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要获得Exchange用户的有效凭据（用户名和密码）和目标Exchange服务器的网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，原因是 Exchange 在安装时未能正确创建唯一的密钥。攻击者可以利用已知密钥对 ViewState 数据进行反序列化，从而在服务器上执行任意代码。

**漏洞利用方式：**

1.  **获取凭据：** 攻击者首先需要获取一个有效的 Exchange 用户名和密码。这可以通过网络钓鱼、密码猜测或其他凭据窃取技术实现。
2.  **身份验证：** 使用获取的凭据登录 Exchange 的 OWA (Outlook Web App) 或 ECP (Exchange Control Panel)。
3.  **ViewState 反序列化：** 攻击者构造一个恶意的 ViewState，其中包含要执行的命令。该 ViewState 使用已知的 MachineKeySection 密钥进行签名和加密。
4.  **发送请求：** 攻击者将包含恶意 ViewState 的请求发送到 Exchange 服务器的 ECP 页面（例如，`default.aspx`）。
5.  **远程代码执行：** Exchange 服务器使用已知的密钥解密和反序列化 ViewState。由于 ViewState 包含恶意代码，因此服务器会在当前进程的上下文中执行该代码。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，该漏洞利用是有效的。搜索引擎结果中包含了多个利用案例和警告，表明该漏洞已被广泛利用。

**投毒风险：**

提供的 POC 代码片段主要用于检测漏洞是否存在，并执行简单的命令。 虽然代码的目的是为了检测而非恶意活动， 但是仍需要注意。由于该漏洞允许远程代码执行，攻击者有可能可以替换检测 payload 为恶意 payload，从而进行投毒。因此存在一定的投毒风险。 由于代码相对简单，且目标明确，因此投毒风险较低，约10%。


**项目地址:** [chudamax/CVE-2020-0688-Exchange2010](https://github.com/chudamax/CVE-2020-0688-Exchange2010)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #11

**来源**: [CVE-2020-0688-justin-p_PSForgot2kEyXCHANGE.md](../2020/CVE-2020-0688-justin-p_PSForgot2kEyXCHANGE.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可完全控制 Exchange 服务器

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要有效的 Exchange 用户凭据 (用户名/密码) 和目标 Exchange 服务器未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，源于 Exchange 控制面板 (ECP) 未能正确处理内存中的对象。该漏洞允许经过身份验证的攻击者通过发送特制的请求到 Exchange 服务器执行任意代码。利用的关键在于静态密钥 `validationKey` 和 `decryptionKey` 的使用，攻击者利用这些密钥构造恶意的 ViewState 数据，将其发送到服务器，从而触发反序列化漏洞并执行恶意代码。PoC 代码 `PSForgot2kEyXCHANGE.ps1` 利用 ysoserial.net 生成恶意的 ViewState，通过 PowerShell 发送包含该 ViewState 的请求到 Exchange 服务器的 ECP 路径，从而实现远程代码执行。

**有效性:** 提供的 PoC 代码 `PSForgot2kEyXCHANGE.ps1` 看起来是有效的。它利用了 CVE-2020-0688 漏洞，通过构造恶意的 ViewState 数据来实现远程代码执行。搜索引擎结果中也有多个链接指向了关于该漏洞的利用和分析。

**投毒风险:**  `LICENSE.md` 文件是标准的 MIT 许可证，没有发现恶意代码。 `PSForgot2kEyXCHANGE.ps1` 本身是 PoC，但如果攻击者修改了 `-Command` 参数，就可以执行任意命令。PoC 主要功能是利用漏洞，而不是植入后门。但是，不排除作者在代码中加入一些隐蔽的、难以察觉的恶意代码（例如，在特定条件下执行某些操作）。考虑到作者贡献的其他安全工具的信誉，以及代码的复杂性，投毒风险评为10%。

**利用方式:**
1.  **获取用户凭据：** 攻击者需要拥有有效的 Exchange 用户名和密码。
2.  **定位目标 Exchange 服务器：** 确定未打补丁的 Exchange 服务器。
3.  **生成恶意 ViewState：** 使用 `PSForgot2kEyXCHANGE.ps1` 脚本和 ysoserial.net 工具，根据目标服务器的配置，生成包含恶意命令的 ViewState 数据。
4.  **发送恶意请求：** 将包含恶意 ViewState 的请求发送到 Exchange 服务器的 ECP 路径（例如，`/ecp/default.aspx`）。
5.  **执行任意代码：** 服务器反序列化 ViewState 数据，执行攻击者预先设定的恶意命令，从而实现远程代码执行。

**项目地址:** [justin-p/PSForgot2kEyXCHANGE](https://github.com/justin-p/PSForgot2kEyXCHANGE)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #12

**来源**: [CVE-2020-0688-ktpdpro_CVE-2020-0688.md](../2020/CVE-2020-0688-ktpdpro_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要Exchange Control Panel (ECP)可访问，且攻击者需要具有低权限的Exchange用户凭据

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688是Microsoft Exchange Server中的一个远程代码执行漏洞，该漏洞源于Exchange Control Panel (ECP)未能正确处理内存中的对象。成功利用此漏洞的攻击者可以在运行Exchange的服务器上以SYSTEM权限执行任意代码。利用方式通常涉及以下步骤：

1.  **获取有效凭据：** 攻击者首先需要获取一个有效的Exchange用户帐户的凭据，可以通过暴力破解、钓鱼或其他方式。
2.  **构造恶意请求：** 攻击者构造一个包含恶意序列化对象的特制HTTP请求，发送到Exchange服务器的ECP接口。这个请求通常利用了.NET ViewState的反序列化漏洞。
3.  **利用静态密钥：** 该漏洞的关键在于Exchange使用的静态密钥。攻击者利用此密钥来加密和签名ViewState数据，使其能够被服务器接受。
4.  **远程代码执行：** 当Exchange服务器处理恶意请求时，它会反序列化其中的对象，从而导致执行攻击者注入的任意代码，通常以SYSTEM权限运行。

根据提供的POC代码，该代码尝试通过`socket.socket(socket.AF_INET, socket.SOCK_RAW, socket.IPPROTO_RAW)`创建一个原始套接字来建立反向Bind Shell, 如果连接超时，将打印错误信息。同时还尝试从目标机器上通过GET方法获取IP，用户名等信息。这可能存在一定的投毒风险，作者可能将一些恶意代码隐藏在这些函数里，例如,收集用户信息的代码。考虑到风险，投毒风险评估为10%。

搜索引擎结果确认了该漏洞的存在和严重性，并指出有在野利用的案例。Rapid7的博客文章强调了攻击者如何利用此漏洞将任何被盗的Exchange用户帐户转变为完整的系统入侵。

总而言之，该漏洞利用的有效性较高，因为存在公开可用的POC代码和在野利用的报告。虽然POC本身可能没有明显的恶意投毒代码，但使用任何第三方提供的漏洞利用代码都应谨慎，因为其中可能包含未公开的恶意功能。

**项目地址:** [ktpdpro/CVE-2020-0688](https://github.com/ktpdpro/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #13

**来源**: [CVE-2020-0688-mahyarx_Exploit_CVE-2020-0688.md](../2020/CVE-2020-0688-mahyarx_Exploit_CVE-2020-0688.md)

# CVE-2020-0688

> 📦 该CVE有 **24** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-0688-1337-llama_CVE-2020-0688-Python3.md](../2020/CVE-2020-0688-1337-llama_CVE-2020-0688-Python3.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** MS Exchange Server 2010 SP3 up to 2019 CU4

**利用条件:** 需要有效的Exchange用户凭证或者能够绕过身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是一个存在于 Microsoft Exchange Server 的远程代码执行漏洞。该漏洞源于 Exchange 控制面板 (ECP) 未能正确处理内存中的对象。攻击者可以通过向服务器发送特制的序列化对象，利用 ViewState 机制进行反序列化操作，从而执行任意代码。漏洞利用通常涉及以下步骤：

1.  **获取有效的Exchange用户凭证：** 攻击者需要拥有Exchange服务器上一个有效用户的用户名和密码。这可以通过多种方式实现，例如网络钓鱼。
2.  **构造恶意 ViewState：** 攻击者构造一个包含恶意代码的 ViewState。该 ViewState 利用 .NET 反序列化漏洞，在服务器上执行攻击者指定的命令。
3.  **发送请求：** 攻击者将包含恶意 ViewState 的请求发送到 Exchange 服务器的 ECP 页面（例如，`/ecp/default.aspx`）。
4.  **执行代码：** Exchange 服务器反序列化 ViewState，执行攻击者提供的恶意代码。

**有效性：** 根据漏洞信息和搜索结果，以及提供的PoC代码，此漏洞是有效的，并且在野外被积极利用。

**投毒风险：** PoC 代码本身包含利用漏洞的代码，主要功能是发送构造好的恶意请求以执行命令。  虽然PoC的目的是展示漏洞利用，但仍需检查是否存在隐藏的后门或恶意功能。 提供的PoC代码来自Packet Storm，并经过了Python3的兼容性修改。代码本身没有明显的恶意行为，但仍存在潜在风险，无法完全排除投毒的可能性。风险评估在10%的原因是，代码中包含从外部站点获取的信息，存在潜在的不确定性。

**利用方式：** 攻击者首先需要获取有效的Exchange用户凭证。然后，利用这些凭证登录到Exchange控制面板，并发送包含恶意构造的ViewState的POST请求。  该ViewState会触发.NET反序列化漏洞，从而允许攻击者在Exchange服务器上执行任意代码。常见的利用方式是添加新的管理员用户，或者执行系统命令来控制服务器。

**项目地址:** [1337-llama/CVE-2020-0688-Python3](https://github.com/1337-llama/CVE-2020-0688-Python3)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #2

**来源**: [CVE-2020-0688-7heKnight_CVE-2020-0688.md](../2020/CVE-2020-0688-7heKnight_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要具有Exchange Control Panel (ECP) 的访问权限和有效的Exchange用户凭据。也需要能够访问服务器上的特定URL。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 中的远程代码执行漏洞，该漏洞源于 Exchange Control Panel (ECP) 在反序列化 ViewState 数据时使用了静态密钥。攻击者可以通过构造恶意的 ViewState 数据，利用这个静态密钥进行反序列化，从而在服务器上执行任意代码。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断该漏洞利用的有效性较高。搜索引擎结果中存在多个关于该漏洞的描述、利用和检测的文章，甚至有公开发布的POC代码。提供的 PowerShell 脚本 `CVE-2020-0688.ps1` 旨在生成恶意的 ViewState，攻击者可以将其注入到 ECP 请求中。

**投毒风险：** 分析提供的POC代码，`CVE-2020-0688.ps1` 脚本主要是生成ViewState，以及调用指定的xaml。`NULL-File.xml` 文件的功能是尝试通过 `Environment.GetEnvironmentVariable` 获取 Exchange 的安装路径，然后修改 `liveiderror.aspx` 文件。风险点在于，如果攻击者修改了 `NULL-File.xml`，他们可以写入任意内容到 `liveiderror.aspx`，甚至可能写入包含后门代码的webshell。因此，存在一定的投毒风险。虽然xml本身是为了利用漏洞，如果攻击者植入webshell到xml文件中进行利用，xml本身就是投毒文件。xml的目的是修改服务器上的文件。但因为给出的样本本身没有后门代码，所以认定投毒风险较低。

**利用方式：**

1.  **获取有效凭据：** 攻击者首先需要获得一个有效的 Exchange 用户账户的凭据。
2.  **计算 ViewStateGenerator：** 根据`/ecp`和目标URI（例如`auth/logon.aspx`）计算`__VIEWSTATEGENERATOR`的值，POC代码`CVE-2020-0688.ps1`正是用于计算和生成该值。
3.  **生成恶意 ViewState：** 使用 POC 脚本 `CVE-2020-0688.ps1` 和 `NULL-File.xml` 生成恶意的 `__VIEWSTATE`。脚本首先读取 `NULL-File.xml` 的内容，然后使用静态密钥进行序列化和签名，生成最终的 `__VIEWSTATE`。
4.  **发送恶意请求：** 攻击者将生成的恶意 `__VIEWSTATE` 和计算出的 `__VIEWSTATEGENERATOR` 注入到发送给 Exchange ECP 的 POST 请求中。例如，攻击者可以向 `autodiscover/autodiscover.xml` 或 `ecp/default.aspx` 发送包含恶意 ViewState 的请求。
5.  **执行代码：** 当 Exchange 服务器处理包含恶意 ViewState 的请求时，由于静态密钥的存在，反序列化过程会成功执行，从而触发 `NULL-File.xml` 中定义的恶意操作，例如写入文件或执行任意代码。

通过以上步骤，攻击者可以利用 CVE-2020-0688 漏洞在未打补丁的 Exchange 服务器上实现远程代码执行，进而控制整个服务器。

**项目地址:** [7heKnight/CVE-2020-0688](https://github.com/7heKnight/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #3

**来源**: [CVE-2020-0688-Jumbo-WJB_CVE-2020-0688.md](../2020/CVE-2020-0688-Jumbo-WJB_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要有效的Exchange用户凭据（用户名和密码）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 中的远程代码执行漏洞，源于 Exchange Control Panel (ECP) 未能正确处理内存中的对象。该漏洞利用了静态的validationKey和generator，允许攻击者通过构造恶意的ViewState来反序列化任意对象，从而执行任意代码。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断此POC代码有效。搜索引擎结果中多次提到CVE-2020-0688被实际利用。PoC代码 `CVE-2020-0688.py` 的内容显示，它尝试利用Exchange的ECP接口，通过提供用户名和密码来获取`ASP.NET_SessionId`和`__VIEWSTATEGENERATOR`，然后使用ysoserial生成恶意的ViewState payload，并将其注入到请求中。

**投毒风险：**
分析 `CVE-2020-0688.py` 的代码，投毒风险较低，大约为5%。主要风险点在于：
*   该脚本依赖外部程序 `ysoserial.exe` 来生成payload，如果攻击者的 `ysoserial.exe` 被篡改，可能存在投毒风险。但是脚本本身没有执行恶意行为的迹象。
*  脚本在运行时会要求用户手动输入`ysoserial`命令生成的payload, 这增加了人工干预,降低了自动化攻击的可能，同时也降低了脚本本身被植入恶意代码的可能性。 

**利用方式：**
1.  **获取Exchange用户凭据：**  攻击者需要有效的Exchange用户凭据（用户名和密码）才能进行身份验证。
2.  **身份验证：**  使用提供的用户名和密码向 `/owa/auth.owa` 进行身份验证，获取 `ASP.NET_SessionId` 和 `__VIEWSTATEGENERATOR`。
3.  **生成恶意ViewState payload：** 使用 `ysoserial.exe` 工具，基于 `TextFormattingRunProperties` gadget chain，生成包含命令的ViewState payload。
4.  **发送恶意请求：**  将生成的ViewState payload 作为 `__VIEWSTATE` 参数，结合 `__VIEWSTATEGENERATOR` 参数，发送到 `/ecp/default.aspx`。服务器在处理ViewState时，会反序列化恶意对象，从而执行payload中的命令。

总而言之，利用该漏洞需要有效的Exchange用户凭据以及`ysoserial`工具，攻击者能够通过精心构造的ViewState payload在目标Exchange服务器上执行任意代码。

**项目地址:** [Jumbo-WJB/CVE-2020-0688](https://github.com/Jumbo-WJB/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #4

**来源**: [CVE-2020-0688-MrTiz_CVE-2020-0688.md](../2020/CVE-2020-0688-MrTiz_CVE-2020-0688.md)

## CVE-2020-0688-Microsoft Exchange Server-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可完全控制 Exchange 服务器

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要有效的 Exchange 用户凭据

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞。该漏洞源于 Exchange 控制面板 (ECP) 在处理 ViewState 时使用了静态密钥进行加密和签名。攻击者如果拥有有效的 Exchange 用户凭据，就可以利用该密钥构造恶意的 ViewState，从而在服务器上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，可以判断该漏洞利用是有效的。许多安全厂商和研究人员都发布了关于该漏洞的报告和 PoC，表明该漏洞已经得到广泛证实。

**投毒风险：**

提供的 PowerShell PoC 代码主要功能是利用已知的静态密钥来构造恶意的 ViewState，并在目标 Exchange 服务器上执行任意命令。代码中包含了身份验证、ViewState 生成、Payload 加密等步骤，没有发现明显的恶意代码或后门。但是，任何公开的漏洞利用代码都存在被篡改或植入恶意代码的风险，所以仍有一定的投毒可能性，大约10%。

**利用方式：**

1.  **获取 Exchange 用户凭据：** 攻击者首先需要获得一个有效的 Exchange 用户名和密码。这可以通过网络钓鱼、密码猜测等方式实现。
2.  **确定 ECP URL：** 攻击者需要确定目标 Exchange 服务器的 ECP URL，例如 `https://example.com/ecp`。
3.  **生成恶意 ViewState：** 利用 PoC 代码（例如提供的 PowerShell 脚本）结合 Ysoserial.exe 工具，使用静态密钥构造包含恶意命令的 ViewState。
4.  **发送请求：** 将包含恶意 ViewState 的请求发送到 ECP 页面，例如 `https://example.com/ecp/default.aspx`。
5.  **执行代码：** Exchange 服务器在处理请求时，会反序列化恶意 ViewState，从而执行攻击者指定的代码。

**缓解措施：**

*   立即安装 Microsoft 发布的 CVE-2020-0688 安全更新。
*   如果无法立即安装更新，可以采取临时缓解措施，例如禁用 ECP 访问或更改静态密钥。

**项目地址:** [MrTiz/CVE-2020-0688](https://github.com/MrTiz/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #5

**来源**: [CVE-2020-0688-Ridter_cve-2020-0688.md](../2020/CVE-2020-0688-Ridter_cve-2020-0688.md)

## CVE-2020-0688-Microsoft Exchange Server-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要有效的Exchange用户凭据（用户名和密码）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，源于 Exchange 控制面板 (ECP) 未能正确处理内存中的对象。攻击者可以通过拥有合法Exchange用户的凭据，利用静态密钥进行 ViewState 反序列化，从而在服务器上执行任意代码。

**有效性分析：**
根据漏洞库信息和搜索结果，CVE-2020-0688 是一个已被广泛利用的漏洞。提供的 POC 代码（0688-detect.py）旨在检测和利用此漏洞。从代码分析来看，该脚本首先尝试使用提供的凭据登录到 OWA。成功登录后，它会构造一个恶意的 ViewState payload，该 payload 利用了不安全的 ViewState 反序列化。然后，它通过发送带有特制 ViewState 的请求到 ECP 页面来触发漏洞，最终导致远程代码执行。

**投毒风险分析：**
审阅提供的`0688-detect.py` 脚本，并未发现明显的恶意或后门代码。脚本的功能是利用 CVE-2020-0688 漏洞进行远程代码执行。虽然脚本本身是为了攻击目的而编写，但这并不等同于投毒。`out_payload` 是该漏洞利用的关键部分，它包含用于触发漏洞的序列化对象。虽然脚本的目的是为了利用漏洞，增加了攻击风险，但从代码本身来看，不属于投毒行为，只是实现了漏洞利用。

但是考虑到github仓库本身的风险，以及代码中可能存在的细微修改，将投毒风险评估为10%。

**利用方式：**
1.  **获取凭据：** 攻击者需要拥有一个有效的 Microsoft Exchange 用户帐户的用户名和密码。这可能通过网络钓鱼、密码猜测或其他攻击手段获得。
2.  **身份验证：** 使用获得的凭据登录到 Exchange Webmail (OWA)。
3.  **构造 Payload：**  该 POC 脚本会构造一个恶意的 `__VIEWSTATE` 参数，其中包含一个经过特殊设计的序列化对象。该对象旨在利用 ViewState 的不安全反序列化机制来执行任意代码。
4.  **触发漏洞：**  将构造的 `__VIEWSTATE` 参数附加到对 ECP 页面的请求中，从而触发反序列化漏洞。服务器在处理该请求时，会反序列化恶意对象，从而执行攻击者指定的代码。
5.  **远程代码执行：** 成功利用漏洞后，攻击者可以在 Exchange 服务器上执行任意代码，从而完全控制服务器。


**项目地址:** [Ridter/cve-2020-0688](https://github.com/Ridter/cve-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #6

**来源**: [CVE-2020-0688-SLSteff_CVE-2020-0688-Scanner.md](../2020/CVE-2020-0688-SLSteff_CVE-2020-0688-Scanner.md)

## CVE-2020-0688-Microsoft Exchange-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange

**危害等级:** 高危，可能导致完全系统入侵

**影响版本:** 受影响版本包括但不限于Exchange Server 2010 SP3 UR30, Exchange Server 2013 CU23, Exchange Server 2016 CU14/15, Exchange Server 2019 CU3/4

**利用条件:** 需要OWA（Outlook Web Access）的访问权限以及有效的Exchange用户凭据或服务器的静态密钥（ValidationKey, DecryptionKey），如果服务器使用了默认密钥，则不需要用户凭据

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange 中存在的一个远程代码执行漏洞，源于 Exchange 在安装时未能正确创建唯一的密钥。攻击者可以利用此漏洞，通过构造恶意的请求，利用ViewState反序列化在服务器上执行任意代码。\n\n**漏洞利用方式：**\n1.  **获取密钥：** 攻击者需要首先获得目标 Exchange 服务器的 ValidationKey 和 DecryptionKey。这些密钥通常可以在 web.config 文件中找到。如果目标使用了默认密钥，利用则变得更加简单。\n2.  **构造恶意 ViewState：** 利用获得的密钥，攻击者可以构造一个包含恶意代码的 ViewState 对象。这个 ViewState 对象会被序列化并编码。\n3.  **发送恶意请求：** 攻击者将构造好的恶意 ViewState 对象作为请求参数发送到 Exchange 服务器的 OWA 接口 (例如`/ecp/default.aspx`)。\n4.  **执行代码：** Exchange 服务器在处理该请求时，会反序列化 ViewState 对象，从而执行攻击者嵌入的恶意代码。\n\n**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用是有效的。多个来源表明该漏洞已在野外被利用，且存在公开的 PoC 代码。

**投毒风险：**
提供的shell脚本主要用于扫描指定IP范围内的Exchange服务器，并识别可能存在CVE-2020-0688漏洞的版本。脚本的功能在于版本探测，而非直接的漏洞利用。尽管如此，仍然存在一定的投毒风险（大约10%），虽然扫描器本身没有明显的恶意代码，但存在以下可能性：\n*   **依赖项风险：** 脚本可能依赖于其他外部脚本或工具，这些依赖项可能包含恶意代码。\n*   **命令注入风险：** 尽管脚本本身没有明显的命令注入漏洞，但如果用户在使用脚本时没有正确处理输入，可能会引入命令注入漏洞。
*   **信息收集风险：** 扫描器会收集目标 Exchange 服务器的版本信息，这些信息可能被攻击者用于后续的攻击。
*   **伪装与欺骗：** 攻击者可能修改脚本，使其在扫描过程中执行恶意操作，例如植入后门或窃取凭据。由于此脚本会尝试与目标服务器进行交互，增加了被恶意利用的可能性。
*   **域名欺骗:** 此脚本中没有发现域名欺骗或IP地址欺骗的恶意行为。\n\n由于存在上述潜在风险，使用此脚本时务必谨慎，并确保从可信的来源获取。


**项目地址:** [SLSteff/CVE-2020-0688-Scanner](https://github.com/SLSteff/CVE-2020-0688-Scanner)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #7

**来源**: [CVE-2020-0688-W01fh4cker_CVE-2020-0688-GUI.md](../2020/CVE-2020-0688-W01fh4cker_CVE-2020-0688-GUI.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可完全控制受影响的Exchange服务器

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要OWA或ECP的访问权限，并且已知ValidationKey和DecryptionKey。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688是一个Microsoft Exchange Server中的远程代码执行漏洞。该漏洞是由于Exchange在安装时未能正确创建唯一的密钥导致的，攻击者可以利用已知的ValidationKey和DecryptionKey对ViewState进行反序列化，从而执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（GUI工具），可以判断该漏洞的POC代码是有效的。搜索引擎结果中多次提及该漏洞被野外利用，并且存在公开的POC和利用工具。

**投毒风险：**

分析提供的POC代码，主要是一个Visual Studio解决方案，包含C# GUI界面，用于简化漏洞利用过程，可以执行命令或加载shellcode。

*   **CVE-2020-0688-GUI.sln, CVE-2020-0688-GUI.csproj:** 正常的项目文件，定义了项目结构和依赖项。
*   **README.md:** 描述了项目目的、使用方法和作者信息。正常。
*   **App.xaml, App.xaml.cs:** 应用程序入口点和相关逻辑。正常。
*   **AssemblyInfo.cs:** 程序集信息。正常。
*   **资源文件:** 包含logo.ico和profile.png。正常。

总体来看，提供的代码主要是为了方便利用该漏洞，但并不能完全排除投毒的风险。可能存在的风险点在于：

1.  **Shellcode加载功能:** 如果攻击者提供包含恶意功能的shellcode，那么GUI工具仅仅是提供了一个执行的载体。用户如果使用了不可信来源的shellcode，则存在被攻击的风险。
2. **作者本身**：作者可能在编译好的二进制文件中加入恶意代码，但从提供的源码来看，没有发现明显的恶意代码。GUI工具本身的存在也可能误导使用者进行未授权的渗透测试，从而导致法律风险。

因此，投毒风险评估为10%。

**利用方式：**

利用CVE-2020-0688漏洞的典型方式如下：

1.  **获取ValidationKey和DecryptionKey：** 这是利用该漏洞的首要条件。可以通过多种方式获取，例如通过不安全的配置管理或密钥泄露。
2.  **构造恶意ViewState：** 攻击者使用已知的密钥构造恶意的ViewState，其中包含要执行的命令或shellcode。
3.  **发送请求：** 将构造的ViewState作为请求的一部分（通常是针对OWA或ECP）发送到目标Exchange服务器。
4.  **远程代码执行：** Exchange服务器在处理请求时，会反序列化ViewState，从而执行攻击者预先设定的代码。

**项目地址:** [W01fh4cker/CVE-2020-0688-GUI](https://github.com/W01fh4cker/CVE-2020-0688-GUI)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #8

**来源**: [CVE-2020-0688-Yt1g3r_CVE-2020-0688_EXP.md](../2020/CVE-2020-0688-Yt1g3r_CVE-2020-0688_EXP.md)

## CVE-2020-0688 - Microsoft Exchange Server 远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要Exchange服务器的OWA或ECP接口可访问，并具有有效的Exchange用户凭据

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 漏洞是 Microsoft Exchange Server 在处理内存中对象时，由于未能正确处理反序列化数据而导致的远程代码执行漏洞。该漏洞存在于 Exchange Control Panel (ECP) 组件中，攻击者可以利用静态密钥对 ViewState 进行恶意构造，从而在服务器上执行任意代码。

**有效性：**
提供的 Python POC 代码 `CVE-2020-0688_EXP.py` 是有效的。该脚本通过以下步骤利用该漏洞：

1.  **身份验证：** 使用提供的用户名和密码尝试登录 Exchange 的 OWA 接口。通过模拟用户登录过程，获取有效的 `ASP.NET_SessionId` Cookie，并获取 `__VIEWSTATEGENERATOR` 的值 (如果获取不到, 使用默认值).
2.  **Payload 生成：** 使用 `ysoserial.exe` 工具生成恶意的 ViewState payload。该 payload 包含攻击者想要执行的命令。POC 脚本使用了 TextFormattingRunProperties gadget。
3.  **Payload 注入：** 将生成的 payload 注入到 ECP 的 `default.aspx` 页面的 `__VIEWSTATE` 参数中，通过 GET 请求发送到服务器。
4.  **代码执行：** 如果服务器存在漏洞，并且 payload 构造正确，服务器将反序列化恶意的 ViewState payload，从而执行攻击者指定的命令。

**投毒风险：**
虽然该 POC 代码的主要功能是漏洞利用，但仍然存在一些潜在的投毒风险，风险评估为10%。

*   **依赖 ysoserial：** 该 POC 依赖于外部工具 `ysoserial.exe` 来生成 payload。攻击者可能会修改 `ysoserial.exe`，使其在生成 payload 的同时执行恶意操作，例如植入后门或收集敏感信息。用户需要从可信的来源下载 `ysoserial.exe`，并验证其完整性。

**利用方式：**
利用 CVE-2020-0688 漏洞的步骤如下：

1.  **获取凭据：** 攻击者需要获取有效的 Exchange 用户凭据。这可以通过钓鱼、密码猜测或利用其他漏洞来实现。
2.  **确定目标：** 攻击者需要确定目标 Exchange 服务器的 OWA 或 ECP URL。
3.  **生成 Payload：** 攻击者需要使用 `ysoserial.exe` 工具生成恶意的 ViewState payload，其中包含要执行的命令。
4.  **发送请求：** 攻击者需要将生成的 payload 注入到 ECP 的 `default.aspx` 页面的 `__VIEWSTATE` 参数中，通过 GET 请求发送到服务器。
5.  **执行代码：** 如果服务器存在漏洞，将执行攻击者指定的命令。

**项目地址:** [Yt1g3r/CVE-2020-0688_EXP](https://github.com/Yt1g3r/CVE-2020-0688_EXP)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #9

**来源**: [CVE-2020-0688-cert-lv_CVE-2020-0688.md](../2020/CVE-2020-0688-cert-lv_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 受影响版本包括：Microsoft Exchange Server 2010 SP3 UR30、2013 CU23、2016 CU14/CU15、2019 CU3/CU4

**利用条件:** 需要有效的Exchange用户凭据

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，它源于服务器未能正确处理内存中的对象。该漏洞是由于 Exchange 在安装时未能创建唯一的密钥导致的，攻击者可以利用静态密钥进行 ViewState 的反序列化攻击，从而执行任意代码。根据搜索结果和漏洞利用代码可知，此漏洞利用需要有效的 Exchange 用户凭据，并且该漏洞已经被积极利用。提供的漏洞利用代码 (scan.py) 主要用于识别易受攻击的 Exchange 服务器，而真正的漏洞利用还需要配合其他工具，例如ysoserial.net生成恶意ViewState。

**有效性：** 该漏洞的POC代码有效，可以用于检测存在漏洞的Exchange服务器。

**投毒风险：** 提供的`scan.py`和`lib.py`代码主要是用于扫描存在漏洞的服务器，没有直接包含恶意代码，但是仍然存在一定的投毒风险：
1. **依赖风险：**`scan.py`依赖于zmap以及一些python库，如果攻击者篡改了这些依赖项，可能会引入恶意代码。
2. **结果利用：** 扫描结果可能被攻击者用于识别易受攻击的服务器，从而发起进一步的攻击。 虽然该脚本本身看起来没有恶意投毒代码，但无法保证作者不会在未来版本中添加恶意代码。由于利用过程中需要用户本身具有一定权限，即使存在投毒代码，也需要用户执行才会触发。因此，综合评估投毒风险为10%。

**利用方式：**
1.  **获取用户凭据:** 攻击者首先需要获得Exchange用户的有效凭据(通常通过钓鱼等方式)。
2.  **识别漏洞服务器:** 使用类似于提供的`scan.py`脚本识别存在CVE-2020-0688漏洞的Exchange服务器。
3.  **生成恶意ViewState:** 利用ysoserial.net等工具，使用已知的静态密钥生成包含恶意代码的ViewState。
4.  **发送恶意请求:**  将包含恶意ViewState的请求发送到Exchange服务器的某个页面 (例如`/ecp/default.aspx`)，服务器反序列化ViewState时执行恶意代码，从而实现远程代码执行。

总的来说，CVE-2020-0688是一个严重的安全漏洞，需要及时修补。即使已经修补，也应该定期检查系统是否存在被入侵的痕迹。

**项目地址:** [cert-lv/CVE-2020-0688](https://github.com/cert-lv/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #10

**来源**: [CVE-2020-0688-chudamax_CVE-2020-0688-Exchange2010.md](../2020/CVE-2020-0688-chudamax_CVE-2020-0688-Exchange2010.md)

## CVE-2020-0688-Microsoft Exchange Server-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要获得Exchange用户的有效凭据（用户名和密码）和目标Exchange服务器的网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，原因是 Exchange 在安装时未能正确创建唯一的密钥。攻击者可以利用已知密钥对 ViewState 数据进行反序列化，从而在服务器上执行任意代码。

**漏洞利用方式：**

1.  **获取凭据：** 攻击者首先需要获取一个有效的 Exchange 用户名和密码。这可以通过网络钓鱼、密码猜测或其他凭据窃取技术实现。
2.  **身份验证：** 使用获取的凭据登录 Exchange 的 OWA (Outlook Web App) 或 ECP (Exchange Control Panel)。
3.  **ViewState 反序列化：** 攻击者构造一个恶意的 ViewState，其中包含要执行的命令。该 ViewState 使用已知的 MachineKeySection 密钥进行签名和加密。
4.  **发送请求：** 攻击者将包含恶意 ViewState 的请求发送到 Exchange 服务器的 ECP 页面（例如，`default.aspx`）。
5.  **远程代码执行：** Exchange 服务器使用已知的密钥解密和反序列化 ViewState。由于 ViewState 包含恶意代码，因此服务器会在当前进程的上下文中执行该代码。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，该漏洞利用是有效的。搜索引擎结果中包含了多个利用案例和警告，表明该漏洞已被广泛利用。

**投毒风险：**

提供的 POC 代码片段主要用于检测漏洞是否存在，并执行简单的命令。 虽然代码的目的是为了检测而非恶意活动， 但是仍需要注意。由于该漏洞允许远程代码执行，攻击者有可能可以替换检测 payload 为恶意 payload，从而进行投毒。因此存在一定的投毒风险。 由于代码相对简单，且目标明确，因此投毒风险较低，约10%。


**项目地址:** [chudamax/CVE-2020-0688-Exchange2010](https://github.com/chudamax/CVE-2020-0688-Exchange2010)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #11

**来源**: [CVE-2020-0688-justin-p_PSForgot2kEyXCHANGE.md](../2020/CVE-2020-0688-justin-p_PSForgot2kEyXCHANGE.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可完全控制 Exchange 服务器

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要有效的 Exchange 用户凭据 (用户名/密码) 和目标 Exchange 服务器未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，源于 Exchange 控制面板 (ECP) 未能正确处理内存中的对象。该漏洞允许经过身份验证的攻击者通过发送特制的请求到 Exchange 服务器执行任意代码。利用的关键在于静态密钥 `validationKey` 和 `decryptionKey` 的使用，攻击者利用这些密钥构造恶意的 ViewState 数据，将其发送到服务器，从而触发反序列化漏洞并执行恶意代码。PoC 代码 `PSForgot2kEyXCHANGE.ps1` 利用 ysoserial.net 生成恶意的 ViewState，通过 PowerShell 发送包含该 ViewState 的请求到 Exchange 服务器的 ECP 路径，从而实现远程代码执行。

**有效性:** 提供的 PoC 代码 `PSForgot2kEyXCHANGE.ps1` 看起来是有效的。它利用了 CVE-2020-0688 漏洞，通过构造恶意的 ViewState 数据来实现远程代码执行。搜索引擎结果中也有多个链接指向了关于该漏洞的利用和分析。

**投毒风险:**  `LICENSE.md` 文件是标准的 MIT 许可证，没有发现恶意代码。 `PSForgot2kEyXCHANGE.ps1` 本身是 PoC，但如果攻击者修改了 `-Command` 参数，就可以执行任意命令。PoC 主要功能是利用漏洞，而不是植入后门。但是，不排除作者在代码中加入一些隐蔽的、难以察觉的恶意代码（例如，在特定条件下执行某些操作）。考虑到作者贡献的其他安全工具的信誉，以及代码的复杂性，投毒风险评为10%。

**利用方式:**
1.  **获取用户凭据：** 攻击者需要拥有有效的 Exchange 用户名和密码。
2.  **定位目标 Exchange 服务器：** 确定未打补丁的 Exchange 服务器。
3.  **生成恶意 ViewState：** 使用 `PSForgot2kEyXCHANGE.ps1` 脚本和 ysoserial.net 工具，根据目标服务器的配置，生成包含恶意命令的 ViewState 数据。
4.  **发送恶意请求：** 将包含恶意 ViewState 的请求发送到 Exchange 服务器的 ECP 路径（例如，`/ecp/default.aspx`）。
5.  **执行任意代码：** 服务器反序列化 ViewState 数据，执行攻击者预先设定的恶意命令，从而实现远程代码执行。

**项目地址:** [justin-p/PSForgot2kEyXCHANGE](https://github.com/justin-p/PSForgot2kEyXCHANGE)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #12

**来源**: [CVE-2020-0688-ktpdpro_CVE-2020-0688.md](../2020/CVE-2020-0688-ktpdpro_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要Exchange Control Panel (ECP)可访问，且攻击者需要具有低权限的Exchange用户凭据

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688是Microsoft Exchange Server中的一个远程代码执行漏洞，该漏洞源于Exchange Control Panel (ECP)未能正确处理内存中的对象。成功利用此漏洞的攻击者可以在运行Exchange的服务器上以SYSTEM权限执行任意代码。利用方式通常涉及以下步骤：

1.  **获取有效凭据：** 攻击者首先需要获取一个有效的Exchange用户帐户的凭据，可以通过暴力破解、钓鱼或其他方式。
2.  **构造恶意请求：** 攻击者构造一个包含恶意序列化对象的特制HTTP请求，发送到Exchange服务器的ECP接口。这个请求通常利用了.NET ViewState的反序列化漏洞。
3.  **利用静态密钥：** 该漏洞的关键在于Exchange使用的静态密钥。攻击者利用此密钥来加密和签名ViewState数据，使其能够被服务器接受。
4.  **远程代码执行：** 当Exchange服务器处理恶意请求时，它会反序列化其中的对象，从而导致执行攻击者注入的任意代码，通常以SYSTEM权限运行。

根据提供的POC代码，该代码尝试通过`socket.socket(socket.AF_INET, socket.SOCK_RAW, socket.IPPROTO_RAW)`创建一个原始套接字来建立反向Bind Shell, 如果连接超时，将打印错误信息。同时还尝试从目标机器上通过GET方法获取IP，用户名等信息。这可能存在一定的投毒风险，作者可能将一些恶意代码隐藏在这些函数里，例如,收集用户信息的代码。考虑到风险，投毒风险评估为10%。

搜索引擎结果确认了该漏洞的存在和严重性，并指出有在野利用的案例。Rapid7的博客文章强调了攻击者如何利用此漏洞将任何被盗的Exchange用户帐户转变为完整的系统入侵。

总而言之，该漏洞利用的有效性较高，因为存在公开可用的POC代码和在野利用的报告。虽然POC本身可能没有明显的恶意投毒代码，但使用任何第三方提供的漏洞利用代码都应谨慎，因为其中可能包含未公开的恶意功能。

**项目地址:** [ktpdpro/CVE-2020-0688](https://github.com/ktpdpro/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #13

**来源**: [CVE-2020-0688-mahyarx_Exploit_CVE-2020-0688.md](../2020/CVE-2020-0688-mahyarx_Exploit_CVE-2020-0688.md)

# CVE-2020-0688

> 📦 该CVE有 **24** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-0688-1337-llama_CVE-2020-0688-Python3.md](../2020/CVE-2020-0688-1337-llama_CVE-2020-0688-Python3.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** MS Exchange Server 2010 SP3 up to 2019 CU4

**利用条件:** 需要有效的Exchange用户凭证或者能够绕过身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是一个存在于 Microsoft Exchange Server 的远程代码执行漏洞。该漏洞源于 Exchange 控制面板 (ECP) 未能正确处理内存中的对象。攻击者可以通过向服务器发送特制的序列化对象，利用 ViewState 机制进行反序列化操作，从而执行任意代码。漏洞利用通常涉及以下步骤：

1.  **获取有效的Exchange用户凭证：** 攻击者需要拥有Exchange服务器上一个有效用户的用户名和密码。这可以通过多种方式实现，例如网络钓鱼。
2.  **构造恶意 ViewState：** 攻击者构造一个包含恶意代码的 ViewState。该 ViewState 利用 .NET 反序列化漏洞，在服务器上执行攻击者指定的命令。
3.  **发送请求：** 攻击者将包含恶意 ViewState 的请求发送到 Exchange 服务器的 ECP 页面（例如，`/ecp/default.aspx`）。
4.  **执行代码：** Exchange 服务器反序列化 ViewState，执行攻击者提供的恶意代码。

**有效性：** 根据漏洞信息和搜索结果，以及提供的PoC代码，此漏洞是有效的，并且在野外被积极利用。

**投毒风险：** PoC 代码本身包含利用漏洞的代码，主要功能是发送构造好的恶意请求以执行命令。  虽然PoC的目的是展示漏洞利用，但仍需检查是否存在隐藏的后门或恶意功能。 提供的PoC代码来自Packet Storm，并经过了Python3的兼容性修改。代码本身没有明显的恶意行为，但仍存在潜在风险，无法完全排除投毒的可能性。风险评估在10%的原因是，代码中包含从外部站点获取的信息，存在潜在的不确定性。

**利用方式：** 攻击者首先需要获取有效的Exchange用户凭证。然后，利用这些凭证登录到Exchange控制面板，并发送包含恶意构造的ViewState的POST请求。  该ViewState会触发.NET反序列化漏洞，从而允许攻击者在Exchange服务器上执行任意代码。常见的利用方式是添加新的管理员用户，或者执行系统命令来控制服务器。

**项目地址:** [1337-llama/CVE-2020-0688-Python3](https://github.com/1337-llama/CVE-2020-0688-Python3)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #2

**来源**: [CVE-2020-0688-7heKnight_CVE-2020-0688.md](../2020/CVE-2020-0688-7heKnight_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要具有Exchange Control Panel (ECP) 的访问权限和有效的Exchange用户凭据。也需要能够访问服务器上的特定URL。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 中的远程代码执行漏洞，该漏洞源于 Exchange Control Panel (ECP) 在反序列化 ViewState 数据时使用了静态密钥。攻击者可以通过构造恶意的 ViewState 数据，利用这个静态密钥进行反序列化，从而在服务器上执行任意代码。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断该漏洞利用的有效性较高。搜索引擎结果中存在多个关于该漏洞的描述、利用和检测的文章，甚至有公开发布的POC代码。提供的 PowerShell 脚本 `CVE-2020-0688.ps1` 旨在生成恶意的 ViewState，攻击者可以将其注入到 ECP 请求中。

**投毒风险：** 分析提供的POC代码，`CVE-2020-0688.ps1` 脚本主要是生成ViewState，以及调用指定的xaml。`NULL-File.xml` 文件的功能是尝试通过 `Environment.GetEnvironmentVariable` 获取 Exchange 的安装路径，然后修改 `liveiderror.aspx` 文件。风险点在于，如果攻击者修改了 `NULL-File.xml`，他们可以写入任意内容到 `liveiderror.aspx`，甚至可能写入包含后门代码的webshell。因此，存在一定的投毒风险。虽然xml本身是为了利用漏洞，如果攻击者植入webshell到xml文件中进行利用，xml本身就是投毒文件。xml的目的是修改服务器上的文件。但因为给出的样本本身没有后门代码，所以认定投毒风险较低。

**利用方式：**

1.  **获取有效凭据：** 攻击者首先需要获得一个有效的 Exchange 用户账户的凭据。
2.  **计算 ViewStateGenerator：** 根据`/ecp`和目标URI（例如`auth/logon.aspx`）计算`__VIEWSTATEGENERATOR`的值，POC代码`CVE-2020-0688.ps1`正是用于计算和生成该值。
3.  **生成恶意 ViewState：** 使用 POC 脚本 `CVE-2020-0688.ps1` 和 `NULL-File.xml` 生成恶意的 `__VIEWSTATE`。脚本首先读取 `NULL-File.xml` 的内容，然后使用静态密钥进行序列化和签名，生成最终的 `__VIEWSTATE`。
4.  **发送恶意请求：** 攻击者将生成的恶意 `__VIEWSTATE` 和计算出的 `__VIEWSTATEGENERATOR` 注入到发送给 Exchange ECP 的 POST 请求中。例如，攻击者可以向 `autodiscover/autodiscover.xml` 或 `ecp/default.aspx` 发送包含恶意 ViewState 的请求。
5.  **执行代码：** 当 Exchange 服务器处理包含恶意 ViewState 的请求时，由于静态密钥的存在，反序列化过程会成功执行，从而触发 `NULL-File.xml` 中定义的恶意操作，例如写入文件或执行任意代码。

通过以上步骤，攻击者可以利用 CVE-2020-0688 漏洞在未打补丁的 Exchange 服务器上实现远程代码执行，进而控制整个服务器。

**项目地址:** [7heKnight/CVE-2020-0688](https://github.com/7heKnight/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #3

**来源**: [CVE-2020-0688-Jumbo-WJB_CVE-2020-0688.md](../2020/CVE-2020-0688-Jumbo-WJB_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要有效的Exchange用户凭据（用户名和密码）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 中的远程代码执行漏洞，源于 Exchange Control Panel (ECP) 未能正确处理内存中的对象。该漏洞利用了静态的validationKey和generator，允许攻击者通过构造恶意的ViewState来反序列化任意对象，从而执行任意代码。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断此POC代码有效。搜索引擎结果中多次提到CVE-2020-0688被实际利用。PoC代码 `CVE-2020-0688.py` 的内容显示，它尝试利用Exchange的ECP接口，通过提供用户名和密码来获取`ASP.NET_SessionId`和`__VIEWSTATEGENERATOR`，然后使用ysoserial生成恶意的ViewState payload，并将其注入到请求中。

**投毒风险：**
分析 `CVE-2020-0688.py` 的代码，投毒风险较低，大约为5%。主要风险点在于：
*   该脚本依赖外部程序 `ysoserial.exe` 来生成payload，如果攻击者的 `ysoserial.exe` 被篡改，可能存在投毒风险。但是脚本本身没有执行恶意行为的迹象。
*  脚本在运行时会要求用户手动输入`ysoserial`命令生成的payload, 这增加了人工干预,降低了自动化攻击的可能，同时也降低了脚本本身被植入恶意代码的可能性。 

**利用方式：**
1.  **获取Exchange用户凭据：**  攻击者需要有效的Exchange用户凭据（用户名和密码）才能进行身份验证。
2.  **身份验证：**  使用提供的用户名和密码向 `/owa/auth.owa` 进行身份验证，获取 `ASP.NET_SessionId` 和 `__VIEWSTATEGENERATOR`。
3.  **生成恶意ViewState payload：** 使用 `ysoserial.exe` 工具，基于 `TextFormattingRunProperties` gadget chain，生成包含命令的ViewState payload。
4.  **发送恶意请求：**  将生成的ViewState payload 作为 `__VIEWSTATE` 参数，结合 `__VIEWSTATEGENERATOR` 参数，发送到 `/ecp/default.aspx`。服务器在处理ViewState时，会反序列化恶意对象，从而执行payload中的命令。

总而言之，利用该漏洞需要有效的Exchange用户凭据以及`ysoserial`工具，攻击者能够通过精心构造的ViewState payload在目标Exchange服务器上执行任意代码。

**项目地址:** [Jumbo-WJB/CVE-2020-0688](https://github.com/Jumbo-WJB/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #4

**来源**: [CVE-2020-0688-MrTiz_CVE-2020-0688.md](../2020/CVE-2020-0688-MrTiz_CVE-2020-0688.md)

## CVE-2020-0688-Microsoft Exchange Server-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可完全控制 Exchange 服务器

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要有效的 Exchange 用户凭据

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞。该漏洞源于 Exchange 控制面板 (ECP) 在处理 ViewState 时使用了静态密钥进行加密和签名。攻击者如果拥有有效的 Exchange 用户凭据，就可以利用该密钥构造恶意的 ViewState，从而在服务器上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，可以判断该漏洞利用是有效的。许多安全厂商和研究人员都发布了关于该漏洞的报告和 PoC，表明该漏洞已经得到广泛证实。

**投毒风险：**

提供的 PowerShell PoC 代码主要功能是利用已知的静态密钥来构造恶意的 ViewState，并在目标 Exchange 服务器上执行任意命令。代码中包含了身份验证、ViewState 生成、Payload 加密等步骤，没有发现明显的恶意代码或后门。但是，任何公开的漏洞利用代码都存在被篡改或植入恶意代码的风险，所以仍有一定的投毒可能性，大约10%。

**利用方式：**

1.  **获取 Exchange 用户凭据：** 攻击者首先需要获得一个有效的 Exchange 用户名和密码。这可以通过网络钓鱼、密码猜测等方式实现。
2.  **确定 ECP URL：** 攻击者需要确定目标 Exchange 服务器的 ECP URL，例如 `https://example.com/ecp`。
3.  **生成恶意 ViewState：** 利用 PoC 代码（例如提供的 PowerShell 脚本）结合 Ysoserial.exe 工具，使用静态密钥构造包含恶意命令的 ViewState。
4.  **发送请求：** 将包含恶意 ViewState 的请求发送到 ECP 页面，例如 `https://example.com/ecp/default.aspx`。
5.  **执行代码：** Exchange 服务器在处理请求时，会反序列化恶意 ViewState，从而执行攻击者指定的代码。

**缓解措施：**

*   立即安装 Microsoft 发布的 CVE-2020-0688 安全更新。
*   如果无法立即安装更新，可以采取临时缓解措施，例如禁用 ECP 访问或更改静态密钥。

**项目地址:** [MrTiz/CVE-2020-0688](https://github.com/MrTiz/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #5

**来源**: [CVE-2020-0688-Ridter_cve-2020-0688.md](../2020/CVE-2020-0688-Ridter_cve-2020-0688.md)

## CVE-2020-0688-Microsoft Exchange Server-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要有效的Exchange用户凭据（用户名和密码）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，源于 Exchange 控制面板 (ECP) 未能正确处理内存中的对象。攻击者可以通过拥有合法Exchange用户的凭据，利用静态密钥进行 ViewState 反序列化，从而在服务器上执行任意代码。

**有效性分析：**
根据漏洞库信息和搜索结果，CVE-2020-0688 是一个已被广泛利用的漏洞。提供的 POC 代码（0688-detect.py）旨在检测和利用此漏洞。从代码分析来看，该脚本首先尝试使用提供的凭据登录到 OWA。成功登录后，它会构造一个恶意的 ViewState payload，该 payload 利用了不安全的 ViewState 反序列化。然后，它通过发送带有特制 ViewState 的请求到 ECP 页面来触发漏洞，最终导致远程代码执行。

**投毒风险分析：**
审阅提供的`0688-detect.py` 脚本，并未发现明显的恶意或后门代码。脚本的功能是利用 CVE-2020-0688 漏洞进行远程代码执行。虽然脚本本身是为了攻击目的而编写，但这并不等同于投毒。`out_payload` 是该漏洞利用的关键部分，它包含用于触发漏洞的序列化对象。虽然脚本的目的是为了利用漏洞，增加了攻击风险，但从代码本身来看，不属于投毒行为，只是实现了漏洞利用。

但是考虑到github仓库本身的风险，以及代码中可能存在的细微修改，将投毒风险评估为10%。

**利用方式：**
1.  **获取凭据：** 攻击者需要拥有一个有效的 Microsoft Exchange 用户帐户的用户名和密码。这可能通过网络钓鱼、密码猜测或其他攻击手段获得。
2.  **身份验证：** 使用获得的凭据登录到 Exchange Webmail (OWA)。
3.  **构造 Payload：**  该 POC 脚本会构造一个恶意的 `__VIEWSTATE` 参数，其中包含一个经过特殊设计的序列化对象。该对象旨在利用 ViewState 的不安全反序列化机制来执行任意代码。
4.  **触发漏洞：**  将构造的 `__VIEWSTATE` 参数附加到对 ECP 页面的请求中，从而触发反序列化漏洞。服务器在处理该请求时，会反序列化恶意对象，从而执行攻击者指定的代码。
5.  **远程代码执行：** 成功利用漏洞后，攻击者可以在 Exchange 服务器上执行任意代码，从而完全控制服务器。


**项目地址:** [Ridter/cve-2020-0688](https://github.com/Ridter/cve-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #6

**来源**: [CVE-2020-0688-SLSteff_CVE-2020-0688-Scanner.md](../2020/CVE-2020-0688-SLSteff_CVE-2020-0688-Scanner.md)

## CVE-2020-0688-Microsoft Exchange-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange

**危害等级:** 高危，可能导致完全系统入侵

**影响版本:** 受影响版本包括但不限于Exchange Server 2010 SP3 UR30, Exchange Server 2013 CU23, Exchange Server 2016 CU14/15, Exchange Server 2019 CU3/4

**利用条件:** 需要OWA（Outlook Web Access）的访问权限以及有效的Exchange用户凭据或服务器的静态密钥（ValidationKey, DecryptionKey），如果服务器使用了默认密钥，则不需要用户凭据

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange 中存在的一个远程代码执行漏洞，源于 Exchange 在安装时未能正确创建唯一的密钥。攻击者可以利用此漏洞，通过构造恶意的请求，利用ViewState反序列化在服务器上执行任意代码。\n\n**漏洞利用方式：**\n1.  **获取密钥：** 攻击者需要首先获得目标 Exchange 服务器的 ValidationKey 和 DecryptionKey。这些密钥通常可以在 web.config 文件中找到。如果目标使用了默认密钥，利用则变得更加简单。\n2.  **构造恶意 ViewState：** 利用获得的密钥，攻击者可以构造一个包含恶意代码的 ViewState 对象。这个 ViewState 对象会被序列化并编码。\n3.  **发送恶意请求：** 攻击者将构造好的恶意 ViewState 对象作为请求参数发送到 Exchange 服务器的 OWA 接口 (例如`/ecp/default.aspx`)。\n4.  **执行代码：** Exchange 服务器在处理该请求时，会反序列化 ViewState 对象，从而执行攻击者嵌入的恶意代码。\n\n**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用是有效的。多个来源表明该漏洞已在野外被利用，且存在公开的 PoC 代码。

**投毒风险：**
提供的shell脚本主要用于扫描指定IP范围内的Exchange服务器，并识别可能存在CVE-2020-0688漏洞的版本。脚本的功能在于版本探测，而非直接的漏洞利用。尽管如此，仍然存在一定的投毒风险（大约10%），虽然扫描器本身没有明显的恶意代码，但存在以下可能性：\n*   **依赖项风险：** 脚本可能依赖于其他外部脚本或工具，这些依赖项可能包含恶意代码。\n*   **命令注入风险：** 尽管脚本本身没有明显的命令注入漏洞，但如果用户在使用脚本时没有正确处理输入，可能会引入命令注入漏洞。
*   **信息收集风险：** 扫描器会收集目标 Exchange 服务器的版本信息，这些信息可能被攻击者用于后续的攻击。
*   **伪装与欺骗：** 攻击者可能修改脚本，使其在扫描过程中执行恶意操作，例如植入后门或窃取凭据。由于此脚本会尝试与目标服务器进行交互，增加了被恶意利用的可能性。
*   **域名欺骗:** 此脚本中没有发现域名欺骗或IP地址欺骗的恶意行为。\n\n由于存在上述潜在风险，使用此脚本时务必谨慎，并确保从可信的来源获取。


**项目地址:** [SLSteff/CVE-2020-0688-Scanner](https://github.com/SLSteff/CVE-2020-0688-Scanner)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #7

**来源**: [CVE-2020-0688-W01fh4cker_CVE-2020-0688-GUI.md](../2020/CVE-2020-0688-W01fh4cker_CVE-2020-0688-GUI.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可完全控制受影响的Exchange服务器

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要OWA或ECP的访问权限，并且已知ValidationKey和DecryptionKey。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688是一个Microsoft Exchange Server中的远程代码执行漏洞。该漏洞是由于Exchange在安装时未能正确创建唯一的密钥导致的，攻击者可以利用已知的ValidationKey和DecryptionKey对ViewState进行反序列化，从而执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（GUI工具），可以判断该漏洞的POC代码是有效的。搜索引擎结果中多次提及该漏洞被野外利用，并且存在公开的POC和利用工具。

**投毒风险：**

分析提供的POC代码，主要是一个Visual Studio解决方案，包含C# GUI界面，用于简化漏洞利用过程，可以执行命令或加载shellcode。

*   **CVE-2020-0688-GUI.sln, CVE-2020-0688-GUI.csproj:** 正常的项目文件，定义了项目结构和依赖项。
*   **README.md:** 描述了项目目的、使用方法和作者信息。正常。
*   **App.xaml, App.xaml.cs:** 应用程序入口点和相关逻辑。正常。
*   **AssemblyInfo.cs:** 程序集信息。正常。
*   **资源文件:** 包含logo.ico和profile.png。正常。

总体来看，提供的代码主要是为了方便利用该漏洞，但并不能完全排除投毒的风险。可能存在的风险点在于：

1.  **Shellcode加载功能:** 如果攻击者提供包含恶意功能的shellcode，那么GUI工具仅仅是提供了一个执行的载体。用户如果使用了不可信来源的shellcode，则存在被攻击的风险。
2. **作者本身**：作者可能在编译好的二进制文件中加入恶意代码，但从提供的源码来看，没有发现明显的恶意代码。GUI工具本身的存在也可能误导使用者进行未授权的渗透测试，从而导致法律风险。

因此，投毒风险评估为10%。

**利用方式：**

利用CVE-2020-0688漏洞的典型方式如下：

1.  **获取ValidationKey和DecryptionKey：** 这是利用该漏洞的首要条件。可以通过多种方式获取，例如通过不安全的配置管理或密钥泄露。
2.  **构造恶意ViewState：** 攻击者使用已知的密钥构造恶意的ViewState，其中包含要执行的命令或shellcode。
3.  **发送请求：** 将构造的ViewState作为请求的一部分（通常是针对OWA或ECP）发送到目标Exchange服务器。
4.  **远程代码执行：** Exchange服务器在处理请求时，会反序列化ViewState，从而执行攻击者预先设定的代码。

**项目地址:** [W01fh4cker/CVE-2020-0688-GUI](https://github.com/W01fh4cker/CVE-2020-0688-GUI)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #8

**来源**: [CVE-2020-0688-Yt1g3r_CVE-2020-0688_EXP.md](../2020/CVE-2020-0688-Yt1g3r_CVE-2020-0688_EXP.md)

## CVE-2020-0688 - Microsoft Exchange Server 远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要Exchange服务器的OWA或ECP接口可访问，并具有有效的Exchange用户凭据

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 漏洞是 Microsoft Exchange Server 在处理内存中对象时，由于未能正确处理反序列化数据而导致的远程代码执行漏洞。该漏洞存在于 Exchange Control Panel (ECP) 组件中，攻击者可以利用静态密钥对 ViewState 进行恶意构造，从而在服务器上执行任意代码。

**有效性：**
提供的 Python POC 代码 `CVE-2020-0688_EXP.py` 是有效的。该脚本通过以下步骤利用该漏洞：

1.  **身份验证：** 使用提供的用户名和密码尝试登录 Exchange 的 OWA 接口。通过模拟用户登录过程，获取有效的 `ASP.NET_SessionId` Cookie，并获取 `__VIEWSTATEGENERATOR` 的值 (如果获取不到, 使用默认值).
2.  **Payload 生成：** 使用 `ysoserial.exe` 工具生成恶意的 ViewState payload。该 payload 包含攻击者想要执行的命令。POC 脚本使用了 TextFormattingRunProperties gadget。
3.  **Payload 注入：** 将生成的 payload 注入到 ECP 的 `default.aspx` 页面的 `__VIEWSTATE` 参数中，通过 GET 请求发送到服务器。
4.  **代码执行：** 如果服务器存在漏洞，并且 payload 构造正确，服务器将反序列化恶意的 ViewState payload，从而执行攻击者指定的命令。

**投毒风险：**
虽然该 POC 代码的主要功能是漏洞利用，但仍然存在一些潜在的投毒风险，风险评估为10%。

*   **依赖 ysoserial：** 该 POC 依赖于外部工具 `ysoserial.exe` 来生成 payload。攻击者可能会修改 `ysoserial.exe`，使其在生成 payload 的同时执行恶意操作，例如植入后门或收集敏感信息。用户需要从可信的来源下载 `ysoserial.exe`，并验证其完整性。

**利用方式：**
利用 CVE-2020-0688 漏洞的步骤如下：

1.  **获取凭据：** 攻击者需要获取有效的 Exchange 用户凭据。这可以通过钓鱼、密码猜测或利用其他漏洞来实现。
2.  **确定目标：** 攻击者需要确定目标 Exchange 服务器的 OWA 或 ECP URL。
3.  **生成 Payload：** 攻击者需要使用 `ysoserial.exe` 工具生成恶意的 ViewState payload，其中包含要执行的命令。
4.  **发送请求：** 攻击者需要将生成的 payload 注入到 ECP 的 `default.aspx` 页面的 `__VIEWSTATE` 参数中，通过 GET 请求发送到服务器。
5.  **执行代码：** 如果服务器存在漏洞，将执行攻击者指定的命令。

**项目地址:** [Yt1g3r/CVE-2020-0688_EXP](https://github.com/Yt1g3r/CVE-2020-0688_EXP)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #9

**来源**: [CVE-2020-0688-cert-lv_CVE-2020-0688.md](../2020/CVE-2020-0688-cert-lv_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 受影响版本包括：Microsoft Exchange Server 2010 SP3 UR30、2013 CU23、2016 CU14/CU15、2019 CU3/CU4

**利用条件:** 需要有效的Exchange用户凭据

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，它源于服务器未能正确处理内存中的对象。该漏洞是由于 Exchange 在安装时未能创建唯一的密钥导致的，攻击者可以利用静态密钥进行 ViewState 的反序列化攻击，从而执行任意代码。根据搜索结果和漏洞利用代码可知，此漏洞利用需要有效的 Exchange 用户凭据，并且该漏洞已经被积极利用。提供的漏洞利用代码 (scan.py) 主要用于识别易受攻击的 Exchange 服务器，而真正的漏洞利用还需要配合其他工具，例如ysoserial.net生成恶意ViewState。

**有效性：** 该漏洞的POC代码有效，可以用于检测存在漏洞的Exchange服务器。

**投毒风险：** 提供的`scan.py`和`lib.py`代码主要是用于扫描存在漏洞的服务器，没有直接包含恶意代码，但是仍然存在一定的投毒风险：
1. **依赖风险：**`scan.py`依赖于zmap以及一些python库，如果攻击者篡改了这些依赖项，可能会引入恶意代码。
2. **结果利用：** 扫描结果可能被攻击者用于识别易受攻击的服务器，从而发起进一步的攻击。 虽然该脚本本身看起来没有恶意投毒代码，但无法保证作者不会在未来版本中添加恶意代码。由于利用过程中需要用户本身具有一定权限，即使存在投毒代码，也需要用户执行才会触发。因此，综合评估投毒风险为10%。

**利用方式：**
1.  **获取用户凭据:** 攻击者首先需要获得Exchange用户的有效凭据(通常通过钓鱼等方式)。
2.  **识别漏洞服务器:** 使用类似于提供的`scan.py`脚本识别存在CVE-2020-0688漏洞的Exchange服务器。
3.  **生成恶意ViewState:** 利用ysoserial.net等工具，使用已知的静态密钥生成包含恶意代码的ViewState。
4.  **发送恶意请求:**  将包含恶意ViewState的请求发送到Exchange服务器的某个页面 (例如`/ecp/default.aspx`)，服务器反序列化ViewState时执行恶意代码，从而实现远程代码执行。

总的来说，CVE-2020-0688是一个严重的安全漏洞，需要及时修补。即使已经修补，也应该定期检查系统是否存在被入侵的痕迹。

**项目地址:** [cert-lv/CVE-2020-0688](https://github.com/cert-lv/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #10

**来源**: [CVE-2020-0688-chudamax_CVE-2020-0688-Exchange2010.md](../2020/CVE-2020-0688-chudamax_CVE-2020-0688-Exchange2010.md)

## CVE-2020-0688-Microsoft Exchange Server-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要获得Exchange用户的有效凭据（用户名和密码）和目标Exchange服务器的网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，原因是 Exchange 在安装时未能正确创建唯一的密钥。攻击者可以利用已知密钥对 ViewState 数据进行反序列化，从而在服务器上执行任意代码。

**漏洞利用方式：**

1.  **获取凭据：** 攻击者首先需要获取一个有效的 Exchange 用户名和密码。这可以通过网络钓鱼、密码猜测或其他凭据窃取技术实现。
2.  **身份验证：** 使用获取的凭据登录 Exchange 的 OWA (Outlook Web App) 或 ECP (Exchange Control Panel)。
3.  **ViewState 反序列化：** 攻击者构造一个恶意的 ViewState，其中包含要执行的命令。该 ViewState 使用已知的 MachineKeySection 密钥进行签名和加密。
4.  **发送请求：** 攻击者将包含恶意 ViewState 的请求发送到 Exchange 服务器的 ECP 页面（例如，`default.aspx`）。
5.  **远程代码执行：** Exchange 服务器使用已知的密钥解密和反序列化 ViewState。由于 ViewState 包含恶意代码，因此服务器会在当前进程的上下文中执行该代码。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，该漏洞利用是有效的。搜索引擎结果中包含了多个利用案例和警告，表明该漏洞已被广泛利用。

**投毒风险：**

提供的 POC 代码片段主要用于检测漏洞是否存在，并执行简单的命令。 虽然代码的目的是为了检测而非恶意活动， 但是仍需要注意。由于该漏洞允许远程代码执行，攻击者有可能可以替换检测 payload 为恶意 payload，从而进行投毒。因此存在一定的投毒风险。 由于代码相对简单，且目标明确，因此投毒风险较低，约10%。


**项目地址:** [chudamax/CVE-2020-0688-Exchange2010](https://github.com/chudamax/CVE-2020-0688-Exchange2010)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #11

**来源**: [CVE-2020-0688-justin-p_PSForgot2kEyXCHANGE.md](../2020/CVE-2020-0688-justin-p_PSForgot2kEyXCHANGE.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可完全控制 Exchange 服务器

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要有效的 Exchange 用户凭据 (用户名/密码) 和目标 Exchange 服务器未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，源于 Exchange 控制面板 (ECP) 未能正确处理内存中的对象。该漏洞允许经过身份验证的攻击者通过发送特制的请求到 Exchange 服务器执行任意代码。利用的关键在于静态密钥 `validationKey` 和 `decryptionKey` 的使用，攻击者利用这些密钥构造恶意的 ViewState 数据，将其发送到服务器，从而触发反序列化漏洞并执行恶意代码。PoC 代码 `PSForgot2kEyXCHANGE.ps1` 利用 ysoserial.net 生成恶意的 ViewState，通过 PowerShell 发送包含该 ViewState 的请求到 Exchange 服务器的 ECP 路径，从而实现远程代码执行。

**有效性:** 提供的 PoC 代码 `PSForgot2kEyXCHANGE.ps1` 看起来是有效的。它利用了 CVE-2020-0688 漏洞，通过构造恶意的 ViewState 数据来实现远程代码执行。搜索引擎结果中也有多个链接指向了关于该漏洞的利用和分析。

**投毒风险:**  `LICENSE.md` 文件是标准的 MIT 许可证，没有发现恶意代码。 `PSForgot2kEyXCHANGE.ps1` 本身是 PoC，但如果攻击者修改了 `-Command` 参数，就可以执行任意命令。PoC 主要功能是利用漏洞，而不是植入后门。但是，不排除作者在代码中加入一些隐蔽的、难以察觉的恶意代码（例如，在特定条件下执行某些操作）。考虑到作者贡献的其他安全工具的信誉，以及代码的复杂性，投毒风险评为10%。

**利用方式:**
1.  **获取用户凭据：** 攻击者需要拥有有效的 Exchange 用户名和密码。
2.  **定位目标 Exchange 服务器：** 确定未打补丁的 Exchange 服务器。
3.  **生成恶意 ViewState：** 使用 `PSForgot2kEyXCHANGE.ps1` 脚本和 ysoserial.net 工具，根据目标服务器的配置，生成包含恶意命令的 ViewState 数据。
4.  **发送恶意请求：** 将包含恶意 ViewState 的请求发送到 Exchange 服务器的 ECP 路径（例如，`/ecp/default.aspx`）。
5.  **执行任意代码：** 服务器反序列化 ViewState 数据，执行攻击者预先设定的恶意命令，从而实现远程代码执行。

**项目地址:** [justin-p/PSForgot2kEyXCHANGE](https://github.com/justin-p/PSForgot2kEyXCHANGE)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #12

**来源**: [CVE-2020-0688-ktpdpro_CVE-2020-0688.md](../2020/CVE-2020-0688-ktpdpro_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要Exchange Control Panel (ECP)可访问，且攻击者需要具有低权限的Exchange用户凭据

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688是Microsoft Exchange Server中的一个远程代码执行漏洞，该漏洞源于Exchange Control Panel (ECP)未能正确处理内存中的对象。成功利用此漏洞的攻击者可以在运行Exchange的服务器上以SYSTEM权限执行任意代码。利用方式通常涉及以下步骤：

1.  **获取有效凭据：** 攻击者首先需要获取一个有效的Exchange用户帐户的凭据，可以通过暴力破解、钓鱼或其他方式。
2.  **构造恶意请求：** 攻击者构造一个包含恶意序列化对象的特制HTTP请求，发送到Exchange服务器的ECP接口。这个请求通常利用了.NET ViewState的反序列化漏洞。
3.  **利用静态密钥：** 该漏洞的关键在于Exchange使用的静态密钥。攻击者利用此密钥来加密和签名ViewState数据，使其能够被服务器接受。
4.  **远程代码执行：** 当Exchange服务器处理恶意请求时，它会反序列化其中的对象，从而导致执行攻击者注入的任意代码，通常以SYSTEM权限运行。

根据提供的POC代码，该代码尝试通过`socket.socket(socket.AF_INET, socket.SOCK_RAW, socket.IPPROTO_RAW)`创建一个原始套接字来建立反向Bind Shell, 如果连接超时，将打印错误信息。同时还尝试从目标机器上通过GET方法获取IP，用户名等信息。这可能存在一定的投毒风险，作者可能将一些恶意代码隐藏在这些函数里，例如,收集用户信息的代码。考虑到风险，投毒风险评估为10%。

搜索引擎结果确认了该漏洞的存在和严重性，并指出有在野利用的案例。Rapid7的博客文章强调了攻击者如何利用此漏洞将任何被盗的Exchange用户帐户转变为完整的系统入侵。

总而言之，该漏洞利用的有效性较高，因为存在公开可用的POC代码和在野利用的报告。虽然POC本身可能没有明显的恶意投毒代码，但使用任何第三方提供的漏洞利用代码都应谨慎，因为其中可能包含未公开的恶意功能。

**项目地址:** [ktpdpro/CVE-2020-0688](https://github.com/ktpdpro/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #13

**来源**: [CVE-2020-0688-mahyarx_Exploit_CVE-2020-0688.md](../2020/CVE-2020-0688-mahyarx_Exploit_CVE-2020-0688.md)

## CVE-2020-0688-Microsoft Exchange Server-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可完全控制受影响的Exchange服务器

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要Exchange服务器Web界面访问权限和有效的凭据或者能够获取到有效的凭据，以及目标服务器未安装相关补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688是Microsoft Exchange Server中的一个远程代码执行漏洞。该漏洞是由于Exchange在安装时未能正确创建唯一的密钥导致的。攻击者可以利用该漏洞，通过构造恶意的ViewState，在受影响的Exchange服务器上执行任意代码，完全控制服务器。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞已经确认存在并且有公开的PoC。提供的PoC代码看起来有效，因为它利用了静态密钥进行ViewState反序列化，从而执行任意代码。

**投毒风险：**
提供的PoC代码主要功能是生成恶意的ViewState，本身不包含明显的恶意代码，例如直接执行shell命令。但是，`NULL-File.xml`文件中通过`Environment.GetEnvironmentVariable` 获取 `ExchangeInstallPath`，然后向`ClientAccess\Autodiscover\Imx.aspx`写入空字符串, 这种操作行为可以被用于删除或者篡改文件，从而导致拒绝服务等攻击，存在一定的潜在风险，但概率较低。因此，投毒风险估计为10%。

**利用方式：**
1.  **获取密钥：**  攻击者需要获取受影响Exchange服务器的`validationKey`和`decryptionKey`。由于CVE-2020-0688利用的是静态密钥，所以可以事先计算好或者从网上找到公开的密钥（如果目标环境未使用更新过的补丁）。
2.  **构造恶意ViewState：**  攻击者利用获取的密钥，结合`TextFormattingRunPropertiesMarshal`类创建一个可以执行任意代码的反序列化对象，并将其序列化。
3.  **计算__VIEWSTATEGENERATOR：**PoC代码中计算`__VIEWSTATEGENERATOR`的方式与实际利用一致。`__VIEWSTATEGENERATOR`用于验证ViewState的来源，需要正确计算才能成功利用。
4.  **发送请求：**  攻击者将构造好的ViewState作为参数，通过HTTP POST请求发送到Exchange服务器的`ecp`虚拟目录。通过精心构造的Xaml，恶意代码在服务器端被反序列化并执行。
5.  **控制服务器：**  成功利用该漏洞后，攻击者可以在Exchange服务器上执行任意代码，从而完全控制服务器。

**项目地址:** [mahyarx/Exploit_CVE-2020-0688](https://github.com/mahyarx/Exploit_CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #14

**来源**: [CVE-2020-0688-murataydemir_CVE-2020-0688.md](../2020/CVE-2020-0688-murataydemir_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全系统权限控制

**影响版本:** 受影响版本包括：Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要有效的Exchange用户凭据进行身份验证，以及对Exchange Control Panel (ECP) 的网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 的远程代码执行漏洞，源于 ECP 组件中使用了静态的 cryptographic key。攻击者利用已知密钥伪造 ViewState 数据，从而在服务器上执行任意代码，获取SYSTEM权限。

**有效性：**
提供的POC代码有效。根据漏洞描述，Exchange Server 所有安装共享相同的 validationKey 和 decryptionKey，允许经过身份验证的攻击者通过构造恶意的 ViewState 数据进行反序列化攻击，从而执行任意代码。

**投毒风险：**
该POC代码主要提供的是漏洞利用方法，并引用了YSoSerial.net工具生成payload，本身不包含任何恶意代码或后门。因此，投毒风险极低。

**利用方式：**
1.  攻击者首先需要获取一个有效的Exchange用户账户的凭据（可以通过钓鱼或其他手段）。
2.  使用该凭据登录到 Exchange 的 OWA 或 ECP 页面，获取 `ASP_NET_SessionId` 和 `__VIEWSTATEGENERATOR` 的值。
3.  使用 `YSoSerial.net` 工具，利用已知 `validationKey` (CB2721ABDAF8E9DC516D621D8B8BF13A2C9E8689A25303BF) 和 `validationalg` (SHA1) 生成恶意的 ViewState payload。可以构造payload执行任意命令，例如反弹shell。
4.  将生成的 ViewState payload 插入到 ECP 的请求中，发送到服务器。例如：`http(s)://exchangeserver/ecp/default.aspx?__VIEWSTATEGENERATOR=<generator>&__VIEWSTATE=<ViewState_Payload>`
5.  服务器在处理该请求时，会反序列化恶意的 ViewState 数据，从而执行攻击者指定的代码，最终导致远程代码执行。

**项目地址:** [murataydemir/CVE-2020-0688](https://github.com/murataydemir/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #15

**来源**: [CVE-2020-0688-onSec-fr_CVE-2020-0688-Scanner.md](../2020/CVE-2020-0688-onSec-fr_CVE-2020-0688-Scanner.md)

## CVE-2020-0688-Microsoft Exchange Server-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要Exchange Control Panel (ECP)可访问，并已知有效的用户凭据（可以是通过其他方式获得的被盗凭据）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，源于 Exchange Control Panel (ECP) 组件未能正确处理内存中的对象。该漏洞允许经过身份验证的攻击者通过向服务器发送特制的 payload 来执行任意代码。

**有效性：**
根据搜索引擎结果，该漏洞的利用代码（PoC）是存在的，并且已被积极利用。从提供的文件列表来看，存在 `CVE-2020-0688-Scanner.exe.config` 和 `HtmlAgilityPack.xml` ，这表明该 PoC 可能是使用 .NET Framework 编写的扫描器，用于检测目标 Exchange 服务器是否存在漏洞。因此可以判断提供的POC代码有效。

**投毒风险：**
鉴于提供的文件仅为配置文件和 HTML 解析库的 XML 文档，直接从这些文件判断是否存在投毒代码比较困难。但是，由于漏洞利用涉及远程代码执行，攻击者完全可能在利用过程中植入恶意代码。`CVE-2020-0688-Scanner.exe.config` 本身没有可疑之处，但是最终的扫描器程序 `CVE-2020-0688-Scanner.exe` 可能存在被篡改的风险。漏洞利用代码的投毒风险评估为10%，主要考虑潜在的恶意第三方修改。

**利用方式：**
利用 CVE-2020-0688 的核心在于 Exchange Control Panel (ECP) 使用静态密钥进行 ViewState 数据的序列化和反序列化。攻击者可以利用此静态密钥构造恶意的 ViewState payload，当 Exchange 服务器反序列化此 payload 时，即可执行攻击者指定的任意代码。利用步骤大致如下：

1.  获取 Exchange 服务器的静态密钥（`validationKey` 和 `decryptionKey`）。
2.  构造包含恶意代码的 ViewState payload。
3.  将构造的 payload 发送到 Exchange 服务器的 ECP 接口。
4.  Exchange 服务器反序列化 payload 并执行恶意代码，实现远程代码执行。

攻击者可以先通过爆破、信息泄露等手段获取Exchange的用户凭据，再借助此漏洞将权限提升至SYSTEM。


**项目地址:** [onSec-fr/CVE-2020-0688-Scanner](https://github.com/onSec-fr/CVE-2020-0688-Scanner)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #16

**来源**: [CVE-2020-0688-random-robbie_cve-2020-0688.md](../2020/CVE-2020-0688-random-robbie_cve-2020-0688.md)

## CVE-2020-0688-Microsoft Exchange Server-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要有效的Exchange用户凭证，能够访问ECP (Exchange Control Panel)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688是一个Microsoft Exchange服务器的远程代码执行漏洞，源于服务器在安装时未能正确创建唯一的密钥。攻击者可以利用该漏洞通过Exchange Control Panel (ECP)组件发送特制的payload执行任意代码。利用过程包括：

1.  **获取必要信息：** 首先，需要一个有效的Exchange用户账户（邮箱地址和密码），用于登录OWA（Outlook Web App）。登录后，需要从响应中提取`__VIEWSTATEGENERATOR`参数和`ASP.NET_SessionId` cookie。
2.  **生成ViewState Payload：** 使用`ysoserial.net`工具，基于`TextFormattingRunProperties` gadget生成恶意的ViewState payload。需要指定`--validationalg`为`SHA1`，`--validationkey`为静态的`CB2721ABDAF8E9DC516D621D8B8BF13A2C9E8689A25303BF`（这是此漏洞的核心：硬编码的密钥），`--generator`为从页面源码中获取的`__VIEWSTATEGENERATOR`值，`--viewstateuserkey`为从cookie中提取的`ASP.NET_SessionId`值。command 为需要执行的命令。
3.  **发送恶意请求：** 将生成的ViewState payload附加到对ECP的请求中，通过`__VIEWSTATE`参数传递。 URL示例: `https://localhost/ecp/default.aspx?__VIEWSTATEGENERATOR=<generator>&__VIEWSTATE=<ViewState>`。

提供的`exploit.py`脚本尝试自动化这个过程，但注释表明它**尚未经过测试，需要进一步完善**。特别是 ViewState 值的生成需要在外部完成，脚本只负责登录和参数提取。

**关于投毒风险：**

`exploit.py`脚本本身相对简单，主要功能是登录OWA并提取必要的参数。潜在的风险可能存在于以下几点：
*   作者提供的`ysoserial.net`下载链接，如果链接被替换为恶意的`ysoserial.net`版本，可能包含恶意代码，但在Github上的相关链接通常是安全的，不过需要谨慎。
*   在`exploit.py`中，如果作者有意在后续完善中添加恶意代码，例如，在生成payload时执行某些恶意操作，则存在潜在风险。
*   `README.md`中要求下载`YSO`， 如果被替换为恶意链接,会存在投毒风险。

考虑到脚本的简单性以及需要外部工具生成payload，直接的投毒风险较低，综合评估为10%。主要风险在于使用者下载的外部工具可能被篡改。

**有效性分析：**
根据漏洞描述和搜索结果，此漏洞利用的关键在于使用了硬编码的`validationkey`。如果目标Exchange服务器未打补丁，且使用了受影响的版本，利用成功的可能性较高。提供的POC代码需要手动生成ViewState payload，脚本只是辅助提取参数，因此代码的有效性取决于payload的生成是否正确以及目标服务器是否符合漏洞利用的条件。


**项目地址:** [random-robbie/cve-2020-0688](https://github.com/random-robbie/cve-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #17

**来源**: [CVE-2020-0688-ravinacademy_CVE-2020-0688.md](../2020/CVE-2020-0688-ravinacademy_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要Exchange服务器的访问权限，以及有效的Exchange用户凭据（可以通过窃取获得）。利用需要目标服务器未安装相应的安全补丁，且攻击者能够访问 ECP (Exchange Control Panel) 或 OWA (Outlook Web App)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 中的远程代码执行漏洞，源于 Exchange 在安装时未能正确创建唯一的密钥。攻击者可以利用此漏洞通过构造恶意的 ViewState 数据包，在服务器上执行任意代码。攻击通常涉及以下步骤：

1.  **获取 Exchange 服务器的验证密钥 (validationKey) 和解密密钥 (decryptionKey)**：这些密钥通常存储在 web.config 文件中。虽然不是 POC 的一部分，但是利用此漏洞需要获取这些密钥。
2.  **构造恶意的 ViewState**：利用提供的 PowerShell 脚本 `CVE-2020-0688.ps1`，结合 `NULL-File.xml` payload，可以生成恶意的 ViewState。脚本的核心在于通过 TextFormattingRunPropertiesMarshal 类进行反序列化操作，从而执行任意代码。
3.  **发送 ViewState**：将构造的 ViewState 作为参数发送到 Exchange 服务器的 ECP 或 OWA 页面。

**有效性评估：**

提供的 POC 代码有效。它利用了 ViewState 的不安全反序列化漏洞来执行任意代码。多个来源（包括 GitHub 和安全博客）都确认了此漏洞的存在和利用的有效性。

**投毒风险评估：**

尽管提供的 POC 脚本主要功能是生成 ViewState，看似无害，但是依然存在微小的投毒风险（10%）。`NULL-File.xml` 文件的目的是创建一个 `Ravin.aspx` 文件，文件内容为空。作者可能替换掉这个aspx文件内容，植入恶意代码,从而实现后门。此外，攻击者可以修改 PowerShell 脚本以包含额外的恶意操作，例如，下载并执行任意程序。不过，从表面上看，该脚本的主要功能是生成 ViewState，而真正的恶意代码需要在 ViewState 中构造。

**漏洞利用方式：**

1.  **攻击者需要具有Exchange用户的权限。**
2.  **获取validationKey和decryptionKey。** 这是成功利用漏洞的关键。
3.  **利用 PowerShell 脚本构造恶意的 ViewState。** 脚本 `CVE-2020-0688.ps1` 使用 `NULL-File.xml` 作为 payload 示例。 `NULL-File.xml` 的作用是尝试在 Exchange 服务器上创建一个空白的 ASPX 文件 (`Ravin.aspx`)。这本身可能不是恶意行为，但它为进一步的攻击打开了大门，攻击者可以上传包含恶意代码的 ASPX 文件，从而实现远程代码执行。
4.  **将构造的 ViewState 通过 HTTP 请求发送到 Exchange 服务器的 ECP 或 OWA 页面。**  目标页面通常是 `ecp/default.aspx` 或 `owa/auth/logon.aspx`。由于脚本中使用了 `/ecp` 和 `_aspx` 进行 Hash 计算，因此uri参数必须为ecp,否则无法成功。

如果服务器未打补丁，恶意 ViewState 将被反序列化，导致执行 `NULL-File.xml` 中定义的恶意操作，最终导致远程代码执行。

**项目地址:** [ravinacademy/CVE-2020-0688](https://github.com/ravinacademy/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #18

**来源**: [CVE-2020-0688-righter83_CVE-2020-0688.md](../2020/CVE-2020-0688-righter83_CVE-2020-0688.md)

## CVE-2020-0688

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要获取Exchange用户的凭据，或者能够访问Exchange控制面板(ECP)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，源于 Exchange 控制面板 (ECP) 未能正确处理内存中的对象。攻击者可以利用静态密钥进行 ViewState 反序列化，从而在服务器上执行任意代码。利用方式通常涉及以下步骤：1. 获取Exchange用户的凭据或者能够访问Exchange控制面板(ECP)。2. 使用已知密钥生成恶意的 ViewState 数据。3. 将生成的 ViewState 数据作为请求的一部分发送到 Exchange 服务器。4. 服务器反序列化 ViewState 数据，执行攻击者预设的恶意代码。提供的 POC 脚本 `scanner.php` 仅用于检测目标 Exchange 服务器是否安装了受影响的版本，以及是否安装了修复补丁。该脚本通过检查 OWA 页面中的版本信息来进行判断。虽然该脚本本身的功能是良性的，但存在一定的投毒风险，例如，作者可能在脚本中植入恶意代码，以便在扫描目标服务器时执行其他操作。由于只是版本检测，恶意代码可能性较小。该漏洞的利用需要具备一定的Exchange知识和 .NET 反序列化知识，相对复杂。根据CISA已将此漏洞添加到了已知可利用漏洞目录，表明该漏洞在野外被广泛利用。

**项目地址:** [righter83/CVE-2020-0688](https://github.com/righter83/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #19

**来源**: [CVE-2020-0688-truongtn_cve-2020-0688.md](../2020/CVE-2020-0688-truongtn_cve-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 受影响版本包括 Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要具有Exchange用户的凭据或能够获取到凭据，以及能够访问Exchange Control Panel (ECP)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 的远程代码执行漏洞，源于 Exchange Control Panel (ECP) 在处理内存对象时的方式不当。攻击者可以利用静态密钥进行 ViewState 反序列化，从而执行任意代码。漏洞利用通常涉及以下步骤：

1.  **获取有效的Exchange用户凭据：** 攻击者需要拥有Exchange服务器上用户的有效凭据才能访问ECP。
2.  **构造恶意的ViewState:**  攻击者使用静态密钥构造一个包含恶意代码的 ViewState 对象。
3.  **发送请求：**  攻击者将构造的 ViewState 对象通过 HTTP 请求发送到易受攻击的 ECP 页面。
4.  **代码执行：** Exchange服务器反序列化 ViewState 对象，从而执行攻击者嵌入的恶意代码。

提供的POC代码 `/tmp/01ddbe7d3c9df93cbdc1b119a0d43d96/FSharp.Core.xml` 似乎是一个XML文档，描述了 `FSharp.Core` 程序集的成员。它本身不太可能是直接的利用代码，更像是程序集的一部分或文档。实际的利用代码可能使用这个程序集或其他方式来构造恶意的ViewState。

根据搜索引擎结果，已经有针对此漏洞的公开PoC，并且该漏洞已被积极利用。例如，[zyn3rgy/ecp_slap](https://github.com/zyn3rgy/ecp_slap)仓库包含扫描和利用易受攻击的Exchange实例的函数。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞确实存在并且已被利用，因此利用是有效的。

**投毒风险：**提供的代码片段(`/tmp/01ddbe7d3c9df93cbdc1b119a0d43d96/FSharp.Core.xml`)本身不太可能包含投毒代码，因为看起来只是一个XML文档，描述FSharp.Core程序集的成员。然而，如果从不可信的来源获取完整的利用代码，则存在投毒风险。例如，在其他未提供的代码中，作者可能隐藏了后门或恶意功能。由于只看到部分代码，无法完全排除风险，因此假设有10%的投毒风险。

**利用方式：** 利用方式是利用ECP的ViewState反序列化漏洞，结合已知的静态密钥来执行任意代码。攻击者需要有效的Exchange用户凭据才能访问ECP。攻击者构造一个包含恶意代码的ViewState对象，并将其发送到易受攻击的ECP页面。服务器反序列化该对象后，就会执行恶意代码，从而允许攻击者完全控制Exchange服务器。

**项目地址:** [truongtn/cve-2020-0688](https://github.com/truongtn/cve-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #20

**来源**: [CVE-2020-0688-tvdat20004_CVE-2020-0688.md](../2020/CVE-2020-0688-tvdat20004_CVE-2020-0688.md)

## CVE-2020-0688-Microsoft Exchange Server-RCE

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要有效的Exchange用户凭据，且目标服务器存在CVE-2020-0688漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 漏洞是由于 Microsoft Exchange Server 在处理内存中的对象时未能正确操作而导致的远程代码执行漏洞。攻击者可以通过利用静态密钥进行 ViewState 反序列化，从而在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，此漏洞的利用是有效的。漏洞利用的关键在于利用 Exchange 控制面板 (ECP) 中使用的静态密钥来构造恶意的 ViewState。提供的POC代码尝试自动化这一过程，包括登录OWA, 获取相关参数，然后使用 ysonet.exe 生成恶意 ViewState，最后发送带有恶意ViewState的请求。

**投毒风险：**
虽然POC代码本身旨在利用已知的漏洞，但潜在的投毒风险是存在的。代码中的投毒点可能包括：
1.  `ysonet.exe`：POC依赖外部程序`ysonet.exe`，如果下载的 `ysonet.exe` 文件被篡改，则可能执行恶意的代码，导致攻击者主机中毒。
2.  执行命令：`command` 参数通过`ysonet.exe`在目标服务器执行，如果攻击者更改此参数，可能在目标服务器上执行恶意代码。下载ysoserial.net和更改command参数的风险较高。

因此，代码中存在一定的投毒风险，大约为10%。

**利用方式：**
1.  **身份验证：** 首先，攻击者需要有效的 Exchange 用户凭据，使用用户名密码登录目标OWA。
2.  **获取参数：**  利用脚本获取目标Exchange服务器的`__VIEWSTATEGENERATOR`和`ASP.NET_SessionId`（`session_id`）等参数。
3.  **生成恶意 ViewState：** 使用 `ysonet.exe` 工具，结合静态密钥 (`validationKey` 和 `validationAlg`)以及上一步获取的参数，构造恶意的 ViewState。`ysonet.exe`程序的功能是将命令序列化到ViewState中。
4.  **发送请求：**  将生成的恶意 ViewState 作为参数（`__VIEWSTATE`）发送到 `/ecp/default.aspx` 页面。
5.  **代码执行：**  服务器反序列化 ViewState，执行其中嵌入的恶意代码。

**项目地址:** [tvdat20004/CVE-2020-0688](https://github.com/tvdat20004/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #21

**来源**: [CVE-2020-0688-w4fz5uck5_cve-2020-0688-webshell-upload-technique.md](../2020/CVE-2020-0688-w4fz5uck5_cve-2020-0688-webshell-upload-technique.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可完全控制 Exchange 服务器

**影响版本:** 受影响版本包括：Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 攻击者需要有效的 Exchange 用户凭据才能利用此漏洞，或能够获取到有效的ASP.NET_SessionId

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 的远程代码执行漏洞，存在于 Exchange Control Panel (ECP) 组件中。该漏洞是由于 ECP 在生成 ViewState 时使用了静态密钥进行加密，导致攻击者可以通过已知的密钥构造恶意的 ViewState 数据，从而在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 POC 代码，可以确定此漏洞的 POC 代码是有效的。多个来源表明 CVE-2020-0688 已经被广泛利用，并且存在公开的 POC 代码。

**投毒风险：**
提供的 POC 代码 `fuckchina_v2.py`  包含了以下信息，可能存在投毒风险：
*   作者声明免责声明，表明对非法行为不负责任。
*   代码中使用了`WScript.Shell`对象来执行系统命令，存在潜在的风险。

考虑到代码的开源性质和用途，认为投毒风险较低，大约为10%。这主要是因为攻击者可以审查和修改代码，以适应他们的需要。因此，任何潜在的投毒代码都可能被检测到并删除。

**利用方式：**
1.  **获取 Exchange 用户凭据或有效的 ASP.NET_SessionId：** 攻击者需要有效的 Exchange 用户凭据，或者能够获取到有效的 ASP.NET_SessionId。
2.  **泄露 __VIEWSTATEGENERATOR 值：** 攻击者需要访问 `/ecp/default.aspx` 页面，并从中提取 __VIEWSTATEGENERATOR 值。如果无法提取，则尝试默认值 `B97B4E27`。
3.  **构造恶意的 ViewState 数据：** 使用泄露的 __VIEWSTATEGENERATOR 值和已知的静态密钥，攻击者可以构造恶意的 ViewState 数据，其中包含要执行的恶意代码。
4.  **发送包含恶意 ViewState 数据的请求：** 攻击者将构造的恶意 ViewState 数据通过 POST 请求发送到 ECP 的某个页面，例如 `default.aspx`。
5.  **执行远程代码：** Exchange 服务器在处理包含恶意 ViewState 数据的请求时，会反序列化 ViewState 数据并执行其中的恶意代码，从而导致远程代码执行。

`fuckchina_v2.py`脚本通过上传一个C#编写的ASPX webshell来实现RCE。 webshell 使用 XML 和 XSLT 来绕过 ViewState 的默认大小限制，并执行 `cmd /c` 命令。

**项目地址:** [w4fz5uck5/cve-2020-0688-webshell-upload-technique](https://github.com/w4fz5uck5/cve-2020-0688-webshell-upload-technique)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #22

**来源**: [CVE-2020-0688-youncyb_CVE-2020-0688.md](../2020/CVE-2020-0688-youncyb_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 23, 2019 Cumulative Update 3/4, 2016 Cumulative Update 14/15, 2010 Service Pack 3 Update Rollup 30

**利用条件:** 需要有效的域用户凭据以及能够访问Exchange服务器的ECP接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 中的远程代码执行漏洞，存在于 Exchange Control Panel (ECP) 组件中。该漏洞的根源在于 Exchange 在反序列化 ViewState 数据时使用了硬编码的 validationKey 和 validationAlgorithm。攻击者可以通过构造恶意的 ViewState 数据，利用 Ysoserial.net 等工具生成 payload，然后通过 ECP 接口发送，从而在 Exchange 服务器上执行任意代码。PoC 代码 `CVE-2020-0688.py` 通过模拟登录 OWA 获取 `__VIEWSTATEGENERATOR` 和 `ASP.NET_SessionId`，然后利用 `ysoserial.exe` 生成 payload 并将其注入到 ECP 请求的 `__VIEWSTATE` 参数中，最后发送请求触发漏洞。

**漏洞利用方式：**
1.  获取目标 Exchange 服务器的有效域用户凭据。
2.  使用该凭据登录 OWA，获取 `__VIEWSTATEGENERATOR` 和 `ASP.NET_SessionId`。
3.  使用 `ysoserial.exe` 工具，指定 `__VIEWSTATEGENERATOR` 和硬编码的 `validationKey` 及 `validationAlgorithm`，生成恶意 ViewState payload。
4.  构造包含恶意 ViewState payload 的 ECP 请求，发送到目标 Exchange 服务器。
5.  如果漏洞利用成功，服务器会执行 payload 中的恶意代码。

**投毒风险分析：**
PoC 代码 `CVE-2020-0688.py` 本身的功能是利用漏洞，但存在一定的投毒风险：

*   **ysoserial.exe 的来源：** PoC 代码依赖于外部工具 `ysoserial.exe`，如果该工具被替换为恶意版本，则可能导致攻击者执行的不是预期的命令，而是攻击者植入的恶意代码。
*   **command 参数：** PoC 代码允许攻击者通过 `-c` 参数指定要执行的命令，攻击者可能会无意中或恶意地执行有害的命令。
*   **FSharp.Core.xml:** 虽然文件内容看起来是XML，但是里面并没有显示实际的代码功能，所以推断可能是投毒的代码，但是无法验证。 

**项目地址:** [youncyb/CVE-2020-0688](https://github.com/youncyb/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #23

**来源**: [CVE-2020-0688-zcgonvh_CVE-2020-0688.md](../2020/CVE-2020-0688-zcgonvh_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server Remote Code Execution

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要有效的Exchange用户凭据

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 中的远程代码执行漏洞，源于 Exchange Control Panel (ECP) 组件未能正确处理内存中的对象。攻击者可以利用静态的machineKey进行ViewState反序列化，从而执行任意代码。 

**漏洞利用方式：**

1.  **身份验证：** 攻击者首先需要获取有效的 Exchange 用户凭据，可以通过爆破、钓鱼等方式。
2.  **获取 ViewStateGenerator：** 成功登录后，攻击者需要获取 `__VIEWSTATEGENERATOR` 的值。
3.  **构造恶意 ViewState：** 攻击者使用ysoserial等工具，利用已知密钥构造恶意的 ViewState payload，其中包含要执行的命令。
4.  **发送请求：** 攻击者将包含恶意 ViewState 的请求发送到 Exchange 服务器的 ECP 路径（例如 `/ecp/default.aspx` 或 `/ecp/LiveIdError.aspx`）。
5.  **代码执行：** Exchange 服务器反序列化 ViewState，执行攻击者嵌入的恶意代码。

**关于投毒风险：**
代码总体来说是漏洞的利用，但需要仔细审查以下区域：
*   `ExchangeCmd.cs`中的UpdateMacKey函数,如果被人恶意篡改默认的密钥，可能会导致其他的隐患。虽然本身只是用于dummy file写入，但是需要注意。
*   与ysoserial集成的部分，需要验证生成的payload是否符合预期，防止被替换成恶意payload。

总体来说，投毒的概率较低，主要集中在payload生成和默认配置的修改上。需要复核相关逻辑保证安全。

**项目地址:** [zcgonvh/CVE-2020-0688](https://github.com/zcgonvh/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #24

**来源**: [CVE-2020-0688-zyn3rgy_ecp_slap.md](../2020/CVE-2020-0688-zyn3rgy_ecp_slap.md)

## CVE-2020-0688-Microsoft Exchange Server-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要具有Exchange用户权限，能够访问Exchange Control Panel (ECP)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-0688是Microsoft Exchange Server中的一个远程代码执行漏洞。根据漏洞信息和搜索结果，该漏洞源于Exchange服务器未能正确处理内存中的对象，导致攻击者可以发送特制的payload到服务器并执行嵌入的命令。该漏洞利用的关键在于Exchange Control Panel (ECP)在创建唯一密钥时存在缺陷，使用静态密钥进行ViewState的序列化和反序列化。攻击者可以利用这个静态密钥构造恶意的ViewState，从而在服务器上执行任意代码。

**有效性：**
根据搜索结果和漏洞库信息，存在公开可用的POC代码。Rapid7的博客也证实可以通过该漏洞将Exchange用户账号提升到SYSTEM权限。因此，该漏洞利用的有效性较高。

**投毒风险：**
提供的漏洞利用代码片段仅仅是GNU GPL许可协议。由于该文件本身不包含任何可执行代码或配置信息，因此几乎不存在投毒风险。该代码仓库中其他文件的需要进一步分析，但是仅凭此license文件判断投毒几率可以判定为0%

**利用方式：**
1.  **获取Exchange用户凭据：** 攻击者首先需要拥有一个有效的Exchange用户账户。
2.  **利用静态密钥：** 利用已知的静态密钥（由于Exchange服务器未能正确生成唯一密钥）对`.NET` ViewState进行序列化和反序列化操作。
3.  **构造恶意ViewState：** 构造包含恶意代码的ViewState payload。
4.  **发送请求：** 将构造好的恶意ViewState payload发送到Exchange服务器的ECP页面。
5.  **远程代码执行：** Exchange服务器在处理该ViewState时，由于反序列化漏洞，将执行攻击者嵌入的恶意代码，从而实现远程代码执行。

**项目地址:** [zyn3rgy/ecp_slap](https://github.com/zyn3rgy/ecp_slap)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---



---

## POC #14

**来源**: [CVE-2020-0688-murataydemir_CVE-2020-0688.md](../2020/CVE-2020-0688-murataydemir_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全系统权限控制

**影响版本:** 受影响版本包括：Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要有效的Exchange用户凭据进行身份验证，以及对Exchange Control Panel (ECP) 的网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 的远程代码执行漏洞，源于 ECP 组件中使用了静态的 cryptographic key。攻击者利用已知密钥伪造 ViewState 数据，从而在服务器上执行任意代码，获取SYSTEM权限。

**有效性：**
提供的POC代码有效。根据漏洞描述，Exchange Server 所有安装共享相同的 validationKey 和 decryptionKey，允许经过身份验证的攻击者通过构造恶意的 ViewState 数据进行反序列化攻击，从而执行任意代码。

**投毒风险：**
该POC代码主要提供的是漏洞利用方法，并引用了YSoSerial.net工具生成payload，本身不包含任何恶意代码或后门。因此，投毒风险极低。

**利用方式：**
1.  攻击者首先需要获取一个有效的Exchange用户账户的凭据（可以通过钓鱼或其他手段）。
2.  使用该凭据登录到 Exchange 的 OWA 或 ECP 页面，获取 `ASP_NET_SessionId` 和 `__VIEWSTATEGENERATOR` 的值。
3.  使用 `YSoSerial.net` 工具，利用已知 `validationKey` (CB2721ABDAF8E9DC516D621D8B8BF13A2C9E8689A25303BF) 和 `validationalg` (SHA1) 生成恶意的 ViewState payload。可以构造payload执行任意命令，例如反弹shell。
4.  将生成的 ViewState payload 插入到 ECP 的请求中，发送到服务器。例如：`http(s)://exchangeserver/ecp/default.aspx?__VIEWSTATEGENERATOR=<generator>&__VIEWSTATE=<ViewState_Payload>`
5.  服务器在处理该请求时，会反序列化恶意的 ViewState 数据，从而执行攻击者指定的代码，最终导致远程代码执行。

**项目地址:** [murataydemir/CVE-2020-0688](https://github.com/murataydemir/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #15

**来源**: [CVE-2020-0688-onSec-fr_CVE-2020-0688-Scanner.md](../2020/CVE-2020-0688-onSec-fr_CVE-2020-0688-Scanner.md)

## CVE-2020-0688-Microsoft Exchange Server-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要Exchange Control Panel (ECP)可访问，并已知有效的用户凭据（可以是通过其他方式获得的被盗凭据）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，源于 Exchange Control Panel (ECP) 组件未能正确处理内存中的对象。该漏洞允许经过身份验证的攻击者通过向服务器发送特制的 payload 来执行任意代码。

**有效性：**
根据搜索引擎结果，该漏洞的利用代码（PoC）是存在的，并且已被积极利用。从提供的文件列表来看，存在 `CVE-2020-0688-Scanner.exe.config` 和 `HtmlAgilityPack.xml` ，这表明该 PoC 可能是使用 .NET Framework 编写的扫描器，用于检测目标 Exchange 服务器是否存在漏洞。因此可以判断提供的POC代码有效。

**投毒风险：**
鉴于提供的文件仅为配置文件和 HTML 解析库的 XML 文档，直接从这些文件判断是否存在投毒代码比较困难。但是，由于漏洞利用涉及远程代码执行，攻击者完全可能在利用过程中植入恶意代码。`CVE-2020-0688-Scanner.exe.config` 本身没有可疑之处，但是最终的扫描器程序 `CVE-2020-0688-Scanner.exe` 可能存在被篡改的风险。漏洞利用代码的投毒风险评估为10%，主要考虑潜在的恶意第三方修改。

**利用方式：**
利用 CVE-2020-0688 的核心在于 Exchange Control Panel (ECP) 使用静态密钥进行 ViewState 数据的序列化和反序列化。攻击者可以利用此静态密钥构造恶意的 ViewState payload，当 Exchange 服务器反序列化此 payload 时，即可执行攻击者指定的任意代码。利用步骤大致如下：

1.  获取 Exchange 服务器的静态密钥（`validationKey` 和 `decryptionKey`）。
2.  构造包含恶意代码的 ViewState payload。
3.  将构造的 payload 发送到 Exchange 服务器的 ECP 接口。
4.  Exchange 服务器反序列化 payload 并执行恶意代码，实现远程代码执行。

攻击者可以先通过爆破、信息泄露等手段获取Exchange的用户凭据，再借助此漏洞将权限提升至SYSTEM。


**项目地址:** [onSec-fr/CVE-2020-0688-Scanner](https://github.com/onSec-fr/CVE-2020-0688-Scanner)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #16

**来源**: [CVE-2020-0688-random-robbie_cve-2020-0688.md](../2020/CVE-2020-0688-random-robbie_cve-2020-0688.md)

## CVE-2020-0688-Microsoft Exchange Server-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要有效的Exchange用户凭证，能够访问ECP (Exchange Control Panel)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688是一个Microsoft Exchange服务器的远程代码执行漏洞，源于服务器在安装时未能正确创建唯一的密钥。攻击者可以利用该漏洞通过Exchange Control Panel (ECP)组件发送特制的payload执行任意代码。利用过程包括：

1.  **获取必要信息：** 首先，需要一个有效的Exchange用户账户（邮箱地址和密码），用于登录OWA（Outlook Web App）。登录后，需要从响应中提取`__VIEWSTATEGENERATOR`参数和`ASP.NET_SessionId` cookie。
2.  **生成ViewState Payload：** 使用`ysoserial.net`工具，基于`TextFormattingRunProperties` gadget生成恶意的ViewState payload。需要指定`--validationalg`为`SHA1`，`--validationkey`为静态的`CB2721ABDAF8E9DC516D621D8B8BF13A2C9E8689A25303BF`（这是此漏洞的核心：硬编码的密钥），`--generator`为从页面源码中获取的`__VIEWSTATEGENERATOR`值，`--viewstateuserkey`为从cookie中提取的`ASP.NET_SessionId`值。command 为需要执行的命令。
3.  **发送恶意请求：** 将生成的ViewState payload附加到对ECP的请求中，通过`__VIEWSTATE`参数传递。 URL示例: `https://localhost/ecp/default.aspx?__VIEWSTATEGENERATOR=<generator>&__VIEWSTATE=<ViewState>`。

提供的`exploit.py`脚本尝试自动化这个过程，但注释表明它**尚未经过测试，需要进一步完善**。特别是 ViewState 值的生成需要在外部完成，脚本只负责登录和参数提取。

**关于投毒风险：**

`exploit.py`脚本本身相对简单，主要功能是登录OWA并提取必要的参数。潜在的风险可能存在于以下几点：
*   作者提供的`ysoserial.net`下载链接，如果链接被替换为恶意的`ysoserial.net`版本，可能包含恶意代码，但在Github上的相关链接通常是安全的，不过需要谨慎。
*   在`exploit.py`中，如果作者有意在后续完善中添加恶意代码，例如，在生成payload时执行某些恶意操作，则存在潜在风险。
*   `README.md`中要求下载`YSO`， 如果被替换为恶意链接,会存在投毒风险。

考虑到脚本的简单性以及需要外部工具生成payload，直接的投毒风险较低，综合评估为10%。主要风险在于使用者下载的外部工具可能被篡改。

**有效性分析：**
根据漏洞描述和搜索结果，此漏洞利用的关键在于使用了硬编码的`validationkey`。如果目标Exchange服务器未打补丁，且使用了受影响的版本，利用成功的可能性较高。提供的POC代码需要手动生成ViewState payload，脚本只是辅助提取参数，因此代码的有效性取决于payload的生成是否正确以及目标服务器是否符合漏洞利用的条件。


**项目地址:** [random-robbie/cve-2020-0688](https://github.com/random-robbie/cve-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #17

**来源**: [CVE-2020-0688-ravinacademy_CVE-2020-0688.md](../2020/CVE-2020-0688-ravinacademy_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要Exchange服务器的访问权限，以及有效的Exchange用户凭据（可以通过窃取获得）。利用需要目标服务器未安装相应的安全补丁，且攻击者能够访问 ECP (Exchange Control Panel) 或 OWA (Outlook Web App)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 中的远程代码执行漏洞，源于 Exchange 在安装时未能正确创建唯一的密钥。攻击者可以利用此漏洞通过构造恶意的 ViewState 数据包，在服务器上执行任意代码。攻击通常涉及以下步骤：

1.  **获取 Exchange 服务器的验证密钥 (validationKey) 和解密密钥 (decryptionKey)**：这些密钥通常存储在 web.config 文件中。虽然不是 POC 的一部分，但是利用此漏洞需要获取这些密钥。
2.  **构造恶意的 ViewState**：利用提供的 PowerShell 脚本 `CVE-2020-0688.ps1`，结合 `NULL-File.xml` payload，可以生成恶意的 ViewState。脚本的核心在于通过 TextFormattingRunPropertiesMarshal 类进行反序列化操作，从而执行任意代码。
3.  **发送 ViewState**：将构造的 ViewState 作为参数发送到 Exchange 服务器的 ECP 或 OWA 页面。

**有效性评估：**

提供的 POC 代码有效。它利用了 ViewState 的不安全反序列化漏洞来执行任意代码。多个来源（包括 GitHub 和安全博客）都确认了此漏洞的存在和利用的有效性。

**投毒风险评估：**

尽管提供的 POC 脚本主要功能是生成 ViewState，看似无害，但是依然存在微小的投毒风险（10%）。`NULL-File.xml` 文件的目的是创建一个 `Ravin.aspx` 文件，文件内容为空。作者可能替换掉这个aspx文件内容，植入恶意代码,从而实现后门。此外，攻击者可以修改 PowerShell 脚本以包含额外的恶意操作，例如，下载并执行任意程序。不过，从表面上看，该脚本的主要功能是生成 ViewState，而真正的恶意代码需要在 ViewState 中构造。

**漏洞利用方式：**

1.  **攻击者需要具有Exchange用户的权限。**
2.  **获取validationKey和decryptionKey。** 这是成功利用漏洞的关键。
3.  **利用 PowerShell 脚本构造恶意的 ViewState。** 脚本 `CVE-2020-0688.ps1` 使用 `NULL-File.xml` 作为 payload 示例。 `NULL-File.xml` 的作用是尝试在 Exchange 服务器上创建一个空白的 ASPX 文件 (`Ravin.aspx`)。这本身可能不是恶意行为，但它为进一步的攻击打开了大门，攻击者可以上传包含恶意代码的 ASPX 文件，从而实现远程代码执行。
4.  **将构造的 ViewState 通过 HTTP 请求发送到 Exchange 服务器的 ECP 或 OWA 页面。**  目标页面通常是 `ecp/default.aspx` 或 `owa/auth/logon.aspx`。由于脚本中使用了 `/ecp` 和 `_aspx` 进行 Hash 计算，因此uri参数必须为ecp,否则无法成功。

如果服务器未打补丁，恶意 ViewState 将被反序列化，导致执行 `NULL-File.xml` 中定义的恶意操作，最终导致远程代码执行。

**项目地址:** [ravinacademy/CVE-2020-0688](https://github.com/ravinacademy/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #18

**来源**: [CVE-2020-0688-righter83_CVE-2020-0688.md](../2020/CVE-2020-0688-righter83_CVE-2020-0688.md)

## CVE-2020-0688

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要获取Exchange用户的凭据，或者能够访问Exchange控制面板(ECP)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，源于 Exchange 控制面板 (ECP) 未能正确处理内存中的对象。攻击者可以利用静态密钥进行 ViewState 反序列化，从而在服务器上执行任意代码。利用方式通常涉及以下步骤：1. 获取Exchange用户的凭据或者能够访问Exchange控制面板(ECP)。2. 使用已知密钥生成恶意的 ViewState 数据。3. 将生成的 ViewState 数据作为请求的一部分发送到 Exchange 服务器。4. 服务器反序列化 ViewState 数据，执行攻击者预设的恶意代码。提供的 POC 脚本 `scanner.php` 仅用于检测目标 Exchange 服务器是否安装了受影响的版本，以及是否安装了修复补丁。该脚本通过检查 OWA 页面中的版本信息来进行判断。虽然该脚本本身的功能是良性的，但存在一定的投毒风险，例如，作者可能在脚本中植入恶意代码，以便在扫描目标服务器时执行其他操作。由于只是版本检测，恶意代码可能性较小。该漏洞的利用需要具备一定的Exchange知识和 .NET 反序列化知识，相对复杂。根据CISA已将此漏洞添加到了已知可利用漏洞目录，表明该漏洞在野外被广泛利用。

**项目地址:** [righter83/CVE-2020-0688](https://github.com/righter83/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #19

**来源**: [CVE-2020-0688-truongtn_cve-2020-0688.md](../2020/CVE-2020-0688-truongtn_cve-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 受影响版本包括 Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要具有Exchange用户的凭据或能够获取到凭据，以及能够访问Exchange Control Panel (ECP)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 的远程代码执行漏洞，源于 Exchange Control Panel (ECP) 在处理内存对象时的方式不当。攻击者可以利用静态密钥进行 ViewState 反序列化，从而执行任意代码。漏洞利用通常涉及以下步骤：

1.  **获取有效的Exchange用户凭据：** 攻击者需要拥有Exchange服务器上用户的有效凭据才能访问ECP。
2.  **构造恶意的ViewState:**  攻击者使用静态密钥构造一个包含恶意代码的 ViewState 对象。
3.  **发送请求：**  攻击者将构造的 ViewState 对象通过 HTTP 请求发送到易受攻击的 ECP 页面。
4.  **代码执行：** Exchange服务器反序列化 ViewState 对象，从而执行攻击者嵌入的恶意代码。

提供的POC代码 `/tmp/01ddbe7d3c9df93cbdc1b119a0d43d96/FSharp.Core.xml` 似乎是一个XML文档，描述了 `FSharp.Core` 程序集的成员。它本身不太可能是直接的利用代码，更像是程序集的一部分或文档。实际的利用代码可能使用这个程序集或其他方式来构造恶意的ViewState。

根据搜索引擎结果，已经有针对此漏洞的公开PoC，并且该漏洞已被积极利用。例如，[zyn3rgy/ecp_slap](https://github.com/zyn3rgy/ecp_slap)仓库包含扫描和利用易受攻击的Exchange实例的函数。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞确实存在并且已被利用，因此利用是有效的。

**投毒风险：**提供的代码片段(`/tmp/01ddbe7d3c9df93cbdc1b119a0d43d96/FSharp.Core.xml`)本身不太可能包含投毒代码，因为看起来只是一个XML文档，描述FSharp.Core程序集的成员。然而，如果从不可信的来源获取完整的利用代码，则存在投毒风险。例如，在其他未提供的代码中，作者可能隐藏了后门或恶意功能。由于只看到部分代码，无法完全排除风险，因此假设有10%的投毒风险。

**利用方式：** 利用方式是利用ECP的ViewState反序列化漏洞，结合已知的静态密钥来执行任意代码。攻击者需要有效的Exchange用户凭据才能访问ECP。攻击者构造一个包含恶意代码的ViewState对象，并将其发送到易受攻击的ECP页面。服务器反序列化该对象后，就会执行恶意代码，从而允许攻击者完全控制Exchange服务器。

**项目地址:** [truongtn/cve-2020-0688](https://github.com/truongtn/cve-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #20

**来源**: [CVE-2020-0688-tvdat20004_CVE-2020-0688.md](../2020/CVE-2020-0688-tvdat20004_CVE-2020-0688.md)

## CVE-2020-0688-Microsoft Exchange Server-RCE

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要有效的Exchange用户凭据，且目标服务器存在CVE-2020-0688漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 漏洞是由于 Microsoft Exchange Server 在处理内存中的对象时未能正确操作而导致的远程代码执行漏洞。攻击者可以通过利用静态密钥进行 ViewState 反序列化，从而在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，此漏洞的利用是有效的。漏洞利用的关键在于利用 Exchange 控制面板 (ECP) 中使用的静态密钥来构造恶意的 ViewState。提供的POC代码尝试自动化这一过程，包括登录OWA, 获取相关参数，然后使用 ysonet.exe 生成恶意 ViewState，最后发送带有恶意ViewState的请求。

**投毒风险：**
虽然POC代码本身旨在利用已知的漏洞，但潜在的投毒风险是存在的。代码中的投毒点可能包括：
1.  `ysonet.exe`：POC依赖外部程序`ysonet.exe`，如果下载的 `ysonet.exe` 文件被篡改，则可能执行恶意的代码，导致攻击者主机中毒。
2.  执行命令：`command` 参数通过`ysonet.exe`在目标服务器执行，如果攻击者更改此参数，可能在目标服务器上执行恶意代码。下载ysoserial.net和更改command参数的风险较高。

因此，代码中存在一定的投毒风险，大约为10%。

**利用方式：**
1.  **身份验证：** 首先，攻击者需要有效的 Exchange 用户凭据，使用用户名密码登录目标OWA。
2.  **获取参数：**  利用脚本获取目标Exchange服务器的`__VIEWSTATEGENERATOR`和`ASP.NET_SessionId`（`session_id`）等参数。
3.  **生成恶意 ViewState：** 使用 `ysonet.exe` 工具，结合静态密钥 (`validationKey` 和 `validationAlg`)以及上一步获取的参数，构造恶意的 ViewState。`ysonet.exe`程序的功能是将命令序列化到ViewState中。
4.  **发送请求：**  将生成的恶意 ViewState 作为参数（`__VIEWSTATE`）发送到 `/ecp/default.aspx` 页面。
5.  **代码执行：**  服务器反序列化 ViewState，执行其中嵌入的恶意代码。

**项目地址:** [tvdat20004/CVE-2020-0688](https://github.com/tvdat20004/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #21

**来源**: [CVE-2020-0688-w4fz5uck5_cve-2020-0688-webshell-upload-technique.md](../2020/CVE-2020-0688-w4fz5uck5_cve-2020-0688-webshell-upload-technique.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可完全控制 Exchange 服务器

**影响版本:** 受影响版本包括：Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 攻击者需要有效的 Exchange 用户凭据才能利用此漏洞，或能够获取到有效的ASP.NET_SessionId

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 的远程代码执行漏洞，存在于 Exchange Control Panel (ECP) 组件中。该漏洞是由于 ECP 在生成 ViewState 时使用了静态密钥进行加密，导致攻击者可以通过已知的密钥构造恶意的 ViewState 数据，从而在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 POC 代码，可以确定此漏洞的 POC 代码是有效的。多个来源表明 CVE-2020-0688 已经被广泛利用，并且存在公开的 POC 代码。

**投毒风险：**
提供的 POC 代码 `fuckchina_v2.py`  包含了以下信息，可能存在投毒风险：
*   作者声明免责声明，表明对非法行为不负责任。
*   代码中使用了`WScript.Shell`对象来执行系统命令，存在潜在的风险。

考虑到代码的开源性质和用途，认为投毒风险较低，大约为10%。这主要是因为攻击者可以审查和修改代码，以适应他们的需要。因此，任何潜在的投毒代码都可能被检测到并删除。

**利用方式：**
1.  **获取 Exchange 用户凭据或有效的 ASP.NET_SessionId：** 攻击者需要有效的 Exchange 用户凭据，或者能够获取到有效的 ASP.NET_SessionId。
2.  **泄露 __VIEWSTATEGENERATOR 值：** 攻击者需要访问 `/ecp/default.aspx` 页面，并从中提取 __VIEWSTATEGENERATOR 值。如果无法提取，则尝试默认值 `B97B4E27`。
3.  **构造恶意的 ViewState 数据：** 使用泄露的 __VIEWSTATEGENERATOR 值和已知的静态密钥，攻击者可以构造恶意的 ViewState 数据，其中包含要执行的恶意代码。
4.  **发送包含恶意 ViewState 数据的请求：** 攻击者将构造的恶意 ViewState 数据通过 POST 请求发送到 ECP 的某个页面，例如 `default.aspx`。
5.  **执行远程代码：** Exchange 服务器在处理包含恶意 ViewState 数据的请求时，会反序列化 ViewState 数据并执行其中的恶意代码，从而导致远程代码执行。

`fuckchina_v2.py`脚本通过上传一个C#编写的ASPX webshell来实现RCE。 webshell 使用 XML 和 XSLT 来绕过 ViewState 的默认大小限制，并执行 `cmd /c` 命令。

**项目地址:** [w4fz5uck5/cve-2020-0688-webshell-upload-technique](https://github.com/w4fz5uck5/cve-2020-0688-webshell-upload-technique)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #22

**来源**: [CVE-2020-0688-youncyb_CVE-2020-0688.md](../2020/CVE-2020-0688-youncyb_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 23, 2019 Cumulative Update 3/4, 2016 Cumulative Update 14/15, 2010 Service Pack 3 Update Rollup 30

**利用条件:** 需要有效的域用户凭据以及能够访问Exchange服务器的ECP接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 中的远程代码执行漏洞，存在于 Exchange Control Panel (ECP) 组件中。该漏洞的根源在于 Exchange 在反序列化 ViewState 数据时使用了硬编码的 validationKey 和 validationAlgorithm。攻击者可以通过构造恶意的 ViewState 数据，利用 Ysoserial.net 等工具生成 payload，然后通过 ECP 接口发送，从而在 Exchange 服务器上执行任意代码。PoC 代码 `CVE-2020-0688.py` 通过模拟登录 OWA 获取 `__VIEWSTATEGENERATOR` 和 `ASP.NET_SessionId`，然后利用 `ysoserial.exe` 生成 payload 并将其注入到 ECP 请求的 `__VIEWSTATE` 参数中，最后发送请求触发漏洞。

**漏洞利用方式：**
1.  获取目标 Exchange 服务器的有效域用户凭据。
2.  使用该凭据登录 OWA，获取 `__VIEWSTATEGENERATOR` 和 `ASP.NET_SessionId`。
3.  使用 `ysoserial.exe` 工具，指定 `__VIEWSTATEGENERATOR` 和硬编码的 `validationKey` 及 `validationAlgorithm`，生成恶意 ViewState payload。
4.  构造包含恶意 ViewState payload 的 ECP 请求，发送到目标 Exchange 服务器。
5.  如果漏洞利用成功，服务器会执行 payload 中的恶意代码。

**投毒风险分析：**
PoC 代码 `CVE-2020-0688.py` 本身的功能是利用漏洞，但存在一定的投毒风险：

*   **ysoserial.exe 的来源：** PoC 代码依赖于外部工具 `ysoserial.exe`，如果该工具被替换为恶意版本，则可能导致攻击者执行的不是预期的命令，而是攻击者植入的恶意代码。
*   **command 参数：** PoC 代码允许攻击者通过 `-c` 参数指定要执行的命令，攻击者可能会无意中或恶意地执行有害的命令。
*   **FSharp.Core.xml:** 虽然文件内容看起来是XML，但是里面并没有显示实际的代码功能，所以推断可能是投毒的代码，但是无法验证。 

**项目地址:** [youncyb/CVE-2020-0688](https://github.com/youncyb/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #23

**来源**: [CVE-2020-0688-zcgonvh_CVE-2020-0688.md](../2020/CVE-2020-0688-zcgonvh_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server Remote Code Execution

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要有效的Exchange用户凭据

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 中的远程代码执行漏洞，源于 Exchange Control Panel (ECP) 组件未能正确处理内存中的对象。攻击者可以利用静态的machineKey进行ViewState反序列化，从而执行任意代码。 

**漏洞利用方式：**

1.  **身份验证：** 攻击者首先需要获取有效的 Exchange 用户凭据，可以通过爆破、钓鱼等方式。
2.  **获取 ViewStateGenerator：** 成功登录后，攻击者需要获取 `__VIEWSTATEGENERATOR` 的值。
3.  **构造恶意 ViewState：** 攻击者使用ysoserial等工具，利用已知密钥构造恶意的 ViewState payload，其中包含要执行的命令。
4.  **发送请求：** 攻击者将包含恶意 ViewState 的请求发送到 Exchange 服务器的 ECP 路径（例如 `/ecp/default.aspx` 或 `/ecp/LiveIdError.aspx`）。
5.  **代码执行：** Exchange 服务器反序列化 ViewState，执行攻击者嵌入的恶意代码。

**关于投毒风险：**
代码总体来说是漏洞的利用，但需要仔细审查以下区域：
*   `ExchangeCmd.cs`中的UpdateMacKey函数,如果被人恶意篡改默认的密钥，可能会导致其他的隐患。虽然本身只是用于dummy file写入，但是需要注意。
*   与ysoserial集成的部分，需要验证生成的payload是否符合预期，防止被替换成恶意payload。

总体来说，投毒的概率较低，主要集中在payload生成和默认配置的修改上。需要复核相关逻辑保证安全。

**项目地址:** [zcgonvh/CVE-2020-0688](https://github.com/zcgonvh/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #24

**来源**: [CVE-2020-0688-zyn3rgy_ecp_slap.md](../2020/CVE-2020-0688-zyn3rgy_ecp_slap.md)

## CVE-2020-0688-Microsoft Exchange Server-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要具有Exchange用户权限，能够访问Exchange Control Panel (ECP)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-0688是Microsoft Exchange Server中的一个远程代码执行漏洞。根据漏洞信息和搜索结果，该漏洞源于Exchange服务器未能正确处理内存中的对象，导致攻击者可以发送特制的payload到服务器并执行嵌入的命令。该漏洞利用的关键在于Exchange Control Panel (ECP)在创建唯一密钥时存在缺陷，使用静态密钥进行ViewState的序列化和反序列化。攻击者可以利用这个静态密钥构造恶意的ViewState，从而在服务器上执行任意代码。

**有效性：**
根据搜索结果和漏洞库信息，存在公开可用的POC代码。Rapid7的博客也证实可以通过该漏洞将Exchange用户账号提升到SYSTEM权限。因此，该漏洞利用的有效性较高。

**投毒风险：**
提供的漏洞利用代码片段仅仅是GNU GPL许可协议。由于该文件本身不包含任何可执行代码或配置信息，因此几乎不存在投毒风险。该代码仓库中其他文件的需要进一步分析，但是仅凭此license文件判断投毒几率可以判定为0%

**利用方式：**
1.  **获取Exchange用户凭据：** 攻击者首先需要拥有一个有效的Exchange用户账户。
2.  **利用静态密钥：** 利用已知的静态密钥（由于Exchange服务器未能正确生成唯一密钥）对`.NET` ViewState进行序列化和反序列化操作。
3.  **构造恶意ViewState：** 构造包含恶意代码的ViewState payload。
4.  **发送请求：** 将构造好的恶意ViewState payload发送到Exchange服务器的ECP页面。
5.  **远程代码执行：** Exchange服务器在处理该ViewState时，由于反序列化漏洞，将执行攻击者嵌入的恶意代码，从而实现远程代码执行。

**项目地址:** [zyn3rgy/ecp_slap](https://github.com/zyn3rgy/ecp_slap)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---



---

## POC #14

**来源**: [CVE-2020-0688-murataydemir_CVE-2020-0688.md](../2020/CVE-2020-0688-murataydemir_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全系统权限控制

**影响版本:** 受影响版本包括：Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要有效的Exchange用户凭据进行身份验证，以及对Exchange Control Panel (ECP) 的网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 的远程代码执行漏洞，源于 ECP 组件中使用了静态的 cryptographic key。攻击者利用已知密钥伪造 ViewState 数据，从而在服务器上执行任意代码，获取SYSTEM权限。

**有效性：**
提供的POC代码有效。根据漏洞描述，Exchange Server 所有安装共享相同的 validationKey 和 decryptionKey，允许经过身份验证的攻击者通过构造恶意的 ViewState 数据进行反序列化攻击，从而执行任意代码。

**投毒风险：**
该POC代码主要提供的是漏洞利用方法，并引用了YSoSerial.net工具生成payload，本身不包含任何恶意代码或后门。因此，投毒风险极低。

**利用方式：**
1.  攻击者首先需要获取一个有效的Exchange用户账户的凭据（可以通过钓鱼或其他手段）。
2.  使用该凭据登录到 Exchange 的 OWA 或 ECP 页面，获取 `ASP_NET_SessionId` 和 `__VIEWSTATEGENERATOR` 的值。
3.  使用 `YSoSerial.net` 工具，利用已知 `validationKey` (CB2721ABDAF8E9DC516D621D8B8BF13A2C9E8689A25303BF) 和 `validationalg` (SHA1) 生成恶意的 ViewState payload。可以构造payload执行任意命令，例如反弹shell。
4.  将生成的 ViewState payload 插入到 ECP 的请求中，发送到服务器。例如：`http(s)://exchangeserver/ecp/default.aspx?__VIEWSTATEGENERATOR=<generator>&__VIEWSTATE=<ViewState_Payload>`
5.  服务器在处理该请求时，会反序列化恶意的 ViewState 数据，从而执行攻击者指定的代码，最终导致远程代码执行。

**项目地址:** [murataydemir/CVE-2020-0688](https://github.com/murataydemir/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #15

**来源**: [CVE-2020-0688-onSec-fr_CVE-2020-0688-Scanner.md](../2020/CVE-2020-0688-onSec-fr_CVE-2020-0688-Scanner.md)

## CVE-2020-0688-Microsoft Exchange Server-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要Exchange Control Panel (ECP)可访问，并已知有效的用户凭据（可以是通过其他方式获得的被盗凭据）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，源于 Exchange Control Panel (ECP) 组件未能正确处理内存中的对象。该漏洞允许经过身份验证的攻击者通过向服务器发送特制的 payload 来执行任意代码。

**有效性：**
根据搜索引擎结果，该漏洞的利用代码（PoC）是存在的，并且已被积极利用。从提供的文件列表来看，存在 `CVE-2020-0688-Scanner.exe.config` 和 `HtmlAgilityPack.xml` ，这表明该 PoC 可能是使用 .NET Framework 编写的扫描器，用于检测目标 Exchange 服务器是否存在漏洞。因此可以判断提供的POC代码有效。

**投毒风险：**
鉴于提供的文件仅为配置文件和 HTML 解析库的 XML 文档，直接从这些文件判断是否存在投毒代码比较困难。但是，由于漏洞利用涉及远程代码执行，攻击者完全可能在利用过程中植入恶意代码。`CVE-2020-0688-Scanner.exe.config` 本身没有可疑之处，但是最终的扫描器程序 `CVE-2020-0688-Scanner.exe` 可能存在被篡改的风险。漏洞利用代码的投毒风险评估为10%，主要考虑潜在的恶意第三方修改。

**利用方式：**
利用 CVE-2020-0688 的核心在于 Exchange Control Panel (ECP) 使用静态密钥进行 ViewState 数据的序列化和反序列化。攻击者可以利用此静态密钥构造恶意的 ViewState payload，当 Exchange 服务器反序列化此 payload 时，即可执行攻击者指定的任意代码。利用步骤大致如下：

1.  获取 Exchange 服务器的静态密钥（`validationKey` 和 `decryptionKey`）。
2.  构造包含恶意代码的 ViewState payload。
3.  将构造的 payload 发送到 Exchange 服务器的 ECP 接口。
4.  Exchange 服务器反序列化 payload 并执行恶意代码，实现远程代码执行。

攻击者可以先通过爆破、信息泄露等手段获取Exchange的用户凭据，再借助此漏洞将权限提升至SYSTEM。


**项目地址:** [onSec-fr/CVE-2020-0688-Scanner](https://github.com/onSec-fr/CVE-2020-0688-Scanner)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #16

**来源**: [CVE-2020-0688-random-robbie_cve-2020-0688.md](../2020/CVE-2020-0688-random-robbie_cve-2020-0688.md)

## CVE-2020-0688-Microsoft Exchange Server-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要有效的Exchange用户凭证，能够访问ECP (Exchange Control Panel)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688是一个Microsoft Exchange服务器的远程代码执行漏洞，源于服务器在安装时未能正确创建唯一的密钥。攻击者可以利用该漏洞通过Exchange Control Panel (ECP)组件发送特制的payload执行任意代码。利用过程包括：

1.  **获取必要信息：** 首先，需要一个有效的Exchange用户账户（邮箱地址和密码），用于登录OWA（Outlook Web App）。登录后，需要从响应中提取`__VIEWSTATEGENERATOR`参数和`ASP.NET_SessionId` cookie。
2.  **生成ViewState Payload：** 使用`ysoserial.net`工具，基于`TextFormattingRunProperties` gadget生成恶意的ViewState payload。需要指定`--validationalg`为`SHA1`，`--validationkey`为静态的`CB2721ABDAF8E9DC516D621D8B8BF13A2C9E8689A25303BF`（这是此漏洞的核心：硬编码的密钥），`--generator`为从页面源码中获取的`__VIEWSTATEGENERATOR`值，`--viewstateuserkey`为从cookie中提取的`ASP.NET_SessionId`值。command 为需要执行的命令。
3.  **发送恶意请求：** 将生成的ViewState payload附加到对ECP的请求中，通过`__VIEWSTATE`参数传递。 URL示例: `https://localhost/ecp/default.aspx?__VIEWSTATEGENERATOR=<generator>&__VIEWSTATE=<ViewState>`。

提供的`exploit.py`脚本尝试自动化这个过程，但注释表明它**尚未经过测试，需要进一步完善**。特别是 ViewState 值的生成需要在外部完成，脚本只负责登录和参数提取。

**关于投毒风险：**

`exploit.py`脚本本身相对简单，主要功能是登录OWA并提取必要的参数。潜在的风险可能存在于以下几点：
*   作者提供的`ysoserial.net`下载链接，如果链接被替换为恶意的`ysoserial.net`版本，可能包含恶意代码，但在Github上的相关链接通常是安全的，不过需要谨慎。
*   在`exploit.py`中，如果作者有意在后续完善中添加恶意代码，例如，在生成payload时执行某些恶意操作，则存在潜在风险。
*   `README.md`中要求下载`YSO`， 如果被替换为恶意链接,会存在投毒风险。

考虑到脚本的简单性以及需要外部工具生成payload，直接的投毒风险较低，综合评估为10%。主要风险在于使用者下载的外部工具可能被篡改。

**有效性分析：**
根据漏洞描述和搜索结果，此漏洞利用的关键在于使用了硬编码的`validationkey`。如果目标Exchange服务器未打补丁，且使用了受影响的版本，利用成功的可能性较高。提供的POC代码需要手动生成ViewState payload，脚本只是辅助提取参数，因此代码的有效性取决于payload的生成是否正确以及目标服务器是否符合漏洞利用的条件。


**项目地址:** [random-robbie/cve-2020-0688](https://github.com/random-robbie/cve-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #17

**来源**: [CVE-2020-0688-ravinacademy_CVE-2020-0688.md](../2020/CVE-2020-0688-ravinacademy_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要Exchange服务器的访问权限，以及有效的Exchange用户凭据（可以通过窃取获得）。利用需要目标服务器未安装相应的安全补丁，且攻击者能够访问 ECP (Exchange Control Panel) 或 OWA (Outlook Web App)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 中的远程代码执行漏洞，源于 Exchange 在安装时未能正确创建唯一的密钥。攻击者可以利用此漏洞通过构造恶意的 ViewState 数据包，在服务器上执行任意代码。攻击通常涉及以下步骤：

1.  **获取 Exchange 服务器的验证密钥 (validationKey) 和解密密钥 (decryptionKey)**：这些密钥通常存储在 web.config 文件中。虽然不是 POC 的一部分，但是利用此漏洞需要获取这些密钥。
2.  **构造恶意的 ViewState**：利用提供的 PowerShell 脚本 `CVE-2020-0688.ps1`，结合 `NULL-File.xml` payload，可以生成恶意的 ViewState。脚本的核心在于通过 TextFormattingRunPropertiesMarshal 类进行反序列化操作，从而执行任意代码。
3.  **发送 ViewState**：将构造的 ViewState 作为参数发送到 Exchange 服务器的 ECP 或 OWA 页面。

**有效性评估：**

提供的 POC 代码有效。它利用了 ViewState 的不安全反序列化漏洞来执行任意代码。多个来源（包括 GitHub 和安全博客）都确认了此漏洞的存在和利用的有效性。

**投毒风险评估：**

尽管提供的 POC 脚本主要功能是生成 ViewState，看似无害，但是依然存在微小的投毒风险（10%）。`NULL-File.xml` 文件的目的是创建一个 `Ravin.aspx` 文件，文件内容为空。作者可能替换掉这个aspx文件内容，植入恶意代码,从而实现后门。此外，攻击者可以修改 PowerShell 脚本以包含额外的恶意操作，例如，下载并执行任意程序。不过，从表面上看，该脚本的主要功能是生成 ViewState，而真正的恶意代码需要在 ViewState 中构造。

**漏洞利用方式：**

1.  **攻击者需要具有Exchange用户的权限。**
2.  **获取validationKey和decryptionKey。** 这是成功利用漏洞的关键。
3.  **利用 PowerShell 脚本构造恶意的 ViewState。** 脚本 `CVE-2020-0688.ps1` 使用 `NULL-File.xml` 作为 payload 示例。 `NULL-File.xml` 的作用是尝试在 Exchange 服务器上创建一个空白的 ASPX 文件 (`Ravin.aspx`)。这本身可能不是恶意行为，但它为进一步的攻击打开了大门，攻击者可以上传包含恶意代码的 ASPX 文件，从而实现远程代码执行。
4.  **将构造的 ViewState 通过 HTTP 请求发送到 Exchange 服务器的 ECP 或 OWA 页面。**  目标页面通常是 `ecp/default.aspx` 或 `owa/auth/logon.aspx`。由于脚本中使用了 `/ecp` 和 `_aspx` 进行 Hash 计算，因此uri参数必须为ecp,否则无法成功。

如果服务器未打补丁，恶意 ViewState 将被反序列化，导致执行 `NULL-File.xml` 中定义的恶意操作，最终导致远程代码执行。

**项目地址:** [ravinacademy/CVE-2020-0688](https://github.com/ravinacademy/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #18

**来源**: [CVE-2020-0688-righter83_CVE-2020-0688.md](../2020/CVE-2020-0688-righter83_CVE-2020-0688.md)

## CVE-2020-0688

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要获取Exchange用户的凭据，或者能够访问Exchange控制面板(ECP)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，源于 Exchange 控制面板 (ECP) 未能正确处理内存中的对象。攻击者可以利用静态密钥进行 ViewState 反序列化，从而在服务器上执行任意代码。利用方式通常涉及以下步骤：1. 获取Exchange用户的凭据或者能够访问Exchange控制面板(ECP)。2. 使用已知密钥生成恶意的 ViewState 数据。3. 将生成的 ViewState 数据作为请求的一部分发送到 Exchange 服务器。4. 服务器反序列化 ViewState 数据，执行攻击者预设的恶意代码。提供的 POC 脚本 `scanner.php` 仅用于检测目标 Exchange 服务器是否安装了受影响的版本，以及是否安装了修复补丁。该脚本通过检查 OWA 页面中的版本信息来进行判断。虽然该脚本本身的功能是良性的，但存在一定的投毒风险，例如，作者可能在脚本中植入恶意代码，以便在扫描目标服务器时执行其他操作。由于只是版本检测，恶意代码可能性较小。该漏洞的利用需要具备一定的Exchange知识和 .NET 反序列化知识，相对复杂。根据CISA已将此漏洞添加到了已知可利用漏洞目录，表明该漏洞在野外被广泛利用。

**项目地址:** [righter83/CVE-2020-0688](https://github.com/righter83/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #19

**来源**: [CVE-2020-0688-truongtn_cve-2020-0688.md](../2020/CVE-2020-0688-truongtn_cve-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 受影响版本包括 Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要具有Exchange用户的凭据或能够获取到凭据，以及能够访问Exchange Control Panel (ECP)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 的远程代码执行漏洞，源于 Exchange Control Panel (ECP) 在处理内存对象时的方式不当。攻击者可以利用静态密钥进行 ViewState 反序列化，从而执行任意代码。漏洞利用通常涉及以下步骤：

1.  **获取有效的Exchange用户凭据：** 攻击者需要拥有Exchange服务器上用户的有效凭据才能访问ECP。
2.  **构造恶意的ViewState:**  攻击者使用静态密钥构造一个包含恶意代码的 ViewState 对象。
3.  **发送请求：**  攻击者将构造的 ViewState 对象通过 HTTP 请求发送到易受攻击的 ECP 页面。
4.  **代码执行：** Exchange服务器反序列化 ViewState 对象，从而执行攻击者嵌入的恶意代码。

提供的POC代码 `/tmp/01ddbe7d3c9df93cbdc1b119a0d43d96/FSharp.Core.xml` 似乎是一个XML文档，描述了 `FSharp.Core` 程序集的成员。它本身不太可能是直接的利用代码，更像是程序集的一部分或文档。实际的利用代码可能使用这个程序集或其他方式来构造恶意的ViewState。

根据搜索引擎结果，已经有针对此漏洞的公开PoC，并且该漏洞已被积极利用。例如，[zyn3rgy/ecp_slap](https://github.com/zyn3rgy/ecp_slap)仓库包含扫描和利用易受攻击的Exchange实例的函数。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞确实存在并且已被利用，因此利用是有效的。

**投毒风险：**提供的代码片段(`/tmp/01ddbe7d3c9df93cbdc1b119a0d43d96/FSharp.Core.xml`)本身不太可能包含投毒代码，因为看起来只是一个XML文档，描述FSharp.Core程序集的成员。然而，如果从不可信的来源获取完整的利用代码，则存在投毒风险。例如，在其他未提供的代码中，作者可能隐藏了后门或恶意功能。由于只看到部分代码，无法完全排除风险，因此假设有10%的投毒风险。

**利用方式：** 利用方式是利用ECP的ViewState反序列化漏洞，结合已知的静态密钥来执行任意代码。攻击者需要有效的Exchange用户凭据才能访问ECP。攻击者构造一个包含恶意代码的ViewState对象，并将其发送到易受攻击的ECP页面。服务器反序列化该对象后，就会执行恶意代码，从而允许攻击者完全控制Exchange服务器。

**项目地址:** [truongtn/cve-2020-0688](https://github.com/truongtn/cve-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #20

**来源**: [CVE-2020-0688-tvdat20004_CVE-2020-0688.md](../2020/CVE-2020-0688-tvdat20004_CVE-2020-0688.md)

## CVE-2020-0688-Microsoft Exchange Server-RCE

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要有效的Exchange用户凭据，且目标服务器存在CVE-2020-0688漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 漏洞是由于 Microsoft Exchange Server 在处理内存中的对象时未能正确操作而导致的远程代码执行漏洞。攻击者可以通过利用静态密钥进行 ViewState 反序列化，从而在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，此漏洞的利用是有效的。漏洞利用的关键在于利用 Exchange 控制面板 (ECP) 中使用的静态密钥来构造恶意的 ViewState。提供的POC代码尝试自动化这一过程，包括登录OWA, 获取相关参数，然后使用 ysonet.exe 生成恶意 ViewState，最后发送带有恶意ViewState的请求。

**投毒风险：**
虽然POC代码本身旨在利用已知的漏洞，但潜在的投毒风险是存在的。代码中的投毒点可能包括：
1.  `ysonet.exe`：POC依赖外部程序`ysonet.exe`，如果下载的 `ysonet.exe` 文件被篡改，则可能执行恶意的代码，导致攻击者主机中毒。
2.  执行命令：`command` 参数通过`ysonet.exe`在目标服务器执行，如果攻击者更改此参数，可能在目标服务器上执行恶意代码。下载ysoserial.net和更改command参数的风险较高。

因此，代码中存在一定的投毒风险，大约为10%。

**利用方式：**
1.  **身份验证：** 首先，攻击者需要有效的 Exchange 用户凭据，使用用户名密码登录目标OWA。
2.  **获取参数：**  利用脚本获取目标Exchange服务器的`__VIEWSTATEGENERATOR`和`ASP.NET_SessionId`（`session_id`）等参数。
3.  **生成恶意 ViewState：** 使用 `ysonet.exe` 工具，结合静态密钥 (`validationKey` 和 `validationAlg`)以及上一步获取的参数，构造恶意的 ViewState。`ysonet.exe`程序的功能是将命令序列化到ViewState中。
4.  **发送请求：**  将生成的恶意 ViewState 作为参数（`__VIEWSTATE`）发送到 `/ecp/default.aspx` 页面。
5.  **代码执行：**  服务器反序列化 ViewState，执行其中嵌入的恶意代码。

**项目地址:** [tvdat20004/CVE-2020-0688](https://github.com/tvdat20004/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #21

**来源**: [CVE-2020-0688-w4fz5uck5_cve-2020-0688-webshell-upload-technique.md](../2020/CVE-2020-0688-w4fz5uck5_cve-2020-0688-webshell-upload-technique.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可完全控制 Exchange 服务器

**影响版本:** 受影响版本包括：Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 攻击者需要有效的 Exchange 用户凭据才能利用此漏洞，或能够获取到有效的ASP.NET_SessionId

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 的远程代码执行漏洞，存在于 Exchange Control Panel (ECP) 组件中。该漏洞是由于 ECP 在生成 ViewState 时使用了静态密钥进行加密，导致攻击者可以通过已知的密钥构造恶意的 ViewState 数据，从而在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 POC 代码，可以确定此漏洞的 POC 代码是有效的。多个来源表明 CVE-2020-0688 已经被广泛利用，并且存在公开的 POC 代码。

**投毒风险：**
提供的 POC 代码 `fuckchina_v2.py`  包含了以下信息，可能存在投毒风险：
*   作者声明免责声明，表明对非法行为不负责任。
*   代码中使用了`WScript.Shell`对象来执行系统命令，存在潜在的风险。

考虑到代码的开源性质和用途，认为投毒风险较低，大约为10%。这主要是因为攻击者可以审查和修改代码，以适应他们的需要。因此，任何潜在的投毒代码都可能被检测到并删除。

**利用方式：**
1.  **获取 Exchange 用户凭据或有效的 ASP.NET_SessionId：** 攻击者需要有效的 Exchange 用户凭据，或者能够获取到有效的 ASP.NET_SessionId。
2.  **泄露 __VIEWSTATEGENERATOR 值：** 攻击者需要访问 `/ecp/default.aspx` 页面，并从中提取 __VIEWSTATEGENERATOR 值。如果无法提取，则尝试默认值 `B97B4E27`。
3.  **构造恶意的 ViewState 数据：** 使用泄露的 __VIEWSTATEGENERATOR 值和已知的静态密钥，攻击者可以构造恶意的 ViewState 数据，其中包含要执行的恶意代码。
4.  **发送包含恶意 ViewState 数据的请求：** 攻击者将构造的恶意 ViewState 数据通过 POST 请求发送到 ECP 的某个页面，例如 `default.aspx`。
5.  **执行远程代码：** Exchange 服务器在处理包含恶意 ViewState 数据的请求时，会反序列化 ViewState 数据并执行其中的恶意代码，从而导致远程代码执行。

`fuckchina_v2.py`脚本通过上传一个C#编写的ASPX webshell来实现RCE。 webshell 使用 XML 和 XSLT 来绕过 ViewState 的默认大小限制，并执行 `cmd /c` 命令。

**项目地址:** [w4fz5uck5/cve-2020-0688-webshell-upload-technique](https://github.com/w4fz5uck5/cve-2020-0688-webshell-upload-technique)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #22

**来源**: [CVE-2020-0688-youncyb_CVE-2020-0688.md](../2020/CVE-2020-0688-youncyb_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 23, 2019 Cumulative Update 3/4, 2016 Cumulative Update 14/15, 2010 Service Pack 3 Update Rollup 30

**利用条件:** 需要有效的域用户凭据以及能够访问Exchange服务器的ECP接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 中的远程代码执行漏洞，存在于 Exchange Control Panel (ECP) 组件中。该漏洞的根源在于 Exchange 在反序列化 ViewState 数据时使用了硬编码的 validationKey 和 validationAlgorithm。攻击者可以通过构造恶意的 ViewState 数据，利用 Ysoserial.net 等工具生成 payload，然后通过 ECP 接口发送，从而在 Exchange 服务器上执行任意代码。PoC 代码 `CVE-2020-0688.py` 通过模拟登录 OWA 获取 `__VIEWSTATEGENERATOR` 和 `ASP.NET_SessionId`，然后利用 `ysoserial.exe` 生成 payload 并将其注入到 ECP 请求的 `__VIEWSTATE` 参数中，最后发送请求触发漏洞。

**漏洞利用方式：**
1.  获取目标 Exchange 服务器的有效域用户凭据。
2.  使用该凭据登录 OWA，获取 `__VIEWSTATEGENERATOR` 和 `ASP.NET_SessionId`。
3.  使用 `ysoserial.exe` 工具，指定 `__VIEWSTATEGENERATOR` 和硬编码的 `validationKey` 及 `validationAlgorithm`，生成恶意 ViewState payload。
4.  构造包含恶意 ViewState payload 的 ECP 请求，发送到目标 Exchange 服务器。
5.  如果漏洞利用成功，服务器会执行 payload 中的恶意代码。

**投毒风险分析：**
PoC 代码 `CVE-2020-0688.py` 本身的功能是利用漏洞，但存在一定的投毒风险：

*   **ysoserial.exe 的来源：** PoC 代码依赖于外部工具 `ysoserial.exe`，如果该工具被替换为恶意版本，则可能导致攻击者执行的不是预期的命令，而是攻击者植入的恶意代码。
*   **command 参数：** PoC 代码允许攻击者通过 `-c` 参数指定要执行的命令，攻击者可能会无意中或恶意地执行有害的命令。
*   **FSharp.Core.xml:** 虽然文件内容看起来是XML，但是里面并没有显示实际的代码功能，所以推断可能是投毒的代码，但是无法验证。 

**项目地址:** [youncyb/CVE-2020-0688](https://github.com/youncyb/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #23

**来源**: [CVE-2020-0688-zcgonvh_CVE-2020-0688.md](../2020/CVE-2020-0688-zcgonvh_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server Remote Code Execution

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要有效的Exchange用户凭据

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 中的远程代码执行漏洞，源于 Exchange Control Panel (ECP) 组件未能正确处理内存中的对象。攻击者可以利用静态的machineKey进行ViewState反序列化，从而执行任意代码。 

**漏洞利用方式：**

1.  **身份验证：** 攻击者首先需要获取有效的 Exchange 用户凭据，可以通过爆破、钓鱼等方式。
2.  **获取 ViewStateGenerator：** 成功登录后，攻击者需要获取 `__VIEWSTATEGENERATOR` 的值。
3.  **构造恶意 ViewState：** 攻击者使用ysoserial等工具，利用已知密钥构造恶意的 ViewState payload，其中包含要执行的命令。
4.  **发送请求：** 攻击者将包含恶意 ViewState 的请求发送到 Exchange 服务器的 ECP 路径（例如 `/ecp/default.aspx` 或 `/ecp/LiveIdError.aspx`）。
5.  **代码执行：** Exchange 服务器反序列化 ViewState，执行攻击者嵌入的恶意代码。

**关于投毒风险：**
代码总体来说是漏洞的利用，但需要仔细审查以下区域：
*   `ExchangeCmd.cs`中的UpdateMacKey函数,如果被人恶意篡改默认的密钥，可能会导致其他的隐患。虽然本身只是用于dummy file写入，但是需要注意。
*   与ysoserial集成的部分，需要验证生成的payload是否符合预期，防止被替换成恶意payload。

总体来说，投毒的概率较低，主要集中在payload生成和默认配置的修改上。需要复核相关逻辑保证安全。

**项目地址:** [zcgonvh/CVE-2020-0688](https://github.com/zcgonvh/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #24

**来源**: [CVE-2020-0688-zyn3rgy_ecp_slap.md](../2020/CVE-2020-0688-zyn3rgy_ecp_slap.md)

## CVE-2020-0688-Microsoft Exchange Server-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要具有Exchange用户权限，能够访问Exchange Control Panel (ECP)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-0688是Microsoft Exchange Server中的一个远程代码执行漏洞。根据漏洞信息和搜索结果，该漏洞源于Exchange服务器未能正确处理内存中的对象，导致攻击者可以发送特制的payload到服务器并执行嵌入的命令。该漏洞利用的关键在于Exchange Control Panel (ECP)在创建唯一密钥时存在缺陷，使用静态密钥进行ViewState的序列化和反序列化。攻击者可以利用这个静态密钥构造恶意的ViewState，从而在服务器上执行任意代码。

**有效性：**
根据搜索结果和漏洞库信息，存在公开可用的POC代码。Rapid7的博客也证实可以通过该漏洞将Exchange用户账号提升到SYSTEM权限。因此，该漏洞利用的有效性较高。

**投毒风险：**
提供的漏洞利用代码片段仅仅是GNU GPL许可协议。由于该文件本身不包含任何可执行代码或配置信息，因此几乎不存在投毒风险。该代码仓库中其他文件的需要进一步分析，但是仅凭此license文件判断投毒几率可以判定为0%

**利用方式：**
1.  **获取Exchange用户凭据：** 攻击者首先需要拥有一个有效的Exchange用户账户。
2.  **利用静态密钥：** 利用已知的静态密钥（由于Exchange服务器未能正确生成唯一密钥）对`.NET` ViewState进行序列化和反序列化操作。
3.  **构造恶意ViewState：** 构造包含恶意代码的ViewState payload。
4.  **发送请求：** 将构造好的恶意ViewState payload发送到Exchange服务器的ECP页面。
5.  **远程代码执行：** Exchange服务器在处理该ViewState时，由于反序列化漏洞，将执行攻击者嵌入的恶意代码，从而实现远程代码执行。

**项目地址:** [zyn3rgy/ecp_slap](https://github.com/zyn3rgy/ecp_slap)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---



---

## POC #14

**来源**: [CVE-2020-0688-murataydemir_CVE-2020-0688.md](../2020/CVE-2020-0688-murataydemir_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全系统权限控制

**影响版本:** 受影响版本包括：Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要有效的Exchange用户凭据进行身份验证，以及对Exchange Control Panel (ECP) 的网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 的远程代码执行漏洞，源于 ECP 组件中使用了静态的 cryptographic key。攻击者利用已知密钥伪造 ViewState 数据，从而在服务器上执行任意代码，获取SYSTEM权限。

**有效性：**
提供的POC代码有效。根据漏洞描述，Exchange Server 所有安装共享相同的 validationKey 和 decryptionKey，允许经过身份验证的攻击者通过构造恶意的 ViewState 数据进行反序列化攻击，从而执行任意代码。

**投毒风险：**
该POC代码主要提供的是漏洞利用方法，并引用了YSoSerial.net工具生成payload，本身不包含任何恶意代码或后门。因此，投毒风险极低。

**利用方式：**
1.  攻击者首先需要获取一个有效的Exchange用户账户的凭据（可以通过钓鱼或其他手段）。
2.  使用该凭据登录到 Exchange 的 OWA 或 ECP 页面，获取 `ASP_NET_SessionId` 和 `__VIEWSTATEGENERATOR` 的值。
3.  使用 `YSoSerial.net` 工具，利用已知 `validationKey` (CB2721ABDAF8E9DC516D621D8B8BF13A2C9E8689A25303BF) 和 `validationalg` (SHA1) 生成恶意的 ViewState payload。可以构造payload执行任意命令，例如反弹shell。
4.  将生成的 ViewState payload 插入到 ECP 的请求中，发送到服务器。例如：`http(s)://exchangeserver/ecp/default.aspx?__VIEWSTATEGENERATOR=<generator>&__VIEWSTATE=<ViewState_Payload>`
5.  服务器在处理该请求时，会反序列化恶意的 ViewState 数据，从而执行攻击者指定的代码，最终导致远程代码执行。

**项目地址:** [murataydemir/CVE-2020-0688](https://github.com/murataydemir/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #15

**来源**: [CVE-2020-0688-onSec-fr_CVE-2020-0688-Scanner.md](../2020/CVE-2020-0688-onSec-fr_CVE-2020-0688-Scanner.md)

## CVE-2020-0688-Microsoft Exchange Server-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要Exchange Control Panel (ECP)可访问，并已知有效的用户凭据（可以是通过其他方式获得的被盗凭据）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，源于 Exchange Control Panel (ECP) 组件未能正确处理内存中的对象。该漏洞允许经过身份验证的攻击者通过向服务器发送特制的 payload 来执行任意代码。

**有效性：**
根据搜索引擎结果，该漏洞的利用代码（PoC）是存在的，并且已被积极利用。从提供的文件列表来看，存在 `CVE-2020-0688-Scanner.exe.config` 和 `HtmlAgilityPack.xml` ，这表明该 PoC 可能是使用 .NET Framework 编写的扫描器，用于检测目标 Exchange 服务器是否存在漏洞。因此可以判断提供的POC代码有效。

**投毒风险：**
鉴于提供的文件仅为配置文件和 HTML 解析库的 XML 文档，直接从这些文件判断是否存在投毒代码比较困难。但是，由于漏洞利用涉及远程代码执行，攻击者完全可能在利用过程中植入恶意代码。`CVE-2020-0688-Scanner.exe.config` 本身没有可疑之处，但是最终的扫描器程序 `CVE-2020-0688-Scanner.exe` 可能存在被篡改的风险。漏洞利用代码的投毒风险评估为10%，主要考虑潜在的恶意第三方修改。

**利用方式：**
利用 CVE-2020-0688 的核心在于 Exchange Control Panel (ECP) 使用静态密钥进行 ViewState 数据的序列化和反序列化。攻击者可以利用此静态密钥构造恶意的 ViewState payload，当 Exchange 服务器反序列化此 payload 时，即可执行攻击者指定的任意代码。利用步骤大致如下：

1.  获取 Exchange 服务器的静态密钥（`validationKey` 和 `decryptionKey`）。
2.  构造包含恶意代码的 ViewState payload。
3.  将构造的 payload 发送到 Exchange 服务器的 ECP 接口。
4.  Exchange 服务器反序列化 payload 并执行恶意代码，实现远程代码执行。

攻击者可以先通过爆破、信息泄露等手段获取Exchange的用户凭据，再借助此漏洞将权限提升至SYSTEM。


**项目地址:** [onSec-fr/CVE-2020-0688-Scanner](https://github.com/onSec-fr/CVE-2020-0688-Scanner)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #16

**来源**: [CVE-2020-0688-random-robbie_cve-2020-0688.md](../2020/CVE-2020-0688-random-robbie_cve-2020-0688.md)

## CVE-2020-0688-Microsoft Exchange Server-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要有效的Exchange用户凭证，能够访问ECP (Exchange Control Panel)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688是一个Microsoft Exchange服务器的远程代码执行漏洞，源于服务器在安装时未能正确创建唯一的密钥。攻击者可以利用该漏洞通过Exchange Control Panel (ECP)组件发送特制的payload执行任意代码。利用过程包括：

1.  **获取必要信息：** 首先，需要一个有效的Exchange用户账户（邮箱地址和密码），用于登录OWA（Outlook Web App）。登录后，需要从响应中提取`__VIEWSTATEGENERATOR`参数和`ASP.NET_SessionId` cookie。
2.  **生成ViewState Payload：** 使用`ysoserial.net`工具，基于`TextFormattingRunProperties` gadget生成恶意的ViewState payload。需要指定`--validationalg`为`SHA1`，`--validationkey`为静态的`CB2721ABDAF8E9DC516D621D8B8BF13A2C9E8689A25303BF`（这是此漏洞的核心：硬编码的密钥），`--generator`为从页面源码中获取的`__VIEWSTATEGENERATOR`值，`--viewstateuserkey`为从cookie中提取的`ASP.NET_SessionId`值。command 为需要执行的命令。
3.  **发送恶意请求：** 将生成的ViewState payload附加到对ECP的请求中，通过`__VIEWSTATE`参数传递。 URL示例: `https://localhost/ecp/default.aspx?__VIEWSTATEGENERATOR=<generator>&__VIEWSTATE=<ViewState>`。

提供的`exploit.py`脚本尝试自动化这个过程，但注释表明它**尚未经过测试，需要进一步完善**。特别是 ViewState 值的生成需要在外部完成，脚本只负责登录和参数提取。

**关于投毒风险：**

`exploit.py`脚本本身相对简单，主要功能是登录OWA并提取必要的参数。潜在的风险可能存在于以下几点：
*   作者提供的`ysoserial.net`下载链接，如果链接被替换为恶意的`ysoserial.net`版本，可能包含恶意代码，但在Github上的相关链接通常是安全的，不过需要谨慎。
*   在`exploit.py`中，如果作者有意在后续完善中添加恶意代码，例如，在生成payload时执行某些恶意操作，则存在潜在风险。
*   `README.md`中要求下载`YSO`， 如果被替换为恶意链接,会存在投毒风险。

考虑到脚本的简单性以及需要外部工具生成payload，直接的投毒风险较低，综合评估为10%。主要风险在于使用者下载的外部工具可能被篡改。

**有效性分析：**
根据漏洞描述和搜索结果，此漏洞利用的关键在于使用了硬编码的`validationkey`。如果目标Exchange服务器未打补丁，且使用了受影响的版本，利用成功的可能性较高。提供的POC代码需要手动生成ViewState payload，脚本只是辅助提取参数，因此代码的有效性取决于payload的生成是否正确以及目标服务器是否符合漏洞利用的条件。


**项目地址:** [random-robbie/cve-2020-0688](https://github.com/random-robbie/cve-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #17

**来源**: [CVE-2020-0688-ravinacademy_CVE-2020-0688.md](../2020/CVE-2020-0688-ravinacademy_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要Exchange服务器的访问权限，以及有效的Exchange用户凭据（可以通过窃取获得）。利用需要目标服务器未安装相应的安全补丁，且攻击者能够访问 ECP (Exchange Control Panel) 或 OWA (Outlook Web App)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 中的远程代码执行漏洞，源于 Exchange 在安装时未能正确创建唯一的密钥。攻击者可以利用此漏洞通过构造恶意的 ViewState 数据包，在服务器上执行任意代码。攻击通常涉及以下步骤：

1.  **获取 Exchange 服务器的验证密钥 (validationKey) 和解密密钥 (decryptionKey)**：这些密钥通常存储在 web.config 文件中。虽然不是 POC 的一部分，但是利用此漏洞需要获取这些密钥。
2.  **构造恶意的 ViewState**：利用提供的 PowerShell 脚本 `CVE-2020-0688.ps1`，结合 `NULL-File.xml` payload，可以生成恶意的 ViewState。脚本的核心在于通过 TextFormattingRunPropertiesMarshal 类进行反序列化操作，从而执行任意代码。
3.  **发送 ViewState**：将构造的 ViewState 作为参数发送到 Exchange 服务器的 ECP 或 OWA 页面。

**有效性评估：**

提供的 POC 代码有效。它利用了 ViewState 的不安全反序列化漏洞来执行任意代码。多个来源（包括 GitHub 和安全博客）都确认了此漏洞的存在和利用的有效性。

**投毒风险评估：**

尽管提供的 POC 脚本主要功能是生成 ViewState，看似无害，但是依然存在微小的投毒风险（10%）。`NULL-File.xml` 文件的目的是创建一个 `Ravin.aspx` 文件，文件内容为空。作者可能替换掉这个aspx文件内容，植入恶意代码,从而实现后门。此外，攻击者可以修改 PowerShell 脚本以包含额外的恶意操作，例如，下载并执行任意程序。不过，从表面上看，该脚本的主要功能是生成 ViewState，而真正的恶意代码需要在 ViewState 中构造。

**漏洞利用方式：**

1.  **攻击者需要具有Exchange用户的权限。**
2.  **获取validationKey和decryptionKey。** 这是成功利用漏洞的关键。
3.  **利用 PowerShell 脚本构造恶意的 ViewState。** 脚本 `CVE-2020-0688.ps1` 使用 `NULL-File.xml` 作为 payload 示例。 `NULL-File.xml` 的作用是尝试在 Exchange 服务器上创建一个空白的 ASPX 文件 (`Ravin.aspx`)。这本身可能不是恶意行为，但它为进一步的攻击打开了大门，攻击者可以上传包含恶意代码的 ASPX 文件，从而实现远程代码执行。
4.  **将构造的 ViewState 通过 HTTP 请求发送到 Exchange 服务器的 ECP 或 OWA 页面。**  目标页面通常是 `ecp/default.aspx` 或 `owa/auth/logon.aspx`。由于脚本中使用了 `/ecp` 和 `_aspx` 进行 Hash 计算，因此uri参数必须为ecp,否则无法成功。

如果服务器未打补丁，恶意 ViewState 将被反序列化，导致执行 `NULL-File.xml` 中定义的恶意操作，最终导致远程代码执行。

**项目地址:** [ravinacademy/CVE-2020-0688](https://github.com/ravinacademy/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #18

**来源**: [CVE-2020-0688-righter83_CVE-2020-0688.md](../2020/CVE-2020-0688-righter83_CVE-2020-0688.md)

## CVE-2020-0688

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要获取Exchange用户的凭据，或者能够访问Exchange控制面板(ECP)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，源于 Exchange 控制面板 (ECP) 未能正确处理内存中的对象。攻击者可以利用静态密钥进行 ViewState 反序列化，从而在服务器上执行任意代码。利用方式通常涉及以下步骤：1. 获取Exchange用户的凭据或者能够访问Exchange控制面板(ECP)。2. 使用已知密钥生成恶意的 ViewState 数据。3. 将生成的 ViewState 数据作为请求的一部分发送到 Exchange 服务器。4. 服务器反序列化 ViewState 数据，执行攻击者预设的恶意代码。提供的 POC 脚本 `scanner.php` 仅用于检测目标 Exchange 服务器是否安装了受影响的版本，以及是否安装了修复补丁。该脚本通过检查 OWA 页面中的版本信息来进行判断。虽然该脚本本身的功能是良性的，但存在一定的投毒风险，例如，作者可能在脚本中植入恶意代码，以便在扫描目标服务器时执行其他操作。由于只是版本检测，恶意代码可能性较小。该漏洞的利用需要具备一定的Exchange知识和 .NET 反序列化知识，相对复杂。根据CISA已将此漏洞添加到了已知可利用漏洞目录，表明该漏洞在野外被广泛利用。

**项目地址:** [righter83/CVE-2020-0688](https://github.com/righter83/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #19

**来源**: [CVE-2020-0688-truongtn_cve-2020-0688.md](../2020/CVE-2020-0688-truongtn_cve-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 受影响版本包括 Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要具有Exchange用户的凭据或能够获取到凭据，以及能够访问Exchange Control Panel (ECP)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 的远程代码执行漏洞，源于 Exchange Control Panel (ECP) 在处理内存对象时的方式不当。攻击者可以利用静态密钥进行 ViewState 反序列化，从而执行任意代码。漏洞利用通常涉及以下步骤：

1.  **获取有效的Exchange用户凭据：** 攻击者需要拥有Exchange服务器上用户的有效凭据才能访问ECP。
2.  **构造恶意的ViewState:**  攻击者使用静态密钥构造一个包含恶意代码的 ViewState 对象。
3.  **发送请求：**  攻击者将构造的 ViewState 对象通过 HTTP 请求发送到易受攻击的 ECP 页面。
4.  **代码执行：** Exchange服务器反序列化 ViewState 对象，从而执行攻击者嵌入的恶意代码。

提供的POC代码 `/tmp/01ddbe7d3c9df93cbdc1b119a0d43d96/FSharp.Core.xml` 似乎是一个XML文档，描述了 `FSharp.Core` 程序集的成员。它本身不太可能是直接的利用代码，更像是程序集的一部分或文档。实际的利用代码可能使用这个程序集或其他方式来构造恶意的ViewState。

根据搜索引擎结果，已经有针对此漏洞的公开PoC，并且该漏洞已被积极利用。例如，[zyn3rgy/ecp_slap](https://github.com/zyn3rgy/ecp_slap)仓库包含扫描和利用易受攻击的Exchange实例的函数。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞确实存在并且已被利用，因此利用是有效的。

**投毒风险：**提供的代码片段(`/tmp/01ddbe7d3c9df93cbdc1b119a0d43d96/FSharp.Core.xml`)本身不太可能包含投毒代码，因为看起来只是一个XML文档，描述FSharp.Core程序集的成员。然而，如果从不可信的来源获取完整的利用代码，则存在投毒风险。例如，在其他未提供的代码中，作者可能隐藏了后门或恶意功能。由于只看到部分代码，无法完全排除风险，因此假设有10%的投毒风险。

**利用方式：** 利用方式是利用ECP的ViewState反序列化漏洞，结合已知的静态密钥来执行任意代码。攻击者需要有效的Exchange用户凭据才能访问ECP。攻击者构造一个包含恶意代码的ViewState对象，并将其发送到易受攻击的ECP页面。服务器反序列化该对象后，就会执行恶意代码，从而允许攻击者完全控制Exchange服务器。

**项目地址:** [truongtn/cve-2020-0688](https://github.com/truongtn/cve-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #20

**来源**: [CVE-2020-0688-tvdat20004_CVE-2020-0688.md](../2020/CVE-2020-0688-tvdat20004_CVE-2020-0688.md)

## CVE-2020-0688-Microsoft Exchange Server-RCE

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要有效的Exchange用户凭据，且目标服务器存在CVE-2020-0688漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 漏洞是由于 Microsoft Exchange Server 在处理内存中的对象时未能正确操作而导致的远程代码执行漏洞。攻击者可以通过利用静态密钥进行 ViewState 反序列化，从而在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，此漏洞的利用是有效的。漏洞利用的关键在于利用 Exchange 控制面板 (ECP) 中使用的静态密钥来构造恶意的 ViewState。提供的POC代码尝试自动化这一过程，包括登录OWA, 获取相关参数，然后使用 ysonet.exe 生成恶意 ViewState，最后发送带有恶意ViewState的请求。

**投毒风险：**
虽然POC代码本身旨在利用已知的漏洞，但潜在的投毒风险是存在的。代码中的投毒点可能包括：
1.  `ysonet.exe`：POC依赖外部程序`ysonet.exe`，如果下载的 `ysonet.exe` 文件被篡改，则可能执行恶意的代码，导致攻击者主机中毒。
2.  执行命令：`command` 参数通过`ysonet.exe`在目标服务器执行，如果攻击者更改此参数，可能在目标服务器上执行恶意代码。下载ysoserial.net和更改command参数的风险较高。

因此，代码中存在一定的投毒风险，大约为10%。

**利用方式：**
1.  **身份验证：** 首先，攻击者需要有效的 Exchange 用户凭据，使用用户名密码登录目标OWA。
2.  **获取参数：**  利用脚本获取目标Exchange服务器的`__VIEWSTATEGENERATOR`和`ASP.NET_SessionId`（`session_id`）等参数。
3.  **生成恶意 ViewState：** 使用 `ysonet.exe` 工具，结合静态密钥 (`validationKey` 和 `validationAlg`)以及上一步获取的参数，构造恶意的 ViewState。`ysonet.exe`程序的功能是将命令序列化到ViewState中。
4.  **发送请求：**  将生成的恶意 ViewState 作为参数（`__VIEWSTATE`）发送到 `/ecp/default.aspx` 页面。
5.  **代码执行：**  服务器反序列化 ViewState，执行其中嵌入的恶意代码。

**项目地址:** [tvdat20004/CVE-2020-0688](https://github.com/tvdat20004/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #21

**来源**: [CVE-2020-0688-w4fz5uck5_cve-2020-0688-webshell-upload-technique.md](../2020/CVE-2020-0688-w4fz5uck5_cve-2020-0688-webshell-upload-technique.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可完全控制 Exchange 服务器

**影响版本:** 受影响版本包括：Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 攻击者需要有效的 Exchange 用户凭据才能利用此漏洞，或能够获取到有效的ASP.NET_SessionId

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 的远程代码执行漏洞，存在于 Exchange Control Panel (ECP) 组件中。该漏洞是由于 ECP 在生成 ViewState 时使用了静态密钥进行加密，导致攻击者可以通过已知的密钥构造恶意的 ViewState 数据，从而在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 POC 代码，可以确定此漏洞的 POC 代码是有效的。多个来源表明 CVE-2020-0688 已经被广泛利用，并且存在公开的 POC 代码。

**投毒风险：**
提供的 POC 代码 `fuckchina_v2.py`  包含了以下信息，可能存在投毒风险：
*   作者声明免责声明，表明对非法行为不负责任。
*   代码中使用了`WScript.Shell`对象来执行系统命令，存在潜在的风险。

考虑到代码的开源性质和用途，认为投毒风险较低，大约为10%。这主要是因为攻击者可以审查和修改代码，以适应他们的需要。因此，任何潜在的投毒代码都可能被检测到并删除。

**利用方式：**
1.  **获取 Exchange 用户凭据或有效的 ASP.NET_SessionId：** 攻击者需要有效的 Exchange 用户凭据，或者能够获取到有效的 ASP.NET_SessionId。
2.  **泄露 __VIEWSTATEGENERATOR 值：** 攻击者需要访问 `/ecp/default.aspx` 页面，并从中提取 __VIEWSTATEGENERATOR 值。如果无法提取，则尝试默认值 `B97B4E27`。
3.  **构造恶意的 ViewState 数据：** 使用泄露的 __VIEWSTATEGENERATOR 值和已知的静态密钥，攻击者可以构造恶意的 ViewState 数据，其中包含要执行的恶意代码。
4.  **发送包含恶意 ViewState 数据的请求：** 攻击者将构造的恶意 ViewState 数据通过 POST 请求发送到 ECP 的某个页面，例如 `default.aspx`。
5.  **执行远程代码：** Exchange 服务器在处理包含恶意 ViewState 数据的请求时，会反序列化 ViewState 数据并执行其中的恶意代码，从而导致远程代码执行。

`fuckchina_v2.py`脚本通过上传一个C#编写的ASPX webshell来实现RCE。 webshell 使用 XML 和 XSLT 来绕过 ViewState 的默认大小限制，并执行 `cmd /c` 命令。

**项目地址:** [w4fz5uck5/cve-2020-0688-webshell-upload-technique](https://github.com/w4fz5uck5/cve-2020-0688-webshell-upload-technique)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #22

**来源**: [CVE-2020-0688-youncyb_CVE-2020-0688.md](../2020/CVE-2020-0688-youncyb_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 23, 2019 Cumulative Update 3/4, 2016 Cumulative Update 14/15, 2010 Service Pack 3 Update Rollup 30

**利用条件:** 需要有效的域用户凭据以及能够访问Exchange服务器的ECP接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 中的远程代码执行漏洞，存在于 Exchange Control Panel (ECP) 组件中。该漏洞的根源在于 Exchange 在反序列化 ViewState 数据时使用了硬编码的 validationKey 和 validationAlgorithm。攻击者可以通过构造恶意的 ViewState 数据，利用 Ysoserial.net 等工具生成 payload，然后通过 ECP 接口发送，从而在 Exchange 服务器上执行任意代码。PoC 代码 `CVE-2020-0688.py` 通过模拟登录 OWA 获取 `__VIEWSTATEGENERATOR` 和 `ASP.NET_SessionId`，然后利用 `ysoserial.exe` 生成 payload 并将其注入到 ECP 请求的 `__VIEWSTATE` 参数中，最后发送请求触发漏洞。

**漏洞利用方式：**
1.  获取目标 Exchange 服务器的有效域用户凭据。
2.  使用该凭据登录 OWA，获取 `__VIEWSTATEGENERATOR` 和 `ASP.NET_SessionId`。
3.  使用 `ysoserial.exe` 工具，指定 `__VIEWSTATEGENERATOR` 和硬编码的 `validationKey` 及 `validationAlgorithm`，生成恶意 ViewState payload。
4.  构造包含恶意 ViewState payload 的 ECP 请求，发送到目标 Exchange 服务器。
5.  如果漏洞利用成功，服务器会执行 payload 中的恶意代码。

**投毒风险分析：**
PoC 代码 `CVE-2020-0688.py` 本身的功能是利用漏洞，但存在一定的投毒风险：

*   **ysoserial.exe 的来源：** PoC 代码依赖于外部工具 `ysoserial.exe`，如果该工具被替换为恶意版本，则可能导致攻击者执行的不是预期的命令，而是攻击者植入的恶意代码。
*   **command 参数：** PoC 代码允许攻击者通过 `-c` 参数指定要执行的命令，攻击者可能会无意中或恶意地执行有害的命令。
*   **FSharp.Core.xml:** 虽然文件内容看起来是XML，但是里面并没有显示实际的代码功能，所以推断可能是投毒的代码，但是无法验证。 

**项目地址:** [youncyb/CVE-2020-0688](https://github.com/youncyb/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #23

**来源**: [CVE-2020-0688-zcgonvh_CVE-2020-0688.md](../2020/CVE-2020-0688-zcgonvh_CVE-2020-0688.md)

## CVE-2020-0688 Microsoft Exchange Server Remote Code Execution

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要有效的Exchange用户凭据

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 中的远程代码执行漏洞，源于 Exchange Control Panel (ECP) 组件未能正确处理内存中的对象。攻击者可以利用静态的machineKey进行ViewState反序列化，从而执行任意代码。 

**漏洞利用方式：**

1.  **身份验证：** 攻击者首先需要获取有效的 Exchange 用户凭据，可以通过爆破、钓鱼等方式。
2.  **获取 ViewStateGenerator：** 成功登录后，攻击者需要获取 `__VIEWSTATEGENERATOR` 的值。
3.  **构造恶意 ViewState：** 攻击者使用ysoserial等工具，利用已知密钥构造恶意的 ViewState payload，其中包含要执行的命令。
4.  **发送请求：** 攻击者将包含恶意 ViewState 的请求发送到 Exchange 服务器的 ECP 路径（例如 `/ecp/default.aspx` 或 `/ecp/LiveIdError.aspx`）。
5.  **代码执行：** Exchange 服务器反序列化 ViewState，执行攻击者嵌入的恶意代码。

**关于投毒风险：**
代码总体来说是漏洞的利用，但需要仔细审查以下区域：
*   `ExchangeCmd.cs`中的UpdateMacKey函数,如果被人恶意篡改默认的密钥，可能会导致其他的隐患。虽然本身只是用于dummy file写入，但是需要注意。
*   与ysoserial集成的部分，需要验证生成的payload是否符合预期，防止被替换成恶意payload。

总体来说，投毒的概率较低，主要集中在payload生成和默认配置的修改上。需要复核相关逻辑保证安全。

**项目地址:** [zcgonvh/CVE-2020-0688](https://github.com/zcgonvh/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

## POC #24

**来源**: [CVE-2020-0688-zyn3rgy_ecp_slap.md](../2020/CVE-2020-0688-zyn3rgy_ecp_slap.md)

## CVE-2020-0688-Microsoft Exchange Server-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要具有Exchange用户权限，能够访问Exchange Control Panel (ECP)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-0688是Microsoft Exchange Server中的一个远程代码执行漏洞。根据漏洞信息和搜索结果，该漏洞源于Exchange服务器未能正确处理内存中的对象，导致攻击者可以发送特制的payload到服务器并执行嵌入的命令。该漏洞利用的关键在于Exchange Control Panel (ECP)在创建唯一密钥时存在缺陷，使用静态密钥进行ViewState的序列化和反序列化。攻击者可以利用这个静态密钥构造恶意的ViewState，从而在服务器上执行任意代码。

**有效性：**
根据搜索结果和漏洞库信息，存在公开可用的POC代码。Rapid7的博客也证实可以通过该漏洞将Exchange用户账号提升到SYSTEM权限。因此，该漏洞利用的有效性较高。

**投毒风险：**
提供的漏洞利用代码片段仅仅是GNU GPL许可协议。由于该文件本身不包含任何可执行代码或配置信息，因此几乎不存在投毒风险。该代码仓库中其他文件的需要进一步分析，但是仅凭此license文件判断投毒几率可以判定为0%

**利用方式：**
1.  **获取Exchange用户凭据：** 攻击者首先需要拥有一个有效的Exchange用户账户。
2.  **利用静态密钥：** 利用已知的静态密钥（由于Exchange服务器未能正确生成唯一密钥）对`.NET` ViewState进行序列化和反序列化操作。
3.  **构造恶意ViewState：** 构造包含恶意代码的ViewState payload。
4.  **发送请求：** 将构造好的恶意ViewState payload发送到Exchange服务器的ECP页面。
5.  **远程代码执行：** Exchange服务器在处理该ViewState时，由于反序列化漏洞，将执行攻击者嵌入的恶意代码，从而实现远程代码执行。

**项目地址:** [zyn3rgy/ecp_slap](https://github.com/zyn3rgy/ecp_slap)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)

---

