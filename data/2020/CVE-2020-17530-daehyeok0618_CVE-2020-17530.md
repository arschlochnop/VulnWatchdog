# CVE-2020-17530

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-17530-Al1ex_CVE-2020-17530.md](../2020/CVE-2020-17530-Al1ex_CVE-2020-17530.md)

## CVE-2020-17530 Apache Struts OGNL 远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0.0 - 2.5.25

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，且允许未经身份验证的用户访问存在漏洞的页面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于Apache Struts框架在处理标签属性中的用户输入时，强制执行了OGNL表达式，且未对输入进行充分验证，导致攻击者可以通过构造恶意的OGNL表达式，执行任意代码。利用方式包括发送包含恶意OGNL表达式的POST请求，该表达式可以执行系统命令、SSRF或计算器程序等。

**有效性：**根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断POC代码有效。多个来源都证实了CVE-2020-17530漏洞的存在，并提供了利用方法。POC代码中包含了构造恶意OGNL表达式的示例，可以直接用于执行系统命令或触发SSRF。

**投毒风险：**POC代码本身主要展示漏洞的利用方法，没有发现明显的恶意代码。项目文件中存在一些图片资源，但这些资源似乎只是为了演示漏洞利用效果，不具备潜在的投毒性。`/CVE-2020-17530/SimpleStruts.iml` 和 `/CVE-2020-17530/pom.xml`，这些Maven依赖和IDEA项目文件本身不具备投毒性，但是有可能被作者利用，添加恶意的依赖,例如包含反序列化漏洞的依赖,或者包含webshell注入的jar包, 但是从代码本身以及仓库结构来看, 这种可能性较低。 投毒风险评估为10%。

**利用方式：**
1.  攻击者发送包含恶意OGNL表达式的HTTP POST请求到存在漏洞的Struts应用程序的某个Action，例如`S2061.action`。
2.  恶意OGNL表达式通过`id`参数传递。
3.  Struts框架在处理`id`参数时，会对OGNL表达式进行求值，从而执行攻击者预先设定的恶意代码。
4.  恶意代码可以包括执行系统命令（如`whoami`），触发SSRF攻击（ping外部域名），或者执行任意Java代码（如启动计算器）。

总体而言，该漏洞利用方法较为直接，且影响严重，可导致远程代码执行。提供的POC代码可以帮助开发者理解漏洞原理，并进行安全测试。

**项目地址:** [Al1ex/CVE-2020-17530](https://github.com/Al1ex/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #2

**来源**: [CVE-2020-17530-CyborgSecurity_CVE-2020-17530.md](../2020/CVE-2020-17530-CyborgSecurity_CVE-2020-17530.md)

## CVE-2020-17530-Apache Struts-远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0.0 - 2.5.25

**利用条件:** 需要目标服务器运行存在漏洞版本的Apache Struts，并且存在可利用的tag属性接收用户输入。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17530 是 Apache Struts 框架中的一个远程代码执行漏洞，由于对用户输入到tag属性中的OGNL表达式进行了强制二次解析。攻击者可以通过构造恶意的OGNL表达式，利用Struts2的tag属性漏洞，在服务器上执行任意命令。

**有效性：**

根据漏洞库信息、搜索结果和漏洞利用代码，该漏洞是真实存在的，且POC代码已经被公开，经验证有效。

**投毒风险：**

分析提供的POC代码，主要包含以下文件：
* `CVE-2020-17530.py`:  这是POC的主体，负责构造Payload并发送请求。
* `README.md`:  提供漏洞描述和POC的使用方法。
* `requirements.txt`:  列出POC运行所需的Python依赖。

代码中没有发现任何可疑的恶意行为或后门代码。该POC只是利用漏洞执行指定的命令。因此，投毒风险评估为0%。

**利用方式：**

利用方式总结如下：

1.  **确定目标：** 确认目标服务器运行的Apache Struts版本在受影响范围内 (2.0.0 - 2.5.25)。
2.  **构造Payload：** 使用提供的Python脚本 (`CVE-2020-17530.py`) 生成包含恶意OGNL表达式的Payload。该脚本允许指定要执行的命令，以及包含漏洞的表单字段名称。
3.  **发送请求：** 将Payload作为POST请求的数据发送到目标服务器的URI。POC通过files参数传递payload，模拟上传文件。
4.  **执行命令：** 如果服务器存在漏洞，并且Payload构造正确，服务器将执行Payload中包含的命令。
5.  **获取结果：** POC脚本会解析服务器的响应，提取命令执行的结果并打印到控制台。

**项目地址:** [CyborgSecurity/CVE-2020-17530](https://github.com/CyborgSecurity/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #3

**来源**: [CVE-2020-17530-daehyeok0618_CVE-2020-17530.md](../2020/CVE-2020-17530-daehyeok0618_CVE-2020-17530.md)

# CVE-2020-17530

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-17530-Al1ex_CVE-2020-17530.md](../2020/CVE-2020-17530-Al1ex_CVE-2020-17530.md)

## CVE-2020-17530 Apache Struts OGNL 远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0.0 - 2.5.25

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，且允许未经身份验证的用户访问存在漏洞的页面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于Apache Struts框架在处理标签属性中的用户输入时，强制执行了OGNL表达式，且未对输入进行充分验证，导致攻击者可以通过构造恶意的OGNL表达式，执行任意代码。利用方式包括发送包含恶意OGNL表达式的POST请求，该表达式可以执行系统命令、SSRF或计算器程序等。

**有效性：**根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断POC代码有效。多个来源都证实了CVE-2020-17530漏洞的存在，并提供了利用方法。POC代码中包含了构造恶意OGNL表达式的示例，可以直接用于执行系统命令或触发SSRF。

**投毒风险：**POC代码本身主要展示漏洞的利用方法，没有发现明显的恶意代码。项目文件中存在一些图片资源，但这些资源似乎只是为了演示漏洞利用效果，不具备潜在的投毒性。`/CVE-2020-17530/SimpleStruts.iml` 和 `/CVE-2020-17530/pom.xml`，这些Maven依赖和IDEA项目文件本身不具备投毒性，但是有可能被作者利用，添加恶意的依赖,例如包含反序列化漏洞的依赖,或者包含webshell注入的jar包, 但是从代码本身以及仓库结构来看, 这种可能性较低。 投毒风险评估为10%。

**利用方式：**
1.  攻击者发送包含恶意OGNL表达式的HTTP POST请求到存在漏洞的Struts应用程序的某个Action，例如`S2061.action`。
2.  恶意OGNL表达式通过`id`参数传递。
3.  Struts框架在处理`id`参数时，会对OGNL表达式进行求值，从而执行攻击者预先设定的恶意代码。
4.  恶意代码可以包括执行系统命令（如`whoami`），触发SSRF攻击（ping外部域名），或者执行任意Java代码（如启动计算器）。

总体而言，该漏洞利用方法较为直接，且影响严重，可导致远程代码执行。提供的POC代码可以帮助开发者理解漏洞原理，并进行安全测试。

**项目地址:** [Al1ex/CVE-2020-17530](https://github.com/Al1ex/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #2

**来源**: [CVE-2020-17530-CyborgSecurity_CVE-2020-17530.md](../2020/CVE-2020-17530-CyborgSecurity_CVE-2020-17530.md)

## CVE-2020-17530-Apache Struts-远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0.0 - 2.5.25

**利用条件:** 需要目标服务器运行存在漏洞版本的Apache Struts，并且存在可利用的tag属性接收用户输入。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17530 是 Apache Struts 框架中的一个远程代码执行漏洞，由于对用户输入到tag属性中的OGNL表达式进行了强制二次解析。攻击者可以通过构造恶意的OGNL表达式，利用Struts2的tag属性漏洞，在服务器上执行任意命令。

**有效性：**

根据漏洞库信息、搜索结果和漏洞利用代码，该漏洞是真实存在的，且POC代码已经被公开，经验证有效。

**投毒风险：**

分析提供的POC代码，主要包含以下文件：
* `CVE-2020-17530.py`:  这是POC的主体，负责构造Payload并发送请求。
* `README.md`:  提供漏洞描述和POC的使用方法。
* `requirements.txt`:  列出POC运行所需的Python依赖。

代码中没有发现任何可疑的恶意行为或后门代码。该POC只是利用漏洞执行指定的命令。因此，投毒风险评估为0%。

**利用方式：**

利用方式总结如下：

1.  **确定目标：** 确认目标服务器运行的Apache Struts版本在受影响范围内 (2.0.0 - 2.5.25)。
2.  **构造Payload：** 使用提供的Python脚本 (`CVE-2020-17530.py`) 生成包含恶意OGNL表达式的Payload。该脚本允许指定要执行的命令，以及包含漏洞的表单字段名称。
3.  **发送请求：** 将Payload作为POST请求的数据发送到目标服务器的URI。POC通过files参数传递payload，模拟上传文件。
4.  **执行命令：** 如果服务器存在漏洞，并且Payload构造正确，服务器将执行Payload中包含的命令。
5.  **获取结果：** POC脚本会解析服务器的响应，提取命令执行的结果并打印到控制台。

**项目地址:** [CyborgSecurity/CVE-2020-17530](https://github.com/CyborgSecurity/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #3

**来源**: [CVE-2020-17530-daehyeok0618_CVE-2020-17530.md](../2020/CVE-2020-17530-daehyeok0618_CVE-2020-17530.md)

# CVE-2020-17530

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-17530-Al1ex_CVE-2020-17530.md](../2020/CVE-2020-17530-Al1ex_CVE-2020-17530.md)

## CVE-2020-17530 Apache Struts OGNL 远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0.0 - 2.5.25

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，且允许未经身份验证的用户访问存在漏洞的页面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于Apache Struts框架在处理标签属性中的用户输入时，强制执行了OGNL表达式，且未对输入进行充分验证，导致攻击者可以通过构造恶意的OGNL表达式，执行任意代码。利用方式包括发送包含恶意OGNL表达式的POST请求，该表达式可以执行系统命令、SSRF或计算器程序等。

**有效性：**根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断POC代码有效。多个来源都证实了CVE-2020-17530漏洞的存在，并提供了利用方法。POC代码中包含了构造恶意OGNL表达式的示例，可以直接用于执行系统命令或触发SSRF。

**投毒风险：**POC代码本身主要展示漏洞的利用方法，没有发现明显的恶意代码。项目文件中存在一些图片资源，但这些资源似乎只是为了演示漏洞利用效果，不具备潜在的投毒性。`/CVE-2020-17530/SimpleStruts.iml` 和 `/CVE-2020-17530/pom.xml`，这些Maven依赖和IDEA项目文件本身不具备投毒性，但是有可能被作者利用，添加恶意的依赖,例如包含反序列化漏洞的依赖,或者包含webshell注入的jar包, 但是从代码本身以及仓库结构来看, 这种可能性较低。 投毒风险评估为10%。

**利用方式：**
1.  攻击者发送包含恶意OGNL表达式的HTTP POST请求到存在漏洞的Struts应用程序的某个Action，例如`S2061.action`。
2.  恶意OGNL表达式通过`id`参数传递。
3.  Struts框架在处理`id`参数时，会对OGNL表达式进行求值，从而执行攻击者预先设定的恶意代码。
4.  恶意代码可以包括执行系统命令（如`whoami`），触发SSRF攻击（ping外部域名），或者执行任意Java代码（如启动计算器）。

总体而言，该漏洞利用方法较为直接，且影响严重，可导致远程代码执行。提供的POC代码可以帮助开发者理解漏洞原理，并进行安全测试。

**项目地址:** [Al1ex/CVE-2020-17530](https://github.com/Al1ex/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #2

**来源**: [CVE-2020-17530-CyborgSecurity_CVE-2020-17530.md](../2020/CVE-2020-17530-CyborgSecurity_CVE-2020-17530.md)

## CVE-2020-17530-Apache Struts-远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0.0 - 2.5.25

**利用条件:** 需要目标服务器运行存在漏洞版本的Apache Struts，并且存在可利用的tag属性接收用户输入。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17530 是 Apache Struts 框架中的一个远程代码执行漏洞，由于对用户输入到tag属性中的OGNL表达式进行了强制二次解析。攻击者可以通过构造恶意的OGNL表达式，利用Struts2的tag属性漏洞，在服务器上执行任意命令。

**有效性：**

根据漏洞库信息、搜索结果和漏洞利用代码，该漏洞是真实存在的，且POC代码已经被公开，经验证有效。

**投毒风险：**

分析提供的POC代码，主要包含以下文件：
* `CVE-2020-17530.py`:  这是POC的主体，负责构造Payload并发送请求。
* `README.md`:  提供漏洞描述和POC的使用方法。
* `requirements.txt`:  列出POC运行所需的Python依赖。

代码中没有发现任何可疑的恶意行为或后门代码。该POC只是利用漏洞执行指定的命令。因此，投毒风险评估为0%。

**利用方式：**

利用方式总结如下：

1.  **确定目标：** 确认目标服务器运行的Apache Struts版本在受影响范围内 (2.0.0 - 2.5.25)。
2.  **构造Payload：** 使用提供的Python脚本 (`CVE-2020-17530.py`) 生成包含恶意OGNL表达式的Payload。该脚本允许指定要执行的命令，以及包含漏洞的表单字段名称。
3.  **发送请求：** 将Payload作为POST请求的数据发送到目标服务器的URI。POC通过files参数传递payload，模拟上传文件。
4.  **执行命令：** 如果服务器存在漏洞，并且Payload构造正确，服务器将执行Payload中包含的命令。
5.  **获取结果：** POC脚本会解析服务器的响应，提取命令执行的结果并打印到控制台。

**项目地址:** [CyborgSecurity/CVE-2020-17530](https://github.com/CyborgSecurity/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #3

**来源**: [CVE-2020-17530-fatkz_CVE-2020-17530.md](../2020/CVE-2020-17530-fatkz_CVE-2020-17530.md)

## CVE-2020-17530-Apache Struts2-OGNL注入

**漏洞编号:** CVE-2020-17530

**漏洞类型:** OGNL注入

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Struts 2.0.0 - Struts 2.5.25

**利用条件:** 目标系统使用存在漏洞的Apache Struts2版本，且存在可POST的表单或可控的tag属性。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-17530 是一个 Apache Struts2 的 OGNL 注入漏洞。攻击者可以通过构造恶意的 OGNL 表达式，当 Struts2 框架对用户输入（如 tag attributes）进行二次解析时，触发远程代码执行。

**有效性分析：**

根据漏洞信息、搜索结果以及提供的漏洞利用代码，可以判定该POC代码**有效**。漏洞库信息明确指出漏洞存在于 Apache Struts 2.0.0 - Struts 2.5.25 版本，搜索引擎结果也验证了该漏洞的存在和利用方式，POC代码则提供了一个可执行的利用示例。

**投毒风险分析：**

检查提供的 `exploit.py` 脚本，该脚本通过构造 OGNL payload 来执行命令。Payload 的主要逻辑是绕过 Struts2 的安全机制，获取 `InstanceManager`，并利用反射创建对象，调用 `Execute` 类执行命令。脚本结构清晰，主要功能是发送payload到目标URL，没有发现明显的恶意代码或者后门，但是仍然存在风险，即payload本身可以执行任意指令，可能被滥用。存在极小的风险，该风险来自于托管的服务器或者网络中间人篡改。
因此，投毒风险评估为 **1%**。

**利用方式分析：**

1.  **漏洞原理：** Struts2 框架在处理某些标签属性时，会对用户输入的 OGNL 表达式进行二次解析，导致攻击者可以通过构造恶意的 OGNL 表达式来执行任意代码。
2.  **利用步骤：**
    *   攻击者构造包含恶意 OGNL 表达式的 HTTP 请求，通常通过 POST 请求发送。
    *   恶意 OGNL 表达式被作为参数值传递给 Struts2 框架。
    *   Struts2 框架对该表达式进行二次解析，执行 OGNL 表达式中的命令。
3.  **POC 代码分析：** 提供的 `exploit.py` 脚本通过 POST 请求发送包含恶意 OGNL 表达式的 payload。Payload 的核心是使用 Tomcat 的 `InstanceManager` 创建对象，并使用反射调用 `freemarker.template.utility.Execute` 类的 `exec` 方法来执行命令。利用commons-collections的BeanMap的setBean和get方法来获取context和memberAccess进而设置excludedClasses和excludedPackageNames为空，绕过安全限制。最终达到执行任意命令的效果。

**项目地址:** [fatkz/CVE-2020-17530](https://github.com/fatkz/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #4

**来源**: [CVE-2020-17530-fengziHK_CVE-2020-17530-strust2-061.md](../2020/CVE-2020-17530-fengziHK_CVE-2020-17530-strust2-061.md)

## CVE-2020-17530-Apache Struts-远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Struts 2.0.0 - Struts 2.5.25

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，且允许用户可控的输入传递到OGNL表达式的计算中。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-17530 是一个 Apache Struts 框架的远程代码执行漏洞，由于Struts框架在处理tag标签属性时，会对用户输入进行二次OGNL表达式解析导致。

**有效性：**

根据漏洞信息和搜索结果，此漏洞是真实存在的，并且在野外已被利用。提供的POC代码尝试利用此漏洞执行任意命令。POC代码的原理是构造一个包含恶意OGNL表达式的URL，该表达式会被Struts框架解析并执行，从而实现远程代码执行。

**投毒风险：**

该POC代码主要功能是通过发送包含恶意OGNL表达式的HTTP请求来利用漏洞。经过分析，该脚本的目的是执行用户指定的命令，没有发现明显的后门代码。虽然存在通过执行任意命令来植入后门的潜在可能，但就代码本身而言，投毒的概率较低，约为1%。 需要注意的是，攻击者可以使用此漏洞植入恶意软件，因此使用此PoC需要谨慎。

**利用方式：**

1.  **确定目标系统:** 确认目标系统运行着受影响的Apache Struts版本 (2.0.0 - 2.5.25)。
2.  **构造恶意URL:**  使用POC脚本，将目标URL和要执行的命令作为参数传递给脚本。脚本会构造一个包含恶意OGNL表达式的URL。该表达式利用`freemarker.template.utility.Execute`类执行命令。
3.  **发送请求:**  脚本向目标系统发送构造好的HTTP GET 请求。
4.  **执行命令:**  如果目标系统存在漏洞，Struts框架会解析并执行恶意OGNL表达式，从而执行指定的命令。
5.  **获取结果:** POC脚本会从返回的页面提取命令执行的结果，并输出。

**项目地址:** [fengziHK/CVE-2020-17530-strust2-061](https://github.com/fengziHK/CVE-2020-17530-strust2-061)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #5

**来源**: [CVE-2020-17530-ka1n4t_CVE-2020-17530.md](../2020/CVE-2020-17530-ka1n4t_CVE-2020-17530.md)

## CVE-2020-17530-Apache Struts-远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Struts 2.0.0 - Struts 2.5.25

**利用条件:** 目标系统运行受影响版本的Apache Struts，且允许通过HTTP POST请求访问存在漏洞的Action。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞（CVE-2020-17530）是由于Apache Struts框架在处理OGNL表达式时，对用户输入未进行充分的验证，导致可以执行双重OGNL表达式评估。攻击者可以通过在tag属性中注入恶意的OGNL表达式，从而在服务器上执行任意代码。 

**有效性：**
提供的POC代码利用了OGNL表达式注入漏洞。`s2-061.py`脚本通过POST请求向目标URL发送包含恶意OGNL表达式的`name`参数。`README.md`中也提供了POC的payload示例。

**投毒风险：**
查看提供的python脚本，该脚本主要功能是发送含有恶意payload的http请求,从代码角度看，没有发现明显的恶意行为或者后门，因此投毒风险较低。提供的payload 也是常规的漏洞验证payload，旨在调用计算器程序。因此，投毒风险评估为0%。

**利用方式：**
1.  **漏洞定位：** 确定目标系统运行的是受影响版本的Apache Struts (2.0.0 - 2.5.25)。
2.  **构造Payload：**  构造包含恶意OGNL表达式的HTTP请求。POC中使用的payload旨在执行计算器应用程序作为概念验证。可以修改payload来执行其他命令。
3.  **发送请求：**  使用POST请求将payload发送到易受攻击的Struts Action。通常，这涉及到向Struts Action的某个参数（如`name`参数）注入OGNL表达式。
4.  **代码执行：**  如果漏洞利用成功，服务器将执行payload中包含的命令。在POC的情况下，会启动计算器应用程序。在实际攻击中，攻击者可以执行更危险的命令，例如安装后门、窃取数据或控制系统。

**项目地址:** [ka1n4t/CVE-2020-17530](https://github.com/ka1n4t/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #6

**来源**: [CVE-2020-17530-keyuan15_CVE-2020-17530.md](../2020/CVE-2020-17530-keyuan15_CVE-2020-17530.md)

## CVE-2020-17530-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Struts 2.0.0 - Struts 2.5.25

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，且允许处理包含OGNL表达式的请求

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-17530 漏洞是由于 Apache Struts2 在处理标签属性中的用户输入时，进行了强制 OGNL 表达式的二次解析，如果未对用户输入进行充分验证，可能导致远程代码执行。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞确实存在并被广泛利用。提供的 POC 代码使用了 OGNL 表达式注入的方式，尝试通过修改`ValueStack`和`memberAccess`来执行任意命令。经验证，该POC基本有效，但是因为Struts配置不同，可能需要进行修改。

**投毒风险：**

代码本身的主要功能是利用漏洞执行命令，但仔细检查后发现存在潜在的投毒风险。

*   **风险点：** POC中利用`freemarker.template.utility.Execute`执行命令。理论上可以将shell命令替换为恶意程序下载和执行脚本。但原始代码功能依赖于此。
*   **评估：** 投毒风险较低。因为漏洞本身就是执行任意命令，即使替换命令，也只是改变了攻击载荷。该代码不是一个正常的应用代码，本身就是漏洞利用代码，如果上传后，下载者如果不知道漏洞原理，直接运行代码，不会造成任何危害，因为攻击代码需要特定环境。

**利用方式：**

1.  **漏洞定位：** 攻击者需要找到存在漏洞的 Struts2 应用，并且该应用允许通过 HTTP POST 请求传递包含 OGNL 表达式的参数（例如 `id` 字段）。
2.  **OGNL 表达式注入：** 攻击者构造恶意的 OGNL 表达式，将其作为 `id` 参数的值发送给服务器。示例中的 POC 代码使用了复杂的 OGNL 表达式来获取 `ValueStack`，修改 `memberAccess`，然后执行任意命令。
3.  **远程代码执行：** Struts2 在解析 `id` 属性时，会对 OGNL 表达式进行二次解析，从而执行攻击者注入的命令。
4.  **结果获取：** POC 代码通过正则表达式从响应中提取命令执行的结果，并打印到控制台。利用exp函数可以进行交互式操作。

**总结：**

该漏洞的利用方式是典型的 OGNL 表达式注入，攻击者通过构造恶意的 OGNL 表达式来实现远程代码执行。漏洞利用代码具有一定的有效性，但使用时需要注意潜在的风险，并进行适当的安全评估。 投毒概率估计为5%。主要是作者添加了漏洞利用后门或者恶意下载的可能，但是不影响漏洞利用。

**项目地址:** [keyuan15/CVE-2020-17530](https://github.com/keyuan15/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #7

**来源**: [CVE-2020-17530-killmonday_CVE-2020-17530-s2-061.md](../2020/CVE-2020-17530-killmonday_CVE-2020-17530-s2-061.md)

## CVE-2020-17530-Apache Struts2-OGNL表达式注入

**漏洞编号:** CVE-2020-17530

**漏洞类型:** OGNL表达式注入

**影响应用:** Apache Struts2

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Struts 2.0.0 - Struts 2.5.25

**利用条件:** 目标系统使用了受影响版本的Apache Struts2，且允许用户输入未经严格验证的数据到Struts2标签属性中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17530 漏洞是 Apache Struts2 框架中的一个远程代码执行漏洞。由于Struts2对用户输入验证不足，当用户输入的数据被用作OGNL表达式进行求值时，可能导致恶意OGNL表达式被执行，从而实现远程代码执行。

**漏洞利用有效性:**

根据漏洞库信息和搜索结果，CVE-2020-17530是一个已知的、被广泛讨论和利用的漏洞。提供的POC代码包含`exp.py`，展示了利用 OGNL 表达式注入执行命令的方法。该代码首先对命令进行Base64编码，然后将其嵌入到OGNL表达式中，通过POST请求发送到目标URL。经验证此代码是有效的。

**投毒风险分析:**

提供的POC代码主要包含三个文件：`CVE-2020-17530.py` (GUI主程序), `exp.py` (漏洞利用脚本), 和 `README.md` (使用说明)。

*   `CVE-2020-17530.py`: 这是一个使用Tkinter编写的GUI界面，用于方便地输入目标URL和要执行的命令，并显示执行结果。该文件本身没有发现明显的投毒代码。
*   `exp.py`: 这是漏洞利用的核心代码。该脚本将用户输入的命令进行Base64编码，并将其嵌入到 OGNL 表达式中。虽然利用了漏洞实现远程代码执行，但此为漏洞利用的正常步骤，不属于投毒代码。需要注意的是，如果恶意用户利用此脚本攻击他人系统，则属于恶意行为，而不是脚本本身存在投毒。

    代码中潜在的风险在于`_get_shell`函数，该函数用于反弹shell，虽然没有在GUI程序中使用，如果被攻击者利用，可能造成更大的危害。不过，这仍然属于漏洞利用的一部分，而不是投毒。虽然此脚本本身是漏洞利用代码，但如果被恶意修改，例如加入自动传播、植入后门等功能，则会变成投毒代码。从目前的提供的代码来看，直接的投毒代码并不明显，判定为10%是考虑到潜在的被二次修改的风险。
*   `README.md`: 只是一个使用说明文档，不存在任何代码，因此没有投毒风险。

**漏洞利用方式:**

1.  攻击者需要找到存在CVE-2020-17530漏洞的Apache Struts2应用。
2.  攻击者构造包含恶意OGNL表达式的HTTP POST请求。
3.  恶意OGNL表达式利用Struts2的OGNL解析器执行任意系统命令。
4.  服务器执行命令，并将结果返回给攻击者。
5.  攻击者通过执行系统命令，获取服务器的控制权。

**项目地址:** [killmonday/CVE-2020-17530-s2-061](https://github.com/killmonday/CVE-2020-17530-s2-061)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #8

**来源**: [CVE-2020-17530-ludy-dev_freemarker_RCE_struts2_s2-061.md](../2020/CVE-2020-17530-ludy-dev_freemarker_RCE_struts2_s2-061.md)

## CVE-2020-17530-Apache Struts-OGNL远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Struts 2.0.0 - Struts 2.5.25

**利用条件:** 需要目标系统运行存在漏洞版本的Apache Struts，且允许外部访问。攻击者需要构造包含恶意OGNL表达式的HTTP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17530 (S2-061) 是一个Apache Struts框架中的远程代码执行漏洞。漏洞原因是Struts2在处理tag attributes时，对用户输入的OGNL表达式进行了二次解析，导致攻击者可以通过构造恶意的OGNL表达式，在服务器端执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果以及提供的POC代码，该漏洞的利用是有效的。漏洞库信息明确指出该漏洞可导致远程代码执行，影响Struts 2.0.0 - Struts 2.5.25版本。搜索结果中也包含多个安全厂商的分析报告，确认该漏洞的存在和危害。提供的POC代码 `freemarker_RCE_struts2_s2-061.py` 尝试利用 Freemarker 模板引擎的 `Execute` 方法执行命令。

**投毒风险：**
POC代码本身主要是利用了OGNL表达式注入来执行命令。但是，有以下潜在的投毒风险：
1.  **依赖:**  POC依赖于`requests`和`lxml`库。如果攻击者修改了代码，使用`pip install -r requirements.txt`来安装恶意依赖，可能引入恶意代码。虽然此POC没有提供`requirements.txt`，但这是潜在的风险。
2.  **执行任意命令的风险:**  由于该POC旨在执行任意命令，这意味着如果攻击者控制了运行POC的环境，他们可以修改脚本以执行其他恶意操作。这并非POC本身的投毒，而是利用POC执行的命令可能带来的风险。
3.  **URI构造方式:** POC中的URI构造方式较为复杂，通过大量的字符串拼接和截断，虽然目的是绕过WAF或检测，但也增加了隐藏恶意逻辑的可能性。尽管目前看来只是为了构造payload，但需要仔细审查每一步操作。

综合来看，该POC的投毒风险较低，大约为10%，主要集中在人为修改和使用恶意依赖项的可能性上。

**利用方式：**
该漏洞的利用方式如下：
1.  攻击者构造包含恶意OGNL表达式的HTTP请求，通常是通过GET或POST请求的参数传递。
2.  Struts2框架在处理请求时，会对OGNL表达式进行解析和执行。
3.  由于存在二次解析漏洞，攻击者可以利用OGNL表达式执行任意代码，例如执行系统命令或读取敏感文件。

提供的POC代码利用了Freemarker模板引擎的`Execute`方法，通过OGNL表达式`${freemarker.template.utility.Execute.exec('{command}')}`来执行指定的命令。脚本首先构造包含恶意OGNL表达式的URL，然后发送HTTP请求，最后解析响应，提取执行结果。

**项目地址:** [ludy-dev/freemarker_RCE_struts2_s2-061](https://github.com/ludy-dev/freemarker_RCE_struts2_s2-061)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #9

**来源**: [CVE-2020-17530-nth347_CVE-2020-17530.md](../2020/CVE-2020-17530-nth347_CVE-2020-17530.md)

## CVE-2020-17530 - Apache Struts OGNL 远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Struts 2.0.0 - Struts 2.5.25

**利用条件:** Struts应用配置允许OGNL表达式在标签属性中进行二次解析

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17530是Apache Struts框架中的一个远程代码执行漏洞，源于OGNL表达式的二次解析。当Struts配置允许在标签属性中使用用户提供的未经验证的输入，且该输入包含OGNL表达式时，Struts会对该表达式进行二次解析，从而允许攻击者执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的POC是有效的，并且已经被广泛利用。
提供的POC代码看起来能够重现该漏洞。pom.xml 文件指定了受影响的Struts版本 (2.5.25)，并且s2061.jsp文件中的 `<s:a id="%{id}">Simple test</s:a>`  显示了 OGNL 表达式在 `id` 属性中的使用，这是触发漏洞的关键点。Main.java文件设置了一个内嵌的Tomcat服务器，用于运行Struts应用，方便漏洞验证。

**投毒风险：**
分析POC代码，投毒风险较低，大约为10%。
虽然POC代码的目的是为了重现漏洞，但其中可能存在一些潜在的风险。主要集中在以下几个方面：
*   **依赖项风险：** pom.xml 文件中引用的第三方库（尤其是commons-collections 3.2.2）可能本身就存在安全漏洞。如果commons-collections库存在漏洞，攻击者可能会利用这些漏洞进行进一步的攻击。
*   **编译和运行环境风险：** 如果编译或运行POC代码的环境不安全，例如被恶意软件感染，那么恶意软件可能会篡改POC代码，从而引入恶意功能。

**利用方式：**
利用方式主要包括以下步骤：
1.  **确定目标Struts应用版本：** 确认目标应用使用了受影响的Struts版本（2.0.0 - 2.5.25）。
2.  **构造恶意OGNL表达式：** 构造包含恶意代码的OGNL表达式。例如，可以使用`%{Runtime.getRuntime().exec('command')}`来执行系统命令。
3.  **将恶意表达式注入到可控的标签属性中：** 将构造的OGNL表达式注入到Struts标签的属性中，例如 `<s:a id="%{OGNL_EXPRESSION}">`，并且确保该属性会被二次解析。
4.  **发送包含恶意表达式的请求：**  向目标应用发送包含恶意表达式的HTTP请求。
5.  **执行任意代码：** Struts框架会对收到的OGNL表达式进行二次解析，从而执行攻击者注入的任意代码。

**项目地址:** [nth347/CVE-2020-17530](https://github.com/nth347/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #10

**来源**: [CVE-2020-17530-phil-fly_CVE-2020-17530.md](../2020/CVE-2020-17530-phil-fly_CVE-2020-17530.md)

## CVE-2020-17530-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.0.0 - 2.5.25

**利用条件:** 需要目标系统运行受影响版本的Apache Struts2，并且存在可利用的OGNL表达式注入点，通常在tag属性中

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2020-17530 (S2-061) 是一个Apache Struts2的远程代码执行漏洞。漏洞原因是由于Struts2框架在处理tag属性时，如果对用户输入未进行充分验证，可能导致OGNL表达式被强制执行。攻击者可以通过构造恶意的OGNL表达式，注入到tag属性中，从而执行任意代码。

**有效性评估：**

*   提供的README.md文件包含了一个Python代码片段，看似一个POC，用于检测是否存在S2-061漏洞。该POC通过构造一个包含OGNL表达式的URL，并尝试访问目标服务器。如果服务器返回包含"0.0.0.0"的内容，则认为存在漏洞。
*   提供的poc.go文件仅输出"xiangpichine?"，没有任何漏洞利用相关的代码。

因此，README.md中的Python代码片段更有可能是用于漏洞验证的，但缺乏必要的requests库导入，无法直接运行。poc.go文件基本无效。

**投毒风险评估：**

该代码仓库中，poc.go文件没有任何实际功能，属于无用代码。虽然README.md中提供的Python代码片段可以用于检测漏洞，但本身并不具备恶意功能。但是考虑到该仓库同时包含Go和Python代码，且Go代码命名为poc.go，存在混淆的可能性，诱导用户执行恶意代码。此外，网安人员在复现漏洞时,通常会复制粘贴漏洞利用代码,存在一定风险, 因此评估投毒风险为60%。

**漏洞利用方式：**

1.  **找到OGNL表达式注入点：** 在Struts2应用程序中，找到能够接受用户输入并将其作为tag属性值处理的地方。
2.  **构造恶意OGNL表达式：** 构造包含恶意代码的OGNL表达式。例如，可以使用`new java.lang.ProcessBuilder(new java.lang.String[]{'command', 'arg'}).start()`来执行系统命令。
3.  **发送Payload：** 将构造好的OGNL表达式作为参数发送给Struts2应用程序。
4.  **执行代码：** Struts2框架在处理tag属性时，会执行OGNL表达式，从而导致恶意代码被执行。

**总结：**
该漏洞的利用方式是通过构造恶意的OGNL表达式，并将其注入到Struts2应用程序的tag属性中，从而执行任意代码。虽然提供的POC代码可能存在一些问题，但总体上可以判断漏洞利用的可能性。投毒风险主要来自代码混淆的可能性。

**项目地址:** [phil-fly/CVE-2020-17530](https://github.com/phil-fly/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #11

**来源**: [CVE-2020-17530-secpool2000_CVE-2020-17530.md](../2020/CVE-2020-17530-secpool2000_CVE-2020-17530.md)

## CVE-2020-17530-Apache Struts2-OGNL表达式注入

**漏洞编号:** CVE-2020-17530

**漏洞类型:** OGNL表达式注入

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Struts 2.0.0 - Struts 2.5.25

**利用条件:** 需要应用程序使用Struts2，且存在未经过滤的用户输入在tag属性中

**POC 可用性:** 是，但提供的POC无效

**投毒风险:** 100%

## 详情

CVE-2020-17530 (S2-061) 是一个Apache Struts2的OGNL表达式注入漏洞。当Struts2框架在tag属性中对未经验证的用户输入进行双重OGNL表达式计算时，可能导致远程代码执行。根据漏洞库信息和搜索引擎结果，该漏洞影响Struts 2.0.0到Struts 2.5.25版本。

**有效性：**

提供的`POC.py`文件内容是`print("哈哈哈，想屁吃呢???")`，显然这是一个无效的POC，并不能利用该漏洞。

**投毒风险：**

`POC.py`文件本身只是打印一句话，并不包含任何利用漏洞的代码。`README.md`文件只是漏洞的简单描述。 因此，该仓库的投毒风险非常高。作者上传无效POC可能存在欺骗行为。

**利用方式：**

该漏洞的利用方式是构造恶意的OGNL表达式，并将其注入到Struts2 tag的属性中。当Struts2解析该tag时，会执行恶意OGNL表达式，从而导致远程代码执行。

例如，可以利用`%{}`或者`#{}`包裹的OGNL表达式进行注入。具体的利用方式会根据不同的tag和属性有所不同，但基本原理都是利用Struts2的OGNL表达式解析功能来执行任意代码。

根据搜索结果，该漏洞已经在野外被利用。

**项目地址:** [secpool2000/CVE-2020-17530](https://github.com/secpool2000/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #12

**来源**: [CVE-2020-17530-uzzzval_CVE-2020-17530.md](../2020/CVE-2020-17530-uzzzval_CVE-2020-17530.md)

## CVE-2020-17530-Apache Struts-远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 2.0.0 - 2.5.25

**利用条件:** 需要Struts应用存在漏洞的标签属性且允许用户输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17530是Apache Struts框架中的一个远程代码执行漏洞，源于OGNL表达式的二次解析。当Struts应用在标签属性中使用了未经充分验证的用户输入时，可能导致OGNL表达式被恶意构造和执行，从而实现远程代码执行。 

**有效性：** 根据漏洞库信息和搜索结果，该漏洞的POC是存在的，并且已经被公开利用。

**投毒风险：** 提供的漏洞利用代码`/tmp/54051b55ba1c237a2d2b010d3d267cd5/README` 文件内容为空。无法判断是否存在投毒代码。由于该文件来自网络，存在潜在的风险，因此将投毒风险评估为10%。

**利用方式：** 攻击者通过构造包含恶意OGNL表达式的HTTP请求，利用Struts框架对标签属性中用户输入的二次解析漏洞，执行任意代码。具体来说，攻击者可以将恶意的OGNL表达式注入到诸如id等标签属性中，当Struts处理这些属性时，会将表达式解析执行，从而达到攻击目的。从搜索结果来看，'double OGNL evaluation' 是漏洞的利用关键。

**项目地址:** [uzzzval/CVE-2020-17530](https://github.com/uzzzval/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #13

**来源**: [CVE-2020-17530-wuzuowei_CVE-2020-17530.md](../2020/CVE-2020-17530-wuzuowei_CVE-2020-17530.md)

## CVE-2020-17530-Apache Struts-远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Struts 2.0.0 - Struts 2.5.25

**利用条件:** 需要Struts2应用存在漏洞，且允许用户输入进入OGNL表达式计算

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17530是Apache Struts2框架中的一个远程代码执行漏洞，源于对用户输入进行OGNL表达式计算时，未进行充分的验证和过滤，导致攻击者可以通过构造恶意的OGNL表达式，在服务器端执行任意代码。\n\n**有效性：**\n根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判定此漏洞的POC代码有效。漏洞库信息明确指出该漏洞的存在以及影响版本范围。搜索结果中多个链接指向漏洞详情、分析报告，以及利用示例。提供的POC代码包含执行系统命令和反弹shell的脚本，进一步证实了漏洞的可利用性。\n\n**投毒风险：**\n提供的代码仓库主要包含漏洞利用脚本和一些payload。`struts2-061-poc.py`执行简单命令，风险较低。`S2-061-shell.py` 脚本的风险略高，因为需要攻击者提供监听IP和端口，如果作者恶意篡改脚本，可能会将反弹shell指向其他IP，但这种投毒方式容易被发现。虽然仓库内的payload来自多个来源，但都用于执行命令，不存在明显的恶意投毒代码（例如，持续性的后门或数据窃取）。综合评估，投毒风险较低，大约为10%。\n\n**利用方式：**\n1.  **漏洞触发：** 漏洞触发点在于Struts2框架对标签属性中用户输入（未经过滤或验证）的OGNL表达式进行二次解析。攻击者需要找到一个允许用户控制标签属性的输入点。\n2.  **OGNL表达式构造：** 攻击者构造恶意的OGNL表达式，利用OGNL表达式的特性，获取Java对象，调用Java方法，最终执行系统命令。\n3.  **命令执行：** 攻击者可以使用`freemarker.template.utility.Execute`类来执行系统命令。\n4.  **反弹Shell：** 攻击者可以使用java代码来反弹shell，控制服务器。\n\n**利用示例（基于提供的Payload）：**\n1. 使用提供的`struts2-061-poc.py`脚本，指定目标URL和要执行的命令。例如：`python struts2-061-poc.py http://ip:port whoami`\n2. 使用提供的`S2-061-shell.py`脚本，首先在一台机器上监听指定端口，然后运行脚本，输入监听IP和端口，即可获得shell。\n3.  可以使用payload-1和payload-2中提供的OGNL表达式，对URL进行编码后，注入到存在漏洞的参数中。

**项目地址:** [wuzuowei/CVE-2020-17530](https://github.com/wuzuowei/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---



---

## POC #4

**来源**: [CVE-2020-17530-fatkz_CVE-2020-17530.md](../2020/CVE-2020-17530-fatkz_CVE-2020-17530.md)

## CVE-2020-17530-Apache Struts2-OGNL注入

**漏洞编号:** CVE-2020-17530

**漏洞类型:** OGNL注入

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Struts 2.0.0 - Struts 2.5.25

**利用条件:** 目标系统使用存在漏洞的Apache Struts2版本，且存在可POST的表单或可控的tag属性。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-17530 是一个 Apache Struts2 的 OGNL 注入漏洞。攻击者可以通过构造恶意的 OGNL 表达式，当 Struts2 框架对用户输入（如 tag attributes）进行二次解析时，触发远程代码执行。

**有效性分析：**

根据漏洞信息、搜索结果以及提供的漏洞利用代码，可以判定该POC代码**有效**。漏洞库信息明确指出漏洞存在于 Apache Struts 2.0.0 - Struts 2.5.25 版本，搜索引擎结果也验证了该漏洞的存在和利用方式，POC代码则提供了一个可执行的利用示例。

**投毒风险分析：**

检查提供的 `exploit.py` 脚本，该脚本通过构造 OGNL payload 来执行命令。Payload 的主要逻辑是绕过 Struts2 的安全机制，获取 `InstanceManager`，并利用反射创建对象，调用 `Execute` 类执行命令。脚本结构清晰，主要功能是发送payload到目标URL，没有发现明显的恶意代码或者后门，但是仍然存在风险，即payload本身可以执行任意指令，可能被滥用。存在极小的风险，该风险来自于托管的服务器或者网络中间人篡改。
因此，投毒风险评估为 **1%**。

**利用方式分析：**

1.  **漏洞原理：** Struts2 框架在处理某些标签属性时，会对用户输入的 OGNL 表达式进行二次解析，导致攻击者可以通过构造恶意的 OGNL 表达式来执行任意代码。
2.  **利用步骤：**
    *   攻击者构造包含恶意 OGNL 表达式的 HTTP 请求，通常通过 POST 请求发送。
    *   恶意 OGNL 表达式被作为参数值传递给 Struts2 框架。
    *   Struts2 框架对该表达式进行二次解析，执行 OGNL 表达式中的命令。
3.  **POC 代码分析：** 提供的 `exploit.py` 脚本通过 POST 请求发送包含恶意 OGNL 表达式的 payload。Payload 的核心是使用 Tomcat 的 `InstanceManager` 创建对象，并使用反射调用 `freemarker.template.utility.Execute` 类的 `exec` 方法来执行命令。利用commons-collections的BeanMap的setBean和get方法来获取context和memberAccess进而设置excludedClasses和excludedPackageNames为空，绕过安全限制。最终达到执行任意命令的效果。

**项目地址:** [fatkz/CVE-2020-17530](https://github.com/fatkz/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #5

**来源**: [CVE-2020-17530-fengziHK_CVE-2020-17530-strust2-061.md](../2020/CVE-2020-17530-fengziHK_CVE-2020-17530-strust2-061.md)

## CVE-2020-17530-Apache Struts-远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Struts 2.0.0 - Struts 2.5.25

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，且允许用户可控的输入传递到OGNL表达式的计算中。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-17530 是一个 Apache Struts 框架的远程代码执行漏洞，由于Struts框架在处理tag标签属性时，会对用户输入进行二次OGNL表达式解析导致。

**有效性：**

根据漏洞信息和搜索结果，此漏洞是真实存在的，并且在野外已被利用。提供的POC代码尝试利用此漏洞执行任意命令。POC代码的原理是构造一个包含恶意OGNL表达式的URL，该表达式会被Struts框架解析并执行，从而实现远程代码执行。

**投毒风险：**

该POC代码主要功能是通过发送包含恶意OGNL表达式的HTTP请求来利用漏洞。经过分析，该脚本的目的是执行用户指定的命令，没有发现明显的后门代码。虽然存在通过执行任意命令来植入后门的潜在可能，但就代码本身而言，投毒的概率较低，约为1%。 需要注意的是，攻击者可以使用此漏洞植入恶意软件，因此使用此PoC需要谨慎。

**利用方式：**

1.  **确定目标系统:** 确认目标系统运行着受影响的Apache Struts版本 (2.0.0 - 2.5.25)。
2.  **构造恶意URL:**  使用POC脚本，将目标URL和要执行的命令作为参数传递给脚本。脚本会构造一个包含恶意OGNL表达式的URL。该表达式利用`freemarker.template.utility.Execute`类执行命令。
3.  **发送请求:**  脚本向目标系统发送构造好的HTTP GET 请求。
4.  **执行命令:**  如果目标系统存在漏洞，Struts框架会解析并执行恶意OGNL表达式，从而执行指定的命令。
5.  **获取结果:** POC脚本会从返回的页面提取命令执行的结果，并输出。

**项目地址:** [fengziHK/CVE-2020-17530-strust2-061](https://github.com/fengziHK/CVE-2020-17530-strust2-061)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #6

**来源**: [CVE-2020-17530-ka1n4t_CVE-2020-17530.md](../2020/CVE-2020-17530-ka1n4t_CVE-2020-17530.md)

## CVE-2020-17530-Apache Struts-远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Struts 2.0.0 - Struts 2.5.25

**利用条件:** 目标系统运行受影响版本的Apache Struts，且允许通过HTTP POST请求访问存在漏洞的Action。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞（CVE-2020-17530）是由于Apache Struts框架在处理OGNL表达式时，对用户输入未进行充分的验证，导致可以执行双重OGNL表达式评估。攻击者可以通过在tag属性中注入恶意的OGNL表达式，从而在服务器上执行任意代码。 

**有效性：**
提供的POC代码利用了OGNL表达式注入漏洞。`s2-061.py`脚本通过POST请求向目标URL发送包含恶意OGNL表达式的`name`参数。`README.md`中也提供了POC的payload示例。

**投毒风险：**
查看提供的python脚本，该脚本主要功能是发送含有恶意payload的http请求,从代码角度看，没有发现明显的恶意行为或者后门，因此投毒风险较低。提供的payload 也是常规的漏洞验证payload，旨在调用计算器程序。因此，投毒风险评估为0%。

**利用方式：**
1.  **漏洞定位：** 确定目标系统运行的是受影响版本的Apache Struts (2.0.0 - 2.5.25)。
2.  **构造Payload：**  构造包含恶意OGNL表达式的HTTP请求。POC中使用的payload旨在执行计算器应用程序作为概念验证。可以修改payload来执行其他命令。
3.  **发送请求：**  使用POST请求将payload发送到易受攻击的Struts Action。通常，这涉及到向Struts Action的某个参数（如`name`参数）注入OGNL表达式。
4.  **代码执行：**  如果漏洞利用成功，服务器将执行payload中包含的命令。在POC的情况下，会启动计算器应用程序。在实际攻击中，攻击者可以执行更危险的命令，例如安装后门、窃取数据或控制系统。

**项目地址:** [ka1n4t/CVE-2020-17530](https://github.com/ka1n4t/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #7

**来源**: [CVE-2020-17530-keyuan15_CVE-2020-17530.md](../2020/CVE-2020-17530-keyuan15_CVE-2020-17530.md)

## CVE-2020-17530-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Struts 2.0.0 - Struts 2.5.25

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，且允许处理包含OGNL表达式的请求

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-17530 漏洞是由于 Apache Struts2 在处理标签属性中的用户输入时，进行了强制 OGNL 表达式的二次解析，如果未对用户输入进行充分验证，可能导致远程代码执行。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞确实存在并被广泛利用。提供的 POC 代码使用了 OGNL 表达式注入的方式，尝试通过修改`ValueStack`和`memberAccess`来执行任意命令。经验证，该POC基本有效，但是因为Struts配置不同，可能需要进行修改。

**投毒风险：**

代码本身的主要功能是利用漏洞执行命令，但仔细检查后发现存在潜在的投毒风险。

*   **风险点：** POC中利用`freemarker.template.utility.Execute`执行命令。理论上可以将shell命令替换为恶意程序下载和执行脚本。但原始代码功能依赖于此。
*   **评估：** 投毒风险较低。因为漏洞本身就是执行任意命令，即使替换命令，也只是改变了攻击载荷。该代码不是一个正常的应用代码，本身就是漏洞利用代码，如果上传后，下载者如果不知道漏洞原理，直接运行代码，不会造成任何危害，因为攻击代码需要特定环境。

**利用方式：**

1.  **漏洞定位：** 攻击者需要找到存在漏洞的 Struts2 应用，并且该应用允许通过 HTTP POST 请求传递包含 OGNL 表达式的参数（例如 `id` 字段）。
2.  **OGNL 表达式注入：** 攻击者构造恶意的 OGNL 表达式，将其作为 `id` 参数的值发送给服务器。示例中的 POC 代码使用了复杂的 OGNL 表达式来获取 `ValueStack`，修改 `memberAccess`，然后执行任意命令。
3.  **远程代码执行：** Struts2 在解析 `id` 属性时，会对 OGNL 表达式进行二次解析，从而执行攻击者注入的命令。
4.  **结果获取：** POC 代码通过正则表达式从响应中提取命令执行的结果，并打印到控制台。利用exp函数可以进行交互式操作。

**总结：**

该漏洞的利用方式是典型的 OGNL 表达式注入，攻击者通过构造恶意的 OGNL 表达式来实现远程代码执行。漏洞利用代码具有一定的有效性，但使用时需要注意潜在的风险，并进行适当的安全评估。 投毒概率估计为5%。主要是作者添加了漏洞利用后门或者恶意下载的可能，但是不影响漏洞利用。

**项目地址:** [keyuan15/CVE-2020-17530](https://github.com/keyuan15/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #8

**来源**: [CVE-2020-17530-killmonday_CVE-2020-17530-s2-061.md](../2020/CVE-2020-17530-killmonday_CVE-2020-17530-s2-061.md)

## CVE-2020-17530-Apache Struts2-OGNL表达式注入

**漏洞编号:** CVE-2020-17530

**漏洞类型:** OGNL表达式注入

**影响应用:** Apache Struts2

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Struts 2.0.0 - Struts 2.5.25

**利用条件:** 目标系统使用了受影响版本的Apache Struts2，且允许用户输入未经严格验证的数据到Struts2标签属性中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17530 漏洞是 Apache Struts2 框架中的一个远程代码执行漏洞。由于Struts2对用户输入验证不足，当用户输入的数据被用作OGNL表达式进行求值时，可能导致恶意OGNL表达式被执行，从而实现远程代码执行。

**漏洞利用有效性:**

根据漏洞库信息和搜索结果，CVE-2020-17530是一个已知的、被广泛讨论和利用的漏洞。提供的POC代码包含`exp.py`，展示了利用 OGNL 表达式注入执行命令的方法。该代码首先对命令进行Base64编码，然后将其嵌入到OGNL表达式中，通过POST请求发送到目标URL。经验证此代码是有效的。

**投毒风险分析:**

提供的POC代码主要包含三个文件：`CVE-2020-17530.py` (GUI主程序), `exp.py` (漏洞利用脚本), 和 `README.md` (使用说明)。

*   `CVE-2020-17530.py`: 这是一个使用Tkinter编写的GUI界面，用于方便地输入目标URL和要执行的命令，并显示执行结果。该文件本身没有发现明显的投毒代码。
*   `exp.py`: 这是漏洞利用的核心代码。该脚本将用户输入的命令进行Base64编码，并将其嵌入到 OGNL 表达式中。虽然利用了漏洞实现远程代码执行，但此为漏洞利用的正常步骤，不属于投毒代码。需要注意的是，如果恶意用户利用此脚本攻击他人系统，则属于恶意行为，而不是脚本本身存在投毒。

    代码中潜在的风险在于`_get_shell`函数，该函数用于反弹shell，虽然没有在GUI程序中使用，如果被攻击者利用，可能造成更大的危害。不过，这仍然属于漏洞利用的一部分，而不是投毒。虽然此脚本本身是漏洞利用代码，但如果被恶意修改，例如加入自动传播、植入后门等功能，则会变成投毒代码。从目前的提供的代码来看，直接的投毒代码并不明显，判定为10%是考虑到潜在的被二次修改的风险。
*   `README.md`: 只是一个使用说明文档，不存在任何代码，因此没有投毒风险。

**漏洞利用方式:**

1.  攻击者需要找到存在CVE-2020-17530漏洞的Apache Struts2应用。
2.  攻击者构造包含恶意OGNL表达式的HTTP POST请求。
3.  恶意OGNL表达式利用Struts2的OGNL解析器执行任意系统命令。
4.  服务器执行命令，并将结果返回给攻击者。
5.  攻击者通过执行系统命令，获取服务器的控制权。

**项目地址:** [killmonday/CVE-2020-17530-s2-061](https://github.com/killmonday/CVE-2020-17530-s2-061)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #9

**来源**: [CVE-2020-17530-ludy-dev_freemarker_RCE_struts2_s2-061.md](../2020/CVE-2020-17530-ludy-dev_freemarker_RCE_struts2_s2-061.md)

## CVE-2020-17530-Apache Struts-OGNL远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Struts 2.0.0 - Struts 2.5.25

**利用条件:** 需要目标系统运行存在漏洞版本的Apache Struts，且允许外部访问。攻击者需要构造包含恶意OGNL表达式的HTTP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17530 (S2-061) 是一个Apache Struts框架中的远程代码执行漏洞。漏洞原因是Struts2在处理tag attributes时，对用户输入的OGNL表达式进行了二次解析，导致攻击者可以通过构造恶意的OGNL表达式，在服务器端执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果以及提供的POC代码，该漏洞的利用是有效的。漏洞库信息明确指出该漏洞可导致远程代码执行，影响Struts 2.0.0 - Struts 2.5.25版本。搜索结果中也包含多个安全厂商的分析报告，确认该漏洞的存在和危害。提供的POC代码 `freemarker_RCE_struts2_s2-061.py` 尝试利用 Freemarker 模板引擎的 `Execute` 方法执行命令。

**投毒风险：**
POC代码本身主要是利用了OGNL表达式注入来执行命令。但是，有以下潜在的投毒风险：
1.  **依赖:**  POC依赖于`requests`和`lxml`库。如果攻击者修改了代码，使用`pip install -r requirements.txt`来安装恶意依赖，可能引入恶意代码。虽然此POC没有提供`requirements.txt`，但这是潜在的风险。
2.  **执行任意命令的风险:**  由于该POC旨在执行任意命令，这意味着如果攻击者控制了运行POC的环境，他们可以修改脚本以执行其他恶意操作。这并非POC本身的投毒，而是利用POC执行的命令可能带来的风险。
3.  **URI构造方式:** POC中的URI构造方式较为复杂，通过大量的字符串拼接和截断，虽然目的是绕过WAF或检测，但也增加了隐藏恶意逻辑的可能性。尽管目前看来只是为了构造payload，但需要仔细审查每一步操作。

综合来看，该POC的投毒风险较低，大约为10%，主要集中在人为修改和使用恶意依赖项的可能性上。

**利用方式：**
该漏洞的利用方式如下：
1.  攻击者构造包含恶意OGNL表达式的HTTP请求，通常是通过GET或POST请求的参数传递。
2.  Struts2框架在处理请求时，会对OGNL表达式进行解析和执行。
3.  由于存在二次解析漏洞，攻击者可以利用OGNL表达式执行任意代码，例如执行系统命令或读取敏感文件。

提供的POC代码利用了Freemarker模板引擎的`Execute`方法，通过OGNL表达式`${freemarker.template.utility.Execute.exec('{command}')}`来执行指定的命令。脚本首先构造包含恶意OGNL表达式的URL，然后发送HTTP请求，最后解析响应，提取执行结果。

**项目地址:** [ludy-dev/freemarker_RCE_struts2_s2-061](https://github.com/ludy-dev/freemarker_RCE_struts2_s2-061)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #10

**来源**: [CVE-2020-17530-nth347_CVE-2020-17530.md](../2020/CVE-2020-17530-nth347_CVE-2020-17530.md)

## CVE-2020-17530 - Apache Struts OGNL 远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Struts 2.0.0 - Struts 2.5.25

**利用条件:** Struts应用配置允许OGNL表达式在标签属性中进行二次解析

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17530是Apache Struts框架中的一个远程代码执行漏洞，源于OGNL表达式的二次解析。当Struts配置允许在标签属性中使用用户提供的未经验证的输入，且该输入包含OGNL表达式时，Struts会对该表达式进行二次解析，从而允许攻击者执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的POC是有效的，并且已经被广泛利用。
提供的POC代码看起来能够重现该漏洞。pom.xml 文件指定了受影响的Struts版本 (2.5.25)，并且s2061.jsp文件中的 `<s:a id="%{id}">Simple test</s:a>`  显示了 OGNL 表达式在 `id` 属性中的使用，这是触发漏洞的关键点。Main.java文件设置了一个内嵌的Tomcat服务器，用于运行Struts应用，方便漏洞验证。

**投毒风险：**
分析POC代码，投毒风险较低，大约为10%。
虽然POC代码的目的是为了重现漏洞，但其中可能存在一些潜在的风险。主要集中在以下几个方面：
*   **依赖项风险：** pom.xml 文件中引用的第三方库（尤其是commons-collections 3.2.2）可能本身就存在安全漏洞。如果commons-collections库存在漏洞，攻击者可能会利用这些漏洞进行进一步的攻击。
*   **编译和运行环境风险：** 如果编译或运行POC代码的环境不安全，例如被恶意软件感染，那么恶意软件可能会篡改POC代码，从而引入恶意功能。

**利用方式：**
利用方式主要包括以下步骤：
1.  **确定目标Struts应用版本：** 确认目标应用使用了受影响的Struts版本（2.0.0 - 2.5.25）。
2.  **构造恶意OGNL表达式：** 构造包含恶意代码的OGNL表达式。例如，可以使用`%{Runtime.getRuntime().exec('command')}`来执行系统命令。
3.  **将恶意表达式注入到可控的标签属性中：** 将构造的OGNL表达式注入到Struts标签的属性中，例如 `<s:a id="%{OGNL_EXPRESSION}">`，并且确保该属性会被二次解析。
4.  **发送包含恶意表达式的请求：**  向目标应用发送包含恶意表达式的HTTP请求。
5.  **执行任意代码：** Struts框架会对收到的OGNL表达式进行二次解析，从而执行攻击者注入的任意代码。

**项目地址:** [nth347/CVE-2020-17530](https://github.com/nth347/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #11

**来源**: [CVE-2020-17530-phil-fly_CVE-2020-17530.md](../2020/CVE-2020-17530-phil-fly_CVE-2020-17530.md)

## CVE-2020-17530-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.0.0 - 2.5.25

**利用条件:** 需要目标系统运行受影响版本的Apache Struts2，并且存在可利用的OGNL表达式注入点，通常在tag属性中

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2020-17530 (S2-061) 是一个Apache Struts2的远程代码执行漏洞。漏洞原因是由于Struts2框架在处理tag属性时，如果对用户输入未进行充分验证，可能导致OGNL表达式被强制执行。攻击者可以通过构造恶意的OGNL表达式，注入到tag属性中，从而执行任意代码。

**有效性评估：**

*   提供的README.md文件包含了一个Python代码片段，看似一个POC，用于检测是否存在S2-061漏洞。该POC通过构造一个包含OGNL表达式的URL，并尝试访问目标服务器。如果服务器返回包含"0.0.0.0"的内容，则认为存在漏洞。
*   提供的poc.go文件仅输出"xiangpichine?"，没有任何漏洞利用相关的代码。

因此，README.md中的Python代码片段更有可能是用于漏洞验证的，但缺乏必要的requests库导入，无法直接运行。poc.go文件基本无效。

**投毒风险评估：**

该代码仓库中，poc.go文件没有任何实际功能，属于无用代码。虽然README.md中提供的Python代码片段可以用于检测漏洞，但本身并不具备恶意功能。但是考虑到该仓库同时包含Go和Python代码，且Go代码命名为poc.go，存在混淆的可能性，诱导用户执行恶意代码。此外，网安人员在复现漏洞时,通常会复制粘贴漏洞利用代码,存在一定风险, 因此评估投毒风险为60%。

**漏洞利用方式：**

1.  **找到OGNL表达式注入点：** 在Struts2应用程序中，找到能够接受用户输入并将其作为tag属性值处理的地方。
2.  **构造恶意OGNL表达式：** 构造包含恶意代码的OGNL表达式。例如，可以使用`new java.lang.ProcessBuilder(new java.lang.String[]{'command', 'arg'}).start()`来执行系统命令。
3.  **发送Payload：** 将构造好的OGNL表达式作为参数发送给Struts2应用程序。
4.  **执行代码：** Struts2框架在处理tag属性时，会执行OGNL表达式，从而导致恶意代码被执行。

**总结：**
该漏洞的利用方式是通过构造恶意的OGNL表达式，并将其注入到Struts2应用程序的tag属性中，从而执行任意代码。虽然提供的POC代码可能存在一些问题，但总体上可以判断漏洞利用的可能性。投毒风险主要来自代码混淆的可能性。

**项目地址:** [phil-fly/CVE-2020-17530](https://github.com/phil-fly/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #12

**来源**: [CVE-2020-17530-secpool2000_CVE-2020-17530.md](../2020/CVE-2020-17530-secpool2000_CVE-2020-17530.md)

## CVE-2020-17530-Apache Struts2-OGNL表达式注入

**漏洞编号:** CVE-2020-17530

**漏洞类型:** OGNL表达式注入

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Struts 2.0.0 - Struts 2.5.25

**利用条件:** 需要应用程序使用Struts2，且存在未经过滤的用户输入在tag属性中

**POC 可用性:** 是，但提供的POC无效

**投毒风险:** 100%

## 详情

CVE-2020-17530 (S2-061) 是一个Apache Struts2的OGNL表达式注入漏洞。当Struts2框架在tag属性中对未经验证的用户输入进行双重OGNL表达式计算时，可能导致远程代码执行。根据漏洞库信息和搜索引擎结果，该漏洞影响Struts 2.0.0到Struts 2.5.25版本。

**有效性：**

提供的`POC.py`文件内容是`print("哈哈哈，想屁吃呢???")`，显然这是一个无效的POC，并不能利用该漏洞。

**投毒风险：**

`POC.py`文件本身只是打印一句话，并不包含任何利用漏洞的代码。`README.md`文件只是漏洞的简单描述。 因此，该仓库的投毒风险非常高。作者上传无效POC可能存在欺骗行为。

**利用方式：**

该漏洞的利用方式是构造恶意的OGNL表达式，并将其注入到Struts2 tag的属性中。当Struts2解析该tag时，会执行恶意OGNL表达式，从而导致远程代码执行。

例如，可以利用`%{}`或者`#{}`包裹的OGNL表达式进行注入。具体的利用方式会根据不同的tag和属性有所不同，但基本原理都是利用Struts2的OGNL表达式解析功能来执行任意代码。

根据搜索结果，该漏洞已经在野外被利用。

**项目地址:** [secpool2000/CVE-2020-17530](https://github.com/secpool2000/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #13

**来源**: [CVE-2020-17530-uzzzval_CVE-2020-17530.md](../2020/CVE-2020-17530-uzzzval_CVE-2020-17530.md)

## CVE-2020-17530-Apache Struts-远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 2.0.0 - 2.5.25

**利用条件:** 需要Struts应用存在漏洞的标签属性且允许用户输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17530是Apache Struts框架中的一个远程代码执行漏洞，源于OGNL表达式的二次解析。当Struts应用在标签属性中使用了未经充分验证的用户输入时，可能导致OGNL表达式被恶意构造和执行，从而实现远程代码执行。 

**有效性：** 根据漏洞库信息和搜索结果，该漏洞的POC是存在的，并且已经被公开利用。

**投毒风险：** 提供的漏洞利用代码`/tmp/54051b55ba1c237a2d2b010d3d267cd5/README` 文件内容为空。无法判断是否存在投毒代码。由于该文件来自网络，存在潜在的风险，因此将投毒风险评估为10%。

**利用方式：** 攻击者通过构造包含恶意OGNL表达式的HTTP请求，利用Struts框架对标签属性中用户输入的二次解析漏洞，执行任意代码。具体来说，攻击者可以将恶意的OGNL表达式注入到诸如id等标签属性中，当Struts处理这些属性时，会将表达式解析执行，从而达到攻击目的。从搜索结果来看，'double OGNL evaluation' 是漏洞的利用关键。

**项目地址:** [uzzzval/CVE-2020-17530](https://github.com/uzzzval/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #14

**来源**: [CVE-2020-17530-wuzuowei_CVE-2020-17530.md](../2020/CVE-2020-17530-wuzuowei_CVE-2020-17530.md)

## CVE-2020-17530-Apache Struts-远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Struts 2.0.0 - Struts 2.5.25

**利用条件:** 需要Struts2应用存在漏洞，且允许用户输入进入OGNL表达式计算

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17530是Apache Struts2框架中的一个远程代码执行漏洞，源于对用户输入进行OGNL表达式计算时，未进行充分的验证和过滤，导致攻击者可以通过构造恶意的OGNL表达式，在服务器端执行任意代码。\n\n**有效性：**\n根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判定此漏洞的POC代码有效。漏洞库信息明确指出该漏洞的存在以及影响版本范围。搜索结果中多个链接指向漏洞详情、分析报告，以及利用示例。提供的POC代码包含执行系统命令和反弹shell的脚本，进一步证实了漏洞的可利用性。\n\n**投毒风险：**\n提供的代码仓库主要包含漏洞利用脚本和一些payload。`struts2-061-poc.py`执行简单命令，风险较低。`S2-061-shell.py` 脚本的风险略高，因为需要攻击者提供监听IP和端口，如果作者恶意篡改脚本，可能会将反弹shell指向其他IP，但这种投毒方式容易被发现。虽然仓库内的payload来自多个来源，但都用于执行命令，不存在明显的恶意投毒代码（例如，持续性的后门或数据窃取）。综合评估，投毒风险较低，大约为10%。\n\n**利用方式：**\n1.  **漏洞触发：** 漏洞触发点在于Struts2框架对标签属性中用户输入（未经过滤或验证）的OGNL表达式进行二次解析。攻击者需要找到一个允许用户控制标签属性的输入点。\n2.  **OGNL表达式构造：** 攻击者构造恶意的OGNL表达式，利用OGNL表达式的特性，获取Java对象，调用Java方法，最终执行系统命令。\n3.  **命令执行：** 攻击者可以使用`freemarker.template.utility.Execute`类来执行系统命令。\n4.  **反弹Shell：** 攻击者可以使用java代码来反弹shell，控制服务器。\n\n**利用示例（基于提供的Payload）：**\n1. 使用提供的`struts2-061-poc.py`脚本，指定目标URL和要执行的命令。例如：`python struts2-061-poc.py http://ip:port whoami`\n2. 使用提供的`S2-061-shell.py`脚本，首先在一台机器上监听指定端口，然后运行脚本，输入监听IP和端口，即可获得shell。\n3.  可以使用payload-1和payload-2中提供的OGNL表达式，对URL进行编码后，注入到存在漏洞的参数中。

**项目地址:** [wuzuowei/CVE-2020-17530](https://github.com/wuzuowei/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---



---

## POC #4

**来源**: [CVE-2020-17530-fatkz_CVE-2020-17530.md](../2020/CVE-2020-17530-fatkz_CVE-2020-17530.md)

## CVE-2020-17530-Apache Struts2-OGNL注入

**漏洞编号:** CVE-2020-17530

**漏洞类型:** OGNL注入

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Struts 2.0.0 - Struts 2.5.25

**利用条件:** 目标系统使用存在漏洞的Apache Struts2版本，且存在可POST的表单或可控的tag属性。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-17530 是一个 Apache Struts2 的 OGNL 注入漏洞。攻击者可以通过构造恶意的 OGNL 表达式，当 Struts2 框架对用户输入（如 tag attributes）进行二次解析时，触发远程代码执行。

**有效性分析：**

根据漏洞信息、搜索结果以及提供的漏洞利用代码，可以判定该POC代码**有效**。漏洞库信息明确指出漏洞存在于 Apache Struts 2.0.0 - Struts 2.5.25 版本，搜索引擎结果也验证了该漏洞的存在和利用方式，POC代码则提供了一个可执行的利用示例。

**投毒风险分析：**

检查提供的 `exploit.py` 脚本，该脚本通过构造 OGNL payload 来执行命令。Payload 的主要逻辑是绕过 Struts2 的安全机制，获取 `InstanceManager`，并利用反射创建对象，调用 `Execute` 类执行命令。脚本结构清晰，主要功能是发送payload到目标URL，没有发现明显的恶意代码或者后门，但是仍然存在风险，即payload本身可以执行任意指令，可能被滥用。存在极小的风险，该风险来自于托管的服务器或者网络中间人篡改。
因此，投毒风险评估为 **1%**。

**利用方式分析：**

1.  **漏洞原理：** Struts2 框架在处理某些标签属性时，会对用户输入的 OGNL 表达式进行二次解析，导致攻击者可以通过构造恶意的 OGNL 表达式来执行任意代码。
2.  **利用步骤：**
    *   攻击者构造包含恶意 OGNL 表达式的 HTTP 请求，通常通过 POST 请求发送。
    *   恶意 OGNL 表达式被作为参数值传递给 Struts2 框架。
    *   Struts2 框架对该表达式进行二次解析，执行 OGNL 表达式中的命令。
3.  **POC 代码分析：** 提供的 `exploit.py` 脚本通过 POST 请求发送包含恶意 OGNL 表达式的 payload。Payload 的核心是使用 Tomcat 的 `InstanceManager` 创建对象，并使用反射调用 `freemarker.template.utility.Execute` 类的 `exec` 方法来执行命令。利用commons-collections的BeanMap的setBean和get方法来获取context和memberAccess进而设置excludedClasses和excludedPackageNames为空，绕过安全限制。最终达到执行任意命令的效果。

**项目地址:** [fatkz/CVE-2020-17530](https://github.com/fatkz/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #5

**来源**: [CVE-2020-17530-fengziHK_CVE-2020-17530-strust2-061.md](../2020/CVE-2020-17530-fengziHK_CVE-2020-17530-strust2-061.md)

## CVE-2020-17530-Apache Struts-远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Struts 2.0.0 - Struts 2.5.25

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，且允许用户可控的输入传递到OGNL表达式的计算中。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-17530 是一个 Apache Struts 框架的远程代码执行漏洞，由于Struts框架在处理tag标签属性时，会对用户输入进行二次OGNL表达式解析导致。

**有效性：**

根据漏洞信息和搜索结果，此漏洞是真实存在的，并且在野外已被利用。提供的POC代码尝试利用此漏洞执行任意命令。POC代码的原理是构造一个包含恶意OGNL表达式的URL，该表达式会被Struts框架解析并执行，从而实现远程代码执行。

**投毒风险：**

该POC代码主要功能是通过发送包含恶意OGNL表达式的HTTP请求来利用漏洞。经过分析，该脚本的目的是执行用户指定的命令，没有发现明显的后门代码。虽然存在通过执行任意命令来植入后门的潜在可能，但就代码本身而言，投毒的概率较低，约为1%。 需要注意的是，攻击者可以使用此漏洞植入恶意软件，因此使用此PoC需要谨慎。

**利用方式：**

1.  **确定目标系统:** 确认目标系统运行着受影响的Apache Struts版本 (2.0.0 - 2.5.25)。
2.  **构造恶意URL:**  使用POC脚本，将目标URL和要执行的命令作为参数传递给脚本。脚本会构造一个包含恶意OGNL表达式的URL。该表达式利用`freemarker.template.utility.Execute`类执行命令。
3.  **发送请求:**  脚本向目标系统发送构造好的HTTP GET 请求。
4.  **执行命令:**  如果目标系统存在漏洞，Struts框架会解析并执行恶意OGNL表达式，从而执行指定的命令。
5.  **获取结果:** POC脚本会从返回的页面提取命令执行的结果，并输出。

**项目地址:** [fengziHK/CVE-2020-17530-strust2-061](https://github.com/fengziHK/CVE-2020-17530-strust2-061)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #6

**来源**: [CVE-2020-17530-ka1n4t_CVE-2020-17530.md](../2020/CVE-2020-17530-ka1n4t_CVE-2020-17530.md)

## CVE-2020-17530-Apache Struts-远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Struts 2.0.0 - Struts 2.5.25

**利用条件:** 目标系统运行受影响版本的Apache Struts，且允许通过HTTP POST请求访问存在漏洞的Action。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞（CVE-2020-17530）是由于Apache Struts框架在处理OGNL表达式时，对用户输入未进行充分的验证，导致可以执行双重OGNL表达式评估。攻击者可以通过在tag属性中注入恶意的OGNL表达式，从而在服务器上执行任意代码。 

**有效性：**
提供的POC代码利用了OGNL表达式注入漏洞。`s2-061.py`脚本通过POST请求向目标URL发送包含恶意OGNL表达式的`name`参数。`README.md`中也提供了POC的payload示例。

**投毒风险：**
查看提供的python脚本，该脚本主要功能是发送含有恶意payload的http请求,从代码角度看，没有发现明显的恶意行为或者后门，因此投毒风险较低。提供的payload 也是常规的漏洞验证payload，旨在调用计算器程序。因此，投毒风险评估为0%。

**利用方式：**
1.  **漏洞定位：** 确定目标系统运行的是受影响版本的Apache Struts (2.0.0 - 2.5.25)。
2.  **构造Payload：**  构造包含恶意OGNL表达式的HTTP请求。POC中使用的payload旨在执行计算器应用程序作为概念验证。可以修改payload来执行其他命令。
3.  **发送请求：**  使用POST请求将payload发送到易受攻击的Struts Action。通常，这涉及到向Struts Action的某个参数（如`name`参数）注入OGNL表达式。
4.  **代码执行：**  如果漏洞利用成功，服务器将执行payload中包含的命令。在POC的情况下，会启动计算器应用程序。在实际攻击中，攻击者可以执行更危险的命令，例如安装后门、窃取数据或控制系统。

**项目地址:** [ka1n4t/CVE-2020-17530](https://github.com/ka1n4t/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #7

**来源**: [CVE-2020-17530-keyuan15_CVE-2020-17530.md](../2020/CVE-2020-17530-keyuan15_CVE-2020-17530.md)

## CVE-2020-17530-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Struts 2.0.0 - Struts 2.5.25

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，且允许处理包含OGNL表达式的请求

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-17530 漏洞是由于 Apache Struts2 在处理标签属性中的用户输入时，进行了强制 OGNL 表达式的二次解析，如果未对用户输入进行充分验证，可能导致远程代码执行。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞确实存在并被广泛利用。提供的 POC 代码使用了 OGNL 表达式注入的方式，尝试通过修改`ValueStack`和`memberAccess`来执行任意命令。经验证，该POC基本有效，但是因为Struts配置不同，可能需要进行修改。

**投毒风险：**

代码本身的主要功能是利用漏洞执行命令，但仔细检查后发现存在潜在的投毒风险。

*   **风险点：** POC中利用`freemarker.template.utility.Execute`执行命令。理论上可以将shell命令替换为恶意程序下载和执行脚本。但原始代码功能依赖于此。
*   **评估：** 投毒风险较低。因为漏洞本身就是执行任意命令，即使替换命令，也只是改变了攻击载荷。该代码不是一个正常的应用代码，本身就是漏洞利用代码，如果上传后，下载者如果不知道漏洞原理，直接运行代码，不会造成任何危害，因为攻击代码需要特定环境。

**利用方式：**

1.  **漏洞定位：** 攻击者需要找到存在漏洞的 Struts2 应用，并且该应用允许通过 HTTP POST 请求传递包含 OGNL 表达式的参数（例如 `id` 字段）。
2.  **OGNL 表达式注入：** 攻击者构造恶意的 OGNL 表达式，将其作为 `id` 参数的值发送给服务器。示例中的 POC 代码使用了复杂的 OGNL 表达式来获取 `ValueStack`，修改 `memberAccess`，然后执行任意命令。
3.  **远程代码执行：** Struts2 在解析 `id` 属性时，会对 OGNL 表达式进行二次解析，从而执行攻击者注入的命令。
4.  **结果获取：** POC 代码通过正则表达式从响应中提取命令执行的结果，并打印到控制台。利用exp函数可以进行交互式操作。

**总结：**

该漏洞的利用方式是典型的 OGNL 表达式注入，攻击者通过构造恶意的 OGNL 表达式来实现远程代码执行。漏洞利用代码具有一定的有效性，但使用时需要注意潜在的风险，并进行适当的安全评估。 投毒概率估计为5%。主要是作者添加了漏洞利用后门或者恶意下载的可能，但是不影响漏洞利用。

**项目地址:** [keyuan15/CVE-2020-17530](https://github.com/keyuan15/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #8

**来源**: [CVE-2020-17530-killmonday_CVE-2020-17530-s2-061.md](../2020/CVE-2020-17530-killmonday_CVE-2020-17530-s2-061.md)

## CVE-2020-17530-Apache Struts2-OGNL表达式注入

**漏洞编号:** CVE-2020-17530

**漏洞类型:** OGNL表达式注入

**影响应用:** Apache Struts2

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Struts 2.0.0 - Struts 2.5.25

**利用条件:** 目标系统使用了受影响版本的Apache Struts2，且允许用户输入未经严格验证的数据到Struts2标签属性中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17530 漏洞是 Apache Struts2 框架中的一个远程代码执行漏洞。由于Struts2对用户输入验证不足，当用户输入的数据被用作OGNL表达式进行求值时，可能导致恶意OGNL表达式被执行，从而实现远程代码执行。

**漏洞利用有效性:**

根据漏洞库信息和搜索结果，CVE-2020-17530是一个已知的、被广泛讨论和利用的漏洞。提供的POC代码包含`exp.py`，展示了利用 OGNL 表达式注入执行命令的方法。该代码首先对命令进行Base64编码，然后将其嵌入到OGNL表达式中，通过POST请求发送到目标URL。经验证此代码是有效的。

**投毒风险分析:**

提供的POC代码主要包含三个文件：`CVE-2020-17530.py` (GUI主程序), `exp.py` (漏洞利用脚本), 和 `README.md` (使用说明)。

*   `CVE-2020-17530.py`: 这是一个使用Tkinter编写的GUI界面，用于方便地输入目标URL和要执行的命令，并显示执行结果。该文件本身没有发现明显的投毒代码。
*   `exp.py`: 这是漏洞利用的核心代码。该脚本将用户输入的命令进行Base64编码，并将其嵌入到 OGNL 表达式中。虽然利用了漏洞实现远程代码执行，但此为漏洞利用的正常步骤，不属于投毒代码。需要注意的是，如果恶意用户利用此脚本攻击他人系统，则属于恶意行为，而不是脚本本身存在投毒。

    代码中潜在的风险在于`_get_shell`函数，该函数用于反弹shell，虽然没有在GUI程序中使用，如果被攻击者利用，可能造成更大的危害。不过，这仍然属于漏洞利用的一部分，而不是投毒。虽然此脚本本身是漏洞利用代码，但如果被恶意修改，例如加入自动传播、植入后门等功能，则会变成投毒代码。从目前的提供的代码来看，直接的投毒代码并不明显，判定为10%是考虑到潜在的被二次修改的风险。
*   `README.md`: 只是一个使用说明文档，不存在任何代码，因此没有投毒风险。

**漏洞利用方式:**

1.  攻击者需要找到存在CVE-2020-17530漏洞的Apache Struts2应用。
2.  攻击者构造包含恶意OGNL表达式的HTTP POST请求。
3.  恶意OGNL表达式利用Struts2的OGNL解析器执行任意系统命令。
4.  服务器执行命令，并将结果返回给攻击者。
5.  攻击者通过执行系统命令，获取服务器的控制权。

**项目地址:** [killmonday/CVE-2020-17530-s2-061](https://github.com/killmonday/CVE-2020-17530-s2-061)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #9

**来源**: [CVE-2020-17530-ludy-dev_freemarker_RCE_struts2_s2-061.md](../2020/CVE-2020-17530-ludy-dev_freemarker_RCE_struts2_s2-061.md)

## CVE-2020-17530-Apache Struts-OGNL远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Struts 2.0.0 - Struts 2.5.25

**利用条件:** 需要目标系统运行存在漏洞版本的Apache Struts，且允许外部访问。攻击者需要构造包含恶意OGNL表达式的HTTP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17530 (S2-061) 是一个Apache Struts框架中的远程代码执行漏洞。漏洞原因是Struts2在处理tag attributes时，对用户输入的OGNL表达式进行了二次解析，导致攻击者可以通过构造恶意的OGNL表达式，在服务器端执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果以及提供的POC代码，该漏洞的利用是有效的。漏洞库信息明确指出该漏洞可导致远程代码执行，影响Struts 2.0.0 - Struts 2.5.25版本。搜索结果中也包含多个安全厂商的分析报告，确认该漏洞的存在和危害。提供的POC代码 `freemarker_RCE_struts2_s2-061.py` 尝试利用 Freemarker 模板引擎的 `Execute` 方法执行命令。

**投毒风险：**
POC代码本身主要是利用了OGNL表达式注入来执行命令。但是，有以下潜在的投毒风险：
1.  **依赖:**  POC依赖于`requests`和`lxml`库。如果攻击者修改了代码，使用`pip install -r requirements.txt`来安装恶意依赖，可能引入恶意代码。虽然此POC没有提供`requirements.txt`，但这是潜在的风险。
2.  **执行任意命令的风险:**  由于该POC旨在执行任意命令，这意味着如果攻击者控制了运行POC的环境，他们可以修改脚本以执行其他恶意操作。这并非POC本身的投毒，而是利用POC执行的命令可能带来的风险。
3.  **URI构造方式:** POC中的URI构造方式较为复杂，通过大量的字符串拼接和截断，虽然目的是绕过WAF或检测，但也增加了隐藏恶意逻辑的可能性。尽管目前看来只是为了构造payload，但需要仔细审查每一步操作。

综合来看，该POC的投毒风险较低，大约为10%，主要集中在人为修改和使用恶意依赖项的可能性上。

**利用方式：**
该漏洞的利用方式如下：
1.  攻击者构造包含恶意OGNL表达式的HTTP请求，通常是通过GET或POST请求的参数传递。
2.  Struts2框架在处理请求时，会对OGNL表达式进行解析和执行。
3.  由于存在二次解析漏洞，攻击者可以利用OGNL表达式执行任意代码，例如执行系统命令或读取敏感文件。

提供的POC代码利用了Freemarker模板引擎的`Execute`方法，通过OGNL表达式`${freemarker.template.utility.Execute.exec('{command}')}`来执行指定的命令。脚本首先构造包含恶意OGNL表达式的URL，然后发送HTTP请求，最后解析响应，提取执行结果。

**项目地址:** [ludy-dev/freemarker_RCE_struts2_s2-061](https://github.com/ludy-dev/freemarker_RCE_struts2_s2-061)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #10

**来源**: [CVE-2020-17530-nth347_CVE-2020-17530.md](../2020/CVE-2020-17530-nth347_CVE-2020-17530.md)

## CVE-2020-17530 - Apache Struts OGNL 远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Struts 2.0.0 - Struts 2.5.25

**利用条件:** Struts应用配置允许OGNL表达式在标签属性中进行二次解析

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17530是Apache Struts框架中的一个远程代码执行漏洞，源于OGNL表达式的二次解析。当Struts配置允许在标签属性中使用用户提供的未经验证的输入，且该输入包含OGNL表达式时，Struts会对该表达式进行二次解析，从而允许攻击者执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的POC是有效的，并且已经被广泛利用。
提供的POC代码看起来能够重现该漏洞。pom.xml 文件指定了受影响的Struts版本 (2.5.25)，并且s2061.jsp文件中的 `<s:a id="%{id}">Simple test</s:a>`  显示了 OGNL 表达式在 `id` 属性中的使用，这是触发漏洞的关键点。Main.java文件设置了一个内嵌的Tomcat服务器，用于运行Struts应用，方便漏洞验证。

**投毒风险：**
分析POC代码，投毒风险较低，大约为10%。
虽然POC代码的目的是为了重现漏洞，但其中可能存在一些潜在的风险。主要集中在以下几个方面：
*   **依赖项风险：** pom.xml 文件中引用的第三方库（尤其是commons-collections 3.2.2）可能本身就存在安全漏洞。如果commons-collections库存在漏洞，攻击者可能会利用这些漏洞进行进一步的攻击。
*   **编译和运行环境风险：** 如果编译或运行POC代码的环境不安全，例如被恶意软件感染，那么恶意软件可能会篡改POC代码，从而引入恶意功能。

**利用方式：**
利用方式主要包括以下步骤：
1.  **确定目标Struts应用版本：** 确认目标应用使用了受影响的Struts版本（2.0.0 - 2.5.25）。
2.  **构造恶意OGNL表达式：** 构造包含恶意代码的OGNL表达式。例如，可以使用`%{Runtime.getRuntime().exec('command')}`来执行系统命令。
3.  **将恶意表达式注入到可控的标签属性中：** 将构造的OGNL表达式注入到Struts标签的属性中，例如 `<s:a id="%{OGNL_EXPRESSION}">`，并且确保该属性会被二次解析。
4.  **发送包含恶意表达式的请求：**  向目标应用发送包含恶意表达式的HTTP请求。
5.  **执行任意代码：** Struts框架会对收到的OGNL表达式进行二次解析，从而执行攻击者注入的任意代码。

**项目地址:** [nth347/CVE-2020-17530](https://github.com/nth347/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #11

**来源**: [CVE-2020-17530-phil-fly_CVE-2020-17530.md](../2020/CVE-2020-17530-phil-fly_CVE-2020-17530.md)

## CVE-2020-17530-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.0.0 - 2.5.25

**利用条件:** 需要目标系统运行受影响版本的Apache Struts2，并且存在可利用的OGNL表达式注入点，通常在tag属性中

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2020-17530 (S2-061) 是一个Apache Struts2的远程代码执行漏洞。漏洞原因是由于Struts2框架在处理tag属性时，如果对用户输入未进行充分验证，可能导致OGNL表达式被强制执行。攻击者可以通过构造恶意的OGNL表达式，注入到tag属性中，从而执行任意代码。

**有效性评估：**

*   提供的README.md文件包含了一个Python代码片段，看似一个POC，用于检测是否存在S2-061漏洞。该POC通过构造一个包含OGNL表达式的URL，并尝试访问目标服务器。如果服务器返回包含"0.0.0.0"的内容，则认为存在漏洞。
*   提供的poc.go文件仅输出"xiangpichine?"，没有任何漏洞利用相关的代码。

因此，README.md中的Python代码片段更有可能是用于漏洞验证的，但缺乏必要的requests库导入，无法直接运行。poc.go文件基本无效。

**投毒风险评估：**

该代码仓库中，poc.go文件没有任何实际功能，属于无用代码。虽然README.md中提供的Python代码片段可以用于检测漏洞，但本身并不具备恶意功能。但是考虑到该仓库同时包含Go和Python代码，且Go代码命名为poc.go，存在混淆的可能性，诱导用户执行恶意代码。此外，网安人员在复现漏洞时,通常会复制粘贴漏洞利用代码,存在一定风险, 因此评估投毒风险为60%。

**漏洞利用方式：**

1.  **找到OGNL表达式注入点：** 在Struts2应用程序中，找到能够接受用户输入并将其作为tag属性值处理的地方。
2.  **构造恶意OGNL表达式：** 构造包含恶意代码的OGNL表达式。例如，可以使用`new java.lang.ProcessBuilder(new java.lang.String[]{'command', 'arg'}).start()`来执行系统命令。
3.  **发送Payload：** 将构造好的OGNL表达式作为参数发送给Struts2应用程序。
4.  **执行代码：** Struts2框架在处理tag属性时，会执行OGNL表达式，从而导致恶意代码被执行。

**总结：**
该漏洞的利用方式是通过构造恶意的OGNL表达式，并将其注入到Struts2应用程序的tag属性中，从而执行任意代码。虽然提供的POC代码可能存在一些问题，但总体上可以判断漏洞利用的可能性。投毒风险主要来自代码混淆的可能性。

**项目地址:** [phil-fly/CVE-2020-17530](https://github.com/phil-fly/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #12

**来源**: [CVE-2020-17530-secpool2000_CVE-2020-17530.md](../2020/CVE-2020-17530-secpool2000_CVE-2020-17530.md)

## CVE-2020-17530-Apache Struts2-OGNL表达式注入

**漏洞编号:** CVE-2020-17530

**漏洞类型:** OGNL表达式注入

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Struts 2.0.0 - Struts 2.5.25

**利用条件:** 需要应用程序使用Struts2，且存在未经过滤的用户输入在tag属性中

**POC 可用性:** 是，但提供的POC无效

**投毒风险:** 100%

## 详情

CVE-2020-17530 (S2-061) 是一个Apache Struts2的OGNL表达式注入漏洞。当Struts2框架在tag属性中对未经验证的用户输入进行双重OGNL表达式计算时，可能导致远程代码执行。根据漏洞库信息和搜索引擎结果，该漏洞影响Struts 2.0.0到Struts 2.5.25版本。

**有效性：**

提供的`POC.py`文件内容是`print("哈哈哈，想屁吃呢???")`，显然这是一个无效的POC，并不能利用该漏洞。

**投毒风险：**

`POC.py`文件本身只是打印一句话，并不包含任何利用漏洞的代码。`README.md`文件只是漏洞的简单描述。 因此，该仓库的投毒风险非常高。作者上传无效POC可能存在欺骗行为。

**利用方式：**

该漏洞的利用方式是构造恶意的OGNL表达式，并将其注入到Struts2 tag的属性中。当Struts2解析该tag时，会执行恶意OGNL表达式，从而导致远程代码执行。

例如，可以利用`%{}`或者`#{}`包裹的OGNL表达式进行注入。具体的利用方式会根据不同的tag和属性有所不同，但基本原理都是利用Struts2的OGNL表达式解析功能来执行任意代码。

根据搜索结果，该漏洞已经在野外被利用。

**项目地址:** [secpool2000/CVE-2020-17530](https://github.com/secpool2000/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #13

**来源**: [CVE-2020-17530-uzzzval_CVE-2020-17530.md](../2020/CVE-2020-17530-uzzzval_CVE-2020-17530.md)

## CVE-2020-17530-Apache Struts-远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 2.0.0 - 2.5.25

**利用条件:** 需要Struts应用存在漏洞的标签属性且允许用户输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17530是Apache Struts框架中的一个远程代码执行漏洞，源于OGNL表达式的二次解析。当Struts应用在标签属性中使用了未经充分验证的用户输入时，可能导致OGNL表达式被恶意构造和执行，从而实现远程代码执行。 

**有效性：** 根据漏洞库信息和搜索结果，该漏洞的POC是存在的，并且已经被公开利用。

**投毒风险：** 提供的漏洞利用代码`/tmp/54051b55ba1c237a2d2b010d3d267cd5/README` 文件内容为空。无法判断是否存在投毒代码。由于该文件来自网络，存在潜在的风险，因此将投毒风险评估为10%。

**利用方式：** 攻击者通过构造包含恶意OGNL表达式的HTTP请求，利用Struts框架对标签属性中用户输入的二次解析漏洞，执行任意代码。具体来说，攻击者可以将恶意的OGNL表达式注入到诸如id等标签属性中，当Struts处理这些属性时，会将表达式解析执行，从而达到攻击目的。从搜索结果来看，'double OGNL evaluation' 是漏洞的利用关键。

**项目地址:** [uzzzval/CVE-2020-17530](https://github.com/uzzzval/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

## POC #14

**来源**: [CVE-2020-17530-wuzuowei_CVE-2020-17530.md](../2020/CVE-2020-17530-wuzuowei_CVE-2020-17530.md)

## CVE-2020-17530-Apache Struts-远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Struts 2.0.0 - Struts 2.5.25

**利用条件:** 需要Struts2应用存在漏洞，且允许用户输入进入OGNL表达式计算

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17530是Apache Struts2框架中的一个远程代码执行漏洞，源于对用户输入进行OGNL表达式计算时，未进行充分的验证和过滤，导致攻击者可以通过构造恶意的OGNL表达式，在服务器端执行任意代码。\n\n**有效性：**\n根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判定此漏洞的POC代码有效。漏洞库信息明确指出该漏洞的存在以及影响版本范围。搜索结果中多个链接指向漏洞详情、分析报告，以及利用示例。提供的POC代码包含执行系统命令和反弹shell的脚本，进一步证实了漏洞的可利用性。\n\n**投毒风险：**\n提供的代码仓库主要包含漏洞利用脚本和一些payload。`struts2-061-poc.py`执行简单命令，风险较低。`S2-061-shell.py` 脚本的风险略高，因为需要攻击者提供监听IP和端口，如果作者恶意篡改脚本，可能会将反弹shell指向其他IP，但这种投毒方式容易被发现。虽然仓库内的payload来自多个来源，但都用于执行命令，不存在明显的恶意投毒代码（例如，持续性的后门或数据窃取）。综合评估，投毒风险较低，大约为10%。\n\n**利用方式：**\n1.  **漏洞触发：** 漏洞触发点在于Struts2框架对标签属性中用户输入（未经过滤或验证）的OGNL表达式进行二次解析。攻击者需要找到一个允许用户控制标签属性的输入点。\n2.  **OGNL表达式构造：** 攻击者构造恶意的OGNL表达式，利用OGNL表达式的特性，获取Java对象，调用Java方法，最终执行系统命令。\n3.  **命令执行：** 攻击者可以使用`freemarker.template.utility.Execute`类来执行系统命令。\n4.  **反弹Shell：** 攻击者可以使用java代码来反弹shell，控制服务器。\n\n**利用示例（基于提供的Payload）：**\n1. 使用提供的`struts2-061-poc.py`脚本，指定目标URL和要执行的命令。例如：`python struts2-061-poc.py http://ip:port whoami`\n2. 使用提供的`S2-061-shell.py`脚本，首先在一台机器上监听指定端口，然后运行脚本，输入监听IP和端口，即可获得shell。\n3.  可以使用payload-1和payload-2中提供的OGNL表达式，对URL进行编码后，注入到存在漏洞的参数中。

**项目地址:** [wuzuowei/CVE-2020-17530](https://github.com/wuzuowei/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)

---

