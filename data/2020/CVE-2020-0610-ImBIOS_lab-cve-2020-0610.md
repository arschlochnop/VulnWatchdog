## CVE-2020-0610 - Microsoft Windows Remote Desktop Gateway 远程代码执行(RCE)

**漏洞编号:** CVE-2020-0610

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Microsoft Windows Remote Desktop Gateway

**危害等级:** 超危

**CVSS评分:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

**影响版本:** 未提及具体版本，但应包括受支持的Windows Server版本

**利用条件:** 无需用户交互，可能需要预认证

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 30%

## 详情

CVE-2020-0610是一个存在于Microsoft Windows远程桌面网关（RD Gateway）中的远程代码执行漏洞。攻击者可以利用此漏洞在目标系统上执行任意代码。该漏洞是由于RD Gateway服务未能正确处理恶意制作的请求所致。未经身份验证的攻击者可以通过向受影响的系统发送特制的请求来利用此漏洞。成功利用此漏洞的攻击者可以在目标系统上获得与RD Gateway服务相同的权限。根据公开的POC代码，利用步骤如下：1. 下载并解压POC代码包；2. 运行提供的PowerShell脚本，配置测试环境；3. 使用Nuclei模板验证漏洞是否存在；4. 根据脚本中的说明，构造并发送恶意请求到目标RD Gateway服务器。POC代码包含PowerShell脚本和Nuclei模板，用于验证漏洞。该POC具有一定的可用性，但可能需要一些配置才能成功利用。例如，需要确保PowerShell执行策略允许运行脚本，并且目标系统上已安装必要的依赖项。此外，POC可能需要根据目标系统的具体配置进行修改。POC的质量评分为7/10，因为它提供了完整的利用链，但需要一些配置。对于投毒风险分析，该POC主要包含PowerShell脚本和Nuclei模板。PowerShell脚本用于配置测试环境和发送恶意请求，而Nuclei模板用于验证漏洞是否存在。脚本本身的代码相对清晰，没有明显的混淆或恶意行为。但是，由于PowerShell具有强大的系统管理功能，因此存在一定的风险。例如，攻击者可能会修改脚本以执行恶意操作，例如安装后门或窃取敏感数据。此外，该POC还包含一个从外部URL下载文件的操作，这增加了投毒的风险。总体而言，该POC的投毒风险为中等，约为30%。为了降低投毒风险，建议用户在运行POC之前仔细审查代码，并确保从受信任的来源下载POC。

**项目地址:** https://raw.githubusercontent.com/Riocipta75/lab-cve-2020-0610/master/unallured/lab-cve-2020-0610.zip

**漏洞详情:** https://portal.msrc.microsoft.com/zh-CN/security-guidance/advisory/CVE-2020-0610
