## CVE-2020-0610 - Windows RD Gateway RCE

**漏洞编号:** CVE-2020-0610

**漏洞类型:** RCE

**影响应用:** Windows RD Gateway

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** Not specified, but likely affects versions prior to the patch being released.

**利用条件:** Network access to RD Gateway, likely requires some authentication bypass or valid credentials.

**POC 可用性:** 7/10

**POC 类型:** Concept Verification

**攻击复杂度:** High

**投毒风险:** 30%

## 详情

This vulnerability, CVE-2020-0610, also known as BlueGate, is a Remote Code Execution (RCE) vulnerability affecting Windows RD Gateway. The provided Proof of Concept (POC) aims to help users understand and explore this vulnerability. The POC includes PowerShell scripts and Nuclei templates to demonstrate the weakness. The primary file examined is the README.md, which outlines the project structure, system requirements, installation instructions, and usage guidelines.

POC Validity Analysis:
The POC provides a clear setup guide, PowerShell scripts for testing, and examples for validating the vulnerability using Nuclei templates. The repository's structure is well-organized, making it relatively easy to understand the exploit's logic. The provided scripts and tools appear to be designed for educational and research purposes, allowing users to explore the vulnerability in a controlled environment. While the README.md offers a good overview, the actual PowerShell scripts and Nuclei templates would need to be examined in depth to fully assess the POC's effectiveness and completeness. Given the nature of the vulnerability (RCE), successful exploitation could lead to complete system compromise.

Exploitation Steps:
1. Download the ZIP file from the provided link in the README.md.
2. Extract the ZIP file to a local directory.
3. Open PowerShell with appropriate privileges.
4. Navigate to the extracted directory.
5. Execute the setup script. This step is vague and potentially misleading as it points to the ZIP file itself as a script. A proper script should be in the extracted folder.
6. Run the provided PowerShell scripts to test the vulnerability.
7. Use the Nuclei templates to validate the vulnerability.

Due to the inherent risks associated with RCE vulnerabilities, it is crucial to exercise caution when testing this POC. It is recommended to perform the tests in a sandboxed or isolated environment to prevent potential damage to production systems.

Poisoning Risk Analysis:
The provided POC has a moderate poisoning risk. Here's why:

1. External Download URLs: The README.md file directs users to download files from an external URL (`https://raw.githubusercontent.com/Riocipta75/lab-cve-2020-0610/master/unallured/lab-cve-2020-0610.zip`). While this URL appears legitimate based on the GitHub repository name, there is always a risk that the downloaded file could be modified to include malicious code. An attacker could potentially compromise the GitHub account or the raw content server to inject malicious code into the ZIP file.
2. PowerShell Scripts: The POC relies heavily on PowerShell scripts. PowerShell is a powerful scripting language that can be used to perform a wide range of actions on a Windows system. If the PowerShell scripts are not carefully reviewed, they could potentially contain malicious code that could be executed on the target system. While this particular repository seems educational and focused on the CVE, there's always a possibility of modifications or additions by malicious actors.
3. Nuclei Templates: Nuclei templates are used to validate the vulnerability. These templates could potentially contain malicious payloads or logic that could be executed on the target system. Although less likely, there is still a chance that these templates could be weaponized to perform malicious actions.
4. Unclear Setup: The instructions include running `.\https://raw.githubusercontent.com/Riocipta75/lab-cve-2020-0610/master/unallured/lab-cve-2020-0610.zip`. This is not a valid PowerShell command and suggests potential for confusion and error, and potentially the introduction of malicious steps.

Mitigation:
To mitigate the poisoning risk, users should carefully review the downloaded files and scripts before executing them. It is also recommended to perform the tests in a sandboxed environment to prevent potential damage to production systems. Verify the SHA256 hash of the downloaded ZIP file and compare it with a known-good hash, if available. Use static analysis tools to scan the PowerShell scripts and Nuclei templates for malicious code.

Overall, while the POC seems to be intended for educational purposes, the reliance on external downloads and PowerShell scripts introduces a moderate poisoning risk. Users should exercise caution when using this POC and take appropriate steps to mitigate the potential risks.

**项目地址:** https://github.com/Riocipta75/lab-cve-2020-0610

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2020-0610
