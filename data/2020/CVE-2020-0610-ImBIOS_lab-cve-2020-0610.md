## CVE-2020-0610 - Microsoft Windows Remote Desktop Gateway 远程代码执行(RCE)

**漏洞编号:** CVE-2020-0610

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Microsoft Windows Remote Desktop Gateway

**危害等级:** 超危

**CVSS评分:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

**影响版本:** Windows Server 2012, Windows Server 2016, Windows Server 2019

**利用条件:** 无需用户交互，可以在不需要用户干预的情况下远程执行任意代码，预认证即可利用

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2020-0610是一个Microsoft Windows Remote Desktop Gateway中的远程代码执行漏洞。攻击者可以利用此漏洞在目标系统上执行任意代码。该漏洞存在于RDG服务处理请求的方式中，未经身份验证的攻击者可以通过向目标RDG服务器发送特制的请求来触发此漏洞。成功利用此漏洞的攻击者可以在RDG服务器上获得SYSTEM权限。

POC有效性分析：
根据搜索结果和POC代码，该漏洞的POC已经公开，并且存在可用的PowerShell脚本和Nuclei模板来验证和利用该漏洞。POC代码（lab-cve-2020-0610）提供了一个学习和理解该漏洞的环境，包含PowerShell脚本，可以用来测试目标服务器是否存在此漏洞。该POC还包含了Nuclei模板，用于自动化漏洞验证过程。虽然POC代码主要用于教育目的，但其包含了足够的信息和工具，使得攻击者可以基于此开发出完整的exploit。

利用步骤：
1. 下载并解压POC代码压缩包。
2. 配置PowerShell环境，确保可以执行PowerShell脚本。
3. 运行提供的PowerShell脚本，该脚本会发送特制的请求到目标RDG服务器。
4. 如果目标服务器存在漏洞，脚本将会返回确认信息。
5. 使用Nuclei模板进行自动化验证，可以批量检测目标。
6. 基于POC，攻击者可以进一步开发完整的exploit，实现远程代码执行。

投毒风险分析：
该POC主要由PowerShell脚本和Nuclei模板组成，代码相对清晰，主要功能是发送特制的网络请求以触发漏洞，不太可能直接包含恶意代码或后门。但是，任何公开的漏洞利用代码都存在被恶意修改的风险。攻击者可能在原始POC中添加恶意代码，例如下载并执行恶意payload，然后重新发布修改后的POC，从而实现投毒攻击。由于该漏洞影响范围广泛，且易于利用，因此存在较高的投毒风险。考虑到POC的教育性质，以及代码的相对清晰，投毒风险评定为15%。用户在使用任何公开的漏洞利用代码时，都应该进行仔细的安全审查，确保代码的安全性。

**项目地址:** https://github.com/Riocipta75/lab-cve-2020-0610

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2020-0610
