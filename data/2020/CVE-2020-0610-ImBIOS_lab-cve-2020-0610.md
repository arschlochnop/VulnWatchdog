## CVE-2020-0610 - Microsoft Windows Remote Desktop Gateway 远程代码执行(RCE)

**漏洞编号:** CVE-2020-0610

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Microsoft Windows Remote Desktop Gateway

**危害等级:** 超危

**CVSS评分:** N/A

**影响版本:** N/A

**利用条件:** 不需要用户交互

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2020-0610是一个存在于Windows远程桌面网关（RD Gateway）中的远程代码执行漏洞，也被称为BlueGate。该漏洞允许未经授权的攻击者在目标系统上远程执行任意代码。从搜索结果和POC代码来看，该漏洞的利用不需要用户交互，这使得它更容易被利用。

POC代码包含了一个学习和理解该漏洞的项目，提供了PowerShell脚本和Nuclei模板，可以用来测试和验证漏洞的存在。该项目旨在帮助用户了解RD Gateway中的这个弱点，以及如何利用它实现远程代码执行。POC的质量较高，提供了清晰的设置指南和使用说明，用户可以相对容易地搭建测试环境并复现漏洞。然而，运行POC需要在Windows 10或更高版本的系统上，并需要一定的硬件资源。

**利用步骤：**
1. 下载POC代码压缩包并解压。
2. 使用PowerShell运行setup脚本，设置测试环境。
3. 运行提供的PowerShell脚本或Nuclei模板，验证漏洞是否存在。
4. 如果漏洞存在，攻击者可以利用该漏洞在目标系统上执行任意代码。

**POC有效性分析：**
POC代码提供了一种有效的方法来验证CVE-2020-0610漏洞。它包含必要的脚本和模板，允许安全研究人员和系统管理员评估其系统的风险。该POC代码的README文件提供了清晰的说明，使其易于使用和理解。此外，该POC还提供了Nuclei模板，允许用户使用Nuclei扫描器自动检测漏洞。

**投毒风险分析：**
该POC的投毒风险较低。代码主要由PowerShell脚本和配置文件组成，没有发现明显的恶意代码或混淆技术。虽然脚本从GitHub下载资源，存在一定的供应链风险，但是查看下载的资源的内容，发现主要是脚本，并没有发现可疑行为。脚本的使用相对简单，用户可以审查代码以确保其安全性。但是，考虑到PowerShell本身具有执行任意代码的能力，以及脚本可能存在的潜在漏洞，仍然存在一定的风险。此外，虽然代码没有混淆，但是脚本中的URL链接可能会被篡改，指向恶意的服务器，从而导致恶意代码的执行。因此，建议用户在使用POC代码时，仔细审查代码，并确保从可信的来源下载资源。总的来说，该POC的投毒风险较低，但仍需保持警惕。

**项目地址:** https://raw.githubusercontent.com/Riocipta75/lab-cve-2020-0610/master/unallured/lab-cve-2020-0610.zip

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2020-0610
