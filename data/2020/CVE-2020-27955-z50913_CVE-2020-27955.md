# CVE-2020-27955

> 📦 该CVE有 **18** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-27955-Arnoldqqq_CVE-2020-27955.md](../2020/CVE-2020-27955-Arnoldqqq_CVE-2020-27955.md)

## CVE-2020-27955-Git LFS-RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 2.12.0

**利用条件:** 目标系统需要安装Git LFS 2.12.0且克隆了包含恶意LFS对象的仓库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Git LFS 2.12.0中，攻击者可以通过构造包含恶意`.gitattributes`和LFS对象的Git仓库，当目标用户克隆该仓库时，会触发远程代码执行。具体来说，`.gitattributes`文件可以配置LFS处理特定文件类型，攻击者可以利用此特性，将恶意脚本伪装成LFS对象，当Git尝试检出这些文件时，会执行恶意脚本。提供的POC代码包含一个`git.bat`脚本，该脚本创建了一个`GITHACKED`文件，并尝试执行一个PowerShell反向shell脚本`revsh_powersh.ps1`。`revsh_powersh.ps1`尝试连接到`192.168.1.131:1337`。漏洞利用方式是诱导用户克隆包含恶意LFS对象的仓库，从而在用户机器上执行恶意代码。根据提供的代码，没有发现明显的投毒代码。风险主要在于用户克隆了不可信的仓库。

**项目地址:** [Arnoldqqq/CVE-2020-27955](https://github.com/Arnoldqqq/CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #2

**来源**: [CVE-2020-27955-DeeLMind_CVE-2020-27955-LFS.md](../2020/CVE-2020-27955-DeeLMind_CVE-2020-27955-LFS.md)

## CVE-2020-27955-Git LFS-RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，允许攻击者在目标机器上执行任意代码

**影响版本:** 2.12.0

**利用条件:** 需要目标机器安装了受影响版本的Git LFS，并且用户克隆了包含恶意LFS对象的仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-27955 是 Git LFS 2.12.0 中的一个远程代码执行 (RCE) 漏洞。该漏洞的利用方式是，攻击者可以创建一个包含恶意 LFS 对象的 Git 仓库。当受害者克隆该仓库时，Git LFS 会尝试下载这些恶意对象，从而导致在受害者机器上执行任意代码。

**有效性：**
提供的 POC 代码看起来是有效的，因为它包含以下组件：
    * `README.md`: 描述了漏洞和利用方法，并列出了受影响的应用程序。
    * `big-bug-lfs-file.dat`:  一个 LFS 对象示例，用于触发漏洞。
    * `git.bat`: 一个批处理脚本，用于演示如何利用该漏洞。该脚本会创建一个文件`GITHACKED`，并且尝试执行 PowerShell 脚本以建立反向 shell。其中反向shell的目标ip和端口为 deelmind.lab 和 1337
    * `revsh_powersh.ps1`:  一个 PowerShell 脚本，用于建立反向 shell。

**投毒风险：**
投毒风险评估为 10%。 虽然 `revsh_powersh.ps1` 脚本包含硬编码的 IP 地址和端口，但这是反向 shell 的必要组成部分，因此本身不构成投毒行为。  更高级的投毒可能会尝试使用更隐蔽的技术，例如在 LFS 对象中嵌入恶意代码，或者修改现有的脚本以执行其他恶意操作。 但是从提供的POC文件来看,并没有明显的投毒行为。硬编码的反向shell地址和端口相对明显，更容易被发现。

**利用方式：**
利用该漏洞的步骤如下：

1.  攻击者创建一个包含恶意 LFS 对象的 Git 仓库。
2.  攻击者将该仓库上传到公共或私有 Git 仓库托管服务。
3.  受害者克隆该仓库。
4.  当 Git LFS 尝试下载恶意对象时，会执行攻击者预先设定的代码。

在该POC中,攻击者会创建一个名为 `GITHACKED`的文件并在受害者机器上执行 PowerShell 脚本 `revsh_powersh.ps1`，该脚本会尝试连接到攻击者指定的 IP 地址和端口以建立反向 shell。 这使攻击者能够远程控制受害者的机器。

**项目地址:** [DeeLMind/CVE-2020-27955-LFS](https://github.com/DeeLMind/CVE-2020-27955-LFS)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #3

**来源**: [CVE-2020-27955-ExploitBox_git-lfs-RCE-exploit-CVE-2020-27955-Go.md](../2020/CVE-2020-27955-ExploitBox_git-lfs-RCE-exploit-CVE-2020-27955-Go.md)

## CVE-2020-27955 Git LFS Remote Code Execution

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.12.0

**利用条件:** 需要目标系统安装Git LFS 2.12.0，并且使用受影响的Git客户端，如GitHub CLI, GitHub Desktop等

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Git LFS 2.12.0中，允许远程代码执行。攻击者可以构造包含恶意Git LFS对象的仓库，当受害者克隆该仓库时，恶意代码会在受害者的机器上执行。

**有效性：** 提供的Go语言POC代码是有效的，它通过将自身（编译后的git.exe）放置在特定位置，并在`git clone`操作期间被调用，从而执行恶意代码。代码中包含反向shell的逻辑，如果连接失败，会执行计算器程序作为测试。

**投毒风险：** 代码本身的主要功能是利用漏洞，从分析来看，该POC代码不包含明显的恶意投毒行为。代码目的明确，虽然会产生恶意行为，但那是漏洞利用的必然结果。因此，投毒风险评估为0%。

**利用方式：**

1.  **准备恶意仓库：** 攻击者创建一个包含恶意Git LFS对象的仓库。
2.  **植入Payload：**  攻击者将编译后的恶意Go代码（伪装成`git.exe`）放入仓库中，或者确保受害者clone仓库时，将该文件下载到特定目录并覆盖原有的`git.exe`。
3.  **诱骗克隆：**  攻击者诱骗受害者克隆这个恶意仓库。
4.  **触发漏洞：**  当受害者执行`git clone`命令时，Git LFS会尝试处理LFS对象，触发漏洞，从而执行攻击者植入的恶意代码。
5.  **执行恶意代码：** 恶意代码执行，通常是反向Shell，允许攻击者远程控制受害者的机器。或者弹出计算器。

**项目地址:** [ExploitBox/git-lfs-RCE-exploit-CVE-2020-27955-Go](https://github.com/ExploitBox/git-lfs-RCE-exploit-CVE-2020-27955-Go)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #4

**来源**: [CVE-2020-27955-ExploitBox_git-lfs-RCE-exploit-CVE-2020-27955.md](../2020/CVE-2020-27955-ExploitBox_git-lfs-RCE-exploit-CVE-2020-27955.md)

## CVE-2020-27955-Git LFS-RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.12.0

**利用条件:** 需要受害者clone包含恶意LFS对象的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Git LFS 2.12.0版本中。攻击者可以通过构造包含恶意`.gitattributes`文件和恶意LFS对象的Git仓库，当受害者clone该仓库时，会导致远程代码执行。

**有效性分析：** 提供的POC代码有效。`git.bat`脚本中，首先创建了一个名为`GITHACKED`的测试文件，证明了代码执行。随后，脚本尝试执行`revsh_powersh.ps1`，这是一个PowerShell反向Shell脚本，攻击者可以通过修改`revsh_powersh.ps1`中的IP地址和端口来接收shell。

**投毒风险分析：** `revsh_powersh.ps1` 脚本存在一定投毒风险，因为它直接执行了远程shell连接。尽管提供了`calc.exe`作为测试，但是作者鼓励使用反向shell。 这种风险占比大约 10%。 如果用户没有意识到，可能会在受害者主机上植入恶意程序。

**利用方式：**
1.  攻击者创建一个包含`.gitattributes`文件的恶意Git仓库，`.gitattributes`文件将特定文件类型与`git lfs`关联。
2.  攻击者创建一个恶意LFS对象，该对象实际上是一个可执行脚本 (例如，`git.bat` 或 `revsh_powersh.ps1`)，当`git lfs`尝试处理该对象时，会执行该脚本。
3.  攻击者将恶意仓库上传到公共或私有Git服务器。
4.  受害者克隆该仓库，如果受害者安装了Git LFS 2.12.0版本，并且系统是Windows，LFS会尝试处理恶意LFS对象，从而触发远程代码执行。
5.  如果`revsh_powersh.ps1`中的反向shell成功执行，攻击者可以获得受害者主机的控制权。

**项目地址:** [ExploitBox/git-lfs-RCE-exploit-CVE-2020-27955](https://github.com/ExploitBox/git-lfs-RCE-exploit-CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #5

**来源**: [CVE-2020-27955-FrostsaberX_CVE-2020-27955.md](../2020/CVE-2020-27955-FrostsaberX_CVE-2020-27955.md)

## CVE-2020-27955 Git LFS Remote Code Execution

**漏洞编号:** CVE-2020-27955

**漏洞类型:** Remote Code Execution

**影响应用:** Git LFS

**危害等级:** 高危，允许远程代码执行

**影响版本:** 2.12.0

**利用条件:** 需要受害者克隆包含恶意Git LFS对象的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-27955 存在于 Git LFS 2.12.0 中，允许远程代码执行。漏洞利用方式是攻击者创建一个包含恶意配置的 Git 仓库，该仓库会在受害者克隆时执行任意代码。 

**有效性：**
提供的 POC 代码 `/tmp/05242692056c38f909a2dee933ea6fc4/1.bat` 内容为 `calc.exe`，这意味着当受害者克隆包含此文件的恶意仓库时，`calc.exe` 将会被执行。因此，如果 Git LFS 存在漏洞并且这个 `.bat` 文件能够被执行，那么 POC 代码是有效的，可以验证 RCE 漏洞。

**投毒风险：**
虽然提供的 POC 仅仅执行 `calc.exe`，但攻击者可以将此替换为更具破坏性的命令。因此，在实际利用中，存在攻击者在公开仓库中放置恶意代码，诱导用户克隆，从而进行投毒攻击的风险。这里`calc.exe`只是验证漏洞的PoC，不能算作投毒代码，但是如果作者在仓库中隐藏了其他后门代码,则存在投毒风险。 这里假设作者有隐藏代码，风险占比10%。

**利用方式：**
1.  攻击者创建一个恶意 Git 仓库，该仓库包含一个恶意的 Git LFS 对象，该对象配置执行恶意命令（例如，`.bat` 文件或其他脚本）。
2.  攻击者将该仓库上传到公共 Git 托管平台，例如 GitHub 或 GitLab。
3.  攻击者诱骗受害者克隆该仓库（例如，通过社交工程）。
4.  当受害者克隆仓库时，Git LFS 会尝试下载和处理恶意 LFS 对象。
5.  由于存在漏洞，恶意 LFS 对象会执行攻击者指定的代码，从而导致远程代码执行。


**项目地址:** [FrostsaberX/CVE-2020-27955](https://github.com/FrostsaberX/CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #6

**来源**: [CVE-2020-27955-HK69s_CVE-2020-27955.md](../2020/CVE-2020-27955-HK69s_CVE-2020-27955.md)

## CVE-2020-27955-Git LFS-RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，允许远程代码执行

**影响版本:** 2.12.0

**利用条件:** 需要受害者克隆恶意git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-27955 允许攻击者通过构造恶意的 Git LFS 对象，当受害者克隆包含这些恶意对象的仓库时，执行任意代码。漏洞存在于 Git LFS 处理特定文件的方式中，攻击者可以通过 `git.bat` 文件进行攻击，该文件可以创建测试文件，或者通过 powershell 脚本`revsh_powersh.ps1`反弹shell。

**有效性：**

提供的PoC代码看起来是有效的，它包含了一个 `git.bat` 文件，该文件在被克隆的机器上执行，并尝试通过 PowerShell 反弹 shell 到攻击者控制的服务器上。PoC 还包含一个 `revsh_powersh.ps1` 文件，用于执行反向 shell。

**投毒风险：**

投毒风险评估为10%。虽然核心的利用代码看起来直接实现了 RCE，但是 `git.bat` 文件中执行 PowerShell 脚本存在一定的风险。攻击者可能会在 `revsh_powersh.ps1` 脚本中添加额外的恶意代码，例如安装后门，窃取凭据等。如果用户不检查 `revsh_powersh.ps1` 脚本的内容直接执行,则可能存在风险。虽然这种风险较低，但不能完全排除。

**利用方式：**

1.  攻击者创建一个包含恶意 Git LFS 对象的 Git 仓库。
2.  恶意对象包含指向 `git.bat` 文件的链接，该文件包含 PowerShell 脚本。
3.  受害者克隆该恶意仓库。
4.  当 Git LFS 尝试处理恶意对象时，会自动执行 `git.bat` 文件。
5.  `git.bat` 文件创建测试文件,并执行 PowerShell 脚本 `revsh_powersh.ps1`，从而反弹 shell 到攻击者控制的服务器上。
6.  攻击者获得受害者机器的远程访问权限。

**项目地址:** [HK69s/CVE-2020-27955](https://github.com/HK69s/CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #7

**来源**: [CVE-2020-27955-IanSmith123_CVE-2020-27955.md](../2020/CVE-2020-27955-IanSmith123_CVE-2020-27955.md)

## CVE-2020-27955 Git LFS RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.12.0

**利用条件:** 需要克隆包含恶意Git LFS对象的仓库

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2020-27955是Git LFS 2.12.0中存在的一个远程代码执行漏洞。攻击者可以通过创建一个包含恶意Git LFS对象的仓库，当受害者克隆该仓库时，即可执行任意代码。提供的POC代码包含两个文件：

*   `/tmp/9561a509eac14276a7801197af1b917b/a.dat`：这是一个包含"pwn"字符串的数据文件，可能作为LFS对象的内容。
*   `/tmp/9561a509eac14276a7801197af1b917b/git.cmd`：这是一个Windows批处理文件，内容为"calc.exe"，这意味着攻击者试图执行计算器程序。

漏洞利用方式是精心构造 `.gitattributes` 文件，通过 `filter=lfs diff=lfs merge=lfs` 指定 LFS filter ，然后定义 `lfs.clean` 和 `lfs.smudge` 命令来执行恶意代码。

有效性：提供的POC代码看起来是有效的，因为它包含一个用于触发漏洞的数据文件和一个用于执行恶意代码的批处理文件。通过修改批处理文件，攻击者可以执行任意代码。

投毒风险：POC代码中存在明显的投毒风险。批处理文件`git.cmd`的内容是`calc.exe`，这仅仅是示例代码。攻击者可以很容易地将此批处理文件替换为更具破坏性的代码，例如删除文件、安装后门等。因此，克隆包含此漏洞的仓库存在极高的投毒风险，我认为投毒风险为80%。需要注意的是，验证POC本身的行为不应视为投毒，此处是指攻击者恶意利用此漏洞的可能性。

利用方式：

1.  攻击者创建一个包含恶意LFS对象的仓库。
2.  攻击者在仓库的.gitattributes文件中定义lfs filter, smudge, clean命令指向恶意脚本
3.  受害者克隆该仓库。
4.  当Git LFS尝试处理恶意LFS对象时，将执行攻击者预设的恶意代码。
5.  受害者机器被攻击者控制。

**项目地址:** [IanSmith123/CVE-2020-27955](https://github.com/IanSmith123/CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #8

**来源**: [CVE-2020-27955-Kimorea_CVE-2020-27955-LFS.md](../2020/CVE-2020-27955-Kimorea_CVE-2020-27955-LFS.md)

## CVE-2020-27955-Git LFS-RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.12.0

**利用条件:** 受害者需要clone包含恶意LFS对象的Git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Git LFS 2.12.0版本中，允许远程代码执行。攻击者可以通过创建一个包含恶意`.gitattributes`文件和精心构造的LFS对象的Git仓库来利用此漏洞。当受害者克隆该仓库时，Git LFS会尝试处理恶意对象，触发`.gitattributes`中定义的命令执行。根据POC代码，利用方式为：

1.  **创建恶意仓库：** 仓库包含 `.gitattributes` 文件，该文件定义了如何处理特定的文件类型。攻击者会在 `.gitattributes` 中插入恶意命令，例如执行脚本或系统命令。
2.  **创建LFS对象：** 创建一个伪装成 LFS 对象的文件。文件的内容可以是任意的，但重要的是与`.gitattributes`中定义的文件类型相匹配，以便触发 LFS 处理流程。
3.  **诱导受害者克隆仓库：** 攻击者将恶意仓库分享给受害者，诱导其克隆。
4.  **触发RCE：** 当受害者克隆仓库时，Git LFS 会根据 `.gitattributes` 文件的配置尝试处理 LFS 对象，从而执行攻击者预设的恶意命令。

漏洞利用代码中，`git.bat` 脚本展示了如何在Windows环境下触发漏洞。它首先创建一个简单的测试文件，然后尝试执行 `powershell -NoProfile -NonInteractive -ExecutionPolicy Bypass .\revsh_powersh.ps1`，这是一个反向shell脚本。 `revsh_powersh.ps1` 尝试连接到 `192.168.254.128:1111`。

**有效性分析：**  根据漏洞描述和提供的POC代码，该漏洞利用方法是有效的。视频PoC也佐证了其有效性。POC代码已经给出了完整的利用链，包括恶意仓库的构建和RCE的触发。

**投毒风险分析：**

虽然提供的POC代码主要展示了如何利用漏洞进行RCE，但仍然存在一定的投毒风险。例如：

*   `revsh_powersh.ps1` 如果被替换成其他恶意脚本，那么接收反向shell的主机可能会受到进一步的攻击。
*   `.gitattributes` 中的命令可以被精心构造，以执行更隐蔽或破坏性更强的操作，例如删除关键文件、篡改系统配置等。

 总体评估，投毒风险较低，大约10%，因为主要的攻击向量是RCE，而POC相对清晰。潜在的投毒风险主要集中在攻击者替换反向shell脚本或修改`.gitattributes`中的命令上。

**项目地址:** [Kimorea/CVE-2020-27955-LFS](https://github.com/Kimorea/CVE-2020-27955-LFS)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #9

**来源**: [CVE-2020-27955-Marsable_CVE-2020-27955-LFS.md](../2020/CVE-2020-27955-Marsable_CVE-2020-27955-LFS.md)

## CVE-2020-27955-Git LFS-RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，允许远程代码执行

**影响版本:** 2.12.0

**利用条件:** 受害者克隆包含恶意Git LFS对象的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-27955 存在于 Git LFS 2.12.0 中，允许远程代码执行 (RCE)。漏洞的利用方式是通过创建一个包含恶意 Git LFS 对象的仓库，当受害者克隆该仓库时，恶意代码会被执行。POC 利用代码表明这个漏洞影响包括 git，GitHub CLI (gh)，GitHub Desktop，Visual Studio Code，SourceTree，SmartGit，GitKraken 等等。由于 Windows 平台的特殊性，漏洞利用的POC通常是批处理或者PowerShell脚本，因此需要仔细审计。

**有效性：**根据漏洞库信息和提供的POC，该漏洞是有效的，并且存在可用的公开POC。

**投毒风险：** POC 代码本身主要是说明文档，其中提到了漏洞发现者和利用方法链接。代码本身并不包含直接的恶意代码，而是依赖于构建恶意的Git仓库触发漏洞，但是存在引导用户去下载恶意代码或者脚本的风险。因此投毒风险较低，约 10%。

**利用方式：**

1.  攻击者创建一个恶意的 Git 仓库，其中包含一个经过特殊构造的 Git LFS 对象。
2.  当受害者克隆该恶意仓库时，Git LFS 会尝试处理该恶意对象。
3.  由于 Git LFS 存在漏洞，处理恶意对象的过程会导致远程代码执行，攻击者可以控制受害者的计算机。

**项目地址:** [Marsable/CVE-2020-27955-LFS](https://github.com/Marsable/CVE-2020-27955-LFS)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #10

**来源**: [CVE-2020-27955-NeoDarwin_CVE-2020-27955.md](../2020/CVE-2020-27955-NeoDarwin_CVE-2020-27955.md)

## CVE-2020-27955 - Git LFS Remote Code Execution

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git LFS

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 2.12.0

**利用条件:** 受害者需要克隆包含恶意 LFS 对象的 Git 仓库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-27955 存在于 Git LFS 2.12.0 版本中，允许远程代码执行。攻击者可以构造一个包含恶意 LFS 对象的 Git 仓库，当受害者克隆该仓库时，恶意代码将被执行。

**有效性:**
从提供的漏洞库信息和漏洞利用代码来看，此漏洞是真实存在的，并且存在公开可用的PoC。给定的PoC代码片段 `/tmp/49c4fbaed875f12fa54ac4584233f202/git.bat`  就是一个简单的批处理脚本，用于在受害者机器上创建 `GITHACKED` 文件，表明代码执行已成功。`big-bug-lfs-file.dat` 代表的是一个恶意的lfs对象。

**投毒风险:**
提供的PoC 代码仅包含一个批处理脚本，用于创建文件，没有发现任何其他的后门或恶意代码。因此，可以认为该仓库中不存在作者隐藏的投毒代码。`poison` 的值为0%。

**利用方式:**
利用方式如下：
1.  攻击者创建一个包含恶意 LFS 对象的 Git 仓库。
2.  恶意 LFS 对象会包含一些元数据，指示 Git LFS 在检出时执行特定的命令。
3.  受害者克隆该仓库。
4.  Git LFS 尝试下载和处理恶意 LFS 对象。
5.  在处理 LFS 对象期间，预先设定的恶意代码被执行，从而导致远程代码执行。

总而言之，此漏洞利用的有效性较高，且 PoC 简单直接，投毒风险较低。受害者需要克隆恶意仓库才会触发漏洞。

**项目地址:** [NeoDarwin/CVE-2020-27955](https://github.com/NeoDarwin/CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #11

**来源**: [CVE-2020-27955-TheTh1nk3r_cve-2020-27955.md](../2020/CVE-2020-27955-TheTh1nk3r_cve-2020-27955.md)

## CVE-2020-27955 - Git LFS Remote Code Execution

**漏洞编号:** CVE-2020-27955

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Git LFS

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.12.0

**利用条件:** 目标机器安装了Git LFS 2.12.0，且攻击者可以push包含恶意配置的仓库到目标机器上或者诱导目标机器clone恶意仓库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Git LFS 2.12.0版本中，攻击者可以通过创建一个包含恶意配置的Git仓库，诱导受害者克隆该仓库，从而在受害者机器上执行任意代码。具体利用方式如下：

1.  **创建恶意仓库:** 攻击者首先创建一个Git仓库，并初始化Git LFS。
2.  **配置`.gitattributes`:**  攻击者需要在`.gitattributes`文件中配置一个或多个文件类型，将其与一个自定义的Git LFS命令关联。这个命令可以是任意可执行文件，例如`git.cmd`。
3.  **创建恶意`git.cmd`:** 攻击者创建一个名为`git.cmd`的文件，该文件包含要执行的恶意代码。示例中，`git.cmd`的内容为`calc.exe`，用于启动计算器程序。
4.  **跟踪大文件:** 使用`git lfs track`命令跟踪一个或多个大文件类型（例如`*.dat`）。
5.  **添加并提交文件:**  将所有文件（包括`.gitattributes`、`git.cmd`、以及被跟踪的大文件）添加到Git仓库并提交。
6.  **推送仓库:** 攻击者将恶意仓库推送到远程服务器。当受害者克隆该仓库时，Git LFS会尝试处理被跟踪的文件，并执行`.gitattributes`中配置的自定义命令，从而触发RCE。

**POC有效性:**  根据提供的POC代码，该漏洞利用方式是有效的。它通过精心构造的`.gitattributes`文件和`git.cmd`文件，实现了在克隆仓库时执行任意代码的目的。

**投毒风险分析:**  提供的POC代码本身是直接的RCE利用，没有发现明显的投毒代码。`large.dat`文件仅包含"test"字符串，`git.cmd`文件仅包含`calc.exe`，这些都不属于投毒行为。因此，仓库中存在隐藏的投毒代码的可能性较低，判定为 0%。

**利用方式总结:** 攻击者通过创建包含恶意`.gitattributes`文件的Git仓库，诱导受害者克隆该仓库。当受害者机器上的Git LFS处理被跟踪的文件时，会执行`.gitattributes`文件中配置的恶意命令，从而导致RCE。

**项目地址:** [TheTh1nk3r/cve-2020-27955](https://github.com/TheTh1nk3r/cve-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #12

**来源**: [CVE-2020-27955-nob0dy-3389_CVE-2020-27955.md](../2020/CVE-2020-27955-nob0dy-3389_CVE-2020-27955.md)

## CVE-2020-27955-Git LFS-RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 2.12.0

**利用条件:** 目标系统安装了Git LFS 2.12.0，并且克隆了包含恶意LFS对象的Git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-27955是一个存在于Git LFS 2.12.0中的远程代码执行漏洞。攻击者可以通过创建一个包含恶意LFS对象的Git仓库，当受害者克隆该仓库时，恶意代码会被执行。\n\n根据提供的漏洞利用代码，`/tmp/b034253cc61d8b86d6971e4703f5432d/git.sh` 文件的内容是 `rmdir /home/an0nymous/Desktop/flag`。这段代码会尝试删除用户 `an0nymous` 桌面上的 `flag` 目录。这表明POC的目的是在受害者机器上执行任意命令。\n\n**有效性：**根据漏洞信息和利用代码，该漏洞是有效的。利用方式是通过恶意构造的git仓库，在受害者克隆仓库时触发RCE。\n\n**投毒风险：**  利用代码 `rmdir /home/an0nymous/Desktop/flag` 本身并没有明显的投毒迹象。  投毒风险较低，约为 10%。潜在的投毒风险可能存在于更复杂的利用场景中，攻击者可能在LFS对象中嵌入更隐蔽的恶意代码，例如下载并执行其他恶意脚本，或者修改系统关键文件等。 因此，虽然目前提供的 POC 代码没有明显的投毒行为，但不能完全排除投毒的可能性。\n\n**利用方式：**\n1.  攻击者创建一个包含恶意LFS对象的Git仓库。这个恶意LFS对象包含能够执行任意命令的payload。\n2.  攻击者将这个恶意仓库托管到一个公开的Git服务器上。\n3.  受害者克隆这个恶意仓库。\n4.  当Git LFS处理恶意LFS对象时，其中的payload会被执行，导致远程代码执行。

**项目地址:** [nob0dy-3389/CVE-2020-27955](https://github.com/nob0dy-3389/CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #13

**来源**: [CVE-2020-27955-r00t4dm_CVE-2020-27955.md](../2020/CVE-2020-27955-r00t4dm_CVE-2020-27955.md)

## CVE-2020-27955 Git LFS RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git LFS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.12.0

**利用条件:** 目标系统安装了存在漏洞的 Git LFS 版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-27955 允许通过克隆包含特制 `.gitattributes` 文件的仓库来执行远程代码。漏洞利用方式如下：

1.  **创建包含恶意 `.gitattributes` 文件的 Git 仓库:**  `.gitattributes` 文件中定义了 Git LFS 如何处理特定类型的文件。恶意文件会配置LFS来调用`git.cmd`文件。
2.  **`git.cmd` 文件:** POC中，`git.cmd` 内容为 `calc.exe`，用于在Windows系统上启动计算器。
3.  **`large.dat` 文件:** 这是一个示例文件，它的存在是为了满足 LFS 的基本要求，内容无关紧要。
4.  **克隆仓库触发漏洞:** 当受害者克隆包含这些恶意文件的仓库时，Git LFS 会尝试处理 `large.dat` 文件，并根据 `.gitattributes` 中的配置执行 `git.cmd`，从而执行 `calc.exe`。

**有效性评估:** 提供的 POC 代码是有效的，如果目标系统存在漏洞，克隆该仓库将导致 `calc.exe` 被执行，证明了远程代码执行。

**投毒风险评估:** 此仓库中没有发现明显的投毒代码。 `git.cmd` 文件的内容很直接，就是执行 `calc.exe`，没有隐藏其他恶意行为。`large.dat` 文件仅包含 “junk”，没有可执行代码。 `.gitattributes` 是漏洞利用的关键，但也只是配置 LFS 执行 `git.cmd` 。 因此，投毒风险评估为 0%。

**利用方式总结:** 攻击者创建一个包含恶意 `.gitattributes` 文件的 Git 仓库，受害者克隆该仓库时，会触发远程代码执行漏洞。

**项目地址:** [r00t4dm/CVE-2020-27955](https://github.com/r00t4dm/CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #14

**来源**: [CVE-2020-27955-the-chivalrousZ_cve-2020-27955.md](../2020/CVE-2020-27955-the-chivalrousZ_cve-2020-27955.md)

## CVE-2020-27955 Git LFS Remote Code Execution

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git LFS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.12.0

**利用条件:** 需要攻击者能够创建包含恶意配置的 Git 仓库，并诱使用户克隆。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-27955 漏洞存在于 Git LFS 2.12.0 版本中，允许远程代码执行。从给定的漏洞库信息可知，该漏洞利用方式是通过精心构造的 Git 仓库，当受害者克隆包含恶意 LFS 对象配置的仓库时，可以执行任意命令。提供的 POC 代码仅包含 LICENSE, README.md 和一个名为 large.dat 的文件, 没有体现出任何可以远程代码执行的利用方式. 因此有效性无法直接通过POC验证。由于POC代码很简单，只包含一些基本的文件，不包含任何可疑的或者混淆的代码，因此投毒风险很低。但是，由于缺乏实际的漏洞利用代码，POC 的有效性和实际利用方式还需进一步分析。

**利用方式推测:**

根据漏洞描述和搜索结果，推测漏洞利用方式可能如下：

1.  攻击者创建一个包含 `.gitattributes` 文件的 Git 仓库。该文件指定了使用 Git LFS 处理特定类型的文件。
2.  攻击者在 `.gitattributes` 文件中配置恶意命令，例如 `*.ext filter=lfs diff=lfs merge=lfs -text`，并创建一个 `lfs.ext.clean` 或 `lfs.ext.smudge` 指向恶意脚本。
3.  当受害者克隆该仓库时，Git LFS 尝试处理指定类型的文件时，将执行攻击者配置的恶意命令，从而导致远程代码执行。

由于未提供利用代码，这些分析是基于漏洞描述和公开资料的推测。

**项目地址:** [the-chivalrousZ/cve-2020-27955](https://github.com/the-chivalrousZ/cve-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #15

**来源**: [CVE-2020-27955-userxfan_cve-2020-27955.md](../2020/CVE-2020-27955-userxfan_cve-2020-27955.md)

## CVE-2020-27955-Git LFS Remote Code Execution

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.12.0

**利用条件:** 目标机器安装了Git LFS 2.12.0，并且clone了包含恶意配置的仓库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-27955 存在于 Git LFS 2.12.0 中，允许远程代码执行。根据漏洞库信息，存在多个关于此漏洞的参考链接，包括exploitbox.io, legalhackers.com 等，这些链接提供了漏洞详情和可能的利用方式。 

**有效性分析：**

提供的POC代码包含三个文件：

*   `README.md`：包含CVE编号信息。
*   `git.cmd`：包含 `calc.exe`，这表明漏洞利用可能涉及执行任意命令。
*   `large.dat`：包含字符串 `test`，这可能是 LFS 对象的内容。

根据已有的漏洞分析报告，利用方式通常是，在`.gitattributes` 文件中设置一个恶意filter，当检出包含 LFS 对象的特定文件时，会触发该filter执行。POC中的 `git.cmd` 脚本 `calc.exe` 符合这个利用模式，表明这个POC很可能有效。

**投毒风险分析：**

分析POC代码内容，此仓库主要包含漏洞验证代码，没有发现隐藏的投毒代码。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者创建一个包含恶意`.gitattributes`文件的Git仓库。`.gitattributes`文件将特定的文件类型或路径与一个恶意的Git filter（例如clean或smudge）关联起来。
2.  该filter配置执行任意命令。例如，可以执行一个shell脚本或任何其他可执行文件。
3.  攻击者将包含恶意`.gitattributes`文件的仓库上传到公共或私有Git服务器。
4.  受害者克隆（clone）或检出（checkout）该仓库。
5.  当Git处理与恶意filter关联的文件时，它会执行`.gitattributes`文件中配置的恶意命令，从而导致远程代码执行。
6.  POC中的 `git.cmd` 脚本是恶意命令，large.dat 是需要处理的 LFS 对象。当用户 clone 包含这些文件的仓库时，就会触发 RCE。


**项目地址:** [userxfan/cve-2020-27955](https://github.com/userxfan/cve-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #16

**来源**: [CVE-2020-27955-whitetea2424_CVE-2020-27955-LFS-main.md](../2020/CVE-2020-27955-whitetea2424_CVE-2020-27955-LFS-main.md)

## CVE-2020-27955 Git LFS RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.12.0

**利用条件:** 受害者需要clone包含恶意lfs对象的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-27955 是 Git LFS 2.12.0 版本中的一个远程代码执行漏洞。根据提供的漏洞利用代码，攻击者可以通过创建一个包含恶意 `.gitattributes` 文件和 LFS 对象的 Git 仓库来触发此漏洞。当受害者克隆（clone）该仓库时，Git LFS 会尝试处理这些 LFS 对象，恶意 `.gitattributes` 文件中可以包含命令，使得执行任意命令。

**有效性：**
提供的POC代码包含一个批处理文件（git.bat）和一个PowerShell脚本(revsh_powersh.ps1), 批处理文件会先创建一个名为GITHACKED的文件, 然后执行powershell脚本，反弹shell。该利用方式是有效的，受害者clone仓库后即可触发。

**投毒风险：**
此仓库中存在潜在的投毒风险。虽然主要目的是演示CVE-2020-27955漏洞，但攻击者可能在提供的反弹shell脚本`revsh_powersh.ps1`中加入其他恶意代码，例如安装后门、窃取信息等。此外，`git.bat` 本身也可以被修改为执行更具破坏性的操作。例如, 修改`git.bat`在反弹shell之前或者之后执行其他的恶意指令。因此，存在一定的投毒可能性，但主要功能还是为了验证漏洞。 风险比例预估为10%。

**利用方式：**
1.  攻击者创建一个包含恶意 `.gitattributes` 文件和 LFS 对象的 Git 仓库。
2.  恶意 `.gitattributes` 文件包含指向恶意 LFS 对象的配置，并嵌入命令执行。
3.  受害者克隆（clone）该恶意仓库。
4.  当 Git LFS 尝试处理恶意 LFS 对象时，会执行 `.gitattributes` 文件中嵌入的命令，导致远程代码执行。
5.  PoC包含反弹shell的powershell脚本，执行后攻击者可以获取shell.

**项目地址:** [whitetea2424/CVE-2020-27955-LFS-main](https://github.com/whitetea2424/CVE-2020-27955-LFS-main)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #17

**来源**: [CVE-2020-27955-yhsung_cve-2020-27955-poc.md](../2020/CVE-2020-27955-yhsung_cve-2020-27955-poc.md)

## CVE-2020-27955-Git LFS-RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** RCE

**影响应用:** Git LFS

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.12.0

**利用条件:** 需要受害者clone包含恶意Git LFS对象的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息，Git LFS 2.12.0存在远程代码执行漏洞（CVE-2020-27955）。漏洞利用代码包含`git.cmd`和`large.dat`两个文件。

*   `git.cmd`包含`calc.exe`，说明这个POC的目的是在目标机器上执行`calc.exe`。
*   `large.dat`文件包含`Junk`，可能是一个占位文件，用于满足Git LFS对大文件的要求。

**利用方式：**攻击者创建一个包含恶意Git LFS对象的Git仓库。当受害者克隆该仓库时，Git LFS会尝试下载并处理这些对象。通过精心构造`.gitattributes`文件和LFS对象的内容，攻击者可以使`git lfs pull`命令执行任意命令。本例中，`git.cmd`会被执行，从而启动计算器程序。

**有效性：**  提供的POC代码看起来是有效的，因为`git.cmd`包含执行计算器的命令。如果能成功触发`git lfs pull`并执行该文件，则可以证明漏洞的存在。

**投毒风险：** 此仓库存在一定的投毒风险，约为10%。虽然主要目的是执行`calc.exe`，但是`git.cmd`文件的内容可以被修改为其他恶意命令。如果攻击者在`git.cmd`中放置更隐蔽的恶意代码，例如下载并执行其他Payload，则可能实现更严重的攻击，且不易被察觉。  `large.dat`文件本身不太可能存在投毒行为，因为它只是一个占位文件。


**项目地址:** [yhsung/cve-2020-27955-poc](https://github.com/yhsung/cve-2020-27955-poc)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #18

**来源**: [CVE-2020-27955-z50913_CVE-2020-27955.md](../2020/CVE-2020-27955-z50913_CVE-2020-27955.md)

# CVE-2020-27955

> 📦 该CVE有 **18** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-27955-Arnoldqqq_CVE-2020-27955.md](../2020/CVE-2020-27955-Arnoldqqq_CVE-2020-27955.md)

## CVE-2020-27955-Git LFS-RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 2.12.0

**利用条件:** 目标系统需要安装Git LFS 2.12.0且克隆了包含恶意LFS对象的仓库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Git LFS 2.12.0中，攻击者可以通过构造包含恶意`.gitattributes`和LFS对象的Git仓库，当目标用户克隆该仓库时，会触发远程代码执行。具体来说，`.gitattributes`文件可以配置LFS处理特定文件类型，攻击者可以利用此特性，将恶意脚本伪装成LFS对象，当Git尝试检出这些文件时，会执行恶意脚本。提供的POC代码包含一个`git.bat`脚本，该脚本创建了一个`GITHACKED`文件，并尝试执行一个PowerShell反向shell脚本`revsh_powersh.ps1`。`revsh_powersh.ps1`尝试连接到`192.168.1.131:1337`。漏洞利用方式是诱导用户克隆包含恶意LFS对象的仓库，从而在用户机器上执行恶意代码。根据提供的代码，没有发现明显的投毒代码。风险主要在于用户克隆了不可信的仓库。

**项目地址:** [Arnoldqqq/CVE-2020-27955](https://github.com/Arnoldqqq/CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #2

**来源**: [CVE-2020-27955-DeeLMind_CVE-2020-27955-LFS.md](../2020/CVE-2020-27955-DeeLMind_CVE-2020-27955-LFS.md)

## CVE-2020-27955-Git LFS-RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，允许攻击者在目标机器上执行任意代码

**影响版本:** 2.12.0

**利用条件:** 需要目标机器安装了受影响版本的Git LFS，并且用户克隆了包含恶意LFS对象的仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-27955 是 Git LFS 2.12.0 中的一个远程代码执行 (RCE) 漏洞。该漏洞的利用方式是，攻击者可以创建一个包含恶意 LFS 对象的 Git 仓库。当受害者克隆该仓库时，Git LFS 会尝试下载这些恶意对象，从而导致在受害者机器上执行任意代码。

**有效性：**
提供的 POC 代码看起来是有效的，因为它包含以下组件：
    * `README.md`: 描述了漏洞和利用方法，并列出了受影响的应用程序。
    * `big-bug-lfs-file.dat`:  一个 LFS 对象示例，用于触发漏洞。
    * `git.bat`: 一个批处理脚本，用于演示如何利用该漏洞。该脚本会创建一个文件`GITHACKED`，并且尝试执行 PowerShell 脚本以建立反向 shell。其中反向shell的目标ip和端口为 deelmind.lab 和 1337
    * `revsh_powersh.ps1`:  一个 PowerShell 脚本，用于建立反向 shell。

**投毒风险：**
投毒风险评估为 10%。 虽然 `revsh_powersh.ps1` 脚本包含硬编码的 IP 地址和端口，但这是反向 shell 的必要组成部分，因此本身不构成投毒行为。  更高级的投毒可能会尝试使用更隐蔽的技术，例如在 LFS 对象中嵌入恶意代码，或者修改现有的脚本以执行其他恶意操作。 但是从提供的POC文件来看,并没有明显的投毒行为。硬编码的反向shell地址和端口相对明显，更容易被发现。

**利用方式：**
利用该漏洞的步骤如下：

1.  攻击者创建一个包含恶意 LFS 对象的 Git 仓库。
2.  攻击者将该仓库上传到公共或私有 Git 仓库托管服务。
3.  受害者克隆该仓库。
4.  当 Git LFS 尝试下载恶意对象时，会执行攻击者预先设定的代码。

在该POC中,攻击者会创建一个名为 `GITHACKED`的文件并在受害者机器上执行 PowerShell 脚本 `revsh_powersh.ps1`，该脚本会尝试连接到攻击者指定的 IP 地址和端口以建立反向 shell。 这使攻击者能够远程控制受害者的机器。

**项目地址:** [DeeLMind/CVE-2020-27955-LFS](https://github.com/DeeLMind/CVE-2020-27955-LFS)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #3

**来源**: [CVE-2020-27955-ExploitBox_git-lfs-RCE-exploit-CVE-2020-27955-Go.md](../2020/CVE-2020-27955-ExploitBox_git-lfs-RCE-exploit-CVE-2020-27955-Go.md)

## CVE-2020-27955 Git LFS Remote Code Execution

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.12.0

**利用条件:** 需要目标系统安装Git LFS 2.12.0，并且使用受影响的Git客户端，如GitHub CLI, GitHub Desktop等

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Git LFS 2.12.0中，允许远程代码执行。攻击者可以构造包含恶意Git LFS对象的仓库，当受害者克隆该仓库时，恶意代码会在受害者的机器上执行。

**有效性：** 提供的Go语言POC代码是有效的，它通过将自身（编译后的git.exe）放置在特定位置，并在`git clone`操作期间被调用，从而执行恶意代码。代码中包含反向shell的逻辑，如果连接失败，会执行计算器程序作为测试。

**投毒风险：** 代码本身的主要功能是利用漏洞，从分析来看，该POC代码不包含明显的恶意投毒行为。代码目的明确，虽然会产生恶意行为，但那是漏洞利用的必然结果。因此，投毒风险评估为0%。

**利用方式：**

1.  **准备恶意仓库：** 攻击者创建一个包含恶意Git LFS对象的仓库。
2.  **植入Payload：**  攻击者将编译后的恶意Go代码（伪装成`git.exe`）放入仓库中，或者确保受害者clone仓库时，将该文件下载到特定目录并覆盖原有的`git.exe`。
3.  **诱骗克隆：**  攻击者诱骗受害者克隆这个恶意仓库。
4.  **触发漏洞：**  当受害者执行`git clone`命令时，Git LFS会尝试处理LFS对象，触发漏洞，从而执行攻击者植入的恶意代码。
5.  **执行恶意代码：** 恶意代码执行，通常是反向Shell，允许攻击者远程控制受害者的机器。或者弹出计算器。

**项目地址:** [ExploitBox/git-lfs-RCE-exploit-CVE-2020-27955-Go](https://github.com/ExploitBox/git-lfs-RCE-exploit-CVE-2020-27955-Go)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #4

**来源**: [CVE-2020-27955-ExploitBox_git-lfs-RCE-exploit-CVE-2020-27955.md](../2020/CVE-2020-27955-ExploitBox_git-lfs-RCE-exploit-CVE-2020-27955.md)

## CVE-2020-27955-Git LFS-RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.12.0

**利用条件:** 需要受害者clone包含恶意LFS对象的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Git LFS 2.12.0版本中。攻击者可以通过构造包含恶意`.gitattributes`文件和恶意LFS对象的Git仓库，当受害者clone该仓库时，会导致远程代码执行。

**有效性分析：** 提供的POC代码有效。`git.bat`脚本中，首先创建了一个名为`GITHACKED`的测试文件，证明了代码执行。随后，脚本尝试执行`revsh_powersh.ps1`，这是一个PowerShell反向Shell脚本，攻击者可以通过修改`revsh_powersh.ps1`中的IP地址和端口来接收shell。

**投毒风险分析：** `revsh_powersh.ps1` 脚本存在一定投毒风险，因为它直接执行了远程shell连接。尽管提供了`calc.exe`作为测试，但是作者鼓励使用反向shell。 这种风险占比大约 10%。 如果用户没有意识到，可能会在受害者主机上植入恶意程序。

**利用方式：**
1.  攻击者创建一个包含`.gitattributes`文件的恶意Git仓库，`.gitattributes`文件将特定文件类型与`git lfs`关联。
2.  攻击者创建一个恶意LFS对象，该对象实际上是一个可执行脚本 (例如，`git.bat` 或 `revsh_powersh.ps1`)，当`git lfs`尝试处理该对象时，会执行该脚本。
3.  攻击者将恶意仓库上传到公共或私有Git服务器。
4.  受害者克隆该仓库，如果受害者安装了Git LFS 2.12.0版本，并且系统是Windows，LFS会尝试处理恶意LFS对象，从而触发远程代码执行。
5.  如果`revsh_powersh.ps1`中的反向shell成功执行，攻击者可以获得受害者主机的控制权。

**项目地址:** [ExploitBox/git-lfs-RCE-exploit-CVE-2020-27955](https://github.com/ExploitBox/git-lfs-RCE-exploit-CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #5

**来源**: [CVE-2020-27955-FrostsaberX_CVE-2020-27955.md](../2020/CVE-2020-27955-FrostsaberX_CVE-2020-27955.md)

## CVE-2020-27955 Git LFS Remote Code Execution

**漏洞编号:** CVE-2020-27955

**漏洞类型:** Remote Code Execution

**影响应用:** Git LFS

**危害等级:** 高危，允许远程代码执行

**影响版本:** 2.12.0

**利用条件:** 需要受害者克隆包含恶意Git LFS对象的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-27955 存在于 Git LFS 2.12.0 中，允许远程代码执行。漏洞利用方式是攻击者创建一个包含恶意配置的 Git 仓库，该仓库会在受害者克隆时执行任意代码。 

**有效性：**
提供的 POC 代码 `/tmp/05242692056c38f909a2dee933ea6fc4/1.bat` 内容为 `calc.exe`，这意味着当受害者克隆包含此文件的恶意仓库时，`calc.exe` 将会被执行。因此，如果 Git LFS 存在漏洞并且这个 `.bat` 文件能够被执行，那么 POC 代码是有效的，可以验证 RCE 漏洞。

**投毒风险：**
虽然提供的 POC 仅仅执行 `calc.exe`，但攻击者可以将此替换为更具破坏性的命令。因此，在实际利用中，存在攻击者在公开仓库中放置恶意代码，诱导用户克隆，从而进行投毒攻击的风险。这里`calc.exe`只是验证漏洞的PoC，不能算作投毒代码，但是如果作者在仓库中隐藏了其他后门代码,则存在投毒风险。 这里假设作者有隐藏代码，风险占比10%。

**利用方式：**
1.  攻击者创建一个恶意 Git 仓库，该仓库包含一个恶意的 Git LFS 对象，该对象配置执行恶意命令（例如，`.bat` 文件或其他脚本）。
2.  攻击者将该仓库上传到公共 Git 托管平台，例如 GitHub 或 GitLab。
3.  攻击者诱骗受害者克隆该仓库（例如，通过社交工程）。
4.  当受害者克隆仓库时，Git LFS 会尝试下载和处理恶意 LFS 对象。
5.  由于存在漏洞，恶意 LFS 对象会执行攻击者指定的代码，从而导致远程代码执行。


**项目地址:** [FrostsaberX/CVE-2020-27955](https://github.com/FrostsaberX/CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #6

**来源**: [CVE-2020-27955-HK69s_CVE-2020-27955.md](../2020/CVE-2020-27955-HK69s_CVE-2020-27955.md)

## CVE-2020-27955-Git LFS-RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，允许远程代码执行

**影响版本:** 2.12.0

**利用条件:** 需要受害者克隆恶意git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-27955 允许攻击者通过构造恶意的 Git LFS 对象，当受害者克隆包含这些恶意对象的仓库时，执行任意代码。漏洞存在于 Git LFS 处理特定文件的方式中，攻击者可以通过 `git.bat` 文件进行攻击，该文件可以创建测试文件，或者通过 powershell 脚本`revsh_powersh.ps1`反弹shell。

**有效性：**

提供的PoC代码看起来是有效的，它包含了一个 `git.bat` 文件，该文件在被克隆的机器上执行，并尝试通过 PowerShell 反弹 shell 到攻击者控制的服务器上。PoC 还包含一个 `revsh_powersh.ps1` 文件，用于执行反向 shell。

**投毒风险：**

投毒风险评估为10%。虽然核心的利用代码看起来直接实现了 RCE，但是 `git.bat` 文件中执行 PowerShell 脚本存在一定的风险。攻击者可能会在 `revsh_powersh.ps1` 脚本中添加额外的恶意代码，例如安装后门，窃取凭据等。如果用户不检查 `revsh_powersh.ps1` 脚本的内容直接执行,则可能存在风险。虽然这种风险较低，但不能完全排除。

**利用方式：**

1.  攻击者创建一个包含恶意 Git LFS 对象的 Git 仓库。
2.  恶意对象包含指向 `git.bat` 文件的链接，该文件包含 PowerShell 脚本。
3.  受害者克隆该恶意仓库。
4.  当 Git LFS 尝试处理恶意对象时，会自动执行 `git.bat` 文件。
5.  `git.bat` 文件创建测试文件,并执行 PowerShell 脚本 `revsh_powersh.ps1`，从而反弹 shell 到攻击者控制的服务器上。
6.  攻击者获得受害者机器的远程访问权限。

**项目地址:** [HK69s/CVE-2020-27955](https://github.com/HK69s/CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #7

**来源**: [CVE-2020-27955-IanSmith123_CVE-2020-27955.md](../2020/CVE-2020-27955-IanSmith123_CVE-2020-27955.md)

## CVE-2020-27955 Git LFS RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.12.0

**利用条件:** 需要克隆包含恶意Git LFS对象的仓库

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2020-27955是Git LFS 2.12.0中存在的一个远程代码执行漏洞。攻击者可以通过创建一个包含恶意Git LFS对象的仓库，当受害者克隆该仓库时，即可执行任意代码。提供的POC代码包含两个文件：

*   `/tmp/9561a509eac14276a7801197af1b917b/a.dat`：这是一个包含"pwn"字符串的数据文件，可能作为LFS对象的内容。
*   `/tmp/9561a509eac14276a7801197af1b917b/git.cmd`：这是一个Windows批处理文件，内容为"calc.exe"，这意味着攻击者试图执行计算器程序。

漏洞利用方式是精心构造 `.gitattributes` 文件，通过 `filter=lfs diff=lfs merge=lfs` 指定 LFS filter ，然后定义 `lfs.clean` 和 `lfs.smudge` 命令来执行恶意代码。

有效性：提供的POC代码看起来是有效的，因为它包含一个用于触发漏洞的数据文件和一个用于执行恶意代码的批处理文件。通过修改批处理文件，攻击者可以执行任意代码。

投毒风险：POC代码中存在明显的投毒风险。批处理文件`git.cmd`的内容是`calc.exe`，这仅仅是示例代码。攻击者可以很容易地将此批处理文件替换为更具破坏性的代码，例如删除文件、安装后门等。因此，克隆包含此漏洞的仓库存在极高的投毒风险，我认为投毒风险为80%。需要注意的是，验证POC本身的行为不应视为投毒，此处是指攻击者恶意利用此漏洞的可能性。

利用方式：

1.  攻击者创建一个包含恶意LFS对象的仓库。
2.  攻击者在仓库的.gitattributes文件中定义lfs filter, smudge, clean命令指向恶意脚本
3.  受害者克隆该仓库。
4.  当Git LFS尝试处理恶意LFS对象时，将执行攻击者预设的恶意代码。
5.  受害者机器被攻击者控制。

**项目地址:** [IanSmith123/CVE-2020-27955](https://github.com/IanSmith123/CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #8

**来源**: [CVE-2020-27955-Kimorea_CVE-2020-27955-LFS.md](../2020/CVE-2020-27955-Kimorea_CVE-2020-27955-LFS.md)

## CVE-2020-27955-Git LFS-RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.12.0

**利用条件:** 受害者需要clone包含恶意LFS对象的Git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Git LFS 2.12.0版本中，允许远程代码执行。攻击者可以通过创建一个包含恶意`.gitattributes`文件和精心构造的LFS对象的Git仓库来利用此漏洞。当受害者克隆该仓库时，Git LFS会尝试处理恶意对象，触发`.gitattributes`中定义的命令执行。根据POC代码，利用方式为：

1.  **创建恶意仓库：** 仓库包含 `.gitattributes` 文件，该文件定义了如何处理特定的文件类型。攻击者会在 `.gitattributes` 中插入恶意命令，例如执行脚本或系统命令。
2.  **创建LFS对象：** 创建一个伪装成 LFS 对象的文件。文件的内容可以是任意的，但重要的是与`.gitattributes`中定义的文件类型相匹配，以便触发 LFS 处理流程。
3.  **诱导受害者克隆仓库：** 攻击者将恶意仓库分享给受害者，诱导其克隆。
4.  **触发RCE：** 当受害者克隆仓库时，Git LFS 会根据 `.gitattributes` 文件的配置尝试处理 LFS 对象，从而执行攻击者预设的恶意命令。

漏洞利用代码中，`git.bat` 脚本展示了如何在Windows环境下触发漏洞。它首先创建一个简单的测试文件，然后尝试执行 `powershell -NoProfile -NonInteractive -ExecutionPolicy Bypass .\revsh_powersh.ps1`，这是一个反向shell脚本。 `revsh_powersh.ps1` 尝试连接到 `192.168.254.128:1111`。

**有效性分析：**  根据漏洞描述和提供的POC代码，该漏洞利用方法是有效的。视频PoC也佐证了其有效性。POC代码已经给出了完整的利用链，包括恶意仓库的构建和RCE的触发。

**投毒风险分析：**

虽然提供的POC代码主要展示了如何利用漏洞进行RCE，但仍然存在一定的投毒风险。例如：

*   `revsh_powersh.ps1` 如果被替换成其他恶意脚本，那么接收反向shell的主机可能会受到进一步的攻击。
*   `.gitattributes` 中的命令可以被精心构造，以执行更隐蔽或破坏性更强的操作，例如删除关键文件、篡改系统配置等。

 总体评估，投毒风险较低，大约10%，因为主要的攻击向量是RCE，而POC相对清晰。潜在的投毒风险主要集中在攻击者替换反向shell脚本或修改`.gitattributes`中的命令上。

**项目地址:** [Kimorea/CVE-2020-27955-LFS](https://github.com/Kimorea/CVE-2020-27955-LFS)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #9

**来源**: [CVE-2020-27955-Marsable_CVE-2020-27955-LFS.md](../2020/CVE-2020-27955-Marsable_CVE-2020-27955-LFS.md)

## CVE-2020-27955-Git LFS-RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，允许远程代码执行

**影响版本:** 2.12.0

**利用条件:** 受害者克隆包含恶意Git LFS对象的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-27955 存在于 Git LFS 2.12.0 中，允许远程代码执行 (RCE)。漏洞的利用方式是通过创建一个包含恶意 Git LFS 对象的仓库，当受害者克隆该仓库时，恶意代码会被执行。POC 利用代码表明这个漏洞影响包括 git，GitHub CLI (gh)，GitHub Desktop，Visual Studio Code，SourceTree，SmartGit，GitKraken 等等。由于 Windows 平台的特殊性，漏洞利用的POC通常是批处理或者PowerShell脚本，因此需要仔细审计。

**有效性：**根据漏洞库信息和提供的POC，该漏洞是有效的，并且存在可用的公开POC。

**投毒风险：** POC 代码本身主要是说明文档，其中提到了漏洞发现者和利用方法链接。代码本身并不包含直接的恶意代码，而是依赖于构建恶意的Git仓库触发漏洞，但是存在引导用户去下载恶意代码或者脚本的风险。因此投毒风险较低，约 10%。

**利用方式：**

1.  攻击者创建一个恶意的 Git 仓库，其中包含一个经过特殊构造的 Git LFS 对象。
2.  当受害者克隆该恶意仓库时，Git LFS 会尝试处理该恶意对象。
3.  由于 Git LFS 存在漏洞，处理恶意对象的过程会导致远程代码执行，攻击者可以控制受害者的计算机。

**项目地址:** [Marsable/CVE-2020-27955-LFS](https://github.com/Marsable/CVE-2020-27955-LFS)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #10

**来源**: [CVE-2020-27955-NeoDarwin_CVE-2020-27955.md](../2020/CVE-2020-27955-NeoDarwin_CVE-2020-27955.md)

## CVE-2020-27955 - Git LFS Remote Code Execution

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git LFS

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 2.12.0

**利用条件:** 受害者需要克隆包含恶意 LFS 对象的 Git 仓库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-27955 存在于 Git LFS 2.12.0 版本中，允许远程代码执行。攻击者可以构造一个包含恶意 LFS 对象的 Git 仓库，当受害者克隆该仓库时，恶意代码将被执行。

**有效性:**
从提供的漏洞库信息和漏洞利用代码来看，此漏洞是真实存在的，并且存在公开可用的PoC。给定的PoC代码片段 `/tmp/49c4fbaed875f12fa54ac4584233f202/git.bat`  就是一个简单的批处理脚本，用于在受害者机器上创建 `GITHACKED` 文件，表明代码执行已成功。`big-bug-lfs-file.dat` 代表的是一个恶意的lfs对象。

**投毒风险:**
提供的PoC 代码仅包含一个批处理脚本，用于创建文件，没有发现任何其他的后门或恶意代码。因此，可以认为该仓库中不存在作者隐藏的投毒代码。`poison` 的值为0%。

**利用方式:**
利用方式如下：
1.  攻击者创建一个包含恶意 LFS 对象的 Git 仓库。
2.  恶意 LFS 对象会包含一些元数据，指示 Git LFS 在检出时执行特定的命令。
3.  受害者克隆该仓库。
4.  Git LFS 尝试下载和处理恶意 LFS 对象。
5.  在处理 LFS 对象期间，预先设定的恶意代码被执行，从而导致远程代码执行。

总而言之，此漏洞利用的有效性较高，且 PoC 简单直接，投毒风险较低。受害者需要克隆恶意仓库才会触发漏洞。

**项目地址:** [NeoDarwin/CVE-2020-27955](https://github.com/NeoDarwin/CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #11

**来源**: [CVE-2020-27955-TheTh1nk3r_cve-2020-27955.md](../2020/CVE-2020-27955-TheTh1nk3r_cve-2020-27955.md)

## CVE-2020-27955 - Git LFS Remote Code Execution

**漏洞编号:** CVE-2020-27955

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Git LFS

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.12.0

**利用条件:** 目标机器安装了Git LFS 2.12.0，且攻击者可以push包含恶意配置的仓库到目标机器上或者诱导目标机器clone恶意仓库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Git LFS 2.12.0版本中，攻击者可以通过创建一个包含恶意配置的Git仓库，诱导受害者克隆该仓库，从而在受害者机器上执行任意代码。具体利用方式如下：

1.  **创建恶意仓库:** 攻击者首先创建一个Git仓库，并初始化Git LFS。
2.  **配置`.gitattributes`:**  攻击者需要在`.gitattributes`文件中配置一个或多个文件类型，将其与一个自定义的Git LFS命令关联。这个命令可以是任意可执行文件，例如`git.cmd`。
3.  **创建恶意`git.cmd`:** 攻击者创建一个名为`git.cmd`的文件，该文件包含要执行的恶意代码。示例中，`git.cmd`的内容为`calc.exe`，用于启动计算器程序。
4.  **跟踪大文件:** 使用`git lfs track`命令跟踪一个或多个大文件类型（例如`*.dat`）。
5.  **添加并提交文件:**  将所有文件（包括`.gitattributes`、`git.cmd`、以及被跟踪的大文件）添加到Git仓库并提交。
6.  **推送仓库:** 攻击者将恶意仓库推送到远程服务器。当受害者克隆该仓库时，Git LFS会尝试处理被跟踪的文件，并执行`.gitattributes`中配置的自定义命令，从而触发RCE。

**POC有效性:**  根据提供的POC代码，该漏洞利用方式是有效的。它通过精心构造的`.gitattributes`文件和`git.cmd`文件，实现了在克隆仓库时执行任意代码的目的。

**投毒风险分析:**  提供的POC代码本身是直接的RCE利用，没有发现明显的投毒代码。`large.dat`文件仅包含"test"字符串，`git.cmd`文件仅包含`calc.exe`，这些都不属于投毒行为。因此，仓库中存在隐藏的投毒代码的可能性较低，判定为 0%。

**利用方式总结:** 攻击者通过创建包含恶意`.gitattributes`文件的Git仓库，诱导受害者克隆该仓库。当受害者机器上的Git LFS处理被跟踪的文件时，会执行`.gitattributes`文件中配置的恶意命令，从而导致RCE。

**项目地址:** [TheTh1nk3r/cve-2020-27955](https://github.com/TheTh1nk3r/cve-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #12

**来源**: [CVE-2020-27955-nob0dy-3389_CVE-2020-27955.md](../2020/CVE-2020-27955-nob0dy-3389_CVE-2020-27955.md)

## CVE-2020-27955-Git LFS-RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 2.12.0

**利用条件:** 目标系统安装了Git LFS 2.12.0，并且克隆了包含恶意LFS对象的Git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-27955是一个存在于Git LFS 2.12.0中的远程代码执行漏洞。攻击者可以通过创建一个包含恶意LFS对象的Git仓库，当受害者克隆该仓库时，恶意代码会被执行。\n\n根据提供的漏洞利用代码，`/tmp/b034253cc61d8b86d6971e4703f5432d/git.sh` 文件的内容是 `rmdir /home/an0nymous/Desktop/flag`。这段代码会尝试删除用户 `an0nymous` 桌面上的 `flag` 目录。这表明POC的目的是在受害者机器上执行任意命令。\n\n**有效性：**根据漏洞信息和利用代码，该漏洞是有效的。利用方式是通过恶意构造的git仓库，在受害者克隆仓库时触发RCE。\n\n**投毒风险：**  利用代码 `rmdir /home/an0nymous/Desktop/flag` 本身并没有明显的投毒迹象。  投毒风险较低，约为 10%。潜在的投毒风险可能存在于更复杂的利用场景中，攻击者可能在LFS对象中嵌入更隐蔽的恶意代码，例如下载并执行其他恶意脚本，或者修改系统关键文件等。 因此，虽然目前提供的 POC 代码没有明显的投毒行为，但不能完全排除投毒的可能性。\n\n**利用方式：**\n1.  攻击者创建一个包含恶意LFS对象的Git仓库。这个恶意LFS对象包含能够执行任意命令的payload。\n2.  攻击者将这个恶意仓库托管到一个公开的Git服务器上。\n3.  受害者克隆这个恶意仓库。\n4.  当Git LFS处理恶意LFS对象时，其中的payload会被执行，导致远程代码执行。

**项目地址:** [nob0dy-3389/CVE-2020-27955](https://github.com/nob0dy-3389/CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #13

**来源**: [CVE-2020-27955-r00t4dm_CVE-2020-27955.md](../2020/CVE-2020-27955-r00t4dm_CVE-2020-27955.md)

## CVE-2020-27955 Git LFS RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git LFS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.12.0

**利用条件:** 目标系统安装了存在漏洞的 Git LFS 版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-27955 允许通过克隆包含特制 `.gitattributes` 文件的仓库来执行远程代码。漏洞利用方式如下：

1.  **创建包含恶意 `.gitattributes` 文件的 Git 仓库:**  `.gitattributes` 文件中定义了 Git LFS 如何处理特定类型的文件。恶意文件会配置LFS来调用`git.cmd`文件。
2.  **`git.cmd` 文件:** POC中，`git.cmd` 内容为 `calc.exe`，用于在Windows系统上启动计算器。
3.  **`large.dat` 文件:** 这是一个示例文件，它的存在是为了满足 LFS 的基本要求，内容无关紧要。
4.  **克隆仓库触发漏洞:** 当受害者克隆包含这些恶意文件的仓库时，Git LFS 会尝试处理 `large.dat` 文件，并根据 `.gitattributes` 中的配置执行 `git.cmd`，从而执行 `calc.exe`。

**有效性评估:** 提供的 POC 代码是有效的，如果目标系统存在漏洞，克隆该仓库将导致 `calc.exe` 被执行，证明了远程代码执行。

**投毒风险评估:** 此仓库中没有发现明显的投毒代码。 `git.cmd` 文件的内容很直接，就是执行 `calc.exe`，没有隐藏其他恶意行为。`large.dat` 文件仅包含 “junk”，没有可执行代码。 `.gitattributes` 是漏洞利用的关键，但也只是配置 LFS 执行 `git.cmd` 。 因此，投毒风险评估为 0%。

**利用方式总结:** 攻击者创建一个包含恶意 `.gitattributes` 文件的 Git 仓库，受害者克隆该仓库时，会触发远程代码执行漏洞。

**项目地址:** [r00t4dm/CVE-2020-27955](https://github.com/r00t4dm/CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #14

**来源**: [CVE-2020-27955-the-chivalrousZ_cve-2020-27955.md](../2020/CVE-2020-27955-the-chivalrousZ_cve-2020-27955.md)

## CVE-2020-27955 Git LFS Remote Code Execution

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git LFS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.12.0

**利用条件:** 需要攻击者能够创建包含恶意配置的 Git 仓库，并诱使用户克隆。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-27955 漏洞存在于 Git LFS 2.12.0 版本中，允许远程代码执行。从给定的漏洞库信息可知，该漏洞利用方式是通过精心构造的 Git 仓库，当受害者克隆包含恶意 LFS 对象配置的仓库时，可以执行任意命令。提供的 POC 代码仅包含 LICENSE, README.md 和一个名为 large.dat 的文件, 没有体现出任何可以远程代码执行的利用方式. 因此有效性无法直接通过POC验证。由于POC代码很简单，只包含一些基本的文件，不包含任何可疑的或者混淆的代码，因此投毒风险很低。但是，由于缺乏实际的漏洞利用代码，POC 的有效性和实际利用方式还需进一步分析。

**利用方式推测:**

根据漏洞描述和搜索结果，推测漏洞利用方式可能如下：

1.  攻击者创建一个包含 `.gitattributes` 文件的 Git 仓库。该文件指定了使用 Git LFS 处理特定类型的文件。
2.  攻击者在 `.gitattributes` 文件中配置恶意命令，例如 `*.ext filter=lfs diff=lfs merge=lfs -text`，并创建一个 `lfs.ext.clean` 或 `lfs.ext.smudge` 指向恶意脚本。
3.  当受害者克隆该仓库时，Git LFS 尝试处理指定类型的文件时，将执行攻击者配置的恶意命令，从而导致远程代码执行。

由于未提供利用代码，这些分析是基于漏洞描述和公开资料的推测。

**项目地址:** [the-chivalrousZ/cve-2020-27955](https://github.com/the-chivalrousZ/cve-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #15

**来源**: [CVE-2020-27955-userxfan_cve-2020-27955.md](../2020/CVE-2020-27955-userxfan_cve-2020-27955.md)

## CVE-2020-27955-Git LFS Remote Code Execution

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.12.0

**利用条件:** 目标机器安装了Git LFS 2.12.0，并且clone了包含恶意配置的仓库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-27955 存在于 Git LFS 2.12.0 中，允许远程代码执行。根据漏洞库信息，存在多个关于此漏洞的参考链接，包括exploitbox.io, legalhackers.com 等，这些链接提供了漏洞详情和可能的利用方式。 

**有效性分析：**

提供的POC代码包含三个文件：

*   `README.md`：包含CVE编号信息。
*   `git.cmd`：包含 `calc.exe`，这表明漏洞利用可能涉及执行任意命令。
*   `large.dat`：包含字符串 `test`，这可能是 LFS 对象的内容。

根据已有的漏洞分析报告，利用方式通常是，在`.gitattributes` 文件中设置一个恶意filter，当检出包含 LFS 对象的特定文件时，会触发该filter执行。POC中的 `git.cmd` 脚本 `calc.exe` 符合这个利用模式，表明这个POC很可能有效。

**投毒风险分析：**

分析POC代码内容，此仓库主要包含漏洞验证代码，没有发现隐藏的投毒代码。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者创建一个包含恶意`.gitattributes`文件的Git仓库。`.gitattributes`文件将特定的文件类型或路径与一个恶意的Git filter（例如clean或smudge）关联起来。
2.  该filter配置执行任意命令。例如，可以执行一个shell脚本或任何其他可执行文件。
3.  攻击者将包含恶意`.gitattributes`文件的仓库上传到公共或私有Git服务器。
4.  受害者克隆（clone）或检出（checkout）该仓库。
5.  当Git处理与恶意filter关联的文件时，它会执行`.gitattributes`文件中配置的恶意命令，从而导致远程代码执行。
6.  POC中的 `git.cmd` 脚本是恶意命令，large.dat 是需要处理的 LFS 对象。当用户 clone 包含这些文件的仓库时，就会触发 RCE。


**项目地址:** [userxfan/cve-2020-27955](https://github.com/userxfan/cve-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #16

**来源**: [CVE-2020-27955-whitetea2424_CVE-2020-27955-LFS-main.md](../2020/CVE-2020-27955-whitetea2424_CVE-2020-27955-LFS-main.md)

## CVE-2020-27955 Git LFS RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.12.0

**利用条件:** 受害者需要clone包含恶意lfs对象的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-27955 是 Git LFS 2.12.0 版本中的一个远程代码执行漏洞。根据提供的漏洞利用代码，攻击者可以通过创建一个包含恶意 `.gitattributes` 文件和 LFS 对象的 Git 仓库来触发此漏洞。当受害者克隆（clone）该仓库时，Git LFS 会尝试处理这些 LFS 对象，恶意 `.gitattributes` 文件中可以包含命令，使得执行任意命令。

**有效性：**
提供的POC代码包含一个批处理文件（git.bat）和一个PowerShell脚本(revsh_powersh.ps1), 批处理文件会先创建一个名为GITHACKED的文件, 然后执行powershell脚本，反弹shell。该利用方式是有效的，受害者clone仓库后即可触发。

**投毒风险：**
此仓库中存在潜在的投毒风险。虽然主要目的是演示CVE-2020-27955漏洞，但攻击者可能在提供的反弹shell脚本`revsh_powersh.ps1`中加入其他恶意代码，例如安装后门、窃取信息等。此外，`git.bat` 本身也可以被修改为执行更具破坏性的操作。例如, 修改`git.bat`在反弹shell之前或者之后执行其他的恶意指令。因此，存在一定的投毒可能性，但主要功能还是为了验证漏洞。 风险比例预估为10%。

**利用方式：**
1.  攻击者创建一个包含恶意 `.gitattributes` 文件和 LFS 对象的 Git 仓库。
2.  恶意 `.gitattributes` 文件包含指向恶意 LFS 对象的配置，并嵌入命令执行。
3.  受害者克隆（clone）该恶意仓库。
4.  当 Git LFS 尝试处理恶意 LFS 对象时，会执行 `.gitattributes` 文件中嵌入的命令，导致远程代码执行。
5.  PoC包含反弹shell的powershell脚本，执行后攻击者可以获取shell.

**项目地址:** [whitetea2424/CVE-2020-27955-LFS-main](https://github.com/whitetea2424/CVE-2020-27955-LFS-main)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #17

**来源**: [CVE-2020-27955-yhsung_cve-2020-27955-poc.md](../2020/CVE-2020-27955-yhsung_cve-2020-27955-poc.md)

## CVE-2020-27955-Git LFS-RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** RCE

**影响应用:** Git LFS

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.12.0

**利用条件:** 需要受害者clone包含恶意Git LFS对象的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息，Git LFS 2.12.0存在远程代码执行漏洞（CVE-2020-27955）。漏洞利用代码包含`git.cmd`和`large.dat`两个文件。

*   `git.cmd`包含`calc.exe`，说明这个POC的目的是在目标机器上执行`calc.exe`。
*   `large.dat`文件包含`Junk`，可能是一个占位文件，用于满足Git LFS对大文件的要求。

**利用方式：**攻击者创建一个包含恶意Git LFS对象的Git仓库。当受害者克隆该仓库时，Git LFS会尝试下载并处理这些对象。通过精心构造`.gitattributes`文件和LFS对象的内容，攻击者可以使`git lfs pull`命令执行任意命令。本例中，`git.cmd`会被执行，从而启动计算器程序。

**有效性：**  提供的POC代码看起来是有效的，因为`git.cmd`包含执行计算器的命令。如果能成功触发`git lfs pull`并执行该文件，则可以证明漏洞的存在。

**投毒风险：** 此仓库存在一定的投毒风险，约为10%。虽然主要目的是执行`calc.exe`，但是`git.cmd`文件的内容可以被修改为其他恶意命令。如果攻击者在`git.cmd`中放置更隐蔽的恶意代码，例如下载并执行其他Payload，则可能实现更严重的攻击，且不易被察觉。  `large.dat`文件本身不太可能存在投毒行为，因为它只是一个占位文件。


**项目地址:** [yhsung/cve-2020-27955-poc](https://github.com/yhsung/cve-2020-27955-poc)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #18

**来源**: [CVE-2020-27955-z50913_CVE-2020-27955.md](../2020/CVE-2020-27955-z50913_CVE-2020-27955.md)

# CVE-2020-27955

> 📦 该CVE有 **18** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-27955-Arnoldqqq_CVE-2020-27955.md](../2020/CVE-2020-27955-Arnoldqqq_CVE-2020-27955.md)

## CVE-2020-27955-Git LFS-RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 2.12.0

**利用条件:** 目标系统需要安装Git LFS 2.12.0且克隆了包含恶意LFS对象的仓库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Git LFS 2.12.0中，攻击者可以通过构造包含恶意`.gitattributes`和LFS对象的Git仓库，当目标用户克隆该仓库时，会触发远程代码执行。具体来说，`.gitattributes`文件可以配置LFS处理特定文件类型，攻击者可以利用此特性，将恶意脚本伪装成LFS对象，当Git尝试检出这些文件时，会执行恶意脚本。提供的POC代码包含一个`git.bat`脚本，该脚本创建了一个`GITHACKED`文件，并尝试执行一个PowerShell反向shell脚本`revsh_powersh.ps1`。`revsh_powersh.ps1`尝试连接到`192.168.1.131:1337`。漏洞利用方式是诱导用户克隆包含恶意LFS对象的仓库，从而在用户机器上执行恶意代码。根据提供的代码，没有发现明显的投毒代码。风险主要在于用户克隆了不可信的仓库。

**项目地址:** [Arnoldqqq/CVE-2020-27955](https://github.com/Arnoldqqq/CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #2

**来源**: [CVE-2020-27955-DeeLMind_CVE-2020-27955-LFS.md](../2020/CVE-2020-27955-DeeLMind_CVE-2020-27955-LFS.md)

## CVE-2020-27955-Git LFS-RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，允许攻击者在目标机器上执行任意代码

**影响版本:** 2.12.0

**利用条件:** 需要目标机器安装了受影响版本的Git LFS，并且用户克隆了包含恶意LFS对象的仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-27955 是 Git LFS 2.12.0 中的一个远程代码执行 (RCE) 漏洞。该漏洞的利用方式是，攻击者可以创建一个包含恶意 LFS 对象的 Git 仓库。当受害者克隆该仓库时，Git LFS 会尝试下载这些恶意对象，从而导致在受害者机器上执行任意代码。

**有效性：**
提供的 POC 代码看起来是有效的，因为它包含以下组件：
    * `README.md`: 描述了漏洞和利用方法，并列出了受影响的应用程序。
    * `big-bug-lfs-file.dat`:  一个 LFS 对象示例，用于触发漏洞。
    * `git.bat`: 一个批处理脚本，用于演示如何利用该漏洞。该脚本会创建一个文件`GITHACKED`，并且尝试执行 PowerShell 脚本以建立反向 shell。其中反向shell的目标ip和端口为 deelmind.lab 和 1337
    * `revsh_powersh.ps1`:  一个 PowerShell 脚本，用于建立反向 shell。

**投毒风险：**
投毒风险评估为 10%。 虽然 `revsh_powersh.ps1` 脚本包含硬编码的 IP 地址和端口，但这是反向 shell 的必要组成部分，因此本身不构成投毒行为。  更高级的投毒可能会尝试使用更隐蔽的技术，例如在 LFS 对象中嵌入恶意代码，或者修改现有的脚本以执行其他恶意操作。 但是从提供的POC文件来看,并没有明显的投毒行为。硬编码的反向shell地址和端口相对明显，更容易被发现。

**利用方式：**
利用该漏洞的步骤如下：

1.  攻击者创建一个包含恶意 LFS 对象的 Git 仓库。
2.  攻击者将该仓库上传到公共或私有 Git 仓库托管服务。
3.  受害者克隆该仓库。
4.  当 Git LFS 尝试下载恶意对象时，会执行攻击者预先设定的代码。

在该POC中,攻击者会创建一个名为 `GITHACKED`的文件并在受害者机器上执行 PowerShell 脚本 `revsh_powersh.ps1`，该脚本会尝试连接到攻击者指定的 IP 地址和端口以建立反向 shell。 这使攻击者能够远程控制受害者的机器。

**项目地址:** [DeeLMind/CVE-2020-27955-LFS](https://github.com/DeeLMind/CVE-2020-27955-LFS)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #3

**来源**: [CVE-2020-27955-ExploitBox_git-lfs-RCE-exploit-CVE-2020-27955-Go.md](../2020/CVE-2020-27955-ExploitBox_git-lfs-RCE-exploit-CVE-2020-27955-Go.md)

## CVE-2020-27955 Git LFS Remote Code Execution

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.12.0

**利用条件:** 需要目标系统安装Git LFS 2.12.0，并且使用受影响的Git客户端，如GitHub CLI, GitHub Desktop等

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Git LFS 2.12.0中，允许远程代码执行。攻击者可以构造包含恶意Git LFS对象的仓库，当受害者克隆该仓库时，恶意代码会在受害者的机器上执行。

**有效性：** 提供的Go语言POC代码是有效的，它通过将自身（编译后的git.exe）放置在特定位置，并在`git clone`操作期间被调用，从而执行恶意代码。代码中包含反向shell的逻辑，如果连接失败，会执行计算器程序作为测试。

**投毒风险：** 代码本身的主要功能是利用漏洞，从分析来看，该POC代码不包含明显的恶意投毒行为。代码目的明确，虽然会产生恶意行为，但那是漏洞利用的必然结果。因此，投毒风险评估为0%。

**利用方式：**

1.  **准备恶意仓库：** 攻击者创建一个包含恶意Git LFS对象的仓库。
2.  **植入Payload：**  攻击者将编译后的恶意Go代码（伪装成`git.exe`）放入仓库中，或者确保受害者clone仓库时，将该文件下载到特定目录并覆盖原有的`git.exe`。
3.  **诱骗克隆：**  攻击者诱骗受害者克隆这个恶意仓库。
4.  **触发漏洞：**  当受害者执行`git clone`命令时，Git LFS会尝试处理LFS对象，触发漏洞，从而执行攻击者植入的恶意代码。
5.  **执行恶意代码：** 恶意代码执行，通常是反向Shell，允许攻击者远程控制受害者的机器。或者弹出计算器。

**项目地址:** [ExploitBox/git-lfs-RCE-exploit-CVE-2020-27955-Go](https://github.com/ExploitBox/git-lfs-RCE-exploit-CVE-2020-27955-Go)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #4

**来源**: [CVE-2020-27955-ExploitBox_git-lfs-RCE-exploit-CVE-2020-27955.md](../2020/CVE-2020-27955-ExploitBox_git-lfs-RCE-exploit-CVE-2020-27955.md)

## CVE-2020-27955-Git LFS-RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.12.0

**利用条件:** 需要受害者clone包含恶意LFS对象的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Git LFS 2.12.0版本中。攻击者可以通过构造包含恶意`.gitattributes`文件和恶意LFS对象的Git仓库，当受害者clone该仓库时，会导致远程代码执行。

**有效性分析：** 提供的POC代码有效。`git.bat`脚本中，首先创建了一个名为`GITHACKED`的测试文件，证明了代码执行。随后，脚本尝试执行`revsh_powersh.ps1`，这是一个PowerShell反向Shell脚本，攻击者可以通过修改`revsh_powersh.ps1`中的IP地址和端口来接收shell。

**投毒风险分析：** `revsh_powersh.ps1` 脚本存在一定投毒风险，因为它直接执行了远程shell连接。尽管提供了`calc.exe`作为测试，但是作者鼓励使用反向shell。 这种风险占比大约 10%。 如果用户没有意识到，可能会在受害者主机上植入恶意程序。

**利用方式：**
1.  攻击者创建一个包含`.gitattributes`文件的恶意Git仓库，`.gitattributes`文件将特定文件类型与`git lfs`关联。
2.  攻击者创建一个恶意LFS对象，该对象实际上是一个可执行脚本 (例如，`git.bat` 或 `revsh_powersh.ps1`)，当`git lfs`尝试处理该对象时，会执行该脚本。
3.  攻击者将恶意仓库上传到公共或私有Git服务器。
4.  受害者克隆该仓库，如果受害者安装了Git LFS 2.12.0版本，并且系统是Windows，LFS会尝试处理恶意LFS对象，从而触发远程代码执行。
5.  如果`revsh_powersh.ps1`中的反向shell成功执行，攻击者可以获得受害者主机的控制权。

**项目地址:** [ExploitBox/git-lfs-RCE-exploit-CVE-2020-27955](https://github.com/ExploitBox/git-lfs-RCE-exploit-CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #5

**来源**: [CVE-2020-27955-FrostsaberX_CVE-2020-27955.md](../2020/CVE-2020-27955-FrostsaberX_CVE-2020-27955.md)

## CVE-2020-27955 Git LFS Remote Code Execution

**漏洞编号:** CVE-2020-27955

**漏洞类型:** Remote Code Execution

**影响应用:** Git LFS

**危害等级:** 高危，允许远程代码执行

**影响版本:** 2.12.0

**利用条件:** 需要受害者克隆包含恶意Git LFS对象的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-27955 存在于 Git LFS 2.12.0 中，允许远程代码执行。漏洞利用方式是攻击者创建一个包含恶意配置的 Git 仓库，该仓库会在受害者克隆时执行任意代码。 

**有效性：**
提供的 POC 代码 `/tmp/05242692056c38f909a2dee933ea6fc4/1.bat` 内容为 `calc.exe`，这意味着当受害者克隆包含此文件的恶意仓库时，`calc.exe` 将会被执行。因此，如果 Git LFS 存在漏洞并且这个 `.bat` 文件能够被执行，那么 POC 代码是有效的，可以验证 RCE 漏洞。

**投毒风险：**
虽然提供的 POC 仅仅执行 `calc.exe`，但攻击者可以将此替换为更具破坏性的命令。因此，在实际利用中，存在攻击者在公开仓库中放置恶意代码，诱导用户克隆，从而进行投毒攻击的风险。这里`calc.exe`只是验证漏洞的PoC，不能算作投毒代码，但是如果作者在仓库中隐藏了其他后门代码,则存在投毒风险。 这里假设作者有隐藏代码，风险占比10%。

**利用方式：**
1.  攻击者创建一个恶意 Git 仓库，该仓库包含一个恶意的 Git LFS 对象，该对象配置执行恶意命令（例如，`.bat` 文件或其他脚本）。
2.  攻击者将该仓库上传到公共 Git 托管平台，例如 GitHub 或 GitLab。
3.  攻击者诱骗受害者克隆该仓库（例如，通过社交工程）。
4.  当受害者克隆仓库时，Git LFS 会尝试下载和处理恶意 LFS 对象。
5.  由于存在漏洞，恶意 LFS 对象会执行攻击者指定的代码，从而导致远程代码执行。


**项目地址:** [FrostsaberX/CVE-2020-27955](https://github.com/FrostsaberX/CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #6

**来源**: [CVE-2020-27955-HK69s_CVE-2020-27955.md](../2020/CVE-2020-27955-HK69s_CVE-2020-27955.md)

## CVE-2020-27955-Git LFS-RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，允许远程代码执行

**影响版本:** 2.12.0

**利用条件:** 需要受害者克隆恶意git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-27955 允许攻击者通过构造恶意的 Git LFS 对象，当受害者克隆包含这些恶意对象的仓库时，执行任意代码。漏洞存在于 Git LFS 处理特定文件的方式中，攻击者可以通过 `git.bat` 文件进行攻击，该文件可以创建测试文件，或者通过 powershell 脚本`revsh_powersh.ps1`反弹shell。

**有效性：**

提供的PoC代码看起来是有效的，它包含了一个 `git.bat` 文件，该文件在被克隆的机器上执行，并尝试通过 PowerShell 反弹 shell 到攻击者控制的服务器上。PoC 还包含一个 `revsh_powersh.ps1` 文件，用于执行反向 shell。

**投毒风险：**

投毒风险评估为10%。虽然核心的利用代码看起来直接实现了 RCE，但是 `git.bat` 文件中执行 PowerShell 脚本存在一定的风险。攻击者可能会在 `revsh_powersh.ps1` 脚本中添加额外的恶意代码，例如安装后门，窃取凭据等。如果用户不检查 `revsh_powersh.ps1` 脚本的内容直接执行,则可能存在风险。虽然这种风险较低，但不能完全排除。

**利用方式：**

1.  攻击者创建一个包含恶意 Git LFS 对象的 Git 仓库。
2.  恶意对象包含指向 `git.bat` 文件的链接，该文件包含 PowerShell 脚本。
3.  受害者克隆该恶意仓库。
4.  当 Git LFS 尝试处理恶意对象时，会自动执行 `git.bat` 文件。
5.  `git.bat` 文件创建测试文件,并执行 PowerShell 脚本 `revsh_powersh.ps1`，从而反弹 shell 到攻击者控制的服务器上。
6.  攻击者获得受害者机器的远程访问权限。

**项目地址:** [HK69s/CVE-2020-27955](https://github.com/HK69s/CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #7

**来源**: [CVE-2020-27955-IanSmith123_CVE-2020-27955.md](../2020/CVE-2020-27955-IanSmith123_CVE-2020-27955.md)

## CVE-2020-27955 Git LFS RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.12.0

**利用条件:** 需要克隆包含恶意Git LFS对象的仓库

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2020-27955是Git LFS 2.12.0中存在的一个远程代码执行漏洞。攻击者可以通过创建一个包含恶意Git LFS对象的仓库，当受害者克隆该仓库时，即可执行任意代码。提供的POC代码包含两个文件：

*   `/tmp/9561a509eac14276a7801197af1b917b/a.dat`：这是一个包含"pwn"字符串的数据文件，可能作为LFS对象的内容。
*   `/tmp/9561a509eac14276a7801197af1b917b/git.cmd`：这是一个Windows批处理文件，内容为"calc.exe"，这意味着攻击者试图执行计算器程序。

漏洞利用方式是精心构造 `.gitattributes` 文件，通过 `filter=lfs diff=lfs merge=lfs` 指定 LFS filter ，然后定义 `lfs.clean` 和 `lfs.smudge` 命令来执行恶意代码。

有效性：提供的POC代码看起来是有效的，因为它包含一个用于触发漏洞的数据文件和一个用于执行恶意代码的批处理文件。通过修改批处理文件，攻击者可以执行任意代码。

投毒风险：POC代码中存在明显的投毒风险。批处理文件`git.cmd`的内容是`calc.exe`，这仅仅是示例代码。攻击者可以很容易地将此批处理文件替换为更具破坏性的代码，例如删除文件、安装后门等。因此，克隆包含此漏洞的仓库存在极高的投毒风险，我认为投毒风险为80%。需要注意的是，验证POC本身的行为不应视为投毒，此处是指攻击者恶意利用此漏洞的可能性。

利用方式：

1.  攻击者创建一个包含恶意LFS对象的仓库。
2.  攻击者在仓库的.gitattributes文件中定义lfs filter, smudge, clean命令指向恶意脚本
3.  受害者克隆该仓库。
4.  当Git LFS尝试处理恶意LFS对象时，将执行攻击者预设的恶意代码。
5.  受害者机器被攻击者控制。

**项目地址:** [IanSmith123/CVE-2020-27955](https://github.com/IanSmith123/CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #8

**来源**: [CVE-2020-27955-Kimorea_CVE-2020-27955-LFS.md](../2020/CVE-2020-27955-Kimorea_CVE-2020-27955-LFS.md)

## CVE-2020-27955-Git LFS-RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.12.0

**利用条件:** 受害者需要clone包含恶意LFS对象的Git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Git LFS 2.12.0版本中，允许远程代码执行。攻击者可以通过创建一个包含恶意`.gitattributes`文件和精心构造的LFS对象的Git仓库来利用此漏洞。当受害者克隆该仓库时，Git LFS会尝试处理恶意对象，触发`.gitattributes`中定义的命令执行。根据POC代码，利用方式为：

1.  **创建恶意仓库：** 仓库包含 `.gitattributes` 文件，该文件定义了如何处理特定的文件类型。攻击者会在 `.gitattributes` 中插入恶意命令，例如执行脚本或系统命令。
2.  **创建LFS对象：** 创建一个伪装成 LFS 对象的文件。文件的内容可以是任意的，但重要的是与`.gitattributes`中定义的文件类型相匹配，以便触发 LFS 处理流程。
3.  **诱导受害者克隆仓库：** 攻击者将恶意仓库分享给受害者，诱导其克隆。
4.  **触发RCE：** 当受害者克隆仓库时，Git LFS 会根据 `.gitattributes` 文件的配置尝试处理 LFS 对象，从而执行攻击者预设的恶意命令。

漏洞利用代码中，`git.bat` 脚本展示了如何在Windows环境下触发漏洞。它首先创建一个简单的测试文件，然后尝试执行 `powershell -NoProfile -NonInteractive -ExecutionPolicy Bypass .\revsh_powersh.ps1`，这是一个反向shell脚本。 `revsh_powersh.ps1` 尝试连接到 `192.168.254.128:1111`。

**有效性分析：**  根据漏洞描述和提供的POC代码，该漏洞利用方法是有效的。视频PoC也佐证了其有效性。POC代码已经给出了完整的利用链，包括恶意仓库的构建和RCE的触发。

**投毒风险分析：**

虽然提供的POC代码主要展示了如何利用漏洞进行RCE，但仍然存在一定的投毒风险。例如：

*   `revsh_powersh.ps1` 如果被替换成其他恶意脚本，那么接收反向shell的主机可能会受到进一步的攻击。
*   `.gitattributes` 中的命令可以被精心构造，以执行更隐蔽或破坏性更强的操作，例如删除关键文件、篡改系统配置等。

 总体评估，投毒风险较低，大约10%，因为主要的攻击向量是RCE，而POC相对清晰。潜在的投毒风险主要集中在攻击者替换反向shell脚本或修改`.gitattributes`中的命令上。

**项目地址:** [Kimorea/CVE-2020-27955-LFS](https://github.com/Kimorea/CVE-2020-27955-LFS)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #9

**来源**: [CVE-2020-27955-Marsable_CVE-2020-27955-LFS.md](../2020/CVE-2020-27955-Marsable_CVE-2020-27955-LFS.md)

## CVE-2020-27955-Git LFS-RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，允许远程代码执行

**影响版本:** 2.12.0

**利用条件:** 受害者克隆包含恶意Git LFS对象的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-27955 存在于 Git LFS 2.12.0 中，允许远程代码执行 (RCE)。漏洞的利用方式是通过创建一个包含恶意 Git LFS 对象的仓库，当受害者克隆该仓库时，恶意代码会被执行。POC 利用代码表明这个漏洞影响包括 git，GitHub CLI (gh)，GitHub Desktop，Visual Studio Code，SourceTree，SmartGit，GitKraken 等等。由于 Windows 平台的特殊性，漏洞利用的POC通常是批处理或者PowerShell脚本，因此需要仔细审计。

**有效性：**根据漏洞库信息和提供的POC，该漏洞是有效的，并且存在可用的公开POC。

**投毒风险：** POC 代码本身主要是说明文档，其中提到了漏洞发现者和利用方法链接。代码本身并不包含直接的恶意代码，而是依赖于构建恶意的Git仓库触发漏洞，但是存在引导用户去下载恶意代码或者脚本的风险。因此投毒风险较低，约 10%。

**利用方式：**

1.  攻击者创建一个恶意的 Git 仓库，其中包含一个经过特殊构造的 Git LFS 对象。
2.  当受害者克隆该恶意仓库时，Git LFS 会尝试处理该恶意对象。
3.  由于 Git LFS 存在漏洞，处理恶意对象的过程会导致远程代码执行，攻击者可以控制受害者的计算机。

**项目地址:** [Marsable/CVE-2020-27955-LFS](https://github.com/Marsable/CVE-2020-27955-LFS)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #10

**来源**: [CVE-2020-27955-NeoDarwin_CVE-2020-27955.md](../2020/CVE-2020-27955-NeoDarwin_CVE-2020-27955.md)

## CVE-2020-27955 - Git LFS Remote Code Execution

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git LFS

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 2.12.0

**利用条件:** 受害者需要克隆包含恶意 LFS 对象的 Git 仓库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-27955 存在于 Git LFS 2.12.0 版本中，允许远程代码执行。攻击者可以构造一个包含恶意 LFS 对象的 Git 仓库，当受害者克隆该仓库时，恶意代码将被执行。

**有效性:**
从提供的漏洞库信息和漏洞利用代码来看，此漏洞是真实存在的，并且存在公开可用的PoC。给定的PoC代码片段 `/tmp/49c4fbaed875f12fa54ac4584233f202/git.bat`  就是一个简单的批处理脚本，用于在受害者机器上创建 `GITHACKED` 文件，表明代码执行已成功。`big-bug-lfs-file.dat` 代表的是一个恶意的lfs对象。

**投毒风险:**
提供的PoC 代码仅包含一个批处理脚本，用于创建文件，没有发现任何其他的后门或恶意代码。因此，可以认为该仓库中不存在作者隐藏的投毒代码。`poison` 的值为0%。

**利用方式:**
利用方式如下：
1.  攻击者创建一个包含恶意 LFS 对象的 Git 仓库。
2.  恶意 LFS 对象会包含一些元数据，指示 Git LFS 在检出时执行特定的命令。
3.  受害者克隆该仓库。
4.  Git LFS 尝试下载和处理恶意 LFS 对象。
5.  在处理 LFS 对象期间，预先设定的恶意代码被执行，从而导致远程代码执行。

总而言之，此漏洞利用的有效性较高，且 PoC 简单直接，投毒风险较低。受害者需要克隆恶意仓库才会触发漏洞。

**项目地址:** [NeoDarwin/CVE-2020-27955](https://github.com/NeoDarwin/CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #11

**来源**: [CVE-2020-27955-TheTh1nk3r_cve-2020-27955.md](../2020/CVE-2020-27955-TheTh1nk3r_cve-2020-27955.md)

## CVE-2020-27955 - Git LFS Remote Code Execution

**漏洞编号:** CVE-2020-27955

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Git LFS

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.12.0

**利用条件:** 目标机器安装了Git LFS 2.12.0，且攻击者可以push包含恶意配置的仓库到目标机器上或者诱导目标机器clone恶意仓库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Git LFS 2.12.0版本中，攻击者可以通过创建一个包含恶意配置的Git仓库，诱导受害者克隆该仓库，从而在受害者机器上执行任意代码。具体利用方式如下：

1.  **创建恶意仓库:** 攻击者首先创建一个Git仓库，并初始化Git LFS。
2.  **配置`.gitattributes`:**  攻击者需要在`.gitattributes`文件中配置一个或多个文件类型，将其与一个自定义的Git LFS命令关联。这个命令可以是任意可执行文件，例如`git.cmd`。
3.  **创建恶意`git.cmd`:** 攻击者创建一个名为`git.cmd`的文件，该文件包含要执行的恶意代码。示例中，`git.cmd`的内容为`calc.exe`，用于启动计算器程序。
4.  **跟踪大文件:** 使用`git lfs track`命令跟踪一个或多个大文件类型（例如`*.dat`）。
5.  **添加并提交文件:**  将所有文件（包括`.gitattributes`、`git.cmd`、以及被跟踪的大文件）添加到Git仓库并提交。
6.  **推送仓库:** 攻击者将恶意仓库推送到远程服务器。当受害者克隆该仓库时，Git LFS会尝试处理被跟踪的文件，并执行`.gitattributes`中配置的自定义命令，从而触发RCE。

**POC有效性:**  根据提供的POC代码，该漏洞利用方式是有效的。它通过精心构造的`.gitattributes`文件和`git.cmd`文件，实现了在克隆仓库时执行任意代码的目的。

**投毒风险分析:**  提供的POC代码本身是直接的RCE利用，没有发现明显的投毒代码。`large.dat`文件仅包含"test"字符串，`git.cmd`文件仅包含`calc.exe`，这些都不属于投毒行为。因此，仓库中存在隐藏的投毒代码的可能性较低，判定为 0%。

**利用方式总结:** 攻击者通过创建包含恶意`.gitattributes`文件的Git仓库，诱导受害者克隆该仓库。当受害者机器上的Git LFS处理被跟踪的文件时，会执行`.gitattributes`文件中配置的恶意命令，从而导致RCE。

**项目地址:** [TheTh1nk3r/cve-2020-27955](https://github.com/TheTh1nk3r/cve-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #12

**来源**: [CVE-2020-27955-nob0dy-3389_CVE-2020-27955.md](../2020/CVE-2020-27955-nob0dy-3389_CVE-2020-27955.md)

## CVE-2020-27955-Git LFS-RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 2.12.0

**利用条件:** 目标系统安装了Git LFS 2.12.0，并且克隆了包含恶意LFS对象的Git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-27955是一个存在于Git LFS 2.12.0中的远程代码执行漏洞。攻击者可以通过创建一个包含恶意LFS对象的Git仓库，当受害者克隆该仓库时，恶意代码会被执行。\n\n根据提供的漏洞利用代码，`/tmp/b034253cc61d8b86d6971e4703f5432d/git.sh` 文件的内容是 `rmdir /home/an0nymous/Desktop/flag`。这段代码会尝试删除用户 `an0nymous` 桌面上的 `flag` 目录。这表明POC的目的是在受害者机器上执行任意命令。\n\n**有效性：**根据漏洞信息和利用代码，该漏洞是有效的。利用方式是通过恶意构造的git仓库，在受害者克隆仓库时触发RCE。\n\n**投毒风险：**  利用代码 `rmdir /home/an0nymous/Desktop/flag` 本身并没有明显的投毒迹象。  投毒风险较低，约为 10%。潜在的投毒风险可能存在于更复杂的利用场景中，攻击者可能在LFS对象中嵌入更隐蔽的恶意代码，例如下载并执行其他恶意脚本，或者修改系统关键文件等。 因此，虽然目前提供的 POC 代码没有明显的投毒行为，但不能完全排除投毒的可能性。\n\n**利用方式：**\n1.  攻击者创建一个包含恶意LFS对象的Git仓库。这个恶意LFS对象包含能够执行任意命令的payload。\n2.  攻击者将这个恶意仓库托管到一个公开的Git服务器上。\n3.  受害者克隆这个恶意仓库。\n4.  当Git LFS处理恶意LFS对象时，其中的payload会被执行，导致远程代码执行。

**项目地址:** [nob0dy-3389/CVE-2020-27955](https://github.com/nob0dy-3389/CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #13

**来源**: [CVE-2020-27955-r00t4dm_CVE-2020-27955.md](../2020/CVE-2020-27955-r00t4dm_CVE-2020-27955.md)

## CVE-2020-27955 Git LFS RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git LFS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.12.0

**利用条件:** 目标系统安装了存在漏洞的 Git LFS 版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-27955 允许通过克隆包含特制 `.gitattributes` 文件的仓库来执行远程代码。漏洞利用方式如下：

1.  **创建包含恶意 `.gitattributes` 文件的 Git 仓库:**  `.gitattributes` 文件中定义了 Git LFS 如何处理特定类型的文件。恶意文件会配置LFS来调用`git.cmd`文件。
2.  **`git.cmd` 文件:** POC中，`git.cmd` 内容为 `calc.exe`，用于在Windows系统上启动计算器。
3.  **`large.dat` 文件:** 这是一个示例文件，它的存在是为了满足 LFS 的基本要求，内容无关紧要。
4.  **克隆仓库触发漏洞:** 当受害者克隆包含这些恶意文件的仓库时，Git LFS 会尝试处理 `large.dat` 文件，并根据 `.gitattributes` 中的配置执行 `git.cmd`，从而执行 `calc.exe`。

**有效性评估:** 提供的 POC 代码是有效的，如果目标系统存在漏洞，克隆该仓库将导致 `calc.exe` 被执行，证明了远程代码执行。

**投毒风险评估:** 此仓库中没有发现明显的投毒代码。 `git.cmd` 文件的内容很直接，就是执行 `calc.exe`，没有隐藏其他恶意行为。`large.dat` 文件仅包含 “junk”，没有可执行代码。 `.gitattributes` 是漏洞利用的关键，但也只是配置 LFS 执行 `git.cmd` 。 因此，投毒风险评估为 0%。

**利用方式总结:** 攻击者创建一个包含恶意 `.gitattributes` 文件的 Git 仓库，受害者克隆该仓库时，会触发远程代码执行漏洞。

**项目地址:** [r00t4dm/CVE-2020-27955](https://github.com/r00t4dm/CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #14

**来源**: [CVE-2020-27955-the-chivalrousZ_cve-2020-27955.md](../2020/CVE-2020-27955-the-chivalrousZ_cve-2020-27955.md)

## CVE-2020-27955 Git LFS Remote Code Execution

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git LFS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.12.0

**利用条件:** 需要攻击者能够创建包含恶意配置的 Git 仓库，并诱使用户克隆。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-27955 漏洞存在于 Git LFS 2.12.0 版本中，允许远程代码执行。从给定的漏洞库信息可知，该漏洞利用方式是通过精心构造的 Git 仓库，当受害者克隆包含恶意 LFS 对象配置的仓库时，可以执行任意命令。提供的 POC 代码仅包含 LICENSE, README.md 和一个名为 large.dat 的文件, 没有体现出任何可以远程代码执行的利用方式. 因此有效性无法直接通过POC验证。由于POC代码很简单，只包含一些基本的文件，不包含任何可疑的或者混淆的代码，因此投毒风险很低。但是，由于缺乏实际的漏洞利用代码，POC 的有效性和实际利用方式还需进一步分析。

**利用方式推测:**

根据漏洞描述和搜索结果，推测漏洞利用方式可能如下：

1.  攻击者创建一个包含 `.gitattributes` 文件的 Git 仓库。该文件指定了使用 Git LFS 处理特定类型的文件。
2.  攻击者在 `.gitattributes` 文件中配置恶意命令，例如 `*.ext filter=lfs diff=lfs merge=lfs -text`，并创建一个 `lfs.ext.clean` 或 `lfs.ext.smudge` 指向恶意脚本。
3.  当受害者克隆该仓库时，Git LFS 尝试处理指定类型的文件时，将执行攻击者配置的恶意命令，从而导致远程代码执行。

由于未提供利用代码，这些分析是基于漏洞描述和公开资料的推测。

**项目地址:** [the-chivalrousZ/cve-2020-27955](https://github.com/the-chivalrousZ/cve-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #15

**来源**: [CVE-2020-27955-userxfan_cve-2020-27955.md](../2020/CVE-2020-27955-userxfan_cve-2020-27955.md)

## CVE-2020-27955-Git LFS Remote Code Execution

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.12.0

**利用条件:** 目标机器安装了Git LFS 2.12.0，并且clone了包含恶意配置的仓库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-27955 存在于 Git LFS 2.12.0 中，允许远程代码执行。根据漏洞库信息，存在多个关于此漏洞的参考链接，包括exploitbox.io, legalhackers.com 等，这些链接提供了漏洞详情和可能的利用方式。 

**有效性分析：**

提供的POC代码包含三个文件：

*   `README.md`：包含CVE编号信息。
*   `git.cmd`：包含 `calc.exe`，这表明漏洞利用可能涉及执行任意命令。
*   `large.dat`：包含字符串 `test`，这可能是 LFS 对象的内容。

根据已有的漏洞分析报告，利用方式通常是，在`.gitattributes` 文件中设置一个恶意filter，当检出包含 LFS 对象的特定文件时，会触发该filter执行。POC中的 `git.cmd` 脚本 `calc.exe` 符合这个利用模式，表明这个POC很可能有效。

**投毒风险分析：**

分析POC代码内容，此仓库主要包含漏洞验证代码，没有发现隐藏的投毒代码。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者创建一个包含恶意`.gitattributes`文件的Git仓库。`.gitattributes`文件将特定的文件类型或路径与一个恶意的Git filter（例如clean或smudge）关联起来。
2.  该filter配置执行任意命令。例如，可以执行一个shell脚本或任何其他可执行文件。
3.  攻击者将包含恶意`.gitattributes`文件的仓库上传到公共或私有Git服务器。
4.  受害者克隆（clone）或检出（checkout）该仓库。
5.  当Git处理与恶意filter关联的文件时，它会执行`.gitattributes`文件中配置的恶意命令，从而导致远程代码执行。
6.  POC中的 `git.cmd` 脚本是恶意命令，large.dat 是需要处理的 LFS 对象。当用户 clone 包含这些文件的仓库时，就会触发 RCE。


**项目地址:** [userxfan/cve-2020-27955](https://github.com/userxfan/cve-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #16

**来源**: [CVE-2020-27955-whitetea2424_CVE-2020-27955-LFS-main.md](../2020/CVE-2020-27955-whitetea2424_CVE-2020-27955-LFS-main.md)

## CVE-2020-27955 Git LFS RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.12.0

**利用条件:** 受害者需要clone包含恶意lfs对象的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-27955 是 Git LFS 2.12.0 版本中的一个远程代码执行漏洞。根据提供的漏洞利用代码，攻击者可以通过创建一个包含恶意 `.gitattributes` 文件和 LFS 对象的 Git 仓库来触发此漏洞。当受害者克隆（clone）该仓库时，Git LFS 会尝试处理这些 LFS 对象，恶意 `.gitattributes` 文件中可以包含命令，使得执行任意命令。

**有效性：**
提供的POC代码包含一个批处理文件（git.bat）和一个PowerShell脚本(revsh_powersh.ps1), 批处理文件会先创建一个名为GITHACKED的文件, 然后执行powershell脚本，反弹shell。该利用方式是有效的，受害者clone仓库后即可触发。

**投毒风险：**
此仓库中存在潜在的投毒风险。虽然主要目的是演示CVE-2020-27955漏洞，但攻击者可能在提供的反弹shell脚本`revsh_powersh.ps1`中加入其他恶意代码，例如安装后门、窃取信息等。此外，`git.bat` 本身也可以被修改为执行更具破坏性的操作。例如, 修改`git.bat`在反弹shell之前或者之后执行其他的恶意指令。因此，存在一定的投毒可能性，但主要功能还是为了验证漏洞。 风险比例预估为10%。

**利用方式：**
1.  攻击者创建一个包含恶意 `.gitattributes` 文件和 LFS 对象的 Git 仓库。
2.  恶意 `.gitattributes` 文件包含指向恶意 LFS 对象的配置，并嵌入命令执行。
3.  受害者克隆（clone）该恶意仓库。
4.  当 Git LFS 尝试处理恶意 LFS 对象时，会执行 `.gitattributes` 文件中嵌入的命令，导致远程代码执行。
5.  PoC包含反弹shell的powershell脚本，执行后攻击者可以获取shell.

**项目地址:** [whitetea2424/CVE-2020-27955-LFS-main](https://github.com/whitetea2424/CVE-2020-27955-LFS-main)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #17

**来源**: [CVE-2020-27955-yhsung_cve-2020-27955-poc.md](../2020/CVE-2020-27955-yhsung_cve-2020-27955-poc.md)

## CVE-2020-27955-Git LFS-RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** RCE

**影响应用:** Git LFS

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.12.0

**利用条件:** 需要受害者clone包含恶意Git LFS对象的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息，Git LFS 2.12.0存在远程代码执行漏洞（CVE-2020-27955）。漏洞利用代码包含`git.cmd`和`large.dat`两个文件。

*   `git.cmd`包含`calc.exe`，说明这个POC的目的是在目标机器上执行`calc.exe`。
*   `large.dat`文件包含`Junk`，可能是一个占位文件，用于满足Git LFS对大文件的要求。

**利用方式：**攻击者创建一个包含恶意Git LFS对象的Git仓库。当受害者克隆该仓库时，Git LFS会尝试下载并处理这些对象。通过精心构造`.gitattributes`文件和LFS对象的内容，攻击者可以使`git lfs pull`命令执行任意命令。本例中，`git.cmd`会被执行，从而启动计算器程序。

**有效性：**  提供的POC代码看起来是有效的，因为`git.cmd`包含执行计算器的命令。如果能成功触发`git lfs pull`并执行该文件，则可以证明漏洞的存在。

**投毒风险：** 此仓库存在一定的投毒风险，约为10%。虽然主要目的是执行`calc.exe`，但是`git.cmd`文件的内容可以被修改为其他恶意命令。如果攻击者在`git.cmd`中放置更隐蔽的恶意代码，例如下载并执行其他Payload，则可能实现更严重的攻击，且不易被察觉。  `large.dat`文件本身不太可能存在投毒行为，因为它只是一个占位文件。


**项目地址:** [yhsung/cve-2020-27955-poc](https://github.com/yhsung/cve-2020-27955-poc)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---

## POC #18

**来源**: [CVE-2020-27955-z50913_CVE-2020-27955.md](../2020/CVE-2020-27955-z50913_CVE-2020-27955.md)

## CVE-2020-27955 Git LFS Remote Code Execution

**漏洞编号:** CVE-2020-27955

**漏洞类型:** Remote Code Execution

**影响应用:** Git LFS

**危害等级:** 高危，可完全控制目标系统

**影响版本:** 2.12.0

**利用条件:** 目标系统安装了受影响版本的Git LFS，并且可以克隆恶意仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-27955是Git LFS 2.12.0中存在的远程代码执行漏洞。利用方式是创建一个恶意的git仓库，其中包含一个`.gitattributes`文件，该文件定义了如何处理特定的文件类型。当用户克隆这个仓库时，Git LFS会尝试处理这些文件，从而触发漏洞。攻击者可以在`.gitattributes`文件中插入恶意命令，导致在受害者机器上执行任意代码。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意`.gitattributes`文件的Git仓库。
2.  受害者克隆该仓库。
3.  Git LFS处理`.gitattributes`文件，执行攻击者插入的恶意代码。

**POC代码分析：**

POC提供了一个复现该漏洞的步骤，包括：

1.  下载存在漏洞的Git-LFS版本。
2.  修改hosts文件，将 `abcall.xyz` 指向攻击者控制的IP地址。
3.  攻击者在 `abcall.xyz` 上监听8888端口（使用nc）。
4.  受害者克隆包含恶意配置的git仓库`https://github.com/z50913/CVE-2020-27955.git`
5.  当受害者克隆仓库时，会执行仓库中的恶意`.gitattributes`配置，连接攻击者的nc监听端口，执行PowerShell反向shell脚本 `revsh_powersh.ps1`，从而获得受害者的shell。

**投毒风险分析：**

仓库 `https://github.com/z50913/CVE-2020-27955.git` 本身就包含漏洞利用代码，不能算作投毒。但恶意git仓库本身存在一定投毒风险：

*   **依赖关系风险：** 仓库可能依赖其他子模块或者hooks，包含进一步的恶意代码，下载者可能不了解依赖关系，引入额外的风险。
*   **更新替换：** 作者后续可能更新仓库内容，替换为更具隐蔽性的恶意代码。
*   **域名控制：** 攻击者控制的域名`abcall.xyz`存在被出售或劫持的风险,潜在的攻击者可能利用该域名进行二次恶意活动。

因此，虽然主要目的是演示漏洞，但仍存在一定的投毒风险。 此处投毒风险评估为10%，因为主要代码是漏洞演示，而非故意隐藏的恶意功能。

**项目地址:** [z50913/CVE-2020-27955](https://github.com/z50913/CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)

---



---



---

