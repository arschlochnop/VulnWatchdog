## CVE-2020-0796 - Microsoft Windows operating systems supporting SMBv3 Integer Overflow, Remote Code Execution (RCE), Local Privilege Escalation (LPE), Denial of Service (DoS)

**漏洞编号:** CVE-2020-0796

**漏洞类型:** Integer Overflow, Remote Code Execution (RCE), Local Privilege Escalation (LPE), Denial of Service (DoS)

**影响应用:** Microsoft Windows operating systems supporting SMBv3

**危害等级:** Critical

**CVSS评分:** 

**影响版本:** Windows operating systems supporting SMBv3

**利用条件:** 无需认证，远程网络访问

**POC 可用性:** 8/10

**POC 类型:** 概念验证 (DoS)

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

CVE-2020-0796，又称SMBGhost，是微软SMBv3协议中的一个严重整数溢出漏洞，源于其处理恶意压缩数据包的缺陷。未经身份验证的远程攻击者可利用此漏洞，通过发送特制数据包，在受影响的Windows系统上实现远程代码执行（RCE）、本地权限提升（LPE）或拒绝服务（DoS）。该漏洞因其意外泄露及其高危性质，曾导致微软紧急发布安全公告ADV200005。此漏洞的发现突显了SMBv3协议栈中处理压缩数据的潜在安全风险，攻击者可利用整数溢出实现任意地址读写，进而执行恶意代码或提升权限。

所提供的Python POC (`poc-and-scan.py`) 功能完善，用于检测此漏洞并演示DoS攻击。它无需外部依赖，易于执行，并首先通过SMB协商检测目标系统的SMBv3压缩支持。其内置的安全机制会限制在私有IP范围内使用，防止意外攻击公共网络，体现了开发者的负责任态度。在选择触发崩溃模式时，POC会发送恶意构造的SMB压缩数据包，可靠地导致目标Windows系统蓝屏死机（BSOD），从而有效验证了DoS攻击的有效性。尽管此POC未实现RCE或LPE，但作为DoS的验证工具，其有效性和稳定性极高，充分证明了漏洞的存在和潜在影响。代码结构清晰，易于审计，使其成为评估目标系统SMBv3脆弱性的一个可靠工具。

利用步骤：确保攻击者机器上已安装Python 3环境，并下载POC脚本。
1. 扫描模式（仅检测漏洞，不触发崩溃）：在命令行中执行 `python3 poc-and-scan.py <目标IP地址> N`。脚本将连接到目标并报告是否检测到支持压缩的SMBv3版本。
2. 崩溃模式（触发拒绝服务，导致系统崩溃）：在命令行中执行 `python3 poc-and-scan.py <目标IP地址> Y`。脚本在检测到SMBv3压缩功能后，将发送恶意构造的数据包，导致目标系统立即崩溃并显示蓝屏死机（BSOD），进而验证漏洞。

投毒风险分析：该POC代码的投毒风险评估为极低（0%）。代码使用纯Python标准库（`sys`, `socket`, `struct`），结构透明，无混淆处理，未发现任何外部脚本调用或可疑行为。其内置的IP范围校验机制（仅允许在私有IP范围内运行）进一步证明了开发者的负责任态度，旨在防止POC被滥用或误用。代码中不含任何恶意载荷、命令与控制（C2）通信尝试或后门植入行为。用户可通过审计源代码完全验证其安全性。该POC是安全可靠的漏洞检测和DoS演示工具，其目的完全符合其描述的功能。

**项目地址:** Not available in provided data

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2020-0796
