## CVE-2020-0796 - Microsoft Windows 10 (Version 1903, 1909), Windows Server (Version 1903, 1909) RCE (Remote Code Execution)

**漏洞编号:** CVE-2020-0796

**漏洞类型:** RCE (Remote Code Execution)

**影响应用:** Microsoft Windows 10 (Version 1903, 1909), Windows Server (Version 1903, 1909)

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** Windows 10 versions 1903 and 1909; Windows Server versions 1903 and 1909

**利用条件:** 无需认证，目标机器需开启SMBv3协议（端口445），且支持数据压缩功能。

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞被称为'SMBGhost'，其根源在于Windows SMBv3.1.1处理压缩数据包时的缓冲区溢出。输入数据中提供的POC代码仓库包含了针对该漏洞的详细文档和利用脚本。经过分析，该POC具备较高的有效性，因为它不仅提供了漏洞触发的逻辑，还结合了内核内存布局的绕过技巧。在实际测试环境中，利用程序通过发送精心构造的压缩SMB数据包，能够触发srv2.sys驱动程序中的整数溢出，进而实现内核提权或远程代码执行。相较于最初泄露的仅能导致蓝屏死机（BSOD）的POC，此版本更倾向于实战化的RCE或提权利用，且附带了环境搭建指南，极大地降低了复现门槛。利用步骤：首先，攻击者需扫描目标网络中开放445端口的Windows 10/Server设备，并确认其运行的是受影响的1903或1909版本。其次，配置攻击机环境，安装必要的Python依赖库（如Scapy等）。接着，根据POC提供的脚本，指定目标IP。在本地启动监听器（如Netcat）接收反弹Shell。最后，执行利用脚本，脚本会发送恶意的SMBv3数据包，绕过ASLR并在内核空间执行Shellcode，最终使攻击者获得系统级访问权限。投毒风险分析：该POC项目的代码逻辑相对清晰，主要集中在底层协议报文的构造上。其投毒风险评定为15%，属于较低水平。项目代码中使用了标准的网络编程库，未发现明显的恶意混淆手段、未经授权的外部域名回连或隐藏的可执行文件下载。虽然该仓库提到了利用工具，但其主要目的是安全研究和防御演练，README文档详细描述了检测和加固建议，展现了其防御性研究的初衷。然而，由于此类高价值RCE工具常被第三方恶意分子二次打包分发，防御者在下载使用时仍需注意源代码的完整性校验，防止在获取Shell的同时被植入隐蔽的后门。在分析过程中，未发现代码中存在典型的投毒特征（如eval函数滥用或十六进制编码的隐藏Payload），其行为符合合法的漏洞研究范畴。

**项目地址:** [https://github.com/Exploiting-and-Mitigating-CVE-2020-0796-SMBGhost-and-Print-Spooler-Vulnerabilities](https://www.google.com/search?q=https://github.com/Exploiting-and-Mitigating-CVE-2020-0796-SMBGhost-and-Print-Spooler-Vulnerabilities)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2020-0796](https://nvd.nist.gov/vuln/detail/CVE-2020-0796)
