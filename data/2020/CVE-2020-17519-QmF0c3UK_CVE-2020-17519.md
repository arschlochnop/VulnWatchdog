# CVE-2020-17519

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-17519-B1anda0_CVE-2020-17519.md](../2020/CVE-2020-17519-B1anda0_CVE-2020-17519.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager进程的REST接口对外开放，且目标Flink版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache Flink 1.11.0到1.11.2版本中，允许未经身份验证的攻击者通过JobManager的REST接口读取JobManager进程可访问的本地文件系统上的任何文件。攻击者可以通过构造包含目录遍历序列（如`..%252f`）的恶意URL来访问系统文件。提供的POC代码通过发送包含特定payload的GET请求到`/jobmanager/logs`端点，尝试读取`/etc/passwd`文件来验证漏洞的存在。

**有效性：**
根据漏洞描述和POC代码，该POC能够有效验证漏洞的存在。POC通过构造包含URL编码的目录遍历字符的payload，尝试读取`/etc/passwd`文件。如果服务器返回200状态码并且响应内容包含`root:x`，则确认漏洞存在。

**投毒风险：**
该POC代码主要功能是发送HTTP请求并检查响应，以验证漏洞是否存在。代码包含以下操作：
1.  导入必要的库（requests, sys, colorama）。
2.  定义banner信息。
3.  定义verify函数，用于发送HTTP请求并检查响应。
4.  在主函数中，读取包含URL的文本文件，并对每个URL执行verify函数。
5.  如果检测到漏洞，则将URL写入vul.txt文件。

没有发现任何可疑的或恶意的代码，例如执行系统命令、修改文件或上传恶意文件等。因此，可以认为此仓库不存在作者隐藏的投毒代码，投毒风险为0%。

**利用方式：**
1.  确定目标Flink实例的版本是否在受影响的范围内（1.11.0到1.11.2）。
2.  通过网络访问JobManager进程的REST接口。
3.  构造包含目录遍历序列的URL，指向要读取的文件。例如：
    ```
    /jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd
    ```
    其中`..%252f`是`../`的URL编码形式，用于进行目录遍历。
4.  发送GET请求到构造的URL。
5.  如果服务器返回文件内容，则表示漏洞利用成功。攻击者可以读取JobManager进程有权访问的任何文件，包括配置文件、日志文件等。
6.  利用获取的敏感信息，可以进一步攻击系统。

**项目地址:** [B1anda0/CVE-2020-17519](https://github.com/B1anda0/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #2

**来源**: [CVE-2020-17519-GazettEl_CVE-2020-17519.md](../2020/CVE-2020-17519-GazettEl_CVE-2020-17519.md)

## CVE-2020-17519-Apache Flink目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要Flink JobManager的REST接口对外暴露

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 的 REST 接口利用目录遍历漏洞读取 JobManager 进程本地文件系统上的任何文件。漏洞利用方式为构造包含目录遍历字符的URL，发送GET请求至JobManager的logs接口。漏洞利用代码通过指定目标URL、遍历深度以及目标文件路径或包含多个文件路径的文件，可以并发地发送恶意请求，探测并下载服务器上的文件内容。根据漏洞信息，只有JobManager进程有权限访问的文件才可被读取。利用代码中存在保存下载文件的功能。鉴于POC代码的功能主要是读取文件，保存到本地，且代码量不大，人工 review 之后发现仅仅存在一处输出文件夹名称写死的低级错误，所以代码中存在投毒的可能性较低，给出了1%的概率。

**项目地址:** [GazettEl/CVE-2020-17519](https://github.com/GazettEl/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #3

**来源**: [CVE-2020-17519-Osyanina_westone-CVE-2020-17519-scanner.md](../2020/CVE-2020-17519-Osyanina_westone-CVE-2020-17519-scanner.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可读取 JobManager 进程可访问的任意文件

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager 进程的 REST 接口暴露

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可访问的本地文件系统上的任意文件。漏洞利用方式是通过构造包含目录遍历字符（如 `../`）的 HTTP 请求，访问 REST 接口。根据提供的漏洞利用代码，该利用代码是一个简单的扫描器，用于检测目标是否存在此漏洞，看起来风险较低，但考虑到可执行文件(`CVE-2020-17519.exe`)的存在，无法完全排除作者在其中隐藏恶意代码的可能性，因此有一定的投毒风险, 估计为10%。考虑到CISA已将此漏洞加入已知被利用的漏洞目录，该漏洞的威胁程度较高。

**项目地址:** [Osyanina/westone-CVE-2020-17519-scanner](https://github.com/Osyanina/westone-CVE-2020-17519-scanner)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #4

**来源**: [CVE-2020-17519-QmF0c3UK_CVE-2020-17519.md](../2020/CVE-2020-17519-QmF0c3UK_CVE-2020-17519.md)

# CVE-2020-17519

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-17519-B1anda0_CVE-2020-17519.md](../2020/CVE-2020-17519-B1anda0_CVE-2020-17519.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager进程的REST接口对外开放，且目标Flink版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache Flink 1.11.0到1.11.2版本中，允许未经身份验证的攻击者通过JobManager的REST接口读取JobManager进程可访问的本地文件系统上的任何文件。攻击者可以通过构造包含目录遍历序列（如`..%252f`）的恶意URL来访问系统文件。提供的POC代码通过发送包含特定payload的GET请求到`/jobmanager/logs`端点，尝试读取`/etc/passwd`文件来验证漏洞的存在。

**有效性：**
根据漏洞描述和POC代码，该POC能够有效验证漏洞的存在。POC通过构造包含URL编码的目录遍历字符的payload，尝试读取`/etc/passwd`文件。如果服务器返回200状态码并且响应内容包含`root:x`，则确认漏洞存在。

**投毒风险：**
该POC代码主要功能是发送HTTP请求并检查响应，以验证漏洞是否存在。代码包含以下操作：
1.  导入必要的库（requests, sys, colorama）。
2.  定义banner信息。
3.  定义verify函数，用于发送HTTP请求并检查响应。
4.  在主函数中，读取包含URL的文本文件，并对每个URL执行verify函数。
5.  如果检测到漏洞，则将URL写入vul.txt文件。

没有发现任何可疑的或恶意的代码，例如执行系统命令、修改文件或上传恶意文件等。因此，可以认为此仓库不存在作者隐藏的投毒代码，投毒风险为0%。

**利用方式：**
1.  确定目标Flink实例的版本是否在受影响的范围内（1.11.0到1.11.2）。
2.  通过网络访问JobManager进程的REST接口。
3.  构造包含目录遍历序列的URL，指向要读取的文件。例如：
    ```
    /jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd
    ```
    其中`..%252f`是`../`的URL编码形式，用于进行目录遍历。
4.  发送GET请求到构造的URL。
5.  如果服务器返回文件内容，则表示漏洞利用成功。攻击者可以读取JobManager进程有权访问的任何文件，包括配置文件、日志文件等。
6.  利用获取的敏感信息，可以进一步攻击系统。

**项目地址:** [B1anda0/CVE-2020-17519](https://github.com/B1anda0/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #2

**来源**: [CVE-2020-17519-GazettEl_CVE-2020-17519.md](../2020/CVE-2020-17519-GazettEl_CVE-2020-17519.md)

## CVE-2020-17519-Apache Flink目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要Flink JobManager的REST接口对外暴露

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 的 REST 接口利用目录遍历漏洞读取 JobManager 进程本地文件系统上的任何文件。漏洞利用方式为构造包含目录遍历字符的URL，发送GET请求至JobManager的logs接口。漏洞利用代码通过指定目标URL、遍历深度以及目标文件路径或包含多个文件路径的文件，可以并发地发送恶意请求，探测并下载服务器上的文件内容。根据漏洞信息，只有JobManager进程有权限访问的文件才可被读取。利用代码中存在保存下载文件的功能。鉴于POC代码的功能主要是读取文件，保存到本地，且代码量不大，人工 review 之后发现仅仅存在一处输出文件夹名称写死的低级错误，所以代码中存在投毒的可能性较低，给出了1%的概率。

**项目地址:** [GazettEl/CVE-2020-17519](https://github.com/GazettEl/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #3

**来源**: [CVE-2020-17519-Osyanina_westone-CVE-2020-17519-scanner.md](../2020/CVE-2020-17519-Osyanina_westone-CVE-2020-17519-scanner.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可读取 JobManager 进程可访问的任意文件

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager 进程的 REST 接口暴露

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可访问的本地文件系统上的任意文件。漏洞利用方式是通过构造包含目录遍历字符（如 `../`）的 HTTP 请求，访问 REST 接口。根据提供的漏洞利用代码，该利用代码是一个简单的扫描器，用于检测目标是否存在此漏洞，看起来风险较低，但考虑到可执行文件(`CVE-2020-17519.exe`)的存在，无法完全排除作者在其中隐藏恶意代码的可能性，因此有一定的投毒风险, 估计为10%。考虑到CISA已将此漏洞加入已知被利用的漏洞目录，该漏洞的威胁程度较高。

**项目地址:** [Osyanina/westone-CVE-2020-17519-scanner](https://github.com/Osyanina/westone-CVE-2020-17519-scanner)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #4

**来源**: [CVE-2020-17519-QmF0c3UK_CVE-2020-17519.md](../2020/CVE-2020-17519-QmF0c3UK_CVE-2020-17519.md)

# CVE-2020-17519

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-17519-B1anda0_CVE-2020-17519.md](../2020/CVE-2020-17519-B1anda0_CVE-2020-17519.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager进程的REST接口对外开放，且目标Flink版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache Flink 1.11.0到1.11.2版本中，允许未经身份验证的攻击者通过JobManager的REST接口读取JobManager进程可访问的本地文件系统上的任何文件。攻击者可以通过构造包含目录遍历序列（如`..%252f`）的恶意URL来访问系统文件。提供的POC代码通过发送包含特定payload的GET请求到`/jobmanager/logs`端点，尝试读取`/etc/passwd`文件来验证漏洞的存在。

**有效性：**
根据漏洞描述和POC代码，该POC能够有效验证漏洞的存在。POC通过构造包含URL编码的目录遍历字符的payload，尝试读取`/etc/passwd`文件。如果服务器返回200状态码并且响应内容包含`root:x`，则确认漏洞存在。

**投毒风险：**
该POC代码主要功能是发送HTTP请求并检查响应，以验证漏洞是否存在。代码包含以下操作：
1.  导入必要的库（requests, sys, colorama）。
2.  定义banner信息。
3.  定义verify函数，用于发送HTTP请求并检查响应。
4.  在主函数中，读取包含URL的文本文件，并对每个URL执行verify函数。
5.  如果检测到漏洞，则将URL写入vul.txt文件。

没有发现任何可疑的或恶意的代码，例如执行系统命令、修改文件或上传恶意文件等。因此，可以认为此仓库不存在作者隐藏的投毒代码，投毒风险为0%。

**利用方式：**
1.  确定目标Flink实例的版本是否在受影响的范围内（1.11.0到1.11.2）。
2.  通过网络访问JobManager进程的REST接口。
3.  构造包含目录遍历序列的URL，指向要读取的文件。例如：
    ```
    /jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd
    ```
    其中`..%252f`是`../`的URL编码形式，用于进行目录遍历。
4.  发送GET请求到构造的URL。
5.  如果服务器返回文件内容，则表示漏洞利用成功。攻击者可以读取JobManager进程有权访问的任何文件，包括配置文件、日志文件等。
6.  利用获取的敏感信息，可以进一步攻击系统。

**项目地址:** [B1anda0/CVE-2020-17519](https://github.com/B1anda0/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #2

**来源**: [CVE-2020-17519-GazettEl_CVE-2020-17519.md](../2020/CVE-2020-17519-GazettEl_CVE-2020-17519.md)

## CVE-2020-17519-Apache Flink目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要Flink JobManager的REST接口对外暴露

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 的 REST 接口利用目录遍历漏洞读取 JobManager 进程本地文件系统上的任何文件。漏洞利用方式为构造包含目录遍历字符的URL，发送GET请求至JobManager的logs接口。漏洞利用代码通过指定目标URL、遍历深度以及目标文件路径或包含多个文件路径的文件，可以并发地发送恶意请求，探测并下载服务器上的文件内容。根据漏洞信息，只有JobManager进程有权限访问的文件才可被读取。利用代码中存在保存下载文件的功能。鉴于POC代码的功能主要是读取文件，保存到本地，且代码量不大，人工 review 之后发现仅仅存在一处输出文件夹名称写死的低级错误，所以代码中存在投毒的可能性较低，给出了1%的概率。

**项目地址:** [GazettEl/CVE-2020-17519](https://github.com/GazettEl/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #3

**来源**: [CVE-2020-17519-Osyanina_westone-CVE-2020-17519-scanner.md](../2020/CVE-2020-17519-Osyanina_westone-CVE-2020-17519-scanner.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可读取 JobManager 进程可访问的任意文件

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager 进程的 REST 接口暴露

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可访问的本地文件系统上的任意文件。漏洞利用方式是通过构造包含目录遍历字符（如 `../`）的 HTTP 请求，访问 REST 接口。根据提供的漏洞利用代码，该利用代码是一个简单的扫描器，用于检测目标是否存在此漏洞，看起来风险较低，但考虑到可执行文件(`CVE-2020-17519.exe`)的存在，无法完全排除作者在其中隐藏恶意代码的可能性，因此有一定的投毒风险, 估计为10%。考虑到CISA已将此漏洞加入已知被利用的漏洞目录，该漏洞的威胁程度较高。

**项目地址:** [Osyanina/westone-CVE-2020-17519-scanner](https://github.com/Osyanina/westone-CVE-2020-17519-scanner)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #4

**来源**: [CVE-2020-17519-QmF0c3UK_CVE-2020-17519.md](../2020/CVE-2020-17519-QmF0c3UK_CVE-2020-17519.md)

# CVE-2020-17519

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-17519-B1anda0_CVE-2020-17519.md](../2020/CVE-2020-17519-B1anda0_CVE-2020-17519.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager进程的REST接口对外开放，且目标Flink版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache Flink 1.11.0到1.11.2版本中，允许未经身份验证的攻击者通过JobManager的REST接口读取JobManager进程可访问的本地文件系统上的任何文件。攻击者可以通过构造包含目录遍历序列（如`..%252f`）的恶意URL来访问系统文件。提供的POC代码通过发送包含特定payload的GET请求到`/jobmanager/logs`端点，尝试读取`/etc/passwd`文件来验证漏洞的存在。

**有效性：**
根据漏洞描述和POC代码，该POC能够有效验证漏洞的存在。POC通过构造包含URL编码的目录遍历字符的payload，尝试读取`/etc/passwd`文件。如果服务器返回200状态码并且响应内容包含`root:x`，则确认漏洞存在。

**投毒风险：**
该POC代码主要功能是发送HTTP请求并检查响应，以验证漏洞是否存在。代码包含以下操作：
1.  导入必要的库（requests, sys, colorama）。
2.  定义banner信息。
3.  定义verify函数，用于发送HTTP请求并检查响应。
4.  在主函数中，读取包含URL的文本文件，并对每个URL执行verify函数。
5.  如果检测到漏洞，则将URL写入vul.txt文件。

没有发现任何可疑的或恶意的代码，例如执行系统命令、修改文件或上传恶意文件等。因此，可以认为此仓库不存在作者隐藏的投毒代码，投毒风险为0%。

**利用方式：**
1.  确定目标Flink实例的版本是否在受影响的范围内（1.11.0到1.11.2）。
2.  通过网络访问JobManager进程的REST接口。
3.  构造包含目录遍历序列的URL，指向要读取的文件。例如：
    ```
    /jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd
    ```
    其中`..%252f`是`../`的URL编码形式，用于进行目录遍历。
4.  发送GET请求到构造的URL。
5.  如果服务器返回文件内容，则表示漏洞利用成功。攻击者可以读取JobManager进程有权访问的任何文件，包括配置文件、日志文件等。
6.  利用获取的敏感信息，可以进一步攻击系统。

**项目地址:** [B1anda0/CVE-2020-17519](https://github.com/B1anda0/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #2

**来源**: [CVE-2020-17519-GazettEl_CVE-2020-17519.md](../2020/CVE-2020-17519-GazettEl_CVE-2020-17519.md)

## CVE-2020-17519-Apache Flink目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要Flink JobManager的REST接口对外暴露

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 的 REST 接口利用目录遍历漏洞读取 JobManager 进程本地文件系统上的任何文件。漏洞利用方式为构造包含目录遍历字符的URL，发送GET请求至JobManager的logs接口。漏洞利用代码通过指定目标URL、遍历深度以及目标文件路径或包含多个文件路径的文件，可以并发地发送恶意请求，探测并下载服务器上的文件内容。根据漏洞信息，只有JobManager进程有权限访问的文件才可被读取。利用代码中存在保存下载文件的功能。鉴于POC代码的功能主要是读取文件，保存到本地，且代码量不大，人工 review 之后发现仅仅存在一处输出文件夹名称写死的低级错误，所以代码中存在投毒的可能性较低，给出了1%的概率。

**项目地址:** [GazettEl/CVE-2020-17519](https://github.com/GazettEl/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #3

**来源**: [CVE-2020-17519-Osyanina_westone-CVE-2020-17519-scanner.md](../2020/CVE-2020-17519-Osyanina_westone-CVE-2020-17519-scanner.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可读取 JobManager 进程可访问的任意文件

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager 进程的 REST 接口暴露

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可访问的本地文件系统上的任意文件。漏洞利用方式是通过构造包含目录遍历字符（如 `../`）的 HTTP 请求，访问 REST 接口。根据提供的漏洞利用代码，该利用代码是一个简单的扫描器，用于检测目标是否存在此漏洞，看起来风险较低，但考虑到可执行文件(`CVE-2020-17519.exe`)的存在，无法完全排除作者在其中隐藏恶意代码的可能性，因此有一定的投毒风险, 估计为10%。考虑到CISA已将此漏洞加入已知被利用的漏洞目录，该漏洞的威胁程度较高。

**项目地址:** [Osyanina/westone-CVE-2020-17519-scanner](https://github.com/Osyanina/westone-CVE-2020-17519-scanner)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #4

**来源**: [CVE-2020-17519-QmF0c3UK_CVE-2020-17519.md](../2020/CVE-2020-17519-QmF0c3UK_CVE-2020-17519.md)

# CVE-2020-17519

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-17519-B1anda0_CVE-2020-17519.md](../2020/CVE-2020-17519-B1anda0_CVE-2020-17519.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager进程的REST接口对外开放，且目标Flink版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache Flink 1.11.0到1.11.2版本中，允许未经身份验证的攻击者通过JobManager的REST接口读取JobManager进程可访问的本地文件系统上的任何文件。攻击者可以通过构造包含目录遍历序列（如`..%252f`）的恶意URL来访问系统文件。提供的POC代码通过发送包含特定payload的GET请求到`/jobmanager/logs`端点，尝试读取`/etc/passwd`文件来验证漏洞的存在。

**有效性：**
根据漏洞描述和POC代码，该POC能够有效验证漏洞的存在。POC通过构造包含URL编码的目录遍历字符的payload，尝试读取`/etc/passwd`文件。如果服务器返回200状态码并且响应内容包含`root:x`，则确认漏洞存在。

**投毒风险：**
该POC代码主要功能是发送HTTP请求并检查响应，以验证漏洞是否存在。代码包含以下操作：
1.  导入必要的库（requests, sys, colorama）。
2.  定义banner信息。
3.  定义verify函数，用于发送HTTP请求并检查响应。
4.  在主函数中，读取包含URL的文本文件，并对每个URL执行verify函数。
5.  如果检测到漏洞，则将URL写入vul.txt文件。

没有发现任何可疑的或恶意的代码，例如执行系统命令、修改文件或上传恶意文件等。因此，可以认为此仓库不存在作者隐藏的投毒代码，投毒风险为0%。

**利用方式：**
1.  确定目标Flink实例的版本是否在受影响的范围内（1.11.0到1.11.2）。
2.  通过网络访问JobManager进程的REST接口。
3.  构造包含目录遍历序列的URL，指向要读取的文件。例如：
    ```
    /jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd
    ```
    其中`..%252f`是`../`的URL编码形式，用于进行目录遍历。
4.  发送GET请求到构造的URL。
5.  如果服务器返回文件内容，则表示漏洞利用成功。攻击者可以读取JobManager进程有权访问的任何文件，包括配置文件、日志文件等。
6.  利用获取的敏感信息，可以进一步攻击系统。

**项目地址:** [B1anda0/CVE-2020-17519](https://github.com/B1anda0/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #2

**来源**: [CVE-2020-17519-GazettEl_CVE-2020-17519.md](../2020/CVE-2020-17519-GazettEl_CVE-2020-17519.md)

## CVE-2020-17519-Apache Flink目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要Flink JobManager的REST接口对外暴露

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 的 REST 接口利用目录遍历漏洞读取 JobManager 进程本地文件系统上的任何文件。漏洞利用方式为构造包含目录遍历字符的URL，发送GET请求至JobManager的logs接口。漏洞利用代码通过指定目标URL、遍历深度以及目标文件路径或包含多个文件路径的文件，可以并发地发送恶意请求，探测并下载服务器上的文件内容。根据漏洞信息，只有JobManager进程有权限访问的文件才可被读取。利用代码中存在保存下载文件的功能。鉴于POC代码的功能主要是读取文件，保存到本地，且代码量不大，人工 review 之后发现仅仅存在一处输出文件夹名称写死的低级错误，所以代码中存在投毒的可能性较低，给出了1%的概率。

**项目地址:** [GazettEl/CVE-2020-17519](https://github.com/GazettEl/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #3

**来源**: [CVE-2020-17519-Osyanina_westone-CVE-2020-17519-scanner.md](../2020/CVE-2020-17519-Osyanina_westone-CVE-2020-17519-scanner.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可读取 JobManager 进程可访问的任意文件

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager 进程的 REST 接口暴露

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可访问的本地文件系统上的任意文件。漏洞利用方式是通过构造包含目录遍历字符（如 `../`）的 HTTP 请求，访问 REST 接口。根据提供的漏洞利用代码，该利用代码是一个简单的扫描器，用于检测目标是否存在此漏洞，看起来风险较低，但考虑到可执行文件(`CVE-2020-17519.exe`)的存在，无法完全排除作者在其中隐藏恶意代码的可能性，因此有一定的投毒风险, 估计为10%。考虑到CISA已将此漏洞加入已知被利用的漏洞目录，该漏洞的威胁程度较高。

**项目地址:** [Osyanina/westone-CVE-2020-17519-scanner](https://github.com/Osyanina/westone-CVE-2020-17519-scanner)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #4

**来源**: [CVE-2020-17519-QmF0c3UK_CVE-2020-17519.md](../2020/CVE-2020-17519-QmF0c3UK_CVE-2020-17519.md)

# CVE-2020-17519

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-17519-B1anda0_CVE-2020-17519.md](../2020/CVE-2020-17519-B1anda0_CVE-2020-17519.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager进程的REST接口对外开放，且目标Flink版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache Flink 1.11.0到1.11.2版本中，允许未经身份验证的攻击者通过JobManager的REST接口读取JobManager进程可访问的本地文件系统上的任何文件。攻击者可以通过构造包含目录遍历序列（如`..%252f`）的恶意URL来访问系统文件。提供的POC代码通过发送包含特定payload的GET请求到`/jobmanager/logs`端点，尝试读取`/etc/passwd`文件来验证漏洞的存在。

**有效性：**
根据漏洞描述和POC代码，该POC能够有效验证漏洞的存在。POC通过构造包含URL编码的目录遍历字符的payload，尝试读取`/etc/passwd`文件。如果服务器返回200状态码并且响应内容包含`root:x`，则确认漏洞存在。

**投毒风险：**
该POC代码主要功能是发送HTTP请求并检查响应，以验证漏洞是否存在。代码包含以下操作：
1.  导入必要的库（requests, sys, colorama）。
2.  定义banner信息。
3.  定义verify函数，用于发送HTTP请求并检查响应。
4.  在主函数中，读取包含URL的文本文件，并对每个URL执行verify函数。
5.  如果检测到漏洞，则将URL写入vul.txt文件。

没有发现任何可疑的或恶意的代码，例如执行系统命令、修改文件或上传恶意文件等。因此，可以认为此仓库不存在作者隐藏的投毒代码，投毒风险为0%。

**利用方式：**
1.  确定目标Flink实例的版本是否在受影响的范围内（1.11.0到1.11.2）。
2.  通过网络访问JobManager进程的REST接口。
3.  构造包含目录遍历序列的URL，指向要读取的文件。例如：
    ```
    /jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd
    ```
    其中`..%252f`是`../`的URL编码形式，用于进行目录遍历。
4.  发送GET请求到构造的URL。
5.  如果服务器返回文件内容，则表示漏洞利用成功。攻击者可以读取JobManager进程有权访问的任何文件，包括配置文件、日志文件等。
6.  利用获取的敏感信息，可以进一步攻击系统。

**项目地址:** [B1anda0/CVE-2020-17519](https://github.com/B1anda0/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #2

**来源**: [CVE-2020-17519-GazettEl_CVE-2020-17519.md](../2020/CVE-2020-17519-GazettEl_CVE-2020-17519.md)

## CVE-2020-17519-Apache Flink目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要Flink JobManager的REST接口对外暴露

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 的 REST 接口利用目录遍历漏洞读取 JobManager 进程本地文件系统上的任何文件。漏洞利用方式为构造包含目录遍历字符的URL，发送GET请求至JobManager的logs接口。漏洞利用代码通过指定目标URL、遍历深度以及目标文件路径或包含多个文件路径的文件，可以并发地发送恶意请求，探测并下载服务器上的文件内容。根据漏洞信息，只有JobManager进程有权限访问的文件才可被读取。利用代码中存在保存下载文件的功能。鉴于POC代码的功能主要是读取文件，保存到本地，且代码量不大，人工 review 之后发现仅仅存在一处输出文件夹名称写死的低级错误，所以代码中存在投毒的可能性较低，给出了1%的概率。

**项目地址:** [GazettEl/CVE-2020-17519](https://github.com/GazettEl/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #3

**来源**: [CVE-2020-17519-Osyanina_westone-CVE-2020-17519-scanner.md](../2020/CVE-2020-17519-Osyanina_westone-CVE-2020-17519-scanner.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可读取 JobManager 进程可访问的任意文件

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager 进程的 REST 接口暴露

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可访问的本地文件系统上的任意文件。漏洞利用方式是通过构造包含目录遍历字符（如 `../`）的 HTTP 请求，访问 REST 接口。根据提供的漏洞利用代码，该利用代码是一个简单的扫描器，用于检测目标是否存在此漏洞，看起来风险较低，但考虑到可执行文件(`CVE-2020-17519.exe`)的存在，无法完全排除作者在其中隐藏恶意代码的可能性，因此有一定的投毒风险, 估计为10%。考虑到CISA已将此漏洞加入已知被利用的漏洞目录，该漏洞的威胁程度较高。

**项目地址:** [Osyanina/westone-CVE-2020-17519-scanner](https://github.com/Osyanina/westone-CVE-2020-17519-scanner)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #4

**来源**: [CVE-2020-17519-QmF0c3UK_CVE-2020-17519.md](../2020/CVE-2020-17519-QmF0c3UK_CVE-2020-17519.md)

# CVE-2020-17519

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-17519-B1anda0_CVE-2020-17519.md](../2020/CVE-2020-17519-B1anda0_CVE-2020-17519.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager进程的REST接口对外开放，且目标Flink版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache Flink 1.11.0到1.11.2版本中，允许未经身份验证的攻击者通过JobManager的REST接口读取JobManager进程可访问的本地文件系统上的任何文件。攻击者可以通过构造包含目录遍历序列（如`..%252f`）的恶意URL来访问系统文件。提供的POC代码通过发送包含特定payload的GET请求到`/jobmanager/logs`端点，尝试读取`/etc/passwd`文件来验证漏洞的存在。

**有效性：**
根据漏洞描述和POC代码，该POC能够有效验证漏洞的存在。POC通过构造包含URL编码的目录遍历字符的payload，尝试读取`/etc/passwd`文件。如果服务器返回200状态码并且响应内容包含`root:x`，则确认漏洞存在。

**投毒风险：**
该POC代码主要功能是发送HTTP请求并检查响应，以验证漏洞是否存在。代码包含以下操作：
1.  导入必要的库（requests, sys, colorama）。
2.  定义banner信息。
3.  定义verify函数，用于发送HTTP请求并检查响应。
4.  在主函数中，读取包含URL的文本文件，并对每个URL执行verify函数。
5.  如果检测到漏洞，则将URL写入vul.txt文件。

没有发现任何可疑的或恶意的代码，例如执行系统命令、修改文件或上传恶意文件等。因此，可以认为此仓库不存在作者隐藏的投毒代码，投毒风险为0%。

**利用方式：**
1.  确定目标Flink实例的版本是否在受影响的范围内（1.11.0到1.11.2）。
2.  通过网络访问JobManager进程的REST接口。
3.  构造包含目录遍历序列的URL，指向要读取的文件。例如：
    ```
    /jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd
    ```
    其中`..%252f`是`../`的URL编码形式，用于进行目录遍历。
4.  发送GET请求到构造的URL。
5.  如果服务器返回文件内容，则表示漏洞利用成功。攻击者可以读取JobManager进程有权访问的任何文件，包括配置文件、日志文件等。
6.  利用获取的敏感信息，可以进一步攻击系统。

**项目地址:** [B1anda0/CVE-2020-17519](https://github.com/B1anda0/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #2

**来源**: [CVE-2020-17519-GazettEl_CVE-2020-17519.md](../2020/CVE-2020-17519-GazettEl_CVE-2020-17519.md)

## CVE-2020-17519-Apache Flink目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要Flink JobManager的REST接口对外暴露

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 的 REST 接口利用目录遍历漏洞读取 JobManager 进程本地文件系统上的任何文件。漏洞利用方式为构造包含目录遍历字符的URL，发送GET请求至JobManager的logs接口。漏洞利用代码通过指定目标URL、遍历深度以及目标文件路径或包含多个文件路径的文件，可以并发地发送恶意请求，探测并下载服务器上的文件内容。根据漏洞信息，只有JobManager进程有权限访问的文件才可被读取。利用代码中存在保存下载文件的功能。鉴于POC代码的功能主要是读取文件，保存到本地，且代码量不大，人工 review 之后发现仅仅存在一处输出文件夹名称写死的低级错误，所以代码中存在投毒的可能性较低，给出了1%的概率。

**项目地址:** [GazettEl/CVE-2020-17519](https://github.com/GazettEl/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #3

**来源**: [CVE-2020-17519-Osyanina_westone-CVE-2020-17519-scanner.md](../2020/CVE-2020-17519-Osyanina_westone-CVE-2020-17519-scanner.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可读取 JobManager 进程可访问的任意文件

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager 进程的 REST 接口暴露

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可访问的本地文件系统上的任意文件。漏洞利用方式是通过构造包含目录遍历字符（如 `../`）的 HTTP 请求，访问 REST 接口。根据提供的漏洞利用代码，该利用代码是一个简单的扫描器，用于检测目标是否存在此漏洞，看起来风险较低，但考虑到可执行文件(`CVE-2020-17519.exe`)的存在，无法完全排除作者在其中隐藏恶意代码的可能性，因此有一定的投毒风险, 估计为10%。考虑到CISA已将此漏洞加入已知被利用的漏洞目录，该漏洞的威胁程度较高。

**项目地址:** [Osyanina/westone-CVE-2020-17519-scanner](https://github.com/Osyanina/westone-CVE-2020-17519-scanner)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #4

**来源**: [CVE-2020-17519-QmF0c3UK_CVE-2020-17519.md](../2020/CVE-2020-17519-QmF0c3UK_CVE-2020-17519.md)

# CVE-2020-17519

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-17519-B1anda0_CVE-2020-17519.md](../2020/CVE-2020-17519-B1anda0_CVE-2020-17519.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager进程的REST接口对外开放，且目标Flink版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache Flink 1.11.0到1.11.2版本中，允许未经身份验证的攻击者通过JobManager的REST接口读取JobManager进程可访问的本地文件系统上的任何文件。攻击者可以通过构造包含目录遍历序列（如`..%252f`）的恶意URL来访问系统文件。提供的POC代码通过发送包含特定payload的GET请求到`/jobmanager/logs`端点，尝试读取`/etc/passwd`文件来验证漏洞的存在。

**有效性：**
根据漏洞描述和POC代码，该POC能够有效验证漏洞的存在。POC通过构造包含URL编码的目录遍历字符的payload，尝试读取`/etc/passwd`文件。如果服务器返回200状态码并且响应内容包含`root:x`，则确认漏洞存在。

**投毒风险：**
该POC代码主要功能是发送HTTP请求并检查响应，以验证漏洞是否存在。代码包含以下操作：
1.  导入必要的库（requests, sys, colorama）。
2.  定义banner信息。
3.  定义verify函数，用于发送HTTP请求并检查响应。
4.  在主函数中，读取包含URL的文本文件，并对每个URL执行verify函数。
5.  如果检测到漏洞，则将URL写入vul.txt文件。

没有发现任何可疑的或恶意的代码，例如执行系统命令、修改文件或上传恶意文件等。因此，可以认为此仓库不存在作者隐藏的投毒代码，投毒风险为0%。

**利用方式：**
1.  确定目标Flink实例的版本是否在受影响的范围内（1.11.0到1.11.2）。
2.  通过网络访问JobManager进程的REST接口。
3.  构造包含目录遍历序列的URL，指向要读取的文件。例如：
    ```
    /jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd
    ```
    其中`..%252f`是`../`的URL编码形式，用于进行目录遍历。
4.  发送GET请求到构造的URL。
5.  如果服务器返回文件内容，则表示漏洞利用成功。攻击者可以读取JobManager进程有权访问的任何文件，包括配置文件、日志文件等。
6.  利用获取的敏感信息，可以进一步攻击系统。

**项目地址:** [B1anda0/CVE-2020-17519](https://github.com/B1anda0/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #2

**来源**: [CVE-2020-17519-GazettEl_CVE-2020-17519.md](../2020/CVE-2020-17519-GazettEl_CVE-2020-17519.md)

## CVE-2020-17519-Apache Flink目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要Flink JobManager的REST接口对外暴露

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 的 REST 接口利用目录遍历漏洞读取 JobManager 进程本地文件系统上的任何文件。漏洞利用方式为构造包含目录遍历字符的URL，发送GET请求至JobManager的logs接口。漏洞利用代码通过指定目标URL、遍历深度以及目标文件路径或包含多个文件路径的文件，可以并发地发送恶意请求，探测并下载服务器上的文件内容。根据漏洞信息，只有JobManager进程有权限访问的文件才可被读取。利用代码中存在保存下载文件的功能。鉴于POC代码的功能主要是读取文件，保存到本地，且代码量不大，人工 review 之后发现仅仅存在一处输出文件夹名称写死的低级错误，所以代码中存在投毒的可能性较低，给出了1%的概率。

**项目地址:** [GazettEl/CVE-2020-17519](https://github.com/GazettEl/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #3

**来源**: [CVE-2020-17519-Osyanina_westone-CVE-2020-17519-scanner.md](../2020/CVE-2020-17519-Osyanina_westone-CVE-2020-17519-scanner.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可读取 JobManager 进程可访问的任意文件

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager 进程的 REST 接口暴露

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可访问的本地文件系统上的任意文件。漏洞利用方式是通过构造包含目录遍历字符（如 `../`）的 HTTP 请求，访问 REST 接口。根据提供的漏洞利用代码，该利用代码是一个简单的扫描器，用于检测目标是否存在此漏洞，看起来风险较低，但考虑到可执行文件(`CVE-2020-17519.exe`)的存在，无法完全排除作者在其中隐藏恶意代码的可能性，因此有一定的投毒风险, 估计为10%。考虑到CISA已将此漏洞加入已知被利用的漏洞目录，该漏洞的威胁程度较高。

**项目地址:** [Osyanina/westone-CVE-2020-17519-scanner](https://github.com/Osyanina/westone-CVE-2020-17519-scanner)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #4

**来源**: [CVE-2020-17519-QmF0c3UK_CVE-2020-17519.md](../2020/CVE-2020-17519-QmF0c3UK_CVE-2020-17519.md)

# CVE-2020-17519

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-17519-B1anda0_CVE-2020-17519.md](../2020/CVE-2020-17519-B1anda0_CVE-2020-17519.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager进程的REST接口对外开放，且目标Flink版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache Flink 1.11.0到1.11.2版本中，允许未经身份验证的攻击者通过JobManager的REST接口读取JobManager进程可访问的本地文件系统上的任何文件。攻击者可以通过构造包含目录遍历序列（如`..%252f`）的恶意URL来访问系统文件。提供的POC代码通过发送包含特定payload的GET请求到`/jobmanager/logs`端点，尝试读取`/etc/passwd`文件来验证漏洞的存在。

**有效性：**
根据漏洞描述和POC代码，该POC能够有效验证漏洞的存在。POC通过构造包含URL编码的目录遍历字符的payload，尝试读取`/etc/passwd`文件。如果服务器返回200状态码并且响应内容包含`root:x`，则确认漏洞存在。

**投毒风险：**
该POC代码主要功能是发送HTTP请求并检查响应，以验证漏洞是否存在。代码包含以下操作：
1.  导入必要的库（requests, sys, colorama）。
2.  定义banner信息。
3.  定义verify函数，用于发送HTTP请求并检查响应。
4.  在主函数中，读取包含URL的文本文件，并对每个URL执行verify函数。
5.  如果检测到漏洞，则将URL写入vul.txt文件。

没有发现任何可疑的或恶意的代码，例如执行系统命令、修改文件或上传恶意文件等。因此，可以认为此仓库不存在作者隐藏的投毒代码，投毒风险为0%。

**利用方式：**
1.  确定目标Flink实例的版本是否在受影响的范围内（1.11.0到1.11.2）。
2.  通过网络访问JobManager进程的REST接口。
3.  构造包含目录遍历序列的URL，指向要读取的文件。例如：
    ```
    /jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd
    ```
    其中`..%252f`是`../`的URL编码形式，用于进行目录遍历。
4.  发送GET请求到构造的URL。
5.  如果服务器返回文件内容，则表示漏洞利用成功。攻击者可以读取JobManager进程有权访问的任何文件，包括配置文件、日志文件等。
6.  利用获取的敏感信息，可以进一步攻击系统。

**项目地址:** [B1anda0/CVE-2020-17519](https://github.com/B1anda0/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #2

**来源**: [CVE-2020-17519-GazettEl_CVE-2020-17519.md](../2020/CVE-2020-17519-GazettEl_CVE-2020-17519.md)

## CVE-2020-17519-Apache Flink目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要Flink JobManager的REST接口对外暴露

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 的 REST 接口利用目录遍历漏洞读取 JobManager 进程本地文件系统上的任何文件。漏洞利用方式为构造包含目录遍历字符的URL，发送GET请求至JobManager的logs接口。漏洞利用代码通过指定目标URL、遍历深度以及目标文件路径或包含多个文件路径的文件，可以并发地发送恶意请求，探测并下载服务器上的文件内容。根据漏洞信息，只有JobManager进程有权限访问的文件才可被读取。利用代码中存在保存下载文件的功能。鉴于POC代码的功能主要是读取文件，保存到本地，且代码量不大，人工 review 之后发现仅仅存在一处输出文件夹名称写死的低级错误，所以代码中存在投毒的可能性较低，给出了1%的概率。

**项目地址:** [GazettEl/CVE-2020-17519](https://github.com/GazettEl/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #3

**来源**: [CVE-2020-17519-Osyanina_westone-CVE-2020-17519-scanner.md](../2020/CVE-2020-17519-Osyanina_westone-CVE-2020-17519-scanner.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可读取 JobManager 进程可访问的任意文件

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager 进程的 REST 接口暴露

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可访问的本地文件系统上的任意文件。漏洞利用方式是通过构造包含目录遍历字符（如 `../`）的 HTTP 请求，访问 REST 接口。根据提供的漏洞利用代码，该利用代码是一个简单的扫描器，用于检测目标是否存在此漏洞，看起来风险较低，但考虑到可执行文件(`CVE-2020-17519.exe`)的存在，无法完全排除作者在其中隐藏恶意代码的可能性，因此有一定的投毒风险, 估计为10%。考虑到CISA已将此漏洞加入已知被利用的漏洞目录，该漏洞的威胁程度较高。

**项目地址:** [Osyanina/westone-CVE-2020-17519-scanner](https://github.com/Osyanina/westone-CVE-2020-17519-scanner)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #4

**来源**: [CVE-2020-17519-QmF0c3UK_CVE-2020-17519.md](../2020/CVE-2020-17519-QmF0c3UK_CVE-2020-17519.md)

# CVE-2020-17519

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-17519-B1anda0_CVE-2020-17519.md](../2020/CVE-2020-17519-B1anda0_CVE-2020-17519.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager进程的REST接口对外开放，且目标Flink版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache Flink 1.11.0到1.11.2版本中，允许未经身份验证的攻击者通过JobManager的REST接口读取JobManager进程可访问的本地文件系统上的任何文件。攻击者可以通过构造包含目录遍历序列（如`..%252f`）的恶意URL来访问系统文件。提供的POC代码通过发送包含特定payload的GET请求到`/jobmanager/logs`端点，尝试读取`/etc/passwd`文件来验证漏洞的存在。

**有效性：**
根据漏洞描述和POC代码，该POC能够有效验证漏洞的存在。POC通过构造包含URL编码的目录遍历字符的payload，尝试读取`/etc/passwd`文件。如果服务器返回200状态码并且响应内容包含`root:x`，则确认漏洞存在。

**投毒风险：**
该POC代码主要功能是发送HTTP请求并检查响应，以验证漏洞是否存在。代码包含以下操作：
1.  导入必要的库（requests, sys, colorama）。
2.  定义banner信息。
3.  定义verify函数，用于发送HTTP请求并检查响应。
4.  在主函数中，读取包含URL的文本文件，并对每个URL执行verify函数。
5.  如果检测到漏洞，则将URL写入vul.txt文件。

没有发现任何可疑的或恶意的代码，例如执行系统命令、修改文件或上传恶意文件等。因此，可以认为此仓库不存在作者隐藏的投毒代码，投毒风险为0%。

**利用方式：**
1.  确定目标Flink实例的版本是否在受影响的范围内（1.11.0到1.11.2）。
2.  通过网络访问JobManager进程的REST接口。
3.  构造包含目录遍历序列的URL，指向要读取的文件。例如：
    ```
    /jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd
    ```
    其中`..%252f`是`../`的URL编码形式，用于进行目录遍历。
4.  发送GET请求到构造的URL。
5.  如果服务器返回文件内容，则表示漏洞利用成功。攻击者可以读取JobManager进程有权访问的任何文件，包括配置文件、日志文件等。
6.  利用获取的敏感信息，可以进一步攻击系统。

**项目地址:** [B1anda0/CVE-2020-17519](https://github.com/B1anda0/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #2

**来源**: [CVE-2020-17519-GazettEl_CVE-2020-17519.md](../2020/CVE-2020-17519-GazettEl_CVE-2020-17519.md)

## CVE-2020-17519-Apache Flink目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要Flink JobManager的REST接口对外暴露

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 的 REST 接口利用目录遍历漏洞读取 JobManager 进程本地文件系统上的任何文件。漏洞利用方式为构造包含目录遍历字符的URL，发送GET请求至JobManager的logs接口。漏洞利用代码通过指定目标URL、遍历深度以及目标文件路径或包含多个文件路径的文件，可以并发地发送恶意请求，探测并下载服务器上的文件内容。根据漏洞信息，只有JobManager进程有权限访问的文件才可被读取。利用代码中存在保存下载文件的功能。鉴于POC代码的功能主要是读取文件，保存到本地，且代码量不大，人工 review 之后发现仅仅存在一处输出文件夹名称写死的低级错误，所以代码中存在投毒的可能性较低，给出了1%的概率。

**项目地址:** [GazettEl/CVE-2020-17519](https://github.com/GazettEl/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #3

**来源**: [CVE-2020-17519-Osyanina_westone-CVE-2020-17519-scanner.md](../2020/CVE-2020-17519-Osyanina_westone-CVE-2020-17519-scanner.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可读取 JobManager 进程可访问的任意文件

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager 进程的 REST 接口暴露

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可访问的本地文件系统上的任意文件。漏洞利用方式是通过构造包含目录遍历字符（如 `../`）的 HTTP 请求，访问 REST 接口。根据提供的漏洞利用代码，该利用代码是一个简单的扫描器，用于检测目标是否存在此漏洞，看起来风险较低，但考虑到可执行文件(`CVE-2020-17519.exe`)的存在，无法完全排除作者在其中隐藏恶意代码的可能性，因此有一定的投毒风险, 估计为10%。考虑到CISA已将此漏洞加入已知被利用的漏洞目录，该漏洞的威胁程度较高。

**项目地址:** [Osyanina/westone-CVE-2020-17519-scanner](https://github.com/Osyanina/westone-CVE-2020-17519-scanner)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #4

**来源**: [CVE-2020-17519-QmF0c3UK_CVE-2020-17519.md](../2020/CVE-2020-17519-QmF0c3UK_CVE-2020-17519.md)

## CVE-2020-17519-Apache Flink-目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager的REST API暴露在网络中，且JobManager进程对目标文件具有读取权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 的 REST 接口，利用目录遍历漏洞读取 JobManager 进程可访问的本地文件系统上的任意文件。漏洞利用代码 `CVE-2020-17519.py` 通过构造包含目录遍历字符的 URL 来实现文件读取。例如：`TARGET_URI + cmd`，其中 `cmd` 是经过 URL 编码的文件路径。该 POC 脚本支持单个 URL 测试和批量 URL 测试。 

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断该漏洞的 POC 代码是有效的。搜索引擎结果中多个链接表明该漏洞已被积极利用，且 CISA 已将其添加到已知被利用的漏洞目录（KEV）。

**投毒风险：**
对提供的 POC 代码进行分析，发现以下潜在风险：

*   **代理设置：** POC 代码中包含 `proxies = {"http":"http://127.0.0.1:8080"}`，如果攻击者诱导用户使用恶意代理，可能会截获用户的请求和响应，造成信息泄露。虽然该代理设置被注释掉了，但可能会被使用者启用。
*   **写入文件：** POC 脚本会在检测到漏洞后将存在漏洞的 URL 写入 `存在漏洞地址.txt` 文件。此行为本身没有直接的投毒风险，但如果脚本被修改为写入恶意内容到其他文件，则可能存在投毒风险。
*   **异常处理：** POC 使用了通用的 `except:` 块，这可能会掩盖一些潜在的错误，使得用户难以发现脚本的异常行为。如果攻击者利用这一点，可能会在脚本中隐藏恶意代码。

综合考虑，该 POC 代码存在一定的投毒风险，但主要集中在潜在的代理劫持和异常处理方面。判断投毒概率为 10%。

**利用方式：**
1.  **确定目标：** 找到运行 Apache Flink 1.11.0 到 1.11.2 版本的 JobManager，且其 REST API 暴露在网络中。
2.  **构造恶意 URL：** 构造包含目录遍历字符的 URL，例如：`http://<target_ip>:<port>/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
3.  **发送请求：** 使用 GET 请求发送恶意 URL。
4.  **获取文件内容：** 如果漏洞存在，JobManager 将返回目标文件的内容。

此漏洞的利用前提是JobManager进程需要拥有读取目标文件的权限。攻击者可以利用此漏洞读取敏感配置文件、日志文件等，从而获取敏感信息。

**项目地址:** [QmF0c3UK/CVE-2020-17519](https://github.com/QmF0c3UK/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #5

**来源**: [CVE-2020-17519-dev-team-12x_CVE-2020-17519.md](../2020/CVE-2020-17519-dev-team-12x_CVE-2020-17519.md)

## CVE-2020-17519 - Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历/文件读取

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要目标Flink JobManager的REST接口对外开放且版本为受影响版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519是Apache Flink 1.11.0到1.11.2版本中的一个目录遍历漏洞。攻击者可以通过构造特殊的URL，利用JobManager的REST接口读取JobManager进程有权访问的本地文件系统上的任意文件。该漏洞无需身份验证即可利用。利用方式如下：

1.  确定目标Flink JobManager的REST接口地址和端口。
2.  构造包含目录遍历字符的URL，例如`http://<flink_jobmanager_host>:<flink_jobmanager_port>/jobmanager/logs/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc/passwd`，其中`..%2F`用于向上遍历目录。
3.  发送HTTP GET请求到构造的URL。
4.  如果目标存在漏洞，服务器将返回请求的文件内容。

根据提供的Metasploit模块`auxiliary/scanner/http/apache_flink_file_read`，攻击者可以通过设置`RHOSTS`（目标主机）、`RPORT`（目标端口）、`FILEPATH`（要读取的文件路径）和`DEPTH`（目录遍历深度）来利用该漏洞。提供的代码示例演示了如何读取`/etc/passwd`文件。

分析提供的POC代码，没有发现明显的投毒代码。该代码的功能仅限于扫描和利用已知的目录遍历漏洞来读取文件。所有操作都旨在利用漏洞，不存在额外植入后门或恶意行为的逻辑。

**项目地址:** [dev-team-12x/CVE-2020-17519](https://github.com/dev-team-12x/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #6

**来源**: [CVE-2020-17519-dolevf_apache-flink-directory-traversal.nse.md](../2020/CVE-2020-17519-dolevf_apache-flink-directory-traversal.nse.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可读取JobManager进程可访问的任意文件

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要Flink JobManager的REST接口暴露在外网或内网，且目标版本在1.11.0到1.11.2之间。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2020-17519是Apache Flink 1.11.0到1.11.2版本中存在的一个目录遍历漏洞。攻击者可以通过JobManager的REST接口，利用`..%252f`进行URL编码后的目录穿越，读取JobManager进程有权访问的服务器本地文件。CISA已将此漏洞添加到已知被利用漏洞目录中，表明该漏洞正在被积极利用。

提供的Nmap脚本`apache-flink-traversal.nse`通过构造特定的HTTP GET请求，尝试读取`/etc/passwd`文件来验证漏洞是否存在。具体来说，它发送请求到`/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`，如果服务器返回状态码200且响应体中包含`root:x:0:0`，则认为目标服务器存在漏洞。

**有效性：**
POC代码有效，它通过构造恶意的URL来读取敏感文件，是检测漏洞的常见方法。

**投毒风险：**
查看了提供的Nmap脚本内容，该脚本的主要功能是检测目标主机是否存在CVE-2020-17519漏洞，通过发送包含目录遍历payload的HTTP请求到目标Flink JobManager的REST API端点，并检查响应内容是否包含`/etc/passwd`文件的内容，从而判断是否存在漏洞。未发现作者隐藏的恶意代码或后门。
虽然此脚本本身的功能是检查漏洞，但使用者可能会利用此漏洞来获取服务器上的敏感信息，这属于漏洞利用行为，而非POC投毒。因此，投毒风险评估为0%。

**利用方式：**
1.  确定目标Apache Flink的版本是否在受影响的范围内（1.11.0 to 1.11.2）。
2.  使用Nmap脚本或手动构造包含目录遍历payload的HTTP GET请求，发送到JobManager的REST接口。
3.  通过REST接口发送请求`/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
4.  如果服务器返回状态码200，并且响应体包含`/etc/passwd`的内容，则表明漏洞存在，可以进一步利用该漏洞读取其他文件。
5.  利用该漏洞读取JobManager进程可访问的任何本地文件，例如配置文件、密钥等。

**项目地址:** [dolevf/apache-flink-directory-traversal.nse](https://github.com/dolevf/apache-flink-directory-traversal.nse)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #7

**来源**: [CVE-2020-17519-givemefivw_CVE-2020-17519.md](../2020/CVE-2020-17519-givemefivw_CVE-2020-17519.md)

## CVE-2020-17519 Apache Flink 任意文件读取

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历/文件读取

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager REST API 端口对外开放，且目标为受影响版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17519 是一个 Apache Flink 中的目录遍历漏洞，存在于 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 进程的 REST 接口读取 JobManager 进程可访问的本地文件系统上的任何文件，无需身份验证。利用方式是通过构造包含目录遍历序列（如 `..%252f`）的 URL，向 JobManager 的特定端点（`/jobmanager/logs`）发送 HTTP GET 请求。提供的POC代码使用Cheetah语言编写，通过读取ip.txt文件中的IP地址列表，批量发送构造好的HTTP请求，检测目标是否存在漏洞，并通过判断响应内容中是否包含"root"字符串来验证/etc/passwd文件是否读取成功。虽然POC本身功能是验证漏洞，但脚本设计上存在潜在投毒风险：1. ip.txt文件可能被替换为包含恶意IP地址的列表，导致扫描行为扩散； 2. 读取到的文件内容可能会被上传到恶意服务器，导致信息泄露。根据代码文件和说明文档的分析,认为主要功能为漏洞探测,但存在小概率的潜在利用可能,因此判断投毒风险为10%。

**项目地址:** [givemefivw/CVE-2020-17519](https://github.com/givemefivw/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #8

**来源**: [CVE-2020-17519-murataydemir_CVE-2020-17519.md](../2020/CVE-2020-17519-murataydemir_CVE-2020-17519.md)

## CVE-2020-17519 - Apache Flink RESTful API 任意文件读取

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要 Flink JobManager 进程的 REST 接口对外暴露，且攻击者能访问该接口。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-17519 漏洞存在于 Apache Flink 1.11.0 到 1.11.2 版本中。该漏洞允许未经身份验证的攻击者通过 JobManager 的 RESTful API 读取 JobManager 进程本地文件系统上的任意文件。漏洞原因是 `JobManagerCustomLogHandler.java` 类中的代码未对用户提供的文件名进行充分的验证和过滤，导致目录遍历漏洞。PoC 中构造了包含 `..%252f` 的恶意请求，绕过路径检查，读取 `/etc/passwd` 文件。修复方法是在获取文件名时，仅取文件名部分，避免目录遍历。

**有效性：** 提供的 PoC 代码有效。多个来源（漏洞库信息、搜索引擎结果和漏洞利用代码）都表明该漏洞是可利用的，并且提供了可用的 PoC。CISA的KEV目录收录了该漏洞,表明该漏洞在野外被利用。

**投毒风险：** 仓库主要包含漏洞描述、受影响的版本、PoC 示例和修复方案说明。没有发现恶意代码，如反弹 shell、下载执行等。漏洞利用代码本身是对漏洞的重现，其目的是证明漏洞的存在。考虑到代码简洁、目标明确、以及缺乏隐藏的恶意行为，投毒风险极低。此仓库中检测到作者隐藏投毒代码的风险小于1%。

**利用方式：** 攻击者通过构造包含目录遍历字符（`..%252f`）的 HTTP GET 请求，发送到 Flink JobManager 的 RESTful API 接口 `/jobmanager/logs/{filename}`。由于服务端未对 `{filename}` 参数进行严格的校验，攻击者可以利用该参数读取 JobManager 进程可访问的任意文件，例如配置文件、系统文件等。攻击需要具备网络可达性。

**项目地址:** [murataydemir/CVE-2020-17519](https://github.com/murataydemir/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #9

**来源**: [CVE-2020-17519-radbsie_CVE-2020-17519-Exp.md](../2020/CVE-2020-17519-radbsie_CVE-2020-17519-Exp.md)

## CVE-2020-17519-Apache Flink-目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要目标Flink实例暴露REST API且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可以访问的本地文件系统上的任何文件，利用方式如下：

1.  **漏洞描述：** 由于 Apache Flink 在处理 REST API 请求时，没有充分过滤目录遍历字符，导致攻击者可以通过构造包含 `..%252f` 的恶意 URL 来访问系统上的任意文件。
2.  **POC有效性：** 提供的 Go 代码通过向目标 Flink JobManager 的 REST API 发送包含目录遍历payload的GET请求来验证漏洞是否存在。该POC通过检查响应体中是否存在类似 `root` 等关键字判断是否成功读取 `/etc/passwd` 文件，如果存在且状态码为200则判断目标存在漏洞，因此POC代码有效。
3.  **投毒风险：** 提供的EXP代码主要功能是通过目录遍历漏洞读取目标服务器上的文件，没有发现任何恶意或隐藏的投毒代码，因此投毒风险为0%。
4.  **利用方式：**
    *   攻击者构造包含目录遍历字符的 URL，例如：`/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
    *   攻击者将构造好的 URL 发送到目标 Flink JobManager 的 REST API。
    *   如果目标 Flink 版本在受影响范围内，且 JobManager 进程对目标文件具有读取权限，则攻击者可以成功读取该文件。
    *   通过读取敏感配置文件等，攻击者可以获取更多信息，为进一步攻击做准备。

从CISA的信息来看，该漏洞已经被积极利用，需要引起重视。

**项目地址:** [radbsie/CVE-2020-17519-Exp](https://github.com/radbsie/CVE-2020-17519-Exp)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #10

**来源**: [CVE-2020-17519-shoucheng3_apache__flink_CVE-2020-17519_1-11-2.md](../2020/CVE-2020-17519-shoucheng3_apache__flink_CVE-2020-17519_1-11-2.md)

## CVE-2020-17519-Apache Flink-目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager进程的REST接口可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。该漏洞允许未经身份验证的攻击者通过 JobManager 进程的 REST 接口读取 JobManager 进程有权访问的本地文件系统上的任何文件。漏洞利用方式是发送包含目录遍历序列（例如 `../`）的特制 HTTP 请求到REST接口，从而读取任意文件。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞存在已知的公开利用方法，并且已被添加到 CISA 的 KEV 目录中，表明该漏洞利用的有效性较高。

**投毒风险：**
提供的漏洞利用代码仅包含Apache许可证，没有任何恶意代码或后门，因此投毒风险为0%。

**利用方式：**
1.  确定目标 Flink JobManager 的 REST 接口地址。
2.  构造包含目录遍历序列的 HTTP GET 请求，例如：
    `GET /..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd HTTP/1.1` (URL编码的`../`)
3.  发送该请求到 Flink JobManager 的 REST 接口。
4.  如果漏洞存在，服务器将返回 `/etc/passwd` 文件的内容（或其他被请求的文件）。需要注意的是，攻击者只能访问 JobManager 进程有权访问的文件。

**项目地址:** [shoucheng3/apache__flink_CVE-2020-17519_1-11-2](https://github.com/shoucheng3/apache__flink_CVE-2020-17519_1-11-2)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #11

**来源**: [CVE-2020-17519-yaunsky_CVE-2020-17519-Apache-Flink.md](../2020/CVE-2020-17519-yaunsky_CVE-2020-17519-Apache-Flink.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager REST API 暴露在外网或可被访问的网络环境。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中存在的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可以访问的本地文件系统上的任何文件。\n\n**有效性：**\n
根据漏洞信息和搜索引擎结果，此漏洞利用是有效的。多个来源表明该漏洞已被积极利用，并且CISA已将其添加到已知被利用漏洞目录中。提供的POC代码尝试通过构造包含目录遍历序列的 URL 来读取 `/etc/passwd` 文件，这符合漏洞描述。POC 中 URL 编码 `%252f`是双重编码`/`，目的是绕过一些安全机制。\n\n**投毒风险：**\n
分析提供的 Python 脚本 `CVE-2020-17519.py` 以及相关文件, 发现并没有明显的恶意代码或后门。脚本的功能主要是发送 HTTP 请求到目标 Flink JobManager 实例，利用目录遍历漏洞读取文件。脚本代码相对简单，只实现了漏洞验证的功能, 投毒风险评估为0%。\n\n**利用方式：**\n
1.  **确定目标：** 找到运行 Apache Flink 1.11.0 到 1.11.2 版本的 JobManager 实例，并且该实例的 REST API 可以通过网络访问。
2.  **构造恶意 URL：** 构造包含目录遍历序列的 URL，例如 `/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`，尝试读取目标文件。
3.  **发送请求：** 使用 HTTP GET 请求将构造的 URL 发送到 JobManager 的 REST API。
4.  **分析响应：** 如果服务器返回目标文件的内容，则表明漏洞存在。\n\n**缓解措施：**\n
*   升级到 Apache Flink 1.11.3 或 1.12.0 及以上版本。
*   限制对 JobManager REST API 的访问。

**项目地址:** [yaunsky/CVE-2020-17519-Apache-Flink](https://github.com/yaunsky/CVE-2020-17519-Apache-Flink)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #12

**来源**: [CVE-2020-17519-zhangweijie11_CVE-2020-17519.md](../2020/CVE-2020-17519-zhangweijie11_CVE-2020-17519.md)

## CVE-2020-17519-Apache Flink目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager的REST接口对外开放且运行在受影响版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中存在的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口，利用目录遍历读取 JobManager 进程可以访问的本地文件系统上的任意文件。 

**有效性：**

提供的 POC 代码有效。它通过构造包含 `..%252f` (双重URL编码的 `../`) 的恶意 URL 发送 HTTP GET 请求到 `/jobmanager/logs/` 路径，尝试读取 `/etc/passwd` 文件。如果服务器返回状态码 200 且响应内容包含 `root:x`，则确认漏洞存在。

**投毒风险：**

提供的 POC 代码未发现明显的投毒代码。代码功能简单，仅用于验证漏洞是否存在，没有执行恶意操作或安装后门。该仓库的作者没有隐藏任何投毒代码, 投毒风险为 0%。

**利用方式：**

1.  确定目标 Apache Flink JobManager 的 REST 接口 URL。
2.  构造包含目录遍历的 URL，例如：`http://<target_url>/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
3.  发送 HTTP GET 请求到构造的 URL。
4.  如果服务器返回状态码 200 且响应内容为目标文件内容，则漏洞利用成功。请注意JobManager进程的权限决定了能够读取的文件。

**项目地址:** [zhangweijie11/CVE-2020-17519](https://github.com/zhangweijie11/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---



---

## POC #5

**来源**: [CVE-2020-17519-dev-team-12x_CVE-2020-17519.md](../2020/CVE-2020-17519-dev-team-12x_CVE-2020-17519.md)

## CVE-2020-17519 - Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历/文件读取

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要目标Flink JobManager的REST接口对外开放且版本为受影响版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519是Apache Flink 1.11.0到1.11.2版本中的一个目录遍历漏洞。攻击者可以通过构造特殊的URL，利用JobManager的REST接口读取JobManager进程有权访问的本地文件系统上的任意文件。该漏洞无需身份验证即可利用。利用方式如下：

1.  确定目标Flink JobManager的REST接口地址和端口。
2.  构造包含目录遍历字符的URL，例如`http://<flink_jobmanager_host>:<flink_jobmanager_port>/jobmanager/logs/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc/passwd`，其中`..%2F`用于向上遍历目录。
3.  发送HTTP GET请求到构造的URL。
4.  如果目标存在漏洞，服务器将返回请求的文件内容。

根据提供的Metasploit模块`auxiliary/scanner/http/apache_flink_file_read`，攻击者可以通过设置`RHOSTS`（目标主机）、`RPORT`（目标端口）、`FILEPATH`（要读取的文件路径）和`DEPTH`（目录遍历深度）来利用该漏洞。提供的代码示例演示了如何读取`/etc/passwd`文件。

分析提供的POC代码，没有发现明显的投毒代码。该代码的功能仅限于扫描和利用已知的目录遍历漏洞来读取文件。所有操作都旨在利用漏洞，不存在额外植入后门或恶意行为的逻辑。

**项目地址:** [dev-team-12x/CVE-2020-17519](https://github.com/dev-team-12x/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #6

**来源**: [CVE-2020-17519-dolevf_apache-flink-directory-traversal.nse.md](../2020/CVE-2020-17519-dolevf_apache-flink-directory-traversal.nse.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可读取JobManager进程可访问的任意文件

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要Flink JobManager的REST接口暴露在外网或内网，且目标版本在1.11.0到1.11.2之间。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2020-17519是Apache Flink 1.11.0到1.11.2版本中存在的一个目录遍历漏洞。攻击者可以通过JobManager的REST接口，利用`..%252f`进行URL编码后的目录穿越，读取JobManager进程有权访问的服务器本地文件。CISA已将此漏洞添加到已知被利用漏洞目录中，表明该漏洞正在被积极利用。

提供的Nmap脚本`apache-flink-traversal.nse`通过构造特定的HTTP GET请求，尝试读取`/etc/passwd`文件来验证漏洞是否存在。具体来说，它发送请求到`/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`，如果服务器返回状态码200且响应体中包含`root:x:0:0`，则认为目标服务器存在漏洞。

**有效性：**
POC代码有效，它通过构造恶意的URL来读取敏感文件，是检测漏洞的常见方法。

**投毒风险：**
查看了提供的Nmap脚本内容，该脚本的主要功能是检测目标主机是否存在CVE-2020-17519漏洞，通过发送包含目录遍历payload的HTTP请求到目标Flink JobManager的REST API端点，并检查响应内容是否包含`/etc/passwd`文件的内容，从而判断是否存在漏洞。未发现作者隐藏的恶意代码或后门。
虽然此脚本本身的功能是检查漏洞，但使用者可能会利用此漏洞来获取服务器上的敏感信息，这属于漏洞利用行为，而非POC投毒。因此，投毒风险评估为0%。

**利用方式：**
1.  确定目标Apache Flink的版本是否在受影响的范围内（1.11.0 to 1.11.2）。
2.  使用Nmap脚本或手动构造包含目录遍历payload的HTTP GET请求，发送到JobManager的REST接口。
3.  通过REST接口发送请求`/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
4.  如果服务器返回状态码200，并且响应体包含`/etc/passwd`的内容，则表明漏洞存在，可以进一步利用该漏洞读取其他文件。
5.  利用该漏洞读取JobManager进程可访问的任何本地文件，例如配置文件、密钥等。

**项目地址:** [dolevf/apache-flink-directory-traversal.nse](https://github.com/dolevf/apache-flink-directory-traversal.nse)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #7

**来源**: [CVE-2020-17519-givemefivw_CVE-2020-17519.md](../2020/CVE-2020-17519-givemefivw_CVE-2020-17519.md)

## CVE-2020-17519 Apache Flink 任意文件读取

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历/文件读取

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager REST API 端口对外开放，且目标为受影响版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17519 是一个 Apache Flink 中的目录遍历漏洞，存在于 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 进程的 REST 接口读取 JobManager 进程可访问的本地文件系统上的任何文件，无需身份验证。利用方式是通过构造包含目录遍历序列（如 `..%252f`）的 URL，向 JobManager 的特定端点（`/jobmanager/logs`）发送 HTTP GET 请求。提供的POC代码使用Cheetah语言编写，通过读取ip.txt文件中的IP地址列表，批量发送构造好的HTTP请求，检测目标是否存在漏洞，并通过判断响应内容中是否包含"root"字符串来验证/etc/passwd文件是否读取成功。虽然POC本身功能是验证漏洞，但脚本设计上存在潜在投毒风险：1. ip.txt文件可能被替换为包含恶意IP地址的列表，导致扫描行为扩散； 2. 读取到的文件内容可能会被上传到恶意服务器，导致信息泄露。根据代码文件和说明文档的分析,认为主要功能为漏洞探测,但存在小概率的潜在利用可能,因此判断投毒风险为10%。

**项目地址:** [givemefivw/CVE-2020-17519](https://github.com/givemefivw/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #8

**来源**: [CVE-2020-17519-murataydemir_CVE-2020-17519.md](../2020/CVE-2020-17519-murataydemir_CVE-2020-17519.md)

## CVE-2020-17519 - Apache Flink RESTful API 任意文件读取

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要 Flink JobManager 进程的 REST 接口对外暴露，且攻击者能访问该接口。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-17519 漏洞存在于 Apache Flink 1.11.0 到 1.11.2 版本中。该漏洞允许未经身份验证的攻击者通过 JobManager 的 RESTful API 读取 JobManager 进程本地文件系统上的任意文件。漏洞原因是 `JobManagerCustomLogHandler.java` 类中的代码未对用户提供的文件名进行充分的验证和过滤，导致目录遍历漏洞。PoC 中构造了包含 `..%252f` 的恶意请求，绕过路径检查，读取 `/etc/passwd` 文件。修复方法是在获取文件名时，仅取文件名部分，避免目录遍历。

**有效性：** 提供的 PoC 代码有效。多个来源（漏洞库信息、搜索引擎结果和漏洞利用代码）都表明该漏洞是可利用的，并且提供了可用的 PoC。CISA的KEV目录收录了该漏洞,表明该漏洞在野外被利用。

**投毒风险：** 仓库主要包含漏洞描述、受影响的版本、PoC 示例和修复方案说明。没有发现恶意代码，如反弹 shell、下载执行等。漏洞利用代码本身是对漏洞的重现，其目的是证明漏洞的存在。考虑到代码简洁、目标明确、以及缺乏隐藏的恶意行为，投毒风险极低。此仓库中检测到作者隐藏投毒代码的风险小于1%。

**利用方式：** 攻击者通过构造包含目录遍历字符（`..%252f`）的 HTTP GET 请求，发送到 Flink JobManager 的 RESTful API 接口 `/jobmanager/logs/{filename}`。由于服务端未对 `{filename}` 参数进行严格的校验，攻击者可以利用该参数读取 JobManager 进程可访问的任意文件，例如配置文件、系统文件等。攻击需要具备网络可达性。

**项目地址:** [murataydemir/CVE-2020-17519](https://github.com/murataydemir/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #9

**来源**: [CVE-2020-17519-radbsie_CVE-2020-17519-Exp.md](../2020/CVE-2020-17519-radbsie_CVE-2020-17519-Exp.md)

## CVE-2020-17519-Apache Flink-目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要目标Flink实例暴露REST API且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可以访问的本地文件系统上的任何文件，利用方式如下：

1.  **漏洞描述：** 由于 Apache Flink 在处理 REST API 请求时，没有充分过滤目录遍历字符，导致攻击者可以通过构造包含 `..%252f` 的恶意 URL 来访问系统上的任意文件。
2.  **POC有效性：** 提供的 Go 代码通过向目标 Flink JobManager 的 REST API 发送包含目录遍历payload的GET请求来验证漏洞是否存在。该POC通过检查响应体中是否存在类似 `root` 等关键字判断是否成功读取 `/etc/passwd` 文件，如果存在且状态码为200则判断目标存在漏洞，因此POC代码有效。
3.  **投毒风险：** 提供的EXP代码主要功能是通过目录遍历漏洞读取目标服务器上的文件，没有发现任何恶意或隐藏的投毒代码，因此投毒风险为0%。
4.  **利用方式：**
    *   攻击者构造包含目录遍历字符的 URL，例如：`/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
    *   攻击者将构造好的 URL 发送到目标 Flink JobManager 的 REST API。
    *   如果目标 Flink 版本在受影响范围内，且 JobManager 进程对目标文件具有读取权限，则攻击者可以成功读取该文件。
    *   通过读取敏感配置文件等，攻击者可以获取更多信息，为进一步攻击做准备。

从CISA的信息来看，该漏洞已经被积极利用，需要引起重视。

**项目地址:** [radbsie/CVE-2020-17519-Exp](https://github.com/radbsie/CVE-2020-17519-Exp)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #10

**来源**: [CVE-2020-17519-shoucheng3_apache__flink_CVE-2020-17519_1-11-2.md](../2020/CVE-2020-17519-shoucheng3_apache__flink_CVE-2020-17519_1-11-2.md)

## CVE-2020-17519-Apache Flink-目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager进程的REST接口可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。该漏洞允许未经身份验证的攻击者通过 JobManager 进程的 REST 接口读取 JobManager 进程有权访问的本地文件系统上的任何文件。漏洞利用方式是发送包含目录遍历序列（例如 `../`）的特制 HTTP 请求到REST接口，从而读取任意文件。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞存在已知的公开利用方法，并且已被添加到 CISA 的 KEV 目录中，表明该漏洞利用的有效性较高。

**投毒风险：**
提供的漏洞利用代码仅包含Apache许可证，没有任何恶意代码或后门，因此投毒风险为0%。

**利用方式：**
1.  确定目标 Flink JobManager 的 REST 接口地址。
2.  构造包含目录遍历序列的 HTTP GET 请求，例如：
    `GET /..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd HTTP/1.1` (URL编码的`../`)
3.  发送该请求到 Flink JobManager 的 REST 接口。
4.  如果漏洞存在，服务器将返回 `/etc/passwd` 文件的内容（或其他被请求的文件）。需要注意的是，攻击者只能访问 JobManager 进程有权访问的文件。

**项目地址:** [shoucheng3/apache__flink_CVE-2020-17519_1-11-2](https://github.com/shoucheng3/apache__flink_CVE-2020-17519_1-11-2)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #11

**来源**: [CVE-2020-17519-yaunsky_CVE-2020-17519-Apache-Flink.md](../2020/CVE-2020-17519-yaunsky_CVE-2020-17519-Apache-Flink.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager REST API 暴露在外网或可被访问的网络环境。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中存在的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可以访问的本地文件系统上的任何文件。\n\n**有效性：**\n
根据漏洞信息和搜索引擎结果，此漏洞利用是有效的。多个来源表明该漏洞已被积极利用，并且CISA已将其添加到已知被利用漏洞目录中。提供的POC代码尝试通过构造包含目录遍历序列的 URL 来读取 `/etc/passwd` 文件，这符合漏洞描述。POC 中 URL 编码 `%252f`是双重编码`/`，目的是绕过一些安全机制。\n\n**投毒风险：**\n
分析提供的 Python 脚本 `CVE-2020-17519.py` 以及相关文件, 发现并没有明显的恶意代码或后门。脚本的功能主要是发送 HTTP 请求到目标 Flink JobManager 实例，利用目录遍历漏洞读取文件。脚本代码相对简单，只实现了漏洞验证的功能, 投毒风险评估为0%。\n\n**利用方式：**\n
1.  **确定目标：** 找到运行 Apache Flink 1.11.0 到 1.11.2 版本的 JobManager 实例，并且该实例的 REST API 可以通过网络访问。
2.  **构造恶意 URL：** 构造包含目录遍历序列的 URL，例如 `/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`，尝试读取目标文件。
3.  **发送请求：** 使用 HTTP GET 请求将构造的 URL 发送到 JobManager 的 REST API。
4.  **分析响应：** 如果服务器返回目标文件的内容，则表明漏洞存在。\n\n**缓解措施：**\n
*   升级到 Apache Flink 1.11.3 或 1.12.0 及以上版本。
*   限制对 JobManager REST API 的访问。

**项目地址:** [yaunsky/CVE-2020-17519-Apache-Flink](https://github.com/yaunsky/CVE-2020-17519-Apache-Flink)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #12

**来源**: [CVE-2020-17519-zhangweijie11_CVE-2020-17519.md](../2020/CVE-2020-17519-zhangweijie11_CVE-2020-17519.md)

## CVE-2020-17519-Apache Flink目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager的REST接口对外开放且运行在受影响版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中存在的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口，利用目录遍历读取 JobManager 进程可以访问的本地文件系统上的任意文件。 

**有效性：**

提供的 POC 代码有效。它通过构造包含 `..%252f` (双重URL编码的 `../`) 的恶意 URL 发送 HTTP GET 请求到 `/jobmanager/logs/` 路径，尝试读取 `/etc/passwd` 文件。如果服务器返回状态码 200 且响应内容包含 `root:x`，则确认漏洞存在。

**投毒风险：**

提供的 POC 代码未发现明显的投毒代码。代码功能简单，仅用于验证漏洞是否存在，没有执行恶意操作或安装后门。该仓库的作者没有隐藏任何投毒代码, 投毒风险为 0%。

**利用方式：**

1.  确定目标 Apache Flink JobManager 的 REST 接口 URL。
2.  构造包含目录遍历的 URL，例如：`http://<target_url>/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
3.  发送 HTTP GET 请求到构造的 URL。
4.  如果服务器返回状态码 200 且响应内容为目标文件内容，则漏洞利用成功。请注意JobManager进程的权限决定了能够读取的文件。

**项目地址:** [zhangweijie11/CVE-2020-17519](https://github.com/zhangweijie11/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---



---

## POC #5

**来源**: [CVE-2020-17519-dev-team-12x_CVE-2020-17519.md](../2020/CVE-2020-17519-dev-team-12x_CVE-2020-17519.md)

## CVE-2020-17519 - Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历/文件读取

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要目标Flink JobManager的REST接口对外开放且版本为受影响版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519是Apache Flink 1.11.0到1.11.2版本中的一个目录遍历漏洞。攻击者可以通过构造特殊的URL，利用JobManager的REST接口读取JobManager进程有权访问的本地文件系统上的任意文件。该漏洞无需身份验证即可利用。利用方式如下：

1.  确定目标Flink JobManager的REST接口地址和端口。
2.  构造包含目录遍历字符的URL，例如`http://<flink_jobmanager_host>:<flink_jobmanager_port>/jobmanager/logs/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc/passwd`，其中`..%2F`用于向上遍历目录。
3.  发送HTTP GET请求到构造的URL。
4.  如果目标存在漏洞，服务器将返回请求的文件内容。

根据提供的Metasploit模块`auxiliary/scanner/http/apache_flink_file_read`，攻击者可以通过设置`RHOSTS`（目标主机）、`RPORT`（目标端口）、`FILEPATH`（要读取的文件路径）和`DEPTH`（目录遍历深度）来利用该漏洞。提供的代码示例演示了如何读取`/etc/passwd`文件。

分析提供的POC代码，没有发现明显的投毒代码。该代码的功能仅限于扫描和利用已知的目录遍历漏洞来读取文件。所有操作都旨在利用漏洞，不存在额外植入后门或恶意行为的逻辑。

**项目地址:** [dev-team-12x/CVE-2020-17519](https://github.com/dev-team-12x/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #6

**来源**: [CVE-2020-17519-dolevf_apache-flink-directory-traversal.nse.md](../2020/CVE-2020-17519-dolevf_apache-flink-directory-traversal.nse.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可读取JobManager进程可访问的任意文件

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要Flink JobManager的REST接口暴露在外网或内网，且目标版本在1.11.0到1.11.2之间。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2020-17519是Apache Flink 1.11.0到1.11.2版本中存在的一个目录遍历漏洞。攻击者可以通过JobManager的REST接口，利用`..%252f`进行URL编码后的目录穿越，读取JobManager进程有权访问的服务器本地文件。CISA已将此漏洞添加到已知被利用漏洞目录中，表明该漏洞正在被积极利用。

提供的Nmap脚本`apache-flink-traversal.nse`通过构造特定的HTTP GET请求，尝试读取`/etc/passwd`文件来验证漏洞是否存在。具体来说，它发送请求到`/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`，如果服务器返回状态码200且响应体中包含`root:x:0:0`，则认为目标服务器存在漏洞。

**有效性：**
POC代码有效，它通过构造恶意的URL来读取敏感文件，是检测漏洞的常见方法。

**投毒风险：**
查看了提供的Nmap脚本内容，该脚本的主要功能是检测目标主机是否存在CVE-2020-17519漏洞，通过发送包含目录遍历payload的HTTP请求到目标Flink JobManager的REST API端点，并检查响应内容是否包含`/etc/passwd`文件的内容，从而判断是否存在漏洞。未发现作者隐藏的恶意代码或后门。
虽然此脚本本身的功能是检查漏洞，但使用者可能会利用此漏洞来获取服务器上的敏感信息，这属于漏洞利用行为，而非POC投毒。因此，投毒风险评估为0%。

**利用方式：**
1.  确定目标Apache Flink的版本是否在受影响的范围内（1.11.0 to 1.11.2）。
2.  使用Nmap脚本或手动构造包含目录遍历payload的HTTP GET请求，发送到JobManager的REST接口。
3.  通过REST接口发送请求`/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
4.  如果服务器返回状态码200，并且响应体包含`/etc/passwd`的内容，则表明漏洞存在，可以进一步利用该漏洞读取其他文件。
5.  利用该漏洞读取JobManager进程可访问的任何本地文件，例如配置文件、密钥等。

**项目地址:** [dolevf/apache-flink-directory-traversal.nse](https://github.com/dolevf/apache-flink-directory-traversal.nse)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #7

**来源**: [CVE-2020-17519-givemefivw_CVE-2020-17519.md](../2020/CVE-2020-17519-givemefivw_CVE-2020-17519.md)

## CVE-2020-17519 Apache Flink 任意文件读取

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历/文件读取

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager REST API 端口对外开放，且目标为受影响版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17519 是一个 Apache Flink 中的目录遍历漏洞，存在于 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 进程的 REST 接口读取 JobManager 进程可访问的本地文件系统上的任何文件，无需身份验证。利用方式是通过构造包含目录遍历序列（如 `..%252f`）的 URL，向 JobManager 的特定端点（`/jobmanager/logs`）发送 HTTP GET 请求。提供的POC代码使用Cheetah语言编写，通过读取ip.txt文件中的IP地址列表，批量发送构造好的HTTP请求，检测目标是否存在漏洞，并通过判断响应内容中是否包含"root"字符串来验证/etc/passwd文件是否读取成功。虽然POC本身功能是验证漏洞，但脚本设计上存在潜在投毒风险：1. ip.txt文件可能被替换为包含恶意IP地址的列表，导致扫描行为扩散； 2. 读取到的文件内容可能会被上传到恶意服务器，导致信息泄露。根据代码文件和说明文档的分析,认为主要功能为漏洞探测,但存在小概率的潜在利用可能,因此判断投毒风险为10%。

**项目地址:** [givemefivw/CVE-2020-17519](https://github.com/givemefivw/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #8

**来源**: [CVE-2020-17519-murataydemir_CVE-2020-17519.md](../2020/CVE-2020-17519-murataydemir_CVE-2020-17519.md)

## CVE-2020-17519 - Apache Flink RESTful API 任意文件读取

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要 Flink JobManager 进程的 REST 接口对外暴露，且攻击者能访问该接口。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-17519 漏洞存在于 Apache Flink 1.11.0 到 1.11.2 版本中。该漏洞允许未经身份验证的攻击者通过 JobManager 的 RESTful API 读取 JobManager 进程本地文件系统上的任意文件。漏洞原因是 `JobManagerCustomLogHandler.java` 类中的代码未对用户提供的文件名进行充分的验证和过滤，导致目录遍历漏洞。PoC 中构造了包含 `..%252f` 的恶意请求，绕过路径检查，读取 `/etc/passwd` 文件。修复方法是在获取文件名时，仅取文件名部分，避免目录遍历。

**有效性：** 提供的 PoC 代码有效。多个来源（漏洞库信息、搜索引擎结果和漏洞利用代码）都表明该漏洞是可利用的，并且提供了可用的 PoC。CISA的KEV目录收录了该漏洞,表明该漏洞在野外被利用。

**投毒风险：** 仓库主要包含漏洞描述、受影响的版本、PoC 示例和修复方案说明。没有发现恶意代码，如反弹 shell、下载执行等。漏洞利用代码本身是对漏洞的重现，其目的是证明漏洞的存在。考虑到代码简洁、目标明确、以及缺乏隐藏的恶意行为，投毒风险极低。此仓库中检测到作者隐藏投毒代码的风险小于1%。

**利用方式：** 攻击者通过构造包含目录遍历字符（`..%252f`）的 HTTP GET 请求，发送到 Flink JobManager 的 RESTful API 接口 `/jobmanager/logs/{filename}`。由于服务端未对 `{filename}` 参数进行严格的校验，攻击者可以利用该参数读取 JobManager 进程可访问的任意文件，例如配置文件、系统文件等。攻击需要具备网络可达性。

**项目地址:** [murataydemir/CVE-2020-17519](https://github.com/murataydemir/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #9

**来源**: [CVE-2020-17519-radbsie_CVE-2020-17519-Exp.md](../2020/CVE-2020-17519-radbsie_CVE-2020-17519-Exp.md)

## CVE-2020-17519-Apache Flink-目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要目标Flink实例暴露REST API且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可以访问的本地文件系统上的任何文件，利用方式如下：

1.  **漏洞描述：** 由于 Apache Flink 在处理 REST API 请求时，没有充分过滤目录遍历字符，导致攻击者可以通过构造包含 `..%252f` 的恶意 URL 来访问系统上的任意文件。
2.  **POC有效性：** 提供的 Go 代码通过向目标 Flink JobManager 的 REST API 发送包含目录遍历payload的GET请求来验证漏洞是否存在。该POC通过检查响应体中是否存在类似 `root` 等关键字判断是否成功读取 `/etc/passwd` 文件，如果存在且状态码为200则判断目标存在漏洞，因此POC代码有效。
3.  **投毒风险：** 提供的EXP代码主要功能是通过目录遍历漏洞读取目标服务器上的文件，没有发现任何恶意或隐藏的投毒代码，因此投毒风险为0%。
4.  **利用方式：**
    *   攻击者构造包含目录遍历字符的 URL，例如：`/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
    *   攻击者将构造好的 URL 发送到目标 Flink JobManager 的 REST API。
    *   如果目标 Flink 版本在受影响范围内，且 JobManager 进程对目标文件具有读取权限，则攻击者可以成功读取该文件。
    *   通过读取敏感配置文件等，攻击者可以获取更多信息，为进一步攻击做准备。

从CISA的信息来看，该漏洞已经被积极利用，需要引起重视。

**项目地址:** [radbsie/CVE-2020-17519-Exp](https://github.com/radbsie/CVE-2020-17519-Exp)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #10

**来源**: [CVE-2020-17519-shoucheng3_apache__flink_CVE-2020-17519_1-11-2.md](../2020/CVE-2020-17519-shoucheng3_apache__flink_CVE-2020-17519_1-11-2.md)

## CVE-2020-17519-Apache Flink-目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager进程的REST接口可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。该漏洞允许未经身份验证的攻击者通过 JobManager 进程的 REST 接口读取 JobManager 进程有权访问的本地文件系统上的任何文件。漏洞利用方式是发送包含目录遍历序列（例如 `../`）的特制 HTTP 请求到REST接口，从而读取任意文件。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞存在已知的公开利用方法，并且已被添加到 CISA 的 KEV 目录中，表明该漏洞利用的有效性较高。

**投毒风险：**
提供的漏洞利用代码仅包含Apache许可证，没有任何恶意代码或后门，因此投毒风险为0%。

**利用方式：**
1.  确定目标 Flink JobManager 的 REST 接口地址。
2.  构造包含目录遍历序列的 HTTP GET 请求，例如：
    `GET /..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd HTTP/1.1` (URL编码的`../`)
3.  发送该请求到 Flink JobManager 的 REST 接口。
4.  如果漏洞存在，服务器将返回 `/etc/passwd` 文件的内容（或其他被请求的文件）。需要注意的是，攻击者只能访问 JobManager 进程有权访问的文件。

**项目地址:** [shoucheng3/apache__flink_CVE-2020-17519_1-11-2](https://github.com/shoucheng3/apache__flink_CVE-2020-17519_1-11-2)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #11

**来源**: [CVE-2020-17519-yaunsky_CVE-2020-17519-Apache-Flink.md](../2020/CVE-2020-17519-yaunsky_CVE-2020-17519-Apache-Flink.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager REST API 暴露在外网或可被访问的网络环境。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中存在的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可以访问的本地文件系统上的任何文件。\n\n**有效性：**\n
根据漏洞信息和搜索引擎结果，此漏洞利用是有效的。多个来源表明该漏洞已被积极利用，并且CISA已将其添加到已知被利用漏洞目录中。提供的POC代码尝试通过构造包含目录遍历序列的 URL 来读取 `/etc/passwd` 文件，这符合漏洞描述。POC 中 URL 编码 `%252f`是双重编码`/`，目的是绕过一些安全机制。\n\n**投毒风险：**\n
分析提供的 Python 脚本 `CVE-2020-17519.py` 以及相关文件, 发现并没有明显的恶意代码或后门。脚本的功能主要是发送 HTTP 请求到目标 Flink JobManager 实例，利用目录遍历漏洞读取文件。脚本代码相对简单，只实现了漏洞验证的功能, 投毒风险评估为0%。\n\n**利用方式：**\n
1.  **确定目标：** 找到运行 Apache Flink 1.11.0 到 1.11.2 版本的 JobManager 实例，并且该实例的 REST API 可以通过网络访问。
2.  **构造恶意 URL：** 构造包含目录遍历序列的 URL，例如 `/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`，尝试读取目标文件。
3.  **发送请求：** 使用 HTTP GET 请求将构造的 URL 发送到 JobManager 的 REST API。
4.  **分析响应：** 如果服务器返回目标文件的内容，则表明漏洞存在。\n\n**缓解措施：**\n
*   升级到 Apache Flink 1.11.3 或 1.12.0 及以上版本。
*   限制对 JobManager REST API 的访问。

**项目地址:** [yaunsky/CVE-2020-17519-Apache-Flink](https://github.com/yaunsky/CVE-2020-17519-Apache-Flink)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #12

**来源**: [CVE-2020-17519-zhangweijie11_CVE-2020-17519.md](../2020/CVE-2020-17519-zhangweijie11_CVE-2020-17519.md)

## CVE-2020-17519-Apache Flink目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager的REST接口对外开放且运行在受影响版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中存在的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口，利用目录遍历读取 JobManager 进程可以访问的本地文件系统上的任意文件。 

**有效性：**

提供的 POC 代码有效。它通过构造包含 `..%252f` (双重URL编码的 `../`) 的恶意 URL 发送 HTTP GET 请求到 `/jobmanager/logs/` 路径，尝试读取 `/etc/passwd` 文件。如果服务器返回状态码 200 且响应内容包含 `root:x`，则确认漏洞存在。

**投毒风险：**

提供的 POC 代码未发现明显的投毒代码。代码功能简单，仅用于验证漏洞是否存在，没有执行恶意操作或安装后门。该仓库的作者没有隐藏任何投毒代码, 投毒风险为 0%。

**利用方式：**

1.  确定目标 Apache Flink JobManager 的 REST 接口 URL。
2.  构造包含目录遍历的 URL，例如：`http://<target_url>/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
3.  发送 HTTP GET 请求到构造的 URL。
4.  如果服务器返回状态码 200 且响应内容为目标文件内容，则漏洞利用成功。请注意JobManager进程的权限决定了能够读取的文件。

**项目地址:** [zhangweijie11/CVE-2020-17519](https://github.com/zhangweijie11/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---



---

## POC #5

**来源**: [CVE-2020-17519-dev-team-12x_CVE-2020-17519.md](../2020/CVE-2020-17519-dev-team-12x_CVE-2020-17519.md)

## CVE-2020-17519 - Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历/文件读取

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要目标Flink JobManager的REST接口对外开放且版本为受影响版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519是Apache Flink 1.11.0到1.11.2版本中的一个目录遍历漏洞。攻击者可以通过构造特殊的URL，利用JobManager的REST接口读取JobManager进程有权访问的本地文件系统上的任意文件。该漏洞无需身份验证即可利用。利用方式如下：

1.  确定目标Flink JobManager的REST接口地址和端口。
2.  构造包含目录遍历字符的URL，例如`http://<flink_jobmanager_host>:<flink_jobmanager_port>/jobmanager/logs/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc/passwd`，其中`..%2F`用于向上遍历目录。
3.  发送HTTP GET请求到构造的URL。
4.  如果目标存在漏洞，服务器将返回请求的文件内容。

根据提供的Metasploit模块`auxiliary/scanner/http/apache_flink_file_read`，攻击者可以通过设置`RHOSTS`（目标主机）、`RPORT`（目标端口）、`FILEPATH`（要读取的文件路径）和`DEPTH`（目录遍历深度）来利用该漏洞。提供的代码示例演示了如何读取`/etc/passwd`文件。

分析提供的POC代码，没有发现明显的投毒代码。该代码的功能仅限于扫描和利用已知的目录遍历漏洞来读取文件。所有操作都旨在利用漏洞，不存在额外植入后门或恶意行为的逻辑。

**项目地址:** [dev-team-12x/CVE-2020-17519](https://github.com/dev-team-12x/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #6

**来源**: [CVE-2020-17519-dolevf_apache-flink-directory-traversal.nse.md](../2020/CVE-2020-17519-dolevf_apache-flink-directory-traversal.nse.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可读取JobManager进程可访问的任意文件

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要Flink JobManager的REST接口暴露在外网或内网，且目标版本在1.11.0到1.11.2之间。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2020-17519是Apache Flink 1.11.0到1.11.2版本中存在的一个目录遍历漏洞。攻击者可以通过JobManager的REST接口，利用`..%252f`进行URL编码后的目录穿越，读取JobManager进程有权访问的服务器本地文件。CISA已将此漏洞添加到已知被利用漏洞目录中，表明该漏洞正在被积极利用。

提供的Nmap脚本`apache-flink-traversal.nse`通过构造特定的HTTP GET请求，尝试读取`/etc/passwd`文件来验证漏洞是否存在。具体来说，它发送请求到`/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`，如果服务器返回状态码200且响应体中包含`root:x:0:0`，则认为目标服务器存在漏洞。

**有效性：**
POC代码有效，它通过构造恶意的URL来读取敏感文件，是检测漏洞的常见方法。

**投毒风险：**
查看了提供的Nmap脚本内容，该脚本的主要功能是检测目标主机是否存在CVE-2020-17519漏洞，通过发送包含目录遍历payload的HTTP请求到目标Flink JobManager的REST API端点，并检查响应内容是否包含`/etc/passwd`文件的内容，从而判断是否存在漏洞。未发现作者隐藏的恶意代码或后门。
虽然此脚本本身的功能是检查漏洞，但使用者可能会利用此漏洞来获取服务器上的敏感信息，这属于漏洞利用行为，而非POC投毒。因此，投毒风险评估为0%。

**利用方式：**
1.  确定目标Apache Flink的版本是否在受影响的范围内（1.11.0 to 1.11.2）。
2.  使用Nmap脚本或手动构造包含目录遍历payload的HTTP GET请求，发送到JobManager的REST接口。
3.  通过REST接口发送请求`/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
4.  如果服务器返回状态码200，并且响应体包含`/etc/passwd`的内容，则表明漏洞存在，可以进一步利用该漏洞读取其他文件。
5.  利用该漏洞读取JobManager进程可访问的任何本地文件，例如配置文件、密钥等。

**项目地址:** [dolevf/apache-flink-directory-traversal.nse](https://github.com/dolevf/apache-flink-directory-traversal.nse)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #7

**来源**: [CVE-2020-17519-givemefivw_CVE-2020-17519.md](../2020/CVE-2020-17519-givemefivw_CVE-2020-17519.md)

## CVE-2020-17519 Apache Flink 任意文件读取

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历/文件读取

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager REST API 端口对外开放，且目标为受影响版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17519 是一个 Apache Flink 中的目录遍历漏洞，存在于 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 进程的 REST 接口读取 JobManager 进程可访问的本地文件系统上的任何文件，无需身份验证。利用方式是通过构造包含目录遍历序列（如 `..%252f`）的 URL，向 JobManager 的特定端点（`/jobmanager/logs`）发送 HTTP GET 请求。提供的POC代码使用Cheetah语言编写，通过读取ip.txt文件中的IP地址列表，批量发送构造好的HTTP请求，检测目标是否存在漏洞，并通过判断响应内容中是否包含"root"字符串来验证/etc/passwd文件是否读取成功。虽然POC本身功能是验证漏洞，但脚本设计上存在潜在投毒风险：1. ip.txt文件可能被替换为包含恶意IP地址的列表，导致扫描行为扩散； 2. 读取到的文件内容可能会被上传到恶意服务器，导致信息泄露。根据代码文件和说明文档的分析,认为主要功能为漏洞探测,但存在小概率的潜在利用可能,因此判断投毒风险为10%。

**项目地址:** [givemefivw/CVE-2020-17519](https://github.com/givemefivw/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #8

**来源**: [CVE-2020-17519-murataydemir_CVE-2020-17519.md](../2020/CVE-2020-17519-murataydemir_CVE-2020-17519.md)

## CVE-2020-17519 - Apache Flink RESTful API 任意文件读取

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要 Flink JobManager 进程的 REST 接口对外暴露，且攻击者能访问该接口。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-17519 漏洞存在于 Apache Flink 1.11.0 到 1.11.2 版本中。该漏洞允许未经身份验证的攻击者通过 JobManager 的 RESTful API 读取 JobManager 进程本地文件系统上的任意文件。漏洞原因是 `JobManagerCustomLogHandler.java` 类中的代码未对用户提供的文件名进行充分的验证和过滤，导致目录遍历漏洞。PoC 中构造了包含 `..%252f` 的恶意请求，绕过路径检查，读取 `/etc/passwd` 文件。修复方法是在获取文件名时，仅取文件名部分，避免目录遍历。

**有效性：** 提供的 PoC 代码有效。多个来源（漏洞库信息、搜索引擎结果和漏洞利用代码）都表明该漏洞是可利用的，并且提供了可用的 PoC。CISA的KEV目录收录了该漏洞,表明该漏洞在野外被利用。

**投毒风险：** 仓库主要包含漏洞描述、受影响的版本、PoC 示例和修复方案说明。没有发现恶意代码，如反弹 shell、下载执行等。漏洞利用代码本身是对漏洞的重现，其目的是证明漏洞的存在。考虑到代码简洁、目标明确、以及缺乏隐藏的恶意行为，投毒风险极低。此仓库中检测到作者隐藏投毒代码的风险小于1%。

**利用方式：** 攻击者通过构造包含目录遍历字符（`..%252f`）的 HTTP GET 请求，发送到 Flink JobManager 的 RESTful API 接口 `/jobmanager/logs/{filename}`。由于服务端未对 `{filename}` 参数进行严格的校验，攻击者可以利用该参数读取 JobManager 进程可访问的任意文件，例如配置文件、系统文件等。攻击需要具备网络可达性。

**项目地址:** [murataydemir/CVE-2020-17519](https://github.com/murataydemir/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #9

**来源**: [CVE-2020-17519-radbsie_CVE-2020-17519-Exp.md](../2020/CVE-2020-17519-radbsie_CVE-2020-17519-Exp.md)

## CVE-2020-17519-Apache Flink-目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要目标Flink实例暴露REST API且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可以访问的本地文件系统上的任何文件，利用方式如下：

1.  **漏洞描述：** 由于 Apache Flink 在处理 REST API 请求时，没有充分过滤目录遍历字符，导致攻击者可以通过构造包含 `..%252f` 的恶意 URL 来访问系统上的任意文件。
2.  **POC有效性：** 提供的 Go 代码通过向目标 Flink JobManager 的 REST API 发送包含目录遍历payload的GET请求来验证漏洞是否存在。该POC通过检查响应体中是否存在类似 `root` 等关键字判断是否成功读取 `/etc/passwd` 文件，如果存在且状态码为200则判断目标存在漏洞，因此POC代码有效。
3.  **投毒风险：** 提供的EXP代码主要功能是通过目录遍历漏洞读取目标服务器上的文件，没有发现任何恶意或隐藏的投毒代码，因此投毒风险为0%。
4.  **利用方式：**
    *   攻击者构造包含目录遍历字符的 URL，例如：`/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
    *   攻击者将构造好的 URL 发送到目标 Flink JobManager 的 REST API。
    *   如果目标 Flink 版本在受影响范围内，且 JobManager 进程对目标文件具有读取权限，则攻击者可以成功读取该文件。
    *   通过读取敏感配置文件等，攻击者可以获取更多信息，为进一步攻击做准备。

从CISA的信息来看，该漏洞已经被积极利用，需要引起重视。

**项目地址:** [radbsie/CVE-2020-17519-Exp](https://github.com/radbsie/CVE-2020-17519-Exp)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #10

**来源**: [CVE-2020-17519-shoucheng3_apache__flink_CVE-2020-17519_1-11-2.md](../2020/CVE-2020-17519-shoucheng3_apache__flink_CVE-2020-17519_1-11-2.md)

## CVE-2020-17519-Apache Flink-目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager进程的REST接口可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。该漏洞允许未经身份验证的攻击者通过 JobManager 进程的 REST 接口读取 JobManager 进程有权访问的本地文件系统上的任何文件。漏洞利用方式是发送包含目录遍历序列（例如 `../`）的特制 HTTP 请求到REST接口，从而读取任意文件。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞存在已知的公开利用方法，并且已被添加到 CISA 的 KEV 目录中，表明该漏洞利用的有效性较高。

**投毒风险：**
提供的漏洞利用代码仅包含Apache许可证，没有任何恶意代码或后门，因此投毒风险为0%。

**利用方式：**
1.  确定目标 Flink JobManager 的 REST 接口地址。
2.  构造包含目录遍历序列的 HTTP GET 请求，例如：
    `GET /..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd HTTP/1.1` (URL编码的`../`)
3.  发送该请求到 Flink JobManager 的 REST 接口。
4.  如果漏洞存在，服务器将返回 `/etc/passwd` 文件的内容（或其他被请求的文件）。需要注意的是，攻击者只能访问 JobManager 进程有权访问的文件。

**项目地址:** [shoucheng3/apache__flink_CVE-2020-17519_1-11-2](https://github.com/shoucheng3/apache__flink_CVE-2020-17519_1-11-2)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #11

**来源**: [CVE-2020-17519-yaunsky_CVE-2020-17519-Apache-Flink.md](../2020/CVE-2020-17519-yaunsky_CVE-2020-17519-Apache-Flink.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager REST API 暴露在外网或可被访问的网络环境。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中存在的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可以访问的本地文件系统上的任何文件。\n\n**有效性：**\n
根据漏洞信息和搜索引擎结果，此漏洞利用是有效的。多个来源表明该漏洞已被积极利用，并且CISA已将其添加到已知被利用漏洞目录中。提供的POC代码尝试通过构造包含目录遍历序列的 URL 来读取 `/etc/passwd` 文件，这符合漏洞描述。POC 中 URL 编码 `%252f`是双重编码`/`，目的是绕过一些安全机制。\n\n**投毒风险：**\n
分析提供的 Python 脚本 `CVE-2020-17519.py` 以及相关文件, 发现并没有明显的恶意代码或后门。脚本的功能主要是发送 HTTP 请求到目标 Flink JobManager 实例，利用目录遍历漏洞读取文件。脚本代码相对简单，只实现了漏洞验证的功能, 投毒风险评估为0%。\n\n**利用方式：**\n
1.  **确定目标：** 找到运行 Apache Flink 1.11.0 到 1.11.2 版本的 JobManager 实例，并且该实例的 REST API 可以通过网络访问。
2.  **构造恶意 URL：** 构造包含目录遍历序列的 URL，例如 `/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`，尝试读取目标文件。
3.  **发送请求：** 使用 HTTP GET 请求将构造的 URL 发送到 JobManager 的 REST API。
4.  **分析响应：** 如果服务器返回目标文件的内容，则表明漏洞存在。\n\n**缓解措施：**\n
*   升级到 Apache Flink 1.11.3 或 1.12.0 及以上版本。
*   限制对 JobManager REST API 的访问。

**项目地址:** [yaunsky/CVE-2020-17519-Apache-Flink](https://github.com/yaunsky/CVE-2020-17519-Apache-Flink)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #12

**来源**: [CVE-2020-17519-zhangweijie11_CVE-2020-17519.md](../2020/CVE-2020-17519-zhangweijie11_CVE-2020-17519.md)

## CVE-2020-17519-Apache Flink目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager的REST接口对外开放且运行在受影响版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中存在的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口，利用目录遍历读取 JobManager 进程可以访问的本地文件系统上的任意文件。 

**有效性：**

提供的 POC 代码有效。它通过构造包含 `..%252f` (双重URL编码的 `../`) 的恶意 URL 发送 HTTP GET 请求到 `/jobmanager/logs/` 路径，尝试读取 `/etc/passwd` 文件。如果服务器返回状态码 200 且响应内容包含 `root:x`，则确认漏洞存在。

**投毒风险：**

提供的 POC 代码未发现明显的投毒代码。代码功能简单，仅用于验证漏洞是否存在，没有执行恶意操作或安装后门。该仓库的作者没有隐藏任何投毒代码, 投毒风险为 0%。

**利用方式：**

1.  确定目标 Apache Flink JobManager 的 REST 接口 URL。
2.  构造包含目录遍历的 URL，例如：`http://<target_url>/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
3.  发送 HTTP GET 请求到构造的 URL。
4.  如果服务器返回状态码 200 且响应内容为目标文件内容，则漏洞利用成功。请注意JobManager进程的权限决定了能够读取的文件。

**项目地址:** [zhangweijie11/CVE-2020-17519](https://github.com/zhangweijie11/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---



---

## POC #5

**来源**: [CVE-2020-17519-dev-team-12x_CVE-2020-17519.md](../2020/CVE-2020-17519-dev-team-12x_CVE-2020-17519.md)

## CVE-2020-17519 - Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历/文件读取

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要目标Flink JobManager的REST接口对外开放且版本为受影响版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519是Apache Flink 1.11.0到1.11.2版本中的一个目录遍历漏洞。攻击者可以通过构造特殊的URL，利用JobManager的REST接口读取JobManager进程有权访问的本地文件系统上的任意文件。该漏洞无需身份验证即可利用。利用方式如下：

1.  确定目标Flink JobManager的REST接口地址和端口。
2.  构造包含目录遍历字符的URL，例如`http://<flink_jobmanager_host>:<flink_jobmanager_port>/jobmanager/logs/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc/passwd`，其中`..%2F`用于向上遍历目录。
3.  发送HTTP GET请求到构造的URL。
4.  如果目标存在漏洞，服务器将返回请求的文件内容。

根据提供的Metasploit模块`auxiliary/scanner/http/apache_flink_file_read`，攻击者可以通过设置`RHOSTS`（目标主机）、`RPORT`（目标端口）、`FILEPATH`（要读取的文件路径）和`DEPTH`（目录遍历深度）来利用该漏洞。提供的代码示例演示了如何读取`/etc/passwd`文件。

分析提供的POC代码，没有发现明显的投毒代码。该代码的功能仅限于扫描和利用已知的目录遍历漏洞来读取文件。所有操作都旨在利用漏洞，不存在额外植入后门或恶意行为的逻辑。

**项目地址:** [dev-team-12x/CVE-2020-17519](https://github.com/dev-team-12x/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #6

**来源**: [CVE-2020-17519-dolevf_apache-flink-directory-traversal.nse.md](../2020/CVE-2020-17519-dolevf_apache-flink-directory-traversal.nse.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可读取JobManager进程可访问的任意文件

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要Flink JobManager的REST接口暴露在外网或内网，且目标版本在1.11.0到1.11.2之间。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2020-17519是Apache Flink 1.11.0到1.11.2版本中存在的一个目录遍历漏洞。攻击者可以通过JobManager的REST接口，利用`..%252f`进行URL编码后的目录穿越，读取JobManager进程有权访问的服务器本地文件。CISA已将此漏洞添加到已知被利用漏洞目录中，表明该漏洞正在被积极利用。

提供的Nmap脚本`apache-flink-traversal.nse`通过构造特定的HTTP GET请求，尝试读取`/etc/passwd`文件来验证漏洞是否存在。具体来说，它发送请求到`/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`，如果服务器返回状态码200且响应体中包含`root:x:0:0`，则认为目标服务器存在漏洞。

**有效性：**
POC代码有效，它通过构造恶意的URL来读取敏感文件，是检测漏洞的常见方法。

**投毒风险：**
查看了提供的Nmap脚本内容，该脚本的主要功能是检测目标主机是否存在CVE-2020-17519漏洞，通过发送包含目录遍历payload的HTTP请求到目标Flink JobManager的REST API端点，并检查响应内容是否包含`/etc/passwd`文件的内容，从而判断是否存在漏洞。未发现作者隐藏的恶意代码或后门。
虽然此脚本本身的功能是检查漏洞，但使用者可能会利用此漏洞来获取服务器上的敏感信息，这属于漏洞利用行为，而非POC投毒。因此，投毒风险评估为0%。

**利用方式：**
1.  确定目标Apache Flink的版本是否在受影响的范围内（1.11.0 to 1.11.2）。
2.  使用Nmap脚本或手动构造包含目录遍历payload的HTTP GET请求，发送到JobManager的REST接口。
3.  通过REST接口发送请求`/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
4.  如果服务器返回状态码200，并且响应体包含`/etc/passwd`的内容，则表明漏洞存在，可以进一步利用该漏洞读取其他文件。
5.  利用该漏洞读取JobManager进程可访问的任何本地文件，例如配置文件、密钥等。

**项目地址:** [dolevf/apache-flink-directory-traversal.nse](https://github.com/dolevf/apache-flink-directory-traversal.nse)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #7

**来源**: [CVE-2020-17519-givemefivw_CVE-2020-17519.md](../2020/CVE-2020-17519-givemefivw_CVE-2020-17519.md)

## CVE-2020-17519 Apache Flink 任意文件读取

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历/文件读取

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager REST API 端口对外开放，且目标为受影响版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17519 是一个 Apache Flink 中的目录遍历漏洞，存在于 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 进程的 REST 接口读取 JobManager 进程可访问的本地文件系统上的任何文件，无需身份验证。利用方式是通过构造包含目录遍历序列（如 `..%252f`）的 URL，向 JobManager 的特定端点（`/jobmanager/logs`）发送 HTTP GET 请求。提供的POC代码使用Cheetah语言编写，通过读取ip.txt文件中的IP地址列表，批量发送构造好的HTTP请求，检测目标是否存在漏洞，并通过判断响应内容中是否包含"root"字符串来验证/etc/passwd文件是否读取成功。虽然POC本身功能是验证漏洞，但脚本设计上存在潜在投毒风险：1. ip.txt文件可能被替换为包含恶意IP地址的列表，导致扫描行为扩散； 2. 读取到的文件内容可能会被上传到恶意服务器，导致信息泄露。根据代码文件和说明文档的分析,认为主要功能为漏洞探测,但存在小概率的潜在利用可能,因此判断投毒风险为10%。

**项目地址:** [givemefivw/CVE-2020-17519](https://github.com/givemefivw/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #8

**来源**: [CVE-2020-17519-murataydemir_CVE-2020-17519.md](../2020/CVE-2020-17519-murataydemir_CVE-2020-17519.md)

## CVE-2020-17519 - Apache Flink RESTful API 任意文件读取

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要 Flink JobManager 进程的 REST 接口对外暴露，且攻击者能访问该接口。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-17519 漏洞存在于 Apache Flink 1.11.0 到 1.11.2 版本中。该漏洞允许未经身份验证的攻击者通过 JobManager 的 RESTful API 读取 JobManager 进程本地文件系统上的任意文件。漏洞原因是 `JobManagerCustomLogHandler.java` 类中的代码未对用户提供的文件名进行充分的验证和过滤，导致目录遍历漏洞。PoC 中构造了包含 `..%252f` 的恶意请求，绕过路径检查，读取 `/etc/passwd` 文件。修复方法是在获取文件名时，仅取文件名部分，避免目录遍历。

**有效性：** 提供的 PoC 代码有效。多个来源（漏洞库信息、搜索引擎结果和漏洞利用代码）都表明该漏洞是可利用的，并且提供了可用的 PoC。CISA的KEV目录收录了该漏洞,表明该漏洞在野外被利用。

**投毒风险：** 仓库主要包含漏洞描述、受影响的版本、PoC 示例和修复方案说明。没有发现恶意代码，如反弹 shell、下载执行等。漏洞利用代码本身是对漏洞的重现，其目的是证明漏洞的存在。考虑到代码简洁、目标明确、以及缺乏隐藏的恶意行为，投毒风险极低。此仓库中检测到作者隐藏投毒代码的风险小于1%。

**利用方式：** 攻击者通过构造包含目录遍历字符（`..%252f`）的 HTTP GET 请求，发送到 Flink JobManager 的 RESTful API 接口 `/jobmanager/logs/{filename}`。由于服务端未对 `{filename}` 参数进行严格的校验，攻击者可以利用该参数读取 JobManager 进程可访问的任意文件，例如配置文件、系统文件等。攻击需要具备网络可达性。

**项目地址:** [murataydemir/CVE-2020-17519](https://github.com/murataydemir/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #9

**来源**: [CVE-2020-17519-radbsie_CVE-2020-17519-Exp.md](../2020/CVE-2020-17519-radbsie_CVE-2020-17519-Exp.md)

## CVE-2020-17519-Apache Flink-目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要目标Flink实例暴露REST API且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可以访问的本地文件系统上的任何文件，利用方式如下：

1.  **漏洞描述：** 由于 Apache Flink 在处理 REST API 请求时，没有充分过滤目录遍历字符，导致攻击者可以通过构造包含 `..%252f` 的恶意 URL 来访问系统上的任意文件。
2.  **POC有效性：** 提供的 Go 代码通过向目标 Flink JobManager 的 REST API 发送包含目录遍历payload的GET请求来验证漏洞是否存在。该POC通过检查响应体中是否存在类似 `root` 等关键字判断是否成功读取 `/etc/passwd` 文件，如果存在且状态码为200则判断目标存在漏洞，因此POC代码有效。
3.  **投毒风险：** 提供的EXP代码主要功能是通过目录遍历漏洞读取目标服务器上的文件，没有发现任何恶意或隐藏的投毒代码，因此投毒风险为0%。
4.  **利用方式：**
    *   攻击者构造包含目录遍历字符的 URL，例如：`/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
    *   攻击者将构造好的 URL 发送到目标 Flink JobManager 的 REST API。
    *   如果目标 Flink 版本在受影响范围内，且 JobManager 进程对目标文件具有读取权限，则攻击者可以成功读取该文件。
    *   通过读取敏感配置文件等，攻击者可以获取更多信息，为进一步攻击做准备。

从CISA的信息来看，该漏洞已经被积极利用，需要引起重视。

**项目地址:** [radbsie/CVE-2020-17519-Exp](https://github.com/radbsie/CVE-2020-17519-Exp)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #10

**来源**: [CVE-2020-17519-shoucheng3_apache__flink_CVE-2020-17519_1-11-2.md](../2020/CVE-2020-17519-shoucheng3_apache__flink_CVE-2020-17519_1-11-2.md)

## CVE-2020-17519-Apache Flink-目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager进程的REST接口可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。该漏洞允许未经身份验证的攻击者通过 JobManager 进程的 REST 接口读取 JobManager 进程有权访问的本地文件系统上的任何文件。漏洞利用方式是发送包含目录遍历序列（例如 `../`）的特制 HTTP 请求到REST接口，从而读取任意文件。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞存在已知的公开利用方法，并且已被添加到 CISA 的 KEV 目录中，表明该漏洞利用的有效性较高。

**投毒风险：**
提供的漏洞利用代码仅包含Apache许可证，没有任何恶意代码或后门，因此投毒风险为0%。

**利用方式：**
1.  确定目标 Flink JobManager 的 REST 接口地址。
2.  构造包含目录遍历序列的 HTTP GET 请求，例如：
    `GET /..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd HTTP/1.1` (URL编码的`../`)
3.  发送该请求到 Flink JobManager 的 REST 接口。
4.  如果漏洞存在，服务器将返回 `/etc/passwd` 文件的内容（或其他被请求的文件）。需要注意的是，攻击者只能访问 JobManager 进程有权访问的文件。

**项目地址:** [shoucheng3/apache__flink_CVE-2020-17519_1-11-2](https://github.com/shoucheng3/apache__flink_CVE-2020-17519_1-11-2)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #11

**来源**: [CVE-2020-17519-yaunsky_CVE-2020-17519-Apache-Flink.md](../2020/CVE-2020-17519-yaunsky_CVE-2020-17519-Apache-Flink.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager REST API 暴露在外网或可被访问的网络环境。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中存在的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可以访问的本地文件系统上的任何文件。\n\n**有效性：**\n
根据漏洞信息和搜索引擎结果，此漏洞利用是有效的。多个来源表明该漏洞已被积极利用，并且CISA已将其添加到已知被利用漏洞目录中。提供的POC代码尝试通过构造包含目录遍历序列的 URL 来读取 `/etc/passwd` 文件，这符合漏洞描述。POC 中 URL 编码 `%252f`是双重编码`/`，目的是绕过一些安全机制。\n\n**投毒风险：**\n
分析提供的 Python 脚本 `CVE-2020-17519.py` 以及相关文件, 发现并没有明显的恶意代码或后门。脚本的功能主要是发送 HTTP 请求到目标 Flink JobManager 实例，利用目录遍历漏洞读取文件。脚本代码相对简单，只实现了漏洞验证的功能, 投毒风险评估为0%。\n\n**利用方式：**\n
1.  **确定目标：** 找到运行 Apache Flink 1.11.0 到 1.11.2 版本的 JobManager 实例，并且该实例的 REST API 可以通过网络访问。
2.  **构造恶意 URL：** 构造包含目录遍历序列的 URL，例如 `/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`，尝试读取目标文件。
3.  **发送请求：** 使用 HTTP GET 请求将构造的 URL 发送到 JobManager 的 REST API。
4.  **分析响应：** 如果服务器返回目标文件的内容，则表明漏洞存在。\n\n**缓解措施：**\n
*   升级到 Apache Flink 1.11.3 或 1.12.0 及以上版本。
*   限制对 JobManager REST API 的访问。

**项目地址:** [yaunsky/CVE-2020-17519-Apache-Flink](https://github.com/yaunsky/CVE-2020-17519-Apache-Flink)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #12

**来源**: [CVE-2020-17519-zhangweijie11_CVE-2020-17519.md](../2020/CVE-2020-17519-zhangweijie11_CVE-2020-17519.md)

## CVE-2020-17519-Apache Flink目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager的REST接口对外开放且运行在受影响版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中存在的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口，利用目录遍历读取 JobManager 进程可以访问的本地文件系统上的任意文件。 

**有效性：**

提供的 POC 代码有效。它通过构造包含 `..%252f` (双重URL编码的 `../`) 的恶意 URL 发送 HTTP GET 请求到 `/jobmanager/logs/` 路径，尝试读取 `/etc/passwd` 文件。如果服务器返回状态码 200 且响应内容包含 `root:x`，则确认漏洞存在。

**投毒风险：**

提供的 POC 代码未发现明显的投毒代码。代码功能简单，仅用于验证漏洞是否存在，没有执行恶意操作或安装后门。该仓库的作者没有隐藏任何投毒代码, 投毒风险为 0%。

**利用方式：**

1.  确定目标 Apache Flink JobManager 的 REST 接口 URL。
2.  构造包含目录遍历的 URL，例如：`http://<target_url>/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
3.  发送 HTTP GET 请求到构造的 URL。
4.  如果服务器返回状态码 200 且响应内容为目标文件内容，则漏洞利用成功。请注意JobManager进程的权限决定了能够读取的文件。

**项目地址:** [zhangweijie11/CVE-2020-17519](https://github.com/zhangweijie11/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---



---

## POC #5

**来源**: [CVE-2020-17519-dev-team-12x_CVE-2020-17519.md](../2020/CVE-2020-17519-dev-team-12x_CVE-2020-17519.md)

## CVE-2020-17519 - Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历/文件读取

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要目标Flink JobManager的REST接口对外开放且版本为受影响版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519是Apache Flink 1.11.0到1.11.2版本中的一个目录遍历漏洞。攻击者可以通过构造特殊的URL，利用JobManager的REST接口读取JobManager进程有权访问的本地文件系统上的任意文件。该漏洞无需身份验证即可利用。利用方式如下：

1.  确定目标Flink JobManager的REST接口地址和端口。
2.  构造包含目录遍历字符的URL，例如`http://<flink_jobmanager_host>:<flink_jobmanager_port>/jobmanager/logs/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc/passwd`，其中`..%2F`用于向上遍历目录。
3.  发送HTTP GET请求到构造的URL。
4.  如果目标存在漏洞，服务器将返回请求的文件内容。

根据提供的Metasploit模块`auxiliary/scanner/http/apache_flink_file_read`，攻击者可以通过设置`RHOSTS`（目标主机）、`RPORT`（目标端口）、`FILEPATH`（要读取的文件路径）和`DEPTH`（目录遍历深度）来利用该漏洞。提供的代码示例演示了如何读取`/etc/passwd`文件。

分析提供的POC代码，没有发现明显的投毒代码。该代码的功能仅限于扫描和利用已知的目录遍历漏洞来读取文件。所有操作都旨在利用漏洞，不存在额外植入后门或恶意行为的逻辑。

**项目地址:** [dev-team-12x/CVE-2020-17519](https://github.com/dev-team-12x/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #6

**来源**: [CVE-2020-17519-dolevf_apache-flink-directory-traversal.nse.md](../2020/CVE-2020-17519-dolevf_apache-flink-directory-traversal.nse.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可读取JobManager进程可访问的任意文件

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要Flink JobManager的REST接口暴露在外网或内网，且目标版本在1.11.0到1.11.2之间。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2020-17519是Apache Flink 1.11.0到1.11.2版本中存在的一个目录遍历漏洞。攻击者可以通过JobManager的REST接口，利用`..%252f`进行URL编码后的目录穿越，读取JobManager进程有权访问的服务器本地文件。CISA已将此漏洞添加到已知被利用漏洞目录中，表明该漏洞正在被积极利用。

提供的Nmap脚本`apache-flink-traversal.nse`通过构造特定的HTTP GET请求，尝试读取`/etc/passwd`文件来验证漏洞是否存在。具体来说，它发送请求到`/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`，如果服务器返回状态码200且响应体中包含`root:x:0:0`，则认为目标服务器存在漏洞。

**有效性：**
POC代码有效，它通过构造恶意的URL来读取敏感文件，是检测漏洞的常见方法。

**投毒风险：**
查看了提供的Nmap脚本内容，该脚本的主要功能是检测目标主机是否存在CVE-2020-17519漏洞，通过发送包含目录遍历payload的HTTP请求到目标Flink JobManager的REST API端点，并检查响应内容是否包含`/etc/passwd`文件的内容，从而判断是否存在漏洞。未发现作者隐藏的恶意代码或后门。
虽然此脚本本身的功能是检查漏洞，但使用者可能会利用此漏洞来获取服务器上的敏感信息，这属于漏洞利用行为，而非POC投毒。因此，投毒风险评估为0%。

**利用方式：**
1.  确定目标Apache Flink的版本是否在受影响的范围内（1.11.0 to 1.11.2）。
2.  使用Nmap脚本或手动构造包含目录遍历payload的HTTP GET请求，发送到JobManager的REST接口。
3.  通过REST接口发送请求`/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
4.  如果服务器返回状态码200，并且响应体包含`/etc/passwd`的内容，则表明漏洞存在，可以进一步利用该漏洞读取其他文件。
5.  利用该漏洞读取JobManager进程可访问的任何本地文件，例如配置文件、密钥等。

**项目地址:** [dolevf/apache-flink-directory-traversal.nse](https://github.com/dolevf/apache-flink-directory-traversal.nse)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #7

**来源**: [CVE-2020-17519-givemefivw_CVE-2020-17519.md](../2020/CVE-2020-17519-givemefivw_CVE-2020-17519.md)

## CVE-2020-17519 Apache Flink 任意文件读取

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历/文件读取

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager REST API 端口对外开放，且目标为受影响版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17519 是一个 Apache Flink 中的目录遍历漏洞，存在于 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 进程的 REST 接口读取 JobManager 进程可访问的本地文件系统上的任何文件，无需身份验证。利用方式是通过构造包含目录遍历序列（如 `..%252f`）的 URL，向 JobManager 的特定端点（`/jobmanager/logs`）发送 HTTP GET 请求。提供的POC代码使用Cheetah语言编写，通过读取ip.txt文件中的IP地址列表，批量发送构造好的HTTP请求，检测目标是否存在漏洞，并通过判断响应内容中是否包含"root"字符串来验证/etc/passwd文件是否读取成功。虽然POC本身功能是验证漏洞，但脚本设计上存在潜在投毒风险：1. ip.txt文件可能被替换为包含恶意IP地址的列表，导致扫描行为扩散； 2. 读取到的文件内容可能会被上传到恶意服务器，导致信息泄露。根据代码文件和说明文档的分析,认为主要功能为漏洞探测,但存在小概率的潜在利用可能,因此判断投毒风险为10%。

**项目地址:** [givemefivw/CVE-2020-17519](https://github.com/givemefivw/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #8

**来源**: [CVE-2020-17519-murataydemir_CVE-2020-17519.md](../2020/CVE-2020-17519-murataydemir_CVE-2020-17519.md)

## CVE-2020-17519 - Apache Flink RESTful API 任意文件读取

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要 Flink JobManager 进程的 REST 接口对外暴露，且攻击者能访问该接口。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-17519 漏洞存在于 Apache Flink 1.11.0 到 1.11.2 版本中。该漏洞允许未经身份验证的攻击者通过 JobManager 的 RESTful API 读取 JobManager 进程本地文件系统上的任意文件。漏洞原因是 `JobManagerCustomLogHandler.java` 类中的代码未对用户提供的文件名进行充分的验证和过滤，导致目录遍历漏洞。PoC 中构造了包含 `..%252f` 的恶意请求，绕过路径检查，读取 `/etc/passwd` 文件。修复方法是在获取文件名时，仅取文件名部分，避免目录遍历。

**有效性：** 提供的 PoC 代码有效。多个来源（漏洞库信息、搜索引擎结果和漏洞利用代码）都表明该漏洞是可利用的，并且提供了可用的 PoC。CISA的KEV目录收录了该漏洞,表明该漏洞在野外被利用。

**投毒风险：** 仓库主要包含漏洞描述、受影响的版本、PoC 示例和修复方案说明。没有发现恶意代码，如反弹 shell、下载执行等。漏洞利用代码本身是对漏洞的重现，其目的是证明漏洞的存在。考虑到代码简洁、目标明确、以及缺乏隐藏的恶意行为，投毒风险极低。此仓库中检测到作者隐藏投毒代码的风险小于1%。

**利用方式：** 攻击者通过构造包含目录遍历字符（`..%252f`）的 HTTP GET 请求，发送到 Flink JobManager 的 RESTful API 接口 `/jobmanager/logs/{filename}`。由于服务端未对 `{filename}` 参数进行严格的校验，攻击者可以利用该参数读取 JobManager 进程可访问的任意文件，例如配置文件、系统文件等。攻击需要具备网络可达性。

**项目地址:** [murataydemir/CVE-2020-17519](https://github.com/murataydemir/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #9

**来源**: [CVE-2020-17519-radbsie_CVE-2020-17519-Exp.md](../2020/CVE-2020-17519-radbsie_CVE-2020-17519-Exp.md)

## CVE-2020-17519-Apache Flink-目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要目标Flink实例暴露REST API且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可以访问的本地文件系统上的任何文件，利用方式如下：

1.  **漏洞描述：** 由于 Apache Flink 在处理 REST API 请求时，没有充分过滤目录遍历字符，导致攻击者可以通过构造包含 `..%252f` 的恶意 URL 来访问系统上的任意文件。
2.  **POC有效性：** 提供的 Go 代码通过向目标 Flink JobManager 的 REST API 发送包含目录遍历payload的GET请求来验证漏洞是否存在。该POC通过检查响应体中是否存在类似 `root` 等关键字判断是否成功读取 `/etc/passwd` 文件，如果存在且状态码为200则判断目标存在漏洞，因此POC代码有效。
3.  **投毒风险：** 提供的EXP代码主要功能是通过目录遍历漏洞读取目标服务器上的文件，没有发现任何恶意或隐藏的投毒代码，因此投毒风险为0%。
4.  **利用方式：**
    *   攻击者构造包含目录遍历字符的 URL，例如：`/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
    *   攻击者将构造好的 URL 发送到目标 Flink JobManager 的 REST API。
    *   如果目标 Flink 版本在受影响范围内，且 JobManager 进程对目标文件具有读取权限，则攻击者可以成功读取该文件。
    *   通过读取敏感配置文件等，攻击者可以获取更多信息，为进一步攻击做准备。

从CISA的信息来看，该漏洞已经被积极利用，需要引起重视。

**项目地址:** [radbsie/CVE-2020-17519-Exp](https://github.com/radbsie/CVE-2020-17519-Exp)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #10

**来源**: [CVE-2020-17519-shoucheng3_apache__flink_CVE-2020-17519_1-11-2.md](../2020/CVE-2020-17519-shoucheng3_apache__flink_CVE-2020-17519_1-11-2.md)

## CVE-2020-17519-Apache Flink-目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager进程的REST接口可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。该漏洞允许未经身份验证的攻击者通过 JobManager 进程的 REST 接口读取 JobManager 进程有权访问的本地文件系统上的任何文件。漏洞利用方式是发送包含目录遍历序列（例如 `../`）的特制 HTTP 请求到REST接口，从而读取任意文件。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞存在已知的公开利用方法，并且已被添加到 CISA 的 KEV 目录中，表明该漏洞利用的有效性较高。

**投毒风险：**
提供的漏洞利用代码仅包含Apache许可证，没有任何恶意代码或后门，因此投毒风险为0%。

**利用方式：**
1.  确定目标 Flink JobManager 的 REST 接口地址。
2.  构造包含目录遍历序列的 HTTP GET 请求，例如：
    `GET /..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd HTTP/1.1` (URL编码的`../`)
3.  发送该请求到 Flink JobManager 的 REST 接口。
4.  如果漏洞存在，服务器将返回 `/etc/passwd` 文件的内容（或其他被请求的文件）。需要注意的是，攻击者只能访问 JobManager 进程有权访问的文件。

**项目地址:** [shoucheng3/apache__flink_CVE-2020-17519_1-11-2](https://github.com/shoucheng3/apache__flink_CVE-2020-17519_1-11-2)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #11

**来源**: [CVE-2020-17519-yaunsky_CVE-2020-17519-Apache-Flink.md](../2020/CVE-2020-17519-yaunsky_CVE-2020-17519-Apache-Flink.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager REST API 暴露在外网或可被访问的网络环境。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中存在的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可以访问的本地文件系统上的任何文件。\n\n**有效性：**\n
根据漏洞信息和搜索引擎结果，此漏洞利用是有效的。多个来源表明该漏洞已被积极利用，并且CISA已将其添加到已知被利用漏洞目录中。提供的POC代码尝试通过构造包含目录遍历序列的 URL 来读取 `/etc/passwd` 文件，这符合漏洞描述。POC 中 URL 编码 `%252f`是双重编码`/`，目的是绕过一些安全机制。\n\n**投毒风险：**\n
分析提供的 Python 脚本 `CVE-2020-17519.py` 以及相关文件, 发现并没有明显的恶意代码或后门。脚本的功能主要是发送 HTTP 请求到目标 Flink JobManager 实例，利用目录遍历漏洞读取文件。脚本代码相对简单，只实现了漏洞验证的功能, 投毒风险评估为0%。\n\n**利用方式：**\n
1.  **确定目标：** 找到运行 Apache Flink 1.11.0 到 1.11.2 版本的 JobManager 实例，并且该实例的 REST API 可以通过网络访问。
2.  **构造恶意 URL：** 构造包含目录遍历序列的 URL，例如 `/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`，尝试读取目标文件。
3.  **发送请求：** 使用 HTTP GET 请求将构造的 URL 发送到 JobManager 的 REST API。
4.  **分析响应：** 如果服务器返回目标文件的内容，则表明漏洞存在。\n\n**缓解措施：**\n
*   升级到 Apache Flink 1.11.3 或 1.12.0 及以上版本。
*   限制对 JobManager REST API 的访问。

**项目地址:** [yaunsky/CVE-2020-17519-Apache-Flink](https://github.com/yaunsky/CVE-2020-17519-Apache-Flink)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #12

**来源**: [CVE-2020-17519-zhangweijie11_CVE-2020-17519.md](../2020/CVE-2020-17519-zhangweijie11_CVE-2020-17519.md)

## CVE-2020-17519-Apache Flink目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager的REST接口对外开放且运行在受影响版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中存在的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口，利用目录遍历读取 JobManager 进程可以访问的本地文件系统上的任意文件。 

**有效性：**

提供的 POC 代码有效。它通过构造包含 `..%252f` (双重URL编码的 `../`) 的恶意 URL 发送 HTTP GET 请求到 `/jobmanager/logs/` 路径，尝试读取 `/etc/passwd` 文件。如果服务器返回状态码 200 且响应内容包含 `root:x`，则确认漏洞存在。

**投毒风险：**

提供的 POC 代码未发现明显的投毒代码。代码功能简单，仅用于验证漏洞是否存在，没有执行恶意操作或安装后门。该仓库的作者没有隐藏任何投毒代码, 投毒风险为 0%。

**利用方式：**

1.  确定目标 Apache Flink JobManager 的 REST 接口 URL。
2.  构造包含目录遍历的 URL，例如：`http://<target_url>/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
3.  发送 HTTP GET 请求到构造的 URL。
4.  如果服务器返回状态码 200 且响应内容为目标文件内容，则漏洞利用成功。请注意JobManager进程的权限决定了能够读取的文件。

**项目地址:** [zhangweijie11/CVE-2020-17519](https://github.com/zhangweijie11/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---



---

## POC #5

**来源**: [CVE-2020-17519-dev-team-12x_CVE-2020-17519.md](../2020/CVE-2020-17519-dev-team-12x_CVE-2020-17519.md)

## CVE-2020-17519 - Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历/文件读取

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要目标Flink JobManager的REST接口对外开放且版本为受影响版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519是Apache Flink 1.11.0到1.11.2版本中的一个目录遍历漏洞。攻击者可以通过构造特殊的URL，利用JobManager的REST接口读取JobManager进程有权访问的本地文件系统上的任意文件。该漏洞无需身份验证即可利用。利用方式如下：

1.  确定目标Flink JobManager的REST接口地址和端口。
2.  构造包含目录遍历字符的URL，例如`http://<flink_jobmanager_host>:<flink_jobmanager_port>/jobmanager/logs/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc/passwd`，其中`..%2F`用于向上遍历目录。
3.  发送HTTP GET请求到构造的URL。
4.  如果目标存在漏洞，服务器将返回请求的文件内容。

根据提供的Metasploit模块`auxiliary/scanner/http/apache_flink_file_read`，攻击者可以通过设置`RHOSTS`（目标主机）、`RPORT`（目标端口）、`FILEPATH`（要读取的文件路径）和`DEPTH`（目录遍历深度）来利用该漏洞。提供的代码示例演示了如何读取`/etc/passwd`文件。

分析提供的POC代码，没有发现明显的投毒代码。该代码的功能仅限于扫描和利用已知的目录遍历漏洞来读取文件。所有操作都旨在利用漏洞，不存在额外植入后门或恶意行为的逻辑。

**项目地址:** [dev-team-12x/CVE-2020-17519](https://github.com/dev-team-12x/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #6

**来源**: [CVE-2020-17519-dolevf_apache-flink-directory-traversal.nse.md](../2020/CVE-2020-17519-dolevf_apache-flink-directory-traversal.nse.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可读取JobManager进程可访问的任意文件

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要Flink JobManager的REST接口暴露在外网或内网，且目标版本在1.11.0到1.11.2之间。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2020-17519是Apache Flink 1.11.0到1.11.2版本中存在的一个目录遍历漏洞。攻击者可以通过JobManager的REST接口，利用`..%252f`进行URL编码后的目录穿越，读取JobManager进程有权访问的服务器本地文件。CISA已将此漏洞添加到已知被利用漏洞目录中，表明该漏洞正在被积极利用。

提供的Nmap脚本`apache-flink-traversal.nse`通过构造特定的HTTP GET请求，尝试读取`/etc/passwd`文件来验证漏洞是否存在。具体来说，它发送请求到`/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`，如果服务器返回状态码200且响应体中包含`root:x:0:0`，则认为目标服务器存在漏洞。

**有效性：**
POC代码有效，它通过构造恶意的URL来读取敏感文件，是检测漏洞的常见方法。

**投毒风险：**
查看了提供的Nmap脚本内容，该脚本的主要功能是检测目标主机是否存在CVE-2020-17519漏洞，通过发送包含目录遍历payload的HTTP请求到目标Flink JobManager的REST API端点，并检查响应内容是否包含`/etc/passwd`文件的内容，从而判断是否存在漏洞。未发现作者隐藏的恶意代码或后门。
虽然此脚本本身的功能是检查漏洞，但使用者可能会利用此漏洞来获取服务器上的敏感信息，这属于漏洞利用行为，而非POC投毒。因此，投毒风险评估为0%。

**利用方式：**
1.  确定目标Apache Flink的版本是否在受影响的范围内（1.11.0 to 1.11.2）。
2.  使用Nmap脚本或手动构造包含目录遍历payload的HTTP GET请求，发送到JobManager的REST接口。
3.  通过REST接口发送请求`/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
4.  如果服务器返回状态码200，并且响应体包含`/etc/passwd`的内容，则表明漏洞存在，可以进一步利用该漏洞读取其他文件。
5.  利用该漏洞读取JobManager进程可访问的任何本地文件，例如配置文件、密钥等。

**项目地址:** [dolevf/apache-flink-directory-traversal.nse](https://github.com/dolevf/apache-flink-directory-traversal.nse)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #7

**来源**: [CVE-2020-17519-givemefivw_CVE-2020-17519.md](../2020/CVE-2020-17519-givemefivw_CVE-2020-17519.md)

## CVE-2020-17519 Apache Flink 任意文件读取

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历/文件读取

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager REST API 端口对外开放，且目标为受影响版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17519 是一个 Apache Flink 中的目录遍历漏洞，存在于 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 进程的 REST 接口读取 JobManager 进程可访问的本地文件系统上的任何文件，无需身份验证。利用方式是通过构造包含目录遍历序列（如 `..%252f`）的 URL，向 JobManager 的特定端点（`/jobmanager/logs`）发送 HTTP GET 请求。提供的POC代码使用Cheetah语言编写，通过读取ip.txt文件中的IP地址列表，批量发送构造好的HTTP请求，检测目标是否存在漏洞，并通过判断响应内容中是否包含"root"字符串来验证/etc/passwd文件是否读取成功。虽然POC本身功能是验证漏洞，但脚本设计上存在潜在投毒风险：1. ip.txt文件可能被替换为包含恶意IP地址的列表，导致扫描行为扩散； 2. 读取到的文件内容可能会被上传到恶意服务器，导致信息泄露。根据代码文件和说明文档的分析,认为主要功能为漏洞探测,但存在小概率的潜在利用可能,因此判断投毒风险为10%。

**项目地址:** [givemefivw/CVE-2020-17519](https://github.com/givemefivw/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #8

**来源**: [CVE-2020-17519-murataydemir_CVE-2020-17519.md](../2020/CVE-2020-17519-murataydemir_CVE-2020-17519.md)

## CVE-2020-17519 - Apache Flink RESTful API 任意文件读取

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要 Flink JobManager 进程的 REST 接口对外暴露，且攻击者能访问该接口。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-17519 漏洞存在于 Apache Flink 1.11.0 到 1.11.2 版本中。该漏洞允许未经身份验证的攻击者通过 JobManager 的 RESTful API 读取 JobManager 进程本地文件系统上的任意文件。漏洞原因是 `JobManagerCustomLogHandler.java` 类中的代码未对用户提供的文件名进行充分的验证和过滤，导致目录遍历漏洞。PoC 中构造了包含 `..%252f` 的恶意请求，绕过路径检查，读取 `/etc/passwd` 文件。修复方法是在获取文件名时，仅取文件名部分，避免目录遍历。

**有效性：** 提供的 PoC 代码有效。多个来源（漏洞库信息、搜索引擎结果和漏洞利用代码）都表明该漏洞是可利用的，并且提供了可用的 PoC。CISA的KEV目录收录了该漏洞,表明该漏洞在野外被利用。

**投毒风险：** 仓库主要包含漏洞描述、受影响的版本、PoC 示例和修复方案说明。没有发现恶意代码，如反弹 shell、下载执行等。漏洞利用代码本身是对漏洞的重现，其目的是证明漏洞的存在。考虑到代码简洁、目标明确、以及缺乏隐藏的恶意行为，投毒风险极低。此仓库中检测到作者隐藏投毒代码的风险小于1%。

**利用方式：** 攻击者通过构造包含目录遍历字符（`..%252f`）的 HTTP GET 请求，发送到 Flink JobManager 的 RESTful API 接口 `/jobmanager/logs/{filename}`。由于服务端未对 `{filename}` 参数进行严格的校验，攻击者可以利用该参数读取 JobManager 进程可访问的任意文件，例如配置文件、系统文件等。攻击需要具备网络可达性。

**项目地址:** [murataydemir/CVE-2020-17519](https://github.com/murataydemir/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #9

**来源**: [CVE-2020-17519-radbsie_CVE-2020-17519-Exp.md](../2020/CVE-2020-17519-radbsie_CVE-2020-17519-Exp.md)

## CVE-2020-17519-Apache Flink-目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要目标Flink实例暴露REST API且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可以访问的本地文件系统上的任何文件，利用方式如下：

1.  **漏洞描述：** 由于 Apache Flink 在处理 REST API 请求时，没有充分过滤目录遍历字符，导致攻击者可以通过构造包含 `..%252f` 的恶意 URL 来访问系统上的任意文件。
2.  **POC有效性：** 提供的 Go 代码通过向目标 Flink JobManager 的 REST API 发送包含目录遍历payload的GET请求来验证漏洞是否存在。该POC通过检查响应体中是否存在类似 `root` 等关键字判断是否成功读取 `/etc/passwd` 文件，如果存在且状态码为200则判断目标存在漏洞，因此POC代码有效。
3.  **投毒风险：** 提供的EXP代码主要功能是通过目录遍历漏洞读取目标服务器上的文件，没有发现任何恶意或隐藏的投毒代码，因此投毒风险为0%。
4.  **利用方式：**
    *   攻击者构造包含目录遍历字符的 URL，例如：`/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
    *   攻击者将构造好的 URL 发送到目标 Flink JobManager 的 REST API。
    *   如果目标 Flink 版本在受影响范围内，且 JobManager 进程对目标文件具有读取权限，则攻击者可以成功读取该文件。
    *   通过读取敏感配置文件等，攻击者可以获取更多信息，为进一步攻击做准备。

从CISA的信息来看，该漏洞已经被积极利用，需要引起重视。

**项目地址:** [radbsie/CVE-2020-17519-Exp](https://github.com/radbsie/CVE-2020-17519-Exp)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #10

**来源**: [CVE-2020-17519-shoucheng3_apache__flink_CVE-2020-17519_1-11-2.md](../2020/CVE-2020-17519-shoucheng3_apache__flink_CVE-2020-17519_1-11-2.md)

## CVE-2020-17519-Apache Flink-目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager进程的REST接口可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。该漏洞允许未经身份验证的攻击者通过 JobManager 进程的 REST 接口读取 JobManager 进程有权访问的本地文件系统上的任何文件。漏洞利用方式是发送包含目录遍历序列（例如 `../`）的特制 HTTP 请求到REST接口，从而读取任意文件。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞存在已知的公开利用方法，并且已被添加到 CISA 的 KEV 目录中，表明该漏洞利用的有效性较高。

**投毒风险：**
提供的漏洞利用代码仅包含Apache许可证，没有任何恶意代码或后门，因此投毒风险为0%。

**利用方式：**
1.  确定目标 Flink JobManager 的 REST 接口地址。
2.  构造包含目录遍历序列的 HTTP GET 请求，例如：
    `GET /..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd HTTP/1.1` (URL编码的`../`)
3.  发送该请求到 Flink JobManager 的 REST 接口。
4.  如果漏洞存在，服务器将返回 `/etc/passwd` 文件的内容（或其他被请求的文件）。需要注意的是，攻击者只能访问 JobManager 进程有权访问的文件。

**项目地址:** [shoucheng3/apache__flink_CVE-2020-17519_1-11-2](https://github.com/shoucheng3/apache__flink_CVE-2020-17519_1-11-2)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #11

**来源**: [CVE-2020-17519-yaunsky_CVE-2020-17519-Apache-Flink.md](../2020/CVE-2020-17519-yaunsky_CVE-2020-17519-Apache-Flink.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager REST API 暴露在外网或可被访问的网络环境。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中存在的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可以访问的本地文件系统上的任何文件。\n\n**有效性：**\n
根据漏洞信息和搜索引擎结果，此漏洞利用是有效的。多个来源表明该漏洞已被积极利用，并且CISA已将其添加到已知被利用漏洞目录中。提供的POC代码尝试通过构造包含目录遍历序列的 URL 来读取 `/etc/passwd` 文件，这符合漏洞描述。POC 中 URL 编码 `%252f`是双重编码`/`，目的是绕过一些安全机制。\n\n**投毒风险：**\n
分析提供的 Python 脚本 `CVE-2020-17519.py` 以及相关文件, 发现并没有明显的恶意代码或后门。脚本的功能主要是发送 HTTP 请求到目标 Flink JobManager 实例，利用目录遍历漏洞读取文件。脚本代码相对简单，只实现了漏洞验证的功能, 投毒风险评估为0%。\n\n**利用方式：**\n
1.  **确定目标：** 找到运行 Apache Flink 1.11.0 到 1.11.2 版本的 JobManager 实例，并且该实例的 REST API 可以通过网络访问。
2.  **构造恶意 URL：** 构造包含目录遍历序列的 URL，例如 `/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`，尝试读取目标文件。
3.  **发送请求：** 使用 HTTP GET 请求将构造的 URL 发送到 JobManager 的 REST API。
4.  **分析响应：** 如果服务器返回目标文件的内容，则表明漏洞存在。\n\n**缓解措施：**\n
*   升级到 Apache Flink 1.11.3 或 1.12.0 及以上版本。
*   限制对 JobManager REST API 的访问。

**项目地址:** [yaunsky/CVE-2020-17519-Apache-Flink](https://github.com/yaunsky/CVE-2020-17519-Apache-Flink)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #12

**来源**: [CVE-2020-17519-zhangweijie11_CVE-2020-17519.md](../2020/CVE-2020-17519-zhangweijie11_CVE-2020-17519.md)

## CVE-2020-17519-Apache Flink目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager的REST接口对外开放且运行在受影响版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中存在的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口，利用目录遍历读取 JobManager 进程可以访问的本地文件系统上的任意文件。 

**有效性：**

提供的 POC 代码有效。它通过构造包含 `..%252f` (双重URL编码的 `../`) 的恶意 URL 发送 HTTP GET 请求到 `/jobmanager/logs/` 路径，尝试读取 `/etc/passwd` 文件。如果服务器返回状态码 200 且响应内容包含 `root:x`，则确认漏洞存在。

**投毒风险：**

提供的 POC 代码未发现明显的投毒代码。代码功能简单，仅用于验证漏洞是否存在，没有执行恶意操作或安装后门。该仓库的作者没有隐藏任何投毒代码, 投毒风险为 0%。

**利用方式：**

1.  确定目标 Apache Flink JobManager 的 REST 接口 URL。
2.  构造包含目录遍历的 URL，例如：`http://<target_url>/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
3.  发送 HTTP GET 请求到构造的 URL。
4.  如果服务器返回状态码 200 且响应内容为目标文件内容，则漏洞利用成功。请注意JobManager进程的权限决定了能够读取的文件。

**项目地址:** [zhangweijie11/CVE-2020-17519](https://github.com/zhangweijie11/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---



---

## POC #5

**来源**: [CVE-2020-17519-dev-team-12x_CVE-2020-17519.md](../2020/CVE-2020-17519-dev-team-12x_CVE-2020-17519.md)

## CVE-2020-17519 - Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历/文件读取

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要目标Flink JobManager的REST接口对外开放且版本为受影响版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519是Apache Flink 1.11.0到1.11.2版本中的一个目录遍历漏洞。攻击者可以通过构造特殊的URL，利用JobManager的REST接口读取JobManager进程有权访问的本地文件系统上的任意文件。该漏洞无需身份验证即可利用。利用方式如下：

1.  确定目标Flink JobManager的REST接口地址和端口。
2.  构造包含目录遍历字符的URL，例如`http://<flink_jobmanager_host>:<flink_jobmanager_port>/jobmanager/logs/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc/passwd`，其中`..%2F`用于向上遍历目录。
3.  发送HTTP GET请求到构造的URL。
4.  如果目标存在漏洞，服务器将返回请求的文件内容。

根据提供的Metasploit模块`auxiliary/scanner/http/apache_flink_file_read`，攻击者可以通过设置`RHOSTS`（目标主机）、`RPORT`（目标端口）、`FILEPATH`（要读取的文件路径）和`DEPTH`（目录遍历深度）来利用该漏洞。提供的代码示例演示了如何读取`/etc/passwd`文件。

分析提供的POC代码，没有发现明显的投毒代码。该代码的功能仅限于扫描和利用已知的目录遍历漏洞来读取文件。所有操作都旨在利用漏洞，不存在额外植入后门或恶意行为的逻辑。

**项目地址:** [dev-team-12x/CVE-2020-17519](https://github.com/dev-team-12x/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #6

**来源**: [CVE-2020-17519-dolevf_apache-flink-directory-traversal.nse.md](../2020/CVE-2020-17519-dolevf_apache-flink-directory-traversal.nse.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可读取JobManager进程可访问的任意文件

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要Flink JobManager的REST接口暴露在外网或内网，且目标版本在1.11.0到1.11.2之间。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2020-17519是Apache Flink 1.11.0到1.11.2版本中存在的一个目录遍历漏洞。攻击者可以通过JobManager的REST接口，利用`..%252f`进行URL编码后的目录穿越，读取JobManager进程有权访问的服务器本地文件。CISA已将此漏洞添加到已知被利用漏洞目录中，表明该漏洞正在被积极利用。

提供的Nmap脚本`apache-flink-traversal.nse`通过构造特定的HTTP GET请求，尝试读取`/etc/passwd`文件来验证漏洞是否存在。具体来说，它发送请求到`/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`，如果服务器返回状态码200且响应体中包含`root:x:0:0`，则认为目标服务器存在漏洞。

**有效性：**
POC代码有效，它通过构造恶意的URL来读取敏感文件，是检测漏洞的常见方法。

**投毒风险：**
查看了提供的Nmap脚本内容，该脚本的主要功能是检测目标主机是否存在CVE-2020-17519漏洞，通过发送包含目录遍历payload的HTTP请求到目标Flink JobManager的REST API端点，并检查响应内容是否包含`/etc/passwd`文件的内容，从而判断是否存在漏洞。未发现作者隐藏的恶意代码或后门。
虽然此脚本本身的功能是检查漏洞，但使用者可能会利用此漏洞来获取服务器上的敏感信息，这属于漏洞利用行为，而非POC投毒。因此，投毒风险评估为0%。

**利用方式：**
1.  确定目标Apache Flink的版本是否在受影响的范围内（1.11.0 to 1.11.2）。
2.  使用Nmap脚本或手动构造包含目录遍历payload的HTTP GET请求，发送到JobManager的REST接口。
3.  通过REST接口发送请求`/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
4.  如果服务器返回状态码200，并且响应体包含`/etc/passwd`的内容，则表明漏洞存在，可以进一步利用该漏洞读取其他文件。
5.  利用该漏洞读取JobManager进程可访问的任何本地文件，例如配置文件、密钥等。

**项目地址:** [dolevf/apache-flink-directory-traversal.nse](https://github.com/dolevf/apache-flink-directory-traversal.nse)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #7

**来源**: [CVE-2020-17519-givemefivw_CVE-2020-17519.md](../2020/CVE-2020-17519-givemefivw_CVE-2020-17519.md)

## CVE-2020-17519 Apache Flink 任意文件读取

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历/文件读取

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager REST API 端口对外开放，且目标为受影响版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17519 是一个 Apache Flink 中的目录遍历漏洞，存在于 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 进程的 REST 接口读取 JobManager 进程可访问的本地文件系统上的任何文件，无需身份验证。利用方式是通过构造包含目录遍历序列（如 `..%252f`）的 URL，向 JobManager 的特定端点（`/jobmanager/logs`）发送 HTTP GET 请求。提供的POC代码使用Cheetah语言编写，通过读取ip.txt文件中的IP地址列表，批量发送构造好的HTTP请求，检测目标是否存在漏洞，并通过判断响应内容中是否包含"root"字符串来验证/etc/passwd文件是否读取成功。虽然POC本身功能是验证漏洞，但脚本设计上存在潜在投毒风险：1. ip.txt文件可能被替换为包含恶意IP地址的列表，导致扫描行为扩散； 2. 读取到的文件内容可能会被上传到恶意服务器，导致信息泄露。根据代码文件和说明文档的分析,认为主要功能为漏洞探测,但存在小概率的潜在利用可能,因此判断投毒风险为10%。

**项目地址:** [givemefivw/CVE-2020-17519](https://github.com/givemefivw/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #8

**来源**: [CVE-2020-17519-murataydemir_CVE-2020-17519.md](../2020/CVE-2020-17519-murataydemir_CVE-2020-17519.md)

## CVE-2020-17519 - Apache Flink RESTful API 任意文件读取

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要 Flink JobManager 进程的 REST 接口对外暴露，且攻击者能访问该接口。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-17519 漏洞存在于 Apache Flink 1.11.0 到 1.11.2 版本中。该漏洞允许未经身份验证的攻击者通过 JobManager 的 RESTful API 读取 JobManager 进程本地文件系统上的任意文件。漏洞原因是 `JobManagerCustomLogHandler.java` 类中的代码未对用户提供的文件名进行充分的验证和过滤，导致目录遍历漏洞。PoC 中构造了包含 `..%252f` 的恶意请求，绕过路径检查，读取 `/etc/passwd` 文件。修复方法是在获取文件名时，仅取文件名部分，避免目录遍历。

**有效性：** 提供的 PoC 代码有效。多个来源（漏洞库信息、搜索引擎结果和漏洞利用代码）都表明该漏洞是可利用的，并且提供了可用的 PoC。CISA的KEV目录收录了该漏洞,表明该漏洞在野外被利用。

**投毒风险：** 仓库主要包含漏洞描述、受影响的版本、PoC 示例和修复方案说明。没有发现恶意代码，如反弹 shell、下载执行等。漏洞利用代码本身是对漏洞的重现，其目的是证明漏洞的存在。考虑到代码简洁、目标明确、以及缺乏隐藏的恶意行为，投毒风险极低。此仓库中检测到作者隐藏投毒代码的风险小于1%。

**利用方式：** 攻击者通过构造包含目录遍历字符（`..%252f`）的 HTTP GET 请求，发送到 Flink JobManager 的 RESTful API 接口 `/jobmanager/logs/{filename}`。由于服务端未对 `{filename}` 参数进行严格的校验，攻击者可以利用该参数读取 JobManager 进程可访问的任意文件，例如配置文件、系统文件等。攻击需要具备网络可达性。

**项目地址:** [murataydemir/CVE-2020-17519](https://github.com/murataydemir/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #9

**来源**: [CVE-2020-17519-radbsie_CVE-2020-17519-Exp.md](../2020/CVE-2020-17519-radbsie_CVE-2020-17519-Exp.md)

## CVE-2020-17519-Apache Flink-目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要目标Flink实例暴露REST API且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可以访问的本地文件系统上的任何文件，利用方式如下：

1.  **漏洞描述：** 由于 Apache Flink 在处理 REST API 请求时，没有充分过滤目录遍历字符，导致攻击者可以通过构造包含 `..%252f` 的恶意 URL 来访问系统上的任意文件。
2.  **POC有效性：** 提供的 Go 代码通过向目标 Flink JobManager 的 REST API 发送包含目录遍历payload的GET请求来验证漏洞是否存在。该POC通过检查响应体中是否存在类似 `root` 等关键字判断是否成功读取 `/etc/passwd` 文件，如果存在且状态码为200则判断目标存在漏洞，因此POC代码有效。
3.  **投毒风险：** 提供的EXP代码主要功能是通过目录遍历漏洞读取目标服务器上的文件，没有发现任何恶意或隐藏的投毒代码，因此投毒风险为0%。
4.  **利用方式：**
    *   攻击者构造包含目录遍历字符的 URL，例如：`/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
    *   攻击者将构造好的 URL 发送到目标 Flink JobManager 的 REST API。
    *   如果目标 Flink 版本在受影响范围内，且 JobManager 进程对目标文件具有读取权限，则攻击者可以成功读取该文件。
    *   通过读取敏感配置文件等，攻击者可以获取更多信息，为进一步攻击做准备。

从CISA的信息来看，该漏洞已经被积极利用，需要引起重视。

**项目地址:** [radbsie/CVE-2020-17519-Exp](https://github.com/radbsie/CVE-2020-17519-Exp)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #10

**来源**: [CVE-2020-17519-shoucheng3_apache__flink_CVE-2020-17519_1-11-2.md](../2020/CVE-2020-17519-shoucheng3_apache__flink_CVE-2020-17519_1-11-2.md)

## CVE-2020-17519-Apache Flink-目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager进程的REST接口可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。该漏洞允许未经身份验证的攻击者通过 JobManager 进程的 REST 接口读取 JobManager 进程有权访问的本地文件系统上的任何文件。漏洞利用方式是发送包含目录遍历序列（例如 `../`）的特制 HTTP 请求到REST接口，从而读取任意文件。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞存在已知的公开利用方法，并且已被添加到 CISA 的 KEV 目录中，表明该漏洞利用的有效性较高。

**投毒风险：**
提供的漏洞利用代码仅包含Apache许可证，没有任何恶意代码或后门，因此投毒风险为0%。

**利用方式：**
1.  确定目标 Flink JobManager 的 REST 接口地址。
2.  构造包含目录遍历序列的 HTTP GET 请求，例如：
    `GET /..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd HTTP/1.1` (URL编码的`../`)
3.  发送该请求到 Flink JobManager 的 REST 接口。
4.  如果漏洞存在，服务器将返回 `/etc/passwd` 文件的内容（或其他被请求的文件）。需要注意的是，攻击者只能访问 JobManager 进程有权访问的文件。

**项目地址:** [shoucheng3/apache__flink_CVE-2020-17519_1-11-2](https://github.com/shoucheng3/apache__flink_CVE-2020-17519_1-11-2)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #11

**来源**: [CVE-2020-17519-yaunsky_CVE-2020-17519-Apache-Flink.md](../2020/CVE-2020-17519-yaunsky_CVE-2020-17519-Apache-Flink.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager REST API 暴露在外网或可被访问的网络环境。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中存在的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可以访问的本地文件系统上的任何文件。\n\n**有效性：**\n
根据漏洞信息和搜索引擎结果，此漏洞利用是有效的。多个来源表明该漏洞已被积极利用，并且CISA已将其添加到已知被利用漏洞目录中。提供的POC代码尝试通过构造包含目录遍历序列的 URL 来读取 `/etc/passwd` 文件，这符合漏洞描述。POC 中 URL 编码 `%252f`是双重编码`/`，目的是绕过一些安全机制。\n\n**投毒风险：**\n
分析提供的 Python 脚本 `CVE-2020-17519.py` 以及相关文件, 发现并没有明显的恶意代码或后门。脚本的功能主要是发送 HTTP 请求到目标 Flink JobManager 实例，利用目录遍历漏洞读取文件。脚本代码相对简单，只实现了漏洞验证的功能, 投毒风险评估为0%。\n\n**利用方式：**\n
1.  **确定目标：** 找到运行 Apache Flink 1.11.0 到 1.11.2 版本的 JobManager 实例，并且该实例的 REST API 可以通过网络访问。
2.  **构造恶意 URL：** 构造包含目录遍历序列的 URL，例如 `/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`，尝试读取目标文件。
3.  **发送请求：** 使用 HTTP GET 请求将构造的 URL 发送到 JobManager 的 REST API。
4.  **分析响应：** 如果服务器返回目标文件的内容，则表明漏洞存在。\n\n**缓解措施：**\n
*   升级到 Apache Flink 1.11.3 或 1.12.0 及以上版本。
*   限制对 JobManager REST API 的访问。

**项目地址:** [yaunsky/CVE-2020-17519-Apache-Flink](https://github.com/yaunsky/CVE-2020-17519-Apache-Flink)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #12

**来源**: [CVE-2020-17519-zhangweijie11_CVE-2020-17519.md](../2020/CVE-2020-17519-zhangweijie11_CVE-2020-17519.md)

## CVE-2020-17519-Apache Flink目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager的REST接口对外开放且运行在受影响版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中存在的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口，利用目录遍历读取 JobManager 进程可以访问的本地文件系统上的任意文件。 

**有效性：**

提供的 POC 代码有效。它通过构造包含 `..%252f` (双重URL编码的 `../`) 的恶意 URL 发送 HTTP GET 请求到 `/jobmanager/logs/` 路径，尝试读取 `/etc/passwd` 文件。如果服务器返回状态码 200 且响应内容包含 `root:x`，则确认漏洞存在。

**投毒风险：**

提供的 POC 代码未发现明显的投毒代码。代码功能简单，仅用于验证漏洞是否存在，没有执行恶意操作或安装后门。该仓库的作者没有隐藏任何投毒代码, 投毒风险为 0%。

**利用方式：**

1.  确定目标 Apache Flink JobManager 的 REST 接口 URL。
2.  构造包含目录遍历的 URL，例如：`http://<target_url>/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
3.  发送 HTTP GET 请求到构造的 URL。
4.  如果服务器返回状态码 200 且响应内容为目标文件内容，则漏洞利用成功。请注意JobManager进程的权限决定了能够读取的文件。

**项目地址:** [zhangweijie11/CVE-2020-17519](https://github.com/zhangweijie11/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---



---

## POC #5

**来源**: [CVE-2020-17519-dev-team-12x_CVE-2020-17519.md](../2020/CVE-2020-17519-dev-team-12x_CVE-2020-17519.md)

## CVE-2020-17519 - Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历/文件读取

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要目标Flink JobManager的REST接口对外开放且版本为受影响版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519是Apache Flink 1.11.0到1.11.2版本中的一个目录遍历漏洞。攻击者可以通过构造特殊的URL，利用JobManager的REST接口读取JobManager进程有权访问的本地文件系统上的任意文件。该漏洞无需身份验证即可利用。利用方式如下：

1.  确定目标Flink JobManager的REST接口地址和端口。
2.  构造包含目录遍历字符的URL，例如`http://<flink_jobmanager_host>:<flink_jobmanager_port>/jobmanager/logs/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc/passwd`，其中`..%2F`用于向上遍历目录。
3.  发送HTTP GET请求到构造的URL。
4.  如果目标存在漏洞，服务器将返回请求的文件内容。

根据提供的Metasploit模块`auxiliary/scanner/http/apache_flink_file_read`，攻击者可以通过设置`RHOSTS`（目标主机）、`RPORT`（目标端口）、`FILEPATH`（要读取的文件路径）和`DEPTH`（目录遍历深度）来利用该漏洞。提供的代码示例演示了如何读取`/etc/passwd`文件。

分析提供的POC代码，没有发现明显的投毒代码。该代码的功能仅限于扫描和利用已知的目录遍历漏洞来读取文件。所有操作都旨在利用漏洞，不存在额外植入后门或恶意行为的逻辑。

**项目地址:** [dev-team-12x/CVE-2020-17519](https://github.com/dev-team-12x/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #6

**来源**: [CVE-2020-17519-dolevf_apache-flink-directory-traversal.nse.md](../2020/CVE-2020-17519-dolevf_apache-flink-directory-traversal.nse.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可读取JobManager进程可访问的任意文件

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要Flink JobManager的REST接口暴露在外网或内网，且目标版本在1.11.0到1.11.2之间。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2020-17519是Apache Flink 1.11.0到1.11.2版本中存在的一个目录遍历漏洞。攻击者可以通过JobManager的REST接口，利用`..%252f`进行URL编码后的目录穿越，读取JobManager进程有权访问的服务器本地文件。CISA已将此漏洞添加到已知被利用漏洞目录中，表明该漏洞正在被积极利用。

提供的Nmap脚本`apache-flink-traversal.nse`通过构造特定的HTTP GET请求，尝试读取`/etc/passwd`文件来验证漏洞是否存在。具体来说，它发送请求到`/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`，如果服务器返回状态码200且响应体中包含`root:x:0:0`，则认为目标服务器存在漏洞。

**有效性：**
POC代码有效，它通过构造恶意的URL来读取敏感文件，是检测漏洞的常见方法。

**投毒风险：**
查看了提供的Nmap脚本内容，该脚本的主要功能是检测目标主机是否存在CVE-2020-17519漏洞，通过发送包含目录遍历payload的HTTP请求到目标Flink JobManager的REST API端点，并检查响应内容是否包含`/etc/passwd`文件的内容，从而判断是否存在漏洞。未发现作者隐藏的恶意代码或后门。
虽然此脚本本身的功能是检查漏洞，但使用者可能会利用此漏洞来获取服务器上的敏感信息，这属于漏洞利用行为，而非POC投毒。因此，投毒风险评估为0%。

**利用方式：**
1.  确定目标Apache Flink的版本是否在受影响的范围内（1.11.0 to 1.11.2）。
2.  使用Nmap脚本或手动构造包含目录遍历payload的HTTP GET请求，发送到JobManager的REST接口。
3.  通过REST接口发送请求`/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
4.  如果服务器返回状态码200，并且响应体包含`/etc/passwd`的内容，则表明漏洞存在，可以进一步利用该漏洞读取其他文件。
5.  利用该漏洞读取JobManager进程可访问的任何本地文件，例如配置文件、密钥等。

**项目地址:** [dolevf/apache-flink-directory-traversal.nse](https://github.com/dolevf/apache-flink-directory-traversal.nse)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #7

**来源**: [CVE-2020-17519-givemefivw_CVE-2020-17519.md](../2020/CVE-2020-17519-givemefivw_CVE-2020-17519.md)

## CVE-2020-17519 Apache Flink 任意文件读取

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历/文件读取

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager REST API 端口对外开放，且目标为受影响版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17519 是一个 Apache Flink 中的目录遍历漏洞，存在于 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 进程的 REST 接口读取 JobManager 进程可访问的本地文件系统上的任何文件，无需身份验证。利用方式是通过构造包含目录遍历序列（如 `..%252f`）的 URL，向 JobManager 的特定端点（`/jobmanager/logs`）发送 HTTP GET 请求。提供的POC代码使用Cheetah语言编写，通过读取ip.txt文件中的IP地址列表，批量发送构造好的HTTP请求，检测目标是否存在漏洞，并通过判断响应内容中是否包含"root"字符串来验证/etc/passwd文件是否读取成功。虽然POC本身功能是验证漏洞，但脚本设计上存在潜在投毒风险：1. ip.txt文件可能被替换为包含恶意IP地址的列表，导致扫描行为扩散； 2. 读取到的文件内容可能会被上传到恶意服务器，导致信息泄露。根据代码文件和说明文档的分析,认为主要功能为漏洞探测,但存在小概率的潜在利用可能,因此判断投毒风险为10%。

**项目地址:** [givemefivw/CVE-2020-17519](https://github.com/givemefivw/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #8

**来源**: [CVE-2020-17519-murataydemir_CVE-2020-17519.md](../2020/CVE-2020-17519-murataydemir_CVE-2020-17519.md)

## CVE-2020-17519 - Apache Flink RESTful API 任意文件读取

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要 Flink JobManager 进程的 REST 接口对外暴露，且攻击者能访问该接口。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-17519 漏洞存在于 Apache Flink 1.11.0 到 1.11.2 版本中。该漏洞允许未经身份验证的攻击者通过 JobManager 的 RESTful API 读取 JobManager 进程本地文件系统上的任意文件。漏洞原因是 `JobManagerCustomLogHandler.java` 类中的代码未对用户提供的文件名进行充分的验证和过滤，导致目录遍历漏洞。PoC 中构造了包含 `..%252f` 的恶意请求，绕过路径检查，读取 `/etc/passwd` 文件。修复方法是在获取文件名时，仅取文件名部分，避免目录遍历。

**有效性：** 提供的 PoC 代码有效。多个来源（漏洞库信息、搜索引擎结果和漏洞利用代码）都表明该漏洞是可利用的，并且提供了可用的 PoC。CISA的KEV目录收录了该漏洞,表明该漏洞在野外被利用。

**投毒风险：** 仓库主要包含漏洞描述、受影响的版本、PoC 示例和修复方案说明。没有发现恶意代码，如反弹 shell、下载执行等。漏洞利用代码本身是对漏洞的重现，其目的是证明漏洞的存在。考虑到代码简洁、目标明确、以及缺乏隐藏的恶意行为，投毒风险极低。此仓库中检测到作者隐藏投毒代码的风险小于1%。

**利用方式：** 攻击者通过构造包含目录遍历字符（`..%252f`）的 HTTP GET 请求，发送到 Flink JobManager 的 RESTful API 接口 `/jobmanager/logs/{filename}`。由于服务端未对 `{filename}` 参数进行严格的校验，攻击者可以利用该参数读取 JobManager 进程可访问的任意文件，例如配置文件、系统文件等。攻击需要具备网络可达性。

**项目地址:** [murataydemir/CVE-2020-17519](https://github.com/murataydemir/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #9

**来源**: [CVE-2020-17519-radbsie_CVE-2020-17519-Exp.md](../2020/CVE-2020-17519-radbsie_CVE-2020-17519-Exp.md)

## CVE-2020-17519-Apache Flink-目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要目标Flink实例暴露REST API且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可以访问的本地文件系统上的任何文件，利用方式如下：

1.  **漏洞描述：** 由于 Apache Flink 在处理 REST API 请求时，没有充分过滤目录遍历字符，导致攻击者可以通过构造包含 `..%252f` 的恶意 URL 来访问系统上的任意文件。
2.  **POC有效性：** 提供的 Go 代码通过向目标 Flink JobManager 的 REST API 发送包含目录遍历payload的GET请求来验证漏洞是否存在。该POC通过检查响应体中是否存在类似 `root` 等关键字判断是否成功读取 `/etc/passwd` 文件，如果存在且状态码为200则判断目标存在漏洞，因此POC代码有效。
3.  **投毒风险：** 提供的EXP代码主要功能是通过目录遍历漏洞读取目标服务器上的文件，没有发现任何恶意或隐藏的投毒代码，因此投毒风险为0%。
4.  **利用方式：**
    *   攻击者构造包含目录遍历字符的 URL，例如：`/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
    *   攻击者将构造好的 URL 发送到目标 Flink JobManager 的 REST API。
    *   如果目标 Flink 版本在受影响范围内，且 JobManager 进程对目标文件具有读取权限，则攻击者可以成功读取该文件。
    *   通过读取敏感配置文件等，攻击者可以获取更多信息，为进一步攻击做准备。

从CISA的信息来看，该漏洞已经被积极利用，需要引起重视。

**项目地址:** [radbsie/CVE-2020-17519-Exp](https://github.com/radbsie/CVE-2020-17519-Exp)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #10

**来源**: [CVE-2020-17519-shoucheng3_apache__flink_CVE-2020-17519_1-11-2.md](../2020/CVE-2020-17519-shoucheng3_apache__flink_CVE-2020-17519_1-11-2.md)

## CVE-2020-17519-Apache Flink-目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager进程的REST接口可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。该漏洞允许未经身份验证的攻击者通过 JobManager 进程的 REST 接口读取 JobManager 进程有权访问的本地文件系统上的任何文件。漏洞利用方式是发送包含目录遍历序列（例如 `../`）的特制 HTTP 请求到REST接口，从而读取任意文件。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞存在已知的公开利用方法，并且已被添加到 CISA 的 KEV 目录中，表明该漏洞利用的有效性较高。

**投毒风险：**
提供的漏洞利用代码仅包含Apache许可证，没有任何恶意代码或后门，因此投毒风险为0%。

**利用方式：**
1.  确定目标 Flink JobManager 的 REST 接口地址。
2.  构造包含目录遍历序列的 HTTP GET 请求，例如：
    `GET /..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd HTTP/1.1` (URL编码的`../`)
3.  发送该请求到 Flink JobManager 的 REST 接口。
4.  如果漏洞存在，服务器将返回 `/etc/passwd` 文件的内容（或其他被请求的文件）。需要注意的是，攻击者只能访问 JobManager 进程有权访问的文件。

**项目地址:** [shoucheng3/apache__flink_CVE-2020-17519_1-11-2](https://github.com/shoucheng3/apache__flink_CVE-2020-17519_1-11-2)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #11

**来源**: [CVE-2020-17519-yaunsky_CVE-2020-17519-Apache-Flink.md](../2020/CVE-2020-17519-yaunsky_CVE-2020-17519-Apache-Flink.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager REST API 暴露在外网或可被访问的网络环境。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中存在的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可以访问的本地文件系统上的任何文件。\n\n**有效性：**\n
根据漏洞信息和搜索引擎结果，此漏洞利用是有效的。多个来源表明该漏洞已被积极利用，并且CISA已将其添加到已知被利用漏洞目录中。提供的POC代码尝试通过构造包含目录遍历序列的 URL 来读取 `/etc/passwd` 文件，这符合漏洞描述。POC 中 URL 编码 `%252f`是双重编码`/`，目的是绕过一些安全机制。\n\n**投毒风险：**\n
分析提供的 Python 脚本 `CVE-2020-17519.py` 以及相关文件, 发现并没有明显的恶意代码或后门。脚本的功能主要是发送 HTTP 请求到目标 Flink JobManager 实例，利用目录遍历漏洞读取文件。脚本代码相对简单，只实现了漏洞验证的功能, 投毒风险评估为0%。\n\n**利用方式：**\n
1.  **确定目标：** 找到运行 Apache Flink 1.11.0 到 1.11.2 版本的 JobManager 实例，并且该实例的 REST API 可以通过网络访问。
2.  **构造恶意 URL：** 构造包含目录遍历序列的 URL，例如 `/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`，尝试读取目标文件。
3.  **发送请求：** 使用 HTTP GET 请求将构造的 URL 发送到 JobManager 的 REST API。
4.  **分析响应：** 如果服务器返回目标文件的内容，则表明漏洞存在。\n\n**缓解措施：**\n
*   升级到 Apache Flink 1.11.3 或 1.12.0 及以上版本。
*   限制对 JobManager REST API 的访问。

**项目地址:** [yaunsky/CVE-2020-17519-Apache-Flink](https://github.com/yaunsky/CVE-2020-17519-Apache-Flink)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #12

**来源**: [CVE-2020-17519-zhangweijie11_CVE-2020-17519.md](../2020/CVE-2020-17519-zhangweijie11_CVE-2020-17519.md)

## CVE-2020-17519-Apache Flink目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager的REST接口对外开放且运行在受影响版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中存在的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口，利用目录遍历读取 JobManager 进程可以访问的本地文件系统上的任意文件。 

**有效性：**

提供的 POC 代码有效。它通过构造包含 `..%252f` (双重URL编码的 `../`) 的恶意 URL 发送 HTTP GET 请求到 `/jobmanager/logs/` 路径，尝试读取 `/etc/passwd` 文件。如果服务器返回状态码 200 且响应内容包含 `root:x`，则确认漏洞存在。

**投毒风险：**

提供的 POC 代码未发现明显的投毒代码。代码功能简单，仅用于验证漏洞是否存在，没有执行恶意操作或安装后门。该仓库的作者没有隐藏任何投毒代码, 投毒风险为 0%。

**利用方式：**

1.  确定目标 Apache Flink JobManager 的 REST 接口 URL。
2.  构造包含目录遍历的 URL，例如：`http://<target_url>/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
3.  发送 HTTP GET 请求到构造的 URL。
4.  如果服务器返回状态码 200 且响应内容为目标文件内容，则漏洞利用成功。请注意JobManager进程的权限决定了能够读取的文件。

**项目地址:** [zhangweijie11/CVE-2020-17519](https://github.com/zhangweijie11/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---



---

## POC #5

**来源**: [CVE-2020-17519-dev-team-12x_CVE-2020-17519.md](../2020/CVE-2020-17519-dev-team-12x_CVE-2020-17519.md)

## CVE-2020-17519 - Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历/文件读取

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要目标Flink JobManager的REST接口对外开放且版本为受影响版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519是Apache Flink 1.11.0到1.11.2版本中的一个目录遍历漏洞。攻击者可以通过构造特殊的URL，利用JobManager的REST接口读取JobManager进程有权访问的本地文件系统上的任意文件。该漏洞无需身份验证即可利用。利用方式如下：

1.  确定目标Flink JobManager的REST接口地址和端口。
2.  构造包含目录遍历字符的URL，例如`http://<flink_jobmanager_host>:<flink_jobmanager_port>/jobmanager/logs/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc/passwd`，其中`..%2F`用于向上遍历目录。
3.  发送HTTP GET请求到构造的URL。
4.  如果目标存在漏洞，服务器将返回请求的文件内容。

根据提供的Metasploit模块`auxiliary/scanner/http/apache_flink_file_read`，攻击者可以通过设置`RHOSTS`（目标主机）、`RPORT`（目标端口）、`FILEPATH`（要读取的文件路径）和`DEPTH`（目录遍历深度）来利用该漏洞。提供的代码示例演示了如何读取`/etc/passwd`文件。

分析提供的POC代码，没有发现明显的投毒代码。该代码的功能仅限于扫描和利用已知的目录遍历漏洞来读取文件。所有操作都旨在利用漏洞，不存在额外植入后门或恶意行为的逻辑。

**项目地址:** [dev-team-12x/CVE-2020-17519](https://github.com/dev-team-12x/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #6

**来源**: [CVE-2020-17519-dolevf_apache-flink-directory-traversal.nse.md](../2020/CVE-2020-17519-dolevf_apache-flink-directory-traversal.nse.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可读取JobManager进程可访问的任意文件

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要Flink JobManager的REST接口暴露在外网或内网，且目标版本在1.11.0到1.11.2之间。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2020-17519是Apache Flink 1.11.0到1.11.2版本中存在的一个目录遍历漏洞。攻击者可以通过JobManager的REST接口，利用`..%252f`进行URL编码后的目录穿越，读取JobManager进程有权访问的服务器本地文件。CISA已将此漏洞添加到已知被利用漏洞目录中，表明该漏洞正在被积极利用。

提供的Nmap脚本`apache-flink-traversal.nse`通过构造特定的HTTP GET请求，尝试读取`/etc/passwd`文件来验证漏洞是否存在。具体来说，它发送请求到`/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`，如果服务器返回状态码200且响应体中包含`root:x:0:0`，则认为目标服务器存在漏洞。

**有效性：**
POC代码有效，它通过构造恶意的URL来读取敏感文件，是检测漏洞的常见方法。

**投毒风险：**
查看了提供的Nmap脚本内容，该脚本的主要功能是检测目标主机是否存在CVE-2020-17519漏洞，通过发送包含目录遍历payload的HTTP请求到目标Flink JobManager的REST API端点，并检查响应内容是否包含`/etc/passwd`文件的内容，从而判断是否存在漏洞。未发现作者隐藏的恶意代码或后门。
虽然此脚本本身的功能是检查漏洞，但使用者可能会利用此漏洞来获取服务器上的敏感信息，这属于漏洞利用行为，而非POC投毒。因此，投毒风险评估为0%。

**利用方式：**
1.  确定目标Apache Flink的版本是否在受影响的范围内（1.11.0 to 1.11.2）。
2.  使用Nmap脚本或手动构造包含目录遍历payload的HTTP GET请求，发送到JobManager的REST接口。
3.  通过REST接口发送请求`/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
4.  如果服务器返回状态码200，并且响应体包含`/etc/passwd`的内容，则表明漏洞存在，可以进一步利用该漏洞读取其他文件。
5.  利用该漏洞读取JobManager进程可访问的任何本地文件，例如配置文件、密钥等。

**项目地址:** [dolevf/apache-flink-directory-traversal.nse](https://github.com/dolevf/apache-flink-directory-traversal.nse)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #7

**来源**: [CVE-2020-17519-givemefivw_CVE-2020-17519.md](../2020/CVE-2020-17519-givemefivw_CVE-2020-17519.md)

## CVE-2020-17519 Apache Flink 任意文件读取

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历/文件读取

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager REST API 端口对外开放，且目标为受影响版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17519 是一个 Apache Flink 中的目录遍历漏洞，存在于 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 进程的 REST 接口读取 JobManager 进程可访问的本地文件系统上的任何文件，无需身份验证。利用方式是通过构造包含目录遍历序列（如 `..%252f`）的 URL，向 JobManager 的特定端点（`/jobmanager/logs`）发送 HTTP GET 请求。提供的POC代码使用Cheetah语言编写，通过读取ip.txt文件中的IP地址列表，批量发送构造好的HTTP请求，检测目标是否存在漏洞，并通过判断响应内容中是否包含"root"字符串来验证/etc/passwd文件是否读取成功。虽然POC本身功能是验证漏洞，但脚本设计上存在潜在投毒风险：1. ip.txt文件可能被替换为包含恶意IP地址的列表，导致扫描行为扩散； 2. 读取到的文件内容可能会被上传到恶意服务器，导致信息泄露。根据代码文件和说明文档的分析,认为主要功能为漏洞探测,但存在小概率的潜在利用可能,因此判断投毒风险为10%。

**项目地址:** [givemefivw/CVE-2020-17519](https://github.com/givemefivw/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #8

**来源**: [CVE-2020-17519-murataydemir_CVE-2020-17519.md](../2020/CVE-2020-17519-murataydemir_CVE-2020-17519.md)

## CVE-2020-17519 - Apache Flink RESTful API 任意文件读取

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要 Flink JobManager 进程的 REST 接口对外暴露，且攻击者能访问该接口。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-17519 漏洞存在于 Apache Flink 1.11.0 到 1.11.2 版本中。该漏洞允许未经身份验证的攻击者通过 JobManager 的 RESTful API 读取 JobManager 进程本地文件系统上的任意文件。漏洞原因是 `JobManagerCustomLogHandler.java` 类中的代码未对用户提供的文件名进行充分的验证和过滤，导致目录遍历漏洞。PoC 中构造了包含 `..%252f` 的恶意请求，绕过路径检查，读取 `/etc/passwd` 文件。修复方法是在获取文件名时，仅取文件名部分，避免目录遍历。

**有效性：** 提供的 PoC 代码有效。多个来源（漏洞库信息、搜索引擎结果和漏洞利用代码）都表明该漏洞是可利用的，并且提供了可用的 PoC。CISA的KEV目录收录了该漏洞,表明该漏洞在野外被利用。

**投毒风险：** 仓库主要包含漏洞描述、受影响的版本、PoC 示例和修复方案说明。没有发现恶意代码，如反弹 shell、下载执行等。漏洞利用代码本身是对漏洞的重现，其目的是证明漏洞的存在。考虑到代码简洁、目标明确、以及缺乏隐藏的恶意行为，投毒风险极低。此仓库中检测到作者隐藏投毒代码的风险小于1%。

**利用方式：** 攻击者通过构造包含目录遍历字符（`..%252f`）的 HTTP GET 请求，发送到 Flink JobManager 的 RESTful API 接口 `/jobmanager/logs/{filename}`。由于服务端未对 `{filename}` 参数进行严格的校验，攻击者可以利用该参数读取 JobManager 进程可访问的任意文件，例如配置文件、系统文件等。攻击需要具备网络可达性。

**项目地址:** [murataydemir/CVE-2020-17519](https://github.com/murataydemir/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #9

**来源**: [CVE-2020-17519-radbsie_CVE-2020-17519-Exp.md](../2020/CVE-2020-17519-radbsie_CVE-2020-17519-Exp.md)

## CVE-2020-17519-Apache Flink-目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要目标Flink实例暴露REST API且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可以访问的本地文件系统上的任何文件，利用方式如下：

1.  **漏洞描述：** 由于 Apache Flink 在处理 REST API 请求时，没有充分过滤目录遍历字符，导致攻击者可以通过构造包含 `..%252f` 的恶意 URL 来访问系统上的任意文件。
2.  **POC有效性：** 提供的 Go 代码通过向目标 Flink JobManager 的 REST API 发送包含目录遍历payload的GET请求来验证漏洞是否存在。该POC通过检查响应体中是否存在类似 `root` 等关键字判断是否成功读取 `/etc/passwd` 文件，如果存在且状态码为200则判断目标存在漏洞，因此POC代码有效。
3.  **投毒风险：** 提供的EXP代码主要功能是通过目录遍历漏洞读取目标服务器上的文件，没有发现任何恶意或隐藏的投毒代码，因此投毒风险为0%。
4.  **利用方式：**
    *   攻击者构造包含目录遍历字符的 URL，例如：`/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
    *   攻击者将构造好的 URL 发送到目标 Flink JobManager 的 REST API。
    *   如果目标 Flink 版本在受影响范围内，且 JobManager 进程对目标文件具有读取权限，则攻击者可以成功读取该文件。
    *   通过读取敏感配置文件等，攻击者可以获取更多信息，为进一步攻击做准备。

从CISA的信息来看，该漏洞已经被积极利用，需要引起重视。

**项目地址:** [radbsie/CVE-2020-17519-Exp](https://github.com/radbsie/CVE-2020-17519-Exp)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #10

**来源**: [CVE-2020-17519-shoucheng3_apache__flink_CVE-2020-17519_1-11-2.md](../2020/CVE-2020-17519-shoucheng3_apache__flink_CVE-2020-17519_1-11-2.md)

## CVE-2020-17519-Apache Flink-目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager进程的REST接口可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。该漏洞允许未经身份验证的攻击者通过 JobManager 进程的 REST 接口读取 JobManager 进程有权访问的本地文件系统上的任何文件。漏洞利用方式是发送包含目录遍历序列（例如 `../`）的特制 HTTP 请求到REST接口，从而读取任意文件。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞存在已知的公开利用方法，并且已被添加到 CISA 的 KEV 目录中，表明该漏洞利用的有效性较高。

**投毒风险：**
提供的漏洞利用代码仅包含Apache许可证，没有任何恶意代码或后门，因此投毒风险为0%。

**利用方式：**
1.  确定目标 Flink JobManager 的 REST 接口地址。
2.  构造包含目录遍历序列的 HTTP GET 请求，例如：
    `GET /..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd HTTP/1.1` (URL编码的`../`)
3.  发送该请求到 Flink JobManager 的 REST 接口。
4.  如果漏洞存在，服务器将返回 `/etc/passwd` 文件的内容（或其他被请求的文件）。需要注意的是，攻击者只能访问 JobManager 进程有权访问的文件。

**项目地址:** [shoucheng3/apache__flink_CVE-2020-17519_1-11-2](https://github.com/shoucheng3/apache__flink_CVE-2020-17519_1-11-2)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #11

**来源**: [CVE-2020-17519-yaunsky_CVE-2020-17519-Apache-Flink.md](../2020/CVE-2020-17519-yaunsky_CVE-2020-17519-Apache-Flink.md)

## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager REST API 暴露在外网或可被访问的网络环境。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中存在的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可以访问的本地文件系统上的任何文件。\n\n**有效性：**\n
根据漏洞信息和搜索引擎结果，此漏洞利用是有效的。多个来源表明该漏洞已被积极利用，并且CISA已将其添加到已知被利用漏洞目录中。提供的POC代码尝试通过构造包含目录遍历序列的 URL 来读取 `/etc/passwd` 文件，这符合漏洞描述。POC 中 URL 编码 `%252f`是双重编码`/`，目的是绕过一些安全机制。\n\n**投毒风险：**\n
分析提供的 Python 脚本 `CVE-2020-17519.py` 以及相关文件, 发现并没有明显的恶意代码或后门。脚本的功能主要是发送 HTTP 请求到目标 Flink JobManager 实例，利用目录遍历漏洞读取文件。脚本代码相对简单，只实现了漏洞验证的功能, 投毒风险评估为0%。\n\n**利用方式：**\n
1.  **确定目标：** 找到运行 Apache Flink 1.11.0 到 1.11.2 版本的 JobManager 实例，并且该实例的 REST API 可以通过网络访问。
2.  **构造恶意 URL：** 构造包含目录遍历序列的 URL，例如 `/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`，尝试读取目标文件。
3.  **发送请求：** 使用 HTTP GET 请求将构造的 URL 发送到 JobManager 的 REST API。
4.  **分析响应：** 如果服务器返回目标文件的内容，则表明漏洞存在。\n\n**缓解措施：**\n
*   升级到 Apache Flink 1.11.3 或 1.12.0 及以上版本。
*   限制对 JobManager REST API 的访问。

**项目地址:** [yaunsky/CVE-2020-17519-Apache-Flink](https://github.com/yaunsky/CVE-2020-17519-Apache-Flink)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

## POC #12

**来源**: [CVE-2020-17519-zhangweijie11_CVE-2020-17519.md](../2020/CVE-2020-17519-zhangweijie11_CVE-2020-17519.md)

## CVE-2020-17519-Apache Flink目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager的REST接口对外开放且运行在受影响版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中存在的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口，利用目录遍历读取 JobManager 进程可以访问的本地文件系统上的任意文件。 

**有效性：**

提供的 POC 代码有效。它通过构造包含 `..%252f` (双重URL编码的 `../`) 的恶意 URL 发送 HTTP GET 请求到 `/jobmanager/logs/` 路径，尝试读取 `/etc/passwd` 文件。如果服务器返回状态码 200 且响应内容包含 `root:x`，则确认漏洞存在。

**投毒风险：**

提供的 POC 代码未发现明显的投毒代码。代码功能简单，仅用于验证漏洞是否存在，没有执行恶意操作或安装后门。该仓库的作者没有隐藏任何投毒代码, 投毒风险为 0%。

**利用方式：**

1.  确定目标 Apache Flink JobManager 的 REST 接口 URL。
2.  构造包含目录遍历的 URL，例如：`http://<target_url>/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
3.  发送 HTTP GET 请求到构造的 URL。
4.  如果服务器返回状态码 200 且响应内容为目标文件内容，则漏洞利用成功。请注意JobManager进程的权限决定了能够读取的文件。

**项目地址:** [zhangweijie11/CVE-2020-17519](https://github.com/zhangweijie11/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)

---

