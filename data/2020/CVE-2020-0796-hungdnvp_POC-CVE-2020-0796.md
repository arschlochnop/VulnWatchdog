## CVE-2020-0796 - Microsoft Windows Server Message Block 3.1.1 (SMBv3) RCE

**漏洞编号:** CVE-2020-0796

**漏洞类型:** RCE

**影响应用:** Microsoft Windows Server Message Block 3.1.1 (SMBv3)

**危害等级:** CRITICAL

**CVSS评分:** 10.0

**影响版本:** Windows 10 Version 1903/1909 (x86, x64, ARM64), Windows Server Version 1903/1909 (Server Core)

**利用条件:** 通过网络向受影响的SMBv3服务器发送特制的数据包，无需身份验证

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞被称为'SMBGhost'，存在于Windows SMBv3协议处理压缩数据包的过程中。POC代码展示了完整的利用链，包括利用Nmap脚本（smb-protocols）进行指纹识别，确认目标是否开启了SMBv3.1.1。随后，利用专门的Python脚本（如ly4k/SMBGhost）验证是否存在整数溢出漏洞。该POC具有极高的实用性，因为它展示了如何绕过内存限制并最终通过特制包实现内核权限的远程代码执行（RCE）。分析显示，POC代码逻辑清晰，分别涵盖了扫描、验证和提权/反弹Shell三个阶段。由于SMBv3在Windows 10 1903/1909中默认启用，该漏洞具备‘蠕虫级’传播能力。利用步骤如下：首先，使用Nmap扫描目标网段（如192.168.116.0/24）的445端口；其次，通过smb-protocols脚本确认协议版本为3.1.1；然后，运行检测脚本进行无损验证；最后，通过CVE-2020-0796-RCE-POC脚本配合Netcat监听器（ncat -lvp 4444）获取远程系统权限。投毒风险分析：该POC来源于知名的防御性研究仓库，代码结构透明，主要使用Python编写，且依赖库多为标准网络库，未发现明显的恶意混淆代码或未经授权的外部回连行为。虽然此类漏洞的POC常被脚本小子利用，但该代码主要作为安全审计和防御加固的教学演示。风险点主要在于：1. 攻击者可能修改反弹Shell的Payload指向恶意IP；2. 某些衍生版本的POC可能在编译好的二进制文件中植入后门。然而，目前的源代码版本（如jamf或ly4k提供的）经过社区审计，属于合法的安全研究范畴。对于组织而言，最大的风险在于未修复的系统直接暴露在公网，而非POC代码本身的毒性。建议在隔离测试环境中使用，并确保从可信的GitHub官方镜像下载，避免使用来源不明的exe格式成品。

**项目地址:** [https://github.com/jamf/CVE-2020-0796-RCE-POC](https://github.com/jamf/CVE-2020-0796-RCE-POC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2020-0796](https://nvd.nist.gov/vuln/detail/CVE-2020-0796)
