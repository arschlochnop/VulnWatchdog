# CVE-2020-7247

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-7247-FiroSolutions_cve-2020-7247-exploit.md](../2020/CVE-2020-7247-FiroSolutions_cve-2020-7247-exploit.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致root权限下的远程代码执行

**影响版本:** 6.6

**利用条件:** 需要OpenSMTPD服务未修补，默认配置（未注释）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 允许远程攻击者通过构造恶意的SMTP会话，利用`MAIL FROM`字段中的shell元字符，以root权限执行任意命令。POC代码通过socket连接到目标主机的25端口（SMTP），发送HELO，MAIL FROM，RCPT TO，DATA和QUIT等SMTP命令。`MAIL FROM`命令中注入了shell命令，通过`for i in 0 1 2 3 4 5 6 7 8 9 a b c d;do read r;done;sh;exit 0;`执行shell。`DATA`命令后发送的`payload`会将用户输入的内容写入指定文件，完成利用。存在投毒风险，代码中写文件的行为，可能可以恶意篡改系统文件，也可能上传webshell，风险概率较低。

**项目地址:** [FiroSolutions/cve-2020-7247-exploit](https://github.com/FiroSolutions/cve-2020-7247-exploit)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #2

**来源**: [CVE-2020-7247-QTranspose_CVE-2020-7247-exploit.md](../2020/CVE-2020-7247-QTranspose_CVE-2020-7247-exploit.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可导致完全控制目标系统

**影响版本:** 6.6（受影响版本包括 6.4.0 - 6.6.1）

**利用条件:** 目标系统运行着存在漏洞的 OpenSMTPD，且默认配置未修改

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 允许未经身份验证的远程攻击者以 root 权限在受影响的 OpenSMTPD 服务器上执行任意命令。该漏洞存在于 `smtp_session.c` 文件的 `smtp_mailaddr` 函数中，由于输入验证不充分，导致可以通过在 `MAIL FROM` 字段中注入 shell 元字符来执行命令。

**有效性分析：**

提供的 PoC 代码 (`exploit.py`) 旨在利用此漏洞。它通过以下步骤与目标 OpenSMTPD 服务器交互：

1.  **连接目标：** 连接到目标主机和端口。
2.  **验证 OpenSMTPD：** 检查服务器 banner 以确认目标正在运行 OpenSMTPD。
3.  **发送恶意 MAIL FROM：** 发送包含 shell 元字符的 `MAIL FROM` 命令，从而触发漏洞。
4.  **发送 RCPT TO 和 DATA：** 发送 `RCPT TO` 和 `DATA` 命令以完成 SMTP 握手。
5.  **发送反弹 shell payload：** 在 DATA 部分发送 bash 反弹 shell payload，连接到攻击者的监听端口。
6.  **监听连接：** PoC 启动一个监听器，等待目标服务器反弹 shell 连接。

根据漏洞描述和 PoC 代码，以及搜索引擎结果中 Qualys 和 Rapid7 的分析，该漏洞是可利用的，提供的 PoC 代码在适当条件下应能成功利用。

**投毒风险分析：**

查看`exploit.py`文件，其功能主要是发送构造好的SMTP命令，利用漏洞执行payload。虽然存在执行恶意命令的可能，但这属于漏洞利用的正常流程。`README.md`文件只是说明漏洞和用法。`img/example.svg`文件仅为图片，因此，没有发现明显的恶意代码或隐藏的后门。投毒风险为0%。

**利用方式总结：**

利用此漏洞的步骤如下：

1.  攻击者连接到目标 OpenSMTPD 服务器的 SMTP 端口（通常是 25 端口）。
2.  攻击者发起 SMTP 会话，并发送包含恶意 shell 命令的 `MAIL FROM` 命令。关键在于在 MAIL FROM 中注入了恶意代码：`;for d in x t J z 5 o N G K 9 3 B 1 n Y;do read d;done;bash;exit 0;>`。这段代码本质上利用了 OpenSMTPD 在处理 MAIL FROM 地址时，由于验证不当，会将分号后的内容作为命令执行。
3.  OpenSMTPD 尝试解析 `MAIL FROM` 地址，但由于注入的 shell 元字符，导致执行了攻击者提供的命令。 通常这个命令会通过反弹shell连接到攻击者控制的机器。
4.  如果利用成功，攻击者就可以在目标系统上以 root 权限执行任意命令。

**项目地址:** [QTranspose/CVE-2020-7247-exploit](https://github.com/QTranspose/CVE-2020-7247-exploit)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #3

**来源**: [CVE-2020-7247-SimonSchoeni_CVE-2020-7247-POC.md](../2020/CVE-2020-7247-SimonSchoeni_CVE-2020-7247-POC.md)

# CVE-2020-7247

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-7247-FiroSolutions_cve-2020-7247-exploit.md](../2020/CVE-2020-7247-FiroSolutions_cve-2020-7247-exploit.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致root权限下的远程代码执行

**影响版本:** 6.6

**利用条件:** 需要OpenSMTPD服务未修补，默认配置（未注释）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 允许远程攻击者通过构造恶意的SMTP会话，利用`MAIL FROM`字段中的shell元字符，以root权限执行任意命令。POC代码通过socket连接到目标主机的25端口（SMTP），发送HELO，MAIL FROM，RCPT TO，DATA和QUIT等SMTP命令。`MAIL FROM`命令中注入了shell命令，通过`for i in 0 1 2 3 4 5 6 7 8 9 a b c d;do read r;done;sh;exit 0;`执行shell。`DATA`命令后发送的`payload`会将用户输入的内容写入指定文件，完成利用。存在投毒风险，代码中写文件的行为，可能可以恶意篡改系统文件，也可能上传webshell，风险概率较低。

**项目地址:** [FiroSolutions/cve-2020-7247-exploit](https://github.com/FiroSolutions/cve-2020-7247-exploit)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #2

**来源**: [CVE-2020-7247-QTranspose_CVE-2020-7247-exploit.md](../2020/CVE-2020-7247-QTranspose_CVE-2020-7247-exploit.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可导致完全控制目标系统

**影响版本:** 6.6（受影响版本包括 6.4.0 - 6.6.1）

**利用条件:** 目标系统运行着存在漏洞的 OpenSMTPD，且默认配置未修改

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 允许未经身份验证的远程攻击者以 root 权限在受影响的 OpenSMTPD 服务器上执行任意命令。该漏洞存在于 `smtp_session.c` 文件的 `smtp_mailaddr` 函数中，由于输入验证不充分，导致可以通过在 `MAIL FROM` 字段中注入 shell 元字符来执行命令。

**有效性分析：**

提供的 PoC 代码 (`exploit.py`) 旨在利用此漏洞。它通过以下步骤与目标 OpenSMTPD 服务器交互：

1.  **连接目标：** 连接到目标主机和端口。
2.  **验证 OpenSMTPD：** 检查服务器 banner 以确认目标正在运行 OpenSMTPD。
3.  **发送恶意 MAIL FROM：** 发送包含 shell 元字符的 `MAIL FROM` 命令，从而触发漏洞。
4.  **发送 RCPT TO 和 DATA：** 发送 `RCPT TO` 和 `DATA` 命令以完成 SMTP 握手。
5.  **发送反弹 shell payload：** 在 DATA 部分发送 bash 反弹 shell payload，连接到攻击者的监听端口。
6.  **监听连接：** PoC 启动一个监听器，等待目标服务器反弹 shell 连接。

根据漏洞描述和 PoC 代码，以及搜索引擎结果中 Qualys 和 Rapid7 的分析，该漏洞是可利用的，提供的 PoC 代码在适当条件下应能成功利用。

**投毒风险分析：**

查看`exploit.py`文件，其功能主要是发送构造好的SMTP命令，利用漏洞执行payload。虽然存在执行恶意命令的可能，但这属于漏洞利用的正常流程。`README.md`文件只是说明漏洞和用法。`img/example.svg`文件仅为图片，因此，没有发现明显的恶意代码或隐藏的后门。投毒风险为0%。

**利用方式总结：**

利用此漏洞的步骤如下：

1.  攻击者连接到目标 OpenSMTPD 服务器的 SMTP 端口（通常是 25 端口）。
2.  攻击者发起 SMTP 会话，并发送包含恶意 shell 命令的 `MAIL FROM` 命令。关键在于在 MAIL FROM 中注入了恶意代码：`;for d in x t J z 5 o N G K 9 3 B 1 n Y;do read d;done;bash;exit 0;>`。这段代码本质上利用了 OpenSMTPD 在处理 MAIL FROM 地址时，由于验证不当，会将分号后的内容作为命令执行。
3.  OpenSMTPD 尝试解析 `MAIL FROM` 地址，但由于注入的 shell 元字符，导致执行了攻击者提供的命令。 通常这个命令会通过反弹shell连接到攻击者控制的机器。
4.  如果利用成功，攻击者就可以在目标系统上以 root 权限执行任意命令。

**项目地址:** [QTranspose/CVE-2020-7247-exploit](https://github.com/QTranspose/CVE-2020-7247-exploit)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #3

**来源**: [CVE-2020-7247-SimonSchoeni_CVE-2020-7247-POC.md](../2020/CVE-2020-7247-SimonSchoeni_CVE-2020-7247-POC.md)

# CVE-2020-7247

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-7247-FiroSolutions_cve-2020-7247-exploit.md](../2020/CVE-2020-7247-FiroSolutions_cve-2020-7247-exploit.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致root权限下的远程代码执行

**影响版本:** 6.6

**利用条件:** 需要OpenSMTPD服务未修补，默认配置（未注释）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 允许远程攻击者通过构造恶意的SMTP会话，利用`MAIL FROM`字段中的shell元字符，以root权限执行任意命令。POC代码通过socket连接到目标主机的25端口（SMTP），发送HELO，MAIL FROM，RCPT TO，DATA和QUIT等SMTP命令。`MAIL FROM`命令中注入了shell命令，通过`for i in 0 1 2 3 4 5 6 7 8 9 a b c d;do read r;done;sh;exit 0;`执行shell。`DATA`命令后发送的`payload`会将用户输入的内容写入指定文件，完成利用。存在投毒风险，代码中写文件的行为，可能可以恶意篡改系统文件，也可能上传webshell，风险概率较低。

**项目地址:** [FiroSolutions/cve-2020-7247-exploit](https://github.com/FiroSolutions/cve-2020-7247-exploit)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #2

**来源**: [CVE-2020-7247-QTranspose_CVE-2020-7247-exploit.md](../2020/CVE-2020-7247-QTranspose_CVE-2020-7247-exploit.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可导致完全控制目标系统

**影响版本:** 6.6（受影响版本包括 6.4.0 - 6.6.1）

**利用条件:** 目标系统运行着存在漏洞的 OpenSMTPD，且默认配置未修改

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 允许未经身份验证的远程攻击者以 root 权限在受影响的 OpenSMTPD 服务器上执行任意命令。该漏洞存在于 `smtp_session.c` 文件的 `smtp_mailaddr` 函数中，由于输入验证不充分，导致可以通过在 `MAIL FROM` 字段中注入 shell 元字符来执行命令。

**有效性分析：**

提供的 PoC 代码 (`exploit.py`) 旨在利用此漏洞。它通过以下步骤与目标 OpenSMTPD 服务器交互：

1.  **连接目标：** 连接到目标主机和端口。
2.  **验证 OpenSMTPD：** 检查服务器 banner 以确认目标正在运行 OpenSMTPD。
3.  **发送恶意 MAIL FROM：** 发送包含 shell 元字符的 `MAIL FROM` 命令，从而触发漏洞。
4.  **发送 RCPT TO 和 DATA：** 发送 `RCPT TO` 和 `DATA` 命令以完成 SMTP 握手。
5.  **发送反弹 shell payload：** 在 DATA 部分发送 bash 反弹 shell payload，连接到攻击者的监听端口。
6.  **监听连接：** PoC 启动一个监听器，等待目标服务器反弹 shell 连接。

根据漏洞描述和 PoC 代码，以及搜索引擎结果中 Qualys 和 Rapid7 的分析，该漏洞是可利用的，提供的 PoC 代码在适当条件下应能成功利用。

**投毒风险分析：**

查看`exploit.py`文件，其功能主要是发送构造好的SMTP命令，利用漏洞执行payload。虽然存在执行恶意命令的可能，但这属于漏洞利用的正常流程。`README.md`文件只是说明漏洞和用法。`img/example.svg`文件仅为图片，因此，没有发现明显的恶意代码或隐藏的后门。投毒风险为0%。

**利用方式总结：**

利用此漏洞的步骤如下：

1.  攻击者连接到目标 OpenSMTPD 服务器的 SMTP 端口（通常是 25 端口）。
2.  攻击者发起 SMTP 会话，并发送包含恶意 shell 命令的 `MAIL FROM` 命令。关键在于在 MAIL FROM 中注入了恶意代码：`;for d in x t J z 5 o N G K 9 3 B 1 n Y;do read d;done;bash;exit 0;>`。这段代码本质上利用了 OpenSMTPD 在处理 MAIL FROM 地址时，由于验证不当，会将分号后的内容作为命令执行。
3.  OpenSMTPD 尝试解析 `MAIL FROM` 地址，但由于注入的 shell 元字符，导致执行了攻击者提供的命令。 通常这个命令会通过反弹shell连接到攻击者控制的机器。
4.  如果利用成功，攻击者就可以在目标系统上以 root 权限执行任意命令。

**项目地址:** [QTranspose/CVE-2020-7247-exploit](https://github.com/QTranspose/CVE-2020-7247-exploit)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #3

**来源**: [CVE-2020-7247-SimonSchoeni_CVE-2020-7247-POC.md](../2020/CVE-2020-7247-SimonSchoeni_CVE-2020-7247-POC.md)

# CVE-2020-7247

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-7247-FiroSolutions_cve-2020-7247-exploit.md](../2020/CVE-2020-7247-FiroSolutions_cve-2020-7247-exploit.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致root权限下的远程代码执行

**影响版本:** 6.6

**利用条件:** 需要OpenSMTPD服务未修补，默认配置（未注释）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 允许远程攻击者通过构造恶意的SMTP会话，利用`MAIL FROM`字段中的shell元字符，以root权限执行任意命令。POC代码通过socket连接到目标主机的25端口（SMTP），发送HELO，MAIL FROM，RCPT TO，DATA和QUIT等SMTP命令。`MAIL FROM`命令中注入了shell命令，通过`for i in 0 1 2 3 4 5 6 7 8 9 a b c d;do read r;done;sh;exit 0;`执行shell。`DATA`命令后发送的`payload`会将用户输入的内容写入指定文件，完成利用。存在投毒风险，代码中写文件的行为，可能可以恶意篡改系统文件，也可能上传webshell，风险概率较低。

**项目地址:** [FiroSolutions/cve-2020-7247-exploit](https://github.com/FiroSolutions/cve-2020-7247-exploit)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #2

**来源**: [CVE-2020-7247-QTranspose_CVE-2020-7247-exploit.md](../2020/CVE-2020-7247-QTranspose_CVE-2020-7247-exploit.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可导致完全控制目标系统

**影响版本:** 6.6（受影响版本包括 6.4.0 - 6.6.1）

**利用条件:** 目标系统运行着存在漏洞的 OpenSMTPD，且默认配置未修改

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 允许未经身份验证的远程攻击者以 root 权限在受影响的 OpenSMTPD 服务器上执行任意命令。该漏洞存在于 `smtp_session.c` 文件的 `smtp_mailaddr` 函数中，由于输入验证不充分，导致可以通过在 `MAIL FROM` 字段中注入 shell 元字符来执行命令。

**有效性分析：**

提供的 PoC 代码 (`exploit.py`) 旨在利用此漏洞。它通过以下步骤与目标 OpenSMTPD 服务器交互：

1.  **连接目标：** 连接到目标主机和端口。
2.  **验证 OpenSMTPD：** 检查服务器 banner 以确认目标正在运行 OpenSMTPD。
3.  **发送恶意 MAIL FROM：** 发送包含 shell 元字符的 `MAIL FROM` 命令，从而触发漏洞。
4.  **发送 RCPT TO 和 DATA：** 发送 `RCPT TO` 和 `DATA` 命令以完成 SMTP 握手。
5.  **发送反弹 shell payload：** 在 DATA 部分发送 bash 反弹 shell payload，连接到攻击者的监听端口。
6.  **监听连接：** PoC 启动一个监听器，等待目标服务器反弹 shell 连接。

根据漏洞描述和 PoC 代码，以及搜索引擎结果中 Qualys 和 Rapid7 的分析，该漏洞是可利用的，提供的 PoC 代码在适当条件下应能成功利用。

**投毒风险分析：**

查看`exploit.py`文件，其功能主要是发送构造好的SMTP命令，利用漏洞执行payload。虽然存在执行恶意命令的可能，但这属于漏洞利用的正常流程。`README.md`文件只是说明漏洞和用法。`img/example.svg`文件仅为图片，因此，没有发现明显的恶意代码或隐藏的后门。投毒风险为0%。

**利用方式总结：**

利用此漏洞的步骤如下：

1.  攻击者连接到目标 OpenSMTPD 服务器的 SMTP 端口（通常是 25 端口）。
2.  攻击者发起 SMTP 会话，并发送包含恶意 shell 命令的 `MAIL FROM` 命令。关键在于在 MAIL FROM 中注入了恶意代码：`;for d in x t J z 5 o N G K 9 3 B 1 n Y;do read d;done;bash;exit 0;>`。这段代码本质上利用了 OpenSMTPD 在处理 MAIL FROM 地址时，由于验证不当，会将分号后的内容作为命令执行。
3.  OpenSMTPD 尝试解析 `MAIL FROM` 地址，但由于注入的 shell 元字符，导致执行了攻击者提供的命令。 通常这个命令会通过反弹shell连接到攻击者控制的机器。
4.  如果利用成功，攻击者就可以在目标系统上以 root 权限执行任意命令。

**项目地址:** [QTranspose/CVE-2020-7247-exploit](https://github.com/QTranspose/CVE-2020-7247-exploit)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #3

**来源**: [CVE-2020-7247-SimonSchoeni_CVE-2020-7247-POC.md](../2020/CVE-2020-7247-SimonSchoeni_CVE-2020-7247-POC.md)

# CVE-2020-7247

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-7247-FiroSolutions_cve-2020-7247-exploit.md](../2020/CVE-2020-7247-FiroSolutions_cve-2020-7247-exploit.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致root权限下的远程代码执行

**影响版本:** 6.6

**利用条件:** 需要OpenSMTPD服务未修补，默认配置（未注释）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 允许远程攻击者通过构造恶意的SMTP会话，利用`MAIL FROM`字段中的shell元字符，以root权限执行任意命令。POC代码通过socket连接到目标主机的25端口（SMTP），发送HELO，MAIL FROM，RCPT TO，DATA和QUIT等SMTP命令。`MAIL FROM`命令中注入了shell命令，通过`for i in 0 1 2 3 4 5 6 7 8 9 a b c d;do read r;done;sh;exit 0;`执行shell。`DATA`命令后发送的`payload`会将用户输入的内容写入指定文件，完成利用。存在投毒风险，代码中写文件的行为，可能可以恶意篡改系统文件，也可能上传webshell，风险概率较低。

**项目地址:** [FiroSolutions/cve-2020-7247-exploit](https://github.com/FiroSolutions/cve-2020-7247-exploit)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #2

**来源**: [CVE-2020-7247-QTranspose_CVE-2020-7247-exploit.md](../2020/CVE-2020-7247-QTranspose_CVE-2020-7247-exploit.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可导致完全控制目标系统

**影响版本:** 6.6（受影响版本包括 6.4.0 - 6.6.1）

**利用条件:** 目标系统运行着存在漏洞的 OpenSMTPD，且默认配置未修改

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 允许未经身份验证的远程攻击者以 root 权限在受影响的 OpenSMTPD 服务器上执行任意命令。该漏洞存在于 `smtp_session.c` 文件的 `smtp_mailaddr` 函数中，由于输入验证不充分，导致可以通过在 `MAIL FROM` 字段中注入 shell 元字符来执行命令。

**有效性分析：**

提供的 PoC 代码 (`exploit.py`) 旨在利用此漏洞。它通过以下步骤与目标 OpenSMTPD 服务器交互：

1.  **连接目标：** 连接到目标主机和端口。
2.  **验证 OpenSMTPD：** 检查服务器 banner 以确认目标正在运行 OpenSMTPD。
3.  **发送恶意 MAIL FROM：** 发送包含 shell 元字符的 `MAIL FROM` 命令，从而触发漏洞。
4.  **发送 RCPT TO 和 DATA：** 发送 `RCPT TO` 和 `DATA` 命令以完成 SMTP 握手。
5.  **发送反弹 shell payload：** 在 DATA 部分发送 bash 反弹 shell payload，连接到攻击者的监听端口。
6.  **监听连接：** PoC 启动一个监听器，等待目标服务器反弹 shell 连接。

根据漏洞描述和 PoC 代码，以及搜索引擎结果中 Qualys 和 Rapid7 的分析，该漏洞是可利用的，提供的 PoC 代码在适当条件下应能成功利用。

**投毒风险分析：**

查看`exploit.py`文件，其功能主要是发送构造好的SMTP命令，利用漏洞执行payload。虽然存在执行恶意命令的可能，但这属于漏洞利用的正常流程。`README.md`文件只是说明漏洞和用法。`img/example.svg`文件仅为图片，因此，没有发现明显的恶意代码或隐藏的后门。投毒风险为0%。

**利用方式总结：**

利用此漏洞的步骤如下：

1.  攻击者连接到目标 OpenSMTPD 服务器的 SMTP 端口（通常是 25 端口）。
2.  攻击者发起 SMTP 会话，并发送包含恶意 shell 命令的 `MAIL FROM` 命令。关键在于在 MAIL FROM 中注入了恶意代码：`;for d in x t J z 5 o N G K 9 3 B 1 n Y;do read d;done;bash;exit 0;>`。这段代码本质上利用了 OpenSMTPD 在处理 MAIL FROM 地址时，由于验证不当，会将分号后的内容作为命令执行。
3.  OpenSMTPD 尝试解析 `MAIL FROM` 地址，但由于注入的 shell 元字符，导致执行了攻击者提供的命令。 通常这个命令会通过反弹shell连接到攻击者控制的机器。
4.  如果利用成功，攻击者就可以在目标系统上以 root 权限执行任意命令。

**项目地址:** [QTranspose/CVE-2020-7247-exploit](https://github.com/QTranspose/CVE-2020-7247-exploit)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #3

**来源**: [CVE-2020-7247-SimonSchoeni_CVE-2020-7247-POC.md](../2020/CVE-2020-7247-SimonSchoeni_CVE-2020-7247-POC.md)

# CVE-2020-7247

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-7247-FiroSolutions_cve-2020-7247-exploit.md](../2020/CVE-2020-7247-FiroSolutions_cve-2020-7247-exploit.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致root权限下的远程代码执行

**影响版本:** 6.6

**利用条件:** 需要OpenSMTPD服务未修补，默认配置（未注释）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 允许远程攻击者通过构造恶意的SMTP会话，利用`MAIL FROM`字段中的shell元字符，以root权限执行任意命令。POC代码通过socket连接到目标主机的25端口（SMTP），发送HELO，MAIL FROM，RCPT TO，DATA和QUIT等SMTP命令。`MAIL FROM`命令中注入了shell命令，通过`for i in 0 1 2 3 4 5 6 7 8 9 a b c d;do read r;done;sh;exit 0;`执行shell。`DATA`命令后发送的`payload`会将用户输入的内容写入指定文件，完成利用。存在投毒风险，代码中写文件的行为，可能可以恶意篡改系统文件，也可能上传webshell，风险概率较低。

**项目地址:** [FiroSolutions/cve-2020-7247-exploit](https://github.com/FiroSolutions/cve-2020-7247-exploit)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #2

**来源**: [CVE-2020-7247-QTranspose_CVE-2020-7247-exploit.md](../2020/CVE-2020-7247-QTranspose_CVE-2020-7247-exploit.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可导致完全控制目标系统

**影响版本:** 6.6（受影响版本包括 6.4.0 - 6.6.1）

**利用条件:** 目标系统运行着存在漏洞的 OpenSMTPD，且默认配置未修改

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 允许未经身份验证的远程攻击者以 root 权限在受影响的 OpenSMTPD 服务器上执行任意命令。该漏洞存在于 `smtp_session.c` 文件的 `smtp_mailaddr` 函数中，由于输入验证不充分，导致可以通过在 `MAIL FROM` 字段中注入 shell 元字符来执行命令。

**有效性分析：**

提供的 PoC 代码 (`exploit.py`) 旨在利用此漏洞。它通过以下步骤与目标 OpenSMTPD 服务器交互：

1.  **连接目标：** 连接到目标主机和端口。
2.  **验证 OpenSMTPD：** 检查服务器 banner 以确认目标正在运行 OpenSMTPD。
3.  **发送恶意 MAIL FROM：** 发送包含 shell 元字符的 `MAIL FROM` 命令，从而触发漏洞。
4.  **发送 RCPT TO 和 DATA：** 发送 `RCPT TO` 和 `DATA` 命令以完成 SMTP 握手。
5.  **发送反弹 shell payload：** 在 DATA 部分发送 bash 反弹 shell payload，连接到攻击者的监听端口。
6.  **监听连接：** PoC 启动一个监听器，等待目标服务器反弹 shell 连接。

根据漏洞描述和 PoC 代码，以及搜索引擎结果中 Qualys 和 Rapid7 的分析，该漏洞是可利用的，提供的 PoC 代码在适当条件下应能成功利用。

**投毒风险分析：**

查看`exploit.py`文件，其功能主要是发送构造好的SMTP命令，利用漏洞执行payload。虽然存在执行恶意命令的可能，但这属于漏洞利用的正常流程。`README.md`文件只是说明漏洞和用法。`img/example.svg`文件仅为图片，因此，没有发现明显的恶意代码或隐藏的后门。投毒风险为0%。

**利用方式总结：**

利用此漏洞的步骤如下：

1.  攻击者连接到目标 OpenSMTPD 服务器的 SMTP 端口（通常是 25 端口）。
2.  攻击者发起 SMTP 会话，并发送包含恶意 shell 命令的 `MAIL FROM` 命令。关键在于在 MAIL FROM 中注入了恶意代码：`;for d in x t J z 5 o N G K 9 3 B 1 n Y;do read d;done;bash;exit 0;>`。这段代码本质上利用了 OpenSMTPD 在处理 MAIL FROM 地址时，由于验证不当，会将分号后的内容作为命令执行。
3.  OpenSMTPD 尝试解析 `MAIL FROM` 地址，但由于注入的 shell 元字符，导致执行了攻击者提供的命令。 通常这个命令会通过反弹shell连接到攻击者控制的机器。
4.  如果利用成功，攻击者就可以在目标系统上以 root 权限执行任意命令。

**项目地址:** [QTranspose/CVE-2020-7247-exploit](https://github.com/QTranspose/CVE-2020-7247-exploit)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #3

**来源**: [CVE-2020-7247-SimonSchoeni_CVE-2020-7247-POC.md](../2020/CVE-2020-7247-SimonSchoeni_CVE-2020-7247-POC.md)

# CVE-2020-7247

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-7247-FiroSolutions_cve-2020-7247-exploit.md](../2020/CVE-2020-7247-FiroSolutions_cve-2020-7247-exploit.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致root权限下的远程代码执行

**影响版本:** 6.6

**利用条件:** 需要OpenSMTPD服务未修补，默认配置（未注释）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 允许远程攻击者通过构造恶意的SMTP会话，利用`MAIL FROM`字段中的shell元字符，以root权限执行任意命令。POC代码通过socket连接到目标主机的25端口（SMTP），发送HELO，MAIL FROM，RCPT TO，DATA和QUIT等SMTP命令。`MAIL FROM`命令中注入了shell命令，通过`for i in 0 1 2 3 4 5 6 7 8 9 a b c d;do read r;done;sh;exit 0;`执行shell。`DATA`命令后发送的`payload`会将用户输入的内容写入指定文件，完成利用。存在投毒风险，代码中写文件的行为，可能可以恶意篡改系统文件，也可能上传webshell，风险概率较低。

**项目地址:** [FiroSolutions/cve-2020-7247-exploit](https://github.com/FiroSolutions/cve-2020-7247-exploit)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #2

**来源**: [CVE-2020-7247-QTranspose_CVE-2020-7247-exploit.md](../2020/CVE-2020-7247-QTranspose_CVE-2020-7247-exploit.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可导致完全控制目标系统

**影响版本:** 6.6（受影响版本包括 6.4.0 - 6.6.1）

**利用条件:** 目标系统运行着存在漏洞的 OpenSMTPD，且默认配置未修改

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 允许未经身份验证的远程攻击者以 root 权限在受影响的 OpenSMTPD 服务器上执行任意命令。该漏洞存在于 `smtp_session.c` 文件的 `smtp_mailaddr` 函数中，由于输入验证不充分，导致可以通过在 `MAIL FROM` 字段中注入 shell 元字符来执行命令。

**有效性分析：**

提供的 PoC 代码 (`exploit.py`) 旨在利用此漏洞。它通过以下步骤与目标 OpenSMTPD 服务器交互：

1.  **连接目标：** 连接到目标主机和端口。
2.  **验证 OpenSMTPD：** 检查服务器 banner 以确认目标正在运行 OpenSMTPD。
3.  **发送恶意 MAIL FROM：** 发送包含 shell 元字符的 `MAIL FROM` 命令，从而触发漏洞。
4.  **发送 RCPT TO 和 DATA：** 发送 `RCPT TO` 和 `DATA` 命令以完成 SMTP 握手。
5.  **发送反弹 shell payload：** 在 DATA 部分发送 bash 反弹 shell payload，连接到攻击者的监听端口。
6.  **监听连接：** PoC 启动一个监听器，等待目标服务器反弹 shell 连接。

根据漏洞描述和 PoC 代码，以及搜索引擎结果中 Qualys 和 Rapid7 的分析，该漏洞是可利用的，提供的 PoC 代码在适当条件下应能成功利用。

**投毒风险分析：**

查看`exploit.py`文件，其功能主要是发送构造好的SMTP命令，利用漏洞执行payload。虽然存在执行恶意命令的可能，但这属于漏洞利用的正常流程。`README.md`文件只是说明漏洞和用法。`img/example.svg`文件仅为图片，因此，没有发现明显的恶意代码或隐藏的后门。投毒风险为0%。

**利用方式总结：**

利用此漏洞的步骤如下：

1.  攻击者连接到目标 OpenSMTPD 服务器的 SMTP 端口（通常是 25 端口）。
2.  攻击者发起 SMTP 会话，并发送包含恶意 shell 命令的 `MAIL FROM` 命令。关键在于在 MAIL FROM 中注入了恶意代码：`;for d in x t J z 5 o N G K 9 3 B 1 n Y;do read d;done;bash;exit 0;>`。这段代码本质上利用了 OpenSMTPD 在处理 MAIL FROM 地址时，由于验证不当，会将分号后的内容作为命令执行。
3.  OpenSMTPD 尝试解析 `MAIL FROM` 地址，但由于注入的 shell 元字符，导致执行了攻击者提供的命令。 通常这个命令会通过反弹shell连接到攻击者控制的机器。
4.  如果利用成功，攻击者就可以在目标系统上以 root 权限执行任意命令。

**项目地址:** [QTranspose/CVE-2020-7247-exploit](https://github.com/QTranspose/CVE-2020-7247-exploit)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #3

**来源**: [CVE-2020-7247-SimonSchoeni_CVE-2020-7247-POC.md](../2020/CVE-2020-7247-SimonSchoeni_CVE-2020-7247-POC.md)

# CVE-2020-7247

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-7247-FiroSolutions_cve-2020-7247-exploit.md](../2020/CVE-2020-7247-FiroSolutions_cve-2020-7247-exploit.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致root权限下的远程代码执行

**影响版本:** 6.6

**利用条件:** 需要OpenSMTPD服务未修补，默认配置（未注释）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 允许远程攻击者通过构造恶意的SMTP会话，利用`MAIL FROM`字段中的shell元字符，以root权限执行任意命令。POC代码通过socket连接到目标主机的25端口（SMTP），发送HELO，MAIL FROM，RCPT TO，DATA和QUIT等SMTP命令。`MAIL FROM`命令中注入了shell命令，通过`for i in 0 1 2 3 4 5 6 7 8 9 a b c d;do read r;done;sh;exit 0;`执行shell。`DATA`命令后发送的`payload`会将用户输入的内容写入指定文件，完成利用。存在投毒风险，代码中写文件的行为，可能可以恶意篡改系统文件，也可能上传webshell，风险概率较低。

**项目地址:** [FiroSolutions/cve-2020-7247-exploit](https://github.com/FiroSolutions/cve-2020-7247-exploit)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #2

**来源**: [CVE-2020-7247-QTranspose_CVE-2020-7247-exploit.md](../2020/CVE-2020-7247-QTranspose_CVE-2020-7247-exploit.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可导致完全控制目标系统

**影响版本:** 6.6（受影响版本包括 6.4.0 - 6.6.1）

**利用条件:** 目标系统运行着存在漏洞的 OpenSMTPD，且默认配置未修改

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 允许未经身份验证的远程攻击者以 root 权限在受影响的 OpenSMTPD 服务器上执行任意命令。该漏洞存在于 `smtp_session.c` 文件的 `smtp_mailaddr` 函数中，由于输入验证不充分，导致可以通过在 `MAIL FROM` 字段中注入 shell 元字符来执行命令。

**有效性分析：**

提供的 PoC 代码 (`exploit.py`) 旨在利用此漏洞。它通过以下步骤与目标 OpenSMTPD 服务器交互：

1.  **连接目标：** 连接到目标主机和端口。
2.  **验证 OpenSMTPD：** 检查服务器 banner 以确认目标正在运行 OpenSMTPD。
3.  **发送恶意 MAIL FROM：** 发送包含 shell 元字符的 `MAIL FROM` 命令，从而触发漏洞。
4.  **发送 RCPT TO 和 DATA：** 发送 `RCPT TO` 和 `DATA` 命令以完成 SMTP 握手。
5.  **发送反弹 shell payload：** 在 DATA 部分发送 bash 反弹 shell payload，连接到攻击者的监听端口。
6.  **监听连接：** PoC 启动一个监听器，等待目标服务器反弹 shell 连接。

根据漏洞描述和 PoC 代码，以及搜索引擎结果中 Qualys 和 Rapid7 的分析，该漏洞是可利用的，提供的 PoC 代码在适当条件下应能成功利用。

**投毒风险分析：**

查看`exploit.py`文件，其功能主要是发送构造好的SMTP命令，利用漏洞执行payload。虽然存在执行恶意命令的可能，但这属于漏洞利用的正常流程。`README.md`文件只是说明漏洞和用法。`img/example.svg`文件仅为图片，因此，没有发现明显的恶意代码或隐藏的后门。投毒风险为0%。

**利用方式总结：**

利用此漏洞的步骤如下：

1.  攻击者连接到目标 OpenSMTPD 服务器的 SMTP 端口（通常是 25 端口）。
2.  攻击者发起 SMTP 会话，并发送包含恶意 shell 命令的 `MAIL FROM` 命令。关键在于在 MAIL FROM 中注入了恶意代码：`;for d in x t J z 5 o N G K 9 3 B 1 n Y;do read d;done;bash;exit 0;>`。这段代码本质上利用了 OpenSMTPD 在处理 MAIL FROM 地址时，由于验证不当，会将分号后的内容作为命令执行。
3.  OpenSMTPD 尝试解析 `MAIL FROM` 地址，但由于注入的 shell 元字符，导致执行了攻击者提供的命令。 通常这个命令会通过反弹shell连接到攻击者控制的机器。
4.  如果利用成功，攻击者就可以在目标系统上以 root 权限执行任意命令。

**项目地址:** [QTranspose/CVE-2020-7247-exploit](https://github.com/QTranspose/CVE-2020-7247-exploit)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #3

**来源**: [CVE-2020-7247-SimonSchoeni_CVE-2020-7247-POC.md](../2020/CVE-2020-7247-SimonSchoeni_CVE-2020-7247-POC.md)

# CVE-2020-7247

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-7247-FiroSolutions_cve-2020-7247-exploit.md](../2020/CVE-2020-7247-FiroSolutions_cve-2020-7247-exploit.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致root权限下的远程代码执行

**影响版本:** 6.6

**利用条件:** 需要OpenSMTPD服务未修补，默认配置（未注释）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 允许远程攻击者通过构造恶意的SMTP会话，利用`MAIL FROM`字段中的shell元字符，以root权限执行任意命令。POC代码通过socket连接到目标主机的25端口（SMTP），发送HELO，MAIL FROM，RCPT TO，DATA和QUIT等SMTP命令。`MAIL FROM`命令中注入了shell命令，通过`for i in 0 1 2 3 4 5 6 7 8 9 a b c d;do read r;done;sh;exit 0;`执行shell。`DATA`命令后发送的`payload`会将用户输入的内容写入指定文件，完成利用。存在投毒风险，代码中写文件的行为，可能可以恶意篡改系统文件，也可能上传webshell，风险概率较低。

**项目地址:** [FiroSolutions/cve-2020-7247-exploit](https://github.com/FiroSolutions/cve-2020-7247-exploit)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #2

**来源**: [CVE-2020-7247-QTranspose_CVE-2020-7247-exploit.md](../2020/CVE-2020-7247-QTranspose_CVE-2020-7247-exploit.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可导致完全控制目标系统

**影响版本:** 6.6（受影响版本包括 6.4.0 - 6.6.1）

**利用条件:** 目标系统运行着存在漏洞的 OpenSMTPD，且默认配置未修改

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 允许未经身份验证的远程攻击者以 root 权限在受影响的 OpenSMTPD 服务器上执行任意命令。该漏洞存在于 `smtp_session.c` 文件的 `smtp_mailaddr` 函数中，由于输入验证不充分，导致可以通过在 `MAIL FROM` 字段中注入 shell 元字符来执行命令。

**有效性分析：**

提供的 PoC 代码 (`exploit.py`) 旨在利用此漏洞。它通过以下步骤与目标 OpenSMTPD 服务器交互：

1.  **连接目标：** 连接到目标主机和端口。
2.  **验证 OpenSMTPD：** 检查服务器 banner 以确认目标正在运行 OpenSMTPD。
3.  **发送恶意 MAIL FROM：** 发送包含 shell 元字符的 `MAIL FROM` 命令，从而触发漏洞。
4.  **发送 RCPT TO 和 DATA：** 发送 `RCPT TO` 和 `DATA` 命令以完成 SMTP 握手。
5.  **发送反弹 shell payload：** 在 DATA 部分发送 bash 反弹 shell payload，连接到攻击者的监听端口。
6.  **监听连接：** PoC 启动一个监听器，等待目标服务器反弹 shell 连接。

根据漏洞描述和 PoC 代码，以及搜索引擎结果中 Qualys 和 Rapid7 的分析，该漏洞是可利用的，提供的 PoC 代码在适当条件下应能成功利用。

**投毒风险分析：**

查看`exploit.py`文件，其功能主要是发送构造好的SMTP命令，利用漏洞执行payload。虽然存在执行恶意命令的可能，但这属于漏洞利用的正常流程。`README.md`文件只是说明漏洞和用法。`img/example.svg`文件仅为图片，因此，没有发现明显的恶意代码或隐藏的后门。投毒风险为0%。

**利用方式总结：**

利用此漏洞的步骤如下：

1.  攻击者连接到目标 OpenSMTPD 服务器的 SMTP 端口（通常是 25 端口）。
2.  攻击者发起 SMTP 会话，并发送包含恶意 shell 命令的 `MAIL FROM` 命令。关键在于在 MAIL FROM 中注入了恶意代码：`;for d in x t J z 5 o N G K 9 3 B 1 n Y;do read d;done;bash;exit 0;>`。这段代码本质上利用了 OpenSMTPD 在处理 MAIL FROM 地址时，由于验证不当，会将分号后的内容作为命令执行。
3.  OpenSMTPD 尝试解析 `MAIL FROM` 地址，但由于注入的 shell 元字符，导致执行了攻击者提供的命令。 通常这个命令会通过反弹shell连接到攻击者控制的机器。
4.  如果利用成功，攻击者就可以在目标系统上以 root 权限执行任意命令。

**项目地址:** [QTranspose/CVE-2020-7247-exploit](https://github.com/QTranspose/CVE-2020-7247-exploit)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #3

**来源**: [CVE-2020-7247-SimonSchoeni_CVE-2020-7247-POC.md](../2020/CVE-2020-7247-SimonSchoeni_CVE-2020-7247-POC.md)

# CVE-2020-7247

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-7247-FiroSolutions_cve-2020-7247-exploit.md](../2020/CVE-2020-7247-FiroSolutions_cve-2020-7247-exploit.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致root权限下的远程代码执行

**影响版本:** 6.6

**利用条件:** 需要OpenSMTPD服务未修补，默认配置（未注释）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 允许远程攻击者通过构造恶意的SMTP会话，利用`MAIL FROM`字段中的shell元字符，以root权限执行任意命令。POC代码通过socket连接到目标主机的25端口（SMTP），发送HELO，MAIL FROM，RCPT TO，DATA和QUIT等SMTP命令。`MAIL FROM`命令中注入了shell命令，通过`for i in 0 1 2 3 4 5 6 7 8 9 a b c d;do read r;done;sh;exit 0;`执行shell。`DATA`命令后发送的`payload`会将用户输入的内容写入指定文件，完成利用。存在投毒风险，代码中写文件的行为，可能可以恶意篡改系统文件，也可能上传webshell，风险概率较低。

**项目地址:** [FiroSolutions/cve-2020-7247-exploit](https://github.com/FiroSolutions/cve-2020-7247-exploit)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #2

**来源**: [CVE-2020-7247-QTranspose_CVE-2020-7247-exploit.md](../2020/CVE-2020-7247-QTranspose_CVE-2020-7247-exploit.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可导致完全控制目标系统

**影响版本:** 6.6（受影响版本包括 6.4.0 - 6.6.1）

**利用条件:** 目标系统运行着存在漏洞的 OpenSMTPD，且默认配置未修改

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 允许未经身份验证的远程攻击者以 root 权限在受影响的 OpenSMTPD 服务器上执行任意命令。该漏洞存在于 `smtp_session.c` 文件的 `smtp_mailaddr` 函数中，由于输入验证不充分，导致可以通过在 `MAIL FROM` 字段中注入 shell 元字符来执行命令。

**有效性分析：**

提供的 PoC 代码 (`exploit.py`) 旨在利用此漏洞。它通过以下步骤与目标 OpenSMTPD 服务器交互：

1.  **连接目标：** 连接到目标主机和端口。
2.  **验证 OpenSMTPD：** 检查服务器 banner 以确认目标正在运行 OpenSMTPD。
3.  **发送恶意 MAIL FROM：** 发送包含 shell 元字符的 `MAIL FROM` 命令，从而触发漏洞。
4.  **发送 RCPT TO 和 DATA：** 发送 `RCPT TO` 和 `DATA` 命令以完成 SMTP 握手。
5.  **发送反弹 shell payload：** 在 DATA 部分发送 bash 反弹 shell payload，连接到攻击者的监听端口。
6.  **监听连接：** PoC 启动一个监听器，等待目标服务器反弹 shell 连接。

根据漏洞描述和 PoC 代码，以及搜索引擎结果中 Qualys 和 Rapid7 的分析，该漏洞是可利用的，提供的 PoC 代码在适当条件下应能成功利用。

**投毒风险分析：**

查看`exploit.py`文件，其功能主要是发送构造好的SMTP命令，利用漏洞执行payload。虽然存在执行恶意命令的可能，但这属于漏洞利用的正常流程。`README.md`文件只是说明漏洞和用法。`img/example.svg`文件仅为图片，因此，没有发现明显的恶意代码或隐藏的后门。投毒风险为0%。

**利用方式总结：**

利用此漏洞的步骤如下：

1.  攻击者连接到目标 OpenSMTPD 服务器的 SMTP 端口（通常是 25 端口）。
2.  攻击者发起 SMTP 会话，并发送包含恶意 shell 命令的 `MAIL FROM` 命令。关键在于在 MAIL FROM 中注入了恶意代码：`;for d in x t J z 5 o N G K 9 3 B 1 n Y;do read d;done;bash;exit 0;>`。这段代码本质上利用了 OpenSMTPD 在处理 MAIL FROM 地址时，由于验证不当，会将分号后的内容作为命令执行。
3.  OpenSMTPD 尝试解析 `MAIL FROM` 地址，但由于注入的 shell 元字符，导致执行了攻击者提供的命令。 通常这个命令会通过反弹shell连接到攻击者控制的机器。
4.  如果利用成功，攻击者就可以在目标系统上以 root 权限执行任意命令。

**项目地址:** [QTranspose/CVE-2020-7247-exploit](https://github.com/QTranspose/CVE-2020-7247-exploit)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #3

**来源**: [CVE-2020-7247-SimonSchoeni_CVE-2020-7247-POC.md](../2020/CVE-2020-7247-SimonSchoeni_CVE-2020-7247-POC.md)

# CVE-2020-7247

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-7247-FiroSolutions_cve-2020-7247-exploit.md](../2020/CVE-2020-7247-FiroSolutions_cve-2020-7247-exploit.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致root权限下的远程代码执行

**影响版本:** 6.6

**利用条件:** 需要OpenSMTPD服务未修补，默认配置（未注释）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 允许远程攻击者通过构造恶意的SMTP会话，利用`MAIL FROM`字段中的shell元字符，以root权限执行任意命令。POC代码通过socket连接到目标主机的25端口（SMTP），发送HELO，MAIL FROM，RCPT TO，DATA和QUIT等SMTP命令。`MAIL FROM`命令中注入了shell命令，通过`for i in 0 1 2 3 4 5 6 7 8 9 a b c d;do read r;done;sh;exit 0;`执行shell。`DATA`命令后发送的`payload`会将用户输入的内容写入指定文件，完成利用。存在投毒风险，代码中写文件的行为，可能可以恶意篡改系统文件，也可能上传webshell，风险概率较低。

**项目地址:** [FiroSolutions/cve-2020-7247-exploit](https://github.com/FiroSolutions/cve-2020-7247-exploit)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #2

**来源**: [CVE-2020-7247-QTranspose_CVE-2020-7247-exploit.md](../2020/CVE-2020-7247-QTranspose_CVE-2020-7247-exploit.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可导致完全控制目标系统

**影响版本:** 6.6（受影响版本包括 6.4.0 - 6.6.1）

**利用条件:** 目标系统运行着存在漏洞的 OpenSMTPD，且默认配置未修改

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 允许未经身份验证的远程攻击者以 root 权限在受影响的 OpenSMTPD 服务器上执行任意命令。该漏洞存在于 `smtp_session.c` 文件的 `smtp_mailaddr` 函数中，由于输入验证不充分，导致可以通过在 `MAIL FROM` 字段中注入 shell 元字符来执行命令。

**有效性分析：**

提供的 PoC 代码 (`exploit.py`) 旨在利用此漏洞。它通过以下步骤与目标 OpenSMTPD 服务器交互：

1.  **连接目标：** 连接到目标主机和端口。
2.  **验证 OpenSMTPD：** 检查服务器 banner 以确认目标正在运行 OpenSMTPD。
3.  **发送恶意 MAIL FROM：** 发送包含 shell 元字符的 `MAIL FROM` 命令，从而触发漏洞。
4.  **发送 RCPT TO 和 DATA：** 发送 `RCPT TO` 和 `DATA` 命令以完成 SMTP 握手。
5.  **发送反弹 shell payload：** 在 DATA 部分发送 bash 反弹 shell payload，连接到攻击者的监听端口。
6.  **监听连接：** PoC 启动一个监听器，等待目标服务器反弹 shell 连接。

根据漏洞描述和 PoC 代码，以及搜索引擎结果中 Qualys 和 Rapid7 的分析，该漏洞是可利用的，提供的 PoC 代码在适当条件下应能成功利用。

**投毒风险分析：**

查看`exploit.py`文件，其功能主要是发送构造好的SMTP命令，利用漏洞执行payload。虽然存在执行恶意命令的可能，但这属于漏洞利用的正常流程。`README.md`文件只是说明漏洞和用法。`img/example.svg`文件仅为图片，因此，没有发现明显的恶意代码或隐藏的后门。投毒风险为0%。

**利用方式总结：**

利用此漏洞的步骤如下：

1.  攻击者连接到目标 OpenSMTPD 服务器的 SMTP 端口（通常是 25 端口）。
2.  攻击者发起 SMTP 会话，并发送包含恶意 shell 命令的 `MAIL FROM` 命令。关键在于在 MAIL FROM 中注入了恶意代码：`;for d in x t J z 5 o N G K 9 3 B 1 n Y;do read d;done;bash;exit 0;>`。这段代码本质上利用了 OpenSMTPD 在处理 MAIL FROM 地址时，由于验证不当，会将分号后的内容作为命令执行。
3.  OpenSMTPD 尝试解析 `MAIL FROM` 地址，但由于注入的 shell 元字符，导致执行了攻击者提供的命令。 通常这个命令会通过反弹shell连接到攻击者控制的机器。
4.  如果利用成功，攻击者就可以在目标系统上以 root 权限执行任意命令。

**项目地址:** [QTranspose/CVE-2020-7247-exploit](https://github.com/QTranspose/CVE-2020-7247-exploit)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #3

**来源**: [CVE-2020-7247-SimonSchoeni_CVE-2020-7247-POC.md](../2020/CVE-2020-7247-SimonSchoeni_CVE-2020-7247-POC.md)

# CVE-2020-7247

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-7247-FiroSolutions_cve-2020-7247-exploit.md](../2020/CVE-2020-7247-FiroSolutions_cve-2020-7247-exploit.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致root权限下的远程代码执行

**影响版本:** 6.6

**利用条件:** 需要OpenSMTPD服务未修补，默认配置（未注释）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 允许远程攻击者通过构造恶意的SMTP会话，利用`MAIL FROM`字段中的shell元字符，以root权限执行任意命令。POC代码通过socket连接到目标主机的25端口（SMTP），发送HELO，MAIL FROM，RCPT TO，DATA和QUIT等SMTP命令。`MAIL FROM`命令中注入了shell命令，通过`for i in 0 1 2 3 4 5 6 7 8 9 a b c d;do read r;done;sh;exit 0;`执行shell。`DATA`命令后发送的`payload`会将用户输入的内容写入指定文件，完成利用。存在投毒风险，代码中写文件的行为，可能可以恶意篡改系统文件，也可能上传webshell，风险概率较低。

**项目地址:** [FiroSolutions/cve-2020-7247-exploit](https://github.com/FiroSolutions/cve-2020-7247-exploit)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #2

**来源**: [CVE-2020-7247-QTranspose_CVE-2020-7247-exploit.md](../2020/CVE-2020-7247-QTranspose_CVE-2020-7247-exploit.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可导致完全控制目标系统

**影响版本:** 6.6（受影响版本包括 6.4.0 - 6.6.1）

**利用条件:** 目标系统运行着存在漏洞的 OpenSMTPD，且默认配置未修改

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 允许未经身份验证的远程攻击者以 root 权限在受影响的 OpenSMTPD 服务器上执行任意命令。该漏洞存在于 `smtp_session.c` 文件的 `smtp_mailaddr` 函数中，由于输入验证不充分，导致可以通过在 `MAIL FROM` 字段中注入 shell 元字符来执行命令。

**有效性分析：**

提供的 PoC 代码 (`exploit.py`) 旨在利用此漏洞。它通过以下步骤与目标 OpenSMTPD 服务器交互：

1.  **连接目标：** 连接到目标主机和端口。
2.  **验证 OpenSMTPD：** 检查服务器 banner 以确认目标正在运行 OpenSMTPD。
3.  **发送恶意 MAIL FROM：** 发送包含 shell 元字符的 `MAIL FROM` 命令，从而触发漏洞。
4.  **发送 RCPT TO 和 DATA：** 发送 `RCPT TO` 和 `DATA` 命令以完成 SMTP 握手。
5.  **发送反弹 shell payload：** 在 DATA 部分发送 bash 反弹 shell payload，连接到攻击者的监听端口。
6.  **监听连接：** PoC 启动一个监听器，等待目标服务器反弹 shell 连接。

根据漏洞描述和 PoC 代码，以及搜索引擎结果中 Qualys 和 Rapid7 的分析，该漏洞是可利用的，提供的 PoC 代码在适当条件下应能成功利用。

**投毒风险分析：**

查看`exploit.py`文件，其功能主要是发送构造好的SMTP命令，利用漏洞执行payload。虽然存在执行恶意命令的可能，但这属于漏洞利用的正常流程。`README.md`文件只是说明漏洞和用法。`img/example.svg`文件仅为图片，因此，没有发现明显的恶意代码或隐藏的后门。投毒风险为0%。

**利用方式总结：**

利用此漏洞的步骤如下：

1.  攻击者连接到目标 OpenSMTPD 服务器的 SMTP 端口（通常是 25 端口）。
2.  攻击者发起 SMTP 会话，并发送包含恶意 shell 命令的 `MAIL FROM` 命令。关键在于在 MAIL FROM 中注入了恶意代码：`;for d in x t J z 5 o N G K 9 3 B 1 n Y;do read d;done;bash;exit 0;>`。这段代码本质上利用了 OpenSMTPD 在处理 MAIL FROM 地址时，由于验证不当，会将分号后的内容作为命令执行。
3.  OpenSMTPD 尝试解析 `MAIL FROM` 地址，但由于注入的 shell 元字符，导致执行了攻击者提供的命令。 通常这个命令会通过反弹shell连接到攻击者控制的机器。
4.  如果利用成功，攻击者就可以在目标系统上以 root 权限执行任意命令。

**项目地址:** [QTranspose/CVE-2020-7247-exploit](https://github.com/QTranspose/CVE-2020-7247-exploit)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #3

**来源**: [CVE-2020-7247-bytescrappers_CVE-2020-7247.md](../2020/CVE-2020-7247-bytescrappers_CVE-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，允许远程攻击者以root权限执行任意命令

**影响版本:** 6.6

**利用条件:** 目标系统运行存在漏洞的OpenSMTPD 6.6，并且配置为默认的“uncommented”配置，允许未授权的SMTP连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 smtp_session.c 文件中的 smtp_mailaddr 函数中。攻击者可以通过在 MAIL FROM 字段中注入 shell 元字符，利用不正确的输入验证返回值来执行任意命令，从而实现远程代码执行。根据提供的POC代码，攻击者首先建立与目标SMTP服务器的连接，然后发送 HELO 命令，接着发送包含恶意 shell 命令的 MAIL FROM 命令，该命令利用了漏洞。然后发送 RCPT TO、DATA 命令，再发送包含一段特殊格式的payload, 最后发送 QUIT 命令结束会话。漏洞利用的关键在于MAIL FROM命令中的shell命令注入，利用 OpenSMTPD 未正确处理的漏洞点，执行任意命令。因为漏洞利用代码中的payload部分是接受命令行的参数，没有发现额外的后门代码，所以判定投毒风险为0%。搜索引擎结果确认该漏洞的存在，并指出利用该漏洞可以执行任意shell命令。

**项目地址:** [bytescrappers/CVE-2020-7247](https://github.com/bytescrappers/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #4

**来源**: [CVE-2020-7247-f4T1H21_CVE-2020-7247.md](../2020/CVE-2020-7247-f4T1H21_CVE-2020-7247.md)

## CVE-2020-7247 OpenSMTPD 远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，允许远程攻击者以root权限执行任意命令

**影响版本:** 6.6

**利用条件:** 目标服务器运行受影响版本的OpenSMTPD，并且使用默认配置（未注释）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 `smtp_session.c` 文件中的 `smtp_mailaddr` 函数中。由于对输入验证的错误处理，远程攻击者可以通过构造包含 shell 元字符的 `MAIL FROM` 字段的 SMTP 会话来执行任意命令。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在公开可用的漏洞利用代码。 因此,提供的漏洞利用代码有效。

**投毒风险：** 提供的漏洞利用代码只包含 GNU GPL v3 许可协议的内容，没有发现恶意代码或后门，因此可以判断不存在投毒风险。投毒风险为0%。

**利用方式：**

1.  攻击者与目标 OpenSMTPD 服务器建立 SMTP 连接。
2.  攻击者在 `MAIL FROM` 命令中插入包含 shell 元字符的恶意命令。例如：`MAIL FROM:<;touch /tmp/vuln;>`。
3.  OpenSMTPD 在处理 `MAIL FROM` 地址时，由于输入验证不当，会将恶意命令传递给 shell 执行，从而导致远程命令执行。
4. 攻击者可以利用此漏洞以 root 权限在目标服务器上执行任意命令。

**项目地址:** [f4T1H21/CVE-2020-7247](https://github.com/f4T1H21/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #5

**来源**: [CVE-2020-7247-minhluannguyen_CVE-2020-7247-reproducer.md](../2020/CVE-2020-7247-minhluannguyen_CVE-2020-7247-reproducer.md)

## CVE-2020-7247-OpenSMTPD-RCE

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 6.6

**利用条件:** OpenSMTPD 6.6默认配置，未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247是一个存在于OpenSMTPD 6.6的远程代码执行漏洞。该漏洞位于`smtp_session.c`中的`smtp_mailaddr`函数，由于输入验证不当，允许远程攻击者通过精心构造的SMTP会话，在`MAIL FROM`字段中注入shell元字符，从而以root权限执行任意命令。默认配置下，OpenSMTPD会错误地处理包含shell元字符的`MAIL FROM`地址。攻击者利用点在于`MAIL FROM`参数，通过注入恶意的shell命令，造成远程代码执行。

**有效性评估：**

提供的漏洞利用代码似乎有效。`exploit.py`脚本通过socket连接到目标OpenSMTPD服务器，发送HELO、MAIL FROM、RCPT TO和DATA等SMTP命令，在`MAIL FROM`命令中包含了payload，该payload试图执行反弹shell。Docker文件用于搭建存在漏洞的OpenSMTPD环境，便于验证。

**投毒风险评估：**

经过分析，此仓库中存在作者隐藏的投毒代码可能性较低，约占10%。主要依据如下：
1. `exploit.py`明确地展示了利用payload进行反弹shell，行为明确。
2. Dockerfile 拉取了指定的debian版本，降低了被投毒的可能，同时Dockerfile指定快照源，降低了通过依赖引入投毒的风险。
3. Nix 文件 只是dockerfile的另外一种描述方式，目的是为了构建docker镜像，与投毒无关。

但仍然存在一定的投毒可能：
1. 在`exploit.py`的payload中，攻击者可能会通过某种方式尝试上传或修改服务器上的其他文件，或者运行一些隐蔽的恶意命令，这种行为没有在POC里清晰展示。
2. 其他配置文件中可能存在隐藏的后门或者配置缺陷，不过可能性较低。

**利用方式：**

1.  攻击者首先需要与目标OpenSMTPD服务器建立SMTP连接（端口25）。
2.  发送`HELO`命令进行握手。
3.  关键步骤：发送`MAIL FROM`命令，并在邮件地址中插入shell元字符和恶意命令。例如：`MAIL FROM:<;恶意命令;>`
4.  发送`RCPT TO`命令指定收件人。
5.  发送`DATA`命令，并发送邮件内容（可以为空）。
6.  服务器在处理`MAIL FROM`地址时，由于漏洞，会执行注入的shell命令。
7.  攻击者通过监听指定端口，接收反弹shell，从而获得目标服务器的root权限。

总结：该漏洞利用难度较低，只需要构造特定的SMTP会话，即可触发远程代码执行。

**项目地址:** [minhluannguyen/CVE-2020-7247-reproducer](https://github.com/minhluannguyen/CVE-2020-7247-reproducer)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #6

**来源**: [CVE-2020-7247-presentdaypresenttime_shai_hulud.md](../2020/CVE-2020-7247-presentdaypresenttime_shai_hulud.md)

## CVE-2020-7247 - OpenSMTPD 远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 6.6

**利用条件:** 目标服务器运行OpenSMTPD 6.6版本，且使用未注释的默认配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 smtp_session.c 文件中的 smtp_mailaddr 函数中。由于输入验证不正确，远程攻击者可以通过构造包含 shell 元字符的 MAIL FROM 字段的 SMTP 会话，以 root 权限执行任意命令。提供的漏洞利用代码 (infect.py) 尝试利用此漏洞。该代码首先使用 nmap 扫描局域网以发现潜在的 OpenSMTPD 服务器，然后尝试连接到这些服务器并在 MAIL FROM 字段中注入命令。漏洞利用脚本尝试下载并执行 `woot.sh` 脚本，这个脚本的功能未知，存在潜在的投毒风险。 docker-compose.yml 脚本配置了多个 OpenSMTPD 实例，用于搭建测试环境。\n\n**有效性:** 根据漏洞信息和搜索引擎结果，该漏洞利用的有效性较高。漏洞库信息和搜索结果都确认了该漏洞的存在和可利用性。\n\n**投毒风险:** `infect.py` 中包含从 `raw.githubusercontent.com/presentdaypresenttime/shai_hulud/main/woot.sh` 下载并执行脚本的代码，该脚本内容未知，存在潜在的投毒风险，攻击者可以通过修改 `woot.sh` 的内容植入恶意代码。因此，投毒风险评估为10%。\n\n**利用方式:** 漏洞利用的步骤如下：\n1. 使用 nmap 扫描局域网，发现运行 OpenSMTPD 服务的服务器。\n2. 连接到目标服务器的 25 端口。\n3. 发送 HELO 命令建立连接。\n4. 发送包含恶意命令的 MAIL FROM 命令，利用 shell 注入漏洞执行命令。\n5. 发送 RCPT TO, DATA 命令模拟邮件发送过程。\n6. 发送 QUIT 命令断开连接。

**项目地址:** [presentdaypresenttime/shai_hulud](https://github.com/presentdaypresenttime/shai_hulud)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #7

**来源**: [CVE-2020-7247-r0lh_CVE-2020-7247.md](../2020/CVE-2020-7247-r0lh_CVE-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可导致以root权限执行任意命令

**影响版本:** < 6.6.2

**利用条件:** 目标服务器运行存在漏洞的OpenSMTPD版本，且允许SMTP连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-7247 存在于 OpenSMTPD 6.6 版本中，由于在 `smtp_session.c` 文件的 `smtp_mailaddr` 函数中，对输入验证失败时返回了错误的值，导致攻击者可以通过在 `MAIL FROM` 字段中注入 shell 元字符，从而以 root 权限执行任意命令。该漏洞影响使用默认配置（未注释）的 OpenSMTPD 服务器。

**漏洞利用方式：**

1.  **连接目标SMTP服务器：** 利用代码首先尝试连接到目标 OpenSMTPD 服务器的 25 端口 (或其他指定的端口)。
2.  **发送HELO命令：**  与服务器建立 SMTP 会话。
3.  **注入恶意payload：** 在`MAIL FROM`命令中使用shell元字符，执行命令。
4.  **设置接收者：** 使用`RCPT TO`命令设置邮件接收者。
5.  **发送DATA命令：** 发送`DATA`命令，并发送包含反弹shell命令的payload。
6.  **启动监听：**  攻击者使用 `nc` 命令监听指定端口，等待目标服务器反弹 shell 连接。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用的有效性较高。POC代码已经公开，并且多个来源证实可以通过`MAIL FROM`注入执行任意命令。

**投毒风险：**

POC代码主要是利用 OpenSMTPD 漏洞实现反弹 shell。代码中存在设置监听端口和IP地址的操作，但这是反弹shell的必要步骤，不能直接判定为投毒。代码本身较为直接，没有发现明显的恶意或隐藏行为。投毒风险极小，但需要评估代码执行的payload，风险评估约为5%。


**项目地址:** [r0lh/CVE-2020-7247](https://github.com/r0lh/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #8

**来源**: [CVE-2020-7247-superzerosec_cve-2020-7247.md](../2020/CVE-2020-7247-superzerosec_cve-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致完全控制受影响的服务器

**影响版本:** < 6.6.2

**利用条件:** 需要目标服务器运行OpenSMTPD服务，且配置为默认的未注释配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 存在于OpenSMTPD 6.6.2之前的版本中。攻击者可以通过在`MAIL FROM`字段中注入shell元字符，利用SMTP会话执行任意系统命令，获得root权限。漏洞的根本原因是程序没有充分过滤用户可控的输入。

**有效性:** 提供的POC代码（poc1.py）看起来是有效的。它使用`pwn`库来建立与目标SMTP服务器的连接，并发送一系列SMTP命令，其中`MAIL FROM`命令包含恶意shell代码。如果目标服务器存在漏洞，这段代码将执行任意命令。

**投毒风险:**  POC代码主要目的是利用该漏洞，实现远程命令执行。其中值得关注的点：

*   **使用mkfifo创建管道:** 代码使用`mkfifo`创建一个命名管道`/tmp/nnwo`，然后使用`nc`将命令发送到该管道，并通过`/bin/sh`执行，最后将结果重定向到该管道，并将错误信息也重定向。这个过程本身是为了建立一个反向shell。
*   **清除痕迹:** 代码尝试在攻击完成后通过`pkill nc`清除网络连接的痕迹。


以下情况可以视为潜在的投毒代码风险：

* **恶意payload替换：** POC中可以使用更具破坏性的命令，例如删除关键系统文件或者植入长期后门程序。
* **后门植入：**  虽然`pkill nc`试图清除痕迹，但更隐蔽的后门可能被安装，以便后续访问。

综合考虑，该POC主要是为了验证漏洞的存在并执行命令。但是，因为执行了网络连接和创建管道等操作，存在一定被滥用和修改为更具恶意目的的可能性。 因此，将其判定为有 **10%** 的投毒风险。

**利用方式:**

1.  **建立SMTP连接:** 使用`pwn`库与目标OpenSMTPD服务器建立TCP连接。
2.  **发送SMTP命令序列:** 发送`HELO`、`MAIL FROM`、`RCPT TO`和`DATA`等SMTP命令。
3.  **注入恶意代码:** 在`MAIL FROM`命令中，通过注入shell元字符，构造恶意shell命令。例如，``MAIL FROM:<;for i in r j A F L X;do read;done;sh;exit 0;>``
4.  **发送Payload:** 在`DATA`命令之后，发送实际要执行的命令。POC中使用`mkfifo`和`nc`来建立反向shell连接。
5.  **监听反向Shell:** 攻击者在本地主机上使用`nc`监听指定的端口，等待目标服务器建立连接，从而获得shell访问权限。
6.  **清理痕迹:** 攻击完成后，尝试清除在目标系统上留下的痕迹（如通过`pkill nc`杀死nc进程）。

**项目地址:** [superzerosec/cve-2020-7247](https://github.com/superzerosec/cve-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---



---

## POC #4

**来源**: [CVE-2020-7247-bytescrappers_CVE-2020-7247.md](../2020/CVE-2020-7247-bytescrappers_CVE-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，允许远程攻击者以root权限执行任意命令

**影响版本:** 6.6

**利用条件:** 目标系统运行存在漏洞的OpenSMTPD 6.6，并且配置为默认的“uncommented”配置，允许未授权的SMTP连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 smtp_session.c 文件中的 smtp_mailaddr 函数中。攻击者可以通过在 MAIL FROM 字段中注入 shell 元字符，利用不正确的输入验证返回值来执行任意命令，从而实现远程代码执行。根据提供的POC代码，攻击者首先建立与目标SMTP服务器的连接，然后发送 HELO 命令，接着发送包含恶意 shell 命令的 MAIL FROM 命令，该命令利用了漏洞。然后发送 RCPT TO、DATA 命令，再发送包含一段特殊格式的payload, 最后发送 QUIT 命令结束会话。漏洞利用的关键在于MAIL FROM命令中的shell命令注入，利用 OpenSMTPD 未正确处理的漏洞点，执行任意命令。因为漏洞利用代码中的payload部分是接受命令行的参数，没有发现额外的后门代码，所以判定投毒风险为0%。搜索引擎结果确认该漏洞的存在，并指出利用该漏洞可以执行任意shell命令。

**项目地址:** [bytescrappers/CVE-2020-7247](https://github.com/bytescrappers/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #5

**来源**: [CVE-2020-7247-f4T1H21_CVE-2020-7247.md](../2020/CVE-2020-7247-f4T1H21_CVE-2020-7247.md)

## CVE-2020-7247 OpenSMTPD 远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，允许远程攻击者以root权限执行任意命令

**影响版本:** 6.6

**利用条件:** 目标服务器运行受影响版本的OpenSMTPD，并且使用默认配置（未注释）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 `smtp_session.c` 文件中的 `smtp_mailaddr` 函数中。由于对输入验证的错误处理，远程攻击者可以通过构造包含 shell 元字符的 `MAIL FROM` 字段的 SMTP 会话来执行任意命令。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在公开可用的漏洞利用代码。 因此,提供的漏洞利用代码有效。

**投毒风险：** 提供的漏洞利用代码只包含 GNU GPL v3 许可协议的内容，没有发现恶意代码或后门，因此可以判断不存在投毒风险。投毒风险为0%。

**利用方式：**

1.  攻击者与目标 OpenSMTPD 服务器建立 SMTP 连接。
2.  攻击者在 `MAIL FROM` 命令中插入包含 shell 元字符的恶意命令。例如：`MAIL FROM:<;touch /tmp/vuln;>`。
3.  OpenSMTPD 在处理 `MAIL FROM` 地址时，由于输入验证不当，会将恶意命令传递给 shell 执行，从而导致远程命令执行。
4. 攻击者可以利用此漏洞以 root 权限在目标服务器上执行任意命令。

**项目地址:** [f4T1H21/CVE-2020-7247](https://github.com/f4T1H21/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #6

**来源**: [CVE-2020-7247-minhluannguyen_CVE-2020-7247-reproducer.md](../2020/CVE-2020-7247-minhluannguyen_CVE-2020-7247-reproducer.md)

## CVE-2020-7247-OpenSMTPD-RCE

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 6.6

**利用条件:** OpenSMTPD 6.6默认配置，未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247是一个存在于OpenSMTPD 6.6的远程代码执行漏洞。该漏洞位于`smtp_session.c`中的`smtp_mailaddr`函数，由于输入验证不当，允许远程攻击者通过精心构造的SMTP会话，在`MAIL FROM`字段中注入shell元字符，从而以root权限执行任意命令。默认配置下，OpenSMTPD会错误地处理包含shell元字符的`MAIL FROM`地址。攻击者利用点在于`MAIL FROM`参数，通过注入恶意的shell命令，造成远程代码执行。

**有效性评估：**

提供的漏洞利用代码似乎有效。`exploit.py`脚本通过socket连接到目标OpenSMTPD服务器，发送HELO、MAIL FROM、RCPT TO和DATA等SMTP命令，在`MAIL FROM`命令中包含了payload，该payload试图执行反弹shell。Docker文件用于搭建存在漏洞的OpenSMTPD环境，便于验证。

**投毒风险评估：**

经过分析，此仓库中存在作者隐藏的投毒代码可能性较低，约占10%。主要依据如下：
1. `exploit.py`明确地展示了利用payload进行反弹shell，行为明确。
2. Dockerfile 拉取了指定的debian版本，降低了被投毒的可能，同时Dockerfile指定快照源，降低了通过依赖引入投毒的风险。
3. Nix 文件 只是dockerfile的另外一种描述方式，目的是为了构建docker镜像，与投毒无关。

但仍然存在一定的投毒可能：
1. 在`exploit.py`的payload中，攻击者可能会通过某种方式尝试上传或修改服务器上的其他文件，或者运行一些隐蔽的恶意命令，这种行为没有在POC里清晰展示。
2. 其他配置文件中可能存在隐藏的后门或者配置缺陷，不过可能性较低。

**利用方式：**

1.  攻击者首先需要与目标OpenSMTPD服务器建立SMTP连接（端口25）。
2.  发送`HELO`命令进行握手。
3.  关键步骤：发送`MAIL FROM`命令，并在邮件地址中插入shell元字符和恶意命令。例如：`MAIL FROM:<;恶意命令;>`
4.  发送`RCPT TO`命令指定收件人。
5.  发送`DATA`命令，并发送邮件内容（可以为空）。
6.  服务器在处理`MAIL FROM`地址时，由于漏洞，会执行注入的shell命令。
7.  攻击者通过监听指定端口，接收反弹shell，从而获得目标服务器的root权限。

总结：该漏洞利用难度较低，只需要构造特定的SMTP会话，即可触发远程代码执行。

**项目地址:** [minhluannguyen/CVE-2020-7247-reproducer](https://github.com/minhluannguyen/CVE-2020-7247-reproducer)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #7

**来源**: [CVE-2020-7247-presentdaypresenttime_shai_hulud.md](../2020/CVE-2020-7247-presentdaypresenttime_shai_hulud.md)

## CVE-2020-7247 - OpenSMTPD 远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 6.6

**利用条件:** 目标服务器运行OpenSMTPD 6.6版本，且使用未注释的默认配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 smtp_session.c 文件中的 smtp_mailaddr 函数中。由于输入验证不正确，远程攻击者可以通过构造包含 shell 元字符的 MAIL FROM 字段的 SMTP 会话，以 root 权限执行任意命令。提供的漏洞利用代码 (infect.py) 尝试利用此漏洞。该代码首先使用 nmap 扫描局域网以发现潜在的 OpenSMTPD 服务器，然后尝试连接到这些服务器并在 MAIL FROM 字段中注入命令。漏洞利用脚本尝试下载并执行 `woot.sh` 脚本，这个脚本的功能未知，存在潜在的投毒风险。 docker-compose.yml 脚本配置了多个 OpenSMTPD 实例，用于搭建测试环境。\n\n**有效性:** 根据漏洞信息和搜索引擎结果，该漏洞利用的有效性较高。漏洞库信息和搜索结果都确认了该漏洞的存在和可利用性。\n\n**投毒风险:** `infect.py` 中包含从 `raw.githubusercontent.com/presentdaypresenttime/shai_hulud/main/woot.sh` 下载并执行脚本的代码，该脚本内容未知，存在潜在的投毒风险，攻击者可以通过修改 `woot.sh` 的内容植入恶意代码。因此，投毒风险评估为10%。\n\n**利用方式:** 漏洞利用的步骤如下：\n1. 使用 nmap 扫描局域网，发现运行 OpenSMTPD 服务的服务器。\n2. 连接到目标服务器的 25 端口。\n3. 发送 HELO 命令建立连接。\n4. 发送包含恶意命令的 MAIL FROM 命令，利用 shell 注入漏洞执行命令。\n5. 发送 RCPT TO, DATA 命令模拟邮件发送过程。\n6. 发送 QUIT 命令断开连接。

**项目地址:** [presentdaypresenttime/shai_hulud](https://github.com/presentdaypresenttime/shai_hulud)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #8

**来源**: [CVE-2020-7247-r0lh_CVE-2020-7247.md](../2020/CVE-2020-7247-r0lh_CVE-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可导致以root权限执行任意命令

**影响版本:** < 6.6.2

**利用条件:** 目标服务器运行存在漏洞的OpenSMTPD版本，且允许SMTP连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-7247 存在于 OpenSMTPD 6.6 版本中，由于在 `smtp_session.c` 文件的 `smtp_mailaddr` 函数中，对输入验证失败时返回了错误的值，导致攻击者可以通过在 `MAIL FROM` 字段中注入 shell 元字符，从而以 root 权限执行任意命令。该漏洞影响使用默认配置（未注释）的 OpenSMTPD 服务器。

**漏洞利用方式：**

1.  **连接目标SMTP服务器：** 利用代码首先尝试连接到目标 OpenSMTPD 服务器的 25 端口 (或其他指定的端口)。
2.  **发送HELO命令：**  与服务器建立 SMTP 会话。
3.  **注入恶意payload：** 在`MAIL FROM`命令中使用shell元字符，执行命令。
4.  **设置接收者：** 使用`RCPT TO`命令设置邮件接收者。
5.  **发送DATA命令：** 发送`DATA`命令，并发送包含反弹shell命令的payload。
6.  **启动监听：**  攻击者使用 `nc` 命令监听指定端口，等待目标服务器反弹 shell 连接。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用的有效性较高。POC代码已经公开，并且多个来源证实可以通过`MAIL FROM`注入执行任意命令。

**投毒风险：**

POC代码主要是利用 OpenSMTPD 漏洞实现反弹 shell。代码中存在设置监听端口和IP地址的操作，但这是反弹shell的必要步骤，不能直接判定为投毒。代码本身较为直接，没有发现明显的恶意或隐藏行为。投毒风险极小，但需要评估代码执行的payload，风险评估约为5%。


**项目地址:** [r0lh/CVE-2020-7247](https://github.com/r0lh/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #9

**来源**: [CVE-2020-7247-superzerosec_cve-2020-7247.md](../2020/CVE-2020-7247-superzerosec_cve-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致完全控制受影响的服务器

**影响版本:** < 6.6.2

**利用条件:** 需要目标服务器运行OpenSMTPD服务，且配置为默认的未注释配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 存在于OpenSMTPD 6.6.2之前的版本中。攻击者可以通过在`MAIL FROM`字段中注入shell元字符，利用SMTP会话执行任意系统命令，获得root权限。漏洞的根本原因是程序没有充分过滤用户可控的输入。

**有效性:** 提供的POC代码（poc1.py）看起来是有效的。它使用`pwn`库来建立与目标SMTP服务器的连接，并发送一系列SMTP命令，其中`MAIL FROM`命令包含恶意shell代码。如果目标服务器存在漏洞，这段代码将执行任意命令。

**投毒风险:**  POC代码主要目的是利用该漏洞，实现远程命令执行。其中值得关注的点：

*   **使用mkfifo创建管道:** 代码使用`mkfifo`创建一个命名管道`/tmp/nnwo`，然后使用`nc`将命令发送到该管道，并通过`/bin/sh`执行，最后将结果重定向到该管道，并将错误信息也重定向。这个过程本身是为了建立一个反向shell。
*   **清除痕迹:** 代码尝试在攻击完成后通过`pkill nc`清除网络连接的痕迹。


以下情况可以视为潜在的投毒代码风险：

* **恶意payload替换：** POC中可以使用更具破坏性的命令，例如删除关键系统文件或者植入长期后门程序。
* **后门植入：**  虽然`pkill nc`试图清除痕迹，但更隐蔽的后门可能被安装，以便后续访问。

综合考虑，该POC主要是为了验证漏洞的存在并执行命令。但是，因为执行了网络连接和创建管道等操作，存在一定被滥用和修改为更具恶意目的的可能性。 因此，将其判定为有 **10%** 的投毒风险。

**利用方式:**

1.  **建立SMTP连接:** 使用`pwn`库与目标OpenSMTPD服务器建立TCP连接。
2.  **发送SMTP命令序列:** 发送`HELO`、`MAIL FROM`、`RCPT TO`和`DATA`等SMTP命令。
3.  **注入恶意代码:** 在`MAIL FROM`命令中，通过注入shell元字符，构造恶意shell命令。例如，``MAIL FROM:<;for i in r j A F L X;do read;done;sh;exit 0;>``
4.  **发送Payload:** 在`DATA`命令之后，发送实际要执行的命令。POC中使用`mkfifo`和`nc`来建立反向shell连接。
5.  **监听反向Shell:** 攻击者在本地主机上使用`nc`监听指定的端口，等待目标服务器建立连接，从而获得shell访问权限。
6.  **清理痕迹:** 攻击完成后，尝试清除在目标系统上留下的痕迹（如通过`pkill nc`杀死nc进程）。

**项目地址:** [superzerosec/cve-2020-7247](https://github.com/superzerosec/cve-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---



---

## POC #4

**来源**: [CVE-2020-7247-bytescrappers_CVE-2020-7247.md](../2020/CVE-2020-7247-bytescrappers_CVE-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，允许远程攻击者以root权限执行任意命令

**影响版本:** 6.6

**利用条件:** 目标系统运行存在漏洞的OpenSMTPD 6.6，并且配置为默认的“uncommented”配置，允许未授权的SMTP连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 smtp_session.c 文件中的 smtp_mailaddr 函数中。攻击者可以通过在 MAIL FROM 字段中注入 shell 元字符，利用不正确的输入验证返回值来执行任意命令，从而实现远程代码执行。根据提供的POC代码，攻击者首先建立与目标SMTP服务器的连接，然后发送 HELO 命令，接着发送包含恶意 shell 命令的 MAIL FROM 命令，该命令利用了漏洞。然后发送 RCPT TO、DATA 命令，再发送包含一段特殊格式的payload, 最后发送 QUIT 命令结束会话。漏洞利用的关键在于MAIL FROM命令中的shell命令注入，利用 OpenSMTPD 未正确处理的漏洞点，执行任意命令。因为漏洞利用代码中的payload部分是接受命令行的参数，没有发现额外的后门代码，所以判定投毒风险为0%。搜索引擎结果确认该漏洞的存在，并指出利用该漏洞可以执行任意shell命令。

**项目地址:** [bytescrappers/CVE-2020-7247](https://github.com/bytescrappers/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #5

**来源**: [CVE-2020-7247-f4T1H21_CVE-2020-7247.md](../2020/CVE-2020-7247-f4T1H21_CVE-2020-7247.md)

## CVE-2020-7247 OpenSMTPD 远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，允许远程攻击者以root权限执行任意命令

**影响版本:** 6.6

**利用条件:** 目标服务器运行受影响版本的OpenSMTPD，并且使用默认配置（未注释）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 `smtp_session.c` 文件中的 `smtp_mailaddr` 函数中。由于对输入验证的错误处理，远程攻击者可以通过构造包含 shell 元字符的 `MAIL FROM` 字段的 SMTP 会话来执行任意命令。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在公开可用的漏洞利用代码。 因此,提供的漏洞利用代码有效。

**投毒风险：** 提供的漏洞利用代码只包含 GNU GPL v3 许可协议的内容，没有发现恶意代码或后门，因此可以判断不存在投毒风险。投毒风险为0%。

**利用方式：**

1.  攻击者与目标 OpenSMTPD 服务器建立 SMTP 连接。
2.  攻击者在 `MAIL FROM` 命令中插入包含 shell 元字符的恶意命令。例如：`MAIL FROM:<;touch /tmp/vuln;>`。
3.  OpenSMTPD 在处理 `MAIL FROM` 地址时，由于输入验证不当，会将恶意命令传递给 shell 执行，从而导致远程命令执行。
4. 攻击者可以利用此漏洞以 root 权限在目标服务器上执行任意命令。

**项目地址:** [f4T1H21/CVE-2020-7247](https://github.com/f4T1H21/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #6

**来源**: [CVE-2020-7247-minhluannguyen_CVE-2020-7247-reproducer.md](../2020/CVE-2020-7247-minhluannguyen_CVE-2020-7247-reproducer.md)

## CVE-2020-7247-OpenSMTPD-RCE

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 6.6

**利用条件:** OpenSMTPD 6.6默认配置，未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247是一个存在于OpenSMTPD 6.6的远程代码执行漏洞。该漏洞位于`smtp_session.c`中的`smtp_mailaddr`函数，由于输入验证不当，允许远程攻击者通过精心构造的SMTP会话，在`MAIL FROM`字段中注入shell元字符，从而以root权限执行任意命令。默认配置下，OpenSMTPD会错误地处理包含shell元字符的`MAIL FROM`地址。攻击者利用点在于`MAIL FROM`参数，通过注入恶意的shell命令，造成远程代码执行。

**有效性评估：**

提供的漏洞利用代码似乎有效。`exploit.py`脚本通过socket连接到目标OpenSMTPD服务器，发送HELO、MAIL FROM、RCPT TO和DATA等SMTP命令，在`MAIL FROM`命令中包含了payload，该payload试图执行反弹shell。Docker文件用于搭建存在漏洞的OpenSMTPD环境，便于验证。

**投毒风险评估：**

经过分析，此仓库中存在作者隐藏的投毒代码可能性较低，约占10%。主要依据如下：
1. `exploit.py`明确地展示了利用payload进行反弹shell，行为明确。
2. Dockerfile 拉取了指定的debian版本，降低了被投毒的可能，同时Dockerfile指定快照源，降低了通过依赖引入投毒的风险。
3. Nix 文件 只是dockerfile的另外一种描述方式，目的是为了构建docker镜像，与投毒无关。

但仍然存在一定的投毒可能：
1. 在`exploit.py`的payload中，攻击者可能会通过某种方式尝试上传或修改服务器上的其他文件，或者运行一些隐蔽的恶意命令，这种行为没有在POC里清晰展示。
2. 其他配置文件中可能存在隐藏的后门或者配置缺陷，不过可能性较低。

**利用方式：**

1.  攻击者首先需要与目标OpenSMTPD服务器建立SMTP连接（端口25）。
2.  发送`HELO`命令进行握手。
3.  关键步骤：发送`MAIL FROM`命令，并在邮件地址中插入shell元字符和恶意命令。例如：`MAIL FROM:<;恶意命令;>`
4.  发送`RCPT TO`命令指定收件人。
5.  发送`DATA`命令，并发送邮件内容（可以为空）。
6.  服务器在处理`MAIL FROM`地址时，由于漏洞，会执行注入的shell命令。
7.  攻击者通过监听指定端口，接收反弹shell，从而获得目标服务器的root权限。

总结：该漏洞利用难度较低，只需要构造特定的SMTP会话，即可触发远程代码执行。

**项目地址:** [minhluannguyen/CVE-2020-7247-reproducer](https://github.com/minhluannguyen/CVE-2020-7247-reproducer)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #7

**来源**: [CVE-2020-7247-presentdaypresenttime_shai_hulud.md](../2020/CVE-2020-7247-presentdaypresenttime_shai_hulud.md)

## CVE-2020-7247 - OpenSMTPD 远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 6.6

**利用条件:** 目标服务器运行OpenSMTPD 6.6版本，且使用未注释的默认配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 smtp_session.c 文件中的 smtp_mailaddr 函数中。由于输入验证不正确，远程攻击者可以通过构造包含 shell 元字符的 MAIL FROM 字段的 SMTP 会话，以 root 权限执行任意命令。提供的漏洞利用代码 (infect.py) 尝试利用此漏洞。该代码首先使用 nmap 扫描局域网以发现潜在的 OpenSMTPD 服务器，然后尝试连接到这些服务器并在 MAIL FROM 字段中注入命令。漏洞利用脚本尝试下载并执行 `woot.sh` 脚本，这个脚本的功能未知，存在潜在的投毒风险。 docker-compose.yml 脚本配置了多个 OpenSMTPD 实例，用于搭建测试环境。\n\n**有效性:** 根据漏洞信息和搜索引擎结果，该漏洞利用的有效性较高。漏洞库信息和搜索结果都确认了该漏洞的存在和可利用性。\n\n**投毒风险:** `infect.py` 中包含从 `raw.githubusercontent.com/presentdaypresenttime/shai_hulud/main/woot.sh` 下载并执行脚本的代码，该脚本内容未知，存在潜在的投毒风险，攻击者可以通过修改 `woot.sh` 的内容植入恶意代码。因此，投毒风险评估为10%。\n\n**利用方式:** 漏洞利用的步骤如下：\n1. 使用 nmap 扫描局域网，发现运行 OpenSMTPD 服务的服务器。\n2. 连接到目标服务器的 25 端口。\n3. 发送 HELO 命令建立连接。\n4. 发送包含恶意命令的 MAIL FROM 命令，利用 shell 注入漏洞执行命令。\n5. 发送 RCPT TO, DATA 命令模拟邮件发送过程。\n6. 发送 QUIT 命令断开连接。

**项目地址:** [presentdaypresenttime/shai_hulud](https://github.com/presentdaypresenttime/shai_hulud)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #8

**来源**: [CVE-2020-7247-r0lh_CVE-2020-7247.md](../2020/CVE-2020-7247-r0lh_CVE-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可导致以root权限执行任意命令

**影响版本:** < 6.6.2

**利用条件:** 目标服务器运行存在漏洞的OpenSMTPD版本，且允许SMTP连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-7247 存在于 OpenSMTPD 6.6 版本中，由于在 `smtp_session.c` 文件的 `smtp_mailaddr` 函数中，对输入验证失败时返回了错误的值，导致攻击者可以通过在 `MAIL FROM` 字段中注入 shell 元字符，从而以 root 权限执行任意命令。该漏洞影响使用默认配置（未注释）的 OpenSMTPD 服务器。

**漏洞利用方式：**

1.  **连接目标SMTP服务器：** 利用代码首先尝试连接到目标 OpenSMTPD 服务器的 25 端口 (或其他指定的端口)。
2.  **发送HELO命令：**  与服务器建立 SMTP 会话。
3.  **注入恶意payload：** 在`MAIL FROM`命令中使用shell元字符，执行命令。
4.  **设置接收者：** 使用`RCPT TO`命令设置邮件接收者。
5.  **发送DATA命令：** 发送`DATA`命令，并发送包含反弹shell命令的payload。
6.  **启动监听：**  攻击者使用 `nc` 命令监听指定端口，等待目标服务器反弹 shell 连接。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用的有效性较高。POC代码已经公开，并且多个来源证实可以通过`MAIL FROM`注入执行任意命令。

**投毒风险：**

POC代码主要是利用 OpenSMTPD 漏洞实现反弹 shell。代码中存在设置监听端口和IP地址的操作，但这是反弹shell的必要步骤，不能直接判定为投毒。代码本身较为直接，没有发现明显的恶意或隐藏行为。投毒风险极小，但需要评估代码执行的payload，风险评估约为5%。


**项目地址:** [r0lh/CVE-2020-7247](https://github.com/r0lh/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #9

**来源**: [CVE-2020-7247-superzerosec_cve-2020-7247.md](../2020/CVE-2020-7247-superzerosec_cve-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致完全控制受影响的服务器

**影响版本:** < 6.6.2

**利用条件:** 需要目标服务器运行OpenSMTPD服务，且配置为默认的未注释配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 存在于OpenSMTPD 6.6.2之前的版本中。攻击者可以通过在`MAIL FROM`字段中注入shell元字符，利用SMTP会话执行任意系统命令，获得root权限。漏洞的根本原因是程序没有充分过滤用户可控的输入。

**有效性:** 提供的POC代码（poc1.py）看起来是有效的。它使用`pwn`库来建立与目标SMTP服务器的连接，并发送一系列SMTP命令，其中`MAIL FROM`命令包含恶意shell代码。如果目标服务器存在漏洞，这段代码将执行任意命令。

**投毒风险:**  POC代码主要目的是利用该漏洞，实现远程命令执行。其中值得关注的点：

*   **使用mkfifo创建管道:** 代码使用`mkfifo`创建一个命名管道`/tmp/nnwo`，然后使用`nc`将命令发送到该管道，并通过`/bin/sh`执行，最后将结果重定向到该管道，并将错误信息也重定向。这个过程本身是为了建立一个反向shell。
*   **清除痕迹:** 代码尝试在攻击完成后通过`pkill nc`清除网络连接的痕迹。


以下情况可以视为潜在的投毒代码风险：

* **恶意payload替换：** POC中可以使用更具破坏性的命令，例如删除关键系统文件或者植入长期后门程序。
* **后门植入：**  虽然`pkill nc`试图清除痕迹，但更隐蔽的后门可能被安装，以便后续访问。

综合考虑，该POC主要是为了验证漏洞的存在并执行命令。但是，因为执行了网络连接和创建管道等操作，存在一定被滥用和修改为更具恶意目的的可能性。 因此，将其判定为有 **10%** 的投毒风险。

**利用方式:**

1.  **建立SMTP连接:** 使用`pwn`库与目标OpenSMTPD服务器建立TCP连接。
2.  **发送SMTP命令序列:** 发送`HELO`、`MAIL FROM`、`RCPT TO`和`DATA`等SMTP命令。
3.  **注入恶意代码:** 在`MAIL FROM`命令中，通过注入shell元字符，构造恶意shell命令。例如，``MAIL FROM:<;for i in r j A F L X;do read;done;sh;exit 0;>``
4.  **发送Payload:** 在`DATA`命令之后，发送实际要执行的命令。POC中使用`mkfifo`和`nc`来建立反向shell连接。
5.  **监听反向Shell:** 攻击者在本地主机上使用`nc`监听指定的端口，等待目标服务器建立连接，从而获得shell访问权限。
6.  **清理痕迹:** 攻击完成后，尝试清除在目标系统上留下的痕迹（如通过`pkill nc`杀死nc进程）。

**项目地址:** [superzerosec/cve-2020-7247](https://github.com/superzerosec/cve-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---



---

## POC #4

**来源**: [CVE-2020-7247-bytescrappers_CVE-2020-7247.md](../2020/CVE-2020-7247-bytescrappers_CVE-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，允许远程攻击者以root权限执行任意命令

**影响版本:** 6.6

**利用条件:** 目标系统运行存在漏洞的OpenSMTPD 6.6，并且配置为默认的“uncommented”配置，允许未授权的SMTP连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 smtp_session.c 文件中的 smtp_mailaddr 函数中。攻击者可以通过在 MAIL FROM 字段中注入 shell 元字符，利用不正确的输入验证返回值来执行任意命令，从而实现远程代码执行。根据提供的POC代码，攻击者首先建立与目标SMTP服务器的连接，然后发送 HELO 命令，接着发送包含恶意 shell 命令的 MAIL FROM 命令，该命令利用了漏洞。然后发送 RCPT TO、DATA 命令，再发送包含一段特殊格式的payload, 最后发送 QUIT 命令结束会话。漏洞利用的关键在于MAIL FROM命令中的shell命令注入，利用 OpenSMTPD 未正确处理的漏洞点，执行任意命令。因为漏洞利用代码中的payload部分是接受命令行的参数，没有发现额外的后门代码，所以判定投毒风险为0%。搜索引擎结果确认该漏洞的存在，并指出利用该漏洞可以执行任意shell命令。

**项目地址:** [bytescrappers/CVE-2020-7247](https://github.com/bytescrappers/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #5

**来源**: [CVE-2020-7247-f4T1H21_CVE-2020-7247.md](../2020/CVE-2020-7247-f4T1H21_CVE-2020-7247.md)

## CVE-2020-7247 OpenSMTPD 远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，允许远程攻击者以root权限执行任意命令

**影响版本:** 6.6

**利用条件:** 目标服务器运行受影响版本的OpenSMTPD，并且使用默认配置（未注释）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 `smtp_session.c` 文件中的 `smtp_mailaddr` 函数中。由于对输入验证的错误处理，远程攻击者可以通过构造包含 shell 元字符的 `MAIL FROM` 字段的 SMTP 会话来执行任意命令。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在公开可用的漏洞利用代码。 因此,提供的漏洞利用代码有效。

**投毒风险：** 提供的漏洞利用代码只包含 GNU GPL v3 许可协议的内容，没有发现恶意代码或后门，因此可以判断不存在投毒风险。投毒风险为0%。

**利用方式：**

1.  攻击者与目标 OpenSMTPD 服务器建立 SMTP 连接。
2.  攻击者在 `MAIL FROM` 命令中插入包含 shell 元字符的恶意命令。例如：`MAIL FROM:<;touch /tmp/vuln;>`。
3.  OpenSMTPD 在处理 `MAIL FROM` 地址时，由于输入验证不当，会将恶意命令传递给 shell 执行，从而导致远程命令执行。
4. 攻击者可以利用此漏洞以 root 权限在目标服务器上执行任意命令。

**项目地址:** [f4T1H21/CVE-2020-7247](https://github.com/f4T1H21/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #6

**来源**: [CVE-2020-7247-minhluannguyen_CVE-2020-7247-reproducer.md](../2020/CVE-2020-7247-minhluannguyen_CVE-2020-7247-reproducer.md)

## CVE-2020-7247-OpenSMTPD-RCE

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 6.6

**利用条件:** OpenSMTPD 6.6默认配置，未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247是一个存在于OpenSMTPD 6.6的远程代码执行漏洞。该漏洞位于`smtp_session.c`中的`smtp_mailaddr`函数，由于输入验证不当，允许远程攻击者通过精心构造的SMTP会话，在`MAIL FROM`字段中注入shell元字符，从而以root权限执行任意命令。默认配置下，OpenSMTPD会错误地处理包含shell元字符的`MAIL FROM`地址。攻击者利用点在于`MAIL FROM`参数，通过注入恶意的shell命令，造成远程代码执行。

**有效性评估：**

提供的漏洞利用代码似乎有效。`exploit.py`脚本通过socket连接到目标OpenSMTPD服务器，发送HELO、MAIL FROM、RCPT TO和DATA等SMTP命令，在`MAIL FROM`命令中包含了payload，该payload试图执行反弹shell。Docker文件用于搭建存在漏洞的OpenSMTPD环境，便于验证。

**投毒风险评估：**

经过分析，此仓库中存在作者隐藏的投毒代码可能性较低，约占10%。主要依据如下：
1. `exploit.py`明确地展示了利用payload进行反弹shell，行为明确。
2. Dockerfile 拉取了指定的debian版本，降低了被投毒的可能，同时Dockerfile指定快照源，降低了通过依赖引入投毒的风险。
3. Nix 文件 只是dockerfile的另外一种描述方式，目的是为了构建docker镜像，与投毒无关。

但仍然存在一定的投毒可能：
1. 在`exploit.py`的payload中，攻击者可能会通过某种方式尝试上传或修改服务器上的其他文件，或者运行一些隐蔽的恶意命令，这种行为没有在POC里清晰展示。
2. 其他配置文件中可能存在隐藏的后门或者配置缺陷，不过可能性较低。

**利用方式：**

1.  攻击者首先需要与目标OpenSMTPD服务器建立SMTP连接（端口25）。
2.  发送`HELO`命令进行握手。
3.  关键步骤：发送`MAIL FROM`命令，并在邮件地址中插入shell元字符和恶意命令。例如：`MAIL FROM:<;恶意命令;>`
4.  发送`RCPT TO`命令指定收件人。
5.  发送`DATA`命令，并发送邮件内容（可以为空）。
6.  服务器在处理`MAIL FROM`地址时，由于漏洞，会执行注入的shell命令。
7.  攻击者通过监听指定端口，接收反弹shell，从而获得目标服务器的root权限。

总结：该漏洞利用难度较低，只需要构造特定的SMTP会话，即可触发远程代码执行。

**项目地址:** [minhluannguyen/CVE-2020-7247-reproducer](https://github.com/minhluannguyen/CVE-2020-7247-reproducer)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #7

**来源**: [CVE-2020-7247-presentdaypresenttime_shai_hulud.md](../2020/CVE-2020-7247-presentdaypresenttime_shai_hulud.md)

## CVE-2020-7247 - OpenSMTPD 远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 6.6

**利用条件:** 目标服务器运行OpenSMTPD 6.6版本，且使用未注释的默认配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 smtp_session.c 文件中的 smtp_mailaddr 函数中。由于输入验证不正确，远程攻击者可以通过构造包含 shell 元字符的 MAIL FROM 字段的 SMTP 会话，以 root 权限执行任意命令。提供的漏洞利用代码 (infect.py) 尝试利用此漏洞。该代码首先使用 nmap 扫描局域网以发现潜在的 OpenSMTPD 服务器，然后尝试连接到这些服务器并在 MAIL FROM 字段中注入命令。漏洞利用脚本尝试下载并执行 `woot.sh` 脚本，这个脚本的功能未知，存在潜在的投毒风险。 docker-compose.yml 脚本配置了多个 OpenSMTPD 实例，用于搭建测试环境。\n\n**有效性:** 根据漏洞信息和搜索引擎结果，该漏洞利用的有效性较高。漏洞库信息和搜索结果都确认了该漏洞的存在和可利用性。\n\n**投毒风险:** `infect.py` 中包含从 `raw.githubusercontent.com/presentdaypresenttime/shai_hulud/main/woot.sh` 下载并执行脚本的代码，该脚本内容未知，存在潜在的投毒风险，攻击者可以通过修改 `woot.sh` 的内容植入恶意代码。因此，投毒风险评估为10%。\n\n**利用方式:** 漏洞利用的步骤如下：\n1. 使用 nmap 扫描局域网，发现运行 OpenSMTPD 服务的服务器。\n2. 连接到目标服务器的 25 端口。\n3. 发送 HELO 命令建立连接。\n4. 发送包含恶意命令的 MAIL FROM 命令，利用 shell 注入漏洞执行命令。\n5. 发送 RCPT TO, DATA 命令模拟邮件发送过程。\n6. 发送 QUIT 命令断开连接。

**项目地址:** [presentdaypresenttime/shai_hulud](https://github.com/presentdaypresenttime/shai_hulud)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #8

**来源**: [CVE-2020-7247-r0lh_CVE-2020-7247.md](../2020/CVE-2020-7247-r0lh_CVE-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可导致以root权限执行任意命令

**影响版本:** < 6.6.2

**利用条件:** 目标服务器运行存在漏洞的OpenSMTPD版本，且允许SMTP连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-7247 存在于 OpenSMTPD 6.6 版本中，由于在 `smtp_session.c` 文件的 `smtp_mailaddr` 函数中，对输入验证失败时返回了错误的值，导致攻击者可以通过在 `MAIL FROM` 字段中注入 shell 元字符，从而以 root 权限执行任意命令。该漏洞影响使用默认配置（未注释）的 OpenSMTPD 服务器。

**漏洞利用方式：**

1.  **连接目标SMTP服务器：** 利用代码首先尝试连接到目标 OpenSMTPD 服务器的 25 端口 (或其他指定的端口)。
2.  **发送HELO命令：**  与服务器建立 SMTP 会话。
3.  **注入恶意payload：** 在`MAIL FROM`命令中使用shell元字符，执行命令。
4.  **设置接收者：** 使用`RCPT TO`命令设置邮件接收者。
5.  **发送DATA命令：** 发送`DATA`命令，并发送包含反弹shell命令的payload。
6.  **启动监听：**  攻击者使用 `nc` 命令监听指定端口，等待目标服务器反弹 shell 连接。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用的有效性较高。POC代码已经公开，并且多个来源证实可以通过`MAIL FROM`注入执行任意命令。

**投毒风险：**

POC代码主要是利用 OpenSMTPD 漏洞实现反弹 shell。代码中存在设置监听端口和IP地址的操作，但这是反弹shell的必要步骤，不能直接判定为投毒。代码本身较为直接，没有发现明显的恶意或隐藏行为。投毒风险极小，但需要评估代码执行的payload，风险评估约为5%。


**项目地址:** [r0lh/CVE-2020-7247](https://github.com/r0lh/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #9

**来源**: [CVE-2020-7247-superzerosec_cve-2020-7247.md](../2020/CVE-2020-7247-superzerosec_cve-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致完全控制受影响的服务器

**影响版本:** < 6.6.2

**利用条件:** 需要目标服务器运行OpenSMTPD服务，且配置为默认的未注释配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 存在于OpenSMTPD 6.6.2之前的版本中。攻击者可以通过在`MAIL FROM`字段中注入shell元字符，利用SMTP会话执行任意系统命令，获得root权限。漏洞的根本原因是程序没有充分过滤用户可控的输入。

**有效性:** 提供的POC代码（poc1.py）看起来是有效的。它使用`pwn`库来建立与目标SMTP服务器的连接，并发送一系列SMTP命令，其中`MAIL FROM`命令包含恶意shell代码。如果目标服务器存在漏洞，这段代码将执行任意命令。

**投毒风险:**  POC代码主要目的是利用该漏洞，实现远程命令执行。其中值得关注的点：

*   **使用mkfifo创建管道:** 代码使用`mkfifo`创建一个命名管道`/tmp/nnwo`，然后使用`nc`将命令发送到该管道，并通过`/bin/sh`执行，最后将结果重定向到该管道，并将错误信息也重定向。这个过程本身是为了建立一个反向shell。
*   **清除痕迹:** 代码尝试在攻击完成后通过`pkill nc`清除网络连接的痕迹。


以下情况可以视为潜在的投毒代码风险：

* **恶意payload替换：** POC中可以使用更具破坏性的命令，例如删除关键系统文件或者植入长期后门程序。
* **后门植入：**  虽然`pkill nc`试图清除痕迹，但更隐蔽的后门可能被安装，以便后续访问。

综合考虑，该POC主要是为了验证漏洞的存在并执行命令。但是，因为执行了网络连接和创建管道等操作，存在一定被滥用和修改为更具恶意目的的可能性。 因此，将其判定为有 **10%** 的投毒风险。

**利用方式:**

1.  **建立SMTP连接:** 使用`pwn`库与目标OpenSMTPD服务器建立TCP连接。
2.  **发送SMTP命令序列:** 发送`HELO`、`MAIL FROM`、`RCPT TO`和`DATA`等SMTP命令。
3.  **注入恶意代码:** 在`MAIL FROM`命令中，通过注入shell元字符，构造恶意shell命令。例如，``MAIL FROM:<;for i in r j A F L X;do read;done;sh;exit 0;>``
4.  **发送Payload:** 在`DATA`命令之后，发送实际要执行的命令。POC中使用`mkfifo`和`nc`来建立反向shell连接。
5.  **监听反向Shell:** 攻击者在本地主机上使用`nc`监听指定的端口，等待目标服务器建立连接，从而获得shell访问权限。
6.  **清理痕迹:** 攻击完成后，尝试清除在目标系统上留下的痕迹（如通过`pkill nc`杀死nc进程）。

**项目地址:** [superzerosec/cve-2020-7247](https://github.com/superzerosec/cve-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---



---

## POC #4

**来源**: [CVE-2020-7247-bytescrappers_CVE-2020-7247.md](../2020/CVE-2020-7247-bytescrappers_CVE-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，允许远程攻击者以root权限执行任意命令

**影响版本:** 6.6

**利用条件:** 目标系统运行存在漏洞的OpenSMTPD 6.6，并且配置为默认的“uncommented”配置，允许未授权的SMTP连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 smtp_session.c 文件中的 smtp_mailaddr 函数中。攻击者可以通过在 MAIL FROM 字段中注入 shell 元字符，利用不正确的输入验证返回值来执行任意命令，从而实现远程代码执行。根据提供的POC代码，攻击者首先建立与目标SMTP服务器的连接，然后发送 HELO 命令，接着发送包含恶意 shell 命令的 MAIL FROM 命令，该命令利用了漏洞。然后发送 RCPT TO、DATA 命令，再发送包含一段特殊格式的payload, 最后发送 QUIT 命令结束会话。漏洞利用的关键在于MAIL FROM命令中的shell命令注入，利用 OpenSMTPD 未正确处理的漏洞点，执行任意命令。因为漏洞利用代码中的payload部分是接受命令行的参数，没有发现额外的后门代码，所以判定投毒风险为0%。搜索引擎结果确认该漏洞的存在，并指出利用该漏洞可以执行任意shell命令。

**项目地址:** [bytescrappers/CVE-2020-7247](https://github.com/bytescrappers/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #5

**来源**: [CVE-2020-7247-f4T1H21_CVE-2020-7247.md](../2020/CVE-2020-7247-f4T1H21_CVE-2020-7247.md)

## CVE-2020-7247 OpenSMTPD 远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，允许远程攻击者以root权限执行任意命令

**影响版本:** 6.6

**利用条件:** 目标服务器运行受影响版本的OpenSMTPD，并且使用默认配置（未注释）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 `smtp_session.c` 文件中的 `smtp_mailaddr` 函数中。由于对输入验证的错误处理，远程攻击者可以通过构造包含 shell 元字符的 `MAIL FROM` 字段的 SMTP 会话来执行任意命令。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在公开可用的漏洞利用代码。 因此,提供的漏洞利用代码有效。

**投毒风险：** 提供的漏洞利用代码只包含 GNU GPL v3 许可协议的内容，没有发现恶意代码或后门，因此可以判断不存在投毒风险。投毒风险为0%。

**利用方式：**

1.  攻击者与目标 OpenSMTPD 服务器建立 SMTP 连接。
2.  攻击者在 `MAIL FROM` 命令中插入包含 shell 元字符的恶意命令。例如：`MAIL FROM:<;touch /tmp/vuln;>`。
3.  OpenSMTPD 在处理 `MAIL FROM` 地址时，由于输入验证不当，会将恶意命令传递给 shell 执行，从而导致远程命令执行。
4. 攻击者可以利用此漏洞以 root 权限在目标服务器上执行任意命令。

**项目地址:** [f4T1H21/CVE-2020-7247](https://github.com/f4T1H21/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #6

**来源**: [CVE-2020-7247-minhluannguyen_CVE-2020-7247-reproducer.md](../2020/CVE-2020-7247-minhluannguyen_CVE-2020-7247-reproducer.md)

## CVE-2020-7247-OpenSMTPD-RCE

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 6.6

**利用条件:** OpenSMTPD 6.6默认配置，未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247是一个存在于OpenSMTPD 6.6的远程代码执行漏洞。该漏洞位于`smtp_session.c`中的`smtp_mailaddr`函数，由于输入验证不当，允许远程攻击者通过精心构造的SMTP会话，在`MAIL FROM`字段中注入shell元字符，从而以root权限执行任意命令。默认配置下，OpenSMTPD会错误地处理包含shell元字符的`MAIL FROM`地址。攻击者利用点在于`MAIL FROM`参数，通过注入恶意的shell命令，造成远程代码执行。

**有效性评估：**

提供的漏洞利用代码似乎有效。`exploit.py`脚本通过socket连接到目标OpenSMTPD服务器，发送HELO、MAIL FROM、RCPT TO和DATA等SMTP命令，在`MAIL FROM`命令中包含了payload，该payload试图执行反弹shell。Docker文件用于搭建存在漏洞的OpenSMTPD环境，便于验证。

**投毒风险评估：**

经过分析，此仓库中存在作者隐藏的投毒代码可能性较低，约占10%。主要依据如下：
1. `exploit.py`明确地展示了利用payload进行反弹shell，行为明确。
2. Dockerfile 拉取了指定的debian版本，降低了被投毒的可能，同时Dockerfile指定快照源，降低了通过依赖引入投毒的风险。
3. Nix 文件 只是dockerfile的另外一种描述方式，目的是为了构建docker镜像，与投毒无关。

但仍然存在一定的投毒可能：
1. 在`exploit.py`的payload中，攻击者可能会通过某种方式尝试上传或修改服务器上的其他文件，或者运行一些隐蔽的恶意命令，这种行为没有在POC里清晰展示。
2. 其他配置文件中可能存在隐藏的后门或者配置缺陷，不过可能性较低。

**利用方式：**

1.  攻击者首先需要与目标OpenSMTPD服务器建立SMTP连接（端口25）。
2.  发送`HELO`命令进行握手。
3.  关键步骤：发送`MAIL FROM`命令，并在邮件地址中插入shell元字符和恶意命令。例如：`MAIL FROM:<;恶意命令;>`
4.  发送`RCPT TO`命令指定收件人。
5.  发送`DATA`命令，并发送邮件内容（可以为空）。
6.  服务器在处理`MAIL FROM`地址时，由于漏洞，会执行注入的shell命令。
7.  攻击者通过监听指定端口，接收反弹shell，从而获得目标服务器的root权限。

总结：该漏洞利用难度较低，只需要构造特定的SMTP会话，即可触发远程代码执行。

**项目地址:** [minhluannguyen/CVE-2020-7247-reproducer](https://github.com/minhluannguyen/CVE-2020-7247-reproducer)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #7

**来源**: [CVE-2020-7247-presentdaypresenttime_shai_hulud.md](../2020/CVE-2020-7247-presentdaypresenttime_shai_hulud.md)

## CVE-2020-7247 - OpenSMTPD 远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 6.6

**利用条件:** 目标服务器运行OpenSMTPD 6.6版本，且使用未注释的默认配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 smtp_session.c 文件中的 smtp_mailaddr 函数中。由于输入验证不正确，远程攻击者可以通过构造包含 shell 元字符的 MAIL FROM 字段的 SMTP 会话，以 root 权限执行任意命令。提供的漏洞利用代码 (infect.py) 尝试利用此漏洞。该代码首先使用 nmap 扫描局域网以发现潜在的 OpenSMTPD 服务器，然后尝试连接到这些服务器并在 MAIL FROM 字段中注入命令。漏洞利用脚本尝试下载并执行 `woot.sh` 脚本，这个脚本的功能未知，存在潜在的投毒风险。 docker-compose.yml 脚本配置了多个 OpenSMTPD 实例，用于搭建测试环境。\n\n**有效性:** 根据漏洞信息和搜索引擎结果，该漏洞利用的有效性较高。漏洞库信息和搜索结果都确认了该漏洞的存在和可利用性。\n\n**投毒风险:** `infect.py` 中包含从 `raw.githubusercontent.com/presentdaypresenttime/shai_hulud/main/woot.sh` 下载并执行脚本的代码，该脚本内容未知，存在潜在的投毒风险，攻击者可以通过修改 `woot.sh` 的内容植入恶意代码。因此，投毒风险评估为10%。\n\n**利用方式:** 漏洞利用的步骤如下：\n1. 使用 nmap 扫描局域网，发现运行 OpenSMTPD 服务的服务器。\n2. 连接到目标服务器的 25 端口。\n3. 发送 HELO 命令建立连接。\n4. 发送包含恶意命令的 MAIL FROM 命令，利用 shell 注入漏洞执行命令。\n5. 发送 RCPT TO, DATA 命令模拟邮件发送过程。\n6. 发送 QUIT 命令断开连接。

**项目地址:** [presentdaypresenttime/shai_hulud](https://github.com/presentdaypresenttime/shai_hulud)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #8

**来源**: [CVE-2020-7247-r0lh_CVE-2020-7247.md](../2020/CVE-2020-7247-r0lh_CVE-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可导致以root权限执行任意命令

**影响版本:** < 6.6.2

**利用条件:** 目标服务器运行存在漏洞的OpenSMTPD版本，且允许SMTP连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-7247 存在于 OpenSMTPD 6.6 版本中，由于在 `smtp_session.c` 文件的 `smtp_mailaddr` 函数中，对输入验证失败时返回了错误的值，导致攻击者可以通过在 `MAIL FROM` 字段中注入 shell 元字符，从而以 root 权限执行任意命令。该漏洞影响使用默认配置（未注释）的 OpenSMTPD 服务器。

**漏洞利用方式：**

1.  **连接目标SMTP服务器：** 利用代码首先尝试连接到目标 OpenSMTPD 服务器的 25 端口 (或其他指定的端口)。
2.  **发送HELO命令：**  与服务器建立 SMTP 会话。
3.  **注入恶意payload：** 在`MAIL FROM`命令中使用shell元字符，执行命令。
4.  **设置接收者：** 使用`RCPT TO`命令设置邮件接收者。
5.  **发送DATA命令：** 发送`DATA`命令，并发送包含反弹shell命令的payload。
6.  **启动监听：**  攻击者使用 `nc` 命令监听指定端口，等待目标服务器反弹 shell 连接。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用的有效性较高。POC代码已经公开，并且多个来源证实可以通过`MAIL FROM`注入执行任意命令。

**投毒风险：**

POC代码主要是利用 OpenSMTPD 漏洞实现反弹 shell。代码中存在设置监听端口和IP地址的操作，但这是反弹shell的必要步骤，不能直接判定为投毒。代码本身较为直接，没有发现明显的恶意或隐藏行为。投毒风险极小，但需要评估代码执行的payload，风险评估约为5%。


**项目地址:** [r0lh/CVE-2020-7247](https://github.com/r0lh/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #9

**来源**: [CVE-2020-7247-superzerosec_cve-2020-7247.md](../2020/CVE-2020-7247-superzerosec_cve-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致完全控制受影响的服务器

**影响版本:** < 6.6.2

**利用条件:** 需要目标服务器运行OpenSMTPD服务，且配置为默认的未注释配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 存在于OpenSMTPD 6.6.2之前的版本中。攻击者可以通过在`MAIL FROM`字段中注入shell元字符，利用SMTP会话执行任意系统命令，获得root权限。漏洞的根本原因是程序没有充分过滤用户可控的输入。

**有效性:** 提供的POC代码（poc1.py）看起来是有效的。它使用`pwn`库来建立与目标SMTP服务器的连接，并发送一系列SMTP命令，其中`MAIL FROM`命令包含恶意shell代码。如果目标服务器存在漏洞，这段代码将执行任意命令。

**投毒风险:**  POC代码主要目的是利用该漏洞，实现远程命令执行。其中值得关注的点：

*   **使用mkfifo创建管道:** 代码使用`mkfifo`创建一个命名管道`/tmp/nnwo`，然后使用`nc`将命令发送到该管道，并通过`/bin/sh`执行，最后将结果重定向到该管道，并将错误信息也重定向。这个过程本身是为了建立一个反向shell。
*   **清除痕迹:** 代码尝试在攻击完成后通过`pkill nc`清除网络连接的痕迹。


以下情况可以视为潜在的投毒代码风险：

* **恶意payload替换：** POC中可以使用更具破坏性的命令，例如删除关键系统文件或者植入长期后门程序。
* **后门植入：**  虽然`pkill nc`试图清除痕迹，但更隐蔽的后门可能被安装，以便后续访问。

综合考虑，该POC主要是为了验证漏洞的存在并执行命令。但是，因为执行了网络连接和创建管道等操作，存在一定被滥用和修改为更具恶意目的的可能性。 因此，将其判定为有 **10%** 的投毒风险。

**利用方式:**

1.  **建立SMTP连接:** 使用`pwn`库与目标OpenSMTPD服务器建立TCP连接。
2.  **发送SMTP命令序列:** 发送`HELO`、`MAIL FROM`、`RCPT TO`和`DATA`等SMTP命令。
3.  **注入恶意代码:** 在`MAIL FROM`命令中，通过注入shell元字符，构造恶意shell命令。例如，``MAIL FROM:<;for i in r j A F L X;do read;done;sh;exit 0;>``
4.  **发送Payload:** 在`DATA`命令之后，发送实际要执行的命令。POC中使用`mkfifo`和`nc`来建立反向shell连接。
5.  **监听反向Shell:** 攻击者在本地主机上使用`nc`监听指定的端口，等待目标服务器建立连接，从而获得shell访问权限。
6.  **清理痕迹:** 攻击完成后，尝试清除在目标系统上留下的痕迹（如通过`pkill nc`杀死nc进程）。

**项目地址:** [superzerosec/cve-2020-7247](https://github.com/superzerosec/cve-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---



---

## POC #4

**来源**: [CVE-2020-7247-bytescrappers_CVE-2020-7247.md](../2020/CVE-2020-7247-bytescrappers_CVE-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，允许远程攻击者以root权限执行任意命令

**影响版本:** 6.6

**利用条件:** 目标系统运行存在漏洞的OpenSMTPD 6.6，并且配置为默认的“uncommented”配置，允许未授权的SMTP连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 smtp_session.c 文件中的 smtp_mailaddr 函数中。攻击者可以通过在 MAIL FROM 字段中注入 shell 元字符，利用不正确的输入验证返回值来执行任意命令，从而实现远程代码执行。根据提供的POC代码，攻击者首先建立与目标SMTP服务器的连接，然后发送 HELO 命令，接着发送包含恶意 shell 命令的 MAIL FROM 命令，该命令利用了漏洞。然后发送 RCPT TO、DATA 命令，再发送包含一段特殊格式的payload, 最后发送 QUIT 命令结束会话。漏洞利用的关键在于MAIL FROM命令中的shell命令注入，利用 OpenSMTPD 未正确处理的漏洞点，执行任意命令。因为漏洞利用代码中的payload部分是接受命令行的参数，没有发现额外的后门代码，所以判定投毒风险为0%。搜索引擎结果确认该漏洞的存在，并指出利用该漏洞可以执行任意shell命令。

**项目地址:** [bytescrappers/CVE-2020-7247](https://github.com/bytescrappers/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #5

**来源**: [CVE-2020-7247-f4T1H21_CVE-2020-7247.md](../2020/CVE-2020-7247-f4T1H21_CVE-2020-7247.md)

## CVE-2020-7247 OpenSMTPD 远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，允许远程攻击者以root权限执行任意命令

**影响版本:** 6.6

**利用条件:** 目标服务器运行受影响版本的OpenSMTPD，并且使用默认配置（未注释）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 `smtp_session.c` 文件中的 `smtp_mailaddr` 函数中。由于对输入验证的错误处理，远程攻击者可以通过构造包含 shell 元字符的 `MAIL FROM` 字段的 SMTP 会话来执行任意命令。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在公开可用的漏洞利用代码。 因此,提供的漏洞利用代码有效。

**投毒风险：** 提供的漏洞利用代码只包含 GNU GPL v3 许可协议的内容，没有发现恶意代码或后门，因此可以判断不存在投毒风险。投毒风险为0%。

**利用方式：**

1.  攻击者与目标 OpenSMTPD 服务器建立 SMTP 连接。
2.  攻击者在 `MAIL FROM` 命令中插入包含 shell 元字符的恶意命令。例如：`MAIL FROM:<;touch /tmp/vuln;>`。
3.  OpenSMTPD 在处理 `MAIL FROM` 地址时，由于输入验证不当，会将恶意命令传递给 shell 执行，从而导致远程命令执行。
4. 攻击者可以利用此漏洞以 root 权限在目标服务器上执行任意命令。

**项目地址:** [f4T1H21/CVE-2020-7247](https://github.com/f4T1H21/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #6

**来源**: [CVE-2020-7247-minhluannguyen_CVE-2020-7247-reproducer.md](../2020/CVE-2020-7247-minhluannguyen_CVE-2020-7247-reproducer.md)

## CVE-2020-7247-OpenSMTPD-RCE

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 6.6

**利用条件:** OpenSMTPD 6.6默认配置，未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247是一个存在于OpenSMTPD 6.6的远程代码执行漏洞。该漏洞位于`smtp_session.c`中的`smtp_mailaddr`函数，由于输入验证不当，允许远程攻击者通过精心构造的SMTP会话，在`MAIL FROM`字段中注入shell元字符，从而以root权限执行任意命令。默认配置下，OpenSMTPD会错误地处理包含shell元字符的`MAIL FROM`地址。攻击者利用点在于`MAIL FROM`参数，通过注入恶意的shell命令，造成远程代码执行。

**有效性评估：**

提供的漏洞利用代码似乎有效。`exploit.py`脚本通过socket连接到目标OpenSMTPD服务器，发送HELO、MAIL FROM、RCPT TO和DATA等SMTP命令，在`MAIL FROM`命令中包含了payload，该payload试图执行反弹shell。Docker文件用于搭建存在漏洞的OpenSMTPD环境，便于验证。

**投毒风险评估：**

经过分析，此仓库中存在作者隐藏的投毒代码可能性较低，约占10%。主要依据如下：
1. `exploit.py`明确地展示了利用payload进行反弹shell，行为明确。
2. Dockerfile 拉取了指定的debian版本，降低了被投毒的可能，同时Dockerfile指定快照源，降低了通过依赖引入投毒的风险。
3. Nix 文件 只是dockerfile的另外一种描述方式，目的是为了构建docker镜像，与投毒无关。

但仍然存在一定的投毒可能：
1. 在`exploit.py`的payload中，攻击者可能会通过某种方式尝试上传或修改服务器上的其他文件，或者运行一些隐蔽的恶意命令，这种行为没有在POC里清晰展示。
2. 其他配置文件中可能存在隐藏的后门或者配置缺陷，不过可能性较低。

**利用方式：**

1.  攻击者首先需要与目标OpenSMTPD服务器建立SMTP连接（端口25）。
2.  发送`HELO`命令进行握手。
3.  关键步骤：发送`MAIL FROM`命令，并在邮件地址中插入shell元字符和恶意命令。例如：`MAIL FROM:<;恶意命令;>`
4.  发送`RCPT TO`命令指定收件人。
5.  发送`DATA`命令，并发送邮件内容（可以为空）。
6.  服务器在处理`MAIL FROM`地址时，由于漏洞，会执行注入的shell命令。
7.  攻击者通过监听指定端口，接收反弹shell，从而获得目标服务器的root权限。

总结：该漏洞利用难度较低，只需要构造特定的SMTP会话，即可触发远程代码执行。

**项目地址:** [minhluannguyen/CVE-2020-7247-reproducer](https://github.com/minhluannguyen/CVE-2020-7247-reproducer)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #7

**来源**: [CVE-2020-7247-presentdaypresenttime_shai_hulud.md](../2020/CVE-2020-7247-presentdaypresenttime_shai_hulud.md)

## CVE-2020-7247 - OpenSMTPD 远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 6.6

**利用条件:** 目标服务器运行OpenSMTPD 6.6版本，且使用未注释的默认配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 smtp_session.c 文件中的 smtp_mailaddr 函数中。由于输入验证不正确，远程攻击者可以通过构造包含 shell 元字符的 MAIL FROM 字段的 SMTP 会话，以 root 权限执行任意命令。提供的漏洞利用代码 (infect.py) 尝试利用此漏洞。该代码首先使用 nmap 扫描局域网以发现潜在的 OpenSMTPD 服务器，然后尝试连接到这些服务器并在 MAIL FROM 字段中注入命令。漏洞利用脚本尝试下载并执行 `woot.sh` 脚本，这个脚本的功能未知，存在潜在的投毒风险。 docker-compose.yml 脚本配置了多个 OpenSMTPD 实例，用于搭建测试环境。\n\n**有效性:** 根据漏洞信息和搜索引擎结果，该漏洞利用的有效性较高。漏洞库信息和搜索结果都确认了该漏洞的存在和可利用性。\n\n**投毒风险:** `infect.py` 中包含从 `raw.githubusercontent.com/presentdaypresenttime/shai_hulud/main/woot.sh` 下载并执行脚本的代码，该脚本内容未知，存在潜在的投毒风险，攻击者可以通过修改 `woot.sh` 的内容植入恶意代码。因此，投毒风险评估为10%。\n\n**利用方式:** 漏洞利用的步骤如下：\n1. 使用 nmap 扫描局域网，发现运行 OpenSMTPD 服务的服务器。\n2. 连接到目标服务器的 25 端口。\n3. 发送 HELO 命令建立连接。\n4. 发送包含恶意命令的 MAIL FROM 命令，利用 shell 注入漏洞执行命令。\n5. 发送 RCPT TO, DATA 命令模拟邮件发送过程。\n6. 发送 QUIT 命令断开连接。

**项目地址:** [presentdaypresenttime/shai_hulud](https://github.com/presentdaypresenttime/shai_hulud)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #8

**来源**: [CVE-2020-7247-r0lh_CVE-2020-7247.md](../2020/CVE-2020-7247-r0lh_CVE-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可导致以root权限执行任意命令

**影响版本:** < 6.6.2

**利用条件:** 目标服务器运行存在漏洞的OpenSMTPD版本，且允许SMTP连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-7247 存在于 OpenSMTPD 6.6 版本中，由于在 `smtp_session.c` 文件的 `smtp_mailaddr` 函数中，对输入验证失败时返回了错误的值，导致攻击者可以通过在 `MAIL FROM` 字段中注入 shell 元字符，从而以 root 权限执行任意命令。该漏洞影响使用默认配置（未注释）的 OpenSMTPD 服务器。

**漏洞利用方式：**

1.  **连接目标SMTP服务器：** 利用代码首先尝试连接到目标 OpenSMTPD 服务器的 25 端口 (或其他指定的端口)。
2.  **发送HELO命令：**  与服务器建立 SMTP 会话。
3.  **注入恶意payload：** 在`MAIL FROM`命令中使用shell元字符，执行命令。
4.  **设置接收者：** 使用`RCPT TO`命令设置邮件接收者。
5.  **发送DATA命令：** 发送`DATA`命令，并发送包含反弹shell命令的payload。
6.  **启动监听：**  攻击者使用 `nc` 命令监听指定端口，等待目标服务器反弹 shell 连接。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用的有效性较高。POC代码已经公开，并且多个来源证实可以通过`MAIL FROM`注入执行任意命令。

**投毒风险：**

POC代码主要是利用 OpenSMTPD 漏洞实现反弹 shell。代码中存在设置监听端口和IP地址的操作，但这是反弹shell的必要步骤，不能直接判定为投毒。代码本身较为直接，没有发现明显的恶意或隐藏行为。投毒风险极小，但需要评估代码执行的payload，风险评估约为5%。


**项目地址:** [r0lh/CVE-2020-7247](https://github.com/r0lh/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #9

**来源**: [CVE-2020-7247-superzerosec_cve-2020-7247.md](../2020/CVE-2020-7247-superzerosec_cve-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致完全控制受影响的服务器

**影响版本:** < 6.6.2

**利用条件:** 需要目标服务器运行OpenSMTPD服务，且配置为默认的未注释配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 存在于OpenSMTPD 6.6.2之前的版本中。攻击者可以通过在`MAIL FROM`字段中注入shell元字符，利用SMTP会话执行任意系统命令，获得root权限。漏洞的根本原因是程序没有充分过滤用户可控的输入。

**有效性:** 提供的POC代码（poc1.py）看起来是有效的。它使用`pwn`库来建立与目标SMTP服务器的连接，并发送一系列SMTP命令，其中`MAIL FROM`命令包含恶意shell代码。如果目标服务器存在漏洞，这段代码将执行任意命令。

**投毒风险:**  POC代码主要目的是利用该漏洞，实现远程命令执行。其中值得关注的点：

*   **使用mkfifo创建管道:** 代码使用`mkfifo`创建一个命名管道`/tmp/nnwo`，然后使用`nc`将命令发送到该管道，并通过`/bin/sh`执行，最后将结果重定向到该管道，并将错误信息也重定向。这个过程本身是为了建立一个反向shell。
*   **清除痕迹:** 代码尝试在攻击完成后通过`pkill nc`清除网络连接的痕迹。


以下情况可以视为潜在的投毒代码风险：

* **恶意payload替换：** POC中可以使用更具破坏性的命令，例如删除关键系统文件或者植入长期后门程序。
* **后门植入：**  虽然`pkill nc`试图清除痕迹，但更隐蔽的后门可能被安装，以便后续访问。

综合考虑，该POC主要是为了验证漏洞的存在并执行命令。但是，因为执行了网络连接和创建管道等操作，存在一定被滥用和修改为更具恶意目的的可能性。 因此，将其判定为有 **10%** 的投毒风险。

**利用方式:**

1.  **建立SMTP连接:** 使用`pwn`库与目标OpenSMTPD服务器建立TCP连接。
2.  **发送SMTP命令序列:** 发送`HELO`、`MAIL FROM`、`RCPT TO`和`DATA`等SMTP命令。
3.  **注入恶意代码:** 在`MAIL FROM`命令中，通过注入shell元字符，构造恶意shell命令。例如，``MAIL FROM:<;for i in r j A F L X;do read;done;sh;exit 0;>``
4.  **发送Payload:** 在`DATA`命令之后，发送实际要执行的命令。POC中使用`mkfifo`和`nc`来建立反向shell连接。
5.  **监听反向Shell:** 攻击者在本地主机上使用`nc`监听指定的端口，等待目标服务器建立连接，从而获得shell访问权限。
6.  **清理痕迹:** 攻击完成后，尝试清除在目标系统上留下的痕迹（如通过`pkill nc`杀死nc进程）。

**项目地址:** [superzerosec/cve-2020-7247](https://github.com/superzerosec/cve-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---



---

## POC #4

**来源**: [CVE-2020-7247-bytescrappers_CVE-2020-7247.md](../2020/CVE-2020-7247-bytescrappers_CVE-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，允许远程攻击者以root权限执行任意命令

**影响版本:** 6.6

**利用条件:** 目标系统运行存在漏洞的OpenSMTPD 6.6，并且配置为默认的“uncommented”配置，允许未授权的SMTP连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 smtp_session.c 文件中的 smtp_mailaddr 函数中。攻击者可以通过在 MAIL FROM 字段中注入 shell 元字符，利用不正确的输入验证返回值来执行任意命令，从而实现远程代码执行。根据提供的POC代码，攻击者首先建立与目标SMTP服务器的连接，然后发送 HELO 命令，接着发送包含恶意 shell 命令的 MAIL FROM 命令，该命令利用了漏洞。然后发送 RCPT TO、DATA 命令，再发送包含一段特殊格式的payload, 最后发送 QUIT 命令结束会话。漏洞利用的关键在于MAIL FROM命令中的shell命令注入，利用 OpenSMTPD 未正确处理的漏洞点，执行任意命令。因为漏洞利用代码中的payload部分是接受命令行的参数，没有发现额外的后门代码，所以判定投毒风险为0%。搜索引擎结果确认该漏洞的存在，并指出利用该漏洞可以执行任意shell命令。

**项目地址:** [bytescrappers/CVE-2020-7247](https://github.com/bytescrappers/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #5

**来源**: [CVE-2020-7247-f4T1H21_CVE-2020-7247.md](../2020/CVE-2020-7247-f4T1H21_CVE-2020-7247.md)

## CVE-2020-7247 OpenSMTPD 远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，允许远程攻击者以root权限执行任意命令

**影响版本:** 6.6

**利用条件:** 目标服务器运行受影响版本的OpenSMTPD，并且使用默认配置（未注释）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 `smtp_session.c` 文件中的 `smtp_mailaddr` 函数中。由于对输入验证的错误处理，远程攻击者可以通过构造包含 shell 元字符的 `MAIL FROM` 字段的 SMTP 会话来执行任意命令。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在公开可用的漏洞利用代码。 因此,提供的漏洞利用代码有效。

**投毒风险：** 提供的漏洞利用代码只包含 GNU GPL v3 许可协议的内容，没有发现恶意代码或后门，因此可以判断不存在投毒风险。投毒风险为0%。

**利用方式：**

1.  攻击者与目标 OpenSMTPD 服务器建立 SMTP 连接。
2.  攻击者在 `MAIL FROM` 命令中插入包含 shell 元字符的恶意命令。例如：`MAIL FROM:<;touch /tmp/vuln;>`。
3.  OpenSMTPD 在处理 `MAIL FROM` 地址时，由于输入验证不当，会将恶意命令传递给 shell 执行，从而导致远程命令执行。
4. 攻击者可以利用此漏洞以 root 权限在目标服务器上执行任意命令。

**项目地址:** [f4T1H21/CVE-2020-7247](https://github.com/f4T1H21/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #6

**来源**: [CVE-2020-7247-minhluannguyen_CVE-2020-7247-reproducer.md](../2020/CVE-2020-7247-minhluannguyen_CVE-2020-7247-reproducer.md)

## CVE-2020-7247-OpenSMTPD-RCE

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 6.6

**利用条件:** OpenSMTPD 6.6默认配置，未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247是一个存在于OpenSMTPD 6.6的远程代码执行漏洞。该漏洞位于`smtp_session.c`中的`smtp_mailaddr`函数，由于输入验证不当，允许远程攻击者通过精心构造的SMTP会话，在`MAIL FROM`字段中注入shell元字符，从而以root权限执行任意命令。默认配置下，OpenSMTPD会错误地处理包含shell元字符的`MAIL FROM`地址。攻击者利用点在于`MAIL FROM`参数，通过注入恶意的shell命令，造成远程代码执行。

**有效性评估：**

提供的漏洞利用代码似乎有效。`exploit.py`脚本通过socket连接到目标OpenSMTPD服务器，发送HELO、MAIL FROM、RCPT TO和DATA等SMTP命令，在`MAIL FROM`命令中包含了payload，该payload试图执行反弹shell。Docker文件用于搭建存在漏洞的OpenSMTPD环境，便于验证。

**投毒风险评估：**

经过分析，此仓库中存在作者隐藏的投毒代码可能性较低，约占10%。主要依据如下：
1. `exploit.py`明确地展示了利用payload进行反弹shell，行为明确。
2. Dockerfile 拉取了指定的debian版本，降低了被投毒的可能，同时Dockerfile指定快照源，降低了通过依赖引入投毒的风险。
3. Nix 文件 只是dockerfile的另外一种描述方式，目的是为了构建docker镜像，与投毒无关。

但仍然存在一定的投毒可能：
1. 在`exploit.py`的payload中，攻击者可能会通过某种方式尝试上传或修改服务器上的其他文件，或者运行一些隐蔽的恶意命令，这种行为没有在POC里清晰展示。
2. 其他配置文件中可能存在隐藏的后门或者配置缺陷，不过可能性较低。

**利用方式：**

1.  攻击者首先需要与目标OpenSMTPD服务器建立SMTP连接（端口25）。
2.  发送`HELO`命令进行握手。
3.  关键步骤：发送`MAIL FROM`命令，并在邮件地址中插入shell元字符和恶意命令。例如：`MAIL FROM:<;恶意命令;>`
4.  发送`RCPT TO`命令指定收件人。
5.  发送`DATA`命令，并发送邮件内容（可以为空）。
6.  服务器在处理`MAIL FROM`地址时，由于漏洞，会执行注入的shell命令。
7.  攻击者通过监听指定端口，接收反弹shell，从而获得目标服务器的root权限。

总结：该漏洞利用难度较低，只需要构造特定的SMTP会话，即可触发远程代码执行。

**项目地址:** [minhluannguyen/CVE-2020-7247-reproducer](https://github.com/minhluannguyen/CVE-2020-7247-reproducer)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #7

**来源**: [CVE-2020-7247-presentdaypresenttime_shai_hulud.md](../2020/CVE-2020-7247-presentdaypresenttime_shai_hulud.md)

## CVE-2020-7247 - OpenSMTPD 远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 6.6

**利用条件:** 目标服务器运行OpenSMTPD 6.6版本，且使用未注释的默认配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 smtp_session.c 文件中的 smtp_mailaddr 函数中。由于输入验证不正确，远程攻击者可以通过构造包含 shell 元字符的 MAIL FROM 字段的 SMTP 会话，以 root 权限执行任意命令。提供的漏洞利用代码 (infect.py) 尝试利用此漏洞。该代码首先使用 nmap 扫描局域网以发现潜在的 OpenSMTPD 服务器，然后尝试连接到这些服务器并在 MAIL FROM 字段中注入命令。漏洞利用脚本尝试下载并执行 `woot.sh` 脚本，这个脚本的功能未知，存在潜在的投毒风险。 docker-compose.yml 脚本配置了多个 OpenSMTPD 实例，用于搭建测试环境。\n\n**有效性:** 根据漏洞信息和搜索引擎结果，该漏洞利用的有效性较高。漏洞库信息和搜索结果都确认了该漏洞的存在和可利用性。\n\n**投毒风险:** `infect.py` 中包含从 `raw.githubusercontent.com/presentdaypresenttime/shai_hulud/main/woot.sh` 下载并执行脚本的代码，该脚本内容未知，存在潜在的投毒风险，攻击者可以通过修改 `woot.sh` 的内容植入恶意代码。因此，投毒风险评估为10%。\n\n**利用方式:** 漏洞利用的步骤如下：\n1. 使用 nmap 扫描局域网，发现运行 OpenSMTPD 服务的服务器。\n2. 连接到目标服务器的 25 端口。\n3. 发送 HELO 命令建立连接。\n4. 发送包含恶意命令的 MAIL FROM 命令，利用 shell 注入漏洞执行命令。\n5. 发送 RCPT TO, DATA 命令模拟邮件发送过程。\n6. 发送 QUIT 命令断开连接。

**项目地址:** [presentdaypresenttime/shai_hulud](https://github.com/presentdaypresenttime/shai_hulud)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #8

**来源**: [CVE-2020-7247-r0lh_CVE-2020-7247.md](../2020/CVE-2020-7247-r0lh_CVE-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可导致以root权限执行任意命令

**影响版本:** < 6.6.2

**利用条件:** 目标服务器运行存在漏洞的OpenSMTPD版本，且允许SMTP连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-7247 存在于 OpenSMTPD 6.6 版本中，由于在 `smtp_session.c` 文件的 `smtp_mailaddr` 函数中，对输入验证失败时返回了错误的值，导致攻击者可以通过在 `MAIL FROM` 字段中注入 shell 元字符，从而以 root 权限执行任意命令。该漏洞影响使用默认配置（未注释）的 OpenSMTPD 服务器。

**漏洞利用方式：**

1.  **连接目标SMTP服务器：** 利用代码首先尝试连接到目标 OpenSMTPD 服务器的 25 端口 (或其他指定的端口)。
2.  **发送HELO命令：**  与服务器建立 SMTP 会话。
3.  **注入恶意payload：** 在`MAIL FROM`命令中使用shell元字符，执行命令。
4.  **设置接收者：** 使用`RCPT TO`命令设置邮件接收者。
5.  **发送DATA命令：** 发送`DATA`命令，并发送包含反弹shell命令的payload。
6.  **启动监听：**  攻击者使用 `nc` 命令监听指定端口，等待目标服务器反弹 shell 连接。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用的有效性较高。POC代码已经公开，并且多个来源证实可以通过`MAIL FROM`注入执行任意命令。

**投毒风险：**

POC代码主要是利用 OpenSMTPD 漏洞实现反弹 shell。代码中存在设置监听端口和IP地址的操作，但这是反弹shell的必要步骤，不能直接判定为投毒。代码本身较为直接，没有发现明显的恶意或隐藏行为。投毒风险极小，但需要评估代码执行的payload，风险评估约为5%。


**项目地址:** [r0lh/CVE-2020-7247](https://github.com/r0lh/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #9

**来源**: [CVE-2020-7247-superzerosec_cve-2020-7247.md](../2020/CVE-2020-7247-superzerosec_cve-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致完全控制受影响的服务器

**影响版本:** < 6.6.2

**利用条件:** 需要目标服务器运行OpenSMTPD服务，且配置为默认的未注释配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 存在于OpenSMTPD 6.6.2之前的版本中。攻击者可以通过在`MAIL FROM`字段中注入shell元字符，利用SMTP会话执行任意系统命令，获得root权限。漏洞的根本原因是程序没有充分过滤用户可控的输入。

**有效性:** 提供的POC代码（poc1.py）看起来是有效的。它使用`pwn`库来建立与目标SMTP服务器的连接，并发送一系列SMTP命令，其中`MAIL FROM`命令包含恶意shell代码。如果目标服务器存在漏洞，这段代码将执行任意命令。

**投毒风险:**  POC代码主要目的是利用该漏洞，实现远程命令执行。其中值得关注的点：

*   **使用mkfifo创建管道:** 代码使用`mkfifo`创建一个命名管道`/tmp/nnwo`，然后使用`nc`将命令发送到该管道，并通过`/bin/sh`执行，最后将结果重定向到该管道，并将错误信息也重定向。这个过程本身是为了建立一个反向shell。
*   **清除痕迹:** 代码尝试在攻击完成后通过`pkill nc`清除网络连接的痕迹。


以下情况可以视为潜在的投毒代码风险：

* **恶意payload替换：** POC中可以使用更具破坏性的命令，例如删除关键系统文件或者植入长期后门程序。
* **后门植入：**  虽然`pkill nc`试图清除痕迹，但更隐蔽的后门可能被安装，以便后续访问。

综合考虑，该POC主要是为了验证漏洞的存在并执行命令。但是，因为执行了网络连接和创建管道等操作，存在一定被滥用和修改为更具恶意目的的可能性。 因此，将其判定为有 **10%** 的投毒风险。

**利用方式:**

1.  **建立SMTP连接:** 使用`pwn`库与目标OpenSMTPD服务器建立TCP连接。
2.  **发送SMTP命令序列:** 发送`HELO`、`MAIL FROM`、`RCPT TO`和`DATA`等SMTP命令。
3.  **注入恶意代码:** 在`MAIL FROM`命令中，通过注入shell元字符，构造恶意shell命令。例如，``MAIL FROM:<;for i in r j A F L X;do read;done;sh;exit 0;>``
4.  **发送Payload:** 在`DATA`命令之后，发送实际要执行的命令。POC中使用`mkfifo`和`nc`来建立反向shell连接。
5.  **监听反向Shell:** 攻击者在本地主机上使用`nc`监听指定的端口，等待目标服务器建立连接，从而获得shell访问权限。
6.  **清理痕迹:** 攻击完成后，尝试清除在目标系统上留下的痕迹（如通过`pkill nc`杀死nc进程）。

**项目地址:** [superzerosec/cve-2020-7247](https://github.com/superzerosec/cve-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---



---

## POC #4

**来源**: [CVE-2020-7247-bytescrappers_CVE-2020-7247.md](../2020/CVE-2020-7247-bytescrappers_CVE-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，允许远程攻击者以root权限执行任意命令

**影响版本:** 6.6

**利用条件:** 目标系统运行存在漏洞的OpenSMTPD 6.6，并且配置为默认的“uncommented”配置，允许未授权的SMTP连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 smtp_session.c 文件中的 smtp_mailaddr 函数中。攻击者可以通过在 MAIL FROM 字段中注入 shell 元字符，利用不正确的输入验证返回值来执行任意命令，从而实现远程代码执行。根据提供的POC代码，攻击者首先建立与目标SMTP服务器的连接，然后发送 HELO 命令，接着发送包含恶意 shell 命令的 MAIL FROM 命令，该命令利用了漏洞。然后发送 RCPT TO、DATA 命令，再发送包含一段特殊格式的payload, 最后发送 QUIT 命令结束会话。漏洞利用的关键在于MAIL FROM命令中的shell命令注入，利用 OpenSMTPD 未正确处理的漏洞点，执行任意命令。因为漏洞利用代码中的payload部分是接受命令行的参数，没有发现额外的后门代码，所以判定投毒风险为0%。搜索引擎结果确认该漏洞的存在，并指出利用该漏洞可以执行任意shell命令。

**项目地址:** [bytescrappers/CVE-2020-7247](https://github.com/bytescrappers/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #5

**来源**: [CVE-2020-7247-f4T1H21_CVE-2020-7247.md](../2020/CVE-2020-7247-f4T1H21_CVE-2020-7247.md)

## CVE-2020-7247 OpenSMTPD 远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，允许远程攻击者以root权限执行任意命令

**影响版本:** 6.6

**利用条件:** 目标服务器运行受影响版本的OpenSMTPD，并且使用默认配置（未注释）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 `smtp_session.c` 文件中的 `smtp_mailaddr` 函数中。由于对输入验证的错误处理，远程攻击者可以通过构造包含 shell 元字符的 `MAIL FROM` 字段的 SMTP 会话来执行任意命令。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在公开可用的漏洞利用代码。 因此,提供的漏洞利用代码有效。

**投毒风险：** 提供的漏洞利用代码只包含 GNU GPL v3 许可协议的内容，没有发现恶意代码或后门，因此可以判断不存在投毒风险。投毒风险为0%。

**利用方式：**

1.  攻击者与目标 OpenSMTPD 服务器建立 SMTP 连接。
2.  攻击者在 `MAIL FROM` 命令中插入包含 shell 元字符的恶意命令。例如：`MAIL FROM:<;touch /tmp/vuln;>`。
3.  OpenSMTPD 在处理 `MAIL FROM` 地址时，由于输入验证不当，会将恶意命令传递给 shell 执行，从而导致远程命令执行。
4. 攻击者可以利用此漏洞以 root 权限在目标服务器上执行任意命令。

**项目地址:** [f4T1H21/CVE-2020-7247](https://github.com/f4T1H21/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #6

**来源**: [CVE-2020-7247-minhluannguyen_CVE-2020-7247-reproducer.md](../2020/CVE-2020-7247-minhluannguyen_CVE-2020-7247-reproducer.md)

## CVE-2020-7247-OpenSMTPD-RCE

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 6.6

**利用条件:** OpenSMTPD 6.6默认配置，未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247是一个存在于OpenSMTPD 6.6的远程代码执行漏洞。该漏洞位于`smtp_session.c`中的`smtp_mailaddr`函数，由于输入验证不当，允许远程攻击者通过精心构造的SMTP会话，在`MAIL FROM`字段中注入shell元字符，从而以root权限执行任意命令。默认配置下，OpenSMTPD会错误地处理包含shell元字符的`MAIL FROM`地址。攻击者利用点在于`MAIL FROM`参数，通过注入恶意的shell命令，造成远程代码执行。

**有效性评估：**

提供的漏洞利用代码似乎有效。`exploit.py`脚本通过socket连接到目标OpenSMTPD服务器，发送HELO、MAIL FROM、RCPT TO和DATA等SMTP命令，在`MAIL FROM`命令中包含了payload，该payload试图执行反弹shell。Docker文件用于搭建存在漏洞的OpenSMTPD环境，便于验证。

**投毒风险评估：**

经过分析，此仓库中存在作者隐藏的投毒代码可能性较低，约占10%。主要依据如下：
1. `exploit.py`明确地展示了利用payload进行反弹shell，行为明确。
2. Dockerfile 拉取了指定的debian版本，降低了被投毒的可能，同时Dockerfile指定快照源，降低了通过依赖引入投毒的风险。
3. Nix 文件 只是dockerfile的另外一种描述方式，目的是为了构建docker镜像，与投毒无关。

但仍然存在一定的投毒可能：
1. 在`exploit.py`的payload中，攻击者可能会通过某种方式尝试上传或修改服务器上的其他文件，或者运行一些隐蔽的恶意命令，这种行为没有在POC里清晰展示。
2. 其他配置文件中可能存在隐藏的后门或者配置缺陷，不过可能性较低。

**利用方式：**

1.  攻击者首先需要与目标OpenSMTPD服务器建立SMTP连接（端口25）。
2.  发送`HELO`命令进行握手。
3.  关键步骤：发送`MAIL FROM`命令，并在邮件地址中插入shell元字符和恶意命令。例如：`MAIL FROM:<;恶意命令;>`
4.  发送`RCPT TO`命令指定收件人。
5.  发送`DATA`命令，并发送邮件内容（可以为空）。
6.  服务器在处理`MAIL FROM`地址时，由于漏洞，会执行注入的shell命令。
7.  攻击者通过监听指定端口，接收反弹shell，从而获得目标服务器的root权限。

总结：该漏洞利用难度较低，只需要构造特定的SMTP会话，即可触发远程代码执行。

**项目地址:** [minhluannguyen/CVE-2020-7247-reproducer](https://github.com/minhluannguyen/CVE-2020-7247-reproducer)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #7

**来源**: [CVE-2020-7247-presentdaypresenttime_shai_hulud.md](../2020/CVE-2020-7247-presentdaypresenttime_shai_hulud.md)

## CVE-2020-7247 - OpenSMTPD 远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 6.6

**利用条件:** 目标服务器运行OpenSMTPD 6.6版本，且使用未注释的默认配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 smtp_session.c 文件中的 smtp_mailaddr 函数中。由于输入验证不正确，远程攻击者可以通过构造包含 shell 元字符的 MAIL FROM 字段的 SMTP 会话，以 root 权限执行任意命令。提供的漏洞利用代码 (infect.py) 尝试利用此漏洞。该代码首先使用 nmap 扫描局域网以发现潜在的 OpenSMTPD 服务器，然后尝试连接到这些服务器并在 MAIL FROM 字段中注入命令。漏洞利用脚本尝试下载并执行 `woot.sh` 脚本，这个脚本的功能未知，存在潜在的投毒风险。 docker-compose.yml 脚本配置了多个 OpenSMTPD 实例，用于搭建测试环境。\n\n**有效性:** 根据漏洞信息和搜索引擎结果，该漏洞利用的有效性较高。漏洞库信息和搜索结果都确认了该漏洞的存在和可利用性。\n\n**投毒风险:** `infect.py` 中包含从 `raw.githubusercontent.com/presentdaypresenttime/shai_hulud/main/woot.sh` 下载并执行脚本的代码，该脚本内容未知，存在潜在的投毒风险，攻击者可以通过修改 `woot.sh` 的内容植入恶意代码。因此，投毒风险评估为10%。\n\n**利用方式:** 漏洞利用的步骤如下：\n1. 使用 nmap 扫描局域网，发现运行 OpenSMTPD 服务的服务器。\n2. 连接到目标服务器的 25 端口。\n3. 发送 HELO 命令建立连接。\n4. 发送包含恶意命令的 MAIL FROM 命令，利用 shell 注入漏洞执行命令。\n5. 发送 RCPT TO, DATA 命令模拟邮件发送过程。\n6. 发送 QUIT 命令断开连接。

**项目地址:** [presentdaypresenttime/shai_hulud](https://github.com/presentdaypresenttime/shai_hulud)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #8

**来源**: [CVE-2020-7247-r0lh_CVE-2020-7247.md](../2020/CVE-2020-7247-r0lh_CVE-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可导致以root权限执行任意命令

**影响版本:** < 6.6.2

**利用条件:** 目标服务器运行存在漏洞的OpenSMTPD版本，且允许SMTP连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-7247 存在于 OpenSMTPD 6.6 版本中，由于在 `smtp_session.c` 文件的 `smtp_mailaddr` 函数中，对输入验证失败时返回了错误的值，导致攻击者可以通过在 `MAIL FROM` 字段中注入 shell 元字符，从而以 root 权限执行任意命令。该漏洞影响使用默认配置（未注释）的 OpenSMTPD 服务器。

**漏洞利用方式：**

1.  **连接目标SMTP服务器：** 利用代码首先尝试连接到目标 OpenSMTPD 服务器的 25 端口 (或其他指定的端口)。
2.  **发送HELO命令：**  与服务器建立 SMTP 会话。
3.  **注入恶意payload：** 在`MAIL FROM`命令中使用shell元字符，执行命令。
4.  **设置接收者：** 使用`RCPT TO`命令设置邮件接收者。
5.  **发送DATA命令：** 发送`DATA`命令，并发送包含反弹shell命令的payload。
6.  **启动监听：**  攻击者使用 `nc` 命令监听指定端口，等待目标服务器反弹 shell 连接。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用的有效性较高。POC代码已经公开，并且多个来源证实可以通过`MAIL FROM`注入执行任意命令。

**投毒风险：**

POC代码主要是利用 OpenSMTPD 漏洞实现反弹 shell。代码中存在设置监听端口和IP地址的操作，但这是反弹shell的必要步骤，不能直接判定为投毒。代码本身较为直接，没有发现明显的恶意或隐藏行为。投毒风险极小，但需要评估代码执行的payload，风险评估约为5%。


**项目地址:** [r0lh/CVE-2020-7247](https://github.com/r0lh/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #9

**来源**: [CVE-2020-7247-superzerosec_cve-2020-7247.md](../2020/CVE-2020-7247-superzerosec_cve-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致完全控制受影响的服务器

**影响版本:** < 6.6.2

**利用条件:** 需要目标服务器运行OpenSMTPD服务，且配置为默认的未注释配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 存在于OpenSMTPD 6.6.2之前的版本中。攻击者可以通过在`MAIL FROM`字段中注入shell元字符，利用SMTP会话执行任意系统命令，获得root权限。漏洞的根本原因是程序没有充分过滤用户可控的输入。

**有效性:** 提供的POC代码（poc1.py）看起来是有效的。它使用`pwn`库来建立与目标SMTP服务器的连接，并发送一系列SMTP命令，其中`MAIL FROM`命令包含恶意shell代码。如果目标服务器存在漏洞，这段代码将执行任意命令。

**投毒风险:**  POC代码主要目的是利用该漏洞，实现远程命令执行。其中值得关注的点：

*   **使用mkfifo创建管道:** 代码使用`mkfifo`创建一个命名管道`/tmp/nnwo`，然后使用`nc`将命令发送到该管道，并通过`/bin/sh`执行，最后将结果重定向到该管道，并将错误信息也重定向。这个过程本身是为了建立一个反向shell。
*   **清除痕迹:** 代码尝试在攻击完成后通过`pkill nc`清除网络连接的痕迹。


以下情况可以视为潜在的投毒代码风险：

* **恶意payload替换：** POC中可以使用更具破坏性的命令，例如删除关键系统文件或者植入长期后门程序。
* **后门植入：**  虽然`pkill nc`试图清除痕迹，但更隐蔽的后门可能被安装，以便后续访问。

综合考虑，该POC主要是为了验证漏洞的存在并执行命令。但是，因为执行了网络连接和创建管道等操作，存在一定被滥用和修改为更具恶意目的的可能性。 因此，将其判定为有 **10%** 的投毒风险。

**利用方式:**

1.  **建立SMTP连接:** 使用`pwn`库与目标OpenSMTPD服务器建立TCP连接。
2.  **发送SMTP命令序列:** 发送`HELO`、`MAIL FROM`、`RCPT TO`和`DATA`等SMTP命令。
3.  **注入恶意代码:** 在`MAIL FROM`命令中，通过注入shell元字符，构造恶意shell命令。例如，``MAIL FROM:<;for i in r j A F L X;do read;done;sh;exit 0;>``
4.  **发送Payload:** 在`DATA`命令之后，发送实际要执行的命令。POC中使用`mkfifo`和`nc`来建立反向shell连接。
5.  **监听反向Shell:** 攻击者在本地主机上使用`nc`监听指定的端口，等待目标服务器建立连接，从而获得shell访问权限。
6.  **清理痕迹:** 攻击完成后，尝试清除在目标系统上留下的痕迹（如通过`pkill nc`杀死nc进程）。

**项目地址:** [superzerosec/cve-2020-7247](https://github.com/superzerosec/cve-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---



---

## POC #4

**来源**: [CVE-2020-7247-bytescrappers_CVE-2020-7247.md](../2020/CVE-2020-7247-bytescrappers_CVE-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，允许远程攻击者以root权限执行任意命令

**影响版本:** 6.6

**利用条件:** 目标系统运行存在漏洞的OpenSMTPD 6.6，并且配置为默认的“uncommented”配置，允许未授权的SMTP连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 smtp_session.c 文件中的 smtp_mailaddr 函数中。攻击者可以通过在 MAIL FROM 字段中注入 shell 元字符，利用不正确的输入验证返回值来执行任意命令，从而实现远程代码执行。根据提供的POC代码，攻击者首先建立与目标SMTP服务器的连接，然后发送 HELO 命令，接着发送包含恶意 shell 命令的 MAIL FROM 命令，该命令利用了漏洞。然后发送 RCPT TO、DATA 命令，再发送包含一段特殊格式的payload, 最后发送 QUIT 命令结束会话。漏洞利用的关键在于MAIL FROM命令中的shell命令注入，利用 OpenSMTPD 未正确处理的漏洞点，执行任意命令。因为漏洞利用代码中的payload部分是接受命令行的参数，没有发现额外的后门代码，所以判定投毒风险为0%。搜索引擎结果确认该漏洞的存在，并指出利用该漏洞可以执行任意shell命令。

**项目地址:** [bytescrappers/CVE-2020-7247](https://github.com/bytescrappers/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #5

**来源**: [CVE-2020-7247-f4T1H21_CVE-2020-7247.md](../2020/CVE-2020-7247-f4T1H21_CVE-2020-7247.md)

## CVE-2020-7247 OpenSMTPD 远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，允许远程攻击者以root权限执行任意命令

**影响版本:** 6.6

**利用条件:** 目标服务器运行受影响版本的OpenSMTPD，并且使用默认配置（未注释）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 `smtp_session.c` 文件中的 `smtp_mailaddr` 函数中。由于对输入验证的错误处理，远程攻击者可以通过构造包含 shell 元字符的 `MAIL FROM` 字段的 SMTP 会话来执行任意命令。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在公开可用的漏洞利用代码。 因此,提供的漏洞利用代码有效。

**投毒风险：** 提供的漏洞利用代码只包含 GNU GPL v3 许可协议的内容，没有发现恶意代码或后门，因此可以判断不存在投毒风险。投毒风险为0%。

**利用方式：**

1.  攻击者与目标 OpenSMTPD 服务器建立 SMTP 连接。
2.  攻击者在 `MAIL FROM` 命令中插入包含 shell 元字符的恶意命令。例如：`MAIL FROM:<;touch /tmp/vuln;>`。
3.  OpenSMTPD 在处理 `MAIL FROM` 地址时，由于输入验证不当，会将恶意命令传递给 shell 执行，从而导致远程命令执行。
4. 攻击者可以利用此漏洞以 root 权限在目标服务器上执行任意命令。

**项目地址:** [f4T1H21/CVE-2020-7247](https://github.com/f4T1H21/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #6

**来源**: [CVE-2020-7247-minhluannguyen_CVE-2020-7247-reproducer.md](../2020/CVE-2020-7247-minhluannguyen_CVE-2020-7247-reproducer.md)

## CVE-2020-7247-OpenSMTPD-RCE

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 6.6

**利用条件:** OpenSMTPD 6.6默认配置，未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247是一个存在于OpenSMTPD 6.6的远程代码执行漏洞。该漏洞位于`smtp_session.c`中的`smtp_mailaddr`函数，由于输入验证不当，允许远程攻击者通过精心构造的SMTP会话，在`MAIL FROM`字段中注入shell元字符，从而以root权限执行任意命令。默认配置下，OpenSMTPD会错误地处理包含shell元字符的`MAIL FROM`地址。攻击者利用点在于`MAIL FROM`参数，通过注入恶意的shell命令，造成远程代码执行。

**有效性评估：**

提供的漏洞利用代码似乎有效。`exploit.py`脚本通过socket连接到目标OpenSMTPD服务器，发送HELO、MAIL FROM、RCPT TO和DATA等SMTP命令，在`MAIL FROM`命令中包含了payload，该payload试图执行反弹shell。Docker文件用于搭建存在漏洞的OpenSMTPD环境，便于验证。

**投毒风险评估：**

经过分析，此仓库中存在作者隐藏的投毒代码可能性较低，约占10%。主要依据如下：
1. `exploit.py`明确地展示了利用payload进行反弹shell，行为明确。
2. Dockerfile 拉取了指定的debian版本，降低了被投毒的可能，同时Dockerfile指定快照源，降低了通过依赖引入投毒的风险。
3. Nix 文件 只是dockerfile的另外一种描述方式，目的是为了构建docker镜像，与投毒无关。

但仍然存在一定的投毒可能：
1. 在`exploit.py`的payload中，攻击者可能会通过某种方式尝试上传或修改服务器上的其他文件，或者运行一些隐蔽的恶意命令，这种行为没有在POC里清晰展示。
2. 其他配置文件中可能存在隐藏的后门或者配置缺陷，不过可能性较低。

**利用方式：**

1.  攻击者首先需要与目标OpenSMTPD服务器建立SMTP连接（端口25）。
2.  发送`HELO`命令进行握手。
3.  关键步骤：发送`MAIL FROM`命令，并在邮件地址中插入shell元字符和恶意命令。例如：`MAIL FROM:<;恶意命令;>`
4.  发送`RCPT TO`命令指定收件人。
5.  发送`DATA`命令，并发送邮件内容（可以为空）。
6.  服务器在处理`MAIL FROM`地址时，由于漏洞，会执行注入的shell命令。
7.  攻击者通过监听指定端口，接收反弹shell，从而获得目标服务器的root权限。

总结：该漏洞利用难度较低，只需要构造特定的SMTP会话，即可触发远程代码执行。

**项目地址:** [minhluannguyen/CVE-2020-7247-reproducer](https://github.com/minhluannguyen/CVE-2020-7247-reproducer)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #7

**来源**: [CVE-2020-7247-presentdaypresenttime_shai_hulud.md](../2020/CVE-2020-7247-presentdaypresenttime_shai_hulud.md)

## CVE-2020-7247 - OpenSMTPD 远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 6.6

**利用条件:** 目标服务器运行OpenSMTPD 6.6版本，且使用未注释的默认配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 smtp_session.c 文件中的 smtp_mailaddr 函数中。由于输入验证不正确，远程攻击者可以通过构造包含 shell 元字符的 MAIL FROM 字段的 SMTP 会话，以 root 权限执行任意命令。提供的漏洞利用代码 (infect.py) 尝试利用此漏洞。该代码首先使用 nmap 扫描局域网以发现潜在的 OpenSMTPD 服务器，然后尝试连接到这些服务器并在 MAIL FROM 字段中注入命令。漏洞利用脚本尝试下载并执行 `woot.sh` 脚本，这个脚本的功能未知，存在潜在的投毒风险。 docker-compose.yml 脚本配置了多个 OpenSMTPD 实例，用于搭建测试环境。\n\n**有效性:** 根据漏洞信息和搜索引擎结果，该漏洞利用的有效性较高。漏洞库信息和搜索结果都确认了该漏洞的存在和可利用性。\n\n**投毒风险:** `infect.py` 中包含从 `raw.githubusercontent.com/presentdaypresenttime/shai_hulud/main/woot.sh` 下载并执行脚本的代码，该脚本内容未知，存在潜在的投毒风险，攻击者可以通过修改 `woot.sh` 的内容植入恶意代码。因此，投毒风险评估为10%。\n\n**利用方式:** 漏洞利用的步骤如下：\n1. 使用 nmap 扫描局域网，发现运行 OpenSMTPD 服务的服务器。\n2. 连接到目标服务器的 25 端口。\n3. 发送 HELO 命令建立连接。\n4. 发送包含恶意命令的 MAIL FROM 命令，利用 shell 注入漏洞执行命令。\n5. 发送 RCPT TO, DATA 命令模拟邮件发送过程。\n6. 发送 QUIT 命令断开连接。

**项目地址:** [presentdaypresenttime/shai_hulud](https://github.com/presentdaypresenttime/shai_hulud)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #8

**来源**: [CVE-2020-7247-r0lh_CVE-2020-7247.md](../2020/CVE-2020-7247-r0lh_CVE-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可导致以root权限执行任意命令

**影响版本:** < 6.6.2

**利用条件:** 目标服务器运行存在漏洞的OpenSMTPD版本，且允许SMTP连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-7247 存在于 OpenSMTPD 6.6 版本中，由于在 `smtp_session.c` 文件的 `smtp_mailaddr` 函数中，对输入验证失败时返回了错误的值，导致攻击者可以通过在 `MAIL FROM` 字段中注入 shell 元字符，从而以 root 权限执行任意命令。该漏洞影响使用默认配置（未注释）的 OpenSMTPD 服务器。

**漏洞利用方式：**

1.  **连接目标SMTP服务器：** 利用代码首先尝试连接到目标 OpenSMTPD 服务器的 25 端口 (或其他指定的端口)。
2.  **发送HELO命令：**  与服务器建立 SMTP 会话。
3.  **注入恶意payload：** 在`MAIL FROM`命令中使用shell元字符，执行命令。
4.  **设置接收者：** 使用`RCPT TO`命令设置邮件接收者。
5.  **发送DATA命令：** 发送`DATA`命令，并发送包含反弹shell命令的payload。
6.  **启动监听：**  攻击者使用 `nc` 命令监听指定端口，等待目标服务器反弹 shell 连接。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用的有效性较高。POC代码已经公开，并且多个来源证实可以通过`MAIL FROM`注入执行任意命令。

**投毒风险：**

POC代码主要是利用 OpenSMTPD 漏洞实现反弹 shell。代码中存在设置监听端口和IP地址的操作，但这是反弹shell的必要步骤，不能直接判定为投毒。代码本身较为直接，没有发现明显的恶意或隐藏行为。投毒风险极小，但需要评估代码执行的payload，风险评估约为5%。


**项目地址:** [r0lh/CVE-2020-7247](https://github.com/r0lh/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #9

**来源**: [CVE-2020-7247-superzerosec_cve-2020-7247.md](../2020/CVE-2020-7247-superzerosec_cve-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致完全控制受影响的服务器

**影响版本:** < 6.6.2

**利用条件:** 需要目标服务器运行OpenSMTPD服务，且配置为默认的未注释配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 存在于OpenSMTPD 6.6.2之前的版本中。攻击者可以通过在`MAIL FROM`字段中注入shell元字符，利用SMTP会话执行任意系统命令，获得root权限。漏洞的根本原因是程序没有充分过滤用户可控的输入。

**有效性:** 提供的POC代码（poc1.py）看起来是有效的。它使用`pwn`库来建立与目标SMTP服务器的连接，并发送一系列SMTP命令，其中`MAIL FROM`命令包含恶意shell代码。如果目标服务器存在漏洞，这段代码将执行任意命令。

**投毒风险:**  POC代码主要目的是利用该漏洞，实现远程命令执行。其中值得关注的点：

*   **使用mkfifo创建管道:** 代码使用`mkfifo`创建一个命名管道`/tmp/nnwo`，然后使用`nc`将命令发送到该管道，并通过`/bin/sh`执行，最后将结果重定向到该管道，并将错误信息也重定向。这个过程本身是为了建立一个反向shell。
*   **清除痕迹:** 代码尝试在攻击完成后通过`pkill nc`清除网络连接的痕迹。


以下情况可以视为潜在的投毒代码风险：

* **恶意payload替换：** POC中可以使用更具破坏性的命令，例如删除关键系统文件或者植入长期后门程序。
* **后门植入：**  虽然`pkill nc`试图清除痕迹，但更隐蔽的后门可能被安装，以便后续访问。

综合考虑，该POC主要是为了验证漏洞的存在并执行命令。但是，因为执行了网络连接和创建管道等操作，存在一定被滥用和修改为更具恶意目的的可能性。 因此，将其判定为有 **10%** 的投毒风险。

**利用方式:**

1.  **建立SMTP连接:** 使用`pwn`库与目标OpenSMTPD服务器建立TCP连接。
2.  **发送SMTP命令序列:** 发送`HELO`、`MAIL FROM`、`RCPT TO`和`DATA`等SMTP命令。
3.  **注入恶意代码:** 在`MAIL FROM`命令中，通过注入shell元字符，构造恶意shell命令。例如，``MAIL FROM:<;for i in r j A F L X;do read;done;sh;exit 0;>``
4.  **发送Payload:** 在`DATA`命令之后，发送实际要执行的命令。POC中使用`mkfifo`和`nc`来建立反向shell连接。
5.  **监听反向Shell:** 攻击者在本地主机上使用`nc`监听指定的端口，等待目标服务器建立连接，从而获得shell访问权限。
6.  **清理痕迹:** 攻击完成后，尝试清除在目标系统上留下的痕迹（如通过`pkill nc`杀死nc进程）。

**项目地址:** [superzerosec/cve-2020-7247](https://github.com/superzerosec/cve-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---



---

## POC #4

**来源**: [CVE-2020-7247-bytescrappers_CVE-2020-7247.md](../2020/CVE-2020-7247-bytescrappers_CVE-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，允许远程攻击者以root权限执行任意命令

**影响版本:** 6.6

**利用条件:** 目标系统运行存在漏洞的OpenSMTPD 6.6，并且配置为默认的“uncommented”配置，允许未授权的SMTP连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 smtp_session.c 文件中的 smtp_mailaddr 函数中。攻击者可以通过在 MAIL FROM 字段中注入 shell 元字符，利用不正确的输入验证返回值来执行任意命令，从而实现远程代码执行。根据提供的POC代码，攻击者首先建立与目标SMTP服务器的连接，然后发送 HELO 命令，接着发送包含恶意 shell 命令的 MAIL FROM 命令，该命令利用了漏洞。然后发送 RCPT TO、DATA 命令，再发送包含一段特殊格式的payload, 最后发送 QUIT 命令结束会话。漏洞利用的关键在于MAIL FROM命令中的shell命令注入，利用 OpenSMTPD 未正确处理的漏洞点，执行任意命令。因为漏洞利用代码中的payload部分是接受命令行的参数，没有发现额外的后门代码，所以判定投毒风险为0%。搜索引擎结果确认该漏洞的存在，并指出利用该漏洞可以执行任意shell命令。

**项目地址:** [bytescrappers/CVE-2020-7247](https://github.com/bytescrappers/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #5

**来源**: [CVE-2020-7247-f4T1H21_CVE-2020-7247.md](../2020/CVE-2020-7247-f4T1H21_CVE-2020-7247.md)

## CVE-2020-7247 OpenSMTPD 远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，允许远程攻击者以root权限执行任意命令

**影响版本:** 6.6

**利用条件:** 目标服务器运行受影响版本的OpenSMTPD，并且使用默认配置（未注释）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 `smtp_session.c` 文件中的 `smtp_mailaddr` 函数中。由于对输入验证的错误处理，远程攻击者可以通过构造包含 shell 元字符的 `MAIL FROM` 字段的 SMTP 会话来执行任意命令。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在公开可用的漏洞利用代码。 因此,提供的漏洞利用代码有效。

**投毒风险：** 提供的漏洞利用代码只包含 GNU GPL v3 许可协议的内容，没有发现恶意代码或后门，因此可以判断不存在投毒风险。投毒风险为0%。

**利用方式：**

1.  攻击者与目标 OpenSMTPD 服务器建立 SMTP 连接。
2.  攻击者在 `MAIL FROM` 命令中插入包含 shell 元字符的恶意命令。例如：`MAIL FROM:<;touch /tmp/vuln;>`。
3.  OpenSMTPD 在处理 `MAIL FROM` 地址时，由于输入验证不当，会将恶意命令传递给 shell 执行，从而导致远程命令执行。
4. 攻击者可以利用此漏洞以 root 权限在目标服务器上执行任意命令。

**项目地址:** [f4T1H21/CVE-2020-7247](https://github.com/f4T1H21/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #6

**来源**: [CVE-2020-7247-minhluannguyen_CVE-2020-7247-reproducer.md](../2020/CVE-2020-7247-minhluannguyen_CVE-2020-7247-reproducer.md)

## CVE-2020-7247-OpenSMTPD-RCE

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 6.6

**利用条件:** OpenSMTPD 6.6默认配置，未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247是一个存在于OpenSMTPD 6.6的远程代码执行漏洞。该漏洞位于`smtp_session.c`中的`smtp_mailaddr`函数，由于输入验证不当，允许远程攻击者通过精心构造的SMTP会话，在`MAIL FROM`字段中注入shell元字符，从而以root权限执行任意命令。默认配置下，OpenSMTPD会错误地处理包含shell元字符的`MAIL FROM`地址。攻击者利用点在于`MAIL FROM`参数，通过注入恶意的shell命令，造成远程代码执行。

**有效性评估：**

提供的漏洞利用代码似乎有效。`exploit.py`脚本通过socket连接到目标OpenSMTPD服务器，发送HELO、MAIL FROM、RCPT TO和DATA等SMTP命令，在`MAIL FROM`命令中包含了payload，该payload试图执行反弹shell。Docker文件用于搭建存在漏洞的OpenSMTPD环境，便于验证。

**投毒风险评估：**

经过分析，此仓库中存在作者隐藏的投毒代码可能性较低，约占10%。主要依据如下：
1. `exploit.py`明确地展示了利用payload进行反弹shell，行为明确。
2. Dockerfile 拉取了指定的debian版本，降低了被投毒的可能，同时Dockerfile指定快照源，降低了通过依赖引入投毒的风险。
3. Nix 文件 只是dockerfile的另外一种描述方式，目的是为了构建docker镜像，与投毒无关。

但仍然存在一定的投毒可能：
1. 在`exploit.py`的payload中，攻击者可能会通过某种方式尝试上传或修改服务器上的其他文件，或者运行一些隐蔽的恶意命令，这种行为没有在POC里清晰展示。
2. 其他配置文件中可能存在隐藏的后门或者配置缺陷，不过可能性较低。

**利用方式：**

1.  攻击者首先需要与目标OpenSMTPD服务器建立SMTP连接（端口25）。
2.  发送`HELO`命令进行握手。
3.  关键步骤：发送`MAIL FROM`命令，并在邮件地址中插入shell元字符和恶意命令。例如：`MAIL FROM:<;恶意命令;>`
4.  发送`RCPT TO`命令指定收件人。
5.  发送`DATA`命令，并发送邮件内容（可以为空）。
6.  服务器在处理`MAIL FROM`地址时，由于漏洞，会执行注入的shell命令。
7.  攻击者通过监听指定端口，接收反弹shell，从而获得目标服务器的root权限。

总结：该漏洞利用难度较低，只需要构造特定的SMTP会话，即可触发远程代码执行。

**项目地址:** [minhluannguyen/CVE-2020-7247-reproducer](https://github.com/minhluannguyen/CVE-2020-7247-reproducer)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #7

**来源**: [CVE-2020-7247-presentdaypresenttime_shai_hulud.md](../2020/CVE-2020-7247-presentdaypresenttime_shai_hulud.md)

## CVE-2020-7247 - OpenSMTPD 远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 6.6

**利用条件:** 目标服务器运行OpenSMTPD 6.6版本，且使用未注释的默认配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 smtp_session.c 文件中的 smtp_mailaddr 函数中。由于输入验证不正确，远程攻击者可以通过构造包含 shell 元字符的 MAIL FROM 字段的 SMTP 会话，以 root 权限执行任意命令。提供的漏洞利用代码 (infect.py) 尝试利用此漏洞。该代码首先使用 nmap 扫描局域网以发现潜在的 OpenSMTPD 服务器，然后尝试连接到这些服务器并在 MAIL FROM 字段中注入命令。漏洞利用脚本尝试下载并执行 `woot.sh` 脚本，这个脚本的功能未知，存在潜在的投毒风险。 docker-compose.yml 脚本配置了多个 OpenSMTPD 实例，用于搭建测试环境。\n\n**有效性:** 根据漏洞信息和搜索引擎结果，该漏洞利用的有效性较高。漏洞库信息和搜索结果都确认了该漏洞的存在和可利用性。\n\n**投毒风险:** `infect.py` 中包含从 `raw.githubusercontent.com/presentdaypresenttime/shai_hulud/main/woot.sh` 下载并执行脚本的代码，该脚本内容未知，存在潜在的投毒风险，攻击者可以通过修改 `woot.sh` 的内容植入恶意代码。因此，投毒风险评估为10%。\n\n**利用方式:** 漏洞利用的步骤如下：\n1. 使用 nmap 扫描局域网，发现运行 OpenSMTPD 服务的服务器。\n2. 连接到目标服务器的 25 端口。\n3. 发送 HELO 命令建立连接。\n4. 发送包含恶意命令的 MAIL FROM 命令，利用 shell 注入漏洞执行命令。\n5. 发送 RCPT TO, DATA 命令模拟邮件发送过程。\n6. 发送 QUIT 命令断开连接。

**项目地址:** [presentdaypresenttime/shai_hulud](https://github.com/presentdaypresenttime/shai_hulud)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #8

**来源**: [CVE-2020-7247-r0lh_CVE-2020-7247.md](../2020/CVE-2020-7247-r0lh_CVE-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可导致以root权限执行任意命令

**影响版本:** < 6.6.2

**利用条件:** 目标服务器运行存在漏洞的OpenSMTPD版本，且允许SMTP连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-7247 存在于 OpenSMTPD 6.6 版本中，由于在 `smtp_session.c` 文件的 `smtp_mailaddr` 函数中，对输入验证失败时返回了错误的值，导致攻击者可以通过在 `MAIL FROM` 字段中注入 shell 元字符，从而以 root 权限执行任意命令。该漏洞影响使用默认配置（未注释）的 OpenSMTPD 服务器。

**漏洞利用方式：**

1.  **连接目标SMTP服务器：** 利用代码首先尝试连接到目标 OpenSMTPD 服务器的 25 端口 (或其他指定的端口)。
2.  **发送HELO命令：**  与服务器建立 SMTP 会话。
3.  **注入恶意payload：** 在`MAIL FROM`命令中使用shell元字符，执行命令。
4.  **设置接收者：** 使用`RCPT TO`命令设置邮件接收者。
5.  **发送DATA命令：** 发送`DATA`命令，并发送包含反弹shell命令的payload。
6.  **启动监听：**  攻击者使用 `nc` 命令监听指定端口，等待目标服务器反弹 shell 连接。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用的有效性较高。POC代码已经公开，并且多个来源证实可以通过`MAIL FROM`注入执行任意命令。

**投毒风险：**

POC代码主要是利用 OpenSMTPD 漏洞实现反弹 shell。代码中存在设置监听端口和IP地址的操作，但这是反弹shell的必要步骤，不能直接判定为投毒。代码本身较为直接，没有发现明显的恶意或隐藏行为。投毒风险极小，但需要评估代码执行的payload，风险评估约为5%。


**项目地址:** [r0lh/CVE-2020-7247](https://github.com/r0lh/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #9

**来源**: [CVE-2020-7247-superzerosec_cve-2020-7247.md](../2020/CVE-2020-7247-superzerosec_cve-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致完全控制受影响的服务器

**影响版本:** < 6.6.2

**利用条件:** 需要目标服务器运行OpenSMTPD服务，且配置为默认的未注释配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 存在于OpenSMTPD 6.6.2之前的版本中。攻击者可以通过在`MAIL FROM`字段中注入shell元字符，利用SMTP会话执行任意系统命令，获得root权限。漏洞的根本原因是程序没有充分过滤用户可控的输入。

**有效性:** 提供的POC代码（poc1.py）看起来是有效的。它使用`pwn`库来建立与目标SMTP服务器的连接，并发送一系列SMTP命令，其中`MAIL FROM`命令包含恶意shell代码。如果目标服务器存在漏洞，这段代码将执行任意命令。

**投毒风险:**  POC代码主要目的是利用该漏洞，实现远程命令执行。其中值得关注的点：

*   **使用mkfifo创建管道:** 代码使用`mkfifo`创建一个命名管道`/tmp/nnwo`，然后使用`nc`将命令发送到该管道，并通过`/bin/sh`执行，最后将结果重定向到该管道，并将错误信息也重定向。这个过程本身是为了建立一个反向shell。
*   **清除痕迹:** 代码尝试在攻击完成后通过`pkill nc`清除网络连接的痕迹。


以下情况可以视为潜在的投毒代码风险：

* **恶意payload替换：** POC中可以使用更具破坏性的命令，例如删除关键系统文件或者植入长期后门程序。
* **后门植入：**  虽然`pkill nc`试图清除痕迹，但更隐蔽的后门可能被安装，以便后续访问。

综合考虑，该POC主要是为了验证漏洞的存在并执行命令。但是，因为执行了网络连接和创建管道等操作，存在一定被滥用和修改为更具恶意目的的可能性。 因此，将其判定为有 **10%** 的投毒风险。

**利用方式:**

1.  **建立SMTP连接:** 使用`pwn`库与目标OpenSMTPD服务器建立TCP连接。
2.  **发送SMTP命令序列:** 发送`HELO`、`MAIL FROM`、`RCPT TO`和`DATA`等SMTP命令。
3.  **注入恶意代码:** 在`MAIL FROM`命令中，通过注入shell元字符，构造恶意shell命令。例如，``MAIL FROM:<;for i in r j A F L X;do read;done;sh;exit 0;>``
4.  **发送Payload:** 在`DATA`命令之后，发送实际要执行的命令。POC中使用`mkfifo`和`nc`来建立反向shell连接。
5.  **监听反向Shell:** 攻击者在本地主机上使用`nc`监听指定的端口，等待目标服务器建立连接，从而获得shell访问权限。
6.  **清理痕迹:** 攻击完成后，尝试清除在目标系统上留下的痕迹（如通过`pkill nc`杀死nc进程）。

**项目地址:** [superzerosec/cve-2020-7247](https://github.com/superzerosec/cve-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---



---

## POC #4

**来源**: [CVE-2020-7247-bytescrappers_CVE-2020-7247.md](../2020/CVE-2020-7247-bytescrappers_CVE-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，允许远程攻击者以root权限执行任意命令

**影响版本:** 6.6

**利用条件:** 目标系统运行存在漏洞的OpenSMTPD 6.6，并且配置为默认的“uncommented”配置，允许未授权的SMTP连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 smtp_session.c 文件中的 smtp_mailaddr 函数中。攻击者可以通过在 MAIL FROM 字段中注入 shell 元字符，利用不正确的输入验证返回值来执行任意命令，从而实现远程代码执行。根据提供的POC代码，攻击者首先建立与目标SMTP服务器的连接，然后发送 HELO 命令，接着发送包含恶意 shell 命令的 MAIL FROM 命令，该命令利用了漏洞。然后发送 RCPT TO、DATA 命令，再发送包含一段特殊格式的payload, 最后发送 QUIT 命令结束会话。漏洞利用的关键在于MAIL FROM命令中的shell命令注入，利用 OpenSMTPD 未正确处理的漏洞点，执行任意命令。因为漏洞利用代码中的payload部分是接受命令行的参数，没有发现额外的后门代码，所以判定投毒风险为0%。搜索引擎结果确认该漏洞的存在，并指出利用该漏洞可以执行任意shell命令。

**项目地址:** [bytescrappers/CVE-2020-7247](https://github.com/bytescrappers/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #5

**来源**: [CVE-2020-7247-f4T1H21_CVE-2020-7247.md](../2020/CVE-2020-7247-f4T1H21_CVE-2020-7247.md)

## CVE-2020-7247 OpenSMTPD 远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，允许远程攻击者以root权限执行任意命令

**影响版本:** 6.6

**利用条件:** 目标服务器运行受影响版本的OpenSMTPD，并且使用默认配置（未注释）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 `smtp_session.c` 文件中的 `smtp_mailaddr` 函数中。由于对输入验证的错误处理，远程攻击者可以通过构造包含 shell 元字符的 `MAIL FROM` 字段的 SMTP 会话来执行任意命令。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在公开可用的漏洞利用代码。 因此,提供的漏洞利用代码有效。

**投毒风险：** 提供的漏洞利用代码只包含 GNU GPL v3 许可协议的内容，没有发现恶意代码或后门，因此可以判断不存在投毒风险。投毒风险为0%。

**利用方式：**

1.  攻击者与目标 OpenSMTPD 服务器建立 SMTP 连接。
2.  攻击者在 `MAIL FROM` 命令中插入包含 shell 元字符的恶意命令。例如：`MAIL FROM:<;touch /tmp/vuln;>`。
3.  OpenSMTPD 在处理 `MAIL FROM` 地址时，由于输入验证不当，会将恶意命令传递给 shell 执行，从而导致远程命令执行。
4. 攻击者可以利用此漏洞以 root 权限在目标服务器上执行任意命令。

**项目地址:** [f4T1H21/CVE-2020-7247](https://github.com/f4T1H21/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #6

**来源**: [CVE-2020-7247-minhluannguyen_CVE-2020-7247-reproducer.md](../2020/CVE-2020-7247-minhluannguyen_CVE-2020-7247-reproducer.md)

## CVE-2020-7247-OpenSMTPD-RCE

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 6.6

**利用条件:** OpenSMTPD 6.6默认配置，未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247是一个存在于OpenSMTPD 6.6的远程代码执行漏洞。该漏洞位于`smtp_session.c`中的`smtp_mailaddr`函数，由于输入验证不当，允许远程攻击者通过精心构造的SMTP会话，在`MAIL FROM`字段中注入shell元字符，从而以root权限执行任意命令。默认配置下，OpenSMTPD会错误地处理包含shell元字符的`MAIL FROM`地址。攻击者利用点在于`MAIL FROM`参数，通过注入恶意的shell命令，造成远程代码执行。

**有效性评估：**

提供的漏洞利用代码似乎有效。`exploit.py`脚本通过socket连接到目标OpenSMTPD服务器，发送HELO、MAIL FROM、RCPT TO和DATA等SMTP命令，在`MAIL FROM`命令中包含了payload，该payload试图执行反弹shell。Docker文件用于搭建存在漏洞的OpenSMTPD环境，便于验证。

**投毒风险评估：**

经过分析，此仓库中存在作者隐藏的投毒代码可能性较低，约占10%。主要依据如下：
1. `exploit.py`明确地展示了利用payload进行反弹shell，行为明确。
2. Dockerfile 拉取了指定的debian版本，降低了被投毒的可能，同时Dockerfile指定快照源，降低了通过依赖引入投毒的风险。
3. Nix 文件 只是dockerfile的另外一种描述方式，目的是为了构建docker镜像，与投毒无关。

但仍然存在一定的投毒可能：
1. 在`exploit.py`的payload中，攻击者可能会通过某种方式尝试上传或修改服务器上的其他文件，或者运行一些隐蔽的恶意命令，这种行为没有在POC里清晰展示。
2. 其他配置文件中可能存在隐藏的后门或者配置缺陷，不过可能性较低。

**利用方式：**

1.  攻击者首先需要与目标OpenSMTPD服务器建立SMTP连接（端口25）。
2.  发送`HELO`命令进行握手。
3.  关键步骤：发送`MAIL FROM`命令，并在邮件地址中插入shell元字符和恶意命令。例如：`MAIL FROM:<;恶意命令;>`
4.  发送`RCPT TO`命令指定收件人。
5.  发送`DATA`命令，并发送邮件内容（可以为空）。
6.  服务器在处理`MAIL FROM`地址时，由于漏洞，会执行注入的shell命令。
7.  攻击者通过监听指定端口，接收反弹shell，从而获得目标服务器的root权限。

总结：该漏洞利用难度较低，只需要构造特定的SMTP会话，即可触发远程代码执行。

**项目地址:** [minhluannguyen/CVE-2020-7247-reproducer](https://github.com/minhluannguyen/CVE-2020-7247-reproducer)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #7

**来源**: [CVE-2020-7247-presentdaypresenttime_shai_hulud.md](../2020/CVE-2020-7247-presentdaypresenttime_shai_hulud.md)

## CVE-2020-7247 - OpenSMTPD 远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 6.6

**利用条件:** 目标服务器运行OpenSMTPD 6.6版本，且使用未注释的默认配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 smtp_session.c 文件中的 smtp_mailaddr 函数中。由于输入验证不正确，远程攻击者可以通过构造包含 shell 元字符的 MAIL FROM 字段的 SMTP 会话，以 root 权限执行任意命令。提供的漏洞利用代码 (infect.py) 尝试利用此漏洞。该代码首先使用 nmap 扫描局域网以发现潜在的 OpenSMTPD 服务器，然后尝试连接到这些服务器并在 MAIL FROM 字段中注入命令。漏洞利用脚本尝试下载并执行 `woot.sh` 脚本，这个脚本的功能未知，存在潜在的投毒风险。 docker-compose.yml 脚本配置了多个 OpenSMTPD 实例，用于搭建测试环境。\n\n**有效性:** 根据漏洞信息和搜索引擎结果，该漏洞利用的有效性较高。漏洞库信息和搜索结果都确认了该漏洞的存在和可利用性。\n\n**投毒风险:** `infect.py` 中包含从 `raw.githubusercontent.com/presentdaypresenttime/shai_hulud/main/woot.sh` 下载并执行脚本的代码，该脚本内容未知，存在潜在的投毒风险，攻击者可以通过修改 `woot.sh` 的内容植入恶意代码。因此，投毒风险评估为10%。\n\n**利用方式:** 漏洞利用的步骤如下：\n1. 使用 nmap 扫描局域网，发现运行 OpenSMTPD 服务的服务器。\n2. 连接到目标服务器的 25 端口。\n3. 发送 HELO 命令建立连接。\n4. 发送包含恶意命令的 MAIL FROM 命令，利用 shell 注入漏洞执行命令。\n5. 发送 RCPT TO, DATA 命令模拟邮件发送过程。\n6. 发送 QUIT 命令断开连接。

**项目地址:** [presentdaypresenttime/shai_hulud](https://github.com/presentdaypresenttime/shai_hulud)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #8

**来源**: [CVE-2020-7247-r0lh_CVE-2020-7247.md](../2020/CVE-2020-7247-r0lh_CVE-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可导致以root权限执行任意命令

**影响版本:** < 6.6.2

**利用条件:** 目标服务器运行存在漏洞的OpenSMTPD版本，且允许SMTP连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-7247 存在于 OpenSMTPD 6.6 版本中，由于在 `smtp_session.c` 文件的 `smtp_mailaddr` 函数中，对输入验证失败时返回了错误的值，导致攻击者可以通过在 `MAIL FROM` 字段中注入 shell 元字符，从而以 root 权限执行任意命令。该漏洞影响使用默认配置（未注释）的 OpenSMTPD 服务器。

**漏洞利用方式：**

1.  **连接目标SMTP服务器：** 利用代码首先尝试连接到目标 OpenSMTPD 服务器的 25 端口 (或其他指定的端口)。
2.  **发送HELO命令：**  与服务器建立 SMTP 会话。
3.  **注入恶意payload：** 在`MAIL FROM`命令中使用shell元字符，执行命令。
4.  **设置接收者：** 使用`RCPT TO`命令设置邮件接收者。
5.  **发送DATA命令：** 发送`DATA`命令，并发送包含反弹shell命令的payload。
6.  **启动监听：**  攻击者使用 `nc` 命令监听指定端口，等待目标服务器反弹 shell 连接。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用的有效性较高。POC代码已经公开，并且多个来源证实可以通过`MAIL FROM`注入执行任意命令。

**投毒风险：**

POC代码主要是利用 OpenSMTPD 漏洞实现反弹 shell。代码中存在设置监听端口和IP地址的操作，但这是反弹shell的必要步骤，不能直接判定为投毒。代码本身较为直接，没有发现明显的恶意或隐藏行为。投毒风险极小，但需要评估代码执行的payload，风险评估约为5%。


**项目地址:** [r0lh/CVE-2020-7247](https://github.com/r0lh/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #9

**来源**: [CVE-2020-7247-superzerosec_cve-2020-7247.md](../2020/CVE-2020-7247-superzerosec_cve-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致完全控制受影响的服务器

**影响版本:** < 6.6.2

**利用条件:** 需要目标服务器运行OpenSMTPD服务，且配置为默认的未注释配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 存在于OpenSMTPD 6.6.2之前的版本中。攻击者可以通过在`MAIL FROM`字段中注入shell元字符，利用SMTP会话执行任意系统命令，获得root权限。漏洞的根本原因是程序没有充分过滤用户可控的输入。

**有效性:** 提供的POC代码（poc1.py）看起来是有效的。它使用`pwn`库来建立与目标SMTP服务器的连接，并发送一系列SMTP命令，其中`MAIL FROM`命令包含恶意shell代码。如果目标服务器存在漏洞，这段代码将执行任意命令。

**投毒风险:**  POC代码主要目的是利用该漏洞，实现远程命令执行。其中值得关注的点：

*   **使用mkfifo创建管道:** 代码使用`mkfifo`创建一个命名管道`/tmp/nnwo`，然后使用`nc`将命令发送到该管道，并通过`/bin/sh`执行，最后将结果重定向到该管道，并将错误信息也重定向。这个过程本身是为了建立一个反向shell。
*   **清除痕迹:** 代码尝试在攻击完成后通过`pkill nc`清除网络连接的痕迹。


以下情况可以视为潜在的投毒代码风险：

* **恶意payload替换：** POC中可以使用更具破坏性的命令，例如删除关键系统文件或者植入长期后门程序。
* **后门植入：**  虽然`pkill nc`试图清除痕迹，但更隐蔽的后门可能被安装，以便后续访问。

综合考虑，该POC主要是为了验证漏洞的存在并执行命令。但是，因为执行了网络连接和创建管道等操作，存在一定被滥用和修改为更具恶意目的的可能性。 因此，将其判定为有 **10%** 的投毒风险。

**利用方式:**

1.  **建立SMTP连接:** 使用`pwn`库与目标OpenSMTPD服务器建立TCP连接。
2.  **发送SMTP命令序列:** 发送`HELO`、`MAIL FROM`、`RCPT TO`和`DATA`等SMTP命令。
3.  **注入恶意代码:** 在`MAIL FROM`命令中，通过注入shell元字符，构造恶意shell命令。例如，``MAIL FROM:<;for i in r j A F L X;do read;done;sh;exit 0;>``
4.  **发送Payload:** 在`DATA`命令之后，发送实际要执行的命令。POC中使用`mkfifo`和`nc`来建立反向shell连接。
5.  **监听反向Shell:** 攻击者在本地主机上使用`nc`监听指定的端口，等待目标服务器建立连接，从而获得shell访问权限。
6.  **清理痕迹:** 攻击完成后，尝试清除在目标系统上留下的痕迹（如通过`pkill nc`杀死nc进程）。

**项目地址:** [superzerosec/cve-2020-7247](https://github.com/superzerosec/cve-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---



---

## POC #4

**来源**: [CVE-2020-7247-bytescrappers_CVE-2020-7247.md](../2020/CVE-2020-7247-bytescrappers_CVE-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，允许远程攻击者以root权限执行任意命令

**影响版本:** 6.6

**利用条件:** 目标系统运行存在漏洞的OpenSMTPD 6.6，并且配置为默认的“uncommented”配置，允许未授权的SMTP连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 smtp_session.c 文件中的 smtp_mailaddr 函数中。攻击者可以通过在 MAIL FROM 字段中注入 shell 元字符，利用不正确的输入验证返回值来执行任意命令，从而实现远程代码执行。根据提供的POC代码，攻击者首先建立与目标SMTP服务器的连接，然后发送 HELO 命令，接着发送包含恶意 shell 命令的 MAIL FROM 命令，该命令利用了漏洞。然后发送 RCPT TO、DATA 命令，再发送包含一段特殊格式的payload, 最后发送 QUIT 命令结束会话。漏洞利用的关键在于MAIL FROM命令中的shell命令注入，利用 OpenSMTPD 未正确处理的漏洞点，执行任意命令。因为漏洞利用代码中的payload部分是接受命令行的参数，没有发现额外的后门代码，所以判定投毒风险为0%。搜索引擎结果确认该漏洞的存在，并指出利用该漏洞可以执行任意shell命令。

**项目地址:** [bytescrappers/CVE-2020-7247](https://github.com/bytescrappers/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #5

**来源**: [CVE-2020-7247-f4T1H21_CVE-2020-7247.md](../2020/CVE-2020-7247-f4T1H21_CVE-2020-7247.md)

## CVE-2020-7247 OpenSMTPD 远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，允许远程攻击者以root权限执行任意命令

**影响版本:** 6.6

**利用条件:** 目标服务器运行受影响版本的OpenSMTPD，并且使用默认配置（未注释）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 `smtp_session.c` 文件中的 `smtp_mailaddr` 函数中。由于对输入验证的错误处理，远程攻击者可以通过构造包含 shell 元字符的 `MAIL FROM` 字段的 SMTP 会话来执行任意命令。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在公开可用的漏洞利用代码。 因此,提供的漏洞利用代码有效。

**投毒风险：** 提供的漏洞利用代码只包含 GNU GPL v3 许可协议的内容，没有发现恶意代码或后门，因此可以判断不存在投毒风险。投毒风险为0%。

**利用方式：**

1.  攻击者与目标 OpenSMTPD 服务器建立 SMTP 连接。
2.  攻击者在 `MAIL FROM` 命令中插入包含 shell 元字符的恶意命令。例如：`MAIL FROM:<;touch /tmp/vuln;>`。
3.  OpenSMTPD 在处理 `MAIL FROM` 地址时，由于输入验证不当，会将恶意命令传递给 shell 执行，从而导致远程命令执行。
4. 攻击者可以利用此漏洞以 root 权限在目标服务器上执行任意命令。

**项目地址:** [f4T1H21/CVE-2020-7247](https://github.com/f4T1H21/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #6

**来源**: [CVE-2020-7247-minhluannguyen_CVE-2020-7247-reproducer.md](../2020/CVE-2020-7247-minhluannguyen_CVE-2020-7247-reproducer.md)

## CVE-2020-7247-OpenSMTPD-RCE

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 6.6

**利用条件:** OpenSMTPD 6.6默认配置，未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247是一个存在于OpenSMTPD 6.6的远程代码执行漏洞。该漏洞位于`smtp_session.c`中的`smtp_mailaddr`函数，由于输入验证不当，允许远程攻击者通过精心构造的SMTP会话，在`MAIL FROM`字段中注入shell元字符，从而以root权限执行任意命令。默认配置下，OpenSMTPD会错误地处理包含shell元字符的`MAIL FROM`地址。攻击者利用点在于`MAIL FROM`参数，通过注入恶意的shell命令，造成远程代码执行。

**有效性评估：**

提供的漏洞利用代码似乎有效。`exploit.py`脚本通过socket连接到目标OpenSMTPD服务器，发送HELO、MAIL FROM、RCPT TO和DATA等SMTP命令，在`MAIL FROM`命令中包含了payload，该payload试图执行反弹shell。Docker文件用于搭建存在漏洞的OpenSMTPD环境，便于验证。

**投毒风险评估：**

经过分析，此仓库中存在作者隐藏的投毒代码可能性较低，约占10%。主要依据如下：
1. `exploit.py`明确地展示了利用payload进行反弹shell，行为明确。
2. Dockerfile 拉取了指定的debian版本，降低了被投毒的可能，同时Dockerfile指定快照源，降低了通过依赖引入投毒的风险。
3. Nix 文件 只是dockerfile的另外一种描述方式，目的是为了构建docker镜像，与投毒无关。

但仍然存在一定的投毒可能：
1. 在`exploit.py`的payload中，攻击者可能会通过某种方式尝试上传或修改服务器上的其他文件，或者运行一些隐蔽的恶意命令，这种行为没有在POC里清晰展示。
2. 其他配置文件中可能存在隐藏的后门或者配置缺陷，不过可能性较低。

**利用方式：**

1.  攻击者首先需要与目标OpenSMTPD服务器建立SMTP连接（端口25）。
2.  发送`HELO`命令进行握手。
3.  关键步骤：发送`MAIL FROM`命令，并在邮件地址中插入shell元字符和恶意命令。例如：`MAIL FROM:<;恶意命令;>`
4.  发送`RCPT TO`命令指定收件人。
5.  发送`DATA`命令，并发送邮件内容（可以为空）。
6.  服务器在处理`MAIL FROM`地址时，由于漏洞，会执行注入的shell命令。
7.  攻击者通过监听指定端口，接收反弹shell，从而获得目标服务器的root权限。

总结：该漏洞利用难度较低，只需要构造特定的SMTP会话，即可触发远程代码执行。

**项目地址:** [minhluannguyen/CVE-2020-7247-reproducer](https://github.com/minhluannguyen/CVE-2020-7247-reproducer)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #7

**来源**: [CVE-2020-7247-presentdaypresenttime_shai_hulud.md](../2020/CVE-2020-7247-presentdaypresenttime_shai_hulud.md)

## CVE-2020-7247 - OpenSMTPD 远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 6.6

**利用条件:** 目标服务器运行OpenSMTPD 6.6版本，且使用未注释的默认配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 smtp_session.c 文件中的 smtp_mailaddr 函数中。由于输入验证不正确，远程攻击者可以通过构造包含 shell 元字符的 MAIL FROM 字段的 SMTP 会话，以 root 权限执行任意命令。提供的漏洞利用代码 (infect.py) 尝试利用此漏洞。该代码首先使用 nmap 扫描局域网以发现潜在的 OpenSMTPD 服务器，然后尝试连接到这些服务器并在 MAIL FROM 字段中注入命令。漏洞利用脚本尝试下载并执行 `woot.sh` 脚本，这个脚本的功能未知，存在潜在的投毒风险。 docker-compose.yml 脚本配置了多个 OpenSMTPD 实例，用于搭建测试环境。\n\n**有效性:** 根据漏洞信息和搜索引擎结果，该漏洞利用的有效性较高。漏洞库信息和搜索结果都确认了该漏洞的存在和可利用性。\n\n**投毒风险:** `infect.py` 中包含从 `raw.githubusercontent.com/presentdaypresenttime/shai_hulud/main/woot.sh` 下载并执行脚本的代码，该脚本内容未知，存在潜在的投毒风险，攻击者可以通过修改 `woot.sh` 的内容植入恶意代码。因此，投毒风险评估为10%。\n\n**利用方式:** 漏洞利用的步骤如下：\n1. 使用 nmap 扫描局域网，发现运行 OpenSMTPD 服务的服务器。\n2. 连接到目标服务器的 25 端口。\n3. 发送 HELO 命令建立连接。\n4. 发送包含恶意命令的 MAIL FROM 命令，利用 shell 注入漏洞执行命令。\n5. 发送 RCPT TO, DATA 命令模拟邮件发送过程。\n6. 发送 QUIT 命令断开连接。

**项目地址:** [presentdaypresenttime/shai_hulud](https://github.com/presentdaypresenttime/shai_hulud)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #8

**来源**: [CVE-2020-7247-r0lh_CVE-2020-7247.md](../2020/CVE-2020-7247-r0lh_CVE-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可导致以root权限执行任意命令

**影响版本:** < 6.6.2

**利用条件:** 目标服务器运行存在漏洞的OpenSMTPD版本，且允许SMTP连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-7247 存在于 OpenSMTPD 6.6 版本中，由于在 `smtp_session.c` 文件的 `smtp_mailaddr` 函数中，对输入验证失败时返回了错误的值，导致攻击者可以通过在 `MAIL FROM` 字段中注入 shell 元字符，从而以 root 权限执行任意命令。该漏洞影响使用默认配置（未注释）的 OpenSMTPD 服务器。

**漏洞利用方式：**

1.  **连接目标SMTP服务器：** 利用代码首先尝试连接到目标 OpenSMTPD 服务器的 25 端口 (或其他指定的端口)。
2.  **发送HELO命令：**  与服务器建立 SMTP 会话。
3.  **注入恶意payload：** 在`MAIL FROM`命令中使用shell元字符，执行命令。
4.  **设置接收者：** 使用`RCPT TO`命令设置邮件接收者。
5.  **发送DATA命令：** 发送`DATA`命令，并发送包含反弹shell命令的payload。
6.  **启动监听：**  攻击者使用 `nc` 命令监听指定端口，等待目标服务器反弹 shell 连接。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用的有效性较高。POC代码已经公开，并且多个来源证实可以通过`MAIL FROM`注入执行任意命令。

**投毒风险：**

POC代码主要是利用 OpenSMTPD 漏洞实现反弹 shell。代码中存在设置监听端口和IP地址的操作，但这是反弹shell的必要步骤，不能直接判定为投毒。代码本身较为直接，没有发现明显的恶意或隐藏行为。投毒风险极小，但需要评估代码执行的payload，风险评估约为5%。


**项目地址:** [r0lh/CVE-2020-7247](https://github.com/r0lh/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

## POC #9

**来源**: [CVE-2020-7247-superzerosec_cve-2020-7247.md](../2020/CVE-2020-7247-superzerosec_cve-2020-7247.md)

## CVE-2020-7247-OpenSMTPD-远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致完全控制受影响的服务器

**影响版本:** < 6.6.2

**利用条件:** 需要目标服务器运行OpenSMTPD服务，且配置为默认的未注释配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 存在于OpenSMTPD 6.6.2之前的版本中。攻击者可以通过在`MAIL FROM`字段中注入shell元字符，利用SMTP会话执行任意系统命令，获得root权限。漏洞的根本原因是程序没有充分过滤用户可控的输入。

**有效性:** 提供的POC代码（poc1.py）看起来是有效的。它使用`pwn`库来建立与目标SMTP服务器的连接，并发送一系列SMTP命令，其中`MAIL FROM`命令包含恶意shell代码。如果目标服务器存在漏洞，这段代码将执行任意命令。

**投毒风险:**  POC代码主要目的是利用该漏洞，实现远程命令执行。其中值得关注的点：

*   **使用mkfifo创建管道:** 代码使用`mkfifo`创建一个命名管道`/tmp/nnwo`，然后使用`nc`将命令发送到该管道，并通过`/bin/sh`执行，最后将结果重定向到该管道，并将错误信息也重定向。这个过程本身是为了建立一个反向shell。
*   **清除痕迹:** 代码尝试在攻击完成后通过`pkill nc`清除网络连接的痕迹。


以下情况可以视为潜在的投毒代码风险：

* **恶意payload替换：** POC中可以使用更具破坏性的命令，例如删除关键系统文件或者植入长期后门程序。
* **后门植入：**  虽然`pkill nc`试图清除痕迹，但更隐蔽的后门可能被安装，以便后续访问。

综合考虑，该POC主要是为了验证漏洞的存在并执行命令。但是，因为执行了网络连接和创建管道等操作，存在一定被滥用和修改为更具恶意目的的可能性。 因此，将其判定为有 **10%** 的投毒风险。

**利用方式:**

1.  **建立SMTP连接:** 使用`pwn`库与目标OpenSMTPD服务器建立TCP连接。
2.  **发送SMTP命令序列:** 发送`HELO`、`MAIL FROM`、`RCPT TO`和`DATA`等SMTP命令。
3.  **注入恶意代码:** 在`MAIL FROM`命令中，通过注入shell元字符，构造恶意shell命令。例如，``MAIL FROM:<;for i in r j A F L X;do read;done;sh;exit 0;>``
4.  **发送Payload:** 在`DATA`命令之后，发送实际要执行的命令。POC中使用`mkfifo`和`nc`来建立反向shell连接。
5.  **监听反向Shell:** 攻击者在本地主机上使用`nc`监听指定的端口，等待目标服务器建立连接，从而获得shell访问权限。
6.  **清理痕迹:** 攻击完成后，尝试清除在目标系统上留下的痕迹（如通过`pkill nc`杀死nc进程）。

**项目地址:** [superzerosec/cve-2020-7247](https://github.com/superzerosec/cve-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)

---

