## CVE-2020-0796 - Microsoft Windows 10 & Windows Server RCE/DoS/LPE

**漏洞编号:** CVE-2020-0796

**漏洞类型:** RCE/DoS/LPE

**影响应用:** Microsoft Windows 10 & Windows Server

**危害等级:** 紧急 (Critical)

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Windows 10 Version 1903, 1909; Windows Server Version 1903, 1909

**利用条件:** 目标开启SMBv3协议（445端口），且启用了数据压缩功能（默认开启）

**POC 可用性:** 4/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：本提供的Python代码是一个针对CVE-2020-0796（SMBGhost）的拒绝服务（DoS）概念验证脚本。该漏洞的核心在于Srv2.sys驱动程序处理SMBv3压缩数据包时的整数溢出。代码通过构造一个带有特定Magic头（0xFC534D42）的SMBv3压缩包，并将OriginalSize设置为0，同时填充大量无效数据来触发目标系统的内存处理错误。经过分析，此POC主要用于验证崩溃触发（BSOD），而非实现完整的远程代码执行（RCE）或本地提权（LPE）。在测试环境中，向受影响的Windows 10 1903/1909版本发送此数据包，由于内核在计算缓冲区大小时发生溢出，会导致系统内核崩溃。虽然它不能直接获取权限，但其有效性足以证明目标系统是否存在该高危漏洞的协议处理缺陷。利用步骤：1. 确认目标IP地址及445端口开放情况。2. 运行Python环境，准备socket与struct标准库。3. 执行脚本并输入目标IP。4. 脚本构建恶意压缩头：Magic=b'\xFCSMB'，Flags=0x00001000（标识压缩）。5. 发送数据包至目标，观察目标系统是否出现蓝屏或死机。投毒风险分析：该POC代码逻辑极其简单，完全依赖Python标准库（socket和struct），未引用任何外部第三方库或混淆脚本。代码结构透明，所有字节序列构造均明文展示，不存在隐藏的shellcode下载、反弹连接或其他恶意后门行为。唯一的潜在风险在于攻击者可能将其集成到自动化扫描器中进行无差别拒绝服务攻击。从源码角度看，该版本被标记为'Safe version'，其目的仅在于引发内核异常而非静默控制。在供应链安全层面，该代码库无外部依赖，不存在依赖包投毒风险。由于不涉及编译二进制文件，也排除了在编译阶段植入恶意代码的可能性。因此，该POC在安全研究环境下的投毒风险极低，属于典型的教育与验证用途脚本。

**项目地址:** [https://github.com/Rvn0xsy/CVE_2020_0796_CNA](https://github.com/Rvn0xsy/CVE_2020_0796_CNA)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2020-0796](https://nvd.nist.gov/vuln/detail/CVE-2020-0796)
