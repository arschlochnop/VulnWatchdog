## CVE-2020-0610 - Windows Remote Desktop Gateway RCE

**漏洞编号:** CVE-2020-0610

**漏洞类型:** RCE

**影响应用:** Windows Remote Desktop Gateway

**危害等级:** 超危

**CVSS评分:** N/A

**影响版本:** 受影响版本范围未知，但Windows Server 2012受影响

**利用条件:** 预认证，需要网络访问

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 30%

## 详情

CVE-2020-0610是一个Windows远程桌面网关（RD Gateway）中的远程代码执行漏洞。攻击者可以利用此漏洞在目标系统上执行任意代码。该漏洞存在于RD Gateway处理请求的方式中，允许未经身份验证的攻击者通过发送特制的请求来触发漏洞。根据搜索结果，该漏洞不需要用户交互，可以在不需要用户干预的情况下远程执行任意代码。漏洞利用通常涉及构造恶意的RDP连接请求，这些请求在RD Gateway服务器上处理不当，从而允许攻击者执行代码。

POC代码分析：提供的POC代码（lab-cve-2020-0610）是一个学习项目，旨在帮助用户理解CVE-2020-0610漏洞。它包含PowerShell脚本和Nuclei模板，用于验证漏洞。该项目提供了一个清晰的设置指南，并包含了用于测试的PowerShell脚本，使得用户可以相对容易地重现和理解该漏洞。根据README.md描述，该POC需要Windows 10或更高版本的操作系统，以及PowerShell环境。用户需要下载并解压POC代码，然后运行提供的PowerShell脚本。脚本会尝试利用RD Gateway的漏洞来执行代码。

利用步骤：
1. 下载并解压POC代码。
2. 运行提供的PowerShell脚本。
3. 按照设置指南配置测试环境。
4. 观察脚本执行结果，验证漏洞是否存在。

投毒风险分析：该POC的投毒风险中等。主要风险点在于PowerShell脚本可能包含恶意代码。虽然该项目旨在教育目的，但攻击者可能会修改这些脚本以包含恶意负载。此外，POC代码中涉及从外部URL下载文件，这增加了代码被篡改的风险。Nuclei模板本身风险较低，因为它们主要用于漏洞扫描和验证，但如果Nuclei配置不当或使用了恶意的Nuclei模板，也可能导致信息泄露或拒绝服务攻击。由于POC包含PowerShell脚本，存在一定的代码混淆的可能性，攻击者可能利用这一点来隐藏恶意代码。总体而言，投毒风险评估为30%，属于中等风险，需要谨慎使用，尤其是在生产环境中。

**项目地址:** https://raw.githubusercontent.com/Riocipta75/lab-cve-2020-0610/master/unallured/lab-cve-2020-0610.zip

**漏洞详情:** https://portal.msrc.microsoft.com/zh-CN/security-guidance/advisory/CVE-2020-0610
