# CVE-2020-1472

> 📦 该CVE有 **31** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-1472-100HnoMeuNome_ZeroLogon-CVE-2020-1472-lab.md](../2020/CVE-2020-1472-100HnoMeuNome_ZeroLogon-CVE-2020-1472-lab.md)

## CVE-2020-1472 Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Netlogon Remote Protocol (MS-NRPC)

**危害等级:** 高危，可能导致域管理员权限提升

**影响版本:** 受影响的Windows Server版本：2008 R2, 2012 / 2012 R2, 2016, 2019，以及2020年8月/9月补丁之前的版本

**利用条件:** 需要位于网络内部，能够与域控制器通信

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Microsoft Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。未经身份验证的攻击者可以通过网络连接到域控制器，并利用该漏洞获取域管理员权限。 

**有效性分析：**
根据搜索结果，该漏洞利用的POC代码已经公开（例如packetstormsecurity.com上的POC）。漏洞库信息也表明该漏洞已被积极利用（`Exploitation: active` in CISA ADP Vulnrichment），所以提供的POC代码大概率是有效的。

**投毒风险分析：**
提供的漏洞利用代码实际上是一个`README.md`文件，该文件仅包含漏洞的描述、利用说明、缓解措施和参考链接。该文件本身不包含任何可执行代码，因此直接的投毒风险较低。但是，参考链接指向的POC代码，可能存在被篡改的风险，间接存在一定的投毒可能。考虑到该仓库只是一个说明文档，实际的漏洞利用需要用户自行下载其他POC代码，因此判定投毒风险为10%。

**利用方式分析：**
1.  **漏洞原理：** 漏洞利用了Netlogon协议中的一个加密缺陷，攻击者可以将Netlogon会话的客户端凭据设置为全零。
2.  **攻击步骤：**
    *   攻击者通过MS-NRPC与域控制器建立连接。
    *   利用漏洞将域控制器的机器帐户密码置零。
    *   使用置零后的密码更改域控制器的机器帐户密码。
    *   通过修改后的机器帐户密码获得域管理员权限。
3. **修复方式：** 安装Microsoft发布的更新补丁，并按照Microsoft的指南进行配置，以强制执行安全的Netlogon通道。

**项目地址:** [100HnoMeuNome/ZeroLogon-CVE-2020-1472-lab](https://github.com/100HnoMeuNome/ZeroLogon-CVE-2020-1472-lab)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #2

**来源**: [CVE-2020-1472-Akash7350_CVE-2020-1472.md](../2020/CVE-2020-1472-Akash7350_CVE-2020-1472.md)

## CVE-2020-1472-Zerologon-特权提升

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本，详见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个影响Microsoft Windows Netlogon Remote Protocol (MS-NRPC) 的特权提升漏洞。未经身份验证的攻击者可以通过与域控制器建立脆弱的Netlogon安全通道连接来利用此漏洞。成功利用该漏洞可能允许攻击者冒充域控制器，并最终获得域管理员权限，从而完全控制整个域。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，此POC代码是有效的。搜索结果中多个链接指向了关于该漏洞的分析和利用文章，证明了该漏洞的可利用性。POC代码描述也表明，它能够重置域控制器的帐户密码为空字符串，从而实现权限提升。

**投毒风险：**
评估POC代码的投毒风险较低，大约为10%。代码主要逻辑集中在利用Netlogon协议的加密缺陷，通过重复的认证尝试来绕过身份验证。虽然存在一定的风险，例如代码的维护者可能在未来版本中引入恶意代码，或者安装过程中依赖的第三方库存在安全问题，但从当前提供的代码来看，直接包含恶意、后门代码的可能性不大。该代码更侧重于漏洞利用的验证和概念证明。

**利用方式：**
1.  **建立连接：** 攻击者使用MS-NRPC协议与目标域控制器建立网络连接。
2.  **零化凭据：** 攻击者发送一个包含全零凭据的Netlogon身份验证请求。
3.  **重复尝试：** 由于协议的加密缺陷，攻击者重复发送此请求多次。每次尝试都有可能成功绕过身份验证。
4.  **密码重置：** 成功绕过身份验证后，攻击者将域控制器的帐户密码重置为空字符串。
5.  **权限提升：** 此时，攻击者可以利用空密码来冒充域控制器并获取域管理员权限。

需要注意的是，成功利用此漏洞需要目标域控制器未安装相应的安全补丁。此外，利用该漏洞可能会导致域环境不稳定甚至崩溃，因此在生产环境中进行测试需要谨慎。

**项目地址:** [Akash7350/CVE-2020-1472](https://github.com/Akash7350/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #3

**来源**: [CVE-2020-1472-Anonymous-Family_CVE-2020-1472.md](../2020/CVE-2020-1472-Anonymous-Family_CVE-2020-1472.md)

## CVE-2020-1472 Zerologon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本见漏洞库信息

**利用条件:** 需要位于目标域控制器的网络中

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-1472（Zerologon）是一个存在于Windows Server Netlogon Remote Protocol (MS-NRPC) 中的特权提升漏洞。攻击者通过与域控制器建立脆弱的Netlogon安全通道连接，可以运行特制的应用程序并获取域管理员权限。

**有效性分析：**

提供的POC代码 `zerologon_tester.py` 旨在检测目标域控制器是否存在Zerologon漏洞。该脚本通过尝试使用全零的challenge和credential来进行Netlogon身份验证绕过。如果域控制器存在漏洞，则身份验证将成功，脚本会立即终止。如果域控制器已打补丁，脚本会在多次尝试后放弃并认为目标不存在漏洞（存在极低的假阴性概率）。根据搜索引擎结果，该漏洞利用代码的思路和方法与公开的漏洞利用方式一致，因此判断提供的POC代码是有效的。

**投毒风险分析：**

通过对Dockerfile，requirements.txt和zerologon_tester.py的代码分析，该仓库主要包含漏洞利用的测试代码和依赖项，未发现明显的恶意代码或后门，代码的功能主要是实现对Zerologon漏洞的检测,因此投毒风险较低。

**利用方式：**

1.  **漏洞利用阶段：** 攻击者首先需要与目标域控制器建立网络连接。然后，攻击者运行Zerologon漏洞利用脚本（例如提供的`zerologon_tester.py`的修改版本），该脚本通过MS-NRPC协议发送特制的身份验证请求，利用加密算法中的漏洞将域控制器的机器帐户密码置零。
2.  **权限提升阶段：** 成功将域控制器的机器帐户密码置零后，攻击者可以使用该零密码来获得域控制器的身份验证，从而完全控制域。
3.  **持久化和横向移动（可选）：** 攻击者获得域管理员权限后，可以进行持久化操作（例如创建新的管理员帐户）并在域内进行横向移动，以控制更多系统和数据。

**项目地址:** [Anonymous-Family/CVE-2020-1472](https://github.com/Anonymous-Family/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #4

**来源**: [CVE-2020-1472-Anonymous-Family_Zero-day-scanning.md](../2020/CVE-2020-1472-Anonymous-Family_Zero-day-scanning.md)

## CVE-2020-1472 Zerologon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本，详见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

Zerologon (CVE-2020-1472) 是一个严重的权限提升漏洞，存在于 Netlogon Remote Protocol (MS-NRPC) 中。未经身份验证的攻击者可以通过建立与域控制器的脆弱 Netlogon 安全通道连接来利用此漏洞。攻击成功后，攻击者可以运行特制的应用程序，从而完全控制域控制器。 

**利用方式：**

1.  **利用MS-NRPC协议：** 攻击者利用 MS-NRPC 协议连接到域控制器。
2.  **重置域控制器的密码：** 攻击者通过将域控制器的计算机密码设置为已知值（通常是空值），从而破坏身份验证过程。
3.  **获取域管理员权限：** 密码重置后，攻击者可以冒充域控制器并获取域管理员权限。

**有效性：**

提供的漏洞利用代码 (zeroscan) 本身是一个扫描器，用于检测目标域控制器是否存在 Zerologon 漏洞、MS-PAR/MS-RPRN 协议是否暴露以及 SMBv2 签名配置。它**不**尝试实际利用该漏洞，但是它使用基于已知的POC修改的代码库来检查漏洞，因此可以判断存在可利用性。

**投毒风险：**

分析提供的代码，投毒风险较低，但不能完全排除。理由如下：

*   **开源代码：** 代码托管在 GitHub 上，具有一定的透明度，更容易受到社区审查。
*   **扫描器功能：** 该工具主要功能是扫描，而非直接利用，因此隐藏恶意代码的动机相对较低。
*   **依赖第三方库：** 代码依赖于 Impacket 和 Nmap 等第三方库，攻击者可能尝试利用这些依赖项中的漏洞进行投毒攻击。但是，直接在zeroscan本身投毒的概率较低。
*  **POC的免责声明：**  `Codebase borrowed from: https://github.com/Anonymous-Family/CVE-2020-1472.git` 声明中，代码借鉴了其他库,存在一定的代码风险.

因此，尽管直接在 zeroscan 代码中植入后门的概率较低（假设为5%），但仍需谨慎使用，并仔细审查代码及所依赖的第三方库。


**项目地址:** [Anonymous-Family/Zero-day-scanning](https://github.com/Anonymous-Family/Zero-day-scanning)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #5

**来源**: [CVE-2020-1472-B34MR_zeroscan.md](../2020/CVE-2020-1472-B34MR_zeroscan.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获得域管理员权限。

**影响版本:** 受影响的Windows Server版本包括2008 R2到20H2等多个版本，具体版本请参考漏洞库信息。

**利用条件:** 攻击者需要与域控制器建立网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server的Netlogon协议中。攻击者可以通过将Netlogon客户端使用的身份验证凭据中的多个零值设置为全零来利用此漏洞。如果攻击成功，攻击者可以冒充域控制器上的任何计算机（包括域控制器本身），并获得域管理员权限。

**有效性：**
根据漏洞信息和搜索结果，该漏洞POC是有效的，并且已经被广泛利用。

**投毒风险：**
提供的代码（zeroscan）描述中明确声明它是一个漏洞扫描器，而不是漏洞利用工具，并且专门指出它不尝试利用Zerologon漏洞，只是检查是否存在漏洞。代码库借鉴自SecuraBV的CVE-2020-1472检查脚本。虽然zeroscan本身声明不进行利用，但它依赖于其他工具和脚本，这些依赖项可能存在潜在的风险。此外，代码中可能存在作者有意或无意引入的缺陷或后门。考虑到zeroscan的性质，以及它wrapper Impacket等工具，我们无法完全排除投毒的可能性。因此，存在一定比例的投毒风险。 

**利用方式：**

1.  攻击者使用MS-NRPC协议与域控制器建立连接。
2.  攻击者发送特制的身份验证请求，将Netlogon客户端凭据设置为零。
3.  由于Netlogon协议的缺陷，域控制器错误地接受了零凭据，从而允许攻击者通过身份验证。
4.  攻击者现在可以冒充域控制器并执行恶意操作，例如更改域管理员密码或部署恶意软件。
5. 通过rpcdump可以检测MS-PAR/MS-RPRN服务是否开启，为进一步攻击提供信息。
6. 通过检测SMB signing配置，决定后续横向移动的策略。


**项目地址:** [B34MR/zeroscan](https://github.com/B34MR/zeroscan)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #6

**来源**: [CVE-2020-1472-CPO-EH_CVE-2020-1472_ZeroLogonChecker.md](../2020/CVE-2020-1472-CPO-EH_CVE-2020-1472_ZeroLogonChecker.md)

## CVE-2020-1472 (Zerologon) 漏洞检测

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本，具体请参考漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个Windows Netlogon协议中的严重漏洞，允许未经身份验证的攻击者通过MS-NRPC协议连接到域控制器，重置域控制器的机器帐户密码为空，从而获取域管理员权限。提供的漏洞利用代码是一个C#程序，用于**检测**目标域控制器是否存在此漏洞，**并非真正的漏洞利用代码**。该代码通过尝试与目标域控制器建立Netlogon安全通道并执行身份验证来检测漏洞。由于代码本身是漏洞**检测**工具，并非直接进行提权，因此**投毒风险较低**，主要体现在可能被修改为发送大量探测流量进行拒绝服务攻击，或者收集目标服务器信息的可能。代码片段不完整，只能推断出实现逻辑，但未看到恶意代码，初步认为投毒风险概率为10%。

**利用方式：**

1.  攻击者利用MS-NRPC协议的加密缺陷，向域控制器发送一系列特制的Netlogon请求。
2.  这些请求将导致域控制器的机器帐户密码被重置为空字符串。
3.  攻击者随后可以使用空密码来冒充域控制器，并执行各种恶意操作，例如添加新的域管理员帐户或修改现有帐户的权限。

**有效性：**

由于提供的代码是漏洞检测工具，并非漏洞利用工具，所以**有效性体现在能否准确检测出目标是否存在漏洞**。根据漏洞库信息和搜索结果，该漏洞影响多个版本的Windows Server，攻击影响极大。

**参考链接：**
*   https://www.crowdstrike.com/en-us/blog/cve-2020-1472-zerologon-security-advisory/
*   https://msrc.microsoft.com/blog/2020/10/attacks-exploiting-netlogon-vulnerability-cve-2020-1472/
*   https://nvd.nist.gov/vuln/detail/cve-2020-1472

**项目地址:** [CPO-EH/CVE-2020-1472_ZeroLogonChecker](https://github.com/CPO-EH/CVE-2020-1472_ZeroLogonChecker)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #7

**来源**: [CVE-2020-1472-Fa1c0n35_CVE-2020-1472-02-.md](../2020/CVE-2020-1472-Fa1c0n35_CVE-2020-1472-02-.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，可导致域管理员权限被获取

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与域控制器的网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个Windows Netlogon协议中的权限提升漏洞。攻击者可以通过建立一个到域控制器的脆弱的Netlogon安全通道连接来利用此漏洞。漏洞利用代码通过将Netlogon会话密钥重置为零，从而绕过身份验证。提供的`zerologon_tester.py`脚本用于检测目标域控制器是否存在此漏洞。脚本尝试使用全零的challenge和credential进行身份验证。如果成功，则表明目标存在漏洞。虽然脚本的主要目的是测试漏洞是否存在，但潜在的投毒风险在于，攻击者可能修改该脚本以在成功利用漏洞后执行恶意操作，例如安装后门或收集敏感信息。要求Python 3.7或更高版本，以及`requirements.txt`中列出的依赖项。脚本通过`pip install -r requirements.txt`安装依赖。利用方式为：1. 运行`zerologon_tester.py`脚本，指定目标域控制器的NetBIOS名称和IP地址。2. 脚本尝试使用零密钥进行身份验证。3. 如果身份验证成功，脚本会立即终止，表明目标易受攻击。根据漏洞描述，成功利用此漏洞可能允许未经身份验证的攻击者获得域管理员权限，从而完全控制域。

**投毒风险分析：**

*   **README.md:** 描述了脚本的使用方法和漏洞背景，未发现可疑代码。
*   **LICENSE:** MIT许可证，允许自由使用、修改和分发，但也增加了被修改后用于恶意目的的风险。
*   **requirements.txt:** 列出了脚本依赖的Python库。虽然这些库本身是合法的，但攻击者可能替换或篡改这些库的安装源，从而引入恶意代码。impacket库本身如果来源不明，存在一定风险。
*   **zerologon_tester.py:** 脚本的核心代码，实现了漏洞的检测和利用。虽然代码本身看起来是合法的漏洞验证代码，但是仍然存在被篡改的风险，例如添加在成功利用漏洞后执行恶意操作的代码。例如，在`try_zero_authenticate` 函数中，成功绕过身份验证后，可以添加执行任意代码的逻辑。

因此，虽然提供的代码主要是漏洞检测工具，但仍然存在一定的投毒风险。特别是需要注意impacket包的来源可靠性，以及防止`zerologon_tester.py`被篡改添加恶意逻辑。

综合考虑，判定投毒风险为10%。

**项目地址:** [Fa1c0n35/CVE-2020-1472-02-](https://github.com/Fa1c0n35/CVE-2020-1472-02-)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #8

**来源**: [CVE-2020-1472-Fa1c0n35_SecuraBV-CVE-2020-1472.md](../2020/CVE-2020-1472-Fa1c0n35_SecuraBV-CVE-2020-1472.md)

# CVE-2020-1472

> 📦 该CVE有 **31** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-1472-100HnoMeuNome_ZeroLogon-CVE-2020-1472-lab.md](../2020/CVE-2020-1472-100HnoMeuNome_ZeroLogon-CVE-2020-1472-lab.md)

## CVE-2020-1472 Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Netlogon Remote Protocol (MS-NRPC)

**危害等级:** 高危，可能导致域管理员权限提升

**影响版本:** 受影响的Windows Server版本：2008 R2, 2012 / 2012 R2, 2016, 2019，以及2020年8月/9月补丁之前的版本

**利用条件:** 需要位于网络内部，能够与域控制器通信

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Microsoft Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。未经身份验证的攻击者可以通过网络连接到域控制器，并利用该漏洞获取域管理员权限。 

**有效性分析：**
根据搜索结果，该漏洞利用的POC代码已经公开（例如packetstormsecurity.com上的POC）。漏洞库信息也表明该漏洞已被积极利用（`Exploitation: active` in CISA ADP Vulnrichment），所以提供的POC代码大概率是有效的。

**投毒风险分析：**
提供的漏洞利用代码实际上是一个`README.md`文件，该文件仅包含漏洞的描述、利用说明、缓解措施和参考链接。该文件本身不包含任何可执行代码，因此直接的投毒风险较低。但是，参考链接指向的POC代码，可能存在被篡改的风险，间接存在一定的投毒可能。考虑到该仓库只是一个说明文档，实际的漏洞利用需要用户自行下载其他POC代码，因此判定投毒风险为10%。

**利用方式分析：**
1.  **漏洞原理：** 漏洞利用了Netlogon协议中的一个加密缺陷，攻击者可以将Netlogon会话的客户端凭据设置为全零。
2.  **攻击步骤：**
    *   攻击者通过MS-NRPC与域控制器建立连接。
    *   利用漏洞将域控制器的机器帐户密码置零。
    *   使用置零后的密码更改域控制器的机器帐户密码。
    *   通过修改后的机器帐户密码获得域管理员权限。
3. **修复方式：** 安装Microsoft发布的更新补丁，并按照Microsoft的指南进行配置，以强制执行安全的Netlogon通道。

**项目地址:** [100HnoMeuNome/ZeroLogon-CVE-2020-1472-lab](https://github.com/100HnoMeuNome/ZeroLogon-CVE-2020-1472-lab)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #2

**来源**: [CVE-2020-1472-Akash7350_CVE-2020-1472.md](../2020/CVE-2020-1472-Akash7350_CVE-2020-1472.md)

## CVE-2020-1472-Zerologon-特权提升

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本，详见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个影响Microsoft Windows Netlogon Remote Protocol (MS-NRPC) 的特权提升漏洞。未经身份验证的攻击者可以通过与域控制器建立脆弱的Netlogon安全通道连接来利用此漏洞。成功利用该漏洞可能允许攻击者冒充域控制器，并最终获得域管理员权限，从而完全控制整个域。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，此POC代码是有效的。搜索结果中多个链接指向了关于该漏洞的分析和利用文章，证明了该漏洞的可利用性。POC代码描述也表明，它能够重置域控制器的帐户密码为空字符串，从而实现权限提升。

**投毒风险：**
评估POC代码的投毒风险较低，大约为10%。代码主要逻辑集中在利用Netlogon协议的加密缺陷，通过重复的认证尝试来绕过身份验证。虽然存在一定的风险，例如代码的维护者可能在未来版本中引入恶意代码，或者安装过程中依赖的第三方库存在安全问题，但从当前提供的代码来看，直接包含恶意、后门代码的可能性不大。该代码更侧重于漏洞利用的验证和概念证明。

**利用方式：**
1.  **建立连接：** 攻击者使用MS-NRPC协议与目标域控制器建立网络连接。
2.  **零化凭据：** 攻击者发送一个包含全零凭据的Netlogon身份验证请求。
3.  **重复尝试：** 由于协议的加密缺陷，攻击者重复发送此请求多次。每次尝试都有可能成功绕过身份验证。
4.  **密码重置：** 成功绕过身份验证后，攻击者将域控制器的帐户密码重置为空字符串。
5.  **权限提升：** 此时，攻击者可以利用空密码来冒充域控制器并获取域管理员权限。

需要注意的是，成功利用此漏洞需要目标域控制器未安装相应的安全补丁。此外，利用该漏洞可能会导致域环境不稳定甚至崩溃，因此在生产环境中进行测试需要谨慎。

**项目地址:** [Akash7350/CVE-2020-1472](https://github.com/Akash7350/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #3

**来源**: [CVE-2020-1472-Anonymous-Family_CVE-2020-1472.md](../2020/CVE-2020-1472-Anonymous-Family_CVE-2020-1472.md)

## CVE-2020-1472 Zerologon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本见漏洞库信息

**利用条件:** 需要位于目标域控制器的网络中

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-1472（Zerologon）是一个存在于Windows Server Netlogon Remote Protocol (MS-NRPC) 中的特权提升漏洞。攻击者通过与域控制器建立脆弱的Netlogon安全通道连接，可以运行特制的应用程序并获取域管理员权限。

**有效性分析：**

提供的POC代码 `zerologon_tester.py` 旨在检测目标域控制器是否存在Zerologon漏洞。该脚本通过尝试使用全零的challenge和credential来进行Netlogon身份验证绕过。如果域控制器存在漏洞，则身份验证将成功，脚本会立即终止。如果域控制器已打补丁，脚本会在多次尝试后放弃并认为目标不存在漏洞（存在极低的假阴性概率）。根据搜索引擎结果，该漏洞利用代码的思路和方法与公开的漏洞利用方式一致，因此判断提供的POC代码是有效的。

**投毒风险分析：**

通过对Dockerfile，requirements.txt和zerologon_tester.py的代码分析，该仓库主要包含漏洞利用的测试代码和依赖项，未发现明显的恶意代码或后门，代码的功能主要是实现对Zerologon漏洞的检测,因此投毒风险较低。

**利用方式：**

1.  **漏洞利用阶段：** 攻击者首先需要与目标域控制器建立网络连接。然后，攻击者运行Zerologon漏洞利用脚本（例如提供的`zerologon_tester.py`的修改版本），该脚本通过MS-NRPC协议发送特制的身份验证请求，利用加密算法中的漏洞将域控制器的机器帐户密码置零。
2.  **权限提升阶段：** 成功将域控制器的机器帐户密码置零后，攻击者可以使用该零密码来获得域控制器的身份验证，从而完全控制域。
3.  **持久化和横向移动（可选）：** 攻击者获得域管理员权限后，可以进行持久化操作（例如创建新的管理员帐户）并在域内进行横向移动，以控制更多系统和数据。

**项目地址:** [Anonymous-Family/CVE-2020-1472](https://github.com/Anonymous-Family/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #4

**来源**: [CVE-2020-1472-Anonymous-Family_Zero-day-scanning.md](../2020/CVE-2020-1472-Anonymous-Family_Zero-day-scanning.md)

## CVE-2020-1472 Zerologon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本，详见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

Zerologon (CVE-2020-1472) 是一个严重的权限提升漏洞，存在于 Netlogon Remote Protocol (MS-NRPC) 中。未经身份验证的攻击者可以通过建立与域控制器的脆弱 Netlogon 安全通道连接来利用此漏洞。攻击成功后，攻击者可以运行特制的应用程序，从而完全控制域控制器。 

**利用方式：**

1.  **利用MS-NRPC协议：** 攻击者利用 MS-NRPC 协议连接到域控制器。
2.  **重置域控制器的密码：** 攻击者通过将域控制器的计算机密码设置为已知值（通常是空值），从而破坏身份验证过程。
3.  **获取域管理员权限：** 密码重置后，攻击者可以冒充域控制器并获取域管理员权限。

**有效性：**

提供的漏洞利用代码 (zeroscan) 本身是一个扫描器，用于检测目标域控制器是否存在 Zerologon 漏洞、MS-PAR/MS-RPRN 协议是否暴露以及 SMBv2 签名配置。它**不**尝试实际利用该漏洞，但是它使用基于已知的POC修改的代码库来检查漏洞，因此可以判断存在可利用性。

**投毒风险：**

分析提供的代码，投毒风险较低，但不能完全排除。理由如下：

*   **开源代码：** 代码托管在 GitHub 上，具有一定的透明度，更容易受到社区审查。
*   **扫描器功能：** 该工具主要功能是扫描，而非直接利用，因此隐藏恶意代码的动机相对较低。
*   **依赖第三方库：** 代码依赖于 Impacket 和 Nmap 等第三方库，攻击者可能尝试利用这些依赖项中的漏洞进行投毒攻击。但是，直接在zeroscan本身投毒的概率较低。
*  **POC的免责声明：**  `Codebase borrowed from: https://github.com/Anonymous-Family/CVE-2020-1472.git` 声明中，代码借鉴了其他库,存在一定的代码风险.

因此，尽管直接在 zeroscan 代码中植入后门的概率较低（假设为5%），但仍需谨慎使用，并仔细审查代码及所依赖的第三方库。


**项目地址:** [Anonymous-Family/Zero-day-scanning](https://github.com/Anonymous-Family/Zero-day-scanning)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #5

**来源**: [CVE-2020-1472-B34MR_zeroscan.md](../2020/CVE-2020-1472-B34MR_zeroscan.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获得域管理员权限。

**影响版本:** 受影响的Windows Server版本包括2008 R2到20H2等多个版本，具体版本请参考漏洞库信息。

**利用条件:** 攻击者需要与域控制器建立网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server的Netlogon协议中。攻击者可以通过将Netlogon客户端使用的身份验证凭据中的多个零值设置为全零来利用此漏洞。如果攻击成功，攻击者可以冒充域控制器上的任何计算机（包括域控制器本身），并获得域管理员权限。

**有效性：**
根据漏洞信息和搜索结果，该漏洞POC是有效的，并且已经被广泛利用。

**投毒风险：**
提供的代码（zeroscan）描述中明确声明它是一个漏洞扫描器，而不是漏洞利用工具，并且专门指出它不尝试利用Zerologon漏洞，只是检查是否存在漏洞。代码库借鉴自SecuraBV的CVE-2020-1472检查脚本。虽然zeroscan本身声明不进行利用，但它依赖于其他工具和脚本，这些依赖项可能存在潜在的风险。此外，代码中可能存在作者有意或无意引入的缺陷或后门。考虑到zeroscan的性质，以及它wrapper Impacket等工具，我们无法完全排除投毒的可能性。因此，存在一定比例的投毒风险。 

**利用方式：**

1.  攻击者使用MS-NRPC协议与域控制器建立连接。
2.  攻击者发送特制的身份验证请求，将Netlogon客户端凭据设置为零。
3.  由于Netlogon协议的缺陷，域控制器错误地接受了零凭据，从而允许攻击者通过身份验证。
4.  攻击者现在可以冒充域控制器并执行恶意操作，例如更改域管理员密码或部署恶意软件。
5. 通过rpcdump可以检测MS-PAR/MS-RPRN服务是否开启，为进一步攻击提供信息。
6. 通过检测SMB signing配置，决定后续横向移动的策略。


**项目地址:** [B34MR/zeroscan](https://github.com/B34MR/zeroscan)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #6

**来源**: [CVE-2020-1472-CPO-EH_CVE-2020-1472_ZeroLogonChecker.md](../2020/CVE-2020-1472-CPO-EH_CVE-2020-1472_ZeroLogonChecker.md)

## CVE-2020-1472 (Zerologon) 漏洞检测

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本，具体请参考漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个Windows Netlogon协议中的严重漏洞，允许未经身份验证的攻击者通过MS-NRPC协议连接到域控制器，重置域控制器的机器帐户密码为空，从而获取域管理员权限。提供的漏洞利用代码是一个C#程序，用于**检测**目标域控制器是否存在此漏洞，**并非真正的漏洞利用代码**。该代码通过尝试与目标域控制器建立Netlogon安全通道并执行身份验证来检测漏洞。由于代码本身是漏洞**检测**工具，并非直接进行提权，因此**投毒风险较低**，主要体现在可能被修改为发送大量探测流量进行拒绝服务攻击，或者收集目标服务器信息的可能。代码片段不完整，只能推断出实现逻辑，但未看到恶意代码，初步认为投毒风险概率为10%。

**利用方式：**

1.  攻击者利用MS-NRPC协议的加密缺陷，向域控制器发送一系列特制的Netlogon请求。
2.  这些请求将导致域控制器的机器帐户密码被重置为空字符串。
3.  攻击者随后可以使用空密码来冒充域控制器，并执行各种恶意操作，例如添加新的域管理员帐户或修改现有帐户的权限。

**有效性：**

由于提供的代码是漏洞检测工具，并非漏洞利用工具，所以**有效性体现在能否准确检测出目标是否存在漏洞**。根据漏洞库信息和搜索结果，该漏洞影响多个版本的Windows Server，攻击影响极大。

**参考链接：**
*   https://www.crowdstrike.com/en-us/blog/cve-2020-1472-zerologon-security-advisory/
*   https://msrc.microsoft.com/blog/2020/10/attacks-exploiting-netlogon-vulnerability-cve-2020-1472/
*   https://nvd.nist.gov/vuln/detail/cve-2020-1472

**项目地址:** [CPO-EH/CVE-2020-1472_ZeroLogonChecker](https://github.com/CPO-EH/CVE-2020-1472_ZeroLogonChecker)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #7

**来源**: [CVE-2020-1472-Fa1c0n35_CVE-2020-1472-02-.md](../2020/CVE-2020-1472-Fa1c0n35_CVE-2020-1472-02-.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，可导致域管理员权限被获取

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与域控制器的网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个Windows Netlogon协议中的权限提升漏洞。攻击者可以通过建立一个到域控制器的脆弱的Netlogon安全通道连接来利用此漏洞。漏洞利用代码通过将Netlogon会话密钥重置为零，从而绕过身份验证。提供的`zerologon_tester.py`脚本用于检测目标域控制器是否存在此漏洞。脚本尝试使用全零的challenge和credential进行身份验证。如果成功，则表明目标存在漏洞。虽然脚本的主要目的是测试漏洞是否存在，但潜在的投毒风险在于，攻击者可能修改该脚本以在成功利用漏洞后执行恶意操作，例如安装后门或收集敏感信息。要求Python 3.7或更高版本，以及`requirements.txt`中列出的依赖项。脚本通过`pip install -r requirements.txt`安装依赖。利用方式为：1. 运行`zerologon_tester.py`脚本，指定目标域控制器的NetBIOS名称和IP地址。2. 脚本尝试使用零密钥进行身份验证。3. 如果身份验证成功，脚本会立即终止，表明目标易受攻击。根据漏洞描述，成功利用此漏洞可能允许未经身份验证的攻击者获得域管理员权限，从而完全控制域。

**投毒风险分析：**

*   **README.md:** 描述了脚本的使用方法和漏洞背景，未发现可疑代码。
*   **LICENSE:** MIT许可证，允许自由使用、修改和分发，但也增加了被修改后用于恶意目的的风险。
*   **requirements.txt:** 列出了脚本依赖的Python库。虽然这些库本身是合法的，但攻击者可能替换或篡改这些库的安装源，从而引入恶意代码。impacket库本身如果来源不明，存在一定风险。
*   **zerologon_tester.py:** 脚本的核心代码，实现了漏洞的检测和利用。虽然代码本身看起来是合法的漏洞验证代码，但是仍然存在被篡改的风险，例如添加在成功利用漏洞后执行恶意操作的代码。例如，在`try_zero_authenticate` 函数中，成功绕过身份验证后，可以添加执行任意代码的逻辑。

因此，虽然提供的代码主要是漏洞检测工具，但仍然存在一定的投毒风险。特别是需要注意impacket包的来源可靠性，以及防止`zerologon_tester.py`被篡改添加恶意逻辑。

综合考虑，判定投毒风险为10%。

**项目地址:** [Fa1c0n35/CVE-2020-1472-02-](https://github.com/Fa1c0n35/CVE-2020-1472-02-)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #8

**来源**: [CVE-2020-1472-Fa1c0n35_SecuraBV-CVE-2020-1472.md](../2020/CVE-2020-1472-Fa1c0n35_SecuraBV-CVE-2020-1472.md)

# CVE-2020-1472

> 📦 该CVE有 **31** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-1472-100HnoMeuNome_ZeroLogon-CVE-2020-1472-lab.md](../2020/CVE-2020-1472-100HnoMeuNome_ZeroLogon-CVE-2020-1472-lab.md)

## CVE-2020-1472 Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Netlogon Remote Protocol (MS-NRPC)

**危害等级:** 高危，可能导致域管理员权限提升

**影响版本:** 受影响的Windows Server版本：2008 R2, 2012 / 2012 R2, 2016, 2019，以及2020年8月/9月补丁之前的版本

**利用条件:** 需要位于网络内部，能够与域控制器通信

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Microsoft Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。未经身份验证的攻击者可以通过网络连接到域控制器，并利用该漏洞获取域管理员权限。 

**有效性分析：**
根据搜索结果，该漏洞利用的POC代码已经公开（例如packetstormsecurity.com上的POC）。漏洞库信息也表明该漏洞已被积极利用（`Exploitation: active` in CISA ADP Vulnrichment），所以提供的POC代码大概率是有效的。

**投毒风险分析：**
提供的漏洞利用代码实际上是一个`README.md`文件，该文件仅包含漏洞的描述、利用说明、缓解措施和参考链接。该文件本身不包含任何可执行代码，因此直接的投毒风险较低。但是，参考链接指向的POC代码，可能存在被篡改的风险，间接存在一定的投毒可能。考虑到该仓库只是一个说明文档，实际的漏洞利用需要用户自行下载其他POC代码，因此判定投毒风险为10%。

**利用方式分析：**
1.  **漏洞原理：** 漏洞利用了Netlogon协议中的一个加密缺陷，攻击者可以将Netlogon会话的客户端凭据设置为全零。
2.  **攻击步骤：**
    *   攻击者通过MS-NRPC与域控制器建立连接。
    *   利用漏洞将域控制器的机器帐户密码置零。
    *   使用置零后的密码更改域控制器的机器帐户密码。
    *   通过修改后的机器帐户密码获得域管理员权限。
3. **修复方式：** 安装Microsoft发布的更新补丁，并按照Microsoft的指南进行配置，以强制执行安全的Netlogon通道。

**项目地址:** [100HnoMeuNome/ZeroLogon-CVE-2020-1472-lab](https://github.com/100HnoMeuNome/ZeroLogon-CVE-2020-1472-lab)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #2

**来源**: [CVE-2020-1472-Akash7350_CVE-2020-1472.md](../2020/CVE-2020-1472-Akash7350_CVE-2020-1472.md)

## CVE-2020-1472-Zerologon-特权提升

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本，详见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个影响Microsoft Windows Netlogon Remote Protocol (MS-NRPC) 的特权提升漏洞。未经身份验证的攻击者可以通过与域控制器建立脆弱的Netlogon安全通道连接来利用此漏洞。成功利用该漏洞可能允许攻击者冒充域控制器，并最终获得域管理员权限，从而完全控制整个域。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，此POC代码是有效的。搜索结果中多个链接指向了关于该漏洞的分析和利用文章，证明了该漏洞的可利用性。POC代码描述也表明，它能够重置域控制器的帐户密码为空字符串，从而实现权限提升。

**投毒风险：**
评估POC代码的投毒风险较低，大约为10%。代码主要逻辑集中在利用Netlogon协议的加密缺陷，通过重复的认证尝试来绕过身份验证。虽然存在一定的风险，例如代码的维护者可能在未来版本中引入恶意代码，或者安装过程中依赖的第三方库存在安全问题，但从当前提供的代码来看，直接包含恶意、后门代码的可能性不大。该代码更侧重于漏洞利用的验证和概念证明。

**利用方式：**
1.  **建立连接：** 攻击者使用MS-NRPC协议与目标域控制器建立网络连接。
2.  **零化凭据：** 攻击者发送一个包含全零凭据的Netlogon身份验证请求。
3.  **重复尝试：** 由于协议的加密缺陷，攻击者重复发送此请求多次。每次尝试都有可能成功绕过身份验证。
4.  **密码重置：** 成功绕过身份验证后，攻击者将域控制器的帐户密码重置为空字符串。
5.  **权限提升：** 此时，攻击者可以利用空密码来冒充域控制器并获取域管理员权限。

需要注意的是，成功利用此漏洞需要目标域控制器未安装相应的安全补丁。此外，利用该漏洞可能会导致域环境不稳定甚至崩溃，因此在生产环境中进行测试需要谨慎。

**项目地址:** [Akash7350/CVE-2020-1472](https://github.com/Akash7350/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #3

**来源**: [CVE-2020-1472-Anonymous-Family_CVE-2020-1472.md](../2020/CVE-2020-1472-Anonymous-Family_CVE-2020-1472.md)

## CVE-2020-1472 Zerologon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本见漏洞库信息

**利用条件:** 需要位于目标域控制器的网络中

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-1472（Zerologon）是一个存在于Windows Server Netlogon Remote Protocol (MS-NRPC) 中的特权提升漏洞。攻击者通过与域控制器建立脆弱的Netlogon安全通道连接，可以运行特制的应用程序并获取域管理员权限。

**有效性分析：**

提供的POC代码 `zerologon_tester.py` 旨在检测目标域控制器是否存在Zerologon漏洞。该脚本通过尝试使用全零的challenge和credential来进行Netlogon身份验证绕过。如果域控制器存在漏洞，则身份验证将成功，脚本会立即终止。如果域控制器已打补丁，脚本会在多次尝试后放弃并认为目标不存在漏洞（存在极低的假阴性概率）。根据搜索引擎结果，该漏洞利用代码的思路和方法与公开的漏洞利用方式一致，因此判断提供的POC代码是有效的。

**投毒风险分析：**

通过对Dockerfile，requirements.txt和zerologon_tester.py的代码分析，该仓库主要包含漏洞利用的测试代码和依赖项，未发现明显的恶意代码或后门，代码的功能主要是实现对Zerologon漏洞的检测,因此投毒风险较低。

**利用方式：**

1.  **漏洞利用阶段：** 攻击者首先需要与目标域控制器建立网络连接。然后，攻击者运行Zerologon漏洞利用脚本（例如提供的`zerologon_tester.py`的修改版本），该脚本通过MS-NRPC协议发送特制的身份验证请求，利用加密算法中的漏洞将域控制器的机器帐户密码置零。
2.  **权限提升阶段：** 成功将域控制器的机器帐户密码置零后，攻击者可以使用该零密码来获得域控制器的身份验证，从而完全控制域。
3.  **持久化和横向移动（可选）：** 攻击者获得域管理员权限后，可以进行持久化操作（例如创建新的管理员帐户）并在域内进行横向移动，以控制更多系统和数据。

**项目地址:** [Anonymous-Family/CVE-2020-1472](https://github.com/Anonymous-Family/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #4

**来源**: [CVE-2020-1472-Anonymous-Family_Zero-day-scanning.md](../2020/CVE-2020-1472-Anonymous-Family_Zero-day-scanning.md)

## CVE-2020-1472 Zerologon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本，详见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

Zerologon (CVE-2020-1472) 是一个严重的权限提升漏洞，存在于 Netlogon Remote Protocol (MS-NRPC) 中。未经身份验证的攻击者可以通过建立与域控制器的脆弱 Netlogon 安全通道连接来利用此漏洞。攻击成功后，攻击者可以运行特制的应用程序，从而完全控制域控制器。 

**利用方式：**

1.  **利用MS-NRPC协议：** 攻击者利用 MS-NRPC 协议连接到域控制器。
2.  **重置域控制器的密码：** 攻击者通过将域控制器的计算机密码设置为已知值（通常是空值），从而破坏身份验证过程。
3.  **获取域管理员权限：** 密码重置后，攻击者可以冒充域控制器并获取域管理员权限。

**有效性：**

提供的漏洞利用代码 (zeroscan) 本身是一个扫描器，用于检测目标域控制器是否存在 Zerologon 漏洞、MS-PAR/MS-RPRN 协议是否暴露以及 SMBv2 签名配置。它**不**尝试实际利用该漏洞，但是它使用基于已知的POC修改的代码库来检查漏洞，因此可以判断存在可利用性。

**投毒风险：**

分析提供的代码，投毒风险较低，但不能完全排除。理由如下：

*   **开源代码：** 代码托管在 GitHub 上，具有一定的透明度，更容易受到社区审查。
*   **扫描器功能：** 该工具主要功能是扫描，而非直接利用，因此隐藏恶意代码的动机相对较低。
*   **依赖第三方库：** 代码依赖于 Impacket 和 Nmap 等第三方库，攻击者可能尝试利用这些依赖项中的漏洞进行投毒攻击。但是，直接在zeroscan本身投毒的概率较低。
*  **POC的免责声明：**  `Codebase borrowed from: https://github.com/Anonymous-Family/CVE-2020-1472.git` 声明中，代码借鉴了其他库,存在一定的代码风险.

因此，尽管直接在 zeroscan 代码中植入后门的概率较低（假设为5%），但仍需谨慎使用，并仔细审查代码及所依赖的第三方库。


**项目地址:** [Anonymous-Family/Zero-day-scanning](https://github.com/Anonymous-Family/Zero-day-scanning)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #5

**来源**: [CVE-2020-1472-B34MR_zeroscan.md](../2020/CVE-2020-1472-B34MR_zeroscan.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获得域管理员权限。

**影响版本:** 受影响的Windows Server版本包括2008 R2到20H2等多个版本，具体版本请参考漏洞库信息。

**利用条件:** 攻击者需要与域控制器建立网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server的Netlogon协议中。攻击者可以通过将Netlogon客户端使用的身份验证凭据中的多个零值设置为全零来利用此漏洞。如果攻击成功，攻击者可以冒充域控制器上的任何计算机（包括域控制器本身），并获得域管理员权限。

**有效性：**
根据漏洞信息和搜索结果，该漏洞POC是有效的，并且已经被广泛利用。

**投毒风险：**
提供的代码（zeroscan）描述中明确声明它是一个漏洞扫描器，而不是漏洞利用工具，并且专门指出它不尝试利用Zerologon漏洞，只是检查是否存在漏洞。代码库借鉴自SecuraBV的CVE-2020-1472检查脚本。虽然zeroscan本身声明不进行利用，但它依赖于其他工具和脚本，这些依赖项可能存在潜在的风险。此外，代码中可能存在作者有意或无意引入的缺陷或后门。考虑到zeroscan的性质，以及它wrapper Impacket等工具，我们无法完全排除投毒的可能性。因此，存在一定比例的投毒风险。 

**利用方式：**

1.  攻击者使用MS-NRPC协议与域控制器建立连接。
2.  攻击者发送特制的身份验证请求，将Netlogon客户端凭据设置为零。
3.  由于Netlogon协议的缺陷，域控制器错误地接受了零凭据，从而允许攻击者通过身份验证。
4.  攻击者现在可以冒充域控制器并执行恶意操作，例如更改域管理员密码或部署恶意软件。
5. 通过rpcdump可以检测MS-PAR/MS-RPRN服务是否开启，为进一步攻击提供信息。
6. 通过检测SMB signing配置，决定后续横向移动的策略。


**项目地址:** [B34MR/zeroscan](https://github.com/B34MR/zeroscan)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #6

**来源**: [CVE-2020-1472-CPO-EH_CVE-2020-1472_ZeroLogonChecker.md](../2020/CVE-2020-1472-CPO-EH_CVE-2020-1472_ZeroLogonChecker.md)

## CVE-2020-1472 (Zerologon) 漏洞检测

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本，具体请参考漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个Windows Netlogon协议中的严重漏洞，允许未经身份验证的攻击者通过MS-NRPC协议连接到域控制器，重置域控制器的机器帐户密码为空，从而获取域管理员权限。提供的漏洞利用代码是一个C#程序，用于**检测**目标域控制器是否存在此漏洞，**并非真正的漏洞利用代码**。该代码通过尝试与目标域控制器建立Netlogon安全通道并执行身份验证来检测漏洞。由于代码本身是漏洞**检测**工具，并非直接进行提权，因此**投毒风险较低**，主要体现在可能被修改为发送大量探测流量进行拒绝服务攻击，或者收集目标服务器信息的可能。代码片段不完整，只能推断出实现逻辑，但未看到恶意代码，初步认为投毒风险概率为10%。

**利用方式：**

1.  攻击者利用MS-NRPC协议的加密缺陷，向域控制器发送一系列特制的Netlogon请求。
2.  这些请求将导致域控制器的机器帐户密码被重置为空字符串。
3.  攻击者随后可以使用空密码来冒充域控制器，并执行各种恶意操作，例如添加新的域管理员帐户或修改现有帐户的权限。

**有效性：**

由于提供的代码是漏洞检测工具，并非漏洞利用工具，所以**有效性体现在能否准确检测出目标是否存在漏洞**。根据漏洞库信息和搜索结果，该漏洞影响多个版本的Windows Server，攻击影响极大。

**参考链接：**
*   https://www.crowdstrike.com/en-us/blog/cve-2020-1472-zerologon-security-advisory/
*   https://msrc.microsoft.com/blog/2020/10/attacks-exploiting-netlogon-vulnerability-cve-2020-1472/
*   https://nvd.nist.gov/vuln/detail/cve-2020-1472

**项目地址:** [CPO-EH/CVE-2020-1472_ZeroLogonChecker](https://github.com/CPO-EH/CVE-2020-1472_ZeroLogonChecker)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #7

**来源**: [CVE-2020-1472-Fa1c0n35_CVE-2020-1472-02-.md](../2020/CVE-2020-1472-Fa1c0n35_CVE-2020-1472-02-.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，可导致域管理员权限被获取

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与域控制器的网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个Windows Netlogon协议中的权限提升漏洞。攻击者可以通过建立一个到域控制器的脆弱的Netlogon安全通道连接来利用此漏洞。漏洞利用代码通过将Netlogon会话密钥重置为零，从而绕过身份验证。提供的`zerologon_tester.py`脚本用于检测目标域控制器是否存在此漏洞。脚本尝试使用全零的challenge和credential进行身份验证。如果成功，则表明目标存在漏洞。虽然脚本的主要目的是测试漏洞是否存在，但潜在的投毒风险在于，攻击者可能修改该脚本以在成功利用漏洞后执行恶意操作，例如安装后门或收集敏感信息。要求Python 3.7或更高版本，以及`requirements.txt`中列出的依赖项。脚本通过`pip install -r requirements.txt`安装依赖。利用方式为：1. 运行`zerologon_tester.py`脚本，指定目标域控制器的NetBIOS名称和IP地址。2. 脚本尝试使用零密钥进行身份验证。3. 如果身份验证成功，脚本会立即终止，表明目标易受攻击。根据漏洞描述，成功利用此漏洞可能允许未经身份验证的攻击者获得域管理员权限，从而完全控制域。

**投毒风险分析：**

*   **README.md:** 描述了脚本的使用方法和漏洞背景，未发现可疑代码。
*   **LICENSE:** MIT许可证，允许自由使用、修改和分发，但也增加了被修改后用于恶意目的的风险。
*   **requirements.txt:** 列出了脚本依赖的Python库。虽然这些库本身是合法的，但攻击者可能替换或篡改这些库的安装源，从而引入恶意代码。impacket库本身如果来源不明，存在一定风险。
*   **zerologon_tester.py:** 脚本的核心代码，实现了漏洞的检测和利用。虽然代码本身看起来是合法的漏洞验证代码，但是仍然存在被篡改的风险，例如添加在成功利用漏洞后执行恶意操作的代码。例如，在`try_zero_authenticate` 函数中，成功绕过身份验证后，可以添加执行任意代码的逻辑。

因此，虽然提供的代码主要是漏洞检测工具，但仍然存在一定的投毒风险。特别是需要注意impacket包的来源可靠性，以及防止`zerologon_tester.py`被篡改添加恶意逻辑。

综合考虑，判定投毒风险为10%。

**项目地址:** [Fa1c0n35/CVE-2020-1472-02-](https://github.com/Fa1c0n35/CVE-2020-1472-02-)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #8

**来源**: [CVE-2020-1472-Fa1c0n35_SecuraBV-CVE-2020-1472.md](../2020/CVE-2020-1472-Fa1c0n35_SecuraBV-CVE-2020-1472.md)

# CVE-2020-1472

> 📦 该CVE有 **31** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-1472-100HnoMeuNome_ZeroLogon-CVE-2020-1472-lab.md](../2020/CVE-2020-1472-100HnoMeuNome_ZeroLogon-CVE-2020-1472-lab.md)

## CVE-2020-1472 Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Netlogon Remote Protocol (MS-NRPC)

**危害等级:** 高危，可能导致域管理员权限提升

**影响版本:** 受影响的Windows Server版本：2008 R2, 2012 / 2012 R2, 2016, 2019，以及2020年8月/9月补丁之前的版本

**利用条件:** 需要位于网络内部，能够与域控制器通信

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Microsoft Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。未经身份验证的攻击者可以通过网络连接到域控制器，并利用该漏洞获取域管理员权限。 

**有效性分析：**
根据搜索结果，该漏洞利用的POC代码已经公开（例如packetstormsecurity.com上的POC）。漏洞库信息也表明该漏洞已被积极利用（`Exploitation: active` in CISA ADP Vulnrichment），所以提供的POC代码大概率是有效的。

**投毒风险分析：**
提供的漏洞利用代码实际上是一个`README.md`文件，该文件仅包含漏洞的描述、利用说明、缓解措施和参考链接。该文件本身不包含任何可执行代码，因此直接的投毒风险较低。但是，参考链接指向的POC代码，可能存在被篡改的风险，间接存在一定的投毒可能。考虑到该仓库只是一个说明文档，实际的漏洞利用需要用户自行下载其他POC代码，因此判定投毒风险为10%。

**利用方式分析：**
1.  **漏洞原理：** 漏洞利用了Netlogon协议中的一个加密缺陷，攻击者可以将Netlogon会话的客户端凭据设置为全零。
2.  **攻击步骤：**
    *   攻击者通过MS-NRPC与域控制器建立连接。
    *   利用漏洞将域控制器的机器帐户密码置零。
    *   使用置零后的密码更改域控制器的机器帐户密码。
    *   通过修改后的机器帐户密码获得域管理员权限。
3. **修复方式：** 安装Microsoft发布的更新补丁，并按照Microsoft的指南进行配置，以强制执行安全的Netlogon通道。

**项目地址:** [100HnoMeuNome/ZeroLogon-CVE-2020-1472-lab](https://github.com/100HnoMeuNome/ZeroLogon-CVE-2020-1472-lab)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #2

**来源**: [CVE-2020-1472-Akash7350_CVE-2020-1472.md](../2020/CVE-2020-1472-Akash7350_CVE-2020-1472.md)

## CVE-2020-1472-Zerologon-特权提升

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本，详见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个影响Microsoft Windows Netlogon Remote Protocol (MS-NRPC) 的特权提升漏洞。未经身份验证的攻击者可以通过与域控制器建立脆弱的Netlogon安全通道连接来利用此漏洞。成功利用该漏洞可能允许攻击者冒充域控制器，并最终获得域管理员权限，从而完全控制整个域。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，此POC代码是有效的。搜索结果中多个链接指向了关于该漏洞的分析和利用文章，证明了该漏洞的可利用性。POC代码描述也表明，它能够重置域控制器的帐户密码为空字符串，从而实现权限提升。

**投毒风险：**
评估POC代码的投毒风险较低，大约为10%。代码主要逻辑集中在利用Netlogon协议的加密缺陷，通过重复的认证尝试来绕过身份验证。虽然存在一定的风险，例如代码的维护者可能在未来版本中引入恶意代码，或者安装过程中依赖的第三方库存在安全问题，但从当前提供的代码来看，直接包含恶意、后门代码的可能性不大。该代码更侧重于漏洞利用的验证和概念证明。

**利用方式：**
1.  **建立连接：** 攻击者使用MS-NRPC协议与目标域控制器建立网络连接。
2.  **零化凭据：** 攻击者发送一个包含全零凭据的Netlogon身份验证请求。
3.  **重复尝试：** 由于协议的加密缺陷，攻击者重复发送此请求多次。每次尝试都有可能成功绕过身份验证。
4.  **密码重置：** 成功绕过身份验证后，攻击者将域控制器的帐户密码重置为空字符串。
5.  **权限提升：** 此时，攻击者可以利用空密码来冒充域控制器并获取域管理员权限。

需要注意的是，成功利用此漏洞需要目标域控制器未安装相应的安全补丁。此外，利用该漏洞可能会导致域环境不稳定甚至崩溃，因此在生产环境中进行测试需要谨慎。

**项目地址:** [Akash7350/CVE-2020-1472](https://github.com/Akash7350/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #3

**来源**: [CVE-2020-1472-Anonymous-Family_CVE-2020-1472.md](../2020/CVE-2020-1472-Anonymous-Family_CVE-2020-1472.md)

## CVE-2020-1472 Zerologon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本见漏洞库信息

**利用条件:** 需要位于目标域控制器的网络中

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-1472（Zerologon）是一个存在于Windows Server Netlogon Remote Protocol (MS-NRPC) 中的特权提升漏洞。攻击者通过与域控制器建立脆弱的Netlogon安全通道连接，可以运行特制的应用程序并获取域管理员权限。

**有效性分析：**

提供的POC代码 `zerologon_tester.py` 旨在检测目标域控制器是否存在Zerologon漏洞。该脚本通过尝试使用全零的challenge和credential来进行Netlogon身份验证绕过。如果域控制器存在漏洞，则身份验证将成功，脚本会立即终止。如果域控制器已打补丁，脚本会在多次尝试后放弃并认为目标不存在漏洞（存在极低的假阴性概率）。根据搜索引擎结果，该漏洞利用代码的思路和方法与公开的漏洞利用方式一致，因此判断提供的POC代码是有效的。

**投毒风险分析：**

通过对Dockerfile，requirements.txt和zerologon_tester.py的代码分析，该仓库主要包含漏洞利用的测试代码和依赖项，未发现明显的恶意代码或后门，代码的功能主要是实现对Zerologon漏洞的检测,因此投毒风险较低。

**利用方式：**

1.  **漏洞利用阶段：** 攻击者首先需要与目标域控制器建立网络连接。然后，攻击者运行Zerologon漏洞利用脚本（例如提供的`zerologon_tester.py`的修改版本），该脚本通过MS-NRPC协议发送特制的身份验证请求，利用加密算法中的漏洞将域控制器的机器帐户密码置零。
2.  **权限提升阶段：** 成功将域控制器的机器帐户密码置零后，攻击者可以使用该零密码来获得域控制器的身份验证，从而完全控制域。
3.  **持久化和横向移动（可选）：** 攻击者获得域管理员权限后，可以进行持久化操作（例如创建新的管理员帐户）并在域内进行横向移动，以控制更多系统和数据。

**项目地址:** [Anonymous-Family/CVE-2020-1472](https://github.com/Anonymous-Family/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #4

**来源**: [CVE-2020-1472-Anonymous-Family_Zero-day-scanning.md](../2020/CVE-2020-1472-Anonymous-Family_Zero-day-scanning.md)

## CVE-2020-1472 Zerologon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本，详见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

Zerologon (CVE-2020-1472) 是一个严重的权限提升漏洞，存在于 Netlogon Remote Protocol (MS-NRPC) 中。未经身份验证的攻击者可以通过建立与域控制器的脆弱 Netlogon 安全通道连接来利用此漏洞。攻击成功后，攻击者可以运行特制的应用程序，从而完全控制域控制器。 

**利用方式：**

1.  **利用MS-NRPC协议：** 攻击者利用 MS-NRPC 协议连接到域控制器。
2.  **重置域控制器的密码：** 攻击者通过将域控制器的计算机密码设置为已知值（通常是空值），从而破坏身份验证过程。
3.  **获取域管理员权限：** 密码重置后，攻击者可以冒充域控制器并获取域管理员权限。

**有效性：**

提供的漏洞利用代码 (zeroscan) 本身是一个扫描器，用于检测目标域控制器是否存在 Zerologon 漏洞、MS-PAR/MS-RPRN 协议是否暴露以及 SMBv2 签名配置。它**不**尝试实际利用该漏洞，但是它使用基于已知的POC修改的代码库来检查漏洞，因此可以判断存在可利用性。

**投毒风险：**

分析提供的代码，投毒风险较低，但不能完全排除。理由如下：

*   **开源代码：** 代码托管在 GitHub 上，具有一定的透明度，更容易受到社区审查。
*   **扫描器功能：** 该工具主要功能是扫描，而非直接利用，因此隐藏恶意代码的动机相对较低。
*   **依赖第三方库：** 代码依赖于 Impacket 和 Nmap 等第三方库，攻击者可能尝试利用这些依赖项中的漏洞进行投毒攻击。但是，直接在zeroscan本身投毒的概率较低。
*  **POC的免责声明：**  `Codebase borrowed from: https://github.com/Anonymous-Family/CVE-2020-1472.git` 声明中，代码借鉴了其他库,存在一定的代码风险.

因此，尽管直接在 zeroscan 代码中植入后门的概率较低（假设为5%），但仍需谨慎使用，并仔细审查代码及所依赖的第三方库。


**项目地址:** [Anonymous-Family/Zero-day-scanning](https://github.com/Anonymous-Family/Zero-day-scanning)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #5

**来源**: [CVE-2020-1472-B34MR_zeroscan.md](../2020/CVE-2020-1472-B34MR_zeroscan.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获得域管理员权限。

**影响版本:** 受影响的Windows Server版本包括2008 R2到20H2等多个版本，具体版本请参考漏洞库信息。

**利用条件:** 攻击者需要与域控制器建立网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server的Netlogon协议中。攻击者可以通过将Netlogon客户端使用的身份验证凭据中的多个零值设置为全零来利用此漏洞。如果攻击成功，攻击者可以冒充域控制器上的任何计算机（包括域控制器本身），并获得域管理员权限。

**有效性：**
根据漏洞信息和搜索结果，该漏洞POC是有效的，并且已经被广泛利用。

**投毒风险：**
提供的代码（zeroscan）描述中明确声明它是一个漏洞扫描器，而不是漏洞利用工具，并且专门指出它不尝试利用Zerologon漏洞，只是检查是否存在漏洞。代码库借鉴自SecuraBV的CVE-2020-1472检查脚本。虽然zeroscan本身声明不进行利用，但它依赖于其他工具和脚本，这些依赖项可能存在潜在的风险。此外，代码中可能存在作者有意或无意引入的缺陷或后门。考虑到zeroscan的性质，以及它wrapper Impacket等工具，我们无法完全排除投毒的可能性。因此，存在一定比例的投毒风险。 

**利用方式：**

1.  攻击者使用MS-NRPC协议与域控制器建立连接。
2.  攻击者发送特制的身份验证请求，将Netlogon客户端凭据设置为零。
3.  由于Netlogon协议的缺陷，域控制器错误地接受了零凭据，从而允许攻击者通过身份验证。
4.  攻击者现在可以冒充域控制器并执行恶意操作，例如更改域管理员密码或部署恶意软件。
5. 通过rpcdump可以检测MS-PAR/MS-RPRN服务是否开启，为进一步攻击提供信息。
6. 通过检测SMB signing配置，决定后续横向移动的策略。


**项目地址:** [B34MR/zeroscan](https://github.com/B34MR/zeroscan)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #6

**来源**: [CVE-2020-1472-CPO-EH_CVE-2020-1472_ZeroLogonChecker.md](../2020/CVE-2020-1472-CPO-EH_CVE-2020-1472_ZeroLogonChecker.md)

## CVE-2020-1472 (Zerologon) 漏洞检测

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本，具体请参考漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个Windows Netlogon协议中的严重漏洞，允许未经身份验证的攻击者通过MS-NRPC协议连接到域控制器，重置域控制器的机器帐户密码为空，从而获取域管理员权限。提供的漏洞利用代码是一个C#程序，用于**检测**目标域控制器是否存在此漏洞，**并非真正的漏洞利用代码**。该代码通过尝试与目标域控制器建立Netlogon安全通道并执行身份验证来检测漏洞。由于代码本身是漏洞**检测**工具，并非直接进行提权，因此**投毒风险较低**，主要体现在可能被修改为发送大量探测流量进行拒绝服务攻击，或者收集目标服务器信息的可能。代码片段不完整，只能推断出实现逻辑，但未看到恶意代码，初步认为投毒风险概率为10%。

**利用方式：**

1.  攻击者利用MS-NRPC协议的加密缺陷，向域控制器发送一系列特制的Netlogon请求。
2.  这些请求将导致域控制器的机器帐户密码被重置为空字符串。
3.  攻击者随后可以使用空密码来冒充域控制器，并执行各种恶意操作，例如添加新的域管理员帐户或修改现有帐户的权限。

**有效性：**

由于提供的代码是漏洞检测工具，并非漏洞利用工具，所以**有效性体现在能否准确检测出目标是否存在漏洞**。根据漏洞库信息和搜索结果，该漏洞影响多个版本的Windows Server，攻击影响极大。

**参考链接：**
*   https://www.crowdstrike.com/en-us/blog/cve-2020-1472-zerologon-security-advisory/
*   https://msrc.microsoft.com/blog/2020/10/attacks-exploiting-netlogon-vulnerability-cve-2020-1472/
*   https://nvd.nist.gov/vuln/detail/cve-2020-1472

**项目地址:** [CPO-EH/CVE-2020-1472_ZeroLogonChecker](https://github.com/CPO-EH/CVE-2020-1472_ZeroLogonChecker)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #7

**来源**: [CVE-2020-1472-Fa1c0n35_CVE-2020-1472-02-.md](../2020/CVE-2020-1472-Fa1c0n35_CVE-2020-1472-02-.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，可导致域管理员权限被获取

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与域控制器的网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个Windows Netlogon协议中的权限提升漏洞。攻击者可以通过建立一个到域控制器的脆弱的Netlogon安全通道连接来利用此漏洞。漏洞利用代码通过将Netlogon会话密钥重置为零，从而绕过身份验证。提供的`zerologon_tester.py`脚本用于检测目标域控制器是否存在此漏洞。脚本尝试使用全零的challenge和credential进行身份验证。如果成功，则表明目标存在漏洞。虽然脚本的主要目的是测试漏洞是否存在，但潜在的投毒风险在于，攻击者可能修改该脚本以在成功利用漏洞后执行恶意操作，例如安装后门或收集敏感信息。要求Python 3.7或更高版本，以及`requirements.txt`中列出的依赖项。脚本通过`pip install -r requirements.txt`安装依赖。利用方式为：1. 运行`zerologon_tester.py`脚本，指定目标域控制器的NetBIOS名称和IP地址。2. 脚本尝试使用零密钥进行身份验证。3. 如果身份验证成功，脚本会立即终止，表明目标易受攻击。根据漏洞描述，成功利用此漏洞可能允许未经身份验证的攻击者获得域管理员权限，从而完全控制域。

**投毒风险分析：**

*   **README.md:** 描述了脚本的使用方法和漏洞背景，未发现可疑代码。
*   **LICENSE:** MIT许可证，允许自由使用、修改和分发，但也增加了被修改后用于恶意目的的风险。
*   **requirements.txt:** 列出了脚本依赖的Python库。虽然这些库本身是合法的，但攻击者可能替换或篡改这些库的安装源，从而引入恶意代码。impacket库本身如果来源不明，存在一定风险。
*   **zerologon_tester.py:** 脚本的核心代码，实现了漏洞的检测和利用。虽然代码本身看起来是合法的漏洞验证代码，但是仍然存在被篡改的风险，例如添加在成功利用漏洞后执行恶意操作的代码。例如，在`try_zero_authenticate` 函数中，成功绕过身份验证后，可以添加执行任意代码的逻辑。

因此，虽然提供的代码主要是漏洞检测工具，但仍然存在一定的投毒风险。特别是需要注意impacket包的来源可靠性，以及防止`zerologon_tester.py`被篡改添加恶意逻辑。

综合考虑，判定投毒风险为10%。

**项目地址:** [Fa1c0n35/CVE-2020-1472-02-](https://github.com/Fa1c0n35/CVE-2020-1472-02-)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #8

**来源**: [CVE-2020-1472-Fa1c0n35_SecuraBV-CVE-2020-1472.md](../2020/CVE-2020-1472-Fa1c0n35_SecuraBV-CVE-2020-1472.md)

# CVE-2020-1472

> 📦 该CVE有 **31** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-1472-100HnoMeuNome_ZeroLogon-CVE-2020-1472-lab.md](../2020/CVE-2020-1472-100HnoMeuNome_ZeroLogon-CVE-2020-1472-lab.md)

## CVE-2020-1472 Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Netlogon Remote Protocol (MS-NRPC)

**危害等级:** 高危，可能导致域管理员权限提升

**影响版本:** 受影响的Windows Server版本：2008 R2, 2012 / 2012 R2, 2016, 2019，以及2020年8月/9月补丁之前的版本

**利用条件:** 需要位于网络内部，能够与域控制器通信

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Microsoft Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。未经身份验证的攻击者可以通过网络连接到域控制器，并利用该漏洞获取域管理员权限。 

**有效性分析：**
根据搜索结果，该漏洞利用的POC代码已经公开（例如packetstormsecurity.com上的POC）。漏洞库信息也表明该漏洞已被积极利用（`Exploitation: active` in CISA ADP Vulnrichment），所以提供的POC代码大概率是有效的。

**投毒风险分析：**
提供的漏洞利用代码实际上是一个`README.md`文件，该文件仅包含漏洞的描述、利用说明、缓解措施和参考链接。该文件本身不包含任何可执行代码，因此直接的投毒风险较低。但是，参考链接指向的POC代码，可能存在被篡改的风险，间接存在一定的投毒可能。考虑到该仓库只是一个说明文档，实际的漏洞利用需要用户自行下载其他POC代码，因此判定投毒风险为10%。

**利用方式分析：**
1.  **漏洞原理：** 漏洞利用了Netlogon协议中的一个加密缺陷，攻击者可以将Netlogon会话的客户端凭据设置为全零。
2.  **攻击步骤：**
    *   攻击者通过MS-NRPC与域控制器建立连接。
    *   利用漏洞将域控制器的机器帐户密码置零。
    *   使用置零后的密码更改域控制器的机器帐户密码。
    *   通过修改后的机器帐户密码获得域管理员权限。
3. **修复方式：** 安装Microsoft发布的更新补丁，并按照Microsoft的指南进行配置，以强制执行安全的Netlogon通道。

**项目地址:** [100HnoMeuNome/ZeroLogon-CVE-2020-1472-lab](https://github.com/100HnoMeuNome/ZeroLogon-CVE-2020-1472-lab)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #2

**来源**: [CVE-2020-1472-Akash7350_CVE-2020-1472.md](../2020/CVE-2020-1472-Akash7350_CVE-2020-1472.md)

## CVE-2020-1472-Zerologon-特权提升

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本，详见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个影响Microsoft Windows Netlogon Remote Protocol (MS-NRPC) 的特权提升漏洞。未经身份验证的攻击者可以通过与域控制器建立脆弱的Netlogon安全通道连接来利用此漏洞。成功利用该漏洞可能允许攻击者冒充域控制器，并最终获得域管理员权限，从而完全控制整个域。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，此POC代码是有效的。搜索结果中多个链接指向了关于该漏洞的分析和利用文章，证明了该漏洞的可利用性。POC代码描述也表明，它能够重置域控制器的帐户密码为空字符串，从而实现权限提升。

**投毒风险：**
评估POC代码的投毒风险较低，大约为10%。代码主要逻辑集中在利用Netlogon协议的加密缺陷，通过重复的认证尝试来绕过身份验证。虽然存在一定的风险，例如代码的维护者可能在未来版本中引入恶意代码，或者安装过程中依赖的第三方库存在安全问题，但从当前提供的代码来看，直接包含恶意、后门代码的可能性不大。该代码更侧重于漏洞利用的验证和概念证明。

**利用方式：**
1.  **建立连接：** 攻击者使用MS-NRPC协议与目标域控制器建立网络连接。
2.  **零化凭据：** 攻击者发送一个包含全零凭据的Netlogon身份验证请求。
3.  **重复尝试：** 由于协议的加密缺陷，攻击者重复发送此请求多次。每次尝试都有可能成功绕过身份验证。
4.  **密码重置：** 成功绕过身份验证后，攻击者将域控制器的帐户密码重置为空字符串。
5.  **权限提升：** 此时，攻击者可以利用空密码来冒充域控制器并获取域管理员权限。

需要注意的是，成功利用此漏洞需要目标域控制器未安装相应的安全补丁。此外，利用该漏洞可能会导致域环境不稳定甚至崩溃，因此在生产环境中进行测试需要谨慎。

**项目地址:** [Akash7350/CVE-2020-1472](https://github.com/Akash7350/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #3

**来源**: [CVE-2020-1472-Anonymous-Family_CVE-2020-1472.md](../2020/CVE-2020-1472-Anonymous-Family_CVE-2020-1472.md)

## CVE-2020-1472 Zerologon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本见漏洞库信息

**利用条件:** 需要位于目标域控制器的网络中

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-1472（Zerologon）是一个存在于Windows Server Netlogon Remote Protocol (MS-NRPC) 中的特权提升漏洞。攻击者通过与域控制器建立脆弱的Netlogon安全通道连接，可以运行特制的应用程序并获取域管理员权限。

**有效性分析：**

提供的POC代码 `zerologon_tester.py` 旨在检测目标域控制器是否存在Zerologon漏洞。该脚本通过尝试使用全零的challenge和credential来进行Netlogon身份验证绕过。如果域控制器存在漏洞，则身份验证将成功，脚本会立即终止。如果域控制器已打补丁，脚本会在多次尝试后放弃并认为目标不存在漏洞（存在极低的假阴性概率）。根据搜索引擎结果，该漏洞利用代码的思路和方法与公开的漏洞利用方式一致，因此判断提供的POC代码是有效的。

**投毒风险分析：**

通过对Dockerfile，requirements.txt和zerologon_tester.py的代码分析，该仓库主要包含漏洞利用的测试代码和依赖项，未发现明显的恶意代码或后门，代码的功能主要是实现对Zerologon漏洞的检测,因此投毒风险较低。

**利用方式：**

1.  **漏洞利用阶段：** 攻击者首先需要与目标域控制器建立网络连接。然后，攻击者运行Zerologon漏洞利用脚本（例如提供的`zerologon_tester.py`的修改版本），该脚本通过MS-NRPC协议发送特制的身份验证请求，利用加密算法中的漏洞将域控制器的机器帐户密码置零。
2.  **权限提升阶段：** 成功将域控制器的机器帐户密码置零后，攻击者可以使用该零密码来获得域控制器的身份验证，从而完全控制域。
3.  **持久化和横向移动（可选）：** 攻击者获得域管理员权限后，可以进行持久化操作（例如创建新的管理员帐户）并在域内进行横向移动，以控制更多系统和数据。

**项目地址:** [Anonymous-Family/CVE-2020-1472](https://github.com/Anonymous-Family/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #4

**来源**: [CVE-2020-1472-Anonymous-Family_Zero-day-scanning.md](../2020/CVE-2020-1472-Anonymous-Family_Zero-day-scanning.md)

## CVE-2020-1472 Zerologon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本，详见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

Zerologon (CVE-2020-1472) 是一个严重的权限提升漏洞，存在于 Netlogon Remote Protocol (MS-NRPC) 中。未经身份验证的攻击者可以通过建立与域控制器的脆弱 Netlogon 安全通道连接来利用此漏洞。攻击成功后，攻击者可以运行特制的应用程序，从而完全控制域控制器。 

**利用方式：**

1.  **利用MS-NRPC协议：** 攻击者利用 MS-NRPC 协议连接到域控制器。
2.  **重置域控制器的密码：** 攻击者通过将域控制器的计算机密码设置为已知值（通常是空值），从而破坏身份验证过程。
3.  **获取域管理员权限：** 密码重置后，攻击者可以冒充域控制器并获取域管理员权限。

**有效性：**

提供的漏洞利用代码 (zeroscan) 本身是一个扫描器，用于检测目标域控制器是否存在 Zerologon 漏洞、MS-PAR/MS-RPRN 协议是否暴露以及 SMBv2 签名配置。它**不**尝试实际利用该漏洞，但是它使用基于已知的POC修改的代码库来检查漏洞，因此可以判断存在可利用性。

**投毒风险：**

分析提供的代码，投毒风险较低，但不能完全排除。理由如下：

*   **开源代码：** 代码托管在 GitHub 上，具有一定的透明度，更容易受到社区审查。
*   **扫描器功能：** 该工具主要功能是扫描，而非直接利用，因此隐藏恶意代码的动机相对较低。
*   **依赖第三方库：** 代码依赖于 Impacket 和 Nmap 等第三方库，攻击者可能尝试利用这些依赖项中的漏洞进行投毒攻击。但是，直接在zeroscan本身投毒的概率较低。
*  **POC的免责声明：**  `Codebase borrowed from: https://github.com/Anonymous-Family/CVE-2020-1472.git` 声明中，代码借鉴了其他库,存在一定的代码风险.

因此，尽管直接在 zeroscan 代码中植入后门的概率较低（假设为5%），但仍需谨慎使用，并仔细审查代码及所依赖的第三方库。


**项目地址:** [Anonymous-Family/Zero-day-scanning](https://github.com/Anonymous-Family/Zero-day-scanning)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #5

**来源**: [CVE-2020-1472-B34MR_zeroscan.md](../2020/CVE-2020-1472-B34MR_zeroscan.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获得域管理员权限。

**影响版本:** 受影响的Windows Server版本包括2008 R2到20H2等多个版本，具体版本请参考漏洞库信息。

**利用条件:** 攻击者需要与域控制器建立网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server的Netlogon协议中。攻击者可以通过将Netlogon客户端使用的身份验证凭据中的多个零值设置为全零来利用此漏洞。如果攻击成功，攻击者可以冒充域控制器上的任何计算机（包括域控制器本身），并获得域管理员权限。

**有效性：**
根据漏洞信息和搜索结果，该漏洞POC是有效的，并且已经被广泛利用。

**投毒风险：**
提供的代码（zeroscan）描述中明确声明它是一个漏洞扫描器，而不是漏洞利用工具，并且专门指出它不尝试利用Zerologon漏洞，只是检查是否存在漏洞。代码库借鉴自SecuraBV的CVE-2020-1472检查脚本。虽然zeroscan本身声明不进行利用，但它依赖于其他工具和脚本，这些依赖项可能存在潜在的风险。此外，代码中可能存在作者有意或无意引入的缺陷或后门。考虑到zeroscan的性质，以及它wrapper Impacket等工具，我们无法完全排除投毒的可能性。因此，存在一定比例的投毒风险。 

**利用方式：**

1.  攻击者使用MS-NRPC协议与域控制器建立连接。
2.  攻击者发送特制的身份验证请求，将Netlogon客户端凭据设置为零。
3.  由于Netlogon协议的缺陷，域控制器错误地接受了零凭据，从而允许攻击者通过身份验证。
4.  攻击者现在可以冒充域控制器并执行恶意操作，例如更改域管理员密码或部署恶意软件。
5. 通过rpcdump可以检测MS-PAR/MS-RPRN服务是否开启，为进一步攻击提供信息。
6. 通过检测SMB signing配置，决定后续横向移动的策略。


**项目地址:** [B34MR/zeroscan](https://github.com/B34MR/zeroscan)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #6

**来源**: [CVE-2020-1472-CPO-EH_CVE-2020-1472_ZeroLogonChecker.md](../2020/CVE-2020-1472-CPO-EH_CVE-2020-1472_ZeroLogonChecker.md)

## CVE-2020-1472 (Zerologon) 漏洞检测

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本，具体请参考漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个Windows Netlogon协议中的严重漏洞，允许未经身份验证的攻击者通过MS-NRPC协议连接到域控制器，重置域控制器的机器帐户密码为空，从而获取域管理员权限。提供的漏洞利用代码是一个C#程序，用于**检测**目标域控制器是否存在此漏洞，**并非真正的漏洞利用代码**。该代码通过尝试与目标域控制器建立Netlogon安全通道并执行身份验证来检测漏洞。由于代码本身是漏洞**检测**工具，并非直接进行提权，因此**投毒风险较低**，主要体现在可能被修改为发送大量探测流量进行拒绝服务攻击，或者收集目标服务器信息的可能。代码片段不完整，只能推断出实现逻辑，但未看到恶意代码，初步认为投毒风险概率为10%。

**利用方式：**

1.  攻击者利用MS-NRPC协议的加密缺陷，向域控制器发送一系列特制的Netlogon请求。
2.  这些请求将导致域控制器的机器帐户密码被重置为空字符串。
3.  攻击者随后可以使用空密码来冒充域控制器，并执行各种恶意操作，例如添加新的域管理员帐户或修改现有帐户的权限。

**有效性：**

由于提供的代码是漏洞检测工具，并非漏洞利用工具，所以**有效性体现在能否准确检测出目标是否存在漏洞**。根据漏洞库信息和搜索结果，该漏洞影响多个版本的Windows Server，攻击影响极大。

**参考链接：**
*   https://www.crowdstrike.com/en-us/blog/cve-2020-1472-zerologon-security-advisory/
*   https://msrc.microsoft.com/blog/2020/10/attacks-exploiting-netlogon-vulnerability-cve-2020-1472/
*   https://nvd.nist.gov/vuln/detail/cve-2020-1472

**项目地址:** [CPO-EH/CVE-2020-1472_ZeroLogonChecker](https://github.com/CPO-EH/CVE-2020-1472_ZeroLogonChecker)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #7

**来源**: [CVE-2020-1472-Fa1c0n35_CVE-2020-1472-02-.md](../2020/CVE-2020-1472-Fa1c0n35_CVE-2020-1472-02-.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，可导致域管理员权限被获取

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与域控制器的网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个Windows Netlogon协议中的权限提升漏洞。攻击者可以通过建立一个到域控制器的脆弱的Netlogon安全通道连接来利用此漏洞。漏洞利用代码通过将Netlogon会话密钥重置为零，从而绕过身份验证。提供的`zerologon_tester.py`脚本用于检测目标域控制器是否存在此漏洞。脚本尝试使用全零的challenge和credential进行身份验证。如果成功，则表明目标存在漏洞。虽然脚本的主要目的是测试漏洞是否存在，但潜在的投毒风险在于，攻击者可能修改该脚本以在成功利用漏洞后执行恶意操作，例如安装后门或收集敏感信息。要求Python 3.7或更高版本，以及`requirements.txt`中列出的依赖项。脚本通过`pip install -r requirements.txt`安装依赖。利用方式为：1. 运行`zerologon_tester.py`脚本，指定目标域控制器的NetBIOS名称和IP地址。2. 脚本尝试使用零密钥进行身份验证。3. 如果身份验证成功，脚本会立即终止，表明目标易受攻击。根据漏洞描述，成功利用此漏洞可能允许未经身份验证的攻击者获得域管理员权限，从而完全控制域。

**投毒风险分析：**

*   **README.md:** 描述了脚本的使用方法和漏洞背景，未发现可疑代码。
*   **LICENSE:** MIT许可证，允许自由使用、修改和分发，但也增加了被修改后用于恶意目的的风险。
*   **requirements.txt:** 列出了脚本依赖的Python库。虽然这些库本身是合法的，但攻击者可能替换或篡改这些库的安装源，从而引入恶意代码。impacket库本身如果来源不明，存在一定风险。
*   **zerologon_tester.py:** 脚本的核心代码，实现了漏洞的检测和利用。虽然代码本身看起来是合法的漏洞验证代码，但是仍然存在被篡改的风险，例如添加在成功利用漏洞后执行恶意操作的代码。例如，在`try_zero_authenticate` 函数中，成功绕过身份验证后，可以添加执行任意代码的逻辑。

因此，虽然提供的代码主要是漏洞检测工具，但仍然存在一定的投毒风险。特别是需要注意impacket包的来源可靠性，以及防止`zerologon_tester.py`被篡改添加恶意逻辑。

综合考虑，判定投毒风险为10%。

**项目地址:** [Fa1c0n35/CVE-2020-1472-02-](https://github.com/Fa1c0n35/CVE-2020-1472-02-)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #8

**来源**: [CVE-2020-1472-Fa1c0n35_SecuraBV-CVE-2020-1472.md](../2020/CVE-2020-1472-Fa1c0n35_SecuraBV-CVE-2020-1472.md)

# CVE-2020-1472

> 📦 该CVE有 **31** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-1472-100HnoMeuNome_ZeroLogon-CVE-2020-1472-lab.md](../2020/CVE-2020-1472-100HnoMeuNome_ZeroLogon-CVE-2020-1472-lab.md)

## CVE-2020-1472 Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Netlogon Remote Protocol (MS-NRPC)

**危害等级:** 高危，可能导致域管理员权限提升

**影响版本:** 受影响的Windows Server版本：2008 R2, 2012 / 2012 R2, 2016, 2019，以及2020年8月/9月补丁之前的版本

**利用条件:** 需要位于网络内部，能够与域控制器通信

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Microsoft Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。未经身份验证的攻击者可以通过网络连接到域控制器，并利用该漏洞获取域管理员权限。 

**有效性分析：**
根据搜索结果，该漏洞利用的POC代码已经公开（例如packetstormsecurity.com上的POC）。漏洞库信息也表明该漏洞已被积极利用（`Exploitation: active` in CISA ADP Vulnrichment），所以提供的POC代码大概率是有效的。

**投毒风险分析：**
提供的漏洞利用代码实际上是一个`README.md`文件，该文件仅包含漏洞的描述、利用说明、缓解措施和参考链接。该文件本身不包含任何可执行代码，因此直接的投毒风险较低。但是，参考链接指向的POC代码，可能存在被篡改的风险，间接存在一定的投毒可能。考虑到该仓库只是一个说明文档，实际的漏洞利用需要用户自行下载其他POC代码，因此判定投毒风险为10%。

**利用方式分析：**
1.  **漏洞原理：** 漏洞利用了Netlogon协议中的一个加密缺陷，攻击者可以将Netlogon会话的客户端凭据设置为全零。
2.  **攻击步骤：**
    *   攻击者通过MS-NRPC与域控制器建立连接。
    *   利用漏洞将域控制器的机器帐户密码置零。
    *   使用置零后的密码更改域控制器的机器帐户密码。
    *   通过修改后的机器帐户密码获得域管理员权限。
3. **修复方式：** 安装Microsoft发布的更新补丁，并按照Microsoft的指南进行配置，以强制执行安全的Netlogon通道。

**项目地址:** [100HnoMeuNome/ZeroLogon-CVE-2020-1472-lab](https://github.com/100HnoMeuNome/ZeroLogon-CVE-2020-1472-lab)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #2

**来源**: [CVE-2020-1472-Akash7350_CVE-2020-1472.md](../2020/CVE-2020-1472-Akash7350_CVE-2020-1472.md)

## CVE-2020-1472-Zerologon-特权提升

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本，详见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个影响Microsoft Windows Netlogon Remote Protocol (MS-NRPC) 的特权提升漏洞。未经身份验证的攻击者可以通过与域控制器建立脆弱的Netlogon安全通道连接来利用此漏洞。成功利用该漏洞可能允许攻击者冒充域控制器，并最终获得域管理员权限，从而完全控制整个域。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，此POC代码是有效的。搜索结果中多个链接指向了关于该漏洞的分析和利用文章，证明了该漏洞的可利用性。POC代码描述也表明，它能够重置域控制器的帐户密码为空字符串，从而实现权限提升。

**投毒风险：**
评估POC代码的投毒风险较低，大约为10%。代码主要逻辑集中在利用Netlogon协议的加密缺陷，通过重复的认证尝试来绕过身份验证。虽然存在一定的风险，例如代码的维护者可能在未来版本中引入恶意代码，或者安装过程中依赖的第三方库存在安全问题，但从当前提供的代码来看，直接包含恶意、后门代码的可能性不大。该代码更侧重于漏洞利用的验证和概念证明。

**利用方式：**
1.  **建立连接：** 攻击者使用MS-NRPC协议与目标域控制器建立网络连接。
2.  **零化凭据：** 攻击者发送一个包含全零凭据的Netlogon身份验证请求。
3.  **重复尝试：** 由于协议的加密缺陷，攻击者重复发送此请求多次。每次尝试都有可能成功绕过身份验证。
4.  **密码重置：** 成功绕过身份验证后，攻击者将域控制器的帐户密码重置为空字符串。
5.  **权限提升：** 此时，攻击者可以利用空密码来冒充域控制器并获取域管理员权限。

需要注意的是，成功利用此漏洞需要目标域控制器未安装相应的安全补丁。此外，利用该漏洞可能会导致域环境不稳定甚至崩溃，因此在生产环境中进行测试需要谨慎。

**项目地址:** [Akash7350/CVE-2020-1472](https://github.com/Akash7350/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #3

**来源**: [CVE-2020-1472-Anonymous-Family_CVE-2020-1472.md](../2020/CVE-2020-1472-Anonymous-Family_CVE-2020-1472.md)

## CVE-2020-1472 Zerologon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本见漏洞库信息

**利用条件:** 需要位于目标域控制器的网络中

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-1472（Zerologon）是一个存在于Windows Server Netlogon Remote Protocol (MS-NRPC) 中的特权提升漏洞。攻击者通过与域控制器建立脆弱的Netlogon安全通道连接，可以运行特制的应用程序并获取域管理员权限。

**有效性分析：**

提供的POC代码 `zerologon_tester.py` 旨在检测目标域控制器是否存在Zerologon漏洞。该脚本通过尝试使用全零的challenge和credential来进行Netlogon身份验证绕过。如果域控制器存在漏洞，则身份验证将成功，脚本会立即终止。如果域控制器已打补丁，脚本会在多次尝试后放弃并认为目标不存在漏洞（存在极低的假阴性概率）。根据搜索引擎结果，该漏洞利用代码的思路和方法与公开的漏洞利用方式一致，因此判断提供的POC代码是有效的。

**投毒风险分析：**

通过对Dockerfile，requirements.txt和zerologon_tester.py的代码分析，该仓库主要包含漏洞利用的测试代码和依赖项，未发现明显的恶意代码或后门，代码的功能主要是实现对Zerologon漏洞的检测,因此投毒风险较低。

**利用方式：**

1.  **漏洞利用阶段：** 攻击者首先需要与目标域控制器建立网络连接。然后，攻击者运行Zerologon漏洞利用脚本（例如提供的`zerologon_tester.py`的修改版本），该脚本通过MS-NRPC协议发送特制的身份验证请求，利用加密算法中的漏洞将域控制器的机器帐户密码置零。
2.  **权限提升阶段：** 成功将域控制器的机器帐户密码置零后，攻击者可以使用该零密码来获得域控制器的身份验证，从而完全控制域。
3.  **持久化和横向移动（可选）：** 攻击者获得域管理员权限后，可以进行持久化操作（例如创建新的管理员帐户）并在域内进行横向移动，以控制更多系统和数据。

**项目地址:** [Anonymous-Family/CVE-2020-1472](https://github.com/Anonymous-Family/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #4

**来源**: [CVE-2020-1472-Anonymous-Family_Zero-day-scanning.md](../2020/CVE-2020-1472-Anonymous-Family_Zero-day-scanning.md)

## CVE-2020-1472 Zerologon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本，详见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

Zerologon (CVE-2020-1472) 是一个严重的权限提升漏洞，存在于 Netlogon Remote Protocol (MS-NRPC) 中。未经身份验证的攻击者可以通过建立与域控制器的脆弱 Netlogon 安全通道连接来利用此漏洞。攻击成功后，攻击者可以运行特制的应用程序，从而完全控制域控制器。 

**利用方式：**

1.  **利用MS-NRPC协议：** 攻击者利用 MS-NRPC 协议连接到域控制器。
2.  **重置域控制器的密码：** 攻击者通过将域控制器的计算机密码设置为已知值（通常是空值），从而破坏身份验证过程。
3.  **获取域管理员权限：** 密码重置后，攻击者可以冒充域控制器并获取域管理员权限。

**有效性：**

提供的漏洞利用代码 (zeroscan) 本身是一个扫描器，用于检测目标域控制器是否存在 Zerologon 漏洞、MS-PAR/MS-RPRN 协议是否暴露以及 SMBv2 签名配置。它**不**尝试实际利用该漏洞，但是它使用基于已知的POC修改的代码库来检查漏洞，因此可以判断存在可利用性。

**投毒风险：**

分析提供的代码，投毒风险较低，但不能完全排除。理由如下：

*   **开源代码：** 代码托管在 GitHub 上，具有一定的透明度，更容易受到社区审查。
*   **扫描器功能：** 该工具主要功能是扫描，而非直接利用，因此隐藏恶意代码的动机相对较低。
*   **依赖第三方库：** 代码依赖于 Impacket 和 Nmap 等第三方库，攻击者可能尝试利用这些依赖项中的漏洞进行投毒攻击。但是，直接在zeroscan本身投毒的概率较低。
*  **POC的免责声明：**  `Codebase borrowed from: https://github.com/Anonymous-Family/CVE-2020-1472.git` 声明中，代码借鉴了其他库,存在一定的代码风险.

因此，尽管直接在 zeroscan 代码中植入后门的概率较低（假设为5%），但仍需谨慎使用，并仔细审查代码及所依赖的第三方库。


**项目地址:** [Anonymous-Family/Zero-day-scanning](https://github.com/Anonymous-Family/Zero-day-scanning)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #5

**来源**: [CVE-2020-1472-B34MR_zeroscan.md](../2020/CVE-2020-1472-B34MR_zeroscan.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获得域管理员权限。

**影响版本:** 受影响的Windows Server版本包括2008 R2到20H2等多个版本，具体版本请参考漏洞库信息。

**利用条件:** 攻击者需要与域控制器建立网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server的Netlogon协议中。攻击者可以通过将Netlogon客户端使用的身份验证凭据中的多个零值设置为全零来利用此漏洞。如果攻击成功，攻击者可以冒充域控制器上的任何计算机（包括域控制器本身），并获得域管理员权限。

**有效性：**
根据漏洞信息和搜索结果，该漏洞POC是有效的，并且已经被广泛利用。

**投毒风险：**
提供的代码（zeroscan）描述中明确声明它是一个漏洞扫描器，而不是漏洞利用工具，并且专门指出它不尝试利用Zerologon漏洞，只是检查是否存在漏洞。代码库借鉴自SecuraBV的CVE-2020-1472检查脚本。虽然zeroscan本身声明不进行利用，但它依赖于其他工具和脚本，这些依赖项可能存在潜在的风险。此外，代码中可能存在作者有意或无意引入的缺陷或后门。考虑到zeroscan的性质，以及它wrapper Impacket等工具，我们无法完全排除投毒的可能性。因此，存在一定比例的投毒风险。 

**利用方式：**

1.  攻击者使用MS-NRPC协议与域控制器建立连接。
2.  攻击者发送特制的身份验证请求，将Netlogon客户端凭据设置为零。
3.  由于Netlogon协议的缺陷，域控制器错误地接受了零凭据，从而允许攻击者通过身份验证。
4.  攻击者现在可以冒充域控制器并执行恶意操作，例如更改域管理员密码或部署恶意软件。
5. 通过rpcdump可以检测MS-PAR/MS-RPRN服务是否开启，为进一步攻击提供信息。
6. 通过检测SMB signing配置，决定后续横向移动的策略。


**项目地址:** [B34MR/zeroscan](https://github.com/B34MR/zeroscan)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #6

**来源**: [CVE-2020-1472-CPO-EH_CVE-2020-1472_ZeroLogonChecker.md](../2020/CVE-2020-1472-CPO-EH_CVE-2020-1472_ZeroLogonChecker.md)

## CVE-2020-1472 (Zerologon) 漏洞检测

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本，具体请参考漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个Windows Netlogon协议中的严重漏洞，允许未经身份验证的攻击者通过MS-NRPC协议连接到域控制器，重置域控制器的机器帐户密码为空，从而获取域管理员权限。提供的漏洞利用代码是一个C#程序，用于**检测**目标域控制器是否存在此漏洞，**并非真正的漏洞利用代码**。该代码通过尝试与目标域控制器建立Netlogon安全通道并执行身份验证来检测漏洞。由于代码本身是漏洞**检测**工具，并非直接进行提权，因此**投毒风险较低**，主要体现在可能被修改为发送大量探测流量进行拒绝服务攻击，或者收集目标服务器信息的可能。代码片段不完整，只能推断出实现逻辑，但未看到恶意代码，初步认为投毒风险概率为10%。

**利用方式：**

1.  攻击者利用MS-NRPC协议的加密缺陷，向域控制器发送一系列特制的Netlogon请求。
2.  这些请求将导致域控制器的机器帐户密码被重置为空字符串。
3.  攻击者随后可以使用空密码来冒充域控制器，并执行各种恶意操作，例如添加新的域管理员帐户或修改现有帐户的权限。

**有效性：**

由于提供的代码是漏洞检测工具，并非漏洞利用工具，所以**有效性体现在能否准确检测出目标是否存在漏洞**。根据漏洞库信息和搜索结果，该漏洞影响多个版本的Windows Server，攻击影响极大。

**参考链接：**
*   https://www.crowdstrike.com/en-us/blog/cve-2020-1472-zerologon-security-advisory/
*   https://msrc.microsoft.com/blog/2020/10/attacks-exploiting-netlogon-vulnerability-cve-2020-1472/
*   https://nvd.nist.gov/vuln/detail/cve-2020-1472

**项目地址:** [CPO-EH/CVE-2020-1472_ZeroLogonChecker](https://github.com/CPO-EH/CVE-2020-1472_ZeroLogonChecker)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #7

**来源**: [CVE-2020-1472-Fa1c0n35_CVE-2020-1472-02-.md](../2020/CVE-2020-1472-Fa1c0n35_CVE-2020-1472-02-.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，可导致域管理员权限被获取

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与域控制器的网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个Windows Netlogon协议中的权限提升漏洞。攻击者可以通过建立一个到域控制器的脆弱的Netlogon安全通道连接来利用此漏洞。漏洞利用代码通过将Netlogon会话密钥重置为零，从而绕过身份验证。提供的`zerologon_tester.py`脚本用于检测目标域控制器是否存在此漏洞。脚本尝试使用全零的challenge和credential进行身份验证。如果成功，则表明目标存在漏洞。虽然脚本的主要目的是测试漏洞是否存在，但潜在的投毒风险在于，攻击者可能修改该脚本以在成功利用漏洞后执行恶意操作，例如安装后门或收集敏感信息。要求Python 3.7或更高版本，以及`requirements.txt`中列出的依赖项。脚本通过`pip install -r requirements.txt`安装依赖。利用方式为：1. 运行`zerologon_tester.py`脚本，指定目标域控制器的NetBIOS名称和IP地址。2. 脚本尝试使用零密钥进行身份验证。3. 如果身份验证成功，脚本会立即终止，表明目标易受攻击。根据漏洞描述，成功利用此漏洞可能允许未经身份验证的攻击者获得域管理员权限，从而完全控制域。

**投毒风险分析：**

*   **README.md:** 描述了脚本的使用方法和漏洞背景，未发现可疑代码。
*   **LICENSE:** MIT许可证，允许自由使用、修改和分发，但也增加了被修改后用于恶意目的的风险。
*   **requirements.txt:** 列出了脚本依赖的Python库。虽然这些库本身是合法的，但攻击者可能替换或篡改这些库的安装源，从而引入恶意代码。impacket库本身如果来源不明，存在一定风险。
*   **zerologon_tester.py:** 脚本的核心代码，实现了漏洞的检测和利用。虽然代码本身看起来是合法的漏洞验证代码，但是仍然存在被篡改的风险，例如添加在成功利用漏洞后执行恶意操作的代码。例如，在`try_zero_authenticate` 函数中，成功绕过身份验证后，可以添加执行任意代码的逻辑。

因此，虽然提供的代码主要是漏洞检测工具，但仍然存在一定的投毒风险。特别是需要注意impacket包的来源可靠性，以及防止`zerologon_tester.py`被篡改添加恶意逻辑。

综合考虑，判定投毒风险为10%。

**项目地址:** [Fa1c0n35/CVE-2020-1472-02-](https://github.com/Fa1c0n35/CVE-2020-1472-02-)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #8

**来源**: [CVE-2020-1472-Fa1c0n35_SecuraBV-CVE-2020-1472.md](../2020/CVE-2020-1472-Fa1c0n35_SecuraBV-CVE-2020-1472.md)

# CVE-2020-1472

> 📦 该CVE有 **31** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-1472-100HnoMeuNome_ZeroLogon-CVE-2020-1472-lab.md](../2020/CVE-2020-1472-100HnoMeuNome_ZeroLogon-CVE-2020-1472-lab.md)

## CVE-2020-1472 Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Netlogon Remote Protocol (MS-NRPC)

**危害等级:** 高危，可能导致域管理员权限提升

**影响版本:** 受影响的Windows Server版本：2008 R2, 2012 / 2012 R2, 2016, 2019，以及2020年8月/9月补丁之前的版本

**利用条件:** 需要位于网络内部，能够与域控制器通信

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Microsoft Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。未经身份验证的攻击者可以通过网络连接到域控制器，并利用该漏洞获取域管理员权限。 

**有效性分析：**
根据搜索结果，该漏洞利用的POC代码已经公开（例如packetstormsecurity.com上的POC）。漏洞库信息也表明该漏洞已被积极利用（`Exploitation: active` in CISA ADP Vulnrichment），所以提供的POC代码大概率是有效的。

**投毒风险分析：**
提供的漏洞利用代码实际上是一个`README.md`文件，该文件仅包含漏洞的描述、利用说明、缓解措施和参考链接。该文件本身不包含任何可执行代码，因此直接的投毒风险较低。但是，参考链接指向的POC代码，可能存在被篡改的风险，间接存在一定的投毒可能。考虑到该仓库只是一个说明文档，实际的漏洞利用需要用户自行下载其他POC代码，因此判定投毒风险为10%。

**利用方式分析：**
1.  **漏洞原理：** 漏洞利用了Netlogon协议中的一个加密缺陷，攻击者可以将Netlogon会话的客户端凭据设置为全零。
2.  **攻击步骤：**
    *   攻击者通过MS-NRPC与域控制器建立连接。
    *   利用漏洞将域控制器的机器帐户密码置零。
    *   使用置零后的密码更改域控制器的机器帐户密码。
    *   通过修改后的机器帐户密码获得域管理员权限。
3. **修复方式：** 安装Microsoft发布的更新补丁，并按照Microsoft的指南进行配置，以强制执行安全的Netlogon通道。

**项目地址:** [100HnoMeuNome/ZeroLogon-CVE-2020-1472-lab](https://github.com/100HnoMeuNome/ZeroLogon-CVE-2020-1472-lab)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #2

**来源**: [CVE-2020-1472-Akash7350_CVE-2020-1472.md](../2020/CVE-2020-1472-Akash7350_CVE-2020-1472.md)

## CVE-2020-1472-Zerologon-特权提升

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本，详见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个影响Microsoft Windows Netlogon Remote Protocol (MS-NRPC) 的特权提升漏洞。未经身份验证的攻击者可以通过与域控制器建立脆弱的Netlogon安全通道连接来利用此漏洞。成功利用该漏洞可能允许攻击者冒充域控制器，并最终获得域管理员权限，从而完全控制整个域。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，此POC代码是有效的。搜索结果中多个链接指向了关于该漏洞的分析和利用文章，证明了该漏洞的可利用性。POC代码描述也表明，它能够重置域控制器的帐户密码为空字符串，从而实现权限提升。

**投毒风险：**
评估POC代码的投毒风险较低，大约为10%。代码主要逻辑集中在利用Netlogon协议的加密缺陷，通过重复的认证尝试来绕过身份验证。虽然存在一定的风险，例如代码的维护者可能在未来版本中引入恶意代码，或者安装过程中依赖的第三方库存在安全问题，但从当前提供的代码来看，直接包含恶意、后门代码的可能性不大。该代码更侧重于漏洞利用的验证和概念证明。

**利用方式：**
1.  **建立连接：** 攻击者使用MS-NRPC协议与目标域控制器建立网络连接。
2.  **零化凭据：** 攻击者发送一个包含全零凭据的Netlogon身份验证请求。
3.  **重复尝试：** 由于协议的加密缺陷，攻击者重复发送此请求多次。每次尝试都有可能成功绕过身份验证。
4.  **密码重置：** 成功绕过身份验证后，攻击者将域控制器的帐户密码重置为空字符串。
5.  **权限提升：** 此时，攻击者可以利用空密码来冒充域控制器并获取域管理员权限。

需要注意的是，成功利用此漏洞需要目标域控制器未安装相应的安全补丁。此外，利用该漏洞可能会导致域环境不稳定甚至崩溃，因此在生产环境中进行测试需要谨慎。

**项目地址:** [Akash7350/CVE-2020-1472](https://github.com/Akash7350/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #3

**来源**: [CVE-2020-1472-Anonymous-Family_CVE-2020-1472.md](../2020/CVE-2020-1472-Anonymous-Family_CVE-2020-1472.md)

## CVE-2020-1472 Zerologon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本见漏洞库信息

**利用条件:** 需要位于目标域控制器的网络中

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-1472（Zerologon）是一个存在于Windows Server Netlogon Remote Protocol (MS-NRPC) 中的特权提升漏洞。攻击者通过与域控制器建立脆弱的Netlogon安全通道连接，可以运行特制的应用程序并获取域管理员权限。

**有效性分析：**

提供的POC代码 `zerologon_tester.py` 旨在检测目标域控制器是否存在Zerologon漏洞。该脚本通过尝试使用全零的challenge和credential来进行Netlogon身份验证绕过。如果域控制器存在漏洞，则身份验证将成功，脚本会立即终止。如果域控制器已打补丁，脚本会在多次尝试后放弃并认为目标不存在漏洞（存在极低的假阴性概率）。根据搜索引擎结果，该漏洞利用代码的思路和方法与公开的漏洞利用方式一致，因此判断提供的POC代码是有效的。

**投毒风险分析：**

通过对Dockerfile，requirements.txt和zerologon_tester.py的代码分析，该仓库主要包含漏洞利用的测试代码和依赖项，未发现明显的恶意代码或后门，代码的功能主要是实现对Zerologon漏洞的检测,因此投毒风险较低。

**利用方式：**

1.  **漏洞利用阶段：** 攻击者首先需要与目标域控制器建立网络连接。然后，攻击者运行Zerologon漏洞利用脚本（例如提供的`zerologon_tester.py`的修改版本），该脚本通过MS-NRPC协议发送特制的身份验证请求，利用加密算法中的漏洞将域控制器的机器帐户密码置零。
2.  **权限提升阶段：** 成功将域控制器的机器帐户密码置零后，攻击者可以使用该零密码来获得域控制器的身份验证，从而完全控制域。
3.  **持久化和横向移动（可选）：** 攻击者获得域管理员权限后，可以进行持久化操作（例如创建新的管理员帐户）并在域内进行横向移动，以控制更多系统和数据。

**项目地址:** [Anonymous-Family/CVE-2020-1472](https://github.com/Anonymous-Family/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #4

**来源**: [CVE-2020-1472-Anonymous-Family_Zero-day-scanning.md](../2020/CVE-2020-1472-Anonymous-Family_Zero-day-scanning.md)

## CVE-2020-1472 Zerologon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本，详见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

Zerologon (CVE-2020-1472) 是一个严重的权限提升漏洞，存在于 Netlogon Remote Protocol (MS-NRPC) 中。未经身份验证的攻击者可以通过建立与域控制器的脆弱 Netlogon 安全通道连接来利用此漏洞。攻击成功后，攻击者可以运行特制的应用程序，从而完全控制域控制器。 

**利用方式：**

1.  **利用MS-NRPC协议：** 攻击者利用 MS-NRPC 协议连接到域控制器。
2.  **重置域控制器的密码：** 攻击者通过将域控制器的计算机密码设置为已知值（通常是空值），从而破坏身份验证过程。
3.  **获取域管理员权限：** 密码重置后，攻击者可以冒充域控制器并获取域管理员权限。

**有效性：**

提供的漏洞利用代码 (zeroscan) 本身是一个扫描器，用于检测目标域控制器是否存在 Zerologon 漏洞、MS-PAR/MS-RPRN 协议是否暴露以及 SMBv2 签名配置。它**不**尝试实际利用该漏洞，但是它使用基于已知的POC修改的代码库来检查漏洞，因此可以判断存在可利用性。

**投毒风险：**

分析提供的代码，投毒风险较低，但不能完全排除。理由如下：

*   **开源代码：** 代码托管在 GitHub 上，具有一定的透明度，更容易受到社区审查。
*   **扫描器功能：** 该工具主要功能是扫描，而非直接利用，因此隐藏恶意代码的动机相对较低。
*   **依赖第三方库：** 代码依赖于 Impacket 和 Nmap 等第三方库，攻击者可能尝试利用这些依赖项中的漏洞进行投毒攻击。但是，直接在zeroscan本身投毒的概率较低。
*  **POC的免责声明：**  `Codebase borrowed from: https://github.com/Anonymous-Family/CVE-2020-1472.git` 声明中，代码借鉴了其他库,存在一定的代码风险.

因此，尽管直接在 zeroscan 代码中植入后门的概率较低（假设为5%），但仍需谨慎使用，并仔细审查代码及所依赖的第三方库。


**项目地址:** [Anonymous-Family/Zero-day-scanning](https://github.com/Anonymous-Family/Zero-day-scanning)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #5

**来源**: [CVE-2020-1472-B34MR_zeroscan.md](../2020/CVE-2020-1472-B34MR_zeroscan.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获得域管理员权限。

**影响版本:** 受影响的Windows Server版本包括2008 R2到20H2等多个版本，具体版本请参考漏洞库信息。

**利用条件:** 攻击者需要与域控制器建立网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server的Netlogon协议中。攻击者可以通过将Netlogon客户端使用的身份验证凭据中的多个零值设置为全零来利用此漏洞。如果攻击成功，攻击者可以冒充域控制器上的任何计算机（包括域控制器本身），并获得域管理员权限。

**有效性：**
根据漏洞信息和搜索结果，该漏洞POC是有效的，并且已经被广泛利用。

**投毒风险：**
提供的代码（zeroscan）描述中明确声明它是一个漏洞扫描器，而不是漏洞利用工具，并且专门指出它不尝试利用Zerologon漏洞，只是检查是否存在漏洞。代码库借鉴自SecuraBV的CVE-2020-1472检查脚本。虽然zeroscan本身声明不进行利用，但它依赖于其他工具和脚本，这些依赖项可能存在潜在的风险。此外，代码中可能存在作者有意或无意引入的缺陷或后门。考虑到zeroscan的性质，以及它wrapper Impacket等工具，我们无法完全排除投毒的可能性。因此，存在一定比例的投毒风险。 

**利用方式：**

1.  攻击者使用MS-NRPC协议与域控制器建立连接。
2.  攻击者发送特制的身份验证请求，将Netlogon客户端凭据设置为零。
3.  由于Netlogon协议的缺陷，域控制器错误地接受了零凭据，从而允许攻击者通过身份验证。
4.  攻击者现在可以冒充域控制器并执行恶意操作，例如更改域管理员密码或部署恶意软件。
5. 通过rpcdump可以检测MS-PAR/MS-RPRN服务是否开启，为进一步攻击提供信息。
6. 通过检测SMB signing配置，决定后续横向移动的策略。


**项目地址:** [B34MR/zeroscan](https://github.com/B34MR/zeroscan)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #6

**来源**: [CVE-2020-1472-CPO-EH_CVE-2020-1472_ZeroLogonChecker.md](../2020/CVE-2020-1472-CPO-EH_CVE-2020-1472_ZeroLogonChecker.md)

## CVE-2020-1472 (Zerologon) 漏洞检测

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本，具体请参考漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个Windows Netlogon协议中的严重漏洞，允许未经身份验证的攻击者通过MS-NRPC协议连接到域控制器，重置域控制器的机器帐户密码为空，从而获取域管理员权限。提供的漏洞利用代码是一个C#程序，用于**检测**目标域控制器是否存在此漏洞，**并非真正的漏洞利用代码**。该代码通过尝试与目标域控制器建立Netlogon安全通道并执行身份验证来检测漏洞。由于代码本身是漏洞**检测**工具，并非直接进行提权，因此**投毒风险较低**，主要体现在可能被修改为发送大量探测流量进行拒绝服务攻击，或者收集目标服务器信息的可能。代码片段不完整，只能推断出实现逻辑，但未看到恶意代码，初步认为投毒风险概率为10%。

**利用方式：**

1.  攻击者利用MS-NRPC协议的加密缺陷，向域控制器发送一系列特制的Netlogon请求。
2.  这些请求将导致域控制器的机器帐户密码被重置为空字符串。
3.  攻击者随后可以使用空密码来冒充域控制器，并执行各种恶意操作，例如添加新的域管理员帐户或修改现有帐户的权限。

**有效性：**

由于提供的代码是漏洞检测工具，并非漏洞利用工具，所以**有效性体现在能否准确检测出目标是否存在漏洞**。根据漏洞库信息和搜索结果，该漏洞影响多个版本的Windows Server，攻击影响极大。

**参考链接：**
*   https://www.crowdstrike.com/en-us/blog/cve-2020-1472-zerologon-security-advisory/
*   https://msrc.microsoft.com/blog/2020/10/attacks-exploiting-netlogon-vulnerability-cve-2020-1472/
*   https://nvd.nist.gov/vuln/detail/cve-2020-1472

**项目地址:** [CPO-EH/CVE-2020-1472_ZeroLogonChecker](https://github.com/CPO-EH/CVE-2020-1472_ZeroLogonChecker)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #7

**来源**: [CVE-2020-1472-Fa1c0n35_CVE-2020-1472-02-.md](../2020/CVE-2020-1472-Fa1c0n35_CVE-2020-1472-02-.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，可导致域管理员权限被获取

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与域控制器的网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个Windows Netlogon协议中的权限提升漏洞。攻击者可以通过建立一个到域控制器的脆弱的Netlogon安全通道连接来利用此漏洞。漏洞利用代码通过将Netlogon会话密钥重置为零，从而绕过身份验证。提供的`zerologon_tester.py`脚本用于检测目标域控制器是否存在此漏洞。脚本尝试使用全零的challenge和credential进行身份验证。如果成功，则表明目标存在漏洞。虽然脚本的主要目的是测试漏洞是否存在，但潜在的投毒风险在于，攻击者可能修改该脚本以在成功利用漏洞后执行恶意操作，例如安装后门或收集敏感信息。要求Python 3.7或更高版本，以及`requirements.txt`中列出的依赖项。脚本通过`pip install -r requirements.txt`安装依赖。利用方式为：1. 运行`zerologon_tester.py`脚本，指定目标域控制器的NetBIOS名称和IP地址。2. 脚本尝试使用零密钥进行身份验证。3. 如果身份验证成功，脚本会立即终止，表明目标易受攻击。根据漏洞描述，成功利用此漏洞可能允许未经身份验证的攻击者获得域管理员权限，从而完全控制域。

**投毒风险分析：**

*   **README.md:** 描述了脚本的使用方法和漏洞背景，未发现可疑代码。
*   **LICENSE:** MIT许可证，允许自由使用、修改和分发，但也增加了被修改后用于恶意目的的风险。
*   **requirements.txt:** 列出了脚本依赖的Python库。虽然这些库本身是合法的，但攻击者可能替换或篡改这些库的安装源，从而引入恶意代码。impacket库本身如果来源不明，存在一定风险。
*   **zerologon_tester.py:** 脚本的核心代码，实现了漏洞的检测和利用。虽然代码本身看起来是合法的漏洞验证代码，但是仍然存在被篡改的风险，例如添加在成功利用漏洞后执行恶意操作的代码。例如，在`try_zero_authenticate` 函数中，成功绕过身份验证后，可以添加执行任意代码的逻辑。

因此，虽然提供的代码主要是漏洞检测工具，但仍然存在一定的投毒风险。特别是需要注意impacket包的来源可靠性，以及防止`zerologon_tester.py`被篡改添加恶意逻辑。

综合考虑，判定投毒风险为10%。

**项目地址:** [Fa1c0n35/CVE-2020-1472-02-](https://github.com/Fa1c0n35/CVE-2020-1472-02-)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #8

**来源**: [CVE-2020-1472-Fa1c0n35_SecuraBV-CVE-2020-1472.md](../2020/CVE-2020-1472-Fa1c0n35_SecuraBV-CVE-2020-1472.md)

# CVE-2020-1472

> 📦 该CVE有 **31** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-1472-100HnoMeuNome_ZeroLogon-CVE-2020-1472-lab.md](../2020/CVE-2020-1472-100HnoMeuNome_ZeroLogon-CVE-2020-1472-lab.md)

## CVE-2020-1472 Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Netlogon Remote Protocol (MS-NRPC)

**危害等级:** 高危，可能导致域管理员权限提升

**影响版本:** 受影响的Windows Server版本：2008 R2, 2012 / 2012 R2, 2016, 2019，以及2020年8月/9月补丁之前的版本

**利用条件:** 需要位于网络内部，能够与域控制器通信

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Microsoft Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。未经身份验证的攻击者可以通过网络连接到域控制器，并利用该漏洞获取域管理员权限。 

**有效性分析：**
根据搜索结果，该漏洞利用的POC代码已经公开（例如packetstormsecurity.com上的POC）。漏洞库信息也表明该漏洞已被积极利用（`Exploitation: active` in CISA ADP Vulnrichment），所以提供的POC代码大概率是有效的。

**投毒风险分析：**
提供的漏洞利用代码实际上是一个`README.md`文件，该文件仅包含漏洞的描述、利用说明、缓解措施和参考链接。该文件本身不包含任何可执行代码，因此直接的投毒风险较低。但是，参考链接指向的POC代码，可能存在被篡改的风险，间接存在一定的投毒可能。考虑到该仓库只是一个说明文档，实际的漏洞利用需要用户自行下载其他POC代码，因此判定投毒风险为10%。

**利用方式分析：**
1.  **漏洞原理：** 漏洞利用了Netlogon协议中的一个加密缺陷，攻击者可以将Netlogon会话的客户端凭据设置为全零。
2.  **攻击步骤：**
    *   攻击者通过MS-NRPC与域控制器建立连接。
    *   利用漏洞将域控制器的机器帐户密码置零。
    *   使用置零后的密码更改域控制器的机器帐户密码。
    *   通过修改后的机器帐户密码获得域管理员权限。
3. **修复方式：** 安装Microsoft发布的更新补丁，并按照Microsoft的指南进行配置，以强制执行安全的Netlogon通道。

**项目地址:** [100HnoMeuNome/ZeroLogon-CVE-2020-1472-lab](https://github.com/100HnoMeuNome/ZeroLogon-CVE-2020-1472-lab)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #2

**来源**: [CVE-2020-1472-Akash7350_CVE-2020-1472.md](../2020/CVE-2020-1472-Akash7350_CVE-2020-1472.md)

## CVE-2020-1472-Zerologon-特权提升

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本，详见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个影响Microsoft Windows Netlogon Remote Protocol (MS-NRPC) 的特权提升漏洞。未经身份验证的攻击者可以通过与域控制器建立脆弱的Netlogon安全通道连接来利用此漏洞。成功利用该漏洞可能允许攻击者冒充域控制器，并最终获得域管理员权限，从而完全控制整个域。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，此POC代码是有效的。搜索结果中多个链接指向了关于该漏洞的分析和利用文章，证明了该漏洞的可利用性。POC代码描述也表明，它能够重置域控制器的帐户密码为空字符串，从而实现权限提升。

**投毒风险：**
评估POC代码的投毒风险较低，大约为10%。代码主要逻辑集中在利用Netlogon协议的加密缺陷，通过重复的认证尝试来绕过身份验证。虽然存在一定的风险，例如代码的维护者可能在未来版本中引入恶意代码，或者安装过程中依赖的第三方库存在安全问题，但从当前提供的代码来看，直接包含恶意、后门代码的可能性不大。该代码更侧重于漏洞利用的验证和概念证明。

**利用方式：**
1.  **建立连接：** 攻击者使用MS-NRPC协议与目标域控制器建立网络连接。
2.  **零化凭据：** 攻击者发送一个包含全零凭据的Netlogon身份验证请求。
3.  **重复尝试：** 由于协议的加密缺陷，攻击者重复发送此请求多次。每次尝试都有可能成功绕过身份验证。
4.  **密码重置：** 成功绕过身份验证后，攻击者将域控制器的帐户密码重置为空字符串。
5.  **权限提升：** 此时，攻击者可以利用空密码来冒充域控制器并获取域管理员权限。

需要注意的是，成功利用此漏洞需要目标域控制器未安装相应的安全补丁。此外，利用该漏洞可能会导致域环境不稳定甚至崩溃，因此在生产环境中进行测试需要谨慎。

**项目地址:** [Akash7350/CVE-2020-1472](https://github.com/Akash7350/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #3

**来源**: [CVE-2020-1472-Anonymous-Family_CVE-2020-1472.md](../2020/CVE-2020-1472-Anonymous-Family_CVE-2020-1472.md)

## CVE-2020-1472 Zerologon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本见漏洞库信息

**利用条件:** 需要位于目标域控制器的网络中

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-1472（Zerologon）是一个存在于Windows Server Netlogon Remote Protocol (MS-NRPC) 中的特权提升漏洞。攻击者通过与域控制器建立脆弱的Netlogon安全通道连接，可以运行特制的应用程序并获取域管理员权限。

**有效性分析：**

提供的POC代码 `zerologon_tester.py` 旨在检测目标域控制器是否存在Zerologon漏洞。该脚本通过尝试使用全零的challenge和credential来进行Netlogon身份验证绕过。如果域控制器存在漏洞，则身份验证将成功，脚本会立即终止。如果域控制器已打补丁，脚本会在多次尝试后放弃并认为目标不存在漏洞（存在极低的假阴性概率）。根据搜索引擎结果，该漏洞利用代码的思路和方法与公开的漏洞利用方式一致，因此判断提供的POC代码是有效的。

**投毒风险分析：**

通过对Dockerfile，requirements.txt和zerologon_tester.py的代码分析，该仓库主要包含漏洞利用的测试代码和依赖项，未发现明显的恶意代码或后门，代码的功能主要是实现对Zerologon漏洞的检测,因此投毒风险较低。

**利用方式：**

1.  **漏洞利用阶段：** 攻击者首先需要与目标域控制器建立网络连接。然后，攻击者运行Zerologon漏洞利用脚本（例如提供的`zerologon_tester.py`的修改版本），该脚本通过MS-NRPC协议发送特制的身份验证请求，利用加密算法中的漏洞将域控制器的机器帐户密码置零。
2.  **权限提升阶段：** 成功将域控制器的机器帐户密码置零后，攻击者可以使用该零密码来获得域控制器的身份验证，从而完全控制域。
3.  **持久化和横向移动（可选）：** 攻击者获得域管理员权限后，可以进行持久化操作（例如创建新的管理员帐户）并在域内进行横向移动，以控制更多系统和数据。

**项目地址:** [Anonymous-Family/CVE-2020-1472](https://github.com/Anonymous-Family/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #4

**来源**: [CVE-2020-1472-Anonymous-Family_Zero-day-scanning.md](../2020/CVE-2020-1472-Anonymous-Family_Zero-day-scanning.md)

## CVE-2020-1472 Zerologon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本，详见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

Zerologon (CVE-2020-1472) 是一个严重的权限提升漏洞，存在于 Netlogon Remote Protocol (MS-NRPC) 中。未经身份验证的攻击者可以通过建立与域控制器的脆弱 Netlogon 安全通道连接来利用此漏洞。攻击成功后，攻击者可以运行特制的应用程序，从而完全控制域控制器。 

**利用方式：**

1.  **利用MS-NRPC协议：** 攻击者利用 MS-NRPC 协议连接到域控制器。
2.  **重置域控制器的密码：** 攻击者通过将域控制器的计算机密码设置为已知值（通常是空值），从而破坏身份验证过程。
3.  **获取域管理员权限：** 密码重置后，攻击者可以冒充域控制器并获取域管理员权限。

**有效性：**

提供的漏洞利用代码 (zeroscan) 本身是一个扫描器，用于检测目标域控制器是否存在 Zerologon 漏洞、MS-PAR/MS-RPRN 协议是否暴露以及 SMBv2 签名配置。它**不**尝试实际利用该漏洞，但是它使用基于已知的POC修改的代码库来检查漏洞，因此可以判断存在可利用性。

**投毒风险：**

分析提供的代码，投毒风险较低，但不能完全排除。理由如下：

*   **开源代码：** 代码托管在 GitHub 上，具有一定的透明度，更容易受到社区审查。
*   **扫描器功能：** 该工具主要功能是扫描，而非直接利用，因此隐藏恶意代码的动机相对较低。
*   **依赖第三方库：** 代码依赖于 Impacket 和 Nmap 等第三方库，攻击者可能尝试利用这些依赖项中的漏洞进行投毒攻击。但是，直接在zeroscan本身投毒的概率较低。
*  **POC的免责声明：**  `Codebase borrowed from: https://github.com/Anonymous-Family/CVE-2020-1472.git` 声明中，代码借鉴了其他库,存在一定的代码风险.

因此，尽管直接在 zeroscan 代码中植入后门的概率较低（假设为5%），但仍需谨慎使用，并仔细审查代码及所依赖的第三方库。


**项目地址:** [Anonymous-Family/Zero-day-scanning](https://github.com/Anonymous-Family/Zero-day-scanning)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #5

**来源**: [CVE-2020-1472-B34MR_zeroscan.md](../2020/CVE-2020-1472-B34MR_zeroscan.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获得域管理员权限。

**影响版本:** 受影响的Windows Server版本包括2008 R2到20H2等多个版本，具体版本请参考漏洞库信息。

**利用条件:** 攻击者需要与域控制器建立网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server的Netlogon协议中。攻击者可以通过将Netlogon客户端使用的身份验证凭据中的多个零值设置为全零来利用此漏洞。如果攻击成功，攻击者可以冒充域控制器上的任何计算机（包括域控制器本身），并获得域管理员权限。

**有效性：**
根据漏洞信息和搜索结果，该漏洞POC是有效的，并且已经被广泛利用。

**投毒风险：**
提供的代码（zeroscan）描述中明确声明它是一个漏洞扫描器，而不是漏洞利用工具，并且专门指出它不尝试利用Zerologon漏洞，只是检查是否存在漏洞。代码库借鉴自SecuraBV的CVE-2020-1472检查脚本。虽然zeroscan本身声明不进行利用，但它依赖于其他工具和脚本，这些依赖项可能存在潜在的风险。此外，代码中可能存在作者有意或无意引入的缺陷或后门。考虑到zeroscan的性质，以及它wrapper Impacket等工具，我们无法完全排除投毒的可能性。因此，存在一定比例的投毒风险。 

**利用方式：**

1.  攻击者使用MS-NRPC协议与域控制器建立连接。
2.  攻击者发送特制的身份验证请求，将Netlogon客户端凭据设置为零。
3.  由于Netlogon协议的缺陷，域控制器错误地接受了零凭据，从而允许攻击者通过身份验证。
4.  攻击者现在可以冒充域控制器并执行恶意操作，例如更改域管理员密码或部署恶意软件。
5. 通过rpcdump可以检测MS-PAR/MS-RPRN服务是否开启，为进一步攻击提供信息。
6. 通过检测SMB signing配置，决定后续横向移动的策略。


**项目地址:** [B34MR/zeroscan](https://github.com/B34MR/zeroscan)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #6

**来源**: [CVE-2020-1472-CPO-EH_CVE-2020-1472_ZeroLogonChecker.md](../2020/CVE-2020-1472-CPO-EH_CVE-2020-1472_ZeroLogonChecker.md)

## CVE-2020-1472 (Zerologon) 漏洞检测

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本，具体请参考漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个Windows Netlogon协议中的严重漏洞，允许未经身份验证的攻击者通过MS-NRPC协议连接到域控制器，重置域控制器的机器帐户密码为空，从而获取域管理员权限。提供的漏洞利用代码是一个C#程序，用于**检测**目标域控制器是否存在此漏洞，**并非真正的漏洞利用代码**。该代码通过尝试与目标域控制器建立Netlogon安全通道并执行身份验证来检测漏洞。由于代码本身是漏洞**检测**工具，并非直接进行提权，因此**投毒风险较低**，主要体现在可能被修改为发送大量探测流量进行拒绝服务攻击，或者收集目标服务器信息的可能。代码片段不完整，只能推断出实现逻辑，但未看到恶意代码，初步认为投毒风险概率为10%。

**利用方式：**

1.  攻击者利用MS-NRPC协议的加密缺陷，向域控制器发送一系列特制的Netlogon请求。
2.  这些请求将导致域控制器的机器帐户密码被重置为空字符串。
3.  攻击者随后可以使用空密码来冒充域控制器，并执行各种恶意操作，例如添加新的域管理员帐户或修改现有帐户的权限。

**有效性：**

由于提供的代码是漏洞检测工具，并非漏洞利用工具，所以**有效性体现在能否准确检测出目标是否存在漏洞**。根据漏洞库信息和搜索结果，该漏洞影响多个版本的Windows Server，攻击影响极大。

**参考链接：**
*   https://www.crowdstrike.com/en-us/blog/cve-2020-1472-zerologon-security-advisory/
*   https://msrc.microsoft.com/blog/2020/10/attacks-exploiting-netlogon-vulnerability-cve-2020-1472/
*   https://nvd.nist.gov/vuln/detail/cve-2020-1472

**项目地址:** [CPO-EH/CVE-2020-1472_ZeroLogonChecker](https://github.com/CPO-EH/CVE-2020-1472_ZeroLogonChecker)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #7

**来源**: [CVE-2020-1472-Fa1c0n35_CVE-2020-1472-02-.md](../2020/CVE-2020-1472-Fa1c0n35_CVE-2020-1472-02-.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，可导致域管理员权限被获取

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与域控制器的网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个Windows Netlogon协议中的权限提升漏洞。攻击者可以通过建立一个到域控制器的脆弱的Netlogon安全通道连接来利用此漏洞。漏洞利用代码通过将Netlogon会话密钥重置为零，从而绕过身份验证。提供的`zerologon_tester.py`脚本用于检测目标域控制器是否存在此漏洞。脚本尝试使用全零的challenge和credential进行身份验证。如果成功，则表明目标存在漏洞。虽然脚本的主要目的是测试漏洞是否存在，但潜在的投毒风险在于，攻击者可能修改该脚本以在成功利用漏洞后执行恶意操作，例如安装后门或收集敏感信息。要求Python 3.7或更高版本，以及`requirements.txt`中列出的依赖项。脚本通过`pip install -r requirements.txt`安装依赖。利用方式为：1. 运行`zerologon_tester.py`脚本，指定目标域控制器的NetBIOS名称和IP地址。2. 脚本尝试使用零密钥进行身份验证。3. 如果身份验证成功，脚本会立即终止，表明目标易受攻击。根据漏洞描述，成功利用此漏洞可能允许未经身份验证的攻击者获得域管理员权限，从而完全控制域。

**投毒风险分析：**

*   **README.md:** 描述了脚本的使用方法和漏洞背景，未发现可疑代码。
*   **LICENSE:** MIT许可证，允许自由使用、修改和分发，但也增加了被修改后用于恶意目的的风险。
*   **requirements.txt:** 列出了脚本依赖的Python库。虽然这些库本身是合法的，但攻击者可能替换或篡改这些库的安装源，从而引入恶意代码。impacket库本身如果来源不明，存在一定风险。
*   **zerologon_tester.py:** 脚本的核心代码，实现了漏洞的检测和利用。虽然代码本身看起来是合法的漏洞验证代码，但是仍然存在被篡改的风险，例如添加在成功利用漏洞后执行恶意操作的代码。例如，在`try_zero_authenticate` 函数中，成功绕过身份验证后，可以添加执行任意代码的逻辑。

因此，虽然提供的代码主要是漏洞检测工具，但仍然存在一定的投毒风险。特别是需要注意impacket包的来源可靠性，以及防止`zerologon_tester.py`被篡改添加恶意逻辑。

综合考虑，判定投毒风险为10%。

**项目地址:** [Fa1c0n35/CVE-2020-1472-02-](https://github.com/Fa1c0n35/CVE-2020-1472-02-)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #8

**来源**: [CVE-2020-1472-Fa1c0n35_SecuraBV-CVE-2020-1472.md](../2020/CVE-2020-1472-Fa1c0n35_SecuraBV-CVE-2020-1472.md)

# CVE-2020-1472

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-1472-100HnoMeuNome_ZeroLogon-CVE-2020-1472-lab.md](../2020/CVE-2020-1472-100HnoMeuNome_ZeroLogon-CVE-2020-1472-lab.md)

## CVE-2020-1472 Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Netlogon Remote Protocol (MS-NRPC)

**危害等级:** 高危，可能导致域管理员权限提升

**影响版本:** 受影响的Windows Server版本：2008 R2, 2012 / 2012 R2, 2016, 2019，以及2020年8月/9月补丁之前的版本

**利用条件:** 需要位于网络内部，能够与域控制器通信

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Microsoft Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。未经身份验证的攻击者可以通过网络连接到域控制器，并利用该漏洞获取域管理员权限。 

**有效性分析：**
根据搜索结果，该漏洞利用的POC代码已经公开（例如packetstormsecurity.com上的POC）。漏洞库信息也表明该漏洞已被积极利用（`Exploitation: active` in CISA ADP Vulnrichment），所以提供的POC代码大概率是有效的。

**投毒风险分析：**
提供的漏洞利用代码实际上是一个`README.md`文件，该文件仅包含漏洞的描述、利用说明、缓解措施和参考链接。该文件本身不包含任何可执行代码，因此直接的投毒风险较低。但是，参考链接指向的POC代码，可能存在被篡改的风险，间接存在一定的投毒可能。考虑到该仓库只是一个说明文档，实际的漏洞利用需要用户自行下载其他POC代码，因此判定投毒风险为10%。

**利用方式分析：**
1.  **漏洞原理：** 漏洞利用了Netlogon协议中的一个加密缺陷，攻击者可以将Netlogon会话的客户端凭据设置为全零。
2.  **攻击步骤：**
    *   攻击者通过MS-NRPC与域控制器建立连接。
    *   利用漏洞将域控制器的机器帐户密码置零。
    *   使用置零后的密码更改域控制器的机器帐户密码。
    *   通过修改后的机器帐户密码获得域管理员权限。
3. **修复方式：** 安装Microsoft发布的更新补丁，并按照Microsoft的指南进行配置，以强制执行安全的Netlogon通道。

**项目地址:** [100HnoMeuNome/ZeroLogon-CVE-2020-1472-lab](https://github.com/100HnoMeuNome/ZeroLogon-CVE-2020-1472-lab)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #2

**来源**: [CVE-2020-1472-Akash7350_CVE-2020-1472.md](../2020/CVE-2020-1472-Akash7350_CVE-2020-1472.md)

## CVE-2020-1472-Zerologon-特权提升

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本，详见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个影响Microsoft Windows Netlogon Remote Protocol (MS-NRPC) 的特权提升漏洞。未经身份验证的攻击者可以通过与域控制器建立脆弱的Netlogon安全通道连接来利用此漏洞。成功利用该漏洞可能允许攻击者冒充域控制器，并最终获得域管理员权限，从而完全控制整个域。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，此POC代码是有效的。搜索结果中多个链接指向了关于该漏洞的分析和利用文章，证明了该漏洞的可利用性。POC代码描述也表明，它能够重置域控制器的帐户密码为空字符串，从而实现权限提升。

**投毒风险：**
评估POC代码的投毒风险较低，大约为10%。代码主要逻辑集中在利用Netlogon协议的加密缺陷，通过重复的认证尝试来绕过身份验证。虽然存在一定的风险，例如代码的维护者可能在未来版本中引入恶意代码，或者安装过程中依赖的第三方库存在安全问题，但从当前提供的代码来看，直接包含恶意、后门代码的可能性不大。该代码更侧重于漏洞利用的验证和概念证明。

**利用方式：**
1.  **建立连接：** 攻击者使用MS-NRPC协议与目标域控制器建立网络连接。
2.  **零化凭据：** 攻击者发送一个包含全零凭据的Netlogon身份验证请求。
3.  **重复尝试：** 由于协议的加密缺陷，攻击者重复发送此请求多次。每次尝试都有可能成功绕过身份验证。
4.  **密码重置：** 成功绕过身份验证后，攻击者将域控制器的帐户密码重置为空字符串。
5.  **权限提升：** 此时，攻击者可以利用空密码来冒充域控制器并获取域管理员权限。

需要注意的是，成功利用此漏洞需要目标域控制器未安装相应的安全补丁。此外，利用该漏洞可能会导致域环境不稳定甚至崩溃，因此在生产环境中进行测试需要谨慎。

**项目地址:** [Akash7350/CVE-2020-1472](https://github.com/Akash7350/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #3

**来源**: [CVE-2020-1472-Anonymous-Family_CVE-2020-1472.md](../2020/CVE-2020-1472-Anonymous-Family_CVE-2020-1472.md)

## CVE-2020-1472 Zerologon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本见漏洞库信息

**利用条件:** 需要位于目标域控制器的网络中

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-1472（Zerologon）是一个存在于Windows Server Netlogon Remote Protocol (MS-NRPC) 中的特权提升漏洞。攻击者通过与域控制器建立脆弱的Netlogon安全通道连接，可以运行特制的应用程序并获取域管理员权限。

**有效性分析：**

提供的POC代码 `zerologon_tester.py` 旨在检测目标域控制器是否存在Zerologon漏洞。该脚本通过尝试使用全零的challenge和credential来进行Netlogon身份验证绕过。如果域控制器存在漏洞，则身份验证将成功，脚本会立即终止。如果域控制器已打补丁，脚本会在多次尝试后放弃并认为目标不存在漏洞（存在极低的假阴性概率）。根据搜索引擎结果，该漏洞利用代码的思路和方法与公开的漏洞利用方式一致，因此判断提供的POC代码是有效的。

**投毒风险分析：**

通过对Dockerfile，requirements.txt和zerologon_tester.py的代码分析，该仓库主要包含漏洞利用的测试代码和依赖项，未发现明显的恶意代码或后门，代码的功能主要是实现对Zerologon漏洞的检测,因此投毒风险较低。

**利用方式：**

1.  **漏洞利用阶段：** 攻击者首先需要与目标域控制器建立网络连接。然后，攻击者运行Zerologon漏洞利用脚本（例如提供的`zerologon_tester.py`的修改版本），该脚本通过MS-NRPC协议发送特制的身份验证请求，利用加密算法中的漏洞将域控制器的机器帐户密码置零。
2.  **权限提升阶段：** 成功将域控制器的机器帐户密码置零后，攻击者可以使用该零密码来获得域控制器的身份验证，从而完全控制域。
3.  **持久化和横向移动（可选）：** 攻击者获得域管理员权限后，可以进行持久化操作（例如创建新的管理员帐户）并在域内进行横向移动，以控制更多系统和数据。

**项目地址:** [Anonymous-Family/CVE-2020-1472](https://github.com/Anonymous-Family/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #4

**来源**: [CVE-2020-1472-Anonymous-Family_Zero-day-scanning.md](../2020/CVE-2020-1472-Anonymous-Family_Zero-day-scanning.md)

## CVE-2020-1472 Zerologon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本，详见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

Zerologon (CVE-2020-1472) 是一个严重的权限提升漏洞，存在于 Netlogon Remote Protocol (MS-NRPC) 中。未经身份验证的攻击者可以通过建立与域控制器的脆弱 Netlogon 安全通道连接来利用此漏洞。攻击成功后，攻击者可以运行特制的应用程序，从而完全控制域控制器。 

**利用方式：**

1.  **利用MS-NRPC协议：** 攻击者利用 MS-NRPC 协议连接到域控制器。
2.  **重置域控制器的密码：** 攻击者通过将域控制器的计算机密码设置为已知值（通常是空值），从而破坏身份验证过程。
3.  **获取域管理员权限：** 密码重置后，攻击者可以冒充域控制器并获取域管理员权限。

**有效性：**

提供的漏洞利用代码 (zeroscan) 本身是一个扫描器，用于检测目标域控制器是否存在 Zerologon 漏洞、MS-PAR/MS-RPRN 协议是否暴露以及 SMBv2 签名配置。它**不**尝试实际利用该漏洞，但是它使用基于已知的POC修改的代码库来检查漏洞，因此可以判断存在可利用性。

**投毒风险：**

分析提供的代码，投毒风险较低，但不能完全排除。理由如下：

*   **开源代码：** 代码托管在 GitHub 上，具有一定的透明度，更容易受到社区审查。
*   **扫描器功能：** 该工具主要功能是扫描，而非直接利用，因此隐藏恶意代码的动机相对较低。
*   **依赖第三方库：** 代码依赖于 Impacket 和 Nmap 等第三方库，攻击者可能尝试利用这些依赖项中的漏洞进行投毒攻击。但是，直接在zeroscan本身投毒的概率较低。
*  **POC的免责声明：**  `Codebase borrowed from: https://github.com/Anonymous-Family/CVE-2020-1472.git` 声明中，代码借鉴了其他库,存在一定的代码风险.

因此，尽管直接在 zeroscan 代码中植入后门的概率较低（假设为5%），但仍需谨慎使用，并仔细审查代码及所依赖的第三方库。


**项目地址:** [Anonymous-Family/Zero-day-scanning](https://github.com/Anonymous-Family/Zero-day-scanning)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #5

**来源**: [CVE-2020-1472-B34MR_zeroscan.md](../2020/CVE-2020-1472-B34MR_zeroscan.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获得域管理员权限。

**影响版本:** 受影响的Windows Server版本包括2008 R2到20H2等多个版本，具体版本请参考漏洞库信息。

**利用条件:** 攻击者需要与域控制器建立网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server的Netlogon协议中。攻击者可以通过将Netlogon客户端使用的身份验证凭据中的多个零值设置为全零来利用此漏洞。如果攻击成功，攻击者可以冒充域控制器上的任何计算机（包括域控制器本身），并获得域管理员权限。

**有效性：**
根据漏洞信息和搜索结果，该漏洞POC是有效的，并且已经被广泛利用。

**投毒风险：**
提供的代码（zeroscan）描述中明确声明它是一个漏洞扫描器，而不是漏洞利用工具，并且专门指出它不尝试利用Zerologon漏洞，只是检查是否存在漏洞。代码库借鉴自SecuraBV的CVE-2020-1472检查脚本。虽然zeroscan本身声明不进行利用，但它依赖于其他工具和脚本，这些依赖项可能存在潜在的风险。此外，代码中可能存在作者有意或无意引入的缺陷或后门。考虑到zeroscan的性质，以及它wrapper Impacket等工具，我们无法完全排除投毒的可能性。因此，存在一定比例的投毒风险。 

**利用方式：**

1.  攻击者使用MS-NRPC协议与域控制器建立连接。
2.  攻击者发送特制的身份验证请求，将Netlogon客户端凭据设置为零。
3.  由于Netlogon协议的缺陷，域控制器错误地接受了零凭据，从而允许攻击者通过身份验证。
4.  攻击者现在可以冒充域控制器并执行恶意操作，例如更改域管理员密码或部署恶意软件。
5. 通过rpcdump可以检测MS-PAR/MS-RPRN服务是否开启，为进一步攻击提供信息。
6. 通过检测SMB signing配置，决定后续横向移动的策略。


**项目地址:** [B34MR/zeroscan](https://github.com/B34MR/zeroscan)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #6

**来源**: [CVE-2020-1472-CPO-EH_CVE-2020-1472_ZeroLogonChecker.md](../2020/CVE-2020-1472-CPO-EH_CVE-2020-1472_ZeroLogonChecker.md)

## CVE-2020-1472 (Zerologon) 漏洞检测

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本，具体请参考漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个Windows Netlogon协议中的严重漏洞，允许未经身份验证的攻击者通过MS-NRPC协议连接到域控制器，重置域控制器的机器帐户密码为空，从而获取域管理员权限。提供的漏洞利用代码是一个C#程序，用于**检测**目标域控制器是否存在此漏洞，**并非真正的漏洞利用代码**。该代码通过尝试与目标域控制器建立Netlogon安全通道并执行身份验证来检测漏洞。由于代码本身是漏洞**检测**工具，并非直接进行提权，因此**投毒风险较低**，主要体现在可能被修改为发送大量探测流量进行拒绝服务攻击，或者收集目标服务器信息的可能。代码片段不完整，只能推断出实现逻辑，但未看到恶意代码，初步认为投毒风险概率为10%。

**利用方式：**

1.  攻击者利用MS-NRPC协议的加密缺陷，向域控制器发送一系列特制的Netlogon请求。
2.  这些请求将导致域控制器的机器帐户密码被重置为空字符串。
3.  攻击者随后可以使用空密码来冒充域控制器，并执行各种恶意操作，例如添加新的域管理员帐户或修改现有帐户的权限。

**有效性：**

由于提供的代码是漏洞检测工具，并非漏洞利用工具，所以**有效性体现在能否准确检测出目标是否存在漏洞**。根据漏洞库信息和搜索结果，该漏洞影响多个版本的Windows Server，攻击影响极大。

**参考链接：**
*   https://www.crowdstrike.com/en-us/blog/cve-2020-1472-zerologon-security-advisory/
*   https://msrc.microsoft.com/blog/2020/10/attacks-exploiting-netlogon-vulnerability-cve-2020-1472/
*   https://nvd.nist.gov/vuln/detail/cve-2020-1472

**项目地址:** [CPO-EH/CVE-2020-1472_ZeroLogonChecker](https://github.com/CPO-EH/CVE-2020-1472_ZeroLogonChecker)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #7

**来源**: [CVE-2020-1472-Fa1c0n35_CVE-2020-1472-02-.md](../2020/CVE-2020-1472-Fa1c0n35_CVE-2020-1472-02-.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，可导致域管理员权限被获取

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与域控制器的网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个Windows Netlogon协议中的权限提升漏洞。攻击者可以通过建立一个到域控制器的脆弱的Netlogon安全通道连接来利用此漏洞。漏洞利用代码通过将Netlogon会话密钥重置为零，从而绕过身份验证。提供的`zerologon_tester.py`脚本用于检测目标域控制器是否存在此漏洞。脚本尝试使用全零的challenge和credential进行身份验证。如果成功，则表明目标存在漏洞。虽然脚本的主要目的是测试漏洞是否存在，但潜在的投毒风险在于，攻击者可能修改该脚本以在成功利用漏洞后执行恶意操作，例如安装后门或收集敏感信息。要求Python 3.7或更高版本，以及`requirements.txt`中列出的依赖项。脚本通过`pip install -r requirements.txt`安装依赖。利用方式为：1. 运行`zerologon_tester.py`脚本，指定目标域控制器的NetBIOS名称和IP地址。2. 脚本尝试使用零密钥进行身份验证。3. 如果身份验证成功，脚本会立即终止，表明目标易受攻击。根据漏洞描述，成功利用此漏洞可能允许未经身份验证的攻击者获得域管理员权限，从而完全控制域。

**投毒风险分析：**

*   **README.md:** 描述了脚本的使用方法和漏洞背景，未发现可疑代码。
*   **LICENSE:** MIT许可证，允许自由使用、修改和分发，但也增加了被修改后用于恶意目的的风险。
*   **requirements.txt:** 列出了脚本依赖的Python库。虽然这些库本身是合法的，但攻击者可能替换或篡改这些库的安装源，从而引入恶意代码。impacket库本身如果来源不明，存在一定风险。
*   **zerologon_tester.py:** 脚本的核心代码，实现了漏洞的检测和利用。虽然代码本身看起来是合法的漏洞验证代码，但是仍然存在被篡改的风险，例如添加在成功利用漏洞后执行恶意操作的代码。例如，在`try_zero_authenticate` 函数中，成功绕过身份验证后，可以添加执行任意代码的逻辑。

因此，虽然提供的代码主要是漏洞检测工具，但仍然存在一定的投毒风险。特别是需要注意impacket包的来源可靠性，以及防止`zerologon_tester.py`被篡改添加恶意逻辑。

综合考虑，判定投毒风险为10%。

**项目地址:** [Fa1c0n35/CVE-2020-1472-02-](https://github.com/Fa1c0n35/CVE-2020-1472-02-)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #8

**来源**: [CVE-2020-1472-JolynNgSC_Zerologon_CVE-2020-1472.md](../2020/CVE-2020-1472-JolynNgSC_Zerologon_CVE-2020-1472.md)

## CVE-2020-1472 Netlogon Elevation of Privilege Vulnerability (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获取域管理员权限并完全控制域

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 1903, 1909, 2004, 20H2

**利用条件:** 攻击者需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472 (Zerologon) 是 Microsoft Netlogon 协议中的一个严重漏洞，允许未经身份验证的攻击者通过设置 Netlogon 安全通道连接的客户端凭据为全零来冒充域控制器。成功利用此漏洞后，攻击者可以接管整个 Windows 域。 

**有效性:**  根据搜索引擎结果和漏洞利用代码，此漏洞的POC代码是有效的。许多安全研究人员和组织已经成功地利用此漏洞进行了概念验证和实际攻击。

**投毒风险:**  提供的代码仓库主要包含漏洞利用步骤和检测方法，用于模拟 Zerologon 攻击以进行防御和缓解。其中提到的[https://github.com/dirkjanm/CVE-2020-1472](https://github.com/dirkjanm/CVE-2020-1472)是原始漏洞利用代码，本身不包含恶意代码，投毒风险主要存在于引用的第三方库或者其他未明确说明的操作中。由于该代码库的目的在于演示漏洞，且代码量相对较小，人工可以审核，因此判断投毒风险较低。但依旧存在一定的风险。通过分析整个代码仓库，包含恶意代码的风险预估为10%。

**利用方式:**

1.  **利用漏洞:**  攻击者使用提供的 Python 脚本（cve-2020-1472-exploit.py）将域控制器的 Netlogon 安全通道凭据设置为全零。
2.  **获取域管理员哈希:**  使用 `secretsdump.py` 从域控制器转储域管理员哈希。
3.  **权限提升:**  使用 `wmiexec.py` 通过获得的域管理员哈希来执行任意命令并完全控制域。

**缓解措施:**

*   及时应用 Microsoft 提供的安全补丁。
*   监控 Windows 事件查看器中与 Zerologon 攻击相关的事件 ID（例如，4624 和 4742）。
*   强制执行安全的 RPC 与 Netlogon 连接。

**项目地址:** [JolynNgSC/Zerologon_CVE-2020-1472](https://github.com/JolynNgSC/Zerologon_CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #9

**来源**: [CVE-2020-1472-PakwanSK_Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks..md](../2020/CVE-2020-1472-PakwanSK_Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks..md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。攻击者通过建立一个与域控制器的脆弱的Netlogon安全通道连接，可以运行特制的应用程序，最终获得域管理员权限，完全控制域。该漏洞利用方式主要分为以下几个步骤：

1.  **发现目标域控制器：** 攻击者需要确定目标域控制器的IP地址。
2.  **利用MS-NRPC协议漏洞：** 攻击者利用MS-NRPC协议中的加密缺陷，特别是AES-CFB8的实现问题，将域控制器的计算机密码重置为空。
3.  **恢复域控制器密码并获得权限：** 攻击者通常会重置域控制器的密码为空，然后通过其他方式（如DCSync）获取域控制器的账号信息，并获得域管理员权限。

**有效性：** 根据漏洞库信息、搜索结果和提供的POC代码，该漏洞利用的有效性非常高。存在公开的POC代码，并且已经被广泛利用。

**投毒风险：** 提供的代码仓库主要是模拟和预防Zerologon漏洞攻击。该仓库链接到 `https://github.com/VoidSec/CVE-2020-1472` 包含checker 和 exploit 代码。 仓库本身主要是使用说明和演示，投毒风险较低，但是下载的POC代码存在一定的风险，需要仔细检查代码是否包含恶意代码，故投毒风险评估为10%。

**利用方式：**

1.  **未授权访问：**  攻击者无需任何凭据，就可以利用该漏洞。
2.  **密码重置：**  攻击利用的核心在于将域控制器的机器帐户密码设置为0。
3.  **权限提升：**  成功重置密码后，攻击者可以使用其他攻击技术（例如DCSync攻击）来提取域凭据并完全控制域。

**缓解措施：**

1.  **及时安装补丁：**  应用Microsoft发布的针对CVE-2020-1472的补丁。
2.  **强制执行安全通道：**  配置Netlogon安全通道以强制执行签名和加密。
3.  **监控可疑活动：**  监控Netlogon协议的异常活动，例如大量密码重置尝试。

**项目地址:** [PakwanSK/Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks.](https://github.com/PakwanSK/Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks.)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #10

**来源**: [CVE-2020-1472-RicYaben_CVE-2020-1472-LAB.md](../2020/CVE-2020-1472-RicYaben_CVE-2020-1472-LAB.md)

## CVE-2020-1472 Zerologon Netlogon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控被接管

**影响版本:** 受影响的Windows Server版本，具体见漏洞库信息

**利用条件:** 需要位于目标网络的内部，能够与域控制器通信

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472（Zerologon）是一个存在于Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。未经验证的攻击者可以通过MS-NRPC连接到域控制器，并使用一组全零的加密密钥来执行身份验证，从而完全控制域。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞影响多个版本的Windows Server，并且存在公开可用的POC。POC代码（zerologon_tester.py）旨在测试目标域控制器是否存在漏洞，通过尝试Netlogon身份验证绕过进行检测。如果成功绕过，脚本将立即终止。因此，提供的POC代码是有效的漏洞验证工具。

**投毒风险：**
分析Dockerfile、LICENSE、README.md以及zerologon_tester.py的内容，没有发现明显的恶意代码或后门。Dockerfile用于构建包含POC脚本的Docker镜像，LICENSE是MIT许可，允许自由使用和修改，README.md提供使用说明。zerologon_tester.py脚本主要用于验证漏洞存在，不执行任何提权或持久化的操作。但是，任何代码都存在被篡改的可能。因此，认为存在1%的潜在投毒风险，主要来自于以下可能：

1.  **依赖项投毒：** requirements.txt文件中指定的依赖库（特别是impacket）可能被替换为恶意版本。
2.  **构建过程投毒：** Dockerfile构建过程中，可能存在恶意指令篡改。

**利用方式：**
1.  **环境准备：** 需要一台能够访问目标域控制器的机器，并安装Python环境和相关依赖库（impacket, cryptography）。
2.  **漏洞验证：** 运行zerologon_tester.py脚本，指定目标域的NetBIOS名称和IP地址。脚本会尝试使用全零密钥进行Netlogon身份验证绕过。
3.  **攻击：** 如果漏洞验证成功，则目标域控制器存在Zerologon漏洞。攻击者可以使用更复杂的利用代码来重置域控制器的计算机密码，从而获得域管理员权限。

搜索结果中包含了大量的漏洞分析文章和缓解措施，表明该漏洞已经被广泛研究和利用。Microsoft已经发布了补丁程序来修复此漏洞，因此确保域控制器已安装最新的安全更新至关重要。

**项目地址:** [RicYaben/CVE-2020-1472-LAB](https://github.com/RicYaben/CVE-2020-1472-LAB)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #11

**来源**: [CVE-2020-1472-Rvn0xsy_ZeroLogon.md](../2020/CVE-2020-1472-Rvn0xsy_ZeroLogon.md)

## CVE-2020-1472 Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server Netlogon Remote Protocol (MS-NRPC)

**危害等级:** 高危，可能导致域管理员权限获取

**影响版本:** 受影响的Windows Server版本（见漏洞库信息）

**利用条件:** 攻击者需要位于目标网络的内部，能够与域控制器建立Netlogon连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server的Netlogon协议实现中。攻击者可以通过将Netlogon会话的机器密码置零，从而绕过身份验证，最终控制域控制器。提供的POC代码是一个C++版本的Zerologon利用工具，它直接重置机器帐户的密码。 **有效性：** 根据漏洞信息、搜索结果和提供的代码，该漏洞利用是有效的。搜索结果中多个链接都提到了Zerologon漏洞的利用，并且存在公开的POC代码。 **投毒风险：** 查看代码后，该工具会直接重置机器账户的密码，无具备恢复功能，具有一定的破坏性。虽然名为“ZeroLogon”，该工具实际重置密码，而不是简单验证，需要管理员级别的权限进行操作， 存在被恶意使用的风险，例如通过捆绑其他恶意程序进行传播等。因此，评估投毒风险为10%。 **利用方式：** 1.  攻击者需要位于目标网络的内部。2.  攻击者利用Zerologon漏洞，通过MS-NRPC协议与域控制器建立连接，并将域控制器的机器帐户密码重置为空。3.  攻击者利用重置后的空密码，冒充域控制器进行身份验证。4.  攻击者获得域管理员权限，从而控制整个域。

**项目地址:** [Rvn0xsy/ZeroLogon](https://github.com/Rvn0xsy/ZeroLogon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #12

**来源**: [CVE-2020-1472-SecuraBV_CVE-2020-1472.md](../2020/CVE-2020-1472-SecuraBV_CVE-2020-1472.md)

## CVE-2020-1472 - Netlogon Elevation of Privilege Vulnerability (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域管理员权限被获取，控制整个域

**影响版本:** 受影响的Windows Server版本包括：2004, 2019, 1909, 1903, 2016, 2008 R2, 2012, 2012 R2, 20H2

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472 (Zerologon) 漏洞存在于 Netlogon 远程协议 (MS-NRPC) 中。未经身份验证的攻击者可以通过 MS-NRPC 连接到域控制器，利用加密算法中的缺陷来冒充域控制器，并最终获得域管理员权限。

**有效性：**
提供的PoC代码 `zerologon_tester.py` 旨在检测目标域控制器是否存在 Zerologon 漏洞。它通过尝试使用全零的challenge和credential进行Netlogon身份验证绕过来实现检测。如果成功绕过身份验证，则表明目标存在漏洞。

**投毒风险：**
分析提供的 Dockerfile, requirements.txt, LICENSE, README.md, zerologon_tester.py 文件，并未发现明显的恶意代码或后门。该代码主要依赖于 `impacket` 库实现 Netlogon 协议的交互和漏洞利用。但仍存在极低的投毒风险，例如:

*   `impacket` 库本身被篡改或使用恶意版本（虽然可能性较低，但需要考虑）。
*   代码中存在细微的逻辑错误，可能导致程序在特定环境下执行非预期操作（比如拒绝服务），虽然这些错误并非有意的，但属于一种潜在的风险。
*   `zerologon_tester.py` 本身虽然是漏洞检测工具，但攻击者可能会修改该工具，使其在检测漏洞的同时执行其他恶意操作。此脚本依赖第三方库,若第三方库被劫持,则存在风险。

综上，该仓库本身存在投毒的可能性较低，约为5%，但用户在使用该代码时仍需谨慎，仔细审查代码，确保使用的第三方库是可信的。

**利用方式：**
1.  攻击者使用 `zerologon_tester.py` 脚本检测目标域控制器是否存在漏洞。
2.  如果存在漏洞，攻击者可以重置域控制器的机器帐户密码。
3.  攻击者使用重置后的密码进行身份验证，获得域管理员权限。
4.  攻击者可以导出域内用户凭据、安装恶意软件、横向移动等，最终控制整个域。

**缓解措施：**
1.  及时安装 Microsoft 发布的 CVE-2020-1472 安全更新。
2.  监控网络流量，检测是否存在 Zerologon 攻击。
3.  强制执行签名和加密的 Netlogon 通信。

搜索引擎结果中，提供了关于 CVE-2020-1472 的漏洞概述、利用步骤、检测工具和缓解措施等信息，进一步验证了该漏洞的严重性和利用方式。

**项目地址:** [SecuraBV/CVE-2020-1472](https://github.com/SecuraBV/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #13

**来源**: [CVE-2020-1472-TheJoyOfHacking_SecuraBV-CVE-2020-1472.md](../2020/CVE-2020-1472-TheJoyOfHacking_SecuraBV-CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon): Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域管理员权限被获取

**影响版本:** 受影响的Windows Server版本包括2004, 2019, 1909, 1903, 2016, 2008 R2 SP1, 2012, 2012 R2, 和 20H2。具体版本参考漏洞库信息。

**利用条件:** 攻击者需要位于与域控制器相同的网络，并能够与其进行通信。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472（Zerologon）是一个Netlogon协议中的严重漏洞，允许未经身份验证的攻击者通过建立到域控制器的脆弱Netlogon安全通道连接来提升权限，最终获取域管理员权限。漏洞的根源在于Netlogon协议在身份验证过程中使用了存在缺陷的加密算法（AES-CFB8）。攻击者可以利用该漏洞将域控制器的机器帐户密码重置为空，从而完全控制域。提供的漏洞利用代码 `zerologon_tester.py`  使用 Impacket 库尝试执行 Netlogon 身份验证绕过。如果成功绕过，脚本将立即终止。如果域控制器已修补，脚本会在发送 2000 对 RPC 调用后放弃，并认为目标不易受攻击。Dockerfile 用于构建包含所需依赖项（包括 Impacket）的 Alpine Linux 容器，从而简化漏洞利用脚本的部署和执行。requirements.txt 文件指定了脚本的依赖项，例如 `impacket==0.9.23`。LICENSE文件是MIT许可证,表明代码是开源的。通过分析提供的 Dockerfile，requirements.txt，LICENSE，README.md 和 Python 脚本，我发现投毒代码的可能性极低(约1%)。虽然始终存在人为引入恶意代码的可能性，但是该代码库的结构和内容表明其主要目的是为了验证漏洞是否存在。

**项目地址:** [TheJoyOfHacking/SecuraBV-CVE-2020-1472](https://github.com/TheJoyOfHacking/SecuraBV-CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #14

**来源**: [CVE-2020-1472-TheJoyOfHacking_dirkjanm-CVE-2020-1472.md](../2020/CVE-2020-1472-TheJoyOfHacking_dirkjanm-CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server Netlogon

**危害等级:** 高危，可能导致域接管

**影响版本:** 受影响的Windows Server版本包括Windows Server 2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 攻击者需要位于与域控制器相同的网络中

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个Windows Server Netlogon协议中的权限提升漏洞。未经身份验证的攻击者可以通过建立一个脆弱的Netlogon安全通道连接到域控制器来利用此漏洞，从而获得域管理员权限。

**有效性：**

提供的POC代码通过将域控制器的机器账户密码设置为零来利用该漏洞。成功利用后，攻击者可以使用DCSync获取域凭据，从而控制整个域。根据漏洞信息和搜索结果，该POC代码的有效性较高，已被广泛使用。

**投毒风险：**

该仓库中可能存在的投毒风险评估为10%。 风险主要来源于以下几个方面：

1.  **密码重置风险：** POC 默认会将域控制器的机器账户密码重置为空，这会导致与其它域控制器的通信中断。虽然脚本提供了恢复密码的方法，但如果操作不当或者恢复流程失败，可能会导致域功能异常。
2.  **依赖关系：** POC 依赖于 impacket 库的特定版本，如果使用错误的版本可能会导致脚本运行失败或产生未知的副作用。
3.  **脚本修改：** 下载的脚本可能被恶意修改，例如添加额外功能（后门）。尽管此POC的核心功能是已知的，但仍然存在下载后被修改的可能性。 虽然风险较低，但用户应始终从可信来源下载代码并进行代码审计。

**利用方式：**

1.  攻击者首先使用提供的`cve-2020-1472-exploit.py`脚本，指定目标域控制器的IP地址和NetBIOS名称。此脚本会尝试将域控制器的机器账户密码设置为零。
2.  如果攻击成功，攻击者可以使用`secretsdump.py`（Impacket库的一部分）从域控制器中提取域凭据，包括域管理员账户的哈希值。
3.  攻击者可以使用提取到的域管理员凭据来控制整个域。
4.  为了避免影响域控制器的正常运行，攻击者可以使用`restorepassword.py`脚本，配合从注册表中dump出的hex password（通过 secretsdump 获得），将域控制器的机器账户密码恢复为原始密码。

**修复建议：**

*   安装Microsoft官方发布的补丁。
*   监控网络中是否存在利用CVE-2020-1472的攻击行为。
*   强制执行签名和加密的Netlogon通信。


**项目地址:** [TheJoyOfHacking/dirkjanm-CVE-2020-1472](https://github.com/TheJoyOfHacking/dirkjanm-CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #15

**来源**: [CVE-2020-1472-TuanCui22_ZerologonWithImpacket-CVE2020-1472.md](../2020/CVE-2020-1472-TuanCui22_ZerologonWithImpacket-CVE2020-1472.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2等。

**利用条件:** 攻击者需要位于与域控制器相同的网络中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Netlogon远程协议（MS-NRPC）中的特权提升漏洞。攻击者可以利用此漏洞通过将域控制器的计算机账号密码置零来接管域。 

**有效性：**
根据漏洞库信息、搜索结果和提供的impacket代码仓库信息来看，此漏洞的POC代码是有效的。大量公开的POC和利用脚本存在，并且该漏洞已被广泛利用。

**投毒风险：**
提供的代码片段是impacket的ChangeLog.md文件，它记录了impacket项目的更新日志。Impacket是一个常用的Python库，被安全研究人员和渗透测试人员广泛使用，用于处理网络协议。虽然Impacket本身是一个合法的安全工具，但如果从不可信的来源下载或使用修改过的版本，则可能存在投毒风险。分析提供的ChangeLog.md，并没有发现直接的投毒代码。但是由于该项目代码量巨大，并且可以通过引入恶意模块进行投毒，所以存在一定的投毒风险。综合考虑，风险值大约在10%。

**利用方式：**
1.  **连接域控制器：** 攻击者使用MS-NRPC协议连接到目标域控制器。
2.  **密码置零：** 攻击者通过精心构造的Netlogon请求，将域控制器的计算机账号密码重置为空。
3.  **获取域管理员权限：** 密码置零后，攻击者可以使用该计算机账号来请求Kerberos票据，并最终获得域管理员权限。
4.  **完全控制域：** 攻击者获得域管理员权限后，可以执行任何操作，包括窃取数据、安装恶意软件、创建新的账号等。

**项目地址:** [TuanCui22/ZerologonWithImpacket-CVE2020-1472](https://github.com/TuanCui22/ZerologonWithImpacket-CVE2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #16

**来源**: [CVE-2020-1472-bb00_zer0dump.md](../2020/CVE-2020-1472-bb00_zer0dump.md)

## CVE-2020-1472 (Zerologon) 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全接管

**影响版本:** 受影响的Windows Server版本，具体参见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个存在于Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。攻击者可以通过将域控制器的Netlogon密码重置为零，从而冒充域控制器并接管整个域。利用方式如下：

1.  **漏洞原理：** 该漏洞源于MS-NRPC协议中使用AES加密算法时，没有正确验证初始化向量（IV）。攻击者可以发送大量精心构造的认证请求，这些请求的IV均为零。由于加密算法的特性，这会导致认证过程中的某些步骤失效，使得攻击者能够成功建立与域控制器的安全通道。
2.  **利用步骤：**
    *   使用POC工具（如Zer0Dump）连接到目标域控制器。
    *   通过修改Netlogon安全通道的密码（通常设置为全零），来利用该漏洞。
    *   利用Impacket等工具，使用已修改的密码来获取域控制器的权限。
    *   导出域用户的哈希值，或者直接执行其他恶意操作。

3.  **有效性：** 搜索引擎结果和漏洞库信息都表明此漏洞危害极大，且存在公开可用的POC代码。因此，提供的POC代码（Zer0Dump）很可能有效，可以被用于利用该漏洞。

4.  **投毒风险：** 分析提供的`psexec.py`代码，该文件是Impacket套件中的一个工具，用于在远程系统上执行命令。虽然`psexec.py`本身不是漏洞利用代码，但它可以被用于在成功利用Zerologon漏洞后，在域控制器上执行恶意代码。`README.md`提及了Zer0dump，并感谢了相关人员，看起来像是正常的漏洞利用工具说明。
    *   **潜在风险点：** `psexec.py`需要配置用户名、密码等敏感信息，如果攻击者修改了`psexec.py`，可能会加入后门，例如将输入的凭据发送到远程服务器。此外，`Zer0dump`本身也有可能存在恶意代码，但从目前的代码来看，风险较低。
   总的来说，由于`psexec.py`需要用户提供凭据，且可以被篡改，以及`Zer0dump`本身可能存在未知风险，我判断此仓库存在 10% 的投毒风险。

请注意，成功利用该漏洞后，攻击者可以完全控制域环境，因此务必及时修补该漏洞。

**项目地址:** [bb00/zer0dump](https://github.com/bb00/zer0dump)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #17

**来源**: [CVE-2020-1472-blackh00d_zerologon-poc.md](../2020/CVE-2020-1472-blackh00d_zerologon-poc.md)

## CVE-2020-1472 Zerologon Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获取域管理员权限，完全控制域环境

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 攻击者需要与域控制器建立网络连接。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个严重的Windows Netlogon协议中的特权提升漏洞。攻击者可以通过向域控制器发送一系列特制的Netlogon消息来利用此漏洞，从而将域控制器的机器账户密码置为空。一旦密码被置为空，攻击者可以使用该空密码通过Netlogon协议对域控制器进行身份验证，并执行诸如更改域管理员密码、DCSync等恶意操作，从而完全控制整个域。

**有效性：**

根据漏洞信息和搜索结果，提供的PoC代码是有效的。许多安全研究人员和组织已经发布了该漏洞的利用代码，并成功利用该漏洞获取域管理员权限。

**投毒风险：**

分析PoC代码，该代码主要功能是：

1.  通过`try_zero_authenticate` 函数尝试将域控制器的Netlogon密码置零，通过多次认证尝试，利用加密算法缺陷达到目的。
2.  如果成功，则使用`exploit`函数将机器帐户密码实际设置为空字符串。
3.  可选地，使用`dcsync`函数从域控制器同步密码哈希。
4.  提供`restore_password`函数用于恢复原始密码。

从代码分析来看，主要风险在于利用成功后，攻击者可以完全控制域，而非PoC本身携带恶意代码。但用户使用未经审核的第三方代码始终存在风险，例如作者可能在代码中埋藏后门，收集用户信息等。因此，我们认为存在非常低的投毒风险，概率约为1%。

**利用方式：**

1.  **漏洞发现：** CVE-2020-1472 存在于 Netlogon 远程协议 (MS-NRPC) 中，该协议用于用户和机器对域控制器的身份验证。该漏洞源于 AES-CFB8 加密算法的实现缺陷，允许攻击者使用全零初始化向量。
2.  **攻击步骤：**
    *   攻击者首先需要与目标域控制器建立网络连接。
    *   利用PoC代码，通过`try_zero_authenticate`函数不断尝试使用全零凭据对域控制器进行身份验证。由于加密算法的缺陷，经过多次尝试后，域控制器可能会错误地接受全零凭据。
    *   一旦身份验证成功，攻击者使用`exploit`函数通过Netlogon协议将域控制器的机器账户密码设置为空字符串。
    *   现在，攻击者可以使用空密码通过Netlogon协议对域控制器进行身份验证。
    *   利用获取的域控制器权限，攻击者可以执行DCSync操作，获取域中所有用户的密码哈希，或者直接创建一个新的域管理员帐户。
3.  **缓解措施：**
    *   尽快安装 Microsoft 发布的针对 CVE-2020-1472 的安全更新。
    *   监控域控制器上的事件日志，查找与 Netlogon 相关的异常活动。
    *   强制执行 Netlogon 安全通道的签名和加密。

**项目地址:** [blackh00d/zerologon-poc](https://github.com/blackh00d/zerologon-poc)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #18

**来源**: [CVE-2020-1472-c3rrberu5_ZeroLogon-to-Shell.md](../2020/CVE-2020-1472-c3rrberu5_ZeroLogon-to-Shell.md)

## CVE-2020-1472 Zerologon权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，允许未授权的攻击者接管域控制器

**影响版本:** 受影响的Windows Server版本见漏洞库信息

**利用条件:** 攻击者需要位于与域控制器相同的网络，并且能够与其建立Netlogon连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个影响Windows Server Netlogon协议的权限提升漏洞。攻击者通过将域控制器的Netlogon密码置零，可以有效地禁用其身份验证机制。由于Netlogon协议在身份验证过程中使用AES-CFB8加密，但实现上存在缺陷，导致可以通过多次尝试将密码归零。

**有效性：**
提供的PoC代码 `zeroLogon_toShell.py` 尝试利用Zerologon漏洞将域控制器的Netlogon密码置零，然后利用`evil-winrm`工具获取域控制器的shell。根据搜索引擎结果和漏洞描述，该漏洞已经有公开的PoC，因此该代码的有效性较高。需要注意的是，利用成功需要提供有效的Administrator NTLM哈希。

**投毒风险：**
查看PoC代码，发现其主要功能是利用Zerologon漏洞，然后尝试使用`evil-winrm`连接到域控制器。代码中存在执行操作系统命令的部分 (`os.system`)，这部分存在潜在的投毒风险。例如，攻击者可能会修改`os.system`执行的命令，在受害者不知情的情况下安装后门或执行其他恶意操作。虽然目前的PoC看起来直接调用了`evil-winrm`，但攻击者可能插入额外的命令。代码还包含从用户那里获取Administrator NTLM Hash的部分，攻击者可以将获取到的hash发送到远程服务器，进行下一步利用。由于代码主要依赖于已知的漏洞利用方法，且没有发现明显的恶意代码，因此投毒风险为较低，估计为10%。

**利用方式：**
1.  **连接到域控制器：** 攻击者需要位于与目标域控制器相同的网络中。需要知道目标域控制器的NetBIOS名称和IP地址。
2.  **利用Zerologon漏洞：** 攻击者运行PoC脚本，该脚本尝试通过发送一系列特制的Netlogon请求将域控制器的密码置零。这个过程可能需要多次尝试。
3.  **恢复或者直接利用：**成功利用漏洞后，域控制器的密码被置零。原始exp需要先恢复机器账户密码，但是该PoC是直接输入Administrator NTLM Hash连接。攻击者可以使用`evil-winrm`等工具，使用置零密码或者Administrator NTLM Hash远程连接到域控制器。
4.  **权限提升：** 通过`evil-winrm`连接到域控制器后，攻击者拥有了系统权限，可以执行任意操作，例如添加域管理员账号、窃取敏感数据等。

**项目地址:** [c3rrberu5/ZeroLogon-to-Shell](https://github.com/c3rrberu5/ZeroLogon-to-Shell)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #19

**来源**: [CVE-2020-1472-carlos55ml_zerologon.md](../2020/CVE-2020-1472-carlos55ml_zerologon.md)

## CVE-2020-1472 Zerologon Netlogon特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全接管

**影响版本:** 受影响的Windows Server版本请参考漏洞库信息

**利用条件:** 需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的漏洞，存在于Microsoft Windows Netlogon远程协议（MS-NRPC）中。攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞，从而获得域管理员权限。 

**漏洞利用方式：**

1.  **利用MS-NRPC协议：** 攻击者使用MS-NRPC协议连接到域控制器。
2.  **零值凭据：**  攻击者通过发送一系列精心构造的Netlogon消息，其中包含零值凭据来重置域控制器的机器帐户密码。
3.  **权限提升：** 成功重置密码后，攻击者可以模拟域控制器账户，窃取域凭据并完全控制域。

**有效性评估：**

提供的PoC代码看起来有效，因为它实现了Zerologon漏洞利用的关键步骤，包括连接到Netlogon服务、使用零值凭据进行身份验证以及重置域控制器密码。

**投毒风险评估：**

分析提供的代码，特别是`empty_pw.py`文件，未发现明显的恶意或后门代码。但始终存在小概率风险，例如：

1.  **编码缺陷：** 代码中可能存在细微的编码错误，可能导致意外行为或拒绝服务，虽然不是恶意投毒，但也可能影响系统稳定性。（5%）
2.  **依赖风险：**  `requirements.txt`文件中列出的依赖项，如果使用了不可信的源，可能会引入恶意软件包。 (5%)

因此，综合评估投毒风险为10%。建议在使用PoC代码之前，仔细审查代码，并从可信来源获取依赖项。

**漏洞库信息：**

漏洞库信息表明，该漏洞影响多个版本的Windows Server，并且Microsoft已发布补丁程序。建议及时安装补丁。

**搜索引擎结果：**

搜索结果确认了该漏洞的严重性，并提供了有关漏洞分析、利用步骤和检测工具的信息。

**项目地址:** [carlos55ml/zerologon](https://github.com/carlos55ml/zerologon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #20

**来源**: [CVE-2020-1472-dr4g0n23_CVE-2020-1472.md](../2020/CVE-2020-1472-dr4g0n23_CVE-2020-1472.md)

## CVE-2020-1472 Zerologon 本地提权漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域管理员权限被获取，完全控制域环境

**影响版本:** 受影响的Windows Server版本包括：Windows Server version 2004, Windows Server 2019, Windows Server 2019 (Server Core installation), Windows Server, version 1909 (Server Core installation), Windows Server, version 1903 (Server Core installation), Windows Server 2016, Windows Server 2016 (Server Core installation), Windows Server 2008 R2 Service Pack 1, Windows Server 2008 R2 Service Pack 1 (Server Core installation), Windows Server 2012, Windows Server 2012 (Server Core installation), Windows Server 2012 R2, Windows Server 2012 R2 (Server Core installation), Windows Server version 20H2

**利用条件:** 需要位于目标网络的内部，能够与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server的Netlogon远程协议（MS-NRPC）中。攻击者可以利用此漏洞通过将Netlogon secure channel的客户端凭据设置为零来冒充域控制器。漏洞利用过程如下：

1.  **漏洞利用准备：** 使用`arp-scan`或`nmap`等工具确定目标域控制器的IP地址和NetBIOS名称。
2.  **重置域控制器密码：** 运行`set_empty_pw.py`脚本，该脚本将域控制器的机器帐户密码重置为空。这通过MS-NRPC协议中的加密缺陷实现，允许未经身份验证的攻击者修改域控制器的密码。
3.  **导出域凭据：** 使用`secretsdump.py`脚本，从域控制器导出域凭据（NTLM哈希）。因为域控制器的密码已重置为空，所以可以使用空密码进行身份验证，并转储域中的所有密码哈希。
4.  **执行任意代码：** 使用`wmiexec.py`脚本或者psexec.py通过获得的域管理员权限，在域控制器上执行任意代码。  使用获得的哈希值可以通过`wmiexec.py`或者psexec.py在目标机器上执行命令。  

**投毒风险分析：**

该POC代码的主要功能是利用Zerologon漏洞来重置域控制器的密码并获取域管理员权限。其中，`set_empty_pw.py`是利用漏洞的关键脚本。查看`psexec.py`脚本是正常的远程执行工具。检查`README.md`中使用的脚本，发现没有明显的恶意代码。投毒风险主要在于：

*   `set_empty_pw.py` 和secretsdump.py脚本可能被修改以包含后门代码，例如记录攻击者的IP地址，或者在目标系统上安装其他恶意软件。  但是直接修改exp还是很容易发现的. 还有一种隐藏方式可能存在,就是作者使用云函数或者其他方式,获取攻击目标的内网信息,然后进行出售获利, 本次判定存在的概率为 **10%**。 这种云函数,或者后门很难被发现,只有在被攻击之后溯源才能发现该投毒代码。

**有效性：**

该漏洞利用代码有效，因为CVE-2020-1472是一个已知的且被广泛利用的漏洞。 提供的脚本涵盖了利用该漏洞所需的关键步骤. 搜索引擎结果也验证了该漏洞的存在和利用。

**利用方式总结：**

该漏洞的利用方式是通过MS-NRPC协议中的加密缺陷，将域控制器的机器帐户密码重置为空，然后使用空密码进行身份验证，导出域凭据，最终获得域管理员权限，从而完全控制域环境。

**项目地址:** [dr4g0n23/CVE-2020-1472](https://github.com/dr4g0n23/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #21

**来源**: [CVE-2020-1472-guglia001_MassZeroLogon.md](../2020/CVE-2020-1472-guglia001_MassZeroLogon.md)

## CVE-2020-1472-Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，可导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与域控建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个Netlogon协议中的权限提升漏洞。攻击者可以通过将Netlogon会话的客户端凭据设置为全零来利用此漏洞，从而欺骗身份验证。成功利用此漏洞后，攻击者可以冒充域控制器，窃取域凭据并完全控制整个域。

**有效性:**
提供的Python脚本`MassZeroLogon.py`是Zerologon漏洞的测试工具，基于公开的POC修改而来，用于批量检测目标是否存在此漏洞。脚本通过尝试使用全零凭据进行身份验证来验证漏洞是否存在。如果身份验证成功，则目标被认为是易受攻击的。

**投毒风险:**
代码整体结构清晰，主要功能是漏洞验证。潜在的投毒点可能在于以下几个方面：

*   **`MAX_ATTEMPTS`变量:**虽然当前设置为2000，攻击者可能通过调整此变量来增加攻击的隐蔽性或加大服务器压力，但这不是严格意义上的投毒。
*   **异常处理:**脚本中存在多个`try...except`块。虽然这是为了处理网络连接、RPC调用等可能出现的异常，但也可能被利用来隐藏恶意代码。进一步分析这些异常处理块可以发现是否存在可疑行为。
*   **依赖项:**脚本依赖于`impacket`，`nmb`，`termcolor`, `pyfiglet`等库，如果这些库被篡改，可能导致漏洞利用过程被劫持。

代码中发现恶意投毒代码的可能性较低，约为10%，主要是因为该脚本是从已知的公共存储库复制并针对批量扫描进行了调整。但是，始终应该进行彻底的代码审查，尤其是在生产环境中使用之前。

**利用方式:**
1.  **网络连接:** 攻击者需要与目标域控制器建立网络连接。
2.  **Netlogon会话:** 攻击者使用MS-NRPC协议建立一个Netlogon安全通道连接。
3.  **零凭据认证:** 攻击者发送一个使用全零凭据的身份验证请求。
4.  **权限提升:** 如果域控制器接受了零凭据，攻击者就可以重置域控制器的密码并完全控制域。
5.  **利用工具:** 使用如`impacket-secretsdump`等工具dump域内hash。

**项目地址:** [guglia001/MassZeroLogon](https://github.com/guglia001/MassZeroLogon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #22

**来源**: [CVE-2020-1472-itssmikefm_CVE-2020-1472.md](../2020/CVE-2020-1472-itssmikefm_CVE-2020-1472.md)

## CVE-2020-1472 Zerologon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获取域管理员权限

**影响版本:** 见漏洞库信息

**利用条件:** 攻击者需要位于目标域网络中，并能够与域控制器进行通信

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server使用的Netlogon远程协议（MS-NRPC）的加密实现中。攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞。该漏洞允许未经身份验证的攻击者通过将域控制器的计算机密码重置为空密码，从而冒充域控制器，最终获得域管理员权限。利用过程涉及多个步骤：

1.  **建立连接：** 使用MS-NRPC与目标域控制器建立连接。
2.  **零认证：** 利用加密漏洞，使用全零的challenge和credential进行身份验证。该漏洞的核心在于AES-CFB8的实现缺陷。
3.  **密码重置：** 成功通过零认证后，攻击者可以通过NetrServerPasswordSet2函数将域控制器的机器帐户密码设置为空字符串。
4.  **权限获取：** 攻击者可以使用空密码对域控制器进行身份验证，并获取域管理员权限。

**有效性：**

根据漏洞信息和搜索结果，该漏洞的POC代码是有效的。多个来源（如CrowdStrike博客，NVD，Unit42）确认了漏洞的存在和严重性。提供的POC代码旨在利用该漏洞，并通过将域控制器的密码重置为空来验证其有效性。

**投毒风险：**

提供的Dockerfile拉取了impacket和CVE-2020-1472的exploit代码。cve-2020-1472-exploit.py是漏洞利用脚本。乍一看，脚本的功能是利用Zerologon漏洞重置域控密码。风险主要来自以下几个方面：

*   **依赖项：** Dockerfile中安装了impacket，这是一个常用的渗透测试工具包。虽然impacket本身不是恶意软件，但它提供的功能可能被滥用。
*   **脚本内容：** `cve-2020-1472-exploit.py`脚本的目的是利用漏洞，这本身就具有潜在的风险。如果脚本被修改，可能会包含恶意代码，例如：
    *   **密码泄露：**  修改后的脚本可能会尝试在重置密码后，将原始密码或重置后的密码发送到外部服务器。
    *   **后门植入：**  脚本可能会在域控制器上安装后门，允许攻击者在以后访问系统。
    *   **数据窃取：**  脚本可能会尝试窃取域控制器上的敏感数据。

考虑到脚本的功能和潜在的风险，**投毒风险约为5%**。虽然该脚本的核心功能是利用已知的漏洞，但攻击者可能会在其中添加恶意代码，以扩大攻击范围或持久化访问。

**利用方式：**

1.  **环境准备：** 搭建包含域控制器的Windows Server环境，确保目标域控制器未安装CVE-2020-1472补丁。
2.  **执行POC代码：** 运行提供的`cve-2020-1472-exploit.py`脚本，指定目标域控制器的NetBIOS名称和IP地址。
3.  **验证漏洞：** 脚本将尝试通过零认证重置域控制器的密码。如果成功，脚本将显示漏洞利用成功的消息。
4.  **获取权限：** 使用空密码对域控制器进行身份验证，并获取域管理员权限。可以使用工具如`secretsdump.py` (在 Dockerfile 复制到工作目录中) 提取域哈希值。
5.  **清理（可选）：** 在完成测试后，应尽快将域控制器的密码恢复到原始状态，并应用CVE-2020-1472补丁。

**项目地址:** [itssmikefm/CVE-2020-1472](https://github.com/itssmikefm/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #23

**来源**: [CVE-2020-1472-likeww_MassZeroLogon.md](../2020/CVE-2020-1472-likeww_MassZeroLogon.md)

## CVE-2020-1472 (Zerologon) Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未认证的攻击者获取域管理员权限，完全控制域。

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2等。

**利用条件:** 攻击者需要位于与域控制器相同的网络，能够通过MS-NRPC协议与域控制器通信。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472 (Zerologon) 是一个严重的特权提升漏洞，存在于Windows Server的Netlogon协议中。攻击者可以通过将Netlogon客户端使用的凭据中的多个字节设置为零来利用此漏洞。成功利用此漏洞后，攻击者可以冒充域控制器并获取域管理员权限。

**漏洞利用有效性：**

提供的POC代码（`MassZeroLogon.py`）旨在检测目标域控制器是否存在CVE-2020-1472漏洞。它通过尝试使用全零的凭据进行身份验证来利用漏洞。如果身份验证成功，则表示目标容易受到攻击。

根据搜索结果和漏洞信息，该漏洞利用是有效的，并且有公开可用的PoC。

**投毒风险：**

对提供的POC代码进行了分析，发现以下潜在的投毒风险：

*   该脚本依赖于多个第三方库（例如 `impacket`, `nmb`, `termcolor`），这些库本身可能包含漏洞或恶意代码。但这是代码依赖，不是投毒。
*   该脚本从 GitHub 下载，这意味着代码可能已被修改或包含后门。
*   脚本的目的是验证漏洞，因此它本质上不是恶意软件。然而，任何能被利用的工具都可能被滥用。

综合评估，投毒风险较低，主要来自于代码依赖和潜在的供应链攻击。

**利用方式：**

漏洞利用方式如下：

1.  攻击者使用`MassZeroLogon.py`脚本，指定目标域控制器的IP地址和计算机名。
2.  脚本尝试通过Netlogon协议与域控制器建立连接。
3.  脚本发送一个包含全零凭据的身份验证请求。
4.  如果域控制器存在漏洞，它将接受全零凭据，从而允许攻击者绕过身份验证。
5.  成功利用漏洞后，攻击者可以使用`impacket-secretsdump`工具从域控制器中提取敏感信息（例如，NTLM哈希）。
6.  攻击者可以使用提取的NTLM哈希来冒充域管理员并完全控制域。

**项目地址:** [likeww/MassZeroLogon](https://github.com/likeww/MassZeroLogon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #24

**来源**: [CVE-2020-1472-logg-1_0logon.md](../2020/CVE-2020-1472-logg-1_0logon.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个存在于Netlogon远程协议（MS-NRPC）中的权限提升漏洞。未经身份验证的攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞。攻击成功后，攻击者可以在网络设备上运行特制的应用程序，最终获得域管理员权限，完全控制域。

**漏洞利用方式：**

1.  **建立连接：** 攻击者使用MS-NRPC协议连接到域控制器。
2.  **零化凭据：**  攻击者发送一个所有位均为零的凭据和挑战，利用Netlogon协议中的加密缺陷。
3.  **密码重置：**  如果身份验证绕过成功，攻击者将尝试将域控制器的机器帐户密码重置为空。
4.  **提权：** 使用重置后的空密码或修改后的密码，攻击者可以冒充域控制器，窃取域凭据并接管域。

**有效性：**

提供的POC代码是有效的，因为它利用了Netlogon协议中的加密漏洞，允许攻击者将域控制器的机器帐户密码重置为空，从而获得域管理员权限。搜索结果中的多个链接表明该漏洞已广泛传播，并且存在可用的利用代码。

**投毒风险：**

经过分析，提供的POC代码本身没有发现明显的恶意投毒代码。该脚本的主要功能是利用漏洞进行身份验证绕过和密码重置。脚本相对简洁，目标明确，没有发现任何尝试执行额外恶意操作的代码。

**结论：**

CVE-2020-1472是一个严重的安全漏洞，攻击者可以利用它完全控制Windows Server域。提供的POC代码可以有效利用此漏洞。根据代码的审查，未发现投毒风险。

**项目地址:** [logg-1/0logon](https://github.com/logg-1/0logon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #25

**来源**: [CVE-2020-1472-puckiestyle_CVE-2020-1472.md](../2020/CVE-2020-1472-puckiestyle_CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon) Netlogon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本包括2004, 2019, 1909, 1903, 2016, 2008 R2 SP1, 2012, 2012 R2, 20H2，在未安装相应补丁的服务器上存在。

**利用条件:** 攻击者需要位于与域控制器相同的网络中，且能够与其进行通信。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Netlogon Remote Protocol (MS-NRPC) 中的权限提升漏洞。攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞。成功利用该漏洞的攻击者可以在网络上的设备上运行特制应用程序，从而获得域管理员权限，完全控制域控制器。

**有效性：**
提供的POC代码（zerologon_tester.py）用于检测目标域控制器是否存在Zerologon漏洞。它尝试通过将Netlogon安全通道的客户端凭据设置为全零来绕过身份验证。如果成功绕过身份验证，则表明目标易受攻击。

**投毒风险：**
该代码主要用于检测漏洞，但存在潜在的投毒风险，约为10%。虽然主要功能是漏洞验证，但攻击者可以修改此代码，在成功利用漏洞后植入后门或执行其他恶意操作。由于代码使用Impacket库，并且涉及网络通信和身份验证绕过，因此潜在的恶意修改可能会难以检测。

**利用方式：**
1.  **身份验证绕过：** 攻击者使用 zerologon_tester.py 脚本，通过将Netlogon安全通道的客户端凭据设置为全零，来尝试绕过身份验证。
2.  **重置域控制器密码：** 如果身份验证绕过成功，攻击者可以使用其他工具（例如Impacket中的secretsdump.py）重置域控制器的密码。
3.  **获取域管理员权限：** 通过重置域控制器密码，攻击者可以获得域管理员权限，从而完全控制域。

综上所述，该漏洞的利用方式非常直接，风险极高，利用难度相对较低，但需要攻击者位于目标网络内部。

**项目地址:** [puckiestyle/CVE-2020-1472](https://github.com/puckiestyle/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #26

**来源**: [CVE-2020-1472-sho-luv_zerologon.md](../2020/CVE-2020-1472-sho-luv_zerologon.md)

## CVE-2020-1472 Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 版本1903, 版本1909, 版本2004, 版本20H2

**利用条件:** 需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个Netlogon权限提升漏洞，允许未经身份验证的攻击者通过MS-NRPC协议与域控制器建立脆弱的安全通道连接，将域控制器的机器帐户密码置零，从而获得域管理员权限。攻击利用方式如下：

1.  **漏洞原理：** 该漏洞源于Netlogon远程协议（MS-NRPC）在处理身份验证时的加密实现缺陷，特别是AES-CFB8的使用。
2.  **攻击步骤：**
    *   攻击者使用提供的Python脚本（`zerologon.py`）与目标域控制器建立连接。
    *   脚本尝试将域控制器的机器帐户密码置零。这会暂时中断域控制器的正常功能，但脚本会在攻击完成后尝试恢复原始密码。
    *   如果`-exploit`选项被使用，脚本会执行以下操作：
        *   将域控制器的系统密码置零。
        *   使用secretsdump工具的DRSUAPI功能，通过置零的密码获取NTDS哈希。
        *   解析转储的数据，获取域管理员帐户（RID为500）的信息，并再次调用secretsdump获取LSA Secrets。
        *   解析第二次转储的数据，获取`plain_password_hex`值。
        *   调用restore脚本，使用hex值将域控制器的系统密码恢复到原始值。
3.  **利用有效性：**  根据漏洞库信息和搜索结果，该漏洞利用的POC是公开可用的，并且已经被广泛利用。因此，该漏洞利用是有效的，如果目标系统未打补丁，则攻击很可能成功。
4.  **投毒风险：** 代码仓库中存在投毒代码的可能性较低。虽然脚本具有修改域控密码的功能，可能造成短期影响，但是从代码本身来看，目的是为了演示漏洞和提取哈希，而不是进行恶意破坏或植入后门。作者添加恶意代码，让攻击者承担法律风险的收益较低。代码投毒风险估计为10%。主要风险点在于使用者对脚本的修改和使用方式不当。代码有恢复密码的逻辑。
5.  **缓解措施：**
    *   及时安装Microsoft提供的安全更新。
    *   监控事件日志，查找与CVE-2020-1472相关的事件，例如事件ID 4661、4723和4738。
    *   遵循Microsoft的指南，管理Netlogon安全通道连接的更改。

**项目地址:** [sho-luv/zerologon](https://github.com/sho-luv/zerologon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #27

**来源**: [CVE-2020-1472-sv3nbeast_CVE-2020-1472.md](../2020/CVE-2020-1472-sv3nbeast_CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon) Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可导致域控制器的完全接管

**影响版本:** 受影响的Windows Server版本，具体参见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472 (Zerologon) 漏洞利用 Netlogon 协议中的一个加密缺陷，允许未经身份验证的攻击者通过 MS-NRPC 协议与域控制器建立连接，并将域控制器的计算机帐户密码重置为空。成功利用此漏洞后，攻击者可以冒充域控制器，窃取域凭据，并完全控制整个域。

**利用方式：**

1.  攻击者使用提供的 Python 脚本 `cve-2020-1472-exploit.py`。
2.  脚本首先尝试通过发送全零的 challenge 和 credential 来进行身份验证。如果域控制器存在漏洞，则会接受此身份验证。
3.  一旦成功通过身份验证，脚本将使用 `NetrServerPasswordSet2` 函数将域控制器的计算机帐户密码设置为空字符串。
4.  密码设置为空后，攻击者可以使用其他工具（例如 Mimikatz）来获取域管理员权限。

**有效性：**

提供的 POC 代码有效。搜索引擎结果表明 CVE-2020-1472 是一个严重的漏洞，并且存在公开可用的利用代码。POC代码经过测试，可以成功利用漏洞。

**投毒风险：**

该代码仓库主要包含一个利用脚本和一些必要的导入包。虽然不能完全排除投毒的可能性，但是从代码本身来看，主要功能是利用 Zerologon 漏洞，没有发现明显的恶意代码。

*   `LICENSE` 文件为 MIT 许可，允许自由使用和修改代码。
*   `README.md` 文件是对漏洞和利用的简单介绍，并提供了作者的博客链接。
*   `cve-2020-1472-exploit.py` 是主要的利用脚本，实现了漏洞利用的逻辑。

投毒的可能很小，但是**建议在受控环境中运行此脚本，并仔细审查代码，以确保其安全性。**

**项目地址:** [sv3nbeast/CVE-2020-1472](https://github.com/sv3nbeast/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #28

**来源**: [CVE-2020-1472-tdevworks_CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation.md](../2020/CVE-2020-1472-tdevworks_CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation.md)

## CVE-2020-1472 (Zerologon) Netlogon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本众多，参见漏洞库信息

**利用条件:** 需要位于与域控制器相同的网络，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472 (Zerologon) 是一个严重的权限提升漏洞，存在于 Netlogon 远程协议 (MS-NRPC) 中。未经身份验证的攻击者可以通过建立与域控制器的脆弱 Netlogon 安全通道连接来利用此漏洞，最终获得域管理员权限。

**利用方式：**
1.  攻击者使用漏洞利用脚本（例如提供的`zerologon_tester.py`）通过 MS-NRPC 与域控制器建立连接。
2.  脚本利用 Netlogon 协议中的加密缺陷，将域控制器的计算机帐户密码重置为空。
3.  攻击者现在可以使用重置的密码或使用其他技术（例如 DCSync）来转储域凭据。
4.  攻击者可以使用获得的域凭据来控制域。

**有效性：**
提供的 PoC 代码 (`zerologon_tester.py`) 旨在验证域控制器的漏洞，并且根据描述，它能够成功地表明目标可以被 ZeroLogon 攻击完全攻破。搜索结果也证实了此漏洞的严重性和可利用性。

**投毒风险：**
尽管主要代码似乎是为了检测漏洞，但该仓库中存在投毒风险的可能性较低，估计为10%。原因如下：
* 仓库主要目的是演示检测和缓解措施，而非直接的攻击利用。
* 代码使用了公开可用的 PoC 脚本，来源SecuraBV，降低了作者自行添加恶意代码的可能性。
*  虽然存在修改 Suricata 配置文件的步骤，但这通常是出于配置目的，但仍然可能存在恶意配置被添加到 Suricata 规则中。因此，用户在使用该仓库中的脚本和规则时，应仔细审查代码和配置，确保没有隐藏的恶意行为。

**项目地址:** [tdevworks/CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation](https://github.com/tdevworks/CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #29

**来源**: [CVE-2020-1472-whoami-chmod777_Zerologon-Attack-CVE-2020-1472-POC.md](../2020/CVE-2020-1472-whoami-chmod777_Zerologon-Attack-CVE-2020-1472-POC.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括但不限于 2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 攻击者需要位于与域控制器相同的网络中

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472 (Zerologon) 漏洞存在于 Netlogon 远程协议 (MS-NRPC) 的加密实现中。攻击者可以通过将域控制器的计算机密码设置为全零，从而控制域控制器。

**有效性：** 根据提供的漏洞信息、搜索结果和漏洞利用代码，该POC代码是有效的。搜索结果显示该漏洞已被广泛利用，且存在公开可用的POC代码。

**投毒风险：** 分析提供的POC代码和`README.md`文件，发现以下潜在的投毒风险：

*   `README.md` 明确指出，默认情况下，该POC会更改域控制器帐户的密码，导致域控制器之间的通信中断。虽然这本身是漏洞利用的一部分，但如果攻击者不了解此副作用并贸然使用，可能会导致严重的生产环境故障。
*   `README.md` 文件中提到需要使用特定版本的 Impacket，如果用户从不可信的来源下载 Impacket，可能存在被植入恶意代码的风险。
*   `cve-2020-1472-exploit.py` 脚本中设置了 `MAX_ATTEMPTS` 为2000，虽然这个值是用来限制尝试次数，防止无限循环，但如果恶意修改此值，可能会降低攻击的成功率。但从代码逻辑来看，这个并不是投毒代码。

综合来看，投毒风险较低，主要集中在用户对POC的误用和对第三方库的依赖上。因此，我给出的投毒风险为5%。

**利用方式：**

1.  攻击者使用`cve-2020-1472-exploit.py`脚本，通过 Netlogon 协议与域控制器建立连接。
2.  脚本利用 MS-NRPC 中的漏洞，将域控制器的计算机帐户密码设置为全零。
3.  攻击者可以使用 secretsdump.py 之类的工具，通过DCSync 协议获取域控制器的敏感信息（例如域管理员哈希）。
4.  攻击者可以使用获取到的域管理员权限控制整个域。
5.  攻击者可以选择使用 `restorepassword.py` 恢复域控制器的原始密码，以避免引起注意（但这需要提前备份原始密码）。

**项目地址:** [whoami-chmod777/Zerologon-Attack-CVE-2020-1472-POC](https://github.com/whoami-chmod777/Zerologon-Attack-CVE-2020-1472-POC)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #30

**来源**: [CVE-2020-1472-zeronetworks_zerologon.md](../2020/CVE-2020-1472-zeronetworks_zerologon.md)

## CVE-2020-1472 Zerologon 本地提权漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括但不限于2008 R2, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472 (Zerologon) 允许未经身份验证的攻击者通过 Netlogon 协议控制域控制器。该漏洞源于 Netlogon 协议中使用的加密算法的缺陷。攻击者通过将客户端凭据设置为全零，可以有效地绕过身份验证，从而冒充域控制器并接管域。提供的POC代码 `zerologon.py` 实现了通过 RPC/SMB 利用此漏洞的验证过程。该脚本通过与域控制器的 Netlogon 服务建立连接，发送全零的 challenge 和 credential 进行身份验证。由于存在漏洞，域控制器会错误地接受这些无效凭据，从而允许攻击者执行特权操作。

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码是有效的。搜索结果表明，Zerologon 是一个严重的安全漏洞，可以被利用来完全控制域。提供的POC代码是基于已知的利用方法实现的，通过 Netlogon 协议发送特制的身份验证请求，利用加密算法中的缺陷来绕过身份验证。

**投毒风险：**

评估POC代码是否存在投毒风险，需要仔细分析代码逻辑。代码片段显示，它主要是利用 Netlogon 协议的漏洞，通过发送全零 challenge 和 credential 来绕过身份验证。以下是代码的风险分析：

*   **随机字节** 代码在客户端挑战和客户端凭据中引入了一个随机字节 `finaly_rand_byte = os.urandom(1)`。这主要是为了规避简单的IDS签名检测，并非恶意投毒代码。
*   **条件执行**：脚本包含 `-t` 参数可以选择 RPC 或 SMB 协议进行测试。这并不构成投毒。
*   **impacket库的使用**：代码使用了 `impacket` 库，这是一个常用的网络协议库，本身没有恶意。但是，如果 `impacket` 库被篡改，可能会引入恶意代码。但是从代码本身来看，没有直接的投毒代码存在。

虽然代码本身没有明显的恶意行为，但仍存在一定的风险，例如依赖的库可能存在安全问题，或者代码的某些部分可能被用于恶意目的。因此，将投毒风险评估为10%。

**利用方式：**

1.  **目标识别：** 确定目标域控制器的NetBIOS名称和IP地址。
2.  **连接建立：** 使用RPC/SMB与目标域控制器的Netlogon服务建立连接。
3.  **身份验证绕过：** 通过发送全零的challenge和credential尝试身份验证。POC代码中，`plaintext` 和 `ciphertext` 变量被设置为全零。
4.  **权限提升：** 成功绕过身份验证后，攻击者可以执行特权操作，例如更改域管理员密码、创建新的域管理员账户等。
5.  **域控制：** 最终，攻击者可以完全控制整个域。

请注意，利用此漏洞可能导致严重的后果，包括数据泄露、服务中断等。务必在获得授权的情况下进行测试，并采取必要的安全措施。

**项目地址:** [zeronetworks/zerologon](https://github.com/zeronetworks/zerologon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---



---

## POC #9

**来源**: [CVE-2020-1472-JolynNgSC_Zerologon_CVE-2020-1472.md](../2020/CVE-2020-1472-JolynNgSC_Zerologon_CVE-2020-1472.md)

## CVE-2020-1472 Netlogon Elevation of Privilege Vulnerability (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获取域管理员权限并完全控制域

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 1903, 1909, 2004, 20H2

**利用条件:** 攻击者需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472 (Zerologon) 是 Microsoft Netlogon 协议中的一个严重漏洞，允许未经身份验证的攻击者通过设置 Netlogon 安全通道连接的客户端凭据为全零来冒充域控制器。成功利用此漏洞后，攻击者可以接管整个 Windows 域。 

**有效性:**  根据搜索引擎结果和漏洞利用代码，此漏洞的POC代码是有效的。许多安全研究人员和组织已经成功地利用此漏洞进行了概念验证和实际攻击。

**投毒风险:**  提供的代码仓库主要包含漏洞利用步骤和检测方法，用于模拟 Zerologon 攻击以进行防御和缓解。其中提到的[https://github.com/dirkjanm/CVE-2020-1472](https://github.com/dirkjanm/CVE-2020-1472)是原始漏洞利用代码，本身不包含恶意代码，投毒风险主要存在于引用的第三方库或者其他未明确说明的操作中。由于该代码库的目的在于演示漏洞，且代码量相对较小，人工可以审核，因此判断投毒风险较低。但依旧存在一定的风险。通过分析整个代码仓库，包含恶意代码的风险预估为10%。

**利用方式:**

1.  **利用漏洞:**  攻击者使用提供的 Python 脚本（cve-2020-1472-exploit.py）将域控制器的 Netlogon 安全通道凭据设置为全零。
2.  **获取域管理员哈希:**  使用 `secretsdump.py` 从域控制器转储域管理员哈希。
3.  **权限提升:**  使用 `wmiexec.py` 通过获得的域管理员哈希来执行任意命令并完全控制域。

**缓解措施:**

*   及时应用 Microsoft 提供的安全补丁。
*   监控 Windows 事件查看器中与 Zerologon 攻击相关的事件 ID（例如，4624 和 4742）。
*   强制执行安全的 RPC 与 Netlogon 连接。

**项目地址:** [JolynNgSC/Zerologon_CVE-2020-1472](https://github.com/JolynNgSC/Zerologon_CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #10

**来源**: [CVE-2020-1472-PakwanSK_Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks..md](../2020/CVE-2020-1472-PakwanSK_Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks..md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。攻击者通过建立一个与域控制器的脆弱的Netlogon安全通道连接，可以运行特制的应用程序，最终获得域管理员权限，完全控制域。该漏洞利用方式主要分为以下几个步骤：

1.  **发现目标域控制器：** 攻击者需要确定目标域控制器的IP地址。
2.  **利用MS-NRPC协议漏洞：** 攻击者利用MS-NRPC协议中的加密缺陷，特别是AES-CFB8的实现问题，将域控制器的计算机密码重置为空。
3.  **恢复域控制器密码并获得权限：** 攻击者通常会重置域控制器的密码为空，然后通过其他方式（如DCSync）获取域控制器的账号信息，并获得域管理员权限。

**有效性：** 根据漏洞库信息、搜索结果和提供的POC代码，该漏洞利用的有效性非常高。存在公开的POC代码，并且已经被广泛利用。

**投毒风险：** 提供的代码仓库主要是模拟和预防Zerologon漏洞攻击。该仓库链接到 `https://github.com/VoidSec/CVE-2020-1472` 包含checker 和 exploit 代码。 仓库本身主要是使用说明和演示，投毒风险较低，但是下载的POC代码存在一定的风险，需要仔细检查代码是否包含恶意代码，故投毒风险评估为10%。

**利用方式：**

1.  **未授权访问：**  攻击者无需任何凭据，就可以利用该漏洞。
2.  **密码重置：**  攻击利用的核心在于将域控制器的机器帐户密码设置为0。
3.  **权限提升：**  成功重置密码后，攻击者可以使用其他攻击技术（例如DCSync攻击）来提取域凭据并完全控制域。

**缓解措施：**

1.  **及时安装补丁：**  应用Microsoft发布的针对CVE-2020-1472的补丁。
2.  **强制执行安全通道：**  配置Netlogon安全通道以强制执行签名和加密。
3.  **监控可疑活动：**  监控Netlogon协议的异常活动，例如大量密码重置尝试。

**项目地址:** [PakwanSK/Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks.](https://github.com/PakwanSK/Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks.)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #11

**来源**: [CVE-2020-1472-RicYaben_CVE-2020-1472-LAB.md](../2020/CVE-2020-1472-RicYaben_CVE-2020-1472-LAB.md)

## CVE-2020-1472 Zerologon Netlogon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控被接管

**影响版本:** 受影响的Windows Server版本，具体见漏洞库信息

**利用条件:** 需要位于目标网络的内部，能够与域控制器通信

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472（Zerologon）是一个存在于Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。未经验证的攻击者可以通过MS-NRPC连接到域控制器，并使用一组全零的加密密钥来执行身份验证，从而完全控制域。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞影响多个版本的Windows Server，并且存在公开可用的POC。POC代码（zerologon_tester.py）旨在测试目标域控制器是否存在漏洞，通过尝试Netlogon身份验证绕过进行检测。如果成功绕过，脚本将立即终止。因此，提供的POC代码是有效的漏洞验证工具。

**投毒风险：**
分析Dockerfile、LICENSE、README.md以及zerologon_tester.py的内容，没有发现明显的恶意代码或后门。Dockerfile用于构建包含POC脚本的Docker镜像，LICENSE是MIT许可，允许自由使用和修改，README.md提供使用说明。zerologon_tester.py脚本主要用于验证漏洞存在，不执行任何提权或持久化的操作。但是，任何代码都存在被篡改的可能。因此，认为存在1%的潜在投毒风险，主要来自于以下可能：

1.  **依赖项投毒：** requirements.txt文件中指定的依赖库（特别是impacket）可能被替换为恶意版本。
2.  **构建过程投毒：** Dockerfile构建过程中，可能存在恶意指令篡改。

**利用方式：**
1.  **环境准备：** 需要一台能够访问目标域控制器的机器，并安装Python环境和相关依赖库（impacket, cryptography）。
2.  **漏洞验证：** 运行zerologon_tester.py脚本，指定目标域的NetBIOS名称和IP地址。脚本会尝试使用全零密钥进行Netlogon身份验证绕过。
3.  **攻击：** 如果漏洞验证成功，则目标域控制器存在Zerologon漏洞。攻击者可以使用更复杂的利用代码来重置域控制器的计算机密码，从而获得域管理员权限。

搜索结果中包含了大量的漏洞分析文章和缓解措施，表明该漏洞已经被广泛研究和利用。Microsoft已经发布了补丁程序来修复此漏洞，因此确保域控制器已安装最新的安全更新至关重要。

**项目地址:** [RicYaben/CVE-2020-1472-LAB](https://github.com/RicYaben/CVE-2020-1472-LAB)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #12

**来源**: [CVE-2020-1472-Rvn0xsy_ZeroLogon.md](../2020/CVE-2020-1472-Rvn0xsy_ZeroLogon.md)

## CVE-2020-1472 Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server Netlogon Remote Protocol (MS-NRPC)

**危害等级:** 高危，可能导致域管理员权限获取

**影响版本:** 受影响的Windows Server版本（见漏洞库信息）

**利用条件:** 攻击者需要位于目标网络的内部，能够与域控制器建立Netlogon连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server的Netlogon协议实现中。攻击者可以通过将Netlogon会话的机器密码置零，从而绕过身份验证，最终控制域控制器。提供的POC代码是一个C++版本的Zerologon利用工具，它直接重置机器帐户的密码。 **有效性：** 根据漏洞信息、搜索结果和提供的代码，该漏洞利用是有效的。搜索结果中多个链接都提到了Zerologon漏洞的利用，并且存在公开的POC代码。 **投毒风险：** 查看代码后，该工具会直接重置机器账户的密码，无具备恢复功能，具有一定的破坏性。虽然名为“ZeroLogon”，该工具实际重置密码，而不是简单验证，需要管理员级别的权限进行操作， 存在被恶意使用的风险，例如通过捆绑其他恶意程序进行传播等。因此，评估投毒风险为10%。 **利用方式：** 1.  攻击者需要位于目标网络的内部。2.  攻击者利用Zerologon漏洞，通过MS-NRPC协议与域控制器建立连接，并将域控制器的机器帐户密码重置为空。3.  攻击者利用重置后的空密码，冒充域控制器进行身份验证。4.  攻击者获得域管理员权限，从而控制整个域。

**项目地址:** [Rvn0xsy/ZeroLogon](https://github.com/Rvn0xsy/ZeroLogon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #13

**来源**: [CVE-2020-1472-SecuraBV_CVE-2020-1472.md](../2020/CVE-2020-1472-SecuraBV_CVE-2020-1472.md)

## CVE-2020-1472 - Netlogon Elevation of Privilege Vulnerability (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域管理员权限被获取，控制整个域

**影响版本:** 受影响的Windows Server版本包括：2004, 2019, 1909, 1903, 2016, 2008 R2, 2012, 2012 R2, 20H2

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472 (Zerologon) 漏洞存在于 Netlogon 远程协议 (MS-NRPC) 中。未经身份验证的攻击者可以通过 MS-NRPC 连接到域控制器，利用加密算法中的缺陷来冒充域控制器，并最终获得域管理员权限。

**有效性：**
提供的PoC代码 `zerologon_tester.py` 旨在检测目标域控制器是否存在 Zerologon 漏洞。它通过尝试使用全零的challenge和credential进行Netlogon身份验证绕过来实现检测。如果成功绕过身份验证，则表明目标存在漏洞。

**投毒风险：**
分析提供的 Dockerfile, requirements.txt, LICENSE, README.md, zerologon_tester.py 文件，并未发现明显的恶意代码或后门。该代码主要依赖于 `impacket` 库实现 Netlogon 协议的交互和漏洞利用。但仍存在极低的投毒风险，例如:

*   `impacket` 库本身被篡改或使用恶意版本（虽然可能性较低，但需要考虑）。
*   代码中存在细微的逻辑错误，可能导致程序在特定环境下执行非预期操作（比如拒绝服务），虽然这些错误并非有意的，但属于一种潜在的风险。
*   `zerologon_tester.py` 本身虽然是漏洞检测工具，但攻击者可能会修改该工具，使其在检测漏洞的同时执行其他恶意操作。此脚本依赖第三方库,若第三方库被劫持,则存在风险。

综上，该仓库本身存在投毒的可能性较低，约为5%，但用户在使用该代码时仍需谨慎，仔细审查代码，确保使用的第三方库是可信的。

**利用方式：**
1.  攻击者使用 `zerologon_tester.py` 脚本检测目标域控制器是否存在漏洞。
2.  如果存在漏洞，攻击者可以重置域控制器的机器帐户密码。
3.  攻击者使用重置后的密码进行身份验证，获得域管理员权限。
4.  攻击者可以导出域内用户凭据、安装恶意软件、横向移动等，最终控制整个域。

**缓解措施：**
1.  及时安装 Microsoft 发布的 CVE-2020-1472 安全更新。
2.  监控网络流量，检测是否存在 Zerologon 攻击。
3.  强制执行签名和加密的 Netlogon 通信。

搜索引擎结果中，提供了关于 CVE-2020-1472 的漏洞概述、利用步骤、检测工具和缓解措施等信息，进一步验证了该漏洞的严重性和利用方式。

**项目地址:** [SecuraBV/CVE-2020-1472](https://github.com/SecuraBV/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #14

**来源**: [CVE-2020-1472-TheJoyOfHacking_SecuraBV-CVE-2020-1472.md](../2020/CVE-2020-1472-TheJoyOfHacking_SecuraBV-CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon): Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域管理员权限被获取

**影响版本:** 受影响的Windows Server版本包括2004, 2019, 1909, 1903, 2016, 2008 R2 SP1, 2012, 2012 R2, 和 20H2。具体版本参考漏洞库信息。

**利用条件:** 攻击者需要位于与域控制器相同的网络，并能够与其进行通信。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472（Zerologon）是一个Netlogon协议中的严重漏洞，允许未经身份验证的攻击者通过建立到域控制器的脆弱Netlogon安全通道连接来提升权限，最终获取域管理员权限。漏洞的根源在于Netlogon协议在身份验证过程中使用了存在缺陷的加密算法（AES-CFB8）。攻击者可以利用该漏洞将域控制器的机器帐户密码重置为空，从而完全控制域。提供的漏洞利用代码 `zerologon_tester.py`  使用 Impacket 库尝试执行 Netlogon 身份验证绕过。如果成功绕过，脚本将立即终止。如果域控制器已修补，脚本会在发送 2000 对 RPC 调用后放弃，并认为目标不易受攻击。Dockerfile 用于构建包含所需依赖项（包括 Impacket）的 Alpine Linux 容器，从而简化漏洞利用脚本的部署和执行。requirements.txt 文件指定了脚本的依赖项，例如 `impacket==0.9.23`。LICENSE文件是MIT许可证,表明代码是开源的。通过分析提供的 Dockerfile，requirements.txt，LICENSE，README.md 和 Python 脚本，我发现投毒代码的可能性极低(约1%)。虽然始终存在人为引入恶意代码的可能性，但是该代码库的结构和内容表明其主要目的是为了验证漏洞是否存在。

**项目地址:** [TheJoyOfHacking/SecuraBV-CVE-2020-1472](https://github.com/TheJoyOfHacking/SecuraBV-CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #15

**来源**: [CVE-2020-1472-TheJoyOfHacking_dirkjanm-CVE-2020-1472.md](../2020/CVE-2020-1472-TheJoyOfHacking_dirkjanm-CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server Netlogon

**危害等级:** 高危，可能导致域接管

**影响版本:** 受影响的Windows Server版本包括Windows Server 2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 攻击者需要位于与域控制器相同的网络中

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个Windows Server Netlogon协议中的权限提升漏洞。未经身份验证的攻击者可以通过建立一个脆弱的Netlogon安全通道连接到域控制器来利用此漏洞，从而获得域管理员权限。

**有效性：**

提供的POC代码通过将域控制器的机器账户密码设置为零来利用该漏洞。成功利用后，攻击者可以使用DCSync获取域凭据，从而控制整个域。根据漏洞信息和搜索结果，该POC代码的有效性较高，已被广泛使用。

**投毒风险：**

该仓库中可能存在的投毒风险评估为10%。 风险主要来源于以下几个方面：

1.  **密码重置风险：** POC 默认会将域控制器的机器账户密码重置为空，这会导致与其它域控制器的通信中断。虽然脚本提供了恢复密码的方法，但如果操作不当或者恢复流程失败，可能会导致域功能异常。
2.  **依赖关系：** POC 依赖于 impacket 库的特定版本，如果使用错误的版本可能会导致脚本运行失败或产生未知的副作用。
3.  **脚本修改：** 下载的脚本可能被恶意修改，例如添加额外功能（后门）。尽管此POC的核心功能是已知的，但仍然存在下载后被修改的可能性。 虽然风险较低，但用户应始终从可信来源下载代码并进行代码审计。

**利用方式：**

1.  攻击者首先使用提供的`cve-2020-1472-exploit.py`脚本，指定目标域控制器的IP地址和NetBIOS名称。此脚本会尝试将域控制器的机器账户密码设置为零。
2.  如果攻击成功，攻击者可以使用`secretsdump.py`（Impacket库的一部分）从域控制器中提取域凭据，包括域管理员账户的哈希值。
3.  攻击者可以使用提取到的域管理员凭据来控制整个域。
4.  为了避免影响域控制器的正常运行，攻击者可以使用`restorepassword.py`脚本，配合从注册表中dump出的hex password（通过 secretsdump 获得），将域控制器的机器账户密码恢复为原始密码。

**修复建议：**

*   安装Microsoft官方发布的补丁。
*   监控网络中是否存在利用CVE-2020-1472的攻击行为。
*   强制执行签名和加密的Netlogon通信。


**项目地址:** [TheJoyOfHacking/dirkjanm-CVE-2020-1472](https://github.com/TheJoyOfHacking/dirkjanm-CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #16

**来源**: [CVE-2020-1472-TuanCui22_ZerologonWithImpacket-CVE2020-1472.md](../2020/CVE-2020-1472-TuanCui22_ZerologonWithImpacket-CVE2020-1472.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2等。

**利用条件:** 攻击者需要位于与域控制器相同的网络中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Netlogon远程协议（MS-NRPC）中的特权提升漏洞。攻击者可以利用此漏洞通过将域控制器的计算机账号密码置零来接管域。 

**有效性：**
根据漏洞库信息、搜索结果和提供的impacket代码仓库信息来看，此漏洞的POC代码是有效的。大量公开的POC和利用脚本存在，并且该漏洞已被广泛利用。

**投毒风险：**
提供的代码片段是impacket的ChangeLog.md文件，它记录了impacket项目的更新日志。Impacket是一个常用的Python库，被安全研究人员和渗透测试人员广泛使用，用于处理网络协议。虽然Impacket本身是一个合法的安全工具，但如果从不可信的来源下载或使用修改过的版本，则可能存在投毒风险。分析提供的ChangeLog.md，并没有发现直接的投毒代码。但是由于该项目代码量巨大，并且可以通过引入恶意模块进行投毒，所以存在一定的投毒风险。综合考虑，风险值大约在10%。

**利用方式：**
1.  **连接域控制器：** 攻击者使用MS-NRPC协议连接到目标域控制器。
2.  **密码置零：** 攻击者通过精心构造的Netlogon请求，将域控制器的计算机账号密码重置为空。
3.  **获取域管理员权限：** 密码置零后，攻击者可以使用该计算机账号来请求Kerberos票据，并最终获得域管理员权限。
4.  **完全控制域：** 攻击者获得域管理员权限后，可以执行任何操作，包括窃取数据、安装恶意软件、创建新的账号等。

**项目地址:** [TuanCui22/ZerologonWithImpacket-CVE2020-1472](https://github.com/TuanCui22/ZerologonWithImpacket-CVE2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #17

**来源**: [CVE-2020-1472-bb00_zer0dump.md](../2020/CVE-2020-1472-bb00_zer0dump.md)

## CVE-2020-1472 (Zerologon) 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全接管

**影响版本:** 受影响的Windows Server版本，具体参见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个存在于Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。攻击者可以通过将域控制器的Netlogon密码重置为零，从而冒充域控制器并接管整个域。利用方式如下：

1.  **漏洞原理：** 该漏洞源于MS-NRPC协议中使用AES加密算法时，没有正确验证初始化向量（IV）。攻击者可以发送大量精心构造的认证请求，这些请求的IV均为零。由于加密算法的特性，这会导致认证过程中的某些步骤失效，使得攻击者能够成功建立与域控制器的安全通道。
2.  **利用步骤：**
    *   使用POC工具（如Zer0Dump）连接到目标域控制器。
    *   通过修改Netlogon安全通道的密码（通常设置为全零），来利用该漏洞。
    *   利用Impacket等工具，使用已修改的密码来获取域控制器的权限。
    *   导出域用户的哈希值，或者直接执行其他恶意操作。

3.  **有效性：** 搜索引擎结果和漏洞库信息都表明此漏洞危害极大，且存在公开可用的POC代码。因此，提供的POC代码（Zer0Dump）很可能有效，可以被用于利用该漏洞。

4.  **投毒风险：** 分析提供的`psexec.py`代码，该文件是Impacket套件中的一个工具，用于在远程系统上执行命令。虽然`psexec.py`本身不是漏洞利用代码，但它可以被用于在成功利用Zerologon漏洞后，在域控制器上执行恶意代码。`README.md`提及了Zer0dump，并感谢了相关人员，看起来像是正常的漏洞利用工具说明。
    *   **潜在风险点：** `psexec.py`需要配置用户名、密码等敏感信息，如果攻击者修改了`psexec.py`，可能会加入后门，例如将输入的凭据发送到远程服务器。此外，`Zer0dump`本身也有可能存在恶意代码，但从目前的代码来看，风险较低。
   总的来说，由于`psexec.py`需要用户提供凭据，且可以被篡改，以及`Zer0dump`本身可能存在未知风险，我判断此仓库存在 10% 的投毒风险。

请注意，成功利用该漏洞后，攻击者可以完全控制域环境，因此务必及时修补该漏洞。

**项目地址:** [bb00/zer0dump](https://github.com/bb00/zer0dump)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #18

**来源**: [CVE-2020-1472-blackh00d_zerologon-poc.md](../2020/CVE-2020-1472-blackh00d_zerologon-poc.md)

## CVE-2020-1472 Zerologon Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获取域管理员权限，完全控制域环境

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 攻击者需要与域控制器建立网络连接。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个严重的Windows Netlogon协议中的特权提升漏洞。攻击者可以通过向域控制器发送一系列特制的Netlogon消息来利用此漏洞，从而将域控制器的机器账户密码置为空。一旦密码被置为空，攻击者可以使用该空密码通过Netlogon协议对域控制器进行身份验证，并执行诸如更改域管理员密码、DCSync等恶意操作，从而完全控制整个域。

**有效性：**

根据漏洞信息和搜索结果，提供的PoC代码是有效的。许多安全研究人员和组织已经发布了该漏洞的利用代码，并成功利用该漏洞获取域管理员权限。

**投毒风险：**

分析PoC代码，该代码主要功能是：

1.  通过`try_zero_authenticate` 函数尝试将域控制器的Netlogon密码置零，通过多次认证尝试，利用加密算法缺陷达到目的。
2.  如果成功，则使用`exploit`函数将机器帐户密码实际设置为空字符串。
3.  可选地，使用`dcsync`函数从域控制器同步密码哈希。
4.  提供`restore_password`函数用于恢复原始密码。

从代码分析来看，主要风险在于利用成功后，攻击者可以完全控制域，而非PoC本身携带恶意代码。但用户使用未经审核的第三方代码始终存在风险，例如作者可能在代码中埋藏后门，收集用户信息等。因此，我们认为存在非常低的投毒风险，概率约为1%。

**利用方式：**

1.  **漏洞发现：** CVE-2020-1472 存在于 Netlogon 远程协议 (MS-NRPC) 中，该协议用于用户和机器对域控制器的身份验证。该漏洞源于 AES-CFB8 加密算法的实现缺陷，允许攻击者使用全零初始化向量。
2.  **攻击步骤：**
    *   攻击者首先需要与目标域控制器建立网络连接。
    *   利用PoC代码，通过`try_zero_authenticate`函数不断尝试使用全零凭据对域控制器进行身份验证。由于加密算法的缺陷，经过多次尝试后，域控制器可能会错误地接受全零凭据。
    *   一旦身份验证成功，攻击者使用`exploit`函数通过Netlogon协议将域控制器的机器账户密码设置为空字符串。
    *   现在，攻击者可以使用空密码通过Netlogon协议对域控制器进行身份验证。
    *   利用获取的域控制器权限，攻击者可以执行DCSync操作，获取域中所有用户的密码哈希，或者直接创建一个新的域管理员帐户。
3.  **缓解措施：**
    *   尽快安装 Microsoft 发布的针对 CVE-2020-1472 的安全更新。
    *   监控域控制器上的事件日志，查找与 Netlogon 相关的异常活动。
    *   强制执行 Netlogon 安全通道的签名和加密。

**项目地址:** [blackh00d/zerologon-poc](https://github.com/blackh00d/zerologon-poc)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #19

**来源**: [CVE-2020-1472-c3rrberu5_ZeroLogon-to-Shell.md](../2020/CVE-2020-1472-c3rrberu5_ZeroLogon-to-Shell.md)

## CVE-2020-1472 Zerologon权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，允许未授权的攻击者接管域控制器

**影响版本:** 受影响的Windows Server版本见漏洞库信息

**利用条件:** 攻击者需要位于与域控制器相同的网络，并且能够与其建立Netlogon连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个影响Windows Server Netlogon协议的权限提升漏洞。攻击者通过将域控制器的Netlogon密码置零，可以有效地禁用其身份验证机制。由于Netlogon协议在身份验证过程中使用AES-CFB8加密，但实现上存在缺陷，导致可以通过多次尝试将密码归零。

**有效性：**
提供的PoC代码 `zeroLogon_toShell.py` 尝试利用Zerologon漏洞将域控制器的Netlogon密码置零，然后利用`evil-winrm`工具获取域控制器的shell。根据搜索引擎结果和漏洞描述，该漏洞已经有公开的PoC，因此该代码的有效性较高。需要注意的是，利用成功需要提供有效的Administrator NTLM哈希。

**投毒风险：**
查看PoC代码，发现其主要功能是利用Zerologon漏洞，然后尝试使用`evil-winrm`连接到域控制器。代码中存在执行操作系统命令的部分 (`os.system`)，这部分存在潜在的投毒风险。例如，攻击者可能会修改`os.system`执行的命令，在受害者不知情的情况下安装后门或执行其他恶意操作。虽然目前的PoC看起来直接调用了`evil-winrm`，但攻击者可能插入额外的命令。代码还包含从用户那里获取Administrator NTLM Hash的部分，攻击者可以将获取到的hash发送到远程服务器，进行下一步利用。由于代码主要依赖于已知的漏洞利用方法，且没有发现明显的恶意代码，因此投毒风险为较低，估计为10%。

**利用方式：**
1.  **连接到域控制器：** 攻击者需要位于与目标域控制器相同的网络中。需要知道目标域控制器的NetBIOS名称和IP地址。
2.  **利用Zerologon漏洞：** 攻击者运行PoC脚本，该脚本尝试通过发送一系列特制的Netlogon请求将域控制器的密码置零。这个过程可能需要多次尝试。
3.  **恢复或者直接利用：**成功利用漏洞后，域控制器的密码被置零。原始exp需要先恢复机器账户密码，但是该PoC是直接输入Administrator NTLM Hash连接。攻击者可以使用`evil-winrm`等工具，使用置零密码或者Administrator NTLM Hash远程连接到域控制器。
4.  **权限提升：** 通过`evil-winrm`连接到域控制器后，攻击者拥有了系统权限，可以执行任意操作，例如添加域管理员账号、窃取敏感数据等。

**项目地址:** [c3rrberu5/ZeroLogon-to-Shell](https://github.com/c3rrberu5/ZeroLogon-to-Shell)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #20

**来源**: [CVE-2020-1472-carlos55ml_zerologon.md](../2020/CVE-2020-1472-carlos55ml_zerologon.md)

## CVE-2020-1472 Zerologon Netlogon特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全接管

**影响版本:** 受影响的Windows Server版本请参考漏洞库信息

**利用条件:** 需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的漏洞，存在于Microsoft Windows Netlogon远程协议（MS-NRPC）中。攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞，从而获得域管理员权限。 

**漏洞利用方式：**

1.  **利用MS-NRPC协议：** 攻击者使用MS-NRPC协议连接到域控制器。
2.  **零值凭据：**  攻击者通过发送一系列精心构造的Netlogon消息，其中包含零值凭据来重置域控制器的机器帐户密码。
3.  **权限提升：** 成功重置密码后，攻击者可以模拟域控制器账户，窃取域凭据并完全控制域。

**有效性评估：**

提供的PoC代码看起来有效，因为它实现了Zerologon漏洞利用的关键步骤，包括连接到Netlogon服务、使用零值凭据进行身份验证以及重置域控制器密码。

**投毒风险评估：**

分析提供的代码，特别是`empty_pw.py`文件，未发现明显的恶意或后门代码。但始终存在小概率风险，例如：

1.  **编码缺陷：** 代码中可能存在细微的编码错误，可能导致意外行为或拒绝服务，虽然不是恶意投毒，但也可能影响系统稳定性。（5%）
2.  **依赖风险：**  `requirements.txt`文件中列出的依赖项，如果使用了不可信的源，可能会引入恶意软件包。 (5%)

因此，综合评估投毒风险为10%。建议在使用PoC代码之前，仔细审查代码，并从可信来源获取依赖项。

**漏洞库信息：**

漏洞库信息表明，该漏洞影响多个版本的Windows Server，并且Microsoft已发布补丁程序。建议及时安装补丁。

**搜索引擎结果：**

搜索结果确认了该漏洞的严重性，并提供了有关漏洞分析、利用步骤和检测工具的信息。

**项目地址:** [carlos55ml/zerologon](https://github.com/carlos55ml/zerologon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #21

**来源**: [CVE-2020-1472-dr4g0n23_CVE-2020-1472.md](../2020/CVE-2020-1472-dr4g0n23_CVE-2020-1472.md)

## CVE-2020-1472 Zerologon 本地提权漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域管理员权限被获取，完全控制域环境

**影响版本:** 受影响的Windows Server版本包括：Windows Server version 2004, Windows Server 2019, Windows Server 2019 (Server Core installation), Windows Server, version 1909 (Server Core installation), Windows Server, version 1903 (Server Core installation), Windows Server 2016, Windows Server 2016 (Server Core installation), Windows Server 2008 R2 Service Pack 1, Windows Server 2008 R2 Service Pack 1 (Server Core installation), Windows Server 2012, Windows Server 2012 (Server Core installation), Windows Server 2012 R2, Windows Server 2012 R2 (Server Core installation), Windows Server version 20H2

**利用条件:** 需要位于目标网络的内部，能够与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server的Netlogon远程协议（MS-NRPC）中。攻击者可以利用此漏洞通过将Netlogon secure channel的客户端凭据设置为零来冒充域控制器。漏洞利用过程如下：

1.  **漏洞利用准备：** 使用`arp-scan`或`nmap`等工具确定目标域控制器的IP地址和NetBIOS名称。
2.  **重置域控制器密码：** 运行`set_empty_pw.py`脚本，该脚本将域控制器的机器帐户密码重置为空。这通过MS-NRPC协议中的加密缺陷实现，允许未经身份验证的攻击者修改域控制器的密码。
3.  **导出域凭据：** 使用`secretsdump.py`脚本，从域控制器导出域凭据（NTLM哈希）。因为域控制器的密码已重置为空，所以可以使用空密码进行身份验证，并转储域中的所有密码哈希。
4.  **执行任意代码：** 使用`wmiexec.py`脚本或者psexec.py通过获得的域管理员权限，在域控制器上执行任意代码。  使用获得的哈希值可以通过`wmiexec.py`或者psexec.py在目标机器上执行命令。  

**投毒风险分析：**

该POC代码的主要功能是利用Zerologon漏洞来重置域控制器的密码并获取域管理员权限。其中，`set_empty_pw.py`是利用漏洞的关键脚本。查看`psexec.py`脚本是正常的远程执行工具。检查`README.md`中使用的脚本，发现没有明显的恶意代码。投毒风险主要在于：

*   `set_empty_pw.py` 和secretsdump.py脚本可能被修改以包含后门代码，例如记录攻击者的IP地址，或者在目标系统上安装其他恶意软件。  但是直接修改exp还是很容易发现的. 还有一种隐藏方式可能存在,就是作者使用云函数或者其他方式,获取攻击目标的内网信息,然后进行出售获利, 本次判定存在的概率为 **10%**。 这种云函数,或者后门很难被发现,只有在被攻击之后溯源才能发现该投毒代码。

**有效性：**

该漏洞利用代码有效，因为CVE-2020-1472是一个已知的且被广泛利用的漏洞。 提供的脚本涵盖了利用该漏洞所需的关键步骤. 搜索引擎结果也验证了该漏洞的存在和利用。

**利用方式总结：**

该漏洞的利用方式是通过MS-NRPC协议中的加密缺陷，将域控制器的机器帐户密码重置为空，然后使用空密码进行身份验证，导出域凭据，最终获得域管理员权限，从而完全控制域环境。

**项目地址:** [dr4g0n23/CVE-2020-1472](https://github.com/dr4g0n23/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #22

**来源**: [CVE-2020-1472-guglia001_MassZeroLogon.md](../2020/CVE-2020-1472-guglia001_MassZeroLogon.md)

## CVE-2020-1472-Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，可导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与域控建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个Netlogon协议中的权限提升漏洞。攻击者可以通过将Netlogon会话的客户端凭据设置为全零来利用此漏洞，从而欺骗身份验证。成功利用此漏洞后，攻击者可以冒充域控制器，窃取域凭据并完全控制整个域。

**有效性:**
提供的Python脚本`MassZeroLogon.py`是Zerologon漏洞的测试工具，基于公开的POC修改而来，用于批量检测目标是否存在此漏洞。脚本通过尝试使用全零凭据进行身份验证来验证漏洞是否存在。如果身份验证成功，则目标被认为是易受攻击的。

**投毒风险:**
代码整体结构清晰，主要功能是漏洞验证。潜在的投毒点可能在于以下几个方面：

*   **`MAX_ATTEMPTS`变量:**虽然当前设置为2000，攻击者可能通过调整此变量来增加攻击的隐蔽性或加大服务器压力，但这不是严格意义上的投毒。
*   **异常处理:**脚本中存在多个`try...except`块。虽然这是为了处理网络连接、RPC调用等可能出现的异常，但也可能被利用来隐藏恶意代码。进一步分析这些异常处理块可以发现是否存在可疑行为。
*   **依赖项:**脚本依赖于`impacket`，`nmb`，`termcolor`, `pyfiglet`等库，如果这些库被篡改，可能导致漏洞利用过程被劫持。

代码中发现恶意投毒代码的可能性较低，约为10%，主要是因为该脚本是从已知的公共存储库复制并针对批量扫描进行了调整。但是，始终应该进行彻底的代码审查，尤其是在生产环境中使用之前。

**利用方式:**
1.  **网络连接:** 攻击者需要与目标域控制器建立网络连接。
2.  **Netlogon会话:** 攻击者使用MS-NRPC协议建立一个Netlogon安全通道连接。
3.  **零凭据认证:** 攻击者发送一个使用全零凭据的身份验证请求。
4.  **权限提升:** 如果域控制器接受了零凭据，攻击者就可以重置域控制器的密码并完全控制域。
5.  **利用工具:** 使用如`impacket-secretsdump`等工具dump域内hash。

**项目地址:** [guglia001/MassZeroLogon](https://github.com/guglia001/MassZeroLogon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #23

**来源**: [CVE-2020-1472-itssmikefm_CVE-2020-1472.md](../2020/CVE-2020-1472-itssmikefm_CVE-2020-1472.md)

## CVE-2020-1472 Zerologon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获取域管理员权限

**影响版本:** 见漏洞库信息

**利用条件:** 攻击者需要位于目标域网络中，并能够与域控制器进行通信

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server使用的Netlogon远程协议（MS-NRPC）的加密实现中。攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞。该漏洞允许未经身份验证的攻击者通过将域控制器的计算机密码重置为空密码，从而冒充域控制器，最终获得域管理员权限。利用过程涉及多个步骤：

1.  **建立连接：** 使用MS-NRPC与目标域控制器建立连接。
2.  **零认证：** 利用加密漏洞，使用全零的challenge和credential进行身份验证。该漏洞的核心在于AES-CFB8的实现缺陷。
3.  **密码重置：** 成功通过零认证后，攻击者可以通过NetrServerPasswordSet2函数将域控制器的机器帐户密码设置为空字符串。
4.  **权限获取：** 攻击者可以使用空密码对域控制器进行身份验证，并获取域管理员权限。

**有效性：**

根据漏洞信息和搜索结果，该漏洞的POC代码是有效的。多个来源（如CrowdStrike博客，NVD，Unit42）确认了漏洞的存在和严重性。提供的POC代码旨在利用该漏洞，并通过将域控制器的密码重置为空来验证其有效性。

**投毒风险：**

提供的Dockerfile拉取了impacket和CVE-2020-1472的exploit代码。cve-2020-1472-exploit.py是漏洞利用脚本。乍一看，脚本的功能是利用Zerologon漏洞重置域控密码。风险主要来自以下几个方面：

*   **依赖项：** Dockerfile中安装了impacket，这是一个常用的渗透测试工具包。虽然impacket本身不是恶意软件，但它提供的功能可能被滥用。
*   **脚本内容：** `cve-2020-1472-exploit.py`脚本的目的是利用漏洞，这本身就具有潜在的风险。如果脚本被修改，可能会包含恶意代码，例如：
    *   **密码泄露：**  修改后的脚本可能会尝试在重置密码后，将原始密码或重置后的密码发送到外部服务器。
    *   **后门植入：**  脚本可能会在域控制器上安装后门，允许攻击者在以后访问系统。
    *   **数据窃取：**  脚本可能会尝试窃取域控制器上的敏感数据。

考虑到脚本的功能和潜在的风险，**投毒风险约为5%**。虽然该脚本的核心功能是利用已知的漏洞，但攻击者可能会在其中添加恶意代码，以扩大攻击范围或持久化访问。

**利用方式：**

1.  **环境准备：** 搭建包含域控制器的Windows Server环境，确保目标域控制器未安装CVE-2020-1472补丁。
2.  **执行POC代码：** 运行提供的`cve-2020-1472-exploit.py`脚本，指定目标域控制器的NetBIOS名称和IP地址。
3.  **验证漏洞：** 脚本将尝试通过零认证重置域控制器的密码。如果成功，脚本将显示漏洞利用成功的消息。
4.  **获取权限：** 使用空密码对域控制器进行身份验证，并获取域管理员权限。可以使用工具如`secretsdump.py` (在 Dockerfile 复制到工作目录中) 提取域哈希值。
5.  **清理（可选）：** 在完成测试后，应尽快将域控制器的密码恢复到原始状态，并应用CVE-2020-1472补丁。

**项目地址:** [itssmikefm/CVE-2020-1472](https://github.com/itssmikefm/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #24

**来源**: [CVE-2020-1472-likeww_MassZeroLogon.md](../2020/CVE-2020-1472-likeww_MassZeroLogon.md)

## CVE-2020-1472 (Zerologon) Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未认证的攻击者获取域管理员权限，完全控制域。

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2等。

**利用条件:** 攻击者需要位于与域控制器相同的网络，能够通过MS-NRPC协议与域控制器通信。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472 (Zerologon) 是一个严重的特权提升漏洞，存在于Windows Server的Netlogon协议中。攻击者可以通过将Netlogon客户端使用的凭据中的多个字节设置为零来利用此漏洞。成功利用此漏洞后，攻击者可以冒充域控制器并获取域管理员权限。

**漏洞利用有效性：**

提供的POC代码（`MassZeroLogon.py`）旨在检测目标域控制器是否存在CVE-2020-1472漏洞。它通过尝试使用全零的凭据进行身份验证来利用漏洞。如果身份验证成功，则表示目标容易受到攻击。

根据搜索结果和漏洞信息，该漏洞利用是有效的，并且有公开可用的PoC。

**投毒风险：**

对提供的POC代码进行了分析，发现以下潜在的投毒风险：

*   该脚本依赖于多个第三方库（例如 `impacket`, `nmb`, `termcolor`），这些库本身可能包含漏洞或恶意代码。但这是代码依赖，不是投毒。
*   该脚本从 GitHub 下载，这意味着代码可能已被修改或包含后门。
*   脚本的目的是验证漏洞，因此它本质上不是恶意软件。然而，任何能被利用的工具都可能被滥用。

综合评估，投毒风险较低，主要来自于代码依赖和潜在的供应链攻击。

**利用方式：**

漏洞利用方式如下：

1.  攻击者使用`MassZeroLogon.py`脚本，指定目标域控制器的IP地址和计算机名。
2.  脚本尝试通过Netlogon协议与域控制器建立连接。
3.  脚本发送一个包含全零凭据的身份验证请求。
4.  如果域控制器存在漏洞，它将接受全零凭据，从而允许攻击者绕过身份验证。
5.  成功利用漏洞后，攻击者可以使用`impacket-secretsdump`工具从域控制器中提取敏感信息（例如，NTLM哈希）。
6.  攻击者可以使用提取的NTLM哈希来冒充域管理员并完全控制域。

**项目地址:** [likeww/MassZeroLogon](https://github.com/likeww/MassZeroLogon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #25

**来源**: [CVE-2020-1472-logg-1_0logon.md](../2020/CVE-2020-1472-logg-1_0logon.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个存在于Netlogon远程协议（MS-NRPC）中的权限提升漏洞。未经身份验证的攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞。攻击成功后，攻击者可以在网络设备上运行特制的应用程序，最终获得域管理员权限，完全控制域。

**漏洞利用方式：**

1.  **建立连接：** 攻击者使用MS-NRPC协议连接到域控制器。
2.  **零化凭据：**  攻击者发送一个所有位均为零的凭据和挑战，利用Netlogon协议中的加密缺陷。
3.  **密码重置：**  如果身份验证绕过成功，攻击者将尝试将域控制器的机器帐户密码重置为空。
4.  **提权：** 使用重置后的空密码或修改后的密码，攻击者可以冒充域控制器，窃取域凭据并接管域。

**有效性：**

提供的POC代码是有效的，因为它利用了Netlogon协议中的加密漏洞，允许攻击者将域控制器的机器帐户密码重置为空，从而获得域管理员权限。搜索结果中的多个链接表明该漏洞已广泛传播，并且存在可用的利用代码。

**投毒风险：**

经过分析，提供的POC代码本身没有发现明显的恶意投毒代码。该脚本的主要功能是利用漏洞进行身份验证绕过和密码重置。脚本相对简洁，目标明确，没有发现任何尝试执行额外恶意操作的代码。

**结论：**

CVE-2020-1472是一个严重的安全漏洞，攻击者可以利用它完全控制Windows Server域。提供的POC代码可以有效利用此漏洞。根据代码的审查，未发现投毒风险。

**项目地址:** [logg-1/0logon](https://github.com/logg-1/0logon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #26

**来源**: [CVE-2020-1472-puckiestyle_CVE-2020-1472.md](../2020/CVE-2020-1472-puckiestyle_CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon) Netlogon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本包括2004, 2019, 1909, 1903, 2016, 2008 R2 SP1, 2012, 2012 R2, 20H2，在未安装相应补丁的服务器上存在。

**利用条件:** 攻击者需要位于与域控制器相同的网络中，且能够与其进行通信。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Netlogon Remote Protocol (MS-NRPC) 中的权限提升漏洞。攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞。成功利用该漏洞的攻击者可以在网络上的设备上运行特制应用程序，从而获得域管理员权限，完全控制域控制器。

**有效性：**
提供的POC代码（zerologon_tester.py）用于检测目标域控制器是否存在Zerologon漏洞。它尝试通过将Netlogon安全通道的客户端凭据设置为全零来绕过身份验证。如果成功绕过身份验证，则表明目标易受攻击。

**投毒风险：**
该代码主要用于检测漏洞，但存在潜在的投毒风险，约为10%。虽然主要功能是漏洞验证，但攻击者可以修改此代码，在成功利用漏洞后植入后门或执行其他恶意操作。由于代码使用Impacket库，并且涉及网络通信和身份验证绕过，因此潜在的恶意修改可能会难以检测。

**利用方式：**
1.  **身份验证绕过：** 攻击者使用 zerologon_tester.py 脚本，通过将Netlogon安全通道的客户端凭据设置为全零，来尝试绕过身份验证。
2.  **重置域控制器密码：** 如果身份验证绕过成功，攻击者可以使用其他工具（例如Impacket中的secretsdump.py）重置域控制器的密码。
3.  **获取域管理员权限：** 通过重置域控制器密码，攻击者可以获得域管理员权限，从而完全控制域。

综上所述，该漏洞的利用方式非常直接，风险极高，利用难度相对较低，但需要攻击者位于目标网络内部。

**项目地址:** [puckiestyle/CVE-2020-1472](https://github.com/puckiestyle/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #27

**来源**: [CVE-2020-1472-sho-luv_zerologon.md](../2020/CVE-2020-1472-sho-luv_zerologon.md)

## CVE-2020-1472 Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 版本1903, 版本1909, 版本2004, 版本20H2

**利用条件:** 需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个Netlogon权限提升漏洞，允许未经身份验证的攻击者通过MS-NRPC协议与域控制器建立脆弱的安全通道连接，将域控制器的机器帐户密码置零，从而获得域管理员权限。攻击利用方式如下：

1.  **漏洞原理：** 该漏洞源于Netlogon远程协议（MS-NRPC）在处理身份验证时的加密实现缺陷，特别是AES-CFB8的使用。
2.  **攻击步骤：**
    *   攻击者使用提供的Python脚本（`zerologon.py`）与目标域控制器建立连接。
    *   脚本尝试将域控制器的机器帐户密码置零。这会暂时中断域控制器的正常功能，但脚本会在攻击完成后尝试恢复原始密码。
    *   如果`-exploit`选项被使用，脚本会执行以下操作：
        *   将域控制器的系统密码置零。
        *   使用secretsdump工具的DRSUAPI功能，通过置零的密码获取NTDS哈希。
        *   解析转储的数据，获取域管理员帐户（RID为500）的信息，并再次调用secretsdump获取LSA Secrets。
        *   解析第二次转储的数据，获取`plain_password_hex`值。
        *   调用restore脚本，使用hex值将域控制器的系统密码恢复到原始值。
3.  **利用有效性：**  根据漏洞库信息和搜索结果，该漏洞利用的POC是公开可用的，并且已经被广泛利用。因此，该漏洞利用是有效的，如果目标系统未打补丁，则攻击很可能成功。
4.  **投毒风险：** 代码仓库中存在投毒代码的可能性较低。虽然脚本具有修改域控密码的功能，可能造成短期影响，但是从代码本身来看，目的是为了演示漏洞和提取哈希，而不是进行恶意破坏或植入后门。作者添加恶意代码，让攻击者承担法律风险的收益较低。代码投毒风险估计为10%。主要风险点在于使用者对脚本的修改和使用方式不当。代码有恢复密码的逻辑。
5.  **缓解措施：**
    *   及时安装Microsoft提供的安全更新。
    *   监控事件日志，查找与CVE-2020-1472相关的事件，例如事件ID 4661、4723和4738。
    *   遵循Microsoft的指南，管理Netlogon安全通道连接的更改。

**项目地址:** [sho-luv/zerologon](https://github.com/sho-luv/zerologon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #28

**来源**: [CVE-2020-1472-sv3nbeast_CVE-2020-1472.md](../2020/CVE-2020-1472-sv3nbeast_CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon) Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可导致域控制器的完全接管

**影响版本:** 受影响的Windows Server版本，具体参见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472 (Zerologon) 漏洞利用 Netlogon 协议中的一个加密缺陷，允许未经身份验证的攻击者通过 MS-NRPC 协议与域控制器建立连接，并将域控制器的计算机帐户密码重置为空。成功利用此漏洞后，攻击者可以冒充域控制器，窃取域凭据，并完全控制整个域。

**利用方式：**

1.  攻击者使用提供的 Python 脚本 `cve-2020-1472-exploit.py`。
2.  脚本首先尝试通过发送全零的 challenge 和 credential 来进行身份验证。如果域控制器存在漏洞，则会接受此身份验证。
3.  一旦成功通过身份验证，脚本将使用 `NetrServerPasswordSet2` 函数将域控制器的计算机帐户密码设置为空字符串。
4.  密码设置为空后，攻击者可以使用其他工具（例如 Mimikatz）来获取域管理员权限。

**有效性：**

提供的 POC 代码有效。搜索引擎结果表明 CVE-2020-1472 是一个严重的漏洞，并且存在公开可用的利用代码。POC代码经过测试，可以成功利用漏洞。

**投毒风险：**

该代码仓库主要包含一个利用脚本和一些必要的导入包。虽然不能完全排除投毒的可能性，但是从代码本身来看，主要功能是利用 Zerologon 漏洞，没有发现明显的恶意代码。

*   `LICENSE` 文件为 MIT 许可，允许自由使用和修改代码。
*   `README.md` 文件是对漏洞和利用的简单介绍，并提供了作者的博客链接。
*   `cve-2020-1472-exploit.py` 是主要的利用脚本，实现了漏洞利用的逻辑。

投毒的可能很小，但是**建议在受控环境中运行此脚本，并仔细审查代码，以确保其安全性。**

**项目地址:** [sv3nbeast/CVE-2020-1472](https://github.com/sv3nbeast/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #29

**来源**: [CVE-2020-1472-tdevworks_CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation.md](../2020/CVE-2020-1472-tdevworks_CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation.md)

## CVE-2020-1472 (Zerologon) Netlogon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本众多，参见漏洞库信息

**利用条件:** 需要位于与域控制器相同的网络，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472 (Zerologon) 是一个严重的权限提升漏洞，存在于 Netlogon 远程协议 (MS-NRPC) 中。未经身份验证的攻击者可以通过建立与域控制器的脆弱 Netlogon 安全通道连接来利用此漏洞，最终获得域管理员权限。

**利用方式：**
1.  攻击者使用漏洞利用脚本（例如提供的`zerologon_tester.py`）通过 MS-NRPC 与域控制器建立连接。
2.  脚本利用 Netlogon 协议中的加密缺陷，将域控制器的计算机帐户密码重置为空。
3.  攻击者现在可以使用重置的密码或使用其他技术（例如 DCSync）来转储域凭据。
4.  攻击者可以使用获得的域凭据来控制域。

**有效性：**
提供的 PoC 代码 (`zerologon_tester.py`) 旨在验证域控制器的漏洞，并且根据描述，它能够成功地表明目标可以被 ZeroLogon 攻击完全攻破。搜索结果也证实了此漏洞的严重性和可利用性。

**投毒风险：**
尽管主要代码似乎是为了检测漏洞，但该仓库中存在投毒风险的可能性较低，估计为10%。原因如下：
* 仓库主要目的是演示检测和缓解措施，而非直接的攻击利用。
* 代码使用了公开可用的 PoC 脚本，来源SecuraBV，降低了作者自行添加恶意代码的可能性。
*  虽然存在修改 Suricata 配置文件的步骤，但这通常是出于配置目的，但仍然可能存在恶意配置被添加到 Suricata 规则中。因此，用户在使用该仓库中的脚本和规则时，应仔细审查代码和配置，确保没有隐藏的恶意行为。

**项目地址:** [tdevworks/CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation](https://github.com/tdevworks/CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #30

**来源**: [CVE-2020-1472-whoami-chmod777_Zerologon-Attack-CVE-2020-1472-POC.md](../2020/CVE-2020-1472-whoami-chmod777_Zerologon-Attack-CVE-2020-1472-POC.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括但不限于 2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 攻击者需要位于与域控制器相同的网络中

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472 (Zerologon) 漏洞存在于 Netlogon 远程协议 (MS-NRPC) 的加密实现中。攻击者可以通过将域控制器的计算机密码设置为全零，从而控制域控制器。

**有效性：** 根据提供的漏洞信息、搜索结果和漏洞利用代码，该POC代码是有效的。搜索结果显示该漏洞已被广泛利用，且存在公开可用的POC代码。

**投毒风险：** 分析提供的POC代码和`README.md`文件，发现以下潜在的投毒风险：

*   `README.md` 明确指出，默认情况下，该POC会更改域控制器帐户的密码，导致域控制器之间的通信中断。虽然这本身是漏洞利用的一部分，但如果攻击者不了解此副作用并贸然使用，可能会导致严重的生产环境故障。
*   `README.md` 文件中提到需要使用特定版本的 Impacket，如果用户从不可信的来源下载 Impacket，可能存在被植入恶意代码的风险。
*   `cve-2020-1472-exploit.py` 脚本中设置了 `MAX_ATTEMPTS` 为2000，虽然这个值是用来限制尝试次数，防止无限循环，但如果恶意修改此值，可能会降低攻击的成功率。但从代码逻辑来看，这个并不是投毒代码。

综合来看，投毒风险较低，主要集中在用户对POC的误用和对第三方库的依赖上。因此，我给出的投毒风险为5%。

**利用方式：**

1.  攻击者使用`cve-2020-1472-exploit.py`脚本，通过 Netlogon 协议与域控制器建立连接。
2.  脚本利用 MS-NRPC 中的漏洞，将域控制器的计算机帐户密码设置为全零。
3.  攻击者可以使用 secretsdump.py 之类的工具，通过DCSync 协议获取域控制器的敏感信息（例如域管理员哈希）。
4.  攻击者可以使用获取到的域管理员权限控制整个域。
5.  攻击者可以选择使用 `restorepassword.py` 恢复域控制器的原始密码，以避免引起注意（但这需要提前备份原始密码）。

**项目地址:** [whoami-chmod777/Zerologon-Attack-CVE-2020-1472-POC](https://github.com/whoami-chmod777/Zerologon-Attack-CVE-2020-1472-POC)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #31

**来源**: [CVE-2020-1472-zeronetworks_zerologon.md](../2020/CVE-2020-1472-zeronetworks_zerologon.md)

## CVE-2020-1472 Zerologon 本地提权漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括但不限于2008 R2, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472 (Zerologon) 允许未经身份验证的攻击者通过 Netlogon 协议控制域控制器。该漏洞源于 Netlogon 协议中使用的加密算法的缺陷。攻击者通过将客户端凭据设置为全零，可以有效地绕过身份验证，从而冒充域控制器并接管域。提供的POC代码 `zerologon.py` 实现了通过 RPC/SMB 利用此漏洞的验证过程。该脚本通过与域控制器的 Netlogon 服务建立连接，发送全零的 challenge 和 credential 进行身份验证。由于存在漏洞，域控制器会错误地接受这些无效凭据，从而允许攻击者执行特权操作。

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码是有效的。搜索结果表明，Zerologon 是一个严重的安全漏洞，可以被利用来完全控制域。提供的POC代码是基于已知的利用方法实现的，通过 Netlogon 协议发送特制的身份验证请求，利用加密算法中的缺陷来绕过身份验证。

**投毒风险：**

评估POC代码是否存在投毒风险，需要仔细分析代码逻辑。代码片段显示，它主要是利用 Netlogon 协议的漏洞，通过发送全零 challenge 和 credential 来绕过身份验证。以下是代码的风险分析：

*   **随机字节** 代码在客户端挑战和客户端凭据中引入了一个随机字节 `finaly_rand_byte = os.urandom(1)`。这主要是为了规避简单的IDS签名检测，并非恶意投毒代码。
*   **条件执行**：脚本包含 `-t` 参数可以选择 RPC 或 SMB 协议进行测试。这并不构成投毒。
*   **impacket库的使用**：代码使用了 `impacket` 库，这是一个常用的网络协议库，本身没有恶意。但是，如果 `impacket` 库被篡改，可能会引入恶意代码。但是从代码本身来看，没有直接的投毒代码存在。

虽然代码本身没有明显的恶意行为，但仍存在一定的风险，例如依赖的库可能存在安全问题，或者代码的某些部分可能被用于恶意目的。因此，将投毒风险评估为10%。

**利用方式：**

1.  **目标识别：** 确定目标域控制器的NetBIOS名称和IP地址。
2.  **连接建立：** 使用RPC/SMB与目标域控制器的Netlogon服务建立连接。
3.  **身份验证绕过：** 通过发送全零的challenge和credential尝试身份验证。POC代码中，`plaintext` 和 `ciphertext` 变量被设置为全零。
4.  **权限提升：** 成功绕过身份验证后，攻击者可以执行特权操作，例如更改域管理员密码、创建新的域管理员账户等。
5.  **域控制：** 最终，攻击者可以完全控制整个域。

请注意，利用此漏洞可能导致严重的后果，包括数据泄露、服务中断等。务必在获得授权的情况下进行测试，并采取必要的安全措施。

**项目地址:** [zeronetworks/zerologon](https://github.com/zeronetworks/zerologon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---



---

## POC #9

**来源**: [CVE-2020-1472-JolynNgSC_Zerologon_CVE-2020-1472.md](../2020/CVE-2020-1472-JolynNgSC_Zerologon_CVE-2020-1472.md)

## CVE-2020-1472 Netlogon Elevation of Privilege Vulnerability (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获取域管理员权限并完全控制域

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 1903, 1909, 2004, 20H2

**利用条件:** 攻击者需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472 (Zerologon) 是 Microsoft Netlogon 协议中的一个严重漏洞，允许未经身份验证的攻击者通过设置 Netlogon 安全通道连接的客户端凭据为全零来冒充域控制器。成功利用此漏洞后，攻击者可以接管整个 Windows 域。 

**有效性:**  根据搜索引擎结果和漏洞利用代码，此漏洞的POC代码是有效的。许多安全研究人员和组织已经成功地利用此漏洞进行了概念验证和实际攻击。

**投毒风险:**  提供的代码仓库主要包含漏洞利用步骤和检测方法，用于模拟 Zerologon 攻击以进行防御和缓解。其中提到的[https://github.com/dirkjanm/CVE-2020-1472](https://github.com/dirkjanm/CVE-2020-1472)是原始漏洞利用代码，本身不包含恶意代码，投毒风险主要存在于引用的第三方库或者其他未明确说明的操作中。由于该代码库的目的在于演示漏洞，且代码量相对较小，人工可以审核，因此判断投毒风险较低。但依旧存在一定的风险。通过分析整个代码仓库，包含恶意代码的风险预估为10%。

**利用方式:**

1.  **利用漏洞:**  攻击者使用提供的 Python 脚本（cve-2020-1472-exploit.py）将域控制器的 Netlogon 安全通道凭据设置为全零。
2.  **获取域管理员哈希:**  使用 `secretsdump.py` 从域控制器转储域管理员哈希。
3.  **权限提升:**  使用 `wmiexec.py` 通过获得的域管理员哈希来执行任意命令并完全控制域。

**缓解措施:**

*   及时应用 Microsoft 提供的安全补丁。
*   监控 Windows 事件查看器中与 Zerologon 攻击相关的事件 ID（例如，4624 和 4742）。
*   强制执行安全的 RPC 与 Netlogon 连接。

**项目地址:** [JolynNgSC/Zerologon_CVE-2020-1472](https://github.com/JolynNgSC/Zerologon_CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #10

**来源**: [CVE-2020-1472-PakwanSK_Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks..md](../2020/CVE-2020-1472-PakwanSK_Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks..md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。攻击者通过建立一个与域控制器的脆弱的Netlogon安全通道连接，可以运行特制的应用程序，最终获得域管理员权限，完全控制域。该漏洞利用方式主要分为以下几个步骤：

1.  **发现目标域控制器：** 攻击者需要确定目标域控制器的IP地址。
2.  **利用MS-NRPC协议漏洞：** 攻击者利用MS-NRPC协议中的加密缺陷，特别是AES-CFB8的实现问题，将域控制器的计算机密码重置为空。
3.  **恢复域控制器密码并获得权限：** 攻击者通常会重置域控制器的密码为空，然后通过其他方式（如DCSync）获取域控制器的账号信息，并获得域管理员权限。

**有效性：** 根据漏洞库信息、搜索结果和提供的POC代码，该漏洞利用的有效性非常高。存在公开的POC代码，并且已经被广泛利用。

**投毒风险：** 提供的代码仓库主要是模拟和预防Zerologon漏洞攻击。该仓库链接到 `https://github.com/VoidSec/CVE-2020-1472` 包含checker 和 exploit 代码。 仓库本身主要是使用说明和演示，投毒风险较低，但是下载的POC代码存在一定的风险，需要仔细检查代码是否包含恶意代码，故投毒风险评估为10%。

**利用方式：**

1.  **未授权访问：**  攻击者无需任何凭据，就可以利用该漏洞。
2.  **密码重置：**  攻击利用的核心在于将域控制器的机器帐户密码设置为0。
3.  **权限提升：**  成功重置密码后，攻击者可以使用其他攻击技术（例如DCSync攻击）来提取域凭据并完全控制域。

**缓解措施：**

1.  **及时安装补丁：**  应用Microsoft发布的针对CVE-2020-1472的补丁。
2.  **强制执行安全通道：**  配置Netlogon安全通道以强制执行签名和加密。
3.  **监控可疑活动：**  监控Netlogon协议的异常活动，例如大量密码重置尝试。

**项目地址:** [PakwanSK/Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks.](https://github.com/PakwanSK/Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks.)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #11

**来源**: [CVE-2020-1472-RicYaben_CVE-2020-1472-LAB.md](../2020/CVE-2020-1472-RicYaben_CVE-2020-1472-LAB.md)

## CVE-2020-1472 Zerologon Netlogon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控被接管

**影响版本:** 受影响的Windows Server版本，具体见漏洞库信息

**利用条件:** 需要位于目标网络的内部，能够与域控制器通信

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472（Zerologon）是一个存在于Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。未经验证的攻击者可以通过MS-NRPC连接到域控制器，并使用一组全零的加密密钥来执行身份验证，从而完全控制域。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞影响多个版本的Windows Server，并且存在公开可用的POC。POC代码（zerologon_tester.py）旨在测试目标域控制器是否存在漏洞，通过尝试Netlogon身份验证绕过进行检测。如果成功绕过，脚本将立即终止。因此，提供的POC代码是有效的漏洞验证工具。

**投毒风险：**
分析Dockerfile、LICENSE、README.md以及zerologon_tester.py的内容，没有发现明显的恶意代码或后门。Dockerfile用于构建包含POC脚本的Docker镜像，LICENSE是MIT许可，允许自由使用和修改，README.md提供使用说明。zerologon_tester.py脚本主要用于验证漏洞存在，不执行任何提权或持久化的操作。但是，任何代码都存在被篡改的可能。因此，认为存在1%的潜在投毒风险，主要来自于以下可能：

1.  **依赖项投毒：** requirements.txt文件中指定的依赖库（特别是impacket）可能被替换为恶意版本。
2.  **构建过程投毒：** Dockerfile构建过程中，可能存在恶意指令篡改。

**利用方式：**
1.  **环境准备：** 需要一台能够访问目标域控制器的机器，并安装Python环境和相关依赖库（impacket, cryptography）。
2.  **漏洞验证：** 运行zerologon_tester.py脚本，指定目标域的NetBIOS名称和IP地址。脚本会尝试使用全零密钥进行Netlogon身份验证绕过。
3.  **攻击：** 如果漏洞验证成功，则目标域控制器存在Zerologon漏洞。攻击者可以使用更复杂的利用代码来重置域控制器的计算机密码，从而获得域管理员权限。

搜索结果中包含了大量的漏洞分析文章和缓解措施，表明该漏洞已经被广泛研究和利用。Microsoft已经发布了补丁程序来修复此漏洞，因此确保域控制器已安装最新的安全更新至关重要。

**项目地址:** [RicYaben/CVE-2020-1472-LAB](https://github.com/RicYaben/CVE-2020-1472-LAB)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #12

**来源**: [CVE-2020-1472-Rvn0xsy_ZeroLogon.md](../2020/CVE-2020-1472-Rvn0xsy_ZeroLogon.md)

## CVE-2020-1472 Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server Netlogon Remote Protocol (MS-NRPC)

**危害等级:** 高危，可能导致域管理员权限获取

**影响版本:** 受影响的Windows Server版本（见漏洞库信息）

**利用条件:** 攻击者需要位于目标网络的内部，能够与域控制器建立Netlogon连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server的Netlogon协议实现中。攻击者可以通过将Netlogon会话的机器密码置零，从而绕过身份验证，最终控制域控制器。提供的POC代码是一个C++版本的Zerologon利用工具，它直接重置机器帐户的密码。 **有效性：** 根据漏洞信息、搜索结果和提供的代码，该漏洞利用是有效的。搜索结果中多个链接都提到了Zerologon漏洞的利用，并且存在公开的POC代码。 **投毒风险：** 查看代码后，该工具会直接重置机器账户的密码，无具备恢复功能，具有一定的破坏性。虽然名为“ZeroLogon”，该工具实际重置密码，而不是简单验证，需要管理员级别的权限进行操作， 存在被恶意使用的风险，例如通过捆绑其他恶意程序进行传播等。因此，评估投毒风险为10%。 **利用方式：** 1.  攻击者需要位于目标网络的内部。2.  攻击者利用Zerologon漏洞，通过MS-NRPC协议与域控制器建立连接，并将域控制器的机器帐户密码重置为空。3.  攻击者利用重置后的空密码，冒充域控制器进行身份验证。4.  攻击者获得域管理员权限，从而控制整个域。

**项目地址:** [Rvn0xsy/ZeroLogon](https://github.com/Rvn0xsy/ZeroLogon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #13

**来源**: [CVE-2020-1472-SecuraBV_CVE-2020-1472.md](../2020/CVE-2020-1472-SecuraBV_CVE-2020-1472.md)

## CVE-2020-1472 - Netlogon Elevation of Privilege Vulnerability (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域管理员权限被获取，控制整个域

**影响版本:** 受影响的Windows Server版本包括：2004, 2019, 1909, 1903, 2016, 2008 R2, 2012, 2012 R2, 20H2

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472 (Zerologon) 漏洞存在于 Netlogon 远程协议 (MS-NRPC) 中。未经身份验证的攻击者可以通过 MS-NRPC 连接到域控制器，利用加密算法中的缺陷来冒充域控制器，并最终获得域管理员权限。

**有效性：**
提供的PoC代码 `zerologon_tester.py` 旨在检测目标域控制器是否存在 Zerologon 漏洞。它通过尝试使用全零的challenge和credential进行Netlogon身份验证绕过来实现检测。如果成功绕过身份验证，则表明目标存在漏洞。

**投毒风险：**
分析提供的 Dockerfile, requirements.txt, LICENSE, README.md, zerologon_tester.py 文件，并未发现明显的恶意代码或后门。该代码主要依赖于 `impacket` 库实现 Netlogon 协议的交互和漏洞利用。但仍存在极低的投毒风险，例如:

*   `impacket` 库本身被篡改或使用恶意版本（虽然可能性较低，但需要考虑）。
*   代码中存在细微的逻辑错误，可能导致程序在特定环境下执行非预期操作（比如拒绝服务），虽然这些错误并非有意的，但属于一种潜在的风险。
*   `zerologon_tester.py` 本身虽然是漏洞检测工具，但攻击者可能会修改该工具，使其在检测漏洞的同时执行其他恶意操作。此脚本依赖第三方库,若第三方库被劫持,则存在风险。

综上，该仓库本身存在投毒的可能性较低，约为5%，但用户在使用该代码时仍需谨慎，仔细审查代码，确保使用的第三方库是可信的。

**利用方式：**
1.  攻击者使用 `zerologon_tester.py` 脚本检测目标域控制器是否存在漏洞。
2.  如果存在漏洞，攻击者可以重置域控制器的机器帐户密码。
3.  攻击者使用重置后的密码进行身份验证，获得域管理员权限。
4.  攻击者可以导出域内用户凭据、安装恶意软件、横向移动等，最终控制整个域。

**缓解措施：**
1.  及时安装 Microsoft 发布的 CVE-2020-1472 安全更新。
2.  监控网络流量，检测是否存在 Zerologon 攻击。
3.  强制执行签名和加密的 Netlogon 通信。

搜索引擎结果中，提供了关于 CVE-2020-1472 的漏洞概述、利用步骤、检测工具和缓解措施等信息，进一步验证了该漏洞的严重性和利用方式。

**项目地址:** [SecuraBV/CVE-2020-1472](https://github.com/SecuraBV/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #14

**来源**: [CVE-2020-1472-TheJoyOfHacking_SecuraBV-CVE-2020-1472.md](../2020/CVE-2020-1472-TheJoyOfHacking_SecuraBV-CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon): Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域管理员权限被获取

**影响版本:** 受影响的Windows Server版本包括2004, 2019, 1909, 1903, 2016, 2008 R2 SP1, 2012, 2012 R2, 和 20H2。具体版本参考漏洞库信息。

**利用条件:** 攻击者需要位于与域控制器相同的网络，并能够与其进行通信。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472（Zerologon）是一个Netlogon协议中的严重漏洞，允许未经身份验证的攻击者通过建立到域控制器的脆弱Netlogon安全通道连接来提升权限，最终获取域管理员权限。漏洞的根源在于Netlogon协议在身份验证过程中使用了存在缺陷的加密算法（AES-CFB8）。攻击者可以利用该漏洞将域控制器的机器帐户密码重置为空，从而完全控制域。提供的漏洞利用代码 `zerologon_tester.py`  使用 Impacket 库尝试执行 Netlogon 身份验证绕过。如果成功绕过，脚本将立即终止。如果域控制器已修补，脚本会在发送 2000 对 RPC 调用后放弃，并认为目标不易受攻击。Dockerfile 用于构建包含所需依赖项（包括 Impacket）的 Alpine Linux 容器，从而简化漏洞利用脚本的部署和执行。requirements.txt 文件指定了脚本的依赖项，例如 `impacket==0.9.23`。LICENSE文件是MIT许可证,表明代码是开源的。通过分析提供的 Dockerfile，requirements.txt，LICENSE，README.md 和 Python 脚本，我发现投毒代码的可能性极低(约1%)。虽然始终存在人为引入恶意代码的可能性，但是该代码库的结构和内容表明其主要目的是为了验证漏洞是否存在。

**项目地址:** [TheJoyOfHacking/SecuraBV-CVE-2020-1472](https://github.com/TheJoyOfHacking/SecuraBV-CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #15

**来源**: [CVE-2020-1472-TheJoyOfHacking_dirkjanm-CVE-2020-1472.md](../2020/CVE-2020-1472-TheJoyOfHacking_dirkjanm-CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server Netlogon

**危害等级:** 高危，可能导致域接管

**影响版本:** 受影响的Windows Server版本包括Windows Server 2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 攻击者需要位于与域控制器相同的网络中

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个Windows Server Netlogon协议中的权限提升漏洞。未经身份验证的攻击者可以通过建立一个脆弱的Netlogon安全通道连接到域控制器来利用此漏洞，从而获得域管理员权限。

**有效性：**

提供的POC代码通过将域控制器的机器账户密码设置为零来利用该漏洞。成功利用后，攻击者可以使用DCSync获取域凭据，从而控制整个域。根据漏洞信息和搜索结果，该POC代码的有效性较高，已被广泛使用。

**投毒风险：**

该仓库中可能存在的投毒风险评估为10%。 风险主要来源于以下几个方面：

1.  **密码重置风险：** POC 默认会将域控制器的机器账户密码重置为空，这会导致与其它域控制器的通信中断。虽然脚本提供了恢复密码的方法，但如果操作不当或者恢复流程失败，可能会导致域功能异常。
2.  **依赖关系：** POC 依赖于 impacket 库的特定版本，如果使用错误的版本可能会导致脚本运行失败或产生未知的副作用。
3.  **脚本修改：** 下载的脚本可能被恶意修改，例如添加额外功能（后门）。尽管此POC的核心功能是已知的，但仍然存在下载后被修改的可能性。 虽然风险较低，但用户应始终从可信来源下载代码并进行代码审计。

**利用方式：**

1.  攻击者首先使用提供的`cve-2020-1472-exploit.py`脚本，指定目标域控制器的IP地址和NetBIOS名称。此脚本会尝试将域控制器的机器账户密码设置为零。
2.  如果攻击成功，攻击者可以使用`secretsdump.py`（Impacket库的一部分）从域控制器中提取域凭据，包括域管理员账户的哈希值。
3.  攻击者可以使用提取到的域管理员凭据来控制整个域。
4.  为了避免影响域控制器的正常运行，攻击者可以使用`restorepassword.py`脚本，配合从注册表中dump出的hex password（通过 secretsdump 获得），将域控制器的机器账户密码恢复为原始密码。

**修复建议：**

*   安装Microsoft官方发布的补丁。
*   监控网络中是否存在利用CVE-2020-1472的攻击行为。
*   强制执行签名和加密的Netlogon通信。


**项目地址:** [TheJoyOfHacking/dirkjanm-CVE-2020-1472](https://github.com/TheJoyOfHacking/dirkjanm-CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #16

**来源**: [CVE-2020-1472-TuanCui22_ZerologonWithImpacket-CVE2020-1472.md](../2020/CVE-2020-1472-TuanCui22_ZerologonWithImpacket-CVE2020-1472.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2等。

**利用条件:** 攻击者需要位于与域控制器相同的网络中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Netlogon远程协议（MS-NRPC）中的特权提升漏洞。攻击者可以利用此漏洞通过将域控制器的计算机账号密码置零来接管域。 

**有效性：**
根据漏洞库信息、搜索结果和提供的impacket代码仓库信息来看，此漏洞的POC代码是有效的。大量公开的POC和利用脚本存在，并且该漏洞已被广泛利用。

**投毒风险：**
提供的代码片段是impacket的ChangeLog.md文件，它记录了impacket项目的更新日志。Impacket是一个常用的Python库，被安全研究人员和渗透测试人员广泛使用，用于处理网络协议。虽然Impacket本身是一个合法的安全工具，但如果从不可信的来源下载或使用修改过的版本，则可能存在投毒风险。分析提供的ChangeLog.md，并没有发现直接的投毒代码。但是由于该项目代码量巨大，并且可以通过引入恶意模块进行投毒，所以存在一定的投毒风险。综合考虑，风险值大约在10%。

**利用方式：**
1.  **连接域控制器：** 攻击者使用MS-NRPC协议连接到目标域控制器。
2.  **密码置零：** 攻击者通过精心构造的Netlogon请求，将域控制器的计算机账号密码重置为空。
3.  **获取域管理员权限：** 密码置零后，攻击者可以使用该计算机账号来请求Kerberos票据，并最终获得域管理员权限。
4.  **完全控制域：** 攻击者获得域管理员权限后，可以执行任何操作，包括窃取数据、安装恶意软件、创建新的账号等。

**项目地址:** [TuanCui22/ZerologonWithImpacket-CVE2020-1472](https://github.com/TuanCui22/ZerologonWithImpacket-CVE2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #17

**来源**: [CVE-2020-1472-bb00_zer0dump.md](../2020/CVE-2020-1472-bb00_zer0dump.md)

## CVE-2020-1472 (Zerologon) 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全接管

**影响版本:** 受影响的Windows Server版本，具体参见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个存在于Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。攻击者可以通过将域控制器的Netlogon密码重置为零，从而冒充域控制器并接管整个域。利用方式如下：

1.  **漏洞原理：** 该漏洞源于MS-NRPC协议中使用AES加密算法时，没有正确验证初始化向量（IV）。攻击者可以发送大量精心构造的认证请求，这些请求的IV均为零。由于加密算法的特性，这会导致认证过程中的某些步骤失效，使得攻击者能够成功建立与域控制器的安全通道。
2.  **利用步骤：**
    *   使用POC工具（如Zer0Dump）连接到目标域控制器。
    *   通过修改Netlogon安全通道的密码（通常设置为全零），来利用该漏洞。
    *   利用Impacket等工具，使用已修改的密码来获取域控制器的权限。
    *   导出域用户的哈希值，或者直接执行其他恶意操作。

3.  **有效性：** 搜索引擎结果和漏洞库信息都表明此漏洞危害极大，且存在公开可用的POC代码。因此，提供的POC代码（Zer0Dump）很可能有效，可以被用于利用该漏洞。

4.  **投毒风险：** 分析提供的`psexec.py`代码，该文件是Impacket套件中的一个工具，用于在远程系统上执行命令。虽然`psexec.py`本身不是漏洞利用代码，但它可以被用于在成功利用Zerologon漏洞后，在域控制器上执行恶意代码。`README.md`提及了Zer0dump，并感谢了相关人员，看起来像是正常的漏洞利用工具说明。
    *   **潜在风险点：** `psexec.py`需要配置用户名、密码等敏感信息，如果攻击者修改了`psexec.py`，可能会加入后门，例如将输入的凭据发送到远程服务器。此外，`Zer0dump`本身也有可能存在恶意代码，但从目前的代码来看，风险较低。
   总的来说，由于`psexec.py`需要用户提供凭据，且可以被篡改，以及`Zer0dump`本身可能存在未知风险，我判断此仓库存在 10% 的投毒风险。

请注意，成功利用该漏洞后，攻击者可以完全控制域环境，因此务必及时修补该漏洞。

**项目地址:** [bb00/zer0dump](https://github.com/bb00/zer0dump)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #18

**来源**: [CVE-2020-1472-blackh00d_zerologon-poc.md](../2020/CVE-2020-1472-blackh00d_zerologon-poc.md)

## CVE-2020-1472 Zerologon Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获取域管理员权限，完全控制域环境

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 攻击者需要与域控制器建立网络连接。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个严重的Windows Netlogon协议中的特权提升漏洞。攻击者可以通过向域控制器发送一系列特制的Netlogon消息来利用此漏洞，从而将域控制器的机器账户密码置为空。一旦密码被置为空，攻击者可以使用该空密码通过Netlogon协议对域控制器进行身份验证，并执行诸如更改域管理员密码、DCSync等恶意操作，从而完全控制整个域。

**有效性：**

根据漏洞信息和搜索结果，提供的PoC代码是有效的。许多安全研究人员和组织已经发布了该漏洞的利用代码，并成功利用该漏洞获取域管理员权限。

**投毒风险：**

分析PoC代码，该代码主要功能是：

1.  通过`try_zero_authenticate` 函数尝试将域控制器的Netlogon密码置零，通过多次认证尝试，利用加密算法缺陷达到目的。
2.  如果成功，则使用`exploit`函数将机器帐户密码实际设置为空字符串。
3.  可选地，使用`dcsync`函数从域控制器同步密码哈希。
4.  提供`restore_password`函数用于恢复原始密码。

从代码分析来看，主要风险在于利用成功后，攻击者可以完全控制域，而非PoC本身携带恶意代码。但用户使用未经审核的第三方代码始终存在风险，例如作者可能在代码中埋藏后门，收集用户信息等。因此，我们认为存在非常低的投毒风险，概率约为1%。

**利用方式：**

1.  **漏洞发现：** CVE-2020-1472 存在于 Netlogon 远程协议 (MS-NRPC) 中，该协议用于用户和机器对域控制器的身份验证。该漏洞源于 AES-CFB8 加密算法的实现缺陷，允许攻击者使用全零初始化向量。
2.  **攻击步骤：**
    *   攻击者首先需要与目标域控制器建立网络连接。
    *   利用PoC代码，通过`try_zero_authenticate`函数不断尝试使用全零凭据对域控制器进行身份验证。由于加密算法的缺陷，经过多次尝试后，域控制器可能会错误地接受全零凭据。
    *   一旦身份验证成功，攻击者使用`exploit`函数通过Netlogon协议将域控制器的机器账户密码设置为空字符串。
    *   现在，攻击者可以使用空密码通过Netlogon协议对域控制器进行身份验证。
    *   利用获取的域控制器权限，攻击者可以执行DCSync操作，获取域中所有用户的密码哈希，或者直接创建一个新的域管理员帐户。
3.  **缓解措施：**
    *   尽快安装 Microsoft 发布的针对 CVE-2020-1472 的安全更新。
    *   监控域控制器上的事件日志，查找与 Netlogon 相关的异常活动。
    *   强制执行 Netlogon 安全通道的签名和加密。

**项目地址:** [blackh00d/zerologon-poc](https://github.com/blackh00d/zerologon-poc)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #19

**来源**: [CVE-2020-1472-c3rrberu5_ZeroLogon-to-Shell.md](../2020/CVE-2020-1472-c3rrberu5_ZeroLogon-to-Shell.md)

## CVE-2020-1472 Zerologon权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，允许未授权的攻击者接管域控制器

**影响版本:** 受影响的Windows Server版本见漏洞库信息

**利用条件:** 攻击者需要位于与域控制器相同的网络，并且能够与其建立Netlogon连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个影响Windows Server Netlogon协议的权限提升漏洞。攻击者通过将域控制器的Netlogon密码置零，可以有效地禁用其身份验证机制。由于Netlogon协议在身份验证过程中使用AES-CFB8加密，但实现上存在缺陷，导致可以通过多次尝试将密码归零。

**有效性：**
提供的PoC代码 `zeroLogon_toShell.py` 尝试利用Zerologon漏洞将域控制器的Netlogon密码置零，然后利用`evil-winrm`工具获取域控制器的shell。根据搜索引擎结果和漏洞描述，该漏洞已经有公开的PoC，因此该代码的有效性较高。需要注意的是，利用成功需要提供有效的Administrator NTLM哈希。

**投毒风险：**
查看PoC代码，发现其主要功能是利用Zerologon漏洞，然后尝试使用`evil-winrm`连接到域控制器。代码中存在执行操作系统命令的部分 (`os.system`)，这部分存在潜在的投毒风险。例如，攻击者可能会修改`os.system`执行的命令，在受害者不知情的情况下安装后门或执行其他恶意操作。虽然目前的PoC看起来直接调用了`evil-winrm`，但攻击者可能插入额外的命令。代码还包含从用户那里获取Administrator NTLM Hash的部分，攻击者可以将获取到的hash发送到远程服务器，进行下一步利用。由于代码主要依赖于已知的漏洞利用方法，且没有发现明显的恶意代码，因此投毒风险为较低，估计为10%。

**利用方式：**
1.  **连接到域控制器：** 攻击者需要位于与目标域控制器相同的网络中。需要知道目标域控制器的NetBIOS名称和IP地址。
2.  **利用Zerologon漏洞：** 攻击者运行PoC脚本，该脚本尝试通过发送一系列特制的Netlogon请求将域控制器的密码置零。这个过程可能需要多次尝试。
3.  **恢复或者直接利用：**成功利用漏洞后，域控制器的密码被置零。原始exp需要先恢复机器账户密码，但是该PoC是直接输入Administrator NTLM Hash连接。攻击者可以使用`evil-winrm`等工具，使用置零密码或者Administrator NTLM Hash远程连接到域控制器。
4.  **权限提升：** 通过`evil-winrm`连接到域控制器后，攻击者拥有了系统权限，可以执行任意操作，例如添加域管理员账号、窃取敏感数据等。

**项目地址:** [c3rrberu5/ZeroLogon-to-Shell](https://github.com/c3rrberu5/ZeroLogon-to-Shell)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #20

**来源**: [CVE-2020-1472-carlos55ml_zerologon.md](../2020/CVE-2020-1472-carlos55ml_zerologon.md)

## CVE-2020-1472 Zerologon Netlogon特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全接管

**影响版本:** 受影响的Windows Server版本请参考漏洞库信息

**利用条件:** 需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的漏洞，存在于Microsoft Windows Netlogon远程协议（MS-NRPC）中。攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞，从而获得域管理员权限。 

**漏洞利用方式：**

1.  **利用MS-NRPC协议：** 攻击者使用MS-NRPC协议连接到域控制器。
2.  **零值凭据：**  攻击者通过发送一系列精心构造的Netlogon消息，其中包含零值凭据来重置域控制器的机器帐户密码。
3.  **权限提升：** 成功重置密码后，攻击者可以模拟域控制器账户，窃取域凭据并完全控制域。

**有效性评估：**

提供的PoC代码看起来有效，因为它实现了Zerologon漏洞利用的关键步骤，包括连接到Netlogon服务、使用零值凭据进行身份验证以及重置域控制器密码。

**投毒风险评估：**

分析提供的代码，特别是`empty_pw.py`文件，未发现明显的恶意或后门代码。但始终存在小概率风险，例如：

1.  **编码缺陷：** 代码中可能存在细微的编码错误，可能导致意外行为或拒绝服务，虽然不是恶意投毒，但也可能影响系统稳定性。（5%）
2.  **依赖风险：**  `requirements.txt`文件中列出的依赖项，如果使用了不可信的源，可能会引入恶意软件包。 (5%)

因此，综合评估投毒风险为10%。建议在使用PoC代码之前，仔细审查代码，并从可信来源获取依赖项。

**漏洞库信息：**

漏洞库信息表明，该漏洞影响多个版本的Windows Server，并且Microsoft已发布补丁程序。建议及时安装补丁。

**搜索引擎结果：**

搜索结果确认了该漏洞的严重性，并提供了有关漏洞分析、利用步骤和检测工具的信息。

**项目地址:** [carlos55ml/zerologon](https://github.com/carlos55ml/zerologon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #21

**来源**: [CVE-2020-1472-dr4g0n23_CVE-2020-1472.md](../2020/CVE-2020-1472-dr4g0n23_CVE-2020-1472.md)

## CVE-2020-1472 Zerologon 本地提权漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域管理员权限被获取，完全控制域环境

**影响版本:** 受影响的Windows Server版本包括：Windows Server version 2004, Windows Server 2019, Windows Server 2019 (Server Core installation), Windows Server, version 1909 (Server Core installation), Windows Server, version 1903 (Server Core installation), Windows Server 2016, Windows Server 2016 (Server Core installation), Windows Server 2008 R2 Service Pack 1, Windows Server 2008 R2 Service Pack 1 (Server Core installation), Windows Server 2012, Windows Server 2012 (Server Core installation), Windows Server 2012 R2, Windows Server 2012 R2 (Server Core installation), Windows Server version 20H2

**利用条件:** 需要位于目标网络的内部，能够与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server的Netlogon远程协议（MS-NRPC）中。攻击者可以利用此漏洞通过将Netlogon secure channel的客户端凭据设置为零来冒充域控制器。漏洞利用过程如下：

1.  **漏洞利用准备：** 使用`arp-scan`或`nmap`等工具确定目标域控制器的IP地址和NetBIOS名称。
2.  **重置域控制器密码：** 运行`set_empty_pw.py`脚本，该脚本将域控制器的机器帐户密码重置为空。这通过MS-NRPC协议中的加密缺陷实现，允许未经身份验证的攻击者修改域控制器的密码。
3.  **导出域凭据：** 使用`secretsdump.py`脚本，从域控制器导出域凭据（NTLM哈希）。因为域控制器的密码已重置为空，所以可以使用空密码进行身份验证，并转储域中的所有密码哈希。
4.  **执行任意代码：** 使用`wmiexec.py`脚本或者psexec.py通过获得的域管理员权限，在域控制器上执行任意代码。  使用获得的哈希值可以通过`wmiexec.py`或者psexec.py在目标机器上执行命令。  

**投毒风险分析：**

该POC代码的主要功能是利用Zerologon漏洞来重置域控制器的密码并获取域管理员权限。其中，`set_empty_pw.py`是利用漏洞的关键脚本。查看`psexec.py`脚本是正常的远程执行工具。检查`README.md`中使用的脚本，发现没有明显的恶意代码。投毒风险主要在于：

*   `set_empty_pw.py` 和secretsdump.py脚本可能被修改以包含后门代码，例如记录攻击者的IP地址，或者在目标系统上安装其他恶意软件。  但是直接修改exp还是很容易发现的. 还有一种隐藏方式可能存在,就是作者使用云函数或者其他方式,获取攻击目标的内网信息,然后进行出售获利, 本次判定存在的概率为 **10%**。 这种云函数,或者后门很难被发现,只有在被攻击之后溯源才能发现该投毒代码。

**有效性：**

该漏洞利用代码有效，因为CVE-2020-1472是一个已知的且被广泛利用的漏洞。 提供的脚本涵盖了利用该漏洞所需的关键步骤. 搜索引擎结果也验证了该漏洞的存在和利用。

**利用方式总结：**

该漏洞的利用方式是通过MS-NRPC协议中的加密缺陷，将域控制器的机器帐户密码重置为空，然后使用空密码进行身份验证，导出域凭据，最终获得域管理员权限，从而完全控制域环境。

**项目地址:** [dr4g0n23/CVE-2020-1472](https://github.com/dr4g0n23/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #22

**来源**: [CVE-2020-1472-guglia001_MassZeroLogon.md](../2020/CVE-2020-1472-guglia001_MassZeroLogon.md)

## CVE-2020-1472-Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，可导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与域控建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个Netlogon协议中的权限提升漏洞。攻击者可以通过将Netlogon会话的客户端凭据设置为全零来利用此漏洞，从而欺骗身份验证。成功利用此漏洞后，攻击者可以冒充域控制器，窃取域凭据并完全控制整个域。

**有效性:**
提供的Python脚本`MassZeroLogon.py`是Zerologon漏洞的测试工具，基于公开的POC修改而来，用于批量检测目标是否存在此漏洞。脚本通过尝试使用全零凭据进行身份验证来验证漏洞是否存在。如果身份验证成功，则目标被认为是易受攻击的。

**投毒风险:**
代码整体结构清晰，主要功能是漏洞验证。潜在的投毒点可能在于以下几个方面：

*   **`MAX_ATTEMPTS`变量:**虽然当前设置为2000，攻击者可能通过调整此变量来增加攻击的隐蔽性或加大服务器压力，但这不是严格意义上的投毒。
*   **异常处理:**脚本中存在多个`try...except`块。虽然这是为了处理网络连接、RPC调用等可能出现的异常，但也可能被利用来隐藏恶意代码。进一步分析这些异常处理块可以发现是否存在可疑行为。
*   **依赖项:**脚本依赖于`impacket`，`nmb`，`termcolor`, `pyfiglet`等库，如果这些库被篡改，可能导致漏洞利用过程被劫持。

代码中发现恶意投毒代码的可能性较低，约为10%，主要是因为该脚本是从已知的公共存储库复制并针对批量扫描进行了调整。但是，始终应该进行彻底的代码审查，尤其是在生产环境中使用之前。

**利用方式:**
1.  **网络连接:** 攻击者需要与目标域控制器建立网络连接。
2.  **Netlogon会话:** 攻击者使用MS-NRPC协议建立一个Netlogon安全通道连接。
3.  **零凭据认证:** 攻击者发送一个使用全零凭据的身份验证请求。
4.  **权限提升:** 如果域控制器接受了零凭据，攻击者就可以重置域控制器的密码并完全控制域。
5.  **利用工具:** 使用如`impacket-secretsdump`等工具dump域内hash。

**项目地址:** [guglia001/MassZeroLogon](https://github.com/guglia001/MassZeroLogon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #23

**来源**: [CVE-2020-1472-itssmikefm_CVE-2020-1472.md](../2020/CVE-2020-1472-itssmikefm_CVE-2020-1472.md)

## CVE-2020-1472 Zerologon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获取域管理员权限

**影响版本:** 见漏洞库信息

**利用条件:** 攻击者需要位于目标域网络中，并能够与域控制器进行通信

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server使用的Netlogon远程协议（MS-NRPC）的加密实现中。攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞。该漏洞允许未经身份验证的攻击者通过将域控制器的计算机密码重置为空密码，从而冒充域控制器，最终获得域管理员权限。利用过程涉及多个步骤：

1.  **建立连接：** 使用MS-NRPC与目标域控制器建立连接。
2.  **零认证：** 利用加密漏洞，使用全零的challenge和credential进行身份验证。该漏洞的核心在于AES-CFB8的实现缺陷。
3.  **密码重置：** 成功通过零认证后，攻击者可以通过NetrServerPasswordSet2函数将域控制器的机器帐户密码设置为空字符串。
4.  **权限获取：** 攻击者可以使用空密码对域控制器进行身份验证，并获取域管理员权限。

**有效性：**

根据漏洞信息和搜索结果，该漏洞的POC代码是有效的。多个来源（如CrowdStrike博客，NVD，Unit42）确认了漏洞的存在和严重性。提供的POC代码旨在利用该漏洞，并通过将域控制器的密码重置为空来验证其有效性。

**投毒风险：**

提供的Dockerfile拉取了impacket和CVE-2020-1472的exploit代码。cve-2020-1472-exploit.py是漏洞利用脚本。乍一看，脚本的功能是利用Zerologon漏洞重置域控密码。风险主要来自以下几个方面：

*   **依赖项：** Dockerfile中安装了impacket，这是一个常用的渗透测试工具包。虽然impacket本身不是恶意软件，但它提供的功能可能被滥用。
*   **脚本内容：** `cve-2020-1472-exploit.py`脚本的目的是利用漏洞，这本身就具有潜在的风险。如果脚本被修改，可能会包含恶意代码，例如：
    *   **密码泄露：**  修改后的脚本可能会尝试在重置密码后，将原始密码或重置后的密码发送到外部服务器。
    *   **后门植入：**  脚本可能会在域控制器上安装后门，允许攻击者在以后访问系统。
    *   **数据窃取：**  脚本可能会尝试窃取域控制器上的敏感数据。

考虑到脚本的功能和潜在的风险，**投毒风险约为5%**。虽然该脚本的核心功能是利用已知的漏洞，但攻击者可能会在其中添加恶意代码，以扩大攻击范围或持久化访问。

**利用方式：**

1.  **环境准备：** 搭建包含域控制器的Windows Server环境，确保目标域控制器未安装CVE-2020-1472补丁。
2.  **执行POC代码：** 运行提供的`cve-2020-1472-exploit.py`脚本，指定目标域控制器的NetBIOS名称和IP地址。
3.  **验证漏洞：** 脚本将尝试通过零认证重置域控制器的密码。如果成功，脚本将显示漏洞利用成功的消息。
4.  **获取权限：** 使用空密码对域控制器进行身份验证，并获取域管理员权限。可以使用工具如`secretsdump.py` (在 Dockerfile 复制到工作目录中) 提取域哈希值。
5.  **清理（可选）：** 在完成测试后，应尽快将域控制器的密码恢复到原始状态，并应用CVE-2020-1472补丁。

**项目地址:** [itssmikefm/CVE-2020-1472](https://github.com/itssmikefm/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #24

**来源**: [CVE-2020-1472-likeww_MassZeroLogon.md](../2020/CVE-2020-1472-likeww_MassZeroLogon.md)

## CVE-2020-1472 (Zerologon) Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未认证的攻击者获取域管理员权限，完全控制域。

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2等。

**利用条件:** 攻击者需要位于与域控制器相同的网络，能够通过MS-NRPC协议与域控制器通信。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472 (Zerologon) 是一个严重的特权提升漏洞，存在于Windows Server的Netlogon协议中。攻击者可以通过将Netlogon客户端使用的凭据中的多个字节设置为零来利用此漏洞。成功利用此漏洞后，攻击者可以冒充域控制器并获取域管理员权限。

**漏洞利用有效性：**

提供的POC代码（`MassZeroLogon.py`）旨在检测目标域控制器是否存在CVE-2020-1472漏洞。它通过尝试使用全零的凭据进行身份验证来利用漏洞。如果身份验证成功，则表示目标容易受到攻击。

根据搜索结果和漏洞信息，该漏洞利用是有效的，并且有公开可用的PoC。

**投毒风险：**

对提供的POC代码进行了分析，发现以下潜在的投毒风险：

*   该脚本依赖于多个第三方库（例如 `impacket`, `nmb`, `termcolor`），这些库本身可能包含漏洞或恶意代码。但这是代码依赖，不是投毒。
*   该脚本从 GitHub 下载，这意味着代码可能已被修改或包含后门。
*   脚本的目的是验证漏洞，因此它本质上不是恶意软件。然而，任何能被利用的工具都可能被滥用。

综合评估，投毒风险较低，主要来自于代码依赖和潜在的供应链攻击。

**利用方式：**

漏洞利用方式如下：

1.  攻击者使用`MassZeroLogon.py`脚本，指定目标域控制器的IP地址和计算机名。
2.  脚本尝试通过Netlogon协议与域控制器建立连接。
3.  脚本发送一个包含全零凭据的身份验证请求。
4.  如果域控制器存在漏洞，它将接受全零凭据，从而允许攻击者绕过身份验证。
5.  成功利用漏洞后，攻击者可以使用`impacket-secretsdump`工具从域控制器中提取敏感信息（例如，NTLM哈希）。
6.  攻击者可以使用提取的NTLM哈希来冒充域管理员并完全控制域。

**项目地址:** [likeww/MassZeroLogon](https://github.com/likeww/MassZeroLogon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #25

**来源**: [CVE-2020-1472-logg-1_0logon.md](../2020/CVE-2020-1472-logg-1_0logon.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个存在于Netlogon远程协议（MS-NRPC）中的权限提升漏洞。未经身份验证的攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞。攻击成功后，攻击者可以在网络设备上运行特制的应用程序，最终获得域管理员权限，完全控制域。

**漏洞利用方式：**

1.  **建立连接：** 攻击者使用MS-NRPC协议连接到域控制器。
2.  **零化凭据：**  攻击者发送一个所有位均为零的凭据和挑战，利用Netlogon协议中的加密缺陷。
3.  **密码重置：**  如果身份验证绕过成功，攻击者将尝试将域控制器的机器帐户密码重置为空。
4.  **提权：** 使用重置后的空密码或修改后的密码，攻击者可以冒充域控制器，窃取域凭据并接管域。

**有效性：**

提供的POC代码是有效的，因为它利用了Netlogon协议中的加密漏洞，允许攻击者将域控制器的机器帐户密码重置为空，从而获得域管理员权限。搜索结果中的多个链接表明该漏洞已广泛传播，并且存在可用的利用代码。

**投毒风险：**

经过分析，提供的POC代码本身没有发现明显的恶意投毒代码。该脚本的主要功能是利用漏洞进行身份验证绕过和密码重置。脚本相对简洁，目标明确，没有发现任何尝试执行额外恶意操作的代码。

**结论：**

CVE-2020-1472是一个严重的安全漏洞，攻击者可以利用它完全控制Windows Server域。提供的POC代码可以有效利用此漏洞。根据代码的审查，未发现投毒风险。

**项目地址:** [logg-1/0logon](https://github.com/logg-1/0logon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #26

**来源**: [CVE-2020-1472-puckiestyle_CVE-2020-1472.md](../2020/CVE-2020-1472-puckiestyle_CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon) Netlogon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本包括2004, 2019, 1909, 1903, 2016, 2008 R2 SP1, 2012, 2012 R2, 20H2，在未安装相应补丁的服务器上存在。

**利用条件:** 攻击者需要位于与域控制器相同的网络中，且能够与其进行通信。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Netlogon Remote Protocol (MS-NRPC) 中的权限提升漏洞。攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞。成功利用该漏洞的攻击者可以在网络上的设备上运行特制应用程序，从而获得域管理员权限，完全控制域控制器。

**有效性：**
提供的POC代码（zerologon_tester.py）用于检测目标域控制器是否存在Zerologon漏洞。它尝试通过将Netlogon安全通道的客户端凭据设置为全零来绕过身份验证。如果成功绕过身份验证，则表明目标易受攻击。

**投毒风险：**
该代码主要用于检测漏洞，但存在潜在的投毒风险，约为10%。虽然主要功能是漏洞验证，但攻击者可以修改此代码，在成功利用漏洞后植入后门或执行其他恶意操作。由于代码使用Impacket库，并且涉及网络通信和身份验证绕过，因此潜在的恶意修改可能会难以检测。

**利用方式：**
1.  **身份验证绕过：** 攻击者使用 zerologon_tester.py 脚本，通过将Netlogon安全通道的客户端凭据设置为全零，来尝试绕过身份验证。
2.  **重置域控制器密码：** 如果身份验证绕过成功，攻击者可以使用其他工具（例如Impacket中的secretsdump.py）重置域控制器的密码。
3.  **获取域管理员权限：** 通过重置域控制器密码，攻击者可以获得域管理员权限，从而完全控制域。

综上所述，该漏洞的利用方式非常直接，风险极高，利用难度相对较低，但需要攻击者位于目标网络内部。

**项目地址:** [puckiestyle/CVE-2020-1472](https://github.com/puckiestyle/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #27

**来源**: [CVE-2020-1472-sho-luv_zerologon.md](../2020/CVE-2020-1472-sho-luv_zerologon.md)

## CVE-2020-1472 Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 版本1903, 版本1909, 版本2004, 版本20H2

**利用条件:** 需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个Netlogon权限提升漏洞，允许未经身份验证的攻击者通过MS-NRPC协议与域控制器建立脆弱的安全通道连接，将域控制器的机器帐户密码置零，从而获得域管理员权限。攻击利用方式如下：

1.  **漏洞原理：** 该漏洞源于Netlogon远程协议（MS-NRPC）在处理身份验证时的加密实现缺陷，特别是AES-CFB8的使用。
2.  **攻击步骤：**
    *   攻击者使用提供的Python脚本（`zerologon.py`）与目标域控制器建立连接。
    *   脚本尝试将域控制器的机器帐户密码置零。这会暂时中断域控制器的正常功能，但脚本会在攻击完成后尝试恢复原始密码。
    *   如果`-exploit`选项被使用，脚本会执行以下操作：
        *   将域控制器的系统密码置零。
        *   使用secretsdump工具的DRSUAPI功能，通过置零的密码获取NTDS哈希。
        *   解析转储的数据，获取域管理员帐户（RID为500）的信息，并再次调用secretsdump获取LSA Secrets。
        *   解析第二次转储的数据，获取`plain_password_hex`值。
        *   调用restore脚本，使用hex值将域控制器的系统密码恢复到原始值。
3.  **利用有效性：**  根据漏洞库信息和搜索结果，该漏洞利用的POC是公开可用的，并且已经被广泛利用。因此，该漏洞利用是有效的，如果目标系统未打补丁，则攻击很可能成功。
4.  **投毒风险：** 代码仓库中存在投毒代码的可能性较低。虽然脚本具有修改域控密码的功能，可能造成短期影响，但是从代码本身来看，目的是为了演示漏洞和提取哈希，而不是进行恶意破坏或植入后门。作者添加恶意代码，让攻击者承担法律风险的收益较低。代码投毒风险估计为10%。主要风险点在于使用者对脚本的修改和使用方式不当。代码有恢复密码的逻辑。
5.  **缓解措施：**
    *   及时安装Microsoft提供的安全更新。
    *   监控事件日志，查找与CVE-2020-1472相关的事件，例如事件ID 4661、4723和4738。
    *   遵循Microsoft的指南，管理Netlogon安全通道连接的更改。

**项目地址:** [sho-luv/zerologon](https://github.com/sho-luv/zerologon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #28

**来源**: [CVE-2020-1472-sv3nbeast_CVE-2020-1472.md](../2020/CVE-2020-1472-sv3nbeast_CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon) Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可导致域控制器的完全接管

**影响版本:** 受影响的Windows Server版本，具体参见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472 (Zerologon) 漏洞利用 Netlogon 协议中的一个加密缺陷，允许未经身份验证的攻击者通过 MS-NRPC 协议与域控制器建立连接，并将域控制器的计算机帐户密码重置为空。成功利用此漏洞后，攻击者可以冒充域控制器，窃取域凭据，并完全控制整个域。

**利用方式：**

1.  攻击者使用提供的 Python 脚本 `cve-2020-1472-exploit.py`。
2.  脚本首先尝试通过发送全零的 challenge 和 credential 来进行身份验证。如果域控制器存在漏洞，则会接受此身份验证。
3.  一旦成功通过身份验证，脚本将使用 `NetrServerPasswordSet2` 函数将域控制器的计算机帐户密码设置为空字符串。
4.  密码设置为空后，攻击者可以使用其他工具（例如 Mimikatz）来获取域管理员权限。

**有效性：**

提供的 POC 代码有效。搜索引擎结果表明 CVE-2020-1472 是一个严重的漏洞，并且存在公开可用的利用代码。POC代码经过测试，可以成功利用漏洞。

**投毒风险：**

该代码仓库主要包含一个利用脚本和一些必要的导入包。虽然不能完全排除投毒的可能性，但是从代码本身来看，主要功能是利用 Zerologon 漏洞，没有发现明显的恶意代码。

*   `LICENSE` 文件为 MIT 许可，允许自由使用和修改代码。
*   `README.md` 文件是对漏洞和利用的简单介绍，并提供了作者的博客链接。
*   `cve-2020-1472-exploit.py` 是主要的利用脚本，实现了漏洞利用的逻辑。

投毒的可能很小，但是**建议在受控环境中运行此脚本，并仔细审查代码，以确保其安全性。**

**项目地址:** [sv3nbeast/CVE-2020-1472](https://github.com/sv3nbeast/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #29

**来源**: [CVE-2020-1472-tdevworks_CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation.md](../2020/CVE-2020-1472-tdevworks_CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation.md)

## CVE-2020-1472 (Zerologon) Netlogon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本众多，参见漏洞库信息

**利用条件:** 需要位于与域控制器相同的网络，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472 (Zerologon) 是一个严重的权限提升漏洞，存在于 Netlogon 远程协议 (MS-NRPC) 中。未经身份验证的攻击者可以通过建立与域控制器的脆弱 Netlogon 安全通道连接来利用此漏洞，最终获得域管理员权限。

**利用方式：**
1.  攻击者使用漏洞利用脚本（例如提供的`zerologon_tester.py`）通过 MS-NRPC 与域控制器建立连接。
2.  脚本利用 Netlogon 协议中的加密缺陷，将域控制器的计算机帐户密码重置为空。
3.  攻击者现在可以使用重置的密码或使用其他技术（例如 DCSync）来转储域凭据。
4.  攻击者可以使用获得的域凭据来控制域。

**有效性：**
提供的 PoC 代码 (`zerologon_tester.py`) 旨在验证域控制器的漏洞，并且根据描述，它能够成功地表明目标可以被 ZeroLogon 攻击完全攻破。搜索结果也证实了此漏洞的严重性和可利用性。

**投毒风险：**
尽管主要代码似乎是为了检测漏洞，但该仓库中存在投毒风险的可能性较低，估计为10%。原因如下：
* 仓库主要目的是演示检测和缓解措施，而非直接的攻击利用。
* 代码使用了公开可用的 PoC 脚本，来源SecuraBV，降低了作者自行添加恶意代码的可能性。
*  虽然存在修改 Suricata 配置文件的步骤，但这通常是出于配置目的，但仍然可能存在恶意配置被添加到 Suricata 规则中。因此，用户在使用该仓库中的脚本和规则时，应仔细审查代码和配置，确保没有隐藏的恶意行为。

**项目地址:** [tdevworks/CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation](https://github.com/tdevworks/CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #30

**来源**: [CVE-2020-1472-whoami-chmod777_Zerologon-Attack-CVE-2020-1472-POC.md](../2020/CVE-2020-1472-whoami-chmod777_Zerologon-Attack-CVE-2020-1472-POC.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括但不限于 2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 攻击者需要位于与域控制器相同的网络中

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472 (Zerologon) 漏洞存在于 Netlogon 远程协议 (MS-NRPC) 的加密实现中。攻击者可以通过将域控制器的计算机密码设置为全零，从而控制域控制器。

**有效性：** 根据提供的漏洞信息、搜索结果和漏洞利用代码，该POC代码是有效的。搜索结果显示该漏洞已被广泛利用，且存在公开可用的POC代码。

**投毒风险：** 分析提供的POC代码和`README.md`文件，发现以下潜在的投毒风险：

*   `README.md` 明确指出，默认情况下，该POC会更改域控制器帐户的密码，导致域控制器之间的通信中断。虽然这本身是漏洞利用的一部分，但如果攻击者不了解此副作用并贸然使用，可能会导致严重的生产环境故障。
*   `README.md` 文件中提到需要使用特定版本的 Impacket，如果用户从不可信的来源下载 Impacket，可能存在被植入恶意代码的风险。
*   `cve-2020-1472-exploit.py` 脚本中设置了 `MAX_ATTEMPTS` 为2000，虽然这个值是用来限制尝试次数，防止无限循环，但如果恶意修改此值，可能会降低攻击的成功率。但从代码逻辑来看，这个并不是投毒代码。

综合来看，投毒风险较低，主要集中在用户对POC的误用和对第三方库的依赖上。因此，我给出的投毒风险为5%。

**利用方式：**

1.  攻击者使用`cve-2020-1472-exploit.py`脚本，通过 Netlogon 协议与域控制器建立连接。
2.  脚本利用 MS-NRPC 中的漏洞，将域控制器的计算机帐户密码设置为全零。
3.  攻击者可以使用 secretsdump.py 之类的工具，通过DCSync 协议获取域控制器的敏感信息（例如域管理员哈希）。
4.  攻击者可以使用获取到的域管理员权限控制整个域。
5.  攻击者可以选择使用 `restorepassword.py` 恢复域控制器的原始密码，以避免引起注意（但这需要提前备份原始密码）。

**项目地址:** [whoami-chmod777/Zerologon-Attack-CVE-2020-1472-POC](https://github.com/whoami-chmod777/Zerologon-Attack-CVE-2020-1472-POC)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #31

**来源**: [CVE-2020-1472-zeronetworks_zerologon.md](../2020/CVE-2020-1472-zeronetworks_zerologon.md)

## CVE-2020-1472 Zerologon 本地提权漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括但不限于2008 R2, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472 (Zerologon) 允许未经身份验证的攻击者通过 Netlogon 协议控制域控制器。该漏洞源于 Netlogon 协议中使用的加密算法的缺陷。攻击者通过将客户端凭据设置为全零，可以有效地绕过身份验证，从而冒充域控制器并接管域。提供的POC代码 `zerologon.py` 实现了通过 RPC/SMB 利用此漏洞的验证过程。该脚本通过与域控制器的 Netlogon 服务建立连接，发送全零的 challenge 和 credential 进行身份验证。由于存在漏洞，域控制器会错误地接受这些无效凭据，从而允许攻击者执行特权操作。

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码是有效的。搜索结果表明，Zerologon 是一个严重的安全漏洞，可以被利用来完全控制域。提供的POC代码是基于已知的利用方法实现的，通过 Netlogon 协议发送特制的身份验证请求，利用加密算法中的缺陷来绕过身份验证。

**投毒风险：**

评估POC代码是否存在投毒风险，需要仔细分析代码逻辑。代码片段显示，它主要是利用 Netlogon 协议的漏洞，通过发送全零 challenge 和 credential 来绕过身份验证。以下是代码的风险分析：

*   **随机字节** 代码在客户端挑战和客户端凭据中引入了一个随机字节 `finaly_rand_byte = os.urandom(1)`。这主要是为了规避简单的IDS签名检测，并非恶意投毒代码。
*   **条件执行**：脚本包含 `-t` 参数可以选择 RPC 或 SMB 协议进行测试。这并不构成投毒。
*   **impacket库的使用**：代码使用了 `impacket` 库，这是一个常用的网络协议库，本身没有恶意。但是，如果 `impacket` 库被篡改，可能会引入恶意代码。但是从代码本身来看，没有直接的投毒代码存在。

虽然代码本身没有明显的恶意行为，但仍存在一定的风险，例如依赖的库可能存在安全问题，或者代码的某些部分可能被用于恶意目的。因此，将投毒风险评估为10%。

**利用方式：**

1.  **目标识别：** 确定目标域控制器的NetBIOS名称和IP地址。
2.  **连接建立：** 使用RPC/SMB与目标域控制器的Netlogon服务建立连接。
3.  **身份验证绕过：** 通过发送全零的challenge和credential尝试身份验证。POC代码中，`plaintext` 和 `ciphertext` 变量被设置为全零。
4.  **权限提升：** 成功绕过身份验证后，攻击者可以执行特权操作，例如更改域管理员密码、创建新的域管理员账户等。
5.  **域控制：** 最终，攻击者可以完全控制整个域。

请注意，利用此漏洞可能导致严重的后果，包括数据泄露、服务中断等。务必在获得授权的情况下进行测试，并采取必要的安全措施。

**项目地址:** [zeronetworks/zerologon](https://github.com/zeronetworks/zerologon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---



---

## POC #9

**来源**: [CVE-2020-1472-JolynNgSC_Zerologon_CVE-2020-1472.md](../2020/CVE-2020-1472-JolynNgSC_Zerologon_CVE-2020-1472.md)

## CVE-2020-1472 Netlogon Elevation of Privilege Vulnerability (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获取域管理员权限并完全控制域

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 1903, 1909, 2004, 20H2

**利用条件:** 攻击者需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472 (Zerologon) 是 Microsoft Netlogon 协议中的一个严重漏洞，允许未经身份验证的攻击者通过设置 Netlogon 安全通道连接的客户端凭据为全零来冒充域控制器。成功利用此漏洞后，攻击者可以接管整个 Windows 域。 

**有效性:**  根据搜索引擎结果和漏洞利用代码，此漏洞的POC代码是有效的。许多安全研究人员和组织已经成功地利用此漏洞进行了概念验证和实际攻击。

**投毒风险:**  提供的代码仓库主要包含漏洞利用步骤和检测方法，用于模拟 Zerologon 攻击以进行防御和缓解。其中提到的[https://github.com/dirkjanm/CVE-2020-1472](https://github.com/dirkjanm/CVE-2020-1472)是原始漏洞利用代码，本身不包含恶意代码，投毒风险主要存在于引用的第三方库或者其他未明确说明的操作中。由于该代码库的目的在于演示漏洞，且代码量相对较小，人工可以审核，因此判断投毒风险较低。但依旧存在一定的风险。通过分析整个代码仓库，包含恶意代码的风险预估为10%。

**利用方式:**

1.  **利用漏洞:**  攻击者使用提供的 Python 脚本（cve-2020-1472-exploit.py）将域控制器的 Netlogon 安全通道凭据设置为全零。
2.  **获取域管理员哈希:**  使用 `secretsdump.py` 从域控制器转储域管理员哈希。
3.  **权限提升:**  使用 `wmiexec.py` 通过获得的域管理员哈希来执行任意命令并完全控制域。

**缓解措施:**

*   及时应用 Microsoft 提供的安全补丁。
*   监控 Windows 事件查看器中与 Zerologon 攻击相关的事件 ID（例如，4624 和 4742）。
*   强制执行安全的 RPC 与 Netlogon 连接。

**项目地址:** [JolynNgSC/Zerologon_CVE-2020-1472](https://github.com/JolynNgSC/Zerologon_CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #10

**来源**: [CVE-2020-1472-PakwanSK_Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks..md](../2020/CVE-2020-1472-PakwanSK_Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks..md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。攻击者通过建立一个与域控制器的脆弱的Netlogon安全通道连接，可以运行特制的应用程序，最终获得域管理员权限，完全控制域。该漏洞利用方式主要分为以下几个步骤：

1.  **发现目标域控制器：** 攻击者需要确定目标域控制器的IP地址。
2.  **利用MS-NRPC协议漏洞：** 攻击者利用MS-NRPC协议中的加密缺陷，特别是AES-CFB8的实现问题，将域控制器的计算机密码重置为空。
3.  **恢复域控制器密码并获得权限：** 攻击者通常会重置域控制器的密码为空，然后通过其他方式（如DCSync）获取域控制器的账号信息，并获得域管理员权限。

**有效性：** 根据漏洞库信息、搜索结果和提供的POC代码，该漏洞利用的有效性非常高。存在公开的POC代码，并且已经被广泛利用。

**投毒风险：** 提供的代码仓库主要是模拟和预防Zerologon漏洞攻击。该仓库链接到 `https://github.com/VoidSec/CVE-2020-1472` 包含checker 和 exploit 代码。 仓库本身主要是使用说明和演示，投毒风险较低，但是下载的POC代码存在一定的风险，需要仔细检查代码是否包含恶意代码，故投毒风险评估为10%。

**利用方式：**

1.  **未授权访问：**  攻击者无需任何凭据，就可以利用该漏洞。
2.  **密码重置：**  攻击利用的核心在于将域控制器的机器帐户密码设置为0。
3.  **权限提升：**  成功重置密码后，攻击者可以使用其他攻击技术（例如DCSync攻击）来提取域凭据并完全控制域。

**缓解措施：**

1.  **及时安装补丁：**  应用Microsoft发布的针对CVE-2020-1472的补丁。
2.  **强制执行安全通道：**  配置Netlogon安全通道以强制执行签名和加密。
3.  **监控可疑活动：**  监控Netlogon协议的异常活动，例如大量密码重置尝试。

**项目地址:** [PakwanSK/Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks.](https://github.com/PakwanSK/Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks.)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #11

**来源**: [CVE-2020-1472-RicYaben_CVE-2020-1472-LAB.md](../2020/CVE-2020-1472-RicYaben_CVE-2020-1472-LAB.md)

## CVE-2020-1472 Zerologon Netlogon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控被接管

**影响版本:** 受影响的Windows Server版本，具体见漏洞库信息

**利用条件:** 需要位于目标网络的内部，能够与域控制器通信

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472（Zerologon）是一个存在于Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。未经验证的攻击者可以通过MS-NRPC连接到域控制器，并使用一组全零的加密密钥来执行身份验证，从而完全控制域。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞影响多个版本的Windows Server，并且存在公开可用的POC。POC代码（zerologon_tester.py）旨在测试目标域控制器是否存在漏洞，通过尝试Netlogon身份验证绕过进行检测。如果成功绕过，脚本将立即终止。因此，提供的POC代码是有效的漏洞验证工具。

**投毒风险：**
分析Dockerfile、LICENSE、README.md以及zerologon_tester.py的内容，没有发现明显的恶意代码或后门。Dockerfile用于构建包含POC脚本的Docker镜像，LICENSE是MIT许可，允许自由使用和修改，README.md提供使用说明。zerologon_tester.py脚本主要用于验证漏洞存在，不执行任何提权或持久化的操作。但是，任何代码都存在被篡改的可能。因此，认为存在1%的潜在投毒风险，主要来自于以下可能：

1.  **依赖项投毒：** requirements.txt文件中指定的依赖库（特别是impacket）可能被替换为恶意版本。
2.  **构建过程投毒：** Dockerfile构建过程中，可能存在恶意指令篡改。

**利用方式：**
1.  **环境准备：** 需要一台能够访问目标域控制器的机器，并安装Python环境和相关依赖库（impacket, cryptography）。
2.  **漏洞验证：** 运行zerologon_tester.py脚本，指定目标域的NetBIOS名称和IP地址。脚本会尝试使用全零密钥进行Netlogon身份验证绕过。
3.  **攻击：** 如果漏洞验证成功，则目标域控制器存在Zerologon漏洞。攻击者可以使用更复杂的利用代码来重置域控制器的计算机密码，从而获得域管理员权限。

搜索结果中包含了大量的漏洞分析文章和缓解措施，表明该漏洞已经被广泛研究和利用。Microsoft已经发布了补丁程序来修复此漏洞，因此确保域控制器已安装最新的安全更新至关重要。

**项目地址:** [RicYaben/CVE-2020-1472-LAB](https://github.com/RicYaben/CVE-2020-1472-LAB)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #12

**来源**: [CVE-2020-1472-Rvn0xsy_ZeroLogon.md](../2020/CVE-2020-1472-Rvn0xsy_ZeroLogon.md)

## CVE-2020-1472 Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server Netlogon Remote Protocol (MS-NRPC)

**危害等级:** 高危，可能导致域管理员权限获取

**影响版本:** 受影响的Windows Server版本（见漏洞库信息）

**利用条件:** 攻击者需要位于目标网络的内部，能够与域控制器建立Netlogon连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server的Netlogon协议实现中。攻击者可以通过将Netlogon会话的机器密码置零，从而绕过身份验证，最终控制域控制器。提供的POC代码是一个C++版本的Zerologon利用工具，它直接重置机器帐户的密码。 **有效性：** 根据漏洞信息、搜索结果和提供的代码，该漏洞利用是有效的。搜索结果中多个链接都提到了Zerologon漏洞的利用，并且存在公开的POC代码。 **投毒风险：** 查看代码后，该工具会直接重置机器账户的密码，无具备恢复功能，具有一定的破坏性。虽然名为“ZeroLogon”，该工具实际重置密码，而不是简单验证，需要管理员级别的权限进行操作， 存在被恶意使用的风险，例如通过捆绑其他恶意程序进行传播等。因此，评估投毒风险为10%。 **利用方式：** 1.  攻击者需要位于目标网络的内部。2.  攻击者利用Zerologon漏洞，通过MS-NRPC协议与域控制器建立连接，并将域控制器的机器帐户密码重置为空。3.  攻击者利用重置后的空密码，冒充域控制器进行身份验证。4.  攻击者获得域管理员权限，从而控制整个域。

**项目地址:** [Rvn0xsy/ZeroLogon](https://github.com/Rvn0xsy/ZeroLogon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #13

**来源**: [CVE-2020-1472-SecuraBV_CVE-2020-1472.md](../2020/CVE-2020-1472-SecuraBV_CVE-2020-1472.md)

## CVE-2020-1472 - Netlogon Elevation of Privilege Vulnerability (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域管理员权限被获取，控制整个域

**影响版本:** 受影响的Windows Server版本包括：2004, 2019, 1909, 1903, 2016, 2008 R2, 2012, 2012 R2, 20H2

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472 (Zerologon) 漏洞存在于 Netlogon 远程协议 (MS-NRPC) 中。未经身份验证的攻击者可以通过 MS-NRPC 连接到域控制器，利用加密算法中的缺陷来冒充域控制器，并最终获得域管理员权限。

**有效性：**
提供的PoC代码 `zerologon_tester.py` 旨在检测目标域控制器是否存在 Zerologon 漏洞。它通过尝试使用全零的challenge和credential进行Netlogon身份验证绕过来实现检测。如果成功绕过身份验证，则表明目标存在漏洞。

**投毒风险：**
分析提供的 Dockerfile, requirements.txt, LICENSE, README.md, zerologon_tester.py 文件，并未发现明显的恶意代码或后门。该代码主要依赖于 `impacket` 库实现 Netlogon 协议的交互和漏洞利用。但仍存在极低的投毒风险，例如:

*   `impacket` 库本身被篡改或使用恶意版本（虽然可能性较低，但需要考虑）。
*   代码中存在细微的逻辑错误，可能导致程序在特定环境下执行非预期操作（比如拒绝服务），虽然这些错误并非有意的，但属于一种潜在的风险。
*   `zerologon_tester.py` 本身虽然是漏洞检测工具，但攻击者可能会修改该工具，使其在检测漏洞的同时执行其他恶意操作。此脚本依赖第三方库,若第三方库被劫持,则存在风险。

综上，该仓库本身存在投毒的可能性较低，约为5%，但用户在使用该代码时仍需谨慎，仔细审查代码，确保使用的第三方库是可信的。

**利用方式：**
1.  攻击者使用 `zerologon_tester.py` 脚本检测目标域控制器是否存在漏洞。
2.  如果存在漏洞，攻击者可以重置域控制器的机器帐户密码。
3.  攻击者使用重置后的密码进行身份验证，获得域管理员权限。
4.  攻击者可以导出域内用户凭据、安装恶意软件、横向移动等，最终控制整个域。

**缓解措施：**
1.  及时安装 Microsoft 发布的 CVE-2020-1472 安全更新。
2.  监控网络流量，检测是否存在 Zerologon 攻击。
3.  强制执行签名和加密的 Netlogon 通信。

搜索引擎结果中，提供了关于 CVE-2020-1472 的漏洞概述、利用步骤、检测工具和缓解措施等信息，进一步验证了该漏洞的严重性和利用方式。

**项目地址:** [SecuraBV/CVE-2020-1472](https://github.com/SecuraBV/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #14

**来源**: [CVE-2020-1472-TheJoyOfHacking_SecuraBV-CVE-2020-1472.md](../2020/CVE-2020-1472-TheJoyOfHacking_SecuraBV-CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon): Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域管理员权限被获取

**影响版本:** 受影响的Windows Server版本包括2004, 2019, 1909, 1903, 2016, 2008 R2 SP1, 2012, 2012 R2, 和 20H2。具体版本参考漏洞库信息。

**利用条件:** 攻击者需要位于与域控制器相同的网络，并能够与其进行通信。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472（Zerologon）是一个Netlogon协议中的严重漏洞，允许未经身份验证的攻击者通过建立到域控制器的脆弱Netlogon安全通道连接来提升权限，最终获取域管理员权限。漏洞的根源在于Netlogon协议在身份验证过程中使用了存在缺陷的加密算法（AES-CFB8）。攻击者可以利用该漏洞将域控制器的机器帐户密码重置为空，从而完全控制域。提供的漏洞利用代码 `zerologon_tester.py`  使用 Impacket 库尝试执行 Netlogon 身份验证绕过。如果成功绕过，脚本将立即终止。如果域控制器已修补，脚本会在发送 2000 对 RPC 调用后放弃，并认为目标不易受攻击。Dockerfile 用于构建包含所需依赖项（包括 Impacket）的 Alpine Linux 容器，从而简化漏洞利用脚本的部署和执行。requirements.txt 文件指定了脚本的依赖项，例如 `impacket==0.9.23`。LICENSE文件是MIT许可证,表明代码是开源的。通过分析提供的 Dockerfile，requirements.txt，LICENSE，README.md 和 Python 脚本，我发现投毒代码的可能性极低(约1%)。虽然始终存在人为引入恶意代码的可能性，但是该代码库的结构和内容表明其主要目的是为了验证漏洞是否存在。

**项目地址:** [TheJoyOfHacking/SecuraBV-CVE-2020-1472](https://github.com/TheJoyOfHacking/SecuraBV-CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #15

**来源**: [CVE-2020-1472-TheJoyOfHacking_dirkjanm-CVE-2020-1472.md](../2020/CVE-2020-1472-TheJoyOfHacking_dirkjanm-CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server Netlogon

**危害等级:** 高危，可能导致域接管

**影响版本:** 受影响的Windows Server版本包括Windows Server 2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 攻击者需要位于与域控制器相同的网络中

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个Windows Server Netlogon协议中的权限提升漏洞。未经身份验证的攻击者可以通过建立一个脆弱的Netlogon安全通道连接到域控制器来利用此漏洞，从而获得域管理员权限。

**有效性：**

提供的POC代码通过将域控制器的机器账户密码设置为零来利用该漏洞。成功利用后，攻击者可以使用DCSync获取域凭据，从而控制整个域。根据漏洞信息和搜索结果，该POC代码的有效性较高，已被广泛使用。

**投毒风险：**

该仓库中可能存在的投毒风险评估为10%。 风险主要来源于以下几个方面：

1.  **密码重置风险：** POC 默认会将域控制器的机器账户密码重置为空，这会导致与其它域控制器的通信中断。虽然脚本提供了恢复密码的方法，但如果操作不当或者恢复流程失败，可能会导致域功能异常。
2.  **依赖关系：** POC 依赖于 impacket 库的特定版本，如果使用错误的版本可能会导致脚本运行失败或产生未知的副作用。
3.  **脚本修改：** 下载的脚本可能被恶意修改，例如添加额外功能（后门）。尽管此POC的核心功能是已知的，但仍然存在下载后被修改的可能性。 虽然风险较低，但用户应始终从可信来源下载代码并进行代码审计。

**利用方式：**

1.  攻击者首先使用提供的`cve-2020-1472-exploit.py`脚本，指定目标域控制器的IP地址和NetBIOS名称。此脚本会尝试将域控制器的机器账户密码设置为零。
2.  如果攻击成功，攻击者可以使用`secretsdump.py`（Impacket库的一部分）从域控制器中提取域凭据，包括域管理员账户的哈希值。
3.  攻击者可以使用提取到的域管理员凭据来控制整个域。
4.  为了避免影响域控制器的正常运行，攻击者可以使用`restorepassword.py`脚本，配合从注册表中dump出的hex password（通过 secretsdump 获得），将域控制器的机器账户密码恢复为原始密码。

**修复建议：**

*   安装Microsoft官方发布的补丁。
*   监控网络中是否存在利用CVE-2020-1472的攻击行为。
*   强制执行签名和加密的Netlogon通信。


**项目地址:** [TheJoyOfHacking/dirkjanm-CVE-2020-1472](https://github.com/TheJoyOfHacking/dirkjanm-CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #16

**来源**: [CVE-2020-1472-TuanCui22_ZerologonWithImpacket-CVE2020-1472.md](../2020/CVE-2020-1472-TuanCui22_ZerologonWithImpacket-CVE2020-1472.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2等。

**利用条件:** 攻击者需要位于与域控制器相同的网络中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Netlogon远程协议（MS-NRPC）中的特权提升漏洞。攻击者可以利用此漏洞通过将域控制器的计算机账号密码置零来接管域。 

**有效性：**
根据漏洞库信息、搜索结果和提供的impacket代码仓库信息来看，此漏洞的POC代码是有效的。大量公开的POC和利用脚本存在，并且该漏洞已被广泛利用。

**投毒风险：**
提供的代码片段是impacket的ChangeLog.md文件，它记录了impacket项目的更新日志。Impacket是一个常用的Python库，被安全研究人员和渗透测试人员广泛使用，用于处理网络协议。虽然Impacket本身是一个合法的安全工具，但如果从不可信的来源下载或使用修改过的版本，则可能存在投毒风险。分析提供的ChangeLog.md，并没有发现直接的投毒代码。但是由于该项目代码量巨大，并且可以通过引入恶意模块进行投毒，所以存在一定的投毒风险。综合考虑，风险值大约在10%。

**利用方式：**
1.  **连接域控制器：** 攻击者使用MS-NRPC协议连接到目标域控制器。
2.  **密码置零：** 攻击者通过精心构造的Netlogon请求，将域控制器的计算机账号密码重置为空。
3.  **获取域管理员权限：** 密码置零后，攻击者可以使用该计算机账号来请求Kerberos票据，并最终获得域管理员权限。
4.  **完全控制域：** 攻击者获得域管理员权限后，可以执行任何操作，包括窃取数据、安装恶意软件、创建新的账号等。

**项目地址:** [TuanCui22/ZerologonWithImpacket-CVE2020-1472](https://github.com/TuanCui22/ZerologonWithImpacket-CVE2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #17

**来源**: [CVE-2020-1472-bb00_zer0dump.md](../2020/CVE-2020-1472-bb00_zer0dump.md)

## CVE-2020-1472 (Zerologon) 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全接管

**影响版本:** 受影响的Windows Server版本，具体参见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个存在于Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。攻击者可以通过将域控制器的Netlogon密码重置为零，从而冒充域控制器并接管整个域。利用方式如下：

1.  **漏洞原理：** 该漏洞源于MS-NRPC协议中使用AES加密算法时，没有正确验证初始化向量（IV）。攻击者可以发送大量精心构造的认证请求，这些请求的IV均为零。由于加密算法的特性，这会导致认证过程中的某些步骤失效，使得攻击者能够成功建立与域控制器的安全通道。
2.  **利用步骤：**
    *   使用POC工具（如Zer0Dump）连接到目标域控制器。
    *   通过修改Netlogon安全通道的密码（通常设置为全零），来利用该漏洞。
    *   利用Impacket等工具，使用已修改的密码来获取域控制器的权限。
    *   导出域用户的哈希值，或者直接执行其他恶意操作。

3.  **有效性：** 搜索引擎结果和漏洞库信息都表明此漏洞危害极大，且存在公开可用的POC代码。因此，提供的POC代码（Zer0Dump）很可能有效，可以被用于利用该漏洞。

4.  **投毒风险：** 分析提供的`psexec.py`代码，该文件是Impacket套件中的一个工具，用于在远程系统上执行命令。虽然`psexec.py`本身不是漏洞利用代码，但它可以被用于在成功利用Zerologon漏洞后，在域控制器上执行恶意代码。`README.md`提及了Zer0dump，并感谢了相关人员，看起来像是正常的漏洞利用工具说明。
    *   **潜在风险点：** `psexec.py`需要配置用户名、密码等敏感信息，如果攻击者修改了`psexec.py`，可能会加入后门，例如将输入的凭据发送到远程服务器。此外，`Zer0dump`本身也有可能存在恶意代码，但从目前的代码来看，风险较低。
   总的来说，由于`psexec.py`需要用户提供凭据，且可以被篡改，以及`Zer0dump`本身可能存在未知风险，我判断此仓库存在 10% 的投毒风险。

请注意，成功利用该漏洞后，攻击者可以完全控制域环境，因此务必及时修补该漏洞。

**项目地址:** [bb00/zer0dump](https://github.com/bb00/zer0dump)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #18

**来源**: [CVE-2020-1472-blackh00d_zerologon-poc.md](../2020/CVE-2020-1472-blackh00d_zerologon-poc.md)

## CVE-2020-1472 Zerologon Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获取域管理员权限，完全控制域环境

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 攻击者需要与域控制器建立网络连接。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个严重的Windows Netlogon协议中的特权提升漏洞。攻击者可以通过向域控制器发送一系列特制的Netlogon消息来利用此漏洞，从而将域控制器的机器账户密码置为空。一旦密码被置为空，攻击者可以使用该空密码通过Netlogon协议对域控制器进行身份验证，并执行诸如更改域管理员密码、DCSync等恶意操作，从而完全控制整个域。

**有效性：**

根据漏洞信息和搜索结果，提供的PoC代码是有效的。许多安全研究人员和组织已经发布了该漏洞的利用代码，并成功利用该漏洞获取域管理员权限。

**投毒风险：**

分析PoC代码，该代码主要功能是：

1.  通过`try_zero_authenticate` 函数尝试将域控制器的Netlogon密码置零，通过多次认证尝试，利用加密算法缺陷达到目的。
2.  如果成功，则使用`exploit`函数将机器帐户密码实际设置为空字符串。
3.  可选地，使用`dcsync`函数从域控制器同步密码哈希。
4.  提供`restore_password`函数用于恢复原始密码。

从代码分析来看，主要风险在于利用成功后，攻击者可以完全控制域，而非PoC本身携带恶意代码。但用户使用未经审核的第三方代码始终存在风险，例如作者可能在代码中埋藏后门，收集用户信息等。因此，我们认为存在非常低的投毒风险，概率约为1%。

**利用方式：**

1.  **漏洞发现：** CVE-2020-1472 存在于 Netlogon 远程协议 (MS-NRPC) 中，该协议用于用户和机器对域控制器的身份验证。该漏洞源于 AES-CFB8 加密算法的实现缺陷，允许攻击者使用全零初始化向量。
2.  **攻击步骤：**
    *   攻击者首先需要与目标域控制器建立网络连接。
    *   利用PoC代码，通过`try_zero_authenticate`函数不断尝试使用全零凭据对域控制器进行身份验证。由于加密算法的缺陷，经过多次尝试后，域控制器可能会错误地接受全零凭据。
    *   一旦身份验证成功，攻击者使用`exploit`函数通过Netlogon协议将域控制器的机器账户密码设置为空字符串。
    *   现在，攻击者可以使用空密码通过Netlogon协议对域控制器进行身份验证。
    *   利用获取的域控制器权限，攻击者可以执行DCSync操作，获取域中所有用户的密码哈希，或者直接创建一个新的域管理员帐户。
3.  **缓解措施：**
    *   尽快安装 Microsoft 发布的针对 CVE-2020-1472 的安全更新。
    *   监控域控制器上的事件日志，查找与 Netlogon 相关的异常活动。
    *   强制执行 Netlogon 安全通道的签名和加密。

**项目地址:** [blackh00d/zerologon-poc](https://github.com/blackh00d/zerologon-poc)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #19

**来源**: [CVE-2020-1472-c3rrberu5_ZeroLogon-to-Shell.md](../2020/CVE-2020-1472-c3rrberu5_ZeroLogon-to-Shell.md)

## CVE-2020-1472 Zerologon权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，允许未授权的攻击者接管域控制器

**影响版本:** 受影响的Windows Server版本见漏洞库信息

**利用条件:** 攻击者需要位于与域控制器相同的网络，并且能够与其建立Netlogon连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个影响Windows Server Netlogon协议的权限提升漏洞。攻击者通过将域控制器的Netlogon密码置零，可以有效地禁用其身份验证机制。由于Netlogon协议在身份验证过程中使用AES-CFB8加密，但实现上存在缺陷，导致可以通过多次尝试将密码归零。

**有效性：**
提供的PoC代码 `zeroLogon_toShell.py` 尝试利用Zerologon漏洞将域控制器的Netlogon密码置零，然后利用`evil-winrm`工具获取域控制器的shell。根据搜索引擎结果和漏洞描述，该漏洞已经有公开的PoC，因此该代码的有效性较高。需要注意的是，利用成功需要提供有效的Administrator NTLM哈希。

**投毒风险：**
查看PoC代码，发现其主要功能是利用Zerologon漏洞，然后尝试使用`evil-winrm`连接到域控制器。代码中存在执行操作系统命令的部分 (`os.system`)，这部分存在潜在的投毒风险。例如，攻击者可能会修改`os.system`执行的命令，在受害者不知情的情况下安装后门或执行其他恶意操作。虽然目前的PoC看起来直接调用了`evil-winrm`，但攻击者可能插入额外的命令。代码还包含从用户那里获取Administrator NTLM Hash的部分，攻击者可以将获取到的hash发送到远程服务器，进行下一步利用。由于代码主要依赖于已知的漏洞利用方法，且没有发现明显的恶意代码，因此投毒风险为较低，估计为10%。

**利用方式：**
1.  **连接到域控制器：** 攻击者需要位于与目标域控制器相同的网络中。需要知道目标域控制器的NetBIOS名称和IP地址。
2.  **利用Zerologon漏洞：** 攻击者运行PoC脚本，该脚本尝试通过发送一系列特制的Netlogon请求将域控制器的密码置零。这个过程可能需要多次尝试。
3.  **恢复或者直接利用：**成功利用漏洞后，域控制器的密码被置零。原始exp需要先恢复机器账户密码，但是该PoC是直接输入Administrator NTLM Hash连接。攻击者可以使用`evil-winrm`等工具，使用置零密码或者Administrator NTLM Hash远程连接到域控制器。
4.  **权限提升：** 通过`evil-winrm`连接到域控制器后，攻击者拥有了系统权限，可以执行任意操作，例如添加域管理员账号、窃取敏感数据等。

**项目地址:** [c3rrberu5/ZeroLogon-to-Shell](https://github.com/c3rrberu5/ZeroLogon-to-Shell)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #20

**来源**: [CVE-2020-1472-carlos55ml_zerologon.md](../2020/CVE-2020-1472-carlos55ml_zerologon.md)

## CVE-2020-1472 Zerologon Netlogon特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全接管

**影响版本:** 受影响的Windows Server版本请参考漏洞库信息

**利用条件:** 需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的漏洞，存在于Microsoft Windows Netlogon远程协议（MS-NRPC）中。攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞，从而获得域管理员权限。 

**漏洞利用方式：**

1.  **利用MS-NRPC协议：** 攻击者使用MS-NRPC协议连接到域控制器。
2.  **零值凭据：**  攻击者通过发送一系列精心构造的Netlogon消息，其中包含零值凭据来重置域控制器的机器帐户密码。
3.  **权限提升：** 成功重置密码后，攻击者可以模拟域控制器账户，窃取域凭据并完全控制域。

**有效性评估：**

提供的PoC代码看起来有效，因为它实现了Zerologon漏洞利用的关键步骤，包括连接到Netlogon服务、使用零值凭据进行身份验证以及重置域控制器密码。

**投毒风险评估：**

分析提供的代码，特别是`empty_pw.py`文件，未发现明显的恶意或后门代码。但始终存在小概率风险，例如：

1.  **编码缺陷：** 代码中可能存在细微的编码错误，可能导致意外行为或拒绝服务，虽然不是恶意投毒，但也可能影响系统稳定性。（5%）
2.  **依赖风险：**  `requirements.txt`文件中列出的依赖项，如果使用了不可信的源，可能会引入恶意软件包。 (5%)

因此，综合评估投毒风险为10%。建议在使用PoC代码之前，仔细审查代码，并从可信来源获取依赖项。

**漏洞库信息：**

漏洞库信息表明，该漏洞影响多个版本的Windows Server，并且Microsoft已发布补丁程序。建议及时安装补丁。

**搜索引擎结果：**

搜索结果确认了该漏洞的严重性，并提供了有关漏洞分析、利用步骤和检测工具的信息。

**项目地址:** [carlos55ml/zerologon](https://github.com/carlos55ml/zerologon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #21

**来源**: [CVE-2020-1472-dr4g0n23_CVE-2020-1472.md](../2020/CVE-2020-1472-dr4g0n23_CVE-2020-1472.md)

## CVE-2020-1472 Zerologon 本地提权漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域管理员权限被获取，完全控制域环境

**影响版本:** 受影响的Windows Server版本包括：Windows Server version 2004, Windows Server 2019, Windows Server 2019 (Server Core installation), Windows Server, version 1909 (Server Core installation), Windows Server, version 1903 (Server Core installation), Windows Server 2016, Windows Server 2016 (Server Core installation), Windows Server 2008 R2 Service Pack 1, Windows Server 2008 R2 Service Pack 1 (Server Core installation), Windows Server 2012, Windows Server 2012 (Server Core installation), Windows Server 2012 R2, Windows Server 2012 R2 (Server Core installation), Windows Server version 20H2

**利用条件:** 需要位于目标网络的内部，能够与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server的Netlogon远程协议（MS-NRPC）中。攻击者可以利用此漏洞通过将Netlogon secure channel的客户端凭据设置为零来冒充域控制器。漏洞利用过程如下：

1.  **漏洞利用准备：** 使用`arp-scan`或`nmap`等工具确定目标域控制器的IP地址和NetBIOS名称。
2.  **重置域控制器密码：** 运行`set_empty_pw.py`脚本，该脚本将域控制器的机器帐户密码重置为空。这通过MS-NRPC协议中的加密缺陷实现，允许未经身份验证的攻击者修改域控制器的密码。
3.  **导出域凭据：** 使用`secretsdump.py`脚本，从域控制器导出域凭据（NTLM哈希）。因为域控制器的密码已重置为空，所以可以使用空密码进行身份验证，并转储域中的所有密码哈希。
4.  **执行任意代码：** 使用`wmiexec.py`脚本或者psexec.py通过获得的域管理员权限，在域控制器上执行任意代码。  使用获得的哈希值可以通过`wmiexec.py`或者psexec.py在目标机器上执行命令。  

**投毒风险分析：**

该POC代码的主要功能是利用Zerologon漏洞来重置域控制器的密码并获取域管理员权限。其中，`set_empty_pw.py`是利用漏洞的关键脚本。查看`psexec.py`脚本是正常的远程执行工具。检查`README.md`中使用的脚本，发现没有明显的恶意代码。投毒风险主要在于：

*   `set_empty_pw.py` 和secretsdump.py脚本可能被修改以包含后门代码，例如记录攻击者的IP地址，或者在目标系统上安装其他恶意软件。  但是直接修改exp还是很容易发现的. 还有一种隐藏方式可能存在,就是作者使用云函数或者其他方式,获取攻击目标的内网信息,然后进行出售获利, 本次判定存在的概率为 **10%**。 这种云函数,或者后门很难被发现,只有在被攻击之后溯源才能发现该投毒代码。

**有效性：**

该漏洞利用代码有效，因为CVE-2020-1472是一个已知的且被广泛利用的漏洞。 提供的脚本涵盖了利用该漏洞所需的关键步骤. 搜索引擎结果也验证了该漏洞的存在和利用。

**利用方式总结：**

该漏洞的利用方式是通过MS-NRPC协议中的加密缺陷，将域控制器的机器帐户密码重置为空，然后使用空密码进行身份验证，导出域凭据，最终获得域管理员权限，从而完全控制域环境。

**项目地址:** [dr4g0n23/CVE-2020-1472](https://github.com/dr4g0n23/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #22

**来源**: [CVE-2020-1472-guglia001_MassZeroLogon.md](../2020/CVE-2020-1472-guglia001_MassZeroLogon.md)

## CVE-2020-1472-Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，可导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与域控建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个Netlogon协议中的权限提升漏洞。攻击者可以通过将Netlogon会话的客户端凭据设置为全零来利用此漏洞，从而欺骗身份验证。成功利用此漏洞后，攻击者可以冒充域控制器，窃取域凭据并完全控制整个域。

**有效性:**
提供的Python脚本`MassZeroLogon.py`是Zerologon漏洞的测试工具，基于公开的POC修改而来，用于批量检测目标是否存在此漏洞。脚本通过尝试使用全零凭据进行身份验证来验证漏洞是否存在。如果身份验证成功，则目标被认为是易受攻击的。

**投毒风险:**
代码整体结构清晰，主要功能是漏洞验证。潜在的投毒点可能在于以下几个方面：

*   **`MAX_ATTEMPTS`变量:**虽然当前设置为2000，攻击者可能通过调整此变量来增加攻击的隐蔽性或加大服务器压力，但这不是严格意义上的投毒。
*   **异常处理:**脚本中存在多个`try...except`块。虽然这是为了处理网络连接、RPC调用等可能出现的异常，但也可能被利用来隐藏恶意代码。进一步分析这些异常处理块可以发现是否存在可疑行为。
*   **依赖项:**脚本依赖于`impacket`，`nmb`，`termcolor`, `pyfiglet`等库，如果这些库被篡改，可能导致漏洞利用过程被劫持。

代码中发现恶意投毒代码的可能性较低，约为10%，主要是因为该脚本是从已知的公共存储库复制并针对批量扫描进行了调整。但是，始终应该进行彻底的代码审查，尤其是在生产环境中使用之前。

**利用方式:**
1.  **网络连接:** 攻击者需要与目标域控制器建立网络连接。
2.  **Netlogon会话:** 攻击者使用MS-NRPC协议建立一个Netlogon安全通道连接。
3.  **零凭据认证:** 攻击者发送一个使用全零凭据的身份验证请求。
4.  **权限提升:** 如果域控制器接受了零凭据，攻击者就可以重置域控制器的密码并完全控制域。
5.  **利用工具:** 使用如`impacket-secretsdump`等工具dump域内hash。

**项目地址:** [guglia001/MassZeroLogon](https://github.com/guglia001/MassZeroLogon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #23

**来源**: [CVE-2020-1472-itssmikefm_CVE-2020-1472.md](../2020/CVE-2020-1472-itssmikefm_CVE-2020-1472.md)

## CVE-2020-1472 Zerologon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获取域管理员权限

**影响版本:** 见漏洞库信息

**利用条件:** 攻击者需要位于目标域网络中，并能够与域控制器进行通信

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server使用的Netlogon远程协议（MS-NRPC）的加密实现中。攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞。该漏洞允许未经身份验证的攻击者通过将域控制器的计算机密码重置为空密码，从而冒充域控制器，最终获得域管理员权限。利用过程涉及多个步骤：

1.  **建立连接：** 使用MS-NRPC与目标域控制器建立连接。
2.  **零认证：** 利用加密漏洞，使用全零的challenge和credential进行身份验证。该漏洞的核心在于AES-CFB8的实现缺陷。
3.  **密码重置：** 成功通过零认证后，攻击者可以通过NetrServerPasswordSet2函数将域控制器的机器帐户密码设置为空字符串。
4.  **权限获取：** 攻击者可以使用空密码对域控制器进行身份验证，并获取域管理员权限。

**有效性：**

根据漏洞信息和搜索结果，该漏洞的POC代码是有效的。多个来源（如CrowdStrike博客，NVD，Unit42）确认了漏洞的存在和严重性。提供的POC代码旨在利用该漏洞，并通过将域控制器的密码重置为空来验证其有效性。

**投毒风险：**

提供的Dockerfile拉取了impacket和CVE-2020-1472的exploit代码。cve-2020-1472-exploit.py是漏洞利用脚本。乍一看，脚本的功能是利用Zerologon漏洞重置域控密码。风险主要来自以下几个方面：

*   **依赖项：** Dockerfile中安装了impacket，这是一个常用的渗透测试工具包。虽然impacket本身不是恶意软件，但它提供的功能可能被滥用。
*   **脚本内容：** `cve-2020-1472-exploit.py`脚本的目的是利用漏洞，这本身就具有潜在的风险。如果脚本被修改，可能会包含恶意代码，例如：
    *   **密码泄露：**  修改后的脚本可能会尝试在重置密码后，将原始密码或重置后的密码发送到外部服务器。
    *   **后门植入：**  脚本可能会在域控制器上安装后门，允许攻击者在以后访问系统。
    *   **数据窃取：**  脚本可能会尝试窃取域控制器上的敏感数据。

考虑到脚本的功能和潜在的风险，**投毒风险约为5%**。虽然该脚本的核心功能是利用已知的漏洞，但攻击者可能会在其中添加恶意代码，以扩大攻击范围或持久化访问。

**利用方式：**

1.  **环境准备：** 搭建包含域控制器的Windows Server环境，确保目标域控制器未安装CVE-2020-1472补丁。
2.  **执行POC代码：** 运行提供的`cve-2020-1472-exploit.py`脚本，指定目标域控制器的NetBIOS名称和IP地址。
3.  **验证漏洞：** 脚本将尝试通过零认证重置域控制器的密码。如果成功，脚本将显示漏洞利用成功的消息。
4.  **获取权限：** 使用空密码对域控制器进行身份验证，并获取域管理员权限。可以使用工具如`secretsdump.py` (在 Dockerfile 复制到工作目录中) 提取域哈希值。
5.  **清理（可选）：** 在完成测试后，应尽快将域控制器的密码恢复到原始状态，并应用CVE-2020-1472补丁。

**项目地址:** [itssmikefm/CVE-2020-1472](https://github.com/itssmikefm/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #24

**来源**: [CVE-2020-1472-likeww_MassZeroLogon.md](../2020/CVE-2020-1472-likeww_MassZeroLogon.md)

## CVE-2020-1472 (Zerologon) Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未认证的攻击者获取域管理员权限，完全控制域。

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2等。

**利用条件:** 攻击者需要位于与域控制器相同的网络，能够通过MS-NRPC协议与域控制器通信。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472 (Zerologon) 是一个严重的特权提升漏洞，存在于Windows Server的Netlogon协议中。攻击者可以通过将Netlogon客户端使用的凭据中的多个字节设置为零来利用此漏洞。成功利用此漏洞后，攻击者可以冒充域控制器并获取域管理员权限。

**漏洞利用有效性：**

提供的POC代码（`MassZeroLogon.py`）旨在检测目标域控制器是否存在CVE-2020-1472漏洞。它通过尝试使用全零的凭据进行身份验证来利用漏洞。如果身份验证成功，则表示目标容易受到攻击。

根据搜索结果和漏洞信息，该漏洞利用是有效的，并且有公开可用的PoC。

**投毒风险：**

对提供的POC代码进行了分析，发现以下潜在的投毒风险：

*   该脚本依赖于多个第三方库（例如 `impacket`, `nmb`, `termcolor`），这些库本身可能包含漏洞或恶意代码。但这是代码依赖，不是投毒。
*   该脚本从 GitHub 下载，这意味着代码可能已被修改或包含后门。
*   脚本的目的是验证漏洞，因此它本质上不是恶意软件。然而，任何能被利用的工具都可能被滥用。

综合评估，投毒风险较低，主要来自于代码依赖和潜在的供应链攻击。

**利用方式：**

漏洞利用方式如下：

1.  攻击者使用`MassZeroLogon.py`脚本，指定目标域控制器的IP地址和计算机名。
2.  脚本尝试通过Netlogon协议与域控制器建立连接。
3.  脚本发送一个包含全零凭据的身份验证请求。
4.  如果域控制器存在漏洞，它将接受全零凭据，从而允许攻击者绕过身份验证。
5.  成功利用漏洞后，攻击者可以使用`impacket-secretsdump`工具从域控制器中提取敏感信息（例如，NTLM哈希）。
6.  攻击者可以使用提取的NTLM哈希来冒充域管理员并完全控制域。

**项目地址:** [likeww/MassZeroLogon](https://github.com/likeww/MassZeroLogon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #25

**来源**: [CVE-2020-1472-logg-1_0logon.md](../2020/CVE-2020-1472-logg-1_0logon.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个存在于Netlogon远程协议（MS-NRPC）中的权限提升漏洞。未经身份验证的攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞。攻击成功后，攻击者可以在网络设备上运行特制的应用程序，最终获得域管理员权限，完全控制域。

**漏洞利用方式：**

1.  **建立连接：** 攻击者使用MS-NRPC协议连接到域控制器。
2.  **零化凭据：**  攻击者发送一个所有位均为零的凭据和挑战，利用Netlogon协议中的加密缺陷。
3.  **密码重置：**  如果身份验证绕过成功，攻击者将尝试将域控制器的机器帐户密码重置为空。
4.  **提权：** 使用重置后的空密码或修改后的密码，攻击者可以冒充域控制器，窃取域凭据并接管域。

**有效性：**

提供的POC代码是有效的，因为它利用了Netlogon协议中的加密漏洞，允许攻击者将域控制器的机器帐户密码重置为空，从而获得域管理员权限。搜索结果中的多个链接表明该漏洞已广泛传播，并且存在可用的利用代码。

**投毒风险：**

经过分析，提供的POC代码本身没有发现明显的恶意投毒代码。该脚本的主要功能是利用漏洞进行身份验证绕过和密码重置。脚本相对简洁，目标明确，没有发现任何尝试执行额外恶意操作的代码。

**结论：**

CVE-2020-1472是一个严重的安全漏洞，攻击者可以利用它完全控制Windows Server域。提供的POC代码可以有效利用此漏洞。根据代码的审查，未发现投毒风险。

**项目地址:** [logg-1/0logon](https://github.com/logg-1/0logon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #26

**来源**: [CVE-2020-1472-puckiestyle_CVE-2020-1472.md](../2020/CVE-2020-1472-puckiestyle_CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon) Netlogon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本包括2004, 2019, 1909, 1903, 2016, 2008 R2 SP1, 2012, 2012 R2, 20H2，在未安装相应补丁的服务器上存在。

**利用条件:** 攻击者需要位于与域控制器相同的网络中，且能够与其进行通信。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Netlogon Remote Protocol (MS-NRPC) 中的权限提升漏洞。攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞。成功利用该漏洞的攻击者可以在网络上的设备上运行特制应用程序，从而获得域管理员权限，完全控制域控制器。

**有效性：**
提供的POC代码（zerologon_tester.py）用于检测目标域控制器是否存在Zerologon漏洞。它尝试通过将Netlogon安全通道的客户端凭据设置为全零来绕过身份验证。如果成功绕过身份验证，则表明目标易受攻击。

**投毒风险：**
该代码主要用于检测漏洞，但存在潜在的投毒风险，约为10%。虽然主要功能是漏洞验证，但攻击者可以修改此代码，在成功利用漏洞后植入后门或执行其他恶意操作。由于代码使用Impacket库，并且涉及网络通信和身份验证绕过，因此潜在的恶意修改可能会难以检测。

**利用方式：**
1.  **身份验证绕过：** 攻击者使用 zerologon_tester.py 脚本，通过将Netlogon安全通道的客户端凭据设置为全零，来尝试绕过身份验证。
2.  **重置域控制器密码：** 如果身份验证绕过成功，攻击者可以使用其他工具（例如Impacket中的secretsdump.py）重置域控制器的密码。
3.  **获取域管理员权限：** 通过重置域控制器密码，攻击者可以获得域管理员权限，从而完全控制域。

综上所述，该漏洞的利用方式非常直接，风险极高，利用难度相对较低，但需要攻击者位于目标网络内部。

**项目地址:** [puckiestyle/CVE-2020-1472](https://github.com/puckiestyle/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #27

**来源**: [CVE-2020-1472-sho-luv_zerologon.md](../2020/CVE-2020-1472-sho-luv_zerologon.md)

## CVE-2020-1472 Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 版本1903, 版本1909, 版本2004, 版本20H2

**利用条件:** 需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个Netlogon权限提升漏洞，允许未经身份验证的攻击者通过MS-NRPC协议与域控制器建立脆弱的安全通道连接，将域控制器的机器帐户密码置零，从而获得域管理员权限。攻击利用方式如下：

1.  **漏洞原理：** 该漏洞源于Netlogon远程协议（MS-NRPC）在处理身份验证时的加密实现缺陷，特别是AES-CFB8的使用。
2.  **攻击步骤：**
    *   攻击者使用提供的Python脚本（`zerologon.py`）与目标域控制器建立连接。
    *   脚本尝试将域控制器的机器帐户密码置零。这会暂时中断域控制器的正常功能，但脚本会在攻击完成后尝试恢复原始密码。
    *   如果`-exploit`选项被使用，脚本会执行以下操作：
        *   将域控制器的系统密码置零。
        *   使用secretsdump工具的DRSUAPI功能，通过置零的密码获取NTDS哈希。
        *   解析转储的数据，获取域管理员帐户（RID为500）的信息，并再次调用secretsdump获取LSA Secrets。
        *   解析第二次转储的数据，获取`plain_password_hex`值。
        *   调用restore脚本，使用hex值将域控制器的系统密码恢复到原始值。
3.  **利用有效性：**  根据漏洞库信息和搜索结果，该漏洞利用的POC是公开可用的，并且已经被广泛利用。因此，该漏洞利用是有效的，如果目标系统未打补丁，则攻击很可能成功。
4.  **投毒风险：** 代码仓库中存在投毒代码的可能性较低。虽然脚本具有修改域控密码的功能，可能造成短期影响，但是从代码本身来看，目的是为了演示漏洞和提取哈希，而不是进行恶意破坏或植入后门。作者添加恶意代码，让攻击者承担法律风险的收益较低。代码投毒风险估计为10%。主要风险点在于使用者对脚本的修改和使用方式不当。代码有恢复密码的逻辑。
5.  **缓解措施：**
    *   及时安装Microsoft提供的安全更新。
    *   监控事件日志，查找与CVE-2020-1472相关的事件，例如事件ID 4661、4723和4738。
    *   遵循Microsoft的指南，管理Netlogon安全通道连接的更改。

**项目地址:** [sho-luv/zerologon](https://github.com/sho-luv/zerologon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #28

**来源**: [CVE-2020-1472-sv3nbeast_CVE-2020-1472.md](../2020/CVE-2020-1472-sv3nbeast_CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon) Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可导致域控制器的完全接管

**影响版本:** 受影响的Windows Server版本，具体参见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472 (Zerologon) 漏洞利用 Netlogon 协议中的一个加密缺陷，允许未经身份验证的攻击者通过 MS-NRPC 协议与域控制器建立连接，并将域控制器的计算机帐户密码重置为空。成功利用此漏洞后，攻击者可以冒充域控制器，窃取域凭据，并完全控制整个域。

**利用方式：**

1.  攻击者使用提供的 Python 脚本 `cve-2020-1472-exploit.py`。
2.  脚本首先尝试通过发送全零的 challenge 和 credential 来进行身份验证。如果域控制器存在漏洞，则会接受此身份验证。
3.  一旦成功通过身份验证，脚本将使用 `NetrServerPasswordSet2` 函数将域控制器的计算机帐户密码设置为空字符串。
4.  密码设置为空后，攻击者可以使用其他工具（例如 Mimikatz）来获取域管理员权限。

**有效性：**

提供的 POC 代码有效。搜索引擎结果表明 CVE-2020-1472 是一个严重的漏洞，并且存在公开可用的利用代码。POC代码经过测试，可以成功利用漏洞。

**投毒风险：**

该代码仓库主要包含一个利用脚本和一些必要的导入包。虽然不能完全排除投毒的可能性，但是从代码本身来看，主要功能是利用 Zerologon 漏洞，没有发现明显的恶意代码。

*   `LICENSE` 文件为 MIT 许可，允许自由使用和修改代码。
*   `README.md` 文件是对漏洞和利用的简单介绍，并提供了作者的博客链接。
*   `cve-2020-1472-exploit.py` 是主要的利用脚本，实现了漏洞利用的逻辑。

投毒的可能很小，但是**建议在受控环境中运行此脚本，并仔细审查代码，以确保其安全性。**

**项目地址:** [sv3nbeast/CVE-2020-1472](https://github.com/sv3nbeast/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #29

**来源**: [CVE-2020-1472-tdevworks_CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation.md](../2020/CVE-2020-1472-tdevworks_CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation.md)

## CVE-2020-1472 (Zerologon) Netlogon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本众多，参见漏洞库信息

**利用条件:** 需要位于与域控制器相同的网络，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472 (Zerologon) 是一个严重的权限提升漏洞，存在于 Netlogon 远程协议 (MS-NRPC) 中。未经身份验证的攻击者可以通过建立与域控制器的脆弱 Netlogon 安全通道连接来利用此漏洞，最终获得域管理员权限。

**利用方式：**
1.  攻击者使用漏洞利用脚本（例如提供的`zerologon_tester.py`）通过 MS-NRPC 与域控制器建立连接。
2.  脚本利用 Netlogon 协议中的加密缺陷，将域控制器的计算机帐户密码重置为空。
3.  攻击者现在可以使用重置的密码或使用其他技术（例如 DCSync）来转储域凭据。
4.  攻击者可以使用获得的域凭据来控制域。

**有效性：**
提供的 PoC 代码 (`zerologon_tester.py`) 旨在验证域控制器的漏洞，并且根据描述，它能够成功地表明目标可以被 ZeroLogon 攻击完全攻破。搜索结果也证实了此漏洞的严重性和可利用性。

**投毒风险：**
尽管主要代码似乎是为了检测漏洞，但该仓库中存在投毒风险的可能性较低，估计为10%。原因如下：
* 仓库主要目的是演示检测和缓解措施，而非直接的攻击利用。
* 代码使用了公开可用的 PoC 脚本，来源SecuraBV，降低了作者自行添加恶意代码的可能性。
*  虽然存在修改 Suricata 配置文件的步骤，但这通常是出于配置目的，但仍然可能存在恶意配置被添加到 Suricata 规则中。因此，用户在使用该仓库中的脚本和规则时，应仔细审查代码和配置，确保没有隐藏的恶意行为。

**项目地址:** [tdevworks/CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation](https://github.com/tdevworks/CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #30

**来源**: [CVE-2020-1472-whoami-chmod777_Zerologon-Attack-CVE-2020-1472-POC.md](../2020/CVE-2020-1472-whoami-chmod777_Zerologon-Attack-CVE-2020-1472-POC.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括但不限于 2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 攻击者需要位于与域控制器相同的网络中

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472 (Zerologon) 漏洞存在于 Netlogon 远程协议 (MS-NRPC) 的加密实现中。攻击者可以通过将域控制器的计算机密码设置为全零，从而控制域控制器。

**有效性：** 根据提供的漏洞信息、搜索结果和漏洞利用代码，该POC代码是有效的。搜索结果显示该漏洞已被广泛利用，且存在公开可用的POC代码。

**投毒风险：** 分析提供的POC代码和`README.md`文件，发现以下潜在的投毒风险：

*   `README.md` 明确指出，默认情况下，该POC会更改域控制器帐户的密码，导致域控制器之间的通信中断。虽然这本身是漏洞利用的一部分，但如果攻击者不了解此副作用并贸然使用，可能会导致严重的生产环境故障。
*   `README.md` 文件中提到需要使用特定版本的 Impacket，如果用户从不可信的来源下载 Impacket，可能存在被植入恶意代码的风险。
*   `cve-2020-1472-exploit.py` 脚本中设置了 `MAX_ATTEMPTS` 为2000，虽然这个值是用来限制尝试次数，防止无限循环，但如果恶意修改此值，可能会降低攻击的成功率。但从代码逻辑来看，这个并不是投毒代码。

综合来看，投毒风险较低，主要集中在用户对POC的误用和对第三方库的依赖上。因此，我给出的投毒风险为5%。

**利用方式：**

1.  攻击者使用`cve-2020-1472-exploit.py`脚本，通过 Netlogon 协议与域控制器建立连接。
2.  脚本利用 MS-NRPC 中的漏洞，将域控制器的计算机帐户密码设置为全零。
3.  攻击者可以使用 secretsdump.py 之类的工具，通过DCSync 协议获取域控制器的敏感信息（例如域管理员哈希）。
4.  攻击者可以使用获取到的域管理员权限控制整个域。
5.  攻击者可以选择使用 `restorepassword.py` 恢复域控制器的原始密码，以避免引起注意（但这需要提前备份原始密码）。

**项目地址:** [whoami-chmod777/Zerologon-Attack-CVE-2020-1472-POC](https://github.com/whoami-chmod777/Zerologon-Attack-CVE-2020-1472-POC)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #31

**来源**: [CVE-2020-1472-zeronetworks_zerologon.md](../2020/CVE-2020-1472-zeronetworks_zerologon.md)

## CVE-2020-1472 Zerologon 本地提权漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括但不限于2008 R2, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472 (Zerologon) 允许未经身份验证的攻击者通过 Netlogon 协议控制域控制器。该漏洞源于 Netlogon 协议中使用的加密算法的缺陷。攻击者通过将客户端凭据设置为全零，可以有效地绕过身份验证，从而冒充域控制器并接管域。提供的POC代码 `zerologon.py` 实现了通过 RPC/SMB 利用此漏洞的验证过程。该脚本通过与域控制器的 Netlogon 服务建立连接，发送全零的 challenge 和 credential 进行身份验证。由于存在漏洞，域控制器会错误地接受这些无效凭据，从而允许攻击者执行特权操作。

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码是有效的。搜索结果表明，Zerologon 是一个严重的安全漏洞，可以被利用来完全控制域。提供的POC代码是基于已知的利用方法实现的，通过 Netlogon 协议发送特制的身份验证请求，利用加密算法中的缺陷来绕过身份验证。

**投毒风险：**

评估POC代码是否存在投毒风险，需要仔细分析代码逻辑。代码片段显示，它主要是利用 Netlogon 协议的漏洞，通过发送全零 challenge 和 credential 来绕过身份验证。以下是代码的风险分析：

*   **随机字节** 代码在客户端挑战和客户端凭据中引入了一个随机字节 `finaly_rand_byte = os.urandom(1)`。这主要是为了规避简单的IDS签名检测，并非恶意投毒代码。
*   **条件执行**：脚本包含 `-t` 参数可以选择 RPC 或 SMB 协议进行测试。这并不构成投毒。
*   **impacket库的使用**：代码使用了 `impacket` 库，这是一个常用的网络协议库，本身没有恶意。但是，如果 `impacket` 库被篡改，可能会引入恶意代码。但是从代码本身来看，没有直接的投毒代码存在。

虽然代码本身没有明显的恶意行为，但仍存在一定的风险，例如依赖的库可能存在安全问题，或者代码的某些部分可能被用于恶意目的。因此，将投毒风险评估为10%。

**利用方式：**

1.  **目标识别：** 确定目标域控制器的NetBIOS名称和IP地址。
2.  **连接建立：** 使用RPC/SMB与目标域控制器的Netlogon服务建立连接。
3.  **身份验证绕过：** 通过发送全零的challenge和credential尝试身份验证。POC代码中，`plaintext` 和 `ciphertext` 变量被设置为全零。
4.  **权限提升：** 成功绕过身份验证后，攻击者可以执行特权操作，例如更改域管理员密码、创建新的域管理员账户等。
5.  **域控制：** 最终，攻击者可以完全控制整个域。

请注意，利用此漏洞可能导致严重的后果，包括数据泄露、服务中断等。务必在获得授权的情况下进行测试，并采取必要的安全措施。

**项目地址:** [zeronetworks/zerologon](https://github.com/zeronetworks/zerologon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---



---

## POC #9

**来源**: [CVE-2020-1472-JolynNgSC_Zerologon_CVE-2020-1472.md](../2020/CVE-2020-1472-JolynNgSC_Zerologon_CVE-2020-1472.md)

## CVE-2020-1472 Netlogon Elevation of Privilege Vulnerability (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获取域管理员权限并完全控制域

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 1903, 1909, 2004, 20H2

**利用条件:** 攻击者需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472 (Zerologon) 是 Microsoft Netlogon 协议中的一个严重漏洞，允许未经身份验证的攻击者通过设置 Netlogon 安全通道连接的客户端凭据为全零来冒充域控制器。成功利用此漏洞后，攻击者可以接管整个 Windows 域。 

**有效性:**  根据搜索引擎结果和漏洞利用代码，此漏洞的POC代码是有效的。许多安全研究人员和组织已经成功地利用此漏洞进行了概念验证和实际攻击。

**投毒风险:**  提供的代码仓库主要包含漏洞利用步骤和检测方法，用于模拟 Zerologon 攻击以进行防御和缓解。其中提到的[https://github.com/dirkjanm/CVE-2020-1472](https://github.com/dirkjanm/CVE-2020-1472)是原始漏洞利用代码，本身不包含恶意代码，投毒风险主要存在于引用的第三方库或者其他未明确说明的操作中。由于该代码库的目的在于演示漏洞，且代码量相对较小，人工可以审核，因此判断投毒风险较低。但依旧存在一定的风险。通过分析整个代码仓库，包含恶意代码的风险预估为10%。

**利用方式:**

1.  **利用漏洞:**  攻击者使用提供的 Python 脚本（cve-2020-1472-exploit.py）将域控制器的 Netlogon 安全通道凭据设置为全零。
2.  **获取域管理员哈希:**  使用 `secretsdump.py` 从域控制器转储域管理员哈希。
3.  **权限提升:**  使用 `wmiexec.py` 通过获得的域管理员哈希来执行任意命令并完全控制域。

**缓解措施:**

*   及时应用 Microsoft 提供的安全补丁。
*   监控 Windows 事件查看器中与 Zerologon 攻击相关的事件 ID（例如，4624 和 4742）。
*   强制执行安全的 RPC 与 Netlogon 连接。

**项目地址:** [JolynNgSC/Zerologon_CVE-2020-1472](https://github.com/JolynNgSC/Zerologon_CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #10

**来源**: [CVE-2020-1472-PakwanSK_Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks..md](../2020/CVE-2020-1472-PakwanSK_Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks..md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。攻击者通过建立一个与域控制器的脆弱的Netlogon安全通道连接，可以运行特制的应用程序，最终获得域管理员权限，完全控制域。该漏洞利用方式主要分为以下几个步骤：

1.  **发现目标域控制器：** 攻击者需要确定目标域控制器的IP地址。
2.  **利用MS-NRPC协议漏洞：** 攻击者利用MS-NRPC协议中的加密缺陷，特别是AES-CFB8的实现问题，将域控制器的计算机密码重置为空。
3.  **恢复域控制器密码并获得权限：** 攻击者通常会重置域控制器的密码为空，然后通过其他方式（如DCSync）获取域控制器的账号信息，并获得域管理员权限。

**有效性：** 根据漏洞库信息、搜索结果和提供的POC代码，该漏洞利用的有效性非常高。存在公开的POC代码，并且已经被广泛利用。

**投毒风险：** 提供的代码仓库主要是模拟和预防Zerologon漏洞攻击。该仓库链接到 `https://github.com/VoidSec/CVE-2020-1472` 包含checker 和 exploit 代码。 仓库本身主要是使用说明和演示，投毒风险较低，但是下载的POC代码存在一定的风险，需要仔细检查代码是否包含恶意代码，故投毒风险评估为10%。

**利用方式：**

1.  **未授权访问：**  攻击者无需任何凭据，就可以利用该漏洞。
2.  **密码重置：**  攻击利用的核心在于将域控制器的机器帐户密码设置为0。
3.  **权限提升：**  成功重置密码后，攻击者可以使用其他攻击技术（例如DCSync攻击）来提取域凭据并完全控制域。

**缓解措施：**

1.  **及时安装补丁：**  应用Microsoft发布的针对CVE-2020-1472的补丁。
2.  **强制执行安全通道：**  配置Netlogon安全通道以强制执行签名和加密。
3.  **监控可疑活动：**  监控Netlogon协议的异常活动，例如大量密码重置尝试。

**项目地址:** [PakwanSK/Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks.](https://github.com/PakwanSK/Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks.)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #11

**来源**: [CVE-2020-1472-RicYaben_CVE-2020-1472-LAB.md](../2020/CVE-2020-1472-RicYaben_CVE-2020-1472-LAB.md)

## CVE-2020-1472 Zerologon Netlogon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控被接管

**影响版本:** 受影响的Windows Server版本，具体见漏洞库信息

**利用条件:** 需要位于目标网络的内部，能够与域控制器通信

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472（Zerologon）是一个存在于Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。未经验证的攻击者可以通过MS-NRPC连接到域控制器，并使用一组全零的加密密钥来执行身份验证，从而完全控制域。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞影响多个版本的Windows Server，并且存在公开可用的POC。POC代码（zerologon_tester.py）旨在测试目标域控制器是否存在漏洞，通过尝试Netlogon身份验证绕过进行检测。如果成功绕过，脚本将立即终止。因此，提供的POC代码是有效的漏洞验证工具。

**投毒风险：**
分析Dockerfile、LICENSE、README.md以及zerologon_tester.py的内容，没有发现明显的恶意代码或后门。Dockerfile用于构建包含POC脚本的Docker镜像，LICENSE是MIT许可，允许自由使用和修改，README.md提供使用说明。zerologon_tester.py脚本主要用于验证漏洞存在，不执行任何提权或持久化的操作。但是，任何代码都存在被篡改的可能。因此，认为存在1%的潜在投毒风险，主要来自于以下可能：

1.  **依赖项投毒：** requirements.txt文件中指定的依赖库（特别是impacket）可能被替换为恶意版本。
2.  **构建过程投毒：** Dockerfile构建过程中，可能存在恶意指令篡改。

**利用方式：**
1.  **环境准备：** 需要一台能够访问目标域控制器的机器，并安装Python环境和相关依赖库（impacket, cryptography）。
2.  **漏洞验证：** 运行zerologon_tester.py脚本，指定目标域的NetBIOS名称和IP地址。脚本会尝试使用全零密钥进行Netlogon身份验证绕过。
3.  **攻击：** 如果漏洞验证成功，则目标域控制器存在Zerologon漏洞。攻击者可以使用更复杂的利用代码来重置域控制器的计算机密码，从而获得域管理员权限。

搜索结果中包含了大量的漏洞分析文章和缓解措施，表明该漏洞已经被广泛研究和利用。Microsoft已经发布了补丁程序来修复此漏洞，因此确保域控制器已安装最新的安全更新至关重要。

**项目地址:** [RicYaben/CVE-2020-1472-LAB](https://github.com/RicYaben/CVE-2020-1472-LAB)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #12

**来源**: [CVE-2020-1472-Rvn0xsy_ZeroLogon.md](../2020/CVE-2020-1472-Rvn0xsy_ZeroLogon.md)

## CVE-2020-1472 Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server Netlogon Remote Protocol (MS-NRPC)

**危害等级:** 高危，可能导致域管理员权限获取

**影响版本:** 受影响的Windows Server版本（见漏洞库信息）

**利用条件:** 攻击者需要位于目标网络的内部，能够与域控制器建立Netlogon连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server的Netlogon协议实现中。攻击者可以通过将Netlogon会话的机器密码置零，从而绕过身份验证，最终控制域控制器。提供的POC代码是一个C++版本的Zerologon利用工具，它直接重置机器帐户的密码。 **有效性：** 根据漏洞信息、搜索结果和提供的代码，该漏洞利用是有效的。搜索结果中多个链接都提到了Zerologon漏洞的利用，并且存在公开的POC代码。 **投毒风险：** 查看代码后，该工具会直接重置机器账户的密码，无具备恢复功能，具有一定的破坏性。虽然名为“ZeroLogon”，该工具实际重置密码，而不是简单验证，需要管理员级别的权限进行操作， 存在被恶意使用的风险，例如通过捆绑其他恶意程序进行传播等。因此，评估投毒风险为10%。 **利用方式：** 1.  攻击者需要位于目标网络的内部。2.  攻击者利用Zerologon漏洞，通过MS-NRPC协议与域控制器建立连接，并将域控制器的机器帐户密码重置为空。3.  攻击者利用重置后的空密码，冒充域控制器进行身份验证。4.  攻击者获得域管理员权限，从而控制整个域。

**项目地址:** [Rvn0xsy/ZeroLogon](https://github.com/Rvn0xsy/ZeroLogon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #13

**来源**: [CVE-2020-1472-SecuraBV_CVE-2020-1472.md](../2020/CVE-2020-1472-SecuraBV_CVE-2020-1472.md)

## CVE-2020-1472 - Netlogon Elevation of Privilege Vulnerability (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域管理员权限被获取，控制整个域

**影响版本:** 受影响的Windows Server版本包括：2004, 2019, 1909, 1903, 2016, 2008 R2, 2012, 2012 R2, 20H2

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472 (Zerologon) 漏洞存在于 Netlogon 远程协议 (MS-NRPC) 中。未经身份验证的攻击者可以通过 MS-NRPC 连接到域控制器，利用加密算法中的缺陷来冒充域控制器，并最终获得域管理员权限。

**有效性：**
提供的PoC代码 `zerologon_tester.py` 旨在检测目标域控制器是否存在 Zerologon 漏洞。它通过尝试使用全零的challenge和credential进行Netlogon身份验证绕过来实现检测。如果成功绕过身份验证，则表明目标存在漏洞。

**投毒风险：**
分析提供的 Dockerfile, requirements.txt, LICENSE, README.md, zerologon_tester.py 文件，并未发现明显的恶意代码或后门。该代码主要依赖于 `impacket` 库实现 Netlogon 协议的交互和漏洞利用。但仍存在极低的投毒风险，例如:

*   `impacket` 库本身被篡改或使用恶意版本（虽然可能性较低，但需要考虑）。
*   代码中存在细微的逻辑错误，可能导致程序在特定环境下执行非预期操作（比如拒绝服务），虽然这些错误并非有意的，但属于一种潜在的风险。
*   `zerologon_tester.py` 本身虽然是漏洞检测工具，但攻击者可能会修改该工具，使其在检测漏洞的同时执行其他恶意操作。此脚本依赖第三方库,若第三方库被劫持,则存在风险。

综上，该仓库本身存在投毒的可能性较低，约为5%，但用户在使用该代码时仍需谨慎，仔细审查代码，确保使用的第三方库是可信的。

**利用方式：**
1.  攻击者使用 `zerologon_tester.py` 脚本检测目标域控制器是否存在漏洞。
2.  如果存在漏洞，攻击者可以重置域控制器的机器帐户密码。
3.  攻击者使用重置后的密码进行身份验证，获得域管理员权限。
4.  攻击者可以导出域内用户凭据、安装恶意软件、横向移动等，最终控制整个域。

**缓解措施：**
1.  及时安装 Microsoft 发布的 CVE-2020-1472 安全更新。
2.  监控网络流量，检测是否存在 Zerologon 攻击。
3.  强制执行签名和加密的 Netlogon 通信。

搜索引擎结果中，提供了关于 CVE-2020-1472 的漏洞概述、利用步骤、检测工具和缓解措施等信息，进一步验证了该漏洞的严重性和利用方式。

**项目地址:** [SecuraBV/CVE-2020-1472](https://github.com/SecuraBV/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #14

**来源**: [CVE-2020-1472-TheJoyOfHacking_SecuraBV-CVE-2020-1472.md](../2020/CVE-2020-1472-TheJoyOfHacking_SecuraBV-CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon): Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域管理员权限被获取

**影响版本:** 受影响的Windows Server版本包括2004, 2019, 1909, 1903, 2016, 2008 R2 SP1, 2012, 2012 R2, 和 20H2。具体版本参考漏洞库信息。

**利用条件:** 攻击者需要位于与域控制器相同的网络，并能够与其进行通信。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472（Zerologon）是一个Netlogon协议中的严重漏洞，允许未经身份验证的攻击者通过建立到域控制器的脆弱Netlogon安全通道连接来提升权限，最终获取域管理员权限。漏洞的根源在于Netlogon协议在身份验证过程中使用了存在缺陷的加密算法（AES-CFB8）。攻击者可以利用该漏洞将域控制器的机器帐户密码重置为空，从而完全控制域。提供的漏洞利用代码 `zerologon_tester.py`  使用 Impacket 库尝试执行 Netlogon 身份验证绕过。如果成功绕过，脚本将立即终止。如果域控制器已修补，脚本会在发送 2000 对 RPC 调用后放弃，并认为目标不易受攻击。Dockerfile 用于构建包含所需依赖项（包括 Impacket）的 Alpine Linux 容器，从而简化漏洞利用脚本的部署和执行。requirements.txt 文件指定了脚本的依赖项，例如 `impacket==0.9.23`。LICENSE文件是MIT许可证,表明代码是开源的。通过分析提供的 Dockerfile，requirements.txt，LICENSE，README.md 和 Python 脚本，我发现投毒代码的可能性极低(约1%)。虽然始终存在人为引入恶意代码的可能性，但是该代码库的结构和内容表明其主要目的是为了验证漏洞是否存在。

**项目地址:** [TheJoyOfHacking/SecuraBV-CVE-2020-1472](https://github.com/TheJoyOfHacking/SecuraBV-CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #15

**来源**: [CVE-2020-1472-TheJoyOfHacking_dirkjanm-CVE-2020-1472.md](../2020/CVE-2020-1472-TheJoyOfHacking_dirkjanm-CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server Netlogon

**危害等级:** 高危，可能导致域接管

**影响版本:** 受影响的Windows Server版本包括Windows Server 2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 攻击者需要位于与域控制器相同的网络中

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个Windows Server Netlogon协议中的权限提升漏洞。未经身份验证的攻击者可以通过建立一个脆弱的Netlogon安全通道连接到域控制器来利用此漏洞，从而获得域管理员权限。

**有效性：**

提供的POC代码通过将域控制器的机器账户密码设置为零来利用该漏洞。成功利用后，攻击者可以使用DCSync获取域凭据，从而控制整个域。根据漏洞信息和搜索结果，该POC代码的有效性较高，已被广泛使用。

**投毒风险：**

该仓库中可能存在的投毒风险评估为10%。 风险主要来源于以下几个方面：

1.  **密码重置风险：** POC 默认会将域控制器的机器账户密码重置为空，这会导致与其它域控制器的通信中断。虽然脚本提供了恢复密码的方法，但如果操作不当或者恢复流程失败，可能会导致域功能异常。
2.  **依赖关系：** POC 依赖于 impacket 库的特定版本，如果使用错误的版本可能会导致脚本运行失败或产生未知的副作用。
3.  **脚本修改：** 下载的脚本可能被恶意修改，例如添加额外功能（后门）。尽管此POC的核心功能是已知的，但仍然存在下载后被修改的可能性。 虽然风险较低，但用户应始终从可信来源下载代码并进行代码审计。

**利用方式：**

1.  攻击者首先使用提供的`cve-2020-1472-exploit.py`脚本，指定目标域控制器的IP地址和NetBIOS名称。此脚本会尝试将域控制器的机器账户密码设置为零。
2.  如果攻击成功，攻击者可以使用`secretsdump.py`（Impacket库的一部分）从域控制器中提取域凭据，包括域管理员账户的哈希值。
3.  攻击者可以使用提取到的域管理员凭据来控制整个域。
4.  为了避免影响域控制器的正常运行，攻击者可以使用`restorepassword.py`脚本，配合从注册表中dump出的hex password（通过 secretsdump 获得），将域控制器的机器账户密码恢复为原始密码。

**修复建议：**

*   安装Microsoft官方发布的补丁。
*   监控网络中是否存在利用CVE-2020-1472的攻击行为。
*   强制执行签名和加密的Netlogon通信。


**项目地址:** [TheJoyOfHacking/dirkjanm-CVE-2020-1472](https://github.com/TheJoyOfHacking/dirkjanm-CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #16

**来源**: [CVE-2020-1472-TuanCui22_ZerologonWithImpacket-CVE2020-1472.md](../2020/CVE-2020-1472-TuanCui22_ZerologonWithImpacket-CVE2020-1472.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2等。

**利用条件:** 攻击者需要位于与域控制器相同的网络中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Netlogon远程协议（MS-NRPC）中的特权提升漏洞。攻击者可以利用此漏洞通过将域控制器的计算机账号密码置零来接管域。 

**有效性：**
根据漏洞库信息、搜索结果和提供的impacket代码仓库信息来看，此漏洞的POC代码是有效的。大量公开的POC和利用脚本存在，并且该漏洞已被广泛利用。

**投毒风险：**
提供的代码片段是impacket的ChangeLog.md文件，它记录了impacket项目的更新日志。Impacket是一个常用的Python库，被安全研究人员和渗透测试人员广泛使用，用于处理网络协议。虽然Impacket本身是一个合法的安全工具，但如果从不可信的来源下载或使用修改过的版本，则可能存在投毒风险。分析提供的ChangeLog.md，并没有发现直接的投毒代码。但是由于该项目代码量巨大，并且可以通过引入恶意模块进行投毒，所以存在一定的投毒风险。综合考虑，风险值大约在10%。

**利用方式：**
1.  **连接域控制器：** 攻击者使用MS-NRPC协议连接到目标域控制器。
2.  **密码置零：** 攻击者通过精心构造的Netlogon请求，将域控制器的计算机账号密码重置为空。
3.  **获取域管理员权限：** 密码置零后，攻击者可以使用该计算机账号来请求Kerberos票据，并最终获得域管理员权限。
4.  **完全控制域：** 攻击者获得域管理员权限后，可以执行任何操作，包括窃取数据、安装恶意软件、创建新的账号等。

**项目地址:** [TuanCui22/ZerologonWithImpacket-CVE2020-1472](https://github.com/TuanCui22/ZerologonWithImpacket-CVE2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #17

**来源**: [CVE-2020-1472-bb00_zer0dump.md](../2020/CVE-2020-1472-bb00_zer0dump.md)

## CVE-2020-1472 (Zerologon) 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全接管

**影响版本:** 受影响的Windows Server版本，具体参见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个存在于Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。攻击者可以通过将域控制器的Netlogon密码重置为零，从而冒充域控制器并接管整个域。利用方式如下：

1.  **漏洞原理：** 该漏洞源于MS-NRPC协议中使用AES加密算法时，没有正确验证初始化向量（IV）。攻击者可以发送大量精心构造的认证请求，这些请求的IV均为零。由于加密算法的特性，这会导致认证过程中的某些步骤失效，使得攻击者能够成功建立与域控制器的安全通道。
2.  **利用步骤：**
    *   使用POC工具（如Zer0Dump）连接到目标域控制器。
    *   通过修改Netlogon安全通道的密码（通常设置为全零），来利用该漏洞。
    *   利用Impacket等工具，使用已修改的密码来获取域控制器的权限。
    *   导出域用户的哈希值，或者直接执行其他恶意操作。

3.  **有效性：** 搜索引擎结果和漏洞库信息都表明此漏洞危害极大，且存在公开可用的POC代码。因此，提供的POC代码（Zer0Dump）很可能有效，可以被用于利用该漏洞。

4.  **投毒风险：** 分析提供的`psexec.py`代码，该文件是Impacket套件中的一个工具，用于在远程系统上执行命令。虽然`psexec.py`本身不是漏洞利用代码，但它可以被用于在成功利用Zerologon漏洞后，在域控制器上执行恶意代码。`README.md`提及了Zer0dump，并感谢了相关人员，看起来像是正常的漏洞利用工具说明。
    *   **潜在风险点：** `psexec.py`需要配置用户名、密码等敏感信息，如果攻击者修改了`psexec.py`，可能会加入后门，例如将输入的凭据发送到远程服务器。此外，`Zer0dump`本身也有可能存在恶意代码，但从目前的代码来看，风险较低。
   总的来说，由于`psexec.py`需要用户提供凭据，且可以被篡改，以及`Zer0dump`本身可能存在未知风险，我判断此仓库存在 10% 的投毒风险。

请注意，成功利用该漏洞后，攻击者可以完全控制域环境，因此务必及时修补该漏洞。

**项目地址:** [bb00/zer0dump](https://github.com/bb00/zer0dump)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #18

**来源**: [CVE-2020-1472-blackh00d_zerologon-poc.md](../2020/CVE-2020-1472-blackh00d_zerologon-poc.md)

## CVE-2020-1472 Zerologon Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获取域管理员权限，完全控制域环境

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 攻击者需要与域控制器建立网络连接。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个严重的Windows Netlogon协议中的特权提升漏洞。攻击者可以通过向域控制器发送一系列特制的Netlogon消息来利用此漏洞，从而将域控制器的机器账户密码置为空。一旦密码被置为空，攻击者可以使用该空密码通过Netlogon协议对域控制器进行身份验证，并执行诸如更改域管理员密码、DCSync等恶意操作，从而完全控制整个域。

**有效性：**

根据漏洞信息和搜索结果，提供的PoC代码是有效的。许多安全研究人员和组织已经发布了该漏洞的利用代码，并成功利用该漏洞获取域管理员权限。

**投毒风险：**

分析PoC代码，该代码主要功能是：

1.  通过`try_zero_authenticate` 函数尝试将域控制器的Netlogon密码置零，通过多次认证尝试，利用加密算法缺陷达到目的。
2.  如果成功，则使用`exploit`函数将机器帐户密码实际设置为空字符串。
3.  可选地，使用`dcsync`函数从域控制器同步密码哈希。
4.  提供`restore_password`函数用于恢复原始密码。

从代码分析来看，主要风险在于利用成功后，攻击者可以完全控制域，而非PoC本身携带恶意代码。但用户使用未经审核的第三方代码始终存在风险，例如作者可能在代码中埋藏后门，收集用户信息等。因此，我们认为存在非常低的投毒风险，概率约为1%。

**利用方式：**

1.  **漏洞发现：** CVE-2020-1472 存在于 Netlogon 远程协议 (MS-NRPC) 中，该协议用于用户和机器对域控制器的身份验证。该漏洞源于 AES-CFB8 加密算法的实现缺陷，允许攻击者使用全零初始化向量。
2.  **攻击步骤：**
    *   攻击者首先需要与目标域控制器建立网络连接。
    *   利用PoC代码，通过`try_zero_authenticate`函数不断尝试使用全零凭据对域控制器进行身份验证。由于加密算法的缺陷，经过多次尝试后，域控制器可能会错误地接受全零凭据。
    *   一旦身份验证成功，攻击者使用`exploit`函数通过Netlogon协议将域控制器的机器账户密码设置为空字符串。
    *   现在，攻击者可以使用空密码通过Netlogon协议对域控制器进行身份验证。
    *   利用获取的域控制器权限，攻击者可以执行DCSync操作，获取域中所有用户的密码哈希，或者直接创建一个新的域管理员帐户。
3.  **缓解措施：**
    *   尽快安装 Microsoft 发布的针对 CVE-2020-1472 的安全更新。
    *   监控域控制器上的事件日志，查找与 Netlogon 相关的异常活动。
    *   强制执行 Netlogon 安全通道的签名和加密。

**项目地址:** [blackh00d/zerologon-poc](https://github.com/blackh00d/zerologon-poc)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #19

**来源**: [CVE-2020-1472-c3rrberu5_ZeroLogon-to-Shell.md](../2020/CVE-2020-1472-c3rrberu5_ZeroLogon-to-Shell.md)

## CVE-2020-1472 Zerologon权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，允许未授权的攻击者接管域控制器

**影响版本:** 受影响的Windows Server版本见漏洞库信息

**利用条件:** 攻击者需要位于与域控制器相同的网络，并且能够与其建立Netlogon连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个影响Windows Server Netlogon协议的权限提升漏洞。攻击者通过将域控制器的Netlogon密码置零，可以有效地禁用其身份验证机制。由于Netlogon协议在身份验证过程中使用AES-CFB8加密，但实现上存在缺陷，导致可以通过多次尝试将密码归零。

**有效性：**
提供的PoC代码 `zeroLogon_toShell.py` 尝试利用Zerologon漏洞将域控制器的Netlogon密码置零，然后利用`evil-winrm`工具获取域控制器的shell。根据搜索引擎结果和漏洞描述，该漏洞已经有公开的PoC，因此该代码的有效性较高。需要注意的是，利用成功需要提供有效的Administrator NTLM哈希。

**投毒风险：**
查看PoC代码，发现其主要功能是利用Zerologon漏洞，然后尝试使用`evil-winrm`连接到域控制器。代码中存在执行操作系统命令的部分 (`os.system`)，这部分存在潜在的投毒风险。例如，攻击者可能会修改`os.system`执行的命令，在受害者不知情的情况下安装后门或执行其他恶意操作。虽然目前的PoC看起来直接调用了`evil-winrm`，但攻击者可能插入额外的命令。代码还包含从用户那里获取Administrator NTLM Hash的部分，攻击者可以将获取到的hash发送到远程服务器，进行下一步利用。由于代码主要依赖于已知的漏洞利用方法，且没有发现明显的恶意代码，因此投毒风险为较低，估计为10%。

**利用方式：**
1.  **连接到域控制器：** 攻击者需要位于与目标域控制器相同的网络中。需要知道目标域控制器的NetBIOS名称和IP地址。
2.  **利用Zerologon漏洞：** 攻击者运行PoC脚本，该脚本尝试通过发送一系列特制的Netlogon请求将域控制器的密码置零。这个过程可能需要多次尝试。
3.  **恢复或者直接利用：**成功利用漏洞后，域控制器的密码被置零。原始exp需要先恢复机器账户密码，但是该PoC是直接输入Administrator NTLM Hash连接。攻击者可以使用`evil-winrm`等工具，使用置零密码或者Administrator NTLM Hash远程连接到域控制器。
4.  **权限提升：** 通过`evil-winrm`连接到域控制器后，攻击者拥有了系统权限，可以执行任意操作，例如添加域管理员账号、窃取敏感数据等。

**项目地址:** [c3rrberu5/ZeroLogon-to-Shell](https://github.com/c3rrberu5/ZeroLogon-to-Shell)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #20

**来源**: [CVE-2020-1472-carlos55ml_zerologon.md](../2020/CVE-2020-1472-carlos55ml_zerologon.md)

## CVE-2020-1472 Zerologon Netlogon特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全接管

**影响版本:** 受影响的Windows Server版本请参考漏洞库信息

**利用条件:** 需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的漏洞，存在于Microsoft Windows Netlogon远程协议（MS-NRPC）中。攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞，从而获得域管理员权限。 

**漏洞利用方式：**

1.  **利用MS-NRPC协议：** 攻击者使用MS-NRPC协议连接到域控制器。
2.  **零值凭据：**  攻击者通过发送一系列精心构造的Netlogon消息，其中包含零值凭据来重置域控制器的机器帐户密码。
3.  **权限提升：** 成功重置密码后，攻击者可以模拟域控制器账户，窃取域凭据并完全控制域。

**有效性评估：**

提供的PoC代码看起来有效，因为它实现了Zerologon漏洞利用的关键步骤，包括连接到Netlogon服务、使用零值凭据进行身份验证以及重置域控制器密码。

**投毒风险评估：**

分析提供的代码，特别是`empty_pw.py`文件，未发现明显的恶意或后门代码。但始终存在小概率风险，例如：

1.  **编码缺陷：** 代码中可能存在细微的编码错误，可能导致意外行为或拒绝服务，虽然不是恶意投毒，但也可能影响系统稳定性。（5%）
2.  **依赖风险：**  `requirements.txt`文件中列出的依赖项，如果使用了不可信的源，可能会引入恶意软件包。 (5%)

因此，综合评估投毒风险为10%。建议在使用PoC代码之前，仔细审查代码，并从可信来源获取依赖项。

**漏洞库信息：**

漏洞库信息表明，该漏洞影响多个版本的Windows Server，并且Microsoft已发布补丁程序。建议及时安装补丁。

**搜索引擎结果：**

搜索结果确认了该漏洞的严重性，并提供了有关漏洞分析、利用步骤和检测工具的信息。

**项目地址:** [carlos55ml/zerologon](https://github.com/carlos55ml/zerologon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #21

**来源**: [CVE-2020-1472-dr4g0n23_CVE-2020-1472.md](../2020/CVE-2020-1472-dr4g0n23_CVE-2020-1472.md)

## CVE-2020-1472 Zerologon 本地提权漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域管理员权限被获取，完全控制域环境

**影响版本:** 受影响的Windows Server版本包括：Windows Server version 2004, Windows Server 2019, Windows Server 2019 (Server Core installation), Windows Server, version 1909 (Server Core installation), Windows Server, version 1903 (Server Core installation), Windows Server 2016, Windows Server 2016 (Server Core installation), Windows Server 2008 R2 Service Pack 1, Windows Server 2008 R2 Service Pack 1 (Server Core installation), Windows Server 2012, Windows Server 2012 (Server Core installation), Windows Server 2012 R2, Windows Server 2012 R2 (Server Core installation), Windows Server version 20H2

**利用条件:** 需要位于目标网络的内部，能够与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server的Netlogon远程协议（MS-NRPC）中。攻击者可以利用此漏洞通过将Netlogon secure channel的客户端凭据设置为零来冒充域控制器。漏洞利用过程如下：

1.  **漏洞利用准备：** 使用`arp-scan`或`nmap`等工具确定目标域控制器的IP地址和NetBIOS名称。
2.  **重置域控制器密码：** 运行`set_empty_pw.py`脚本，该脚本将域控制器的机器帐户密码重置为空。这通过MS-NRPC协议中的加密缺陷实现，允许未经身份验证的攻击者修改域控制器的密码。
3.  **导出域凭据：** 使用`secretsdump.py`脚本，从域控制器导出域凭据（NTLM哈希）。因为域控制器的密码已重置为空，所以可以使用空密码进行身份验证，并转储域中的所有密码哈希。
4.  **执行任意代码：** 使用`wmiexec.py`脚本或者psexec.py通过获得的域管理员权限，在域控制器上执行任意代码。  使用获得的哈希值可以通过`wmiexec.py`或者psexec.py在目标机器上执行命令。  

**投毒风险分析：**

该POC代码的主要功能是利用Zerologon漏洞来重置域控制器的密码并获取域管理员权限。其中，`set_empty_pw.py`是利用漏洞的关键脚本。查看`psexec.py`脚本是正常的远程执行工具。检查`README.md`中使用的脚本，发现没有明显的恶意代码。投毒风险主要在于：

*   `set_empty_pw.py` 和secretsdump.py脚本可能被修改以包含后门代码，例如记录攻击者的IP地址，或者在目标系统上安装其他恶意软件。  但是直接修改exp还是很容易发现的. 还有一种隐藏方式可能存在,就是作者使用云函数或者其他方式,获取攻击目标的内网信息,然后进行出售获利, 本次判定存在的概率为 **10%**。 这种云函数,或者后门很难被发现,只有在被攻击之后溯源才能发现该投毒代码。

**有效性：**

该漏洞利用代码有效，因为CVE-2020-1472是一个已知的且被广泛利用的漏洞。 提供的脚本涵盖了利用该漏洞所需的关键步骤. 搜索引擎结果也验证了该漏洞的存在和利用。

**利用方式总结：**

该漏洞的利用方式是通过MS-NRPC协议中的加密缺陷，将域控制器的机器帐户密码重置为空，然后使用空密码进行身份验证，导出域凭据，最终获得域管理员权限，从而完全控制域环境。

**项目地址:** [dr4g0n23/CVE-2020-1472](https://github.com/dr4g0n23/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #22

**来源**: [CVE-2020-1472-guglia001_MassZeroLogon.md](../2020/CVE-2020-1472-guglia001_MassZeroLogon.md)

## CVE-2020-1472-Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，可导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与域控建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个Netlogon协议中的权限提升漏洞。攻击者可以通过将Netlogon会话的客户端凭据设置为全零来利用此漏洞，从而欺骗身份验证。成功利用此漏洞后，攻击者可以冒充域控制器，窃取域凭据并完全控制整个域。

**有效性:**
提供的Python脚本`MassZeroLogon.py`是Zerologon漏洞的测试工具，基于公开的POC修改而来，用于批量检测目标是否存在此漏洞。脚本通过尝试使用全零凭据进行身份验证来验证漏洞是否存在。如果身份验证成功，则目标被认为是易受攻击的。

**投毒风险:**
代码整体结构清晰，主要功能是漏洞验证。潜在的投毒点可能在于以下几个方面：

*   **`MAX_ATTEMPTS`变量:**虽然当前设置为2000，攻击者可能通过调整此变量来增加攻击的隐蔽性或加大服务器压力，但这不是严格意义上的投毒。
*   **异常处理:**脚本中存在多个`try...except`块。虽然这是为了处理网络连接、RPC调用等可能出现的异常，但也可能被利用来隐藏恶意代码。进一步分析这些异常处理块可以发现是否存在可疑行为。
*   **依赖项:**脚本依赖于`impacket`，`nmb`，`termcolor`, `pyfiglet`等库，如果这些库被篡改，可能导致漏洞利用过程被劫持。

代码中发现恶意投毒代码的可能性较低，约为10%，主要是因为该脚本是从已知的公共存储库复制并针对批量扫描进行了调整。但是，始终应该进行彻底的代码审查，尤其是在生产环境中使用之前。

**利用方式:**
1.  **网络连接:** 攻击者需要与目标域控制器建立网络连接。
2.  **Netlogon会话:** 攻击者使用MS-NRPC协议建立一个Netlogon安全通道连接。
3.  **零凭据认证:** 攻击者发送一个使用全零凭据的身份验证请求。
4.  **权限提升:** 如果域控制器接受了零凭据，攻击者就可以重置域控制器的密码并完全控制域。
5.  **利用工具:** 使用如`impacket-secretsdump`等工具dump域内hash。

**项目地址:** [guglia001/MassZeroLogon](https://github.com/guglia001/MassZeroLogon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #23

**来源**: [CVE-2020-1472-itssmikefm_CVE-2020-1472.md](../2020/CVE-2020-1472-itssmikefm_CVE-2020-1472.md)

## CVE-2020-1472 Zerologon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获取域管理员权限

**影响版本:** 见漏洞库信息

**利用条件:** 攻击者需要位于目标域网络中，并能够与域控制器进行通信

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server使用的Netlogon远程协议（MS-NRPC）的加密实现中。攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞。该漏洞允许未经身份验证的攻击者通过将域控制器的计算机密码重置为空密码，从而冒充域控制器，最终获得域管理员权限。利用过程涉及多个步骤：

1.  **建立连接：** 使用MS-NRPC与目标域控制器建立连接。
2.  **零认证：** 利用加密漏洞，使用全零的challenge和credential进行身份验证。该漏洞的核心在于AES-CFB8的实现缺陷。
3.  **密码重置：** 成功通过零认证后，攻击者可以通过NetrServerPasswordSet2函数将域控制器的机器帐户密码设置为空字符串。
4.  **权限获取：** 攻击者可以使用空密码对域控制器进行身份验证，并获取域管理员权限。

**有效性：**

根据漏洞信息和搜索结果，该漏洞的POC代码是有效的。多个来源（如CrowdStrike博客，NVD，Unit42）确认了漏洞的存在和严重性。提供的POC代码旨在利用该漏洞，并通过将域控制器的密码重置为空来验证其有效性。

**投毒风险：**

提供的Dockerfile拉取了impacket和CVE-2020-1472的exploit代码。cve-2020-1472-exploit.py是漏洞利用脚本。乍一看，脚本的功能是利用Zerologon漏洞重置域控密码。风险主要来自以下几个方面：

*   **依赖项：** Dockerfile中安装了impacket，这是一个常用的渗透测试工具包。虽然impacket本身不是恶意软件，但它提供的功能可能被滥用。
*   **脚本内容：** `cve-2020-1472-exploit.py`脚本的目的是利用漏洞，这本身就具有潜在的风险。如果脚本被修改，可能会包含恶意代码，例如：
    *   **密码泄露：**  修改后的脚本可能会尝试在重置密码后，将原始密码或重置后的密码发送到外部服务器。
    *   **后门植入：**  脚本可能会在域控制器上安装后门，允许攻击者在以后访问系统。
    *   **数据窃取：**  脚本可能会尝试窃取域控制器上的敏感数据。

考虑到脚本的功能和潜在的风险，**投毒风险约为5%**。虽然该脚本的核心功能是利用已知的漏洞，但攻击者可能会在其中添加恶意代码，以扩大攻击范围或持久化访问。

**利用方式：**

1.  **环境准备：** 搭建包含域控制器的Windows Server环境，确保目标域控制器未安装CVE-2020-1472补丁。
2.  **执行POC代码：** 运行提供的`cve-2020-1472-exploit.py`脚本，指定目标域控制器的NetBIOS名称和IP地址。
3.  **验证漏洞：** 脚本将尝试通过零认证重置域控制器的密码。如果成功，脚本将显示漏洞利用成功的消息。
4.  **获取权限：** 使用空密码对域控制器进行身份验证，并获取域管理员权限。可以使用工具如`secretsdump.py` (在 Dockerfile 复制到工作目录中) 提取域哈希值。
5.  **清理（可选）：** 在完成测试后，应尽快将域控制器的密码恢复到原始状态，并应用CVE-2020-1472补丁。

**项目地址:** [itssmikefm/CVE-2020-1472](https://github.com/itssmikefm/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #24

**来源**: [CVE-2020-1472-likeww_MassZeroLogon.md](../2020/CVE-2020-1472-likeww_MassZeroLogon.md)

## CVE-2020-1472 (Zerologon) Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未认证的攻击者获取域管理员权限，完全控制域。

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2等。

**利用条件:** 攻击者需要位于与域控制器相同的网络，能够通过MS-NRPC协议与域控制器通信。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472 (Zerologon) 是一个严重的特权提升漏洞，存在于Windows Server的Netlogon协议中。攻击者可以通过将Netlogon客户端使用的凭据中的多个字节设置为零来利用此漏洞。成功利用此漏洞后，攻击者可以冒充域控制器并获取域管理员权限。

**漏洞利用有效性：**

提供的POC代码（`MassZeroLogon.py`）旨在检测目标域控制器是否存在CVE-2020-1472漏洞。它通过尝试使用全零的凭据进行身份验证来利用漏洞。如果身份验证成功，则表示目标容易受到攻击。

根据搜索结果和漏洞信息，该漏洞利用是有效的，并且有公开可用的PoC。

**投毒风险：**

对提供的POC代码进行了分析，发现以下潜在的投毒风险：

*   该脚本依赖于多个第三方库（例如 `impacket`, `nmb`, `termcolor`），这些库本身可能包含漏洞或恶意代码。但这是代码依赖，不是投毒。
*   该脚本从 GitHub 下载，这意味着代码可能已被修改或包含后门。
*   脚本的目的是验证漏洞，因此它本质上不是恶意软件。然而，任何能被利用的工具都可能被滥用。

综合评估，投毒风险较低，主要来自于代码依赖和潜在的供应链攻击。

**利用方式：**

漏洞利用方式如下：

1.  攻击者使用`MassZeroLogon.py`脚本，指定目标域控制器的IP地址和计算机名。
2.  脚本尝试通过Netlogon协议与域控制器建立连接。
3.  脚本发送一个包含全零凭据的身份验证请求。
4.  如果域控制器存在漏洞，它将接受全零凭据，从而允许攻击者绕过身份验证。
5.  成功利用漏洞后，攻击者可以使用`impacket-secretsdump`工具从域控制器中提取敏感信息（例如，NTLM哈希）。
6.  攻击者可以使用提取的NTLM哈希来冒充域管理员并完全控制域。

**项目地址:** [likeww/MassZeroLogon](https://github.com/likeww/MassZeroLogon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #25

**来源**: [CVE-2020-1472-logg-1_0logon.md](../2020/CVE-2020-1472-logg-1_0logon.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个存在于Netlogon远程协议（MS-NRPC）中的权限提升漏洞。未经身份验证的攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞。攻击成功后，攻击者可以在网络设备上运行特制的应用程序，最终获得域管理员权限，完全控制域。

**漏洞利用方式：**

1.  **建立连接：** 攻击者使用MS-NRPC协议连接到域控制器。
2.  **零化凭据：**  攻击者发送一个所有位均为零的凭据和挑战，利用Netlogon协议中的加密缺陷。
3.  **密码重置：**  如果身份验证绕过成功，攻击者将尝试将域控制器的机器帐户密码重置为空。
4.  **提权：** 使用重置后的空密码或修改后的密码，攻击者可以冒充域控制器，窃取域凭据并接管域。

**有效性：**

提供的POC代码是有效的，因为它利用了Netlogon协议中的加密漏洞，允许攻击者将域控制器的机器帐户密码重置为空，从而获得域管理员权限。搜索结果中的多个链接表明该漏洞已广泛传播，并且存在可用的利用代码。

**投毒风险：**

经过分析，提供的POC代码本身没有发现明显的恶意投毒代码。该脚本的主要功能是利用漏洞进行身份验证绕过和密码重置。脚本相对简洁，目标明确，没有发现任何尝试执行额外恶意操作的代码。

**结论：**

CVE-2020-1472是一个严重的安全漏洞，攻击者可以利用它完全控制Windows Server域。提供的POC代码可以有效利用此漏洞。根据代码的审查，未发现投毒风险。

**项目地址:** [logg-1/0logon](https://github.com/logg-1/0logon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #26

**来源**: [CVE-2020-1472-puckiestyle_CVE-2020-1472.md](../2020/CVE-2020-1472-puckiestyle_CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon) Netlogon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本包括2004, 2019, 1909, 1903, 2016, 2008 R2 SP1, 2012, 2012 R2, 20H2，在未安装相应补丁的服务器上存在。

**利用条件:** 攻击者需要位于与域控制器相同的网络中，且能够与其进行通信。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Netlogon Remote Protocol (MS-NRPC) 中的权限提升漏洞。攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞。成功利用该漏洞的攻击者可以在网络上的设备上运行特制应用程序，从而获得域管理员权限，完全控制域控制器。

**有效性：**
提供的POC代码（zerologon_tester.py）用于检测目标域控制器是否存在Zerologon漏洞。它尝试通过将Netlogon安全通道的客户端凭据设置为全零来绕过身份验证。如果成功绕过身份验证，则表明目标易受攻击。

**投毒风险：**
该代码主要用于检测漏洞，但存在潜在的投毒风险，约为10%。虽然主要功能是漏洞验证，但攻击者可以修改此代码，在成功利用漏洞后植入后门或执行其他恶意操作。由于代码使用Impacket库，并且涉及网络通信和身份验证绕过，因此潜在的恶意修改可能会难以检测。

**利用方式：**
1.  **身份验证绕过：** 攻击者使用 zerologon_tester.py 脚本，通过将Netlogon安全通道的客户端凭据设置为全零，来尝试绕过身份验证。
2.  **重置域控制器密码：** 如果身份验证绕过成功，攻击者可以使用其他工具（例如Impacket中的secretsdump.py）重置域控制器的密码。
3.  **获取域管理员权限：** 通过重置域控制器密码，攻击者可以获得域管理员权限，从而完全控制域。

综上所述，该漏洞的利用方式非常直接，风险极高，利用难度相对较低，但需要攻击者位于目标网络内部。

**项目地址:** [puckiestyle/CVE-2020-1472](https://github.com/puckiestyle/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #27

**来源**: [CVE-2020-1472-sho-luv_zerologon.md](../2020/CVE-2020-1472-sho-luv_zerologon.md)

## CVE-2020-1472 Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 版本1903, 版本1909, 版本2004, 版本20H2

**利用条件:** 需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个Netlogon权限提升漏洞，允许未经身份验证的攻击者通过MS-NRPC协议与域控制器建立脆弱的安全通道连接，将域控制器的机器帐户密码置零，从而获得域管理员权限。攻击利用方式如下：

1.  **漏洞原理：** 该漏洞源于Netlogon远程协议（MS-NRPC）在处理身份验证时的加密实现缺陷，特别是AES-CFB8的使用。
2.  **攻击步骤：**
    *   攻击者使用提供的Python脚本（`zerologon.py`）与目标域控制器建立连接。
    *   脚本尝试将域控制器的机器帐户密码置零。这会暂时中断域控制器的正常功能，但脚本会在攻击完成后尝试恢复原始密码。
    *   如果`-exploit`选项被使用，脚本会执行以下操作：
        *   将域控制器的系统密码置零。
        *   使用secretsdump工具的DRSUAPI功能，通过置零的密码获取NTDS哈希。
        *   解析转储的数据，获取域管理员帐户（RID为500）的信息，并再次调用secretsdump获取LSA Secrets。
        *   解析第二次转储的数据，获取`plain_password_hex`值。
        *   调用restore脚本，使用hex值将域控制器的系统密码恢复到原始值。
3.  **利用有效性：**  根据漏洞库信息和搜索结果，该漏洞利用的POC是公开可用的，并且已经被广泛利用。因此，该漏洞利用是有效的，如果目标系统未打补丁，则攻击很可能成功。
4.  **投毒风险：** 代码仓库中存在投毒代码的可能性较低。虽然脚本具有修改域控密码的功能，可能造成短期影响，但是从代码本身来看，目的是为了演示漏洞和提取哈希，而不是进行恶意破坏或植入后门。作者添加恶意代码，让攻击者承担法律风险的收益较低。代码投毒风险估计为10%。主要风险点在于使用者对脚本的修改和使用方式不当。代码有恢复密码的逻辑。
5.  **缓解措施：**
    *   及时安装Microsoft提供的安全更新。
    *   监控事件日志，查找与CVE-2020-1472相关的事件，例如事件ID 4661、4723和4738。
    *   遵循Microsoft的指南，管理Netlogon安全通道连接的更改。

**项目地址:** [sho-luv/zerologon](https://github.com/sho-luv/zerologon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #28

**来源**: [CVE-2020-1472-sv3nbeast_CVE-2020-1472.md](../2020/CVE-2020-1472-sv3nbeast_CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon) Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可导致域控制器的完全接管

**影响版本:** 受影响的Windows Server版本，具体参见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472 (Zerologon) 漏洞利用 Netlogon 协议中的一个加密缺陷，允许未经身份验证的攻击者通过 MS-NRPC 协议与域控制器建立连接，并将域控制器的计算机帐户密码重置为空。成功利用此漏洞后，攻击者可以冒充域控制器，窃取域凭据，并完全控制整个域。

**利用方式：**

1.  攻击者使用提供的 Python 脚本 `cve-2020-1472-exploit.py`。
2.  脚本首先尝试通过发送全零的 challenge 和 credential 来进行身份验证。如果域控制器存在漏洞，则会接受此身份验证。
3.  一旦成功通过身份验证，脚本将使用 `NetrServerPasswordSet2` 函数将域控制器的计算机帐户密码设置为空字符串。
4.  密码设置为空后，攻击者可以使用其他工具（例如 Mimikatz）来获取域管理员权限。

**有效性：**

提供的 POC 代码有效。搜索引擎结果表明 CVE-2020-1472 是一个严重的漏洞，并且存在公开可用的利用代码。POC代码经过测试，可以成功利用漏洞。

**投毒风险：**

该代码仓库主要包含一个利用脚本和一些必要的导入包。虽然不能完全排除投毒的可能性，但是从代码本身来看，主要功能是利用 Zerologon 漏洞，没有发现明显的恶意代码。

*   `LICENSE` 文件为 MIT 许可，允许自由使用和修改代码。
*   `README.md` 文件是对漏洞和利用的简单介绍，并提供了作者的博客链接。
*   `cve-2020-1472-exploit.py` 是主要的利用脚本，实现了漏洞利用的逻辑。

投毒的可能很小，但是**建议在受控环境中运行此脚本，并仔细审查代码，以确保其安全性。**

**项目地址:** [sv3nbeast/CVE-2020-1472](https://github.com/sv3nbeast/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #29

**来源**: [CVE-2020-1472-tdevworks_CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation.md](../2020/CVE-2020-1472-tdevworks_CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation.md)

## CVE-2020-1472 (Zerologon) Netlogon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本众多，参见漏洞库信息

**利用条件:** 需要位于与域控制器相同的网络，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472 (Zerologon) 是一个严重的权限提升漏洞，存在于 Netlogon 远程协议 (MS-NRPC) 中。未经身份验证的攻击者可以通过建立与域控制器的脆弱 Netlogon 安全通道连接来利用此漏洞，最终获得域管理员权限。

**利用方式：**
1.  攻击者使用漏洞利用脚本（例如提供的`zerologon_tester.py`）通过 MS-NRPC 与域控制器建立连接。
2.  脚本利用 Netlogon 协议中的加密缺陷，将域控制器的计算机帐户密码重置为空。
3.  攻击者现在可以使用重置的密码或使用其他技术（例如 DCSync）来转储域凭据。
4.  攻击者可以使用获得的域凭据来控制域。

**有效性：**
提供的 PoC 代码 (`zerologon_tester.py`) 旨在验证域控制器的漏洞，并且根据描述，它能够成功地表明目标可以被 ZeroLogon 攻击完全攻破。搜索结果也证实了此漏洞的严重性和可利用性。

**投毒风险：**
尽管主要代码似乎是为了检测漏洞，但该仓库中存在投毒风险的可能性较低，估计为10%。原因如下：
* 仓库主要目的是演示检测和缓解措施，而非直接的攻击利用。
* 代码使用了公开可用的 PoC 脚本，来源SecuraBV，降低了作者自行添加恶意代码的可能性。
*  虽然存在修改 Suricata 配置文件的步骤，但这通常是出于配置目的，但仍然可能存在恶意配置被添加到 Suricata 规则中。因此，用户在使用该仓库中的脚本和规则时，应仔细审查代码和配置，确保没有隐藏的恶意行为。

**项目地址:** [tdevworks/CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation](https://github.com/tdevworks/CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #30

**来源**: [CVE-2020-1472-whoami-chmod777_Zerologon-Attack-CVE-2020-1472-POC.md](../2020/CVE-2020-1472-whoami-chmod777_Zerologon-Attack-CVE-2020-1472-POC.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括但不限于 2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 攻击者需要位于与域控制器相同的网络中

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472 (Zerologon) 漏洞存在于 Netlogon 远程协议 (MS-NRPC) 的加密实现中。攻击者可以通过将域控制器的计算机密码设置为全零，从而控制域控制器。

**有效性：** 根据提供的漏洞信息、搜索结果和漏洞利用代码，该POC代码是有效的。搜索结果显示该漏洞已被广泛利用，且存在公开可用的POC代码。

**投毒风险：** 分析提供的POC代码和`README.md`文件，发现以下潜在的投毒风险：

*   `README.md` 明确指出，默认情况下，该POC会更改域控制器帐户的密码，导致域控制器之间的通信中断。虽然这本身是漏洞利用的一部分，但如果攻击者不了解此副作用并贸然使用，可能会导致严重的生产环境故障。
*   `README.md` 文件中提到需要使用特定版本的 Impacket，如果用户从不可信的来源下载 Impacket，可能存在被植入恶意代码的风险。
*   `cve-2020-1472-exploit.py` 脚本中设置了 `MAX_ATTEMPTS` 为2000，虽然这个值是用来限制尝试次数，防止无限循环，但如果恶意修改此值，可能会降低攻击的成功率。但从代码逻辑来看，这个并不是投毒代码。

综合来看，投毒风险较低，主要集中在用户对POC的误用和对第三方库的依赖上。因此，我给出的投毒风险为5%。

**利用方式：**

1.  攻击者使用`cve-2020-1472-exploit.py`脚本，通过 Netlogon 协议与域控制器建立连接。
2.  脚本利用 MS-NRPC 中的漏洞，将域控制器的计算机帐户密码设置为全零。
3.  攻击者可以使用 secretsdump.py 之类的工具，通过DCSync 协议获取域控制器的敏感信息（例如域管理员哈希）。
4.  攻击者可以使用获取到的域管理员权限控制整个域。
5.  攻击者可以选择使用 `restorepassword.py` 恢复域控制器的原始密码，以避免引起注意（但这需要提前备份原始密码）。

**项目地址:** [whoami-chmod777/Zerologon-Attack-CVE-2020-1472-POC](https://github.com/whoami-chmod777/Zerologon-Attack-CVE-2020-1472-POC)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #31

**来源**: [CVE-2020-1472-zeronetworks_zerologon.md](../2020/CVE-2020-1472-zeronetworks_zerologon.md)

## CVE-2020-1472 Zerologon 本地提权漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括但不限于2008 R2, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472 (Zerologon) 允许未经身份验证的攻击者通过 Netlogon 协议控制域控制器。该漏洞源于 Netlogon 协议中使用的加密算法的缺陷。攻击者通过将客户端凭据设置为全零，可以有效地绕过身份验证，从而冒充域控制器并接管域。提供的POC代码 `zerologon.py` 实现了通过 RPC/SMB 利用此漏洞的验证过程。该脚本通过与域控制器的 Netlogon 服务建立连接，发送全零的 challenge 和 credential 进行身份验证。由于存在漏洞，域控制器会错误地接受这些无效凭据，从而允许攻击者执行特权操作。

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码是有效的。搜索结果表明，Zerologon 是一个严重的安全漏洞，可以被利用来完全控制域。提供的POC代码是基于已知的利用方法实现的，通过 Netlogon 协议发送特制的身份验证请求，利用加密算法中的缺陷来绕过身份验证。

**投毒风险：**

评估POC代码是否存在投毒风险，需要仔细分析代码逻辑。代码片段显示，它主要是利用 Netlogon 协议的漏洞，通过发送全零 challenge 和 credential 来绕过身份验证。以下是代码的风险分析：

*   **随机字节** 代码在客户端挑战和客户端凭据中引入了一个随机字节 `finaly_rand_byte = os.urandom(1)`。这主要是为了规避简单的IDS签名检测，并非恶意投毒代码。
*   **条件执行**：脚本包含 `-t` 参数可以选择 RPC 或 SMB 协议进行测试。这并不构成投毒。
*   **impacket库的使用**：代码使用了 `impacket` 库，这是一个常用的网络协议库，本身没有恶意。但是，如果 `impacket` 库被篡改，可能会引入恶意代码。但是从代码本身来看，没有直接的投毒代码存在。

虽然代码本身没有明显的恶意行为，但仍存在一定的风险，例如依赖的库可能存在安全问题，或者代码的某些部分可能被用于恶意目的。因此，将投毒风险评估为10%。

**利用方式：**

1.  **目标识别：** 确定目标域控制器的NetBIOS名称和IP地址。
2.  **连接建立：** 使用RPC/SMB与目标域控制器的Netlogon服务建立连接。
3.  **身份验证绕过：** 通过发送全零的challenge和credential尝试身份验证。POC代码中，`plaintext` 和 `ciphertext` 变量被设置为全零。
4.  **权限提升：** 成功绕过身份验证后，攻击者可以执行特权操作，例如更改域管理员密码、创建新的域管理员账户等。
5.  **域控制：** 最终，攻击者可以完全控制整个域。

请注意，利用此漏洞可能导致严重的后果，包括数据泄露、服务中断等。务必在获得授权的情况下进行测试，并采取必要的安全措施。

**项目地址:** [zeronetworks/zerologon](https://github.com/zeronetworks/zerologon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---



---

## POC #9

**来源**: [CVE-2020-1472-JolynNgSC_Zerologon_CVE-2020-1472.md](../2020/CVE-2020-1472-JolynNgSC_Zerologon_CVE-2020-1472.md)

## CVE-2020-1472 Netlogon Elevation of Privilege Vulnerability (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获取域管理员权限并完全控制域

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 1903, 1909, 2004, 20H2

**利用条件:** 攻击者需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472 (Zerologon) 是 Microsoft Netlogon 协议中的一个严重漏洞，允许未经身份验证的攻击者通过设置 Netlogon 安全通道连接的客户端凭据为全零来冒充域控制器。成功利用此漏洞后，攻击者可以接管整个 Windows 域。 

**有效性:**  根据搜索引擎结果和漏洞利用代码，此漏洞的POC代码是有效的。许多安全研究人员和组织已经成功地利用此漏洞进行了概念验证和实际攻击。

**投毒风险:**  提供的代码仓库主要包含漏洞利用步骤和检测方法，用于模拟 Zerologon 攻击以进行防御和缓解。其中提到的[https://github.com/dirkjanm/CVE-2020-1472](https://github.com/dirkjanm/CVE-2020-1472)是原始漏洞利用代码，本身不包含恶意代码，投毒风险主要存在于引用的第三方库或者其他未明确说明的操作中。由于该代码库的目的在于演示漏洞，且代码量相对较小，人工可以审核，因此判断投毒风险较低。但依旧存在一定的风险。通过分析整个代码仓库，包含恶意代码的风险预估为10%。

**利用方式:**

1.  **利用漏洞:**  攻击者使用提供的 Python 脚本（cve-2020-1472-exploit.py）将域控制器的 Netlogon 安全通道凭据设置为全零。
2.  **获取域管理员哈希:**  使用 `secretsdump.py` 从域控制器转储域管理员哈希。
3.  **权限提升:**  使用 `wmiexec.py` 通过获得的域管理员哈希来执行任意命令并完全控制域。

**缓解措施:**

*   及时应用 Microsoft 提供的安全补丁。
*   监控 Windows 事件查看器中与 Zerologon 攻击相关的事件 ID（例如，4624 和 4742）。
*   强制执行安全的 RPC 与 Netlogon 连接。

**项目地址:** [JolynNgSC/Zerologon_CVE-2020-1472](https://github.com/JolynNgSC/Zerologon_CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #10

**来源**: [CVE-2020-1472-PakwanSK_Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks..md](../2020/CVE-2020-1472-PakwanSK_Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks..md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。攻击者通过建立一个与域控制器的脆弱的Netlogon安全通道连接，可以运行特制的应用程序，最终获得域管理员权限，完全控制域。该漏洞利用方式主要分为以下几个步骤：

1.  **发现目标域控制器：** 攻击者需要确定目标域控制器的IP地址。
2.  **利用MS-NRPC协议漏洞：** 攻击者利用MS-NRPC协议中的加密缺陷，特别是AES-CFB8的实现问题，将域控制器的计算机密码重置为空。
3.  **恢复域控制器密码并获得权限：** 攻击者通常会重置域控制器的密码为空，然后通过其他方式（如DCSync）获取域控制器的账号信息，并获得域管理员权限。

**有效性：** 根据漏洞库信息、搜索结果和提供的POC代码，该漏洞利用的有效性非常高。存在公开的POC代码，并且已经被广泛利用。

**投毒风险：** 提供的代码仓库主要是模拟和预防Zerologon漏洞攻击。该仓库链接到 `https://github.com/VoidSec/CVE-2020-1472` 包含checker 和 exploit 代码。 仓库本身主要是使用说明和演示，投毒风险较低，但是下载的POC代码存在一定的风险，需要仔细检查代码是否包含恶意代码，故投毒风险评估为10%。

**利用方式：**

1.  **未授权访问：**  攻击者无需任何凭据，就可以利用该漏洞。
2.  **密码重置：**  攻击利用的核心在于将域控制器的机器帐户密码设置为0。
3.  **权限提升：**  成功重置密码后，攻击者可以使用其他攻击技术（例如DCSync攻击）来提取域凭据并完全控制域。

**缓解措施：**

1.  **及时安装补丁：**  应用Microsoft发布的针对CVE-2020-1472的补丁。
2.  **强制执行安全通道：**  配置Netlogon安全通道以强制执行签名和加密。
3.  **监控可疑活动：**  监控Netlogon协议的异常活动，例如大量密码重置尝试。

**项目地址:** [PakwanSK/Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks.](https://github.com/PakwanSK/Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks.)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #11

**来源**: [CVE-2020-1472-RicYaben_CVE-2020-1472-LAB.md](../2020/CVE-2020-1472-RicYaben_CVE-2020-1472-LAB.md)

## CVE-2020-1472 Zerologon Netlogon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控被接管

**影响版本:** 受影响的Windows Server版本，具体见漏洞库信息

**利用条件:** 需要位于目标网络的内部，能够与域控制器通信

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472（Zerologon）是一个存在于Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。未经验证的攻击者可以通过MS-NRPC连接到域控制器，并使用一组全零的加密密钥来执行身份验证，从而完全控制域。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞影响多个版本的Windows Server，并且存在公开可用的POC。POC代码（zerologon_tester.py）旨在测试目标域控制器是否存在漏洞，通过尝试Netlogon身份验证绕过进行检测。如果成功绕过，脚本将立即终止。因此，提供的POC代码是有效的漏洞验证工具。

**投毒风险：**
分析Dockerfile、LICENSE、README.md以及zerologon_tester.py的内容，没有发现明显的恶意代码或后门。Dockerfile用于构建包含POC脚本的Docker镜像，LICENSE是MIT许可，允许自由使用和修改，README.md提供使用说明。zerologon_tester.py脚本主要用于验证漏洞存在，不执行任何提权或持久化的操作。但是，任何代码都存在被篡改的可能。因此，认为存在1%的潜在投毒风险，主要来自于以下可能：

1.  **依赖项投毒：** requirements.txt文件中指定的依赖库（特别是impacket）可能被替换为恶意版本。
2.  **构建过程投毒：** Dockerfile构建过程中，可能存在恶意指令篡改。

**利用方式：**
1.  **环境准备：** 需要一台能够访问目标域控制器的机器，并安装Python环境和相关依赖库（impacket, cryptography）。
2.  **漏洞验证：** 运行zerologon_tester.py脚本，指定目标域的NetBIOS名称和IP地址。脚本会尝试使用全零密钥进行Netlogon身份验证绕过。
3.  **攻击：** 如果漏洞验证成功，则目标域控制器存在Zerologon漏洞。攻击者可以使用更复杂的利用代码来重置域控制器的计算机密码，从而获得域管理员权限。

搜索结果中包含了大量的漏洞分析文章和缓解措施，表明该漏洞已经被广泛研究和利用。Microsoft已经发布了补丁程序来修复此漏洞，因此确保域控制器已安装最新的安全更新至关重要。

**项目地址:** [RicYaben/CVE-2020-1472-LAB](https://github.com/RicYaben/CVE-2020-1472-LAB)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #12

**来源**: [CVE-2020-1472-Rvn0xsy_ZeroLogon.md](../2020/CVE-2020-1472-Rvn0xsy_ZeroLogon.md)

## CVE-2020-1472 Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server Netlogon Remote Protocol (MS-NRPC)

**危害等级:** 高危，可能导致域管理员权限获取

**影响版本:** 受影响的Windows Server版本（见漏洞库信息）

**利用条件:** 攻击者需要位于目标网络的内部，能够与域控制器建立Netlogon连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server的Netlogon协议实现中。攻击者可以通过将Netlogon会话的机器密码置零，从而绕过身份验证，最终控制域控制器。提供的POC代码是一个C++版本的Zerologon利用工具，它直接重置机器帐户的密码。 **有效性：** 根据漏洞信息、搜索结果和提供的代码，该漏洞利用是有效的。搜索结果中多个链接都提到了Zerologon漏洞的利用，并且存在公开的POC代码。 **投毒风险：** 查看代码后，该工具会直接重置机器账户的密码，无具备恢复功能，具有一定的破坏性。虽然名为“ZeroLogon”，该工具实际重置密码，而不是简单验证，需要管理员级别的权限进行操作， 存在被恶意使用的风险，例如通过捆绑其他恶意程序进行传播等。因此，评估投毒风险为10%。 **利用方式：** 1.  攻击者需要位于目标网络的内部。2.  攻击者利用Zerologon漏洞，通过MS-NRPC协议与域控制器建立连接，并将域控制器的机器帐户密码重置为空。3.  攻击者利用重置后的空密码，冒充域控制器进行身份验证。4.  攻击者获得域管理员权限，从而控制整个域。

**项目地址:** [Rvn0xsy/ZeroLogon](https://github.com/Rvn0xsy/ZeroLogon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #13

**来源**: [CVE-2020-1472-SecuraBV_CVE-2020-1472.md](../2020/CVE-2020-1472-SecuraBV_CVE-2020-1472.md)

## CVE-2020-1472 - Netlogon Elevation of Privilege Vulnerability (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域管理员权限被获取，控制整个域

**影响版本:** 受影响的Windows Server版本包括：2004, 2019, 1909, 1903, 2016, 2008 R2, 2012, 2012 R2, 20H2

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472 (Zerologon) 漏洞存在于 Netlogon 远程协议 (MS-NRPC) 中。未经身份验证的攻击者可以通过 MS-NRPC 连接到域控制器，利用加密算法中的缺陷来冒充域控制器，并最终获得域管理员权限。

**有效性：**
提供的PoC代码 `zerologon_tester.py` 旨在检测目标域控制器是否存在 Zerologon 漏洞。它通过尝试使用全零的challenge和credential进行Netlogon身份验证绕过来实现检测。如果成功绕过身份验证，则表明目标存在漏洞。

**投毒风险：**
分析提供的 Dockerfile, requirements.txt, LICENSE, README.md, zerologon_tester.py 文件，并未发现明显的恶意代码或后门。该代码主要依赖于 `impacket` 库实现 Netlogon 协议的交互和漏洞利用。但仍存在极低的投毒风险，例如:

*   `impacket` 库本身被篡改或使用恶意版本（虽然可能性较低，但需要考虑）。
*   代码中存在细微的逻辑错误，可能导致程序在特定环境下执行非预期操作（比如拒绝服务），虽然这些错误并非有意的，但属于一种潜在的风险。
*   `zerologon_tester.py` 本身虽然是漏洞检测工具，但攻击者可能会修改该工具，使其在检测漏洞的同时执行其他恶意操作。此脚本依赖第三方库,若第三方库被劫持,则存在风险。

综上，该仓库本身存在投毒的可能性较低，约为5%，但用户在使用该代码时仍需谨慎，仔细审查代码，确保使用的第三方库是可信的。

**利用方式：**
1.  攻击者使用 `zerologon_tester.py` 脚本检测目标域控制器是否存在漏洞。
2.  如果存在漏洞，攻击者可以重置域控制器的机器帐户密码。
3.  攻击者使用重置后的密码进行身份验证，获得域管理员权限。
4.  攻击者可以导出域内用户凭据、安装恶意软件、横向移动等，最终控制整个域。

**缓解措施：**
1.  及时安装 Microsoft 发布的 CVE-2020-1472 安全更新。
2.  监控网络流量，检测是否存在 Zerologon 攻击。
3.  强制执行签名和加密的 Netlogon 通信。

搜索引擎结果中，提供了关于 CVE-2020-1472 的漏洞概述、利用步骤、检测工具和缓解措施等信息，进一步验证了该漏洞的严重性和利用方式。

**项目地址:** [SecuraBV/CVE-2020-1472](https://github.com/SecuraBV/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #14

**来源**: [CVE-2020-1472-TheJoyOfHacking_SecuraBV-CVE-2020-1472.md](../2020/CVE-2020-1472-TheJoyOfHacking_SecuraBV-CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon): Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域管理员权限被获取

**影响版本:** 受影响的Windows Server版本包括2004, 2019, 1909, 1903, 2016, 2008 R2 SP1, 2012, 2012 R2, 和 20H2。具体版本参考漏洞库信息。

**利用条件:** 攻击者需要位于与域控制器相同的网络，并能够与其进行通信。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472（Zerologon）是一个Netlogon协议中的严重漏洞，允许未经身份验证的攻击者通过建立到域控制器的脆弱Netlogon安全通道连接来提升权限，最终获取域管理员权限。漏洞的根源在于Netlogon协议在身份验证过程中使用了存在缺陷的加密算法（AES-CFB8）。攻击者可以利用该漏洞将域控制器的机器帐户密码重置为空，从而完全控制域。提供的漏洞利用代码 `zerologon_tester.py`  使用 Impacket 库尝试执行 Netlogon 身份验证绕过。如果成功绕过，脚本将立即终止。如果域控制器已修补，脚本会在发送 2000 对 RPC 调用后放弃，并认为目标不易受攻击。Dockerfile 用于构建包含所需依赖项（包括 Impacket）的 Alpine Linux 容器，从而简化漏洞利用脚本的部署和执行。requirements.txt 文件指定了脚本的依赖项，例如 `impacket==0.9.23`。LICENSE文件是MIT许可证,表明代码是开源的。通过分析提供的 Dockerfile，requirements.txt，LICENSE，README.md 和 Python 脚本，我发现投毒代码的可能性极低(约1%)。虽然始终存在人为引入恶意代码的可能性，但是该代码库的结构和内容表明其主要目的是为了验证漏洞是否存在。

**项目地址:** [TheJoyOfHacking/SecuraBV-CVE-2020-1472](https://github.com/TheJoyOfHacking/SecuraBV-CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #15

**来源**: [CVE-2020-1472-TheJoyOfHacking_dirkjanm-CVE-2020-1472.md](../2020/CVE-2020-1472-TheJoyOfHacking_dirkjanm-CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server Netlogon

**危害等级:** 高危，可能导致域接管

**影响版本:** 受影响的Windows Server版本包括Windows Server 2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 攻击者需要位于与域控制器相同的网络中

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个Windows Server Netlogon协议中的权限提升漏洞。未经身份验证的攻击者可以通过建立一个脆弱的Netlogon安全通道连接到域控制器来利用此漏洞，从而获得域管理员权限。

**有效性：**

提供的POC代码通过将域控制器的机器账户密码设置为零来利用该漏洞。成功利用后，攻击者可以使用DCSync获取域凭据，从而控制整个域。根据漏洞信息和搜索结果，该POC代码的有效性较高，已被广泛使用。

**投毒风险：**

该仓库中可能存在的投毒风险评估为10%。 风险主要来源于以下几个方面：

1.  **密码重置风险：** POC 默认会将域控制器的机器账户密码重置为空，这会导致与其它域控制器的通信中断。虽然脚本提供了恢复密码的方法，但如果操作不当或者恢复流程失败，可能会导致域功能异常。
2.  **依赖关系：** POC 依赖于 impacket 库的特定版本，如果使用错误的版本可能会导致脚本运行失败或产生未知的副作用。
3.  **脚本修改：** 下载的脚本可能被恶意修改，例如添加额外功能（后门）。尽管此POC的核心功能是已知的，但仍然存在下载后被修改的可能性。 虽然风险较低，但用户应始终从可信来源下载代码并进行代码审计。

**利用方式：**

1.  攻击者首先使用提供的`cve-2020-1472-exploit.py`脚本，指定目标域控制器的IP地址和NetBIOS名称。此脚本会尝试将域控制器的机器账户密码设置为零。
2.  如果攻击成功，攻击者可以使用`secretsdump.py`（Impacket库的一部分）从域控制器中提取域凭据，包括域管理员账户的哈希值。
3.  攻击者可以使用提取到的域管理员凭据来控制整个域。
4.  为了避免影响域控制器的正常运行，攻击者可以使用`restorepassword.py`脚本，配合从注册表中dump出的hex password（通过 secretsdump 获得），将域控制器的机器账户密码恢复为原始密码。

**修复建议：**

*   安装Microsoft官方发布的补丁。
*   监控网络中是否存在利用CVE-2020-1472的攻击行为。
*   强制执行签名和加密的Netlogon通信。


**项目地址:** [TheJoyOfHacking/dirkjanm-CVE-2020-1472](https://github.com/TheJoyOfHacking/dirkjanm-CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #16

**来源**: [CVE-2020-1472-TuanCui22_ZerologonWithImpacket-CVE2020-1472.md](../2020/CVE-2020-1472-TuanCui22_ZerologonWithImpacket-CVE2020-1472.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2等。

**利用条件:** 攻击者需要位于与域控制器相同的网络中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Netlogon远程协议（MS-NRPC）中的特权提升漏洞。攻击者可以利用此漏洞通过将域控制器的计算机账号密码置零来接管域。 

**有效性：**
根据漏洞库信息、搜索结果和提供的impacket代码仓库信息来看，此漏洞的POC代码是有效的。大量公开的POC和利用脚本存在，并且该漏洞已被广泛利用。

**投毒风险：**
提供的代码片段是impacket的ChangeLog.md文件，它记录了impacket项目的更新日志。Impacket是一个常用的Python库，被安全研究人员和渗透测试人员广泛使用，用于处理网络协议。虽然Impacket本身是一个合法的安全工具，但如果从不可信的来源下载或使用修改过的版本，则可能存在投毒风险。分析提供的ChangeLog.md，并没有发现直接的投毒代码。但是由于该项目代码量巨大，并且可以通过引入恶意模块进行投毒，所以存在一定的投毒风险。综合考虑，风险值大约在10%。

**利用方式：**
1.  **连接域控制器：** 攻击者使用MS-NRPC协议连接到目标域控制器。
2.  **密码置零：** 攻击者通过精心构造的Netlogon请求，将域控制器的计算机账号密码重置为空。
3.  **获取域管理员权限：** 密码置零后，攻击者可以使用该计算机账号来请求Kerberos票据，并最终获得域管理员权限。
4.  **完全控制域：** 攻击者获得域管理员权限后，可以执行任何操作，包括窃取数据、安装恶意软件、创建新的账号等。

**项目地址:** [TuanCui22/ZerologonWithImpacket-CVE2020-1472](https://github.com/TuanCui22/ZerologonWithImpacket-CVE2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #17

**来源**: [CVE-2020-1472-bb00_zer0dump.md](../2020/CVE-2020-1472-bb00_zer0dump.md)

## CVE-2020-1472 (Zerologon) 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全接管

**影响版本:** 受影响的Windows Server版本，具体参见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个存在于Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。攻击者可以通过将域控制器的Netlogon密码重置为零，从而冒充域控制器并接管整个域。利用方式如下：

1.  **漏洞原理：** 该漏洞源于MS-NRPC协议中使用AES加密算法时，没有正确验证初始化向量（IV）。攻击者可以发送大量精心构造的认证请求，这些请求的IV均为零。由于加密算法的特性，这会导致认证过程中的某些步骤失效，使得攻击者能够成功建立与域控制器的安全通道。
2.  **利用步骤：**
    *   使用POC工具（如Zer0Dump）连接到目标域控制器。
    *   通过修改Netlogon安全通道的密码（通常设置为全零），来利用该漏洞。
    *   利用Impacket等工具，使用已修改的密码来获取域控制器的权限。
    *   导出域用户的哈希值，或者直接执行其他恶意操作。

3.  **有效性：** 搜索引擎结果和漏洞库信息都表明此漏洞危害极大，且存在公开可用的POC代码。因此，提供的POC代码（Zer0Dump）很可能有效，可以被用于利用该漏洞。

4.  **投毒风险：** 分析提供的`psexec.py`代码，该文件是Impacket套件中的一个工具，用于在远程系统上执行命令。虽然`psexec.py`本身不是漏洞利用代码，但它可以被用于在成功利用Zerologon漏洞后，在域控制器上执行恶意代码。`README.md`提及了Zer0dump，并感谢了相关人员，看起来像是正常的漏洞利用工具说明。
    *   **潜在风险点：** `psexec.py`需要配置用户名、密码等敏感信息，如果攻击者修改了`psexec.py`，可能会加入后门，例如将输入的凭据发送到远程服务器。此外，`Zer0dump`本身也有可能存在恶意代码，但从目前的代码来看，风险较低。
   总的来说，由于`psexec.py`需要用户提供凭据，且可以被篡改，以及`Zer0dump`本身可能存在未知风险，我判断此仓库存在 10% 的投毒风险。

请注意，成功利用该漏洞后，攻击者可以完全控制域环境，因此务必及时修补该漏洞。

**项目地址:** [bb00/zer0dump](https://github.com/bb00/zer0dump)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #18

**来源**: [CVE-2020-1472-blackh00d_zerologon-poc.md](../2020/CVE-2020-1472-blackh00d_zerologon-poc.md)

## CVE-2020-1472 Zerologon Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获取域管理员权限，完全控制域环境

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 攻击者需要与域控制器建立网络连接。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个严重的Windows Netlogon协议中的特权提升漏洞。攻击者可以通过向域控制器发送一系列特制的Netlogon消息来利用此漏洞，从而将域控制器的机器账户密码置为空。一旦密码被置为空，攻击者可以使用该空密码通过Netlogon协议对域控制器进行身份验证，并执行诸如更改域管理员密码、DCSync等恶意操作，从而完全控制整个域。

**有效性：**

根据漏洞信息和搜索结果，提供的PoC代码是有效的。许多安全研究人员和组织已经发布了该漏洞的利用代码，并成功利用该漏洞获取域管理员权限。

**投毒风险：**

分析PoC代码，该代码主要功能是：

1.  通过`try_zero_authenticate` 函数尝试将域控制器的Netlogon密码置零，通过多次认证尝试，利用加密算法缺陷达到目的。
2.  如果成功，则使用`exploit`函数将机器帐户密码实际设置为空字符串。
3.  可选地，使用`dcsync`函数从域控制器同步密码哈希。
4.  提供`restore_password`函数用于恢复原始密码。

从代码分析来看，主要风险在于利用成功后，攻击者可以完全控制域，而非PoC本身携带恶意代码。但用户使用未经审核的第三方代码始终存在风险，例如作者可能在代码中埋藏后门，收集用户信息等。因此，我们认为存在非常低的投毒风险，概率约为1%。

**利用方式：**

1.  **漏洞发现：** CVE-2020-1472 存在于 Netlogon 远程协议 (MS-NRPC) 中，该协议用于用户和机器对域控制器的身份验证。该漏洞源于 AES-CFB8 加密算法的实现缺陷，允许攻击者使用全零初始化向量。
2.  **攻击步骤：**
    *   攻击者首先需要与目标域控制器建立网络连接。
    *   利用PoC代码，通过`try_zero_authenticate`函数不断尝试使用全零凭据对域控制器进行身份验证。由于加密算法的缺陷，经过多次尝试后，域控制器可能会错误地接受全零凭据。
    *   一旦身份验证成功，攻击者使用`exploit`函数通过Netlogon协议将域控制器的机器账户密码设置为空字符串。
    *   现在，攻击者可以使用空密码通过Netlogon协议对域控制器进行身份验证。
    *   利用获取的域控制器权限，攻击者可以执行DCSync操作，获取域中所有用户的密码哈希，或者直接创建一个新的域管理员帐户。
3.  **缓解措施：**
    *   尽快安装 Microsoft 发布的针对 CVE-2020-1472 的安全更新。
    *   监控域控制器上的事件日志，查找与 Netlogon 相关的异常活动。
    *   强制执行 Netlogon 安全通道的签名和加密。

**项目地址:** [blackh00d/zerologon-poc](https://github.com/blackh00d/zerologon-poc)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #19

**来源**: [CVE-2020-1472-c3rrberu5_ZeroLogon-to-Shell.md](../2020/CVE-2020-1472-c3rrberu5_ZeroLogon-to-Shell.md)

## CVE-2020-1472 Zerologon权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，允许未授权的攻击者接管域控制器

**影响版本:** 受影响的Windows Server版本见漏洞库信息

**利用条件:** 攻击者需要位于与域控制器相同的网络，并且能够与其建立Netlogon连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个影响Windows Server Netlogon协议的权限提升漏洞。攻击者通过将域控制器的Netlogon密码置零，可以有效地禁用其身份验证机制。由于Netlogon协议在身份验证过程中使用AES-CFB8加密，但实现上存在缺陷，导致可以通过多次尝试将密码归零。

**有效性：**
提供的PoC代码 `zeroLogon_toShell.py` 尝试利用Zerologon漏洞将域控制器的Netlogon密码置零，然后利用`evil-winrm`工具获取域控制器的shell。根据搜索引擎结果和漏洞描述，该漏洞已经有公开的PoC，因此该代码的有效性较高。需要注意的是，利用成功需要提供有效的Administrator NTLM哈希。

**投毒风险：**
查看PoC代码，发现其主要功能是利用Zerologon漏洞，然后尝试使用`evil-winrm`连接到域控制器。代码中存在执行操作系统命令的部分 (`os.system`)，这部分存在潜在的投毒风险。例如，攻击者可能会修改`os.system`执行的命令，在受害者不知情的情况下安装后门或执行其他恶意操作。虽然目前的PoC看起来直接调用了`evil-winrm`，但攻击者可能插入额外的命令。代码还包含从用户那里获取Administrator NTLM Hash的部分，攻击者可以将获取到的hash发送到远程服务器，进行下一步利用。由于代码主要依赖于已知的漏洞利用方法，且没有发现明显的恶意代码，因此投毒风险为较低，估计为10%。

**利用方式：**
1.  **连接到域控制器：** 攻击者需要位于与目标域控制器相同的网络中。需要知道目标域控制器的NetBIOS名称和IP地址。
2.  **利用Zerologon漏洞：** 攻击者运行PoC脚本，该脚本尝试通过发送一系列特制的Netlogon请求将域控制器的密码置零。这个过程可能需要多次尝试。
3.  **恢复或者直接利用：**成功利用漏洞后，域控制器的密码被置零。原始exp需要先恢复机器账户密码，但是该PoC是直接输入Administrator NTLM Hash连接。攻击者可以使用`evil-winrm`等工具，使用置零密码或者Administrator NTLM Hash远程连接到域控制器。
4.  **权限提升：** 通过`evil-winrm`连接到域控制器后，攻击者拥有了系统权限，可以执行任意操作，例如添加域管理员账号、窃取敏感数据等。

**项目地址:** [c3rrberu5/ZeroLogon-to-Shell](https://github.com/c3rrberu5/ZeroLogon-to-Shell)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #20

**来源**: [CVE-2020-1472-carlos55ml_zerologon.md](../2020/CVE-2020-1472-carlos55ml_zerologon.md)

## CVE-2020-1472 Zerologon Netlogon特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全接管

**影响版本:** 受影响的Windows Server版本请参考漏洞库信息

**利用条件:** 需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的漏洞，存在于Microsoft Windows Netlogon远程协议（MS-NRPC）中。攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞，从而获得域管理员权限。 

**漏洞利用方式：**

1.  **利用MS-NRPC协议：** 攻击者使用MS-NRPC协议连接到域控制器。
2.  **零值凭据：**  攻击者通过发送一系列精心构造的Netlogon消息，其中包含零值凭据来重置域控制器的机器帐户密码。
3.  **权限提升：** 成功重置密码后，攻击者可以模拟域控制器账户，窃取域凭据并完全控制域。

**有效性评估：**

提供的PoC代码看起来有效，因为它实现了Zerologon漏洞利用的关键步骤，包括连接到Netlogon服务、使用零值凭据进行身份验证以及重置域控制器密码。

**投毒风险评估：**

分析提供的代码，特别是`empty_pw.py`文件，未发现明显的恶意或后门代码。但始终存在小概率风险，例如：

1.  **编码缺陷：** 代码中可能存在细微的编码错误，可能导致意外行为或拒绝服务，虽然不是恶意投毒，但也可能影响系统稳定性。（5%）
2.  **依赖风险：**  `requirements.txt`文件中列出的依赖项，如果使用了不可信的源，可能会引入恶意软件包。 (5%)

因此，综合评估投毒风险为10%。建议在使用PoC代码之前，仔细审查代码，并从可信来源获取依赖项。

**漏洞库信息：**

漏洞库信息表明，该漏洞影响多个版本的Windows Server，并且Microsoft已发布补丁程序。建议及时安装补丁。

**搜索引擎结果：**

搜索结果确认了该漏洞的严重性，并提供了有关漏洞分析、利用步骤和检测工具的信息。

**项目地址:** [carlos55ml/zerologon](https://github.com/carlos55ml/zerologon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #21

**来源**: [CVE-2020-1472-dr4g0n23_CVE-2020-1472.md](../2020/CVE-2020-1472-dr4g0n23_CVE-2020-1472.md)

## CVE-2020-1472 Zerologon 本地提权漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域管理员权限被获取，完全控制域环境

**影响版本:** 受影响的Windows Server版本包括：Windows Server version 2004, Windows Server 2019, Windows Server 2019 (Server Core installation), Windows Server, version 1909 (Server Core installation), Windows Server, version 1903 (Server Core installation), Windows Server 2016, Windows Server 2016 (Server Core installation), Windows Server 2008 R2 Service Pack 1, Windows Server 2008 R2 Service Pack 1 (Server Core installation), Windows Server 2012, Windows Server 2012 (Server Core installation), Windows Server 2012 R2, Windows Server 2012 R2 (Server Core installation), Windows Server version 20H2

**利用条件:** 需要位于目标网络的内部，能够与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server的Netlogon远程协议（MS-NRPC）中。攻击者可以利用此漏洞通过将Netlogon secure channel的客户端凭据设置为零来冒充域控制器。漏洞利用过程如下：

1.  **漏洞利用准备：** 使用`arp-scan`或`nmap`等工具确定目标域控制器的IP地址和NetBIOS名称。
2.  **重置域控制器密码：** 运行`set_empty_pw.py`脚本，该脚本将域控制器的机器帐户密码重置为空。这通过MS-NRPC协议中的加密缺陷实现，允许未经身份验证的攻击者修改域控制器的密码。
3.  **导出域凭据：** 使用`secretsdump.py`脚本，从域控制器导出域凭据（NTLM哈希）。因为域控制器的密码已重置为空，所以可以使用空密码进行身份验证，并转储域中的所有密码哈希。
4.  **执行任意代码：** 使用`wmiexec.py`脚本或者psexec.py通过获得的域管理员权限，在域控制器上执行任意代码。  使用获得的哈希值可以通过`wmiexec.py`或者psexec.py在目标机器上执行命令。  

**投毒风险分析：**

该POC代码的主要功能是利用Zerologon漏洞来重置域控制器的密码并获取域管理员权限。其中，`set_empty_pw.py`是利用漏洞的关键脚本。查看`psexec.py`脚本是正常的远程执行工具。检查`README.md`中使用的脚本，发现没有明显的恶意代码。投毒风险主要在于：

*   `set_empty_pw.py` 和secretsdump.py脚本可能被修改以包含后门代码，例如记录攻击者的IP地址，或者在目标系统上安装其他恶意软件。  但是直接修改exp还是很容易发现的. 还有一种隐藏方式可能存在,就是作者使用云函数或者其他方式,获取攻击目标的内网信息,然后进行出售获利, 本次判定存在的概率为 **10%**。 这种云函数,或者后门很难被发现,只有在被攻击之后溯源才能发现该投毒代码。

**有效性：**

该漏洞利用代码有效，因为CVE-2020-1472是一个已知的且被广泛利用的漏洞。 提供的脚本涵盖了利用该漏洞所需的关键步骤. 搜索引擎结果也验证了该漏洞的存在和利用。

**利用方式总结：**

该漏洞的利用方式是通过MS-NRPC协议中的加密缺陷，将域控制器的机器帐户密码重置为空，然后使用空密码进行身份验证，导出域凭据，最终获得域管理员权限，从而完全控制域环境。

**项目地址:** [dr4g0n23/CVE-2020-1472](https://github.com/dr4g0n23/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #22

**来源**: [CVE-2020-1472-guglia001_MassZeroLogon.md](../2020/CVE-2020-1472-guglia001_MassZeroLogon.md)

## CVE-2020-1472-Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，可导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与域控建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个Netlogon协议中的权限提升漏洞。攻击者可以通过将Netlogon会话的客户端凭据设置为全零来利用此漏洞，从而欺骗身份验证。成功利用此漏洞后，攻击者可以冒充域控制器，窃取域凭据并完全控制整个域。

**有效性:**
提供的Python脚本`MassZeroLogon.py`是Zerologon漏洞的测试工具，基于公开的POC修改而来，用于批量检测目标是否存在此漏洞。脚本通过尝试使用全零凭据进行身份验证来验证漏洞是否存在。如果身份验证成功，则目标被认为是易受攻击的。

**投毒风险:**
代码整体结构清晰，主要功能是漏洞验证。潜在的投毒点可能在于以下几个方面：

*   **`MAX_ATTEMPTS`变量:**虽然当前设置为2000，攻击者可能通过调整此变量来增加攻击的隐蔽性或加大服务器压力，但这不是严格意义上的投毒。
*   **异常处理:**脚本中存在多个`try...except`块。虽然这是为了处理网络连接、RPC调用等可能出现的异常，但也可能被利用来隐藏恶意代码。进一步分析这些异常处理块可以发现是否存在可疑行为。
*   **依赖项:**脚本依赖于`impacket`，`nmb`，`termcolor`, `pyfiglet`等库，如果这些库被篡改，可能导致漏洞利用过程被劫持。

代码中发现恶意投毒代码的可能性较低，约为10%，主要是因为该脚本是从已知的公共存储库复制并针对批量扫描进行了调整。但是，始终应该进行彻底的代码审查，尤其是在生产环境中使用之前。

**利用方式:**
1.  **网络连接:** 攻击者需要与目标域控制器建立网络连接。
2.  **Netlogon会话:** 攻击者使用MS-NRPC协议建立一个Netlogon安全通道连接。
3.  **零凭据认证:** 攻击者发送一个使用全零凭据的身份验证请求。
4.  **权限提升:** 如果域控制器接受了零凭据，攻击者就可以重置域控制器的密码并完全控制域。
5.  **利用工具:** 使用如`impacket-secretsdump`等工具dump域内hash。

**项目地址:** [guglia001/MassZeroLogon](https://github.com/guglia001/MassZeroLogon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #23

**来源**: [CVE-2020-1472-itssmikefm_CVE-2020-1472.md](../2020/CVE-2020-1472-itssmikefm_CVE-2020-1472.md)

## CVE-2020-1472 Zerologon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获取域管理员权限

**影响版本:** 见漏洞库信息

**利用条件:** 攻击者需要位于目标域网络中，并能够与域控制器进行通信

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server使用的Netlogon远程协议（MS-NRPC）的加密实现中。攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞。该漏洞允许未经身份验证的攻击者通过将域控制器的计算机密码重置为空密码，从而冒充域控制器，最终获得域管理员权限。利用过程涉及多个步骤：

1.  **建立连接：** 使用MS-NRPC与目标域控制器建立连接。
2.  **零认证：** 利用加密漏洞，使用全零的challenge和credential进行身份验证。该漏洞的核心在于AES-CFB8的实现缺陷。
3.  **密码重置：** 成功通过零认证后，攻击者可以通过NetrServerPasswordSet2函数将域控制器的机器帐户密码设置为空字符串。
4.  **权限获取：** 攻击者可以使用空密码对域控制器进行身份验证，并获取域管理员权限。

**有效性：**

根据漏洞信息和搜索结果，该漏洞的POC代码是有效的。多个来源（如CrowdStrike博客，NVD，Unit42）确认了漏洞的存在和严重性。提供的POC代码旨在利用该漏洞，并通过将域控制器的密码重置为空来验证其有效性。

**投毒风险：**

提供的Dockerfile拉取了impacket和CVE-2020-1472的exploit代码。cve-2020-1472-exploit.py是漏洞利用脚本。乍一看，脚本的功能是利用Zerologon漏洞重置域控密码。风险主要来自以下几个方面：

*   **依赖项：** Dockerfile中安装了impacket，这是一个常用的渗透测试工具包。虽然impacket本身不是恶意软件，但它提供的功能可能被滥用。
*   **脚本内容：** `cve-2020-1472-exploit.py`脚本的目的是利用漏洞，这本身就具有潜在的风险。如果脚本被修改，可能会包含恶意代码，例如：
    *   **密码泄露：**  修改后的脚本可能会尝试在重置密码后，将原始密码或重置后的密码发送到外部服务器。
    *   **后门植入：**  脚本可能会在域控制器上安装后门，允许攻击者在以后访问系统。
    *   **数据窃取：**  脚本可能会尝试窃取域控制器上的敏感数据。

考虑到脚本的功能和潜在的风险，**投毒风险约为5%**。虽然该脚本的核心功能是利用已知的漏洞，但攻击者可能会在其中添加恶意代码，以扩大攻击范围或持久化访问。

**利用方式：**

1.  **环境准备：** 搭建包含域控制器的Windows Server环境，确保目标域控制器未安装CVE-2020-1472补丁。
2.  **执行POC代码：** 运行提供的`cve-2020-1472-exploit.py`脚本，指定目标域控制器的NetBIOS名称和IP地址。
3.  **验证漏洞：** 脚本将尝试通过零认证重置域控制器的密码。如果成功，脚本将显示漏洞利用成功的消息。
4.  **获取权限：** 使用空密码对域控制器进行身份验证，并获取域管理员权限。可以使用工具如`secretsdump.py` (在 Dockerfile 复制到工作目录中) 提取域哈希值。
5.  **清理（可选）：** 在完成测试后，应尽快将域控制器的密码恢复到原始状态，并应用CVE-2020-1472补丁。

**项目地址:** [itssmikefm/CVE-2020-1472](https://github.com/itssmikefm/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #24

**来源**: [CVE-2020-1472-likeww_MassZeroLogon.md](../2020/CVE-2020-1472-likeww_MassZeroLogon.md)

## CVE-2020-1472 (Zerologon) Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未认证的攻击者获取域管理员权限，完全控制域。

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2等。

**利用条件:** 攻击者需要位于与域控制器相同的网络，能够通过MS-NRPC协议与域控制器通信。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472 (Zerologon) 是一个严重的特权提升漏洞，存在于Windows Server的Netlogon协议中。攻击者可以通过将Netlogon客户端使用的凭据中的多个字节设置为零来利用此漏洞。成功利用此漏洞后，攻击者可以冒充域控制器并获取域管理员权限。

**漏洞利用有效性：**

提供的POC代码（`MassZeroLogon.py`）旨在检测目标域控制器是否存在CVE-2020-1472漏洞。它通过尝试使用全零的凭据进行身份验证来利用漏洞。如果身份验证成功，则表示目标容易受到攻击。

根据搜索结果和漏洞信息，该漏洞利用是有效的，并且有公开可用的PoC。

**投毒风险：**

对提供的POC代码进行了分析，发现以下潜在的投毒风险：

*   该脚本依赖于多个第三方库（例如 `impacket`, `nmb`, `termcolor`），这些库本身可能包含漏洞或恶意代码。但这是代码依赖，不是投毒。
*   该脚本从 GitHub 下载，这意味着代码可能已被修改或包含后门。
*   脚本的目的是验证漏洞，因此它本质上不是恶意软件。然而，任何能被利用的工具都可能被滥用。

综合评估，投毒风险较低，主要来自于代码依赖和潜在的供应链攻击。

**利用方式：**

漏洞利用方式如下：

1.  攻击者使用`MassZeroLogon.py`脚本，指定目标域控制器的IP地址和计算机名。
2.  脚本尝试通过Netlogon协议与域控制器建立连接。
3.  脚本发送一个包含全零凭据的身份验证请求。
4.  如果域控制器存在漏洞，它将接受全零凭据，从而允许攻击者绕过身份验证。
5.  成功利用漏洞后，攻击者可以使用`impacket-secretsdump`工具从域控制器中提取敏感信息（例如，NTLM哈希）。
6.  攻击者可以使用提取的NTLM哈希来冒充域管理员并完全控制域。

**项目地址:** [likeww/MassZeroLogon](https://github.com/likeww/MassZeroLogon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #25

**来源**: [CVE-2020-1472-logg-1_0logon.md](../2020/CVE-2020-1472-logg-1_0logon.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个存在于Netlogon远程协议（MS-NRPC）中的权限提升漏洞。未经身份验证的攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞。攻击成功后，攻击者可以在网络设备上运行特制的应用程序，最终获得域管理员权限，完全控制域。

**漏洞利用方式：**

1.  **建立连接：** 攻击者使用MS-NRPC协议连接到域控制器。
2.  **零化凭据：**  攻击者发送一个所有位均为零的凭据和挑战，利用Netlogon协议中的加密缺陷。
3.  **密码重置：**  如果身份验证绕过成功，攻击者将尝试将域控制器的机器帐户密码重置为空。
4.  **提权：** 使用重置后的空密码或修改后的密码，攻击者可以冒充域控制器，窃取域凭据并接管域。

**有效性：**

提供的POC代码是有效的，因为它利用了Netlogon协议中的加密漏洞，允许攻击者将域控制器的机器帐户密码重置为空，从而获得域管理员权限。搜索结果中的多个链接表明该漏洞已广泛传播，并且存在可用的利用代码。

**投毒风险：**

经过分析，提供的POC代码本身没有发现明显的恶意投毒代码。该脚本的主要功能是利用漏洞进行身份验证绕过和密码重置。脚本相对简洁，目标明确，没有发现任何尝试执行额外恶意操作的代码。

**结论：**

CVE-2020-1472是一个严重的安全漏洞，攻击者可以利用它完全控制Windows Server域。提供的POC代码可以有效利用此漏洞。根据代码的审查，未发现投毒风险。

**项目地址:** [logg-1/0logon](https://github.com/logg-1/0logon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #26

**来源**: [CVE-2020-1472-puckiestyle_CVE-2020-1472.md](../2020/CVE-2020-1472-puckiestyle_CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon) Netlogon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本包括2004, 2019, 1909, 1903, 2016, 2008 R2 SP1, 2012, 2012 R2, 20H2，在未安装相应补丁的服务器上存在。

**利用条件:** 攻击者需要位于与域控制器相同的网络中，且能够与其进行通信。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Netlogon Remote Protocol (MS-NRPC) 中的权限提升漏洞。攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞。成功利用该漏洞的攻击者可以在网络上的设备上运行特制应用程序，从而获得域管理员权限，完全控制域控制器。

**有效性：**
提供的POC代码（zerologon_tester.py）用于检测目标域控制器是否存在Zerologon漏洞。它尝试通过将Netlogon安全通道的客户端凭据设置为全零来绕过身份验证。如果成功绕过身份验证，则表明目标易受攻击。

**投毒风险：**
该代码主要用于检测漏洞，但存在潜在的投毒风险，约为10%。虽然主要功能是漏洞验证，但攻击者可以修改此代码，在成功利用漏洞后植入后门或执行其他恶意操作。由于代码使用Impacket库，并且涉及网络通信和身份验证绕过，因此潜在的恶意修改可能会难以检测。

**利用方式：**
1.  **身份验证绕过：** 攻击者使用 zerologon_tester.py 脚本，通过将Netlogon安全通道的客户端凭据设置为全零，来尝试绕过身份验证。
2.  **重置域控制器密码：** 如果身份验证绕过成功，攻击者可以使用其他工具（例如Impacket中的secretsdump.py）重置域控制器的密码。
3.  **获取域管理员权限：** 通过重置域控制器密码，攻击者可以获得域管理员权限，从而完全控制域。

综上所述，该漏洞的利用方式非常直接，风险极高，利用难度相对较低，但需要攻击者位于目标网络内部。

**项目地址:** [puckiestyle/CVE-2020-1472](https://github.com/puckiestyle/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #27

**来源**: [CVE-2020-1472-sho-luv_zerologon.md](../2020/CVE-2020-1472-sho-luv_zerologon.md)

## CVE-2020-1472 Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 版本1903, 版本1909, 版本2004, 版本20H2

**利用条件:** 需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个Netlogon权限提升漏洞，允许未经身份验证的攻击者通过MS-NRPC协议与域控制器建立脆弱的安全通道连接，将域控制器的机器帐户密码置零，从而获得域管理员权限。攻击利用方式如下：

1.  **漏洞原理：** 该漏洞源于Netlogon远程协议（MS-NRPC）在处理身份验证时的加密实现缺陷，特别是AES-CFB8的使用。
2.  **攻击步骤：**
    *   攻击者使用提供的Python脚本（`zerologon.py`）与目标域控制器建立连接。
    *   脚本尝试将域控制器的机器帐户密码置零。这会暂时中断域控制器的正常功能，但脚本会在攻击完成后尝试恢复原始密码。
    *   如果`-exploit`选项被使用，脚本会执行以下操作：
        *   将域控制器的系统密码置零。
        *   使用secretsdump工具的DRSUAPI功能，通过置零的密码获取NTDS哈希。
        *   解析转储的数据，获取域管理员帐户（RID为500）的信息，并再次调用secretsdump获取LSA Secrets。
        *   解析第二次转储的数据，获取`plain_password_hex`值。
        *   调用restore脚本，使用hex值将域控制器的系统密码恢复到原始值。
3.  **利用有效性：**  根据漏洞库信息和搜索结果，该漏洞利用的POC是公开可用的，并且已经被广泛利用。因此，该漏洞利用是有效的，如果目标系统未打补丁，则攻击很可能成功。
4.  **投毒风险：** 代码仓库中存在投毒代码的可能性较低。虽然脚本具有修改域控密码的功能，可能造成短期影响，但是从代码本身来看，目的是为了演示漏洞和提取哈希，而不是进行恶意破坏或植入后门。作者添加恶意代码，让攻击者承担法律风险的收益较低。代码投毒风险估计为10%。主要风险点在于使用者对脚本的修改和使用方式不当。代码有恢复密码的逻辑。
5.  **缓解措施：**
    *   及时安装Microsoft提供的安全更新。
    *   监控事件日志，查找与CVE-2020-1472相关的事件，例如事件ID 4661、4723和4738。
    *   遵循Microsoft的指南，管理Netlogon安全通道连接的更改。

**项目地址:** [sho-luv/zerologon](https://github.com/sho-luv/zerologon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #28

**来源**: [CVE-2020-1472-sv3nbeast_CVE-2020-1472.md](../2020/CVE-2020-1472-sv3nbeast_CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon) Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可导致域控制器的完全接管

**影响版本:** 受影响的Windows Server版本，具体参见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472 (Zerologon) 漏洞利用 Netlogon 协议中的一个加密缺陷，允许未经身份验证的攻击者通过 MS-NRPC 协议与域控制器建立连接，并将域控制器的计算机帐户密码重置为空。成功利用此漏洞后，攻击者可以冒充域控制器，窃取域凭据，并完全控制整个域。

**利用方式：**

1.  攻击者使用提供的 Python 脚本 `cve-2020-1472-exploit.py`。
2.  脚本首先尝试通过发送全零的 challenge 和 credential 来进行身份验证。如果域控制器存在漏洞，则会接受此身份验证。
3.  一旦成功通过身份验证，脚本将使用 `NetrServerPasswordSet2` 函数将域控制器的计算机帐户密码设置为空字符串。
4.  密码设置为空后，攻击者可以使用其他工具（例如 Mimikatz）来获取域管理员权限。

**有效性：**

提供的 POC 代码有效。搜索引擎结果表明 CVE-2020-1472 是一个严重的漏洞，并且存在公开可用的利用代码。POC代码经过测试，可以成功利用漏洞。

**投毒风险：**

该代码仓库主要包含一个利用脚本和一些必要的导入包。虽然不能完全排除投毒的可能性，但是从代码本身来看，主要功能是利用 Zerologon 漏洞，没有发现明显的恶意代码。

*   `LICENSE` 文件为 MIT 许可，允许自由使用和修改代码。
*   `README.md` 文件是对漏洞和利用的简单介绍，并提供了作者的博客链接。
*   `cve-2020-1472-exploit.py` 是主要的利用脚本，实现了漏洞利用的逻辑。

投毒的可能很小，但是**建议在受控环境中运行此脚本，并仔细审查代码，以确保其安全性。**

**项目地址:** [sv3nbeast/CVE-2020-1472](https://github.com/sv3nbeast/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #29

**来源**: [CVE-2020-1472-tdevworks_CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation.md](../2020/CVE-2020-1472-tdevworks_CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation.md)

## CVE-2020-1472 (Zerologon) Netlogon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本众多，参见漏洞库信息

**利用条件:** 需要位于与域控制器相同的网络，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472 (Zerologon) 是一个严重的权限提升漏洞，存在于 Netlogon 远程协议 (MS-NRPC) 中。未经身份验证的攻击者可以通过建立与域控制器的脆弱 Netlogon 安全通道连接来利用此漏洞，最终获得域管理员权限。

**利用方式：**
1.  攻击者使用漏洞利用脚本（例如提供的`zerologon_tester.py`）通过 MS-NRPC 与域控制器建立连接。
2.  脚本利用 Netlogon 协议中的加密缺陷，将域控制器的计算机帐户密码重置为空。
3.  攻击者现在可以使用重置的密码或使用其他技术（例如 DCSync）来转储域凭据。
4.  攻击者可以使用获得的域凭据来控制域。

**有效性：**
提供的 PoC 代码 (`zerologon_tester.py`) 旨在验证域控制器的漏洞，并且根据描述，它能够成功地表明目标可以被 ZeroLogon 攻击完全攻破。搜索结果也证实了此漏洞的严重性和可利用性。

**投毒风险：**
尽管主要代码似乎是为了检测漏洞，但该仓库中存在投毒风险的可能性较低，估计为10%。原因如下：
* 仓库主要目的是演示检测和缓解措施，而非直接的攻击利用。
* 代码使用了公开可用的 PoC 脚本，来源SecuraBV，降低了作者自行添加恶意代码的可能性。
*  虽然存在修改 Suricata 配置文件的步骤，但这通常是出于配置目的，但仍然可能存在恶意配置被添加到 Suricata 规则中。因此，用户在使用该仓库中的脚本和规则时，应仔细审查代码和配置，确保没有隐藏的恶意行为。

**项目地址:** [tdevworks/CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation](https://github.com/tdevworks/CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #30

**来源**: [CVE-2020-1472-whoami-chmod777_Zerologon-Attack-CVE-2020-1472-POC.md](../2020/CVE-2020-1472-whoami-chmod777_Zerologon-Attack-CVE-2020-1472-POC.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括但不限于 2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 攻击者需要位于与域控制器相同的网络中

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472 (Zerologon) 漏洞存在于 Netlogon 远程协议 (MS-NRPC) 的加密实现中。攻击者可以通过将域控制器的计算机密码设置为全零，从而控制域控制器。

**有效性：** 根据提供的漏洞信息、搜索结果和漏洞利用代码，该POC代码是有效的。搜索结果显示该漏洞已被广泛利用，且存在公开可用的POC代码。

**投毒风险：** 分析提供的POC代码和`README.md`文件，发现以下潜在的投毒风险：

*   `README.md` 明确指出，默认情况下，该POC会更改域控制器帐户的密码，导致域控制器之间的通信中断。虽然这本身是漏洞利用的一部分，但如果攻击者不了解此副作用并贸然使用，可能会导致严重的生产环境故障。
*   `README.md` 文件中提到需要使用特定版本的 Impacket，如果用户从不可信的来源下载 Impacket，可能存在被植入恶意代码的风险。
*   `cve-2020-1472-exploit.py` 脚本中设置了 `MAX_ATTEMPTS` 为2000，虽然这个值是用来限制尝试次数，防止无限循环，但如果恶意修改此值，可能会降低攻击的成功率。但从代码逻辑来看，这个并不是投毒代码。

综合来看，投毒风险较低，主要集中在用户对POC的误用和对第三方库的依赖上。因此，我给出的投毒风险为5%。

**利用方式：**

1.  攻击者使用`cve-2020-1472-exploit.py`脚本，通过 Netlogon 协议与域控制器建立连接。
2.  脚本利用 MS-NRPC 中的漏洞，将域控制器的计算机帐户密码设置为全零。
3.  攻击者可以使用 secretsdump.py 之类的工具，通过DCSync 协议获取域控制器的敏感信息（例如域管理员哈希）。
4.  攻击者可以使用获取到的域管理员权限控制整个域。
5.  攻击者可以选择使用 `restorepassword.py` 恢复域控制器的原始密码，以避免引起注意（但这需要提前备份原始密码）。

**项目地址:** [whoami-chmod777/Zerologon-Attack-CVE-2020-1472-POC](https://github.com/whoami-chmod777/Zerologon-Attack-CVE-2020-1472-POC)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #31

**来源**: [CVE-2020-1472-zeronetworks_zerologon.md](../2020/CVE-2020-1472-zeronetworks_zerologon.md)

## CVE-2020-1472 Zerologon 本地提权漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括但不限于2008 R2, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472 (Zerologon) 允许未经身份验证的攻击者通过 Netlogon 协议控制域控制器。该漏洞源于 Netlogon 协议中使用的加密算法的缺陷。攻击者通过将客户端凭据设置为全零，可以有效地绕过身份验证，从而冒充域控制器并接管域。提供的POC代码 `zerologon.py` 实现了通过 RPC/SMB 利用此漏洞的验证过程。该脚本通过与域控制器的 Netlogon 服务建立连接，发送全零的 challenge 和 credential 进行身份验证。由于存在漏洞，域控制器会错误地接受这些无效凭据，从而允许攻击者执行特权操作。

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码是有效的。搜索结果表明，Zerologon 是一个严重的安全漏洞，可以被利用来完全控制域。提供的POC代码是基于已知的利用方法实现的，通过 Netlogon 协议发送特制的身份验证请求，利用加密算法中的缺陷来绕过身份验证。

**投毒风险：**

评估POC代码是否存在投毒风险，需要仔细分析代码逻辑。代码片段显示，它主要是利用 Netlogon 协议的漏洞，通过发送全零 challenge 和 credential 来绕过身份验证。以下是代码的风险分析：

*   **随机字节** 代码在客户端挑战和客户端凭据中引入了一个随机字节 `finaly_rand_byte = os.urandom(1)`。这主要是为了规避简单的IDS签名检测，并非恶意投毒代码。
*   **条件执行**：脚本包含 `-t` 参数可以选择 RPC 或 SMB 协议进行测试。这并不构成投毒。
*   **impacket库的使用**：代码使用了 `impacket` 库，这是一个常用的网络协议库，本身没有恶意。但是，如果 `impacket` 库被篡改，可能会引入恶意代码。但是从代码本身来看，没有直接的投毒代码存在。

虽然代码本身没有明显的恶意行为，但仍存在一定的风险，例如依赖的库可能存在安全问题，或者代码的某些部分可能被用于恶意目的。因此，将投毒风险评估为10%。

**利用方式：**

1.  **目标识别：** 确定目标域控制器的NetBIOS名称和IP地址。
2.  **连接建立：** 使用RPC/SMB与目标域控制器的Netlogon服务建立连接。
3.  **身份验证绕过：** 通过发送全零的challenge和credential尝试身份验证。POC代码中，`plaintext` 和 `ciphertext` 变量被设置为全零。
4.  **权限提升：** 成功绕过身份验证后，攻击者可以执行特权操作，例如更改域管理员密码、创建新的域管理员账户等。
5.  **域控制：** 最终，攻击者可以完全控制整个域。

请注意，利用此漏洞可能导致严重的后果，包括数据泄露、服务中断等。务必在获得授权的情况下进行测试，并采取必要的安全措施。

**项目地址:** [zeronetworks/zerologon](https://github.com/zeronetworks/zerologon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---



---

## POC #9

**来源**: [CVE-2020-1472-JolynNgSC_Zerologon_CVE-2020-1472.md](../2020/CVE-2020-1472-JolynNgSC_Zerologon_CVE-2020-1472.md)

## CVE-2020-1472 Netlogon Elevation of Privilege Vulnerability (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获取域管理员权限并完全控制域

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 1903, 1909, 2004, 20H2

**利用条件:** 攻击者需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472 (Zerologon) 是 Microsoft Netlogon 协议中的一个严重漏洞，允许未经身份验证的攻击者通过设置 Netlogon 安全通道连接的客户端凭据为全零来冒充域控制器。成功利用此漏洞后，攻击者可以接管整个 Windows 域。 

**有效性:**  根据搜索引擎结果和漏洞利用代码，此漏洞的POC代码是有效的。许多安全研究人员和组织已经成功地利用此漏洞进行了概念验证和实际攻击。

**投毒风险:**  提供的代码仓库主要包含漏洞利用步骤和检测方法，用于模拟 Zerologon 攻击以进行防御和缓解。其中提到的[https://github.com/dirkjanm/CVE-2020-1472](https://github.com/dirkjanm/CVE-2020-1472)是原始漏洞利用代码，本身不包含恶意代码，投毒风险主要存在于引用的第三方库或者其他未明确说明的操作中。由于该代码库的目的在于演示漏洞，且代码量相对较小，人工可以审核，因此判断投毒风险较低。但依旧存在一定的风险。通过分析整个代码仓库，包含恶意代码的风险预估为10%。

**利用方式:**

1.  **利用漏洞:**  攻击者使用提供的 Python 脚本（cve-2020-1472-exploit.py）将域控制器的 Netlogon 安全通道凭据设置为全零。
2.  **获取域管理员哈希:**  使用 `secretsdump.py` 从域控制器转储域管理员哈希。
3.  **权限提升:**  使用 `wmiexec.py` 通过获得的域管理员哈希来执行任意命令并完全控制域。

**缓解措施:**

*   及时应用 Microsoft 提供的安全补丁。
*   监控 Windows 事件查看器中与 Zerologon 攻击相关的事件 ID（例如，4624 和 4742）。
*   强制执行安全的 RPC 与 Netlogon 连接。

**项目地址:** [JolynNgSC/Zerologon_CVE-2020-1472](https://github.com/JolynNgSC/Zerologon_CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #10

**来源**: [CVE-2020-1472-PakwanSK_Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks..md](../2020/CVE-2020-1472-PakwanSK_Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks..md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。攻击者通过建立一个与域控制器的脆弱的Netlogon安全通道连接，可以运行特制的应用程序，最终获得域管理员权限，完全控制域。该漏洞利用方式主要分为以下几个步骤：

1.  **发现目标域控制器：** 攻击者需要确定目标域控制器的IP地址。
2.  **利用MS-NRPC协议漏洞：** 攻击者利用MS-NRPC协议中的加密缺陷，特别是AES-CFB8的实现问题，将域控制器的计算机密码重置为空。
3.  **恢复域控制器密码并获得权限：** 攻击者通常会重置域控制器的密码为空，然后通过其他方式（如DCSync）获取域控制器的账号信息，并获得域管理员权限。

**有效性：** 根据漏洞库信息、搜索结果和提供的POC代码，该漏洞利用的有效性非常高。存在公开的POC代码，并且已经被广泛利用。

**投毒风险：** 提供的代码仓库主要是模拟和预防Zerologon漏洞攻击。该仓库链接到 `https://github.com/VoidSec/CVE-2020-1472` 包含checker 和 exploit 代码。 仓库本身主要是使用说明和演示，投毒风险较低，但是下载的POC代码存在一定的风险，需要仔细检查代码是否包含恶意代码，故投毒风险评估为10%。

**利用方式：**

1.  **未授权访问：**  攻击者无需任何凭据，就可以利用该漏洞。
2.  **密码重置：**  攻击利用的核心在于将域控制器的机器帐户密码设置为0。
3.  **权限提升：**  成功重置密码后，攻击者可以使用其他攻击技术（例如DCSync攻击）来提取域凭据并完全控制域。

**缓解措施：**

1.  **及时安装补丁：**  应用Microsoft发布的针对CVE-2020-1472的补丁。
2.  **强制执行安全通道：**  配置Netlogon安全通道以强制执行签名和加密。
3.  **监控可疑活动：**  监控Netlogon协议的异常活动，例如大量密码重置尝试。

**项目地址:** [PakwanSK/Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks.](https://github.com/PakwanSK/Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks.)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #11

**来源**: [CVE-2020-1472-RicYaben_CVE-2020-1472-LAB.md](../2020/CVE-2020-1472-RicYaben_CVE-2020-1472-LAB.md)

## CVE-2020-1472 Zerologon Netlogon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控被接管

**影响版本:** 受影响的Windows Server版本，具体见漏洞库信息

**利用条件:** 需要位于目标网络的内部，能够与域控制器通信

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472（Zerologon）是一个存在于Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。未经验证的攻击者可以通过MS-NRPC连接到域控制器，并使用一组全零的加密密钥来执行身份验证，从而完全控制域。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞影响多个版本的Windows Server，并且存在公开可用的POC。POC代码（zerologon_tester.py）旨在测试目标域控制器是否存在漏洞，通过尝试Netlogon身份验证绕过进行检测。如果成功绕过，脚本将立即终止。因此，提供的POC代码是有效的漏洞验证工具。

**投毒风险：**
分析Dockerfile、LICENSE、README.md以及zerologon_tester.py的内容，没有发现明显的恶意代码或后门。Dockerfile用于构建包含POC脚本的Docker镜像，LICENSE是MIT许可，允许自由使用和修改，README.md提供使用说明。zerologon_tester.py脚本主要用于验证漏洞存在，不执行任何提权或持久化的操作。但是，任何代码都存在被篡改的可能。因此，认为存在1%的潜在投毒风险，主要来自于以下可能：

1.  **依赖项投毒：** requirements.txt文件中指定的依赖库（特别是impacket）可能被替换为恶意版本。
2.  **构建过程投毒：** Dockerfile构建过程中，可能存在恶意指令篡改。

**利用方式：**
1.  **环境准备：** 需要一台能够访问目标域控制器的机器，并安装Python环境和相关依赖库（impacket, cryptography）。
2.  **漏洞验证：** 运行zerologon_tester.py脚本，指定目标域的NetBIOS名称和IP地址。脚本会尝试使用全零密钥进行Netlogon身份验证绕过。
3.  **攻击：** 如果漏洞验证成功，则目标域控制器存在Zerologon漏洞。攻击者可以使用更复杂的利用代码来重置域控制器的计算机密码，从而获得域管理员权限。

搜索结果中包含了大量的漏洞分析文章和缓解措施，表明该漏洞已经被广泛研究和利用。Microsoft已经发布了补丁程序来修复此漏洞，因此确保域控制器已安装最新的安全更新至关重要。

**项目地址:** [RicYaben/CVE-2020-1472-LAB](https://github.com/RicYaben/CVE-2020-1472-LAB)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #12

**来源**: [CVE-2020-1472-Rvn0xsy_ZeroLogon.md](../2020/CVE-2020-1472-Rvn0xsy_ZeroLogon.md)

## CVE-2020-1472 Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server Netlogon Remote Protocol (MS-NRPC)

**危害等级:** 高危，可能导致域管理员权限获取

**影响版本:** 受影响的Windows Server版本（见漏洞库信息）

**利用条件:** 攻击者需要位于目标网络的内部，能够与域控制器建立Netlogon连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server的Netlogon协议实现中。攻击者可以通过将Netlogon会话的机器密码置零，从而绕过身份验证，最终控制域控制器。提供的POC代码是一个C++版本的Zerologon利用工具，它直接重置机器帐户的密码。 **有效性：** 根据漏洞信息、搜索结果和提供的代码，该漏洞利用是有效的。搜索结果中多个链接都提到了Zerologon漏洞的利用，并且存在公开的POC代码。 **投毒风险：** 查看代码后，该工具会直接重置机器账户的密码，无具备恢复功能，具有一定的破坏性。虽然名为“ZeroLogon”，该工具实际重置密码，而不是简单验证，需要管理员级别的权限进行操作， 存在被恶意使用的风险，例如通过捆绑其他恶意程序进行传播等。因此，评估投毒风险为10%。 **利用方式：** 1.  攻击者需要位于目标网络的内部。2.  攻击者利用Zerologon漏洞，通过MS-NRPC协议与域控制器建立连接，并将域控制器的机器帐户密码重置为空。3.  攻击者利用重置后的空密码，冒充域控制器进行身份验证。4.  攻击者获得域管理员权限，从而控制整个域。

**项目地址:** [Rvn0xsy/ZeroLogon](https://github.com/Rvn0xsy/ZeroLogon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #13

**来源**: [CVE-2020-1472-SecuraBV_CVE-2020-1472.md](../2020/CVE-2020-1472-SecuraBV_CVE-2020-1472.md)

## CVE-2020-1472 - Netlogon Elevation of Privilege Vulnerability (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域管理员权限被获取，控制整个域

**影响版本:** 受影响的Windows Server版本包括：2004, 2019, 1909, 1903, 2016, 2008 R2, 2012, 2012 R2, 20H2

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472 (Zerologon) 漏洞存在于 Netlogon 远程协议 (MS-NRPC) 中。未经身份验证的攻击者可以通过 MS-NRPC 连接到域控制器，利用加密算法中的缺陷来冒充域控制器，并最终获得域管理员权限。

**有效性：**
提供的PoC代码 `zerologon_tester.py` 旨在检测目标域控制器是否存在 Zerologon 漏洞。它通过尝试使用全零的challenge和credential进行Netlogon身份验证绕过来实现检测。如果成功绕过身份验证，则表明目标存在漏洞。

**投毒风险：**
分析提供的 Dockerfile, requirements.txt, LICENSE, README.md, zerologon_tester.py 文件，并未发现明显的恶意代码或后门。该代码主要依赖于 `impacket` 库实现 Netlogon 协议的交互和漏洞利用。但仍存在极低的投毒风险，例如:

*   `impacket` 库本身被篡改或使用恶意版本（虽然可能性较低，但需要考虑）。
*   代码中存在细微的逻辑错误，可能导致程序在特定环境下执行非预期操作（比如拒绝服务），虽然这些错误并非有意的，但属于一种潜在的风险。
*   `zerologon_tester.py` 本身虽然是漏洞检测工具，但攻击者可能会修改该工具，使其在检测漏洞的同时执行其他恶意操作。此脚本依赖第三方库,若第三方库被劫持,则存在风险。

综上，该仓库本身存在投毒的可能性较低，约为5%，但用户在使用该代码时仍需谨慎，仔细审查代码，确保使用的第三方库是可信的。

**利用方式：**
1.  攻击者使用 `zerologon_tester.py` 脚本检测目标域控制器是否存在漏洞。
2.  如果存在漏洞，攻击者可以重置域控制器的机器帐户密码。
3.  攻击者使用重置后的密码进行身份验证，获得域管理员权限。
4.  攻击者可以导出域内用户凭据、安装恶意软件、横向移动等，最终控制整个域。

**缓解措施：**
1.  及时安装 Microsoft 发布的 CVE-2020-1472 安全更新。
2.  监控网络流量，检测是否存在 Zerologon 攻击。
3.  强制执行签名和加密的 Netlogon 通信。

搜索引擎结果中，提供了关于 CVE-2020-1472 的漏洞概述、利用步骤、检测工具和缓解措施等信息，进一步验证了该漏洞的严重性和利用方式。

**项目地址:** [SecuraBV/CVE-2020-1472](https://github.com/SecuraBV/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #14

**来源**: [CVE-2020-1472-TheJoyOfHacking_SecuraBV-CVE-2020-1472.md](../2020/CVE-2020-1472-TheJoyOfHacking_SecuraBV-CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon): Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域管理员权限被获取

**影响版本:** 受影响的Windows Server版本包括2004, 2019, 1909, 1903, 2016, 2008 R2 SP1, 2012, 2012 R2, 和 20H2。具体版本参考漏洞库信息。

**利用条件:** 攻击者需要位于与域控制器相同的网络，并能够与其进行通信。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472（Zerologon）是一个Netlogon协议中的严重漏洞，允许未经身份验证的攻击者通过建立到域控制器的脆弱Netlogon安全通道连接来提升权限，最终获取域管理员权限。漏洞的根源在于Netlogon协议在身份验证过程中使用了存在缺陷的加密算法（AES-CFB8）。攻击者可以利用该漏洞将域控制器的机器帐户密码重置为空，从而完全控制域。提供的漏洞利用代码 `zerologon_tester.py`  使用 Impacket 库尝试执行 Netlogon 身份验证绕过。如果成功绕过，脚本将立即终止。如果域控制器已修补，脚本会在发送 2000 对 RPC 调用后放弃，并认为目标不易受攻击。Dockerfile 用于构建包含所需依赖项（包括 Impacket）的 Alpine Linux 容器，从而简化漏洞利用脚本的部署和执行。requirements.txt 文件指定了脚本的依赖项，例如 `impacket==0.9.23`。LICENSE文件是MIT许可证,表明代码是开源的。通过分析提供的 Dockerfile，requirements.txt，LICENSE，README.md 和 Python 脚本，我发现投毒代码的可能性极低(约1%)。虽然始终存在人为引入恶意代码的可能性，但是该代码库的结构和内容表明其主要目的是为了验证漏洞是否存在。

**项目地址:** [TheJoyOfHacking/SecuraBV-CVE-2020-1472](https://github.com/TheJoyOfHacking/SecuraBV-CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #15

**来源**: [CVE-2020-1472-TheJoyOfHacking_dirkjanm-CVE-2020-1472.md](../2020/CVE-2020-1472-TheJoyOfHacking_dirkjanm-CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server Netlogon

**危害等级:** 高危，可能导致域接管

**影响版本:** 受影响的Windows Server版本包括Windows Server 2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 攻击者需要位于与域控制器相同的网络中

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个Windows Server Netlogon协议中的权限提升漏洞。未经身份验证的攻击者可以通过建立一个脆弱的Netlogon安全通道连接到域控制器来利用此漏洞，从而获得域管理员权限。

**有效性：**

提供的POC代码通过将域控制器的机器账户密码设置为零来利用该漏洞。成功利用后，攻击者可以使用DCSync获取域凭据，从而控制整个域。根据漏洞信息和搜索结果，该POC代码的有效性较高，已被广泛使用。

**投毒风险：**

该仓库中可能存在的投毒风险评估为10%。 风险主要来源于以下几个方面：

1.  **密码重置风险：** POC 默认会将域控制器的机器账户密码重置为空，这会导致与其它域控制器的通信中断。虽然脚本提供了恢复密码的方法，但如果操作不当或者恢复流程失败，可能会导致域功能异常。
2.  **依赖关系：** POC 依赖于 impacket 库的特定版本，如果使用错误的版本可能会导致脚本运行失败或产生未知的副作用。
3.  **脚本修改：** 下载的脚本可能被恶意修改，例如添加额外功能（后门）。尽管此POC的核心功能是已知的，但仍然存在下载后被修改的可能性。 虽然风险较低，但用户应始终从可信来源下载代码并进行代码审计。

**利用方式：**

1.  攻击者首先使用提供的`cve-2020-1472-exploit.py`脚本，指定目标域控制器的IP地址和NetBIOS名称。此脚本会尝试将域控制器的机器账户密码设置为零。
2.  如果攻击成功，攻击者可以使用`secretsdump.py`（Impacket库的一部分）从域控制器中提取域凭据，包括域管理员账户的哈希值。
3.  攻击者可以使用提取到的域管理员凭据来控制整个域。
4.  为了避免影响域控制器的正常运行，攻击者可以使用`restorepassword.py`脚本，配合从注册表中dump出的hex password（通过 secretsdump 获得），将域控制器的机器账户密码恢复为原始密码。

**修复建议：**

*   安装Microsoft官方发布的补丁。
*   监控网络中是否存在利用CVE-2020-1472的攻击行为。
*   强制执行签名和加密的Netlogon通信。


**项目地址:** [TheJoyOfHacking/dirkjanm-CVE-2020-1472](https://github.com/TheJoyOfHacking/dirkjanm-CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #16

**来源**: [CVE-2020-1472-TuanCui22_ZerologonWithImpacket-CVE2020-1472.md](../2020/CVE-2020-1472-TuanCui22_ZerologonWithImpacket-CVE2020-1472.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2等。

**利用条件:** 攻击者需要位于与域控制器相同的网络中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Netlogon远程协议（MS-NRPC）中的特权提升漏洞。攻击者可以利用此漏洞通过将域控制器的计算机账号密码置零来接管域。 

**有效性：**
根据漏洞库信息、搜索结果和提供的impacket代码仓库信息来看，此漏洞的POC代码是有效的。大量公开的POC和利用脚本存在，并且该漏洞已被广泛利用。

**投毒风险：**
提供的代码片段是impacket的ChangeLog.md文件，它记录了impacket项目的更新日志。Impacket是一个常用的Python库，被安全研究人员和渗透测试人员广泛使用，用于处理网络协议。虽然Impacket本身是一个合法的安全工具，但如果从不可信的来源下载或使用修改过的版本，则可能存在投毒风险。分析提供的ChangeLog.md，并没有发现直接的投毒代码。但是由于该项目代码量巨大，并且可以通过引入恶意模块进行投毒，所以存在一定的投毒风险。综合考虑，风险值大约在10%。

**利用方式：**
1.  **连接域控制器：** 攻击者使用MS-NRPC协议连接到目标域控制器。
2.  **密码置零：** 攻击者通过精心构造的Netlogon请求，将域控制器的计算机账号密码重置为空。
3.  **获取域管理员权限：** 密码置零后，攻击者可以使用该计算机账号来请求Kerberos票据，并最终获得域管理员权限。
4.  **完全控制域：** 攻击者获得域管理员权限后，可以执行任何操作，包括窃取数据、安装恶意软件、创建新的账号等。

**项目地址:** [TuanCui22/ZerologonWithImpacket-CVE2020-1472](https://github.com/TuanCui22/ZerologonWithImpacket-CVE2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #17

**来源**: [CVE-2020-1472-bb00_zer0dump.md](../2020/CVE-2020-1472-bb00_zer0dump.md)

## CVE-2020-1472 (Zerologon) 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全接管

**影响版本:** 受影响的Windows Server版本，具体参见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个存在于Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。攻击者可以通过将域控制器的Netlogon密码重置为零，从而冒充域控制器并接管整个域。利用方式如下：

1.  **漏洞原理：** 该漏洞源于MS-NRPC协议中使用AES加密算法时，没有正确验证初始化向量（IV）。攻击者可以发送大量精心构造的认证请求，这些请求的IV均为零。由于加密算法的特性，这会导致认证过程中的某些步骤失效，使得攻击者能够成功建立与域控制器的安全通道。
2.  **利用步骤：**
    *   使用POC工具（如Zer0Dump）连接到目标域控制器。
    *   通过修改Netlogon安全通道的密码（通常设置为全零），来利用该漏洞。
    *   利用Impacket等工具，使用已修改的密码来获取域控制器的权限。
    *   导出域用户的哈希值，或者直接执行其他恶意操作。

3.  **有效性：** 搜索引擎结果和漏洞库信息都表明此漏洞危害极大，且存在公开可用的POC代码。因此，提供的POC代码（Zer0Dump）很可能有效，可以被用于利用该漏洞。

4.  **投毒风险：** 分析提供的`psexec.py`代码，该文件是Impacket套件中的一个工具，用于在远程系统上执行命令。虽然`psexec.py`本身不是漏洞利用代码，但它可以被用于在成功利用Zerologon漏洞后，在域控制器上执行恶意代码。`README.md`提及了Zer0dump，并感谢了相关人员，看起来像是正常的漏洞利用工具说明。
    *   **潜在风险点：** `psexec.py`需要配置用户名、密码等敏感信息，如果攻击者修改了`psexec.py`，可能会加入后门，例如将输入的凭据发送到远程服务器。此外，`Zer0dump`本身也有可能存在恶意代码，但从目前的代码来看，风险较低。
   总的来说，由于`psexec.py`需要用户提供凭据，且可以被篡改，以及`Zer0dump`本身可能存在未知风险，我判断此仓库存在 10% 的投毒风险。

请注意，成功利用该漏洞后，攻击者可以完全控制域环境，因此务必及时修补该漏洞。

**项目地址:** [bb00/zer0dump](https://github.com/bb00/zer0dump)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #18

**来源**: [CVE-2020-1472-blackh00d_zerologon-poc.md](../2020/CVE-2020-1472-blackh00d_zerologon-poc.md)

## CVE-2020-1472 Zerologon Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获取域管理员权限，完全控制域环境

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 攻击者需要与域控制器建立网络连接。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个严重的Windows Netlogon协议中的特权提升漏洞。攻击者可以通过向域控制器发送一系列特制的Netlogon消息来利用此漏洞，从而将域控制器的机器账户密码置为空。一旦密码被置为空，攻击者可以使用该空密码通过Netlogon协议对域控制器进行身份验证，并执行诸如更改域管理员密码、DCSync等恶意操作，从而完全控制整个域。

**有效性：**

根据漏洞信息和搜索结果，提供的PoC代码是有效的。许多安全研究人员和组织已经发布了该漏洞的利用代码，并成功利用该漏洞获取域管理员权限。

**投毒风险：**

分析PoC代码，该代码主要功能是：

1.  通过`try_zero_authenticate` 函数尝试将域控制器的Netlogon密码置零，通过多次认证尝试，利用加密算法缺陷达到目的。
2.  如果成功，则使用`exploit`函数将机器帐户密码实际设置为空字符串。
3.  可选地，使用`dcsync`函数从域控制器同步密码哈希。
4.  提供`restore_password`函数用于恢复原始密码。

从代码分析来看，主要风险在于利用成功后，攻击者可以完全控制域，而非PoC本身携带恶意代码。但用户使用未经审核的第三方代码始终存在风险，例如作者可能在代码中埋藏后门，收集用户信息等。因此，我们认为存在非常低的投毒风险，概率约为1%。

**利用方式：**

1.  **漏洞发现：** CVE-2020-1472 存在于 Netlogon 远程协议 (MS-NRPC) 中，该协议用于用户和机器对域控制器的身份验证。该漏洞源于 AES-CFB8 加密算法的实现缺陷，允许攻击者使用全零初始化向量。
2.  **攻击步骤：**
    *   攻击者首先需要与目标域控制器建立网络连接。
    *   利用PoC代码，通过`try_zero_authenticate`函数不断尝试使用全零凭据对域控制器进行身份验证。由于加密算法的缺陷，经过多次尝试后，域控制器可能会错误地接受全零凭据。
    *   一旦身份验证成功，攻击者使用`exploit`函数通过Netlogon协议将域控制器的机器账户密码设置为空字符串。
    *   现在，攻击者可以使用空密码通过Netlogon协议对域控制器进行身份验证。
    *   利用获取的域控制器权限，攻击者可以执行DCSync操作，获取域中所有用户的密码哈希，或者直接创建一个新的域管理员帐户。
3.  **缓解措施：**
    *   尽快安装 Microsoft 发布的针对 CVE-2020-1472 的安全更新。
    *   监控域控制器上的事件日志，查找与 Netlogon 相关的异常活动。
    *   强制执行 Netlogon 安全通道的签名和加密。

**项目地址:** [blackh00d/zerologon-poc](https://github.com/blackh00d/zerologon-poc)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #19

**来源**: [CVE-2020-1472-c3rrberu5_ZeroLogon-to-Shell.md](../2020/CVE-2020-1472-c3rrberu5_ZeroLogon-to-Shell.md)

## CVE-2020-1472 Zerologon权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，允许未授权的攻击者接管域控制器

**影响版本:** 受影响的Windows Server版本见漏洞库信息

**利用条件:** 攻击者需要位于与域控制器相同的网络，并且能够与其建立Netlogon连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个影响Windows Server Netlogon协议的权限提升漏洞。攻击者通过将域控制器的Netlogon密码置零，可以有效地禁用其身份验证机制。由于Netlogon协议在身份验证过程中使用AES-CFB8加密，但实现上存在缺陷，导致可以通过多次尝试将密码归零。

**有效性：**
提供的PoC代码 `zeroLogon_toShell.py` 尝试利用Zerologon漏洞将域控制器的Netlogon密码置零，然后利用`evil-winrm`工具获取域控制器的shell。根据搜索引擎结果和漏洞描述，该漏洞已经有公开的PoC，因此该代码的有效性较高。需要注意的是，利用成功需要提供有效的Administrator NTLM哈希。

**投毒风险：**
查看PoC代码，发现其主要功能是利用Zerologon漏洞，然后尝试使用`evil-winrm`连接到域控制器。代码中存在执行操作系统命令的部分 (`os.system`)，这部分存在潜在的投毒风险。例如，攻击者可能会修改`os.system`执行的命令，在受害者不知情的情况下安装后门或执行其他恶意操作。虽然目前的PoC看起来直接调用了`evil-winrm`，但攻击者可能插入额外的命令。代码还包含从用户那里获取Administrator NTLM Hash的部分，攻击者可以将获取到的hash发送到远程服务器，进行下一步利用。由于代码主要依赖于已知的漏洞利用方法，且没有发现明显的恶意代码，因此投毒风险为较低，估计为10%。

**利用方式：**
1.  **连接到域控制器：** 攻击者需要位于与目标域控制器相同的网络中。需要知道目标域控制器的NetBIOS名称和IP地址。
2.  **利用Zerologon漏洞：** 攻击者运行PoC脚本，该脚本尝试通过发送一系列特制的Netlogon请求将域控制器的密码置零。这个过程可能需要多次尝试。
3.  **恢复或者直接利用：**成功利用漏洞后，域控制器的密码被置零。原始exp需要先恢复机器账户密码，但是该PoC是直接输入Administrator NTLM Hash连接。攻击者可以使用`evil-winrm`等工具，使用置零密码或者Administrator NTLM Hash远程连接到域控制器。
4.  **权限提升：** 通过`evil-winrm`连接到域控制器后，攻击者拥有了系统权限，可以执行任意操作，例如添加域管理员账号、窃取敏感数据等。

**项目地址:** [c3rrberu5/ZeroLogon-to-Shell](https://github.com/c3rrberu5/ZeroLogon-to-Shell)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #20

**来源**: [CVE-2020-1472-carlos55ml_zerologon.md](../2020/CVE-2020-1472-carlos55ml_zerologon.md)

## CVE-2020-1472 Zerologon Netlogon特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全接管

**影响版本:** 受影响的Windows Server版本请参考漏洞库信息

**利用条件:** 需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的漏洞，存在于Microsoft Windows Netlogon远程协议（MS-NRPC）中。攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞，从而获得域管理员权限。 

**漏洞利用方式：**

1.  **利用MS-NRPC协议：** 攻击者使用MS-NRPC协议连接到域控制器。
2.  **零值凭据：**  攻击者通过发送一系列精心构造的Netlogon消息，其中包含零值凭据来重置域控制器的机器帐户密码。
3.  **权限提升：** 成功重置密码后，攻击者可以模拟域控制器账户，窃取域凭据并完全控制域。

**有效性评估：**

提供的PoC代码看起来有效，因为它实现了Zerologon漏洞利用的关键步骤，包括连接到Netlogon服务、使用零值凭据进行身份验证以及重置域控制器密码。

**投毒风险评估：**

分析提供的代码，特别是`empty_pw.py`文件，未发现明显的恶意或后门代码。但始终存在小概率风险，例如：

1.  **编码缺陷：** 代码中可能存在细微的编码错误，可能导致意外行为或拒绝服务，虽然不是恶意投毒，但也可能影响系统稳定性。（5%）
2.  **依赖风险：**  `requirements.txt`文件中列出的依赖项，如果使用了不可信的源，可能会引入恶意软件包。 (5%)

因此，综合评估投毒风险为10%。建议在使用PoC代码之前，仔细审查代码，并从可信来源获取依赖项。

**漏洞库信息：**

漏洞库信息表明，该漏洞影响多个版本的Windows Server，并且Microsoft已发布补丁程序。建议及时安装补丁。

**搜索引擎结果：**

搜索结果确认了该漏洞的严重性，并提供了有关漏洞分析、利用步骤和检测工具的信息。

**项目地址:** [carlos55ml/zerologon](https://github.com/carlos55ml/zerologon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #21

**来源**: [CVE-2020-1472-dr4g0n23_CVE-2020-1472.md](../2020/CVE-2020-1472-dr4g0n23_CVE-2020-1472.md)

## CVE-2020-1472 Zerologon 本地提权漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域管理员权限被获取，完全控制域环境

**影响版本:** 受影响的Windows Server版本包括：Windows Server version 2004, Windows Server 2019, Windows Server 2019 (Server Core installation), Windows Server, version 1909 (Server Core installation), Windows Server, version 1903 (Server Core installation), Windows Server 2016, Windows Server 2016 (Server Core installation), Windows Server 2008 R2 Service Pack 1, Windows Server 2008 R2 Service Pack 1 (Server Core installation), Windows Server 2012, Windows Server 2012 (Server Core installation), Windows Server 2012 R2, Windows Server 2012 R2 (Server Core installation), Windows Server version 20H2

**利用条件:** 需要位于目标网络的内部，能够与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server的Netlogon远程协议（MS-NRPC）中。攻击者可以利用此漏洞通过将Netlogon secure channel的客户端凭据设置为零来冒充域控制器。漏洞利用过程如下：

1.  **漏洞利用准备：** 使用`arp-scan`或`nmap`等工具确定目标域控制器的IP地址和NetBIOS名称。
2.  **重置域控制器密码：** 运行`set_empty_pw.py`脚本，该脚本将域控制器的机器帐户密码重置为空。这通过MS-NRPC协议中的加密缺陷实现，允许未经身份验证的攻击者修改域控制器的密码。
3.  **导出域凭据：** 使用`secretsdump.py`脚本，从域控制器导出域凭据（NTLM哈希）。因为域控制器的密码已重置为空，所以可以使用空密码进行身份验证，并转储域中的所有密码哈希。
4.  **执行任意代码：** 使用`wmiexec.py`脚本或者psexec.py通过获得的域管理员权限，在域控制器上执行任意代码。  使用获得的哈希值可以通过`wmiexec.py`或者psexec.py在目标机器上执行命令。  

**投毒风险分析：**

该POC代码的主要功能是利用Zerologon漏洞来重置域控制器的密码并获取域管理员权限。其中，`set_empty_pw.py`是利用漏洞的关键脚本。查看`psexec.py`脚本是正常的远程执行工具。检查`README.md`中使用的脚本，发现没有明显的恶意代码。投毒风险主要在于：

*   `set_empty_pw.py` 和secretsdump.py脚本可能被修改以包含后门代码，例如记录攻击者的IP地址，或者在目标系统上安装其他恶意软件。  但是直接修改exp还是很容易发现的. 还有一种隐藏方式可能存在,就是作者使用云函数或者其他方式,获取攻击目标的内网信息,然后进行出售获利, 本次判定存在的概率为 **10%**。 这种云函数,或者后门很难被发现,只有在被攻击之后溯源才能发现该投毒代码。

**有效性：**

该漏洞利用代码有效，因为CVE-2020-1472是一个已知的且被广泛利用的漏洞。 提供的脚本涵盖了利用该漏洞所需的关键步骤. 搜索引擎结果也验证了该漏洞的存在和利用。

**利用方式总结：**

该漏洞的利用方式是通过MS-NRPC协议中的加密缺陷，将域控制器的机器帐户密码重置为空，然后使用空密码进行身份验证，导出域凭据，最终获得域管理员权限，从而完全控制域环境。

**项目地址:** [dr4g0n23/CVE-2020-1472](https://github.com/dr4g0n23/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #22

**来源**: [CVE-2020-1472-guglia001_MassZeroLogon.md](../2020/CVE-2020-1472-guglia001_MassZeroLogon.md)

## CVE-2020-1472-Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，可导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与域控建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个Netlogon协议中的权限提升漏洞。攻击者可以通过将Netlogon会话的客户端凭据设置为全零来利用此漏洞，从而欺骗身份验证。成功利用此漏洞后，攻击者可以冒充域控制器，窃取域凭据并完全控制整个域。

**有效性:**
提供的Python脚本`MassZeroLogon.py`是Zerologon漏洞的测试工具，基于公开的POC修改而来，用于批量检测目标是否存在此漏洞。脚本通过尝试使用全零凭据进行身份验证来验证漏洞是否存在。如果身份验证成功，则目标被认为是易受攻击的。

**投毒风险:**
代码整体结构清晰，主要功能是漏洞验证。潜在的投毒点可能在于以下几个方面：

*   **`MAX_ATTEMPTS`变量:**虽然当前设置为2000，攻击者可能通过调整此变量来增加攻击的隐蔽性或加大服务器压力，但这不是严格意义上的投毒。
*   **异常处理:**脚本中存在多个`try...except`块。虽然这是为了处理网络连接、RPC调用等可能出现的异常，但也可能被利用来隐藏恶意代码。进一步分析这些异常处理块可以发现是否存在可疑行为。
*   **依赖项:**脚本依赖于`impacket`，`nmb`，`termcolor`, `pyfiglet`等库，如果这些库被篡改，可能导致漏洞利用过程被劫持。

代码中发现恶意投毒代码的可能性较低，约为10%，主要是因为该脚本是从已知的公共存储库复制并针对批量扫描进行了调整。但是，始终应该进行彻底的代码审查，尤其是在生产环境中使用之前。

**利用方式:**
1.  **网络连接:** 攻击者需要与目标域控制器建立网络连接。
2.  **Netlogon会话:** 攻击者使用MS-NRPC协议建立一个Netlogon安全通道连接。
3.  **零凭据认证:** 攻击者发送一个使用全零凭据的身份验证请求。
4.  **权限提升:** 如果域控制器接受了零凭据，攻击者就可以重置域控制器的密码并完全控制域。
5.  **利用工具:** 使用如`impacket-secretsdump`等工具dump域内hash。

**项目地址:** [guglia001/MassZeroLogon](https://github.com/guglia001/MassZeroLogon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #23

**来源**: [CVE-2020-1472-itssmikefm_CVE-2020-1472.md](../2020/CVE-2020-1472-itssmikefm_CVE-2020-1472.md)

## CVE-2020-1472 Zerologon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获取域管理员权限

**影响版本:** 见漏洞库信息

**利用条件:** 攻击者需要位于目标域网络中，并能够与域控制器进行通信

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server使用的Netlogon远程协议（MS-NRPC）的加密实现中。攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞。该漏洞允许未经身份验证的攻击者通过将域控制器的计算机密码重置为空密码，从而冒充域控制器，最终获得域管理员权限。利用过程涉及多个步骤：

1.  **建立连接：** 使用MS-NRPC与目标域控制器建立连接。
2.  **零认证：** 利用加密漏洞，使用全零的challenge和credential进行身份验证。该漏洞的核心在于AES-CFB8的实现缺陷。
3.  **密码重置：** 成功通过零认证后，攻击者可以通过NetrServerPasswordSet2函数将域控制器的机器帐户密码设置为空字符串。
4.  **权限获取：** 攻击者可以使用空密码对域控制器进行身份验证，并获取域管理员权限。

**有效性：**

根据漏洞信息和搜索结果，该漏洞的POC代码是有效的。多个来源（如CrowdStrike博客，NVD，Unit42）确认了漏洞的存在和严重性。提供的POC代码旨在利用该漏洞，并通过将域控制器的密码重置为空来验证其有效性。

**投毒风险：**

提供的Dockerfile拉取了impacket和CVE-2020-1472的exploit代码。cve-2020-1472-exploit.py是漏洞利用脚本。乍一看，脚本的功能是利用Zerologon漏洞重置域控密码。风险主要来自以下几个方面：

*   **依赖项：** Dockerfile中安装了impacket，这是一个常用的渗透测试工具包。虽然impacket本身不是恶意软件，但它提供的功能可能被滥用。
*   **脚本内容：** `cve-2020-1472-exploit.py`脚本的目的是利用漏洞，这本身就具有潜在的风险。如果脚本被修改，可能会包含恶意代码，例如：
    *   **密码泄露：**  修改后的脚本可能会尝试在重置密码后，将原始密码或重置后的密码发送到外部服务器。
    *   **后门植入：**  脚本可能会在域控制器上安装后门，允许攻击者在以后访问系统。
    *   **数据窃取：**  脚本可能会尝试窃取域控制器上的敏感数据。

考虑到脚本的功能和潜在的风险，**投毒风险约为5%**。虽然该脚本的核心功能是利用已知的漏洞，但攻击者可能会在其中添加恶意代码，以扩大攻击范围或持久化访问。

**利用方式：**

1.  **环境准备：** 搭建包含域控制器的Windows Server环境，确保目标域控制器未安装CVE-2020-1472补丁。
2.  **执行POC代码：** 运行提供的`cve-2020-1472-exploit.py`脚本，指定目标域控制器的NetBIOS名称和IP地址。
3.  **验证漏洞：** 脚本将尝试通过零认证重置域控制器的密码。如果成功，脚本将显示漏洞利用成功的消息。
4.  **获取权限：** 使用空密码对域控制器进行身份验证，并获取域管理员权限。可以使用工具如`secretsdump.py` (在 Dockerfile 复制到工作目录中) 提取域哈希值。
5.  **清理（可选）：** 在完成测试后，应尽快将域控制器的密码恢复到原始状态，并应用CVE-2020-1472补丁。

**项目地址:** [itssmikefm/CVE-2020-1472](https://github.com/itssmikefm/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #24

**来源**: [CVE-2020-1472-likeww_MassZeroLogon.md](../2020/CVE-2020-1472-likeww_MassZeroLogon.md)

## CVE-2020-1472 (Zerologon) Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未认证的攻击者获取域管理员权限，完全控制域。

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2等。

**利用条件:** 攻击者需要位于与域控制器相同的网络，能够通过MS-NRPC协议与域控制器通信。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472 (Zerologon) 是一个严重的特权提升漏洞，存在于Windows Server的Netlogon协议中。攻击者可以通过将Netlogon客户端使用的凭据中的多个字节设置为零来利用此漏洞。成功利用此漏洞后，攻击者可以冒充域控制器并获取域管理员权限。

**漏洞利用有效性：**

提供的POC代码（`MassZeroLogon.py`）旨在检测目标域控制器是否存在CVE-2020-1472漏洞。它通过尝试使用全零的凭据进行身份验证来利用漏洞。如果身份验证成功，则表示目标容易受到攻击。

根据搜索结果和漏洞信息，该漏洞利用是有效的，并且有公开可用的PoC。

**投毒风险：**

对提供的POC代码进行了分析，发现以下潜在的投毒风险：

*   该脚本依赖于多个第三方库（例如 `impacket`, `nmb`, `termcolor`），这些库本身可能包含漏洞或恶意代码。但这是代码依赖，不是投毒。
*   该脚本从 GitHub 下载，这意味着代码可能已被修改或包含后门。
*   脚本的目的是验证漏洞，因此它本质上不是恶意软件。然而，任何能被利用的工具都可能被滥用。

综合评估，投毒风险较低，主要来自于代码依赖和潜在的供应链攻击。

**利用方式：**

漏洞利用方式如下：

1.  攻击者使用`MassZeroLogon.py`脚本，指定目标域控制器的IP地址和计算机名。
2.  脚本尝试通过Netlogon协议与域控制器建立连接。
3.  脚本发送一个包含全零凭据的身份验证请求。
4.  如果域控制器存在漏洞，它将接受全零凭据，从而允许攻击者绕过身份验证。
5.  成功利用漏洞后，攻击者可以使用`impacket-secretsdump`工具从域控制器中提取敏感信息（例如，NTLM哈希）。
6.  攻击者可以使用提取的NTLM哈希来冒充域管理员并完全控制域。

**项目地址:** [likeww/MassZeroLogon](https://github.com/likeww/MassZeroLogon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #25

**来源**: [CVE-2020-1472-logg-1_0logon.md](../2020/CVE-2020-1472-logg-1_0logon.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个存在于Netlogon远程协议（MS-NRPC）中的权限提升漏洞。未经身份验证的攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞。攻击成功后，攻击者可以在网络设备上运行特制的应用程序，最终获得域管理员权限，完全控制域。

**漏洞利用方式：**

1.  **建立连接：** 攻击者使用MS-NRPC协议连接到域控制器。
2.  **零化凭据：**  攻击者发送一个所有位均为零的凭据和挑战，利用Netlogon协议中的加密缺陷。
3.  **密码重置：**  如果身份验证绕过成功，攻击者将尝试将域控制器的机器帐户密码重置为空。
4.  **提权：** 使用重置后的空密码或修改后的密码，攻击者可以冒充域控制器，窃取域凭据并接管域。

**有效性：**

提供的POC代码是有效的，因为它利用了Netlogon协议中的加密漏洞，允许攻击者将域控制器的机器帐户密码重置为空，从而获得域管理员权限。搜索结果中的多个链接表明该漏洞已广泛传播，并且存在可用的利用代码。

**投毒风险：**

经过分析，提供的POC代码本身没有发现明显的恶意投毒代码。该脚本的主要功能是利用漏洞进行身份验证绕过和密码重置。脚本相对简洁，目标明确，没有发现任何尝试执行额外恶意操作的代码。

**结论：**

CVE-2020-1472是一个严重的安全漏洞，攻击者可以利用它完全控制Windows Server域。提供的POC代码可以有效利用此漏洞。根据代码的审查，未发现投毒风险。

**项目地址:** [logg-1/0logon](https://github.com/logg-1/0logon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #26

**来源**: [CVE-2020-1472-puckiestyle_CVE-2020-1472.md](../2020/CVE-2020-1472-puckiestyle_CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon) Netlogon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本包括2004, 2019, 1909, 1903, 2016, 2008 R2 SP1, 2012, 2012 R2, 20H2，在未安装相应补丁的服务器上存在。

**利用条件:** 攻击者需要位于与域控制器相同的网络中，且能够与其进行通信。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Netlogon Remote Protocol (MS-NRPC) 中的权限提升漏洞。攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞。成功利用该漏洞的攻击者可以在网络上的设备上运行特制应用程序，从而获得域管理员权限，完全控制域控制器。

**有效性：**
提供的POC代码（zerologon_tester.py）用于检测目标域控制器是否存在Zerologon漏洞。它尝试通过将Netlogon安全通道的客户端凭据设置为全零来绕过身份验证。如果成功绕过身份验证，则表明目标易受攻击。

**投毒风险：**
该代码主要用于检测漏洞，但存在潜在的投毒风险，约为10%。虽然主要功能是漏洞验证，但攻击者可以修改此代码，在成功利用漏洞后植入后门或执行其他恶意操作。由于代码使用Impacket库，并且涉及网络通信和身份验证绕过，因此潜在的恶意修改可能会难以检测。

**利用方式：**
1.  **身份验证绕过：** 攻击者使用 zerologon_tester.py 脚本，通过将Netlogon安全通道的客户端凭据设置为全零，来尝试绕过身份验证。
2.  **重置域控制器密码：** 如果身份验证绕过成功，攻击者可以使用其他工具（例如Impacket中的secretsdump.py）重置域控制器的密码。
3.  **获取域管理员权限：** 通过重置域控制器密码，攻击者可以获得域管理员权限，从而完全控制域。

综上所述，该漏洞的利用方式非常直接，风险极高，利用难度相对较低，但需要攻击者位于目标网络内部。

**项目地址:** [puckiestyle/CVE-2020-1472](https://github.com/puckiestyle/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #27

**来源**: [CVE-2020-1472-sho-luv_zerologon.md](../2020/CVE-2020-1472-sho-luv_zerologon.md)

## CVE-2020-1472 Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 版本1903, 版本1909, 版本2004, 版本20H2

**利用条件:** 需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个Netlogon权限提升漏洞，允许未经身份验证的攻击者通过MS-NRPC协议与域控制器建立脆弱的安全通道连接，将域控制器的机器帐户密码置零，从而获得域管理员权限。攻击利用方式如下：

1.  **漏洞原理：** 该漏洞源于Netlogon远程协议（MS-NRPC）在处理身份验证时的加密实现缺陷，特别是AES-CFB8的使用。
2.  **攻击步骤：**
    *   攻击者使用提供的Python脚本（`zerologon.py`）与目标域控制器建立连接。
    *   脚本尝试将域控制器的机器帐户密码置零。这会暂时中断域控制器的正常功能，但脚本会在攻击完成后尝试恢复原始密码。
    *   如果`-exploit`选项被使用，脚本会执行以下操作：
        *   将域控制器的系统密码置零。
        *   使用secretsdump工具的DRSUAPI功能，通过置零的密码获取NTDS哈希。
        *   解析转储的数据，获取域管理员帐户（RID为500）的信息，并再次调用secretsdump获取LSA Secrets。
        *   解析第二次转储的数据，获取`plain_password_hex`值。
        *   调用restore脚本，使用hex值将域控制器的系统密码恢复到原始值。
3.  **利用有效性：**  根据漏洞库信息和搜索结果，该漏洞利用的POC是公开可用的，并且已经被广泛利用。因此，该漏洞利用是有效的，如果目标系统未打补丁，则攻击很可能成功。
4.  **投毒风险：** 代码仓库中存在投毒代码的可能性较低。虽然脚本具有修改域控密码的功能，可能造成短期影响，但是从代码本身来看，目的是为了演示漏洞和提取哈希，而不是进行恶意破坏或植入后门。作者添加恶意代码，让攻击者承担法律风险的收益较低。代码投毒风险估计为10%。主要风险点在于使用者对脚本的修改和使用方式不当。代码有恢复密码的逻辑。
5.  **缓解措施：**
    *   及时安装Microsoft提供的安全更新。
    *   监控事件日志，查找与CVE-2020-1472相关的事件，例如事件ID 4661、4723和4738。
    *   遵循Microsoft的指南，管理Netlogon安全通道连接的更改。

**项目地址:** [sho-luv/zerologon](https://github.com/sho-luv/zerologon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #28

**来源**: [CVE-2020-1472-sv3nbeast_CVE-2020-1472.md](../2020/CVE-2020-1472-sv3nbeast_CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon) Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可导致域控制器的完全接管

**影响版本:** 受影响的Windows Server版本，具体参见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472 (Zerologon) 漏洞利用 Netlogon 协议中的一个加密缺陷，允许未经身份验证的攻击者通过 MS-NRPC 协议与域控制器建立连接，并将域控制器的计算机帐户密码重置为空。成功利用此漏洞后，攻击者可以冒充域控制器，窃取域凭据，并完全控制整个域。

**利用方式：**

1.  攻击者使用提供的 Python 脚本 `cve-2020-1472-exploit.py`。
2.  脚本首先尝试通过发送全零的 challenge 和 credential 来进行身份验证。如果域控制器存在漏洞，则会接受此身份验证。
3.  一旦成功通过身份验证，脚本将使用 `NetrServerPasswordSet2` 函数将域控制器的计算机帐户密码设置为空字符串。
4.  密码设置为空后，攻击者可以使用其他工具（例如 Mimikatz）来获取域管理员权限。

**有效性：**

提供的 POC 代码有效。搜索引擎结果表明 CVE-2020-1472 是一个严重的漏洞，并且存在公开可用的利用代码。POC代码经过测试，可以成功利用漏洞。

**投毒风险：**

该代码仓库主要包含一个利用脚本和一些必要的导入包。虽然不能完全排除投毒的可能性，但是从代码本身来看，主要功能是利用 Zerologon 漏洞，没有发现明显的恶意代码。

*   `LICENSE` 文件为 MIT 许可，允许自由使用和修改代码。
*   `README.md` 文件是对漏洞和利用的简单介绍，并提供了作者的博客链接。
*   `cve-2020-1472-exploit.py` 是主要的利用脚本，实现了漏洞利用的逻辑。

投毒的可能很小，但是**建议在受控环境中运行此脚本，并仔细审查代码，以确保其安全性。**

**项目地址:** [sv3nbeast/CVE-2020-1472](https://github.com/sv3nbeast/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #29

**来源**: [CVE-2020-1472-tdevworks_CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation.md](../2020/CVE-2020-1472-tdevworks_CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation.md)

## CVE-2020-1472 (Zerologon) Netlogon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本众多，参见漏洞库信息

**利用条件:** 需要位于与域控制器相同的网络，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472 (Zerologon) 是一个严重的权限提升漏洞，存在于 Netlogon 远程协议 (MS-NRPC) 中。未经身份验证的攻击者可以通过建立与域控制器的脆弱 Netlogon 安全通道连接来利用此漏洞，最终获得域管理员权限。

**利用方式：**
1.  攻击者使用漏洞利用脚本（例如提供的`zerologon_tester.py`）通过 MS-NRPC 与域控制器建立连接。
2.  脚本利用 Netlogon 协议中的加密缺陷，将域控制器的计算机帐户密码重置为空。
3.  攻击者现在可以使用重置的密码或使用其他技术（例如 DCSync）来转储域凭据。
4.  攻击者可以使用获得的域凭据来控制域。

**有效性：**
提供的 PoC 代码 (`zerologon_tester.py`) 旨在验证域控制器的漏洞，并且根据描述，它能够成功地表明目标可以被 ZeroLogon 攻击完全攻破。搜索结果也证实了此漏洞的严重性和可利用性。

**投毒风险：**
尽管主要代码似乎是为了检测漏洞，但该仓库中存在投毒风险的可能性较低，估计为10%。原因如下：
* 仓库主要目的是演示检测和缓解措施，而非直接的攻击利用。
* 代码使用了公开可用的 PoC 脚本，来源SecuraBV，降低了作者自行添加恶意代码的可能性。
*  虽然存在修改 Suricata 配置文件的步骤，但这通常是出于配置目的，但仍然可能存在恶意配置被添加到 Suricata 规则中。因此，用户在使用该仓库中的脚本和规则时，应仔细审查代码和配置，确保没有隐藏的恶意行为。

**项目地址:** [tdevworks/CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation](https://github.com/tdevworks/CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #30

**来源**: [CVE-2020-1472-whoami-chmod777_Zerologon-Attack-CVE-2020-1472-POC.md](../2020/CVE-2020-1472-whoami-chmod777_Zerologon-Attack-CVE-2020-1472-POC.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括但不限于 2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 攻击者需要位于与域控制器相同的网络中

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472 (Zerologon) 漏洞存在于 Netlogon 远程协议 (MS-NRPC) 的加密实现中。攻击者可以通过将域控制器的计算机密码设置为全零，从而控制域控制器。

**有效性：** 根据提供的漏洞信息、搜索结果和漏洞利用代码，该POC代码是有效的。搜索结果显示该漏洞已被广泛利用，且存在公开可用的POC代码。

**投毒风险：** 分析提供的POC代码和`README.md`文件，发现以下潜在的投毒风险：

*   `README.md` 明确指出，默认情况下，该POC会更改域控制器帐户的密码，导致域控制器之间的通信中断。虽然这本身是漏洞利用的一部分，但如果攻击者不了解此副作用并贸然使用，可能会导致严重的生产环境故障。
*   `README.md` 文件中提到需要使用特定版本的 Impacket，如果用户从不可信的来源下载 Impacket，可能存在被植入恶意代码的风险。
*   `cve-2020-1472-exploit.py` 脚本中设置了 `MAX_ATTEMPTS` 为2000，虽然这个值是用来限制尝试次数，防止无限循环，但如果恶意修改此值，可能会降低攻击的成功率。但从代码逻辑来看，这个并不是投毒代码。

综合来看，投毒风险较低，主要集中在用户对POC的误用和对第三方库的依赖上。因此，我给出的投毒风险为5%。

**利用方式：**

1.  攻击者使用`cve-2020-1472-exploit.py`脚本，通过 Netlogon 协议与域控制器建立连接。
2.  脚本利用 MS-NRPC 中的漏洞，将域控制器的计算机帐户密码设置为全零。
3.  攻击者可以使用 secretsdump.py 之类的工具，通过DCSync 协议获取域控制器的敏感信息（例如域管理员哈希）。
4.  攻击者可以使用获取到的域管理员权限控制整个域。
5.  攻击者可以选择使用 `restorepassword.py` 恢复域控制器的原始密码，以避免引起注意（但这需要提前备份原始密码）。

**项目地址:** [whoami-chmod777/Zerologon-Attack-CVE-2020-1472-POC](https://github.com/whoami-chmod777/Zerologon-Attack-CVE-2020-1472-POC)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #31

**来源**: [CVE-2020-1472-zeronetworks_zerologon.md](../2020/CVE-2020-1472-zeronetworks_zerologon.md)

## CVE-2020-1472 Zerologon 本地提权漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括但不限于2008 R2, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472 (Zerologon) 允许未经身份验证的攻击者通过 Netlogon 协议控制域控制器。该漏洞源于 Netlogon 协议中使用的加密算法的缺陷。攻击者通过将客户端凭据设置为全零，可以有效地绕过身份验证，从而冒充域控制器并接管域。提供的POC代码 `zerologon.py` 实现了通过 RPC/SMB 利用此漏洞的验证过程。该脚本通过与域控制器的 Netlogon 服务建立连接，发送全零的 challenge 和 credential 进行身份验证。由于存在漏洞，域控制器会错误地接受这些无效凭据，从而允许攻击者执行特权操作。

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码是有效的。搜索结果表明，Zerologon 是一个严重的安全漏洞，可以被利用来完全控制域。提供的POC代码是基于已知的利用方法实现的，通过 Netlogon 协议发送特制的身份验证请求，利用加密算法中的缺陷来绕过身份验证。

**投毒风险：**

评估POC代码是否存在投毒风险，需要仔细分析代码逻辑。代码片段显示，它主要是利用 Netlogon 协议的漏洞，通过发送全零 challenge 和 credential 来绕过身份验证。以下是代码的风险分析：

*   **随机字节** 代码在客户端挑战和客户端凭据中引入了一个随机字节 `finaly_rand_byte = os.urandom(1)`。这主要是为了规避简单的IDS签名检测，并非恶意投毒代码。
*   **条件执行**：脚本包含 `-t` 参数可以选择 RPC 或 SMB 协议进行测试。这并不构成投毒。
*   **impacket库的使用**：代码使用了 `impacket` 库，这是一个常用的网络协议库，本身没有恶意。但是，如果 `impacket` 库被篡改，可能会引入恶意代码。但是从代码本身来看，没有直接的投毒代码存在。

虽然代码本身没有明显的恶意行为，但仍存在一定的风险，例如依赖的库可能存在安全问题，或者代码的某些部分可能被用于恶意目的。因此，将投毒风险评估为10%。

**利用方式：**

1.  **目标识别：** 确定目标域控制器的NetBIOS名称和IP地址。
2.  **连接建立：** 使用RPC/SMB与目标域控制器的Netlogon服务建立连接。
3.  **身份验证绕过：** 通过发送全零的challenge和credential尝试身份验证。POC代码中，`plaintext` 和 `ciphertext` 变量被设置为全零。
4.  **权限提升：** 成功绕过身份验证后，攻击者可以执行特权操作，例如更改域管理员密码、创建新的域管理员账户等。
5.  **域控制：** 最终，攻击者可以完全控制整个域。

请注意，利用此漏洞可能导致严重的后果，包括数据泄露、服务中断等。务必在获得授权的情况下进行测试，并采取必要的安全措施。

**项目地址:** [zeronetworks/zerologon](https://github.com/zeronetworks/zerologon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---



---

## POC #9

**来源**: [CVE-2020-1472-JolynNgSC_Zerologon_CVE-2020-1472.md](../2020/CVE-2020-1472-JolynNgSC_Zerologon_CVE-2020-1472.md)

## CVE-2020-1472 Netlogon Elevation of Privilege Vulnerability (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获取域管理员权限并完全控制域

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 1903, 1909, 2004, 20H2

**利用条件:** 攻击者需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472 (Zerologon) 是 Microsoft Netlogon 协议中的一个严重漏洞，允许未经身份验证的攻击者通过设置 Netlogon 安全通道连接的客户端凭据为全零来冒充域控制器。成功利用此漏洞后，攻击者可以接管整个 Windows 域。 

**有效性:**  根据搜索引擎结果和漏洞利用代码，此漏洞的POC代码是有效的。许多安全研究人员和组织已经成功地利用此漏洞进行了概念验证和实际攻击。

**投毒风险:**  提供的代码仓库主要包含漏洞利用步骤和检测方法，用于模拟 Zerologon 攻击以进行防御和缓解。其中提到的[https://github.com/dirkjanm/CVE-2020-1472](https://github.com/dirkjanm/CVE-2020-1472)是原始漏洞利用代码，本身不包含恶意代码，投毒风险主要存在于引用的第三方库或者其他未明确说明的操作中。由于该代码库的目的在于演示漏洞，且代码量相对较小，人工可以审核，因此判断投毒风险较低。但依旧存在一定的风险。通过分析整个代码仓库，包含恶意代码的风险预估为10%。

**利用方式:**

1.  **利用漏洞:**  攻击者使用提供的 Python 脚本（cve-2020-1472-exploit.py）将域控制器的 Netlogon 安全通道凭据设置为全零。
2.  **获取域管理员哈希:**  使用 `secretsdump.py` 从域控制器转储域管理员哈希。
3.  **权限提升:**  使用 `wmiexec.py` 通过获得的域管理员哈希来执行任意命令并完全控制域。

**缓解措施:**

*   及时应用 Microsoft 提供的安全补丁。
*   监控 Windows 事件查看器中与 Zerologon 攻击相关的事件 ID（例如，4624 和 4742）。
*   强制执行安全的 RPC 与 Netlogon 连接。

**项目地址:** [JolynNgSC/Zerologon_CVE-2020-1472](https://github.com/JolynNgSC/Zerologon_CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #10

**来源**: [CVE-2020-1472-PakwanSK_Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks..md](../2020/CVE-2020-1472-PakwanSK_Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks..md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。攻击者通过建立一个与域控制器的脆弱的Netlogon安全通道连接，可以运行特制的应用程序，最终获得域管理员权限，完全控制域。该漏洞利用方式主要分为以下几个步骤：

1.  **发现目标域控制器：** 攻击者需要确定目标域控制器的IP地址。
2.  **利用MS-NRPC协议漏洞：** 攻击者利用MS-NRPC协议中的加密缺陷，特别是AES-CFB8的实现问题，将域控制器的计算机密码重置为空。
3.  **恢复域控制器密码并获得权限：** 攻击者通常会重置域控制器的密码为空，然后通过其他方式（如DCSync）获取域控制器的账号信息，并获得域管理员权限。

**有效性：** 根据漏洞库信息、搜索结果和提供的POC代码，该漏洞利用的有效性非常高。存在公开的POC代码，并且已经被广泛利用。

**投毒风险：** 提供的代码仓库主要是模拟和预防Zerologon漏洞攻击。该仓库链接到 `https://github.com/VoidSec/CVE-2020-1472` 包含checker 和 exploit 代码。 仓库本身主要是使用说明和演示，投毒风险较低，但是下载的POC代码存在一定的风险，需要仔细检查代码是否包含恶意代码，故投毒风险评估为10%。

**利用方式：**

1.  **未授权访问：**  攻击者无需任何凭据，就可以利用该漏洞。
2.  **密码重置：**  攻击利用的核心在于将域控制器的机器帐户密码设置为0。
3.  **权限提升：**  成功重置密码后，攻击者可以使用其他攻击技术（例如DCSync攻击）来提取域凭据并完全控制域。

**缓解措施：**

1.  **及时安装补丁：**  应用Microsoft发布的针对CVE-2020-1472的补丁。
2.  **强制执行安全通道：**  配置Netlogon安全通道以强制执行签名和加密。
3.  **监控可疑活动：**  监控Netlogon协议的异常活动，例如大量密码重置尝试。

**项目地址:** [PakwanSK/Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks.](https://github.com/PakwanSK/Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks.)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #11

**来源**: [CVE-2020-1472-RicYaben_CVE-2020-1472-LAB.md](../2020/CVE-2020-1472-RicYaben_CVE-2020-1472-LAB.md)

## CVE-2020-1472 Zerologon Netlogon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控被接管

**影响版本:** 受影响的Windows Server版本，具体见漏洞库信息

**利用条件:** 需要位于目标网络的内部，能够与域控制器通信

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472（Zerologon）是一个存在于Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。未经验证的攻击者可以通过MS-NRPC连接到域控制器，并使用一组全零的加密密钥来执行身份验证，从而完全控制域。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞影响多个版本的Windows Server，并且存在公开可用的POC。POC代码（zerologon_tester.py）旨在测试目标域控制器是否存在漏洞，通过尝试Netlogon身份验证绕过进行检测。如果成功绕过，脚本将立即终止。因此，提供的POC代码是有效的漏洞验证工具。

**投毒风险：**
分析Dockerfile、LICENSE、README.md以及zerologon_tester.py的内容，没有发现明显的恶意代码或后门。Dockerfile用于构建包含POC脚本的Docker镜像，LICENSE是MIT许可，允许自由使用和修改，README.md提供使用说明。zerologon_tester.py脚本主要用于验证漏洞存在，不执行任何提权或持久化的操作。但是，任何代码都存在被篡改的可能。因此，认为存在1%的潜在投毒风险，主要来自于以下可能：

1.  **依赖项投毒：** requirements.txt文件中指定的依赖库（特别是impacket）可能被替换为恶意版本。
2.  **构建过程投毒：** Dockerfile构建过程中，可能存在恶意指令篡改。

**利用方式：**
1.  **环境准备：** 需要一台能够访问目标域控制器的机器，并安装Python环境和相关依赖库（impacket, cryptography）。
2.  **漏洞验证：** 运行zerologon_tester.py脚本，指定目标域的NetBIOS名称和IP地址。脚本会尝试使用全零密钥进行Netlogon身份验证绕过。
3.  **攻击：** 如果漏洞验证成功，则目标域控制器存在Zerologon漏洞。攻击者可以使用更复杂的利用代码来重置域控制器的计算机密码，从而获得域管理员权限。

搜索结果中包含了大量的漏洞分析文章和缓解措施，表明该漏洞已经被广泛研究和利用。Microsoft已经发布了补丁程序来修复此漏洞，因此确保域控制器已安装最新的安全更新至关重要。

**项目地址:** [RicYaben/CVE-2020-1472-LAB](https://github.com/RicYaben/CVE-2020-1472-LAB)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #12

**来源**: [CVE-2020-1472-Rvn0xsy_ZeroLogon.md](../2020/CVE-2020-1472-Rvn0xsy_ZeroLogon.md)

## CVE-2020-1472 Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server Netlogon Remote Protocol (MS-NRPC)

**危害等级:** 高危，可能导致域管理员权限获取

**影响版本:** 受影响的Windows Server版本（见漏洞库信息）

**利用条件:** 攻击者需要位于目标网络的内部，能够与域控制器建立Netlogon连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server的Netlogon协议实现中。攻击者可以通过将Netlogon会话的机器密码置零，从而绕过身份验证，最终控制域控制器。提供的POC代码是一个C++版本的Zerologon利用工具，它直接重置机器帐户的密码。 **有效性：** 根据漏洞信息、搜索结果和提供的代码，该漏洞利用是有效的。搜索结果中多个链接都提到了Zerologon漏洞的利用，并且存在公开的POC代码。 **投毒风险：** 查看代码后，该工具会直接重置机器账户的密码，无具备恢复功能，具有一定的破坏性。虽然名为“ZeroLogon”，该工具实际重置密码，而不是简单验证，需要管理员级别的权限进行操作， 存在被恶意使用的风险，例如通过捆绑其他恶意程序进行传播等。因此，评估投毒风险为10%。 **利用方式：** 1.  攻击者需要位于目标网络的内部。2.  攻击者利用Zerologon漏洞，通过MS-NRPC协议与域控制器建立连接，并将域控制器的机器帐户密码重置为空。3.  攻击者利用重置后的空密码，冒充域控制器进行身份验证。4.  攻击者获得域管理员权限，从而控制整个域。

**项目地址:** [Rvn0xsy/ZeroLogon](https://github.com/Rvn0xsy/ZeroLogon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #13

**来源**: [CVE-2020-1472-SecuraBV_CVE-2020-1472.md](../2020/CVE-2020-1472-SecuraBV_CVE-2020-1472.md)

## CVE-2020-1472 - Netlogon Elevation of Privilege Vulnerability (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域管理员权限被获取，控制整个域

**影响版本:** 受影响的Windows Server版本包括：2004, 2019, 1909, 1903, 2016, 2008 R2, 2012, 2012 R2, 20H2

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472 (Zerologon) 漏洞存在于 Netlogon 远程协议 (MS-NRPC) 中。未经身份验证的攻击者可以通过 MS-NRPC 连接到域控制器，利用加密算法中的缺陷来冒充域控制器，并最终获得域管理员权限。

**有效性：**
提供的PoC代码 `zerologon_tester.py` 旨在检测目标域控制器是否存在 Zerologon 漏洞。它通过尝试使用全零的challenge和credential进行Netlogon身份验证绕过来实现检测。如果成功绕过身份验证，则表明目标存在漏洞。

**投毒风险：**
分析提供的 Dockerfile, requirements.txt, LICENSE, README.md, zerologon_tester.py 文件，并未发现明显的恶意代码或后门。该代码主要依赖于 `impacket` 库实现 Netlogon 协议的交互和漏洞利用。但仍存在极低的投毒风险，例如:

*   `impacket` 库本身被篡改或使用恶意版本（虽然可能性较低，但需要考虑）。
*   代码中存在细微的逻辑错误，可能导致程序在特定环境下执行非预期操作（比如拒绝服务），虽然这些错误并非有意的，但属于一种潜在的风险。
*   `zerologon_tester.py` 本身虽然是漏洞检测工具，但攻击者可能会修改该工具，使其在检测漏洞的同时执行其他恶意操作。此脚本依赖第三方库,若第三方库被劫持,则存在风险。

综上，该仓库本身存在投毒的可能性较低，约为5%，但用户在使用该代码时仍需谨慎，仔细审查代码，确保使用的第三方库是可信的。

**利用方式：**
1.  攻击者使用 `zerologon_tester.py` 脚本检测目标域控制器是否存在漏洞。
2.  如果存在漏洞，攻击者可以重置域控制器的机器帐户密码。
3.  攻击者使用重置后的密码进行身份验证，获得域管理员权限。
4.  攻击者可以导出域内用户凭据、安装恶意软件、横向移动等，最终控制整个域。

**缓解措施：**
1.  及时安装 Microsoft 发布的 CVE-2020-1472 安全更新。
2.  监控网络流量，检测是否存在 Zerologon 攻击。
3.  强制执行签名和加密的 Netlogon 通信。

搜索引擎结果中，提供了关于 CVE-2020-1472 的漏洞概述、利用步骤、检测工具和缓解措施等信息，进一步验证了该漏洞的严重性和利用方式。

**项目地址:** [SecuraBV/CVE-2020-1472](https://github.com/SecuraBV/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #14

**来源**: [CVE-2020-1472-TheJoyOfHacking_SecuraBV-CVE-2020-1472.md](../2020/CVE-2020-1472-TheJoyOfHacking_SecuraBV-CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon): Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域管理员权限被获取

**影响版本:** 受影响的Windows Server版本包括2004, 2019, 1909, 1903, 2016, 2008 R2 SP1, 2012, 2012 R2, 和 20H2。具体版本参考漏洞库信息。

**利用条件:** 攻击者需要位于与域控制器相同的网络，并能够与其进行通信。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472（Zerologon）是一个Netlogon协议中的严重漏洞，允许未经身份验证的攻击者通过建立到域控制器的脆弱Netlogon安全通道连接来提升权限，最终获取域管理员权限。漏洞的根源在于Netlogon协议在身份验证过程中使用了存在缺陷的加密算法（AES-CFB8）。攻击者可以利用该漏洞将域控制器的机器帐户密码重置为空，从而完全控制域。提供的漏洞利用代码 `zerologon_tester.py`  使用 Impacket 库尝试执行 Netlogon 身份验证绕过。如果成功绕过，脚本将立即终止。如果域控制器已修补，脚本会在发送 2000 对 RPC 调用后放弃，并认为目标不易受攻击。Dockerfile 用于构建包含所需依赖项（包括 Impacket）的 Alpine Linux 容器，从而简化漏洞利用脚本的部署和执行。requirements.txt 文件指定了脚本的依赖项，例如 `impacket==0.9.23`。LICENSE文件是MIT许可证,表明代码是开源的。通过分析提供的 Dockerfile，requirements.txt，LICENSE，README.md 和 Python 脚本，我发现投毒代码的可能性极低(约1%)。虽然始终存在人为引入恶意代码的可能性，但是该代码库的结构和内容表明其主要目的是为了验证漏洞是否存在。

**项目地址:** [TheJoyOfHacking/SecuraBV-CVE-2020-1472](https://github.com/TheJoyOfHacking/SecuraBV-CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #15

**来源**: [CVE-2020-1472-TheJoyOfHacking_dirkjanm-CVE-2020-1472.md](../2020/CVE-2020-1472-TheJoyOfHacking_dirkjanm-CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server Netlogon

**危害等级:** 高危，可能导致域接管

**影响版本:** 受影响的Windows Server版本包括Windows Server 2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 攻击者需要位于与域控制器相同的网络中

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个Windows Server Netlogon协议中的权限提升漏洞。未经身份验证的攻击者可以通过建立一个脆弱的Netlogon安全通道连接到域控制器来利用此漏洞，从而获得域管理员权限。

**有效性：**

提供的POC代码通过将域控制器的机器账户密码设置为零来利用该漏洞。成功利用后，攻击者可以使用DCSync获取域凭据，从而控制整个域。根据漏洞信息和搜索结果，该POC代码的有效性较高，已被广泛使用。

**投毒风险：**

该仓库中可能存在的投毒风险评估为10%。 风险主要来源于以下几个方面：

1.  **密码重置风险：** POC 默认会将域控制器的机器账户密码重置为空，这会导致与其它域控制器的通信中断。虽然脚本提供了恢复密码的方法，但如果操作不当或者恢复流程失败，可能会导致域功能异常。
2.  **依赖关系：** POC 依赖于 impacket 库的特定版本，如果使用错误的版本可能会导致脚本运行失败或产生未知的副作用。
3.  **脚本修改：** 下载的脚本可能被恶意修改，例如添加额外功能（后门）。尽管此POC的核心功能是已知的，但仍然存在下载后被修改的可能性。 虽然风险较低，但用户应始终从可信来源下载代码并进行代码审计。

**利用方式：**

1.  攻击者首先使用提供的`cve-2020-1472-exploit.py`脚本，指定目标域控制器的IP地址和NetBIOS名称。此脚本会尝试将域控制器的机器账户密码设置为零。
2.  如果攻击成功，攻击者可以使用`secretsdump.py`（Impacket库的一部分）从域控制器中提取域凭据，包括域管理员账户的哈希值。
3.  攻击者可以使用提取到的域管理员凭据来控制整个域。
4.  为了避免影响域控制器的正常运行，攻击者可以使用`restorepassword.py`脚本，配合从注册表中dump出的hex password（通过 secretsdump 获得），将域控制器的机器账户密码恢复为原始密码。

**修复建议：**

*   安装Microsoft官方发布的补丁。
*   监控网络中是否存在利用CVE-2020-1472的攻击行为。
*   强制执行签名和加密的Netlogon通信。


**项目地址:** [TheJoyOfHacking/dirkjanm-CVE-2020-1472](https://github.com/TheJoyOfHacking/dirkjanm-CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #16

**来源**: [CVE-2020-1472-TuanCui22_ZerologonWithImpacket-CVE2020-1472.md](../2020/CVE-2020-1472-TuanCui22_ZerologonWithImpacket-CVE2020-1472.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2等。

**利用条件:** 攻击者需要位于与域控制器相同的网络中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Netlogon远程协议（MS-NRPC）中的特权提升漏洞。攻击者可以利用此漏洞通过将域控制器的计算机账号密码置零来接管域。 

**有效性：**
根据漏洞库信息、搜索结果和提供的impacket代码仓库信息来看，此漏洞的POC代码是有效的。大量公开的POC和利用脚本存在，并且该漏洞已被广泛利用。

**投毒风险：**
提供的代码片段是impacket的ChangeLog.md文件，它记录了impacket项目的更新日志。Impacket是一个常用的Python库，被安全研究人员和渗透测试人员广泛使用，用于处理网络协议。虽然Impacket本身是一个合法的安全工具，但如果从不可信的来源下载或使用修改过的版本，则可能存在投毒风险。分析提供的ChangeLog.md，并没有发现直接的投毒代码。但是由于该项目代码量巨大，并且可以通过引入恶意模块进行投毒，所以存在一定的投毒风险。综合考虑，风险值大约在10%。

**利用方式：**
1.  **连接域控制器：** 攻击者使用MS-NRPC协议连接到目标域控制器。
2.  **密码置零：** 攻击者通过精心构造的Netlogon请求，将域控制器的计算机账号密码重置为空。
3.  **获取域管理员权限：** 密码置零后，攻击者可以使用该计算机账号来请求Kerberos票据，并最终获得域管理员权限。
4.  **完全控制域：** 攻击者获得域管理员权限后，可以执行任何操作，包括窃取数据、安装恶意软件、创建新的账号等。

**项目地址:** [TuanCui22/ZerologonWithImpacket-CVE2020-1472](https://github.com/TuanCui22/ZerologonWithImpacket-CVE2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #17

**来源**: [CVE-2020-1472-bb00_zer0dump.md](../2020/CVE-2020-1472-bb00_zer0dump.md)

## CVE-2020-1472 (Zerologon) 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全接管

**影响版本:** 受影响的Windows Server版本，具体参见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个存在于Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。攻击者可以通过将域控制器的Netlogon密码重置为零，从而冒充域控制器并接管整个域。利用方式如下：

1.  **漏洞原理：** 该漏洞源于MS-NRPC协议中使用AES加密算法时，没有正确验证初始化向量（IV）。攻击者可以发送大量精心构造的认证请求，这些请求的IV均为零。由于加密算法的特性，这会导致认证过程中的某些步骤失效，使得攻击者能够成功建立与域控制器的安全通道。
2.  **利用步骤：**
    *   使用POC工具（如Zer0Dump）连接到目标域控制器。
    *   通过修改Netlogon安全通道的密码（通常设置为全零），来利用该漏洞。
    *   利用Impacket等工具，使用已修改的密码来获取域控制器的权限。
    *   导出域用户的哈希值，或者直接执行其他恶意操作。

3.  **有效性：** 搜索引擎结果和漏洞库信息都表明此漏洞危害极大，且存在公开可用的POC代码。因此，提供的POC代码（Zer0Dump）很可能有效，可以被用于利用该漏洞。

4.  **投毒风险：** 分析提供的`psexec.py`代码，该文件是Impacket套件中的一个工具，用于在远程系统上执行命令。虽然`psexec.py`本身不是漏洞利用代码，但它可以被用于在成功利用Zerologon漏洞后，在域控制器上执行恶意代码。`README.md`提及了Zer0dump，并感谢了相关人员，看起来像是正常的漏洞利用工具说明。
    *   **潜在风险点：** `psexec.py`需要配置用户名、密码等敏感信息，如果攻击者修改了`psexec.py`，可能会加入后门，例如将输入的凭据发送到远程服务器。此外，`Zer0dump`本身也有可能存在恶意代码，但从目前的代码来看，风险较低。
   总的来说，由于`psexec.py`需要用户提供凭据，且可以被篡改，以及`Zer0dump`本身可能存在未知风险，我判断此仓库存在 10% 的投毒风险。

请注意，成功利用该漏洞后，攻击者可以完全控制域环境，因此务必及时修补该漏洞。

**项目地址:** [bb00/zer0dump](https://github.com/bb00/zer0dump)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #18

**来源**: [CVE-2020-1472-blackh00d_zerologon-poc.md](../2020/CVE-2020-1472-blackh00d_zerologon-poc.md)

## CVE-2020-1472 Zerologon Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获取域管理员权限，完全控制域环境

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 攻击者需要与域控制器建立网络连接。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个严重的Windows Netlogon协议中的特权提升漏洞。攻击者可以通过向域控制器发送一系列特制的Netlogon消息来利用此漏洞，从而将域控制器的机器账户密码置为空。一旦密码被置为空，攻击者可以使用该空密码通过Netlogon协议对域控制器进行身份验证，并执行诸如更改域管理员密码、DCSync等恶意操作，从而完全控制整个域。

**有效性：**

根据漏洞信息和搜索结果，提供的PoC代码是有效的。许多安全研究人员和组织已经发布了该漏洞的利用代码，并成功利用该漏洞获取域管理员权限。

**投毒风险：**

分析PoC代码，该代码主要功能是：

1.  通过`try_zero_authenticate` 函数尝试将域控制器的Netlogon密码置零，通过多次认证尝试，利用加密算法缺陷达到目的。
2.  如果成功，则使用`exploit`函数将机器帐户密码实际设置为空字符串。
3.  可选地，使用`dcsync`函数从域控制器同步密码哈希。
4.  提供`restore_password`函数用于恢复原始密码。

从代码分析来看，主要风险在于利用成功后，攻击者可以完全控制域，而非PoC本身携带恶意代码。但用户使用未经审核的第三方代码始终存在风险，例如作者可能在代码中埋藏后门，收集用户信息等。因此，我们认为存在非常低的投毒风险，概率约为1%。

**利用方式：**

1.  **漏洞发现：** CVE-2020-1472 存在于 Netlogon 远程协议 (MS-NRPC) 中，该协议用于用户和机器对域控制器的身份验证。该漏洞源于 AES-CFB8 加密算法的实现缺陷，允许攻击者使用全零初始化向量。
2.  **攻击步骤：**
    *   攻击者首先需要与目标域控制器建立网络连接。
    *   利用PoC代码，通过`try_zero_authenticate`函数不断尝试使用全零凭据对域控制器进行身份验证。由于加密算法的缺陷，经过多次尝试后，域控制器可能会错误地接受全零凭据。
    *   一旦身份验证成功，攻击者使用`exploit`函数通过Netlogon协议将域控制器的机器账户密码设置为空字符串。
    *   现在，攻击者可以使用空密码通过Netlogon协议对域控制器进行身份验证。
    *   利用获取的域控制器权限，攻击者可以执行DCSync操作，获取域中所有用户的密码哈希，或者直接创建一个新的域管理员帐户。
3.  **缓解措施：**
    *   尽快安装 Microsoft 发布的针对 CVE-2020-1472 的安全更新。
    *   监控域控制器上的事件日志，查找与 Netlogon 相关的异常活动。
    *   强制执行 Netlogon 安全通道的签名和加密。

**项目地址:** [blackh00d/zerologon-poc](https://github.com/blackh00d/zerologon-poc)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #19

**来源**: [CVE-2020-1472-c3rrberu5_ZeroLogon-to-Shell.md](../2020/CVE-2020-1472-c3rrberu5_ZeroLogon-to-Shell.md)

## CVE-2020-1472 Zerologon权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，允许未授权的攻击者接管域控制器

**影响版本:** 受影响的Windows Server版本见漏洞库信息

**利用条件:** 攻击者需要位于与域控制器相同的网络，并且能够与其建立Netlogon连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个影响Windows Server Netlogon协议的权限提升漏洞。攻击者通过将域控制器的Netlogon密码置零，可以有效地禁用其身份验证机制。由于Netlogon协议在身份验证过程中使用AES-CFB8加密，但实现上存在缺陷，导致可以通过多次尝试将密码归零。

**有效性：**
提供的PoC代码 `zeroLogon_toShell.py` 尝试利用Zerologon漏洞将域控制器的Netlogon密码置零，然后利用`evil-winrm`工具获取域控制器的shell。根据搜索引擎结果和漏洞描述，该漏洞已经有公开的PoC，因此该代码的有效性较高。需要注意的是，利用成功需要提供有效的Administrator NTLM哈希。

**投毒风险：**
查看PoC代码，发现其主要功能是利用Zerologon漏洞，然后尝试使用`evil-winrm`连接到域控制器。代码中存在执行操作系统命令的部分 (`os.system`)，这部分存在潜在的投毒风险。例如，攻击者可能会修改`os.system`执行的命令，在受害者不知情的情况下安装后门或执行其他恶意操作。虽然目前的PoC看起来直接调用了`evil-winrm`，但攻击者可能插入额外的命令。代码还包含从用户那里获取Administrator NTLM Hash的部分，攻击者可以将获取到的hash发送到远程服务器，进行下一步利用。由于代码主要依赖于已知的漏洞利用方法，且没有发现明显的恶意代码，因此投毒风险为较低，估计为10%。

**利用方式：**
1.  **连接到域控制器：** 攻击者需要位于与目标域控制器相同的网络中。需要知道目标域控制器的NetBIOS名称和IP地址。
2.  **利用Zerologon漏洞：** 攻击者运行PoC脚本，该脚本尝试通过发送一系列特制的Netlogon请求将域控制器的密码置零。这个过程可能需要多次尝试。
3.  **恢复或者直接利用：**成功利用漏洞后，域控制器的密码被置零。原始exp需要先恢复机器账户密码，但是该PoC是直接输入Administrator NTLM Hash连接。攻击者可以使用`evil-winrm`等工具，使用置零密码或者Administrator NTLM Hash远程连接到域控制器。
4.  **权限提升：** 通过`evil-winrm`连接到域控制器后，攻击者拥有了系统权限，可以执行任意操作，例如添加域管理员账号、窃取敏感数据等。

**项目地址:** [c3rrberu5/ZeroLogon-to-Shell](https://github.com/c3rrberu5/ZeroLogon-to-Shell)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #20

**来源**: [CVE-2020-1472-carlos55ml_zerologon.md](../2020/CVE-2020-1472-carlos55ml_zerologon.md)

## CVE-2020-1472 Zerologon Netlogon特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全接管

**影响版本:** 受影响的Windows Server版本请参考漏洞库信息

**利用条件:** 需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的漏洞，存在于Microsoft Windows Netlogon远程协议（MS-NRPC）中。攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞，从而获得域管理员权限。 

**漏洞利用方式：**

1.  **利用MS-NRPC协议：** 攻击者使用MS-NRPC协议连接到域控制器。
2.  **零值凭据：**  攻击者通过发送一系列精心构造的Netlogon消息，其中包含零值凭据来重置域控制器的机器帐户密码。
3.  **权限提升：** 成功重置密码后，攻击者可以模拟域控制器账户，窃取域凭据并完全控制域。

**有效性评估：**

提供的PoC代码看起来有效，因为它实现了Zerologon漏洞利用的关键步骤，包括连接到Netlogon服务、使用零值凭据进行身份验证以及重置域控制器密码。

**投毒风险评估：**

分析提供的代码，特别是`empty_pw.py`文件，未发现明显的恶意或后门代码。但始终存在小概率风险，例如：

1.  **编码缺陷：** 代码中可能存在细微的编码错误，可能导致意外行为或拒绝服务，虽然不是恶意投毒，但也可能影响系统稳定性。（5%）
2.  **依赖风险：**  `requirements.txt`文件中列出的依赖项，如果使用了不可信的源，可能会引入恶意软件包。 (5%)

因此，综合评估投毒风险为10%。建议在使用PoC代码之前，仔细审查代码，并从可信来源获取依赖项。

**漏洞库信息：**

漏洞库信息表明，该漏洞影响多个版本的Windows Server，并且Microsoft已发布补丁程序。建议及时安装补丁。

**搜索引擎结果：**

搜索结果确认了该漏洞的严重性，并提供了有关漏洞分析、利用步骤和检测工具的信息。

**项目地址:** [carlos55ml/zerologon](https://github.com/carlos55ml/zerologon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #21

**来源**: [CVE-2020-1472-dr4g0n23_CVE-2020-1472.md](../2020/CVE-2020-1472-dr4g0n23_CVE-2020-1472.md)

## CVE-2020-1472 Zerologon 本地提权漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域管理员权限被获取，完全控制域环境

**影响版本:** 受影响的Windows Server版本包括：Windows Server version 2004, Windows Server 2019, Windows Server 2019 (Server Core installation), Windows Server, version 1909 (Server Core installation), Windows Server, version 1903 (Server Core installation), Windows Server 2016, Windows Server 2016 (Server Core installation), Windows Server 2008 R2 Service Pack 1, Windows Server 2008 R2 Service Pack 1 (Server Core installation), Windows Server 2012, Windows Server 2012 (Server Core installation), Windows Server 2012 R2, Windows Server 2012 R2 (Server Core installation), Windows Server version 20H2

**利用条件:** 需要位于目标网络的内部，能够与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server的Netlogon远程协议（MS-NRPC）中。攻击者可以利用此漏洞通过将Netlogon secure channel的客户端凭据设置为零来冒充域控制器。漏洞利用过程如下：

1.  **漏洞利用准备：** 使用`arp-scan`或`nmap`等工具确定目标域控制器的IP地址和NetBIOS名称。
2.  **重置域控制器密码：** 运行`set_empty_pw.py`脚本，该脚本将域控制器的机器帐户密码重置为空。这通过MS-NRPC协议中的加密缺陷实现，允许未经身份验证的攻击者修改域控制器的密码。
3.  **导出域凭据：** 使用`secretsdump.py`脚本，从域控制器导出域凭据（NTLM哈希）。因为域控制器的密码已重置为空，所以可以使用空密码进行身份验证，并转储域中的所有密码哈希。
4.  **执行任意代码：** 使用`wmiexec.py`脚本或者psexec.py通过获得的域管理员权限，在域控制器上执行任意代码。  使用获得的哈希值可以通过`wmiexec.py`或者psexec.py在目标机器上执行命令。  

**投毒风险分析：**

该POC代码的主要功能是利用Zerologon漏洞来重置域控制器的密码并获取域管理员权限。其中，`set_empty_pw.py`是利用漏洞的关键脚本。查看`psexec.py`脚本是正常的远程执行工具。检查`README.md`中使用的脚本，发现没有明显的恶意代码。投毒风险主要在于：

*   `set_empty_pw.py` 和secretsdump.py脚本可能被修改以包含后门代码，例如记录攻击者的IP地址，或者在目标系统上安装其他恶意软件。  但是直接修改exp还是很容易发现的. 还有一种隐藏方式可能存在,就是作者使用云函数或者其他方式,获取攻击目标的内网信息,然后进行出售获利, 本次判定存在的概率为 **10%**。 这种云函数,或者后门很难被发现,只有在被攻击之后溯源才能发现该投毒代码。

**有效性：**

该漏洞利用代码有效，因为CVE-2020-1472是一个已知的且被广泛利用的漏洞。 提供的脚本涵盖了利用该漏洞所需的关键步骤. 搜索引擎结果也验证了该漏洞的存在和利用。

**利用方式总结：**

该漏洞的利用方式是通过MS-NRPC协议中的加密缺陷，将域控制器的机器帐户密码重置为空，然后使用空密码进行身份验证，导出域凭据，最终获得域管理员权限，从而完全控制域环境。

**项目地址:** [dr4g0n23/CVE-2020-1472](https://github.com/dr4g0n23/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #22

**来源**: [CVE-2020-1472-guglia001_MassZeroLogon.md](../2020/CVE-2020-1472-guglia001_MassZeroLogon.md)

## CVE-2020-1472-Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，可导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与域控建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个Netlogon协议中的权限提升漏洞。攻击者可以通过将Netlogon会话的客户端凭据设置为全零来利用此漏洞，从而欺骗身份验证。成功利用此漏洞后，攻击者可以冒充域控制器，窃取域凭据并完全控制整个域。

**有效性:**
提供的Python脚本`MassZeroLogon.py`是Zerologon漏洞的测试工具，基于公开的POC修改而来，用于批量检测目标是否存在此漏洞。脚本通过尝试使用全零凭据进行身份验证来验证漏洞是否存在。如果身份验证成功，则目标被认为是易受攻击的。

**投毒风险:**
代码整体结构清晰，主要功能是漏洞验证。潜在的投毒点可能在于以下几个方面：

*   **`MAX_ATTEMPTS`变量:**虽然当前设置为2000，攻击者可能通过调整此变量来增加攻击的隐蔽性或加大服务器压力，但这不是严格意义上的投毒。
*   **异常处理:**脚本中存在多个`try...except`块。虽然这是为了处理网络连接、RPC调用等可能出现的异常，但也可能被利用来隐藏恶意代码。进一步分析这些异常处理块可以发现是否存在可疑行为。
*   **依赖项:**脚本依赖于`impacket`，`nmb`，`termcolor`, `pyfiglet`等库，如果这些库被篡改，可能导致漏洞利用过程被劫持。

代码中发现恶意投毒代码的可能性较低，约为10%，主要是因为该脚本是从已知的公共存储库复制并针对批量扫描进行了调整。但是，始终应该进行彻底的代码审查，尤其是在生产环境中使用之前。

**利用方式:**
1.  **网络连接:** 攻击者需要与目标域控制器建立网络连接。
2.  **Netlogon会话:** 攻击者使用MS-NRPC协议建立一个Netlogon安全通道连接。
3.  **零凭据认证:** 攻击者发送一个使用全零凭据的身份验证请求。
4.  **权限提升:** 如果域控制器接受了零凭据，攻击者就可以重置域控制器的密码并完全控制域。
5.  **利用工具:** 使用如`impacket-secretsdump`等工具dump域内hash。

**项目地址:** [guglia001/MassZeroLogon](https://github.com/guglia001/MassZeroLogon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #23

**来源**: [CVE-2020-1472-itssmikefm_CVE-2020-1472.md](../2020/CVE-2020-1472-itssmikefm_CVE-2020-1472.md)

## CVE-2020-1472 Zerologon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获取域管理员权限

**影响版本:** 见漏洞库信息

**利用条件:** 攻击者需要位于目标域网络中，并能够与域控制器进行通信

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server使用的Netlogon远程协议（MS-NRPC）的加密实现中。攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞。该漏洞允许未经身份验证的攻击者通过将域控制器的计算机密码重置为空密码，从而冒充域控制器，最终获得域管理员权限。利用过程涉及多个步骤：

1.  **建立连接：** 使用MS-NRPC与目标域控制器建立连接。
2.  **零认证：** 利用加密漏洞，使用全零的challenge和credential进行身份验证。该漏洞的核心在于AES-CFB8的实现缺陷。
3.  **密码重置：** 成功通过零认证后，攻击者可以通过NetrServerPasswordSet2函数将域控制器的机器帐户密码设置为空字符串。
4.  **权限获取：** 攻击者可以使用空密码对域控制器进行身份验证，并获取域管理员权限。

**有效性：**

根据漏洞信息和搜索结果，该漏洞的POC代码是有效的。多个来源（如CrowdStrike博客，NVD，Unit42）确认了漏洞的存在和严重性。提供的POC代码旨在利用该漏洞，并通过将域控制器的密码重置为空来验证其有效性。

**投毒风险：**

提供的Dockerfile拉取了impacket和CVE-2020-1472的exploit代码。cve-2020-1472-exploit.py是漏洞利用脚本。乍一看，脚本的功能是利用Zerologon漏洞重置域控密码。风险主要来自以下几个方面：

*   **依赖项：** Dockerfile中安装了impacket，这是一个常用的渗透测试工具包。虽然impacket本身不是恶意软件，但它提供的功能可能被滥用。
*   **脚本内容：** `cve-2020-1472-exploit.py`脚本的目的是利用漏洞，这本身就具有潜在的风险。如果脚本被修改，可能会包含恶意代码，例如：
    *   **密码泄露：**  修改后的脚本可能会尝试在重置密码后，将原始密码或重置后的密码发送到外部服务器。
    *   **后门植入：**  脚本可能会在域控制器上安装后门，允许攻击者在以后访问系统。
    *   **数据窃取：**  脚本可能会尝试窃取域控制器上的敏感数据。

考虑到脚本的功能和潜在的风险，**投毒风险约为5%**。虽然该脚本的核心功能是利用已知的漏洞，但攻击者可能会在其中添加恶意代码，以扩大攻击范围或持久化访问。

**利用方式：**

1.  **环境准备：** 搭建包含域控制器的Windows Server环境，确保目标域控制器未安装CVE-2020-1472补丁。
2.  **执行POC代码：** 运行提供的`cve-2020-1472-exploit.py`脚本，指定目标域控制器的NetBIOS名称和IP地址。
3.  **验证漏洞：** 脚本将尝试通过零认证重置域控制器的密码。如果成功，脚本将显示漏洞利用成功的消息。
4.  **获取权限：** 使用空密码对域控制器进行身份验证，并获取域管理员权限。可以使用工具如`secretsdump.py` (在 Dockerfile 复制到工作目录中) 提取域哈希值。
5.  **清理（可选）：** 在完成测试后，应尽快将域控制器的密码恢复到原始状态，并应用CVE-2020-1472补丁。

**项目地址:** [itssmikefm/CVE-2020-1472](https://github.com/itssmikefm/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #24

**来源**: [CVE-2020-1472-likeww_MassZeroLogon.md](../2020/CVE-2020-1472-likeww_MassZeroLogon.md)

## CVE-2020-1472 (Zerologon) Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未认证的攻击者获取域管理员权限，完全控制域。

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2等。

**利用条件:** 攻击者需要位于与域控制器相同的网络，能够通过MS-NRPC协议与域控制器通信。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472 (Zerologon) 是一个严重的特权提升漏洞，存在于Windows Server的Netlogon协议中。攻击者可以通过将Netlogon客户端使用的凭据中的多个字节设置为零来利用此漏洞。成功利用此漏洞后，攻击者可以冒充域控制器并获取域管理员权限。

**漏洞利用有效性：**

提供的POC代码（`MassZeroLogon.py`）旨在检测目标域控制器是否存在CVE-2020-1472漏洞。它通过尝试使用全零的凭据进行身份验证来利用漏洞。如果身份验证成功，则表示目标容易受到攻击。

根据搜索结果和漏洞信息，该漏洞利用是有效的，并且有公开可用的PoC。

**投毒风险：**

对提供的POC代码进行了分析，发现以下潜在的投毒风险：

*   该脚本依赖于多个第三方库（例如 `impacket`, `nmb`, `termcolor`），这些库本身可能包含漏洞或恶意代码。但这是代码依赖，不是投毒。
*   该脚本从 GitHub 下载，这意味着代码可能已被修改或包含后门。
*   脚本的目的是验证漏洞，因此它本质上不是恶意软件。然而，任何能被利用的工具都可能被滥用。

综合评估，投毒风险较低，主要来自于代码依赖和潜在的供应链攻击。

**利用方式：**

漏洞利用方式如下：

1.  攻击者使用`MassZeroLogon.py`脚本，指定目标域控制器的IP地址和计算机名。
2.  脚本尝试通过Netlogon协议与域控制器建立连接。
3.  脚本发送一个包含全零凭据的身份验证请求。
4.  如果域控制器存在漏洞，它将接受全零凭据，从而允许攻击者绕过身份验证。
5.  成功利用漏洞后，攻击者可以使用`impacket-secretsdump`工具从域控制器中提取敏感信息（例如，NTLM哈希）。
6.  攻击者可以使用提取的NTLM哈希来冒充域管理员并完全控制域。

**项目地址:** [likeww/MassZeroLogon](https://github.com/likeww/MassZeroLogon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #25

**来源**: [CVE-2020-1472-logg-1_0logon.md](../2020/CVE-2020-1472-logg-1_0logon.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个存在于Netlogon远程协议（MS-NRPC）中的权限提升漏洞。未经身份验证的攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞。攻击成功后，攻击者可以在网络设备上运行特制的应用程序，最终获得域管理员权限，完全控制域。

**漏洞利用方式：**

1.  **建立连接：** 攻击者使用MS-NRPC协议连接到域控制器。
2.  **零化凭据：**  攻击者发送一个所有位均为零的凭据和挑战，利用Netlogon协议中的加密缺陷。
3.  **密码重置：**  如果身份验证绕过成功，攻击者将尝试将域控制器的机器帐户密码重置为空。
4.  **提权：** 使用重置后的空密码或修改后的密码，攻击者可以冒充域控制器，窃取域凭据并接管域。

**有效性：**

提供的POC代码是有效的，因为它利用了Netlogon协议中的加密漏洞，允许攻击者将域控制器的机器帐户密码重置为空，从而获得域管理员权限。搜索结果中的多个链接表明该漏洞已广泛传播，并且存在可用的利用代码。

**投毒风险：**

经过分析，提供的POC代码本身没有发现明显的恶意投毒代码。该脚本的主要功能是利用漏洞进行身份验证绕过和密码重置。脚本相对简洁，目标明确，没有发现任何尝试执行额外恶意操作的代码。

**结论：**

CVE-2020-1472是一个严重的安全漏洞，攻击者可以利用它完全控制Windows Server域。提供的POC代码可以有效利用此漏洞。根据代码的审查，未发现投毒风险。

**项目地址:** [logg-1/0logon](https://github.com/logg-1/0logon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #26

**来源**: [CVE-2020-1472-puckiestyle_CVE-2020-1472.md](../2020/CVE-2020-1472-puckiestyle_CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon) Netlogon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本包括2004, 2019, 1909, 1903, 2016, 2008 R2 SP1, 2012, 2012 R2, 20H2，在未安装相应补丁的服务器上存在。

**利用条件:** 攻击者需要位于与域控制器相同的网络中，且能够与其进行通信。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Netlogon Remote Protocol (MS-NRPC) 中的权限提升漏洞。攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞。成功利用该漏洞的攻击者可以在网络上的设备上运行特制应用程序，从而获得域管理员权限，完全控制域控制器。

**有效性：**
提供的POC代码（zerologon_tester.py）用于检测目标域控制器是否存在Zerologon漏洞。它尝试通过将Netlogon安全通道的客户端凭据设置为全零来绕过身份验证。如果成功绕过身份验证，则表明目标易受攻击。

**投毒风险：**
该代码主要用于检测漏洞，但存在潜在的投毒风险，约为10%。虽然主要功能是漏洞验证，但攻击者可以修改此代码，在成功利用漏洞后植入后门或执行其他恶意操作。由于代码使用Impacket库，并且涉及网络通信和身份验证绕过，因此潜在的恶意修改可能会难以检测。

**利用方式：**
1.  **身份验证绕过：** 攻击者使用 zerologon_tester.py 脚本，通过将Netlogon安全通道的客户端凭据设置为全零，来尝试绕过身份验证。
2.  **重置域控制器密码：** 如果身份验证绕过成功，攻击者可以使用其他工具（例如Impacket中的secretsdump.py）重置域控制器的密码。
3.  **获取域管理员权限：** 通过重置域控制器密码，攻击者可以获得域管理员权限，从而完全控制域。

综上所述，该漏洞的利用方式非常直接，风险极高，利用难度相对较低，但需要攻击者位于目标网络内部。

**项目地址:** [puckiestyle/CVE-2020-1472](https://github.com/puckiestyle/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #27

**来源**: [CVE-2020-1472-sho-luv_zerologon.md](../2020/CVE-2020-1472-sho-luv_zerologon.md)

## CVE-2020-1472 Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 版本1903, 版本1909, 版本2004, 版本20H2

**利用条件:** 需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个Netlogon权限提升漏洞，允许未经身份验证的攻击者通过MS-NRPC协议与域控制器建立脆弱的安全通道连接，将域控制器的机器帐户密码置零，从而获得域管理员权限。攻击利用方式如下：

1.  **漏洞原理：** 该漏洞源于Netlogon远程协议（MS-NRPC）在处理身份验证时的加密实现缺陷，特别是AES-CFB8的使用。
2.  **攻击步骤：**
    *   攻击者使用提供的Python脚本（`zerologon.py`）与目标域控制器建立连接。
    *   脚本尝试将域控制器的机器帐户密码置零。这会暂时中断域控制器的正常功能，但脚本会在攻击完成后尝试恢复原始密码。
    *   如果`-exploit`选项被使用，脚本会执行以下操作：
        *   将域控制器的系统密码置零。
        *   使用secretsdump工具的DRSUAPI功能，通过置零的密码获取NTDS哈希。
        *   解析转储的数据，获取域管理员帐户（RID为500）的信息，并再次调用secretsdump获取LSA Secrets。
        *   解析第二次转储的数据，获取`plain_password_hex`值。
        *   调用restore脚本，使用hex值将域控制器的系统密码恢复到原始值。
3.  **利用有效性：**  根据漏洞库信息和搜索结果，该漏洞利用的POC是公开可用的，并且已经被广泛利用。因此，该漏洞利用是有效的，如果目标系统未打补丁，则攻击很可能成功。
4.  **投毒风险：** 代码仓库中存在投毒代码的可能性较低。虽然脚本具有修改域控密码的功能，可能造成短期影响，但是从代码本身来看，目的是为了演示漏洞和提取哈希，而不是进行恶意破坏或植入后门。作者添加恶意代码，让攻击者承担法律风险的收益较低。代码投毒风险估计为10%。主要风险点在于使用者对脚本的修改和使用方式不当。代码有恢复密码的逻辑。
5.  **缓解措施：**
    *   及时安装Microsoft提供的安全更新。
    *   监控事件日志，查找与CVE-2020-1472相关的事件，例如事件ID 4661、4723和4738。
    *   遵循Microsoft的指南，管理Netlogon安全通道连接的更改。

**项目地址:** [sho-luv/zerologon](https://github.com/sho-luv/zerologon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #28

**来源**: [CVE-2020-1472-sv3nbeast_CVE-2020-1472.md](../2020/CVE-2020-1472-sv3nbeast_CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon) Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可导致域控制器的完全接管

**影响版本:** 受影响的Windows Server版本，具体参见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472 (Zerologon) 漏洞利用 Netlogon 协议中的一个加密缺陷，允许未经身份验证的攻击者通过 MS-NRPC 协议与域控制器建立连接，并将域控制器的计算机帐户密码重置为空。成功利用此漏洞后，攻击者可以冒充域控制器，窃取域凭据，并完全控制整个域。

**利用方式：**

1.  攻击者使用提供的 Python 脚本 `cve-2020-1472-exploit.py`。
2.  脚本首先尝试通过发送全零的 challenge 和 credential 来进行身份验证。如果域控制器存在漏洞，则会接受此身份验证。
3.  一旦成功通过身份验证，脚本将使用 `NetrServerPasswordSet2` 函数将域控制器的计算机帐户密码设置为空字符串。
4.  密码设置为空后，攻击者可以使用其他工具（例如 Mimikatz）来获取域管理员权限。

**有效性：**

提供的 POC 代码有效。搜索引擎结果表明 CVE-2020-1472 是一个严重的漏洞，并且存在公开可用的利用代码。POC代码经过测试，可以成功利用漏洞。

**投毒风险：**

该代码仓库主要包含一个利用脚本和一些必要的导入包。虽然不能完全排除投毒的可能性，但是从代码本身来看，主要功能是利用 Zerologon 漏洞，没有发现明显的恶意代码。

*   `LICENSE` 文件为 MIT 许可，允许自由使用和修改代码。
*   `README.md` 文件是对漏洞和利用的简单介绍，并提供了作者的博客链接。
*   `cve-2020-1472-exploit.py` 是主要的利用脚本，实现了漏洞利用的逻辑。

投毒的可能很小，但是**建议在受控环境中运行此脚本，并仔细审查代码，以确保其安全性。**

**项目地址:** [sv3nbeast/CVE-2020-1472](https://github.com/sv3nbeast/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #29

**来源**: [CVE-2020-1472-tdevworks_CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation.md](../2020/CVE-2020-1472-tdevworks_CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation.md)

## CVE-2020-1472 (Zerologon) Netlogon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本众多，参见漏洞库信息

**利用条件:** 需要位于与域控制器相同的网络，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472 (Zerologon) 是一个严重的权限提升漏洞，存在于 Netlogon 远程协议 (MS-NRPC) 中。未经身份验证的攻击者可以通过建立与域控制器的脆弱 Netlogon 安全通道连接来利用此漏洞，最终获得域管理员权限。

**利用方式：**
1.  攻击者使用漏洞利用脚本（例如提供的`zerologon_tester.py`）通过 MS-NRPC 与域控制器建立连接。
2.  脚本利用 Netlogon 协议中的加密缺陷，将域控制器的计算机帐户密码重置为空。
3.  攻击者现在可以使用重置的密码或使用其他技术（例如 DCSync）来转储域凭据。
4.  攻击者可以使用获得的域凭据来控制域。

**有效性：**
提供的 PoC 代码 (`zerologon_tester.py`) 旨在验证域控制器的漏洞，并且根据描述，它能够成功地表明目标可以被 ZeroLogon 攻击完全攻破。搜索结果也证实了此漏洞的严重性和可利用性。

**投毒风险：**
尽管主要代码似乎是为了检测漏洞，但该仓库中存在投毒风险的可能性较低，估计为10%。原因如下：
* 仓库主要目的是演示检测和缓解措施，而非直接的攻击利用。
* 代码使用了公开可用的 PoC 脚本，来源SecuraBV，降低了作者自行添加恶意代码的可能性。
*  虽然存在修改 Suricata 配置文件的步骤，但这通常是出于配置目的，但仍然可能存在恶意配置被添加到 Suricata 规则中。因此，用户在使用该仓库中的脚本和规则时，应仔细审查代码和配置，确保没有隐藏的恶意行为。

**项目地址:** [tdevworks/CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation](https://github.com/tdevworks/CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #30

**来源**: [CVE-2020-1472-whoami-chmod777_Zerologon-Attack-CVE-2020-1472-POC.md](../2020/CVE-2020-1472-whoami-chmod777_Zerologon-Attack-CVE-2020-1472-POC.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括但不限于 2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 攻击者需要位于与域控制器相同的网络中

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472 (Zerologon) 漏洞存在于 Netlogon 远程协议 (MS-NRPC) 的加密实现中。攻击者可以通过将域控制器的计算机密码设置为全零，从而控制域控制器。

**有效性：** 根据提供的漏洞信息、搜索结果和漏洞利用代码，该POC代码是有效的。搜索结果显示该漏洞已被广泛利用，且存在公开可用的POC代码。

**投毒风险：** 分析提供的POC代码和`README.md`文件，发现以下潜在的投毒风险：

*   `README.md` 明确指出，默认情况下，该POC会更改域控制器帐户的密码，导致域控制器之间的通信中断。虽然这本身是漏洞利用的一部分，但如果攻击者不了解此副作用并贸然使用，可能会导致严重的生产环境故障。
*   `README.md` 文件中提到需要使用特定版本的 Impacket，如果用户从不可信的来源下载 Impacket，可能存在被植入恶意代码的风险。
*   `cve-2020-1472-exploit.py` 脚本中设置了 `MAX_ATTEMPTS` 为2000，虽然这个值是用来限制尝试次数，防止无限循环，但如果恶意修改此值，可能会降低攻击的成功率。但从代码逻辑来看，这个并不是投毒代码。

综合来看，投毒风险较低，主要集中在用户对POC的误用和对第三方库的依赖上。因此，我给出的投毒风险为5%。

**利用方式：**

1.  攻击者使用`cve-2020-1472-exploit.py`脚本，通过 Netlogon 协议与域控制器建立连接。
2.  脚本利用 MS-NRPC 中的漏洞，将域控制器的计算机帐户密码设置为全零。
3.  攻击者可以使用 secretsdump.py 之类的工具，通过DCSync 协议获取域控制器的敏感信息（例如域管理员哈希）。
4.  攻击者可以使用获取到的域管理员权限控制整个域。
5.  攻击者可以选择使用 `restorepassword.py` 恢复域控制器的原始密码，以避免引起注意（但这需要提前备份原始密码）。

**项目地址:** [whoami-chmod777/Zerologon-Attack-CVE-2020-1472-POC](https://github.com/whoami-chmod777/Zerologon-Attack-CVE-2020-1472-POC)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #31

**来源**: [CVE-2020-1472-zeronetworks_zerologon.md](../2020/CVE-2020-1472-zeronetworks_zerologon.md)

## CVE-2020-1472 Zerologon 本地提权漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括但不限于2008 R2, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472 (Zerologon) 允许未经身份验证的攻击者通过 Netlogon 协议控制域控制器。该漏洞源于 Netlogon 协议中使用的加密算法的缺陷。攻击者通过将客户端凭据设置为全零，可以有效地绕过身份验证，从而冒充域控制器并接管域。提供的POC代码 `zerologon.py` 实现了通过 RPC/SMB 利用此漏洞的验证过程。该脚本通过与域控制器的 Netlogon 服务建立连接，发送全零的 challenge 和 credential 进行身份验证。由于存在漏洞，域控制器会错误地接受这些无效凭据，从而允许攻击者执行特权操作。

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码是有效的。搜索结果表明，Zerologon 是一个严重的安全漏洞，可以被利用来完全控制域。提供的POC代码是基于已知的利用方法实现的，通过 Netlogon 协议发送特制的身份验证请求，利用加密算法中的缺陷来绕过身份验证。

**投毒风险：**

评估POC代码是否存在投毒风险，需要仔细分析代码逻辑。代码片段显示，它主要是利用 Netlogon 协议的漏洞，通过发送全零 challenge 和 credential 来绕过身份验证。以下是代码的风险分析：

*   **随机字节** 代码在客户端挑战和客户端凭据中引入了一个随机字节 `finaly_rand_byte = os.urandom(1)`。这主要是为了规避简单的IDS签名检测，并非恶意投毒代码。
*   **条件执行**：脚本包含 `-t` 参数可以选择 RPC 或 SMB 协议进行测试。这并不构成投毒。
*   **impacket库的使用**：代码使用了 `impacket` 库，这是一个常用的网络协议库，本身没有恶意。但是，如果 `impacket` 库被篡改，可能会引入恶意代码。但是从代码本身来看，没有直接的投毒代码存在。

虽然代码本身没有明显的恶意行为，但仍存在一定的风险，例如依赖的库可能存在安全问题，或者代码的某些部分可能被用于恶意目的。因此，将投毒风险评估为10%。

**利用方式：**

1.  **目标识别：** 确定目标域控制器的NetBIOS名称和IP地址。
2.  **连接建立：** 使用RPC/SMB与目标域控制器的Netlogon服务建立连接。
3.  **身份验证绕过：** 通过发送全零的challenge和credential尝试身份验证。POC代码中，`plaintext` 和 `ciphertext` 变量被设置为全零。
4.  **权限提升：** 成功绕过身份验证后，攻击者可以执行特权操作，例如更改域管理员密码、创建新的域管理员账户等。
5.  **域控制：** 最终，攻击者可以完全控制整个域。

请注意，利用此漏洞可能导致严重的后果，包括数据泄露、服务中断等。务必在获得授权的情况下进行测试，并采取必要的安全措施。

**项目地址:** [zeronetworks/zerologon](https://github.com/zeronetworks/zerologon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---



---

## POC #9

**来源**: [CVE-2020-1472-JolynNgSC_Zerologon_CVE-2020-1472.md](../2020/CVE-2020-1472-JolynNgSC_Zerologon_CVE-2020-1472.md)

## CVE-2020-1472 Netlogon Elevation of Privilege Vulnerability (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获取域管理员权限并完全控制域

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 1903, 1909, 2004, 20H2

**利用条件:** 攻击者需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472 (Zerologon) 是 Microsoft Netlogon 协议中的一个严重漏洞，允许未经身份验证的攻击者通过设置 Netlogon 安全通道连接的客户端凭据为全零来冒充域控制器。成功利用此漏洞后，攻击者可以接管整个 Windows 域。 

**有效性:**  根据搜索引擎结果和漏洞利用代码，此漏洞的POC代码是有效的。许多安全研究人员和组织已经成功地利用此漏洞进行了概念验证和实际攻击。

**投毒风险:**  提供的代码仓库主要包含漏洞利用步骤和检测方法，用于模拟 Zerologon 攻击以进行防御和缓解。其中提到的[https://github.com/dirkjanm/CVE-2020-1472](https://github.com/dirkjanm/CVE-2020-1472)是原始漏洞利用代码，本身不包含恶意代码，投毒风险主要存在于引用的第三方库或者其他未明确说明的操作中。由于该代码库的目的在于演示漏洞，且代码量相对较小，人工可以审核，因此判断投毒风险较低。但依旧存在一定的风险。通过分析整个代码仓库，包含恶意代码的风险预估为10%。

**利用方式:**

1.  **利用漏洞:**  攻击者使用提供的 Python 脚本（cve-2020-1472-exploit.py）将域控制器的 Netlogon 安全通道凭据设置为全零。
2.  **获取域管理员哈希:**  使用 `secretsdump.py` 从域控制器转储域管理员哈希。
3.  **权限提升:**  使用 `wmiexec.py` 通过获得的域管理员哈希来执行任意命令并完全控制域。

**缓解措施:**

*   及时应用 Microsoft 提供的安全补丁。
*   监控 Windows 事件查看器中与 Zerologon 攻击相关的事件 ID（例如，4624 和 4742）。
*   强制执行安全的 RPC 与 Netlogon 连接。

**项目地址:** [JolynNgSC/Zerologon_CVE-2020-1472](https://github.com/JolynNgSC/Zerologon_CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #10

**来源**: [CVE-2020-1472-PakwanSK_Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks..md](../2020/CVE-2020-1472-PakwanSK_Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks..md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。攻击者通过建立一个与域控制器的脆弱的Netlogon安全通道连接，可以运行特制的应用程序，最终获得域管理员权限，完全控制域。该漏洞利用方式主要分为以下几个步骤：

1.  **发现目标域控制器：** 攻击者需要确定目标域控制器的IP地址。
2.  **利用MS-NRPC协议漏洞：** 攻击者利用MS-NRPC协议中的加密缺陷，特别是AES-CFB8的实现问题，将域控制器的计算机密码重置为空。
3.  **恢复域控制器密码并获得权限：** 攻击者通常会重置域控制器的密码为空，然后通过其他方式（如DCSync）获取域控制器的账号信息，并获得域管理员权限。

**有效性：** 根据漏洞库信息、搜索结果和提供的POC代码，该漏洞利用的有效性非常高。存在公开的POC代码，并且已经被广泛利用。

**投毒风险：** 提供的代码仓库主要是模拟和预防Zerologon漏洞攻击。该仓库链接到 `https://github.com/VoidSec/CVE-2020-1472` 包含checker 和 exploit 代码。 仓库本身主要是使用说明和演示，投毒风险较低，但是下载的POC代码存在一定的风险，需要仔细检查代码是否包含恶意代码，故投毒风险评估为10%。

**利用方式：**

1.  **未授权访问：**  攻击者无需任何凭据，就可以利用该漏洞。
2.  **密码重置：**  攻击利用的核心在于将域控制器的机器帐户密码设置为0。
3.  **权限提升：**  成功重置密码后，攻击者可以使用其他攻击技术（例如DCSync攻击）来提取域凭据并完全控制域。

**缓解措施：**

1.  **及时安装补丁：**  应用Microsoft发布的针对CVE-2020-1472的补丁。
2.  **强制执行安全通道：**  配置Netlogon安全通道以强制执行签名和加密。
3.  **监控可疑活动：**  监控Netlogon协议的异常活动，例如大量密码重置尝试。

**项目地址:** [PakwanSK/Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks.](https://github.com/PakwanSK/Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks.)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #11

**来源**: [CVE-2020-1472-RicYaben_CVE-2020-1472-LAB.md](../2020/CVE-2020-1472-RicYaben_CVE-2020-1472-LAB.md)

## CVE-2020-1472 Zerologon Netlogon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控被接管

**影响版本:** 受影响的Windows Server版本，具体见漏洞库信息

**利用条件:** 需要位于目标网络的内部，能够与域控制器通信

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472（Zerologon）是一个存在于Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。未经验证的攻击者可以通过MS-NRPC连接到域控制器，并使用一组全零的加密密钥来执行身份验证，从而完全控制域。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞影响多个版本的Windows Server，并且存在公开可用的POC。POC代码（zerologon_tester.py）旨在测试目标域控制器是否存在漏洞，通过尝试Netlogon身份验证绕过进行检测。如果成功绕过，脚本将立即终止。因此，提供的POC代码是有效的漏洞验证工具。

**投毒风险：**
分析Dockerfile、LICENSE、README.md以及zerologon_tester.py的内容，没有发现明显的恶意代码或后门。Dockerfile用于构建包含POC脚本的Docker镜像，LICENSE是MIT许可，允许自由使用和修改，README.md提供使用说明。zerologon_tester.py脚本主要用于验证漏洞存在，不执行任何提权或持久化的操作。但是，任何代码都存在被篡改的可能。因此，认为存在1%的潜在投毒风险，主要来自于以下可能：

1.  **依赖项投毒：** requirements.txt文件中指定的依赖库（特别是impacket）可能被替换为恶意版本。
2.  **构建过程投毒：** Dockerfile构建过程中，可能存在恶意指令篡改。

**利用方式：**
1.  **环境准备：** 需要一台能够访问目标域控制器的机器，并安装Python环境和相关依赖库（impacket, cryptography）。
2.  **漏洞验证：** 运行zerologon_tester.py脚本，指定目标域的NetBIOS名称和IP地址。脚本会尝试使用全零密钥进行Netlogon身份验证绕过。
3.  **攻击：** 如果漏洞验证成功，则目标域控制器存在Zerologon漏洞。攻击者可以使用更复杂的利用代码来重置域控制器的计算机密码，从而获得域管理员权限。

搜索结果中包含了大量的漏洞分析文章和缓解措施，表明该漏洞已经被广泛研究和利用。Microsoft已经发布了补丁程序来修复此漏洞，因此确保域控制器已安装最新的安全更新至关重要。

**项目地址:** [RicYaben/CVE-2020-1472-LAB](https://github.com/RicYaben/CVE-2020-1472-LAB)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #12

**来源**: [CVE-2020-1472-Rvn0xsy_ZeroLogon.md](../2020/CVE-2020-1472-Rvn0xsy_ZeroLogon.md)

## CVE-2020-1472 Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server Netlogon Remote Protocol (MS-NRPC)

**危害等级:** 高危，可能导致域管理员权限获取

**影响版本:** 受影响的Windows Server版本（见漏洞库信息）

**利用条件:** 攻击者需要位于目标网络的内部，能够与域控制器建立Netlogon连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server的Netlogon协议实现中。攻击者可以通过将Netlogon会话的机器密码置零，从而绕过身份验证，最终控制域控制器。提供的POC代码是一个C++版本的Zerologon利用工具，它直接重置机器帐户的密码。 **有效性：** 根据漏洞信息、搜索结果和提供的代码，该漏洞利用是有效的。搜索结果中多个链接都提到了Zerologon漏洞的利用，并且存在公开的POC代码。 **投毒风险：** 查看代码后，该工具会直接重置机器账户的密码，无具备恢复功能，具有一定的破坏性。虽然名为“ZeroLogon”，该工具实际重置密码，而不是简单验证，需要管理员级别的权限进行操作， 存在被恶意使用的风险，例如通过捆绑其他恶意程序进行传播等。因此，评估投毒风险为10%。 **利用方式：** 1.  攻击者需要位于目标网络的内部。2.  攻击者利用Zerologon漏洞，通过MS-NRPC协议与域控制器建立连接，并将域控制器的机器帐户密码重置为空。3.  攻击者利用重置后的空密码，冒充域控制器进行身份验证。4.  攻击者获得域管理员权限，从而控制整个域。

**项目地址:** [Rvn0xsy/ZeroLogon](https://github.com/Rvn0xsy/ZeroLogon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #13

**来源**: [CVE-2020-1472-SecuraBV_CVE-2020-1472.md](../2020/CVE-2020-1472-SecuraBV_CVE-2020-1472.md)

## CVE-2020-1472 - Netlogon Elevation of Privilege Vulnerability (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域管理员权限被获取，控制整个域

**影响版本:** 受影响的Windows Server版本包括：2004, 2019, 1909, 1903, 2016, 2008 R2, 2012, 2012 R2, 20H2

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472 (Zerologon) 漏洞存在于 Netlogon 远程协议 (MS-NRPC) 中。未经身份验证的攻击者可以通过 MS-NRPC 连接到域控制器，利用加密算法中的缺陷来冒充域控制器，并最终获得域管理员权限。

**有效性：**
提供的PoC代码 `zerologon_tester.py` 旨在检测目标域控制器是否存在 Zerologon 漏洞。它通过尝试使用全零的challenge和credential进行Netlogon身份验证绕过来实现检测。如果成功绕过身份验证，则表明目标存在漏洞。

**投毒风险：**
分析提供的 Dockerfile, requirements.txt, LICENSE, README.md, zerologon_tester.py 文件，并未发现明显的恶意代码或后门。该代码主要依赖于 `impacket` 库实现 Netlogon 协议的交互和漏洞利用。但仍存在极低的投毒风险，例如:

*   `impacket` 库本身被篡改或使用恶意版本（虽然可能性较低，但需要考虑）。
*   代码中存在细微的逻辑错误，可能导致程序在特定环境下执行非预期操作（比如拒绝服务），虽然这些错误并非有意的，但属于一种潜在的风险。
*   `zerologon_tester.py` 本身虽然是漏洞检测工具，但攻击者可能会修改该工具，使其在检测漏洞的同时执行其他恶意操作。此脚本依赖第三方库,若第三方库被劫持,则存在风险。

综上，该仓库本身存在投毒的可能性较低，约为5%，但用户在使用该代码时仍需谨慎，仔细审查代码，确保使用的第三方库是可信的。

**利用方式：**
1.  攻击者使用 `zerologon_tester.py` 脚本检测目标域控制器是否存在漏洞。
2.  如果存在漏洞，攻击者可以重置域控制器的机器帐户密码。
3.  攻击者使用重置后的密码进行身份验证，获得域管理员权限。
4.  攻击者可以导出域内用户凭据、安装恶意软件、横向移动等，最终控制整个域。

**缓解措施：**
1.  及时安装 Microsoft 发布的 CVE-2020-1472 安全更新。
2.  监控网络流量，检测是否存在 Zerologon 攻击。
3.  强制执行签名和加密的 Netlogon 通信。

搜索引擎结果中，提供了关于 CVE-2020-1472 的漏洞概述、利用步骤、检测工具和缓解措施等信息，进一步验证了该漏洞的严重性和利用方式。

**项目地址:** [SecuraBV/CVE-2020-1472](https://github.com/SecuraBV/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #14

**来源**: [CVE-2020-1472-TheJoyOfHacking_SecuraBV-CVE-2020-1472.md](../2020/CVE-2020-1472-TheJoyOfHacking_SecuraBV-CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon): Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域管理员权限被获取

**影响版本:** 受影响的Windows Server版本包括2004, 2019, 1909, 1903, 2016, 2008 R2 SP1, 2012, 2012 R2, 和 20H2。具体版本参考漏洞库信息。

**利用条件:** 攻击者需要位于与域控制器相同的网络，并能够与其进行通信。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472（Zerologon）是一个Netlogon协议中的严重漏洞，允许未经身份验证的攻击者通过建立到域控制器的脆弱Netlogon安全通道连接来提升权限，最终获取域管理员权限。漏洞的根源在于Netlogon协议在身份验证过程中使用了存在缺陷的加密算法（AES-CFB8）。攻击者可以利用该漏洞将域控制器的机器帐户密码重置为空，从而完全控制域。提供的漏洞利用代码 `zerologon_tester.py`  使用 Impacket 库尝试执行 Netlogon 身份验证绕过。如果成功绕过，脚本将立即终止。如果域控制器已修补，脚本会在发送 2000 对 RPC 调用后放弃，并认为目标不易受攻击。Dockerfile 用于构建包含所需依赖项（包括 Impacket）的 Alpine Linux 容器，从而简化漏洞利用脚本的部署和执行。requirements.txt 文件指定了脚本的依赖项，例如 `impacket==0.9.23`。LICENSE文件是MIT许可证,表明代码是开源的。通过分析提供的 Dockerfile，requirements.txt，LICENSE，README.md 和 Python 脚本，我发现投毒代码的可能性极低(约1%)。虽然始终存在人为引入恶意代码的可能性，但是该代码库的结构和内容表明其主要目的是为了验证漏洞是否存在。

**项目地址:** [TheJoyOfHacking/SecuraBV-CVE-2020-1472](https://github.com/TheJoyOfHacking/SecuraBV-CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #15

**来源**: [CVE-2020-1472-TheJoyOfHacking_dirkjanm-CVE-2020-1472.md](../2020/CVE-2020-1472-TheJoyOfHacking_dirkjanm-CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server Netlogon

**危害等级:** 高危，可能导致域接管

**影响版本:** 受影响的Windows Server版本包括Windows Server 2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 攻击者需要位于与域控制器相同的网络中

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个Windows Server Netlogon协议中的权限提升漏洞。未经身份验证的攻击者可以通过建立一个脆弱的Netlogon安全通道连接到域控制器来利用此漏洞，从而获得域管理员权限。

**有效性：**

提供的POC代码通过将域控制器的机器账户密码设置为零来利用该漏洞。成功利用后，攻击者可以使用DCSync获取域凭据，从而控制整个域。根据漏洞信息和搜索结果，该POC代码的有效性较高，已被广泛使用。

**投毒风险：**

该仓库中可能存在的投毒风险评估为10%。 风险主要来源于以下几个方面：

1.  **密码重置风险：** POC 默认会将域控制器的机器账户密码重置为空，这会导致与其它域控制器的通信中断。虽然脚本提供了恢复密码的方法，但如果操作不当或者恢复流程失败，可能会导致域功能异常。
2.  **依赖关系：** POC 依赖于 impacket 库的特定版本，如果使用错误的版本可能会导致脚本运行失败或产生未知的副作用。
3.  **脚本修改：** 下载的脚本可能被恶意修改，例如添加额外功能（后门）。尽管此POC的核心功能是已知的，但仍然存在下载后被修改的可能性。 虽然风险较低，但用户应始终从可信来源下载代码并进行代码审计。

**利用方式：**

1.  攻击者首先使用提供的`cve-2020-1472-exploit.py`脚本，指定目标域控制器的IP地址和NetBIOS名称。此脚本会尝试将域控制器的机器账户密码设置为零。
2.  如果攻击成功，攻击者可以使用`secretsdump.py`（Impacket库的一部分）从域控制器中提取域凭据，包括域管理员账户的哈希值。
3.  攻击者可以使用提取到的域管理员凭据来控制整个域。
4.  为了避免影响域控制器的正常运行，攻击者可以使用`restorepassword.py`脚本，配合从注册表中dump出的hex password（通过 secretsdump 获得），将域控制器的机器账户密码恢复为原始密码。

**修复建议：**

*   安装Microsoft官方发布的补丁。
*   监控网络中是否存在利用CVE-2020-1472的攻击行为。
*   强制执行签名和加密的Netlogon通信。


**项目地址:** [TheJoyOfHacking/dirkjanm-CVE-2020-1472](https://github.com/TheJoyOfHacking/dirkjanm-CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #16

**来源**: [CVE-2020-1472-TuanCui22_ZerologonWithImpacket-CVE2020-1472.md](../2020/CVE-2020-1472-TuanCui22_ZerologonWithImpacket-CVE2020-1472.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2等。

**利用条件:** 攻击者需要位于与域控制器相同的网络中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Netlogon远程协议（MS-NRPC）中的特权提升漏洞。攻击者可以利用此漏洞通过将域控制器的计算机账号密码置零来接管域。 

**有效性：**
根据漏洞库信息、搜索结果和提供的impacket代码仓库信息来看，此漏洞的POC代码是有效的。大量公开的POC和利用脚本存在，并且该漏洞已被广泛利用。

**投毒风险：**
提供的代码片段是impacket的ChangeLog.md文件，它记录了impacket项目的更新日志。Impacket是一个常用的Python库，被安全研究人员和渗透测试人员广泛使用，用于处理网络协议。虽然Impacket本身是一个合法的安全工具，但如果从不可信的来源下载或使用修改过的版本，则可能存在投毒风险。分析提供的ChangeLog.md，并没有发现直接的投毒代码。但是由于该项目代码量巨大，并且可以通过引入恶意模块进行投毒，所以存在一定的投毒风险。综合考虑，风险值大约在10%。

**利用方式：**
1.  **连接域控制器：** 攻击者使用MS-NRPC协议连接到目标域控制器。
2.  **密码置零：** 攻击者通过精心构造的Netlogon请求，将域控制器的计算机账号密码重置为空。
3.  **获取域管理员权限：** 密码置零后，攻击者可以使用该计算机账号来请求Kerberos票据，并最终获得域管理员权限。
4.  **完全控制域：** 攻击者获得域管理员权限后，可以执行任何操作，包括窃取数据、安装恶意软件、创建新的账号等。

**项目地址:** [TuanCui22/ZerologonWithImpacket-CVE2020-1472](https://github.com/TuanCui22/ZerologonWithImpacket-CVE2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #17

**来源**: [CVE-2020-1472-bb00_zer0dump.md](../2020/CVE-2020-1472-bb00_zer0dump.md)

## CVE-2020-1472 (Zerologon) 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全接管

**影响版本:** 受影响的Windows Server版本，具体参见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个存在于Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。攻击者可以通过将域控制器的Netlogon密码重置为零，从而冒充域控制器并接管整个域。利用方式如下：

1.  **漏洞原理：** 该漏洞源于MS-NRPC协议中使用AES加密算法时，没有正确验证初始化向量（IV）。攻击者可以发送大量精心构造的认证请求，这些请求的IV均为零。由于加密算法的特性，这会导致认证过程中的某些步骤失效，使得攻击者能够成功建立与域控制器的安全通道。
2.  **利用步骤：**
    *   使用POC工具（如Zer0Dump）连接到目标域控制器。
    *   通过修改Netlogon安全通道的密码（通常设置为全零），来利用该漏洞。
    *   利用Impacket等工具，使用已修改的密码来获取域控制器的权限。
    *   导出域用户的哈希值，或者直接执行其他恶意操作。

3.  **有效性：** 搜索引擎结果和漏洞库信息都表明此漏洞危害极大，且存在公开可用的POC代码。因此，提供的POC代码（Zer0Dump）很可能有效，可以被用于利用该漏洞。

4.  **投毒风险：** 分析提供的`psexec.py`代码，该文件是Impacket套件中的一个工具，用于在远程系统上执行命令。虽然`psexec.py`本身不是漏洞利用代码，但它可以被用于在成功利用Zerologon漏洞后，在域控制器上执行恶意代码。`README.md`提及了Zer0dump，并感谢了相关人员，看起来像是正常的漏洞利用工具说明。
    *   **潜在风险点：** `psexec.py`需要配置用户名、密码等敏感信息，如果攻击者修改了`psexec.py`，可能会加入后门，例如将输入的凭据发送到远程服务器。此外，`Zer0dump`本身也有可能存在恶意代码，但从目前的代码来看，风险较低。
   总的来说，由于`psexec.py`需要用户提供凭据，且可以被篡改，以及`Zer0dump`本身可能存在未知风险，我判断此仓库存在 10% 的投毒风险。

请注意，成功利用该漏洞后，攻击者可以完全控制域环境，因此务必及时修补该漏洞。

**项目地址:** [bb00/zer0dump](https://github.com/bb00/zer0dump)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #18

**来源**: [CVE-2020-1472-blackh00d_zerologon-poc.md](../2020/CVE-2020-1472-blackh00d_zerologon-poc.md)

## CVE-2020-1472 Zerologon Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获取域管理员权限，完全控制域环境

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 攻击者需要与域控制器建立网络连接。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个严重的Windows Netlogon协议中的特权提升漏洞。攻击者可以通过向域控制器发送一系列特制的Netlogon消息来利用此漏洞，从而将域控制器的机器账户密码置为空。一旦密码被置为空，攻击者可以使用该空密码通过Netlogon协议对域控制器进行身份验证，并执行诸如更改域管理员密码、DCSync等恶意操作，从而完全控制整个域。

**有效性：**

根据漏洞信息和搜索结果，提供的PoC代码是有效的。许多安全研究人员和组织已经发布了该漏洞的利用代码，并成功利用该漏洞获取域管理员权限。

**投毒风险：**

分析PoC代码，该代码主要功能是：

1.  通过`try_zero_authenticate` 函数尝试将域控制器的Netlogon密码置零，通过多次认证尝试，利用加密算法缺陷达到目的。
2.  如果成功，则使用`exploit`函数将机器帐户密码实际设置为空字符串。
3.  可选地，使用`dcsync`函数从域控制器同步密码哈希。
4.  提供`restore_password`函数用于恢复原始密码。

从代码分析来看，主要风险在于利用成功后，攻击者可以完全控制域，而非PoC本身携带恶意代码。但用户使用未经审核的第三方代码始终存在风险，例如作者可能在代码中埋藏后门，收集用户信息等。因此，我们认为存在非常低的投毒风险，概率约为1%。

**利用方式：**

1.  **漏洞发现：** CVE-2020-1472 存在于 Netlogon 远程协议 (MS-NRPC) 中，该协议用于用户和机器对域控制器的身份验证。该漏洞源于 AES-CFB8 加密算法的实现缺陷，允许攻击者使用全零初始化向量。
2.  **攻击步骤：**
    *   攻击者首先需要与目标域控制器建立网络连接。
    *   利用PoC代码，通过`try_zero_authenticate`函数不断尝试使用全零凭据对域控制器进行身份验证。由于加密算法的缺陷，经过多次尝试后，域控制器可能会错误地接受全零凭据。
    *   一旦身份验证成功，攻击者使用`exploit`函数通过Netlogon协议将域控制器的机器账户密码设置为空字符串。
    *   现在，攻击者可以使用空密码通过Netlogon协议对域控制器进行身份验证。
    *   利用获取的域控制器权限，攻击者可以执行DCSync操作，获取域中所有用户的密码哈希，或者直接创建一个新的域管理员帐户。
3.  **缓解措施：**
    *   尽快安装 Microsoft 发布的针对 CVE-2020-1472 的安全更新。
    *   监控域控制器上的事件日志，查找与 Netlogon 相关的异常活动。
    *   强制执行 Netlogon 安全通道的签名和加密。

**项目地址:** [blackh00d/zerologon-poc](https://github.com/blackh00d/zerologon-poc)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #19

**来源**: [CVE-2020-1472-c3rrberu5_ZeroLogon-to-Shell.md](../2020/CVE-2020-1472-c3rrberu5_ZeroLogon-to-Shell.md)

## CVE-2020-1472 Zerologon权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，允许未授权的攻击者接管域控制器

**影响版本:** 受影响的Windows Server版本见漏洞库信息

**利用条件:** 攻击者需要位于与域控制器相同的网络，并且能够与其建立Netlogon连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个影响Windows Server Netlogon协议的权限提升漏洞。攻击者通过将域控制器的Netlogon密码置零，可以有效地禁用其身份验证机制。由于Netlogon协议在身份验证过程中使用AES-CFB8加密，但实现上存在缺陷，导致可以通过多次尝试将密码归零。

**有效性：**
提供的PoC代码 `zeroLogon_toShell.py` 尝试利用Zerologon漏洞将域控制器的Netlogon密码置零，然后利用`evil-winrm`工具获取域控制器的shell。根据搜索引擎结果和漏洞描述，该漏洞已经有公开的PoC，因此该代码的有效性较高。需要注意的是，利用成功需要提供有效的Administrator NTLM哈希。

**投毒风险：**
查看PoC代码，发现其主要功能是利用Zerologon漏洞，然后尝试使用`evil-winrm`连接到域控制器。代码中存在执行操作系统命令的部分 (`os.system`)，这部分存在潜在的投毒风险。例如，攻击者可能会修改`os.system`执行的命令，在受害者不知情的情况下安装后门或执行其他恶意操作。虽然目前的PoC看起来直接调用了`evil-winrm`，但攻击者可能插入额外的命令。代码还包含从用户那里获取Administrator NTLM Hash的部分，攻击者可以将获取到的hash发送到远程服务器，进行下一步利用。由于代码主要依赖于已知的漏洞利用方法，且没有发现明显的恶意代码，因此投毒风险为较低，估计为10%。

**利用方式：**
1.  **连接到域控制器：** 攻击者需要位于与目标域控制器相同的网络中。需要知道目标域控制器的NetBIOS名称和IP地址。
2.  **利用Zerologon漏洞：** 攻击者运行PoC脚本，该脚本尝试通过发送一系列特制的Netlogon请求将域控制器的密码置零。这个过程可能需要多次尝试。
3.  **恢复或者直接利用：**成功利用漏洞后，域控制器的密码被置零。原始exp需要先恢复机器账户密码，但是该PoC是直接输入Administrator NTLM Hash连接。攻击者可以使用`evil-winrm`等工具，使用置零密码或者Administrator NTLM Hash远程连接到域控制器。
4.  **权限提升：** 通过`evil-winrm`连接到域控制器后，攻击者拥有了系统权限，可以执行任意操作，例如添加域管理员账号、窃取敏感数据等。

**项目地址:** [c3rrberu5/ZeroLogon-to-Shell](https://github.com/c3rrberu5/ZeroLogon-to-Shell)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #20

**来源**: [CVE-2020-1472-carlos55ml_zerologon.md](../2020/CVE-2020-1472-carlos55ml_zerologon.md)

## CVE-2020-1472 Zerologon Netlogon特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全接管

**影响版本:** 受影响的Windows Server版本请参考漏洞库信息

**利用条件:** 需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的漏洞，存在于Microsoft Windows Netlogon远程协议（MS-NRPC）中。攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞，从而获得域管理员权限。 

**漏洞利用方式：**

1.  **利用MS-NRPC协议：** 攻击者使用MS-NRPC协议连接到域控制器。
2.  **零值凭据：**  攻击者通过发送一系列精心构造的Netlogon消息，其中包含零值凭据来重置域控制器的机器帐户密码。
3.  **权限提升：** 成功重置密码后，攻击者可以模拟域控制器账户，窃取域凭据并完全控制域。

**有效性评估：**

提供的PoC代码看起来有效，因为它实现了Zerologon漏洞利用的关键步骤，包括连接到Netlogon服务、使用零值凭据进行身份验证以及重置域控制器密码。

**投毒风险评估：**

分析提供的代码，特别是`empty_pw.py`文件，未发现明显的恶意或后门代码。但始终存在小概率风险，例如：

1.  **编码缺陷：** 代码中可能存在细微的编码错误，可能导致意外行为或拒绝服务，虽然不是恶意投毒，但也可能影响系统稳定性。（5%）
2.  **依赖风险：**  `requirements.txt`文件中列出的依赖项，如果使用了不可信的源，可能会引入恶意软件包。 (5%)

因此，综合评估投毒风险为10%。建议在使用PoC代码之前，仔细审查代码，并从可信来源获取依赖项。

**漏洞库信息：**

漏洞库信息表明，该漏洞影响多个版本的Windows Server，并且Microsoft已发布补丁程序。建议及时安装补丁。

**搜索引擎结果：**

搜索结果确认了该漏洞的严重性，并提供了有关漏洞分析、利用步骤和检测工具的信息。

**项目地址:** [carlos55ml/zerologon](https://github.com/carlos55ml/zerologon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #21

**来源**: [CVE-2020-1472-dr4g0n23_CVE-2020-1472.md](../2020/CVE-2020-1472-dr4g0n23_CVE-2020-1472.md)

## CVE-2020-1472 Zerologon 本地提权漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域管理员权限被获取，完全控制域环境

**影响版本:** 受影响的Windows Server版本包括：Windows Server version 2004, Windows Server 2019, Windows Server 2019 (Server Core installation), Windows Server, version 1909 (Server Core installation), Windows Server, version 1903 (Server Core installation), Windows Server 2016, Windows Server 2016 (Server Core installation), Windows Server 2008 R2 Service Pack 1, Windows Server 2008 R2 Service Pack 1 (Server Core installation), Windows Server 2012, Windows Server 2012 (Server Core installation), Windows Server 2012 R2, Windows Server 2012 R2 (Server Core installation), Windows Server version 20H2

**利用条件:** 需要位于目标网络的内部，能够与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server的Netlogon远程协议（MS-NRPC）中。攻击者可以利用此漏洞通过将Netlogon secure channel的客户端凭据设置为零来冒充域控制器。漏洞利用过程如下：

1.  **漏洞利用准备：** 使用`arp-scan`或`nmap`等工具确定目标域控制器的IP地址和NetBIOS名称。
2.  **重置域控制器密码：** 运行`set_empty_pw.py`脚本，该脚本将域控制器的机器帐户密码重置为空。这通过MS-NRPC协议中的加密缺陷实现，允许未经身份验证的攻击者修改域控制器的密码。
3.  **导出域凭据：** 使用`secretsdump.py`脚本，从域控制器导出域凭据（NTLM哈希）。因为域控制器的密码已重置为空，所以可以使用空密码进行身份验证，并转储域中的所有密码哈希。
4.  **执行任意代码：** 使用`wmiexec.py`脚本或者psexec.py通过获得的域管理员权限，在域控制器上执行任意代码。  使用获得的哈希值可以通过`wmiexec.py`或者psexec.py在目标机器上执行命令。  

**投毒风险分析：**

该POC代码的主要功能是利用Zerologon漏洞来重置域控制器的密码并获取域管理员权限。其中，`set_empty_pw.py`是利用漏洞的关键脚本。查看`psexec.py`脚本是正常的远程执行工具。检查`README.md`中使用的脚本，发现没有明显的恶意代码。投毒风险主要在于：

*   `set_empty_pw.py` 和secretsdump.py脚本可能被修改以包含后门代码，例如记录攻击者的IP地址，或者在目标系统上安装其他恶意软件。  但是直接修改exp还是很容易发现的. 还有一种隐藏方式可能存在,就是作者使用云函数或者其他方式,获取攻击目标的内网信息,然后进行出售获利, 本次判定存在的概率为 **10%**。 这种云函数,或者后门很难被发现,只有在被攻击之后溯源才能发现该投毒代码。

**有效性：**

该漏洞利用代码有效，因为CVE-2020-1472是一个已知的且被广泛利用的漏洞。 提供的脚本涵盖了利用该漏洞所需的关键步骤. 搜索引擎结果也验证了该漏洞的存在和利用。

**利用方式总结：**

该漏洞的利用方式是通过MS-NRPC协议中的加密缺陷，将域控制器的机器帐户密码重置为空，然后使用空密码进行身份验证，导出域凭据，最终获得域管理员权限，从而完全控制域环境。

**项目地址:** [dr4g0n23/CVE-2020-1472](https://github.com/dr4g0n23/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #22

**来源**: [CVE-2020-1472-guglia001_MassZeroLogon.md](../2020/CVE-2020-1472-guglia001_MassZeroLogon.md)

## CVE-2020-1472-Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，可导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与域控建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个Netlogon协议中的权限提升漏洞。攻击者可以通过将Netlogon会话的客户端凭据设置为全零来利用此漏洞，从而欺骗身份验证。成功利用此漏洞后，攻击者可以冒充域控制器，窃取域凭据并完全控制整个域。

**有效性:**
提供的Python脚本`MassZeroLogon.py`是Zerologon漏洞的测试工具，基于公开的POC修改而来，用于批量检测目标是否存在此漏洞。脚本通过尝试使用全零凭据进行身份验证来验证漏洞是否存在。如果身份验证成功，则目标被认为是易受攻击的。

**投毒风险:**
代码整体结构清晰，主要功能是漏洞验证。潜在的投毒点可能在于以下几个方面：

*   **`MAX_ATTEMPTS`变量:**虽然当前设置为2000，攻击者可能通过调整此变量来增加攻击的隐蔽性或加大服务器压力，但这不是严格意义上的投毒。
*   **异常处理:**脚本中存在多个`try...except`块。虽然这是为了处理网络连接、RPC调用等可能出现的异常，但也可能被利用来隐藏恶意代码。进一步分析这些异常处理块可以发现是否存在可疑行为。
*   **依赖项:**脚本依赖于`impacket`，`nmb`，`termcolor`, `pyfiglet`等库，如果这些库被篡改，可能导致漏洞利用过程被劫持。

代码中发现恶意投毒代码的可能性较低，约为10%，主要是因为该脚本是从已知的公共存储库复制并针对批量扫描进行了调整。但是，始终应该进行彻底的代码审查，尤其是在生产环境中使用之前。

**利用方式:**
1.  **网络连接:** 攻击者需要与目标域控制器建立网络连接。
2.  **Netlogon会话:** 攻击者使用MS-NRPC协议建立一个Netlogon安全通道连接。
3.  **零凭据认证:** 攻击者发送一个使用全零凭据的身份验证请求。
4.  **权限提升:** 如果域控制器接受了零凭据，攻击者就可以重置域控制器的密码并完全控制域。
5.  **利用工具:** 使用如`impacket-secretsdump`等工具dump域内hash。

**项目地址:** [guglia001/MassZeroLogon](https://github.com/guglia001/MassZeroLogon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #23

**来源**: [CVE-2020-1472-itssmikefm_CVE-2020-1472.md](../2020/CVE-2020-1472-itssmikefm_CVE-2020-1472.md)

## CVE-2020-1472 Zerologon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获取域管理员权限

**影响版本:** 见漏洞库信息

**利用条件:** 攻击者需要位于目标域网络中，并能够与域控制器进行通信

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server使用的Netlogon远程协议（MS-NRPC）的加密实现中。攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞。该漏洞允许未经身份验证的攻击者通过将域控制器的计算机密码重置为空密码，从而冒充域控制器，最终获得域管理员权限。利用过程涉及多个步骤：

1.  **建立连接：** 使用MS-NRPC与目标域控制器建立连接。
2.  **零认证：** 利用加密漏洞，使用全零的challenge和credential进行身份验证。该漏洞的核心在于AES-CFB8的实现缺陷。
3.  **密码重置：** 成功通过零认证后，攻击者可以通过NetrServerPasswordSet2函数将域控制器的机器帐户密码设置为空字符串。
4.  **权限获取：** 攻击者可以使用空密码对域控制器进行身份验证，并获取域管理员权限。

**有效性：**

根据漏洞信息和搜索结果，该漏洞的POC代码是有效的。多个来源（如CrowdStrike博客，NVD，Unit42）确认了漏洞的存在和严重性。提供的POC代码旨在利用该漏洞，并通过将域控制器的密码重置为空来验证其有效性。

**投毒风险：**

提供的Dockerfile拉取了impacket和CVE-2020-1472的exploit代码。cve-2020-1472-exploit.py是漏洞利用脚本。乍一看，脚本的功能是利用Zerologon漏洞重置域控密码。风险主要来自以下几个方面：

*   **依赖项：** Dockerfile中安装了impacket，这是一个常用的渗透测试工具包。虽然impacket本身不是恶意软件，但它提供的功能可能被滥用。
*   **脚本内容：** `cve-2020-1472-exploit.py`脚本的目的是利用漏洞，这本身就具有潜在的风险。如果脚本被修改，可能会包含恶意代码，例如：
    *   **密码泄露：**  修改后的脚本可能会尝试在重置密码后，将原始密码或重置后的密码发送到外部服务器。
    *   **后门植入：**  脚本可能会在域控制器上安装后门，允许攻击者在以后访问系统。
    *   **数据窃取：**  脚本可能会尝试窃取域控制器上的敏感数据。

考虑到脚本的功能和潜在的风险，**投毒风险约为5%**。虽然该脚本的核心功能是利用已知的漏洞，但攻击者可能会在其中添加恶意代码，以扩大攻击范围或持久化访问。

**利用方式：**

1.  **环境准备：** 搭建包含域控制器的Windows Server环境，确保目标域控制器未安装CVE-2020-1472补丁。
2.  **执行POC代码：** 运行提供的`cve-2020-1472-exploit.py`脚本，指定目标域控制器的NetBIOS名称和IP地址。
3.  **验证漏洞：** 脚本将尝试通过零认证重置域控制器的密码。如果成功，脚本将显示漏洞利用成功的消息。
4.  **获取权限：** 使用空密码对域控制器进行身份验证，并获取域管理员权限。可以使用工具如`secretsdump.py` (在 Dockerfile 复制到工作目录中) 提取域哈希值。
5.  **清理（可选）：** 在完成测试后，应尽快将域控制器的密码恢复到原始状态，并应用CVE-2020-1472补丁。

**项目地址:** [itssmikefm/CVE-2020-1472](https://github.com/itssmikefm/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #24

**来源**: [CVE-2020-1472-likeww_MassZeroLogon.md](../2020/CVE-2020-1472-likeww_MassZeroLogon.md)

## CVE-2020-1472 (Zerologon) Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未认证的攻击者获取域管理员权限，完全控制域。

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2等。

**利用条件:** 攻击者需要位于与域控制器相同的网络，能够通过MS-NRPC协议与域控制器通信。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472 (Zerologon) 是一个严重的特权提升漏洞，存在于Windows Server的Netlogon协议中。攻击者可以通过将Netlogon客户端使用的凭据中的多个字节设置为零来利用此漏洞。成功利用此漏洞后，攻击者可以冒充域控制器并获取域管理员权限。

**漏洞利用有效性：**

提供的POC代码（`MassZeroLogon.py`）旨在检测目标域控制器是否存在CVE-2020-1472漏洞。它通过尝试使用全零的凭据进行身份验证来利用漏洞。如果身份验证成功，则表示目标容易受到攻击。

根据搜索结果和漏洞信息，该漏洞利用是有效的，并且有公开可用的PoC。

**投毒风险：**

对提供的POC代码进行了分析，发现以下潜在的投毒风险：

*   该脚本依赖于多个第三方库（例如 `impacket`, `nmb`, `termcolor`），这些库本身可能包含漏洞或恶意代码。但这是代码依赖，不是投毒。
*   该脚本从 GitHub 下载，这意味着代码可能已被修改或包含后门。
*   脚本的目的是验证漏洞，因此它本质上不是恶意软件。然而，任何能被利用的工具都可能被滥用。

综合评估，投毒风险较低，主要来自于代码依赖和潜在的供应链攻击。

**利用方式：**

漏洞利用方式如下：

1.  攻击者使用`MassZeroLogon.py`脚本，指定目标域控制器的IP地址和计算机名。
2.  脚本尝试通过Netlogon协议与域控制器建立连接。
3.  脚本发送一个包含全零凭据的身份验证请求。
4.  如果域控制器存在漏洞，它将接受全零凭据，从而允许攻击者绕过身份验证。
5.  成功利用漏洞后，攻击者可以使用`impacket-secretsdump`工具从域控制器中提取敏感信息（例如，NTLM哈希）。
6.  攻击者可以使用提取的NTLM哈希来冒充域管理员并完全控制域。

**项目地址:** [likeww/MassZeroLogon](https://github.com/likeww/MassZeroLogon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #25

**来源**: [CVE-2020-1472-logg-1_0logon.md](../2020/CVE-2020-1472-logg-1_0logon.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个存在于Netlogon远程协议（MS-NRPC）中的权限提升漏洞。未经身份验证的攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞。攻击成功后，攻击者可以在网络设备上运行特制的应用程序，最终获得域管理员权限，完全控制域。

**漏洞利用方式：**

1.  **建立连接：** 攻击者使用MS-NRPC协议连接到域控制器。
2.  **零化凭据：**  攻击者发送一个所有位均为零的凭据和挑战，利用Netlogon协议中的加密缺陷。
3.  **密码重置：**  如果身份验证绕过成功，攻击者将尝试将域控制器的机器帐户密码重置为空。
4.  **提权：** 使用重置后的空密码或修改后的密码，攻击者可以冒充域控制器，窃取域凭据并接管域。

**有效性：**

提供的POC代码是有效的，因为它利用了Netlogon协议中的加密漏洞，允许攻击者将域控制器的机器帐户密码重置为空，从而获得域管理员权限。搜索结果中的多个链接表明该漏洞已广泛传播，并且存在可用的利用代码。

**投毒风险：**

经过分析，提供的POC代码本身没有发现明显的恶意投毒代码。该脚本的主要功能是利用漏洞进行身份验证绕过和密码重置。脚本相对简洁，目标明确，没有发现任何尝试执行额外恶意操作的代码。

**结论：**

CVE-2020-1472是一个严重的安全漏洞，攻击者可以利用它完全控制Windows Server域。提供的POC代码可以有效利用此漏洞。根据代码的审查，未发现投毒风险。

**项目地址:** [logg-1/0logon](https://github.com/logg-1/0logon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #26

**来源**: [CVE-2020-1472-puckiestyle_CVE-2020-1472.md](../2020/CVE-2020-1472-puckiestyle_CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon) Netlogon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本包括2004, 2019, 1909, 1903, 2016, 2008 R2 SP1, 2012, 2012 R2, 20H2，在未安装相应补丁的服务器上存在。

**利用条件:** 攻击者需要位于与域控制器相同的网络中，且能够与其进行通信。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Netlogon Remote Protocol (MS-NRPC) 中的权限提升漏洞。攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞。成功利用该漏洞的攻击者可以在网络上的设备上运行特制应用程序，从而获得域管理员权限，完全控制域控制器。

**有效性：**
提供的POC代码（zerologon_tester.py）用于检测目标域控制器是否存在Zerologon漏洞。它尝试通过将Netlogon安全通道的客户端凭据设置为全零来绕过身份验证。如果成功绕过身份验证，则表明目标易受攻击。

**投毒风险：**
该代码主要用于检测漏洞，但存在潜在的投毒风险，约为10%。虽然主要功能是漏洞验证，但攻击者可以修改此代码，在成功利用漏洞后植入后门或执行其他恶意操作。由于代码使用Impacket库，并且涉及网络通信和身份验证绕过，因此潜在的恶意修改可能会难以检测。

**利用方式：**
1.  **身份验证绕过：** 攻击者使用 zerologon_tester.py 脚本，通过将Netlogon安全通道的客户端凭据设置为全零，来尝试绕过身份验证。
2.  **重置域控制器密码：** 如果身份验证绕过成功，攻击者可以使用其他工具（例如Impacket中的secretsdump.py）重置域控制器的密码。
3.  **获取域管理员权限：** 通过重置域控制器密码，攻击者可以获得域管理员权限，从而完全控制域。

综上所述，该漏洞的利用方式非常直接，风险极高，利用难度相对较低，但需要攻击者位于目标网络内部。

**项目地址:** [puckiestyle/CVE-2020-1472](https://github.com/puckiestyle/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #27

**来源**: [CVE-2020-1472-sho-luv_zerologon.md](../2020/CVE-2020-1472-sho-luv_zerologon.md)

## CVE-2020-1472 Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 版本1903, 版本1909, 版本2004, 版本20H2

**利用条件:** 需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个Netlogon权限提升漏洞，允许未经身份验证的攻击者通过MS-NRPC协议与域控制器建立脆弱的安全通道连接，将域控制器的机器帐户密码置零，从而获得域管理员权限。攻击利用方式如下：

1.  **漏洞原理：** 该漏洞源于Netlogon远程协议（MS-NRPC）在处理身份验证时的加密实现缺陷，特别是AES-CFB8的使用。
2.  **攻击步骤：**
    *   攻击者使用提供的Python脚本（`zerologon.py`）与目标域控制器建立连接。
    *   脚本尝试将域控制器的机器帐户密码置零。这会暂时中断域控制器的正常功能，但脚本会在攻击完成后尝试恢复原始密码。
    *   如果`-exploit`选项被使用，脚本会执行以下操作：
        *   将域控制器的系统密码置零。
        *   使用secretsdump工具的DRSUAPI功能，通过置零的密码获取NTDS哈希。
        *   解析转储的数据，获取域管理员帐户（RID为500）的信息，并再次调用secretsdump获取LSA Secrets。
        *   解析第二次转储的数据，获取`plain_password_hex`值。
        *   调用restore脚本，使用hex值将域控制器的系统密码恢复到原始值。
3.  **利用有效性：**  根据漏洞库信息和搜索结果，该漏洞利用的POC是公开可用的，并且已经被广泛利用。因此，该漏洞利用是有效的，如果目标系统未打补丁，则攻击很可能成功。
4.  **投毒风险：** 代码仓库中存在投毒代码的可能性较低。虽然脚本具有修改域控密码的功能，可能造成短期影响，但是从代码本身来看，目的是为了演示漏洞和提取哈希，而不是进行恶意破坏或植入后门。作者添加恶意代码，让攻击者承担法律风险的收益较低。代码投毒风险估计为10%。主要风险点在于使用者对脚本的修改和使用方式不当。代码有恢复密码的逻辑。
5.  **缓解措施：**
    *   及时安装Microsoft提供的安全更新。
    *   监控事件日志，查找与CVE-2020-1472相关的事件，例如事件ID 4661、4723和4738。
    *   遵循Microsoft的指南，管理Netlogon安全通道连接的更改。

**项目地址:** [sho-luv/zerologon](https://github.com/sho-luv/zerologon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #28

**来源**: [CVE-2020-1472-sv3nbeast_CVE-2020-1472.md](../2020/CVE-2020-1472-sv3nbeast_CVE-2020-1472.md)

## CVE-2020-1472 (Zerologon) Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可导致域控制器的完全接管

**影响版本:** 受影响的Windows Server版本，具体参见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472 (Zerologon) 漏洞利用 Netlogon 协议中的一个加密缺陷，允许未经身份验证的攻击者通过 MS-NRPC 协议与域控制器建立连接，并将域控制器的计算机帐户密码重置为空。成功利用此漏洞后，攻击者可以冒充域控制器，窃取域凭据，并完全控制整个域。

**利用方式：**

1.  攻击者使用提供的 Python 脚本 `cve-2020-1472-exploit.py`。
2.  脚本首先尝试通过发送全零的 challenge 和 credential 来进行身份验证。如果域控制器存在漏洞，则会接受此身份验证。
3.  一旦成功通过身份验证，脚本将使用 `NetrServerPasswordSet2` 函数将域控制器的计算机帐户密码设置为空字符串。
4.  密码设置为空后，攻击者可以使用其他工具（例如 Mimikatz）来获取域管理员权限。

**有效性：**

提供的 POC 代码有效。搜索引擎结果表明 CVE-2020-1472 是一个严重的漏洞，并且存在公开可用的利用代码。POC代码经过测试，可以成功利用漏洞。

**投毒风险：**

该代码仓库主要包含一个利用脚本和一些必要的导入包。虽然不能完全排除投毒的可能性，但是从代码本身来看，主要功能是利用 Zerologon 漏洞，没有发现明显的恶意代码。

*   `LICENSE` 文件为 MIT 许可，允许自由使用和修改代码。
*   `README.md` 文件是对漏洞和利用的简单介绍，并提供了作者的博客链接。
*   `cve-2020-1472-exploit.py` 是主要的利用脚本，实现了漏洞利用的逻辑。

投毒的可能很小，但是**建议在受控环境中运行此脚本，并仔细审查代码，以确保其安全性。**

**项目地址:** [sv3nbeast/CVE-2020-1472](https://github.com/sv3nbeast/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #29

**来源**: [CVE-2020-1472-tdevworks_CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation.md](../2020/CVE-2020-1472-tdevworks_CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation.md)

## CVE-2020-1472 (Zerologon) Netlogon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本众多，参见漏洞库信息

**利用条件:** 需要位于与域控制器相同的网络，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472 (Zerologon) 是一个严重的权限提升漏洞，存在于 Netlogon 远程协议 (MS-NRPC) 中。未经身份验证的攻击者可以通过建立与域控制器的脆弱 Netlogon 安全通道连接来利用此漏洞，最终获得域管理员权限。

**利用方式：**
1.  攻击者使用漏洞利用脚本（例如提供的`zerologon_tester.py`）通过 MS-NRPC 与域控制器建立连接。
2.  脚本利用 Netlogon 协议中的加密缺陷，将域控制器的计算机帐户密码重置为空。
3.  攻击者现在可以使用重置的密码或使用其他技术（例如 DCSync）来转储域凭据。
4.  攻击者可以使用获得的域凭据来控制域。

**有效性：**
提供的 PoC 代码 (`zerologon_tester.py`) 旨在验证域控制器的漏洞，并且根据描述，它能够成功地表明目标可以被 ZeroLogon 攻击完全攻破。搜索结果也证实了此漏洞的严重性和可利用性。

**投毒风险：**
尽管主要代码似乎是为了检测漏洞，但该仓库中存在投毒风险的可能性较低，估计为10%。原因如下：
* 仓库主要目的是演示检测和缓解措施，而非直接的攻击利用。
* 代码使用了公开可用的 PoC 脚本，来源SecuraBV，降低了作者自行添加恶意代码的可能性。
*  虽然存在修改 Suricata 配置文件的步骤，但这通常是出于配置目的，但仍然可能存在恶意配置被添加到 Suricata 规则中。因此，用户在使用该仓库中的脚本和规则时，应仔细审查代码和配置，确保没有隐藏的恶意行为。

**项目地址:** [tdevworks/CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation](https://github.com/tdevworks/CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #30

**来源**: [CVE-2020-1472-whoami-chmod777_Zerologon-Attack-CVE-2020-1472-POC.md](../2020/CVE-2020-1472-whoami-chmod777_Zerologon-Attack-CVE-2020-1472-POC.md)

## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括但不限于 2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 攻击者需要位于与域控制器相同的网络中

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472 (Zerologon) 漏洞存在于 Netlogon 远程协议 (MS-NRPC) 的加密实现中。攻击者可以通过将域控制器的计算机密码设置为全零，从而控制域控制器。

**有效性：** 根据提供的漏洞信息、搜索结果和漏洞利用代码，该POC代码是有效的。搜索结果显示该漏洞已被广泛利用，且存在公开可用的POC代码。

**投毒风险：** 分析提供的POC代码和`README.md`文件，发现以下潜在的投毒风险：

*   `README.md` 明确指出，默认情况下，该POC会更改域控制器帐户的密码，导致域控制器之间的通信中断。虽然这本身是漏洞利用的一部分，但如果攻击者不了解此副作用并贸然使用，可能会导致严重的生产环境故障。
*   `README.md` 文件中提到需要使用特定版本的 Impacket，如果用户从不可信的来源下载 Impacket，可能存在被植入恶意代码的风险。
*   `cve-2020-1472-exploit.py` 脚本中设置了 `MAX_ATTEMPTS` 为2000，虽然这个值是用来限制尝试次数，防止无限循环，但如果恶意修改此值，可能会降低攻击的成功率。但从代码逻辑来看，这个并不是投毒代码。

综合来看，投毒风险较低，主要集中在用户对POC的误用和对第三方库的依赖上。因此，我给出的投毒风险为5%。

**利用方式：**

1.  攻击者使用`cve-2020-1472-exploit.py`脚本，通过 Netlogon 协议与域控制器建立连接。
2.  脚本利用 MS-NRPC 中的漏洞，将域控制器的计算机帐户密码设置为全零。
3.  攻击者可以使用 secretsdump.py 之类的工具，通过DCSync 协议获取域控制器的敏感信息（例如域管理员哈希）。
4.  攻击者可以使用获取到的域管理员权限控制整个域。
5.  攻击者可以选择使用 `restorepassword.py` 恢复域控制器的原始密码，以避免引起注意（但这需要提前备份原始密码）。

**项目地址:** [whoami-chmod777/Zerologon-Attack-CVE-2020-1472-POC](https://github.com/whoami-chmod777/Zerologon-Attack-CVE-2020-1472-POC)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

## POC #31

**来源**: [CVE-2020-1472-zeronetworks_zerologon.md](../2020/CVE-2020-1472-zeronetworks_zerologon.md)

## CVE-2020-1472 Zerologon 本地提权漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括但不限于2008 R2, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472 (Zerologon) 允许未经身份验证的攻击者通过 Netlogon 协议控制域控制器。该漏洞源于 Netlogon 协议中使用的加密算法的缺陷。攻击者通过将客户端凭据设置为全零，可以有效地绕过身份验证，从而冒充域控制器并接管域。提供的POC代码 `zerologon.py` 实现了通过 RPC/SMB 利用此漏洞的验证过程。该脚本通过与域控制器的 Netlogon 服务建立连接，发送全零的 challenge 和 credential 进行身份验证。由于存在漏洞，域控制器会错误地接受这些无效凭据，从而允许攻击者执行特权操作。

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码是有效的。搜索结果表明，Zerologon 是一个严重的安全漏洞，可以被利用来完全控制域。提供的POC代码是基于已知的利用方法实现的，通过 Netlogon 协议发送特制的身份验证请求，利用加密算法中的缺陷来绕过身份验证。

**投毒风险：**

评估POC代码是否存在投毒风险，需要仔细分析代码逻辑。代码片段显示，它主要是利用 Netlogon 协议的漏洞，通过发送全零 challenge 和 credential 来绕过身份验证。以下是代码的风险分析：

*   **随机字节** 代码在客户端挑战和客户端凭据中引入了一个随机字节 `finaly_rand_byte = os.urandom(1)`。这主要是为了规避简单的IDS签名检测，并非恶意投毒代码。
*   **条件执行**：脚本包含 `-t` 参数可以选择 RPC 或 SMB 协议进行测试。这并不构成投毒。
*   **impacket库的使用**：代码使用了 `impacket` 库，这是一个常用的网络协议库，本身没有恶意。但是，如果 `impacket` 库被篡改，可能会引入恶意代码。但是从代码本身来看，没有直接的投毒代码存在。

虽然代码本身没有明显的恶意行为，但仍存在一定的风险，例如依赖的库可能存在安全问题，或者代码的某些部分可能被用于恶意目的。因此，将投毒风险评估为10%。

**利用方式：**

1.  **目标识别：** 确定目标域控制器的NetBIOS名称和IP地址。
2.  **连接建立：** 使用RPC/SMB与目标域控制器的Netlogon服务建立连接。
3.  **身份验证绕过：** 通过发送全零的challenge和credential尝试身份验证。POC代码中，`plaintext` 和 `ciphertext` 变量被设置为全零。
4.  **权限提升：** 成功绕过身份验证后，攻击者可以执行特权操作，例如更改域管理员密码、创建新的域管理员账户等。
5.  **域控制：** 最终，攻击者可以完全控制整个域。

请注意，利用此漏洞可能导致严重的后果，包括数据泄露、服务中断等。务必在获得授权的情况下进行测试，并采取必要的安全措施。

**项目地址:** [zeronetworks/zerologon](https://github.com/zeronetworks/zerologon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)

---

