# CVE-2020-13942

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-13942-Prodrious_CVE-2020-13942.md](../2020/CVE-2020-13942-Prodrious_CVE-2020-13942.md)

# CVE-2020-13942

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-13942-Prodrious_CVE-2020-13942.md](../2020/CVE-2020-13942-Prodrious_CVE-2020-13942.md)

# CVE-2020-13942

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-13942-Prodrious_CVE-2020-13942.md](../2020/CVE-2020-13942-Prodrious_CVE-2020-13942.md)

# CVE-2020-13942

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2020-13942-blackmarketer_CVE-2020-13942.md](../2020/CVE-2020-13942-blackmarketer_CVE-2020-13942.md)

## CVE-2020-13942-Apache Unomi-RCE

**漏洞编号:** CVE-2020-13942

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Unomi

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 1.5.2

**利用条件:** 需要可以访问/context.json接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-13942是Apache Unomi中存在的一个远程代码执行漏洞。该漏洞是由于Apache Unomi未对/context.json公共端点接收的输入进行充分验证，攻击者可以通过注入恶意的OGNL或MVEL脚本来执行任意代码。

**有效性：**
提供的POC代码通过向/context.json端点发送包含恶意OGNL表达式的POST请求来利用此漏洞。该POC通过检查响应中是否存在特定的字符串（"boom"）来判断目标是否易受攻击，验证了漏洞的有效性。由于1.5.1版本只是部分修复，所以这个POC可以绕过1.5.1版本的修复。

**投毒风险：**
分析提供的漏洞利用代码，该代码主要功能是读取目标列表，并对每个目标发送包含恶意payload的HTTP请求，检查返回结果，判断目标是否存在漏洞，没有发现任何恶意代码，因此推断仓库中不存在作者隐藏的投毒代码的风险为0%。

**利用方式：**
1.  攻击者构造包含恶意OGNL或MVEL表达式的JSON数据。
2.  攻击者将构造的JSON数据通过POST请求发送到/context.json端点。
3.  Apache Unomi服务端在处理请求时，由于未充分验证输入，导致恶意表达式被执行，从而实现远程代码执行。

**缓解措施：**
*   升级到Apache Unomi 1.5.2或更高版本。
*   限制对/context.json端点的访问。

**项目地址:** [blackmarketer/CVE-2020-13942](https://github.com/blackmarketer/CVE-2020-13942)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)

---

## POC #2

**来源**: [CVE-2020-13942-corsisechero_CVE-2020-13942byVulHub.md](../2020/CVE-2020-13942-corsisechero_CVE-2020-13942byVulHub.md)

## CVE-2020-13942-Apache Unomi-RCE

**漏洞编号:** CVE-2020-13942

**漏洞类型:** 远程代码执行

**影响应用:** Apache Unomi

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 1.5.2

**利用条件:** 需要网络访问Unomi的/context.json端点

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-13942 漏洞存在于 Apache Unomi 1.5.2 之前的版本中。攻击者可以向 `/context.json` 公共端点注入恶意的 OGNL 或 MVEL 脚本，从而实现远程代码执行。

**有效性分析：**
提供的POC代码通过构造包含 MVEL 表达式的 JSON payload，并将其 POST 到 `/context.json` 端点，利用了 Unomi 对用户输入验证不严格的缺陷，成功执行了 `touch /tmp/pluto` 命令，创建了文件，证明 POC 代码有效。

**投毒风险分析：**
分析提供的漏洞利用代码仓库，发现代码主要包含 docker-compose 编排文件和用于触发漏洞的 curl 命令。docker-compose 文件定义了 Unomi 1.5.1 版本的 Docker 镜像和 Elasticsearch 镜像，环境搭建没有问题。curl 命令中的 MVEL 表达式 `script::Runtime r = Runtime.getRuntime(); r.exec("touch /tmp/pluto");` 用于在目标服务器上创建 `/tmp/pluto` 文件以验证漏洞。**没有发现作者隐藏的恶意代码，主要风险还是在于直接运行未经验证的第三方docker镜像。投毒风险较低，估计为1%。**

**利用方式：**
1.  攻击者构造包含恶意 MVEL 或 OGNL 表达式的 JSON 数据。
2.  将该 JSON 数据通过 HTTP POST 请求发送到 Apache Unomi 服务器的 `/context.json` 端点。
3.  Unomi 服务器解析 JSON 数据，由于输入验证不足，导致恶意表达式被执行，最终实现远程代码执行。

根据漏洞库信息，Apache Unomi 1.5.2 修复了此漏洞，强烈建议升级到最新版本。


**项目地址:** [corsisechero/CVE-2020-13942byVulHub](https://github.com/corsisechero/CVE-2020-13942byVulHub)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)

---

## POC #3

**来源**: [CVE-2020-13942-eugenebmx_CVE-2020-13942.md](../2020/CVE-2020-13942-eugenebmx_CVE-2020-13942.md)

## CVE-2020-13942 - Apache Unomi RCE

**漏洞编号:** CVE-2020-13942

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Unomi

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** < 1.5.2

**利用条件:** 需要可以访问/context.json端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-13942 存在于 Apache Unomi 1.5.2 之前的版本中。攻击者可以通过向 `/context.json` 端点注入恶意的 OGNL 或 MVEL 脚本来利用此漏洞，实现远程代码执行。

**漏洞利用方式：**

1.  **确定目标版本：** 确认目标 Apache Unomi 服务器的版本低于 1.5.2。
2.  **发送恶意请求：**  向 `/context.json` 端点发送包含恶意 OGNL 或 MVEL 表达式的 POST 请求。

    *   **MVEL POC：**
        ```json
        {
            "filters": [
                {
                    "id": "boom",
                    "filters": [
                        {
                            "condition": {
                                 "parameterValues": {
                                    "": "script::Runtime r = Runtime.getRuntime(); r.exec(\"gnome-calculator\");"
                                },
                                "type": "profilePropertyCondition"
                            }
                        }
                    ]
                }
            ],
            "sessionId": "boom"
        }
        ```

    *   **OGNL POC：**
        ```json
        {
          "personalizations":[
            {
              "id":"gender-test",
              "strategy":"matching-first",
              "strategyOptions":{
                "fallback":"var2"
              },
              "contents":[
                {
                  "filters":[
                    {
                      "condition":{
                        "parameterValues":{
                          "propertyName":"(#runtimeclass = #this.getClass().forName(\"java.lang.Runtime\")).(#getruntimemethod = #runtimeclass.getDeclaredMethods().{^ #this.name.equals(\"getRuntime\")}[0]).(#rtobj = #getruntimemethod.invoke(null,null)).(#execmethod = #runtimeclass.getDeclaredMethods().{? #this.name.equals(\"exec\")}.{? #this.getParameters()[0].getType().getName().equals(\"java.lang.String\")}.{? #this.getParameters().length < 2}[0]).(#execmethod.invoke(#rtobj,\" gnome-calculator\"))",
                          "comparisonOperator":"equals",
                          "propertyValue":"male"
                        },
                        "type":"profilePropertyCondition"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "sessionId":"boom"
        }
        ```
3.  **执行代码：**  如果漏洞存在且利用成功，服务器将执行恶意代码，例如打开计算器 (`gnome-calculator`)。

**有效性：**

提供的 POC 代码是有效的。搜索引擎结果和漏洞库信息均表明，此漏洞允许通过注入恶意 OGNL 或 MVEL 表达式来执行任意代码。该 POC 提供了两种利用方式：MVEL 和 OGNL。

**投毒风险：**

提供的代码片段中没有明显的恶意或隐藏功能。POC 主要目的是展示如何利用漏洞执行命令（例如启动计算器）。 因此，投毒风险评估为0%。


**项目地址:** [eugenebmx/CVE-2020-13942](https://github.com/eugenebmx/CVE-2020-13942)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)

---

## POC #4

**来源**: [CVE-2020-13942-hoanx4_apche_unomi_rce.md](../2020/CVE-2020-13942-hoanx4_apche_unomi_rce.md)

## CVE-2020-13942 - Apache Unomi Remote Code Execution

**漏洞编号:** CVE-2020-13942

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Apache Unomi

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 1.5.2

**利用条件:** 需要目标服务器运行Apache Unomi，且版本低于1.5.2，并且`/context.json`端点对外开放。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-13942 允许攻击者通过向 `/context.json` 端点注入恶意的 OGNL 或 MVEL 脚本来执行任意代码。该漏洞是由于 Apache Unomi 未能充分验证用户输入造成的。

**利用方式：**

1.  **确定目标：** 找到运行着 Apache Unomi 且版本低于 1.5.2 的服务器。
2.  **发送恶意请求：** 构造包含恶意 OGNL 或 MVEL 表达式的 HTTP POST 请求，并将其发送到 `/context.json` 端点。提供的 POC 代码中包含了 MVEL 和 OGNL 两种利用方式的示例。
    *   **MVEL POC：** 将 MVEL 表达式嵌入到 `parameterValues` 中，利用 `script::` 前缀执行任意系统命令。
    *   **OGNL POC：** 使用 Java 反射 API 绕过类加载器限制，然后执行系统命令。
3.  **执行代码：** 如果漏洞存在且利用成功，服务器将执行攻击者提供的恶意代码。提供的 POC 示例中执行了 `gnome-calculator` 命令，攻击者可以将其替换为任何其他命令。

**投毒风险分析：**

提供的代码仓库主要包含漏洞的说明文档和两种利用方式的 POC 代码（MVEL 和 OGNL）。代码的目的是演示漏洞，其中执行的`gnome-calculator`只是一个PoC验证手段，不能称之为后门代码。总体而言，仓库的内容是围绕漏洞利用展开的，**没有发现明显的恶意代码或后门**。

代码中是否存在作者隐藏的投毒代码的可能性较低，约为1%。主要原因如下：

*   代码相对简单，容易审计。
*   主要目的是演示漏洞利用，添加恶意代码可能会影响 POC 的有效性，降低其可信度。
*   虽然存在Perl脚本,但是仅仅作为辅助利用，本身未发现存在投毒代码的可能。通过上述分析，可以判断该代码仓库的投毒风险较低。

**项目地址:** [hoanx4/apche_unomi_rce](https://github.com/hoanx4/apche_unomi_rce)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)

---

## POC #5

**来源**: [CVE-2020-13942-lp008_CVE-2020-13942.md](../2020/CVE-2020-13942-lp008_CVE-2020-13942.md)

## CVE-2020-13942 Apache Unomi RCE

**漏洞编号:** CVE-2020-13942

**漏洞类型:** 远程代码执行

**影响应用:** Apache Unomi

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 1.5.2

**利用条件:** 目标服务器运行Apache Unomi 1.5.2之前的版本，且/context.json接口对外开放。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-13942是Apache Unomi中的一个远程代码执行漏洞。攻击者可以通过向/context.json端点注入恶意的OGNL或MVEL脚本来利用此漏洞。由于Unomi对用户输入验证不足，未经身份验证的攻击者可以发送包含恶意表达式的POST请求，从而在服务器上执行任意代码。

**有效性:**

提供的POC代码有效。它通过构造一个包含恶意脚本的JSON payload，并将其发送到/context.json端点来触发漏洞。Payload中使用了`Runtime.getRuntime().exec('whoami')`命令来执行系统命令，从而验证了RCE的存在。

**投毒风险:**

该仓库主要包含漏洞利用代码和检测规则。检测规则(`alert http any any -> any any ...`)是用于安全设备（如Snort或Suricata）检测此漏洞攻击的规则，本身不构成恶意代码。POC代码本身展示了如何利用此漏洞，但其中`Runtime.getRuntime().exec('whoami')`仅仅是验证漏洞存在性的指令,如果替换成更具破坏性的指令(例如删除关键文件),则会造成更大的危害。漏洞利用代码的风险主要体现在其潜在的滥用上，而不是代码本身包含后门或恶意组件。将此仓库判定为具有投毒风险的概率较低，大约10%。因为该代码仓库的主要目的是复现和验证漏洞。

**利用方式:**

1.  攻击者向目标Apache Unomi服务器的/context.json端点发送POST请求。
2.  请求体包含一个精心构造的JSON payload，其中包含恶意OGNL或MVEL表达式。
3.  Unomi服务器解析JSON payload，由于输入验证不足，恶意表达式被执行。
4.  攻击者利用表达式执行任意系统命令，从而控制服务器。

简而言之，利用方式是利用未经身份验证的OGNL/MVEL表达式注入，通过/context.json接口执行任意代码。

**项目地址:** [lp008/CVE-2020-13942](https://github.com/lp008/CVE-2020-13942)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)

---

## POC #6

**来源**: [CVE-2020-13942-shifa123_CVE-2020-13942-POC-.md](../2020/CVE-2020-13942-shifa123_CVE-2020-13942-POC-.md)

## CVE-2020-13942-Apache Unomi-远程代码执行

**漏洞编号:** CVE-2020-13942

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Unomi

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 1.5.2

**利用条件:** 需要目标服务器运行Apache Unomi，且版本低于1.5.2，并能够访问其/context.json端点。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-13942 允许攻击者通过向 `/context.json` 端点注入恶意的 OGNL 或 MVEL 脚本来执行任意代码。该漏洞存在于 Apache Unomi 1.5.2 之前的版本中。PoC 代码通过发送包含恶意脚本的 POST 请求到 `/context.json` 端点来利用此漏洞。 

**有效性：**
根据漏洞描述和搜索结果，该漏洞是一个远程代码执行漏洞，利用代码的目的是验证目标是否存在该漏洞，通过执行`id`命令并判断返回结果中是否包含特定的字符串来判断。因此，提供的PoC代码是有效的，可以用于检测目标系统是否存在CVE-2020-13942漏洞。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。脚本主要功能是读取 targets.txt 文件中的目标地址，然后向这些地址的 `/context.json` 端点发送包含恶意 OGNL/MVEL 表达式的 POST 请求，并根据返回结果判断目标是否存在漏洞。虽然攻击者可能利用此漏洞执行恶意操作，但该脚本本身并没有植入后门或进行其他恶意行为。因此，投毒风险为 0%。

**利用方式：**
1.  **目标枚举：**  收集目标Unomi实例的URL。
2.  **构造恶意请求：**  构建一个包含恶意OGNL或MVEL表达式的JSON数据，并将其作为POST请求发送到 `/context.json` 端点。
3.  **代码执行：**  Unomi服务器在处理请求时，会执行注入的恶意脚本，从而实现远程代码执行。
4.  **验证：** 通过检查执行命令的结果来验证漏洞是否成功利用。 

该漏洞的根本原因是Apache Unomi对用户输入的数据没有进行充分的验证和过滤，导致攻击者可以注入恶意脚本并执行。

**项目地址:** [shifa123/CVE-2020-13942-POC-](https://github.com/shifa123/CVE-2020-13942-POC-)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)

---

## POC #7

**来源**: [CVE-2020-13942-yaunsky_Unomi-CVE-2020-13942.md](../2020/CVE-2020-13942-yaunsky_Unomi-CVE-2020-13942.md)

## CVE-2020-13942 Apache Unomi Remote Code Execution

**漏洞编号:** CVE-2020-13942

**漏洞类型:** Remote Code Execution

**影响应用:** Apache Unomi

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 1.5.2

**利用条件:** 目标服务器运行Apache Unomi，且版本低于1.5.2，需要能够访问/context.json endpoint。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-13942 是 Apache Unomi 中存在的一个远程代码执行漏洞。攻击者可以通过向 /context.json 端点注入恶意的 OGNL 或 MVEL 脚本来执行任意代码。

**有效性：**

提供的POC代码 `UnomiExp.py` 看起来有效。它利用了OGNL表达式注入漏洞，允许攻击者执行系统命令或反弹shell。代码通过构造包含恶意 OGNL 表达式的 JSON 数据，并将其发送到 `/context.json` 端点来实现 RCE。

**投毒风险：**

分析提供的 `UnomiExp.py` 脚本和 `README.md` 文件，没有发现明显的投毒代码。脚本的功能集中在利用漏洞执行命令或反弹 shell 上，没有额外的恶意行为。图片文件路径仅为相对路径，没有引用外部链接，因此判断投毒风险为 0%。

**利用方式：**

1.  **确定目标：** 找到运行 Apache Unomi 且版本低于 1.5.2 的服务器。
2.  **构造Payload：**  使用提供的脚本 `UnomiExp.py`，指定目标 URL 和要执行的命令。命令可以使用常规命令，也可以是编码后的反弹 shell 命令。
3.  **发送请求：**  脚本会将构造好的包含恶意 OGNL 表达式的 JSON 数据发送到目标服务器的 `/context.json` 端点。
4.  **执行命令：**  目标服务器在处理请求时，会执行 OGNL 表达式，从而执行攻击者指定的命令。
5.  **获取结果：** 如果执行的是系统命令，结果会显示在响应中。如果是反弹 shell，则攻击者可以在监听端口上接收 shell 连接。

**项目地址:** [yaunsky/Unomi-CVE-2020-13942](https://github.com/yaunsky/Unomi-CVE-2020-13942)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)

---



---

## POC #2

**来源**: [CVE-2020-13942-blackmarketer_CVE-2020-13942.md](../2020/CVE-2020-13942-blackmarketer_CVE-2020-13942.md)

## CVE-2020-13942-Apache Unomi-RCE

**漏洞编号:** CVE-2020-13942

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Unomi

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 1.5.2

**利用条件:** 需要可以访问/context.json接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-13942是Apache Unomi中存在的一个远程代码执行漏洞。该漏洞是由于Apache Unomi未对/context.json公共端点接收的输入进行充分验证，攻击者可以通过注入恶意的OGNL或MVEL脚本来执行任意代码。

**有效性：**
提供的POC代码通过向/context.json端点发送包含恶意OGNL表达式的POST请求来利用此漏洞。该POC通过检查响应中是否存在特定的字符串（"boom"）来判断目标是否易受攻击，验证了漏洞的有效性。由于1.5.1版本只是部分修复，所以这个POC可以绕过1.5.1版本的修复。

**投毒风险：**
分析提供的漏洞利用代码，该代码主要功能是读取目标列表，并对每个目标发送包含恶意payload的HTTP请求，检查返回结果，判断目标是否存在漏洞，没有发现任何恶意代码，因此推断仓库中不存在作者隐藏的投毒代码的风险为0%。

**利用方式：**
1.  攻击者构造包含恶意OGNL或MVEL表达式的JSON数据。
2.  攻击者将构造的JSON数据通过POST请求发送到/context.json端点。
3.  Apache Unomi服务端在处理请求时，由于未充分验证输入，导致恶意表达式被执行，从而实现远程代码执行。

**缓解措施：**
*   升级到Apache Unomi 1.5.2或更高版本。
*   限制对/context.json端点的访问。

**项目地址:** [blackmarketer/CVE-2020-13942](https://github.com/blackmarketer/CVE-2020-13942)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)

---

## POC #3

**来源**: [CVE-2020-13942-corsisechero_CVE-2020-13942byVulHub.md](../2020/CVE-2020-13942-corsisechero_CVE-2020-13942byVulHub.md)

## CVE-2020-13942-Apache Unomi-RCE

**漏洞编号:** CVE-2020-13942

**漏洞类型:** 远程代码执行

**影响应用:** Apache Unomi

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 1.5.2

**利用条件:** 需要网络访问Unomi的/context.json端点

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-13942 漏洞存在于 Apache Unomi 1.5.2 之前的版本中。攻击者可以向 `/context.json` 公共端点注入恶意的 OGNL 或 MVEL 脚本，从而实现远程代码执行。

**有效性分析：**
提供的POC代码通过构造包含 MVEL 表达式的 JSON payload，并将其 POST 到 `/context.json` 端点，利用了 Unomi 对用户输入验证不严格的缺陷，成功执行了 `touch /tmp/pluto` 命令，创建了文件，证明 POC 代码有效。

**投毒风险分析：**
分析提供的漏洞利用代码仓库，发现代码主要包含 docker-compose 编排文件和用于触发漏洞的 curl 命令。docker-compose 文件定义了 Unomi 1.5.1 版本的 Docker 镜像和 Elasticsearch 镜像，环境搭建没有问题。curl 命令中的 MVEL 表达式 `script::Runtime r = Runtime.getRuntime(); r.exec("touch /tmp/pluto");` 用于在目标服务器上创建 `/tmp/pluto` 文件以验证漏洞。**没有发现作者隐藏的恶意代码，主要风险还是在于直接运行未经验证的第三方docker镜像。投毒风险较低，估计为1%。**

**利用方式：**
1.  攻击者构造包含恶意 MVEL 或 OGNL 表达式的 JSON 数据。
2.  将该 JSON 数据通过 HTTP POST 请求发送到 Apache Unomi 服务器的 `/context.json` 端点。
3.  Unomi 服务器解析 JSON 数据，由于输入验证不足，导致恶意表达式被执行，最终实现远程代码执行。

根据漏洞库信息，Apache Unomi 1.5.2 修复了此漏洞，强烈建议升级到最新版本。


**项目地址:** [corsisechero/CVE-2020-13942byVulHub](https://github.com/corsisechero/CVE-2020-13942byVulHub)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)

---

## POC #4

**来源**: [CVE-2020-13942-eugenebmx_CVE-2020-13942.md](../2020/CVE-2020-13942-eugenebmx_CVE-2020-13942.md)

## CVE-2020-13942 - Apache Unomi RCE

**漏洞编号:** CVE-2020-13942

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Unomi

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** < 1.5.2

**利用条件:** 需要可以访问/context.json端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-13942 存在于 Apache Unomi 1.5.2 之前的版本中。攻击者可以通过向 `/context.json` 端点注入恶意的 OGNL 或 MVEL 脚本来利用此漏洞，实现远程代码执行。

**漏洞利用方式：**

1.  **确定目标版本：** 确认目标 Apache Unomi 服务器的版本低于 1.5.2。
2.  **发送恶意请求：**  向 `/context.json` 端点发送包含恶意 OGNL 或 MVEL 表达式的 POST 请求。

    *   **MVEL POC：**
        ```json
        {
            "filters": [
                {
                    "id": "boom",
                    "filters": [
                        {
                            "condition": {
                                 "parameterValues": {
                                    "": "script::Runtime r = Runtime.getRuntime(); r.exec(\"gnome-calculator\");"
                                },
                                "type": "profilePropertyCondition"
                            }
                        }
                    ]
                }
            ],
            "sessionId": "boom"
        }
        ```

    *   **OGNL POC：**
        ```json
        {
          "personalizations":[
            {
              "id":"gender-test",
              "strategy":"matching-first",
              "strategyOptions":{
                "fallback":"var2"
              },
              "contents":[
                {
                  "filters":[
                    {
                      "condition":{
                        "parameterValues":{
                          "propertyName":"(#runtimeclass = #this.getClass().forName(\"java.lang.Runtime\")).(#getruntimemethod = #runtimeclass.getDeclaredMethods().{^ #this.name.equals(\"getRuntime\")}[0]).(#rtobj = #getruntimemethod.invoke(null,null)).(#execmethod = #runtimeclass.getDeclaredMethods().{? #this.name.equals(\"exec\")}.{? #this.getParameters()[0].getType().getName().equals(\"java.lang.String\")}.{? #this.getParameters().length < 2}[0]).(#execmethod.invoke(#rtobj,\" gnome-calculator\"))",
                          "comparisonOperator":"equals",
                          "propertyValue":"male"
                        },
                        "type":"profilePropertyCondition"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "sessionId":"boom"
        }
        ```
3.  **执行代码：**  如果漏洞存在且利用成功，服务器将执行恶意代码，例如打开计算器 (`gnome-calculator`)。

**有效性：**

提供的 POC 代码是有效的。搜索引擎结果和漏洞库信息均表明，此漏洞允许通过注入恶意 OGNL 或 MVEL 表达式来执行任意代码。该 POC 提供了两种利用方式：MVEL 和 OGNL。

**投毒风险：**

提供的代码片段中没有明显的恶意或隐藏功能。POC 主要目的是展示如何利用漏洞执行命令（例如启动计算器）。 因此，投毒风险评估为0%。


**项目地址:** [eugenebmx/CVE-2020-13942](https://github.com/eugenebmx/CVE-2020-13942)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)

---

## POC #5

**来源**: [CVE-2020-13942-hoanx4_apche_unomi_rce.md](../2020/CVE-2020-13942-hoanx4_apche_unomi_rce.md)

## CVE-2020-13942 - Apache Unomi Remote Code Execution

**漏洞编号:** CVE-2020-13942

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Apache Unomi

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 1.5.2

**利用条件:** 需要目标服务器运行Apache Unomi，且版本低于1.5.2，并且`/context.json`端点对外开放。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-13942 允许攻击者通过向 `/context.json` 端点注入恶意的 OGNL 或 MVEL 脚本来执行任意代码。该漏洞是由于 Apache Unomi 未能充分验证用户输入造成的。

**利用方式：**

1.  **确定目标：** 找到运行着 Apache Unomi 且版本低于 1.5.2 的服务器。
2.  **发送恶意请求：** 构造包含恶意 OGNL 或 MVEL 表达式的 HTTP POST 请求，并将其发送到 `/context.json` 端点。提供的 POC 代码中包含了 MVEL 和 OGNL 两种利用方式的示例。
    *   **MVEL POC：** 将 MVEL 表达式嵌入到 `parameterValues` 中，利用 `script::` 前缀执行任意系统命令。
    *   **OGNL POC：** 使用 Java 反射 API 绕过类加载器限制，然后执行系统命令。
3.  **执行代码：** 如果漏洞存在且利用成功，服务器将执行攻击者提供的恶意代码。提供的 POC 示例中执行了 `gnome-calculator` 命令，攻击者可以将其替换为任何其他命令。

**投毒风险分析：**

提供的代码仓库主要包含漏洞的说明文档和两种利用方式的 POC 代码（MVEL 和 OGNL）。代码的目的是演示漏洞，其中执行的`gnome-calculator`只是一个PoC验证手段，不能称之为后门代码。总体而言，仓库的内容是围绕漏洞利用展开的，**没有发现明显的恶意代码或后门**。

代码中是否存在作者隐藏的投毒代码的可能性较低，约为1%。主要原因如下：

*   代码相对简单，容易审计。
*   主要目的是演示漏洞利用，添加恶意代码可能会影响 POC 的有效性，降低其可信度。
*   虽然存在Perl脚本,但是仅仅作为辅助利用，本身未发现存在投毒代码的可能。通过上述分析，可以判断该代码仓库的投毒风险较低。

**项目地址:** [hoanx4/apche_unomi_rce](https://github.com/hoanx4/apche_unomi_rce)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)

---

## POC #6

**来源**: [CVE-2020-13942-lp008_CVE-2020-13942.md](../2020/CVE-2020-13942-lp008_CVE-2020-13942.md)

## CVE-2020-13942 Apache Unomi RCE

**漏洞编号:** CVE-2020-13942

**漏洞类型:** 远程代码执行

**影响应用:** Apache Unomi

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 1.5.2

**利用条件:** 目标服务器运行Apache Unomi 1.5.2之前的版本，且/context.json接口对外开放。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-13942是Apache Unomi中的一个远程代码执行漏洞。攻击者可以通过向/context.json端点注入恶意的OGNL或MVEL脚本来利用此漏洞。由于Unomi对用户输入验证不足，未经身份验证的攻击者可以发送包含恶意表达式的POST请求，从而在服务器上执行任意代码。

**有效性:**

提供的POC代码有效。它通过构造一个包含恶意脚本的JSON payload，并将其发送到/context.json端点来触发漏洞。Payload中使用了`Runtime.getRuntime().exec('whoami')`命令来执行系统命令，从而验证了RCE的存在。

**投毒风险:**

该仓库主要包含漏洞利用代码和检测规则。检测规则(`alert http any any -> any any ...`)是用于安全设备（如Snort或Suricata）检测此漏洞攻击的规则，本身不构成恶意代码。POC代码本身展示了如何利用此漏洞，但其中`Runtime.getRuntime().exec('whoami')`仅仅是验证漏洞存在性的指令,如果替换成更具破坏性的指令(例如删除关键文件),则会造成更大的危害。漏洞利用代码的风险主要体现在其潜在的滥用上，而不是代码本身包含后门或恶意组件。将此仓库判定为具有投毒风险的概率较低，大约10%。因为该代码仓库的主要目的是复现和验证漏洞。

**利用方式:**

1.  攻击者向目标Apache Unomi服务器的/context.json端点发送POST请求。
2.  请求体包含一个精心构造的JSON payload，其中包含恶意OGNL或MVEL表达式。
3.  Unomi服务器解析JSON payload，由于输入验证不足，恶意表达式被执行。
4.  攻击者利用表达式执行任意系统命令，从而控制服务器。

简而言之，利用方式是利用未经身份验证的OGNL/MVEL表达式注入，通过/context.json接口执行任意代码。

**项目地址:** [lp008/CVE-2020-13942](https://github.com/lp008/CVE-2020-13942)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)

---

## POC #7

**来源**: [CVE-2020-13942-shifa123_CVE-2020-13942-POC-.md](../2020/CVE-2020-13942-shifa123_CVE-2020-13942-POC-.md)

## CVE-2020-13942-Apache Unomi-远程代码执行

**漏洞编号:** CVE-2020-13942

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Unomi

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 1.5.2

**利用条件:** 需要目标服务器运行Apache Unomi，且版本低于1.5.2，并能够访问其/context.json端点。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-13942 允许攻击者通过向 `/context.json` 端点注入恶意的 OGNL 或 MVEL 脚本来执行任意代码。该漏洞存在于 Apache Unomi 1.5.2 之前的版本中。PoC 代码通过发送包含恶意脚本的 POST 请求到 `/context.json` 端点来利用此漏洞。 

**有效性：**
根据漏洞描述和搜索结果，该漏洞是一个远程代码执行漏洞，利用代码的目的是验证目标是否存在该漏洞，通过执行`id`命令并判断返回结果中是否包含特定的字符串来判断。因此，提供的PoC代码是有效的，可以用于检测目标系统是否存在CVE-2020-13942漏洞。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。脚本主要功能是读取 targets.txt 文件中的目标地址，然后向这些地址的 `/context.json` 端点发送包含恶意 OGNL/MVEL 表达式的 POST 请求，并根据返回结果判断目标是否存在漏洞。虽然攻击者可能利用此漏洞执行恶意操作，但该脚本本身并没有植入后门或进行其他恶意行为。因此，投毒风险为 0%。

**利用方式：**
1.  **目标枚举：**  收集目标Unomi实例的URL。
2.  **构造恶意请求：**  构建一个包含恶意OGNL或MVEL表达式的JSON数据，并将其作为POST请求发送到 `/context.json` 端点。
3.  **代码执行：**  Unomi服务器在处理请求时，会执行注入的恶意脚本，从而实现远程代码执行。
4.  **验证：** 通过检查执行命令的结果来验证漏洞是否成功利用。 

该漏洞的根本原因是Apache Unomi对用户输入的数据没有进行充分的验证和过滤，导致攻击者可以注入恶意脚本并执行。

**项目地址:** [shifa123/CVE-2020-13942-POC-](https://github.com/shifa123/CVE-2020-13942-POC-)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)

---

## POC #8

**来源**: [CVE-2020-13942-yaunsky_Unomi-CVE-2020-13942.md](../2020/CVE-2020-13942-yaunsky_Unomi-CVE-2020-13942.md)

## CVE-2020-13942 Apache Unomi Remote Code Execution

**漏洞编号:** CVE-2020-13942

**漏洞类型:** Remote Code Execution

**影响应用:** Apache Unomi

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 1.5.2

**利用条件:** 目标服务器运行Apache Unomi，且版本低于1.5.2，需要能够访问/context.json endpoint。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-13942 是 Apache Unomi 中存在的一个远程代码执行漏洞。攻击者可以通过向 /context.json 端点注入恶意的 OGNL 或 MVEL 脚本来执行任意代码。

**有效性：**

提供的POC代码 `UnomiExp.py` 看起来有效。它利用了OGNL表达式注入漏洞，允许攻击者执行系统命令或反弹shell。代码通过构造包含恶意 OGNL 表达式的 JSON 数据，并将其发送到 `/context.json` 端点来实现 RCE。

**投毒风险：**

分析提供的 `UnomiExp.py` 脚本和 `README.md` 文件，没有发现明显的投毒代码。脚本的功能集中在利用漏洞执行命令或反弹 shell 上，没有额外的恶意行为。图片文件路径仅为相对路径，没有引用外部链接，因此判断投毒风险为 0%。

**利用方式：**

1.  **确定目标：** 找到运行 Apache Unomi 且版本低于 1.5.2 的服务器。
2.  **构造Payload：**  使用提供的脚本 `UnomiExp.py`，指定目标 URL 和要执行的命令。命令可以使用常规命令，也可以是编码后的反弹 shell 命令。
3.  **发送请求：**  脚本会将构造好的包含恶意 OGNL 表达式的 JSON 数据发送到目标服务器的 `/context.json` 端点。
4.  **执行命令：**  目标服务器在处理请求时，会执行 OGNL 表达式，从而执行攻击者指定的命令。
5.  **获取结果：** 如果执行的是系统命令，结果会显示在响应中。如果是反弹 shell，则攻击者可以在监听端口上接收 shell 连接。

**项目地址:** [yaunsky/Unomi-CVE-2020-13942](https://github.com/yaunsky/Unomi-CVE-2020-13942)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)

---



---

## POC #2

**来源**: [CVE-2020-13942-blackmarketer_CVE-2020-13942.md](../2020/CVE-2020-13942-blackmarketer_CVE-2020-13942.md)

## CVE-2020-13942-Apache Unomi-RCE

**漏洞编号:** CVE-2020-13942

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Unomi

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 1.5.2

**利用条件:** 需要可以访问/context.json接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-13942是Apache Unomi中存在的一个远程代码执行漏洞。该漏洞是由于Apache Unomi未对/context.json公共端点接收的输入进行充分验证，攻击者可以通过注入恶意的OGNL或MVEL脚本来执行任意代码。

**有效性：**
提供的POC代码通过向/context.json端点发送包含恶意OGNL表达式的POST请求来利用此漏洞。该POC通过检查响应中是否存在特定的字符串（"boom"）来判断目标是否易受攻击，验证了漏洞的有效性。由于1.5.1版本只是部分修复，所以这个POC可以绕过1.5.1版本的修复。

**投毒风险：**
分析提供的漏洞利用代码，该代码主要功能是读取目标列表，并对每个目标发送包含恶意payload的HTTP请求，检查返回结果，判断目标是否存在漏洞，没有发现任何恶意代码，因此推断仓库中不存在作者隐藏的投毒代码的风险为0%。

**利用方式：**
1.  攻击者构造包含恶意OGNL或MVEL表达式的JSON数据。
2.  攻击者将构造的JSON数据通过POST请求发送到/context.json端点。
3.  Apache Unomi服务端在处理请求时，由于未充分验证输入，导致恶意表达式被执行，从而实现远程代码执行。

**缓解措施：**
*   升级到Apache Unomi 1.5.2或更高版本。
*   限制对/context.json端点的访问。

**项目地址:** [blackmarketer/CVE-2020-13942](https://github.com/blackmarketer/CVE-2020-13942)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)

---

## POC #3

**来源**: [CVE-2020-13942-corsisechero_CVE-2020-13942byVulHub.md](../2020/CVE-2020-13942-corsisechero_CVE-2020-13942byVulHub.md)

## CVE-2020-13942-Apache Unomi-RCE

**漏洞编号:** CVE-2020-13942

**漏洞类型:** 远程代码执行

**影响应用:** Apache Unomi

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 1.5.2

**利用条件:** 需要网络访问Unomi的/context.json端点

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-13942 漏洞存在于 Apache Unomi 1.5.2 之前的版本中。攻击者可以向 `/context.json` 公共端点注入恶意的 OGNL 或 MVEL 脚本，从而实现远程代码执行。

**有效性分析：**
提供的POC代码通过构造包含 MVEL 表达式的 JSON payload，并将其 POST 到 `/context.json` 端点，利用了 Unomi 对用户输入验证不严格的缺陷，成功执行了 `touch /tmp/pluto` 命令，创建了文件，证明 POC 代码有效。

**投毒风险分析：**
分析提供的漏洞利用代码仓库，发现代码主要包含 docker-compose 编排文件和用于触发漏洞的 curl 命令。docker-compose 文件定义了 Unomi 1.5.1 版本的 Docker 镜像和 Elasticsearch 镜像，环境搭建没有问题。curl 命令中的 MVEL 表达式 `script::Runtime r = Runtime.getRuntime(); r.exec("touch /tmp/pluto");` 用于在目标服务器上创建 `/tmp/pluto` 文件以验证漏洞。**没有发现作者隐藏的恶意代码，主要风险还是在于直接运行未经验证的第三方docker镜像。投毒风险较低，估计为1%。**

**利用方式：**
1.  攻击者构造包含恶意 MVEL 或 OGNL 表达式的 JSON 数据。
2.  将该 JSON 数据通过 HTTP POST 请求发送到 Apache Unomi 服务器的 `/context.json` 端点。
3.  Unomi 服务器解析 JSON 数据，由于输入验证不足，导致恶意表达式被执行，最终实现远程代码执行。

根据漏洞库信息，Apache Unomi 1.5.2 修复了此漏洞，强烈建议升级到最新版本。


**项目地址:** [corsisechero/CVE-2020-13942byVulHub](https://github.com/corsisechero/CVE-2020-13942byVulHub)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)

---

## POC #4

**来源**: [CVE-2020-13942-eugenebmx_CVE-2020-13942.md](../2020/CVE-2020-13942-eugenebmx_CVE-2020-13942.md)

## CVE-2020-13942 - Apache Unomi RCE

**漏洞编号:** CVE-2020-13942

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Unomi

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** < 1.5.2

**利用条件:** 需要可以访问/context.json端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-13942 存在于 Apache Unomi 1.5.2 之前的版本中。攻击者可以通过向 `/context.json` 端点注入恶意的 OGNL 或 MVEL 脚本来利用此漏洞，实现远程代码执行。

**漏洞利用方式：**

1.  **确定目标版本：** 确认目标 Apache Unomi 服务器的版本低于 1.5.2。
2.  **发送恶意请求：**  向 `/context.json` 端点发送包含恶意 OGNL 或 MVEL 表达式的 POST 请求。

    *   **MVEL POC：**
        ```json
        {
            "filters": [
                {
                    "id": "boom",
                    "filters": [
                        {
                            "condition": {
                                 "parameterValues": {
                                    "": "script::Runtime r = Runtime.getRuntime(); r.exec(\"gnome-calculator\");"
                                },
                                "type": "profilePropertyCondition"
                            }
                        }
                    ]
                }
            ],
            "sessionId": "boom"
        }
        ```

    *   **OGNL POC：**
        ```json
        {
          "personalizations":[
            {
              "id":"gender-test",
              "strategy":"matching-first",
              "strategyOptions":{
                "fallback":"var2"
              },
              "contents":[
                {
                  "filters":[
                    {
                      "condition":{
                        "parameterValues":{
                          "propertyName":"(#runtimeclass = #this.getClass().forName(\"java.lang.Runtime\")).(#getruntimemethod = #runtimeclass.getDeclaredMethods().{^ #this.name.equals(\"getRuntime\")}[0]).(#rtobj = #getruntimemethod.invoke(null,null)).(#execmethod = #runtimeclass.getDeclaredMethods().{? #this.name.equals(\"exec\")}.{? #this.getParameters()[0].getType().getName().equals(\"java.lang.String\")}.{? #this.getParameters().length < 2}[0]).(#execmethod.invoke(#rtobj,\" gnome-calculator\"))",
                          "comparisonOperator":"equals",
                          "propertyValue":"male"
                        },
                        "type":"profilePropertyCondition"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "sessionId":"boom"
        }
        ```
3.  **执行代码：**  如果漏洞存在且利用成功，服务器将执行恶意代码，例如打开计算器 (`gnome-calculator`)。

**有效性：**

提供的 POC 代码是有效的。搜索引擎结果和漏洞库信息均表明，此漏洞允许通过注入恶意 OGNL 或 MVEL 表达式来执行任意代码。该 POC 提供了两种利用方式：MVEL 和 OGNL。

**投毒风险：**

提供的代码片段中没有明显的恶意或隐藏功能。POC 主要目的是展示如何利用漏洞执行命令（例如启动计算器）。 因此，投毒风险评估为0%。


**项目地址:** [eugenebmx/CVE-2020-13942](https://github.com/eugenebmx/CVE-2020-13942)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)

---

## POC #5

**来源**: [CVE-2020-13942-hoanx4_apche_unomi_rce.md](../2020/CVE-2020-13942-hoanx4_apche_unomi_rce.md)

## CVE-2020-13942 - Apache Unomi Remote Code Execution

**漏洞编号:** CVE-2020-13942

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Apache Unomi

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 1.5.2

**利用条件:** 需要目标服务器运行Apache Unomi，且版本低于1.5.2，并且`/context.json`端点对外开放。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-13942 允许攻击者通过向 `/context.json` 端点注入恶意的 OGNL 或 MVEL 脚本来执行任意代码。该漏洞是由于 Apache Unomi 未能充分验证用户输入造成的。

**利用方式：**

1.  **确定目标：** 找到运行着 Apache Unomi 且版本低于 1.5.2 的服务器。
2.  **发送恶意请求：** 构造包含恶意 OGNL 或 MVEL 表达式的 HTTP POST 请求，并将其发送到 `/context.json` 端点。提供的 POC 代码中包含了 MVEL 和 OGNL 两种利用方式的示例。
    *   **MVEL POC：** 将 MVEL 表达式嵌入到 `parameterValues` 中，利用 `script::` 前缀执行任意系统命令。
    *   **OGNL POC：** 使用 Java 反射 API 绕过类加载器限制，然后执行系统命令。
3.  **执行代码：** 如果漏洞存在且利用成功，服务器将执行攻击者提供的恶意代码。提供的 POC 示例中执行了 `gnome-calculator` 命令，攻击者可以将其替换为任何其他命令。

**投毒风险分析：**

提供的代码仓库主要包含漏洞的说明文档和两种利用方式的 POC 代码（MVEL 和 OGNL）。代码的目的是演示漏洞，其中执行的`gnome-calculator`只是一个PoC验证手段，不能称之为后门代码。总体而言，仓库的内容是围绕漏洞利用展开的，**没有发现明显的恶意代码或后门**。

代码中是否存在作者隐藏的投毒代码的可能性较低，约为1%。主要原因如下：

*   代码相对简单，容易审计。
*   主要目的是演示漏洞利用，添加恶意代码可能会影响 POC 的有效性，降低其可信度。
*   虽然存在Perl脚本,但是仅仅作为辅助利用，本身未发现存在投毒代码的可能。通过上述分析，可以判断该代码仓库的投毒风险较低。

**项目地址:** [hoanx4/apche_unomi_rce](https://github.com/hoanx4/apche_unomi_rce)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)

---

## POC #6

**来源**: [CVE-2020-13942-lp008_CVE-2020-13942.md](../2020/CVE-2020-13942-lp008_CVE-2020-13942.md)

## CVE-2020-13942 Apache Unomi RCE

**漏洞编号:** CVE-2020-13942

**漏洞类型:** 远程代码执行

**影响应用:** Apache Unomi

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 1.5.2

**利用条件:** 目标服务器运行Apache Unomi 1.5.2之前的版本，且/context.json接口对外开放。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-13942是Apache Unomi中的一个远程代码执行漏洞。攻击者可以通过向/context.json端点注入恶意的OGNL或MVEL脚本来利用此漏洞。由于Unomi对用户输入验证不足，未经身份验证的攻击者可以发送包含恶意表达式的POST请求，从而在服务器上执行任意代码。

**有效性:**

提供的POC代码有效。它通过构造一个包含恶意脚本的JSON payload，并将其发送到/context.json端点来触发漏洞。Payload中使用了`Runtime.getRuntime().exec('whoami')`命令来执行系统命令，从而验证了RCE的存在。

**投毒风险:**

该仓库主要包含漏洞利用代码和检测规则。检测规则(`alert http any any -> any any ...`)是用于安全设备（如Snort或Suricata）检测此漏洞攻击的规则，本身不构成恶意代码。POC代码本身展示了如何利用此漏洞，但其中`Runtime.getRuntime().exec('whoami')`仅仅是验证漏洞存在性的指令,如果替换成更具破坏性的指令(例如删除关键文件),则会造成更大的危害。漏洞利用代码的风险主要体现在其潜在的滥用上，而不是代码本身包含后门或恶意组件。将此仓库判定为具有投毒风险的概率较低，大约10%。因为该代码仓库的主要目的是复现和验证漏洞。

**利用方式:**

1.  攻击者向目标Apache Unomi服务器的/context.json端点发送POST请求。
2.  请求体包含一个精心构造的JSON payload，其中包含恶意OGNL或MVEL表达式。
3.  Unomi服务器解析JSON payload，由于输入验证不足，恶意表达式被执行。
4.  攻击者利用表达式执行任意系统命令，从而控制服务器。

简而言之，利用方式是利用未经身份验证的OGNL/MVEL表达式注入，通过/context.json接口执行任意代码。

**项目地址:** [lp008/CVE-2020-13942](https://github.com/lp008/CVE-2020-13942)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)

---

## POC #7

**来源**: [CVE-2020-13942-shifa123_CVE-2020-13942-POC-.md](../2020/CVE-2020-13942-shifa123_CVE-2020-13942-POC-.md)

## CVE-2020-13942-Apache Unomi-远程代码执行

**漏洞编号:** CVE-2020-13942

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Unomi

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 1.5.2

**利用条件:** 需要目标服务器运行Apache Unomi，且版本低于1.5.2，并能够访问其/context.json端点。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-13942 允许攻击者通过向 `/context.json` 端点注入恶意的 OGNL 或 MVEL 脚本来执行任意代码。该漏洞存在于 Apache Unomi 1.5.2 之前的版本中。PoC 代码通过发送包含恶意脚本的 POST 请求到 `/context.json` 端点来利用此漏洞。 

**有效性：**
根据漏洞描述和搜索结果，该漏洞是一个远程代码执行漏洞，利用代码的目的是验证目标是否存在该漏洞，通过执行`id`命令并判断返回结果中是否包含特定的字符串来判断。因此，提供的PoC代码是有效的，可以用于检测目标系统是否存在CVE-2020-13942漏洞。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。脚本主要功能是读取 targets.txt 文件中的目标地址，然后向这些地址的 `/context.json` 端点发送包含恶意 OGNL/MVEL 表达式的 POST 请求，并根据返回结果判断目标是否存在漏洞。虽然攻击者可能利用此漏洞执行恶意操作，但该脚本本身并没有植入后门或进行其他恶意行为。因此，投毒风险为 0%。

**利用方式：**
1.  **目标枚举：**  收集目标Unomi实例的URL。
2.  **构造恶意请求：**  构建一个包含恶意OGNL或MVEL表达式的JSON数据，并将其作为POST请求发送到 `/context.json` 端点。
3.  **代码执行：**  Unomi服务器在处理请求时，会执行注入的恶意脚本，从而实现远程代码执行。
4.  **验证：** 通过检查执行命令的结果来验证漏洞是否成功利用。 

该漏洞的根本原因是Apache Unomi对用户输入的数据没有进行充分的验证和过滤，导致攻击者可以注入恶意脚本并执行。

**项目地址:** [shifa123/CVE-2020-13942-POC-](https://github.com/shifa123/CVE-2020-13942-POC-)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)

---

## POC #8

**来源**: [CVE-2020-13942-yaunsky_Unomi-CVE-2020-13942.md](../2020/CVE-2020-13942-yaunsky_Unomi-CVE-2020-13942.md)

## CVE-2020-13942 Apache Unomi Remote Code Execution

**漏洞编号:** CVE-2020-13942

**漏洞类型:** Remote Code Execution

**影响应用:** Apache Unomi

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 1.5.2

**利用条件:** 目标服务器运行Apache Unomi，且版本低于1.5.2，需要能够访问/context.json endpoint。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-13942 是 Apache Unomi 中存在的一个远程代码执行漏洞。攻击者可以通过向 /context.json 端点注入恶意的 OGNL 或 MVEL 脚本来执行任意代码。

**有效性：**

提供的POC代码 `UnomiExp.py` 看起来有效。它利用了OGNL表达式注入漏洞，允许攻击者执行系统命令或反弹shell。代码通过构造包含恶意 OGNL 表达式的 JSON 数据，并将其发送到 `/context.json` 端点来实现 RCE。

**投毒风险：**

分析提供的 `UnomiExp.py` 脚本和 `README.md` 文件，没有发现明显的投毒代码。脚本的功能集中在利用漏洞执行命令或反弹 shell 上，没有额外的恶意行为。图片文件路径仅为相对路径，没有引用外部链接，因此判断投毒风险为 0%。

**利用方式：**

1.  **确定目标：** 找到运行 Apache Unomi 且版本低于 1.5.2 的服务器。
2.  **构造Payload：**  使用提供的脚本 `UnomiExp.py`，指定目标 URL 和要执行的命令。命令可以使用常规命令，也可以是编码后的反弹 shell 命令。
3.  **发送请求：**  脚本会将构造好的包含恶意 OGNL 表达式的 JSON 数据发送到目标服务器的 `/context.json` 端点。
4.  **执行命令：**  目标服务器在处理请求时，会执行 OGNL 表达式，从而执行攻击者指定的命令。
5.  **获取结果：** 如果执行的是系统命令，结果会显示在响应中。如果是反弹 shell，则攻击者可以在监听端口上接收 shell 连接。

**项目地址:** [yaunsky/Unomi-CVE-2020-13942](https://github.com/yaunsky/Unomi-CVE-2020-13942)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)

---



---

## POC #2

**来源**: [CVE-2020-13942-blackmarketer_CVE-2020-13942.md](../2020/CVE-2020-13942-blackmarketer_CVE-2020-13942.md)

## CVE-2020-13942-Apache Unomi-RCE

**漏洞编号:** CVE-2020-13942

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Unomi

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 1.5.2

**利用条件:** 需要可以访问/context.json接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-13942是Apache Unomi中存在的一个远程代码执行漏洞。该漏洞是由于Apache Unomi未对/context.json公共端点接收的输入进行充分验证，攻击者可以通过注入恶意的OGNL或MVEL脚本来执行任意代码。

**有效性：**
提供的POC代码通过向/context.json端点发送包含恶意OGNL表达式的POST请求来利用此漏洞。该POC通过检查响应中是否存在特定的字符串（"boom"）来判断目标是否易受攻击，验证了漏洞的有效性。由于1.5.1版本只是部分修复，所以这个POC可以绕过1.5.1版本的修复。

**投毒风险：**
分析提供的漏洞利用代码，该代码主要功能是读取目标列表，并对每个目标发送包含恶意payload的HTTP请求，检查返回结果，判断目标是否存在漏洞，没有发现任何恶意代码，因此推断仓库中不存在作者隐藏的投毒代码的风险为0%。

**利用方式：**
1.  攻击者构造包含恶意OGNL或MVEL表达式的JSON数据。
2.  攻击者将构造的JSON数据通过POST请求发送到/context.json端点。
3.  Apache Unomi服务端在处理请求时，由于未充分验证输入，导致恶意表达式被执行，从而实现远程代码执行。

**缓解措施：**
*   升级到Apache Unomi 1.5.2或更高版本。
*   限制对/context.json端点的访问。

**项目地址:** [blackmarketer/CVE-2020-13942](https://github.com/blackmarketer/CVE-2020-13942)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)

---

## POC #3

**来源**: [CVE-2020-13942-corsisechero_CVE-2020-13942byVulHub.md](../2020/CVE-2020-13942-corsisechero_CVE-2020-13942byVulHub.md)

## CVE-2020-13942-Apache Unomi-RCE

**漏洞编号:** CVE-2020-13942

**漏洞类型:** 远程代码执行

**影响应用:** Apache Unomi

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 1.5.2

**利用条件:** 需要网络访问Unomi的/context.json端点

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-13942 漏洞存在于 Apache Unomi 1.5.2 之前的版本中。攻击者可以向 `/context.json` 公共端点注入恶意的 OGNL 或 MVEL 脚本，从而实现远程代码执行。

**有效性分析：**
提供的POC代码通过构造包含 MVEL 表达式的 JSON payload，并将其 POST 到 `/context.json` 端点，利用了 Unomi 对用户输入验证不严格的缺陷，成功执行了 `touch /tmp/pluto` 命令，创建了文件，证明 POC 代码有效。

**投毒风险分析：**
分析提供的漏洞利用代码仓库，发现代码主要包含 docker-compose 编排文件和用于触发漏洞的 curl 命令。docker-compose 文件定义了 Unomi 1.5.1 版本的 Docker 镜像和 Elasticsearch 镜像，环境搭建没有问题。curl 命令中的 MVEL 表达式 `script::Runtime r = Runtime.getRuntime(); r.exec("touch /tmp/pluto");` 用于在目标服务器上创建 `/tmp/pluto` 文件以验证漏洞。**没有发现作者隐藏的恶意代码，主要风险还是在于直接运行未经验证的第三方docker镜像。投毒风险较低，估计为1%。**

**利用方式：**
1.  攻击者构造包含恶意 MVEL 或 OGNL 表达式的 JSON 数据。
2.  将该 JSON 数据通过 HTTP POST 请求发送到 Apache Unomi 服务器的 `/context.json` 端点。
3.  Unomi 服务器解析 JSON 数据，由于输入验证不足，导致恶意表达式被执行，最终实现远程代码执行。

根据漏洞库信息，Apache Unomi 1.5.2 修复了此漏洞，强烈建议升级到最新版本。


**项目地址:** [corsisechero/CVE-2020-13942byVulHub](https://github.com/corsisechero/CVE-2020-13942byVulHub)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)

---

## POC #4

**来源**: [CVE-2020-13942-eugenebmx_CVE-2020-13942.md](../2020/CVE-2020-13942-eugenebmx_CVE-2020-13942.md)

## CVE-2020-13942 - Apache Unomi RCE

**漏洞编号:** CVE-2020-13942

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Unomi

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** < 1.5.2

**利用条件:** 需要可以访问/context.json端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-13942 存在于 Apache Unomi 1.5.2 之前的版本中。攻击者可以通过向 `/context.json` 端点注入恶意的 OGNL 或 MVEL 脚本来利用此漏洞，实现远程代码执行。

**漏洞利用方式：**

1.  **确定目标版本：** 确认目标 Apache Unomi 服务器的版本低于 1.5.2。
2.  **发送恶意请求：**  向 `/context.json` 端点发送包含恶意 OGNL 或 MVEL 表达式的 POST 请求。

    *   **MVEL POC：**
        ```json
        {
            "filters": [
                {
                    "id": "boom",
                    "filters": [
                        {
                            "condition": {
                                 "parameterValues": {
                                    "": "script::Runtime r = Runtime.getRuntime(); r.exec(\"gnome-calculator\");"
                                },
                                "type": "profilePropertyCondition"
                            }
                        }
                    ]
                }
            ],
            "sessionId": "boom"
        }
        ```

    *   **OGNL POC：**
        ```json
        {
          "personalizations":[
            {
              "id":"gender-test",
              "strategy":"matching-first",
              "strategyOptions":{
                "fallback":"var2"
              },
              "contents":[
                {
                  "filters":[
                    {
                      "condition":{
                        "parameterValues":{
                          "propertyName":"(#runtimeclass = #this.getClass().forName(\"java.lang.Runtime\")).(#getruntimemethod = #runtimeclass.getDeclaredMethods().{^ #this.name.equals(\"getRuntime\")}[0]).(#rtobj = #getruntimemethod.invoke(null,null)).(#execmethod = #runtimeclass.getDeclaredMethods().{? #this.name.equals(\"exec\")}.{? #this.getParameters()[0].getType().getName().equals(\"java.lang.String\")}.{? #this.getParameters().length < 2}[0]).(#execmethod.invoke(#rtobj,\" gnome-calculator\"))",
                          "comparisonOperator":"equals",
                          "propertyValue":"male"
                        },
                        "type":"profilePropertyCondition"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "sessionId":"boom"
        }
        ```
3.  **执行代码：**  如果漏洞存在且利用成功，服务器将执行恶意代码，例如打开计算器 (`gnome-calculator`)。

**有效性：**

提供的 POC 代码是有效的。搜索引擎结果和漏洞库信息均表明，此漏洞允许通过注入恶意 OGNL 或 MVEL 表达式来执行任意代码。该 POC 提供了两种利用方式：MVEL 和 OGNL。

**投毒风险：**

提供的代码片段中没有明显的恶意或隐藏功能。POC 主要目的是展示如何利用漏洞执行命令（例如启动计算器）。 因此，投毒风险评估为0%。


**项目地址:** [eugenebmx/CVE-2020-13942](https://github.com/eugenebmx/CVE-2020-13942)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)

---

## POC #5

**来源**: [CVE-2020-13942-hoanx4_apche_unomi_rce.md](../2020/CVE-2020-13942-hoanx4_apche_unomi_rce.md)

## CVE-2020-13942 - Apache Unomi Remote Code Execution

**漏洞编号:** CVE-2020-13942

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Apache Unomi

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 1.5.2

**利用条件:** 需要目标服务器运行Apache Unomi，且版本低于1.5.2，并且`/context.json`端点对外开放。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-13942 允许攻击者通过向 `/context.json` 端点注入恶意的 OGNL 或 MVEL 脚本来执行任意代码。该漏洞是由于 Apache Unomi 未能充分验证用户输入造成的。

**利用方式：**

1.  **确定目标：** 找到运行着 Apache Unomi 且版本低于 1.5.2 的服务器。
2.  **发送恶意请求：** 构造包含恶意 OGNL 或 MVEL 表达式的 HTTP POST 请求，并将其发送到 `/context.json` 端点。提供的 POC 代码中包含了 MVEL 和 OGNL 两种利用方式的示例。
    *   **MVEL POC：** 将 MVEL 表达式嵌入到 `parameterValues` 中，利用 `script::` 前缀执行任意系统命令。
    *   **OGNL POC：** 使用 Java 反射 API 绕过类加载器限制，然后执行系统命令。
3.  **执行代码：** 如果漏洞存在且利用成功，服务器将执行攻击者提供的恶意代码。提供的 POC 示例中执行了 `gnome-calculator` 命令，攻击者可以将其替换为任何其他命令。

**投毒风险分析：**

提供的代码仓库主要包含漏洞的说明文档和两种利用方式的 POC 代码（MVEL 和 OGNL）。代码的目的是演示漏洞，其中执行的`gnome-calculator`只是一个PoC验证手段，不能称之为后门代码。总体而言，仓库的内容是围绕漏洞利用展开的，**没有发现明显的恶意代码或后门**。

代码中是否存在作者隐藏的投毒代码的可能性较低，约为1%。主要原因如下：

*   代码相对简单，容易审计。
*   主要目的是演示漏洞利用，添加恶意代码可能会影响 POC 的有效性，降低其可信度。
*   虽然存在Perl脚本,但是仅仅作为辅助利用，本身未发现存在投毒代码的可能。通过上述分析，可以判断该代码仓库的投毒风险较低。

**项目地址:** [hoanx4/apche_unomi_rce](https://github.com/hoanx4/apche_unomi_rce)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)

---

## POC #6

**来源**: [CVE-2020-13942-lp008_CVE-2020-13942.md](../2020/CVE-2020-13942-lp008_CVE-2020-13942.md)

## CVE-2020-13942 Apache Unomi RCE

**漏洞编号:** CVE-2020-13942

**漏洞类型:** 远程代码执行

**影响应用:** Apache Unomi

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 1.5.2

**利用条件:** 目标服务器运行Apache Unomi 1.5.2之前的版本，且/context.json接口对外开放。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-13942是Apache Unomi中的一个远程代码执行漏洞。攻击者可以通过向/context.json端点注入恶意的OGNL或MVEL脚本来利用此漏洞。由于Unomi对用户输入验证不足，未经身份验证的攻击者可以发送包含恶意表达式的POST请求，从而在服务器上执行任意代码。

**有效性:**

提供的POC代码有效。它通过构造一个包含恶意脚本的JSON payload，并将其发送到/context.json端点来触发漏洞。Payload中使用了`Runtime.getRuntime().exec('whoami')`命令来执行系统命令，从而验证了RCE的存在。

**投毒风险:**

该仓库主要包含漏洞利用代码和检测规则。检测规则(`alert http any any -> any any ...`)是用于安全设备（如Snort或Suricata）检测此漏洞攻击的规则，本身不构成恶意代码。POC代码本身展示了如何利用此漏洞，但其中`Runtime.getRuntime().exec('whoami')`仅仅是验证漏洞存在性的指令,如果替换成更具破坏性的指令(例如删除关键文件),则会造成更大的危害。漏洞利用代码的风险主要体现在其潜在的滥用上，而不是代码本身包含后门或恶意组件。将此仓库判定为具有投毒风险的概率较低，大约10%。因为该代码仓库的主要目的是复现和验证漏洞。

**利用方式:**

1.  攻击者向目标Apache Unomi服务器的/context.json端点发送POST请求。
2.  请求体包含一个精心构造的JSON payload，其中包含恶意OGNL或MVEL表达式。
3.  Unomi服务器解析JSON payload，由于输入验证不足，恶意表达式被执行。
4.  攻击者利用表达式执行任意系统命令，从而控制服务器。

简而言之，利用方式是利用未经身份验证的OGNL/MVEL表达式注入，通过/context.json接口执行任意代码。

**项目地址:** [lp008/CVE-2020-13942](https://github.com/lp008/CVE-2020-13942)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)

---

## POC #7

**来源**: [CVE-2020-13942-shifa123_CVE-2020-13942-POC-.md](../2020/CVE-2020-13942-shifa123_CVE-2020-13942-POC-.md)

## CVE-2020-13942-Apache Unomi-远程代码执行

**漏洞编号:** CVE-2020-13942

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Unomi

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 1.5.2

**利用条件:** 需要目标服务器运行Apache Unomi，且版本低于1.5.2，并能够访问其/context.json端点。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-13942 允许攻击者通过向 `/context.json` 端点注入恶意的 OGNL 或 MVEL 脚本来执行任意代码。该漏洞存在于 Apache Unomi 1.5.2 之前的版本中。PoC 代码通过发送包含恶意脚本的 POST 请求到 `/context.json` 端点来利用此漏洞。 

**有效性：**
根据漏洞描述和搜索结果，该漏洞是一个远程代码执行漏洞，利用代码的目的是验证目标是否存在该漏洞，通过执行`id`命令并判断返回结果中是否包含特定的字符串来判断。因此，提供的PoC代码是有效的，可以用于检测目标系统是否存在CVE-2020-13942漏洞。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。脚本主要功能是读取 targets.txt 文件中的目标地址，然后向这些地址的 `/context.json` 端点发送包含恶意 OGNL/MVEL 表达式的 POST 请求，并根据返回结果判断目标是否存在漏洞。虽然攻击者可能利用此漏洞执行恶意操作，但该脚本本身并没有植入后门或进行其他恶意行为。因此，投毒风险为 0%。

**利用方式：**
1.  **目标枚举：**  收集目标Unomi实例的URL。
2.  **构造恶意请求：**  构建一个包含恶意OGNL或MVEL表达式的JSON数据，并将其作为POST请求发送到 `/context.json` 端点。
3.  **代码执行：**  Unomi服务器在处理请求时，会执行注入的恶意脚本，从而实现远程代码执行。
4.  **验证：** 通过检查执行命令的结果来验证漏洞是否成功利用。 

该漏洞的根本原因是Apache Unomi对用户输入的数据没有进行充分的验证和过滤，导致攻击者可以注入恶意脚本并执行。

**项目地址:** [shifa123/CVE-2020-13942-POC-](https://github.com/shifa123/CVE-2020-13942-POC-)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)

---

## POC #8

**来源**: [CVE-2020-13942-yaunsky_Unomi-CVE-2020-13942.md](../2020/CVE-2020-13942-yaunsky_Unomi-CVE-2020-13942.md)

## CVE-2020-13942 Apache Unomi Remote Code Execution

**漏洞编号:** CVE-2020-13942

**漏洞类型:** Remote Code Execution

**影响应用:** Apache Unomi

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 1.5.2

**利用条件:** 目标服务器运行Apache Unomi，且版本低于1.5.2，需要能够访问/context.json endpoint。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-13942 是 Apache Unomi 中存在的一个远程代码执行漏洞。攻击者可以通过向 /context.json 端点注入恶意的 OGNL 或 MVEL 脚本来执行任意代码。

**有效性：**

提供的POC代码 `UnomiExp.py` 看起来有效。它利用了OGNL表达式注入漏洞，允许攻击者执行系统命令或反弹shell。代码通过构造包含恶意 OGNL 表达式的 JSON 数据，并将其发送到 `/context.json` 端点来实现 RCE。

**投毒风险：**

分析提供的 `UnomiExp.py` 脚本和 `README.md` 文件，没有发现明显的投毒代码。脚本的功能集中在利用漏洞执行命令或反弹 shell 上，没有额外的恶意行为。图片文件路径仅为相对路径，没有引用外部链接，因此判断投毒风险为 0%。

**利用方式：**

1.  **确定目标：** 找到运行 Apache Unomi 且版本低于 1.5.2 的服务器。
2.  **构造Payload：**  使用提供的脚本 `UnomiExp.py`，指定目标 URL 和要执行的命令。命令可以使用常规命令，也可以是编码后的反弹 shell 命令。
3.  **发送请求：**  脚本会将构造好的包含恶意 OGNL 表达式的 JSON 数据发送到目标服务器的 `/context.json` 端点。
4.  **执行命令：**  目标服务器在处理请求时，会执行 OGNL 表达式，从而执行攻击者指定的命令。
5.  **获取结果：** 如果执行的是系统命令，结果会显示在响应中。如果是反弹 shell，则攻击者可以在监听端口上接收 shell 连接。

**项目地址:** [yaunsky/Unomi-CVE-2020-13942](https://github.com/yaunsky/Unomi-CVE-2020-13942)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)

---

