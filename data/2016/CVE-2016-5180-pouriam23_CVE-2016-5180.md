# CVE-2016-5180

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-5180-pouriam23_CVE-2016-5180-docker-.md](../2016/CVE-2016-5180-pouriam23_CVE-2016-5180-docker-.md)

## CVE-2016-5180-c-ares 堆缓冲区溢出

**漏洞编号:** CVE-2016-5180

**漏洞类型:** 堆缓冲区溢出

**影响应用:** c-ares

**危害等级:** 高危，可能导致拒绝服务或远程代码执行

**影响版本:** c-ares 1.x before 1.12.0

**利用条件:** 需要应用程序使用c-ares库进行DNS解析，并且可以控制或影响被解析的域名。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息，CVE-2016-5180是c-ares 1.12.0之前版本中`ares_create_query`函数中存在的一个基于堆的缓冲区溢出漏洞。攻击者可以通过构造包含转义尾点（escaped trailing dot）的恶意hostname，导致越界写入，从而可能导致拒绝服务或任意代码执行。

**有效性：**

提供的PoC代码是一个Node.js应用，它模拟了一个可能受到该漏洞影响的场景。应用接受用户提供的URL作为callback，并使用`dns.resolve`函数解析该URL的hostname。由于Node.js的`dns.resolve`底层使用了c-ares库，如果c-ares库的版本存在漏洞，则该应用会受到CVE-2016-5180的影响。该POC验证了可以通过控制hostname（callback URL）来触发漏洞，因此有效。

**投毒风险：**

分析提供的Dockerfile、package.json和server.js文件，没有发现任何明显的投毒代码。代码逻辑清晰，主要功能是接收URL并使用dns.resolve进行解析。所有依赖项都是常用的npm库。 因此，投毒风险评估为0%。

**利用方式：**

1.  **攻击者构造恶意的hostname**：hostname包含转义的尾点（例如，`hello\.`），导致`ares_create_query`函数计算hostname大小时出现错误。
2.  **提交恶意hostname给存在漏洞的应用程序**：攻击者将构造好的hostname作为输入（在PoC代码中是callback URL）提交给应用程序。
3.  **触发缓冲区溢出**：应用程序使用c-ares库解析hostname，`ares_create_query`函数分配的缓冲区过小，导致在复制hostname时发生堆缓冲区溢出。
4.  **利用缓冲区溢出**：攻击者可以通过控制溢出的内容，实现拒绝服务（DoS）或者进一步执行任意代码。

**总结：**

该漏洞利用方式主要是通过精心构造的hostname，利用c-ares库在处理转义尾点时的缺陷，触发堆缓冲区溢出。PoC代码提供了一种模拟和验证该漏洞的方式，可以通过控制hostname来触发漏洞，但本身不包含投毒代码。

**项目地址:** [pouriam23/CVE-2016-5180-docker-](https://github.com/pouriam23/CVE-2016-5180-docker-)

**漏洞详情:** [CVE-2016-5180](https://nvd.nist.gov/vuln/detail/CVE-2016-5180)

---

## POC #2

**来源**: [CVE-2016-5180-pouriam23_CVE-2016-5180.md](../2016/CVE-2016-5180-pouriam23_CVE-2016-5180.md)

# CVE-2016-5180

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-5180-pouriam23_CVE-2016-5180-docker-.md](../2016/CVE-2016-5180-pouriam23_CVE-2016-5180-docker-.md)

## CVE-2016-5180-c-ares 堆缓冲区溢出

**漏洞编号:** CVE-2016-5180

**漏洞类型:** 堆缓冲区溢出

**影响应用:** c-ares

**危害等级:** 高危，可能导致拒绝服务或远程代码执行

**影响版本:** c-ares 1.x before 1.12.0

**利用条件:** 需要应用程序使用c-ares库进行DNS解析，并且可以控制或影响被解析的域名。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息，CVE-2016-5180是c-ares 1.12.0之前版本中`ares_create_query`函数中存在的一个基于堆的缓冲区溢出漏洞。攻击者可以通过构造包含转义尾点（escaped trailing dot）的恶意hostname，导致越界写入，从而可能导致拒绝服务或任意代码执行。

**有效性：**

提供的PoC代码是一个Node.js应用，它模拟了一个可能受到该漏洞影响的场景。应用接受用户提供的URL作为callback，并使用`dns.resolve`函数解析该URL的hostname。由于Node.js的`dns.resolve`底层使用了c-ares库，如果c-ares库的版本存在漏洞，则该应用会受到CVE-2016-5180的影响。该POC验证了可以通过控制hostname（callback URL）来触发漏洞，因此有效。

**投毒风险：**

分析提供的Dockerfile、package.json和server.js文件，没有发现任何明显的投毒代码。代码逻辑清晰，主要功能是接收URL并使用dns.resolve进行解析。所有依赖项都是常用的npm库。 因此，投毒风险评估为0%。

**利用方式：**

1.  **攻击者构造恶意的hostname**：hostname包含转义的尾点（例如，`hello\.`），导致`ares_create_query`函数计算hostname大小时出现错误。
2.  **提交恶意hostname给存在漏洞的应用程序**：攻击者将构造好的hostname作为输入（在PoC代码中是callback URL）提交给应用程序。
3.  **触发缓冲区溢出**：应用程序使用c-ares库解析hostname，`ares_create_query`函数分配的缓冲区过小，导致在复制hostname时发生堆缓冲区溢出。
4.  **利用缓冲区溢出**：攻击者可以通过控制溢出的内容，实现拒绝服务（DoS）或者进一步执行任意代码。

**总结：**

该漏洞利用方式主要是通过精心构造的hostname，利用c-ares库在处理转义尾点时的缺陷，触发堆缓冲区溢出。PoC代码提供了一种模拟和验证该漏洞的方式，可以通过控制hostname来触发漏洞，但本身不包含投毒代码。

**项目地址:** [pouriam23/CVE-2016-5180-docker-](https://github.com/pouriam23/CVE-2016-5180-docker-)

**漏洞详情:** [CVE-2016-5180](https://nvd.nist.gov/vuln/detail/CVE-2016-5180)

---

## POC #2

**来源**: [CVE-2016-5180-pouriam23_CVE-2016-5180.md](../2016/CVE-2016-5180-pouriam23_CVE-2016-5180.md)

# CVE-2016-5180

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-5180-pouriam23_CVE-2016-5180-docker-.md](../2016/CVE-2016-5180-pouriam23_CVE-2016-5180-docker-.md)

## CVE-2016-5180-c-ares 堆缓冲区溢出

**漏洞编号:** CVE-2016-5180

**漏洞类型:** 堆缓冲区溢出

**影响应用:** c-ares

**危害等级:** 高危，可能导致拒绝服务或远程代码执行

**影响版本:** c-ares 1.x before 1.12.0

**利用条件:** 需要应用程序使用c-ares库进行DNS解析，并且可以控制或影响被解析的域名。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息，CVE-2016-5180是c-ares 1.12.0之前版本中`ares_create_query`函数中存在的一个基于堆的缓冲区溢出漏洞。攻击者可以通过构造包含转义尾点（escaped trailing dot）的恶意hostname，导致越界写入，从而可能导致拒绝服务或任意代码执行。

**有效性：**

提供的PoC代码是一个Node.js应用，它模拟了一个可能受到该漏洞影响的场景。应用接受用户提供的URL作为callback，并使用`dns.resolve`函数解析该URL的hostname。由于Node.js的`dns.resolve`底层使用了c-ares库，如果c-ares库的版本存在漏洞，则该应用会受到CVE-2016-5180的影响。该POC验证了可以通过控制hostname（callback URL）来触发漏洞，因此有效。

**投毒风险：**

分析提供的Dockerfile、package.json和server.js文件，没有发现任何明显的投毒代码。代码逻辑清晰，主要功能是接收URL并使用dns.resolve进行解析。所有依赖项都是常用的npm库。 因此，投毒风险评估为0%。

**利用方式：**

1.  **攻击者构造恶意的hostname**：hostname包含转义的尾点（例如，`hello\.`），导致`ares_create_query`函数计算hostname大小时出现错误。
2.  **提交恶意hostname给存在漏洞的应用程序**：攻击者将构造好的hostname作为输入（在PoC代码中是callback URL）提交给应用程序。
3.  **触发缓冲区溢出**：应用程序使用c-ares库解析hostname，`ares_create_query`函数分配的缓冲区过小，导致在复制hostname时发生堆缓冲区溢出。
4.  **利用缓冲区溢出**：攻击者可以通过控制溢出的内容，实现拒绝服务（DoS）或者进一步执行任意代码。

**总结：**

该漏洞利用方式主要是通过精心构造的hostname，利用c-ares库在处理转义尾点时的缺陷，触发堆缓冲区溢出。PoC代码提供了一种模拟和验证该漏洞的方式，可以通过控制hostname来触发漏洞，但本身不包含投毒代码。

**项目地址:** [pouriam23/CVE-2016-5180-docker-](https://github.com/pouriam23/CVE-2016-5180-docker-)

**漏洞详情:** [CVE-2016-5180](https://nvd.nist.gov/vuln/detail/CVE-2016-5180)

---

## POC #2

**来源**: [CVE-2016-5180-pouriam23_CVE-2016-5180.md](../2016/CVE-2016-5180-pouriam23_CVE-2016-5180.md)

# CVE-2016-5180

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-5180-pouriam23_CVE-2016-5180-docker-.md](../2016/CVE-2016-5180-pouriam23_CVE-2016-5180-docker-.md)

## CVE-2016-5180-c-ares 堆缓冲区溢出

**漏洞编号:** CVE-2016-5180

**漏洞类型:** 堆缓冲区溢出

**影响应用:** c-ares

**危害等级:** 高危，可能导致拒绝服务或远程代码执行

**影响版本:** c-ares 1.x before 1.12.0

**利用条件:** 需要应用程序使用c-ares库进行DNS解析，并且可以控制或影响被解析的域名。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息，CVE-2016-5180是c-ares 1.12.0之前版本中`ares_create_query`函数中存在的一个基于堆的缓冲区溢出漏洞。攻击者可以通过构造包含转义尾点（escaped trailing dot）的恶意hostname，导致越界写入，从而可能导致拒绝服务或任意代码执行。

**有效性：**

提供的PoC代码是一个Node.js应用，它模拟了一个可能受到该漏洞影响的场景。应用接受用户提供的URL作为callback，并使用`dns.resolve`函数解析该URL的hostname。由于Node.js的`dns.resolve`底层使用了c-ares库，如果c-ares库的版本存在漏洞，则该应用会受到CVE-2016-5180的影响。该POC验证了可以通过控制hostname（callback URL）来触发漏洞，因此有效。

**投毒风险：**

分析提供的Dockerfile、package.json和server.js文件，没有发现任何明显的投毒代码。代码逻辑清晰，主要功能是接收URL并使用dns.resolve进行解析。所有依赖项都是常用的npm库。 因此，投毒风险评估为0%。

**利用方式：**

1.  **攻击者构造恶意的hostname**：hostname包含转义的尾点（例如，`hello\.`），导致`ares_create_query`函数计算hostname大小时出现错误。
2.  **提交恶意hostname给存在漏洞的应用程序**：攻击者将构造好的hostname作为输入（在PoC代码中是callback URL）提交给应用程序。
3.  **触发缓冲区溢出**：应用程序使用c-ares库解析hostname，`ares_create_query`函数分配的缓冲区过小，导致在复制hostname时发生堆缓冲区溢出。
4.  **利用缓冲区溢出**：攻击者可以通过控制溢出的内容，实现拒绝服务（DoS）或者进一步执行任意代码。

**总结：**

该漏洞利用方式主要是通过精心构造的hostname，利用c-ares库在处理转义尾点时的缺陷，触发堆缓冲区溢出。PoC代码提供了一种模拟和验证该漏洞的方式，可以通过控制hostname来触发漏洞，但本身不包含投毒代码。

**项目地址:** [pouriam23/CVE-2016-5180-docker-](https://github.com/pouriam23/CVE-2016-5180-docker-)

**漏洞详情:** [CVE-2016-5180](https://nvd.nist.gov/vuln/detail/CVE-2016-5180)

---

## POC #2

**来源**: [CVE-2016-5180-pouriam23_CVE-2016-5180.md](../2016/CVE-2016-5180-pouriam23_CVE-2016-5180.md)

# CVE-2016-5180

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-5180-pouriam23_CVE-2016-5180-docker-.md](../2016/CVE-2016-5180-pouriam23_CVE-2016-5180-docker-.md)

## CVE-2016-5180-c-ares 堆缓冲区溢出

**漏洞编号:** CVE-2016-5180

**漏洞类型:** 堆缓冲区溢出

**影响应用:** c-ares

**危害等级:** 高危，可能导致拒绝服务或远程代码执行

**影响版本:** c-ares 1.x before 1.12.0

**利用条件:** 需要应用程序使用c-ares库进行DNS解析，并且可以控制或影响被解析的域名。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息，CVE-2016-5180是c-ares 1.12.0之前版本中`ares_create_query`函数中存在的一个基于堆的缓冲区溢出漏洞。攻击者可以通过构造包含转义尾点（escaped trailing dot）的恶意hostname，导致越界写入，从而可能导致拒绝服务或任意代码执行。

**有效性：**

提供的PoC代码是一个Node.js应用，它模拟了一个可能受到该漏洞影响的场景。应用接受用户提供的URL作为callback，并使用`dns.resolve`函数解析该URL的hostname。由于Node.js的`dns.resolve`底层使用了c-ares库，如果c-ares库的版本存在漏洞，则该应用会受到CVE-2016-5180的影响。该POC验证了可以通过控制hostname（callback URL）来触发漏洞，因此有效。

**投毒风险：**

分析提供的Dockerfile、package.json和server.js文件，没有发现任何明显的投毒代码。代码逻辑清晰，主要功能是接收URL并使用dns.resolve进行解析。所有依赖项都是常用的npm库。 因此，投毒风险评估为0%。

**利用方式：**

1.  **攻击者构造恶意的hostname**：hostname包含转义的尾点（例如，`hello\.`），导致`ares_create_query`函数计算hostname大小时出现错误。
2.  **提交恶意hostname给存在漏洞的应用程序**：攻击者将构造好的hostname作为输入（在PoC代码中是callback URL）提交给应用程序。
3.  **触发缓冲区溢出**：应用程序使用c-ares库解析hostname，`ares_create_query`函数分配的缓冲区过小，导致在复制hostname时发生堆缓冲区溢出。
4.  **利用缓冲区溢出**：攻击者可以通过控制溢出的内容，实现拒绝服务（DoS）或者进一步执行任意代码。

**总结：**

该漏洞利用方式主要是通过精心构造的hostname，利用c-ares库在处理转义尾点时的缺陷，触发堆缓冲区溢出。PoC代码提供了一种模拟和验证该漏洞的方式，可以通过控制hostname来触发漏洞，但本身不包含投毒代码。

**项目地址:** [pouriam23/CVE-2016-5180-docker-](https://github.com/pouriam23/CVE-2016-5180-docker-)

**漏洞详情:** [CVE-2016-5180](https://nvd.nist.gov/vuln/detail/CVE-2016-5180)

---

## POC #2

**来源**: [CVE-2016-5180-pouriam23_CVE-2016-5180.md](../2016/CVE-2016-5180-pouriam23_CVE-2016-5180.md)

# CVE-2016-5180

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-5180-pouriam23_CVE-2016-5180-docker-.md](../2016/CVE-2016-5180-pouriam23_CVE-2016-5180-docker-.md)

## CVE-2016-5180-c-ares 堆缓冲区溢出

**漏洞编号:** CVE-2016-5180

**漏洞类型:** 堆缓冲区溢出

**影响应用:** c-ares

**危害等级:** 高危，可能导致拒绝服务或远程代码执行

**影响版本:** c-ares 1.x before 1.12.0

**利用条件:** 需要应用程序使用c-ares库进行DNS解析，并且可以控制或影响被解析的域名。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息，CVE-2016-5180是c-ares 1.12.0之前版本中`ares_create_query`函数中存在的一个基于堆的缓冲区溢出漏洞。攻击者可以通过构造包含转义尾点（escaped trailing dot）的恶意hostname，导致越界写入，从而可能导致拒绝服务或任意代码执行。

**有效性：**

提供的PoC代码是一个Node.js应用，它模拟了一个可能受到该漏洞影响的场景。应用接受用户提供的URL作为callback，并使用`dns.resolve`函数解析该URL的hostname。由于Node.js的`dns.resolve`底层使用了c-ares库，如果c-ares库的版本存在漏洞，则该应用会受到CVE-2016-5180的影响。该POC验证了可以通过控制hostname（callback URL）来触发漏洞，因此有效。

**投毒风险：**

分析提供的Dockerfile、package.json和server.js文件，没有发现任何明显的投毒代码。代码逻辑清晰，主要功能是接收URL并使用dns.resolve进行解析。所有依赖项都是常用的npm库。 因此，投毒风险评估为0%。

**利用方式：**

1.  **攻击者构造恶意的hostname**：hostname包含转义的尾点（例如，`hello\.`），导致`ares_create_query`函数计算hostname大小时出现错误。
2.  **提交恶意hostname给存在漏洞的应用程序**：攻击者将构造好的hostname作为输入（在PoC代码中是callback URL）提交给应用程序。
3.  **触发缓冲区溢出**：应用程序使用c-ares库解析hostname，`ares_create_query`函数分配的缓冲区过小，导致在复制hostname时发生堆缓冲区溢出。
4.  **利用缓冲区溢出**：攻击者可以通过控制溢出的内容，实现拒绝服务（DoS）或者进一步执行任意代码。

**总结：**

该漏洞利用方式主要是通过精心构造的hostname，利用c-ares库在处理转义尾点时的缺陷，触发堆缓冲区溢出。PoC代码提供了一种模拟和验证该漏洞的方式，可以通过控制hostname来触发漏洞，但本身不包含投毒代码。

**项目地址:** [pouriam23/CVE-2016-5180-docker-](https://github.com/pouriam23/CVE-2016-5180-docker-)

**漏洞详情:** [CVE-2016-5180](https://nvd.nist.gov/vuln/detail/CVE-2016-5180)

---

## POC #2

**来源**: [CVE-2016-5180-pouriam23_CVE-2016-5180.md](../2016/CVE-2016-5180-pouriam23_CVE-2016-5180.md)

# CVE-2016-5180

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-5180-pouriam23_CVE-2016-5180-docker-.md](../2016/CVE-2016-5180-pouriam23_CVE-2016-5180-docker-.md)

## CVE-2016-5180-c-ares 堆缓冲区溢出

**漏洞编号:** CVE-2016-5180

**漏洞类型:** 堆缓冲区溢出

**影响应用:** c-ares

**危害等级:** 高危，可能导致拒绝服务或远程代码执行

**影响版本:** c-ares 1.x before 1.12.0

**利用条件:** 需要应用程序使用c-ares库进行DNS解析，并且可以控制或影响被解析的域名。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息，CVE-2016-5180是c-ares 1.12.0之前版本中`ares_create_query`函数中存在的一个基于堆的缓冲区溢出漏洞。攻击者可以通过构造包含转义尾点（escaped trailing dot）的恶意hostname，导致越界写入，从而可能导致拒绝服务或任意代码执行。

**有效性：**

提供的PoC代码是一个Node.js应用，它模拟了一个可能受到该漏洞影响的场景。应用接受用户提供的URL作为callback，并使用`dns.resolve`函数解析该URL的hostname。由于Node.js的`dns.resolve`底层使用了c-ares库，如果c-ares库的版本存在漏洞，则该应用会受到CVE-2016-5180的影响。该POC验证了可以通过控制hostname（callback URL）来触发漏洞，因此有效。

**投毒风险：**

分析提供的Dockerfile、package.json和server.js文件，没有发现任何明显的投毒代码。代码逻辑清晰，主要功能是接收URL并使用dns.resolve进行解析。所有依赖项都是常用的npm库。 因此，投毒风险评估为0%。

**利用方式：**

1.  **攻击者构造恶意的hostname**：hostname包含转义的尾点（例如，`hello\.`），导致`ares_create_query`函数计算hostname大小时出现错误。
2.  **提交恶意hostname给存在漏洞的应用程序**：攻击者将构造好的hostname作为输入（在PoC代码中是callback URL）提交给应用程序。
3.  **触发缓冲区溢出**：应用程序使用c-ares库解析hostname，`ares_create_query`函数分配的缓冲区过小，导致在复制hostname时发生堆缓冲区溢出。
4.  **利用缓冲区溢出**：攻击者可以通过控制溢出的内容，实现拒绝服务（DoS）或者进一步执行任意代码。

**总结：**

该漏洞利用方式主要是通过精心构造的hostname，利用c-ares库在处理转义尾点时的缺陷，触发堆缓冲区溢出。PoC代码提供了一种模拟和验证该漏洞的方式，可以通过控制hostname来触发漏洞，但本身不包含投毒代码。

**项目地址:** [pouriam23/CVE-2016-5180-docker-](https://github.com/pouriam23/CVE-2016-5180-docker-)

**漏洞详情:** [CVE-2016-5180](https://nvd.nist.gov/vuln/detail/CVE-2016-5180)

---

## POC #2

**来源**: [CVE-2016-5180-pouriam23_final-CVE-2016-5180.md](../2016/CVE-2016-5180-pouriam23_final-CVE-2016-5180.md)

## CVE-2016-5180-c-ares 堆缓冲区溢出

**漏洞编号:** CVE-2016-5180

**漏洞类型:** 堆缓冲区溢出

**影响应用:** c-ares (通过 Node.js 间接调用)

**危害等级:** 高危，可能导致拒绝服务或远程代码执行

**影响版本:** c-ares 1.x before 1.12.0

**利用条件:** 应用程序使用受影响的 c-ares 版本，且允许用户控制主机名解析

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-5180 是 c-ares 库中 ares_create_query 函数的堆缓冲区溢出漏洞。该漏洞允许远程攻击者通过包含转义尾随点的恶意主机名来造成拒绝服务（越界写入）或执行任意代码。

**有效性：**
提供的 Node.js 代码是一个易受攻击的应用程序示例，它接受用户提供的回调 URL 并使用 `dns.resolve` 函数解析主机名。如果 `dns.resolve` 函数使用的 c-ares 库的版本早于 1.12.0 且存在漏洞，则可以通过提供包含恶意转义尾随点的主机名来触发缓冲区溢出。

**利用方式：**
1.  攻击者向 `/register` 路由发送 POST 请求，其中 `callback` 参数包含一个格式为 `hostname\.` 的恶意主机名，`hostname` 长度要足够长才能触发缓冲区溢出。
2.  `dns.resolve` 函数调用 c-ares 库解析主机名。
3.  `ares_create_query` 函数在处理带有转义尾随点的主机名时计算大小不正确，导致堆缓冲区溢出。
4.  攻击者可以通过精心构造主机名来实现拒绝服务或执行任意代码。

**投毒风险：**
查看提供的代码，其中两个文件package.json和server.js，没有发现恶意或者后门代码，代码逻辑清晰，主要功能就是接收用户输入的回调 URL 并使用 Node.js 的 `dns` 模块解析主机名。因此，代码中存在投毒代码的可能性很低，几乎可以忽略不计。

总之，利用方式有效，投毒可能性为0。

**项目地址:** [pouriam23/final-CVE-2016-5180](https://github.com/pouriam23/final-CVE-2016-5180)

**漏洞详情:** [CVE-2016-5180](https://nvd.nist.gov/vuln/detail/CVE-2016-5180)

---



---

## POC #3

**来源**: [CVE-2016-5180-pouriam23_final-CVE-2016-5180.md](../2016/CVE-2016-5180-pouriam23_final-CVE-2016-5180.md)

## CVE-2016-5180-c-ares 堆缓冲区溢出

**漏洞编号:** CVE-2016-5180

**漏洞类型:** 堆缓冲区溢出

**影响应用:** c-ares (通过 Node.js 间接调用)

**危害等级:** 高危，可能导致拒绝服务或远程代码执行

**影响版本:** c-ares 1.x before 1.12.0

**利用条件:** 应用程序使用受影响的 c-ares 版本，且允许用户控制主机名解析

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-5180 是 c-ares 库中 ares_create_query 函数的堆缓冲区溢出漏洞。该漏洞允许远程攻击者通过包含转义尾随点的恶意主机名来造成拒绝服务（越界写入）或执行任意代码。

**有效性：**
提供的 Node.js 代码是一个易受攻击的应用程序示例，它接受用户提供的回调 URL 并使用 `dns.resolve` 函数解析主机名。如果 `dns.resolve` 函数使用的 c-ares 库的版本早于 1.12.0 且存在漏洞，则可以通过提供包含恶意转义尾随点的主机名来触发缓冲区溢出。

**利用方式：**
1.  攻击者向 `/register` 路由发送 POST 请求，其中 `callback` 参数包含一个格式为 `hostname\.` 的恶意主机名，`hostname` 长度要足够长才能触发缓冲区溢出。
2.  `dns.resolve` 函数调用 c-ares 库解析主机名。
3.  `ares_create_query` 函数在处理带有转义尾随点的主机名时计算大小不正确，导致堆缓冲区溢出。
4.  攻击者可以通过精心构造主机名来实现拒绝服务或执行任意代码。

**投毒风险：**
查看提供的代码，其中两个文件package.json和server.js，没有发现恶意或者后门代码，代码逻辑清晰，主要功能就是接收用户输入的回调 URL 并使用 Node.js 的 `dns` 模块解析主机名。因此，代码中存在投毒代码的可能性很低，几乎可以忽略不计。

总之，利用方式有效，投毒可能性为0。

**项目地址:** [pouriam23/final-CVE-2016-5180](https://github.com/pouriam23/final-CVE-2016-5180)

**漏洞详情:** [CVE-2016-5180](https://nvd.nist.gov/vuln/detail/CVE-2016-5180)

---



---

## POC #3

**来源**: [CVE-2016-5180-pouriam23_final-CVE-2016-5180.md](../2016/CVE-2016-5180-pouriam23_final-CVE-2016-5180.md)

## CVE-2016-5180-c-ares 堆缓冲区溢出

**漏洞编号:** CVE-2016-5180

**漏洞类型:** 堆缓冲区溢出

**影响应用:** c-ares (通过 Node.js 间接调用)

**危害等级:** 高危，可能导致拒绝服务或远程代码执行

**影响版本:** c-ares 1.x before 1.12.0

**利用条件:** 应用程序使用受影响的 c-ares 版本，且允许用户控制主机名解析

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-5180 是 c-ares 库中 ares_create_query 函数的堆缓冲区溢出漏洞。该漏洞允许远程攻击者通过包含转义尾随点的恶意主机名来造成拒绝服务（越界写入）或执行任意代码。

**有效性：**
提供的 Node.js 代码是一个易受攻击的应用程序示例，它接受用户提供的回调 URL 并使用 `dns.resolve` 函数解析主机名。如果 `dns.resolve` 函数使用的 c-ares 库的版本早于 1.12.0 且存在漏洞，则可以通过提供包含恶意转义尾随点的主机名来触发缓冲区溢出。

**利用方式：**
1.  攻击者向 `/register` 路由发送 POST 请求，其中 `callback` 参数包含一个格式为 `hostname\.` 的恶意主机名，`hostname` 长度要足够长才能触发缓冲区溢出。
2.  `dns.resolve` 函数调用 c-ares 库解析主机名。
3.  `ares_create_query` 函数在处理带有转义尾随点的主机名时计算大小不正确，导致堆缓冲区溢出。
4.  攻击者可以通过精心构造主机名来实现拒绝服务或执行任意代码。

**投毒风险：**
查看提供的代码，其中两个文件package.json和server.js，没有发现恶意或者后门代码，代码逻辑清晰，主要功能就是接收用户输入的回调 URL 并使用 Node.js 的 `dns` 模块解析主机名。因此，代码中存在投毒代码的可能性很低，几乎可以忽略不计。

总之，利用方式有效，投毒可能性为0。

**项目地址:** [pouriam23/final-CVE-2016-5180](https://github.com/pouriam23/final-CVE-2016-5180)

**漏洞详情:** [CVE-2016-5180](https://nvd.nist.gov/vuln/detail/CVE-2016-5180)

---



---

## POC #3

**来源**: [CVE-2016-5180-pouriam23_final-CVE-2016-5180.md](../2016/CVE-2016-5180-pouriam23_final-CVE-2016-5180.md)

## CVE-2016-5180-c-ares 堆缓冲区溢出

**漏洞编号:** CVE-2016-5180

**漏洞类型:** 堆缓冲区溢出

**影响应用:** c-ares (通过 Node.js 间接调用)

**危害等级:** 高危，可能导致拒绝服务或远程代码执行

**影响版本:** c-ares 1.x before 1.12.0

**利用条件:** 应用程序使用受影响的 c-ares 版本，且允许用户控制主机名解析

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-5180 是 c-ares 库中 ares_create_query 函数的堆缓冲区溢出漏洞。该漏洞允许远程攻击者通过包含转义尾随点的恶意主机名来造成拒绝服务（越界写入）或执行任意代码。

**有效性：**
提供的 Node.js 代码是一个易受攻击的应用程序示例，它接受用户提供的回调 URL 并使用 `dns.resolve` 函数解析主机名。如果 `dns.resolve` 函数使用的 c-ares 库的版本早于 1.12.0 且存在漏洞，则可以通过提供包含恶意转义尾随点的主机名来触发缓冲区溢出。

**利用方式：**
1.  攻击者向 `/register` 路由发送 POST 请求，其中 `callback` 参数包含一个格式为 `hostname\.` 的恶意主机名，`hostname` 长度要足够长才能触发缓冲区溢出。
2.  `dns.resolve` 函数调用 c-ares 库解析主机名。
3.  `ares_create_query` 函数在处理带有转义尾随点的主机名时计算大小不正确，导致堆缓冲区溢出。
4.  攻击者可以通过精心构造主机名来实现拒绝服务或执行任意代码。

**投毒风险：**
查看提供的代码，其中两个文件package.json和server.js，没有发现恶意或者后门代码，代码逻辑清晰，主要功能就是接收用户输入的回调 URL 并使用 Node.js 的 `dns` 模块解析主机名。因此，代码中存在投毒代码的可能性很低，几乎可以忽略不计。

总之，利用方式有效，投毒可能性为0。

**项目地址:** [pouriam23/final-CVE-2016-5180](https://github.com/pouriam23/final-CVE-2016-5180)

**漏洞详情:** [CVE-2016-5180](https://nvd.nist.gov/vuln/detail/CVE-2016-5180)

---



---

## POC #3

**来源**: [CVE-2016-5180-pouriam23_final-CVE-2016-5180.md](../2016/CVE-2016-5180-pouriam23_final-CVE-2016-5180.md)

## CVE-2016-5180-c-ares 堆缓冲区溢出

**漏洞编号:** CVE-2016-5180

**漏洞类型:** 堆缓冲区溢出

**影响应用:** c-ares (通过 Node.js 间接调用)

**危害等级:** 高危，可能导致拒绝服务或远程代码执行

**影响版本:** c-ares 1.x before 1.12.0

**利用条件:** 应用程序使用受影响的 c-ares 版本，且允许用户控制主机名解析

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-5180 是 c-ares 库中 ares_create_query 函数的堆缓冲区溢出漏洞。该漏洞允许远程攻击者通过包含转义尾随点的恶意主机名来造成拒绝服务（越界写入）或执行任意代码。

**有效性：**
提供的 Node.js 代码是一个易受攻击的应用程序示例，它接受用户提供的回调 URL 并使用 `dns.resolve` 函数解析主机名。如果 `dns.resolve` 函数使用的 c-ares 库的版本早于 1.12.0 且存在漏洞，则可以通过提供包含恶意转义尾随点的主机名来触发缓冲区溢出。

**利用方式：**
1.  攻击者向 `/register` 路由发送 POST 请求，其中 `callback` 参数包含一个格式为 `hostname\.` 的恶意主机名，`hostname` 长度要足够长才能触发缓冲区溢出。
2.  `dns.resolve` 函数调用 c-ares 库解析主机名。
3.  `ares_create_query` 函数在处理带有转义尾随点的主机名时计算大小不正确，导致堆缓冲区溢出。
4.  攻击者可以通过精心构造主机名来实现拒绝服务或执行任意代码。

**投毒风险：**
查看提供的代码，其中两个文件package.json和server.js，没有发现恶意或者后门代码，代码逻辑清晰，主要功能就是接收用户输入的回调 URL 并使用 Node.js 的 `dns` 模块解析主机名。因此，代码中存在投毒代码的可能性很低，几乎可以忽略不计。

总之，利用方式有效，投毒可能性为0。

**项目地址:** [pouriam23/final-CVE-2016-5180](https://github.com/pouriam23/final-CVE-2016-5180)

**漏洞详情:** [CVE-2016-5180](https://nvd.nist.gov/vuln/detail/CVE-2016-5180)

---



---

## POC #3

**来源**: [CVE-2016-5180-pouriam23_final-CVE-2016-5180.md](../2016/CVE-2016-5180-pouriam23_final-CVE-2016-5180.md)

## CVE-2016-5180-c-ares 堆缓冲区溢出

**漏洞编号:** CVE-2016-5180

**漏洞类型:** 堆缓冲区溢出

**影响应用:** c-ares (通过 Node.js 间接调用)

**危害等级:** 高危，可能导致拒绝服务或远程代码执行

**影响版本:** c-ares 1.x before 1.12.0

**利用条件:** 应用程序使用受影响的 c-ares 版本，且允许用户控制主机名解析

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-5180 是 c-ares 库中 ares_create_query 函数的堆缓冲区溢出漏洞。该漏洞允许远程攻击者通过包含转义尾随点的恶意主机名来造成拒绝服务（越界写入）或执行任意代码。

**有效性：**
提供的 Node.js 代码是一个易受攻击的应用程序示例，它接受用户提供的回调 URL 并使用 `dns.resolve` 函数解析主机名。如果 `dns.resolve` 函数使用的 c-ares 库的版本早于 1.12.0 且存在漏洞，则可以通过提供包含恶意转义尾随点的主机名来触发缓冲区溢出。

**利用方式：**
1.  攻击者向 `/register` 路由发送 POST 请求，其中 `callback` 参数包含一个格式为 `hostname\.` 的恶意主机名，`hostname` 长度要足够长才能触发缓冲区溢出。
2.  `dns.resolve` 函数调用 c-ares 库解析主机名。
3.  `ares_create_query` 函数在处理带有转义尾随点的主机名时计算大小不正确，导致堆缓冲区溢出。
4.  攻击者可以通过精心构造主机名来实现拒绝服务或执行任意代码。

**投毒风险：**
查看提供的代码，其中两个文件package.json和server.js，没有发现恶意或者后门代码，代码逻辑清晰，主要功能就是接收用户输入的回调 URL 并使用 Node.js 的 `dns` 模块解析主机名。因此，代码中存在投毒代码的可能性很低，几乎可以忽略不计。

总之，利用方式有效，投毒可能性为0。

**项目地址:** [pouriam23/final-CVE-2016-5180](https://github.com/pouriam23/final-CVE-2016-5180)

**漏洞详情:** [CVE-2016-5180](https://nvd.nist.gov/vuln/detail/CVE-2016-5180)

---



---

## POC #3

**来源**: [CVE-2016-5180-pouriam23_final-CVE-2016-5180.md](../2016/CVE-2016-5180-pouriam23_final-CVE-2016-5180.md)

## CVE-2016-5180-c-ares 堆缓冲区溢出

**漏洞编号:** CVE-2016-5180

**漏洞类型:** 堆缓冲区溢出

**影响应用:** c-ares (通过 Node.js 间接调用)

**危害等级:** 高危，可能导致拒绝服务或远程代码执行

**影响版本:** c-ares 1.x before 1.12.0

**利用条件:** 应用程序使用受影响的 c-ares 版本，且允许用户控制主机名解析

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-5180 是 c-ares 库中 ares_create_query 函数的堆缓冲区溢出漏洞。该漏洞允许远程攻击者通过包含转义尾随点的恶意主机名来造成拒绝服务（越界写入）或执行任意代码。

**有效性：**
提供的 Node.js 代码是一个易受攻击的应用程序示例，它接受用户提供的回调 URL 并使用 `dns.resolve` 函数解析主机名。如果 `dns.resolve` 函数使用的 c-ares 库的版本早于 1.12.0 且存在漏洞，则可以通过提供包含恶意转义尾随点的主机名来触发缓冲区溢出。

**利用方式：**
1.  攻击者向 `/register` 路由发送 POST 请求，其中 `callback` 参数包含一个格式为 `hostname\.` 的恶意主机名，`hostname` 长度要足够长才能触发缓冲区溢出。
2.  `dns.resolve` 函数调用 c-ares 库解析主机名。
3.  `ares_create_query` 函数在处理带有转义尾随点的主机名时计算大小不正确，导致堆缓冲区溢出。
4.  攻击者可以通过精心构造主机名来实现拒绝服务或执行任意代码。

**投毒风险：**
查看提供的代码，其中两个文件package.json和server.js，没有发现恶意或者后门代码，代码逻辑清晰，主要功能就是接收用户输入的回调 URL 并使用 Node.js 的 `dns` 模块解析主机名。因此，代码中存在投毒代码的可能性很低，几乎可以忽略不计。

总之，利用方式有效，投毒可能性为0。

**项目地址:** [pouriam23/final-CVE-2016-5180](https://github.com/pouriam23/final-CVE-2016-5180)

**漏洞详情:** [CVE-2016-5180](https://nvd.nist.gov/vuln/detail/CVE-2016-5180)

---

