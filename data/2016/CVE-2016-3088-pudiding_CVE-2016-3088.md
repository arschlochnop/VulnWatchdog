# CVE-2016-3088

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-3088-HeArtE4t3r_CVE-2016-3088.md](../2016/CVE-2016-3088-HeArtE4t3r_CVE-2016-3088.md)

## CVE-2016-3088-Apache ActiveMQ 文件上传与执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x before 5.14.0

**利用条件:** 目标服务器运行存在漏洞版本的ActiveMQ，且Fileserver web application开启，攻击者可以访问目标ActiveMQ的web管理页面。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-3088 漏洞存在于 Apache ActiveMQ 5.14.0 之前的 5.x 版本中。该漏洞允许远程攻击者通过 HTTP PUT 请求上传任意文件，然后通过 HTTP MOVE 请求将上传的文件移动到 Web 应用的目录下，从而执行任意代码。攻击者首先上传一个 JSP 文件，然后将其移动到 ActiveMQ 的 admin 目录下，最后通过访问该 JSP 文件来执行恶意代码。

**有效性：**

根据漏洞信息和 Exploit-DB 记录 (https://www.exploit-db.com/exploits/42283/)，以及其他搜索结果，该漏洞存在且EXP利用代码可用，提供的POC代码有效。

**投毒风险：**

查看提供的 Python 脚本 CVE-2016-3088.py，代码逻辑较为清晰，主要功能是：

1.  **参数解析：** 解析目标 URL、上传路径、以及是否使用自定义脚本。
2.  **URL 验证：** 验证 URL 的有效性。
3.  **文件上传：** 使用 PUT 请求上传临时文件。
4.  **文件移动：** 使用 MOVE 请求将临时文件移动到指定位置（通常是 webapps/admin 目录下）。
5.  **Payload：** 脚本默认包含一个简单的payload，该payload支持URL传参执行命令。也可选择用户提供的自定义脚本进行base64编码并上传

代码中存在一定风险，风险主要来自用户提供的脚本参数。如果用户上传的脚本本身就是恶意脚本，那么攻击者就可以利用该漏洞执行恶意代码。但脚本本身并没有发现明显的恶意代码，例如反弹shell、下载执行其他程序等。

所以，投毒风险较低，但不能完全排除用户自定义脚本引入的风险。判断仓库中作者隐藏投毒代码的可能性为5%。

**利用方式：**

1.  **PUT 请求上传文件：** 攻击者首先向目标 ActiveMQ 服务器的 `/fileserver/` 路径发送一个 HTTP PUT 请求，上传一个包含恶意代码（例如 JSP shell）的文件，文件扩展名可以是任意的，因为后续会重命名。
2.  **MOVE 请求移动文件：** 攻击者然后发送一个 HTTP MOVE 请求，将刚刚上传的文件移动到 ActiveMQ Web 应用的目录下，通常是 `webapps/admin/` 目录。在移动的过程中，将文件名更改为 JSP 文件，例如 `shell.jsp`。
3.  **访问 JSP 文件：** 攻击者最后通过访问 `http://<target>/admin/shell.jsp` 来执行恶意代码。

该漏洞的利用依赖于 ActiveMQ 的 Fileserver web application 开启，并且攻击者具有对该应用目录的写权限。

**项目地址:** [HeArtE4t3r/CVE-2016-3088](https://github.com/HeArtE4t3r/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #2

**来源**: [CVE-2016-3088-Ma1Dong_ActiveMQ_putshell-CVE-2016-3088.md](../2016/CVE-2016-3088-Ma1Dong_ActiveMQ_putshell-CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件上传与执行漏洞

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x before 5.14.0

**利用条件:** 目标系统运行存在漏洞版本的Apache ActiveMQ，且fileserver应用启用。 需要能够通过网络访问 ActiveMQ 的 fileserver 接口。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-3088 漏洞允许攻击者通过 HTTP PUT 请求上传任意文件，然后使用 HTTP MOVE 请求将其移动到 Web 目录，从而实现任意代码执行。漏洞利用代码 `ActiveMQ_putshell.py` 的利用方式如下：

1.  **漏洞检测:** 脚本首先尝试使用PUT方法上传一个文件到经过路径穿越处理后的URL `/fileserver/a../../%08/..%08/.%08/%08`，目的是探测 ActiveMQ 的安装路径。如果返回状态码为500，则从响应头中提取 ActiveMQ 的安装路径。
2.  **上传 Webshell:** 脚本随后使用PUT方法上传一个包含JSP webshell代码的文件 `guo.txt` 到 `/fileserver/guo.txt`。
3.  **移动 Webshell:**  脚本使用MOVE方法，将 `guo.txt` 文件移动到 ActiveMQ Web 应用的 admin 目录下，并重命名为 `guo.jsp`。 Destination 头构造了目标路径，利用了 `file://` 协议和之前获取的 ActiveMQ 安装路径。
4.  **访问 Webshell:** 漏洞利用成功后，攻击者可以通过访问 `url/admin/guo.jsp?pwd=gshell&shell=[command]` 来执行任意命令。

**有效性:** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用方式是有效的，已经存在公开的POC。

**投毒风险:**  虽然提供的脚本本身实现了漏洞利用的功能，但仍然存在细微的投毒风险，例如：
*   **后门修改：** 作者可能在webshell代码中植入不易察觉的后门，虽然当前webshell相对简单。

总体而言，风险较低，大约 1%。主要是利用代码本身的功能实现漏洞，投毒的可能性较低。

**利用方式总结:**

1.  发送 PUT 请求上传任意文件到 `/fileserver/` 目录（或其他可写目录）。
2.  发送 MOVE 请求将上传的文件移动到 Web 应用的可执行目录，例如 `admin` 目录。
3.  访问移动后的文件（例如 JSP 文件），执行恶意代码。

该漏洞利用方式简单直接，易于实现，但依赖于目标系统存在漏洞版本且 fileserver 应用启用。

**项目地址:** [Ma1Dong/ActiveMQ_putshell-CVE-2016-3088](https://github.com/Ma1Dong/ActiveMQ_putshell-CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #3

**来源**: [CVE-2016-3088-YutuSec_ActiveMQ_Crack.md](../2016/CVE-2016-3088-YutuSec_ActiveMQ_Crack.md)

## CVE-2016-3088 - Apache ActiveMQ 任意文件上传/写入漏洞

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传/写入

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x < 5.14.0

**利用条件:** 目标服务器运行存在漏洞的Apache ActiveMQ版本，且Fileserver web application未被禁用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache ActiveMQ的Fileserver Web应用中。攻击者可以通过首先发送一个HTTP PUT请求上传任意文件，然后使用HTTP MOVE请求将该文件移动到Web目录，从而实现任意代码执行。  

**利用方式：**  
1.  **PUT请求：**  攻击者构造一个HTTP PUT请求，将恶意文件（例如JSP webshell）上传到`/fileserver/` 目录下，文件名可以是任意的，例如 `123.txt`。
2.  **MOVE请求：**  攻击者构造一个HTTP MOVE请求，将刚上传的文件从`/fileserver/123.txt` 移动到Web应用可访问的目录，例如`/webapps/api/s.jsp`。`Destination`头指定了目标路径。
3.  **访问恶意文件：**  攻击者通过Web浏览器访问移动后的文件（例如`http://target/api/s.jsp`），服务器会解析并执行该文件中的恶意代码。

**POC有效性：**  
根据漏洞信息和提供的利用代码，可以判断该POC代码是有效的。代码首先检查ActiveMQ的默认口令是否存在，若存在，则尝试利用PUT和MOVE方法上传并移动jsp文件到web目录，并进行访问，判断是否存在漏洞。

**投毒风险评估：**  
经过分析，此仓库中的代码主要功能是检测和利用CVE-2016-3088漏洞，没有发现明显的恶意代码或后门。`DataHandle/Check.go`中存在对`activemq.home` 和 `user.dir` 系统属性的判断，以确定ActiveMQ的安装路径，这是漏洞利用的一部分，不是投毒。因此，投毒风险评估为0%。

**项目地址:** [YutuSec/ActiveMQ_Crack](https://github.com/YutuSec/ActiveMQ_Crack)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #4

**来源**: [CVE-2016-3088-cl4ym0re_CVE-2016-3088.md](../2016/CVE-2016-3088-cl4ym0re_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ Fileserver 任意文件上传/RCE

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要目标ActiveMQ的Fileserver应用启用且未配置安全限制，需要知道管理账号密码，默认账号密码为admin/admin

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-3088 存在于 Apache ActiveMQ 的 Fileserver Web 应用中。攻击者可以通过先使用 HTTP PUT 请求上传任意文件，然后使用 HTTP MOVE 请求将文件移动到 Web 目录，从而实现任意代码执行。

**有效性分析：**
提供的POC代码`CVE-2016-3088.py`利用了该漏洞。代码首先检查 fileserver 是否启用，然后尝试使用默认凭据 `admin:admin` 登录。如果成功，它会尝试获取 `activemq.home` 属性以确定 ActiveMQ 的安装路径。然后，它会上传一个包含恶意代码的 jsp 文件，并使用 MOVE 请求将其移动到 `webapps/api` 目录下。如果成功，攻击者就可以通过访问 `host/api/evil.jsp?pwd=9527&i=whoami` 来执行任意命令。

**投毒风险分析：**
POC代码中，主要风险在于以下几点：

*   **webshell内容：** POC 提供了 webshell 的内容，但用户可以自行修改，所以 webshell 本身不是投毒点。但恶意用户可能会替换成具有恶意功能的 webshell。
*   **利用流程：**  整个利用流程相对清晰，虽然存在修改 webshell 的可能，但不会引入额外的恶意代码。程序目的是getshell，实现逻辑较为完善，暂未发现明显的投毒代码。 综合判断，投毒风险较低，但是需要人工审计修改后的webshell。

基于上述分析，该仓库中存在作者隐藏的投毒代码的风险约为 10%。风险主要来源于用户是否使用了作者提供的webshell payload。

**利用方式：**

1.  使用 HTTP PUT 请求上传一个包含恶意代码的 JSP 文件到 Fileserver。文件名可以为任意名称，例如 `noharm.txt`。
2.  使用 HTTP MOVE 请求将上传的文件移动到 ActiveMQ Web 应用的 Web 目录下，例如 `webapps/api/evil.jsp`。`Destination` header 需要设置为目标路径。
3.  通过访问移动后的 JSP 文件，执行其中的恶意代码，从而实现远程代码执行。

该漏洞利用成功的关键在于目标 ActiveMQ 实例的 Fileserver 应用已启用，并且攻击者能够获取到 ActiveMQ 的安装路径。默认的admin/admin弱口令也大大增加了漏洞的利用成功率。升级到 5.14.0 或更高版本是修复此漏洞的建议方法。

**项目地址:** [cl4ym0re/CVE-2016-3088](https://github.com/cl4ym0re/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #5

**来源**: [CVE-2016-3088-cyberaguiar_CVE-2016-3088.md](../2016/CVE-2016-3088-cyberaguiar_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件上传与执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要能够访问ActiveMQ的Fileserver Web应用，通常位于一个特定的端口，且Fileserver功能未被禁用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞CVE-2016-3088存在于Apache ActiveMQ 5.x版本，直至5.14.0之前。该漏洞允许远程攻击者通过HTTP PUT请求上传任意文件，然后使用HTTP MOVE请求将其移动到Web服务器的可执行目录下，从而执行恶意代码。漏洞利用方式主要分两步：首先，攻击者使用PUT方法将包含恶意代码（例如，JSP webshell）的文件上传到服务器上的某个临时位置。然后，攻击者使用MOVE方法将该文件移动到ActiveMQ Web应用的可访问目录，比如`/opt/activemq/webapps/api/`. 一旦文件被移动到可访问的目录，攻击者就可以通过Web浏览器访问该文件，从而执行其中的恶意代码。根据提供的漏洞利用代码，其中只包含GNU AGPL license文本，不包含任何可执行的利用代码。Github上存在公开的exp，所以POC可用。目前分析代码不包含投毒，所以投毒风险评估为0%。

**项目地址:** [cyberaguiar/CVE-2016-3088](https://github.com/cyberaguiar/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #6

**来源**: [CVE-2016-3088-pudiding_CVE-2016-3088.md](../2016/CVE-2016-3088-pudiding_CVE-2016-3088.md)

# CVE-2016-3088

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-3088-HeArtE4t3r_CVE-2016-3088.md](../2016/CVE-2016-3088-HeArtE4t3r_CVE-2016-3088.md)

## CVE-2016-3088-Apache ActiveMQ 文件上传与执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x before 5.14.0

**利用条件:** 目标服务器运行存在漏洞版本的ActiveMQ，且Fileserver web application开启，攻击者可以访问目标ActiveMQ的web管理页面。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-3088 漏洞存在于 Apache ActiveMQ 5.14.0 之前的 5.x 版本中。该漏洞允许远程攻击者通过 HTTP PUT 请求上传任意文件，然后通过 HTTP MOVE 请求将上传的文件移动到 Web 应用的目录下，从而执行任意代码。攻击者首先上传一个 JSP 文件，然后将其移动到 ActiveMQ 的 admin 目录下，最后通过访问该 JSP 文件来执行恶意代码。

**有效性：**

根据漏洞信息和 Exploit-DB 记录 (https://www.exploit-db.com/exploits/42283/)，以及其他搜索结果，该漏洞存在且EXP利用代码可用，提供的POC代码有效。

**投毒风险：**

查看提供的 Python 脚本 CVE-2016-3088.py，代码逻辑较为清晰，主要功能是：

1.  **参数解析：** 解析目标 URL、上传路径、以及是否使用自定义脚本。
2.  **URL 验证：** 验证 URL 的有效性。
3.  **文件上传：** 使用 PUT 请求上传临时文件。
4.  **文件移动：** 使用 MOVE 请求将临时文件移动到指定位置（通常是 webapps/admin 目录下）。
5.  **Payload：** 脚本默认包含一个简单的payload，该payload支持URL传参执行命令。也可选择用户提供的自定义脚本进行base64编码并上传

代码中存在一定风险，风险主要来自用户提供的脚本参数。如果用户上传的脚本本身就是恶意脚本，那么攻击者就可以利用该漏洞执行恶意代码。但脚本本身并没有发现明显的恶意代码，例如反弹shell、下载执行其他程序等。

所以，投毒风险较低，但不能完全排除用户自定义脚本引入的风险。判断仓库中作者隐藏投毒代码的可能性为5%。

**利用方式：**

1.  **PUT 请求上传文件：** 攻击者首先向目标 ActiveMQ 服务器的 `/fileserver/` 路径发送一个 HTTP PUT 请求，上传一个包含恶意代码（例如 JSP shell）的文件，文件扩展名可以是任意的，因为后续会重命名。
2.  **MOVE 请求移动文件：** 攻击者然后发送一个 HTTP MOVE 请求，将刚刚上传的文件移动到 ActiveMQ Web 应用的目录下，通常是 `webapps/admin/` 目录。在移动的过程中，将文件名更改为 JSP 文件，例如 `shell.jsp`。
3.  **访问 JSP 文件：** 攻击者最后通过访问 `http://<target>/admin/shell.jsp` 来执行恶意代码。

该漏洞的利用依赖于 ActiveMQ 的 Fileserver web application 开启，并且攻击者具有对该应用目录的写权限。

**项目地址:** [HeArtE4t3r/CVE-2016-3088](https://github.com/HeArtE4t3r/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #2

**来源**: [CVE-2016-3088-Ma1Dong_ActiveMQ_putshell-CVE-2016-3088.md](../2016/CVE-2016-3088-Ma1Dong_ActiveMQ_putshell-CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件上传与执行漏洞

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x before 5.14.0

**利用条件:** 目标系统运行存在漏洞版本的Apache ActiveMQ，且fileserver应用启用。 需要能够通过网络访问 ActiveMQ 的 fileserver 接口。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-3088 漏洞允许攻击者通过 HTTP PUT 请求上传任意文件，然后使用 HTTP MOVE 请求将其移动到 Web 目录，从而实现任意代码执行。漏洞利用代码 `ActiveMQ_putshell.py` 的利用方式如下：

1.  **漏洞检测:** 脚本首先尝试使用PUT方法上传一个文件到经过路径穿越处理后的URL `/fileserver/a../../%08/..%08/.%08/%08`，目的是探测 ActiveMQ 的安装路径。如果返回状态码为500，则从响应头中提取 ActiveMQ 的安装路径。
2.  **上传 Webshell:** 脚本随后使用PUT方法上传一个包含JSP webshell代码的文件 `guo.txt` 到 `/fileserver/guo.txt`。
3.  **移动 Webshell:**  脚本使用MOVE方法，将 `guo.txt` 文件移动到 ActiveMQ Web 应用的 admin 目录下，并重命名为 `guo.jsp`。 Destination 头构造了目标路径，利用了 `file://` 协议和之前获取的 ActiveMQ 安装路径。
4.  **访问 Webshell:** 漏洞利用成功后，攻击者可以通过访问 `url/admin/guo.jsp?pwd=gshell&shell=[command]` 来执行任意命令。

**有效性:** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用方式是有效的，已经存在公开的POC。

**投毒风险:**  虽然提供的脚本本身实现了漏洞利用的功能，但仍然存在细微的投毒风险，例如：
*   **后门修改：** 作者可能在webshell代码中植入不易察觉的后门，虽然当前webshell相对简单。

总体而言，风险较低，大约 1%。主要是利用代码本身的功能实现漏洞，投毒的可能性较低。

**利用方式总结:**

1.  发送 PUT 请求上传任意文件到 `/fileserver/` 目录（或其他可写目录）。
2.  发送 MOVE 请求将上传的文件移动到 Web 应用的可执行目录，例如 `admin` 目录。
3.  访问移动后的文件（例如 JSP 文件），执行恶意代码。

该漏洞利用方式简单直接，易于实现，但依赖于目标系统存在漏洞版本且 fileserver 应用启用。

**项目地址:** [Ma1Dong/ActiveMQ_putshell-CVE-2016-3088](https://github.com/Ma1Dong/ActiveMQ_putshell-CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #3

**来源**: [CVE-2016-3088-YutuSec_ActiveMQ_Crack.md](../2016/CVE-2016-3088-YutuSec_ActiveMQ_Crack.md)

## CVE-2016-3088 - Apache ActiveMQ 任意文件上传/写入漏洞

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传/写入

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x < 5.14.0

**利用条件:** 目标服务器运行存在漏洞的Apache ActiveMQ版本，且Fileserver web application未被禁用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache ActiveMQ的Fileserver Web应用中。攻击者可以通过首先发送一个HTTP PUT请求上传任意文件，然后使用HTTP MOVE请求将该文件移动到Web目录，从而实现任意代码执行。  

**利用方式：**  
1.  **PUT请求：**  攻击者构造一个HTTP PUT请求，将恶意文件（例如JSP webshell）上传到`/fileserver/` 目录下，文件名可以是任意的，例如 `123.txt`。
2.  **MOVE请求：**  攻击者构造一个HTTP MOVE请求，将刚上传的文件从`/fileserver/123.txt` 移动到Web应用可访问的目录，例如`/webapps/api/s.jsp`。`Destination`头指定了目标路径。
3.  **访问恶意文件：**  攻击者通过Web浏览器访问移动后的文件（例如`http://target/api/s.jsp`），服务器会解析并执行该文件中的恶意代码。

**POC有效性：**  
根据漏洞信息和提供的利用代码，可以判断该POC代码是有效的。代码首先检查ActiveMQ的默认口令是否存在，若存在，则尝试利用PUT和MOVE方法上传并移动jsp文件到web目录，并进行访问，判断是否存在漏洞。

**投毒风险评估：**  
经过分析，此仓库中的代码主要功能是检测和利用CVE-2016-3088漏洞，没有发现明显的恶意代码或后门。`DataHandle/Check.go`中存在对`activemq.home` 和 `user.dir` 系统属性的判断，以确定ActiveMQ的安装路径，这是漏洞利用的一部分，不是投毒。因此，投毒风险评估为0%。

**项目地址:** [YutuSec/ActiveMQ_Crack](https://github.com/YutuSec/ActiveMQ_Crack)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #4

**来源**: [CVE-2016-3088-cl4ym0re_CVE-2016-3088.md](../2016/CVE-2016-3088-cl4ym0re_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ Fileserver 任意文件上传/RCE

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要目标ActiveMQ的Fileserver应用启用且未配置安全限制，需要知道管理账号密码，默认账号密码为admin/admin

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-3088 存在于 Apache ActiveMQ 的 Fileserver Web 应用中。攻击者可以通过先使用 HTTP PUT 请求上传任意文件，然后使用 HTTP MOVE 请求将文件移动到 Web 目录，从而实现任意代码执行。

**有效性分析：**
提供的POC代码`CVE-2016-3088.py`利用了该漏洞。代码首先检查 fileserver 是否启用，然后尝试使用默认凭据 `admin:admin` 登录。如果成功，它会尝试获取 `activemq.home` 属性以确定 ActiveMQ 的安装路径。然后，它会上传一个包含恶意代码的 jsp 文件，并使用 MOVE 请求将其移动到 `webapps/api` 目录下。如果成功，攻击者就可以通过访问 `host/api/evil.jsp?pwd=9527&i=whoami` 来执行任意命令。

**投毒风险分析：**
POC代码中，主要风险在于以下几点：

*   **webshell内容：** POC 提供了 webshell 的内容，但用户可以自行修改，所以 webshell 本身不是投毒点。但恶意用户可能会替换成具有恶意功能的 webshell。
*   **利用流程：**  整个利用流程相对清晰，虽然存在修改 webshell 的可能，但不会引入额外的恶意代码。程序目的是getshell，实现逻辑较为完善，暂未发现明显的投毒代码。 综合判断，投毒风险较低，但是需要人工审计修改后的webshell。

基于上述分析，该仓库中存在作者隐藏的投毒代码的风险约为 10%。风险主要来源于用户是否使用了作者提供的webshell payload。

**利用方式：**

1.  使用 HTTP PUT 请求上传一个包含恶意代码的 JSP 文件到 Fileserver。文件名可以为任意名称，例如 `noharm.txt`。
2.  使用 HTTP MOVE 请求将上传的文件移动到 ActiveMQ Web 应用的 Web 目录下，例如 `webapps/api/evil.jsp`。`Destination` header 需要设置为目标路径。
3.  通过访问移动后的 JSP 文件，执行其中的恶意代码，从而实现远程代码执行。

该漏洞利用成功的关键在于目标 ActiveMQ 实例的 Fileserver 应用已启用，并且攻击者能够获取到 ActiveMQ 的安装路径。默认的admin/admin弱口令也大大增加了漏洞的利用成功率。升级到 5.14.0 或更高版本是修复此漏洞的建议方法。

**项目地址:** [cl4ym0re/CVE-2016-3088](https://github.com/cl4ym0re/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #5

**来源**: [CVE-2016-3088-cyberaguiar_CVE-2016-3088.md](../2016/CVE-2016-3088-cyberaguiar_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件上传与执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要能够访问ActiveMQ的Fileserver Web应用，通常位于一个特定的端口，且Fileserver功能未被禁用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞CVE-2016-3088存在于Apache ActiveMQ 5.x版本，直至5.14.0之前。该漏洞允许远程攻击者通过HTTP PUT请求上传任意文件，然后使用HTTP MOVE请求将其移动到Web服务器的可执行目录下，从而执行恶意代码。漏洞利用方式主要分两步：首先，攻击者使用PUT方法将包含恶意代码（例如，JSP webshell）的文件上传到服务器上的某个临时位置。然后，攻击者使用MOVE方法将该文件移动到ActiveMQ Web应用的可访问目录，比如`/opt/activemq/webapps/api/`. 一旦文件被移动到可访问的目录，攻击者就可以通过Web浏览器访问该文件，从而执行其中的恶意代码。根据提供的漏洞利用代码，其中只包含GNU AGPL license文本，不包含任何可执行的利用代码。Github上存在公开的exp，所以POC可用。目前分析代码不包含投毒，所以投毒风险评估为0%。

**项目地址:** [cyberaguiar/CVE-2016-3088](https://github.com/cyberaguiar/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #6

**来源**: [CVE-2016-3088-pudiding_CVE-2016-3088.md](../2016/CVE-2016-3088-pudiding_CVE-2016-3088.md)

# CVE-2016-3088

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-3088-HeArtE4t3r_CVE-2016-3088.md](../2016/CVE-2016-3088-HeArtE4t3r_CVE-2016-3088.md)

## CVE-2016-3088-Apache ActiveMQ 文件上传与执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x before 5.14.0

**利用条件:** 目标服务器运行存在漏洞版本的ActiveMQ，且Fileserver web application开启，攻击者可以访问目标ActiveMQ的web管理页面。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-3088 漏洞存在于 Apache ActiveMQ 5.14.0 之前的 5.x 版本中。该漏洞允许远程攻击者通过 HTTP PUT 请求上传任意文件，然后通过 HTTP MOVE 请求将上传的文件移动到 Web 应用的目录下，从而执行任意代码。攻击者首先上传一个 JSP 文件，然后将其移动到 ActiveMQ 的 admin 目录下，最后通过访问该 JSP 文件来执行恶意代码。

**有效性：**

根据漏洞信息和 Exploit-DB 记录 (https://www.exploit-db.com/exploits/42283/)，以及其他搜索结果，该漏洞存在且EXP利用代码可用，提供的POC代码有效。

**投毒风险：**

查看提供的 Python 脚本 CVE-2016-3088.py，代码逻辑较为清晰，主要功能是：

1.  **参数解析：** 解析目标 URL、上传路径、以及是否使用自定义脚本。
2.  **URL 验证：** 验证 URL 的有效性。
3.  **文件上传：** 使用 PUT 请求上传临时文件。
4.  **文件移动：** 使用 MOVE 请求将临时文件移动到指定位置（通常是 webapps/admin 目录下）。
5.  **Payload：** 脚本默认包含一个简单的payload，该payload支持URL传参执行命令。也可选择用户提供的自定义脚本进行base64编码并上传

代码中存在一定风险，风险主要来自用户提供的脚本参数。如果用户上传的脚本本身就是恶意脚本，那么攻击者就可以利用该漏洞执行恶意代码。但脚本本身并没有发现明显的恶意代码，例如反弹shell、下载执行其他程序等。

所以，投毒风险较低，但不能完全排除用户自定义脚本引入的风险。判断仓库中作者隐藏投毒代码的可能性为5%。

**利用方式：**

1.  **PUT 请求上传文件：** 攻击者首先向目标 ActiveMQ 服务器的 `/fileserver/` 路径发送一个 HTTP PUT 请求，上传一个包含恶意代码（例如 JSP shell）的文件，文件扩展名可以是任意的，因为后续会重命名。
2.  **MOVE 请求移动文件：** 攻击者然后发送一个 HTTP MOVE 请求，将刚刚上传的文件移动到 ActiveMQ Web 应用的目录下，通常是 `webapps/admin/` 目录。在移动的过程中，将文件名更改为 JSP 文件，例如 `shell.jsp`。
3.  **访问 JSP 文件：** 攻击者最后通过访问 `http://<target>/admin/shell.jsp` 来执行恶意代码。

该漏洞的利用依赖于 ActiveMQ 的 Fileserver web application 开启，并且攻击者具有对该应用目录的写权限。

**项目地址:** [HeArtE4t3r/CVE-2016-3088](https://github.com/HeArtE4t3r/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #2

**来源**: [CVE-2016-3088-Ma1Dong_ActiveMQ_putshell-CVE-2016-3088.md](../2016/CVE-2016-3088-Ma1Dong_ActiveMQ_putshell-CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件上传与执行漏洞

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x before 5.14.0

**利用条件:** 目标系统运行存在漏洞版本的Apache ActiveMQ，且fileserver应用启用。 需要能够通过网络访问 ActiveMQ 的 fileserver 接口。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-3088 漏洞允许攻击者通过 HTTP PUT 请求上传任意文件，然后使用 HTTP MOVE 请求将其移动到 Web 目录，从而实现任意代码执行。漏洞利用代码 `ActiveMQ_putshell.py` 的利用方式如下：

1.  **漏洞检测:** 脚本首先尝试使用PUT方法上传一个文件到经过路径穿越处理后的URL `/fileserver/a../../%08/..%08/.%08/%08`，目的是探测 ActiveMQ 的安装路径。如果返回状态码为500，则从响应头中提取 ActiveMQ 的安装路径。
2.  **上传 Webshell:** 脚本随后使用PUT方法上传一个包含JSP webshell代码的文件 `guo.txt` 到 `/fileserver/guo.txt`。
3.  **移动 Webshell:**  脚本使用MOVE方法，将 `guo.txt` 文件移动到 ActiveMQ Web 应用的 admin 目录下，并重命名为 `guo.jsp`。 Destination 头构造了目标路径，利用了 `file://` 协议和之前获取的 ActiveMQ 安装路径。
4.  **访问 Webshell:** 漏洞利用成功后，攻击者可以通过访问 `url/admin/guo.jsp?pwd=gshell&shell=[command]` 来执行任意命令。

**有效性:** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用方式是有效的，已经存在公开的POC。

**投毒风险:**  虽然提供的脚本本身实现了漏洞利用的功能，但仍然存在细微的投毒风险，例如：
*   **后门修改：** 作者可能在webshell代码中植入不易察觉的后门，虽然当前webshell相对简单。

总体而言，风险较低，大约 1%。主要是利用代码本身的功能实现漏洞，投毒的可能性较低。

**利用方式总结:**

1.  发送 PUT 请求上传任意文件到 `/fileserver/` 目录（或其他可写目录）。
2.  发送 MOVE 请求将上传的文件移动到 Web 应用的可执行目录，例如 `admin` 目录。
3.  访问移动后的文件（例如 JSP 文件），执行恶意代码。

该漏洞利用方式简单直接，易于实现，但依赖于目标系统存在漏洞版本且 fileserver 应用启用。

**项目地址:** [Ma1Dong/ActiveMQ_putshell-CVE-2016-3088](https://github.com/Ma1Dong/ActiveMQ_putshell-CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #3

**来源**: [CVE-2016-3088-YutuSec_ActiveMQ_Crack.md](../2016/CVE-2016-3088-YutuSec_ActiveMQ_Crack.md)

## CVE-2016-3088 - Apache ActiveMQ 任意文件上传/写入漏洞

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传/写入

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x < 5.14.0

**利用条件:** 目标服务器运行存在漏洞的Apache ActiveMQ版本，且Fileserver web application未被禁用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache ActiveMQ的Fileserver Web应用中。攻击者可以通过首先发送一个HTTP PUT请求上传任意文件，然后使用HTTP MOVE请求将该文件移动到Web目录，从而实现任意代码执行。  

**利用方式：**  
1.  **PUT请求：**  攻击者构造一个HTTP PUT请求，将恶意文件（例如JSP webshell）上传到`/fileserver/` 目录下，文件名可以是任意的，例如 `123.txt`。
2.  **MOVE请求：**  攻击者构造一个HTTP MOVE请求，将刚上传的文件从`/fileserver/123.txt` 移动到Web应用可访问的目录，例如`/webapps/api/s.jsp`。`Destination`头指定了目标路径。
3.  **访问恶意文件：**  攻击者通过Web浏览器访问移动后的文件（例如`http://target/api/s.jsp`），服务器会解析并执行该文件中的恶意代码。

**POC有效性：**  
根据漏洞信息和提供的利用代码，可以判断该POC代码是有效的。代码首先检查ActiveMQ的默认口令是否存在，若存在，则尝试利用PUT和MOVE方法上传并移动jsp文件到web目录，并进行访问，判断是否存在漏洞。

**投毒风险评估：**  
经过分析，此仓库中的代码主要功能是检测和利用CVE-2016-3088漏洞，没有发现明显的恶意代码或后门。`DataHandle/Check.go`中存在对`activemq.home` 和 `user.dir` 系统属性的判断，以确定ActiveMQ的安装路径，这是漏洞利用的一部分，不是投毒。因此，投毒风险评估为0%。

**项目地址:** [YutuSec/ActiveMQ_Crack](https://github.com/YutuSec/ActiveMQ_Crack)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #4

**来源**: [CVE-2016-3088-cl4ym0re_CVE-2016-3088.md](../2016/CVE-2016-3088-cl4ym0re_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ Fileserver 任意文件上传/RCE

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要目标ActiveMQ的Fileserver应用启用且未配置安全限制，需要知道管理账号密码，默认账号密码为admin/admin

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-3088 存在于 Apache ActiveMQ 的 Fileserver Web 应用中。攻击者可以通过先使用 HTTP PUT 请求上传任意文件，然后使用 HTTP MOVE 请求将文件移动到 Web 目录，从而实现任意代码执行。

**有效性分析：**
提供的POC代码`CVE-2016-3088.py`利用了该漏洞。代码首先检查 fileserver 是否启用，然后尝试使用默认凭据 `admin:admin` 登录。如果成功，它会尝试获取 `activemq.home` 属性以确定 ActiveMQ 的安装路径。然后，它会上传一个包含恶意代码的 jsp 文件，并使用 MOVE 请求将其移动到 `webapps/api` 目录下。如果成功，攻击者就可以通过访问 `host/api/evil.jsp?pwd=9527&i=whoami` 来执行任意命令。

**投毒风险分析：**
POC代码中，主要风险在于以下几点：

*   **webshell内容：** POC 提供了 webshell 的内容，但用户可以自行修改，所以 webshell 本身不是投毒点。但恶意用户可能会替换成具有恶意功能的 webshell。
*   **利用流程：**  整个利用流程相对清晰，虽然存在修改 webshell 的可能，但不会引入额外的恶意代码。程序目的是getshell，实现逻辑较为完善，暂未发现明显的投毒代码。 综合判断，投毒风险较低，但是需要人工审计修改后的webshell。

基于上述分析，该仓库中存在作者隐藏的投毒代码的风险约为 10%。风险主要来源于用户是否使用了作者提供的webshell payload。

**利用方式：**

1.  使用 HTTP PUT 请求上传一个包含恶意代码的 JSP 文件到 Fileserver。文件名可以为任意名称，例如 `noharm.txt`。
2.  使用 HTTP MOVE 请求将上传的文件移动到 ActiveMQ Web 应用的 Web 目录下，例如 `webapps/api/evil.jsp`。`Destination` header 需要设置为目标路径。
3.  通过访问移动后的 JSP 文件，执行其中的恶意代码，从而实现远程代码执行。

该漏洞利用成功的关键在于目标 ActiveMQ 实例的 Fileserver 应用已启用，并且攻击者能够获取到 ActiveMQ 的安装路径。默认的admin/admin弱口令也大大增加了漏洞的利用成功率。升级到 5.14.0 或更高版本是修复此漏洞的建议方法。

**项目地址:** [cl4ym0re/CVE-2016-3088](https://github.com/cl4ym0re/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #5

**来源**: [CVE-2016-3088-cyberaguiar_CVE-2016-3088.md](../2016/CVE-2016-3088-cyberaguiar_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件上传与执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要能够访问ActiveMQ的Fileserver Web应用，通常位于一个特定的端口，且Fileserver功能未被禁用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞CVE-2016-3088存在于Apache ActiveMQ 5.x版本，直至5.14.0之前。该漏洞允许远程攻击者通过HTTP PUT请求上传任意文件，然后使用HTTP MOVE请求将其移动到Web服务器的可执行目录下，从而执行恶意代码。漏洞利用方式主要分两步：首先，攻击者使用PUT方法将包含恶意代码（例如，JSP webshell）的文件上传到服务器上的某个临时位置。然后，攻击者使用MOVE方法将该文件移动到ActiveMQ Web应用的可访问目录，比如`/opt/activemq/webapps/api/`. 一旦文件被移动到可访问的目录，攻击者就可以通过Web浏览器访问该文件，从而执行其中的恶意代码。根据提供的漏洞利用代码，其中只包含GNU AGPL license文本，不包含任何可执行的利用代码。Github上存在公开的exp，所以POC可用。目前分析代码不包含投毒，所以投毒风险评估为0%。

**项目地址:** [cyberaguiar/CVE-2016-3088](https://github.com/cyberaguiar/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #6

**来源**: [CVE-2016-3088-pudiding_CVE-2016-3088.md](../2016/CVE-2016-3088-pudiding_CVE-2016-3088.md)

# CVE-2016-3088

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-3088-HeArtE4t3r_CVE-2016-3088.md](../2016/CVE-2016-3088-HeArtE4t3r_CVE-2016-3088.md)

## CVE-2016-3088-Apache ActiveMQ 文件上传与执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x before 5.14.0

**利用条件:** 目标服务器运行存在漏洞版本的ActiveMQ，且Fileserver web application开启，攻击者可以访问目标ActiveMQ的web管理页面。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-3088 漏洞存在于 Apache ActiveMQ 5.14.0 之前的 5.x 版本中。该漏洞允许远程攻击者通过 HTTP PUT 请求上传任意文件，然后通过 HTTP MOVE 请求将上传的文件移动到 Web 应用的目录下，从而执行任意代码。攻击者首先上传一个 JSP 文件，然后将其移动到 ActiveMQ 的 admin 目录下，最后通过访问该 JSP 文件来执行恶意代码。

**有效性：**

根据漏洞信息和 Exploit-DB 记录 (https://www.exploit-db.com/exploits/42283/)，以及其他搜索结果，该漏洞存在且EXP利用代码可用，提供的POC代码有效。

**投毒风险：**

查看提供的 Python 脚本 CVE-2016-3088.py，代码逻辑较为清晰，主要功能是：

1.  **参数解析：** 解析目标 URL、上传路径、以及是否使用自定义脚本。
2.  **URL 验证：** 验证 URL 的有效性。
3.  **文件上传：** 使用 PUT 请求上传临时文件。
4.  **文件移动：** 使用 MOVE 请求将临时文件移动到指定位置（通常是 webapps/admin 目录下）。
5.  **Payload：** 脚本默认包含一个简单的payload，该payload支持URL传参执行命令。也可选择用户提供的自定义脚本进行base64编码并上传

代码中存在一定风险，风险主要来自用户提供的脚本参数。如果用户上传的脚本本身就是恶意脚本，那么攻击者就可以利用该漏洞执行恶意代码。但脚本本身并没有发现明显的恶意代码，例如反弹shell、下载执行其他程序等。

所以，投毒风险较低，但不能完全排除用户自定义脚本引入的风险。判断仓库中作者隐藏投毒代码的可能性为5%。

**利用方式：**

1.  **PUT 请求上传文件：** 攻击者首先向目标 ActiveMQ 服务器的 `/fileserver/` 路径发送一个 HTTP PUT 请求，上传一个包含恶意代码（例如 JSP shell）的文件，文件扩展名可以是任意的，因为后续会重命名。
2.  **MOVE 请求移动文件：** 攻击者然后发送一个 HTTP MOVE 请求，将刚刚上传的文件移动到 ActiveMQ Web 应用的目录下，通常是 `webapps/admin/` 目录。在移动的过程中，将文件名更改为 JSP 文件，例如 `shell.jsp`。
3.  **访问 JSP 文件：** 攻击者最后通过访问 `http://<target>/admin/shell.jsp` 来执行恶意代码。

该漏洞的利用依赖于 ActiveMQ 的 Fileserver web application 开启，并且攻击者具有对该应用目录的写权限。

**项目地址:** [HeArtE4t3r/CVE-2016-3088](https://github.com/HeArtE4t3r/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #2

**来源**: [CVE-2016-3088-Ma1Dong_ActiveMQ_putshell-CVE-2016-3088.md](../2016/CVE-2016-3088-Ma1Dong_ActiveMQ_putshell-CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件上传与执行漏洞

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x before 5.14.0

**利用条件:** 目标系统运行存在漏洞版本的Apache ActiveMQ，且fileserver应用启用。 需要能够通过网络访问 ActiveMQ 的 fileserver 接口。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-3088 漏洞允许攻击者通过 HTTP PUT 请求上传任意文件，然后使用 HTTP MOVE 请求将其移动到 Web 目录，从而实现任意代码执行。漏洞利用代码 `ActiveMQ_putshell.py` 的利用方式如下：

1.  **漏洞检测:** 脚本首先尝试使用PUT方法上传一个文件到经过路径穿越处理后的URL `/fileserver/a../../%08/..%08/.%08/%08`，目的是探测 ActiveMQ 的安装路径。如果返回状态码为500，则从响应头中提取 ActiveMQ 的安装路径。
2.  **上传 Webshell:** 脚本随后使用PUT方法上传一个包含JSP webshell代码的文件 `guo.txt` 到 `/fileserver/guo.txt`。
3.  **移动 Webshell:**  脚本使用MOVE方法，将 `guo.txt` 文件移动到 ActiveMQ Web 应用的 admin 目录下，并重命名为 `guo.jsp`。 Destination 头构造了目标路径，利用了 `file://` 协议和之前获取的 ActiveMQ 安装路径。
4.  **访问 Webshell:** 漏洞利用成功后，攻击者可以通过访问 `url/admin/guo.jsp?pwd=gshell&shell=[command]` 来执行任意命令。

**有效性:** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用方式是有效的，已经存在公开的POC。

**投毒风险:**  虽然提供的脚本本身实现了漏洞利用的功能，但仍然存在细微的投毒风险，例如：
*   **后门修改：** 作者可能在webshell代码中植入不易察觉的后门，虽然当前webshell相对简单。

总体而言，风险较低，大约 1%。主要是利用代码本身的功能实现漏洞，投毒的可能性较低。

**利用方式总结:**

1.  发送 PUT 请求上传任意文件到 `/fileserver/` 目录（或其他可写目录）。
2.  发送 MOVE 请求将上传的文件移动到 Web 应用的可执行目录，例如 `admin` 目录。
3.  访问移动后的文件（例如 JSP 文件），执行恶意代码。

该漏洞利用方式简单直接，易于实现，但依赖于目标系统存在漏洞版本且 fileserver 应用启用。

**项目地址:** [Ma1Dong/ActiveMQ_putshell-CVE-2016-3088](https://github.com/Ma1Dong/ActiveMQ_putshell-CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #3

**来源**: [CVE-2016-3088-YutuSec_ActiveMQ_Crack.md](../2016/CVE-2016-3088-YutuSec_ActiveMQ_Crack.md)

## CVE-2016-3088 - Apache ActiveMQ 任意文件上传/写入漏洞

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传/写入

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x < 5.14.0

**利用条件:** 目标服务器运行存在漏洞的Apache ActiveMQ版本，且Fileserver web application未被禁用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache ActiveMQ的Fileserver Web应用中。攻击者可以通过首先发送一个HTTP PUT请求上传任意文件，然后使用HTTP MOVE请求将该文件移动到Web目录，从而实现任意代码执行。  

**利用方式：**  
1.  **PUT请求：**  攻击者构造一个HTTP PUT请求，将恶意文件（例如JSP webshell）上传到`/fileserver/` 目录下，文件名可以是任意的，例如 `123.txt`。
2.  **MOVE请求：**  攻击者构造一个HTTP MOVE请求，将刚上传的文件从`/fileserver/123.txt` 移动到Web应用可访问的目录，例如`/webapps/api/s.jsp`。`Destination`头指定了目标路径。
3.  **访问恶意文件：**  攻击者通过Web浏览器访问移动后的文件（例如`http://target/api/s.jsp`），服务器会解析并执行该文件中的恶意代码。

**POC有效性：**  
根据漏洞信息和提供的利用代码，可以判断该POC代码是有效的。代码首先检查ActiveMQ的默认口令是否存在，若存在，则尝试利用PUT和MOVE方法上传并移动jsp文件到web目录，并进行访问，判断是否存在漏洞。

**投毒风险评估：**  
经过分析，此仓库中的代码主要功能是检测和利用CVE-2016-3088漏洞，没有发现明显的恶意代码或后门。`DataHandle/Check.go`中存在对`activemq.home` 和 `user.dir` 系统属性的判断，以确定ActiveMQ的安装路径，这是漏洞利用的一部分，不是投毒。因此，投毒风险评估为0%。

**项目地址:** [YutuSec/ActiveMQ_Crack](https://github.com/YutuSec/ActiveMQ_Crack)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #4

**来源**: [CVE-2016-3088-cl4ym0re_CVE-2016-3088.md](../2016/CVE-2016-3088-cl4ym0re_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ Fileserver 任意文件上传/RCE

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要目标ActiveMQ的Fileserver应用启用且未配置安全限制，需要知道管理账号密码，默认账号密码为admin/admin

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-3088 存在于 Apache ActiveMQ 的 Fileserver Web 应用中。攻击者可以通过先使用 HTTP PUT 请求上传任意文件，然后使用 HTTP MOVE 请求将文件移动到 Web 目录，从而实现任意代码执行。

**有效性分析：**
提供的POC代码`CVE-2016-3088.py`利用了该漏洞。代码首先检查 fileserver 是否启用，然后尝试使用默认凭据 `admin:admin` 登录。如果成功，它会尝试获取 `activemq.home` 属性以确定 ActiveMQ 的安装路径。然后，它会上传一个包含恶意代码的 jsp 文件，并使用 MOVE 请求将其移动到 `webapps/api` 目录下。如果成功，攻击者就可以通过访问 `host/api/evil.jsp?pwd=9527&i=whoami` 来执行任意命令。

**投毒风险分析：**
POC代码中，主要风险在于以下几点：

*   **webshell内容：** POC 提供了 webshell 的内容，但用户可以自行修改，所以 webshell 本身不是投毒点。但恶意用户可能会替换成具有恶意功能的 webshell。
*   **利用流程：**  整个利用流程相对清晰，虽然存在修改 webshell 的可能，但不会引入额外的恶意代码。程序目的是getshell，实现逻辑较为完善，暂未发现明显的投毒代码。 综合判断，投毒风险较低，但是需要人工审计修改后的webshell。

基于上述分析，该仓库中存在作者隐藏的投毒代码的风险约为 10%。风险主要来源于用户是否使用了作者提供的webshell payload。

**利用方式：**

1.  使用 HTTP PUT 请求上传一个包含恶意代码的 JSP 文件到 Fileserver。文件名可以为任意名称，例如 `noharm.txt`。
2.  使用 HTTP MOVE 请求将上传的文件移动到 ActiveMQ Web 应用的 Web 目录下，例如 `webapps/api/evil.jsp`。`Destination` header 需要设置为目标路径。
3.  通过访问移动后的 JSP 文件，执行其中的恶意代码，从而实现远程代码执行。

该漏洞利用成功的关键在于目标 ActiveMQ 实例的 Fileserver 应用已启用，并且攻击者能够获取到 ActiveMQ 的安装路径。默认的admin/admin弱口令也大大增加了漏洞的利用成功率。升级到 5.14.0 或更高版本是修复此漏洞的建议方法。

**项目地址:** [cl4ym0re/CVE-2016-3088](https://github.com/cl4ym0re/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #5

**来源**: [CVE-2016-3088-cyberaguiar_CVE-2016-3088.md](../2016/CVE-2016-3088-cyberaguiar_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件上传与执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要能够访问ActiveMQ的Fileserver Web应用，通常位于一个特定的端口，且Fileserver功能未被禁用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞CVE-2016-3088存在于Apache ActiveMQ 5.x版本，直至5.14.0之前。该漏洞允许远程攻击者通过HTTP PUT请求上传任意文件，然后使用HTTP MOVE请求将其移动到Web服务器的可执行目录下，从而执行恶意代码。漏洞利用方式主要分两步：首先，攻击者使用PUT方法将包含恶意代码（例如，JSP webshell）的文件上传到服务器上的某个临时位置。然后，攻击者使用MOVE方法将该文件移动到ActiveMQ Web应用的可访问目录，比如`/opt/activemq/webapps/api/`. 一旦文件被移动到可访问的目录，攻击者就可以通过Web浏览器访问该文件，从而执行其中的恶意代码。根据提供的漏洞利用代码，其中只包含GNU AGPL license文本，不包含任何可执行的利用代码。Github上存在公开的exp，所以POC可用。目前分析代码不包含投毒，所以投毒风险评估为0%。

**项目地址:** [cyberaguiar/CVE-2016-3088](https://github.com/cyberaguiar/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #6

**来源**: [CVE-2016-3088-pudiding_CVE-2016-3088.md](../2016/CVE-2016-3088-pudiding_CVE-2016-3088.md)

# CVE-2016-3088

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-3088-HeArtE4t3r_CVE-2016-3088.md](../2016/CVE-2016-3088-HeArtE4t3r_CVE-2016-3088.md)

## CVE-2016-3088-Apache ActiveMQ 文件上传与执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x before 5.14.0

**利用条件:** 目标服务器运行存在漏洞版本的ActiveMQ，且Fileserver web application开启，攻击者可以访问目标ActiveMQ的web管理页面。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-3088 漏洞存在于 Apache ActiveMQ 5.14.0 之前的 5.x 版本中。该漏洞允许远程攻击者通过 HTTP PUT 请求上传任意文件，然后通过 HTTP MOVE 请求将上传的文件移动到 Web 应用的目录下，从而执行任意代码。攻击者首先上传一个 JSP 文件，然后将其移动到 ActiveMQ 的 admin 目录下，最后通过访问该 JSP 文件来执行恶意代码。

**有效性：**

根据漏洞信息和 Exploit-DB 记录 (https://www.exploit-db.com/exploits/42283/)，以及其他搜索结果，该漏洞存在且EXP利用代码可用，提供的POC代码有效。

**投毒风险：**

查看提供的 Python 脚本 CVE-2016-3088.py，代码逻辑较为清晰，主要功能是：

1.  **参数解析：** 解析目标 URL、上传路径、以及是否使用自定义脚本。
2.  **URL 验证：** 验证 URL 的有效性。
3.  **文件上传：** 使用 PUT 请求上传临时文件。
4.  **文件移动：** 使用 MOVE 请求将临时文件移动到指定位置（通常是 webapps/admin 目录下）。
5.  **Payload：** 脚本默认包含一个简单的payload，该payload支持URL传参执行命令。也可选择用户提供的自定义脚本进行base64编码并上传

代码中存在一定风险，风险主要来自用户提供的脚本参数。如果用户上传的脚本本身就是恶意脚本，那么攻击者就可以利用该漏洞执行恶意代码。但脚本本身并没有发现明显的恶意代码，例如反弹shell、下载执行其他程序等。

所以，投毒风险较低，但不能完全排除用户自定义脚本引入的风险。判断仓库中作者隐藏投毒代码的可能性为5%。

**利用方式：**

1.  **PUT 请求上传文件：** 攻击者首先向目标 ActiveMQ 服务器的 `/fileserver/` 路径发送一个 HTTP PUT 请求，上传一个包含恶意代码（例如 JSP shell）的文件，文件扩展名可以是任意的，因为后续会重命名。
2.  **MOVE 请求移动文件：** 攻击者然后发送一个 HTTP MOVE 请求，将刚刚上传的文件移动到 ActiveMQ Web 应用的目录下，通常是 `webapps/admin/` 目录。在移动的过程中，将文件名更改为 JSP 文件，例如 `shell.jsp`。
3.  **访问 JSP 文件：** 攻击者最后通过访问 `http://<target>/admin/shell.jsp` 来执行恶意代码。

该漏洞的利用依赖于 ActiveMQ 的 Fileserver web application 开启，并且攻击者具有对该应用目录的写权限。

**项目地址:** [HeArtE4t3r/CVE-2016-3088](https://github.com/HeArtE4t3r/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #2

**来源**: [CVE-2016-3088-Ma1Dong_ActiveMQ_putshell-CVE-2016-3088.md](../2016/CVE-2016-3088-Ma1Dong_ActiveMQ_putshell-CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件上传与执行漏洞

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x before 5.14.0

**利用条件:** 目标系统运行存在漏洞版本的Apache ActiveMQ，且fileserver应用启用。 需要能够通过网络访问 ActiveMQ 的 fileserver 接口。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-3088 漏洞允许攻击者通过 HTTP PUT 请求上传任意文件，然后使用 HTTP MOVE 请求将其移动到 Web 目录，从而实现任意代码执行。漏洞利用代码 `ActiveMQ_putshell.py` 的利用方式如下：

1.  **漏洞检测:** 脚本首先尝试使用PUT方法上传一个文件到经过路径穿越处理后的URL `/fileserver/a../../%08/..%08/.%08/%08`，目的是探测 ActiveMQ 的安装路径。如果返回状态码为500，则从响应头中提取 ActiveMQ 的安装路径。
2.  **上传 Webshell:** 脚本随后使用PUT方法上传一个包含JSP webshell代码的文件 `guo.txt` 到 `/fileserver/guo.txt`。
3.  **移动 Webshell:**  脚本使用MOVE方法，将 `guo.txt` 文件移动到 ActiveMQ Web 应用的 admin 目录下，并重命名为 `guo.jsp`。 Destination 头构造了目标路径，利用了 `file://` 协议和之前获取的 ActiveMQ 安装路径。
4.  **访问 Webshell:** 漏洞利用成功后，攻击者可以通过访问 `url/admin/guo.jsp?pwd=gshell&shell=[command]` 来执行任意命令。

**有效性:** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用方式是有效的，已经存在公开的POC。

**投毒风险:**  虽然提供的脚本本身实现了漏洞利用的功能，但仍然存在细微的投毒风险，例如：
*   **后门修改：** 作者可能在webshell代码中植入不易察觉的后门，虽然当前webshell相对简单。

总体而言，风险较低，大约 1%。主要是利用代码本身的功能实现漏洞，投毒的可能性较低。

**利用方式总结:**

1.  发送 PUT 请求上传任意文件到 `/fileserver/` 目录（或其他可写目录）。
2.  发送 MOVE 请求将上传的文件移动到 Web 应用的可执行目录，例如 `admin` 目录。
3.  访问移动后的文件（例如 JSP 文件），执行恶意代码。

该漏洞利用方式简单直接，易于实现，但依赖于目标系统存在漏洞版本且 fileserver 应用启用。

**项目地址:** [Ma1Dong/ActiveMQ_putshell-CVE-2016-3088](https://github.com/Ma1Dong/ActiveMQ_putshell-CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #3

**来源**: [CVE-2016-3088-YutuSec_ActiveMQ_Crack.md](../2016/CVE-2016-3088-YutuSec_ActiveMQ_Crack.md)

## CVE-2016-3088 - Apache ActiveMQ 任意文件上传/写入漏洞

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传/写入

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x < 5.14.0

**利用条件:** 目标服务器运行存在漏洞的Apache ActiveMQ版本，且Fileserver web application未被禁用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache ActiveMQ的Fileserver Web应用中。攻击者可以通过首先发送一个HTTP PUT请求上传任意文件，然后使用HTTP MOVE请求将该文件移动到Web目录，从而实现任意代码执行。  

**利用方式：**  
1.  **PUT请求：**  攻击者构造一个HTTP PUT请求，将恶意文件（例如JSP webshell）上传到`/fileserver/` 目录下，文件名可以是任意的，例如 `123.txt`。
2.  **MOVE请求：**  攻击者构造一个HTTP MOVE请求，将刚上传的文件从`/fileserver/123.txt` 移动到Web应用可访问的目录，例如`/webapps/api/s.jsp`。`Destination`头指定了目标路径。
3.  **访问恶意文件：**  攻击者通过Web浏览器访问移动后的文件（例如`http://target/api/s.jsp`），服务器会解析并执行该文件中的恶意代码。

**POC有效性：**  
根据漏洞信息和提供的利用代码，可以判断该POC代码是有效的。代码首先检查ActiveMQ的默认口令是否存在，若存在，则尝试利用PUT和MOVE方法上传并移动jsp文件到web目录，并进行访问，判断是否存在漏洞。

**投毒风险评估：**  
经过分析，此仓库中的代码主要功能是检测和利用CVE-2016-3088漏洞，没有发现明显的恶意代码或后门。`DataHandle/Check.go`中存在对`activemq.home` 和 `user.dir` 系统属性的判断，以确定ActiveMQ的安装路径，这是漏洞利用的一部分，不是投毒。因此，投毒风险评估为0%。

**项目地址:** [YutuSec/ActiveMQ_Crack](https://github.com/YutuSec/ActiveMQ_Crack)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #4

**来源**: [CVE-2016-3088-cl4ym0re_CVE-2016-3088.md](../2016/CVE-2016-3088-cl4ym0re_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ Fileserver 任意文件上传/RCE

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要目标ActiveMQ的Fileserver应用启用且未配置安全限制，需要知道管理账号密码，默认账号密码为admin/admin

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-3088 存在于 Apache ActiveMQ 的 Fileserver Web 应用中。攻击者可以通过先使用 HTTP PUT 请求上传任意文件，然后使用 HTTP MOVE 请求将文件移动到 Web 目录，从而实现任意代码执行。

**有效性分析：**
提供的POC代码`CVE-2016-3088.py`利用了该漏洞。代码首先检查 fileserver 是否启用，然后尝试使用默认凭据 `admin:admin` 登录。如果成功，它会尝试获取 `activemq.home` 属性以确定 ActiveMQ 的安装路径。然后，它会上传一个包含恶意代码的 jsp 文件，并使用 MOVE 请求将其移动到 `webapps/api` 目录下。如果成功，攻击者就可以通过访问 `host/api/evil.jsp?pwd=9527&i=whoami` 来执行任意命令。

**投毒风险分析：**
POC代码中，主要风险在于以下几点：

*   **webshell内容：** POC 提供了 webshell 的内容，但用户可以自行修改，所以 webshell 本身不是投毒点。但恶意用户可能会替换成具有恶意功能的 webshell。
*   **利用流程：**  整个利用流程相对清晰，虽然存在修改 webshell 的可能，但不会引入额外的恶意代码。程序目的是getshell，实现逻辑较为完善，暂未发现明显的投毒代码。 综合判断，投毒风险较低，但是需要人工审计修改后的webshell。

基于上述分析，该仓库中存在作者隐藏的投毒代码的风险约为 10%。风险主要来源于用户是否使用了作者提供的webshell payload。

**利用方式：**

1.  使用 HTTP PUT 请求上传一个包含恶意代码的 JSP 文件到 Fileserver。文件名可以为任意名称，例如 `noharm.txt`。
2.  使用 HTTP MOVE 请求将上传的文件移动到 ActiveMQ Web 应用的 Web 目录下，例如 `webapps/api/evil.jsp`。`Destination` header 需要设置为目标路径。
3.  通过访问移动后的 JSP 文件，执行其中的恶意代码，从而实现远程代码执行。

该漏洞利用成功的关键在于目标 ActiveMQ 实例的 Fileserver 应用已启用，并且攻击者能够获取到 ActiveMQ 的安装路径。默认的admin/admin弱口令也大大增加了漏洞的利用成功率。升级到 5.14.0 或更高版本是修复此漏洞的建议方法。

**项目地址:** [cl4ym0re/CVE-2016-3088](https://github.com/cl4ym0re/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #5

**来源**: [CVE-2016-3088-cyberaguiar_CVE-2016-3088.md](../2016/CVE-2016-3088-cyberaguiar_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件上传与执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要能够访问ActiveMQ的Fileserver Web应用，通常位于一个特定的端口，且Fileserver功能未被禁用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞CVE-2016-3088存在于Apache ActiveMQ 5.x版本，直至5.14.0之前。该漏洞允许远程攻击者通过HTTP PUT请求上传任意文件，然后使用HTTP MOVE请求将其移动到Web服务器的可执行目录下，从而执行恶意代码。漏洞利用方式主要分两步：首先，攻击者使用PUT方法将包含恶意代码（例如，JSP webshell）的文件上传到服务器上的某个临时位置。然后，攻击者使用MOVE方法将该文件移动到ActiveMQ Web应用的可访问目录，比如`/opt/activemq/webapps/api/`. 一旦文件被移动到可访问的目录，攻击者就可以通过Web浏览器访问该文件，从而执行其中的恶意代码。根据提供的漏洞利用代码，其中只包含GNU AGPL license文本，不包含任何可执行的利用代码。Github上存在公开的exp，所以POC可用。目前分析代码不包含投毒，所以投毒风险评估为0%。

**项目地址:** [cyberaguiar/CVE-2016-3088](https://github.com/cyberaguiar/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #6

**来源**: [CVE-2016-3088-pudiding_CVE-2016-3088.md](../2016/CVE-2016-3088-pudiding_CVE-2016-3088.md)

# CVE-2016-3088

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-3088-HeArtE4t3r_CVE-2016-3088.md](../2016/CVE-2016-3088-HeArtE4t3r_CVE-2016-3088.md)

## CVE-2016-3088-Apache ActiveMQ 文件上传与执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x before 5.14.0

**利用条件:** 目标服务器运行存在漏洞版本的ActiveMQ，且Fileserver web application开启，攻击者可以访问目标ActiveMQ的web管理页面。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-3088 漏洞存在于 Apache ActiveMQ 5.14.0 之前的 5.x 版本中。该漏洞允许远程攻击者通过 HTTP PUT 请求上传任意文件，然后通过 HTTP MOVE 请求将上传的文件移动到 Web 应用的目录下，从而执行任意代码。攻击者首先上传一个 JSP 文件，然后将其移动到 ActiveMQ 的 admin 目录下，最后通过访问该 JSP 文件来执行恶意代码。

**有效性：**

根据漏洞信息和 Exploit-DB 记录 (https://www.exploit-db.com/exploits/42283/)，以及其他搜索结果，该漏洞存在且EXP利用代码可用，提供的POC代码有效。

**投毒风险：**

查看提供的 Python 脚本 CVE-2016-3088.py，代码逻辑较为清晰，主要功能是：

1.  **参数解析：** 解析目标 URL、上传路径、以及是否使用自定义脚本。
2.  **URL 验证：** 验证 URL 的有效性。
3.  **文件上传：** 使用 PUT 请求上传临时文件。
4.  **文件移动：** 使用 MOVE 请求将临时文件移动到指定位置（通常是 webapps/admin 目录下）。
5.  **Payload：** 脚本默认包含一个简单的payload，该payload支持URL传参执行命令。也可选择用户提供的自定义脚本进行base64编码并上传

代码中存在一定风险，风险主要来自用户提供的脚本参数。如果用户上传的脚本本身就是恶意脚本，那么攻击者就可以利用该漏洞执行恶意代码。但脚本本身并没有发现明显的恶意代码，例如反弹shell、下载执行其他程序等。

所以，投毒风险较低，但不能完全排除用户自定义脚本引入的风险。判断仓库中作者隐藏投毒代码的可能性为5%。

**利用方式：**

1.  **PUT 请求上传文件：** 攻击者首先向目标 ActiveMQ 服务器的 `/fileserver/` 路径发送一个 HTTP PUT 请求，上传一个包含恶意代码（例如 JSP shell）的文件，文件扩展名可以是任意的，因为后续会重命名。
2.  **MOVE 请求移动文件：** 攻击者然后发送一个 HTTP MOVE 请求，将刚刚上传的文件移动到 ActiveMQ Web 应用的目录下，通常是 `webapps/admin/` 目录。在移动的过程中，将文件名更改为 JSP 文件，例如 `shell.jsp`。
3.  **访问 JSP 文件：** 攻击者最后通过访问 `http://<target>/admin/shell.jsp` 来执行恶意代码。

该漏洞的利用依赖于 ActiveMQ 的 Fileserver web application 开启，并且攻击者具有对该应用目录的写权限。

**项目地址:** [HeArtE4t3r/CVE-2016-3088](https://github.com/HeArtE4t3r/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #2

**来源**: [CVE-2016-3088-Ma1Dong_ActiveMQ_putshell-CVE-2016-3088.md](../2016/CVE-2016-3088-Ma1Dong_ActiveMQ_putshell-CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件上传与执行漏洞

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x before 5.14.0

**利用条件:** 目标系统运行存在漏洞版本的Apache ActiveMQ，且fileserver应用启用。 需要能够通过网络访问 ActiveMQ 的 fileserver 接口。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-3088 漏洞允许攻击者通过 HTTP PUT 请求上传任意文件，然后使用 HTTP MOVE 请求将其移动到 Web 目录，从而实现任意代码执行。漏洞利用代码 `ActiveMQ_putshell.py` 的利用方式如下：

1.  **漏洞检测:** 脚本首先尝试使用PUT方法上传一个文件到经过路径穿越处理后的URL `/fileserver/a../../%08/..%08/.%08/%08`，目的是探测 ActiveMQ 的安装路径。如果返回状态码为500，则从响应头中提取 ActiveMQ 的安装路径。
2.  **上传 Webshell:** 脚本随后使用PUT方法上传一个包含JSP webshell代码的文件 `guo.txt` 到 `/fileserver/guo.txt`。
3.  **移动 Webshell:**  脚本使用MOVE方法，将 `guo.txt` 文件移动到 ActiveMQ Web 应用的 admin 目录下，并重命名为 `guo.jsp`。 Destination 头构造了目标路径，利用了 `file://` 协议和之前获取的 ActiveMQ 安装路径。
4.  **访问 Webshell:** 漏洞利用成功后，攻击者可以通过访问 `url/admin/guo.jsp?pwd=gshell&shell=[command]` 来执行任意命令。

**有效性:** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用方式是有效的，已经存在公开的POC。

**投毒风险:**  虽然提供的脚本本身实现了漏洞利用的功能，但仍然存在细微的投毒风险，例如：
*   **后门修改：** 作者可能在webshell代码中植入不易察觉的后门，虽然当前webshell相对简单。

总体而言，风险较低，大约 1%。主要是利用代码本身的功能实现漏洞，投毒的可能性较低。

**利用方式总结:**

1.  发送 PUT 请求上传任意文件到 `/fileserver/` 目录（或其他可写目录）。
2.  发送 MOVE 请求将上传的文件移动到 Web 应用的可执行目录，例如 `admin` 目录。
3.  访问移动后的文件（例如 JSP 文件），执行恶意代码。

该漏洞利用方式简单直接，易于实现，但依赖于目标系统存在漏洞版本且 fileserver 应用启用。

**项目地址:** [Ma1Dong/ActiveMQ_putshell-CVE-2016-3088](https://github.com/Ma1Dong/ActiveMQ_putshell-CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #3

**来源**: [CVE-2016-3088-YutuSec_ActiveMQ_Crack.md](../2016/CVE-2016-3088-YutuSec_ActiveMQ_Crack.md)

## CVE-2016-3088 - Apache ActiveMQ 任意文件上传/写入漏洞

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传/写入

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x < 5.14.0

**利用条件:** 目标服务器运行存在漏洞的Apache ActiveMQ版本，且Fileserver web application未被禁用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache ActiveMQ的Fileserver Web应用中。攻击者可以通过首先发送一个HTTP PUT请求上传任意文件，然后使用HTTP MOVE请求将该文件移动到Web目录，从而实现任意代码执行。  

**利用方式：**  
1.  **PUT请求：**  攻击者构造一个HTTP PUT请求，将恶意文件（例如JSP webshell）上传到`/fileserver/` 目录下，文件名可以是任意的，例如 `123.txt`。
2.  **MOVE请求：**  攻击者构造一个HTTP MOVE请求，将刚上传的文件从`/fileserver/123.txt` 移动到Web应用可访问的目录，例如`/webapps/api/s.jsp`。`Destination`头指定了目标路径。
3.  **访问恶意文件：**  攻击者通过Web浏览器访问移动后的文件（例如`http://target/api/s.jsp`），服务器会解析并执行该文件中的恶意代码。

**POC有效性：**  
根据漏洞信息和提供的利用代码，可以判断该POC代码是有效的。代码首先检查ActiveMQ的默认口令是否存在，若存在，则尝试利用PUT和MOVE方法上传并移动jsp文件到web目录，并进行访问，判断是否存在漏洞。

**投毒风险评估：**  
经过分析，此仓库中的代码主要功能是检测和利用CVE-2016-3088漏洞，没有发现明显的恶意代码或后门。`DataHandle/Check.go`中存在对`activemq.home` 和 `user.dir` 系统属性的判断，以确定ActiveMQ的安装路径，这是漏洞利用的一部分，不是投毒。因此，投毒风险评估为0%。

**项目地址:** [YutuSec/ActiveMQ_Crack](https://github.com/YutuSec/ActiveMQ_Crack)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #4

**来源**: [CVE-2016-3088-cl4ym0re_CVE-2016-3088.md](../2016/CVE-2016-3088-cl4ym0re_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ Fileserver 任意文件上传/RCE

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要目标ActiveMQ的Fileserver应用启用且未配置安全限制，需要知道管理账号密码，默认账号密码为admin/admin

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-3088 存在于 Apache ActiveMQ 的 Fileserver Web 应用中。攻击者可以通过先使用 HTTP PUT 请求上传任意文件，然后使用 HTTP MOVE 请求将文件移动到 Web 目录，从而实现任意代码执行。

**有效性分析：**
提供的POC代码`CVE-2016-3088.py`利用了该漏洞。代码首先检查 fileserver 是否启用，然后尝试使用默认凭据 `admin:admin` 登录。如果成功，它会尝试获取 `activemq.home` 属性以确定 ActiveMQ 的安装路径。然后，它会上传一个包含恶意代码的 jsp 文件，并使用 MOVE 请求将其移动到 `webapps/api` 目录下。如果成功，攻击者就可以通过访问 `host/api/evil.jsp?pwd=9527&i=whoami` 来执行任意命令。

**投毒风险分析：**
POC代码中，主要风险在于以下几点：

*   **webshell内容：** POC 提供了 webshell 的内容，但用户可以自行修改，所以 webshell 本身不是投毒点。但恶意用户可能会替换成具有恶意功能的 webshell。
*   **利用流程：**  整个利用流程相对清晰，虽然存在修改 webshell 的可能，但不会引入额外的恶意代码。程序目的是getshell，实现逻辑较为完善，暂未发现明显的投毒代码。 综合判断，投毒风险较低，但是需要人工审计修改后的webshell。

基于上述分析，该仓库中存在作者隐藏的投毒代码的风险约为 10%。风险主要来源于用户是否使用了作者提供的webshell payload。

**利用方式：**

1.  使用 HTTP PUT 请求上传一个包含恶意代码的 JSP 文件到 Fileserver。文件名可以为任意名称，例如 `noharm.txt`。
2.  使用 HTTP MOVE 请求将上传的文件移动到 ActiveMQ Web 应用的 Web 目录下，例如 `webapps/api/evil.jsp`。`Destination` header 需要设置为目标路径。
3.  通过访问移动后的 JSP 文件，执行其中的恶意代码，从而实现远程代码执行。

该漏洞利用成功的关键在于目标 ActiveMQ 实例的 Fileserver 应用已启用，并且攻击者能够获取到 ActiveMQ 的安装路径。默认的admin/admin弱口令也大大增加了漏洞的利用成功率。升级到 5.14.0 或更高版本是修复此漏洞的建议方法。

**项目地址:** [cl4ym0re/CVE-2016-3088](https://github.com/cl4ym0re/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #5

**来源**: [CVE-2016-3088-cyberaguiar_CVE-2016-3088.md](../2016/CVE-2016-3088-cyberaguiar_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件上传与执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要能够访问ActiveMQ的Fileserver Web应用，通常位于一个特定的端口，且Fileserver功能未被禁用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞CVE-2016-3088存在于Apache ActiveMQ 5.x版本，直至5.14.0之前。该漏洞允许远程攻击者通过HTTP PUT请求上传任意文件，然后使用HTTP MOVE请求将其移动到Web服务器的可执行目录下，从而执行恶意代码。漏洞利用方式主要分两步：首先，攻击者使用PUT方法将包含恶意代码（例如，JSP webshell）的文件上传到服务器上的某个临时位置。然后，攻击者使用MOVE方法将该文件移动到ActiveMQ Web应用的可访问目录，比如`/opt/activemq/webapps/api/`. 一旦文件被移动到可访问的目录，攻击者就可以通过Web浏览器访问该文件，从而执行其中的恶意代码。根据提供的漏洞利用代码，其中只包含GNU AGPL license文本，不包含任何可执行的利用代码。Github上存在公开的exp，所以POC可用。目前分析代码不包含投毒，所以投毒风险评估为0%。

**项目地址:** [cyberaguiar/CVE-2016-3088](https://github.com/cyberaguiar/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #6

**来源**: [CVE-2016-3088-pudiding_CVE-2016-3088.md](../2016/CVE-2016-3088-pudiding_CVE-2016-3088.md)

# CVE-2016-3088

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-3088-HeArtE4t3r_CVE-2016-3088.md](../2016/CVE-2016-3088-HeArtE4t3r_CVE-2016-3088.md)

## CVE-2016-3088-Apache ActiveMQ 文件上传与执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x before 5.14.0

**利用条件:** 目标服务器运行存在漏洞版本的ActiveMQ，且Fileserver web application开启，攻击者可以访问目标ActiveMQ的web管理页面。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-3088 漏洞存在于 Apache ActiveMQ 5.14.0 之前的 5.x 版本中。该漏洞允许远程攻击者通过 HTTP PUT 请求上传任意文件，然后通过 HTTP MOVE 请求将上传的文件移动到 Web 应用的目录下，从而执行任意代码。攻击者首先上传一个 JSP 文件，然后将其移动到 ActiveMQ 的 admin 目录下，最后通过访问该 JSP 文件来执行恶意代码。

**有效性：**

根据漏洞信息和 Exploit-DB 记录 (https://www.exploit-db.com/exploits/42283/)，以及其他搜索结果，该漏洞存在且EXP利用代码可用，提供的POC代码有效。

**投毒风险：**

查看提供的 Python 脚本 CVE-2016-3088.py，代码逻辑较为清晰，主要功能是：

1.  **参数解析：** 解析目标 URL、上传路径、以及是否使用自定义脚本。
2.  **URL 验证：** 验证 URL 的有效性。
3.  **文件上传：** 使用 PUT 请求上传临时文件。
4.  **文件移动：** 使用 MOVE 请求将临时文件移动到指定位置（通常是 webapps/admin 目录下）。
5.  **Payload：** 脚本默认包含一个简单的payload，该payload支持URL传参执行命令。也可选择用户提供的自定义脚本进行base64编码并上传

代码中存在一定风险，风险主要来自用户提供的脚本参数。如果用户上传的脚本本身就是恶意脚本，那么攻击者就可以利用该漏洞执行恶意代码。但脚本本身并没有发现明显的恶意代码，例如反弹shell、下载执行其他程序等。

所以，投毒风险较低，但不能完全排除用户自定义脚本引入的风险。判断仓库中作者隐藏投毒代码的可能性为5%。

**利用方式：**

1.  **PUT 请求上传文件：** 攻击者首先向目标 ActiveMQ 服务器的 `/fileserver/` 路径发送一个 HTTP PUT 请求，上传一个包含恶意代码（例如 JSP shell）的文件，文件扩展名可以是任意的，因为后续会重命名。
2.  **MOVE 请求移动文件：** 攻击者然后发送一个 HTTP MOVE 请求，将刚刚上传的文件移动到 ActiveMQ Web 应用的目录下，通常是 `webapps/admin/` 目录。在移动的过程中，将文件名更改为 JSP 文件，例如 `shell.jsp`。
3.  **访问 JSP 文件：** 攻击者最后通过访问 `http://<target>/admin/shell.jsp` 来执行恶意代码。

该漏洞的利用依赖于 ActiveMQ 的 Fileserver web application 开启，并且攻击者具有对该应用目录的写权限。

**项目地址:** [HeArtE4t3r/CVE-2016-3088](https://github.com/HeArtE4t3r/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #2

**来源**: [CVE-2016-3088-Ma1Dong_ActiveMQ_putshell-CVE-2016-3088.md](../2016/CVE-2016-3088-Ma1Dong_ActiveMQ_putshell-CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件上传与执行漏洞

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x before 5.14.0

**利用条件:** 目标系统运行存在漏洞版本的Apache ActiveMQ，且fileserver应用启用。 需要能够通过网络访问 ActiveMQ 的 fileserver 接口。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-3088 漏洞允许攻击者通过 HTTP PUT 请求上传任意文件，然后使用 HTTP MOVE 请求将其移动到 Web 目录，从而实现任意代码执行。漏洞利用代码 `ActiveMQ_putshell.py` 的利用方式如下：

1.  **漏洞检测:** 脚本首先尝试使用PUT方法上传一个文件到经过路径穿越处理后的URL `/fileserver/a../../%08/..%08/.%08/%08`，目的是探测 ActiveMQ 的安装路径。如果返回状态码为500，则从响应头中提取 ActiveMQ 的安装路径。
2.  **上传 Webshell:** 脚本随后使用PUT方法上传一个包含JSP webshell代码的文件 `guo.txt` 到 `/fileserver/guo.txt`。
3.  **移动 Webshell:**  脚本使用MOVE方法，将 `guo.txt` 文件移动到 ActiveMQ Web 应用的 admin 目录下，并重命名为 `guo.jsp`。 Destination 头构造了目标路径，利用了 `file://` 协议和之前获取的 ActiveMQ 安装路径。
4.  **访问 Webshell:** 漏洞利用成功后，攻击者可以通过访问 `url/admin/guo.jsp?pwd=gshell&shell=[command]` 来执行任意命令。

**有效性:** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用方式是有效的，已经存在公开的POC。

**投毒风险:**  虽然提供的脚本本身实现了漏洞利用的功能，但仍然存在细微的投毒风险，例如：
*   **后门修改：** 作者可能在webshell代码中植入不易察觉的后门，虽然当前webshell相对简单。

总体而言，风险较低，大约 1%。主要是利用代码本身的功能实现漏洞，投毒的可能性较低。

**利用方式总结:**

1.  发送 PUT 请求上传任意文件到 `/fileserver/` 目录（或其他可写目录）。
2.  发送 MOVE 请求将上传的文件移动到 Web 应用的可执行目录，例如 `admin` 目录。
3.  访问移动后的文件（例如 JSP 文件），执行恶意代码。

该漏洞利用方式简单直接，易于实现，但依赖于目标系统存在漏洞版本且 fileserver 应用启用。

**项目地址:** [Ma1Dong/ActiveMQ_putshell-CVE-2016-3088](https://github.com/Ma1Dong/ActiveMQ_putshell-CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #3

**来源**: [CVE-2016-3088-YutuSec_ActiveMQ_Crack.md](../2016/CVE-2016-3088-YutuSec_ActiveMQ_Crack.md)

## CVE-2016-3088 - Apache ActiveMQ 任意文件上传/写入漏洞

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传/写入

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x < 5.14.0

**利用条件:** 目标服务器运行存在漏洞的Apache ActiveMQ版本，且Fileserver web application未被禁用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache ActiveMQ的Fileserver Web应用中。攻击者可以通过首先发送一个HTTP PUT请求上传任意文件，然后使用HTTP MOVE请求将该文件移动到Web目录，从而实现任意代码执行。  

**利用方式：**  
1.  **PUT请求：**  攻击者构造一个HTTP PUT请求，将恶意文件（例如JSP webshell）上传到`/fileserver/` 目录下，文件名可以是任意的，例如 `123.txt`。
2.  **MOVE请求：**  攻击者构造一个HTTP MOVE请求，将刚上传的文件从`/fileserver/123.txt` 移动到Web应用可访问的目录，例如`/webapps/api/s.jsp`。`Destination`头指定了目标路径。
3.  **访问恶意文件：**  攻击者通过Web浏览器访问移动后的文件（例如`http://target/api/s.jsp`），服务器会解析并执行该文件中的恶意代码。

**POC有效性：**  
根据漏洞信息和提供的利用代码，可以判断该POC代码是有效的。代码首先检查ActiveMQ的默认口令是否存在，若存在，则尝试利用PUT和MOVE方法上传并移动jsp文件到web目录，并进行访问，判断是否存在漏洞。

**投毒风险评估：**  
经过分析，此仓库中的代码主要功能是检测和利用CVE-2016-3088漏洞，没有发现明显的恶意代码或后门。`DataHandle/Check.go`中存在对`activemq.home` 和 `user.dir` 系统属性的判断，以确定ActiveMQ的安装路径，这是漏洞利用的一部分，不是投毒。因此，投毒风险评估为0%。

**项目地址:** [YutuSec/ActiveMQ_Crack](https://github.com/YutuSec/ActiveMQ_Crack)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #4

**来源**: [CVE-2016-3088-cl4ym0re_CVE-2016-3088.md](../2016/CVE-2016-3088-cl4ym0re_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ Fileserver 任意文件上传/RCE

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要目标ActiveMQ的Fileserver应用启用且未配置安全限制，需要知道管理账号密码，默认账号密码为admin/admin

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-3088 存在于 Apache ActiveMQ 的 Fileserver Web 应用中。攻击者可以通过先使用 HTTP PUT 请求上传任意文件，然后使用 HTTP MOVE 请求将文件移动到 Web 目录，从而实现任意代码执行。

**有效性分析：**
提供的POC代码`CVE-2016-3088.py`利用了该漏洞。代码首先检查 fileserver 是否启用，然后尝试使用默认凭据 `admin:admin` 登录。如果成功，它会尝试获取 `activemq.home` 属性以确定 ActiveMQ 的安装路径。然后，它会上传一个包含恶意代码的 jsp 文件，并使用 MOVE 请求将其移动到 `webapps/api` 目录下。如果成功，攻击者就可以通过访问 `host/api/evil.jsp?pwd=9527&i=whoami` 来执行任意命令。

**投毒风险分析：**
POC代码中，主要风险在于以下几点：

*   **webshell内容：** POC 提供了 webshell 的内容，但用户可以自行修改，所以 webshell 本身不是投毒点。但恶意用户可能会替换成具有恶意功能的 webshell。
*   **利用流程：**  整个利用流程相对清晰，虽然存在修改 webshell 的可能，但不会引入额外的恶意代码。程序目的是getshell，实现逻辑较为完善，暂未发现明显的投毒代码。 综合判断，投毒风险较低，但是需要人工审计修改后的webshell。

基于上述分析，该仓库中存在作者隐藏的投毒代码的风险约为 10%。风险主要来源于用户是否使用了作者提供的webshell payload。

**利用方式：**

1.  使用 HTTP PUT 请求上传一个包含恶意代码的 JSP 文件到 Fileserver。文件名可以为任意名称，例如 `noharm.txt`。
2.  使用 HTTP MOVE 请求将上传的文件移动到 ActiveMQ Web 应用的 Web 目录下，例如 `webapps/api/evil.jsp`。`Destination` header 需要设置为目标路径。
3.  通过访问移动后的 JSP 文件，执行其中的恶意代码，从而实现远程代码执行。

该漏洞利用成功的关键在于目标 ActiveMQ 实例的 Fileserver 应用已启用，并且攻击者能够获取到 ActiveMQ 的安装路径。默认的admin/admin弱口令也大大增加了漏洞的利用成功率。升级到 5.14.0 或更高版本是修复此漏洞的建议方法。

**项目地址:** [cl4ym0re/CVE-2016-3088](https://github.com/cl4ym0re/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #5

**来源**: [CVE-2016-3088-cyberaguiar_CVE-2016-3088.md](../2016/CVE-2016-3088-cyberaguiar_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件上传与执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要能够访问ActiveMQ的Fileserver Web应用，通常位于一个特定的端口，且Fileserver功能未被禁用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞CVE-2016-3088存在于Apache ActiveMQ 5.x版本，直至5.14.0之前。该漏洞允许远程攻击者通过HTTP PUT请求上传任意文件，然后使用HTTP MOVE请求将其移动到Web服务器的可执行目录下，从而执行恶意代码。漏洞利用方式主要分两步：首先，攻击者使用PUT方法将包含恶意代码（例如，JSP webshell）的文件上传到服务器上的某个临时位置。然后，攻击者使用MOVE方法将该文件移动到ActiveMQ Web应用的可访问目录，比如`/opt/activemq/webapps/api/`. 一旦文件被移动到可访问的目录，攻击者就可以通过Web浏览器访问该文件，从而执行其中的恶意代码。根据提供的漏洞利用代码，其中只包含GNU AGPL license文本，不包含任何可执行的利用代码。Github上存在公开的exp，所以POC可用。目前分析代码不包含投毒，所以投毒风险评估为0%。

**项目地址:** [cyberaguiar/CVE-2016-3088](https://github.com/cyberaguiar/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #6

**来源**: [CVE-2016-3088-pudiding_CVE-2016-3088.md](../2016/CVE-2016-3088-pudiding_CVE-2016-3088.md)

# CVE-2016-3088

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-3088-HeArtE4t3r_CVE-2016-3088.md](../2016/CVE-2016-3088-HeArtE4t3r_CVE-2016-3088.md)

## CVE-2016-3088-Apache ActiveMQ 文件上传与执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x before 5.14.0

**利用条件:** 目标服务器运行存在漏洞版本的ActiveMQ，且Fileserver web application开启，攻击者可以访问目标ActiveMQ的web管理页面。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-3088 漏洞存在于 Apache ActiveMQ 5.14.0 之前的 5.x 版本中。该漏洞允许远程攻击者通过 HTTP PUT 请求上传任意文件，然后通过 HTTP MOVE 请求将上传的文件移动到 Web 应用的目录下，从而执行任意代码。攻击者首先上传一个 JSP 文件，然后将其移动到 ActiveMQ 的 admin 目录下，最后通过访问该 JSP 文件来执行恶意代码。

**有效性：**

根据漏洞信息和 Exploit-DB 记录 (https://www.exploit-db.com/exploits/42283/)，以及其他搜索结果，该漏洞存在且EXP利用代码可用，提供的POC代码有效。

**投毒风险：**

查看提供的 Python 脚本 CVE-2016-3088.py，代码逻辑较为清晰，主要功能是：

1.  **参数解析：** 解析目标 URL、上传路径、以及是否使用自定义脚本。
2.  **URL 验证：** 验证 URL 的有效性。
3.  **文件上传：** 使用 PUT 请求上传临时文件。
4.  **文件移动：** 使用 MOVE 请求将临时文件移动到指定位置（通常是 webapps/admin 目录下）。
5.  **Payload：** 脚本默认包含一个简单的payload，该payload支持URL传参执行命令。也可选择用户提供的自定义脚本进行base64编码并上传

代码中存在一定风险，风险主要来自用户提供的脚本参数。如果用户上传的脚本本身就是恶意脚本，那么攻击者就可以利用该漏洞执行恶意代码。但脚本本身并没有发现明显的恶意代码，例如反弹shell、下载执行其他程序等。

所以，投毒风险较低，但不能完全排除用户自定义脚本引入的风险。判断仓库中作者隐藏投毒代码的可能性为5%。

**利用方式：**

1.  **PUT 请求上传文件：** 攻击者首先向目标 ActiveMQ 服务器的 `/fileserver/` 路径发送一个 HTTP PUT 请求，上传一个包含恶意代码（例如 JSP shell）的文件，文件扩展名可以是任意的，因为后续会重命名。
2.  **MOVE 请求移动文件：** 攻击者然后发送一个 HTTP MOVE 请求，将刚刚上传的文件移动到 ActiveMQ Web 应用的目录下，通常是 `webapps/admin/` 目录。在移动的过程中，将文件名更改为 JSP 文件，例如 `shell.jsp`。
3.  **访问 JSP 文件：** 攻击者最后通过访问 `http://<target>/admin/shell.jsp` 来执行恶意代码。

该漏洞的利用依赖于 ActiveMQ 的 Fileserver web application 开启，并且攻击者具有对该应用目录的写权限。

**项目地址:** [HeArtE4t3r/CVE-2016-3088](https://github.com/HeArtE4t3r/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #2

**来源**: [CVE-2016-3088-Ma1Dong_ActiveMQ_putshell-CVE-2016-3088.md](../2016/CVE-2016-3088-Ma1Dong_ActiveMQ_putshell-CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件上传与执行漏洞

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x before 5.14.0

**利用条件:** 目标系统运行存在漏洞版本的Apache ActiveMQ，且fileserver应用启用。 需要能够通过网络访问 ActiveMQ 的 fileserver 接口。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-3088 漏洞允许攻击者通过 HTTP PUT 请求上传任意文件，然后使用 HTTP MOVE 请求将其移动到 Web 目录，从而实现任意代码执行。漏洞利用代码 `ActiveMQ_putshell.py` 的利用方式如下：

1.  **漏洞检测:** 脚本首先尝试使用PUT方法上传一个文件到经过路径穿越处理后的URL `/fileserver/a../../%08/..%08/.%08/%08`，目的是探测 ActiveMQ 的安装路径。如果返回状态码为500，则从响应头中提取 ActiveMQ 的安装路径。
2.  **上传 Webshell:** 脚本随后使用PUT方法上传一个包含JSP webshell代码的文件 `guo.txt` 到 `/fileserver/guo.txt`。
3.  **移动 Webshell:**  脚本使用MOVE方法，将 `guo.txt` 文件移动到 ActiveMQ Web 应用的 admin 目录下，并重命名为 `guo.jsp`。 Destination 头构造了目标路径，利用了 `file://` 协议和之前获取的 ActiveMQ 安装路径。
4.  **访问 Webshell:** 漏洞利用成功后，攻击者可以通过访问 `url/admin/guo.jsp?pwd=gshell&shell=[command]` 来执行任意命令。

**有效性:** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用方式是有效的，已经存在公开的POC。

**投毒风险:**  虽然提供的脚本本身实现了漏洞利用的功能，但仍然存在细微的投毒风险，例如：
*   **后门修改：** 作者可能在webshell代码中植入不易察觉的后门，虽然当前webshell相对简单。

总体而言，风险较低，大约 1%。主要是利用代码本身的功能实现漏洞，投毒的可能性较低。

**利用方式总结:**

1.  发送 PUT 请求上传任意文件到 `/fileserver/` 目录（或其他可写目录）。
2.  发送 MOVE 请求将上传的文件移动到 Web 应用的可执行目录，例如 `admin` 目录。
3.  访问移动后的文件（例如 JSP 文件），执行恶意代码。

该漏洞利用方式简单直接，易于实现，但依赖于目标系统存在漏洞版本且 fileserver 应用启用。

**项目地址:** [Ma1Dong/ActiveMQ_putshell-CVE-2016-3088](https://github.com/Ma1Dong/ActiveMQ_putshell-CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #3

**来源**: [CVE-2016-3088-YutuSec_ActiveMQ_Crack.md](../2016/CVE-2016-3088-YutuSec_ActiveMQ_Crack.md)

## CVE-2016-3088 - Apache ActiveMQ 任意文件上传/写入漏洞

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传/写入

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x < 5.14.0

**利用条件:** 目标服务器运行存在漏洞的Apache ActiveMQ版本，且Fileserver web application未被禁用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache ActiveMQ的Fileserver Web应用中。攻击者可以通过首先发送一个HTTP PUT请求上传任意文件，然后使用HTTP MOVE请求将该文件移动到Web目录，从而实现任意代码执行。  

**利用方式：**  
1.  **PUT请求：**  攻击者构造一个HTTP PUT请求，将恶意文件（例如JSP webshell）上传到`/fileserver/` 目录下，文件名可以是任意的，例如 `123.txt`。
2.  **MOVE请求：**  攻击者构造一个HTTP MOVE请求，将刚上传的文件从`/fileserver/123.txt` 移动到Web应用可访问的目录，例如`/webapps/api/s.jsp`。`Destination`头指定了目标路径。
3.  **访问恶意文件：**  攻击者通过Web浏览器访问移动后的文件（例如`http://target/api/s.jsp`），服务器会解析并执行该文件中的恶意代码。

**POC有效性：**  
根据漏洞信息和提供的利用代码，可以判断该POC代码是有效的。代码首先检查ActiveMQ的默认口令是否存在，若存在，则尝试利用PUT和MOVE方法上传并移动jsp文件到web目录，并进行访问，判断是否存在漏洞。

**投毒风险评估：**  
经过分析，此仓库中的代码主要功能是检测和利用CVE-2016-3088漏洞，没有发现明显的恶意代码或后门。`DataHandle/Check.go`中存在对`activemq.home` 和 `user.dir` 系统属性的判断，以确定ActiveMQ的安装路径，这是漏洞利用的一部分，不是投毒。因此，投毒风险评估为0%。

**项目地址:** [YutuSec/ActiveMQ_Crack](https://github.com/YutuSec/ActiveMQ_Crack)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #4

**来源**: [CVE-2016-3088-cl4ym0re_CVE-2016-3088.md](../2016/CVE-2016-3088-cl4ym0re_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ Fileserver 任意文件上传/RCE

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要目标ActiveMQ的Fileserver应用启用且未配置安全限制，需要知道管理账号密码，默认账号密码为admin/admin

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-3088 存在于 Apache ActiveMQ 的 Fileserver Web 应用中。攻击者可以通过先使用 HTTP PUT 请求上传任意文件，然后使用 HTTP MOVE 请求将文件移动到 Web 目录，从而实现任意代码执行。

**有效性分析：**
提供的POC代码`CVE-2016-3088.py`利用了该漏洞。代码首先检查 fileserver 是否启用，然后尝试使用默认凭据 `admin:admin` 登录。如果成功，它会尝试获取 `activemq.home` 属性以确定 ActiveMQ 的安装路径。然后，它会上传一个包含恶意代码的 jsp 文件，并使用 MOVE 请求将其移动到 `webapps/api` 目录下。如果成功，攻击者就可以通过访问 `host/api/evil.jsp?pwd=9527&i=whoami` 来执行任意命令。

**投毒风险分析：**
POC代码中，主要风险在于以下几点：

*   **webshell内容：** POC 提供了 webshell 的内容，但用户可以自行修改，所以 webshell 本身不是投毒点。但恶意用户可能会替换成具有恶意功能的 webshell。
*   **利用流程：**  整个利用流程相对清晰，虽然存在修改 webshell 的可能，但不会引入额外的恶意代码。程序目的是getshell，实现逻辑较为完善，暂未发现明显的投毒代码。 综合判断，投毒风险较低，但是需要人工审计修改后的webshell。

基于上述分析，该仓库中存在作者隐藏的投毒代码的风险约为 10%。风险主要来源于用户是否使用了作者提供的webshell payload。

**利用方式：**

1.  使用 HTTP PUT 请求上传一个包含恶意代码的 JSP 文件到 Fileserver。文件名可以为任意名称，例如 `noharm.txt`。
2.  使用 HTTP MOVE 请求将上传的文件移动到 ActiveMQ Web 应用的 Web 目录下，例如 `webapps/api/evil.jsp`。`Destination` header 需要设置为目标路径。
3.  通过访问移动后的 JSP 文件，执行其中的恶意代码，从而实现远程代码执行。

该漏洞利用成功的关键在于目标 ActiveMQ 实例的 Fileserver 应用已启用，并且攻击者能够获取到 ActiveMQ 的安装路径。默认的admin/admin弱口令也大大增加了漏洞的利用成功率。升级到 5.14.0 或更高版本是修复此漏洞的建议方法。

**项目地址:** [cl4ym0re/CVE-2016-3088](https://github.com/cl4ym0re/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #5

**来源**: [CVE-2016-3088-cyberaguiar_CVE-2016-3088.md](../2016/CVE-2016-3088-cyberaguiar_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件上传与执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要能够访问ActiveMQ的Fileserver Web应用，通常位于一个特定的端口，且Fileserver功能未被禁用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞CVE-2016-3088存在于Apache ActiveMQ 5.x版本，直至5.14.0之前。该漏洞允许远程攻击者通过HTTP PUT请求上传任意文件，然后使用HTTP MOVE请求将其移动到Web服务器的可执行目录下，从而执行恶意代码。漏洞利用方式主要分两步：首先，攻击者使用PUT方法将包含恶意代码（例如，JSP webshell）的文件上传到服务器上的某个临时位置。然后，攻击者使用MOVE方法将该文件移动到ActiveMQ Web应用的可访问目录，比如`/opt/activemq/webapps/api/`. 一旦文件被移动到可访问的目录，攻击者就可以通过Web浏览器访问该文件，从而执行其中的恶意代码。根据提供的漏洞利用代码，其中只包含GNU AGPL license文本，不包含任何可执行的利用代码。Github上存在公开的exp，所以POC可用。目前分析代码不包含投毒，所以投毒风险评估为0%。

**项目地址:** [cyberaguiar/CVE-2016-3088](https://github.com/cyberaguiar/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #6

**来源**: [CVE-2016-3088-pudiding_CVE-2016-3088.md](../2016/CVE-2016-3088-pudiding_CVE-2016-3088.md)

# CVE-2016-3088

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-3088-HeArtE4t3r_CVE-2016-3088.md](../2016/CVE-2016-3088-HeArtE4t3r_CVE-2016-3088.md)

## CVE-2016-3088-Apache ActiveMQ 文件上传与执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x before 5.14.0

**利用条件:** 目标服务器运行存在漏洞版本的ActiveMQ，且Fileserver web application开启，攻击者可以访问目标ActiveMQ的web管理页面。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-3088 漏洞存在于 Apache ActiveMQ 5.14.0 之前的 5.x 版本中。该漏洞允许远程攻击者通过 HTTP PUT 请求上传任意文件，然后通过 HTTP MOVE 请求将上传的文件移动到 Web 应用的目录下，从而执行任意代码。攻击者首先上传一个 JSP 文件，然后将其移动到 ActiveMQ 的 admin 目录下，最后通过访问该 JSP 文件来执行恶意代码。

**有效性：**

根据漏洞信息和 Exploit-DB 记录 (https://www.exploit-db.com/exploits/42283/)，以及其他搜索结果，该漏洞存在且EXP利用代码可用，提供的POC代码有效。

**投毒风险：**

查看提供的 Python 脚本 CVE-2016-3088.py，代码逻辑较为清晰，主要功能是：

1.  **参数解析：** 解析目标 URL、上传路径、以及是否使用自定义脚本。
2.  **URL 验证：** 验证 URL 的有效性。
3.  **文件上传：** 使用 PUT 请求上传临时文件。
4.  **文件移动：** 使用 MOVE 请求将临时文件移动到指定位置（通常是 webapps/admin 目录下）。
5.  **Payload：** 脚本默认包含一个简单的payload，该payload支持URL传参执行命令。也可选择用户提供的自定义脚本进行base64编码并上传

代码中存在一定风险，风险主要来自用户提供的脚本参数。如果用户上传的脚本本身就是恶意脚本，那么攻击者就可以利用该漏洞执行恶意代码。但脚本本身并没有发现明显的恶意代码，例如反弹shell、下载执行其他程序等。

所以，投毒风险较低，但不能完全排除用户自定义脚本引入的风险。判断仓库中作者隐藏投毒代码的可能性为5%。

**利用方式：**

1.  **PUT 请求上传文件：** 攻击者首先向目标 ActiveMQ 服务器的 `/fileserver/` 路径发送一个 HTTP PUT 请求，上传一个包含恶意代码（例如 JSP shell）的文件，文件扩展名可以是任意的，因为后续会重命名。
2.  **MOVE 请求移动文件：** 攻击者然后发送一个 HTTP MOVE 请求，将刚刚上传的文件移动到 ActiveMQ Web 应用的目录下，通常是 `webapps/admin/` 目录。在移动的过程中，将文件名更改为 JSP 文件，例如 `shell.jsp`。
3.  **访问 JSP 文件：** 攻击者最后通过访问 `http://<target>/admin/shell.jsp` 来执行恶意代码。

该漏洞的利用依赖于 ActiveMQ 的 Fileserver web application 开启，并且攻击者具有对该应用目录的写权限。

**项目地址:** [HeArtE4t3r/CVE-2016-3088](https://github.com/HeArtE4t3r/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #2

**来源**: [CVE-2016-3088-Ma1Dong_ActiveMQ_putshell-CVE-2016-3088.md](../2016/CVE-2016-3088-Ma1Dong_ActiveMQ_putshell-CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件上传与执行漏洞

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x before 5.14.0

**利用条件:** 目标系统运行存在漏洞版本的Apache ActiveMQ，且fileserver应用启用。 需要能够通过网络访问 ActiveMQ 的 fileserver 接口。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-3088 漏洞允许攻击者通过 HTTP PUT 请求上传任意文件，然后使用 HTTP MOVE 请求将其移动到 Web 目录，从而实现任意代码执行。漏洞利用代码 `ActiveMQ_putshell.py` 的利用方式如下：

1.  **漏洞检测:** 脚本首先尝试使用PUT方法上传一个文件到经过路径穿越处理后的URL `/fileserver/a../../%08/..%08/.%08/%08`，目的是探测 ActiveMQ 的安装路径。如果返回状态码为500，则从响应头中提取 ActiveMQ 的安装路径。
2.  **上传 Webshell:** 脚本随后使用PUT方法上传一个包含JSP webshell代码的文件 `guo.txt` 到 `/fileserver/guo.txt`。
3.  **移动 Webshell:**  脚本使用MOVE方法，将 `guo.txt` 文件移动到 ActiveMQ Web 应用的 admin 目录下，并重命名为 `guo.jsp`。 Destination 头构造了目标路径，利用了 `file://` 协议和之前获取的 ActiveMQ 安装路径。
4.  **访问 Webshell:** 漏洞利用成功后，攻击者可以通过访问 `url/admin/guo.jsp?pwd=gshell&shell=[command]` 来执行任意命令。

**有效性:** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用方式是有效的，已经存在公开的POC。

**投毒风险:**  虽然提供的脚本本身实现了漏洞利用的功能，但仍然存在细微的投毒风险，例如：
*   **后门修改：** 作者可能在webshell代码中植入不易察觉的后门，虽然当前webshell相对简单。

总体而言，风险较低，大约 1%。主要是利用代码本身的功能实现漏洞，投毒的可能性较低。

**利用方式总结:**

1.  发送 PUT 请求上传任意文件到 `/fileserver/` 目录（或其他可写目录）。
2.  发送 MOVE 请求将上传的文件移动到 Web 应用的可执行目录，例如 `admin` 目录。
3.  访问移动后的文件（例如 JSP 文件），执行恶意代码。

该漏洞利用方式简单直接，易于实现，但依赖于目标系统存在漏洞版本且 fileserver 应用启用。

**项目地址:** [Ma1Dong/ActiveMQ_putshell-CVE-2016-3088](https://github.com/Ma1Dong/ActiveMQ_putshell-CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #3

**来源**: [CVE-2016-3088-YutuSec_ActiveMQ_Crack.md](../2016/CVE-2016-3088-YutuSec_ActiveMQ_Crack.md)

## CVE-2016-3088 - Apache ActiveMQ 任意文件上传/写入漏洞

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传/写入

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x < 5.14.0

**利用条件:** 目标服务器运行存在漏洞的Apache ActiveMQ版本，且Fileserver web application未被禁用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache ActiveMQ的Fileserver Web应用中。攻击者可以通过首先发送一个HTTP PUT请求上传任意文件，然后使用HTTP MOVE请求将该文件移动到Web目录，从而实现任意代码执行。  

**利用方式：**  
1.  **PUT请求：**  攻击者构造一个HTTP PUT请求，将恶意文件（例如JSP webshell）上传到`/fileserver/` 目录下，文件名可以是任意的，例如 `123.txt`。
2.  **MOVE请求：**  攻击者构造一个HTTP MOVE请求，将刚上传的文件从`/fileserver/123.txt` 移动到Web应用可访问的目录，例如`/webapps/api/s.jsp`。`Destination`头指定了目标路径。
3.  **访问恶意文件：**  攻击者通过Web浏览器访问移动后的文件（例如`http://target/api/s.jsp`），服务器会解析并执行该文件中的恶意代码。

**POC有效性：**  
根据漏洞信息和提供的利用代码，可以判断该POC代码是有效的。代码首先检查ActiveMQ的默认口令是否存在，若存在，则尝试利用PUT和MOVE方法上传并移动jsp文件到web目录，并进行访问，判断是否存在漏洞。

**投毒风险评估：**  
经过分析，此仓库中的代码主要功能是检测和利用CVE-2016-3088漏洞，没有发现明显的恶意代码或后门。`DataHandle/Check.go`中存在对`activemq.home` 和 `user.dir` 系统属性的判断，以确定ActiveMQ的安装路径，这是漏洞利用的一部分，不是投毒。因此，投毒风险评估为0%。

**项目地址:** [YutuSec/ActiveMQ_Crack](https://github.com/YutuSec/ActiveMQ_Crack)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #4

**来源**: [CVE-2016-3088-cl4ym0re_CVE-2016-3088.md](../2016/CVE-2016-3088-cl4ym0re_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ Fileserver 任意文件上传/RCE

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要目标ActiveMQ的Fileserver应用启用且未配置安全限制，需要知道管理账号密码，默认账号密码为admin/admin

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-3088 存在于 Apache ActiveMQ 的 Fileserver Web 应用中。攻击者可以通过先使用 HTTP PUT 请求上传任意文件，然后使用 HTTP MOVE 请求将文件移动到 Web 目录，从而实现任意代码执行。

**有效性分析：**
提供的POC代码`CVE-2016-3088.py`利用了该漏洞。代码首先检查 fileserver 是否启用，然后尝试使用默认凭据 `admin:admin` 登录。如果成功，它会尝试获取 `activemq.home` 属性以确定 ActiveMQ 的安装路径。然后，它会上传一个包含恶意代码的 jsp 文件，并使用 MOVE 请求将其移动到 `webapps/api` 目录下。如果成功，攻击者就可以通过访问 `host/api/evil.jsp?pwd=9527&i=whoami` 来执行任意命令。

**投毒风险分析：**
POC代码中，主要风险在于以下几点：

*   **webshell内容：** POC 提供了 webshell 的内容，但用户可以自行修改，所以 webshell 本身不是投毒点。但恶意用户可能会替换成具有恶意功能的 webshell。
*   **利用流程：**  整个利用流程相对清晰，虽然存在修改 webshell 的可能，但不会引入额外的恶意代码。程序目的是getshell，实现逻辑较为完善，暂未发现明显的投毒代码。 综合判断，投毒风险较低，但是需要人工审计修改后的webshell。

基于上述分析，该仓库中存在作者隐藏的投毒代码的风险约为 10%。风险主要来源于用户是否使用了作者提供的webshell payload。

**利用方式：**

1.  使用 HTTP PUT 请求上传一个包含恶意代码的 JSP 文件到 Fileserver。文件名可以为任意名称，例如 `noharm.txt`。
2.  使用 HTTP MOVE 请求将上传的文件移动到 ActiveMQ Web 应用的 Web 目录下，例如 `webapps/api/evil.jsp`。`Destination` header 需要设置为目标路径。
3.  通过访问移动后的 JSP 文件，执行其中的恶意代码，从而实现远程代码执行。

该漏洞利用成功的关键在于目标 ActiveMQ 实例的 Fileserver 应用已启用，并且攻击者能够获取到 ActiveMQ 的安装路径。默认的admin/admin弱口令也大大增加了漏洞的利用成功率。升级到 5.14.0 或更高版本是修复此漏洞的建议方法。

**项目地址:** [cl4ym0re/CVE-2016-3088](https://github.com/cl4ym0re/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #5

**来源**: [CVE-2016-3088-cyberaguiar_CVE-2016-3088.md](../2016/CVE-2016-3088-cyberaguiar_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件上传与执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要能够访问ActiveMQ的Fileserver Web应用，通常位于一个特定的端口，且Fileserver功能未被禁用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞CVE-2016-3088存在于Apache ActiveMQ 5.x版本，直至5.14.0之前。该漏洞允许远程攻击者通过HTTP PUT请求上传任意文件，然后使用HTTP MOVE请求将其移动到Web服务器的可执行目录下，从而执行恶意代码。漏洞利用方式主要分两步：首先，攻击者使用PUT方法将包含恶意代码（例如，JSP webshell）的文件上传到服务器上的某个临时位置。然后，攻击者使用MOVE方法将该文件移动到ActiveMQ Web应用的可访问目录，比如`/opt/activemq/webapps/api/`. 一旦文件被移动到可访问的目录，攻击者就可以通过Web浏览器访问该文件，从而执行其中的恶意代码。根据提供的漏洞利用代码，其中只包含GNU AGPL license文本，不包含任何可执行的利用代码。Github上存在公开的exp，所以POC可用。目前分析代码不包含投毒，所以投毒风险评估为0%。

**项目地址:** [cyberaguiar/CVE-2016-3088](https://github.com/cyberaguiar/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #6

**来源**: [CVE-2016-3088-pudiding_CVE-2016-3088.md](../2016/CVE-2016-3088-pudiding_CVE-2016-3088.md)

# CVE-2016-3088

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-3088-HeArtE4t3r_CVE-2016-3088.md](../2016/CVE-2016-3088-HeArtE4t3r_CVE-2016-3088.md)

## CVE-2016-3088-Apache ActiveMQ 文件上传与执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x before 5.14.0

**利用条件:** 目标服务器运行存在漏洞版本的ActiveMQ，且Fileserver web application开启，攻击者可以访问目标ActiveMQ的web管理页面。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-3088 漏洞存在于 Apache ActiveMQ 5.14.0 之前的 5.x 版本中。该漏洞允许远程攻击者通过 HTTP PUT 请求上传任意文件，然后通过 HTTP MOVE 请求将上传的文件移动到 Web 应用的目录下，从而执行任意代码。攻击者首先上传一个 JSP 文件，然后将其移动到 ActiveMQ 的 admin 目录下，最后通过访问该 JSP 文件来执行恶意代码。

**有效性：**

根据漏洞信息和 Exploit-DB 记录 (https://www.exploit-db.com/exploits/42283/)，以及其他搜索结果，该漏洞存在且EXP利用代码可用，提供的POC代码有效。

**投毒风险：**

查看提供的 Python 脚本 CVE-2016-3088.py，代码逻辑较为清晰，主要功能是：

1.  **参数解析：** 解析目标 URL、上传路径、以及是否使用自定义脚本。
2.  **URL 验证：** 验证 URL 的有效性。
3.  **文件上传：** 使用 PUT 请求上传临时文件。
4.  **文件移动：** 使用 MOVE 请求将临时文件移动到指定位置（通常是 webapps/admin 目录下）。
5.  **Payload：** 脚本默认包含一个简单的payload，该payload支持URL传参执行命令。也可选择用户提供的自定义脚本进行base64编码并上传

代码中存在一定风险，风险主要来自用户提供的脚本参数。如果用户上传的脚本本身就是恶意脚本，那么攻击者就可以利用该漏洞执行恶意代码。但脚本本身并没有发现明显的恶意代码，例如反弹shell、下载执行其他程序等。

所以，投毒风险较低，但不能完全排除用户自定义脚本引入的风险。判断仓库中作者隐藏投毒代码的可能性为5%。

**利用方式：**

1.  **PUT 请求上传文件：** 攻击者首先向目标 ActiveMQ 服务器的 `/fileserver/` 路径发送一个 HTTP PUT 请求，上传一个包含恶意代码（例如 JSP shell）的文件，文件扩展名可以是任意的，因为后续会重命名。
2.  **MOVE 请求移动文件：** 攻击者然后发送一个 HTTP MOVE 请求，将刚刚上传的文件移动到 ActiveMQ Web 应用的目录下，通常是 `webapps/admin/` 目录。在移动的过程中，将文件名更改为 JSP 文件，例如 `shell.jsp`。
3.  **访问 JSP 文件：** 攻击者最后通过访问 `http://<target>/admin/shell.jsp` 来执行恶意代码。

该漏洞的利用依赖于 ActiveMQ 的 Fileserver web application 开启，并且攻击者具有对该应用目录的写权限。

**项目地址:** [HeArtE4t3r/CVE-2016-3088](https://github.com/HeArtE4t3r/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #2

**来源**: [CVE-2016-3088-Ma1Dong_ActiveMQ_putshell-CVE-2016-3088.md](../2016/CVE-2016-3088-Ma1Dong_ActiveMQ_putshell-CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件上传与执行漏洞

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x before 5.14.0

**利用条件:** 目标系统运行存在漏洞版本的Apache ActiveMQ，且fileserver应用启用。 需要能够通过网络访问 ActiveMQ 的 fileserver 接口。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-3088 漏洞允许攻击者通过 HTTP PUT 请求上传任意文件，然后使用 HTTP MOVE 请求将其移动到 Web 目录，从而实现任意代码执行。漏洞利用代码 `ActiveMQ_putshell.py` 的利用方式如下：

1.  **漏洞检测:** 脚本首先尝试使用PUT方法上传一个文件到经过路径穿越处理后的URL `/fileserver/a../../%08/..%08/.%08/%08`，目的是探测 ActiveMQ 的安装路径。如果返回状态码为500，则从响应头中提取 ActiveMQ 的安装路径。
2.  **上传 Webshell:** 脚本随后使用PUT方法上传一个包含JSP webshell代码的文件 `guo.txt` 到 `/fileserver/guo.txt`。
3.  **移动 Webshell:**  脚本使用MOVE方法，将 `guo.txt` 文件移动到 ActiveMQ Web 应用的 admin 目录下，并重命名为 `guo.jsp`。 Destination 头构造了目标路径，利用了 `file://` 协议和之前获取的 ActiveMQ 安装路径。
4.  **访问 Webshell:** 漏洞利用成功后，攻击者可以通过访问 `url/admin/guo.jsp?pwd=gshell&shell=[command]` 来执行任意命令。

**有效性:** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用方式是有效的，已经存在公开的POC。

**投毒风险:**  虽然提供的脚本本身实现了漏洞利用的功能，但仍然存在细微的投毒风险，例如：
*   **后门修改：** 作者可能在webshell代码中植入不易察觉的后门，虽然当前webshell相对简单。

总体而言，风险较低，大约 1%。主要是利用代码本身的功能实现漏洞，投毒的可能性较低。

**利用方式总结:**

1.  发送 PUT 请求上传任意文件到 `/fileserver/` 目录（或其他可写目录）。
2.  发送 MOVE 请求将上传的文件移动到 Web 应用的可执行目录，例如 `admin` 目录。
3.  访问移动后的文件（例如 JSP 文件），执行恶意代码。

该漏洞利用方式简单直接，易于实现，但依赖于目标系统存在漏洞版本且 fileserver 应用启用。

**项目地址:** [Ma1Dong/ActiveMQ_putshell-CVE-2016-3088](https://github.com/Ma1Dong/ActiveMQ_putshell-CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #3

**来源**: [CVE-2016-3088-YutuSec_ActiveMQ_Crack.md](../2016/CVE-2016-3088-YutuSec_ActiveMQ_Crack.md)

## CVE-2016-3088 - Apache ActiveMQ 任意文件上传/写入漏洞

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传/写入

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x < 5.14.0

**利用条件:** 目标服务器运行存在漏洞的Apache ActiveMQ版本，且Fileserver web application未被禁用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache ActiveMQ的Fileserver Web应用中。攻击者可以通过首先发送一个HTTP PUT请求上传任意文件，然后使用HTTP MOVE请求将该文件移动到Web目录，从而实现任意代码执行。  

**利用方式：**  
1.  **PUT请求：**  攻击者构造一个HTTP PUT请求，将恶意文件（例如JSP webshell）上传到`/fileserver/` 目录下，文件名可以是任意的，例如 `123.txt`。
2.  **MOVE请求：**  攻击者构造一个HTTP MOVE请求，将刚上传的文件从`/fileserver/123.txt` 移动到Web应用可访问的目录，例如`/webapps/api/s.jsp`。`Destination`头指定了目标路径。
3.  **访问恶意文件：**  攻击者通过Web浏览器访问移动后的文件（例如`http://target/api/s.jsp`），服务器会解析并执行该文件中的恶意代码。

**POC有效性：**  
根据漏洞信息和提供的利用代码，可以判断该POC代码是有效的。代码首先检查ActiveMQ的默认口令是否存在，若存在，则尝试利用PUT和MOVE方法上传并移动jsp文件到web目录，并进行访问，判断是否存在漏洞。

**投毒风险评估：**  
经过分析，此仓库中的代码主要功能是检测和利用CVE-2016-3088漏洞，没有发现明显的恶意代码或后门。`DataHandle/Check.go`中存在对`activemq.home` 和 `user.dir` 系统属性的判断，以确定ActiveMQ的安装路径，这是漏洞利用的一部分，不是投毒。因此，投毒风险评估为0%。

**项目地址:** [YutuSec/ActiveMQ_Crack](https://github.com/YutuSec/ActiveMQ_Crack)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #4

**来源**: [CVE-2016-3088-cl4ym0re_CVE-2016-3088.md](../2016/CVE-2016-3088-cl4ym0re_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ Fileserver 任意文件上传/RCE

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要目标ActiveMQ的Fileserver应用启用且未配置安全限制，需要知道管理账号密码，默认账号密码为admin/admin

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-3088 存在于 Apache ActiveMQ 的 Fileserver Web 应用中。攻击者可以通过先使用 HTTP PUT 请求上传任意文件，然后使用 HTTP MOVE 请求将文件移动到 Web 目录，从而实现任意代码执行。

**有效性分析：**
提供的POC代码`CVE-2016-3088.py`利用了该漏洞。代码首先检查 fileserver 是否启用，然后尝试使用默认凭据 `admin:admin` 登录。如果成功，它会尝试获取 `activemq.home` 属性以确定 ActiveMQ 的安装路径。然后，它会上传一个包含恶意代码的 jsp 文件，并使用 MOVE 请求将其移动到 `webapps/api` 目录下。如果成功，攻击者就可以通过访问 `host/api/evil.jsp?pwd=9527&i=whoami` 来执行任意命令。

**投毒风险分析：**
POC代码中，主要风险在于以下几点：

*   **webshell内容：** POC 提供了 webshell 的内容，但用户可以自行修改，所以 webshell 本身不是投毒点。但恶意用户可能会替换成具有恶意功能的 webshell。
*   **利用流程：**  整个利用流程相对清晰，虽然存在修改 webshell 的可能，但不会引入额外的恶意代码。程序目的是getshell，实现逻辑较为完善，暂未发现明显的投毒代码。 综合判断，投毒风险较低，但是需要人工审计修改后的webshell。

基于上述分析，该仓库中存在作者隐藏的投毒代码的风险约为 10%。风险主要来源于用户是否使用了作者提供的webshell payload。

**利用方式：**

1.  使用 HTTP PUT 请求上传一个包含恶意代码的 JSP 文件到 Fileserver。文件名可以为任意名称，例如 `noharm.txt`。
2.  使用 HTTP MOVE 请求将上传的文件移动到 ActiveMQ Web 应用的 Web 目录下，例如 `webapps/api/evil.jsp`。`Destination` header 需要设置为目标路径。
3.  通过访问移动后的 JSP 文件，执行其中的恶意代码，从而实现远程代码执行。

该漏洞利用成功的关键在于目标 ActiveMQ 实例的 Fileserver 应用已启用，并且攻击者能够获取到 ActiveMQ 的安装路径。默认的admin/admin弱口令也大大增加了漏洞的利用成功率。升级到 5.14.0 或更高版本是修复此漏洞的建议方法。

**项目地址:** [cl4ym0re/CVE-2016-3088](https://github.com/cl4ym0re/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #5

**来源**: [CVE-2016-3088-cyberaguiar_CVE-2016-3088.md](../2016/CVE-2016-3088-cyberaguiar_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件上传与执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要能够访问ActiveMQ的Fileserver Web应用，通常位于一个特定的端口，且Fileserver功能未被禁用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞CVE-2016-3088存在于Apache ActiveMQ 5.x版本，直至5.14.0之前。该漏洞允许远程攻击者通过HTTP PUT请求上传任意文件，然后使用HTTP MOVE请求将其移动到Web服务器的可执行目录下，从而执行恶意代码。漏洞利用方式主要分两步：首先，攻击者使用PUT方法将包含恶意代码（例如，JSP webshell）的文件上传到服务器上的某个临时位置。然后，攻击者使用MOVE方法将该文件移动到ActiveMQ Web应用的可访问目录，比如`/opt/activemq/webapps/api/`. 一旦文件被移动到可访问的目录，攻击者就可以通过Web浏览器访问该文件，从而执行其中的恶意代码。根据提供的漏洞利用代码，其中只包含GNU AGPL license文本，不包含任何可执行的利用代码。Github上存在公开的exp，所以POC可用。目前分析代码不包含投毒，所以投毒风险评估为0%。

**项目地址:** [cyberaguiar/CVE-2016-3088](https://github.com/cyberaguiar/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #6

**来源**: [CVE-2016-3088-pudiding_CVE-2016-3088.md](../2016/CVE-2016-3088-pudiding_CVE-2016-3088.md)

# CVE-2016-3088

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-3088-HeArtE4t3r_CVE-2016-3088.md](../2016/CVE-2016-3088-HeArtE4t3r_CVE-2016-3088.md)

## CVE-2016-3088-Apache ActiveMQ 文件上传与执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x before 5.14.0

**利用条件:** 目标服务器运行存在漏洞版本的ActiveMQ，且Fileserver web application开启，攻击者可以访问目标ActiveMQ的web管理页面。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-3088 漏洞存在于 Apache ActiveMQ 5.14.0 之前的 5.x 版本中。该漏洞允许远程攻击者通过 HTTP PUT 请求上传任意文件，然后通过 HTTP MOVE 请求将上传的文件移动到 Web 应用的目录下，从而执行任意代码。攻击者首先上传一个 JSP 文件，然后将其移动到 ActiveMQ 的 admin 目录下，最后通过访问该 JSP 文件来执行恶意代码。

**有效性：**

根据漏洞信息和 Exploit-DB 记录 (https://www.exploit-db.com/exploits/42283/)，以及其他搜索结果，该漏洞存在且EXP利用代码可用，提供的POC代码有效。

**投毒风险：**

查看提供的 Python 脚本 CVE-2016-3088.py，代码逻辑较为清晰，主要功能是：

1.  **参数解析：** 解析目标 URL、上传路径、以及是否使用自定义脚本。
2.  **URL 验证：** 验证 URL 的有效性。
3.  **文件上传：** 使用 PUT 请求上传临时文件。
4.  **文件移动：** 使用 MOVE 请求将临时文件移动到指定位置（通常是 webapps/admin 目录下）。
5.  **Payload：** 脚本默认包含一个简单的payload，该payload支持URL传参执行命令。也可选择用户提供的自定义脚本进行base64编码并上传

代码中存在一定风险，风险主要来自用户提供的脚本参数。如果用户上传的脚本本身就是恶意脚本，那么攻击者就可以利用该漏洞执行恶意代码。但脚本本身并没有发现明显的恶意代码，例如反弹shell、下载执行其他程序等。

所以，投毒风险较低，但不能完全排除用户自定义脚本引入的风险。判断仓库中作者隐藏投毒代码的可能性为5%。

**利用方式：**

1.  **PUT 请求上传文件：** 攻击者首先向目标 ActiveMQ 服务器的 `/fileserver/` 路径发送一个 HTTP PUT 请求，上传一个包含恶意代码（例如 JSP shell）的文件，文件扩展名可以是任意的，因为后续会重命名。
2.  **MOVE 请求移动文件：** 攻击者然后发送一个 HTTP MOVE 请求，将刚刚上传的文件移动到 ActiveMQ Web 应用的目录下，通常是 `webapps/admin/` 目录。在移动的过程中，将文件名更改为 JSP 文件，例如 `shell.jsp`。
3.  **访问 JSP 文件：** 攻击者最后通过访问 `http://<target>/admin/shell.jsp` 来执行恶意代码。

该漏洞的利用依赖于 ActiveMQ 的 Fileserver web application 开启，并且攻击者具有对该应用目录的写权限。

**项目地址:** [HeArtE4t3r/CVE-2016-3088](https://github.com/HeArtE4t3r/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #2

**来源**: [CVE-2016-3088-Ma1Dong_ActiveMQ_putshell-CVE-2016-3088.md](../2016/CVE-2016-3088-Ma1Dong_ActiveMQ_putshell-CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件上传与执行漏洞

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x before 5.14.0

**利用条件:** 目标系统运行存在漏洞版本的Apache ActiveMQ，且fileserver应用启用。 需要能够通过网络访问 ActiveMQ 的 fileserver 接口。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-3088 漏洞允许攻击者通过 HTTP PUT 请求上传任意文件，然后使用 HTTP MOVE 请求将其移动到 Web 目录，从而实现任意代码执行。漏洞利用代码 `ActiveMQ_putshell.py` 的利用方式如下：

1.  **漏洞检测:** 脚本首先尝试使用PUT方法上传一个文件到经过路径穿越处理后的URL `/fileserver/a../../%08/..%08/.%08/%08`，目的是探测 ActiveMQ 的安装路径。如果返回状态码为500，则从响应头中提取 ActiveMQ 的安装路径。
2.  **上传 Webshell:** 脚本随后使用PUT方法上传一个包含JSP webshell代码的文件 `guo.txt` 到 `/fileserver/guo.txt`。
3.  **移动 Webshell:**  脚本使用MOVE方法，将 `guo.txt` 文件移动到 ActiveMQ Web 应用的 admin 目录下，并重命名为 `guo.jsp`。 Destination 头构造了目标路径，利用了 `file://` 协议和之前获取的 ActiveMQ 安装路径。
4.  **访问 Webshell:** 漏洞利用成功后，攻击者可以通过访问 `url/admin/guo.jsp?pwd=gshell&shell=[command]` 来执行任意命令。

**有效性:** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用方式是有效的，已经存在公开的POC。

**投毒风险:**  虽然提供的脚本本身实现了漏洞利用的功能，但仍然存在细微的投毒风险，例如：
*   **后门修改：** 作者可能在webshell代码中植入不易察觉的后门，虽然当前webshell相对简单。

总体而言，风险较低，大约 1%。主要是利用代码本身的功能实现漏洞，投毒的可能性较低。

**利用方式总结:**

1.  发送 PUT 请求上传任意文件到 `/fileserver/` 目录（或其他可写目录）。
2.  发送 MOVE 请求将上传的文件移动到 Web 应用的可执行目录，例如 `admin` 目录。
3.  访问移动后的文件（例如 JSP 文件），执行恶意代码。

该漏洞利用方式简单直接，易于实现，但依赖于目标系统存在漏洞版本且 fileserver 应用启用。

**项目地址:** [Ma1Dong/ActiveMQ_putshell-CVE-2016-3088](https://github.com/Ma1Dong/ActiveMQ_putshell-CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #3

**来源**: [CVE-2016-3088-YutuSec_ActiveMQ_Crack.md](../2016/CVE-2016-3088-YutuSec_ActiveMQ_Crack.md)

## CVE-2016-3088 - Apache ActiveMQ 任意文件上传/写入漏洞

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传/写入

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x < 5.14.0

**利用条件:** 目标服务器运行存在漏洞的Apache ActiveMQ版本，且Fileserver web application未被禁用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache ActiveMQ的Fileserver Web应用中。攻击者可以通过首先发送一个HTTP PUT请求上传任意文件，然后使用HTTP MOVE请求将该文件移动到Web目录，从而实现任意代码执行。  

**利用方式：**  
1.  **PUT请求：**  攻击者构造一个HTTP PUT请求，将恶意文件（例如JSP webshell）上传到`/fileserver/` 目录下，文件名可以是任意的，例如 `123.txt`。
2.  **MOVE请求：**  攻击者构造一个HTTP MOVE请求，将刚上传的文件从`/fileserver/123.txt` 移动到Web应用可访问的目录，例如`/webapps/api/s.jsp`。`Destination`头指定了目标路径。
3.  **访问恶意文件：**  攻击者通过Web浏览器访问移动后的文件（例如`http://target/api/s.jsp`），服务器会解析并执行该文件中的恶意代码。

**POC有效性：**  
根据漏洞信息和提供的利用代码，可以判断该POC代码是有效的。代码首先检查ActiveMQ的默认口令是否存在，若存在，则尝试利用PUT和MOVE方法上传并移动jsp文件到web目录，并进行访问，判断是否存在漏洞。

**投毒风险评估：**  
经过分析，此仓库中的代码主要功能是检测和利用CVE-2016-3088漏洞，没有发现明显的恶意代码或后门。`DataHandle/Check.go`中存在对`activemq.home` 和 `user.dir` 系统属性的判断，以确定ActiveMQ的安装路径，这是漏洞利用的一部分，不是投毒。因此，投毒风险评估为0%。

**项目地址:** [YutuSec/ActiveMQ_Crack](https://github.com/YutuSec/ActiveMQ_Crack)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #4

**来源**: [CVE-2016-3088-cl4ym0re_CVE-2016-3088.md](../2016/CVE-2016-3088-cl4ym0re_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ Fileserver 任意文件上传/RCE

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要目标ActiveMQ的Fileserver应用启用且未配置安全限制，需要知道管理账号密码，默认账号密码为admin/admin

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-3088 存在于 Apache ActiveMQ 的 Fileserver Web 应用中。攻击者可以通过先使用 HTTP PUT 请求上传任意文件，然后使用 HTTP MOVE 请求将文件移动到 Web 目录，从而实现任意代码执行。

**有效性分析：**
提供的POC代码`CVE-2016-3088.py`利用了该漏洞。代码首先检查 fileserver 是否启用，然后尝试使用默认凭据 `admin:admin` 登录。如果成功，它会尝试获取 `activemq.home` 属性以确定 ActiveMQ 的安装路径。然后，它会上传一个包含恶意代码的 jsp 文件，并使用 MOVE 请求将其移动到 `webapps/api` 目录下。如果成功，攻击者就可以通过访问 `host/api/evil.jsp?pwd=9527&i=whoami` 来执行任意命令。

**投毒风险分析：**
POC代码中，主要风险在于以下几点：

*   **webshell内容：** POC 提供了 webshell 的内容，但用户可以自行修改，所以 webshell 本身不是投毒点。但恶意用户可能会替换成具有恶意功能的 webshell。
*   **利用流程：**  整个利用流程相对清晰，虽然存在修改 webshell 的可能，但不会引入额外的恶意代码。程序目的是getshell，实现逻辑较为完善，暂未发现明显的投毒代码。 综合判断，投毒风险较低，但是需要人工审计修改后的webshell。

基于上述分析，该仓库中存在作者隐藏的投毒代码的风险约为 10%。风险主要来源于用户是否使用了作者提供的webshell payload。

**利用方式：**

1.  使用 HTTP PUT 请求上传一个包含恶意代码的 JSP 文件到 Fileserver。文件名可以为任意名称，例如 `noharm.txt`。
2.  使用 HTTP MOVE 请求将上传的文件移动到 ActiveMQ Web 应用的 Web 目录下，例如 `webapps/api/evil.jsp`。`Destination` header 需要设置为目标路径。
3.  通过访问移动后的 JSP 文件，执行其中的恶意代码，从而实现远程代码执行。

该漏洞利用成功的关键在于目标 ActiveMQ 实例的 Fileserver 应用已启用，并且攻击者能够获取到 ActiveMQ 的安装路径。默认的admin/admin弱口令也大大增加了漏洞的利用成功率。升级到 5.14.0 或更高版本是修复此漏洞的建议方法。

**项目地址:** [cl4ym0re/CVE-2016-3088](https://github.com/cl4ym0re/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #5

**来源**: [CVE-2016-3088-cyberaguiar_CVE-2016-3088.md](../2016/CVE-2016-3088-cyberaguiar_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件上传与执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要能够访问ActiveMQ的Fileserver Web应用，通常位于一个特定的端口，且Fileserver功能未被禁用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞CVE-2016-3088存在于Apache ActiveMQ 5.x版本，直至5.14.0之前。该漏洞允许远程攻击者通过HTTP PUT请求上传任意文件，然后使用HTTP MOVE请求将其移动到Web服务器的可执行目录下，从而执行恶意代码。漏洞利用方式主要分两步：首先，攻击者使用PUT方法将包含恶意代码（例如，JSP webshell）的文件上传到服务器上的某个临时位置。然后，攻击者使用MOVE方法将该文件移动到ActiveMQ Web应用的可访问目录，比如`/opt/activemq/webapps/api/`. 一旦文件被移动到可访问的目录，攻击者就可以通过Web浏览器访问该文件，从而执行其中的恶意代码。根据提供的漏洞利用代码，其中只包含GNU AGPL license文本，不包含任何可执行的利用代码。Github上存在公开的exp，所以POC可用。目前分析代码不包含投毒，所以投毒风险评估为0%。

**项目地址:** [cyberaguiar/CVE-2016-3088](https://github.com/cyberaguiar/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #6

**来源**: [CVE-2016-3088-pudiding_CVE-2016-3088.md](../2016/CVE-2016-3088-pudiding_CVE-2016-3088.md)

# CVE-2016-3088

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-3088-HeArtE4t3r_CVE-2016-3088.md](../2016/CVE-2016-3088-HeArtE4t3r_CVE-2016-3088.md)

## CVE-2016-3088-Apache ActiveMQ 文件上传与执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x before 5.14.0

**利用条件:** 目标服务器运行存在漏洞版本的ActiveMQ，且Fileserver web application开启，攻击者可以访问目标ActiveMQ的web管理页面。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-3088 漏洞存在于 Apache ActiveMQ 5.14.0 之前的 5.x 版本中。该漏洞允许远程攻击者通过 HTTP PUT 请求上传任意文件，然后通过 HTTP MOVE 请求将上传的文件移动到 Web 应用的目录下，从而执行任意代码。攻击者首先上传一个 JSP 文件，然后将其移动到 ActiveMQ 的 admin 目录下，最后通过访问该 JSP 文件来执行恶意代码。

**有效性：**

根据漏洞信息和 Exploit-DB 记录 (https://www.exploit-db.com/exploits/42283/)，以及其他搜索结果，该漏洞存在且EXP利用代码可用，提供的POC代码有效。

**投毒风险：**

查看提供的 Python 脚本 CVE-2016-3088.py，代码逻辑较为清晰，主要功能是：

1.  **参数解析：** 解析目标 URL、上传路径、以及是否使用自定义脚本。
2.  **URL 验证：** 验证 URL 的有效性。
3.  **文件上传：** 使用 PUT 请求上传临时文件。
4.  **文件移动：** 使用 MOVE 请求将临时文件移动到指定位置（通常是 webapps/admin 目录下）。
5.  **Payload：** 脚本默认包含一个简单的payload，该payload支持URL传参执行命令。也可选择用户提供的自定义脚本进行base64编码并上传

代码中存在一定风险，风险主要来自用户提供的脚本参数。如果用户上传的脚本本身就是恶意脚本，那么攻击者就可以利用该漏洞执行恶意代码。但脚本本身并没有发现明显的恶意代码，例如反弹shell、下载执行其他程序等。

所以，投毒风险较低，但不能完全排除用户自定义脚本引入的风险。判断仓库中作者隐藏投毒代码的可能性为5%。

**利用方式：**

1.  **PUT 请求上传文件：** 攻击者首先向目标 ActiveMQ 服务器的 `/fileserver/` 路径发送一个 HTTP PUT 请求，上传一个包含恶意代码（例如 JSP shell）的文件，文件扩展名可以是任意的，因为后续会重命名。
2.  **MOVE 请求移动文件：** 攻击者然后发送一个 HTTP MOVE 请求，将刚刚上传的文件移动到 ActiveMQ Web 应用的目录下，通常是 `webapps/admin/` 目录。在移动的过程中，将文件名更改为 JSP 文件，例如 `shell.jsp`。
3.  **访问 JSP 文件：** 攻击者最后通过访问 `http://<target>/admin/shell.jsp` 来执行恶意代码。

该漏洞的利用依赖于 ActiveMQ 的 Fileserver web application 开启，并且攻击者具有对该应用目录的写权限。

**项目地址:** [HeArtE4t3r/CVE-2016-3088](https://github.com/HeArtE4t3r/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #2

**来源**: [CVE-2016-3088-Ma1Dong_ActiveMQ_putshell-CVE-2016-3088.md](../2016/CVE-2016-3088-Ma1Dong_ActiveMQ_putshell-CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件上传与执行漏洞

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x before 5.14.0

**利用条件:** 目标系统运行存在漏洞版本的Apache ActiveMQ，且fileserver应用启用。 需要能够通过网络访问 ActiveMQ 的 fileserver 接口。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-3088 漏洞允许攻击者通过 HTTP PUT 请求上传任意文件，然后使用 HTTP MOVE 请求将其移动到 Web 目录，从而实现任意代码执行。漏洞利用代码 `ActiveMQ_putshell.py` 的利用方式如下：

1.  **漏洞检测:** 脚本首先尝试使用PUT方法上传一个文件到经过路径穿越处理后的URL `/fileserver/a../../%08/..%08/.%08/%08`，目的是探测 ActiveMQ 的安装路径。如果返回状态码为500，则从响应头中提取 ActiveMQ 的安装路径。
2.  **上传 Webshell:** 脚本随后使用PUT方法上传一个包含JSP webshell代码的文件 `guo.txt` 到 `/fileserver/guo.txt`。
3.  **移动 Webshell:**  脚本使用MOVE方法，将 `guo.txt` 文件移动到 ActiveMQ Web 应用的 admin 目录下，并重命名为 `guo.jsp`。 Destination 头构造了目标路径，利用了 `file://` 协议和之前获取的 ActiveMQ 安装路径。
4.  **访问 Webshell:** 漏洞利用成功后，攻击者可以通过访问 `url/admin/guo.jsp?pwd=gshell&shell=[command]` 来执行任意命令。

**有效性:** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用方式是有效的，已经存在公开的POC。

**投毒风险:**  虽然提供的脚本本身实现了漏洞利用的功能，但仍然存在细微的投毒风险，例如：
*   **后门修改：** 作者可能在webshell代码中植入不易察觉的后门，虽然当前webshell相对简单。

总体而言，风险较低，大约 1%。主要是利用代码本身的功能实现漏洞，投毒的可能性较低。

**利用方式总结:**

1.  发送 PUT 请求上传任意文件到 `/fileserver/` 目录（或其他可写目录）。
2.  发送 MOVE 请求将上传的文件移动到 Web 应用的可执行目录，例如 `admin` 目录。
3.  访问移动后的文件（例如 JSP 文件），执行恶意代码。

该漏洞利用方式简单直接，易于实现，但依赖于目标系统存在漏洞版本且 fileserver 应用启用。

**项目地址:** [Ma1Dong/ActiveMQ_putshell-CVE-2016-3088](https://github.com/Ma1Dong/ActiveMQ_putshell-CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #3

**来源**: [CVE-2016-3088-YutuSec_ActiveMQ_Crack.md](../2016/CVE-2016-3088-YutuSec_ActiveMQ_Crack.md)

## CVE-2016-3088 - Apache ActiveMQ 任意文件上传/写入漏洞

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传/写入

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x < 5.14.0

**利用条件:** 目标服务器运行存在漏洞的Apache ActiveMQ版本，且Fileserver web application未被禁用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache ActiveMQ的Fileserver Web应用中。攻击者可以通过首先发送一个HTTP PUT请求上传任意文件，然后使用HTTP MOVE请求将该文件移动到Web目录，从而实现任意代码执行。  

**利用方式：**  
1.  **PUT请求：**  攻击者构造一个HTTP PUT请求，将恶意文件（例如JSP webshell）上传到`/fileserver/` 目录下，文件名可以是任意的，例如 `123.txt`。
2.  **MOVE请求：**  攻击者构造一个HTTP MOVE请求，将刚上传的文件从`/fileserver/123.txt` 移动到Web应用可访问的目录，例如`/webapps/api/s.jsp`。`Destination`头指定了目标路径。
3.  **访问恶意文件：**  攻击者通过Web浏览器访问移动后的文件（例如`http://target/api/s.jsp`），服务器会解析并执行该文件中的恶意代码。

**POC有效性：**  
根据漏洞信息和提供的利用代码，可以判断该POC代码是有效的。代码首先检查ActiveMQ的默认口令是否存在，若存在，则尝试利用PUT和MOVE方法上传并移动jsp文件到web目录，并进行访问，判断是否存在漏洞。

**投毒风险评估：**  
经过分析，此仓库中的代码主要功能是检测和利用CVE-2016-3088漏洞，没有发现明显的恶意代码或后门。`DataHandle/Check.go`中存在对`activemq.home` 和 `user.dir` 系统属性的判断，以确定ActiveMQ的安装路径，这是漏洞利用的一部分，不是投毒。因此，投毒风险评估为0%。

**项目地址:** [YutuSec/ActiveMQ_Crack](https://github.com/YutuSec/ActiveMQ_Crack)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #4

**来源**: [CVE-2016-3088-cl4ym0re_CVE-2016-3088.md](../2016/CVE-2016-3088-cl4ym0re_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ Fileserver 任意文件上传/RCE

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要目标ActiveMQ的Fileserver应用启用且未配置安全限制，需要知道管理账号密码，默认账号密码为admin/admin

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-3088 存在于 Apache ActiveMQ 的 Fileserver Web 应用中。攻击者可以通过先使用 HTTP PUT 请求上传任意文件，然后使用 HTTP MOVE 请求将文件移动到 Web 目录，从而实现任意代码执行。

**有效性分析：**
提供的POC代码`CVE-2016-3088.py`利用了该漏洞。代码首先检查 fileserver 是否启用，然后尝试使用默认凭据 `admin:admin` 登录。如果成功，它会尝试获取 `activemq.home` 属性以确定 ActiveMQ 的安装路径。然后，它会上传一个包含恶意代码的 jsp 文件，并使用 MOVE 请求将其移动到 `webapps/api` 目录下。如果成功，攻击者就可以通过访问 `host/api/evil.jsp?pwd=9527&i=whoami` 来执行任意命令。

**投毒风险分析：**
POC代码中，主要风险在于以下几点：

*   **webshell内容：** POC 提供了 webshell 的内容，但用户可以自行修改，所以 webshell 本身不是投毒点。但恶意用户可能会替换成具有恶意功能的 webshell。
*   **利用流程：**  整个利用流程相对清晰，虽然存在修改 webshell 的可能，但不会引入额外的恶意代码。程序目的是getshell，实现逻辑较为完善，暂未发现明显的投毒代码。 综合判断，投毒风险较低，但是需要人工审计修改后的webshell。

基于上述分析，该仓库中存在作者隐藏的投毒代码的风险约为 10%。风险主要来源于用户是否使用了作者提供的webshell payload。

**利用方式：**

1.  使用 HTTP PUT 请求上传一个包含恶意代码的 JSP 文件到 Fileserver。文件名可以为任意名称，例如 `noharm.txt`。
2.  使用 HTTP MOVE 请求将上传的文件移动到 ActiveMQ Web 应用的 Web 目录下，例如 `webapps/api/evil.jsp`。`Destination` header 需要设置为目标路径。
3.  通过访问移动后的 JSP 文件，执行其中的恶意代码，从而实现远程代码执行。

该漏洞利用成功的关键在于目标 ActiveMQ 实例的 Fileserver 应用已启用，并且攻击者能够获取到 ActiveMQ 的安装路径。默认的admin/admin弱口令也大大增加了漏洞的利用成功率。升级到 5.14.0 或更高版本是修复此漏洞的建议方法。

**项目地址:** [cl4ym0re/CVE-2016-3088](https://github.com/cl4ym0re/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #5

**来源**: [CVE-2016-3088-cyberaguiar_CVE-2016-3088.md](../2016/CVE-2016-3088-cyberaguiar_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件上传与执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要能够访问ActiveMQ的Fileserver Web应用，通常位于一个特定的端口，且Fileserver功能未被禁用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞CVE-2016-3088存在于Apache ActiveMQ 5.x版本，直至5.14.0之前。该漏洞允许远程攻击者通过HTTP PUT请求上传任意文件，然后使用HTTP MOVE请求将其移动到Web服务器的可执行目录下，从而执行恶意代码。漏洞利用方式主要分两步：首先，攻击者使用PUT方法将包含恶意代码（例如，JSP webshell）的文件上传到服务器上的某个临时位置。然后，攻击者使用MOVE方法将该文件移动到ActiveMQ Web应用的可访问目录，比如`/opt/activemq/webapps/api/`. 一旦文件被移动到可访问的目录，攻击者就可以通过Web浏览器访问该文件，从而执行其中的恶意代码。根据提供的漏洞利用代码，其中只包含GNU AGPL license文本，不包含任何可执行的利用代码。Github上存在公开的exp，所以POC可用。目前分析代码不包含投毒，所以投毒风险评估为0%。

**项目地址:** [cyberaguiar/CVE-2016-3088](https://github.com/cyberaguiar/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #6

**来源**: [CVE-2016-3088-pudiding_CVE-2016-3088.md](../2016/CVE-2016-3088-pudiding_CVE-2016-3088.md)

# CVE-2016-3088

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-3088-HeArtE4t3r_CVE-2016-3088.md](../2016/CVE-2016-3088-HeArtE4t3r_CVE-2016-3088.md)

## CVE-2016-3088-Apache ActiveMQ 文件上传与执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x before 5.14.0

**利用条件:** 目标服务器运行存在漏洞版本的ActiveMQ，且Fileserver web application开启，攻击者可以访问目标ActiveMQ的web管理页面。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-3088 漏洞存在于 Apache ActiveMQ 5.14.0 之前的 5.x 版本中。该漏洞允许远程攻击者通过 HTTP PUT 请求上传任意文件，然后通过 HTTP MOVE 请求将上传的文件移动到 Web 应用的目录下，从而执行任意代码。攻击者首先上传一个 JSP 文件，然后将其移动到 ActiveMQ 的 admin 目录下，最后通过访问该 JSP 文件来执行恶意代码。

**有效性：**

根据漏洞信息和 Exploit-DB 记录 (https://www.exploit-db.com/exploits/42283/)，以及其他搜索结果，该漏洞存在且EXP利用代码可用，提供的POC代码有效。

**投毒风险：**

查看提供的 Python 脚本 CVE-2016-3088.py，代码逻辑较为清晰，主要功能是：

1.  **参数解析：** 解析目标 URL、上传路径、以及是否使用自定义脚本。
2.  **URL 验证：** 验证 URL 的有效性。
3.  **文件上传：** 使用 PUT 请求上传临时文件。
4.  **文件移动：** 使用 MOVE 请求将临时文件移动到指定位置（通常是 webapps/admin 目录下）。
5.  **Payload：** 脚本默认包含一个简单的payload，该payload支持URL传参执行命令。也可选择用户提供的自定义脚本进行base64编码并上传

代码中存在一定风险，风险主要来自用户提供的脚本参数。如果用户上传的脚本本身就是恶意脚本，那么攻击者就可以利用该漏洞执行恶意代码。但脚本本身并没有发现明显的恶意代码，例如反弹shell、下载执行其他程序等。

所以，投毒风险较低，但不能完全排除用户自定义脚本引入的风险。判断仓库中作者隐藏投毒代码的可能性为5%。

**利用方式：**

1.  **PUT 请求上传文件：** 攻击者首先向目标 ActiveMQ 服务器的 `/fileserver/` 路径发送一个 HTTP PUT 请求，上传一个包含恶意代码（例如 JSP shell）的文件，文件扩展名可以是任意的，因为后续会重命名。
2.  **MOVE 请求移动文件：** 攻击者然后发送一个 HTTP MOVE 请求，将刚刚上传的文件移动到 ActiveMQ Web 应用的目录下，通常是 `webapps/admin/` 目录。在移动的过程中，将文件名更改为 JSP 文件，例如 `shell.jsp`。
3.  **访问 JSP 文件：** 攻击者最后通过访问 `http://<target>/admin/shell.jsp` 来执行恶意代码。

该漏洞的利用依赖于 ActiveMQ 的 Fileserver web application 开启，并且攻击者具有对该应用目录的写权限。

**项目地址:** [HeArtE4t3r/CVE-2016-3088](https://github.com/HeArtE4t3r/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #2

**来源**: [CVE-2016-3088-Ma1Dong_ActiveMQ_putshell-CVE-2016-3088.md](../2016/CVE-2016-3088-Ma1Dong_ActiveMQ_putshell-CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件上传与执行漏洞

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x before 5.14.0

**利用条件:** 目标系统运行存在漏洞版本的Apache ActiveMQ，且fileserver应用启用。 需要能够通过网络访问 ActiveMQ 的 fileserver 接口。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-3088 漏洞允许攻击者通过 HTTP PUT 请求上传任意文件，然后使用 HTTP MOVE 请求将其移动到 Web 目录，从而实现任意代码执行。漏洞利用代码 `ActiveMQ_putshell.py` 的利用方式如下：

1.  **漏洞检测:** 脚本首先尝试使用PUT方法上传一个文件到经过路径穿越处理后的URL `/fileserver/a../../%08/..%08/.%08/%08`，目的是探测 ActiveMQ 的安装路径。如果返回状态码为500，则从响应头中提取 ActiveMQ 的安装路径。
2.  **上传 Webshell:** 脚本随后使用PUT方法上传一个包含JSP webshell代码的文件 `guo.txt` 到 `/fileserver/guo.txt`。
3.  **移动 Webshell:**  脚本使用MOVE方法，将 `guo.txt` 文件移动到 ActiveMQ Web 应用的 admin 目录下，并重命名为 `guo.jsp`。 Destination 头构造了目标路径，利用了 `file://` 协议和之前获取的 ActiveMQ 安装路径。
4.  **访问 Webshell:** 漏洞利用成功后，攻击者可以通过访问 `url/admin/guo.jsp?pwd=gshell&shell=[command]` 来执行任意命令。

**有效性:** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用方式是有效的，已经存在公开的POC。

**投毒风险:**  虽然提供的脚本本身实现了漏洞利用的功能，但仍然存在细微的投毒风险，例如：
*   **后门修改：** 作者可能在webshell代码中植入不易察觉的后门，虽然当前webshell相对简单。

总体而言，风险较低，大约 1%。主要是利用代码本身的功能实现漏洞，投毒的可能性较低。

**利用方式总结:**

1.  发送 PUT 请求上传任意文件到 `/fileserver/` 目录（或其他可写目录）。
2.  发送 MOVE 请求将上传的文件移动到 Web 应用的可执行目录，例如 `admin` 目录。
3.  访问移动后的文件（例如 JSP 文件），执行恶意代码。

该漏洞利用方式简单直接，易于实现，但依赖于目标系统存在漏洞版本且 fileserver 应用启用。

**项目地址:** [Ma1Dong/ActiveMQ_putshell-CVE-2016-3088](https://github.com/Ma1Dong/ActiveMQ_putshell-CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #3

**来源**: [CVE-2016-3088-YutuSec_ActiveMQ_Crack.md](../2016/CVE-2016-3088-YutuSec_ActiveMQ_Crack.md)

## CVE-2016-3088 - Apache ActiveMQ 任意文件上传/写入漏洞

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传/写入

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x < 5.14.0

**利用条件:** 目标服务器运行存在漏洞的Apache ActiveMQ版本，且Fileserver web application未被禁用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache ActiveMQ的Fileserver Web应用中。攻击者可以通过首先发送一个HTTP PUT请求上传任意文件，然后使用HTTP MOVE请求将该文件移动到Web目录，从而实现任意代码执行。  

**利用方式：**  
1.  **PUT请求：**  攻击者构造一个HTTP PUT请求，将恶意文件（例如JSP webshell）上传到`/fileserver/` 目录下，文件名可以是任意的，例如 `123.txt`。
2.  **MOVE请求：**  攻击者构造一个HTTP MOVE请求，将刚上传的文件从`/fileserver/123.txt` 移动到Web应用可访问的目录，例如`/webapps/api/s.jsp`。`Destination`头指定了目标路径。
3.  **访问恶意文件：**  攻击者通过Web浏览器访问移动后的文件（例如`http://target/api/s.jsp`），服务器会解析并执行该文件中的恶意代码。

**POC有效性：**  
根据漏洞信息和提供的利用代码，可以判断该POC代码是有效的。代码首先检查ActiveMQ的默认口令是否存在，若存在，则尝试利用PUT和MOVE方法上传并移动jsp文件到web目录，并进行访问，判断是否存在漏洞。

**投毒风险评估：**  
经过分析，此仓库中的代码主要功能是检测和利用CVE-2016-3088漏洞，没有发现明显的恶意代码或后门。`DataHandle/Check.go`中存在对`activemq.home` 和 `user.dir` 系统属性的判断，以确定ActiveMQ的安装路径，这是漏洞利用的一部分，不是投毒。因此，投毒风险评估为0%。

**项目地址:** [YutuSec/ActiveMQ_Crack](https://github.com/YutuSec/ActiveMQ_Crack)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #4

**来源**: [CVE-2016-3088-cl4ym0re_CVE-2016-3088.md](../2016/CVE-2016-3088-cl4ym0re_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ Fileserver 任意文件上传/RCE

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要目标ActiveMQ的Fileserver应用启用且未配置安全限制，需要知道管理账号密码，默认账号密码为admin/admin

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-3088 存在于 Apache ActiveMQ 的 Fileserver Web 应用中。攻击者可以通过先使用 HTTP PUT 请求上传任意文件，然后使用 HTTP MOVE 请求将文件移动到 Web 目录，从而实现任意代码执行。

**有效性分析：**
提供的POC代码`CVE-2016-3088.py`利用了该漏洞。代码首先检查 fileserver 是否启用，然后尝试使用默认凭据 `admin:admin` 登录。如果成功，它会尝试获取 `activemq.home` 属性以确定 ActiveMQ 的安装路径。然后，它会上传一个包含恶意代码的 jsp 文件，并使用 MOVE 请求将其移动到 `webapps/api` 目录下。如果成功，攻击者就可以通过访问 `host/api/evil.jsp?pwd=9527&i=whoami` 来执行任意命令。

**投毒风险分析：**
POC代码中，主要风险在于以下几点：

*   **webshell内容：** POC 提供了 webshell 的内容，但用户可以自行修改，所以 webshell 本身不是投毒点。但恶意用户可能会替换成具有恶意功能的 webshell。
*   **利用流程：**  整个利用流程相对清晰，虽然存在修改 webshell 的可能，但不会引入额外的恶意代码。程序目的是getshell，实现逻辑较为完善，暂未发现明显的投毒代码。 综合判断，投毒风险较低，但是需要人工审计修改后的webshell。

基于上述分析，该仓库中存在作者隐藏的投毒代码的风险约为 10%。风险主要来源于用户是否使用了作者提供的webshell payload。

**利用方式：**

1.  使用 HTTP PUT 请求上传一个包含恶意代码的 JSP 文件到 Fileserver。文件名可以为任意名称，例如 `noharm.txt`。
2.  使用 HTTP MOVE 请求将上传的文件移动到 ActiveMQ Web 应用的 Web 目录下，例如 `webapps/api/evil.jsp`。`Destination` header 需要设置为目标路径。
3.  通过访问移动后的 JSP 文件，执行其中的恶意代码，从而实现远程代码执行。

该漏洞利用成功的关键在于目标 ActiveMQ 实例的 Fileserver 应用已启用，并且攻击者能够获取到 ActiveMQ 的安装路径。默认的admin/admin弱口令也大大增加了漏洞的利用成功率。升级到 5.14.0 或更高版本是修复此漏洞的建议方法。

**项目地址:** [cl4ym0re/CVE-2016-3088](https://github.com/cl4ym0re/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #5

**来源**: [CVE-2016-3088-cyberaguiar_CVE-2016-3088.md](../2016/CVE-2016-3088-cyberaguiar_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件上传与执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要能够访问ActiveMQ的Fileserver Web应用，通常位于一个特定的端口，且Fileserver功能未被禁用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞CVE-2016-3088存在于Apache ActiveMQ 5.x版本，直至5.14.0之前。该漏洞允许远程攻击者通过HTTP PUT请求上传任意文件，然后使用HTTP MOVE请求将其移动到Web服务器的可执行目录下，从而执行恶意代码。漏洞利用方式主要分两步：首先，攻击者使用PUT方法将包含恶意代码（例如，JSP webshell）的文件上传到服务器上的某个临时位置。然后，攻击者使用MOVE方法将该文件移动到ActiveMQ Web应用的可访问目录，比如`/opt/activemq/webapps/api/`. 一旦文件被移动到可访问的目录，攻击者就可以通过Web浏览器访问该文件，从而执行其中的恶意代码。根据提供的漏洞利用代码，其中只包含GNU AGPL license文本，不包含任何可执行的利用代码。Github上存在公开的exp，所以POC可用。目前分析代码不包含投毒，所以投毒风险评估为0%。

**项目地址:** [cyberaguiar/CVE-2016-3088](https://github.com/cyberaguiar/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #6

**来源**: [CVE-2016-3088-pudiding_CVE-2016-3088.md](../2016/CVE-2016-3088-pudiding_CVE-2016-3088.md)

# CVE-2016-3088

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-3088-HeArtE4t3r_CVE-2016-3088.md](../2016/CVE-2016-3088-HeArtE4t3r_CVE-2016-3088.md)

## CVE-2016-3088-Apache ActiveMQ 文件上传与执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x before 5.14.0

**利用条件:** 目标服务器运行存在漏洞版本的ActiveMQ，且Fileserver web application开启，攻击者可以访问目标ActiveMQ的web管理页面。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-3088 漏洞存在于 Apache ActiveMQ 5.14.0 之前的 5.x 版本中。该漏洞允许远程攻击者通过 HTTP PUT 请求上传任意文件，然后通过 HTTP MOVE 请求将上传的文件移动到 Web 应用的目录下，从而执行任意代码。攻击者首先上传一个 JSP 文件，然后将其移动到 ActiveMQ 的 admin 目录下，最后通过访问该 JSP 文件来执行恶意代码。

**有效性：**

根据漏洞信息和 Exploit-DB 记录 (https://www.exploit-db.com/exploits/42283/)，以及其他搜索结果，该漏洞存在且EXP利用代码可用，提供的POC代码有效。

**投毒风险：**

查看提供的 Python 脚本 CVE-2016-3088.py，代码逻辑较为清晰，主要功能是：

1.  **参数解析：** 解析目标 URL、上传路径、以及是否使用自定义脚本。
2.  **URL 验证：** 验证 URL 的有效性。
3.  **文件上传：** 使用 PUT 请求上传临时文件。
4.  **文件移动：** 使用 MOVE 请求将临时文件移动到指定位置（通常是 webapps/admin 目录下）。
5.  **Payload：** 脚本默认包含一个简单的payload，该payload支持URL传参执行命令。也可选择用户提供的自定义脚本进行base64编码并上传

代码中存在一定风险，风险主要来自用户提供的脚本参数。如果用户上传的脚本本身就是恶意脚本，那么攻击者就可以利用该漏洞执行恶意代码。但脚本本身并没有发现明显的恶意代码，例如反弹shell、下载执行其他程序等。

所以，投毒风险较低，但不能完全排除用户自定义脚本引入的风险。判断仓库中作者隐藏投毒代码的可能性为5%。

**利用方式：**

1.  **PUT 请求上传文件：** 攻击者首先向目标 ActiveMQ 服务器的 `/fileserver/` 路径发送一个 HTTP PUT 请求，上传一个包含恶意代码（例如 JSP shell）的文件，文件扩展名可以是任意的，因为后续会重命名。
2.  **MOVE 请求移动文件：** 攻击者然后发送一个 HTTP MOVE 请求，将刚刚上传的文件移动到 ActiveMQ Web 应用的目录下，通常是 `webapps/admin/` 目录。在移动的过程中，将文件名更改为 JSP 文件，例如 `shell.jsp`。
3.  **访问 JSP 文件：** 攻击者最后通过访问 `http://<target>/admin/shell.jsp` 来执行恶意代码。

该漏洞的利用依赖于 ActiveMQ 的 Fileserver web application 开启，并且攻击者具有对该应用目录的写权限。

**项目地址:** [HeArtE4t3r/CVE-2016-3088](https://github.com/HeArtE4t3r/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #2

**来源**: [CVE-2016-3088-Ma1Dong_ActiveMQ_putshell-CVE-2016-3088.md](../2016/CVE-2016-3088-Ma1Dong_ActiveMQ_putshell-CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件上传与执行漏洞

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x before 5.14.0

**利用条件:** 目标系统运行存在漏洞版本的Apache ActiveMQ，且fileserver应用启用。 需要能够通过网络访问 ActiveMQ 的 fileserver 接口。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-3088 漏洞允许攻击者通过 HTTP PUT 请求上传任意文件，然后使用 HTTP MOVE 请求将其移动到 Web 目录，从而实现任意代码执行。漏洞利用代码 `ActiveMQ_putshell.py` 的利用方式如下：

1.  **漏洞检测:** 脚本首先尝试使用PUT方法上传一个文件到经过路径穿越处理后的URL `/fileserver/a../../%08/..%08/.%08/%08`，目的是探测 ActiveMQ 的安装路径。如果返回状态码为500，则从响应头中提取 ActiveMQ 的安装路径。
2.  **上传 Webshell:** 脚本随后使用PUT方法上传一个包含JSP webshell代码的文件 `guo.txt` 到 `/fileserver/guo.txt`。
3.  **移动 Webshell:**  脚本使用MOVE方法，将 `guo.txt` 文件移动到 ActiveMQ Web 应用的 admin 目录下，并重命名为 `guo.jsp`。 Destination 头构造了目标路径，利用了 `file://` 协议和之前获取的 ActiveMQ 安装路径。
4.  **访问 Webshell:** 漏洞利用成功后，攻击者可以通过访问 `url/admin/guo.jsp?pwd=gshell&shell=[command]` 来执行任意命令。

**有效性:** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用方式是有效的，已经存在公开的POC。

**投毒风险:**  虽然提供的脚本本身实现了漏洞利用的功能，但仍然存在细微的投毒风险，例如：
*   **后门修改：** 作者可能在webshell代码中植入不易察觉的后门，虽然当前webshell相对简单。

总体而言，风险较低，大约 1%。主要是利用代码本身的功能实现漏洞，投毒的可能性较低。

**利用方式总结:**

1.  发送 PUT 请求上传任意文件到 `/fileserver/` 目录（或其他可写目录）。
2.  发送 MOVE 请求将上传的文件移动到 Web 应用的可执行目录，例如 `admin` 目录。
3.  访问移动后的文件（例如 JSP 文件），执行恶意代码。

该漏洞利用方式简单直接，易于实现，但依赖于目标系统存在漏洞版本且 fileserver 应用启用。

**项目地址:** [Ma1Dong/ActiveMQ_putshell-CVE-2016-3088](https://github.com/Ma1Dong/ActiveMQ_putshell-CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #3

**来源**: [CVE-2016-3088-YutuSec_ActiveMQ_Crack.md](../2016/CVE-2016-3088-YutuSec_ActiveMQ_Crack.md)

## CVE-2016-3088 - Apache ActiveMQ 任意文件上传/写入漏洞

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传/写入

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x < 5.14.0

**利用条件:** 目标服务器运行存在漏洞的Apache ActiveMQ版本，且Fileserver web application未被禁用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache ActiveMQ的Fileserver Web应用中。攻击者可以通过首先发送一个HTTP PUT请求上传任意文件，然后使用HTTP MOVE请求将该文件移动到Web目录，从而实现任意代码执行。  

**利用方式：**  
1.  **PUT请求：**  攻击者构造一个HTTP PUT请求，将恶意文件（例如JSP webshell）上传到`/fileserver/` 目录下，文件名可以是任意的，例如 `123.txt`。
2.  **MOVE请求：**  攻击者构造一个HTTP MOVE请求，将刚上传的文件从`/fileserver/123.txt` 移动到Web应用可访问的目录，例如`/webapps/api/s.jsp`。`Destination`头指定了目标路径。
3.  **访问恶意文件：**  攻击者通过Web浏览器访问移动后的文件（例如`http://target/api/s.jsp`），服务器会解析并执行该文件中的恶意代码。

**POC有效性：**  
根据漏洞信息和提供的利用代码，可以判断该POC代码是有效的。代码首先检查ActiveMQ的默认口令是否存在，若存在，则尝试利用PUT和MOVE方法上传并移动jsp文件到web目录，并进行访问，判断是否存在漏洞。

**投毒风险评估：**  
经过分析，此仓库中的代码主要功能是检测和利用CVE-2016-3088漏洞，没有发现明显的恶意代码或后门。`DataHandle/Check.go`中存在对`activemq.home` 和 `user.dir` 系统属性的判断，以确定ActiveMQ的安装路径，这是漏洞利用的一部分，不是投毒。因此，投毒风险评估为0%。

**项目地址:** [YutuSec/ActiveMQ_Crack](https://github.com/YutuSec/ActiveMQ_Crack)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #4

**来源**: [CVE-2016-3088-cl4ym0re_CVE-2016-3088.md](../2016/CVE-2016-3088-cl4ym0re_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ Fileserver 任意文件上传/RCE

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要目标ActiveMQ的Fileserver应用启用且未配置安全限制，需要知道管理账号密码，默认账号密码为admin/admin

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-3088 存在于 Apache ActiveMQ 的 Fileserver Web 应用中。攻击者可以通过先使用 HTTP PUT 请求上传任意文件，然后使用 HTTP MOVE 请求将文件移动到 Web 目录，从而实现任意代码执行。

**有效性分析：**
提供的POC代码`CVE-2016-3088.py`利用了该漏洞。代码首先检查 fileserver 是否启用，然后尝试使用默认凭据 `admin:admin` 登录。如果成功，它会尝试获取 `activemq.home` 属性以确定 ActiveMQ 的安装路径。然后，它会上传一个包含恶意代码的 jsp 文件，并使用 MOVE 请求将其移动到 `webapps/api` 目录下。如果成功，攻击者就可以通过访问 `host/api/evil.jsp?pwd=9527&i=whoami` 来执行任意命令。

**投毒风险分析：**
POC代码中，主要风险在于以下几点：

*   **webshell内容：** POC 提供了 webshell 的内容，但用户可以自行修改，所以 webshell 本身不是投毒点。但恶意用户可能会替换成具有恶意功能的 webshell。
*   **利用流程：**  整个利用流程相对清晰，虽然存在修改 webshell 的可能，但不会引入额外的恶意代码。程序目的是getshell，实现逻辑较为完善，暂未发现明显的投毒代码。 综合判断，投毒风险较低，但是需要人工审计修改后的webshell。

基于上述分析，该仓库中存在作者隐藏的投毒代码的风险约为 10%。风险主要来源于用户是否使用了作者提供的webshell payload。

**利用方式：**

1.  使用 HTTP PUT 请求上传一个包含恶意代码的 JSP 文件到 Fileserver。文件名可以为任意名称，例如 `noharm.txt`。
2.  使用 HTTP MOVE 请求将上传的文件移动到 ActiveMQ Web 应用的 Web 目录下，例如 `webapps/api/evil.jsp`。`Destination` header 需要设置为目标路径。
3.  通过访问移动后的 JSP 文件，执行其中的恶意代码，从而实现远程代码执行。

该漏洞利用成功的关键在于目标 ActiveMQ 实例的 Fileserver 应用已启用，并且攻击者能够获取到 ActiveMQ 的安装路径。默认的admin/admin弱口令也大大增加了漏洞的利用成功率。升级到 5.14.0 或更高版本是修复此漏洞的建议方法。

**项目地址:** [cl4ym0re/CVE-2016-3088](https://github.com/cl4ym0re/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #5

**来源**: [CVE-2016-3088-cyberaguiar_CVE-2016-3088.md](../2016/CVE-2016-3088-cyberaguiar_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件上传与执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 文件上传与执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要能够访问ActiveMQ的Fileserver Web应用，通常位于一个特定的端口，且Fileserver功能未被禁用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞CVE-2016-3088存在于Apache ActiveMQ 5.x版本，直至5.14.0之前。该漏洞允许远程攻击者通过HTTP PUT请求上传任意文件，然后使用HTTP MOVE请求将其移动到Web服务器的可执行目录下，从而执行恶意代码。漏洞利用方式主要分两步：首先，攻击者使用PUT方法将包含恶意代码（例如，JSP webshell）的文件上传到服务器上的某个临时位置。然后，攻击者使用MOVE方法将该文件移动到ActiveMQ Web应用的可访问目录，比如`/opt/activemq/webapps/api/`. 一旦文件被移动到可访问的目录，攻击者就可以通过Web浏览器访问该文件，从而执行其中的恶意代码。根据提供的漏洞利用代码，其中只包含GNU AGPL license文本，不包含任何可执行的利用代码。Github上存在公开的exp，所以POC可用。目前分析代码不包含投毒，所以投毒风险评估为0%。

**项目地址:** [cyberaguiar/CVE-2016-3088](https://github.com/cyberaguiar/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

## POC #6

**来源**: [CVE-2016-3088-vonderchild_CVE-2016-3088.md](../2016/CVE-2016-3088-vonderchild_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件服务器任意文件上传和执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传和执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要目标系统运行存在漏洞版本的Apache ActiveMQ，且Fileserver web application可用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Apache ActiveMQ 的 Fileserver web application 中。攻击者可以通过发送 HTTP PUT 请求上传恶意文件 (例如 JSP shell)，然后使用 HTTP MOVE 请求将其移动到 Web 容器的可执行目录 (例如 admin 目录)。攻击需要身份验证，但是代码执行结果是root权限，无需授权。漏洞利用有效性高，利用代码清晰，未发现恶意投毒代码。攻击者可以利用该漏洞在服务器上执行任意代码，控制服务器。

**利用方式：**

1.  **上传恶意文件：** 使用 HTTP PUT 请求，将包含恶意代码的文件（例如 JSP shell）上传到 fileserver 目录。利用的路径是`fileserver/%80/%80`,  这里利用了目录穿越。
2.  **移动恶意文件：** 使用 HTTP MOVE 请求，将上传的恶意文件移动到 Web 容器的可执行目录下（例如 admin 目录）。将文件移动到`/admin/shell.jsp`。
3.  **远程代码执行：** 访问移动后的恶意文件（例如 `admin/shell.jsp`），即可执行服务器上的任意代码。

**POC 分析：**

POC 代码首先尝试使用 PUT 方法将文件上传到 ActiveMQ 服务器的 fileserver 目录。 然后,它使用 MOVE 方法将上传的文件移动到服务器上的 admin 目录。最后，它打印出上传的 shell 的 URL。该 URL 可用于执行任意命令。

**威胁评估:**

由于此漏洞允许未经身份验证的远程代码执行，因此威胁级别很高。 攻击者可以使用此漏洞来完全控制受影响的系统。

**项目地址:** [vonderchild/CVE-2016-3088](https://github.com/vonderchild/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---



---

## POC #7

**来源**: [CVE-2016-3088-vonderchild_CVE-2016-3088.md](../2016/CVE-2016-3088-vonderchild_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件服务器任意文件上传和执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传和执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要目标系统运行存在漏洞版本的Apache ActiveMQ，且Fileserver web application可用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Apache ActiveMQ 的 Fileserver web application 中。攻击者可以通过发送 HTTP PUT 请求上传恶意文件 (例如 JSP shell)，然后使用 HTTP MOVE 请求将其移动到 Web 容器的可执行目录 (例如 admin 目录)。攻击需要身份验证，但是代码执行结果是root权限，无需授权。漏洞利用有效性高，利用代码清晰，未发现恶意投毒代码。攻击者可以利用该漏洞在服务器上执行任意代码，控制服务器。

**利用方式：**

1.  **上传恶意文件：** 使用 HTTP PUT 请求，将包含恶意代码的文件（例如 JSP shell）上传到 fileserver 目录。利用的路径是`fileserver/%80/%80`,  这里利用了目录穿越。
2.  **移动恶意文件：** 使用 HTTP MOVE 请求，将上传的恶意文件移动到 Web 容器的可执行目录下（例如 admin 目录）。将文件移动到`/admin/shell.jsp`。
3.  **远程代码执行：** 访问移动后的恶意文件（例如 `admin/shell.jsp`），即可执行服务器上的任意代码。

**POC 分析：**

POC 代码首先尝试使用 PUT 方法将文件上传到 ActiveMQ 服务器的 fileserver 目录。 然后,它使用 MOVE 方法将上传的文件移动到服务器上的 admin 目录。最后，它打印出上传的 shell 的 URL。该 URL 可用于执行任意命令。

**威胁评估:**

由于此漏洞允许未经身份验证的远程代码执行，因此威胁级别很高。 攻击者可以使用此漏洞来完全控制受影响的系统。

**项目地址:** [vonderchild/CVE-2016-3088](https://github.com/vonderchild/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---



---

## POC #7

**来源**: [CVE-2016-3088-vonderchild_CVE-2016-3088.md](../2016/CVE-2016-3088-vonderchild_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件服务器任意文件上传和执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传和执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要目标系统运行存在漏洞版本的Apache ActiveMQ，且Fileserver web application可用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Apache ActiveMQ 的 Fileserver web application 中。攻击者可以通过发送 HTTP PUT 请求上传恶意文件 (例如 JSP shell)，然后使用 HTTP MOVE 请求将其移动到 Web 容器的可执行目录 (例如 admin 目录)。攻击需要身份验证，但是代码执行结果是root权限，无需授权。漏洞利用有效性高，利用代码清晰，未发现恶意投毒代码。攻击者可以利用该漏洞在服务器上执行任意代码，控制服务器。

**利用方式：**

1.  **上传恶意文件：** 使用 HTTP PUT 请求，将包含恶意代码的文件（例如 JSP shell）上传到 fileserver 目录。利用的路径是`fileserver/%80/%80`,  这里利用了目录穿越。
2.  **移动恶意文件：** 使用 HTTP MOVE 请求，将上传的恶意文件移动到 Web 容器的可执行目录下（例如 admin 目录）。将文件移动到`/admin/shell.jsp`。
3.  **远程代码执行：** 访问移动后的恶意文件（例如 `admin/shell.jsp`），即可执行服务器上的任意代码。

**POC 分析：**

POC 代码首先尝试使用 PUT 方法将文件上传到 ActiveMQ 服务器的 fileserver 目录。 然后,它使用 MOVE 方法将上传的文件移动到服务器上的 admin 目录。最后，它打印出上传的 shell 的 URL。该 URL 可用于执行任意命令。

**威胁评估:**

由于此漏洞允许未经身份验证的远程代码执行，因此威胁级别很高。 攻击者可以使用此漏洞来完全控制受影响的系统。

**项目地址:** [vonderchild/CVE-2016-3088](https://github.com/vonderchild/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---



---

## POC #7

**来源**: [CVE-2016-3088-vonderchild_CVE-2016-3088.md](../2016/CVE-2016-3088-vonderchild_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件服务器任意文件上传和执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传和执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要目标系统运行存在漏洞版本的Apache ActiveMQ，且Fileserver web application可用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Apache ActiveMQ 的 Fileserver web application 中。攻击者可以通过发送 HTTP PUT 请求上传恶意文件 (例如 JSP shell)，然后使用 HTTP MOVE 请求将其移动到 Web 容器的可执行目录 (例如 admin 目录)。攻击需要身份验证，但是代码执行结果是root权限，无需授权。漏洞利用有效性高，利用代码清晰，未发现恶意投毒代码。攻击者可以利用该漏洞在服务器上执行任意代码，控制服务器。

**利用方式：**

1.  **上传恶意文件：** 使用 HTTP PUT 请求，将包含恶意代码的文件（例如 JSP shell）上传到 fileserver 目录。利用的路径是`fileserver/%80/%80`,  这里利用了目录穿越。
2.  **移动恶意文件：** 使用 HTTP MOVE 请求，将上传的恶意文件移动到 Web 容器的可执行目录下（例如 admin 目录）。将文件移动到`/admin/shell.jsp`。
3.  **远程代码执行：** 访问移动后的恶意文件（例如 `admin/shell.jsp`），即可执行服务器上的任意代码。

**POC 分析：**

POC 代码首先尝试使用 PUT 方法将文件上传到 ActiveMQ 服务器的 fileserver 目录。 然后,它使用 MOVE 方法将上传的文件移动到服务器上的 admin 目录。最后，它打印出上传的 shell 的 URL。该 URL 可用于执行任意命令。

**威胁评估:**

由于此漏洞允许未经身份验证的远程代码执行，因此威胁级别很高。 攻击者可以使用此漏洞来完全控制受影响的系统。

**项目地址:** [vonderchild/CVE-2016-3088](https://github.com/vonderchild/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---



---

## POC #7

**来源**: [CVE-2016-3088-vonderchild_CVE-2016-3088.md](../2016/CVE-2016-3088-vonderchild_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件服务器任意文件上传和执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传和执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要目标系统运行存在漏洞版本的Apache ActiveMQ，且Fileserver web application可用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Apache ActiveMQ 的 Fileserver web application 中。攻击者可以通过发送 HTTP PUT 请求上传恶意文件 (例如 JSP shell)，然后使用 HTTP MOVE 请求将其移动到 Web 容器的可执行目录 (例如 admin 目录)。攻击需要身份验证，但是代码执行结果是root权限，无需授权。漏洞利用有效性高，利用代码清晰，未发现恶意投毒代码。攻击者可以利用该漏洞在服务器上执行任意代码，控制服务器。

**利用方式：**

1.  **上传恶意文件：** 使用 HTTP PUT 请求，将包含恶意代码的文件（例如 JSP shell）上传到 fileserver 目录。利用的路径是`fileserver/%80/%80`,  这里利用了目录穿越。
2.  **移动恶意文件：** 使用 HTTP MOVE 请求，将上传的恶意文件移动到 Web 容器的可执行目录下（例如 admin 目录）。将文件移动到`/admin/shell.jsp`。
3.  **远程代码执行：** 访问移动后的恶意文件（例如 `admin/shell.jsp`），即可执行服务器上的任意代码。

**POC 分析：**

POC 代码首先尝试使用 PUT 方法将文件上传到 ActiveMQ 服务器的 fileserver 目录。 然后,它使用 MOVE 方法将上传的文件移动到服务器上的 admin 目录。最后，它打印出上传的 shell 的 URL。该 URL 可用于执行任意命令。

**威胁评估:**

由于此漏洞允许未经身份验证的远程代码执行，因此威胁级别很高。 攻击者可以使用此漏洞来完全控制受影响的系统。

**项目地址:** [vonderchild/CVE-2016-3088](https://github.com/vonderchild/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---



---

## POC #7

**来源**: [CVE-2016-3088-vonderchild_CVE-2016-3088.md](../2016/CVE-2016-3088-vonderchild_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件服务器任意文件上传和执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传和执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要目标系统运行存在漏洞版本的Apache ActiveMQ，且Fileserver web application可用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Apache ActiveMQ 的 Fileserver web application 中。攻击者可以通过发送 HTTP PUT 请求上传恶意文件 (例如 JSP shell)，然后使用 HTTP MOVE 请求将其移动到 Web 容器的可执行目录 (例如 admin 目录)。攻击需要身份验证，但是代码执行结果是root权限，无需授权。漏洞利用有效性高，利用代码清晰，未发现恶意投毒代码。攻击者可以利用该漏洞在服务器上执行任意代码，控制服务器。

**利用方式：**

1.  **上传恶意文件：** 使用 HTTP PUT 请求，将包含恶意代码的文件（例如 JSP shell）上传到 fileserver 目录。利用的路径是`fileserver/%80/%80`,  这里利用了目录穿越。
2.  **移动恶意文件：** 使用 HTTP MOVE 请求，将上传的恶意文件移动到 Web 容器的可执行目录下（例如 admin 目录）。将文件移动到`/admin/shell.jsp`。
3.  **远程代码执行：** 访问移动后的恶意文件（例如 `admin/shell.jsp`），即可执行服务器上的任意代码。

**POC 分析：**

POC 代码首先尝试使用 PUT 方法将文件上传到 ActiveMQ 服务器的 fileserver 目录。 然后,它使用 MOVE 方法将上传的文件移动到服务器上的 admin 目录。最后，它打印出上传的 shell 的 URL。该 URL 可用于执行任意命令。

**威胁评估:**

由于此漏洞允许未经身份验证的远程代码执行，因此威胁级别很高。 攻击者可以使用此漏洞来完全控制受影响的系统。

**项目地址:** [vonderchild/CVE-2016-3088](https://github.com/vonderchild/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---



---

## POC #7

**来源**: [CVE-2016-3088-vonderchild_CVE-2016-3088.md](../2016/CVE-2016-3088-vonderchild_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件服务器任意文件上传和执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传和执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要目标系统运行存在漏洞版本的Apache ActiveMQ，且Fileserver web application可用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Apache ActiveMQ 的 Fileserver web application 中。攻击者可以通过发送 HTTP PUT 请求上传恶意文件 (例如 JSP shell)，然后使用 HTTP MOVE 请求将其移动到 Web 容器的可执行目录 (例如 admin 目录)。攻击需要身份验证，但是代码执行结果是root权限，无需授权。漏洞利用有效性高，利用代码清晰，未发现恶意投毒代码。攻击者可以利用该漏洞在服务器上执行任意代码，控制服务器。

**利用方式：**

1.  **上传恶意文件：** 使用 HTTP PUT 请求，将包含恶意代码的文件（例如 JSP shell）上传到 fileserver 目录。利用的路径是`fileserver/%80/%80`,  这里利用了目录穿越。
2.  **移动恶意文件：** 使用 HTTP MOVE 请求，将上传的恶意文件移动到 Web 容器的可执行目录下（例如 admin 目录）。将文件移动到`/admin/shell.jsp`。
3.  **远程代码执行：** 访问移动后的恶意文件（例如 `admin/shell.jsp`），即可执行服务器上的任意代码。

**POC 分析：**

POC 代码首先尝试使用 PUT 方法将文件上传到 ActiveMQ 服务器的 fileserver 目录。 然后,它使用 MOVE 方法将上传的文件移动到服务器上的 admin 目录。最后，它打印出上传的 shell 的 URL。该 URL 可用于执行任意命令。

**威胁评估:**

由于此漏洞允许未经身份验证的远程代码执行，因此威胁级别很高。 攻击者可以使用此漏洞来完全控制受影响的系统。

**项目地址:** [vonderchild/CVE-2016-3088](https://github.com/vonderchild/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---



---

## POC #7

**来源**: [CVE-2016-3088-vonderchild_CVE-2016-3088.md](../2016/CVE-2016-3088-vonderchild_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件服务器任意文件上传和执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传和执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要目标系统运行存在漏洞版本的Apache ActiveMQ，且Fileserver web application可用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Apache ActiveMQ 的 Fileserver web application 中。攻击者可以通过发送 HTTP PUT 请求上传恶意文件 (例如 JSP shell)，然后使用 HTTP MOVE 请求将其移动到 Web 容器的可执行目录 (例如 admin 目录)。攻击需要身份验证，但是代码执行结果是root权限，无需授权。漏洞利用有效性高，利用代码清晰，未发现恶意投毒代码。攻击者可以利用该漏洞在服务器上执行任意代码，控制服务器。

**利用方式：**

1.  **上传恶意文件：** 使用 HTTP PUT 请求，将包含恶意代码的文件（例如 JSP shell）上传到 fileserver 目录。利用的路径是`fileserver/%80/%80`,  这里利用了目录穿越。
2.  **移动恶意文件：** 使用 HTTP MOVE 请求，将上传的恶意文件移动到 Web 容器的可执行目录下（例如 admin 目录）。将文件移动到`/admin/shell.jsp`。
3.  **远程代码执行：** 访问移动后的恶意文件（例如 `admin/shell.jsp`），即可执行服务器上的任意代码。

**POC 分析：**

POC 代码首先尝试使用 PUT 方法将文件上传到 ActiveMQ 服务器的 fileserver 目录。 然后,它使用 MOVE 方法将上传的文件移动到服务器上的 admin 目录。最后，它打印出上传的 shell 的 URL。该 URL 可用于执行任意命令。

**威胁评估:**

由于此漏洞允许未经身份验证的远程代码执行，因此威胁级别很高。 攻击者可以使用此漏洞来完全控制受影响的系统。

**项目地址:** [vonderchild/CVE-2016-3088](https://github.com/vonderchild/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---



---

## POC #7

**来源**: [CVE-2016-3088-vonderchild_CVE-2016-3088.md](../2016/CVE-2016-3088-vonderchild_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件服务器任意文件上传和执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传和执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要目标系统运行存在漏洞版本的Apache ActiveMQ，且Fileserver web application可用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Apache ActiveMQ 的 Fileserver web application 中。攻击者可以通过发送 HTTP PUT 请求上传恶意文件 (例如 JSP shell)，然后使用 HTTP MOVE 请求将其移动到 Web 容器的可执行目录 (例如 admin 目录)。攻击需要身份验证，但是代码执行结果是root权限，无需授权。漏洞利用有效性高，利用代码清晰，未发现恶意投毒代码。攻击者可以利用该漏洞在服务器上执行任意代码，控制服务器。

**利用方式：**

1.  **上传恶意文件：** 使用 HTTP PUT 请求，将包含恶意代码的文件（例如 JSP shell）上传到 fileserver 目录。利用的路径是`fileserver/%80/%80`,  这里利用了目录穿越。
2.  **移动恶意文件：** 使用 HTTP MOVE 请求，将上传的恶意文件移动到 Web 容器的可执行目录下（例如 admin 目录）。将文件移动到`/admin/shell.jsp`。
3.  **远程代码执行：** 访问移动后的恶意文件（例如 `admin/shell.jsp`），即可执行服务器上的任意代码。

**POC 分析：**

POC 代码首先尝试使用 PUT 方法将文件上传到 ActiveMQ 服务器的 fileserver 目录。 然后,它使用 MOVE 方法将上传的文件移动到服务器上的 admin 目录。最后，它打印出上传的 shell 的 URL。该 URL 可用于执行任意命令。

**威胁评估:**

由于此漏洞允许未经身份验证的远程代码执行，因此威胁级别很高。 攻击者可以使用此漏洞来完全控制受影响的系统。

**项目地址:** [vonderchild/CVE-2016-3088](https://github.com/vonderchild/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---



---

## POC #7

**来源**: [CVE-2016-3088-vonderchild_CVE-2016-3088.md](../2016/CVE-2016-3088-vonderchild_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件服务器任意文件上传和执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传和执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要目标系统运行存在漏洞版本的Apache ActiveMQ，且Fileserver web application可用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Apache ActiveMQ 的 Fileserver web application 中。攻击者可以通过发送 HTTP PUT 请求上传恶意文件 (例如 JSP shell)，然后使用 HTTP MOVE 请求将其移动到 Web 容器的可执行目录 (例如 admin 目录)。攻击需要身份验证，但是代码执行结果是root权限，无需授权。漏洞利用有效性高，利用代码清晰，未发现恶意投毒代码。攻击者可以利用该漏洞在服务器上执行任意代码，控制服务器。

**利用方式：**

1.  **上传恶意文件：** 使用 HTTP PUT 请求，将包含恶意代码的文件（例如 JSP shell）上传到 fileserver 目录。利用的路径是`fileserver/%80/%80`,  这里利用了目录穿越。
2.  **移动恶意文件：** 使用 HTTP MOVE 请求，将上传的恶意文件移动到 Web 容器的可执行目录下（例如 admin 目录）。将文件移动到`/admin/shell.jsp`。
3.  **远程代码执行：** 访问移动后的恶意文件（例如 `admin/shell.jsp`），即可执行服务器上的任意代码。

**POC 分析：**

POC 代码首先尝试使用 PUT 方法将文件上传到 ActiveMQ 服务器的 fileserver 目录。 然后,它使用 MOVE 方法将上传的文件移动到服务器上的 admin 目录。最后，它打印出上传的 shell 的 URL。该 URL 可用于执行任意命令。

**威胁评估:**

由于此漏洞允许未经身份验证的远程代码执行，因此威胁级别很高。 攻击者可以使用此漏洞来完全控制受影响的系统。

**项目地址:** [vonderchild/CVE-2016-3088](https://github.com/vonderchild/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---



---

## POC #7

**来源**: [CVE-2016-3088-vonderchild_CVE-2016-3088.md](../2016/CVE-2016-3088-vonderchild_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件服务器任意文件上传和执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传和执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要目标系统运行存在漏洞版本的Apache ActiveMQ，且Fileserver web application可用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Apache ActiveMQ 的 Fileserver web application 中。攻击者可以通过发送 HTTP PUT 请求上传恶意文件 (例如 JSP shell)，然后使用 HTTP MOVE 请求将其移动到 Web 容器的可执行目录 (例如 admin 目录)。攻击需要身份验证，但是代码执行结果是root权限，无需授权。漏洞利用有效性高，利用代码清晰，未发现恶意投毒代码。攻击者可以利用该漏洞在服务器上执行任意代码，控制服务器。

**利用方式：**

1.  **上传恶意文件：** 使用 HTTP PUT 请求，将包含恶意代码的文件（例如 JSP shell）上传到 fileserver 目录。利用的路径是`fileserver/%80/%80`,  这里利用了目录穿越。
2.  **移动恶意文件：** 使用 HTTP MOVE 请求，将上传的恶意文件移动到 Web 容器的可执行目录下（例如 admin 目录）。将文件移动到`/admin/shell.jsp`。
3.  **远程代码执行：** 访问移动后的恶意文件（例如 `admin/shell.jsp`），即可执行服务器上的任意代码。

**POC 分析：**

POC 代码首先尝试使用 PUT 方法将文件上传到 ActiveMQ 服务器的 fileserver 目录。 然后,它使用 MOVE 方法将上传的文件移动到服务器上的 admin 目录。最后，它打印出上传的 shell 的 URL。该 URL 可用于执行任意命令。

**威胁评估:**

由于此漏洞允许未经身份验证的远程代码执行，因此威胁级别很高。 攻击者可以使用此漏洞来完全控制受影响的系统。

**项目地址:** [vonderchild/CVE-2016-3088](https://github.com/vonderchild/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---



---

## POC #7

**来源**: [CVE-2016-3088-vonderchild_CVE-2016-3088.md](../2016/CVE-2016-3088-vonderchild_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件服务器任意文件上传和执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传和执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要目标系统运行存在漏洞版本的Apache ActiveMQ，且Fileserver web application可用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Apache ActiveMQ 的 Fileserver web application 中。攻击者可以通过发送 HTTP PUT 请求上传恶意文件 (例如 JSP shell)，然后使用 HTTP MOVE 请求将其移动到 Web 容器的可执行目录 (例如 admin 目录)。攻击需要身份验证，但是代码执行结果是root权限，无需授权。漏洞利用有效性高，利用代码清晰，未发现恶意投毒代码。攻击者可以利用该漏洞在服务器上执行任意代码，控制服务器。

**利用方式：**

1.  **上传恶意文件：** 使用 HTTP PUT 请求，将包含恶意代码的文件（例如 JSP shell）上传到 fileserver 目录。利用的路径是`fileserver/%80/%80`,  这里利用了目录穿越。
2.  **移动恶意文件：** 使用 HTTP MOVE 请求，将上传的恶意文件移动到 Web 容器的可执行目录下（例如 admin 目录）。将文件移动到`/admin/shell.jsp`。
3.  **远程代码执行：** 访问移动后的恶意文件（例如 `admin/shell.jsp`），即可执行服务器上的任意代码。

**POC 分析：**

POC 代码首先尝试使用 PUT 方法将文件上传到 ActiveMQ 服务器的 fileserver 目录。 然后,它使用 MOVE 方法将上传的文件移动到服务器上的 admin 目录。最后，它打印出上传的 shell 的 URL。该 URL 可用于执行任意命令。

**威胁评估:**

由于此漏洞允许未经身份验证的远程代码执行，因此威胁级别很高。 攻击者可以使用此漏洞来完全控制受影响的系统。

**项目地址:** [vonderchild/CVE-2016-3088](https://github.com/vonderchild/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---



---

## POC #7

**来源**: [CVE-2016-3088-vonderchild_CVE-2016-3088.md](../2016/CVE-2016-3088-vonderchild_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件服务器任意文件上传和执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传和执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要目标系统运行存在漏洞版本的Apache ActiveMQ，且Fileserver web application可用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Apache ActiveMQ 的 Fileserver web application 中。攻击者可以通过发送 HTTP PUT 请求上传恶意文件 (例如 JSP shell)，然后使用 HTTP MOVE 请求将其移动到 Web 容器的可执行目录 (例如 admin 目录)。攻击需要身份验证，但是代码执行结果是root权限，无需授权。漏洞利用有效性高，利用代码清晰，未发现恶意投毒代码。攻击者可以利用该漏洞在服务器上执行任意代码，控制服务器。

**利用方式：**

1.  **上传恶意文件：** 使用 HTTP PUT 请求，将包含恶意代码的文件（例如 JSP shell）上传到 fileserver 目录。利用的路径是`fileserver/%80/%80`,  这里利用了目录穿越。
2.  **移动恶意文件：** 使用 HTTP MOVE 请求，将上传的恶意文件移动到 Web 容器的可执行目录下（例如 admin 目录）。将文件移动到`/admin/shell.jsp`。
3.  **远程代码执行：** 访问移动后的恶意文件（例如 `admin/shell.jsp`），即可执行服务器上的任意代码。

**POC 分析：**

POC 代码首先尝试使用 PUT 方法将文件上传到 ActiveMQ 服务器的 fileserver 目录。 然后,它使用 MOVE 方法将上传的文件移动到服务器上的 admin 目录。最后，它打印出上传的 shell 的 URL。该 URL 可用于执行任意命令。

**威胁评估:**

由于此漏洞允许未经身份验证的远程代码执行，因此威胁级别很高。 攻击者可以使用此漏洞来完全控制受影响的系统。

**项目地址:** [vonderchild/CVE-2016-3088](https://github.com/vonderchild/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---



---

## POC #7

**来源**: [CVE-2016-3088-vonderchild_CVE-2016-3088.md](../2016/CVE-2016-3088-vonderchild_CVE-2016-3088.md)

## CVE-2016-3088 - Apache ActiveMQ 文件服务器任意文件上传和执行

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传和执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.x before 5.14.0

**利用条件:** 需要目标系统运行存在漏洞版本的Apache ActiveMQ，且Fileserver web application可用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Apache ActiveMQ 的 Fileserver web application 中。攻击者可以通过发送 HTTP PUT 请求上传恶意文件 (例如 JSP shell)，然后使用 HTTP MOVE 请求将其移动到 Web 容器的可执行目录 (例如 admin 目录)。攻击需要身份验证，但是代码执行结果是root权限，无需授权。漏洞利用有效性高，利用代码清晰，未发现恶意投毒代码。攻击者可以利用该漏洞在服务器上执行任意代码，控制服务器。

**利用方式：**

1.  **上传恶意文件：** 使用 HTTP PUT 请求，将包含恶意代码的文件（例如 JSP shell）上传到 fileserver 目录。利用的路径是`fileserver/%80/%80`,  这里利用了目录穿越。
2.  **移动恶意文件：** 使用 HTTP MOVE 请求，将上传的恶意文件移动到 Web 容器的可执行目录下（例如 admin 目录）。将文件移动到`/admin/shell.jsp`。
3.  **远程代码执行：** 访问移动后的恶意文件（例如 `admin/shell.jsp`），即可执行服务器上的任意代码。

**POC 分析：**

POC 代码首先尝试使用 PUT 方法将文件上传到 ActiveMQ 服务器的 fileserver 目录。 然后,它使用 MOVE 方法将上传的文件移动到服务器上的 admin 目录。最后，它打印出上传的 shell 的 URL。该 URL 可用于执行任意命令。

**威胁评估:**

由于此漏洞允许未经身份验证的远程代码执行，因此威胁级别很高。 攻击者可以使用此漏洞来完全控制受影响的系统。

**项目地址:** [vonderchild/CVE-2016-3088](https://github.com/vonderchild/CVE-2016-3088)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)

---

