## CVE-2016-15041 - MainWP Dashboard – The Private WordPress Manager 存储型XSS (Stored XSS) / 权限缺失 (Missing Authorization)

**漏洞编号:** CVE-2016-15041

**漏洞类型:** 存储型XSS (Stored XSS) / 权限缺失 (Missing Authorization)

**影响应用:** MainWP Dashboard – The Private WordPress Manager

**危害等级:** Critical (紧急)

**CVSS评分:** 9.6 (CVSS:3.x/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H)

**影响版本:** <= 3.1.2

**利用条件:** 无需认证，远程网络访问，需要管理员登录后访问受污染的后台页面触发

**POC 可用性:** 10/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：该POC是一个极其完整的测试套件。它不仅提供了漏洞利用的脚本，还通过Docker Compose构建了一个包含WordPress核心及MainWP插件的闭环测试环境。其核心利用逻辑通过`4-test-vulnerability.sh`和Nuclei模板实现。漏洞根本原因在于MainWP Dashboard插件的设置面板允许未经身份验证的访问，且对`mwp_setup_purchase_username`等参数缺乏基本的输入清理和输出转义。攻击者可以远程向数据库中注入恶意脚本（Stored XSS）。当真正的管理员登录并访问仪表盘设置时，脚本会在管理员浏览器上下文中执行。由于MainWP具备管理多个站点的高级权限，这种XSS通常可以进一步通过构造特权请求来实现远程代码执行（RCE），如创建新的管理员账号、修改插件源码或利用WordPress内置的文件编辑器。该POC包含自动化安装、环境校验和清理逻辑，经分析其代码流清晰，完全符合安全研究人员的测试需求。利用步骤：1. 启动Docker环境，部署WordPress 4.x/5.x版本；2. 安装并激活MainWP Dashboard 3.1.2插件；3. 攻击者发送一个构造好的HTTP POST请求至`/wp-admin/admin-ajax.php?action=mwp_setup_finalize`（或直接访问setup页面），在用户名参数中注入`<script>`载荷；4. 载荷被持久化在数据库中；5. 等待管理员登录并查看MainWP设置页面，此时载荷触发。投毒风险分析：该POC项目的投毒风险极低。通过对提供的脚本目录结构分析，所有操作均基于标准的Docker指令、WP-CLI（WordPress命令行工具）和公开的Nuclei扫描引擎。`1-setup-environment.sh`至`7-cleanup.sh`等脚本的功能与其描述完全一致，主要负责容器编排和环境配置。代码中未发现任何混淆（Obfuscation）处理，所有的网络请求均指向本地容器或官方的WordPress更新服务器。没有发现任何尝试外带敏感信息（如`.bash_history`、`.ssh/id_rsa`或浏览器Cookie）的恶意Payload。虽然该POC具备强大的自动化能力，但其目的是为了辅助漏洞复现和防御验证（特别是针对Nuclei规则的调试）。唯一的风险点在于用户需自行下载并放置`mainwp.3.1.2.zip`插件包，用户应确保该三方插件包来源可靠。脚本本身不包含恶意后门，是一款高质量且安全的防御性研究工具。

**项目地址:** [https://github.com/AgileAdaptiveTools/cvelistV5x2](https://www.google.com/search?q=https://github.com/AgileAdaptiveTools/cvelistV5x2)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2016-15041](https://nvd.nist.gov/vuln/detail/CVE-2016-15041)
