## CVE-2016-15042 - node-serialize Deserialization

**漏洞编号:** CVE-2016-15042

**漏洞类型:** Deserialization

**影响应用:** node-serialize

**危害等级:** High

**CVSS评分:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

**影响版本:** < 0.2.1

**利用条件:** Network access, no authentication required.

**POC 可用性:** 8/10

**POC 类型:** Complete exploit

**攻击复杂度:** Low

**投毒风险:** 40%

## 详情

CVE-2016-15042 is a deserialization vulnerability affecting versions of `node-serialize` prior to 0.2.1. This vulnerability allows attackers to execute arbitrary code by crafting malicious payloads that, when deserialized, trigger the execution of dangerous functions. The provided Proof-of-Concept (POC) code demonstrates a vulnerable Node.js application using `node-serialize`. The `index.js` file shows how the application takes user-provided input, deserializes it using `eval(require('node-serialize').unserialize(req.query.data))`, and then returns the result. An attacker can exploit this by providing a serialized string containing JavaScript code that, when executed via `eval`, performs malicious actions such as executing shell commands or reading sensitive files. The Dockerfile sets up a Node.js environment, installs the necessary dependencies, and exposes port 6892, allowing remote attackers to interact with the application. The `Procfile` defines the command to start the application.

The POC's effectiveness hinges on the presence of the vulnerable `node-serialize` library and the use of `eval` to execute the deserialized data. A successful attack involves the following steps: 1. Deploy the application using the provided Dockerfile. 2. Craft a malicious payload using `node-serialize.serialize()` to embed JavaScript code that performs a harmful action, like executing a command or reading a file. 3. Send an HTTP request to the application with the crafted payload in the `data` query parameter. 4. The application deserializes the payload using `node-serialize.unserialize()` and executes it using `eval`, triggering the attacker-controlled code. This gives the attacker complete control over the server, enabling data theft, system compromise, or denial-of-service attacks.

The vulnerability is straightforward to exploit, as it requires no authentication and is easily automated. The attacker can send a simple HTTP request containing the malicious payload. However, the risk of poisoning in the POC code is moderate. While the code doesn't explicitly contain malicious intent, the reliance on `eval` and the potential for remote code execution significantly increase the risk of an attacker injecting malicious code during exploitation. An attacker could, for instance, modify the application's files to include a backdoor or deploy a cryptocurrency miner. The high level of control obtained via this vulnerability allows the attacker to execute arbitrary commands on the server, making it critical to patch or remove the vulnerable component. The `README.md` file contains references to external resources and badges with potentially outdated information.

**项目地址:** https://github.com/Aditya43621/lab-cve-2016-15042

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2016-15042
