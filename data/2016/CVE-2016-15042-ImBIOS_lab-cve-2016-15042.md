# CVE-2016-15042

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2016-15042-Aditya43621_lab-cve-2016-15042.md](../2016/CVE-2016-15042-Aditya43621_lab-cve-2016-15042.md)

## CVE-2016-15042-Frontend File Manager & N-Media Post Front-end Form-Arbitrary File Upload

**æ¼æ´ç¼–å·:** CVE-2016-15042

**æ¼æ´ç±»å‹:** ä»»æ„æ–‡ä»¶ä¸Šä¼ 

**å½±å“åº”ç”¨:** Frontend File Manager, N-Media Post Front-end Form

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 4.0 (Frontend File Manager), <= 1.0 (N-Media Post Front-end Form)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç«™ç‚¹å®‰è£…å—å½±å“çš„æ’ä»¶ï¼Œå¹¶å…è®¸æœªç»èº«ä»½éªŒè¯çš„ç”¨æˆ·è®¿é—®ä¸Šä¼ åŠŸèƒ½

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 80%

## è¯¦æƒ…

CVE-2016-15042 æ˜¯ä¸€ä¸ªå­˜åœ¨äº WordPress æ’ä»¶ Frontend File Manager å’Œ N-Media Post Front-end Form ä¸­çš„ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ã€‚ç”±äºæ’ä»¶ç¼ºä¹å……åˆ†çš„æ–‡ä»¶ç±»å‹éªŒè¯ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ `nm_filemanager_upload_file` å’Œ `nm_postfront_upload_file` AJAX actions ä¸Šä¼ ä»»æ„æ–‡ä»¶åˆ°æœåŠ¡å™¨ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ¼æ´åº“ä¿¡æ¯æ˜¾ç¤ºï¼Œè¯¥æ¼æ´å­˜åœ¨å…¬å¼€çš„åˆ©ç”¨æ–¹æ³•ï¼Œä¸”å½±å“èŒƒå›´æ˜ç¡®ã€‚æä¾›çš„ä»£ç ä»“åº“ä¸­åŒ…å«ä¸€ä¸ª `index.js` æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å»ºç«‹äº†ä¸€ä¸ªç®€å•çš„ REST APIã€‚ è™½ç„¶æä¾›çš„ä»£ç æœ¬èº«æ²¡æœ‰ç›´æ¥åˆ©ç”¨ CVE-2016-15042 æ¼æ´ï¼Œä½†å®ƒçš„å­˜åœ¨è¡¨æ˜å¯ä»¥æ„å»ºä¸€ä¸ªåˆ©ç”¨è¯¥æ¼æ´çš„ Web æœåŠ¡ã€‚æ¼æ´åº“ä¿¡æ¯æ˜¾ç¤ºè¯¥æ¼æ´å·²å­˜åœ¨å…¬å¼€çš„åˆ©ç”¨æ–¹æ³•,æœç´¢å¼•æ“æœªè¿”å›éªŒè¯ä¿¡æ¯,ä½†ç»“åˆæ¼æ´åº“ä¿¡æ¯,æ¨æ–­æ¼æ´åˆ©ç”¨æœ‰æ•ˆ

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“åŒ…å«ä¸€ä¸ªç®€å•çš„ Node.js REST APIã€‚è™½ç„¶å¿«é€Ÿæµè§ˆä»£ç æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†å­˜åœ¨ä»¥ä¸‹é£é™©ï¼š

*   **ä¾èµ–é¡¹é£é™©ï¼š** `package.json` æ–‡ä»¶ä¸­åŒ…å«å¤§é‡ä¾èµ–é¡¹ï¼Œå…¶ä¸­ä¸€äº›ä¾èµ–é¡¹çš„ç‰ˆæœ¬è¾ƒè€ï¼Œå¯èƒ½å­˜åœ¨å·²çŸ¥æ¼æ´ï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™äº›æ¼æ´è¿›è¡ŒæŠ•æ¯’ã€‚
*   **ä»£ç æ··æ·†/éšè—ï¼š** ä»£ç ç»“æ„è¾ƒä¸ºç®€å•ï¼Œæ˜“äºåœ¨ç°æœ‰ä»£ç ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚è®°å½•ç”¨æˆ·è¯·æ±‚ã€çªƒå–æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæ¶æ„æ“ä½œã€‚
*   **ä¾›åº”é“¾æ”»å‡»ï¼š** ä½œè€…ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹åº“å¯èƒ½è¢«æ¶æ„ç¯¡æ”¹ï¼Œå¯¼è‡´å¼•å…¥æ¶æ„ä»£ç ã€‚

å› æ­¤ï¼Œå°½ç®¡ä¹ä¸€çœ‹ä»£ç æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†æ½œåœ¨é£é™©ä»ç„¶å¾ˆé«˜ã€‚è€ƒè™‘åˆ°ä¾èµ–é¡¹çš„å¤æ‚æ€§å’Œä»£ç çš„å¯ä¿®æ”¹æ€§ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º80%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ç«™ç‚¹ï¼š** å¯»æ‰¾å®‰è£…äº†å—å½±å“æ’ä»¶ï¼ˆFrontend File Manager < 4.0 æˆ– N-Media Post Front-end Form <= 1.0ï¼‰çš„ WordPress ç«™ç‚¹ã€‚
2.  **åˆ†æ AJAX actionsï¼š** ä½¿ç”¨å¼€å‘è€…å·¥å…·æˆ–å…¶ä»–ç½‘ç»œæŠ“åŒ…å·¥å…·ï¼Œåˆ†æ `nm_filemanager_upload_file` å’Œ `nm_postfront_upload_file` AJAX actions çš„è¯·æ±‚å‚æ•°å’Œæ–‡ä»¶ä¸Šä¼ æ–¹å¼ã€‚
3.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ„é€ åŒ…å«æ¶æ„æ–‡ä»¶ï¼ˆå¦‚ PHP shellï¼‰çš„ POST è¯·æ±‚ï¼Œç»•è¿‡æ–‡ä»¶ç±»å‹éªŒè¯ã€‚é€šå¸¸å¯ä»¥é€šè¿‡ä¿®æ”¹ Content-Type æˆ–æ–‡ä»¶åæ¥æ¬ºéª—æœåŠ¡å™¨ã€‚
4.  **ä¸Šä¼ å¹¶æ‰§è¡Œæ¶æ„æ–‡ä»¶ï¼š** å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡ç«™ç‚¹ï¼ŒæˆåŠŸä¸Šä¼ æ¶æ„æ–‡ä»¶åï¼Œè®¿é—®è¯¥æ–‡ä»¶ï¼Œæ‰§è¡Œæ¶æ„ä»£ç ï¼Œä»è€Œæ§åˆ¶æœåŠ¡å™¨ã€‚

**é¡¹ç›®åœ°å€:** [Aditya43621/lab-cve-2016-15042](https://github.com/Aditya43621/lab-cve-2016-15042)

**æ¼æ´è¯¦æƒ…:** [CVE-2016-15042](https://nvd.nist.gov/vuln/detail/CVE-2016-15042)

---

## POC #2

**æ¥æº**: [CVE-2016-15042-ImBIOS_lab-cve-2016-15042.md](../2016/CVE-2016-15042-ImBIOS_lab-cve-2016-15042.md)

# CVE-2016-15042

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2016-15042-Aditya43621_lab-cve-2016-15042.md](../2016/CVE-2016-15042-Aditya43621_lab-cve-2016-15042.md)

## CVE-2016-15042-Frontend File Manager & N-Media Post Front-end Form-Arbitrary File Upload

**æ¼æ´ç¼–å·:** CVE-2016-15042

**æ¼æ´ç±»å‹:** ä»»æ„æ–‡ä»¶ä¸Šä¼ 

**å½±å“åº”ç”¨:** Frontend File Manager, N-Media Post Front-end Form

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 4.0 (Frontend File Manager), <= 1.0 (N-Media Post Front-end Form)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç«™ç‚¹å®‰è£…å—å½±å“çš„æ’ä»¶ï¼Œå¹¶å…è®¸æœªç»èº«ä»½éªŒè¯çš„ç”¨æˆ·è®¿é—®ä¸Šä¼ åŠŸèƒ½

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 80%

## è¯¦æƒ…

CVE-2016-15042 æ˜¯ä¸€ä¸ªå­˜åœ¨äº WordPress æ’ä»¶ Frontend File Manager å’Œ N-Media Post Front-end Form ä¸­çš„ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ã€‚ç”±äºæ’ä»¶ç¼ºä¹å……åˆ†çš„æ–‡ä»¶ç±»å‹éªŒè¯ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ `nm_filemanager_upload_file` å’Œ `nm_postfront_upload_file` AJAX actions ä¸Šä¼ ä»»æ„æ–‡ä»¶åˆ°æœåŠ¡å™¨ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ¼æ´åº“ä¿¡æ¯æ˜¾ç¤ºï¼Œè¯¥æ¼æ´å­˜åœ¨å…¬å¼€çš„åˆ©ç”¨æ–¹æ³•ï¼Œä¸”å½±å“èŒƒå›´æ˜ç¡®ã€‚æä¾›çš„ä»£ç ä»“åº“ä¸­åŒ…å«ä¸€ä¸ª `index.js` æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å»ºç«‹äº†ä¸€ä¸ªç®€å•çš„ REST APIã€‚ è™½ç„¶æä¾›çš„ä»£ç æœ¬èº«æ²¡æœ‰ç›´æ¥åˆ©ç”¨ CVE-2016-15042 æ¼æ´ï¼Œä½†å®ƒçš„å­˜åœ¨è¡¨æ˜å¯ä»¥æ„å»ºä¸€ä¸ªåˆ©ç”¨è¯¥æ¼æ´çš„ Web æœåŠ¡ã€‚æ¼æ´åº“ä¿¡æ¯æ˜¾ç¤ºè¯¥æ¼æ´å·²å­˜åœ¨å…¬å¼€çš„åˆ©ç”¨æ–¹æ³•,æœç´¢å¼•æ“æœªè¿”å›éªŒè¯ä¿¡æ¯,ä½†ç»“åˆæ¼æ´åº“ä¿¡æ¯,æ¨æ–­æ¼æ´åˆ©ç”¨æœ‰æ•ˆ

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“åŒ…å«ä¸€ä¸ªç®€å•çš„ Node.js REST APIã€‚è™½ç„¶å¿«é€Ÿæµè§ˆä»£ç æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†å­˜åœ¨ä»¥ä¸‹é£é™©ï¼š

*   **ä¾èµ–é¡¹é£é™©ï¼š** `package.json` æ–‡ä»¶ä¸­åŒ…å«å¤§é‡ä¾èµ–é¡¹ï¼Œå…¶ä¸­ä¸€äº›ä¾èµ–é¡¹çš„ç‰ˆæœ¬è¾ƒè€ï¼Œå¯èƒ½å­˜åœ¨å·²çŸ¥æ¼æ´ï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™äº›æ¼æ´è¿›è¡ŒæŠ•æ¯’ã€‚
*   **ä»£ç æ··æ·†/éšè—ï¼š** ä»£ç ç»“æ„è¾ƒä¸ºç®€å•ï¼Œæ˜“äºåœ¨ç°æœ‰ä»£ç ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚è®°å½•ç”¨æˆ·è¯·æ±‚ã€çªƒå–æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæ¶æ„æ“ä½œã€‚
*   **ä¾›åº”é“¾æ”»å‡»ï¼š** ä½œè€…ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹åº“å¯èƒ½è¢«æ¶æ„ç¯¡æ”¹ï¼Œå¯¼è‡´å¼•å…¥æ¶æ„ä»£ç ã€‚

å› æ­¤ï¼Œå°½ç®¡ä¹ä¸€çœ‹ä»£ç æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†æ½œåœ¨é£é™©ä»ç„¶å¾ˆé«˜ã€‚è€ƒè™‘åˆ°ä¾èµ–é¡¹çš„å¤æ‚æ€§å’Œä»£ç çš„å¯ä¿®æ”¹æ€§ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º80%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ç«™ç‚¹ï¼š** å¯»æ‰¾å®‰è£…äº†å—å½±å“æ’ä»¶ï¼ˆFrontend File Manager < 4.0 æˆ– N-Media Post Front-end Form <= 1.0ï¼‰çš„ WordPress ç«™ç‚¹ã€‚
2.  **åˆ†æ AJAX actionsï¼š** ä½¿ç”¨å¼€å‘è€…å·¥å…·æˆ–å…¶ä»–ç½‘ç»œæŠ“åŒ…å·¥å…·ï¼Œåˆ†æ `nm_filemanager_upload_file` å’Œ `nm_postfront_upload_file` AJAX actions çš„è¯·æ±‚å‚æ•°å’Œæ–‡ä»¶ä¸Šä¼ æ–¹å¼ã€‚
3.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ„é€ åŒ…å«æ¶æ„æ–‡ä»¶ï¼ˆå¦‚ PHP shellï¼‰çš„ POST è¯·æ±‚ï¼Œç»•è¿‡æ–‡ä»¶ç±»å‹éªŒè¯ã€‚é€šå¸¸å¯ä»¥é€šè¿‡ä¿®æ”¹ Content-Type æˆ–æ–‡ä»¶åæ¥æ¬ºéª—æœåŠ¡å™¨ã€‚
4.  **ä¸Šä¼ å¹¶æ‰§è¡Œæ¶æ„æ–‡ä»¶ï¼š** å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡ç«™ç‚¹ï¼ŒæˆåŠŸä¸Šä¼ æ¶æ„æ–‡ä»¶åï¼Œè®¿é—®è¯¥æ–‡ä»¶ï¼Œæ‰§è¡Œæ¶æ„ä»£ç ï¼Œä»è€Œæ§åˆ¶æœåŠ¡å™¨ã€‚

**é¡¹ç›®åœ°å€:** [Aditya43621/lab-cve-2016-15042](https://github.com/Aditya43621/lab-cve-2016-15042)

**æ¼æ´è¯¦æƒ…:** [CVE-2016-15042](https://nvd.nist.gov/vuln/detail/CVE-2016-15042)

---

## POC #2

**æ¥æº**: [CVE-2016-15042-ImBIOS_lab-cve-2016-15042.md](../2016/CVE-2016-15042-ImBIOS_lab-cve-2016-15042.md)

# CVE-2016-15042

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2016-15042-Aditya43621_lab-cve-2016-15042.md](../2016/CVE-2016-15042-Aditya43621_lab-cve-2016-15042.md)

## CVE-2016-15042-Frontend File Manager & N-Media Post Front-end Form-Arbitrary File Upload

**æ¼æ´ç¼–å·:** CVE-2016-15042

**æ¼æ´ç±»å‹:** ä»»æ„æ–‡ä»¶ä¸Šä¼ 

**å½±å“åº”ç”¨:** Frontend File Manager, N-Media Post Front-end Form

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 4.0 (Frontend File Manager), <= 1.0 (N-Media Post Front-end Form)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç«™ç‚¹å®‰è£…å—å½±å“çš„æ’ä»¶ï¼Œå¹¶å…è®¸æœªç»èº«ä»½éªŒè¯çš„ç”¨æˆ·è®¿é—®ä¸Šä¼ åŠŸèƒ½

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 80%

## è¯¦æƒ…

CVE-2016-15042 æ˜¯ä¸€ä¸ªå­˜åœ¨äº WordPress æ’ä»¶ Frontend File Manager å’Œ N-Media Post Front-end Form ä¸­çš„ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ã€‚ç”±äºæ’ä»¶ç¼ºä¹å……åˆ†çš„æ–‡ä»¶ç±»å‹éªŒè¯ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ `nm_filemanager_upload_file` å’Œ `nm_postfront_upload_file` AJAX actions ä¸Šä¼ ä»»æ„æ–‡ä»¶åˆ°æœåŠ¡å™¨ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ¼æ´åº“ä¿¡æ¯æ˜¾ç¤ºï¼Œè¯¥æ¼æ´å­˜åœ¨å…¬å¼€çš„åˆ©ç”¨æ–¹æ³•ï¼Œä¸”å½±å“èŒƒå›´æ˜ç¡®ã€‚æä¾›çš„ä»£ç ä»“åº“ä¸­åŒ…å«ä¸€ä¸ª `index.js` æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å»ºç«‹äº†ä¸€ä¸ªç®€å•çš„ REST APIã€‚ è™½ç„¶æä¾›çš„ä»£ç æœ¬èº«æ²¡æœ‰ç›´æ¥åˆ©ç”¨ CVE-2016-15042 æ¼æ´ï¼Œä½†å®ƒçš„å­˜åœ¨è¡¨æ˜å¯ä»¥æ„å»ºä¸€ä¸ªåˆ©ç”¨è¯¥æ¼æ´çš„ Web æœåŠ¡ã€‚æ¼æ´åº“ä¿¡æ¯æ˜¾ç¤ºè¯¥æ¼æ´å·²å­˜åœ¨å…¬å¼€çš„åˆ©ç”¨æ–¹æ³•,æœç´¢å¼•æ“æœªè¿”å›éªŒè¯ä¿¡æ¯,ä½†ç»“åˆæ¼æ´åº“ä¿¡æ¯,æ¨æ–­æ¼æ´åˆ©ç”¨æœ‰æ•ˆ

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“åŒ…å«ä¸€ä¸ªç®€å•çš„ Node.js REST APIã€‚è™½ç„¶å¿«é€Ÿæµè§ˆä»£ç æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†å­˜åœ¨ä»¥ä¸‹é£é™©ï¼š

*   **ä¾èµ–é¡¹é£é™©ï¼š** `package.json` æ–‡ä»¶ä¸­åŒ…å«å¤§é‡ä¾èµ–é¡¹ï¼Œå…¶ä¸­ä¸€äº›ä¾èµ–é¡¹çš„ç‰ˆæœ¬è¾ƒè€ï¼Œå¯èƒ½å­˜åœ¨å·²çŸ¥æ¼æ´ï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™äº›æ¼æ´è¿›è¡ŒæŠ•æ¯’ã€‚
*   **ä»£ç æ··æ·†/éšè—ï¼š** ä»£ç ç»“æ„è¾ƒä¸ºç®€å•ï¼Œæ˜“äºåœ¨ç°æœ‰ä»£ç ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚è®°å½•ç”¨æˆ·è¯·æ±‚ã€çªƒå–æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæ¶æ„æ“ä½œã€‚
*   **ä¾›åº”é“¾æ”»å‡»ï¼š** ä½œè€…ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹åº“å¯èƒ½è¢«æ¶æ„ç¯¡æ”¹ï¼Œå¯¼è‡´å¼•å…¥æ¶æ„ä»£ç ã€‚

å› æ­¤ï¼Œå°½ç®¡ä¹ä¸€çœ‹ä»£ç æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†æ½œåœ¨é£é™©ä»ç„¶å¾ˆé«˜ã€‚è€ƒè™‘åˆ°ä¾èµ–é¡¹çš„å¤æ‚æ€§å’Œä»£ç çš„å¯ä¿®æ”¹æ€§ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º80%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ç«™ç‚¹ï¼š** å¯»æ‰¾å®‰è£…äº†å—å½±å“æ’ä»¶ï¼ˆFrontend File Manager < 4.0 æˆ– N-Media Post Front-end Form <= 1.0ï¼‰çš„ WordPress ç«™ç‚¹ã€‚
2.  **åˆ†æ AJAX actionsï¼š** ä½¿ç”¨å¼€å‘è€…å·¥å…·æˆ–å…¶ä»–ç½‘ç»œæŠ“åŒ…å·¥å…·ï¼Œåˆ†æ `nm_filemanager_upload_file` å’Œ `nm_postfront_upload_file` AJAX actions çš„è¯·æ±‚å‚æ•°å’Œæ–‡ä»¶ä¸Šä¼ æ–¹å¼ã€‚
3.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ„é€ åŒ…å«æ¶æ„æ–‡ä»¶ï¼ˆå¦‚ PHP shellï¼‰çš„ POST è¯·æ±‚ï¼Œç»•è¿‡æ–‡ä»¶ç±»å‹éªŒè¯ã€‚é€šå¸¸å¯ä»¥é€šè¿‡ä¿®æ”¹ Content-Type æˆ–æ–‡ä»¶åæ¥æ¬ºéª—æœåŠ¡å™¨ã€‚
4.  **ä¸Šä¼ å¹¶æ‰§è¡Œæ¶æ„æ–‡ä»¶ï¼š** å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡ç«™ç‚¹ï¼ŒæˆåŠŸä¸Šä¼ æ¶æ„æ–‡ä»¶åï¼Œè®¿é—®è¯¥æ–‡ä»¶ï¼Œæ‰§è¡Œæ¶æ„ä»£ç ï¼Œä»è€Œæ§åˆ¶æœåŠ¡å™¨ã€‚

**é¡¹ç›®åœ°å€:** [Aditya43621/lab-cve-2016-15042](https://github.com/Aditya43621/lab-cve-2016-15042)

**æ¼æ´è¯¦æƒ…:** [CVE-2016-15042](https://nvd.nist.gov/vuln/detail/CVE-2016-15042)

---

## POC #2

**æ¥æº**: [CVE-2016-15042-ImBIOS_lab-cve-2016-15042.md](../2016/CVE-2016-15042-ImBIOS_lab-cve-2016-15042.md)

# CVE-2016-15042

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2016-15042-Aditya43621_lab-cve-2016-15042.md](../2016/CVE-2016-15042-Aditya43621_lab-cve-2016-15042.md)

## CVE-2016-15042-Frontend File Manager & N-Media Post Front-end Form-Arbitrary File Upload

**æ¼æ´ç¼–å·:** CVE-2016-15042

**æ¼æ´ç±»å‹:** ä»»æ„æ–‡ä»¶ä¸Šä¼ 

**å½±å“åº”ç”¨:** Frontend File Manager, N-Media Post Front-end Form

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 4.0 (Frontend File Manager), <= 1.0 (N-Media Post Front-end Form)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç«™ç‚¹å®‰è£…å—å½±å“çš„æ’ä»¶ï¼Œå¹¶å…è®¸æœªç»èº«ä»½éªŒè¯çš„ç”¨æˆ·è®¿é—®ä¸Šä¼ åŠŸèƒ½

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 80%

## è¯¦æƒ…

CVE-2016-15042 æ˜¯ä¸€ä¸ªå­˜åœ¨äº WordPress æ’ä»¶ Frontend File Manager å’Œ N-Media Post Front-end Form ä¸­çš„ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ã€‚ç”±äºæ’ä»¶ç¼ºä¹å……åˆ†çš„æ–‡ä»¶ç±»å‹éªŒè¯ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ `nm_filemanager_upload_file` å’Œ `nm_postfront_upload_file` AJAX actions ä¸Šä¼ ä»»æ„æ–‡ä»¶åˆ°æœåŠ¡å™¨ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ¼æ´åº“ä¿¡æ¯æ˜¾ç¤ºï¼Œè¯¥æ¼æ´å­˜åœ¨å…¬å¼€çš„åˆ©ç”¨æ–¹æ³•ï¼Œä¸”å½±å“èŒƒå›´æ˜ç¡®ã€‚æä¾›çš„ä»£ç ä»“åº“ä¸­åŒ…å«ä¸€ä¸ª `index.js` æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å»ºç«‹äº†ä¸€ä¸ªç®€å•çš„ REST APIã€‚ è™½ç„¶æä¾›çš„ä»£ç æœ¬èº«æ²¡æœ‰ç›´æ¥åˆ©ç”¨ CVE-2016-15042 æ¼æ´ï¼Œä½†å®ƒçš„å­˜åœ¨è¡¨æ˜å¯ä»¥æ„å»ºä¸€ä¸ªåˆ©ç”¨è¯¥æ¼æ´çš„ Web æœåŠ¡ã€‚æ¼æ´åº“ä¿¡æ¯æ˜¾ç¤ºè¯¥æ¼æ´å·²å­˜åœ¨å…¬å¼€çš„åˆ©ç”¨æ–¹æ³•,æœç´¢å¼•æ“æœªè¿”å›éªŒè¯ä¿¡æ¯,ä½†ç»“åˆæ¼æ´åº“ä¿¡æ¯,æ¨æ–­æ¼æ´åˆ©ç”¨æœ‰æ•ˆ

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“åŒ…å«ä¸€ä¸ªç®€å•çš„ Node.js REST APIã€‚è™½ç„¶å¿«é€Ÿæµè§ˆä»£ç æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†å­˜åœ¨ä»¥ä¸‹é£é™©ï¼š

*   **ä¾èµ–é¡¹é£é™©ï¼š** `package.json` æ–‡ä»¶ä¸­åŒ…å«å¤§é‡ä¾èµ–é¡¹ï¼Œå…¶ä¸­ä¸€äº›ä¾èµ–é¡¹çš„ç‰ˆæœ¬è¾ƒè€ï¼Œå¯èƒ½å­˜åœ¨å·²çŸ¥æ¼æ´ï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™äº›æ¼æ´è¿›è¡ŒæŠ•æ¯’ã€‚
*   **ä»£ç æ··æ·†/éšè—ï¼š** ä»£ç ç»“æ„è¾ƒä¸ºç®€å•ï¼Œæ˜“äºåœ¨ç°æœ‰ä»£ç ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚è®°å½•ç”¨æˆ·è¯·æ±‚ã€çªƒå–æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæ¶æ„æ“ä½œã€‚
*   **ä¾›åº”é“¾æ”»å‡»ï¼š** ä½œè€…ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹åº“å¯èƒ½è¢«æ¶æ„ç¯¡æ”¹ï¼Œå¯¼è‡´å¼•å…¥æ¶æ„ä»£ç ã€‚

å› æ­¤ï¼Œå°½ç®¡ä¹ä¸€çœ‹ä»£ç æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†æ½œåœ¨é£é™©ä»ç„¶å¾ˆé«˜ã€‚è€ƒè™‘åˆ°ä¾èµ–é¡¹çš„å¤æ‚æ€§å’Œä»£ç çš„å¯ä¿®æ”¹æ€§ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º80%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ç«™ç‚¹ï¼š** å¯»æ‰¾å®‰è£…äº†å—å½±å“æ’ä»¶ï¼ˆFrontend File Manager < 4.0 æˆ– N-Media Post Front-end Form <= 1.0ï¼‰çš„ WordPress ç«™ç‚¹ã€‚
2.  **åˆ†æ AJAX actionsï¼š** ä½¿ç”¨å¼€å‘è€…å·¥å…·æˆ–å…¶ä»–ç½‘ç»œæŠ“åŒ…å·¥å…·ï¼Œåˆ†æ `nm_filemanager_upload_file` å’Œ `nm_postfront_upload_file` AJAX actions çš„è¯·æ±‚å‚æ•°å’Œæ–‡ä»¶ä¸Šä¼ æ–¹å¼ã€‚
3.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ„é€ åŒ…å«æ¶æ„æ–‡ä»¶ï¼ˆå¦‚ PHP shellï¼‰çš„ POST è¯·æ±‚ï¼Œç»•è¿‡æ–‡ä»¶ç±»å‹éªŒè¯ã€‚é€šå¸¸å¯ä»¥é€šè¿‡ä¿®æ”¹ Content-Type æˆ–æ–‡ä»¶åæ¥æ¬ºéª—æœåŠ¡å™¨ã€‚
4.  **ä¸Šä¼ å¹¶æ‰§è¡Œæ¶æ„æ–‡ä»¶ï¼š** å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡ç«™ç‚¹ï¼ŒæˆåŠŸä¸Šä¼ æ¶æ„æ–‡ä»¶åï¼Œè®¿é—®è¯¥æ–‡ä»¶ï¼Œæ‰§è¡Œæ¶æ„ä»£ç ï¼Œä»è€Œæ§åˆ¶æœåŠ¡å™¨ã€‚

**é¡¹ç›®åœ°å€:** [Aditya43621/lab-cve-2016-15042](https://github.com/Aditya43621/lab-cve-2016-15042)

**æ¼æ´è¯¦æƒ…:** [CVE-2016-15042](https://nvd.nist.gov/vuln/detail/CVE-2016-15042)

---

## POC #2

**æ¥æº**: [CVE-2016-15042-ImBIOS_lab-cve-2016-15042.md](../2016/CVE-2016-15042-ImBIOS_lab-cve-2016-15042.md)

# CVE-2016-15042

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2016-15042-Aditya43621_lab-cve-2016-15042.md](../2016/CVE-2016-15042-Aditya43621_lab-cve-2016-15042.md)

## CVE-2016-15042-Frontend File Manager & N-Media Post Front-end Form-Arbitrary File Upload

**æ¼æ´ç¼–å·:** CVE-2016-15042

**æ¼æ´ç±»å‹:** ä»»æ„æ–‡ä»¶ä¸Šä¼ 

**å½±å“åº”ç”¨:** Frontend File Manager, N-Media Post Front-end Form

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 4.0 (Frontend File Manager), <= 1.0 (N-Media Post Front-end Form)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç«™ç‚¹å®‰è£…å—å½±å“çš„æ’ä»¶ï¼Œå¹¶å…è®¸æœªç»èº«ä»½éªŒè¯çš„ç”¨æˆ·è®¿é—®ä¸Šä¼ åŠŸèƒ½

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 80%

## è¯¦æƒ…

CVE-2016-15042 æ˜¯ä¸€ä¸ªå­˜åœ¨äº WordPress æ’ä»¶ Frontend File Manager å’Œ N-Media Post Front-end Form ä¸­çš„ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ã€‚ç”±äºæ’ä»¶ç¼ºä¹å……åˆ†çš„æ–‡ä»¶ç±»å‹éªŒè¯ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ `nm_filemanager_upload_file` å’Œ `nm_postfront_upload_file` AJAX actions ä¸Šä¼ ä»»æ„æ–‡ä»¶åˆ°æœåŠ¡å™¨ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ¼æ´åº“ä¿¡æ¯æ˜¾ç¤ºï¼Œè¯¥æ¼æ´å­˜åœ¨å…¬å¼€çš„åˆ©ç”¨æ–¹æ³•ï¼Œä¸”å½±å“èŒƒå›´æ˜ç¡®ã€‚æä¾›çš„ä»£ç ä»“åº“ä¸­åŒ…å«ä¸€ä¸ª `index.js` æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å»ºç«‹äº†ä¸€ä¸ªç®€å•çš„ REST APIã€‚ è™½ç„¶æä¾›çš„ä»£ç æœ¬èº«æ²¡æœ‰ç›´æ¥åˆ©ç”¨ CVE-2016-15042 æ¼æ´ï¼Œä½†å®ƒçš„å­˜åœ¨è¡¨æ˜å¯ä»¥æ„å»ºä¸€ä¸ªåˆ©ç”¨è¯¥æ¼æ´çš„ Web æœåŠ¡ã€‚æ¼æ´åº“ä¿¡æ¯æ˜¾ç¤ºè¯¥æ¼æ´å·²å­˜åœ¨å…¬å¼€çš„åˆ©ç”¨æ–¹æ³•,æœç´¢å¼•æ“æœªè¿”å›éªŒè¯ä¿¡æ¯,ä½†ç»“åˆæ¼æ´åº“ä¿¡æ¯,æ¨æ–­æ¼æ´åˆ©ç”¨æœ‰æ•ˆ

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“åŒ…å«ä¸€ä¸ªç®€å•çš„ Node.js REST APIã€‚è™½ç„¶å¿«é€Ÿæµè§ˆä»£ç æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†å­˜åœ¨ä»¥ä¸‹é£é™©ï¼š

*   **ä¾èµ–é¡¹é£é™©ï¼š** `package.json` æ–‡ä»¶ä¸­åŒ…å«å¤§é‡ä¾èµ–é¡¹ï¼Œå…¶ä¸­ä¸€äº›ä¾èµ–é¡¹çš„ç‰ˆæœ¬è¾ƒè€ï¼Œå¯èƒ½å­˜åœ¨å·²çŸ¥æ¼æ´ï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™äº›æ¼æ´è¿›è¡ŒæŠ•æ¯’ã€‚
*   **ä»£ç æ··æ·†/éšè—ï¼š** ä»£ç ç»“æ„è¾ƒä¸ºç®€å•ï¼Œæ˜“äºåœ¨ç°æœ‰ä»£ç ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚è®°å½•ç”¨æˆ·è¯·æ±‚ã€çªƒå–æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæ¶æ„æ“ä½œã€‚
*   **ä¾›åº”é“¾æ”»å‡»ï¼š** ä½œè€…ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹åº“å¯èƒ½è¢«æ¶æ„ç¯¡æ”¹ï¼Œå¯¼è‡´å¼•å…¥æ¶æ„ä»£ç ã€‚

å› æ­¤ï¼Œå°½ç®¡ä¹ä¸€çœ‹ä»£ç æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†æ½œåœ¨é£é™©ä»ç„¶å¾ˆé«˜ã€‚è€ƒè™‘åˆ°ä¾èµ–é¡¹çš„å¤æ‚æ€§å’Œä»£ç çš„å¯ä¿®æ”¹æ€§ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º80%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ç«™ç‚¹ï¼š** å¯»æ‰¾å®‰è£…äº†å—å½±å“æ’ä»¶ï¼ˆFrontend File Manager < 4.0 æˆ– N-Media Post Front-end Form <= 1.0ï¼‰çš„ WordPress ç«™ç‚¹ã€‚
2.  **åˆ†æ AJAX actionsï¼š** ä½¿ç”¨å¼€å‘è€…å·¥å…·æˆ–å…¶ä»–ç½‘ç»œæŠ“åŒ…å·¥å…·ï¼Œåˆ†æ `nm_filemanager_upload_file` å’Œ `nm_postfront_upload_file` AJAX actions çš„è¯·æ±‚å‚æ•°å’Œæ–‡ä»¶ä¸Šä¼ æ–¹å¼ã€‚
3.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ„é€ åŒ…å«æ¶æ„æ–‡ä»¶ï¼ˆå¦‚ PHP shellï¼‰çš„ POST è¯·æ±‚ï¼Œç»•è¿‡æ–‡ä»¶ç±»å‹éªŒè¯ã€‚é€šå¸¸å¯ä»¥é€šè¿‡ä¿®æ”¹ Content-Type æˆ–æ–‡ä»¶åæ¥æ¬ºéª—æœåŠ¡å™¨ã€‚
4.  **ä¸Šä¼ å¹¶æ‰§è¡Œæ¶æ„æ–‡ä»¶ï¼š** å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡ç«™ç‚¹ï¼ŒæˆåŠŸä¸Šä¼ æ¶æ„æ–‡ä»¶åï¼Œè®¿é—®è¯¥æ–‡ä»¶ï¼Œæ‰§è¡Œæ¶æ„ä»£ç ï¼Œä»è€Œæ§åˆ¶æœåŠ¡å™¨ã€‚

**é¡¹ç›®åœ°å€:** [Aditya43621/lab-cve-2016-15042](https://github.com/Aditya43621/lab-cve-2016-15042)

**æ¼æ´è¯¦æƒ…:** [CVE-2016-15042](https://nvd.nist.gov/vuln/detail/CVE-2016-15042)

---

## POC #2

**æ¥æº**: [CVE-2016-15042-ImBIOS_lab-cve-2016-15042.md](../2016/CVE-2016-15042-ImBIOS_lab-cve-2016-15042.md)

# CVE-2016-15042

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2016-15042-Aditya43621_lab-cve-2016-15042.md](../2016/CVE-2016-15042-Aditya43621_lab-cve-2016-15042.md)

## CVE-2016-15042-Frontend File Manager & N-Media Post Front-end Form-Arbitrary File Upload

**æ¼æ´ç¼–å·:** CVE-2016-15042

**æ¼æ´ç±»å‹:** ä»»æ„æ–‡ä»¶ä¸Šä¼ 

**å½±å“åº”ç”¨:** Frontend File Manager, N-Media Post Front-end Form

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 4.0 (Frontend File Manager), <= 1.0 (N-Media Post Front-end Form)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç«™ç‚¹å®‰è£…å—å½±å“çš„æ’ä»¶ï¼Œå¹¶å…è®¸æœªç»èº«ä»½éªŒè¯çš„ç”¨æˆ·è®¿é—®ä¸Šä¼ åŠŸèƒ½

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 80%

## è¯¦æƒ…

CVE-2016-15042 æ˜¯ä¸€ä¸ªå­˜åœ¨äº WordPress æ’ä»¶ Frontend File Manager å’Œ N-Media Post Front-end Form ä¸­çš„ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ã€‚ç”±äºæ’ä»¶ç¼ºä¹å……åˆ†çš„æ–‡ä»¶ç±»å‹éªŒè¯ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ `nm_filemanager_upload_file` å’Œ `nm_postfront_upload_file` AJAX actions ä¸Šä¼ ä»»æ„æ–‡ä»¶åˆ°æœåŠ¡å™¨ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ¼æ´åº“ä¿¡æ¯æ˜¾ç¤ºï¼Œè¯¥æ¼æ´å­˜åœ¨å…¬å¼€çš„åˆ©ç”¨æ–¹æ³•ï¼Œä¸”å½±å“èŒƒå›´æ˜ç¡®ã€‚æä¾›çš„ä»£ç ä»“åº“ä¸­åŒ…å«ä¸€ä¸ª `index.js` æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å»ºç«‹äº†ä¸€ä¸ªç®€å•çš„ REST APIã€‚ è™½ç„¶æä¾›çš„ä»£ç æœ¬èº«æ²¡æœ‰ç›´æ¥åˆ©ç”¨ CVE-2016-15042 æ¼æ´ï¼Œä½†å®ƒçš„å­˜åœ¨è¡¨æ˜å¯ä»¥æ„å»ºä¸€ä¸ªåˆ©ç”¨è¯¥æ¼æ´çš„ Web æœåŠ¡ã€‚æ¼æ´åº“ä¿¡æ¯æ˜¾ç¤ºè¯¥æ¼æ´å·²å­˜åœ¨å…¬å¼€çš„åˆ©ç”¨æ–¹æ³•,æœç´¢å¼•æ“æœªè¿”å›éªŒè¯ä¿¡æ¯,ä½†ç»“åˆæ¼æ´åº“ä¿¡æ¯,æ¨æ–­æ¼æ´åˆ©ç”¨æœ‰æ•ˆ

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“åŒ…å«ä¸€ä¸ªç®€å•çš„ Node.js REST APIã€‚è™½ç„¶å¿«é€Ÿæµè§ˆä»£ç æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†å­˜åœ¨ä»¥ä¸‹é£é™©ï¼š

*   **ä¾èµ–é¡¹é£é™©ï¼š** `package.json` æ–‡ä»¶ä¸­åŒ…å«å¤§é‡ä¾èµ–é¡¹ï¼Œå…¶ä¸­ä¸€äº›ä¾èµ–é¡¹çš„ç‰ˆæœ¬è¾ƒè€ï¼Œå¯èƒ½å­˜åœ¨å·²çŸ¥æ¼æ´ï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™äº›æ¼æ´è¿›è¡ŒæŠ•æ¯’ã€‚
*   **ä»£ç æ··æ·†/éšè—ï¼š** ä»£ç ç»“æ„è¾ƒä¸ºç®€å•ï¼Œæ˜“äºåœ¨ç°æœ‰ä»£ç ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚è®°å½•ç”¨æˆ·è¯·æ±‚ã€çªƒå–æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæ¶æ„æ“ä½œã€‚
*   **ä¾›åº”é“¾æ”»å‡»ï¼š** ä½œè€…ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹åº“å¯èƒ½è¢«æ¶æ„ç¯¡æ”¹ï¼Œå¯¼è‡´å¼•å…¥æ¶æ„ä»£ç ã€‚

å› æ­¤ï¼Œå°½ç®¡ä¹ä¸€çœ‹ä»£ç æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†æ½œåœ¨é£é™©ä»ç„¶å¾ˆé«˜ã€‚è€ƒè™‘åˆ°ä¾èµ–é¡¹çš„å¤æ‚æ€§å’Œä»£ç çš„å¯ä¿®æ”¹æ€§ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º80%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ç«™ç‚¹ï¼š** å¯»æ‰¾å®‰è£…äº†å—å½±å“æ’ä»¶ï¼ˆFrontend File Manager < 4.0 æˆ– N-Media Post Front-end Form <= 1.0ï¼‰çš„ WordPress ç«™ç‚¹ã€‚
2.  **åˆ†æ AJAX actionsï¼š** ä½¿ç”¨å¼€å‘è€…å·¥å…·æˆ–å…¶ä»–ç½‘ç»œæŠ“åŒ…å·¥å…·ï¼Œåˆ†æ `nm_filemanager_upload_file` å’Œ `nm_postfront_upload_file` AJAX actions çš„è¯·æ±‚å‚æ•°å’Œæ–‡ä»¶ä¸Šä¼ æ–¹å¼ã€‚
3.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ„é€ åŒ…å«æ¶æ„æ–‡ä»¶ï¼ˆå¦‚ PHP shellï¼‰çš„ POST è¯·æ±‚ï¼Œç»•è¿‡æ–‡ä»¶ç±»å‹éªŒè¯ã€‚é€šå¸¸å¯ä»¥é€šè¿‡ä¿®æ”¹ Content-Type æˆ–æ–‡ä»¶åæ¥æ¬ºéª—æœåŠ¡å™¨ã€‚
4.  **ä¸Šä¼ å¹¶æ‰§è¡Œæ¶æ„æ–‡ä»¶ï¼š** å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡ç«™ç‚¹ï¼ŒæˆåŠŸä¸Šä¼ æ¶æ„æ–‡ä»¶åï¼Œè®¿é—®è¯¥æ–‡ä»¶ï¼Œæ‰§è¡Œæ¶æ„ä»£ç ï¼Œä»è€Œæ§åˆ¶æœåŠ¡å™¨ã€‚

**é¡¹ç›®åœ°å€:** [Aditya43621/lab-cve-2016-15042](https://github.com/Aditya43621/lab-cve-2016-15042)

**æ¼æ´è¯¦æƒ…:** [CVE-2016-15042](https://nvd.nist.gov/vuln/detail/CVE-2016-15042)

---

## POC #2

**æ¥æº**: [CVE-2016-15042-ImBIOS_lab-cve-2016-15042.md](../2016/CVE-2016-15042-ImBIOS_lab-cve-2016-15042.md)

## CVE-2016-15042 â€“ WordPress Frontend File Manager & Nâ€‘Media Post Frontâ€‘end Form Unauthenticated File Upload

**æ¼æ´ç¼–å·:** CVE-2016-15042

**æ¼æ´ç±»å‹:** ä»»æ„æ–‡ä»¶ä¸Šä¼ 

**å½±å“åº”ç”¨:** WordPress Frontend File Manager & Nâ€‘Media Post Frontâ€‘end Form

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** Frontend File Manager < 4.0, N-Media Post Front-end Form < 1.1

**åˆ©ç”¨æ¡ä»¶:** å—å½±å“çš„æ’ä»¶å·²å®‰è£…å¹¶å¯ç”¨ï¼Œç›®æ ‡WordPressç«™ç‚¹å…è®¸ä¸Šä¼ æ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2016-15042æ˜¯ä¸€ä¸ªWordPressæ’ä»¶çš„æœªæˆæƒæ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œå­˜åœ¨äºFrontend File Managerå’ŒN-Media Post Front-end Formæ’ä»¶ä¸­ã€‚ç”±äºç¼ºå°‘æ–‡ä»¶ç±»å‹éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥ä¸Šä¼ ä»»æ„æ–‡ä»¶åˆ°æœåŠ¡å™¨ï¼ŒåŒ…æ‹¬æ¶æ„PHPè„šæœ¬ï¼Œä»è€Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªDockerized labï¼Œç”¨äºé‡ç°è¯¥æ¼æ´ã€‚å®ƒé…ç½®äº†ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªæ˜“å—æ”»å‡»æ’ä»¶çš„WordPresså®ä¾‹ï¼Œå¹¶æä¾›ä½¿ç”¨Nucleiè¿›è¡ŒéªŒè¯çš„æ­¥éª¤ã€‚ å› æ­¤ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œèƒ½å¤ŸæˆåŠŸå¤ç°å’ŒéªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥ä»“åº“çš„ä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ä¸ªå¯å¤ç°çš„æ¼æ´ç¯å¢ƒã€‚Dockerfile å’Œç›¸å…³è„šæœ¬æ–‡ä»¶æ£€æŸ¥äº†è½¯ä»¶çš„ä¸‹è½½å’Œå®‰è£…è¿‡ç¨‹ã€‚`/scripts/setup.sh`è„šæœ¬çš„ä¸»è¦ä½œç”¨æ˜¯å¯åŠ¨ä¸€ä¸ªåŒ…å«æ¼æ´wordpressçš„dockerç¯å¢ƒã€‚ å°½ç®¡è¯¥ä»“åº“çœ‹ä¼¼æä¾›äº†ä¸€ä¸ªæ¼æ´éªŒè¯ç¯å¢ƒï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤æ½œåœ¨çš„é£é™©ã€‚ æ¯”å¦‚ï¼Œä¸‹è½½é“¾æ¥ä½¿ç”¨çš„wordpressæ’ä»¶ï¼Œæœ‰æ¦‚ç‡å­˜åœ¨è¢«ç¯¡æ”¹çš„æƒ…å†µã€‚ docker compose è„šæœ¬ä¸­å­˜åœ¨ç«¯å£æ˜ å°„ï¼Œæœ‰è¢«æ¶æ„åˆ©ç”¨çš„å¯èƒ½ã€‚ç»¼åˆä»¥ä¸Šï¼Œåˆ¤å®šæŠ•æ¯’é£é™©ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ— éœ€èº«ä»½éªŒè¯ã€‚
2.  æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘`nm_filemanager_upload_file` æˆ– `nm_postfront_upload_file` AJAX actionå‘é€åŒ…å«æ¶æ„æ–‡ä»¶çš„è¯·æ±‚ï¼Œç»•è¿‡æ–‡ä»¶ç±»å‹æ£€æŸ¥ã€‚
3.  æˆåŠŸä¸Šä¼ åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®è¯¥æ–‡ä»¶ï¼Œå¦‚æœä¸Šä¼ çš„æ˜¯PHPè„šæœ¬ï¼Œå°±å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [ImBIOS/lab-cve-2016-15042](https://github.com/ImBIOS/lab-cve-2016-15042)

**æ¼æ´è¯¦æƒ…:** [CVE-2016-15042](https://nvd.nist.gov/vuln/detail/CVE-2016-15042)

---



---



---



---



---



---

