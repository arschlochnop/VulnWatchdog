## CVE-2016-15042 - Rest-Api RCE

**漏洞编号:** CVE-2016-15042

**漏洞类型:** RCE

**影响应用:** Rest-Api

**危害等级:** Critical

**CVSS评分:** Unknown

**影响版本:** Unknown

**利用条件:** Requires network access to the vulnerable endpoint.

**POC 可用性:** 7/10

**POC 类型:** Complete exploit

**攻击复杂度:** Low

**投毒风险:** 40%

## 详情

CVE-2016-15042 is a remote code execution (RCE) vulnerability. The provided POC code appears to be a functional exploit targeting a Node.js application named Rest-Api. The `Dockerfile` sets up a Node.js environment, installs dependencies, and exposes port 6892, suggesting a network-based attack vector. The `index.js` file (partially shown) includes potentially vulnerable code. Analyzing `index.js` for specific vulnerabilities requires the full file content, however, the presence of `eval(req.query.expr)` indicates that the application executes arbitrary code provided in the `expr` query parameter. This is a highly dangerous practice and a common source of RCE vulnerabilities.

POC有效性分析:
Based on the code snippets, the provided Proof of Concept (POC) is likely effective. The `index.js` snippet contains `eval(req.query.expr)`, which directly executes arbitrary JavaScript code sent in the `expr` parameter. This is a direct and immediate vulnerability, and exploitation is straightforward, assuming the endpoint where this code resides is exposed and accessible. The `Dockerfile` suggests a standard setup for a Node.js application, making replication relatively easy. The `README.md` provides visual confirmation of the lab setup and aims to promote the usage of the provided resource, and shows how an attacker can easily set up a vulnerable environment and start exploiting the eval function to achieve remote code execution.

利用步骤:
1. Deploy the vulnerable application using the provided `Dockerfile` or directly execute the `index.js` in a Node.js environment.
2. Identify the endpoint where the `eval(req.query.expr)` code is executed, commonly at '/'.
3. Craft a malicious HTTP request to trigger code execution. For example: `http://<target_ip>:6892/?expr=require('child_process').exec('whoami', function(err, stdout, stderr) { console.log(stdout) })`
4. Examine the application's response or logs to confirm successful code execution. The example payload executes the `whoami` command, and the output reveals which user the node process is running as.
5. Expand the payload to perform more critical actions like reverse shells.

投毒风险分析:
The poisoning risk is moderate. While the core vulnerability (the `eval` function) is inherently dangerous, there is also a moderate risk of code poisoning within the provided source. Although the code doesn't appear heavily obfuscated, close review of the full `index.js` file is important. The `README.md` pulls many images from external, untrusted sources. These images could be replaced with malicious content. Additionally, the `index.js` could include other subtle backdoors, such as requiring modules from untrusted sources or logging credentials. The risk isn't high because the code is somewhat readable and most of the application logic seems related to exploiting the `eval` vulnerability directly. However, the use of external resources and the potential for hidden functionality increases the risk. Because of the external resources called from README.md, there exists a real supply chain poisoning risk. The POC uses standard libraries and the potential malicious code is small (eval statement). Thus, the poisoning risk score is about 40%.

**项目地址:** https://raw.githubusercontent.com/Aditya43621/lab-cve-2016-15042/master/acaciin/lab-cve-2016-15042.zip

**漏洞详情:** Unknown
