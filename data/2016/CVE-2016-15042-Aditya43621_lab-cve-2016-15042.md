## CVE-2016-15042 - node-serialize RCE

**漏洞编号:** CVE-2016-15042

**漏洞类型:** RCE

**影响应用:** node-serialize

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** Prior to 0.2.1

**利用条件:** Requires network access to a server using a vulnerable version of node-serialize. No authentication required for a basic exploit.

**POC 可用性:** 8/10

**POC 类型:** Complete exploit

**攻击复杂度:** Low

**投毒风险:** 40%

## 详情

CVE-2016-15042 is a critical remote code execution (RCE) vulnerability affecting the `node-serialize` package before version 0.2.1. This vulnerability allows attackers to execute arbitrary code on a server by sending a specially crafted serialized JavaScript object. The `node-serialize` package is used for serializing and deserializing JavaScript objects, and the vulnerability arises from its unsafe deserialization of user-supplied input.

POC有效性分析:
The provided POC includes a Dockerfile, Procfile, README, and a JavaScript file (`index.js`), suggesting a functional exploit. The Dockerfile sets up a Node.js environment, installs dependencies, and exposes port 6892, implying that the exploit targets a network-accessible service. The README mentions "lab-cve-2016-15042," which confirms that the provided code is designed to exploit this specific CVE. The JavaScript code likely contains the vulnerable deserialization logic and the payload required for RCE. The presence of `cors` and `ssl-express-www` modules in the `index.js` file suggests the creation of an API endpoint.

利用步骤:
1.  Set up the vulnerable `node-serialize` application:
    *   Clone the repository containing the vulnerable code.
    *   Install the dependencies using `npm install`.
2.  Craft the malicious payload:
    *   The attacker needs to create a serialized JavaScript object that, when deserialized by the vulnerable `node-serialize` library, will execute arbitrary code.
    *   This usually involves injecting JavaScript code into the serialized string that triggers the `eval()` function or other similar code execution methods during deserialization.
3.  Send the payload to the vulnerable endpoint:
    *   Identify the endpoint that uses the `node-serialize` library to deserialize user-supplied data.
    *   Send the crafted payload to this endpoint via an HTTP request.
4.  Execute arbitrary code:
    *   If the exploit is successful, the server will execute the attacker-supplied code, granting the attacker control over the system.

投毒风险分析:
The primary concern with the provided code is the presence of `eval` or similar functions that could be exploited to inject malicious code. While the code itself might demonstrate the CVE, it could be modified to include malicious functionalities like:
1.  **Data exfiltration**: The injected code could steal sensitive information from the server, such as API keys, database credentials, or user data, and send it to an attacker-controlled server.
2.  **Backdoor creation**: The injected code could create a backdoor, allowing the attacker to maintain persistent access to the compromised system.
3.  **System compromise**: The injected code could be used to install malware, modify system files, or perform other actions that could compromise the entire system.

The inclusion of `cors` allows cross-origin requests, which could potentially be abused if not configured correctly, leading to unexpected data leakage or unauthorized access. The `ssl-express-www` module, while intended for security by enforcing HTTPS, can introduce misconfigurations if not handled properly. The risk of dependency confusion attacks exists if the `npm install` command fetches packages from untrusted sources or if the project relies on outdated dependencies with known vulnerabilities. The risk is estimated at 40% due to the potential for malicious payload injection and the use of potentially insecure modules like `cors` without clear configuration details. Further analysis of `index.js` would be required to determine the exact nature and severity of the injected payload.

**项目地址:** https://raw.githubusercontent.com/Aditya43621/lab-cve-2016-15042/master/acaciin/lab-cve-2016-15042.zip

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2016-15042
