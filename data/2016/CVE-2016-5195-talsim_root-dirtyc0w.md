# CVE-2016-5195

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-5195-0x3n19m4_CVE-2016-5195.md](../2016/CVE-2016-5195-0x3n19m4_CVE-2016-5195.md)

## CVE-2016-5195 Dirty COW

**漏洞编号:** CVE-2016-5195

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户提升为root权限

**影响版本:** 2.x ~ 4.x before 4.8.3

**利用条件:** 本地用户权限，目标系统内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-5195（Dirty COW）是一个Linux内核中的竞争条件漏洞，存在于mm/gup.c文件中。该漏洞允许本地用户利用写时复制（COW）机制的不当处理，写入只读内存映射，从而获得特权。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞在野外被广泛利用，并且有公开的PoC代码可用。因此，在未经修补的系统上，该漏洞的利用是有效的。

**投毒风险：**
提供的PoC代码只包含一个MIT协议的LICENSE文件，该文件只声明了版权信息和使用许可，**没有发现任何可疑的恶意代码**。因此，该仓库中存在作者隐藏的投毒代码的可能性为0%。

**利用方式：**
Dirty COW漏洞的利用方式通常包括以下步骤：
1.  找到一个具有root权限，但允许普通用户读取的文件（例如：/etc/passwd）。
2.  将该文件映射到内存中。
3.  创建一个单独的线程或进程，使用`madvise`系统调用触发写时复制（COW）。
4.  在原始文件映射的内存区域中，通过`/proc/self/mem` 映射进行写入。
5.  快速重复步骤3和4，造成竞争条件，使写入操作绕过权限检查，从而修改只读内存映射的文件内容。

成功利用此漏洞后，攻击者可以修改/etc/passwd文件，添加一个新的具有root权限的用户，或者修改现有root用户的密码，从而获得系统的完全控制权。

**项目地址:** [0x3n19m4/CVE-2016-5195](https://github.com/0x3n19m4/CVE-2016-5195)

**漏洞详情:** [CVE-2016-5195](https://nvd.nist.gov/vuln/detail/CVE-2016-5195)

---

## POC #2

**来源**: [CVE-2016-5195-ASUKA39_CVE-2016-5195.md](../2016/CVE-2016-5195-ASUKA39_CVE-2016-5195.md)

## CVE-2016-5195 Dirty COW

**漏洞编号:** CVE-2016-5195

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获得 root 权限

**影响版本:** Linux kernel 2.x through 4.x before 4.8.3

**利用条件:** 需要本地用户权限，目标文件可读。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

Dirty COW (CVE-2016-5195) 是 Linux 内核中的一个竞争条件漏洞，它允许低权限本地用户获得对只读内存映射的写访问权限，从而导致权限提升。漏洞存在于 `mm/gup.c` 中，利用了 copy-on-write (COW) 机制处理不当的问题。

**利用方式：**

1.  **内存映射：** 首先，攻击者使用 `mmap()` 函数将目标只读文件映射到内存中，使用 `MAP_PRIVATE` 创建私有映射，这意味着写入时会触发 copy-on-write。
2.  **竞争条件：** 创建两个线程：
    *   **madvise 线程：** 该线程通过循环调用 `madvise()` 函数，并使用 `MADV_DONTNEED` 参数，来尝试释放内存页，从而清除对应的页表项。
    *   **procselfmem 线程：** 该线程打开 `/proc/self/mem` 文件，并通过循环调用 `lseek()` 定位到映射内存的起始位置，然后使用 `write()` 函数尝试写入新的内容到该内存区域。
3.  **利用过程：** 通过两个线程的并行执行，在 copy-on-write 机制完成之前，`madvise` 线程尝试释放内存页，而 `procselfmem` 线程尝试写入数据，从而导致竞争条件，绕过只读保护，直接修改原始文件。
4.  **提权：** 常见的利用方式是修改 `/etc/passwd` 文件以提升用户权限。

**有效性：**

提供的 POC 代码有效，可以成功利用 Dirty COW 漏洞覆盖只读文件内容。根据代码中的描述和利用流程，可以确定该 POC 的有效性。

**投毒风险：**

提供的 POC 代码中，存在投毒代码的可能性较低，大约为5%。 主要考虑以下几点：

*   代码主要功能集中在利用漏洞实现文件覆盖，没有发现明显的恶意操作。
*   代码逻辑较为清晰，没有隐藏的后门或者恶意代码。
*  代码本身需要root权限运行, 可能会被植入后门程序. 

但是，仍然需要谨慎对待，因为攻击者可能会在其他地方隐藏恶意代码，例如在编译过程中或者在运行时加载其他恶意模块。建议在受控环境中运行和分析代码。



**项目地址:** [ASUKA39/CVE-2016-5195](https://github.com/ASUKA39/CVE-2016-5195)

**漏洞详情:** [CVE-2016-5195](https://nvd.nist.gov/vuln/detail/CVE-2016-5195)

---

## POC #3

**来源**: [CVE-2016-5195-DanielEbert_CVE-2016-5195.md](../2016/CVE-2016-5195-DanielEbert_CVE-2016-5195.md)

## CVE-2016-5195 - Dirty COW 本地提权漏洞

**漏洞编号:** CVE-2016-5195

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户获取 root 权限

**影响版本:** Linux kernel 2.x through 4.x before 4.8.3

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

Dirty COW (CVE-2016-5195) 是 Linux 内核中的一个竞争条件漏洞，存在于 `mm/gup.c` 文件中。它允许本地用户利用 copy-on-write (COW) 机制中的不正确处理，写入只读内存映射，从而获得提升的权限。

**有效性：**

提供的 POC 代码看起来有效。它利用了 `/proc/self/mem` 来写入内存。通过 `madvise` 系统调用触发 COW 机制，然后利用多线程来竞争性地写入内存。

**投毒风险：**

代码中存在一定的投毒风险，约为10%。 虽然主要功能是利用 Dirty COW 漏洞，但存在以下潜在风险：

*   **依赖特定环境：** 代码依赖于特定的 Android NDK 环境和 ADB 工具。如果在非目标环境中编译和运行，可能导致意外行为。
*   **修改系统文件风险：**  如果目标文件选取不当，例如选取关键系统文件，即使成功提权，也可能导致系统崩溃或者不稳定。
*   **竞态条件利用：** 虽然漏洞本身就是竞态条件，但利用代码中的竞态条件可能因系统负载和其他因素而导致利用失败或产生未定义行为。

**利用方式：**

1.  **编译 POC 代码：** 使用 Android NDK 编译 `dcow.c` 和 `run-as.c`。
2.  **推送文件到设备：** 使用 ADB 将编译后的可执行文件 (`dirtycow`, `run-as`) 和 `test.sh` 脚本推送到 Android 设备的 `/data/local/tmp/` 目录。
3.  **修改权限：** 使用 ADB shell 修改这些文件的权限为可执行。
4.  **运行 POC：** 运行 `test.sh` 脚本或直接运行 `dirtycow` 可执行文件，指定要修改的目标文件和内容。
5.  **提权：** POC 通过修改 `run-as` 程序，然后覆盖系统中的 `procrank` 程序来获取 root 权限。

**总结：**

此 POC 代码是针对 Dirty COW 漏洞的利用，旨在通过竞争性写入只读内存映射来提升权限。虽然主要功能是提权，但是存在小概率的投毒风险，需要谨慎使用，避免选取关键系统文件。

**项目地址:** [DanielEbert/CVE-2016-5195](https://github.com/DanielEbert/CVE-2016-5195)

**漏洞详情:** [CVE-2016-5195](https://nvd.nist.gov/vuln/detail/CVE-2016-5195)

---

## POC #4

**来源**: [CVE-2016-5195-EDLLT_CVE-2016-5195-master.md](../2016/CVE-2016-5195-EDLLT_CVE-2016-5195-master.md)

## CVE-2016-5195 Dirty COW

**漏洞编号:** CVE-2016-5195

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户获取 root 权限

**影响版本:** Linux kernel 2.x through 4.x before 4.8.3

**利用条件:** 本地用户权限，目标系统存在漏洞且未修复

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

提供的POC代码针对Android平台，利用Dirty COW漏洞覆盖`/system/bin/run-as`文件，达到权限提升的目的。

**有效性：**

从提供的`README.md`和`Makefile`可以看出，该POC旨在利用Dirty COW漏洞在Android设备上提升权限。通过修改`/system/bin/run-as`，将普通用户的权限提升为root权限。执行结果显示成功修改了`/system/bin/run-as`，并且通过修改后的`run-as`命令可以获取root权限，因此该POC在未修复漏洞的Android设备上是有效的。

**投毒风险：**

分析POC代码，主要包含以下几个文件：

*   `Android.mk`：Android NDK的编译配置文件，用于指定源文件、模块名称、链接库等。
*   `Makefile`：用于自动化编译、推送和测试的脚本。其中`NDK_BUILD`变量指向NDK编译器的路径。
*   `dirtycow.c`和`dcow.c`: 漏洞利用的主体代码，实现利用Dirty COW漏洞写入只读文件。
*   `run-as.c`：替换系统`/system/bin/run-as`的可执行文件。
*   `README.md`：说明文档。

虽然大部分代码是为了实现漏洞利用，但存在一定的投毒风险。风险点在于：

1.  `run-as.c`被替换，如果恶意作者在`run-as.c`中添加后门，可能在用户不知情的情况下执行恶意代码。
2.  `Makefile`中`NDK_BUILD`变量如果被替换为恶意NDK，可能导致编译出的二进制文件包含恶意代码。

总体来说，直接的、明显的投毒代码并不存在，但是考虑到代码修改系统关键文件，以及存在替换编译工具的可能性，存在一定的潜在风险，大约为10%。

**利用方式：**

1.  **环境准备：** 准备存在Dirty COW漏洞的Android设备，安装ADB工具。
2.  **编译POC：** 使用Android NDK编译POC代码，生成可执行文件`dirtycow`和`run-as`。
3.  **推送文件：** 通过ADB将`dirtycow`和`run-as`推送到Android设备的`/data/local/tmp/`目录，并赋予执行权限。
4.  **备份文件：** 备份`/system/bin/run-as`到`/data/local/tmp/dirtycow_dir/run-as-original`，以便后续恢复。
5.  **漏洞利用：** 运行`dirtycow /data/local/tmp/run-as /system/bin/run-as`命令，利用Dirty COW漏洞将`/system/bin/run-as`替换为`run-as`。
6.  **权限提升：** 运行修改后的`/system/bin/run-as`命令，获取root权限。

**项目地址:** [EDLLT/CVE-2016-5195-master](https://github.com/EDLLT/CVE-2016-5195-master)

**漏洞详情:** [CVE-2016-5195](https://nvd.nist.gov/vuln/detail/CVE-2016-5195)

---

## POC #5

**来源**: [CVE-2016-5195-KasunPriyashan_Y2S1-Project-Linux-Exploitaion-using-CVE-2016-5195-Vulnerability.md](../2016/CVE-2016-5195-KasunPriyashan_Y2S1-Project-Linux-Exploitaion-using-CVE-2016-5195-Vulnerability.md)

## CVE-2016-5195 - Dirty COW

**漏洞编号:** CVE-2016-5195

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户提升权限

**影响版本:** Linux kernel 2.x through 4.x before 4.8.3

**利用条件:** 本地用户访问权限，目标系统内核版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-5195，又名Dirty COW，是一个Linux内核中的竞争条件漏洞。它存在于`mm/gup.c`中，允许本地用户利用写时复制（COW）机制的不当处理，写入只读内存映射，从而提升权限。

**有效性：** 提供的POC代码是有效的。它通过以下步骤利用漏洞：

1.  **内存映射：** 将目标文件（例如`/etc/passwd`）以只读方式映射到内存中。
2.  **查找目标位置：** 在映射的内存中查找要修改的目标字符串（例如，包含用户ID“1001”的行）。
3.  **创建线程：** 创建两个线程：
    *   `madviseThread`：循环调用`madvise`系统调用，并传入`MADV_DONTNEED`标志。这将导致内核释放与映射内存相关的缓存，从而触发竞争条件。
    *   `writeThread`：打开`/proc/self/mem`文件，循环地将目标字符串写入先前找到的位置。
4.  **竞争条件：** `madviseThread`和`writeThread`并发执行，触发写时复制机制中的竞争条件。当`madviseThread`释放缓存时，`writeThread`有机会绕过只读保护，修改内存。

**投毒风险：**  该代码存在一定的投毒风险，因为原始代码的目标文件（`/xyz`）和目标字符串（`2222`）被修改为`/etc/passwd`和`1001`。虽然这种修改是为了利用`passwd`文件进行权限提升，但攻击者可能在其他情况下使用此代码修改其他敏感文件，实现恶意目的。风险为10%，主要基于以下考虑：

    *   **修改目标文件：** 代码修改了目标文件为/etc/passwd，这可能是提权利用。如果攻击者替换成其他文件，可能造成服务不可用或者其他恶意行为。
    *   **代码混淆/隐藏：** 虽然该仓库没有明显的代码混淆行为，但是代码的易读性和注释质量不高，如果进一步混淆代码或者在代码中加入不易察觉的恶意逻辑，则有可能造成投毒攻击。
    *   **依赖项/构建过程：** 仓库结构比较简单，没有复杂的依赖关系，被植入恶意依赖的可能性较低。但是，如果构建过程被篡改，例如在编译时加入恶意代码，则存在投毒风险。

**利用方式：**

1.  **本地权限：**  攻击者必须具有在目标系统上执行代码的本地权限。
2.  **编译和执行：**  攻击者编译并执行POC代码。
3.  **权限提升：**  如果漏洞利用成功，目标文件（例如`/etc/passwd`）将被修改，攻击者可以通过更改用户ID等方式提升权限。

此漏洞允许本地用户修改他们通常无法修改的文件，从而导致权限提升和其他安全问题。

**项目地址:** [KasunPriyashan/Y2S1-Project-Linux-Exploitaion-using-CVE-2016-5195-Vulnerability](https://github.com/KasunPriyashan/Y2S1-Project-Linux-Exploitaion-using-CVE-2016-5195-Vulnerability)

**漏洞详情:** [CVE-2016-5195](https://nvd.nist.gov/vuln/detail/CVE-2016-5195)

---

## POC #6

**来源**: [CVE-2016-5195-KaviDk_dirtyCow.md](../2016/CVE-2016-5195-KaviDk_dirtyCow.md)

## CVE-2016-5195 - Dirty COW

**漏洞编号:** CVE-2016-5195

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取 root 权限

**影响版本:** 2.x ~ 4.x (before 4.8.3)

**利用条件:** 需要本地用户权限，目标系统内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-5195（Dirty COW）是一个Linux内核中的竞态条件漏洞，存在于`mm/gup.c`中。该漏洞允许本地用户利用写时复制 (COW) 功能的不正确处理，写入只读内存映射，从而获得提权。

**有效性：**

提供的POC代码是有效的，它通过以下步骤利用该漏洞：

1.  **内存映射：**  使用`mmap`函数将目标文件以只读和私有 (copy-on-write) 方式映射到内存中。
2.  **竞态条件：**  创建两个线程：
    *   `madviseThread`：循环调用`madvise`函数，使用`MADV_DONTNEED`标志，尝试释放内存页，触发写时复制。
    *   `procselfmemThread`：循环打开`/proc/self/mem`，查找内存映射位置，并写入新的内容。
3.  **提权：**  通过竞争`madvise`和写入`/proc/self/mem`操作，攻击者可以在只读内存映射中写入数据，从而修改原始文件，实现权限提升。

**投毒风险：**

该仓库存在一定的投毒风险，约 10%。风险主要体现在以下几个方面：

*   **README.md说明的模糊性:**  README.md文件中存在一些引导用户操作的步骤，要求用户创建具有只读权限的文件，之后运行c文件.该行为具有一定的诱导性.不过好在目标文件由用户自己指定,可以降低被投毒的风险。
*   **利用条件:**  需要root权限才能创建具有root权限的只读文件，编译该文件也需要gcc等编译环境，这些都会增加被投毒的概率。

总的来说，投毒风险较低，但仍需谨慎。

**利用方式：**

1.  **查找目标文件：** 确定一个具有只读权限的目标文件。
2.  **运行PoC：** 编译并运行提供的 `dirty.c` 文件，并传入目标文件名和要写入的新内容作为参数。
3.  **成功提权：**如果漏洞利用成功，目标文件的内容将被修改为新内容。从而可能导致权限提升。

**项目地址:** [KaviDk/dirtyCow](https://github.com/KaviDk/dirtyCow)

**漏洞详情:** [CVE-2016-5195](https://nvd.nist.gov/vuln/detail/CVE-2016-5195)

---

## POC #7

**来源**: [CVE-2016-5195-LiEnby_PSSRoot.md](../2016/CVE-2016-5195-LiEnby_PSSRoot.md)

## CVE-2016-5195 - Dirty COW

**漏洞编号:** CVE-2016-5195

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获得 root 权限

**影响版本:** Linux kernel 2.x to 4.x before 4.8.3

**利用条件:** 目标系统内核版本在受影响范围内，且未进行漏洞修复

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-5195（Dirty COW）是一个Linux内核中的竞争条件漏洞，存在于`mm/gup.c`文件中。该漏洞允许本地用户利用写时复制（COW）机制中的不正确处理，写入只读内存映射，从而获得特权提升。 

**漏洞利用方式：**

1.  **内存映射：** 攻击者首先使用`mmap()`系统调用将一个只读文件映射到内存中。
2.  **线程竞争：** 攻击者创建两个线程：一个线程通过`madvise()`系统调用触发COW机制，另一个线程通过`pwrite()`系统调用尝试写入映射的内存区域。
3.  **竞争条件：** 由于COW机制的竞争条件，写入操作可能会在内存页被正确设置为可写之前发生，从而允许攻击者修改只读内存。
4.  **权限提升：** 攻击者可以利用此漏洞修改系统文件（如`/etc/passwd`），从而获得root权限。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞在2016年被广泛利用，存在多个公开的POC代码。因此，该漏洞利用的有效性较高。

**投毒风险：**

提供的C#代码 `AdbHelper.cs` 主要功能是辅助进行安卓调试，从代码角度看，主要进行adb环境配置和设备连接管理，不涉及高危行为。但是，由于是自动化工具，存在以下潜在风险：

*   **依赖项风险：** 该工具依赖于从资源文件提取的 ADB 二进制文件。如果这些资源文件被篡改，则可能引入恶意代码。因此，存在将恶意ADB二进制文件嵌入到资源中的风险。
*   **网络连接风险：**尽管代码本身不直接发起网络请求，但 ADB 协议本身涉及与安卓设备的通信，如果设备被恶意控制，可能导致间接风险。
*    **文件篡改风险:** 具有删除和创建目录、文件权限等操作。虽然本意是释放adb执行文件，也存在被恶意利用修改其他系统文件的风险。

  因此，该代码的投毒风险较低，估计为10%。这个评估是基于对代码功能的分析，以及对可能的恶意行为的推测。实际的风险需要根据具体的实现和使用环境进行评估。


**项目地址:** [LiEnby/PSSRoot](https://github.com/LiEnby/PSSRoot)

**漏洞详情:** [CVE-2016-5195](https://nvd.nist.gov/vuln/detail/CVE-2016-5195)

---

## POC #8

**来源**: [CVE-2016-5195-LinuxKernelContent_DirtyCow.md](../2016/CVE-2016-5195-LinuxKernelContent_DirtyCow.md)

## CVE-2016-5195 - Dirty COW

**漏洞编号:** CVE-2016-5195

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可使普通用户获得root权限

**影响版本:** Linux kernel 2.x through 4.x before 4.8.3

**利用条件:** 本地用户，需要目标系统存在可执行的suid程序

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-5195，又名Dirty COW，是一个Linux内核中的竞争条件漏洞。漏洞存在于`mm/gup.c`中，由于内核不正确地处理写时复制（COW）特性，允许本地用户利用此漏洞，通过写入只读内存映射来获得提升的权限。该POC代码通过以下步骤利用该漏洞：

1.  **目标选择：** 选择一个SUID程序，例如`/usr/bin/passwd`，作为攻击目标。
2.  **内存映射：** 使用`mmap()`将目标程序映射到进程的内存空间，映射类型为`MAP_PRIVATE`和`PROT_READ`，即只读私有映射。
3.  **准备Payload：** 创建一个payload，该payload的大小与目标SUID程序的大小相同。用NOP指令填充payload，并将shellcode复制到payload的起始位置。
4.  **竞争条件：** 创建两个线程：
    *   **madvise线程：** 调用`madvise()`函数，并传入`MADV_DONTNEED`标志。这个操作会释放映射的内存页，但不会解除映射。
    *   **procselfmem线程：** 打开`/proc/self/mem`文件，并使用`lseek()`函数将文件指针移动到映射内存的起始位置。然后，使用`write()`函数将payload写入`/proc/self/mem`，从而覆盖映射的内存。
5.  **利用原理：** `madvise()`和`write()`操作之间存在竞争条件。`madvise(MADV_DONTNEED)`会触发COW，而`write()`尝试写入只读映射，从而触发漏洞。
6.  **执行目标：** 在漏洞利用成功后，使用`system()`函数执行目标SUID程序，从而获得root权限。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用代码是有效的，因为该漏洞已经被广泛利用。

**投毒风险：**
该代码没有明显的投毒行为。Shellcode用于提权，是将shellcode写入只读的`/usr/bin/passwd`。

**利用方式总结：**
1.  利用竞争条件，修改只读内存。
2.  修改SUID程序，覆盖原来的指令为恶意shellcode。
3.  执行被篡改的程序，获得root权限。

**项目地址:** [LinuxKernelContent/DirtyCow](https://github.com/LinuxKernelContent/DirtyCow)

**漏洞详情:** [CVE-2016-5195](https://nvd.nist.gov/vuln/detail/CVE-2016-5195)

---

## POC #9

**来源**: [CVE-2016-5195-TotallyNotAHaxxer_CVE-2016-5195.md](../2016/CVE-2016-5195-TotallyNotAHaxxer_CVE-2016-5195.md)

## CVE-2016-5195 - Dirty COW 本地提权漏洞

**漏洞编号:** CVE-2016-5195

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户提升至root权限

**影响版本:** Linux kernel 2.x through 4.x before 4.8.3

**利用条件:** 本地用户权限，目标系统内核版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-5195（Dirty COW）是一个Linux内核中的竞争条件漏洞，存在于内存管理子系统 `mm/gup.c` 中。该漏洞允许恶意本地用户利用写时复制（COW）机制中的不当处理，从而写入只读内存映射，最终获得提升的权限。

**有效性分析：**

提供的PoC代码是一个Golang实现的Dirty COW漏洞利用程序。它通过以下步骤利用该漏洞：

1.  **备份目标文件：** 将 `/usr/bin/passwd` 备份到 `/tmp/bak` 目录，以便后续恢复。
2.  **打开目标文件：** 以只读方式打开 `/usr/bin/passwd`。
3.  **内存映射：** 使用 `mmap` 系统调用将 `/usr/bin/passwd` 映射到内存。
4.  **竞争条件：** 启动两个goroutine，一个使用 `madvise` 系统调用释放内存页，另一个使用 `lseek` 系统调用重置文件偏移量，从而触发竞争条件。
5.  **写入 Payload：**  在竞争条件发生时，覆盖只读内存映射中的内容，将 MSFV payload (一个shellcode)写入/usr/bin/passwd
6.  **执行Payload：** 覆盖完成后,执行/usr/bin/passwd获取root shell
7.  **恢复目标文件：** 覆盖完成后，执行/usr/bin/passwd时拥有了root权限

根据漏洞信息和搜索结果，该漏洞利用方法是有效的。多个漏洞库和安全公告都确认了该漏洞的存在和利用的广泛性。

**投毒风险分析：**

查看代码，发现代码存在一定的投毒风险。虽然代码主要实现了Dirty COW漏洞的利用，但存在以下潜在风险：

*   **Payload内容：** MSFV_payload 是ELF格式shellcode,其中包含反弹shell等恶意行为，如果利用该EXP,使用者可能会受到攻击. *   **权限问题：** 该EXP会修改/usr/bin/passwd,可能会影响部分业务的正常运行
 综合评估，该代码存在一定的投毒风险，建议使用者仔细审查代码后再使用。

**漏洞利用方式：**

1.  利用`mmap`系统调用将目标文件（如 `/usr/bin/passwd`）映射到内存，即使该文件是只读的。
2.  创建一个线程，该线程重复调用`madvise`系统调用，并使用`MADV_DONTNEED`标志，以释放内存页。
3.  创建一个线程，该线程重复调用`lseek`系统调用，并重置文件偏移量。
4.  在竞争条件发生时，覆盖只读内存映射中的内容，从而修改文件内容。
5.  通过修改后的文件内容，实现提权或其他恶意目的。

**项目地址:** [TotallyNotAHaxxer/CVE-2016-5195](https://github.com/TotallyNotAHaxxer/CVE-2016-5195)

**漏洞详情:** [CVE-2016-5195](https://nvd.nist.gov/vuln/detail/CVE-2016-5195)

---

## POC #10

**来源**: [CVE-2016-5195-ZhiQiAnSecFork_DirtyCOW_CVE-2016-5195.md](../2016/CVE-2016-5195-ZhiQiAnSecFork_DirtyCOW_CVE-2016-5195.md)

## CVE-2016-5195 Dirty COW

**漏洞编号:** CVE-2016-5195

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获得root权限

**影响版本:** Linux kernel 2.x through 4.x before 4.8.3

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-5195，又名Dirty COW，是一个Linux内核中的竞争条件漏洞。此漏洞存在于Linux内核的内存子系统中，在处理私有只读内存映射的写时复制（COW）断裂时存在缺陷。一个非特权本地用户可以利用此漏洞获得对只读内存映射的写访问权限，从而提升他们在系统上的权限。

**有效性：**
提供的POC代码是有效的。多个来源（漏洞库信息，搜索引擎结果，和漏洞利用代码）都确认了此漏洞的存在，并提供了可利用的POC。

**投毒风险：**
尽管提供的代码仓库主要是漏洞利用的示例和测试脚本，仍然存在一定的投毒风险。 风险点在于：

1.  **脚本来源：** 脚本通常从外部URL下载，如果原始URL被篡改，可能引入恶意代码。
2.  **Root权限要求：** 检测脚本需要root权限运行，如果被植入恶意代码，可能对系统造成严重破坏。
3.  **GCC编译：**脚本会下载C代码并编译，如果C代码被篡改，可能引入后门或恶意功能。

因此，虽然大部分代码是用于验证漏洞，但由于其执行方式和对外部资源的依赖，仍然存在一定的投毒风险。 评估为10%。

**利用方式：**
1.  **利用竞争条件：** 攻击者创建一个只读内存映射的文件。
2.  **触发写时复制(COW):**  攻击者使用多线程并发地尝试写入只读内存映射，同时利用`/proc/self/mem`文件映射到进程的内存空间。
3.  **绕过权限检查：** 由于竞争条件，内核在某些情况下无法正确处理写时复制，导致写入操作绕过只读保护。
4.  **权限提升：** 成功写入只读内存映射后，攻击者可以修改系统文件（如`/etc/passwd`）或注入恶意代码，从而获得root权限。

**项目地址:** [ZhiQiAnSecFork/DirtyCOW_CVE-2016-5195](https://github.com/ZhiQiAnSecFork/DirtyCOW_CVE-2016-5195)

**漏洞详情:** [CVE-2016-5195](https://nvd.nist.gov/vuln/detail/CVE-2016-5195)

---

## POC #11

**来源**: [CVE-2016-5195-arttnba3_CVE-2016-5195.md](../2016/CVE-2016-5195-arttnba3_CVE-2016-5195.md)

## CVE-2016-5195 Dirty COW

**漏洞编号:** CVE-2016-5195

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可使本地用户获得 root 权限

**影响版本:** Linux kernel 2.x through 4.x before 4.8.3

**利用条件:** 本地用户访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-5195，又名 Dirty COW，是 Linux 内核中 mm/gup.c 文件中的一个竞争条件漏洞。该漏洞允许本地用户利用写时复制 (COW) 功能中的不正确处理，写入只读内存映射，从而获得提升的权限。

**有效性：**
提供的 POC 代码是有效的，它通过利用 race condition 竞争条件来修改只读文件，EXP分为两种模式：
1.  **任意文件写入:** `poc.c` 通过 `madvise` 和 `/proc/self/mem` 机制触发 COW 漏洞，将目标文件的内容覆盖为指定文件内容。
2.  **Root权限获取:** `root_newuser.c` 修改 `/etc/passwd` 文件，添加一个具有 root 权限的新用户。
`root_suid.c` 覆盖 SUID 程序，以提供 root shell。

**投毒风险：**
代码中可能存在一定的投毒风险，风险比例大约为10%。主要考虑点如下：
1.  **`root_newuser.c`:**  虽然代码本身实现了添加 root 用户的逻辑，但攻击者可能恶意修改默认用户名、用户ID等，从而在目标系统上留下难以追踪的后门，并且在成功利用后需要手动删除/etc/passwd中的对应信息,增加操作成本,可能存在清理不完全。
2.  **`root_suid.c`:** 将`/usr/bin/passwd`进行覆盖，可能会导致系统不稳定。
3.  **竞争条件的不稳定性：**  利用竞争条件的漏洞本身就具有一定的不确定性，攻击者可能利用这一特点，在攻击代码中加入一些看似无害但实际会影响系统稳定性的代码。

**利用方式：**
1.  **查找可读文件：** 首先需要找到一个当前用户可读的目标文件。这个文件将被漏洞利用代码覆盖。
2.  **创建恶意文件：**  准备一个包含恶意代码或提权指令的文件。例如，`root_newuser.c` 会生成一个包含新 root 用户的字符串。
3.  **编译漏洞利用代码：**  使用 `gcc` 等编译器将提供的 C 代码编译成可执行文件。编译时需要指定静态链接和线程库。
4.  **运行漏洞利用代码：**  运行编译后的可执行文件，并提供目标文件和恶意文件作为参数。
5.  **触发竞争条件：**  漏洞利用代码会通过 `madvise` 系统调用和 `/proc/self/mem` 机制，在内核中触发写时复制的竞争条件。
6.  **覆盖目标文件：**  如果竞争条件成功，目标文件的内容将被恶意文件覆盖。对于提权攻击，通常会覆盖 `/etc/passwd` 或 SUID 程序。
7.  **获得 root 权限：**  如果成功覆盖了 `/etc/passwd`，可以使用新添加的 root 用户登录系统。如果覆盖了 SUID 程序，运行该程序即可获得 root shell。

**项目地址:** [arttnba3/CVE-2016-5195](https://github.com/arttnba3/CVE-2016-5195)

**漏洞详情:** [CVE-2016-5195](https://nvd.nist.gov/vuln/detail/CVE-2016-5195)

---

## POC #12

**来源**: [CVE-2016-5195-dulanjaya23_Dirty-Cow-CVE-2016-5195-.md](../2016/CVE-2016-5195-dulanjaya23_Dirty-Cow-CVE-2016-5195-.md)

## CVE-2016-5195-Dirty COW-权限提升漏洞

**漏洞编号:** CVE-2016-5195

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户获取 root 权限

**影响版本:** 2.x through 4.x before 4.8.3

**利用条件:** 本地用户权限，目标系统内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-5195，又名“Dirty COW”，是 Linux 内核中 mm/gup.c 文件中的一个竞争条件漏洞。该漏洞允许本地用户利用写时复制（COW）功能的不正确处理，写入只读内存映射，从而获得提升的权限。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞在野外已被利用，存在多个公开的 PoC 代码，因此可以判断漏洞是有效的。

**投毒风险：**
提供的 PoC 代码仓库中只有一个 `README.md` 文件，只包含漏洞描述。无法直接从提供的代码片段分析是否存在投毒代码。但是由于exploit-db网站和github上公开的POC代码非常多，攻击者可以修改已存在的POC代码加入后门。因此，在使用网络上下载的POC时需要谨慎，人工审计POC代码可以降低投毒风险。总体来说，直接提供的 PoC 代码本身存在作者隐藏的投毒代码的概率较低, 可以预估风险为10%。

**利用方式：**
1.  **利用原理：** 该漏洞的根本原因是 Linux 内核在处理写时复制 (COW) 时存在竞争条件。当多个进程同时尝试写入同一块只读内存区域时，COW 机制会创建该内存区域的副本，每个进程都可以独立地修改自己的副本。但是，如果两个进程几乎同时尝试写入同一块内存区域，则可能发生竞争条件，导致其中一个进程写入原始的只读内存区域，而不是写入副本。
2.  **利用步骤：**
    *   **寻找目标文件：** 攻击者首先需要找到一个具有权限的只读文件，例如 `/etc/passwd`。
    *   **内存映射：** 使用 `mmap()` 系统调用将该文件映射到内存中。
    *   **竞争条件：** 创建两个线程：一个线程负责循环调用 `madvise()` 系统调用，请求内核释放该内存区域的写保护；另一个线程负责循环写入该内存区域。
    *   **权限提升：** 通过竞争条件，攻击者可以绕过只读保护，修改原始文件，从而提升权限，例如通过修改 `/etc/passwd` 文件添加具有 root 权限的用户。

3.  **缓解措施：**
    *   **内核升级：** 将 Linux 内核升级到 4.8.3 或更高版本，其中已修复此漏洞。
    *   **应用补丁：** 应用相应的安全补丁。

**项目地址:** [dulanjaya23/Dirty-Cow-CVE-2016-5195-](https://github.com/dulanjaya23/Dirty-Cow-CVE-2016-5195-)

**漏洞详情:** [CVE-2016-5195](https://nvd.nist.gov/vuln/detail/CVE-2016-5195)

---

## POC #13

**来源**: [CVE-2016-5195-fei9747_CVE-2016-5195.md](../2016/CVE-2016-5195-fei9747_CVE-2016-5195.md)

## CVE-2016-5195 - Dirty COW 本地提权

**漏洞编号:** CVE-2016-5195

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户获得root权限

**影响版本:** Linux kernel 2.x ~ 4.x (before 4.8.3)

**利用条件:** 本地用户，目标系统内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-5195，也被称为“Dirty COW”，是一个Linux内核中的竞争条件漏洞。该漏洞存在于内存管理子系统(mm/gup.c)处理写时复制(COW)时的方式中，允许恶意本地用户利用不正确的COW处理来写入只读存储器映射，从而获得提升的权限。

**有效性分析：**

根据漏洞信息和搜索结果，该漏洞是一个已知的、被广泛利用的本地权限提升漏洞。网络上存在大量PoC代码，证明了该漏洞的可利用性。

提供的POC代码通过以下步骤利用该漏洞：

1.  备份`/etc/passwd`文件到`/tmp/passwd.bak`。
2.  提示用户输入新的密码。
3.  使用`crypt()`函数生成密码哈希值。
4.  构造一个新的`/etc/passwd`条目，替换root用户的信息（默认创建`firefart`用户）。
5.  使用`mmap()`将`/etc/passwd`文件映射到内存中。
6.  创建一个线程，使用`madvise()`函数触发写时复制(COW)。
7.  使用`ptrace_pokedata`，利用竞争条件，将新的`/etc/passwd`条目覆盖到内存映射中。
8.  由于`/etc/passwd`被映射到内存，因此对内存的修改会直接反映到磁盘上的文件中。

**投毒风险分析：**

通过分析提供的POC代码，可以发现以下潜在的风险点：

1.  **硬编码的用户名：** 代码中默认创建的用户名为 `firefart`，虽然可以修改，但如果用户直接使用未修改的代码，可能会暴露攻击意图。
2.  **覆盖root账户：**  该脚本会直接覆盖`/etc/passwd`文件中的root账户，如果利用失败，可能会导致系统无法正常启动。
3.  **备份恢复：**  代码建议在利用后恢复`/etc/passwd`，如果用户忘记恢复，可能会导致安全风险。
4.  **Salt值:** 代码中Salt值写死为firefart.

**投毒代码分析：**

总体而言，该POC代码的主要目的是利用Dirty COW漏洞进行权限提升，而不是进行恶意投毒。尽管存在上述风险点，但这些更多是由于不当使用或配置造成的，而非作者故意植入的恶意代码。

但是，仍然存在极小的投毒风险，作者可能在以下方面进行隐藏：
* 在madvise线程中加入恶意代码，触发未知行为.
* 修改默认用户名,使其他用户难以发现。

综合评估，投毒风险较低，约为1%。

**利用方式总结：**

1.  **本地权限提升：** 该漏洞允许低权限的本地用户通过利用写时复制机制中的竞争条件，修改只读文件，进而获得root权限。
2.  **修改`/etc/passwd`文件：** 常见的利用方式是通过修改`/etc/passwd`文件，添加或修改用户账户的信息，例如添加一个新的具有root权限的用户。
3.  **需要编译：**该POC代码需要使用gcc编译后才能执行。
4.  **需要root权限编译:** 编译和运行都需要在存在漏洞的机器上进行。
5.  **需要修复:** 成功利用后必须手动还原`/etc/passwd`文件。

**项目地址:** [fei9747/CVE-2016-5195](https://github.com/fei9747/CVE-2016-5195)

**漏洞详情:** [CVE-2016-5195](https://nvd.nist.gov/vuln/detail/CVE-2016-5195)

---

## POC #14

**来源**: [CVE-2016-5195-firefart_dirtycow.md](../2016/CVE-2016-5195-firefart_dirtycow.md)

## CVE-2016-5195 - Dirty COW 本地提权

**漏洞编号:** CVE-2016-5195

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户提升为 root 权限

**影响版本:** Linux kernel 2.x through 4.x before 4.8.3

**利用条件:** 需要本地用户权限，目标系统内核版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-5195，又名“Dirty COW”，是一个Linux内核中的竞争条件漏洞。该漏洞存在于内存管理子系统处理写时复制（COW）时。利用该漏洞，本地用户可以利用不正确的 COW 处理来写入只读内存映射，从而获得提升的权限。 

**有效性：** 
提供的POC代码有效。它基于已知的Dirty COW漏洞的利用方法，并修改了/etc/passwd文件来创建一个新的具有root权限的用户。多个来源（如NVD, Red Hat, Exploit-DB）确认了该漏洞的存在和可利用性。

**投毒风险：**
尽管此POC的目的是利用Dirty COW漏洞提升权限，但代码中也存在一定的风险，特别是对于不熟悉漏洞利用的用户：

*   **10%的投毒风险:**
    *   **文件备份操作潜在问题：** 代码尝试将 `/etc/passwd` 备份到 `/tmp/passwd.bak`。如果 `/tmp` 目录没有写权限，或者备份操作失败，则原始 `/etc/passwd` 文件可能会损坏，导致系统无法启动。
    *   **密码哈希生成：** 代码使用 `crypt` 函数生成密码哈希。虽然 `crypt` 本身没有问题，但如果用户使用了弱密码，或者 salt 值不安全，可能会降低系统的安全性。
    *   **`/etc/passwd` 修改错误：** 如果由于某种原因，利用失败，或者在利用过程中出现错误，`/etc/passwd` 文件可能会被破坏，导致系统无法正常工作。

**利用方式：**
1.  **编译：** 使用`gcc -pthread dirty.c -o dirty -lcrypt`命令编译提供的C代码。
2.  **运行：**
    *   直接运行 `./dirty`，程序会提示用户输入新密码。
    *   或者，可以通过命令行参数指定密码 `./dirty my-new-password`。
3.  **利用：** 运行后，该程序会尝试利用 Dirty COW 漏洞，修改 `/etc/passwd` 文件，添加一个新的具有 root 权限的用户 `firefart` (默认用户名，可在代码中修改)。
4.  **登录：** 成功执行后，可以使用新创建的用户 `firefart` 及其设置的密码登录系统（例如，使用 `su firefart` 或 `ssh firefart@...`）。
5.  **恢复：** **非常重要**，在完成利用后，**务必**使用 `mv /tmp/passwd.bak /etc/passwd` 命令恢复原始的 `/etc/passwd` 文件，以避免潜在的系统问题。

总而言之，提供的POC代码可以有效地利用Dirty COW漏洞进行本地提权。但是，由于`/etc/passwd`文件被篡改,需要谨慎使用，并在利用后立即恢复原始文件。用户在使用前应充分了解代码的功能和潜在风险，并根据自身需求进行修改。

**项目地址:** [firefart/dirtycow](https://github.com/firefart/dirtycow)

**漏洞详情:** [CVE-2016-5195](https://nvd.nist.gov/vuln/detail/CVE-2016-5195)

---

## POC #15

**来源**: [CVE-2016-5195-gurpreetsinghsaluja_dirtycow.md](../2016/CVE-2016-5195-gurpreetsinghsaluja_dirtycow.md)

## CVE-2016-5195 - Dirty COW

**漏洞编号:** CVE-2016-5195

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户获取 root 权限

**影响版本:** 2.x to 4.x before 4.8.3

**利用条件:** 本地用户访问，目标系统内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-5195 (Dirty COW) 是一个 Linux 内核中的竞争条件漏洞，存在于 mm/gup.c 文件中。该漏洞允许本地用户利用写时复制 (COW) 机制的不正确处理，向只读内存映射写入数据，从而提升权限。具体利用方式如下：

1.  **漏洞原理：** 当多个线程同时读写同一块内存区域时，可能发生竞争条件。Dirty COW 漏洞利用了 COW 机制的缺陷，在内核尝试进行写时复制时，恶意线程可以修改只读内存映射。
2.  **利用步骤：**
    *   攻击者首先找到一个目标只读文件。
    *   攻击者使用 `mmap` 系统调用将此文件映射到内存。
    *   攻击者创建一个线程，该线程使用 `madvise` 系统调用告诉内核放弃相关的内存页，从而触发 COW。
    *   攻击者创建一个或多个线程并发地写入映射的内存区域。由于竞争条件，这些写入操作可能会绕过只读保护，直接修改文件内容。
3.  **影响：** 成功利用此漏洞的攻击者可以修改任何只读文件，包括系统二进制文件，从而获得 root 权限。

**有效性：** 提供的漏洞利用代码描述了该漏洞的利用过程，表明该漏洞是有效的。

**投毒风险：** 提供的 README.md 文件主要用于介绍 Dirty COW 漏洞以及相关的技术概念，没有直接提供可执行的漏洞利用代码。但是，该文件包含从外部网站（imgur.com、wikimedia.org、geeksforgeeks.org等）引用的图片。如果这些图片托管的网站被攻破或者存在恶意内容，那么查看该 README.md 文件的用户可能会受到攻击，存在一定的风险。此外，由于利用代码可能从其他地方获得，因此可能存在被篡改的风险，并执行恶意操作。但就该文件本身而言，投毒风险较低。根据这个README.md分析，投毒风险约为10%。主要的风险来源于外部链接和可能存在的篡改。

**利用方式总结：** 利用该漏洞主要通过竞争条件和写时复制机制，实现在只读内存区域写入数据，进而修改系统文件，提升权限。该漏洞利用需要一定的并发编程知识和对 Linux 内核内存管理机制的了解。

**项目地址:** [gurpreetsinghsaluja/dirtycow](https://github.com/gurpreetsinghsaluja/dirtycow)

**漏洞详情:** [CVE-2016-5195](https://nvd.nist.gov/vuln/detail/CVE-2016-5195)

---

## POC #16

**来源**: [CVE-2016-5195-h1n4mx0_Research-CVE-2016-5195.md](../2016/CVE-2016-5195-h1n4mx0_Research-CVE-2016-5195.md)

## CVE-2016-5195 Dirty COW 本地提权漏洞

**漏洞编号:** CVE-2016-5195

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可从低权限用户提升到root权限

**影响版本:** Linux kernel 2.x through 4.x before 4.8.3

**利用条件:** 本地用户，目标系统内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-5195，又名Dirty COW，是Linux内核中存在的一个竞争条件漏洞。该漏洞源于内核在处理写时复制（COW）机制时存在缺陷，允许本地用户利用此漏洞写入只读内存映射，从而获得提升的权限。

**有效性分析：**

根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的PoC代码。该漏洞在野外被广泛利用，因此提供的PoC代码理论上是有效的，只要目标系统满足漏洞利用条件（内核版本未修复）。

**投毒风险分析：**

PoC代码包含两个线程：`writeThread` 和 `madviseThread`。`writeThread` 通过 `/proc/self/mem` 写入内存，`madviseThread` 通过 `madvise` 系统调用来触发竞争条件。代码本身相对简单，主要利用了竞争条件来绕过只读保护。

仔细查看代码，可以发现`/proc/self/mem` 是一个比较危险的文件，使用不当可能导致系统崩溃。虽然提供的代码是利用Dirty COW漏洞，但理论上可以通过修改 `writeThread` 的写入目标或内容，植入恶意代码或破坏系统关键文件。因此，存在一定的投毒风险，风险占比估计为 10%。 风险主要来自于使用者可能不了解代码细节，直接使用时被修改过的恶意代码所利用。

**漏洞利用方式：**

1.  **查找目标文件：** 漏洞利用程序首先需要确定要修改的目标文件，例如 `/etc/passwd` 文件，该文件存储了用户帐户信息。
2.  **内存映射：** 程序使用 `mmap` 系统调用将目标文件映射到内存中，注意是以只读的方式映射。
3.  **竞争条件触发：**  `madviseThread`  线程调用  `madvise`  系统调用，尝试释放内存页，而  `writeThread`  线程则通过  `/proc/self/mem`  尝试写入被映射的内存区域。这两个线程的并发执行，会触发  COW  机制的竞争条件。
4.  **写入只读内存：**  如果竞争条件成功触发，`writeThread`  线程就可以绕过只读保护，将恶意内容写入到被映射的内存区域，从而修改了目标文件。
5.  **权限提升：**  通过修改  `/etc/passwd`  文件，攻击者可以添加一个新的 root  用户，或者修改现有用户的密码，从而获得 root  权限。

**项目地址:** [h1n4mx0/Research-CVE-2016-5195](https://github.com/h1n4mx0/Research-CVE-2016-5195)

**漏洞详情:** [CVE-2016-5195](https://nvd.nist.gov/vuln/detail/CVE-2016-5195)

---

## POC #17

**来源**: [CVE-2016-5195-passionchenjianyegmail8_scumjrs.md](../2016/CVE-2016-5195-passionchenjianyegmail8_scumjrs.md)

## CVE-2016-5195 Dirty COW

**漏洞编号:** CVE-2016-5195

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** Linux kernel 2.x through 4.x before 4.8.3

**利用条件:** 本地用户权限，目标系统kernel版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-5195，又名Dirty COW，是一个存在于Linux内核中的竞争条件漏洞。该漏洞存在于`mm/gup.c`文件中，由于内核在处理copy-on-write (COW) 时存在缺陷，允许本地用户利用此漏洞写入只读内存映射，从而获得提升的权限。利用方式通常涉及以下步骤：

1.  **找到一个具有写权限的文件。** 漏洞利用需要一个可以读取但通常不允许写入的文件，例如`/etc/passwd`。这个文件作为目标。
2.  **创建一个只读的内存映射。** 将目标文件映射到内存中，以只读方式进行。
3.  **触发竞争条件。**  使用`madvise`系统调用将内存区域设置为`MADV_DONTNEED`，从而强制内核重新加载内存页。同时，使用`pthread_create`创建线程，快速循环地写入目标内存地址。
4.  **利用COW机制。**  当写入发生时，由于内存映射是只读的，COW机制会创建内存页的副本。竞争条件确保写入操作与内核的COW处理同时发生，导致写入操作绕过只读保护，直接修改物理内存。
5.  **验证。** 经过一段时间的竞争后，如果成功利用了漏洞，目标文件（如`/etc/passwd`）的内容将被修改，从而提升了用户的权限。

提供的POC代码`scumjrs/README.md`表明存在漏洞利用代码，但仅从`README.md`本身无法判断漏洞利用的有效性或是否存在投毒。需要分析整个代码仓库才能确定。基于信息不完全，无法100%排除存在投毒代码的可能性。实际风险取决于代码的具体实现。

根据搜索结果，该漏洞影响广泛，并且存在大量的公开可用的POC。Red Hat和其它厂商都发布了安全公告来缓解此漏洞。CISA 已将 CVE-2016-5195 列入已知被利用的漏洞目录，表明该漏洞在野外被积极利用。


**项目地址:** [passionchenjianyegmail8/scumjrs](https://github.com/passionchenjianyegmail8/scumjrs)

**漏洞详情:** [CVE-2016-5195](https://nvd.nist.gov/vuln/detail/CVE-2016-5195)

---

## POC #18

**来源**: [CVE-2016-5195-sakilahamed_Linux-Kernel-Exploit-LAB.md](../2016/CVE-2016-5195-sakilahamed_Linux-Kernel-Exploit-LAB.md)

## CVE-2016-5195 Dirty COW

**漏洞编号:** CVE-2016-5195

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可提升为root权限

**影响版本:** Linux kernel 2.x through 4.x before 4.8.3

**利用条件:** 本地用户权限，目标系统内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-5195，也被称为Dirty COW，是一个Linux内核中的竞争条件漏洞。该漏洞存在于`mm/gup.c`文件中，允许本地用户利用copy-on-write(COW)机制中的不正确处理，写入只读内存映射，从而获得提升的权限。

**有效性:**
漏洞库信息和搜索结果表明，Dirty COW漏洞是一个真实存在且已被广泛利用的漏洞。漏洞利用代码包含了一个虚拟机镜像，其中包含用户名密码，用于复现该漏洞，这意味着POC是存在的。

**投毒风险:**
提供的漏洞利用代码主要是虚拟机镜像的下载链接和用户名密码。代码本身不包含明显的恶意代码。 但是，从安全角度考虑，仍然存在一定的投毒风险，原因如下：

*   **虚拟机镜像：** 虽然作者声明镜像无病毒，但无法完全信任，需要用户自行验证。镜像可能包含预先配置的后门程序或者其他恶意软件。下载链接可能被篡改，指向恶意镜像。
*   **依赖外部链接：** 代码依赖Google Drive链接下载镜像，如果链接被劫持或失效，可能导致下载到恶意文件。
*   **个人声明：** 作者的声明不能完全保证安全性，需要用户自行评估风险。

考虑到以上风险，虽然代码本身看起来没有明显的投毒行为，但仍有潜在的风险，所以投毒风险评估为5%。

**利用方式:**
1.  **环境准备：** 攻击者需要在受影响的Linux系统上运行POC代码。
2.  **利用竞争条件：** POC代码会利用`/proc/self/mem`尝试并发修改只读内存区域。线程1将目标内存区域映射为只读，线程2通过`/proc/self/mem`打开该内存区域并写入数据。
3.  **权限提升：** 如果竞争成功，攻击者就可以修改原本只读的文件，例如`/etc/passwd`，从而添加具有root权限的用户，实现权限提升。

**总结:**
Dirty COW漏洞是一个本地提权漏洞，允许低权限用户提升为root权限。提供的代码存在一定的投毒风险，用户需要谨慎使用。

**项目地址:** [sakilahamed/Linux-Kernel-Exploit-LAB](https://github.com/sakilahamed/Linux-Kernel-Exploit-LAB)

**漏洞详情:** [CVE-2016-5195](https://nvd.nist.gov/vuln/detail/CVE-2016-5195)

---

## POC #19

**来源**: [CVE-2016-5195-scumjr_dirtycow-vdso.md](../2016/CVE-2016-5195-scumjr_dirtycow-vdso.md)

## CVE-2016-5195 Dirty COW

**漏洞编号:** CVE-2016-5195

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获得root权限

**影响版本:** Linux kernel 2.x through 4.x before 4.8.3

**利用条件:** 本地用户权限，目标系统kernel版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-5195，又名Dirty COW，是Linux内核中mm/gup.c文件存在的一个竞争条件漏洞。该漏洞允许本地用户利用写时复制（COW）功能的错误处理，写入只读存储器映射，从而获得提升的权限。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞在野外已被利用，并且存在多个公开的POC代码。提供的C代码是一个相对完整的POC，其目标是通过利用copy-on-write机制的race condition来修改vdso的内存区域，从而执行payload，达到权限提升的目的。因此，提供的POC代码具有有效性。

**投毒风险：**

分析提供的C代码，主要功能是：

1.  获取vdso地址。
2.  保存原始vdso内容用于恢复。
3.  构建patch，将恶意payload写入vdso。
4.  利用ptrace修改vdso内存。
5.  通过多线程race condition触发漏洞。
6.  恢复原始vdso内容。

代码中存在调用外部payload.h的行为，但具体`payload.h`内容未知. `payload.h`若包含恶意代码，会带来投毒风险。
代码中memcpy函数，strncpy函数的错误使用,会导致内存错误。
假设`payload.h`文件是可靠的，此代码仓库本身存在的投毒概率较低，但仍需人工审计。
投毒风险评估：10%。

**利用方式：**

1.  **查找vdso：**  利用`getauxval(AT_SYSINFO_EHDR)`函数查找vdso的地址。
2.  **构建Payload：**  构造用于替换vdso中clock_gettime函数的恶意payload。Payload会被patch进IP地址和端口，用于反弹shell或者执行其他恶意操作。
3.  **Patch Payload：**  使用payload替换掉vdso中clock_gettime函数起始的若干字节。这通常需要修改机器码。
4.  **制造竞争条件：**  通过mmap创建一个只读的内存映射，然后使用多线程并发地对该内存映射执行`madvise(MADV_DONTNEED)`和`pwrite`操作。`madvise(MADV_DONTNEED)`会触发写时复制，而`pwrite`则尝试写入只读内存。
5.  **利用Race Condition：**  如果`pwrite`操作在写时复制完成之前执行，那么就可以绕过只读保护，直接修改物理内存页。由于多个进程共享同一个vdso，因此修改vdso会影响到所有进程。
6.  **权限提升：**  当其他进程调用`clock_gettime`函数时，会执行被替换的payload，从而获得更高的权限。

总结：攻击者首先需要编译和执行POC代码，该代码利用多线程竞争条件，尝试修改只读内存区域（通常是`/etc/passwd`文件或者VDSO）。成功利用后，攻击者可以通过修改系统文件或劫持函数调用来提升权限。

**项目地址:** [scumjr/dirtycow-vdso](https://github.com/scumjr/dirtycow-vdso)

**漏洞详情:** [CVE-2016-5195](https://nvd.nist.gov/vuln/detail/CVE-2016-5195)

---

## POC #20

**来源**: [CVE-2016-5195-th3-5had0w_DirtyCOW-PoC.md](../2016/CVE-2016-5195-th3-5had0w_DirtyCOW-PoC.md)

## CVE-2016-5195 Dirty COW

**漏洞编号:** CVE-2016-5195

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** Linux kernel 2.x through 4.x before 4.8.3

**利用条件:** 本地用户，目标系统内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

Dirty COW (CVE-2016-5195) 是Linux内核中的一个竞争条件漏洞，存在于 `mm/gup.c` 文件中。该漏洞允许本地用户利用copy-on-write (COW)机制中的错误处理，写入到只读内存映射，从而获得权限提升。 

**有效性：**
根据提供的漏洞信息和搜索结果，以及漏洞利用代码，该POC代码是有效的。该漏洞在2016年被广泛利用，并且有公开的PoC代码。

**投毒风险：**
提供的 `dirtycow.c` 代码，主要包含以下几个部分：

*   **`main` 函数：**  处理命令行参数，打开目标文件，使用 `mmap` 将文件映射到内存中，创建两个线程，并等待线程结束。
*   **`writeToMem` 函数：**  打开 `/proc/self/mem`，并在循环中通过 `lseek` 和 `write` 系统调用，向内存映射区域写入数据。 这个函数是利用漏洞的关键，通过直接修改进程内存来修改只读内存区域。
*   **`throwVirtMap` 函数:**  使用 `madvise` 系统调用，提示内核释放或重新获取虚拟内存区域。 这是触发竞争条件的关键，用于增大漏洞利用成功的概率。

**分析 `dirtycow.c` 代码后，未发现明显的投毒代码。** 该代码的功能明确，即利用 Dirty COW 漏洞覆盖只读文件内容。 代码中没有任何连接外部网络，执行其他程序，或者删除文件的操作， 因此投毒风险极低，可以评估为0%。

**利用方式：**
1.  **漏洞原理：**  Dirty COW 漏洞利用了Linux内核中copy-on-write (COW) 机制的竞争条件。当一个进程尝试写入一个只读的内存映射区域时，COW 会创建一个该内存页面的副本，并将写入操作应用到副本上。然而，在某些情况下，由于竞争条件，写入操作可能会直接应用到原始的只读内存页面上。
2.  **利用步骤：**
    *   使用 `mmap` 将目标文件以只读方式映射到内存中。
    *   创建一个线程，该线程打开 `/proc/self/mem` 文件，并通过 `lseek` 和 `write` 系统调用，向内存映射区域写入恶意数据。
    *   创建另一个线程，该线程使用 `madvise` 系统调用，提示内核释放或重新获取虚拟内存区域，以触发竞争条件。
    *   等待两个线程结束。
3.  **权限提升：** 通过修改具有SUID权限的可执行文件(例如 `/etc/passwd`)，普通用户可以修改文件内容，从而添加具有root权限的用户，最终提升权限。  也可以直接修改其他配置信息，达到提权的目的。

总而言之， 该漏洞利用代码目的是在特定的Linux内核版本上，实现本地权限提升，通过竞争条件，绕过只读保护，写入文件内容。 经分析，该代码本身不包含额外的恶意代码或后门，但利用该漏洞本身可以修改系统文件，从而实现提权或其他恶意目的。

**项目地址:** [th3-5had0w/DirtyCOW-PoC](https://github.com/th3-5had0w/DirtyCOW-PoC)

**漏洞详情:** [CVE-2016-5195](https://nvd.nist.gov/vuln/detail/CVE-2016-5195)

---

## POC #21

**来源**: [CVE-2016-5195-timwr_CVE-2016-5195.md](../2016/CVE-2016-5195-timwr_CVE-2016-5195.md)

## CVE-2016-5195 - Dirty COW

**漏洞编号:** CVE-2016-5195

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** Linux kernel 2.x through 4.x before 4.8.3

**利用条件:** 目标系统内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-5195，又名Dirty COW，是Linux内核中mm/gup.c文件中的一个竞争条件漏洞。该漏洞允许本地用户利用写时复制(COW)功能的不正确处理，写入只读内存映射，从而获得特权。

**有效性：**

提供的POC代码（基于ADB的Android环境利用）旨在利用Dirty COW漏洞。从提供的输出来看，该POC成功地修改了`/system/bin/run-as`，并获得了root权限的shell。因此，该POC在存在漏洞的Android设备上是有效的。此代码包含Makefile和Android.mk文件，表示它被设计为在Android平台上编译和运行，利用Android NDK构建工具。dirtycow.c和dcow.c包含漏洞利用的主体,使用madvise和/proc/self/mem等技术触发竞争条件并覆盖只读内存。

**投毒风险：**

分析POC代码，存在一定的投毒风险，主要体现在以下几个方面：
1.  **二进制替换的潜在风险：** 该利用方法涉及替换系统文件（例如`/system/bin/run-as`），如果替换过程失败或目标文件被恶意修改，可能会导致系统不稳定或功能异常。虽然POC旨在利用漏洞提升权限，但如果被篡改，可能被用于植入后门或恶意软件。
2.  **依赖外部工具：** 该POC依赖ADB和Android NDK等工具，这些工具本身如果被篡改或来自不可信的来源，可能会引入安全风险。
3.  **代码复杂性：** 尽管提供的代码片段看起来直接，但真正的漏洞利用代码可能更复杂，包含混淆或隐藏的恶意功能。
4. **run-as文件:** 该漏洞利用会将/system/bin/run-as替换为攻击者的二进制文件，如果攻击者的二进制文件包含恶意代码，则可能存在投毒风险.
5. **Makefile文件:** 该文件中包含ndk-build命令，该命令会从互联网上下载依赖，这存在投毒风险.

综上，虽然该POC主要是为了验证漏洞的存在和利用，但其操作的敏感性以及对外部工具的依赖，使得投毒风险不可忽视。估计投毒风险的概率为10%。

**利用方式：**

1.  **查找目标文件：** 漏洞利用首先确定要修改的目标文件，这里是`/system/bin/run-as`。
2.  **内存映射：** 使用`mmap()`将目标文件映射到进程的内存空间，并获得其大小。
3.  **触发竞争条件：** 通过`madvise()`触发写时复制(COW)机制，并通过`/proc/self/mem`文件并发写入内存，从而绕过只读保护。
4.  **修改文件内容：** 成功触发竞争条件后，利用代码修改内存中映射的文件内容，从而修改了实际的磁盘文件。
5.  **执行被修改的文件：** 最后，执行被修改的文件，由于文件内容已被替换为具有root权限的shell，因此可以获得root权限。

**项目地址:** [timwr/CVE-2016-5195](https://github.com/timwr/CVE-2016-5195)

**漏洞详情:** [CVE-2016-5195](https://nvd.nist.gov/vuln/detail/CVE-2016-5195)

---

## POC #22

**来源**: [CVE-2016-5195-zakariamaaraki_Dirty-COW-CVE-2016-5195-.md](../2016/CVE-2016-5195-zakariamaaraki_Dirty-COW-CVE-2016-5195-.md)

## CVE-2016-5195 - Dirty COW

**漏洞编号:** CVE-2016-5195

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可以提升权限至root

**影响版本:** 2.x through 4.x before 4.8.3

**利用条件:** 本地用户权限，目标系统内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-5195，也被称为Dirty COW，是一个Linux内核中的竞争条件漏洞。漏洞存在于`mm/gup.c`中，由于内核在处理写时复制（COW）时存在缺陷，允许本地用户利用此漏洞获得提升的权限，即使只具有只读内存映射的权限。 

**利用方式：**

1.  **利用mmap创建只读内存映射:** 攻击者首先需要找到或创建一个只读映射的文件。
2.  **使用pthread并发执行:** 攻击者会并发地使用`madvise`系统调用尝试释放映射的内存页，同时使用`proc/self/mem`接口写入这些内存页。
3.  **竞争条件:**  由于并发执行，`madvise`尝试释放内存页和`proc/self/mem`写入之间会产生竞争条件。如果`madvise`成功释放了内存页，而`proc/self/mem`仍然尝试写入，那么写入操作将绕过只读保护。
4.  **权限提升:** 通过覆盖只读内存区域，攻击者可以修改如`/etc/passwd`或`/etc/group`等系统文件，从而添加用户到`sudo`组或直接修改root用户的密码，以此获得root权限。

**POC有效性：**

提供的POC代码通过Vagrant和Docker创建了一个易受攻击的环境，并演示了如何利用Dirty COW漏洞将用户添加到sudo组。

**投毒风险分析：**

尽管POC代码旨在演示漏洞，但仍然存在潜在的投毒风险。以下是一些考虑因素：

*   **`nginx-docker` AppArmor配置:** 这个配置试图限制docker容器的权限.看似是在增加安全性,但是规则过于复杂,可能会存在绕过的风险,如果利用,存在一定的风险.
*   **`servers.yaml`中的shell命令：** 在`servers.yaml`中，存在执行任意shell命令的配置。攻击者可能会在这些命令中插入恶意代码，例如下载并执行恶意脚本、植入后门等。

总体来说，该仓库的投毒风险较低，主要集中在`servers.yaml` 中的shell命令，以及看似增加安全性,但是规则过于复杂的`nginx-docker` AppArmor配置，因为它们允许执行任意代码或绕过沙箱。

**项目地址:** [zakariamaaraki/Dirty-COW-CVE-2016-5195-](https://github.com/zakariamaaraki/Dirty-COW-CVE-2016-5195-)

**漏洞详情:** [CVE-2016-5195](https://nvd.nist.gov/vuln/detail/CVE-2016-5195)

---

