# CVE-2016-6662

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md](../2016/CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可导致远程代码执行和权限提升至root

**影响版本:** MySQL <= 5.7.14, 5.6.32, 5.5.51; MariaDB; PerconaDB

**利用条件:** 需要本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置，创建任意配置并绕过某些保护机制。搜索引擎结果和漏洞库信息均确认了该漏洞的存在，并且影响 MySQL、MariaDB 和 PerconaDB 的多个版本。利用方式是通过修改 my.cnf 配置文件，例如设置 malloc_lib，从而执行任意代码。mysqld_safe 脚本以 root 权限运行，如果攻击者能够修改 my.cnf，则可以利用此漏洞以 root 权限执行代码。提供的POC代码描述了漏洞原理和利用方法。投毒风险较低（10%），因为POC代码主要提供漏洞利用的描述和原理，没有直接发现恶意代码，但存在恶意修改利用代码的可能性。

**项目地址:** [Ashrafdev/MySQL-Remote-Root-Code-Execution](https://github.com/Ashrafdev/MySQL-Remote-Root-Code-Execution)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #2

**来源**: [CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md](../2016/CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全控制数据库服务器

**影响版本:** MySQL (<= 5.5.52, <= 5.6.33, <= 5.7.15), MariaDB (< 5.5.51, < 10.0.27, < 10.1.17), Percona Server (< 5.5.51-38.1, < 5.6.32-78.0, < 5.7.14-7)

**利用条件:** 本地用户或具有数据库连接权限的远程用户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 到一个恶意的 `my.cnf` 配置文件来创建任意配置，并绕过某些保护机制。这可以被利用来以 root 权限执行任意代码，通过设置 `malloc_lib`。利用方式如下：

1.  **利用前提：** 具有 MySQL 用户权限（即使权限很低）。
2.  **修改配置文件：** 攻击者可以尝试修改 MySQL 的配置文件（my.cnf），或者通过 SQL 语句设置 `general_log_file` 参数指向一个由攻击者控制的文件。
3.  **写入恶意配置：** 将恶意的配置写入到 `general_log_file` 指定的文件中，例如设置 `malloc_lib` 指向恶意动态链接库。
4.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意配置生效。
5.  **代码执行：**  恶意动态链接库被加载，攻击者控制的代码以 root 权限执行。

**有效性评估：** 根据漏洞库信息和搜索结果，该漏洞的POC是有效的。已经存在公开的利用代码，并且该漏洞已经被广泛讨论和利用。

**投毒风险评估：** 提供的代码片段主要是 Ansible 配置文件，用于配置 scapegoat.test 和 attacker.test 两台虚拟机环境，包括安装 MySQL，配置用户，以及一些常用的软件。代码本身用于搭建漏洞利用的环境，可能包含测试漏洞利用的后门代码。但是，从提供的代码片段来看，没有明显的恶意代码注入，但考虑到自动化部署的复杂性，仍存在一定的风险，主要是自动化脚本可能被植入恶意代码，安装不需要软件。风险评估为5%。

**利用方式总结：**

该漏洞的核心在于利用 MySQL 的 `general_log_file` 配置项，允许低权限用户覆盖配置文件，进而通过 `malloc_lib` 设置加载恶意动态链接库，最终实现以 root 权限执行任意代码。攻击者需要有权限连接到数据库，然后才能修改配置或执行 SQL 语句来触发漏洞。


**项目地址:** [KosukeShimofuji/CVE-2016-6662](https://github.com/KosukeShimofuji/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #3

**来源**: [CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md](../2016/CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md)

# CVE-2016-6662

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md](../2016/CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可导致远程代码执行和权限提升至root

**影响版本:** MySQL <= 5.7.14, 5.6.32, 5.5.51; MariaDB; PerconaDB

**利用条件:** 需要本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置，创建任意配置并绕过某些保护机制。搜索引擎结果和漏洞库信息均确认了该漏洞的存在，并且影响 MySQL、MariaDB 和 PerconaDB 的多个版本。利用方式是通过修改 my.cnf 配置文件，例如设置 malloc_lib，从而执行任意代码。mysqld_safe 脚本以 root 权限运行，如果攻击者能够修改 my.cnf，则可以利用此漏洞以 root 权限执行代码。提供的POC代码描述了漏洞原理和利用方法。投毒风险较低（10%），因为POC代码主要提供漏洞利用的描述和原理，没有直接发现恶意代码，但存在恶意修改利用代码的可能性。

**项目地址:** [Ashrafdev/MySQL-Remote-Root-Code-Execution](https://github.com/Ashrafdev/MySQL-Remote-Root-Code-Execution)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #2

**来源**: [CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md](../2016/CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全控制数据库服务器

**影响版本:** MySQL (<= 5.5.52, <= 5.6.33, <= 5.7.15), MariaDB (< 5.5.51, < 10.0.27, < 10.1.17), Percona Server (< 5.5.51-38.1, < 5.6.32-78.0, < 5.7.14-7)

**利用条件:** 本地用户或具有数据库连接权限的远程用户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 到一个恶意的 `my.cnf` 配置文件来创建任意配置，并绕过某些保护机制。这可以被利用来以 root 权限执行任意代码，通过设置 `malloc_lib`。利用方式如下：

1.  **利用前提：** 具有 MySQL 用户权限（即使权限很低）。
2.  **修改配置文件：** 攻击者可以尝试修改 MySQL 的配置文件（my.cnf），或者通过 SQL 语句设置 `general_log_file` 参数指向一个由攻击者控制的文件。
3.  **写入恶意配置：** 将恶意的配置写入到 `general_log_file` 指定的文件中，例如设置 `malloc_lib` 指向恶意动态链接库。
4.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意配置生效。
5.  **代码执行：**  恶意动态链接库被加载，攻击者控制的代码以 root 权限执行。

**有效性评估：** 根据漏洞库信息和搜索结果，该漏洞的POC是有效的。已经存在公开的利用代码，并且该漏洞已经被广泛讨论和利用。

**投毒风险评估：** 提供的代码片段主要是 Ansible 配置文件，用于配置 scapegoat.test 和 attacker.test 两台虚拟机环境，包括安装 MySQL，配置用户，以及一些常用的软件。代码本身用于搭建漏洞利用的环境，可能包含测试漏洞利用的后门代码。但是，从提供的代码片段来看，没有明显的恶意代码注入，但考虑到自动化部署的复杂性，仍存在一定的风险，主要是自动化脚本可能被植入恶意代码，安装不需要软件。风险评估为5%。

**利用方式总结：**

该漏洞的核心在于利用 MySQL 的 `general_log_file` 配置项，允许低权限用户覆盖配置文件，进而通过 `malloc_lib` 设置加载恶意动态链接库，最终实现以 root 权限执行任意代码。攻击者需要有权限连接到数据库，然后才能修改配置或执行 SQL 语句来触发漏洞。


**项目地址:** [KosukeShimofuji/CVE-2016-6662](https://github.com/KosukeShimofuji/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #3

**来源**: [CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md](../2016/CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md)

# CVE-2016-6662

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md](../2016/CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可导致远程代码执行和权限提升至root

**影响版本:** MySQL <= 5.7.14, 5.6.32, 5.5.51; MariaDB; PerconaDB

**利用条件:** 需要本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置，创建任意配置并绕过某些保护机制。搜索引擎结果和漏洞库信息均确认了该漏洞的存在，并且影响 MySQL、MariaDB 和 PerconaDB 的多个版本。利用方式是通过修改 my.cnf 配置文件，例如设置 malloc_lib，从而执行任意代码。mysqld_safe 脚本以 root 权限运行，如果攻击者能够修改 my.cnf，则可以利用此漏洞以 root 权限执行代码。提供的POC代码描述了漏洞原理和利用方法。投毒风险较低（10%），因为POC代码主要提供漏洞利用的描述和原理，没有直接发现恶意代码，但存在恶意修改利用代码的可能性。

**项目地址:** [Ashrafdev/MySQL-Remote-Root-Code-Execution](https://github.com/Ashrafdev/MySQL-Remote-Root-Code-Execution)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #2

**来源**: [CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md](../2016/CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全控制数据库服务器

**影响版本:** MySQL (<= 5.5.52, <= 5.6.33, <= 5.7.15), MariaDB (< 5.5.51, < 10.0.27, < 10.1.17), Percona Server (< 5.5.51-38.1, < 5.6.32-78.0, < 5.7.14-7)

**利用条件:** 本地用户或具有数据库连接权限的远程用户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 到一个恶意的 `my.cnf` 配置文件来创建任意配置，并绕过某些保护机制。这可以被利用来以 root 权限执行任意代码，通过设置 `malloc_lib`。利用方式如下：

1.  **利用前提：** 具有 MySQL 用户权限（即使权限很低）。
2.  **修改配置文件：** 攻击者可以尝试修改 MySQL 的配置文件（my.cnf），或者通过 SQL 语句设置 `general_log_file` 参数指向一个由攻击者控制的文件。
3.  **写入恶意配置：** 将恶意的配置写入到 `general_log_file` 指定的文件中，例如设置 `malloc_lib` 指向恶意动态链接库。
4.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意配置生效。
5.  **代码执行：**  恶意动态链接库被加载，攻击者控制的代码以 root 权限执行。

**有效性评估：** 根据漏洞库信息和搜索结果，该漏洞的POC是有效的。已经存在公开的利用代码，并且该漏洞已经被广泛讨论和利用。

**投毒风险评估：** 提供的代码片段主要是 Ansible 配置文件，用于配置 scapegoat.test 和 attacker.test 两台虚拟机环境，包括安装 MySQL，配置用户，以及一些常用的软件。代码本身用于搭建漏洞利用的环境，可能包含测试漏洞利用的后门代码。但是，从提供的代码片段来看，没有明显的恶意代码注入，但考虑到自动化部署的复杂性，仍存在一定的风险，主要是自动化脚本可能被植入恶意代码，安装不需要软件。风险评估为5%。

**利用方式总结：**

该漏洞的核心在于利用 MySQL 的 `general_log_file` 配置项，允许低权限用户覆盖配置文件，进而通过 `malloc_lib` 设置加载恶意动态链接库，最终实现以 root 权限执行任意代码。攻击者需要有权限连接到数据库，然后才能修改配置或执行 SQL 语句来触发漏洞。


**项目地址:** [KosukeShimofuji/CVE-2016-6662](https://github.com/KosukeShimofuji/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #3

**来源**: [CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md](../2016/CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md)

# CVE-2016-6662

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md](../2016/CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可导致远程代码执行和权限提升至root

**影响版本:** MySQL <= 5.7.14, 5.6.32, 5.5.51; MariaDB; PerconaDB

**利用条件:** 需要本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置，创建任意配置并绕过某些保护机制。搜索引擎结果和漏洞库信息均确认了该漏洞的存在，并且影响 MySQL、MariaDB 和 PerconaDB 的多个版本。利用方式是通过修改 my.cnf 配置文件，例如设置 malloc_lib，从而执行任意代码。mysqld_safe 脚本以 root 权限运行，如果攻击者能够修改 my.cnf，则可以利用此漏洞以 root 权限执行代码。提供的POC代码描述了漏洞原理和利用方法。投毒风险较低（10%），因为POC代码主要提供漏洞利用的描述和原理，没有直接发现恶意代码，但存在恶意修改利用代码的可能性。

**项目地址:** [Ashrafdev/MySQL-Remote-Root-Code-Execution](https://github.com/Ashrafdev/MySQL-Remote-Root-Code-Execution)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #2

**来源**: [CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md](../2016/CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全控制数据库服务器

**影响版本:** MySQL (<= 5.5.52, <= 5.6.33, <= 5.7.15), MariaDB (< 5.5.51, < 10.0.27, < 10.1.17), Percona Server (< 5.5.51-38.1, < 5.6.32-78.0, < 5.7.14-7)

**利用条件:** 本地用户或具有数据库连接权限的远程用户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 到一个恶意的 `my.cnf` 配置文件来创建任意配置，并绕过某些保护机制。这可以被利用来以 root 权限执行任意代码，通过设置 `malloc_lib`。利用方式如下：

1.  **利用前提：** 具有 MySQL 用户权限（即使权限很低）。
2.  **修改配置文件：** 攻击者可以尝试修改 MySQL 的配置文件（my.cnf），或者通过 SQL 语句设置 `general_log_file` 参数指向一个由攻击者控制的文件。
3.  **写入恶意配置：** 将恶意的配置写入到 `general_log_file` 指定的文件中，例如设置 `malloc_lib` 指向恶意动态链接库。
4.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意配置生效。
5.  **代码执行：**  恶意动态链接库被加载，攻击者控制的代码以 root 权限执行。

**有效性评估：** 根据漏洞库信息和搜索结果，该漏洞的POC是有效的。已经存在公开的利用代码，并且该漏洞已经被广泛讨论和利用。

**投毒风险评估：** 提供的代码片段主要是 Ansible 配置文件，用于配置 scapegoat.test 和 attacker.test 两台虚拟机环境，包括安装 MySQL，配置用户，以及一些常用的软件。代码本身用于搭建漏洞利用的环境，可能包含测试漏洞利用的后门代码。但是，从提供的代码片段来看，没有明显的恶意代码注入，但考虑到自动化部署的复杂性，仍存在一定的风险，主要是自动化脚本可能被植入恶意代码，安装不需要软件。风险评估为5%。

**利用方式总结：**

该漏洞的核心在于利用 MySQL 的 `general_log_file` 配置项，允许低权限用户覆盖配置文件，进而通过 `malloc_lib` 设置加载恶意动态链接库，最终实现以 root 权限执行任意代码。攻击者需要有权限连接到数据库，然后才能修改配置或执行 SQL 语句来触发漏洞。


**项目地址:** [KosukeShimofuji/CVE-2016-6662](https://github.com/KosukeShimofuji/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #3

**来源**: [CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md](../2016/CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md)

# CVE-2016-6662

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md](../2016/CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可导致远程代码执行和权限提升至root

**影响版本:** MySQL <= 5.7.14, 5.6.32, 5.5.51; MariaDB; PerconaDB

**利用条件:** 需要本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置，创建任意配置并绕过某些保护机制。搜索引擎结果和漏洞库信息均确认了该漏洞的存在，并且影响 MySQL、MariaDB 和 PerconaDB 的多个版本。利用方式是通过修改 my.cnf 配置文件，例如设置 malloc_lib，从而执行任意代码。mysqld_safe 脚本以 root 权限运行，如果攻击者能够修改 my.cnf，则可以利用此漏洞以 root 权限执行代码。提供的POC代码描述了漏洞原理和利用方法。投毒风险较低（10%），因为POC代码主要提供漏洞利用的描述和原理，没有直接发现恶意代码，但存在恶意修改利用代码的可能性。

**项目地址:** [Ashrafdev/MySQL-Remote-Root-Code-Execution](https://github.com/Ashrafdev/MySQL-Remote-Root-Code-Execution)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #2

**来源**: [CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md](../2016/CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全控制数据库服务器

**影响版本:** MySQL (<= 5.5.52, <= 5.6.33, <= 5.7.15), MariaDB (< 5.5.51, < 10.0.27, < 10.1.17), Percona Server (< 5.5.51-38.1, < 5.6.32-78.0, < 5.7.14-7)

**利用条件:** 本地用户或具有数据库连接权限的远程用户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 到一个恶意的 `my.cnf` 配置文件来创建任意配置，并绕过某些保护机制。这可以被利用来以 root 权限执行任意代码，通过设置 `malloc_lib`。利用方式如下：

1.  **利用前提：** 具有 MySQL 用户权限（即使权限很低）。
2.  **修改配置文件：** 攻击者可以尝试修改 MySQL 的配置文件（my.cnf），或者通过 SQL 语句设置 `general_log_file` 参数指向一个由攻击者控制的文件。
3.  **写入恶意配置：** 将恶意的配置写入到 `general_log_file` 指定的文件中，例如设置 `malloc_lib` 指向恶意动态链接库。
4.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意配置生效。
5.  **代码执行：**  恶意动态链接库被加载，攻击者控制的代码以 root 权限执行。

**有效性评估：** 根据漏洞库信息和搜索结果，该漏洞的POC是有效的。已经存在公开的利用代码，并且该漏洞已经被广泛讨论和利用。

**投毒风险评估：** 提供的代码片段主要是 Ansible 配置文件，用于配置 scapegoat.test 和 attacker.test 两台虚拟机环境，包括安装 MySQL，配置用户，以及一些常用的软件。代码本身用于搭建漏洞利用的环境，可能包含测试漏洞利用的后门代码。但是，从提供的代码片段来看，没有明显的恶意代码注入，但考虑到自动化部署的复杂性，仍存在一定的风险，主要是自动化脚本可能被植入恶意代码，安装不需要软件。风险评估为5%。

**利用方式总结：**

该漏洞的核心在于利用 MySQL 的 `general_log_file` 配置项，允许低权限用户覆盖配置文件，进而通过 `malloc_lib` 设置加载恶意动态链接库，最终实现以 root 权限执行任意代码。攻击者需要有权限连接到数据库，然后才能修改配置或执行 SQL 语句来触发漏洞。


**项目地址:** [KosukeShimofuji/CVE-2016-6662](https://github.com/KosukeShimofuji/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #3

**来源**: [CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md](../2016/CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md)

# CVE-2016-6662

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md](../2016/CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可导致远程代码执行和权限提升至root

**影响版本:** MySQL <= 5.7.14, 5.6.32, 5.5.51; MariaDB; PerconaDB

**利用条件:** 需要本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置，创建任意配置并绕过某些保护机制。搜索引擎结果和漏洞库信息均确认了该漏洞的存在，并且影响 MySQL、MariaDB 和 PerconaDB 的多个版本。利用方式是通过修改 my.cnf 配置文件，例如设置 malloc_lib，从而执行任意代码。mysqld_safe 脚本以 root 权限运行，如果攻击者能够修改 my.cnf，则可以利用此漏洞以 root 权限执行代码。提供的POC代码描述了漏洞原理和利用方法。投毒风险较低（10%），因为POC代码主要提供漏洞利用的描述和原理，没有直接发现恶意代码，但存在恶意修改利用代码的可能性。

**项目地址:** [Ashrafdev/MySQL-Remote-Root-Code-Execution](https://github.com/Ashrafdev/MySQL-Remote-Root-Code-Execution)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #2

**来源**: [CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md](../2016/CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全控制数据库服务器

**影响版本:** MySQL (<= 5.5.52, <= 5.6.33, <= 5.7.15), MariaDB (< 5.5.51, < 10.0.27, < 10.1.17), Percona Server (< 5.5.51-38.1, < 5.6.32-78.0, < 5.7.14-7)

**利用条件:** 本地用户或具有数据库连接权限的远程用户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 到一个恶意的 `my.cnf` 配置文件来创建任意配置，并绕过某些保护机制。这可以被利用来以 root 权限执行任意代码，通过设置 `malloc_lib`。利用方式如下：

1.  **利用前提：** 具有 MySQL 用户权限（即使权限很低）。
2.  **修改配置文件：** 攻击者可以尝试修改 MySQL 的配置文件（my.cnf），或者通过 SQL 语句设置 `general_log_file` 参数指向一个由攻击者控制的文件。
3.  **写入恶意配置：** 将恶意的配置写入到 `general_log_file` 指定的文件中，例如设置 `malloc_lib` 指向恶意动态链接库。
4.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意配置生效。
5.  **代码执行：**  恶意动态链接库被加载，攻击者控制的代码以 root 权限执行。

**有效性评估：** 根据漏洞库信息和搜索结果，该漏洞的POC是有效的。已经存在公开的利用代码，并且该漏洞已经被广泛讨论和利用。

**投毒风险评估：** 提供的代码片段主要是 Ansible 配置文件，用于配置 scapegoat.test 和 attacker.test 两台虚拟机环境，包括安装 MySQL，配置用户，以及一些常用的软件。代码本身用于搭建漏洞利用的环境，可能包含测试漏洞利用的后门代码。但是，从提供的代码片段来看，没有明显的恶意代码注入，但考虑到自动化部署的复杂性，仍存在一定的风险，主要是自动化脚本可能被植入恶意代码，安装不需要软件。风险评估为5%。

**利用方式总结：**

该漏洞的核心在于利用 MySQL 的 `general_log_file` 配置项，允许低权限用户覆盖配置文件，进而通过 `malloc_lib` 设置加载恶意动态链接库，最终实现以 root 权限执行任意代码。攻击者需要有权限连接到数据库，然后才能修改配置或执行 SQL 语句来触发漏洞。


**项目地址:** [KosukeShimofuji/CVE-2016-6662](https://github.com/KosukeShimofuji/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #3

**来源**: [CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md](../2016/CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md)

# CVE-2016-6662

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md](../2016/CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可导致远程代码执行和权限提升至root

**影响版本:** MySQL <= 5.7.14, 5.6.32, 5.5.51; MariaDB; PerconaDB

**利用条件:** 需要本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置，创建任意配置并绕过某些保护机制。搜索引擎结果和漏洞库信息均确认了该漏洞的存在，并且影响 MySQL、MariaDB 和 PerconaDB 的多个版本。利用方式是通过修改 my.cnf 配置文件，例如设置 malloc_lib，从而执行任意代码。mysqld_safe 脚本以 root 权限运行，如果攻击者能够修改 my.cnf，则可以利用此漏洞以 root 权限执行代码。提供的POC代码描述了漏洞原理和利用方法。投毒风险较低（10%），因为POC代码主要提供漏洞利用的描述和原理，没有直接发现恶意代码，但存在恶意修改利用代码的可能性。

**项目地址:** [Ashrafdev/MySQL-Remote-Root-Code-Execution](https://github.com/Ashrafdev/MySQL-Remote-Root-Code-Execution)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #2

**来源**: [CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md](../2016/CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全控制数据库服务器

**影响版本:** MySQL (<= 5.5.52, <= 5.6.33, <= 5.7.15), MariaDB (< 5.5.51, < 10.0.27, < 10.1.17), Percona Server (< 5.5.51-38.1, < 5.6.32-78.0, < 5.7.14-7)

**利用条件:** 本地用户或具有数据库连接权限的远程用户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 到一个恶意的 `my.cnf` 配置文件来创建任意配置，并绕过某些保护机制。这可以被利用来以 root 权限执行任意代码，通过设置 `malloc_lib`。利用方式如下：

1.  **利用前提：** 具有 MySQL 用户权限（即使权限很低）。
2.  **修改配置文件：** 攻击者可以尝试修改 MySQL 的配置文件（my.cnf），或者通过 SQL 语句设置 `general_log_file` 参数指向一个由攻击者控制的文件。
3.  **写入恶意配置：** 将恶意的配置写入到 `general_log_file` 指定的文件中，例如设置 `malloc_lib` 指向恶意动态链接库。
4.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意配置生效。
5.  **代码执行：**  恶意动态链接库被加载，攻击者控制的代码以 root 权限执行。

**有效性评估：** 根据漏洞库信息和搜索结果，该漏洞的POC是有效的。已经存在公开的利用代码，并且该漏洞已经被广泛讨论和利用。

**投毒风险评估：** 提供的代码片段主要是 Ansible 配置文件，用于配置 scapegoat.test 和 attacker.test 两台虚拟机环境，包括安装 MySQL，配置用户，以及一些常用的软件。代码本身用于搭建漏洞利用的环境，可能包含测试漏洞利用的后门代码。但是，从提供的代码片段来看，没有明显的恶意代码注入，但考虑到自动化部署的复杂性，仍存在一定的风险，主要是自动化脚本可能被植入恶意代码，安装不需要软件。风险评估为5%。

**利用方式总结：**

该漏洞的核心在于利用 MySQL 的 `general_log_file` 配置项，允许低权限用户覆盖配置文件，进而通过 `malloc_lib` 设置加载恶意动态链接库，最终实现以 root 权限执行任意代码。攻击者需要有权限连接到数据库，然后才能修改配置或执行 SQL 语句来触发漏洞。


**项目地址:** [KosukeShimofuji/CVE-2016-6662](https://github.com/KosukeShimofuji/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #3

**来源**: [CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md](../2016/CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md)

# CVE-2016-6662

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md](../2016/CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可导致远程代码执行和权限提升至root

**影响版本:** MySQL <= 5.7.14, 5.6.32, 5.5.51; MariaDB; PerconaDB

**利用条件:** 需要本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置，创建任意配置并绕过某些保护机制。搜索引擎结果和漏洞库信息均确认了该漏洞的存在，并且影响 MySQL、MariaDB 和 PerconaDB 的多个版本。利用方式是通过修改 my.cnf 配置文件，例如设置 malloc_lib，从而执行任意代码。mysqld_safe 脚本以 root 权限运行，如果攻击者能够修改 my.cnf，则可以利用此漏洞以 root 权限执行代码。提供的POC代码描述了漏洞原理和利用方法。投毒风险较低（10%），因为POC代码主要提供漏洞利用的描述和原理，没有直接发现恶意代码，但存在恶意修改利用代码的可能性。

**项目地址:** [Ashrafdev/MySQL-Remote-Root-Code-Execution](https://github.com/Ashrafdev/MySQL-Remote-Root-Code-Execution)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #2

**来源**: [CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md](../2016/CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全控制数据库服务器

**影响版本:** MySQL (<= 5.5.52, <= 5.6.33, <= 5.7.15), MariaDB (< 5.5.51, < 10.0.27, < 10.1.17), Percona Server (< 5.5.51-38.1, < 5.6.32-78.0, < 5.7.14-7)

**利用条件:** 本地用户或具有数据库连接权限的远程用户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 到一个恶意的 `my.cnf` 配置文件来创建任意配置，并绕过某些保护机制。这可以被利用来以 root 权限执行任意代码，通过设置 `malloc_lib`。利用方式如下：

1.  **利用前提：** 具有 MySQL 用户权限（即使权限很低）。
2.  **修改配置文件：** 攻击者可以尝试修改 MySQL 的配置文件（my.cnf），或者通过 SQL 语句设置 `general_log_file` 参数指向一个由攻击者控制的文件。
3.  **写入恶意配置：** 将恶意的配置写入到 `general_log_file` 指定的文件中，例如设置 `malloc_lib` 指向恶意动态链接库。
4.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意配置生效。
5.  **代码执行：**  恶意动态链接库被加载，攻击者控制的代码以 root 权限执行。

**有效性评估：** 根据漏洞库信息和搜索结果，该漏洞的POC是有效的。已经存在公开的利用代码，并且该漏洞已经被广泛讨论和利用。

**投毒风险评估：** 提供的代码片段主要是 Ansible 配置文件，用于配置 scapegoat.test 和 attacker.test 两台虚拟机环境，包括安装 MySQL，配置用户，以及一些常用的软件。代码本身用于搭建漏洞利用的环境，可能包含测试漏洞利用的后门代码。但是，从提供的代码片段来看，没有明显的恶意代码注入，但考虑到自动化部署的复杂性，仍存在一定的风险，主要是自动化脚本可能被植入恶意代码，安装不需要软件。风险评估为5%。

**利用方式总结：**

该漏洞的核心在于利用 MySQL 的 `general_log_file` 配置项，允许低权限用户覆盖配置文件，进而通过 `malloc_lib` 设置加载恶意动态链接库，最终实现以 root 权限执行任意代码。攻击者需要有权限连接到数据库，然后才能修改配置或执行 SQL 语句来触发漏洞。


**项目地址:** [KosukeShimofuji/CVE-2016-6662](https://github.com/KosukeShimofuji/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #3

**来源**: [CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md](../2016/CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md)

# CVE-2016-6662

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md](../2016/CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可导致远程代码执行和权限提升至root

**影响版本:** MySQL <= 5.7.14, 5.6.32, 5.5.51; MariaDB; PerconaDB

**利用条件:** 需要本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置，创建任意配置并绕过某些保护机制。搜索引擎结果和漏洞库信息均确认了该漏洞的存在，并且影响 MySQL、MariaDB 和 PerconaDB 的多个版本。利用方式是通过修改 my.cnf 配置文件，例如设置 malloc_lib，从而执行任意代码。mysqld_safe 脚本以 root 权限运行，如果攻击者能够修改 my.cnf，则可以利用此漏洞以 root 权限执行代码。提供的POC代码描述了漏洞原理和利用方法。投毒风险较低（10%），因为POC代码主要提供漏洞利用的描述和原理，没有直接发现恶意代码，但存在恶意修改利用代码的可能性。

**项目地址:** [Ashrafdev/MySQL-Remote-Root-Code-Execution](https://github.com/Ashrafdev/MySQL-Remote-Root-Code-Execution)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #2

**来源**: [CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md](../2016/CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全控制数据库服务器

**影响版本:** MySQL (<= 5.5.52, <= 5.6.33, <= 5.7.15), MariaDB (< 5.5.51, < 10.0.27, < 10.1.17), Percona Server (< 5.5.51-38.1, < 5.6.32-78.0, < 5.7.14-7)

**利用条件:** 本地用户或具有数据库连接权限的远程用户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 到一个恶意的 `my.cnf` 配置文件来创建任意配置，并绕过某些保护机制。这可以被利用来以 root 权限执行任意代码，通过设置 `malloc_lib`。利用方式如下：

1.  **利用前提：** 具有 MySQL 用户权限（即使权限很低）。
2.  **修改配置文件：** 攻击者可以尝试修改 MySQL 的配置文件（my.cnf），或者通过 SQL 语句设置 `general_log_file` 参数指向一个由攻击者控制的文件。
3.  **写入恶意配置：** 将恶意的配置写入到 `general_log_file` 指定的文件中，例如设置 `malloc_lib` 指向恶意动态链接库。
4.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意配置生效。
5.  **代码执行：**  恶意动态链接库被加载，攻击者控制的代码以 root 权限执行。

**有效性评估：** 根据漏洞库信息和搜索结果，该漏洞的POC是有效的。已经存在公开的利用代码，并且该漏洞已经被广泛讨论和利用。

**投毒风险评估：** 提供的代码片段主要是 Ansible 配置文件，用于配置 scapegoat.test 和 attacker.test 两台虚拟机环境，包括安装 MySQL，配置用户，以及一些常用的软件。代码本身用于搭建漏洞利用的环境，可能包含测试漏洞利用的后门代码。但是，从提供的代码片段来看，没有明显的恶意代码注入，但考虑到自动化部署的复杂性，仍存在一定的风险，主要是自动化脚本可能被植入恶意代码，安装不需要软件。风险评估为5%。

**利用方式总结：**

该漏洞的核心在于利用 MySQL 的 `general_log_file` 配置项，允许低权限用户覆盖配置文件，进而通过 `malloc_lib` 设置加载恶意动态链接库，最终实现以 root 权限执行任意代码。攻击者需要有权限连接到数据库，然后才能修改配置或执行 SQL 语句来触发漏洞。


**项目地址:** [KosukeShimofuji/CVE-2016-6662](https://github.com/KosukeShimofuji/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #3

**来源**: [CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md](../2016/CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md)

# CVE-2016-6662

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md](../2016/CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可导致远程代码执行和权限提升至root

**影响版本:** MySQL <= 5.7.14, 5.6.32, 5.5.51; MariaDB; PerconaDB

**利用条件:** 需要本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置，创建任意配置并绕过某些保护机制。搜索引擎结果和漏洞库信息均确认了该漏洞的存在，并且影响 MySQL、MariaDB 和 PerconaDB 的多个版本。利用方式是通过修改 my.cnf 配置文件，例如设置 malloc_lib，从而执行任意代码。mysqld_safe 脚本以 root 权限运行，如果攻击者能够修改 my.cnf，则可以利用此漏洞以 root 权限执行代码。提供的POC代码描述了漏洞原理和利用方法。投毒风险较低（10%），因为POC代码主要提供漏洞利用的描述和原理，没有直接发现恶意代码，但存在恶意修改利用代码的可能性。

**项目地址:** [Ashrafdev/MySQL-Remote-Root-Code-Execution](https://github.com/Ashrafdev/MySQL-Remote-Root-Code-Execution)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #2

**来源**: [CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md](../2016/CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全控制数据库服务器

**影响版本:** MySQL (<= 5.5.52, <= 5.6.33, <= 5.7.15), MariaDB (< 5.5.51, < 10.0.27, < 10.1.17), Percona Server (< 5.5.51-38.1, < 5.6.32-78.0, < 5.7.14-7)

**利用条件:** 本地用户或具有数据库连接权限的远程用户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 到一个恶意的 `my.cnf` 配置文件来创建任意配置，并绕过某些保护机制。这可以被利用来以 root 权限执行任意代码，通过设置 `malloc_lib`。利用方式如下：

1.  **利用前提：** 具有 MySQL 用户权限（即使权限很低）。
2.  **修改配置文件：** 攻击者可以尝试修改 MySQL 的配置文件（my.cnf），或者通过 SQL 语句设置 `general_log_file` 参数指向一个由攻击者控制的文件。
3.  **写入恶意配置：** 将恶意的配置写入到 `general_log_file` 指定的文件中，例如设置 `malloc_lib` 指向恶意动态链接库。
4.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意配置生效。
5.  **代码执行：**  恶意动态链接库被加载，攻击者控制的代码以 root 权限执行。

**有效性评估：** 根据漏洞库信息和搜索结果，该漏洞的POC是有效的。已经存在公开的利用代码，并且该漏洞已经被广泛讨论和利用。

**投毒风险评估：** 提供的代码片段主要是 Ansible 配置文件，用于配置 scapegoat.test 和 attacker.test 两台虚拟机环境，包括安装 MySQL，配置用户，以及一些常用的软件。代码本身用于搭建漏洞利用的环境，可能包含测试漏洞利用的后门代码。但是，从提供的代码片段来看，没有明显的恶意代码注入，但考虑到自动化部署的复杂性，仍存在一定的风险，主要是自动化脚本可能被植入恶意代码，安装不需要软件。风险评估为5%。

**利用方式总结：**

该漏洞的核心在于利用 MySQL 的 `general_log_file` 配置项，允许低权限用户覆盖配置文件，进而通过 `malloc_lib` 设置加载恶意动态链接库，最终实现以 root 权限执行任意代码。攻击者需要有权限连接到数据库，然后才能修改配置或执行 SQL 语句来触发漏洞。


**项目地址:** [KosukeShimofuji/CVE-2016-6662](https://github.com/KosukeShimofuji/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #3

**来源**: [CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md](../2016/CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md)

# CVE-2016-6662

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md](../2016/CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可导致远程代码执行和权限提升至root

**影响版本:** MySQL <= 5.7.14, 5.6.32, 5.5.51; MariaDB; PerconaDB

**利用条件:** 需要本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置，创建任意配置并绕过某些保护机制。搜索引擎结果和漏洞库信息均确认了该漏洞的存在，并且影响 MySQL、MariaDB 和 PerconaDB 的多个版本。利用方式是通过修改 my.cnf 配置文件，例如设置 malloc_lib，从而执行任意代码。mysqld_safe 脚本以 root 权限运行，如果攻击者能够修改 my.cnf，则可以利用此漏洞以 root 权限执行代码。提供的POC代码描述了漏洞原理和利用方法。投毒风险较低（10%），因为POC代码主要提供漏洞利用的描述和原理，没有直接发现恶意代码，但存在恶意修改利用代码的可能性。

**项目地址:** [Ashrafdev/MySQL-Remote-Root-Code-Execution](https://github.com/Ashrafdev/MySQL-Remote-Root-Code-Execution)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #2

**来源**: [CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md](../2016/CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全控制数据库服务器

**影响版本:** MySQL (<= 5.5.52, <= 5.6.33, <= 5.7.15), MariaDB (< 5.5.51, < 10.0.27, < 10.1.17), Percona Server (< 5.5.51-38.1, < 5.6.32-78.0, < 5.7.14-7)

**利用条件:** 本地用户或具有数据库连接权限的远程用户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 到一个恶意的 `my.cnf` 配置文件来创建任意配置，并绕过某些保护机制。这可以被利用来以 root 权限执行任意代码，通过设置 `malloc_lib`。利用方式如下：

1.  **利用前提：** 具有 MySQL 用户权限（即使权限很低）。
2.  **修改配置文件：** 攻击者可以尝试修改 MySQL 的配置文件（my.cnf），或者通过 SQL 语句设置 `general_log_file` 参数指向一个由攻击者控制的文件。
3.  **写入恶意配置：** 将恶意的配置写入到 `general_log_file` 指定的文件中，例如设置 `malloc_lib` 指向恶意动态链接库。
4.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意配置生效。
5.  **代码执行：**  恶意动态链接库被加载，攻击者控制的代码以 root 权限执行。

**有效性评估：** 根据漏洞库信息和搜索结果，该漏洞的POC是有效的。已经存在公开的利用代码，并且该漏洞已经被广泛讨论和利用。

**投毒风险评估：** 提供的代码片段主要是 Ansible 配置文件，用于配置 scapegoat.test 和 attacker.test 两台虚拟机环境，包括安装 MySQL，配置用户，以及一些常用的软件。代码本身用于搭建漏洞利用的环境，可能包含测试漏洞利用的后门代码。但是，从提供的代码片段来看，没有明显的恶意代码注入，但考虑到自动化部署的复杂性，仍存在一定的风险，主要是自动化脚本可能被植入恶意代码，安装不需要软件。风险评估为5%。

**利用方式总结：**

该漏洞的核心在于利用 MySQL 的 `general_log_file` 配置项，允许低权限用户覆盖配置文件，进而通过 `malloc_lib` 设置加载恶意动态链接库，最终实现以 root 权限执行任意代码。攻击者需要有权限连接到数据库，然后才能修改配置或执行 SQL 语句来触发漏洞。


**项目地址:** [KosukeShimofuji/CVE-2016-6662](https://github.com/KosukeShimofuji/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #3

**来源**: [CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md](../2016/CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md)

# CVE-2016-6662

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md](../2016/CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可导致远程代码执行和权限提升至root

**影响版本:** MySQL <= 5.7.14, 5.6.32, 5.5.51; MariaDB; PerconaDB

**利用条件:** 需要本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置，创建任意配置并绕过某些保护机制。搜索引擎结果和漏洞库信息均确认了该漏洞的存在，并且影响 MySQL、MariaDB 和 PerconaDB 的多个版本。利用方式是通过修改 my.cnf 配置文件，例如设置 malloc_lib，从而执行任意代码。mysqld_safe 脚本以 root 权限运行，如果攻击者能够修改 my.cnf，则可以利用此漏洞以 root 权限执行代码。提供的POC代码描述了漏洞原理和利用方法。投毒风险较低（10%），因为POC代码主要提供漏洞利用的描述和原理，没有直接发现恶意代码，但存在恶意修改利用代码的可能性。

**项目地址:** [Ashrafdev/MySQL-Remote-Root-Code-Execution](https://github.com/Ashrafdev/MySQL-Remote-Root-Code-Execution)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #2

**来源**: [CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md](../2016/CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全控制数据库服务器

**影响版本:** MySQL (<= 5.5.52, <= 5.6.33, <= 5.7.15), MariaDB (< 5.5.51, < 10.0.27, < 10.1.17), Percona Server (< 5.5.51-38.1, < 5.6.32-78.0, < 5.7.14-7)

**利用条件:** 本地用户或具有数据库连接权限的远程用户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 到一个恶意的 `my.cnf` 配置文件来创建任意配置，并绕过某些保护机制。这可以被利用来以 root 权限执行任意代码，通过设置 `malloc_lib`。利用方式如下：

1.  **利用前提：** 具有 MySQL 用户权限（即使权限很低）。
2.  **修改配置文件：** 攻击者可以尝试修改 MySQL 的配置文件（my.cnf），或者通过 SQL 语句设置 `general_log_file` 参数指向一个由攻击者控制的文件。
3.  **写入恶意配置：** 将恶意的配置写入到 `general_log_file` 指定的文件中，例如设置 `malloc_lib` 指向恶意动态链接库。
4.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意配置生效。
5.  **代码执行：**  恶意动态链接库被加载，攻击者控制的代码以 root 权限执行。

**有效性评估：** 根据漏洞库信息和搜索结果，该漏洞的POC是有效的。已经存在公开的利用代码，并且该漏洞已经被广泛讨论和利用。

**投毒风险评估：** 提供的代码片段主要是 Ansible 配置文件，用于配置 scapegoat.test 和 attacker.test 两台虚拟机环境，包括安装 MySQL，配置用户，以及一些常用的软件。代码本身用于搭建漏洞利用的环境，可能包含测试漏洞利用的后门代码。但是，从提供的代码片段来看，没有明显的恶意代码注入，但考虑到自动化部署的复杂性，仍存在一定的风险，主要是自动化脚本可能被植入恶意代码，安装不需要软件。风险评估为5%。

**利用方式总结：**

该漏洞的核心在于利用 MySQL 的 `general_log_file` 配置项，允许低权限用户覆盖配置文件，进而通过 `malloc_lib` 设置加载恶意动态链接库，最终实现以 root 权限执行任意代码。攻击者需要有权限连接到数据库，然后才能修改配置或执行 SQL 语句来触发漏洞。


**项目地址:** [KosukeShimofuji/CVE-2016-6662](https://github.com/KosukeShimofuji/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #3

**来源**: [CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md](../2016/CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md)

# CVE-2016-6662

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md](../2016/CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可导致远程代码执行和权限提升至root

**影响版本:** MySQL <= 5.7.14, 5.6.32, 5.5.51; MariaDB; PerconaDB

**利用条件:** 需要本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置，创建任意配置并绕过某些保护机制。搜索引擎结果和漏洞库信息均确认了该漏洞的存在，并且影响 MySQL、MariaDB 和 PerconaDB 的多个版本。利用方式是通过修改 my.cnf 配置文件，例如设置 malloc_lib，从而执行任意代码。mysqld_safe 脚本以 root 权限运行，如果攻击者能够修改 my.cnf，则可以利用此漏洞以 root 权限执行代码。提供的POC代码描述了漏洞原理和利用方法。投毒风险较低（10%），因为POC代码主要提供漏洞利用的描述和原理，没有直接发现恶意代码，但存在恶意修改利用代码的可能性。

**项目地址:** [Ashrafdev/MySQL-Remote-Root-Code-Execution](https://github.com/Ashrafdev/MySQL-Remote-Root-Code-Execution)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #2

**来源**: [CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md](../2016/CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全控制数据库服务器

**影响版本:** MySQL (<= 5.5.52, <= 5.6.33, <= 5.7.15), MariaDB (< 5.5.51, < 10.0.27, < 10.1.17), Percona Server (< 5.5.51-38.1, < 5.6.32-78.0, < 5.7.14-7)

**利用条件:** 本地用户或具有数据库连接权限的远程用户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 到一个恶意的 `my.cnf` 配置文件来创建任意配置，并绕过某些保护机制。这可以被利用来以 root 权限执行任意代码，通过设置 `malloc_lib`。利用方式如下：

1.  **利用前提：** 具有 MySQL 用户权限（即使权限很低）。
2.  **修改配置文件：** 攻击者可以尝试修改 MySQL 的配置文件（my.cnf），或者通过 SQL 语句设置 `general_log_file` 参数指向一个由攻击者控制的文件。
3.  **写入恶意配置：** 将恶意的配置写入到 `general_log_file` 指定的文件中，例如设置 `malloc_lib` 指向恶意动态链接库。
4.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意配置生效。
5.  **代码执行：**  恶意动态链接库被加载，攻击者控制的代码以 root 权限执行。

**有效性评估：** 根据漏洞库信息和搜索结果，该漏洞的POC是有效的。已经存在公开的利用代码，并且该漏洞已经被广泛讨论和利用。

**投毒风险评估：** 提供的代码片段主要是 Ansible 配置文件，用于配置 scapegoat.test 和 attacker.test 两台虚拟机环境，包括安装 MySQL，配置用户，以及一些常用的软件。代码本身用于搭建漏洞利用的环境，可能包含测试漏洞利用的后门代码。但是，从提供的代码片段来看，没有明显的恶意代码注入，但考虑到自动化部署的复杂性，仍存在一定的风险，主要是自动化脚本可能被植入恶意代码，安装不需要软件。风险评估为5%。

**利用方式总结：**

该漏洞的核心在于利用 MySQL 的 `general_log_file` 配置项，允许低权限用户覆盖配置文件，进而通过 `malloc_lib` 设置加载恶意动态链接库，最终实现以 root 权限执行任意代码。攻击者需要有权限连接到数据库，然后才能修改配置或执行 SQL 语句来触发漏洞。


**项目地址:** [KosukeShimofuji/CVE-2016-6662](https://github.com/KosukeShimofuji/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #3

**来源**: [CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md](../2016/CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md)

# CVE-2016-6662

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md](../2016/CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可导致远程代码执行和权限提升至root

**影响版本:** MySQL <= 5.7.14, 5.6.32, 5.5.51; MariaDB; PerconaDB

**利用条件:** 需要本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置，创建任意配置并绕过某些保护机制。搜索引擎结果和漏洞库信息均确认了该漏洞的存在，并且影响 MySQL、MariaDB 和 PerconaDB 的多个版本。利用方式是通过修改 my.cnf 配置文件，例如设置 malloc_lib，从而执行任意代码。mysqld_safe 脚本以 root 权限运行，如果攻击者能够修改 my.cnf，则可以利用此漏洞以 root 权限执行代码。提供的POC代码描述了漏洞原理和利用方法。投毒风险较低（10%），因为POC代码主要提供漏洞利用的描述和原理，没有直接发现恶意代码，但存在恶意修改利用代码的可能性。

**项目地址:** [Ashrafdev/MySQL-Remote-Root-Code-Execution](https://github.com/Ashrafdev/MySQL-Remote-Root-Code-Execution)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #2

**来源**: [CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md](../2016/CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全控制数据库服务器

**影响版本:** MySQL (<= 5.5.52, <= 5.6.33, <= 5.7.15), MariaDB (< 5.5.51, < 10.0.27, < 10.1.17), Percona Server (< 5.5.51-38.1, < 5.6.32-78.0, < 5.7.14-7)

**利用条件:** 本地用户或具有数据库连接权限的远程用户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 到一个恶意的 `my.cnf` 配置文件来创建任意配置，并绕过某些保护机制。这可以被利用来以 root 权限执行任意代码，通过设置 `malloc_lib`。利用方式如下：

1.  **利用前提：** 具有 MySQL 用户权限（即使权限很低）。
2.  **修改配置文件：** 攻击者可以尝试修改 MySQL 的配置文件（my.cnf），或者通过 SQL 语句设置 `general_log_file` 参数指向一个由攻击者控制的文件。
3.  **写入恶意配置：** 将恶意的配置写入到 `general_log_file` 指定的文件中，例如设置 `malloc_lib` 指向恶意动态链接库。
4.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意配置生效。
5.  **代码执行：**  恶意动态链接库被加载，攻击者控制的代码以 root 权限执行。

**有效性评估：** 根据漏洞库信息和搜索结果，该漏洞的POC是有效的。已经存在公开的利用代码，并且该漏洞已经被广泛讨论和利用。

**投毒风险评估：** 提供的代码片段主要是 Ansible 配置文件，用于配置 scapegoat.test 和 attacker.test 两台虚拟机环境，包括安装 MySQL，配置用户，以及一些常用的软件。代码本身用于搭建漏洞利用的环境，可能包含测试漏洞利用的后门代码。但是，从提供的代码片段来看，没有明显的恶意代码注入，但考虑到自动化部署的复杂性，仍存在一定的风险，主要是自动化脚本可能被植入恶意代码，安装不需要软件。风险评估为5%。

**利用方式总结：**

该漏洞的核心在于利用 MySQL 的 `general_log_file` 配置项，允许低权限用户覆盖配置文件，进而通过 `malloc_lib` 设置加载恶意动态链接库，最终实现以 root 权限执行任意代码。攻击者需要有权限连接到数据库，然后才能修改配置或执行 SQL 语句来触发漏洞。


**项目地址:** [KosukeShimofuji/CVE-2016-6662](https://github.com/KosukeShimofuji/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #3

**来源**: [CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md](../2016/CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md)

# CVE-2016-6662

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md](../2016/CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可导致远程代码执行和权限提升至root

**影响版本:** MySQL <= 5.7.14, 5.6.32, 5.5.51; MariaDB; PerconaDB

**利用条件:** 需要本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置，创建任意配置并绕过某些保护机制。搜索引擎结果和漏洞库信息均确认了该漏洞的存在，并且影响 MySQL、MariaDB 和 PerconaDB 的多个版本。利用方式是通过修改 my.cnf 配置文件，例如设置 malloc_lib，从而执行任意代码。mysqld_safe 脚本以 root 权限运行，如果攻击者能够修改 my.cnf，则可以利用此漏洞以 root 权限执行代码。提供的POC代码描述了漏洞原理和利用方法。投毒风险较低（10%），因为POC代码主要提供漏洞利用的描述和原理，没有直接发现恶意代码，但存在恶意修改利用代码的可能性。

**项目地址:** [Ashrafdev/MySQL-Remote-Root-Code-Execution](https://github.com/Ashrafdev/MySQL-Remote-Root-Code-Execution)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #2

**来源**: [CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md](../2016/CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全控制数据库服务器

**影响版本:** MySQL (<= 5.5.52, <= 5.6.33, <= 5.7.15), MariaDB (< 5.5.51, < 10.0.27, < 10.1.17), Percona Server (< 5.5.51-38.1, < 5.6.32-78.0, < 5.7.14-7)

**利用条件:** 本地用户或具有数据库连接权限的远程用户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 到一个恶意的 `my.cnf` 配置文件来创建任意配置，并绕过某些保护机制。这可以被利用来以 root 权限执行任意代码，通过设置 `malloc_lib`。利用方式如下：

1.  **利用前提：** 具有 MySQL 用户权限（即使权限很低）。
2.  **修改配置文件：** 攻击者可以尝试修改 MySQL 的配置文件（my.cnf），或者通过 SQL 语句设置 `general_log_file` 参数指向一个由攻击者控制的文件。
3.  **写入恶意配置：** 将恶意的配置写入到 `general_log_file` 指定的文件中，例如设置 `malloc_lib` 指向恶意动态链接库。
4.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意配置生效。
5.  **代码执行：**  恶意动态链接库被加载，攻击者控制的代码以 root 权限执行。

**有效性评估：** 根据漏洞库信息和搜索结果，该漏洞的POC是有效的。已经存在公开的利用代码，并且该漏洞已经被广泛讨论和利用。

**投毒风险评估：** 提供的代码片段主要是 Ansible 配置文件，用于配置 scapegoat.test 和 attacker.test 两台虚拟机环境，包括安装 MySQL，配置用户，以及一些常用的软件。代码本身用于搭建漏洞利用的环境，可能包含测试漏洞利用的后门代码。但是，从提供的代码片段来看，没有明显的恶意代码注入，但考虑到自动化部署的复杂性，仍存在一定的风险，主要是自动化脚本可能被植入恶意代码，安装不需要软件。风险评估为5%。

**利用方式总结：**

该漏洞的核心在于利用 MySQL 的 `general_log_file` 配置项，允许低权限用户覆盖配置文件，进而通过 `malloc_lib` 设置加载恶意动态链接库，最终实现以 root 权限执行任意代码。攻击者需要有权限连接到数据库，然后才能修改配置或执行 SQL 语句来触发漏洞。


**项目地址:** [KosukeShimofuji/CVE-2016-6662](https://github.com/KosukeShimofuji/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #3

**来源**: [CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md](../2016/CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md)

# CVE-2016-6662

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md](../2016/CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可导致远程代码执行和权限提升至root

**影响版本:** MySQL <= 5.7.14, 5.6.32, 5.5.51; MariaDB; PerconaDB

**利用条件:** 需要本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置，创建任意配置并绕过某些保护机制。搜索引擎结果和漏洞库信息均确认了该漏洞的存在，并且影响 MySQL、MariaDB 和 PerconaDB 的多个版本。利用方式是通过修改 my.cnf 配置文件，例如设置 malloc_lib，从而执行任意代码。mysqld_safe 脚本以 root 权限运行，如果攻击者能够修改 my.cnf，则可以利用此漏洞以 root 权限执行代码。提供的POC代码描述了漏洞原理和利用方法。投毒风险较低（10%），因为POC代码主要提供漏洞利用的描述和原理，没有直接发现恶意代码，但存在恶意修改利用代码的可能性。

**项目地址:** [Ashrafdev/MySQL-Remote-Root-Code-Execution](https://github.com/Ashrafdev/MySQL-Remote-Root-Code-Execution)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #2

**来源**: [CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md](../2016/CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全控制数据库服务器

**影响版本:** MySQL (<= 5.5.52, <= 5.6.33, <= 5.7.15), MariaDB (< 5.5.51, < 10.0.27, < 10.1.17), Percona Server (< 5.5.51-38.1, < 5.6.32-78.0, < 5.7.14-7)

**利用条件:** 本地用户或具有数据库连接权限的远程用户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 到一个恶意的 `my.cnf` 配置文件来创建任意配置，并绕过某些保护机制。这可以被利用来以 root 权限执行任意代码，通过设置 `malloc_lib`。利用方式如下：

1.  **利用前提：** 具有 MySQL 用户权限（即使权限很低）。
2.  **修改配置文件：** 攻击者可以尝试修改 MySQL 的配置文件（my.cnf），或者通过 SQL 语句设置 `general_log_file` 参数指向一个由攻击者控制的文件。
3.  **写入恶意配置：** 将恶意的配置写入到 `general_log_file` 指定的文件中，例如设置 `malloc_lib` 指向恶意动态链接库。
4.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意配置生效。
5.  **代码执行：**  恶意动态链接库被加载，攻击者控制的代码以 root 权限执行。

**有效性评估：** 根据漏洞库信息和搜索结果，该漏洞的POC是有效的。已经存在公开的利用代码，并且该漏洞已经被广泛讨论和利用。

**投毒风险评估：** 提供的代码片段主要是 Ansible 配置文件，用于配置 scapegoat.test 和 attacker.test 两台虚拟机环境，包括安装 MySQL，配置用户，以及一些常用的软件。代码本身用于搭建漏洞利用的环境，可能包含测试漏洞利用的后门代码。但是，从提供的代码片段来看，没有明显的恶意代码注入，但考虑到自动化部署的复杂性，仍存在一定的风险，主要是自动化脚本可能被植入恶意代码，安装不需要软件。风险评估为5%。

**利用方式总结：**

该漏洞的核心在于利用 MySQL 的 `general_log_file` 配置项，允许低权限用户覆盖配置文件，进而通过 `malloc_lib` 设置加载恶意动态链接库，最终实现以 root 权限执行任意代码。攻击者需要有权限连接到数据库，然后才能修改配置或执行 SQL 语句来触发漏洞。


**项目地址:** [KosukeShimofuji/CVE-2016-6662](https://github.com/KosukeShimofuji/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #3

**来源**: [CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md](../2016/CVE-2016-6662-LSQUARE14_SQL_to_RCE_Lab.md)

# CVE-2016-6662

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md](../2016/CVE-2016-6662-Ashrafdev_MySQL-Remote-Root-Code-Execution.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可导致远程代码执行和权限提升至root

**影响版本:** MySQL <= 5.7.14, 5.6.32, 5.5.51; MariaDB; PerconaDB

**利用条件:** 需要本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置，创建任意配置并绕过某些保护机制。搜索引擎结果和漏洞库信息均确认了该漏洞的存在，并且影响 MySQL、MariaDB 和 PerconaDB 的多个版本。利用方式是通过修改 my.cnf 配置文件，例如设置 malloc_lib，从而执行任意代码。mysqld_safe 脚本以 root 权限运行，如果攻击者能够修改 my.cnf，则可以利用此漏洞以 root 权限执行代码。提供的POC代码描述了漏洞原理和利用方法。投毒风险较低（10%），因为POC代码主要提供漏洞利用的描述和原理，没有直接发现恶意代码，但存在恶意修改利用代码的可能性。

**项目地址:** [Ashrafdev/MySQL-Remote-Root-Code-Execution](https://github.com/Ashrafdev/MySQL-Remote-Root-Code-Execution)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #2

**来源**: [CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md](../2016/CVE-2016-6662-KosukeShimofuji_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全控制数据库服务器

**影响版本:** MySQL (<= 5.5.52, <= 5.6.33, <= 5.7.15), MariaDB (< 5.5.51, < 10.0.27, < 10.1.17), Percona Server (< 5.5.51-38.1, < 5.6.32-78.0, < 5.7.14-7)

**利用条件:** 本地用户或具有数据库连接权限的远程用户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 到一个恶意的 `my.cnf` 配置文件来创建任意配置，并绕过某些保护机制。这可以被利用来以 root 权限执行任意代码，通过设置 `malloc_lib`。利用方式如下：

1.  **利用前提：** 具有 MySQL 用户权限（即使权限很低）。
2.  **修改配置文件：** 攻击者可以尝试修改 MySQL 的配置文件（my.cnf），或者通过 SQL 语句设置 `general_log_file` 参数指向一个由攻击者控制的文件。
3.  **写入恶意配置：** 将恶意的配置写入到 `general_log_file` 指定的文件中，例如设置 `malloc_lib` 指向恶意动态链接库。
4.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意配置生效。
5.  **代码执行：**  恶意动态链接库被加载，攻击者控制的代码以 root 权限执行。

**有效性评估：** 根据漏洞库信息和搜索结果，该漏洞的POC是有效的。已经存在公开的利用代码，并且该漏洞已经被广泛讨论和利用。

**投毒风险评估：** 提供的代码片段主要是 Ansible 配置文件，用于配置 scapegoat.test 和 attacker.test 两台虚拟机环境，包括安装 MySQL，配置用户，以及一些常用的软件。代码本身用于搭建漏洞利用的环境，可能包含测试漏洞利用的后门代码。但是，从提供的代码片段来看，没有明显的恶意代码注入，但考虑到自动化部署的复杂性，仍存在一定的风险，主要是自动化脚本可能被植入恶意代码，安装不需要软件。风险评估为5%。

**利用方式总结：**

该漏洞的核心在于利用 MySQL 的 `general_log_file` 配置项，允许低权限用户覆盖配置文件，进而通过 `malloc_lib` 设置加载恶意动态链接库，最终实现以 root 权限执行任意代码。攻击者需要有权限连接到数据库，然后才能修改配置或执行 SQL 语句来触发漏洞。


**项目地址:** [KosukeShimofuji/CVE-2016-6662](https://github.com/KosukeShimofuji/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #3

**来源**: [CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md](../2016/CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 配置覆盖/本地权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，允许本地用户创建任意配置并绕过某些保护机制，最终导致以 root 权限执行任意代码

**影响版本:** MySQL through 5.5.52, 5.6.x through 5.6.33, and 5.7.x through 5.7.15; MariaDB before 5.5.51, 10.0.x before 10.0.27, and 10.1.x before 10.1.17; and Percona Server before 5.5.51-38.1, 5.6.x before 5.6.32-78.0, and 5.7.x before 5.7.14-7

**利用条件:** 需要具备对 MySQL 数据库一定的写入权限（如通过 SQL 注入）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 漏洞允许攻击者通过设置 `general_log_file` 到 `my.cnf` 配置文件来创建任意配置，从而绕过某些保护机制。更进一步，通过设置 `malloc_lib` 选项，可以加载恶意动态链接库，最终导致以 root 权限执行任意代码。

**利用方式：**

1.  **前提条件：** 攻击者需要通过某种方式（例如 SQL 注入）获取对 MySQL 数据库的写入权限。
2.  **写入恶意配置：**  攻击者利用 SQL 注入漏洞，将 `general_log_file` 设置为一个精心构造的 `my.cnf` 配置文件路径，该配置文件中包含恶意的 `malloc_lib` 选项。
3.  **上传恶意动态链接库：**  攻击者将包含恶意代码的动态链接库（`mysql_hookandroot_lib.so`）上传到服务器上的某个可写目录（如 `/var/lib/mysql/`）。
4.  **触发漏洞：**  攻击者通过触发 MySQL 的日志功能，使 MySQL 加载并解析恶意的 `my.cnf` 配置文件，从而加载恶意动态链接库。
5.  **代码执行：**  恶意动态链接库中的代码被执行，攻击者获得 root 权限。

**POC 代码分析：**

提供的 Python 脚本 `From SQL injection to root shell.py` 实现了上述利用流程：

*   `craft_payloads()` 函数生成用于利用漏洞的 SQL 注入 payload。
*   该函数首先创建恶意触发器，该触发器将恶意配置写入 `my.cnf` 文件。
*   然后，该函数将恶意动态链接库 `mysql_hookandroot_lib.so` 的内容写入服务器上的文件。
*   最后，该函数创建 `poctable` 表，并通过插入数据来触发恶意触发器，从而执行代码。

**有效性：**

根据漏洞描述和提供的 POC 代码，该漏洞利用方法是有效的，只要满足利用条件（例如可写权限和特定 MySQL 版本）。

**投毒风险：**

该 POC 代码的主要目的是利用漏洞，但存在一定的投毒风险。 虽然大部分代码是为了验证和利用漏洞，但攻击者可能会在 `mysql_hookandroot_lib.so` 中添加后门或其他恶意功能，从而在成功利用漏洞后保持对系统的长期访问。 这里的投毒风险评估为10%, 主要体现在`mysql_hookandroot_lib.so` 恶意动态链接库上，如果该链接库被替换成具有其他恶意功能的链接库，则可能造成危害。


**项目地址:** [MAYASEVEN/CVE-2016-6662](https://github.com/MAYASEVEN/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #4

**来源**: [CVE-2016-6662-boompig_cve-2016-6662.md](../2016/CVE-2016-6662-boompig_cve-2016-6662.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可导致数据库服务器完全控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 需要能够修改MySQL配置文件 (my.cnf) 并且目标服务器运行受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 选项为 `my.cnf` 配置文件，创建任意配置并绕过某些保护机制。 这可以被利用来执行具有 root 权限的任意代码，通过设置 `malloc_lib` 选项。提供的PoC代码 `0ldSQL_MySQL_RCE_exploit.py` 是一个有限的版本，仅允许附加到现有 MySQL 配置文件的末尾。完整利用需要目标my.cnf具有mysql用户可写的权限。利用方式如下：

1.  **编译恶意共享库 (mysql_hookandroot_lib.so):**  该库包含恶意代码，用于提权和执行命令。
2.  **将恶意库转换为十六进制:** 将编译好的共享库内容转换为十六进制字符串。
3.  **利用SQL注入或其它方式修改my.cnf:**  将`malloc_lib`设置为恶意共享库的路径，并将`general_log_file`设置为`my.cnf`。需要具有FILE权限。
4.  **重启 MySQL 服务:**  重启后，MySQL将加载恶意共享库，执行其中的代码，从而获得 root 权限。

**投毒风险分析:**

该PoC代码的投毒风险较低 (10%)。PoC本身的功能是演示如何利用漏洞，并包含编译shellcode等必要步骤。然而，不排除作者在编译恶意库的过程中可能隐藏恶意代码的可能性。因此，在使用该PoC时，务必仔细审查代码，特别是 `mysql_hookandroot_lib.c` 文件，并进行代码审计以确保其安全性。

搜索引擎结果表明，该漏洞影响广泛，多个厂商的MySQL发行版都受影响。修复方案包括升级到最新版本或应用厂商提供的补丁。

**项目地址:** [boompig/cve-2016-6662](https://github.com/boompig/cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #5

**来源**: [CVE-2016-6662-kanyaars_CVE-2016-6662.md](../2016/CVE-2016-6662-kanyaars_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户或具有FILE权限的远程用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户（或具有FILE权限的远程用户）通过设置 `general_log_file` 到 `my.cnf` 配置来创建任意配置和绕过某些保护机制。更严重的是，这可以被利用通过设置 `malloc_lib` 来执行具有 root 权限的任意代码。

**利用方式：**

1.  **写入恶意配置：** 攻击者利用数据库的FILE权限，将`general_log_file`指向一个攻击者可控的文件。这个文件会被解析为MySQL的配置文件。
2.  **设置malloc_lib：** 在该配置文件中，攻击者设置`malloc_lib`指向一个恶意的动态链接库（.so文件）。
3.  **重启MySQL服务：** 当MySQL服务重启时，会加载`malloc_lib`指定的恶意动态链接库，从而执行攻击者预设的恶意代码，获得服务器的root权限。

**POC分析：**
提供的POC代码包含两个文件：一个C语言编写的动态链接库 (`911KanyaLab_lib.c`) 和一个 Python 脚本 (`Exploit_Old_MySQL_Kay_ver.py`)。

*   **`911KanyaLab_lib.c`：** 这个C代码会被编译成`.so`文件。它定义了一个`execvp` hook函数，用于在MySQL启动时执行恶意代码。恶意代码的功能是创建一个反向Shell，连接到攻击者的IP地址和端口。
*   **`Exploit_Old_MySQL_Kay_ver.py`：** 这个Python脚本负责连接到目标MySQL服务器，上传并配置恶意的`.so`文件，并触发MySQL重启。

**投毒风险分析：**
代码主要逻辑是创建反向shell，连接攻击者的机器。存在投毒的可能。分析得出存在以下潜在的投毒风险:
*   C代码中IP地址和端口是硬编码的，如果攻击者篡改这些值，可能会将shell连接到其他恶意服务器。但是从代码逻辑来判断是为了完成漏洞验证的必要后门代码。
*   Python脚本需要指定MySQL用户名、密码、数据库名和`my.cnf`路径，这些信息可能被记录或泄露。
*   `config_cleanup()`函数的功能是清除注入的配置，但如果实现不正确，可能留下痕迹。

整体代码质量不高，存在一些硬编码，但主要功能符合漏洞描述，总体上是可信的。 但是依然存在作者隐藏的投毒代码的可能，但是可能性较低。

**项目地址:** [kanyaars/CVE-2016-6662](https://github.com/kanyaars/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #6

**来源**: [CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md](../2016/CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md)

## CVE-2016-6662 - MySQL/MariaDB/PerconaDB 权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** MySQL: <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB: < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server: < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这可以被利用来通过设置 malloc_lib 以 root 权限执行任意代码。根据搜索结果，这是一个严重的安全漏洞，影响多个 MySQL 及其分支版本。利用方式通常涉及修改MySQL的配置文件，将 general_log_file 指向攻击者可控的文件，并在其中写入恶意配置，例如加载恶意动态链接库以执行任意代码。提供的Playbook 旨在通过添加安全检查来修补 `mysqld_safe` 脚本，防止从非标准系统目录加载 `ld_preload` 库。因此，此 Playbook 实际上是一个补丁，并非漏洞利用代码。Playbook 代码本身旨在修复漏洞，未发现隐藏的恶意代码，因此投毒风险为0%。根据漏洞信息和搜索结果，此漏洞影响广泛，需要尽快修复。

**项目地址:** [konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch](https://github.com/konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #7

**来源**: [CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md](../2016/CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md)

## CVE-2016-6662 - MySQL 远程 Root 代码执行/权限提升

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致数据库完全控制和服务器接管

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或 SQL 注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 选项到 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这个漏洞可以被利用来以 root 权限执行任意代码，通过设置 malloc_lib 选项指向恶意 .so 文件。此利用方式依赖于可以写入 MySQL 配置文件，并重启 MySQL 服务。 

**有效性：** 提供的 Ansible 脚本旨在修复此漏洞，而非利用它。它通过修改 mysqld_safe 脚本，限制 .so 文件的加载路径到标准系统目录，并检查默认配置文件的存在性和权限来缓解风险，因此提供的代码是用于防御而不是利用的。

**投毒风险：**  该仓库本身包含的是修复漏洞的脚本，直接投毒的可能性较低。但是，仍然存在以下风险：

1.  **脚本本身可能存在缺陷：**  虽然脚本旨在修复漏洞，但如果脚本本身存在逻辑错误或未考虑到的情况，可能会导致 MySQL 服务不稳定或其他问题。 
2.  **供应链攻击：**  该仓库可能被黑客入侵，然后植入恶意代码。由于脚本需要修改系统文件和重启服务，一旦被植入恶意代码，危害非常大。 
3.  **依赖关系：**  该脚本可能依赖其他软件包或库，这些依赖项可能存在漏洞。  
综合考虑，投毒风险评估为 10%。 这个百分比是因为代码主要是防御性的，并且已经经过了相当数量的安装验证，降低了直接恶意代码的可能性。但供应链风险和脚本缺陷始终存在。

**利用方式：**

1.  **利用条件：**  需要拥有对 MySQL 服务器的本地用户权限或者能够通过 SQL 注入漏洞执行命令。
2.  **写入恶意配置：**  利用权限，将 `general_log_file` 设置为指向包含恶意配置的文件的路径。恶意配置中，设置 `malloc_lib` 指向恶意的 .so 文件。
3.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意 .so 文件被加载，从而执行任意代码。

搜索结果也表明，可以通过 SQL 注入来利用这个漏洞，意味着攻击者不需要本地账户，可以通过SQL注入写入配置，然后利用此漏洞提权至root。


**项目地址:** [meersjo/ansible-mysql-cve-2016-6662](https://github.com/meersjo/ansible-mysql-cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---



---

## POC #4

**来源**: [CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md](../2016/CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 配置覆盖/本地权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，允许本地用户创建任意配置并绕过某些保护机制，最终导致以 root 权限执行任意代码

**影响版本:** MySQL through 5.5.52, 5.6.x through 5.6.33, and 5.7.x through 5.7.15; MariaDB before 5.5.51, 10.0.x before 10.0.27, and 10.1.x before 10.1.17; and Percona Server before 5.5.51-38.1, 5.6.x before 5.6.32-78.0, and 5.7.x before 5.7.14-7

**利用条件:** 需要具备对 MySQL 数据库一定的写入权限（如通过 SQL 注入）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 漏洞允许攻击者通过设置 `general_log_file` 到 `my.cnf` 配置文件来创建任意配置，从而绕过某些保护机制。更进一步，通过设置 `malloc_lib` 选项，可以加载恶意动态链接库，最终导致以 root 权限执行任意代码。

**利用方式：**

1.  **前提条件：** 攻击者需要通过某种方式（例如 SQL 注入）获取对 MySQL 数据库的写入权限。
2.  **写入恶意配置：**  攻击者利用 SQL 注入漏洞，将 `general_log_file` 设置为一个精心构造的 `my.cnf` 配置文件路径，该配置文件中包含恶意的 `malloc_lib` 选项。
3.  **上传恶意动态链接库：**  攻击者将包含恶意代码的动态链接库（`mysql_hookandroot_lib.so`）上传到服务器上的某个可写目录（如 `/var/lib/mysql/`）。
4.  **触发漏洞：**  攻击者通过触发 MySQL 的日志功能，使 MySQL 加载并解析恶意的 `my.cnf` 配置文件，从而加载恶意动态链接库。
5.  **代码执行：**  恶意动态链接库中的代码被执行，攻击者获得 root 权限。

**POC 代码分析：**

提供的 Python 脚本 `From SQL injection to root shell.py` 实现了上述利用流程：

*   `craft_payloads()` 函数生成用于利用漏洞的 SQL 注入 payload。
*   该函数首先创建恶意触发器，该触发器将恶意配置写入 `my.cnf` 文件。
*   然后，该函数将恶意动态链接库 `mysql_hookandroot_lib.so` 的内容写入服务器上的文件。
*   最后，该函数创建 `poctable` 表，并通过插入数据来触发恶意触发器，从而执行代码。

**有效性：**

根据漏洞描述和提供的 POC 代码，该漏洞利用方法是有效的，只要满足利用条件（例如可写权限和特定 MySQL 版本）。

**投毒风险：**

该 POC 代码的主要目的是利用漏洞，但存在一定的投毒风险。 虽然大部分代码是为了验证和利用漏洞，但攻击者可能会在 `mysql_hookandroot_lib.so` 中添加后门或其他恶意功能，从而在成功利用漏洞后保持对系统的长期访问。 这里的投毒风险评估为10%, 主要体现在`mysql_hookandroot_lib.so` 恶意动态链接库上，如果该链接库被替换成具有其他恶意功能的链接库，则可能造成危害。


**项目地址:** [MAYASEVEN/CVE-2016-6662](https://github.com/MAYASEVEN/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #5

**来源**: [CVE-2016-6662-boompig_cve-2016-6662.md](../2016/CVE-2016-6662-boompig_cve-2016-6662.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可导致数据库服务器完全控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 需要能够修改MySQL配置文件 (my.cnf) 并且目标服务器运行受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 选项为 `my.cnf` 配置文件，创建任意配置并绕过某些保护机制。 这可以被利用来执行具有 root 权限的任意代码，通过设置 `malloc_lib` 选项。提供的PoC代码 `0ldSQL_MySQL_RCE_exploit.py` 是一个有限的版本，仅允许附加到现有 MySQL 配置文件的末尾。完整利用需要目标my.cnf具有mysql用户可写的权限。利用方式如下：

1.  **编译恶意共享库 (mysql_hookandroot_lib.so):**  该库包含恶意代码，用于提权和执行命令。
2.  **将恶意库转换为十六进制:** 将编译好的共享库内容转换为十六进制字符串。
3.  **利用SQL注入或其它方式修改my.cnf:**  将`malloc_lib`设置为恶意共享库的路径，并将`general_log_file`设置为`my.cnf`。需要具有FILE权限。
4.  **重启 MySQL 服务:**  重启后，MySQL将加载恶意共享库，执行其中的代码，从而获得 root 权限。

**投毒风险分析:**

该PoC代码的投毒风险较低 (10%)。PoC本身的功能是演示如何利用漏洞，并包含编译shellcode等必要步骤。然而，不排除作者在编译恶意库的过程中可能隐藏恶意代码的可能性。因此，在使用该PoC时，务必仔细审查代码，特别是 `mysql_hookandroot_lib.c` 文件，并进行代码审计以确保其安全性。

搜索引擎结果表明，该漏洞影响广泛，多个厂商的MySQL发行版都受影响。修复方案包括升级到最新版本或应用厂商提供的补丁。

**项目地址:** [boompig/cve-2016-6662](https://github.com/boompig/cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #6

**来源**: [CVE-2016-6662-kanyaars_CVE-2016-6662.md](../2016/CVE-2016-6662-kanyaars_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户或具有FILE权限的远程用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户（或具有FILE权限的远程用户）通过设置 `general_log_file` 到 `my.cnf` 配置来创建任意配置和绕过某些保护机制。更严重的是，这可以被利用通过设置 `malloc_lib` 来执行具有 root 权限的任意代码。

**利用方式：**

1.  **写入恶意配置：** 攻击者利用数据库的FILE权限，将`general_log_file`指向一个攻击者可控的文件。这个文件会被解析为MySQL的配置文件。
2.  **设置malloc_lib：** 在该配置文件中，攻击者设置`malloc_lib`指向一个恶意的动态链接库（.so文件）。
3.  **重启MySQL服务：** 当MySQL服务重启时，会加载`malloc_lib`指定的恶意动态链接库，从而执行攻击者预设的恶意代码，获得服务器的root权限。

**POC分析：**
提供的POC代码包含两个文件：一个C语言编写的动态链接库 (`911KanyaLab_lib.c`) 和一个 Python 脚本 (`Exploit_Old_MySQL_Kay_ver.py`)。

*   **`911KanyaLab_lib.c`：** 这个C代码会被编译成`.so`文件。它定义了一个`execvp` hook函数，用于在MySQL启动时执行恶意代码。恶意代码的功能是创建一个反向Shell，连接到攻击者的IP地址和端口。
*   **`Exploit_Old_MySQL_Kay_ver.py`：** 这个Python脚本负责连接到目标MySQL服务器，上传并配置恶意的`.so`文件，并触发MySQL重启。

**投毒风险分析：**
代码主要逻辑是创建反向shell，连接攻击者的机器。存在投毒的可能。分析得出存在以下潜在的投毒风险:
*   C代码中IP地址和端口是硬编码的，如果攻击者篡改这些值，可能会将shell连接到其他恶意服务器。但是从代码逻辑来判断是为了完成漏洞验证的必要后门代码。
*   Python脚本需要指定MySQL用户名、密码、数据库名和`my.cnf`路径，这些信息可能被记录或泄露。
*   `config_cleanup()`函数的功能是清除注入的配置，但如果实现不正确，可能留下痕迹。

整体代码质量不高，存在一些硬编码，但主要功能符合漏洞描述，总体上是可信的。 但是依然存在作者隐藏的投毒代码的可能，但是可能性较低。

**项目地址:** [kanyaars/CVE-2016-6662](https://github.com/kanyaars/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #7

**来源**: [CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md](../2016/CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md)

## CVE-2016-6662 - MySQL/MariaDB/PerconaDB 权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** MySQL: <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB: < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server: < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这可以被利用来通过设置 malloc_lib 以 root 权限执行任意代码。根据搜索结果，这是一个严重的安全漏洞，影响多个 MySQL 及其分支版本。利用方式通常涉及修改MySQL的配置文件，将 general_log_file 指向攻击者可控的文件，并在其中写入恶意配置，例如加载恶意动态链接库以执行任意代码。提供的Playbook 旨在通过添加安全检查来修补 `mysqld_safe` 脚本，防止从非标准系统目录加载 `ld_preload` 库。因此，此 Playbook 实际上是一个补丁，并非漏洞利用代码。Playbook 代码本身旨在修复漏洞，未发现隐藏的恶意代码，因此投毒风险为0%。根据漏洞信息和搜索结果，此漏洞影响广泛，需要尽快修复。

**项目地址:** [konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch](https://github.com/konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #8

**来源**: [CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md](../2016/CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md)

## CVE-2016-6662 - MySQL 远程 Root 代码执行/权限提升

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致数据库完全控制和服务器接管

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或 SQL 注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 选项到 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这个漏洞可以被利用来以 root 权限执行任意代码，通过设置 malloc_lib 选项指向恶意 .so 文件。此利用方式依赖于可以写入 MySQL 配置文件，并重启 MySQL 服务。 

**有效性：** 提供的 Ansible 脚本旨在修复此漏洞，而非利用它。它通过修改 mysqld_safe 脚本，限制 .so 文件的加载路径到标准系统目录，并检查默认配置文件的存在性和权限来缓解风险，因此提供的代码是用于防御而不是利用的。

**投毒风险：**  该仓库本身包含的是修复漏洞的脚本，直接投毒的可能性较低。但是，仍然存在以下风险：

1.  **脚本本身可能存在缺陷：**  虽然脚本旨在修复漏洞，但如果脚本本身存在逻辑错误或未考虑到的情况，可能会导致 MySQL 服务不稳定或其他问题。 
2.  **供应链攻击：**  该仓库可能被黑客入侵，然后植入恶意代码。由于脚本需要修改系统文件和重启服务，一旦被植入恶意代码，危害非常大。 
3.  **依赖关系：**  该脚本可能依赖其他软件包或库，这些依赖项可能存在漏洞。  
综合考虑，投毒风险评估为 10%。 这个百分比是因为代码主要是防御性的，并且已经经过了相当数量的安装验证，降低了直接恶意代码的可能性。但供应链风险和脚本缺陷始终存在。

**利用方式：**

1.  **利用条件：**  需要拥有对 MySQL 服务器的本地用户权限或者能够通过 SQL 注入漏洞执行命令。
2.  **写入恶意配置：**  利用权限，将 `general_log_file` 设置为指向包含恶意配置的文件的路径。恶意配置中，设置 `malloc_lib` 指向恶意的 .so 文件。
3.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意 .so 文件被加载，从而执行任意代码。

搜索结果也表明，可以通过 SQL 注入来利用这个漏洞，意味着攻击者不需要本地账户，可以通过SQL注入写入配置，然后利用此漏洞提权至root。


**项目地址:** [meersjo/ansible-mysql-cve-2016-6662](https://github.com/meersjo/ansible-mysql-cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---



---

## POC #4

**来源**: [CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md](../2016/CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 配置覆盖/本地权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，允许本地用户创建任意配置并绕过某些保护机制，最终导致以 root 权限执行任意代码

**影响版本:** MySQL through 5.5.52, 5.6.x through 5.6.33, and 5.7.x through 5.7.15; MariaDB before 5.5.51, 10.0.x before 10.0.27, and 10.1.x before 10.1.17; and Percona Server before 5.5.51-38.1, 5.6.x before 5.6.32-78.0, and 5.7.x before 5.7.14-7

**利用条件:** 需要具备对 MySQL 数据库一定的写入权限（如通过 SQL 注入）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 漏洞允许攻击者通过设置 `general_log_file` 到 `my.cnf` 配置文件来创建任意配置，从而绕过某些保护机制。更进一步，通过设置 `malloc_lib` 选项，可以加载恶意动态链接库，最终导致以 root 权限执行任意代码。

**利用方式：**

1.  **前提条件：** 攻击者需要通过某种方式（例如 SQL 注入）获取对 MySQL 数据库的写入权限。
2.  **写入恶意配置：**  攻击者利用 SQL 注入漏洞，将 `general_log_file` 设置为一个精心构造的 `my.cnf` 配置文件路径，该配置文件中包含恶意的 `malloc_lib` 选项。
3.  **上传恶意动态链接库：**  攻击者将包含恶意代码的动态链接库（`mysql_hookandroot_lib.so`）上传到服务器上的某个可写目录（如 `/var/lib/mysql/`）。
4.  **触发漏洞：**  攻击者通过触发 MySQL 的日志功能，使 MySQL 加载并解析恶意的 `my.cnf` 配置文件，从而加载恶意动态链接库。
5.  **代码执行：**  恶意动态链接库中的代码被执行，攻击者获得 root 权限。

**POC 代码分析：**

提供的 Python 脚本 `From SQL injection to root shell.py` 实现了上述利用流程：

*   `craft_payloads()` 函数生成用于利用漏洞的 SQL 注入 payload。
*   该函数首先创建恶意触发器，该触发器将恶意配置写入 `my.cnf` 文件。
*   然后，该函数将恶意动态链接库 `mysql_hookandroot_lib.so` 的内容写入服务器上的文件。
*   最后，该函数创建 `poctable` 表，并通过插入数据来触发恶意触发器，从而执行代码。

**有效性：**

根据漏洞描述和提供的 POC 代码，该漏洞利用方法是有效的，只要满足利用条件（例如可写权限和特定 MySQL 版本）。

**投毒风险：**

该 POC 代码的主要目的是利用漏洞，但存在一定的投毒风险。 虽然大部分代码是为了验证和利用漏洞，但攻击者可能会在 `mysql_hookandroot_lib.so` 中添加后门或其他恶意功能，从而在成功利用漏洞后保持对系统的长期访问。 这里的投毒风险评估为10%, 主要体现在`mysql_hookandroot_lib.so` 恶意动态链接库上，如果该链接库被替换成具有其他恶意功能的链接库，则可能造成危害。


**项目地址:** [MAYASEVEN/CVE-2016-6662](https://github.com/MAYASEVEN/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #5

**来源**: [CVE-2016-6662-boompig_cve-2016-6662.md](../2016/CVE-2016-6662-boompig_cve-2016-6662.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可导致数据库服务器完全控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 需要能够修改MySQL配置文件 (my.cnf) 并且目标服务器运行受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 选项为 `my.cnf` 配置文件，创建任意配置并绕过某些保护机制。 这可以被利用来执行具有 root 权限的任意代码，通过设置 `malloc_lib` 选项。提供的PoC代码 `0ldSQL_MySQL_RCE_exploit.py` 是一个有限的版本，仅允许附加到现有 MySQL 配置文件的末尾。完整利用需要目标my.cnf具有mysql用户可写的权限。利用方式如下：

1.  **编译恶意共享库 (mysql_hookandroot_lib.so):**  该库包含恶意代码，用于提权和执行命令。
2.  **将恶意库转换为十六进制:** 将编译好的共享库内容转换为十六进制字符串。
3.  **利用SQL注入或其它方式修改my.cnf:**  将`malloc_lib`设置为恶意共享库的路径，并将`general_log_file`设置为`my.cnf`。需要具有FILE权限。
4.  **重启 MySQL 服务:**  重启后，MySQL将加载恶意共享库，执行其中的代码，从而获得 root 权限。

**投毒风险分析:**

该PoC代码的投毒风险较低 (10%)。PoC本身的功能是演示如何利用漏洞，并包含编译shellcode等必要步骤。然而，不排除作者在编译恶意库的过程中可能隐藏恶意代码的可能性。因此，在使用该PoC时，务必仔细审查代码，特别是 `mysql_hookandroot_lib.c` 文件，并进行代码审计以确保其安全性。

搜索引擎结果表明，该漏洞影响广泛，多个厂商的MySQL发行版都受影响。修复方案包括升级到最新版本或应用厂商提供的补丁。

**项目地址:** [boompig/cve-2016-6662](https://github.com/boompig/cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #6

**来源**: [CVE-2016-6662-kanyaars_CVE-2016-6662.md](../2016/CVE-2016-6662-kanyaars_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户或具有FILE权限的远程用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户（或具有FILE权限的远程用户）通过设置 `general_log_file` 到 `my.cnf` 配置来创建任意配置和绕过某些保护机制。更严重的是，这可以被利用通过设置 `malloc_lib` 来执行具有 root 权限的任意代码。

**利用方式：**

1.  **写入恶意配置：** 攻击者利用数据库的FILE权限，将`general_log_file`指向一个攻击者可控的文件。这个文件会被解析为MySQL的配置文件。
2.  **设置malloc_lib：** 在该配置文件中，攻击者设置`malloc_lib`指向一个恶意的动态链接库（.so文件）。
3.  **重启MySQL服务：** 当MySQL服务重启时，会加载`malloc_lib`指定的恶意动态链接库，从而执行攻击者预设的恶意代码，获得服务器的root权限。

**POC分析：**
提供的POC代码包含两个文件：一个C语言编写的动态链接库 (`911KanyaLab_lib.c`) 和一个 Python 脚本 (`Exploit_Old_MySQL_Kay_ver.py`)。

*   **`911KanyaLab_lib.c`：** 这个C代码会被编译成`.so`文件。它定义了一个`execvp` hook函数，用于在MySQL启动时执行恶意代码。恶意代码的功能是创建一个反向Shell，连接到攻击者的IP地址和端口。
*   **`Exploit_Old_MySQL_Kay_ver.py`：** 这个Python脚本负责连接到目标MySQL服务器，上传并配置恶意的`.so`文件，并触发MySQL重启。

**投毒风险分析：**
代码主要逻辑是创建反向shell，连接攻击者的机器。存在投毒的可能。分析得出存在以下潜在的投毒风险:
*   C代码中IP地址和端口是硬编码的，如果攻击者篡改这些值，可能会将shell连接到其他恶意服务器。但是从代码逻辑来判断是为了完成漏洞验证的必要后门代码。
*   Python脚本需要指定MySQL用户名、密码、数据库名和`my.cnf`路径，这些信息可能被记录或泄露。
*   `config_cleanup()`函数的功能是清除注入的配置，但如果实现不正确，可能留下痕迹。

整体代码质量不高，存在一些硬编码，但主要功能符合漏洞描述，总体上是可信的。 但是依然存在作者隐藏的投毒代码的可能，但是可能性较低。

**项目地址:** [kanyaars/CVE-2016-6662](https://github.com/kanyaars/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #7

**来源**: [CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md](../2016/CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md)

## CVE-2016-6662 - MySQL/MariaDB/PerconaDB 权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** MySQL: <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB: < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server: < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这可以被利用来通过设置 malloc_lib 以 root 权限执行任意代码。根据搜索结果，这是一个严重的安全漏洞，影响多个 MySQL 及其分支版本。利用方式通常涉及修改MySQL的配置文件，将 general_log_file 指向攻击者可控的文件，并在其中写入恶意配置，例如加载恶意动态链接库以执行任意代码。提供的Playbook 旨在通过添加安全检查来修补 `mysqld_safe` 脚本，防止从非标准系统目录加载 `ld_preload` 库。因此，此 Playbook 实际上是一个补丁，并非漏洞利用代码。Playbook 代码本身旨在修复漏洞，未发现隐藏的恶意代码，因此投毒风险为0%。根据漏洞信息和搜索结果，此漏洞影响广泛，需要尽快修复。

**项目地址:** [konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch](https://github.com/konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #8

**来源**: [CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md](../2016/CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md)

## CVE-2016-6662 - MySQL 远程 Root 代码执行/权限提升

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致数据库完全控制和服务器接管

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或 SQL 注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 选项到 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这个漏洞可以被利用来以 root 权限执行任意代码，通过设置 malloc_lib 选项指向恶意 .so 文件。此利用方式依赖于可以写入 MySQL 配置文件，并重启 MySQL 服务。 

**有效性：** 提供的 Ansible 脚本旨在修复此漏洞，而非利用它。它通过修改 mysqld_safe 脚本，限制 .so 文件的加载路径到标准系统目录，并检查默认配置文件的存在性和权限来缓解风险，因此提供的代码是用于防御而不是利用的。

**投毒风险：**  该仓库本身包含的是修复漏洞的脚本，直接投毒的可能性较低。但是，仍然存在以下风险：

1.  **脚本本身可能存在缺陷：**  虽然脚本旨在修复漏洞，但如果脚本本身存在逻辑错误或未考虑到的情况，可能会导致 MySQL 服务不稳定或其他问题。 
2.  **供应链攻击：**  该仓库可能被黑客入侵，然后植入恶意代码。由于脚本需要修改系统文件和重启服务，一旦被植入恶意代码，危害非常大。 
3.  **依赖关系：**  该脚本可能依赖其他软件包或库，这些依赖项可能存在漏洞。  
综合考虑，投毒风险评估为 10%。 这个百分比是因为代码主要是防御性的，并且已经经过了相当数量的安装验证，降低了直接恶意代码的可能性。但供应链风险和脚本缺陷始终存在。

**利用方式：**

1.  **利用条件：**  需要拥有对 MySQL 服务器的本地用户权限或者能够通过 SQL 注入漏洞执行命令。
2.  **写入恶意配置：**  利用权限，将 `general_log_file` 设置为指向包含恶意配置的文件的路径。恶意配置中，设置 `malloc_lib` 指向恶意的 .so 文件。
3.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意 .so 文件被加载，从而执行任意代码。

搜索结果也表明，可以通过 SQL 注入来利用这个漏洞，意味着攻击者不需要本地账户，可以通过SQL注入写入配置，然后利用此漏洞提权至root。


**项目地址:** [meersjo/ansible-mysql-cve-2016-6662](https://github.com/meersjo/ansible-mysql-cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---



---

## POC #4

**来源**: [CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md](../2016/CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 配置覆盖/本地权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，允许本地用户创建任意配置并绕过某些保护机制，最终导致以 root 权限执行任意代码

**影响版本:** MySQL through 5.5.52, 5.6.x through 5.6.33, and 5.7.x through 5.7.15; MariaDB before 5.5.51, 10.0.x before 10.0.27, and 10.1.x before 10.1.17; and Percona Server before 5.5.51-38.1, 5.6.x before 5.6.32-78.0, and 5.7.x before 5.7.14-7

**利用条件:** 需要具备对 MySQL 数据库一定的写入权限（如通过 SQL 注入）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 漏洞允许攻击者通过设置 `general_log_file` 到 `my.cnf` 配置文件来创建任意配置，从而绕过某些保护机制。更进一步，通过设置 `malloc_lib` 选项，可以加载恶意动态链接库，最终导致以 root 权限执行任意代码。

**利用方式：**

1.  **前提条件：** 攻击者需要通过某种方式（例如 SQL 注入）获取对 MySQL 数据库的写入权限。
2.  **写入恶意配置：**  攻击者利用 SQL 注入漏洞，将 `general_log_file` 设置为一个精心构造的 `my.cnf` 配置文件路径，该配置文件中包含恶意的 `malloc_lib` 选项。
3.  **上传恶意动态链接库：**  攻击者将包含恶意代码的动态链接库（`mysql_hookandroot_lib.so`）上传到服务器上的某个可写目录（如 `/var/lib/mysql/`）。
4.  **触发漏洞：**  攻击者通过触发 MySQL 的日志功能，使 MySQL 加载并解析恶意的 `my.cnf` 配置文件，从而加载恶意动态链接库。
5.  **代码执行：**  恶意动态链接库中的代码被执行，攻击者获得 root 权限。

**POC 代码分析：**

提供的 Python 脚本 `From SQL injection to root shell.py` 实现了上述利用流程：

*   `craft_payloads()` 函数生成用于利用漏洞的 SQL 注入 payload。
*   该函数首先创建恶意触发器，该触发器将恶意配置写入 `my.cnf` 文件。
*   然后，该函数将恶意动态链接库 `mysql_hookandroot_lib.so` 的内容写入服务器上的文件。
*   最后，该函数创建 `poctable` 表，并通过插入数据来触发恶意触发器，从而执行代码。

**有效性：**

根据漏洞描述和提供的 POC 代码，该漏洞利用方法是有效的，只要满足利用条件（例如可写权限和特定 MySQL 版本）。

**投毒风险：**

该 POC 代码的主要目的是利用漏洞，但存在一定的投毒风险。 虽然大部分代码是为了验证和利用漏洞，但攻击者可能会在 `mysql_hookandroot_lib.so` 中添加后门或其他恶意功能，从而在成功利用漏洞后保持对系统的长期访问。 这里的投毒风险评估为10%, 主要体现在`mysql_hookandroot_lib.so` 恶意动态链接库上，如果该链接库被替换成具有其他恶意功能的链接库，则可能造成危害。


**项目地址:** [MAYASEVEN/CVE-2016-6662](https://github.com/MAYASEVEN/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #5

**来源**: [CVE-2016-6662-boompig_cve-2016-6662.md](../2016/CVE-2016-6662-boompig_cve-2016-6662.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可导致数据库服务器完全控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 需要能够修改MySQL配置文件 (my.cnf) 并且目标服务器运行受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 选项为 `my.cnf` 配置文件，创建任意配置并绕过某些保护机制。 这可以被利用来执行具有 root 权限的任意代码，通过设置 `malloc_lib` 选项。提供的PoC代码 `0ldSQL_MySQL_RCE_exploit.py` 是一个有限的版本，仅允许附加到现有 MySQL 配置文件的末尾。完整利用需要目标my.cnf具有mysql用户可写的权限。利用方式如下：

1.  **编译恶意共享库 (mysql_hookandroot_lib.so):**  该库包含恶意代码，用于提权和执行命令。
2.  **将恶意库转换为十六进制:** 将编译好的共享库内容转换为十六进制字符串。
3.  **利用SQL注入或其它方式修改my.cnf:**  将`malloc_lib`设置为恶意共享库的路径，并将`general_log_file`设置为`my.cnf`。需要具有FILE权限。
4.  **重启 MySQL 服务:**  重启后，MySQL将加载恶意共享库，执行其中的代码，从而获得 root 权限。

**投毒风险分析:**

该PoC代码的投毒风险较低 (10%)。PoC本身的功能是演示如何利用漏洞，并包含编译shellcode等必要步骤。然而，不排除作者在编译恶意库的过程中可能隐藏恶意代码的可能性。因此，在使用该PoC时，务必仔细审查代码，特别是 `mysql_hookandroot_lib.c` 文件，并进行代码审计以确保其安全性。

搜索引擎结果表明，该漏洞影响广泛，多个厂商的MySQL发行版都受影响。修复方案包括升级到最新版本或应用厂商提供的补丁。

**项目地址:** [boompig/cve-2016-6662](https://github.com/boompig/cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #6

**来源**: [CVE-2016-6662-kanyaars_CVE-2016-6662.md](../2016/CVE-2016-6662-kanyaars_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户或具有FILE权限的远程用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户（或具有FILE权限的远程用户）通过设置 `general_log_file` 到 `my.cnf` 配置来创建任意配置和绕过某些保护机制。更严重的是，这可以被利用通过设置 `malloc_lib` 来执行具有 root 权限的任意代码。

**利用方式：**

1.  **写入恶意配置：** 攻击者利用数据库的FILE权限，将`general_log_file`指向一个攻击者可控的文件。这个文件会被解析为MySQL的配置文件。
2.  **设置malloc_lib：** 在该配置文件中，攻击者设置`malloc_lib`指向一个恶意的动态链接库（.so文件）。
3.  **重启MySQL服务：** 当MySQL服务重启时，会加载`malloc_lib`指定的恶意动态链接库，从而执行攻击者预设的恶意代码，获得服务器的root权限。

**POC分析：**
提供的POC代码包含两个文件：一个C语言编写的动态链接库 (`911KanyaLab_lib.c`) 和一个 Python 脚本 (`Exploit_Old_MySQL_Kay_ver.py`)。

*   **`911KanyaLab_lib.c`：** 这个C代码会被编译成`.so`文件。它定义了一个`execvp` hook函数，用于在MySQL启动时执行恶意代码。恶意代码的功能是创建一个反向Shell，连接到攻击者的IP地址和端口。
*   **`Exploit_Old_MySQL_Kay_ver.py`：** 这个Python脚本负责连接到目标MySQL服务器，上传并配置恶意的`.so`文件，并触发MySQL重启。

**投毒风险分析：**
代码主要逻辑是创建反向shell，连接攻击者的机器。存在投毒的可能。分析得出存在以下潜在的投毒风险:
*   C代码中IP地址和端口是硬编码的，如果攻击者篡改这些值，可能会将shell连接到其他恶意服务器。但是从代码逻辑来判断是为了完成漏洞验证的必要后门代码。
*   Python脚本需要指定MySQL用户名、密码、数据库名和`my.cnf`路径，这些信息可能被记录或泄露。
*   `config_cleanup()`函数的功能是清除注入的配置，但如果实现不正确，可能留下痕迹。

整体代码质量不高，存在一些硬编码，但主要功能符合漏洞描述，总体上是可信的。 但是依然存在作者隐藏的投毒代码的可能，但是可能性较低。

**项目地址:** [kanyaars/CVE-2016-6662](https://github.com/kanyaars/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #7

**来源**: [CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md](../2016/CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md)

## CVE-2016-6662 - MySQL/MariaDB/PerconaDB 权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** MySQL: <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB: < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server: < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这可以被利用来通过设置 malloc_lib 以 root 权限执行任意代码。根据搜索结果，这是一个严重的安全漏洞，影响多个 MySQL 及其分支版本。利用方式通常涉及修改MySQL的配置文件，将 general_log_file 指向攻击者可控的文件，并在其中写入恶意配置，例如加载恶意动态链接库以执行任意代码。提供的Playbook 旨在通过添加安全检查来修补 `mysqld_safe` 脚本，防止从非标准系统目录加载 `ld_preload` 库。因此，此 Playbook 实际上是一个补丁，并非漏洞利用代码。Playbook 代码本身旨在修复漏洞，未发现隐藏的恶意代码，因此投毒风险为0%。根据漏洞信息和搜索结果，此漏洞影响广泛，需要尽快修复。

**项目地址:** [konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch](https://github.com/konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #8

**来源**: [CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md](../2016/CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md)

## CVE-2016-6662 - MySQL 远程 Root 代码执行/权限提升

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致数据库完全控制和服务器接管

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或 SQL 注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 选项到 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这个漏洞可以被利用来以 root 权限执行任意代码，通过设置 malloc_lib 选项指向恶意 .so 文件。此利用方式依赖于可以写入 MySQL 配置文件，并重启 MySQL 服务。 

**有效性：** 提供的 Ansible 脚本旨在修复此漏洞，而非利用它。它通过修改 mysqld_safe 脚本，限制 .so 文件的加载路径到标准系统目录，并检查默认配置文件的存在性和权限来缓解风险，因此提供的代码是用于防御而不是利用的。

**投毒风险：**  该仓库本身包含的是修复漏洞的脚本，直接投毒的可能性较低。但是，仍然存在以下风险：

1.  **脚本本身可能存在缺陷：**  虽然脚本旨在修复漏洞，但如果脚本本身存在逻辑错误或未考虑到的情况，可能会导致 MySQL 服务不稳定或其他问题。 
2.  **供应链攻击：**  该仓库可能被黑客入侵，然后植入恶意代码。由于脚本需要修改系统文件和重启服务，一旦被植入恶意代码，危害非常大。 
3.  **依赖关系：**  该脚本可能依赖其他软件包或库，这些依赖项可能存在漏洞。  
综合考虑，投毒风险评估为 10%。 这个百分比是因为代码主要是防御性的，并且已经经过了相当数量的安装验证，降低了直接恶意代码的可能性。但供应链风险和脚本缺陷始终存在。

**利用方式：**

1.  **利用条件：**  需要拥有对 MySQL 服务器的本地用户权限或者能够通过 SQL 注入漏洞执行命令。
2.  **写入恶意配置：**  利用权限，将 `general_log_file` 设置为指向包含恶意配置的文件的路径。恶意配置中，设置 `malloc_lib` 指向恶意的 .so 文件。
3.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意 .so 文件被加载，从而执行任意代码。

搜索结果也表明，可以通过 SQL 注入来利用这个漏洞，意味着攻击者不需要本地账户，可以通过SQL注入写入配置，然后利用此漏洞提权至root。


**项目地址:** [meersjo/ansible-mysql-cve-2016-6662](https://github.com/meersjo/ansible-mysql-cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---



---

## POC #4

**来源**: [CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md](../2016/CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 配置覆盖/本地权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，允许本地用户创建任意配置并绕过某些保护机制，最终导致以 root 权限执行任意代码

**影响版本:** MySQL through 5.5.52, 5.6.x through 5.6.33, and 5.7.x through 5.7.15; MariaDB before 5.5.51, 10.0.x before 10.0.27, and 10.1.x before 10.1.17; and Percona Server before 5.5.51-38.1, 5.6.x before 5.6.32-78.0, and 5.7.x before 5.7.14-7

**利用条件:** 需要具备对 MySQL 数据库一定的写入权限（如通过 SQL 注入）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 漏洞允许攻击者通过设置 `general_log_file` 到 `my.cnf` 配置文件来创建任意配置，从而绕过某些保护机制。更进一步，通过设置 `malloc_lib` 选项，可以加载恶意动态链接库，最终导致以 root 权限执行任意代码。

**利用方式：**

1.  **前提条件：** 攻击者需要通过某种方式（例如 SQL 注入）获取对 MySQL 数据库的写入权限。
2.  **写入恶意配置：**  攻击者利用 SQL 注入漏洞，将 `general_log_file` 设置为一个精心构造的 `my.cnf` 配置文件路径，该配置文件中包含恶意的 `malloc_lib` 选项。
3.  **上传恶意动态链接库：**  攻击者将包含恶意代码的动态链接库（`mysql_hookandroot_lib.so`）上传到服务器上的某个可写目录（如 `/var/lib/mysql/`）。
4.  **触发漏洞：**  攻击者通过触发 MySQL 的日志功能，使 MySQL 加载并解析恶意的 `my.cnf` 配置文件，从而加载恶意动态链接库。
5.  **代码执行：**  恶意动态链接库中的代码被执行，攻击者获得 root 权限。

**POC 代码分析：**

提供的 Python 脚本 `From SQL injection to root shell.py` 实现了上述利用流程：

*   `craft_payloads()` 函数生成用于利用漏洞的 SQL 注入 payload。
*   该函数首先创建恶意触发器，该触发器将恶意配置写入 `my.cnf` 文件。
*   然后，该函数将恶意动态链接库 `mysql_hookandroot_lib.so` 的内容写入服务器上的文件。
*   最后，该函数创建 `poctable` 表，并通过插入数据来触发恶意触发器，从而执行代码。

**有效性：**

根据漏洞描述和提供的 POC 代码，该漏洞利用方法是有效的，只要满足利用条件（例如可写权限和特定 MySQL 版本）。

**投毒风险：**

该 POC 代码的主要目的是利用漏洞，但存在一定的投毒风险。 虽然大部分代码是为了验证和利用漏洞，但攻击者可能会在 `mysql_hookandroot_lib.so` 中添加后门或其他恶意功能，从而在成功利用漏洞后保持对系统的长期访问。 这里的投毒风险评估为10%, 主要体现在`mysql_hookandroot_lib.so` 恶意动态链接库上，如果该链接库被替换成具有其他恶意功能的链接库，则可能造成危害。


**项目地址:** [MAYASEVEN/CVE-2016-6662](https://github.com/MAYASEVEN/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #5

**来源**: [CVE-2016-6662-boompig_cve-2016-6662.md](../2016/CVE-2016-6662-boompig_cve-2016-6662.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可导致数据库服务器完全控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 需要能够修改MySQL配置文件 (my.cnf) 并且目标服务器运行受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 选项为 `my.cnf` 配置文件，创建任意配置并绕过某些保护机制。 这可以被利用来执行具有 root 权限的任意代码，通过设置 `malloc_lib` 选项。提供的PoC代码 `0ldSQL_MySQL_RCE_exploit.py` 是一个有限的版本，仅允许附加到现有 MySQL 配置文件的末尾。完整利用需要目标my.cnf具有mysql用户可写的权限。利用方式如下：

1.  **编译恶意共享库 (mysql_hookandroot_lib.so):**  该库包含恶意代码，用于提权和执行命令。
2.  **将恶意库转换为十六进制:** 将编译好的共享库内容转换为十六进制字符串。
3.  **利用SQL注入或其它方式修改my.cnf:**  将`malloc_lib`设置为恶意共享库的路径，并将`general_log_file`设置为`my.cnf`。需要具有FILE权限。
4.  **重启 MySQL 服务:**  重启后，MySQL将加载恶意共享库，执行其中的代码，从而获得 root 权限。

**投毒风险分析:**

该PoC代码的投毒风险较低 (10%)。PoC本身的功能是演示如何利用漏洞，并包含编译shellcode等必要步骤。然而，不排除作者在编译恶意库的过程中可能隐藏恶意代码的可能性。因此，在使用该PoC时，务必仔细审查代码，特别是 `mysql_hookandroot_lib.c` 文件，并进行代码审计以确保其安全性。

搜索引擎结果表明，该漏洞影响广泛，多个厂商的MySQL发行版都受影响。修复方案包括升级到最新版本或应用厂商提供的补丁。

**项目地址:** [boompig/cve-2016-6662](https://github.com/boompig/cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #6

**来源**: [CVE-2016-6662-kanyaars_CVE-2016-6662.md](../2016/CVE-2016-6662-kanyaars_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户或具有FILE权限的远程用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户（或具有FILE权限的远程用户）通过设置 `general_log_file` 到 `my.cnf` 配置来创建任意配置和绕过某些保护机制。更严重的是，这可以被利用通过设置 `malloc_lib` 来执行具有 root 权限的任意代码。

**利用方式：**

1.  **写入恶意配置：** 攻击者利用数据库的FILE权限，将`general_log_file`指向一个攻击者可控的文件。这个文件会被解析为MySQL的配置文件。
2.  **设置malloc_lib：** 在该配置文件中，攻击者设置`malloc_lib`指向一个恶意的动态链接库（.so文件）。
3.  **重启MySQL服务：** 当MySQL服务重启时，会加载`malloc_lib`指定的恶意动态链接库，从而执行攻击者预设的恶意代码，获得服务器的root权限。

**POC分析：**
提供的POC代码包含两个文件：一个C语言编写的动态链接库 (`911KanyaLab_lib.c`) 和一个 Python 脚本 (`Exploit_Old_MySQL_Kay_ver.py`)。

*   **`911KanyaLab_lib.c`：** 这个C代码会被编译成`.so`文件。它定义了一个`execvp` hook函数，用于在MySQL启动时执行恶意代码。恶意代码的功能是创建一个反向Shell，连接到攻击者的IP地址和端口。
*   **`Exploit_Old_MySQL_Kay_ver.py`：** 这个Python脚本负责连接到目标MySQL服务器，上传并配置恶意的`.so`文件，并触发MySQL重启。

**投毒风险分析：**
代码主要逻辑是创建反向shell，连接攻击者的机器。存在投毒的可能。分析得出存在以下潜在的投毒风险:
*   C代码中IP地址和端口是硬编码的，如果攻击者篡改这些值，可能会将shell连接到其他恶意服务器。但是从代码逻辑来判断是为了完成漏洞验证的必要后门代码。
*   Python脚本需要指定MySQL用户名、密码、数据库名和`my.cnf`路径，这些信息可能被记录或泄露。
*   `config_cleanup()`函数的功能是清除注入的配置，但如果实现不正确，可能留下痕迹。

整体代码质量不高，存在一些硬编码，但主要功能符合漏洞描述，总体上是可信的。 但是依然存在作者隐藏的投毒代码的可能，但是可能性较低。

**项目地址:** [kanyaars/CVE-2016-6662](https://github.com/kanyaars/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #7

**来源**: [CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md](../2016/CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md)

## CVE-2016-6662 - MySQL/MariaDB/PerconaDB 权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** MySQL: <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB: < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server: < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这可以被利用来通过设置 malloc_lib 以 root 权限执行任意代码。根据搜索结果，这是一个严重的安全漏洞，影响多个 MySQL 及其分支版本。利用方式通常涉及修改MySQL的配置文件，将 general_log_file 指向攻击者可控的文件，并在其中写入恶意配置，例如加载恶意动态链接库以执行任意代码。提供的Playbook 旨在通过添加安全检查来修补 `mysqld_safe` 脚本，防止从非标准系统目录加载 `ld_preload` 库。因此，此 Playbook 实际上是一个补丁，并非漏洞利用代码。Playbook 代码本身旨在修复漏洞，未发现隐藏的恶意代码，因此投毒风险为0%。根据漏洞信息和搜索结果，此漏洞影响广泛，需要尽快修复。

**项目地址:** [konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch](https://github.com/konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #8

**来源**: [CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md](../2016/CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md)

## CVE-2016-6662 - MySQL 远程 Root 代码执行/权限提升

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致数据库完全控制和服务器接管

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或 SQL 注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 选项到 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这个漏洞可以被利用来以 root 权限执行任意代码，通过设置 malloc_lib 选项指向恶意 .so 文件。此利用方式依赖于可以写入 MySQL 配置文件，并重启 MySQL 服务。 

**有效性：** 提供的 Ansible 脚本旨在修复此漏洞，而非利用它。它通过修改 mysqld_safe 脚本，限制 .so 文件的加载路径到标准系统目录，并检查默认配置文件的存在性和权限来缓解风险，因此提供的代码是用于防御而不是利用的。

**投毒风险：**  该仓库本身包含的是修复漏洞的脚本，直接投毒的可能性较低。但是，仍然存在以下风险：

1.  **脚本本身可能存在缺陷：**  虽然脚本旨在修复漏洞，但如果脚本本身存在逻辑错误或未考虑到的情况，可能会导致 MySQL 服务不稳定或其他问题。 
2.  **供应链攻击：**  该仓库可能被黑客入侵，然后植入恶意代码。由于脚本需要修改系统文件和重启服务，一旦被植入恶意代码，危害非常大。 
3.  **依赖关系：**  该脚本可能依赖其他软件包或库，这些依赖项可能存在漏洞。  
综合考虑，投毒风险评估为 10%。 这个百分比是因为代码主要是防御性的，并且已经经过了相当数量的安装验证，降低了直接恶意代码的可能性。但供应链风险和脚本缺陷始终存在。

**利用方式：**

1.  **利用条件：**  需要拥有对 MySQL 服务器的本地用户权限或者能够通过 SQL 注入漏洞执行命令。
2.  **写入恶意配置：**  利用权限，将 `general_log_file` 设置为指向包含恶意配置的文件的路径。恶意配置中，设置 `malloc_lib` 指向恶意的 .so 文件。
3.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意 .so 文件被加载，从而执行任意代码。

搜索结果也表明，可以通过 SQL 注入来利用这个漏洞，意味着攻击者不需要本地账户，可以通过SQL注入写入配置，然后利用此漏洞提权至root。


**项目地址:** [meersjo/ansible-mysql-cve-2016-6662](https://github.com/meersjo/ansible-mysql-cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---



---

## POC #4

**来源**: [CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md](../2016/CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 配置覆盖/本地权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，允许本地用户创建任意配置并绕过某些保护机制，最终导致以 root 权限执行任意代码

**影响版本:** MySQL through 5.5.52, 5.6.x through 5.6.33, and 5.7.x through 5.7.15; MariaDB before 5.5.51, 10.0.x before 10.0.27, and 10.1.x before 10.1.17; and Percona Server before 5.5.51-38.1, 5.6.x before 5.6.32-78.0, and 5.7.x before 5.7.14-7

**利用条件:** 需要具备对 MySQL 数据库一定的写入权限（如通过 SQL 注入）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 漏洞允许攻击者通过设置 `general_log_file` 到 `my.cnf` 配置文件来创建任意配置，从而绕过某些保护机制。更进一步，通过设置 `malloc_lib` 选项，可以加载恶意动态链接库，最终导致以 root 权限执行任意代码。

**利用方式：**

1.  **前提条件：** 攻击者需要通过某种方式（例如 SQL 注入）获取对 MySQL 数据库的写入权限。
2.  **写入恶意配置：**  攻击者利用 SQL 注入漏洞，将 `general_log_file` 设置为一个精心构造的 `my.cnf` 配置文件路径，该配置文件中包含恶意的 `malloc_lib` 选项。
3.  **上传恶意动态链接库：**  攻击者将包含恶意代码的动态链接库（`mysql_hookandroot_lib.so`）上传到服务器上的某个可写目录（如 `/var/lib/mysql/`）。
4.  **触发漏洞：**  攻击者通过触发 MySQL 的日志功能，使 MySQL 加载并解析恶意的 `my.cnf` 配置文件，从而加载恶意动态链接库。
5.  **代码执行：**  恶意动态链接库中的代码被执行，攻击者获得 root 权限。

**POC 代码分析：**

提供的 Python 脚本 `From SQL injection to root shell.py` 实现了上述利用流程：

*   `craft_payloads()` 函数生成用于利用漏洞的 SQL 注入 payload。
*   该函数首先创建恶意触发器，该触发器将恶意配置写入 `my.cnf` 文件。
*   然后，该函数将恶意动态链接库 `mysql_hookandroot_lib.so` 的内容写入服务器上的文件。
*   最后，该函数创建 `poctable` 表，并通过插入数据来触发恶意触发器，从而执行代码。

**有效性：**

根据漏洞描述和提供的 POC 代码，该漏洞利用方法是有效的，只要满足利用条件（例如可写权限和特定 MySQL 版本）。

**投毒风险：**

该 POC 代码的主要目的是利用漏洞，但存在一定的投毒风险。 虽然大部分代码是为了验证和利用漏洞，但攻击者可能会在 `mysql_hookandroot_lib.so` 中添加后门或其他恶意功能，从而在成功利用漏洞后保持对系统的长期访问。 这里的投毒风险评估为10%, 主要体现在`mysql_hookandroot_lib.so` 恶意动态链接库上，如果该链接库被替换成具有其他恶意功能的链接库，则可能造成危害。


**项目地址:** [MAYASEVEN/CVE-2016-6662](https://github.com/MAYASEVEN/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #5

**来源**: [CVE-2016-6662-boompig_cve-2016-6662.md](../2016/CVE-2016-6662-boompig_cve-2016-6662.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可导致数据库服务器完全控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 需要能够修改MySQL配置文件 (my.cnf) 并且目标服务器运行受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 选项为 `my.cnf` 配置文件，创建任意配置并绕过某些保护机制。 这可以被利用来执行具有 root 权限的任意代码，通过设置 `malloc_lib` 选项。提供的PoC代码 `0ldSQL_MySQL_RCE_exploit.py` 是一个有限的版本，仅允许附加到现有 MySQL 配置文件的末尾。完整利用需要目标my.cnf具有mysql用户可写的权限。利用方式如下：

1.  **编译恶意共享库 (mysql_hookandroot_lib.so):**  该库包含恶意代码，用于提权和执行命令。
2.  **将恶意库转换为十六进制:** 将编译好的共享库内容转换为十六进制字符串。
3.  **利用SQL注入或其它方式修改my.cnf:**  将`malloc_lib`设置为恶意共享库的路径，并将`general_log_file`设置为`my.cnf`。需要具有FILE权限。
4.  **重启 MySQL 服务:**  重启后，MySQL将加载恶意共享库，执行其中的代码，从而获得 root 权限。

**投毒风险分析:**

该PoC代码的投毒风险较低 (10%)。PoC本身的功能是演示如何利用漏洞，并包含编译shellcode等必要步骤。然而，不排除作者在编译恶意库的过程中可能隐藏恶意代码的可能性。因此，在使用该PoC时，务必仔细审查代码，特别是 `mysql_hookandroot_lib.c` 文件，并进行代码审计以确保其安全性。

搜索引擎结果表明，该漏洞影响广泛，多个厂商的MySQL发行版都受影响。修复方案包括升级到最新版本或应用厂商提供的补丁。

**项目地址:** [boompig/cve-2016-6662](https://github.com/boompig/cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #6

**来源**: [CVE-2016-6662-kanyaars_CVE-2016-6662.md](../2016/CVE-2016-6662-kanyaars_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户或具有FILE权限的远程用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户（或具有FILE权限的远程用户）通过设置 `general_log_file` 到 `my.cnf` 配置来创建任意配置和绕过某些保护机制。更严重的是，这可以被利用通过设置 `malloc_lib` 来执行具有 root 权限的任意代码。

**利用方式：**

1.  **写入恶意配置：** 攻击者利用数据库的FILE权限，将`general_log_file`指向一个攻击者可控的文件。这个文件会被解析为MySQL的配置文件。
2.  **设置malloc_lib：** 在该配置文件中，攻击者设置`malloc_lib`指向一个恶意的动态链接库（.so文件）。
3.  **重启MySQL服务：** 当MySQL服务重启时，会加载`malloc_lib`指定的恶意动态链接库，从而执行攻击者预设的恶意代码，获得服务器的root权限。

**POC分析：**
提供的POC代码包含两个文件：一个C语言编写的动态链接库 (`911KanyaLab_lib.c`) 和一个 Python 脚本 (`Exploit_Old_MySQL_Kay_ver.py`)。

*   **`911KanyaLab_lib.c`：** 这个C代码会被编译成`.so`文件。它定义了一个`execvp` hook函数，用于在MySQL启动时执行恶意代码。恶意代码的功能是创建一个反向Shell，连接到攻击者的IP地址和端口。
*   **`Exploit_Old_MySQL_Kay_ver.py`：** 这个Python脚本负责连接到目标MySQL服务器，上传并配置恶意的`.so`文件，并触发MySQL重启。

**投毒风险分析：**
代码主要逻辑是创建反向shell，连接攻击者的机器。存在投毒的可能。分析得出存在以下潜在的投毒风险:
*   C代码中IP地址和端口是硬编码的，如果攻击者篡改这些值，可能会将shell连接到其他恶意服务器。但是从代码逻辑来判断是为了完成漏洞验证的必要后门代码。
*   Python脚本需要指定MySQL用户名、密码、数据库名和`my.cnf`路径，这些信息可能被记录或泄露。
*   `config_cleanup()`函数的功能是清除注入的配置，但如果实现不正确，可能留下痕迹。

整体代码质量不高，存在一些硬编码，但主要功能符合漏洞描述，总体上是可信的。 但是依然存在作者隐藏的投毒代码的可能，但是可能性较低。

**项目地址:** [kanyaars/CVE-2016-6662](https://github.com/kanyaars/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #7

**来源**: [CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md](../2016/CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md)

## CVE-2016-6662 - MySQL/MariaDB/PerconaDB 权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** MySQL: <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB: < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server: < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这可以被利用来通过设置 malloc_lib 以 root 权限执行任意代码。根据搜索结果，这是一个严重的安全漏洞，影响多个 MySQL 及其分支版本。利用方式通常涉及修改MySQL的配置文件，将 general_log_file 指向攻击者可控的文件，并在其中写入恶意配置，例如加载恶意动态链接库以执行任意代码。提供的Playbook 旨在通过添加安全检查来修补 `mysqld_safe` 脚本，防止从非标准系统目录加载 `ld_preload` 库。因此，此 Playbook 实际上是一个补丁，并非漏洞利用代码。Playbook 代码本身旨在修复漏洞，未发现隐藏的恶意代码，因此投毒风险为0%。根据漏洞信息和搜索结果，此漏洞影响广泛，需要尽快修复。

**项目地址:** [konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch](https://github.com/konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #8

**来源**: [CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md](../2016/CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md)

## CVE-2016-6662 - MySQL 远程 Root 代码执行/权限提升

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致数据库完全控制和服务器接管

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或 SQL 注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 选项到 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这个漏洞可以被利用来以 root 权限执行任意代码，通过设置 malloc_lib 选项指向恶意 .so 文件。此利用方式依赖于可以写入 MySQL 配置文件，并重启 MySQL 服务。 

**有效性：** 提供的 Ansible 脚本旨在修复此漏洞，而非利用它。它通过修改 mysqld_safe 脚本，限制 .so 文件的加载路径到标准系统目录，并检查默认配置文件的存在性和权限来缓解风险，因此提供的代码是用于防御而不是利用的。

**投毒风险：**  该仓库本身包含的是修复漏洞的脚本，直接投毒的可能性较低。但是，仍然存在以下风险：

1.  **脚本本身可能存在缺陷：**  虽然脚本旨在修复漏洞，但如果脚本本身存在逻辑错误或未考虑到的情况，可能会导致 MySQL 服务不稳定或其他问题。 
2.  **供应链攻击：**  该仓库可能被黑客入侵，然后植入恶意代码。由于脚本需要修改系统文件和重启服务，一旦被植入恶意代码，危害非常大。 
3.  **依赖关系：**  该脚本可能依赖其他软件包或库，这些依赖项可能存在漏洞。  
综合考虑，投毒风险评估为 10%。 这个百分比是因为代码主要是防御性的，并且已经经过了相当数量的安装验证，降低了直接恶意代码的可能性。但供应链风险和脚本缺陷始终存在。

**利用方式：**

1.  **利用条件：**  需要拥有对 MySQL 服务器的本地用户权限或者能够通过 SQL 注入漏洞执行命令。
2.  **写入恶意配置：**  利用权限，将 `general_log_file` 设置为指向包含恶意配置的文件的路径。恶意配置中，设置 `malloc_lib` 指向恶意的 .so 文件。
3.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意 .so 文件被加载，从而执行任意代码。

搜索结果也表明，可以通过 SQL 注入来利用这个漏洞，意味着攻击者不需要本地账户，可以通过SQL注入写入配置，然后利用此漏洞提权至root。


**项目地址:** [meersjo/ansible-mysql-cve-2016-6662](https://github.com/meersjo/ansible-mysql-cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---



---

## POC #4

**来源**: [CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md](../2016/CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 配置覆盖/本地权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，允许本地用户创建任意配置并绕过某些保护机制，最终导致以 root 权限执行任意代码

**影响版本:** MySQL through 5.5.52, 5.6.x through 5.6.33, and 5.7.x through 5.7.15; MariaDB before 5.5.51, 10.0.x before 10.0.27, and 10.1.x before 10.1.17; and Percona Server before 5.5.51-38.1, 5.6.x before 5.6.32-78.0, and 5.7.x before 5.7.14-7

**利用条件:** 需要具备对 MySQL 数据库一定的写入权限（如通过 SQL 注入）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 漏洞允许攻击者通过设置 `general_log_file` 到 `my.cnf` 配置文件来创建任意配置，从而绕过某些保护机制。更进一步，通过设置 `malloc_lib` 选项，可以加载恶意动态链接库，最终导致以 root 权限执行任意代码。

**利用方式：**

1.  **前提条件：** 攻击者需要通过某种方式（例如 SQL 注入）获取对 MySQL 数据库的写入权限。
2.  **写入恶意配置：**  攻击者利用 SQL 注入漏洞，将 `general_log_file` 设置为一个精心构造的 `my.cnf` 配置文件路径，该配置文件中包含恶意的 `malloc_lib` 选项。
3.  **上传恶意动态链接库：**  攻击者将包含恶意代码的动态链接库（`mysql_hookandroot_lib.so`）上传到服务器上的某个可写目录（如 `/var/lib/mysql/`）。
4.  **触发漏洞：**  攻击者通过触发 MySQL 的日志功能，使 MySQL 加载并解析恶意的 `my.cnf` 配置文件，从而加载恶意动态链接库。
5.  **代码执行：**  恶意动态链接库中的代码被执行，攻击者获得 root 权限。

**POC 代码分析：**

提供的 Python 脚本 `From SQL injection to root shell.py` 实现了上述利用流程：

*   `craft_payloads()` 函数生成用于利用漏洞的 SQL 注入 payload。
*   该函数首先创建恶意触发器，该触发器将恶意配置写入 `my.cnf` 文件。
*   然后，该函数将恶意动态链接库 `mysql_hookandroot_lib.so` 的内容写入服务器上的文件。
*   最后，该函数创建 `poctable` 表，并通过插入数据来触发恶意触发器，从而执行代码。

**有效性：**

根据漏洞描述和提供的 POC 代码，该漏洞利用方法是有效的，只要满足利用条件（例如可写权限和特定 MySQL 版本）。

**投毒风险：**

该 POC 代码的主要目的是利用漏洞，但存在一定的投毒风险。 虽然大部分代码是为了验证和利用漏洞，但攻击者可能会在 `mysql_hookandroot_lib.so` 中添加后门或其他恶意功能，从而在成功利用漏洞后保持对系统的长期访问。 这里的投毒风险评估为10%, 主要体现在`mysql_hookandroot_lib.so` 恶意动态链接库上，如果该链接库被替换成具有其他恶意功能的链接库，则可能造成危害。


**项目地址:** [MAYASEVEN/CVE-2016-6662](https://github.com/MAYASEVEN/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #5

**来源**: [CVE-2016-6662-boompig_cve-2016-6662.md](../2016/CVE-2016-6662-boompig_cve-2016-6662.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可导致数据库服务器完全控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 需要能够修改MySQL配置文件 (my.cnf) 并且目标服务器运行受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 选项为 `my.cnf` 配置文件，创建任意配置并绕过某些保护机制。 这可以被利用来执行具有 root 权限的任意代码，通过设置 `malloc_lib` 选项。提供的PoC代码 `0ldSQL_MySQL_RCE_exploit.py` 是一个有限的版本，仅允许附加到现有 MySQL 配置文件的末尾。完整利用需要目标my.cnf具有mysql用户可写的权限。利用方式如下：

1.  **编译恶意共享库 (mysql_hookandroot_lib.so):**  该库包含恶意代码，用于提权和执行命令。
2.  **将恶意库转换为十六进制:** 将编译好的共享库内容转换为十六进制字符串。
3.  **利用SQL注入或其它方式修改my.cnf:**  将`malloc_lib`设置为恶意共享库的路径，并将`general_log_file`设置为`my.cnf`。需要具有FILE权限。
4.  **重启 MySQL 服务:**  重启后，MySQL将加载恶意共享库，执行其中的代码，从而获得 root 权限。

**投毒风险分析:**

该PoC代码的投毒风险较低 (10%)。PoC本身的功能是演示如何利用漏洞，并包含编译shellcode等必要步骤。然而，不排除作者在编译恶意库的过程中可能隐藏恶意代码的可能性。因此，在使用该PoC时，务必仔细审查代码，特别是 `mysql_hookandroot_lib.c` 文件，并进行代码审计以确保其安全性。

搜索引擎结果表明，该漏洞影响广泛，多个厂商的MySQL发行版都受影响。修复方案包括升级到最新版本或应用厂商提供的补丁。

**项目地址:** [boompig/cve-2016-6662](https://github.com/boompig/cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #6

**来源**: [CVE-2016-6662-kanyaars_CVE-2016-6662.md](../2016/CVE-2016-6662-kanyaars_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户或具有FILE权限的远程用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户（或具有FILE权限的远程用户）通过设置 `general_log_file` 到 `my.cnf` 配置来创建任意配置和绕过某些保护机制。更严重的是，这可以被利用通过设置 `malloc_lib` 来执行具有 root 权限的任意代码。

**利用方式：**

1.  **写入恶意配置：** 攻击者利用数据库的FILE权限，将`general_log_file`指向一个攻击者可控的文件。这个文件会被解析为MySQL的配置文件。
2.  **设置malloc_lib：** 在该配置文件中，攻击者设置`malloc_lib`指向一个恶意的动态链接库（.so文件）。
3.  **重启MySQL服务：** 当MySQL服务重启时，会加载`malloc_lib`指定的恶意动态链接库，从而执行攻击者预设的恶意代码，获得服务器的root权限。

**POC分析：**
提供的POC代码包含两个文件：一个C语言编写的动态链接库 (`911KanyaLab_lib.c`) 和一个 Python 脚本 (`Exploit_Old_MySQL_Kay_ver.py`)。

*   **`911KanyaLab_lib.c`：** 这个C代码会被编译成`.so`文件。它定义了一个`execvp` hook函数，用于在MySQL启动时执行恶意代码。恶意代码的功能是创建一个反向Shell，连接到攻击者的IP地址和端口。
*   **`Exploit_Old_MySQL_Kay_ver.py`：** 这个Python脚本负责连接到目标MySQL服务器，上传并配置恶意的`.so`文件，并触发MySQL重启。

**投毒风险分析：**
代码主要逻辑是创建反向shell，连接攻击者的机器。存在投毒的可能。分析得出存在以下潜在的投毒风险:
*   C代码中IP地址和端口是硬编码的，如果攻击者篡改这些值，可能会将shell连接到其他恶意服务器。但是从代码逻辑来判断是为了完成漏洞验证的必要后门代码。
*   Python脚本需要指定MySQL用户名、密码、数据库名和`my.cnf`路径，这些信息可能被记录或泄露。
*   `config_cleanup()`函数的功能是清除注入的配置，但如果实现不正确，可能留下痕迹。

整体代码质量不高，存在一些硬编码，但主要功能符合漏洞描述，总体上是可信的。 但是依然存在作者隐藏的投毒代码的可能，但是可能性较低。

**项目地址:** [kanyaars/CVE-2016-6662](https://github.com/kanyaars/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #7

**来源**: [CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md](../2016/CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md)

## CVE-2016-6662 - MySQL/MariaDB/PerconaDB 权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** MySQL: <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB: < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server: < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这可以被利用来通过设置 malloc_lib 以 root 权限执行任意代码。根据搜索结果，这是一个严重的安全漏洞，影响多个 MySQL 及其分支版本。利用方式通常涉及修改MySQL的配置文件，将 general_log_file 指向攻击者可控的文件，并在其中写入恶意配置，例如加载恶意动态链接库以执行任意代码。提供的Playbook 旨在通过添加安全检查来修补 `mysqld_safe` 脚本，防止从非标准系统目录加载 `ld_preload` 库。因此，此 Playbook 实际上是一个补丁，并非漏洞利用代码。Playbook 代码本身旨在修复漏洞，未发现隐藏的恶意代码，因此投毒风险为0%。根据漏洞信息和搜索结果，此漏洞影响广泛，需要尽快修复。

**项目地址:** [konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch](https://github.com/konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #8

**来源**: [CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md](../2016/CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md)

## CVE-2016-6662 - MySQL 远程 Root 代码执行/权限提升

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致数据库完全控制和服务器接管

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或 SQL 注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 选项到 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这个漏洞可以被利用来以 root 权限执行任意代码，通过设置 malloc_lib 选项指向恶意 .so 文件。此利用方式依赖于可以写入 MySQL 配置文件，并重启 MySQL 服务。 

**有效性：** 提供的 Ansible 脚本旨在修复此漏洞，而非利用它。它通过修改 mysqld_safe 脚本，限制 .so 文件的加载路径到标准系统目录，并检查默认配置文件的存在性和权限来缓解风险，因此提供的代码是用于防御而不是利用的。

**投毒风险：**  该仓库本身包含的是修复漏洞的脚本，直接投毒的可能性较低。但是，仍然存在以下风险：

1.  **脚本本身可能存在缺陷：**  虽然脚本旨在修复漏洞，但如果脚本本身存在逻辑错误或未考虑到的情况，可能会导致 MySQL 服务不稳定或其他问题。 
2.  **供应链攻击：**  该仓库可能被黑客入侵，然后植入恶意代码。由于脚本需要修改系统文件和重启服务，一旦被植入恶意代码，危害非常大。 
3.  **依赖关系：**  该脚本可能依赖其他软件包或库，这些依赖项可能存在漏洞。  
综合考虑，投毒风险评估为 10%。 这个百分比是因为代码主要是防御性的，并且已经经过了相当数量的安装验证，降低了直接恶意代码的可能性。但供应链风险和脚本缺陷始终存在。

**利用方式：**

1.  **利用条件：**  需要拥有对 MySQL 服务器的本地用户权限或者能够通过 SQL 注入漏洞执行命令。
2.  **写入恶意配置：**  利用权限，将 `general_log_file` 设置为指向包含恶意配置的文件的路径。恶意配置中，设置 `malloc_lib` 指向恶意的 .so 文件。
3.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意 .so 文件被加载，从而执行任意代码。

搜索结果也表明，可以通过 SQL 注入来利用这个漏洞，意味着攻击者不需要本地账户，可以通过SQL注入写入配置，然后利用此漏洞提权至root。


**项目地址:** [meersjo/ansible-mysql-cve-2016-6662](https://github.com/meersjo/ansible-mysql-cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---



---

## POC #4

**来源**: [CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md](../2016/CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 配置覆盖/本地权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，允许本地用户创建任意配置并绕过某些保护机制，最终导致以 root 权限执行任意代码

**影响版本:** MySQL through 5.5.52, 5.6.x through 5.6.33, and 5.7.x through 5.7.15; MariaDB before 5.5.51, 10.0.x before 10.0.27, and 10.1.x before 10.1.17; and Percona Server before 5.5.51-38.1, 5.6.x before 5.6.32-78.0, and 5.7.x before 5.7.14-7

**利用条件:** 需要具备对 MySQL 数据库一定的写入权限（如通过 SQL 注入）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 漏洞允许攻击者通过设置 `general_log_file` 到 `my.cnf` 配置文件来创建任意配置，从而绕过某些保护机制。更进一步，通过设置 `malloc_lib` 选项，可以加载恶意动态链接库，最终导致以 root 权限执行任意代码。

**利用方式：**

1.  **前提条件：** 攻击者需要通过某种方式（例如 SQL 注入）获取对 MySQL 数据库的写入权限。
2.  **写入恶意配置：**  攻击者利用 SQL 注入漏洞，将 `general_log_file` 设置为一个精心构造的 `my.cnf` 配置文件路径，该配置文件中包含恶意的 `malloc_lib` 选项。
3.  **上传恶意动态链接库：**  攻击者将包含恶意代码的动态链接库（`mysql_hookandroot_lib.so`）上传到服务器上的某个可写目录（如 `/var/lib/mysql/`）。
4.  **触发漏洞：**  攻击者通过触发 MySQL 的日志功能，使 MySQL 加载并解析恶意的 `my.cnf` 配置文件，从而加载恶意动态链接库。
5.  **代码执行：**  恶意动态链接库中的代码被执行，攻击者获得 root 权限。

**POC 代码分析：**

提供的 Python 脚本 `From SQL injection to root shell.py` 实现了上述利用流程：

*   `craft_payloads()` 函数生成用于利用漏洞的 SQL 注入 payload。
*   该函数首先创建恶意触发器，该触发器将恶意配置写入 `my.cnf` 文件。
*   然后，该函数将恶意动态链接库 `mysql_hookandroot_lib.so` 的内容写入服务器上的文件。
*   最后，该函数创建 `poctable` 表，并通过插入数据来触发恶意触发器，从而执行代码。

**有效性：**

根据漏洞描述和提供的 POC 代码，该漏洞利用方法是有效的，只要满足利用条件（例如可写权限和特定 MySQL 版本）。

**投毒风险：**

该 POC 代码的主要目的是利用漏洞，但存在一定的投毒风险。 虽然大部分代码是为了验证和利用漏洞，但攻击者可能会在 `mysql_hookandroot_lib.so` 中添加后门或其他恶意功能，从而在成功利用漏洞后保持对系统的长期访问。 这里的投毒风险评估为10%, 主要体现在`mysql_hookandroot_lib.so` 恶意动态链接库上，如果该链接库被替换成具有其他恶意功能的链接库，则可能造成危害。


**项目地址:** [MAYASEVEN/CVE-2016-6662](https://github.com/MAYASEVEN/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #5

**来源**: [CVE-2016-6662-boompig_cve-2016-6662.md](../2016/CVE-2016-6662-boompig_cve-2016-6662.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可导致数据库服务器完全控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 需要能够修改MySQL配置文件 (my.cnf) 并且目标服务器运行受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 选项为 `my.cnf` 配置文件，创建任意配置并绕过某些保护机制。 这可以被利用来执行具有 root 权限的任意代码，通过设置 `malloc_lib` 选项。提供的PoC代码 `0ldSQL_MySQL_RCE_exploit.py` 是一个有限的版本，仅允许附加到现有 MySQL 配置文件的末尾。完整利用需要目标my.cnf具有mysql用户可写的权限。利用方式如下：

1.  **编译恶意共享库 (mysql_hookandroot_lib.so):**  该库包含恶意代码，用于提权和执行命令。
2.  **将恶意库转换为十六进制:** 将编译好的共享库内容转换为十六进制字符串。
3.  **利用SQL注入或其它方式修改my.cnf:**  将`malloc_lib`设置为恶意共享库的路径，并将`general_log_file`设置为`my.cnf`。需要具有FILE权限。
4.  **重启 MySQL 服务:**  重启后，MySQL将加载恶意共享库，执行其中的代码，从而获得 root 权限。

**投毒风险分析:**

该PoC代码的投毒风险较低 (10%)。PoC本身的功能是演示如何利用漏洞，并包含编译shellcode等必要步骤。然而，不排除作者在编译恶意库的过程中可能隐藏恶意代码的可能性。因此，在使用该PoC时，务必仔细审查代码，特别是 `mysql_hookandroot_lib.c` 文件，并进行代码审计以确保其安全性。

搜索引擎结果表明，该漏洞影响广泛，多个厂商的MySQL发行版都受影响。修复方案包括升级到最新版本或应用厂商提供的补丁。

**项目地址:** [boompig/cve-2016-6662](https://github.com/boompig/cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #6

**来源**: [CVE-2016-6662-kanyaars_CVE-2016-6662.md](../2016/CVE-2016-6662-kanyaars_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户或具有FILE权限的远程用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户（或具有FILE权限的远程用户）通过设置 `general_log_file` 到 `my.cnf` 配置来创建任意配置和绕过某些保护机制。更严重的是，这可以被利用通过设置 `malloc_lib` 来执行具有 root 权限的任意代码。

**利用方式：**

1.  **写入恶意配置：** 攻击者利用数据库的FILE权限，将`general_log_file`指向一个攻击者可控的文件。这个文件会被解析为MySQL的配置文件。
2.  **设置malloc_lib：** 在该配置文件中，攻击者设置`malloc_lib`指向一个恶意的动态链接库（.so文件）。
3.  **重启MySQL服务：** 当MySQL服务重启时，会加载`malloc_lib`指定的恶意动态链接库，从而执行攻击者预设的恶意代码，获得服务器的root权限。

**POC分析：**
提供的POC代码包含两个文件：一个C语言编写的动态链接库 (`911KanyaLab_lib.c`) 和一个 Python 脚本 (`Exploit_Old_MySQL_Kay_ver.py`)。

*   **`911KanyaLab_lib.c`：** 这个C代码会被编译成`.so`文件。它定义了一个`execvp` hook函数，用于在MySQL启动时执行恶意代码。恶意代码的功能是创建一个反向Shell，连接到攻击者的IP地址和端口。
*   **`Exploit_Old_MySQL_Kay_ver.py`：** 这个Python脚本负责连接到目标MySQL服务器，上传并配置恶意的`.so`文件，并触发MySQL重启。

**投毒风险分析：**
代码主要逻辑是创建反向shell，连接攻击者的机器。存在投毒的可能。分析得出存在以下潜在的投毒风险:
*   C代码中IP地址和端口是硬编码的，如果攻击者篡改这些值，可能会将shell连接到其他恶意服务器。但是从代码逻辑来判断是为了完成漏洞验证的必要后门代码。
*   Python脚本需要指定MySQL用户名、密码、数据库名和`my.cnf`路径，这些信息可能被记录或泄露。
*   `config_cleanup()`函数的功能是清除注入的配置，但如果实现不正确，可能留下痕迹。

整体代码质量不高，存在一些硬编码，但主要功能符合漏洞描述，总体上是可信的。 但是依然存在作者隐藏的投毒代码的可能，但是可能性较低。

**项目地址:** [kanyaars/CVE-2016-6662](https://github.com/kanyaars/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #7

**来源**: [CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md](../2016/CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md)

## CVE-2016-6662 - MySQL/MariaDB/PerconaDB 权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** MySQL: <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB: < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server: < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这可以被利用来通过设置 malloc_lib 以 root 权限执行任意代码。根据搜索结果，这是一个严重的安全漏洞，影响多个 MySQL 及其分支版本。利用方式通常涉及修改MySQL的配置文件，将 general_log_file 指向攻击者可控的文件，并在其中写入恶意配置，例如加载恶意动态链接库以执行任意代码。提供的Playbook 旨在通过添加安全检查来修补 `mysqld_safe` 脚本，防止从非标准系统目录加载 `ld_preload` 库。因此，此 Playbook 实际上是一个补丁，并非漏洞利用代码。Playbook 代码本身旨在修复漏洞，未发现隐藏的恶意代码，因此投毒风险为0%。根据漏洞信息和搜索结果，此漏洞影响广泛，需要尽快修复。

**项目地址:** [konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch](https://github.com/konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #8

**来源**: [CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md](../2016/CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md)

## CVE-2016-6662 - MySQL 远程 Root 代码执行/权限提升

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致数据库完全控制和服务器接管

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或 SQL 注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 选项到 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这个漏洞可以被利用来以 root 权限执行任意代码，通过设置 malloc_lib 选项指向恶意 .so 文件。此利用方式依赖于可以写入 MySQL 配置文件，并重启 MySQL 服务。 

**有效性：** 提供的 Ansible 脚本旨在修复此漏洞，而非利用它。它通过修改 mysqld_safe 脚本，限制 .so 文件的加载路径到标准系统目录，并检查默认配置文件的存在性和权限来缓解风险，因此提供的代码是用于防御而不是利用的。

**投毒风险：**  该仓库本身包含的是修复漏洞的脚本，直接投毒的可能性较低。但是，仍然存在以下风险：

1.  **脚本本身可能存在缺陷：**  虽然脚本旨在修复漏洞，但如果脚本本身存在逻辑错误或未考虑到的情况，可能会导致 MySQL 服务不稳定或其他问题。 
2.  **供应链攻击：**  该仓库可能被黑客入侵，然后植入恶意代码。由于脚本需要修改系统文件和重启服务，一旦被植入恶意代码，危害非常大。 
3.  **依赖关系：**  该脚本可能依赖其他软件包或库，这些依赖项可能存在漏洞。  
综合考虑，投毒风险评估为 10%。 这个百分比是因为代码主要是防御性的，并且已经经过了相当数量的安装验证，降低了直接恶意代码的可能性。但供应链风险和脚本缺陷始终存在。

**利用方式：**

1.  **利用条件：**  需要拥有对 MySQL 服务器的本地用户权限或者能够通过 SQL 注入漏洞执行命令。
2.  **写入恶意配置：**  利用权限，将 `general_log_file` 设置为指向包含恶意配置的文件的路径。恶意配置中，设置 `malloc_lib` 指向恶意的 .so 文件。
3.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意 .so 文件被加载，从而执行任意代码。

搜索结果也表明，可以通过 SQL 注入来利用这个漏洞，意味着攻击者不需要本地账户，可以通过SQL注入写入配置，然后利用此漏洞提权至root。


**项目地址:** [meersjo/ansible-mysql-cve-2016-6662](https://github.com/meersjo/ansible-mysql-cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---



---

## POC #4

**来源**: [CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md](../2016/CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 配置覆盖/本地权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，允许本地用户创建任意配置并绕过某些保护机制，最终导致以 root 权限执行任意代码

**影响版本:** MySQL through 5.5.52, 5.6.x through 5.6.33, and 5.7.x through 5.7.15; MariaDB before 5.5.51, 10.0.x before 10.0.27, and 10.1.x before 10.1.17; and Percona Server before 5.5.51-38.1, 5.6.x before 5.6.32-78.0, and 5.7.x before 5.7.14-7

**利用条件:** 需要具备对 MySQL 数据库一定的写入权限（如通过 SQL 注入）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 漏洞允许攻击者通过设置 `general_log_file` 到 `my.cnf` 配置文件来创建任意配置，从而绕过某些保护机制。更进一步，通过设置 `malloc_lib` 选项，可以加载恶意动态链接库，最终导致以 root 权限执行任意代码。

**利用方式：**

1.  **前提条件：** 攻击者需要通过某种方式（例如 SQL 注入）获取对 MySQL 数据库的写入权限。
2.  **写入恶意配置：**  攻击者利用 SQL 注入漏洞，将 `general_log_file` 设置为一个精心构造的 `my.cnf` 配置文件路径，该配置文件中包含恶意的 `malloc_lib` 选项。
3.  **上传恶意动态链接库：**  攻击者将包含恶意代码的动态链接库（`mysql_hookandroot_lib.so`）上传到服务器上的某个可写目录（如 `/var/lib/mysql/`）。
4.  **触发漏洞：**  攻击者通过触发 MySQL 的日志功能，使 MySQL 加载并解析恶意的 `my.cnf` 配置文件，从而加载恶意动态链接库。
5.  **代码执行：**  恶意动态链接库中的代码被执行，攻击者获得 root 权限。

**POC 代码分析：**

提供的 Python 脚本 `From SQL injection to root shell.py` 实现了上述利用流程：

*   `craft_payloads()` 函数生成用于利用漏洞的 SQL 注入 payload。
*   该函数首先创建恶意触发器，该触发器将恶意配置写入 `my.cnf` 文件。
*   然后，该函数将恶意动态链接库 `mysql_hookandroot_lib.so` 的内容写入服务器上的文件。
*   最后，该函数创建 `poctable` 表，并通过插入数据来触发恶意触发器，从而执行代码。

**有效性：**

根据漏洞描述和提供的 POC 代码，该漏洞利用方法是有效的，只要满足利用条件（例如可写权限和特定 MySQL 版本）。

**投毒风险：**

该 POC 代码的主要目的是利用漏洞，但存在一定的投毒风险。 虽然大部分代码是为了验证和利用漏洞，但攻击者可能会在 `mysql_hookandroot_lib.so` 中添加后门或其他恶意功能，从而在成功利用漏洞后保持对系统的长期访问。 这里的投毒风险评估为10%, 主要体现在`mysql_hookandroot_lib.so` 恶意动态链接库上，如果该链接库被替换成具有其他恶意功能的链接库，则可能造成危害。


**项目地址:** [MAYASEVEN/CVE-2016-6662](https://github.com/MAYASEVEN/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #5

**来源**: [CVE-2016-6662-boompig_cve-2016-6662.md](../2016/CVE-2016-6662-boompig_cve-2016-6662.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可导致数据库服务器完全控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 需要能够修改MySQL配置文件 (my.cnf) 并且目标服务器运行受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 选项为 `my.cnf` 配置文件，创建任意配置并绕过某些保护机制。 这可以被利用来执行具有 root 权限的任意代码，通过设置 `malloc_lib` 选项。提供的PoC代码 `0ldSQL_MySQL_RCE_exploit.py` 是一个有限的版本，仅允许附加到现有 MySQL 配置文件的末尾。完整利用需要目标my.cnf具有mysql用户可写的权限。利用方式如下：

1.  **编译恶意共享库 (mysql_hookandroot_lib.so):**  该库包含恶意代码，用于提权和执行命令。
2.  **将恶意库转换为十六进制:** 将编译好的共享库内容转换为十六进制字符串。
3.  **利用SQL注入或其它方式修改my.cnf:**  将`malloc_lib`设置为恶意共享库的路径，并将`general_log_file`设置为`my.cnf`。需要具有FILE权限。
4.  **重启 MySQL 服务:**  重启后，MySQL将加载恶意共享库，执行其中的代码，从而获得 root 权限。

**投毒风险分析:**

该PoC代码的投毒风险较低 (10%)。PoC本身的功能是演示如何利用漏洞，并包含编译shellcode等必要步骤。然而，不排除作者在编译恶意库的过程中可能隐藏恶意代码的可能性。因此，在使用该PoC时，务必仔细审查代码，特别是 `mysql_hookandroot_lib.c` 文件，并进行代码审计以确保其安全性。

搜索引擎结果表明，该漏洞影响广泛，多个厂商的MySQL发行版都受影响。修复方案包括升级到最新版本或应用厂商提供的补丁。

**项目地址:** [boompig/cve-2016-6662](https://github.com/boompig/cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #6

**来源**: [CVE-2016-6662-kanyaars_CVE-2016-6662.md](../2016/CVE-2016-6662-kanyaars_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户或具有FILE权限的远程用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户（或具有FILE权限的远程用户）通过设置 `general_log_file` 到 `my.cnf` 配置来创建任意配置和绕过某些保护机制。更严重的是，这可以被利用通过设置 `malloc_lib` 来执行具有 root 权限的任意代码。

**利用方式：**

1.  **写入恶意配置：** 攻击者利用数据库的FILE权限，将`general_log_file`指向一个攻击者可控的文件。这个文件会被解析为MySQL的配置文件。
2.  **设置malloc_lib：** 在该配置文件中，攻击者设置`malloc_lib`指向一个恶意的动态链接库（.so文件）。
3.  **重启MySQL服务：** 当MySQL服务重启时，会加载`malloc_lib`指定的恶意动态链接库，从而执行攻击者预设的恶意代码，获得服务器的root权限。

**POC分析：**
提供的POC代码包含两个文件：一个C语言编写的动态链接库 (`911KanyaLab_lib.c`) 和一个 Python 脚本 (`Exploit_Old_MySQL_Kay_ver.py`)。

*   **`911KanyaLab_lib.c`：** 这个C代码会被编译成`.so`文件。它定义了一个`execvp` hook函数，用于在MySQL启动时执行恶意代码。恶意代码的功能是创建一个反向Shell，连接到攻击者的IP地址和端口。
*   **`Exploit_Old_MySQL_Kay_ver.py`：** 这个Python脚本负责连接到目标MySQL服务器，上传并配置恶意的`.so`文件，并触发MySQL重启。

**投毒风险分析：**
代码主要逻辑是创建反向shell，连接攻击者的机器。存在投毒的可能。分析得出存在以下潜在的投毒风险:
*   C代码中IP地址和端口是硬编码的，如果攻击者篡改这些值，可能会将shell连接到其他恶意服务器。但是从代码逻辑来判断是为了完成漏洞验证的必要后门代码。
*   Python脚本需要指定MySQL用户名、密码、数据库名和`my.cnf`路径，这些信息可能被记录或泄露。
*   `config_cleanup()`函数的功能是清除注入的配置，但如果实现不正确，可能留下痕迹。

整体代码质量不高，存在一些硬编码，但主要功能符合漏洞描述，总体上是可信的。 但是依然存在作者隐藏的投毒代码的可能，但是可能性较低。

**项目地址:** [kanyaars/CVE-2016-6662](https://github.com/kanyaars/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #7

**来源**: [CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md](../2016/CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md)

## CVE-2016-6662 - MySQL/MariaDB/PerconaDB 权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** MySQL: <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB: < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server: < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这可以被利用来通过设置 malloc_lib 以 root 权限执行任意代码。根据搜索结果，这是一个严重的安全漏洞，影响多个 MySQL 及其分支版本。利用方式通常涉及修改MySQL的配置文件，将 general_log_file 指向攻击者可控的文件，并在其中写入恶意配置，例如加载恶意动态链接库以执行任意代码。提供的Playbook 旨在通过添加安全检查来修补 `mysqld_safe` 脚本，防止从非标准系统目录加载 `ld_preload` 库。因此，此 Playbook 实际上是一个补丁，并非漏洞利用代码。Playbook 代码本身旨在修复漏洞，未发现隐藏的恶意代码，因此投毒风险为0%。根据漏洞信息和搜索结果，此漏洞影响广泛，需要尽快修复。

**项目地址:** [konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch](https://github.com/konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #8

**来源**: [CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md](../2016/CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md)

## CVE-2016-6662 - MySQL 远程 Root 代码执行/权限提升

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致数据库完全控制和服务器接管

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或 SQL 注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 选项到 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这个漏洞可以被利用来以 root 权限执行任意代码，通过设置 malloc_lib 选项指向恶意 .so 文件。此利用方式依赖于可以写入 MySQL 配置文件，并重启 MySQL 服务。 

**有效性：** 提供的 Ansible 脚本旨在修复此漏洞，而非利用它。它通过修改 mysqld_safe 脚本，限制 .so 文件的加载路径到标准系统目录，并检查默认配置文件的存在性和权限来缓解风险，因此提供的代码是用于防御而不是利用的。

**投毒风险：**  该仓库本身包含的是修复漏洞的脚本，直接投毒的可能性较低。但是，仍然存在以下风险：

1.  **脚本本身可能存在缺陷：**  虽然脚本旨在修复漏洞，但如果脚本本身存在逻辑错误或未考虑到的情况，可能会导致 MySQL 服务不稳定或其他问题。 
2.  **供应链攻击：**  该仓库可能被黑客入侵，然后植入恶意代码。由于脚本需要修改系统文件和重启服务，一旦被植入恶意代码，危害非常大。 
3.  **依赖关系：**  该脚本可能依赖其他软件包或库，这些依赖项可能存在漏洞。  
综合考虑，投毒风险评估为 10%。 这个百分比是因为代码主要是防御性的，并且已经经过了相当数量的安装验证，降低了直接恶意代码的可能性。但供应链风险和脚本缺陷始终存在。

**利用方式：**

1.  **利用条件：**  需要拥有对 MySQL 服务器的本地用户权限或者能够通过 SQL 注入漏洞执行命令。
2.  **写入恶意配置：**  利用权限，将 `general_log_file` 设置为指向包含恶意配置的文件的路径。恶意配置中，设置 `malloc_lib` 指向恶意的 .so 文件。
3.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意 .so 文件被加载，从而执行任意代码。

搜索结果也表明，可以通过 SQL 注入来利用这个漏洞，意味着攻击者不需要本地账户，可以通过SQL注入写入配置，然后利用此漏洞提权至root。


**项目地址:** [meersjo/ansible-mysql-cve-2016-6662](https://github.com/meersjo/ansible-mysql-cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---



---

## POC #4

**来源**: [CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md](../2016/CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 配置覆盖/本地权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，允许本地用户创建任意配置并绕过某些保护机制，最终导致以 root 权限执行任意代码

**影响版本:** MySQL through 5.5.52, 5.6.x through 5.6.33, and 5.7.x through 5.7.15; MariaDB before 5.5.51, 10.0.x before 10.0.27, and 10.1.x before 10.1.17; and Percona Server before 5.5.51-38.1, 5.6.x before 5.6.32-78.0, and 5.7.x before 5.7.14-7

**利用条件:** 需要具备对 MySQL 数据库一定的写入权限（如通过 SQL 注入）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 漏洞允许攻击者通过设置 `general_log_file` 到 `my.cnf` 配置文件来创建任意配置，从而绕过某些保护机制。更进一步，通过设置 `malloc_lib` 选项，可以加载恶意动态链接库，最终导致以 root 权限执行任意代码。

**利用方式：**

1.  **前提条件：** 攻击者需要通过某种方式（例如 SQL 注入）获取对 MySQL 数据库的写入权限。
2.  **写入恶意配置：**  攻击者利用 SQL 注入漏洞，将 `general_log_file` 设置为一个精心构造的 `my.cnf` 配置文件路径，该配置文件中包含恶意的 `malloc_lib` 选项。
3.  **上传恶意动态链接库：**  攻击者将包含恶意代码的动态链接库（`mysql_hookandroot_lib.so`）上传到服务器上的某个可写目录（如 `/var/lib/mysql/`）。
4.  **触发漏洞：**  攻击者通过触发 MySQL 的日志功能，使 MySQL 加载并解析恶意的 `my.cnf` 配置文件，从而加载恶意动态链接库。
5.  **代码执行：**  恶意动态链接库中的代码被执行，攻击者获得 root 权限。

**POC 代码分析：**

提供的 Python 脚本 `From SQL injection to root shell.py` 实现了上述利用流程：

*   `craft_payloads()` 函数生成用于利用漏洞的 SQL 注入 payload。
*   该函数首先创建恶意触发器，该触发器将恶意配置写入 `my.cnf` 文件。
*   然后，该函数将恶意动态链接库 `mysql_hookandroot_lib.so` 的内容写入服务器上的文件。
*   最后，该函数创建 `poctable` 表，并通过插入数据来触发恶意触发器，从而执行代码。

**有效性：**

根据漏洞描述和提供的 POC 代码，该漏洞利用方法是有效的，只要满足利用条件（例如可写权限和特定 MySQL 版本）。

**投毒风险：**

该 POC 代码的主要目的是利用漏洞，但存在一定的投毒风险。 虽然大部分代码是为了验证和利用漏洞，但攻击者可能会在 `mysql_hookandroot_lib.so` 中添加后门或其他恶意功能，从而在成功利用漏洞后保持对系统的长期访问。 这里的投毒风险评估为10%, 主要体现在`mysql_hookandroot_lib.so` 恶意动态链接库上，如果该链接库被替换成具有其他恶意功能的链接库，则可能造成危害。


**项目地址:** [MAYASEVEN/CVE-2016-6662](https://github.com/MAYASEVEN/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #5

**来源**: [CVE-2016-6662-boompig_cve-2016-6662.md](../2016/CVE-2016-6662-boompig_cve-2016-6662.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可导致数据库服务器完全控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 需要能够修改MySQL配置文件 (my.cnf) 并且目标服务器运行受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 选项为 `my.cnf` 配置文件，创建任意配置并绕过某些保护机制。 这可以被利用来执行具有 root 权限的任意代码，通过设置 `malloc_lib` 选项。提供的PoC代码 `0ldSQL_MySQL_RCE_exploit.py` 是一个有限的版本，仅允许附加到现有 MySQL 配置文件的末尾。完整利用需要目标my.cnf具有mysql用户可写的权限。利用方式如下：

1.  **编译恶意共享库 (mysql_hookandroot_lib.so):**  该库包含恶意代码，用于提权和执行命令。
2.  **将恶意库转换为十六进制:** 将编译好的共享库内容转换为十六进制字符串。
3.  **利用SQL注入或其它方式修改my.cnf:**  将`malloc_lib`设置为恶意共享库的路径，并将`general_log_file`设置为`my.cnf`。需要具有FILE权限。
4.  **重启 MySQL 服务:**  重启后，MySQL将加载恶意共享库，执行其中的代码，从而获得 root 权限。

**投毒风险分析:**

该PoC代码的投毒风险较低 (10%)。PoC本身的功能是演示如何利用漏洞，并包含编译shellcode等必要步骤。然而，不排除作者在编译恶意库的过程中可能隐藏恶意代码的可能性。因此，在使用该PoC时，务必仔细审查代码，特别是 `mysql_hookandroot_lib.c` 文件，并进行代码审计以确保其安全性。

搜索引擎结果表明，该漏洞影响广泛，多个厂商的MySQL发行版都受影响。修复方案包括升级到最新版本或应用厂商提供的补丁。

**项目地址:** [boompig/cve-2016-6662](https://github.com/boompig/cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #6

**来源**: [CVE-2016-6662-kanyaars_CVE-2016-6662.md](../2016/CVE-2016-6662-kanyaars_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户或具有FILE权限的远程用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户（或具有FILE权限的远程用户）通过设置 `general_log_file` 到 `my.cnf` 配置来创建任意配置和绕过某些保护机制。更严重的是，这可以被利用通过设置 `malloc_lib` 来执行具有 root 权限的任意代码。

**利用方式：**

1.  **写入恶意配置：** 攻击者利用数据库的FILE权限，将`general_log_file`指向一个攻击者可控的文件。这个文件会被解析为MySQL的配置文件。
2.  **设置malloc_lib：** 在该配置文件中，攻击者设置`malloc_lib`指向一个恶意的动态链接库（.so文件）。
3.  **重启MySQL服务：** 当MySQL服务重启时，会加载`malloc_lib`指定的恶意动态链接库，从而执行攻击者预设的恶意代码，获得服务器的root权限。

**POC分析：**
提供的POC代码包含两个文件：一个C语言编写的动态链接库 (`911KanyaLab_lib.c`) 和一个 Python 脚本 (`Exploit_Old_MySQL_Kay_ver.py`)。

*   **`911KanyaLab_lib.c`：** 这个C代码会被编译成`.so`文件。它定义了一个`execvp` hook函数，用于在MySQL启动时执行恶意代码。恶意代码的功能是创建一个反向Shell，连接到攻击者的IP地址和端口。
*   **`Exploit_Old_MySQL_Kay_ver.py`：** 这个Python脚本负责连接到目标MySQL服务器，上传并配置恶意的`.so`文件，并触发MySQL重启。

**投毒风险分析：**
代码主要逻辑是创建反向shell，连接攻击者的机器。存在投毒的可能。分析得出存在以下潜在的投毒风险:
*   C代码中IP地址和端口是硬编码的，如果攻击者篡改这些值，可能会将shell连接到其他恶意服务器。但是从代码逻辑来判断是为了完成漏洞验证的必要后门代码。
*   Python脚本需要指定MySQL用户名、密码、数据库名和`my.cnf`路径，这些信息可能被记录或泄露。
*   `config_cleanup()`函数的功能是清除注入的配置，但如果实现不正确，可能留下痕迹。

整体代码质量不高，存在一些硬编码，但主要功能符合漏洞描述，总体上是可信的。 但是依然存在作者隐藏的投毒代码的可能，但是可能性较低。

**项目地址:** [kanyaars/CVE-2016-6662](https://github.com/kanyaars/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #7

**来源**: [CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md](../2016/CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md)

## CVE-2016-6662 - MySQL/MariaDB/PerconaDB 权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** MySQL: <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB: < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server: < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这可以被利用来通过设置 malloc_lib 以 root 权限执行任意代码。根据搜索结果，这是一个严重的安全漏洞，影响多个 MySQL 及其分支版本。利用方式通常涉及修改MySQL的配置文件，将 general_log_file 指向攻击者可控的文件，并在其中写入恶意配置，例如加载恶意动态链接库以执行任意代码。提供的Playbook 旨在通过添加安全检查来修补 `mysqld_safe` 脚本，防止从非标准系统目录加载 `ld_preload` 库。因此，此 Playbook 实际上是一个补丁，并非漏洞利用代码。Playbook 代码本身旨在修复漏洞，未发现隐藏的恶意代码，因此投毒风险为0%。根据漏洞信息和搜索结果，此漏洞影响广泛，需要尽快修复。

**项目地址:** [konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch](https://github.com/konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #8

**来源**: [CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md](../2016/CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md)

## CVE-2016-6662 - MySQL 远程 Root 代码执行/权限提升

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致数据库完全控制和服务器接管

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或 SQL 注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 选项到 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这个漏洞可以被利用来以 root 权限执行任意代码，通过设置 malloc_lib 选项指向恶意 .so 文件。此利用方式依赖于可以写入 MySQL 配置文件，并重启 MySQL 服务。 

**有效性：** 提供的 Ansible 脚本旨在修复此漏洞，而非利用它。它通过修改 mysqld_safe 脚本，限制 .so 文件的加载路径到标准系统目录，并检查默认配置文件的存在性和权限来缓解风险，因此提供的代码是用于防御而不是利用的。

**投毒风险：**  该仓库本身包含的是修复漏洞的脚本，直接投毒的可能性较低。但是，仍然存在以下风险：

1.  **脚本本身可能存在缺陷：**  虽然脚本旨在修复漏洞，但如果脚本本身存在逻辑错误或未考虑到的情况，可能会导致 MySQL 服务不稳定或其他问题。 
2.  **供应链攻击：**  该仓库可能被黑客入侵，然后植入恶意代码。由于脚本需要修改系统文件和重启服务，一旦被植入恶意代码，危害非常大。 
3.  **依赖关系：**  该脚本可能依赖其他软件包或库，这些依赖项可能存在漏洞。  
综合考虑，投毒风险评估为 10%。 这个百分比是因为代码主要是防御性的，并且已经经过了相当数量的安装验证，降低了直接恶意代码的可能性。但供应链风险和脚本缺陷始终存在。

**利用方式：**

1.  **利用条件：**  需要拥有对 MySQL 服务器的本地用户权限或者能够通过 SQL 注入漏洞执行命令。
2.  **写入恶意配置：**  利用权限，将 `general_log_file` 设置为指向包含恶意配置的文件的路径。恶意配置中，设置 `malloc_lib` 指向恶意的 .so 文件。
3.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意 .so 文件被加载，从而执行任意代码。

搜索结果也表明，可以通过 SQL 注入来利用这个漏洞，意味着攻击者不需要本地账户，可以通过SQL注入写入配置，然后利用此漏洞提权至root。


**项目地址:** [meersjo/ansible-mysql-cve-2016-6662](https://github.com/meersjo/ansible-mysql-cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---



---

## POC #4

**来源**: [CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md](../2016/CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 配置覆盖/本地权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，允许本地用户创建任意配置并绕过某些保护机制，最终导致以 root 权限执行任意代码

**影响版本:** MySQL through 5.5.52, 5.6.x through 5.6.33, and 5.7.x through 5.7.15; MariaDB before 5.5.51, 10.0.x before 10.0.27, and 10.1.x before 10.1.17; and Percona Server before 5.5.51-38.1, 5.6.x before 5.6.32-78.0, and 5.7.x before 5.7.14-7

**利用条件:** 需要具备对 MySQL 数据库一定的写入权限（如通过 SQL 注入）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 漏洞允许攻击者通过设置 `general_log_file` 到 `my.cnf` 配置文件来创建任意配置，从而绕过某些保护机制。更进一步，通过设置 `malloc_lib` 选项，可以加载恶意动态链接库，最终导致以 root 权限执行任意代码。

**利用方式：**

1.  **前提条件：** 攻击者需要通过某种方式（例如 SQL 注入）获取对 MySQL 数据库的写入权限。
2.  **写入恶意配置：**  攻击者利用 SQL 注入漏洞，将 `general_log_file` 设置为一个精心构造的 `my.cnf` 配置文件路径，该配置文件中包含恶意的 `malloc_lib` 选项。
3.  **上传恶意动态链接库：**  攻击者将包含恶意代码的动态链接库（`mysql_hookandroot_lib.so`）上传到服务器上的某个可写目录（如 `/var/lib/mysql/`）。
4.  **触发漏洞：**  攻击者通过触发 MySQL 的日志功能，使 MySQL 加载并解析恶意的 `my.cnf` 配置文件，从而加载恶意动态链接库。
5.  **代码执行：**  恶意动态链接库中的代码被执行，攻击者获得 root 权限。

**POC 代码分析：**

提供的 Python 脚本 `From SQL injection to root shell.py` 实现了上述利用流程：

*   `craft_payloads()` 函数生成用于利用漏洞的 SQL 注入 payload。
*   该函数首先创建恶意触发器，该触发器将恶意配置写入 `my.cnf` 文件。
*   然后，该函数将恶意动态链接库 `mysql_hookandroot_lib.so` 的内容写入服务器上的文件。
*   最后，该函数创建 `poctable` 表，并通过插入数据来触发恶意触发器，从而执行代码。

**有效性：**

根据漏洞描述和提供的 POC 代码，该漏洞利用方法是有效的，只要满足利用条件（例如可写权限和特定 MySQL 版本）。

**投毒风险：**

该 POC 代码的主要目的是利用漏洞，但存在一定的投毒风险。 虽然大部分代码是为了验证和利用漏洞，但攻击者可能会在 `mysql_hookandroot_lib.so` 中添加后门或其他恶意功能，从而在成功利用漏洞后保持对系统的长期访问。 这里的投毒风险评估为10%, 主要体现在`mysql_hookandroot_lib.so` 恶意动态链接库上，如果该链接库被替换成具有其他恶意功能的链接库，则可能造成危害。


**项目地址:** [MAYASEVEN/CVE-2016-6662](https://github.com/MAYASEVEN/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #5

**来源**: [CVE-2016-6662-boompig_cve-2016-6662.md](../2016/CVE-2016-6662-boompig_cve-2016-6662.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可导致数据库服务器完全控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 需要能够修改MySQL配置文件 (my.cnf) 并且目标服务器运行受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 选项为 `my.cnf` 配置文件，创建任意配置并绕过某些保护机制。 这可以被利用来执行具有 root 权限的任意代码，通过设置 `malloc_lib` 选项。提供的PoC代码 `0ldSQL_MySQL_RCE_exploit.py` 是一个有限的版本，仅允许附加到现有 MySQL 配置文件的末尾。完整利用需要目标my.cnf具有mysql用户可写的权限。利用方式如下：

1.  **编译恶意共享库 (mysql_hookandroot_lib.so):**  该库包含恶意代码，用于提权和执行命令。
2.  **将恶意库转换为十六进制:** 将编译好的共享库内容转换为十六进制字符串。
3.  **利用SQL注入或其它方式修改my.cnf:**  将`malloc_lib`设置为恶意共享库的路径，并将`general_log_file`设置为`my.cnf`。需要具有FILE权限。
4.  **重启 MySQL 服务:**  重启后，MySQL将加载恶意共享库，执行其中的代码，从而获得 root 权限。

**投毒风险分析:**

该PoC代码的投毒风险较低 (10%)。PoC本身的功能是演示如何利用漏洞，并包含编译shellcode等必要步骤。然而，不排除作者在编译恶意库的过程中可能隐藏恶意代码的可能性。因此，在使用该PoC时，务必仔细审查代码，特别是 `mysql_hookandroot_lib.c` 文件，并进行代码审计以确保其安全性。

搜索引擎结果表明，该漏洞影响广泛，多个厂商的MySQL发行版都受影响。修复方案包括升级到最新版本或应用厂商提供的补丁。

**项目地址:** [boompig/cve-2016-6662](https://github.com/boompig/cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #6

**来源**: [CVE-2016-6662-kanyaars_CVE-2016-6662.md](../2016/CVE-2016-6662-kanyaars_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户或具有FILE权限的远程用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户（或具有FILE权限的远程用户）通过设置 `general_log_file` 到 `my.cnf` 配置来创建任意配置和绕过某些保护机制。更严重的是，这可以被利用通过设置 `malloc_lib` 来执行具有 root 权限的任意代码。

**利用方式：**

1.  **写入恶意配置：** 攻击者利用数据库的FILE权限，将`general_log_file`指向一个攻击者可控的文件。这个文件会被解析为MySQL的配置文件。
2.  **设置malloc_lib：** 在该配置文件中，攻击者设置`malloc_lib`指向一个恶意的动态链接库（.so文件）。
3.  **重启MySQL服务：** 当MySQL服务重启时，会加载`malloc_lib`指定的恶意动态链接库，从而执行攻击者预设的恶意代码，获得服务器的root权限。

**POC分析：**
提供的POC代码包含两个文件：一个C语言编写的动态链接库 (`911KanyaLab_lib.c`) 和一个 Python 脚本 (`Exploit_Old_MySQL_Kay_ver.py`)。

*   **`911KanyaLab_lib.c`：** 这个C代码会被编译成`.so`文件。它定义了一个`execvp` hook函数，用于在MySQL启动时执行恶意代码。恶意代码的功能是创建一个反向Shell，连接到攻击者的IP地址和端口。
*   **`Exploit_Old_MySQL_Kay_ver.py`：** 这个Python脚本负责连接到目标MySQL服务器，上传并配置恶意的`.so`文件，并触发MySQL重启。

**投毒风险分析：**
代码主要逻辑是创建反向shell，连接攻击者的机器。存在投毒的可能。分析得出存在以下潜在的投毒风险:
*   C代码中IP地址和端口是硬编码的，如果攻击者篡改这些值，可能会将shell连接到其他恶意服务器。但是从代码逻辑来判断是为了完成漏洞验证的必要后门代码。
*   Python脚本需要指定MySQL用户名、密码、数据库名和`my.cnf`路径，这些信息可能被记录或泄露。
*   `config_cleanup()`函数的功能是清除注入的配置，但如果实现不正确，可能留下痕迹。

整体代码质量不高，存在一些硬编码，但主要功能符合漏洞描述，总体上是可信的。 但是依然存在作者隐藏的投毒代码的可能，但是可能性较低。

**项目地址:** [kanyaars/CVE-2016-6662](https://github.com/kanyaars/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #7

**来源**: [CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md](../2016/CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md)

## CVE-2016-6662 - MySQL/MariaDB/PerconaDB 权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** MySQL: <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB: < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server: < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这可以被利用来通过设置 malloc_lib 以 root 权限执行任意代码。根据搜索结果，这是一个严重的安全漏洞，影响多个 MySQL 及其分支版本。利用方式通常涉及修改MySQL的配置文件，将 general_log_file 指向攻击者可控的文件，并在其中写入恶意配置，例如加载恶意动态链接库以执行任意代码。提供的Playbook 旨在通过添加安全检查来修补 `mysqld_safe` 脚本，防止从非标准系统目录加载 `ld_preload` 库。因此，此 Playbook 实际上是一个补丁，并非漏洞利用代码。Playbook 代码本身旨在修复漏洞，未发现隐藏的恶意代码，因此投毒风险为0%。根据漏洞信息和搜索结果，此漏洞影响广泛，需要尽快修复。

**项目地址:** [konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch](https://github.com/konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #8

**来源**: [CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md](../2016/CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md)

## CVE-2016-6662 - MySQL 远程 Root 代码执行/权限提升

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致数据库完全控制和服务器接管

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或 SQL 注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 选项到 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这个漏洞可以被利用来以 root 权限执行任意代码，通过设置 malloc_lib 选项指向恶意 .so 文件。此利用方式依赖于可以写入 MySQL 配置文件，并重启 MySQL 服务。 

**有效性：** 提供的 Ansible 脚本旨在修复此漏洞，而非利用它。它通过修改 mysqld_safe 脚本，限制 .so 文件的加载路径到标准系统目录，并检查默认配置文件的存在性和权限来缓解风险，因此提供的代码是用于防御而不是利用的。

**投毒风险：**  该仓库本身包含的是修复漏洞的脚本，直接投毒的可能性较低。但是，仍然存在以下风险：

1.  **脚本本身可能存在缺陷：**  虽然脚本旨在修复漏洞，但如果脚本本身存在逻辑错误或未考虑到的情况，可能会导致 MySQL 服务不稳定或其他问题。 
2.  **供应链攻击：**  该仓库可能被黑客入侵，然后植入恶意代码。由于脚本需要修改系统文件和重启服务，一旦被植入恶意代码，危害非常大。 
3.  **依赖关系：**  该脚本可能依赖其他软件包或库，这些依赖项可能存在漏洞。  
综合考虑，投毒风险评估为 10%。 这个百分比是因为代码主要是防御性的，并且已经经过了相当数量的安装验证，降低了直接恶意代码的可能性。但供应链风险和脚本缺陷始终存在。

**利用方式：**

1.  **利用条件：**  需要拥有对 MySQL 服务器的本地用户权限或者能够通过 SQL 注入漏洞执行命令。
2.  **写入恶意配置：**  利用权限，将 `general_log_file` 设置为指向包含恶意配置的文件的路径。恶意配置中，设置 `malloc_lib` 指向恶意的 .so 文件。
3.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意 .so 文件被加载，从而执行任意代码。

搜索结果也表明，可以通过 SQL 注入来利用这个漏洞，意味着攻击者不需要本地账户，可以通过SQL注入写入配置，然后利用此漏洞提权至root。


**项目地址:** [meersjo/ansible-mysql-cve-2016-6662](https://github.com/meersjo/ansible-mysql-cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---



---

## POC #4

**来源**: [CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md](../2016/CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 配置覆盖/本地权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，允许本地用户创建任意配置并绕过某些保护机制，最终导致以 root 权限执行任意代码

**影响版本:** MySQL through 5.5.52, 5.6.x through 5.6.33, and 5.7.x through 5.7.15; MariaDB before 5.5.51, 10.0.x before 10.0.27, and 10.1.x before 10.1.17; and Percona Server before 5.5.51-38.1, 5.6.x before 5.6.32-78.0, and 5.7.x before 5.7.14-7

**利用条件:** 需要具备对 MySQL 数据库一定的写入权限（如通过 SQL 注入）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 漏洞允许攻击者通过设置 `general_log_file` 到 `my.cnf` 配置文件来创建任意配置，从而绕过某些保护机制。更进一步，通过设置 `malloc_lib` 选项，可以加载恶意动态链接库，最终导致以 root 权限执行任意代码。

**利用方式：**

1.  **前提条件：** 攻击者需要通过某种方式（例如 SQL 注入）获取对 MySQL 数据库的写入权限。
2.  **写入恶意配置：**  攻击者利用 SQL 注入漏洞，将 `general_log_file` 设置为一个精心构造的 `my.cnf` 配置文件路径，该配置文件中包含恶意的 `malloc_lib` 选项。
3.  **上传恶意动态链接库：**  攻击者将包含恶意代码的动态链接库（`mysql_hookandroot_lib.so`）上传到服务器上的某个可写目录（如 `/var/lib/mysql/`）。
4.  **触发漏洞：**  攻击者通过触发 MySQL 的日志功能，使 MySQL 加载并解析恶意的 `my.cnf` 配置文件，从而加载恶意动态链接库。
5.  **代码执行：**  恶意动态链接库中的代码被执行，攻击者获得 root 权限。

**POC 代码分析：**

提供的 Python 脚本 `From SQL injection to root shell.py` 实现了上述利用流程：

*   `craft_payloads()` 函数生成用于利用漏洞的 SQL 注入 payload。
*   该函数首先创建恶意触发器，该触发器将恶意配置写入 `my.cnf` 文件。
*   然后，该函数将恶意动态链接库 `mysql_hookandroot_lib.so` 的内容写入服务器上的文件。
*   最后，该函数创建 `poctable` 表，并通过插入数据来触发恶意触发器，从而执行代码。

**有效性：**

根据漏洞描述和提供的 POC 代码，该漏洞利用方法是有效的，只要满足利用条件（例如可写权限和特定 MySQL 版本）。

**投毒风险：**

该 POC 代码的主要目的是利用漏洞，但存在一定的投毒风险。 虽然大部分代码是为了验证和利用漏洞，但攻击者可能会在 `mysql_hookandroot_lib.so` 中添加后门或其他恶意功能，从而在成功利用漏洞后保持对系统的长期访问。 这里的投毒风险评估为10%, 主要体现在`mysql_hookandroot_lib.so` 恶意动态链接库上，如果该链接库被替换成具有其他恶意功能的链接库，则可能造成危害。


**项目地址:** [MAYASEVEN/CVE-2016-6662](https://github.com/MAYASEVEN/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #5

**来源**: [CVE-2016-6662-boompig_cve-2016-6662.md](../2016/CVE-2016-6662-boompig_cve-2016-6662.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可导致数据库服务器完全控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 需要能够修改MySQL配置文件 (my.cnf) 并且目标服务器运行受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 选项为 `my.cnf` 配置文件，创建任意配置并绕过某些保护机制。 这可以被利用来执行具有 root 权限的任意代码，通过设置 `malloc_lib` 选项。提供的PoC代码 `0ldSQL_MySQL_RCE_exploit.py` 是一个有限的版本，仅允许附加到现有 MySQL 配置文件的末尾。完整利用需要目标my.cnf具有mysql用户可写的权限。利用方式如下：

1.  **编译恶意共享库 (mysql_hookandroot_lib.so):**  该库包含恶意代码，用于提权和执行命令。
2.  **将恶意库转换为十六进制:** 将编译好的共享库内容转换为十六进制字符串。
3.  **利用SQL注入或其它方式修改my.cnf:**  将`malloc_lib`设置为恶意共享库的路径，并将`general_log_file`设置为`my.cnf`。需要具有FILE权限。
4.  **重启 MySQL 服务:**  重启后，MySQL将加载恶意共享库，执行其中的代码，从而获得 root 权限。

**投毒风险分析:**

该PoC代码的投毒风险较低 (10%)。PoC本身的功能是演示如何利用漏洞，并包含编译shellcode等必要步骤。然而，不排除作者在编译恶意库的过程中可能隐藏恶意代码的可能性。因此，在使用该PoC时，务必仔细审查代码，特别是 `mysql_hookandroot_lib.c` 文件，并进行代码审计以确保其安全性。

搜索引擎结果表明，该漏洞影响广泛，多个厂商的MySQL发行版都受影响。修复方案包括升级到最新版本或应用厂商提供的补丁。

**项目地址:** [boompig/cve-2016-6662](https://github.com/boompig/cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #6

**来源**: [CVE-2016-6662-kanyaars_CVE-2016-6662.md](../2016/CVE-2016-6662-kanyaars_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户或具有FILE权限的远程用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户（或具有FILE权限的远程用户）通过设置 `general_log_file` 到 `my.cnf` 配置来创建任意配置和绕过某些保护机制。更严重的是，这可以被利用通过设置 `malloc_lib` 来执行具有 root 权限的任意代码。

**利用方式：**

1.  **写入恶意配置：** 攻击者利用数据库的FILE权限，将`general_log_file`指向一个攻击者可控的文件。这个文件会被解析为MySQL的配置文件。
2.  **设置malloc_lib：** 在该配置文件中，攻击者设置`malloc_lib`指向一个恶意的动态链接库（.so文件）。
3.  **重启MySQL服务：** 当MySQL服务重启时，会加载`malloc_lib`指定的恶意动态链接库，从而执行攻击者预设的恶意代码，获得服务器的root权限。

**POC分析：**
提供的POC代码包含两个文件：一个C语言编写的动态链接库 (`911KanyaLab_lib.c`) 和一个 Python 脚本 (`Exploit_Old_MySQL_Kay_ver.py`)。

*   **`911KanyaLab_lib.c`：** 这个C代码会被编译成`.so`文件。它定义了一个`execvp` hook函数，用于在MySQL启动时执行恶意代码。恶意代码的功能是创建一个反向Shell，连接到攻击者的IP地址和端口。
*   **`Exploit_Old_MySQL_Kay_ver.py`：** 这个Python脚本负责连接到目标MySQL服务器，上传并配置恶意的`.so`文件，并触发MySQL重启。

**投毒风险分析：**
代码主要逻辑是创建反向shell，连接攻击者的机器。存在投毒的可能。分析得出存在以下潜在的投毒风险:
*   C代码中IP地址和端口是硬编码的，如果攻击者篡改这些值，可能会将shell连接到其他恶意服务器。但是从代码逻辑来判断是为了完成漏洞验证的必要后门代码。
*   Python脚本需要指定MySQL用户名、密码、数据库名和`my.cnf`路径，这些信息可能被记录或泄露。
*   `config_cleanup()`函数的功能是清除注入的配置，但如果实现不正确，可能留下痕迹。

整体代码质量不高，存在一些硬编码，但主要功能符合漏洞描述，总体上是可信的。 但是依然存在作者隐藏的投毒代码的可能，但是可能性较低。

**项目地址:** [kanyaars/CVE-2016-6662](https://github.com/kanyaars/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #7

**来源**: [CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md](../2016/CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md)

## CVE-2016-6662 - MySQL/MariaDB/PerconaDB 权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** MySQL: <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB: < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server: < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这可以被利用来通过设置 malloc_lib 以 root 权限执行任意代码。根据搜索结果，这是一个严重的安全漏洞，影响多个 MySQL 及其分支版本。利用方式通常涉及修改MySQL的配置文件，将 general_log_file 指向攻击者可控的文件，并在其中写入恶意配置，例如加载恶意动态链接库以执行任意代码。提供的Playbook 旨在通过添加安全检查来修补 `mysqld_safe` 脚本，防止从非标准系统目录加载 `ld_preload` 库。因此，此 Playbook 实际上是一个补丁，并非漏洞利用代码。Playbook 代码本身旨在修复漏洞，未发现隐藏的恶意代码，因此投毒风险为0%。根据漏洞信息和搜索结果，此漏洞影响广泛，需要尽快修复。

**项目地址:** [konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch](https://github.com/konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #8

**来源**: [CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md](../2016/CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md)

## CVE-2016-6662 - MySQL 远程 Root 代码执行/权限提升

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致数据库完全控制和服务器接管

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或 SQL 注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 选项到 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这个漏洞可以被利用来以 root 权限执行任意代码，通过设置 malloc_lib 选项指向恶意 .so 文件。此利用方式依赖于可以写入 MySQL 配置文件，并重启 MySQL 服务。 

**有效性：** 提供的 Ansible 脚本旨在修复此漏洞，而非利用它。它通过修改 mysqld_safe 脚本，限制 .so 文件的加载路径到标准系统目录，并检查默认配置文件的存在性和权限来缓解风险，因此提供的代码是用于防御而不是利用的。

**投毒风险：**  该仓库本身包含的是修复漏洞的脚本，直接投毒的可能性较低。但是，仍然存在以下风险：

1.  **脚本本身可能存在缺陷：**  虽然脚本旨在修复漏洞，但如果脚本本身存在逻辑错误或未考虑到的情况，可能会导致 MySQL 服务不稳定或其他问题。 
2.  **供应链攻击：**  该仓库可能被黑客入侵，然后植入恶意代码。由于脚本需要修改系统文件和重启服务，一旦被植入恶意代码，危害非常大。 
3.  **依赖关系：**  该脚本可能依赖其他软件包或库，这些依赖项可能存在漏洞。  
综合考虑，投毒风险评估为 10%。 这个百分比是因为代码主要是防御性的，并且已经经过了相当数量的安装验证，降低了直接恶意代码的可能性。但供应链风险和脚本缺陷始终存在。

**利用方式：**

1.  **利用条件：**  需要拥有对 MySQL 服务器的本地用户权限或者能够通过 SQL 注入漏洞执行命令。
2.  **写入恶意配置：**  利用权限，将 `general_log_file` 设置为指向包含恶意配置的文件的路径。恶意配置中，设置 `malloc_lib` 指向恶意的 .so 文件。
3.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意 .so 文件被加载，从而执行任意代码。

搜索结果也表明，可以通过 SQL 注入来利用这个漏洞，意味着攻击者不需要本地账户，可以通过SQL注入写入配置，然后利用此漏洞提权至root。


**项目地址:** [meersjo/ansible-mysql-cve-2016-6662](https://github.com/meersjo/ansible-mysql-cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---



---

## POC #4

**来源**: [CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md](../2016/CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 配置覆盖/本地权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，允许本地用户创建任意配置并绕过某些保护机制，最终导致以 root 权限执行任意代码

**影响版本:** MySQL through 5.5.52, 5.6.x through 5.6.33, and 5.7.x through 5.7.15; MariaDB before 5.5.51, 10.0.x before 10.0.27, and 10.1.x before 10.1.17; and Percona Server before 5.5.51-38.1, 5.6.x before 5.6.32-78.0, and 5.7.x before 5.7.14-7

**利用条件:** 需要具备对 MySQL 数据库一定的写入权限（如通过 SQL 注入）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 漏洞允许攻击者通过设置 `general_log_file` 到 `my.cnf` 配置文件来创建任意配置，从而绕过某些保护机制。更进一步，通过设置 `malloc_lib` 选项，可以加载恶意动态链接库，最终导致以 root 权限执行任意代码。

**利用方式：**

1.  **前提条件：** 攻击者需要通过某种方式（例如 SQL 注入）获取对 MySQL 数据库的写入权限。
2.  **写入恶意配置：**  攻击者利用 SQL 注入漏洞，将 `general_log_file` 设置为一个精心构造的 `my.cnf` 配置文件路径，该配置文件中包含恶意的 `malloc_lib` 选项。
3.  **上传恶意动态链接库：**  攻击者将包含恶意代码的动态链接库（`mysql_hookandroot_lib.so`）上传到服务器上的某个可写目录（如 `/var/lib/mysql/`）。
4.  **触发漏洞：**  攻击者通过触发 MySQL 的日志功能，使 MySQL 加载并解析恶意的 `my.cnf` 配置文件，从而加载恶意动态链接库。
5.  **代码执行：**  恶意动态链接库中的代码被执行，攻击者获得 root 权限。

**POC 代码分析：**

提供的 Python 脚本 `From SQL injection to root shell.py` 实现了上述利用流程：

*   `craft_payloads()` 函数生成用于利用漏洞的 SQL 注入 payload。
*   该函数首先创建恶意触发器，该触发器将恶意配置写入 `my.cnf` 文件。
*   然后，该函数将恶意动态链接库 `mysql_hookandroot_lib.so` 的内容写入服务器上的文件。
*   最后，该函数创建 `poctable` 表，并通过插入数据来触发恶意触发器，从而执行代码。

**有效性：**

根据漏洞描述和提供的 POC 代码，该漏洞利用方法是有效的，只要满足利用条件（例如可写权限和特定 MySQL 版本）。

**投毒风险：**

该 POC 代码的主要目的是利用漏洞，但存在一定的投毒风险。 虽然大部分代码是为了验证和利用漏洞，但攻击者可能会在 `mysql_hookandroot_lib.so` 中添加后门或其他恶意功能，从而在成功利用漏洞后保持对系统的长期访问。 这里的投毒风险评估为10%, 主要体现在`mysql_hookandroot_lib.so` 恶意动态链接库上，如果该链接库被替换成具有其他恶意功能的链接库，则可能造成危害。


**项目地址:** [MAYASEVEN/CVE-2016-6662](https://github.com/MAYASEVEN/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #5

**来源**: [CVE-2016-6662-boompig_cve-2016-6662.md](../2016/CVE-2016-6662-boompig_cve-2016-6662.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可导致数据库服务器完全控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 需要能够修改MySQL配置文件 (my.cnf) 并且目标服务器运行受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 选项为 `my.cnf` 配置文件，创建任意配置并绕过某些保护机制。 这可以被利用来执行具有 root 权限的任意代码，通过设置 `malloc_lib` 选项。提供的PoC代码 `0ldSQL_MySQL_RCE_exploit.py` 是一个有限的版本，仅允许附加到现有 MySQL 配置文件的末尾。完整利用需要目标my.cnf具有mysql用户可写的权限。利用方式如下：

1.  **编译恶意共享库 (mysql_hookandroot_lib.so):**  该库包含恶意代码，用于提权和执行命令。
2.  **将恶意库转换为十六进制:** 将编译好的共享库内容转换为十六进制字符串。
3.  **利用SQL注入或其它方式修改my.cnf:**  将`malloc_lib`设置为恶意共享库的路径，并将`general_log_file`设置为`my.cnf`。需要具有FILE权限。
4.  **重启 MySQL 服务:**  重启后，MySQL将加载恶意共享库，执行其中的代码，从而获得 root 权限。

**投毒风险分析:**

该PoC代码的投毒风险较低 (10%)。PoC本身的功能是演示如何利用漏洞，并包含编译shellcode等必要步骤。然而，不排除作者在编译恶意库的过程中可能隐藏恶意代码的可能性。因此，在使用该PoC时，务必仔细审查代码，特别是 `mysql_hookandroot_lib.c` 文件，并进行代码审计以确保其安全性。

搜索引擎结果表明，该漏洞影响广泛，多个厂商的MySQL发行版都受影响。修复方案包括升级到最新版本或应用厂商提供的补丁。

**项目地址:** [boompig/cve-2016-6662](https://github.com/boompig/cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #6

**来源**: [CVE-2016-6662-kanyaars_CVE-2016-6662.md](../2016/CVE-2016-6662-kanyaars_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户或具有FILE权限的远程用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户（或具有FILE权限的远程用户）通过设置 `general_log_file` 到 `my.cnf` 配置来创建任意配置和绕过某些保护机制。更严重的是，这可以被利用通过设置 `malloc_lib` 来执行具有 root 权限的任意代码。

**利用方式：**

1.  **写入恶意配置：** 攻击者利用数据库的FILE权限，将`general_log_file`指向一个攻击者可控的文件。这个文件会被解析为MySQL的配置文件。
2.  **设置malloc_lib：** 在该配置文件中，攻击者设置`malloc_lib`指向一个恶意的动态链接库（.so文件）。
3.  **重启MySQL服务：** 当MySQL服务重启时，会加载`malloc_lib`指定的恶意动态链接库，从而执行攻击者预设的恶意代码，获得服务器的root权限。

**POC分析：**
提供的POC代码包含两个文件：一个C语言编写的动态链接库 (`911KanyaLab_lib.c`) 和一个 Python 脚本 (`Exploit_Old_MySQL_Kay_ver.py`)。

*   **`911KanyaLab_lib.c`：** 这个C代码会被编译成`.so`文件。它定义了一个`execvp` hook函数，用于在MySQL启动时执行恶意代码。恶意代码的功能是创建一个反向Shell，连接到攻击者的IP地址和端口。
*   **`Exploit_Old_MySQL_Kay_ver.py`：** 这个Python脚本负责连接到目标MySQL服务器，上传并配置恶意的`.so`文件，并触发MySQL重启。

**投毒风险分析：**
代码主要逻辑是创建反向shell，连接攻击者的机器。存在投毒的可能。分析得出存在以下潜在的投毒风险:
*   C代码中IP地址和端口是硬编码的，如果攻击者篡改这些值，可能会将shell连接到其他恶意服务器。但是从代码逻辑来判断是为了完成漏洞验证的必要后门代码。
*   Python脚本需要指定MySQL用户名、密码、数据库名和`my.cnf`路径，这些信息可能被记录或泄露。
*   `config_cleanup()`函数的功能是清除注入的配置，但如果实现不正确，可能留下痕迹。

整体代码质量不高，存在一些硬编码，但主要功能符合漏洞描述，总体上是可信的。 但是依然存在作者隐藏的投毒代码的可能，但是可能性较低。

**项目地址:** [kanyaars/CVE-2016-6662](https://github.com/kanyaars/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #7

**来源**: [CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md](../2016/CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md)

## CVE-2016-6662 - MySQL/MariaDB/PerconaDB 权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** MySQL: <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB: < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server: < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这可以被利用来通过设置 malloc_lib 以 root 权限执行任意代码。根据搜索结果，这是一个严重的安全漏洞，影响多个 MySQL 及其分支版本。利用方式通常涉及修改MySQL的配置文件，将 general_log_file 指向攻击者可控的文件，并在其中写入恶意配置，例如加载恶意动态链接库以执行任意代码。提供的Playbook 旨在通过添加安全检查来修补 `mysqld_safe` 脚本，防止从非标准系统目录加载 `ld_preload` 库。因此，此 Playbook 实际上是一个补丁，并非漏洞利用代码。Playbook 代码本身旨在修复漏洞，未发现隐藏的恶意代码，因此投毒风险为0%。根据漏洞信息和搜索结果，此漏洞影响广泛，需要尽快修复。

**项目地址:** [konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch](https://github.com/konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #8

**来源**: [CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md](../2016/CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md)

## CVE-2016-6662 - MySQL 远程 Root 代码执行/权限提升

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致数据库完全控制和服务器接管

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或 SQL 注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 选项到 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这个漏洞可以被利用来以 root 权限执行任意代码，通过设置 malloc_lib 选项指向恶意 .so 文件。此利用方式依赖于可以写入 MySQL 配置文件，并重启 MySQL 服务。 

**有效性：** 提供的 Ansible 脚本旨在修复此漏洞，而非利用它。它通过修改 mysqld_safe 脚本，限制 .so 文件的加载路径到标准系统目录，并检查默认配置文件的存在性和权限来缓解风险，因此提供的代码是用于防御而不是利用的。

**投毒风险：**  该仓库本身包含的是修复漏洞的脚本，直接投毒的可能性较低。但是，仍然存在以下风险：

1.  **脚本本身可能存在缺陷：**  虽然脚本旨在修复漏洞，但如果脚本本身存在逻辑错误或未考虑到的情况，可能会导致 MySQL 服务不稳定或其他问题。 
2.  **供应链攻击：**  该仓库可能被黑客入侵，然后植入恶意代码。由于脚本需要修改系统文件和重启服务，一旦被植入恶意代码，危害非常大。 
3.  **依赖关系：**  该脚本可能依赖其他软件包或库，这些依赖项可能存在漏洞。  
综合考虑，投毒风险评估为 10%。 这个百分比是因为代码主要是防御性的，并且已经经过了相当数量的安装验证，降低了直接恶意代码的可能性。但供应链风险和脚本缺陷始终存在。

**利用方式：**

1.  **利用条件：**  需要拥有对 MySQL 服务器的本地用户权限或者能够通过 SQL 注入漏洞执行命令。
2.  **写入恶意配置：**  利用权限，将 `general_log_file` 设置为指向包含恶意配置的文件的路径。恶意配置中，设置 `malloc_lib` 指向恶意的 .so 文件。
3.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意 .so 文件被加载，从而执行任意代码。

搜索结果也表明，可以通过 SQL 注入来利用这个漏洞，意味着攻击者不需要本地账户，可以通过SQL注入写入配置，然后利用此漏洞提权至root。


**项目地址:** [meersjo/ansible-mysql-cve-2016-6662](https://github.com/meersjo/ansible-mysql-cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---



---

## POC #4

**来源**: [CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md](../2016/CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 配置覆盖/本地权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，允许本地用户创建任意配置并绕过某些保护机制，最终导致以 root 权限执行任意代码

**影响版本:** MySQL through 5.5.52, 5.6.x through 5.6.33, and 5.7.x through 5.7.15; MariaDB before 5.5.51, 10.0.x before 10.0.27, and 10.1.x before 10.1.17; and Percona Server before 5.5.51-38.1, 5.6.x before 5.6.32-78.0, and 5.7.x before 5.7.14-7

**利用条件:** 需要具备对 MySQL 数据库一定的写入权限（如通过 SQL 注入）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 漏洞允许攻击者通过设置 `general_log_file` 到 `my.cnf` 配置文件来创建任意配置，从而绕过某些保护机制。更进一步，通过设置 `malloc_lib` 选项，可以加载恶意动态链接库，最终导致以 root 权限执行任意代码。

**利用方式：**

1.  **前提条件：** 攻击者需要通过某种方式（例如 SQL 注入）获取对 MySQL 数据库的写入权限。
2.  **写入恶意配置：**  攻击者利用 SQL 注入漏洞，将 `general_log_file` 设置为一个精心构造的 `my.cnf` 配置文件路径，该配置文件中包含恶意的 `malloc_lib` 选项。
3.  **上传恶意动态链接库：**  攻击者将包含恶意代码的动态链接库（`mysql_hookandroot_lib.so`）上传到服务器上的某个可写目录（如 `/var/lib/mysql/`）。
4.  **触发漏洞：**  攻击者通过触发 MySQL 的日志功能，使 MySQL 加载并解析恶意的 `my.cnf` 配置文件，从而加载恶意动态链接库。
5.  **代码执行：**  恶意动态链接库中的代码被执行，攻击者获得 root 权限。

**POC 代码分析：**

提供的 Python 脚本 `From SQL injection to root shell.py` 实现了上述利用流程：

*   `craft_payloads()` 函数生成用于利用漏洞的 SQL 注入 payload。
*   该函数首先创建恶意触发器，该触发器将恶意配置写入 `my.cnf` 文件。
*   然后，该函数将恶意动态链接库 `mysql_hookandroot_lib.so` 的内容写入服务器上的文件。
*   最后，该函数创建 `poctable` 表，并通过插入数据来触发恶意触发器，从而执行代码。

**有效性：**

根据漏洞描述和提供的 POC 代码，该漏洞利用方法是有效的，只要满足利用条件（例如可写权限和特定 MySQL 版本）。

**投毒风险：**

该 POC 代码的主要目的是利用漏洞，但存在一定的投毒风险。 虽然大部分代码是为了验证和利用漏洞，但攻击者可能会在 `mysql_hookandroot_lib.so` 中添加后门或其他恶意功能，从而在成功利用漏洞后保持对系统的长期访问。 这里的投毒风险评估为10%, 主要体现在`mysql_hookandroot_lib.so` 恶意动态链接库上，如果该链接库被替换成具有其他恶意功能的链接库，则可能造成危害。


**项目地址:** [MAYASEVEN/CVE-2016-6662](https://github.com/MAYASEVEN/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #5

**来源**: [CVE-2016-6662-boompig_cve-2016-6662.md](../2016/CVE-2016-6662-boompig_cve-2016-6662.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可导致数据库服务器完全控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 需要能够修改MySQL配置文件 (my.cnf) 并且目标服务器运行受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 选项为 `my.cnf` 配置文件，创建任意配置并绕过某些保护机制。 这可以被利用来执行具有 root 权限的任意代码，通过设置 `malloc_lib` 选项。提供的PoC代码 `0ldSQL_MySQL_RCE_exploit.py` 是一个有限的版本，仅允许附加到现有 MySQL 配置文件的末尾。完整利用需要目标my.cnf具有mysql用户可写的权限。利用方式如下：

1.  **编译恶意共享库 (mysql_hookandroot_lib.so):**  该库包含恶意代码，用于提权和执行命令。
2.  **将恶意库转换为十六进制:** 将编译好的共享库内容转换为十六进制字符串。
3.  **利用SQL注入或其它方式修改my.cnf:**  将`malloc_lib`设置为恶意共享库的路径，并将`general_log_file`设置为`my.cnf`。需要具有FILE权限。
4.  **重启 MySQL 服务:**  重启后，MySQL将加载恶意共享库，执行其中的代码，从而获得 root 权限。

**投毒风险分析:**

该PoC代码的投毒风险较低 (10%)。PoC本身的功能是演示如何利用漏洞，并包含编译shellcode等必要步骤。然而，不排除作者在编译恶意库的过程中可能隐藏恶意代码的可能性。因此，在使用该PoC时，务必仔细审查代码，特别是 `mysql_hookandroot_lib.c` 文件，并进行代码审计以确保其安全性。

搜索引擎结果表明，该漏洞影响广泛，多个厂商的MySQL发行版都受影响。修复方案包括升级到最新版本或应用厂商提供的补丁。

**项目地址:** [boompig/cve-2016-6662](https://github.com/boompig/cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #6

**来源**: [CVE-2016-6662-kanyaars_CVE-2016-6662.md](../2016/CVE-2016-6662-kanyaars_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户或具有FILE权限的远程用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户（或具有FILE权限的远程用户）通过设置 `general_log_file` 到 `my.cnf` 配置来创建任意配置和绕过某些保护机制。更严重的是，这可以被利用通过设置 `malloc_lib` 来执行具有 root 权限的任意代码。

**利用方式：**

1.  **写入恶意配置：** 攻击者利用数据库的FILE权限，将`general_log_file`指向一个攻击者可控的文件。这个文件会被解析为MySQL的配置文件。
2.  **设置malloc_lib：** 在该配置文件中，攻击者设置`malloc_lib`指向一个恶意的动态链接库（.so文件）。
3.  **重启MySQL服务：** 当MySQL服务重启时，会加载`malloc_lib`指定的恶意动态链接库，从而执行攻击者预设的恶意代码，获得服务器的root权限。

**POC分析：**
提供的POC代码包含两个文件：一个C语言编写的动态链接库 (`911KanyaLab_lib.c`) 和一个 Python 脚本 (`Exploit_Old_MySQL_Kay_ver.py`)。

*   **`911KanyaLab_lib.c`：** 这个C代码会被编译成`.so`文件。它定义了一个`execvp` hook函数，用于在MySQL启动时执行恶意代码。恶意代码的功能是创建一个反向Shell，连接到攻击者的IP地址和端口。
*   **`Exploit_Old_MySQL_Kay_ver.py`：** 这个Python脚本负责连接到目标MySQL服务器，上传并配置恶意的`.so`文件，并触发MySQL重启。

**投毒风险分析：**
代码主要逻辑是创建反向shell，连接攻击者的机器。存在投毒的可能。分析得出存在以下潜在的投毒风险:
*   C代码中IP地址和端口是硬编码的，如果攻击者篡改这些值，可能会将shell连接到其他恶意服务器。但是从代码逻辑来判断是为了完成漏洞验证的必要后门代码。
*   Python脚本需要指定MySQL用户名、密码、数据库名和`my.cnf`路径，这些信息可能被记录或泄露。
*   `config_cleanup()`函数的功能是清除注入的配置，但如果实现不正确，可能留下痕迹。

整体代码质量不高，存在一些硬编码，但主要功能符合漏洞描述，总体上是可信的。 但是依然存在作者隐藏的投毒代码的可能，但是可能性较低。

**项目地址:** [kanyaars/CVE-2016-6662](https://github.com/kanyaars/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #7

**来源**: [CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md](../2016/CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md)

## CVE-2016-6662 - MySQL/MariaDB/PerconaDB 权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** MySQL: <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB: < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server: < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这可以被利用来通过设置 malloc_lib 以 root 权限执行任意代码。根据搜索结果，这是一个严重的安全漏洞，影响多个 MySQL 及其分支版本。利用方式通常涉及修改MySQL的配置文件，将 general_log_file 指向攻击者可控的文件，并在其中写入恶意配置，例如加载恶意动态链接库以执行任意代码。提供的Playbook 旨在通过添加安全检查来修补 `mysqld_safe` 脚本，防止从非标准系统目录加载 `ld_preload` 库。因此，此 Playbook 实际上是一个补丁，并非漏洞利用代码。Playbook 代码本身旨在修复漏洞，未发现隐藏的恶意代码，因此投毒风险为0%。根据漏洞信息和搜索结果，此漏洞影响广泛，需要尽快修复。

**项目地址:** [konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch](https://github.com/konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #8

**来源**: [CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md](../2016/CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md)

## CVE-2016-6662 - MySQL 远程 Root 代码执行/权限提升

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致数据库完全控制和服务器接管

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或 SQL 注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 选项到 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这个漏洞可以被利用来以 root 权限执行任意代码，通过设置 malloc_lib 选项指向恶意 .so 文件。此利用方式依赖于可以写入 MySQL 配置文件，并重启 MySQL 服务。 

**有效性：** 提供的 Ansible 脚本旨在修复此漏洞，而非利用它。它通过修改 mysqld_safe 脚本，限制 .so 文件的加载路径到标准系统目录，并检查默认配置文件的存在性和权限来缓解风险，因此提供的代码是用于防御而不是利用的。

**投毒风险：**  该仓库本身包含的是修复漏洞的脚本，直接投毒的可能性较低。但是，仍然存在以下风险：

1.  **脚本本身可能存在缺陷：**  虽然脚本旨在修复漏洞，但如果脚本本身存在逻辑错误或未考虑到的情况，可能会导致 MySQL 服务不稳定或其他问题。 
2.  **供应链攻击：**  该仓库可能被黑客入侵，然后植入恶意代码。由于脚本需要修改系统文件和重启服务，一旦被植入恶意代码，危害非常大。 
3.  **依赖关系：**  该脚本可能依赖其他软件包或库，这些依赖项可能存在漏洞。  
综合考虑，投毒风险评估为 10%。 这个百分比是因为代码主要是防御性的，并且已经经过了相当数量的安装验证，降低了直接恶意代码的可能性。但供应链风险和脚本缺陷始终存在。

**利用方式：**

1.  **利用条件：**  需要拥有对 MySQL 服务器的本地用户权限或者能够通过 SQL 注入漏洞执行命令。
2.  **写入恶意配置：**  利用权限，将 `general_log_file` 设置为指向包含恶意配置的文件的路径。恶意配置中，设置 `malloc_lib` 指向恶意的 .so 文件。
3.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意 .so 文件被加载，从而执行任意代码。

搜索结果也表明，可以通过 SQL 注入来利用这个漏洞，意味着攻击者不需要本地账户，可以通过SQL注入写入配置，然后利用此漏洞提权至root。


**项目地址:** [meersjo/ansible-mysql-cve-2016-6662](https://github.com/meersjo/ansible-mysql-cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---



---

## POC #4

**来源**: [CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md](../2016/CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 配置覆盖/本地权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，允许本地用户创建任意配置并绕过某些保护机制，最终导致以 root 权限执行任意代码

**影响版本:** MySQL through 5.5.52, 5.6.x through 5.6.33, and 5.7.x through 5.7.15; MariaDB before 5.5.51, 10.0.x before 10.0.27, and 10.1.x before 10.1.17; and Percona Server before 5.5.51-38.1, 5.6.x before 5.6.32-78.0, and 5.7.x before 5.7.14-7

**利用条件:** 需要具备对 MySQL 数据库一定的写入权限（如通过 SQL 注入）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 漏洞允许攻击者通过设置 `general_log_file` 到 `my.cnf` 配置文件来创建任意配置，从而绕过某些保护机制。更进一步，通过设置 `malloc_lib` 选项，可以加载恶意动态链接库，最终导致以 root 权限执行任意代码。

**利用方式：**

1.  **前提条件：** 攻击者需要通过某种方式（例如 SQL 注入）获取对 MySQL 数据库的写入权限。
2.  **写入恶意配置：**  攻击者利用 SQL 注入漏洞，将 `general_log_file` 设置为一个精心构造的 `my.cnf` 配置文件路径，该配置文件中包含恶意的 `malloc_lib` 选项。
3.  **上传恶意动态链接库：**  攻击者将包含恶意代码的动态链接库（`mysql_hookandroot_lib.so`）上传到服务器上的某个可写目录（如 `/var/lib/mysql/`）。
4.  **触发漏洞：**  攻击者通过触发 MySQL 的日志功能，使 MySQL 加载并解析恶意的 `my.cnf` 配置文件，从而加载恶意动态链接库。
5.  **代码执行：**  恶意动态链接库中的代码被执行，攻击者获得 root 权限。

**POC 代码分析：**

提供的 Python 脚本 `From SQL injection to root shell.py` 实现了上述利用流程：

*   `craft_payloads()` 函数生成用于利用漏洞的 SQL 注入 payload。
*   该函数首先创建恶意触发器，该触发器将恶意配置写入 `my.cnf` 文件。
*   然后，该函数将恶意动态链接库 `mysql_hookandroot_lib.so` 的内容写入服务器上的文件。
*   最后，该函数创建 `poctable` 表，并通过插入数据来触发恶意触发器，从而执行代码。

**有效性：**

根据漏洞描述和提供的 POC 代码，该漏洞利用方法是有效的，只要满足利用条件（例如可写权限和特定 MySQL 版本）。

**投毒风险：**

该 POC 代码的主要目的是利用漏洞，但存在一定的投毒风险。 虽然大部分代码是为了验证和利用漏洞，但攻击者可能会在 `mysql_hookandroot_lib.so` 中添加后门或其他恶意功能，从而在成功利用漏洞后保持对系统的长期访问。 这里的投毒风险评估为10%, 主要体现在`mysql_hookandroot_lib.so` 恶意动态链接库上，如果该链接库被替换成具有其他恶意功能的链接库，则可能造成危害。


**项目地址:** [MAYASEVEN/CVE-2016-6662](https://github.com/MAYASEVEN/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #5

**来源**: [CVE-2016-6662-boompig_cve-2016-6662.md](../2016/CVE-2016-6662-boompig_cve-2016-6662.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可导致数据库服务器完全控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 需要能够修改MySQL配置文件 (my.cnf) 并且目标服务器运行受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 选项为 `my.cnf` 配置文件，创建任意配置并绕过某些保护机制。 这可以被利用来执行具有 root 权限的任意代码，通过设置 `malloc_lib` 选项。提供的PoC代码 `0ldSQL_MySQL_RCE_exploit.py` 是一个有限的版本，仅允许附加到现有 MySQL 配置文件的末尾。完整利用需要目标my.cnf具有mysql用户可写的权限。利用方式如下：

1.  **编译恶意共享库 (mysql_hookandroot_lib.so):**  该库包含恶意代码，用于提权和执行命令。
2.  **将恶意库转换为十六进制:** 将编译好的共享库内容转换为十六进制字符串。
3.  **利用SQL注入或其它方式修改my.cnf:**  将`malloc_lib`设置为恶意共享库的路径，并将`general_log_file`设置为`my.cnf`。需要具有FILE权限。
4.  **重启 MySQL 服务:**  重启后，MySQL将加载恶意共享库，执行其中的代码，从而获得 root 权限。

**投毒风险分析:**

该PoC代码的投毒风险较低 (10%)。PoC本身的功能是演示如何利用漏洞，并包含编译shellcode等必要步骤。然而，不排除作者在编译恶意库的过程中可能隐藏恶意代码的可能性。因此，在使用该PoC时，务必仔细审查代码，特别是 `mysql_hookandroot_lib.c` 文件，并进行代码审计以确保其安全性。

搜索引擎结果表明，该漏洞影响广泛，多个厂商的MySQL发行版都受影响。修复方案包括升级到最新版本或应用厂商提供的补丁。

**项目地址:** [boompig/cve-2016-6662](https://github.com/boompig/cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #6

**来源**: [CVE-2016-6662-kanyaars_CVE-2016-6662.md](../2016/CVE-2016-6662-kanyaars_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户或具有FILE权限的远程用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户（或具有FILE权限的远程用户）通过设置 `general_log_file` 到 `my.cnf` 配置来创建任意配置和绕过某些保护机制。更严重的是，这可以被利用通过设置 `malloc_lib` 来执行具有 root 权限的任意代码。

**利用方式：**

1.  **写入恶意配置：** 攻击者利用数据库的FILE权限，将`general_log_file`指向一个攻击者可控的文件。这个文件会被解析为MySQL的配置文件。
2.  **设置malloc_lib：** 在该配置文件中，攻击者设置`malloc_lib`指向一个恶意的动态链接库（.so文件）。
3.  **重启MySQL服务：** 当MySQL服务重启时，会加载`malloc_lib`指定的恶意动态链接库，从而执行攻击者预设的恶意代码，获得服务器的root权限。

**POC分析：**
提供的POC代码包含两个文件：一个C语言编写的动态链接库 (`911KanyaLab_lib.c`) 和一个 Python 脚本 (`Exploit_Old_MySQL_Kay_ver.py`)。

*   **`911KanyaLab_lib.c`：** 这个C代码会被编译成`.so`文件。它定义了一个`execvp` hook函数，用于在MySQL启动时执行恶意代码。恶意代码的功能是创建一个反向Shell，连接到攻击者的IP地址和端口。
*   **`Exploit_Old_MySQL_Kay_ver.py`：** 这个Python脚本负责连接到目标MySQL服务器，上传并配置恶意的`.so`文件，并触发MySQL重启。

**投毒风险分析：**
代码主要逻辑是创建反向shell，连接攻击者的机器。存在投毒的可能。分析得出存在以下潜在的投毒风险:
*   C代码中IP地址和端口是硬编码的，如果攻击者篡改这些值，可能会将shell连接到其他恶意服务器。但是从代码逻辑来判断是为了完成漏洞验证的必要后门代码。
*   Python脚本需要指定MySQL用户名、密码、数据库名和`my.cnf`路径，这些信息可能被记录或泄露。
*   `config_cleanup()`函数的功能是清除注入的配置，但如果实现不正确，可能留下痕迹。

整体代码质量不高，存在一些硬编码，但主要功能符合漏洞描述，总体上是可信的。 但是依然存在作者隐藏的投毒代码的可能，但是可能性较低。

**项目地址:** [kanyaars/CVE-2016-6662](https://github.com/kanyaars/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #7

**来源**: [CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md](../2016/CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md)

## CVE-2016-6662 - MySQL/MariaDB/PerconaDB 权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** MySQL: <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB: < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server: < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这可以被利用来通过设置 malloc_lib 以 root 权限执行任意代码。根据搜索结果，这是一个严重的安全漏洞，影响多个 MySQL 及其分支版本。利用方式通常涉及修改MySQL的配置文件，将 general_log_file 指向攻击者可控的文件，并在其中写入恶意配置，例如加载恶意动态链接库以执行任意代码。提供的Playbook 旨在通过添加安全检查来修补 `mysqld_safe` 脚本，防止从非标准系统目录加载 `ld_preload` 库。因此，此 Playbook 实际上是一个补丁，并非漏洞利用代码。Playbook 代码本身旨在修复漏洞，未发现隐藏的恶意代码，因此投毒风险为0%。根据漏洞信息和搜索结果，此漏洞影响广泛，需要尽快修复。

**项目地址:** [konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch](https://github.com/konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #8

**来源**: [CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md](../2016/CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md)

## CVE-2016-6662 - MySQL 远程 Root 代码执行/权限提升

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致数据库完全控制和服务器接管

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或 SQL 注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 选项到 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这个漏洞可以被利用来以 root 权限执行任意代码，通过设置 malloc_lib 选项指向恶意 .so 文件。此利用方式依赖于可以写入 MySQL 配置文件，并重启 MySQL 服务。 

**有效性：** 提供的 Ansible 脚本旨在修复此漏洞，而非利用它。它通过修改 mysqld_safe 脚本，限制 .so 文件的加载路径到标准系统目录，并检查默认配置文件的存在性和权限来缓解风险，因此提供的代码是用于防御而不是利用的。

**投毒风险：**  该仓库本身包含的是修复漏洞的脚本，直接投毒的可能性较低。但是，仍然存在以下风险：

1.  **脚本本身可能存在缺陷：**  虽然脚本旨在修复漏洞，但如果脚本本身存在逻辑错误或未考虑到的情况，可能会导致 MySQL 服务不稳定或其他问题。 
2.  **供应链攻击：**  该仓库可能被黑客入侵，然后植入恶意代码。由于脚本需要修改系统文件和重启服务，一旦被植入恶意代码，危害非常大。 
3.  **依赖关系：**  该脚本可能依赖其他软件包或库，这些依赖项可能存在漏洞。  
综合考虑，投毒风险评估为 10%。 这个百分比是因为代码主要是防御性的，并且已经经过了相当数量的安装验证，降低了直接恶意代码的可能性。但供应链风险和脚本缺陷始终存在。

**利用方式：**

1.  **利用条件：**  需要拥有对 MySQL 服务器的本地用户权限或者能够通过 SQL 注入漏洞执行命令。
2.  **写入恶意配置：**  利用权限，将 `general_log_file` 设置为指向包含恶意配置的文件的路径。恶意配置中，设置 `malloc_lib` 指向恶意的 .so 文件。
3.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意 .so 文件被加载，从而执行任意代码。

搜索结果也表明，可以通过 SQL 注入来利用这个漏洞，意味着攻击者不需要本地账户，可以通过SQL注入写入配置，然后利用此漏洞提权至root。


**项目地址:** [meersjo/ansible-mysql-cve-2016-6662](https://github.com/meersjo/ansible-mysql-cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---



---

## POC #4

**来源**: [CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md](../2016/CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 配置覆盖/本地权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，允许本地用户创建任意配置并绕过某些保护机制，最终导致以 root 权限执行任意代码

**影响版本:** MySQL through 5.5.52, 5.6.x through 5.6.33, and 5.7.x through 5.7.15; MariaDB before 5.5.51, 10.0.x before 10.0.27, and 10.1.x before 10.1.17; and Percona Server before 5.5.51-38.1, 5.6.x before 5.6.32-78.0, and 5.7.x before 5.7.14-7

**利用条件:** 需要具备对 MySQL 数据库一定的写入权限（如通过 SQL 注入）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 漏洞允许攻击者通过设置 `general_log_file` 到 `my.cnf` 配置文件来创建任意配置，从而绕过某些保护机制。更进一步，通过设置 `malloc_lib` 选项，可以加载恶意动态链接库，最终导致以 root 权限执行任意代码。

**利用方式：**

1.  **前提条件：** 攻击者需要通过某种方式（例如 SQL 注入）获取对 MySQL 数据库的写入权限。
2.  **写入恶意配置：**  攻击者利用 SQL 注入漏洞，将 `general_log_file` 设置为一个精心构造的 `my.cnf` 配置文件路径，该配置文件中包含恶意的 `malloc_lib` 选项。
3.  **上传恶意动态链接库：**  攻击者将包含恶意代码的动态链接库（`mysql_hookandroot_lib.so`）上传到服务器上的某个可写目录（如 `/var/lib/mysql/`）。
4.  **触发漏洞：**  攻击者通过触发 MySQL 的日志功能，使 MySQL 加载并解析恶意的 `my.cnf` 配置文件，从而加载恶意动态链接库。
5.  **代码执行：**  恶意动态链接库中的代码被执行，攻击者获得 root 权限。

**POC 代码分析：**

提供的 Python 脚本 `From SQL injection to root shell.py` 实现了上述利用流程：

*   `craft_payloads()` 函数生成用于利用漏洞的 SQL 注入 payload。
*   该函数首先创建恶意触发器，该触发器将恶意配置写入 `my.cnf` 文件。
*   然后，该函数将恶意动态链接库 `mysql_hookandroot_lib.so` 的内容写入服务器上的文件。
*   最后，该函数创建 `poctable` 表，并通过插入数据来触发恶意触发器，从而执行代码。

**有效性：**

根据漏洞描述和提供的 POC 代码，该漏洞利用方法是有效的，只要满足利用条件（例如可写权限和特定 MySQL 版本）。

**投毒风险：**

该 POC 代码的主要目的是利用漏洞，但存在一定的投毒风险。 虽然大部分代码是为了验证和利用漏洞，但攻击者可能会在 `mysql_hookandroot_lib.so` 中添加后门或其他恶意功能，从而在成功利用漏洞后保持对系统的长期访问。 这里的投毒风险评估为10%, 主要体现在`mysql_hookandroot_lib.so` 恶意动态链接库上，如果该链接库被替换成具有其他恶意功能的链接库，则可能造成危害。


**项目地址:** [MAYASEVEN/CVE-2016-6662](https://github.com/MAYASEVEN/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #5

**来源**: [CVE-2016-6662-boompig_cve-2016-6662.md](../2016/CVE-2016-6662-boompig_cve-2016-6662.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可导致数据库服务器完全控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 需要能够修改MySQL配置文件 (my.cnf) 并且目标服务器运行受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 选项为 `my.cnf` 配置文件，创建任意配置并绕过某些保护机制。 这可以被利用来执行具有 root 权限的任意代码，通过设置 `malloc_lib` 选项。提供的PoC代码 `0ldSQL_MySQL_RCE_exploit.py` 是一个有限的版本，仅允许附加到现有 MySQL 配置文件的末尾。完整利用需要目标my.cnf具有mysql用户可写的权限。利用方式如下：

1.  **编译恶意共享库 (mysql_hookandroot_lib.so):**  该库包含恶意代码，用于提权和执行命令。
2.  **将恶意库转换为十六进制:** 将编译好的共享库内容转换为十六进制字符串。
3.  **利用SQL注入或其它方式修改my.cnf:**  将`malloc_lib`设置为恶意共享库的路径，并将`general_log_file`设置为`my.cnf`。需要具有FILE权限。
4.  **重启 MySQL 服务:**  重启后，MySQL将加载恶意共享库，执行其中的代码，从而获得 root 权限。

**投毒风险分析:**

该PoC代码的投毒风险较低 (10%)。PoC本身的功能是演示如何利用漏洞，并包含编译shellcode等必要步骤。然而，不排除作者在编译恶意库的过程中可能隐藏恶意代码的可能性。因此，在使用该PoC时，务必仔细审查代码，特别是 `mysql_hookandroot_lib.c` 文件，并进行代码审计以确保其安全性。

搜索引擎结果表明，该漏洞影响广泛，多个厂商的MySQL发行版都受影响。修复方案包括升级到最新版本或应用厂商提供的补丁。

**项目地址:** [boompig/cve-2016-6662](https://github.com/boompig/cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #6

**来源**: [CVE-2016-6662-kanyaars_CVE-2016-6662.md](../2016/CVE-2016-6662-kanyaars_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户或具有FILE权限的远程用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户（或具有FILE权限的远程用户）通过设置 `general_log_file` 到 `my.cnf` 配置来创建任意配置和绕过某些保护机制。更严重的是，这可以被利用通过设置 `malloc_lib` 来执行具有 root 权限的任意代码。

**利用方式：**

1.  **写入恶意配置：** 攻击者利用数据库的FILE权限，将`general_log_file`指向一个攻击者可控的文件。这个文件会被解析为MySQL的配置文件。
2.  **设置malloc_lib：** 在该配置文件中，攻击者设置`malloc_lib`指向一个恶意的动态链接库（.so文件）。
3.  **重启MySQL服务：** 当MySQL服务重启时，会加载`malloc_lib`指定的恶意动态链接库，从而执行攻击者预设的恶意代码，获得服务器的root权限。

**POC分析：**
提供的POC代码包含两个文件：一个C语言编写的动态链接库 (`911KanyaLab_lib.c`) 和一个 Python 脚本 (`Exploit_Old_MySQL_Kay_ver.py`)。

*   **`911KanyaLab_lib.c`：** 这个C代码会被编译成`.so`文件。它定义了一个`execvp` hook函数，用于在MySQL启动时执行恶意代码。恶意代码的功能是创建一个反向Shell，连接到攻击者的IP地址和端口。
*   **`Exploit_Old_MySQL_Kay_ver.py`：** 这个Python脚本负责连接到目标MySQL服务器，上传并配置恶意的`.so`文件，并触发MySQL重启。

**投毒风险分析：**
代码主要逻辑是创建反向shell，连接攻击者的机器。存在投毒的可能。分析得出存在以下潜在的投毒风险:
*   C代码中IP地址和端口是硬编码的，如果攻击者篡改这些值，可能会将shell连接到其他恶意服务器。但是从代码逻辑来判断是为了完成漏洞验证的必要后门代码。
*   Python脚本需要指定MySQL用户名、密码、数据库名和`my.cnf`路径，这些信息可能被记录或泄露。
*   `config_cleanup()`函数的功能是清除注入的配置，但如果实现不正确，可能留下痕迹。

整体代码质量不高，存在一些硬编码，但主要功能符合漏洞描述，总体上是可信的。 但是依然存在作者隐藏的投毒代码的可能，但是可能性较低。

**项目地址:** [kanyaars/CVE-2016-6662](https://github.com/kanyaars/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #7

**来源**: [CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md](../2016/CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md)

## CVE-2016-6662 - MySQL/MariaDB/PerconaDB 权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** MySQL: <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB: < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server: < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这可以被利用来通过设置 malloc_lib 以 root 权限执行任意代码。根据搜索结果，这是一个严重的安全漏洞，影响多个 MySQL 及其分支版本。利用方式通常涉及修改MySQL的配置文件，将 general_log_file 指向攻击者可控的文件，并在其中写入恶意配置，例如加载恶意动态链接库以执行任意代码。提供的Playbook 旨在通过添加安全检查来修补 `mysqld_safe` 脚本，防止从非标准系统目录加载 `ld_preload` 库。因此，此 Playbook 实际上是一个补丁，并非漏洞利用代码。Playbook 代码本身旨在修复漏洞，未发现隐藏的恶意代码，因此投毒风险为0%。根据漏洞信息和搜索结果，此漏洞影响广泛，需要尽快修复。

**项目地址:** [konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch](https://github.com/konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #8

**来源**: [CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md](../2016/CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md)

## CVE-2016-6662 - MySQL 远程 Root 代码执行/权限提升

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致数据库完全控制和服务器接管

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或 SQL 注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 选项到 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这个漏洞可以被利用来以 root 权限执行任意代码，通过设置 malloc_lib 选项指向恶意 .so 文件。此利用方式依赖于可以写入 MySQL 配置文件，并重启 MySQL 服务。 

**有效性：** 提供的 Ansible 脚本旨在修复此漏洞，而非利用它。它通过修改 mysqld_safe 脚本，限制 .so 文件的加载路径到标准系统目录，并检查默认配置文件的存在性和权限来缓解风险，因此提供的代码是用于防御而不是利用的。

**投毒风险：**  该仓库本身包含的是修复漏洞的脚本，直接投毒的可能性较低。但是，仍然存在以下风险：

1.  **脚本本身可能存在缺陷：**  虽然脚本旨在修复漏洞，但如果脚本本身存在逻辑错误或未考虑到的情况，可能会导致 MySQL 服务不稳定或其他问题。 
2.  **供应链攻击：**  该仓库可能被黑客入侵，然后植入恶意代码。由于脚本需要修改系统文件和重启服务，一旦被植入恶意代码，危害非常大。 
3.  **依赖关系：**  该脚本可能依赖其他软件包或库，这些依赖项可能存在漏洞。  
综合考虑，投毒风险评估为 10%。 这个百分比是因为代码主要是防御性的，并且已经经过了相当数量的安装验证，降低了直接恶意代码的可能性。但供应链风险和脚本缺陷始终存在。

**利用方式：**

1.  **利用条件：**  需要拥有对 MySQL 服务器的本地用户权限或者能够通过 SQL 注入漏洞执行命令。
2.  **写入恶意配置：**  利用权限，将 `general_log_file` 设置为指向包含恶意配置的文件的路径。恶意配置中，设置 `malloc_lib` 指向恶意的 .so 文件。
3.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意 .so 文件被加载，从而执行任意代码。

搜索结果也表明，可以通过 SQL 注入来利用这个漏洞，意味着攻击者不需要本地账户，可以通过SQL注入写入配置，然后利用此漏洞提权至root。


**项目地址:** [meersjo/ansible-mysql-cve-2016-6662](https://github.com/meersjo/ansible-mysql-cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---



---

## POC #4

**来源**: [CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md](../2016/CVE-2016-6662-MAYASEVEN_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 配置覆盖/本地权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，允许本地用户创建任意配置并绕过某些保护机制，最终导致以 root 权限执行任意代码

**影响版本:** MySQL through 5.5.52, 5.6.x through 5.6.33, and 5.7.x through 5.7.15; MariaDB before 5.5.51, 10.0.x before 10.0.27, and 10.1.x before 10.1.17; and Percona Server before 5.5.51-38.1, 5.6.x before 5.6.32-78.0, and 5.7.x before 5.7.14-7

**利用条件:** 需要具备对 MySQL 数据库一定的写入权限（如通过 SQL 注入）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 漏洞允许攻击者通过设置 `general_log_file` 到 `my.cnf` 配置文件来创建任意配置，从而绕过某些保护机制。更进一步，通过设置 `malloc_lib` 选项，可以加载恶意动态链接库，最终导致以 root 权限执行任意代码。

**利用方式：**

1.  **前提条件：** 攻击者需要通过某种方式（例如 SQL 注入）获取对 MySQL 数据库的写入权限。
2.  **写入恶意配置：**  攻击者利用 SQL 注入漏洞，将 `general_log_file` 设置为一个精心构造的 `my.cnf` 配置文件路径，该配置文件中包含恶意的 `malloc_lib` 选项。
3.  **上传恶意动态链接库：**  攻击者将包含恶意代码的动态链接库（`mysql_hookandroot_lib.so`）上传到服务器上的某个可写目录（如 `/var/lib/mysql/`）。
4.  **触发漏洞：**  攻击者通过触发 MySQL 的日志功能，使 MySQL 加载并解析恶意的 `my.cnf` 配置文件，从而加载恶意动态链接库。
5.  **代码执行：**  恶意动态链接库中的代码被执行，攻击者获得 root 权限。

**POC 代码分析：**

提供的 Python 脚本 `From SQL injection to root shell.py` 实现了上述利用流程：

*   `craft_payloads()` 函数生成用于利用漏洞的 SQL 注入 payload。
*   该函数首先创建恶意触发器，该触发器将恶意配置写入 `my.cnf` 文件。
*   然后，该函数将恶意动态链接库 `mysql_hookandroot_lib.so` 的内容写入服务器上的文件。
*   最后，该函数创建 `poctable` 表，并通过插入数据来触发恶意触发器，从而执行代码。

**有效性：**

根据漏洞描述和提供的 POC 代码，该漏洞利用方法是有效的，只要满足利用条件（例如可写权限和特定 MySQL 版本）。

**投毒风险：**

该 POC 代码的主要目的是利用漏洞，但存在一定的投毒风险。 虽然大部分代码是为了验证和利用漏洞，但攻击者可能会在 `mysql_hookandroot_lib.so` 中添加后门或其他恶意功能，从而在成功利用漏洞后保持对系统的长期访问。 这里的投毒风险评估为10%, 主要体现在`mysql_hookandroot_lib.so` 恶意动态链接库上，如果该链接库被替换成具有其他恶意功能的链接库，则可能造成危害。


**项目地址:** [MAYASEVEN/CVE-2016-6662](https://github.com/MAYASEVEN/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #5

**来源**: [CVE-2016-6662-boompig_cve-2016-6662.md](../2016/CVE-2016-6662-boompig_cve-2016-6662.md)

## CVE-2016-6662 - MySQL Remote Root Code Execution / Privilege Escalation

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可导致数据库服务器完全控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 需要能够修改MySQL配置文件 (my.cnf) 并且目标服务器运行受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 `general_log_file` 选项为 `my.cnf` 配置文件，创建任意配置并绕过某些保护机制。 这可以被利用来执行具有 root 权限的任意代码，通过设置 `malloc_lib` 选项。提供的PoC代码 `0ldSQL_MySQL_RCE_exploit.py` 是一个有限的版本，仅允许附加到现有 MySQL 配置文件的末尾。完整利用需要目标my.cnf具有mysql用户可写的权限。利用方式如下：

1.  **编译恶意共享库 (mysql_hookandroot_lib.so):**  该库包含恶意代码，用于提权和执行命令。
2.  **将恶意库转换为十六进制:** 将编译好的共享库内容转换为十六进制字符串。
3.  **利用SQL注入或其它方式修改my.cnf:**  将`malloc_lib`设置为恶意共享库的路径，并将`general_log_file`设置为`my.cnf`。需要具有FILE权限。
4.  **重启 MySQL 服务:**  重启后，MySQL将加载恶意共享库，执行其中的代码，从而获得 root 权限。

**投毒风险分析:**

该PoC代码的投毒风险较低 (10%)。PoC本身的功能是演示如何利用漏洞，并包含编译shellcode等必要步骤。然而，不排除作者在编译恶意库的过程中可能隐藏恶意代码的可能性。因此，在使用该PoC时，务必仔细审查代码，特别是 `mysql_hookandroot_lib.c` 文件，并进行代码审计以确保其安全性。

搜索引擎结果表明，该漏洞影响广泛，多个厂商的MySQL发行版都受影响。修复方案包括升级到最新版本或应用厂商提供的补丁。

**项目地址:** [boompig/cve-2016-6662](https://github.com/boompig/cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #6

**来源**: [CVE-2016-6662-kanyaars_CVE-2016-6662.md](../2016/CVE-2016-6662-kanyaars_CVE-2016-6662.md)

## CVE-2016-6662 - MySQL 本地权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户或具有FILE权限的远程用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户（或具有FILE权限的远程用户）通过设置 `general_log_file` 到 `my.cnf` 配置来创建任意配置和绕过某些保护机制。更严重的是，这可以被利用通过设置 `malloc_lib` 来执行具有 root 权限的任意代码。

**利用方式：**

1.  **写入恶意配置：** 攻击者利用数据库的FILE权限，将`general_log_file`指向一个攻击者可控的文件。这个文件会被解析为MySQL的配置文件。
2.  **设置malloc_lib：** 在该配置文件中，攻击者设置`malloc_lib`指向一个恶意的动态链接库（.so文件）。
3.  **重启MySQL服务：** 当MySQL服务重启时，会加载`malloc_lib`指定的恶意动态链接库，从而执行攻击者预设的恶意代码，获得服务器的root权限。

**POC分析：**
提供的POC代码包含两个文件：一个C语言编写的动态链接库 (`911KanyaLab_lib.c`) 和一个 Python 脚本 (`Exploit_Old_MySQL_Kay_ver.py`)。

*   **`911KanyaLab_lib.c`：** 这个C代码会被编译成`.so`文件。它定义了一个`execvp` hook函数，用于在MySQL启动时执行恶意代码。恶意代码的功能是创建一个反向Shell，连接到攻击者的IP地址和端口。
*   **`Exploit_Old_MySQL_Kay_ver.py`：** 这个Python脚本负责连接到目标MySQL服务器，上传并配置恶意的`.so`文件，并触发MySQL重启。

**投毒风险分析：**
代码主要逻辑是创建反向shell，连接攻击者的机器。存在投毒的可能。分析得出存在以下潜在的投毒风险:
*   C代码中IP地址和端口是硬编码的，如果攻击者篡改这些值，可能会将shell连接到其他恶意服务器。但是从代码逻辑来判断是为了完成漏洞验证的必要后门代码。
*   Python脚本需要指定MySQL用户名、密码、数据库名和`my.cnf`路径，这些信息可能被记录或泄露。
*   `config_cleanup()`函数的功能是清除注入的配置，但如果实现不正确，可能留下痕迹。

整体代码质量不高，存在一些硬编码，但主要功能符合漏洞描述，总体上是可信的。 但是依然存在作者隐藏的投毒代码的可能，但是可能性较低。

**项目地址:** [kanyaars/CVE-2016-6662](https://github.com/kanyaars/CVE-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #7

**来源**: [CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md](../2016/CVE-2016-6662-konstantin-kelemen_mysqld_safe-CVE-2016-6662-patch.md)

## CVE-2016-6662 - MySQL/MariaDB/PerconaDB 权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** MySQL: <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB: < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server: < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这可以被利用来通过设置 malloc_lib 以 root 权限执行任意代码。根据搜索结果，这是一个严重的安全漏洞，影响多个 MySQL 及其分支版本。利用方式通常涉及修改MySQL的配置文件，将 general_log_file 指向攻击者可控的文件，并在其中写入恶意配置，例如加载恶意动态链接库以执行任意代码。提供的Playbook 旨在通过添加安全检查来修补 `mysqld_safe` 脚本，防止从非标准系统目录加载 `ld_preload` 库。因此，此 Playbook 实际上是一个补丁，并非漏洞利用代码。Playbook 代码本身旨在修复漏洞，未发现隐藏的恶意代码，因此投毒风险为0%。根据漏洞信息和搜索结果，此漏洞影响广泛，需要尽快修复。

**项目地址:** [konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch](https://github.com/konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

## POC #8

**来源**: [CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md](../2016/CVE-2016-6662-meersjo_ansible-mysql-cve-2016-6662.md)

## CVE-2016-6662 - MySQL 远程 Root 代码执行/权限提升

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, Percona Server

**危害等级:** 高危，可能导致数据库完全控制和服务器接管

**影响版本:** MySQL <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或 SQL 注入漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 选项到 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这个漏洞可以被利用来以 root 权限执行任意代码，通过设置 malloc_lib 选项指向恶意 .so 文件。此利用方式依赖于可以写入 MySQL 配置文件，并重启 MySQL 服务。 

**有效性：** 提供的 Ansible 脚本旨在修复此漏洞，而非利用它。它通过修改 mysqld_safe 脚本，限制 .so 文件的加载路径到标准系统目录，并检查默认配置文件的存在性和权限来缓解风险，因此提供的代码是用于防御而不是利用的。

**投毒风险：**  该仓库本身包含的是修复漏洞的脚本，直接投毒的可能性较低。但是，仍然存在以下风险：

1.  **脚本本身可能存在缺陷：**  虽然脚本旨在修复漏洞，但如果脚本本身存在逻辑错误或未考虑到的情况，可能会导致 MySQL 服务不稳定或其他问题。 
2.  **供应链攻击：**  该仓库可能被黑客入侵，然后植入恶意代码。由于脚本需要修改系统文件和重启服务，一旦被植入恶意代码，危害非常大。 
3.  **依赖关系：**  该脚本可能依赖其他软件包或库，这些依赖项可能存在漏洞。  
综合考虑，投毒风险评估为 10%。 这个百分比是因为代码主要是防御性的，并且已经经过了相当数量的安装验证，降低了直接恶意代码的可能性。但供应链风险和脚本缺陷始终存在。

**利用方式：**

1.  **利用条件：**  需要拥有对 MySQL 服务器的本地用户权限或者能够通过 SQL 注入漏洞执行命令。
2.  **写入恶意配置：**  利用权限，将 `general_log_file` 设置为指向包含恶意配置的文件的路径。恶意配置中，设置 `malloc_lib` 指向恶意的 .so 文件。
3.  **重启 MySQL 服务：**  重启 MySQL 服务，使恶意 .so 文件被加载，从而执行任意代码。

搜索结果也表明，可以通过 SQL 注入来利用这个漏洞，意味着攻击者不需要本地账户，可以通过SQL注入写入配置，然后利用此漏洞提权至root。


**项目地址:** [meersjo/ansible-mysql-cve-2016-6662](https://github.com/meersjo/ansible-mysql-cve-2016-6662)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)

---

