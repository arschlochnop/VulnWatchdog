# CVE-2016-10006

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2016-10006-epicosy_VUL4J-60.md](../2016/CVE-2016-10006-epicosy_VUL4J-60.md)

# CVE-2016-10006

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2016-10006-epicosy_VUL4J-60.md](../2016/CVE-2016-10006-epicosy_VUL4J-60.md)

# CVE-2016-10006

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2016-10006-epicosy_VUL4J-60.md](../2016/CVE-2016-10006-epicosy_VUL4J-60.md)

# CVE-2016-10006

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2016-10006-epicosy_VUL4J-60.md](../2016/CVE-2016-10006-epicosy_VUL4J-60.md)

# CVE-2016-10006

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2016-10006-epicosy_VUL4J-60.md](../2016/CVE-2016-10006-epicosy_VUL4J-60.md)

# CVE-2016-10006

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2016-10006-epicosy_VUL4J-60.md](../2016/CVE-2016-10006-epicosy_VUL4J-60.md)

# CVE-2016-10006

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2016-10006-epicosy_VUL4J-60.md](../2016/CVE-2016-10006-epicosy_VUL4J-60.md)

# CVE-2016-10006

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2016-10006-epicosy_VUL4J-60.md](../2016/CVE-2016-10006-epicosy_VUL4J-60.md)

# CVE-2016-10006

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2016-10006-epicosy_VUL4J-60.md](../2016/CVE-2016-10006-epicosy_VUL4J-60.md)

# CVE-2016-10006

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2016-10006-epicosy_VUL4J-60.md](../2016/CVE-2016-10006-epicosy_VUL4J-60.md)

# CVE-2016-10006

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2016-10006-epicosy_VUL4J-60.md](../2016/CVE-2016-10006-epicosy_VUL4J-60.md)

# CVE-2016-10006

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2016-10006-epicosy_VUL4J-60.md](../2016/CVE-2016-10006-epicosy_VUL4J-60.md)

# CVE-2016-10006

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2016-10006-epicosy_VUL4J-60.md](../2016/CVE-2016-10006-epicosy_VUL4J-60.md)

# CVE-2016-10006

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2016-10006-epicosy_VUL4J-60.md](../2016/CVE-2016-10006-epicosy_VUL4J-60.md)

## CVE-2016-10006-OWASP AntiSamy-XSS

**æ¼æ´ç¼–å·:** CVE-2016-10006

**æ¼æ´ç±»å‹:** XSS (è·¨ç«™è„šæœ¬)

**å½±å“åº”ç”¨:** OWASP AntiSamy

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ç”¨æˆ·æ•°æ®æ³„éœ²ã€ä¼šè¯åŠ«æŒã€æ¶æ„ä»£ç æ‰§è¡Œç­‰

**å½±å“ç‰ˆæœ¬:** < 1.5.5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿæäº¤HTMLå†…å®¹å¹¶é€šè¿‡AntiSamyè¿›è¡Œå¤„ç†

**POC å¯ç”¨æ€§:** å¦

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2016-10006 æ˜¯ OWASP AntiSamy 1.5.5 ä¹‹å‰ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ä¸€ä¸ªè·¨ç«™è„šæœ¬ (XSS) æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æäº¤ç‰¹åˆ¶çš„è¾“å…¥ï¼Œå…¶ä¸­åŒ…å«æ”¯æŒå†…è”æ ·å¼çš„æ ‡ç­¾ï¼ˆä¾‹å¦‚ `style` å±æ€§ï¼‰ï¼Œç»•è¿‡ AntiSamy çš„ä¿æŠ¤æœºåˆ¶ï¼Œä»è€Œæ³¨å…¥æ¶æ„ä»£ç ã€‚æ¼æ´çš„æ ¹æºåœ¨äº AntiSamy å¯¹ style å±æ€§ä¸­çš„ CSS éªŒè¯ä¸å®Œå–„ã€‚ä»æä¾›çš„æœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œè¯¥æ¼æ´å½±å“è¾ƒå¤§ï¼Œéœ€è¦åŠæ—¶æ›´æ–° AntiSamy ç‰ˆæœ¬ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å®é™…ä¸Šæ˜¯ AntiSamy çš„é¡¹ç›®æºç å’Œæµ‹è¯•ä»£ç ï¼Œå¹¶æœªåŒ…å«ç›´æ¥å¯ç”¨çš„ POCï¼Œå› æ­¤`poc_available`ä¸ºå¦ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œæä¾›çš„ä»£ç ä¸»è¦æ˜¯ AntiSamy çš„ Maven é¡¹ç›®æ–‡ä»¶å’Œéƒ¨åˆ†æµ‹è¯•ä»£ç , æŠ•æ¯’å¯èƒ½æ€§è¾ƒä½, ä½†æ˜¯éœ€è¦äººå·¥å®¡æ ¸æ‰èƒ½ç¡®å®š, å› æ­¤è®¾ç½® `poison` ä¸º10%ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å«æ¶æ„ CSS æ ·å¼çš„ HTML æ ‡ç­¾ï¼Œç»•è¿‡ AntiSamy çš„è¿‡æ»¤ï¼Œä»è€Œæ‰§è¡Œ JavaScript ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [epicosy/VUL4J-60](https://github.com/epicosy/VUL4J-60)

**æ¼æ´è¯¦æƒ…:** [CVE-2016-10006](https://nvd.nist.gov/vuln/detail/CVE-2016-10006)

---

## POC #2

**æ¥æº**: [CVE-2016-10006-shoucheng3_nahsra__antisamy_CVE-2016-10006_1-5-3.md](../2016/CVE-2016-10006-shoucheng3_nahsra__antisamy_CVE-2016-10006_1-5-3.md)

## CVE-2016-10006-OWASP AntiSamy-XSS

**æ¼æ´ç¼–å·:** CVE-2016-10006

**æ¼æ´ç±»å‹:** XSS

**å½±å“åº”ç”¨:** OWASP AntiSamy

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»

**å½±å“ç‰ˆæœ¬:** < 1.5.5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æäº¤æ¶æ„æ„é€ çš„HTMLè¾“å…¥

**POC å¯ç”¨æ€§:** å¦

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2016-10006 æ˜¯ OWASP AntiSamy 1.5.5 ä¹‹å‰ç‰ˆæœ¬ä¸­çš„ä¸€ä¸ª XSS æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æäº¤ä¸€ä¸ªç‰¹æ®Šæ„é€ çš„è¾“å…¥ï¼ˆä¸€ä¸ªæ”¯æŒ style å±æ€§å¹¶åŒ…å« active content çš„æ ‡ç­¾ï¼‰ï¼Œä»è€Œç»•è¿‡ AntiSamy çš„ä¿æŠ¤å¹¶æ³¨å…¥å¯æ‰§è¡Œä»£ç ã€‚è¯¥æ¼æ´æ˜¯ç”±äº CSS éªŒè¯ä¸å½“å¯¼è‡´çš„ã€‚ 

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ AntiSamy åº“çš„ Maven é¡¹ç›®æ–‡ä»¶å’Œæµ‹è¯•æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰ç›´æ¥ä½“ç°æ¼æ´çš„åˆ©ç”¨ Payloadï¼Œå› æ­¤æ— æ³•ç›´æ¥åˆ¤æ–­å…¶æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼ŒCVE æè¿°å’Œæœç´¢ç»“æœç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œæ‰€ä»¥å¦‚æœæ‰¾åˆ°åˆé€‚çš„ Payloadï¼Œæ¼æ´åº”è¯¥æ˜¯å¯ä»¥åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**æä¾›çš„ä»£ç åº“æ˜¯ AntiSamy é¡¹ç›®çš„æºç ï¼Œä» `pom.xml` å’Œæµ‹è¯•æ–‡ä»¶æ¥çœ‹ï¼Œä¸»è¦ç›®çš„æ˜¯æ„å»ºå’Œæµ‹è¯• AntiSamy åº“æœ¬èº«çš„åŠŸèƒ½ã€‚è™½ç„¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°ä»¥ä¸‹å‡ ç‚¹ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼š

1.  **é—´æ¥æŠ•æ¯’ï¼š** æ”»å‡»è€…å¯èƒ½é€šè¿‡æäº¤ç²¾å¿ƒæ„é€ çš„ PRï¼Œä¿®æ”¹ CSS è§£æé€»è¾‘ï¼Œä½¿å¾—åœ¨ç‰¹å®šæƒ…å†µä¸‹å…è®¸æ‰§è¡Œæ¶æ„ä»£ç ã€‚è¿™ç§æŠ•æ¯’æ–¹å¼è¾ƒä¸ºéšè”½ï¼Œéš¾ä»¥ç›´æ¥æ£€æµ‹ã€‚
2.  **ä¾èµ–é¡¹é£é™©ï¼š** é¡¹ç›®ä¾èµ–çš„ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚ `xml-apis`ã€`batik-css` ç­‰ï¼‰å¦‚æœå­˜åœ¨å®‰å…¨æ¼æ´ï¼Œä¹Ÿå¯èƒ½é—´æ¥å½±å“ AntiSamy çš„å®‰å…¨æ€§ã€‚

å› æ­¤ï¼Œç»¼åˆæ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ï¼Œé¢„ä¼°ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** åˆ©ç”¨æ­¤ XSS æ¼æ´ï¼Œæ”»å‡»è€…éœ€è¦æ‰¾åˆ°ä¸€ä¸ª AntiSamy å…è®¸çš„æ ‡ç­¾ï¼Œè¯¥æ ‡ç­¾å¯ä»¥æ”¯æŒ `style` å±æ€§ï¼Œå¹¶ä¸”èƒ½åœ¨ `style` å±æ€§ä¸­åµŒå…¥ JavaScript ä»£ç ã€‚ä¾‹å¦‚ï¼Œæ—©æœŸç‰ˆæœ¬çš„ AntiSamy å¯èƒ½å…è®¸ä½¿ç”¨ `<div style="...">` æ ‡ç­¾ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ `style` å±æ€§ä¸­ä½¿ç”¨ç±»ä¼¼ `expression(alert('XSS'))` çš„ CSS è¡¨è¾¾å¼æ¥æ‰§è¡Œ JavaScript ä»£ç ã€‚ä¿®å¤åçš„ AntiSamy ä¼šæ›´ä¸¥æ ¼åœ°è¿‡æ»¤ `style` å±æ€§ä¸­çš„å†…å®¹ï¼Œé˜²æ­¢æ­¤ç±»æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/nahsra__antisamy_CVE-2016-10006_1-5-3](https://github.com/shoucheng3/nahsra__antisamy_CVE-2016-10006_1-5-3)

**æ¼æ´è¯¦æƒ…:** [CVE-2016-10006](https://nvd.nist.gov/vuln/detail/CVE-2016-10006)

---



---

## POC #2

**æ¥æº**: [CVE-2016-10006-shoucheng3_nahsra__antisamy_CVE-2016-10006_1-5-3.md](../2016/CVE-2016-10006-shoucheng3_nahsra__antisamy_CVE-2016-10006_1-5-3.md)

## CVE-2016-10006-OWASP AntiSamy-XSS

**æ¼æ´ç¼–å·:** CVE-2016-10006

**æ¼æ´ç±»å‹:** XSS

**å½±å“åº”ç”¨:** OWASP AntiSamy

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»

**å½±å“ç‰ˆæœ¬:** < 1.5.5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æäº¤æ¶æ„æ„é€ çš„HTMLè¾“å…¥

**POC å¯ç”¨æ€§:** å¦

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2016-10006 æ˜¯ OWASP AntiSamy 1.5.5 ä¹‹å‰ç‰ˆæœ¬ä¸­çš„ä¸€ä¸ª XSS æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æäº¤ä¸€ä¸ªç‰¹æ®Šæ„é€ çš„è¾“å…¥ï¼ˆä¸€ä¸ªæ”¯æŒ style å±æ€§å¹¶åŒ…å« active content çš„æ ‡ç­¾ï¼‰ï¼Œä»è€Œç»•è¿‡ AntiSamy çš„ä¿æŠ¤å¹¶æ³¨å…¥å¯æ‰§è¡Œä»£ç ã€‚è¯¥æ¼æ´æ˜¯ç”±äº CSS éªŒè¯ä¸å½“å¯¼è‡´çš„ã€‚ 

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ AntiSamy åº“çš„ Maven é¡¹ç›®æ–‡ä»¶å’Œæµ‹è¯•æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰ç›´æ¥ä½“ç°æ¼æ´çš„åˆ©ç”¨ Payloadï¼Œå› æ­¤æ— æ³•ç›´æ¥åˆ¤æ–­å…¶æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼ŒCVE æè¿°å’Œæœç´¢ç»“æœç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œæ‰€ä»¥å¦‚æœæ‰¾åˆ°åˆé€‚çš„ Payloadï¼Œæ¼æ´åº”è¯¥æ˜¯å¯ä»¥åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**æä¾›çš„ä»£ç åº“æ˜¯ AntiSamy é¡¹ç›®çš„æºç ï¼Œä» `pom.xml` å’Œæµ‹è¯•æ–‡ä»¶æ¥çœ‹ï¼Œä¸»è¦ç›®çš„æ˜¯æ„å»ºå’Œæµ‹è¯• AntiSamy åº“æœ¬èº«çš„åŠŸèƒ½ã€‚è™½ç„¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°ä»¥ä¸‹å‡ ç‚¹ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼š

1.  **é—´æ¥æŠ•æ¯’ï¼š** æ”»å‡»è€…å¯èƒ½é€šè¿‡æäº¤ç²¾å¿ƒæ„é€ çš„ PRï¼Œä¿®æ”¹ CSS è§£æé€»è¾‘ï¼Œä½¿å¾—åœ¨ç‰¹å®šæƒ…å†µä¸‹å…è®¸æ‰§è¡Œæ¶æ„ä»£ç ã€‚è¿™ç§æŠ•æ¯’æ–¹å¼è¾ƒä¸ºéšè”½ï¼Œéš¾ä»¥ç›´æ¥æ£€æµ‹ã€‚
2.  **ä¾èµ–é¡¹é£é™©ï¼š** é¡¹ç›®ä¾èµ–çš„ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚ `xml-apis`ã€`batik-css` ç­‰ï¼‰å¦‚æœå­˜åœ¨å®‰å…¨æ¼æ´ï¼Œä¹Ÿå¯èƒ½é—´æ¥å½±å“ AntiSamy çš„å®‰å…¨æ€§ã€‚

å› æ­¤ï¼Œç»¼åˆæ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ï¼Œé¢„ä¼°ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** åˆ©ç”¨æ­¤ XSS æ¼æ´ï¼Œæ”»å‡»è€…éœ€è¦æ‰¾åˆ°ä¸€ä¸ª AntiSamy å…è®¸çš„æ ‡ç­¾ï¼Œè¯¥æ ‡ç­¾å¯ä»¥æ”¯æŒ `style` å±æ€§ï¼Œå¹¶ä¸”èƒ½åœ¨ `style` å±æ€§ä¸­åµŒå…¥ JavaScript ä»£ç ã€‚ä¾‹å¦‚ï¼Œæ—©æœŸç‰ˆæœ¬çš„ AntiSamy å¯èƒ½å…è®¸ä½¿ç”¨ `<div style="...">` æ ‡ç­¾ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ `style` å±æ€§ä¸­ä½¿ç”¨ç±»ä¼¼ `expression(alert('XSS'))` çš„ CSS è¡¨è¾¾å¼æ¥æ‰§è¡Œ JavaScript ä»£ç ã€‚ä¿®å¤åçš„ AntiSamy ä¼šæ›´ä¸¥æ ¼åœ°è¿‡æ»¤ `style` å±æ€§ä¸­çš„å†…å®¹ï¼Œé˜²æ­¢æ­¤ç±»æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/nahsra__antisamy_CVE-2016-10006_1-5-3](https://github.com/shoucheng3/nahsra__antisamy_CVE-2016-10006_1-5-3)

**æ¼æ´è¯¦æƒ…:** [CVE-2016-10006](https://nvd.nist.gov/vuln/detail/CVE-2016-10006)

---



---

## POC #2

**æ¥æº**: [CVE-2016-10006-shoucheng3_nahsra__antisamy_CVE-2016-10006_1-5-3.md](../2016/CVE-2016-10006-shoucheng3_nahsra__antisamy_CVE-2016-10006_1-5-3.md)

## CVE-2016-10006-OWASP AntiSamy-XSS

**æ¼æ´ç¼–å·:** CVE-2016-10006

**æ¼æ´ç±»å‹:** XSS

**å½±å“åº”ç”¨:** OWASP AntiSamy

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»

**å½±å“ç‰ˆæœ¬:** < 1.5.5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æäº¤æ¶æ„æ„é€ çš„HTMLè¾“å…¥

**POC å¯ç”¨æ€§:** å¦

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2016-10006 æ˜¯ OWASP AntiSamy 1.5.5 ä¹‹å‰ç‰ˆæœ¬ä¸­çš„ä¸€ä¸ª XSS æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æäº¤ä¸€ä¸ªç‰¹æ®Šæ„é€ çš„è¾“å…¥ï¼ˆä¸€ä¸ªæ”¯æŒ style å±æ€§å¹¶åŒ…å« active content çš„æ ‡ç­¾ï¼‰ï¼Œä»è€Œç»•è¿‡ AntiSamy çš„ä¿æŠ¤å¹¶æ³¨å…¥å¯æ‰§è¡Œä»£ç ã€‚è¯¥æ¼æ´æ˜¯ç”±äº CSS éªŒè¯ä¸å½“å¯¼è‡´çš„ã€‚ 

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ AntiSamy åº“çš„ Maven é¡¹ç›®æ–‡ä»¶å’Œæµ‹è¯•æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰ç›´æ¥ä½“ç°æ¼æ´çš„åˆ©ç”¨ Payloadï¼Œå› æ­¤æ— æ³•ç›´æ¥åˆ¤æ–­å…¶æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼ŒCVE æè¿°å’Œæœç´¢ç»“æœç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œæ‰€ä»¥å¦‚æœæ‰¾åˆ°åˆé€‚çš„ Payloadï¼Œæ¼æ´åº”è¯¥æ˜¯å¯ä»¥åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**æä¾›çš„ä»£ç åº“æ˜¯ AntiSamy é¡¹ç›®çš„æºç ï¼Œä» `pom.xml` å’Œæµ‹è¯•æ–‡ä»¶æ¥çœ‹ï¼Œä¸»è¦ç›®çš„æ˜¯æ„å»ºå’Œæµ‹è¯• AntiSamy åº“æœ¬èº«çš„åŠŸèƒ½ã€‚è™½ç„¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°ä»¥ä¸‹å‡ ç‚¹ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼š

1.  **é—´æ¥æŠ•æ¯’ï¼š** æ”»å‡»è€…å¯èƒ½é€šè¿‡æäº¤ç²¾å¿ƒæ„é€ çš„ PRï¼Œä¿®æ”¹ CSS è§£æé€»è¾‘ï¼Œä½¿å¾—åœ¨ç‰¹å®šæƒ…å†µä¸‹å…è®¸æ‰§è¡Œæ¶æ„ä»£ç ã€‚è¿™ç§æŠ•æ¯’æ–¹å¼è¾ƒä¸ºéšè”½ï¼Œéš¾ä»¥ç›´æ¥æ£€æµ‹ã€‚
2.  **ä¾èµ–é¡¹é£é™©ï¼š** é¡¹ç›®ä¾èµ–çš„ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚ `xml-apis`ã€`batik-css` ç­‰ï¼‰å¦‚æœå­˜åœ¨å®‰å…¨æ¼æ´ï¼Œä¹Ÿå¯èƒ½é—´æ¥å½±å“ AntiSamy çš„å®‰å…¨æ€§ã€‚

å› æ­¤ï¼Œç»¼åˆæ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ï¼Œé¢„ä¼°ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** åˆ©ç”¨æ­¤ XSS æ¼æ´ï¼Œæ”»å‡»è€…éœ€è¦æ‰¾åˆ°ä¸€ä¸ª AntiSamy å…è®¸çš„æ ‡ç­¾ï¼Œè¯¥æ ‡ç­¾å¯ä»¥æ”¯æŒ `style` å±æ€§ï¼Œå¹¶ä¸”èƒ½åœ¨ `style` å±æ€§ä¸­åµŒå…¥ JavaScript ä»£ç ã€‚ä¾‹å¦‚ï¼Œæ—©æœŸç‰ˆæœ¬çš„ AntiSamy å¯èƒ½å…è®¸ä½¿ç”¨ `<div style="...">` æ ‡ç­¾ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ `style` å±æ€§ä¸­ä½¿ç”¨ç±»ä¼¼ `expression(alert('XSS'))` çš„ CSS è¡¨è¾¾å¼æ¥æ‰§è¡Œ JavaScript ä»£ç ã€‚ä¿®å¤åçš„ AntiSamy ä¼šæ›´ä¸¥æ ¼åœ°è¿‡æ»¤ `style` å±æ€§ä¸­çš„å†…å®¹ï¼Œé˜²æ­¢æ­¤ç±»æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/nahsra__antisamy_CVE-2016-10006_1-5-3](https://github.com/shoucheng3/nahsra__antisamy_CVE-2016-10006_1-5-3)

**æ¼æ´è¯¦æƒ…:** [CVE-2016-10006](https://nvd.nist.gov/vuln/detail/CVE-2016-10006)

---



---

## POC #2

**æ¥æº**: [CVE-2016-10006-shoucheng3_nahsra__antisamy_CVE-2016-10006_1-5-3.md](../2016/CVE-2016-10006-shoucheng3_nahsra__antisamy_CVE-2016-10006_1-5-3.md)

## CVE-2016-10006-OWASP AntiSamy-XSS

**æ¼æ´ç¼–å·:** CVE-2016-10006

**æ¼æ´ç±»å‹:** XSS

**å½±å“åº”ç”¨:** OWASP AntiSamy

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»

**å½±å“ç‰ˆæœ¬:** < 1.5.5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æäº¤æ¶æ„æ„é€ çš„HTMLè¾“å…¥

**POC å¯ç”¨æ€§:** å¦

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2016-10006 æ˜¯ OWASP AntiSamy 1.5.5 ä¹‹å‰ç‰ˆæœ¬ä¸­çš„ä¸€ä¸ª XSS æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æäº¤ä¸€ä¸ªç‰¹æ®Šæ„é€ çš„è¾“å…¥ï¼ˆä¸€ä¸ªæ”¯æŒ style å±æ€§å¹¶åŒ…å« active content çš„æ ‡ç­¾ï¼‰ï¼Œä»è€Œç»•è¿‡ AntiSamy çš„ä¿æŠ¤å¹¶æ³¨å…¥å¯æ‰§è¡Œä»£ç ã€‚è¯¥æ¼æ´æ˜¯ç”±äº CSS éªŒè¯ä¸å½“å¯¼è‡´çš„ã€‚ 

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ AntiSamy åº“çš„ Maven é¡¹ç›®æ–‡ä»¶å’Œæµ‹è¯•æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰ç›´æ¥ä½“ç°æ¼æ´çš„åˆ©ç”¨ Payloadï¼Œå› æ­¤æ— æ³•ç›´æ¥åˆ¤æ–­å…¶æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼ŒCVE æè¿°å’Œæœç´¢ç»“æœç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œæ‰€ä»¥å¦‚æœæ‰¾åˆ°åˆé€‚çš„ Payloadï¼Œæ¼æ´åº”è¯¥æ˜¯å¯ä»¥åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**æä¾›çš„ä»£ç åº“æ˜¯ AntiSamy é¡¹ç›®çš„æºç ï¼Œä» `pom.xml` å’Œæµ‹è¯•æ–‡ä»¶æ¥çœ‹ï¼Œä¸»è¦ç›®çš„æ˜¯æ„å»ºå’Œæµ‹è¯• AntiSamy åº“æœ¬èº«çš„åŠŸèƒ½ã€‚è™½ç„¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°ä»¥ä¸‹å‡ ç‚¹ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼š

1.  **é—´æ¥æŠ•æ¯’ï¼š** æ”»å‡»è€…å¯èƒ½é€šè¿‡æäº¤ç²¾å¿ƒæ„é€ çš„ PRï¼Œä¿®æ”¹ CSS è§£æé€»è¾‘ï¼Œä½¿å¾—åœ¨ç‰¹å®šæƒ…å†µä¸‹å…è®¸æ‰§è¡Œæ¶æ„ä»£ç ã€‚è¿™ç§æŠ•æ¯’æ–¹å¼è¾ƒä¸ºéšè”½ï¼Œéš¾ä»¥ç›´æ¥æ£€æµ‹ã€‚
2.  **ä¾èµ–é¡¹é£é™©ï¼š** é¡¹ç›®ä¾èµ–çš„ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚ `xml-apis`ã€`batik-css` ç­‰ï¼‰å¦‚æœå­˜åœ¨å®‰å…¨æ¼æ´ï¼Œä¹Ÿå¯èƒ½é—´æ¥å½±å“ AntiSamy çš„å®‰å…¨æ€§ã€‚

å› æ­¤ï¼Œç»¼åˆæ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ï¼Œé¢„ä¼°ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** åˆ©ç”¨æ­¤ XSS æ¼æ´ï¼Œæ”»å‡»è€…éœ€è¦æ‰¾åˆ°ä¸€ä¸ª AntiSamy å…è®¸çš„æ ‡ç­¾ï¼Œè¯¥æ ‡ç­¾å¯ä»¥æ”¯æŒ `style` å±æ€§ï¼Œå¹¶ä¸”èƒ½åœ¨ `style` å±æ€§ä¸­åµŒå…¥ JavaScript ä»£ç ã€‚ä¾‹å¦‚ï¼Œæ—©æœŸç‰ˆæœ¬çš„ AntiSamy å¯èƒ½å…è®¸ä½¿ç”¨ `<div style="...">` æ ‡ç­¾ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ `style` å±æ€§ä¸­ä½¿ç”¨ç±»ä¼¼ `expression(alert('XSS'))` çš„ CSS è¡¨è¾¾å¼æ¥æ‰§è¡Œ JavaScript ä»£ç ã€‚ä¿®å¤åçš„ AntiSamy ä¼šæ›´ä¸¥æ ¼åœ°è¿‡æ»¤ `style` å±æ€§ä¸­çš„å†…å®¹ï¼Œé˜²æ­¢æ­¤ç±»æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/nahsra__antisamy_CVE-2016-10006_1-5-3](https://github.com/shoucheng3/nahsra__antisamy_CVE-2016-10006_1-5-3)

**æ¼æ´è¯¦æƒ…:** [CVE-2016-10006](https://nvd.nist.gov/vuln/detail/CVE-2016-10006)

---



---

## POC #2

**æ¥æº**: [CVE-2016-10006-shoucheng3_nahsra__antisamy_CVE-2016-10006_1-5-3.md](../2016/CVE-2016-10006-shoucheng3_nahsra__antisamy_CVE-2016-10006_1-5-3.md)

## CVE-2016-10006-OWASP AntiSamy-XSS

**æ¼æ´ç¼–å·:** CVE-2016-10006

**æ¼æ´ç±»å‹:** XSS

**å½±å“åº”ç”¨:** OWASP AntiSamy

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»

**å½±å“ç‰ˆæœ¬:** < 1.5.5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æäº¤æ¶æ„æ„é€ çš„HTMLè¾“å…¥

**POC å¯ç”¨æ€§:** å¦

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2016-10006 æ˜¯ OWASP AntiSamy 1.5.5 ä¹‹å‰ç‰ˆæœ¬ä¸­çš„ä¸€ä¸ª XSS æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æäº¤ä¸€ä¸ªç‰¹æ®Šæ„é€ çš„è¾“å…¥ï¼ˆä¸€ä¸ªæ”¯æŒ style å±æ€§å¹¶åŒ…å« active content çš„æ ‡ç­¾ï¼‰ï¼Œä»è€Œç»•è¿‡ AntiSamy çš„ä¿æŠ¤å¹¶æ³¨å…¥å¯æ‰§è¡Œä»£ç ã€‚è¯¥æ¼æ´æ˜¯ç”±äº CSS éªŒè¯ä¸å½“å¯¼è‡´çš„ã€‚ 

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ AntiSamy åº“çš„ Maven é¡¹ç›®æ–‡ä»¶å’Œæµ‹è¯•æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰ç›´æ¥ä½“ç°æ¼æ´çš„åˆ©ç”¨ Payloadï¼Œå› æ­¤æ— æ³•ç›´æ¥åˆ¤æ–­å…¶æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼ŒCVE æè¿°å’Œæœç´¢ç»“æœç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œæ‰€ä»¥å¦‚æœæ‰¾åˆ°åˆé€‚çš„ Payloadï¼Œæ¼æ´åº”è¯¥æ˜¯å¯ä»¥åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**æä¾›çš„ä»£ç åº“æ˜¯ AntiSamy é¡¹ç›®çš„æºç ï¼Œä» `pom.xml` å’Œæµ‹è¯•æ–‡ä»¶æ¥çœ‹ï¼Œä¸»è¦ç›®çš„æ˜¯æ„å»ºå’Œæµ‹è¯• AntiSamy åº“æœ¬èº«çš„åŠŸèƒ½ã€‚è™½ç„¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°ä»¥ä¸‹å‡ ç‚¹ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼š

1.  **é—´æ¥æŠ•æ¯’ï¼š** æ”»å‡»è€…å¯èƒ½é€šè¿‡æäº¤ç²¾å¿ƒæ„é€ çš„ PRï¼Œä¿®æ”¹ CSS è§£æé€»è¾‘ï¼Œä½¿å¾—åœ¨ç‰¹å®šæƒ…å†µä¸‹å…è®¸æ‰§è¡Œæ¶æ„ä»£ç ã€‚è¿™ç§æŠ•æ¯’æ–¹å¼è¾ƒä¸ºéšè”½ï¼Œéš¾ä»¥ç›´æ¥æ£€æµ‹ã€‚
2.  **ä¾èµ–é¡¹é£é™©ï¼š** é¡¹ç›®ä¾èµ–çš„ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚ `xml-apis`ã€`batik-css` ç­‰ï¼‰å¦‚æœå­˜åœ¨å®‰å…¨æ¼æ´ï¼Œä¹Ÿå¯èƒ½é—´æ¥å½±å“ AntiSamy çš„å®‰å…¨æ€§ã€‚

å› æ­¤ï¼Œç»¼åˆæ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ï¼Œé¢„ä¼°ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** åˆ©ç”¨æ­¤ XSS æ¼æ´ï¼Œæ”»å‡»è€…éœ€è¦æ‰¾åˆ°ä¸€ä¸ª AntiSamy å…è®¸çš„æ ‡ç­¾ï¼Œè¯¥æ ‡ç­¾å¯ä»¥æ”¯æŒ `style` å±æ€§ï¼Œå¹¶ä¸”èƒ½åœ¨ `style` å±æ€§ä¸­åµŒå…¥ JavaScript ä»£ç ã€‚ä¾‹å¦‚ï¼Œæ—©æœŸç‰ˆæœ¬çš„ AntiSamy å¯èƒ½å…è®¸ä½¿ç”¨ `<div style="...">` æ ‡ç­¾ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ `style` å±æ€§ä¸­ä½¿ç”¨ç±»ä¼¼ `expression(alert('XSS'))` çš„ CSS è¡¨è¾¾å¼æ¥æ‰§è¡Œ JavaScript ä»£ç ã€‚ä¿®å¤åçš„ AntiSamy ä¼šæ›´ä¸¥æ ¼åœ°è¿‡æ»¤ `style` å±æ€§ä¸­çš„å†…å®¹ï¼Œé˜²æ­¢æ­¤ç±»æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/nahsra__antisamy_CVE-2016-10006_1-5-3](https://github.com/shoucheng3/nahsra__antisamy_CVE-2016-10006_1-5-3)

**æ¼æ´è¯¦æƒ…:** [CVE-2016-10006](https://nvd.nist.gov/vuln/detail/CVE-2016-10006)

---



---

## POC #2

**æ¥æº**: [CVE-2016-10006-shoucheng3_nahsra__antisamy_CVE-2016-10006_1-5-3.md](../2016/CVE-2016-10006-shoucheng3_nahsra__antisamy_CVE-2016-10006_1-5-3.md)

## CVE-2016-10006-OWASP AntiSamy-XSS

**æ¼æ´ç¼–å·:** CVE-2016-10006

**æ¼æ´ç±»å‹:** XSS

**å½±å“åº”ç”¨:** OWASP AntiSamy

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»

**å½±å“ç‰ˆæœ¬:** < 1.5.5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æäº¤æ¶æ„æ„é€ çš„HTMLè¾“å…¥

**POC å¯ç”¨æ€§:** å¦

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2016-10006 æ˜¯ OWASP AntiSamy 1.5.5 ä¹‹å‰ç‰ˆæœ¬ä¸­çš„ä¸€ä¸ª XSS æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æäº¤ä¸€ä¸ªç‰¹æ®Šæ„é€ çš„è¾“å…¥ï¼ˆä¸€ä¸ªæ”¯æŒ style å±æ€§å¹¶åŒ…å« active content çš„æ ‡ç­¾ï¼‰ï¼Œä»è€Œç»•è¿‡ AntiSamy çš„ä¿æŠ¤å¹¶æ³¨å…¥å¯æ‰§è¡Œä»£ç ã€‚è¯¥æ¼æ´æ˜¯ç”±äº CSS éªŒè¯ä¸å½“å¯¼è‡´çš„ã€‚ 

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ AntiSamy åº“çš„ Maven é¡¹ç›®æ–‡ä»¶å’Œæµ‹è¯•æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰ç›´æ¥ä½“ç°æ¼æ´çš„åˆ©ç”¨ Payloadï¼Œå› æ­¤æ— æ³•ç›´æ¥åˆ¤æ–­å…¶æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼ŒCVE æè¿°å’Œæœç´¢ç»“æœç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œæ‰€ä»¥å¦‚æœæ‰¾åˆ°åˆé€‚çš„ Payloadï¼Œæ¼æ´åº”è¯¥æ˜¯å¯ä»¥åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**æä¾›çš„ä»£ç åº“æ˜¯ AntiSamy é¡¹ç›®çš„æºç ï¼Œä» `pom.xml` å’Œæµ‹è¯•æ–‡ä»¶æ¥çœ‹ï¼Œä¸»è¦ç›®çš„æ˜¯æ„å»ºå’Œæµ‹è¯• AntiSamy åº“æœ¬èº«çš„åŠŸèƒ½ã€‚è™½ç„¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°ä»¥ä¸‹å‡ ç‚¹ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼š

1.  **é—´æ¥æŠ•æ¯’ï¼š** æ”»å‡»è€…å¯èƒ½é€šè¿‡æäº¤ç²¾å¿ƒæ„é€ çš„ PRï¼Œä¿®æ”¹ CSS è§£æé€»è¾‘ï¼Œä½¿å¾—åœ¨ç‰¹å®šæƒ…å†µä¸‹å…è®¸æ‰§è¡Œæ¶æ„ä»£ç ã€‚è¿™ç§æŠ•æ¯’æ–¹å¼è¾ƒä¸ºéšè”½ï¼Œéš¾ä»¥ç›´æ¥æ£€æµ‹ã€‚
2.  **ä¾èµ–é¡¹é£é™©ï¼š** é¡¹ç›®ä¾èµ–çš„ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚ `xml-apis`ã€`batik-css` ç­‰ï¼‰å¦‚æœå­˜åœ¨å®‰å…¨æ¼æ´ï¼Œä¹Ÿå¯èƒ½é—´æ¥å½±å“ AntiSamy çš„å®‰å…¨æ€§ã€‚

å› æ­¤ï¼Œç»¼åˆæ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ï¼Œé¢„ä¼°ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** åˆ©ç”¨æ­¤ XSS æ¼æ´ï¼Œæ”»å‡»è€…éœ€è¦æ‰¾åˆ°ä¸€ä¸ª AntiSamy å…è®¸çš„æ ‡ç­¾ï¼Œè¯¥æ ‡ç­¾å¯ä»¥æ”¯æŒ `style` å±æ€§ï¼Œå¹¶ä¸”èƒ½åœ¨ `style` å±æ€§ä¸­åµŒå…¥ JavaScript ä»£ç ã€‚ä¾‹å¦‚ï¼Œæ—©æœŸç‰ˆæœ¬çš„ AntiSamy å¯èƒ½å…è®¸ä½¿ç”¨ `<div style="...">` æ ‡ç­¾ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ `style` å±æ€§ä¸­ä½¿ç”¨ç±»ä¼¼ `expression(alert('XSS'))` çš„ CSS è¡¨è¾¾å¼æ¥æ‰§è¡Œ JavaScript ä»£ç ã€‚ä¿®å¤åçš„ AntiSamy ä¼šæ›´ä¸¥æ ¼åœ°è¿‡æ»¤ `style` å±æ€§ä¸­çš„å†…å®¹ï¼Œé˜²æ­¢æ­¤ç±»æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/nahsra__antisamy_CVE-2016-10006_1-5-3](https://github.com/shoucheng3/nahsra__antisamy_CVE-2016-10006_1-5-3)

**æ¼æ´è¯¦æƒ…:** [CVE-2016-10006](https://nvd.nist.gov/vuln/detail/CVE-2016-10006)

---



---

## POC #2

**æ¥æº**: [CVE-2016-10006-shoucheng3_nahsra__antisamy_CVE-2016-10006_1-5-3.md](../2016/CVE-2016-10006-shoucheng3_nahsra__antisamy_CVE-2016-10006_1-5-3.md)

## CVE-2016-10006-OWASP AntiSamy-XSS

**æ¼æ´ç¼–å·:** CVE-2016-10006

**æ¼æ´ç±»å‹:** XSS

**å½±å“åº”ç”¨:** OWASP AntiSamy

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»

**å½±å“ç‰ˆæœ¬:** < 1.5.5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æäº¤æ¶æ„æ„é€ çš„HTMLè¾“å…¥

**POC å¯ç”¨æ€§:** å¦

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2016-10006 æ˜¯ OWASP AntiSamy 1.5.5 ä¹‹å‰ç‰ˆæœ¬ä¸­çš„ä¸€ä¸ª XSS æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æäº¤ä¸€ä¸ªç‰¹æ®Šæ„é€ çš„è¾“å…¥ï¼ˆä¸€ä¸ªæ”¯æŒ style å±æ€§å¹¶åŒ…å« active content çš„æ ‡ç­¾ï¼‰ï¼Œä»è€Œç»•è¿‡ AntiSamy çš„ä¿æŠ¤å¹¶æ³¨å…¥å¯æ‰§è¡Œä»£ç ã€‚è¯¥æ¼æ´æ˜¯ç”±äº CSS éªŒè¯ä¸å½“å¯¼è‡´çš„ã€‚ 

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ AntiSamy åº“çš„ Maven é¡¹ç›®æ–‡ä»¶å’Œæµ‹è¯•æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰ç›´æ¥ä½“ç°æ¼æ´çš„åˆ©ç”¨ Payloadï¼Œå› æ­¤æ— æ³•ç›´æ¥åˆ¤æ–­å…¶æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼ŒCVE æè¿°å’Œæœç´¢ç»“æœç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œæ‰€ä»¥å¦‚æœæ‰¾åˆ°åˆé€‚çš„ Payloadï¼Œæ¼æ´åº”è¯¥æ˜¯å¯ä»¥åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**æä¾›çš„ä»£ç åº“æ˜¯ AntiSamy é¡¹ç›®çš„æºç ï¼Œä» `pom.xml` å’Œæµ‹è¯•æ–‡ä»¶æ¥çœ‹ï¼Œä¸»è¦ç›®çš„æ˜¯æ„å»ºå’Œæµ‹è¯• AntiSamy åº“æœ¬èº«çš„åŠŸèƒ½ã€‚è™½ç„¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°ä»¥ä¸‹å‡ ç‚¹ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼š

1.  **é—´æ¥æŠ•æ¯’ï¼š** æ”»å‡»è€…å¯èƒ½é€šè¿‡æäº¤ç²¾å¿ƒæ„é€ çš„ PRï¼Œä¿®æ”¹ CSS è§£æé€»è¾‘ï¼Œä½¿å¾—åœ¨ç‰¹å®šæƒ…å†µä¸‹å…è®¸æ‰§è¡Œæ¶æ„ä»£ç ã€‚è¿™ç§æŠ•æ¯’æ–¹å¼è¾ƒä¸ºéšè”½ï¼Œéš¾ä»¥ç›´æ¥æ£€æµ‹ã€‚
2.  **ä¾èµ–é¡¹é£é™©ï¼š** é¡¹ç›®ä¾èµ–çš„ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚ `xml-apis`ã€`batik-css` ç­‰ï¼‰å¦‚æœå­˜åœ¨å®‰å…¨æ¼æ´ï¼Œä¹Ÿå¯èƒ½é—´æ¥å½±å“ AntiSamy çš„å®‰å…¨æ€§ã€‚

å› æ­¤ï¼Œç»¼åˆæ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ï¼Œé¢„ä¼°ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** åˆ©ç”¨æ­¤ XSS æ¼æ´ï¼Œæ”»å‡»è€…éœ€è¦æ‰¾åˆ°ä¸€ä¸ª AntiSamy å…è®¸çš„æ ‡ç­¾ï¼Œè¯¥æ ‡ç­¾å¯ä»¥æ”¯æŒ `style` å±æ€§ï¼Œå¹¶ä¸”èƒ½åœ¨ `style` å±æ€§ä¸­åµŒå…¥ JavaScript ä»£ç ã€‚ä¾‹å¦‚ï¼Œæ—©æœŸç‰ˆæœ¬çš„ AntiSamy å¯èƒ½å…è®¸ä½¿ç”¨ `<div style="...">` æ ‡ç­¾ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ `style` å±æ€§ä¸­ä½¿ç”¨ç±»ä¼¼ `expression(alert('XSS'))` çš„ CSS è¡¨è¾¾å¼æ¥æ‰§è¡Œ JavaScript ä»£ç ã€‚ä¿®å¤åçš„ AntiSamy ä¼šæ›´ä¸¥æ ¼åœ°è¿‡æ»¤ `style` å±æ€§ä¸­çš„å†…å®¹ï¼Œé˜²æ­¢æ­¤ç±»æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/nahsra__antisamy_CVE-2016-10006_1-5-3](https://github.com/shoucheng3/nahsra__antisamy_CVE-2016-10006_1-5-3)

**æ¼æ´è¯¦æƒ…:** [CVE-2016-10006](https://nvd.nist.gov/vuln/detail/CVE-2016-10006)

---



---

## POC #2

**æ¥æº**: [CVE-2016-10006-shoucheng3_nahsra__antisamy_CVE-2016-10006_1-5-3.md](../2016/CVE-2016-10006-shoucheng3_nahsra__antisamy_CVE-2016-10006_1-5-3.md)

## CVE-2016-10006-OWASP AntiSamy-XSS

**æ¼æ´ç¼–å·:** CVE-2016-10006

**æ¼æ´ç±»å‹:** XSS

**å½±å“åº”ç”¨:** OWASP AntiSamy

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»

**å½±å“ç‰ˆæœ¬:** < 1.5.5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æäº¤æ¶æ„æ„é€ çš„HTMLè¾“å…¥

**POC å¯ç”¨æ€§:** å¦

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2016-10006 æ˜¯ OWASP AntiSamy 1.5.5 ä¹‹å‰ç‰ˆæœ¬ä¸­çš„ä¸€ä¸ª XSS æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æäº¤ä¸€ä¸ªç‰¹æ®Šæ„é€ çš„è¾“å…¥ï¼ˆä¸€ä¸ªæ”¯æŒ style å±æ€§å¹¶åŒ…å« active content çš„æ ‡ç­¾ï¼‰ï¼Œä»è€Œç»•è¿‡ AntiSamy çš„ä¿æŠ¤å¹¶æ³¨å…¥å¯æ‰§è¡Œä»£ç ã€‚è¯¥æ¼æ´æ˜¯ç”±äº CSS éªŒè¯ä¸å½“å¯¼è‡´çš„ã€‚ 

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ AntiSamy åº“çš„ Maven é¡¹ç›®æ–‡ä»¶å’Œæµ‹è¯•æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰ç›´æ¥ä½“ç°æ¼æ´çš„åˆ©ç”¨ Payloadï¼Œå› æ­¤æ— æ³•ç›´æ¥åˆ¤æ–­å…¶æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼ŒCVE æè¿°å’Œæœç´¢ç»“æœç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œæ‰€ä»¥å¦‚æœæ‰¾åˆ°åˆé€‚çš„ Payloadï¼Œæ¼æ´åº”è¯¥æ˜¯å¯ä»¥åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**æä¾›çš„ä»£ç åº“æ˜¯ AntiSamy é¡¹ç›®çš„æºç ï¼Œä» `pom.xml` å’Œæµ‹è¯•æ–‡ä»¶æ¥çœ‹ï¼Œä¸»è¦ç›®çš„æ˜¯æ„å»ºå’Œæµ‹è¯• AntiSamy åº“æœ¬èº«çš„åŠŸèƒ½ã€‚è™½ç„¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°ä»¥ä¸‹å‡ ç‚¹ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼š

1.  **é—´æ¥æŠ•æ¯’ï¼š** æ”»å‡»è€…å¯èƒ½é€šè¿‡æäº¤ç²¾å¿ƒæ„é€ çš„ PRï¼Œä¿®æ”¹ CSS è§£æé€»è¾‘ï¼Œä½¿å¾—åœ¨ç‰¹å®šæƒ…å†µä¸‹å…è®¸æ‰§è¡Œæ¶æ„ä»£ç ã€‚è¿™ç§æŠ•æ¯’æ–¹å¼è¾ƒä¸ºéšè”½ï¼Œéš¾ä»¥ç›´æ¥æ£€æµ‹ã€‚
2.  **ä¾èµ–é¡¹é£é™©ï¼š** é¡¹ç›®ä¾èµ–çš„ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚ `xml-apis`ã€`batik-css` ç­‰ï¼‰å¦‚æœå­˜åœ¨å®‰å…¨æ¼æ´ï¼Œä¹Ÿå¯èƒ½é—´æ¥å½±å“ AntiSamy çš„å®‰å…¨æ€§ã€‚

å› æ­¤ï¼Œç»¼åˆæ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ï¼Œé¢„ä¼°ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** åˆ©ç”¨æ­¤ XSS æ¼æ´ï¼Œæ”»å‡»è€…éœ€è¦æ‰¾åˆ°ä¸€ä¸ª AntiSamy å…è®¸çš„æ ‡ç­¾ï¼Œè¯¥æ ‡ç­¾å¯ä»¥æ”¯æŒ `style` å±æ€§ï¼Œå¹¶ä¸”èƒ½åœ¨ `style` å±æ€§ä¸­åµŒå…¥ JavaScript ä»£ç ã€‚ä¾‹å¦‚ï¼Œæ—©æœŸç‰ˆæœ¬çš„ AntiSamy å¯èƒ½å…è®¸ä½¿ç”¨ `<div style="...">` æ ‡ç­¾ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ `style` å±æ€§ä¸­ä½¿ç”¨ç±»ä¼¼ `expression(alert('XSS'))` çš„ CSS è¡¨è¾¾å¼æ¥æ‰§è¡Œ JavaScript ä»£ç ã€‚ä¿®å¤åçš„ AntiSamy ä¼šæ›´ä¸¥æ ¼åœ°è¿‡æ»¤ `style` å±æ€§ä¸­çš„å†…å®¹ï¼Œé˜²æ­¢æ­¤ç±»æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/nahsra__antisamy_CVE-2016-10006_1-5-3](https://github.com/shoucheng3/nahsra__antisamy_CVE-2016-10006_1-5-3)

**æ¼æ´è¯¦æƒ…:** [CVE-2016-10006](https://nvd.nist.gov/vuln/detail/CVE-2016-10006)

---



---

## POC #2

**æ¥æº**: [CVE-2016-10006-shoucheng3_nahsra__antisamy_CVE-2016-10006_1-5-3.md](../2016/CVE-2016-10006-shoucheng3_nahsra__antisamy_CVE-2016-10006_1-5-3.md)

## CVE-2016-10006-OWASP AntiSamy-XSS

**æ¼æ´ç¼–å·:** CVE-2016-10006

**æ¼æ´ç±»å‹:** XSS

**å½±å“åº”ç”¨:** OWASP AntiSamy

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»

**å½±å“ç‰ˆæœ¬:** < 1.5.5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æäº¤æ¶æ„æ„é€ çš„HTMLè¾“å…¥

**POC å¯ç”¨æ€§:** å¦

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2016-10006 æ˜¯ OWASP AntiSamy 1.5.5 ä¹‹å‰ç‰ˆæœ¬ä¸­çš„ä¸€ä¸ª XSS æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æäº¤ä¸€ä¸ªç‰¹æ®Šæ„é€ çš„è¾“å…¥ï¼ˆä¸€ä¸ªæ”¯æŒ style å±æ€§å¹¶åŒ…å« active content çš„æ ‡ç­¾ï¼‰ï¼Œä»è€Œç»•è¿‡ AntiSamy çš„ä¿æŠ¤å¹¶æ³¨å…¥å¯æ‰§è¡Œä»£ç ã€‚è¯¥æ¼æ´æ˜¯ç”±äº CSS éªŒè¯ä¸å½“å¯¼è‡´çš„ã€‚ 

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ AntiSamy åº“çš„ Maven é¡¹ç›®æ–‡ä»¶å’Œæµ‹è¯•æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰ç›´æ¥ä½“ç°æ¼æ´çš„åˆ©ç”¨ Payloadï¼Œå› æ­¤æ— æ³•ç›´æ¥åˆ¤æ–­å…¶æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼ŒCVE æè¿°å’Œæœç´¢ç»“æœç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œæ‰€ä»¥å¦‚æœæ‰¾åˆ°åˆé€‚çš„ Payloadï¼Œæ¼æ´åº”è¯¥æ˜¯å¯ä»¥åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**æä¾›çš„ä»£ç åº“æ˜¯ AntiSamy é¡¹ç›®çš„æºç ï¼Œä» `pom.xml` å’Œæµ‹è¯•æ–‡ä»¶æ¥çœ‹ï¼Œä¸»è¦ç›®çš„æ˜¯æ„å»ºå’Œæµ‹è¯• AntiSamy åº“æœ¬èº«çš„åŠŸèƒ½ã€‚è™½ç„¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°ä»¥ä¸‹å‡ ç‚¹ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼š

1.  **é—´æ¥æŠ•æ¯’ï¼š** æ”»å‡»è€…å¯èƒ½é€šè¿‡æäº¤ç²¾å¿ƒæ„é€ çš„ PRï¼Œä¿®æ”¹ CSS è§£æé€»è¾‘ï¼Œä½¿å¾—åœ¨ç‰¹å®šæƒ…å†µä¸‹å…è®¸æ‰§è¡Œæ¶æ„ä»£ç ã€‚è¿™ç§æŠ•æ¯’æ–¹å¼è¾ƒä¸ºéšè”½ï¼Œéš¾ä»¥ç›´æ¥æ£€æµ‹ã€‚
2.  **ä¾èµ–é¡¹é£é™©ï¼š** é¡¹ç›®ä¾èµ–çš„ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚ `xml-apis`ã€`batik-css` ç­‰ï¼‰å¦‚æœå­˜åœ¨å®‰å…¨æ¼æ´ï¼Œä¹Ÿå¯èƒ½é—´æ¥å½±å“ AntiSamy çš„å®‰å…¨æ€§ã€‚

å› æ­¤ï¼Œç»¼åˆæ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ï¼Œé¢„ä¼°ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** åˆ©ç”¨æ­¤ XSS æ¼æ´ï¼Œæ”»å‡»è€…éœ€è¦æ‰¾åˆ°ä¸€ä¸ª AntiSamy å…è®¸çš„æ ‡ç­¾ï¼Œè¯¥æ ‡ç­¾å¯ä»¥æ”¯æŒ `style` å±æ€§ï¼Œå¹¶ä¸”èƒ½åœ¨ `style` å±æ€§ä¸­åµŒå…¥ JavaScript ä»£ç ã€‚ä¾‹å¦‚ï¼Œæ—©æœŸç‰ˆæœ¬çš„ AntiSamy å¯èƒ½å…è®¸ä½¿ç”¨ `<div style="...">` æ ‡ç­¾ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ `style` å±æ€§ä¸­ä½¿ç”¨ç±»ä¼¼ `expression(alert('XSS'))` çš„ CSS è¡¨è¾¾å¼æ¥æ‰§è¡Œ JavaScript ä»£ç ã€‚ä¿®å¤åçš„ AntiSamy ä¼šæ›´ä¸¥æ ¼åœ°è¿‡æ»¤ `style` å±æ€§ä¸­çš„å†…å®¹ï¼Œé˜²æ­¢æ­¤ç±»æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/nahsra__antisamy_CVE-2016-10006_1-5-3](https://github.com/shoucheng3/nahsra__antisamy_CVE-2016-10006_1-5-3)

**æ¼æ´è¯¦æƒ…:** [CVE-2016-10006](https://nvd.nist.gov/vuln/detail/CVE-2016-10006)

---



---

## POC #2

**æ¥æº**: [CVE-2016-10006-shoucheng3_nahsra__antisamy_CVE-2016-10006_1-5-3.md](../2016/CVE-2016-10006-shoucheng3_nahsra__antisamy_CVE-2016-10006_1-5-3.md)

## CVE-2016-10006-OWASP AntiSamy-XSS

**æ¼æ´ç¼–å·:** CVE-2016-10006

**æ¼æ´ç±»å‹:** XSS

**å½±å“åº”ç”¨:** OWASP AntiSamy

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»

**å½±å“ç‰ˆæœ¬:** < 1.5.5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æäº¤æ¶æ„æ„é€ çš„HTMLè¾“å…¥

**POC å¯ç”¨æ€§:** å¦

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2016-10006 æ˜¯ OWASP AntiSamy 1.5.5 ä¹‹å‰ç‰ˆæœ¬ä¸­çš„ä¸€ä¸ª XSS æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æäº¤ä¸€ä¸ªç‰¹æ®Šæ„é€ çš„è¾“å…¥ï¼ˆä¸€ä¸ªæ”¯æŒ style å±æ€§å¹¶åŒ…å« active content çš„æ ‡ç­¾ï¼‰ï¼Œä»è€Œç»•è¿‡ AntiSamy çš„ä¿æŠ¤å¹¶æ³¨å…¥å¯æ‰§è¡Œä»£ç ã€‚è¯¥æ¼æ´æ˜¯ç”±äº CSS éªŒè¯ä¸å½“å¯¼è‡´çš„ã€‚ 

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ AntiSamy åº“çš„ Maven é¡¹ç›®æ–‡ä»¶å’Œæµ‹è¯•æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰ç›´æ¥ä½“ç°æ¼æ´çš„åˆ©ç”¨ Payloadï¼Œå› æ­¤æ— æ³•ç›´æ¥åˆ¤æ–­å…¶æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼ŒCVE æè¿°å’Œæœç´¢ç»“æœç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œæ‰€ä»¥å¦‚æœæ‰¾åˆ°åˆé€‚çš„ Payloadï¼Œæ¼æ´åº”è¯¥æ˜¯å¯ä»¥åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**æä¾›çš„ä»£ç åº“æ˜¯ AntiSamy é¡¹ç›®çš„æºç ï¼Œä» `pom.xml` å’Œæµ‹è¯•æ–‡ä»¶æ¥çœ‹ï¼Œä¸»è¦ç›®çš„æ˜¯æ„å»ºå’Œæµ‹è¯• AntiSamy åº“æœ¬èº«çš„åŠŸèƒ½ã€‚è™½ç„¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°ä»¥ä¸‹å‡ ç‚¹ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼š

1.  **é—´æ¥æŠ•æ¯’ï¼š** æ”»å‡»è€…å¯èƒ½é€šè¿‡æäº¤ç²¾å¿ƒæ„é€ çš„ PRï¼Œä¿®æ”¹ CSS è§£æé€»è¾‘ï¼Œä½¿å¾—åœ¨ç‰¹å®šæƒ…å†µä¸‹å…è®¸æ‰§è¡Œæ¶æ„ä»£ç ã€‚è¿™ç§æŠ•æ¯’æ–¹å¼è¾ƒä¸ºéšè”½ï¼Œéš¾ä»¥ç›´æ¥æ£€æµ‹ã€‚
2.  **ä¾èµ–é¡¹é£é™©ï¼š** é¡¹ç›®ä¾èµ–çš„ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚ `xml-apis`ã€`batik-css` ç­‰ï¼‰å¦‚æœå­˜åœ¨å®‰å…¨æ¼æ´ï¼Œä¹Ÿå¯èƒ½é—´æ¥å½±å“ AntiSamy çš„å®‰å…¨æ€§ã€‚

å› æ­¤ï¼Œç»¼åˆæ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ï¼Œé¢„ä¼°ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** åˆ©ç”¨æ­¤ XSS æ¼æ´ï¼Œæ”»å‡»è€…éœ€è¦æ‰¾åˆ°ä¸€ä¸ª AntiSamy å…è®¸çš„æ ‡ç­¾ï¼Œè¯¥æ ‡ç­¾å¯ä»¥æ”¯æŒ `style` å±æ€§ï¼Œå¹¶ä¸”èƒ½åœ¨ `style` å±æ€§ä¸­åµŒå…¥ JavaScript ä»£ç ã€‚ä¾‹å¦‚ï¼Œæ—©æœŸç‰ˆæœ¬çš„ AntiSamy å¯èƒ½å…è®¸ä½¿ç”¨ `<div style="...">` æ ‡ç­¾ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ `style` å±æ€§ä¸­ä½¿ç”¨ç±»ä¼¼ `expression(alert('XSS'))` çš„ CSS è¡¨è¾¾å¼æ¥æ‰§è¡Œ JavaScript ä»£ç ã€‚ä¿®å¤åçš„ AntiSamy ä¼šæ›´ä¸¥æ ¼åœ°è¿‡æ»¤ `style` å±æ€§ä¸­çš„å†…å®¹ï¼Œé˜²æ­¢æ­¤ç±»æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/nahsra__antisamy_CVE-2016-10006_1-5-3](https://github.com/shoucheng3/nahsra__antisamy_CVE-2016-10006_1-5-3)

**æ¼æ´è¯¦æƒ…:** [CVE-2016-10006](https://nvd.nist.gov/vuln/detail/CVE-2016-10006)

---



---

## POC #2

**æ¥æº**: [CVE-2016-10006-shoucheng3_nahsra__antisamy_CVE-2016-10006_1-5-3.md](../2016/CVE-2016-10006-shoucheng3_nahsra__antisamy_CVE-2016-10006_1-5-3.md)

## CVE-2016-10006-OWASP AntiSamy-XSS

**æ¼æ´ç¼–å·:** CVE-2016-10006

**æ¼æ´ç±»å‹:** XSS

**å½±å“åº”ç”¨:** OWASP AntiSamy

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»

**å½±å“ç‰ˆæœ¬:** < 1.5.5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æäº¤æ¶æ„æ„é€ çš„HTMLè¾“å…¥

**POC å¯ç”¨æ€§:** å¦

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2016-10006 æ˜¯ OWASP AntiSamy 1.5.5 ä¹‹å‰ç‰ˆæœ¬ä¸­çš„ä¸€ä¸ª XSS æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æäº¤ä¸€ä¸ªç‰¹æ®Šæ„é€ çš„è¾“å…¥ï¼ˆä¸€ä¸ªæ”¯æŒ style å±æ€§å¹¶åŒ…å« active content çš„æ ‡ç­¾ï¼‰ï¼Œä»è€Œç»•è¿‡ AntiSamy çš„ä¿æŠ¤å¹¶æ³¨å…¥å¯æ‰§è¡Œä»£ç ã€‚è¯¥æ¼æ´æ˜¯ç”±äº CSS éªŒè¯ä¸å½“å¯¼è‡´çš„ã€‚ 

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ AntiSamy åº“çš„ Maven é¡¹ç›®æ–‡ä»¶å’Œæµ‹è¯•æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰ç›´æ¥ä½“ç°æ¼æ´çš„åˆ©ç”¨ Payloadï¼Œå› æ­¤æ— æ³•ç›´æ¥åˆ¤æ–­å…¶æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼ŒCVE æè¿°å’Œæœç´¢ç»“æœç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œæ‰€ä»¥å¦‚æœæ‰¾åˆ°åˆé€‚çš„ Payloadï¼Œæ¼æ´åº”è¯¥æ˜¯å¯ä»¥åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**æä¾›çš„ä»£ç åº“æ˜¯ AntiSamy é¡¹ç›®çš„æºç ï¼Œä» `pom.xml` å’Œæµ‹è¯•æ–‡ä»¶æ¥çœ‹ï¼Œä¸»è¦ç›®çš„æ˜¯æ„å»ºå’Œæµ‹è¯• AntiSamy åº“æœ¬èº«çš„åŠŸèƒ½ã€‚è™½ç„¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°ä»¥ä¸‹å‡ ç‚¹ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼š

1.  **é—´æ¥æŠ•æ¯’ï¼š** æ”»å‡»è€…å¯èƒ½é€šè¿‡æäº¤ç²¾å¿ƒæ„é€ çš„ PRï¼Œä¿®æ”¹ CSS è§£æé€»è¾‘ï¼Œä½¿å¾—åœ¨ç‰¹å®šæƒ…å†µä¸‹å…è®¸æ‰§è¡Œæ¶æ„ä»£ç ã€‚è¿™ç§æŠ•æ¯’æ–¹å¼è¾ƒä¸ºéšè”½ï¼Œéš¾ä»¥ç›´æ¥æ£€æµ‹ã€‚
2.  **ä¾èµ–é¡¹é£é™©ï¼š** é¡¹ç›®ä¾èµ–çš„ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚ `xml-apis`ã€`batik-css` ç­‰ï¼‰å¦‚æœå­˜åœ¨å®‰å…¨æ¼æ´ï¼Œä¹Ÿå¯èƒ½é—´æ¥å½±å“ AntiSamy çš„å®‰å…¨æ€§ã€‚

å› æ­¤ï¼Œç»¼åˆæ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ï¼Œé¢„ä¼°ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** åˆ©ç”¨æ­¤ XSS æ¼æ´ï¼Œæ”»å‡»è€…éœ€è¦æ‰¾åˆ°ä¸€ä¸ª AntiSamy å…è®¸çš„æ ‡ç­¾ï¼Œè¯¥æ ‡ç­¾å¯ä»¥æ”¯æŒ `style` å±æ€§ï¼Œå¹¶ä¸”èƒ½åœ¨ `style` å±æ€§ä¸­åµŒå…¥ JavaScript ä»£ç ã€‚ä¾‹å¦‚ï¼Œæ—©æœŸç‰ˆæœ¬çš„ AntiSamy å¯èƒ½å…è®¸ä½¿ç”¨ `<div style="...">` æ ‡ç­¾ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ `style` å±æ€§ä¸­ä½¿ç”¨ç±»ä¼¼ `expression(alert('XSS'))` çš„ CSS è¡¨è¾¾å¼æ¥æ‰§è¡Œ JavaScript ä»£ç ã€‚ä¿®å¤åçš„ AntiSamy ä¼šæ›´ä¸¥æ ¼åœ°è¿‡æ»¤ `style` å±æ€§ä¸­çš„å†…å®¹ï¼Œé˜²æ­¢æ­¤ç±»æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/nahsra__antisamy_CVE-2016-10006_1-5-3](https://github.com/shoucheng3/nahsra__antisamy_CVE-2016-10006_1-5-3)

**æ¼æ´è¯¦æƒ…:** [CVE-2016-10006](https://nvd.nist.gov/vuln/detail/CVE-2016-10006)

---



---

## POC #2

**æ¥æº**: [CVE-2016-10006-shoucheng3_nahsra__antisamy_CVE-2016-10006_1-5-3.md](../2016/CVE-2016-10006-shoucheng3_nahsra__antisamy_CVE-2016-10006_1-5-3.md)

## CVE-2016-10006-OWASP AntiSamy-XSS

**æ¼æ´ç¼–å·:** CVE-2016-10006

**æ¼æ´ç±»å‹:** XSS

**å½±å“åº”ç”¨:** OWASP AntiSamy

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»

**å½±å“ç‰ˆæœ¬:** < 1.5.5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æäº¤æ¶æ„æ„é€ çš„HTMLè¾“å…¥

**POC å¯ç”¨æ€§:** å¦

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2016-10006 æ˜¯ OWASP AntiSamy 1.5.5 ä¹‹å‰ç‰ˆæœ¬ä¸­çš„ä¸€ä¸ª XSS æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æäº¤ä¸€ä¸ªç‰¹æ®Šæ„é€ çš„è¾“å…¥ï¼ˆä¸€ä¸ªæ”¯æŒ style å±æ€§å¹¶åŒ…å« active content çš„æ ‡ç­¾ï¼‰ï¼Œä»è€Œç»•è¿‡ AntiSamy çš„ä¿æŠ¤å¹¶æ³¨å…¥å¯æ‰§è¡Œä»£ç ã€‚è¯¥æ¼æ´æ˜¯ç”±äº CSS éªŒè¯ä¸å½“å¯¼è‡´çš„ã€‚ 

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ AntiSamy åº“çš„ Maven é¡¹ç›®æ–‡ä»¶å’Œæµ‹è¯•æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰ç›´æ¥ä½“ç°æ¼æ´çš„åˆ©ç”¨ Payloadï¼Œå› æ­¤æ— æ³•ç›´æ¥åˆ¤æ–­å…¶æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼ŒCVE æè¿°å’Œæœç´¢ç»“æœç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œæ‰€ä»¥å¦‚æœæ‰¾åˆ°åˆé€‚çš„ Payloadï¼Œæ¼æ´åº”è¯¥æ˜¯å¯ä»¥åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**æä¾›çš„ä»£ç åº“æ˜¯ AntiSamy é¡¹ç›®çš„æºç ï¼Œä» `pom.xml` å’Œæµ‹è¯•æ–‡ä»¶æ¥çœ‹ï¼Œä¸»è¦ç›®çš„æ˜¯æ„å»ºå’Œæµ‹è¯• AntiSamy åº“æœ¬èº«çš„åŠŸèƒ½ã€‚è™½ç„¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°ä»¥ä¸‹å‡ ç‚¹ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼š

1.  **é—´æ¥æŠ•æ¯’ï¼š** æ”»å‡»è€…å¯èƒ½é€šè¿‡æäº¤ç²¾å¿ƒæ„é€ çš„ PRï¼Œä¿®æ”¹ CSS è§£æé€»è¾‘ï¼Œä½¿å¾—åœ¨ç‰¹å®šæƒ…å†µä¸‹å…è®¸æ‰§è¡Œæ¶æ„ä»£ç ã€‚è¿™ç§æŠ•æ¯’æ–¹å¼è¾ƒä¸ºéšè”½ï¼Œéš¾ä»¥ç›´æ¥æ£€æµ‹ã€‚
2.  **ä¾èµ–é¡¹é£é™©ï¼š** é¡¹ç›®ä¾èµ–çš„ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚ `xml-apis`ã€`batik-css` ç­‰ï¼‰å¦‚æœå­˜åœ¨å®‰å…¨æ¼æ´ï¼Œä¹Ÿå¯èƒ½é—´æ¥å½±å“ AntiSamy çš„å®‰å…¨æ€§ã€‚

å› æ­¤ï¼Œç»¼åˆæ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ï¼Œé¢„ä¼°ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** åˆ©ç”¨æ­¤ XSS æ¼æ´ï¼Œæ”»å‡»è€…éœ€è¦æ‰¾åˆ°ä¸€ä¸ª AntiSamy å…è®¸çš„æ ‡ç­¾ï¼Œè¯¥æ ‡ç­¾å¯ä»¥æ”¯æŒ `style` å±æ€§ï¼Œå¹¶ä¸”èƒ½åœ¨ `style` å±æ€§ä¸­åµŒå…¥ JavaScript ä»£ç ã€‚ä¾‹å¦‚ï¼Œæ—©æœŸç‰ˆæœ¬çš„ AntiSamy å¯èƒ½å…è®¸ä½¿ç”¨ `<div style="...">` æ ‡ç­¾ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ `style` å±æ€§ä¸­ä½¿ç”¨ç±»ä¼¼ `expression(alert('XSS'))` çš„ CSS è¡¨è¾¾å¼æ¥æ‰§è¡Œ JavaScript ä»£ç ã€‚ä¿®å¤åçš„ AntiSamy ä¼šæ›´ä¸¥æ ¼åœ°è¿‡æ»¤ `style` å±æ€§ä¸­çš„å†…å®¹ï¼Œé˜²æ­¢æ­¤ç±»æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/nahsra__antisamy_CVE-2016-10006_1-5-3](https://github.com/shoucheng3/nahsra__antisamy_CVE-2016-10006_1-5-3)

**æ¼æ´è¯¦æƒ…:** [CVE-2016-10006](https://nvd.nist.gov/vuln/detail/CVE-2016-10006)

---



---

## POC #2

**æ¥æº**: [CVE-2016-10006-shoucheng3_nahsra__antisamy_CVE-2016-10006_1-5-3.md](../2016/CVE-2016-10006-shoucheng3_nahsra__antisamy_CVE-2016-10006_1-5-3.md)

## CVE-2016-10006-OWASP AntiSamy-XSS

**æ¼æ´ç¼–å·:** CVE-2016-10006

**æ¼æ´ç±»å‹:** XSS

**å½±å“åº”ç”¨:** OWASP AntiSamy

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»

**å½±å“ç‰ˆæœ¬:** < 1.5.5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æäº¤æ¶æ„æ„é€ çš„HTMLè¾“å…¥

**POC å¯ç”¨æ€§:** å¦

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2016-10006 æ˜¯ OWASP AntiSamy 1.5.5 ä¹‹å‰ç‰ˆæœ¬ä¸­çš„ä¸€ä¸ª XSS æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æäº¤ä¸€ä¸ªç‰¹æ®Šæ„é€ çš„è¾“å…¥ï¼ˆä¸€ä¸ªæ”¯æŒ style å±æ€§å¹¶åŒ…å« active content çš„æ ‡ç­¾ï¼‰ï¼Œä»è€Œç»•è¿‡ AntiSamy çš„ä¿æŠ¤å¹¶æ³¨å…¥å¯æ‰§è¡Œä»£ç ã€‚è¯¥æ¼æ´æ˜¯ç”±äº CSS éªŒè¯ä¸å½“å¯¼è‡´çš„ã€‚ 

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ AntiSamy åº“çš„ Maven é¡¹ç›®æ–‡ä»¶å’Œæµ‹è¯•æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰ç›´æ¥ä½“ç°æ¼æ´çš„åˆ©ç”¨ Payloadï¼Œå› æ­¤æ— æ³•ç›´æ¥åˆ¤æ–­å…¶æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼ŒCVE æè¿°å’Œæœç´¢ç»“æœç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œæ‰€ä»¥å¦‚æœæ‰¾åˆ°åˆé€‚çš„ Payloadï¼Œæ¼æ´åº”è¯¥æ˜¯å¯ä»¥åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**æä¾›çš„ä»£ç åº“æ˜¯ AntiSamy é¡¹ç›®çš„æºç ï¼Œä» `pom.xml` å’Œæµ‹è¯•æ–‡ä»¶æ¥çœ‹ï¼Œä¸»è¦ç›®çš„æ˜¯æ„å»ºå’Œæµ‹è¯• AntiSamy åº“æœ¬èº«çš„åŠŸèƒ½ã€‚è™½ç„¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°ä»¥ä¸‹å‡ ç‚¹ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼š

1.  **é—´æ¥æŠ•æ¯’ï¼š** æ”»å‡»è€…å¯èƒ½é€šè¿‡æäº¤ç²¾å¿ƒæ„é€ çš„ PRï¼Œä¿®æ”¹ CSS è§£æé€»è¾‘ï¼Œä½¿å¾—åœ¨ç‰¹å®šæƒ…å†µä¸‹å…è®¸æ‰§è¡Œæ¶æ„ä»£ç ã€‚è¿™ç§æŠ•æ¯’æ–¹å¼è¾ƒä¸ºéšè”½ï¼Œéš¾ä»¥ç›´æ¥æ£€æµ‹ã€‚
2.  **ä¾èµ–é¡¹é£é™©ï¼š** é¡¹ç›®ä¾èµ–çš„ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚ `xml-apis`ã€`batik-css` ç­‰ï¼‰å¦‚æœå­˜åœ¨å®‰å…¨æ¼æ´ï¼Œä¹Ÿå¯èƒ½é—´æ¥å½±å“ AntiSamy çš„å®‰å…¨æ€§ã€‚

å› æ­¤ï¼Œç»¼åˆæ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ï¼Œé¢„ä¼°ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** åˆ©ç”¨æ­¤ XSS æ¼æ´ï¼Œæ”»å‡»è€…éœ€è¦æ‰¾åˆ°ä¸€ä¸ª AntiSamy å…è®¸çš„æ ‡ç­¾ï¼Œè¯¥æ ‡ç­¾å¯ä»¥æ”¯æŒ `style` å±æ€§ï¼Œå¹¶ä¸”èƒ½åœ¨ `style` å±æ€§ä¸­åµŒå…¥ JavaScript ä»£ç ã€‚ä¾‹å¦‚ï¼Œæ—©æœŸç‰ˆæœ¬çš„ AntiSamy å¯èƒ½å…è®¸ä½¿ç”¨ `<div style="...">` æ ‡ç­¾ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ `style` å±æ€§ä¸­ä½¿ç”¨ç±»ä¼¼ `expression(alert('XSS'))` çš„ CSS è¡¨è¾¾å¼æ¥æ‰§è¡Œ JavaScript ä»£ç ã€‚ä¿®å¤åçš„ AntiSamy ä¼šæ›´ä¸¥æ ¼åœ°è¿‡æ»¤ `style` å±æ€§ä¸­çš„å†…å®¹ï¼Œé˜²æ­¢æ­¤ç±»æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/nahsra__antisamy_CVE-2016-10006_1-5-3](https://github.com/shoucheng3/nahsra__antisamy_CVE-2016-10006_1-5-3)

**æ¼æ´è¯¦æƒ…:** [CVE-2016-10006](https://nvd.nist.gov/vuln/detail/CVE-2016-10006)

---



---

## POC #2

**æ¥æº**: [CVE-2016-10006-shoucheng3_nahsra__antisamy_CVE-2016-10006_1-5-3.md](../2016/CVE-2016-10006-shoucheng3_nahsra__antisamy_CVE-2016-10006_1-5-3.md)

## CVE-2016-10006-OWASP AntiSamy-XSS

**æ¼æ´ç¼–å·:** CVE-2016-10006

**æ¼æ´ç±»å‹:** XSS

**å½±å“åº”ç”¨:** OWASP AntiSamy

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»

**å½±å“ç‰ˆæœ¬:** < 1.5.5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦æäº¤æ¶æ„æ„é€ çš„HTMLè¾“å…¥

**POC å¯ç”¨æ€§:** å¦

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2016-10006 æ˜¯ OWASP AntiSamy 1.5.5 ä¹‹å‰ç‰ˆæœ¬ä¸­çš„ä¸€ä¸ª XSS æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æäº¤ä¸€ä¸ªç‰¹æ®Šæ„é€ çš„è¾“å…¥ï¼ˆä¸€ä¸ªæ”¯æŒ style å±æ€§å¹¶åŒ…å« active content çš„æ ‡ç­¾ï¼‰ï¼Œä»è€Œç»•è¿‡ AntiSamy çš„ä¿æŠ¤å¹¶æ³¨å…¥å¯æ‰§è¡Œä»£ç ã€‚è¯¥æ¼æ´æ˜¯ç”±äº CSS éªŒè¯ä¸å½“å¯¼è‡´çš„ã€‚ 

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ AntiSamy åº“çš„ Maven é¡¹ç›®æ–‡ä»¶å’Œæµ‹è¯•æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰ç›´æ¥ä½“ç°æ¼æ´çš„åˆ©ç”¨ Payloadï¼Œå› æ­¤æ— æ³•ç›´æ¥åˆ¤æ–­å…¶æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼ŒCVE æè¿°å’Œæœç´¢ç»“æœç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œæ‰€ä»¥å¦‚æœæ‰¾åˆ°åˆé€‚çš„ Payloadï¼Œæ¼æ´åº”è¯¥æ˜¯å¯ä»¥åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**æä¾›çš„ä»£ç åº“æ˜¯ AntiSamy é¡¹ç›®çš„æºç ï¼Œä» `pom.xml` å’Œæµ‹è¯•æ–‡ä»¶æ¥çœ‹ï¼Œä¸»è¦ç›®çš„æ˜¯æ„å»ºå’Œæµ‹è¯• AntiSamy åº“æœ¬èº«çš„åŠŸèƒ½ã€‚è™½ç„¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°ä»¥ä¸‹å‡ ç‚¹ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼š

1.  **é—´æ¥æŠ•æ¯’ï¼š** æ”»å‡»è€…å¯èƒ½é€šè¿‡æäº¤ç²¾å¿ƒæ„é€ çš„ PRï¼Œä¿®æ”¹ CSS è§£æé€»è¾‘ï¼Œä½¿å¾—åœ¨ç‰¹å®šæƒ…å†µä¸‹å…è®¸æ‰§è¡Œæ¶æ„ä»£ç ã€‚è¿™ç§æŠ•æ¯’æ–¹å¼è¾ƒä¸ºéšè”½ï¼Œéš¾ä»¥ç›´æ¥æ£€æµ‹ã€‚
2.  **ä¾èµ–é¡¹é£é™©ï¼š** é¡¹ç›®ä¾èµ–çš„ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚ `xml-apis`ã€`batik-css` ç­‰ï¼‰å¦‚æœå­˜åœ¨å®‰å…¨æ¼æ´ï¼Œä¹Ÿå¯èƒ½é—´æ¥å½±å“ AntiSamy çš„å®‰å…¨æ€§ã€‚

å› æ­¤ï¼Œç»¼åˆæ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ï¼Œé¢„ä¼°ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** åˆ©ç”¨æ­¤ XSS æ¼æ´ï¼Œæ”»å‡»è€…éœ€è¦æ‰¾åˆ°ä¸€ä¸ª AntiSamy å…è®¸çš„æ ‡ç­¾ï¼Œè¯¥æ ‡ç­¾å¯ä»¥æ”¯æŒ `style` å±æ€§ï¼Œå¹¶ä¸”èƒ½åœ¨ `style` å±æ€§ä¸­åµŒå…¥ JavaScript ä»£ç ã€‚ä¾‹å¦‚ï¼Œæ—©æœŸç‰ˆæœ¬çš„ AntiSamy å¯èƒ½å…è®¸ä½¿ç”¨ `<div style="...">` æ ‡ç­¾ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ `style` å±æ€§ä¸­ä½¿ç”¨ç±»ä¼¼ `expression(alert('XSS'))` çš„ CSS è¡¨è¾¾å¼æ¥æ‰§è¡Œ JavaScript ä»£ç ã€‚ä¿®å¤åçš„ AntiSamy ä¼šæ›´ä¸¥æ ¼åœ°è¿‡æ»¤ `style` å±æ€§ä¸­çš„å†…å®¹ï¼Œé˜²æ­¢æ­¤ç±»æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/nahsra__antisamy_CVE-2016-10006_1-5-3](https://github.com/shoucheng3/nahsra__antisamy_CVE-2016-10006_1-5-3)

**æ¼æ´è¯¦æƒ…:** [CVE-2016-10006](https://nvd.nist.gov/vuln/detail/CVE-2016-10006)

---

