# CVE-2016-0792

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-0792-Aviksaikat_CVE-2016-0792.md](../2016/CVE-2016-0792-Aviksaikat_CVE-2016-0792.md)

# CVE-2016-0792

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-0792-Aviksaikat_CVE-2016-0792.md](../2016/CVE-2016-0792-Aviksaikat_CVE-2016-0792.md)

# CVE-2016-0792

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-0792-Aviksaikat_CVE-2016-0792.md](../2016/CVE-2016-0792-Aviksaikat_CVE-2016-0792.md)

# CVE-2016-0792

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-0792-Aviksaikat_CVE-2016-0792.md](../2016/CVE-2016-0792-Aviksaikat_CVE-2016-0792.md)

# CVE-2016-0792

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-0792-Aviksaikat_CVE-2016-0792.md](../2016/CVE-2016-0792-Aviksaikat_CVE-2016-0792.md)

# CVE-2016-0792

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-0792-gonn4cry_CVE-2016-0792.md](../2016/CVE-2016-0792-gonn4cry_CVE-2016-0792.md)

## CVE-2016-0792-Jenkins-远程代码执行

**漏洞编号:** CVE-2016-0792

**漏洞类型:** 反序列化漏洞

**影响应用:** Jenkins

**危害等级:** 高危，允许远程认证用户执行任意代码

**影响版本:** Jenkins < 1.650 和 LTS < 1.642.2

**利用条件:** 需要Jenkins实例可访问，并且攻击者需要拥有Jenkins的认证用户权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-0792 漏洞是 Jenkins 中一个严重的反序列化漏洞，存在于 Jenkins 1.650 之前和 LTS 1.642.2 之前的版本中。该漏洞位于多个未指定的 API 接口，允许远程认证用户通过 XML 文件中的序列化数据执行任意代码。该漏洞与 XStream 和 groovy.util.Expando 相关。

**有效性：**

根据漏洞描述和搜索结果，提供的 POC 代码似乎是有效的。搜索结果中包含了 Metasploit 模块，表明存在可利用的漏洞利用。

**投毒风险：**

代码本身的功能是创建一个 Jenkins Job，然后触发执行。Job的内容执行一个名为`/usr/local/bin/exfiltrate`的命令，并将输出结果重定向到`exfiltrate_output.log`。该脚本会循环检查这个命令的进程状态，输出，文件系统变更和exfiltration server 响应，最后会输出`exfiltrate_output.log` 的内容。该脚本中`exfiltrate` 命令并没有提供, 这意味着漏洞使用者需要自行构造该命令，存在一定的风险，

总体来看，该 POC 代码本身存在投毒风险较低，但需要警惕执行的命令 `/usr/local/bin/exfiltrate` 本身可能被恶意利用。

**利用方式：**

1.  **认证：** 攻击者需要拥有一个有效的 Jenkins 用户账号。
2.  **构造Payload：** 攻击者构造包含恶意代码的 XML 格式的 Payload，利用 XStream 反序列化漏洞执行命令。这个 Payload 通常会被嵌入到 Job 的配置中。
3.  **发送请求：** 攻击者将构造好的 Payload 发送到 Jenkins 的 API 接口（如创建 Job 的接口）。
4.  **触发执行：** Jenkins 解析 XML 数据时，会由于 XStream 的反序列化漏洞执行 Payload 中包含的恶意代码，从而导致远程代码执行。
5.  **代码分析:** 漏洞利用代码首先获取 Jenkins 的 crumb 用于绕过 CSRF 保护，然后构造包含恶意命令的 XML 格式 Job 配置，通过 createItem API 创建 Job，并触发 Job 执行。Job 执行后，会不断监控执行结果，并将结果输出到控制台。

**项目地址:** [gonn4cry/CVE-2016-0792](https://github.com/gonn4cry/CVE-2016-0792)

**漏洞详情:** [CVE-2016-0792](https://nvd.nist.gov/vuln/detail/CVE-2016-0792)

---

## POC #2

**来源**: [CVE-2016-0792-jpiechowka_jenkins-cve-2016-0792.md](../2016/CVE-2016-0792-jpiechowka_jenkins-cve-2016-0792.md)

## CVE-2016-0792 Jenkins XStream Groovy classpath Deserialization

**漏洞编号:** CVE-2016-0792

**漏洞类型:** 反序列化漏洞

**影响应用:** Jenkins

**危害等级:** 高危，允许远程代码执行

**影响版本:** Jenkins < 1.650; Jenkins LTS < 1.642.2

**利用条件:** 需要身份验证才能利用，但某些API端点可能不需要严格的权限控制

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-0792 是一个存在于 Jenkins 1.650 之前版本和 Jenkins LTS 1.642.2 之前版本的反序列化漏洞。攻击者可以通过在 XML 文件中构造恶意序列化数据，利用 XStream 和 groovy.util.Expando 组件，实现在 Jenkins 服务器上执行任意代码。根据提供的搜索引擎结果，该漏洞已被广泛研究，并且存在可用的 Metasploit 模块（链接：https://www.rapid7.com/db/modules/exploit/multi/http/jenkins_xstream_deserialize/ 和 https://www.exploit-db.com/exploits/43375）。漏洞利用代码中的 exploit.py 文件展示了如何通过 POST 请求将包含恶意 payload 的 XML 数据发送到 Jenkins 服务器的 createItem API 端点，从而触发漏洞。

**有效性：**
提供的 POC 代码看起来有效，因为它利用了已知的 Jenkins 反序列化漏洞，并尝试通过构造恶意 XML payload 来执行命令。代码包括版本检查，并尝试通过 /createItem 端点发送 payload。如果 Jenkins 服务器的版本低于指定版本，且用户具有创建项目的权限，则漏洞利用很可能成功。

**投毒风险：**
在提供的 LICENSE 文件中，作者声明不对软件造成的任何损害负责，这是一个标准的免责声明。 README.md 文件提供了漏洞信息和使用方法，包括免责声明。 exploit.py 文件本身只包含漏洞利用代码，没有明显的投毒行为。 prepare_payload.py 没有给出, 无法判断。
代码审核未发现任何尝试在目标系统上安装后门或执行恶意操作的痕迹，代码的主要目的是利用反序列化漏洞执行指定的命令。因此，此代码存储库中存在作者隐藏的投毒代码的可能性较低，判断投毒风险为0%。

**利用方式：**
1.  **身份验证：** 虽然漏洞描述指出需要经过身份验证的用户，但某些 API 端点可能不需要严格的权限验证。
2.  **版本检测：** 利用代码首先检测 Jenkins 的版本，确保目标版本存在漏洞。
3.  **Payload 构造：** 使用 prepare_payload() 函数构造恶意的 XML payload，其中包含要执行的命令。
4.  **POST 请求：** 将构造的 payload 通过 POST 请求发送到 Jenkins 服务器的 /createItem 端点。
5.  **远程代码执行：** 如果 payload 成功反序列化，将会在 Jenkins 服务器上执行指定的命令。

总而言之，CVE-2016-0792 是一个严重的安全漏洞，攻击者可以利用它来完全控制受影响的 Jenkins 服务器。提供的 POC 代码看起来有效，且可以用于验证漏洞的存在并执行任意命令。但需要注意的是，未经授权的漏洞利用是违法的，应仅在授权的环境中进行测试。

**项目地址:** [jpiechowka/jenkins-cve-2016-0792](https://github.com/jpiechowka/jenkins-cve-2016-0792)

**漏洞详情:** [CVE-2016-0792](https://nvd.nist.gov/vuln/detail/CVE-2016-0792)

---



---

## POC #2

**来源**: [CVE-2016-0792-gonn4cry_CVE-2016-0792.md](../2016/CVE-2016-0792-gonn4cry_CVE-2016-0792.md)

## CVE-2016-0792-Jenkins-远程代码执行

**漏洞编号:** CVE-2016-0792

**漏洞类型:** 反序列化漏洞

**影响应用:** Jenkins

**危害等级:** 高危，允许远程认证用户执行任意代码

**影响版本:** Jenkins < 1.650 和 LTS < 1.642.2

**利用条件:** 需要Jenkins实例可访问，并且攻击者需要拥有Jenkins的认证用户权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-0792 漏洞是 Jenkins 中一个严重的反序列化漏洞，存在于 Jenkins 1.650 之前和 LTS 1.642.2 之前的版本中。该漏洞位于多个未指定的 API 接口，允许远程认证用户通过 XML 文件中的序列化数据执行任意代码。该漏洞与 XStream 和 groovy.util.Expando 相关。

**有效性：**

根据漏洞描述和搜索结果，提供的 POC 代码似乎是有效的。搜索结果中包含了 Metasploit 模块，表明存在可利用的漏洞利用。

**投毒风险：**

代码本身的功能是创建一个 Jenkins Job，然后触发执行。Job的内容执行一个名为`/usr/local/bin/exfiltrate`的命令，并将输出结果重定向到`exfiltrate_output.log`。该脚本会循环检查这个命令的进程状态，输出，文件系统变更和exfiltration server 响应，最后会输出`exfiltrate_output.log` 的内容。该脚本中`exfiltrate` 命令并没有提供, 这意味着漏洞使用者需要自行构造该命令，存在一定的风险，

总体来看，该 POC 代码本身存在投毒风险较低，但需要警惕执行的命令 `/usr/local/bin/exfiltrate` 本身可能被恶意利用。

**利用方式：**

1.  **认证：** 攻击者需要拥有一个有效的 Jenkins 用户账号。
2.  **构造Payload：** 攻击者构造包含恶意代码的 XML 格式的 Payload，利用 XStream 反序列化漏洞执行命令。这个 Payload 通常会被嵌入到 Job 的配置中。
3.  **发送请求：** 攻击者将构造好的 Payload 发送到 Jenkins 的 API 接口（如创建 Job 的接口）。
4.  **触发执行：** Jenkins 解析 XML 数据时，会由于 XStream 的反序列化漏洞执行 Payload 中包含的恶意代码，从而导致远程代码执行。
5.  **代码分析:** 漏洞利用代码首先获取 Jenkins 的 crumb 用于绕过 CSRF 保护，然后构造包含恶意命令的 XML 格式 Job 配置，通过 createItem API 创建 Job，并触发 Job 执行。Job 执行后，会不断监控执行结果，并将结果输出到控制台。

**项目地址:** [gonn4cry/CVE-2016-0792](https://github.com/gonn4cry/CVE-2016-0792)

**漏洞详情:** [CVE-2016-0792](https://nvd.nist.gov/vuln/detail/CVE-2016-0792)

---

## POC #3

**来源**: [CVE-2016-0792-jpiechowka_jenkins-cve-2016-0792.md](../2016/CVE-2016-0792-jpiechowka_jenkins-cve-2016-0792.md)

## CVE-2016-0792 Jenkins XStream Groovy classpath Deserialization

**漏洞编号:** CVE-2016-0792

**漏洞类型:** 反序列化漏洞

**影响应用:** Jenkins

**危害等级:** 高危，允许远程代码执行

**影响版本:** Jenkins < 1.650; Jenkins LTS < 1.642.2

**利用条件:** 需要身份验证才能利用，但某些API端点可能不需要严格的权限控制

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-0792 是一个存在于 Jenkins 1.650 之前版本和 Jenkins LTS 1.642.2 之前版本的反序列化漏洞。攻击者可以通过在 XML 文件中构造恶意序列化数据，利用 XStream 和 groovy.util.Expando 组件，实现在 Jenkins 服务器上执行任意代码。根据提供的搜索引擎结果，该漏洞已被广泛研究，并且存在可用的 Metasploit 模块（链接：https://www.rapid7.com/db/modules/exploit/multi/http/jenkins_xstream_deserialize/ 和 https://www.exploit-db.com/exploits/43375）。漏洞利用代码中的 exploit.py 文件展示了如何通过 POST 请求将包含恶意 payload 的 XML 数据发送到 Jenkins 服务器的 createItem API 端点，从而触发漏洞。

**有效性：**
提供的 POC 代码看起来有效，因为它利用了已知的 Jenkins 反序列化漏洞，并尝试通过构造恶意 XML payload 来执行命令。代码包括版本检查，并尝试通过 /createItem 端点发送 payload。如果 Jenkins 服务器的版本低于指定版本，且用户具有创建项目的权限，则漏洞利用很可能成功。

**投毒风险：**
在提供的 LICENSE 文件中，作者声明不对软件造成的任何损害负责，这是一个标准的免责声明。 README.md 文件提供了漏洞信息和使用方法，包括免责声明。 exploit.py 文件本身只包含漏洞利用代码，没有明显的投毒行为。 prepare_payload.py 没有给出, 无法判断。
代码审核未发现任何尝试在目标系统上安装后门或执行恶意操作的痕迹，代码的主要目的是利用反序列化漏洞执行指定的命令。因此，此代码存储库中存在作者隐藏的投毒代码的可能性较低，判断投毒风险为0%。

**利用方式：**
1.  **身份验证：** 虽然漏洞描述指出需要经过身份验证的用户，但某些 API 端点可能不需要严格的权限验证。
2.  **版本检测：** 利用代码首先检测 Jenkins 的版本，确保目标版本存在漏洞。
3.  **Payload 构造：** 使用 prepare_payload() 函数构造恶意的 XML payload，其中包含要执行的命令。
4.  **POST 请求：** 将构造的 payload 通过 POST 请求发送到 Jenkins 服务器的 /createItem 端点。
5.  **远程代码执行：** 如果 payload 成功反序列化，将会在 Jenkins 服务器上执行指定的命令。

总而言之，CVE-2016-0792 是一个严重的安全漏洞，攻击者可以利用它来完全控制受影响的 Jenkins 服务器。提供的 POC 代码看起来有效，且可以用于验证漏洞的存在并执行任意命令。但需要注意的是，未经授权的漏洞利用是违法的，应仅在授权的环境中进行测试。

**项目地址:** [jpiechowka/jenkins-cve-2016-0792](https://github.com/jpiechowka/jenkins-cve-2016-0792)

**漏洞详情:** [CVE-2016-0792](https://nvd.nist.gov/vuln/detail/CVE-2016-0792)

---



---

## POC #2

**来源**: [CVE-2016-0792-gonn4cry_CVE-2016-0792.md](../2016/CVE-2016-0792-gonn4cry_CVE-2016-0792.md)

## CVE-2016-0792-Jenkins-远程代码执行

**漏洞编号:** CVE-2016-0792

**漏洞类型:** 反序列化漏洞

**影响应用:** Jenkins

**危害等级:** 高危，允许远程认证用户执行任意代码

**影响版本:** Jenkins < 1.650 和 LTS < 1.642.2

**利用条件:** 需要Jenkins实例可访问，并且攻击者需要拥有Jenkins的认证用户权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-0792 漏洞是 Jenkins 中一个严重的反序列化漏洞，存在于 Jenkins 1.650 之前和 LTS 1.642.2 之前的版本中。该漏洞位于多个未指定的 API 接口，允许远程认证用户通过 XML 文件中的序列化数据执行任意代码。该漏洞与 XStream 和 groovy.util.Expando 相关。

**有效性：**

根据漏洞描述和搜索结果，提供的 POC 代码似乎是有效的。搜索结果中包含了 Metasploit 模块，表明存在可利用的漏洞利用。

**投毒风险：**

代码本身的功能是创建一个 Jenkins Job，然后触发执行。Job的内容执行一个名为`/usr/local/bin/exfiltrate`的命令，并将输出结果重定向到`exfiltrate_output.log`。该脚本会循环检查这个命令的进程状态，输出，文件系统变更和exfiltration server 响应，最后会输出`exfiltrate_output.log` 的内容。该脚本中`exfiltrate` 命令并没有提供, 这意味着漏洞使用者需要自行构造该命令，存在一定的风险，

总体来看，该 POC 代码本身存在投毒风险较低，但需要警惕执行的命令 `/usr/local/bin/exfiltrate` 本身可能被恶意利用。

**利用方式：**

1.  **认证：** 攻击者需要拥有一个有效的 Jenkins 用户账号。
2.  **构造Payload：** 攻击者构造包含恶意代码的 XML 格式的 Payload，利用 XStream 反序列化漏洞执行命令。这个 Payload 通常会被嵌入到 Job 的配置中。
3.  **发送请求：** 攻击者将构造好的 Payload 发送到 Jenkins 的 API 接口（如创建 Job 的接口）。
4.  **触发执行：** Jenkins 解析 XML 数据时，会由于 XStream 的反序列化漏洞执行 Payload 中包含的恶意代码，从而导致远程代码执行。
5.  **代码分析:** 漏洞利用代码首先获取 Jenkins 的 crumb 用于绕过 CSRF 保护，然后构造包含恶意命令的 XML 格式 Job 配置，通过 createItem API 创建 Job，并触发 Job 执行。Job 执行后，会不断监控执行结果，并将结果输出到控制台。

**项目地址:** [gonn4cry/CVE-2016-0792](https://github.com/gonn4cry/CVE-2016-0792)

**漏洞详情:** [CVE-2016-0792](https://nvd.nist.gov/vuln/detail/CVE-2016-0792)

---

## POC #3

**来源**: [CVE-2016-0792-jpiechowka_jenkins-cve-2016-0792.md](../2016/CVE-2016-0792-jpiechowka_jenkins-cve-2016-0792.md)

## CVE-2016-0792 Jenkins XStream Groovy classpath Deserialization

**漏洞编号:** CVE-2016-0792

**漏洞类型:** 反序列化漏洞

**影响应用:** Jenkins

**危害等级:** 高危，允许远程代码执行

**影响版本:** Jenkins < 1.650; Jenkins LTS < 1.642.2

**利用条件:** 需要身份验证才能利用，但某些API端点可能不需要严格的权限控制

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-0792 是一个存在于 Jenkins 1.650 之前版本和 Jenkins LTS 1.642.2 之前版本的反序列化漏洞。攻击者可以通过在 XML 文件中构造恶意序列化数据，利用 XStream 和 groovy.util.Expando 组件，实现在 Jenkins 服务器上执行任意代码。根据提供的搜索引擎结果，该漏洞已被广泛研究，并且存在可用的 Metasploit 模块（链接：https://www.rapid7.com/db/modules/exploit/multi/http/jenkins_xstream_deserialize/ 和 https://www.exploit-db.com/exploits/43375）。漏洞利用代码中的 exploit.py 文件展示了如何通过 POST 请求将包含恶意 payload 的 XML 数据发送到 Jenkins 服务器的 createItem API 端点，从而触发漏洞。

**有效性：**
提供的 POC 代码看起来有效，因为它利用了已知的 Jenkins 反序列化漏洞，并尝试通过构造恶意 XML payload 来执行命令。代码包括版本检查，并尝试通过 /createItem 端点发送 payload。如果 Jenkins 服务器的版本低于指定版本，且用户具有创建项目的权限，则漏洞利用很可能成功。

**投毒风险：**
在提供的 LICENSE 文件中，作者声明不对软件造成的任何损害负责，这是一个标准的免责声明。 README.md 文件提供了漏洞信息和使用方法，包括免责声明。 exploit.py 文件本身只包含漏洞利用代码，没有明显的投毒行为。 prepare_payload.py 没有给出, 无法判断。
代码审核未发现任何尝试在目标系统上安装后门或执行恶意操作的痕迹，代码的主要目的是利用反序列化漏洞执行指定的命令。因此，此代码存储库中存在作者隐藏的投毒代码的可能性较低，判断投毒风险为0%。

**利用方式：**
1.  **身份验证：** 虽然漏洞描述指出需要经过身份验证的用户，但某些 API 端点可能不需要严格的权限验证。
2.  **版本检测：** 利用代码首先检测 Jenkins 的版本，确保目标版本存在漏洞。
3.  **Payload 构造：** 使用 prepare_payload() 函数构造恶意的 XML payload，其中包含要执行的命令。
4.  **POST 请求：** 将构造的 payload 通过 POST 请求发送到 Jenkins 服务器的 /createItem 端点。
5.  **远程代码执行：** 如果 payload 成功反序列化，将会在 Jenkins 服务器上执行指定的命令。

总而言之，CVE-2016-0792 是一个严重的安全漏洞，攻击者可以利用它来完全控制受影响的 Jenkins 服务器。提供的 POC 代码看起来有效，且可以用于验证漏洞的存在并执行任意命令。但需要注意的是，未经授权的漏洞利用是违法的，应仅在授权的环境中进行测试。

**项目地址:** [jpiechowka/jenkins-cve-2016-0792](https://github.com/jpiechowka/jenkins-cve-2016-0792)

**漏洞详情:** [CVE-2016-0792](https://nvd.nist.gov/vuln/detail/CVE-2016-0792)

---



---

## POC #2

**来源**: [CVE-2016-0792-gonn4cry_CVE-2016-0792.md](../2016/CVE-2016-0792-gonn4cry_CVE-2016-0792.md)

## CVE-2016-0792-Jenkins-远程代码执行

**漏洞编号:** CVE-2016-0792

**漏洞类型:** 反序列化漏洞

**影响应用:** Jenkins

**危害等级:** 高危，允许远程认证用户执行任意代码

**影响版本:** Jenkins < 1.650 和 LTS < 1.642.2

**利用条件:** 需要Jenkins实例可访问，并且攻击者需要拥有Jenkins的认证用户权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-0792 漏洞是 Jenkins 中一个严重的反序列化漏洞，存在于 Jenkins 1.650 之前和 LTS 1.642.2 之前的版本中。该漏洞位于多个未指定的 API 接口，允许远程认证用户通过 XML 文件中的序列化数据执行任意代码。该漏洞与 XStream 和 groovy.util.Expando 相关。

**有效性：**

根据漏洞描述和搜索结果，提供的 POC 代码似乎是有效的。搜索结果中包含了 Metasploit 模块，表明存在可利用的漏洞利用。

**投毒风险：**

代码本身的功能是创建一个 Jenkins Job，然后触发执行。Job的内容执行一个名为`/usr/local/bin/exfiltrate`的命令，并将输出结果重定向到`exfiltrate_output.log`。该脚本会循环检查这个命令的进程状态，输出，文件系统变更和exfiltration server 响应，最后会输出`exfiltrate_output.log` 的内容。该脚本中`exfiltrate` 命令并没有提供, 这意味着漏洞使用者需要自行构造该命令，存在一定的风险，

总体来看，该 POC 代码本身存在投毒风险较低，但需要警惕执行的命令 `/usr/local/bin/exfiltrate` 本身可能被恶意利用。

**利用方式：**

1.  **认证：** 攻击者需要拥有一个有效的 Jenkins 用户账号。
2.  **构造Payload：** 攻击者构造包含恶意代码的 XML 格式的 Payload，利用 XStream 反序列化漏洞执行命令。这个 Payload 通常会被嵌入到 Job 的配置中。
3.  **发送请求：** 攻击者将构造好的 Payload 发送到 Jenkins 的 API 接口（如创建 Job 的接口）。
4.  **触发执行：** Jenkins 解析 XML 数据时，会由于 XStream 的反序列化漏洞执行 Payload 中包含的恶意代码，从而导致远程代码执行。
5.  **代码分析:** 漏洞利用代码首先获取 Jenkins 的 crumb 用于绕过 CSRF 保护，然后构造包含恶意命令的 XML 格式 Job 配置，通过 createItem API 创建 Job，并触发 Job 执行。Job 执行后，会不断监控执行结果，并将结果输出到控制台。

**项目地址:** [gonn4cry/CVE-2016-0792](https://github.com/gonn4cry/CVE-2016-0792)

**漏洞详情:** [CVE-2016-0792](https://nvd.nist.gov/vuln/detail/CVE-2016-0792)

---

## POC #3

**来源**: [CVE-2016-0792-jpiechowka_jenkins-cve-2016-0792.md](../2016/CVE-2016-0792-jpiechowka_jenkins-cve-2016-0792.md)

## CVE-2016-0792 Jenkins XStream Groovy classpath Deserialization

**漏洞编号:** CVE-2016-0792

**漏洞类型:** 反序列化漏洞

**影响应用:** Jenkins

**危害等级:** 高危，允许远程代码执行

**影响版本:** Jenkins < 1.650; Jenkins LTS < 1.642.2

**利用条件:** 需要身份验证才能利用，但某些API端点可能不需要严格的权限控制

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-0792 是一个存在于 Jenkins 1.650 之前版本和 Jenkins LTS 1.642.2 之前版本的反序列化漏洞。攻击者可以通过在 XML 文件中构造恶意序列化数据，利用 XStream 和 groovy.util.Expando 组件，实现在 Jenkins 服务器上执行任意代码。根据提供的搜索引擎结果，该漏洞已被广泛研究，并且存在可用的 Metasploit 模块（链接：https://www.rapid7.com/db/modules/exploit/multi/http/jenkins_xstream_deserialize/ 和 https://www.exploit-db.com/exploits/43375）。漏洞利用代码中的 exploit.py 文件展示了如何通过 POST 请求将包含恶意 payload 的 XML 数据发送到 Jenkins 服务器的 createItem API 端点，从而触发漏洞。

**有效性：**
提供的 POC 代码看起来有效，因为它利用了已知的 Jenkins 反序列化漏洞，并尝试通过构造恶意 XML payload 来执行命令。代码包括版本检查，并尝试通过 /createItem 端点发送 payload。如果 Jenkins 服务器的版本低于指定版本，且用户具有创建项目的权限，则漏洞利用很可能成功。

**投毒风险：**
在提供的 LICENSE 文件中，作者声明不对软件造成的任何损害负责，这是一个标准的免责声明。 README.md 文件提供了漏洞信息和使用方法，包括免责声明。 exploit.py 文件本身只包含漏洞利用代码，没有明显的投毒行为。 prepare_payload.py 没有给出, 无法判断。
代码审核未发现任何尝试在目标系统上安装后门或执行恶意操作的痕迹，代码的主要目的是利用反序列化漏洞执行指定的命令。因此，此代码存储库中存在作者隐藏的投毒代码的可能性较低，判断投毒风险为0%。

**利用方式：**
1.  **身份验证：** 虽然漏洞描述指出需要经过身份验证的用户，但某些 API 端点可能不需要严格的权限验证。
2.  **版本检测：** 利用代码首先检测 Jenkins 的版本，确保目标版本存在漏洞。
3.  **Payload 构造：** 使用 prepare_payload() 函数构造恶意的 XML payload，其中包含要执行的命令。
4.  **POST 请求：** 将构造的 payload 通过 POST 请求发送到 Jenkins 服务器的 /createItem 端点。
5.  **远程代码执行：** 如果 payload 成功反序列化，将会在 Jenkins 服务器上执行指定的命令。

总而言之，CVE-2016-0792 是一个严重的安全漏洞，攻击者可以利用它来完全控制受影响的 Jenkins 服务器。提供的 POC 代码看起来有效，且可以用于验证漏洞的存在并执行任意命令。但需要注意的是，未经授权的漏洞利用是违法的，应仅在授权的环境中进行测试。

**项目地址:** [jpiechowka/jenkins-cve-2016-0792](https://github.com/jpiechowka/jenkins-cve-2016-0792)

**漏洞详情:** [CVE-2016-0792](https://nvd.nist.gov/vuln/detail/CVE-2016-0792)

---



---

## POC #2

**来源**: [CVE-2016-0792-gonn4cry_CVE-2016-0792.md](../2016/CVE-2016-0792-gonn4cry_CVE-2016-0792.md)

## CVE-2016-0792-Jenkins-远程代码执行

**漏洞编号:** CVE-2016-0792

**漏洞类型:** 反序列化漏洞

**影响应用:** Jenkins

**危害等级:** 高危，允许远程认证用户执行任意代码

**影响版本:** Jenkins < 1.650 和 LTS < 1.642.2

**利用条件:** 需要Jenkins实例可访问，并且攻击者需要拥有Jenkins的认证用户权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-0792 漏洞是 Jenkins 中一个严重的反序列化漏洞，存在于 Jenkins 1.650 之前和 LTS 1.642.2 之前的版本中。该漏洞位于多个未指定的 API 接口，允许远程认证用户通过 XML 文件中的序列化数据执行任意代码。该漏洞与 XStream 和 groovy.util.Expando 相关。

**有效性：**

根据漏洞描述和搜索结果，提供的 POC 代码似乎是有效的。搜索结果中包含了 Metasploit 模块，表明存在可利用的漏洞利用。

**投毒风险：**

代码本身的功能是创建一个 Jenkins Job，然后触发执行。Job的内容执行一个名为`/usr/local/bin/exfiltrate`的命令，并将输出结果重定向到`exfiltrate_output.log`。该脚本会循环检查这个命令的进程状态，输出，文件系统变更和exfiltration server 响应，最后会输出`exfiltrate_output.log` 的内容。该脚本中`exfiltrate` 命令并没有提供, 这意味着漏洞使用者需要自行构造该命令，存在一定的风险，

总体来看，该 POC 代码本身存在投毒风险较低，但需要警惕执行的命令 `/usr/local/bin/exfiltrate` 本身可能被恶意利用。

**利用方式：**

1.  **认证：** 攻击者需要拥有一个有效的 Jenkins 用户账号。
2.  **构造Payload：** 攻击者构造包含恶意代码的 XML 格式的 Payload，利用 XStream 反序列化漏洞执行命令。这个 Payload 通常会被嵌入到 Job 的配置中。
3.  **发送请求：** 攻击者将构造好的 Payload 发送到 Jenkins 的 API 接口（如创建 Job 的接口）。
4.  **触发执行：** Jenkins 解析 XML 数据时，会由于 XStream 的反序列化漏洞执行 Payload 中包含的恶意代码，从而导致远程代码执行。
5.  **代码分析:** 漏洞利用代码首先获取 Jenkins 的 crumb 用于绕过 CSRF 保护，然后构造包含恶意命令的 XML 格式 Job 配置，通过 createItem API 创建 Job，并触发 Job 执行。Job 执行后，会不断监控执行结果，并将结果输出到控制台。

**项目地址:** [gonn4cry/CVE-2016-0792](https://github.com/gonn4cry/CVE-2016-0792)

**漏洞详情:** [CVE-2016-0792](https://nvd.nist.gov/vuln/detail/CVE-2016-0792)

---

## POC #3

**来源**: [CVE-2016-0792-jpiechowka_jenkins-cve-2016-0792.md](../2016/CVE-2016-0792-jpiechowka_jenkins-cve-2016-0792.md)

## CVE-2016-0792 Jenkins XStream Groovy classpath Deserialization

**漏洞编号:** CVE-2016-0792

**漏洞类型:** 反序列化漏洞

**影响应用:** Jenkins

**危害等级:** 高危，允许远程代码执行

**影响版本:** Jenkins < 1.650; Jenkins LTS < 1.642.2

**利用条件:** 需要身份验证才能利用，但某些API端点可能不需要严格的权限控制

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-0792 是一个存在于 Jenkins 1.650 之前版本和 Jenkins LTS 1.642.2 之前版本的反序列化漏洞。攻击者可以通过在 XML 文件中构造恶意序列化数据，利用 XStream 和 groovy.util.Expando 组件，实现在 Jenkins 服务器上执行任意代码。根据提供的搜索引擎结果，该漏洞已被广泛研究，并且存在可用的 Metasploit 模块（链接：https://www.rapid7.com/db/modules/exploit/multi/http/jenkins_xstream_deserialize/ 和 https://www.exploit-db.com/exploits/43375）。漏洞利用代码中的 exploit.py 文件展示了如何通过 POST 请求将包含恶意 payload 的 XML 数据发送到 Jenkins 服务器的 createItem API 端点，从而触发漏洞。

**有效性：**
提供的 POC 代码看起来有效，因为它利用了已知的 Jenkins 反序列化漏洞，并尝试通过构造恶意 XML payload 来执行命令。代码包括版本检查，并尝试通过 /createItem 端点发送 payload。如果 Jenkins 服务器的版本低于指定版本，且用户具有创建项目的权限，则漏洞利用很可能成功。

**投毒风险：**
在提供的 LICENSE 文件中，作者声明不对软件造成的任何损害负责，这是一个标准的免责声明。 README.md 文件提供了漏洞信息和使用方法，包括免责声明。 exploit.py 文件本身只包含漏洞利用代码，没有明显的投毒行为。 prepare_payload.py 没有给出, 无法判断。
代码审核未发现任何尝试在目标系统上安装后门或执行恶意操作的痕迹，代码的主要目的是利用反序列化漏洞执行指定的命令。因此，此代码存储库中存在作者隐藏的投毒代码的可能性较低，判断投毒风险为0%。

**利用方式：**
1.  **身份验证：** 虽然漏洞描述指出需要经过身份验证的用户，但某些 API 端点可能不需要严格的权限验证。
2.  **版本检测：** 利用代码首先检测 Jenkins 的版本，确保目标版本存在漏洞。
3.  **Payload 构造：** 使用 prepare_payload() 函数构造恶意的 XML payload，其中包含要执行的命令。
4.  **POST 请求：** 将构造的 payload 通过 POST 请求发送到 Jenkins 服务器的 /createItem 端点。
5.  **远程代码执行：** 如果 payload 成功反序列化，将会在 Jenkins 服务器上执行指定的命令。

总而言之，CVE-2016-0792 是一个严重的安全漏洞，攻击者可以利用它来完全控制受影响的 Jenkins 服务器。提供的 POC 代码看起来有效，且可以用于验证漏洞的存在并执行任意命令。但需要注意的是，未经授权的漏洞利用是违法的，应仅在授权的环境中进行测试。

**项目地址:** [jpiechowka/jenkins-cve-2016-0792](https://github.com/jpiechowka/jenkins-cve-2016-0792)

**漏洞详情:** [CVE-2016-0792](https://nvd.nist.gov/vuln/detail/CVE-2016-0792)

---



---

## POC #2

**来源**: [CVE-2016-0792-gonn4cry_CVE-2016-0792.md](../2016/CVE-2016-0792-gonn4cry_CVE-2016-0792.md)

## CVE-2016-0792-Jenkins-远程代码执行

**漏洞编号:** CVE-2016-0792

**漏洞类型:** 反序列化漏洞

**影响应用:** Jenkins

**危害等级:** 高危，允许远程认证用户执行任意代码

**影响版本:** Jenkins < 1.650 和 LTS < 1.642.2

**利用条件:** 需要Jenkins实例可访问，并且攻击者需要拥有Jenkins的认证用户权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-0792 漏洞是 Jenkins 中一个严重的反序列化漏洞，存在于 Jenkins 1.650 之前和 LTS 1.642.2 之前的版本中。该漏洞位于多个未指定的 API 接口，允许远程认证用户通过 XML 文件中的序列化数据执行任意代码。该漏洞与 XStream 和 groovy.util.Expando 相关。

**有效性：**

根据漏洞描述和搜索结果，提供的 POC 代码似乎是有效的。搜索结果中包含了 Metasploit 模块，表明存在可利用的漏洞利用。

**投毒风险：**

代码本身的功能是创建一个 Jenkins Job，然后触发执行。Job的内容执行一个名为`/usr/local/bin/exfiltrate`的命令，并将输出结果重定向到`exfiltrate_output.log`。该脚本会循环检查这个命令的进程状态，输出，文件系统变更和exfiltration server 响应，最后会输出`exfiltrate_output.log` 的内容。该脚本中`exfiltrate` 命令并没有提供, 这意味着漏洞使用者需要自行构造该命令，存在一定的风险，

总体来看，该 POC 代码本身存在投毒风险较低，但需要警惕执行的命令 `/usr/local/bin/exfiltrate` 本身可能被恶意利用。

**利用方式：**

1.  **认证：** 攻击者需要拥有一个有效的 Jenkins 用户账号。
2.  **构造Payload：** 攻击者构造包含恶意代码的 XML 格式的 Payload，利用 XStream 反序列化漏洞执行命令。这个 Payload 通常会被嵌入到 Job 的配置中。
3.  **发送请求：** 攻击者将构造好的 Payload 发送到 Jenkins 的 API 接口（如创建 Job 的接口）。
4.  **触发执行：** Jenkins 解析 XML 数据时，会由于 XStream 的反序列化漏洞执行 Payload 中包含的恶意代码，从而导致远程代码执行。
5.  **代码分析:** 漏洞利用代码首先获取 Jenkins 的 crumb 用于绕过 CSRF 保护，然后构造包含恶意命令的 XML 格式 Job 配置，通过 createItem API 创建 Job，并触发 Job 执行。Job 执行后，会不断监控执行结果，并将结果输出到控制台。

**项目地址:** [gonn4cry/CVE-2016-0792](https://github.com/gonn4cry/CVE-2016-0792)

**漏洞详情:** [CVE-2016-0792](https://nvd.nist.gov/vuln/detail/CVE-2016-0792)

---

## POC #3

**来源**: [CVE-2016-0792-jpiechowka_jenkins-cve-2016-0792.md](../2016/CVE-2016-0792-jpiechowka_jenkins-cve-2016-0792.md)

## CVE-2016-0792 Jenkins XStream Groovy classpath Deserialization

**漏洞编号:** CVE-2016-0792

**漏洞类型:** 反序列化漏洞

**影响应用:** Jenkins

**危害等级:** 高危，允许远程代码执行

**影响版本:** Jenkins < 1.650; Jenkins LTS < 1.642.2

**利用条件:** 需要身份验证才能利用，但某些API端点可能不需要严格的权限控制

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-0792 是一个存在于 Jenkins 1.650 之前版本和 Jenkins LTS 1.642.2 之前版本的反序列化漏洞。攻击者可以通过在 XML 文件中构造恶意序列化数据，利用 XStream 和 groovy.util.Expando 组件，实现在 Jenkins 服务器上执行任意代码。根据提供的搜索引擎结果，该漏洞已被广泛研究，并且存在可用的 Metasploit 模块（链接：https://www.rapid7.com/db/modules/exploit/multi/http/jenkins_xstream_deserialize/ 和 https://www.exploit-db.com/exploits/43375）。漏洞利用代码中的 exploit.py 文件展示了如何通过 POST 请求将包含恶意 payload 的 XML 数据发送到 Jenkins 服务器的 createItem API 端点，从而触发漏洞。

**有效性：**
提供的 POC 代码看起来有效，因为它利用了已知的 Jenkins 反序列化漏洞，并尝试通过构造恶意 XML payload 来执行命令。代码包括版本检查，并尝试通过 /createItem 端点发送 payload。如果 Jenkins 服务器的版本低于指定版本，且用户具有创建项目的权限，则漏洞利用很可能成功。

**投毒风险：**
在提供的 LICENSE 文件中，作者声明不对软件造成的任何损害负责，这是一个标准的免责声明。 README.md 文件提供了漏洞信息和使用方法，包括免责声明。 exploit.py 文件本身只包含漏洞利用代码，没有明显的投毒行为。 prepare_payload.py 没有给出, 无法判断。
代码审核未发现任何尝试在目标系统上安装后门或执行恶意操作的痕迹，代码的主要目的是利用反序列化漏洞执行指定的命令。因此，此代码存储库中存在作者隐藏的投毒代码的可能性较低，判断投毒风险为0%。

**利用方式：**
1.  **身份验证：** 虽然漏洞描述指出需要经过身份验证的用户，但某些 API 端点可能不需要严格的权限验证。
2.  **版本检测：** 利用代码首先检测 Jenkins 的版本，确保目标版本存在漏洞。
3.  **Payload 构造：** 使用 prepare_payload() 函数构造恶意的 XML payload，其中包含要执行的命令。
4.  **POST 请求：** 将构造的 payload 通过 POST 请求发送到 Jenkins 服务器的 /createItem 端点。
5.  **远程代码执行：** 如果 payload 成功反序列化，将会在 Jenkins 服务器上执行指定的命令。

总而言之，CVE-2016-0792 是一个严重的安全漏洞，攻击者可以利用它来完全控制受影响的 Jenkins 服务器。提供的 POC 代码看起来有效，且可以用于验证漏洞的存在并执行任意命令。但需要注意的是，未经授权的漏洞利用是违法的，应仅在授权的环境中进行测试。

**项目地址:** [jpiechowka/jenkins-cve-2016-0792](https://github.com/jpiechowka/jenkins-cve-2016-0792)

**漏洞详情:** [CVE-2016-0792](https://nvd.nist.gov/vuln/detail/CVE-2016-0792)

---

