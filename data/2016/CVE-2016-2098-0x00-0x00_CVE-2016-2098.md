# CVE-2016-2098

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-2098-0x00-0x00_CVE-2016-2098.md](../2016/CVE-2016-2098-0x00-0x00_CVE-2016-2098.md)

# CVE-2016-2098

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-2098-0x00-0x00_CVE-2016-2098.md](../2016/CVE-2016-2098-0x00-0x00_CVE-2016-2098.md)

# CVE-2016-2098

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-2098-0x00-0x00_CVE-2016-2098.md](../2016/CVE-2016-2098-0x00-0x00_CVE-2016-2098.md)

# CVE-2016-2098

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-2098-0x00-0x00_CVE-2016-2098.md](../2016/CVE-2016-2098-0x00-0x00_CVE-2016-2098.md)

# CVE-2016-2098

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-2098-0x00-0x00_CVE-2016-2098.md](../2016/CVE-2016-2098-0x00-0x00_CVE-2016-2098.md)

# CVE-2016-2098

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-2098-0x00-0x00_CVE-2016-2098.md](../2016/CVE-2016-2098-0x00-0x00_CVE-2016-2098.md)

# CVE-2016-2098

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-2098-0x00-0x00_CVE-2016-2098.md](../2016/CVE-2016-2098-0x00-0x00_CVE-2016-2098.md)

# CVE-2016-2098

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-2098-0x00-0x00_CVE-2016-2098.md](../2016/CVE-2016-2098-0x00-0x00_CVE-2016-2098.md)

# CVE-2016-2098

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-2098-0x00-0x00_CVE-2016-2098.md](../2016/CVE-2016-2098-0x00-0x00_CVE-2016-2098.md)

# CVE-2016-2098

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-2098-0x00-0x00_CVE-2016-2098.md](../2016/CVE-2016-2098-0x00-0x00_CVE-2016-2098.md)

# CVE-2016-2098

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-2098-0x00-0x00_CVE-2016-2098.md](../2016/CVE-2016-2098-0x00-0x00_CVE-2016-2098.md)

# CVE-2016-2098

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-2098-3rg1s_CVE-2016-2098.md](../2016/CVE-2016-2098-3rg1s_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序必须易受攻击，并且允许通过 render 方法使用不受信任的输入。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098 允许远程攻击者通过利用应用程序对 `render` 方法的不受限制使用来执行任意 Ruby 代码。漏洞存在于 Action Pack 中。根据提供的漏洞利用代码 `main.py`，攻击者可以通过构造包含恶意 Ruby 代码的 URL 参数（`[inline]`）来触发漏洞。该代码通过发送带有内联代码的 GET 请求，然后提取并打印服务器的响应。`README.md` 文件提供了漏洞的基本信息和使用说明。通过分析漏洞利用代码，没有发现任何明显的投毒迹象。代码逻辑简单，主要功能是发送请求并解析响应。因此，投毒风险评估为0%。利用方式是通过精心构造的 GET 请求，将恶意 Ruby 代码注入到 `render` 方法中执行。攻击者可以通过控制 `args` 变量来指定要执行的 Ruby 代码。

**项目地址:** [3rg1s/CVE-2016-2098](https://github.com/3rg1s/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #2

**来源**: [CVE-2016-2098-Alejandro-MartinG_rails-PoC-CVE-2016-2098.md](../2016/CVE-2016-2098-Alejandro-MartinG_rails-PoC-CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 3.2.22.2之前, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序必须允许通过`render`方法处理用户提供的输入

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails 的 Action Pack 组件中，由于对`render`方法的使用方式不当，允许远程攻击者执行任意 Ruby 代码。攻击者通过向`render`方法传递恶意构造的输入，可执行服务器端代码。漏洞利用代码 (POC) 表明，攻击者可以通过控制渲染的内容来注入恶意代码。提供的`Gemfile`和`Gemfile.lock`是 Rails 项目的依赖描述文件，用于指定项目所依赖的 Ruby Gems 及其版本。这些文件本身没有直接包含恶意代码，但它们指定了存在漏洞的 Rails 版本 (4.2.5.1)。

**有效性:**
提供的POC代码 (实际上是 Rails 项目的依赖描述文件) 与漏洞描述中受影响的版本一致，因此，如果目标应用使用存在漏洞的 Rails 版本并且允许用户可控的输入传递给`render`方法，那么该漏洞可以被成功利用。

**投毒风险:**
`Gemfile` 和 `Gemfile.lock` 文件本身不包含可执行代码，因此直接的投毒风险较低。但是，如果攻击者能够控制应用程序使用的 Gems 仓库或者能够篡改应用程序使用的 Gems，则可能存在通过引入被篡改的 Gems 来投毒的风险。对这些依赖项的评估表明，其中不太可能存在直接的投毒代码。投毒风险评估为5%。

**利用方式:**
利用方式是向易受攻击的 Rails 应用发送包含恶意参数的请求，这些参数会被传递给`render`方法，从而执行攻击者指定的 Ruby 代码。 例如，攻击者可以构造一个包含恶意代码的字符串，并将其作为模板名称或局部变量传递给`render`方法。当 Rails 应用尝试渲染该模板或使用该局部变量时，恶意代码就会被执行。根据 exploit-db 的 40086 描述，可以使用 `render :inline` 来执行代码。

**项目地址:** [Alejandro-MartinG/rails-PoC-CVE-2016-2098](https://github.com/Alejandro-MartinG/rails-PoC-CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #3

**来源**: [CVE-2016-2098-CyberDefenseInstitute_PoC_CVE-2016-2098_Rails42.md](../2016/CVE-2016-2098-CyberDefenseInstitute_PoC_CVE-2016-2098_Rails42.md)

## CVE-2016-2098-Ruby on Rails Action Pack RCE

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，允许远程攻击者执行任意Ruby代码

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序未使用安全的方式来处理render方法的用户输入

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-2098 漏洞是 Ruby on Rails Action Pack 中的一个远程代码执行漏洞。它允许远程攻击者通过利用应用程序对 `render` 方法的不受限制的使用来执行任意 Ruby 代码。

**漏洞分析：**

根据漏洞描述，漏洞的根源在于 Action Pack 组件在搜索用于渲染的模板时，处理用户提供的不可信输入的方式存在缺陷。如果应用程序将不可信的输入传递给 `render` 方法，攻击者可以构造恶意的输入来执行任意代码。

**POC 代码分析：**

提供的 POC 代码是 `Gemfile` 和 `Gemfile.lock` 文件，它们用于定义和锁定 Ruby 项目的依赖项。`Gemfile` 指定了项目使用的 Rails 版本 (4.2.5.1)，以及其他 gem 依赖项。`Gemfile.lock` 文件则记录了项目中使用的 gem 的确切版本，用于确保一致的构建。

这些文件本身并不包含漏洞利用代码，它们只是 Rails 应用配置的一部分。实际的漏洞利用需要向存在漏洞的 `render` 方法传递恶意的参数。

**有效性评估：**

POC 代码的有效性取决于目标应用程序是否使用了存在漏洞的 Rails 版本，并且允许用户控制传递给 `render` 方法的参数。如果满足这些条件，则漏洞利用是有效的。

**投毒风险评估：**

检查 `Gemfile` 和 `Gemfile.lock` 文件中是否存在投毒代码，需要检查是否有恶意或未知的 gem 依赖。当前提供的代码中，没有发现明显的投毒迹象。使用了常见的Rails版本和相关的gem包,例如 `rails`, `sqlite3`, `sass-rails`等。 但是，无法完全排除作者在其他地方添加恶意代码的可能性，例如在 `app` 目录下的 controller 或 view 文件中。

由于仅仅通过 `Gemfile` 和 `Gemfile.lock` 文件无法进行全面的代码审计，因此可以认为投毒风险非常低，约为1%。

**利用方式：**

1.  **找到易受攻击的 `render` 方法：** 确定应用程序中哪些地方使用了 `render` 方法，并且用户可以控制传递给 `render` 方法的参数。
2.  **构造恶意输入：** 构造包含恶意 Ruby 代码的输入字符串。例如，攻击者可以使用诸如 `<%= system('whoami') %>` 之类的代码来执行系统命令。
3.  **将恶意输入传递给 `render` 方法：** 将构造的恶意输入作为参数传递给 `render` 方法。这将导致应用程序执行恶意代码。

**总结：**

CVE-2016-2098 是一个严重的远程代码执行漏洞，需要及时修补。应用程序开发人员应该避免将不受信任的用户输入传递给 `render` 方法，并使用最新版本的 Rails 以获得安全修复。

**项目地址:** [CyberDefenseInstitute/PoC_CVE-2016-2098_Rails42](https://github.com/CyberDefenseInstitute/PoC_CVE-2016-2098_Rails42)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #4

**来源**: [CVE-2016-2098-DanielHemmati_CVE-2016-2098-my-first-exploit.md](../2016/CVE-2016-2098-DanielHemmati_CVE-2016-2098-my-first-exploit.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.x (< 3.2.22.2), 4.x (< 4.1.14.2), 4.2.x (< 4.2.5.2)

**利用条件:** 应用程序使用了`render`方法处理用户提供的不可信数据。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails 的 Action Pack 组件中，由于程序在处理`render`方法时未对用户输入进行充分的过滤和验证，导致远程攻击者可以执行任意 Ruby 代码。根据漏洞描述和搜索结果，攻击者可以通过构造特定的参数传递给`render`方法，从而执行恶意代码。

**有效性分析：**
提供的 Python 脚本`exploit.py` 旨在利用该漏洞。脚本允许用户指定目标 URL 和 payload。它将 payload 嵌入到 URL 中，并将其发送到目标应用程序。如果应用程序易受攻击，则会执行 payload 中包含的 Ruby 代码。该POC的有效性取决于目标Rails应用程序是否容易受到攻击且未进行修补。根据漏洞描述，低版本的 Rails 应用存在此风险。

**投毒风险分析：**
查看提供的 Python 脚本 `exploit.py` 和 `README.md`。`README.md` 文件只包含有关漏洞和脚本使用方法的描述，没有发现任何可疑代码。`exploit.py` 脚本的功能是构造和发送包含 payload 的 HTTP 请求，看起来相对简单直接。虽然脚本本身的功能是为了利用漏洞，但没有发现明显的后门或恶意代码。它接受用户提供的 payload 并将其发送到目标，因此恶意代码更有可能通过用户提供的 payload 注入到目标系统，而不是通过脚本本身进行投毒。因此，脚本本身的投毒风险较低，但使用时仍需谨慎，确保理解所执行的 payload 的含义。

**利用方式分析：**
1.  **确定目标：** 找到运行存在漏洞版本的 Ruby on Rails 应用程序。
2.  **构造 Payload：** 构建恶意的 Ruby 代码，例如执行系统命令。
3.  **发送请求：** 使用漏洞利用代码（或手动构造 HTTP 请求）将 payload 传递给应用程序的`render`方法，例如通过 URL 参数 `[inline]`。
4.  **执行代码：** 如果应用程序易受攻击，服务器将执行 payload 中的 Ruby 代码。

**示例：**
`python3 exploit.py -H "http://example.com/page?id=1"`
然后输入 payload: `system('whoami')` 。
如果成功，服务器会执行 `whoami` 命令，并将结果返回到攻击者。

综上所述，该漏洞的利用方式主要是通过操纵 `render` 方法的参数，注入恶意的 Ruby 代码，从而实现远程代码执行。该利用的有效性取决于目标应用程序的版本和配置。

**项目地址:** [DanielHemmati/CVE-2016-2098-my-first-exploit](https://github.com/DanielHemmati/CVE-2016-2098-my-first-exploit)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #5

**来源**: [CVE-2016-2098-Debalinax64_CVE-2016-2098.md](../2016/CVE-2016-2098-Debalinax64_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2 之前, 4.x 4.1.14.2 之前, 和 4.2.x 4.2.5.2 之前

**利用条件:** 目标应用使用了存在漏洞的Rails版本，并且应用程序允许使用render方法处理用户提供的输入。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails Action Pack 中，由于其 render 方法对用户输入未做严格限制，导致远程攻击者可以利用此漏洞执行任意 Ruby 代码，从而完全控制服务器。

**有效性：**
提供的POC代码是有效的。漏洞库信息，搜索引擎结果以及利用代码都表明可以通过`render`方法执行任意ruby代码。例如，可以使用`curl`发送包含恶意代码的请求，服务器会执行该代码。

**投毒风险：**
查看提供的 POC 代码 `/tmp/fb84a5f2be1c3ed581440d890e43983b/ruby-on-rail-RCE.sh`，该脚本主要功能是发送包含ruby代码的curl请求，执行用户指定的命令。脚本本身没有明显的恶意行为，例如反弹shell或下载其他恶意文件。因此，投毒风险较低，但考虑到脚本的执行环境和权限，以及可能被用于自动化攻击，存在一定风险。`/tmp/fb84a5f2be1c3ed581440d890e43983b/README.md`文件只是漏洞描述和使用说明，不存在投毒代码。总体评估风险比例为5%。

**利用方式：**
1.  攻击者需要找到一个使用了存在漏洞的Rails版本，并且允许使用render方法的应用程序。
2.  攻击者通过构造恶意的URL，将payload传递给`render`方法。 Payload形式是 `%3C%25=%20%25x('command')%20%25%3E`。 其中`command`参数是要在目标服务器上执行的命令。
3.  目标服务器在处理请求时，会执行该恶意Ruby代码，从而执行攻击者指定的命令。

**项目地址:** [Debalinax64/CVE-2016-2098](https://github.com/Debalinax64/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #6

**来源**: [CVE-2016-2098-JoseLRC97_Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution.md](../2016/CVE-2016-2098-JoseLRC97_Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution.md)

## CVE-2016-2098-Ruby on Rails Action Pack-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2之前, 4.x版本4.1.14.2之前, 4.2.x版本4.2.5.2之前

**利用条件:** 应用程序使用了`render`方法并且允许用户控制输入

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞。该漏洞源于应用程序对`render`方法的不受限制的使用。如果应用程序允许用户控制传递给`render`方法的参数，攻击者可以利用此漏洞执行任意Ruby代码。

**有效性：**
漏洞库信息和搜索引擎结果都确认了此漏洞的存在和严重性。Exploit-DB上存在相关的漏洞利用代码（https://www.exploit-db.com/exploits/40086/），进一步验证了漏洞的可利用性。

**投毒风险：**
提供的漏洞利用代码片段只是GNU通用公共许可证，并非漏洞的实际利用代码。因此，无法从中判断是否存在投毒风险。需要进一步分析实际的漏洞利用代码才能评估投毒风险。目前判断投毒风险为0%。

**利用方式：**
利用方式是，攻击者需要找到一个应用程序中使用了`render`方法并且允许用户控制输入的位置。然后，攻击者可以构造恶意的输入，例如包含Ruby代码的字符串，将其传递给`render`方法。`render`方法会执行该Ruby代码，从而导致远程代码执行。具体的payload取决于目标应用程序的上下文，但通常可以用于执行系统命令、读取敏感文件或在服务器上安装后门。

**项目地址:** [JoseLRC97/Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution](https://github.com/JoseLRC97/Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #7

**来源**: [CVE-2016-2098-Shakun8_CVE-2016-2098.md](../2016/CVE-2016-2098-Shakun8_CVE-2016-2098.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 目标应用使用了存在漏洞的Rails版本，且允许通过URL参数控制render方法。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞，源于对`render`方法的不受限制的使用。攻击者可以通过构造恶意的URL参数，将Ruby代码注入到`render`方法中执行，从而获得服务器的控制权。

**有效性：**
提供的POC代码`CVE-2016-2098.py`看起来是有效的。它使用`requests`库发送带有恶意参数的GET请求，其中参数值包含要执行的Ruby代码。Payload 构造的核心在于 `#{sys.argv[3]}[inline]=%3C%25=%20%25x({cmd})%20%25%3E` ，这部分代码将命令插入到ERB模板中，利用Rails的render方法执行任意代码。

**投毒风险：**
提供的漏洞利用代码中没有发现明显的投毒代码。该脚本的主要功能是发送包含恶意payload的HTTP请求，并打印响应结果。`README.md`文件仅包含漏洞名称和POC描述，没有可疑内容。因此，投毒风险较低，为0%。

**利用方式：**
1.  **确定目标应用是否使用了存在漏洞的Rails版本。**
2.  **构造包含恶意Ruby代码的URL参数。** 例如，使用提供的POC脚本：
    `python CVE-2016-2098.py 'system("whoami")' 'http://target.com/controller/action' 'payload'`
    这个命令会在目标服务器上执行`whoami`命令，并将结果返回。
3.  **发送包含恶意参数的HTTP请求。**
4.  **分析响应结果，确认代码是否成功执行。**

攻击者可以利用此漏洞执行任意系统命令，读取敏感文件，甚至完全控制服务器。修复此漏洞的方法是升级到受影响Rails版本以上的版本，或者限制对render方法的使用。

**项目地址:** [Shakun8/CVE-2016-2098](https://github.com/Shakun8/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #8

**来源**: [CVE-2016-2098-hderms_dh-CVE_2016_2098.md](../2016/CVE-2016-2098-hderms_dh-CVE_2016_2098.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，允许远程攻击者执行任意 Ruby 代码

**影响版本:** < 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序需要允许用户控制的输入传递给 render 方法

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-2098 存在于 Ruby on Rails 的 Action Pack 中，由于对 `render` 方法的使用未加限制，允许远程攻击者执行任意 Ruby 代码。根据漏洞信息，受影响的版本包括 3.2.22.2 之前的 3.x 版本、4.1.14.2 之前的 4.x 版本，以及 4.2.5.2 之前的 4.2.x 版本。

**漏洞利用方式：**
攻击者可以通过构造恶意的输入，将其传递给 `render` 方法，从而执行任意 Ruby 代码。这通常涉及到控制传递给 `render` 方法的模板名称或选项。根据搜索结果和漏洞库信息，漏洞的核心在于应用程序未能正确地过滤或转义用户提供的输入，直接将其用于渲染过程。

**POC 代码分析：**
提供的 POC 代码包含 `Gemfile` 和 `Gemfile.lock`。这些文件定义了 Ruby on Rails 应用的依赖。`Gemfile` 指定了 Rails 版本为 4.2.4，这属于受影响的版本范围。`Gemfile.lock` 锁定了具体的依赖版本，确保应用在不同环境中依赖的一致性。这些文件本身不包含直接的攻击代码，它们只是一个 Rails 应用的依赖描述文件，用于搭建易受攻击的环境。

**投毒风险分析：**
分析 `Gemfile` 和 `Gemfile.lock`，虽然没有明显的恶意代码，但依旧存在一定的投毒风险。攻击者可能通过修改 `Gemfile`，引入包含恶意代码的 gem 包。或者，虽然当前依赖没有问题，但未来依赖更新时，可能会引入包含漏洞或后门的 gem 包。当然，在提供的两个文件中，并没有发现后门或者漏洞代码，风险主要在于构建环境和引入存在风险的三方包。因此，投毒风险估计为 10%。

**项目地址:** [hderms/dh-CVE_2016_2098](https://github.com/hderms/dh-CVE_2016_2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #9

**来源**: [CVE-2016-2098-its-arun_CVE-2016-2098.md](../2016/CVE-2016-2098-its-arun_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，允许攻击者执行任意Ruby代码

**影响版本:** 3.2.22.2之前, 4.x 4.1.14.2之前, 和 4.2.x 4.2.5.2之前

**利用条件:** 目标应用使用了存在漏洞的Rails版本，且`render`方法以不安全的方式处理用户输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞。该漏洞源于对`render`方法的不安全使用，允许远程攻击者通过操纵用户提供的数据来执行任意Ruby代码。

**有效性：**

提供的POC代码利用了这一漏洞。通过向易受攻击的Rails应用发送特制的HTTP请求，攻击者可以在服务器上执行任意命令。

**投毒风险：**

代码本身的功能就是利用漏洞执行命令，没有发现恶意添加的额外功能代码。但是，下载和使用任何未经审查的漏洞利用代码都存在风险。POC代码的设计目标是利用漏洞，而攻击者可以修改这些POC代码以包含恶意功能，例如安装后门、窃取数据或进行其他恶意活动。
`README.md` 文件描述了漏洞和基本用法，未发现恶意代码。
`CVE-2016-2098.sh` 脚本相对简单，主要功能是构造恶意请求以利用漏洞。虽然脚本本身没有明显的恶意代码，但用户应始终谨慎审查并理解任何下载的代码。

**利用方式：**

1.  **确定目标:** 识别运行易受攻击的Ruby on Rails版本的Web应用程序。
2.  **构造Payload:** 使用POC脚本，构造包含要执行的Ruby代码的HTTP请求。此代码将作为`render`方法的参数传递。
3.  **发送Payload:** 将构造的HTTP请求发送到目标Web应用程序。
4.  **执行代码:** 如果目标应用程序易受攻击，服务器将执行嵌入在Payload中的Ruby代码。

脚本的工作方式是：

*   它接受三个参数：目标主机、URI 和要执行的命令。
*   它使用 `curl` 命令发送一个包含恶意 payload 的 HTTP 请求到目标服务器。Payload 利用 Rails `render` 方法执行任意命令。
*   它提供一个简单的交互式 shell，允许攻击者重复执行命令。

**项目地址:** [its-arun/CVE-2016-2098](https://github.com/its-arun/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #10

**来源**: [CVE-2016-2098-j4k0m_CVE-2016-2098.md](../2016/CVE-2016-2098-j4k0m_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails (Action Pack)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2之前, 4.x版本在4.1.14.2之前, 4.2.x版本在4.2.5.2之前

**利用条件:** 应用程序必须允许通过`render`方法处理用户提供的输入。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-2098 是一个 Ruby on Rails Action Pack 中的远程代码执行漏洞。攻击者可以通过向`render`方法提供恶意构造的输入来执行任意 Ruby 代码。  根据漏洞描述，漏洞根源在于Rails的`render`方法对用户输入的不当处理。POC 利用方式是通过`view[inline]`参数传递 Ruby 代码，该代码会被服务器执行。具体来说，POC 使用了 `<%= %x('[CMD]') %>` 这样的 Ruby 代码结构，其中 `[CMD]` 会被替换成想要执行的系统命令。例如，`<%= %x('whoami') %>` 会执行 `whoami` 命令，并将其输出显示在页面上。  利用步骤： 1. 确定目标 Rails 应用使用的 Rails 版本在受影响范围内。 2. 构造包含恶意 Ruby 代码的 URL，例如 `http://example.com/?view[inline]=<%= %x('whoami') %>` （需要 URL 编码）。 3. 将构造的 URL 发送到目标服务器。 4. 如果服务器存在漏洞，则会执行恶意代码，并将结果返回给攻击者。  投毒风险较低，主要因为 POC 代码的功能明确，目的是执行用户指定的命令。虽然攻击者可以利用该漏洞执行任何命令，但提供的 POC 本身不包含任何隐藏的恶意功能。 投毒的可能来自于下载后使用者更改后门,但原始版本后门概率极低。

**项目地址:** [j4k0m/CVE-2016-2098](https://github.com/j4k0m/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #11

**来源**: [CVE-2016-2098-sealldeveloper_CVE-2016-2098-PoC.md](../2016/CVE-2016-2098-sealldeveloper_CVE-2016-2098-PoC.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 3.2.22.2之前, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用使用了render方法并且允许用户可控的输入作为render方法的参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098 漏洞是 Ruby on Rails Action Pack 中由于不安全地使用 `render` 方法导致的远程代码执行漏洞。攻击者可以通过提供恶意构造的输入数据作为 `render` 方法的参数，从而执行任意 Ruby 代码。漏洞利用方式：

1.  **漏洞触发点：** 应用的某个功能使用了`render`方法，并且允许用户输入来决定渲染的内容。
2.  **攻击向量：** 攻击者构造包含恶意 Ruby 代码的字符串，并将其作为参数传递给 `render` 方法。
3.  **代码执行：** 由于 Rails 在处理 `render` 方法时，没有充分验证用户输入，导致恶意代码被执行。

**有效性：** 根据漏洞描述和搜索结果，此漏洞的POC已经公开，并且可以被利用。

**投毒风险：** 提供的漏洞利用代码只是一个LICENSE文件，无法评估是否存在投毒行为。即使有公开的POC存在，下载和使用任何第三方提供的代码都应该谨慎，并在安全的环境中进行测试。

**项目地址:** [sealldeveloper/CVE-2016-2098-PoC](https://github.com/sealldeveloper/CVE-2016-2098-PoC)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---



---

## POC #2

**来源**: [CVE-2016-2098-3rg1s_CVE-2016-2098.md](../2016/CVE-2016-2098-3rg1s_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序必须易受攻击，并且允许通过 render 方法使用不受信任的输入。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098 允许远程攻击者通过利用应用程序对 `render` 方法的不受限制使用来执行任意 Ruby 代码。漏洞存在于 Action Pack 中。根据提供的漏洞利用代码 `main.py`，攻击者可以通过构造包含恶意 Ruby 代码的 URL 参数（`[inline]`）来触发漏洞。该代码通过发送带有内联代码的 GET 请求，然后提取并打印服务器的响应。`README.md` 文件提供了漏洞的基本信息和使用说明。通过分析漏洞利用代码，没有发现任何明显的投毒迹象。代码逻辑简单，主要功能是发送请求并解析响应。因此，投毒风险评估为0%。利用方式是通过精心构造的 GET 请求，将恶意 Ruby 代码注入到 `render` 方法中执行。攻击者可以通过控制 `args` 变量来指定要执行的 Ruby 代码。

**项目地址:** [3rg1s/CVE-2016-2098](https://github.com/3rg1s/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #3

**来源**: [CVE-2016-2098-Alejandro-MartinG_rails-PoC-CVE-2016-2098.md](../2016/CVE-2016-2098-Alejandro-MartinG_rails-PoC-CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 3.2.22.2之前, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序必须允许通过`render`方法处理用户提供的输入

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails 的 Action Pack 组件中，由于对`render`方法的使用方式不当，允许远程攻击者执行任意 Ruby 代码。攻击者通过向`render`方法传递恶意构造的输入，可执行服务器端代码。漏洞利用代码 (POC) 表明，攻击者可以通过控制渲染的内容来注入恶意代码。提供的`Gemfile`和`Gemfile.lock`是 Rails 项目的依赖描述文件，用于指定项目所依赖的 Ruby Gems 及其版本。这些文件本身没有直接包含恶意代码，但它们指定了存在漏洞的 Rails 版本 (4.2.5.1)。

**有效性:**
提供的POC代码 (实际上是 Rails 项目的依赖描述文件) 与漏洞描述中受影响的版本一致，因此，如果目标应用使用存在漏洞的 Rails 版本并且允许用户可控的输入传递给`render`方法，那么该漏洞可以被成功利用。

**投毒风险:**
`Gemfile` 和 `Gemfile.lock` 文件本身不包含可执行代码，因此直接的投毒风险较低。但是，如果攻击者能够控制应用程序使用的 Gems 仓库或者能够篡改应用程序使用的 Gems，则可能存在通过引入被篡改的 Gems 来投毒的风险。对这些依赖项的评估表明，其中不太可能存在直接的投毒代码。投毒风险评估为5%。

**利用方式:**
利用方式是向易受攻击的 Rails 应用发送包含恶意参数的请求，这些参数会被传递给`render`方法，从而执行攻击者指定的 Ruby 代码。 例如，攻击者可以构造一个包含恶意代码的字符串，并将其作为模板名称或局部变量传递给`render`方法。当 Rails 应用尝试渲染该模板或使用该局部变量时，恶意代码就会被执行。根据 exploit-db 的 40086 描述，可以使用 `render :inline` 来执行代码。

**项目地址:** [Alejandro-MartinG/rails-PoC-CVE-2016-2098](https://github.com/Alejandro-MartinG/rails-PoC-CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #4

**来源**: [CVE-2016-2098-CyberDefenseInstitute_PoC_CVE-2016-2098_Rails42.md](../2016/CVE-2016-2098-CyberDefenseInstitute_PoC_CVE-2016-2098_Rails42.md)

## CVE-2016-2098-Ruby on Rails Action Pack RCE

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，允许远程攻击者执行任意Ruby代码

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序未使用安全的方式来处理render方法的用户输入

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-2098 漏洞是 Ruby on Rails Action Pack 中的一个远程代码执行漏洞。它允许远程攻击者通过利用应用程序对 `render` 方法的不受限制的使用来执行任意 Ruby 代码。

**漏洞分析：**

根据漏洞描述，漏洞的根源在于 Action Pack 组件在搜索用于渲染的模板时，处理用户提供的不可信输入的方式存在缺陷。如果应用程序将不可信的输入传递给 `render` 方法，攻击者可以构造恶意的输入来执行任意代码。

**POC 代码分析：**

提供的 POC 代码是 `Gemfile` 和 `Gemfile.lock` 文件，它们用于定义和锁定 Ruby 项目的依赖项。`Gemfile` 指定了项目使用的 Rails 版本 (4.2.5.1)，以及其他 gem 依赖项。`Gemfile.lock` 文件则记录了项目中使用的 gem 的确切版本，用于确保一致的构建。

这些文件本身并不包含漏洞利用代码，它们只是 Rails 应用配置的一部分。实际的漏洞利用需要向存在漏洞的 `render` 方法传递恶意的参数。

**有效性评估：**

POC 代码的有效性取决于目标应用程序是否使用了存在漏洞的 Rails 版本，并且允许用户控制传递给 `render` 方法的参数。如果满足这些条件，则漏洞利用是有效的。

**投毒风险评估：**

检查 `Gemfile` 和 `Gemfile.lock` 文件中是否存在投毒代码，需要检查是否有恶意或未知的 gem 依赖。当前提供的代码中，没有发现明显的投毒迹象。使用了常见的Rails版本和相关的gem包,例如 `rails`, `sqlite3`, `sass-rails`等。 但是，无法完全排除作者在其他地方添加恶意代码的可能性，例如在 `app` 目录下的 controller 或 view 文件中。

由于仅仅通过 `Gemfile` 和 `Gemfile.lock` 文件无法进行全面的代码审计，因此可以认为投毒风险非常低，约为1%。

**利用方式：**

1.  **找到易受攻击的 `render` 方法：** 确定应用程序中哪些地方使用了 `render` 方法，并且用户可以控制传递给 `render` 方法的参数。
2.  **构造恶意输入：** 构造包含恶意 Ruby 代码的输入字符串。例如，攻击者可以使用诸如 `<%= system('whoami') %>` 之类的代码来执行系统命令。
3.  **将恶意输入传递给 `render` 方法：** 将构造的恶意输入作为参数传递给 `render` 方法。这将导致应用程序执行恶意代码。

**总结：**

CVE-2016-2098 是一个严重的远程代码执行漏洞，需要及时修补。应用程序开发人员应该避免将不受信任的用户输入传递给 `render` 方法，并使用最新版本的 Rails 以获得安全修复。

**项目地址:** [CyberDefenseInstitute/PoC_CVE-2016-2098_Rails42](https://github.com/CyberDefenseInstitute/PoC_CVE-2016-2098_Rails42)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #5

**来源**: [CVE-2016-2098-DanielHemmati_CVE-2016-2098-my-first-exploit.md](../2016/CVE-2016-2098-DanielHemmati_CVE-2016-2098-my-first-exploit.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.x (< 3.2.22.2), 4.x (< 4.1.14.2), 4.2.x (< 4.2.5.2)

**利用条件:** 应用程序使用了`render`方法处理用户提供的不可信数据。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails 的 Action Pack 组件中，由于程序在处理`render`方法时未对用户输入进行充分的过滤和验证，导致远程攻击者可以执行任意 Ruby 代码。根据漏洞描述和搜索结果，攻击者可以通过构造特定的参数传递给`render`方法，从而执行恶意代码。

**有效性分析：**
提供的 Python 脚本`exploit.py` 旨在利用该漏洞。脚本允许用户指定目标 URL 和 payload。它将 payload 嵌入到 URL 中，并将其发送到目标应用程序。如果应用程序易受攻击，则会执行 payload 中包含的 Ruby 代码。该POC的有效性取决于目标Rails应用程序是否容易受到攻击且未进行修补。根据漏洞描述，低版本的 Rails 应用存在此风险。

**投毒风险分析：**
查看提供的 Python 脚本 `exploit.py` 和 `README.md`。`README.md` 文件只包含有关漏洞和脚本使用方法的描述，没有发现任何可疑代码。`exploit.py` 脚本的功能是构造和发送包含 payload 的 HTTP 请求，看起来相对简单直接。虽然脚本本身的功能是为了利用漏洞，但没有发现明显的后门或恶意代码。它接受用户提供的 payload 并将其发送到目标，因此恶意代码更有可能通过用户提供的 payload 注入到目标系统，而不是通过脚本本身进行投毒。因此，脚本本身的投毒风险较低，但使用时仍需谨慎，确保理解所执行的 payload 的含义。

**利用方式分析：**
1.  **确定目标：** 找到运行存在漏洞版本的 Ruby on Rails 应用程序。
2.  **构造 Payload：** 构建恶意的 Ruby 代码，例如执行系统命令。
3.  **发送请求：** 使用漏洞利用代码（或手动构造 HTTP 请求）将 payload 传递给应用程序的`render`方法，例如通过 URL 参数 `[inline]`。
4.  **执行代码：** 如果应用程序易受攻击，服务器将执行 payload 中的 Ruby 代码。

**示例：**
`python3 exploit.py -H "http://example.com/page?id=1"`
然后输入 payload: `system('whoami')` 。
如果成功，服务器会执行 `whoami` 命令，并将结果返回到攻击者。

综上所述，该漏洞的利用方式主要是通过操纵 `render` 方法的参数，注入恶意的 Ruby 代码，从而实现远程代码执行。该利用的有效性取决于目标应用程序的版本和配置。

**项目地址:** [DanielHemmati/CVE-2016-2098-my-first-exploit](https://github.com/DanielHemmati/CVE-2016-2098-my-first-exploit)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #6

**来源**: [CVE-2016-2098-Debalinax64_CVE-2016-2098.md](../2016/CVE-2016-2098-Debalinax64_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2 之前, 4.x 4.1.14.2 之前, 和 4.2.x 4.2.5.2 之前

**利用条件:** 目标应用使用了存在漏洞的Rails版本，并且应用程序允许使用render方法处理用户提供的输入。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails Action Pack 中，由于其 render 方法对用户输入未做严格限制，导致远程攻击者可以利用此漏洞执行任意 Ruby 代码，从而完全控制服务器。

**有效性：**
提供的POC代码是有效的。漏洞库信息，搜索引擎结果以及利用代码都表明可以通过`render`方法执行任意ruby代码。例如，可以使用`curl`发送包含恶意代码的请求，服务器会执行该代码。

**投毒风险：**
查看提供的 POC 代码 `/tmp/fb84a5f2be1c3ed581440d890e43983b/ruby-on-rail-RCE.sh`，该脚本主要功能是发送包含ruby代码的curl请求，执行用户指定的命令。脚本本身没有明显的恶意行为，例如反弹shell或下载其他恶意文件。因此，投毒风险较低，但考虑到脚本的执行环境和权限，以及可能被用于自动化攻击，存在一定风险。`/tmp/fb84a5f2be1c3ed581440d890e43983b/README.md`文件只是漏洞描述和使用说明，不存在投毒代码。总体评估风险比例为5%。

**利用方式：**
1.  攻击者需要找到一个使用了存在漏洞的Rails版本，并且允许使用render方法的应用程序。
2.  攻击者通过构造恶意的URL，将payload传递给`render`方法。 Payload形式是 `%3C%25=%20%25x('command')%20%25%3E`。 其中`command`参数是要在目标服务器上执行的命令。
3.  目标服务器在处理请求时，会执行该恶意Ruby代码，从而执行攻击者指定的命令。

**项目地址:** [Debalinax64/CVE-2016-2098](https://github.com/Debalinax64/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #7

**来源**: [CVE-2016-2098-JoseLRC97_Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution.md](../2016/CVE-2016-2098-JoseLRC97_Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution.md)

## CVE-2016-2098-Ruby on Rails Action Pack-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2之前, 4.x版本4.1.14.2之前, 4.2.x版本4.2.5.2之前

**利用条件:** 应用程序使用了`render`方法并且允许用户控制输入

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞。该漏洞源于应用程序对`render`方法的不受限制的使用。如果应用程序允许用户控制传递给`render`方法的参数，攻击者可以利用此漏洞执行任意Ruby代码。

**有效性：**
漏洞库信息和搜索引擎结果都确认了此漏洞的存在和严重性。Exploit-DB上存在相关的漏洞利用代码（https://www.exploit-db.com/exploits/40086/），进一步验证了漏洞的可利用性。

**投毒风险：**
提供的漏洞利用代码片段只是GNU通用公共许可证，并非漏洞的实际利用代码。因此，无法从中判断是否存在投毒风险。需要进一步分析实际的漏洞利用代码才能评估投毒风险。目前判断投毒风险为0%。

**利用方式：**
利用方式是，攻击者需要找到一个应用程序中使用了`render`方法并且允许用户控制输入的位置。然后，攻击者可以构造恶意的输入，例如包含Ruby代码的字符串，将其传递给`render`方法。`render`方法会执行该Ruby代码，从而导致远程代码执行。具体的payload取决于目标应用程序的上下文，但通常可以用于执行系统命令、读取敏感文件或在服务器上安装后门。

**项目地址:** [JoseLRC97/Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution](https://github.com/JoseLRC97/Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #8

**来源**: [CVE-2016-2098-Shakun8_CVE-2016-2098.md](../2016/CVE-2016-2098-Shakun8_CVE-2016-2098.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 目标应用使用了存在漏洞的Rails版本，且允许通过URL参数控制render方法。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞，源于对`render`方法的不受限制的使用。攻击者可以通过构造恶意的URL参数，将Ruby代码注入到`render`方法中执行，从而获得服务器的控制权。

**有效性：**
提供的POC代码`CVE-2016-2098.py`看起来是有效的。它使用`requests`库发送带有恶意参数的GET请求，其中参数值包含要执行的Ruby代码。Payload 构造的核心在于 `#{sys.argv[3]}[inline]=%3C%25=%20%25x({cmd})%20%25%3E` ，这部分代码将命令插入到ERB模板中，利用Rails的render方法执行任意代码。

**投毒风险：**
提供的漏洞利用代码中没有发现明显的投毒代码。该脚本的主要功能是发送包含恶意payload的HTTP请求，并打印响应结果。`README.md`文件仅包含漏洞名称和POC描述，没有可疑内容。因此，投毒风险较低，为0%。

**利用方式：**
1.  **确定目标应用是否使用了存在漏洞的Rails版本。**
2.  **构造包含恶意Ruby代码的URL参数。** 例如，使用提供的POC脚本：
    `python CVE-2016-2098.py 'system("whoami")' 'http://target.com/controller/action' 'payload'`
    这个命令会在目标服务器上执行`whoami`命令，并将结果返回。
3.  **发送包含恶意参数的HTTP请求。**
4.  **分析响应结果，确认代码是否成功执行。**

攻击者可以利用此漏洞执行任意系统命令，读取敏感文件，甚至完全控制服务器。修复此漏洞的方法是升级到受影响Rails版本以上的版本，或者限制对render方法的使用。

**项目地址:** [Shakun8/CVE-2016-2098](https://github.com/Shakun8/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #9

**来源**: [CVE-2016-2098-hderms_dh-CVE_2016_2098.md](../2016/CVE-2016-2098-hderms_dh-CVE_2016_2098.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，允许远程攻击者执行任意 Ruby 代码

**影响版本:** < 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序需要允许用户控制的输入传递给 render 方法

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-2098 存在于 Ruby on Rails 的 Action Pack 中，由于对 `render` 方法的使用未加限制，允许远程攻击者执行任意 Ruby 代码。根据漏洞信息，受影响的版本包括 3.2.22.2 之前的 3.x 版本、4.1.14.2 之前的 4.x 版本，以及 4.2.5.2 之前的 4.2.x 版本。

**漏洞利用方式：**
攻击者可以通过构造恶意的输入，将其传递给 `render` 方法，从而执行任意 Ruby 代码。这通常涉及到控制传递给 `render` 方法的模板名称或选项。根据搜索结果和漏洞库信息，漏洞的核心在于应用程序未能正确地过滤或转义用户提供的输入，直接将其用于渲染过程。

**POC 代码分析：**
提供的 POC 代码包含 `Gemfile` 和 `Gemfile.lock`。这些文件定义了 Ruby on Rails 应用的依赖。`Gemfile` 指定了 Rails 版本为 4.2.4，这属于受影响的版本范围。`Gemfile.lock` 锁定了具体的依赖版本，确保应用在不同环境中依赖的一致性。这些文件本身不包含直接的攻击代码，它们只是一个 Rails 应用的依赖描述文件，用于搭建易受攻击的环境。

**投毒风险分析：**
分析 `Gemfile` 和 `Gemfile.lock`，虽然没有明显的恶意代码，但依旧存在一定的投毒风险。攻击者可能通过修改 `Gemfile`，引入包含恶意代码的 gem 包。或者，虽然当前依赖没有问题，但未来依赖更新时，可能会引入包含漏洞或后门的 gem 包。当然，在提供的两个文件中，并没有发现后门或者漏洞代码，风险主要在于构建环境和引入存在风险的三方包。因此，投毒风险估计为 10%。

**项目地址:** [hderms/dh-CVE_2016_2098](https://github.com/hderms/dh-CVE_2016_2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #10

**来源**: [CVE-2016-2098-its-arun_CVE-2016-2098.md](../2016/CVE-2016-2098-its-arun_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，允许攻击者执行任意Ruby代码

**影响版本:** 3.2.22.2之前, 4.x 4.1.14.2之前, 和 4.2.x 4.2.5.2之前

**利用条件:** 目标应用使用了存在漏洞的Rails版本，且`render`方法以不安全的方式处理用户输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞。该漏洞源于对`render`方法的不安全使用，允许远程攻击者通过操纵用户提供的数据来执行任意Ruby代码。

**有效性：**

提供的POC代码利用了这一漏洞。通过向易受攻击的Rails应用发送特制的HTTP请求，攻击者可以在服务器上执行任意命令。

**投毒风险：**

代码本身的功能就是利用漏洞执行命令，没有发现恶意添加的额外功能代码。但是，下载和使用任何未经审查的漏洞利用代码都存在风险。POC代码的设计目标是利用漏洞，而攻击者可以修改这些POC代码以包含恶意功能，例如安装后门、窃取数据或进行其他恶意活动。
`README.md` 文件描述了漏洞和基本用法，未发现恶意代码。
`CVE-2016-2098.sh` 脚本相对简单，主要功能是构造恶意请求以利用漏洞。虽然脚本本身没有明显的恶意代码，但用户应始终谨慎审查并理解任何下载的代码。

**利用方式：**

1.  **确定目标:** 识别运行易受攻击的Ruby on Rails版本的Web应用程序。
2.  **构造Payload:** 使用POC脚本，构造包含要执行的Ruby代码的HTTP请求。此代码将作为`render`方法的参数传递。
3.  **发送Payload:** 将构造的HTTP请求发送到目标Web应用程序。
4.  **执行代码:** 如果目标应用程序易受攻击，服务器将执行嵌入在Payload中的Ruby代码。

脚本的工作方式是：

*   它接受三个参数：目标主机、URI 和要执行的命令。
*   它使用 `curl` 命令发送一个包含恶意 payload 的 HTTP 请求到目标服务器。Payload 利用 Rails `render` 方法执行任意命令。
*   它提供一个简单的交互式 shell，允许攻击者重复执行命令。

**项目地址:** [its-arun/CVE-2016-2098](https://github.com/its-arun/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #11

**来源**: [CVE-2016-2098-j4k0m_CVE-2016-2098.md](../2016/CVE-2016-2098-j4k0m_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails (Action Pack)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2之前, 4.x版本在4.1.14.2之前, 4.2.x版本在4.2.5.2之前

**利用条件:** 应用程序必须允许通过`render`方法处理用户提供的输入。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-2098 是一个 Ruby on Rails Action Pack 中的远程代码执行漏洞。攻击者可以通过向`render`方法提供恶意构造的输入来执行任意 Ruby 代码。  根据漏洞描述，漏洞根源在于Rails的`render`方法对用户输入的不当处理。POC 利用方式是通过`view[inline]`参数传递 Ruby 代码，该代码会被服务器执行。具体来说，POC 使用了 `<%= %x('[CMD]') %>` 这样的 Ruby 代码结构，其中 `[CMD]` 会被替换成想要执行的系统命令。例如，`<%= %x('whoami') %>` 会执行 `whoami` 命令，并将其输出显示在页面上。  利用步骤： 1. 确定目标 Rails 应用使用的 Rails 版本在受影响范围内。 2. 构造包含恶意 Ruby 代码的 URL，例如 `http://example.com/?view[inline]=<%= %x('whoami') %>` （需要 URL 编码）。 3. 将构造的 URL 发送到目标服务器。 4. 如果服务器存在漏洞，则会执行恶意代码，并将结果返回给攻击者。  投毒风险较低，主要因为 POC 代码的功能明确，目的是执行用户指定的命令。虽然攻击者可以利用该漏洞执行任何命令，但提供的 POC 本身不包含任何隐藏的恶意功能。 投毒的可能来自于下载后使用者更改后门,但原始版本后门概率极低。

**项目地址:** [j4k0m/CVE-2016-2098](https://github.com/j4k0m/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #12

**来源**: [CVE-2016-2098-sealldeveloper_CVE-2016-2098-PoC.md](../2016/CVE-2016-2098-sealldeveloper_CVE-2016-2098-PoC.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 3.2.22.2之前, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用使用了render方法并且允许用户可控的输入作为render方法的参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098 漏洞是 Ruby on Rails Action Pack 中由于不安全地使用 `render` 方法导致的远程代码执行漏洞。攻击者可以通过提供恶意构造的输入数据作为 `render` 方法的参数，从而执行任意 Ruby 代码。漏洞利用方式：

1.  **漏洞触发点：** 应用的某个功能使用了`render`方法，并且允许用户输入来决定渲染的内容。
2.  **攻击向量：** 攻击者构造包含恶意 Ruby 代码的字符串，并将其作为参数传递给 `render` 方法。
3.  **代码执行：** 由于 Rails 在处理 `render` 方法时，没有充分验证用户输入，导致恶意代码被执行。

**有效性：** 根据漏洞描述和搜索结果，此漏洞的POC已经公开，并且可以被利用。

**投毒风险：** 提供的漏洞利用代码只是一个LICENSE文件，无法评估是否存在投毒行为。即使有公开的POC存在，下载和使用任何第三方提供的代码都应该谨慎，并在安全的环境中进行测试。

**项目地址:** [sealldeveloper/CVE-2016-2098-PoC](https://github.com/sealldeveloper/CVE-2016-2098-PoC)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---



---

## POC #2

**来源**: [CVE-2016-2098-3rg1s_CVE-2016-2098.md](../2016/CVE-2016-2098-3rg1s_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序必须易受攻击，并且允许通过 render 方法使用不受信任的输入。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098 允许远程攻击者通过利用应用程序对 `render` 方法的不受限制使用来执行任意 Ruby 代码。漏洞存在于 Action Pack 中。根据提供的漏洞利用代码 `main.py`，攻击者可以通过构造包含恶意 Ruby 代码的 URL 参数（`[inline]`）来触发漏洞。该代码通过发送带有内联代码的 GET 请求，然后提取并打印服务器的响应。`README.md` 文件提供了漏洞的基本信息和使用说明。通过分析漏洞利用代码，没有发现任何明显的投毒迹象。代码逻辑简单，主要功能是发送请求并解析响应。因此，投毒风险评估为0%。利用方式是通过精心构造的 GET 请求，将恶意 Ruby 代码注入到 `render` 方法中执行。攻击者可以通过控制 `args` 变量来指定要执行的 Ruby 代码。

**项目地址:** [3rg1s/CVE-2016-2098](https://github.com/3rg1s/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #3

**来源**: [CVE-2016-2098-Alejandro-MartinG_rails-PoC-CVE-2016-2098.md](../2016/CVE-2016-2098-Alejandro-MartinG_rails-PoC-CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 3.2.22.2之前, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序必须允许通过`render`方法处理用户提供的输入

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails 的 Action Pack 组件中，由于对`render`方法的使用方式不当，允许远程攻击者执行任意 Ruby 代码。攻击者通过向`render`方法传递恶意构造的输入，可执行服务器端代码。漏洞利用代码 (POC) 表明，攻击者可以通过控制渲染的内容来注入恶意代码。提供的`Gemfile`和`Gemfile.lock`是 Rails 项目的依赖描述文件，用于指定项目所依赖的 Ruby Gems 及其版本。这些文件本身没有直接包含恶意代码，但它们指定了存在漏洞的 Rails 版本 (4.2.5.1)。

**有效性:**
提供的POC代码 (实际上是 Rails 项目的依赖描述文件) 与漏洞描述中受影响的版本一致，因此，如果目标应用使用存在漏洞的 Rails 版本并且允许用户可控的输入传递给`render`方法，那么该漏洞可以被成功利用。

**投毒风险:**
`Gemfile` 和 `Gemfile.lock` 文件本身不包含可执行代码，因此直接的投毒风险较低。但是，如果攻击者能够控制应用程序使用的 Gems 仓库或者能够篡改应用程序使用的 Gems，则可能存在通过引入被篡改的 Gems 来投毒的风险。对这些依赖项的评估表明，其中不太可能存在直接的投毒代码。投毒风险评估为5%。

**利用方式:**
利用方式是向易受攻击的 Rails 应用发送包含恶意参数的请求，这些参数会被传递给`render`方法，从而执行攻击者指定的 Ruby 代码。 例如，攻击者可以构造一个包含恶意代码的字符串，并将其作为模板名称或局部变量传递给`render`方法。当 Rails 应用尝试渲染该模板或使用该局部变量时，恶意代码就会被执行。根据 exploit-db 的 40086 描述，可以使用 `render :inline` 来执行代码。

**项目地址:** [Alejandro-MartinG/rails-PoC-CVE-2016-2098](https://github.com/Alejandro-MartinG/rails-PoC-CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #4

**来源**: [CVE-2016-2098-CyberDefenseInstitute_PoC_CVE-2016-2098_Rails42.md](../2016/CVE-2016-2098-CyberDefenseInstitute_PoC_CVE-2016-2098_Rails42.md)

## CVE-2016-2098-Ruby on Rails Action Pack RCE

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，允许远程攻击者执行任意Ruby代码

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序未使用安全的方式来处理render方法的用户输入

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-2098 漏洞是 Ruby on Rails Action Pack 中的一个远程代码执行漏洞。它允许远程攻击者通过利用应用程序对 `render` 方法的不受限制的使用来执行任意 Ruby 代码。

**漏洞分析：**

根据漏洞描述，漏洞的根源在于 Action Pack 组件在搜索用于渲染的模板时，处理用户提供的不可信输入的方式存在缺陷。如果应用程序将不可信的输入传递给 `render` 方法，攻击者可以构造恶意的输入来执行任意代码。

**POC 代码分析：**

提供的 POC 代码是 `Gemfile` 和 `Gemfile.lock` 文件，它们用于定义和锁定 Ruby 项目的依赖项。`Gemfile` 指定了项目使用的 Rails 版本 (4.2.5.1)，以及其他 gem 依赖项。`Gemfile.lock` 文件则记录了项目中使用的 gem 的确切版本，用于确保一致的构建。

这些文件本身并不包含漏洞利用代码，它们只是 Rails 应用配置的一部分。实际的漏洞利用需要向存在漏洞的 `render` 方法传递恶意的参数。

**有效性评估：**

POC 代码的有效性取决于目标应用程序是否使用了存在漏洞的 Rails 版本，并且允许用户控制传递给 `render` 方法的参数。如果满足这些条件，则漏洞利用是有效的。

**投毒风险评估：**

检查 `Gemfile` 和 `Gemfile.lock` 文件中是否存在投毒代码，需要检查是否有恶意或未知的 gem 依赖。当前提供的代码中，没有发现明显的投毒迹象。使用了常见的Rails版本和相关的gem包,例如 `rails`, `sqlite3`, `sass-rails`等。 但是，无法完全排除作者在其他地方添加恶意代码的可能性，例如在 `app` 目录下的 controller 或 view 文件中。

由于仅仅通过 `Gemfile` 和 `Gemfile.lock` 文件无法进行全面的代码审计，因此可以认为投毒风险非常低，约为1%。

**利用方式：**

1.  **找到易受攻击的 `render` 方法：** 确定应用程序中哪些地方使用了 `render` 方法，并且用户可以控制传递给 `render` 方法的参数。
2.  **构造恶意输入：** 构造包含恶意 Ruby 代码的输入字符串。例如，攻击者可以使用诸如 `<%= system('whoami') %>` 之类的代码来执行系统命令。
3.  **将恶意输入传递给 `render` 方法：** 将构造的恶意输入作为参数传递给 `render` 方法。这将导致应用程序执行恶意代码。

**总结：**

CVE-2016-2098 是一个严重的远程代码执行漏洞，需要及时修补。应用程序开发人员应该避免将不受信任的用户输入传递给 `render` 方法，并使用最新版本的 Rails 以获得安全修复。

**项目地址:** [CyberDefenseInstitute/PoC_CVE-2016-2098_Rails42](https://github.com/CyberDefenseInstitute/PoC_CVE-2016-2098_Rails42)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #5

**来源**: [CVE-2016-2098-DanielHemmati_CVE-2016-2098-my-first-exploit.md](../2016/CVE-2016-2098-DanielHemmati_CVE-2016-2098-my-first-exploit.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.x (< 3.2.22.2), 4.x (< 4.1.14.2), 4.2.x (< 4.2.5.2)

**利用条件:** 应用程序使用了`render`方法处理用户提供的不可信数据。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails 的 Action Pack 组件中，由于程序在处理`render`方法时未对用户输入进行充分的过滤和验证，导致远程攻击者可以执行任意 Ruby 代码。根据漏洞描述和搜索结果，攻击者可以通过构造特定的参数传递给`render`方法，从而执行恶意代码。

**有效性分析：**
提供的 Python 脚本`exploit.py` 旨在利用该漏洞。脚本允许用户指定目标 URL 和 payload。它将 payload 嵌入到 URL 中，并将其发送到目标应用程序。如果应用程序易受攻击，则会执行 payload 中包含的 Ruby 代码。该POC的有效性取决于目标Rails应用程序是否容易受到攻击且未进行修补。根据漏洞描述，低版本的 Rails 应用存在此风险。

**投毒风险分析：**
查看提供的 Python 脚本 `exploit.py` 和 `README.md`。`README.md` 文件只包含有关漏洞和脚本使用方法的描述，没有发现任何可疑代码。`exploit.py` 脚本的功能是构造和发送包含 payload 的 HTTP 请求，看起来相对简单直接。虽然脚本本身的功能是为了利用漏洞，但没有发现明显的后门或恶意代码。它接受用户提供的 payload 并将其发送到目标，因此恶意代码更有可能通过用户提供的 payload 注入到目标系统，而不是通过脚本本身进行投毒。因此，脚本本身的投毒风险较低，但使用时仍需谨慎，确保理解所执行的 payload 的含义。

**利用方式分析：**
1.  **确定目标：** 找到运行存在漏洞版本的 Ruby on Rails 应用程序。
2.  **构造 Payload：** 构建恶意的 Ruby 代码，例如执行系统命令。
3.  **发送请求：** 使用漏洞利用代码（或手动构造 HTTP 请求）将 payload 传递给应用程序的`render`方法，例如通过 URL 参数 `[inline]`。
4.  **执行代码：** 如果应用程序易受攻击，服务器将执行 payload 中的 Ruby 代码。

**示例：**
`python3 exploit.py -H "http://example.com/page?id=1"`
然后输入 payload: `system('whoami')` 。
如果成功，服务器会执行 `whoami` 命令，并将结果返回到攻击者。

综上所述，该漏洞的利用方式主要是通过操纵 `render` 方法的参数，注入恶意的 Ruby 代码，从而实现远程代码执行。该利用的有效性取决于目标应用程序的版本和配置。

**项目地址:** [DanielHemmati/CVE-2016-2098-my-first-exploit](https://github.com/DanielHemmati/CVE-2016-2098-my-first-exploit)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #6

**来源**: [CVE-2016-2098-Debalinax64_CVE-2016-2098.md](../2016/CVE-2016-2098-Debalinax64_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2 之前, 4.x 4.1.14.2 之前, 和 4.2.x 4.2.5.2 之前

**利用条件:** 目标应用使用了存在漏洞的Rails版本，并且应用程序允许使用render方法处理用户提供的输入。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails Action Pack 中，由于其 render 方法对用户输入未做严格限制，导致远程攻击者可以利用此漏洞执行任意 Ruby 代码，从而完全控制服务器。

**有效性：**
提供的POC代码是有效的。漏洞库信息，搜索引擎结果以及利用代码都表明可以通过`render`方法执行任意ruby代码。例如，可以使用`curl`发送包含恶意代码的请求，服务器会执行该代码。

**投毒风险：**
查看提供的 POC 代码 `/tmp/fb84a5f2be1c3ed581440d890e43983b/ruby-on-rail-RCE.sh`，该脚本主要功能是发送包含ruby代码的curl请求，执行用户指定的命令。脚本本身没有明显的恶意行为，例如反弹shell或下载其他恶意文件。因此，投毒风险较低，但考虑到脚本的执行环境和权限，以及可能被用于自动化攻击，存在一定风险。`/tmp/fb84a5f2be1c3ed581440d890e43983b/README.md`文件只是漏洞描述和使用说明，不存在投毒代码。总体评估风险比例为5%。

**利用方式：**
1.  攻击者需要找到一个使用了存在漏洞的Rails版本，并且允许使用render方法的应用程序。
2.  攻击者通过构造恶意的URL，将payload传递给`render`方法。 Payload形式是 `%3C%25=%20%25x('command')%20%25%3E`。 其中`command`参数是要在目标服务器上执行的命令。
3.  目标服务器在处理请求时，会执行该恶意Ruby代码，从而执行攻击者指定的命令。

**项目地址:** [Debalinax64/CVE-2016-2098](https://github.com/Debalinax64/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #7

**来源**: [CVE-2016-2098-JoseLRC97_Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution.md](../2016/CVE-2016-2098-JoseLRC97_Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution.md)

## CVE-2016-2098-Ruby on Rails Action Pack-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2之前, 4.x版本4.1.14.2之前, 4.2.x版本4.2.5.2之前

**利用条件:** 应用程序使用了`render`方法并且允许用户控制输入

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞。该漏洞源于应用程序对`render`方法的不受限制的使用。如果应用程序允许用户控制传递给`render`方法的参数，攻击者可以利用此漏洞执行任意Ruby代码。

**有效性：**
漏洞库信息和搜索引擎结果都确认了此漏洞的存在和严重性。Exploit-DB上存在相关的漏洞利用代码（https://www.exploit-db.com/exploits/40086/），进一步验证了漏洞的可利用性。

**投毒风险：**
提供的漏洞利用代码片段只是GNU通用公共许可证，并非漏洞的实际利用代码。因此，无法从中判断是否存在投毒风险。需要进一步分析实际的漏洞利用代码才能评估投毒风险。目前判断投毒风险为0%。

**利用方式：**
利用方式是，攻击者需要找到一个应用程序中使用了`render`方法并且允许用户控制输入的位置。然后，攻击者可以构造恶意的输入，例如包含Ruby代码的字符串，将其传递给`render`方法。`render`方法会执行该Ruby代码，从而导致远程代码执行。具体的payload取决于目标应用程序的上下文，但通常可以用于执行系统命令、读取敏感文件或在服务器上安装后门。

**项目地址:** [JoseLRC97/Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution](https://github.com/JoseLRC97/Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #8

**来源**: [CVE-2016-2098-Shakun8_CVE-2016-2098.md](../2016/CVE-2016-2098-Shakun8_CVE-2016-2098.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 目标应用使用了存在漏洞的Rails版本，且允许通过URL参数控制render方法。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞，源于对`render`方法的不受限制的使用。攻击者可以通过构造恶意的URL参数，将Ruby代码注入到`render`方法中执行，从而获得服务器的控制权。

**有效性：**
提供的POC代码`CVE-2016-2098.py`看起来是有效的。它使用`requests`库发送带有恶意参数的GET请求，其中参数值包含要执行的Ruby代码。Payload 构造的核心在于 `#{sys.argv[3]}[inline]=%3C%25=%20%25x({cmd})%20%25%3E` ，这部分代码将命令插入到ERB模板中，利用Rails的render方法执行任意代码。

**投毒风险：**
提供的漏洞利用代码中没有发现明显的投毒代码。该脚本的主要功能是发送包含恶意payload的HTTP请求，并打印响应结果。`README.md`文件仅包含漏洞名称和POC描述，没有可疑内容。因此，投毒风险较低，为0%。

**利用方式：**
1.  **确定目标应用是否使用了存在漏洞的Rails版本。**
2.  **构造包含恶意Ruby代码的URL参数。** 例如，使用提供的POC脚本：
    `python CVE-2016-2098.py 'system("whoami")' 'http://target.com/controller/action' 'payload'`
    这个命令会在目标服务器上执行`whoami`命令，并将结果返回。
3.  **发送包含恶意参数的HTTP请求。**
4.  **分析响应结果，确认代码是否成功执行。**

攻击者可以利用此漏洞执行任意系统命令，读取敏感文件，甚至完全控制服务器。修复此漏洞的方法是升级到受影响Rails版本以上的版本，或者限制对render方法的使用。

**项目地址:** [Shakun8/CVE-2016-2098](https://github.com/Shakun8/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #9

**来源**: [CVE-2016-2098-hderms_dh-CVE_2016_2098.md](../2016/CVE-2016-2098-hderms_dh-CVE_2016_2098.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，允许远程攻击者执行任意 Ruby 代码

**影响版本:** < 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序需要允许用户控制的输入传递给 render 方法

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-2098 存在于 Ruby on Rails 的 Action Pack 中，由于对 `render` 方法的使用未加限制，允许远程攻击者执行任意 Ruby 代码。根据漏洞信息，受影响的版本包括 3.2.22.2 之前的 3.x 版本、4.1.14.2 之前的 4.x 版本，以及 4.2.5.2 之前的 4.2.x 版本。

**漏洞利用方式：**
攻击者可以通过构造恶意的输入，将其传递给 `render` 方法，从而执行任意 Ruby 代码。这通常涉及到控制传递给 `render` 方法的模板名称或选项。根据搜索结果和漏洞库信息，漏洞的核心在于应用程序未能正确地过滤或转义用户提供的输入，直接将其用于渲染过程。

**POC 代码分析：**
提供的 POC 代码包含 `Gemfile` 和 `Gemfile.lock`。这些文件定义了 Ruby on Rails 应用的依赖。`Gemfile` 指定了 Rails 版本为 4.2.4，这属于受影响的版本范围。`Gemfile.lock` 锁定了具体的依赖版本，确保应用在不同环境中依赖的一致性。这些文件本身不包含直接的攻击代码，它们只是一个 Rails 应用的依赖描述文件，用于搭建易受攻击的环境。

**投毒风险分析：**
分析 `Gemfile` 和 `Gemfile.lock`，虽然没有明显的恶意代码，但依旧存在一定的投毒风险。攻击者可能通过修改 `Gemfile`，引入包含恶意代码的 gem 包。或者，虽然当前依赖没有问题，但未来依赖更新时，可能会引入包含漏洞或后门的 gem 包。当然，在提供的两个文件中，并没有发现后门或者漏洞代码，风险主要在于构建环境和引入存在风险的三方包。因此，投毒风险估计为 10%。

**项目地址:** [hderms/dh-CVE_2016_2098](https://github.com/hderms/dh-CVE_2016_2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #10

**来源**: [CVE-2016-2098-its-arun_CVE-2016-2098.md](../2016/CVE-2016-2098-its-arun_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，允许攻击者执行任意Ruby代码

**影响版本:** 3.2.22.2之前, 4.x 4.1.14.2之前, 和 4.2.x 4.2.5.2之前

**利用条件:** 目标应用使用了存在漏洞的Rails版本，且`render`方法以不安全的方式处理用户输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞。该漏洞源于对`render`方法的不安全使用，允许远程攻击者通过操纵用户提供的数据来执行任意Ruby代码。

**有效性：**

提供的POC代码利用了这一漏洞。通过向易受攻击的Rails应用发送特制的HTTP请求，攻击者可以在服务器上执行任意命令。

**投毒风险：**

代码本身的功能就是利用漏洞执行命令，没有发现恶意添加的额外功能代码。但是，下载和使用任何未经审查的漏洞利用代码都存在风险。POC代码的设计目标是利用漏洞，而攻击者可以修改这些POC代码以包含恶意功能，例如安装后门、窃取数据或进行其他恶意活动。
`README.md` 文件描述了漏洞和基本用法，未发现恶意代码。
`CVE-2016-2098.sh` 脚本相对简单，主要功能是构造恶意请求以利用漏洞。虽然脚本本身没有明显的恶意代码，但用户应始终谨慎审查并理解任何下载的代码。

**利用方式：**

1.  **确定目标:** 识别运行易受攻击的Ruby on Rails版本的Web应用程序。
2.  **构造Payload:** 使用POC脚本，构造包含要执行的Ruby代码的HTTP请求。此代码将作为`render`方法的参数传递。
3.  **发送Payload:** 将构造的HTTP请求发送到目标Web应用程序。
4.  **执行代码:** 如果目标应用程序易受攻击，服务器将执行嵌入在Payload中的Ruby代码。

脚本的工作方式是：

*   它接受三个参数：目标主机、URI 和要执行的命令。
*   它使用 `curl` 命令发送一个包含恶意 payload 的 HTTP 请求到目标服务器。Payload 利用 Rails `render` 方法执行任意命令。
*   它提供一个简单的交互式 shell，允许攻击者重复执行命令。

**项目地址:** [its-arun/CVE-2016-2098](https://github.com/its-arun/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #11

**来源**: [CVE-2016-2098-j4k0m_CVE-2016-2098.md](../2016/CVE-2016-2098-j4k0m_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails (Action Pack)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2之前, 4.x版本在4.1.14.2之前, 4.2.x版本在4.2.5.2之前

**利用条件:** 应用程序必须允许通过`render`方法处理用户提供的输入。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-2098 是一个 Ruby on Rails Action Pack 中的远程代码执行漏洞。攻击者可以通过向`render`方法提供恶意构造的输入来执行任意 Ruby 代码。  根据漏洞描述，漏洞根源在于Rails的`render`方法对用户输入的不当处理。POC 利用方式是通过`view[inline]`参数传递 Ruby 代码，该代码会被服务器执行。具体来说，POC 使用了 `<%= %x('[CMD]') %>` 这样的 Ruby 代码结构，其中 `[CMD]` 会被替换成想要执行的系统命令。例如，`<%= %x('whoami') %>` 会执行 `whoami` 命令，并将其输出显示在页面上。  利用步骤： 1. 确定目标 Rails 应用使用的 Rails 版本在受影响范围内。 2. 构造包含恶意 Ruby 代码的 URL，例如 `http://example.com/?view[inline]=<%= %x('whoami') %>` （需要 URL 编码）。 3. 将构造的 URL 发送到目标服务器。 4. 如果服务器存在漏洞，则会执行恶意代码，并将结果返回给攻击者。  投毒风险较低，主要因为 POC 代码的功能明确，目的是执行用户指定的命令。虽然攻击者可以利用该漏洞执行任何命令，但提供的 POC 本身不包含任何隐藏的恶意功能。 投毒的可能来自于下载后使用者更改后门,但原始版本后门概率极低。

**项目地址:** [j4k0m/CVE-2016-2098](https://github.com/j4k0m/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #12

**来源**: [CVE-2016-2098-sealldeveloper_CVE-2016-2098-PoC.md](../2016/CVE-2016-2098-sealldeveloper_CVE-2016-2098-PoC.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 3.2.22.2之前, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用使用了render方法并且允许用户可控的输入作为render方法的参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098 漏洞是 Ruby on Rails Action Pack 中由于不安全地使用 `render` 方法导致的远程代码执行漏洞。攻击者可以通过提供恶意构造的输入数据作为 `render` 方法的参数，从而执行任意 Ruby 代码。漏洞利用方式：

1.  **漏洞触发点：** 应用的某个功能使用了`render`方法，并且允许用户输入来决定渲染的内容。
2.  **攻击向量：** 攻击者构造包含恶意 Ruby 代码的字符串，并将其作为参数传递给 `render` 方法。
3.  **代码执行：** 由于 Rails 在处理 `render` 方法时，没有充分验证用户输入，导致恶意代码被执行。

**有效性：** 根据漏洞描述和搜索结果，此漏洞的POC已经公开，并且可以被利用。

**投毒风险：** 提供的漏洞利用代码只是一个LICENSE文件，无法评估是否存在投毒行为。即使有公开的POC存在，下载和使用任何第三方提供的代码都应该谨慎，并在安全的环境中进行测试。

**项目地址:** [sealldeveloper/CVE-2016-2098-PoC](https://github.com/sealldeveloper/CVE-2016-2098-PoC)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---



---

## POC #2

**来源**: [CVE-2016-2098-3rg1s_CVE-2016-2098.md](../2016/CVE-2016-2098-3rg1s_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序必须易受攻击，并且允许通过 render 方法使用不受信任的输入。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098 允许远程攻击者通过利用应用程序对 `render` 方法的不受限制使用来执行任意 Ruby 代码。漏洞存在于 Action Pack 中。根据提供的漏洞利用代码 `main.py`，攻击者可以通过构造包含恶意 Ruby 代码的 URL 参数（`[inline]`）来触发漏洞。该代码通过发送带有内联代码的 GET 请求，然后提取并打印服务器的响应。`README.md` 文件提供了漏洞的基本信息和使用说明。通过分析漏洞利用代码，没有发现任何明显的投毒迹象。代码逻辑简单，主要功能是发送请求并解析响应。因此，投毒风险评估为0%。利用方式是通过精心构造的 GET 请求，将恶意 Ruby 代码注入到 `render` 方法中执行。攻击者可以通过控制 `args` 变量来指定要执行的 Ruby 代码。

**项目地址:** [3rg1s/CVE-2016-2098](https://github.com/3rg1s/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #3

**来源**: [CVE-2016-2098-Alejandro-MartinG_rails-PoC-CVE-2016-2098.md](../2016/CVE-2016-2098-Alejandro-MartinG_rails-PoC-CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 3.2.22.2之前, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序必须允许通过`render`方法处理用户提供的输入

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails 的 Action Pack 组件中，由于对`render`方法的使用方式不当，允许远程攻击者执行任意 Ruby 代码。攻击者通过向`render`方法传递恶意构造的输入，可执行服务器端代码。漏洞利用代码 (POC) 表明，攻击者可以通过控制渲染的内容来注入恶意代码。提供的`Gemfile`和`Gemfile.lock`是 Rails 项目的依赖描述文件，用于指定项目所依赖的 Ruby Gems 及其版本。这些文件本身没有直接包含恶意代码，但它们指定了存在漏洞的 Rails 版本 (4.2.5.1)。

**有效性:**
提供的POC代码 (实际上是 Rails 项目的依赖描述文件) 与漏洞描述中受影响的版本一致，因此，如果目标应用使用存在漏洞的 Rails 版本并且允许用户可控的输入传递给`render`方法，那么该漏洞可以被成功利用。

**投毒风险:**
`Gemfile` 和 `Gemfile.lock` 文件本身不包含可执行代码，因此直接的投毒风险较低。但是，如果攻击者能够控制应用程序使用的 Gems 仓库或者能够篡改应用程序使用的 Gems，则可能存在通过引入被篡改的 Gems 来投毒的风险。对这些依赖项的评估表明，其中不太可能存在直接的投毒代码。投毒风险评估为5%。

**利用方式:**
利用方式是向易受攻击的 Rails 应用发送包含恶意参数的请求，这些参数会被传递给`render`方法，从而执行攻击者指定的 Ruby 代码。 例如，攻击者可以构造一个包含恶意代码的字符串，并将其作为模板名称或局部变量传递给`render`方法。当 Rails 应用尝试渲染该模板或使用该局部变量时，恶意代码就会被执行。根据 exploit-db 的 40086 描述，可以使用 `render :inline` 来执行代码。

**项目地址:** [Alejandro-MartinG/rails-PoC-CVE-2016-2098](https://github.com/Alejandro-MartinG/rails-PoC-CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #4

**来源**: [CVE-2016-2098-CyberDefenseInstitute_PoC_CVE-2016-2098_Rails42.md](../2016/CVE-2016-2098-CyberDefenseInstitute_PoC_CVE-2016-2098_Rails42.md)

## CVE-2016-2098-Ruby on Rails Action Pack RCE

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，允许远程攻击者执行任意Ruby代码

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序未使用安全的方式来处理render方法的用户输入

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-2098 漏洞是 Ruby on Rails Action Pack 中的一个远程代码执行漏洞。它允许远程攻击者通过利用应用程序对 `render` 方法的不受限制的使用来执行任意 Ruby 代码。

**漏洞分析：**

根据漏洞描述，漏洞的根源在于 Action Pack 组件在搜索用于渲染的模板时，处理用户提供的不可信输入的方式存在缺陷。如果应用程序将不可信的输入传递给 `render` 方法，攻击者可以构造恶意的输入来执行任意代码。

**POC 代码分析：**

提供的 POC 代码是 `Gemfile` 和 `Gemfile.lock` 文件，它们用于定义和锁定 Ruby 项目的依赖项。`Gemfile` 指定了项目使用的 Rails 版本 (4.2.5.1)，以及其他 gem 依赖项。`Gemfile.lock` 文件则记录了项目中使用的 gem 的确切版本，用于确保一致的构建。

这些文件本身并不包含漏洞利用代码，它们只是 Rails 应用配置的一部分。实际的漏洞利用需要向存在漏洞的 `render` 方法传递恶意的参数。

**有效性评估：**

POC 代码的有效性取决于目标应用程序是否使用了存在漏洞的 Rails 版本，并且允许用户控制传递给 `render` 方法的参数。如果满足这些条件，则漏洞利用是有效的。

**投毒风险评估：**

检查 `Gemfile` 和 `Gemfile.lock` 文件中是否存在投毒代码，需要检查是否有恶意或未知的 gem 依赖。当前提供的代码中，没有发现明显的投毒迹象。使用了常见的Rails版本和相关的gem包,例如 `rails`, `sqlite3`, `sass-rails`等。 但是，无法完全排除作者在其他地方添加恶意代码的可能性，例如在 `app` 目录下的 controller 或 view 文件中。

由于仅仅通过 `Gemfile` 和 `Gemfile.lock` 文件无法进行全面的代码审计，因此可以认为投毒风险非常低，约为1%。

**利用方式：**

1.  **找到易受攻击的 `render` 方法：** 确定应用程序中哪些地方使用了 `render` 方法，并且用户可以控制传递给 `render` 方法的参数。
2.  **构造恶意输入：** 构造包含恶意 Ruby 代码的输入字符串。例如，攻击者可以使用诸如 `<%= system('whoami') %>` 之类的代码来执行系统命令。
3.  **将恶意输入传递给 `render` 方法：** 将构造的恶意输入作为参数传递给 `render` 方法。这将导致应用程序执行恶意代码。

**总结：**

CVE-2016-2098 是一个严重的远程代码执行漏洞，需要及时修补。应用程序开发人员应该避免将不受信任的用户输入传递给 `render` 方法，并使用最新版本的 Rails 以获得安全修复。

**项目地址:** [CyberDefenseInstitute/PoC_CVE-2016-2098_Rails42](https://github.com/CyberDefenseInstitute/PoC_CVE-2016-2098_Rails42)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #5

**来源**: [CVE-2016-2098-DanielHemmati_CVE-2016-2098-my-first-exploit.md](../2016/CVE-2016-2098-DanielHemmati_CVE-2016-2098-my-first-exploit.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.x (< 3.2.22.2), 4.x (< 4.1.14.2), 4.2.x (< 4.2.5.2)

**利用条件:** 应用程序使用了`render`方法处理用户提供的不可信数据。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails 的 Action Pack 组件中，由于程序在处理`render`方法时未对用户输入进行充分的过滤和验证，导致远程攻击者可以执行任意 Ruby 代码。根据漏洞描述和搜索结果，攻击者可以通过构造特定的参数传递给`render`方法，从而执行恶意代码。

**有效性分析：**
提供的 Python 脚本`exploit.py` 旨在利用该漏洞。脚本允许用户指定目标 URL 和 payload。它将 payload 嵌入到 URL 中，并将其发送到目标应用程序。如果应用程序易受攻击，则会执行 payload 中包含的 Ruby 代码。该POC的有效性取决于目标Rails应用程序是否容易受到攻击且未进行修补。根据漏洞描述，低版本的 Rails 应用存在此风险。

**投毒风险分析：**
查看提供的 Python 脚本 `exploit.py` 和 `README.md`。`README.md` 文件只包含有关漏洞和脚本使用方法的描述，没有发现任何可疑代码。`exploit.py` 脚本的功能是构造和发送包含 payload 的 HTTP 请求，看起来相对简单直接。虽然脚本本身的功能是为了利用漏洞，但没有发现明显的后门或恶意代码。它接受用户提供的 payload 并将其发送到目标，因此恶意代码更有可能通过用户提供的 payload 注入到目标系统，而不是通过脚本本身进行投毒。因此，脚本本身的投毒风险较低，但使用时仍需谨慎，确保理解所执行的 payload 的含义。

**利用方式分析：**
1.  **确定目标：** 找到运行存在漏洞版本的 Ruby on Rails 应用程序。
2.  **构造 Payload：** 构建恶意的 Ruby 代码，例如执行系统命令。
3.  **发送请求：** 使用漏洞利用代码（或手动构造 HTTP 请求）将 payload 传递给应用程序的`render`方法，例如通过 URL 参数 `[inline]`。
4.  **执行代码：** 如果应用程序易受攻击，服务器将执行 payload 中的 Ruby 代码。

**示例：**
`python3 exploit.py -H "http://example.com/page?id=1"`
然后输入 payload: `system('whoami')` 。
如果成功，服务器会执行 `whoami` 命令，并将结果返回到攻击者。

综上所述，该漏洞的利用方式主要是通过操纵 `render` 方法的参数，注入恶意的 Ruby 代码，从而实现远程代码执行。该利用的有效性取决于目标应用程序的版本和配置。

**项目地址:** [DanielHemmati/CVE-2016-2098-my-first-exploit](https://github.com/DanielHemmati/CVE-2016-2098-my-first-exploit)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #6

**来源**: [CVE-2016-2098-Debalinax64_CVE-2016-2098.md](../2016/CVE-2016-2098-Debalinax64_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2 之前, 4.x 4.1.14.2 之前, 和 4.2.x 4.2.5.2 之前

**利用条件:** 目标应用使用了存在漏洞的Rails版本，并且应用程序允许使用render方法处理用户提供的输入。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails Action Pack 中，由于其 render 方法对用户输入未做严格限制，导致远程攻击者可以利用此漏洞执行任意 Ruby 代码，从而完全控制服务器。

**有效性：**
提供的POC代码是有效的。漏洞库信息，搜索引擎结果以及利用代码都表明可以通过`render`方法执行任意ruby代码。例如，可以使用`curl`发送包含恶意代码的请求，服务器会执行该代码。

**投毒风险：**
查看提供的 POC 代码 `/tmp/fb84a5f2be1c3ed581440d890e43983b/ruby-on-rail-RCE.sh`，该脚本主要功能是发送包含ruby代码的curl请求，执行用户指定的命令。脚本本身没有明显的恶意行为，例如反弹shell或下载其他恶意文件。因此，投毒风险较低，但考虑到脚本的执行环境和权限，以及可能被用于自动化攻击，存在一定风险。`/tmp/fb84a5f2be1c3ed581440d890e43983b/README.md`文件只是漏洞描述和使用说明，不存在投毒代码。总体评估风险比例为5%。

**利用方式：**
1.  攻击者需要找到一个使用了存在漏洞的Rails版本，并且允许使用render方法的应用程序。
2.  攻击者通过构造恶意的URL，将payload传递给`render`方法。 Payload形式是 `%3C%25=%20%25x('command')%20%25%3E`。 其中`command`参数是要在目标服务器上执行的命令。
3.  目标服务器在处理请求时，会执行该恶意Ruby代码，从而执行攻击者指定的命令。

**项目地址:** [Debalinax64/CVE-2016-2098](https://github.com/Debalinax64/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #7

**来源**: [CVE-2016-2098-JoseLRC97_Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution.md](../2016/CVE-2016-2098-JoseLRC97_Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution.md)

## CVE-2016-2098-Ruby on Rails Action Pack-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2之前, 4.x版本4.1.14.2之前, 4.2.x版本4.2.5.2之前

**利用条件:** 应用程序使用了`render`方法并且允许用户控制输入

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞。该漏洞源于应用程序对`render`方法的不受限制的使用。如果应用程序允许用户控制传递给`render`方法的参数，攻击者可以利用此漏洞执行任意Ruby代码。

**有效性：**
漏洞库信息和搜索引擎结果都确认了此漏洞的存在和严重性。Exploit-DB上存在相关的漏洞利用代码（https://www.exploit-db.com/exploits/40086/），进一步验证了漏洞的可利用性。

**投毒风险：**
提供的漏洞利用代码片段只是GNU通用公共许可证，并非漏洞的实际利用代码。因此，无法从中判断是否存在投毒风险。需要进一步分析实际的漏洞利用代码才能评估投毒风险。目前判断投毒风险为0%。

**利用方式：**
利用方式是，攻击者需要找到一个应用程序中使用了`render`方法并且允许用户控制输入的位置。然后，攻击者可以构造恶意的输入，例如包含Ruby代码的字符串，将其传递给`render`方法。`render`方法会执行该Ruby代码，从而导致远程代码执行。具体的payload取决于目标应用程序的上下文，但通常可以用于执行系统命令、读取敏感文件或在服务器上安装后门。

**项目地址:** [JoseLRC97/Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution](https://github.com/JoseLRC97/Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #8

**来源**: [CVE-2016-2098-Shakun8_CVE-2016-2098.md](../2016/CVE-2016-2098-Shakun8_CVE-2016-2098.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 目标应用使用了存在漏洞的Rails版本，且允许通过URL参数控制render方法。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞，源于对`render`方法的不受限制的使用。攻击者可以通过构造恶意的URL参数，将Ruby代码注入到`render`方法中执行，从而获得服务器的控制权。

**有效性：**
提供的POC代码`CVE-2016-2098.py`看起来是有效的。它使用`requests`库发送带有恶意参数的GET请求，其中参数值包含要执行的Ruby代码。Payload 构造的核心在于 `#{sys.argv[3]}[inline]=%3C%25=%20%25x({cmd})%20%25%3E` ，这部分代码将命令插入到ERB模板中，利用Rails的render方法执行任意代码。

**投毒风险：**
提供的漏洞利用代码中没有发现明显的投毒代码。该脚本的主要功能是发送包含恶意payload的HTTP请求，并打印响应结果。`README.md`文件仅包含漏洞名称和POC描述，没有可疑内容。因此，投毒风险较低，为0%。

**利用方式：**
1.  **确定目标应用是否使用了存在漏洞的Rails版本。**
2.  **构造包含恶意Ruby代码的URL参数。** 例如，使用提供的POC脚本：
    `python CVE-2016-2098.py 'system("whoami")' 'http://target.com/controller/action' 'payload'`
    这个命令会在目标服务器上执行`whoami`命令，并将结果返回。
3.  **发送包含恶意参数的HTTP请求。**
4.  **分析响应结果，确认代码是否成功执行。**

攻击者可以利用此漏洞执行任意系统命令，读取敏感文件，甚至完全控制服务器。修复此漏洞的方法是升级到受影响Rails版本以上的版本，或者限制对render方法的使用。

**项目地址:** [Shakun8/CVE-2016-2098](https://github.com/Shakun8/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #9

**来源**: [CVE-2016-2098-hderms_dh-CVE_2016_2098.md](../2016/CVE-2016-2098-hderms_dh-CVE_2016_2098.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，允许远程攻击者执行任意 Ruby 代码

**影响版本:** < 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序需要允许用户控制的输入传递给 render 方法

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-2098 存在于 Ruby on Rails 的 Action Pack 中，由于对 `render` 方法的使用未加限制，允许远程攻击者执行任意 Ruby 代码。根据漏洞信息，受影响的版本包括 3.2.22.2 之前的 3.x 版本、4.1.14.2 之前的 4.x 版本，以及 4.2.5.2 之前的 4.2.x 版本。

**漏洞利用方式：**
攻击者可以通过构造恶意的输入，将其传递给 `render` 方法，从而执行任意 Ruby 代码。这通常涉及到控制传递给 `render` 方法的模板名称或选项。根据搜索结果和漏洞库信息，漏洞的核心在于应用程序未能正确地过滤或转义用户提供的输入，直接将其用于渲染过程。

**POC 代码分析：**
提供的 POC 代码包含 `Gemfile` 和 `Gemfile.lock`。这些文件定义了 Ruby on Rails 应用的依赖。`Gemfile` 指定了 Rails 版本为 4.2.4，这属于受影响的版本范围。`Gemfile.lock` 锁定了具体的依赖版本，确保应用在不同环境中依赖的一致性。这些文件本身不包含直接的攻击代码，它们只是一个 Rails 应用的依赖描述文件，用于搭建易受攻击的环境。

**投毒风险分析：**
分析 `Gemfile` 和 `Gemfile.lock`，虽然没有明显的恶意代码，但依旧存在一定的投毒风险。攻击者可能通过修改 `Gemfile`，引入包含恶意代码的 gem 包。或者，虽然当前依赖没有问题，但未来依赖更新时，可能会引入包含漏洞或后门的 gem 包。当然，在提供的两个文件中，并没有发现后门或者漏洞代码，风险主要在于构建环境和引入存在风险的三方包。因此，投毒风险估计为 10%。

**项目地址:** [hderms/dh-CVE_2016_2098](https://github.com/hderms/dh-CVE_2016_2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #10

**来源**: [CVE-2016-2098-its-arun_CVE-2016-2098.md](../2016/CVE-2016-2098-its-arun_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，允许攻击者执行任意Ruby代码

**影响版本:** 3.2.22.2之前, 4.x 4.1.14.2之前, 和 4.2.x 4.2.5.2之前

**利用条件:** 目标应用使用了存在漏洞的Rails版本，且`render`方法以不安全的方式处理用户输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞。该漏洞源于对`render`方法的不安全使用，允许远程攻击者通过操纵用户提供的数据来执行任意Ruby代码。

**有效性：**

提供的POC代码利用了这一漏洞。通过向易受攻击的Rails应用发送特制的HTTP请求，攻击者可以在服务器上执行任意命令。

**投毒风险：**

代码本身的功能就是利用漏洞执行命令，没有发现恶意添加的额外功能代码。但是，下载和使用任何未经审查的漏洞利用代码都存在风险。POC代码的设计目标是利用漏洞，而攻击者可以修改这些POC代码以包含恶意功能，例如安装后门、窃取数据或进行其他恶意活动。
`README.md` 文件描述了漏洞和基本用法，未发现恶意代码。
`CVE-2016-2098.sh` 脚本相对简单，主要功能是构造恶意请求以利用漏洞。虽然脚本本身没有明显的恶意代码，但用户应始终谨慎审查并理解任何下载的代码。

**利用方式：**

1.  **确定目标:** 识别运行易受攻击的Ruby on Rails版本的Web应用程序。
2.  **构造Payload:** 使用POC脚本，构造包含要执行的Ruby代码的HTTP请求。此代码将作为`render`方法的参数传递。
3.  **发送Payload:** 将构造的HTTP请求发送到目标Web应用程序。
4.  **执行代码:** 如果目标应用程序易受攻击，服务器将执行嵌入在Payload中的Ruby代码。

脚本的工作方式是：

*   它接受三个参数：目标主机、URI 和要执行的命令。
*   它使用 `curl` 命令发送一个包含恶意 payload 的 HTTP 请求到目标服务器。Payload 利用 Rails `render` 方法执行任意命令。
*   它提供一个简单的交互式 shell，允许攻击者重复执行命令。

**项目地址:** [its-arun/CVE-2016-2098](https://github.com/its-arun/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #11

**来源**: [CVE-2016-2098-j4k0m_CVE-2016-2098.md](../2016/CVE-2016-2098-j4k0m_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails (Action Pack)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2之前, 4.x版本在4.1.14.2之前, 4.2.x版本在4.2.5.2之前

**利用条件:** 应用程序必须允许通过`render`方法处理用户提供的输入。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-2098 是一个 Ruby on Rails Action Pack 中的远程代码执行漏洞。攻击者可以通过向`render`方法提供恶意构造的输入来执行任意 Ruby 代码。  根据漏洞描述，漏洞根源在于Rails的`render`方法对用户输入的不当处理。POC 利用方式是通过`view[inline]`参数传递 Ruby 代码，该代码会被服务器执行。具体来说，POC 使用了 `<%= %x('[CMD]') %>` 这样的 Ruby 代码结构，其中 `[CMD]` 会被替换成想要执行的系统命令。例如，`<%= %x('whoami') %>` 会执行 `whoami` 命令，并将其输出显示在页面上。  利用步骤： 1. 确定目标 Rails 应用使用的 Rails 版本在受影响范围内。 2. 构造包含恶意 Ruby 代码的 URL，例如 `http://example.com/?view[inline]=<%= %x('whoami') %>` （需要 URL 编码）。 3. 将构造的 URL 发送到目标服务器。 4. 如果服务器存在漏洞，则会执行恶意代码，并将结果返回给攻击者。  投毒风险较低，主要因为 POC 代码的功能明确，目的是执行用户指定的命令。虽然攻击者可以利用该漏洞执行任何命令，但提供的 POC 本身不包含任何隐藏的恶意功能。 投毒的可能来自于下载后使用者更改后门,但原始版本后门概率极低。

**项目地址:** [j4k0m/CVE-2016-2098](https://github.com/j4k0m/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #12

**来源**: [CVE-2016-2098-sealldeveloper_CVE-2016-2098-PoC.md](../2016/CVE-2016-2098-sealldeveloper_CVE-2016-2098-PoC.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 3.2.22.2之前, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用使用了render方法并且允许用户可控的输入作为render方法的参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098 漏洞是 Ruby on Rails Action Pack 中由于不安全地使用 `render` 方法导致的远程代码执行漏洞。攻击者可以通过提供恶意构造的输入数据作为 `render` 方法的参数，从而执行任意 Ruby 代码。漏洞利用方式：

1.  **漏洞触发点：** 应用的某个功能使用了`render`方法，并且允许用户输入来决定渲染的内容。
2.  **攻击向量：** 攻击者构造包含恶意 Ruby 代码的字符串，并将其作为参数传递给 `render` 方法。
3.  **代码执行：** 由于 Rails 在处理 `render` 方法时，没有充分验证用户输入，导致恶意代码被执行。

**有效性：** 根据漏洞描述和搜索结果，此漏洞的POC已经公开，并且可以被利用。

**投毒风险：** 提供的漏洞利用代码只是一个LICENSE文件，无法评估是否存在投毒行为。即使有公开的POC存在，下载和使用任何第三方提供的代码都应该谨慎，并在安全的环境中进行测试。

**项目地址:** [sealldeveloper/CVE-2016-2098-PoC](https://github.com/sealldeveloper/CVE-2016-2098-PoC)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---



---

## POC #2

**来源**: [CVE-2016-2098-3rg1s_CVE-2016-2098.md](../2016/CVE-2016-2098-3rg1s_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序必须易受攻击，并且允许通过 render 方法使用不受信任的输入。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098 允许远程攻击者通过利用应用程序对 `render` 方法的不受限制使用来执行任意 Ruby 代码。漏洞存在于 Action Pack 中。根据提供的漏洞利用代码 `main.py`，攻击者可以通过构造包含恶意 Ruby 代码的 URL 参数（`[inline]`）来触发漏洞。该代码通过发送带有内联代码的 GET 请求，然后提取并打印服务器的响应。`README.md` 文件提供了漏洞的基本信息和使用说明。通过分析漏洞利用代码，没有发现任何明显的投毒迹象。代码逻辑简单，主要功能是发送请求并解析响应。因此，投毒风险评估为0%。利用方式是通过精心构造的 GET 请求，将恶意 Ruby 代码注入到 `render` 方法中执行。攻击者可以通过控制 `args` 变量来指定要执行的 Ruby 代码。

**项目地址:** [3rg1s/CVE-2016-2098](https://github.com/3rg1s/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #3

**来源**: [CVE-2016-2098-Alejandro-MartinG_rails-PoC-CVE-2016-2098.md](../2016/CVE-2016-2098-Alejandro-MartinG_rails-PoC-CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 3.2.22.2之前, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序必须允许通过`render`方法处理用户提供的输入

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails 的 Action Pack 组件中，由于对`render`方法的使用方式不当，允许远程攻击者执行任意 Ruby 代码。攻击者通过向`render`方法传递恶意构造的输入，可执行服务器端代码。漏洞利用代码 (POC) 表明，攻击者可以通过控制渲染的内容来注入恶意代码。提供的`Gemfile`和`Gemfile.lock`是 Rails 项目的依赖描述文件，用于指定项目所依赖的 Ruby Gems 及其版本。这些文件本身没有直接包含恶意代码，但它们指定了存在漏洞的 Rails 版本 (4.2.5.1)。

**有效性:**
提供的POC代码 (实际上是 Rails 项目的依赖描述文件) 与漏洞描述中受影响的版本一致，因此，如果目标应用使用存在漏洞的 Rails 版本并且允许用户可控的输入传递给`render`方法，那么该漏洞可以被成功利用。

**投毒风险:**
`Gemfile` 和 `Gemfile.lock` 文件本身不包含可执行代码，因此直接的投毒风险较低。但是，如果攻击者能够控制应用程序使用的 Gems 仓库或者能够篡改应用程序使用的 Gems，则可能存在通过引入被篡改的 Gems 来投毒的风险。对这些依赖项的评估表明，其中不太可能存在直接的投毒代码。投毒风险评估为5%。

**利用方式:**
利用方式是向易受攻击的 Rails 应用发送包含恶意参数的请求，这些参数会被传递给`render`方法，从而执行攻击者指定的 Ruby 代码。 例如，攻击者可以构造一个包含恶意代码的字符串，并将其作为模板名称或局部变量传递给`render`方法。当 Rails 应用尝试渲染该模板或使用该局部变量时，恶意代码就会被执行。根据 exploit-db 的 40086 描述，可以使用 `render :inline` 来执行代码。

**项目地址:** [Alejandro-MartinG/rails-PoC-CVE-2016-2098](https://github.com/Alejandro-MartinG/rails-PoC-CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #4

**来源**: [CVE-2016-2098-CyberDefenseInstitute_PoC_CVE-2016-2098_Rails42.md](../2016/CVE-2016-2098-CyberDefenseInstitute_PoC_CVE-2016-2098_Rails42.md)

## CVE-2016-2098-Ruby on Rails Action Pack RCE

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，允许远程攻击者执行任意Ruby代码

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序未使用安全的方式来处理render方法的用户输入

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-2098 漏洞是 Ruby on Rails Action Pack 中的一个远程代码执行漏洞。它允许远程攻击者通过利用应用程序对 `render` 方法的不受限制的使用来执行任意 Ruby 代码。

**漏洞分析：**

根据漏洞描述，漏洞的根源在于 Action Pack 组件在搜索用于渲染的模板时，处理用户提供的不可信输入的方式存在缺陷。如果应用程序将不可信的输入传递给 `render` 方法，攻击者可以构造恶意的输入来执行任意代码。

**POC 代码分析：**

提供的 POC 代码是 `Gemfile` 和 `Gemfile.lock` 文件，它们用于定义和锁定 Ruby 项目的依赖项。`Gemfile` 指定了项目使用的 Rails 版本 (4.2.5.1)，以及其他 gem 依赖项。`Gemfile.lock` 文件则记录了项目中使用的 gem 的确切版本，用于确保一致的构建。

这些文件本身并不包含漏洞利用代码，它们只是 Rails 应用配置的一部分。实际的漏洞利用需要向存在漏洞的 `render` 方法传递恶意的参数。

**有效性评估：**

POC 代码的有效性取决于目标应用程序是否使用了存在漏洞的 Rails 版本，并且允许用户控制传递给 `render` 方法的参数。如果满足这些条件，则漏洞利用是有效的。

**投毒风险评估：**

检查 `Gemfile` 和 `Gemfile.lock` 文件中是否存在投毒代码，需要检查是否有恶意或未知的 gem 依赖。当前提供的代码中，没有发现明显的投毒迹象。使用了常见的Rails版本和相关的gem包,例如 `rails`, `sqlite3`, `sass-rails`等。 但是，无法完全排除作者在其他地方添加恶意代码的可能性，例如在 `app` 目录下的 controller 或 view 文件中。

由于仅仅通过 `Gemfile` 和 `Gemfile.lock` 文件无法进行全面的代码审计，因此可以认为投毒风险非常低，约为1%。

**利用方式：**

1.  **找到易受攻击的 `render` 方法：** 确定应用程序中哪些地方使用了 `render` 方法，并且用户可以控制传递给 `render` 方法的参数。
2.  **构造恶意输入：** 构造包含恶意 Ruby 代码的输入字符串。例如，攻击者可以使用诸如 `<%= system('whoami') %>` 之类的代码来执行系统命令。
3.  **将恶意输入传递给 `render` 方法：** 将构造的恶意输入作为参数传递给 `render` 方法。这将导致应用程序执行恶意代码。

**总结：**

CVE-2016-2098 是一个严重的远程代码执行漏洞，需要及时修补。应用程序开发人员应该避免将不受信任的用户输入传递给 `render` 方法，并使用最新版本的 Rails 以获得安全修复。

**项目地址:** [CyberDefenseInstitute/PoC_CVE-2016-2098_Rails42](https://github.com/CyberDefenseInstitute/PoC_CVE-2016-2098_Rails42)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #5

**来源**: [CVE-2016-2098-DanielHemmati_CVE-2016-2098-my-first-exploit.md](../2016/CVE-2016-2098-DanielHemmati_CVE-2016-2098-my-first-exploit.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.x (< 3.2.22.2), 4.x (< 4.1.14.2), 4.2.x (< 4.2.5.2)

**利用条件:** 应用程序使用了`render`方法处理用户提供的不可信数据。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails 的 Action Pack 组件中，由于程序在处理`render`方法时未对用户输入进行充分的过滤和验证，导致远程攻击者可以执行任意 Ruby 代码。根据漏洞描述和搜索结果，攻击者可以通过构造特定的参数传递给`render`方法，从而执行恶意代码。

**有效性分析：**
提供的 Python 脚本`exploit.py` 旨在利用该漏洞。脚本允许用户指定目标 URL 和 payload。它将 payload 嵌入到 URL 中，并将其发送到目标应用程序。如果应用程序易受攻击，则会执行 payload 中包含的 Ruby 代码。该POC的有效性取决于目标Rails应用程序是否容易受到攻击且未进行修补。根据漏洞描述，低版本的 Rails 应用存在此风险。

**投毒风险分析：**
查看提供的 Python 脚本 `exploit.py` 和 `README.md`。`README.md` 文件只包含有关漏洞和脚本使用方法的描述，没有发现任何可疑代码。`exploit.py` 脚本的功能是构造和发送包含 payload 的 HTTP 请求，看起来相对简单直接。虽然脚本本身的功能是为了利用漏洞，但没有发现明显的后门或恶意代码。它接受用户提供的 payload 并将其发送到目标，因此恶意代码更有可能通过用户提供的 payload 注入到目标系统，而不是通过脚本本身进行投毒。因此，脚本本身的投毒风险较低，但使用时仍需谨慎，确保理解所执行的 payload 的含义。

**利用方式分析：**
1.  **确定目标：** 找到运行存在漏洞版本的 Ruby on Rails 应用程序。
2.  **构造 Payload：** 构建恶意的 Ruby 代码，例如执行系统命令。
3.  **发送请求：** 使用漏洞利用代码（或手动构造 HTTP 请求）将 payload 传递给应用程序的`render`方法，例如通过 URL 参数 `[inline]`。
4.  **执行代码：** 如果应用程序易受攻击，服务器将执行 payload 中的 Ruby 代码。

**示例：**
`python3 exploit.py -H "http://example.com/page?id=1"`
然后输入 payload: `system('whoami')` 。
如果成功，服务器会执行 `whoami` 命令，并将结果返回到攻击者。

综上所述，该漏洞的利用方式主要是通过操纵 `render` 方法的参数，注入恶意的 Ruby 代码，从而实现远程代码执行。该利用的有效性取决于目标应用程序的版本和配置。

**项目地址:** [DanielHemmati/CVE-2016-2098-my-first-exploit](https://github.com/DanielHemmati/CVE-2016-2098-my-first-exploit)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #6

**来源**: [CVE-2016-2098-Debalinax64_CVE-2016-2098.md](../2016/CVE-2016-2098-Debalinax64_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2 之前, 4.x 4.1.14.2 之前, 和 4.2.x 4.2.5.2 之前

**利用条件:** 目标应用使用了存在漏洞的Rails版本，并且应用程序允许使用render方法处理用户提供的输入。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails Action Pack 中，由于其 render 方法对用户输入未做严格限制，导致远程攻击者可以利用此漏洞执行任意 Ruby 代码，从而完全控制服务器。

**有效性：**
提供的POC代码是有效的。漏洞库信息，搜索引擎结果以及利用代码都表明可以通过`render`方法执行任意ruby代码。例如，可以使用`curl`发送包含恶意代码的请求，服务器会执行该代码。

**投毒风险：**
查看提供的 POC 代码 `/tmp/fb84a5f2be1c3ed581440d890e43983b/ruby-on-rail-RCE.sh`，该脚本主要功能是发送包含ruby代码的curl请求，执行用户指定的命令。脚本本身没有明显的恶意行为，例如反弹shell或下载其他恶意文件。因此，投毒风险较低，但考虑到脚本的执行环境和权限，以及可能被用于自动化攻击，存在一定风险。`/tmp/fb84a5f2be1c3ed581440d890e43983b/README.md`文件只是漏洞描述和使用说明，不存在投毒代码。总体评估风险比例为5%。

**利用方式：**
1.  攻击者需要找到一个使用了存在漏洞的Rails版本，并且允许使用render方法的应用程序。
2.  攻击者通过构造恶意的URL，将payload传递给`render`方法。 Payload形式是 `%3C%25=%20%25x('command')%20%25%3E`。 其中`command`参数是要在目标服务器上执行的命令。
3.  目标服务器在处理请求时，会执行该恶意Ruby代码，从而执行攻击者指定的命令。

**项目地址:** [Debalinax64/CVE-2016-2098](https://github.com/Debalinax64/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #7

**来源**: [CVE-2016-2098-JoseLRC97_Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution.md](../2016/CVE-2016-2098-JoseLRC97_Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution.md)

## CVE-2016-2098-Ruby on Rails Action Pack-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2之前, 4.x版本4.1.14.2之前, 4.2.x版本4.2.5.2之前

**利用条件:** 应用程序使用了`render`方法并且允许用户控制输入

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞。该漏洞源于应用程序对`render`方法的不受限制的使用。如果应用程序允许用户控制传递给`render`方法的参数，攻击者可以利用此漏洞执行任意Ruby代码。

**有效性：**
漏洞库信息和搜索引擎结果都确认了此漏洞的存在和严重性。Exploit-DB上存在相关的漏洞利用代码（https://www.exploit-db.com/exploits/40086/），进一步验证了漏洞的可利用性。

**投毒风险：**
提供的漏洞利用代码片段只是GNU通用公共许可证，并非漏洞的实际利用代码。因此，无法从中判断是否存在投毒风险。需要进一步分析实际的漏洞利用代码才能评估投毒风险。目前判断投毒风险为0%。

**利用方式：**
利用方式是，攻击者需要找到一个应用程序中使用了`render`方法并且允许用户控制输入的位置。然后，攻击者可以构造恶意的输入，例如包含Ruby代码的字符串，将其传递给`render`方法。`render`方法会执行该Ruby代码，从而导致远程代码执行。具体的payload取决于目标应用程序的上下文，但通常可以用于执行系统命令、读取敏感文件或在服务器上安装后门。

**项目地址:** [JoseLRC97/Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution](https://github.com/JoseLRC97/Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #8

**来源**: [CVE-2016-2098-Shakun8_CVE-2016-2098.md](../2016/CVE-2016-2098-Shakun8_CVE-2016-2098.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 目标应用使用了存在漏洞的Rails版本，且允许通过URL参数控制render方法。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞，源于对`render`方法的不受限制的使用。攻击者可以通过构造恶意的URL参数，将Ruby代码注入到`render`方法中执行，从而获得服务器的控制权。

**有效性：**
提供的POC代码`CVE-2016-2098.py`看起来是有效的。它使用`requests`库发送带有恶意参数的GET请求，其中参数值包含要执行的Ruby代码。Payload 构造的核心在于 `#{sys.argv[3]}[inline]=%3C%25=%20%25x({cmd})%20%25%3E` ，这部分代码将命令插入到ERB模板中，利用Rails的render方法执行任意代码。

**投毒风险：**
提供的漏洞利用代码中没有发现明显的投毒代码。该脚本的主要功能是发送包含恶意payload的HTTP请求，并打印响应结果。`README.md`文件仅包含漏洞名称和POC描述，没有可疑内容。因此，投毒风险较低，为0%。

**利用方式：**
1.  **确定目标应用是否使用了存在漏洞的Rails版本。**
2.  **构造包含恶意Ruby代码的URL参数。** 例如，使用提供的POC脚本：
    `python CVE-2016-2098.py 'system("whoami")' 'http://target.com/controller/action' 'payload'`
    这个命令会在目标服务器上执行`whoami`命令，并将结果返回。
3.  **发送包含恶意参数的HTTP请求。**
4.  **分析响应结果，确认代码是否成功执行。**

攻击者可以利用此漏洞执行任意系统命令，读取敏感文件，甚至完全控制服务器。修复此漏洞的方法是升级到受影响Rails版本以上的版本，或者限制对render方法的使用。

**项目地址:** [Shakun8/CVE-2016-2098](https://github.com/Shakun8/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #9

**来源**: [CVE-2016-2098-hderms_dh-CVE_2016_2098.md](../2016/CVE-2016-2098-hderms_dh-CVE_2016_2098.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，允许远程攻击者执行任意 Ruby 代码

**影响版本:** < 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序需要允许用户控制的输入传递给 render 方法

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-2098 存在于 Ruby on Rails 的 Action Pack 中，由于对 `render` 方法的使用未加限制，允许远程攻击者执行任意 Ruby 代码。根据漏洞信息，受影响的版本包括 3.2.22.2 之前的 3.x 版本、4.1.14.2 之前的 4.x 版本，以及 4.2.5.2 之前的 4.2.x 版本。

**漏洞利用方式：**
攻击者可以通过构造恶意的输入，将其传递给 `render` 方法，从而执行任意 Ruby 代码。这通常涉及到控制传递给 `render` 方法的模板名称或选项。根据搜索结果和漏洞库信息，漏洞的核心在于应用程序未能正确地过滤或转义用户提供的输入，直接将其用于渲染过程。

**POC 代码分析：**
提供的 POC 代码包含 `Gemfile` 和 `Gemfile.lock`。这些文件定义了 Ruby on Rails 应用的依赖。`Gemfile` 指定了 Rails 版本为 4.2.4，这属于受影响的版本范围。`Gemfile.lock` 锁定了具体的依赖版本，确保应用在不同环境中依赖的一致性。这些文件本身不包含直接的攻击代码，它们只是一个 Rails 应用的依赖描述文件，用于搭建易受攻击的环境。

**投毒风险分析：**
分析 `Gemfile` 和 `Gemfile.lock`，虽然没有明显的恶意代码，但依旧存在一定的投毒风险。攻击者可能通过修改 `Gemfile`，引入包含恶意代码的 gem 包。或者，虽然当前依赖没有问题，但未来依赖更新时，可能会引入包含漏洞或后门的 gem 包。当然，在提供的两个文件中，并没有发现后门或者漏洞代码，风险主要在于构建环境和引入存在风险的三方包。因此，投毒风险估计为 10%。

**项目地址:** [hderms/dh-CVE_2016_2098](https://github.com/hderms/dh-CVE_2016_2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #10

**来源**: [CVE-2016-2098-its-arun_CVE-2016-2098.md](../2016/CVE-2016-2098-its-arun_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，允许攻击者执行任意Ruby代码

**影响版本:** 3.2.22.2之前, 4.x 4.1.14.2之前, 和 4.2.x 4.2.5.2之前

**利用条件:** 目标应用使用了存在漏洞的Rails版本，且`render`方法以不安全的方式处理用户输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞。该漏洞源于对`render`方法的不安全使用，允许远程攻击者通过操纵用户提供的数据来执行任意Ruby代码。

**有效性：**

提供的POC代码利用了这一漏洞。通过向易受攻击的Rails应用发送特制的HTTP请求，攻击者可以在服务器上执行任意命令。

**投毒风险：**

代码本身的功能就是利用漏洞执行命令，没有发现恶意添加的额外功能代码。但是，下载和使用任何未经审查的漏洞利用代码都存在风险。POC代码的设计目标是利用漏洞，而攻击者可以修改这些POC代码以包含恶意功能，例如安装后门、窃取数据或进行其他恶意活动。
`README.md` 文件描述了漏洞和基本用法，未发现恶意代码。
`CVE-2016-2098.sh` 脚本相对简单，主要功能是构造恶意请求以利用漏洞。虽然脚本本身没有明显的恶意代码，但用户应始终谨慎审查并理解任何下载的代码。

**利用方式：**

1.  **确定目标:** 识别运行易受攻击的Ruby on Rails版本的Web应用程序。
2.  **构造Payload:** 使用POC脚本，构造包含要执行的Ruby代码的HTTP请求。此代码将作为`render`方法的参数传递。
3.  **发送Payload:** 将构造的HTTP请求发送到目标Web应用程序。
4.  **执行代码:** 如果目标应用程序易受攻击，服务器将执行嵌入在Payload中的Ruby代码。

脚本的工作方式是：

*   它接受三个参数：目标主机、URI 和要执行的命令。
*   它使用 `curl` 命令发送一个包含恶意 payload 的 HTTP 请求到目标服务器。Payload 利用 Rails `render` 方法执行任意命令。
*   它提供一个简单的交互式 shell，允许攻击者重复执行命令。

**项目地址:** [its-arun/CVE-2016-2098](https://github.com/its-arun/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #11

**来源**: [CVE-2016-2098-j4k0m_CVE-2016-2098.md](../2016/CVE-2016-2098-j4k0m_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails (Action Pack)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2之前, 4.x版本在4.1.14.2之前, 4.2.x版本在4.2.5.2之前

**利用条件:** 应用程序必须允许通过`render`方法处理用户提供的输入。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-2098 是一个 Ruby on Rails Action Pack 中的远程代码执行漏洞。攻击者可以通过向`render`方法提供恶意构造的输入来执行任意 Ruby 代码。  根据漏洞描述，漏洞根源在于Rails的`render`方法对用户输入的不当处理。POC 利用方式是通过`view[inline]`参数传递 Ruby 代码，该代码会被服务器执行。具体来说，POC 使用了 `<%= %x('[CMD]') %>` 这样的 Ruby 代码结构，其中 `[CMD]` 会被替换成想要执行的系统命令。例如，`<%= %x('whoami') %>` 会执行 `whoami` 命令，并将其输出显示在页面上。  利用步骤： 1. 确定目标 Rails 应用使用的 Rails 版本在受影响范围内。 2. 构造包含恶意 Ruby 代码的 URL，例如 `http://example.com/?view[inline]=<%= %x('whoami') %>` （需要 URL 编码）。 3. 将构造的 URL 发送到目标服务器。 4. 如果服务器存在漏洞，则会执行恶意代码，并将结果返回给攻击者。  投毒风险较低，主要因为 POC 代码的功能明确，目的是执行用户指定的命令。虽然攻击者可以利用该漏洞执行任何命令，但提供的 POC 本身不包含任何隐藏的恶意功能。 投毒的可能来自于下载后使用者更改后门,但原始版本后门概率极低。

**项目地址:** [j4k0m/CVE-2016-2098](https://github.com/j4k0m/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #12

**来源**: [CVE-2016-2098-sealldeveloper_CVE-2016-2098-PoC.md](../2016/CVE-2016-2098-sealldeveloper_CVE-2016-2098-PoC.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 3.2.22.2之前, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用使用了render方法并且允许用户可控的输入作为render方法的参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098 漏洞是 Ruby on Rails Action Pack 中由于不安全地使用 `render` 方法导致的远程代码执行漏洞。攻击者可以通过提供恶意构造的输入数据作为 `render` 方法的参数，从而执行任意 Ruby 代码。漏洞利用方式：

1.  **漏洞触发点：** 应用的某个功能使用了`render`方法，并且允许用户输入来决定渲染的内容。
2.  **攻击向量：** 攻击者构造包含恶意 Ruby 代码的字符串，并将其作为参数传递给 `render` 方法。
3.  **代码执行：** 由于 Rails 在处理 `render` 方法时，没有充分验证用户输入，导致恶意代码被执行。

**有效性：** 根据漏洞描述和搜索结果，此漏洞的POC已经公开，并且可以被利用。

**投毒风险：** 提供的漏洞利用代码只是一个LICENSE文件，无法评估是否存在投毒行为。即使有公开的POC存在，下载和使用任何第三方提供的代码都应该谨慎，并在安全的环境中进行测试。

**项目地址:** [sealldeveloper/CVE-2016-2098-PoC](https://github.com/sealldeveloper/CVE-2016-2098-PoC)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---



---

## POC #2

**来源**: [CVE-2016-2098-3rg1s_CVE-2016-2098.md](../2016/CVE-2016-2098-3rg1s_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序必须易受攻击，并且允许通过 render 方法使用不受信任的输入。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098 允许远程攻击者通过利用应用程序对 `render` 方法的不受限制使用来执行任意 Ruby 代码。漏洞存在于 Action Pack 中。根据提供的漏洞利用代码 `main.py`，攻击者可以通过构造包含恶意 Ruby 代码的 URL 参数（`[inline]`）来触发漏洞。该代码通过发送带有内联代码的 GET 请求，然后提取并打印服务器的响应。`README.md` 文件提供了漏洞的基本信息和使用说明。通过分析漏洞利用代码，没有发现任何明显的投毒迹象。代码逻辑简单，主要功能是发送请求并解析响应。因此，投毒风险评估为0%。利用方式是通过精心构造的 GET 请求，将恶意 Ruby 代码注入到 `render` 方法中执行。攻击者可以通过控制 `args` 变量来指定要执行的 Ruby 代码。

**项目地址:** [3rg1s/CVE-2016-2098](https://github.com/3rg1s/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #3

**来源**: [CVE-2016-2098-Alejandro-MartinG_rails-PoC-CVE-2016-2098.md](../2016/CVE-2016-2098-Alejandro-MartinG_rails-PoC-CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 3.2.22.2之前, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序必须允许通过`render`方法处理用户提供的输入

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails 的 Action Pack 组件中，由于对`render`方法的使用方式不当，允许远程攻击者执行任意 Ruby 代码。攻击者通过向`render`方法传递恶意构造的输入，可执行服务器端代码。漏洞利用代码 (POC) 表明，攻击者可以通过控制渲染的内容来注入恶意代码。提供的`Gemfile`和`Gemfile.lock`是 Rails 项目的依赖描述文件，用于指定项目所依赖的 Ruby Gems 及其版本。这些文件本身没有直接包含恶意代码，但它们指定了存在漏洞的 Rails 版本 (4.2.5.1)。

**有效性:**
提供的POC代码 (实际上是 Rails 项目的依赖描述文件) 与漏洞描述中受影响的版本一致，因此，如果目标应用使用存在漏洞的 Rails 版本并且允许用户可控的输入传递给`render`方法，那么该漏洞可以被成功利用。

**投毒风险:**
`Gemfile` 和 `Gemfile.lock` 文件本身不包含可执行代码，因此直接的投毒风险较低。但是，如果攻击者能够控制应用程序使用的 Gems 仓库或者能够篡改应用程序使用的 Gems，则可能存在通过引入被篡改的 Gems 来投毒的风险。对这些依赖项的评估表明，其中不太可能存在直接的投毒代码。投毒风险评估为5%。

**利用方式:**
利用方式是向易受攻击的 Rails 应用发送包含恶意参数的请求，这些参数会被传递给`render`方法，从而执行攻击者指定的 Ruby 代码。 例如，攻击者可以构造一个包含恶意代码的字符串，并将其作为模板名称或局部变量传递给`render`方法。当 Rails 应用尝试渲染该模板或使用该局部变量时，恶意代码就会被执行。根据 exploit-db 的 40086 描述，可以使用 `render :inline` 来执行代码。

**项目地址:** [Alejandro-MartinG/rails-PoC-CVE-2016-2098](https://github.com/Alejandro-MartinG/rails-PoC-CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #4

**来源**: [CVE-2016-2098-CyberDefenseInstitute_PoC_CVE-2016-2098_Rails42.md](../2016/CVE-2016-2098-CyberDefenseInstitute_PoC_CVE-2016-2098_Rails42.md)

## CVE-2016-2098-Ruby on Rails Action Pack RCE

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，允许远程攻击者执行任意Ruby代码

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序未使用安全的方式来处理render方法的用户输入

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-2098 漏洞是 Ruby on Rails Action Pack 中的一个远程代码执行漏洞。它允许远程攻击者通过利用应用程序对 `render` 方法的不受限制的使用来执行任意 Ruby 代码。

**漏洞分析：**

根据漏洞描述，漏洞的根源在于 Action Pack 组件在搜索用于渲染的模板时，处理用户提供的不可信输入的方式存在缺陷。如果应用程序将不可信的输入传递给 `render` 方法，攻击者可以构造恶意的输入来执行任意代码。

**POC 代码分析：**

提供的 POC 代码是 `Gemfile` 和 `Gemfile.lock` 文件，它们用于定义和锁定 Ruby 项目的依赖项。`Gemfile` 指定了项目使用的 Rails 版本 (4.2.5.1)，以及其他 gem 依赖项。`Gemfile.lock` 文件则记录了项目中使用的 gem 的确切版本，用于确保一致的构建。

这些文件本身并不包含漏洞利用代码，它们只是 Rails 应用配置的一部分。实际的漏洞利用需要向存在漏洞的 `render` 方法传递恶意的参数。

**有效性评估：**

POC 代码的有效性取决于目标应用程序是否使用了存在漏洞的 Rails 版本，并且允许用户控制传递给 `render` 方法的参数。如果满足这些条件，则漏洞利用是有效的。

**投毒风险评估：**

检查 `Gemfile` 和 `Gemfile.lock` 文件中是否存在投毒代码，需要检查是否有恶意或未知的 gem 依赖。当前提供的代码中，没有发现明显的投毒迹象。使用了常见的Rails版本和相关的gem包,例如 `rails`, `sqlite3`, `sass-rails`等。 但是，无法完全排除作者在其他地方添加恶意代码的可能性，例如在 `app` 目录下的 controller 或 view 文件中。

由于仅仅通过 `Gemfile` 和 `Gemfile.lock` 文件无法进行全面的代码审计，因此可以认为投毒风险非常低，约为1%。

**利用方式：**

1.  **找到易受攻击的 `render` 方法：** 确定应用程序中哪些地方使用了 `render` 方法，并且用户可以控制传递给 `render` 方法的参数。
2.  **构造恶意输入：** 构造包含恶意 Ruby 代码的输入字符串。例如，攻击者可以使用诸如 `<%= system('whoami') %>` 之类的代码来执行系统命令。
3.  **将恶意输入传递给 `render` 方法：** 将构造的恶意输入作为参数传递给 `render` 方法。这将导致应用程序执行恶意代码。

**总结：**

CVE-2016-2098 是一个严重的远程代码执行漏洞，需要及时修补。应用程序开发人员应该避免将不受信任的用户输入传递给 `render` 方法，并使用最新版本的 Rails 以获得安全修复。

**项目地址:** [CyberDefenseInstitute/PoC_CVE-2016-2098_Rails42](https://github.com/CyberDefenseInstitute/PoC_CVE-2016-2098_Rails42)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #5

**来源**: [CVE-2016-2098-DanielHemmati_CVE-2016-2098-my-first-exploit.md](../2016/CVE-2016-2098-DanielHemmati_CVE-2016-2098-my-first-exploit.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.x (< 3.2.22.2), 4.x (< 4.1.14.2), 4.2.x (< 4.2.5.2)

**利用条件:** 应用程序使用了`render`方法处理用户提供的不可信数据。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails 的 Action Pack 组件中，由于程序在处理`render`方法时未对用户输入进行充分的过滤和验证，导致远程攻击者可以执行任意 Ruby 代码。根据漏洞描述和搜索结果，攻击者可以通过构造特定的参数传递给`render`方法，从而执行恶意代码。

**有效性分析：**
提供的 Python 脚本`exploit.py` 旨在利用该漏洞。脚本允许用户指定目标 URL 和 payload。它将 payload 嵌入到 URL 中，并将其发送到目标应用程序。如果应用程序易受攻击，则会执行 payload 中包含的 Ruby 代码。该POC的有效性取决于目标Rails应用程序是否容易受到攻击且未进行修补。根据漏洞描述，低版本的 Rails 应用存在此风险。

**投毒风险分析：**
查看提供的 Python 脚本 `exploit.py` 和 `README.md`。`README.md` 文件只包含有关漏洞和脚本使用方法的描述，没有发现任何可疑代码。`exploit.py` 脚本的功能是构造和发送包含 payload 的 HTTP 请求，看起来相对简单直接。虽然脚本本身的功能是为了利用漏洞，但没有发现明显的后门或恶意代码。它接受用户提供的 payload 并将其发送到目标，因此恶意代码更有可能通过用户提供的 payload 注入到目标系统，而不是通过脚本本身进行投毒。因此，脚本本身的投毒风险较低，但使用时仍需谨慎，确保理解所执行的 payload 的含义。

**利用方式分析：**
1.  **确定目标：** 找到运行存在漏洞版本的 Ruby on Rails 应用程序。
2.  **构造 Payload：** 构建恶意的 Ruby 代码，例如执行系统命令。
3.  **发送请求：** 使用漏洞利用代码（或手动构造 HTTP 请求）将 payload 传递给应用程序的`render`方法，例如通过 URL 参数 `[inline]`。
4.  **执行代码：** 如果应用程序易受攻击，服务器将执行 payload 中的 Ruby 代码。

**示例：**
`python3 exploit.py -H "http://example.com/page?id=1"`
然后输入 payload: `system('whoami')` 。
如果成功，服务器会执行 `whoami` 命令，并将结果返回到攻击者。

综上所述，该漏洞的利用方式主要是通过操纵 `render` 方法的参数，注入恶意的 Ruby 代码，从而实现远程代码执行。该利用的有效性取决于目标应用程序的版本和配置。

**项目地址:** [DanielHemmati/CVE-2016-2098-my-first-exploit](https://github.com/DanielHemmati/CVE-2016-2098-my-first-exploit)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #6

**来源**: [CVE-2016-2098-Debalinax64_CVE-2016-2098.md](../2016/CVE-2016-2098-Debalinax64_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2 之前, 4.x 4.1.14.2 之前, 和 4.2.x 4.2.5.2 之前

**利用条件:** 目标应用使用了存在漏洞的Rails版本，并且应用程序允许使用render方法处理用户提供的输入。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails Action Pack 中，由于其 render 方法对用户输入未做严格限制，导致远程攻击者可以利用此漏洞执行任意 Ruby 代码，从而完全控制服务器。

**有效性：**
提供的POC代码是有效的。漏洞库信息，搜索引擎结果以及利用代码都表明可以通过`render`方法执行任意ruby代码。例如，可以使用`curl`发送包含恶意代码的请求，服务器会执行该代码。

**投毒风险：**
查看提供的 POC 代码 `/tmp/fb84a5f2be1c3ed581440d890e43983b/ruby-on-rail-RCE.sh`，该脚本主要功能是发送包含ruby代码的curl请求，执行用户指定的命令。脚本本身没有明显的恶意行为，例如反弹shell或下载其他恶意文件。因此，投毒风险较低，但考虑到脚本的执行环境和权限，以及可能被用于自动化攻击，存在一定风险。`/tmp/fb84a5f2be1c3ed581440d890e43983b/README.md`文件只是漏洞描述和使用说明，不存在投毒代码。总体评估风险比例为5%。

**利用方式：**
1.  攻击者需要找到一个使用了存在漏洞的Rails版本，并且允许使用render方法的应用程序。
2.  攻击者通过构造恶意的URL，将payload传递给`render`方法。 Payload形式是 `%3C%25=%20%25x('command')%20%25%3E`。 其中`command`参数是要在目标服务器上执行的命令。
3.  目标服务器在处理请求时，会执行该恶意Ruby代码，从而执行攻击者指定的命令。

**项目地址:** [Debalinax64/CVE-2016-2098](https://github.com/Debalinax64/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #7

**来源**: [CVE-2016-2098-JoseLRC97_Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution.md](../2016/CVE-2016-2098-JoseLRC97_Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution.md)

## CVE-2016-2098-Ruby on Rails Action Pack-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2之前, 4.x版本4.1.14.2之前, 4.2.x版本4.2.5.2之前

**利用条件:** 应用程序使用了`render`方法并且允许用户控制输入

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞。该漏洞源于应用程序对`render`方法的不受限制的使用。如果应用程序允许用户控制传递给`render`方法的参数，攻击者可以利用此漏洞执行任意Ruby代码。

**有效性：**
漏洞库信息和搜索引擎结果都确认了此漏洞的存在和严重性。Exploit-DB上存在相关的漏洞利用代码（https://www.exploit-db.com/exploits/40086/），进一步验证了漏洞的可利用性。

**投毒风险：**
提供的漏洞利用代码片段只是GNU通用公共许可证，并非漏洞的实际利用代码。因此，无法从中判断是否存在投毒风险。需要进一步分析实际的漏洞利用代码才能评估投毒风险。目前判断投毒风险为0%。

**利用方式：**
利用方式是，攻击者需要找到一个应用程序中使用了`render`方法并且允许用户控制输入的位置。然后，攻击者可以构造恶意的输入，例如包含Ruby代码的字符串，将其传递给`render`方法。`render`方法会执行该Ruby代码，从而导致远程代码执行。具体的payload取决于目标应用程序的上下文，但通常可以用于执行系统命令、读取敏感文件或在服务器上安装后门。

**项目地址:** [JoseLRC97/Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution](https://github.com/JoseLRC97/Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #8

**来源**: [CVE-2016-2098-Shakun8_CVE-2016-2098.md](../2016/CVE-2016-2098-Shakun8_CVE-2016-2098.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 目标应用使用了存在漏洞的Rails版本，且允许通过URL参数控制render方法。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞，源于对`render`方法的不受限制的使用。攻击者可以通过构造恶意的URL参数，将Ruby代码注入到`render`方法中执行，从而获得服务器的控制权。

**有效性：**
提供的POC代码`CVE-2016-2098.py`看起来是有效的。它使用`requests`库发送带有恶意参数的GET请求，其中参数值包含要执行的Ruby代码。Payload 构造的核心在于 `#{sys.argv[3]}[inline]=%3C%25=%20%25x({cmd})%20%25%3E` ，这部分代码将命令插入到ERB模板中，利用Rails的render方法执行任意代码。

**投毒风险：**
提供的漏洞利用代码中没有发现明显的投毒代码。该脚本的主要功能是发送包含恶意payload的HTTP请求，并打印响应结果。`README.md`文件仅包含漏洞名称和POC描述，没有可疑内容。因此，投毒风险较低，为0%。

**利用方式：**
1.  **确定目标应用是否使用了存在漏洞的Rails版本。**
2.  **构造包含恶意Ruby代码的URL参数。** 例如，使用提供的POC脚本：
    `python CVE-2016-2098.py 'system("whoami")' 'http://target.com/controller/action' 'payload'`
    这个命令会在目标服务器上执行`whoami`命令，并将结果返回。
3.  **发送包含恶意参数的HTTP请求。**
4.  **分析响应结果，确认代码是否成功执行。**

攻击者可以利用此漏洞执行任意系统命令，读取敏感文件，甚至完全控制服务器。修复此漏洞的方法是升级到受影响Rails版本以上的版本，或者限制对render方法的使用。

**项目地址:** [Shakun8/CVE-2016-2098](https://github.com/Shakun8/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #9

**来源**: [CVE-2016-2098-hderms_dh-CVE_2016_2098.md](../2016/CVE-2016-2098-hderms_dh-CVE_2016_2098.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，允许远程攻击者执行任意 Ruby 代码

**影响版本:** < 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序需要允许用户控制的输入传递给 render 方法

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-2098 存在于 Ruby on Rails 的 Action Pack 中，由于对 `render` 方法的使用未加限制，允许远程攻击者执行任意 Ruby 代码。根据漏洞信息，受影响的版本包括 3.2.22.2 之前的 3.x 版本、4.1.14.2 之前的 4.x 版本，以及 4.2.5.2 之前的 4.2.x 版本。

**漏洞利用方式：**
攻击者可以通过构造恶意的输入，将其传递给 `render` 方法，从而执行任意 Ruby 代码。这通常涉及到控制传递给 `render` 方法的模板名称或选项。根据搜索结果和漏洞库信息，漏洞的核心在于应用程序未能正确地过滤或转义用户提供的输入，直接将其用于渲染过程。

**POC 代码分析：**
提供的 POC 代码包含 `Gemfile` 和 `Gemfile.lock`。这些文件定义了 Ruby on Rails 应用的依赖。`Gemfile` 指定了 Rails 版本为 4.2.4，这属于受影响的版本范围。`Gemfile.lock` 锁定了具体的依赖版本，确保应用在不同环境中依赖的一致性。这些文件本身不包含直接的攻击代码，它们只是一个 Rails 应用的依赖描述文件，用于搭建易受攻击的环境。

**投毒风险分析：**
分析 `Gemfile` 和 `Gemfile.lock`，虽然没有明显的恶意代码，但依旧存在一定的投毒风险。攻击者可能通过修改 `Gemfile`，引入包含恶意代码的 gem 包。或者，虽然当前依赖没有问题，但未来依赖更新时，可能会引入包含漏洞或后门的 gem 包。当然，在提供的两个文件中，并没有发现后门或者漏洞代码，风险主要在于构建环境和引入存在风险的三方包。因此，投毒风险估计为 10%。

**项目地址:** [hderms/dh-CVE_2016_2098](https://github.com/hderms/dh-CVE_2016_2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #10

**来源**: [CVE-2016-2098-its-arun_CVE-2016-2098.md](../2016/CVE-2016-2098-its-arun_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，允许攻击者执行任意Ruby代码

**影响版本:** 3.2.22.2之前, 4.x 4.1.14.2之前, 和 4.2.x 4.2.5.2之前

**利用条件:** 目标应用使用了存在漏洞的Rails版本，且`render`方法以不安全的方式处理用户输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞。该漏洞源于对`render`方法的不安全使用，允许远程攻击者通过操纵用户提供的数据来执行任意Ruby代码。

**有效性：**

提供的POC代码利用了这一漏洞。通过向易受攻击的Rails应用发送特制的HTTP请求，攻击者可以在服务器上执行任意命令。

**投毒风险：**

代码本身的功能就是利用漏洞执行命令，没有发现恶意添加的额外功能代码。但是，下载和使用任何未经审查的漏洞利用代码都存在风险。POC代码的设计目标是利用漏洞，而攻击者可以修改这些POC代码以包含恶意功能，例如安装后门、窃取数据或进行其他恶意活动。
`README.md` 文件描述了漏洞和基本用法，未发现恶意代码。
`CVE-2016-2098.sh` 脚本相对简单，主要功能是构造恶意请求以利用漏洞。虽然脚本本身没有明显的恶意代码，但用户应始终谨慎审查并理解任何下载的代码。

**利用方式：**

1.  **确定目标:** 识别运行易受攻击的Ruby on Rails版本的Web应用程序。
2.  **构造Payload:** 使用POC脚本，构造包含要执行的Ruby代码的HTTP请求。此代码将作为`render`方法的参数传递。
3.  **发送Payload:** 将构造的HTTP请求发送到目标Web应用程序。
4.  **执行代码:** 如果目标应用程序易受攻击，服务器将执行嵌入在Payload中的Ruby代码。

脚本的工作方式是：

*   它接受三个参数：目标主机、URI 和要执行的命令。
*   它使用 `curl` 命令发送一个包含恶意 payload 的 HTTP 请求到目标服务器。Payload 利用 Rails `render` 方法执行任意命令。
*   它提供一个简单的交互式 shell，允许攻击者重复执行命令。

**项目地址:** [its-arun/CVE-2016-2098](https://github.com/its-arun/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #11

**来源**: [CVE-2016-2098-j4k0m_CVE-2016-2098.md](../2016/CVE-2016-2098-j4k0m_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails (Action Pack)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2之前, 4.x版本在4.1.14.2之前, 4.2.x版本在4.2.5.2之前

**利用条件:** 应用程序必须允许通过`render`方法处理用户提供的输入。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-2098 是一个 Ruby on Rails Action Pack 中的远程代码执行漏洞。攻击者可以通过向`render`方法提供恶意构造的输入来执行任意 Ruby 代码。  根据漏洞描述，漏洞根源在于Rails的`render`方法对用户输入的不当处理。POC 利用方式是通过`view[inline]`参数传递 Ruby 代码，该代码会被服务器执行。具体来说，POC 使用了 `<%= %x('[CMD]') %>` 这样的 Ruby 代码结构，其中 `[CMD]` 会被替换成想要执行的系统命令。例如，`<%= %x('whoami') %>` 会执行 `whoami` 命令，并将其输出显示在页面上。  利用步骤： 1. 确定目标 Rails 应用使用的 Rails 版本在受影响范围内。 2. 构造包含恶意 Ruby 代码的 URL，例如 `http://example.com/?view[inline]=<%= %x('whoami') %>` （需要 URL 编码）。 3. 将构造的 URL 发送到目标服务器。 4. 如果服务器存在漏洞，则会执行恶意代码，并将结果返回给攻击者。  投毒风险较低，主要因为 POC 代码的功能明确，目的是执行用户指定的命令。虽然攻击者可以利用该漏洞执行任何命令，但提供的 POC 本身不包含任何隐藏的恶意功能。 投毒的可能来自于下载后使用者更改后门,但原始版本后门概率极低。

**项目地址:** [j4k0m/CVE-2016-2098](https://github.com/j4k0m/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #12

**来源**: [CVE-2016-2098-sealldeveloper_CVE-2016-2098-PoC.md](../2016/CVE-2016-2098-sealldeveloper_CVE-2016-2098-PoC.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 3.2.22.2之前, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用使用了render方法并且允许用户可控的输入作为render方法的参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098 漏洞是 Ruby on Rails Action Pack 中由于不安全地使用 `render` 方法导致的远程代码执行漏洞。攻击者可以通过提供恶意构造的输入数据作为 `render` 方法的参数，从而执行任意 Ruby 代码。漏洞利用方式：

1.  **漏洞触发点：** 应用的某个功能使用了`render`方法，并且允许用户输入来决定渲染的内容。
2.  **攻击向量：** 攻击者构造包含恶意 Ruby 代码的字符串，并将其作为参数传递给 `render` 方法。
3.  **代码执行：** 由于 Rails 在处理 `render` 方法时，没有充分验证用户输入，导致恶意代码被执行。

**有效性：** 根据漏洞描述和搜索结果，此漏洞的POC已经公开，并且可以被利用。

**投毒风险：** 提供的漏洞利用代码只是一个LICENSE文件，无法评估是否存在投毒行为。即使有公开的POC存在，下载和使用任何第三方提供的代码都应该谨慎，并在安全的环境中进行测试。

**项目地址:** [sealldeveloper/CVE-2016-2098-PoC](https://github.com/sealldeveloper/CVE-2016-2098-PoC)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---



---

## POC #2

**来源**: [CVE-2016-2098-3rg1s_CVE-2016-2098.md](../2016/CVE-2016-2098-3rg1s_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序必须易受攻击，并且允许通过 render 方法使用不受信任的输入。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098 允许远程攻击者通过利用应用程序对 `render` 方法的不受限制使用来执行任意 Ruby 代码。漏洞存在于 Action Pack 中。根据提供的漏洞利用代码 `main.py`，攻击者可以通过构造包含恶意 Ruby 代码的 URL 参数（`[inline]`）来触发漏洞。该代码通过发送带有内联代码的 GET 请求，然后提取并打印服务器的响应。`README.md` 文件提供了漏洞的基本信息和使用说明。通过分析漏洞利用代码，没有发现任何明显的投毒迹象。代码逻辑简单，主要功能是发送请求并解析响应。因此，投毒风险评估为0%。利用方式是通过精心构造的 GET 请求，将恶意 Ruby 代码注入到 `render` 方法中执行。攻击者可以通过控制 `args` 变量来指定要执行的 Ruby 代码。

**项目地址:** [3rg1s/CVE-2016-2098](https://github.com/3rg1s/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #3

**来源**: [CVE-2016-2098-Alejandro-MartinG_rails-PoC-CVE-2016-2098.md](../2016/CVE-2016-2098-Alejandro-MartinG_rails-PoC-CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 3.2.22.2之前, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序必须允许通过`render`方法处理用户提供的输入

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails 的 Action Pack 组件中，由于对`render`方法的使用方式不当，允许远程攻击者执行任意 Ruby 代码。攻击者通过向`render`方法传递恶意构造的输入，可执行服务器端代码。漏洞利用代码 (POC) 表明，攻击者可以通过控制渲染的内容来注入恶意代码。提供的`Gemfile`和`Gemfile.lock`是 Rails 项目的依赖描述文件，用于指定项目所依赖的 Ruby Gems 及其版本。这些文件本身没有直接包含恶意代码，但它们指定了存在漏洞的 Rails 版本 (4.2.5.1)。

**有效性:**
提供的POC代码 (实际上是 Rails 项目的依赖描述文件) 与漏洞描述中受影响的版本一致，因此，如果目标应用使用存在漏洞的 Rails 版本并且允许用户可控的输入传递给`render`方法，那么该漏洞可以被成功利用。

**投毒风险:**
`Gemfile` 和 `Gemfile.lock` 文件本身不包含可执行代码，因此直接的投毒风险较低。但是，如果攻击者能够控制应用程序使用的 Gems 仓库或者能够篡改应用程序使用的 Gems，则可能存在通过引入被篡改的 Gems 来投毒的风险。对这些依赖项的评估表明，其中不太可能存在直接的投毒代码。投毒风险评估为5%。

**利用方式:**
利用方式是向易受攻击的 Rails 应用发送包含恶意参数的请求，这些参数会被传递给`render`方法，从而执行攻击者指定的 Ruby 代码。 例如，攻击者可以构造一个包含恶意代码的字符串，并将其作为模板名称或局部变量传递给`render`方法。当 Rails 应用尝试渲染该模板或使用该局部变量时，恶意代码就会被执行。根据 exploit-db 的 40086 描述，可以使用 `render :inline` 来执行代码。

**项目地址:** [Alejandro-MartinG/rails-PoC-CVE-2016-2098](https://github.com/Alejandro-MartinG/rails-PoC-CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #4

**来源**: [CVE-2016-2098-CyberDefenseInstitute_PoC_CVE-2016-2098_Rails42.md](../2016/CVE-2016-2098-CyberDefenseInstitute_PoC_CVE-2016-2098_Rails42.md)

## CVE-2016-2098-Ruby on Rails Action Pack RCE

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，允许远程攻击者执行任意Ruby代码

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序未使用安全的方式来处理render方法的用户输入

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-2098 漏洞是 Ruby on Rails Action Pack 中的一个远程代码执行漏洞。它允许远程攻击者通过利用应用程序对 `render` 方法的不受限制的使用来执行任意 Ruby 代码。

**漏洞分析：**

根据漏洞描述，漏洞的根源在于 Action Pack 组件在搜索用于渲染的模板时，处理用户提供的不可信输入的方式存在缺陷。如果应用程序将不可信的输入传递给 `render` 方法，攻击者可以构造恶意的输入来执行任意代码。

**POC 代码分析：**

提供的 POC 代码是 `Gemfile` 和 `Gemfile.lock` 文件，它们用于定义和锁定 Ruby 项目的依赖项。`Gemfile` 指定了项目使用的 Rails 版本 (4.2.5.1)，以及其他 gem 依赖项。`Gemfile.lock` 文件则记录了项目中使用的 gem 的确切版本，用于确保一致的构建。

这些文件本身并不包含漏洞利用代码，它们只是 Rails 应用配置的一部分。实际的漏洞利用需要向存在漏洞的 `render` 方法传递恶意的参数。

**有效性评估：**

POC 代码的有效性取决于目标应用程序是否使用了存在漏洞的 Rails 版本，并且允许用户控制传递给 `render` 方法的参数。如果满足这些条件，则漏洞利用是有效的。

**投毒风险评估：**

检查 `Gemfile` 和 `Gemfile.lock` 文件中是否存在投毒代码，需要检查是否有恶意或未知的 gem 依赖。当前提供的代码中，没有发现明显的投毒迹象。使用了常见的Rails版本和相关的gem包,例如 `rails`, `sqlite3`, `sass-rails`等。 但是，无法完全排除作者在其他地方添加恶意代码的可能性，例如在 `app` 目录下的 controller 或 view 文件中。

由于仅仅通过 `Gemfile` 和 `Gemfile.lock` 文件无法进行全面的代码审计，因此可以认为投毒风险非常低，约为1%。

**利用方式：**

1.  **找到易受攻击的 `render` 方法：** 确定应用程序中哪些地方使用了 `render` 方法，并且用户可以控制传递给 `render` 方法的参数。
2.  **构造恶意输入：** 构造包含恶意 Ruby 代码的输入字符串。例如，攻击者可以使用诸如 `<%= system('whoami') %>` 之类的代码来执行系统命令。
3.  **将恶意输入传递给 `render` 方法：** 将构造的恶意输入作为参数传递给 `render` 方法。这将导致应用程序执行恶意代码。

**总结：**

CVE-2016-2098 是一个严重的远程代码执行漏洞，需要及时修补。应用程序开发人员应该避免将不受信任的用户输入传递给 `render` 方法，并使用最新版本的 Rails 以获得安全修复。

**项目地址:** [CyberDefenseInstitute/PoC_CVE-2016-2098_Rails42](https://github.com/CyberDefenseInstitute/PoC_CVE-2016-2098_Rails42)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #5

**来源**: [CVE-2016-2098-DanielHemmati_CVE-2016-2098-my-first-exploit.md](../2016/CVE-2016-2098-DanielHemmati_CVE-2016-2098-my-first-exploit.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.x (< 3.2.22.2), 4.x (< 4.1.14.2), 4.2.x (< 4.2.5.2)

**利用条件:** 应用程序使用了`render`方法处理用户提供的不可信数据。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails 的 Action Pack 组件中，由于程序在处理`render`方法时未对用户输入进行充分的过滤和验证，导致远程攻击者可以执行任意 Ruby 代码。根据漏洞描述和搜索结果，攻击者可以通过构造特定的参数传递给`render`方法，从而执行恶意代码。

**有效性分析：**
提供的 Python 脚本`exploit.py` 旨在利用该漏洞。脚本允许用户指定目标 URL 和 payload。它将 payload 嵌入到 URL 中，并将其发送到目标应用程序。如果应用程序易受攻击，则会执行 payload 中包含的 Ruby 代码。该POC的有效性取决于目标Rails应用程序是否容易受到攻击且未进行修补。根据漏洞描述，低版本的 Rails 应用存在此风险。

**投毒风险分析：**
查看提供的 Python 脚本 `exploit.py` 和 `README.md`。`README.md` 文件只包含有关漏洞和脚本使用方法的描述，没有发现任何可疑代码。`exploit.py` 脚本的功能是构造和发送包含 payload 的 HTTP 请求，看起来相对简单直接。虽然脚本本身的功能是为了利用漏洞，但没有发现明显的后门或恶意代码。它接受用户提供的 payload 并将其发送到目标，因此恶意代码更有可能通过用户提供的 payload 注入到目标系统，而不是通过脚本本身进行投毒。因此，脚本本身的投毒风险较低，但使用时仍需谨慎，确保理解所执行的 payload 的含义。

**利用方式分析：**
1.  **确定目标：** 找到运行存在漏洞版本的 Ruby on Rails 应用程序。
2.  **构造 Payload：** 构建恶意的 Ruby 代码，例如执行系统命令。
3.  **发送请求：** 使用漏洞利用代码（或手动构造 HTTP 请求）将 payload 传递给应用程序的`render`方法，例如通过 URL 参数 `[inline]`。
4.  **执行代码：** 如果应用程序易受攻击，服务器将执行 payload 中的 Ruby 代码。

**示例：**
`python3 exploit.py -H "http://example.com/page?id=1"`
然后输入 payload: `system('whoami')` 。
如果成功，服务器会执行 `whoami` 命令，并将结果返回到攻击者。

综上所述，该漏洞的利用方式主要是通过操纵 `render` 方法的参数，注入恶意的 Ruby 代码，从而实现远程代码执行。该利用的有效性取决于目标应用程序的版本和配置。

**项目地址:** [DanielHemmati/CVE-2016-2098-my-first-exploit](https://github.com/DanielHemmati/CVE-2016-2098-my-first-exploit)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #6

**来源**: [CVE-2016-2098-Debalinax64_CVE-2016-2098.md](../2016/CVE-2016-2098-Debalinax64_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2 之前, 4.x 4.1.14.2 之前, 和 4.2.x 4.2.5.2 之前

**利用条件:** 目标应用使用了存在漏洞的Rails版本，并且应用程序允许使用render方法处理用户提供的输入。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails Action Pack 中，由于其 render 方法对用户输入未做严格限制，导致远程攻击者可以利用此漏洞执行任意 Ruby 代码，从而完全控制服务器。

**有效性：**
提供的POC代码是有效的。漏洞库信息，搜索引擎结果以及利用代码都表明可以通过`render`方法执行任意ruby代码。例如，可以使用`curl`发送包含恶意代码的请求，服务器会执行该代码。

**投毒风险：**
查看提供的 POC 代码 `/tmp/fb84a5f2be1c3ed581440d890e43983b/ruby-on-rail-RCE.sh`，该脚本主要功能是发送包含ruby代码的curl请求，执行用户指定的命令。脚本本身没有明显的恶意行为，例如反弹shell或下载其他恶意文件。因此，投毒风险较低，但考虑到脚本的执行环境和权限，以及可能被用于自动化攻击，存在一定风险。`/tmp/fb84a5f2be1c3ed581440d890e43983b/README.md`文件只是漏洞描述和使用说明，不存在投毒代码。总体评估风险比例为5%。

**利用方式：**
1.  攻击者需要找到一个使用了存在漏洞的Rails版本，并且允许使用render方法的应用程序。
2.  攻击者通过构造恶意的URL，将payload传递给`render`方法。 Payload形式是 `%3C%25=%20%25x('command')%20%25%3E`。 其中`command`参数是要在目标服务器上执行的命令。
3.  目标服务器在处理请求时，会执行该恶意Ruby代码，从而执行攻击者指定的命令。

**项目地址:** [Debalinax64/CVE-2016-2098](https://github.com/Debalinax64/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #7

**来源**: [CVE-2016-2098-JoseLRC97_Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution.md](../2016/CVE-2016-2098-JoseLRC97_Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution.md)

## CVE-2016-2098-Ruby on Rails Action Pack-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2之前, 4.x版本4.1.14.2之前, 4.2.x版本4.2.5.2之前

**利用条件:** 应用程序使用了`render`方法并且允许用户控制输入

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞。该漏洞源于应用程序对`render`方法的不受限制的使用。如果应用程序允许用户控制传递给`render`方法的参数，攻击者可以利用此漏洞执行任意Ruby代码。

**有效性：**
漏洞库信息和搜索引擎结果都确认了此漏洞的存在和严重性。Exploit-DB上存在相关的漏洞利用代码（https://www.exploit-db.com/exploits/40086/），进一步验证了漏洞的可利用性。

**投毒风险：**
提供的漏洞利用代码片段只是GNU通用公共许可证，并非漏洞的实际利用代码。因此，无法从中判断是否存在投毒风险。需要进一步分析实际的漏洞利用代码才能评估投毒风险。目前判断投毒风险为0%。

**利用方式：**
利用方式是，攻击者需要找到一个应用程序中使用了`render`方法并且允许用户控制输入的位置。然后，攻击者可以构造恶意的输入，例如包含Ruby代码的字符串，将其传递给`render`方法。`render`方法会执行该Ruby代码，从而导致远程代码执行。具体的payload取决于目标应用程序的上下文，但通常可以用于执行系统命令、读取敏感文件或在服务器上安装后门。

**项目地址:** [JoseLRC97/Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution](https://github.com/JoseLRC97/Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #8

**来源**: [CVE-2016-2098-Shakun8_CVE-2016-2098.md](../2016/CVE-2016-2098-Shakun8_CVE-2016-2098.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 目标应用使用了存在漏洞的Rails版本，且允许通过URL参数控制render方法。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞，源于对`render`方法的不受限制的使用。攻击者可以通过构造恶意的URL参数，将Ruby代码注入到`render`方法中执行，从而获得服务器的控制权。

**有效性：**
提供的POC代码`CVE-2016-2098.py`看起来是有效的。它使用`requests`库发送带有恶意参数的GET请求，其中参数值包含要执行的Ruby代码。Payload 构造的核心在于 `#{sys.argv[3]}[inline]=%3C%25=%20%25x({cmd})%20%25%3E` ，这部分代码将命令插入到ERB模板中，利用Rails的render方法执行任意代码。

**投毒风险：**
提供的漏洞利用代码中没有发现明显的投毒代码。该脚本的主要功能是发送包含恶意payload的HTTP请求，并打印响应结果。`README.md`文件仅包含漏洞名称和POC描述，没有可疑内容。因此，投毒风险较低，为0%。

**利用方式：**
1.  **确定目标应用是否使用了存在漏洞的Rails版本。**
2.  **构造包含恶意Ruby代码的URL参数。** 例如，使用提供的POC脚本：
    `python CVE-2016-2098.py 'system("whoami")' 'http://target.com/controller/action' 'payload'`
    这个命令会在目标服务器上执行`whoami`命令，并将结果返回。
3.  **发送包含恶意参数的HTTP请求。**
4.  **分析响应结果，确认代码是否成功执行。**

攻击者可以利用此漏洞执行任意系统命令，读取敏感文件，甚至完全控制服务器。修复此漏洞的方法是升级到受影响Rails版本以上的版本，或者限制对render方法的使用。

**项目地址:** [Shakun8/CVE-2016-2098](https://github.com/Shakun8/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #9

**来源**: [CVE-2016-2098-hderms_dh-CVE_2016_2098.md](../2016/CVE-2016-2098-hderms_dh-CVE_2016_2098.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，允许远程攻击者执行任意 Ruby 代码

**影响版本:** < 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序需要允许用户控制的输入传递给 render 方法

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-2098 存在于 Ruby on Rails 的 Action Pack 中，由于对 `render` 方法的使用未加限制，允许远程攻击者执行任意 Ruby 代码。根据漏洞信息，受影响的版本包括 3.2.22.2 之前的 3.x 版本、4.1.14.2 之前的 4.x 版本，以及 4.2.5.2 之前的 4.2.x 版本。

**漏洞利用方式：**
攻击者可以通过构造恶意的输入，将其传递给 `render` 方法，从而执行任意 Ruby 代码。这通常涉及到控制传递给 `render` 方法的模板名称或选项。根据搜索结果和漏洞库信息，漏洞的核心在于应用程序未能正确地过滤或转义用户提供的输入，直接将其用于渲染过程。

**POC 代码分析：**
提供的 POC 代码包含 `Gemfile` 和 `Gemfile.lock`。这些文件定义了 Ruby on Rails 应用的依赖。`Gemfile` 指定了 Rails 版本为 4.2.4，这属于受影响的版本范围。`Gemfile.lock` 锁定了具体的依赖版本，确保应用在不同环境中依赖的一致性。这些文件本身不包含直接的攻击代码，它们只是一个 Rails 应用的依赖描述文件，用于搭建易受攻击的环境。

**投毒风险分析：**
分析 `Gemfile` 和 `Gemfile.lock`，虽然没有明显的恶意代码，但依旧存在一定的投毒风险。攻击者可能通过修改 `Gemfile`，引入包含恶意代码的 gem 包。或者，虽然当前依赖没有问题，但未来依赖更新时，可能会引入包含漏洞或后门的 gem 包。当然，在提供的两个文件中，并没有发现后门或者漏洞代码，风险主要在于构建环境和引入存在风险的三方包。因此，投毒风险估计为 10%。

**项目地址:** [hderms/dh-CVE_2016_2098](https://github.com/hderms/dh-CVE_2016_2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #10

**来源**: [CVE-2016-2098-its-arun_CVE-2016-2098.md](../2016/CVE-2016-2098-its-arun_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，允许攻击者执行任意Ruby代码

**影响版本:** 3.2.22.2之前, 4.x 4.1.14.2之前, 和 4.2.x 4.2.5.2之前

**利用条件:** 目标应用使用了存在漏洞的Rails版本，且`render`方法以不安全的方式处理用户输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞。该漏洞源于对`render`方法的不安全使用，允许远程攻击者通过操纵用户提供的数据来执行任意Ruby代码。

**有效性：**

提供的POC代码利用了这一漏洞。通过向易受攻击的Rails应用发送特制的HTTP请求，攻击者可以在服务器上执行任意命令。

**投毒风险：**

代码本身的功能就是利用漏洞执行命令，没有发现恶意添加的额外功能代码。但是，下载和使用任何未经审查的漏洞利用代码都存在风险。POC代码的设计目标是利用漏洞，而攻击者可以修改这些POC代码以包含恶意功能，例如安装后门、窃取数据或进行其他恶意活动。
`README.md` 文件描述了漏洞和基本用法，未发现恶意代码。
`CVE-2016-2098.sh` 脚本相对简单，主要功能是构造恶意请求以利用漏洞。虽然脚本本身没有明显的恶意代码，但用户应始终谨慎审查并理解任何下载的代码。

**利用方式：**

1.  **确定目标:** 识别运行易受攻击的Ruby on Rails版本的Web应用程序。
2.  **构造Payload:** 使用POC脚本，构造包含要执行的Ruby代码的HTTP请求。此代码将作为`render`方法的参数传递。
3.  **发送Payload:** 将构造的HTTP请求发送到目标Web应用程序。
4.  **执行代码:** 如果目标应用程序易受攻击，服务器将执行嵌入在Payload中的Ruby代码。

脚本的工作方式是：

*   它接受三个参数：目标主机、URI 和要执行的命令。
*   它使用 `curl` 命令发送一个包含恶意 payload 的 HTTP 请求到目标服务器。Payload 利用 Rails `render` 方法执行任意命令。
*   它提供一个简单的交互式 shell，允许攻击者重复执行命令。

**项目地址:** [its-arun/CVE-2016-2098](https://github.com/its-arun/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #11

**来源**: [CVE-2016-2098-j4k0m_CVE-2016-2098.md](../2016/CVE-2016-2098-j4k0m_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails (Action Pack)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2之前, 4.x版本在4.1.14.2之前, 4.2.x版本在4.2.5.2之前

**利用条件:** 应用程序必须允许通过`render`方法处理用户提供的输入。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-2098 是一个 Ruby on Rails Action Pack 中的远程代码执行漏洞。攻击者可以通过向`render`方法提供恶意构造的输入来执行任意 Ruby 代码。  根据漏洞描述，漏洞根源在于Rails的`render`方法对用户输入的不当处理。POC 利用方式是通过`view[inline]`参数传递 Ruby 代码，该代码会被服务器执行。具体来说，POC 使用了 `<%= %x('[CMD]') %>` 这样的 Ruby 代码结构，其中 `[CMD]` 会被替换成想要执行的系统命令。例如，`<%= %x('whoami') %>` 会执行 `whoami` 命令，并将其输出显示在页面上。  利用步骤： 1. 确定目标 Rails 应用使用的 Rails 版本在受影响范围内。 2. 构造包含恶意 Ruby 代码的 URL，例如 `http://example.com/?view[inline]=<%= %x('whoami') %>` （需要 URL 编码）。 3. 将构造的 URL 发送到目标服务器。 4. 如果服务器存在漏洞，则会执行恶意代码，并将结果返回给攻击者。  投毒风险较低，主要因为 POC 代码的功能明确，目的是执行用户指定的命令。虽然攻击者可以利用该漏洞执行任何命令，但提供的 POC 本身不包含任何隐藏的恶意功能。 投毒的可能来自于下载后使用者更改后门,但原始版本后门概率极低。

**项目地址:** [j4k0m/CVE-2016-2098](https://github.com/j4k0m/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #12

**来源**: [CVE-2016-2098-sealldeveloper_CVE-2016-2098-PoC.md](../2016/CVE-2016-2098-sealldeveloper_CVE-2016-2098-PoC.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 3.2.22.2之前, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用使用了render方法并且允许用户可控的输入作为render方法的参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098 漏洞是 Ruby on Rails Action Pack 中由于不安全地使用 `render` 方法导致的远程代码执行漏洞。攻击者可以通过提供恶意构造的输入数据作为 `render` 方法的参数，从而执行任意 Ruby 代码。漏洞利用方式：

1.  **漏洞触发点：** 应用的某个功能使用了`render`方法，并且允许用户输入来决定渲染的内容。
2.  **攻击向量：** 攻击者构造包含恶意 Ruby 代码的字符串，并将其作为参数传递给 `render` 方法。
3.  **代码执行：** 由于 Rails 在处理 `render` 方法时，没有充分验证用户输入，导致恶意代码被执行。

**有效性：** 根据漏洞描述和搜索结果，此漏洞的POC已经公开，并且可以被利用。

**投毒风险：** 提供的漏洞利用代码只是一个LICENSE文件，无法评估是否存在投毒行为。即使有公开的POC存在，下载和使用任何第三方提供的代码都应该谨慎，并在安全的环境中进行测试。

**项目地址:** [sealldeveloper/CVE-2016-2098-PoC](https://github.com/sealldeveloper/CVE-2016-2098-PoC)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---



---

## POC #2

**来源**: [CVE-2016-2098-3rg1s_CVE-2016-2098.md](../2016/CVE-2016-2098-3rg1s_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序必须易受攻击，并且允许通过 render 方法使用不受信任的输入。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098 允许远程攻击者通过利用应用程序对 `render` 方法的不受限制使用来执行任意 Ruby 代码。漏洞存在于 Action Pack 中。根据提供的漏洞利用代码 `main.py`，攻击者可以通过构造包含恶意 Ruby 代码的 URL 参数（`[inline]`）来触发漏洞。该代码通过发送带有内联代码的 GET 请求，然后提取并打印服务器的响应。`README.md` 文件提供了漏洞的基本信息和使用说明。通过分析漏洞利用代码，没有发现任何明显的投毒迹象。代码逻辑简单，主要功能是发送请求并解析响应。因此，投毒风险评估为0%。利用方式是通过精心构造的 GET 请求，将恶意 Ruby 代码注入到 `render` 方法中执行。攻击者可以通过控制 `args` 变量来指定要执行的 Ruby 代码。

**项目地址:** [3rg1s/CVE-2016-2098](https://github.com/3rg1s/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #3

**来源**: [CVE-2016-2098-Alejandro-MartinG_rails-PoC-CVE-2016-2098.md](../2016/CVE-2016-2098-Alejandro-MartinG_rails-PoC-CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 3.2.22.2之前, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序必须允许通过`render`方法处理用户提供的输入

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails 的 Action Pack 组件中，由于对`render`方法的使用方式不当，允许远程攻击者执行任意 Ruby 代码。攻击者通过向`render`方法传递恶意构造的输入，可执行服务器端代码。漏洞利用代码 (POC) 表明，攻击者可以通过控制渲染的内容来注入恶意代码。提供的`Gemfile`和`Gemfile.lock`是 Rails 项目的依赖描述文件，用于指定项目所依赖的 Ruby Gems 及其版本。这些文件本身没有直接包含恶意代码，但它们指定了存在漏洞的 Rails 版本 (4.2.5.1)。

**有效性:**
提供的POC代码 (实际上是 Rails 项目的依赖描述文件) 与漏洞描述中受影响的版本一致，因此，如果目标应用使用存在漏洞的 Rails 版本并且允许用户可控的输入传递给`render`方法，那么该漏洞可以被成功利用。

**投毒风险:**
`Gemfile` 和 `Gemfile.lock` 文件本身不包含可执行代码，因此直接的投毒风险较低。但是，如果攻击者能够控制应用程序使用的 Gems 仓库或者能够篡改应用程序使用的 Gems，则可能存在通过引入被篡改的 Gems 来投毒的风险。对这些依赖项的评估表明，其中不太可能存在直接的投毒代码。投毒风险评估为5%。

**利用方式:**
利用方式是向易受攻击的 Rails 应用发送包含恶意参数的请求，这些参数会被传递给`render`方法，从而执行攻击者指定的 Ruby 代码。 例如，攻击者可以构造一个包含恶意代码的字符串，并将其作为模板名称或局部变量传递给`render`方法。当 Rails 应用尝试渲染该模板或使用该局部变量时，恶意代码就会被执行。根据 exploit-db 的 40086 描述，可以使用 `render :inline` 来执行代码。

**项目地址:** [Alejandro-MartinG/rails-PoC-CVE-2016-2098](https://github.com/Alejandro-MartinG/rails-PoC-CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #4

**来源**: [CVE-2016-2098-CyberDefenseInstitute_PoC_CVE-2016-2098_Rails42.md](../2016/CVE-2016-2098-CyberDefenseInstitute_PoC_CVE-2016-2098_Rails42.md)

## CVE-2016-2098-Ruby on Rails Action Pack RCE

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，允许远程攻击者执行任意Ruby代码

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序未使用安全的方式来处理render方法的用户输入

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-2098 漏洞是 Ruby on Rails Action Pack 中的一个远程代码执行漏洞。它允许远程攻击者通过利用应用程序对 `render` 方法的不受限制的使用来执行任意 Ruby 代码。

**漏洞分析：**

根据漏洞描述，漏洞的根源在于 Action Pack 组件在搜索用于渲染的模板时，处理用户提供的不可信输入的方式存在缺陷。如果应用程序将不可信的输入传递给 `render` 方法，攻击者可以构造恶意的输入来执行任意代码。

**POC 代码分析：**

提供的 POC 代码是 `Gemfile` 和 `Gemfile.lock` 文件，它们用于定义和锁定 Ruby 项目的依赖项。`Gemfile` 指定了项目使用的 Rails 版本 (4.2.5.1)，以及其他 gem 依赖项。`Gemfile.lock` 文件则记录了项目中使用的 gem 的确切版本，用于确保一致的构建。

这些文件本身并不包含漏洞利用代码，它们只是 Rails 应用配置的一部分。实际的漏洞利用需要向存在漏洞的 `render` 方法传递恶意的参数。

**有效性评估：**

POC 代码的有效性取决于目标应用程序是否使用了存在漏洞的 Rails 版本，并且允许用户控制传递给 `render` 方法的参数。如果满足这些条件，则漏洞利用是有效的。

**投毒风险评估：**

检查 `Gemfile` 和 `Gemfile.lock` 文件中是否存在投毒代码，需要检查是否有恶意或未知的 gem 依赖。当前提供的代码中，没有发现明显的投毒迹象。使用了常见的Rails版本和相关的gem包,例如 `rails`, `sqlite3`, `sass-rails`等。 但是，无法完全排除作者在其他地方添加恶意代码的可能性，例如在 `app` 目录下的 controller 或 view 文件中。

由于仅仅通过 `Gemfile` 和 `Gemfile.lock` 文件无法进行全面的代码审计，因此可以认为投毒风险非常低，约为1%。

**利用方式：**

1.  **找到易受攻击的 `render` 方法：** 确定应用程序中哪些地方使用了 `render` 方法，并且用户可以控制传递给 `render` 方法的参数。
2.  **构造恶意输入：** 构造包含恶意 Ruby 代码的输入字符串。例如，攻击者可以使用诸如 `<%= system('whoami') %>` 之类的代码来执行系统命令。
3.  **将恶意输入传递给 `render` 方法：** 将构造的恶意输入作为参数传递给 `render` 方法。这将导致应用程序执行恶意代码。

**总结：**

CVE-2016-2098 是一个严重的远程代码执行漏洞，需要及时修补。应用程序开发人员应该避免将不受信任的用户输入传递给 `render` 方法，并使用最新版本的 Rails 以获得安全修复。

**项目地址:** [CyberDefenseInstitute/PoC_CVE-2016-2098_Rails42](https://github.com/CyberDefenseInstitute/PoC_CVE-2016-2098_Rails42)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #5

**来源**: [CVE-2016-2098-DanielHemmati_CVE-2016-2098-my-first-exploit.md](../2016/CVE-2016-2098-DanielHemmati_CVE-2016-2098-my-first-exploit.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.x (< 3.2.22.2), 4.x (< 4.1.14.2), 4.2.x (< 4.2.5.2)

**利用条件:** 应用程序使用了`render`方法处理用户提供的不可信数据。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails 的 Action Pack 组件中，由于程序在处理`render`方法时未对用户输入进行充分的过滤和验证，导致远程攻击者可以执行任意 Ruby 代码。根据漏洞描述和搜索结果，攻击者可以通过构造特定的参数传递给`render`方法，从而执行恶意代码。

**有效性分析：**
提供的 Python 脚本`exploit.py` 旨在利用该漏洞。脚本允许用户指定目标 URL 和 payload。它将 payload 嵌入到 URL 中，并将其发送到目标应用程序。如果应用程序易受攻击，则会执行 payload 中包含的 Ruby 代码。该POC的有效性取决于目标Rails应用程序是否容易受到攻击且未进行修补。根据漏洞描述，低版本的 Rails 应用存在此风险。

**投毒风险分析：**
查看提供的 Python 脚本 `exploit.py` 和 `README.md`。`README.md` 文件只包含有关漏洞和脚本使用方法的描述，没有发现任何可疑代码。`exploit.py` 脚本的功能是构造和发送包含 payload 的 HTTP 请求，看起来相对简单直接。虽然脚本本身的功能是为了利用漏洞，但没有发现明显的后门或恶意代码。它接受用户提供的 payload 并将其发送到目标，因此恶意代码更有可能通过用户提供的 payload 注入到目标系统，而不是通过脚本本身进行投毒。因此，脚本本身的投毒风险较低，但使用时仍需谨慎，确保理解所执行的 payload 的含义。

**利用方式分析：**
1.  **确定目标：** 找到运行存在漏洞版本的 Ruby on Rails 应用程序。
2.  **构造 Payload：** 构建恶意的 Ruby 代码，例如执行系统命令。
3.  **发送请求：** 使用漏洞利用代码（或手动构造 HTTP 请求）将 payload 传递给应用程序的`render`方法，例如通过 URL 参数 `[inline]`。
4.  **执行代码：** 如果应用程序易受攻击，服务器将执行 payload 中的 Ruby 代码。

**示例：**
`python3 exploit.py -H "http://example.com/page?id=1"`
然后输入 payload: `system('whoami')` 。
如果成功，服务器会执行 `whoami` 命令，并将结果返回到攻击者。

综上所述，该漏洞的利用方式主要是通过操纵 `render` 方法的参数，注入恶意的 Ruby 代码，从而实现远程代码执行。该利用的有效性取决于目标应用程序的版本和配置。

**项目地址:** [DanielHemmati/CVE-2016-2098-my-first-exploit](https://github.com/DanielHemmati/CVE-2016-2098-my-first-exploit)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #6

**来源**: [CVE-2016-2098-Debalinax64_CVE-2016-2098.md](../2016/CVE-2016-2098-Debalinax64_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2 之前, 4.x 4.1.14.2 之前, 和 4.2.x 4.2.5.2 之前

**利用条件:** 目标应用使用了存在漏洞的Rails版本，并且应用程序允许使用render方法处理用户提供的输入。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails Action Pack 中，由于其 render 方法对用户输入未做严格限制，导致远程攻击者可以利用此漏洞执行任意 Ruby 代码，从而完全控制服务器。

**有效性：**
提供的POC代码是有效的。漏洞库信息，搜索引擎结果以及利用代码都表明可以通过`render`方法执行任意ruby代码。例如，可以使用`curl`发送包含恶意代码的请求，服务器会执行该代码。

**投毒风险：**
查看提供的 POC 代码 `/tmp/fb84a5f2be1c3ed581440d890e43983b/ruby-on-rail-RCE.sh`，该脚本主要功能是发送包含ruby代码的curl请求，执行用户指定的命令。脚本本身没有明显的恶意行为，例如反弹shell或下载其他恶意文件。因此，投毒风险较低，但考虑到脚本的执行环境和权限，以及可能被用于自动化攻击，存在一定风险。`/tmp/fb84a5f2be1c3ed581440d890e43983b/README.md`文件只是漏洞描述和使用说明，不存在投毒代码。总体评估风险比例为5%。

**利用方式：**
1.  攻击者需要找到一个使用了存在漏洞的Rails版本，并且允许使用render方法的应用程序。
2.  攻击者通过构造恶意的URL，将payload传递给`render`方法。 Payload形式是 `%3C%25=%20%25x('command')%20%25%3E`。 其中`command`参数是要在目标服务器上执行的命令。
3.  目标服务器在处理请求时，会执行该恶意Ruby代码，从而执行攻击者指定的命令。

**项目地址:** [Debalinax64/CVE-2016-2098](https://github.com/Debalinax64/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #7

**来源**: [CVE-2016-2098-JoseLRC97_Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution.md](../2016/CVE-2016-2098-JoseLRC97_Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution.md)

## CVE-2016-2098-Ruby on Rails Action Pack-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2之前, 4.x版本4.1.14.2之前, 4.2.x版本4.2.5.2之前

**利用条件:** 应用程序使用了`render`方法并且允许用户控制输入

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞。该漏洞源于应用程序对`render`方法的不受限制的使用。如果应用程序允许用户控制传递给`render`方法的参数，攻击者可以利用此漏洞执行任意Ruby代码。

**有效性：**
漏洞库信息和搜索引擎结果都确认了此漏洞的存在和严重性。Exploit-DB上存在相关的漏洞利用代码（https://www.exploit-db.com/exploits/40086/），进一步验证了漏洞的可利用性。

**投毒风险：**
提供的漏洞利用代码片段只是GNU通用公共许可证，并非漏洞的实际利用代码。因此，无法从中判断是否存在投毒风险。需要进一步分析实际的漏洞利用代码才能评估投毒风险。目前判断投毒风险为0%。

**利用方式：**
利用方式是，攻击者需要找到一个应用程序中使用了`render`方法并且允许用户控制输入的位置。然后，攻击者可以构造恶意的输入，例如包含Ruby代码的字符串，将其传递给`render`方法。`render`方法会执行该Ruby代码，从而导致远程代码执行。具体的payload取决于目标应用程序的上下文，但通常可以用于执行系统命令、读取敏感文件或在服务器上安装后门。

**项目地址:** [JoseLRC97/Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution](https://github.com/JoseLRC97/Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #8

**来源**: [CVE-2016-2098-Shakun8_CVE-2016-2098.md](../2016/CVE-2016-2098-Shakun8_CVE-2016-2098.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 目标应用使用了存在漏洞的Rails版本，且允许通过URL参数控制render方法。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞，源于对`render`方法的不受限制的使用。攻击者可以通过构造恶意的URL参数，将Ruby代码注入到`render`方法中执行，从而获得服务器的控制权。

**有效性：**
提供的POC代码`CVE-2016-2098.py`看起来是有效的。它使用`requests`库发送带有恶意参数的GET请求，其中参数值包含要执行的Ruby代码。Payload 构造的核心在于 `#{sys.argv[3]}[inline]=%3C%25=%20%25x({cmd})%20%25%3E` ，这部分代码将命令插入到ERB模板中，利用Rails的render方法执行任意代码。

**投毒风险：**
提供的漏洞利用代码中没有发现明显的投毒代码。该脚本的主要功能是发送包含恶意payload的HTTP请求，并打印响应结果。`README.md`文件仅包含漏洞名称和POC描述，没有可疑内容。因此，投毒风险较低，为0%。

**利用方式：**
1.  **确定目标应用是否使用了存在漏洞的Rails版本。**
2.  **构造包含恶意Ruby代码的URL参数。** 例如，使用提供的POC脚本：
    `python CVE-2016-2098.py 'system("whoami")' 'http://target.com/controller/action' 'payload'`
    这个命令会在目标服务器上执行`whoami`命令，并将结果返回。
3.  **发送包含恶意参数的HTTP请求。**
4.  **分析响应结果，确认代码是否成功执行。**

攻击者可以利用此漏洞执行任意系统命令，读取敏感文件，甚至完全控制服务器。修复此漏洞的方法是升级到受影响Rails版本以上的版本，或者限制对render方法的使用。

**项目地址:** [Shakun8/CVE-2016-2098](https://github.com/Shakun8/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #9

**来源**: [CVE-2016-2098-hderms_dh-CVE_2016_2098.md](../2016/CVE-2016-2098-hderms_dh-CVE_2016_2098.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，允许远程攻击者执行任意 Ruby 代码

**影响版本:** < 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序需要允许用户控制的输入传递给 render 方法

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-2098 存在于 Ruby on Rails 的 Action Pack 中，由于对 `render` 方法的使用未加限制，允许远程攻击者执行任意 Ruby 代码。根据漏洞信息，受影响的版本包括 3.2.22.2 之前的 3.x 版本、4.1.14.2 之前的 4.x 版本，以及 4.2.5.2 之前的 4.2.x 版本。

**漏洞利用方式：**
攻击者可以通过构造恶意的输入，将其传递给 `render` 方法，从而执行任意 Ruby 代码。这通常涉及到控制传递给 `render` 方法的模板名称或选项。根据搜索结果和漏洞库信息，漏洞的核心在于应用程序未能正确地过滤或转义用户提供的输入，直接将其用于渲染过程。

**POC 代码分析：**
提供的 POC 代码包含 `Gemfile` 和 `Gemfile.lock`。这些文件定义了 Ruby on Rails 应用的依赖。`Gemfile` 指定了 Rails 版本为 4.2.4，这属于受影响的版本范围。`Gemfile.lock` 锁定了具体的依赖版本，确保应用在不同环境中依赖的一致性。这些文件本身不包含直接的攻击代码，它们只是一个 Rails 应用的依赖描述文件，用于搭建易受攻击的环境。

**投毒风险分析：**
分析 `Gemfile` 和 `Gemfile.lock`，虽然没有明显的恶意代码，但依旧存在一定的投毒风险。攻击者可能通过修改 `Gemfile`，引入包含恶意代码的 gem 包。或者，虽然当前依赖没有问题，但未来依赖更新时，可能会引入包含漏洞或后门的 gem 包。当然，在提供的两个文件中，并没有发现后门或者漏洞代码，风险主要在于构建环境和引入存在风险的三方包。因此，投毒风险估计为 10%。

**项目地址:** [hderms/dh-CVE_2016_2098](https://github.com/hderms/dh-CVE_2016_2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #10

**来源**: [CVE-2016-2098-its-arun_CVE-2016-2098.md](../2016/CVE-2016-2098-its-arun_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，允许攻击者执行任意Ruby代码

**影响版本:** 3.2.22.2之前, 4.x 4.1.14.2之前, 和 4.2.x 4.2.5.2之前

**利用条件:** 目标应用使用了存在漏洞的Rails版本，且`render`方法以不安全的方式处理用户输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞。该漏洞源于对`render`方法的不安全使用，允许远程攻击者通过操纵用户提供的数据来执行任意Ruby代码。

**有效性：**

提供的POC代码利用了这一漏洞。通过向易受攻击的Rails应用发送特制的HTTP请求，攻击者可以在服务器上执行任意命令。

**投毒风险：**

代码本身的功能就是利用漏洞执行命令，没有发现恶意添加的额外功能代码。但是，下载和使用任何未经审查的漏洞利用代码都存在风险。POC代码的设计目标是利用漏洞，而攻击者可以修改这些POC代码以包含恶意功能，例如安装后门、窃取数据或进行其他恶意活动。
`README.md` 文件描述了漏洞和基本用法，未发现恶意代码。
`CVE-2016-2098.sh` 脚本相对简单，主要功能是构造恶意请求以利用漏洞。虽然脚本本身没有明显的恶意代码，但用户应始终谨慎审查并理解任何下载的代码。

**利用方式：**

1.  **确定目标:** 识别运行易受攻击的Ruby on Rails版本的Web应用程序。
2.  **构造Payload:** 使用POC脚本，构造包含要执行的Ruby代码的HTTP请求。此代码将作为`render`方法的参数传递。
3.  **发送Payload:** 将构造的HTTP请求发送到目标Web应用程序。
4.  **执行代码:** 如果目标应用程序易受攻击，服务器将执行嵌入在Payload中的Ruby代码。

脚本的工作方式是：

*   它接受三个参数：目标主机、URI 和要执行的命令。
*   它使用 `curl` 命令发送一个包含恶意 payload 的 HTTP 请求到目标服务器。Payload 利用 Rails `render` 方法执行任意命令。
*   它提供一个简单的交互式 shell，允许攻击者重复执行命令。

**项目地址:** [its-arun/CVE-2016-2098](https://github.com/its-arun/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #11

**来源**: [CVE-2016-2098-j4k0m_CVE-2016-2098.md](../2016/CVE-2016-2098-j4k0m_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails (Action Pack)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2之前, 4.x版本在4.1.14.2之前, 4.2.x版本在4.2.5.2之前

**利用条件:** 应用程序必须允许通过`render`方法处理用户提供的输入。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-2098 是一个 Ruby on Rails Action Pack 中的远程代码执行漏洞。攻击者可以通过向`render`方法提供恶意构造的输入来执行任意 Ruby 代码。  根据漏洞描述，漏洞根源在于Rails的`render`方法对用户输入的不当处理。POC 利用方式是通过`view[inline]`参数传递 Ruby 代码，该代码会被服务器执行。具体来说，POC 使用了 `<%= %x('[CMD]') %>` 这样的 Ruby 代码结构，其中 `[CMD]` 会被替换成想要执行的系统命令。例如，`<%= %x('whoami') %>` 会执行 `whoami` 命令，并将其输出显示在页面上。  利用步骤： 1. 确定目标 Rails 应用使用的 Rails 版本在受影响范围内。 2. 构造包含恶意 Ruby 代码的 URL，例如 `http://example.com/?view[inline]=<%= %x('whoami') %>` （需要 URL 编码）。 3. 将构造的 URL 发送到目标服务器。 4. 如果服务器存在漏洞，则会执行恶意代码，并将结果返回给攻击者。  投毒风险较低，主要因为 POC 代码的功能明确，目的是执行用户指定的命令。虽然攻击者可以利用该漏洞执行任何命令，但提供的 POC 本身不包含任何隐藏的恶意功能。 投毒的可能来自于下载后使用者更改后门,但原始版本后门概率极低。

**项目地址:** [j4k0m/CVE-2016-2098](https://github.com/j4k0m/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #12

**来源**: [CVE-2016-2098-sealldeveloper_CVE-2016-2098-PoC.md](../2016/CVE-2016-2098-sealldeveloper_CVE-2016-2098-PoC.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 3.2.22.2之前, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用使用了render方法并且允许用户可控的输入作为render方法的参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098 漏洞是 Ruby on Rails Action Pack 中由于不安全地使用 `render` 方法导致的远程代码执行漏洞。攻击者可以通过提供恶意构造的输入数据作为 `render` 方法的参数，从而执行任意 Ruby 代码。漏洞利用方式：

1.  **漏洞触发点：** 应用的某个功能使用了`render`方法，并且允许用户输入来决定渲染的内容。
2.  **攻击向量：** 攻击者构造包含恶意 Ruby 代码的字符串，并将其作为参数传递给 `render` 方法。
3.  **代码执行：** 由于 Rails 在处理 `render` 方法时，没有充分验证用户输入，导致恶意代码被执行。

**有效性：** 根据漏洞描述和搜索结果，此漏洞的POC已经公开，并且可以被利用。

**投毒风险：** 提供的漏洞利用代码只是一个LICENSE文件，无法评估是否存在投毒行为。即使有公开的POC存在，下载和使用任何第三方提供的代码都应该谨慎，并在安全的环境中进行测试。

**项目地址:** [sealldeveloper/CVE-2016-2098-PoC](https://github.com/sealldeveloper/CVE-2016-2098-PoC)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---



---

## POC #2

**来源**: [CVE-2016-2098-3rg1s_CVE-2016-2098.md](../2016/CVE-2016-2098-3rg1s_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序必须易受攻击，并且允许通过 render 方法使用不受信任的输入。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098 允许远程攻击者通过利用应用程序对 `render` 方法的不受限制使用来执行任意 Ruby 代码。漏洞存在于 Action Pack 中。根据提供的漏洞利用代码 `main.py`，攻击者可以通过构造包含恶意 Ruby 代码的 URL 参数（`[inline]`）来触发漏洞。该代码通过发送带有内联代码的 GET 请求，然后提取并打印服务器的响应。`README.md` 文件提供了漏洞的基本信息和使用说明。通过分析漏洞利用代码，没有发现任何明显的投毒迹象。代码逻辑简单，主要功能是发送请求并解析响应。因此，投毒风险评估为0%。利用方式是通过精心构造的 GET 请求，将恶意 Ruby 代码注入到 `render` 方法中执行。攻击者可以通过控制 `args` 变量来指定要执行的 Ruby 代码。

**项目地址:** [3rg1s/CVE-2016-2098](https://github.com/3rg1s/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #3

**来源**: [CVE-2016-2098-Alejandro-MartinG_rails-PoC-CVE-2016-2098.md](../2016/CVE-2016-2098-Alejandro-MartinG_rails-PoC-CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 3.2.22.2之前, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序必须允许通过`render`方法处理用户提供的输入

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails 的 Action Pack 组件中，由于对`render`方法的使用方式不当，允许远程攻击者执行任意 Ruby 代码。攻击者通过向`render`方法传递恶意构造的输入，可执行服务器端代码。漏洞利用代码 (POC) 表明，攻击者可以通过控制渲染的内容来注入恶意代码。提供的`Gemfile`和`Gemfile.lock`是 Rails 项目的依赖描述文件，用于指定项目所依赖的 Ruby Gems 及其版本。这些文件本身没有直接包含恶意代码，但它们指定了存在漏洞的 Rails 版本 (4.2.5.1)。

**有效性:**
提供的POC代码 (实际上是 Rails 项目的依赖描述文件) 与漏洞描述中受影响的版本一致，因此，如果目标应用使用存在漏洞的 Rails 版本并且允许用户可控的输入传递给`render`方法，那么该漏洞可以被成功利用。

**投毒风险:**
`Gemfile` 和 `Gemfile.lock` 文件本身不包含可执行代码，因此直接的投毒风险较低。但是，如果攻击者能够控制应用程序使用的 Gems 仓库或者能够篡改应用程序使用的 Gems，则可能存在通过引入被篡改的 Gems 来投毒的风险。对这些依赖项的评估表明，其中不太可能存在直接的投毒代码。投毒风险评估为5%。

**利用方式:**
利用方式是向易受攻击的 Rails 应用发送包含恶意参数的请求，这些参数会被传递给`render`方法，从而执行攻击者指定的 Ruby 代码。 例如，攻击者可以构造一个包含恶意代码的字符串，并将其作为模板名称或局部变量传递给`render`方法。当 Rails 应用尝试渲染该模板或使用该局部变量时，恶意代码就会被执行。根据 exploit-db 的 40086 描述，可以使用 `render :inline` 来执行代码。

**项目地址:** [Alejandro-MartinG/rails-PoC-CVE-2016-2098](https://github.com/Alejandro-MartinG/rails-PoC-CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #4

**来源**: [CVE-2016-2098-CyberDefenseInstitute_PoC_CVE-2016-2098_Rails42.md](../2016/CVE-2016-2098-CyberDefenseInstitute_PoC_CVE-2016-2098_Rails42.md)

## CVE-2016-2098-Ruby on Rails Action Pack RCE

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，允许远程攻击者执行任意Ruby代码

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序未使用安全的方式来处理render方法的用户输入

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-2098 漏洞是 Ruby on Rails Action Pack 中的一个远程代码执行漏洞。它允许远程攻击者通过利用应用程序对 `render` 方法的不受限制的使用来执行任意 Ruby 代码。

**漏洞分析：**

根据漏洞描述，漏洞的根源在于 Action Pack 组件在搜索用于渲染的模板时，处理用户提供的不可信输入的方式存在缺陷。如果应用程序将不可信的输入传递给 `render` 方法，攻击者可以构造恶意的输入来执行任意代码。

**POC 代码分析：**

提供的 POC 代码是 `Gemfile` 和 `Gemfile.lock` 文件，它们用于定义和锁定 Ruby 项目的依赖项。`Gemfile` 指定了项目使用的 Rails 版本 (4.2.5.1)，以及其他 gem 依赖项。`Gemfile.lock` 文件则记录了项目中使用的 gem 的确切版本，用于确保一致的构建。

这些文件本身并不包含漏洞利用代码，它们只是 Rails 应用配置的一部分。实际的漏洞利用需要向存在漏洞的 `render` 方法传递恶意的参数。

**有效性评估：**

POC 代码的有效性取决于目标应用程序是否使用了存在漏洞的 Rails 版本，并且允许用户控制传递给 `render` 方法的参数。如果满足这些条件，则漏洞利用是有效的。

**投毒风险评估：**

检查 `Gemfile` 和 `Gemfile.lock` 文件中是否存在投毒代码，需要检查是否有恶意或未知的 gem 依赖。当前提供的代码中，没有发现明显的投毒迹象。使用了常见的Rails版本和相关的gem包,例如 `rails`, `sqlite3`, `sass-rails`等。 但是，无法完全排除作者在其他地方添加恶意代码的可能性，例如在 `app` 目录下的 controller 或 view 文件中。

由于仅仅通过 `Gemfile` 和 `Gemfile.lock` 文件无法进行全面的代码审计，因此可以认为投毒风险非常低，约为1%。

**利用方式：**

1.  **找到易受攻击的 `render` 方法：** 确定应用程序中哪些地方使用了 `render` 方法，并且用户可以控制传递给 `render` 方法的参数。
2.  **构造恶意输入：** 构造包含恶意 Ruby 代码的输入字符串。例如，攻击者可以使用诸如 `<%= system('whoami') %>` 之类的代码来执行系统命令。
3.  **将恶意输入传递给 `render` 方法：** 将构造的恶意输入作为参数传递给 `render` 方法。这将导致应用程序执行恶意代码。

**总结：**

CVE-2016-2098 是一个严重的远程代码执行漏洞，需要及时修补。应用程序开发人员应该避免将不受信任的用户输入传递给 `render` 方法，并使用最新版本的 Rails 以获得安全修复。

**项目地址:** [CyberDefenseInstitute/PoC_CVE-2016-2098_Rails42](https://github.com/CyberDefenseInstitute/PoC_CVE-2016-2098_Rails42)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #5

**来源**: [CVE-2016-2098-DanielHemmati_CVE-2016-2098-my-first-exploit.md](../2016/CVE-2016-2098-DanielHemmati_CVE-2016-2098-my-first-exploit.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.x (< 3.2.22.2), 4.x (< 4.1.14.2), 4.2.x (< 4.2.5.2)

**利用条件:** 应用程序使用了`render`方法处理用户提供的不可信数据。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails 的 Action Pack 组件中，由于程序在处理`render`方法时未对用户输入进行充分的过滤和验证，导致远程攻击者可以执行任意 Ruby 代码。根据漏洞描述和搜索结果，攻击者可以通过构造特定的参数传递给`render`方法，从而执行恶意代码。

**有效性分析：**
提供的 Python 脚本`exploit.py` 旨在利用该漏洞。脚本允许用户指定目标 URL 和 payload。它将 payload 嵌入到 URL 中，并将其发送到目标应用程序。如果应用程序易受攻击，则会执行 payload 中包含的 Ruby 代码。该POC的有效性取决于目标Rails应用程序是否容易受到攻击且未进行修补。根据漏洞描述，低版本的 Rails 应用存在此风险。

**投毒风险分析：**
查看提供的 Python 脚本 `exploit.py` 和 `README.md`。`README.md` 文件只包含有关漏洞和脚本使用方法的描述，没有发现任何可疑代码。`exploit.py` 脚本的功能是构造和发送包含 payload 的 HTTP 请求，看起来相对简单直接。虽然脚本本身的功能是为了利用漏洞，但没有发现明显的后门或恶意代码。它接受用户提供的 payload 并将其发送到目标，因此恶意代码更有可能通过用户提供的 payload 注入到目标系统，而不是通过脚本本身进行投毒。因此，脚本本身的投毒风险较低，但使用时仍需谨慎，确保理解所执行的 payload 的含义。

**利用方式分析：**
1.  **确定目标：** 找到运行存在漏洞版本的 Ruby on Rails 应用程序。
2.  **构造 Payload：** 构建恶意的 Ruby 代码，例如执行系统命令。
3.  **发送请求：** 使用漏洞利用代码（或手动构造 HTTP 请求）将 payload 传递给应用程序的`render`方法，例如通过 URL 参数 `[inline]`。
4.  **执行代码：** 如果应用程序易受攻击，服务器将执行 payload 中的 Ruby 代码。

**示例：**
`python3 exploit.py -H "http://example.com/page?id=1"`
然后输入 payload: `system('whoami')` 。
如果成功，服务器会执行 `whoami` 命令，并将结果返回到攻击者。

综上所述，该漏洞的利用方式主要是通过操纵 `render` 方法的参数，注入恶意的 Ruby 代码，从而实现远程代码执行。该利用的有效性取决于目标应用程序的版本和配置。

**项目地址:** [DanielHemmati/CVE-2016-2098-my-first-exploit](https://github.com/DanielHemmati/CVE-2016-2098-my-first-exploit)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #6

**来源**: [CVE-2016-2098-Debalinax64_CVE-2016-2098.md](../2016/CVE-2016-2098-Debalinax64_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2 之前, 4.x 4.1.14.2 之前, 和 4.2.x 4.2.5.2 之前

**利用条件:** 目标应用使用了存在漏洞的Rails版本，并且应用程序允许使用render方法处理用户提供的输入。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails Action Pack 中，由于其 render 方法对用户输入未做严格限制，导致远程攻击者可以利用此漏洞执行任意 Ruby 代码，从而完全控制服务器。

**有效性：**
提供的POC代码是有效的。漏洞库信息，搜索引擎结果以及利用代码都表明可以通过`render`方法执行任意ruby代码。例如，可以使用`curl`发送包含恶意代码的请求，服务器会执行该代码。

**投毒风险：**
查看提供的 POC 代码 `/tmp/fb84a5f2be1c3ed581440d890e43983b/ruby-on-rail-RCE.sh`，该脚本主要功能是发送包含ruby代码的curl请求，执行用户指定的命令。脚本本身没有明显的恶意行为，例如反弹shell或下载其他恶意文件。因此，投毒风险较低，但考虑到脚本的执行环境和权限，以及可能被用于自动化攻击，存在一定风险。`/tmp/fb84a5f2be1c3ed581440d890e43983b/README.md`文件只是漏洞描述和使用说明，不存在投毒代码。总体评估风险比例为5%。

**利用方式：**
1.  攻击者需要找到一个使用了存在漏洞的Rails版本，并且允许使用render方法的应用程序。
2.  攻击者通过构造恶意的URL，将payload传递给`render`方法。 Payload形式是 `%3C%25=%20%25x('command')%20%25%3E`。 其中`command`参数是要在目标服务器上执行的命令。
3.  目标服务器在处理请求时，会执行该恶意Ruby代码，从而执行攻击者指定的命令。

**项目地址:** [Debalinax64/CVE-2016-2098](https://github.com/Debalinax64/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #7

**来源**: [CVE-2016-2098-JoseLRC97_Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution.md](../2016/CVE-2016-2098-JoseLRC97_Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution.md)

## CVE-2016-2098-Ruby on Rails Action Pack-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2之前, 4.x版本4.1.14.2之前, 4.2.x版本4.2.5.2之前

**利用条件:** 应用程序使用了`render`方法并且允许用户控制输入

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞。该漏洞源于应用程序对`render`方法的不受限制的使用。如果应用程序允许用户控制传递给`render`方法的参数，攻击者可以利用此漏洞执行任意Ruby代码。

**有效性：**
漏洞库信息和搜索引擎结果都确认了此漏洞的存在和严重性。Exploit-DB上存在相关的漏洞利用代码（https://www.exploit-db.com/exploits/40086/），进一步验证了漏洞的可利用性。

**投毒风险：**
提供的漏洞利用代码片段只是GNU通用公共许可证，并非漏洞的实际利用代码。因此，无法从中判断是否存在投毒风险。需要进一步分析实际的漏洞利用代码才能评估投毒风险。目前判断投毒风险为0%。

**利用方式：**
利用方式是，攻击者需要找到一个应用程序中使用了`render`方法并且允许用户控制输入的位置。然后，攻击者可以构造恶意的输入，例如包含Ruby代码的字符串，将其传递给`render`方法。`render`方法会执行该Ruby代码，从而导致远程代码执行。具体的payload取决于目标应用程序的上下文，但通常可以用于执行系统命令、读取敏感文件或在服务器上安装后门。

**项目地址:** [JoseLRC97/Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution](https://github.com/JoseLRC97/Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #8

**来源**: [CVE-2016-2098-Shakun8_CVE-2016-2098.md](../2016/CVE-2016-2098-Shakun8_CVE-2016-2098.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 目标应用使用了存在漏洞的Rails版本，且允许通过URL参数控制render方法。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞，源于对`render`方法的不受限制的使用。攻击者可以通过构造恶意的URL参数，将Ruby代码注入到`render`方法中执行，从而获得服务器的控制权。

**有效性：**
提供的POC代码`CVE-2016-2098.py`看起来是有效的。它使用`requests`库发送带有恶意参数的GET请求，其中参数值包含要执行的Ruby代码。Payload 构造的核心在于 `#{sys.argv[3]}[inline]=%3C%25=%20%25x({cmd})%20%25%3E` ，这部分代码将命令插入到ERB模板中，利用Rails的render方法执行任意代码。

**投毒风险：**
提供的漏洞利用代码中没有发现明显的投毒代码。该脚本的主要功能是发送包含恶意payload的HTTP请求，并打印响应结果。`README.md`文件仅包含漏洞名称和POC描述，没有可疑内容。因此，投毒风险较低，为0%。

**利用方式：**
1.  **确定目标应用是否使用了存在漏洞的Rails版本。**
2.  **构造包含恶意Ruby代码的URL参数。** 例如，使用提供的POC脚本：
    `python CVE-2016-2098.py 'system("whoami")' 'http://target.com/controller/action' 'payload'`
    这个命令会在目标服务器上执行`whoami`命令，并将结果返回。
3.  **发送包含恶意参数的HTTP请求。**
4.  **分析响应结果，确认代码是否成功执行。**

攻击者可以利用此漏洞执行任意系统命令，读取敏感文件，甚至完全控制服务器。修复此漏洞的方法是升级到受影响Rails版本以上的版本，或者限制对render方法的使用。

**项目地址:** [Shakun8/CVE-2016-2098](https://github.com/Shakun8/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #9

**来源**: [CVE-2016-2098-hderms_dh-CVE_2016_2098.md](../2016/CVE-2016-2098-hderms_dh-CVE_2016_2098.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，允许远程攻击者执行任意 Ruby 代码

**影响版本:** < 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序需要允许用户控制的输入传递给 render 方法

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-2098 存在于 Ruby on Rails 的 Action Pack 中，由于对 `render` 方法的使用未加限制，允许远程攻击者执行任意 Ruby 代码。根据漏洞信息，受影响的版本包括 3.2.22.2 之前的 3.x 版本、4.1.14.2 之前的 4.x 版本，以及 4.2.5.2 之前的 4.2.x 版本。

**漏洞利用方式：**
攻击者可以通过构造恶意的输入，将其传递给 `render` 方法，从而执行任意 Ruby 代码。这通常涉及到控制传递给 `render` 方法的模板名称或选项。根据搜索结果和漏洞库信息，漏洞的核心在于应用程序未能正确地过滤或转义用户提供的输入，直接将其用于渲染过程。

**POC 代码分析：**
提供的 POC 代码包含 `Gemfile` 和 `Gemfile.lock`。这些文件定义了 Ruby on Rails 应用的依赖。`Gemfile` 指定了 Rails 版本为 4.2.4，这属于受影响的版本范围。`Gemfile.lock` 锁定了具体的依赖版本，确保应用在不同环境中依赖的一致性。这些文件本身不包含直接的攻击代码，它们只是一个 Rails 应用的依赖描述文件，用于搭建易受攻击的环境。

**投毒风险分析：**
分析 `Gemfile` 和 `Gemfile.lock`，虽然没有明显的恶意代码，但依旧存在一定的投毒风险。攻击者可能通过修改 `Gemfile`，引入包含恶意代码的 gem 包。或者，虽然当前依赖没有问题，但未来依赖更新时，可能会引入包含漏洞或后门的 gem 包。当然，在提供的两个文件中，并没有发现后门或者漏洞代码，风险主要在于构建环境和引入存在风险的三方包。因此，投毒风险估计为 10%。

**项目地址:** [hderms/dh-CVE_2016_2098](https://github.com/hderms/dh-CVE_2016_2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #10

**来源**: [CVE-2016-2098-its-arun_CVE-2016-2098.md](../2016/CVE-2016-2098-its-arun_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，允许攻击者执行任意Ruby代码

**影响版本:** 3.2.22.2之前, 4.x 4.1.14.2之前, 和 4.2.x 4.2.5.2之前

**利用条件:** 目标应用使用了存在漏洞的Rails版本，且`render`方法以不安全的方式处理用户输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞。该漏洞源于对`render`方法的不安全使用，允许远程攻击者通过操纵用户提供的数据来执行任意Ruby代码。

**有效性：**

提供的POC代码利用了这一漏洞。通过向易受攻击的Rails应用发送特制的HTTP请求，攻击者可以在服务器上执行任意命令。

**投毒风险：**

代码本身的功能就是利用漏洞执行命令，没有发现恶意添加的额外功能代码。但是，下载和使用任何未经审查的漏洞利用代码都存在风险。POC代码的设计目标是利用漏洞，而攻击者可以修改这些POC代码以包含恶意功能，例如安装后门、窃取数据或进行其他恶意活动。
`README.md` 文件描述了漏洞和基本用法，未发现恶意代码。
`CVE-2016-2098.sh` 脚本相对简单，主要功能是构造恶意请求以利用漏洞。虽然脚本本身没有明显的恶意代码，但用户应始终谨慎审查并理解任何下载的代码。

**利用方式：**

1.  **确定目标:** 识别运行易受攻击的Ruby on Rails版本的Web应用程序。
2.  **构造Payload:** 使用POC脚本，构造包含要执行的Ruby代码的HTTP请求。此代码将作为`render`方法的参数传递。
3.  **发送Payload:** 将构造的HTTP请求发送到目标Web应用程序。
4.  **执行代码:** 如果目标应用程序易受攻击，服务器将执行嵌入在Payload中的Ruby代码。

脚本的工作方式是：

*   它接受三个参数：目标主机、URI 和要执行的命令。
*   它使用 `curl` 命令发送一个包含恶意 payload 的 HTTP 请求到目标服务器。Payload 利用 Rails `render` 方法执行任意命令。
*   它提供一个简单的交互式 shell，允许攻击者重复执行命令。

**项目地址:** [its-arun/CVE-2016-2098](https://github.com/its-arun/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #11

**来源**: [CVE-2016-2098-j4k0m_CVE-2016-2098.md](../2016/CVE-2016-2098-j4k0m_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails (Action Pack)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2之前, 4.x版本在4.1.14.2之前, 4.2.x版本在4.2.5.2之前

**利用条件:** 应用程序必须允许通过`render`方法处理用户提供的输入。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-2098 是一个 Ruby on Rails Action Pack 中的远程代码执行漏洞。攻击者可以通过向`render`方法提供恶意构造的输入来执行任意 Ruby 代码。  根据漏洞描述，漏洞根源在于Rails的`render`方法对用户输入的不当处理。POC 利用方式是通过`view[inline]`参数传递 Ruby 代码，该代码会被服务器执行。具体来说，POC 使用了 `<%= %x('[CMD]') %>` 这样的 Ruby 代码结构，其中 `[CMD]` 会被替换成想要执行的系统命令。例如，`<%= %x('whoami') %>` 会执行 `whoami` 命令，并将其输出显示在页面上。  利用步骤： 1. 确定目标 Rails 应用使用的 Rails 版本在受影响范围内。 2. 构造包含恶意 Ruby 代码的 URL，例如 `http://example.com/?view[inline]=<%= %x('whoami') %>` （需要 URL 编码）。 3. 将构造的 URL 发送到目标服务器。 4. 如果服务器存在漏洞，则会执行恶意代码，并将结果返回给攻击者。  投毒风险较低，主要因为 POC 代码的功能明确，目的是执行用户指定的命令。虽然攻击者可以利用该漏洞执行任何命令，但提供的 POC 本身不包含任何隐藏的恶意功能。 投毒的可能来自于下载后使用者更改后门,但原始版本后门概率极低。

**项目地址:** [j4k0m/CVE-2016-2098](https://github.com/j4k0m/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #12

**来源**: [CVE-2016-2098-sealldeveloper_CVE-2016-2098-PoC.md](../2016/CVE-2016-2098-sealldeveloper_CVE-2016-2098-PoC.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 3.2.22.2之前, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用使用了render方法并且允许用户可控的输入作为render方法的参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098 漏洞是 Ruby on Rails Action Pack 中由于不安全地使用 `render` 方法导致的远程代码执行漏洞。攻击者可以通过提供恶意构造的输入数据作为 `render` 方法的参数，从而执行任意 Ruby 代码。漏洞利用方式：

1.  **漏洞触发点：** 应用的某个功能使用了`render`方法，并且允许用户输入来决定渲染的内容。
2.  **攻击向量：** 攻击者构造包含恶意 Ruby 代码的字符串，并将其作为参数传递给 `render` 方法。
3.  **代码执行：** 由于 Rails 在处理 `render` 方法时，没有充分验证用户输入，导致恶意代码被执行。

**有效性：** 根据漏洞描述和搜索结果，此漏洞的POC已经公开，并且可以被利用。

**投毒风险：** 提供的漏洞利用代码只是一个LICENSE文件，无法评估是否存在投毒行为。即使有公开的POC存在，下载和使用任何第三方提供的代码都应该谨慎，并在安全的环境中进行测试。

**项目地址:** [sealldeveloper/CVE-2016-2098-PoC](https://github.com/sealldeveloper/CVE-2016-2098-PoC)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---



---

## POC #2

**来源**: [CVE-2016-2098-3rg1s_CVE-2016-2098.md](../2016/CVE-2016-2098-3rg1s_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序必须易受攻击，并且允许通过 render 方法使用不受信任的输入。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098 允许远程攻击者通过利用应用程序对 `render` 方法的不受限制使用来执行任意 Ruby 代码。漏洞存在于 Action Pack 中。根据提供的漏洞利用代码 `main.py`，攻击者可以通过构造包含恶意 Ruby 代码的 URL 参数（`[inline]`）来触发漏洞。该代码通过发送带有内联代码的 GET 请求，然后提取并打印服务器的响应。`README.md` 文件提供了漏洞的基本信息和使用说明。通过分析漏洞利用代码，没有发现任何明显的投毒迹象。代码逻辑简单，主要功能是发送请求并解析响应。因此，投毒风险评估为0%。利用方式是通过精心构造的 GET 请求，将恶意 Ruby 代码注入到 `render` 方法中执行。攻击者可以通过控制 `args` 变量来指定要执行的 Ruby 代码。

**项目地址:** [3rg1s/CVE-2016-2098](https://github.com/3rg1s/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #3

**来源**: [CVE-2016-2098-Alejandro-MartinG_rails-PoC-CVE-2016-2098.md](../2016/CVE-2016-2098-Alejandro-MartinG_rails-PoC-CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 3.2.22.2之前, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序必须允许通过`render`方法处理用户提供的输入

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails 的 Action Pack 组件中，由于对`render`方法的使用方式不当，允许远程攻击者执行任意 Ruby 代码。攻击者通过向`render`方法传递恶意构造的输入，可执行服务器端代码。漏洞利用代码 (POC) 表明，攻击者可以通过控制渲染的内容来注入恶意代码。提供的`Gemfile`和`Gemfile.lock`是 Rails 项目的依赖描述文件，用于指定项目所依赖的 Ruby Gems 及其版本。这些文件本身没有直接包含恶意代码，但它们指定了存在漏洞的 Rails 版本 (4.2.5.1)。

**有效性:**
提供的POC代码 (实际上是 Rails 项目的依赖描述文件) 与漏洞描述中受影响的版本一致，因此，如果目标应用使用存在漏洞的 Rails 版本并且允许用户可控的输入传递给`render`方法，那么该漏洞可以被成功利用。

**投毒风险:**
`Gemfile` 和 `Gemfile.lock` 文件本身不包含可执行代码，因此直接的投毒风险较低。但是，如果攻击者能够控制应用程序使用的 Gems 仓库或者能够篡改应用程序使用的 Gems，则可能存在通过引入被篡改的 Gems 来投毒的风险。对这些依赖项的评估表明，其中不太可能存在直接的投毒代码。投毒风险评估为5%。

**利用方式:**
利用方式是向易受攻击的 Rails 应用发送包含恶意参数的请求，这些参数会被传递给`render`方法，从而执行攻击者指定的 Ruby 代码。 例如，攻击者可以构造一个包含恶意代码的字符串，并将其作为模板名称或局部变量传递给`render`方法。当 Rails 应用尝试渲染该模板或使用该局部变量时，恶意代码就会被执行。根据 exploit-db 的 40086 描述，可以使用 `render :inline` 来执行代码。

**项目地址:** [Alejandro-MartinG/rails-PoC-CVE-2016-2098](https://github.com/Alejandro-MartinG/rails-PoC-CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #4

**来源**: [CVE-2016-2098-CyberDefenseInstitute_PoC_CVE-2016-2098_Rails42.md](../2016/CVE-2016-2098-CyberDefenseInstitute_PoC_CVE-2016-2098_Rails42.md)

## CVE-2016-2098-Ruby on Rails Action Pack RCE

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，允许远程攻击者执行任意Ruby代码

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序未使用安全的方式来处理render方法的用户输入

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-2098 漏洞是 Ruby on Rails Action Pack 中的一个远程代码执行漏洞。它允许远程攻击者通过利用应用程序对 `render` 方法的不受限制的使用来执行任意 Ruby 代码。

**漏洞分析：**

根据漏洞描述，漏洞的根源在于 Action Pack 组件在搜索用于渲染的模板时，处理用户提供的不可信输入的方式存在缺陷。如果应用程序将不可信的输入传递给 `render` 方法，攻击者可以构造恶意的输入来执行任意代码。

**POC 代码分析：**

提供的 POC 代码是 `Gemfile` 和 `Gemfile.lock` 文件，它们用于定义和锁定 Ruby 项目的依赖项。`Gemfile` 指定了项目使用的 Rails 版本 (4.2.5.1)，以及其他 gem 依赖项。`Gemfile.lock` 文件则记录了项目中使用的 gem 的确切版本，用于确保一致的构建。

这些文件本身并不包含漏洞利用代码，它们只是 Rails 应用配置的一部分。实际的漏洞利用需要向存在漏洞的 `render` 方法传递恶意的参数。

**有效性评估：**

POC 代码的有效性取决于目标应用程序是否使用了存在漏洞的 Rails 版本，并且允许用户控制传递给 `render` 方法的参数。如果满足这些条件，则漏洞利用是有效的。

**投毒风险评估：**

检查 `Gemfile` 和 `Gemfile.lock` 文件中是否存在投毒代码，需要检查是否有恶意或未知的 gem 依赖。当前提供的代码中，没有发现明显的投毒迹象。使用了常见的Rails版本和相关的gem包,例如 `rails`, `sqlite3`, `sass-rails`等。 但是，无法完全排除作者在其他地方添加恶意代码的可能性，例如在 `app` 目录下的 controller 或 view 文件中。

由于仅仅通过 `Gemfile` 和 `Gemfile.lock` 文件无法进行全面的代码审计，因此可以认为投毒风险非常低，约为1%。

**利用方式：**

1.  **找到易受攻击的 `render` 方法：** 确定应用程序中哪些地方使用了 `render` 方法，并且用户可以控制传递给 `render` 方法的参数。
2.  **构造恶意输入：** 构造包含恶意 Ruby 代码的输入字符串。例如，攻击者可以使用诸如 `<%= system('whoami') %>` 之类的代码来执行系统命令。
3.  **将恶意输入传递给 `render` 方法：** 将构造的恶意输入作为参数传递给 `render` 方法。这将导致应用程序执行恶意代码。

**总结：**

CVE-2016-2098 是一个严重的远程代码执行漏洞，需要及时修补。应用程序开发人员应该避免将不受信任的用户输入传递给 `render` 方法，并使用最新版本的 Rails 以获得安全修复。

**项目地址:** [CyberDefenseInstitute/PoC_CVE-2016-2098_Rails42](https://github.com/CyberDefenseInstitute/PoC_CVE-2016-2098_Rails42)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #5

**来源**: [CVE-2016-2098-DanielHemmati_CVE-2016-2098-my-first-exploit.md](../2016/CVE-2016-2098-DanielHemmati_CVE-2016-2098-my-first-exploit.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.x (< 3.2.22.2), 4.x (< 4.1.14.2), 4.2.x (< 4.2.5.2)

**利用条件:** 应用程序使用了`render`方法处理用户提供的不可信数据。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails 的 Action Pack 组件中，由于程序在处理`render`方法时未对用户输入进行充分的过滤和验证，导致远程攻击者可以执行任意 Ruby 代码。根据漏洞描述和搜索结果，攻击者可以通过构造特定的参数传递给`render`方法，从而执行恶意代码。

**有效性分析：**
提供的 Python 脚本`exploit.py` 旨在利用该漏洞。脚本允许用户指定目标 URL 和 payload。它将 payload 嵌入到 URL 中，并将其发送到目标应用程序。如果应用程序易受攻击，则会执行 payload 中包含的 Ruby 代码。该POC的有效性取决于目标Rails应用程序是否容易受到攻击且未进行修补。根据漏洞描述，低版本的 Rails 应用存在此风险。

**投毒风险分析：**
查看提供的 Python 脚本 `exploit.py` 和 `README.md`。`README.md` 文件只包含有关漏洞和脚本使用方法的描述，没有发现任何可疑代码。`exploit.py` 脚本的功能是构造和发送包含 payload 的 HTTP 请求，看起来相对简单直接。虽然脚本本身的功能是为了利用漏洞，但没有发现明显的后门或恶意代码。它接受用户提供的 payload 并将其发送到目标，因此恶意代码更有可能通过用户提供的 payload 注入到目标系统，而不是通过脚本本身进行投毒。因此，脚本本身的投毒风险较低，但使用时仍需谨慎，确保理解所执行的 payload 的含义。

**利用方式分析：**
1.  **确定目标：** 找到运行存在漏洞版本的 Ruby on Rails 应用程序。
2.  **构造 Payload：** 构建恶意的 Ruby 代码，例如执行系统命令。
3.  **发送请求：** 使用漏洞利用代码（或手动构造 HTTP 请求）将 payload 传递给应用程序的`render`方法，例如通过 URL 参数 `[inline]`。
4.  **执行代码：** 如果应用程序易受攻击，服务器将执行 payload 中的 Ruby 代码。

**示例：**
`python3 exploit.py -H "http://example.com/page?id=1"`
然后输入 payload: `system('whoami')` 。
如果成功，服务器会执行 `whoami` 命令，并将结果返回到攻击者。

综上所述，该漏洞的利用方式主要是通过操纵 `render` 方法的参数，注入恶意的 Ruby 代码，从而实现远程代码执行。该利用的有效性取决于目标应用程序的版本和配置。

**项目地址:** [DanielHemmati/CVE-2016-2098-my-first-exploit](https://github.com/DanielHemmati/CVE-2016-2098-my-first-exploit)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #6

**来源**: [CVE-2016-2098-Debalinax64_CVE-2016-2098.md](../2016/CVE-2016-2098-Debalinax64_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2 之前, 4.x 4.1.14.2 之前, 和 4.2.x 4.2.5.2 之前

**利用条件:** 目标应用使用了存在漏洞的Rails版本，并且应用程序允许使用render方法处理用户提供的输入。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails Action Pack 中，由于其 render 方法对用户输入未做严格限制，导致远程攻击者可以利用此漏洞执行任意 Ruby 代码，从而完全控制服务器。

**有效性：**
提供的POC代码是有效的。漏洞库信息，搜索引擎结果以及利用代码都表明可以通过`render`方法执行任意ruby代码。例如，可以使用`curl`发送包含恶意代码的请求，服务器会执行该代码。

**投毒风险：**
查看提供的 POC 代码 `/tmp/fb84a5f2be1c3ed581440d890e43983b/ruby-on-rail-RCE.sh`，该脚本主要功能是发送包含ruby代码的curl请求，执行用户指定的命令。脚本本身没有明显的恶意行为，例如反弹shell或下载其他恶意文件。因此，投毒风险较低，但考虑到脚本的执行环境和权限，以及可能被用于自动化攻击，存在一定风险。`/tmp/fb84a5f2be1c3ed581440d890e43983b/README.md`文件只是漏洞描述和使用说明，不存在投毒代码。总体评估风险比例为5%。

**利用方式：**
1.  攻击者需要找到一个使用了存在漏洞的Rails版本，并且允许使用render方法的应用程序。
2.  攻击者通过构造恶意的URL，将payload传递给`render`方法。 Payload形式是 `%3C%25=%20%25x('command')%20%25%3E`。 其中`command`参数是要在目标服务器上执行的命令。
3.  目标服务器在处理请求时，会执行该恶意Ruby代码，从而执行攻击者指定的命令。

**项目地址:** [Debalinax64/CVE-2016-2098](https://github.com/Debalinax64/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #7

**来源**: [CVE-2016-2098-JoseLRC97_Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution.md](../2016/CVE-2016-2098-JoseLRC97_Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution.md)

## CVE-2016-2098-Ruby on Rails Action Pack-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2之前, 4.x版本4.1.14.2之前, 4.2.x版本4.2.5.2之前

**利用条件:** 应用程序使用了`render`方法并且允许用户控制输入

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞。该漏洞源于应用程序对`render`方法的不受限制的使用。如果应用程序允许用户控制传递给`render`方法的参数，攻击者可以利用此漏洞执行任意Ruby代码。

**有效性：**
漏洞库信息和搜索引擎结果都确认了此漏洞的存在和严重性。Exploit-DB上存在相关的漏洞利用代码（https://www.exploit-db.com/exploits/40086/），进一步验证了漏洞的可利用性。

**投毒风险：**
提供的漏洞利用代码片段只是GNU通用公共许可证，并非漏洞的实际利用代码。因此，无法从中判断是否存在投毒风险。需要进一步分析实际的漏洞利用代码才能评估投毒风险。目前判断投毒风险为0%。

**利用方式：**
利用方式是，攻击者需要找到一个应用程序中使用了`render`方法并且允许用户控制输入的位置。然后，攻击者可以构造恶意的输入，例如包含Ruby代码的字符串，将其传递给`render`方法。`render`方法会执行该Ruby代码，从而导致远程代码执行。具体的payload取决于目标应用程序的上下文，但通常可以用于执行系统命令、读取敏感文件或在服务器上安装后门。

**项目地址:** [JoseLRC97/Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution](https://github.com/JoseLRC97/Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #8

**来源**: [CVE-2016-2098-Shakun8_CVE-2016-2098.md](../2016/CVE-2016-2098-Shakun8_CVE-2016-2098.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 目标应用使用了存在漏洞的Rails版本，且允许通过URL参数控制render方法。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞，源于对`render`方法的不受限制的使用。攻击者可以通过构造恶意的URL参数，将Ruby代码注入到`render`方法中执行，从而获得服务器的控制权。

**有效性：**
提供的POC代码`CVE-2016-2098.py`看起来是有效的。它使用`requests`库发送带有恶意参数的GET请求，其中参数值包含要执行的Ruby代码。Payload 构造的核心在于 `#{sys.argv[3]}[inline]=%3C%25=%20%25x({cmd})%20%25%3E` ，这部分代码将命令插入到ERB模板中，利用Rails的render方法执行任意代码。

**投毒风险：**
提供的漏洞利用代码中没有发现明显的投毒代码。该脚本的主要功能是发送包含恶意payload的HTTP请求，并打印响应结果。`README.md`文件仅包含漏洞名称和POC描述，没有可疑内容。因此，投毒风险较低，为0%。

**利用方式：**
1.  **确定目标应用是否使用了存在漏洞的Rails版本。**
2.  **构造包含恶意Ruby代码的URL参数。** 例如，使用提供的POC脚本：
    `python CVE-2016-2098.py 'system("whoami")' 'http://target.com/controller/action' 'payload'`
    这个命令会在目标服务器上执行`whoami`命令，并将结果返回。
3.  **发送包含恶意参数的HTTP请求。**
4.  **分析响应结果，确认代码是否成功执行。**

攻击者可以利用此漏洞执行任意系统命令，读取敏感文件，甚至完全控制服务器。修复此漏洞的方法是升级到受影响Rails版本以上的版本，或者限制对render方法的使用。

**项目地址:** [Shakun8/CVE-2016-2098](https://github.com/Shakun8/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #9

**来源**: [CVE-2016-2098-hderms_dh-CVE_2016_2098.md](../2016/CVE-2016-2098-hderms_dh-CVE_2016_2098.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，允许远程攻击者执行任意 Ruby 代码

**影响版本:** < 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序需要允许用户控制的输入传递给 render 方法

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-2098 存在于 Ruby on Rails 的 Action Pack 中，由于对 `render` 方法的使用未加限制，允许远程攻击者执行任意 Ruby 代码。根据漏洞信息，受影响的版本包括 3.2.22.2 之前的 3.x 版本、4.1.14.2 之前的 4.x 版本，以及 4.2.5.2 之前的 4.2.x 版本。

**漏洞利用方式：**
攻击者可以通过构造恶意的输入，将其传递给 `render` 方法，从而执行任意 Ruby 代码。这通常涉及到控制传递给 `render` 方法的模板名称或选项。根据搜索结果和漏洞库信息，漏洞的核心在于应用程序未能正确地过滤或转义用户提供的输入，直接将其用于渲染过程。

**POC 代码分析：**
提供的 POC 代码包含 `Gemfile` 和 `Gemfile.lock`。这些文件定义了 Ruby on Rails 应用的依赖。`Gemfile` 指定了 Rails 版本为 4.2.4，这属于受影响的版本范围。`Gemfile.lock` 锁定了具体的依赖版本，确保应用在不同环境中依赖的一致性。这些文件本身不包含直接的攻击代码，它们只是一个 Rails 应用的依赖描述文件，用于搭建易受攻击的环境。

**投毒风险分析：**
分析 `Gemfile` 和 `Gemfile.lock`，虽然没有明显的恶意代码，但依旧存在一定的投毒风险。攻击者可能通过修改 `Gemfile`，引入包含恶意代码的 gem 包。或者，虽然当前依赖没有问题，但未来依赖更新时，可能会引入包含漏洞或后门的 gem 包。当然，在提供的两个文件中，并没有发现后门或者漏洞代码，风险主要在于构建环境和引入存在风险的三方包。因此，投毒风险估计为 10%。

**项目地址:** [hderms/dh-CVE_2016_2098](https://github.com/hderms/dh-CVE_2016_2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #10

**来源**: [CVE-2016-2098-its-arun_CVE-2016-2098.md](../2016/CVE-2016-2098-its-arun_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，允许攻击者执行任意Ruby代码

**影响版本:** 3.2.22.2之前, 4.x 4.1.14.2之前, 和 4.2.x 4.2.5.2之前

**利用条件:** 目标应用使用了存在漏洞的Rails版本，且`render`方法以不安全的方式处理用户输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞。该漏洞源于对`render`方法的不安全使用，允许远程攻击者通过操纵用户提供的数据来执行任意Ruby代码。

**有效性：**

提供的POC代码利用了这一漏洞。通过向易受攻击的Rails应用发送特制的HTTP请求，攻击者可以在服务器上执行任意命令。

**投毒风险：**

代码本身的功能就是利用漏洞执行命令，没有发现恶意添加的额外功能代码。但是，下载和使用任何未经审查的漏洞利用代码都存在风险。POC代码的设计目标是利用漏洞，而攻击者可以修改这些POC代码以包含恶意功能，例如安装后门、窃取数据或进行其他恶意活动。
`README.md` 文件描述了漏洞和基本用法，未发现恶意代码。
`CVE-2016-2098.sh` 脚本相对简单，主要功能是构造恶意请求以利用漏洞。虽然脚本本身没有明显的恶意代码，但用户应始终谨慎审查并理解任何下载的代码。

**利用方式：**

1.  **确定目标:** 识别运行易受攻击的Ruby on Rails版本的Web应用程序。
2.  **构造Payload:** 使用POC脚本，构造包含要执行的Ruby代码的HTTP请求。此代码将作为`render`方法的参数传递。
3.  **发送Payload:** 将构造的HTTP请求发送到目标Web应用程序。
4.  **执行代码:** 如果目标应用程序易受攻击，服务器将执行嵌入在Payload中的Ruby代码。

脚本的工作方式是：

*   它接受三个参数：目标主机、URI 和要执行的命令。
*   它使用 `curl` 命令发送一个包含恶意 payload 的 HTTP 请求到目标服务器。Payload 利用 Rails `render` 方法执行任意命令。
*   它提供一个简单的交互式 shell，允许攻击者重复执行命令。

**项目地址:** [its-arun/CVE-2016-2098](https://github.com/its-arun/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #11

**来源**: [CVE-2016-2098-j4k0m_CVE-2016-2098.md](../2016/CVE-2016-2098-j4k0m_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails (Action Pack)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2之前, 4.x版本在4.1.14.2之前, 4.2.x版本在4.2.5.2之前

**利用条件:** 应用程序必须允许通过`render`方法处理用户提供的输入。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-2098 是一个 Ruby on Rails Action Pack 中的远程代码执行漏洞。攻击者可以通过向`render`方法提供恶意构造的输入来执行任意 Ruby 代码。  根据漏洞描述，漏洞根源在于Rails的`render`方法对用户输入的不当处理。POC 利用方式是通过`view[inline]`参数传递 Ruby 代码，该代码会被服务器执行。具体来说，POC 使用了 `<%= %x('[CMD]') %>` 这样的 Ruby 代码结构，其中 `[CMD]` 会被替换成想要执行的系统命令。例如，`<%= %x('whoami') %>` 会执行 `whoami` 命令，并将其输出显示在页面上。  利用步骤： 1. 确定目标 Rails 应用使用的 Rails 版本在受影响范围内。 2. 构造包含恶意 Ruby 代码的 URL，例如 `http://example.com/?view[inline]=<%= %x('whoami') %>` （需要 URL 编码）。 3. 将构造的 URL 发送到目标服务器。 4. 如果服务器存在漏洞，则会执行恶意代码，并将结果返回给攻击者。  投毒风险较低，主要因为 POC 代码的功能明确，目的是执行用户指定的命令。虽然攻击者可以利用该漏洞执行任何命令，但提供的 POC 本身不包含任何隐藏的恶意功能。 投毒的可能来自于下载后使用者更改后门,但原始版本后门概率极低。

**项目地址:** [j4k0m/CVE-2016-2098](https://github.com/j4k0m/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #12

**来源**: [CVE-2016-2098-sealldeveloper_CVE-2016-2098-PoC.md](../2016/CVE-2016-2098-sealldeveloper_CVE-2016-2098-PoC.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 3.2.22.2之前, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用使用了render方法并且允许用户可控的输入作为render方法的参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098 漏洞是 Ruby on Rails Action Pack 中由于不安全地使用 `render` 方法导致的远程代码执行漏洞。攻击者可以通过提供恶意构造的输入数据作为 `render` 方法的参数，从而执行任意 Ruby 代码。漏洞利用方式：

1.  **漏洞触发点：** 应用的某个功能使用了`render`方法，并且允许用户输入来决定渲染的内容。
2.  **攻击向量：** 攻击者构造包含恶意 Ruby 代码的字符串，并将其作为参数传递给 `render` 方法。
3.  **代码执行：** 由于 Rails 在处理 `render` 方法时，没有充分验证用户输入，导致恶意代码被执行。

**有效性：** 根据漏洞描述和搜索结果，此漏洞的POC已经公开，并且可以被利用。

**投毒风险：** 提供的漏洞利用代码只是一个LICENSE文件，无法评估是否存在投毒行为。即使有公开的POC存在，下载和使用任何第三方提供的代码都应该谨慎，并在安全的环境中进行测试。

**项目地址:** [sealldeveloper/CVE-2016-2098-PoC](https://github.com/sealldeveloper/CVE-2016-2098-PoC)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---



---

## POC #2

**来源**: [CVE-2016-2098-3rg1s_CVE-2016-2098.md](../2016/CVE-2016-2098-3rg1s_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序必须易受攻击，并且允许通过 render 方法使用不受信任的输入。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098 允许远程攻击者通过利用应用程序对 `render` 方法的不受限制使用来执行任意 Ruby 代码。漏洞存在于 Action Pack 中。根据提供的漏洞利用代码 `main.py`，攻击者可以通过构造包含恶意 Ruby 代码的 URL 参数（`[inline]`）来触发漏洞。该代码通过发送带有内联代码的 GET 请求，然后提取并打印服务器的响应。`README.md` 文件提供了漏洞的基本信息和使用说明。通过分析漏洞利用代码，没有发现任何明显的投毒迹象。代码逻辑简单，主要功能是发送请求并解析响应。因此，投毒风险评估为0%。利用方式是通过精心构造的 GET 请求，将恶意 Ruby 代码注入到 `render` 方法中执行。攻击者可以通过控制 `args` 变量来指定要执行的 Ruby 代码。

**项目地址:** [3rg1s/CVE-2016-2098](https://github.com/3rg1s/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #3

**来源**: [CVE-2016-2098-Alejandro-MartinG_rails-PoC-CVE-2016-2098.md](../2016/CVE-2016-2098-Alejandro-MartinG_rails-PoC-CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 3.2.22.2之前, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序必须允许通过`render`方法处理用户提供的输入

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails 的 Action Pack 组件中，由于对`render`方法的使用方式不当，允许远程攻击者执行任意 Ruby 代码。攻击者通过向`render`方法传递恶意构造的输入，可执行服务器端代码。漏洞利用代码 (POC) 表明，攻击者可以通过控制渲染的内容来注入恶意代码。提供的`Gemfile`和`Gemfile.lock`是 Rails 项目的依赖描述文件，用于指定项目所依赖的 Ruby Gems 及其版本。这些文件本身没有直接包含恶意代码，但它们指定了存在漏洞的 Rails 版本 (4.2.5.1)。

**有效性:**
提供的POC代码 (实际上是 Rails 项目的依赖描述文件) 与漏洞描述中受影响的版本一致，因此，如果目标应用使用存在漏洞的 Rails 版本并且允许用户可控的输入传递给`render`方法，那么该漏洞可以被成功利用。

**投毒风险:**
`Gemfile` 和 `Gemfile.lock` 文件本身不包含可执行代码，因此直接的投毒风险较低。但是，如果攻击者能够控制应用程序使用的 Gems 仓库或者能够篡改应用程序使用的 Gems，则可能存在通过引入被篡改的 Gems 来投毒的风险。对这些依赖项的评估表明，其中不太可能存在直接的投毒代码。投毒风险评估为5%。

**利用方式:**
利用方式是向易受攻击的 Rails 应用发送包含恶意参数的请求，这些参数会被传递给`render`方法，从而执行攻击者指定的 Ruby 代码。 例如，攻击者可以构造一个包含恶意代码的字符串，并将其作为模板名称或局部变量传递给`render`方法。当 Rails 应用尝试渲染该模板或使用该局部变量时，恶意代码就会被执行。根据 exploit-db 的 40086 描述，可以使用 `render :inline` 来执行代码。

**项目地址:** [Alejandro-MartinG/rails-PoC-CVE-2016-2098](https://github.com/Alejandro-MartinG/rails-PoC-CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #4

**来源**: [CVE-2016-2098-CyberDefenseInstitute_PoC_CVE-2016-2098_Rails42.md](../2016/CVE-2016-2098-CyberDefenseInstitute_PoC_CVE-2016-2098_Rails42.md)

## CVE-2016-2098-Ruby on Rails Action Pack RCE

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，允许远程攻击者执行任意Ruby代码

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序未使用安全的方式来处理render方法的用户输入

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-2098 漏洞是 Ruby on Rails Action Pack 中的一个远程代码执行漏洞。它允许远程攻击者通过利用应用程序对 `render` 方法的不受限制的使用来执行任意 Ruby 代码。

**漏洞分析：**

根据漏洞描述，漏洞的根源在于 Action Pack 组件在搜索用于渲染的模板时，处理用户提供的不可信输入的方式存在缺陷。如果应用程序将不可信的输入传递给 `render` 方法，攻击者可以构造恶意的输入来执行任意代码。

**POC 代码分析：**

提供的 POC 代码是 `Gemfile` 和 `Gemfile.lock` 文件，它们用于定义和锁定 Ruby 项目的依赖项。`Gemfile` 指定了项目使用的 Rails 版本 (4.2.5.1)，以及其他 gem 依赖项。`Gemfile.lock` 文件则记录了项目中使用的 gem 的确切版本，用于确保一致的构建。

这些文件本身并不包含漏洞利用代码，它们只是 Rails 应用配置的一部分。实际的漏洞利用需要向存在漏洞的 `render` 方法传递恶意的参数。

**有效性评估：**

POC 代码的有效性取决于目标应用程序是否使用了存在漏洞的 Rails 版本，并且允许用户控制传递给 `render` 方法的参数。如果满足这些条件，则漏洞利用是有效的。

**投毒风险评估：**

检查 `Gemfile` 和 `Gemfile.lock` 文件中是否存在投毒代码，需要检查是否有恶意或未知的 gem 依赖。当前提供的代码中，没有发现明显的投毒迹象。使用了常见的Rails版本和相关的gem包,例如 `rails`, `sqlite3`, `sass-rails`等。 但是，无法完全排除作者在其他地方添加恶意代码的可能性，例如在 `app` 目录下的 controller 或 view 文件中。

由于仅仅通过 `Gemfile` 和 `Gemfile.lock` 文件无法进行全面的代码审计，因此可以认为投毒风险非常低，约为1%。

**利用方式：**

1.  **找到易受攻击的 `render` 方法：** 确定应用程序中哪些地方使用了 `render` 方法，并且用户可以控制传递给 `render` 方法的参数。
2.  **构造恶意输入：** 构造包含恶意 Ruby 代码的输入字符串。例如，攻击者可以使用诸如 `<%= system('whoami') %>` 之类的代码来执行系统命令。
3.  **将恶意输入传递给 `render` 方法：** 将构造的恶意输入作为参数传递给 `render` 方法。这将导致应用程序执行恶意代码。

**总结：**

CVE-2016-2098 是一个严重的远程代码执行漏洞，需要及时修补。应用程序开发人员应该避免将不受信任的用户输入传递给 `render` 方法，并使用最新版本的 Rails 以获得安全修复。

**项目地址:** [CyberDefenseInstitute/PoC_CVE-2016-2098_Rails42](https://github.com/CyberDefenseInstitute/PoC_CVE-2016-2098_Rails42)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #5

**来源**: [CVE-2016-2098-DanielHemmati_CVE-2016-2098-my-first-exploit.md](../2016/CVE-2016-2098-DanielHemmati_CVE-2016-2098-my-first-exploit.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.x (< 3.2.22.2), 4.x (< 4.1.14.2), 4.2.x (< 4.2.5.2)

**利用条件:** 应用程序使用了`render`方法处理用户提供的不可信数据。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails 的 Action Pack 组件中，由于程序在处理`render`方法时未对用户输入进行充分的过滤和验证，导致远程攻击者可以执行任意 Ruby 代码。根据漏洞描述和搜索结果，攻击者可以通过构造特定的参数传递给`render`方法，从而执行恶意代码。

**有效性分析：**
提供的 Python 脚本`exploit.py` 旨在利用该漏洞。脚本允许用户指定目标 URL 和 payload。它将 payload 嵌入到 URL 中，并将其发送到目标应用程序。如果应用程序易受攻击，则会执行 payload 中包含的 Ruby 代码。该POC的有效性取决于目标Rails应用程序是否容易受到攻击且未进行修补。根据漏洞描述，低版本的 Rails 应用存在此风险。

**投毒风险分析：**
查看提供的 Python 脚本 `exploit.py` 和 `README.md`。`README.md` 文件只包含有关漏洞和脚本使用方法的描述，没有发现任何可疑代码。`exploit.py` 脚本的功能是构造和发送包含 payload 的 HTTP 请求，看起来相对简单直接。虽然脚本本身的功能是为了利用漏洞，但没有发现明显的后门或恶意代码。它接受用户提供的 payload 并将其发送到目标，因此恶意代码更有可能通过用户提供的 payload 注入到目标系统，而不是通过脚本本身进行投毒。因此，脚本本身的投毒风险较低，但使用时仍需谨慎，确保理解所执行的 payload 的含义。

**利用方式分析：**
1.  **确定目标：** 找到运行存在漏洞版本的 Ruby on Rails 应用程序。
2.  **构造 Payload：** 构建恶意的 Ruby 代码，例如执行系统命令。
3.  **发送请求：** 使用漏洞利用代码（或手动构造 HTTP 请求）将 payload 传递给应用程序的`render`方法，例如通过 URL 参数 `[inline]`。
4.  **执行代码：** 如果应用程序易受攻击，服务器将执行 payload 中的 Ruby 代码。

**示例：**
`python3 exploit.py -H "http://example.com/page?id=1"`
然后输入 payload: `system('whoami')` 。
如果成功，服务器会执行 `whoami` 命令，并将结果返回到攻击者。

综上所述，该漏洞的利用方式主要是通过操纵 `render` 方法的参数，注入恶意的 Ruby 代码，从而实现远程代码执行。该利用的有效性取决于目标应用程序的版本和配置。

**项目地址:** [DanielHemmati/CVE-2016-2098-my-first-exploit](https://github.com/DanielHemmati/CVE-2016-2098-my-first-exploit)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #6

**来源**: [CVE-2016-2098-Debalinax64_CVE-2016-2098.md](../2016/CVE-2016-2098-Debalinax64_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2 之前, 4.x 4.1.14.2 之前, 和 4.2.x 4.2.5.2 之前

**利用条件:** 目标应用使用了存在漏洞的Rails版本，并且应用程序允许使用render方法处理用户提供的输入。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails Action Pack 中，由于其 render 方法对用户输入未做严格限制，导致远程攻击者可以利用此漏洞执行任意 Ruby 代码，从而完全控制服务器。

**有效性：**
提供的POC代码是有效的。漏洞库信息，搜索引擎结果以及利用代码都表明可以通过`render`方法执行任意ruby代码。例如，可以使用`curl`发送包含恶意代码的请求，服务器会执行该代码。

**投毒风险：**
查看提供的 POC 代码 `/tmp/fb84a5f2be1c3ed581440d890e43983b/ruby-on-rail-RCE.sh`，该脚本主要功能是发送包含ruby代码的curl请求，执行用户指定的命令。脚本本身没有明显的恶意行为，例如反弹shell或下载其他恶意文件。因此，投毒风险较低，但考虑到脚本的执行环境和权限，以及可能被用于自动化攻击，存在一定风险。`/tmp/fb84a5f2be1c3ed581440d890e43983b/README.md`文件只是漏洞描述和使用说明，不存在投毒代码。总体评估风险比例为5%。

**利用方式：**
1.  攻击者需要找到一个使用了存在漏洞的Rails版本，并且允许使用render方法的应用程序。
2.  攻击者通过构造恶意的URL，将payload传递给`render`方法。 Payload形式是 `%3C%25=%20%25x('command')%20%25%3E`。 其中`command`参数是要在目标服务器上执行的命令。
3.  目标服务器在处理请求时，会执行该恶意Ruby代码，从而执行攻击者指定的命令。

**项目地址:** [Debalinax64/CVE-2016-2098](https://github.com/Debalinax64/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #7

**来源**: [CVE-2016-2098-JoseLRC97_Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution.md](../2016/CVE-2016-2098-JoseLRC97_Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution.md)

## CVE-2016-2098-Ruby on Rails Action Pack-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2之前, 4.x版本4.1.14.2之前, 4.2.x版本4.2.5.2之前

**利用条件:** 应用程序使用了`render`方法并且允许用户控制输入

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞。该漏洞源于应用程序对`render`方法的不受限制的使用。如果应用程序允许用户控制传递给`render`方法的参数，攻击者可以利用此漏洞执行任意Ruby代码。

**有效性：**
漏洞库信息和搜索引擎结果都确认了此漏洞的存在和严重性。Exploit-DB上存在相关的漏洞利用代码（https://www.exploit-db.com/exploits/40086/），进一步验证了漏洞的可利用性。

**投毒风险：**
提供的漏洞利用代码片段只是GNU通用公共许可证，并非漏洞的实际利用代码。因此，无法从中判断是否存在投毒风险。需要进一步分析实际的漏洞利用代码才能评估投毒风险。目前判断投毒风险为0%。

**利用方式：**
利用方式是，攻击者需要找到一个应用程序中使用了`render`方法并且允许用户控制输入的位置。然后，攻击者可以构造恶意的输入，例如包含Ruby代码的字符串，将其传递给`render`方法。`render`方法会执行该Ruby代码，从而导致远程代码执行。具体的payload取决于目标应用程序的上下文，但通常可以用于执行系统命令、读取敏感文件或在服务器上安装后门。

**项目地址:** [JoseLRC97/Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution](https://github.com/JoseLRC97/Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #8

**来源**: [CVE-2016-2098-Shakun8_CVE-2016-2098.md](../2016/CVE-2016-2098-Shakun8_CVE-2016-2098.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 目标应用使用了存在漏洞的Rails版本，且允许通过URL参数控制render方法。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞，源于对`render`方法的不受限制的使用。攻击者可以通过构造恶意的URL参数，将Ruby代码注入到`render`方法中执行，从而获得服务器的控制权。

**有效性：**
提供的POC代码`CVE-2016-2098.py`看起来是有效的。它使用`requests`库发送带有恶意参数的GET请求，其中参数值包含要执行的Ruby代码。Payload 构造的核心在于 `#{sys.argv[3]}[inline]=%3C%25=%20%25x({cmd})%20%25%3E` ，这部分代码将命令插入到ERB模板中，利用Rails的render方法执行任意代码。

**投毒风险：**
提供的漏洞利用代码中没有发现明显的投毒代码。该脚本的主要功能是发送包含恶意payload的HTTP请求，并打印响应结果。`README.md`文件仅包含漏洞名称和POC描述，没有可疑内容。因此，投毒风险较低，为0%。

**利用方式：**
1.  **确定目标应用是否使用了存在漏洞的Rails版本。**
2.  **构造包含恶意Ruby代码的URL参数。** 例如，使用提供的POC脚本：
    `python CVE-2016-2098.py 'system("whoami")' 'http://target.com/controller/action' 'payload'`
    这个命令会在目标服务器上执行`whoami`命令，并将结果返回。
3.  **发送包含恶意参数的HTTP请求。**
4.  **分析响应结果，确认代码是否成功执行。**

攻击者可以利用此漏洞执行任意系统命令，读取敏感文件，甚至完全控制服务器。修复此漏洞的方法是升级到受影响Rails版本以上的版本，或者限制对render方法的使用。

**项目地址:** [Shakun8/CVE-2016-2098](https://github.com/Shakun8/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #9

**来源**: [CVE-2016-2098-hderms_dh-CVE_2016_2098.md](../2016/CVE-2016-2098-hderms_dh-CVE_2016_2098.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，允许远程攻击者执行任意 Ruby 代码

**影响版本:** < 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序需要允许用户控制的输入传递给 render 方法

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-2098 存在于 Ruby on Rails 的 Action Pack 中，由于对 `render` 方法的使用未加限制，允许远程攻击者执行任意 Ruby 代码。根据漏洞信息，受影响的版本包括 3.2.22.2 之前的 3.x 版本、4.1.14.2 之前的 4.x 版本，以及 4.2.5.2 之前的 4.2.x 版本。

**漏洞利用方式：**
攻击者可以通过构造恶意的输入，将其传递给 `render` 方法，从而执行任意 Ruby 代码。这通常涉及到控制传递给 `render` 方法的模板名称或选项。根据搜索结果和漏洞库信息，漏洞的核心在于应用程序未能正确地过滤或转义用户提供的输入，直接将其用于渲染过程。

**POC 代码分析：**
提供的 POC 代码包含 `Gemfile` 和 `Gemfile.lock`。这些文件定义了 Ruby on Rails 应用的依赖。`Gemfile` 指定了 Rails 版本为 4.2.4，这属于受影响的版本范围。`Gemfile.lock` 锁定了具体的依赖版本，确保应用在不同环境中依赖的一致性。这些文件本身不包含直接的攻击代码，它们只是一个 Rails 应用的依赖描述文件，用于搭建易受攻击的环境。

**投毒风险分析：**
分析 `Gemfile` 和 `Gemfile.lock`，虽然没有明显的恶意代码，但依旧存在一定的投毒风险。攻击者可能通过修改 `Gemfile`，引入包含恶意代码的 gem 包。或者，虽然当前依赖没有问题，但未来依赖更新时，可能会引入包含漏洞或后门的 gem 包。当然，在提供的两个文件中，并没有发现后门或者漏洞代码，风险主要在于构建环境和引入存在风险的三方包。因此，投毒风险估计为 10%。

**项目地址:** [hderms/dh-CVE_2016_2098](https://github.com/hderms/dh-CVE_2016_2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #10

**来源**: [CVE-2016-2098-its-arun_CVE-2016-2098.md](../2016/CVE-2016-2098-its-arun_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，允许攻击者执行任意Ruby代码

**影响版本:** 3.2.22.2之前, 4.x 4.1.14.2之前, 和 4.2.x 4.2.5.2之前

**利用条件:** 目标应用使用了存在漏洞的Rails版本，且`render`方法以不安全的方式处理用户输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞。该漏洞源于对`render`方法的不安全使用，允许远程攻击者通过操纵用户提供的数据来执行任意Ruby代码。

**有效性：**

提供的POC代码利用了这一漏洞。通过向易受攻击的Rails应用发送特制的HTTP请求，攻击者可以在服务器上执行任意命令。

**投毒风险：**

代码本身的功能就是利用漏洞执行命令，没有发现恶意添加的额外功能代码。但是，下载和使用任何未经审查的漏洞利用代码都存在风险。POC代码的设计目标是利用漏洞，而攻击者可以修改这些POC代码以包含恶意功能，例如安装后门、窃取数据或进行其他恶意活动。
`README.md` 文件描述了漏洞和基本用法，未发现恶意代码。
`CVE-2016-2098.sh` 脚本相对简单，主要功能是构造恶意请求以利用漏洞。虽然脚本本身没有明显的恶意代码，但用户应始终谨慎审查并理解任何下载的代码。

**利用方式：**

1.  **确定目标:** 识别运行易受攻击的Ruby on Rails版本的Web应用程序。
2.  **构造Payload:** 使用POC脚本，构造包含要执行的Ruby代码的HTTP请求。此代码将作为`render`方法的参数传递。
3.  **发送Payload:** 将构造的HTTP请求发送到目标Web应用程序。
4.  **执行代码:** 如果目标应用程序易受攻击，服务器将执行嵌入在Payload中的Ruby代码。

脚本的工作方式是：

*   它接受三个参数：目标主机、URI 和要执行的命令。
*   它使用 `curl` 命令发送一个包含恶意 payload 的 HTTP 请求到目标服务器。Payload 利用 Rails `render` 方法执行任意命令。
*   它提供一个简单的交互式 shell，允许攻击者重复执行命令。

**项目地址:** [its-arun/CVE-2016-2098](https://github.com/its-arun/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #11

**来源**: [CVE-2016-2098-j4k0m_CVE-2016-2098.md](../2016/CVE-2016-2098-j4k0m_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails (Action Pack)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2之前, 4.x版本在4.1.14.2之前, 4.2.x版本在4.2.5.2之前

**利用条件:** 应用程序必须允许通过`render`方法处理用户提供的输入。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-2098 是一个 Ruby on Rails Action Pack 中的远程代码执行漏洞。攻击者可以通过向`render`方法提供恶意构造的输入来执行任意 Ruby 代码。  根据漏洞描述，漏洞根源在于Rails的`render`方法对用户输入的不当处理。POC 利用方式是通过`view[inline]`参数传递 Ruby 代码，该代码会被服务器执行。具体来说，POC 使用了 `<%= %x('[CMD]') %>` 这样的 Ruby 代码结构，其中 `[CMD]` 会被替换成想要执行的系统命令。例如，`<%= %x('whoami') %>` 会执行 `whoami` 命令，并将其输出显示在页面上。  利用步骤： 1. 确定目标 Rails 应用使用的 Rails 版本在受影响范围内。 2. 构造包含恶意 Ruby 代码的 URL，例如 `http://example.com/?view[inline]=<%= %x('whoami') %>` （需要 URL 编码）。 3. 将构造的 URL 发送到目标服务器。 4. 如果服务器存在漏洞，则会执行恶意代码，并将结果返回给攻击者。  投毒风险较低，主要因为 POC 代码的功能明确，目的是执行用户指定的命令。虽然攻击者可以利用该漏洞执行任何命令，但提供的 POC 本身不包含任何隐藏的恶意功能。 投毒的可能来自于下载后使用者更改后门,但原始版本后门概率极低。

**项目地址:** [j4k0m/CVE-2016-2098](https://github.com/j4k0m/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #12

**来源**: [CVE-2016-2098-sealldeveloper_CVE-2016-2098-PoC.md](../2016/CVE-2016-2098-sealldeveloper_CVE-2016-2098-PoC.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 3.2.22.2之前, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用使用了render方法并且允许用户可控的输入作为render方法的参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098 漏洞是 Ruby on Rails Action Pack 中由于不安全地使用 `render` 方法导致的远程代码执行漏洞。攻击者可以通过提供恶意构造的输入数据作为 `render` 方法的参数，从而执行任意 Ruby 代码。漏洞利用方式：

1.  **漏洞触发点：** 应用的某个功能使用了`render`方法，并且允许用户输入来决定渲染的内容。
2.  **攻击向量：** 攻击者构造包含恶意 Ruby 代码的字符串，并将其作为参数传递给 `render` 方法。
3.  **代码执行：** 由于 Rails 在处理 `render` 方法时，没有充分验证用户输入，导致恶意代码被执行。

**有效性：** 根据漏洞描述和搜索结果，此漏洞的POC已经公开，并且可以被利用。

**投毒风险：** 提供的漏洞利用代码只是一个LICENSE文件，无法评估是否存在投毒行为。即使有公开的POC存在，下载和使用任何第三方提供的代码都应该谨慎，并在安全的环境中进行测试。

**项目地址:** [sealldeveloper/CVE-2016-2098-PoC](https://github.com/sealldeveloper/CVE-2016-2098-PoC)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---



---

## POC #2

**来源**: [CVE-2016-2098-3rg1s_CVE-2016-2098.md](../2016/CVE-2016-2098-3rg1s_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序必须易受攻击，并且允许通过 render 方法使用不受信任的输入。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098 允许远程攻击者通过利用应用程序对 `render` 方法的不受限制使用来执行任意 Ruby 代码。漏洞存在于 Action Pack 中。根据提供的漏洞利用代码 `main.py`，攻击者可以通过构造包含恶意 Ruby 代码的 URL 参数（`[inline]`）来触发漏洞。该代码通过发送带有内联代码的 GET 请求，然后提取并打印服务器的响应。`README.md` 文件提供了漏洞的基本信息和使用说明。通过分析漏洞利用代码，没有发现任何明显的投毒迹象。代码逻辑简单，主要功能是发送请求并解析响应。因此，投毒风险评估为0%。利用方式是通过精心构造的 GET 请求，将恶意 Ruby 代码注入到 `render` 方法中执行。攻击者可以通过控制 `args` 变量来指定要执行的 Ruby 代码。

**项目地址:** [3rg1s/CVE-2016-2098](https://github.com/3rg1s/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #3

**来源**: [CVE-2016-2098-Alejandro-MartinG_rails-PoC-CVE-2016-2098.md](../2016/CVE-2016-2098-Alejandro-MartinG_rails-PoC-CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 3.2.22.2之前, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序必须允许通过`render`方法处理用户提供的输入

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails 的 Action Pack 组件中，由于对`render`方法的使用方式不当，允许远程攻击者执行任意 Ruby 代码。攻击者通过向`render`方法传递恶意构造的输入，可执行服务器端代码。漏洞利用代码 (POC) 表明，攻击者可以通过控制渲染的内容来注入恶意代码。提供的`Gemfile`和`Gemfile.lock`是 Rails 项目的依赖描述文件，用于指定项目所依赖的 Ruby Gems 及其版本。这些文件本身没有直接包含恶意代码，但它们指定了存在漏洞的 Rails 版本 (4.2.5.1)。

**有效性:**
提供的POC代码 (实际上是 Rails 项目的依赖描述文件) 与漏洞描述中受影响的版本一致，因此，如果目标应用使用存在漏洞的 Rails 版本并且允许用户可控的输入传递给`render`方法，那么该漏洞可以被成功利用。

**投毒风险:**
`Gemfile` 和 `Gemfile.lock` 文件本身不包含可执行代码，因此直接的投毒风险较低。但是，如果攻击者能够控制应用程序使用的 Gems 仓库或者能够篡改应用程序使用的 Gems，则可能存在通过引入被篡改的 Gems 来投毒的风险。对这些依赖项的评估表明，其中不太可能存在直接的投毒代码。投毒风险评估为5%。

**利用方式:**
利用方式是向易受攻击的 Rails 应用发送包含恶意参数的请求，这些参数会被传递给`render`方法，从而执行攻击者指定的 Ruby 代码。 例如，攻击者可以构造一个包含恶意代码的字符串，并将其作为模板名称或局部变量传递给`render`方法。当 Rails 应用尝试渲染该模板或使用该局部变量时，恶意代码就会被执行。根据 exploit-db 的 40086 描述，可以使用 `render :inline` 来执行代码。

**项目地址:** [Alejandro-MartinG/rails-PoC-CVE-2016-2098](https://github.com/Alejandro-MartinG/rails-PoC-CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #4

**来源**: [CVE-2016-2098-CyberDefenseInstitute_PoC_CVE-2016-2098_Rails42.md](../2016/CVE-2016-2098-CyberDefenseInstitute_PoC_CVE-2016-2098_Rails42.md)

## CVE-2016-2098-Ruby on Rails Action Pack RCE

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，允许远程攻击者执行任意Ruby代码

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序未使用安全的方式来处理render方法的用户输入

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-2098 漏洞是 Ruby on Rails Action Pack 中的一个远程代码执行漏洞。它允许远程攻击者通过利用应用程序对 `render` 方法的不受限制的使用来执行任意 Ruby 代码。

**漏洞分析：**

根据漏洞描述，漏洞的根源在于 Action Pack 组件在搜索用于渲染的模板时，处理用户提供的不可信输入的方式存在缺陷。如果应用程序将不可信的输入传递给 `render` 方法，攻击者可以构造恶意的输入来执行任意代码。

**POC 代码分析：**

提供的 POC 代码是 `Gemfile` 和 `Gemfile.lock` 文件，它们用于定义和锁定 Ruby 项目的依赖项。`Gemfile` 指定了项目使用的 Rails 版本 (4.2.5.1)，以及其他 gem 依赖项。`Gemfile.lock` 文件则记录了项目中使用的 gem 的确切版本，用于确保一致的构建。

这些文件本身并不包含漏洞利用代码，它们只是 Rails 应用配置的一部分。实际的漏洞利用需要向存在漏洞的 `render` 方法传递恶意的参数。

**有效性评估：**

POC 代码的有效性取决于目标应用程序是否使用了存在漏洞的 Rails 版本，并且允许用户控制传递给 `render` 方法的参数。如果满足这些条件，则漏洞利用是有效的。

**投毒风险评估：**

检查 `Gemfile` 和 `Gemfile.lock` 文件中是否存在投毒代码，需要检查是否有恶意或未知的 gem 依赖。当前提供的代码中，没有发现明显的投毒迹象。使用了常见的Rails版本和相关的gem包,例如 `rails`, `sqlite3`, `sass-rails`等。 但是，无法完全排除作者在其他地方添加恶意代码的可能性，例如在 `app` 目录下的 controller 或 view 文件中。

由于仅仅通过 `Gemfile` 和 `Gemfile.lock` 文件无法进行全面的代码审计，因此可以认为投毒风险非常低，约为1%。

**利用方式：**

1.  **找到易受攻击的 `render` 方法：** 确定应用程序中哪些地方使用了 `render` 方法，并且用户可以控制传递给 `render` 方法的参数。
2.  **构造恶意输入：** 构造包含恶意 Ruby 代码的输入字符串。例如，攻击者可以使用诸如 `<%= system('whoami') %>` 之类的代码来执行系统命令。
3.  **将恶意输入传递给 `render` 方法：** 将构造的恶意输入作为参数传递给 `render` 方法。这将导致应用程序执行恶意代码。

**总结：**

CVE-2016-2098 是一个严重的远程代码执行漏洞，需要及时修补。应用程序开发人员应该避免将不受信任的用户输入传递给 `render` 方法，并使用最新版本的 Rails 以获得安全修复。

**项目地址:** [CyberDefenseInstitute/PoC_CVE-2016-2098_Rails42](https://github.com/CyberDefenseInstitute/PoC_CVE-2016-2098_Rails42)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #5

**来源**: [CVE-2016-2098-DanielHemmati_CVE-2016-2098-my-first-exploit.md](../2016/CVE-2016-2098-DanielHemmati_CVE-2016-2098-my-first-exploit.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.x (< 3.2.22.2), 4.x (< 4.1.14.2), 4.2.x (< 4.2.5.2)

**利用条件:** 应用程序使用了`render`方法处理用户提供的不可信数据。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails 的 Action Pack 组件中，由于程序在处理`render`方法时未对用户输入进行充分的过滤和验证，导致远程攻击者可以执行任意 Ruby 代码。根据漏洞描述和搜索结果，攻击者可以通过构造特定的参数传递给`render`方法，从而执行恶意代码。

**有效性分析：**
提供的 Python 脚本`exploit.py` 旨在利用该漏洞。脚本允许用户指定目标 URL 和 payload。它将 payload 嵌入到 URL 中，并将其发送到目标应用程序。如果应用程序易受攻击，则会执行 payload 中包含的 Ruby 代码。该POC的有效性取决于目标Rails应用程序是否容易受到攻击且未进行修补。根据漏洞描述，低版本的 Rails 应用存在此风险。

**投毒风险分析：**
查看提供的 Python 脚本 `exploit.py` 和 `README.md`。`README.md` 文件只包含有关漏洞和脚本使用方法的描述，没有发现任何可疑代码。`exploit.py` 脚本的功能是构造和发送包含 payload 的 HTTP 请求，看起来相对简单直接。虽然脚本本身的功能是为了利用漏洞，但没有发现明显的后门或恶意代码。它接受用户提供的 payload 并将其发送到目标，因此恶意代码更有可能通过用户提供的 payload 注入到目标系统，而不是通过脚本本身进行投毒。因此，脚本本身的投毒风险较低，但使用时仍需谨慎，确保理解所执行的 payload 的含义。

**利用方式分析：**
1.  **确定目标：** 找到运行存在漏洞版本的 Ruby on Rails 应用程序。
2.  **构造 Payload：** 构建恶意的 Ruby 代码，例如执行系统命令。
3.  **发送请求：** 使用漏洞利用代码（或手动构造 HTTP 请求）将 payload 传递给应用程序的`render`方法，例如通过 URL 参数 `[inline]`。
4.  **执行代码：** 如果应用程序易受攻击，服务器将执行 payload 中的 Ruby 代码。

**示例：**
`python3 exploit.py -H "http://example.com/page?id=1"`
然后输入 payload: `system('whoami')` 。
如果成功，服务器会执行 `whoami` 命令，并将结果返回到攻击者。

综上所述，该漏洞的利用方式主要是通过操纵 `render` 方法的参数，注入恶意的 Ruby 代码，从而实现远程代码执行。该利用的有效性取决于目标应用程序的版本和配置。

**项目地址:** [DanielHemmati/CVE-2016-2098-my-first-exploit](https://github.com/DanielHemmati/CVE-2016-2098-my-first-exploit)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #6

**来源**: [CVE-2016-2098-Debalinax64_CVE-2016-2098.md](../2016/CVE-2016-2098-Debalinax64_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2 之前, 4.x 4.1.14.2 之前, 和 4.2.x 4.2.5.2 之前

**利用条件:** 目标应用使用了存在漏洞的Rails版本，并且应用程序允许使用render方法处理用户提供的输入。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails Action Pack 中，由于其 render 方法对用户输入未做严格限制，导致远程攻击者可以利用此漏洞执行任意 Ruby 代码，从而完全控制服务器。

**有效性：**
提供的POC代码是有效的。漏洞库信息，搜索引擎结果以及利用代码都表明可以通过`render`方法执行任意ruby代码。例如，可以使用`curl`发送包含恶意代码的请求，服务器会执行该代码。

**投毒风险：**
查看提供的 POC 代码 `/tmp/fb84a5f2be1c3ed581440d890e43983b/ruby-on-rail-RCE.sh`，该脚本主要功能是发送包含ruby代码的curl请求，执行用户指定的命令。脚本本身没有明显的恶意行为，例如反弹shell或下载其他恶意文件。因此，投毒风险较低，但考虑到脚本的执行环境和权限，以及可能被用于自动化攻击，存在一定风险。`/tmp/fb84a5f2be1c3ed581440d890e43983b/README.md`文件只是漏洞描述和使用说明，不存在投毒代码。总体评估风险比例为5%。

**利用方式：**
1.  攻击者需要找到一个使用了存在漏洞的Rails版本，并且允许使用render方法的应用程序。
2.  攻击者通过构造恶意的URL，将payload传递给`render`方法。 Payload形式是 `%3C%25=%20%25x('command')%20%25%3E`。 其中`command`参数是要在目标服务器上执行的命令。
3.  目标服务器在处理请求时，会执行该恶意Ruby代码，从而执行攻击者指定的命令。

**项目地址:** [Debalinax64/CVE-2016-2098](https://github.com/Debalinax64/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #7

**来源**: [CVE-2016-2098-JoseLRC97_Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution.md](../2016/CVE-2016-2098-JoseLRC97_Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution.md)

## CVE-2016-2098-Ruby on Rails Action Pack-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2之前, 4.x版本4.1.14.2之前, 4.2.x版本4.2.5.2之前

**利用条件:** 应用程序使用了`render`方法并且允许用户控制输入

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞。该漏洞源于应用程序对`render`方法的不受限制的使用。如果应用程序允许用户控制传递给`render`方法的参数，攻击者可以利用此漏洞执行任意Ruby代码。

**有效性：**
漏洞库信息和搜索引擎结果都确认了此漏洞的存在和严重性。Exploit-DB上存在相关的漏洞利用代码（https://www.exploit-db.com/exploits/40086/），进一步验证了漏洞的可利用性。

**投毒风险：**
提供的漏洞利用代码片段只是GNU通用公共许可证，并非漏洞的实际利用代码。因此，无法从中判断是否存在投毒风险。需要进一步分析实际的漏洞利用代码才能评估投毒风险。目前判断投毒风险为0%。

**利用方式：**
利用方式是，攻击者需要找到一个应用程序中使用了`render`方法并且允许用户控制输入的位置。然后，攻击者可以构造恶意的输入，例如包含Ruby代码的字符串，将其传递给`render`方法。`render`方法会执行该Ruby代码，从而导致远程代码执行。具体的payload取决于目标应用程序的上下文，但通常可以用于执行系统命令、读取敏感文件或在服务器上安装后门。

**项目地址:** [JoseLRC97/Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution](https://github.com/JoseLRC97/Ruby-on-Rails-ActionPack-Inline-ERB-Remote-Code-Execution)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #8

**来源**: [CVE-2016-2098-Shakun8_CVE-2016-2098.md](../2016/CVE-2016-2098-Shakun8_CVE-2016-2098.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 目标应用使用了存在漏洞的Rails版本，且允许通过URL参数控制render方法。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞，源于对`render`方法的不受限制的使用。攻击者可以通过构造恶意的URL参数，将Ruby代码注入到`render`方法中执行，从而获得服务器的控制权。

**有效性：**
提供的POC代码`CVE-2016-2098.py`看起来是有效的。它使用`requests`库发送带有恶意参数的GET请求，其中参数值包含要执行的Ruby代码。Payload 构造的核心在于 `#{sys.argv[3]}[inline]=%3C%25=%20%25x({cmd})%20%25%3E` ，这部分代码将命令插入到ERB模板中，利用Rails的render方法执行任意代码。

**投毒风险：**
提供的漏洞利用代码中没有发现明显的投毒代码。该脚本的主要功能是发送包含恶意payload的HTTP请求，并打印响应结果。`README.md`文件仅包含漏洞名称和POC描述，没有可疑内容。因此，投毒风险较低，为0%。

**利用方式：**
1.  **确定目标应用是否使用了存在漏洞的Rails版本。**
2.  **构造包含恶意Ruby代码的URL参数。** 例如，使用提供的POC脚本：
    `python CVE-2016-2098.py 'system("whoami")' 'http://target.com/controller/action' 'payload'`
    这个命令会在目标服务器上执行`whoami`命令，并将结果返回。
3.  **发送包含恶意参数的HTTP请求。**
4.  **分析响应结果，确认代码是否成功执行。**

攻击者可以利用此漏洞执行任意系统命令，读取敏感文件，甚至完全控制服务器。修复此漏洞的方法是升级到受影响Rails版本以上的版本，或者限制对render方法的使用。

**项目地址:** [Shakun8/CVE-2016-2098](https://github.com/Shakun8/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #9

**来源**: [CVE-2016-2098-hderms_dh-CVE_2016_2098.md](../2016/CVE-2016-2098-hderms_dh-CVE_2016_2098.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，允许远程攻击者执行任意 Ruby 代码

**影响版本:** < 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序需要允许用户控制的输入传递给 render 方法

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-2098 存在于 Ruby on Rails 的 Action Pack 中，由于对 `render` 方法的使用未加限制，允许远程攻击者执行任意 Ruby 代码。根据漏洞信息，受影响的版本包括 3.2.22.2 之前的 3.x 版本、4.1.14.2 之前的 4.x 版本，以及 4.2.5.2 之前的 4.2.x 版本。

**漏洞利用方式：**
攻击者可以通过构造恶意的输入，将其传递给 `render` 方法，从而执行任意 Ruby 代码。这通常涉及到控制传递给 `render` 方法的模板名称或选项。根据搜索结果和漏洞库信息，漏洞的核心在于应用程序未能正确地过滤或转义用户提供的输入，直接将其用于渲染过程。

**POC 代码分析：**
提供的 POC 代码包含 `Gemfile` 和 `Gemfile.lock`。这些文件定义了 Ruby on Rails 应用的依赖。`Gemfile` 指定了 Rails 版本为 4.2.4，这属于受影响的版本范围。`Gemfile.lock` 锁定了具体的依赖版本，确保应用在不同环境中依赖的一致性。这些文件本身不包含直接的攻击代码，它们只是一个 Rails 应用的依赖描述文件，用于搭建易受攻击的环境。

**投毒风险分析：**
分析 `Gemfile` 和 `Gemfile.lock`，虽然没有明显的恶意代码，但依旧存在一定的投毒风险。攻击者可能通过修改 `Gemfile`，引入包含恶意代码的 gem 包。或者，虽然当前依赖没有问题，但未来依赖更新时，可能会引入包含漏洞或后门的 gem 包。当然，在提供的两个文件中，并没有发现后门或者漏洞代码，风险主要在于构建环境和引入存在风险的三方包。因此，投毒风险估计为 10%。

**项目地址:** [hderms/dh-CVE_2016_2098](https://github.com/hderms/dh-CVE_2016_2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #10

**来源**: [CVE-2016-2098-its-arun_CVE-2016-2098.md](../2016/CVE-2016-2098-its-arun_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，允许攻击者执行任意Ruby代码

**影响版本:** 3.2.22.2之前, 4.x 4.1.14.2之前, 和 4.2.x 4.2.5.2之前

**利用条件:** 目标应用使用了存在漏洞的Rails版本，且`render`方法以不安全的方式处理用户输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞。该漏洞源于对`render`方法的不安全使用，允许远程攻击者通过操纵用户提供的数据来执行任意Ruby代码。

**有效性：**

提供的POC代码利用了这一漏洞。通过向易受攻击的Rails应用发送特制的HTTP请求，攻击者可以在服务器上执行任意命令。

**投毒风险：**

代码本身的功能就是利用漏洞执行命令，没有发现恶意添加的额外功能代码。但是，下载和使用任何未经审查的漏洞利用代码都存在风险。POC代码的设计目标是利用漏洞，而攻击者可以修改这些POC代码以包含恶意功能，例如安装后门、窃取数据或进行其他恶意活动。
`README.md` 文件描述了漏洞和基本用法，未发现恶意代码。
`CVE-2016-2098.sh` 脚本相对简单，主要功能是构造恶意请求以利用漏洞。虽然脚本本身没有明显的恶意代码，但用户应始终谨慎审查并理解任何下载的代码。

**利用方式：**

1.  **确定目标:** 识别运行易受攻击的Ruby on Rails版本的Web应用程序。
2.  **构造Payload:** 使用POC脚本，构造包含要执行的Ruby代码的HTTP请求。此代码将作为`render`方法的参数传递。
3.  **发送Payload:** 将构造的HTTP请求发送到目标Web应用程序。
4.  **执行代码:** 如果目标应用程序易受攻击，服务器将执行嵌入在Payload中的Ruby代码。

脚本的工作方式是：

*   它接受三个参数：目标主机、URI 和要执行的命令。
*   它使用 `curl` 命令发送一个包含恶意 payload 的 HTTP 请求到目标服务器。Payload 利用 Rails `render` 方法执行任意命令。
*   它提供一个简单的交互式 shell，允许攻击者重复执行命令。

**项目地址:** [its-arun/CVE-2016-2098](https://github.com/its-arun/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #11

**来源**: [CVE-2016-2098-j4k0m_CVE-2016-2098.md](../2016/CVE-2016-2098-j4k0m_CVE-2016-2098.md)

## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails (Action Pack)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2之前, 4.x版本在4.1.14.2之前, 4.2.x版本在4.2.5.2之前

**利用条件:** 应用程序必须允许通过`render`方法处理用户提供的输入。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-2098 是一个 Ruby on Rails Action Pack 中的远程代码执行漏洞。攻击者可以通过向`render`方法提供恶意构造的输入来执行任意 Ruby 代码。  根据漏洞描述，漏洞根源在于Rails的`render`方法对用户输入的不当处理。POC 利用方式是通过`view[inline]`参数传递 Ruby 代码，该代码会被服务器执行。具体来说，POC 使用了 `<%= %x('[CMD]') %>` 这样的 Ruby 代码结构，其中 `[CMD]` 会被替换成想要执行的系统命令。例如，`<%= %x('whoami') %>` 会执行 `whoami` 命令，并将其输出显示在页面上。  利用步骤： 1. 确定目标 Rails 应用使用的 Rails 版本在受影响范围内。 2. 构造包含恶意 Ruby 代码的 URL，例如 `http://example.com/?view[inline]=<%= %x('whoami') %>` （需要 URL 编码）。 3. 将构造的 URL 发送到目标服务器。 4. 如果服务器存在漏洞，则会执行恶意代码，并将结果返回给攻击者。  投毒风险较低，主要因为 POC 代码的功能明确，目的是执行用户指定的命令。虽然攻击者可以利用该漏洞执行任何命令，但提供的 POC 本身不包含任何隐藏的恶意功能。 投毒的可能来自于下载后使用者更改后门,但原始版本后门概率极低。

**项目地址:** [j4k0m/CVE-2016-2098](https://github.com/j4k0m/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

## POC #12

**来源**: [CVE-2016-2098-sealldeveloper_CVE-2016-2098-PoC.md](../2016/CVE-2016-2098-sealldeveloper_CVE-2016-2098-PoC.md)

## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 3.2.22.2之前, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用使用了render方法并且允许用户可控的输入作为render方法的参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098 漏洞是 Ruby on Rails Action Pack 中由于不安全地使用 `render` 方法导致的远程代码执行漏洞。攻击者可以通过提供恶意构造的输入数据作为 `render` 方法的参数，从而执行任意 Ruby 代码。漏洞利用方式：

1.  **漏洞触发点：** 应用的某个功能使用了`render`方法，并且允许用户输入来决定渲染的内容。
2.  **攻击向量：** 攻击者构造包含恶意 Ruby 代码的字符串，并将其作为参数传递给 `render` 方法。
3.  **代码执行：** 由于 Rails 在处理 `render` 方法时，没有充分验证用户输入，导致恶意代码被执行。

**有效性：** 根据漏洞描述和搜索结果，此漏洞的POC已经公开，并且可以被利用。

**投毒风险：** 提供的漏洞利用代码只是一个LICENSE文件，无法评估是否存在投毒行为。即使有公开的POC存在，下载和使用任何第三方提供的代码都应该谨慎，并在安全的环境中进行测试。

**项目地址:** [sealldeveloper/CVE-2016-2098-PoC](https://github.com/sealldeveloper/CVE-2016-2098-PoC)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)

---

