## CVE-2016-15048 - AMTT Hotel Broadband Operation System (HiBOS) 命令注入

**漏洞编号:** CVE-2016-15048

**漏洞类型:** 命令注入

**影响应用:** AMTT Hotel Broadband Operation System (HiBOS)

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 未知具体版本（涵盖受影响的server_ping.php组件版本）

**利用条件:** 远程网络访问、无需身份认证

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

关于POC有效性的深入分析：该POC通过Docker环境模拟了AMTT HiBOS系统中的/manager/radius/server_ping.php接口。在代码逻辑分析中，`mock_cve_2016_15048.py`脚本清晰地展示了漏洞成因：程序直接获取HTTP GET请求中的`ip`参数，并将其拼接到Shell命令字符串`f"ping -c 1 {ip}"`中，随后通过`subprocess.check_output(..., shell=True)`执行。由于未对输入进行任何过滤或转义，攻击者可以使用分号（;）、管道符（|）或换行符（%0a）注入恶意命令。利用步骤如下：1. 使用Docker Compose启动测试环境，暴露8081端口；2. 构造恶意URL，如`http://localhost:8081/manager/radius/server_ping.php?ip=127.0.0.1;whoami`；3. 发送HTTP GET请求。POC中提供的Nuclei模板和curl示例均能稳定触发该漏洞，验证了其在未授权情况下实现远程代码执行的可行性。该环境完整复现了Web服务层到操作系统层命令注入的路径，不仅适用于漏洞演示，也适用于WAF规则测试。关于投毒风险分析：经过对提供的POC代码（Dockerfile、docker-compose.yml及Python脚本）的逐行审计，未发现恶意行为。Dockerfile基于官方PHP镜像，仅进行目录拷贝和权限设置；Python脚本使用了标准库（http.server, subprocess），其核心逻辑是模拟漏洞点，不包含混淆代码、外部恶意下载逻辑或敏感信息外传操作。README中提供的Nuclei命令指向本地/相对路径，属于合法的安全测试行为。其投毒风险极低（5%），仅需注意在生产环境中运行此类模拟器时，应确保该容器被正确隔离，防止他人利用该模拟漏洞作为进入内网的跳板。该POC是典型的防御性安全研究工具，旨在帮助安全人员理解和修复老旧系统中的高危漏洞，代码透明度极高。

**项目地址:** 本地模拟项目 (vulnwatchdog_4fa1a39687723841fccf93d824816368)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2016-15048](https://nvd.nist.gov/vuln/detail/CVE-2016-15048)
