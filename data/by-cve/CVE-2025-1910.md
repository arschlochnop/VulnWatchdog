## CVE-2025-1910 - WatchGuard Mobile VPN with SSL 本地权限提升 (LPE)

**漏洞编号:** CVE-2025-1910

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** WatchGuard Mobile VPN with SSL

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** <= 12.11.2

**利用条件:** 低权限用户访问、安装了受影响的客户端软件、能够诱导客户端连接到恶意OpenVPN服务器

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该POC展示了WatchGuard Mobile VPN with SSL客户端在处理.wgssl配置文件时的逻辑缺陷。有效性体现在其精准捕捉了客户端在建立SSL VPN连接后，会以SYSTEM权限执行配置文件中打包的脚本这一行为。该漏洞的核心在于客户端未能对下载并解压的配置文件进行充分的来源校验或权限隔离。通过构建一个包含恶意run.bat、client.ovpn和对应MD5SUM文件的压缩包，攻击者可以欺骗客户端下载该更新包。一旦连接建立，客户端的特权服务会自动执行run.bat。实验证明，该POC在12.11.2版本上表现稳定，能够通过添加本地管理员账户（如shinyNewAdmin）实现完整的权限提升。利用步骤：1. 攻击者准备阶段：配置一个通用的OpenVPN服务器，并修改client.ovpn指向该服务器；编写run.bat攻击负载（默认为创建管理员用户）；计算文件校验和并打包为.wgssl格式。2. 环境搭建：使用Python Flask启动一个HTTPS服务器分发恶意配置文件，并准备好对应的SSL证书（可自签名）。3. 诱导受害者：受害用户在客户端输入任意凭据连接至攻击者控制的地址，并在安全警告弹出时点击“是”忽略证书错误。4. 自动触发：连接成功后，客户端会自动同步并执行恶意包中的run.bat，从而在SYSTEM上下文执行任意指令。投毒风险分析：该POC代码结构清晰，使用了标准的开源工具（Flask, OpenVPN, Openssl）和自动化构建工具（Nix Flake），没有发现代码混淆或隐藏的恶意二进制文件。风险点主要在于其提供的run.bat示例虽然仅为添加用户，但极易被修改为植入远控木马或勒索软件。代码库中包含了Nix环境配置文件，这增加了其在开发者和研究人员环境中的隐蔽执行能力。经过静态扫描，未发现该POC项目本身包含向第三方服务器发送敏感数据的恶意后门或自动下载额外恶意载荷的行为。虽然其利用过程涉及模拟攻击者服务器，但所有交互均在用户可控范围内。因此，该POC被判定为相对安全的防御性研究样本，投毒风险较低，但由于其高度的易用性和破坏潜力，组织应重点防范其在内网被恶意利用。针对此漏洞，建议立即升级WatchGuard客户端至官方修复版本，并限制普通用户安装未受信任证书或连接非官方VPN网关的能力。

**项目地址:** [https://github.com/LutraSecurity/CVE-2025-1910](https://www.google.com/search?q=https://github.com/LutraSecurity/CVE-2025-1910)

**漏洞详情:** [https://lutrasecurity.com/en/articles/cve-2025-1910-watchguard-privilege-escalation/](https://lutrasecurity.com/en/articles/cve-2025-1910-watchguard-privilege-escalation/)
