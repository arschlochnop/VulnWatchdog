## CVE-2017-9805 - Apache Struts 2 (REST Plugin) RCE (远程代码执行)

**漏洞编号:** CVE-2017-9805

**漏洞类型:** RCE (远程代码执行)

**影响应用:** Apache Struts 2 (REST Plugin)

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** Struts 2.1.2 - 2.3.33, Struts 2.5 - 2.5.12

**利用条件:** 无需认证，远程网络可达，且目标系统开启了REST插件并使用XStream处理XML请求数据。

**POC 可用性:** 4/10

**POC 类型:** 概念验证/仅说明

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】CVE-2017-9805是一个存在于Apache Struts 2 REST插件中的关键安全漏洞。该漏洞源于插件在处理XML格式的数据时，使用了缺乏安全加固的XStream组件进行反序列化操作。在默认配置下，XStream会将XML数据直接转换为Java对象，而未对输入数据进行充分的白名单过滤或校验。攻击者可以通过向受影响的Struts服务器发送一个Content-Type为'application/xml'的POST请求，并在请求体中构造恶意序列化payload（通常利用ProcessBuilder等类），实现无需身份验证的远程代码执行。从提供的POC资料分析，该README文档描述了一个针对Harvard大学特定接口的分析案例，并指向了已知的公开利用工具'struts-pwn'。此类POC在技术逻辑上是完全成立的，因为其利用了Java反射机制和XStream处理Map或Collection对象时的内置逻辑缺陷。然而，由于该漏洞属于2017年的陈旧漏洞，现代WAF（Web应用防火墙）和Java运行环境（如JDK 9+）对相关反射调用或特定敏感类的限制，使得原始POC在未经修改的情况下可能在较新环境下失效。此外，实际利用需要目标环境安装有XStream库且处于可调用的Classpath中。 【利用步骤】1. 环境准备：确定目标系统运行的是受影响版本的Struts 2并启用了REST插件。2. 构造Payload：使用Java序列化生成工具（如ysoserial）或者直接编写XML格式的XStream Payload，通过ProcessBuilder执行系统命令。3. 发送请求：使用curl或Burp Suite向目标的REST端点发送POST请求，将Content-Type设置为application/xml，并将Payload放入请求体。4. 结果验证：观察服务器响应或通过反弹shell/创建文件来验证代码执行是否成功。 【投毒风险分析】该POC库目前的风险等级较低。通过对README内容和搜索结果的审查，该项目主要作为安全研究和防御测试的说明文档存在。投毒风险主要集中在以下几点：首先，README中提到的第三方项目链接（如GitHub上的struts-pwn）如果被劫持，攻击者可能在脚本中注入恶意后门代码，导致研究人员在测试时反被控。其次，虽然README本身不包含二进制文件，但由于其提及了具体的教育机构作为测试目标，这种行为可能被不法分子利用作为攻击模板。由于代码片段逻辑清晰，且基于标准的MIT授权协议，目前未发现隐蔽的混淆逻辑或外部恶意域名调用。防御方在参考此类项目时，应重点核查脚本中的网络回连部分（如硬编码的IP地址或URL），避免直接运行未经审计的Python脚本或Java工具包，以防在渗透测试过程中遭受供应端投毒攻击。

**项目地址:** [https://github.com/mazen160/struts-pwn_CVE-2017-9805](https://github.com/mazen160/struts-pwn_CVE-2017-9805)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2017-9805](https://nvd.nist.gov/vuln/detail/CVE-2017-9805)
