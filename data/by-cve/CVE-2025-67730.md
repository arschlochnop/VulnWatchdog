## CVE-2025-67730 - Frappe Learning Management System (LMS) 存储型XSS (Stored Cross-Site Scripting)

**漏洞编号:** CVE-2025-67730

**漏洞类型:** 存储型XSS (Stored Cross-Site Scripting)

**影响应用:** Frappe Learning Management System (LMS)

**危害等级:** 中等至高 (Medium-High)

**CVSS评分:** CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:L/A:N

**影响版本:** < 2.42.0

**利用条件:** 需要经过身份验证的用户权限，能够编辑或创建Job、Course或Batch表单。

**POC 可用性:** 4/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

【POC有效性分析】该漏洞属于经典的存储型跨站脚本（Stored XSS）漏洞，存在于Frappe LMS框架的Job、Course和Batch描述字段中。根据提供的POC代码 `"><img src=x onerror=alert(document.domain)>`，攻击原理是通过闭合HTML标签并注入恶意事件处理器。分析显示，该POC在逻辑上是完全有效的，因为它利用了服务器端对输入字段（Description Fields）缺乏过滤以及前端渲染时缺乏转义的缺陷。由于该平台是基于Frappe框架构建的，通常这类描述字段支持Markdown或富文本，如果开发者未正确调用Frappe内置的HTML净化函数（Sanitizer），则会导致输入内容被原样存入数据库并在其他用户访问时触发。利用步骤清晰：1. 攻击者以合法用户身份登录；2. 在课程或职位描述中填入Payload；3. 数据库保存恶意脚本；4. 任何访问该课程页面的用户（包括管理员）浏览器将执行该脚本。此POC仅作为弹窗验证，属于无害化测试，足以证明漏洞存在。【投毒风险分析】从安全防御研究的角度来看，此POC代码本身极其简洁，仅包含标准的HTML/JavaScript测试语句，没有使用混淆（Obfuscation）、Base64加密、外部恶意域名的请求或eval()等敏感函数，因此代码投毒（Poisoning）的风险极低（评估为5%）。在GitHub或技术论坛上，此类漏洞经常被用于演示。然而，安全团队在复现时应注意：虽然此处的Payload是无害的alert，但在实际攻击场景中，攻击者会将其替换为窃取Cookie的脚本（Session Hijacking）或重定向脚本。投毒风险主要集中在如果研究人员从不可信的仓库下载自动化扫描脚本来测试此CVE，那些脚本可能携带恶意软件。针对此特定POC文件，其README文档结构清晰，包含免责声明和修复建议，符合负责任披露的标准。为了规避风险，建议在隔离的沙箱环境中使用Frappe的开发版本进行复现，并使用浏览器开发者工具观察DOM树的结构变化，而不是依赖自动化的第三方Payload执行器。

**项目地址:** [https://github.com/frappe/lms/security/advisories/GHSA-jjc4-j3hw-33h2](https://github.com/frappe/lms/security/advisories/GHSA-jjc4-j3hw-33h2)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-67730](https://nvd.nist.gov/vuln/detail/CVE-2025-67730)
