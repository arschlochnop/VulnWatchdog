## CVE-2025-14783 - Easy Digital Downloads (EDD) Password Reset Poisoning / Account Takeover (ATO)

**漏洞编号:** CVE-2025-14783

**漏洞类型:** Password Reset Poisoning / Account Takeover (ATO)

**影响应用:** Easy Digital Downloads (EDD)

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (Estimated)

**影响版本:** <= 3.6.2

**利用条件:** 远程不需认证即可发起请求，受害者需点击邮件中的伪造链接

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞存在于WordPress插件Easy Digital Downloads的密码重置逻辑中。其核心缺陷在于对`edd_redirect`参数的过滤不严。开发者虽然使用了`esc_url_raw()`函数进行清洗，但该函数主要用于防止XSS和格式化URL，并不会验证URL的Host部分。这意味着攻击者可以通过POST请求注入一个由其控制的恶意域名。当系统生成密码重置邮件时，`add_query_arg`会将合法的重置密钥（key）和登录名附加到攻击者提供的恶意域名之后。POC代码展示了一个完整的攻击链：一个Python脚本负责向目标站点发送带有恶意`edd_redirect`的重置请求，另一个PHP脚本（logger.php）用于在攻击者服务器上捕获携带敏感Token的回调请求。一旦受害者在邮件中点击该链接，其重置密钥将直接泄露给攻击者。通过分析POC代码中的PHP片段，该逻辑在技术上是完全可行的，属于典型的主机头或参数重定向导致的信息泄露。利用步骤：1. 攻击者准备一个公网可访问的服务器，部署`logger.php`用于记录GET参数。2. 使用Python脚本向目标WordPress网站的密码重置接口发送POST请求，设置`edd_redirect`为攻击者的恶意URL。3. 系统向管理员或特定用户发送合法的重置邮件，但邮件内的链接指向攻击者的服务器。4. 受害者点击链接后，攻击者从日志中提取`key`和`login`参数。5. 攻击者利用获取的Token直接修改受害者密码并接管账户。投毒风险分析：该POC项目目前表现为标准的防御性安全研究代码，投毒风险较低。代码库主要由Python和PHP组成，逻辑清晰，主要使用了Python的`requests`标准库。在分析过程中未发现明显的混淆代码、Base64加密的恶意Payload或自动下载远程二进制文件的行为。然而，防御者仍需注意其提供的`logger.php`脚本。虽然该脚本在PoC演示中是必要的，但在生产环境中部署此类接收端时，必须确保其自身不被滥用。此外，项目引用的图片资源来自外部GitHub库，虽然目前安全，但仍需警惕开发者后续通过更新该外部资源进行间接钓鱼或通过README中的虚假链接引导下载恶意软件的风险。总的来说，该代码库具有很高的研究价值，但也应在隔离的沙箱环境中运行验证，防止其模拟攻击脚本中潜在的隐藏回调。建议管理员尽快升级Easy Digital Downloads至3.6.3或更高版本，以彻底修复该未授权重定向漏洞。

**项目地址:** [https://github.com/ZeroEthical/CVE-2025-14783-POC](https://www.google.com/search?q=https://github.com/ZeroEthical/CVE-2025-14783-POC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-14783](https://nvd.nist.gov/vuln/detail/CVE-2025-14783)
