## CVE-2025-57489 - SuperDuper! 权限提升

**漏洞编号:** CVE-2025-57489

**漏洞类型:** 权限提升

**影响应用:** SuperDuper!

**危害等级:** 高危

**CVSS评分:** 8.1 (CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 3.10 及之前版本

**利用条件:** 需要目标机器安装 SuperDuper! 3.10 或更早版本，且需要解锁 SuperDuper! 应用的锁，允许在不输入管理员密码的情况下执行操作。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

CVE-2025-57489 存在于 SuperDuper! v3.10 及其之前的版本中，允许攻击者将权限提升至 root。该漏洞源于 SDAgent 组件中不正确的访问控制，SDAgent 是一个 setuid 二进制文件。当 SuperDuper! 的锁被解锁以允许执行时，第三方程序可以利用此授权来运行具有管理员权限的其他程序。攻击者可以利用 SDAgent 组件执行任意 shell 命令，从而获得 root 权限。

POC 代码分析：提供的 POC 代码是一个 bash 脚本，它利用了 SuperDuper! 的 SDAgent 组件的漏洞。脚本首先创建一个命名管道 /tmp/puppet，然后使用 tail -f 命令监视该管道。同时，脚本启动 SDAgent 进程，并将命令写入管道。SDAgent 进程会读取管道中的命令并以 root 权限执行。脚本首先写入 "1 2 \0"，然后睡眠 1 秒，最后写入 "whoami\0"。这意味着 SDAgent 将执行 whoami 命令，并将结果以 root 权限返回。

利用步骤：
1.  下载并安装 SuperDuper! v3.10 或更早版本。
2.  解锁 SuperDuper! 应用的锁。
3.  运行提供的 POC 脚本。
4.  查看输出，确认 whoami 命令以 root 权限执行。

该 POC 的有效性较高，因为它直接利用了漏洞，并且可以稳定地提升权限至 root。该漏洞的修复方法是升级到 SuperDuper! v3.11 或更高版本，或者删除 SuperDuper! 应用程序。

投毒风险分析：此 POC 脚本的投毒风险较低。脚本本身的代码比较清晰，没有明显的恶意行为。脚本主要使用了标准 shell 命令，如 mkfifo、tail、printf 和 sleep。脚本中唯一可能引起怀疑的地方是它创建了一个命名管道 /tmp/puppet，但这只是利用漏洞的必要步骤。总体而言，该脚本的投毒风险较低，因为它没有试图执行任何恶意操作，也没有下载或执行任何外部脚本。然而，仍需要注意的是，任何未经授权的权限提升行为都可能被视为恶意行为，因此在使用此 POC 时需要谨慎。

**项目地址:** https://www.cve.org/CVERecord?id=CVE-2025-57489

**漏洞详情:** https://www.cve.org/CVERecord?id=CVE-2025-57489
