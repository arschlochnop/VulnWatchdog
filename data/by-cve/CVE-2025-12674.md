## CVE-2025-12674 - KiotViet (Management Software) 任意文件上传 (Arbitrary File Upload)

**漏洞编号:** CVE-2025-12674

**漏洞类型:** 任意文件上传 (Arbitrary File Upload)

**影响应用:** KiotViet (Management Software)

**危害等级:** 严重 (Critical)

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 未知 (相关产品已知存在历史上传漏洞)

**利用条件:** 无需身份验证，目标服务器存在特定上传接口暴露。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该脚本名为 CVE-2025-12674.py，由作者 Nxploited 编写，针对 KiotViet 管理系统。代码展示了完整的自动化攻击逻辑，使用 Python 的 threading 和 requests 库进行多线程扫描和利用。其核心逻辑在于针对目标 URL 构造特定的 POST 请求，将用户定义的远程 Shell 地址上传至目标服务器。脚本使用了 rich 库来增强终端显示效果，具备进度条、统计面板和彩色输出，这表明该 POC 并非原始的概念验证，而是经过工程化封装的利用工具。通过分析脚本中的 `USER_AGENT`（KiotVietEx/1.0）以及文件上传路径的处理逻辑，可以确认其针对的是特定业务逻辑中的文件校验绕过缺陷。该 POC 具备高度的可操作性，能够直接读取 list.txt 中的目标列表并批量尝试获取 WebShell，是典型的‘开箱即用’式攻击工具。利用步骤：1. 用户在 list.txt 中准备目标主机列表。2. 启动脚本后，输入线程数和远程恶意 Shell 的 URL（由攻击者托管）。3. 脚本初始化多线程任务，对列表中的每个 URL 发起探测请求。4. 脚本尝试利用 KiotViet 系统中未公开的上传接口，将远程 Shell 内容写入目标服务器的 Web 目录下。5. 如果上传成功，脚本将生成的 WebShell 地址保存至 shells.txt 供后续连接。投毒风险分析：经过对 POC 源代码的静态审计，该脚本目前表现为较低的投毒风险。脚本作者公开了其 GitHub（Nxploited）和 Telegram 频道，增加了代码的可追溯性。代码中未发现明显的混淆处理（如 base64 加密执行、eval 等），逻辑相对透明。其主要功能是向用户指定的 targets 上传 Shell，而不是在运行 POC 的本地机器上执行恶意指令。然而，值得警惕的是：第一，脚本定义了 `os.environ['NO_PROXY'] = '*'`，这可能是为了绕过本地安全审计拦截；第二，虽然目前代码逻辑清晰，但此类自动化利用脚本常被恶意作者修改，通过在 `requests` 请求中夹带针对执行者机器的探测指令，或者在下载远程 Shell 的逻辑中加入反弹连接到作者服务器的代码。此外，脚本依赖的外部库（如 rich）虽然是标准的，但若通过非官方渠道获取此类 POC，仍需防范脚本末尾被添加隐藏的恶意载荷。综合评估，该脚本本身是功能性的攻击工具，建议在隔离的沙箱环境中使用。

**项目地址:** [https://github.com/Nxploited](https://github.com/Nxploited)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-12674](https://nvd.nist.gov/vuln/detail/CVE-2025-12674)
