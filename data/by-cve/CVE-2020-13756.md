## CVE-2020-13756 - Sabberworm PHP CSS Parser RCE

**漏洞编号:** CVE-2020-13756

**漏洞类型:** RCE

**影响应用:** Sabberworm PHP CSS Parser

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** < 8.3.1

**利用条件:** 需要网络访问，无需认证

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2020-13756是Sabberworm PHP CSS Parser中的一个远程代码执行漏洞。该漏洞存在于`getSelectorsBySpecificity()`函数中，该函数将未经 sanitization 的用户输入传递给`eval()`函数，导致远程代码执行。 

POC有效性分析:
POC代码是一个Docker环境，包含易受攻击的Sabberworm PHP CSS Parser版本。Dockerfile安装了必要的依赖，并创建了一个包含漏洞版本的composer.json文件。README.md文件提供了快速启动的说明，包括使用Docker运行环境，并提供了一个curl命令来验证漏洞。通过发送包含恶意代码的GET请求到`/index.php`，攻击者可以触发`eval()`函数的执行，从而实现远程代码执行。

利用步骤：
1. 部署提供的Docker环境。
2. 使用curl命令发送包含恶意代码的GET请求，例如：`curl "http://localhost:8080/?n=100;printf(%22VULN_TEST%22);"`。
3. 验证响应是否包含预期的输出（例如，"VULN_TEST"），以确认代码已成功执行。
4. 也可以使用Nuclei模板进行漏洞扫描，验证漏洞是否存在。

投毒风险分析:
该POC的投毒风险较低。Dockerfile使用官方PHP镜像，并且只安装了必要的组件。composer.json文件指定了易受攻击的Sabberworm PHP CSS Parser版本。index.php文件用于触发漏洞。虽然利用涉及使用`eval()`，这本身就是一个风险点，但提供的POC代码清晰，没有发现其他可疑行为或恶意代码。攻击者可能会修改提供的POC代码，以包含更具破坏性的payload，例如下载和执行恶意二进制文件，或者窃取敏感数据。由于该漏洞允许远程代码执行，因此攻击者可以完全控制受感染的系统。然而，原始的POC本身不包含任何恶意payload，因此投毒风险较低。此外，该POC明确声明仅用于授权安全测试。

搜索结果显示，shopch.jp是一个电视购物网站，与此漏洞无关。其他搜索结果主要与职业发展和继续教育相关，也与该漏洞无关。

**项目地址:** https://github.com/KrE80r/CVE-2020-13756-env.git

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2020-13756
