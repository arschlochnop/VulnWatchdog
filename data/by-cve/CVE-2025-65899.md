## CVE-2025-65899 - Kalmia CMS v0.2.0 用户枚举漏洞

**漏洞编号:** CVE-2025-65899

**漏洞类型:** 用户枚举

**影响应用:** Kalmia CMS

**危害等级:** 中危，可能导致密码喷洒、凭据填充和账户发现攻击

**影响版本:** 0.2.0

**利用条件:** 需要能够访问/kal-api/auth/jwt/create接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Kalmia CMS v0.2.0的身份验证机制中。系统对于无效用户和有效用户但密码错误的情况返回不同的错误信息，攻击者可以通过观察这些差异来枚举有效的用户名。

**有效性：**

提供的POC代码有效。POC代码描述了如何利用不同的错误信息来区分不存在的用户和存在的用户。通过向`/kal-api/auth/jwt/create`接口发送POST请求，并观察返回的JSON消息（`user_not_found`或`invalid_password`），可以判断用户名是否存在。

**投毒风险：**

考虑到POC代码本身是为了演示漏洞利用过程，而非植入恶意代码，所以投毒风险较低，估计在10%。主要风险在于：
*   图片链接（images/image.png, images/image1.png, images/image2.png, images/image3.png）可能指向外部恶意网站，用于追踪或窃取IP地址等信息，或传播恶意软件。
*   虽然POC代码描述的是用户枚举漏洞，但如果攻击者将此代码与其他漏洞（例如密码重置漏洞）结合使用，可能会造成更大的危害。

**利用方式：**

1.  攻击者构造一个用户名列表（例如，常见的用户名、公司员工姓名等）。
2.  针对每个用户名，向`/kal-api/auth/jwt/create`接口发送POST请求，payload中包含该用户名和任意密码。
3.  分析服务器的响应：
    *   如果响应为`{"message": "user_not_found"}`，则表示该用户名不存在。
    *   如果响应为`{"message": "invalid_password"}`，则表示该用户名存在。
4.  重复步骤2和3，直到枚举出所有有效的用户名。
5.  利用枚举出的用户名，进行密码喷洒、凭据填充或社会工程攻击。

**总结：**

该漏洞利用简单，危害中等。攻击者可以利用此漏洞枚举有效的用户名，为后续的攻击做好准备。防御措施包括：统一身份验证的错误消息，避免泄露用户是否存在的信息；实施账户锁定策略，防止密码喷洒攻击；以及加强用户安全意识教育。

**项目地址:** [Noxurge/CVE-2025-65899](https://github.com/Noxurge/CVE-2025-65899)

**漏洞详情:** [CVE-2025-65899](https://nvd.nist.gov/vuln/detail/CVE-2025-65899)