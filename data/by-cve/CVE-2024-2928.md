# CVE-2024-2928

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-2928-nuridincersaygili_CVE-2024-2928.md](../2024/CVE-2024-2928-nuridincersaygili_CVE-2024-2928.md)

## CVE-2024-2928 - MLflow Local File Inclusion

**æ¼æ´ç¼–å·:** CVE-2024-2928

**æ¼æ´ç±»å‹:** Local File Inclusion

**å½±å“åº”ç”¨:** MLflow

**å±å®³ç­‰çº§:** High

**CVSSè¯„åˆ†:** N/A

**å½±å“ç‰ˆæœ¬:** < 2.11.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œç›®æ ‡ç«¯å£å¼€æ”¾

**POC å¯ç”¨æ€§:** 9/10

**POC ç±»å‹:** å®Œæ•´åˆ©ç”¨

**æ”»å‡»å¤æ‚åº¦:** ä½

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-2928æ˜¯MLflowä¸­å­˜åœ¨çš„ä¸€ä¸ªæœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚POCä»£ç åˆ©ç”¨äº†MLflowçš„apiæ¥å£ï¼Œé€šè¿‡æ„é€ æ¶æ„çš„artifact_locationå’Œsourceå‚æ•°ï¼Œå¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œä»è€Œè¯»å–ç›®æ ‡æ–‡ä»¶ã€‚å…·ä½“åˆ©ç”¨æ­¥éª¤å¦‚ä¸‹ï¼š

1.  è·å–ç›®æ ‡æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ã€‚
2.  ä½¿ç”¨POCè„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡MLflowæœåŠ¡å™¨çš„åœ°å€å’Œç«¯å£ã€‚
3.  è„šæœ¬ä¼šæç¤ºè¾“å…¥è¦è¯»å–çš„æ–‡ä»¶è·¯å¾„ï¼Œè¾“å…¥ç›®æ ‡æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ã€‚
4.  è„šæœ¬é€šè¿‡å‘é€ä¸€ç³»åˆ—POSTè¯·æ±‚åˆ°/ajax-api/2.0/mlflow/experiments/createã€/api/2.0/mlflow/runs/createã€/ajax-api/2.0/mlflow/registered-models/createå’Œ/ajax-api/2.0/mlflow/model-versions/createç«¯ç‚¹æ¥åˆ›å»ºå®éªŒå’Œè¿è¡Œã€‚
5.  æœ€åï¼Œè„šæœ¬å‘é€ä¸€ä¸ªGETè¯·æ±‚åˆ°/model-versions/get-artifactç«¯ç‚¹ï¼Œå…¶ä¸­pathå‚æ•°è®¾ç½®ä¸ºè¦è¯»å–çš„æ–‡ä»¶åï¼Œnameå’Œversionå‚æ•°è®¾ç½®ä¸ºä¹‹å‰åˆ›å»ºçš„å®éªŒçš„åç§°å’Œç‰ˆæœ¬ã€‚
6.  å¦‚æœæ–‡ä»¶å­˜åœ¨ä¸”å¯è¯»ï¼ŒæœåŠ¡å™¨å°†è¿”å›æ–‡ä»¶çš„å†…å®¹ã€‚

POCçš„æœ‰æ•ˆæ€§åˆ†æï¼š

POCä»£ç æ˜¯ä¸€ä¸ªå®Œæ•´çš„åˆ©ç”¨ç¨‹åºï¼Œå¯ä»¥è‡ªåŠ¨å®Œæˆåˆ©ç”¨è¿‡ç¨‹ã€‚è¯¥ä»£ç é¦–å…ˆæç¤ºç”¨æˆ·è¾“å…¥è¦è¯»å–çš„æ–‡ä»¶çš„è·¯å¾„ï¼Œç„¶åä½¿ç”¨MLflow APIåˆ›å»ºå®éªŒå’Œè¿è¡Œï¼Œæœ€åä½¿ç”¨/model-versions/get-artifactç«¯ç‚¹è¯»å–æ–‡ä»¶å†…å®¹ã€‚ä»£ç çš„æˆåŠŸåˆ©ç”¨è¡¨æ˜ï¼Œè¯¥æ¼æ´ç¡®å®å­˜åœ¨å¹¶ä¸”å¯ä»¥è¢«åˆ©ç”¨ã€‚è¯¥POCåœ¨MLflow 2.9.2ç‰ˆæœ¬ä¸Šæµ‹è¯•æˆåŠŸã€‚

æŠ•æ¯’é£é™©åˆ†æï¼š

è¯¥POCä»£ç ä¸»è¦é€šè¿‡æ„é€ æ¶æ„çš„HTTPè¯·æ±‚æ¥åˆ©ç”¨æ¼æ´ï¼Œä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚ä½†æ˜¯ï¼Œå¦‚æœæ”»å‡»è€…ä½¿ç”¨è¯¥æ¼æ´è¯»å–åŒ…å«æ•æ„Ÿä¿¡æ¯çš„é…ç½®æ–‡ä»¶ï¼Œä¾‹å¦‚æ•°æ®åº“å‡­æ®æˆ–APIå¯†é’¥ï¼Œåˆ™å¯èƒ½ä¼šå¯¼è‡´æ›´ä¸¥é‡çš„åæœã€‚æ­¤å¤–ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹POCä»£ç ï¼Œä½¿å…¶èƒ½å¤Ÿæ‰§è¡Œä»»æ„ä»£ç ï¼Œä»è€Œå®ç°è¿œç¨‹æ§åˆ¶æœåŠ¡å™¨çš„ç›®çš„ã€‚æ­¤POCä»£ç åŒ…å«ä»ç”¨æˆ·å¤„è·å–æ–‡ä»¶è·¯å¾„å¹¶å°†å…¶ä¼ é€’ç»™HTTPè¯·æ±‚çš„æ­¥éª¤ã€‚è™½ç„¶å®ƒæœ¬èº«ä¸åŒ…å«æ··æ·†æˆ–æ¶æ„è¡Œä¸ºï¼Œä½†å®ƒç¡®å®ä¾èµ–äºç”¨æˆ·è¾“å…¥ï¼Œè¿™å¼•å…¥äº†ä¸€å®šç¨‹åº¦çš„é£é™©ã€‚æ”»å‡»è€…å¯èƒ½ä¼šè¯±ä½¿ç”¨æˆ·è¾“å…¥æŒ‡å‘æ¶æ„æ–‡ä»¶çš„è·¯å¾„ï¼Œè¿™äº›æ–‡ä»¶åœ¨è¢«è¯»å–æ—¶å¯èƒ½ä¼šè§¦å‘å…¶ä»–æ¼æ´æˆ–æ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚æ­¤å¤–ï¼Œè¯¥è„šæœ¬ä½¿ç”¨requestsåº“å‘é€HTTPè¯·æ±‚ã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªæ ‡å‡†åº“ï¼Œä½†å¦‚æœæœåŠ¡å™¨ç«¯ç‚¹è¢«æ”»ç ´æˆ–è¢«é‡å®šå‘åˆ°æ¶æ„æœåŠ¡å™¨ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–ä¸­é—´äººæ”»å‡»ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚ä¸»è¦é£é™©åœ¨äºç”¨æˆ·è¾“å…¥çš„æ–‡ä»¶è·¯å¾„å¯èƒ½æŒ‡å‘æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…æœåŠ¡å™¨ç«¯ç‚¹å¯èƒ½è¢«æ”»ç ´ã€‚

**é¡¹ç›®åœ°å€:** https://github.com/m1nus0ne/CVE-2024-2928

**æ¼æ´è¯¦æƒ…:** N/A


---

## POC #2

**æ¥æº**: [CVE-2024-2928-rain321654_sjtu_CVE-2024-2928.md](../2024/CVE-2024-2928-rain321654_sjtu_CVE-2024-2928.md)

## CVE-2024-2928 - mlflow LFI

**æ¼æ´ç¼–å·:** CVE-2024-2928

**æ¼æ´ç±»å‹:** LFI

**å½±å“åº”ç”¨:** mlflow

**å±å®³ç­‰çº§:** é«˜

**CVSSè¯„åˆ†:** å¾…å®š

**å½±å“ç‰ˆæœ¬:** æœªçŸ¥

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** 5/10

**POC ç±»å‹:** æ¦‚å¿µéªŒè¯

**æ”»å‡»å¤æ‚åº¦:** ä¸­

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-2928 æ˜¯mlflowä¸­çš„æœ¬åœ°æ–‡ä»¶åŒ…å«ï¼ˆLFIï¼‰æ¼æ´ã€‚æ ¹æ®æœç´¢ç»“æœï¼ŒGitHub Advisory ä¸­æåˆ°äº†è¿™ä¸ªæ¼æ´ï¼Œä½†åŠ è½½å†å²è®°å½•æ—¶å‡ºç°é”™è¯¯ï¼Œæ— æ³•è·å–æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚POCä»£ç å­˜åœ¨äº`sytu_CVE-2024-2928`çš„é¡¹ç›®ä¸­ï¼Œè¡¨æ˜è¯¥æ¼æ´å­˜åœ¨å¯åˆ©ç”¨æ€§ã€‚ç”±äºç¼ºä¹è¯¦ç»†çš„æ¼æ´æè¿°å’ŒCVSSè¯„åˆ†ï¼Œæˆ‘ä»¬å‡è®¾åˆ©ç”¨æ¡ä»¶æ˜¯éœ€è¦é€šè¿‡ç½‘ç»œè®¿é—®ç›®æ ‡ç³»ç»Ÿï¼Œå¹¶å‘é€ç‰¹åˆ¶çš„è¯·æ±‚ï¼ŒåŒ…å«æ¶æ„çš„æ–‡ä»¶è·¯å¾„ï¼Œä»è€Œè¯»å–æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚åˆ©ç”¨æ­¥éª¤å¯èƒ½åŒ…æ‹¬ï¼š1. æ„é€ åŒ…å«æ¶æ„æ–‡ä»¶è·¯å¾„çš„HTTPè¯·æ±‚ã€‚2. å‘é€è¯·æ±‚åˆ°ç›®æ ‡mlflowæœåŠ¡å™¨ã€‚3. å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†è¿”å›è¢«åŒ…å«çš„æ–‡ä»¶å†…å®¹ã€‚4. åˆ†æè¿”å›çš„å†…å®¹ï¼Œæå–æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€æºä»£ç ç­‰ã€‚

æŠ•æ¯’é£é™©åˆ†æï¼šè¯¥POCçš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºPOCä»£ç æœ¬èº«æ—¨åœ¨éªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚å¦‚æœæ”»å‡»è€…ä¿®æ”¹POCä»£ç ï¼Œæ·»åŠ æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚ä¸Šä¼ åé—¨æˆ–æ‰§è¡Œä»»æ„ä»£ç ï¼Œé‚£ä¹ˆæŠ•æ¯’é£é™©å°†å¤§å¤§å¢åŠ ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯ä»¥å°†POCä¿®æ”¹ä¸ºåœ¨è¯»å–æ–‡ä»¶åï¼Œå°†æ–‡ä»¶å†…å®¹å‘é€åˆ°å¤–éƒ¨æœåŠ¡å™¨ã€‚æˆ–è€…ï¼Œæ”»å‡»è€…å¯ä»¥æ·»åŠ ä»£ç ï¼Œå°è¯•åˆ©ç”¨LFIæ¼æ´æ‰§è¡ŒRCEï¼ˆè¿œç¨‹ä»£ç æ‰§è¡Œï¼‰ã€‚è€ƒè™‘åˆ°POCçš„ç®€å•æ€§å’Œç¼ºä¹æ¶æ„è¡Œä¸ºï¼Œæˆ‘ä»¬å°†æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚æ­¤é£é™©ä¸»è¦æ¥æºäºç”¨æˆ·åœ¨ä½¿ç”¨POCæ—¶å¯èƒ½å¼•å…¥çš„æ½œåœ¨æ¶æ„ä¿®æ”¹ï¼Œæˆ–è€…æ”»å‡»è€…å‘å¸ƒäº†åŒ…å«æ¶æ„ä»£ç çš„è™šå‡POCã€‚å› æ­¤ï¼Œç”¨æˆ·åœ¨ä½¿ç”¨ä»»ä½•å…¬å¼€çš„POCä»£ç æ—¶ï¼Œéƒ½åº”è¯¥è¿›è¡Œå½»åº•çš„å®¡æŸ¥å’Œå®‰å…¨è¯„ä¼°ï¼Œç¡®ä¿ä»£ç çš„å®‰å…¨æ€§ã€‚

**é¡¹ç›®åœ°å€:** https://github.com/ç”¨æˆ·å/sytu_CVE-2024-2928

**æ¼æ´è¯¦æƒ…:** https://nvd.nist.gov/vuln/detail/CVE-2024-2928


---

