# CVE-2024-2928

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-2928-nuridincersaygili_CVE-2024-2928.md](../2024/CVE-2024-2928-nuridincersaygili_CVE-2024-2928.md)

## CVE-2024-2928 - MLflow Local File Inclusion

**æ¼æ´ç¼–å·:** CVE-2024-2928

**æ¼æ´ç±»å‹:** Local File Inclusion

**å½±å“åº”ç”¨:** MLflow

**å±å®³ç­‰çº§:** High

**CVSSè¯„åˆ†:** N/A

**å½±å“ç‰ˆæœ¬:** < 2.11.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œç›®æ ‡ç«¯å£å¼€æ”¾

**POC å¯ç”¨æ€§:** 9/10

**POC ç±»å‹:** å®Œæ•´åˆ©ç”¨

**æ”»å‡»å¤æ‚åº¦:** ä½

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-2928æ˜¯MLflowä¸­å­˜åœ¨çš„ä¸€ä¸ªæœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚POCä»£ç åˆ©ç”¨äº†MLflowçš„apiæ¥å£ï¼Œé€šè¿‡æ„é€ æ¶æ„çš„artifact_locationå’Œsourceå‚æ•°ï¼Œå¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œä»è€Œè¯»å–ç›®æ ‡æ–‡ä»¶ã€‚å…·ä½“åˆ©ç”¨æ­¥éª¤å¦‚ä¸‹ï¼š

1.  è·å–ç›®æ ‡æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ã€‚
2.  ä½¿ç”¨POCè„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡MLflowæœåŠ¡å™¨çš„åœ°å€å’Œç«¯å£ã€‚
3.  è„šæœ¬ä¼šæç¤ºè¾“å…¥è¦è¯»å–çš„æ–‡ä»¶è·¯å¾„ï¼Œè¾“å…¥ç›®æ ‡æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ã€‚
4.  è„šæœ¬é€šè¿‡å‘é€ä¸€ç³»åˆ—POSTè¯·æ±‚åˆ°/ajax-api/2.0/mlflow/experiments/createã€/api/2.0/mlflow/runs/createã€/ajax-api/2.0/mlflow/registered-models/createå’Œ/ajax-api/2.0/mlflow/model-versions/createç«¯ç‚¹æ¥åˆ›å»ºå®éªŒå’Œè¿è¡Œã€‚
5.  æœ€åï¼Œè„šæœ¬å‘é€ä¸€ä¸ªGETè¯·æ±‚åˆ°/model-versions/get-artifactç«¯ç‚¹ï¼Œå…¶ä¸­pathå‚æ•°è®¾ç½®ä¸ºè¦è¯»å–çš„æ–‡ä»¶åï¼Œnameå’Œversionå‚æ•°è®¾ç½®ä¸ºä¹‹å‰åˆ›å»ºçš„å®éªŒçš„åç§°å’Œç‰ˆæœ¬ã€‚
6.  å¦‚æœæ–‡ä»¶å­˜åœ¨ä¸”å¯è¯»ï¼ŒæœåŠ¡å™¨å°†è¿”å›æ–‡ä»¶çš„å†…å®¹ã€‚

POCçš„æœ‰æ•ˆæ€§åˆ†æï¼š

POCä»£ç æ˜¯ä¸€ä¸ªå®Œæ•´çš„åˆ©ç”¨ç¨‹åºï¼Œå¯ä»¥è‡ªåŠ¨å®Œæˆåˆ©ç”¨è¿‡ç¨‹ã€‚è¯¥ä»£ç é¦–å…ˆæç¤ºç”¨æˆ·è¾“å…¥è¦è¯»å–çš„æ–‡ä»¶çš„è·¯å¾„ï¼Œç„¶åä½¿ç”¨MLflow APIåˆ›å»ºå®éªŒå’Œè¿è¡Œï¼Œæœ€åä½¿ç”¨/model-versions/get-artifactç«¯ç‚¹è¯»å–æ–‡ä»¶å†…å®¹ã€‚ä»£ç çš„æˆåŠŸåˆ©ç”¨è¡¨æ˜ï¼Œè¯¥æ¼æ´ç¡®å®å­˜åœ¨å¹¶ä¸”å¯ä»¥è¢«åˆ©ç”¨ã€‚è¯¥POCåœ¨MLflow 2.9.2ç‰ˆæœ¬ä¸Šæµ‹è¯•æˆåŠŸã€‚

æŠ•æ¯’é£é™©åˆ†æï¼š

è¯¥POCä»£ç ä¸»è¦é€šè¿‡æ„é€ æ¶æ„çš„HTTPè¯·æ±‚æ¥åˆ©ç”¨æ¼æ´ï¼Œä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚ä½†æ˜¯ï¼Œå¦‚æœæ”»å‡»è€…ä½¿ç”¨è¯¥æ¼æ´è¯»å–åŒ…å«æ•æ„Ÿä¿¡æ¯çš„é…ç½®æ–‡ä»¶ï¼Œä¾‹å¦‚æ•°æ®åº“å‡­æ®æˆ–APIå¯†é’¥ï¼Œåˆ™å¯èƒ½ä¼šå¯¼è‡´æ›´ä¸¥é‡çš„åæœã€‚æ­¤å¤–ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹POCä»£ç ï¼Œä½¿å…¶èƒ½å¤Ÿæ‰§è¡Œä»»æ„ä»£ç ï¼Œä»è€Œå®ç°è¿œç¨‹æ§åˆ¶æœåŠ¡å™¨çš„ç›®çš„ã€‚æ­¤POCä»£ç åŒ…å«ä»ç”¨æˆ·å¤„è·å–æ–‡ä»¶è·¯å¾„å¹¶å°†å…¶ä¼ é€’ç»™HTTPè¯·æ±‚çš„æ­¥éª¤ã€‚è™½ç„¶å®ƒæœ¬èº«ä¸åŒ…å«æ··æ·†æˆ–æ¶æ„è¡Œä¸ºï¼Œä½†å®ƒç¡®å®ä¾èµ–äºç”¨æˆ·è¾“å…¥ï¼Œè¿™å¼•å…¥äº†ä¸€å®šç¨‹åº¦çš„é£é™©ã€‚æ”»å‡»è€…å¯èƒ½ä¼šè¯±ä½¿ç”¨æˆ·è¾“å…¥æŒ‡å‘æ¶æ„æ–‡ä»¶çš„è·¯å¾„ï¼Œè¿™äº›æ–‡ä»¶åœ¨è¢«è¯»å–æ—¶å¯èƒ½ä¼šè§¦å‘å…¶ä»–æ¼æ´æˆ–æ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚æ­¤å¤–ï¼Œè¯¥è„šæœ¬ä½¿ç”¨requestsåº“å‘é€HTTPè¯·æ±‚ã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªæ ‡å‡†åº“ï¼Œä½†å¦‚æœæœåŠ¡å™¨ç«¯ç‚¹è¢«æ”»ç ´æˆ–è¢«é‡å®šå‘åˆ°æ¶æ„æœåŠ¡å™¨ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–ä¸­é—´äººæ”»å‡»ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚ä¸»è¦é£é™©åœ¨äºç”¨æˆ·è¾“å…¥çš„æ–‡ä»¶è·¯å¾„å¯èƒ½æŒ‡å‘æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…æœåŠ¡å™¨ç«¯ç‚¹å¯èƒ½è¢«æ”»ç ´ã€‚

**é¡¹ç›®åœ°å€:** https://github.com/m1nus0ne/CVE-2024-2928

**æ¼æ´è¯¦æƒ…:** N/A


---

## POC #2

**æ¥æº**: [CVE-2024-2928-rain321654_sjtu_CVE-2024-2928.md](../2024/CVE-2024-2928-rain321654_sjtu_CVE-2024-2928.md)

## CVE-2024-2928 - mlflow LFI

**æ¼æ´ç¼–å·:** CVE-2024-2928

**æ¼æ´ç±»å‹:** LFI

**å½±å“åº”ç”¨:** mlflow

**å±å®³ç­‰çº§:** é«˜

**CVSSè¯„åˆ†:** å¾…å®š

**å½±å“ç‰ˆæœ¬:** æ‰€æœ‰ç‰ˆæœ¬

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** 7/10

**POC ç±»å‹:** å®Œæ•´åˆ©ç”¨

**æ”»å‡»å¤æ‚åº¦:** ä½

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

æ ¹æ®GitHub Advisoryçš„ä¿¡æ¯å’ŒPOCä»£ç ï¼ŒCVE-2024-2928æ˜¯mlflowä¸­çš„ä¸€ä¸ªæœ¬åœ°æ–‡ä»¶åŒ…å«ï¼ˆLFIï¼‰æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚POCä»£ç çš„README.mdæ–‡ä»¶è¡¨æ˜å­˜åœ¨é’ˆå¯¹æ­¤æ¼æ´çš„åˆ©ç”¨ã€‚ç»éªŒè¯ï¼Œè¯¥POCèƒ½å¤ŸæˆåŠŸè¯»å–æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ï¼Œä½†éœ€è¦é…ç½®ç›®æ ‡æœåŠ¡å™¨åœ°å€ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„HTTPè¯·æ±‚ï¼ŒæŒ‡å®šåŒ…å«æ¶æ„è·¯å¾„çš„æ–‡ä»¶åï¼Œä»è€Œè¯»å–ä»»æ„æ–‡ä»¶ã€‚ç”±äºmlflowé€šå¸¸éƒ¨ç½²åœ¨æœåŠ¡å™¨ç¯å¢ƒä¸­ï¼Œå› æ­¤æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€å¯†é’¥ç­‰ã€‚åˆ©ç”¨æ­¥éª¤å¦‚ä¸‹ï¼š1. éƒ¨ç½²å­˜åœ¨æ¼æ´çš„mlflowå®ä¾‹ã€‚2. é…ç½®POCï¼ŒæŒ‡å®šç›®æ ‡mlflowæœåŠ¡å™¨åœ°å€ã€‚3. è¿è¡ŒPOCï¼ŒæŒ‡å®šè¦è¯»å–çš„æ–‡ä»¶è·¯å¾„ã€‚4. POCå°†å‘é€åŒ…å«æ¶æ„æ–‡ä»¶è·¯å¾„çš„HTTPè¯·æ±‚ã€‚5. mlflowæœåŠ¡å™¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºLFIæ¼æ´ï¼Œä¼šè¯»å–æŒ‡å®šçš„æ–‡ä»¶å¹¶è¿”å›ç»™æ”»å‡»è€…ã€‚

æŠ•æ¯’é£é™©åˆ†æï¼šæ­¤POCçš„æŠ•æ¯’é£é™©è¾ƒä½ã€‚POCä»£ç ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´çš„åˆ©ç”¨ï¼Œä»£ç ç›¸å¯¹æ¸…æ™°ï¼Œæ²¡æœ‰å‘ç°æ¶æ„è¡Œä¸ºã€‚POCåªåŒ…å«ä»ç›®æ ‡æœåŠ¡å™¨è¯»å–æ–‡ä»¶çš„åŠŸèƒ½ï¼Œä¸åŒ…å«ä»»ä½•å†™å…¥æˆ–ä¿®æ”¹æ–‡ä»¶çš„æ“ä½œã€‚ä»£ç ä¾èµ–æ ‡å‡†åº“ï¼Œæ²¡æœ‰ä½¿ç”¨ä»»ä½•å¯ç–‘çš„å¤–éƒ¨è„šæœ¬æˆ–evalå‡½æ•°ã€‚è™½ç„¶æ”»å‡»è€…å¯ä»¥ä¿®æ”¹POCä»£ç ï¼Œæ·»åŠ æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚ä¸Šä¼ æ¶æ„æ–‡ä»¶æˆ–æ‰§è¡Œå‘½ä»¤ï¼Œä½†è¿™éœ€è¦æ”»å‡»è€…å…·å¤‡ä¸€å®šçš„ç¼–ç¨‹èƒ½åŠ›ï¼Œå¹¶ä¸”å®¹æ˜“è¢«å‘ç°ã€‚å› æ­¤ï¼ŒCVE-2024-2928çš„POCæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** https://github.com/mlflow/mlflow

**æ¼æ´è¯¦æƒ…:** https://nvd.nist.gov/vuln/detail/CVE-2024-2928


---

