## CVE-2026-21876 - OWASP ModSecurity Core Rule Set (CRS) 绕过漏洞 (Bypass)

**漏洞编号:** CVE-2026-21876

**漏洞类型:** 绕过漏洞 (Bypass)

**影响应用:** OWASP ModSecurity Core Rule Set (CRS)

**危害等级:** 高 (High)

**CVSS评分:** 尚未公布确切数值

**影响版本:** 所有支持的版本 (自该规则引入以来)

**利用条件:** 需要目标系统部署了受影响版本的 ModSecurity CRS，且攻击者能够发送特定格式的 multipart/form-data 请求。

**POC 可用性:** 8/10

**POC 类型:** 概念验证 (PoC)

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

POC有效性分析：该POC提供了一个完整的容器化环境，用于复现CVE-2026-21876。漏洞核心存在于OWASP ModSecurity CRS的规则逻辑中。通过分析提供的docker-compose.yml，可以看到它部署了一个使用10.5.0之前版本的ModSecurity-CRS镜像（镜像标签为3.3.7-nginx-202511100111）。该漏洞的触发机制涉及对multipart/form-data内容的解析不一致。在flask/app.py中，后端应用使用Python的email.parser和cgi模块解析表单数据，而ModSecurity作为WAF在前端拦截请求。漏洞的有效性在于利用WAF规则与后端解析器在处理特定字符编码、边界符（boundary）或格式畸形的multipart请求时的差异。POC展示了当攻击者精心构造请求体时，WAF可能无法正确识别恶意Payload，从而允许Payload穿透防御到达后端Flask应用。此POC结构清晰，包含前端代理和后端应用，通过gunicorn部署，是一个高度可信的漏洞复现环境。 利用步骤：1. 使用docker-compose up -d启动测试环境，该环境会在8083端口暴露受ModSecurity保护的Web服务。2. 构造一个特定的HTTP POST请求，设置Content-Type为multipart/form-data。3. 在请求体中包含混淆的边界定义或利用后端解析器特有的容错特性（如Python email库对字符集的处理）。4. 发送包含已知会被CRS拦截的特征码（如简单的XSS或SQLi脚本），如果后端Flask应用返回了‘Decoded multipart/form-data’并显示了该脚本，则证明绕过成功。 投毒风险分析：该POC项目的投毒风险极低，评分为5%。通过对代码审计发现，其核心组件为标准的Dockerfile和docker-compose配置文件。flask/app.py使用的是Python标准库（flask, cgi, email.parser），未发现任何混淆代码、外部执行命令（os.system等）或未经授权的网络连接。README文件仅包含基本的漏洞描述，没有诱导用户执行恶意二进制文件或脚本的倾向。docker-compose中引用的镜像均为OWASP官方公开镜像（owasp/modsecurity-crs），未发现镜像劫持迹象。整个PoC项目代码透明，逻辑直观，符合安全研究人员用于合规漏洞验证的行为特征。唯一的风险点在于此类漏洞工具可能被初级攻击者（脚本小子）直接用于扫描，但代码本身不包含针对研究者本机的恶意攻击载荷。

**项目地址:** [https://github.com/coreruleset/coreruleset](https://github.com/coreruleset/coreruleset) (参考来源)

**漏洞详情:** [https://coreruleset.org/blog/](https://coreruleset.org/blog/)
