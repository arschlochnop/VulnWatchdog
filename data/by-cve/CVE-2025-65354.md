## CVE-2025-65354 - Grocery Store Management System SQL注入

**漏洞编号:** CVE-2025-65354

**漏洞类型:** SQL注入

**影响应用:** Grocery Store Management System

**危害等级:** 高危 (High)

**CVSS评分:** 8.8 (估计值)

**影响版本:** 未知 (基于POC推断为包含search_products_itname.php的特定版本)

**利用条件:** 网络可达，目标系统开启搜索功能

**POC 可用性:** 4/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：提供的代码主要针对 'search_products_itname.php' 接口中的 'sitem_name' 参数进行基于布尔逻辑的SQL注入验证。代码通过构建三个不同的请求头负载：第一个使用真值表达式 '5*5=25'，第二个使用假值表达式 '5*5=26'，第三个使用逻辑与连接的恒等式。虽然脚本结构简单，但其逻辑存在明显缺陷：代码中使用 random.choice("user-agents.txt") 会导致程序仅从文件名字符串中随机挑选一个字符作为 User-Agent，而不是从文件中读取行，这会导致请求头格式错误。此外，Host 字段被错误地设置为完整的 URL 路径而非域名，这在标准 Web 服务器上会导致 400 错误。尽管如此，其注入 Payload 揭示了该 CMS 在处理 HTTP 头部自定义字段（如 sitem_name）时可能直接将其拼接至 SQL 查询语句中，这种非传统的注入向量在防御较弱的系统上确实具有一定的可行性。利用步骤：首先，攻击者需要定位受影响的 Grocery 系统路径。其次，构造 POST 请求，在 Headers 中包含 'sitem_name' 字段。通过对比不同 Payload（真/假/逻辑判断）下服务器返回的响应长度或 HTTP 状态码差异，确认是否存在盲注漏洞。若成功，可进一步利用 sqlmap 等工具或手动构造 UNION SELECT 语句来提取数据库敏感信息，如管理员凭据、客户订单数据等。投毒风险分析：该 POC 代码本身不含高度危险的混淆逻辑或明显的恶意后门植入。然而，风险点在于其引用的外部信息。代码中明确打印了一个 GitHub 地址（[https://github.com/amaansiddd787/CVE-2025-65354](https://github.com/amaansiddd787/CVE-2025-65354)），此类针对最新（2025年）CVE 编号的空壳仓库或即时创建的仓库常被用作投毒媒介。脚本中虽然目前只使用了 requests 和 random 库，但其 while True 无限循环逻辑在未加限制的情况下可能被用于对特定目标发起小规模拒绝服务（DoS）测试。此外，user-agents.txt 文件被截断，如果该文件来自不可信源，其中可能包含针对扫描器指纹识别的特殊构造字符。整体而言，代码逻辑过于粗糙，更像是为了占坑或快速传播而生成的模板化脚本。研究员在测试时应修正 User-Agent 读取逻辑和 Host 头部定义，并在隔离的沙箱环境中执行，以防其后续版本更新引入恶意模块或通过 print 语句引导用户下载带毒的完整 Exploit 工具。

**项目地址:** [https://github.com/amaansiddd787/CVE-2025-65354](https://github.com/amaansiddd787/CVE-2025-65354)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-65354](https://nvd.nist.gov/vuln/detail/CVE-2025-65354)
