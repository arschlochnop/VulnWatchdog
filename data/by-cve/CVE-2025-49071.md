## CVE-2025-49071 - WordPress Flozen Theme 任意文件上传 (RCE)

**漏洞编号:** CVE-2025-49071

**漏洞类型:** 任意文件上传 (RCE)

**影响应用:** WordPress Flozen Theme

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** < 1.5.1

**利用条件:** 无需身份验证 (Unauthenticated)，可远程访问目标WordPress站点

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC是一个基于Python 3编写的自动化漏洞利用工具，针对WordPress Flozen主题中存在的严重漏洞。经过对代码逻辑的深入分析，该POC通过利用flozen_add_new_custom_font()函数中缺失的身份验证和弱文件校验机制，实现对zip压缩包的恶意上传。POC代码包含了目标扫描、自动版本检测、多线程并发利用以及Payload上传后的自动化验证。其核心逻辑清晰：首先访问目标路径确认主题是否存在及版本是否匹配，随后构造一个包含Webshell（如index.php）的ZIP文件发送至后台。由于服务端会将ZIP自动解压至`wp-content/uploads/nasa-custom-fonts/`目录，攻击者可直接通过HTTP请求访问解压后的PHP文件，从而实现从文件上传到远程代码执行（RCE）的完整利用。该POC脚本封装了requests库进行网络交互，配合colorama进行UI展示，并集成了错误处理机制，其自动化程度极高，在真实环境中具有极强的杀伤力和极高的成功率。利用步骤：1. 准备攻击负载：创建一个名为shadow.zip的压缩包，内含名为index.php的Webshell脚本。2. 环境配置：安装Python依赖库requests和colorama。3. 准备目标列表：将目标URL写入list.txt文件。4. 执行利用脚本：运行`python3 shadow.py`。5. 参数交互：根据提示输入目标文件名及线程数（建议5-50）。6. 结果收获：脚本会自动扫描并尝试上传，利用成功后会直接输出Webshell的访问路径。投毒风险分析：经过对提供的shadow.py源代码进行详细的安全审计，目前该脚本表现为相对纯净的漏洞测试工具。其核心导入库均为Python标准库或常用的第三方合规库（如requests, colorama），未发现任何典型的恶意投毒特征，如base64混淆的二进制负载、对执行环境敏感信息的窃取（如环境变量、系统密码文件）、或向非目标服务器发送的回连请求。脚本中的SSL警告禁用操作属于安全工具的常见做法，旨在提高对自签名证书站点的兼容性。然而，存在低风险点：脚本要求用户在当前目录下放置一个shadow.zip文件，且代码中引用了该文件的解压路径。在分发过程中，如果zip文件被替换为带有本地恶意脚本的负载，或者POC脚本本身在未披露的部分（如截断处）包含动态执行恶意代码的逻辑（eval, exec），则会构成风险。总体而言，该代码逻辑透明，目前判定为低风险，但建议研究人员在沙箱环境中运行，并仔细检查自带的zip文件内容，防止由于'影子附件'导致的本地感染。此外，脚本中的Auto-Save功能会将结果保存在本地，需注意敏感数据泄露。

**项目地址:** [https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-themes/flozen-theme/flozen-151-unauthenticated-arbitrary-file-upload](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-themes/flozen-theme/flozen-151-unauthenticated-arbitrary-file-upload)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49071](https://nvd.nist.gov/vuln/detail/CVE-2025-49071)
