## CVE-2025-49071 - WordPress Flozen Theme 任意文件上传 (Unauthenticated Arbitrary File Upload)

**漏洞编号:** CVE-2025-49071

**漏洞类型:** 任意文件上传 (Unauthenticated Arbitrary File Upload)

**影响应用:** WordPress Flozen Theme

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** < 1.5.1

**利用条件:** 无需身份验证（Unauthenticated），需要远程网络访问目标WordPress站点。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞存在于WordPress的Flozen主题中，具体漏洞点位于flozen_add_new_custom_font()函数。由于该函数缺乏必要的身份验证检查（nonces或权限校验）以及对上传文件类型的严格过滤，允许任何未授权的远程攻击者上传恶意的ZIP文件。根据POC描述，攻击者可以将包含PHP木马（Webshell）的ZIP文件上传，系统会自动将其解压至wp-content/uploads/nasa-custom-fonts/目录下。此POC（shadow.py）表现出极高的有效性，它集成了版本扫描、自动化利用、Webshell验证及多线程处理功能。代码逻辑清晰，通过模拟Multipart表单上传请求即可触发漏洞。其自动化程度极高，支持批量处理目标列表（list.txt），并能实时反馈上传结果和Shell的可访问性。通过分析，该POC能够稳定地在受影响版本的主题上实现远程代码执行（RCE），是防御研究中极具参考价值的样本。利用步骤：首先，攻击者准备一个名为shadow.zip的压缩包，内含PHP Webshell（如index.php）。其次，运行提供的Python脚本，配置目标URL列表及线程数（建议5-50）。脚本会自动检测目标站点是否安装了Flozen主题及其版本号。若版本低于1.5.1，脚本将向特定的自定义字体上传接口发送POST请求，携带恶意ZIP包。上传成功后，由于主题自带的解压机制，Webshell会被放置在可预测的路径下。最后，攻击者通过访问生成的URL（如/wp-content/uploads/nasa-custom-fonts/shadow/index.php）来控制服务器。投毒风险分析：该POC虽然属于功能完整的利用工具，但在投毒风险方面处于较低区间。代码本身使用了标准的Python库（如requests, threading, colorama），未发现恶意混淆或加密的二进制载荷。脚本的逻辑是公开且易于审计的。主要的风险点在于：第一，该脚本包含自动保存结果的功能，需注意其是否会将结果外联至第三方服务器（根据描述，目前仅为本地保存）。第二，虽然POC中提到的'shadow.zip'是用户自备的，但如果POC分发包中附带了预编译的zip文件，用户应谨慎检查其中的PHP文件是否存在二次后门。第三，由于其针对的是WordPress主题，存在被攻击者集成到自动化扫描框架中进行大规模非法利用的风险。作为防御性安全人员，在使用此类POC进行内网模拟渗透测试时，应确保代码来源可靠，并在受控环境下运行，避免使用未经审计的第三方自动化利用工具直接操作生产环境。整体来看，该脚本没有明显的自我复制、数据窃取或破坏主机的恶意意图，其主要功能仅围绕漏洞验证展开，投毒风险评级为低。

**项目地址:** [https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-themes/flozen-theme/flozen-151-unauthenticated-arbitrary-file-upload](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-themes/flozen-theme/flozen-151-unauthenticated-arbitrary-file-upload)

**漏洞详情:** [https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-themes/flozen-theme/flozen-151-unauthenticated-arbitrary-file-upload](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-themes/flozen-theme/flozen-151-unauthenticated-arbitrary-file-upload)
