## CVE-2025-14174 - Google Chrome (macOS), iOS Safari (WebKit via ANGLE), Electron Out-of-bounds Write

**漏洞编号:** CVE-2025-14174

**漏洞类型:** Out-of-bounds Write

**影响应用:** Google Chrome (macOS), iOS Safari (WebKit via ANGLE), Electron

**危害等级:** High

**CVSS评分:** 8.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**影响版本:** Google Chrome on Mac prior to 143.0.7499.110, iOS prior to 26

**利用条件:** 远程攻击者诱导用户访问恶意构造的HTML页面

**POC 可用性:** 4/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：CVE-2025-14174 是一个存在于 ANGLE（Almost Native Graphics Layer Engine）Metal 后端中的越界写入漏洞。该漏洞的根源在于 ANGLE 处理深度纹理上传时的暂存缓冲区（Staging Buffer）大小计算逻辑错误。在 `TextureMtl` 类的 `setSubImageImpl` 或相关函数中，代码错误地使用 `GL_UNPACK_IMAGE_HEIGHT` 像素存储参数来计算缓冲区大小，而非使用实际的纹理高度。当攻击者故意设置 `UNPACK_IMAGE_HEIGHT` 小于实际纹理高度时，系统会分配一个过小的缓冲区，但随后的写入操作（如 `SaturateDepth`）仍会尝试写入完整的高度行，导致在 GPU 内存中发生越界写入。此 POC 提供了明确的漏洞触发逻辑，证明了通过 WebGL API 操作 Metal 后端可以导致渲染进程崩溃或任意内存写入。尽管截断的 POC 未显示完整利用链，但结合 CISA 已将其加入 KEV 目录以及 Apple 确认该漏洞曾被用于针对 iOS 用户的极其复杂的定向攻击，该漏洞的有效性极高。由于涉及 GPU 内存管理，将其转化为可靠的 RCE 需要精密的内存布局控制，因此复杂度较高，但其作为远程执行代码攻击链第一环的作用已经过验证。利用步骤：1. 启动支持 Metal 后端的浏览器环境（如 macOS 上的 Chrome 或 iOS 上的 Safari）。2. 初始化 WebGL 上下文。3. 通过 `pixelStorei` 设置 `GL_UNPACK_IMAGE_HEIGHT` 为一个较小的值。4. 调用 `texImage2D` 或 `texSubImage2D` 上传一个高度大于预设参数的深度纹理。5. ANGLE 计算分配一个不足的 Metal 暂存缓冲区。6. 驱动程序在将数据填充至该缓冲区时触发 OOB Write，导致进程内存损坏。投毒风险分析：该漏洞文档属于技术分析性质，风险评估为低（15%）。分析文档和提供的 POC 逻辑清晰，直接指向 ANGLE 源代码中的具体提交（95a32cb）和受影响类。代码逻辑符合标准的 WebGL 漏洞触发模式，未发现明显的恶意混淆、外部非法连接或隐蔽的 shellcode 注入。然而，鉴于该漏洞在野外被用于定向高级持续性威胁（APT），任何宣称能提供“一键式”完整利用程序的代码库都应受到高度警惕。防御者在测试此类 POC 时，应在隔离的沙箱环境中运行，并重点关注脚本是否试图通过 WebSocket 或 Fetch 泄露本地敏感环境信息，或在 Node.js 环境下利用 Electron 的特权执行系统命令。目前的文档更多是作为威胁情报和补丁比对参考，而非直接的攻击工具，因此投毒风险主要存在于第三方分发的、经过二次修改的自动化测试脚本中。

**项目地址:** [https://chromium.googlesource.com/angle/angle/+/95a32cb](https://chromium.googlesource.com/angle/angle/+/95a32cb)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-14174](https://nvd.nist.gov/vuln/detail/CVE-2025-14174)
