## CVE-2026-1357 - WPvivid Backup & Migration 任意文件上传, 远程代码执行 (RCE)

**漏洞编号:** CVE-2026-1357

**漏洞类型:** 任意文件上传, 远程代码执行 (RCE)

**影响应用:** WPvivid Backup & Migration

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** ≤ 0.9.123

**利用条件:** 无需认证 (Unauthenticated), 需要网络访问, wpvivid_api_token已生成且未过期

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析: 基于提供的详细`README.md`文档，该POC被认为高度有效且文档齐全。它清晰地描述了一个两阶段的漏洞利用链：首先是“加密失败开放”（Cryptographic Fail-Open）缺陷，即在RSA解密过程中未正确处理`openssl_private_decrypt()`返回的`false`值，导致`Crypt_Rijndael`组件将其视为一个可预测的16字节空密钥（\x00 × 16）与CBC模式及空IV进行操作。其次是路径遍历漏洞，即解密后的JSON payload中的`name`参数未进行充分净化，攻击者可以利用`../`序列将恶意PHP文件写入到受限备份目录之外的、可公开访问的`wp-content/uploads/`目录。`README.md`提供了明确的环境搭建步骤（包括使用Docker、下载特定版本插件和WordPress配置），以及详细的利用脚本用法示例，包括“仅检查漏洞”模式（上传无害文本文件并验证MD5）和上传Webshell执行命令的模式。这些信息表明该POC具有高度的鲁棒性和可验证性，并且清晰地指明了受影响和已打补丁的版本，以及成功利用所需的前提条件（`wpvivid_api_token`的存在）。

利用步骤:
1.  **环境识别**: 攻击者首先需要识别运行WPvivid Backup & Migration插件（版本等于或低于0.9.123）的WordPress目标站点。
2.  **前提条件验证**: 确认目标站点已在WPvivid插件设置中生成并激活了Auto-Migration Key（即`wpvivid_api_token`已存在且未过期）。此API Token是触发脆弱代码路径的关键前提。
3.  **构造恶意Payload**: 攻击者准备一个恶意的JSON结构payload。该payload的核心内容包括一个带有目录遍历序列（例如`../uploads/shell.php`）的恶意文件名，以及准备上传的PHP Webshell代码。
4.  **伪造加密Payload**: 利用插件的“加密失败开放”漏洞，攻击者可以绕过正常的RSA解密过程。即使不拥有私钥，攻击者也可以通过使用一个已知的null AES密钥和null IV来加密上述恶意JSON payload，从而伪造一个插件能够“成功”解密并处理的加密数据包。
5.  **发送利用请求**: 攻击者通过向目标WordPress站点发送一个特制的HTTP POST请求。请求的目标是调用插件的`wpvivid_action=send_to_site` hook，并将上一步伪造的加密payload作为请求参数发送。
6.  **触发文件上传与RCE**: 插件接收到攻击者的请求后，会尝试处理伪造的加密数据。由于成功的“解密”和路径遍历漏洞，插件会将攻击者提供的PHP Webshell文件写入到可公开访问的`wp-content/uploads/`目录中。
7.  **执行任意命令**: 一旦Webshell成功上传，攻击者即可通过Web浏览器直接访问该Webshell，进而执行任意系统命令，完全控制受感染的WordPress服务器，实现远程代码执行（RCE）。

投毒风险分析:
该POC的公开披露，使得具有中等技术水平的攻击者能够轻松地复现和利用该漏洞。由于POC代码的描述清晰、有详细的使用说明和环境搭建指南，被恶意攻击者用于大规模扫描和利用的风险较高。
从POC代码的描述来看，它是一个标准、直接的Python利用脚本，用于上传文件和执行命令。`README.md`中详细描述了`exploit.py`的功能，包括验证模式（上传无害文本文件并验证MD5）和利用模式（上传webshell并执行指定命令）。这种清晰透明的设计是评估投毒风险的关键因素。
我们没有发现任何提及或暗示恶意代码混淆、捆绑外部可疑二进制文件、或未经授权的网络通信行为（例如未经用户同意的回连C2服务器、下载额外恶意负载、或进行端口扫描等）。POC的`Usage`部分明确列出了命令行参数，旨在演示漏洞的利用过程，而非作为恶意软件传播。其提供的功能（上传`.txt`文件验证、上传webshell并执行`id`或`whoami`等标准系统命令）是典型漏洞验证和利用的步骤，符合安全研究的最佳实践。
POC的依赖项（`requirements.txt`）通常会列出Python标准库或常用第三方库，这些库本身通常是安全的。在没有实际查看`exploit.py`源代码的情况下，我们基于`README.md`的描述和其所展现的专业性来判断，预计代码会使用如`requests`、`json`、`base64`等常见库，而不是引入复杂的、难以审计的或来自不明来源的依赖。
因此，直接从这个特定的POC代码库获取并运行其提供的`exploit.py`，其投毒风险评估为**低** (10%)。这主要是基于其清晰的代码逻辑描述和标准库的使用（根据推断），没有检测到任何明显的恶意行为指标。
然而，需要强调的是，尽管POC本身投毒风险低，但其披露的高危漏洞（RCE）的利用价值极高。这种漏洞一旦被利用成功，攻击者将完全控制目标系统。这可能导致第三方在此POC基础上进行修改，加入代码混淆、捆绑恶意软件、利用僵尸网络进行大规模攻击、或实现持久化后门、C2通信等恶意功能，从而衍生出具有高投毒风险的恶意利用工具。组织在处理此类公开POC时，应始终对其来源进行严格审查（例如检查GitHub仓库的信誉、作者历史提交、代码审计等），并在隔离环境中进行测试，以防范未来可能出现的恶意变种。此外，应警惕任何要求提升权限、下载额外文件的提示，或在执行过程中出现异常网络行为的情况。

**项目地址:** https://github.com/sec-js/PoC-in-GitHub/

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-1357
