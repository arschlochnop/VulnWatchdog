## CVE-2024-30167 - Atlona AT-OME-RX21 AV Switcher 命令注入

**漏洞编号:** CVE-2024-30167

**漏洞类型:** 命令注入

**影响应用:** Atlona AT-OME-RX21 AV Switcher

**危害等级:** 高危

**CVSS评分:** 8.8 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Firmware versions <= 1.5.1

**利用条件:** 需要有效的用户凭证（认证后）、网络可达、支持Go语言环境编译或直接运行二进制文件

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC针对Atlona AT-OME-RX21 AV切换器的操作系统命令注入漏洞进行了完整实现。漏洞源于时间配置接口（time configuration interface）在处理用户输入时未进行充分的过滤和转义。通过分析PoC代码和ReadMe文档，攻击者通过提供有效的凭据（默认通常为admin/Atlona）进行身份验证后，利用该接口注入精心构造的OS命令。由于目标系统以root权限执行该接口相关的底层逻辑，注入的命令将直接获得最高系统权限。PoC采用Go语言编写，集成了自动化交互逻辑，包括参数解析（目标URL、认证信息、反弹Shell或结果回传地址）、身份验证会话维持、Payload发送以及响应监听。其代码结构清晰，通过HTTP POST或类似请求将payload植入时间配置参数中。由于AV设备（如切换器、分配器）在企业内网中常被视为‘可信但疏于管理’的资产，此类漏洞具有极高的实战利用价值，能让攻击者在获得初步内网据点后，迅速控制多媒体基础架构。其有效性得到了代码展示的响应结果（uid=0(root)）的直接支撑，是一个成熟且功能完备的利用工具。【利用步骤】1. 使用Go语言环境将源代码编译为可执行文件；2. 准备监听端（可使用PoC自带的监听功能或nc）；3. 执行命令指定目标URL（-t）、用户名（-u）、密码（-p）、本地监听IP（-l）及端口（-P），以及待执行的指令（-c 'whoami'）；4. PoC将自动完成登录、注入并回传执行结果。【投毒风险分析】从目前披露的代码片段看，该PoC的主要投毒风险集中在编译后的二进制分发环节。源码层面使用的是标准的Go网络库（net/http）和命令行参数解析库，逻辑直观，未发现混淆代码或可疑的隐蔽网络连接。然而，由于该项目鼓励用户自行编译（go build），在一些非官方渠道分发的预编译版本（如cve-2024-30167.exe）中，攻击者极易在编译阶段植入恶意后门（如Cobalt Strike木马或持久化脚本）。分析指出，虽然PoC宣称是出于教育目的，但其直接提供了一键式提权功能，且依赖外部输入的IP进行回传，这在复杂的红蓝对抗环境中可能被用于反向捕获安全研究人员的IP地址或进行反向攻击。总体而言，源码本身毒性极低，但作为高价值AV设备漏洞的利用代码，其在非官方下载源中的二次打包投毒风险处于低至中等水平（约15%），建议研究人员仅从可信源码构建并在受控沙箱内测试。

**项目地址:** [https://github.com/RIZZZIOM/CVE-2024-30167](https://www.google.com/search?q=https://github.com/RIZZZIOM/CVE-2024-30167)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-30167](https://www.google.com/search?q=https://nvd.nist.gov/vuln/detail/CVE-2024-30167)
