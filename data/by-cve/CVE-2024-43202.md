## CVE-2024-43202 - Apache DolphinScheduler 远程代码执行 (RCE)

**漏洞编号:** CVE-2024-43202

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache DolphinScheduler

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** 未知 (依据POC推断涉及Task API组件)

**利用条件:** 需要对DolphinScheduler任务插件的API接口有访问权限，且能够触发特定Task任务的参数解析流程。

**POC 可用性:** 7/10

**POC 类型:** 概念验证 (静态扫描规则)

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

【POC有效性分析】该POC并非直接的漏洞利用脚本，而是一套基于YASA静态代码审计引擎的检测环境。其Dockerfile构建了一个包含YASA扫描器和Go/Python语言分析组件的Debian环境。核心验证逻辑位于run.sh脚本中，该脚本专门针对dolphinscheduler-task-plugin/dolphinscheduler-task-api路径下的源码进行扫描。它引用的规则文件rule_config_java_cve43202.json表明此漏洞存在于Java层的Taint Flow（污点传播）。有效性体现在其通过静态分析手段定位DolphinScheduler在处理任务参数时的不安全反序列化或命令执行路径。从防御角度看，这是一套高质量的内部审计工具，能够辅助安全研究员验证代码基准中是否存在受损的逻辑分支，但在没有漏洞具体触发Payload的情况下，它不能直接在运行时验证漏洞。利用步骤：1. 构建Docker镜像；2. 将受影响的DolphinScheduler源码挂载或拷贝至容器；3. 运行容器并指定输入输出JSON，脚本将调用yasa-engine对task-api源码进行污点分析。 【投毒风险分析】该POC的投毒风险极低。首先，其构建过程使用的是官方debian:12-slim基础镜像，安装的python3、bash、ca-certificates均为标准系统库，未引入可疑的第三方源。其次，run.sh脚本逻辑清晰，其核心操作是读取本地JSON文件、检查目录结构并执行本地的yasa-engine可执行文件，没有发现任何尝试建立反向Shell、下载外部恶意脚本（curl/wget至非预期域名）或修改主机敏感文件的行为。虽然其中包含三个二进制文件（yasa-engine-linux-x64, uast4go, uast4py），但在受控的Docker隔离环境中使用，其行为主要局限于CPU计算和本地文件读取。所有Python代码均为Inline脚本，用于处理JSON数据和环境变量，无混淆或编码行为。唯一需要注意的是，用户在运行此类容器时，应避免赋予--privileged权限或挂载根目录，以防止潜在的逃逸风险。整体评估代码透明，符合防御性安全研究工具的特征，属于低风险范畴。

**项目地址:** 本地分析路径: /tmp/vulnwatchdog_7908e24ebcc3bbfada0037bb852cc310/yasa-docker

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-43202](https://nvd.nist.gov/vuln/detail/CVE-2024-43202)
