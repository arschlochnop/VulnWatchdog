# CVE-2012-2122

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2012-2122-Avinza_CVE-2012-2122-scanner.md](../2012/CVE-2012-2122-Avinza_CVE-2012-2122-scanner.md)

## CVE-2012-2122-MySQL/MariaDB身份验证绕过

**漏洞编号:** CVE-2012-2122

**漏洞类型:** 身份验证绕过

**影响应用:** MySQL/MariaDB

**危害等级:** 高危，可能导致未经授权的数据库访问

**影响版本:** MySQL 5.1.x (< 5.1.63), 5.5.x (< 5.5.24), 5.6.x (< 5.6.6), MariaDB 5.1.x (< 5.1.62), 5.2.x (< 5.2.12), 5.3.x (< 5.3.6), 5.5.x (< 5.5.23)

**利用条件:** 需要目标MySQL/MariaDB服务器存在漏洞，并且攻击者能够建立网络连接到数据库端口 (通常是3306)。漏洞的触发还依赖于特定的memcmp实现。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2012-2122 漏洞存在于 MySQL 和 MariaDB 的 `sql/password.c` 文件中。当服务器运行在某些环境中，使用了存在缺陷的 `memcmp` 函数实现时，远程攻击者可以通过重复使用相同的错误密码进行身份验证来绕过身份验证。由于 `memcmp` 函数的返回值未被正确检查，导致token比较最终会成功。提供的 `scan.php` 脚本尝试利用此漏洞。它首先扫描指定 CIDR 块内的 IP 地址，尝试连接到 3306 端口。对于接受连接的主机，脚本会重复尝试使用错误的 'root' 密码登录，利用漏洞绕过身份验证，如果成功绕过验证，则dump `mysql.user`表中的用户和密码哈希值。代码风险较低，主要为扫描和漏洞利用，但如果扫描行为被滥用，可能导致拒绝服务或触发安全警报。该脚本缺少错误处理和输入验证，存在一定风险。

漏洞利用方式总结：

1.  **网络扫描：**  脚本扫描指定IP地址段，寻找开放3306端口的MySQL/MariaDB服务器。
2.  **身份验证绕过尝试：**  对每个目标服务器，脚本尝试使用错误的密码（'root' + 随机字符串）重复登录，利用`memcmp`缺陷。
3.  **数据提取：**  如果身份验证绕过成功，脚本执行SQL查询 `SELECT user,password from mysql.user`，尝试提取用户凭据。

**项目地址:** [Avinza/CVE-2012-2122-scanner](https://github.com/Avinza/CVE-2012-2122-scanner)

**漏洞详情:** [CVE-2012-2122](https://nvd.nist.gov/vuln/detail/CVE-2012-2122)

---

## POC #2

**来源**: [CVE-2012-2122-cyberharsh_Oracle-mysql-CVE-2012-2122.md](../2012/CVE-2012-2122-cyberharsh_Oracle-mysql-CVE-2012-2122.md)

## CVE-2012-2122-MySQL/MariaDB身份认证绕过漏洞

**漏洞编号:** CVE-2012-2122

**漏洞类型:** 身份认证绕过

**影响应用:** MySQL/MariaDB

**危害等级:** 高危，可能导致未经授权的数据库访问和数据泄露

**影响版本:** MySQL 5.1.x before 5.1.63, 5.5.x before 5.5.24, and 5.6.x before 5.6.6, MariaDB 5.1.x before 5.1.62, 5.2.x before 5.2.12, 5.3.x before 5.3.6, and 5.5.x before 5.5.23

**利用条件:** 需要目标服务器存在受影响版本的MySQL/MariaDB，并且服务器运行环境的memcmp实现可能存在问题。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2012-2122 漏洞存在于 MySQL/MariaDB 的 `sql/password.c` 文件中。当服务器运行在特定的环境，并且使用了特定的 `memcmp` 函数实现时，攻击者可以通过重复使用错误的密码进行身份验证，最终绕过身份验证。这是因为代码中对 `memcmp` 的返回值处理不当，即使 `memcmp` 返回非零值，也可能被错误地认为密码匹配。

**有效性评估：**

提供的 Dockerfile 和 docker-compose.yml 文件用于快速搭建包含受影响版本的 MySQL 服务器的环境。README.md 提供了漏洞验证步骤，通过循环执行 `mysql -uroot -pwrong -h your-ip -P3306` 命令，不断尝试使用错误的密码连接数据库，最终可以成功登录。因此，提供的POC代码是有效的，可以用于复现和验证该漏洞。

**投毒风险评估：**

查看Dockerfile, docker-compose.yml, 和 README.md文件。这些文件没有发现任何潜在的恶意代码。Dockerfile 基于 `vulhub/mysql:5.5.23` 镜像，该镜像本身可能存在风险，但是本次只评估当前仓库中的文件。综上，认为当前仓库不存在投毒风险。

**利用方式：**

1.  **环境搭建：** 使用提供的 Dockerfile 和 docker-compose.yml 文件搭建包含受影响版本的 MySQL/MariaDB 服务器的环境。
2.  **身份验证绕过：** 针对目标 MySQL/MariaDB 服务器，使用错误的密码重复进行身份验证。
3.  **重复尝试：** 由于漏洞的特殊性，需要多次尝试才能成功绕过身份验证。
4.  **成功登录：** 在经过一定次数的尝试后，攻击者可以使用错误的密码成功登录数据库。

**项目地址:** [cyberharsh/Oracle-mysql-CVE-2012-2122](https://github.com/cyberharsh/Oracle-mysql-CVE-2012-2122)

**漏洞详情:** [CVE-2012-2122](https://nvd.nist.gov/vuln/detail/CVE-2012-2122)

---

## POC #3

**来源**: [CVE-2012-2122-netw0rk7_CVE-2012-2122-Home-Lab.md](../2012/CVE-2012-2122-netw0rk7_CVE-2012-2122-Home-Lab.md)

## CVE-2012-2122 MySQL Authentication Bypass

**漏洞编号:** CVE-2012-2122

**漏洞类型:** 身份验证绕过

**影响应用:** MySQL/MariaDB

**危害等级:** 高危，可能导致未经授权的数据库访问

**影响版本:** MySQL 5.1.x before 5.1.63, 5.5.x before 5.5.24, and 5.6.x before 5.6.6, and MariaDB 5.1.x before 5.1.62, 5.2.x before 5.2.12, 5.3.x before 5.3.6, and 5.5.x before 5.5.23

**利用条件:** 需要在特定环境下运行，且memcmp函数存在特定的实现缺陷。需要能够连接到MySQL服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2012-2122 漏洞存在于 MySQL 和 MariaDB 的 sql/password.c 文件中。由于 `memcmp` 函数的实现问题，当重复使用错误的密码进行身份验证时，可能会因为对 `memcmp` 返回值的不正确检查而导致身份验证绕过。提供的 Dockerfile 和 docker-compose.yml 文件可以快速搭建一个存在漏洞的 MySQL 5.5.23 环境进行测试。利用方式是重复使用错误密码尝试登录，直到成功绕过身份验证。

**分析:**

*   **有效性：** POC 代码有效。该 POC 提供了一个可重现漏洞的环境。通过提供的链接 (exploit-db.com/exploits/19092) 可以找到利用该漏洞的脚本或方法。
*   **投毒风险：** 在提供的 Dockerfile、docker-compose.yml 和 entrypoint.sh 文件中，没有发现明显的恶意代码或后门。`entrypoint.sh` 脚本的作用是生成一个 flag 文件，这主要用于测试和演示，而非恶意行为。 因此，投毒风险评估为 0%。
*   **利用方式：** 利用该漏洞的典型方法是重复使用错误的密码尝试连接 MySQL 服务器。由于 `memcmp` 函数的错误处理，经过多次尝试后，身份验证可能会意外成功。成功登录后，攻击者就可以执行任意 SQL 命令，例如读取 flag 文件或者进行其他恶意操作。

**项目地址:** [netw0rk7/CVE-2012-2122-Home-Lab](https://github.com/netw0rk7/CVE-2012-2122-Home-Lab)

**漏洞详情:** [CVE-2012-2122](https://nvd.nist.gov/vuln/detail/CVE-2012-2122)

---

## POC #4

**来源**: [CVE-2012-2122-zhangkaibin0921_CVE-2012-2122.md](../2012/CVE-2012-2122-zhangkaibin0921_CVE-2012-2122.md)

## CVE-2012-2122-MySQL/MariaDB身份验证绕过

**漏洞编号:** CVE-2012-2122

**漏洞类型:** 身份验证绕过

**影响应用:** MySQL/MariaDB

**危害等级:** 高危，可能导致未授权访问数据库

**影响版本:** MySQL 5.1.x before 5.1.63, 5.5.x before 5.5.24, and 5.6.x before 5.6.6; MariaDB 5.1.x before 5.1.62, 5.2.x before 5.2.12, 5.3.x before 5.3.6, and 5.5.x before 5.5.23

**利用条件:** 目标MySQL/MariaDB服务器运行在受影响的版本，并且使用了存在缺陷的memcmp实现

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞源于MySQL/MariaDB在`sql/password.c`中对密码比较的实现。在某些环境下，当`memcmp`函数的实现存在缺陷时，攻击者可以通过重复使用错误的密码进行身份验证，最终导致token比较成功，从而绕过身份验证。

**有效性分析：**
提供的Go代码旨在利用CVE-2012-2122漏洞。它通过循环尝试使用错误的密码（"root:wrong"）连接到目标MySQL服务器。如果漏洞存在且条件满足，多次尝试后应能成功登录。

**投毒风险分析：**
分析提供的Go代码，没有发现明显的恶意代码。代码的功能是尝试利用已知的漏洞，而不是植入后门或其他恶意行为。因此，投毒风险评估为0%。

**利用方式：**
1.  攻击者确定目标MySQL/MariaDB服务器的版本在受影响范围内。
2.  攻击者针对目标服务器，使用错误的密码进行大量的身份验证尝试。
3.  如果服务器环境满足漏洞触发的条件（即`memcmp`函数的实现存在缺陷），经过多次尝试后，身份验证可能会意外成功。
4.  攻击者成功绕过身份验证，获得对数据库的未授权访问。

**搜索引擎结果：**
 由于未提供搜索引擎的结果，本分析主要依据漏洞库信息和提供的利用代码。

**项目地址:** [zhangkaibin0921/CVE-2012-2122](https://github.com/zhangkaibin0921/CVE-2012-2122)

**漏洞详情:** [CVE-2012-2122](https://nvd.nist.gov/vuln/detail/CVE-2012-2122)

---

