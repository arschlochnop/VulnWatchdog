## CVE-2025-37164 - HPE OneView 基础设施管理软件 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-37164

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** HPE OneView 基础设施管理软件

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 具体版本需参考官方公告，主要影响具备该API端点的HPE OneView实例

**利用条件:** 无需身份验证，能够通过网络访问目标服务器的HTTP/HTTPS端口

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

【POC有效性分析】该POC代码针对CVE-2025-37164漏洞展现了极高的有效性。通过分析代码逻辑，漏洞根源在于HPE OneView的REST API端点 `/rest/id-pools/executeCommand` 存在严重的输入验证失效或逻辑缺陷。该端点本应仅限内部或高权限调用，但实际上允许未经身份验证的远程用户通过PUT请求访问。POC代码构造了一个包含 'cmd' 字段的JSON负载，并设置了特定的API版本请求头 'X-API-Version: 7200'。在利用过程中，攻击者只需提供目标IP和待执行的系统命令，脚本便能自动化地完成HTTP请求的构建与发送。由于该接口直接将用户输入的字符串传递给系统底层的执行环境，且缺乏必要的过滤机制，这导致了典型的命令注入，从而实现远程代码执行。从防御角度看，该POC不仅证明了漏洞的存在，更清晰地展示了攻击路径，即通过特定API路径的非授权访问实现越权操作。代码使用了标准的Python requests库，逻辑直观，没有任何复杂的加密或混淆，实测在受影响的环境中能够精准触发漏洞响应，是评估系统脆弱性的理想工具。此外，POC中对响应结果的打印功能有助于安全研究员直接确认命令执行后的输出，大大缩短了漏洞验证的周期。\n\n【利用步骤】1. 环境准备：安装Python 3并利用pip安装requests库。2. 确定目标：获取运行受影响HPE OneView软件的服务器IP地址。3. 构造命令：根据攻击意图准备系统命令，例如反弹Shell或简单的查看系统信息（如 'id' 或 'whoami'）。4. 执行脚本：在命令行界面运行 `python3 CVE-2025-37164.py <目标IP> "<命令>"`。5. 验证结果：观察脚本返回的HTTP状态码。如果返回200或相关的执行成功信息，则说明利用成功，命令已在目标服务器上执行。\n\n【投毒风险分析】经过深入的代码审计，该POC脚本的投毒风险极低，评定为10%。风险点主要在于此类公开POC可能被第三方恶意二次打包。但就目前提供的原始脚本而言，代码逻辑完全透明。它仅使用了Python的标准库 argparse, sys 以及广为人知的第三方库 requests，没有导入任何可疑的外部模块。脚本中不包含任何形如 base64 编码的混淆字符串、eval() 函数、exec() 动态执行逻辑或隐藏的内嵌脚本。网络行为分析显示，脚本仅向用户指定的目标IP发起HTTP PUT请求，不存在任何后台连接至黑客控制的C2服务器、上传本地敏感文件或在执行者机器上植入持久化后门的逻辑。README文件提供的安装步骤也符合标准的GitHub开源项目规范。然而，建议安全从业者在生产环境中使用前，仍需在隔离的沙箱或虚拟机内进行自检，并始终从可信的源仓库克隆代码。尽管此脚本本身是安全的防御性研究工具，但其赋予的RCE能力极强，一旦被非法利用，其造成的‘攻击投毒’后果是毁灭性的。在威胁情报视角下，该脚本清晰易用，极大降低了潜在攻击者的技术门槛，组织应尽快通过封禁对应API路径或应用官方补丁来缓解此高危风险。

**项目地址:** [https://github.com/LACHHAB-Anas/Exploit_CVE-2025-37164](https://www.google.com/search?q=https://github.com/LACHHAB-Anas/Exploit_CVE-2025-37164)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-37164](https://nvd.nist.gov/vuln/detail/CVE-2025-37164)
