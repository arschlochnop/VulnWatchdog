# CVE-2019-1663

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-1663-StealYourCode_CVE-2019-1663.md](../2019/CVE-2019-1663-StealYourCode_CVE-2019-1663.md)

## CVE-2019-1663 - Cisco RV110W/RV130W/RV215W 远程命令执行漏洞

**漏洞编号:** CVE-2019-1663

**漏洞类型:** 远程命令执行

**影响应用:** Cisco RV110W, RV130W, RV215W 路由器

**危害等级:** 高危，未经身份验证的远程攻击者可以以高权限用户身份在受影响设备的底层操作系统上执行任意代码。

**影响版本:** RV110W Wireless-N VPN Firewall 版本低于 1.2.2.1
RV130W Wireless-N Multifunction VPN Router 版本低于 1.0.3.45
RV215W Wireless-N VPN Router 版本低于 1.3.1.1

**利用条件:** 目标设备开启web管理界面，且版本在受影响范围内。攻击者需要能够通过网络访问目标设备的web管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞CVE-2019-1663存在于Cisco RV110W, RV130W, 和RV215W 路由器的web管理界面。由于web管理界面对用户提供的数据验证不足，未经身份验证的远程攻击者可以通过向目标设备发送恶意的HTTP请求来利用此漏洞，最终以高权限用户身份在底层操作系统上执行任意代码。

**有效性分析：**
根据漏洞库信息，该漏洞允许远程命令执行，风险评级为严重。漏洞利用代码片段`FUN_0002bf64` 展示了httpd进程中的用户验证逻辑，该函数接收用户名、密码等参数，用于验证用户身份。虽然提供的代码片段本身不包含直接的漏洞利用代码，但结合漏洞描述，可以推断漏洞可能存在于该函数对用户输入数据的处理过程中，例如对用户名或密码的长度没有进行充分的校验，或者使用了存在漏洞的函数进行处理。
查看搜索引擎结果指向了Rapid7 Metasploit 模块以及Packet Storm上的利用代码，表明已经存在公开可用的漏洞利用。
因此，漏洞利用是有效的。

**投毒风险分析：**
提供的代码片段是经过反编译的代码，难以直接判断是否存在恶意代码。 但是仔细阅读这段代码，并没有发现明显的后门或者恶意行为。`FUN_0002bf64` 函数主要负责用户身份验证，虽然可能存在漏洞，但函数本身的目标是验证用户而非执行恶意操作。由于缺乏更多上下文，也无法确认提供的代码片段是否完整，以及是否来自可信的来源。综合来看，**投毒风险较低，评估为0%**

**利用方式：**
1.  **确定目标：** 确定目标Cisco RV110W/RV130W/RV215W路由器的型号和固件版本，确认其是否在受影响的范围内。
2.  **发送恶意HTTP请求：** 根据已公开的漏洞利用信息，构造包含恶意payload的HTTP请求，该payload可能包含要执行的命令。
3.  **远程代码执行：** 将构造好的HTTP请求发送到目标路由器的web管理界面。如果漏洞存在，且利用成功，恶意payload将被执行，导致远程代码执行。
4.  **获取控制权：** 攻击者通过执行任意代码，获取对路由器的控制权，例如修改配置、监听流量等。

总之，CVE-2019-1663是一个严重的安全漏洞，攻击者可以利用它来完全控制受影响的Cisco路由器。建议用户尽快升级到安全版本。

**项目地址:** [StealYourCode/CVE-2019-1663](https://github.com/StealYourCode/CVE-2019-1663)

**漏洞详情:** [CVE-2019-1663](https://nvd.nist.gov/vuln/detail/CVE-2019-1663)

---

## POC #2

**来源**: [CVE-2019-1663-WolffCorentin_CVE-2019-1663-Binary-Analysis.md](../2019/CVE-2019-1663-WolffCorentin_CVE-2019-1663-Binary-Analysis.md)

## CVE-2019-1663 - Cisco RV110W/RV130W/RV215W 路由器管理接口远程命令执行漏洞

**漏洞编号:** CVE-2019-1663

**漏洞类型:** 缓冲区溢出导致的远程命令执行

**影响应用:** Cisco RV110W, RV130W, RV215W

**危害等级:** 高危，允许未授权的远程攻击者以高权限执行任意代码

**影响版本:** RV110W < 1.2.2.1, RV130W < 1.0.3.45, RV215W < 1.3.1.1

**利用条件:** 目标设备开放Web管理界面，攻击者能够访问该界面（可能需要位于同一局域网或Web管理界面暴露在公网）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-1663 漏洞存在于Cisco RV110W, RV130W 和 RV215W系列路由器的Web管理界面中。由于Web管理界面对用户提供的数据验证不当，导致存在缓冲区溢出漏洞。未经身份验证的远程攻击者可以通过发送恶意的HTTP请求到目标设备，利用该漏洞在底层操作系统上以高权限用户身份执行任意代码。

**有效性：**
根据提供的漏洞信息和利用代码，可以判断该漏洞是有效的。漏洞库信息中已经明确指出该漏洞的存在，并给出了受影响的设备和版本。利用代码 `exploit.py` 尝试利用缓冲区溢出漏洞，通过覆盖返回地址执行任意代码。代码中通过`strcpy`函数的栈溢出覆盖返回地址，结合libc的gadget实现利用。

**投毒风险：**
提供的代码片段主要功能是创建payload，用于利用缓冲区溢出漏洞。代码本身没有明显的后门或者恶意行为，例如反弹shell、植入持久化后门等。但是，攻击者可以修改`cmd`变量来执行任意命令，如果攻击者控制了该仓库，有可能修改`cmd`或其他部分的代码，植入恶意代码。因此，存在一定的投毒风险，但从现有信息看，风险较低（10%）。`README.md` 内容分析描述的是漏洞原理和利用步骤，查找gadget的方法，没有发现任何恶意代码。

**利用方式：**
1.  **确定目标：** 找到运行受影响版本Cisco RV110W, RV130W 或 RV215W 路由器的设备。
2.  **访问Web管理界面：** 确保可以访问目标路由器的Web管理界面，通常通过HTTP或HTTPS协议。
3.  **构造恶意请求：** 使用 `exploit.py` 中的代码，构造包含恶意payload的HTTP请求。Payload 包括溢出用户名或密码字段，覆盖返回地址到libc中预先找到的gadget地址，最终调用`system`函数来执行指令。
4.  **发送请求：** 将构造的HTTP请求发送到目标路由器的Web管理界面。
5.  **执行任意代码：** 如果利用成功，路由器将执行Payload中的任意代码，例如，添加一个具有管理权限的用户，或者执行其他恶意操作。

**项目地址:** [WolffCorentin/CVE-2019-1663-Binary-Analysis](https://github.com/WolffCorentin/CVE-2019-1663-Binary-Analysis)

**漏洞详情:** [CVE-2019-1663](https://nvd.nist.gov/vuln/detail/CVE-2019-1663)

---

