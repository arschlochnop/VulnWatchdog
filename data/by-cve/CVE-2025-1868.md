## CVE-2025-1868 - Advanced IP Scanner, Advanced Port Scanner 信息泄露 (Information Exposure)

**漏洞编号:** CVE-2025-1868

**漏洞类型:** 信息泄露 (Information Exposure)

**影响应用:** Advanced IP Scanner, Advanced Port Scanner

**危害等级:** 中危 (Medium)

**CVSS评分:** 5.3 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N)

**影响版本:** 未知 (当前公开信息显示为截止到2025年3月仍未修复的多个版本)

**利用条件:** 攻击者需要能够诱导受影响软件（如Advanced IP Scanner）扫描由攻击者控制的伪造服务器或中间人截获流量。

**POC 可用性:** 9/10

**POC 类型:** 概念验证 (PoC)

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：该POC是一个基于Docker容器化的PHP应用程序，专门用于检测CVE-2025-1868。其核心逻辑在于模拟一个支持NTLM身份验证的HTTP服务器。当Advanced IP Scanner或Advanced Port Scanner扫描到该服务器并尝试建立连接时，应用程序会发送401 Unauthorized响应并包含'WWW-Authenticate: NTLM'头。由于该漏洞的存在，受影响的扫描工具会自动、静默地发送当前运行扫描程序的用户NTLM Hash（通过Type 3消息）。POC中的index.php脚本能够解析NTLM消息包，提取出攻击者最关心的域名（Domain）、用户名（User）和工作站（Workstation）信息，并将其记录在本地日志文件scan.log中。该POC代码逻辑清晰，依赖项极简（仅需PHP环境或Docker），通过Dockerfile和docker-compose简化了部署流程，在本地实验室环境下复现漏洞的成功率极高，是一个非常有效的漏洞检测工具。利用步骤：1. 在攻击者控制的主机上部署该POC容器，确保监听80端口。2. 启动Advanced IP Scanner或Advanced Port Scanner，并输入该主机的IP地址进行扫描。3. 扫描器在尝试识别端口或获取HTTP服务信息时，会触发NTLM认证过程。4. 攻击者查看容器内的/data/scan.log文件，即可看到扫描端泄露的用户身份信息。投毒风险分析：该POC代码具有极高的透明度，完全由开源的PHP代码、Dockerfile和基础脚本组成，没有发现任何代码混淆、二进制组件注入或外部恶意域名连接。分析结果显示，其run.sh脚本仅执行环境检查和Docker Compose启动命令，不具备持久化后门植入行为。其核心index.php专注于NTLM协议的解析，不包含恶意执行流。该项目的目的在于防御性安全研究和漏洞验证。唯一的潜在风险在于，如果用户在公网未加防护地运行此容器，可能会收集到非预期的第三方扫描指纹。但从代码本身来看，该POC不具备针对使用者的恶意攻击逻辑，属于低风险、高质量的研究代码。使用者应确保在受控的实验环境中使用，并遵守当地法律法规。

**项目地址:** [https://labs.itresit.es/2026/01/03/cve-2025-1868-unpatched-advanced-ip-scanner-silently-exposes-ntlm-during-scans/](https://labs.itresit.es/2026/01/03/cve-2025-1868-unpatched-advanced-ip-scanner-silently-exposes-ntlm-during-scans/)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-1868](https://nvd.nist.gov/vuln/detail/CVE-2025-1868)
