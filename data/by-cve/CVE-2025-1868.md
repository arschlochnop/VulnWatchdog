## CVE-2025-1868 - Advanced IP Scanner / Advanced Port Scanner 信息泄露 (Information Disclosure)

**漏洞编号:** CVE-2025-1868

**漏洞类型:** 信息泄露 (Information Disclosure)

**影响应用:** Advanced IP Scanner / Advanced Port Scanner

**危害等级:** 中危

**CVSS评分:** 5.3 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N)

**影响版本:** 所有未打补丁版本 (具体版本需参考官方公告)

**利用条件:** 受害者需使用受影响的扫描工具对包含恶意PHP服务的IP/主机进行扫描

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：该POC是一个基于PHP构建的Docker化环境，旨在验证CVE-2025-1868漏洞。该漏洞存在于常用的网络扫描工具Advanced IP Scanner和Advanced Port Scanner中。当这些工具在扫描过程中遇到开启了HTTP服务的资产时，会通过HTTP协议自动尝试进行身份验证，从而导致NTLM哈希或相关凭据信息泄露。POC代码通过配置Apache和PHP环境，能够捕获传入请求中的NTLM Type 3消息。该消息包含用户的域名、用户名和工作站名称。代码结构非常清晰，包含Dockerfile、docker-compose.yml以及用于逻辑处理的src/index.php。经分析，该POC能够稳定触发NTLM握手过程，并准确提取客户端声明的身份信息，是评估网络内部凭据暴露风险的高质量工具。利用步骤：1. 在测试服务器上部署该Docker容器，并确保宿主机的80端口映射到容器的80端口；2. 启动服务后，使用受影响的Advanced IP Scanner对该服务器IP进行扫描；3. 扫描过程中，软件会自动访问目标80端口，此时POC后端会截获HTTP Authorization头；4. 管理员通过查看data/scan.log文件即可看到捕获到的Windows域名、用户名和工作站信息。投毒风险分析：该POC项目代码库透明度极高，所有操作均在开源的PHP脚本中完成，不涉及二进制执行文件或加密的脚本片段。项目主要功能是提取NTLM消息中的明文元数据（域名、用户名），而非暴力破解或回传密码。Dockerfile基于官方PHP 8.2镜像，没有引入非官方的第三方仓库或可疑的安装指令。其run.sh脚本仅用于环境检查和容器启动，不包含恶意下载器或静默安装后门的行为。唯一需要注意的风险点是，如果用户在公网环境运行此测试工具且不加访问控制，可能会无意中收集到非测试目标的真实凭据，但在安全性研究和企业防御自查场景下，该POC被判定为安全的防御性研究工具，投毒风险极低（约10%）。建议研究人员在隔离的实验环境或合规的内网渗透测试中使用。

**项目地址:** [https://labs.itresit.es/2026/01/03/cve-2025-1868-unpatched-advanced-ip-scanner-silently-exposes-ntlm-during-scans/](https://labs.itresit.es/2026/01/03/cve-2025-1868-unpatched-advanced-ip-scanner-silently-exposes-ntlm-during-scans/)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-1868](https://nvd.nist.gov/vuln/detail/CVE-2025-1868)
