## CVE-2026-1560 - Custom Block Builder – Lazy Blocks WordPress plugin Authenticated Remote Code Execution (RCE)

**漏洞编号:** CVE-2026-1560

**漏洞类型:** Authenticated Remote Code Execution (RCE)

**影响应用:** Custom Block Builder – Lazy Blocks WordPress plugin

**危害等级:** High

**CVSS评分:** 8.8

**影响版本:** ≤ 4.2.0

**利用条件:** 需要认证 (Contributor+ 角色), 需要网络访问 (REST API)

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

POC有效性分析：
该POC清晰地展示了Custom Block Builder – Lazy Blocks WordPress插件（版本≤4.2.0）中存在一个高危认证远程代码执行（RCE）漏洞。该漏洞允许具有低权限（如投稿者Contributor角色，具备`edit_posts`能力）的认证用户通过其REST API端点`/wp-json/lazy-blocks/v1/block-builder-preview/`注入并执行任意PHP代码。漏洞的根本原因在于插件未能正确区分受信任的存储块定义和用户通过API发送的用于预览目的的块定义。`classes/class-blocks.php`中的`php_eval()`函数直接对用户提供的`code_editor_html`属性值进行`eval()`操作，且没有任何清理或验证措施。此外，该REST路由的`permission_callback`设置过于宽松，使得像投稿者这类不应具备服务器端代码执行权限的用户也能访问此功能。这严重破坏了WordPress的特权模型。POC中包含的HTTP请求明确构造了一个恶意负载，将`code_output_method`设置为`"php"`并将`code_editor_html`设置为`<?php echo 'VULNERABLE: ' . system('id'); ?>`。通过发送此请求，攻击者可以观察到`system('id')`命令的输出，从而验证了远程代码执行的成功。这表明攻击者能够完全控制服务器的执行流程，获取系统信息或执行任意操作，对系统造成严重影响。

利用步骤：
利用此漏洞的步骤如下：
1.  **获取凭证**：攻击者需要获取一个WordPress用户的凭证，该用户至少拥有投稿者（Contributor）角色或具备`edit_posts`能力。
2.  **构造HTTP请求**：使用HTTP POST方法向目标WordPress网站的`/wp-json/lazy-blocks/v1/block-builder-preview/`路径发送请求。
3.  **设置请求头**：请求头必须包含`Content-Type: application/json`和`Authorization: Basic [Contributor_Credentials]`，其中`[Contributor_Credentials]`是Base64编码的用户名和密码。
4.  **构建JSON负载**：请求体应为一个JSON对象，其中包含一个`context`字段设置为`"editor"`，以及一个`block`对象。在`block`对象内部，`slug`可以设置为任意值（例如`"exploit-block"`），`code_output_method`设置为`"php"`，而`code_editor_html`字段则包含要执行的任意PHP代码，例如`"<?php echo 'VULNERABLE: ' . system('id'); ?>"`。
5.  **发送请求**：发送构造好的HTTP请求。
6.  **验证结果**：服务器的响应将包含PHP代码的执行结果，在POC示例中，这将是`id`命令的输出，确认了代码的成功执行。

投毒风险分析：
本POC代码段本身是一个HTTP请求示例，旨在演示漏洞的利用方式。其内容清晰、直接，没有进行任何混淆处理，也不包含任何指向外部恶意资源的链接或脚本。POC中使用的有效负载`<?php echo 'VULNERABLE: ' . system('id'); ?>`是一个典型的漏洞验证负载，用于确认系统命令执行能力。因此，就此POC代码本身而言，其“投毒风险”极低，估测为10%。它不包含隐藏的恶意软件、后门代码或其他旨在秘密损害研究者或分析系统的内容。需要强调的是，尽管POC本身无害，但它所演示的漏洞（认证RCE）却具有极高的危害性。实际攻击者一旦成功利用此漏洞，完全可以注入复杂的Webshell、永久性后门、勒索软件或其他恶意负载，从而导致服务器的完全控制。因此，组织应将重点放在及时修补Custom Block Builder – Lazy Blocks插件到安全版本，并对WordPress环境中REST API端点`/wp-json/lazy-blocks/v1/block-builder-preview/`的异常访问和POST请求进行严格监控，以防范潜在的恶意利用。鉴于该漏洞的攻击复杂度为中等，且需要认证，防御措施应包括最小权限原则、强密码策略以及及时的安全更新。

**项目地址:** None

**漏洞详情:** https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/lazy-blocks/custom-block-builder-lazy-blocks-420-authenticated-contributor-remote-code-execution
