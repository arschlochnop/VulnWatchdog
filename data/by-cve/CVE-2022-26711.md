## CVE-2022-26711 - Apple ImageIO Framework 整数溢出导致的代码执行 (RCE)

**漏洞编号:** CVE-2022-26711

**漏洞类型:** 整数溢出导致的代码执行 (RCE)

**影响应用:** Apple ImageIO Framework

**危害等级:** Critical

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** macOS Monterey < 12.4, iOS/iPadOS < 15.5, tvOS < 15.5, watchOS < 8.6, iTunes for Windows < 12.12.4

**利用条件:** 远程攻击者需通过网络发送或引导用户打开恶意构造的 WebP 图像文件。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

【POC有效性分析】该POC项目提供了针对CVE-2022-26711漏洞的详细复现流程，包含自动化构建脚本（build_harness_standalone.sh）、基于Objective-C编写的测试用例加载器（harness_standalone.m）以及触发漏洞的样本文件（intoverflow.webp）。CVE-2022-26711本质是Apple ImageIO框架在处理WebP格式图像时，对行字节数（row bytes）的计算缺乏充分的边界检查，导致整数溢出。当攻击者构造一个特定高度和宽度的WebP文件时，计算得出的缓冲区大小将远小于实际解压所需的数据量，从而引发堆缓冲区溢出。从POC代码分析看，它通过加载恶意图像并调用核心绘图接口（如CGImageForProposedRect），能够稳定触发EXC_BAD_ACCESS崩溃，崩溃堆栈明确指向libsystem_platform.dylib的内存拷贝函数，证实了内存越界访问的存在。该POC不仅具有高度的学术研究价值，且由于ImageIO被Safari、Mail和Messages等核心应用广泛调用，其利用路径极短，属于高危漏洞复现集。利用步骤如下：1. 使用提供的bash脚本编译harness程序，链接ImageIO和CoreGraphics框架；2. 运行harness并加载特制的intoverflow.webp文件；3. 系统底层在进行图像解码和渲染时发生内存溢出，导致程序崩溃或重定向执行流。 【投毒风险分析】经过对该POC项目源代码的深度安全审计，未发现典型的恶意投毒特征。构建脚本（.sh）内容透明，仅调用标准clang编译器进行本地构建，不包含curl/wget下载外部混淆脚本或修改系统环境变量的操作。harness_standalone.m源码主要依赖于Apple的官方SDK库（Foundation, AppKit等），逻辑清晰，主要功能是演示漏洞触发点，不存在隐藏的网络回连（Reverse Shell）代码或敏感信息窃取逻辑。项目中提供的README详细列出了参考资料，包括NVD、ZDI及Apple官方公告，符合安全社区的信息共享规范。尽管投毒风险极低（约10%），但安全研究员在分析此类涉及内存破坏的POC时，仍应注意恶意构造的二进制WebP文件本身是否可能在不受控的环境下引发非预期的代码执行。建议在物理隔离的macOS虚拟机环境中运行该POC，并监控编译产物的静态指纹，防止二进制样本被篡改后带入生产网络。

**项目地址:** [https://0day.gg/blog/cve-2022-26711-imageio-integer-overflow/](https://0day.gg/blog/cve-2022-26711-imageio-integer-overflow/)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2022-26711](https://nvd.nist.gov/vuln/detail/CVE-2022-26711)
