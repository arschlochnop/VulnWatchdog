# CVE-2025-66478

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-66478-Malayke_Next.js-RSC-RCE-Scanner-CVE-2025-66478.md](../2025/CVE-2025-66478-Malayke_Next.js-RSC-RCE-Scanner-CVE-2025-66478.md)

## CVE-2025-66478 - Next.js RCE

**漏洞编号:** CVE-2025-66478

**漏洞类型:** RCE

**影响应用:** Next.js

**危害等级:** Critical

**CVSS评分:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

**影响版本:** AppRouter + RSC (具体版本未知，需检测)

**利用条件:** 无需认证，一次特制请求

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-66478是一个存在于Next.js应用程序中的远程代码执行（RCE）漏洞，特别是在使用AppRouter和RSC配置时。根据搜索结果，该漏洞的CVSS评分为10.0，属于最高危级别，攻击者仅需发送一个特制的请求就可以在服务器上执行任意代码。POC代码（nextjs-scanner）提供了一个命令行工具，用于批量检测Next.js应用程序的版本，并判断其是否受到CVE-2025-66478漏洞的影响。该工具通过自动化浏览器访问目标网站（使用go-rod），并执行`window.next.version`来检测Next.js版本。该工具并未尝试利用漏洞本身，只是检测是否存在漏洞。

**POC有效性分析：**
该POC工具（nextjs-scanner）的有效性在于它可以快速批量检测目标系统是否存在受影响的Next.js版本。它通过模拟浏览器行为，获取页面的Next.js版本信息，并根据版本信息判断是否存在漏洞。使用 go-rod 库，可以模拟 Chrome/Chromium 浏览器，从而更真实地模拟用户环境。POC提供了详细的使用说明，包括如何构建程序、准备URL列表以及运行扫描。扫描结果清晰地展示了目标URL的状态、Next.js版本以及是否存在漏洞。

**利用步骤：**
1.  使用go build命令编译nextjs-scanner程序。
2.  创建urls.txt文件，并在其中添加要扫描的目标URL。
3.  运行nextjs-scanner程序，指定urls.txt文件作为输入。可以使用不同的参数来调整扫描的并发数和超时时间。
4.  分析输出结果，如果目标URL被标记为Vulnerable ⚠️，则表示该站点受到CVE-2025-66478漏洞的影响。

**投毒风险分析：**
该POC代码的投毒风险较低。代码使用标准的Go语言库，没有发现任何可疑的外部依赖或恶意行为。代码的主要功能是检测Next.js版本，没有尝试执行任何潜在的危险操作。唯一的风险点在于，攻击者可能会修改该代码，添加恶意功能，例如收集目标系统的信息或执行恶意代码。但原始代码本身是相对安全的，投毒风险较低，估计为10%。代码逻辑清晰，主要使用go-rod库进行页面访问和信息提取，没有使用eval等高危函数，降低了投毒风险。由于程序只进行检测，不进行利用，因此也降低了被用于恶意目的的风险。

根据以上分析，该POC工具的质量较高，可以有效地检测Next.js应用程序是否存在CVE-2025-66478漏洞，并且投毒风险较低。

**项目地址:** https://github.com/lincemorado97/CVE-2025-64446_CVE-2025-58034

**漏洞详情:** https://nextjs.org/blog/CVE-2025-66478


---

## POC #2

**来源**: [CVE-2025-66478-mattcbarrett_check-cve-2025-66478.md](../2025/CVE-2025-66478-mattcbarrett_check-cve-2025-66478.md)

## CVE-2025-66478 - Next.js RCE

**漏洞编号:** CVE-2025-66478

**漏洞类型:** RCE

**影响应用:** Next.js

**危害等级:** 高危

**CVSS评分:** 10.0

**影响版本:** 受影响版本范围未知，项目使用AppRouter+RSC时极有可能默认处于风险之下

**利用条件:** 无需任何权限，只需要一次特制请求

**POC 可用性:** 7/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-66478 是 Next.js 框架中的一个高危远程代码执行 (RCE) 漏洞。根据搜索结果，该漏洞的 CVSS 评分为 10.0，属于最高级别。这意味着攻击者几乎无需任何权限，只需发送一次特制的 HTTP 请求，即可在服务器上执行任意代码。该漏洞主要影响使用 AppRouter 和 RSC（React Server Components）的 Next.js 项目。

POC 代码分析:
POC 代码是一个 bash 脚本，用于检测 Next.js 服务器是否存在 CVE-2025-66478 漏洞。该脚本通过发送包含特定 Header 的 POST 请求到目标 URL，并检查响应内容是否包含特定的字符串 "E{\"digest\"". 如果响应包含该字符串，则认为目标服务器存在漏洞。该脚本使用了 curl 命令来发送 HTTP 请求，并使用 grep 命令来检查响应内容。脚本的逻辑较为简单，易于理解和使用。请求中的关键Header包括 "Next-Action: x", "X-Nextjs-Request-Id: b5dce965", "Next-Router-State-Tree", "Content-Type: multipart/form-data", "X-Nextjs-Html-Request-Id"，以及构造的form-data内容。这些header和数据是触发漏洞的关键。

利用步骤:
1.  运行 check_cve-2025-66478.sh 脚本，并提供目标 Next.js 服务器的 URL 作为参数。
2.  脚本将发送包含特定 Header 的 POST 请求到目标 URL。
3.  脚本检查响应内容是否包含特定的字符串 "E{\"digest\"".
4.  如果响应包含该字符串，则表明目标服务器存在漏洞。
5.  如果目标服务器存在漏洞，攻击者可以利用该漏洞在服务器上执行任意代码。

根据POC验证结果，漏洞利用的关键在于构造特定的HTTP请求头和请求体，如果目标服务器返回包含 "E{\"digest\" 的响应，则表示可能存在RCE漏洞。

投毒风险分析(400-600字):
该POC脚本的投毒风险较低。脚本主要使用了 curl 和 grep 等标准 Linux 命令，没有执行任何可能导致恶意行为的操作。脚本没有包含任何混淆代码或外部脚本，代码可读性高，易于审计。此外，该脚本的目的是检测漏洞，而不是利用漏洞，因此不存在直接的攻击行为。

然而，仍然存在一些潜在的投毒风险：
1.  攻击者可能会修改该脚本，添加恶意代码，例如，在检测到漏洞后，自动执行恶意命令。但因为脚本内容简单，这种修改容易被发现。
2.  攻击者可能会将该脚本与其他恶意脚本捆绑在一起，从而提高攻击的成功率。但本脚本本身的功能单一，捆绑其他恶意脚本会增加复杂度和被检测的风险。
3.  攻击者可能会利用该脚本来扫描大量 Next.js 服务器，从而找到存在漏洞的目标。这是一个信息收集的风险。

总体而言，该POC脚本的投毒风险较低，但仍然需要保持警惕，并采取必要的安全措施，例如，对脚本进行代码审计，确保其不包含恶意代码，以及限制脚本的执行权限。

**项目地址:** https://github.com/lincemorado97/CVE-2025-64446_CVE-2025-58034

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-66478


---

## POC #3

**来源**: [CVE-2025-66478-wangxso_CVE-2025-66478-POC.md](../2025/CVE-2025-66478-wangxso_CVE-2025-66478-POC.md)

## CVE-2025-66478 - Next.js 远程代码执行

**漏洞编号:** CVE-2025-66478

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Next.js

**危害等级:** 高危，CVSS 评分 10.0，允许未经身份验证的攻击者执行任意代码

**影响版本:** Next.js 15.x, 16.x, 14.3.0-canary.77 及更高版本的 canary 版本 (使用 App Router)

**利用条件:** 目标应用程序使用 Next.js 15.x、16.x 或 14.3.0-canary.77 及更高版本，并且使用 App Router，攻击者可以向目标服务器发送 HTTP 请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息，CVE-2025-66478 是 CVE-2025-55182 的副本。搜索引擎结果显示该漏洞与 Next.js App Router + RSC 相关，可能导致远程代码执行（RCE）。提供的漏洞利用代码 (POC) 确认了这是一个 Next.js 应用程序的严重 RCE 漏洞，源于 React Server Components (RSC) 协议中的不安全反序列化问题，利用了上游 React 实现中的不安全反序列化逻辑（CVE-2025-55182）。攻击者可以通过发送特制的 HTTP 请求，包含恶意构造的 RSC payload，在目标服务器上执行任意代码。

**利用方式：**
1.  构造恶意的 RSC payload，利用反序列化漏洞。
2.  将恶意 payload 发送到目标服务器上的 RSC 端点。
3.  服务器处理恶意 payload，由于不安全的反序列化，导致攻击者控制的代码在服务器端执行。

**投毒风险分析：**
POC 代码中包含生成恶意 payload、发送攻击请求和扫描 RSC 端点的功能，主要用于漏洞验证和利用。`test-vulnerability.js` 用于检测应用程序是否受影响。虽然这些工具本身是用于安全研究和漏洞评估，但存在被恶意修改或滥用的风险。例如，payload 生成部分如果被篡改，可能植入后门代码，导致利用过程中给攻击者以外的人员也留下后门。但从目前的信息来看，投毒的可能性较低，因为主要的风险在于反序列化漏洞本身。不过需要注意的是，任何公开的 POC 都存在被二次修改的风险，因此评估投毒风险时应进行更深入的代码审计。目前判断投毒风险为10%，主要是考虑到二次分发的风险，以及payload构造函数可能隐藏的风险。

**项目地址:** [wangxso/CVE-2025-66478-POC](https://github.com/wangxso/CVE-2025-66478-POC)

**漏洞详情:** [CVE-2025-66478](https://nvd.nist.gov/vuln/detail/CVE-2025-66478)

---

