## CVE-2025-66478 - Next.js 远程代码执行

**漏洞编号:** CVE-2025-66478

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Next.js

**危害等级:** 高危，CVSS 评分 10.0，允许未经身份验证的攻击者执行任意代码

**影响版本:** Next.js 15.x, 16.x, 14.3.0-canary.77 及更高版本的 canary 版本 (使用 App Router)

**利用条件:** 目标应用程序使用 Next.js 15.x、16.x 或 14.3.0-canary.77 及更高版本，并且使用 App Router，攻击者可以向目标服务器发送 HTTP 请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息，CVE-2025-66478 是 CVE-2025-55182 的副本。搜索引擎结果显示该漏洞与 Next.js App Router + RSC 相关，可能导致远程代码执行（RCE）。提供的漏洞利用代码 (POC) 确认了这是一个 Next.js 应用程序的严重 RCE 漏洞，源于 React Server Components (RSC) 协议中的不安全反序列化问题，利用了上游 React 实现中的不安全反序列化逻辑（CVE-2025-55182）。攻击者可以通过发送特制的 HTTP 请求，包含恶意构造的 RSC payload，在目标服务器上执行任意代码。

**利用方式：**
1.  构造恶意的 RSC payload，利用反序列化漏洞。
2.  将恶意 payload 发送到目标服务器上的 RSC 端点。
3.  服务器处理恶意 payload，由于不安全的反序列化，导致攻击者控制的代码在服务器端执行。

**投毒风险分析：**
POC 代码中包含生成恶意 payload、发送攻击请求和扫描 RSC 端点的功能，主要用于漏洞验证和利用。`test-vulnerability.js` 用于检测应用程序是否受影响。虽然这些工具本身是用于安全研究和漏洞评估，但存在被恶意修改或滥用的风险。例如，payload 生成部分如果被篡改，可能植入后门代码，导致利用过程中给攻击者以外的人员也留下后门。但从目前的信息来看，投毒的可能性较低，因为主要的风险在于反序列化漏洞本身。不过需要注意的是，任何公开的 POC 都存在被二次修改的风险，因此评估投毒风险时应进行更深入的代码审计。目前判断投毒风险为10%，主要是考虑到二次分发的风险，以及payload构造函数可能隐藏的风险。

**项目地址:** [wangxso/CVE-2025-66478-POC](https://github.com/wangxso/CVE-2025-66478-POC)

**漏洞详情:** [CVE-2025-66478](https://nvd.nist.gov/vuln/detail/CVE-2025-66478)