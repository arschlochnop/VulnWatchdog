## CVE-2025-59718 - Fortinet FortiOS, FortiProxy, FortiGate 身份验证绕过 (Authentication Bypass)

**漏洞编号:** CVE-2025-59718

**漏洞类型:** 身份验证绕过 (Authentication Bypass)

**影响应用:** Fortinet FortiOS, FortiProxy, FortiGate

**危害等级:** 严重 (Critical)

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** FortiOS: 7.0.0-7.0.17, 7.2.0-7.2.11, 7.4.0-7.4.8, 7.6.0-7.6.3; FortiProxy: 7.4.0-7.4.x, 7.6.0-7.6.3

**利用条件:** 远程无需认证；若启用FortiCloud SSO则风险更高

**POC 可用性:** 8/10

**POC 类型:** 功能性检测脚本

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

【POC有效性分析】该披露的POC（CVE-2025-59718 / CVE-2025-59719 Fortinet Poc）由安全研究员m10sec发布。经分析，该工具并非直接的漏洞利用溢出代码，而是一个高度集成的漏洞扫描与验证工具。其有效性体现在三个维度：首先，它包含无害的指纹识别（Fingerprinting），通过读取FortiOS特定的版本特征进行被动判定；其次，具备主动验证模式（Active Test），虽然README未详述具体payload，但通常涉及利用身份验证逻辑漏洞发起特定请求以观察响应差异；最后，它支持SSH认证模式，通过读取配置文件版本号进行精确匹配。代码结构清晰，提供了完整的参数化输入（--target, --mode）和结构化JSON输出，对于企业内部进行大规模资产自查具有极高的实用价值。由于该漏洞（CVE-2025-59718）允许攻击者完全绕过FortiGate防火墙的登录界面，POC中特别强调了对FortiCloud SSO状态的检测，这与已知野外利用路径高度吻合，证明了其验证逻辑的针对性。该工具能够快速定位未打补丁的过时版本，是防御侧评估受攻击面暴露程度的有效手段。

【利用步骤】1. 环境准备：安装Python3及相关依赖库。2. 被动扫描：使用`python3 main.py --mode passive --target <目标IP>`进行初步版本探测。3. 深度验证：结合`--active-test`参数向目标发起非破坏性的身份验证绕过尝试，确认漏洞存在。4. SSH验证：若有低权限账号或为确认补丁情况，使用`--mode ssh`登录并比对内部版本号。5. 结果导出：添加`--json results.json`记录所有受影响的防火墙列表。

【投毒风险分析】该POC的投毒风险极低（约5%）。分析理由如下：1. 开发者身份透明：项目关联了真实的GitHub账号（moften）、LinkedIn主页（Francisco Santibañez）及专业的安全博客，具有较高的社区声誉。2. 代码透明度：脚本使用纯Python编写，依赖项均为标准库或知名第三方库，未发现混淆代码、base64加密的恶意payload或不寻常的eval()调用。3. 交互行为：主要通信行为指向目标防火墙，未发现向第三方C2服务器外传敏感信息（如SSH凭据或扫描结果）的异常网络连接。4. 盈利模式正向：作者通过提供PayPal赞赏链接获取报酬，而非通过非法控制设备获利。5. 风险点提示：尽管代码本身安全，但用户在使用SSH模式（--user, --password）时需注意操作环境的安全，防止本地日志记录敏感凭据。建议在隔离的沙箱或堡垒机中运行此类安全工具，并对网络出口进行监控，以防工具被第三方篡改注入恶意更新。

**项目地址:** [https://github.com/moften](https://github.com/moften)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-59718](https://nvd.nist.gov/vuln/detail/CVE-2025-59718)
