## CVE-2025-38352 - Linux Kernel 释放后使用 (Use-After-Free)

**漏洞编号:** CVE-2025-38352

**漏洞类型:** 释放后使用 (Use-After-Free)

**影响应用:** Linux Kernel

**危害等级:** 高危 (High)

**CVSS评分:** CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H

**影响版本:** LTS 6.12.33 之前的版本（特别是 6.x 系列，且配置了特定内核选项）

**利用条件:** 需要本地用户权限；内核需关闭 CONFIG_POSIX_CPU_TIMERS_TASK_WORK 且开启 CONFIG_PREEMPT=y；需要通过大量系统调用（如 getpid）触发竞态条件。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 高

**投毒风险:** 5%

## 详情

【POC有效性分析】：此POC针对Linux内核中POSIX CPU计时器实现的竞态条件漏洞提供了极高水平的验证。根据提供的数据，该POC包含完整的Makefile、README以及KASAN日志。其有效性体现在以下几个维度：首先，作者明确指出了触发漏洞所需的内核配置（CONFIG_POSIX_CPU_TIMERS_TASK_WORK 需关闭），这对于复现至关重要。其次，POC的设计考虑了系统无关性，通过动态适应 getpid 系统调用的执行时间来提高竞态成功的概率，实验数据表明在100次尝试内（通常少于60次）即可触发 UAF。KASAN日志清晰地显示了在 posix_timer_queue_signal 函数中发生的 slab-use-after-free 错误。此外，POC还附带了一个 profiler 补丁，用于协助分析竞态窗口，这标志着该POC并非简单的黑盒工具，而是深入理解内核机制的产物。在 LTS 6.12.33 版本的环境中，该代码能稳定触发内核崩溃，甚至可能进一步转化为本地提权（LPE）。【利用步骤】：1. 准备测试环境，确保内核版本为 6.12.33 且内核配置符合前提条件。2. 使用提供的 Makefile 执行 make 命令编译源码生成二进制文件 poc。3. 在受影响的系统中以普通用户身份执行 ./poc。4. 观察系统日志（dmesg），若竞态成功，系统将输出 KASAN 错误报告或发生系统挂起。5. 若未成功，POC 会自动重试直至达到触发上限。【投毒风险分析】：经过对提供的代码结构和描述信息的初步审查，该 POC 的投毒风险极低（5%）。代码仓库结构清晰，包含标准化的构建脚本（Makefile）和详细的 Markdown 文档。README 中引用的外部链接均指向知名的安全研究博客（faith2dxy.xyz），具备良好的学术声誉。代码逻辑专注于利用 getpid 消耗 CPU 时间以触发 Linux 内核中的特定路径竞态，未见任何混淆处理（Obfuscation）、网络反弹 Shell 尝试、敏感信息读取或恶意二进制分发行为。虽然该漏洞属于可导致系统沦陷的高危漏洞，但 PoC 本身是为了防御性研究和漏洞验证而设计的。唯一的潜在风险在于其利用的敏感性，若被未授权者获取可能用于实际攻击，但从代码本身的行为来看，不存在针对安全研究人员工作环境的恶意后门或数据窃取逻辑。防御者在分析此类 PoC 时，应重点关注 Makefile 是否有异常的预处理脚本，以及编译后的产物是否包含非预期网络请求，目前该项目表现为纯粹的技术验证工具。

**项目地址:** [https://github.com/faith2dxy/cve_2025_38352_poc](https://www.google.com/search?q=https://github.com/faith2dxy/cve_2025_38352_poc)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-38352](https://nvd.nist.gov/vuln/detail/CVE-2025-38352)
