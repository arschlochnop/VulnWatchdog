## CVE-2023-49785 - NextChat (ChatGPT-Next-Web) SSRF

**漏洞编号:** CVE-2023-49785

**漏洞类型:** SSRF

**影响应用:** NextChat (ChatGPT-Next-Web)

**危害等级:** 高危

**CVSS评分:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N

**影响版本:** < 2.11.2

**利用条件:** 无需认证，可通过互联网直接访问目标服务端口。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：根据公开披露的搜索结果和POC结构，该漏洞存在于NextChat（原ChatGPT-Next-Web）项目的API路由中，具体代码定位在app/api/cors/[...path]/route.ts。该路由的设计初衷是为跨域请求提供代理，但由于缺乏对目标URL的严格校验和白名单限制，导致了服务端请求伪造（SSRF）漏洞。攻击者可以构造形如/api/cors/http://internal-service/metadata的恶意请求，迫使服务器向其内网环境或其他敏感目标发起请求。经分析，该POC能够直接利用NextJS的路由特性实现未授权的内网资源读取。在云原生环境下，该漏洞极具威胁，可被用于获取元数据服务（如AWS/GCP Metadata）中的敏感凭据，或者扫描内网端口，危害等级极高。利用步骤：1. 确认目标实例运行的是受影响的NextChat版本；2. 构造恶意URL，利用路由前缀/api/cors/后接目标内部或外部地址；3. 使用curl或浏览器发送HTTP请求，观察返回结果是否包含目标服务器的响应内容；4. 若返回了内网敏感接口数据或特定服务的Header，则漏洞利用成功。投毒风险分析：该POC项目目前表现为标准的防御性安全研究代码，包含README说明和清晰的漏洞触发逻辑。代码分析显示其主要使用Next.js标准库进行HTTP请求构建，未发现明显的恶意混淆代码、外部Shell反弹脚本或不明域名的静默请求。投毒风险主要集中在后续可能的供应链污染，例如攻击者可能克隆此类POC仓库并植入带有恶意后门的脚本，或在README中诱导用户运行未经审计的自动化利用工具。目前的POC代码逻辑透明，仅用于验证SSRF的存在性，属于低风险范畴。但在实际部署防御措施时，仍需警惕那些通过eval执行字符串或引入第三方未知二进制文件的所谓『一键漏洞扫描工具』，以防在研究过程中遭受二次攻击。

**项目地址:** [https://github.com/ChatGPTNextWeb/ChatGPT-Next-Web](https://github.com/ChatGPTNextWeb/ChatGPT-Next-Web)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2023-49785](https://nvd.nist.gov/vuln/detail/CVE-2023-49785)
