## CVE-2022-49186 - Linux Kernel 权限提升

**漏洞编号:** CVE-2022-49186

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危

**CVSS评分:** 7.8 (High)

**影响版本:** 5.17.0 - 5.17.1

**利用条件:** 本地用户

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10

## 详情

CVE-2022-49186 是 Linux 内核中 Visconti 时钟驱动程序中的一个漏洞，攻击者可以利用该漏洞实现本地权限提升。该漏洞是由于有符号到无符号转换导致的数组溢出造成的。成功利用此漏洞可以使本地用户获得 root 权限。

POC有效性分析：提供的 POC 代码包含一个完整的漏洞利用程序，以及易受攻击的内核模块。自述文件提供了构建和运行漏洞利用程序的清晰说明。漏洞利用代码利用 Visconti 时钟驱动程序中的数组溢出漏洞，从而导致权限提升。该漏洞位于`visconti_clk.c`文件中，该文件包含一个易受攻击的内核模块。利用程序`exploit.c` 使用户可以将权限提升到 root。

利用步骤：
1. 构建易受攻击的模块：进入 `vulnerable-module` 目录并运行 `make` 命令。
2. 构建 exploit：进入 `exploit` 目录并运行 `gcc -o exploit exploit.c -static` 命令。
3. 加载模块：使用 `sudo insmod visconti_clk.ko` 加载编译好的内核模块。
4. 运行 exploit：运行编译好的 exploit 二进制文件。成功执行后，当前用户将获得 root 权限。
5. 卸载模块：使用 `sudo rmmod visconti_clk` 卸载模块

投毒风险分析：此 POC 的投毒风险较低。代码结构清晰，使用的都是标准库，漏洞利用代码直接与内核交互，没有发现恶意行为或外部脚本的迹象。该漏洞利用程序旨在利用特定的内核漏洞，不会对系统造成任何持久性损害。但是，如果未经授权使用该漏洞利用程序，可能会导致系统不稳定或崩溃。尽管存在这些风险，但总体而言，此 POC 的投毒风险较低，因为它不包含任何明显的恶意代码或行为。

**项目地址:** https://github.com/MaherAzzouzi/CVE-2022-37706-LPE-exploit

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2022-49186
