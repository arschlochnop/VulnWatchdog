## CVE-2025-3464 - ASUS AsIO3.sys 驱动程序 (AsusCertService) 特权提升 (Local Privilege Escalation)

**漏洞编号:** CVE-2025-3464

**漏洞类型:** 特权提升 (Local Privilege Escalation)

**影响应用:** ASUS AsIO3.sys 驱动程序 (AsusCertService)

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 具体版本需根据ASUS官方公告，涉及集成AsIO3.sys驱动的ASUS软件套件

**利用条件:** 本地普通用户权限，系统安装有受影响的ASUS驱动服务

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

POC有效性分析：该POC代码针对ASUS AsIO3.sys驱动程序中的安全缺陷，结合了CVE-2025-3464（授权绕过）与内核递减原语（Decrement Primitive）实现完整的特权提升。代码逻辑非常清晰且专业，它利用了硬链接TOCTOU（Time-of-Check to Time-of-Use）漏洞绕过驱动对调用进程的路径校验。具体而言，驱动通过检查进程路径是否包含特定ASUS字符串（如AsusCertService.exe）来验证授权。POC通过创建指向目标路径的硬链接并利用竞争条件，诱使驱动执行受控操作。核心利用点在于通过IOCTL_DECREMENT_OBJECT指令，利用驱动提供的任意地址递减功能，精准修改当前线程内核对象的PreviousMode字段。在Windows内核中，PreviousMode决定了系统调用的权限来源，将其从UserMode（1）修改为KernelMode（0）后，该线程即可在不受内核安全检查的情况下执行NtReadVirtualMemory和NtWriteVirtualMemory。POC随后遍历EPROCESS链表，通过PID匹配定位System进程和当前进程的Token地址，最终通过内核写操作将当前进程的Token替换为System Token。经代码静态分析，该POC结构完整，包含了NT函数动态加载、内核对象泄漏、硬链接竞争和Token替换等标准内核利用流程，具有极高的实战价值和成功率。 利用步骤：1. 准备阶段：编译POC程序，确保环境中存在受影响的AsIO3.sys驱动。2. 环境模拟：程序会自动或手动创建指向硬链接路径的目录结构，确保满足驱动的路径过滤条件。3. 触发漏洞：通过IOCTL 0xA0402450 调用驱动，利用TOCTOU绕过身份验证并触发地址递减原语。4. 权限提升：修改KTHREAD的PreviousMode，获取全权限内核读写能力。5. 令牌窃取：在内核空间定位System Token并覆盖当前进程Token。6. 验证：生成具有NT AUTHORITY\SYSTEM权限的cmd.exe shell。 投毒风险分析：该POC代码表现出极高的透明度和防御性研究特征。代码采用标准的C语言编写，未进行任何形式的混淆或加壳处理。包含的头文件如windows.h、ntdll.h等均为系统标准库，且所有的内核操作（如PreviousMode修改和Token替换）都是公开已知的利用技术，其行为完全符合特权提升POC的预期逻辑。在投毒检测中，重点关注是否含有下载执行、反弹Shell到未知IP或破坏系统MBR的操作，而此POC仅包含本地提权至SYSTEM的行为。此外，POC项目地址指向了合法的GitHub安全研究仓库（ThumpBo），该仓库具有一定的信誉背书。代码中虽然使用了硬链接和IOCTL调用等底层API，但这些都是利用漏洞所必需的组件，并非恶意投毒载体。综合评估，该代码作为威胁情报样本是安全的，不存在针对分析人员的后门或投毒风险，可放心用于防御性的漏洞复现和签名提取工作。

**项目地址:** [https://github.com/ThumpBo/CVE-2025-30208-EXP](https://github.com/ThumpBo/CVE-2025-30208-EXP) (注：搜索结果关联项目，实际代码片段对应AsIO3)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-3464](https://nvd.nist.gov/vuln/detail/CVE-2025-3464)
