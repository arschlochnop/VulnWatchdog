## CVE-2025-3464 - ASUS Armoury Crate 本地权限提升 (LPE) / 竞态条件 (TOCTOU)

**漏洞编号:** CVE-2025-3464

**漏洞类型:** 本地权限提升 (LPE) / 竞态条件 (TOCTOU)

**影响应用:** ASUS Armoury Crate

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 具体版本需参考ASUS安全公告 (包含 Armoury Crate App)

**利用条件:** 本地普通用户权限访问、受影响的 AsIO3.sys 驱动程序已安装、特定的文件路径结构 (C:\Program Files (x86)\ASUS\AsusCertService\)

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞存在于华硕（ASUS）Armoury Crate 软件及其配套的 AsIO3.sys 驱动程序中。漏洞核心是一个典型的检查时间与使用时间（TOCTOU）竞态条件问题。代码分析显示，利用程序通过创建硬链接（Hardlink）来绕过签名或路径验证机制。该 POC 代码非常完整，不仅包含了利用 TOCTOU 漏洞的同步事件处理（Global\AsIO3_TOCTOU_Sync），还集成了一个名为 IOCTL_DECREMENT_OBJECT (0xA0402450) 的内核递减原语。利用过程高度专业化，通过泄漏 KTHREAD 对象地址并计算 PreviousMode 的偏移量（0x232），利用递减原语将 PreviousMode 从 1（UserMode）修改为 0（KernelMode）。一旦成功修改，当前线程即可绕过内核内存读写限制，直接操作 EPROCESS 结构，通过令牌替换（Token Stealing）技术将普通用户进程提升至 NT AUTHORITY\SYSTEM 权限。代码中定义的 Windows 10/11 偏移量（如 EPROCESS_TOKEN 0x4B8）准确，表明这并非简单的概念验证，而是针对现代操作系统的武器化 Exploit。由于涉及驱动 IOCTL 通信和内核结构操作，环境稳定性对利用成功率有一定影响，但在受影响的特定 ASUS 驱动环境下，其有效性极高。【利用步骤】1. 环境准备：确保系统安装了受影响的 Armoury Crate，并在指定目录下构造特定的文件夹结构。2. 初始化：通过 GetModuleHandle 和 GetProcAddress 加载 ntdll.dll 中的隐藏函数。3. 触发漏洞：启动硬链接同步机制，利用符号链接重定向攻击 AsusCertService.exe。4. 驱动通信：通过 DeviceIoControl 向 AsIO3.sys 发送特定 IOCTL 指令。5. 提权：利用泄露的内核地址修改 PreviousMode，执行令牌替换。6. 验证：生成具有系统权限的新 Shell。【投毒风险分析】从代码层面审视，该 POC 具有极高的技术透明度。它使用了标准的 Windows C/C++ 开发范式，代码逻辑清晰地划分为内核函数定义、地址泄露模块、IOCTL 通信模块和提权逻辑。没有发现任何代码混淆、加密的 Shellcode 或隐藏的外部网络请求（如下载后门程序或连接 C2 节点）。其使用的库（shlwapi, ntdll）均为系统标准库。虽然代码中涉及内核修改，但这属于漏洞利用的必要组成部分，而非恶意投毒行为。较低的投毒风险评分（15%）主要考虑到这类底层 Exploit 代码可能会被二次封装。但在当前公开的源代码中，所有敏感操作（如内核读写）均有明确的逻辑目的。作为防御性安全研究员，应当注意到该代码对环境依赖性强，不具备自动扩散能力。防御重点应放在更新 ASUS 相关驱动程序、监控异常的符号链接创建行为以及审计 0xA0402450 等敏感 IOCTL 的调用源。由于代码逻辑直白且注释详尽，被用于供应链投毒的可能性极低，更倾向于作为高价值的漏洞研究样本。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-3464-AsIO3-Exploit](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-3464-AsIO3-Exploit)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-3464](https://nvd.nist.gov/vuln/detail/CVE-2025-3464)
