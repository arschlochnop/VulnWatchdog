## CVE-2018-1306 - Apache Pluto 任意文件上传

**漏洞编号:** CVE-2018-1306

**漏洞类型:** 任意文件上传

**影响应用:** Apache Pluto

**危害等级:** 重要

**CVSS评分:** 未提供，参考搜索结果应为Important

**影响版本:** 3.0.0

**利用条件:** 需要网络访问，绕过身份验证

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2018-1306是Apache Pluto 3.0.0版本中的一个任意文件上传漏洞。该漏洞源于授权逻辑的缺陷，攻击者可以通过篡改HTTP方法来上传恶意文件，从而绕过Web.xml中的安全约束配置，未授权访问资源。POC代码通过发送特制的HTTP HEAD请求，将包含恶意代码的JSP文件上传到服务器的特定目录，从而实现远程代码执行。

POC有效性分析：
POC代码由两个文件组成：plutorce.py（利用脚本）和webshell.jsp（恶意JSP文件）。plutorce.py脚本首先检查命令行参数的数量，确保提供了目标URL和webshell文件名。然后，它构造包含目标URL和特定路径的请求URL，指定了上传文件的位置，利用了Apache Pluto处理文件上传的缺陷。接下来，它打开webshell.jsp文件以二进制读取模式，将其内容作为HTTP HEAD请求的文件参数发送到服务器。如果服务器返回302状态码，则表示webshell上传成功。脚本会打印webshell的访问路径，攻击者可以通过访问该路径来执行webshell中的恶意代码。

利用步骤：
1. 准备一个包含恶意代码的JSP webshell文件（例如webshell.jsp）。
2. 运行plutorce.py脚本，指定目标Pluto服务器的URL和webshell文件名：python3 plutorce.py http://target_server/ webshell.jsp
3. 如果上传成功，脚本会输出webshell的访问路径。使用浏览器或curl等工具访问该路径，即可执行webshell中的恶意代码。
4. 攻击者可以通过webshell执行系统命令、读取敏感文件等恶意操作，从而控制服务器。

投毒风险分析：
此POC的投毒风险较低。脚本本身使用标准的Python库（requests）进行HTTP请求，没有明显的恶意行为或外部依赖。上传的webshell.jsp文件包含简单的命令执行功能，但其危害程度取决于攻击者上传的webshell内容。webshell.jsp的内容比较简单，仅包含一个表单用于接收命令，并使用Java代码执行系统命令。虽然存在一定的风险，但代码本身没有经过混淆，易于分析和理解。因此，该POC的投毒风险评定为10%。攻击者可能将webshell.jsp替换为更加隐蔽和危险的后门，例如反弹shell或持久化恶意代码，从而提高攻击的隐蔽性和危害性。

**项目地址:** https://github.com/Ridter/acefile

**漏洞详情:** 未提供，需自行搜索
