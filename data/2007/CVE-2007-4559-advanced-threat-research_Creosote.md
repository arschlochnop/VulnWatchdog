# CVE-2007-4559

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2007-4559-Ooscaar_MALW.md](../2007/CVE-2007-4559-Ooscaar_MALW.md)

## CVE-2007-4559 - Python tarfile 目录遍历漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录遍历

**影响应用:** Python tarfile module (Polemarch易受攻击)

**危害等级:** 高危，允许远程攻击者覆盖任意文件

**影响版本:** 所有使用存在漏洞的tarfile模块的Python版本

**利用条件:** 需要用户协助，上传恶意构造的TAR文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 是一个存在于Python tarfile模块中的目录遍历漏洞。攻击者可以创建一个恶意构造的TAR文件，其中包含带有“..”序列的文件名，当用户使用tarfile.extract或tarfile.extractall函数提取此TAR文件时，攻击者可以覆盖服务器上的任意文件。

**有效性：**
提供的POC代码是有效的，并且是针对Polemarch服务器的完整漏洞利用。它利用CVE-2007-4559漏洞，允许攻击者注入cryptominer（Monero）和rootkit。

**投毒风险：**
此仓库存在一定投毒风险（估计为10%）。虽然主要目的是利用已知的CVE-2007-4559漏洞，但仍有可能在编译脚本或配置中引入细微的恶意修改，例如在rootkit或shellcode中嵌入后门，从而在受害者系统上建立持久存在点。

风险分析：

*   Dockerfile：检查Dockerfile发现其目的在于创建一个包含漏洞环境的Docker镜像，方便漏洞利用。
*   README.md：描述了如何使用CVE-2007-4559漏洞攻击Polemarch服务器，包括编译二进制文件、设置服务器和上传恶意TAR文件。
*   STORY.md：描述了漏洞发现和利用的背景故事，包括如何通过网络钓鱼获取服务器访问权限。

代码分析发现该POC的主要目的是演示漏洞利用，并没有明显的恶意投毒代码。

**利用方式：**
利用方式主要包括以下步骤：

1.  **创建恶意TAR文件：** 攻击者构造一个包含带有目录遍历序列（“..”）的文件名的TAR文件。
2.  **上传恶意TAR文件：** 攻击者需要某种方式将此恶意TAR文件上传到目标系统，例如通过Web应用程序的文件上传功能。
3.  **提取恶意TAR文件：** 目标应用程序使用存在漏洞的tarfile.extract或tarfile.extractall函数提取上传的TAR文件。由于目录遍历漏洞，恶意文件将被写入攻击者指定的位置，从而实现任意文件覆盖。

在此POC中，攻击者利用此漏洞将cryptominer、rootkit和被感染的`polemarchctl` Docker entrypoint注入Polemarch服务器，从而控制受害者系统。


**项目地址:** [Ooscaar/MALW](https://github.com/Ooscaar/MALW)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---

## POC #2

**来源**: [CVE-2007-4559-advanced-threat-research_Creosote.md](../2007/CVE-2007-4559-advanced-threat-research_Creosote.md)

# CVE-2007-4559

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2007-4559-Ooscaar_MALW.md](../2007/CVE-2007-4559-Ooscaar_MALW.md)

## CVE-2007-4559 - Python tarfile 目录遍历漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录遍历

**影响应用:** Python tarfile module (Polemarch易受攻击)

**危害等级:** 高危，允许远程攻击者覆盖任意文件

**影响版本:** 所有使用存在漏洞的tarfile模块的Python版本

**利用条件:** 需要用户协助，上传恶意构造的TAR文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 是一个存在于Python tarfile模块中的目录遍历漏洞。攻击者可以创建一个恶意构造的TAR文件，其中包含带有“..”序列的文件名，当用户使用tarfile.extract或tarfile.extractall函数提取此TAR文件时，攻击者可以覆盖服务器上的任意文件。

**有效性：**
提供的POC代码是有效的，并且是针对Polemarch服务器的完整漏洞利用。它利用CVE-2007-4559漏洞，允许攻击者注入cryptominer（Monero）和rootkit。

**投毒风险：**
此仓库存在一定投毒风险（估计为10%）。虽然主要目的是利用已知的CVE-2007-4559漏洞，但仍有可能在编译脚本或配置中引入细微的恶意修改，例如在rootkit或shellcode中嵌入后门，从而在受害者系统上建立持久存在点。

风险分析：

*   Dockerfile：检查Dockerfile发现其目的在于创建一个包含漏洞环境的Docker镜像，方便漏洞利用。
*   README.md：描述了如何使用CVE-2007-4559漏洞攻击Polemarch服务器，包括编译二进制文件、设置服务器和上传恶意TAR文件。
*   STORY.md：描述了漏洞发现和利用的背景故事，包括如何通过网络钓鱼获取服务器访问权限。

代码分析发现该POC的主要目的是演示漏洞利用，并没有明显的恶意投毒代码。

**利用方式：**
利用方式主要包括以下步骤：

1.  **创建恶意TAR文件：** 攻击者构造一个包含带有目录遍历序列（“..”）的文件名的TAR文件。
2.  **上传恶意TAR文件：** 攻击者需要某种方式将此恶意TAR文件上传到目标系统，例如通过Web应用程序的文件上传功能。
3.  **提取恶意TAR文件：** 目标应用程序使用存在漏洞的tarfile.extract或tarfile.extractall函数提取上传的TAR文件。由于目录遍历漏洞，恶意文件将被写入攻击者指定的位置，从而实现任意文件覆盖。

在此POC中，攻击者利用此漏洞将cryptominer、rootkit和被感染的`polemarchctl` Docker entrypoint注入Polemarch服务器，从而控制受害者系统。


**项目地址:** [Ooscaar/MALW](https://github.com/Ooscaar/MALW)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---

## POC #2

**来源**: [CVE-2007-4559-advanced-threat-research_Creosote.md](../2007/CVE-2007-4559-advanced-threat-research_Creosote.md)

# CVE-2007-4559

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2007-4559-Ooscaar_MALW.md](../2007/CVE-2007-4559-Ooscaar_MALW.md)

## CVE-2007-4559 - Python tarfile 目录遍历漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录遍历

**影响应用:** Python tarfile module (Polemarch易受攻击)

**危害等级:** 高危，允许远程攻击者覆盖任意文件

**影响版本:** 所有使用存在漏洞的tarfile模块的Python版本

**利用条件:** 需要用户协助，上传恶意构造的TAR文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 是一个存在于Python tarfile模块中的目录遍历漏洞。攻击者可以创建一个恶意构造的TAR文件，其中包含带有“..”序列的文件名，当用户使用tarfile.extract或tarfile.extractall函数提取此TAR文件时，攻击者可以覆盖服务器上的任意文件。

**有效性：**
提供的POC代码是有效的，并且是针对Polemarch服务器的完整漏洞利用。它利用CVE-2007-4559漏洞，允许攻击者注入cryptominer（Monero）和rootkit。

**投毒风险：**
此仓库存在一定投毒风险（估计为10%）。虽然主要目的是利用已知的CVE-2007-4559漏洞，但仍有可能在编译脚本或配置中引入细微的恶意修改，例如在rootkit或shellcode中嵌入后门，从而在受害者系统上建立持久存在点。

风险分析：

*   Dockerfile：检查Dockerfile发现其目的在于创建一个包含漏洞环境的Docker镜像，方便漏洞利用。
*   README.md：描述了如何使用CVE-2007-4559漏洞攻击Polemarch服务器，包括编译二进制文件、设置服务器和上传恶意TAR文件。
*   STORY.md：描述了漏洞发现和利用的背景故事，包括如何通过网络钓鱼获取服务器访问权限。

代码分析发现该POC的主要目的是演示漏洞利用，并没有明显的恶意投毒代码。

**利用方式：**
利用方式主要包括以下步骤：

1.  **创建恶意TAR文件：** 攻击者构造一个包含带有目录遍历序列（“..”）的文件名的TAR文件。
2.  **上传恶意TAR文件：** 攻击者需要某种方式将此恶意TAR文件上传到目标系统，例如通过Web应用程序的文件上传功能。
3.  **提取恶意TAR文件：** 目标应用程序使用存在漏洞的tarfile.extract或tarfile.extractall函数提取上传的TAR文件。由于目录遍历漏洞，恶意文件将被写入攻击者指定的位置，从而实现任意文件覆盖。

在此POC中，攻击者利用此漏洞将cryptominer、rootkit和被感染的`polemarchctl` Docker entrypoint注入Polemarch服务器，从而控制受害者系统。


**项目地址:** [Ooscaar/MALW](https://github.com/Ooscaar/MALW)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---

## POC #2

**来源**: [CVE-2007-4559-advanced-threat-research_Creosote.md](../2007/CVE-2007-4559-advanced-threat-research_Creosote.md)

# CVE-2007-4559

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2007-4559-Ooscaar_MALW.md](../2007/CVE-2007-4559-Ooscaar_MALW.md)

## CVE-2007-4559 - Python tarfile 目录遍历漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录遍历

**影响应用:** Python tarfile module (Polemarch易受攻击)

**危害等级:** 高危，允许远程攻击者覆盖任意文件

**影响版本:** 所有使用存在漏洞的tarfile模块的Python版本

**利用条件:** 需要用户协助，上传恶意构造的TAR文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 是一个存在于Python tarfile模块中的目录遍历漏洞。攻击者可以创建一个恶意构造的TAR文件，其中包含带有“..”序列的文件名，当用户使用tarfile.extract或tarfile.extractall函数提取此TAR文件时，攻击者可以覆盖服务器上的任意文件。

**有效性：**
提供的POC代码是有效的，并且是针对Polemarch服务器的完整漏洞利用。它利用CVE-2007-4559漏洞，允许攻击者注入cryptominer（Monero）和rootkit。

**投毒风险：**
此仓库存在一定投毒风险（估计为10%）。虽然主要目的是利用已知的CVE-2007-4559漏洞，但仍有可能在编译脚本或配置中引入细微的恶意修改，例如在rootkit或shellcode中嵌入后门，从而在受害者系统上建立持久存在点。

风险分析：

*   Dockerfile：检查Dockerfile发现其目的在于创建一个包含漏洞环境的Docker镜像，方便漏洞利用。
*   README.md：描述了如何使用CVE-2007-4559漏洞攻击Polemarch服务器，包括编译二进制文件、设置服务器和上传恶意TAR文件。
*   STORY.md：描述了漏洞发现和利用的背景故事，包括如何通过网络钓鱼获取服务器访问权限。

代码分析发现该POC的主要目的是演示漏洞利用，并没有明显的恶意投毒代码。

**利用方式：**
利用方式主要包括以下步骤：

1.  **创建恶意TAR文件：** 攻击者构造一个包含带有目录遍历序列（“..”）的文件名的TAR文件。
2.  **上传恶意TAR文件：** 攻击者需要某种方式将此恶意TAR文件上传到目标系统，例如通过Web应用程序的文件上传功能。
3.  **提取恶意TAR文件：** 目标应用程序使用存在漏洞的tarfile.extract或tarfile.extractall函数提取上传的TAR文件。由于目录遍历漏洞，恶意文件将被写入攻击者指定的位置，从而实现任意文件覆盖。

在此POC中，攻击者利用此漏洞将cryptominer、rootkit和被感染的`polemarchctl` Docker entrypoint注入Polemarch服务器，从而控制受害者系统。


**项目地址:** [Ooscaar/MALW](https://github.com/Ooscaar/MALW)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---

## POC #2

**来源**: [CVE-2007-4559-advanced-threat-research_Creosote.md](../2007/CVE-2007-4559-advanced-threat-research_Creosote.md)

# CVE-2007-4559

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2007-4559-Ooscaar_MALW.md](../2007/CVE-2007-4559-Ooscaar_MALW.md)

## CVE-2007-4559 - Python tarfile 目录遍历漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录遍历

**影响应用:** Python tarfile module (Polemarch易受攻击)

**危害等级:** 高危，允许远程攻击者覆盖任意文件

**影响版本:** 所有使用存在漏洞的tarfile模块的Python版本

**利用条件:** 需要用户协助，上传恶意构造的TAR文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 是一个存在于Python tarfile模块中的目录遍历漏洞。攻击者可以创建一个恶意构造的TAR文件，其中包含带有“..”序列的文件名，当用户使用tarfile.extract或tarfile.extractall函数提取此TAR文件时，攻击者可以覆盖服务器上的任意文件。

**有效性：**
提供的POC代码是有效的，并且是针对Polemarch服务器的完整漏洞利用。它利用CVE-2007-4559漏洞，允许攻击者注入cryptominer（Monero）和rootkit。

**投毒风险：**
此仓库存在一定投毒风险（估计为10%）。虽然主要目的是利用已知的CVE-2007-4559漏洞，但仍有可能在编译脚本或配置中引入细微的恶意修改，例如在rootkit或shellcode中嵌入后门，从而在受害者系统上建立持久存在点。

风险分析：

*   Dockerfile：检查Dockerfile发现其目的在于创建一个包含漏洞环境的Docker镜像，方便漏洞利用。
*   README.md：描述了如何使用CVE-2007-4559漏洞攻击Polemarch服务器，包括编译二进制文件、设置服务器和上传恶意TAR文件。
*   STORY.md：描述了漏洞发现和利用的背景故事，包括如何通过网络钓鱼获取服务器访问权限。

代码分析发现该POC的主要目的是演示漏洞利用，并没有明显的恶意投毒代码。

**利用方式：**
利用方式主要包括以下步骤：

1.  **创建恶意TAR文件：** 攻击者构造一个包含带有目录遍历序列（“..”）的文件名的TAR文件。
2.  **上传恶意TAR文件：** 攻击者需要某种方式将此恶意TAR文件上传到目标系统，例如通过Web应用程序的文件上传功能。
3.  **提取恶意TAR文件：** 目标应用程序使用存在漏洞的tarfile.extract或tarfile.extractall函数提取上传的TAR文件。由于目录遍历漏洞，恶意文件将被写入攻击者指定的位置，从而实现任意文件覆盖。

在此POC中，攻击者利用此漏洞将cryptominer、rootkit和被感染的`polemarchctl` Docker entrypoint注入Polemarch服务器，从而控制受害者系统。


**项目地址:** [Ooscaar/MALW](https://github.com/Ooscaar/MALW)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---

## POC #2

**来源**: [CVE-2007-4559-advanced-threat-research_Creosote.md](../2007/CVE-2007-4559-advanced-threat-research_Creosote.md)

# CVE-2007-4559

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2007-4559-Ooscaar_MALW.md](../2007/CVE-2007-4559-Ooscaar_MALW.md)

## CVE-2007-4559 - Python tarfile 目录遍历漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录遍历

**影响应用:** Python tarfile module (Polemarch易受攻击)

**危害等级:** 高危，允许远程攻击者覆盖任意文件

**影响版本:** 所有使用存在漏洞的tarfile模块的Python版本

**利用条件:** 需要用户协助，上传恶意构造的TAR文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 是一个存在于Python tarfile模块中的目录遍历漏洞。攻击者可以创建一个恶意构造的TAR文件，其中包含带有“..”序列的文件名，当用户使用tarfile.extract或tarfile.extractall函数提取此TAR文件时，攻击者可以覆盖服务器上的任意文件。

**有效性：**
提供的POC代码是有效的，并且是针对Polemarch服务器的完整漏洞利用。它利用CVE-2007-4559漏洞，允许攻击者注入cryptominer（Monero）和rootkit。

**投毒风险：**
此仓库存在一定投毒风险（估计为10%）。虽然主要目的是利用已知的CVE-2007-4559漏洞，但仍有可能在编译脚本或配置中引入细微的恶意修改，例如在rootkit或shellcode中嵌入后门，从而在受害者系统上建立持久存在点。

风险分析：

*   Dockerfile：检查Dockerfile发现其目的在于创建一个包含漏洞环境的Docker镜像，方便漏洞利用。
*   README.md：描述了如何使用CVE-2007-4559漏洞攻击Polemarch服务器，包括编译二进制文件、设置服务器和上传恶意TAR文件。
*   STORY.md：描述了漏洞发现和利用的背景故事，包括如何通过网络钓鱼获取服务器访问权限。

代码分析发现该POC的主要目的是演示漏洞利用，并没有明显的恶意投毒代码。

**利用方式：**
利用方式主要包括以下步骤：

1.  **创建恶意TAR文件：** 攻击者构造一个包含带有目录遍历序列（“..”）的文件名的TAR文件。
2.  **上传恶意TAR文件：** 攻击者需要某种方式将此恶意TAR文件上传到目标系统，例如通过Web应用程序的文件上传功能。
3.  **提取恶意TAR文件：** 目标应用程序使用存在漏洞的tarfile.extract或tarfile.extractall函数提取上传的TAR文件。由于目录遍历漏洞，恶意文件将被写入攻击者指定的位置，从而实现任意文件覆盖。

在此POC中，攻击者利用此漏洞将cryptominer、rootkit和被感染的`polemarchctl` Docker entrypoint注入Polemarch服务器，从而控制受害者系统。


**项目地址:** [Ooscaar/MALW](https://github.com/Ooscaar/MALW)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---

## POC #2

**来源**: [CVE-2007-4559-advanced-threat-research_Creosote.md](../2007/CVE-2007-4559-advanced-threat-research_Creosote.md)

# CVE-2007-4559

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2007-4559-Ooscaar_MALW.md](../2007/CVE-2007-4559-Ooscaar_MALW.md)

## CVE-2007-4559 - Python tarfile 目录遍历漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录遍历

**影响应用:** Python tarfile module (Polemarch易受攻击)

**危害等级:** 高危，允许远程攻击者覆盖任意文件

**影响版本:** 所有使用存在漏洞的tarfile模块的Python版本

**利用条件:** 需要用户协助，上传恶意构造的TAR文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 是一个存在于Python tarfile模块中的目录遍历漏洞。攻击者可以创建一个恶意构造的TAR文件，其中包含带有“..”序列的文件名，当用户使用tarfile.extract或tarfile.extractall函数提取此TAR文件时，攻击者可以覆盖服务器上的任意文件。

**有效性：**
提供的POC代码是有效的，并且是针对Polemarch服务器的完整漏洞利用。它利用CVE-2007-4559漏洞，允许攻击者注入cryptominer（Monero）和rootkit。

**投毒风险：**
此仓库存在一定投毒风险（估计为10%）。虽然主要目的是利用已知的CVE-2007-4559漏洞，但仍有可能在编译脚本或配置中引入细微的恶意修改，例如在rootkit或shellcode中嵌入后门，从而在受害者系统上建立持久存在点。

风险分析：

*   Dockerfile：检查Dockerfile发现其目的在于创建一个包含漏洞环境的Docker镜像，方便漏洞利用。
*   README.md：描述了如何使用CVE-2007-4559漏洞攻击Polemarch服务器，包括编译二进制文件、设置服务器和上传恶意TAR文件。
*   STORY.md：描述了漏洞发现和利用的背景故事，包括如何通过网络钓鱼获取服务器访问权限。

代码分析发现该POC的主要目的是演示漏洞利用，并没有明显的恶意投毒代码。

**利用方式：**
利用方式主要包括以下步骤：

1.  **创建恶意TAR文件：** 攻击者构造一个包含带有目录遍历序列（“..”）的文件名的TAR文件。
2.  **上传恶意TAR文件：** 攻击者需要某种方式将此恶意TAR文件上传到目标系统，例如通过Web应用程序的文件上传功能。
3.  **提取恶意TAR文件：** 目标应用程序使用存在漏洞的tarfile.extract或tarfile.extractall函数提取上传的TAR文件。由于目录遍历漏洞，恶意文件将被写入攻击者指定的位置，从而实现任意文件覆盖。

在此POC中，攻击者利用此漏洞将cryptominer、rootkit和被感染的`polemarchctl` Docker entrypoint注入Polemarch服务器，从而控制受害者系统。


**项目地址:** [Ooscaar/MALW](https://github.com/Ooscaar/MALW)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---

## POC #2

**来源**: [CVE-2007-4559-advanced-threat-research_Creosote.md](../2007/CVE-2007-4559-advanced-threat-research_Creosote.md)

# CVE-2007-4559

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2007-4559-Ooscaar_MALW.md](../2007/CVE-2007-4559-Ooscaar_MALW.md)

## CVE-2007-4559 - Python tarfile 目录遍历漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录遍历

**影响应用:** Python tarfile module (Polemarch易受攻击)

**危害等级:** 高危，允许远程攻击者覆盖任意文件

**影响版本:** 所有使用存在漏洞的tarfile模块的Python版本

**利用条件:** 需要用户协助，上传恶意构造的TAR文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 是一个存在于Python tarfile模块中的目录遍历漏洞。攻击者可以创建一个恶意构造的TAR文件，其中包含带有“..”序列的文件名，当用户使用tarfile.extract或tarfile.extractall函数提取此TAR文件时，攻击者可以覆盖服务器上的任意文件。

**有效性：**
提供的POC代码是有效的，并且是针对Polemarch服务器的完整漏洞利用。它利用CVE-2007-4559漏洞，允许攻击者注入cryptominer（Monero）和rootkit。

**投毒风险：**
此仓库存在一定投毒风险（估计为10%）。虽然主要目的是利用已知的CVE-2007-4559漏洞，但仍有可能在编译脚本或配置中引入细微的恶意修改，例如在rootkit或shellcode中嵌入后门，从而在受害者系统上建立持久存在点。

风险分析：

*   Dockerfile：检查Dockerfile发现其目的在于创建一个包含漏洞环境的Docker镜像，方便漏洞利用。
*   README.md：描述了如何使用CVE-2007-4559漏洞攻击Polemarch服务器，包括编译二进制文件、设置服务器和上传恶意TAR文件。
*   STORY.md：描述了漏洞发现和利用的背景故事，包括如何通过网络钓鱼获取服务器访问权限。

代码分析发现该POC的主要目的是演示漏洞利用，并没有明显的恶意投毒代码。

**利用方式：**
利用方式主要包括以下步骤：

1.  **创建恶意TAR文件：** 攻击者构造一个包含带有目录遍历序列（“..”）的文件名的TAR文件。
2.  **上传恶意TAR文件：** 攻击者需要某种方式将此恶意TAR文件上传到目标系统，例如通过Web应用程序的文件上传功能。
3.  **提取恶意TAR文件：** 目标应用程序使用存在漏洞的tarfile.extract或tarfile.extractall函数提取上传的TAR文件。由于目录遍历漏洞，恶意文件将被写入攻击者指定的位置，从而实现任意文件覆盖。

在此POC中，攻击者利用此漏洞将cryptominer、rootkit和被感染的`polemarchctl` Docker entrypoint注入Polemarch服务器，从而控制受害者系统。


**项目地址:** [Ooscaar/MALW](https://github.com/Ooscaar/MALW)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---

## POC #2

**来源**: [CVE-2007-4559-advanced-threat-research_Creosote.md](../2007/CVE-2007-4559-advanced-threat-research_Creosote.md)

## CVE-2007-4559-Python tarfile 目录遍历漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录遍历

**影响应用:** Python tarfile module

**危害等级:** 高危，可能导致任意文件写入

**影响版本:** 受影响版本未知，但漏洞在2007年被发现，长期存在

**利用条件:** 用户需要解压恶意构造的TAR文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2007-4559 存在于 Python 的 tarfile 模块中。`extract` 和 `extractall` 函数存在目录遍历漏洞，允许攻击者通过在 TAR 文件中包含带有 '..' 序列的文件名，覆盖目标系统上的任意文件。漏洞利用方式：

1.  **构造恶意的 TAR 文件：** 攻击者创建一个 TAR 文件，其中包含带有目录遍历序列（例如 `../../../../etc/passwd`）的文件名。
2.  **诱导用户解压：** 攻击者诱导用户使用 Python 的 `tarfile.extract` 或 `tarfile.extractall` 函数解压该 TAR 文件。
3.  **覆盖任意文件：** 当 `tarfile` 模块解压文件时，目录遍历序列会被解析，导致文件被写入到目标系统的任意位置，覆盖已有文件。

根据提供的代码片段，`creosote.py` 是一个静态分析工具，用于检测 Python 代码中是否存在使用 `tarfile.extractall` 函数且未进行安全检查的情况，它本身不是PoC，但有助于定位存在漏洞的代码。

**有效性：** 根据漏洞库信息和搜索结果，此漏洞是有效的。即使是很早期的漏洞，通过搜索结果可知，影响了大量的开源项目。

**投毒风险：** 给定的 `creosote.py` 代码是一个静态分析工具，目的是查找潜在的漏洞代码，而不是漏洞利用代码。`LICENSE.txt`和`README.md` 也没有投毒的可能。因此，该仓库本身不包含恶意代码，投毒风险为0%。

**利用方式：**
利用此漏洞通常需要以下步骤：

1.  创建一个包含恶意路径的tar文件，例如包含文件名为`../../../tmp/evil.txt`的文件。
2.  诱使用户使用存在漏洞的Python程序解压这个tar文件。
3.  如果程序没有进行适当的路径检查，`evil.txt` 就会被解压到 `/tmp/` 目录，从而实现目录遍历。

修复此漏洞的关键在于在解压前对文件名进行安全检查，确保不包含任何目录遍历序列。

**项目地址:** [advanced-threat-research/Creosote](https://github.com/advanced-threat-research/Creosote)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---

## POC #3

**来源**: [CVE-2007-4559-davidholiday_CVE-2007-4559.md](../2007/CVE-2007-4559-davidholiday_CVE-2007-4559.md)

## CVE-2007-4559 Python tarfile 目录遍历漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录遍历

**影响应用:** Python tarfile module

**危害等级:** 高危，可能导致任意文件覆盖

**影响版本:** Python 3.11.4之前版本

**利用条件:** 需要用户协助解压恶意构造的tar文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 存在于 Python 的 tarfile 模块中。当使用 extract 或 extractall 函数解压包含恶意构造的文件名的 TAR 压缩包时，攻击者可以利用目录遍历漏洞覆盖任意文件。漏洞利用方式如下：

1.  **创建恶意Tar文件：** 攻击者创建一个包含带有 '..' 序列的文件名的 tar 文件。例如，文件名可能是 '../../../../etc/passwd'。
2.  **欺骗用户解压：** 攻击者诱使用户使用存在漏洞的 Python 脚本解压该 tar 文件。
3.  **目录遍历：** 当 Python 的 tarfile 模块解压文件时，它不会正确地清理文件名中的 '..' 序列，导致文件被写入到 tar 包之外的目录，从而覆盖任意文件。

**POC代码分析：**
提供的POC代码模拟了攻击流程，展示了如何在tar文件中构造恶意路径，并通过`tarfile.extractall`或`tarfile.extract`函数进行目录遍历。

**有效性：**
POC代码有效，可以验证目录遍历漏洞。

**投毒风险：**
该仓库主要用于演示漏洞，用于论证`os.path.realpath()`在处理符号链接时存在的问题，使得在提取之前难以检测出恶意路径。 考虑到该代码仓库的主要目的是漏洞演示和验证，以及代码内容相对简单直接，包含恶意投毒代码的可能性较低，判断投毒风险较低，估计为10%。主要风险可能来自下载源的安全性，但代码本身隐藏恶意行为的可能性不大。

**项目地址:** [davidholiday/CVE-2007-4559](https://github.com/davidholiday/CVE-2007-4559)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---

## POC #4

**来源**: [CVE-2007-4559-depers-rus_CVE-2007-4559.md](../2007/CVE-2007-4559-depers-rus_CVE-2007-4559.md)

## CVE-2007-4559-Python tarfile 目录遍历漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录遍历

**影响应用:** Python tarfile module

**危害等级:** 高危，可能导致任意文件覆盖和远程代码执行

**影响版本:** 受影响版本未知，但漏洞存在时间长，修复不及时

**利用条件:** 用户需要解压恶意构造的TAR文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 存在于 Python 的 tarfile 模块中。当使用 `extract()` 或 `extractall()` 函数解压 TAR 文件时，如果 TAR 文件中包含带有 `..` 序列的文件名（例如 `../../../../etc/passwd`），则可能导致目录遍历漏洞。这使得攻击者可以将文件写入到目标系统上的任意位置，从而覆盖敏感文件、执行恶意代码等。

**有效性：**
提供的 PoC 代码 `CVE-2007-4559-PoC.py` 旨在演示此漏洞。它创建了一个包含恶意路径的 TAR 文件，并尝试将其解压到 `/tmp/passwd.etc`。代码会检查文件是否成功解压，从而确认漏洞的存在。根据代码逻辑和漏洞描述，该 PoC 代码是有效的。

**投毒风险：**
虽然 PoC 代码本身用于演示漏洞，但仍然需要评估该代码是否存在投毒风险。风险评估如下:

*   **Payload 功能明确:** PoC 脚本目的在于利用目录遍历漏洞，将特定内容写入`/tmp/passwd.etc`。
*   **行为可控:** 脚本的行为相对明确和可控，即创建恶意tar包，解压到指定位置，并检查结果。
*   **代码量少:** 代码量相对较少，容易审核。

虽然PoC本身的目的不是投毒，但是如果有人利用此代码传播恶意软件，那么以下几个方面可能存在潜在风险：
1. 修改目标文件路径：攻击者可以修改`danger_file`变量，将恶意文件写入更关键的系统文件，例如修改`/etc/rc.local`实现开机自启动，或者覆盖web服务器的配置文件等，从而实现更高级的攻击。
2. 植入恶意代码：攻击者可以在写入的文件内容中植入恶意代码，例如webshell、反弹shell脚本等，进一步控制受害者系统。
3. 捆绑其他恶意脚本：将PoC脚本与其他恶意脚本捆绑在一起，形成更复杂的攻击链。

考虑到以上潜在风险，以及代码创建tar包并解压的特性，存在一定的被修改后用于恶意用途的风险。因此，将投毒风险评估为10%。

**利用方式：**
1.  **构造恶意 TAR 文件：** 攻击者创建一个包含带有 `..` 序列的文件名的 TAR 文件。
2.  **诱骗用户解压：** 攻击者通过某种方式（例如，通过电子邮件、网站等）将恶意 TAR 文件发送给用户，并诱骗用户使用存在漏洞的 `tarfile.extract()` 或 `extractall()` 函数进行解压。用户可能被欺骗是因为他们信任来源或不了解潜在风险。
3.  **利用目录遍历：** 当用户解压恶意 TAR 文件时，`tarfile` 模块会尝试将文件提取到 TAR 文件中指定的路径。由于存在 `..` 序列，`tarfile` 模块可能会将文件提取到目标系统上的任意位置。
4.  **覆盖或创建恶意文件：** 攻击者利用目录遍历漏洞，将恶意文件写入到目标系统上的敏感位置，例如覆盖系统配置文件、Web 服务器文件等。或者创建一个可以执行的恶意文件。
5.  **控制系统：** 通过覆盖敏感文件或创建恶意文件，攻击者最终可以控制目标系统。

**项目地址:** [depers-rus/CVE-2007-4559](https://github.com/depers-rus/CVE-2007-4559)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---

## POC #5

**来源**: [CVE-2007-4559-luigigubello_trellix-tarslip-patch-bypass.md](../2007/CVE-2007-4559-luigigubello_trellix-tarslip-patch-bypass.md)

## CVE-2007-4559 Python tarfile 目录穿越漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录穿越

**影响应用:** Python tarfile 模块

**危害等级:** 高危，允许攻击者覆盖任意文件

**影响版本:** 受影响版本：Python tarfile module

**利用条件:** 用户需要解压恶意构造的 TAR 压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 是 Python `tarfile` 模块中的一个目录穿越漏洞。`extract` 和 `extractall` 函数在处理 TAR 压缩包时，如果没有进行充分的路径验证，攻击者可以在 TAR 包中构造包含 `..` (dot dot) 序列的文件名，从而将文件解压到任意目录，覆盖或创建文件。根据搜索结果，该漏洞影响大量开源项目，修复不当可能导致绕过。

提供的 POC 代码旨在演示对 Trellix 补丁的绕过，该补丁尝试通过 `is_within_directory` 函数来防止目录穿越。POC 通过创建一个包含符号链接的 TAR 包，绕过 `is_within_directory` 的检查，因为该检查只验证了解压路径是否在目标目录内，而没有考虑到符号链接可能指向外部目录。

利用方式：
1.  攻击者构造包含恶意文件（文件名包含 `..` 序列或符号链接）的 TAR 压缩包。
2.  受害者使用存在漏洞的 `tarfile.extract` 或 `tarfile.extractall` 函数解压该压缩包。
3.  恶意文件被解压到攻击者指定的任意位置，可能覆盖系统文件或执行恶意代码。

有效性：提供的 POC 代码（`poc.py`）和相关文件（`Dockerfile`, `README.md`）旨在演示该漏洞的利用。`poc.py` 代码定义了一个 `safe_extract` 函数，该函数旨在防止目录穿越，但会被包含符号链接的 TAR 文件绕过。`Dockerfile` 用于构建一个包含 Python 环境的 Docker 镜像，方便运行 POC 代码。

投毒风险：`poc.py` 本身是为了验证漏洞，没有明显的后门代码。`Dockerfile` 使用官方 Python 镜像，风险较低。但 `README.md` 中提及了 Trellix 的修复方案存在绕过可能，并提供了验证步骤，可能存在诱导用户在生产环境中测试的可能性。尽管没有直接的恶意代码，存在潜在的误用风险，因此投毒风险评估为10%。因为攻击者可以修改 `poc.py`，在其中添加恶意代码，或者构造包含恶意文件的 TAR 包，该文件在解压后执行恶意操作。但提供的样本仓库本身的目的不是投毒，因此比例较低。

**项目地址:** [luigigubello/trellix-tarslip-patch-bypass](https://github.com/luigigubello/trellix-tarslip-patch-bypass)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---



---

## POC #3

**来源**: [CVE-2007-4559-davidholiday_CVE-2007-4559.md](../2007/CVE-2007-4559-davidholiday_CVE-2007-4559.md)

## CVE-2007-4559 Python tarfile 目录遍历漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录遍历

**影响应用:** Python tarfile module

**危害等级:** 高危，可能导致任意文件覆盖

**影响版本:** Python 3.11.4之前版本

**利用条件:** 需要用户协助解压恶意构造的tar文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 存在于 Python 的 tarfile 模块中。当使用 extract 或 extractall 函数解压包含恶意构造的文件名的 TAR 压缩包时，攻击者可以利用目录遍历漏洞覆盖任意文件。漏洞利用方式如下：

1.  **创建恶意Tar文件：** 攻击者创建一个包含带有 '..' 序列的文件名的 tar 文件。例如，文件名可能是 '../../../../etc/passwd'。
2.  **欺骗用户解压：** 攻击者诱使用户使用存在漏洞的 Python 脚本解压该 tar 文件。
3.  **目录遍历：** 当 Python 的 tarfile 模块解压文件时，它不会正确地清理文件名中的 '..' 序列，导致文件被写入到 tar 包之外的目录，从而覆盖任意文件。

**POC代码分析：**
提供的POC代码模拟了攻击流程，展示了如何在tar文件中构造恶意路径，并通过`tarfile.extractall`或`tarfile.extract`函数进行目录遍历。

**有效性：**
POC代码有效，可以验证目录遍历漏洞。

**投毒风险：**
该仓库主要用于演示漏洞，用于论证`os.path.realpath()`在处理符号链接时存在的问题，使得在提取之前难以检测出恶意路径。 考虑到该代码仓库的主要目的是漏洞演示和验证，以及代码内容相对简单直接，包含恶意投毒代码的可能性较低，判断投毒风险较低，估计为10%。主要风险可能来自下载源的安全性，但代码本身隐藏恶意行为的可能性不大。

**项目地址:** [davidholiday/CVE-2007-4559](https://github.com/davidholiday/CVE-2007-4559)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---

## POC #4

**来源**: [CVE-2007-4559-depers-rus_CVE-2007-4559.md](../2007/CVE-2007-4559-depers-rus_CVE-2007-4559.md)

## CVE-2007-4559-Python tarfile 目录遍历漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录遍历

**影响应用:** Python tarfile module

**危害等级:** 高危，可能导致任意文件覆盖和远程代码执行

**影响版本:** 受影响版本未知，但漏洞存在时间长，修复不及时

**利用条件:** 用户需要解压恶意构造的TAR文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 存在于 Python 的 tarfile 模块中。当使用 `extract()` 或 `extractall()` 函数解压 TAR 文件时，如果 TAR 文件中包含带有 `..` 序列的文件名（例如 `../../../../etc/passwd`），则可能导致目录遍历漏洞。这使得攻击者可以将文件写入到目标系统上的任意位置，从而覆盖敏感文件、执行恶意代码等。

**有效性：**
提供的 PoC 代码 `CVE-2007-4559-PoC.py` 旨在演示此漏洞。它创建了一个包含恶意路径的 TAR 文件，并尝试将其解压到 `/tmp/passwd.etc`。代码会检查文件是否成功解压，从而确认漏洞的存在。根据代码逻辑和漏洞描述，该 PoC 代码是有效的。

**投毒风险：**
虽然 PoC 代码本身用于演示漏洞，但仍然需要评估该代码是否存在投毒风险。风险评估如下:

*   **Payload 功能明确:** PoC 脚本目的在于利用目录遍历漏洞，将特定内容写入`/tmp/passwd.etc`。
*   **行为可控:** 脚本的行为相对明确和可控，即创建恶意tar包，解压到指定位置，并检查结果。
*   **代码量少:** 代码量相对较少，容易审核。

虽然PoC本身的目的不是投毒，但是如果有人利用此代码传播恶意软件，那么以下几个方面可能存在潜在风险：
1. 修改目标文件路径：攻击者可以修改`danger_file`变量，将恶意文件写入更关键的系统文件，例如修改`/etc/rc.local`实现开机自启动，或者覆盖web服务器的配置文件等，从而实现更高级的攻击。
2. 植入恶意代码：攻击者可以在写入的文件内容中植入恶意代码，例如webshell、反弹shell脚本等，进一步控制受害者系统。
3. 捆绑其他恶意脚本：将PoC脚本与其他恶意脚本捆绑在一起，形成更复杂的攻击链。

考虑到以上潜在风险，以及代码创建tar包并解压的特性，存在一定的被修改后用于恶意用途的风险。因此，将投毒风险评估为10%。

**利用方式：**
1.  **构造恶意 TAR 文件：** 攻击者创建一个包含带有 `..` 序列的文件名的 TAR 文件。
2.  **诱骗用户解压：** 攻击者通过某种方式（例如，通过电子邮件、网站等）将恶意 TAR 文件发送给用户，并诱骗用户使用存在漏洞的 `tarfile.extract()` 或 `extractall()` 函数进行解压。用户可能被欺骗是因为他们信任来源或不了解潜在风险。
3.  **利用目录遍历：** 当用户解压恶意 TAR 文件时，`tarfile` 模块会尝试将文件提取到 TAR 文件中指定的路径。由于存在 `..` 序列，`tarfile` 模块可能会将文件提取到目标系统上的任意位置。
4.  **覆盖或创建恶意文件：** 攻击者利用目录遍历漏洞，将恶意文件写入到目标系统上的敏感位置，例如覆盖系统配置文件、Web 服务器文件等。或者创建一个可以执行的恶意文件。
5.  **控制系统：** 通过覆盖敏感文件或创建恶意文件，攻击者最终可以控制目标系统。

**项目地址:** [depers-rus/CVE-2007-4559](https://github.com/depers-rus/CVE-2007-4559)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---

## POC #5

**来源**: [CVE-2007-4559-luigigubello_trellix-tarslip-patch-bypass.md](../2007/CVE-2007-4559-luigigubello_trellix-tarslip-patch-bypass.md)

## CVE-2007-4559 Python tarfile 目录穿越漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录穿越

**影响应用:** Python tarfile 模块

**危害等级:** 高危，允许攻击者覆盖任意文件

**影响版本:** 受影响版本：Python tarfile module

**利用条件:** 用户需要解压恶意构造的 TAR 压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 是 Python `tarfile` 模块中的一个目录穿越漏洞。`extract` 和 `extractall` 函数在处理 TAR 压缩包时，如果没有进行充分的路径验证，攻击者可以在 TAR 包中构造包含 `..` (dot dot) 序列的文件名，从而将文件解压到任意目录，覆盖或创建文件。根据搜索结果，该漏洞影响大量开源项目，修复不当可能导致绕过。

提供的 POC 代码旨在演示对 Trellix 补丁的绕过，该补丁尝试通过 `is_within_directory` 函数来防止目录穿越。POC 通过创建一个包含符号链接的 TAR 包，绕过 `is_within_directory` 的检查，因为该检查只验证了解压路径是否在目标目录内，而没有考虑到符号链接可能指向外部目录。

利用方式：
1.  攻击者构造包含恶意文件（文件名包含 `..` 序列或符号链接）的 TAR 压缩包。
2.  受害者使用存在漏洞的 `tarfile.extract` 或 `tarfile.extractall` 函数解压该压缩包。
3.  恶意文件被解压到攻击者指定的任意位置，可能覆盖系统文件或执行恶意代码。

有效性：提供的 POC 代码（`poc.py`）和相关文件（`Dockerfile`, `README.md`）旨在演示该漏洞的利用。`poc.py` 代码定义了一个 `safe_extract` 函数，该函数旨在防止目录穿越，但会被包含符号链接的 TAR 文件绕过。`Dockerfile` 用于构建一个包含 Python 环境的 Docker 镜像，方便运行 POC 代码。

投毒风险：`poc.py` 本身是为了验证漏洞，没有明显的后门代码。`Dockerfile` 使用官方 Python 镜像，风险较低。但 `README.md` 中提及了 Trellix 的修复方案存在绕过可能，并提供了验证步骤，可能存在诱导用户在生产环境中测试的可能性。尽管没有直接的恶意代码，存在潜在的误用风险，因此投毒风险评估为10%。因为攻击者可以修改 `poc.py`，在其中添加恶意代码，或者构造包含恶意文件的 TAR 包，该文件在解压后执行恶意操作。但提供的样本仓库本身的目的不是投毒，因此比例较低。

**项目地址:** [luigigubello/trellix-tarslip-patch-bypass](https://github.com/luigigubello/trellix-tarslip-patch-bypass)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---



---

## POC #3

**来源**: [CVE-2007-4559-davidholiday_CVE-2007-4559.md](../2007/CVE-2007-4559-davidholiday_CVE-2007-4559.md)

## CVE-2007-4559 Python tarfile 目录遍历漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录遍历

**影响应用:** Python tarfile module

**危害等级:** 高危，可能导致任意文件覆盖

**影响版本:** Python 3.11.4之前版本

**利用条件:** 需要用户协助解压恶意构造的tar文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 存在于 Python 的 tarfile 模块中。当使用 extract 或 extractall 函数解压包含恶意构造的文件名的 TAR 压缩包时，攻击者可以利用目录遍历漏洞覆盖任意文件。漏洞利用方式如下：

1.  **创建恶意Tar文件：** 攻击者创建一个包含带有 '..' 序列的文件名的 tar 文件。例如，文件名可能是 '../../../../etc/passwd'。
2.  **欺骗用户解压：** 攻击者诱使用户使用存在漏洞的 Python 脚本解压该 tar 文件。
3.  **目录遍历：** 当 Python 的 tarfile 模块解压文件时，它不会正确地清理文件名中的 '..' 序列，导致文件被写入到 tar 包之外的目录，从而覆盖任意文件。

**POC代码分析：**
提供的POC代码模拟了攻击流程，展示了如何在tar文件中构造恶意路径，并通过`tarfile.extractall`或`tarfile.extract`函数进行目录遍历。

**有效性：**
POC代码有效，可以验证目录遍历漏洞。

**投毒风险：**
该仓库主要用于演示漏洞，用于论证`os.path.realpath()`在处理符号链接时存在的问题，使得在提取之前难以检测出恶意路径。 考虑到该代码仓库的主要目的是漏洞演示和验证，以及代码内容相对简单直接，包含恶意投毒代码的可能性较低，判断投毒风险较低，估计为10%。主要风险可能来自下载源的安全性，但代码本身隐藏恶意行为的可能性不大。

**项目地址:** [davidholiday/CVE-2007-4559](https://github.com/davidholiday/CVE-2007-4559)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---

## POC #4

**来源**: [CVE-2007-4559-depers-rus_CVE-2007-4559.md](../2007/CVE-2007-4559-depers-rus_CVE-2007-4559.md)

## CVE-2007-4559-Python tarfile 目录遍历漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录遍历

**影响应用:** Python tarfile module

**危害等级:** 高危，可能导致任意文件覆盖和远程代码执行

**影响版本:** 受影响版本未知，但漏洞存在时间长，修复不及时

**利用条件:** 用户需要解压恶意构造的TAR文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 存在于 Python 的 tarfile 模块中。当使用 `extract()` 或 `extractall()` 函数解压 TAR 文件时，如果 TAR 文件中包含带有 `..` 序列的文件名（例如 `../../../../etc/passwd`），则可能导致目录遍历漏洞。这使得攻击者可以将文件写入到目标系统上的任意位置，从而覆盖敏感文件、执行恶意代码等。

**有效性：**
提供的 PoC 代码 `CVE-2007-4559-PoC.py` 旨在演示此漏洞。它创建了一个包含恶意路径的 TAR 文件，并尝试将其解压到 `/tmp/passwd.etc`。代码会检查文件是否成功解压，从而确认漏洞的存在。根据代码逻辑和漏洞描述，该 PoC 代码是有效的。

**投毒风险：**
虽然 PoC 代码本身用于演示漏洞，但仍然需要评估该代码是否存在投毒风险。风险评估如下:

*   **Payload 功能明确:** PoC 脚本目的在于利用目录遍历漏洞，将特定内容写入`/tmp/passwd.etc`。
*   **行为可控:** 脚本的行为相对明确和可控，即创建恶意tar包，解压到指定位置，并检查结果。
*   **代码量少:** 代码量相对较少，容易审核。

虽然PoC本身的目的不是投毒，但是如果有人利用此代码传播恶意软件，那么以下几个方面可能存在潜在风险：
1. 修改目标文件路径：攻击者可以修改`danger_file`变量，将恶意文件写入更关键的系统文件，例如修改`/etc/rc.local`实现开机自启动，或者覆盖web服务器的配置文件等，从而实现更高级的攻击。
2. 植入恶意代码：攻击者可以在写入的文件内容中植入恶意代码，例如webshell、反弹shell脚本等，进一步控制受害者系统。
3. 捆绑其他恶意脚本：将PoC脚本与其他恶意脚本捆绑在一起，形成更复杂的攻击链。

考虑到以上潜在风险，以及代码创建tar包并解压的特性，存在一定的被修改后用于恶意用途的风险。因此，将投毒风险评估为10%。

**利用方式：**
1.  **构造恶意 TAR 文件：** 攻击者创建一个包含带有 `..` 序列的文件名的 TAR 文件。
2.  **诱骗用户解压：** 攻击者通过某种方式（例如，通过电子邮件、网站等）将恶意 TAR 文件发送给用户，并诱骗用户使用存在漏洞的 `tarfile.extract()` 或 `extractall()` 函数进行解压。用户可能被欺骗是因为他们信任来源或不了解潜在风险。
3.  **利用目录遍历：** 当用户解压恶意 TAR 文件时，`tarfile` 模块会尝试将文件提取到 TAR 文件中指定的路径。由于存在 `..` 序列，`tarfile` 模块可能会将文件提取到目标系统上的任意位置。
4.  **覆盖或创建恶意文件：** 攻击者利用目录遍历漏洞，将恶意文件写入到目标系统上的敏感位置，例如覆盖系统配置文件、Web 服务器文件等。或者创建一个可以执行的恶意文件。
5.  **控制系统：** 通过覆盖敏感文件或创建恶意文件，攻击者最终可以控制目标系统。

**项目地址:** [depers-rus/CVE-2007-4559](https://github.com/depers-rus/CVE-2007-4559)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---

## POC #5

**来源**: [CVE-2007-4559-luigigubello_trellix-tarslip-patch-bypass.md](../2007/CVE-2007-4559-luigigubello_trellix-tarslip-patch-bypass.md)

## CVE-2007-4559 Python tarfile 目录穿越漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录穿越

**影响应用:** Python tarfile 模块

**危害等级:** 高危，允许攻击者覆盖任意文件

**影响版本:** 受影响版本：Python tarfile module

**利用条件:** 用户需要解压恶意构造的 TAR 压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 是 Python `tarfile` 模块中的一个目录穿越漏洞。`extract` 和 `extractall` 函数在处理 TAR 压缩包时，如果没有进行充分的路径验证，攻击者可以在 TAR 包中构造包含 `..` (dot dot) 序列的文件名，从而将文件解压到任意目录，覆盖或创建文件。根据搜索结果，该漏洞影响大量开源项目，修复不当可能导致绕过。

提供的 POC 代码旨在演示对 Trellix 补丁的绕过，该补丁尝试通过 `is_within_directory` 函数来防止目录穿越。POC 通过创建一个包含符号链接的 TAR 包，绕过 `is_within_directory` 的检查，因为该检查只验证了解压路径是否在目标目录内，而没有考虑到符号链接可能指向外部目录。

利用方式：
1.  攻击者构造包含恶意文件（文件名包含 `..` 序列或符号链接）的 TAR 压缩包。
2.  受害者使用存在漏洞的 `tarfile.extract` 或 `tarfile.extractall` 函数解压该压缩包。
3.  恶意文件被解压到攻击者指定的任意位置，可能覆盖系统文件或执行恶意代码。

有效性：提供的 POC 代码（`poc.py`）和相关文件（`Dockerfile`, `README.md`）旨在演示该漏洞的利用。`poc.py` 代码定义了一个 `safe_extract` 函数，该函数旨在防止目录穿越，但会被包含符号链接的 TAR 文件绕过。`Dockerfile` 用于构建一个包含 Python 环境的 Docker 镜像，方便运行 POC 代码。

投毒风险：`poc.py` 本身是为了验证漏洞，没有明显的后门代码。`Dockerfile` 使用官方 Python 镜像，风险较低。但 `README.md` 中提及了 Trellix 的修复方案存在绕过可能，并提供了验证步骤，可能存在诱导用户在生产环境中测试的可能性。尽管没有直接的恶意代码，存在潜在的误用风险，因此投毒风险评估为10%。因为攻击者可以修改 `poc.py`，在其中添加恶意代码，或者构造包含恶意文件的 TAR 包，该文件在解压后执行恶意操作。但提供的样本仓库本身的目的不是投毒，因此比例较低。

**项目地址:** [luigigubello/trellix-tarslip-patch-bypass](https://github.com/luigigubello/trellix-tarslip-patch-bypass)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---



---

## POC #3

**来源**: [CVE-2007-4559-davidholiday_CVE-2007-4559.md](../2007/CVE-2007-4559-davidholiday_CVE-2007-4559.md)

## CVE-2007-4559 Python tarfile 目录遍历漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录遍历

**影响应用:** Python tarfile module

**危害等级:** 高危，可能导致任意文件覆盖

**影响版本:** Python 3.11.4之前版本

**利用条件:** 需要用户协助解压恶意构造的tar文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 存在于 Python 的 tarfile 模块中。当使用 extract 或 extractall 函数解压包含恶意构造的文件名的 TAR 压缩包时，攻击者可以利用目录遍历漏洞覆盖任意文件。漏洞利用方式如下：

1.  **创建恶意Tar文件：** 攻击者创建一个包含带有 '..' 序列的文件名的 tar 文件。例如，文件名可能是 '../../../../etc/passwd'。
2.  **欺骗用户解压：** 攻击者诱使用户使用存在漏洞的 Python 脚本解压该 tar 文件。
3.  **目录遍历：** 当 Python 的 tarfile 模块解压文件时，它不会正确地清理文件名中的 '..' 序列，导致文件被写入到 tar 包之外的目录，从而覆盖任意文件。

**POC代码分析：**
提供的POC代码模拟了攻击流程，展示了如何在tar文件中构造恶意路径，并通过`tarfile.extractall`或`tarfile.extract`函数进行目录遍历。

**有效性：**
POC代码有效，可以验证目录遍历漏洞。

**投毒风险：**
该仓库主要用于演示漏洞，用于论证`os.path.realpath()`在处理符号链接时存在的问题，使得在提取之前难以检测出恶意路径。 考虑到该代码仓库的主要目的是漏洞演示和验证，以及代码内容相对简单直接，包含恶意投毒代码的可能性较低，判断投毒风险较低，估计为10%。主要风险可能来自下载源的安全性，但代码本身隐藏恶意行为的可能性不大。

**项目地址:** [davidholiday/CVE-2007-4559](https://github.com/davidholiday/CVE-2007-4559)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---

## POC #4

**来源**: [CVE-2007-4559-depers-rus_CVE-2007-4559.md](../2007/CVE-2007-4559-depers-rus_CVE-2007-4559.md)

## CVE-2007-4559-Python tarfile 目录遍历漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录遍历

**影响应用:** Python tarfile module

**危害等级:** 高危，可能导致任意文件覆盖和远程代码执行

**影响版本:** 受影响版本未知，但漏洞存在时间长，修复不及时

**利用条件:** 用户需要解压恶意构造的TAR文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 存在于 Python 的 tarfile 模块中。当使用 `extract()` 或 `extractall()` 函数解压 TAR 文件时，如果 TAR 文件中包含带有 `..` 序列的文件名（例如 `../../../../etc/passwd`），则可能导致目录遍历漏洞。这使得攻击者可以将文件写入到目标系统上的任意位置，从而覆盖敏感文件、执行恶意代码等。

**有效性：**
提供的 PoC 代码 `CVE-2007-4559-PoC.py` 旨在演示此漏洞。它创建了一个包含恶意路径的 TAR 文件，并尝试将其解压到 `/tmp/passwd.etc`。代码会检查文件是否成功解压，从而确认漏洞的存在。根据代码逻辑和漏洞描述，该 PoC 代码是有效的。

**投毒风险：**
虽然 PoC 代码本身用于演示漏洞，但仍然需要评估该代码是否存在投毒风险。风险评估如下:

*   **Payload 功能明确:** PoC 脚本目的在于利用目录遍历漏洞，将特定内容写入`/tmp/passwd.etc`。
*   **行为可控:** 脚本的行为相对明确和可控，即创建恶意tar包，解压到指定位置，并检查结果。
*   **代码量少:** 代码量相对较少，容易审核。

虽然PoC本身的目的不是投毒，但是如果有人利用此代码传播恶意软件，那么以下几个方面可能存在潜在风险：
1. 修改目标文件路径：攻击者可以修改`danger_file`变量，将恶意文件写入更关键的系统文件，例如修改`/etc/rc.local`实现开机自启动，或者覆盖web服务器的配置文件等，从而实现更高级的攻击。
2. 植入恶意代码：攻击者可以在写入的文件内容中植入恶意代码，例如webshell、反弹shell脚本等，进一步控制受害者系统。
3. 捆绑其他恶意脚本：将PoC脚本与其他恶意脚本捆绑在一起，形成更复杂的攻击链。

考虑到以上潜在风险，以及代码创建tar包并解压的特性，存在一定的被修改后用于恶意用途的风险。因此，将投毒风险评估为10%。

**利用方式：**
1.  **构造恶意 TAR 文件：** 攻击者创建一个包含带有 `..` 序列的文件名的 TAR 文件。
2.  **诱骗用户解压：** 攻击者通过某种方式（例如，通过电子邮件、网站等）将恶意 TAR 文件发送给用户，并诱骗用户使用存在漏洞的 `tarfile.extract()` 或 `extractall()` 函数进行解压。用户可能被欺骗是因为他们信任来源或不了解潜在风险。
3.  **利用目录遍历：** 当用户解压恶意 TAR 文件时，`tarfile` 模块会尝试将文件提取到 TAR 文件中指定的路径。由于存在 `..` 序列，`tarfile` 模块可能会将文件提取到目标系统上的任意位置。
4.  **覆盖或创建恶意文件：** 攻击者利用目录遍历漏洞，将恶意文件写入到目标系统上的敏感位置，例如覆盖系统配置文件、Web 服务器文件等。或者创建一个可以执行的恶意文件。
5.  **控制系统：** 通过覆盖敏感文件或创建恶意文件，攻击者最终可以控制目标系统。

**项目地址:** [depers-rus/CVE-2007-4559](https://github.com/depers-rus/CVE-2007-4559)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---

## POC #5

**来源**: [CVE-2007-4559-luigigubello_trellix-tarslip-patch-bypass.md](../2007/CVE-2007-4559-luigigubello_trellix-tarslip-patch-bypass.md)

## CVE-2007-4559 Python tarfile 目录穿越漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录穿越

**影响应用:** Python tarfile 模块

**危害等级:** 高危，允许攻击者覆盖任意文件

**影响版本:** 受影响版本：Python tarfile module

**利用条件:** 用户需要解压恶意构造的 TAR 压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 是 Python `tarfile` 模块中的一个目录穿越漏洞。`extract` 和 `extractall` 函数在处理 TAR 压缩包时，如果没有进行充分的路径验证，攻击者可以在 TAR 包中构造包含 `..` (dot dot) 序列的文件名，从而将文件解压到任意目录，覆盖或创建文件。根据搜索结果，该漏洞影响大量开源项目，修复不当可能导致绕过。

提供的 POC 代码旨在演示对 Trellix 补丁的绕过，该补丁尝试通过 `is_within_directory` 函数来防止目录穿越。POC 通过创建一个包含符号链接的 TAR 包，绕过 `is_within_directory` 的检查，因为该检查只验证了解压路径是否在目标目录内，而没有考虑到符号链接可能指向外部目录。

利用方式：
1.  攻击者构造包含恶意文件（文件名包含 `..` 序列或符号链接）的 TAR 压缩包。
2.  受害者使用存在漏洞的 `tarfile.extract` 或 `tarfile.extractall` 函数解压该压缩包。
3.  恶意文件被解压到攻击者指定的任意位置，可能覆盖系统文件或执行恶意代码。

有效性：提供的 POC 代码（`poc.py`）和相关文件（`Dockerfile`, `README.md`）旨在演示该漏洞的利用。`poc.py` 代码定义了一个 `safe_extract` 函数，该函数旨在防止目录穿越，但会被包含符号链接的 TAR 文件绕过。`Dockerfile` 用于构建一个包含 Python 环境的 Docker 镜像，方便运行 POC 代码。

投毒风险：`poc.py` 本身是为了验证漏洞，没有明显的后门代码。`Dockerfile` 使用官方 Python 镜像，风险较低。但 `README.md` 中提及了 Trellix 的修复方案存在绕过可能，并提供了验证步骤，可能存在诱导用户在生产环境中测试的可能性。尽管没有直接的恶意代码，存在潜在的误用风险，因此投毒风险评估为10%。因为攻击者可以修改 `poc.py`，在其中添加恶意代码，或者构造包含恶意文件的 TAR 包，该文件在解压后执行恶意操作。但提供的样本仓库本身的目的不是投毒，因此比例较低。

**项目地址:** [luigigubello/trellix-tarslip-patch-bypass](https://github.com/luigigubello/trellix-tarslip-patch-bypass)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---



---

## POC #3

**来源**: [CVE-2007-4559-davidholiday_CVE-2007-4559.md](../2007/CVE-2007-4559-davidholiday_CVE-2007-4559.md)

## CVE-2007-4559 Python tarfile 目录遍历漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录遍历

**影响应用:** Python tarfile module

**危害等级:** 高危，可能导致任意文件覆盖

**影响版本:** Python 3.11.4之前版本

**利用条件:** 需要用户协助解压恶意构造的tar文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 存在于 Python 的 tarfile 模块中。当使用 extract 或 extractall 函数解压包含恶意构造的文件名的 TAR 压缩包时，攻击者可以利用目录遍历漏洞覆盖任意文件。漏洞利用方式如下：

1.  **创建恶意Tar文件：** 攻击者创建一个包含带有 '..' 序列的文件名的 tar 文件。例如，文件名可能是 '../../../../etc/passwd'。
2.  **欺骗用户解压：** 攻击者诱使用户使用存在漏洞的 Python 脚本解压该 tar 文件。
3.  **目录遍历：** 当 Python 的 tarfile 模块解压文件时，它不会正确地清理文件名中的 '..' 序列，导致文件被写入到 tar 包之外的目录，从而覆盖任意文件。

**POC代码分析：**
提供的POC代码模拟了攻击流程，展示了如何在tar文件中构造恶意路径，并通过`tarfile.extractall`或`tarfile.extract`函数进行目录遍历。

**有效性：**
POC代码有效，可以验证目录遍历漏洞。

**投毒风险：**
该仓库主要用于演示漏洞，用于论证`os.path.realpath()`在处理符号链接时存在的问题，使得在提取之前难以检测出恶意路径。 考虑到该代码仓库的主要目的是漏洞演示和验证，以及代码内容相对简单直接，包含恶意投毒代码的可能性较低，判断投毒风险较低，估计为10%。主要风险可能来自下载源的安全性，但代码本身隐藏恶意行为的可能性不大。

**项目地址:** [davidholiday/CVE-2007-4559](https://github.com/davidholiday/CVE-2007-4559)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---

## POC #4

**来源**: [CVE-2007-4559-depers-rus_CVE-2007-4559.md](../2007/CVE-2007-4559-depers-rus_CVE-2007-4559.md)

## CVE-2007-4559-Python tarfile 目录遍历漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录遍历

**影响应用:** Python tarfile module

**危害等级:** 高危，可能导致任意文件覆盖和远程代码执行

**影响版本:** 受影响版本未知，但漏洞存在时间长，修复不及时

**利用条件:** 用户需要解压恶意构造的TAR文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 存在于 Python 的 tarfile 模块中。当使用 `extract()` 或 `extractall()` 函数解压 TAR 文件时，如果 TAR 文件中包含带有 `..` 序列的文件名（例如 `../../../../etc/passwd`），则可能导致目录遍历漏洞。这使得攻击者可以将文件写入到目标系统上的任意位置，从而覆盖敏感文件、执行恶意代码等。

**有效性：**
提供的 PoC 代码 `CVE-2007-4559-PoC.py` 旨在演示此漏洞。它创建了一个包含恶意路径的 TAR 文件，并尝试将其解压到 `/tmp/passwd.etc`。代码会检查文件是否成功解压，从而确认漏洞的存在。根据代码逻辑和漏洞描述，该 PoC 代码是有效的。

**投毒风险：**
虽然 PoC 代码本身用于演示漏洞，但仍然需要评估该代码是否存在投毒风险。风险评估如下:

*   **Payload 功能明确:** PoC 脚本目的在于利用目录遍历漏洞，将特定内容写入`/tmp/passwd.etc`。
*   **行为可控:** 脚本的行为相对明确和可控，即创建恶意tar包，解压到指定位置，并检查结果。
*   **代码量少:** 代码量相对较少，容易审核。

虽然PoC本身的目的不是投毒，但是如果有人利用此代码传播恶意软件，那么以下几个方面可能存在潜在风险：
1. 修改目标文件路径：攻击者可以修改`danger_file`变量，将恶意文件写入更关键的系统文件，例如修改`/etc/rc.local`实现开机自启动，或者覆盖web服务器的配置文件等，从而实现更高级的攻击。
2. 植入恶意代码：攻击者可以在写入的文件内容中植入恶意代码，例如webshell、反弹shell脚本等，进一步控制受害者系统。
3. 捆绑其他恶意脚本：将PoC脚本与其他恶意脚本捆绑在一起，形成更复杂的攻击链。

考虑到以上潜在风险，以及代码创建tar包并解压的特性，存在一定的被修改后用于恶意用途的风险。因此，将投毒风险评估为10%。

**利用方式：**
1.  **构造恶意 TAR 文件：** 攻击者创建一个包含带有 `..` 序列的文件名的 TAR 文件。
2.  **诱骗用户解压：** 攻击者通过某种方式（例如，通过电子邮件、网站等）将恶意 TAR 文件发送给用户，并诱骗用户使用存在漏洞的 `tarfile.extract()` 或 `extractall()` 函数进行解压。用户可能被欺骗是因为他们信任来源或不了解潜在风险。
3.  **利用目录遍历：** 当用户解压恶意 TAR 文件时，`tarfile` 模块会尝试将文件提取到 TAR 文件中指定的路径。由于存在 `..` 序列，`tarfile` 模块可能会将文件提取到目标系统上的任意位置。
4.  **覆盖或创建恶意文件：** 攻击者利用目录遍历漏洞，将恶意文件写入到目标系统上的敏感位置，例如覆盖系统配置文件、Web 服务器文件等。或者创建一个可以执行的恶意文件。
5.  **控制系统：** 通过覆盖敏感文件或创建恶意文件，攻击者最终可以控制目标系统。

**项目地址:** [depers-rus/CVE-2007-4559](https://github.com/depers-rus/CVE-2007-4559)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---

## POC #5

**来源**: [CVE-2007-4559-luigigubello_trellix-tarslip-patch-bypass.md](../2007/CVE-2007-4559-luigigubello_trellix-tarslip-patch-bypass.md)

## CVE-2007-4559 Python tarfile 目录穿越漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录穿越

**影响应用:** Python tarfile 模块

**危害等级:** 高危，允许攻击者覆盖任意文件

**影响版本:** 受影响版本：Python tarfile module

**利用条件:** 用户需要解压恶意构造的 TAR 压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 是 Python `tarfile` 模块中的一个目录穿越漏洞。`extract` 和 `extractall` 函数在处理 TAR 压缩包时，如果没有进行充分的路径验证，攻击者可以在 TAR 包中构造包含 `..` (dot dot) 序列的文件名，从而将文件解压到任意目录，覆盖或创建文件。根据搜索结果，该漏洞影响大量开源项目，修复不当可能导致绕过。

提供的 POC 代码旨在演示对 Trellix 补丁的绕过，该补丁尝试通过 `is_within_directory` 函数来防止目录穿越。POC 通过创建一个包含符号链接的 TAR 包，绕过 `is_within_directory` 的检查，因为该检查只验证了解压路径是否在目标目录内，而没有考虑到符号链接可能指向外部目录。

利用方式：
1.  攻击者构造包含恶意文件（文件名包含 `..` 序列或符号链接）的 TAR 压缩包。
2.  受害者使用存在漏洞的 `tarfile.extract` 或 `tarfile.extractall` 函数解压该压缩包。
3.  恶意文件被解压到攻击者指定的任意位置，可能覆盖系统文件或执行恶意代码。

有效性：提供的 POC 代码（`poc.py`）和相关文件（`Dockerfile`, `README.md`）旨在演示该漏洞的利用。`poc.py` 代码定义了一个 `safe_extract` 函数，该函数旨在防止目录穿越，但会被包含符号链接的 TAR 文件绕过。`Dockerfile` 用于构建一个包含 Python 环境的 Docker 镜像，方便运行 POC 代码。

投毒风险：`poc.py` 本身是为了验证漏洞，没有明显的后门代码。`Dockerfile` 使用官方 Python 镜像，风险较低。但 `README.md` 中提及了 Trellix 的修复方案存在绕过可能，并提供了验证步骤，可能存在诱导用户在生产环境中测试的可能性。尽管没有直接的恶意代码，存在潜在的误用风险，因此投毒风险评估为10%。因为攻击者可以修改 `poc.py`，在其中添加恶意代码，或者构造包含恶意文件的 TAR 包，该文件在解压后执行恶意操作。但提供的样本仓库本身的目的不是投毒，因此比例较低。

**项目地址:** [luigigubello/trellix-tarslip-patch-bypass](https://github.com/luigigubello/trellix-tarslip-patch-bypass)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---



---

## POC #3

**来源**: [CVE-2007-4559-davidholiday_CVE-2007-4559.md](../2007/CVE-2007-4559-davidholiday_CVE-2007-4559.md)

## CVE-2007-4559 Python tarfile 目录遍历漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录遍历

**影响应用:** Python tarfile module

**危害等级:** 高危，可能导致任意文件覆盖

**影响版本:** Python 3.11.4之前版本

**利用条件:** 需要用户协助解压恶意构造的tar文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 存在于 Python 的 tarfile 模块中。当使用 extract 或 extractall 函数解压包含恶意构造的文件名的 TAR 压缩包时，攻击者可以利用目录遍历漏洞覆盖任意文件。漏洞利用方式如下：

1.  **创建恶意Tar文件：** 攻击者创建一个包含带有 '..' 序列的文件名的 tar 文件。例如，文件名可能是 '../../../../etc/passwd'。
2.  **欺骗用户解压：** 攻击者诱使用户使用存在漏洞的 Python 脚本解压该 tar 文件。
3.  **目录遍历：** 当 Python 的 tarfile 模块解压文件时，它不会正确地清理文件名中的 '..' 序列，导致文件被写入到 tar 包之外的目录，从而覆盖任意文件。

**POC代码分析：**
提供的POC代码模拟了攻击流程，展示了如何在tar文件中构造恶意路径，并通过`tarfile.extractall`或`tarfile.extract`函数进行目录遍历。

**有效性：**
POC代码有效，可以验证目录遍历漏洞。

**投毒风险：**
该仓库主要用于演示漏洞，用于论证`os.path.realpath()`在处理符号链接时存在的问题，使得在提取之前难以检测出恶意路径。 考虑到该代码仓库的主要目的是漏洞演示和验证，以及代码内容相对简单直接，包含恶意投毒代码的可能性较低，判断投毒风险较低，估计为10%。主要风险可能来自下载源的安全性，但代码本身隐藏恶意行为的可能性不大。

**项目地址:** [davidholiday/CVE-2007-4559](https://github.com/davidholiday/CVE-2007-4559)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---

## POC #4

**来源**: [CVE-2007-4559-depers-rus_CVE-2007-4559.md](../2007/CVE-2007-4559-depers-rus_CVE-2007-4559.md)

## CVE-2007-4559-Python tarfile 目录遍历漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录遍历

**影响应用:** Python tarfile module

**危害等级:** 高危，可能导致任意文件覆盖和远程代码执行

**影响版本:** 受影响版本未知，但漏洞存在时间长，修复不及时

**利用条件:** 用户需要解压恶意构造的TAR文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 存在于 Python 的 tarfile 模块中。当使用 `extract()` 或 `extractall()` 函数解压 TAR 文件时，如果 TAR 文件中包含带有 `..` 序列的文件名（例如 `../../../../etc/passwd`），则可能导致目录遍历漏洞。这使得攻击者可以将文件写入到目标系统上的任意位置，从而覆盖敏感文件、执行恶意代码等。

**有效性：**
提供的 PoC 代码 `CVE-2007-4559-PoC.py` 旨在演示此漏洞。它创建了一个包含恶意路径的 TAR 文件，并尝试将其解压到 `/tmp/passwd.etc`。代码会检查文件是否成功解压，从而确认漏洞的存在。根据代码逻辑和漏洞描述，该 PoC 代码是有效的。

**投毒风险：**
虽然 PoC 代码本身用于演示漏洞，但仍然需要评估该代码是否存在投毒风险。风险评估如下:

*   **Payload 功能明确:** PoC 脚本目的在于利用目录遍历漏洞，将特定内容写入`/tmp/passwd.etc`。
*   **行为可控:** 脚本的行为相对明确和可控，即创建恶意tar包，解压到指定位置，并检查结果。
*   **代码量少:** 代码量相对较少，容易审核。

虽然PoC本身的目的不是投毒，但是如果有人利用此代码传播恶意软件，那么以下几个方面可能存在潜在风险：
1. 修改目标文件路径：攻击者可以修改`danger_file`变量，将恶意文件写入更关键的系统文件，例如修改`/etc/rc.local`实现开机自启动，或者覆盖web服务器的配置文件等，从而实现更高级的攻击。
2. 植入恶意代码：攻击者可以在写入的文件内容中植入恶意代码，例如webshell、反弹shell脚本等，进一步控制受害者系统。
3. 捆绑其他恶意脚本：将PoC脚本与其他恶意脚本捆绑在一起，形成更复杂的攻击链。

考虑到以上潜在风险，以及代码创建tar包并解压的特性，存在一定的被修改后用于恶意用途的风险。因此，将投毒风险评估为10%。

**利用方式：**
1.  **构造恶意 TAR 文件：** 攻击者创建一个包含带有 `..` 序列的文件名的 TAR 文件。
2.  **诱骗用户解压：** 攻击者通过某种方式（例如，通过电子邮件、网站等）将恶意 TAR 文件发送给用户，并诱骗用户使用存在漏洞的 `tarfile.extract()` 或 `extractall()` 函数进行解压。用户可能被欺骗是因为他们信任来源或不了解潜在风险。
3.  **利用目录遍历：** 当用户解压恶意 TAR 文件时，`tarfile` 模块会尝试将文件提取到 TAR 文件中指定的路径。由于存在 `..` 序列，`tarfile` 模块可能会将文件提取到目标系统上的任意位置。
4.  **覆盖或创建恶意文件：** 攻击者利用目录遍历漏洞，将恶意文件写入到目标系统上的敏感位置，例如覆盖系统配置文件、Web 服务器文件等。或者创建一个可以执行的恶意文件。
5.  **控制系统：** 通过覆盖敏感文件或创建恶意文件，攻击者最终可以控制目标系统。

**项目地址:** [depers-rus/CVE-2007-4559](https://github.com/depers-rus/CVE-2007-4559)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---

## POC #5

**来源**: [CVE-2007-4559-luigigubello_trellix-tarslip-patch-bypass.md](../2007/CVE-2007-4559-luigigubello_trellix-tarslip-patch-bypass.md)

## CVE-2007-4559 Python tarfile 目录穿越漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录穿越

**影响应用:** Python tarfile 模块

**危害等级:** 高危，允许攻击者覆盖任意文件

**影响版本:** 受影响版本：Python tarfile module

**利用条件:** 用户需要解压恶意构造的 TAR 压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 是 Python `tarfile` 模块中的一个目录穿越漏洞。`extract` 和 `extractall` 函数在处理 TAR 压缩包时，如果没有进行充分的路径验证，攻击者可以在 TAR 包中构造包含 `..` (dot dot) 序列的文件名，从而将文件解压到任意目录，覆盖或创建文件。根据搜索结果，该漏洞影响大量开源项目，修复不当可能导致绕过。

提供的 POC 代码旨在演示对 Trellix 补丁的绕过，该补丁尝试通过 `is_within_directory` 函数来防止目录穿越。POC 通过创建一个包含符号链接的 TAR 包，绕过 `is_within_directory` 的检查，因为该检查只验证了解压路径是否在目标目录内，而没有考虑到符号链接可能指向外部目录。

利用方式：
1.  攻击者构造包含恶意文件（文件名包含 `..` 序列或符号链接）的 TAR 压缩包。
2.  受害者使用存在漏洞的 `tarfile.extract` 或 `tarfile.extractall` 函数解压该压缩包。
3.  恶意文件被解压到攻击者指定的任意位置，可能覆盖系统文件或执行恶意代码。

有效性：提供的 POC 代码（`poc.py`）和相关文件（`Dockerfile`, `README.md`）旨在演示该漏洞的利用。`poc.py` 代码定义了一个 `safe_extract` 函数，该函数旨在防止目录穿越，但会被包含符号链接的 TAR 文件绕过。`Dockerfile` 用于构建一个包含 Python 环境的 Docker 镜像，方便运行 POC 代码。

投毒风险：`poc.py` 本身是为了验证漏洞，没有明显的后门代码。`Dockerfile` 使用官方 Python 镜像，风险较低。但 `README.md` 中提及了 Trellix 的修复方案存在绕过可能，并提供了验证步骤，可能存在诱导用户在生产环境中测试的可能性。尽管没有直接的恶意代码，存在潜在的误用风险，因此投毒风险评估为10%。因为攻击者可以修改 `poc.py`，在其中添加恶意代码，或者构造包含恶意文件的 TAR 包，该文件在解压后执行恶意操作。但提供的样本仓库本身的目的不是投毒，因此比例较低。

**项目地址:** [luigigubello/trellix-tarslip-patch-bypass](https://github.com/luigigubello/trellix-tarslip-patch-bypass)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---



---

## POC #3

**来源**: [CVE-2007-4559-davidholiday_CVE-2007-4559.md](../2007/CVE-2007-4559-davidholiday_CVE-2007-4559.md)

## CVE-2007-4559 Python tarfile 目录遍历漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录遍历

**影响应用:** Python tarfile module

**危害等级:** 高危，可能导致任意文件覆盖

**影响版本:** Python 3.11.4之前版本

**利用条件:** 需要用户协助解压恶意构造的tar文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 存在于 Python 的 tarfile 模块中。当使用 extract 或 extractall 函数解压包含恶意构造的文件名的 TAR 压缩包时，攻击者可以利用目录遍历漏洞覆盖任意文件。漏洞利用方式如下：

1.  **创建恶意Tar文件：** 攻击者创建一个包含带有 '..' 序列的文件名的 tar 文件。例如，文件名可能是 '../../../../etc/passwd'。
2.  **欺骗用户解压：** 攻击者诱使用户使用存在漏洞的 Python 脚本解压该 tar 文件。
3.  **目录遍历：** 当 Python 的 tarfile 模块解压文件时，它不会正确地清理文件名中的 '..' 序列，导致文件被写入到 tar 包之外的目录，从而覆盖任意文件。

**POC代码分析：**
提供的POC代码模拟了攻击流程，展示了如何在tar文件中构造恶意路径，并通过`tarfile.extractall`或`tarfile.extract`函数进行目录遍历。

**有效性：**
POC代码有效，可以验证目录遍历漏洞。

**投毒风险：**
该仓库主要用于演示漏洞，用于论证`os.path.realpath()`在处理符号链接时存在的问题，使得在提取之前难以检测出恶意路径。 考虑到该代码仓库的主要目的是漏洞演示和验证，以及代码内容相对简单直接，包含恶意投毒代码的可能性较低，判断投毒风险较低，估计为10%。主要风险可能来自下载源的安全性，但代码本身隐藏恶意行为的可能性不大。

**项目地址:** [davidholiday/CVE-2007-4559](https://github.com/davidholiday/CVE-2007-4559)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---

## POC #4

**来源**: [CVE-2007-4559-depers-rus_CVE-2007-4559.md](../2007/CVE-2007-4559-depers-rus_CVE-2007-4559.md)

## CVE-2007-4559-Python tarfile 目录遍历漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录遍历

**影响应用:** Python tarfile module

**危害等级:** 高危，可能导致任意文件覆盖和远程代码执行

**影响版本:** 受影响版本未知，但漏洞存在时间长，修复不及时

**利用条件:** 用户需要解压恶意构造的TAR文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 存在于 Python 的 tarfile 模块中。当使用 `extract()` 或 `extractall()` 函数解压 TAR 文件时，如果 TAR 文件中包含带有 `..` 序列的文件名（例如 `../../../../etc/passwd`），则可能导致目录遍历漏洞。这使得攻击者可以将文件写入到目标系统上的任意位置，从而覆盖敏感文件、执行恶意代码等。

**有效性：**
提供的 PoC 代码 `CVE-2007-4559-PoC.py` 旨在演示此漏洞。它创建了一个包含恶意路径的 TAR 文件，并尝试将其解压到 `/tmp/passwd.etc`。代码会检查文件是否成功解压，从而确认漏洞的存在。根据代码逻辑和漏洞描述，该 PoC 代码是有效的。

**投毒风险：**
虽然 PoC 代码本身用于演示漏洞，但仍然需要评估该代码是否存在投毒风险。风险评估如下:

*   **Payload 功能明确:** PoC 脚本目的在于利用目录遍历漏洞，将特定内容写入`/tmp/passwd.etc`。
*   **行为可控:** 脚本的行为相对明确和可控，即创建恶意tar包，解压到指定位置，并检查结果。
*   **代码量少:** 代码量相对较少，容易审核。

虽然PoC本身的目的不是投毒，但是如果有人利用此代码传播恶意软件，那么以下几个方面可能存在潜在风险：
1. 修改目标文件路径：攻击者可以修改`danger_file`变量，将恶意文件写入更关键的系统文件，例如修改`/etc/rc.local`实现开机自启动，或者覆盖web服务器的配置文件等，从而实现更高级的攻击。
2. 植入恶意代码：攻击者可以在写入的文件内容中植入恶意代码，例如webshell、反弹shell脚本等，进一步控制受害者系统。
3. 捆绑其他恶意脚本：将PoC脚本与其他恶意脚本捆绑在一起，形成更复杂的攻击链。

考虑到以上潜在风险，以及代码创建tar包并解压的特性，存在一定的被修改后用于恶意用途的风险。因此，将投毒风险评估为10%。

**利用方式：**
1.  **构造恶意 TAR 文件：** 攻击者创建一个包含带有 `..` 序列的文件名的 TAR 文件。
2.  **诱骗用户解压：** 攻击者通过某种方式（例如，通过电子邮件、网站等）将恶意 TAR 文件发送给用户，并诱骗用户使用存在漏洞的 `tarfile.extract()` 或 `extractall()` 函数进行解压。用户可能被欺骗是因为他们信任来源或不了解潜在风险。
3.  **利用目录遍历：** 当用户解压恶意 TAR 文件时，`tarfile` 模块会尝试将文件提取到 TAR 文件中指定的路径。由于存在 `..` 序列，`tarfile` 模块可能会将文件提取到目标系统上的任意位置。
4.  **覆盖或创建恶意文件：** 攻击者利用目录遍历漏洞，将恶意文件写入到目标系统上的敏感位置，例如覆盖系统配置文件、Web 服务器文件等。或者创建一个可以执行的恶意文件。
5.  **控制系统：** 通过覆盖敏感文件或创建恶意文件，攻击者最终可以控制目标系统。

**项目地址:** [depers-rus/CVE-2007-4559](https://github.com/depers-rus/CVE-2007-4559)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---

## POC #5

**来源**: [CVE-2007-4559-luigigubello_trellix-tarslip-patch-bypass.md](../2007/CVE-2007-4559-luigigubello_trellix-tarslip-patch-bypass.md)

## CVE-2007-4559 Python tarfile 目录穿越漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录穿越

**影响应用:** Python tarfile 模块

**危害等级:** 高危，允许攻击者覆盖任意文件

**影响版本:** 受影响版本：Python tarfile module

**利用条件:** 用户需要解压恶意构造的 TAR 压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 是 Python `tarfile` 模块中的一个目录穿越漏洞。`extract` 和 `extractall` 函数在处理 TAR 压缩包时，如果没有进行充分的路径验证，攻击者可以在 TAR 包中构造包含 `..` (dot dot) 序列的文件名，从而将文件解压到任意目录，覆盖或创建文件。根据搜索结果，该漏洞影响大量开源项目，修复不当可能导致绕过。

提供的 POC 代码旨在演示对 Trellix 补丁的绕过，该补丁尝试通过 `is_within_directory` 函数来防止目录穿越。POC 通过创建一个包含符号链接的 TAR 包，绕过 `is_within_directory` 的检查，因为该检查只验证了解压路径是否在目标目录内，而没有考虑到符号链接可能指向外部目录。

利用方式：
1.  攻击者构造包含恶意文件（文件名包含 `..` 序列或符号链接）的 TAR 压缩包。
2.  受害者使用存在漏洞的 `tarfile.extract` 或 `tarfile.extractall` 函数解压该压缩包。
3.  恶意文件被解压到攻击者指定的任意位置，可能覆盖系统文件或执行恶意代码。

有效性：提供的 POC 代码（`poc.py`）和相关文件（`Dockerfile`, `README.md`）旨在演示该漏洞的利用。`poc.py` 代码定义了一个 `safe_extract` 函数，该函数旨在防止目录穿越，但会被包含符号链接的 TAR 文件绕过。`Dockerfile` 用于构建一个包含 Python 环境的 Docker 镜像，方便运行 POC 代码。

投毒风险：`poc.py` 本身是为了验证漏洞，没有明显的后门代码。`Dockerfile` 使用官方 Python 镜像，风险较低。但 `README.md` 中提及了 Trellix 的修复方案存在绕过可能，并提供了验证步骤，可能存在诱导用户在生产环境中测试的可能性。尽管没有直接的恶意代码，存在潜在的误用风险，因此投毒风险评估为10%。因为攻击者可以修改 `poc.py`，在其中添加恶意代码，或者构造包含恶意文件的 TAR 包，该文件在解压后执行恶意操作。但提供的样本仓库本身的目的不是投毒，因此比例较低。

**项目地址:** [luigigubello/trellix-tarslip-patch-bypass](https://github.com/luigigubello/trellix-tarslip-patch-bypass)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---



---

## POC #3

**来源**: [CVE-2007-4559-davidholiday_CVE-2007-4559.md](../2007/CVE-2007-4559-davidholiday_CVE-2007-4559.md)

## CVE-2007-4559 Python tarfile 目录遍历漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录遍历

**影响应用:** Python tarfile module

**危害等级:** 高危，可能导致任意文件覆盖

**影响版本:** Python 3.11.4之前版本

**利用条件:** 需要用户协助解压恶意构造的tar文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 存在于 Python 的 tarfile 模块中。当使用 extract 或 extractall 函数解压包含恶意构造的文件名的 TAR 压缩包时，攻击者可以利用目录遍历漏洞覆盖任意文件。漏洞利用方式如下：

1.  **创建恶意Tar文件：** 攻击者创建一个包含带有 '..' 序列的文件名的 tar 文件。例如，文件名可能是 '../../../../etc/passwd'。
2.  **欺骗用户解压：** 攻击者诱使用户使用存在漏洞的 Python 脚本解压该 tar 文件。
3.  **目录遍历：** 当 Python 的 tarfile 模块解压文件时，它不会正确地清理文件名中的 '..' 序列，导致文件被写入到 tar 包之外的目录，从而覆盖任意文件。

**POC代码分析：**
提供的POC代码模拟了攻击流程，展示了如何在tar文件中构造恶意路径，并通过`tarfile.extractall`或`tarfile.extract`函数进行目录遍历。

**有效性：**
POC代码有效，可以验证目录遍历漏洞。

**投毒风险：**
该仓库主要用于演示漏洞，用于论证`os.path.realpath()`在处理符号链接时存在的问题，使得在提取之前难以检测出恶意路径。 考虑到该代码仓库的主要目的是漏洞演示和验证，以及代码内容相对简单直接，包含恶意投毒代码的可能性较低，判断投毒风险较低，估计为10%。主要风险可能来自下载源的安全性，但代码本身隐藏恶意行为的可能性不大。

**项目地址:** [davidholiday/CVE-2007-4559](https://github.com/davidholiday/CVE-2007-4559)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---

## POC #4

**来源**: [CVE-2007-4559-depers-rus_CVE-2007-4559.md](../2007/CVE-2007-4559-depers-rus_CVE-2007-4559.md)

## CVE-2007-4559-Python tarfile 目录遍历漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录遍历

**影响应用:** Python tarfile module

**危害等级:** 高危，可能导致任意文件覆盖和远程代码执行

**影响版本:** 受影响版本未知，但漏洞存在时间长，修复不及时

**利用条件:** 用户需要解压恶意构造的TAR文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 存在于 Python 的 tarfile 模块中。当使用 `extract()` 或 `extractall()` 函数解压 TAR 文件时，如果 TAR 文件中包含带有 `..` 序列的文件名（例如 `../../../../etc/passwd`），则可能导致目录遍历漏洞。这使得攻击者可以将文件写入到目标系统上的任意位置，从而覆盖敏感文件、执行恶意代码等。

**有效性：**
提供的 PoC 代码 `CVE-2007-4559-PoC.py` 旨在演示此漏洞。它创建了一个包含恶意路径的 TAR 文件，并尝试将其解压到 `/tmp/passwd.etc`。代码会检查文件是否成功解压，从而确认漏洞的存在。根据代码逻辑和漏洞描述，该 PoC 代码是有效的。

**投毒风险：**
虽然 PoC 代码本身用于演示漏洞，但仍然需要评估该代码是否存在投毒风险。风险评估如下:

*   **Payload 功能明确:** PoC 脚本目的在于利用目录遍历漏洞，将特定内容写入`/tmp/passwd.etc`。
*   **行为可控:** 脚本的行为相对明确和可控，即创建恶意tar包，解压到指定位置，并检查结果。
*   **代码量少:** 代码量相对较少，容易审核。

虽然PoC本身的目的不是投毒，但是如果有人利用此代码传播恶意软件，那么以下几个方面可能存在潜在风险：
1. 修改目标文件路径：攻击者可以修改`danger_file`变量，将恶意文件写入更关键的系统文件，例如修改`/etc/rc.local`实现开机自启动，或者覆盖web服务器的配置文件等，从而实现更高级的攻击。
2. 植入恶意代码：攻击者可以在写入的文件内容中植入恶意代码，例如webshell、反弹shell脚本等，进一步控制受害者系统。
3. 捆绑其他恶意脚本：将PoC脚本与其他恶意脚本捆绑在一起，形成更复杂的攻击链。

考虑到以上潜在风险，以及代码创建tar包并解压的特性，存在一定的被修改后用于恶意用途的风险。因此，将投毒风险评估为10%。

**利用方式：**
1.  **构造恶意 TAR 文件：** 攻击者创建一个包含带有 `..` 序列的文件名的 TAR 文件。
2.  **诱骗用户解压：** 攻击者通过某种方式（例如，通过电子邮件、网站等）将恶意 TAR 文件发送给用户，并诱骗用户使用存在漏洞的 `tarfile.extract()` 或 `extractall()` 函数进行解压。用户可能被欺骗是因为他们信任来源或不了解潜在风险。
3.  **利用目录遍历：** 当用户解压恶意 TAR 文件时，`tarfile` 模块会尝试将文件提取到 TAR 文件中指定的路径。由于存在 `..` 序列，`tarfile` 模块可能会将文件提取到目标系统上的任意位置。
4.  **覆盖或创建恶意文件：** 攻击者利用目录遍历漏洞，将恶意文件写入到目标系统上的敏感位置，例如覆盖系统配置文件、Web 服务器文件等。或者创建一个可以执行的恶意文件。
5.  **控制系统：** 通过覆盖敏感文件或创建恶意文件，攻击者最终可以控制目标系统。

**项目地址:** [depers-rus/CVE-2007-4559](https://github.com/depers-rus/CVE-2007-4559)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---

## POC #5

**来源**: [CVE-2007-4559-luigigubello_trellix-tarslip-patch-bypass.md](../2007/CVE-2007-4559-luigigubello_trellix-tarslip-patch-bypass.md)

## CVE-2007-4559 Python tarfile 目录穿越漏洞

**漏洞编号:** CVE-2007-4559

**漏洞类型:** 目录穿越

**影响应用:** Python tarfile 模块

**危害等级:** 高危，允许攻击者覆盖任意文件

**影响版本:** 受影响版本：Python tarfile module

**利用条件:** 用户需要解压恶意构造的 TAR 压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-4559 是 Python `tarfile` 模块中的一个目录穿越漏洞。`extract` 和 `extractall` 函数在处理 TAR 压缩包时，如果没有进行充分的路径验证，攻击者可以在 TAR 包中构造包含 `..` (dot dot) 序列的文件名，从而将文件解压到任意目录，覆盖或创建文件。根据搜索结果，该漏洞影响大量开源项目，修复不当可能导致绕过。

提供的 POC 代码旨在演示对 Trellix 补丁的绕过，该补丁尝试通过 `is_within_directory` 函数来防止目录穿越。POC 通过创建一个包含符号链接的 TAR 包，绕过 `is_within_directory` 的检查，因为该检查只验证了解压路径是否在目标目录内，而没有考虑到符号链接可能指向外部目录。

利用方式：
1.  攻击者构造包含恶意文件（文件名包含 `..` 序列或符号链接）的 TAR 压缩包。
2.  受害者使用存在漏洞的 `tarfile.extract` 或 `tarfile.extractall` 函数解压该压缩包。
3.  恶意文件被解压到攻击者指定的任意位置，可能覆盖系统文件或执行恶意代码。

有效性：提供的 POC 代码（`poc.py`）和相关文件（`Dockerfile`, `README.md`）旨在演示该漏洞的利用。`poc.py` 代码定义了一个 `safe_extract` 函数，该函数旨在防止目录穿越，但会被包含符号链接的 TAR 文件绕过。`Dockerfile` 用于构建一个包含 Python 环境的 Docker 镜像，方便运行 POC 代码。

投毒风险：`poc.py` 本身是为了验证漏洞，没有明显的后门代码。`Dockerfile` 使用官方 Python 镜像，风险较低。但 `README.md` 中提及了 Trellix 的修复方案存在绕过可能，并提供了验证步骤，可能存在诱导用户在生产环境中测试的可能性。尽管没有直接的恶意代码，存在潜在的误用风险，因此投毒风险评估为10%。因为攻击者可以修改 `poc.py`，在其中添加恶意代码，或者构造包含恶意文件的 TAR 包，该文件在解压后执行恶意操作。但提供的样本仓库本身的目的不是投毒，因此比例较低。

**项目地址:** [luigigubello/trellix-tarslip-patch-bypass](https://github.com/luigigubello/trellix-tarslip-patch-bypass)

**漏洞详情:** [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)

---

