# CVE-2023-51385

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-51385-2048JiaLi_CVE-2023-51385.md](../2023/CVE-2023-51385-2048JiaLi_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要存在受影响的OpenSSH版本，并且用户或主机名包含shell元字符，在特定配置下触发ProxyCommand等功能。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-51385是OpenSSH中的一个命令注入漏洞。当用户名或主机名包含shell元字符时，且这些名称被特定情况下的扩展标记引用，就可能发生操作系统命令注入。例如，一个不受信任的Git仓库可能有一个子模块，其用户名或主机名中包含shell元字符。根据提供的POC代码，该代码尝试在`/var/www/html/flag`文件中写入'hello'。如果目标系统配置允许写入该文件，并且利用成功触发了命令注入，则POC有效。但是，这个POC本身并不具有明显的恶意投毒行为。更高级的利用可能涉及更复杂的payload，比如反弹shell。

利用方式：

1.  **恶意Git仓库:** 创建一个包含恶意子模块的Git仓库，该子模块的用户名或主机名包含shell元字符。
2.  **配置ProxyCommand:** 在`~/.ssh/config`文件中配置`ProxyCommand`选项，使其引用包含shell元字符的用户名或主机名。
3.  **触发漏洞:** 当OpenSSH处理这些配置时，由于shell元字符未正确转义，导致命令注入。
4.  **执行任意命令:** 攻击者可以利用命令注入执行任意操作系统命令。

**项目地址:** [2048JiaLi/CVE-2023-51385](https://github.com/2048JiaLi/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #2

**来源**: [CVE-2023-51385-Featherw1t_CVE-2023-51385_test.md](../2023/CVE-2023-51385-Featherw1t_CVE-2023-51385_test.md)

## CVE-2023-51385 OpenSSH 命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标主机使用受影响的OpenSSH版本，且`~/.ssh/config`文件中存在可利用的ProxyCommand配置或使用包含恶意构造的git submodule的git仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 Shell 元字符，并且这些名称在某些情况下被扩展令牌引用时，可能发生操作系统命令注入。漏洞利用方式是：

1.  **配置ProxyCommand：** 在 `~/.ssh/config` 文件中设置 `ProxyCommand`，其中包含恶意构造的命令。POC提供了一个使用`nc`命令的例子。
2.  **Git submodule 注入：**  攻击者可以创建一个包含恶意构造的 `.gitmodules` 文件的 Git 仓库。该文件中的 `url` 字段包含 shell 元字符，当用户尝试克隆该仓库并初始化子模块时，`git clone --recurse-submodules`命令会触发命令注入。

根据提供的POC代码，攻击者可以通过构造恶意的用户名或主机名（例如在 Git 子模块的 URL 中）来执行任意命令。

**有效性：** 提供的POC代码是有效的，因为它展示了如何利用该漏洞通过精心构造的Git仓库来触发命令注入。

**投毒风险：**

此仓库可能存在投毒风险，因为攻击者可能在`git clone`下来的脚本或者git仓库本身中加入恶意代码。风险评估为10%，因为提供的代码片段主要集中在漏洞利用上，但不能完全排除仓库作者在其他地方隐藏恶意代码的可能性。尤其需要关注通过`git clone --recurse-submodules`下载的其他脚本和文件。

**项目地址:** [Featherw1t/CVE-2023-51385_test](https://github.com/Featherw1t/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #3

**来源**: [CVE-2023-51385-Le1a_CVE-2023-51385.md](../2023/CVE-2023-51385-Le1a_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含shell元字符，且在特定情况下被扩展令牌引用。需要配置ProxyCommand。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH中的一个命令注入漏洞，存在于9.6版本之前。漏洞的根本原因是当用户名或主机名包含shell元字符时，如果这些名称在某些情况下被扩展令牌引用，可能导致操作系统命令注入。

**有效性：**

根据漏洞描述和提供的POC代码，该漏洞是有效的。POC代码演示了当ProxyCommand配置为`/usr/bin/nc -X connect -x 127.0.0.1:7890 %h %p`时，通过克隆包含恶意子模块（子模块的用户名或主机名包含shell元字符）的Git仓库，可以触发命令注入。

**投毒风险：**

提供的POC代码非常简洁，主要是通过`git clone`命令触发漏洞。直接在提供的`README.md`和命令中发现明显投毒代码的可能性较低。 但`git clone --recurse-submodules`本身会执行子模块中定义的操作，因此子模块本身的内容可能会包含恶意代码，但这不是漏洞利用代码本身的问题，而是Git子模块机制带来的风险。因此，判定投毒风险为10%，主要考虑子模块可能包含恶意代码的可能性。

**利用方式：**

1.  **配置ProxyCommand：** 首先，用户需要在`~/.ssh/config`文件中配置`ProxyCommand`，例如：

    ```
    Host *.com
      ProxyCommand /usr/bin/nc -X connect -x 127.0.0.1:7890 %h %p
    ```

2.  **克隆恶意Git仓库：** 攻击者创建一个包含恶意子模块的Git仓库。恶意子模块的URL包含shell元字符，例如，用户名或主机名包含反引号、美元符号等。

3.  **触发命令注入：** 当用户使用`git clone --recurse-submodules`克隆该恶意仓库时，Git会自动初始化和更新子模块。在处理恶意子模块的URL时，OpenSSH会对其进行不正确的转义，导致shell元字符被解释执行，从而实现命令注入。

**总结：**

此漏洞的利用依赖于特定的OpenSSH配置（`ProxyCommand`）和恶意的Git仓库。攻击者通过控制Git仓库中的子模块URL，可以注入任意命令。修复此漏洞的方法是升级到OpenSSH 9.6或更高版本，或者避免在用户名或主机名中使用shell元字符。

**项目地址:** [Le1a/CVE-2023-51385](https://github.com/Le1a/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #4

**来源**: [CVE-2023-51385-LtmThink_CVE-2023-51385_test.md](../2023/CVE-2023-51385-LtmThink_CVE-2023-51385_test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6p1

**利用条件:** 需要用户clone包含恶意.gitmodules的git仓库，并配置ssh config中的ProxyCommand。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。该漏洞是由于 OpenSSH 在处理用户名或主机名中包含 Shell 元字符时，没有进行充分的过滤，导致可以通过特定的扩展令牌进行操作系统命令注入。

**利用方式：**
1.  **恶意 Git 仓库：** 攻击者创建一个包含恶意 `.gitmodules` 文件的 Git 仓库。该文件中的 `url` 字段包含恶意命令，例如：
    ```
    url = ssh://`echo helloworld > cve.txt`foo.example.com/bar
    ```
2.  **SSH 配置：** 受害者需要在 `~/.ssh/config` 文件中设置 `ProxyCommand` 指令，并匹配恶意域名，例如：
    ```
    host *.example.com
      ProxyCommand /usr/bin/nc -X connect -x 192.0.2.0:8080 %h %p
    ```
3.  **触发漏洞：** 受害者使用 `git clone --recurse-submodules` 命令克隆恶意 Git 仓库，`--recurse-submodules` 选项会导致 Git 读取 `.gitmodules` 文件，并执行其中 `url` 字段中的恶意命令，从而实现远程代码执行。

**有效性：**
提供的POC代码有效，已经验证可以触发命令执行。

**投毒风险：**
该仓库主要用于漏洞验证，虽然作者在博客中公开了漏洞原理，并且提供了验证代码，但是依然存在一定的投毒风险，例如：

1.  **利用代码本身：**  `ProxyCommand`  配置需要用户手动设置，如果攻击者提供一个包含更复杂、更隐蔽的命令注入payload的 `.gitmodules` 文件，用户在不知情的情况下克隆该仓库，可能会被植入后门或者执行其他恶意操作。
2.  **利用关联仓库：** 攻击者可能在看似无害的其他文件中隐藏恶意代码，例如图片，或者其他git hook脚本。如果用户不仔细检查，可能会忽略这些恶意代码。

考虑到以上因素，初步判断投毒风险为10%。

**项目地址:** [LtmThink/CVE-2023-51385_test](https://github.com/LtmThink/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #5

**来源**: [CVE-2023-51385-MiningBot-eth_CVE-2023-51385-exploit.md](../2023/CVE-2023-51385-MiningBot-eth_CVE-2023-51385-exploit.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要受害者使用受污染的用户名或主机名连接到攻击者控制的服务器，或者受害者访问包含恶意子模块的 Git 仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符时，可能发生操作系统命令注入。例如，如果一个不受信任的 Git 仓库有一个子模块，该子模块的用户名或主机名包含 shell 元字符，则可能触发此漏洞。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意配置的 Git 仓库，其中子模块的用户名或主机名包含 shell 元字符。
2.  或者，攻击者控制一个 SSH 服务器，并设置包含恶意 shell 元字符的用户名或主机名。
3.  受害者克隆恶意 Git 仓库或使用易受攻击的 OpenSSH 客户端连接到攻击者控制的 SSH 服务器。
4.  OpenSSH 在处理用户名或主机名时，由于未正确转义 shell 元字符，导致命令注入，执行攻击者控制的恶意命令。

**有效性：**
根据漏洞描述和搜索结果，此漏洞是有效的。许多安全厂商和组织都发布了关于此漏洞的公告和修复建议。

**投毒风险：**
提供的 POC 代码 `/tmp/d37649a81685a000f41564edc2078d9f/README.md` 仅仅包含了一个 README.md 文件，内容为 `# CVE-2023-51385-exploit`。 虽然这个文件本身不包含任何恶意代码，但不能完全排除整个仓库中存在其他隐藏的投毒代码的可能性。假设仓库中存在其他恶意脚本或配置文件的可能性是 10%。 这个README文件仅仅是声明，没有体现exp代码，无法验证漏洞。


**项目地址:** [MiningBot-eth/CVE-2023-51385-exploit](https://github.com/MiningBot-eth/CVE-2023-51385-exploit)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #6

**来源**: [CVE-2023-51385-WLaoDuo_CVE-2023-51385_poc-test.md](../2023/CVE-2023-51385-WLaoDuo_CVE-2023-51385_poc-test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 目标用户使用了受影响的OpenSSH版本，并且配置了ProxyCommand，clone包含恶意配置的git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。当用户名或主机名包含shell元字符，并且该名称在某些情况下被扩展标记引用时，可能会发生操作系统命令注入。POC利用方式是通过精心构造包含恶意配置的Git仓库，当用户clone该仓库时，其中的子模块配置会触发ProxyCommand中的命令注入，从而执行攻击者预设的恶意命令。用户需要编辑ssh config，添加proxycommand，然后clone指定的git仓库，触发弹窗。投毒风险主要来自于作者可能在仓库中添加额外的恶意代码，例如在README.md中嵌入恶意链接，或者在其他看似无害的文件中隐藏Payload，但是从作者公布的演示视频和简单的代码来看，概率较低。

**项目地址:** [WLaoDuo/CVE-2023-51385_poc-test](https://github.com/WLaoDuo/CVE-2023-51385_poc-test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #7

**来源**: [CVE-2023-51385-WOOOOONG_CVE-2023-51385.md](../2023/CVE-2023-51385-WOOOOONG_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要用户名或主机名包含shell元字符，并且被expansion token引用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中存在的一个命令注入漏洞。当用户名或主机名包含 shell 元字符，并且这个名字在特定情况下被 expansion token 引用时，可能发生操作系统命令注入。例如，一个不受信任的 Git 仓库可能包含一个子模块，其用户名或主机名中包含 shell 元字符。PoC代码只包含README文件，没有实际的验证后门代码，因此判断投毒概率较低。但如果攻击者使用该 PoC 并修改相关代码，则可能存在投毒风险。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞确实存在，并且影响 OpenSSH 9.6 之前的版本。提供的 PoC 代码仅仅是一个 README 文件，只包含漏洞名称，没有实际的漏洞利用代码。因此，提供的PoC代码本身**不具备**直接的漏洞利用有效性，需要进一步开发利用代码。

**投毒风险：**
因为提供的 PoC 只是一个 README 文件，因此**不存在**明显的投毒代码。可以认为投毒的风险很低，接近0%。但也不能完全排除，因为这个仓库可能后续被修改，添加恶意代码。
综合考虑，给出的投毒风险为1%。

**利用方式：**
利用此漏洞的一种方法是，攻击者可以创建一个包含恶意子模块的 Git 仓库。该子模块的用户名或主机名包含 shell 元字符。当用户尝试克隆包含此子模块的仓库时，OpenSSH 可能会执行恶意命令。具体步骤如下：

1.  创建一个包含恶意子模块的 Git 仓库。
2.  确保子模块的用户名或主机名包含 shell 元字符，例如反引号 (`) 或美元符号 ($)。
3.  诱使用户克隆该仓库。
4.  当 OpenSSH 处理子模块信息时，由于存在命令注入漏洞，恶意命令将被执行。

另一种利用方式是通过 `ProxyCommand` 指令。攻击者可以配置 SSH 客户端，使其使用包含恶意 shell 元字符的用户名或主机名连接到目标服务器。当 OpenSSH 执行 `ProxyCommand` 时，恶意命令将被执行。

**优先级排序:**
搜索引擎结果 > 漏洞库信息 > 漏洞利用代码(因为提供的POC没有任何实质性代码)


**项目地址:** [WOOOOONG/CVE-2023-51385](https://github.com/WOOOOONG/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #8

**来源**: [CVE-2023-51385-c0deur_CVE-2023-51385.md](../2023/CVE-2023-51385-c0deur_CVE-2023-51385.md)

# CVE-2023-51385

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-51385-2048JiaLi_CVE-2023-51385.md](../2023/CVE-2023-51385-2048JiaLi_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要存在受影响的OpenSSH版本，并且用户或主机名包含shell元字符，在特定配置下触发ProxyCommand等功能。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-51385是OpenSSH中的一个命令注入漏洞。当用户名或主机名包含shell元字符时，且这些名称被特定情况下的扩展标记引用，就可能发生操作系统命令注入。例如，一个不受信任的Git仓库可能有一个子模块，其用户名或主机名中包含shell元字符。根据提供的POC代码，该代码尝试在`/var/www/html/flag`文件中写入'hello'。如果目标系统配置允许写入该文件，并且利用成功触发了命令注入，则POC有效。但是，这个POC本身并不具有明显的恶意投毒行为。更高级的利用可能涉及更复杂的payload，比如反弹shell。

利用方式：

1.  **恶意Git仓库:** 创建一个包含恶意子模块的Git仓库，该子模块的用户名或主机名包含shell元字符。
2.  **配置ProxyCommand:** 在`~/.ssh/config`文件中配置`ProxyCommand`选项，使其引用包含shell元字符的用户名或主机名。
3.  **触发漏洞:** 当OpenSSH处理这些配置时，由于shell元字符未正确转义，导致命令注入。
4.  **执行任意命令:** 攻击者可以利用命令注入执行任意操作系统命令。

**项目地址:** [2048JiaLi/CVE-2023-51385](https://github.com/2048JiaLi/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #2

**来源**: [CVE-2023-51385-Featherw1t_CVE-2023-51385_test.md](../2023/CVE-2023-51385-Featherw1t_CVE-2023-51385_test.md)

## CVE-2023-51385 OpenSSH 命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标主机使用受影响的OpenSSH版本，且`~/.ssh/config`文件中存在可利用的ProxyCommand配置或使用包含恶意构造的git submodule的git仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 Shell 元字符，并且这些名称在某些情况下被扩展令牌引用时，可能发生操作系统命令注入。漏洞利用方式是：

1.  **配置ProxyCommand：** 在 `~/.ssh/config` 文件中设置 `ProxyCommand`，其中包含恶意构造的命令。POC提供了一个使用`nc`命令的例子。
2.  **Git submodule 注入：**  攻击者可以创建一个包含恶意构造的 `.gitmodules` 文件的 Git 仓库。该文件中的 `url` 字段包含 shell 元字符，当用户尝试克隆该仓库并初始化子模块时，`git clone --recurse-submodules`命令会触发命令注入。

根据提供的POC代码，攻击者可以通过构造恶意的用户名或主机名（例如在 Git 子模块的 URL 中）来执行任意命令。

**有效性：** 提供的POC代码是有效的，因为它展示了如何利用该漏洞通过精心构造的Git仓库来触发命令注入。

**投毒风险：**

此仓库可能存在投毒风险，因为攻击者可能在`git clone`下来的脚本或者git仓库本身中加入恶意代码。风险评估为10%，因为提供的代码片段主要集中在漏洞利用上，但不能完全排除仓库作者在其他地方隐藏恶意代码的可能性。尤其需要关注通过`git clone --recurse-submodules`下载的其他脚本和文件。

**项目地址:** [Featherw1t/CVE-2023-51385_test](https://github.com/Featherw1t/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #3

**来源**: [CVE-2023-51385-Le1a_CVE-2023-51385.md](../2023/CVE-2023-51385-Le1a_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含shell元字符，且在特定情况下被扩展令牌引用。需要配置ProxyCommand。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH中的一个命令注入漏洞，存在于9.6版本之前。漏洞的根本原因是当用户名或主机名包含shell元字符时，如果这些名称在某些情况下被扩展令牌引用，可能导致操作系统命令注入。

**有效性：**

根据漏洞描述和提供的POC代码，该漏洞是有效的。POC代码演示了当ProxyCommand配置为`/usr/bin/nc -X connect -x 127.0.0.1:7890 %h %p`时，通过克隆包含恶意子模块（子模块的用户名或主机名包含shell元字符）的Git仓库，可以触发命令注入。

**投毒风险：**

提供的POC代码非常简洁，主要是通过`git clone`命令触发漏洞。直接在提供的`README.md`和命令中发现明显投毒代码的可能性较低。 但`git clone --recurse-submodules`本身会执行子模块中定义的操作，因此子模块本身的内容可能会包含恶意代码，但这不是漏洞利用代码本身的问题，而是Git子模块机制带来的风险。因此，判定投毒风险为10%，主要考虑子模块可能包含恶意代码的可能性。

**利用方式：**

1.  **配置ProxyCommand：** 首先，用户需要在`~/.ssh/config`文件中配置`ProxyCommand`，例如：

    ```
    Host *.com
      ProxyCommand /usr/bin/nc -X connect -x 127.0.0.1:7890 %h %p
    ```

2.  **克隆恶意Git仓库：** 攻击者创建一个包含恶意子模块的Git仓库。恶意子模块的URL包含shell元字符，例如，用户名或主机名包含反引号、美元符号等。

3.  **触发命令注入：** 当用户使用`git clone --recurse-submodules`克隆该恶意仓库时，Git会自动初始化和更新子模块。在处理恶意子模块的URL时，OpenSSH会对其进行不正确的转义，导致shell元字符被解释执行，从而实现命令注入。

**总结：**

此漏洞的利用依赖于特定的OpenSSH配置（`ProxyCommand`）和恶意的Git仓库。攻击者通过控制Git仓库中的子模块URL，可以注入任意命令。修复此漏洞的方法是升级到OpenSSH 9.6或更高版本，或者避免在用户名或主机名中使用shell元字符。

**项目地址:** [Le1a/CVE-2023-51385](https://github.com/Le1a/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #4

**来源**: [CVE-2023-51385-LtmThink_CVE-2023-51385_test.md](../2023/CVE-2023-51385-LtmThink_CVE-2023-51385_test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6p1

**利用条件:** 需要用户clone包含恶意.gitmodules的git仓库，并配置ssh config中的ProxyCommand。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。该漏洞是由于 OpenSSH 在处理用户名或主机名中包含 Shell 元字符时，没有进行充分的过滤，导致可以通过特定的扩展令牌进行操作系统命令注入。

**利用方式：**
1.  **恶意 Git 仓库：** 攻击者创建一个包含恶意 `.gitmodules` 文件的 Git 仓库。该文件中的 `url` 字段包含恶意命令，例如：
    ```
    url = ssh://`echo helloworld > cve.txt`foo.example.com/bar
    ```
2.  **SSH 配置：** 受害者需要在 `~/.ssh/config` 文件中设置 `ProxyCommand` 指令，并匹配恶意域名，例如：
    ```
    host *.example.com
      ProxyCommand /usr/bin/nc -X connect -x 192.0.2.0:8080 %h %p
    ```
3.  **触发漏洞：** 受害者使用 `git clone --recurse-submodules` 命令克隆恶意 Git 仓库，`--recurse-submodules` 选项会导致 Git 读取 `.gitmodules` 文件，并执行其中 `url` 字段中的恶意命令，从而实现远程代码执行。

**有效性：**
提供的POC代码有效，已经验证可以触发命令执行。

**投毒风险：**
该仓库主要用于漏洞验证，虽然作者在博客中公开了漏洞原理，并且提供了验证代码，但是依然存在一定的投毒风险，例如：

1.  **利用代码本身：**  `ProxyCommand`  配置需要用户手动设置，如果攻击者提供一个包含更复杂、更隐蔽的命令注入payload的 `.gitmodules` 文件，用户在不知情的情况下克隆该仓库，可能会被植入后门或者执行其他恶意操作。
2.  **利用关联仓库：** 攻击者可能在看似无害的其他文件中隐藏恶意代码，例如图片，或者其他git hook脚本。如果用户不仔细检查，可能会忽略这些恶意代码。

考虑到以上因素，初步判断投毒风险为10%。

**项目地址:** [LtmThink/CVE-2023-51385_test](https://github.com/LtmThink/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #5

**来源**: [CVE-2023-51385-MiningBot-eth_CVE-2023-51385-exploit.md](../2023/CVE-2023-51385-MiningBot-eth_CVE-2023-51385-exploit.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要受害者使用受污染的用户名或主机名连接到攻击者控制的服务器，或者受害者访问包含恶意子模块的 Git 仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符时，可能发生操作系统命令注入。例如，如果一个不受信任的 Git 仓库有一个子模块，该子模块的用户名或主机名包含 shell 元字符，则可能触发此漏洞。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意配置的 Git 仓库，其中子模块的用户名或主机名包含 shell 元字符。
2.  或者，攻击者控制一个 SSH 服务器，并设置包含恶意 shell 元字符的用户名或主机名。
3.  受害者克隆恶意 Git 仓库或使用易受攻击的 OpenSSH 客户端连接到攻击者控制的 SSH 服务器。
4.  OpenSSH 在处理用户名或主机名时，由于未正确转义 shell 元字符，导致命令注入，执行攻击者控制的恶意命令。

**有效性：**
根据漏洞描述和搜索结果，此漏洞是有效的。许多安全厂商和组织都发布了关于此漏洞的公告和修复建议。

**投毒风险：**
提供的 POC 代码 `/tmp/d37649a81685a000f41564edc2078d9f/README.md` 仅仅包含了一个 README.md 文件，内容为 `# CVE-2023-51385-exploit`。 虽然这个文件本身不包含任何恶意代码，但不能完全排除整个仓库中存在其他隐藏的投毒代码的可能性。假设仓库中存在其他恶意脚本或配置文件的可能性是 10%。 这个README文件仅仅是声明，没有体现exp代码，无法验证漏洞。


**项目地址:** [MiningBot-eth/CVE-2023-51385-exploit](https://github.com/MiningBot-eth/CVE-2023-51385-exploit)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #6

**来源**: [CVE-2023-51385-WLaoDuo_CVE-2023-51385_poc-test.md](../2023/CVE-2023-51385-WLaoDuo_CVE-2023-51385_poc-test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 目标用户使用了受影响的OpenSSH版本，并且配置了ProxyCommand，clone包含恶意配置的git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。当用户名或主机名包含shell元字符，并且该名称在某些情况下被扩展标记引用时，可能会发生操作系统命令注入。POC利用方式是通过精心构造包含恶意配置的Git仓库，当用户clone该仓库时，其中的子模块配置会触发ProxyCommand中的命令注入，从而执行攻击者预设的恶意命令。用户需要编辑ssh config，添加proxycommand，然后clone指定的git仓库，触发弹窗。投毒风险主要来自于作者可能在仓库中添加额外的恶意代码，例如在README.md中嵌入恶意链接，或者在其他看似无害的文件中隐藏Payload，但是从作者公布的演示视频和简单的代码来看，概率较低。

**项目地址:** [WLaoDuo/CVE-2023-51385_poc-test](https://github.com/WLaoDuo/CVE-2023-51385_poc-test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #7

**来源**: [CVE-2023-51385-WOOOOONG_CVE-2023-51385.md](../2023/CVE-2023-51385-WOOOOONG_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要用户名或主机名包含shell元字符，并且被expansion token引用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中存在的一个命令注入漏洞。当用户名或主机名包含 shell 元字符，并且这个名字在特定情况下被 expansion token 引用时，可能发生操作系统命令注入。例如，一个不受信任的 Git 仓库可能包含一个子模块，其用户名或主机名中包含 shell 元字符。PoC代码只包含README文件，没有实际的验证后门代码，因此判断投毒概率较低。但如果攻击者使用该 PoC 并修改相关代码，则可能存在投毒风险。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞确实存在，并且影响 OpenSSH 9.6 之前的版本。提供的 PoC 代码仅仅是一个 README 文件，只包含漏洞名称，没有实际的漏洞利用代码。因此，提供的PoC代码本身**不具备**直接的漏洞利用有效性，需要进一步开发利用代码。

**投毒风险：**
因为提供的 PoC 只是一个 README 文件，因此**不存在**明显的投毒代码。可以认为投毒的风险很低，接近0%。但也不能完全排除，因为这个仓库可能后续被修改，添加恶意代码。
综合考虑，给出的投毒风险为1%。

**利用方式：**
利用此漏洞的一种方法是，攻击者可以创建一个包含恶意子模块的 Git 仓库。该子模块的用户名或主机名包含 shell 元字符。当用户尝试克隆包含此子模块的仓库时，OpenSSH 可能会执行恶意命令。具体步骤如下：

1.  创建一个包含恶意子模块的 Git 仓库。
2.  确保子模块的用户名或主机名包含 shell 元字符，例如反引号 (`) 或美元符号 ($)。
3.  诱使用户克隆该仓库。
4.  当 OpenSSH 处理子模块信息时，由于存在命令注入漏洞，恶意命令将被执行。

另一种利用方式是通过 `ProxyCommand` 指令。攻击者可以配置 SSH 客户端，使其使用包含恶意 shell 元字符的用户名或主机名连接到目标服务器。当 OpenSSH 执行 `ProxyCommand` 时，恶意命令将被执行。

**优先级排序:**
搜索引擎结果 > 漏洞库信息 > 漏洞利用代码(因为提供的POC没有任何实质性代码)


**项目地址:** [WOOOOONG/CVE-2023-51385](https://github.com/WOOOOONG/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #8

**来源**: [CVE-2023-51385-c0deur_CVE-2023-51385.md](../2023/CVE-2023-51385-c0deur_CVE-2023-51385.md)

# CVE-2023-51385

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-51385-2048JiaLi_CVE-2023-51385.md](../2023/CVE-2023-51385-2048JiaLi_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要存在受影响的OpenSSH版本，并且用户或主机名包含shell元字符，在特定配置下触发ProxyCommand等功能。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-51385是OpenSSH中的一个命令注入漏洞。当用户名或主机名包含shell元字符时，且这些名称被特定情况下的扩展标记引用，就可能发生操作系统命令注入。例如，一个不受信任的Git仓库可能有一个子模块，其用户名或主机名中包含shell元字符。根据提供的POC代码，该代码尝试在`/var/www/html/flag`文件中写入'hello'。如果目标系统配置允许写入该文件，并且利用成功触发了命令注入，则POC有效。但是，这个POC本身并不具有明显的恶意投毒行为。更高级的利用可能涉及更复杂的payload，比如反弹shell。

利用方式：

1.  **恶意Git仓库:** 创建一个包含恶意子模块的Git仓库，该子模块的用户名或主机名包含shell元字符。
2.  **配置ProxyCommand:** 在`~/.ssh/config`文件中配置`ProxyCommand`选项，使其引用包含shell元字符的用户名或主机名。
3.  **触发漏洞:** 当OpenSSH处理这些配置时，由于shell元字符未正确转义，导致命令注入。
4.  **执行任意命令:** 攻击者可以利用命令注入执行任意操作系统命令。

**项目地址:** [2048JiaLi/CVE-2023-51385](https://github.com/2048JiaLi/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #2

**来源**: [CVE-2023-51385-Featherw1t_CVE-2023-51385_test.md](../2023/CVE-2023-51385-Featherw1t_CVE-2023-51385_test.md)

## CVE-2023-51385 OpenSSH 命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标主机使用受影响的OpenSSH版本，且`~/.ssh/config`文件中存在可利用的ProxyCommand配置或使用包含恶意构造的git submodule的git仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 Shell 元字符，并且这些名称在某些情况下被扩展令牌引用时，可能发生操作系统命令注入。漏洞利用方式是：

1.  **配置ProxyCommand：** 在 `~/.ssh/config` 文件中设置 `ProxyCommand`，其中包含恶意构造的命令。POC提供了一个使用`nc`命令的例子。
2.  **Git submodule 注入：**  攻击者可以创建一个包含恶意构造的 `.gitmodules` 文件的 Git 仓库。该文件中的 `url` 字段包含 shell 元字符，当用户尝试克隆该仓库并初始化子模块时，`git clone --recurse-submodules`命令会触发命令注入。

根据提供的POC代码，攻击者可以通过构造恶意的用户名或主机名（例如在 Git 子模块的 URL 中）来执行任意命令。

**有效性：** 提供的POC代码是有效的，因为它展示了如何利用该漏洞通过精心构造的Git仓库来触发命令注入。

**投毒风险：**

此仓库可能存在投毒风险，因为攻击者可能在`git clone`下来的脚本或者git仓库本身中加入恶意代码。风险评估为10%，因为提供的代码片段主要集中在漏洞利用上，但不能完全排除仓库作者在其他地方隐藏恶意代码的可能性。尤其需要关注通过`git clone --recurse-submodules`下载的其他脚本和文件。

**项目地址:** [Featherw1t/CVE-2023-51385_test](https://github.com/Featherw1t/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #3

**来源**: [CVE-2023-51385-Le1a_CVE-2023-51385.md](../2023/CVE-2023-51385-Le1a_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含shell元字符，且在特定情况下被扩展令牌引用。需要配置ProxyCommand。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH中的一个命令注入漏洞，存在于9.6版本之前。漏洞的根本原因是当用户名或主机名包含shell元字符时，如果这些名称在某些情况下被扩展令牌引用，可能导致操作系统命令注入。

**有效性：**

根据漏洞描述和提供的POC代码，该漏洞是有效的。POC代码演示了当ProxyCommand配置为`/usr/bin/nc -X connect -x 127.0.0.1:7890 %h %p`时，通过克隆包含恶意子模块（子模块的用户名或主机名包含shell元字符）的Git仓库，可以触发命令注入。

**投毒风险：**

提供的POC代码非常简洁，主要是通过`git clone`命令触发漏洞。直接在提供的`README.md`和命令中发现明显投毒代码的可能性较低。 但`git clone --recurse-submodules`本身会执行子模块中定义的操作，因此子模块本身的内容可能会包含恶意代码，但这不是漏洞利用代码本身的问题，而是Git子模块机制带来的风险。因此，判定投毒风险为10%，主要考虑子模块可能包含恶意代码的可能性。

**利用方式：**

1.  **配置ProxyCommand：** 首先，用户需要在`~/.ssh/config`文件中配置`ProxyCommand`，例如：

    ```
    Host *.com
      ProxyCommand /usr/bin/nc -X connect -x 127.0.0.1:7890 %h %p
    ```

2.  **克隆恶意Git仓库：** 攻击者创建一个包含恶意子模块的Git仓库。恶意子模块的URL包含shell元字符，例如，用户名或主机名包含反引号、美元符号等。

3.  **触发命令注入：** 当用户使用`git clone --recurse-submodules`克隆该恶意仓库时，Git会自动初始化和更新子模块。在处理恶意子模块的URL时，OpenSSH会对其进行不正确的转义，导致shell元字符被解释执行，从而实现命令注入。

**总结：**

此漏洞的利用依赖于特定的OpenSSH配置（`ProxyCommand`）和恶意的Git仓库。攻击者通过控制Git仓库中的子模块URL，可以注入任意命令。修复此漏洞的方法是升级到OpenSSH 9.6或更高版本，或者避免在用户名或主机名中使用shell元字符。

**项目地址:** [Le1a/CVE-2023-51385](https://github.com/Le1a/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #4

**来源**: [CVE-2023-51385-LtmThink_CVE-2023-51385_test.md](../2023/CVE-2023-51385-LtmThink_CVE-2023-51385_test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6p1

**利用条件:** 需要用户clone包含恶意.gitmodules的git仓库，并配置ssh config中的ProxyCommand。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。该漏洞是由于 OpenSSH 在处理用户名或主机名中包含 Shell 元字符时，没有进行充分的过滤，导致可以通过特定的扩展令牌进行操作系统命令注入。

**利用方式：**
1.  **恶意 Git 仓库：** 攻击者创建一个包含恶意 `.gitmodules` 文件的 Git 仓库。该文件中的 `url` 字段包含恶意命令，例如：
    ```
    url = ssh://`echo helloworld > cve.txt`foo.example.com/bar
    ```
2.  **SSH 配置：** 受害者需要在 `~/.ssh/config` 文件中设置 `ProxyCommand` 指令，并匹配恶意域名，例如：
    ```
    host *.example.com
      ProxyCommand /usr/bin/nc -X connect -x 192.0.2.0:8080 %h %p
    ```
3.  **触发漏洞：** 受害者使用 `git clone --recurse-submodules` 命令克隆恶意 Git 仓库，`--recurse-submodules` 选项会导致 Git 读取 `.gitmodules` 文件，并执行其中 `url` 字段中的恶意命令，从而实现远程代码执行。

**有效性：**
提供的POC代码有效，已经验证可以触发命令执行。

**投毒风险：**
该仓库主要用于漏洞验证，虽然作者在博客中公开了漏洞原理，并且提供了验证代码，但是依然存在一定的投毒风险，例如：

1.  **利用代码本身：**  `ProxyCommand`  配置需要用户手动设置，如果攻击者提供一个包含更复杂、更隐蔽的命令注入payload的 `.gitmodules` 文件，用户在不知情的情况下克隆该仓库，可能会被植入后门或者执行其他恶意操作。
2.  **利用关联仓库：** 攻击者可能在看似无害的其他文件中隐藏恶意代码，例如图片，或者其他git hook脚本。如果用户不仔细检查，可能会忽略这些恶意代码。

考虑到以上因素，初步判断投毒风险为10%。

**项目地址:** [LtmThink/CVE-2023-51385_test](https://github.com/LtmThink/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #5

**来源**: [CVE-2023-51385-MiningBot-eth_CVE-2023-51385-exploit.md](../2023/CVE-2023-51385-MiningBot-eth_CVE-2023-51385-exploit.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要受害者使用受污染的用户名或主机名连接到攻击者控制的服务器，或者受害者访问包含恶意子模块的 Git 仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符时，可能发生操作系统命令注入。例如，如果一个不受信任的 Git 仓库有一个子模块，该子模块的用户名或主机名包含 shell 元字符，则可能触发此漏洞。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意配置的 Git 仓库，其中子模块的用户名或主机名包含 shell 元字符。
2.  或者，攻击者控制一个 SSH 服务器，并设置包含恶意 shell 元字符的用户名或主机名。
3.  受害者克隆恶意 Git 仓库或使用易受攻击的 OpenSSH 客户端连接到攻击者控制的 SSH 服务器。
4.  OpenSSH 在处理用户名或主机名时，由于未正确转义 shell 元字符，导致命令注入，执行攻击者控制的恶意命令。

**有效性：**
根据漏洞描述和搜索结果，此漏洞是有效的。许多安全厂商和组织都发布了关于此漏洞的公告和修复建议。

**投毒风险：**
提供的 POC 代码 `/tmp/d37649a81685a000f41564edc2078d9f/README.md` 仅仅包含了一个 README.md 文件，内容为 `# CVE-2023-51385-exploit`。 虽然这个文件本身不包含任何恶意代码，但不能完全排除整个仓库中存在其他隐藏的投毒代码的可能性。假设仓库中存在其他恶意脚本或配置文件的可能性是 10%。 这个README文件仅仅是声明，没有体现exp代码，无法验证漏洞。


**项目地址:** [MiningBot-eth/CVE-2023-51385-exploit](https://github.com/MiningBot-eth/CVE-2023-51385-exploit)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #6

**来源**: [CVE-2023-51385-WLaoDuo_CVE-2023-51385_poc-test.md](../2023/CVE-2023-51385-WLaoDuo_CVE-2023-51385_poc-test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 目标用户使用了受影响的OpenSSH版本，并且配置了ProxyCommand，clone包含恶意配置的git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。当用户名或主机名包含shell元字符，并且该名称在某些情况下被扩展标记引用时，可能会发生操作系统命令注入。POC利用方式是通过精心构造包含恶意配置的Git仓库，当用户clone该仓库时，其中的子模块配置会触发ProxyCommand中的命令注入，从而执行攻击者预设的恶意命令。用户需要编辑ssh config，添加proxycommand，然后clone指定的git仓库，触发弹窗。投毒风险主要来自于作者可能在仓库中添加额外的恶意代码，例如在README.md中嵌入恶意链接，或者在其他看似无害的文件中隐藏Payload，但是从作者公布的演示视频和简单的代码来看，概率较低。

**项目地址:** [WLaoDuo/CVE-2023-51385_poc-test](https://github.com/WLaoDuo/CVE-2023-51385_poc-test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #7

**来源**: [CVE-2023-51385-WOOOOONG_CVE-2023-51385.md](../2023/CVE-2023-51385-WOOOOONG_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要用户名或主机名包含shell元字符，并且被expansion token引用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中存在的一个命令注入漏洞。当用户名或主机名包含 shell 元字符，并且这个名字在特定情况下被 expansion token 引用时，可能发生操作系统命令注入。例如，一个不受信任的 Git 仓库可能包含一个子模块，其用户名或主机名中包含 shell 元字符。PoC代码只包含README文件，没有实际的验证后门代码，因此判断投毒概率较低。但如果攻击者使用该 PoC 并修改相关代码，则可能存在投毒风险。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞确实存在，并且影响 OpenSSH 9.6 之前的版本。提供的 PoC 代码仅仅是一个 README 文件，只包含漏洞名称，没有实际的漏洞利用代码。因此，提供的PoC代码本身**不具备**直接的漏洞利用有效性，需要进一步开发利用代码。

**投毒风险：**
因为提供的 PoC 只是一个 README 文件，因此**不存在**明显的投毒代码。可以认为投毒的风险很低，接近0%。但也不能完全排除，因为这个仓库可能后续被修改，添加恶意代码。
综合考虑，给出的投毒风险为1%。

**利用方式：**
利用此漏洞的一种方法是，攻击者可以创建一个包含恶意子模块的 Git 仓库。该子模块的用户名或主机名包含 shell 元字符。当用户尝试克隆包含此子模块的仓库时，OpenSSH 可能会执行恶意命令。具体步骤如下：

1.  创建一个包含恶意子模块的 Git 仓库。
2.  确保子模块的用户名或主机名包含 shell 元字符，例如反引号 (`) 或美元符号 ($)。
3.  诱使用户克隆该仓库。
4.  当 OpenSSH 处理子模块信息时，由于存在命令注入漏洞，恶意命令将被执行。

另一种利用方式是通过 `ProxyCommand` 指令。攻击者可以配置 SSH 客户端，使其使用包含恶意 shell 元字符的用户名或主机名连接到目标服务器。当 OpenSSH 执行 `ProxyCommand` 时，恶意命令将被执行。

**优先级排序:**
搜索引擎结果 > 漏洞库信息 > 漏洞利用代码(因为提供的POC没有任何实质性代码)


**项目地址:** [WOOOOONG/CVE-2023-51385](https://github.com/WOOOOONG/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #8

**来源**: [CVE-2023-51385-c0deur_CVE-2023-51385.md](../2023/CVE-2023-51385-c0deur_CVE-2023-51385.md)

# CVE-2023-51385

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-51385-2048JiaLi_CVE-2023-51385.md](../2023/CVE-2023-51385-2048JiaLi_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要存在受影响的OpenSSH版本，并且用户或主机名包含shell元字符，在特定配置下触发ProxyCommand等功能。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-51385是OpenSSH中的一个命令注入漏洞。当用户名或主机名包含shell元字符时，且这些名称被特定情况下的扩展标记引用，就可能发生操作系统命令注入。例如，一个不受信任的Git仓库可能有一个子模块，其用户名或主机名中包含shell元字符。根据提供的POC代码，该代码尝试在`/var/www/html/flag`文件中写入'hello'。如果目标系统配置允许写入该文件，并且利用成功触发了命令注入，则POC有效。但是，这个POC本身并不具有明显的恶意投毒行为。更高级的利用可能涉及更复杂的payload，比如反弹shell。

利用方式：

1.  **恶意Git仓库:** 创建一个包含恶意子模块的Git仓库，该子模块的用户名或主机名包含shell元字符。
2.  **配置ProxyCommand:** 在`~/.ssh/config`文件中配置`ProxyCommand`选项，使其引用包含shell元字符的用户名或主机名。
3.  **触发漏洞:** 当OpenSSH处理这些配置时，由于shell元字符未正确转义，导致命令注入。
4.  **执行任意命令:** 攻击者可以利用命令注入执行任意操作系统命令。

**项目地址:** [2048JiaLi/CVE-2023-51385](https://github.com/2048JiaLi/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #2

**来源**: [CVE-2023-51385-Featherw1t_CVE-2023-51385_test.md](../2023/CVE-2023-51385-Featherw1t_CVE-2023-51385_test.md)

## CVE-2023-51385 OpenSSH 命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标主机使用受影响的OpenSSH版本，且`~/.ssh/config`文件中存在可利用的ProxyCommand配置或使用包含恶意构造的git submodule的git仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 Shell 元字符，并且这些名称在某些情况下被扩展令牌引用时，可能发生操作系统命令注入。漏洞利用方式是：

1.  **配置ProxyCommand：** 在 `~/.ssh/config` 文件中设置 `ProxyCommand`，其中包含恶意构造的命令。POC提供了一个使用`nc`命令的例子。
2.  **Git submodule 注入：**  攻击者可以创建一个包含恶意构造的 `.gitmodules` 文件的 Git 仓库。该文件中的 `url` 字段包含 shell 元字符，当用户尝试克隆该仓库并初始化子模块时，`git clone --recurse-submodules`命令会触发命令注入。

根据提供的POC代码，攻击者可以通过构造恶意的用户名或主机名（例如在 Git 子模块的 URL 中）来执行任意命令。

**有效性：** 提供的POC代码是有效的，因为它展示了如何利用该漏洞通过精心构造的Git仓库来触发命令注入。

**投毒风险：**

此仓库可能存在投毒风险，因为攻击者可能在`git clone`下来的脚本或者git仓库本身中加入恶意代码。风险评估为10%，因为提供的代码片段主要集中在漏洞利用上，但不能完全排除仓库作者在其他地方隐藏恶意代码的可能性。尤其需要关注通过`git clone --recurse-submodules`下载的其他脚本和文件。

**项目地址:** [Featherw1t/CVE-2023-51385_test](https://github.com/Featherw1t/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #3

**来源**: [CVE-2023-51385-Le1a_CVE-2023-51385.md](../2023/CVE-2023-51385-Le1a_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含shell元字符，且在特定情况下被扩展令牌引用。需要配置ProxyCommand。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH中的一个命令注入漏洞，存在于9.6版本之前。漏洞的根本原因是当用户名或主机名包含shell元字符时，如果这些名称在某些情况下被扩展令牌引用，可能导致操作系统命令注入。

**有效性：**

根据漏洞描述和提供的POC代码，该漏洞是有效的。POC代码演示了当ProxyCommand配置为`/usr/bin/nc -X connect -x 127.0.0.1:7890 %h %p`时，通过克隆包含恶意子模块（子模块的用户名或主机名包含shell元字符）的Git仓库，可以触发命令注入。

**投毒风险：**

提供的POC代码非常简洁，主要是通过`git clone`命令触发漏洞。直接在提供的`README.md`和命令中发现明显投毒代码的可能性较低。 但`git clone --recurse-submodules`本身会执行子模块中定义的操作，因此子模块本身的内容可能会包含恶意代码，但这不是漏洞利用代码本身的问题，而是Git子模块机制带来的风险。因此，判定投毒风险为10%，主要考虑子模块可能包含恶意代码的可能性。

**利用方式：**

1.  **配置ProxyCommand：** 首先，用户需要在`~/.ssh/config`文件中配置`ProxyCommand`，例如：

    ```
    Host *.com
      ProxyCommand /usr/bin/nc -X connect -x 127.0.0.1:7890 %h %p
    ```

2.  **克隆恶意Git仓库：** 攻击者创建一个包含恶意子模块的Git仓库。恶意子模块的URL包含shell元字符，例如，用户名或主机名包含反引号、美元符号等。

3.  **触发命令注入：** 当用户使用`git clone --recurse-submodules`克隆该恶意仓库时，Git会自动初始化和更新子模块。在处理恶意子模块的URL时，OpenSSH会对其进行不正确的转义，导致shell元字符被解释执行，从而实现命令注入。

**总结：**

此漏洞的利用依赖于特定的OpenSSH配置（`ProxyCommand`）和恶意的Git仓库。攻击者通过控制Git仓库中的子模块URL，可以注入任意命令。修复此漏洞的方法是升级到OpenSSH 9.6或更高版本，或者避免在用户名或主机名中使用shell元字符。

**项目地址:** [Le1a/CVE-2023-51385](https://github.com/Le1a/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #4

**来源**: [CVE-2023-51385-LtmThink_CVE-2023-51385_test.md](../2023/CVE-2023-51385-LtmThink_CVE-2023-51385_test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6p1

**利用条件:** 需要用户clone包含恶意.gitmodules的git仓库，并配置ssh config中的ProxyCommand。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。该漏洞是由于 OpenSSH 在处理用户名或主机名中包含 Shell 元字符时，没有进行充分的过滤，导致可以通过特定的扩展令牌进行操作系统命令注入。

**利用方式：**
1.  **恶意 Git 仓库：** 攻击者创建一个包含恶意 `.gitmodules` 文件的 Git 仓库。该文件中的 `url` 字段包含恶意命令，例如：
    ```
    url = ssh://`echo helloworld > cve.txt`foo.example.com/bar
    ```
2.  **SSH 配置：** 受害者需要在 `~/.ssh/config` 文件中设置 `ProxyCommand` 指令，并匹配恶意域名，例如：
    ```
    host *.example.com
      ProxyCommand /usr/bin/nc -X connect -x 192.0.2.0:8080 %h %p
    ```
3.  **触发漏洞：** 受害者使用 `git clone --recurse-submodules` 命令克隆恶意 Git 仓库，`--recurse-submodules` 选项会导致 Git 读取 `.gitmodules` 文件，并执行其中 `url` 字段中的恶意命令，从而实现远程代码执行。

**有效性：**
提供的POC代码有效，已经验证可以触发命令执行。

**投毒风险：**
该仓库主要用于漏洞验证，虽然作者在博客中公开了漏洞原理，并且提供了验证代码，但是依然存在一定的投毒风险，例如：

1.  **利用代码本身：**  `ProxyCommand`  配置需要用户手动设置，如果攻击者提供一个包含更复杂、更隐蔽的命令注入payload的 `.gitmodules` 文件，用户在不知情的情况下克隆该仓库，可能会被植入后门或者执行其他恶意操作。
2.  **利用关联仓库：** 攻击者可能在看似无害的其他文件中隐藏恶意代码，例如图片，或者其他git hook脚本。如果用户不仔细检查，可能会忽略这些恶意代码。

考虑到以上因素，初步判断投毒风险为10%。

**项目地址:** [LtmThink/CVE-2023-51385_test](https://github.com/LtmThink/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #5

**来源**: [CVE-2023-51385-MiningBot-eth_CVE-2023-51385-exploit.md](../2023/CVE-2023-51385-MiningBot-eth_CVE-2023-51385-exploit.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要受害者使用受污染的用户名或主机名连接到攻击者控制的服务器，或者受害者访问包含恶意子模块的 Git 仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符时，可能发生操作系统命令注入。例如，如果一个不受信任的 Git 仓库有一个子模块，该子模块的用户名或主机名包含 shell 元字符，则可能触发此漏洞。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意配置的 Git 仓库，其中子模块的用户名或主机名包含 shell 元字符。
2.  或者，攻击者控制一个 SSH 服务器，并设置包含恶意 shell 元字符的用户名或主机名。
3.  受害者克隆恶意 Git 仓库或使用易受攻击的 OpenSSH 客户端连接到攻击者控制的 SSH 服务器。
4.  OpenSSH 在处理用户名或主机名时，由于未正确转义 shell 元字符，导致命令注入，执行攻击者控制的恶意命令。

**有效性：**
根据漏洞描述和搜索结果，此漏洞是有效的。许多安全厂商和组织都发布了关于此漏洞的公告和修复建议。

**投毒风险：**
提供的 POC 代码 `/tmp/d37649a81685a000f41564edc2078d9f/README.md` 仅仅包含了一个 README.md 文件，内容为 `# CVE-2023-51385-exploit`。 虽然这个文件本身不包含任何恶意代码，但不能完全排除整个仓库中存在其他隐藏的投毒代码的可能性。假设仓库中存在其他恶意脚本或配置文件的可能性是 10%。 这个README文件仅仅是声明，没有体现exp代码，无法验证漏洞。


**项目地址:** [MiningBot-eth/CVE-2023-51385-exploit](https://github.com/MiningBot-eth/CVE-2023-51385-exploit)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #6

**来源**: [CVE-2023-51385-WLaoDuo_CVE-2023-51385_poc-test.md](../2023/CVE-2023-51385-WLaoDuo_CVE-2023-51385_poc-test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 目标用户使用了受影响的OpenSSH版本，并且配置了ProxyCommand，clone包含恶意配置的git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。当用户名或主机名包含shell元字符，并且该名称在某些情况下被扩展标记引用时，可能会发生操作系统命令注入。POC利用方式是通过精心构造包含恶意配置的Git仓库，当用户clone该仓库时，其中的子模块配置会触发ProxyCommand中的命令注入，从而执行攻击者预设的恶意命令。用户需要编辑ssh config，添加proxycommand，然后clone指定的git仓库，触发弹窗。投毒风险主要来自于作者可能在仓库中添加额外的恶意代码，例如在README.md中嵌入恶意链接，或者在其他看似无害的文件中隐藏Payload，但是从作者公布的演示视频和简单的代码来看，概率较低。

**项目地址:** [WLaoDuo/CVE-2023-51385_poc-test](https://github.com/WLaoDuo/CVE-2023-51385_poc-test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #7

**来源**: [CVE-2023-51385-WOOOOONG_CVE-2023-51385.md](../2023/CVE-2023-51385-WOOOOONG_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要用户名或主机名包含shell元字符，并且被expansion token引用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中存在的一个命令注入漏洞。当用户名或主机名包含 shell 元字符，并且这个名字在特定情况下被 expansion token 引用时，可能发生操作系统命令注入。例如，一个不受信任的 Git 仓库可能包含一个子模块，其用户名或主机名中包含 shell 元字符。PoC代码只包含README文件，没有实际的验证后门代码，因此判断投毒概率较低。但如果攻击者使用该 PoC 并修改相关代码，则可能存在投毒风险。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞确实存在，并且影响 OpenSSH 9.6 之前的版本。提供的 PoC 代码仅仅是一个 README 文件，只包含漏洞名称，没有实际的漏洞利用代码。因此，提供的PoC代码本身**不具备**直接的漏洞利用有效性，需要进一步开发利用代码。

**投毒风险：**
因为提供的 PoC 只是一个 README 文件，因此**不存在**明显的投毒代码。可以认为投毒的风险很低，接近0%。但也不能完全排除，因为这个仓库可能后续被修改，添加恶意代码。
综合考虑，给出的投毒风险为1%。

**利用方式：**
利用此漏洞的一种方法是，攻击者可以创建一个包含恶意子模块的 Git 仓库。该子模块的用户名或主机名包含 shell 元字符。当用户尝试克隆包含此子模块的仓库时，OpenSSH 可能会执行恶意命令。具体步骤如下：

1.  创建一个包含恶意子模块的 Git 仓库。
2.  确保子模块的用户名或主机名包含 shell 元字符，例如反引号 (`) 或美元符号 ($)。
3.  诱使用户克隆该仓库。
4.  当 OpenSSH 处理子模块信息时，由于存在命令注入漏洞，恶意命令将被执行。

另一种利用方式是通过 `ProxyCommand` 指令。攻击者可以配置 SSH 客户端，使其使用包含恶意 shell 元字符的用户名或主机名连接到目标服务器。当 OpenSSH 执行 `ProxyCommand` 时，恶意命令将被执行。

**优先级排序:**
搜索引擎结果 > 漏洞库信息 > 漏洞利用代码(因为提供的POC没有任何实质性代码)


**项目地址:** [WOOOOONG/CVE-2023-51385](https://github.com/WOOOOONG/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #8

**来源**: [CVE-2023-51385-c0deur_CVE-2023-51385.md](../2023/CVE-2023-51385-c0deur_CVE-2023-51385.md)

# CVE-2023-51385

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-51385-2048JiaLi_CVE-2023-51385.md](../2023/CVE-2023-51385-2048JiaLi_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要存在受影响的OpenSSH版本，并且用户或主机名包含shell元字符，在特定配置下触发ProxyCommand等功能。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-51385是OpenSSH中的一个命令注入漏洞。当用户名或主机名包含shell元字符时，且这些名称被特定情况下的扩展标记引用，就可能发生操作系统命令注入。例如，一个不受信任的Git仓库可能有一个子模块，其用户名或主机名中包含shell元字符。根据提供的POC代码，该代码尝试在`/var/www/html/flag`文件中写入'hello'。如果目标系统配置允许写入该文件，并且利用成功触发了命令注入，则POC有效。但是，这个POC本身并不具有明显的恶意投毒行为。更高级的利用可能涉及更复杂的payload，比如反弹shell。

利用方式：

1.  **恶意Git仓库:** 创建一个包含恶意子模块的Git仓库，该子模块的用户名或主机名包含shell元字符。
2.  **配置ProxyCommand:** 在`~/.ssh/config`文件中配置`ProxyCommand`选项，使其引用包含shell元字符的用户名或主机名。
3.  **触发漏洞:** 当OpenSSH处理这些配置时，由于shell元字符未正确转义，导致命令注入。
4.  **执行任意命令:** 攻击者可以利用命令注入执行任意操作系统命令。

**项目地址:** [2048JiaLi/CVE-2023-51385](https://github.com/2048JiaLi/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #2

**来源**: [CVE-2023-51385-Featherw1t_CVE-2023-51385_test.md](../2023/CVE-2023-51385-Featherw1t_CVE-2023-51385_test.md)

## CVE-2023-51385 OpenSSH 命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标主机使用受影响的OpenSSH版本，且`~/.ssh/config`文件中存在可利用的ProxyCommand配置或使用包含恶意构造的git submodule的git仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 Shell 元字符，并且这些名称在某些情况下被扩展令牌引用时，可能发生操作系统命令注入。漏洞利用方式是：

1.  **配置ProxyCommand：** 在 `~/.ssh/config` 文件中设置 `ProxyCommand`，其中包含恶意构造的命令。POC提供了一个使用`nc`命令的例子。
2.  **Git submodule 注入：**  攻击者可以创建一个包含恶意构造的 `.gitmodules` 文件的 Git 仓库。该文件中的 `url` 字段包含 shell 元字符，当用户尝试克隆该仓库并初始化子模块时，`git clone --recurse-submodules`命令会触发命令注入。

根据提供的POC代码，攻击者可以通过构造恶意的用户名或主机名（例如在 Git 子模块的 URL 中）来执行任意命令。

**有效性：** 提供的POC代码是有效的，因为它展示了如何利用该漏洞通过精心构造的Git仓库来触发命令注入。

**投毒风险：**

此仓库可能存在投毒风险，因为攻击者可能在`git clone`下来的脚本或者git仓库本身中加入恶意代码。风险评估为10%，因为提供的代码片段主要集中在漏洞利用上，但不能完全排除仓库作者在其他地方隐藏恶意代码的可能性。尤其需要关注通过`git clone --recurse-submodules`下载的其他脚本和文件。

**项目地址:** [Featherw1t/CVE-2023-51385_test](https://github.com/Featherw1t/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #3

**来源**: [CVE-2023-51385-Le1a_CVE-2023-51385.md](../2023/CVE-2023-51385-Le1a_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含shell元字符，且在特定情况下被扩展令牌引用。需要配置ProxyCommand。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH中的一个命令注入漏洞，存在于9.6版本之前。漏洞的根本原因是当用户名或主机名包含shell元字符时，如果这些名称在某些情况下被扩展令牌引用，可能导致操作系统命令注入。

**有效性：**

根据漏洞描述和提供的POC代码，该漏洞是有效的。POC代码演示了当ProxyCommand配置为`/usr/bin/nc -X connect -x 127.0.0.1:7890 %h %p`时，通过克隆包含恶意子模块（子模块的用户名或主机名包含shell元字符）的Git仓库，可以触发命令注入。

**投毒风险：**

提供的POC代码非常简洁，主要是通过`git clone`命令触发漏洞。直接在提供的`README.md`和命令中发现明显投毒代码的可能性较低。 但`git clone --recurse-submodules`本身会执行子模块中定义的操作，因此子模块本身的内容可能会包含恶意代码，但这不是漏洞利用代码本身的问题，而是Git子模块机制带来的风险。因此，判定投毒风险为10%，主要考虑子模块可能包含恶意代码的可能性。

**利用方式：**

1.  **配置ProxyCommand：** 首先，用户需要在`~/.ssh/config`文件中配置`ProxyCommand`，例如：

    ```
    Host *.com
      ProxyCommand /usr/bin/nc -X connect -x 127.0.0.1:7890 %h %p
    ```

2.  **克隆恶意Git仓库：** 攻击者创建一个包含恶意子模块的Git仓库。恶意子模块的URL包含shell元字符，例如，用户名或主机名包含反引号、美元符号等。

3.  **触发命令注入：** 当用户使用`git clone --recurse-submodules`克隆该恶意仓库时，Git会自动初始化和更新子模块。在处理恶意子模块的URL时，OpenSSH会对其进行不正确的转义，导致shell元字符被解释执行，从而实现命令注入。

**总结：**

此漏洞的利用依赖于特定的OpenSSH配置（`ProxyCommand`）和恶意的Git仓库。攻击者通过控制Git仓库中的子模块URL，可以注入任意命令。修复此漏洞的方法是升级到OpenSSH 9.6或更高版本，或者避免在用户名或主机名中使用shell元字符。

**项目地址:** [Le1a/CVE-2023-51385](https://github.com/Le1a/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #4

**来源**: [CVE-2023-51385-LtmThink_CVE-2023-51385_test.md](../2023/CVE-2023-51385-LtmThink_CVE-2023-51385_test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6p1

**利用条件:** 需要用户clone包含恶意.gitmodules的git仓库，并配置ssh config中的ProxyCommand。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。该漏洞是由于 OpenSSH 在处理用户名或主机名中包含 Shell 元字符时，没有进行充分的过滤，导致可以通过特定的扩展令牌进行操作系统命令注入。

**利用方式：**
1.  **恶意 Git 仓库：** 攻击者创建一个包含恶意 `.gitmodules` 文件的 Git 仓库。该文件中的 `url` 字段包含恶意命令，例如：
    ```
    url = ssh://`echo helloworld > cve.txt`foo.example.com/bar
    ```
2.  **SSH 配置：** 受害者需要在 `~/.ssh/config` 文件中设置 `ProxyCommand` 指令，并匹配恶意域名，例如：
    ```
    host *.example.com
      ProxyCommand /usr/bin/nc -X connect -x 192.0.2.0:8080 %h %p
    ```
3.  **触发漏洞：** 受害者使用 `git clone --recurse-submodules` 命令克隆恶意 Git 仓库，`--recurse-submodules` 选项会导致 Git 读取 `.gitmodules` 文件，并执行其中 `url` 字段中的恶意命令，从而实现远程代码执行。

**有效性：**
提供的POC代码有效，已经验证可以触发命令执行。

**投毒风险：**
该仓库主要用于漏洞验证，虽然作者在博客中公开了漏洞原理，并且提供了验证代码，但是依然存在一定的投毒风险，例如：

1.  **利用代码本身：**  `ProxyCommand`  配置需要用户手动设置，如果攻击者提供一个包含更复杂、更隐蔽的命令注入payload的 `.gitmodules` 文件，用户在不知情的情况下克隆该仓库，可能会被植入后门或者执行其他恶意操作。
2.  **利用关联仓库：** 攻击者可能在看似无害的其他文件中隐藏恶意代码，例如图片，或者其他git hook脚本。如果用户不仔细检查，可能会忽略这些恶意代码。

考虑到以上因素，初步判断投毒风险为10%。

**项目地址:** [LtmThink/CVE-2023-51385_test](https://github.com/LtmThink/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #5

**来源**: [CVE-2023-51385-MiningBot-eth_CVE-2023-51385-exploit.md](../2023/CVE-2023-51385-MiningBot-eth_CVE-2023-51385-exploit.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要受害者使用受污染的用户名或主机名连接到攻击者控制的服务器，或者受害者访问包含恶意子模块的 Git 仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符时，可能发生操作系统命令注入。例如，如果一个不受信任的 Git 仓库有一个子模块，该子模块的用户名或主机名包含 shell 元字符，则可能触发此漏洞。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意配置的 Git 仓库，其中子模块的用户名或主机名包含 shell 元字符。
2.  或者，攻击者控制一个 SSH 服务器，并设置包含恶意 shell 元字符的用户名或主机名。
3.  受害者克隆恶意 Git 仓库或使用易受攻击的 OpenSSH 客户端连接到攻击者控制的 SSH 服务器。
4.  OpenSSH 在处理用户名或主机名时，由于未正确转义 shell 元字符，导致命令注入，执行攻击者控制的恶意命令。

**有效性：**
根据漏洞描述和搜索结果，此漏洞是有效的。许多安全厂商和组织都发布了关于此漏洞的公告和修复建议。

**投毒风险：**
提供的 POC 代码 `/tmp/d37649a81685a000f41564edc2078d9f/README.md` 仅仅包含了一个 README.md 文件，内容为 `# CVE-2023-51385-exploit`。 虽然这个文件本身不包含任何恶意代码，但不能完全排除整个仓库中存在其他隐藏的投毒代码的可能性。假设仓库中存在其他恶意脚本或配置文件的可能性是 10%。 这个README文件仅仅是声明，没有体现exp代码，无法验证漏洞。


**项目地址:** [MiningBot-eth/CVE-2023-51385-exploit](https://github.com/MiningBot-eth/CVE-2023-51385-exploit)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #6

**来源**: [CVE-2023-51385-WLaoDuo_CVE-2023-51385_poc-test.md](../2023/CVE-2023-51385-WLaoDuo_CVE-2023-51385_poc-test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 目标用户使用了受影响的OpenSSH版本，并且配置了ProxyCommand，clone包含恶意配置的git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。当用户名或主机名包含shell元字符，并且该名称在某些情况下被扩展标记引用时，可能会发生操作系统命令注入。POC利用方式是通过精心构造包含恶意配置的Git仓库，当用户clone该仓库时，其中的子模块配置会触发ProxyCommand中的命令注入，从而执行攻击者预设的恶意命令。用户需要编辑ssh config，添加proxycommand，然后clone指定的git仓库，触发弹窗。投毒风险主要来自于作者可能在仓库中添加额外的恶意代码，例如在README.md中嵌入恶意链接，或者在其他看似无害的文件中隐藏Payload，但是从作者公布的演示视频和简单的代码来看，概率较低。

**项目地址:** [WLaoDuo/CVE-2023-51385_poc-test](https://github.com/WLaoDuo/CVE-2023-51385_poc-test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #7

**来源**: [CVE-2023-51385-WOOOOONG_CVE-2023-51385.md](../2023/CVE-2023-51385-WOOOOONG_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要用户名或主机名包含shell元字符，并且被expansion token引用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中存在的一个命令注入漏洞。当用户名或主机名包含 shell 元字符，并且这个名字在特定情况下被 expansion token 引用时，可能发生操作系统命令注入。例如，一个不受信任的 Git 仓库可能包含一个子模块，其用户名或主机名中包含 shell 元字符。PoC代码只包含README文件，没有实际的验证后门代码，因此判断投毒概率较低。但如果攻击者使用该 PoC 并修改相关代码，则可能存在投毒风险。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞确实存在，并且影响 OpenSSH 9.6 之前的版本。提供的 PoC 代码仅仅是一个 README 文件，只包含漏洞名称，没有实际的漏洞利用代码。因此，提供的PoC代码本身**不具备**直接的漏洞利用有效性，需要进一步开发利用代码。

**投毒风险：**
因为提供的 PoC 只是一个 README 文件，因此**不存在**明显的投毒代码。可以认为投毒的风险很低，接近0%。但也不能完全排除，因为这个仓库可能后续被修改，添加恶意代码。
综合考虑，给出的投毒风险为1%。

**利用方式：**
利用此漏洞的一种方法是，攻击者可以创建一个包含恶意子模块的 Git 仓库。该子模块的用户名或主机名包含 shell 元字符。当用户尝试克隆包含此子模块的仓库时，OpenSSH 可能会执行恶意命令。具体步骤如下：

1.  创建一个包含恶意子模块的 Git 仓库。
2.  确保子模块的用户名或主机名包含 shell 元字符，例如反引号 (`) 或美元符号 ($)。
3.  诱使用户克隆该仓库。
4.  当 OpenSSH 处理子模块信息时，由于存在命令注入漏洞，恶意命令将被执行。

另一种利用方式是通过 `ProxyCommand` 指令。攻击者可以配置 SSH 客户端，使其使用包含恶意 shell 元字符的用户名或主机名连接到目标服务器。当 OpenSSH 执行 `ProxyCommand` 时，恶意命令将被执行。

**优先级排序:**
搜索引擎结果 > 漏洞库信息 > 漏洞利用代码(因为提供的POC没有任何实质性代码)


**项目地址:** [WOOOOONG/CVE-2023-51385](https://github.com/WOOOOONG/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #8

**来源**: [CVE-2023-51385-c0deur_CVE-2023-51385.md](../2023/CVE-2023-51385-c0deur_CVE-2023-51385.md)

# CVE-2023-51385

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-51385-2048JiaLi_CVE-2023-51385.md](../2023/CVE-2023-51385-2048JiaLi_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要存在受影响的OpenSSH版本，并且用户或主机名包含shell元字符，在特定配置下触发ProxyCommand等功能。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-51385是OpenSSH中的一个命令注入漏洞。当用户名或主机名包含shell元字符时，且这些名称被特定情况下的扩展标记引用，就可能发生操作系统命令注入。例如，一个不受信任的Git仓库可能有一个子模块，其用户名或主机名中包含shell元字符。根据提供的POC代码，该代码尝试在`/var/www/html/flag`文件中写入'hello'。如果目标系统配置允许写入该文件，并且利用成功触发了命令注入，则POC有效。但是，这个POC本身并不具有明显的恶意投毒行为。更高级的利用可能涉及更复杂的payload，比如反弹shell。

利用方式：

1.  **恶意Git仓库:** 创建一个包含恶意子模块的Git仓库，该子模块的用户名或主机名包含shell元字符。
2.  **配置ProxyCommand:** 在`~/.ssh/config`文件中配置`ProxyCommand`选项，使其引用包含shell元字符的用户名或主机名。
3.  **触发漏洞:** 当OpenSSH处理这些配置时，由于shell元字符未正确转义，导致命令注入。
4.  **执行任意命令:** 攻击者可以利用命令注入执行任意操作系统命令。

**项目地址:** [2048JiaLi/CVE-2023-51385](https://github.com/2048JiaLi/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #2

**来源**: [CVE-2023-51385-Featherw1t_CVE-2023-51385_test.md](../2023/CVE-2023-51385-Featherw1t_CVE-2023-51385_test.md)

## CVE-2023-51385 OpenSSH 命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标主机使用受影响的OpenSSH版本，且`~/.ssh/config`文件中存在可利用的ProxyCommand配置或使用包含恶意构造的git submodule的git仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 Shell 元字符，并且这些名称在某些情况下被扩展令牌引用时，可能发生操作系统命令注入。漏洞利用方式是：

1.  **配置ProxyCommand：** 在 `~/.ssh/config` 文件中设置 `ProxyCommand`，其中包含恶意构造的命令。POC提供了一个使用`nc`命令的例子。
2.  **Git submodule 注入：**  攻击者可以创建一个包含恶意构造的 `.gitmodules` 文件的 Git 仓库。该文件中的 `url` 字段包含 shell 元字符，当用户尝试克隆该仓库并初始化子模块时，`git clone --recurse-submodules`命令会触发命令注入。

根据提供的POC代码，攻击者可以通过构造恶意的用户名或主机名（例如在 Git 子模块的 URL 中）来执行任意命令。

**有效性：** 提供的POC代码是有效的，因为它展示了如何利用该漏洞通过精心构造的Git仓库来触发命令注入。

**投毒风险：**

此仓库可能存在投毒风险，因为攻击者可能在`git clone`下来的脚本或者git仓库本身中加入恶意代码。风险评估为10%，因为提供的代码片段主要集中在漏洞利用上，但不能完全排除仓库作者在其他地方隐藏恶意代码的可能性。尤其需要关注通过`git clone --recurse-submodules`下载的其他脚本和文件。

**项目地址:** [Featherw1t/CVE-2023-51385_test](https://github.com/Featherw1t/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #3

**来源**: [CVE-2023-51385-Le1a_CVE-2023-51385.md](../2023/CVE-2023-51385-Le1a_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含shell元字符，且在特定情况下被扩展令牌引用。需要配置ProxyCommand。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH中的一个命令注入漏洞，存在于9.6版本之前。漏洞的根本原因是当用户名或主机名包含shell元字符时，如果这些名称在某些情况下被扩展令牌引用，可能导致操作系统命令注入。

**有效性：**

根据漏洞描述和提供的POC代码，该漏洞是有效的。POC代码演示了当ProxyCommand配置为`/usr/bin/nc -X connect -x 127.0.0.1:7890 %h %p`时，通过克隆包含恶意子模块（子模块的用户名或主机名包含shell元字符）的Git仓库，可以触发命令注入。

**投毒风险：**

提供的POC代码非常简洁，主要是通过`git clone`命令触发漏洞。直接在提供的`README.md`和命令中发现明显投毒代码的可能性较低。 但`git clone --recurse-submodules`本身会执行子模块中定义的操作，因此子模块本身的内容可能会包含恶意代码，但这不是漏洞利用代码本身的问题，而是Git子模块机制带来的风险。因此，判定投毒风险为10%，主要考虑子模块可能包含恶意代码的可能性。

**利用方式：**

1.  **配置ProxyCommand：** 首先，用户需要在`~/.ssh/config`文件中配置`ProxyCommand`，例如：

    ```
    Host *.com
      ProxyCommand /usr/bin/nc -X connect -x 127.0.0.1:7890 %h %p
    ```

2.  **克隆恶意Git仓库：** 攻击者创建一个包含恶意子模块的Git仓库。恶意子模块的URL包含shell元字符，例如，用户名或主机名包含反引号、美元符号等。

3.  **触发命令注入：** 当用户使用`git clone --recurse-submodules`克隆该恶意仓库时，Git会自动初始化和更新子模块。在处理恶意子模块的URL时，OpenSSH会对其进行不正确的转义，导致shell元字符被解释执行，从而实现命令注入。

**总结：**

此漏洞的利用依赖于特定的OpenSSH配置（`ProxyCommand`）和恶意的Git仓库。攻击者通过控制Git仓库中的子模块URL，可以注入任意命令。修复此漏洞的方法是升级到OpenSSH 9.6或更高版本，或者避免在用户名或主机名中使用shell元字符。

**项目地址:** [Le1a/CVE-2023-51385](https://github.com/Le1a/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #4

**来源**: [CVE-2023-51385-LtmThink_CVE-2023-51385_test.md](../2023/CVE-2023-51385-LtmThink_CVE-2023-51385_test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6p1

**利用条件:** 需要用户clone包含恶意.gitmodules的git仓库，并配置ssh config中的ProxyCommand。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。该漏洞是由于 OpenSSH 在处理用户名或主机名中包含 Shell 元字符时，没有进行充分的过滤，导致可以通过特定的扩展令牌进行操作系统命令注入。

**利用方式：**
1.  **恶意 Git 仓库：** 攻击者创建一个包含恶意 `.gitmodules` 文件的 Git 仓库。该文件中的 `url` 字段包含恶意命令，例如：
    ```
    url = ssh://`echo helloworld > cve.txt`foo.example.com/bar
    ```
2.  **SSH 配置：** 受害者需要在 `~/.ssh/config` 文件中设置 `ProxyCommand` 指令，并匹配恶意域名，例如：
    ```
    host *.example.com
      ProxyCommand /usr/bin/nc -X connect -x 192.0.2.0:8080 %h %p
    ```
3.  **触发漏洞：** 受害者使用 `git clone --recurse-submodules` 命令克隆恶意 Git 仓库，`--recurse-submodules` 选项会导致 Git 读取 `.gitmodules` 文件，并执行其中 `url` 字段中的恶意命令，从而实现远程代码执行。

**有效性：**
提供的POC代码有效，已经验证可以触发命令执行。

**投毒风险：**
该仓库主要用于漏洞验证，虽然作者在博客中公开了漏洞原理，并且提供了验证代码，但是依然存在一定的投毒风险，例如：

1.  **利用代码本身：**  `ProxyCommand`  配置需要用户手动设置，如果攻击者提供一个包含更复杂、更隐蔽的命令注入payload的 `.gitmodules` 文件，用户在不知情的情况下克隆该仓库，可能会被植入后门或者执行其他恶意操作。
2.  **利用关联仓库：** 攻击者可能在看似无害的其他文件中隐藏恶意代码，例如图片，或者其他git hook脚本。如果用户不仔细检查，可能会忽略这些恶意代码。

考虑到以上因素，初步判断投毒风险为10%。

**项目地址:** [LtmThink/CVE-2023-51385_test](https://github.com/LtmThink/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #5

**来源**: [CVE-2023-51385-MiningBot-eth_CVE-2023-51385-exploit.md](../2023/CVE-2023-51385-MiningBot-eth_CVE-2023-51385-exploit.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要受害者使用受污染的用户名或主机名连接到攻击者控制的服务器，或者受害者访问包含恶意子模块的 Git 仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符时，可能发生操作系统命令注入。例如，如果一个不受信任的 Git 仓库有一个子模块，该子模块的用户名或主机名包含 shell 元字符，则可能触发此漏洞。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意配置的 Git 仓库，其中子模块的用户名或主机名包含 shell 元字符。
2.  或者，攻击者控制一个 SSH 服务器，并设置包含恶意 shell 元字符的用户名或主机名。
3.  受害者克隆恶意 Git 仓库或使用易受攻击的 OpenSSH 客户端连接到攻击者控制的 SSH 服务器。
4.  OpenSSH 在处理用户名或主机名时，由于未正确转义 shell 元字符，导致命令注入，执行攻击者控制的恶意命令。

**有效性：**
根据漏洞描述和搜索结果，此漏洞是有效的。许多安全厂商和组织都发布了关于此漏洞的公告和修复建议。

**投毒风险：**
提供的 POC 代码 `/tmp/d37649a81685a000f41564edc2078d9f/README.md` 仅仅包含了一个 README.md 文件，内容为 `# CVE-2023-51385-exploit`。 虽然这个文件本身不包含任何恶意代码，但不能完全排除整个仓库中存在其他隐藏的投毒代码的可能性。假设仓库中存在其他恶意脚本或配置文件的可能性是 10%。 这个README文件仅仅是声明，没有体现exp代码，无法验证漏洞。


**项目地址:** [MiningBot-eth/CVE-2023-51385-exploit](https://github.com/MiningBot-eth/CVE-2023-51385-exploit)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #6

**来源**: [CVE-2023-51385-WLaoDuo_CVE-2023-51385_poc-test.md](../2023/CVE-2023-51385-WLaoDuo_CVE-2023-51385_poc-test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 目标用户使用了受影响的OpenSSH版本，并且配置了ProxyCommand，clone包含恶意配置的git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。当用户名或主机名包含shell元字符，并且该名称在某些情况下被扩展标记引用时，可能会发生操作系统命令注入。POC利用方式是通过精心构造包含恶意配置的Git仓库，当用户clone该仓库时，其中的子模块配置会触发ProxyCommand中的命令注入，从而执行攻击者预设的恶意命令。用户需要编辑ssh config，添加proxycommand，然后clone指定的git仓库，触发弹窗。投毒风险主要来自于作者可能在仓库中添加额外的恶意代码，例如在README.md中嵌入恶意链接，或者在其他看似无害的文件中隐藏Payload，但是从作者公布的演示视频和简单的代码来看，概率较低。

**项目地址:** [WLaoDuo/CVE-2023-51385_poc-test](https://github.com/WLaoDuo/CVE-2023-51385_poc-test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #7

**来源**: [CVE-2023-51385-WOOOOONG_CVE-2023-51385.md](../2023/CVE-2023-51385-WOOOOONG_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要用户名或主机名包含shell元字符，并且被expansion token引用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中存在的一个命令注入漏洞。当用户名或主机名包含 shell 元字符，并且这个名字在特定情况下被 expansion token 引用时，可能发生操作系统命令注入。例如，一个不受信任的 Git 仓库可能包含一个子模块，其用户名或主机名中包含 shell 元字符。PoC代码只包含README文件，没有实际的验证后门代码，因此判断投毒概率较低。但如果攻击者使用该 PoC 并修改相关代码，则可能存在投毒风险。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞确实存在，并且影响 OpenSSH 9.6 之前的版本。提供的 PoC 代码仅仅是一个 README 文件，只包含漏洞名称，没有实际的漏洞利用代码。因此，提供的PoC代码本身**不具备**直接的漏洞利用有效性，需要进一步开发利用代码。

**投毒风险：**
因为提供的 PoC 只是一个 README 文件，因此**不存在**明显的投毒代码。可以认为投毒的风险很低，接近0%。但也不能完全排除，因为这个仓库可能后续被修改，添加恶意代码。
综合考虑，给出的投毒风险为1%。

**利用方式：**
利用此漏洞的一种方法是，攻击者可以创建一个包含恶意子模块的 Git 仓库。该子模块的用户名或主机名包含 shell 元字符。当用户尝试克隆包含此子模块的仓库时，OpenSSH 可能会执行恶意命令。具体步骤如下：

1.  创建一个包含恶意子模块的 Git 仓库。
2.  确保子模块的用户名或主机名包含 shell 元字符，例如反引号 (`) 或美元符号 ($)。
3.  诱使用户克隆该仓库。
4.  当 OpenSSH 处理子模块信息时，由于存在命令注入漏洞，恶意命令将被执行。

另一种利用方式是通过 `ProxyCommand` 指令。攻击者可以配置 SSH 客户端，使其使用包含恶意 shell 元字符的用户名或主机名连接到目标服务器。当 OpenSSH 执行 `ProxyCommand` 时，恶意命令将被执行。

**优先级排序:**
搜索引擎结果 > 漏洞库信息 > 漏洞利用代码(因为提供的POC没有任何实质性代码)


**项目地址:** [WOOOOONG/CVE-2023-51385](https://github.com/WOOOOONG/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #8

**来源**: [CVE-2023-51385-c0deur_CVE-2023-51385.md](../2023/CVE-2023-51385-c0deur_CVE-2023-51385.md)

# CVE-2023-51385

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-51385-2048JiaLi_CVE-2023-51385.md](../2023/CVE-2023-51385-2048JiaLi_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要存在受影响的OpenSSH版本，并且用户或主机名包含shell元字符，在特定配置下触发ProxyCommand等功能。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-51385是OpenSSH中的一个命令注入漏洞。当用户名或主机名包含shell元字符时，且这些名称被特定情况下的扩展标记引用，就可能发生操作系统命令注入。例如，一个不受信任的Git仓库可能有一个子模块，其用户名或主机名中包含shell元字符。根据提供的POC代码，该代码尝试在`/var/www/html/flag`文件中写入'hello'。如果目标系统配置允许写入该文件，并且利用成功触发了命令注入，则POC有效。但是，这个POC本身并不具有明显的恶意投毒行为。更高级的利用可能涉及更复杂的payload，比如反弹shell。

利用方式：

1.  **恶意Git仓库:** 创建一个包含恶意子模块的Git仓库，该子模块的用户名或主机名包含shell元字符。
2.  **配置ProxyCommand:** 在`~/.ssh/config`文件中配置`ProxyCommand`选项，使其引用包含shell元字符的用户名或主机名。
3.  **触发漏洞:** 当OpenSSH处理这些配置时，由于shell元字符未正确转义，导致命令注入。
4.  **执行任意命令:** 攻击者可以利用命令注入执行任意操作系统命令。

**项目地址:** [2048JiaLi/CVE-2023-51385](https://github.com/2048JiaLi/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #2

**来源**: [CVE-2023-51385-Featherw1t_CVE-2023-51385_test.md](../2023/CVE-2023-51385-Featherw1t_CVE-2023-51385_test.md)

## CVE-2023-51385 OpenSSH 命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标主机使用受影响的OpenSSH版本，且`~/.ssh/config`文件中存在可利用的ProxyCommand配置或使用包含恶意构造的git submodule的git仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 Shell 元字符，并且这些名称在某些情况下被扩展令牌引用时，可能发生操作系统命令注入。漏洞利用方式是：

1.  **配置ProxyCommand：** 在 `~/.ssh/config` 文件中设置 `ProxyCommand`，其中包含恶意构造的命令。POC提供了一个使用`nc`命令的例子。
2.  **Git submodule 注入：**  攻击者可以创建一个包含恶意构造的 `.gitmodules` 文件的 Git 仓库。该文件中的 `url` 字段包含 shell 元字符，当用户尝试克隆该仓库并初始化子模块时，`git clone --recurse-submodules`命令会触发命令注入。

根据提供的POC代码，攻击者可以通过构造恶意的用户名或主机名（例如在 Git 子模块的 URL 中）来执行任意命令。

**有效性：** 提供的POC代码是有效的，因为它展示了如何利用该漏洞通过精心构造的Git仓库来触发命令注入。

**投毒风险：**

此仓库可能存在投毒风险，因为攻击者可能在`git clone`下来的脚本或者git仓库本身中加入恶意代码。风险评估为10%，因为提供的代码片段主要集中在漏洞利用上，但不能完全排除仓库作者在其他地方隐藏恶意代码的可能性。尤其需要关注通过`git clone --recurse-submodules`下载的其他脚本和文件。

**项目地址:** [Featherw1t/CVE-2023-51385_test](https://github.com/Featherw1t/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #3

**来源**: [CVE-2023-51385-Le1a_CVE-2023-51385.md](../2023/CVE-2023-51385-Le1a_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含shell元字符，且在特定情况下被扩展令牌引用。需要配置ProxyCommand。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH中的一个命令注入漏洞，存在于9.6版本之前。漏洞的根本原因是当用户名或主机名包含shell元字符时，如果这些名称在某些情况下被扩展令牌引用，可能导致操作系统命令注入。

**有效性：**

根据漏洞描述和提供的POC代码，该漏洞是有效的。POC代码演示了当ProxyCommand配置为`/usr/bin/nc -X connect -x 127.0.0.1:7890 %h %p`时，通过克隆包含恶意子模块（子模块的用户名或主机名包含shell元字符）的Git仓库，可以触发命令注入。

**投毒风险：**

提供的POC代码非常简洁，主要是通过`git clone`命令触发漏洞。直接在提供的`README.md`和命令中发现明显投毒代码的可能性较低。 但`git clone --recurse-submodules`本身会执行子模块中定义的操作，因此子模块本身的内容可能会包含恶意代码，但这不是漏洞利用代码本身的问题，而是Git子模块机制带来的风险。因此，判定投毒风险为10%，主要考虑子模块可能包含恶意代码的可能性。

**利用方式：**

1.  **配置ProxyCommand：** 首先，用户需要在`~/.ssh/config`文件中配置`ProxyCommand`，例如：

    ```
    Host *.com
      ProxyCommand /usr/bin/nc -X connect -x 127.0.0.1:7890 %h %p
    ```

2.  **克隆恶意Git仓库：** 攻击者创建一个包含恶意子模块的Git仓库。恶意子模块的URL包含shell元字符，例如，用户名或主机名包含反引号、美元符号等。

3.  **触发命令注入：** 当用户使用`git clone --recurse-submodules`克隆该恶意仓库时，Git会自动初始化和更新子模块。在处理恶意子模块的URL时，OpenSSH会对其进行不正确的转义，导致shell元字符被解释执行，从而实现命令注入。

**总结：**

此漏洞的利用依赖于特定的OpenSSH配置（`ProxyCommand`）和恶意的Git仓库。攻击者通过控制Git仓库中的子模块URL，可以注入任意命令。修复此漏洞的方法是升级到OpenSSH 9.6或更高版本，或者避免在用户名或主机名中使用shell元字符。

**项目地址:** [Le1a/CVE-2023-51385](https://github.com/Le1a/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #4

**来源**: [CVE-2023-51385-LtmThink_CVE-2023-51385_test.md](../2023/CVE-2023-51385-LtmThink_CVE-2023-51385_test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6p1

**利用条件:** 需要用户clone包含恶意.gitmodules的git仓库，并配置ssh config中的ProxyCommand。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。该漏洞是由于 OpenSSH 在处理用户名或主机名中包含 Shell 元字符时，没有进行充分的过滤，导致可以通过特定的扩展令牌进行操作系统命令注入。

**利用方式：**
1.  **恶意 Git 仓库：** 攻击者创建一个包含恶意 `.gitmodules` 文件的 Git 仓库。该文件中的 `url` 字段包含恶意命令，例如：
    ```
    url = ssh://`echo helloworld > cve.txt`foo.example.com/bar
    ```
2.  **SSH 配置：** 受害者需要在 `~/.ssh/config` 文件中设置 `ProxyCommand` 指令，并匹配恶意域名，例如：
    ```
    host *.example.com
      ProxyCommand /usr/bin/nc -X connect -x 192.0.2.0:8080 %h %p
    ```
3.  **触发漏洞：** 受害者使用 `git clone --recurse-submodules` 命令克隆恶意 Git 仓库，`--recurse-submodules` 选项会导致 Git 读取 `.gitmodules` 文件，并执行其中 `url` 字段中的恶意命令，从而实现远程代码执行。

**有效性：**
提供的POC代码有效，已经验证可以触发命令执行。

**投毒风险：**
该仓库主要用于漏洞验证，虽然作者在博客中公开了漏洞原理，并且提供了验证代码，但是依然存在一定的投毒风险，例如：

1.  **利用代码本身：**  `ProxyCommand`  配置需要用户手动设置，如果攻击者提供一个包含更复杂、更隐蔽的命令注入payload的 `.gitmodules` 文件，用户在不知情的情况下克隆该仓库，可能会被植入后门或者执行其他恶意操作。
2.  **利用关联仓库：** 攻击者可能在看似无害的其他文件中隐藏恶意代码，例如图片，或者其他git hook脚本。如果用户不仔细检查，可能会忽略这些恶意代码。

考虑到以上因素，初步判断投毒风险为10%。

**项目地址:** [LtmThink/CVE-2023-51385_test](https://github.com/LtmThink/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #5

**来源**: [CVE-2023-51385-MiningBot-eth_CVE-2023-51385-exploit.md](../2023/CVE-2023-51385-MiningBot-eth_CVE-2023-51385-exploit.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要受害者使用受污染的用户名或主机名连接到攻击者控制的服务器，或者受害者访问包含恶意子模块的 Git 仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符时，可能发生操作系统命令注入。例如，如果一个不受信任的 Git 仓库有一个子模块，该子模块的用户名或主机名包含 shell 元字符，则可能触发此漏洞。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意配置的 Git 仓库，其中子模块的用户名或主机名包含 shell 元字符。
2.  或者，攻击者控制一个 SSH 服务器，并设置包含恶意 shell 元字符的用户名或主机名。
3.  受害者克隆恶意 Git 仓库或使用易受攻击的 OpenSSH 客户端连接到攻击者控制的 SSH 服务器。
4.  OpenSSH 在处理用户名或主机名时，由于未正确转义 shell 元字符，导致命令注入，执行攻击者控制的恶意命令。

**有效性：**
根据漏洞描述和搜索结果，此漏洞是有效的。许多安全厂商和组织都发布了关于此漏洞的公告和修复建议。

**投毒风险：**
提供的 POC 代码 `/tmp/d37649a81685a000f41564edc2078d9f/README.md` 仅仅包含了一个 README.md 文件，内容为 `# CVE-2023-51385-exploit`。 虽然这个文件本身不包含任何恶意代码，但不能完全排除整个仓库中存在其他隐藏的投毒代码的可能性。假设仓库中存在其他恶意脚本或配置文件的可能性是 10%。 这个README文件仅仅是声明，没有体现exp代码，无法验证漏洞。


**项目地址:** [MiningBot-eth/CVE-2023-51385-exploit](https://github.com/MiningBot-eth/CVE-2023-51385-exploit)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #6

**来源**: [CVE-2023-51385-WLaoDuo_CVE-2023-51385_poc-test.md](../2023/CVE-2023-51385-WLaoDuo_CVE-2023-51385_poc-test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 目标用户使用了受影响的OpenSSH版本，并且配置了ProxyCommand，clone包含恶意配置的git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。当用户名或主机名包含shell元字符，并且该名称在某些情况下被扩展标记引用时，可能会发生操作系统命令注入。POC利用方式是通过精心构造包含恶意配置的Git仓库，当用户clone该仓库时，其中的子模块配置会触发ProxyCommand中的命令注入，从而执行攻击者预设的恶意命令。用户需要编辑ssh config，添加proxycommand，然后clone指定的git仓库，触发弹窗。投毒风险主要来自于作者可能在仓库中添加额外的恶意代码，例如在README.md中嵌入恶意链接，或者在其他看似无害的文件中隐藏Payload，但是从作者公布的演示视频和简单的代码来看，概率较低。

**项目地址:** [WLaoDuo/CVE-2023-51385_poc-test](https://github.com/WLaoDuo/CVE-2023-51385_poc-test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #7

**来源**: [CVE-2023-51385-WOOOOONG_CVE-2023-51385.md](../2023/CVE-2023-51385-WOOOOONG_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要用户名或主机名包含shell元字符，并且被expansion token引用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中存在的一个命令注入漏洞。当用户名或主机名包含 shell 元字符，并且这个名字在特定情况下被 expansion token 引用时，可能发生操作系统命令注入。例如，一个不受信任的 Git 仓库可能包含一个子模块，其用户名或主机名中包含 shell 元字符。PoC代码只包含README文件，没有实际的验证后门代码，因此判断投毒概率较低。但如果攻击者使用该 PoC 并修改相关代码，则可能存在投毒风险。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞确实存在，并且影响 OpenSSH 9.6 之前的版本。提供的 PoC 代码仅仅是一个 README 文件，只包含漏洞名称，没有实际的漏洞利用代码。因此，提供的PoC代码本身**不具备**直接的漏洞利用有效性，需要进一步开发利用代码。

**投毒风险：**
因为提供的 PoC 只是一个 README 文件，因此**不存在**明显的投毒代码。可以认为投毒的风险很低，接近0%。但也不能完全排除，因为这个仓库可能后续被修改，添加恶意代码。
综合考虑，给出的投毒风险为1%。

**利用方式：**
利用此漏洞的一种方法是，攻击者可以创建一个包含恶意子模块的 Git 仓库。该子模块的用户名或主机名包含 shell 元字符。当用户尝试克隆包含此子模块的仓库时，OpenSSH 可能会执行恶意命令。具体步骤如下：

1.  创建一个包含恶意子模块的 Git 仓库。
2.  确保子模块的用户名或主机名包含 shell 元字符，例如反引号 (`) 或美元符号 ($)。
3.  诱使用户克隆该仓库。
4.  当 OpenSSH 处理子模块信息时，由于存在命令注入漏洞，恶意命令将被执行。

另一种利用方式是通过 `ProxyCommand` 指令。攻击者可以配置 SSH 客户端，使其使用包含恶意 shell 元字符的用户名或主机名连接到目标服务器。当 OpenSSH 执行 `ProxyCommand` 时，恶意命令将被执行。

**优先级排序:**
搜索引擎结果 > 漏洞库信息 > 漏洞利用代码(因为提供的POC没有任何实质性代码)


**项目地址:** [WOOOOONG/CVE-2023-51385](https://github.com/WOOOOONG/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #8

**来源**: [CVE-2023-51385-c0deur_CVE-2023-51385.md](../2023/CVE-2023-51385-c0deur_CVE-2023-51385.md)

# CVE-2023-51385

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-51385-2048JiaLi_CVE-2023-51385.md](../2023/CVE-2023-51385-2048JiaLi_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要存在受影响的OpenSSH版本，并且用户或主机名包含shell元字符，在特定配置下触发ProxyCommand等功能。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-51385是OpenSSH中的一个命令注入漏洞。当用户名或主机名包含shell元字符时，且这些名称被特定情况下的扩展标记引用，就可能发生操作系统命令注入。例如，一个不受信任的Git仓库可能有一个子模块，其用户名或主机名中包含shell元字符。根据提供的POC代码，该代码尝试在`/var/www/html/flag`文件中写入'hello'。如果目标系统配置允许写入该文件，并且利用成功触发了命令注入，则POC有效。但是，这个POC本身并不具有明显的恶意投毒行为。更高级的利用可能涉及更复杂的payload，比如反弹shell。

利用方式：

1.  **恶意Git仓库:** 创建一个包含恶意子模块的Git仓库，该子模块的用户名或主机名包含shell元字符。
2.  **配置ProxyCommand:** 在`~/.ssh/config`文件中配置`ProxyCommand`选项，使其引用包含shell元字符的用户名或主机名。
3.  **触发漏洞:** 当OpenSSH处理这些配置时，由于shell元字符未正确转义，导致命令注入。
4.  **执行任意命令:** 攻击者可以利用命令注入执行任意操作系统命令。

**项目地址:** [2048JiaLi/CVE-2023-51385](https://github.com/2048JiaLi/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #2

**来源**: [CVE-2023-51385-Featherw1t_CVE-2023-51385_test.md](../2023/CVE-2023-51385-Featherw1t_CVE-2023-51385_test.md)

## CVE-2023-51385 OpenSSH 命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标主机使用受影响的OpenSSH版本，且`~/.ssh/config`文件中存在可利用的ProxyCommand配置或使用包含恶意构造的git submodule的git仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 Shell 元字符，并且这些名称在某些情况下被扩展令牌引用时，可能发生操作系统命令注入。漏洞利用方式是：

1.  **配置ProxyCommand：** 在 `~/.ssh/config` 文件中设置 `ProxyCommand`，其中包含恶意构造的命令。POC提供了一个使用`nc`命令的例子。
2.  **Git submodule 注入：**  攻击者可以创建一个包含恶意构造的 `.gitmodules` 文件的 Git 仓库。该文件中的 `url` 字段包含 shell 元字符，当用户尝试克隆该仓库并初始化子模块时，`git clone --recurse-submodules`命令会触发命令注入。

根据提供的POC代码，攻击者可以通过构造恶意的用户名或主机名（例如在 Git 子模块的 URL 中）来执行任意命令。

**有效性：** 提供的POC代码是有效的，因为它展示了如何利用该漏洞通过精心构造的Git仓库来触发命令注入。

**投毒风险：**

此仓库可能存在投毒风险，因为攻击者可能在`git clone`下来的脚本或者git仓库本身中加入恶意代码。风险评估为10%，因为提供的代码片段主要集中在漏洞利用上，但不能完全排除仓库作者在其他地方隐藏恶意代码的可能性。尤其需要关注通过`git clone --recurse-submodules`下载的其他脚本和文件。

**项目地址:** [Featherw1t/CVE-2023-51385_test](https://github.com/Featherw1t/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #3

**来源**: [CVE-2023-51385-Le1a_CVE-2023-51385.md](../2023/CVE-2023-51385-Le1a_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含shell元字符，且在特定情况下被扩展令牌引用。需要配置ProxyCommand。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH中的一个命令注入漏洞，存在于9.6版本之前。漏洞的根本原因是当用户名或主机名包含shell元字符时，如果这些名称在某些情况下被扩展令牌引用，可能导致操作系统命令注入。

**有效性：**

根据漏洞描述和提供的POC代码，该漏洞是有效的。POC代码演示了当ProxyCommand配置为`/usr/bin/nc -X connect -x 127.0.0.1:7890 %h %p`时，通过克隆包含恶意子模块（子模块的用户名或主机名包含shell元字符）的Git仓库，可以触发命令注入。

**投毒风险：**

提供的POC代码非常简洁，主要是通过`git clone`命令触发漏洞。直接在提供的`README.md`和命令中发现明显投毒代码的可能性较低。 但`git clone --recurse-submodules`本身会执行子模块中定义的操作，因此子模块本身的内容可能会包含恶意代码，但这不是漏洞利用代码本身的问题，而是Git子模块机制带来的风险。因此，判定投毒风险为10%，主要考虑子模块可能包含恶意代码的可能性。

**利用方式：**

1.  **配置ProxyCommand：** 首先，用户需要在`~/.ssh/config`文件中配置`ProxyCommand`，例如：

    ```
    Host *.com
      ProxyCommand /usr/bin/nc -X connect -x 127.0.0.1:7890 %h %p
    ```

2.  **克隆恶意Git仓库：** 攻击者创建一个包含恶意子模块的Git仓库。恶意子模块的URL包含shell元字符，例如，用户名或主机名包含反引号、美元符号等。

3.  **触发命令注入：** 当用户使用`git clone --recurse-submodules`克隆该恶意仓库时，Git会自动初始化和更新子模块。在处理恶意子模块的URL时，OpenSSH会对其进行不正确的转义，导致shell元字符被解释执行，从而实现命令注入。

**总结：**

此漏洞的利用依赖于特定的OpenSSH配置（`ProxyCommand`）和恶意的Git仓库。攻击者通过控制Git仓库中的子模块URL，可以注入任意命令。修复此漏洞的方法是升级到OpenSSH 9.6或更高版本，或者避免在用户名或主机名中使用shell元字符。

**项目地址:** [Le1a/CVE-2023-51385](https://github.com/Le1a/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #4

**来源**: [CVE-2023-51385-LtmThink_CVE-2023-51385_test.md](../2023/CVE-2023-51385-LtmThink_CVE-2023-51385_test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6p1

**利用条件:** 需要用户clone包含恶意.gitmodules的git仓库，并配置ssh config中的ProxyCommand。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。该漏洞是由于 OpenSSH 在处理用户名或主机名中包含 Shell 元字符时，没有进行充分的过滤，导致可以通过特定的扩展令牌进行操作系统命令注入。

**利用方式：**
1.  **恶意 Git 仓库：** 攻击者创建一个包含恶意 `.gitmodules` 文件的 Git 仓库。该文件中的 `url` 字段包含恶意命令，例如：
    ```
    url = ssh://`echo helloworld > cve.txt`foo.example.com/bar
    ```
2.  **SSH 配置：** 受害者需要在 `~/.ssh/config` 文件中设置 `ProxyCommand` 指令，并匹配恶意域名，例如：
    ```
    host *.example.com
      ProxyCommand /usr/bin/nc -X connect -x 192.0.2.0:8080 %h %p
    ```
3.  **触发漏洞：** 受害者使用 `git clone --recurse-submodules` 命令克隆恶意 Git 仓库，`--recurse-submodules` 选项会导致 Git 读取 `.gitmodules` 文件，并执行其中 `url` 字段中的恶意命令，从而实现远程代码执行。

**有效性：**
提供的POC代码有效，已经验证可以触发命令执行。

**投毒风险：**
该仓库主要用于漏洞验证，虽然作者在博客中公开了漏洞原理，并且提供了验证代码，但是依然存在一定的投毒风险，例如：

1.  **利用代码本身：**  `ProxyCommand`  配置需要用户手动设置，如果攻击者提供一个包含更复杂、更隐蔽的命令注入payload的 `.gitmodules` 文件，用户在不知情的情况下克隆该仓库，可能会被植入后门或者执行其他恶意操作。
2.  **利用关联仓库：** 攻击者可能在看似无害的其他文件中隐藏恶意代码，例如图片，或者其他git hook脚本。如果用户不仔细检查，可能会忽略这些恶意代码。

考虑到以上因素，初步判断投毒风险为10%。

**项目地址:** [LtmThink/CVE-2023-51385_test](https://github.com/LtmThink/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #5

**来源**: [CVE-2023-51385-MiningBot-eth_CVE-2023-51385-exploit.md](../2023/CVE-2023-51385-MiningBot-eth_CVE-2023-51385-exploit.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要受害者使用受污染的用户名或主机名连接到攻击者控制的服务器，或者受害者访问包含恶意子模块的 Git 仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符时，可能发生操作系统命令注入。例如，如果一个不受信任的 Git 仓库有一个子模块，该子模块的用户名或主机名包含 shell 元字符，则可能触发此漏洞。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意配置的 Git 仓库，其中子模块的用户名或主机名包含 shell 元字符。
2.  或者，攻击者控制一个 SSH 服务器，并设置包含恶意 shell 元字符的用户名或主机名。
3.  受害者克隆恶意 Git 仓库或使用易受攻击的 OpenSSH 客户端连接到攻击者控制的 SSH 服务器。
4.  OpenSSH 在处理用户名或主机名时，由于未正确转义 shell 元字符，导致命令注入，执行攻击者控制的恶意命令。

**有效性：**
根据漏洞描述和搜索结果，此漏洞是有效的。许多安全厂商和组织都发布了关于此漏洞的公告和修复建议。

**投毒风险：**
提供的 POC 代码 `/tmp/d37649a81685a000f41564edc2078d9f/README.md` 仅仅包含了一个 README.md 文件，内容为 `# CVE-2023-51385-exploit`。 虽然这个文件本身不包含任何恶意代码，但不能完全排除整个仓库中存在其他隐藏的投毒代码的可能性。假设仓库中存在其他恶意脚本或配置文件的可能性是 10%。 这个README文件仅仅是声明，没有体现exp代码，无法验证漏洞。


**项目地址:** [MiningBot-eth/CVE-2023-51385-exploit](https://github.com/MiningBot-eth/CVE-2023-51385-exploit)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #6

**来源**: [CVE-2023-51385-WLaoDuo_CVE-2023-51385_poc-test.md](../2023/CVE-2023-51385-WLaoDuo_CVE-2023-51385_poc-test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 目标用户使用了受影响的OpenSSH版本，并且配置了ProxyCommand，clone包含恶意配置的git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。当用户名或主机名包含shell元字符，并且该名称在某些情况下被扩展标记引用时，可能会发生操作系统命令注入。POC利用方式是通过精心构造包含恶意配置的Git仓库，当用户clone该仓库时，其中的子模块配置会触发ProxyCommand中的命令注入，从而执行攻击者预设的恶意命令。用户需要编辑ssh config，添加proxycommand，然后clone指定的git仓库，触发弹窗。投毒风险主要来自于作者可能在仓库中添加额外的恶意代码，例如在README.md中嵌入恶意链接，或者在其他看似无害的文件中隐藏Payload，但是从作者公布的演示视频和简单的代码来看，概率较低。

**项目地址:** [WLaoDuo/CVE-2023-51385_poc-test](https://github.com/WLaoDuo/CVE-2023-51385_poc-test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #7

**来源**: [CVE-2023-51385-WOOOOONG_CVE-2023-51385.md](../2023/CVE-2023-51385-WOOOOONG_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要用户名或主机名包含shell元字符，并且被expansion token引用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中存在的一个命令注入漏洞。当用户名或主机名包含 shell 元字符，并且这个名字在特定情况下被 expansion token 引用时，可能发生操作系统命令注入。例如，一个不受信任的 Git 仓库可能包含一个子模块，其用户名或主机名中包含 shell 元字符。PoC代码只包含README文件，没有实际的验证后门代码，因此判断投毒概率较低。但如果攻击者使用该 PoC 并修改相关代码，则可能存在投毒风险。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞确实存在，并且影响 OpenSSH 9.6 之前的版本。提供的 PoC 代码仅仅是一个 README 文件，只包含漏洞名称，没有实际的漏洞利用代码。因此，提供的PoC代码本身**不具备**直接的漏洞利用有效性，需要进一步开发利用代码。

**投毒风险：**
因为提供的 PoC 只是一个 README 文件，因此**不存在**明显的投毒代码。可以认为投毒的风险很低，接近0%。但也不能完全排除，因为这个仓库可能后续被修改，添加恶意代码。
综合考虑，给出的投毒风险为1%。

**利用方式：**
利用此漏洞的一种方法是，攻击者可以创建一个包含恶意子模块的 Git 仓库。该子模块的用户名或主机名包含 shell 元字符。当用户尝试克隆包含此子模块的仓库时，OpenSSH 可能会执行恶意命令。具体步骤如下：

1.  创建一个包含恶意子模块的 Git 仓库。
2.  确保子模块的用户名或主机名包含 shell 元字符，例如反引号 (`) 或美元符号 ($)。
3.  诱使用户克隆该仓库。
4.  当 OpenSSH 处理子模块信息时，由于存在命令注入漏洞，恶意命令将被执行。

另一种利用方式是通过 `ProxyCommand` 指令。攻击者可以配置 SSH 客户端，使其使用包含恶意 shell 元字符的用户名或主机名连接到目标服务器。当 OpenSSH 执行 `ProxyCommand` 时，恶意命令将被执行。

**优先级排序:**
搜索引擎结果 > 漏洞库信息 > 漏洞利用代码(因为提供的POC没有任何实质性代码)


**项目地址:** [WOOOOONG/CVE-2023-51385](https://github.com/WOOOOONG/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #8

**来源**: [CVE-2023-51385-c0deur_CVE-2023-51385.md](../2023/CVE-2023-51385-c0deur_CVE-2023-51385.md)

# CVE-2023-51385

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-51385-2048JiaLi_CVE-2023-51385.md](../2023/CVE-2023-51385-2048JiaLi_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要存在受影响的OpenSSH版本，并且用户或主机名包含shell元字符，在特定配置下触发ProxyCommand等功能。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-51385是OpenSSH中的一个命令注入漏洞。当用户名或主机名包含shell元字符时，且这些名称被特定情况下的扩展标记引用，就可能发生操作系统命令注入。例如，一个不受信任的Git仓库可能有一个子模块，其用户名或主机名中包含shell元字符。根据提供的POC代码，该代码尝试在`/var/www/html/flag`文件中写入'hello'。如果目标系统配置允许写入该文件，并且利用成功触发了命令注入，则POC有效。但是，这个POC本身并不具有明显的恶意投毒行为。更高级的利用可能涉及更复杂的payload，比如反弹shell。

利用方式：

1.  **恶意Git仓库:** 创建一个包含恶意子模块的Git仓库，该子模块的用户名或主机名包含shell元字符。
2.  **配置ProxyCommand:** 在`~/.ssh/config`文件中配置`ProxyCommand`选项，使其引用包含shell元字符的用户名或主机名。
3.  **触发漏洞:** 当OpenSSH处理这些配置时，由于shell元字符未正确转义，导致命令注入。
4.  **执行任意命令:** 攻击者可以利用命令注入执行任意操作系统命令。

**项目地址:** [2048JiaLi/CVE-2023-51385](https://github.com/2048JiaLi/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #2

**来源**: [CVE-2023-51385-Featherw1t_CVE-2023-51385_test.md](../2023/CVE-2023-51385-Featherw1t_CVE-2023-51385_test.md)

## CVE-2023-51385 OpenSSH 命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标主机使用受影响的OpenSSH版本，且`~/.ssh/config`文件中存在可利用的ProxyCommand配置或使用包含恶意构造的git submodule的git仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 Shell 元字符，并且这些名称在某些情况下被扩展令牌引用时，可能发生操作系统命令注入。漏洞利用方式是：

1.  **配置ProxyCommand：** 在 `~/.ssh/config` 文件中设置 `ProxyCommand`，其中包含恶意构造的命令。POC提供了一个使用`nc`命令的例子。
2.  **Git submodule 注入：**  攻击者可以创建一个包含恶意构造的 `.gitmodules` 文件的 Git 仓库。该文件中的 `url` 字段包含 shell 元字符，当用户尝试克隆该仓库并初始化子模块时，`git clone --recurse-submodules`命令会触发命令注入。

根据提供的POC代码，攻击者可以通过构造恶意的用户名或主机名（例如在 Git 子模块的 URL 中）来执行任意命令。

**有效性：** 提供的POC代码是有效的，因为它展示了如何利用该漏洞通过精心构造的Git仓库来触发命令注入。

**投毒风险：**

此仓库可能存在投毒风险，因为攻击者可能在`git clone`下来的脚本或者git仓库本身中加入恶意代码。风险评估为10%，因为提供的代码片段主要集中在漏洞利用上，但不能完全排除仓库作者在其他地方隐藏恶意代码的可能性。尤其需要关注通过`git clone --recurse-submodules`下载的其他脚本和文件。

**项目地址:** [Featherw1t/CVE-2023-51385_test](https://github.com/Featherw1t/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #3

**来源**: [CVE-2023-51385-Le1a_CVE-2023-51385.md](../2023/CVE-2023-51385-Le1a_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含shell元字符，且在特定情况下被扩展令牌引用。需要配置ProxyCommand。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH中的一个命令注入漏洞，存在于9.6版本之前。漏洞的根本原因是当用户名或主机名包含shell元字符时，如果这些名称在某些情况下被扩展令牌引用，可能导致操作系统命令注入。

**有效性：**

根据漏洞描述和提供的POC代码，该漏洞是有效的。POC代码演示了当ProxyCommand配置为`/usr/bin/nc -X connect -x 127.0.0.1:7890 %h %p`时，通过克隆包含恶意子模块（子模块的用户名或主机名包含shell元字符）的Git仓库，可以触发命令注入。

**投毒风险：**

提供的POC代码非常简洁，主要是通过`git clone`命令触发漏洞。直接在提供的`README.md`和命令中发现明显投毒代码的可能性较低。 但`git clone --recurse-submodules`本身会执行子模块中定义的操作，因此子模块本身的内容可能会包含恶意代码，但这不是漏洞利用代码本身的问题，而是Git子模块机制带来的风险。因此，判定投毒风险为10%，主要考虑子模块可能包含恶意代码的可能性。

**利用方式：**

1.  **配置ProxyCommand：** 首先，用户需要在`~/.ssh/config`文件中配置`ProxyCommand`，例如：

    ```
    Host *.com
      ProxyCommand /usr/bin/nc -X connect -x 127.0.0.1:7890 %h %p
    ```

2.  **克隆恶意Git仓库：** 攻击者创建一个包含恶意子模块的Git仓库。恶意子模块的URL包含shell元字符，例如，用户名或主机名包含反引号、美元符号等。

3.  **触发命令注入：** 当用户使用`git clone --recurse-submodules`克隆该恶意仓库时，Git会自动初始化和更新子模块。在处理恶意子模块的URL时，OpenSSH会对其进行不正确的转义，导致shell元字符被解释执行，从而实现命令注入。

**总结：**

此漏洞的利用依赖于特定的OpenSSH配置（`ProxyCommand`）和恶意的Git仓库。攻击者通过控制Git仓库中的子模块URL，可以注入任意命令。修复此漏洞的方法是升级到OpenSSH 9.6或更高版本，或者避免在用户名或主机名中使用shell元字符。

**项目地址:** [Le1a/CVE-2023-51385](https://github.com/Le1a/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #4

**来源**: [CVE-2023-51385-LtmThink_CVE-2023-51385_test.md](../2023/CVE-2023-51385-LtmThink_CVE-2023-51385_test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6p1

**利用条件:** 需要用户clone包含恶意.gitmodules的git仓库，并配置ssh config中的ProxyCommand。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。该漏洞是由于 OpenSSH 在处理用户名或主机名中包含 Shell 元字符时，没有进行充分的过滤，导致可以通过特定的扩展令牌进行操作系统命令注入。

**利用方式：**
1.  **恶意 Git 仓库：** 攻击者创建一个包含恶意 `.gitmodules` 文件的 Git 仓库。该文件中的 `url` 字段包含恶意命令，例如：
    ```
    url = ssh://`echo helloworld > cve.txt`foo.example.com/bar
    ```
2.  **SSH 配置：** 受害者需要在 `~/.ssh/config` 文件中设置 `ProxyCommand` 指令，并匹配恶意域名，例如：
    ```
    host *.example.com
      ProxyCommand /usr/bin/nc -X connect -x 192.0.2.0:8080 %h %p
    ```
3.  **触发漏洞：** 受害者使用 `git clone --recurse-submodules` 命令克隆恶意 Git 仓库，`--recurse-submodules` 选项会导致 Git 读取 `.gitmodules` 文件，并执行其中 `url` 字段中的恶意命令，从而实现远程代码执行。

**有效性：**
提供的POC代码有效，已经验证可以触发命令执行。

**投毒风险：**
该仓库主要用于漏洞验证，虽然作者在博客中公开了漏洞原理，并且提供了验证代码，但是依然存在一定的投毒风险，例如：

1.  **利用代码本身：**  `ProxyCommand`  配置需要用户手动设置，如果攻击者提供一个包含更复杂、更隐蔽的命令注入payload的 `.gitmodules` 文件，用户在不知情的情况下克隆该仓库，可能会被植入后门或者执行其他恶意操作。
2.  **利用关联仓库：** 攻击者可能在看似无害的其他文件中隐藏恶意代码，例如图片，或者其他git hook脚本。如果用户不仔细检查，可能会忽略这些恶意代码。

考虑到以上因素，初步判断投毒风险为10%。

**项目地址:** [LtmThink/CVE-2023-51385_test](https://github.com/LtmThink/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #5

**来源**: [CVE-2023-51385-MiningBot-eth_CVE-2023-51385-exploit.md](../2023/CVE-2023-51385-MiningBot-eth_CVE-2023-51385-exploit.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要受害者使用受污染的用户名或主机名连接到攻击者控制的服务器，或者受害者访问包含恶意子模块的 Git 仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符时，可能发生操作系统命令注入。例如，如果一个不受信任的 Git 仓库有一个子模块，该子模块的用户名或主机名包含 shell 元字符，则可能触发此漏洞。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意配置的 Git 仓库，其中子模块的用户名或主机名包含 shell 元字符。
2.  或者，攻击者控制一个 SSH 服务器，并设置包含恶意 shell 元字符的用户名或主机名。
3.  受害者克隆恶意 Git 仓库或使用易受攻击的 OpenSSH 客户端连接到攻击者控制的 SSH 服务器。
4.  OpenSSH 在处理用户名或主机名时，由于未正确转义 shell 元字符，导致命令注入，执行攻击者控制的恶意命令。

**有效性：**
根据漏洞描述和搜索结果，此漏洞是有效的。许多安全厂商和组织都发布了关于此漏洞的公告和修复建议。

**投毒风险：**
提供的 POC 代码 `/tmp/d37649a81685a000f41564edc2078d9f/README.md` 仅仅包含了一个 README.md 文件，内容为 `# CVE-2023-51385-exploit`。 虽然这个文件本身不包含任何恶意代码，但不能完全排除整个仓库中存在其他隐藏的投毒代码的可能性。假设仓库中存在其他恶意脚本或配置文件的可能性是 10%。 这个README文件仅仅是声明，没有体现exp代码，无法验证漏洞。


**项目地址:** [MiningBot-eth/CVE-2023-51385-exploit](https://github.com/MiningBot-eth/CVE-2023-51385-exploit)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #6

**来源**: [CVE-2023-51385-WLaoDuo_CVE-2023-51385_poc-test.md](../2023/CVE-2023-51385-WLaoDuo_CVE-2023-51385_poc-test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 目标用户使用了受影响的OpenSSH版本，并且配置了ProxyCommand，clone包含恶意配置的git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。当用户名或主机名包含shell元字符，并且该名称在某些情况下被扩展标记引用时，可能会发生操作系统命令注入。POC利用方式是通过精心构造包含恶意配置的Git仓库，当用户clone该仓库时，其中的子模块配置会触发ProxyCommand中的命令注入，从而执行攻击者预设的恶意命令。用户需要编辑ssh config，添加proxycommand，然后clone指定的git仓库，触发弹窗。投毒风险主要来自于作者可能在仓库中添加额外的恶意代码，例如在README.md中嵌入恶意链接，或者在其他看似无害的文件中隐藏Payload，但是从作者公布的演示视频和简单的代码来看，概率较低。

**项目地址:** [WLaoDuo/CVE-2023-51385_poc-test](https://github.com/WLaoDuo/CVE-2023-51385_poc-test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #7

**来源**: [CVE-2023-51385-WOOOOONG_CVE-2023-51385.md](../2023/CVE-2023-51385-WOOOOONG_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要用户名或主机名包含shell元字符，并且被expansion token引用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中存在的一个命令注入漏洞。当用户名或主机名包含 shell 元字符，并且这个名字在特定情况下被 expansion token 引用时，可能发生操作系统命令注入。例如，一个不受信任的 Git 仓库可能包含一个子模块，其用户名或主机名中包含 shell 元字符。PoC代码只包含README文件，没有实际的验证后门代码，因此判断投毒概率较低。但如果攻击者使用该 PoC 并修改相关代码，则可能存在投毒风险。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞确实存在，并且影响 OpenSSH 9.6 之前的版本。提供的 PoC 代码仅仅是一个 README 文件，只包含漏洞名称，没有实际的漏洞利用代码。因此，提供的PoC代码本身**不具备**直接的漏洞利用有效性，需要进一步开发利用代码。

**投毒风险：**
因为提供的 PoC 只是一个 README 文件，因此**不存在**明显的投毒代码。可以认为投毒的风险很低，接近0%。但也不能完全排除，因为这个仓库可能后续被修改，添加恶意代码。
综合考虑，给出的投毒风险为1%。

**利用方式：**
利用此漏洞的一种方法是，攻击者可以创建一个包含恶意子模块的 Git 仓库。该子模块的用户名或主机名包含 shell 元字符。当用户尝试克隆包含此子模块的仓库时，OpenSSH 可能会执行恶意命令。具体步骤如下：

1.  创建一个包含恶意子模块的 Git 仓库。
2.  确保子模块的用户名或主机名包含 shell 元字符，例如反引号 (`) 或美元符号 ($)。
3.  诱使用户克隆该仓库。
4.  当 OpenSSH 处理子模块信息时，由于存在命令注入漏洞，恶意命令将被执行。

另一种利用方式是通过 `ProxyCommand` 指令。攻击者可以配置 SSH 客户端，使其使用包含恶意 shell 元字符的用户名或主机名连接到目标服务器。当 OpenSSH 执行 `ProxyCommand` 时，恶意命令将被执行。

**优先级排序:**
搜索引擎结果 > 漏洞库信息 > 漏洞利用代码(因为提供的POC没有任何实质性代码)


**项目地址:** [WOOOOONG/CVE-2023-51385](https://github.com/WOOOOONG/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #8

**来源**: [CVE-2023-51385-c0deur_CVE-2023-51385.md](../2023/CVE-2023-51385-c0deur_CVE-2023-51385.md)

# CVE-2023-51385

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-51385-2048JiaLi_CVE-2023-51385.md](../2023/CVE-2023-51385-2048JiaLi_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要存在受影响的OpenSSH版本，并且用户或主机名包含shell元字符，在特定配置下触发ProxyCommand等功能。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-51385是OpenSSH中的一个命令注入漏洞。当用户名或主机名包含shell元字符时，且这些名称被特定情况下的扩展标记引用，就可能发生操作系统命令注入。例如，一个不受信任的Git仓库可能有一个子模块，其用户名或主机名中包含shell元字符。根据提供的POC代码，该代码尝试在`/var/www/html/flag`文件中写入'hello'。如果目标系统配置允许写入该文件，并且利用成功触发了命令注入，则POC有效。但是，这个POC本身并不具有明显的恶意投毒行为。更高级的利用可能涉及更复杂的payload，比如反弹shell。

利用方式：

1.  **恶意Git仓库:** 创建一个包含恶意子模块的Git仓库，该子模块的用户名或主机名包含shell元字符。
2.  **配置ProxyCommand:** 在`~/.ssh/config`文件中配置`ProxyCommand`选项，使其引用包含shell元字符的用户名或主机名。
3.  **触发漏洞:** 当OpenSSH处理这些配置时，由于shell元字符未正确转义，导致命令注入。
4.  **执行任意命令:** 攻击者可以利用命令注入执行任意操作系统命令。

**项目地址:** [2048JiaLi/CVE-2023-51385](https://github.com/2048JiaLi/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #2

**来源**: [CVE-2023-51385-Featherw1t_CVE-2023-51385_test.md](../2023/CVE-2023-51385-Featherw1t_CVE-2023-51385_test.md)

## CVE-2023-51385 OpenSSH 命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标主机使用受影响的OpenSSH版本，且`~/.ssh/config`文件中存在可利用的ProxyCommand配置或使用包含恶意构造的git submodule的git仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 Shell 元字符，并且这些名称在某些情况下被扩展令牌引用时，可能发生操作系统命令注入。漏洞利用方式是：

1.  **配置ProxyCommand：** 在 `~/.ssh/config` 文件中设置 `ProxyCommand`，其中包含恶意构造的命令。POC提供了一个使用`nc`命令的例子。
2.  **Git submodule 注入：**  攻击者可以创建一个包含恶意构造的 `.gitmodules` 文件的 Git 仓库。该文件中的 `url` 字段包含 shell 元字符，当用户尝试克隆该仓库并初始化子模块时，`git clone --recurse-submodules`命令会触发命令注入。

根据提供的POC代码，攻击者可以通过构造恶意的用户名或主机名（例如在 Git 子模块的 URL 中）来执行任意命令。

**有效性：** 提供的POC代码是有效的，因为它展示了如何利用该漏洞通过精心构造的Git仓库来触发命令注入。

**投毒风险：**

此仓库可能存在投毒风险，因为攻击者可能在`git clone`下来的脚本或者git仓库本身中加入恶意代码。风险评估为10%，因为提供的代码片段主要集中在漏洞利用上，但不能完全排除仓库作者在其他地方隐藏恶意代码的可能性。尤其需要关注通过`git clone --recurse-submodules`下载的其他脚本和文件。

**项目地址:** [Featherw1t/CVE-2023-51385_test](https://github.com/Featherw1t/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #3

**来源**: [CVE-2023-51385-Le1a_CVE-2023-51385.md](../2023/CVE-2023-51385-Le1a_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含shell元字符，且在特定情况下被扩展令牌引用。需要配置ProxyCommand。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH中的一个命令注入漏洞，存在于9.6版本之前。漏洞的根本原因是当用户名或主机名包含shell元字符时，如果这些名称在某些情况下被扩展令牌引用，可能导致操作系统命令注入。

**有效性：**

根据漏洞描述和提供的POC代码，该漏洞是有效的。POC代码演示了当ProxyCommand配置为`/usr/bin/nc -X connect -x 127.0.0.1:7890 %h %p`时，通过克隆包含恶意子模块（子模块的用户名或主机名包含shell元字符）的Git仓库，可以触发命令注入。

**投毒风险：**

提供的POC代码非常简洁，主要是通过`git clone`命令触发漏洞。直接在提供的`README.md`和命令中发现明显投毒代码的可能性较低。 但`git clone --recurse-submodules`本身会执行子模块中定义的操作，因此子模块本身的内容可能会包含恶意代码，但这不是漏洞利用代码本身的问题，而是Git子模块机制带来的风险。因此，判定投毒风险为10%，主要考虑子模块可能包含恶意代码的可能性。

**利用方式：**

1.  **配置ProxyCommand：** 首先，用户需要在`~/.ssh/config`文件中配置`ProxyCommand`，例如：

    ```
    Host *.com
      ProxyCommand /usr/bin/nc -X connect -x 127.0.0.1:7890 %h %p
    ```

2.  **克隆恶意Git仓库：** 攻击者创建一个包含恶意子模块的Git仓库。恶意子模块的URL包含shell元字符，例如，用户名或主机名包含反引号、美元符号等。

3.  **触发命令注入：** 当用户使用`git clone --recurse-submodules`克隆该恶意仓库时，Git会自动初始化和更新子模块。在处理恶意子模块的URL时，OpenSSH会对其进行不正确的转义，导致shell元字符被解释执行，从而实现命令注入。

**总结：**

此漏洞的利用依赖于特定的OpenSSH配置（`ProxyCommand`）和恶意的Git仓库。攻击者通过控制Git仓库中的子模块URL，可以注入任意命令。修复此漏洞的方法是升级到OpenSSH 9.6或更高版本，或者避免在用户名或主机名中使用shell元字符。

**项目地址:** [Le1a/CVE-2023-51385](https://github.com/Le1a/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #4

**来源**: [CVE-2023-51385-LtmThink_CVE-2023-51385_test.md](../2023/CVE-2023-51385-LtmThink_CVE-2023-51385_test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6p1

**利用条件:** 需要用户clone包含恶意.gitmodules的git仓库，并配置ssh config中的ProxyCommand。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。该漏洞是由于 OpenSSH 在处理用户名或主机名中包含 Shell 元字符时，没有进行充分的过滤，导致可以通过特定的扩展令牌进行操作系统命令注入。

**利用方式：**
1.  **恶意 Git 仓库：** 攻击者创建一个包含恶意 `.gitmodules` 文件的 Git 仓库。该文件中的 `url` 字段包含恶意命令，例如：
    ```
    url = ssh://`echo helloworld > cve.txt`foo.example.com/bar
    ```
2.  **SSH 配置：** 受害者需要在 `~/.ssh/config` 文件中设置 `ProxyCommand` 指令，并匹配恶意域名，例如：
    ```
    host *.example.com
      ProxyCommand /usr/bin/nc -X connect -x 192.0.2.0:8080 %h %p
    ```
3.  **触发漏洞：** 受害者使用 `git clone --recurse-submodules` 命令克隆恶意 Git 仓库，`--recurse-submodules` 选项会导致 Git 读取 `.gitmodules` 文件，并执行其中 `url` 字段中的恶意命令，从而实现远程代码执行。

**有效性：**
提供的POC代码有效，已经验证可以触发命令执行。

**投毒风险：**
该仓库主要用于漏洞验证，虽然作者在博客中公开了漏洞原理，并且提供了验证代码，但是依然存在一定的投毒风险，例如：

1.  **利用代码本身：**  `ProxyCommand`  配置需要用户手动设置，如果攻击者提供一个包含更复杂、更隐蔽的命令注入payload的 `.gitmodules` 文件，用户在不知情的情况下克隆该仓库，可能会被植入后门或者执行其他恶意操作。
2.  **利用关联仓库：** 攻击者可能在看似无害的其他文件中隐藏恶意代码，例如图片，或者其他git hook脚本。如果用户不仔细检查，可能会忽略这些恶意代码。

考虑到以上因素，初步判断投毒风险为10%。

**项目地址:** [LtmThink/CVE-2023-51385_test](https://github.com/LtmThink/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #5

**来源**: [CVE-2023-51385-MiningBot-eth_CVE-2023-51385-exploit.md](../2023/CVE-2023-51385-MiningBot-eth_CVE-2023-51385-exploit.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要受害者使用受污染的用户名或主机名连接到攻击者控制的服务器，或者受害者访问包含恶意子模块的 Git 仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符时，可能发生操作系统命令注入。例如，如果一个不受信任的 Git 仓库有一个子模块，该子模块的用户名或主机名包含 shell 元字符，则可能触发此漏洞。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意配置的 Git 仓库，其中子模块的用户名或主机名包含 shell 元字符。
2.  或者，攻击者控制一个 SSH 服务器，并设置包含恶意 shell 元字符的用户名或主机名。
3.  受害者克隆恶意 Git 仓库或使用易受攻击的 OpenSSH 客户端连接到攻击者控制的 SSH 服务器。
4.  OpenSSH 在处理用户名或主机名时，由于未正确转义 shell 元字符，导致命令注入，执行攻击者控制的恶意命令。

**有效性：**
根据漏洞描述和搜索结果，此漏洞是有效的。许多安全厂商和组织都发布了关于此漏洞的公告和修复建议。

**投毒风险：**
提供的 POC 代码 `/tmp/d37649a81685a000f41564edc2078d9f/README.md` 仅仅包含了一个 README.md 文件，内容为 `# CVE-2023-51385-exploit`。 虽然这个文件本身不包含任何恶意代码，但不能完全排除整个仓库中存在其他隐藏的投毒代码的可能性。假设仓库中存在其他恶意脚本或配置文件的可能性是 10%。 这个README文件仅仅是声明，没有体现exp代码，无法验证漏洞。


**项目地址:** [MiningBot-eth/CVE-2023-51385-exploit](https://github.com/MiningBot-eth/CVE-2023-51385-exploit)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #6

**来源**: [CVE-2023-51385-WLaoDuo_CVE-2023-51385_poc-test.md](../2023/CVE-2023-51385-WLaoDuo_CVE-2023-51385_poc-test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 目标用户使用了受影响的OpenSSH版本，并且配置了ProxyCommand，clone包含恶意配置的git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。当用户名或主机名包含shell元字符，并且该名称在某些情况下被扩展标记引用时，可能会发生操作系统命令注入。POC利用方式是通过精心构造包含恶意配置的Git仓库，当用户clone该仓库时，其中的子模块配置会触发ProxyCommand中的命令注入，从而执行攻击者预设的恶意命令。用户需要编辑ssh config，添加proxycommand，然后clone指定的git仓库，触发弹窗。投毒风险主要来自于作者可能在仓库中添加额外的恶意代码，例如在README.md中嵌入恶意链接，或者在其他看似无害的文件中隐藏Payload，但是从作者公布的演示视频和简单的代码来看，概率较低。

**项目地址:** [WLaoDuo/CVE-2023-51385_poc-test](https://github.com/WLaoDuo/CVE-2023-51385_poc-test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #7

**来源**: [CVE-2023-51385-WOOOOONG_CVE-2023-51385.md](../2023/CVE-2023-51385-WOOOOONG_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要用户名或主机名包含shell元字符，并且被expansion token引用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中存在的一个命令注入漏洞。当用户名或主机名包含 shell 元字符，并且这个名字在特定情况下被 expansion token 引用时，可能发生操作系统命令注入。例如，一个不受信任的 Git 仓库可能包含一个子模块，其用户名或主机名中包含 shell 元字符。PoC代码只包含README文件，没有实际的验证后门代码，因此判断投毒概率较低。但如果攻击者使用该 PoC 并修改相关代码，则可能存在投毒风险。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞确实存在，并且影响 OpenSSH 9.6 之前的版本。提供的 PoC 代码仅仅是一个 README 文件，只包含漏洞名称，没有实际的漏洞利用代码。因此，提供的PoC代码本身**不具备**直接的漏洞利用有效性，需要进一步开发利用代码。

**投毒风险：**
因为提供的 PoC 只是一个 README 文件，因此**不存在**明显的投毒代码。可以认为投毒的风险很低，接近0%。但也不能完全排除，因为这个仓库可能后续被修改，添加恶意代码。
综合考虑，给出的投毒风险为1%。

**利用方式：**
利用此漏洞的一种方法是，攻击者可以创建一个包含恶意子模块的 Git 仓库。该子模块的用户名或主机名包含 shell 元字符。当用户尝试克隆包含此子模块的仓库时，OpenSSH 可能会执行恶意命令。具体步骤如下：

1.  创建一个包含恶意子模块的 Git 仓库。
2.  确保子模块的用户名或主机名包含 shell 元字符，例如反引号 (`) 或美元符号 ($)。
3.  诱使用户克隆该仓库。
4.  当 OpenSSH 处理子模块信息时，由于存在命令注入漏洞，恶意命令将被执行。

另一种利用方式是通过 `ProxyCommand` 指令。攻击者可以配置 SSH 客户端，使其使用包含恶意 shell 元字符的用户名或主机名连接到目标服务器。当 OpenSSH 执行 `ProxyCommand` 时，恶意命令将被执行。

**优先级排序:**
搜索引擎结果 > 漏洞库信息 > 漏洞利用代码(因为提供的POC没有任何实质性代码)


**项目地址:** [WOOOOONG/CVE-2023-51385](https://github.com/WOOOOONG/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #8

**来源**: [CVE-2023-51385-c0deur_CVE-2023-51385.md](../2023/CVE-2023-51385-c0deur_CVE-2023-51385.md)

# CVE-2023-51385

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-51385-2048JiaLi_CVE-2023-51385.md](../2023/CVE-2023-51385-2048JiaLi_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要存在受影响的OpenSSH版本，并且用户或主机名包含shell元字符，在特定配置下触发ProxyCommand等功能。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-51385是OpenSSH中的一个命令注入漏洞。当用户名或主机名包含shell元字符时，且这些名称被特定情况下的扩展标记引用，就可能发生操作系统命令注入。例如，一个不受信任的Git仓库可能有一个子模块，其用户名或主机名中包含shell元字符。根据提供的POC代码，该代码尝试在`/var/www/html/flag`文件中写入'hello'。如果目标系统配置允许写入该文件，并且利用成功触发了命令注入，则POC有效。但是，这个POC本身并不具有明显的恶意投毒行为。更高级的利用可能涉及更复杂的payload，比如反弹shell。

利用方式：

1.  **恶意Git仓库:** 创建一个包含恶意子模块的Git仓库，该子模块的用户名或主机名包含shell元字符。
2.  **配置ProxyCommand:** 在`~/.ssh/config`文件中配置`ProxyCommand`选项，使其引用包含shell元字符的用户名或主机名。
3.  **触发漏洞:** 当OpenSSH处理这些配置时，由于shell元字符未正确转义，导致命令注入。
4.  **执行任意命令:** 攻击者可以利用命令注入执行任意操作系统命令。

**项目地址:** [2048JiaLi/CVE-2023-51385](https://github.com/2048JiaLi/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #2

**来源**: [CVE-2023-51385-Featherw1t_CVE-2023-51385_test.md](../2023/CVE-2023-51385-Featherw1t_CVE-2023-51385_test.md)

## CVE-2023-51385 OpenSSH 命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标主机使用受影响的OpenSSH版本，且`~/.ssh/config`文件中存在可利用的ProxyCommand配置或使用包含恶意构造的git submodule的git仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 Shell 元字符，并且这些名称在某些情况下被扩展令牌引用时，可能发生操作系统命令注入。漏洞利用方式是：

1.  **配置ProxyCommand：** 在 `~/.ssh/config` 文件中设置 `ProxyCommand`，其中包含恶意构造的命令。POC提供了一个使用`nc`命令的例子。
2.  **Git submodule 注入：**  攻击者可以创建一个包含恶意构造的 `.gitmodules` 文件的 Git 仓库。该文件中的 `url` 字段包含 shell 元字符，当用户尝试克隆该仓库并初始化子模块时，`git clone --recurse-submodules`命令会触发命令注入。

根据提供的POC代码，攻击者可以通过构造恶意的用户名或主机名（例如在 Git 子模块的 URL 中）来执行任意命令。

**有效性：** 提供的POC代码是有效的，因为它展示了如何利用该漏洞通过精心构造的Git仓库来触发命令注入。

**投毒风险：**

此仓库可能存在投毒风险，因为攻击者可能在`git clone`下来的脚本或者git仓库本身中加入恶意代码。风险评估为10%，因为提供的代码片段主要集中在漏洞利用上，但不能完全排除仓库作者在其他地方隐藏恶意代码的可能性。尤其需要关注通过`git clone --recurse-submodules`下载的其他脚本和文件。

**项目地址:** [Featherw1t/CVE-2023-51385_test](https://github.com/Featherw1t/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #3

**来源**: [CVE-2023-51385-Le1a_CVE-2023-51385.md](../2023/CVE-2023-51385-Le1a_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含shell元字符，且在特定情况下被扩展令牌引用。需要配置ProxyCommand。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH中的一个命令注入漏洞，存在于9.6版本之前。漏洞的根本原因是当用户名或主机名包含shell元字符时，如果这些名称在某些情况下被扩展令牌引用，可能导致操作系统命令注入。

**有效性：**

根据漏洞描述和提供的POC代码，该漏洞是有效的。POC代码演示了当ProxyCommand配置为`/usr/bin/nc -X connect -x 127.0.0.1:7890 %h %p`时，通过克隆包含恶意子模块（子模块的用户名或主机名包含shell元字符）的Git仓库，可以触发命令注入。

**投毒风险：**

提供的POC代码非常简洁，主要是通过`git clone`命令触发漏洞。直接在提供的`README.md`和命令中发现明显投毒代码的可能性较低。 但`git clone --recurse-submodules`本身会执行子模块中定义的操作，因此子模块本身的内容可能会包含恶意代码，但这不是漏洞利用代码本身的问题，而是Git子模块机制带来的风险。因此，判定投毒风险为10%，主要考虑子模块可能包含恶意代码的可能性。

**利用方式：**

1.  **配置ProxyCommand：** 首先，用户需要在`~/.ssh/config`文件中配置`ProxyCommand`，例如：

    ```
    Host *.com
      ProxyCommand /usr/bin/nc -X connect -x 127.0.0.1:7890 %h %p
    ```

2.  **克隆恶意Git仓库：** 攻击者创建一个包含恶意子模块的Git仓库。恶意子模块的URL包含shell元字符，例如，用户名或主机名包含反引号、美元符号等。

3.  **触发命令注入：** 当用户使用`git clone --recurse-submodules`克隆该恶意仓库时，Git会自动初始化和更新子模块。在处理恶意子模块的URL时，OpenSSH会对其进行不正确的转义，导致shell元字符被解释执行，从而实现命令注入。

**总结：**

此漏洞的利用依赖于特定的OpenSSH配置（`ProxyCommand`）和恶意的Git仓库。攻击者通过控制Git仓库中的子模块URL，可以注入任意命令。修复此漏洞的方法是升级到OpenSSH 9.6或更高版本，或者避免在用户名或主机名中使用shell元字符。

**项目地址:** [Le1a/CVE-2023-51385](https://github.com/Le1a/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #4

**来源**: [CVE-2023-51385-LtmThink_CVE-2023-51385_test.md](../2023/CVE-2023-51385-LtmThink_CVE-2023-51385_test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6p1

**利用条件:** 需要用户clone包含恶意.gitmodules的git仓库，并配置ssh config中的ProxyCommand。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。该漏洞是由于 OpenSSH 在处理用户名或主机名中包含 Shell 元字符时，没有进行充分的过滤，导致可以通过特定的扩展令牌进行操作系统命令注入。

**利用方式：**
1.  **恶意 Git 仓库：** 攻击者创建一个包含恶意 `.gitmodules` 文件的 Git 仓库。该文件中的 `url` 字段包含恶意命令，例如：
    ```
    url = ssh://`echo helloworld > cve.txt`foo.example.com/bar
    ```
2.  **SSH 配置：** 受害者需要在 `~/.ssh/config` 文件中设置 `ProxyCommand` 指令，并匹配恶意域名，例如：
    ```
    host *.example.com
      ProxyCommand /usr/bin/nc -X connect -x 192.0.2.0:8080 %h %p
    ```
3.  **触发漏洞：** 受害者使用 `git clone --recurse-submodules` 命令克隆恶意 Git 仓库，`--recurse-submodules` 选项会导致 Git 读取 `.gitmodules` 文件，并执行其中 `url` 字段中的恶意命令，从而实现远程代码执行。

**有效性：**
提供的POC代码有效，已经验证可以触发命令执行。

**投毒风险：**
该仓库主要用于漏洞验证，虽然作者在博客中公开了漏洞原理，并且提供了验证代码，但是依然存在一定的投毒风险，例如：

1.  **利用代码本身：**  `ProxyCommand`  配置需要用户手动设置，如果攻击者提供一个包含更复杂、更隐蔽的命令注入payload的 `.gitmodules` 文件，用户在不知情的情况下克隆该仓库，可能会被植入后门或者执行其他恶意操作。
2.  **利用关联仓库：** 攻击者可能在看似无害的其他文件中隐藏恶意代码，例如图片，或者其他git hook脚本。如果用户不仔细检查，可能会忽略这些恶意代码。

考虑到以上因素，初步判断投毒风险为10%。

**项目地址:** [LtmThink/CVE-2023-51385_test](https://github.com/LtmThink/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #5

**来源**: [CVE-2023-51385-MiningBot-eth_CVE-2023-51385-exploit.md](../2023/CVE-2023-51385-MiningBot-eth_CVE-2023-51385-exploit.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要受害者使用受污染的用户名或主机名连接到攻击者控制的服务器，或者受害者访问包含恶意子模块的 Git 仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符时，可能发生操作系统命令注入。例如，如果一个不受信任的 Git 仓库有一个子模块，该子模块的用户名或主机名包含 shell 元字符，则可能触发此漏洞。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意配置的 Git 仓库，其中子模块的用户名或主机名包含 shell 元字符。
2.  或者，攻击者控制一个 SSH 服务器，并设置包含恶意 shell 元字符的用户名或主机名。
3.  受害者克隆恶意 Git 仓库或使用易受攻击的 OpenSSH 客户端连接到攻击者控制的 SSH 服务器。
4.  OpenSSH 在处理用户名或主机名时，由于未正确转义 shell 元字符，导致命令注入，执行攻击者控制的恶意命令。

**有效性：**
根据漏洞描述和搜索结果，此漏洞是有效的。许多安全厂商和组织都发布了关于此漏洞的公告和修复建议。

**投毒风险：**
提供的 POC 代码 `/tmp/d37649a81685a000f41564edc2078d9f/README.md` 仅仅包含了一个 README.md 文件，内容为 `# CVE-2023-51385-exploit`。 虽然这个文件本身不包含任何恶意代码，但不能完全排除整个仓库中存在其他隐藏的投毒代码的可能性。假设仓库中存在其他恶意脚本或配置文件的可能性是 10%。 这个README文件仅仅是声明，没有体现exp代码，无法验证漏洞。


**项目地址:** [MiningBot-eth/CVE-2023-51385-exploit](https://github.com/MiningBot-eth/CVE-2023-51385-exploit)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #6

**来源**: [CVE-2023-51385-WLaoDuo_CVE-2023-51385_poc-test.md](../2023/CVE-2023-51385-WLaoDuo_CVE-2023-51385_poc-test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 目标用户使用了受影响的OpenSSH版本，并且配置了ProxyCommand，clone包含恶意配置的git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。当用户名或主机名包含shell元字符，并且该名称在某些情况下被扩展标记引用时，可能会发生操作系统命令注入。POC利用方式是通过精心构造包含恶意配置的Git仓库，当用户clone该仓库时，其中的子模块配置会触发ProxyCommand中的命令注入，从而执行攻击者预设的恶意命令。用户需要编辑ssh config，添加proxycommand，然后clone指定的git仓库，触发弹窗。投毒风险主要来自于作者可能在仓库中添加额外的恶意代码，例如在README.md中嵌入恶意链接，或者在其他看似无害的文件中隐藏Payload，但是从作者公布的演示视频和简单的代码来看，概率较低。

**项目地址:** [WLaoDuo/CVE-2023-51385_poc-test](https://github.com/WLaoDuo/CVE-2023-51385_poc-test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #7

**来源**: [CVE-2023-51385-WOOOOONG_CVE-2023-51385.md](../2023/CVE-2023-51385-WOOOOONG_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要用户名或主机名包含shell元字符，并且被expansion token引用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中存在的一个命令注入漏洞。当用户名或主机名包含 shell 元字符，并且这个名字在特定情况下被 expansion token 引用时，可能发生操作系统命令注入。例如，一个不受信任的 Git 仓库可能包含一个子模块，其用户名或主机名中包含 shell 元字符。PoC代码只包含README文件，没有实际的验证后门代码，因此判断投毒概率较低。但如果攻击者使用该 PoC 并修改相关代码，则可能存在投毒风险。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞确实存在，并且影响 OpenSSH 9.6 之前的版本。提供的 PoC 代码仅仅是一个 README 文件，只包含漏洞名称，没有实际的漏洞利用代码。因此，提供的PoC代码本身**不具备**直接的漏洞利用有效性，需要进一步开发利用代码。

**投毒风险：**
因为提供的 PoC 只是一个 README 文件，因此**不存在**明显的投毒代码。可以认为投毒的风险很低，接近0%。但也不能完全排除，因为这个仓库可能后续被修改，添加恶意代码。
综合考虑，给出的投毒风险为1%。

**利用方式：**
利用此漏洞的一种方法是，攻击者可以创建一个包含恶意子模块的 Git 仓库。该子模块的用户名或主机名包含 shell 元字符。当用户尝试克隆包含此子模块的仓库时，OpenSSH 可能会执行恶意命令。具体步骤如下：

1.  创建一个包含恶意子模块的 Git 仓库。
2.  确保子模块的用户名或主机名包含 shell 元字符，例如反引号 (`) 或美元符号 ($)。
3.  诱使用户克隆该仓库。
4.  当 OpenSSH 处理子模块信息时，由于存在命令注入漏洞，恶意命令将被执行。

另一种利用方式是通过 `ProxyCommand` 指令。攻击者可以配置 SSH 客户端，使其使用包含恶意 shell 元字符的用户名或主机名连接到目标服务器。当 OpenSSH 执行 `ProxyCommand` 时，恶意命令将被执行。

**优先级排序:**
搜索引擎结果 > 漏洞库信息 > 漏洞利用代码(因为提供的POC没有任何实质性代码)


**项目地址:** [WOOOOONG/CVE-2023-51385](https://github.com/WOOOOONG/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #8

**来源**: [CVE-2023-51385-c0deur_CVE-2023-51385.md](../2023/CVE-2023-51385-c0deur_CVE-2023-51385.md)

# CVE-2023-51385

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-51385-2048JiaLi_CVE-2023-51385.md](../2023/CVE-2023-51385-2048JiaLi_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要存在受影响的OpenSSH版本，并且用户或主机名包含shell元字符，在特定配置下触发ProxyCommand等功能。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-51385是OpenSSH中的一个命令注入漏洞。当用户名或主机名包含shell元字符时，且这些名称被特定情况下的扩展标记引用，就可能发生操作系统命令注入。例如，一个不受信任的Git仓库可能有一个子模块，其用户名或主机名中包含shell元字符。根据提供的POC代码，该代码尝试在`/var/www/html/flag`文件中写入'hello'。如果目标系统配置允许写入该文件，并且利用成功触发了命令注入，则POC有效。但是，这个POC本身并不具有明显的恶意投毒行为。更高级的利用可能涉及更复杂的payload，比如反弹shell。

利用方式：

1.  **恶意Git仓库:** 创建一个包含恶意子模块的Git仓库，该子模块的用户名或主机名包含shell元字符。
2.  **配置ProxyCommand:** 在`~/.ssh/config`文件中配置`ProxyCommand`选项，使其引用包含shell元字符的用户名或主机名。
3.  **触发漏洞:** 当OpenSSH处理这些配置时，由于shell元字符未正确转义，导致命令注入。
4.  **执行任意命令:** 攻击者可以利用命令注入执行任意操作系统命令。

**项目地址:** [2048JiaLi/CVE-2023-51385](https://github.com/2048JiaLi/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #2

**来源**: [CVE-2023-51385-Featherw1t_CVE-2023-51385_test.md](../2023/CVE-2023-51385-Featherw1t_CVE-2023-51385_test.md)

## CVE-2023-51385 OpenSSH 命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标主机使用受影响的OpenSSH版本，且`~/.ssh/config`文件中存在可利用的ProxyCommand配置或使用包含恶意构造的git submodule的git仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 Shell 元字符，并且这些名称在某些情况下被扩展令牌引用时，可能发生操作系统命令注入。漏洞利用方式是：

1.  **配置ProxyCommand：** 在 `~/.ssh/config` 文件中设置 `ProxyCommand`，其中包含恶意构造的命令。POC提供了一个使用`nc`命令的例子。
2.  **Git submodule 注入：**  攻击者可以创建一个包含恶意构造的 `.gitmodules` 文件的 Git 仓库。该文件中的 `url` 字段包含 shell 元字符，当用户尝试克隆该仓库并初始化子模块时，`git clone --recurse-submodules`命令会触发命令注入。

根据提供的POC代码，攻击者可以通过构造恶意的用户名或主机名（例如在 Git 子模块的 URL 中）来执行任意命令。

**有效性：** 提供的POC代码是有效的，因为它展示了如何利用该漏洞通过精心构造的Git仓库来触发命令注入。

**投毒风险：**

此仓库可能存在投毒风险，因为攻击者可能在`git clone`下来的脚本或者git仓库本身中加入恶意代码。风险评估为10%，因为提供的代码片段主要集中在漏洞利用上，但不能完全排除仓库作者在其他地方隐藏恶意代码的可能性。尤其需要关注通过`git clone --recurse-submodules`下载的其他脚本和文件。

**项目地址:** [Featherw1t/CVE-2023-51385_test](https://github.com/Featherw1t/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #3

**来源**: [CVE-2023-51385-Le1a_CVE-2023-51385.md](../2023/CVE-2023-51385-Le1a_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含shell元字符，且在特定情况下被扩展令牌引用。需要配置ProxyCommand。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH中的一个命令注入漏洞，存在于9.6版本之前。漏洞的根本原因是当用户名或主机名包含shell元字符时，如果这些名称在某些情况下被扩展令牌引用，可能导致操作系统命令注入。

**有效性：**

根据漏洞描述和提供的POC代码，该漏洞是有效的。POC代码演示了当ProxyCommand配置为`/usr/bin/nc -X connect -x 127.0.0.1:7890 %h %p`时，通过克隆包含恶意子模块（子模块的用户名或主机名包含shell元字符）的Git仓库，可以触发命令注入。

**投毒风险：**

提供的POC代码非常简洁，主要是通过`git clone`命令触发漏洞。直接在提供的`README.md`和命令中发现明显投毒代码的可能性较低。 但`git clone --recurse-submodules`本身会执行子模块中定义的操作，因此子模块本身的内容可能会包含恶意代码，但这不是漏洞利用代码本身的问题，而是Git子模块机制带来的风险。因此，判定投毒风险为10%，主要考虑子模块可能包含恶意代码的可能性。

**利用方式：**

1.  **配置ProxyCommand：** 首先，用户需要在`~/.ssh/config`文件中配置`ProxyCommand`，例如：

    ```
    Host *.com
      ProxyCommand /usr/bin/nc -X connect -x 127.0.0.1:7890 %h %p
    ```

2.  **克隆恶意Git仓库：** 攻击者创建一个包含恶意子模块的Git仓库。恶意子模块的URL包含shell元字符，例如，用户名或主机名包含反引号、美元符号等。

3.  **触发命令注入：** 当用户使用`git clone --recurse-submodules`克隆该恶意仓库时，Git会自动初始化和更新子模块。在处理恶意子模块的URL时，OpenSSH会对其进行不正确的转义，导致shell元字符被解释执行，从而实现命令注入。

**总结：**

此漏洞的利用依赖于特定的OpenSSH配置（`ProxyCommand`）和恶意的Git仓库。攻击者通过控制Git仓库中的子模块URL，可以注入任意命令。修复此漏洞的方法是升级到OpenSSH 9.6或更高版本，或者避免在用户名或主机名中使用shell元字符。

**项目地址:** [Le1a/CVE-2023-51385](https://github.com/Le1a/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #4

**来源**: [CVE-2023-51385-LtmThink_CVE-2023-51385_test.md](../2023/CVE-2023-51385-LtmThink_CVE-2023-51385_test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6p1

**利用条件:** 需要用户clone包含恶意.gitmodules的git仓库，并配置ssh config中的ProxyCommand。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。该漏洞是由于 OpenSSH 在处理用户名或主机名中包含 Shell 元字符时，没有进行充分的过滤，导致可以通过特定的扩展令牌进行操作系统命令注入。

**利用方式：**
1.  **恶意 Git 仓库：** 攻击者创建一个包含恶意 `.gitmodules` 文件的 Git 仓库。该文件中的 `url` 字段包含恶意命令，例如：
    ```
    url = ssh://`echo helloworld > cve.txt`foo.example.com/bar
    ```
2.  **SSH 配置：** 受害者需要在 `~/.ssh/config` 文件中设置 `ProxyCommand` 指令，并匹配恶意域名，例如：
    ```
    host *.example.com
      ProxyCommand /usr/bin/nc -X connect -x 192.0.2.0:8080 %h %p
    ```
3.  **触发漏洞：** 受害者使用 `git clone --recurse-submodules` 命令克隆恶意 Git 仓库，`--recurse-submodules` 选项会导致 Git 读取 `.gitmodules` 文件，并执行其中 `url` 字段中的恶意命令，从而实现远程代码执行。

**有效性：**
提供的POC代码有效，已经验证可以触发命令执行。

**投毒风险：**
该仓库主要用于漏洞验证，虽然作者在博客中公开了漏洞原理，并且提供了验证代码，但是依然存在一定的投毒风险，例如：

1.  **利用代码本身：**  `ProxyCommand`  配置需要用户手动设置，如果攻击者提供一个包含更复杂、更隐蔽的命令注入payload的 `.gitmodules` 文件，用户在不知情的情况下克隆该仓库，可能会被植入后门或者执行其他恶意操作。
2.  **利用关联仓库：** 攻击者可能在看似无害的其他文件中隐藏恶意代码，例如图片，或者其他git hook脚本。如果用户不仔细检查，可能会忽略这些恶意代码。

考虑到以上因素，初步判断投毒风险为10%。

**项目地址:** [LtmThink/CVE-2023-51385_test](https://github.com/LtmThink/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #5

**来源**: [CVE-2023-51385-MiningBot-eth_CVE-2023-51385-exploit.md](../2023/CVE-2023-51385-MiningBot-eth_CVE-2023-51385-exploit.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要受害者使用受污染的用户名或主机名连接到攻击者控制的服务器，或者受害者访问包含恶意子模块的 Git 仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符时，可能发生操作系统命令注入。例如，如果一个不受信任的 Git 仓库有一个子模块，该子模块的用户名或主机名包含 shell 元字符，则可能触发此漏洞。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意配置的 Git 仓库，其中子模块的用户名或主机名包含 shell 元字符。
2.  或者，攻击者控制一个 SSH 服务器，并设置包含恶意 shell 元字符的用户名或主机名。
3.  受害者克隆恶意 Git 仓库或使用易受攻击的 OpenSSH 客户端连接到攻击者控制的 SSH 服务器。
4.  OpenSSH 在处理用户名或主机名时，由于未正确转义 shell 元字符，导致命令注入，执行攻击者控制的恶意命令。

**有效性：**
根据漏洞描述和搜索结果，此漏洞是有效的。许多安全厂商和组织都发布了关于此漏洞的公告和修复建议。

**投毒风险：**
提供的 POC 代码 `/tmp/d37649a81685a000f41564edc2078d9f/README.md` 仅仅包含了一个 README.md 文件，内容为 `# CVE-2023-51385-exploit`。 虽然这个文件本身不包含任何恶意代码，但不能完全排除整个仓库中存在其他隐藏的投毒代码的可能性。假设仓库中存在其他恶意脚本或配置文件的可能性是 10%。 这个README文件仅仅是声明，没有体现exp代码，无法验证漏洞。


**项目地址:** [MiningBot-eth/CVE-2023-51385-exploit](https://github.com/MiningBot-eth/CVE-2023-51385-exploit)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #6

**来源**: [CVE-2023-51385-WLaoDuo_CVE-2023-51385_poc-test.md](../2023/CVE-2023-51385-WLaoDuo_CVE-2023-51385_poc-test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 目标用户使用了受影响的OpenSSH版本，并且配置了ProxyCommand，clone包含恶意配置的git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。当用户名或主机名包含shell元字符，并且该名称在某些情况下被扩展标记引用时，可能会发生操作系统命令注入。POC利用方式是通过精心构造包含恶意配置的Git仓库，当用户clone该仓库时，其中的子模块配置会触发ProxyCommand中的命令注入，从而执行攻击者预设的恶意命令。用户需要编辑ssh config，添加proxycommand，然后clone指定的git仓库，触发弹窗。投毒风险主要来自于作者可能在仓库中添加额外的恶意代码，例如在README.md中嵌入恶意链接，或者在其他看似无害的文件中隐藏Payload，但是从作者公布的演示视频和简单的代码来看，概率较低。

**项目地址:** [WLaoDuo/CVE-2023-51385_poc-test](https://github.com/WLaoDuo/CVE-2023-51385_poc-test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #7

**来源**: [CVE-2023-51385-WOOOOONG_CVE-2023-51385.md](../2023/CVE-2023-51385-WOOOOONG_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要用户名或主机名包含shell元字符，并且被expansion token引用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中存在的一个命令注入漏洞。当用户名或主机名包含 shell 元字符，并且这个名字在特定情况下被 expansion token 引用时，可能发生操作系统命令注入。例如，一个不受信任的 Git 仓库可能包含一个子模块，其用户名或主机名中包含 shell 元字符。PoC代码只包含README文件，没有实际的验证后门代码，因此判断投毒概率较低。但如果攻击者使用该 PoC 并修改相关代码，则可能存在投毒风险。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞确实存在，并且影响 OpenSSH 9.6 之前的版本。提供的 PoC 代码仅仅是一个 README 文件，只包含漏洞名称，没有实际的漏洞利用代码。因此，提供的PoC代码本身**不具备**直接的漏洞利用有效性，需要进一步开发利用代码。

**投毒风险：**
因为提供的 PoC 只是一个 README 文件，因此**不存在**明显的投毒代码。可以认为投毒的风险很低，接近0%。但也不能完全排除，因为这个仓库可能后续被修改，添加恶意代码。
综合考虑，给出的投毒风险为1%。

**利用方式：**
利用此漏洞的一种方法是，攻击者可以创建一个包含恶意子模块的 Git 仓库。该子模块的用户名或主机名包含 shell 元字符。当用户尝试克隆包含此子模块的仓库时，OpenSSH 可能会执行恶意命令。具体步骤如下：

1.  创建一个包含恶意子模块的 Git 仓库。
2.  确保子模块的用户名或主机名包含 shell 元字符，例如反引号 (`) 或美元符号 ($)。
3.  诱使用户克隆该仓库。
4.  当 OpenSSH 处理子模块信息时，由于存在命令注入漏洞，恶意命令将被执行。

另一种利用方式是通过 `ProxyCommand` 指令。攻击者可以配置 SSH 客户端，使其使用包含恶意 shell 元字符的用户名或主机名连接到目标服务器。当 OpenSSH 执行 `ProxyCommand` 时，恶意命令将被执行。

**优先级排序:**
搜索引擎结果 > 漏洞库信息 > 漏洞利用代码(因为提供的POC没有任何实质性代码)


**项目地址:** [WOOOOONG/CVE-2023-51385](https://github.com/WOOOOONG/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #8

**来源**: [CVE-2023-51385-c0deur_CVE-2023-51385.md](../2023/CVE-2023-51385-c0deur_CVE-2023-51385.md)

# CVE-2023-51385

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-51385-2048JiaLi_CVE-2023-51385.md](../2023/CVE-2023-51385-2048JiaLi_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要存在受影响的OpenSSH版本，并且用户或主机名包含shell元字符，在特定配置下触发ProxyCommand等功能。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-51385是OpenSSH中的一个命令注入漏洞。当用户名或主机名包含shell元字符时，且这些名称被特定情况下的扩展标记引用，就可能发生操作系统命令注入。例如，一个不受信任的Git仓库可能有一个子模块，其用户名或主机名中包含shell元字符。根据提供的POC代码，该代码尝试在`/var/www/html/flag`文件中写入'hello'。如果目标系统配置允许写入该文件，并且利用成功触发了命令注入，则POC有效。但是，这个POC本身并不具有明显的恶意投毒行为。更高级的利用可能涉及更复杂的payload，比如反弹shell。

利用方式：

1.  **恶意Git仓库:** 创建一个包含恶意子模块的Git仓库，该子模块的用户名或主机名包含shell元字符。
2.  **配置ProxyCommand:** 在`~/.ssh/config`文件中配置`ProxyCommand`选项，使其引用包含shell元字符的用户名或主机名。
3.  **触发漏洞:** 当OpenSSH处理这些配置时，由于shell元字符未正确转义，导致命令注入。
4.  **执行任意命令:** 攻击者可以利用命令注入执行任意操作系统命令。

**项目地址:** [2048JiaLi/CVE-2023-51385](https://github.com/2048JiaLi/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #2

**来源**: [CVE-2023-51385-Featherw1t_CVE-2023-51385_test.md](../2023/CVE-2023-51385-Featherw1t_CVE-2023-51385_test.md)

## CVE-2023-51385 OpenSSH 命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标主机使用受影响的OpenSSH版本，且`~/.ssh/config`文件中存在可利用的ProxyCommand配置或使用包含恶意构造的git submodule的git仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 Shell 元字符，并且这些名称在某些情况下被扩展令牌引用时，可能发生操作系统命令注入。漏洞利用方式是：

1.  **配置ProxyCommand：** 在 `~/.ssh/config` 文件中设置 `ProxyCommand`，其中包含恶意构造的命令。POC提供了一个使用`nc`命令的例子。
2.  **Git submodule 注入：**  攻击者可以创建一个包含恶意构造的 `.gitmodules` 文件的 Git 仓库。该文件中的 `url` 字段包含 shell 元字符，当用户尝试克隆该仓库并初始化子模块时，`git clone --recurse-submodules`命令会触发命令注入。

根据提供的POC代码，攻击者可以通过构造恶意的用户名或主机名（例如在 Git 子模块的 URL 中）来执行任意命令。

**有效性：** 提供的POC代码是有效的，因为它展示了如何利用该漏洞通过精心构造的Git仓库来触发命令注入。

**投毒风险：**

此仓库可能存在投毒风险，因为攻击者可能在`git clone`下来的脚本或者git仓库本身中加入恶意代码。风险评估为10%，因为提供的代码片段主要集中在漏洞利用上，但不能完全排除仓库作者在其他地方隐藏恶意代码的可能性。尤其需要关注通过`git clone --recurse-submodules`下载的其他脚本和文件。

**项目地址:** [Featherw1t/CVE-2023-51385_test](https://github.com/Featherw1t/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #3

**来源**: [CVE-2023-51385-Le1a_CVE-2023-51385.md](../2023/CVE-2023-51385-Le1a_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含shell元字符，且在特定情况下被扩展令牌引用。需要配置ProxyCommand。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH中的一个命令注入漏洞，存在于9.6版本之前。漏洞的根本原因是当用户名或主机名包含shell元字符时，如果这些名称在某些情况下被扩展令牌引用，可能导致操作系统命令注入。

**有效性：**

根据漏洞描述和提供的POC代码，该漏洞是有效的。POC代码演示了当ProxyCommand配置为`/usr/bin/nc -X connect -x 127.0.0.1:7890 %h %p`时，通过克隆包含恶意子模块（子模块的用户名或主机名包含shell元字符）的Git仓库，可以触发命令注入。

**投毒风险：**

提供的POC代码非常简洁，主要是通过`git clone`命令触发漏洞。直接在提供的`README.md`和命令中发现明显投毒代码的可能性较低。 但`git clone --recurse-submodules`本身会执行子模块中定义的操作，因此子模块本身的内容可能会包含恶意代码，但这不是漏洞利用代码本身的问题，而是Git子模块机制带来的风险。因此，判定投毒风险为10%，主要考虑子模块可能包含恶意代码的可能性。

**利用方式：**

1.  **配置ProxyCommand：** 首先，用户需要在`~/.ssh/config`文件中配置`ProxyCommand`，例如：

    ```
    Host *.com
      ProxyCommand /usr/bin/nc -X connect -x 127.0.0.1:7890 %h %p
    ```

2.  **克隆恶意Git仓库：** 攻击者创建一个包含恶意子模块的Git仓库。恶意子模块的URL包含shell元字符，例如，用户名或主机名包含反引号、美元符号等。

3.  **触发命令注入：** 当用户使用`git clone --recurse-submodules`克隆该恶意仓库时，Git会自动初始化和更新子模块。在处理恶意子模块的URL时，OpenSSH会对其进行不正确的转义，导致shell元字符被解释执行，从而实现命令注入。

**总结：**

此漏洞的利用依赖于特定的OpenSSH配置（`ProxyCommand`）和恶意的Git仓库。攻击者通过控制Git仓库中的子模块URL，可以注入任意命令。修复此漏洞的方法是升级到OpenSSH 9.6或更高版本，或者避免在用户名或主机名中使用shell元字符。

**项目地址:** [Le1a/CVE-2023-51385](https://github.com/Le1a/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #4

**来源**: [CVE-2023-51385-LtmThink_CVE-2023-51385_test.md](../2023/CVE-2023-51385-LtmThink_CVE-2023-51385_test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6p1

**利用条件:** 需要用户clone包含恶意.gitmodules的git仓库，并配置ssh config中的ProxyCommand。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。该漏洞是由于 OpenSSH 在处理用户名或主机名中包含 Shell 元字符时，没有进行充分的过滤，导致可以通过特定的扩展令牌进行操作系统命令注入。

**利用方式：**
1.  **恶意 Git 仓库：** 攻击者创建一个包含恶意 `.gitmodules` 文件的 Git 仓库。该文件中的 `url` 字段包含恶意命令，例如：
    ```
    url = ssh://`echo helloworld > cve.txt`foo.example.com/bar
    ```
2.  **SSH 配置：** 受害者需要在 `~/.ssh/config` 文件中设置 `ProxyCommand` 指令，并匹配恶意域名，例如：
    ```
    host *.example.com
      ProxyCommand /usr/bin/nc -X connect -x 192.0.2.0:8080 %h %p
    ```
3.  **触发漏洞：** 受害者使用 `git clone --recurse-submodules` 命令克隆恶意 Git 仓库，`--recurse-submodules` 选项会导致 Git 读取 `.gitmodules` 文件，并执行其中 `url` 字段中的恶意命令，从而实现远程代码执行。

**有效性：**
提供的POC代码有效，已经验证可以触发命令执行。

**投毒风险：**
该仓库主要用于漏洞验证，虽然作者在博客中公开了漏洞原理，并且提供了验证代码，但是依然存在一定的投毒风险，例如：

1.  **利用代码本身：**  `ProxyCommand`  配置需要用户手动设置，如果攻击者提供一个包含更复杂、更隐蔽的命令注入payload的 `.gitmodules` 文件，用户在不知情的情况下克隆该仓库，可能会被植入后门或者执行其他恶意操作。
2.  **利用关联仓库：** 攻击者可能在看似无害的其他文件中隐藏恶意代码，例如图片，或者其他git hook脚本。如果用户不仔细检查，可能会忽略这些恶意代码。

考虑到以上因素，初步判断投毒风险为10%。

**项目地址:** [LtmThink/CVE-2023-51385_test](https://github.com/LtmThink/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #5

**来源**: [CVE-2023-51385-MiningBot-eth_CVE-2023-51385-exploit.md](../2023/CVE-2023-51385-MiningBot-eth_CVE-2023-51385-exploit.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要受害者使用受污染的用户名或主机名连接到攻击者控制的服务器，或者受害者访问包含恶意子模块的 Git 仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符时，可能发生操作系统命令注入。例如，如果一个不受信任的 Git 仓库有一个子模块，该子模块的用户名或主机名包含 shell 元字符，则可能触发此漏洞。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意配置的 Git 仓库，其中子模块的用户名或主机名包含 shell 元字符。
2.  或者，攻击者控制一个 SSH 服务器，并设置包含恶意 shell 元字符的用户名或主机名。
3.  受害者克隆恶意 Git 仓库或使用易受攻击的 OpenSSH 客户端连接到攻击者控制的 SSH 服务器。
4.  OpenSSH 在处理用户名或主机名时，由于未正确转义 shell 元字符，导致命令注入，执行攻击者控制的恶意命令。

**有效性：**
根据漏洞描述和搜索结果，此漏洞是有效的。许多安全厂商和组织都发布了关于此漏洞的公告和修复建议。

**投毒风险：**
提供的 POC 代码 `/tmp/d37649a81685a000f41564edc2078d9f/README.md` 仅仅包含了一个 README.md 文件，内容为 `# CVE-2023-51385-exploit`。 虽然这个文件本身不包含任何恶意代码，但不能完全排除整个仓库中存在其他隐藏的投毒代码的可能性。假设仓库中存在其他恶意脚本或配置文件的可能性是 10%。 这个README文件仅仅是声明，没有体现exp代码，无法验证漏洞。


**项目地址:** [MiningBot-eth/CVE-2023-51385-exploit](https://github.com/MiningBot-eth/CVE-2023-51385-exploit)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #6

**来源**: [CVE-2023-51385-WLaoDuo_CVE-2023-51385_poc-test.md](../2023/CVE-2023-51385-WLaoDuo_CVE-2023-51385_poc-test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 目标用户使用了受影响的OpenSSH版本，并且配置了ProxyCommand，clone包含恶意配置的git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。当用户名或主机名包含shell元字符，并且该名称在某些情况下被扩展标记引用时，可能会发生操作系统命令注入。POC利用方式是通过精心构造包含恶意配置的Git仓库，当用户clone该仓库时，其中的子模块配置会触发ProxyCommand中的命令注入，从而执行攻击者预设的恶意命令。用户需要编辑ssh config，添加proxycommand，然后clone指定的git仓库，触发弹窗。投毒风险主要来自于作者可能在仓库中添加额外的恶意代码，例如在README.md中嵌入恶意链接，或者在其他看似无害的文件中隐藏Payload，但是从作者公布的演示视频和简单的代码来看，概率较低。

**项目地址:** [WLaoDuo/CVE-2023-51385_poc-test](https://github.com/WLaoDuo/CVE-2023-51385_poc-test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #7

**来源**: [CVE-2023-51385-WOOOOONG_CVE-2023-51385.md](../2023/CVE-2023-51385-WOOOOONG_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要用户名或主机名包含shell元字符，并且被expansion token引用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中存在的一个命令注入漏洞。当用户名或主机名包含 shell 元字符，并且这个名字在特定情况下被 expansion token 引用时，可能发生操作系统命令注入。例如，一个不受信任的 Git 仓库可能包含一个子模块，其用户名或主机名中包含 shell 元字符。PoC代码只包含README文件，没有实际的验证后门代码，因此判断投毒概率较低。但如果攻击者使用该 PoC 并修改相关代码，则可能存在投毒风险。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞确实存在，并且影响 OpenSSH 9.6 之前的版本。提供的 PoC 代码仅仅是一个 README 文件，只包含漏洞名称，没有实际的漏洞利用代码。因此，提供的PoC代码本身**不具备**直接的漏洞利用有效性，需要进一步开发利用代码。

**投毒风险：**
因为提供的 PoC 只是一个 README 文件，因此**不存在**明显的投毒代码。可以认为投毒的风险很低，接近0%。但也不能完全排除，因为这个仓库可能后续被修改，添加恶意代码。
综合考虑，给出的投毒风险为1%。

**利用方式：**
利用此漏洞的一种方法是，攻击者可以创建一个包含恶意子模块的 Git 仓库。该子模块的用户名或主机名包含 shell 元字符。当用户尝试克隆包含此子模块的仓库时，OpenSSH 可能会执行恶意命令。具体步骤如下：

1.  创建一个包含恶意子模块的 Git 仓库。
2.  确保子模块的用户名或主机名包含 shell 元字符，例如反引号 (`) 或美元符号 ($)。
3.  诱使用户克隆该仓库。
4.  当 OpenSSH 处理子模块信息时，由于存在命令注入漏洞，恶意命令将被执行。

另一种利用方式是通过 `ProxyCommand` 指令。攻击者可以配置 SSH 客户端，使其使用包含恶意 shell 元字符的用户名或主机名连接到目标服务器。当 OpenSSH 执行 `ProxyCommand` 时，恶意命令将被执行。

**优先级排序:**
搜索引擎结果 > 漏洞库信息 > 漏洞利用代码(因为提供的POC没有任何实质性代码)


**项目地址:** [WOOOOONG/CVE-2023-51385](https://github.com/WOOOOONG/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #8

**来源**: [CVE-2023-51385-c0deur_CVE-2023-51385.md](../2023/CVE-2023-51385-c0deur_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要存在可利用的OpenSSH配置，如ProxyCommand，并允许受控用户名或主机名传递到该配置中。Git submodule的利用提到需要攻击者能够控制git仓库。

**POC 可用性:** 部分有效

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中存在的一个命令注入漏洞。当用户名或主机名包含shell元字符，并且这些名称在特定情况下被扩展令牌引用时，可能发生操作系统命令注入。

**有效性：**

根据提供的漏洞库信息、搜索结果和漏洞利用代码，该漏洞是真实存在的，并且已经被广泛报道。搜索结果中多个链接指向了关于此漏洞的描述、修复方案以及受影响的系统。

然而，提供的PoC代码 `README.md` 文件内容过于简单，仅包含漏洞ID，**并不能直接利用漏洞**。该文件本身不具备漏洞利用的能力，只是一个漏洞信息的标记。实际的PoC需要根据`ProxyCommand`的配置构造包含恶意shell元字符的用户名或主机名，才能触发命令注入。

**投毒风险：**

提供的 `README.md` 文件极其简单，几乎没有包含任何实际代码。因此，隐藏恶意代码的可能性极低，投毒风险较低，估计在10%左右。

**利用方式：**

1.  **漏洞原理：** OpenSSH在处理包含shell元字符的用户名或主机名时，如果这些名称被用于`ProxyCommand`等配置的扩展令牌，可能会执行未经转义的命令。
2.  **利用场景：** 攻击者可以控制的用户名或主机名，例如通过恶意Git仓库中的submodule，其中submodule的URL包含恶意的shell元字符。
3.  **攻击步骤：**
    *   攻击者创建一个恶意Git仓库，包含一个submodule。
    *   Submodule的URL中包含恶意的用户名或主机名，例如 `user="; touch /tmp/pwned;"@example.com`。
    *   当受害者克隆包含恶意submodule的仓库时，OpenSSH会尝试解析submodule的URL。
    *   如果OpenSSH配置了`ProxyCommand`，并且submodule的URL中的用户名或主机名被用于`ProxyCommand`的扩展令牌，那么恶意的shell命令将被执行。
4.  **修复方案：** 升级到OpenSSH 9.6或更高版本。对用户名和主机名进行适当的转义，避免shell元字符的注入。

**项目地址:** [c0deur/CVE-2023-51385](https://github.com/c0deur/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #9

**来源**: [CVE-2023-51385-endasugrue_CVE-2023-51385_poc.md](../2023/CVE-2023-51385-endasugrue_CVE-2023-51385_poc.md)

## CVE-2023-51385 OpenSSH 命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含shell元字符，且在特定情况下被扩展令牌引用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中存在的一个命令注入漏洞。当用户名或主机名包含 shell 元字符，并且该名称在某些情况下被扩展令牌引用时，可能发生操作系统命令注入。例如，不受信任的 Git 仓库可能具有子模块，其用户名或主机名中包含 shell 元字符。 

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的利用涉及到shell元字符的注入。提供的 POC 代码非常简短，仅包含一个 README.md 文件，指示该项目旨在提供漏洞的概念验证。因此，该POC本身并不能直接验证漏洞，需要结合其他方式例如vin01.github.io/piptagole/ssh/security/openssh/libssh/remote-code-execution/2023/12/20/openssh-proxycommand-libssh-rce.html 中的信息来构造完整的利用链.可以确认漏洞可以利用。

**投毒风险：**

当前提供的 POC 代码（README.md）不包含任何可执行代码，因此直接的投毒风险很低。但是，如果攻击者修改或替换了该 POC，添加了恶意代码，则存在投毒风险。因为该漏洞涉及到命令执行，后门代码可能隐藏在被注入的命令中，实现持久化控制。

**利用方式：**

1.  **构造恶意用户名或主机名：** 攻击者需要创建一个包含 shell 元字符的用户名或主机名。
2.  **触发扩展令牌引用：** 在某些 OpenSSH 配置中，例如使用 `ProxyCommand` 指令，会扩展用户名或主机名。如果扩展过程中没有正确转义 shell 元字符，就会导致命令注入。
3.  **执行任意命令：** 攻击者可以通过注入恶意的 shell 命令来执行任意操作系统命令。

例如，攻击者可以在 Git 子模块的 URL 中嵌入恶意代码，当 OpenSSH 克隆该子模块时，会执行该恶意代码。

从搜索引擎的结果来看，该漏洞影响广泛，多个厂商都发布了安全公告，确认了漏洞的存在和危害。

**项目地址:** [endasugrue/CVE-2023-51385_poc](https://github.com/endasugrue/CVE-2023-51385_poc)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #10

**来源**: [CVE-2023-51385-julienbrs_exploit-CVE-2023-51385.md](../2023/CVE-2023-51385-julienbrs_exploit-CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名称或主机名称包含shell元字符，并且该名称在某些情况下被扩展令牌引用。需要能够触发使用了这些名称的SSH操作。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中的一个命令注入漏洞。当用户名或主机名包含shell元字符时，如果这个名字被某些情况下的扩展令牌引用，就可能发生操作系统命令注入。例如，一个不受信任的 Git 仓库可能有一个子模块，其用户名或主机名中包含 shell 元字符。利用方式是构造包含恶意 shell 元字符的用户名或主机名，并触发 OpenSSH 使用该名称的操作，例如通过包含恶意子模块的 Git 仓库。提供的POC代码只是一个README.md文件，不包含任何可执行代码，因此，不存在投毒风险。

**有效性：** 提供的POC代码只是一个README文件，本身不具备漏洞利用能力，因此本身提供的POC无效，需要结合其他方式触发。但是漏洞本身是存在的，搜索结果表明该漏洞存在并且可以利用。

**投毒风险：** 提供的 POC 代码仅包含一个 README.md 文件，没有任何可执行代码，因此不存在投毒风险。

**利用方式：** 漏洞的利用方式是构造包含恶意 shell 元字符的用户名或主机名，然后让 OpenSSH 在处理 SSH 连接或相关操作时引用这些名字。例如，可以通过创建一个包含恶意用户名或主机名的 Git 子模块，然后当用户尝试克隆或更新该 Git 仓库时，触发命令注入。ProxyCommand也是一个常见的攻击点，在ssh config中可以使用ProxyCommand执行任意命令。攻击者可以在用户名或主机名中嵌入恶意命令，这些命令会在 ProxyCommand 被调用时执行。

**项目地址:** [julienbrs/exploit-CVE-2023-51385](https://github.com/julienbrs/exploit-CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #11

**来源**: [CVE-2023-51385-julienbrs_malicious-exploit-CVE-2023-51385.md](../2023/CVE-2023-51385-julienbrs_malicious-exploit-CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含Shell元字符，并且在特定情况下被扩展令牌引用

**POC 可用性:** 是，但提供的POC代码不完整

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中，允许在特定情况下进行操作系统命令注入。如果用户名或主机名包含 Shell 元字符，并且该名称被某些扩展令牌引用，则可能发生此漏洞。例如，不受信任的 Git 存储库可能具有一个子模块，其用户名或主机名中包含 shell 元字符。提供的漏洞利用代码只是一个 README 文件，本身不包含任何利用逻辑。因此，实际利用还需要构造恶意用户名/主机名并通过特定的 OpenSSH 功能（如 ProxyCommand）触发命令注入。

**有效性：** 提供的POC代码 (README.md) 本身无效，仅为占位符，不具备漏洞利用能力。需要结合漏洞描述构造特定的利用场景才能触发漏洞。

**投毒风险：** 由于提供的代码仅仅是 README 文件，所以认为存在投毒代码的可能性较低，但是不排除作者在其他未提供的代码中隐藏恶意Payload，因此投毒风险评估为 10%。

**利用方式：** 漏洞利用方式如下：
1.  攻击者需要控制包含恶意 Shell 元字符的用户名或主机名。
2.  攻击者诱使用户使用受影响的 OpenSSH 版本连接到恶意服务器或克隆包含恶意配置的Git仓库，触发包含shell元字符的用户名或主机名被引用。
3.  OpenSSH 在处理这些包含 Shell 元字符的名称时，由于不正确的转义或过滤，导致命令注入。
4.  攻击者可以在目标系统上执行任意命令。

**项目地址:** [julienbrs/malicious-exploit-CVE-2023-51385](https://github.com/julienbrs/malicious-exploit-CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #12

**来源**: [CVE-2023-51385-power1314520_CVE-2023-51385_test.md](../2023/CVE-2023-51385-power1314520_CVE-2023-51385_test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要受害者克隆包含恶意.gitmodules文件的Git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。漏洞的根本原因是OpenSSH在处理用户名或主机名中的shell元字符时存在缺陷，当这些名称被扩展令牌引用时，可能导致命令注入。

**漏洞利用方式：**
1.  **利用场景:** 攻击者可以通过创建一个包含恶意`.gitmodules`文件的Git仓库来利用此漏洞。`.gitmodules` 文件用于定义Git子模块的配置信息。
2.  **攻击步骤:**
    *   攻击者创建一个恶意Git仓库，其中包含一个`.gitmodules`文件，该文件在`url`字段中嵌入恶意命令，例如：
        ```
        url = ssh://`echo helloworld > cve.txt`foo.example.com/bar
        ```
    *   攻击者诱使受害者克隆该恶意Git仓库，并且使用`--recurse-submodules`参数。该参数指示Git同时克隆仓库及其子模块。
    *   当Git处理`.gitmodules`文件时，会执行`url`字段中的命令，导致命令注入。
3.  **利用前提条件:**
    *   受害者使用OpenSSH 9.6之前的版本。
    *   受害者的SSH客户端配置了`ProxyCommand`，并且存在可利用的扩展令牌。
    *   受害者克隆了包含恶意`.gitmodules`文件的Git仓库，并且使用了`--recurse-submodules`参数。

**有效性评估：**
根据提供的漏洞信息和POC代码，此漏洞的利用是有效的。POC代码演示了如何通过在`.gitmodules`文件的`url`字段中嵌入恶意命令来实现命令注入。当受害者克隆包含此文件的Git仓库时，恶意命令会被执行。

**投毒风险评估：**
虽然提供的POC代码本身是为了验证漏洞而编写的，但仍存在一定投毒风险。攻击者可能在POC代码中添加额外的恶意代码，例如：

*   **收集用户信息：** 在命令注入的payload中添加收集受害者系统信息的代码，例如用户名、操作系统版本等，并将这些信息发送到攻击者的服务器。
*   **安装后门：** 在受害者系统中安装后门程序，以便攻击者可以长期控制受害者系统。
*   **传播恶意软件：** 利用受害者系统作为跳板，进一步传播恶意软件。

然而，根据提供的POC代码来看，并没有发现明显的恶意行为，只是验证了命令注入。但是，如果攻击者公开分享了修改后的POC，投毒风险就会增大。因此，综合考虑，投毒风险评估为10%。原因是poc本身功能较为简单，且开源，容易被审核。

**项目地址:** [power1314520/CVE-2023-51385_test](https://github.com/power1314520/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #13

**来源**: [CVE-2023-51385-runooovb_CVE-2023-51385test.md](../2023/CVE-2023-51385-runooovb_CVE-2023-51385test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统存在受影响版本的OpenSSH，且攻击者能够控制用户名或主机名中使用的某些字符（通常通过Git子模块等方式）。

**POC 可用性:** 部分。提供的README.md只是描述，需要构造特定的用户名/主机名利用。

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。如果用户名或主机名包含shell元字符，并且该名称在某些情况下被扩展令牌引用，则可能发生操作系统命令注入。例如，不受信任的Git存储库可能包含一个子模块，该子模块在用户名或主机名中具有shell元字符。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**
提供的POC代码（README.md文件）本身不构成一个完整的PoC。它只是对漏洞的描述。完整的利用需要攻击者能够控制用户名或主机名，并在其中插入恶意的shell元字符。

**投毒风险：**
提供的代码仓库（只有README.md）投毒的可能性较低，但是不排除作者在其他相关代码中包含恶意payload的可能。考虑到只有README.md,所以投毒风险较低,评估为10%。

**利用方式：**
1.  **控制用户名/主机名：** 攻击者需要找到一种方法来控制OpenSSH客户端使用的用户名或主机名。这可能通过以下方式实现：
    *   **恶意的Git子模块：**  创建一个包含恶意子模块的Git仓库。该子模块的URL可能包含带有shell元字符的用户名或主机名。
    *   **其他配置：**  在其他OpenSSH配置文件（例如`~/.ssh/config`）中，如果可以控制Host字段,也可以插入恶意字符
2.  **触发漏洞：** 当OpenSSH客户端尝试连接到恶意主机或处理包含恶意子模块的仓库时，它会展开用户名/主机名中的shell元字符，从而导致命令注入。
3.  **执行任意命令：** 攻击者可以通过注入的命令在目标系统上执行任意代码。

综上所述，该漏洞利用需要一定的条件，但如果成功利用，则风险极高。

**项目地址:** [runooovb/CVE-2023-51385test](https://github.com/runooovb/CVE-2023-51385test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #14

**来源**: [CVE-2023-51385-selecthch_CVE-2023-51385.md](../2023/CVE-2023-51385-selecthch_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用受影响的OpenSSH版本，并且攻击者可以控制用户名或主机名中的shell元字符。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符并且这些名称在某些情况下被扩展标记引用时，可能会发生操作系统命令注入。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞是有效的，允许远程攻击者执行任意操作系统命令。

**投毒风险：**

提供的 POC 代码包含一个 `.gitmodules` 格式的文件，该文件定义了一个名为 "cves" 的子模块，该子模块的 URL 包含命令 `gnome-calculator`。当 `git submodule update --init --recursive` 被执行时，`gnome-calculator`命令就会被执行。这可能存在投毒风险。如果攻击者将恶意命令嵌入到子模块 URL 中，当用户克隆包含此子模块的恶意仓库并尝试初始化和更新子模块时，就会执行这些命令。风险评估为10%，主要是因为这个POC比较明显，容易被发现，且`gnome-calculator`本身无恶意，如果替换成更隐蔽的恶意命令，投毒性会更高。

**利用方式：**

1.  攻击者创建一个恶意的 Git 仓库，并在 `.gitmodules` 文件中，将子模块的 URL 设置为包含 shell 元字符和恶意命令的字符串。
2.  受害者克隆该恶意 Git 仓库。
3.  受害者执行 `git submodule update --init --recursive` 命令以初始化和更新子模块。
4.  由于 URL 中的 shell 元字符未被正确转义，OpenSSH 将执行 URL 中的恶意命令，导致远程代码执行。

**项目地址:** [selecthch/CVE-2023-51385](https://github.com/selecthch/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #15

**来源**: [CVE-2023-51385-thinkliving2020_CVE-2023-51385-.md](../2023/CVE-2023-51385-thinkliving2020_CVE-2023-51385-.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 受害者需要使用存在漏洞的OpenSSH版本，并连接到包含恶意配置的Git仓库子模块或者其他存在恶意用户名/主机名的配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 漏洞存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符时，如果这些名称被特定的扩展令牌引用，可能导致操作系统命令注入。例如，一个不受信任的 Git 仓库的子模块可能在用户名或主机名中包含 shell 元字符。 

**有效性:** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在并且影响 OpenSSH 9.6 之前的版本。提供的 POC 代码利用了 `~/.ssh/config` 文件中的 `ProxyCommand` 指令，通过在主机名中使用 shell 元字符来执行任意命令。通过`git clone --recurse-submodules`下载包含恶意配置的子模块，即可触发漏洞。 

**投毒风险:** 该POC提供了一个通过恶意配置子模块触发计算器弹出的例子，帮助用户验证该漏洞，提高安全意识。但是，如果攻击者修改了 `~/.ssh/config` 文件或通过其他方式将恶意的用户名/主机名注入到配置中，就有可能执行任意命令，造成安全风险。因此，虽然POC本身是为了演示漏洞，但也存在被滥用的可能。 投毒风险评估为10%，主要考虑攻击者可能在公开的漏洞利用代码中添加恶意代码，诱导用户执行，但是该POC主要依赖配置文件的恶意构造，直接添加恶意代码到POC文件中的可能性较低。

**利用方式:**  利用方式主要通过以下步骤：
1.  攻击者创建一个包含恶意子模块的Git仓库，该子模块的用户名或主机名包含shell元字符。
2.  受害者克隆该仓库，并使用 `--recurse-submodules` 参数初始化子模块。
3.  当 OpenSSH 使用 `ProxyCommand` 指令处理包含恶意元字符的用户名或主机名时，会执行攻击者构造的恶意命令。

另一种利用方式是攻击者诱导受害者在`~/.ssh/config`中添加包含恶意shell元字符的配置信息，当ssh连接目标主机时触发该配置，执行恶意命令。


**项目地址:** [thinkliving2020/CVE-2023-51385-](https://github.com/thinkliving2020/CVE-2023-51385-)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #16

**来源**: [CVE-2023-51385-vin01_poc-proxycommand-vulnerable.md](../2023/CVE-2023-51385-vin01_poc-proxycommand-vulnerable.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用OpenSSH，且受害者需要clone包含恶意submodule的Git仓库或连接到包含恶意用户名/主机名的SSH服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于OpenSSH 9.6之前的版本中。该漏洞允许攻击者通过在用户名或主机名中注入shell元字符来执行任意操作系统命令。当 OpenSSH 在某些情况下扩展令牌时，如果用户名或主机名包含shell元字符，则可能发生OS命令注入。

**有效性：** 提供的POC代码显示了一种利用`ProxyCommand`配置项中`%h`和`%p`等令牌的方式，当这些令牌引用的主机名或用户名包含shell元字符时，可能导致命令注入。POC通过一个包含恶意子模块的Git仓库进行演示，攻击者可以诱使用户clone该仓库，从而触发漏洞。

**投毒风险：**  POC仓库本身的主要目的是演示漏洞，但存在一定投毒风险。  风险点在于Submodule的地址可被篡改，从而指向包含更恶意代码的仓库。Readme中包含执行`git clone`的命令，引导用户执行恶意操作。虽然当前POC只是弹出一个计算器，但攻击者可以替换Submodule指向的仓库，加入其他恶意代码，例如植入后门、窃取信息等。风险评估为10%，主要考虑因素是POC的主要目的是演示漏洞，并非大规模恶意攻击，但存在被二次利用的风险。  

**利用方式：**

1.  **恶意Git仓库：** 攻击者创建一个包含恶意子模块的Git仓库。子模块的URL包含带有shell元字符的用户名或主机名。
2.  **诱导受害者：** 攻击者诱导受害者克隆该Git仓库，可以使用`git clone --recurse-submodules`命令。
3.  **触发漏洞：** 当git clone子模块时，OpenSSH会解析`.ssh/config` 文件，如果文件中存在`ProxyCommand`等配置项，并且使用了受影响的令牌（如 `%h`、`%p`），则会导致命令注入。
4.  **命令执行：** 注入的shell元字符会被执行，从而允许攻击者在受害者系统上执行任意命令。 

**缓解措施：**
*   升级到OpenSSH 9.6或更高版本。
*   避免在用户名或主机名中使用shell元字符。
*   仔细审查`.ssh/config`文件，特别是 `ProxyCommand` 配置项。
*   谨慎克隆来自不可信来源的Git仓库。

**项目地址:** [vin01/poc-proxycommand-vulnerable](https://github.com/vin01/poc-proxycommand-vulnerable)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #17

**来源**: [CVE-2023-51385-watarium_poc-cve-2023-51385.md](../2023/CVE-2023-51385-watarium_poc-cve-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用OpenSSH，且用户名或主机名包含shell元字符并被某些扩展令牌引用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 漏洞存在于OpenSSH 9.6版本之前，允许攻击者通过在用户名或主机名中注入shell元字符，并在特定情况下被扩展令牌引用时，执行任意操作系统命令。例如，恶意Git仓库的子模块可以在用户名或主机名中包含shell元字符。提供的POC代码 `poc-cve-2023-51385`  仅包含一个 `README.md` 文件，内容简单，仅为标题，说明poc是存在的，但是这个简单的poc没有展示任何攻击代码，这意味着需要其他方式来利用此漏洞。该漏洞的利用方式主要通过以下步骤：1.  攻击者构造包含恶意shell元字符的用户名或主机名。2.  攻击者诱使用户连接到包含恶意用户名或主机名的系统。3.  OpenSSH处理连接时，如果相关配置（例如 `ProxyCommand`）使用了扩展令牌引用该用户名或主机名，则会执行注入的shell命令。根据搜索结果，此漏洞已经公开，并且多个厂商发布了安全公告。虽然提供的POC很简单，但该漏洞的严重性不容忽视。投毒风险评估：由于 POC 代码非常简单，只包含一个 README 文件，因此直接投毒的可能性较低。但是，后续利用该漏洞的Payload可能存在投毒风险，例如，利用该漏洞在目标机器上安装恶意软件或后门。考虑到POC代码的简洁性，以及漏洞本身的性质，估计该仓库存在作者隐藏的投毒代码的可能性较低，约为10%。

**项目地址:** [watarium/poc-cve-2023-51385](https://github.com/watarium/poc-cve-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---



---

## POC #9

**来源**: [CVE-2023-51385-endasugrue_CVE-2023-51385_poc.md](../2023/CVE-2023-51385-endasugrue_CVE-2023-51385_poc.md)

## CVE-2023-51385 OpenSSH 命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含shell元字符，且在特定情况下被扩展令牌引用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中存在的一个命令注入漏洞。当用户名或主机名包含 shell 元字符，并且该名称在某些情况下被扩展令牌引用时，可能发生操作系统命令注入。例如，不受信任的 Git 仓库可能具有子模块，其用户名或主机名中包含 shell 元字符。 

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的利用涉及到shell元字符的注入。提供的 POC 代码非常简短，仅包含一个 README.md 文件，指示该项目旨在提供漏洞的概念验证。因此，该POC本身并不能直接验证漏洞，需要结合其他方式例如vin01.github.io/piptagole/ssh/security/openssh/libssh/remote-code-execution/2023/12/20/openssh-proxycommand-libssh-rce.html 中的信息来构造完整的利用链.可以确认漏洞可以利用。

**投毒风险：**

当前提供的 POC 代码（README.md）不包含任何可执行代码，因此直接的投毒风险很低。但是，如果攻击者修改或替换了该 POC，添加了恶意代码，则存在投毒风险。因为该漏洞涉及到命令执行，后门代码可能隐藏在被注入的命令中，实现持久化控制。

**利用方式：**

1.  **构造恶意用户名或主机名：** 攻击者需要创建一个包含 shell 元字符的用户名或主机名。
2.  **触发扩展令牌引用：** 在某些 OpenSSH 配置中，例如使用 `ProxyCommand` 指令，会扩展用户名或主机名。如果扩展过程中没有正确转义 shell 元字符，就会导致命令注入。
3.  **执行任意命令：** 攻击者可以通过注入恶意的 shell 命令来执行任意操作系统命令。

例如，攻击者可以在 Git 子模块的 URL 中嵌入恶意代码，当 OpenSSH 克隆该子模块时，会执行该恶意代码。

从搜索引擎的结果来看，该漏洞影响广泛，多个厂商都发布了安全公告，确认了漏洞的存在和危害。

**项目地址:** [endasugrue/CVE-2023-51385_poc](https://github.com/endasugrue/CVE-2023-51385_poc)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #10

**来源**: [CVE-2023-51385-julienbrs_exploit-CVE-2023-51385.md](../2023/CVE-2023-51385-julienbrs_exploit-CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名称或主机名称包含shell元字符，并且该名称在某些情况下被扩展令牌引用。需要能够触发使用了这些名称的SSH操作。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中的一个命令注入漏洞。当用户名或主机名包含shell元字符时，如果这个名字被某些情况下的扩展令牌引用，就可能发生操作系统命令注入。例如，一个不受信任的 Git 仓库可能有一个子模块，其用户名或主机名中包含 shell 元字符。利用方式是构造包含恶意 shell 元字符的用户名或主机名，并触发 OpenSSH 使用该名称的操作，例如通过包含恶意子模块的 Git 仓库。提供的POC代码只是一个README.md文件，不包含任何可执行代码，因此，不存在投毒风险。

**有效性：** 提供的POC代码只是一个README文件，本身不具备漏洞利用能力，因此本身提供的POC无效，需要结合其他方式触发。但是漏洞本身是存在的，搜索结果表明该漏洞存在并且可以利用。

**投毒风险：** 提供的 POC 代码仅包含一个 README.md 文件，没有任何可执行代码，因此不存在投毒风险。

**利用方式：** 漏洞的利用方式是构造包含恶意 shell 元字符的用户名或主机名，然后让 OpenSSH 在处理 SSH 连接或相关操作时引用这些名字。例如，可以通过创建一个包含恶意用户名或主机名的 Git 子模块，然后当用户尝试克隆或更新该 Git 仓库时，触发命令注入。ProxyCommand也是一个常见的攻击点，在ssh config中可以使用ProxyCommand执行任意命令。攻击者可以在用户名或主机名中嵌入恶意命令，这些命令会在 ProxyCommand 被调用时执行。

**项目地址:** [julienbrs/exploit-CVE-2023-51385](https://github.com/julienbrs/exploit-CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #11

**来源**: [CVE-2023-51385-julienbrs_malicious-exploit-CVE-2023-51385.md](../2023/CVE-2023-51385-julienbrs_malicious-exploit-CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含Shell元字符，并且在特定情况下被扩展令牌引用

**POC 可用性:** 是，但提供的POC代码不完整

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中，允许在特定情况下进行操作系统命令注入。如果用户名或主机名包含 Shell 元字符，并且该名称被某些扩展令牌引用，则可能发生此漏洞。例如，不受信任的 Git 存储库可能具有一个子模块，其用户名或主机名中包含 shell 元字符。提供的漏洞利用代码只是一个 README 文件，本身不包含任何利用逻辑。因此，实际利用还需要构造恶意用户名/主机名并通过特定的 OpenSSH 功能（如 ProxyCommand）触发命令注入。

**有效性：** 提供的POC代码 (README.md) 本身无效，仅为占位符，不具备漏洞利用能力。需要结合漏洞描述构造特定的利用场景才能触发漏洞。

**投毒风险：** 由于提供的代码仅仅是 README 文件，所以认为存在投毒代码的可能性较低，但是不排除作者在其他未提供的代码中隐藏恶意Payload，因此投毒风险评估为 10%。

**利用方式：** 漏洞利用方式如下：
1.  攻击者需要控制包含恶意 Shell 元字符的用户名或主机名。
2.  攻击者诱使用户使用受影响的 OpenSSH 版本连接到恶意服务器或克隆包含恶意配置的Git仓库，触发包含shell元字符的用户名或主机名被引用。
3.  OpenSSH 在处理这些包含 Shell 元字符的名称时，由于不正确的转义或过滤，导致命令注入。
4.  攻击者可以在目标系统上执行任意命令。

**项目地址:** [julienbrs/malicious-exploit-CVE-2023-51385](https://github.com/julienbrs/malicious-exploit-CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #12

**来源**: [CVE-2023-51385-power1314520_CVE-2023-51385_test.md](../2023/CVE-2023-51385-power1314520_CVE-2023-51385_test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要受害者克隆包含恶意.gitmodules文件的Git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。漏洞的根本原因是OpenSSH在处理用户名或主机名中的shell元字符时存在缺陷，当这些名称被扩展令牌引用时，可能导致命令注入。

**漏洞利用方式：**
1.  **利用场景:** 攻击者可以通过创建一个包含恶意`.gitmodules`文件的Git仓库来利用此漏洞。`.gitmodules` 文件用于定义Git子模块的配置信息。
2.  **攻击步骤:**
    *   攻击者创建一个恶意Git仓库，其中包含一个`.gitmodules`文件，该文件在`url`字段中嵌入恶意命令，例如：
        ```
        url = ssh://`echo helloworld > cve.txt`foo.example.com/bar
        ```
    *   攻击者诱使受害者克隆该恶意Git仓库，并且使用`--recurse-submodules`参数。该参数指示Git同时克隆仓库及其子模块。
    *   当Git处理`.gitmodules`文件时，会执行`url`字段中的命令，导致命令注入。
3.  **利用前提条件:**
    *   受害者使用OpenSSH 9.6之前的版本。
    *   受害者的SSH客户端配置了`ProxyCommand`，并且存在可利用的扩展令牌。
    *   受害者克隆了包含恶意`.gitmodules`文件的Git仓库，并且使用了`--recurse-submodules`参数。

**有效性评估：**
根据提供的漏洞信息和POC代码，此漏洞的利用是有效的。POC代码演示了如何通过在`.gitmodules`文件的`url`字段中嵌入恶意命令来实现命令注入。当受害者克隆包含此文件的Git仓库时，恶意命令会被执行。

**投毒风险评估：**
虽然提供的POC代码本身是为了验证漏洞而编写的，但仍存在一定投毒风险。攻击者可能在POC代码中添加额外的恶意代码，例如：

*   **收集用户信息：** 在命令注入的payload中添加收集受害者系统信息的代码，例如用户名、操作系统版本等，并将这些信息发送到攻击者的服务器。
*   **安装后门：** 在受害者系统中安装后门程序，以便攻击者可以长期控制受害者系统。
*   **传播恶意软件：** 利用受害者系统作为跳板，进一步传播恶意软件。

然而，根据提供的POC代码来看，并没有发现明显的恶意行为，只是验证了命令注入。但是，如果攻击者公开分享了修改后的POC，投毒风险就会增大。因此，综合考虑，投毒风险评估为10%。原因是poc本身功能较为简单，且开源，容易被审核。

**项目地址:** [power1314520/CVE-2023-51385_test](https://github.com/power1314520/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #13

**来源**: [CVE-2023-51385-runooovb_CVE-2023-51385test.md](../2023/CVE-2023-51385-runooovb_CVE-2023-51385test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统存在受影响版本的OpenSSH，且攻击者能够控制用户名或主机名中使用的某些字符（通常通过Git子模块等方式）。

**POC 可用性:** 部分。提供的README.md只是描述，需要构造特定的用户名/主机名利用。

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。如果用户名或主机名包含shell元字符，并且该名称在某些情况下被扩展令牌引用，则可能发生操作系统命令注入。例如，不受信任的Git存储库可能包含一个子模块，该子模块在用户名或主机名中具有shell元字符。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**
提供的POC代码（README.md文件）本身不构成一个完整的PoC。它只是对漏洞的描述。完整的利用需要攻击者能够控制用户名或主机名，并在其中插入恶意的shell元字符。

**投毒风险：**
提供的代码仓库（只有README.md）投毒的可能性较低，但是不排除作者在其他相关代码中包含恶意payload的可能。考虑到只有README.md,所以投毒风险较低,评估为10%。

**利用方式：**
1.  **控制用户名/主机名：** 攻击者需要找到一种方法来控制OpenSSH客户端使用的用户名或主机名。这可能通过以下方式实现：
    *   **恶意的Git子模块：**  创建一个包含恶意子模块的Git仓库。该子模块的URL可能包含带有shell元字符的用户名或主机名。
    *   **其他配置：**  在其他OpenSSH配置文件（例如`~/.ssh/config`）中，如果可以控制Host字段,也可以插入恶意字符
2.  **触发漏洞：** 当OpenSSH客户端尝试连接到恶意主机或处理包含恶意子模块的仓库时，它会展开用户名/主机名中的shell元字符，从而导致命令注入。
3.  **执行任意命令：** 攻击者可以通过注入的命令在目标系统上执行任意代码。

综上所述，该漏洞利用需要一定的条件，但如果成功利用，则风险极高。

**项目地址:** [runooovb/CVE-2023-51385test](https://github.com/runooovb/CVE-2023-51385test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #14

**来源**: [CVE-2023-51385-selecthch_CVE-2023-51385.md](../2023/CVE-2023-51385-selecthch_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用受影响的OpenSSH版本，并且攻击者可以控制用户名或主机名中的shell元字符。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符并且这些名称在某些情况下被扩展标记引用时，可能会发生操作系统命令注入。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞是有效的，允许远程攻击者执行任意操作系统命令。

**投毒风险：**

提供的 POC 代码包含一个 `.gitmodules` 格式的文件，该文件定义了一个名为 "cves" 的子模块，该子模块的 URL 包含命令 `gnome-calculator`。当 `git submodule update --init --recursive` 被执行时，`gnome-calculator`命令就会被执行。这可能存在投毒风险。如果攻击者将恶意命令嵌入到子模块 URL 中，当用户克隆包含此子模块的恶意仓库并尝试初始化和更新子模块时，就会执行这些命令。风险评估为10%，主要是因为这个POC比较明显，容易被发现，且`gnome-calculator`本身无恶意，如果替换成更隐蔽的恶意命令，投毒性会更高。

**利用方式：**

1.  攻击者创建一个恶意的 Git 仓库，并在 `.gitmodules` 文件中，将子模块的 URL 设置为包含 shell 元字符和恶意命令的字符串。
2.  受害者克隆该恶意 Git 仓库。
3.  受害者执行 `git submodule update --init --recursive` 命令以初始化和更新子模块。
4.  由于 URL 中的 shell 元字符未被正确转义，OpenSSH 将执行 URL 中的恶意命令，导致远程代码执行。

**项目地址:** [selecthch/CVE-2023-51385](https://github.com/selecthch/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #15

**来源**: [CVE-2023-51385-thinkliving2020_CVE-2023-51385-.md](../2023/CVE-2023-51385-thinkliving2020_CVE-2023-51385-.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 受害者需要使用存在漏洞的OpenSSH版本，并连接到包含恶意配置的Git仓库子模块或者其他存在恶意用户名/主机名的配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 漏洞存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符时，如果这些名称被特定的扩展令牌引用，可能导致操作系统命令注入。例如，一个不受信任的 Git 仓库的子模块可能在用户名或主机名中包含 shell 元字符。 

**有效性:** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在并且影响 OpenSSH 9.6 之前的版本。提供的 POC 代码利用了 `~/.ssh/config` 文件中的 `ProxyCommand` 指令，通过在主机名中使用 shell 元字符来执行任意命令。通过`git clone --recurse-submodules`下载包含恶意配置的子模块，即可触发漏洞。 

**投毒风险:** 该POC提供了一个通过恶意配置子模块触发计算器弹出的例子，帮助用户验证该漏洞，提高安全意识。但是，如果攻击者修改了 `~/.ssh/config` 文件或通过其他方式将恶意的用户名/主机名注入到配置中，就有可能执行任意命令，造成安全风险。因此，虽然POC本身是为了演示漏洞，但也存在被滥用的可能。 投毒风险评估为10%，主要考虑攻击者可能在公开的漏洞利用代码中添加恶意代码，诱导用户执行，但是该POC主要依赖配置文件的恶意构造，直接添加恶意代码到POC文件中的可能性较低。

**利用方式:**  利用方式主要通过以下步骤：
1.  攻击者创建一个包含恶意子模块的Git仓库，该子模块的用户名或主机名包含shell元字符。
2.  受害者克隆该仓库，并使用 `--recurse-submodules` 参数初始化子模块。
3.  当 OpenSSH 使用 `ProxyCommand` 指令处理包含恶意元字符的用户名或主机名时，会执行攻击者构造的恶意命令。

另一种利用方式是攻击者诱导受害者在`~/.ssh/config`中添加包含恶意shell元字符的配置信息，当ssh连接目标主机时触发该配置，执行恶意命令。


**项目地址:** [thinkliving2020/CVE-2023-51385-](https://github.com/thinkliving2020/CVE-2023-51385-)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #16

**来源**: [CVE-2023-51385-vin01_poc-proxycommand-vulnerable.md](../2023/CVE-2023-51385-vin01_poc-proxycommand-vulnerable.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用OpenSSH，且受害者需要clone包含恶意submodule的Git仓库或连接到包含恶意用户名/主机名的SSH服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于OpenSSH 9.6之前的版本中。该漏洞允许攻击者通过在用户名或主机名中注入shell元字符来执行任意操作系统命令。当 OpenSSH 在某些情况下扩展令牌时，如果用户名或主机名包含shell元字符，则可能发生OS命令注入。

**有效性：** 提供的POC代码显示了一种利用`ProxyCommand`配置项中`%h`和`%p`等令牌的方式，当这些令牌引用的主机名或用户名包含shell元字符时，可能导致命令注入。POC通过一个包含恶意子模块的Git仓库进行演示，攻击者可以诱使用户clone该仓库，从而触发漏洞。

**投毒风险：**  POC仓库本身的主要目的是演示漏洞，但存在一定投毒风险。  风险点在于Submodule的地址可被篡改，从而指向包含更恶意代码的仓库。Readme中包含执行`git clone`的命令，引导用户执行恶意操作。虽然当前POC只是弹出一个计算器，但攻击者可以替换Submodule指向的仓库，加入其他恶意代码，例如植入后门、窃取信息等。风险评估为10%，主要考虑因素是POC的主要目的是演示漏洞，并非大规模恶意攻击，但存在被二次利用的风险。  

**利用方式：**

1.  **恶意Git仓库：** 攻击者创建一个包含恶意子模块的Git仓库。子模块的URL包含带有shell元字符的用户名或主机名。
2.  **诱导受害者：** 攻击者诱导受害者克隆该Git仓库，可以使用`git clone --recurse-submodules`命令。
3.  **触发漏洞：** 当git clone子模块时，OpenSSH会解析`.ssh/config` 文件，如果文件中存在`ProxyCommand`等配置项，并且使用了受影响的令牌（如 `%h`、`%p`），则会导致命令注入。
4.  **命令执行：** 注入的shell元字符会被执行，从而允许攻击者在受害者系统上执行任意命令。 

**缓解措施：**
*   升级到OpenSSH 9.6或更高版本。
*   避免在用户名或主机名中使用shell元字符。
*   仔细审查`.ssh/config`文件，特别是 `ProxyCommand` 配置项。
*   谨慎克隆来自不可信来源的Git仓库。

**项目地址:** [vin01/poc-proxycommand-vulnerable](https://github.com/vin01/poc-proxycommand-vulnerable)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #17

**来源**: [CVE-2023-51385-watarium_poc-cve-2023-51385.md](../2023/CVE-2023-51385-watarium_poc-cve-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用OpenSSH，且用户名或主机名包含shell元字符并被某些扩展令牌引用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 漏洞存在于OpenSSH 9.6版本之前，允许攻击者通过在用户名或主机名中注入shell元字符，并在特定情况下被扩展令牌引用时，执行任意操作系统命令。例如，恶意Git仓库的子模块可以在用户名或主机名中包含shell元字符。提供的POC代码 `poc-cve-2023-51385`  仅包含一个 `README.md` 文件，内容简单，仅为标题，说明poc是存在的，但是这个简单的poc没有展示任何攻击代码，这意味着需要其他方式来利用此漏洞。该漏洞的利用方式主要通过以下步骤：1.  攻击者构造包含恶意shell元字符的用户名或主机名。2.  攻击者诱使用户连接到包含恶意用户名或主机名的系统。3.  OpenSSH处理连接时，如果相关配置（例如 `ProxyCommand`）使用了扩展令牌引用该用户名或主机名，则会执行注入的shell命令。根据搜索结果，此漏洞已经公开，并且多个厂商发布了安全公告。虽然提供的POC很简单，但该漏洞的严重性不容忽视。投毒风险评估：由于 POC 代码非常简单，只包含一个 README 文件，因此直接投毒的可能性较低。但是，后续利用该漏洞的Payload可能存在投毒风险，例如，利用该漏洞在目标机器上安装恶意软件或后门。考虑到POC代码的简洁性，以及漏洞本身的性质，估计该仓库存在作者隐藏的投毒代码的可能性较低，约为10%。

**项目地址:** [watarium/poc-cve-2023-51385](https://github.com/watarium/poc-cve-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---



---

## POC #9

**来源**: [CVE-2023-51385-endasugrue_CVE-2023-51385_poc.md](../2023/CVE-2023-51385-endasugrue_CVE-2023-51385_poc.md)

## CVE-2023-51385 OpenSSH 命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含shell元字符，且在特定情况下被扩展令牌引用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中存在的一个命令注入漏洞。当用户名或主机名包含 shell 元字符，并且该名称在某些情况下被扩展令牌引用时，可能发生操作系统命令注入。例如，不受信任的 Git 仓库可能具有子模块，其用户名或主机名中包含 shell 元字符。 

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的利用涉及到shell元字符的注入。提供的 POC 代码非常简短，仅包含一个 README.md 文件，指示该项目旨在提供漏洞的概念验证。因此，该POC本身并不能直接验证漏洞，需要结合其他方式例如vin01.github.io/piptagole/ssh/security/openssh/libssh/remote-code-execution/2023/12/20/openssh-proxycommand-libssh-rce.html 中的信息来构造完整的利用链.可以确认漏洞可以利用。

**投毒风险：**

当前提供的 POC 代码（README.md）不包含任何可执行代码，因此直接的投毒风险很低。但是，如果攻击者修改或替换了该 POC，添加了恶意代码，则存在投毒风险。因为该漏洞涉及到命令执行，后门代码可能隐藏在被注入的命令中，实现持久化控制。

**利用方式：**

1.  **构造恶意用户名或主机名：** 攻击者需要创建一个包含 shell 元字符的用户名或主机名。
2.  **触发扩展令牌引用：** 在某些 OpenSSH 配置中，例如使用 `ProxyCommand` 指令，会扩展用户名或主机名。如果扩展过程中没有正确转义 shell 元字符，就会导致命令注入。
3.  **执行任意命令：** 攻击者可以通过注入恶意的 shell 命令来执行任意操作系统命令。

例如，攻击者可以在 Git 子模块的 URL 中嵌入恶意代码，当 OpenSSH 克隆该子模块时，会执行该恶意代码。

从搜索引擎的结果来看，该漏洞影响广泛，多个厂商都发布了安全公告，确认了漏洞的存在和危害。

**项目地址:** [endasugrue/CVE-2023-51385_poc](https://github.com/endasugrue/CVE-2023-51385_poc)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #10

**来源**: [CVE-2023-51385-julienbrs_exploit-CVE-2023-51385.md](../2023/CVE-2023-51385-julienbrs_exploit-CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名称或主机名称包含shell元字符，并且该名称在某些情况下被扩展令牌引用。需要能够触发使用了这些名称的SSH操作。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中的一个命令注入漏洞。当用户名或主机名包含shell元字符时，如果这个名字被某些情况下的扩展令牌引用，就可能发生操作系统命令注入。例如，一个不受信任的 Git 仓库可能有一个子模块，其用户名或主机名中包含 shell 元字符。利用方式是构造包含恶意 shell 元字符的用户名或主机名，并触发 OpenSSH 使用该名称的操作，例如通过包含恶意子模块的 Git 仓库。提供的POC代码只是一个README.md文件，不包含任何可执行代码，因此，不存在投毒风险。

**有效性：** 提供的POC代码只是一个README文件，本身不具备漏洞利用能力，因此本身提供的POC无效，需要结合其他方式触发。但是漏洞本身是存在的，搜索结果表明该漏洞存在并且可以利用。

**投毒风险：** 提供的 POC 代码仅包含一个 README.md 文件，没有任何可执行代码，因此不存在投毒风险。

**利用方式：** 漏洞的利用方式是构造包含恶意 shell 元字符的用户名或主机名，然后让 OpenSSH 在处理 SSH 连接或相关操作时引用这些名字。例如，可以通过创建一个包含恶意用户名或主机名的 Git 子模块，然后当用户尝试克隆或更新该 Git 仓库时，触发命令注入。ProxyCommand也是一个常见的攻击点，在ssh config中可以使用ProxyCommand执行任意命令。攻击者可以在用户名或主机名中嵌入恶意命令，这些命令会在 ProxyCommand 被调用时执行。

**项目地址:** [julienbrs/exploit-CVE-2023-51385](https://github.com/julienbrs/exploit-CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #11

**来源**: [CVE-2023-51385-julienbrs_malicious-exploit-CVE-2023-51385.md](../2023/CVE-2023-51385-julienbrs_malicious-exploit-CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含Shell元字符，并且在特定情况下被扩展令牌引用

**POC 可用性:** 是，但提供的POC代码不完整

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中，允许在特定情况下进行操作系统命令注入。如果用户名或主机名包含 Shell 元字符，并且该名称被某些扩展令牌引用，则可能发生此漏洞。例如，不受信任的 Git 存储库可能具有一个子模块，其用户名或主机名中包含 shell 元字符。提供的漏洞利用代码只是一个 README 文件，本身不包含任何利用逻辑。因此，实际利用还需要构造恶意用户名/主机名并通过特定的 OpenSSH 功能（如 ProxyCommand）触发命令注入。

**有效性：** 提供的POC代码 (README.md) 本身无效，仅为占位符，不具备漏洞利用能力。需要结合漏洞描述构造特定的利用场景才能触发漏洞。

**投毒风险：** 由于提供的代码仅仅是 README 文件，所以认为存在投毒代码的可能性较低，但是不排除作者在其他未提供的代码中隐藏恶意Payload，因此投毒风险评估为 10%。

**利用方式：** 漏洞利用方式如下：
1.  攻击者需要控制包含恶意 Shell 元字符的用户名或主机名。
2.  攻击者诱使用户使用受影响的 OpenSSH 版本连接到恶意服务器或克隆包含恶意配置的Git仓库，触发包含shell元字符的用户名或主机名被引用。
3.  OpenSSH 在处理这些包含 Shell 元字符的名称时，由于不正确的转义或过滤，导致命令注入。
4.  攻击者可以在目标系统上执行任意命令。

**项目地址:** [julienbrs/malicious-exploit-CVE-2023-51385](https://github.com/julienbrs/malicious-exploit-CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #12

**来源**: [CVE-2023-51385-power1314520_CVE-2023-51385_test.md](../2023/CVE-2023-51385-power1314520_CVE-2023-51385_test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要受害者克隆包含恶意.gitmodules文件的Git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。漏洞的根本原因是OpenSSH在处理用户名或主机名中的shell元字符时存在缺陷，当这些名称被扩展令牌引用时，可能导致命令注入。

**漏洞利用方式：**
1.  **利用场景:** 攻击者可以通过创建一个包含恶意`.gitmodules`文件的Git仓库来利用此漏洞。`.gitmodules` 文件用于定义Git子模块的配置信息。
2.  **攻击步骤:**
    *   攻击者创建一个恶意Git仓库，其中包含一个`.gitmodules`文件，该文件在`url`字段中嵌入恶意命令，例如：
        ```
        url = ssh://`echo helloworld > cve.txt`foo.example.com/bar
        ```
    *   攻击者诱使受害者克隆该恶意Git仓库，并且使用`--recurse-submodules`参数。该参数指示Git同时克隆仓库及其子模块。
    *   当Git处理`.gitmodules`文件时，会执行`url`字段中的命令，导致命令注入。
3.  **利用前提条件:**
    *   受害者使用OpenSSH 9.6之前的版本。
    *   受害者的SSH客户端配置了`ProxyCommand`，并且存在可利用的扩展令牌。
    *   受害者克隆了包含恶意`.gitmodules`文件的Git仓库，并且使用了`--recurse-submodules`参数。

**有效性评估：**
根据提供的漏洞信息和POC代码，此漏洞的利用是有效的。POC代码演示了如何通过在`.gitmodules`文件的`url`字段中嵌入恶意命令来实现命令注入。当受害者克隆包含此文件的Git仓库时，恶意命令会被执行。

**投毒风险评估：**
虽然提供的POC代码本身是为了验证漏洞而编写的，但仍存在一定投毒风险。攻击者可能在POC代码中添加额外的恶意代码，例如：

*   **收集用户信息：** 在命令注入的payload中添加收集受害者系统信息的代码，例如用户名、操作系统版本等，并将这些信息发送到攻击者的服务器。
*   **安装后门：** 在受害者系统中安装后门程序，以便攻击者可以长期控制受害者系统。
*   **传播恶意软件：** 利用受害者系统作为跳板，进一步传播恶意软件。

然而，根据提供的POC代码来看，并没有发现明显的恶意行为，只是验证了命令注入。但是，如果攻击者公开分享了修改后的POC，投毒风险就会增大。因此，综合考虑，投毒风险评估为10%。原因是poc本身功能较为简单，且开源，容易被审核。

**项目地址:** [power1314520/CVE-2023-51385_test](https://github.com/power1314520/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #13

**来源**: [CVE-2023-51385-runooovb_CVE-2023-51385test.md](../2023/CVE-2023-51385-runooovb_CVE-2023-51385test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统存在受影响版本的OpenSSH，且攻击者能够控制用户名或主机名中使用的某些字符（通常通过Git子模块等方式）。

**POC 可用性:** 部分。提供的README.md只是描述，需要构造特定的用户名/主机名利用。

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。如果用户名或主机名包含shell元字符，并且该名称在某些情况下被扩展令牌引用，则可能发生操作系统命令注入。例如，不受信任的Git存储库可能包含一个子模块，该子模块在用户名或主机名中具有shell元字符。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**
提供的POC代码（README.md文件）本身不构成一个完整的PoC。它只是对漏洞的描述。完整的利用需要攻击者能够控制用户名或主机名，并在其中插入恶意的shell元字符。

**投毒风险：**
提供的代码仓库（只有README.md）投毒的可能性较低，但是不排除作者在其他相关代码中包含恶意payload的可能。考虑到只有README.md,所以投毒风险较低,评估为10%。

**利用方式：**
1.  **控制用户名/主机名：** 攻击者需要找到一种方法来控制OpenSSH客户端使用的用户名或主机名。这可能通过以下方式实现：
    *   **恶意的Git子模块：**  创建一个包含恶意子模块的Git仓库。该子模块的URL可能包含带有shell元字符的用户名或主机名。
    *   **其他配置：**  在其他OpenSSH配置文件（例如`~/.ssh/config`）中，如果可以控制Host字段,也可以插入恶意字符
2.  **触发漏洞：** 当OpenSSH客户端尝试连接到恶意主机或处理包含恶意子模块的仓库时，它会展开用户名/主机名中的shell元字符，从而导致命令注入。
3.  **执行任意命令：** 攻击者可以通过注入的命令在目标系统上执行任意代码。

综上所述，该漏洞利用需要一定的条件，但如果成功利用，则风险极高。

**项目地址:** [runooovb/CVE-2023-51385test](https://github.com/runooovb/CVE-2023-51385test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #14

**来源**: [CVE-2023-51385-selecthch_CVE-2023-51385.md](../2023/CVE-2023-51385-selecthch_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用受影响的OpenSSH版本，并且攻击者可以控制用户名或主机名中的shell元字符。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符并且这些名称在某些情况下被扩展标记引用时，可能会发生操作系统命令注入。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞是有效的，允许远程攻击者执行任意操作系统命令。

**投毒风险：**

提供的 POC 代码包含一个 `.gitmodules` 格式的文件，该文件定义了一个名为 "cves" 的子模块，该子模块的 URL 包含命令 `gnome-calculator`。当 `git submodule update --init --recursive` 被执行时，`gnome-calculator`命令就会被执行。这可能存在投毒风险。如果攻击者将恶意命令嵌入到子模块 URL 中，当用户克隆包含此子模块的恶意仓库并尝试初始化和更新子模块时，就会执行这些命令。风险评估为10%，主要是因为这个POC比较明显，容易被发现，且`gnome-calculator`本身无恶意，如果替换成更隐蔽的恶意命令，投毒性会更高。

**利用方式：**

1.  攻击者创建一个恶意的 Git 仓库，并在 `.gitmodules` 文件中，将子模块的 URL 设置为包含 shell 元字符和恶意命令的字符串。
2.  受害者克隆该恶意 Git 仓库。
3.  受害者执行 `git submodule update --init --recursive` 命令以初始化和更新子模块。
4.  由于 URL 中的 shell 元字符未被正确转义，OpenSSH 将执行 URL 中的恶意命令，导致远程代码执行。

**项目地址:** [selecthch/CVE-2023-51385](https://github.com/selecthch/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #15

**来源**: [CVE-2023-51385-thinkliving2020_CVE-2023-51385-.md](../2023/CVE-2023-51385-thinkliving2020_CVE-2023-51385-.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 受害者需要使用存在漏洞的OpenSSH版本，并连接到包含恶意配置的Git仓库子模块或者其他存在恶意用户名/主机名的配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 漏洞存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符时，如果这些名称被特定的扩展令牌引用，可能导致操作系统命令注入。例如，一个不受信任的 Git 仓库的子模块可能在用户名或主机名中包含 shell 元字符。 

**有效性:** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在并且影响 OpenSSH 9.6 之前的版本。提供的 POC 代码利用了 `~/.ssh/config` 文件中的 `ProxyCommand` 指令，通过在主机名中使用 shell 元字符来执行任意命令。通过`git clone --recurse-submodules`下载包含恶意配置的子模块，即可触发漏洞。 

**投毒风险:** 该POC提供了一个通过恶意配置子模块触发计算器弹出的例子，帮助用户验证该漏洞，提高安全意识。但是，如果攻击者修改了 `~/.ssh/config` 文件或通过其他方式将恶意的用户名/主机名注入到配置中，就有可能执行任意命令，造成安全风险。因此，虽然POC本身是为了演示漏洞，但也存在被滥用的可能。 投毒风险评估为10%，主要考虑攻击者可能在公开的漏洞利用代码中添加恶意代码，诱导用户执行，但是该POC主要依赖配置文件的恶意构造，直接添加恶意代码到POC文件中的可能性较低。

**利用方式:**  利用方式主要通过以下步骤：
1.  攻击者创建一个包含恶意子模块的Git仓库，该子模块的用户名或主机名包含shell元字符。
2.  受害者克隆该仓库，并使用 `--recurse-submodules` 参数初始化子模块。
3.  当 OpenSSH 使用 `ProxyCommand` 指令处理包含恶意元字符的用户名或主机名时，会执行攻击者构造的恶意命令。

另一种利用方式是攻击者诱导受害者在`~/.ssh/config`中添加包含恶意shell元字符的配置信息，当ssh连接目标主机时触发该配置，执行恶意命令。


**项目地址:** [thinkliving2020/CVE-2023-51385-](https://github.com/thinkliving2020/CVE-2023-51385-)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #16

**来源**: [CVE-2023-51385-vin01_poc-proxycommand-vulnerable.md](../2023/CVE-2023-51385-vin01_poc-proxycommand-vulnerable.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用OpenSSH，且受害者需要clone包含恶意submodule的Git仓库或连接到包含恶意用户名/主机名的SSH服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于OpenSSH 9.6之前的版本中。该漏洞允许攻击者通过在用户名或主机名中注入shell元字符来执行任意操作系统命令。当 OpenSSH 在某些情况下扩展令牌时，如果用户名或主机名包含shell元字符，则可能发生OS命令注入。

**有效性：** 提供的POC代码显示了一种利用`ProxyCommand`配置项中`%h`和`%p`等令牌的方式，当这些令牌引用的主机名或用户名包含shell元字符时，可能导致命令注入。POC通过一个包含恶意子模块的Git仓库进行演示，攻击者可以诱使用户clone该仓库，从而触发漏洞。

**投毒风险：**  POC仓库本身的主要目的是演示漏洞，但存在一定投毒风险。  风险点在于Submodule的地址可被篡改，从而指向包含更恶意代码的仓库。Readme中包含执行`git clone`的命令，引导用户执行恶意操作。虽然当前POC只是弹出一个计算器，但攻击者可以替换Submodule指向的仓库，加入其他恶意代码，例如植入后门、窃取信息等。风险评估为10%，主要考虑因素是POC的主要目的是演示漏洞，并非大规模恶意攻击，但存在被二次利用的风险。  

**利用方式：**

1.  **恶意Git仓库：** 攻击者创建一个包含恶意子模块的Git仓库。子模块的URL包含带有shell元字符的用户名或主机名。
2.  **诱导受害者：** 攻击者诱导受害者克隆该Git仓库，可以使用`git clone --recurse-submodules`命令。
3.  **触发漏洞：** 当git clone子模块时，OpenSSH会解析`.ssh/config` 文件，如果文件中存在`ProxyCommand`等配置项，并且使用了受影响的令牌（如 `%h`、`%p`），则会导致命令注入。
4.  **命令执行：** 注入的shell元字符会被执行，从而允许攻击者在受害者系统上执行任意命令。 

**缓解措施：**
*   升级到OpenSSH 9.6或更高版本。
*   避免在用户名或主机名中使用shell元字符。
*   仔细审查`.ssh/config`文件，特别是 `ProxyCommand` 配置项。
*   谨慎克隆来自不可信来源的Git仓库。

**项目地址:** [vin01/poc-proxycommand-vulnerable](https://github.com/vin01/poc-proxycommand-vulnerable)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #17

**来源**: [CVE-2023-51385-watarium_poc-cve-2023-51385.md](../2023/CVE-2023-51385-watarium_poc-cve-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用OpenSSH，且用户名或主机名包含shell元字符并被某些扩展令牌引用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 漏洞存在于OpenSSH 9.6版本之前，允许攻击者通过在用户名或主机名中注入shell元字符，并在特定情况下被扩展令牌引用时，执行任意操作系统命令。例如，恶意Git仓库的子模块可以在用户名或主机名中包含shell元字符。提供的POC代码 `poc-cve-2023-51385`  仅包含一个 `README.md` 文件，内容简单，仅为标题，说明poc是存在的，但是这个简单的poc没有展示任何攻击代码，这意味着需要其他方式来利用此漏洞。该漏洞的利用方式主要通过以下步骤：1.  攻击者构造包含恶意shell元字符的用户名或主机名。2.  攻击者诱使用户连接到包含恶意用户名或主机名的系统。3.  OpenSSH处理连接时，如果相关配置（例如 `ProxyCommand`）使用了扩展令牌引用该用户名或主机名，则会执行注入的shell命令。根据搜索结果，此漏洞已经公开，并且多个厂商发布了安全公告。虽然提供的POC很简单，但该漏洞的严重性不容忽视。投毒风险评估：由于 POC 代码非常简单，只包含一个 README 文件，因此直接投毒的可能性较低。但是，后续利用该漏洞的Payload可能存在投毒风险，例如，利用该漏洞在目标机器上安装恶意软件或后门。考虑到POC代码的简洁性，以及漏洞本身的性质，估计该仓库存在作者隐藏的投毒代码的可能性较低，约为10%。

**项目地址:** [watarium/poc-cve-2023-51385](https://github.com/watarium/poc-cve-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---



---

## POC #9

**来源**: [CVE-2023-51385-endasugrue_CVE-2023-51385_poc.md](../2023/CVE-2023-51385-endasugrue_CVE-2023-51385_poc.md)

## CVE-2023-51385 OpenSSH 命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含shell元字符，且在特定情况下被扩展令牌引用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中存在的一个命令注入漏洞。当用户名或主机名包含 shell 元字符，并且该名称在某些情况下被扩展令牌引用时，可能发生操作系统命令注入。例如，不受信任的 Git 仓库可能具有子模块，其用户名或主机名中包含 shell 元字符。 

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的利用涉及到shell元字符的注入。提供的 POC 代码非常简短，仅包含一个 README.md 文件，指示该项目旨在提供漏洞的概念验证。因此，该POC本身并不能直接验证漏洞，需要结合其他方式例如vin01.github.io/piptagole/ssh/security/openssh/libssh/remote-code-execution/2023/12/20/openssh-proxycommand-libssh-rce.html 中的信息来构造完整的利用链.可以确认漏洞可以利用。

**投毒风险：**

当前提供的 POC 代码（README.md）不包含任何可执行代码，因此直接的投毒风险很低。但是，如果攻击者修改或替换了该 POC，添加了恶意代码，则存在投毒风险。因为该漏洞涉及到命令执行，后门代码可能隐藏在被注入的命令中，实现持久化控制。

**利用方式：**

1.  **构造恶意用户名或主机名：** 攻击者需要创建一个包含 shell 元字符的用户名或主机名。
2.  **触发扩展令牌引用：** 在某些 OpenSSH 配置中，例如使用 `ProxyCommand` 指令，会扩展用户名或主机名。如果扩展过程中没有正确转义 shell 元字符，就会导致命令注入。
3.  **执行任意命令：** 攻击者可以通过注入恶意的 shell 命令来执行任意操作系统命令。

例如，攻击者可以在 Git 子模块的 URL 中嵌入恶意代码，当 OpenSSH 克隆该子模块时，会执行该恶意代码。

从搜索引擎的结果来看，该漏洞影响广泛，多个厂商都发布了安全公告，确认了漏洞的存在和危害。

**项目地址:** [endasugrue/CVE-2023-51385_poc](https://github.com/endasugrue/CVE-2023-51385_poc)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #10

**来源**: [CVE-2023-51385-julienbrs_exploit-CVE-2023-51385.md](../2023/CVE-2023-51385-julienbrs_exploit-CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名称或主机名称包含shell元字符，并且该名称在某些情况下被扩展令牌引用。需要能够触发使用了这些名称的SSH操作。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中的一个命令注入漏洞。当用户名或主机名包含shell元字符时，如果这个名字被某些情况下的扩展令牌引用，就可能发生操作系统命令注入。例如，一个不受信任的 Git 仓库可能有一个子模块，其用户名或主机名中包含 shell 元字符。利用方式是构造包含恶意 shell 元字符的用户名或主机名，并触发 OpenSSH 使用该名称的操作，例如通过包含恶意子模块的 Git 仓库。提供的POC代码只是一个README.md文件，不包含任何可执行代码，因此，不存在投毒风险。

**有效性：** 提供的POC代码只是一个README文件，本身不具备漏洞利用能力，因此本身提供的POC无效，需要结合其他方式触发。但是漏洞本身是存在的，搜索结果表明该漏洞存在并且可以利用。

**投毒风险：** 提供的 POC 代码仅包含一个 README.md 文件，没有任何可执行代码，因此不存在投毒风险。

**利用方式：** 漏洞的利用方式是构造包含恶意 shell 元字符的用户名或主机名，然后让 OpenSSH 在处理 SSH 连接或相关操作时引用这些名字。例如，可以通过创建一个包含恶意用户名或主机名的 Git 子模块，然后当用户尝试克隆或更新该 Git 仓库时，触发命令注入。ProxyCommand也是一个常见的攻击点，在ssh config中可以使用ProxyCommand执行任意命令。攻击者可以在用户名或主机名中嵌入恶意命令，这些命令会在 ProxyCommand 被调用时执行。

**项目地址:** [julienbrs/exploit-CVE-2023-51385](https://github.com/julienbrs/exploit-CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #11

**来源**: [CVE-2023-51385-julienbrs_malicious-exploit-CVE-2023-51385.md](../2023/CVE-2023-51385-julienbrs_malicious-exploit-CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含Shell元字符，并且在特定情况下被扩展令牌引用

**POC 可用性:** 是，但提供的POC代码不完整

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中，允许在特定情况下进行操作系统命令注入。如果用户名或主机名包含 Shell 元字符，并且该名称被某些扩展令牌引用，则可能发生此漏洞。例如，不受信任的 Git 存储库可能具有一个子模块，其用户名或主机名中包含 shell 元字符。提供的漏洞利用代码只是一个 README 文件，本身不包含任何利用逻辑。因此，实际利用还需要构造恶意用户名/主机名并通过特定的 OpenSSH 功能（如 ProxyCommand）触发命令注入。

**有效性：** 提供的POC代码 (README.md) 本身无效，仅为占位符，不具备漏洞利用能力。需要结合漏洞描述构造特定的利用场景才能触发漏洞。

**投毒风险：** 由于提供的代码仅仅是 README 文件，所以认为存在投毒代码的可能性较低，但是不排除作者在其他未提供的代码中隐藏恶意Payload，因此投毒风险评估为 10%。

**利用方式：** 漏洞利用方式如下：
1.  攻击者需要控制包含恶意 Shell 元字符的用户名或主机名。
2.  攻击者诱使用户使用受影响的 OpenSSH 版本连接到恶意服务器或克隆包含恶意配置的Git仓库，触发包含shell元字符的用户名或主机名被引用。
3.  OpenSSH 在处理这些包含 Shell 元字符的名称时，由于不正确的转义或过滤，导致命令注入。
4.  攻击者可以在目标系统上执行任意命令。

**项目地址:** [julienbrs/malicious-exploit-CVE-2023-51385](https://github.com/julienbrs/malicious-exploit-CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #12

**来源**: [CVE-2023-51385-power1314520_CVE-2023-51385_test.md](../2023/CVE-2023-51385-power1314520_CVE-2023-51385_test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要受害者克隆包含恶意.gitmodules文件的Git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。漏洞的根本原因是OpenSSH在处理用户名或主机名中的shell元字符时存在缺陷，当这些名称被扩展令牌引用时，可能导致命令注入。

**漏洞利用方式：**
1.  **利用场景:** 攻击者可以通过创建一个包含恶意`.gitmodules`文件的Git仓库来利用此漏洞。`.gitmodules` 文件用于定义Git子模块的配置信息。
2.  **攻击步骤:**
    *   攻击者创建一个恶意Git仓库，其中包含一个`.gitmodules`文件，该文件在`url`字段中嵌入恶意命令，例如：
        ```
        url = ssh://`echo helloworld > cve.txt`foo.example.com/bar
        ```
    *   攻击者诱使受害者克隆该恶意Git仓库，并且使用`--recurse-submodules`参数。该参数指示Git同时克隆仓库及其子模块。
    *   当Git处理`.gitmodules`文件时，会执行`url`字段中的命令，导致命令注入。
3.  **利用前提条件:**
    *   受害者使用OpenSSH 9.6之前的版本。
    *   受害者的SSH客户端配置了`ProxyCommand`，并且存在可利用的扩展令牌。
    *   受害者克隆了包含恶意`.gitmodules`文件的Git仓库，并且使用了`--recurse-submodules`参数。

**有效性评估：**
根据提供的漏洞信息和POC代码，此漏洞的利用是有效的。POC代码演示了如何通过在`.gitmodules`文件的`url`字段中嵌入恶意命令来实现命令注入。当受害者克隆包含此文件的Git仓库时，恶意命令会被执行。

**投毒风险评估：**
虽然提供的POC代码本身是为了验证漏洞而编写的，但仍存在一定投毒风险。攻击者可能在POC代码中添加额外的恶意代码，例如：

*   **收集用户信息：** 在命令注入的payload中添加收集受害者系统信息的代码，例如用户名、操作系统版本等，并将这些信息发送到攻击者的服务器。
*   **安装后门：** 在受害者系统中安装后门程序，以便攻击者可以长期控制受害者系统。
*   **传播恶意软件：** 利用受害者系统作为跳板，进一步传播恶意软件。

然而，根据提供的POC代码来看，并没有发现明显的恶意行为，只是验证了命令注入。但是，如果攻击者公开分享了修改后的POC，投毒风险就会增大。因此，综合考虑，投毒风险评估为10%。原因是poc本身功能较为简单，且开源，容易被审核。

**项目地址:** [power1314520/CVE-2023-51385_test](https://github.com/power1314520/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #13

**来源**: [CVE-2023-51385-runooovb_CVE-2023-51385test.md](../2023/CVE-2023-51385-runooovb_CVE-2023-51385test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统存在受影响版本的OpenSSH，且攻击者能够控制用户名或主机名中使用的某些字符（通常通过Git子模块等方式）。

**POC 可用性:** 部分。提供的README.md只是描述，需要构造特定的用户名/主机名利用。

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。如果用户名或主机名包含shell元字符，并且该名称在某些情况下被扩展令牌引用，则可能发生操作系统命令注入。例如，不受信任的Git存储库可能包含一个子模块，该子模块在用户名或主机名中具有shell元字符。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**
提供的POC代码（README.md文件）本身不构成一个完整的PoC。它只是对漏洞的描述。完整的利用需要攻击者能够控制用户名或主机名，并在其中插入恶意的shell元字符。

**投毒风险：**
提供的代码仓库（只有README.md）投毒的可能性较低，但是不排除作者在其他相关代码中包含恶意payload的可能。考虑到只有README.md,所以投毒风险较低,评估为10%。

**利用方式：**
1.  **控制用户名/主机名：** 攻击者需要找到一种方法来控制OpenSSH客户端使用的用户名或主机名。这可能通过以下方式实现：
    *   **恶意的Git子模块：**  创建一个包含恶意子模块的Git仓库。该子模块的URL可能包含带有shell元字符的用户名或主机名。
    *   **其他配置：**  在其他OpenSSH配置文件（例如`~/.ssh/config`）中，如果可以控制Host字段,也可以插入恶意字符
2.  **触发漏洞：** 当OpenSSH客户端尝试连接到恶意主机或处理包含恶意子模块的仓库时，它会展开用户名/主机名中的shell元字符，从而导致命令注入。
3.  **执行任意命令：** 攻击者可以通过注入的命令在目标系统上执行任意代码。

综上所述，该漏洞利用需要一定的条件，但如果成功利用，则风险极高。

**项目地址:** [runooovb/CVE-2023-51385test](https://github.com/runooovb/CVE-2023-51385test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #14

**来源**: [CVE-2023-51385-selecthch_CVE-2023-51385.md](../2023/CVE-2023-51385-selecthch_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用受影响的OpenSSH版本，并且攻击者可以控制用户名或主机名中的shell元字符。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符并且这些名称在某些情况下被扩展标记引用时，可能会发生操作系统命令注入。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞是有效的，允许远程攻击者执行任意操作系统命令。

**投毒风险：**

提供的 POC 代码包含一个 `.gitmodules` 格式的文件，该文件定义了一个名为 "cves" 的子模块，该子模块的 URL 包含命令 `gnome-calculator`。当 `git submodule update --init --recursive` 被执行时，`gnome-calculator`命令就会被执行。这可能存在投毒风险。如果攻击者将恶意命令嵌入到子模块 URL 中，当用户克隆包含此子模块的恶意仓库并尝试初始化和更新子模块时，就会执行这些命令。风险评估为10%，主要是因为这个POC比较明显，容易被发现，且`gnome-calculator`本身无恶意，如果替换成更隐蔽的恶意命令，投毒性会更高。

**利用方式：**

1.  攻击者创建一个恶意的 Git 仓库，并在 `.gitmodules` 文件中，将子模块的 URL 设置为包含 shell 元字符和恶意命令的字符串。
2.  受害者克隆该恶意 Git 仓库。
3.  受害者执行 `git submodule update --init --recursive` 命令以初始化和更新子模块。
4.  由于 URL 中的 shell 元字符未被正确转义，OpenSSH 将执行 URL 中的恶意命令，导致远程代码执行。

**项目地址:** [selecthch/CVE-2023-51385](https://github.com/selecthch/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #15

**来源**: [CVE-2023-51385-thinkliving2020_CVE-2023-51385-.md](../2023/CVE-2023-51385-thinkliving2020_CVE-2023-51385-.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 受害者需要使用存在漏洞的OpenSSH版本，并连接到包含恶意配置的Git仓库子模块或者其他存在恶意用户名/主机名的配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 漏洞存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符时，如果这些名称被特定的扩展令牌引用，可能导致操作系统命令注入。例如，一个不受信任的 Git 仓库的子模块可能在用户名或主机名中包含 shell 元字符。 

**有效性:** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在并且影响 OpenSSH 9.6 之前的版本。提供的 POC 代码利用了 `~/.ssh/config` 文件中的 `ProxyCommand` 指令，通过在主机名中使用 shell 元字符来执行任意命令。通过`git clone --recurse-submodules`下载包含恶意配置的子模块，即可触发漏洞。 

**投毒风险:** 该POC提供了一个通过恶意配置子模块触发计算器弹出的例子，帮助用户验证该漏洞，提高安全意识。但是，如果攻击者修改了 `~/.ssh/config` 文件或通过其他方式将恶意的用户名/主机名注入到配置中，就有可能执行任意命令，造成安全风险。因此，虽然POC本身是为了演示漏洞，但也存在被滥用的可能。 投毒风险评估为10%，主要考虑攻击者可能在公开的漏洞利用代码中添加恶意代码，诱导用户执行，但是该POC主要依赖配置文件的恶意构造，直接添加恶意代码到POC文件中的可能性较低。

**利用方式:**  利用方式主要通过以下步骤：
1.  攻击者创建一个包含恶意子模块的Git仓库，该子模块的用户名或主机名包含shell元字符。
2.  受害者克隆该仓库，并使用 `--recurse-submodules` 参数初始化子模块。
3.  当 OpenSSH 使用 `ProxyCommand` 指令处理包含恶意元字符的用户名或主机名时，会执行攻击者构造的恶意命令。

另一种利用方式是攻击者诱导受害者在`~/.ssh/config`中添加包含恶意shell元字符的配置信息，当ssh连接目标主机时触发该配置，执行恶意命令。


**项目地址:** [thinkliving2020/CVE-2023-51385-](https://github.com/thinkliving2020/CVE-2023-51385-)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #16

**来源**: [CVE-2023-51385-vin01_poc-proxycommand-vulnerable.md](../2023/CVE-2023-51385-vin01_poc-proxycommand-vulnerable.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用OpenSSH，且受害者需要clone包含恶意submodule的Git仓库或连接到包含恶意用户名/主机名的SSH服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于OpenSSH 9.6之前的版本中。该漏洞允许攻击者通过在用户名或主机名中注入shell元字符来执行任意操作系统命令。当 OpenSSH 在某些情况下扩展令牌时，如果用户名或主机名包含shell元字符，则可能发生OS命令注入。

**有效性：** 提供的POC代码显示了一种利用`ProxyCommand`配置项中`%h`和`%p`等令牌的方式，当这些令牌引用的主机名或用户名包含shell元字符时，可能导致命令注入。POC通过一个包含恶意子模块的Git仓库进行演示，攻击者可以诱使用户clone该仓库，从而触发漏洞。

**投毒风险：**  POC仓库本身的主要目的是演示漏洞，但存在一定投毒风险。  风险点在于Submodule的地址可被篡改，从而指向包含更恶意代码的仓库。Readme中包含执行`git clone`的命令，引导用户执行恶意操作。虽然当前POC只是弹出一个计算器，但攻击者可以替换Submodule指向的仓库，加入其他恶意代码，例如植入后门、窃取信息等。风险评估为10%，主要考虑因素是POC的主要目的是演示漏洞，并非大规模恶意攻击，但存在被二次利用的风险。  

**利用方式：**

1.  **恶意Git仓库：** 攻击者创建一个包含恶意子模块的Git仓库。子模块的URL包含带有shell元字符的用户名或主机名。
2.  **诱导受害者：** 攻击者诱导受害者克隆该Git仓库，可以使用`git clone --recurse-submodules`命令。
3.  **触发漏洞：** 当git clone子模块时，OpenSSH会解析`.ssh/config` 文件，如果文件中存在`ProxyCommand`等配置项，并且使用了受影响的令牌（如 `%h`、`%p`），则会导致命令注入。
4.  **命令执行：** 注入的shell元字符会被执行，从而允许攻击者在受害者系统上执行任意命令。 

**缓解措施：**
*   升级到OpenSSH 9.6或更高版本。
*   避免在用户名或主机名中使用shell元字符。
*   仔细审查`.ssh/config`文件，特别是 `ProxyCommand` 配置项。
*   谨慎克隆来自不可信来源的Git仓库。

**项目地址:** [vin01/poc-proxycommand-vulnerable](https://github.com/vin01/poc-proxycommand-vulnerable)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #17

**来源**: [CVE-2023-51385-watarium_poc-cve-2023-51385.md](../2023/CVE-2023-51385-watarium_poc-cve-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用OpenSSH，且用户名或主机名包含shell元字符并被某些扩展令牌引用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 漏洞存在于OpenSSH 9.6版本之前，允许攻击者通过在用户名或主机名中注入shell元字符，并在特定情况下被扩展令牌引用时，执行任意操作系统命令。例如，恶意Git仓库的子模块可以在用户名或主机名中包含shell元字符。提供的POC代码 `poc-cve-2023-51385`  仅包含一个 `README.md` 文件，内容简单，仅为标题，说明poc是存在的，但是这个简单的poc没有展示任何攻击代码，这意味着需要其他方式来利用此漏洞。该漏洞的利用方式主要通过以下步骤：1.  攻击者构造包含恶意shell元字符的用户名或主机名。2.  攻击者诱使用户连接到包含恶意用户名或主机名的系统。3.  OpenSSH处理连接时，如果相关配置（例如 `ProxyCommand`）使用了扩展令牌引用该用户名或主机名，则会执行注入的shell命令。根据搜索结果，此漏洞已经公开，并且多个厂商发布了安全公告。虽然提供的POC很简单，但该漏洞的严重性不容忽视。投毒风险评估：由于 POC 代码非常简单，只包含一个 README 文件，因此直接投毒的可能性较低。但是，后续利用该漏洞的Payload可能存在投毒风险，例如，利用该漏洞在目标机器上安装恶意软件或后门。考虑到POC代码的简洁性，以及漏洞本身的性质，估计该仓库存在作者隐藏的投毒代码的可能性较低，约为10%。

**项目地址:** [watarium/poc-cve-2023-51385](https://github.com/watarium/poc-cve-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---



---

## POC #9

**来源**: [CVE-2023-51385-endasugrue_CVE-2023-51385_poc.md](../2023/CVE-2023-51385-endasugrue_CVE-2023-51385_poc.md)

## CVE-2023-51385 OpenSSH 命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含shell元字符，且在特定情况下被扩展令牌引用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中存在的一个命令注入漏洞。当用户名或主机名包含 shell 元字符，并且该名称在某些情况下被扩展令牌引用时，可能发生操作系统命令注入。例如，不受信任的 Git 仓库可能具有子模块，其用户名或主机名中包含 shell 元字符。 

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的利用涉及到shell元字符的注入。提供的 POC 代码非常简短，仅包含一个 README.md 文件，指示该项目旨在提供漏洞的概念验证。因此，该POC本身并不能直接验证漏洞，需要结合其他方式例如vin01.github.io/piptagole/ssh/security/openssh/libssh/remote-code-execution/2023/12/20/openssh-proxycommand-libssh-rce.html 中的信息来构造完整的利用链.可以确认漏洞可以利用。

**投毒风险：**

当前提供的 POC 代码（README.md）不包含任何可执行代码，因此直接的投毒风险很低。但是，如果攻击者修改或替换了该 POC，添加了恶意代码，则存在投毒风险。因为该漏洞涉及到命令执行，后门代码可能隐藏在被注入的命令中，实现持久化控制。

**利用方式：**

1.  **构造恶意用户名或主机名：** 攻击者需要创建一个包含 shell 元字符的用户名或主机名。
2.  **触发扩展令牌引用：** 在某些 OpenSSH 配置中，例如使用 `ProxyCommand` 指令，会扩展用户名或主机名。如果扩展过程中没有正确转义 shell 元字符，就会导致命令注入。
3.  **执行任意命令：** 攻击者可以通过注入恶意的 shell 命令来执行任意操作系统命令。

例如，攻击者可以在 Git 子模块的 URL 中嵌入恶意代码，当 OpenSSH 克隆该子模块时，会执行该恶意代码。

从搜索引擎的结果来看，该漏洞影响广泛，多个厂商都发布了安全公告，确认了漏洞的存在和危害。

**项目地址:** [endasugrue/CVE-2023-51385_poc](https://github.com/endasugrue/CVE-2023-51385_poc)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #10

**来源**: [CVE-2023-51385-julienbrs_exploit-CVE-2023-51385.md](../2023/CVE-2023-51385-julienbrs_exploit-CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名称或主机名称包含shell元字符，并且该名称在某些情况下被扩展令牌引用。需要能够触发使用了这些名称的SSH操作。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中的一个命令注入漏洞。当用户名或主机名包含shell元字符时，如果这个名字被某些情况下的扩展令牌引用，就可能发生操作系统命令注入。例如，一个不受信任的 Git 仓库可能有一个子模块，其用户名或主机名中包含 shell 元字符。利用方式是构造包含恶意 shell 元字符的用户名或主机名，并触发 OpenSSH 使用该名称的操作，例如通过包含恶意子模块的 Git 仓库。提供的POC代码只是一个README.md文件，不包含任何可执行代码，因此，不存在投毒风险。

**有效性：** 提供的POC代码只是一个README文件，本身不具备漏洞利用能力，因此本身提供的POC无效，需要结合其他方式触发。但是漏洞本身是存在的，搜索结果表明该漏洞存在并且可以利用。

**投毒风险：** 提供的 POC 代码仅包含一个 README.md 文件，没有任何可执行代码，因此不存在投毒风险。

**利用方式：** 漏洞的利用方式是构造包含恶意 shell 元字符的用户名或主机名，然后让 OpenSSH 在处理 SSH 连接或相关操作时引用这些名字。例如，可以通过创建一个包含恶意用户名或主机名的 Git 子模块，然后当用户尝试克隆或更新该 Git 仓库时，触发命令注入。ProxyCommand也是一个常见的攻击点，在ssh config中可以使用ProxyCommand执行任意命令。攻击者可以在用户名或主机名中嵌入恶意命令，这些命令会在 ProxyCommand 被调用时执行。

**项目地址:** [julienbrs/exploit-CVE-2023-51385](https://github.com/julienbrs/exploit-CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #11

**来源**: [CVE-2023-51385-julienbrs_malicious-exploit-CVE-2023-51385.md](../2023/CVE-2023-51385-julienbrs_malicious-exploit-CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含Shell元字符，并且在特定情况下被扩展令牌引用

**POC 可用性:** 是，但提供的POC代码不完整

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中，允许在特定情况下进行操作系统命令注入。如果用户名或主机名包含 Shell 元字符，并且该名称被某些扩展令牌引用，则可能发生此漏洞。例如，不受信任的 Git 存储库可能具有一个子模块，其用户名或主机名中包含 shell 元字符。提供的漏洞利用代码只是一个 README 文件，本身不包含任何利用逻辑。因此，实际利用还需要构造恶意用户名/主机名并通过特定的 OpenSSH 功能（如 ProxyCommand）触发命令注入。

**有效性：** 提供的POC代码 (README.md) 本身无效，仅为占位符，不具备漏洞利用能力。需要结合漏洞描述构造特定的利用场景才能触发漏洞。

**投毒风险：** 由于提供的代码仅仅是 README 文件，所以认为存在投毒代码的可能性较低，但是不排除作者在其他未提供的代码中隐藏恶意Payload，因此投毒风险评估为 10%。

**利用方式：** 漏洞利用方式如下：
1.  攻击者需要控制包含恶意 Shell 元字符的用户名或主机名。
2.  攻击者诱使用户使用受影响的 OpenSSH 版本连接到恶意服务器或克隆包含恶意配置的Git仓库，触发包含shell元字符的用户名或主机名被引用。
3.  OpenSSH 在处理这些包含 Shell 元字符的名称时，由于不正确的转义或过滤，导致命令注入。
4.  攻击者可以在目标系统上执行任意命令。

**项目地址:** [julienbrs/malicious-exploit-CVE-2023-51385](https://github.com/julienbrs/malicious-exploit-CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #12

**来源**: [CVE-2023-51385-power1314520_CVE-2023-51385_test.md](../2023/CVE-2023-51385-power1314520_CVE-2023-51385_test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要受害者克隆包含恶意.gitmodules文件的Git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。漏洞的根本原因是OpenSSH在处理用户名或主机名中的shell元字符时存在缺陷，当这些名称被扩展令牌引用时，可能导致命令注入。

**漏洞利用方式：**
1.  **利用场景:** 攻击者可以通过创建一个包含恶意`.gitmodules`文件的Git仓库来利用此漏洞。`.gitmodules` 文件用于定义Git子模块的配置信息。
2.  **攻击步骤:**
    *   攻击者创建一个恶意Git仓库，其中包含一个`.gitmodules`文件，该文件在`url`字段中嵌入恶意命令，例如：
        ```
        url = ssh://`echo helloworld > cve.txt`foo.example.com/bar
        ```
    *   攻击者诱使受害者克隆该恶意Git仓库，并且使用`--recurse-submodules`参数。该参数指示Git同时克隆仓库及其子模块。
    *   当Git处理`.gitmodules`文件时，会执行`url`字段中的命令，导致命令注入。
3.  **利用前提条件:**
    *   受害者使用OpenSSH 9.6之前的版本。
    *   受害者的SSH客户端配置了`ProxyCommand`，并且存在可利用的扩展令牌。
    *   受害者克隆了包含恶意`.gitmodules`文件的Git仓库，并且使用了`--recurse-submodules`参数。

**有效性评估：**
根据提供的漏洞信息和POC代码，此漏洞的利用是有效的。POC代码演示了如何通过在`.gitmodules`文件的`url`字段中嵌入恶意命令来实现命令注入。当受害者克隆包含此文件的Git仓库时，恶意命令会被执行。

**投毒风险评估：**
虽然提供的POC代码本身是为了验证漏洞而编写的，但仍存在一定投毒风险。攻击者可能在POC代码中添加额外的恶意代码，例如：

*   **收集用户信息：** 在命令注入的payload中添加收集受害者系统信息的代码，例如用户名、操作系统版本等，并将这些信息发送到攻击者的服务器。
*   **安装后门：** 在受害者系统中安装后门程序，以便攻击者可以长期控制受害者系统。
*   **传播恶意软件：** 利用受害者系统作为跳板，进一步传播恶意软件。

然而，根据提供的POC代码来看，并没有发现明显的恶意行为，只是验证了命令注入。但是，如果攻击者公开分享了修改后的POC，投毒风险就会增大。因此，综合考虑，投毒风险评估为10%。原因是poc本身功能较为简单，且开源，容易被审核。

**项目地址:** [power1314520/CVE-2023-51385_test](https://github.com/power1314520/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #13

**来源**: [CVE-2023-51385-runooovb_CVE-2023-51385test.md](../2023/CVE-2023-51385-runooovb_CVE-2023-51385test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统存在受影响版本的OpenSSH，且攻击者能够控制用户名或主机名中使用的某些字符（通常通过Git子模块等方式）。

**POC 可用性:** 部分。提供的README.md只是描述，需要构造特定的用户名/主机名利用。

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。如果用户名或主机名包含shell元字符，并且该名称在某些情况下被扩展令牌引用，则可能发生操作系统命令注入。例如，不受信任的Git存储库可能包含一个子模块，该子模块在用户名或主机名中具有shell元字符。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**
提供的POC代码（README.md文件）本身不构成一个完整的PoC。它只是对漏洞的描述。完整的利用需要攻击者能够控制用户名或主机名，并在其中插入恶意的shell元字符。

**投毒风险：**
提供的代码仓库（只有README.md）投毒的可能性较低，但是不排除作者在其他相关代码中包含恶意payload的可能。考虑到只有README.md,所以投毒风险较低,评估为10%。

**利用方式：**
1.  **控制用户名/主机名：** 攻击者需要找到一种方法来控制OpenSSH客户端使用的用户名或主机名。这可能通过以下方式实现：
    *   **恶意的Git子模块：**  创建一个包含恶意子模块的Git仓库。该子模块的URL可能包含带有shell元字符的用户名或主机名。
    *   **其他配置：**  在其他OpenSSH配置文件（例如`~/.ssh/config`）中，如果可以控制Host字段,也可以插入恶意字符
2.  **触发漏洞：** 当OpenSSH客户端尝试连接到恶意主机或处理包含恶意子模块的仓库时，它会展开用户名/主机名中的shell元字符，从而导致命令注入。
3.  **执行任意命令：** 攻击者可以通过注入的命令在目标系统上执行任意代码。

综上所述，该漏洞利用需要一定的条件，但如果成功利用，则风险极高。

**项目地址:** [runooovb/CVE-2023-51385test](https://github.com/runooovb/CVE-2023-51385test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #14

**来源**: [CVE-2023-51385-selecthch_CVE-2023-51385.md](../2023/CVE-2023-51385-selecthch_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用受影响的OpenSSH版本，并且攻击者可以控制用户名或主机名中的shell元字符。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符并且这些名称在某些情况下被扩展标记引用时，可能会发生操作系统命令注入。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞是有效的，允许远程攻击者执行任意操作系统命令。

**投毒风险：**

提供的 POC 代码包含一个 `.gitmodules` 格式的文件，该文件定义了一个名为 "cves" 的子模块，该子模块的 URL 包含命令 `gnome-calculator`。当 `git submodule update --init --recursive` 被执行时，`gnome-calculator`命令就会被执行。这可能存在投毒风险。如果攻击者将恶意命令嵌入到子模块 URL 中，当用户克隆包含此子模块的恶意仓库并尝试初始化和更新子模块时，就会执行这些命令。风险评估为10%，主要是因为这个POC比较明显，容易被发现，且`gnome-calculator`本身无恶意，如果替换成更隐蔽的恶意命令，投毒性会更高。

**利用方式：**

1.  攻击者创建一个恶意的 Git 仓库，并在 `.gitmodules` 文件中，将子模块的 URL 设置为包含 shell 元字符和恶意命令的字符串。
2.  受害者克隆该恶意 Git 仓库。
3.  受害者执行 `git submodule update --init --recursive` 命令以初始化和更新子模块。
4.  由于 URL 中的 shell 元字符未被正确转义，OpenSSH 将执行 URL 中的恶意命令，导致远程代码执行。

**项目地址:** [selecthch/CVE-2023-51385](https://github.com/selecthch/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #15

**来源**: [CVE-2023-51385-thinkliving2020_CVE-2023-51385-.md](../2023/CVE-2023-51385-thinkliving2020_CVE-2023-51385-.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 受害者需要使用存在漏洞的OpenSSH版本，并连接到包含恶意配置的Git仓库子模块或者其他存在恶意用户名/主机名的配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 漏洞存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符时，如果这些名称被特定的扩展令牌引用，可能导致操作系统命令注入。例如，一个不受信任的 Git 仓库的子模块可能在用户名或主机名中包含 shell 元字符。 

**有效性:** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在并且影响 OpenSSH 9.6 之前的版本。提供的 POC 代码利用了 `~/.ssh/config` 文件中的 `ProxyCommand` 指令，通过在主机名中使用 shell 元字符来执行任意命令。通过`git clone --recurse-submodules`下载包含恶意配置的子模块，即可触发漏洞。 

**投毒风险:** 该POC提供了一个通过恶意配置子模块触发计算器弹出的例子，帮助用户验证该漏洞，提高安全意识。但是，如果攻击者修改了 `~/.ssh/config` 文件或通过其他方式将恶意的用户名/主机名注入到配置中，就有可能执行任意命令，造成安全风险。因此，虽然POC本身是为了演示漏洞，但也存在被滥用的可能。 投毒风险评估为10%，主要考虑攻击者可能在公开的漏洞利用代码中添加恶意代码，诱导用户执行，但是该POC主要依赖配置文件的恶意构造，直接添加恶意代码到POC文件中的可能性较低。

**利用方式:**  利用方式主要通过以下步骤：
1.  攻击者创建一个包含恶意子模块的Git仓库，该子模块的用户名或主机名包含shell元字符。
2.  受害者克隆该仓库，并使用 `--recurse-submodules` 参数初始化子模块。
3.  当 OpenSSH 使用 `ProxyCommand` 指令处理包含恶意元字符的用户名或主机名时，会执行攻击者构造的恶意命令。

另一种利用方式是攻击者诱导受害者在`~/.ssh/config`中添加包含恶意shell元字符的配置信息，当ssh连接目标主机时触发该配置，执行恶意命令。


**项目地址:** [thinkliving2020/CVE-2023-51385-](https://github.com/thinkliving2020/CVE-2023-51385-)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #16

**来源**: [CVE-2023-51385-vin01_poc-proxycommand-vulnerable.md](../2023/CVE-2023-51385-vin01_poc-proxycommand-vulnerable.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用OpenSSH，且受害者需要clone包含恶意submodule的Git仓库或连接到包含恶意用户名/主机名的SSH服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于OpenSSH 9.6之前的版本中。该漏洞允许攻击者通过在用户名或主机名中注入shell元字符来执行任意操作系统命令。当 OpenSSH 在某些情况下扩展令牌时，如果用户名或主机名包含shell元字符，则可能发生OS命令注入。

**有效性：** 提供的POC代码显示了一种利用`ProxyCommand`配置项中`%h`和`%p`等令牌的方式，当这些令牌引用的主机名或用户名包含shell元字符时，可能导致命令注入。POC通过一个包含恶意子模块的Git仓库进行演示，攻击者可以诱使用户clone该仓库，从而触发漏洞。

**投毒风险：**  POC仓库本身的主要目的是演示漏洞，但存在一定投毒风险。  风险点在于Submodule的地址可被篡改，从而指向包含更恶意代码的仓库。Readme中包含执行`git clone`的命令，引导用户执行恶意操作。虽然当前POC只是弹出一个计算器，但攻击者可以替换Submodule指向的仓库，加入其他恶意代码，例如植入后门、窃取信息等。风险评估为10%，主要考虑因素是POC的主要目的是演示漏洞，并非大规模恶意攻击，但存在被二次利用的风险。  

**利用方式：**

1.  **恶意Git仓库：** 攻击者创建一个包含恶意子模块的Git仓库。子模块的URL包含带有shell元字符的用户名或主机名。
2.  **诱导受害者：** 攻击者诱导受害者克隆该Git仓库，可以使用`git clone --recurse-submodules`命令。
3.  **触发漏洞：** 当git clone子模块时，OpenSSH会解析`.ssh/config` 文件，如果文件中存在`ProxyCommand`等配置项，并且使用了受影响的令牌（如 `%h`、`%p`），则会导致命令注入。
4.  **命令执行：** 注入的shell元字符会被执行，从而允许攻击者在受害者系统上执行任意命令。 

**缓解措施：**
*   升级到OpenSSH 9.6或更高版本。
*   避免在用户名或主机名中使用shell元字符。
*   仔细审查`.ssh/config`文件，特别是 `ProxyCommand` 配置项。
*   谨慎克隆来自不可信来源的Git仓库。

**项目地址:** [vin01/poc-proxycommand-vulnerable](https://github.com/vin01/poc-proxycommand-vulnerable)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #17

**来源**: [CVE-2023-51385-watarium_poc-cve-2023-51385.md](../2023/CVE-2023-51385-watarium_poc-cve-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用OpenSSH，且用户名或主机名包含shell元字符并被某些扩展令牌引用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 漏洞存在于OpenSSH 9.6版本之前，允许攻击者通过在用户名或主机名中注入shell元字符，并在特定情况下被扩展令牌引用时，执行任意操作系统命令。例如，恶意Git仓库的子模块可以在用户名或主机名中包含shell元字符。提供的POC代码 `poc-cve-2023-51385`  仅包含一个 `README.md` 文件，内容简单，仅为标题，说明poc是存在的，但是这个简单的poc没有展示任何攻击代码，这意味着需要其他方式来利用此漏洞。该漏洞的利用方式主要通过以下步骤：1.  攻击者构造包含恶意shell元字符的用户名或主机名。2.  攻击者诱使用户连接到包含恶意用户名或主机名的系统。3.  OpenSSH处理连接时，如果相关配置（例如 `ProxyCommand`）使用了扩展令牌引用该用户名或主机名，则会执行注入的shell命令。根据搜索结果，此漏洞已经公开，并且多个厂商发布了安全公告。虽然提供的POC很简单，但该漏洞的严重性不容忽视。投毒风险评估：由于 POC 代码非常简单，只包含一个 README 文件，因此直接投毒的可能性较低。但是，后续利用该漏洞的Payload可能存在投毒风险，例如，利用该漏洞在目标机器上安装恶意软件或后门。考虑到POC代码的简洁性，以及漏洞本身的性质，估计该仓库存在作者隐藏的投毒代码的可能性较低，约为10%。

**项目地址:** [watarium/poc-cve-2023-51385](https://github.com/watarium/poc-cve-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---



---

## POC #9

**来源**: [CVE-2023-51385-endasugrue_CVE-2023-51385_poc.md](../2023/CVE-2023-51385-endasugrue_CVE-2023-51385_poc.md)

## CVE-2023-51385 OpenSSH 命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含shell元字符，且在特定情况下被扩展令牌引用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中存在的一个命令注入漏洞。当用户名或主机名包含 shell 元字符，并且该名称在某些情况下被扩展令牌引用时，可能发生操作系统命令注入。例如，不受信任的 Git 仓库可能具有子模块，其用户名或主机名中包含 shell 元字符。 

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的利用涉及到shell元字符的注入。提供的 POC 代码非常简短，仅包含一个 README.md 文件，指示该项目旨在提供漏洞的概念验证。因此，该POC本身并不能直接验证漏洞，需要结合其他方式例如vin01.github.io/piptagole/ssh/security/openssh/libssh/remote-code-execution/2023/12/20/openssh-proxycommand-libssh-rce.html 中的信息来构造完整的利用链.可以确认漏洞可以利用。

**投毒风险：**

当前提供的 POC 代码（README.md）不包含任何可执行代码，因此直接的投毒风险很低。但是，如果攻击者修改或替换了该 POC，添加了恶意代码，则存在投毒风险。因为该漏洞涉及到命令执行，后门代码可能隐藏在被注入的命令中，实现持久化控制。

**利用方式：**

1.  **构造恶意用户名或主机名：** 攻击者需要创建一个包含 shell 元字符的用户名或主机名。
2.  **触发扩展令牌引用：** 在某些 OpenSSH 配置中，例如使用 `ProxyCommand` 指令，会扩展用户名或主机名。如果扩展过程中没有正确转义 shell 元字符，就会导致命令注入。
3.  **执行任意命令：** 攻击者可以通过注入恶意的 shell 命令来执行任意操作系统命令。

例如，攻击者可以在 Git 子模块的 URL 中嵌入恶意代码，当 OpenSSH 克隆该子模块时，会执行该恶意代码。

从搜索引擎的结果来看，该漏洞影响广泛，多个厂商都发布了安全公告，确认了漏洞的存在和危害。

**项目地址:** [endasugrue/CVE-2023-51385_poc](https://github.com/endasugrue/CVE-2023-51385_poc)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #10

**来源**: [CVE-2023-51385-julienbrs_exploit-CVE-2023-51385.md](../2023/CVE-2023-51385-julienbrs_exploit-CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名称或主机名称包含shell元字符，并且该名称在某些情况下被扩展令牌引用。需要能够触发使用了这些名称的SSH操作。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中的一个命令注入漏洞。当用户名或主机名包含shell元字符时，如果这个名字被某些情况下的扩展令牌引用，就可能发生操作系统命令注入。例如，一个不受信任的 Git 仓库可能有一个子模块，其用户名或主机名中包含 shell 元字符。利用方式是构造包含恶意 shell 元字符的用户名或主机名，并触发 OpenSSH 使用该名称的操作，例如通过包含恶意子模块的 Git 仓库。提供的POC代码只是一个README.md文件，不包含任何可执行代码，因此，不存在投毒风险。

**有效性：** 提供的POC代码只是一个README文件，本身不具备漏洞利用能力，因此本身提供的POC无效，需要结合其他方式触发。但是漏洞本身是存在的，搜索结果表明该漏洞存在并且可以利用。

**投毒风险：** 提供的 POC 代码仅包含一个 README.md 文件，没有任何可执行代码，因此不存在投毒风险。

**利用方式：** 漏洞的利用方式是构造包含恶意 shell 元字符的用户名或主机名，然后让 OpenSSH 在处理 SSH 连接或相关操作时引用这些名字。例如，可以通过创建一个包含恶意用户名或主机名的 Git 子模块，然后当用户尝试克隆或更新该 Git 仓库时，触发命令注入。ProxyCommand也是一个常见的攻击点，在ssh config中可以使用ProxyCommand执行任意命令。攻击者可以在用户名或主机名中嵌入恶意命令，这些命令会在 ProxyCommand 被调用时执行。

**项目地址:** [julienbrs/exploit-CVE-2023-51385](https://github.com/julienbrs/exploit-CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #11

**来源**: [CVE-2023-51385-julienbrs_malicious-exploit-CVE-2023-51385.md](../2023/CVE-2023-51385-julienbrs_malicious-exploit-CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含Shell元字符，并且在特定情况下被扩展令牌引用

**POC 可用性:** 是，但提供的POC代码不完整

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中，允许在特定情况下进行操作系统命令注入。如果用户名或主机名包含 Shell 元字符，并且该名称被某些扩展令牌引用，则可能发生此漏洞。例如，不受信任的 Git 存储库可能具有一个子模块，其用户名或主机名中包含 shell 元字符。提供的漏洞利用代码只是一个 README 文件，本身不包含任何利用逻辑。因此，实际利用还需要构造恶意用户名/主机名并通过特定的 OpenSSH 功能（如 ProxyCommand）触发命令注入。

**有效性：** 提供的POC代码 (README.md) 本身无效，仅为占位符，不具备漏洞利用能力。需要结合漏洞描述构造特定的利用场景才能触发漏洞。

**投毒风险：** 由于提供的代码仅仅是 README 文件，所以认为存在投毒代码的可能性较低，但是不排除作者在其他未提供的代码中隐藏恶意Payload，因此投毒风险评估为 10%。

**利用方式：** 漏洞利用方式如下：
1.  攻击者需要控制包含恶意 Shell 元字符的用户名或主机名。
2.  攻击者诱使用户使用受影响的 OpenSSH 版本连接到恶意服务器或克隆包含恶意配置的Git仓库，触发包含shell元字符的用户名或主机名被引用。
3.  OpenSSH 在处理这些包含 Shell 元字符的名称时，由于不正确的转义或过滤，导致命令注入。
4.  攻击者可以在目标系统上执行任意命令。

**项目地址:** [julienbrs/malicious-exploit-CVE-2023-51385](https://github.com/julienbrs/malicious-exploit-CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #12

**来源**: [CVE-2023-51385-power1314520_CVE-2023-51385_test.md](../2023/CVE-2023-51385-power1314520_CVE-2023-51385_test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要受害者克隆包含恶意.gitmodules文件的Git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。漏洞的根本原因是OpenSSH在处理用户名或主机名中的shell元字符时存在缺陷，当这些名称被扩展令牌引用时，可能导致命令注入。

**漏洞利用方式：**
1.  **利用场景:** 攻击者可以通过创建一个包含恶意`.gitmodules`文件的Git仓库来利用此漏洞。`.gitmodules` 文件用于定义Git子模块的配置信息。
2.  **攻击步骤:**
    *   攻击者创建一个恶意Git仓库，其中包含一个`.gitmodules`文件，该文件在`url`字段中嵌入恶意命令，例如：
        ```
        url = ssh://`echo helloworld > cve.txt`foo.example.com/bar
        ```
    *   攻击者诱使受害者克隆该恶意Git仓库，并且使用`--recurse-submodules`参数。该参数指示Git同时克隆仓库及其子模块。
    *   当Git处理`.gitmodules`文件时，会执行`url`字段中的命令，导致命令注入。
3.  **利用前提条件:**
    *   受害者使用OpenSSH 9.6之前的版本。
    *   受害者的SSH客户端配置了`ProxyCommand`，并且存在可利用的扩展令牌。
    *   受害者克隆了包含恶意`.gitmodules`文件的Git仓库，并且使用了`--recurse-submodules`参数。

**有效性评估：**
根据提供的漏洞信息和POC代码，此漏洞的利用是有效的。POC代码演示了如何通过在`.gitmodules`文件的`url`字段中嵌入恶意命令来实现命令注入。当受害者克隆包含此文件的Git仓库时，恶意命令会被执行。

**投毒风险评估：**
虽然提供的POC代码本身是为了验证漏洞而编写的，但仍存在一定投毒风险。攻击者可能在POC代码中添加额外的恶意代码，例如：

*   **收集用户信息：** 在命令注入的payload中添加收集受害者系统信息的代码，例如用户名、操作系统版本等，并将这些信息发送到攻击者的服务器。
*   **安装后门：** 在受害者系统中安装后门程序，以便攻击者可以长期控制受害者系统。
*   **传播恶意软件：** 利用受害者系统作为跳板，进一步传播恶意软件。

然而，根据提供的POC代码来看，并没有发现明显的恶意行为，只是验证了命令注入。但是，如果攻击者公开分享了修改后的POC，投毒风险就会增大。因此，综合考虑，投毒风险评估为10%。原因是poc本身功能较为简单，且开源，容易被审核。

**项目地址:** [power1314520/CVE-2023-51385_test](https://github.com/power1314520/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #13

**来源**: [CVE-2023-51385-runooovb_CVE-2023-51385test.md](../2023/CVE-2023-51385-runooovb_CVE-2023-51385test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统存在受影响版本的OpenSSH，且攻击者能够控制用户名或主机名中使用的某些字符（通常通过Git子模块等方式）。

**POC 可用性:** 部分。提供的README.md只是描述，需要构造特定的用户名/主机名利用。

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。如果用户名或主机名包含shell元字符，并且该名称在某些情况下被扩展令牌引用，则可能发生操作系统命令注入。例如，不受信任的Git存储库可能包含一个子模块，该子模块在用户名或主机名中具有shell元字符。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**
提供的POC代码（README.md文件）本身不构成一个完整的PoC。它只是对漏洞的描述。完整的利用需要攻击者能够控制用户名或主机名，并在其中插入恶意的shell元字符。

**投毒风险：**
提供的代码仓库（只有README.md）投毒的可能性较低，但是不排除作者在其他相关代码中包含恶意payload的可能。考虑到只有README.md,所以投毒风险较低,评估为10%。

**利用方式：**
1.  **控制用户名/主机名：** 攻击者需要找到一种方法来控制OpenSSH客户端使用的用户名或主机名。这可能通过以下方式实现：
    *   **恶意的Git子模块：**  创建一个包含恶意子模块的Git仓库。该子模块的URL可能包含带有shell元字符的用户名或主机名。
    *   **其他配置：**  在其他OpenSSH配置文件（例如`~/.ssh/config`）中，如果可以控制Host字段,也可以插入恶意字符
2.  **触发漏洞：** 当OpenSSH客户端尝试连接到恶意主机或处理包含恶意子模块的仓库时，它会展开用户名/主机名中的shell元字符，从而导致命令注入。
3.  **执行任意命令：** 攻击者可以通过注入的命令在目标系统上执行任意代码。

综上所述，该漏洞利用需要一定的条件，但如果成功利用，则风险极高。

**项目地址:** [runooovb/CVE-2023-51385test](https://github.com/runooovb/CVE-2023-51385test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #14

**来源**: [CVE-2023-51385-selecthch_CVE-2023-51385.md](../2023/CVE-2023-51385-selecthch_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用受影响的OpenSSH版本，并且攻击者可以控制用户名或主机名中的shell元字符。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符并且这些名称在某些情况下被扩展标记引用时，可能会发生操作系统命令注入。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞是有效的，允许远程攻击者执行任意操作系统命令。

**投毒风险：**

提供的 POC 代码包含一个 `.gitmodules` 格式的文件，该文件定义了一个名为 "cves" 的子模块，该子模块的 URL 包含命令 `gnome-calculator`。当 `git submodule update --init --recursive` 被执行时，`gnome-calculator`命令就会被执行。这可能存在投毒风险。如果攻击者将恶意命令嵌入到子模块 URL 中，当用户克隆包含此子模块的恶意仓库并尝试初始化和更新子模块时，就会执行这些命令。风险评估为10%，主要是因为这个POC比较明显，容易被发现，且`gnome-calculator`本身无恶意，如果替换成更隐蔽的恶意命令，投毒性会更高。

**利用方式：**

1.  攻击者创建一个恶意的 Git 仓库，并在 `.gitmodules` 文件中，将子模块的 URL 设置为包含 shell 元字符和恶意命令的字符串。
2.  受害者克隆该恶意 Git 仓库。
3.  受害者执行 `git submodule update --init --recursive` 命令以初始化和更新子模块。
4.  由于 URL 中的 shell 元字符未被正确转义，OpenSSH 将执行 URL 中的恶意命令，导致远程代码执行。

**项目地址:** [selecthch/CVE-2023-51385](https://github.com/selecthch/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #15

**来源**: [CVE-2023-51385-thinkliving2020_CVE-2023-51385-.md](../2023/CVE-2023-51385-thinkliving2020_CVE-2023-51385-.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 受害者需要使用存在漏洞的OpenSSH版本，并连接到包含恶意配置的Git仓库子模块或者其他存在恶意用户名/主机名的配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 漏洞存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符时，如果这些名称被特定的扩展令牌引用，可能导致操作系统命令注入。例如，一个不受信任的 Git 仓库的子模块可能在用户名或主机名中包含 shell 元字符。 

**有效性:** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在并且影响 OpenSSH 9.6 之前的版本。提供的 POC 代码利用了 `~/.ssh/config` 文件中的 `ProxyCommand` 指令，通过在主机名中使用 shell 元字符来执行任意命令。通过`git clone --recurse-submodules`下载包含恶意配置的子模块，即可触发漏洞。 

**投毒风险:** 该POC提供了一个通过恶意配置子模块触发计算器弹出的例子，帮助用户验证该漏洞，提高安全意识。但是，如果攻击者修改了 `~/.ssh/config` 文件或通过其他方式将恶意的用户名/主机名注入到配置中，就有可能执行任意命令，造成安全风险。因此，虽然POC本身是为了演示漏洞，但也存在被滥用的可能。 投毒风险评估为10%，主要考虑攻击者可能在公开的漏洞利用代码中添加恶意代码，诱导用户执行，但是该POC主要依赖配置文件的恶意构造，直接添加恶意代码到POC文件中的可能性较低。

**利用方式:**  利用方式主要通过以下步骤：
1.  攻击者创建一个包含恶意子模块的Git仓库，该子模块的用户名或主机名包含shell元字符。
2.  受害者克隆该仓库，并使用 `--recurse-submodules` 参数初始化子模块。
3.  当 OpenSSH 使用 `ProxyCommand` 指令处理包含恶意元字符的用户名或主机名时，会执行攻击者构造的恶意命令。

另一种利用方式是攻击者诱导受害者在`~/.ssh/config`中添加包含恶意shell元字符的配置信息，当ssh连接目标主机时触发该配置，执行恶意命令。


**项目地址:** [thinkliving2020/CVE-2023-51385-](https://github.com/thinkliving2020/CVE-2023-51385-)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #16

**来源**: [CVE-2023-51385-vin01_poc-proxycommand-vulnerable.md](../2023/CVE-2023-51385-vin01_poc-proxycommand-vulnerable.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用OpenSSH，且受害者需要clone包含恶意submodule的Git仓库或连接到包含恶意用户名/主机名的SSH服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于OpenSSH 9.6之前的版本中。该漏洞允许攻击者通过在用户名或主机名中注入shell元字符来执行任意操作系统命令。当 OpenSSH 在某些情况下扩展令牌时，如果用户名或主机名包含shell元字符，则可能发生OS命令注入。

**有效性：** 提供的POC代码显示了一种利用`ProxyCommand`配置项中`%h`和`%p`等令牌的方式，当这些令牌引用的主机名或用户名包含shell元字符时，可能导致命令注入。POC通过一个包含恶意子模块的Git仓库进行演示，攻击者可以诱使用户clone该仓库，从而触发漏洞。

**投毒风险：**  POC仓库本身的主要目的是演示漏洞，但存在一定投毒风险。  风险点在于Submodule的地址可被篡改，从而指向包含更恶意代码的仓库。Readme中包含执行`git clone`的命令，引导用户执行恶意操作。虽然当前POC只是弹出一个计算器，但攻击者可以替换Submodule指向的仓库，加入其他恶意代码，例如植入后门、窃取信息等。风险评估为10%，主要考虑因素是POC的主要目的是演示漏洞，并非大规模恶意攻击，但存在被二次利用的风险。  

**利用方式：**

1.  **恶意Git仓库：** 攻击者创建一个包含恶意子模块的Git仓库。子模块的URL包含带有shell元字符的用户名或主机名。
2.  **诱导受害者：** 攻击者诱导受害者克隆该Git仓库，可以使用`git clone --recurse-submodules`命令。
3.  **触发漏洞：** 当git clone子模块时，OpenSSH会解析`.ssh/config` 文件，如果文件中存在`ProxyCommand`等配置项，并且使用了受影响的令牌（如 `%h`、`%p`），则会导致命令注入。
4.  **命令执行：** 注入的shell元字符会被执行，从而允许攻击者在受害者系统上执行任意命令。 

**缓解措施：**
*   升级到OpenSSH 9.6或更高版本。
*   避免在用户名或主机名中使用shell元字符。
*   仔细审查`.ssh/config`文件，特别是 `ProxyCommand` 配置项。
*   谨慎克隆来自不可信来源的Git仓库。

**项目地址:** [vin01/poc-proxycommand-vulnerable](https://github.com/vin01/poc-proxycommand-vulnerable)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #17

**来源**: [CVE-2023-51385-watarium_poc-cve-2023-51385.md](../2023/CVE-2023-51385-watarium_poc-cve-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用OpenSSH，且用户名或主机名包含shell元字符并被某些扩展令牌引用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 漏洞存在于OpenSSH 9.6版本之前，允许攻击者通过在用户名或主机名中注入shell元字符，并在特定情况下被扩展令牌引用时，执行任意操作系统命令。例如，恶意Git仓库的子模块可以在用户名或主机名中包含shell元字符。提供的POC代码 `poc-cve-2023-51385`  仅包含一个 `README.md` 文件，内容简单，仅为标题，说明poc是存在的，但是这个简单的poc没有展示任何攻击代码，这意味着需要其他方式来利用此漏洞。该漏洞的利用方式主要通过以下步骤：1.  攻击者构造包含恶意shell元字符的用户名或主机名。2.  攻击者诱使用户连接到包含恶意用户名或主机名的系统。3.  OpenSSH处理连接时，如果相关配置（例如 `ProxyCommand`）使用了扩展令牌引用该用户名或主机名，则会执行注入的shell命令。根据搜索结果，此漏洞已经公开，并且多个厂商发布了安全公告。虽然提供的POC很简单，但该漏洞的严重性不容忽视。投毒风险评估：由于 POC 代码非常简单，只包含一个 README 文件，因此直接投毒的可能性较低。但是，后续利用该漏洞的Payload可能存在投毒风险，例如，利用该漏洞在目标机器上安装恶意软件或后门。考虑到POC代码的简洁性，以及漏洞本身的性质，估计该仓库存在作者隐藏的投毒代码的可能性较低，约为10%。

**项目地址:** [watarium/poc-cve-2023-51385](https://github.com/watarium/poc-cve-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---



---

## POC #9

**来源**: [CVE-2023-51385-endasugrue_CVE-2023-51385_poc.md](../2023/CVE-2023-51385-endasugrue_CVE-2023-51385_poc.md)

## CVE-2023-51385 OpenSSH 命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含shell元字符，且在特定情况下被扩展令牌引用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中存在的一个命令注入漏洞。当用户名或主机名包含 shell 元字符，并且该名称在某些情况下被扩展令牌引用时，可能发生操作系统命令注入。例如，不受信任的 Git 仓库可能具有子模块，其用户名或主机名中包含 shell 元字符。 

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的利用涉及到shell元字符的注入。提供的 POC 代码非常简短，仅包含一个 README.md 文件，指示该项目旨在提供漏洞的概念验证。因此，该POC本身并不能直接验证漏洞，需要结合其他方式例如vin01.github.io/piptagole/ssh/security/openssh/libssh/remote-code-execution/2023/12/20/openssh-proxycommand-libssh-rce.html 中的信息来构造完整的利用链.可以确认漏洞可以利用。

**投毒风险：**

当前提供的 POC 代码（README.md）不包含任何可执行代码，因此直接的投毒风险很低。但是，如果攻击者修改或替换了该 POC，添加了恶意代码，则存在投毒风险。因为该漏洞涉及到命令执行，后门代码可能隐藏在被注入的命令中，实现持久化控制。

**利用方式：**

1.  **构造恶意用户名或主机名：** 攻击者需要创建一个包含 shell 元字符的用户名或主机名。
2.  **触发扩展令牌引用：** 在某些 OpenSSH 配置中，例如使用 `ProxyCommand` 指令，会扩展用户名或主机名。如果扩展过程中没有正确转义 shell 元字符，就会导致命令注入。
3.  **执行任意命令：** 攻击者可以通过注入恶意的 shell 命令来执行任意操作系统命令。

例如，攻击者可以在 Git 子模块的 URL 中嵌入恶意代码，当 OpenSSH 克隆该子模块时，会执行该恶意代码。

从搜索引擎的结果来看，该漏洞影响广泛，多个厂商都发布了安全公告，确认了漏洞的存在和危害。

**项目地址:** [endasugrue/CVE-2023-51385_poc](https://github.com/endasugrue/CVE-2023-51385_poc)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #10

**来源**: [CVE-2023-51385-julienbrs_exploit-CVE-2023-51385.md](../2023/CVE-2023-51385-julienbrs_exploit-CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名称或主机名称包含shell元字符，并且该名称在某些情况下被扩展令牌引用。需要能够触发使用了这些名称的SSH操作。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中的一个命令注入漏洞。当用户名或主机名包含shell元字符时，如果这个名字被某些情况下的扩展令牌引用，就可能发生操作系统命令注入。例如，一个不受信任的 Git 仓库可能有一个子模块，其用户名或主机名中包含 shell 元字符。利用方式是构造包含恶意 shell 元字符的用户名或主机名，并触发 OpenSSH 使用该名称的操作，例如通过包含恶意子模块的 Git 仓库。提供的POC代码只是一个README.md文件，不包含任何可执行代码，因此，不存在投毒风险。

**有效性：** 提供的POC代码只是一个README文件，本身不具备漏洞利用能力，因此本身提供的POC无效，需要结合其他方式触发。但是漏洞本身是存在的，搜索结果表明该漏洞存在并且可以利用。

**投毒风险：** 提供的 POC 代码仅包含一个 README.md 文件，没有任何可执行代码，因此不存在投毒风险。

**利用方式：** 漏洞的利用方式是构造包含恶意 shell 元字符的用户名或主机名，然后让 OpenSSH 在处理 SSH 连接或相关操作时引用这些名字。例如，可以通过创建一个包含恶意用户名或主机名的 Git 子模块，然后当用户尝试克隆或更新该 Git 仓库时，触发命令注入。ProxyCommand也是一个常见的攻击点，在ssh config中可以使用ProxyCommand执行任意命令。攻击者可以在用户名或主机名中嵌入恶意命令，这些命令会在 ProxyCommand 被调用时执行。

**项目地址:** [julienbrs/exploit-CVE-2023-51385](https://github.com/julienbrs/exploit-CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #11

**来源**: [CVE-2023-51385-julienbrs_malicious-exploit-CVE-2023-51385.md](../2023/CVE-2023-51385-julienbrs_malicious-exploit-CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含Shell元字符，并且在特定情况下被扩展令牌引用

**POC 可用性:** 是，但提供的POC代码不完整

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中，允许在特定情况下进行操作系统命令注入。如果用户名或主机名包含 Shell 元字符，并且该名称被某些扩展令牌引用，则可能发生此漏洞。例如，不受信任的 Git 存储库可能具有一个子模块，其用户名或主机名中包含 shell 元字符。提供的漏洞利用代码只是一个 README 文件，本身不包含任何利用逻辑。因此，实际利用还需要构造恶意用户名/主机名并通过特定的 OpenSSH 功能（如 ProxyCommand）触发命令注入。

**有效性：** 提供的POC代码 (README.md) 本身无效，仅为占位符，不具备漏洞利用能力。需要结合漏洞描述构造特定的利用场景才能触发漏洞。

**投毒风险：** 由于提供的代码仅仅是 README 文件，所以认为存在投毒代码的可能性较低，但是不排除作者在其他未提供的代码中隐藏恶意Payload，因此投毒风险评估为 10%。

**利用方式：** 漏洞利用方式如下：
1.  攻击者需要控制包含恶意 Shell 元字符的用户名或主机名。
2.  攻击者诱使用户使用受影响的 OpenSSH 版本连接到恶意服务器或克隆包含恶意配置的Git仓库，触发包含shell元字符的用户名或主机名被引用。
3.  OpenSSH 在处理这些包含 Shell 元字符的名称时，由于不正确的转义或过滤，导致命令注入。
4.  攻击者可以在目标系统上执行任意命令。

**项目地址:** [julienbrs/malicious-exploit-CVE-2023-51385](https://github.com/julienbrs/malicious-exploit-CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #12

**来源**: [CVE-2023-51385-power1314520_CVE-2023-51385_test.md](../2023/CVE-2023-51385-power1314520_CVE-2023-51385_test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要受害者克隆包含恶意.gitmodules文件的Git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。漏洞的根本原因是OpenSSH在处理用户名或主机名中的shell元字符时存在缺陷，当这些名称被扩展令牌引用时，可能导致命令注入。

**漏洞利用方式：**
1.  **利用场景:** 攻击者可以通过创建一个包含恶意`.gitmodules`文件的Git仓库来利用此漏洞。`.gitmodules` 文件用于定义Git子模块的配置信息。
2.  **攻击步骤:**
    *   攻击者创建一个恶意Git仓库，其中包含一个`.gitmodules`文件，该文件在`url`字段中嵌入恶意命令，例如：
        ```
        url = ssh://`echo helloworld > cve.txt`foo.example.com/bar
        ```
    *   攻击者诱使受害者克隆该恶意Git仓库，并且使用`--recurse-submodules`参数。该参数指示Git同时克隆仓库及其子模块。
    *   当Git处理`.gitmodules`文件时，会执行`url`字段中的命令，导致命令注入。
3.  **利用前提条件:**
    *   受害者使用OpenSSH 9.6之前的版本。
    *   受害者的SSH客户端配置了`ProxyCommand`，并且存在可利用的扩展令牌。
    *   受害者克隆了包含恶意`.gitmodules`文件的Git仓库，并且使用了`--recurse-submodules`参数。

**有效性评估：**
根据提供的漏洞信息和POC代码，此漏洞的利用是有效的。POC代码演示了如何通过在`.gitmodules`文件的`url`字段中嵌入恶意命令来实现命令注入。当受害者克隆包含此文件的Git仓库时，恶意命令会被执行。

**投毒风险评估：**
虽然提供的POC代码本身是为了验证漏洞而编写的，但仍存在一定投毒风险。攻击者可能在POC代码中添加额外的恶意代码，例如：

*   **收集用户信息：** 在命令注入的payload中添加收集受害者系统信息的代码，例如用户名、操作系统版本等，并将这些信息发送到攻击者的服务器。
*   **安装后门：** 在受害者系统中安装后门程序，以便攻击者可以长期控制受害者系统。
*   **传播恶意软件：** 利用受害者系统作为跳板，进一步传播恶意软件。

然而，根据提供的POC代码来看，并没有发现明显的恶意行为，只是验证了命令注入。但是，如果攻击者公开分享了修改后的POC，投毒风险就会增大。因此，综合考虑，投毒风险评估为10%。原因是poc本身功能较为简单，且开源，容易被审核。

**项目地址:** [power1314520/CVE-2023-51385_test](https://github.com/power1314520/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #13

**来源**: [CVE-2023-51385-runooovb_CVE-2023-51385test.md](../2023/CVE-2023-51385-runooovb_CVE-2023-51385test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统存在受影响版本的OpenSSH，且攻击者能够控制用户名或主机名中使用的某些字符（通常通过Git子模块等方式）。

**POC 可用性:** 部分。提供的README.md只是描述，需要构造特定的用户名/主机名利用。

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。如果用户名或主机名包含shell元字符，并且该名称在某些情况下被扩展令牌引用，则可能发生操作系统命令注入。例如，不受信任的Git存储库可能包含一个子模块，该子模块在用户名或主机名中具有shell元字符。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**
提供的POC代码（README.md文件）本身不构成一个完整的PoC。它只是对漏洞的描述。完整的利用需要攻击者能够控制用户名或主机名，并在其中插入恶意的shell元字符。

**投毒风险：**
提供的代码仓库（只有README.md）投毒的可能性较低，但是不排除作者在其他相关代码中包含恶意payload的可能。考虑到只有README.md,所以投毒风险较低,评估为10%。

**利用方式：**
1.  **控制用户名/主机名：** 攻击者需要找到一种方法来控制OpenSSH客户端使用的用户名或主机名。这可能通过以下方式实现：
    *   **恶意的Git子模块：**  创建一个包含恶意子模块的Git仓库。该子模块的URL可能包含带有shell元字符的用户名或主机名。
    *   **其他配置：**  在其他OpenSSH配置文件（例如`~/.ssh/config`）中，如果可以控制Host字段,也可以插入恶意字符
2.  **触发漏洞：** 当OpenSSH客户端尝试连接到恶意主机或处理包含恶意子模块的仓库时，它会展开用户名/主机名中的shell元字符，从而导致命令注入。
3.  **执行任意命令：** 攻击者可以通过注入的命令在目标系统上执行任意代码。

综上所述，该漏洞利用需要一定的条件，但如果成功利用，则风险极高。

**项目地址:** [runooovb/CVE-2023-51385test](https://github.com/runooovb/CVE-2023-51385test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #14

**来源**: [CVE-2023-51385-selecthch_CVE-2023-51385.md](../2023/CVE-2023-51385-selecthch_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用受影响的OpenSSH版本，并且攻击者可以控制用户名或主机名中的shell元字符。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符并且这些名称在某些情况下被扩展标记引用时，可能会发生操作系统命令注入。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞是有效的，允许远程攻击者执行任意操作系统命令。

**投毒风险：**

提供的 POC 代码包含一个 `.gitmodules` 格式的文件，该文件定义了一个名为 "cves" 的子模块，该子模块的 URL 包含命令 `gnome-calculator`。当 `git submodule update --init --recursive` 被执行时，`gnome-calculator`命令就会被执行。这可能存在投毒风险。如果攻击者将恶意命令嵌入到子模块 URL 中，当用户克隆包含此子模块的恶意仓库并尝试初始化和更新子模块时，就会执行这些命令。风险评估为10%，主要是因为这个POC比较明显，容易被发现，且`gnome-calculator`本身无恶意，如果替换成更隐蔽的恶意命令，投毒性会更高。

**利用方式：**

1.  攻击者创建一个恶意的 Git 仓库，并在 `.gitmodules` 文件中，将子模块的 URL 设置为包含 shell 元字符和恶意命令的字符串。
2.  受害者克隆该恶意 Git 仓库。
3.  受害者执行 `git submodule update --init --recursive` 命令以初始化和更新子模块。
4.  由于 URL 中的 shell 元字符未被正确转义，OpenSSH 将执行 URL 中的恶意命令，导致远程代码执行。

**项目地址:** [selecthch/CVE-2023-51385](https://github.com/selecthch/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #15

**来源**: [CVE-2023-51385-thinkliving2020_CVE-2023-51385-.md](../2023/CVE-2023-51385-thinkliving2020_CVE-2023-51385-.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 受害者需要使用存在漏洞的OpenSSH版本，并连接到包含恶意配置的Git仓库子模块或者其他存在恶意用户名/主机名的配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 漏洞存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符时，如果这些名称被特定的扩展令牌引用，可能导致操作系统命令注入。例如，一个不受信任的 Git 仓库的子模块可能在用户名或主机名中包含 shell 元字符。 

**有效性:** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在并且影响 OpenSSH 9.6 之前的版本。提供的 POC 代码利用了 `~/.ssh/config` 文件中的 `ProxyCommand` 指令，通过在主机名中使用 shell 元字符来执行任意命令。通过`git clone --recurse-submodules`下载包含恶意配置的子模块，即可触发漏洞。 

**投毒风险:** 该POC提供了一个通过恶意配置子模块触发计算器弹出的例子，帮助用户验证该漏洞，提高安全意识。但是，如果攻击者修改了 `~/.ssh/config` 文件或通过其他方式将恶意的用户名/主机名注入到配置中，就有可能执行任意命令，造成安全风险。因此，虽然POC本身是为了演示漏洞，但也存在被滥用的可能。 投毒风险评估为10%，主要考虑攻击者可能在公开的漏洞利用代码中添加恶意代码，诱导用户执行，但是该POC主要依赖配置文件的恶意构造，直接添加恶意代码到POC文件中的可能性较低。

**利用方式:**  利用方式主要通过以下步骤：
1.  攻击者创建一个包含恶意子模块的Git仓库，该子模块的用户名或主机名包含shell元字符。
2.  受害者克隆该仓库，并使用 `--recurse-submodules` 参数初始化子模块。
3.  当 OpenSSH 使用 `ProxyCommand` 指令处理包含恶意元字符的用户名或主机名时，会执行攻击者构造的恶意命令。

另一种利用方式是攻击者诱导受害者在`~/.ssh/config`中添加包含恶意shell元字符的配置信息，当ssh连接目标主机时触发该配置，执行恶意命令。


**项目地址:** [thinkliving2020/CVE-2023-51385-](https://github.com/thinkliving2020/CVE-2023-51385-)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #16

**来源**: [CVE-2023-51385-vin01_poc-proxycommand-vulnerable.md](../2023/CVE-2023-51385-vin01_poc-proxycommand-vulnerable.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用OpenSSH，且受害者需要clone包含恶意submodule的Git仓库或连接到包含恶意用户名/主机名的SSH服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于OpenSSH 9.6之前的版本中。该漏洞允许攻击者通过在用户名或主机名中注入shell元字符来执行任意操作系统命令。当 OpenSSH 在某些情况下扩展令牌时，如果用户名或主机名包含shell元字符，则可能发生OS命令注入。

**有效性：** 提供的POC代码显示了一种利用`ProxyCommand`配置项中`%h`和`%p`等令牌的方式，当这些令牌引用的主机名或用户名包含shell元字符时，可能导致命令注入。POC通过一个包含恶意子模块的Git仓库进行演示，攻击者可以诱使用户clone该仓库，从而触发漏洞。

**投毒风险：**  POC仓库本身的主要目的是演示漏洞，但存在一定投毒风险。  风险点在于Submodule的地址可被篡改，从而指向包含更恶意代码的仓库。Readme中包含执行`git clone`的命令，引导用户执行恶意操作。虽然当前POC只是弹出一个计算器，但攻击者可以替换Submodule指向的仓库，加入其他恶意代码，例如植入后门、窃取信息等。风险评估为10%，主要考虑因素是POC的主要目的是演示漏洞，并非大规模恶意攻击，但存在被二次利用的风险。  

**利用方式：**

1.  **恶意Git仓库：** 攻击者创建一个包含恶意子模块的Git仓库。子模块的URL包含带有shell元字符的用户名或主机名。
2.  **诱导受害者：** 攻击者诱导受害者克隆该Git仓库，可以使用`git clone --recurse-submodules`命令。
3.  **触发漏洞：** 当git clone子模块时，OpenSSH会解析`.ssh/config` 文件，如果文件中存在`ProxyCommand`等配置项，并且使用了受影响的令牌（如 `%h`、`%p`），则会导致命令注入。
4.  **命令执行：** 注入的shell元字符会被执行，从而允许攻击者在受害者系统上执行任意命令。 

**缓解措施：**
*   升级到OpenSSH 9.6或更高版本。
*   避免在用户名或主机名中使用shell元字符。
*   仔细审查`.ssh/config`文件，特别是 `ProxyCommand` 配置项。
*   谨慎克隆来自不可信来源的Git仓库。

**项目地址:** [vin01/poc-proxycommand-vulnerable](https://github.com/vin01/poc-proxycommand-vulnerable)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #17

**来源**: [CVE-2023-51385-watarium_poc-cve-2023-51385.md](../2023/CVE-2023-51385-watarium_poc-cve-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用OpenSSH，且用户名或主机名包含shell元字符并被某些扩展令牌引用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 漏洞存在于OpenSSH 9.6版本之前，允许攻击者通过在用户名或主机名中注入shell元字符，并在特定情况下被扩展令牌引用时，执行任意操作系统命令。例如，恶意Git仓库的子模块可以在用户名或主机名中包含shell元字符。提供的POC代码 `poc-cve-2023-51385`  仅包含一个 `README.md` 文件，内容简单，仅为标题，说明poc是存在的，但是这个简单的poc没有展示任何攻击代码，这意味着需要其他方式来利用此漏洞。该漏洞的利用方式主要通过以下步骤：1.  攻击者构造包含恶意shell元字符的用户名或主机名。2.  攻击者诱使用户连接到包含恶意用户名或主机名的系统。3.  OpenSSH处理连接时，如果相关配置（例如 `ProxyCommand`）使用了扩展令牌引用该用户名或主机名，则会执行注入的shell命令。根据搜索结果，此漏洞已经公开，并且多个厂商发布了安全公告。虽然提供的POC很简单，但该漏洞的严重性不容忽视。投毒风险评估：由于 POC 代码非常简单，只包含一个 README 文件，因此直接投毒的可能性较低。但是，后续利用该漏洞的Payload可能存在投毒风险，例如，利用该漏洞在目标机器上安装恶意软件或后门。考虑到POC代码的简洁性，以及漏洞本身的性质，估计该仓库存在作者隐藏的投毒代码的可能性较低，约为10%。

**项目地址:** [watarium/poc-cve-2023-51385](https://github.com/watarium/poc-cve-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---



---

## POC #9

**来源**: [CVE-2023-51385-endasugrue_CVE-2023-51385_poc.md](../2023/CVE-2023-51385-endasugrue_CVE-2023-51385_poc.md)

## CVE-2023-51385 OpenSSH 命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含shell元字符，且在特定情况下被扩展令牌引用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中存在的一个命令注入漏洞。当用户名或主机名包含 shell 元字符，并且该名称在某些情况下被扩展令牌引用时，可能发生操作系统命令注入。例如，不受信任的 Git 仓库可能具有子模块，其用户名或主机名中包含 shell 元字符。 

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的利用涉及到shell元字符的注入。提供的 POC 代码非常简短，仅包含一个 README.md 文件，指示该项目旨在提供漏洞的概念验证。因此，该POC本身并不能直接验证漏洞，需要结合其他方式例如vin01.github.io/piptagole/ssh/security/openssh/libssh/remote-code-execution/2023/12/20/openssh-proxycommand-libssh-rce.html 中的信息来构造完整的利用链.可以确认漏洞可以利用。

**投毒风险：**

当前提供的 POC 代码（README.md）不包含任何可执行代码，因此直接的投毒风险很低。但是，如果攻击者修改或替换了该 POC，添加了恶意代码，则存在投毒风险。因为该漏洞涉及到命令执行，后门代码可能隐藏在被注入的命令中，实现持久化控制。

**利用方式：**

1.  **构造恶意用户名或主机名：** 攻击者需要创建一个包含 shell 元字符的用户名或主机名。
2.  **触发扩展令牌引用：** 在某些 OpenSSH 配置中，例如使用 `ProxyCommand` 指令，会扩展用户名或主机名。如果扩展过程中没有正确转义 shell 元字符，就会导致命令注入。
3.  **执行任意命令：** 攻击者可以通过注入恶意的 shell 命令来执行任意操作系统命令。

例如，攻击者可以在 Git 子模块的 URL 中嵌入恶意代码，当 OpenSSH 克隆该子模块时，会执行该恶意代码。

从搜索引擎的结果来看，该漏洞影响广泛，多个厂商都发布了安全公告，确认了漏洞的存在和危害。

**项目地址:** [endasugrue/CVE-2023-51385_poc](https://github.com/endasugrue/CVE-2023-51385_poc)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #10

**来源**: [CVE-2023-51385-julienbrs_exploit-CVE-2023-51385.md](../2023/CVE-2023-51385-julienbrs_exploit-CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名称或主机名称包含shell元字符，并且该名称在某些情况下被扩展令牌引用。需要能够触发使用了这些名称的SSH操作。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中的一个命令注入漏洞。当用户名或主机名包含shell元字符时，如果这个名字被某些情况下的扩展令牌引用，就可能发生操作系统命令注入。例如，一个不受信任的 Git 仓库可能有一个子模块，其用户名或主机名中包含 shell 元字符。利用方式是构造包含恶意 shell 元字符的用户名或主机名，并触发 OpenSSH 使用该名称的操作，例如通过包含恶意子模块的 Git 仓库。提供的POC代码只是一个README.md文件，不包含任何可执行代码，因此，不存在投毒风险。

**有效性：** 提供的POC代码只是一个README文件，本身不具备漏洞利用能力，因此本身提供的POC无效，需要结合其他方式触发。但是漏洞本身是存在的，搜索结果表明该漏洞存在并且可以利用。

**投毒风险：** 提供的 POC 代码仅包含一个 README.md 文件，没有任何可执行代码，因此不存在投毒风险。

**利用方式：** 漏洞的利用方式是构造包含恶意 shell 元字符的用户名或主机名，然后让 OpenSSH 在处理 SSH 连接或相关操作时引用这些名字。例如，可以通过创建一个包含恶意用户名或主机名的 Git 子模块，然后当用户尝试克隆或更新该 Git 仓库时，触发命令注入。ProxyCommand也是一个常见的攻击点，在ssh config中可以使用ProxyCommand执行任意命令。攻击者可以在用户名或主机名中嵌入恶意命令，这些命令会在 ProxyCommand 被调用时执行。

**项目地址:** [julienbrs/exploit-CVE-2023-51385](https://github.com/julienbrs/exploit-CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #11

**来源**: [CVE-2023-51385-julienbrs_malicious-exploit-CVE-2023-51385.md](../2023/CVE-2023-51385-julienbrs_malicious-exploit-CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含Shell元字符，并且在特定情况下被扩展令牌引用

**POC 可用性:** 是，但提供的POC代码不完整

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中，允许在特定情况下进行操作系统命令注入。如果用户名或主机名包含 Shell 元字符，并且该名称被某些扩展令牌引用，则可能发生此漏洞。例如，不受信任的 Git 存储库可能具有一个子模块，其用户名或主机名中包含 shell 元字符。提供的漏洞利用代码只是一个 README 文件，本身不包含任何利用逻辑。因此，实际利用还需要构造恶意用户名/主机名并通过特定的 OpenSSH 功能（如 ProxyCommand）触发命令注入。

**有效性：** 提供的POC代码 (README.md) 本身无效，仅为占位符，不具备漏洞利用能力。需要结合漏洞描述构造特定的利用场景才能触发漏洞。

**投毒风险：** 由于提供的代码仅仅是 README 文件，所以认为存在投毒代码的可能性较低，但是不排除作者在其他未提供的代码中隐藏恶意Payload，因此投毒风险评估为 10%。

**利用方式：** 漏洞利用方式如下：
1.  攻击者需要控制包含恶意 Shell 元字符的用户名或主机名。
2.  攻击者诱使用户使用受影响的 OpenSSH 版本连接到恶意服务器或克隆包含恶意配置的Git仓库，触发包含shell元字符的用户名或主机名被引用。
3.  OpenSSH 在处理这些包含 Shell 元字符的名称时，由于不正确的转义或过滤，导致命令注入。
4.  攻击者可以在目标系统上执行任意命令。

**项目地址:** [julienbrs/malicious-exploit-CVE-2023-51385](https://github.com/julienbrs/malicious-exploit-CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #12

**来源**: [CVE-2023-51385-power1314520_CVE-2023-51385_test.md](../2023/CVE-2023-51385-power1314520_CVE-2023-51385_test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要受害者克隆包含恶意.gitmodules文件的Git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。漏洞的根本原因是OpenSSH在处理用户名或主机名中的shell元字符时存在缺陷，当这些名称被扩展令牌引用时，可能导致命令注入。

**漏洞利用方式：**
1.  **利用场景:** 攻击者可以通过创建一个包含恶意`.gitmodules`文件的Git仓库来利用此漏洞。`.gitmodules` 文件用于定义Git子模块的配置信息。
2.  **攻击步骤:**
    *   攻击者创建一个恶意Git仓库，其中包含一个`.gitmodules`文件，该文件在`url`字段中嵌入恶意命令，例如：
        ```
        url = ssh://`echo helloworld > cve.txt`foo.example.com/bar
        ```
    *   攻击者诱使受害者克隆该恶意Git仓库，并且使用`--recurse-submodules`参数。该参数指示Git同时克隆仓库及其子模块。
    *   当Git处理`.gitmodules`文件时，会执行`url`字段中的命令，导致命令注入。
3.  **利用前提条件:**
    *   受害者使用OpenSSH 9.6之前的版本。
    *   受害者的SSH客户端配置了`ProxyCommand`，并且存在可利用的扩展令牌。
    *   受害者克隆了包含恶意`.gitmodules`文件的Git仓库，并且使用了`--recurse-submodules`参数。

**有效性评估：**
根据提供的漏洞信息和POC代码，此漏洞的利用是有效的。POC代码演示了如何通过在`.gitmodules`文件的`url`字段中嵌入恶意命令来实现命令注入。当受害者克隆包含此文件的Git仓库时，恶意命令会被执行。

**投毒风险评估：**
虽然提供的POC代码本身是为了验证漏洞而编写的，但仍存在一定投毒风险。攻击者可能在POC代码中添加额外的恶意代码，例如：

*   **收集用户信息：** 在命令注入的payload中添加收集受害者系统信息的代码，例如用户名、操作系统版本等，并将这些信息发送到攻击者的服务器。
*   **安装后门：** 在受害者系统中安装后门程序，以便攻击者可以长期控制受害者系统。
*   **传播恶意软件：** 利用受害者系统作为跳板，进一步传播恶意软件。

然而，根据提供的POC代码来看，并没有发现明显的恶意行为，只是验证了命令注入。但是，如果攻击者公开分享了修改后的POC，投毒风险就会增大。因此，综合考虑，投毒风险评估为10%。原因是poc本身功能较为简单，且开源，容易被审核。

**项目地址:** [power1314520/CVE-2023-51385_test](https://github.com/power1314520/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #13

**来源**: [CVE-2023-51385-runooovb_CVE-2023-51385test.md](../2023/CVE-2023-51385-runooovb_CVE-2023-51385test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统存在受影响版本的OpenSSH，且攻击者能够控制用户名或主机名中使用的某些字符（通常通过Git子模块等方式）。

**POC 可用性:** 部分。提供的README.md只是描述，需要构造特定的用户名/主机名利用。

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。如果用户名或主机名包含shell元字符，并且该名称在某些情况下被扩展令牌引用，则可能发生操作系统命令注入。例如，不受信任的Git存储库可能包含一个子模块，该子模块在用户名或主机名中具有shell元字符。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**
提供的POC代码（README.md文件）本身不构成一个完整的PoC。它只是对漏洞的描述。完整的利用需要攻击者能够控制用户名或主机名，并在其中插入恶意的shell元字符。

**投毒风险：**
提供的代码仓库（只有README.md）投毒的可能性较低，但是不排除作者在其他相关代码中包含恶意payload的可能。考虑到只有README.md,所以投毒风险较低,评估为10%。

**利用方式：**
1.  **控制用户名/主机名：** 攻击者需要找到一种方法来控制OpenSSH客户端使用的用户名或主机名。这可能通过以下方式实现：
    *   **恶意的Git子模块：**  创建一个包含恶意子模块的Git仓库。该子模块的URL可能包含带有shell元字符的用户名或主机名。
    *   **其他配置：**  在其他OpenSSH配置文件（例如`~/.ssh/config`）中，如果可以控制Host字段,也可以插入恶意字符
2.  **触发漏洞：** 当OpenSSH客户端尝试连接到恶意主机或处理包含恶意子模块的仓库时，它会展开用户名/主机名中的shell元字符，从而导致命令注入。
3.  **执行任意命令：** 攻击者可以通过注入的命令在目标系统上执行任意代码。

综上所述，该漏洞利用需要一定的条件，但如果成功利用，则风险极高。

**项目地址:** [runooovb/CVE-2023-51385test](https://github.com/runooovb/CVE-2023-51385test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #14

**来源**: [CVE-2023-51385-selecthch_CVE-2023-51385.md](../2023/CVE-2023-51385-selecthch_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用受影响的OpenSSH版本，并且攻击者可以控制用户名或主机名中的shell元字符。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符并且这些名称在某些情况下被扩展标记引用时，可能会发生操作系统命令注入。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞是有效的，允许远程攻击者执行任意操作系统命令。

**投毒风险：**

提供的 POC 代码包含一个 `.gitmodules` 格式的文件，该文件定义了一个名为 "cves" 的子模块，该子模块的 URL 包含命令 `gnome-calculator`。当 `git submodule update --init --recursive` 被执行时，`gnome-calculator`命令就会被执行。这可能存在投毒风险。如果攻击者将恶意命令嵌入到子模块 URL 中，当用户克隆包含此子模块的恶意仓库并尝试初始化和更新子模块时，就会执行这些命令。风险评估为10%，主要是因为这个POC比较明显，容易被发现，且`gnome-calculator`本身无恶意，如果替换成更隐蔽的恶意命令，投毒性会更高。

**利用方式：**

1.  攻击者创建一个恶意的 Git 仓库，并在 `.gitmodules` 文件中，将子模块的 URL 设置为包含 shell 元字符和恶意命令的字符串。
2.  受害者克隆该恶意 Git 仓库。
3.  受害者执行 `git submodule update --init --recursive` 命令以初始化和更新子模块。
4.  由于 URL 中的 shell 元字符未被正确转义，OpenSSH 将执行 URL 中的恶意命令，导致远程代码执行。

**项目地址:** [selecthch/CVE-2023-51385](https://github.com/selecthch/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #15

**来源**: [CVE-2023-51385-thinkliving2020_CVE-2023-51385-.md](../2023/CVE-2023-51385-thinkliving2020_CVE-2023-51385-.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 受害者需要使用存在漏洞的OpenSSH版本，并连接到包含恶意配置的Git仓库子模块或者其他存在恶意用户名/主机名的配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 漏洞存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符时，如果这些名称被特定的扩展令牌引用，可能导致操作系统命令注入。例如，一个不受信任的 Git 仓库的子模块可能在用户名或主机名中包含 shell 元字符。 

**有效性:** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在并且影响 OpenSSH 9.6 之前的版本。提供的 POC 代码利用了 `~/.ssh/config` 文件中的 `ProxyCommand` 指令，通过在主机名中使用 shell 元字符来执行任意命令。通过`git clone --recurse-submodules`下载包含恶意配置的子模块，即可触发漏洞。 

**投毒风险:** 该POC提供了一个通过恶意配置子模块触发计算器弹出的例子，帮助用户验证该漏洞，提高安全意识。但是，如果攻击者修改了 `~/.ssh/config` 文件或通过其他方式将恶意的用户名/主机名注入到配置中，就有可能执行任意命令，造成安全风险。因此，虽然POC本身是为了演示漏洞，但也存在被滥用的可能。 投毒风险评估为10%，主要考虑攻击者可能在公开的漏洞利用代码中添加恶意代码，诱导用户执行，但是该POC主要依赖配置文件的恶意构造，直接添加恶意代码到POC文件中的可能性较低。

**利用方式:**  利用方式主要通过以下步骤：
1.  攻击者创建一个包含恶意子模块的Git仓库，该子模块的用户名或主机名包含shell元字符。
2.  受害者克隆该仓库，并使用 `--recurse-submodules` 参数初始化子模块。
3.  当 OpenSSH 使用 `ProxyCommand` 指令处理包含恶意元字符的用户名或主机名时，会执行攻击者构造的恶意命令。

另一种利用方式是攻击者诱导受害者在`~/.ssh/config`中添加包含恶意shell元字符的配置信息，当ssh连接目标主机时触发该配置，执行恶意命令。


**项目地址:** [thinkliving2020/CVE-2023-51385-](https://github.com/thinkliving2020/CVE-2023-51385-)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #16

**来源**: [CVE-2023-51385-vin01_poc-proxycommand-vulnerable.md](../2023/CVE-2023-51385-vin01_poc-proxycommand-vulnerable.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用OpenSSH，且受害者需要clone包含恶意submodule的Git仓库或连接到包含恶意用户名/主机名的SSH服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于OpenSSH 9.6之前的版本中。该漏洞允许攻击者通过在用户名或主机名中注入shell元字符来执行任意操作系统命令。当 OpenSSH 在某些情况下扩展令牌时，如果用户名或主机名包含shell元字符，则可能发生OS命令注入。

**有效性：** 提供的POC代码显示了一种利用`ProxyCommand`配置项中`%h`和`%p`等令牌的方式，当这些令牌引用的主机名或用户名包含shell元字符时，可能导致命令注入。POC通过一个包含恶意子模块的Git仓库进行演示，攻击者可以诱使用户clone该仓库，从而触发漏洞。

**投毒风险：**  POC仓库本身的主要目的是演示漏洞，但存在一定投毒风险。  风险点在于Submodule的地址可被篡改，从而指向包含更恶意代码的仓库。Readme中包含执行`git clone`的命令，引导用户执行恶意操作。虽然当前POC只是弹出一个计算器，但攻击者可以替换Submodule指向的仓库，加入其他恶意代码，例如植入后门、窃取信息等。风险评估为10%，主要考虑因素是POC的主要目的是演示漏洞，并非大规模恶意攻击，但存在被二次利用的风险。  

**利用方式：**

1.  **恶意Git仓库：** 攻击者创建一个包含恶意子模块的Git仓库。子模块的URL包含带有shell元字符的用户名或主机名。
2.  **诱导受害者：** 攻击者诱导受害者克隆该Git仓库，可以使用`git clone --recurse-submodules`命令。
3.  **触发漏洞：** 当git clone子模块时，OpenSSH会解析`.ssh/config` 文件，如果文件中存在`ProxyCommand`等配置项，并且使用了受影响的令牌（如 `%h`、`%p`），则会导致命令注入。
4.  **命令执行：** 注入的shell元字符会被执行，从而允许攻击者在受害者系统上执行任意命令。 

**缓解措施：**
*   升级到OpenSSH 9.6或更高版本。
*   避免在用户名或主机名中使用shell元字符。
*   仔细审查`.ssh/config`文件，特别是 `ProxyCommand` 配置项。
*   谨慎克隆来自不可信来源的Git仓库。

**项目地址:** [vin01/poc-proxycommand-vulnerable](https://github.com/vin01/poc-proxycommand-vulnerable)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #17

**来源**: [CVE-2023-51385-watarium_poc-cve-2023-51385.md](../2023/CVE-2023-51385-watarium_poc-cve-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用OpenSSH，且用户名或主机名包含shell元字符并被某些扩展令牌引用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 漏洞存在于OpenSSH 9.6版本之前，允许攻击者通过在用户名或主机名中注入shell元字符，并在特定情况下被扩展令牌引用时，执行任意操作系统命令。例如，恶意Git仓库的子模块可以在用户名或主机名中包含shell元字符。提供的POC代码 `poc-cve-2023-51385`  仅包含一个 `README.md` 文件，内容简单，仅为标题，说明poc是存在的，但是这个简单的poc没有展示任何攻击代码，这意味着需要其他方式来利用此漏洞。该漏洞的利用方式主要通过以下步骤：1.  攻击者构造包含恶意shell元字符的用户名或主机名。2.  攻击者诱使用户连接到包含恶意用户名或主机名的系统。3.  OpenSSH处理连接时，如果相关配置（例如 `ProxyCommand`）使用了扩展令牌引用该用户名或主机名，则会执行注入的shell命令。根据搜索结果，此漏洞已经公开，并且多个厂商发布了安全公告。虽然提供的POC很简单，但该漏洞的严重性不容忽视。投毒风险评估：由于 POC 代码非常简单，只包含一个 README 文件，因此直接投毒的可能性较低。但是，后续利用该漏洞的Payload可能存在投毒风险，例如，利用该漏洞在目标机器上安装恶意软件或后门。考虑到POC代码的简洁性，以及漏洞本身的性质，估计该仓库存在作者隐藏的投毒代码的可能性较低，约为10%。

**项目地址:** [watarium/poc-cve-2023-51385](https://github.com/watarium/poc-cve-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---



---

## POC #9

**来源**: [CVE-2023-51385-endasugrue_CVE-2023-51385_poc.md](../2023/CVE-2023-51385-endasugrue_CVE-2023-51385_poc.md)

## CVE-2023-51385 OpenSSH 命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含shell元字符，且在特定情况下被扩展令牌引用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中存在的一个命令注入漏洞。当用户名或主机名包含 shell 元字符，并且该名称在某些情况下被扩展令牌引用时，可能发生操作系统命令注入。例如，不受信任的 Git 仓库可能具有子模块，其用户名或主机名中包含 shell 元字符。 

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的利用涉及到shell元字符的注入。提供的 POC 代码非常简短，仅包含一个 README.md 文件，指示该项目旨在提供漏洞的概念验证。因此，该POC本身并不能直接验证漏洞，需要结合其他方式例如vin01.github.io/piptagole/ssh/security/openssh/libssh/remote-code-execution/2023/12/20/openssh-proxycommand-libssh-rce.html 中的信息来构造完整的利用链.可以确认漏洞可以利用。

**投毒风险：**

当前提供的 POC 代码（README.md）不包含任何可执行代码，因此直接的投毒风险很低。但是，如果攻击者修改或替换了该 POC，添加了恶意代码，则存在投毒风险。因为该漏洞涉及到命令执行，后门代码可能隐藏在被注入的命令中，实现持久化控制。

**利用方式：**

1.  **构造恶意用户名或主机名：** 攻击者需要创建一个包含 shell 元字符的用户名或主机名。
2.  **触发扩展令牌引用：** 在某些 OpenSSH 配置中，例如使用 `ProxyCommand` 指令，会扩展用户名或主机名。如果扩展过程中没有正确转义 shell 元字符，就会导致命令注入。
3.  **执行任意命令：** 攻击者可以通过注入恶意的 shell 命令来执行任意操作系统命令。

例如，攻击者可以在 Git 子模块的 URL 中嵌入恶意代码，当 OpenSSH 克隆该子模块时，会执行该恶意代码。

从搜索引擎的结果来看，该漏洞影响广泛，多个厂商都发布了安全公告，确认了漏洞的存在和危害。

**项目地址:** [endasugrue/CVE-2023-51385_poc](https://github.com/endasugrue/CVE-2023-51385_poc)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #10

**来源**: [CVE-2023-51385-julienbrs_exploit-CVE-2023-51385.md](../2023/CVE-2023-51385-julienbrs_exploit-CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名称或主机名称包含shell元字符，并且该名称在某些情况下被扩展令牌引用。需要能够触发使用了这些名称的SSH操作。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中的一个命令注入漏洞。当用户名或主机名包含shell元字符时，如果这个名字被某些情况下的扩展令牌引用，就可能发生操作系统命令注入。例如，一个不受信任的 Git 仓库可能有一个子模块，其用户名或主机名中包含 shell 元字符。利用方式是构造包含恶意 shell 元字符的用户名或主机名，并触发 OpenSSH 使用该名称的操作，例如通过包含恶意子模块的 Git 仓库。提供的POC代码只是一个README.md文件，不包含任何可执行代码，因此，不存在投毒风险。

**有效性：** 提供的POC代码只是一个README文件，本身不具备漏洞利用能力，因此本身提供的POC无效，需要结合其他方式触发。但是漏洞本身是存在的，搜索结果表明该漏洞存在并且可以利用。

**投毒风险：** 提供的 POC 代码仅包含一个 README.md 文件，没有任何可执行代码，因此不存在投毒风险。

**利用方式：** 漏洞的利用方式是构造包含恶意 shell 元字符的用户名或主机名，然后让 OpenSSH 在处理 SSH 连接或相关操作时引用这些名字。例如，可以通过创建一个包含恶意用户名或主机名的 Git 子模块，然后当用户尝试克隆或更新该 Git 仓库时，触发命令注入。ProxyCommand也是一个常见的攻击点，在ssh config中可以使用ProxyCommand执行任意命令。攻击者可以在用户名或主机名中嵌入恶意命令，这些命令会在 ProxyCommand 被调用时执行。

**项目地址:** [julienbrs/exploit-CVE-2023-51385](https://github.com/julienbrs/exploit-CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #11

**来源**: [CVE-2023-51385-julienbrs_malicious-exploit-CVE-2023-51385.md](../2023/CVE-2023-51385-julienbrs_malicious-exploit-CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含Shell元字符，并且在特定情况下被扩展令牌引用

**POC 可用性:** 是，但提供的POC代码不完整

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中，允许在特定情况下进行操作系统命令注入。如果用户名或主机名包含 Shell 元字符，并且该名称被某些扩展令牌引用，则可能发生此漏洞。例如，不受信任的 Git 存储库可能具有一个子模块，其用户名或主机名中包含 shell 元字符。提供的漏洞利用代码只是一个 README 文件，本身不包含任何利用逻辑。因此，实际利用还需要构造恶意用户名/主机名并通过特定的 OpenSSH 功能（如 ProxyCommand）触发命令注入。

**有效性：** 提供的POC代码 (README.md) 本身无效，仅为占位符，不具备漏洞利用能力。需要结合漏洞描述构造特定的利用场景才能触发漏洞。

**投毒风险：** 由于提供的代码仅仅是 README 文件，所以认为存在投毒代码的可能性较低，但是不排除作者在其他未提供的代码中隐藏恶意Payload，因此投毒风险评估为 10%。

**利用方式：** 漏洞利用方式如下：
1.  攻击者需要控制包含恶意 Shell 元字符的用户名或主机名。
2.  攻击者诱使用户使用受影响的 OpenSSH 版本连接到恶意服务器或克隆包含恶意配置的Git仓库，触发包含shell元字符的用户名或主机名被引用。
3.  OpenSSH 在处理这些包含 Shell 元字符的名称时，由于不正确的转义或过滤，导致命令注入。
4.  攻击者可以在目标系统上执行任意命令。

**项目地址:** [julienbrs/malicious-exploit-CVE-2023-51385](https://github.com/julienbrs/malicious-exploit-CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #12

**来源**: [CVE-2023-51385-power1314520_CVE-2023-51385_test.md](../2023/CVE-2023-51385-power1314520_CVE-2023-51385_test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要受害者克隆包含恶意.gitmodules文件的Git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。漏洞的根本原因是OpenSSH在处理用户名或主机名中的shell元字符时存在缺陷，当这些名称被扩展令牌引用时，可能导致命令注入。

**漏洞利用方式：**
1.  **利用场景:** 攻击者可以通过创建一个包含恶意`.gitmodules`文件的Git仓库来利用此漏洞。`.gitmodules` 文件用于定义Git子模块的配置信息。
2.  **攻击步骤:**
    *   攻击者创建一个恶意Git仓库，其中包含一个`.gitmodules`文件，该文件在`url`字段中嵌入恶意命令，例如：
        ```
        url = ssh://`echo helloworld > cve.txt`foo.example.com/bar
        ```
    *   攻击者诱使受害者克隆该恶意Git仓库，并且使用`--recurse-submodules`参数。该参数指示Git同时克隆仓库及其子模块。
    *   当Git处理`.gitmodules`文件时，会执行`url`字段中的命令，导致命令注入。
3.  **利用前提条件:**
    *   受害者使用OpenSSH 9.6之前的版本。
    *   受害者的SSH客户端配置了`ProxyCommand`，并且存在可利用的扩展令牌。
    *   受害者克隆了包含恶意`.gitmodules`文件的Git仓库，并且使用了`--recurse-submodules`参数。

**有效性评估：**
根据提供的漏洞信息和POC代码，此漏洞的利用是有效的。POC代码演示了如何通过在`.gitmodules`文件的`url`字段中嵌入恶意命令来实现命令注入。当受害者克隆包含此文件的Git仓库时，恶意命令会被执行。

**投毒风险评估：**
虽然提供的POC代码本身是为了验证漏洞而编写的，但仍存在一定投毒风险。攻击者可能在POC代码中添加额外的恶意代码，例如：

*   **收集用户信息：** 在命令注入的payload中添加收集受害者系统信息的代码，例如用户名、操作系统版本等，并将这些信息发送到攻击者的服务器。
*   **安装后门：** 在受害者系统中安装后门程序，以便攻击者可以长期控制受害者系统。
*   **传播恶意软件：** 利用受害者系统作为跳板，进一步传播恶意软件。

然而，根据提供的POC代码来看，并没有发现明显的恶意行为，只是验证了命令注入。但是，如果攻击者公开分享了修改后的POC，投毒风险就会增大。因此，综合考虑，投毒风险评估为10%。原因是poc本身功能较为简单，且开源，容易被审核。

**项目地址:** [power1314520/CVE-2023-51385_test](https://github.com/power1314520/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #13

**来源**: [CVE-2023-51385-runooovb_CVE-2023-51385test.md](../2023/CVE-2023-51385-runooovb_CVE-2023-51385test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统存在受影响版本的OpenSSH，且攻击者能够控制用户名或主机名中使用的某些字符（通常通过Git子模块等方式）。

**POC 可用性:** 部分。提供的README.md只是描述，需要构造特定的用户名/主机名利用。

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。如果用户名或主机名包含shell元字符，并且该名称在某些情况下被扩展令牌引用，则可能发生操作系统命令注入。例如，不受信任的Git存储库可能包含一个子模块，该子模块在用户名或主机名中具有shell元字符。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**
提供的POC代码（README.md文件）本身不构成一个完整的PoC。它只是对漏洞的描述。完整的利用需要攻击者能够控制用户名或主机名，并在其中插入恶意的shell元字符。

**投毒风险：**
提供的代码仓库（只有README.md）投毒的可能性较低，但是不排除作者在其他相关代码中包含恶意payload的可能。考虑到只有README.md,所以投毒风险较低,评估为10%。

**利用方式：**
1.  **控制用户名/主机名：** 攻击者需要找到一种方法来控制OpenSSH客户端使用的用户名或主机名。这可能通过以下方式实现：
    *   **恶意的Git子模块：**  创建一个包含恶意子模块的Git仓库。该子模块的URL可能包含带有shell元字符的用户名或主机名。
    *   **其他配置：**  在其他OpenSSH配置文件（例如`~/.ssh/config`）中，如果可以控制Host字段,也可以插入恶意字符
2.  **触发漏洞：** 当OpenSSH客户端尝试连接到恶意主机或处理包含恶意子模块的仓库时，它会展开用户名/主机名中的shell元字符，从而导致命令注入。
3.  **执行任意命令：** 攻击者可以通过注入的命令在目标系统上执行任意代码。

综上所述，该漏洞利用需要一定的条件，但如果成功利用，则风险极高。

**项目地址:** [runooovb/CVE-2023-51385test](https://github.com/runooovb/CVE-2023-51385test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #14

**来源**: [CVE-2023-51385-selecthch_CVE-2023-51385.md](../2023/CVE-2023-51385-selecthch_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用受影响的OpenSSH版本，并且攻击者可以控制用户名或主机名中的shell元字符。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符并且这些名称在某些情况下被扩展标记引用时，可能会发生操作系统命令注入。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞是有效的，允许远程攻击者执行任意操作系统命令。

**投毒风险：**

提供的 POC 代码包含一个 `.gitmodules` 格式的文件，该文件定义了一个名为 "cves" 的子模块，该子模块的 URL 包含命令 `gnome-calculator`。当 `git submodule update --init --recursive` 被执行时，`gnome-calculator`命令就会被执行。这可能存在投毒风险。如果攻击者将恶意命令嵌入到子模块 URL 中，当用户克隆包含此子模块的恶意仓库并尝试初始化和更新子模块时，就会执行这些命令。风险评估为10%，主要是因为这个POC比较明显，容易被发现，且`gnome-calculator`本身无恶意，如果替换成更隐蔽的恶意命令，投毒性会更高。

**利用方式：**

1.  攻击者创建一个恶意的 Git 仓库，并在 `.gitmodules` 文件中，将子模块的 URL 设置为包含 shell 元字符和恶意命令的字符串。
2.  受害者克隆该恶意 Git 仓库。
3.  受害者执行 `git submodule update --init --recursive` 命令以初始化和更新子模块。
4.  由于 URL 中的 shell 元字符未被正确转义，OpenSSH 将执行 URL 中的恶意命令，导致远程代码执行。

**项目地址:** [selecthch/CVE-2023-51385](https://github.com/selecthch/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #15

**来源**: [CVE-2023-51385-thinkliving2020_CVE-2023-51385-.md](../2023/CVE-2023-51385-thinkliving2020_CVE-2023-51385-.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 受害者需要使用存在漏洞的OpenSSH版本，并连接到包含恶意配置的Git仓库子模块或者其他存在恶意用户名/主机名的配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 漏洞存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符时，如果这些名称被特定的扩展令牌引用，可能导致操作系统命令注入。例如，一个不受信任的 Git 仓库的子模块可能在用户名或主机名中包含 shell 元字符。 

**有效性:** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在并且影响 OpenSSH 9.6 之前的版本。提供的 POC 代码利用了 `~/.ssh/config` 文件中的 `ProxyCommand` 指令，通过在主机名中使用 shell 元字符来执行任意命令。通过`git clone --recurse-submodules`下载包含恶意配置的子模块，即可触发漏洞。 

**投毒风险:** 该POC提供了一个通过恶意配置子模块触发计算器弹出的例子，帮助用户验证该漏洞，提高安全意识。但是，如果攻击者修改了 `~/.ssh/config` 文件或通过其他方式将恶意的用户名/主机名注入到配置中，就有可能执行任意命令，造成安全风险。因此，虽然POC本身是为了演示漏洞，但也存在被滥用的可能。 投毒风险评估为10%，主要考虑攻击者可能在公开的漏洞利用代码中添加恶意代码，诱导用户执行，但是该POC主要依赖配置文件的恶意构造，直接添加恶意代码到POC文件中的可能性较低。

**利用方式:**  利用方式主要通过以下步骤：
1.  攻击者创建一个包含恶意子模块的Git仓库，该子模块的用户名或主机名包含shell元字符。
2.  受害者克隆该仓库，并使用 `--recurse-submodules` 参数初始化子模块。
3.  当 OpenSSH 使用 `ProxyCommand` 指令处理包含恶意元字符的用户名或主机名时，会执行攻击者构造的恶意命令。

另一种利用方式是攻击者诱导受害者在`~/.ssh/config`中添加包含恶意shell元字符的配置信息，当ssh连接目标主机时触发该配置，执行恶意命令。


**项目地址:** [thinkliving2020/CVE-2023-51385-](https://github.com/thinkliving2020/CVE-2023-51385-)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #16

**来源**: [CVE-2023-51385-vin01_poc-proxycommand-vulnerable.md](../2023/CVE-2023-51385-vin01_poc-proxycommand-vulnerable.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用OpenSSH，且受害者需要clone包含恶意submodule的Git仓库或连接到包含恶意用户名/主机名的SSH服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于OpenSSH 9.6之前的版本中。该漏洞允许攻击者通过在用户名或主机名中注入shell元字符来执行任意操作系统命令。当 OpenSSH 在某些情况下扩展令牌时，如果用户名或主机名包含shell元字符，则可能发生OS命令注入。

**有效性：** 提供的POC代码显示了一种利用`ProxyCommand`配置项中`%h`和`%p`等令牌的方式，当这些令牌引用的主机名或用户名包含shell元字符时，可能导致命令注入。POC通过一个包含恶意子模块的Git仓库进行演示，攻击者可以诱使用户clone该仓库，从而触发漏洞。

**投毒风险：**  POC仓库本身的主要目的是演示漏洞，但存在一定投毒风险。  风险点在于Submodule的地址可被篡改，从而指向包含更恶意代码的仓库。Readme中包含执行`git clone`的命令，引导用户执行恶意操作。虽然当前POC只是弹出一个计算器，但攻击者可以替换Submodule指向的仓库，加入其他恶意代码，例如植入后门、窃取信息等。风险评估为10%，主要考虑因素是POC的主要目的是演示漏洞，并非大规模恶意攻击，但存在被二次利用的风险。  

**利用方式：**

1.  **恶意Git仓库：** 攻击者创建一个包含恶意子模块的Git仓库。子模块的URL包含带有shell元字符的用户名或主机名。
2.  **诱导受害者：** 攻击者诱导受害者克隆该Git仓库，可以使用`git clone --recurse-submodules`命令。
3.  **触发漏洞：** 当git clone子模块时，OpenSSH会解析`.ssh/config` 文件，如果文件中存在`ProxyCommand`等配置项，并且使用了受影响的令牌（如 `%h`、`%p`），则会导致命令注入。
4.  **命令执行：** 注入的shell元字符会被执行，从而允许攻击者在受害者系统上执行任意命令。 

**缓解措施：**
*   升级到OpenSSH 9.6或更高版本。
*   避免在用户名或主机名中使用shell元字符。
*   仔细审查`.ssh/config`文件，特别是 `ProxyCommand` 配置项。
*   谨慎克隆来自不可信来源的Git仓库。

**项目地址:** [vin01/poc-proxycommand-vulnerable](https://github.com/vin01/poc-proxycommand-vulnerable)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #17

**来源**: [CVE-2023-51385-watarium_poc-cve-2023-51385.md](../2023/CVE-2023-51385-watarium_poc-cve-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用OpenSSH，且用户名或主机名包含shell元字符并被某些扩展令牌引用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 漏洞存在于OpenSSH 9.6版本之前，允许攻击者通过在用户名或主机名中注入shell元字符，并在特定情况下被扩展令牌引用时，执行任意操作系统命令。例如，恶意Git仓库的子模块可以在用户名或主机名中包含shell元字符。提供的POC代码 `poc-cve-2023-51385`  仅包含一个 `README.md` 文件，内容简单，仅为标题，说明poc是存在的，但是这个简单的poc没有展示任何攻击代码，这意味着需要其他方式来利用此漏洞。该漏洞的利用方式主要通过以下步骤：1.  攻击者构造包含恶意shell元字符的用户名或主机名。2.  攻击者诱使用户连接到包含恶意用户名或主机名的系统。3.  OpenSSH处理连接时，如果相关配置（例如 `ProxyCommand`）使用了扩展令牌引用该用户名或主机名，则会执行注入的shell命令。根据搜索结果，此漏洞已经公开，并且多个厂商发布了安全公告。虽然提供的POC很简单，但该漏洞的严重性不容忽视。投毒风险评估：由于 POC 代码非常简单，只包含一个 README 文件，因此直接投毒的可能性较低。但是，后续利用该漏洞的Payload可能存在投毒风险，例如，利用该漏洞在目标机器上安装恶意软件或后门。考虑到POC代码的简洁性，以及漏洞本身的性质，估计该仓库存在作者隐藏的投毒代码的可能性较低，约为10%。

**项目地址:** [watarium/poc-cve-2023-51385](https://github.com/watarium/poc-cve-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---



---

## POC #9

**来源**: [CVE-2023-51385-endasugrue_CVE-2023-51385_poc.md](../2023/CVE-2023-51385-endasugrue_CVE-2023-51385_poc.md)

## CVE-2023-51385 OpenSSH 命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含shell元字符，且在特定情况下被扩展令牌引用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中存在的一个命令注入漏洞。当用户名或主机名包含 shell 元字符，并且该名称在某些情况下被扩展令牌引用时，可能发生操作系统命令注入。例如，不受信任的 Git 仓库可能具有子模块，其用户名或主机名中包含 shell 元字符。 

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的利用涉及到shell元字符的注入。提供的 POC 代码非常简短，仅包含一个 README.md 文件，指示该项目旨在提供漏洞的概念验证。因此，该POC本身并不能直接验证漏洞，需要结合其他方式例如vin01.github.io/piptagole/ssh/security/openssh/libssh/remote-code-execution/2023/12/20/openssh-proxycommand-libssh-rce.html 中的信息来构造完整的利用链.可以确认漏洞可以利用。

**投毒风险：**

当前提供的 POC 代码（README.md）不包含任何可执行代码，因此直接的投毒风险很低。但是，如果攻击者修改或替换了该 POC，添加了恶意代码，则存在投毒风险。因为该漏洞涉及到命令执行，后门代码可能隐藏在被注入的命令中，实现持久化控制。

**利用方式：**

1.  **构造恶意用户名或主机名：** 攻击者需要创建一个包含 shell 元字符的用户名或主机名。
2.  **触发扩展令牌引用：** 在某些 OpenSSH 配置中，例如使用 `ProxyCommand` 指令，会扩展用户名或主机名。如果扩展过程中没有正确转义 shell 元字符，就会导致命令注入。
3.  **执行任意命令：** 攻击者可以通过注入恶意的 shell 命令来执行任意操作系统命令。

例如，攻击者可以在 Git 子模块的 URL 中嵌入恶意代码，当 OpenSSH 克隆该子模块时，会执行该恶意代码。

从搜索引擎的结果来看，该漏洞影响广泛，多个厂商都发布了安全公告，确认了漏洞的存在和危害。

**项目地址:** [endasugrue/CVE-2023-51385_poc](https://github.com/endasugrue/CVE-2023-51385_poc)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #10

**来源**: [CVE-2023-51385-julienbrs_exploit-CVE-2023-51385.md](../2023/CVE-2023-51385-julienbrs_exploit-CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名称或主机名称包含shell元字符，并且该名称在某些情况下被扩展令牌引用。需要能够触发使用了这些名称的SSH操作。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中的一个命令注入漏洞。当用户名或主机名包含shell元字符时，如果这个名字被某些情况下的扩展令牌引用，就可能发生操作系统命令注入。例如，一个不受信任的 Git 仓库可能有一个子模块，其用户名或主机名中包含 shell 元字符。利用方式是构造包含恶意 shell 元字符的用户名或主机名，并触发 OpenSSH 使用该名称的操作，例如通过包含恶意子模块的 Git 仓库。提供的POC代码只是一个README.md文件，不包含任何可执行代码，因此，不存在投毒风险。

**有效性：** 提供的POC代码只是一个README文件，本身不具备漏洞利用能力，因此本身提供的POC无效，需要结合其他方式触发。但是漏洞本身是存在的，搜索结果表明该漏洞存在并且可以利用。

**投毒风险：** 提供的 POC 代码仅包含一个 README.md 文件，没有任何可执行代码，因此不存在投毒风险。

**利用方式：** 漏洞的利用方式是构造包含恶意 shell 元字符的用户名或主机名，然后让 OpenSSH 在处理 SSH 连接或相关操作时引用这些名字。例如，可以通过创建一个包含恶意用户名或主机名的 Git 子模块，然后当用户尝试克隆或更新该 Git 仓库时，触发命令注入。ProxyCommand也是一个常见的攻击点，在ssh config中可以使用ProxyCommand执行任意命令。攻击者可以在用户名或主机名中嵌入恶意命令，这些命令会在 ProxyCommand 被调用时执行。

**项目地址:** [julienbrs/exploit-CVE-2023-51385](https://github.com/julienbrs/exploit-CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #11

**来源**: [CVE-2023-51385-julienbrs_malicious-exploit-CVE-2023-51385.md](../2023/CVE-2023-51385-julienbrs_malicious-exploit-CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含Shell元字符，并且在特定情况下被扩展令牌引用

**POC 可用性:** 是，但提供的POC代码不完整

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中，允许在特定情况下进行操作系统命令注入。如果用户名或主机名包含 Shell 元字符，并且该名称被某些扩展令牌引用，则可能发生此漏洞。例如，不受信任的 Git 存储库可能具有一个子模块，其用户名或主机名中包含 shell 元字符。提供的漏洞利用代码只是一个 README 文件，本身不包含任何利用逻辑。因此，实际利用还需要构造恶意用户名/主机名并通过特定的 OpenSSH 功能（如 ProxyCommand）触发命令注入。

**有效性：** 提供的POC代码 (README.md) 本身无效，仅为占位符，不具备漏洞利用能力。需要结合漏洞描述构造特定的利用场景才能触发漏洞。

**投毒风险：** 由于提供的代码仅仅是 README 文件，所以认为存在投毒代码的可能性较低，但是不排除作者在其他未提供的代码中隐藏恶意Payload，因此投毒风险评估为 10%。

**利用方式：** 漏洞利用方式如下：
1.  攻击者需要控制包含恶意 Shell 元字符的用户名或主机名。
2.  攻击者诱使用户使用受影响的 OpenSSH 版本连接到恶意服务器或克隆包含恶意配置的Git仓库，触发包含shell元字符的用户名或主机名被引用。
3.  OpenSSH 在处理这些包含 Shell 元字符的名称时，由于不正确的转义或过滤，导致命令注入。
4.  攻击者可以在目标系统上执行任意命令。

**项目地址:** [julienbrs/malicious-exploit-CVE-2023-51385](https://github.com/julienbrs/malicious-exploit-CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #12

**来源**: [CVE-2023-51385-power1314520_CVE-2023-51385_test.md](../2023/CVE-2023-51385-power1314520_CVE-2023-51385_test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要受害者克隆包含恶意.gitmodules文件的Git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。漏洞的根本原因是OpenSSH在处理用户名或主机名中的shell元字符时存在缺陷，当这些名称被扩展令牌引用时，可能导致命令注入。

**漏洞利用方式：**
1.  **利用场景:** 攻击者可以通过创建一个包含恶意`.gitmodules`文件的Git仓库来利用此漏洞。`.gitmodules` 文件用于定义Git子模块的配置信息。
2.  **攻击步骤:**
    *   攻击者创建一个恶意Git仓库，其中包含一个`.gitmodules`文件，该文件在`url`字段中嵌入恶意命令，例如：
        ```
        url = ssh://`echo helloworld > cve.txt`foo.example.com/bar
        ```
    *   攻击者诱使受害者克隆该恶意Git仓库，并且使用`--recurse-submodules`参数。该参数指示Git同时克隆仓库及其子模块。
    *   当Git处理`.gitmodules`文件时，会执行`url`字段中的命令，导致命令注入。
3.  **利用前提条件:**
    *   受害者使用OpenSSH 9.6之前的版本。
    *   受害者的SSH客户端配置了`ProxyCommand`，并且存在可利用的扩展令牌。
    *   受害者克隆了包含恶意`.gitmodules`文件的Git仓库，并且使用了`--recurse-submodules`参数。

**有效性评估：**
根据提供的漏洞信息和POC代码，此漏洞的利用是有效的。POC代码演示了如何通过在`.gitmodules`文件的`url`字段中嵌入恶意命令来实现命令注入。当受害者克隆包含此文件的Git仓库时，恶意命令会被执行。

**投毒风险评估：**
虽然提供的POC代码本身是为了验证漏洞而编写的，但仍存在一定投毒风险。攻击者可能在POC代码中添加额外的恶意代码，例如：

*   **收集用户信息：** 在命令注入的payload中添加收集受害者系统信息的代码，例如用户名、操作系统版本等，并将这些信息发送到攻击者的服务器。
*   **安装后门：** 在受害者系统中安装后门程序，以便攻击者可以长期控制受害者系统。
*   **传播恶意软件：** 利用受害者系统作为跳板，进一步传播恶意软件。

然而，根据提供的POC代码来看，并没有发现明显的恶意行为，只是验证了命令注入。但是，如果攻击者公开分享了修改后的POC，投毒风险就会增大。因此，综合考虑，投毒风险评估为10%。原因是poc本身功能较为简单，且开源，容易被审核。

**项目地址:** [power1314520/CVE-2023-51385_test](https://github.com/power1314520/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #13

**来源**: [CVE-2023-51385-runooovb_CVE-2023-51385test.md](../2023/CVE-2023-51385-runooovb_CVE-2023-51385test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统存在受影响版本的OpenSSH，且攻击者能够控制用户名或主机名中使用的某些字符（通常通过Git子模块等方式）。

**POC 可用性:** 部分。提供的README.md只是描述，需要构造特定的用户名/主机名利用。

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。如果用户名或主机名包含shell元字符，并且该名称在某些情况下被扩展令牌引用，则可能发生操作系统命令注入。例如，不受信任的Git存储库可能包含一个子模块，该子模块在用户名或主机名中具有shell元字符。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**
提供的POC代码（README.md文件）本身不构成一个完整的PoC。它只是对漏洞的描述。完整的利用需要攻击者能够控制用户名或主机名，并在其中插入恶意的shell元字符。

**投毒风险：**
提供的代码仓库（只有README.md）投毒的可能性较低，但是不排除作者在其他相关代码中包含恶意payload的可能。考虑到只有README.md,所以投毒风险较低,评估为10%。

**利用方式：**
1.  **控制用户名/主机名：** 攻击者需要找到一种方法来控制OpenSSH客户端使用的用户名或主机名。这可能通过以下方式实现：
    *   **恶意的Git子模块：**  创建一个包含恶意子模块的Git仓库。该子模块的URL可能包含带有shell元字符的用户名或主机名。
    *   **其他配置：**  在其他OpenSSH配置文件（例如`~/.ssh/config`）中，如果可以控制Host字段,也可以插入恶意字符
2.  **触发漏洞：** 当OpenSSH客户端尝试连接到恶意主机或处理包含恶意子模块的仓库时，它会展开用户名/主机名中的shell元字符，从而导致命令注入。
3.  **执行任意命令：** 攻击者可以通过注入的命令在目标系统上执行任意代码。

综上所述，该漏洞利用需要一定的条件，但如果成功利用，则风险极高。

**项目地址:** [runooovb/CVE-2023-51385test](https://github.com/runooovb/CVE-2023-51385test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #14

**来源**: [CVE-2023-51385-selecthch_CVE-2023-51385.md](../2023/CVE-2023-51385-selecthch_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用受影响的OpenSSH版本，并且攻击者可以控制用户名或主机名中的shell元字符。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符并且这些名称在某些情况下被扩展标记引用时，可能会发生操作系统命令注入。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞是有效的，允许远程攻击者执行任意操作系统命令。

**投毒风险：**

提供的 POC 代码包含一个 `.gitmodules` 格式的文件，该文件定义了一个名为 "cves" 的子模块，该子模块的 URL 包含命令 `gnome-calculator`。当 `git submodule update --init --recursive` 被执行时，`gnome-calculator`命令就会被执行。这可能存在投毒风险。如果攻击者将恶意命令嵌入到子模块 URL 中，当用户克隆包含此子模块的恶意仓库并尝试初始化和更新子模块时，就会执行这些命令。风险评估为10%，主要是因为这个POC比较明显，容易被发现，且`gnome-calculator`本身无恶意，如果替换成更隐蔽的恶意命令，投毒性会更高。

**利用方式：**

1.  攻击者创建一个恶意的 Git 仓库，并在 `.gitmodules` 文件中，将子模块的 URL 设置为包含 shell 元字符和恶意命令的字符串。
2.  受害者克隆该恶意 Git 仓库。
3.  受害者执行 `git submodule update --init --recursive` 命令以初始化和更新子模块。
4.  由于 URL 中的 shell 元字符未被正确转义，OpenSSH 将执行 URL 中的恶意命令，导致远程代码执行。

**项目地址:** [selecthch/CVE-2023-51385](https://github.com/selecthch/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #15

**来源**: [CVE-2023-51385-thinkliving2020_CVE-2023-51385-.md](../2023/CVE-2023-51385-thinkliving2020_CVE-2023-51385-.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 受害者需要使用存在漏洞的OpenSSH版本，并连接到包含恶意配置的Git仓库子模块或者其他存在恶意用户名/主机名的配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 漏洞存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符时，如果这些名称被特定的扩展令牌引用，可能导致操作系统命令注入。例如，一个不受信任的 Git 仓库的子模块可能在用户名或主机名中包含 shell 元字符。 

**有效性:** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在并且影响 OpenSSH 9.6 之前的版本。提供的 POC 代码利用了 `~/.ssh/config` 文件中的 `ProxyCommand` 指令，通过在主机名中使用 shell 元字符来执行任意命令。通过`git clone --recurse-submodules`下载包含恶意配置的子模块，即可触发漏洞。 

**投毒风险:** 该POC提供了一个通过恶意配置子模块触发计算器弹出的例子，帮助用户验证该漏洞，提高安全意识。但是，如果攻击者修改了 `~/.ssh/config` 文件或通过其他方式将恶意的用户名/主机名注入到配置中，就有可能执行任意命令，造成安全风险。因此，虽然POC本身是为了演示漏洞，但也存在被滥用的可能。 投毒风险评估为10%，主要考虑攻击者可能在公开的漏洞利用代码中添加恶意代码，诱导用户执行，但是该POC主要依赖配置文件的恶意构造，直接添加恶意代码到POC文件中的可能性较低。

**利用方式:**  利用方式主要通过以下步骤：
1.  攻击者创建一个包含恶意子模块的Git仓库，该子模块的用户名或主机名包含shell元字符。
2.  受害者克隆该仓库，并使用 `--recurse-submodules` 参数初始化子模块。
3.  当 OpenSSH 使用 `ProxyCommand` 指令处理包含恶意元字符的用户名或主机名时，会执行攻击者构造的恶意命令。

另一种利用方式是攻击者诱导受害者在`~/.ssh/config`中添加包含恶意shell元字符的配置信息，当ssh连接目标主机时触发该配置，执行恶意命令。


**项目地址:** [thinkliving2020/CVE-2023-51385-](https://github.com/thinkliving2020/CVE-2023-51385-)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #16

**来源**: [CVE-2023-51385-vin01_poc-proxycommand-vulnerable.md](../2023/CVE-2023-51385-vin01_poc-proxycommand-vulnerable.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用OpenSSH，且受害者需要clone包含恶意submodule的Git仓库或连接到包含恶意用户名/主机名的SSH服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于OpenSSH 9.6之前的版本中。该漏洞允许攻击者通过在用户名或主机名中注入shell元字符来执行任意操作系统命令。当 OpenSSH 在某些情况下扩展令牌时，如果用户名或主机名包含shell元字符，则可能发生OS命令注入。

**有效性：** 提供的POC代码显示了一种利用`ProxyCommand`配置项中`%h`和`%p`等令牌的方式，当这些令牌引用的主机名或用户名包含shell元字符时，可能导致命令注入。POC通过一个包含恶意子模块的Git仓库进行演示，攻击者可以诱使用户clone该仓库，从而触发漏洞。

**投毒风险：**  POC仓库本身的主要目的是演示漏洞，但存在一定投毒风险。  风险点在于Submodule的地址可被篡改，从而指向包含更恶意代码的仓库。Readme中包含执行`git clone`的命令，引导用户执行恶意操作。虽然当前POC只是弹出一个计算器，但攻击者可以替换Submodule指向的仓库，加入其他恶意代码，例如植入后门、窃取信息等。风险评估为10%，主要考虑因素是POC的主要目的是演示漏洞，并非大规模恶意攻击，但存在被二次利用的风险。  

**利用方式：**

1.  **恶意Git仓库：** 攻击者创建一个包含恶意子模块的Git仓库。子模块的URL包含带有shell元字符的用户名或主机名。
2.  **诱导受害者：** 攻击者诱导受害者克隆该Git仓库，可以使用`git clone --recurse-submodules`命令。
3.  **触发漏洞：** 当git clone子模块时，OpenSSH会解析`.ssh/config` 文件，如果文件中存在`ProxyCommand`等配置项，并且使用了受影响的令牌（如 `%h`、`%p`），则会导致命令注入。
4.  **命令执行：** 注入的shell元字符会被执行，从而允许攻击者在受害者系统上执行任意命令。 

**缓解措施：**
*   升级到OpenSSH 9.6或更高版本。
*   避免在用户名或主机名中使用shell元字符。
*   仔细审查`.ssh/config`文件，特别是 `ProxyCommand` 配置项。
*   谨慎克隆来自不可信来源的Git仓库。

**项目地址:** [vin01/poc-proxycommand-vulnerable](https://github.com/vin01/poc-proxycommand-vulnerable)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #17

**来源**: [CVE-2023-51385-watarium_poc-cve-2023-51385.md](../2023/CVE-2023-51385-watarium_poc-cve-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用OpenSSH，且用户名或主机名包含shell元字符并被某些扩展令牌引用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 漏洞存在于OpenSSH 9.6版本之前，允许攻击者通过在用户名或主机名中注入shell元字符，并在特定情况下被扩展令牌引用时，执行任意操作系统命令。例如，恶意Git仓库的子模块可以在用户名或主机名中包含shell元字符。提供的POC代码 `poc-cve-2023-51385`  仅包含一个 `README.md` 文件，内容简单，仅为标题，说明poc是存在的，但是这个简单的poc没有展示任何攻击代码，这意味着需要其他方式来利用此漏洞。该漏洞的利用方式主要通过以下步骤：1.  攻击者构造包含恶意shell元字符的用户名或主机名。2.  攻击者诱使用户连接到包含恶意用户名或主机名的系统。3.  OpenSSH处理连接时，如果相关配置（例如 `ProxyCommand`）使用了扩展令牌引用该用户名或主机名，则会执行注入的shell命令。根据搜索结果，此漏洞已经公开，并且多个厂商发布了安全公告。虽然提供的POC很简单，但该漏洞的严重性不容忽视。投毒风险评估：由于 POC 代码非常简单，只包含一个 README 文件，因此直接投毒的可能性较低。但是，后续利用该漏洞的Payload可能存在投毒风险，例如，利用该漏洞在目标机器上安装恶意软件或后门。考虑到POC代码的简洁性，以及漏洞本身的性质，估计该仓库存在作者隐藏的投毒代码的可能性较低，约为10%。

**项目地址:** [watarium/poc-cve-2023-51385](https://github.com/watarium/poc-cve-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---



---

## POC #9

**来源**: [CVE-2023-51385-endasugrue_CVE-2023-51385_poc.md](../2023/CVE-2023-51385-endasugrue_CVE-2023-51385_poc.md)

## CVE-2023-51385 OpenSSH 命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含shell元字符，且在特定情况下被扩展令牌引用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中存在的一个命令注入漏洞。当用户名或主机名包含 shell 元字符，并且该名称在某些情况下被扩展令牌引用时，可能发生操作系统命令注入。例如，不受信任的 Git 仓库可能具有子模块，其用户名或主机名中包含 shell 元字符。 

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的利用涉及到shell元字符的注入。提供的 POC 代码非常简短，仅包含一个 README.md 文件，指示该项目旨在提供漏洞的概念验证。因此，该POC本身并不能直接验证漏洞，需要结合其他方式例如vin01.github.io/piptagole/ssh/security/openssh/libssh/remote-code-execution/2023/12/20/openssh-proxycommand-libssh-rce.html 中的信息来构造完整的利用链.可以确认漏洞可以利用。

**投毒风险：**

当前提供的 POC 代码（README.md）不包含任何可执行代码，因此直接的投毒风险很低。但是，如果攻击者修改或替换了该 POC，添加了恶意代码，则存在投毒风险。因为该漏洞涉及到命令执行，后门代码可能隐藏在被注入的命令中，实现持久化控制。

**利用方式：**

1.  **构造恶意用户名或主机名：** 攻击者需要创建一个包含 shell 元字符的用户名或主机名。
2.  **触发扩展令牌引用：** 在某些 OpenSSH 配置中，例如使用 `ProxyCommand` 指令，会扩展用户名或主机名。如果扩展过程中没有正确转义 shell 元字符，就会导致命令注入。
3.  **执行任意命令：** 攻击者可以通过注入恶意的 shell 命令来执行任意操作系统命令。

例如，攻击者可以在 Git 子模块的 URL 中嵌入恶意代码，当 OpenSSH 克隆该子模块时，会执行该恶意代码。

从搜索引擎的结果来看，该漏洞影响广泛，多个厂商都发布了安全公告，确认了漏洞的存在和危害。

**项目地址:** [endasugrue/CVE-2023-51385_poc](https://github.com/endasugrue/CVE-2023-51385_poc)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #10

**来源**: [CVE-2023-51385-julienbrs_exploit-CVE-2023-51385.md](../2023/CVE-2023-51385-julienbrs_exploit-CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名称或主机名称包含shell元字符，并且该名称在某些情况下被扩展令牌引用。需要能够触发使用了这些名称的SSH操作。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中的一个命令注入漏洞。当用户名或主机名包含shell元字符时，如果这个名字被某些情况下的扩展令牌引用，就可能发生操作系统命令注入。例如，一个不受信任的 Git 仓库可能有一个子模块，其用户名或主机名中包含 shell 元字符。利用方式是构造包含恶意 shell 元字符的用户名或主机名，并触发 OpenSSH 使用该名称的操作，例如通过包含恶意子模块的 Git 仓库。提供的POC代码只是一个README.md文件，不包含任何可执行代码，因此，不存在投毒风险。

**有效性：** 提供的POC代码只是一个README文件，本身不具备漏洞利用能力，因此本身提供的POC无效，需要结合其他方式触发。但是漏洞本身是存在的，搜索结果表明该漏洞存在并且可以利用。

**投毒风险：** 提供的 POC 代码仅包含一个 README.md 文件，没有任何可执行代码，因此不存在投毒风险。

**利用方式：** 漏洞的利用方式是构造包含恶意 shell 元字符的用户名或主机名，然后让 OpenSSH 在处理 SSH 连接或相关操作时引用这些名字。例如，可以通过创建一个包含恶意用户名或主机名的 Git 子模块，然后当用户尝试克隆或更新该 Git 仓库时，触发命令注入。ProxyCommand也是一个常见的攻击点，在ssh config中可以使用ProxyCommand执行任意命令。攻击者可以在用户名或主机名中嵌入恶意命令，这些命令会在 ProxyCommand 被调用时执行。

**项目地址:** [julienbrs/exploit-CVE-2023-51385](https://github.com/julienbrs/exploit-CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #11

**来源**: [CVE-2023-51385-julienbrs_malicious-exploit-CVE-2023-51385.md](../2023/CVE-2023-51385-julienbrs_malicious-exploit-CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含Shell元字符，并且在特定情况下被扩展令牌引用

**POC 可用性:** 是，但提供的POC代码不完整

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中，允许在特定情况下进行操作系统命令注入。如果用户名或主机名包含 Shell 元字符，并且该名称被某些扩展令牌引用，则可能发生此漏洞。例如，不受信任的 Git 存储库可能具有一个子模块，其用户名或主机名中包含 shell 元字符。提供的漏洞利用代码只是一个 README 文件，本身不包含任何利用逻辑。因此，实际利用还需要构造恶意用户名/主机名并通过特定的 OpenSSH 功能（如 ProxyCommand）触发命令注入。

**有效性：** 提供的POC代码 (README.md) 本身无效，仅为占位符，不具备漏洞利用能力。需要结合漏洞描述构造特定的利用场景才能触发漏洞。

**投毒风险：** 由于提供的代码仅仅是 README 文件，所以认为存在投毒代码的可能性较低，但是不排除作者在其他未提供的代码中隐藏恶意Payload，因此投毒风险评估为 10%。

**利用方式：** 漏洞利用方式如下：
1.  攻击者需要控制包含恶意 Shell 元字符的用户名或主机名。
2.  攻击者诱使用户使用受影响的 OpenSSH 版本连接到恶意服务器或克隆包含恶意配置的Git仓库，触发包含shell元字符的用户名或主机名被引用。
3.  OpenSSH 在处理这些包含 Shell 元字符的名称时，由于不正确的转义或过滤，导致命令注入。
4.  攻击者可以在目标系统上执行任意命令。

**项目地址:** [julienbrs/malicious-exploit-CVE-2023-51385](https://github.com/julienbrs/malicious-exploit-CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #12

**来源**: [CVE-2023-51385-power1314520_CVE-2023-51385_test.md](../2023/CVE-2023-51385-power1314520_CVE-2023-51385_test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要受害者克隆包含恶意.gitmodules文件的Git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。漏洞的根本原因是OpenSSH在处理用户名或主机名中的shell元字符时存在缺陷，当这些名称被扩展令牌引用时，可能导致命令注入。

**漏洞利用方式：**
1.  **利用场景:** 攻击者可以通过创建一个包含恶意`.gitmodules`文件的Git仓库来利用此漏洞。`.gitmodules` 文件用于定义Git子模块的配置信息。
2.  **攻击步骤:**
    *   攻击者创建一个恶意Git仓库，其中包含一个`.gitmodules`文件，该文件在`url`字段中嵌入恶意命令，例如：
        ```
        url = ssh://`echo helloworld > cve.txt`foo.example.com/bar
        ```
    *   攻击者诱使受害者克隆该恶意Git仓库，并且使用`--recurse-submodules`参数。该参数指示Git同时克隆仓库及其子模块。
    *   当Git处理`.gitmodules`文件时，会执行`url`字段中的命令，导致命令注入。
3.  **利用前提条件:**
    *   受害者使用OpenSSH 9.6之前的版本。
    *   受害者的SSH客户端配置了`ProxyCommand`，并且存在可利用的扩展令牌。
    *   受害者克隆了包含恶意`.gitmodules`文件的Git仓库，并且使用了`--recurse-submodules`参数。

**有效性评估：**
根据提供的漏洞信息和POC代码，此漏洞的利用是有效的。POC代码演示了如何通过在`.gitmodules`文件的`url`字段中嵌入恶意命令来实现命令注入。当受害者克隆包含此文件的Git仓库时，恶意命令会被执行。

**投毒风险评估：**
虽然提供的POC代码本身是为了验证漏洞而编写的，但仍存在一定投毒风险。攻击者可能在POC代码中添加额外的恶意代码，例如：

*   **收集用户信息：** 在命令注入的payload中添加收集受害者系统信息的代码，例如用户名、操作系统版本等，并将这些信息发送到攻击者的服务器。
*   **安装后门：** 在受害者系统中安装后门程序，以便攻击者可以长期控制受害者系统。
*   **传播恶意软件：** 利用受害者系统作为跳板，进一步传播恶意软件。

然而，根据提供的POC代码来看，并没有发现明显的恶意行为，只是验证了命令注入。但是，如果攻击者公开分享了修改后的POC，投毒风险就会增大。因此，综合考虑，投毒风险评估为10%。原因是poc本身功能较为简单，且开源，容易被审核。

**项目地址:** [power1314520/CVE-2023-51385_test](https://github.com/power1314520/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #13

**来源**: [CVE-2023-51385-runooovb_CVE-2023-51385test.md](../2023/CVE-2023-51385-runooovb_CVE-2023-51385test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统存在受影响版本的OpenSSH，且攻击者能够控制用户名或主机名中使用的某些字符（通常通过Git子模块等方式）。

**POC 可用性:** 部分。提供的README.md只是描述，需要构造特定的用户名/主机名利用。

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。如果用户名或主机名包含shell元字符，并且该名称在某些情况下被扩展令牌引用，则可能发生操作系统命令注入。例如，不受信任的Git存储库可能包含一个子模块，该子模块在用户名或主机名中具有shell元字符。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**
提供的POC代码（README.md文件）本身不构成一个完整的PoC。它只是对漏洞的描述。完整的利用需要攻击者能够控制用户名或主机名，并在其中插入恶意的shell元字符。

**投毒风险：**
提供的代码仓库（只有README.md）投毒的可能性较低，但是不排除作者在其他相关代码中包含恶意payload的可能。考虑到只有README.md,所以投毒风险较低,评估为10%。

**利用方式：**
1.  **控制用户名/主机名：** 攻击者需要找到一种方法来控制OpenSSH客户端使用的用户名或主机名。这可能通过以下方式实现：
    *   **恶意的Git子模块：**  创建一个包含恶意子模块的Git仓库。该子模块的URL可能包含带有shell元字符的用户名或主机名。
    *   **其他配置：**  在其他OpenSSH配置文件（例如`~/.ssh/config`）中，如果可以控制Host字段,也可以插入恶意字符
2.  **触发漏洞：** 当OpenSSH客户端尝试连接到恶意主机或处理包含恶意子模块的仓库时，它会展开用户名/主机名中的shell元字符，从而导致命令注入。
3.  **执行任意命令：** 攻击者可以通过注入的命令在目标系统上执行任意代码。

综上所述，该漏洞利用需要一定的条件，但如果成功利用，则风险极高。

**项目地址:** [runooovb/CVE-2023-51385test](https://github.com/runooovb/CVE-2023-51385test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #14

**来源**: [CVE-2023-51385-selecthch_CVE-2023-51385.md](../2023/CVE-2023-51385-selecthch_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用受影响的OpenSSH版本，并且攻击者可以控制用户名或主机名中的shell元字符。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符并且这些名称在某些情况下被扩展标记引用时，可能会发生操作系统命令注入。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞是有效的，允许远程攻击者执行任意操作系统命令。

**投毒风险：**

提供的 POC 代码包含一个 `.gitmodules` 格式的文件，该文件定义了一个名为 "cves" 的子模块，该子模块的 URL 包含命令 `gnome-calculator`。当 `git submodule update --init --recursive` 被执行时，`gnome-calculator`命令就会被执行。这可能存在投毒风险。如果攻击者将恶意命令嵌入到子模块 URL 中，当用户克隆包含此子模块的恶意仓库并尝试初始化和更新子模块时，就会执行这些命令。风险评估为10%，主要是因为这个POC比较明显，容易被发现，且`gnome-calculator`本身无恶意，如果替换成更隐蔽的恶意命令，投毒性会更高。

**利用方式：**

1.  攻击者创建一个恶意的 Git 仓库，并在 `.gitmodules` 文件中，将子模块的 URL 设置为包含 shell 元字符和恶意命令的字符串。
2.  受害者克隆该恶意 Git 仓库。
3.  受害者执行 `git submodule update --init --recursive` 命令以初始化和更新子模块。
4.  由于 URL 中的 shell 元字符未被正确转义，OpenSSH 将执行 URL 中的恶意命令，导致远程代码执行。

**项目地址:** [selecthch/CVE-2023-51385](https://github.com/selecthch/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #15

**来源**: [CVE-2023-51385-thinkliving2020_CVE-2023-51385-.md](../2023/CVE-2023-51385-thinkliving2020_CVE-2023-51385-.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 受害者需要使用存在漏洞的OpenSSH版本，并连接到包含恶意配置的Git仓库子模块或者其他存在恶意用户名/主机名的配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 漏洞存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符时，如果这些名称被特定的扩展令牌引用，可能导致操作系统命令注入。例如，一个不受信任的 Git 仓库的子模块可能在用户名或主机名中包含 shell 元字符。 

**有效性:** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在并且影响 OpenSSH 9.6 之前的版本。提供的 POC 代码利用了 `~/.ssh/config` 文件中的 `ProxyCommand` 指令，通过在主机名中使用 shell 元字符来执行任意命令。通过`git clone --recurse-submodules`下载包含恶意配置的子模块，即可触发漏洞。 

**投毒风险:** 该POC提供了一个通过恶意配置子模块触发计算器弹出的例子，帮助用户验证该漏洞，提高安全意识。但是，如果攻击者修改了 `~/.ssh/config` 文件或通过其他方式将恶意的用户名/主机名注入到配置中，就有可能执行任意命令，造成安全风险。因此，虽然POC本身是为了演示漏洞，但也存在被滥用的可能。 投毒风险评估为10%，主要考虑攻击者可能在公开的漏洞利用代码中添加恶意代码，诱导用户执行，但是该POC主要依赖配置文件的恶意构造，直接添加恶意代码到POC文件中的可能性较低。

**利用方式:**  利用方式主要通过以下步骤：
1.  攻击者创建一个包含恶意子模块的Git仓库，该子模块的用户名或主机名包含shell元字符。
2.  受害者克隆该仓库，并使用 `--recurse-submodules` 参数初始化子模块。
3.  当 OpenSSH 使用 `ProxyCommand` 指令处理包含恶意元字符的用户名或主机名时，会执行攻击者构造的恶意命令。

另一种利用方式是攻击者诱导受害者在`~/.ssh/config`中添加包含恶意shell元字符的配置信息，当ssh连接目标主机时触发该配置，执行恶意命令。


**项目地址:** [thinkliving2020/CVE-2023-51385-](https://github.com/thinkliving2020/CVE-2023-51385-)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #16

**来源**: [CVE-2023-51385-vin01_poc-proxycommand-vulnerable.md](../2023/CVE-2023-51385-vin01_poc-proxycommand-vulnerable.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用OpenSSH，且受害者需要clone包含恶意submodule的Git仓库或连接到包含恶意用户名/主机名的SSH服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于OpenSSH 9.6之前的版本中。该漏洞允许攻击者通过在用户名或主机名中注入shell元字符来执行任意操作系统命令。当 OpenSSH 在某些情况下扩展令牌时，如果用户名或主机名包含shell元字符，则可能发生OS命令注入。

**有效性：** 提供的POC代码显示了一种利用`ProxyCommand`配置项中`%h`和`%p`等令牌的方式，当这些令牌引用的主机名或用户名包含shell元字符时，可能导致命令注入。POC通过一个包含恶意子模块的Git仓库进行演示，攻击者可以诱使用户clone该仓库，从而触发漏洞。

**投毒风险：**  POC仓库本身的主要目的是演示漏洞，但存在一定投毒风险。  风险点在于Submodule的地址可被篡改，从而指向包含更恶意代码的仓库。Readme中包含执行`git clone`的命令，引导用户执行恶意操作。虽然当前POC只是弹出一个计算器，但攻击者可以替换Submodule指向的仓库，加入其他恶意代码，例如植入后门、窃取信息等。风险评估为10%，主要考虑因素是POC的主要目的是演示漏洞，并非大规模恶意攻击，但存在被二次利用的风险。  

**利用方式：**

1.  **恶意Git仓库：** 攻击者创建一个包含恶意子模块的Git仓库。子模块的URL包含带有shell元字符的用户名或主机名。
2.  **诱导受害者：** 攻击者诱导受害者克隆该Git仓库，可以使用`git clone --recurse-submodules`命令。
3.  **触发漏洞：** 当git clone子模块时，OpenSSH会解析`.ssh/config` 文件，如果文件中存在`ProxyCommand`等配置项，并且使用了受影响的令牌（如 `%h`、`%p`），则会导致命令注入。
4.  **命令执行：** 注入的shell元字符会被执行，从而允许攻击者在受害者系统上执行任意命令。 

**缓解措施：**
*   升级到OpenSSH 9.6或更高版本。
*   避免在用户名或主机名中使用shell元字符。
*   仔细审查`.ssh/config`文件，特别是 `ProxyCommand` 配置项。
*   谨慎克隆来自不可信来源的Git仓库。

**项目地址:** [vin01/poc-proxycommand-vulnerable](https://github.com/vin01/poc-proxycommand-vulnerable)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #17

**来源**: [CVE-2023-51385-watarium_poc-cve-2023-51385.md](../2023/CVE-2023-51385-watarium_poc-cve-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用OpenSSH，且用户名或主机名包含shell元字符并被某些扩展令牌引用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 漏洞存在于OpenSSH 9.6版本之前，允许攻击者通过在用户名或主机名中注入shell元字符，并在特定情况下被扩展令牌引用时，执行任意操作系统命令。例如，恶意Git仓库的子模块可以在用户名或主机名中包含shell元字符。提供的POC代码 `poc-cve-2023-51385`  仅包含一个 `README.md` 文件，内容简单，仅为标题，说明poc是存在的，但是这个简单的poc没有展示任何攻击代码，这意味着需要其他方式来利用此漏洞。该漏洞的利用方式主要通过以下步骤：1.  攻击者构造包含恶意shell元字符的用户名或主机名。2.  攻击者诱使用户连接到包含恶意用户名或主机名的系统。3.  OpenSSH处理连接时，如果相关配置（例如 `ProxyCommand`）使用了扩展令牌引用该用户名或主机名，则会执行注入的shell命令。根据搜索结果，此漏洞已经公开，并且多个厂商发布了安全公告。虽然提供的POC很简单，但该漏洞的严重性不容忽视。投毒风险评估：由于 POC 代码非常简单，只包含一个 README 文件，因此直接投毒的可能性较低。但是，后续利用该漏洞的Payload可能存在投毒风险，例如，利用该漏洞在目标机器上安装恶意软件或后门。考虑到POC代码的简洁性，以及漏洞本身的性质，估计该仓库存在作者隐藏的投毒代码的可能性较低，约为10%。

**项目地址:** [watarium/poc-cve-2023-51385](https://github.com/watarium/poc-cve-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---



---

## POC #9

**来源**: [CVE-2023-51385-endasugrue_CVE-2023-51385_poc.md](../2023/CVE-2023-51385-endasugrue_CVE-2023-51385_poc.md)

## CVE-2023-51385 OpenSSH 命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含shell元字符，且在特定情况下被扩展令牌引用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中存在的一个命令注入漏洞。当用户名或主机名包含 shell 元字符，并且该名称在某些情况下被扩展令牌引用时，可能发生操作系统命令注入。例如，不受信任的 Git 仓库可能具有子模块，其用户名或主机名中包含 shell 元字符。 

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的利用涉及到shell元字符的注入。提供的 POC 代码非常简短，仅包含一个 README.md 文件，指示该项目旨在提供漏洞的概念验证。因此，该POC本身并不能直接验证漏洞，需要结合其他方式例如vin01.github.io/piptagole/ssh/security/openssh/libssh/remote-code-execution/2023/12/20/openssh-proxycommand-libssh-rce.html 中的信息来构造完整的利用链.可以确认漏洞可以利用。

**投毒风险：**

当前提供的 POC 代码（README.md）不包含任何可执行代码，因此直接的投毒风险很低。但是，如果攻击者修改或替换了该 POC，添加了恶意代码，则存在投毒风险。因为该漏洞涉及到命令执行，后门代码可能隐藏在被注入的命令中，实现持久化控制。

**利用方式：**

1.  **构造恶意用户名或主机名：** 攻击者需要创建一个包含 shell 元字符的用户名或主机名。
2.  **触发扩展令牌引用：** 在某些 OpenSSH 配置中，例如使用 `ProxyCommand` 指令，会扩展用户名或主机名。如果扩展过程中没有正确转义 shell 元字符，就会导致命令注入。
3.  **执行任意命令：** 攻击者可以通过注入恶意的 shell 命令来执行任意操作系统命令。

例如，攻击者可以在 Git 子模块的 URL 中嵌入恶意代码，当 OpenSSH 克隆该子模块时，会执行该恶意代码。

从搜索引擎的结果来看，该漏洞影响广泛，多个厂商都发布了安全公告，确认了漏洞的存在和危害。

**项目地址:** [endasugrue/CVE-2023-51385_poc](https://github.com/endasugrue/CVE-2023-51385_poc)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #10

**来源**: [CVE-2023-51385-julienbrs_exploit-CVE-2023-51385.md](../2023/CVE-2023-51385-julienbrs_exploit-CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名称或主机名称包含shell元字符，并且该名称在某些情况下被扩展令牌引用。需要能够触发使用了这些名称的SSH操作。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中的一个命令注入漏洞。当用户名或主机名包含shell元字符时，如果这个名字被某些情况下的扩展令牌引用，就可能发生操作系统命令注入。例如，一个不受信任的 Git 仓库可能有一个子模块，其用户名或主机名中包含 shell 元字符。利用方式是构造包含恶意 shell 元字符的用户名或主机名，并触发 OpenSSH 使用该名称的操作，例如通过包含恶意子模块的 Git 仓库。提供的POC代码只是一个README.md文件，不包含任何可执行代码，因此，不存在投毒风险。

**有效性：** 提供的POC代码只是一个README文件，本身不具备漏洞利用能力，因此本身提供的POC无效，需要结合其他方式触发。但是漏洞本身是存在的，搜索结果表明该漏洞存在并且可以利用。

**投毒风险：** 提供的 POC 代码仅包含一个 README.md 文件，没有任何可执行代码，因此不存在投毒风险。

**利用方式：** 漏洞的利用方式是构造包含恶意 shell 元字符的用户名或主机名，然后让 OpenSSH 在处理 SSH 连接或相关操作时引用这些名字。例如，可以通过创建一个包含恶意用户名或主机名的 Git 子模块，然后当用户尝试克隆或更新该 Git 仓库时，触发命令注入。ProxyCommand也是一个常见的攻击点，在ssh config中可以使用ProxyCommand执行任意命令。攻击者可以在用户名或主机名中嵌入恶意命令，这些命令会在 ProxyCommand 被调用时执行。

**项目地址:** [julienbrs/exploit-CVE-2023-51385](https://github.com/julienbrs/exploit-CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #11

**来源**: [CVE-2023-51385-julienbrs_malicious-exploit-CVE-2023-51385.md](../2023/CVE-2023-51385-julienbrs_malicious-exploit-CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含Shell元字符，并且在特定情况下被扩展令牌引用

**POC 可用性:** 是，但提供的POC代码不完整

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中，允许在特定情况下进行操作系统命令注入。如果用户名或主机名包含 Shell 元字符，并且该名称被某些扩展令牌引用，则可能发生此漏洞。例如，不受信任的 Git 存储库可能具有一个子模块，其用户名或主机名中包含 shell 元字符。提供的漏洞利用代码只是一个 README 文件，本身不包含任何利用逻辑。因此，实际利用还需要构造恶意用户名/主机名并通过特定的 OpenSSH 功能（如 ProxyCommand）触发命令注入。

**有效性：** 提供的POC代码 (README.md) 本身无效，仅为占位符，不具备漏洞利用能力。需要结合漏洞描述构造特定的利用场景才能触发漏洞。

**投毒风险：** 由于提供的代码仅仅是 README 文件，所以认为存在投毒代码的可能性较低，但是不排除作者在其他未提供的代码中隐藏恶意Payload，因此投毒风险评估为 10%。

**利用方式：** 漏洞利用方式如下：
1.  攻击者需要控制包含恶意 Shell 元字符的用户名或主机名。
2.  攻击者诱使用户使用受影响的 OpenSSH 版本连接到恶意服务器或克隆包含恶意配置的Git仓库，触发包含shell元字符的用户名或主机名被引用。
3.  OpenSSH 在处理这些包含 Shell 元字符的名称时，由于不正确的转义或过滤，导致命令注入。
4.  攻击者可以在目标系统上执行任意命令。

**项目地址:** [julienbrs/malicious-exploit-CVE-2023-51385](https://github.com/julienbrs/malicious-exploit-CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #12

**来源**: [CVE-2023-51385-power1314520_CVE-2023-51385_test.md](../2023/CVE-2023-51385-power1314520_CVE-2023-51385_test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要受害者克隆包含恶意.gitmodules文件的Git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。漏洞的根本原因是OpenSSH在处理用户名或主机名中的shell元字符时存在缺陷，当这些名称被扩展令牌引用时，可能导致命令注入。

**漏洞利用方式：**
1.  **利用场景:** 攻击者可以通过创建一个包含恶意`.gitmodules`文件的Git仓库来利用此漏洞。`.gitmodules` 文件用于定义Git子模块的配置信息。
2.  **攻击步骤:**
    *   攻击者创建一个恶意Git仓库，其中包含一个`.gitmodules`文件，该文件在`url`字段中嵌入恶意命令，例如：
        ```
        url = ssh://`echo helloworld > cve.txt`foo.example.com/bar
        ```
    *   攻击者诱使受害者克隆该恶意Git仓库，并且使用`--recurse-submodules`参数。该参数指示Git同时克隆仓库及其子模块。
    *   当Git处理`.gitmodules`文件时，会执行`url`字段中的命令，导致命令注入。
3.  **利用前提条件:**
    *   受害者使用OpenSSH 9.6之前的版本。
    *   受害者的SSH客户端配置了`ProxyCommand`，并且存在可利用的扩展令牌。
    *   受害者克隆了包含恶意`.gitmodules`文件的Git仓库，并且使用了`--recurse-submodules`参数。

**有效性评估：**
根据提供的漏洞信息和POC代码，此漏洞的利用是有效的。POC代码演示了如何通过在`.gitmodules`文件的`url`字段中嵌入恶意命令来实现命令注入。当受害者克隆包含此文件的Git仓库时，恶意命令会被执行。

**投毒风险评估：**
虽然提供的POC代码本身是为了验证漏洞而编写的，但仍存在一定投毒风险。攻击者可能在POC代码中添加额外的恶意代码，例如：

*   **收集用户信息：** 在命令注入的payload中添加收集受害者系统信息的代码，例如用户名、操作系统版本等，并将这些信息发送到攻击者的服务器。
*   **安装后门：** 在受害者系统中安装后门程序，以便攻击者可以长期控制受害者系统。
*   **传播恶意软件：** 利用受害者系统作为跳板，进一步传播恶意软件。

然而，根据提供的POC代码来看，并没有发现明显的恶意行为，只是验证了命令注入。但是，如果攻击者公开分享了修改后的POC，投毒风险就会增大。因此，综合考虑，投毒风险评估为10%。原因是poc本身功能较为简单，且开源，容易被审核。

**项目地址:** [power1314520/CVE-2023-51385_test](https://github.com/power1314520/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #13

**来源**: [CVE-2023-51385-runooovb_CVE-2023-51385test.md](../2023/CVE-2023-51385-runooovb_CVE-2023-51385test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统存在受影响版本的OpenSSH，且攻击者能够控制用户名或主机名中使用的某些字符（通常通过Git子模块等方式）。

**POC 可用性:** 部分。提供的README.md只是描述，需要构造特定的用户名/主机名利用。

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。如果用户名或主机名包含shell元字符，并且该名称在某些情况下被扩展令牌引用，则可能发生操作系统命令注入。例如，不受信任的Git存储库可能包含一个子模块，该子模块在用户名或主机名中具有shell元字符。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**
提供的POC代码（README.md文件）本身不构成一个完整的PoC。它只是对漏洞的描述。完整的利用需要攻击者能够控制用户名或主机名，并在其中插入恶意的shell元字符。

**投毒风险：**
提供的代码仓库（只有README.md）投毒的可能性较低，但是不排除作者在其他相关代码中包含恶意payload的可能。考虑到只有README.md,所以投毒风险较低,评估为10%。

**利用方式：**
1.  **控制用户名/主机名：** 攻击者需要找到一种方法来控制OpenSSH客户端使用的用户名或主机名。这可能通过以下方式实现：
    *   **恶意的Git子模块：**  创建一个包含恶意子模块的Git仓库。该子模块的URL可能包含带有shell元字符的用户名或主机名。
    *   **其他配置：**  在其他OpenSSH配置文件（例如`~/.ssh/config`）中，如果可以控制Host字段,也可以插入恶意字符
2.  **触发漏洞：** 当OpenSSH客户端尝试连接到恶意主机或处理包含恶意子模块的仓库时，它会展开用户名/主机名中的shell元字符，从而导致命令注入。
3.  **执行任意命令：** 攻击者可以通过注入的命令在目标系统上执行任意代码。

综上所述，该漏洞利用需要一定的条件，但如果成功利用，则风险极高。

**项目地址:** [runooovb/CVE-2023-51385test](https://github.com/runooovb/CVE-2023-51385test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #14

**来源**: [CVE-2023-51385-selecthch_CVE-2023-51385.md](../2023/CVE-2023-51385-selecthch_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用受影响的OpenSSH版本，并且攻击者可以控制用户名或主机名中的shell元字符。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符并且这些名称在某些情况下被扩展标记引用时，可能会发生操作系统命令注入。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞是有效的，允许远程攻击者执行任意操作系统命令。

**投毒风险：**

提供的 POC 代码包含一个 `.gitmodules` 格式的文件，该文件定义了一个名为 "cves" 的子模块，该子模块的 URL 包含命令 `gnome-calculator`。当 `git submodule update --init --recursive` 被执行时，`gnome-calculator`命令就会被执行。这可能存在投毒风险。如果攻击者将恶意命令嵌入到子模块 URL 中，当用户克隆包含此子模块的恶意仓库并尝试初始化和更新子模块时，就会执行这些命令。风险评估为10%，主要是因为这个POC比较明显，容易被发现，且`gnome-calculator`本身无恶意，如果替换成更隐蔽的恶意命令，投毒性会更高。

**利用方式：**

1.  攻击者创建一个恶意的 Git 仓库，并在 `.gitmodules` 文件中，将子模块的 URL 设置为包含 shell 元字符和恶意命令的字符串。
2.  受害者克隆该恶意 Git 仓库。
3.  受害者执行 `git submodule update --init --recursive` 命令以初始化和更新子模块。
4.  由于 URL 中的 shell 元字符未被正确转义，OpenSSH 将执行 URL 中的恶意命令，导致远程代码执行。

**项目地址:** [selecthch/CVE-2023-51385](https://github.com/selecthch/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #15

**来源**: [CVE-2023-51385-thinkliving2020_CVE-2023-51385-.md](../2023/CVE-2023-51385-thinkliving2020_CVE-2023-51385-.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 受害者需要使用存在漏洞的OpenSSH版本，并连接到包含恶意配置的Git仓库子模块或者其他存在恶意用户名/主机名的配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 漏洞存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符时，如果这些名称被特定的扩展令牌引用，可能导致操作系统命令注入。例如，一个不受信任的 Git 仓库的子模块可能在用户名或主机名中包含 shell 元字符。 

**有效性:** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在并且影响 OpenSSH 9.6 之前的版本。提供的 POC 代码利用了 `~/.ssh/config` 文件中的 `ProxyCommand` 指令，通过在主机名中使用 shell 元字符来执行任意命令。通过`git clone --recurse-submodules`下载包含恶意配置的子模块，即可触发漏洞。 

**投毒风险:** 该POC提供了一个通过恶意配置子模块触发计算器弹出的例子，帮助用户验证该漏洞，提高安全意识。但是，如果攻击者修改了 `~/.ssh/config` 文件或通过其他方式将恶意的用户名/主机名注入到配置中，就有可能执行任意命令，造成安全风险。因此，虽然POC本身是为了演示漏洞，但也存在被滥用的可能。 投毒风险评估为10%，主要考虑攻击者可能在公开的漏洞利用代码中添加恶意代码，诱导用户执行，但是该POC主要依赖配置文件的恶意构造，直接添加恶意代码到POC文件中的可能性较低。

**利用方式:**  利用方式主要通过以下步骤：
1.  攻击者创建一个包含恶意子模块的Git仓库，该子模块的用户名或主机名包含shell元字符。
2.  受害者克隆该仓库，并使用 `--recurse-submodules` 参数初始化子模块。
3.  当 OpenSSH 使用 `ProxyCommand` 指令处理包含恶意元字符的用户名或主机名时，会执行攻击者构造的恶意命令。

另一种利用方式是攻击者诱导受害者在`~/.ssh/config`中添加包含恶意shell元字符的配置信息，当ssh连接目标主机时触发该配置，执行恶意命令。


**项目地址:** [thinkliving2020/CVE-2023-51385-](https://github.com/thinkliving2020/CVE-2023-51385-)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #16

**来源**: [CVE-2023-51385-vin01_poc-proxycommand-vulnerable.md](../2023/CVE-2023-51385-vin01_poc-proxycommand-vulnerable.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用OpenSSH，且受害者需要clone包含恶意submodule的Git仓库或连接到包含恶意用户名/主机名的SSH服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于OpenSSH 9.6之前的版本中。该漏洞允许攻击者通过在用户名或主机名中注入shell元字符来执行任意操作系统命令。当 OpenSSH 在某些情况下扩展令牌时，如果用户名或主机名包含shell元字符，则可能发生OS命令注入。

**有效性：** 提供的POC代码显示了一种利用`ProxyCommand`配置项中`%h`和`%p`等令牌的方式，当这些令牌引用的主机名或用户名包含shell元字符时，可能导致命令注入。POC通过一个包含恶意子模块的Git仓库进行演示，攻击者可以诱使用户clone该仓库，从而触发漏洞。

**投毒风险：**  POC仓库本身的主要目的是演示漏洞，但存在一定投毒风险。  风险点在于Submodule的地址可被篡改，从而指向包含更恶意代码的仓库。Readme中包含执行`git clone`的命令，引导用户执行恶意操作。虽然当前POC只是弹出一个计算器，但攻击者可以替换Submodule指向的仓库，加入其他恶意代码，例如植入后门、窃取信息等。风险评估为10%，主要考虑因素是POC的主要目的是演示漏洞，并非大规模恶意攻击，但存在被二次利用的风险。  

**利用方式：**

1.  **恶意Git仓库：** 攻击者创建一个包含恶意子模块的Git仓库。子模块的URL包含带有shell元字符的用户名或主机名。
2.  **诱导受害者：** 攻击者诱导受害者克隆该Git仓库，可以使用`git clone --recurse-submodules`命令。
3.  **触发漏洞：** 当git clone子模块时，OpenSSH会解析`.ssh/config` 文件，如果文件中存在`ProxyCommand`等配置项，并且使用了受影响的令牌（如 `%h`、`%p`），则会导致命令注入。
4.  **命令执行：** 注入的shell元字符会被执行，从而允许攻击者在受害者系统上执行任意命令。 

**缓解措施：**
*   升级到OpenSSH 9.6或更高版本。
*   避免在用户名或主机名中使用shell元字符。
*   仔细审查`.ssh/config`文件，特别是 `ProxyCommand` 配置项。
*   谨慎克隆来自不可信来源的Git仓库。

**项目地址:** [vin01/poc-proxycommand-vulnerable](https://github.com/vin01/poc-proxycommand-vulnerable)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #17

**来源**: [CVE-2023-51385-watarium_poc-cve-2023-51385.md](../2023/CVE-2023-51385-watarium_poc-cve-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用OpenSSH，且用户名或主机名包含shell元字符并被某些扩展令牌引用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 漏洞存在于OpenSSH 9.6版本之前，允许攻击者通过在用户名或主机名中注入shell元字符，并在特定情况下被扩展令牌引用时，执行任意操作系统命令。例如，恶意Git仓库的子模块可以在用户名或主机名中包含shell元字符。提供的POC代码 `poc-cve-2023-51385`  仅包含一个 `README.md` 文件，内容简单，仅为标题，说明poc是存在的，但是这个简单的poc没有展示任何攻击代码，这意味着需要其他方式来利用此漏洞。该漏洞的利用方式主要通过以下步骤：1.  攻击者构造包含恶意shell元字符的用户名或主机名。2.  攻击者诱使用户连接到包含恶意用户名或主机名的系统。3.  OpenSSH处理连接时，如果相关配置（例如 `ProxyCommand`）使用了扩展令牌引用该用户名或主机名，则会执行注入的shell命令。根据搜索结果，此漏洞已经公开，并且多个厂商发布了安全公告。虽然提供的POC很简单，但该漏洞的严重性不容忽视。投毒风险评估：由于 POC 代码非常简单，只包含一个 README 文件，因此直接投毒的可能性较低。但是，后续利用该漏洞的Payload可能存在投毒风险，例如，利用该漏洞在目标机器上安装恶意软件或后门。考虑到POC代码的简洁性，以及漏洞本身的性质，估计该仓库存在作者隐藏的投毒代码的可能性较低，约为10%。

**项目地址:** [watarium/poc-cve-2023-51385](https://github.com/watarium/poc-cve-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---



---

## POC #9

**来源**: [CVE-2023-51385-endasugrue_CVE-2023-51385_poc.md](../2023/CVE-2023-51385-endasugrue_CVE-2023-51385_poc.md)

## CVE-2023-51385 OpenSSH 命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含shell元字符，且在特定情况下被扩展令牌引用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中存在的一个命令注入漏洞。当用户名或主机名包含 shell 元字符，并且该名称在某些情况下被扩展令牌引用时，可能发生操作系统命令注入。例如，不受信任的 Git 仓库可能具有子模块，其用户名或主机名中包含 shell 元字符。 

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的利用涉及到shell元字符的注入。提供的 POC 代码非常简短，仅包含一个 README.md 文件，指示该项目旨在提供漏洞的概念验证。因此，该POC本身并不能直接验证漏洞，需要结合其他方式例如vin01.github.io/piptagole/ssh/security/openssh/libssh/remote-code-execution/2023/12/20/openssh-proxycommand-libssh-rce.html 中的信息来构造完整的利用链.可以确认漏洞可以利用。

**投毒风险：**

当前提供的 POC 代码（README.md）不包含任何可执行代码，因此直接的投毒风险很低。但是，如果攻击者修改或替换了该 POC，添加了恶意代码，则存在投毒风险。因为该漏洞涉及到命令执行，后门代码可能隐藏在被注入的命令中，实现持久化控制。

**利用方式：**

1.  **构造恶意用户名或主机名：** 攻击者需要创建一个包含 shell 元字符的用户名或主机名。
2.  **触发扩展令牌引用：** 在某些 OpenSSH 配置中，例如使用 `ProxyCommand` 指令，会扩展用户名或主机名。如果扩展过程中没有正确转义 shell 元字符，就会导致命令注入。
3.  **执行任意命令：** 攻击者可以通过注入恶意的 shell 命令来执行任意操作系统命令。

例如，攻击者可以在 Git 子模块的 URL 中嵌入恶意代码，当 OpenSSH 克隆该子模块时，会执行该恶意代码。

从搜索引擎的结果来看，该漏洞影响广泛，多个厂商都发布了安全公告，确认了漏洞的存在和危害。

**项目地址:** [endasugrue/CVE-2023-51385_poc](https://github.com/endasugrue/CVE-2023-51385_poc)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #10

**来源**: [CVE-2023-51385-julienbrs_exploit-CVE-2023-51385.md](../2023/CVE-2023-51385-julienbrs_exploit-CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名称或主机名称包含shell元字符，并且该名称在某些情况下被扩展令牌引用。需要能够触发使用了这些名称的SSH操作。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中的一个命令注入漏洞。当用户名或主机名包含shell元字符时，如果这个名字被某些情况下的扩展令牌引用，就可能发生操作系统命令注入。例如，一个不受信任的 Git 仓库可能有一个子模块，其用户名或主机名中包含 shell 元字符。利用方式是构造包含恶意 shell 元字符的用户名或主机名，并触发 OpenSSH 使用该名称的操作，例如通过包含恶意子模块的 Git 仓库。提供的POC代码只是一个README.md文件，不包含任何可执行代码，因此，不存在投毒风险。

**有效性：** 提供的POC代码只是一个README文件，本身不具备漏洞利用能力，因此本身提供的POC无效，需要结合其他方式触发。但是漏洞本身是存在的，搜索结果表明该漏洞存在并且可以利用。

**投毒风险：** 提供的 POC 代码仅包含一个 README.md 文件，没有任何可执行代码，因此不存在投毒风险。

**利用方式：** 漏洞的利用方式是构造包含恶意 shell 元字符的用户名或主机名，然后让 OpenSSH 在处理 SSH 连接或相关操作时引用这些名字。例如，可以通过创建一个包含恶意用户名或主机名的 Git 子模块，然后当用户尝试克隆或更新该 Git 仓库时，触发命令注入。ProxyCommand也是一个常见的攻击点，在ssh config中可以使用ProxyCommand执行任意命令。攻击者可以在用户名或主机名中嵌入恶意命令，这些命令会在 ProxyCommand 被调用时执行。

**项目地址:** [julienbrs/exploit-CVE-2023-51385](https://github.com/julienbrs/exploit-CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #11

**来源**: [CVE-2023-51385-julienbrs_malicious-exploit-CVE-2023-51385.md](../2023/CVE-2023-51385-julienbrs_malicious-exploit-CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含Shell元字符，并且在特定情况下被扩展令牌引用

**POC 可用性:** 是，但提供的POC代码不完整

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中，允许在特定情况下进行操作系统命令注入。如果用户名或主机名包含 Shell 元字符，并且该名称被某些扩展令牌引用，则可能发生此漏洞。例如，不受信任的 Git 存储库可能具有一个子模块，其用户名或主机名中包含 shell 元字符。提供的漏洞利用代码只是一个 README 文件，本身不包含任何利用逻辑。因此，实际利用还需要构造恶意用户名/主机名并通过特定的 OpenSSH 功能（如 ProxyCommand）触发命令注入。

**有效性：** 提供的POC代码 (README.md) 本身无效，仅为占位符，不具备漏洞利用能力。需要结合漏洞描述构造特定的利用场景才能触发漏洞。

**投毒风险：** 由于提供的代码仅仅是 README 文件，所以认为存在投毒代码的可能性较低，但是不排除作者在其他未提供的代码中隐藏恶意Payload，因此投毒风险评估为 10%。

**利用方式：** 漏洞利用方式如下：
1.  攻击者需要控制包含恶意 Shell 元字符的用户名或主机名。
2.  攻击者诱使用户使用受影响的 OpenSSH 版本连接到恶意服务器或克隆包含恶意配置的Git仓库，触发包含shell元字符的用户名或主机名被引用。
3.  OpenSSH 在处理这些包含 Shell 元字符的名称时，由于不正确的转义或过滤，导致命令注入。
4.  攻击者可以在目标系统上执行任意命令。

**项目地址:** [julienbrs/malicious-exploit-CVE-2023-51385](https://github.com/julienbrs/malicious-exploit-CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #12

**来源**: [CVE-2023-51385-power1314520_CVE-2023-51385_test.md](../2023/CVE-2023-51385-power1314520_CVE-2023-51385_test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要受害者克隆包含恶意.gitmodules文件的Git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。漏洞的根本原因是OpenSSH在处理用户名或主机名中的shell元字符时存在缺陷，当这些名称被扩展令牌引用时，可能导致命令注入。

**漏洞利用方式：**
1.  **利用场景:** 攻击者可以通过创建一个包含恶意`.gitmodules`文件的Git仓库来利用此漏洞。`.gitmodules` 文件用于定义Git子模块的配置信息。
2.  **攻击步骤:**
    *   攻击者创建一个恶意Git仓库，其中包含一个`.gitmodules`文件，该文件在`url`字段中嵌入恶意命令，例如：
        ```
        url = ssh://`echo helloworld > cve.txt`foo.example.com/bar
        ```
    *   攻击者诱使受害者克隆该恶意Git仓库，并且使用`--recurse-submodules`参数。该参数指示Git同时克隆仓库及其子模块。
    *   当Git处理`.gitmodules`文件时，会执行`url`字段中的命令，导致命令注入。
3.  **利用前提条件:**
    *   受害者使用OpenSSH 9.6之前的版本。
    *   受害者的SSH客户端配置了`ProxyCommand`，并且存在可利用的扩展令牌。
    *   受害者克隆了包含恶意`.gitmodules`文件的Git仓库，并且使用了`--recurse-submodules`参数。

**有效性评估：**
根据提供的漏洞信息和POC代码，此漏洞的利用是有效的。POC代码演示了如何通过在`.gitmodules`文件的`url`字段中嵌入恶意命令来实现命令注入。当受害者克隆包含此文件的Git仓库时，恶意命令会被执行。

**投毒风险评估：**
虽然提供的POC代码本身是为了验证漏洞而编写的，但仍存在一定投毒风险。攻击者可能在POC代码中添加额外的恶意代码，例如：

*   **收集用户信息：** 在命令注入的payload中添加收集受害者系统信息的代码，例如用户名、操作系统版本等，并将这些信息发送到攻击者的服务器。
*   **安装后门：** 在受害者系统中安装后门程序，以便攻击者可以长期控制受害者系统。
*   **传播恶意软件：** 利用受害者系统作为跳板，进一步传播恶意软件。

然而，根据提供的POC代码来看，并没有发现明显的恶意行为，只是验证了命令注入。但是，如果攻击者公开分享了修改后的POC，投毒风险就会增大。因此，综合考虑，投毒风险评估为10%。原因是poc本身功能较为简单，且开源，容易被审核。

**项目地址:** [power1314520/CVE-2023-51385_test](https://github.com/power1314520/CVE-2023-51385_test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #13

**来源**: [CVE-2023-51385-runooovb_CVE-2023-51385test.md](../2023/CVE-2023-51385-runooovb_CVE-2023-51385test.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统存在受影响版本的OpenSSH，且攻击者能够控制用户名或主机名中使用的某些字符（通常通过Git子模块等方式）。

**POC 可用性:** 部分。提供的README.md只是描述，需要构造特定的用户名/主机名利用。

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。如果用户名或主机名包含shell元字符，并且该名称在某些情况下被扩展令牌引用，则可能发生操作系统命令注入。例如，不受信任的Git存储库可能包含一个子模块，该子模块在用户名或主机名中具有shell元字符。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**
提供的POC代码（README.md文件）本身不构成一个完整的PoC。它只是对漏洞的描述。完整的利用需要攻击者能够控制用户名或主机名，并在其中插入恶意的shell元字符。

**投毒风险：**
提供的代码仓库（只有README.md）投毒的可能性较低，但是不排除作者在其他相关代码中包含恶意payload的可能。考虑到只有README.md,所以投毒风险较低,评估为10%。

**利用方式：**
1.  **控制用户名/主机名：** 攻击者需要找到一种方法来控制OpenSSH客户端使用的用户名或主机名。这可能通过以下方式实现：
    *   **恶意的Git子模块：**  创建一个包含恶意子模块的Git仓库。该子模块的URL可能包含带有shell元字符的用户名或主机名。
    *   **其他配置：**  在其他OpenSSH配置文件（例如`~/.ssh/config`）中，如果可以控制Host字段,也可以插入恶意字符
2.  **触发漏洞：** 当OpenSSH客户端尝试连接到恶意主机或处理包含恶意子模块的仓库时，它会展开用户名/主机名中的shell元字符，从而导致命令注入。
3.  **执行任意命令：** 攻击者可以通过注入的命令在目标系统上执行任意代码。

综上所述，该漏洞利用需要一定的条件，但如果成功利用，则风险极高。

**项目地址:** [runooovb/CVE-2023-51385test](https://github.com/runooovb/CVE-2023-51385test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #14

**来源**: [CVE-2023-51385-selecthch_CVE-2023-51385.md](../2023/CVE-2023-51385-selecthch_CVE-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用受影响的OpenSSH版本，并且攻击者可以控制用户名或主机名中的shell元字符。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符并且这些名称在某些情况下被扩展标记引用时，可能会发生操作系统命令注入。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞是有效的，允许远程攻击者执行任意操作系统命令。

**投毒风险：**

提供的 POC 代码包含一个 `.gitmodules` 格式的文件，该文件定义了一个名为 "cves" 的子模块，该子模块的 URL 包含命令 `gnome-calculator`。当 `git submodule update --init --recursive` 被执行时，`gnome-calculator`命令就会被执行。这可能存在投毒风险。如果攻击者将恶意命令嵌入到子模块 URL 中，当用户克隆包含此子模块的恶意仓库并尝试初始化和更新子模块时，就会执行这些命令。风险评估为10%，主要是因为这个POC比较明显，容易被发现，且`gnome-calculator`本身无恶意，如果替换成更隐蔽的恶意命令，投毒性会更高。

**利用方式：**

1.  攻击者创建一个恶意的 Git 仓库，并在 `.gitmodules` 文件中，将子模块的 URL 设置为包含 shell 元字符和恶意命令的字符串。
2.  受害者克隆该恶意 Git 仓库。
3.  受害者执行 `git submodule update --init --recursive` 命令以初始化和更新子模块。
4.  由于 URL 中的 shell 元字符未被正确转义，OpenSSH 将执行 URL 中的恶意命令，导致远程代码执行。

**项目地址:** [selecthch/CVE-2023-51385](https://github.com/selecthch/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #15

**来源**: [CVE-2023-51385-thinkliving2020_CVE-2023-51385-.md](../2023/CVE-2023-51385-thinkliving2020_CVE-2023-51385-.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 受害者需要使用存在漏洞的OpenSSH版本，并连接到包含恶意配置的Git仓库子模块或者其他存在恶意用户名/主机名的配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 漏洞存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符时，如果这些名称被特定的扩展令牌引用，可能导致操作系统命令注入。例如，一个不受信任的 Git 仓库的子模块可能在用户名或主机名中包含 shell 元字符。 

**有效性:** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在并且影响 OpenSSH 9.6 之前的版本。提供的 POC 代码利用了 `~/.ssh/config` 文件中的 `ProxyCommand` 指令，通过在主机名中使用 shell 元字符来执行任意命令。通过`git clone --recurse-submodules`下载包含恶意配置的子模块，即可触发漏洞。 

**投毒风险:** 该POC提供了一个通过恶意配置子模块触发计算器弹出的例子，帮助用户验证该漏洞，提高安全意识。但是，如果攻击者修改了 `~/.ssh/config` 文件或通过其他方式将恶意的用户名/主机名注入到配置中，就有可能执行任意命令，造成安全风险。因此，虽然POC本身是为了演示漏洞，但也存在被滥用的可能。 投毒风险评估为10%，主要考虑攻击者可能在公开的漏洞利用代码中添加恶意代码，诱导用户执行，但是该POC主要依赖配置文件的恶意构造，直接添加恶意代码到POC文件中的可能性较低。

**利用方式:**  利用方式主要通过以下步骤：
1.  攻击者创建一个包含恶意子模块的Git仓库，该子模块的用户名或主机名包含shell元字符。
2.  受害者克隆该仓库，并使用 `--recurse-submodules` 参数初始化子模块。
3.  当 OpenSSH 使用 `ProxyCommand` 指令处理包含恶意元字符的用户名或主机名时，会执行攻击者构造的恶意命令。

另一种利用方式是攻击者诱导受害者在`~/.ssh/config`中添加包含恶意shell元字符的配置信息，当ssh连接目标主机时触发该配置，执行恶意命令。


**项目地址:** [thinkliving2020/CVE-2023-51385-](https://github.com/thinkliving2020/CVE-2023-51385-)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #16

**来源**: [CVE-2023-51385-vin01_poc-proxycommand-vulnerable.md](../2023/CVE-2023-51385-vin01_poc-proxycommand-vulnerable.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用OpenSSH，且受害者需要clone包含恶意submodule的Git仓库或连接到包含恶意用户名/主机名的SSH服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于OpenSSH 9.6之前的版本中。该漏洞允许攻击者通过在用户名或主机名中注入shell元字符来执行任意操作系统命令。当 OpenSSH 在某些情况下扩展令牌时，如果用户名或主机名包含shell元字符，则可能发生OS命令注入。

**有效性：** 提供的POC代码显示了一种利用`ProxyCommand`配置项中`%h`和`%p`等令牌的方式，当这些令牌引用的主机名或用户名包含shell元字符时，可能导致命令注入。POC通过一个包含恶意子模块的Git仓库进行演示，攻击者可以诱使用户clone该仓库，从而触发漏洞。

**投毒风险：**  POC仓库本身的主要目的是演示漏洞，但存在一定投毒风险。  风险点在于Submodule的地址可被篡改，从而指向包含更恶意代码的仓库。Readme中包含执行`git clone`的命令，引导用户执行恶意操作。虽然当前POC只是弹出一个计算器，但攻击者可以替换Submodule指向的仓库，加入其他恶意代码，例如植入后门、窃取信息等。风险评估为10%，主要考虑因素是POC的主要目的是演示漏洞，并非大规模恶意攻击，但存在被二次利用的风险。  

**利用方式：**

1.  **恶意Git仓库：** 攻击者创建一个包含恶意子模块的Git仓库。子模块的URL包含带有shell元字符的用户名或主机名。
2.  **诱导受害者：** 攻击者诱导受害者克隆该Git仓库，可以使用`git clone --recurse-submodules`命令。
3.  **触发漏洞：** 当git clone子模块时，OpenSSH会解析`.ssh/config` 文件，如果文件中存在`ProxyCommand`等配置项，并且使用了受影响的令牌（如 `%h`、`%p`），则会导致命令注入。
4.  **命令执行：** 注入的shell元字符会被执行，从而允许攻击者在受害者系统上执行任意命令。 

**缓解措施：**
*   升级到OpenSSH 9.6或更高版本。
*   避免在用户名或主机名中使用shell元字符。
*   仔细审查`.ssh/config`文件，特别是 `ProxyCommand` 配置项。
*   谨慎克隆来自不可信来源的Git仓库。

**项目地址:** [vin01/poc-proxycommand-vulnerable](https://github.com/vin01/poc-proxycommand-vulnerable)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

## POC #17

**来源**: [CVE-2023-51385-watarium_poc-cve-2023-51385.md](../2023/CVE-2023-51385-watarium_poc-cve-2023-51385.md)

## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用OpenSSH，且用户名或主机名包含shell元字符并被某些扩展令牌引用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 漏洞存在于OpenSSH 9.6版本之前，允许攻击者通过在用户名或主机名中注入shell元字符，并在特定情况下被扩展令牌引用时，执行任意操作系统命令。例如，恶意Git仓库的子模块可以在用户名或主机名中包含shell元字符。提供的POC代码 `poc-cve-2023-51385`  仅包含一个 `README.md` 文件，内容简单，仅为标题，说明poc是存在的，但是这个简单的poc没有展示任何攻击代码，这意味着需要其他方式来利用此漏洞。该漏洞的利用方式主要通过以下步骤：1.  攻击者构造包含恶意shell元字符的用户名或主机名。2.  攻击者诱使用户连接到包含恶意用户名或主机名的系统。3.  OpenSSH处理连接时，如果相关配置（例如 `ProxyCommand`）使用了扩展令牌引用该用户名或主机名，则会执行注入的shell命令。根据搜索结果，此漏洞已经公开，并且多个厂商发布了安全公告。虽然提供的POC很简单，但该漏洞的严重性不容忽视。投毒风险评估：由于 POC 代码非常简单，只包含一个 README 文件，因此直接投毒的可能性较低。但是，后续利用该漏洞的Payload可能存在投毒风险，例如，利用该漏洞在目标机器上安装恶意软件或后门。考虑到POC代码的简洁性，以及漏洞本身的性质，估计该仓库存在作者隐藏的投毒代码的可能性较低，约为10%。

**项目地址:** [watarium/poc-cve-2023-51385](https://github.com/watarium/poc-cve-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)

---

