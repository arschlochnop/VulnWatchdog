# CVE-2023-31126

> ðŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-31126-shoucheng3_cov-int.md](../2023/CVE-2023-31126-shoucheng3_cov-int.md)

## CVE-2023-31126-XWiki-XSS

**æ¼æ´žç¼–å·:** CVE-2023-31126

**æ¼æ´žç±»åž‹:** è·¨ç«™è„šæœ¬ (XSS)

**å½±å“åº”ç”¨:** XWiki

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æ”»å‡»è€…æ³¨å…¥ä»»æ„HTMLä»£ç ï¼Œä»Žè€Œæ‰§è¡Œæ¶æ„è„šæœ¬ã€çªƒå–ç”¨æˆ·æ•°æ®æˆ–ç¯¡æ”¹é¡µé¢å†…å®¹ã€‚

**å½±å“ç‰ˆæœ¬:** >= 14.6-rc-1, < 14.10.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·äº¤äº’ï¼ˆä¾‹å¦‚ï¼Œç‚¹å‡»æ¶æ„é“¾æŽ¥æˆ–è®¿é—®è¢«ç¯¡æ”¹çš„é¡µé¢ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2023-31126æ˜¯XWikiä¸­org.xwiki.commons:xwiki-commons-xmlåº“å­˜åœ¨çš„ä¸€ä¸ªæ¼æ´žã€‚è¯¥æ¼æ´žæºäºŽHTML sanitizerå¯¹dataå±žæ€§åç§°ä¸­æ— æ•ˆå­—ç¬¦çš„å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´žæ³¨å…¥ä»»æ„HTMLä»£ç ï¼Œä»Žè€Œå¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ã€‚ä»Žæœç´¢ç»“æžœæ¥çœ‹ï¼Œå¤šä¸ªç½‘ç«™éƒ½æåˆ°äº†è¯¥æ¼æ´žçš„ä¸¥é‡æ€§ä»¥åŠéœ€è¦ç”¨æˆ·äº¤äº’ã€‚æ¼æ´žåˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªJenkinsfileï¼Œç”¨äºŽæž„å»ºXWiki Commonsã€‚æ­¤Jenkinsfileæœ¬èº«å¹¶æ²¡æœ‰ç›´æŽ¥ä½“çŽ°XSSåˆ©ç”¨ä»£ç ï¼Œä½†å®ƒè´Ÿè´£æž„å»ºå­˜åœ¨æ¼æ´žçš„ç»„ä»¶ï¼Œå› æ­¤é—´æŽ¥ä¸Žæ¼æ´žç›¸å…³ã€‚æŠ•æ¯’é£Žé™©è¯„ä¼°ï¼šè™½ç„¶Jenkinsfileæœ¬èº«ä¸»è¦ç”¨äºŽæž„å»ºå’Œæµ‹è¯•ï¼Œä½†å®ƒä¹Ÿå¯èƒ½åŒ…å«ä¸€äº›éšè—çš„æ¶æ„ä»£ç ï¼Œæ¯”å¦‚åœ¨æž„å»ºè¿‡ç¨‹ä¸­ä¸‹è½½æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œæˆ–è€…ä¿®æ”¹æž„å»ºåŽçš„å·¥ä»¶ã€‚ è€ƒè™‘åˆ°Jenkinsfileçš„å¤æ‚æ€§ï¼Œä»¥åŠå®ƒåœ¨è‡ªåŠ¨åŒ–æž„å»ºè¿‡ç¨‹ä¸­çš„æ ¸å¿ƒåœ°ä½ï¼Œå­˜åœ¨ä¸€å®šçš„è¢«æŠ•æ¯’é£Žé™©ï¼Œä¼°è®¡ä¸º10%ã€‚æ¼æ´žçš„åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…é€šè¿‡æž„é€ åŒ…å«æ¶æ„dataå±žæ€§çš„HTMLä»£ç ï¼Œåˆ©ç”¨XWikiçš„HTML sanitizerä¸­çš„æ¼æ´žï¼Œæ³¨å…¥æ¶æ„çš„JavaScriptä»£ç ã€‚å½“ç”¨æˆ·è®¿é—®åŒ…å«è¿™äº›æ¶æ„ä»£ç çš„é¡µé¢æ—¶ï¼ŒJavaScriptä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œä»Žè€Œå¯¼è‡´XSSæ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/cov-int](https://github.com/shoucheng3/cov-int)

**æ¼æ´žè¯¦æƒ…:** [CVE-2023-31126](https://nvd.nist.gov/vuln/detail/CVE-2023-31126)

---

## POC #2

**æ¥æº**: [CVE-2023-31126-shoucheng3_xwiki__xwiki-commons_CVE-2023-31126_14-10-3.md](../2023/CVE-2023-31126-shoucheng3_xwiki__xwiki-commons_CVE-2023-31126_14-10-3.md)

# CVE-2023-31126

> ðŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-31126-shoucheng3_cov-int.md](../2023/CVE-2023-31126-shoucheng3_cov-int.md)

## CVE-2023-31126-XWiki-XSS

**æ¼æ´žç¼–å·:** CVE-2023-31126

**æ¼æ´žç±»åž‹:** è·¨ç«™è„šæœ¬ (XSS)

**å½±å“åº”ç”¨:** XWiki

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æ”»å‡»è€…æ³¨å…¥ä»»æ„HTMLä»£ç ï¼Œä»Žè€Œæ‰§è¡Œæ¶æ„è„šæœ¬ã€çªƒå–ç”¨æˆ·æ•°æ®æˆ–ç¯¡æ”¹é¡µé¢å†…å®¹ã€‚

**å½±å“ç‰ˆæœ¬:** >= 14.6-rc-1, < 14.10.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·äº¤äº’ï¼ˆä¾‹å¦‚ï¼Œç‚¹å‡»æ¶æ„é“¾æŽ¥æˆ–è®¿é—®è¢«ç¯¡æ”¹çš„é¡µé¢ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2023-31126æ˜¯XWikiä¸­org.xwiki.commons:xwiki-commons-xmlåº“å­˜åœ¨çš„ä¸€ä¸ªæ¼æ´žã€‚è¯¥æ¼æ´žæºäºŽHTML sanitizerå¯¹dataå±žæ€§åç§°ä¸­æ— æ•ˆå­—ç¬¦çš„å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´žæ³¨å…¥ä»»æ„HTMLä»£ç ï¼Œä»Žè€Œå¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ã€‚ä»Žæœç´¢ç»“æžœæ¥çœ‹ï¼Œå¤šä¸ªç½‘ç«™éƒ½æåˆ°äº†è¯¥æ¼æ´žçš„ä¸¥é‡æ€§ä»¥åŠéœ€è¦ç”¨æˆ·äº¤äº’ã€‚æ¼æ´žåˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªJenkinsfileï¼Œç”¨äºŽæž„å»ºXWiki Commonsã€‚æ­¤Jenkinsfileæœ¬èº«å¹¶æ²¡æœ‰ç›´æŽ¥ä½“çŽ°XSSåˆ©ç”¨ä»£ç ï¼Œä½†å®ƒè´Ÿè´£æž„å»ºå­˜åœ¨æ¼æ´žçš„ç»„ä»¶ï¼Œå› æ­¤é—´æŽ¥ä¸Žæ¼æ´žç›¸å…³ã€‚æŠ•æ¯’é£Žé™©è¯„ä¼°ï¼šè™½ç„¶Jenkinsfileæœ¬èº«ä¸»è¦ç”¨äºŽæž„å»ºå’Œæµ‹è¯•ï¼Œä½†å®ƒä¹Ÿå¯èƒ½åŒ…å«ä¸€äº›éšè—çš„æ¶æ„ä»£ç ï¼Œæ¯”å¦‚åœ¨æž„å»ºè¿‡ç¨‹ä¸­ä¸‹è½½æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œæˆ–è€…ä¿®æ”¹æž„å»ºåŽçš„å·¥ä»¶ã€‚ è€ƒè™‘åˆ°Jenkinsfileçš„å¤æ‚æ€§ï¼Œä»¥åŠå®ƒåœ¨è‡ªåŠ¨åŒ–æž„å»ºè¿‡ç¨‹ä¸­çš„æ ¸å¿ƒåœ°ä½ï¼Œå­˜åœ¨ä¸€å®šçš„è¢«æŠ•æ¯’é£Žé™©ï¼Œä¼°è®¡ä¸º10%ã€‚æ¼æ´žçš„åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…é€šè¿‡æž„é€ åŒ…å«æ¶æ„dataå±žæ€§çš„HTMLä»£ç ï¼Œåˆ©ç”¨XWikiçš„HTML sanitizerä¸­çš„æ¼æ´žï¼Œæ³¨å…¥æ¶æ„çš„JavaScriptä»£ç ã€‚å½“ç”¨æˆ·è®¿é—®åŒ…å«è¿™äº›æ¶æ„ä»£ç çš„é¡µé¢æ—¶ï¼ŒJavaScriptä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œä»Žè€Œå¯¼è‡´XSSæ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/cov-int](https://github.com/shoucheng3/cov-int)

**æ¼æ´žè¯¦æƒ…:** [CVE-2023-31126](https://nvd.nist.gov/vuln/detail/CVE-2023-31126)

---

## POC #2

**æ¥æº**: [CVE-2023-31126-shoucheng3_xwiki__xwiki-commons_CVE-2023-31126_14-10-3.md](../2023/CVE-2023-31126-shoucheng3_xwiki__xwiki-commons_CVE-2023-31126_14-10-3.md)

# CVE-2023-31126

> ðŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-31126-shoucheng3_cov-int.md](../2023/CVE-2023-31126-shoucheng3_cov-int.md)

## CVE-2023-31126-XWiki-XSS

**æ¼æ´žç¼–å·:** CVE-2023-31126

**æ¼æ´žç±»åž‹:** è·¨ç«™è„šæœ¬ (XSS)

**å½±å“åº”ç”¨:** XWiki

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æ”»å‡»è€…æ³¨å…¥ä»»æ„HTMLä»£ç ï¼Œä»Žè€Œæ‰§è¡Œæ¶æ„è„šæœ¬ã€çªƒå–ç”¨æˆ·æ•°æ®æˆ–ç¯¡æ”¹é¡µé¢å†…å®¹ã€‚

**å½±å“ç‰ˆæœ¬:** >= 14.6-rc-1, < 14.10.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·äº¤äº’ï¼ˆä¾‹å¦‚ï¼Œç‚¹å‡»æ¶æ„é“¾æŽ¥æˆ–è®¿é—®è¢«ç¯¡æ”¹çš„é¡µé¢ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2023-31126æ˜¯XWikiä¸­org.xwiki.commons:xwiki-commons-xmlåº“å­˜åœ¨çš„ä¸€ä¸ªæ¼æ´žã€‚è¯¥æ¼æ´žæºäºŽHTML sanitizerå¯¹dataå±žæ€§åç§°ä¸­æ— æ•ˆå­—ç¬¦çš„å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´žæ³¨å…¥ä»»æ„HTMLä»£ç ï¼Œä»Žè€Œå¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ã€‚ä»Žæœç´¢ç»“æžœæ¥çœ‹ï¼Œå¤šä¸ªç½‘ç«™éƒ½æåˆ°äº†è¯¥æ¼æ´žçš„ä¸¥é‡æ€§ä»¥åŠéœ€è¦ç”¨æˆ·äº¤äº’ã€‚æ¼æ´žåˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªJenkinsfileï¼Œç”¨äºŽæž„å»ºXWiki Commonsã€‚æ­¤Jenkinsfileæœ¬èº«å¹¶æ²¡æœ‰ç›´æŽ¥ä½“çŽ°XSSåˆ©ç”¨ä»£ç ï¼Œä½†å®ƒè´Ÿè´£æž„å»ºå­˜åœ¨æ¼æ´žçš„ç»„ä»¶ï¼Œå› æ­¤é—´æŽ¥ä¸Žæ¼æ´žç›¸å…³ã€‚æŠ•æ¯’é£Žé™©è¯„ä¼°ï¼šè™½ç„¶Jenkinsfileæœ¬èº«ä¸»è¦ç”¨äºŽæž„å»ºå’Œæµ‹è¯•ï¼Œä½†å®ƒä¹Ÿå¯èƒ½åŒ…å«ä¸€äº›éšè—çš„æ¶æ„ä»£ç ï¼Œæ¯”å¦‚åœ¨æž„å»ºè¿‡ç¨‹ä¸­ä¸‹è½½æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œæˆ–è€…ä¿®æ”¹æž„å»ºåŽçš„å·¥ä»¶ã€‚ è€ƒè™‘åˆ°Jenkinsfileçš„å¤æ‚æ€§ï¼Œä»¥åŠå®ƒåœ¨è‡ªåŠ¨åŒ–æž„å»ºè¿‡ç¨‹ä¸­çš„æ ¸å¿ƒåœ°ä½ï¼Œå­˜åœ¨ä¸€å®šçš„è¢«æŠ•æ¯’é£Žé™©ï¼Œä¼°è®¡ä¸º10%ã€‚æ¼æ´žçš„åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…é€šè¿‡æž„é€ åŒ…å«æ¶æ„dataå±žæ€§çš„HTMLä»£ç ï¼Œåˆ©ç”¨XWikiçš„HTML sanitizerä¸­çš„æ¼æ´žï¼Œæ³¨å…¥æ¶æ„çš„JavaScriptä»£ç ã€‚å½“ç”¨æˆ·è®¿é—®åŒ…å«è¿™äº›æ¶æ„ä»£ç çš„é¡µé¢æ—¶ï¼ŒJavaScriptä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œä»Žè€Œå¯¼è‡´XSSæ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/cov-int](https://github.com/shoucheng3/cov-int)

**æ¼æ´žè¯¦æƒ…:** [CVE-2023-31126](https://nvd.nist.gov/vuln/detail/CVE-2023-31126)

---

## POC #2

**æ¥æº**: [CVE-2023-31126-shoucheng3_xwiki__xwiki-commons_CVE-2023-31126_14-10-3.md](../2023/CVE-2023-31126-shoucheng3_xwiki__xwiki-commons_CVE-2023-31126_14-10-3.md)

# CVE-2023-31126

> ðŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-31126-shoucheng3_cov-int.md](../2023/CVE-2023-31126-shoucheng3_cov-int.md)

## CVE-2023-31126-XWiki-XSS

**æ¼æ´žç¼–å·:** CVE-2023-31126

**æ¼æ´žç±»åž‹:** è·¨ç«™è„šæœ¬ (XSS)

**å½±å“åº”ç”¨:** XWiki

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æ”»å‡»è€…æ³¨å…¥ä»»æ„HTMLä»£ç ï¼Œä»Žè€Œæ‰§è¡Œæ¶æ„è„šæœ¬ã€çªƒå–ç”¨æˆ·æ•°æ®æˆ–ç¯¡æ”¹é¡µé¢å†…å®¹ã€‚

**å½±å“ç‰ˆæœ¬:** >= 14.6-rc-1, < 14.10.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·äº¤äº’ï¼ˆä¾‹å¦‚ï¼Œç‚¹å‡»æ¶æ„é“¾æŽ¥æˆ–è®¿é—®è¢«ç¯¡æ”¹çš„é¡µé¢ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2023-31126æ˜¯XWikiä¸­org.xwiki.commons:xwiki-commons-xmlåº“å­˜åœ¨çš„ä¸€ä¸ªæ¼æ´žã€‚è¯¥æ¼æ´žæºäºŽHTML sanitizerå¯¹dataå±žæ€§åç§°ä¸­æ— æ•ˆå­—ç¬¦çš„å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´žæ³¨å…¥ä»»æ„HTMLä»£ç ï¼Œä»Žè€Œå¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ã€‚ä»Žæœç´¢ç»“æžœæ¥çœ‹ï¼Œå¤šä¸ªç½‘ç«™éƒ½æåˆ°äº†è¯¥æ¼æ´žçš„ä¸¥é‡æ€§ä»¥åŠéœ€è¦ç”¨æˆ·äº¤äº’ã€‚æ¼æ´žåˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªJenkinsfileï¼Œç”¨äºŽæž„å»ºXWiki Commonsã€‚æ­¤Jenkinsfileæœ¬èº«å¹¶æ²¡æœ‰ç›´æŽ¥ä½“çŽ°XSSåˆ©ç”¨ä»£ç ï¼Œä½†å®ƒè´Ÿè´£æž„å»ºå­˜åœ¨æ¼æ´žçš„ç»„ä»¶ï¼Œå› æ­¤é—´æŽ¥ä¸Žæ¼æ´žç›¸å…³ã€‚æŠ•æ¯’é£Žé™©è¯„ä¼°ï¼šè™½ç„¶Jenkinsfileæœ¬èº«ä¸»è¦ç”¨äºŽæž„å»ºå’Œæµ‹è¯•ï¼Œä½†å®ƒä¹Ÿå¯èƒ½åŒ…å«ä¸€äº›éšè—çš„æ¶æ„ä»£ç ï¼Œæ¯”å¦‚åœ¨æž„å»ºè¿‡ç¨‹ä¸­ä¸‹è½½æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œæˆ–è€…ä¿®æ”¹æž„å»ºåŽçš„å·¥ä»¶ã€‚ è€ƒè™‘åˆ°Jenkinsfileçš„å¤æ‚æ€§ï¼Œä»¥åŠå®ƒåœ¨è‡ªåŠ¨åŒ–æž„å»ºè¿‡ç¨‹ä¸­çš„æ ¸å¿ƒåœ°ä½ï¼Œå­˜åœ¨ä¸€å®šçš„è¢«æŠ•æ¯’é£Žé™©ï¼Œä¼°è®¡ä¸º10%ã€‚æ¼æ´žçš„åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…é€šè¿‡æž„é€ åŒ…å«æ¶æ„dataå±žæ€§çš„HTMLä»£ç ï¼Œåˆ©ç”¨XWikiçš„HTML sanitizerä¸­çš„æ¼æ´žï¼Œæ³¨å…¥æ¶æ„çš„JavaScriptä»£ç ã€‚å½“ç”¨æˆ·è®¿é—®åŒ…å«è¿™äº›æ¶æ„ä»£ç çš„é¡µé¢æ—¶ï¼ŒJavaScriptä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œä»Žè€Œå¯¼è‡´XSSæ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/cov-int](https://github.com/shoucheng3/cov-int)

**æ¼æ´žè¯¦æƒ…:** [CVE-2023-31126](https://nvd.nist.gov/vuln/detail/CVE-2023-31126)

---

## POC #2

**æ¥æº**: [CVE-2023-31126-shoucheng3_xwiki__xwiki-commons_CVE-2023-31126_14-10-3.md](../2023/CVE-2023-31126-shoucheng3_xwiki__xwiki-commons_CVE-2023-31126_14-10-3.md)

# CVE-2023-31126

> ðŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-31126-shoucheng3_cov-int.md](../2023/CVE-2023-31126-shoucheng3_cov-int.md)

## CVE-2023-31126-XWiki-XSS

**æ¼æ´žç¼–å·:** CVE-2023-31126

**æ¼æ´žç±»åž‹:** è·¨ç«™è„šæœ¬ (XSS)

**å½±å“åº”ç”¨:** XWiki

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æ”»å‡»è€…æ³¨å…¥ä»»æ„HTMLä»£ç ï¼Œä»Žè€Œæ‰§è¡Œæ¶æ„è„šæœ¬ã€çªƒå–ç”¨æˆ·æ•°æ®æˆ–ç¯¡æ”¹é¡µé¢å†…å®¹ã€‚

**å½±å“ç‰ˆæœ¬:** >= 14.6-rc-1, < 14.10.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·äº¤äº’ï¼ˆä¾‹å¦‚ï¼Œç‚¹å‡»æ¶æ„é“¾æŽ¥æˆ–è®¿é—®è¢«ç¯¡æ”¹çš„é¡µé¢ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2023-31126æ˜¯XWikiä¸­org.xwiki.commons:xwiki-commons-xmlåº“å­˜åœ¨çš„ä¸€ä¸ªæ¼æ´žã€‚è¯¥æ¼æ´žæºäºŽHTML sanitizerå¯¹dataå±žæ€§åç§°ä¸­æ— æ•ˆå­—ç¬¦çš„å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´žæ³¨å…¥ä»»æ„HTMLä»£ç ï¼Œä»Žè€Œå¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ã€‚ä»Žæœç´¢ç»“æžœæ¥çœ‹ï¼Œå¤šä¸ªç½‘ç«™éƒ½æåˆ°äº†è¯¥æ¼æ´žçš„ä¸¥é‡æ€§ä»¥åŠéœ€è¦ç”¨æˆ·äº¤äº’ã€‚æ¼æ´žåˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªJenkinsfileï¼Œç”¨äºŽæž„å»ºXWiki Commonsã€‚æ­¤Jenkinsfileæœ¬èº«å¹¶æ²¡æœ‰ç›´æŽ¥ä½“çŽ°XSSåˆ©ç”¨ä»£ç ï¼Œä½†å®ƒè´Ÿè´£æž„å»ºå­˜åœ¨æ¼æ´žçš„ç»„ä»¶ï¼Œå› æ­¤é—´æŽ¥ä¸Žæ¼æ´žç›¸å…³ã€‚æŠ•æ¯’é£Žé™©è¯„ä¼°ï¼šè™½ç„¶Jenkinsfileæœ¬èº«ä¸»è¦ç”¨äºŽæž„å»ºå’Œæµ‹è¯•ï¼Œä½†å®ƒä¹Ÿå¯èƒ½åŒ…å«ä¸€äº›éšè—çš„æ¶æ„ä»£ç ï¼Œæ¯”å¦‚åœ¨æž„å»ºè¿‡ç¨‹ä¸­ä¸‹è½½æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œæˆ–è€…ä¿®æ”¹æž„å»ºåŽçš„å·¥ä»¶ã€‚ è€ƒè™‘åˆ°Jenkinsfileçš„å¤æ‚æ€§ï¼Œä»¥åŠå®ƒåœ¨è‡ªåŠ¨åŒ–æž„å»ºè¿‡ç¨‹ä¸­çš„æ ¸å¿ƒåœ°ä½ï¼Œå­˜åœ¨ä¸€å®šçš„è¢«æŠ•æ¯’é£Žé™©ï¼Œä¼°è®¡ä¸º10%ã€‚æ¼æ´žçš„åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…é€šè¿‡æž„é€ åŒ…å«æ¶æ„dataå±žæ€§çš„HTMLä»£ç ï¼Œåˆ©ç”¨XWikiçš„HTML sanitizerä¸­çš„æ¼æ´žï¼Œæ³¨å…¥æ¶æ„çš„JavaScriptä»£ç ã€‚å½“ç”¨æˆ·è®¿é—®åŒ…å«è¿™äº›æ¶æ„ä»£ç çš„é¡µé¢æ—¶ï¼ŒJavaScriptä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œä»Žè€Œå¯¼è‡´XSSæ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/cov-int](https://github.com/shoucheng3/cov-int)

**æ¼æ´žè¯¦æƒ…:** [CVE-2023-31126](https://nvd.nist.gov/vuln/detail/CVE-2023-31126)

---

## POC #2

**æ¥æº**: [CVE-2023-31126-shoucheng3_xwiki__xwiki-commons_CVE-2023-31126_14-10-3.md](../2023/CVE-2023-31126-shoucheng3_xwiki__xwiki-commons_CVE-2023-31126_14-10-3.md)

# CVE-2023-31126

> ðŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-31126-shoucheng3_cov-int.md](../2023/CVE-2023-31126-shoucheng3_cov-int.md)

## CVE-2023-31126-XWiki-XSS

**æ¼æ´žç¼–å·:** CVE-2023-31126

**æ¼æ´žç±»åž‹:** è·¨ç«™è„šæœ¬ (XSS)

**å½±å“åº”ç”¨:** XWiki

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æ”»å‡»è€…æ³¨å…¥ä»»æ„HTMLä»£ç ï¼Œä»Žè€Œæ‰§è¡Œæ¶æ„è„šæœ¬ã€çªƒå–ç”¨æˆ·æ•°æ®æˆ–ç¯¡æ”¹é¡µé¢å†…å®¹ã€‚

**å½±å“ç‰ˆæœ¬:** >= 14.6-rc-1, < 14.10.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·äº¤äº’ï¼ˆä¾‹å¦‚ï¼Œç‚¹å‡»æ¶æ„é“¾æŽ¥æˆ–è®¿é—®è¢«ç¯¡æ”¹çš„é¡µé¢ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2023-31126æ˜¯XWikiä¸­org.xwiki.commons:xwiki-commons-xmlåº“å­˜åœ¨çš„ä¸€ä¸ªæ¼æ´žã€‚è¯¥æ¼æ´žæºäºŽHTML sanitizerå¯¹dataå±žæ€§åç§°ä¸­æ— æ•ˆå­—ç¬¦çš„å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´žæ³¨å…¥ä»»æ„HTMLä»£ç ï¼Œä»Žè€Œå¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ã€‚ä»Žæœç´¢ç»“æžœæ¥çœ‹ï¼Œå¤šä¸ªç½‘ç«™éƒ½æåˆ°äº†è¯¥æ¼æ´žçš„ä¸¥é‡æ€§ä»¥åŠéœ€è¦ç”¨æˆ·äº¤äº’ã€‚æ¼æ´žåˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªJenkinsfileï¼Œç”¨äºŽæž„å»ºXWiki Commonsã€‚æ­¤Jenkinsfileæœ¬èº«å¹¶æ²¡æœ‰ç›´æŽ¥ä½“çŽ°XSSåˆ©ç”¨ä»£ç ï¼Œä½†å®ƒè´Ÿè´£æž„å»ºå­˜åœ¨æ¼æ´žçš„ç»„ä»¶ï¼Œå› æ­¤é—´æŽ¥ä¸Žæ¼æ´žç›¸å…³ã€‚æŠ•æ¯’é£Žé™©è¯„ä¼°ï¼šè™½ç„¶Jenkinsfileæœ¬èº«ä¸»è¦ç”¨äºŽæž„å»ºå’Œæµ‹è¯•ï¼Œä½†å®ƒä¹Ÿå¯èƒ½åŒ…å«ä¸€äº›éšè—çš„æ¶æ„ä»£ç ï¼Œæ¯”å¦‚åœ¨æž„å»ºè¿‡ç¨‹ä¸­ä¸‹è½½æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œæˆ–è€…ä¿®æ”¹æž„å»ºåŽçš„å·¥ä»¶ã€‚ è€ƒè™‘åˆ°Jenkinsfileçš„å¤æ‚æ€§ï¼Œä»¥åŠå®ƒåœ¨è‡ªåŠ¨åŒ–æž„å»ºè¿‡ç¨‹ä¸­çš„æ ¸å¿ƒåœ°ä½ï¼Œå­˜åœ¨ä¸€å®šçš„è¢«æŠ•æ¯’é£Žé™©ï¼Œä¼°è®¡ä¸º10%ã€‚æ¼æ´žçš„åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…é€šè¿‡æž„é€ åŒ…å«æ¶æ„dataå±žæ€§çš„HTMLä»£ç ï¼Œåˆ©ç”¨XWikiçš„HTML sanitizerä¸­çš„æ¼æ´žï¼Œæ³¨å…¥æ¶æ„çš„JavaScriptä»£ç ã€‚å½“ç”¨æˆ·è®¿é—®åŒ…å«è¿™äº›æ¶æ„ä»£ç çš„é¡µé¢æ—¶ï¼ŒJavaScriptä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œä»Žè€Œå¯¼è‡´XSSæ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/cov-int](https://github.com/shoucheng3/cov-int)

**æ¼æ´žè¯¦æƒ…:** [CVE-2023-31126](https://nvd.nist.gov/vuln/detail/CVE-2023-31126)

---

## POC #2

**æ¥æº**: [CVE-2023-31126-shoucheng3_xwiki__xwiki-commons_CVE-2023-31126_14-10-3.md](../2023/CVE-2023-31126-shoucheng3_xwiki__xwiki-commons_CVE-2023-31126_14-10-3.md)

# CVE-2023-31126

> ðŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-31126-shoucheng3_cov-int.md](../2023/CVE-2023-31126-shoucheng3_cov-int.md)

## CVE-2023-31126-XWiki-XSS

**æ¼æ´žç¼–å·:** CVE-2023-31126

**æ¼æ´žç±»åž‹:** è·¨ç«™è„šæœ¬ (XSS)

**å½±å“åº”ç”¨:** XWiki

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æ”»å‡»è€…æ³¨å…¥ä»»æ„HTMLä»£ç ï¼Œä»Žè€Œæ‰§è¡Œæ¶æ„è„šæœ¬ã€çªƒå–ç”¨æˆ·æ•°æ®æˆ–ç¯¡æ”¹é¡µé¢å†…å®¹ã€‚

**å½±å“ç‰ˆæœ¬:** >= 14.6-rc-1, < 14.10.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·äº¤äº’ï¼ˆä¾‹å¦‚ï¼Œç‚¹å‡»æ¶æ„é“¾æŽ¥æˆ–è®¿é—®è¢«ç¯¡æ”¹çš„é¡µé¢ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2023-31126æ˜¯XWikiä¸­org.xwiki.commons:xwiki-commons-xmlåº“å­˜åœ¨çš„ä¸€ä¸ªæ¼æ´žã€‚è¯¥æ¼æ´žæºäºŽHTML sanitizerå¯¹dataå±žæ€§åç§°ä¸­æ— æ•ˆå­—ç¬¦çš„å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´žæ³¨å…¥ä»»æ„HTMLä»£ç ï¼Œä»Žè€Œå¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ã€‚ä»Žæœç´¢ç»“æžœæ¥çœ‹ï¼Œå¤šä¸ªç½‘ç«™éƒ½æåˆ°äº†è¯¥æ¼æ´žçš„ä¸¥é‡æ€§ä»¥åŠéœ€è¦ç”¨æˆ·äº¤äº’ã€‚æ¼æ´žåˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªJenkinsfileï¼Œç”¨äºŽæž„å»ºXWiki Commonsã€‚æ­¤Jenkinsfileæœ¬èº«å¹¶æ²¡æœ‰ç›´æŽ¥ä½“çŽ°XSSåˆ©ç”¨ä»£ç ï¼Œä½†å®ƒè´Ÿè´£æž„å»ºå­˜åœ¨æ¼æ´žçš„ç»„ä»¶ï¼Œå› æ­¤é—´æŽ¥ä¸Žæ¼æ´žç›¸å…³ã€‚æŠ•æ¯’é£Žé™©è¯„ä¼°ï¼šè™½ç„¶Jenkinsfileæœ¬èº«ä¸»è¦ç”¨äºŽæž„å»ºå’Œæµ‹è¯•ï¼Œä½†å®ƒä¹Ÿå¯èƒ½åŒ…å«ä¸€äº›éšè—çš„æ¶æ„ä»£ç ï¼Œæ¯”å¦‚åœ¨æž„å»ºè¿‡ç¨‹ä¸­ä¸‹è½½æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œæˆ–è€…ä¿®æ”¹æž„å»ºåŽçš„å·¥ä»¶ã€‚ è€ƒè™‘åˆ°Jenkinsfileçš„å¤æ‚æ€§ï¼Œä»¥åŠå®ƒåœ¨è‡ªåŠ¨åŒ–æž„å»ºè¿‡ç¨‹ä¸­çš„æ ¸å¿ƒåœ°ä½ï¼Œå­˜åœ¨ä¸€å®šçš„è¢«æŠ•æ¯’é£Žé™©ï¼Œä¼°è®¡ä¸º10%ã€‚æ¼æ´žçš„åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…é€šè¿‡æž„é€ åŒ…å«æ¶æ„dataå±žæ€§çš„HTMLä»£ç ï¼Œåˆ©ç”¨XWikiçš„HTML sanitizerä¸­çš„æ¼æ´žï¼Œæ³¨å…¥æ¶æ„çš„JavaScriptä»£ç ã€‚å½“ç”¨æˆ·è®¿é—®åŒ…å«è¿™äº›æ¶æ„ä»£ç çš„é¡µé¢æ—¶ï¼ŒJavaScriptä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œä»Žè€Œå¯¼è‡´XSSæ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/cov-int](https://github.com/shoucheng3/cov-int)

**æ¼æ´žè¯¦æƒ…:** [CVE-2023-31126](https://nvd.nist.gov/vuln/detail/CVE-2023-31126)

---

## POC #2

**æ¥æº**: [CVE-2023-31126-shoucheng3_xwiki__xwiki-commons_CVE-2023-31126_14-10-3.md](../2023/CVE-2023-31126-shoucheng3_xwiki__xwiki-commons_CVE-2023-31126_14-10-3.md)

# CVE-2023-31126

> ðŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-31126-shoucheng3_cov-int.md](../2023/CVE-2023-31126-shoucheng3_cov-int.md)

## CVE-2023-31126-XWiki-XSS

**æ¼æ´žç¼–å·:** CVE-2023-31126

**æ¼æ´žç±»åž‹:** è·¨ç«™è„šæœ¬ (XSS)

**å½±å“åº”ç”¨:** XWiki

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æ”»å‡»è€…æ³¨å…¥ä»»æ„HTMLä»£ç ï¼Œä»Žè€Œæ‰§è¡Œæ¶æ„è„šæœ¬ã€çªƒå–ç”¨æˆ·æ•°æ®æˆ–ç¯¡æ”¹é¡µé¢å†…å®¹ã€‚

**å½±å“ç‰ˆæœ¬:** >= 14.6-rc-1, < 14.10.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·äº¤äº’ï¼ˆä¾‹å¦‚ï¼Œç‚¹å‡»æ¶æ„é“¾æŽ¥æˆ–è®¿é—®è¢«ç¯¡æ”¹çš„é¡µé¢ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2023-31126æ˜¯XWikiä¸­org.xwiki.commons:xwiki-commons-xmlåº“å­˜åœ¨çš„ä¸€ä¸ªæ¼æ´žã€‚è¯¥æ¼æ´žæºäºŽHTML sanitizerå¯¹dataå±žæ€§åç§°ä¸­æ— æ•ˆå­—ç¬¦çš„å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´žæ³¨å…¥ä»»æ„HTMLä»£ç ï¼Œä»Žè€Œå¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ã€‚ä»Žæœç´¢ç»“æžœæ¥çœ‹ï¼Œå¤šä¸ªç½‘ç«™éƒ½æåˆ°äº†è¯¥æ¼æ´žçš„ä¸¥é‡æ€§ä»¥åŠéœ€è¦ç”¨æˆ·äº¤äº’ã€‚æ¼æ´žåˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªJenkinsfileï¼Œç”¨äºŽæž„å»ºXWiki Commonsã€‚æ­¤Jenkinsfileæœ¬èº«å¹¶æ²¡æœ‰ç›´æŽ¥ä½“çŽ°XSSåˆ©ç”¨ä»£ç ï¼Œä½†å®ƒè´Ÿè´£æž„å»ºå­˜åœ¨æ¼æ´žçš„ç»„ä»¶ï¼Œå› æ­¤é—´æŽ¥ä¸Žæ¼æ´žç›¸å…³ã€‚æŠ•æ¯’é£Žé™©è¯„ä¼°ï¼šè™½ç„¶Jenkinsfileæœ¬èº«ä¸»è¦ç”¨äºŽæž„å»ºå’Œæµ‹è¯•ï¼Œä½†å®ƒä¹Ÿå¯èƒ½åŒ…å«ä¸€äº›éšè—çš„æ¶æ„ä»£ç ï¼Œæ¯”å¦‚åœ¨æž„å»ºè¿‡ç¨‹ä¸­ä¸‹è½½æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œæˆ–è€…ä¿®æ”¹æž„å»ºåŽçš„å·¥ä»¶ã€‚ è€ƒè™‘åˆ°Jenkinsfileçš„å¤æ‚æ€§ï¼Œä»¥åŠå®ƒåœ¨è‡ªåŠ¨åŒ–æž„å»ºè¿‡ç¨‹ä¸­çš„æ ¸å¿ƒåœ°ä½ï¼Œå­˜åœ¨ä¸€å®šçš„è¢«æŠ•æ¯’é£Žé™©ï¼Œä¼°è®¡ä¸º10%ã€‚æ¼æ´žçš„åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…é€šè¿‡æž„é€ åŒ…å«æ¶æ„dataå±žæ€§çš„HTMLä»£ç ï¼Œåˆ©ç”¨XWikiçš„HTML sanitizerä¸­çš„æ¼æ´žï¼Œæ³¨å…¥æ¶æ„çš„JavaScriptä»£ç ã€‚å½“ç”¨æˆ·è®¿é—®åŒ…å«è¿™äº›æ¶æ„ä»£ç çš„é¡µé¢æ—¶ï¼ŒJavaScriptä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œä»Žè€Œå¯¼è‡´XSSæ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/cov-int](https://github.com/shoucheng3/cov-int)

**æ¼æ´žè¯¦æƒ…:** [CVE-2023-31126](https://nvd.nist.gov/vuln/detail/CVE-2023-31126)

---

## POC #2

**æ¥æº**: [CVE-2023-31126-shoucheng3_xwiki__xwiki-commons_CVE-2023-31126_14-10-3.md](../2023/CVE-2023-31126-shoucheng3_xwiki__xwiki-commons_CVE-2023-31126_14-10-3.md)

# CVE-2023-31126

> ðŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-31126-shoucheng3_cov-int.md](../2023/CVE-2023-31126-shoucheng3_cov-int.md)

## CVE-2023-31126-XWiki-XSS

**æ¼æ´žç¼–å·:** CVE-2023-31126

**æ¼æ´žç±»åž‹:** è·¨ç«™è„šæœ¬ (XSS)

**å½±å“åº”ç”¨:** XWiki

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æ”»å‡»è€…æ³¨å…¥ä»»æ„HTMLä»£ç ï¼Œä»Žè€Œæ‰§è¡Œæ¶æ„è„šæœ¬ã€çªƒå–ç”¨æˆ·æ•°æ®æˆ–ç¯¡æ”¹é¡µé¢å†…å®¹ã€‚

**å½±å“ç‰ˆæœ¬:** >= 14.6-rc-1, < 14.10.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·äº¤äº’ï¼ˆä¾‹å¦‚ï¼Œç‚¹å‡»æ¶æ„é“¾æŽ¥æˆ–è®¿é—®è¢«ç¯¡æ”¹çš„é¡µé¢ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2023-31126æ˜¯XWikiä¸­org.xwiki.commons:xwiki-commons-xmlåº“å­˜åœ¨çš„ä¸€ä¸ªæ¼æ´žã€‚è¯¥æ¼æ´žæºäºŽHTML sanitizerå¯¹dataå±žæ€§åç§°ä¸­æ— æ•ˆå­—ç¬¦çš„å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´žæ³¨å…¥ä»»æ„HTMLä»£ç ï¼Œä»Žè€Œå¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ã€‚ä»Žæœç´¢ç»“æžœæ¥çœ‹ï¼Œå¤šä¸ªç½‘ç«™éƒ½æåˆ°äº†è¯¥æ¼æ´žçš„ä¸¥é‡æ€§ä»¥åŠéœ€è¦ç”¨æˆ·äº¤äº’ã€‚æ¼æ´žåˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªJenkinsfileï¼Œç”¨äºŽæž„å»ºXWiki Commonsã€‚æ­¤Jenkinsfileæœ¬èº«å¹¶æ²¡æœ‰ç›´æŽ¥ä½“çŽ°XSSåˆ©ç”¨ä»£ç ï¼Œä½†å®ƒè´Ÿè´£æž„å»ºå­˜åœ¨æ¼æ´žçš„ç»„ä»¶ï¼Œå› æ­¤é—´æŽ¥ä¸Žæ¼æ´žç›¸å…³ã€‚æŠ•æ¯’é£Žé™©è¯„ä¼°ï¼šè™½ç„¶Jenkinsfileæœ¬èº«ä¸»è¦ç”¨äºŽæž„å»ºå’Œæµ‹è¯•ï¼Œä½†å®ƒä¹Ÿå¯èƒ½åŒ…å«ä¸€äº›éšè—çš„æ¶æ„ä»£ç ï¼Œæ¯”å¦‚åœ¨æž„å»ºè¿‡ç¨‹ä¸­ä¸‹è½½æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œæˆ–è€…ä¿®æ”¹æž„å»ºåŽçš„å·¥ä»¶ã€‚ è€ƒè™‘åˆ°Jenkinsfileçš„å¤æ‚æ€§ï¼Œä»¥åŠå®ƒåœ¨è‡ªåŠ¨åŒ–æž„å»ºè¿‡ç¨‹ä¸­çš„æ ¸å¿ƒåœ°ä½ï¼Œå­˜åœ¨ä¸€å®šçš„è¢«æŠ•æ¯’é£Žé™©ï¼Œä¼°è®¡ä¸º10%ã€‚æ¼æ´žçš„åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…é€šè¿‡æž„é€ åŒ…å«æ¶æ„dataå±žæ€§çš„HTMLä»£ç ï¼Œåˆ©ç”¨XWikiçš„HTML sanitizerä¸­çš„æ¼æ´žï¼Œæ³¨å…¥æ¶æ„çš„JavaScriptä»£ç ã€‚å½“ç”¨æˆ·è®¿é—®åŒ…å«è¿™äº›æ¶æ„ä»£ç çš„é¡µé¢æ—¶ï¼ŒJavaScriptä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œä»Žè€Œå¯¼è‡´XSSæ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/cov-int](https://github.com/shoucheng3/cov-int)

**æ¼æ´žè¯¦æƒ…:** [CVE-2023-31126](https://nvd.nist.gov/vuln/detail/CVE-2023-31126)

---

## POC #2

**æ¥æº**: [CVE-2023-31126-shoucheng3_xwiki__xwiki-commons_CVE-2023-31126_14-10-3.md](../2023/CVE-2023-31126-shoucheng3_xwiki__xwiki-commons_CVE-2023-31126_14-10-3.md)

# CVE-2023-31126

> ðŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-31126-shoucheng3_cov-int.md](../2023/CVE-2023-31126-shoucheng3_cov-int.md)

## CVE-2023-31126-XWiki-XSS

**æ¼æ´žç¼–å·:** CVE-2023-31126

**æ¼æ´žç±»åž‹:** è·¨ç«™è„šæœ¬ (XSS)

**å½±å“åº”ç”¨:** XWiki

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æ”»å‡»è€…æ³¨å…¥ä»»æ„HTMLä»£ç ï¼Œä»Žè€Œæ‰§è¡Œæ¶æ„è„šæœ¬ã€çªƒå–ç”¨æˆ·æ•°æ®æˆ–ç¯¡æ”¹é¡µé¢å†…å®¹ã€‚

**å½±å“ç‰ˆæœ¬:** >= 14.6-rc-1, < 14.10.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·äº¤äº’ï¼ˆä¾‹å¦‚ï¼Œç‚¹å‡»æ¶æ„é“¾æŽ¥æˆ–è®¿é—®è¢«ç¯¡æ”¹çš„é¡µé¢ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2023-31126æ˜¯XWikiä¸­org.xwiki.commons:xwiki-commons-xmlåº“å­˜åœ¨çš„ä¸€ä¸ªæ¼æ´žã€‚è¯¥æ¼æ´žæºäºŽHTML sanitizerå¯¹dataå±žæ€§åç§°ä¸­æ— æ•ˆå­—ç¬¦çš„å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´žæ³¨å…¥ä»»æ„HTMLä»£ç ï¼Œä»Žè€Œå¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ã€‚ä»Žæœç´¢ç»“æžœæ¥çœ‹ï¼Œå¤šä¸ªç½‘ç«™éƒ½æåˆ°äº†è¯¥æ¼æ´žçš„ä¸¥é‡æ€§ä»¥åŠéœ€è¦ç”¨æˆ·äº¤äº’ã€‚æ¼æ´žåˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªJenkinsfileï¼Œç”¨äºŽæž„å»ºXWiki Commonsã€‚æ­¤Jenkinsfileæœ¬èº«å¹¶æ²¡æœ‰ç›´æŽ¥ä½“çŽ°XSSåˆ©ç”¨ä»£ç ï¼Œä½†å®ƒè´Ÿè´£æž„å»ºå­˜åœ¨æ¼æ´žçš„ç»„ä»¶ï¼Œå› æ­¤é—´æŽ¥ä¸Žæ¼æ´žç›¸å…³ã€‚æŠ•æ¯’é£Žé™©è¯„ä¼°ï¼šè™½ç„¶Jenkinsfileæœ¬èº«ä¸»è¦ç”¨äºŽæž„å»ºå’Œæµ‹è¯•ï¼Œä½†å®ƒä¹Ÿå¯èƒ½åŒ…å«ä¸€äº›éšè—çš„æ¶æ„ä»£ç ï¼Œæ¯”å¦‚åœ¨æž„å»ºè¿‡ç¨‹ä¸­ä¸‹è½½æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œæˆ–è€…ä¿®æ”¹æž„å»ºåŽçš„å·¥ä»¶ã€‚ è€ƒè™‘åˆ°Jenkinsfileçš„å¤æ‚æ€§ï¼Œä»¥åŠå®ƒåœ¨è‡ªåŠ¨åŒ–æž„å»ºè¿‡ç¨‹ä¸­çš„æ ¸å¿ƒåœ°ä½ï¼Œå­˜åœ¨ä¸€å®šçš„è¢«æŠ•æ¯’é£Žé™©ï¼Œä¼°è®¡ä¸º10%ã€‚æ¼æ´žçš„åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…é€šè¿‡æž„é€ åŒ…å«æ¶æ„dataå±žæ€§çš„HTMLä»£ç ï¼Œåˆ©ç”¨XWikiçš„HTML sanitizerä¸­çš„æ¼æ´žï¼Œæ³¨å…¥æ¶æ„çš„JavaScriptä»£ç ã€‚å½“ç”¨æˆ·è®¿é—®åŒ…å«è¿™äº›æ¶æ„ä»£ç çš„é¡µé¢æ—¶ï¼ŒJavaScriptä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œä»Žè€Œå¯¼è‡´XSSæ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/cov-int](https://github.com/shoucheng3/cov-int)

**æ¼æ´žè¯¦æƒ…:** [CVE-2023-31126](https://nvd.nist.gov/vuln/detail/CVE-2023-31126)

---

## POC #2

**æ¥æº**: [CVE-2023-31126-shoucheng3_xwiki__xwiki-commons_CVE-2023-31126_14-10-3.md](../2023/CVE-2023-31126-shoucheng3_xwiki__xwiki-commons_CVE-2023-31126_14-10-3.md)

# CVE-2023-31126

> ðŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-31126-shoucheng3_cov-int.md](../2023/CVE-2023-31126-shoucheng3_cov-int.md)

## CVE-2023-31126-XWiki-XSS

**æ¼æ´žç¼–å·:** CVE-2023-31126

**æ¼æ´žç±»åž‹:** è·¨ç«™è„šæœ¬ (XSS)

**å½±å“åº”ç”¨:** XWiki

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æ”»å‡»è€…æ³¨å…¥ä»»æ„HTMLä»£ç ï¼Œä»Žè€Œæ‰§è¡Œæ¶æ„è„šæœ¬ã€çªƒå–ç”¨æˆ·æ•°æ®æˆ–ç¯¡æ”¹é¡µé¢å†…å®¹ã€‚

**å½±å“ç‰ˆæœ¬:** >= 14.6-rc-1, < 14.10.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·äº¤äº’ï¼ˆä¾‹å¦‚ï¼Œç‚¹å‡»æ¶æ„é“¾æŽ¥æˆ–è®¿é—®è¢«ç¯¡æ”¹çš„é¡µé¢ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2023-31126æ˜¯XWikiä¸­org.xwiki.commons:xwiki-commons-xmlåº“å­˜åœ¨çš„ä¸€ä¸ªæ¼æ´žã€‚è¯¥æ¼æ´žæºäºŽHTML sanitizerå¯¹dataå±žæ€§åç§°ä¸­æ— æ•ˆå­—ç¬¦çš„å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´žæ³¨å…¥ä»»æ„HTMLä»£ç ï¼Œä»Žè€Œå¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ã€‚ä»Žæœç´¢ç»“æžœæ¥çœ‹ï¼Œå¤šä¸ªç½‘ç«™éƒ½æåˆ°äº†è¯¥æ¼æ´žçš„ä¸¥é‡æ€§ä»¥åŠéœ€è¦ç”¨æˆ·äº¤äº’ã€‚æ¼æ´žåˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªJenkinsfileï¼Œç”¨äºŽæž„å»ºXWiki Commonsã€‚æ­¤Jenkinsfileæœ¬èº«å¹¶æ²¡æœ‰ç›´æŽ¥ä½“çŽ°XSSåˆ©ç”¨ä»£ç ï¼Œä½†å®ƒè´Ÿè´£æž„å»ºå­˜åœ¨æ¼æ´žçš„ç»„ä»¶ï¼Œå› æ­¤é—´æŽ¥ä¸Žæ¼æ´žç›¸å…³ã€‚æŠ•æ¯’é£Žé™©è¯„ä¼°ï¼šè™½ç„¶Jenkinsfileæœ¬èº«ä¸»è¦ç”¨äºŽæž„å»ºå’Œæµ‹è¯•ï¼Œä½†å®ƒä¹Ÿå¯èƒ½åŒ…å«ä¸€äº›éšè—çš„æ¶æ„ä»£ç ï¼Œæ¯”å¦‚åœ¨æž„å»ºè¿‡ç¨‹ä¸­ä¸‹è½½æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œæˆ–è€…ä¿®æ”¹æž„å»ºåŽçš„å·¥ä»¶ã€‚ è€ƒè™‘åˆ°Jenkinsfileçš„å¤æ‚æ€§ï¼Œä»¥åŠå®ƒåœ¨è‡ªåŠ¨åŒ–æž„å»ºè¿‡ç¨‹ä¸­çš„æ ¸å¿ƒåœ°ä½ï¼Œå­˜åœ¨ä¸€å®šçš„è¢«æŠ•æ¯’é£Žé™©ï¼Œä¼°è®¡ä¸º10%ã€‚æ¼æ´žçš„åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…é€šè¿‡æž„é€ åŒ…å«æ¶æ„dataå±žæ€§çš„HTMLä»£ç ï¼Œåˆ©ç”¨XWikiçš„HTML sanitizerä¸­çš„æ¼æ´žï¼Œæ³¨å…¥æ¶æ„çš„JavaScriptä»£ç ã€‚å½“ç”¨æˆ·è®¿é—®åŒ…å«è¿™äº›æ¶æ„ä»£ç çš„é¡µé¢æ—¶ï¼ŒJavaScriptä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œä»Žè€Œå¯¼è‡´XSSæ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/cov-int](https://github.com/shoucheng3/cov-int)

**æ¼æ´žè¯¦æƒ…:** [CVE-2023-31126](https://nvd.nist.gov/vuln/detail/CVE-2023-31126)

---

## POC #2

**æ¥æº**: [CVE-2023-31126-shoucheng3_xwiki__xwiki-commons_CVE-2023-31126_14-10-3.md](../2023/CVE-2023-31126-shoucheng3_xwiki__xwiki-commons_CVE-2023-31126_14-10-3.md)

# CVE-2023-31126

> ðŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-31126-shoucheng3_cov-int.md](../2023/CVE-2023-31126-shoucheng3_cov-int.md)

## CVE-2023-31126-XWiki-XSS

**æ¼æ´žç¼–å·:** CVE-2023-31126

**æ¼æ´žç±»åž‹:** è·¨ç«™è„šæœ¬ (XSS)

**å½±å“åº”ç”¨:** XWiki

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æ”»å‡»è€…æ³¨å…¥ä»»æ„HTMLä»£ç ï¼Œä»Žè€Œæ‰§è¡Œæ¶æ„è„šæœ¬ã€çªƒå–ç”¨æˆ·æ•°æ®æˆ–ç¯¡æ”¹é¡µé¢å†…å®¹ã€‚

**å½±å“ç‰ˆæœ¬:** >= 14.6-rc-1, < 14.10.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·äº¤äº’ï¼ˆä¾‹å¦‚ï¼Œç‚¹å‡»æ¶æ„é“¾æŽ¥æˆ–è®¿é—®è¢«ç¯¡æ”¹çš„é¡µé¢ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2023-31126æ˜¯XWikiä¸­org.xwiki.commons:xwiki-commons-xmlåº“å­˜åœ¨çš„ä¸€ä¸ªæ¼æ´žã€‚è¯¥æ¼æ´žæºäºŽHTML sanitizerå¯¹dataå±žæ€§åç§°ä¸­æ— æ•ˆå­—ç¬¦çš„å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´žæ³¨å…¥ä»»æ„HTMLä»£ç ï¼Œä»Žè€Œå¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ã€‚ä»Žæœç´¢ç»“æžœæ¥çœ‹ï¼Œå¤šä¸ªç½‘ç«™éƒ½æåˆ°äº†è¯¥æ¼æ´žçš„ä¸¥é‡æ€§ä»¥åŠéœ€è¦ç”¨æˆ·äº¤äº’ã€‚æ¼æ´žåˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªJenkinsfileï¼Œç”¨äºŽæž„å»ºXWiki Commonsã€‚æ­¤Jenkinsfileæœ¬èº«å¹¶æ²¡æœ‰ç›´æŽ¥ä½“çŽ°XSSåˆ©ç”¨ä»£ç ï¼Œä½†å®ƒè´Ÿè´£æž„å»ºå­˜åœ¨æ¼æ´žçš„ç»„ä»¶ï¼Œå› æ­¤é—´æŽ¥ä¸Žæ¼æ´žç›¸å…³ã€‚æŠ•æ¯’é£Žé™©è¯„ä¼°ï¼šè™½ç„¶Jenkinsfileæœ¬èº«ä¸»è¦ç”¨äºŽæž„å»ºå’Œæµ‹è¯•ï¼Œä½†å®ƒä¹Ÿå¯èƒ½åŒ…å«ä¸€äº›éšè—çš„æ¶æ„ä»£ç ï¼Œæ¯”å¦‚åœ¨æž„å»ºè¿‡ç¨‹ä¸­ä¸‹è½½æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œæˆ–è€…ä¿®æ”¹æž„å»ºåŽçš„å·¥ä»¶ã€‚ è€ƒè™‘åˆ°Jenkinsfileçš„å¤æ‚æ€§ï¼Œä»¥åŠå®ƒåœ¨è‡ªåŠ¨åŒ–æž„å»ºè¿‡ç¨‹ä¸­çš„æ ¸å¿ƒåœ°ä½ï¼Œå­˜åœ¨ä¸€å®šçš„è¢«æŠ•æ¯’é£Žé™©ï¼Œä¼°è®¡ä¸º10%ã€‚æ¼æ´žçš„åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…é€šè¿‡æž„é€ åŒ…å«æ¶æ„dataå±žæ€§çš„HTMLä»£ç ï¼Œåˆ©ç”¨XWikiçš„HTML sanitizerä¸­çš„æ¼æ´žï¼Œæ³¨å…¥æ¶æ„çš„JavaScriptä»£ç ã€‚å½“ç”¨æˆ·è®¿é—®åŒ…å«è¿™äº›æ¶æ„ä»£ç çš„é¡µé¢æ—¶ï¼ŒJavaScriptä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œä»Žè€Œå¯¼è‡´XSSæ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/cov-int](https://github.com/shoucheng3/cov-int)

**æ¼æ´žè¯¦æƒ…:** [CVE-2023-31126](https://nvd.nist.gov/vuln/detail/CVE-2023-31126)

---

## POC #2

**æ¥æº**: [CVE-2023-31126-shoucheng3_xwiki__xwiki-commons_CVE-2023-31126_14-10-3.md](../2023/CVE-2023-31126-shoucheng3_xwiki__xwiki-commons_CVE-2023-31126_14-10-3.md)

# CVE-2023-31126

> ðŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-31126-shoucheng3_cov-int.md](../2023/CVE-2023-31126-shoucheng3_cov-int.md)

## CVE-2023-31126-XWiki-XSS

**æ¼æ´žç¼–å·:** CVE-2023-31126

**æ¼æ´žç±»åž‹:** è·¨ç«™è„šæœ¬ (XSS)

**å½±å“åº”ç”¨:** XWiki

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æ”»å‡»è€…æ³¨å…¥ä»»æ„HTMLä»£ç ï¼Œä»Žè€Œæ‰§è¡Œæ¶æ„è„šæœ¬ã€çªƒå–ç”¨æˆ·æ•°æ®æˆ–ç¯¡æ”¹é¡µé¢å†…å®¹ã€‚

**å½±å“ç‰ˆæœ¬:** >= 14.6-rc-1, < 14.10.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·äº¤äº’ï¼ˆä¾‹å¦‚ï¼Œç‚¹å‡»æ¶æ„é“¾æŽ¥æˆ–è®¿é—®è¢«ç¯¡æ”¹çš„é¡µé¢ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2023-31126æ˜¯XWikiä¸­org.xwiki.commons:xwiki-commons-xmlåº“å­˜åœ¨çš„ä¸€ä¸ªæ¼æ´žã€‚è¯¥æ¼æ´žæºäºŽHTML sanitizerå¯¹dataå±žæ€§åç§°ä¸­æ— æ•ˆå­—ç¬¦çš„å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´žæ³¨å…¥ä»»æ„HTMLä»£ç ï¼Œä»Žè€Œå¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ã€‚ä»Žæœç´¢ç»“æžœæ¥çœ‹ï¼Œå¤šä¸ªç½‘ç«™éƒ½æåˆ°äº†è¯¥æ¼æ´žçš„ä¸¥é‡æ€§ä»¥åŠéœ€è¦ç”¨æˆ·äº¤äº’ã€‚æ¼æ´žåˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªJenkinsfileï¼Œç”¨äºŽæž„å»ºXWiki Commonsã€‚æ­¤Jenkinsfileæœ¬èº«å¹¶æ²¡æœ‰ç›´æŽ¥ä½“çŽ°XSSåˆ©ç”¨ä»£ç ï¼Œä½†å®ƒè´Ÿè´£æž„å»ºå­˜åœ¨æ¼æ´žçš„ç»„ä»¶ï¼Œå› æ­¤é—´æŽ¥ä¸Žæ¼æ´žç›¸å…³ã€‚æŠ•æ¯’é£Žé™©è¯„ä¼°ï¼šè™½ç„¶Jenkinsfileæœ¬èº«ä¸»è¦ç”¨äºŽæž„å»ºå’Œæµ‹è¯•ï¼Œä½†å®ƒä¹Ÿå¯èƒ½åŒ…å«ä¸€äº›éšè—çš„æ¶æ„ä»£ç ï¼Œæ¯”å¦‚åœ¨æž„å»ºè¿‡ç¨‹ä¸­ä¸‹è½½æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œæˆ–è€…ä¿®æ”¹æž„å»ºåŽçš„å·¥ä»¶ã€‚ è€ƒè™‘åˆ°Jenkinsfileçš„å¤æ‚æ€§ï¼Œä»¥åŠå®ƒåœ¨è‡ªåŠ¨åŒ–æž„å»ºè¿‡ç¨‹ä¸­çš„æ ¸å¿ƒåœ°ä½ï¼Œå­˜åœ¨ä¸€å®šçš„è¢«æŠ•æ¯’é£Žé™©ï¼Œä¼°è®¡ä¸º10%ã€‚æ¼æ´žçš„åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…é€šè¿‡æž„é€ åŒ…å«æ¶æ„dataå±žæ€§çš„HTMLä»£ç ï¼Œåˆ©ç”¨XWikiçš„HTML sanitizerä¸­çš„æ¼æ´žï¼Œæ³¨å…¥æ¶æ„çš„JavaScriptä»£ç ã€‚å½“ç”¨æˆ·è®¿é—®åŒ…å«è¿™äº›æ¶æ„ä»£ç çš„é¡µé¢æ—¶ï¼ŒJavaScriptä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œä»Žè€Œå¯¼è‡´XSSæ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/cov-int](https://github.com/shoucheng3/cov-int)

**æ¼æ´žè¯¦æƒ…:** [CVE-2023-31126](https://nvd.nist.gov/vuln/detail/CVE-2023-31126)

---

## POC #2

**æ¥æº**: [CVE-2023-31126-shoucheng3_xwiki__xwiki-commons_CVE-2023-31126_14-10-3.md](../2023/CVE-2023-31126-shoucheng3_xwiki__xwiki-commons_CVE-2023-31126_14-10-3.md)

## CVE-2023-31126-XWiki-XSS

**æ¼æ´žç¼–å·:** CVE-2023-31126

**æ¼æ´žç±»åž‹:** è·¨ç«™è„šæœ¬ (XSS)

**å½±å“åº”ç”¨:** XWiki

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æ”»å‡»è€…æ³¨å…¥ä»»æ„HTMLä»£ç ï¼Œä»Žè€Œæ‰§è¡Œæ¶æ„è„šæœ¬ã€çªƒå–ç”¨æˆ·æ•°æ®æˆ–ç¯¡æ”¹é¡µé¢å†…å®¹ã€‚

**å½±å“ç‰ˆæœ¬:** >= 14.6-rc-1, < 14.10.4

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·äº¤äº’ï¼ˆä¾‹å¦‚ï¼Œç‚¹å‡»æ¶æ„é“¾æŽ¥æˆ–è®¿é—®è¢«ç¯¡æ”¹çš„é¡µé¢ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2023-31126æ˜¯XWikiä¸­org.xwiki.commons:xwiki-commons-xmlåº“å­˜åœ¨çš„ä¸€ä¸ªæ¼æ´žã€‚è¯¥æ¼æ´žæºäºŽHTML sanitizerå¯¹dataå±žæ€§åç§°ä¸­æ— æ•ˆå­—ç¬¦çš„å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´žæ³¨å…¥ä»»æ„HTMLä»£ç ï¼Œä»Žè€Œå¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ã€‚ä»Žæœç´¢ç»“æžœæ¥çœ‹ï¼Œå¤šä¸ªç½‘ç«™éƒ½æåˆ°äº†è¯¥æ¼æ´žçš„ä¸¥é‡æ€§ä»¥åŠéœ€è¦ç”¨æˆ·äº¤äº’ã€‚æ¼æ´žåˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªJenkinsfileï¼Œç”¨äºŽæž„å»ºXWiki Commonsã€‚æ­¤Jenkinsfileæœ¬èº«å¹¶æ²¡æœ‰ç›´æŽ¥ä½“çŽ°XSSåˆ©ç”¨ä»£ç ï¼Œä½†å®ƒè´Ÿè´£æž„å»ºå­˜åœ¨æ¼æ´žçš„ç»„ä»¶ï¼Œå› æ­¤é—´æŽ¥ä¸Žæ¼æ´žç›¸å…³ã€‚æŠ•æ¯’é£Žé™©è¯„ä¼°ï¼šè™½ç„¶Jenkinsfileæœ¬èº«ä¸»è¦ç”¨äºŽæž„å»ºå’Œæµ‹è¯•ï¼Œä½†å®ƒä¹Ÿå¯èƒ½åŒ…å«ä¸€äº›éšè—çš„æ¶æ„ä»£ç ï¼Œæ¯”å¦‚åœ¨æž„å»ºè¿‡ç¨‹ä¸­ä¸‹è½½æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œæˆ–è€…ä¿®æ”¹æž„å»ºåŽçš„å·¥ä»¶ã€‚ è€ƒè™‘åˆ°Jenkinsfileçš„å¤æ‚æ€§ï¼Œä»¥åŠå®ƒåœ¨è‡ªåŠ¨åŒ–æž„å»ºè¿‡ç¨‹ä¸­çš„æ ¸å¿ƒåœ°ä½ï¼Œå­˜åœ¨ä¸€å®šçš„è¢«æŠ•æ¯’é£Žé™©ï¼Œä¼°è®¡ä¸º10%ã€‚æ¼æ´žçš„åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…é€šè¿‡æž„é€ åŒ…å«æ¶æ„dataå±žæ€§çš„HTMLä»£ç ï¼Œåˆ©ç”¨XWikiçš„HTML sanitizerä¸­çš„æ¼æ´žï¼Œæ³¨å…¥æ¶æ„çš„JavaScriptä»£ç ã€‚å½“ç”¨æˆ·è®¿é—®åŒ…å«è¿™äº›æ¶æ„ä»£ç çš„é¡µé¢æ—¶ï¼ŒJavaScriptä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œä»Žè€Œå¯¼è‡´XSSæ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/cov-int](https://github.com/shoucheng3/cov-int)

**æ¼æ´žè¯¦æƒ…:** [CVE-2023-31126](https://nvd.nist.gov/vuln/detail/CVE-2023-31126)

---



---



---



---



---



---



---



---



---



---



---



---



---

