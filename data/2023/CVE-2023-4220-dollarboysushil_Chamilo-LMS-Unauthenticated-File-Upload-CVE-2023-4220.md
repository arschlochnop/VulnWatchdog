## CVE-2023-4220 - Chamilo LMS RCE/文件上传漏洞

**漏洞编号:** CVE-2023-4220

**漏洞类型:** RCE/文件上传漏洞

**影响应用:** Chamilo LMS

**危害等级:** 高危

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** <= 1.11.24

**利用条件:** 无需身份验证，可从外部网络访问受影响的服务器路径

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：该漏洞源于Chamilo LMS的大文件上传功能模块`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。该文件在处理`post-unsupported`操作时，未能对上传文件的类型、扩展名或内容进行任何有效性校验，且上传后的文件被直接存储在Web根目录下的`/main/inc/lib/javascript/bigupload/files`目录中。根据提供的POC分析，攻击者仅需通过简单的curl命令，构造一个包含恶意PHP代码（如system、exec函数）的POST请求，即可成功将Webshell植入服务器。该POC不仅给出了明确的触发点，还详细展示了验证步骤，证明了漏洞的真实性和高度可利用性。由于上传路径固定且无需登录凭证，攻击者可以极低成本地实现RCE。利用步骤：1. 确认目标Chamilo LMS版本是否在受影响范围内（<=1.11.24）。2. 探测关键路径`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`是否存在。3. 在本地准备一个包含PHP后门指令的恶意文件，例如命名为`dollarboysushil.php`。4. 使用curl或其他HTTP工具向该PHP文件发起POST请求，参数名设为`bigUploadFile`，并附带`action=post-unsupported`查询参数。5. 访问`/main/inc/lib/javascript/bigupload/files/`目录，寻找并执行上传的文件。投毒风险分析：针对该POC的安全性审查显示，其核心逻辑使用了标准的curl命令进行文件上传，脚本内容清晰且透明，不包含混淆后的二进制代码、外部加密脚本拉取或异常的网络通信。POC中使用的测试负载为简单的`whoami`命令执行，属于良性的安全研究范畴。由于该POC直接以Markdown文档形式展示命令，而非提供复杂的自动化二进制执行文件，用户在复现时能清晰感知每一条指令的意图，因此投毒风险极低。该漏洞本身由于其利用的便捷性和极高的危害等级，已被多个漏洞平台收录，社区公开讨论程度高，通常这类公开文档形式的POC被用于投毒的概率较低，但防御者仍需警惕那些宣称是‘自动化利用脚本’但包含Base64编码或混淆逻辑的衍生工具。

**项目地址:** [https://github.com/dollarboysushil/Chamilo-LMS-Unauthenticated-File-Upload-](https://github.com/dollarboysushil/Chamilo-LMS-Unauthenticated-File-Upload-)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)
