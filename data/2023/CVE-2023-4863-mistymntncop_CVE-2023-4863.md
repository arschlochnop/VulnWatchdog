## CVE-2023-4863 - Google Chrome, libwebp, Microsoft Teams and other Chromium-based applications Heap Buffer Overflow / RCE

**漏洞编号:** CVE-2023-4863

**漏洞类型:** Heap Buffer Overflow / RCE

**影响应用:** Google Chrome, libwebp, Microsoft Teams and other Chromium-based applications

**危害等级:** Critical

**CVSS评分:** 8.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**影响版本:** Google Chrome prior to 116.0.5845.187, libwebp prior to 1.3.2

**利用条件:** 远程攻击者诱导用户访问恶意构造的网页或处理特制的WebP图像文件。

**POC 可用性:** 7/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该POC代码由@mistymtncop编写，基于Ben Hawkes的研究成果。代码核心逻辑在于构造特定的Huffman编码长度（code_lengths），旨在触发libwebp库在处理无损WebP图像时的堆缓冲区溢出漏洞。通过分析代码，可以看到其详细实现了VP8L（WebP无损格式）的位流构造，包括Huffman树的生成。POC代码中显式引用了Isosceles的博客文章和libwebp的补丁记录，证明其具有极高的技术参考价值。虽然该代码被作者标注为“NOT an exploit”，但它完整地演示了如何通过精心构造的Huffman表来引发内存越界写入。对于防御方而言，该POC可用于验证环境中libwebp库的脆弱性，以及测试端点防护产品是否能拦截恶意的图像位流。利用步骤：1. 编译提供的craft.c源文件；2. 运行生成程序，该程序会根据设定的Huffman编码参数输出一个损坏的WebP文件；3. 在受影响的浏览器或集成libwebp的应用程序中打开该文件；4. 观察系统崩溃或内存越界写入现象。投毒风险分析：该POC代码表现出较高的透明度，属于典型的安全研究产物。代码中包含了大量的学术和技术参考链接，逻辑清晰，使用了标准的C语言库（stdint, stdbool, stdio等），未发现明显的代码混淆、加密Payload或可疑的远程命令执行逻辑。README文件明确指出了其研究属性。代码中的'WebPSafeMalloc'被重定义为'calloc'，带有'lol'注释，显示了作者的非正式风格，而非恶意隐藏。由于该代码旨在生成一个崩溃触发器而非实现自动化的反弹Shell，因此直接被用于投毒攻击的可能性较低。然而，由于该漏洞影响范围极广（几乎所有现代浏览器），任何提供此类POC的仓库都可能吸引攻击者，因此在使用第三方分发的版本时仍需警惕是否被二次修改植入恶意下载器。当前代码本身风险等级评定为低（15%），主要风险点在于其作为高价值漏洞POC，容易成为钓鱼攻击的诱饵。

**项目地址:** [https://blog.isosceles.com/the-webp-0day/](https://blog.isosceles.com/the-webp-0day/)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2023-4863](https://nvd.nist.gov/vuln/detail/CVE-2023-4863)
