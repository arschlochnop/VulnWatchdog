## CVE-2023-4220 - Chamilo LMS 远程代码执行 (RCE)

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Chamilo LMS

**危害等级:** 高危 (Critical)

**CVSS评分:** 9.8

**影响版本:** < 1.11.24

**利用条件:** 无需身份验证，可直接通过网络访问受影响的 bigupload 组件

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：该POC代码针对Chamilo LMS中位于/main/inc/lib/javascript/bigupload/inc/bigUpload.php的文件上传漏洞进行了高度自动化的封装。漏洞核心在于该组件未能对上传文件的后缀和访问权限进行严格校验。POC通过requests库模拟HTTP请求，首先向目标路径上传一个包含Web Shell的PHP文件（如insomnia.php），随后通过HEAD请求确认文件是否成功落地。如果成功，POC将提供一个交互式的命令执行接口或直接执行预设指令。经分析，该代码逻辑严密，包含了环境检测、文件上传、后门验证以及清理建议。它利用了该漏洞无需认证即可访问上传目录的特性，攻击路径极短，属于典型的高效漏洞利用工具。对于防御方而言，该POC不仅证明了漏洞的存在，更直接揭示了攻击者如何绕过前端逻辑进入系统后端，具有极高的实战参考价值。利用步骤：1. 确认目标Chamilo LMS版本是否存在漏洞路径；2. 运行exploit.py并指定目标URL；3. 脚本自动上传Web Shell至bigupload/files目录下；4. 脚本验证Web Shell存活性；5. 通过URL访问上传的PHP文件以执行任意系统命令。投毒风险分析：经过对提供的Python源代码进行静态审计，未发现明显的投毒迹象或恶意混淆代码。脚本主要依赖标准库（argparse, requests, time, os, io）进行合法的HTTP交互。代码逻辑透明，开发者信息（Insomnia/Jacob S.）及社交平台链接完整，符合安全研究员公开发布POC的习惯。虽然脚本中包含了向作者个人网站和社交媒体的链接，但这属于正常的署名行为。风险点在于，该脚本具备全自动化的利用能力，若在未受控环境下运行，可能会导致目标系统权限丢失。脚本中没有发现Base64加密的恶意Payload回传或对运行环境（如执行机）进行敏感信息窃取的行为。因此，该POC被判定为低投毒风险。但在实际部署防御测试前，仍建议在隔离的沙箱环境中先行运行，并拦截脚本对外部非目标IP的异常外连请求，以防潜在的统计信息收集或二次感染风险。综上，此脚本是一个相对纯净且极具威胁性的漏洞利用工具，应作为重点防御对象进行特征提取。

**项目地址:** [https://github.com/insomnia-jacob](https://github.com/insomnia-jacob)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)
