# CVE-2023-23397

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-23397-Agentgilspy_CVE-2023-23397.md](../2023/CVE-2023-23397-Agentgilspy_CVE-2023-23397.md)

## CVE-2023-23397 - Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM哈希泄露，进而提升权限

**影响版本:** 受影响版本包括：Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise (详见漏洞库信息)

**利用条件:** 攻击者需要能够向受害者发送包含特制属性的邮件或日历邀请。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的电子邮件消息，特别是日历邀请，来利用此漏洞。该漏洞允许攻击者窃取受害者的 Net-NTLM 哈希。漏洞利用方式如下：

1.  **攻击者构建包含恶意`ReminderSoundFile`属性的日历邀请或邮件**。该属性指向攻击者控制的SMB服务器（例如 `\\192.168.1.7\nonexistent\sound.wav`）。
2.  **当Outlook客户端处理该邮件时**，即使受害者没有打开邮件，Outlook也会尝试访问该SMB共享以播放提醒声音。
3.  **此访问会触发NTLM身份验证**，将受害者的Net-NTLM哈希发送到攻击者的SMB服务器。
4.  **攻击者捕获Net-NTLM哈希**，并可以使用该哈希进行NTLM中继攻击或离线破解，从而冒充受害者。

**有效性：** 提供的PoC代码尝试通过创建一个新的日历邀请，设置`ReminderSoundFile`属性为攻击者控制的IP地址，并将该邀请发送给目标用户。该PoC代码是有效的，因为它模拟了攻击者可以利用此漏洞的方式。

**投毒风险：** 提供的代码仅包含用于演示漏洞的PoC代码和一个MIT许可协议。它旨在创建一个包含特定属性的Outlook日历项，该属性指向攻击者控制的服务器。没有发现任何作者隐藏的恶意或后门代码，因此投毒风险为0%。该LICENSE文件声明的Copyright (c) 2025 Gilchrist 也无实际意义，因为该漏洞在2023年就被披露。

**利用方式：** 漏洞的利用方式是通过构造包含恶意`ReminderSoundFile`属性的日历邀请或邮件，当受害者的Outlook客户端处理该邮件时，会自动向攻击者控制的SMB服务器发起NTLM认证，从而泄露受害者的Net-NTLM哈希。

**项目地址:** [Agentgilspy/CVE-2023-23397](https://github.com/Agentgilspy/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #2

**来源**: [CVE-2023-23397-AiK1d_CVE-2023-23397-POC.md](../2023/CVE-2023-23397-AiK1d_CVE-2023-23397-POC.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括 Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise 的特定版本。

**利用条件:** 攻击者需要能够发送包含恶意构造的邮件或日历邀请给受害者，受害者需要使用受影响的 Outlook 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的邮件，利用 `reminder_sound_file` 字段指定一个 UNC 路径，当 Outlook 客户端处理该邮件时，会尝试连接到指定的 UNC 路径，从而触发 NTLM 认证。攻击者可以捕获这个 NTLM hash 并进行中继攻击（NTLM Relay），从而冒充受害者的身份。

**有效性：**

提供的 POC 代码是有效的。该脚本会创建一个恶意的 appointment.msg 文件，其中 `reminder_sound_file` 设置为攻击者控制的 UNC 路径。然后，它通过 SMTP 发送包含此附件的电子邮件。当受害者打开电子邮件或 Outlook 处理该日历邀请时，会尝试访问 UNC 路径，从而泄露 NTLM hash。

**投毒风险：**

该仓库存在一定的投毒风险，约10%。

*   虽然核心 POC 代码的功能符合漏洞描述，但攻击者可以修改 `reminder_sound_file`  指向一个非预期的 SMB 服务器。如果攻击者控制的 SMB 服务器本身包含恶意代码，或者被用于投放恶意载荷，那么当受害者连接到该服务器时，可能受到进一步的攻击。例如，攻击者可以利用 Responder 等工具捕获 NTLM hash，然后使用该哈希执行其他攻击。
*   此外，代码中的 SMTP 服务器、用户名和密码为示例值，如果用户不修改这些值直接使用，会导致攻击失败或暴露攻击者信息。
*   README.md 文件比较简单，缺乏详细的漏洞描述和使用说明，可能导致用户误用或理解不足。

**利用方式：**

1.  攻击者构建一个恶意的 appointment.msg 文件，其中 `reminder_sound_file` 字段设置为攻击者控制的 UNC 路径，例如 `\\attacker.com\evilshare\sound.wav`。
2.  攻击者通过电子邮件将此恶意 appointment.msg 文件发送给受害者。
3.  受害者使用受影响的 Outlook 版本打开电子邮件或 Outlook 自动处理该日历邀请。
4.  Outlook 客户端尝试访问 `reminder_sound_file` 字段指定的 UNC 路径，从而向 `attacker.com` 发起 NTLM 认证。
5.  攻击者使用工具（例如 Responder）捕获 NTLM hash。
6.  攻击者使用捕获到的 NTLM hash 进行中继攻击，例如冒充受害者访问内部资源。

**项目地址:** [AiK1d/CVE-2023-23397-POC](https://github.com/AiK1d/CVE-2023-23397-POC)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #3

**来源**: [CVE-2023-23397-BillSkiCO_CVE-2023-23397_EXPLOIT.md](../2023/CVE-2023-23397-BillSkiCO_CVE-2023-23397_EXPLOIT.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise

**利用条件:** 攻击者需要向受害者发送特制的邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以利用此漏洞通过发送特制的邮件来窃取受害者的 Net-NTLM hash，从而冒充受害者身份并进行 NTLM 中继攻击。漏洞的根本原因是 Outlook 没有正确处理邮件中的特殊字段（主要是 `PidLidReminderFileParameter` 属性），导致 Outlook 尝试连接到攻击者控制的 UNC 路径，触发 NTLM 认证。由于 Outlook 在无需用户交互的情况下进行认证，因此攻击者可以在受害者不知情的情况下获取其 NTLM hash。

**利用方式：**

1.  攻击者创建一个包含恶意 `PidLidReminderFileParameter` 属性的特制邮件。该属性指向攻击者控制的 UNC 路径（例如 `\\attacker.com\share\file.wav`）。
2.  攻击者将该邮件发送给受害者。
3.  当 Outlook 处理该邮件时，它会尝试连接到攻击者控制的 UNC 路径，从而触发 NTLM 认证。
4.  攻击者捕获 NTLM hash 并使用它进行 NTLM 中继攻击。

**有效性：**

根据搜索结果，此漏洞已被广泛利用，并且 CISA 已将其添加到已知被利用的漏洞目录中。这表明存在可用的漏洞利用代码，并且该漏洞在野外被积极利用。

**投毒风险：**

提供的代码段是 Apache 2.0 许可协议，不是漏洞利用代码本身，因此无法从中分析是否存在投毒代码。考虑到这是一个许可协议，投毒的可能性极低。风险评估为0%。


**项目地址:** [BillSkiCO/CVE-2023-23397_EXPLOIT](https://github.com/BillSkiCO/CVE-2023-23397_EXPLOIT)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #4

**来源**: [CVE-2023-23397-BronzeBee_cve-2023-23397.md](../2023/CVE-2023-23397-BronzeBee_cve-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致Net-NTLM hash泄露和身份冒用

**影响版本:** 受影响版本包括：Microsoft Office LTSC 2021, Microsoft Outlook 2016, Microsoft 365 Apps for Enterprise, Microsoft Office 2019, Microsoft Outlook 2013 Service Pack 1。详细版本信息请参考漏洞库信息。

**利用条件:** 攻击者需要能够发送电子邮件给受害者。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-23397 是 Microsoft Outlook 中的一个权限提升漏洞。攻击者可以利用此漏洞窃取受害者的 Net-NTLM 哈希，从而冒充受害者的身份并进行进一步的攻击。漏洞的根源在于 Outlook 没有正确验证输入，攻击者可以通过在电子邮件中嵌入特制的 UNC 路径来触发漏洞。当 Outlook 处理包含恶意 UNC 路径的电子邮件时，它将尝试连接到该路径，并将用户的 Net-NTLM 哈希发送到攻击者控制的服务器。

**有效性评估：**
根据漏洞库信息和搜索结果，CVE-2023-23397 是一个已被积极利用的漏洞，并且CISA已将其添加到已知被利用的漏洞目录中。提供的漏洞利用代码似乎有效，因为它允许攻击者创建包含恶意 payload 的 TNEF 编码的 Outlook 电子邮件，并通过纯 SMTP 发送，从而触发 Net-NTLM 哈希的泄露。

**投毒风险评估：**
分析提供的POC代码，风险较低。代码主要功能是构造并发送包含漏洞触发payload的邮件。虽然任何代码都存在潜在的恶意修改可能，但该POC代码相对简单，主要利用了已知的漏洞。

**利用方式分析：**
1.  攻击者使用提供的 Python 脚本 (cve-2023-23397.py) 创建一个特制的 Outlook 电子邮件，其中包含一个指向攻击者控制的服务器的恶意 UNC 路径 (例如 \\10.10.10.10\share\1.wav)。这个 UNC 路径被嵌入到电子邮件的某个属性中，例如 `PidLidReminderOverride`。
2.  攻击者通过 SMTP 将此电子邮件发送给受害者。
3.  当受害者使用 Outlook 打开或预览该电子邮件时，Outlook 会尝试连接到恶意 UNC 路径，并自动向攻击者控制的服务器发送受害者的 Net-NTLM 哈希。
4.  攻击者可以使用捕获的 Net-NTLM 哈希进行 NTLM 中继攻击或其他身份验证攻击，从而提升权限并访问受害者的资源。

**缓解措施：**
*   及时安装 Microsoft 提供的安全更新以修复此漏洞。
*   阻止出站 SMB 流量（端口 445）以防止 Net-NTLM 哈希泄露。
*   配置 Outlook 以禁用自动身份验证到 UNC 路径。
*   监视网络流量以检测对外部 SMB 服务器的连接尝试。

**项目地址:** [BronzeBee/cve-2023-23397](https://github.com/BronzeBee/cve-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #5

**来源**: [CVE-2023-23397-Cyb3rMaddy_CVE-2023-23397-Report.md](../2023/CVE-2023-23397-Cyb3rMaddy_CVE-2023-23397-Report.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击，窃取用户身份

**影响版本:** 受影响版本见漏洞库信息

**利用条件:** 攻击者需要能够发送包含恶意扩展MAPI属性的邮件给受害者

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397是一个Microsoft Outlook中的权限提升漏洞。攻击者可以通过发送包含特定格式的扩展MAPI属性（包含指向攻击者控制的SMB服务器的UNC路径）的电子邮件来触发此漏洞。当Outlook处理该邮件时，会自动尝试连接到攻击者的SMB服务器，并将用户的NTLM哈希发送给攻击者。攻击者可以利用收到的NTLM哈希进行NTLM Relay攻击，冒充受害者访问网络资源或执行其他恶意操作。

**有效性：**
根据漏洞描述和搜索结果，POC代码有效。漏洞利用无需用户交互。

**投毒风险：**
POC代码本身是一个利用漏洞的演示，主要包含漏洞利用相关的说明文档。README.md 主要描述了漏洞原理和利用方法，本身不包含恶意代码。投毒风险较低，可能存在恶意作者在其他利用代码中加入后门的可能性，所以投毒风险估计为10%。

**利用方式：**
1.  攻击者构建包含恶意扩展MAPI属性的电子邮件。
2.  恶意MAPI属性包含指向攻击者控制的SMB服务器的UNC路径。
3.  受害者使用Outlook客户端接收并处理该邮件。
4.  Outlook客户端尝试连接到攻击者的SMB服务器。
5.  Outlook客户端将受害者的NTLM哈希发送到攻击者的SMB服务器。
6.  攻击者使用NTLM哈希进行NTLM Relay攻击。

**项目地址:** [Cyb3rMaddy/CVE-2023-23397-Report](https://github.com/Cyb3rMaddy/CVE-2023-23397-Report)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #6

**来源**: [CVE-2023-23397-Muhammad-Ali007_OutlookNTLM_CVE-2023-23397.md](../2023/CVE-2023-23397-Muhammad-Ali007_OutlookNTLM_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本：Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise（具体版本范围参考漏洞库信息）

**利用条件:** 攻击者需要发送特制的日历邀请或邮件，受害者使用受影响的Outlook版本查看邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397是一个Microsoft Outlook权限提升漏洞。攻击者可以通过发送包含指向远程SMB服务器（或其他支持NTLM认证的服务器，如WebDAV）的恶意UNC路径的日历邀请或邮件来利用此漏洞。当Outlook处理该邮件时，会尝试连接到远程服务器以获取声音文件（ReminderSoundFile），这会触发NTLM认证过程，将受害者的Net-NTLM hash发送到攻击者的服务器。攻击者可以利用获取的Net-NTLM hash进行NTLM Relay攻击或其他凭据破解尝试。

**有效性:** 提供的POC代码通过PowerShell脚本实现了发送或保存包含恶意`ReminderSoundFile`属性的日历邀请，该属性指向攻击者控制的远程文件服务器。因此，该POC代码是有效的。

**投毒风险:** 代码功能明确，旨在利用CVE-2023-23397漏洞，没有发现隐藏的恶意代码或后门。代码目的是为了验证漏洞，没有额外恶意行为。因此投毒风险评估为0%。

**利用方式:**
1.  攻击者创建一个恶意的日历邀请或邮件。
2.  攻击者在日历邀请或邮件的`ReminderSoundFile`属性中设置一个UNC路径，指向攻击者控制的远程服务器（例如，`\\attacker_ip\share\file.wav`）。
3.  攻击者将日历邀请或邮件发送给受害者。
4.  当受害者使用受影响的Outlook版本打开该日历邀请或邮件时，Outlook会尝试连接到攻击者的远程服务器以获取声音文件。
5.  Outlook的连接尝试会触发NTLM认证过程，将受害者的Net-NTLM hash发送到攻击者的服务器。
6.  攻击者捕获Net-NTLM hash，并尝试破解或进行NTLM Relay攻击。

**项目地址:** [Muhammad-Ali007/OutlookNTLM_CVE-2023-23397](https://github.com/Muhammad-Ali007/OutlookNTLM_CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #7

**来源**: [CVE-2023-23397-Pushkarup_CVE-2023-23397.md](../2023/CVE-2023-23397-Pushkarup_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击，控制受害者账户

**影响版本:** 受影响版本：Microsoft Outlook 2013 SP1, Outlook 2016, Outlook 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise (查看漏洞库信息中的详细版本范围)

**利用条件:** 攻击者需要知道目标用户的邮件地址，并能够发送邮件到目标用户的Outlook邮箱。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 中的权限提升漏洞。攻击者可以通过发送特制的电子邮件，在无需用户交互的情况下，强制 Outlook 客户端连接到攻击者控制的 SMB 服务器，从而窃取 Net-NTLMv2 哈希。利用方式如下：

1.  **漏洞原理：** Outlook 在处理邮件时，如果邮件中包含 `ReminderSoundFile` 属性指向 UNC 路径（例如 `\\attacker_ip\share\sound.wav`），Outlook 会尝试连接到该路径。该连接使用用户的 Windows 凭据进行身份验证，因此攻击者可以捕获 Net-NTLMv2 哈希。

2.  **PoC 代码分析：**  提供的 PoC 代码 `Exploit.py`  利用 `win32com.client` 库来创建包含恶意 `ReminderSoundFile` 属性的 Outlook 日程安排。脚本会要求攻击者输入目标电子邮件地址和攻击者的 IP 地址（c2，也就是接收哈希的服务器）。然后，它将 UNC 路径设置为 `\\attacker_ip`，并将其设置为 `ReminderSoundFile` 属性。该脚本可以选择将恶意邮件保存为 `.msg` 文件或直接发送。

3.  **有效性评估：** 结合漏洞库信息、搜索引擎结果和 PoC 代码，可以确定该 PoC 代码是有效的。该漏洞已经被广泛研究和利用，并且CISA的已知被利用漏洞目录中也包含了该漏洞。

4.  **投毒风险评估：**  
    *   PoC 代码的主要功能是生成利用 CVE-2023-23397 漏洞的恶意邮件。代码本身看起来比较直接，没有明显的恶意行为，例如安装后门或执行其他未声明的操作。
    *   风险点可能存在于攻击者提供的 `attacker_ip` 参数。如果攻击者控制了该 IP 地址，他们可以捕获 NTLM 哈希。但是，这属于漏洞本身的利用方式，而不是 PoC 代码的投毒行为。
    *   文件LICENSE和README.md没有发现异常
    综合考虑，PoC 代码本身存在作者隐藏的恶意代码的风险较低。但始终需要保持警惕，在运行 PoC 代码之前，应仔细检查代码，并在隔离环境中运行。

5.  **利用方式总结：**
    1.  攻击者构造包含恶意 `ReminderSoundFile` 属性的 Outlook 日程安排。
    2.  将该日程安排以邮件的形式发送给目标用户。
    3.  当目标用户在 Outlook 中打开该邮件时，Outlook 客户端会尝试连接到 `ReminderSoundFile` 属性指定的 UNC 路径。
    4.  攻击者监听 SMB 流量，捕获 Net-NTLMv2 哈希。
    5.  攻击者可以使用捕获的哈希进行 NTLM Relay 攻击或尝试破解哈希以获得用户密码。

**项目地址:** [Pushkarup/CVE-2023-23397](https://github.com/Pushkarup/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #8

**来源**: [CVE-2023-23397-SecCTechs_CVE-2023-23397.md](../2023/CVE-2023-23397-SecCTechs_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击，进而获取用户身份

**影响版本:** 受影响版本包括：Microsoft Outlook 2013 SP1, Outlook 2016, Outlook 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise等。

**利用条件:** 攻击者需要向受害者发送特制的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的邮件，在无需用户交互的情况下，迫使 Outlook 客户端连接到攻击者控制的服务器，从而窃取受害者的 Net-NTLM hash。 这使得攻击者能够冒充受害者身份，进行 NTLM Relay 攻击。

**漏洞利用方式:**
1.  攻击者构造包含恶意 `PidLidReminderFileParameter` 属性的邮件，此属性指向攻击者控制的 UNC 路径。
2.  受害者使用 Outlook 客户端打开或预览该邮件。
3.  Outlook 客户端尝试连接到指定的 UNC 路径，进行身份验证，将 Net-NTLM hash 发送给攻击者。
4.  攻击者利用窃取的 Net-NTLM hash 进行 NTLM Relay 攻击，例如冒充受害者访问网络资源。

**漏洞利用有效性：**
根据搜索结果和漏洞库信息，该漏洞已经被广泛利用，CISA 已经将其列入已知被利用漏洞目录。 漏洞利用的有效性很高，且利用难度相对较低。

**投毒风险：**
提供的漏洞利用代码仅包含 GNU GPL 许可协议，没有发现任何恶意代码。因此，投毒风险较低，评估为0%。但实际环境中利用此漏洞时，需要注意获取PoC代码的来源，确保其安全性。

**项目地址:** [SecCTechs/CVE-2023-23397](https://github.com/SecCTechs/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #9

**来源**: [CVE-2023-23397-Symbolexe_CVE-2023-23397.md](../2023/CVE-2023-23397-Symbolexe_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM relay攻击，获取用户身份

**影响版本:** 受影响版本包括Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise等，具体版本号请参考漏洞库信息。

**利用条件:** 攻击者需要向受害者发送特制的邮件，受害者无需交互，只需预览或打开邮件即可触发。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个存在于 Microsoft Outlook 中的权限提升漏洞。攻击者可以构造特殊的邮件，利用扩展 MAPI (Messaging Application Programming Interface)属性，特别是 `PidLidReminderFileParameter` 属性，指向一个攻击者控制的 UNC 路径。当 Outlook 处理这封邮件时（无需用户点击任何链接，预览或打开邮件即可），会尝试连接到该 UNC 路径，触发 NTLM 认证过程，从而将用户的 NTLM hash 发送到攻击者控制的服务器。攻击者可以通过 NTLM relay攻击冒充用户身份。

**漏洞利用方式：**
1.  攻击者构造包含恶意 `PidLidReminderFileParameter` 属性的邮件，该属性指向攻击者控制的 UNC 路径。
2.  攻击者向受害者发送邮件。
3.  受害者使用 Outlook 预览或打开邮件。
4.  Outlook 尝试连接到 UNC 路径，触发 NTLM 认证。
5.  攻击者捕获 NTLM hash 并利用它进行身份验证。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞已被广泛利用，因此可以判断POC代码是有效的。

**投毒风险：**
提供的POC代码仅包含LICENSE和README.md文件。README.md描述了漏洞原理和利用方法，没有发现明显的恶意代码。但是，实际的漏洞利用工具可能包含额外的功能（例如，自动化的 NTLM relay 攻击等），这些功能可能被滥用于恶意目的。因此，从仓库本身来看，投毒的概率较低，但使用未经审核的第三方工具仍然存在风险。所以投毒风险为10%。

**漏洞库信息摘要：**
*   漏洞类型：权限提升
*   CVSS 评分：9.8 (严重)
*   受影响产品：Microsoft Outlook
*   修复方案：安装 Microsoft 提供的安全更新

**搜索引擎结果摘要：**
*   CVE-2023-23397 已经被 CISA 列入已知被利用漏洞目录。
*   该漏洞允许攻击者窃取 Net-NTLM hash。
*   Microsoft 提供了检测脚本。
*   有针对该漏洞的攻击样本分析报告。

**项目地址:** [Symbolexe/CVE-2023-23397](https://github.com/Symbolexe/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #10

**来源**: [CVE-2023-23397-TheUnknownSoul_CVE-2023-23397-PoW.md](../2023/CVE-2023-23397-TheUnknownSoul_CVE-2023-23397-PoW.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致Net-NTLM哈希泄露，攻击者可冒充受害者身份。

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要能够发送电子邮件给受害者，并且受害者需要使用存在漏洞的Outlook客户端打开邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397是一个Microsoft Outlook权限提升漏洞。该漏洞的利用方式是攻击者发送一封特制的电子邮件，其中包含指向攻击者控制的SMB服务器的UNC路径，当受害者使用存在漏洞的Outlook客户端打开该邮件时，会自动尝试连接到该SMB服务器，并将受害者的Net-NTLM哈希发送给攻击者。攻击者可以使用该哈希进行NTLM中继攻击，从而冒充受害者的身份。

根据提供的漏洞利用代码，该代码通过Python脚本生成包含恶意音频文件链接的Outlook日历邀请（appointment）。当受害者打开该邀请时，Outlook会尝试访问该链接，从而触发NTLM认证并泄露哈希值。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开的PoC代码。因此，提供的PoC代码在一定条件下是有效的。

**投毒风险：**
提供的PoC代码中，主要操作是构造恶意的Outlook日历邀请并发送给目标用户。代码包含发送邮件功能，这需要配置SMTP服务器的地址、端口、用户名和密码。潜在的投毒风险在于：
1.  **SMTP服务器配置:** 如果攻击者诱导用户使用其控制的SMTP服务器，则可能拦截或篡改发送的邮件。
2.  **附件路径:**  `full_path = f'\\\{path}\sound.wav'` 这行代码定义了SMB共享的路径。攻击者可能尝试通过精心构造路径，执行其他恶意操作。例如，如果Outlook客户端对UNC路径处理不当，可能导致文件读取或执行。
3.  **依赖库安全:**  虽然代码本身相对简单，但需要依赖Python环境和第三方库，这些依赖库可能存在安全漏洞。检查库的完整性。

代码中存在使用恶意SMB共享的风险，该路径可能会包含恶意payload或引发其他问题。因此判定存在10%的投毒风险，主要集中在引导用户设置攻击者控制的SMB服务器以及SMTP服务器。

**利用方式：**
1.  攻击者设置一个SMB服务器，并放置一个任意的音频文件（例如sound.wav）。
2.  攻击者运行提供的Python脚本，指定SMB服务器的IP地址和一个包含目标邮箱地址的文本文件。
3.  脚本会构造包含指向SMB服务器上音频文件的日历邀请，并将其发送给目标邮箱。
4.  当目标用户使用存在漏洞的Outlook客户端打开该日历邀请时，Outlook会自动尝试连接到SMB服务器以下载音频文件。
5.  由于SMB协议的认证机制，Outlook会将目标用户的Net-NTLM哈希发送给SMB服务器。
6.  攻击者可以在SMB服务器上捕获该哈希，并使用其进行NTLM中继攻击或其他攻击。


**项目地址:** [TheUnknownSoul/CVE-2023-23397-PoW](https://github.com/TheUnknownSoul/CVE-2023-23397-PoW)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #11

**来源**: [CVE-2023-23397-Trackflaw_CVE-2023-23397.md](../2023/CVE-2023-23397-Trackflaw_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致Net-NTLM hash泄露，进而进行身份冒充和横向移动

**影响版本:** 受影响版本：Microsoft Outlook 2013 SP1, Outlook 2016, Outlook 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise。详见漏洞库信息中的cpeApplicability。

**利用条件:** 攻击者需要能够发送邮件给受害者。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞，攻击者通过构造包含指向恶意 SMB 服务器 UNC 路径的特殊邮件（例如，利用 `reminder_sound_file` 字段），当 Outlook 客户端处理该邮件时，会自动尝试通过 SMB 协议连接到攻击者的服务器，从而泄露受害者的 Net-NTLM hash。由于 Outlook 客户端会自动处理邮件，因此该漏洞是零点击漏洞。

**漏洞利用方式：**
1.  攻击者构造一个恶意的 `.msg` 文件，其中包含指向攻击者控制的 SMB 服务器的 UNC 路径，该路径位于 `reminder_sound_file` 字段中。
2.  攻击者通过邮件将此恶意 `.msg` 文件发送给受害者。
3.  当受害者的 Outlook 客户端收到并处理此邮件时，会自动尝试连接到攻击者的 SMB 服务器。
4.  攻击者的 SMB 服务器捕获受害者的 Net-NTLM hash。
5.  攻击者可以使用此 hash 进行身份冒充或尝试破解密码。

**有效性：**
提供的 POC 代码 `CVE-2023-23397.py` 有效。它利用 `independentsoft.msg` 库创建恶意 `.msg` 文件，并使用 `smtplib` 库将其作为附件发送给受害者。

**投毒风险：**
该仓库中的 POC 代码没有发现明显的投毒代码。代码的主要功能是生成恶意的 Outlook 邮件并发送，以触发漏洞。所有操作都与其描述相符，没有隐藏的恶意行为。

**项目地址:** [Trackflaw/CVE-2023-23397](https://github.com/Trackflaw/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #12

**来源**: [CVE-2023-23397-Zeppperoni_CVE-2023-23397-Patch.md](../2023/CVE-2023-23397-Zeppperoni_CVE-2023-23397-Patch.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者窃取 Net-NTLM 哈希，模拟受害者身份

**影响版本:** 受影响版本包括 Microsoft Outlook 2013 SP1, 2016, 2019, Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021

**利用条件:** 攻击者需要向受害者发送特制的邮件，不需要用户交互

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以构造包含恶意的 `PidLidReminderFileParameter` 属性的电子邮件，当 Outlook 客户端处理这封邮件时，会尝试连接到攻击者控制的 UNC 路径，从而泄露用户的 Net-NTLMv2 哈希。由于 Outlook 会自动处理邮件，因此无需用户交互。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞已被积极利用，CISA 已将其添加到已知被利用的漏洞目录中。漏洞利用的有效性较高。

**投毒风险：**
提供的代码是一个用于修补 CVE-2023-23397 的 PowerShell 脚本。脚本会检查系统上是否已安装相关的安全更新（KB5023696, KB5023706, KB5023702），如果未安装，则从 Microsoft Update Catalog 下载并安装。该脚本相对简单，主要用于自动安装补丁。但仍存在轻微投毒风险，例如脚本可能下载错误或恶意的更新文件（即使可能性较低），或者在特定系统配置下导致意外错误。因此，投毒风险评估为5%。

**利用方式：**
1.  **攻击者构造恶意邮件：** 攻击者创建一个包含恶意 `PidLidReminderFileParameter` 属性的电子邮件。该属性指向攻击者控制的 SMB 服务器。
2.  **受害者接收邮件：** 受害者使用受影响版本的 Microsoft Outlook 接收邮件。
3.  **Outlook 尝试连接：** Outlook 客户端自动处理邮件，并尝试连接到恶意邮件中指定的 UNC 路径。
4.  **NTLM 哈希泄露：** 受害者的 Net-NTLMv2 哈希被发送到攻击者控制的 SMB 服务器。
5.  **攻击者利用哈希：** 攻击者可以使用窃取的 NTLM 哈希进行 NTLM 中继攻击，从而模拟受害者身份并访问网络资源。

**项目地址:** [Zeppperoni/CVE-2023-23397-Patch](https://github.com/Zeppperoni/CVE-2023-23397-Patch)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #13

**来源**: [CVE-2023-23397-ahmedkhlief_CVE-2023-23397-POC-Using-Interop-Outlook.md](../2023/CVE-2023-23397-ahmedkhlief_CVE-2023-23397-POC-Using-Interop-Outlook.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击和权限提升

**影响版本:** 受影响版本：Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise 的特定版本

**利用条件:** 攻击者需要向受害者发送包含恶意属性的邮件、日历邀请或任务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以利用此漏洞窃取受害者的 Net-NTLM 哈希，然后使用该哈希进行 NTLM 中继攻击，从而冒充受害者。漏洞原理是Outlook在处理某些MAPI属性（如ReminderSoundFile）时，会尝试访问指定的 UNC 路径，而无需用户交互。这导致Outlook向该 UNC 路径指向的服务器发送 NTLM 身份验证请求。攻击者可以通过控制这个 UNC 路径，将身份验证请求重定向到攻击者控制的服务器，从而捕获 Net-NTLM 哈希。

**有效性评估：**
提供的 POC 代码尝试创建一个包含特定 ReminderSoundFile 路径的 Outlook 日历项。该路径指向一个攻击者控制的 UNC 路径（`\\192.168.70.222\test.wav`）。通过设置该属性，当 Outlook 处理此日历项时，会尝试访问该路径，从而触发 NTLM 身份验证请求。因此，提供的 POC 代码基本有效，可以用于触发该漏洞。

**投毒风险分析：**
该代码片段的主要功能是创建并配置 Outlook 日历项，并未发现任何与投毒相关的恶意代码。例如，没有下载或执行其他文件的操作，也没有修改系统配置或窃取用户数据的行为。README文件也只是说明了如何使用 Microsoft.Office.Interop.Outlook 实现 POC，并没有任何恶意内容。

**漏洞利用方式：**
1.  攻击者创建一个包含恶意属性（ReminderSoundFile）的 Outlook 日历项、邮件或者任务。
2.  攻击者将包含该恶意属性的 Outlook 日历项发送给受害者。
3.  受害者打开或预览该日历项（无需进一步交互）。
4.  Outlook 尝试访问 ReminderSoundFile 属性中指定的 UNC 路径。
5.  Outlook 向攻击者控制的服务器发送 NTLM 身份验证请求。
6.  攻击者捕获 Net-NTLM 哈希。
7.  攻击者使用捕获的 Net-NTLM 哈希进行 NTLM 中继攻击，提升权限。

**项目地址:** [ahmedkhlief/CVE-2023-23397-POC-Using-Interop-Outlook](https://github.com/ahmedkhlief/CVE-2023-23397-POC-Using-Interop-Outlook)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #14

**来源**: [CVE-2023-23397-ahmedkhlief_CVE-2023-23397-POC.md](../2023/CVE-2023-23397-ahmedkhlief_CVE-2023-23397-POC.md)

## CVE-2023-23397

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致NTLM Relay攻击

**影响版本:** 受影响版本见漏洞库信息

**利用条件:** 攻击者需要发送特制的邮件或日历邀请给受害者

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 的权限提升漏洞。攻击者可以通过发送包含恶意 `PidLidReminderFileParameter` 属性的电子邮件、日历邀请或任务请求来利用此漏洞。当 Outlook 处理此属性时，它会尝试连接到攻击者控制的 UNC 路径，从而强制 Outlook 对攻击者控制的服务器进行身份验证，从而允许 NTLM 中继攻击。漏洞利用方式如下：

1.  **攻击者构造恶意数据：** 攻击者创建一个包含恶意 `PidLidReminderFileParameter` 属性的 Outlook 项目（例如，日历邀请）。此属性指向攻击者控制的 UNC 路径。
2.  **发送给受害者：** 攻击者将此恶意 Outlook 项目发送给受害者。
3.  **Outlook 处理：** 当受害者的 Outlook 客户端处理此项目时，它会尝试访问指定的 UNC 路径，触发 NTLM 身份验证。
4.  **NTLM 中继：** 攻击者可以使用 NTLM 中继攻击来冒充受害者或执行其他恶意操作。

**关于代码的分析：**

提供的 C# 代码片段 `Appointment.cs` 似乎是用于创建和操作 Outlook 约会对象的库的一部分。虽然代码本身没有明显的恶意行为，但重要的是要检查完整的代码库，包括 MsgKit 库的其他部分，以寻找潜在的漏洞或后门。由于MsgKit是一个开源项目，被投毒的可能性较低，但仍然存在风险。

**投毒风险评估：**

评估投毒风险需要检查整个 MsgKit 代码库以及构建和分发过程。在没有完整代码审查的情况下，无法确定代码中是否存在隐藏的恶意代码。但根据以往经验，开源项目的投毒风险较低。此处给出的10% 是基于以下判断：攻击者可能通过提交恶意PR的方式，在不引人注意的情况下添加恶意代码，或者利用MsgKit库的其他漏洞进行攻击。

**有效性评估：**

根据搜索结果，CVE-2023-23397 是一个已知且被积极利用的漏洞，并且有可用的PoC。该漏洞利用的关键在于 `PidLidReminderFileParameter` 属性的处理。代码片段 `Appointment.cs` 似乎与构造包含该属性的 Outlook 对象有关。因此，只要攻击者可以控制 `PidLidReminderFileParameter` 的值，就可以触发该漏洞。

综上所述，该漏洞利用是有效的，并且被广泛利用。

**项目地址:** [ahmedkhlief/CVE-2023-23397-POC](https://github.com/ahmedkhlief/CVE-2023-23397-POC)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #15

**来源**: [CVE-2023-23397-alicangnll_CVE-2023-23397.md](../2023/CVE-2023-23397-alicangnll_CVE-2023-23397.md)

# CVE-2023-23397

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-23397-Agentgilspy_CVE-2023-23397.md](../2023/CVE-2023-23397-Agentgilspy_CVE-2023-23397.md)

## CVE-2023-23397 - Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM哈希泄露，进而提升权限

**影响版本:** 受影响版本包括：Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise (详见漏洞库信息)

**利用条件:** 攻击者需要能够向受害者发送包含特制属性的邮件或日历邀请。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的电子邮件消息，特别是日历邀请，来利用此漏洞。该漏洞允许攻击者窃取受害者的 Net-NTLM 哈希。漏洞利用方式如下：

1.  **攻击者构建包含恶意`ReminderSoundFile`属性的日历邀请或邮件**。该属性指向攻击者控制的SMB服务器（例如 `\\192.168.1.7\nonexistent\sound.wav`）。
2.  **当Outlook客户端处理该邮件时**，即使受害者没有打开邮件，Outlook也会尝试访问该SMB共享以播放提醒声音。
3.  **此访问会触发NTLM身份验证**，将受害者的Net-NTLM哈希发送到攻击者的SMB服务器。
4.  **攻击者捕获Net-NTLM哈希**，并可以使用该哈希进行NTLM中继攻击或离线破解，从而冒充受害者。

**有效性：** 提供的PoC代码尝试通过创建一个新的日历邀请，设置`ReminderSoundFile`属性为攻击者控制的IP地址，并将该邀请发送给目标用户。该PoC代码是有效的，因为它模拟了攻击者可以利用此漏洞的方式。

**投毒风险：** 提供的代码仅包含用于演示漏洞的PoC代码和一个MIT许可协议。它旨在创建一个包含特定属性的Outlook日历项，该属性指向攻击者控制的服务器。没有发现任何作者隐藏的恶意或后门代码，因此投毒风险为0%。该LICENSE文件声明的Copyright (c) 2025 Gilchrist 也无实际意义，因为该漏洞在2023年就被披露。

**利用方式：** 漏洞的利用方式是通过构造包含恶意`ReminderSoundFile`属性的日历邀请或邮件，当受害者的Outlook客户端处理该邮件时，会自动向攻击者控制的SMB服务器发起NTLM认证，从而泄露受害者的Net-NTLM哈希。

**项目地址:** [Agentgilspy/CVE-2023-23397](https://github.com/Agentgilspy/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #2

**来源**: [CVE-2023-23397-AiK1d_CVE-2023-23397-POC.md](../2023/CVE-2023-23397-AiK1d_CVE-2023-23397-POC.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括 Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise 的特定版本。

**利用条件:** 攻击者需要能够发送包含恶意构造的邮件或日历邀请给受害者，受害者需要使用受影响的 Outlook 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的邮件，利用 `reminder_sound_file` 字段指定一个 UNC 路径，当 Outlook 客户端处理该邮件时，会尝试连接到指定的 UNC 路径，从而触发 NTLM 认证。攻击者可以捕获这个 NTLM hash 并进行中继攻击（NTLM Relay），从而冒充受害者的身份。

**有效性：**

提供的 POC 代码是有效的。该脚本会创建一个恶意的 appointment.msg 文件，其中 `reminder_sound_file` 设置为攻击者控制的 UNC 路径。然后，它通过 SMTP 发送包含此附件的电子邮件。当受害者打开电子邮件或 Outlook 处理该日历邀请时，会尝试访问 UNC 路径，从而泄露 NTLM hash。

**投毒风险：**

该仓库存在一定的投毒风险，约10%。

*   虽然核心 POC 代码的功能符合漏洞描述，但攻击者可以修改 `reminder_sound_file`  指向一个非预期的 SMB 服务器。如果攻击者控制的 SMB 服务器本身包含恶意代码，或者被用于投放恶意载荷，那么当受害者连接到该服务器时，可能受到进一步的攻击。例如，攻击者可以利用 Responder 等工具捕获 NTLM hash，然后使用该哈希执行其他攻击。
*   此外，代码中的 SMTP 服务器、用户名和密码为示例值，如果用户不修改这些值直接使用，会导致攻击失败或暴露攻击者信息。
*   README.md 文件比较简单，缺乏详细的漏洞描述和使用说明，可能导致用户误用或理解不足。

**利用方式：**

1.  攻击者构建一个恶意的 appointment.msg 文件，其中 `reminder_sound_file` 字段设置为攻击者控制的 UNC 路径，例如 `\\attacker.com\evilshare\sound.wav`。
2.  攻击者通过电子邮件将此恶意 appointment.msg 文件发送给受害者。
3.  受害者使用受影响的 Outlook 版本打开电子邮件或 Outlook 自动处理该日历邀请。
4.  Outlook 客户端尝试访问 `reminder_sound_file` 字段指定的 UNC 路径，从而向 `attacker.com` 发起 NTLM 认证。
5.  攻击者使用工具（例如 Responder）捕获 NTLM hash。
6.  攻击者使用捕获到的 NTLM hash 进行中继攻击，例如冒充受害者访问内部资源。

**项目地址:** [AiK1d/CVE-2023-23397-POC](https://github.com/AiK1d/CVE-2023-23397-POC)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #3

**来源**: [CVE-2023-23397-BillSkiCO_CVE-2023-23397_EXPLOIT.md](../2023/CVE-2023-23397-BillSkiCO_CVE-2023-23397_EXPLOIT.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise

**利用条件:** 攻击者需要向受害者发送特制的邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以利用此漏洞通过发送特制的邮件来窃取受害者的 Net-NTLM hash，从而冒充受害者身份并进行 NTLM 中继攻击。漏洞的根本原因是 Outlook 没有正确处理邮件中的特殊字段（主要是 `PidLidReminderFileParameter` 属性），导致 Outlook 尝试连接到攻击者控制的 UNC 路径，触发 NTLM 认证。由于 Outlook 在无需用户交互的情况下进行认证，因此攻击者可以在受害者不知情的情况下获取其 NTLM hash。

**利用方式：**

1.  攻击者创建一个包含恶意 `PidLidReminderFileParameter` 属性的特制邮件。该属性指向攻击者控制的 UNC 路径（例如 `\\attacker.com\share\file.wav`）。
2.  攻击者将该邮件发送给受害者。
3.  当 Outlook 处理该邮件时，它会尝试连接到攻击者控制的 UNC 路径，从而触发 NTLM 认证。
4.  攻击者捕获 NTLM hash 并使用它进行 NTLM 中继攻击。

**有效性：**

根据搜索结果，此漏洞已被广泛利用，并且 CISA 已将其添加到已知被利用的漏洞目录中。这表明存在可用的漏洞利用代码，并且该漏洞在野外被积极利用。

**投毒风险：**

提供的代码段是 Apache 2.0 许可协议，不是漏洞利用代码本身，因此无法从中分析是否存在投毒代码。考虑到这是一个许可协议，投毒的可能性极低。风险评估为0%。


**项目地址:** [BillSkiCO/CVE-2023-23397_EXPLOIT](https://github.com/BillSkiCO/CVE-2023-23397_EXPLOIT)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #4

**来源**: [CVE-2023-23397-BronzeBee_cve-2023-23397.md](../2023/CVE-2023-23397-BronzeBee_cve-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致Net-NTLM hash泄露和身份冒用

**影响版本:** 受影响版本包括：Microsoft Office LTSC 2021, Microsoft Outlook 2016, Microsoft 365 Apps for Enterprise, Microsoft Office 2019, Microsoft Outlook 2013 Service Pack 1。详细版本信息请参考漏洞库信息。

**利用条件:** 攻击者需要能够发送电子邮件给受害者。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-23397 是 Microsoft Outlook 中的一个权限提升漏洞。攻击者可以利用此漏洞窃取受害者的 Net-NTLM 哈希，从而冒充受害者的身份并进行进一步的攻击。漏洞的根源在于 Outlook 没有正确验证输入，攻击者可以通过在电子邮件中嵌入特制的 UNC 路径来触发漏洞。当 Outlook 处理包含恶意 UNC 路径的电子邮件时，它将尝试连接到该路径，并将用户的 Net-NTLM 哈希发送到攻击者控制的服务器。

**有效性评估：**
根据漏洞库信息和搜索结果，CVE-2023-23397 是一个已被积极利用的漏洞，并且CISA已将其添加到已知被利用的漏洞目录中。提供的漏洞利用代码似乎有效，因为它允许攻击者创建包含恶意 payload 的 TNEF 编码的 Outlook 电子邮件，并通过纯 SMTP 发送，从而触发 Net-NTLM 哈希的泄露。

**投毒风险评估：**
分析提供的POC代码，风险较低。代码主要功能是构造并发送包含漏洞触发payload的邮件。虽然任何代码都存在潜在的恶意修改可能，但该POC代码相对简单，主要利用了已知的漏洞。

**利用方式分析：**
1.  攻击者使用提供的 Python 脚本 (cve-2023-23397.py) 创建一个特制的 Outlook 电子邮件，其中包含一个指向攻击者控制的服务器的恶意 UNC 路径 (例如 \\10.10.10.10\share\1.wav)。这个 UNC 路径被嵌入到电子邮件的某个属性中，例如 `PidLidReminderOverride`。
2.  攻击者通过 SMTP 将此电子邮件发送给受害者。
3.  当受害者使用 Outlook 打开或预览该电子邮件时，Outlook 会尝试连接到恶意 UNC 路径，并自动向攻击者控制的服务器发送受害者的 Net-NTLM 哈希。
4.  攻击者可以使用捕获的 Net-NTLM 哈希进行 NTLM 中继攻击或其他身份验证攻击，从而提升权限并访问受害者的资源。

**缓解措施：**
*   及时安装 Microsoft 提供的安全更新以修复此漏洞。
*   阻止出站 SMB 流量（端口 445）以防止 Net-NTLM 哈希泄露。
*   配置 Outlook 以禁用自动身份验证到 UNC 路径。
*   监视网络流量以检测对外部 SMB 服务器的连接尝试。

**项目地址:** [BronzeBee/cve-2023-23397](https://github.com/BronzeBee/cve-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #5

**来源**: [CVE-2023-23397-Cyb3rMaddy_CVE-2023-23397-Report.md](../2023/CVE-2023-23397-Cyb3rMaddy_CVE-2023-23397-Report.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击，窃取用户身份

**影响版本:** 受影响版本见漏洞库信息

**利用条件:** 攻击者需要能够发送包含恶意扩展MAPI属性的邮件给受害者

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397是一个Microsoft Outlook中的权限提升漏洞。攻击者可以通过发送包含特定格式的扩展MAPI属性（包含指向攻击者控制的SMB服务器的UNC路径）的电子邮件来触发此漏洞。当Outlook处理该邮件时，会自动尝试连接到攻击者的SMB服务器，并将用户的NTLM哈希发送给攻击者。攻击者可以利用收到的NTLM哈希进行NTLM Relay攻击，冒充受害者访问网络资源或执行其他恶意操作。

**有效性：**
根据漏洞描述和搜索结果，POC代码有效。漏洞利用无需用户交互。

**投毒风险：**
POC代码本身是一个利用漏洞的演示，主要包含漏洞利用相关的说明文档。README.md 主要描述了漏洞原理和利用方法，本身不包含恶意代码。投毒风险较低，可能存在恶意作者在其他利用代码中加入后门的可能性，所以投毒风险估计为10%。

**利用方式：**
1.  攻击者构建包含恶意扩展MAPI属性的电子邮件。
2.  恶意MAPI属性包含指向攻击者控制的SMB服务器的UNC路径。
3.  受害者使用Outlook客户端接收并处理该邮件。
4.  Outlook客户端尝试连接到攻击者的SMB服务器。
5.  Outlook客户端将受害者的NTLM哈希发送到攻击者的SMB服务器。
6.  攻击者使用NTLM哈希进行NTLM Relay攻击。

**项目地址:** [Cyb3rMaddy/CVE-2023-23397-Report](https://github.com/Cyb3rMaddy/CVE-2023-23397-Report)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #6

**来源**: [CVE-2023-23397-Muhammad-Ali007_OutlookNTLM_CVE-2023-23397.md](../2023/CVE-2023-23397-Muhammad-Ali007_OutlookNTLM_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本：Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise（具体版本范围参考漏洞库信息）

**利用条件:** 攻击者需要发送特制的日历邀请或邮件，受害者使用受影响的Outlook版本查看邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397是一个Microsoft Outlook权限提升漏洞。攻击者可以通过发送包含指向远程SMB服务器（或其他支持NTLM认证的服务器，如WebDAV）的恶意UNC路径的日历邀请或邮件来利用此漏洞。当Outlook处理该邮件时，会尝试连接到远程服务器以获取声音文件（ReminderSoundFile），这会触发NTLM认证过程，将受害者的Net-NTLM hash发送到攻击者的服务器。攻击者可以利用获取的Net-NTLM hash进行NTLM Relay攻击或其他凭据破解尝试。

**有效性:** 提供的POC代码通过PowerShell脚本实现了发送或保存包含恶意`ReminderSoundFile`属性的日历邀请，该属性指向攻击者控制的远程文件服务器。因此，该POC代码是有效的。

**投毒风险:** 代码功能明确，旨在利用CVE-2023-23397漏洞，没有发现隐藏的恶意代码或后门。代码目的是为了验证漏洞，没有额外恶意行为。因此投毒风险评估为0%。

**利用方式:**
1.  攻击者创建一个恶意的日历邀请或邮件。
2.  攻击者在日历邀请或邮件的`ReminderSoundFile`属性中设置一个UNC路径，指向攻击者控制的远程服务器（例如，`\\attacker_ip\share\file.wav`）。
3.  攻击者将日历邀请或邮件发送给受害者。
4.  当受害者使用受影响的Outlook版本打开该日历邀请或邮件时，Outlook会尝试连接到攻击者的远程服务器以获取声音文件。
5.  Outlook的连接尝试会触发NTLM认证过程，将受害者的Net-NTLM hash发送到攻击者的服务器。
6.  攻击者捕获Net-NTLM hash，并尝试破解或进行NTLM Relay攻击。

**项目地址:** [Muhammad-Ali007/OutlookNTLM_CVE-2023-23397](https://github.com/Muhammad-Ali007/OutlookNTLM_CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #7

**来源**: [CVE-2023-23397-Pushkarup_CVE-2023-23397.md](../2023/CVE-2023-23397-Pushkarup_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击，控制受害者账户

**影响版本:** 受影响版本：Microsoft Outlook 2013 SP1, Outlook 2016, Outlook 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise (查看漏洞库信息中的详细版本范围)

**利用条件:** 攻击者需要知道目标用户的邮件地址，并能够发送邮件到目标用户的Outlook邮箱。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 中的权限提升漏洞。攻击者可以通过发送特制的电子邮件，在无需用户交互的情况下，强制 Outlook 客户端连接到攻击者控制的 SMB 服务器，从而窃取 Net-NTLMv2 哈希。利用方式如下：

1.  **漏洞原理：** Outlook 在处理邮件时，如果邮件中包含 `ReminderSoundFile` 属性指向 UNC 路径（例如 `\\attacker_ip\share\sound.wav`），Outlook 会尝试连接到该路径。该连接使用用户的 Windows 凭据进行身份验证，因此攻击者可以捕获 Net-NTLMv2 哈希。

2.  **PoC 代码分析：**  提供的 PoC 代码 `Exploit.py`  利用 `win32com.client` 库来创建包含恶意 `ReminderSoundFile` 属性的 Outlook 日程安排。脚本会要求攻击者输入目标电子邮件地址和攻击者的 IP 地址（c2，也就是接收哈希的服务器）。然后，它将 UNC 路径设置为 `\\attacker_ip`，并将其设置为 `ReminderSoundFile` 属性。该脚本可以选择将恶意邮件保存为 `.msg` 文件或直接发送。

3.  **有效性评估：** 结合漏洞库信息、搜索引擎结果和 PoC 代码，可以确定该 PoC 代码是有效的。该漏洞已经被广泛研究和利用，并且CISA的已知被利用漏洞目录中也包含了该漏洞。

4.  **投毒风险评估：**  
    *   PoC 代码的主要功能是生成利用 CVE-2023-23397 漏洞的恶意邮件。代码本身看起来比较直接，没有明显的恶意行为，例如安装后门或执行其他未声明的操作。
    *   风险点可能存在于攻击者提供的 `attacker_ip` 参数。如果攻击者控制了该 IP 地址，他们可以捕获 NTLM 哈希。但是，这属于漏洞本身的利用方式，而不是 PoC 代码的投毒行为。
    *   文件LICENSE和README.md没有发现异常
    综合考虑，PoC 代码本身存在作者隐藏的恶意代码的风险较低。但始终需要保持警惕，在运行 PoC 代码之前，应仔细检查代码，并在隔离环境中运行。

5.  **利用方式总结：**
    1.  攻击者构造包含恶意 `ReminderSoundFile` 属性的 Outlook 日程安排。
    2.  将该日程安排以邮件的形式发送给目标用户。
    3.  当目标用户在 Outlook 中打开该邮件时，Outlook 客户端会尝试连接到 `ReminderSoundFile` 属性指定的 UNC 路径。
    4.  攻击者监听 SMB 流量，捕获 Net-NTLMv2 哈希。
    5.  攻击者可以使用捕获的哈希进行 NTLM Relay 攻击或尝试破解哈希以获得用户密码。

**项目地址:** [Pushkarup/CVE-2023-23397](https://github.com/Pushkarup/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #8

**来源**: [CVE-2023-23397-SecCTechs_CVE-2023-23397.md](../2023/CVE-2023-23397-SecCTechs_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击，进而获取用户身份

**影响版本:** 受影响版本包括：Microsoft Outlook 2013 SP1, Outlook 2016, Outlook 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise等。

**利用条件:** 攻击者需要向受害者发送特制的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的邮件，在无需用户交互的情况下，迫使 Outlook 客户端连接到攻击者控制的服务器，从而窃取受害者的 Net-NTLM hash。 这使得攻击者能够冒充受害者身份，进行 NTLM Relay 攻击。

**漏洞利用方式:**
1.  攻击者构造包含恶意 `PidLidReminderFileParameter` 属性的邮件，此属性指向攻击者控制的 UNC 路径。
2.  受害者使用 Outlook 客户端打开或预览该邮件。
3.  Outlook 客户端尝试连接到指定的 UNC 路径，进行身份验证，将 Net-NTLM hash 发送给攻击者。
4.  攻击者利用窃取的 Net-NTLM hash 进行 NTLM Relay 攻击，例如冒充受害者访问网络资源。

**漏洞利用有效性：**
根据搜索结果和漏洞库信息，该漏洞已经被广泛利用，CISA 已经将其列入已知被利用漏洞目录。 漏洞利用的有效性很高，且利用难度相对较低。

**投毒风险：**
提供的漏洞利用代码仅包含 GNU GPL 许可协议，没有发现任何恶意代码。因此，投毒风险较低，评估为0%。但实际环境中利用此漏洞时，需要注意获取PoC代码的来源，确保其安全性。

**项目地址:** [SecCTechs/CVE-2023-23397](https://github.com/SecCTechs/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #9

**来源**: [CVE-2023-23397-Symbolexe_CVE-2023-23397.md](../2023/CVE-2023-23397-Symbolexe_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM relay攻击，获取用户身份

**影响版本:** 受影响版本包括Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise等，具体版本号请参考漏洞库信息。

**利用条件:** 攻击者需要向受害者发送特制的邮件，受害者无需交互，只需预览或打开邮件即可触发。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个存在于 Microsoft Outlook 中的权限提升漏洞。攻击者可以构造特殊的邮件，利用扩展 MAPI (Messaging Application Programming Interface)属性，特别是 `PidLidReminderFileParameter` 属性，指向一个攻击者控制的 UNC 路径。当 Outlook 处理这封邮件时（无需用户点击任何链接，预览或打开邮件即可），会尝试连接到该 UNC 路径，触发 NTLM 认证过程，从而将用户的 NTLM hash 发送到攻击者控制的服务器。攻击者可以通过 NTLM relay攻击冒充用户身份。

**漏洞利用方式：**
1.  攻击者构造包含恶意 `PidLidReminderFileParameter` 属性的邮件，该属性指向攻击者控制的 UNC 路径。
2.  攻击者向受害者发送邮件。
3.  受害者使用 Outlook 预览或打开邮件。
4.  Outlook 尝试连接到 UNC 路径，触发 NTLM 认证。
5.  攻击者捕获 NTLM hash 并利用它进行身份验证。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞已被广泛利用，因此可以判断POC代码是有效的。

**投毒风险：**
提供的POC代码仅包含LICENSE和README.md文件。README.md描述了漏洞原理和利用方法，没有发现明显的恶意代码。但是，实际的漏洞利用工具可能包含额外的功能（例如，自动化的 NTLM relay 攻击等），这些功能可能被滥用于恶意目的。因此，从仓库本身来看，投毒的概率较低，但使用未经审核的第三方工具仍然存在风险。所以投毒风险为10%。

**漏洞库信息摘要：**
*   漏洞类型：权限提升
*   CVSS 评分：9.8 (严重)
*   受影响产品：Microsoft Outlook
*   修复方案：安装 Microsoft 提供的安全更新

**搜索引擎结果摘要：**
*   CVE-2023-23397 已经被 CISA 列入已知被利用漏洞目录。
*   该漏洞允许攻击者窃取 Net-NTLM hash。
*   Microsoft 提供了检测脚本。
*   有针对该漏洞的攻击样本分析报告。

**项目地址:** [Symbolexe/CVE-2023-23397](https://github.com/Symbolexe/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #10

**来源**: [CVE-2023-23397-TheUnknownSoul_CVE-2023-23397-PoW.md](../2023/CVE-2023-23397-TheUnknownSoul_CVE-2023-23397-PoW.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致Net-NTLM哈希泄露，攻击者可冒充受害者身份。

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要能够发送电子邮件给受害者，并且受害者需要使用存在漏洞的Outlook客户端打开邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397是一个Microsoft Outlook权限提升漏洞。该漏洞的利用方式是攻击者发送一封特制的电子邮件，其中包含指向攻击者控制的SMB服务器的UNC路径，当受害者使用存在漏洞的Outlook客户端打开该邮件时，会自动尝试连接到该SMB服务器，并将受害者的Net-NTLM哈希发送给攻击者。攻击者可以使用该哈希进行NTLM中继攻击，从而冒充受害者的身份。

根据提供的漏洞利用代码，该代码通过Python脚本生成包含恶意音频文件链接的Outlook日历邀请（appointment）。当受害者打开该邀请时，Outlook会尝试访问该链接，从而触发NTLM认证并泄露哈希值。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开的PoC代码。因此，提供的PoC代码在一定条件下是有效的。

**投毒风险：**
提供的PoC代码中，主要操作是构造恶意的Outlook日历邀请并发送给目标用户。代码包含发送邮件功能，这需要配置SMTP服务器的地址、端口、用户名和密码。潜在的投毒风险在于：
1.  **SMTP服务器配置:** 如果攻击者诱导用户使用其控制的SMTP服务器，则可能拦截或篡改发送的邮件。
2.  **附件路径:**  `full_path = f'\\\{path}\sound.wav'` 这行代码定义了SMB共享的路径。攻击者可能尝试通过精心构造路径，执行其他恶意操作。例如，如果Outlook客户端对UNC路径处理不当，可能导致文件读取或执行。
3.  **依赖库安全:**  虽然代码本身相对简单，但需要依赖Python环境和第三方库，这些依赖库可能存在安全漏洞。检查库的完整性。

代码中存在使用恶意SMB共享的风险，该路径可能会包含恶意payload或引发其他问题。因此判定存在10%的投毒风险，主要集中在引导用户设置攻击者控制的SMB服务器以及SMTP服务器。

**利用方式：**
1.  攻击者设置一个SMB服务器，并放置一个任意的音频文件（例如sound.wav）。
2.  攻击者运行提供的Python脚本，指定SMB服务器的IP地址和一个包含目标邮箱地址的文本文件。
3.  脚本会构造包含指向SMB服务器上音频文件的日历邀请，并将其发送给目标邮箱。
4.  当目标用户使用存在漏洞的Outlook客户端打开该日历邀请时，Outlook会自动尝试连接到SMB服务器以下载音频文件。
5.  由于SMB协议的认证机制，Outlook会将目标用户的Net-NTLM哈希发送给SMB服务器。
6.  攻击者可以在SMB服务器上捕获该哈希，并使用其进行NTLM中继攻击或其他攻击。


**项目地址:** [TheUnknownSoul/CVE-2023-23397-PoW](https://github.com/TheUnknownSoul/CVE-2023-23397-PoW)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #11

**来源**: [CVE-2023-23397-Trackflaw_CVE-2023-23397.md](../2023/CVE-2023-23397-Trackflaw_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致Net-NTLM hash泄露，进而进行身份冒充和横向移动

**影响版本:** 受影响版本：Microsoft Outlook 2013 SP1, Outlook 2016, Outlook 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise。详见漏洞库信息中的cpeApplicability。

**利用条件:** 攻击者需要能够发送邮件给受害者。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞，攻击者通过构造包含指向恶意 SMB 服务器 UNC 路径的特殊邮件（例如，利用 `reminder_sound_file` 字段），当 Outlook 客户端处理该邮件时，会自动尝试通过 SMB 协议连接到攻击者的服务器，从而泄露受害者的 Net-NTLM hash。由于 Outlook 客户端会自动处理邮件，因此该漏洞是零点击漏洞。

**漏洞利用方式：**
1.  攻击者构造一个恶意的 `.msg` 文件，其中包含指向攻击者控制的 SMB 服务器的 UNC 路径，该路径位于 `reminder_sound_file` 字段中。
2.  攻击者通过邮件将此恶意 `.msg` 文件发送给受害者。
3.  当受害者的 Outlook 客户端收到并处理此邮件时，会自动尝试连接到攻击者的 SMB 服务器。
4.  攻击者的 SMB 服务器捕获受害者的 Net-NTLM hash。
5.  攻击者可以使用此 hash 进行身份冒充或尝试破解密码。

**有效性：**
提供的 POC 代码 `CVE-2023-23397.py` 有效。它利用 `independentsoft.msg` 库创建恶意 `.msg` 文件，并使用 `smtplib` 库将其作为附件发送给受害者。

**投毒风险：**
该仓库中的 POC 代码没有发现明显的投毒代码。代码的主要功能是生成恶意的 Outlook 邮件并发送，以触发漏洞。所有操作都与其描述相符，没有隐藏的恶意行为。

**项目地址:** [Trackflaw/CVE-2023-23397](https://github.com/Trackflaw/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #12

**来源**: [CVE-2023-23397-Zeppperoni_CVE-2023-23397-Patch.md](../2023/CVE-2023-23397-Zeppperoni_CVE-2023-23397-Patch.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者窃取 Net-NTLM 哈希，模拟受害者身份

**影响版本:** 受影响版本包括 Microsoft Outlook 2013 SP1, 2016, 2019, Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021

**利用条件:** 攻击者需要向受害者发送特制的邮件，不需要用户交互

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以构造包含恶意的 `PidLidReminderFileParameter` 属性的电子邮件，当 Outlook 客户端处理这封邮件时，会尝试连接到攻击者控制的 UNC 路径，从而泄露用户的 Net-NTLMv2 哈希。由于 Outlook 会自动处理邮件，因此无需用户交互。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞已被积极利用，CISA 已将其添加到已知被利用的漏洞目录中。漏洞利用的有效性较高。

**投毒风险：**
提供的代码是一个用于修补 CVE-2023-23397 的 PowerShell 脚本。脚本会检查系统上是否已安装相关的安全更新（KB5023696, KB5023706, KB5023702），如果未安装，则从 Microsoft Update Catalog 下载并安装。该脚本相对简单，主要用于自动安装补丁。但仍存在轻微投毒风险，例如脚本可能下载错误或恶意的更新文件（即使可能性较低），或者在特定系统配置下导致意外错误。因此，投毒风险评估为5%。

**利用方式：**
1.  **攻击者构造恶意邮件：** 攻击者创建一个包含恶意 `PidLidReminderFileParameter` 属性的电子邮件。该属性指向攻击者控制的 SMB 服务器。
2.  **受害者接收邮件：** 受害者使用受影响版本的 Microsoft Outlook 接收邮件。
3.  **Outlook 尝试连接：** Outlook 客户端自动处理邮件，并尝试连接到恶意邮件中指定的 UNC 路径。
4.  **NTLM 哈希泄露：** 受害者的 Net-NTLMv2 哈希被发送到攻击者控制的 SMB 服务器。
5.  **攻击者利用哈希：** 攻击者可以使用窃取的 NTLM 哈希进行 NTLM 中继攻击，从而模拟受害者身份并访问网络资源。

**项目地址:** [Zeppperoni/CVE-2023-23397-Patch](https://github.com/Zeppperoni/CVE-2023-23397-Patch)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #13

**来源**: [CVE-2023-23397-ahmedkhlief_CVE-2023-23397-POC-Using-Interop-Outlook.md](../2023/CVE-2023-23397-ahmedkhlief_CVE-2023-23397-POC-Using-Interop-Outlook.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击和权限提升

**影响版本:** 受影响版本：Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise 的特定版本

**利用条件:** 攻击者需要向受害者发送包含恶意属性的邮件、日历邀请或任务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以利用此漏洞窃取受害者的 Net-NTLM 哈希，然后使用该哈希进行 NTLM 中继攻击，从而冒充受害者。漏洞原理是Outlook在处理某些MAPI属性（如ReminderSoundFile）时，会尝试访问指定的 UNC 路径，而无需用户交互。这导致Outlook向该 UNC 路径指向的服务器发送 NTLM 身份验证请求。攻击者可以通过控制这个 UNC 路径，将身份验证请求重定向到攻击者控制的服务器，从而捕获 Net-NTLM 哈希。

**有效性评估：**
提供的 POC 代码尝试创建一个包含特定 ReminderSoundFile 路径的 Outlook 日历项。该路径指向一个攻击者控制的 UNC 路径（`\\192.168.70.222\test.wav`）。通过设置该属性，当 Outlook 处理此日历项时，会尝试访问该路径，从而触发 NTLM 身份验证请求。因此，提供的 POC 代码基本有效，可以用于触发该漏洞。

**投毒风险分析：**
该代码片段的主要功能是创建并配置 Outlook 日历项，并未发现任何与投毒相关的恶意代码。例如，没有下载或执行其他文件的操作，也没有修改系统配置或窃取用户数据的行为。README文件也只是说明了如何使用 Microsoft.Office.Interop.Outlook 实现 POC，并没有任何恶意内容。

**漏洞利用方式：**
1.  攻击者创建一个包含恶意属性（ReminderSoundFile）的 Outlook 日历项、邮件或者任务。
2.  攻击者将包含该恶意属性的 Outlook 日历项发送给受害者。
3.  受害者打开或预览该日历项（无需进一步交互）。
4.  Outlook 尝试访问 ReminderSoundFile 属性中指定的 UNC 路径。
5.  Outlook 向攻击者控制的服务器发送 NTLM 身份验证请求。
6.  攻击者捕获 Net-NTLM 哈希。
7.  攻击者使用捕获的 Net-NTLM 哈希进行 NTLM 中继攻击，提升权限。

**项目地址:** [ahmedkhlief/CVE-2023-23397-POC-Using-Interop-Outlook](https://github.com/ahmedkhlief/CVE-2023-23397-POC-Using-Interop-Outlook)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #14

**来源**: [CVE-2023-23397-ahmedkhlief_CVE-2023-23397-POC.md](../2023/CVE-2023-23397-ahmedkhlief_CVE-2023-23397-POC.md)

## CVE-2023-23397

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致NTLM Relay攻击

**影响版本:** 受影响版本见漏洞库信息

**利用条件:** 攻击者需要发送特制的邮件或日历邀请给受害者

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 的权限提升漏洞。攻击者可以通过发送包含恶意 `PidLidReminderFileParameter` 属性的电子邮件、日历邀请或任务请求来利用此漏洞。当 Outlook 处理此属性时，它会尝试连接到攻击者控制的 UNC 路径，从而强制 Outlook 对攻击者控制的服务器进行身份验证，从而允许 NTLM 中继攻击。漏洞利用方式如下：

1.  **攻击者构造恶意数据：** 攻击者创建一个包含恶意 `PidLidReminderFileParameter` 属性的 Outlook 项目（例如，日历邀请）。此属性指向攻击者控制的 UNC 路径。
2.  **发送给受害者：** 攻击者将此恶意 Outlook 项目发送给受害者。
3.  **Outlook 处理：** 当受害者的 Outlook 客户端处理此项目时，它会尝试访问指定的 UNC 路径，触发 NTLM 身份验证。
4.  **NTLM 中继：** 攻击者可以使用 NTLM 中继攻击来冒充受害者或执行其他恶意操作。

**关于代码的分析：**

提供的 C# 代码片段 `Appointment.cs` 似乎是用于创建和操作 Outlook 约会对象的库的一部分。虽然代码本身没有明显的恶意行为，但重要的是要检查完整的代码库，包括 MsgKit 库的其他部分，以寻找潜在的漏洞或后门。由于MsgKit是一个开源项目，被投毒的可能性较低，但仍然存在风险。

**投毒风险评估：**

评估投毒风险需要检查整个 MsgKit 代码库以及构建和分发过程。在没有完整代码审查的情况下，无法确定代码中是否存在隐藏的恶意代码。但根据以往经验，开源项目的投毒风险较低。此处给出的10% 是基于以下判断：攻击者可能通过提交恶意PR的方式，在不引人注意的情况下添加恶意代码，或者利用MsgKit库的其他漏洞进行攻击。

**有效性评估：**

根据搜索结果，CVE-2023-23397 是一个已知且被积极利用的漏洞，并且有可用的PoC。该漏洞利用的关键在于 `PidLidReminderFileParameter` 属性的处理。代码片段 `Appointment.cs` 似乎与构造包含该属性的 Outlook 对象有关。因此，只要攻击者可以控制 `PidLidReminderFileParameter` 的值，就可以触发该漏洞。

综上所述，该漏洞利用是有效的，并且被广泛利用。

**项目地址:** [ahmedkhlief/CVE-2023-23397-POC](https://github.com/ahmedkhlief/CVE-2023-23397-POC)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #15

**来源**: [CVE-2023-23397-alicangnll_CVE-2023-23397.md](../2023/CVE-2023-23397-alicangnll_CVE-2023-23397.md)

# CVE-2023-23397

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-23397-Agentgilspy_CVE-2023-23397.md](../2023/CVE-2023-23397-Agentgilspy_CVE-2023-23397.md)

## CVE-2023-23397 - Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM哈希泄露，进而提升权限

**影响版本:** 受影响版本包括：Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise (详见漏洞库信息)

**利用条件:** 攻击者需要能够向受害者发送包含特制属性的邮件或日历邀请。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的电子邮件消息，特别是日历邀请，来利用此漏洞。该漏洞允许攻击者窃取受害者的 Net-NTLM 哈希。漏洞利用方式如下：

1.  **攻击者构建包含恶意`ReminderSoundFile`属性的日历邀请或邮件**。该属性指向攻击者控制的SMB服务器（例如 `\\192.168.1.7\nonexistent\sound.wav`）。
2.  **当Outlook客户端处理该邮件时**，即使受害者没有打开邮件，Outlook也会尝试访问该SMB共享以播放提醒声音。
3.  **此访问会触发NTLM身份验证**，将受害者的Net-NTLM哈希发送到攻击者的SMB服务器。
4.  **攻击者捕获Net-NTLM哈希**，并可以使用该哈希进行NTLM中继攻击或离线破解，从而冒充受害者。

**有效性：** 提供的PoC代码尝试通过创建一个新的日历邀请，设置`ReminderSoundFile`属性为攻击者控制的IP地址，并将该邀请发送给目标用户。该PoC代码是有效的，因为它模拟了攻击者可以利用此漏洞的方式。

**投毒风险：** 提供的代码仅包含用于演示漏洞的PoC代码和一个MIT许可协议。它旨在创建一个包含特定属性的Outlook日历项，该属性指向攻击者控制的服务器。没有发现任何作者隐藏的恶意或后门代码，因此投毒风险为0%。该LICENSE文件声明的Copyright (c) 2025 Gilchrist 也无实际意义，因为该漏洞在2023年就被披露。

**利用方式：** 漏洞的利用方式是通过构造包含恶意`ReminderSoundFile`属性的日历邀请或邮件，当受害者的Outlook客户端处理该邮件时，会自动向攻击者控制的SMB服务器发起NTLM认证，从而泄露受害者的Net-NTLM哈希。

**项目地址:** [Agentgilspy/CVE-2023-23397](https://github.com/Agentgilspy/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #2

**来源**: [CVE-2023-23397-AiK1d_CVE-2023-23397-POC.md](../2023/CVE-2023-23397-AiK1d_CVE-2023-23397-POC.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括 Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise 的特定版本。

**利用条件:** 攻击者需要能够发送包含恶意构造的邮件或日历邀请给受害者，受害者需要使用受影响的 Outlook 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的邮件，利用 `reminder_sound_file` 字段指定一个 UNC 路径，当 Outlook 客户端处理该邮件时，会尝试连接到指定的 UNC 路径，从而触发 NTLM 认证。攻击者可以捕获这个 NTLM hash 并进行中继攻击（NTLM Relay），从而冒充受害者的身份。

**有效性：**

提供的 POC 代码是有效的。该脚本会创建一个恶意的 appointment.msg 文件，其中 `reminder_sound_file` 设置为攻击者控制的 UNC 路径。然后，它通过 SMTP 发送包含此附件的电子邮件。当受害者打开电子邮件或 Outlook 处理该日历邀请时，会尝试访问 UNC 路径，从而泄露 NTLM hash。

**投毒风险：**

该仓库存在一定的投毒风险，约10%。

*   虽然核心 POC 代码的功能符合漏洞描述，但攻击者可以修改 `reminder_sound_file`  指向一个非预期的 SMB 服务器。如果攻击者控制的 SMB 服务器本身包含恶意代码，或者被用于投放恶意载荷，那么当受害者连接到该服务器时，可能受到进一步的攻击。例如，攻击者可以利用 Responder 等工具捕获 NTLM hash，然后使用该哈希执行其他攻击。
*   此外，代码中的 SMTP 服务器、用户名和密码为示例值，如果用户不修改这些值直接使用，会导致攻击失败或暴露攻击者信息。
*   README.md 文件比较简单，缺乏详细的漏洞描述和使用说明，可能导致用户误用或理解不足。

**利用方式：**

1.  攻击者构建一个恶意的 appointment.msg 文件，其中 `reminder_sound_file` 字段设置为攻击者控制的 UNC 路径，例如 `\\attacker.com\evilshare\sound.wav`。
2.  攻击者通过电子邮件将此恶意 appointment.msg 文件发送给受害者。
3.  受害者使用受影响的 Outlook 版本打开电子邮件或 Outlook 自动处理该日历邀请。
4.  Outlook 客户端尝试访问 `reminder_sound_file` 字段指定的 UNC 路径，从而向 `attacker.com` 发起 NTLM 认证。
5.  攻击者使用工具（例如 Responder）捕获 NTLM hash。
6.  攻击者使用捕获到的 NTLM hash 进行中继攻击，例如冒充受害者访问内部资源。

**项目地址:** [AiK1d/CVE-2023-23397-POC](https://github.com/AiK1d/CVE-2023-23397-POC)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #3

**来源**: [CVE-2023-23397-BillSkiCO_CVE-2023-23397_EXPLOIT.md](../2023/CVE-2023-23397-BillSkiCO_CVE-2023-23397_EXPLOIT.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise

**利用条件:** 攻击者需要向受害者发送特制的邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以利用此漏洞通过发送特制的邮件来窃取受害者的 Net-NTLM hash，从而冒充受害者身份并进行 NTLM 中继攻击。漏洞的根本原因是 Outlook 没有正确处理邮件中的特殊字段（主要是 `PidLidReminderFileParameter` 属性），导致 Outlook 尝试连接到攻击者控制的 UNC 路径，触发 NTLM 认证。由于 Outlook 在无需用户交互的情况下进行认证，因此攻击者可以在受害者不知情的情况下获取其 NTLM hash。

**利用方式：**

1.  攻击者创建一个包含恶意 `PidLidReminderFileParameter` 属性的特制邮件。该属性指向攻击者控制的 UNC 路径（例如 `\\attacker.com\share\file.wav`）。
2.  攻击者将该邮件发送给受害者。
3.  当 Outlook 处理该邮件时，它会尝试连接到攻击者控制的 UNC 路径，从而触发 NTLM 认证。
4.  攻击者捕获 NTLM hash 并使用它进行 NTLM 中继攻击。

**有效性：**

根据搜索结果，此漏洞已被广泛利用，并且 CISA 已将其添加到已知被利用的漏洞目录中。这表明存在可用的漏洞利用代码，并且该漏洞在野外被积极利用。

**投毒风险：**

提供的代码段是 Apache 2.0 许可协议，不是漏洞利用代码本身，因此无法从中分析是否存在投毒代码。考虑到这是一个许可协议，投毒的可能性极低。风险评估为0%。


**项目地址:** [BillSkiCO/CVE-2023-23397_EXPLOIT](https://github.com/BillSkiCO/CVE-2023-23397_EXPLOIT)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #4

**来源**: [CVE-2023-23397-BronzeBee_cve-2023-23397.md](../2023/CVE-2023-23397-BronzeBee_cve-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致Net-NTLM hash泄露和身份冒用

**影响版本:** 受影响版本包括：Microsoft Office LTSC 2021, Microsoft Outlook 2016, Microsoft 365 Apps for Enterprise, Microsoft Office 2019, Microsoft Outlook 2013 Service Pack 1。详细版本信息请参考漏洞库信息。

**利用条件:** 攻击者需要能够发送电子邮件给受害者。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-23397 是 Microsoft Outlook 中的一个权限提升漏洞。攻击者可以利用此漏洞窃取受害者的 Net-NTLM 哈希，从而冒充受害者的身份并进行进一步的攻击。漏洞的根源在于 Outlook 没有正确验证输入，攻击者可以通过在电子邮件中嵌入特制的 UNC 路径来触发漏洞。当 Outlook 处理包含恶意 UNC 路径的电子邮件时，它将尝试连接到该路径，并将用户的 Net-NTLM 哈希发送到攻击者控制的服务器。

**有效性评估：**
根据漏洞库信息和搜索结果，CVE-2023-23397 是一个已被积极利用的漏洞，并且CISA已将其添加到已知被利用的漏洞目录中。提供的漏洞利用代码似乎有效，因为它允许攻击者创建包含恶意 payload 的 TNEF 编码的 Outlook 电子邮件，并通过纯 SMTP 发送，从而触发 Net-NTLM 哈希的泄露。

**投毒风险评估：**
分析提供的POC代码，风险较低。代码主要功能是构造并发送包含漏洞触发payload的邮件。虽然任何代码都存在潜在的恶意修改可能，但该POC代码相对简单，主要利用了已知的漏洞。

**利用方式分析：**
1.  攻击者使用提供的 Python 脚本 (cve-2023-23397.py) 创建一个特制的 Outlook 电子邮件，其中包含一个指向攻击者控制的服务器的恶意 UNC 路径 (例如 \\10.10.10.10\share\1.wav)。这个 UNC 路径被嵌入到电子邮件的某个属性中，例如 `PidLidReminderOverride`。
2.  攻击者通过 SMTP 将此电子邮件发送给受害者。
3.  当受害者使用 Outlook 打开或预览该电子邮件时，Outlook 会尝试连接到恶意 UNC 路径，并自动向攻击者控制的服务器发送受害者的 Net-NTLM 哈希。
4.  攻击者可以使用捕获的 Net-NTLM 哈希进行 NTLM 中继攻击或其他身份验证攻击，从而提升权限并访问受害者的资源。

**缓解措施：**
*   及时安装 Microsoft 提供的安全更新以修复此漏洞。
*   阻止出站 SMB 流量（端口 445）以防止 Net-NTLM 哈希泄露。
*   配置 Outlook 以禁用自动身份验证到 UNC 路径。
*   监视网络流量以检测对外部 SMB 服务器的连接尝试。

**项目地址:** [BronzeBee/cve-2023-23397](https://github.com/BronzeBee/cve-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #5

**来源**: [CVE-2023-23397-Cyb3rMaddy_CVE-2023-23397-Report.md](../2023/CVE-2023-23397-Cyb3rMaddy_CVE-2023-23397-Report.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击，窃取用户身份

**影响版本:** 受影响版本见漏洞库信息

**利用条件:** 攻击者需要能够发送包含恶意扩展MAPI属性的邮件给受害者

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397是一个Microsoft Outlook中的权限提升漏洞。攻击者可以通过发送包含特定格式的扩展MAPI属性（包含指向攻击者控制的SMB服务器的UNC路径）的电子邮件来触发此漏洞。当Outlook处理该邮件时，会自动尝试连接到攻击者的SMB服务器，并将用户的NTLM哈希发送给攻击者。攻击者可以利用收到的NTLM哈希进行NTLM Relay攻击，冒充受害者访问网络资源或执行其他恶意操作。

**有效性：**
根据漏洞描述和搜索结果，POC代码有效。漏洞利用无需用户交互。

**投毒风险：**
POC代码本身是一个利用漏洞的演示，主要包含漏洞利用相关的说明文档。README.md 主要描述了漏洞原理和利用方法，本身不包含恶意代码。投毒风险较低，可能存在恶意作者在其他利用代码中加入后门的可能性，所以投毒风险估计为10%。

**利用方式：**
1.  攻击者构建包含恶意扩展MAPI属性的电子邮件。
2.  恶意MAPI属性包含指向攻击者控制的SMB服务器的UNC路径。
3.  受害者使用Outlook客户端接收并处理该邮件。
4.  Outlook客户端尝试连接到攻击者的SMB服务器。
5.  Outlook客户端将受害者的NTLM哈希发送到攻击者的SMB服务器。
6.  攻击者使用NTLM哈希进行NTLM Relay攻击。

**项目地址:** [Cyb3rMaddy/CVE-2023-23397-Report](https://github.com/Cyb3rMaddy/CVE-2023-23397-Report)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #6

**来源**: [CVE-2023-23397-Muhammad-Ali007_OutlookNTLM_CVE-2023-23397.md](../2023/CVE-2023-23397-Muhammad-Ali007_OutlookNTLM_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本：Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise（具体版本范围参考漏洞库信息）

**利用条件:** 攻击者需要发送特制的日历邀请或邮件，受害者使用受影响的Outlook版本查看邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397是一个Microsoft Outlook权限提升漏洞。攻击者可以通过发送包含指向远程SMB服务器（或其他支持NTLM认证的服务器，如WebDAV）的恶意UNC路径的日历邀请或邮件来利用此漏洞。当Outlook处理该邮件时，会尝试连接到远程服务器以获取声音文件（ReminderSoundFile），这会触发NTLM认证过程，将受害者的Net-NTLM hash发送到攻击者的服务器。攻击者可以利用获取的Net-NTLM hash进行NTLM Relay攻击或其他凭据破解尝试。

**有效性:** 提供的POC代码通过PowerShell脚本实现了发送或保存包含恶意`ReminderSoundFile`属性的日历邀请，该属性指向攻击者控制的远程文件服务器。因此，该POC代码是有效的。

**投毒风险:** 代码功能明确，旨在利用CVE-2023-23397漏洞，没有发现隐藏的恶意代码或后门。代码目的是为了验证漏洞，没有额外恶意行为。因此投毒风险评估为0%。

**利用方式:**
1.  攻击者创建一个恶意的日历邀请或邮件。
2.  攻击者在日历邀请或邮件的`ReminderSoundFile`属性中设置一个UNC路径，指向攻击者控制的远程服务器（例如，`\\attacker_ip\share\file.wav`）。
3.  攻击者将日历邀请或邮件发送给受害者。
4.  当受害者使用受影响的Outlook版本打开该日历邀请或邮件时，Outlook会尝试连接到攻击者的远程服务器以获取声音文件。
5.  Outlook的连接尝试会触发NTLM认证过程，将受害者的Net-NTLM hash发送到攻击者的服务器。
6.  攻击者捕获Net-NTLM hash，并尝试破解或进行NTLM Relay攻击。

**项目地址:** [Muhammad-Ali007/OutlookNTLM_CVE-2023-23397](https://github.com/Muhammad-Ali007/OutlookNTLM_CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #7

**来源**: [CVE-2023-23397-Pushkarup_CVE-2023-23397.md](../2023/CVE-2023-23397-Pushkarup_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击，控制受害者账户

**影响版本:** 受影响版本：Microsoft Outlook 2013 SP1, Outlook 2016, Outlook 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise (查看漏洞库信息中的详细版本范围)

**利用条件:** 攻击者需要知道目标用户的邮件地址，并能够发送邮件到目标用户的Outlook邮箱。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 中的权限提升漏洞。攻击者可以通过发送特制的电子邮件，在无需用户交互的情况下，强制 Outlook 客户端连接到攻击者控制的 SMB 服务器，从而窃取 Net-NTLMv2 哈希。利用方式如下：

1.  **漏洞原理：** Outlook 在处理邮件时，如果邮件中包含 `ReminderSoundFile` 属性指向 UNC 路径（例如 `\\attacker_ip\share\sound.wav`），Outlook 会尝试连接到该路径。该连接使用用户的 Windows 凭据进行身份验证，因此攻击者可以捕获 Net-NTLMv2 哈希。

2.  **PoC 代码分析：**  提供的 PoC 代码 `Exploit.py`  利用 `win32com.client` 库来创建包含恶意 `ReminderSoundFile` 属性的 Outlook 日程安排。脚本会要求攻击者输入目标电子邮件地址和攻击者的 IP 地址（c2，也就是接收哈希的服务器）。然后，它将 UNC 路径设置为 `\\attacker_ip`，并将其设置为 `ReminderSoundFile` 属性。该脚本可以选择将恶意邮件保存为 `.msg` 文件或直接发送。

3.  **有效性评估：** 结合漏洞库信息、搜索引擎结果和 PoC 代码，可以确定该 PoC 代码是有效的。该漏洞已经被广泛研究和利用，并且CISA的已知被利用漏洞目录中也包含了该漏洞。

4.  **投毒风险评估：**  
    *   PoC 代码的主要功能是生成利用 CVE-2023-23397 漏洞的恶意邮件。代码本身看起来比较直接，没有明显的恶意行为，例如安装后门或执行其他未声明的操作。
    *   风险点可能存在于攻击者提供的 `attacker_ip` 参数。如果攻击者控制了该 IP 地址，他们可以捕获 NTLM 哈希。但是，这属于漏洞本身的利用方式，而不是 PoC 代码的投毒行为。
    *   文件LICENSE和README.md没有发现异常
    综合考虑，PoC 代码本身存在作者隐藏的恶意代码的风险较低。但始终需要保持警惕，在运行 PoC 代码之前，应仔细检查代码，并在隔离环境中运行。

5.  **利用方式总结：**
    1.  攻击者构造包含恶意 `ReminderSoundFile` 属性的 Outlook 日程安排。
    2.  将该日程安排以邮件的形式发送给目标用户。
    3.  当目标用户在 Outlook 中打开该邮件时，Outlook 客户端会尝试连接到 `ReminderSoundFile` 属性指定的 UNC 路径。
    4.  攻击者监听 SMB 流量，捕获 Net-NTLMv2 哈希。
    5.  攻击者可以使用捕获的哈希进行 NTLM Relay 攻击或尝试破解哈希以获得用户密码。

**项目地址:** [Pushkarup/CVE-2023-23397](https://github.com/Pushkarup/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #8

**来源**: [CVE-2023-23397-SecCTechs_CVE-2023-23397.md](../2023/CVE-2023-23397-SecCTechs_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击，进而获取用户身份

**影响版本:** 受影响版本包括：Microsoft Outlook 2013 SP1, Outlook 2016, Outlook 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise等。

**利用条件:** 攻击者需要向受害者发送特制的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的邮件，在无需用户交互的情况下，迫使 Outlook 客户端连接到攻击者控制的服务器，从而窃取受害者的 Net-NTLM hash。 这使得攻击者能够冒充受害者身份，进行 NTLM Relay 攻击。

**漏洞利用方式:**
1.  攻击者构造包含恶意 `PidLidReminderFileParameter` 属性的邮件，此属性指向攻击者控制的 UNC 路径。
2.  受害者使用 Outlook 客户端打开或预览该邮件。
3.  Outlook 客户端尝试连接到指定的 UNC 路径，进行身份验证，将 Net-NTLM hash 发送给攻击者。
4.  攻击者利用窃取的 Net-NTLM hash 进行 NTLM Relay 攻击，例如冒充受害者访问网络资源。

**漏洞利用有效性：**
根据搜索结果和漏洞库信息，该漏洞已经被广泛利用，CISA 已经将其列入已知被利用漏洞目录。 漏洞利用的有效性很高，且利用难度相对较低。

**投毒风险：**
提供的漏洞利用代码仅包含 GNU GPL 许可协议，没有发现任何恶意代码。因此，投毒风险较低，评估为0%。但实际环境中利用此漏洞时，需要注意获取PoC代码的来源，确保其安全性。

**项目地址:** [SecCTechs/CVE-2023-23397](https://github.com/SecCTechs/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #9

**来源**: [CVE-2023-23397-Symbolexe_CVE-2023-23397.md](../2023/CVE-2023-23397-Symbolexe_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM relay攻击，获取用户身份

**影响版本:** 受影响版本包括Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise等，具体版本号请参考漏洞库信息。

**利用条件:** 攻击者需要向受害者发送特制的邮件，受害者无需交互，只需预览或打开邮件即可触发。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个存在于 Microsoft Outlook 中的权限提升漏洞。攻击者可以构造特殊的邮件，利用扩展 MAPI (Messaging Application Programming Interface)属性，特别是 `PidLidReminderFileParameter` 属性，指向一个攻击者控制的 UNC 路径。当 Outlook 处理这封邮件时（无需用户点击任何链接，预览或打开邮件即可），会尝试连接到该 UNC 路径，触发 NTLM 认证过程，从而将用户的 NTLM hash 发送到攻击者控制的服务器。攻击者可以通过 NTLM relay攻击冒充用户身份。

**漏洞利用方式：**
1.  攻击者构造包含恶意 `PidLidReminderFileParameter` 属性的邮件，该属性指向攻击者控制的 UNC 路径。
2.  攻击者向受害者发送邮件。
3.  受害者使用 Outlook 预览或打开邮件。
4.  Outlook 尝试连接到 UNC 路径，触发 NTLM 认证。
5.  攻击者捕获 NTLM hash 并利用它进行身份验证。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞已被广泛利用，因此可以判断POC代码是有效的。

**投毒风险：**
提供的POC代码仅包含LICENSE和README.md文件。README.md描述了漏洞原理和利用方法，没有发现明显的恶意代码。但是，实际的漏洞利用工具可能包含额外的功能（例如，自动化的 NTLM relay 攻击等），这些功能可能被滥用于恶意目的。因此，从仓库本身来看，投毒的概率较低，但使用未经审核的第三方工具仍然存在风险。所以投毒风险为10%。

**漏洞库信息摘要：**
*   漏洞类型：权限提升
*   CVSS 评分：9.8 (严重)
*   受影响产品：Microsoft Outlook
*   修复方案：安装 Microsoft 提供的安全更新

**搜索引擎结果摘要：**
*   CVE-2023-23397 已经被 CISA 列入已知被利用漏洞目录。
*   该漏洞允许攻击者窃取 Net-NTLM hash。
*   Microsoft 提供了检测脚本。
*   有针对该漏洞的攻击样本分析报告。

**项目地址:** [Symbolexe/CVE-2023-23397](https://github.com/Symbolexe/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #10

**来源**: [CVE-2023-23397-TheUnknownSoul_CVE-2023-23397-PoW.md](../2023/CVE-2023-23397-TheUnknownSoul_CVE-2023-23397-PoW.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致Net-NTLM哈希泄露，攻击者可冒充受害者身份。

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要能够发送电子邮件给受害者，并且受害者需要使用存在漏洞的Outlook客户端打开邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397是一个Microsoft Outlook权限提升漏洞。该漏洞的利用方式是攻击者发送一封特制的电子邮件，其中包含指向攻击者控制的SMB服务器的UNC路径，当受害者使用存在漏洞的Outlook客户端打开该邮件时，会自动尝试连接到该SMB服务器，并将受害者的Net-NTLM哈希发送给攻击者。攻击者可以使用该哈希进行NTLM中继攻击，从而冒充受害者的身份。

根据提供的漏洞利用代码，该代码通过Python脚本生成包含恶意音频文件链接的Outlook日历邀请（appointment）。当受害者打开该邀请时，Outlook会尝试访问该链接，从而触发NTLM认证并泄露哈希值。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开的PoC代码。因此，提供的PoC代码在一定条件下是有效的。

**投毒风险：**
提供的PoC代码中，主要操作是构造恶意的Outlook日历邀请并发送给目标用户。代码包含发送邮件功能，这需要配置SMTP服务器的地址、端口、用户名和密码。潜在的投毒风险在于：
1.  **SMTP服务器配置:** 如果攻击者诱导用户使用其控制的SMTP服务器，则可能拦截或篡改发送的邮件。
2.  **附件路径:**  `full_path = f'\\\{path}\sound.wav'` 这行代码定义了SMB共享的路径。攻击者可能尝试通过精心构造路径，执行其他恶意操作。例如，如果Outlook客户端对UNC路径处理不当，可能导致文件读取或执行。
3.  **依赖库安全:**  虽然代码本身相对简单，但需要依赖Python环境和第三方库，这些依赖库可能存在安全漏洞。检查库的完整性。

代码中存在使用恶意SMB共享的风险，该路径可能会包含恶意payload或引发其他问题。因此判定存在10%的投毒风险，主要集中在引导用户设置攻击者控制的SMB服务器以及SMTP服务器。

**利用方式：**
1.  攻击者设置一个SMB服务器，并放置一个任意的音频文件（例如sound.wav）。
2.  攻击者运行提供的Python脚本，指定SMB服务器的IP地址和一个包含目标邮箱地址的文本文件。
3.  脚本会构造包含指向SMB服务器上音频文件的日历邀请，并将其发送给目标邮箱。
4.  当目标用户使用存在漏洞的Outlook客户端打开该日历邀请时，Outlook会自动尝试连接到SMB服务器以下载音频文件。
5.  由于SMB协议的认证机制，Outlook会将目标用户的Net-NTLM哈希发送给SMB服务器。
6.  攻击者可以在SMB服务器上捕获该哈希，并使用其进行NTLM中继攻击或其他攻击。


**项目地址:** [TheUnknownSoul/CVE-2023-23397-PoW](https://github.com/TheUnknownSoul/CVE-2023-23397-PoW)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #11

**来源**: [CVE-2023-23397-Trackflaw_CVE-2023-23397.md](../2023/CVE-2023-23397-Trackflaw_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致Net-NTLM hash泄露，进而进行身份冒充和横向移动

**影响版本:** 受影响版本：Microsoft Outlook 2013 SP1, Outlook 2016, Outlook 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise。详见漏洞库信息中的cpeApplicability。

**利用条件:** 攻击者需要能够发送邮件给受害者。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞，攻击者通过构造包含指向恶意 SMB 服务器 UNC 路径的特殊邮件（例如，利用 `reminder_sound_file` 字段），当 Outlook 客户端处理该邮件时，会自动尝试通过 SMB 协议连接到攻击者的服务器，从而泄露受害者的 Net-NTLM hash。由于 Outlook 客户端会自动处理邮件，因此该漏洞是零点击漏洞。

**漏洞利用方式：**
1.  攻击者构造一个恶意的 `.msg` 文件，其中包含指向攻击者控制的 SMB 服务器的 UNC 路径，该路径位于 `reminder_sound_file` 字段中。
2.  攻击者通过邮件将此恶意 `.msg` 文件发送给受害者。
3.  当受害者的 Outlook 客户端收到并处理此邮件时，会自动尝试连接到攻击者的 SMB 服务器。
4.  攻击者的 SMB 服务器捕获受害者的 Net-NTLM hash。
5.  攻击者可以使用此 hash 进行身份冒充或尝试破解密码。

**有效性：**
提供的 POC 代码 `CVE-2023-23397.py` 有效。它利用 `independentsoft.msg` 库创建恶意 `.msg` 文件，并使用 `smtplib` 库将其作为附件发送给受害者。

**投毒风险：**
该仓库中的 POC 代码没有发现明显的投毒代码。代码的主要功能是生成恶意的 Outlook 邮件并发送，以触发漏洞。所有操作都与其描述相符，没有隐藏的恶意行为。

**项目地址:** [Trackflaw/CVE-2023-23397](https://github.com/Trackflaw/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #12

**来源**: [CVE-2023-23397-Zeppperoni_CVE-2023-23397-Patch.md](../2023/CVE-2023-23397-Zeppperoni_CVE-2023-23397-Patch.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者窃取 Net-NTLM 哈希，模拟受害者身份

**影响版本:** 受影响版本包括 Microsoft Outlook 2013 SP1, 2016, 2019, Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021

**利用条件:** 攻击者需要向受害者发送特制的邮件，不需要用户交互

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以构造包含恶意的 `PidLidReminderFileParameter` 属性的电子邮件，当 Outlook 客户端处理这封邮件时，会尝试连接到攻击者控制的 UNC 路径，从而泄露用户的 Net-NTLMv2 哈希。由于 Outlook 会自动处理邮件，因此无需用户交互。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞已被积极利用，CISA 已将其添加到已知被利用的漏洞目录中。漏洞利用的有效性较高。

**投毒风险：**
提供的代码是一个用于修补 CVE-2023-23397 的 PowerShell 脚本。脚本会检查系统上是否已安装相关的安全更新（KB5023696, KB5023706, KB5023702），如果未安装，则从 Microsoft Update Catalog 下载并安装。该脚本相对简单，主要用于自动安装补丁。但仍存在轻微投毒风险，例如脚本可能下载错误或恶意的更新文件（即使可能性较低），或者在特定系统配置下导致意外错误。因此，投毒风险评估为5%。

**利用方式：**
1.  **攻击者构造恶意邮件：** 攻击者创建一个包含恶意 `PidLidReminderFileParameter` 属性的电子邮件。该属性指向攻击者控制的 SMB 服务器。
2.  **受害者接收邮件：** 受害者使用受影响版本的 Microsoft Outlook 接收邮件。
3.  **Outlook 尝试连接：** Outlook 客户端自动处理邮件，并尝试连接到恶意邮件中指定的 UNC 路径。
4.  **NTLM 哈希泄露：** 受害者的 Net-NTLMv2 哈希被发送到攻击者控制的 SMB 服务器。
5.  **攻击者利用哈希：** 攻击者可以使用窃取的 NTLM 哈希进行 NTLM 中继攻击，从而模拟受害者身份并访问网络资源。

**项目地址:** [Zeppperoni/CVE-2023-23397-Patch](https://github.com/Zeppperoni/CVE-2023-23397-Patch)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #13

**来源**: [CVE-2023-23397-ahmedkhlief_CVE-2023-23397-POC-Using-Interop-Outlook.md](../2023/CVE-2023-23397-ahmedkhlief_CVE-2023-23397-POC-Using-Interop-Outlook.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击和权限提升

**影响版本:** 受影响版本：Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise 的特定版本

**利用条件:** 攻击者需要向受害者发送包含恶意属性的邮件、日历邀请或任务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以利用此漏洞窃取受害者的 Net-NTLM 哈希，然后使用该哈希进行 NTLM 中继攻击，从而冒充受害者。漏洞原理是Outlook在处理某些MAPI属性（如ReminderSoundFile）时，会尝试访问指定的 UNC 路径，而无需用户交互。这导致Outlook向该 UNC 路径指向的服务器发送 NTLM 身份验证请求。攻击者可以通过控制这个 UNC 路径，将身份验证请求重定向到攻击者控制的服务器，从而捕获 Net-NTLM 哈希。

**有效性评估：**
提供的 POC 代码尝试创建一个包含特定 ReminderSoundFile 路径的 Outlook 日历项。该路径指向一个攻击者控制的 UNC 路径（`\\192.168.70.222\test.wav`）。通过设置该属性，当 Outlook 处理此日历项时，会尝试访问该路径，从而触发 NTLM 身份验证请求。因此，提供的 POC 代码基本有效，可以用于触发该漏洞。

**投毒风险分析：**
该代码片段的主要功能是创建并配置 Outlook 日历项，并未发现任何与投毒相关的恶意代码。例如，没有下载或执行其他文件的操作，也没有修改系统配置或窃取用户数据的行为。README文件也只是说明了如何使用 Microsoft.Office.Interop.Outlook 实现 POC，并没有任何恶意内容。

**漏洞利用方式：**
1.  攻击者创建一个包含恶意属性（ReminderSoundFile）的 Outlook 日历项、邮件或者任务。
2.  攻击者将包含该恶意属性的 Outlook 日历项发送给受害者。
3.  受害者打开或预览该日历项（无需进一步交互）。
4.  Outlook 尝试访问 ReminderSoundFile 属性中指定的 UNC 路径。
5.  Outlook 向攻击者控制的服务器发送 NTLM 身份验证请求。
6.  攻击者捕获 Net-NTLM 哈希。
7.  攻击者使用捕获的 Net-NTLM 哈希进行 NTLM 中继攻击，提升权限。

**项目地址:** [ahmedkhlief/CVE-2023-23397-POC-Using-Interop-Outlook](https://github.com/ahmedkhlief/CVE-2023-23397-POC-Using-Interop-Outlook)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #14

**来源**: [CVE-2023-23397-ahmedkhlief_CVE-2023-23397-POC.md](../2023/CVE-2023-23397-ahmedkhlief_CVE-2023-23397-POC.md)

## CVE-2023-23397

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致NTLM Relay攻击

**影响版本:** 受影响版本见漏洞库信息

**利用条件:** 攻击者需要发送特制的邮件或日历邀请给受害者

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 的权限提升漏洞。攻击者可以通过发送包含恶意 `PidLidReminderFileParameter` 属性的电子邮件、日历邀请或任务请求来利用此漏洞。当 Outlook 处理此属性时，它会尝试连接到攻击者控制的 UNC 路径，从而强制 Outlook 对攻击者控制的服务器进行身份验证，从而允许 NTLM 中继攻击。漏洞利用方式如下：

1.  **攻击者构造恶意数据：** 攻击者创建一个包含恶意 `PidLidReminderFileParameter` 属性的 Outlook 项目（例如，日历邀请）。此属性指向攻击者控制的 UNC 路径。
2.  **发送给受害者：** 攻击者将此恶意 Outlook 项目发送给受害者。
3.  **Outlook 处理：** 当受害者的 Outlook 客户端处理此项目时，它会尝试访问指定的 UNC 路径，触发 NTLM 身份验证。
4.  **NTLM 中继：** 攻击者可以使用 NTLM 中继攻击来冒充受害者或执行其他恶意操作。

**关于代码的分析：**

提供的 C# 代码片段 `Appointment.cs` 似乎是用于创建和操作 Outlook 约会对象的库的一部分。虽然代码本身没有明显的恶意行为，但重要的是要检查完整的代码库，包括 MsgKit 库的其他部分，以寻找潜在的漏洞或后门。由于MsgKit是一个开源项目，被投毒的可能性较低，但仍然存在风险。

**投毒风险评估：**

评估投毒风险需要检查整个 MsgKit 代码库以及构建和分发过程。在没有完整代码审查的情况下，无法确定代码中是否存在隐藏的恶意代码。但根据以往经验，开源项目的投毒风险较低。此处给出的10% 是基于以下判断：攻击者可能通过提交恶意PR的方式，在不引人注意的情况下添加恶意代码，或者利用MsgKit库的其他漏洞进行攻击。

**有效性评估：**

根据搜索结果，CVE-2023-23397 是一个已知且被积极利用的漏洞，并且有可用的PoC。该漏洞利用的关键在于 `PidLidReminderFileParameter` 属性的处理。代码片段 `Appointment.cs` 似乎与构造包含该属性的 Outlook 对象有关。因此，只要攻击者可以控制 `PidLidReminderFileParameter` 的值，就可以触发该漏洞。

综上所述，该漏洞利用是有效的，并且被广泛利用。

**项目地址:** [ahmedkhlief/CVE-2023-23397-POC](https://github.com/ahmedkhlief/CVE-2023-23397-POC)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #15

**来源**: [CVE-2023-23397-alicangnll_CVE-2023-23397.md](../2023/CVE-2023-23397-alicangnll_CVE-2023-23397.md)

# CVE-2023-23397

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-23397-Agentgilspy_CVE-2023-23397.md](../2023/CVE-2023-23397-Agentgilspy_CVE-2023-23397.md)

## CVE-2023-23397 - Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM哈希泄露，进而提升权限

**影响版本:** 受影响版本包括：Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise (详见漏洞库信息)

**利用条件:** 攻击者需要能够向受害者发送包含特制属性的邮件或日历邀请。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的电子邮件消息，特别是日历邀请，来利用此漏洞。该漏洞允许攻击者窃取受害者的 Net-NTLM 哈希。漏洞利用方式如下：

1.  **攻击者构建包含恶意`ReminderSoundFile`属性的日历邀请或邮件**。该属性指向攻击者控制的SMB服务器（例如 `\\192.168.1.7\nonexistent\sound.wav`）。
2.  **当Outlook客户端处理该邮件时**，即使受害者没有打开邮件，Outlook也会尝试访问该SMB共享以播放提醒声音。
3.  **此访问会触发NTLM身份验证**，将受害者的Net-NTLM哈希发送到攻击者的SMB服务器。
4.  **攻击者捕获Net-NTLM哈希**，并可以使用该哈希进行NTLM中继攻击或离线破解，从而冒充受害者。

**有效性：** 提供的PoC代码尝试通过创建一个新的日历邀请，设置`ReminderSoundFile`属性为攻击者控制的IP地址，并将该邀请发送给目标用户。该PoC代码是有效的，因为它模拟了攻击者可以利用此漏洞的方式。

**投毒风险：** 提供的代码仅包含用于演示漏洞的PoC代码和一个MIT许可协议。它旨在创建一个包含特定属性的Outlook日历项，该属性指向攻击者控制的服务器。没有发现任何作者隐藏的恶意或后门代码，因此投毒风险为0%。该LICENSE文件声明的Copyright (c) 2025 Gilchrist 也无实际意义，因为该漏洞在2023年就被披露。

**利用方式：** 漏洞的利用方式是通过构造包含恶意`ReminderSoundFile`属性的日历邀请或邮件，当受害者的Outlook客户端处理该邮件时，会自动向攻击者控制的SMB服务器发起NTLM认证，从而泄露受害者的Net-NTLM哈希。

**项目地址:** [Agentgilspy/CVE-2023-23397](https://github.com/Agentgilspy/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #2

**来源**: [CVE-2023-23397-AiK1d_CVE-2023-23397-POC.md](../2023/CVE-2023-23397-AiK1d_CVE-2023-23397-POC.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括 Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise 的特定版本。

**利用条件:** 攻击者需要能够发送包含恶意构造的邮件或日历邀请给受害者，受害者需要使用受影响的 Outlook 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的邮件，利用 `reminder_sound_file` 字段指定一个 UNC 路径，当 Outlook 客户端处理该邮件时，会尝试连接到指定的 UNC 路径，从而触发 NTLM 认证。攻击者可以捕获这个 NTLM hash 并进行中继攻击（NTLM Relay），从而冒充受害者的身份。

**有效性：**

提供的 POC 代码是有效的。该脚本会创建一个恶意的 appointment.msg 文件，其中 `reminder_sound_file` 设置为攻击者控制的 UNC 路径。然后，它通过 SMTP 发送包含此附件的电子邮件。当受害者打开电子邮件或 Outlook 处理该日历邀请时，会尝试访问 UNC 路径，从而泄露 NTLM hash。

**投毒风险：**

该仓库存在一定的投毒风险，约10%。

*   虽然核心 POC 代码的功能符合漏洞描述，但攻击者可以修改 `reminder_sound_file`  指向一个非预期的 SMB 服务器。如果攻击者控制的 SMB 服务器本身包含恶意代码，或者被用于投放恶意载荷，那么当受害者连接到该服务器时，可能受到进一步的攻击。例如，攻击者可以利用 Responder 等工具捕获 NTLM hash，然后使用该哈希执行其他攻击。
*   此外，代码中的 SMTP 服务器、用户名和密码为示例值，如果用户不修改这些值直接使用，会导致攻击失败或暴露攻击者信息。
*   README.md 文件比较简单，缺乏详细的漏洞描述和使用说明，可能导致用户误用或理解不足。

**利用方式：**

1.  攻击者构建一个恶意的 appointment.msg 文件，其中 `reminder_sound_file` 字段设置为攻击者控制的 UNC 路径，例如 `\\attacker.com\evilshare\sound.wav`。
2.  攻击者通过电子邮件将此恶意 appointment.msg 文件发送给受害者。
3.  受害者使用受影响的 Outlook 版本打开电子邮件或 Outlook 自动处理该日历邀请。
4.  Outlook 客户端尝试访问 `reminder_sound_file` 字段指定的 UNC 路径，从而向 `attacker.com` 发起 NTLM 认证。
5.  攻击者使用工具（例如 Responder）捕获 NTLM hash。
6.  攻击者使用捕获到的 NTLM hash 进行中继攻击，例如冒充受害者访问内部资源。

**项目地址:** [AiK1d/CVE-2023-23397-POC](https://github.com/AiK1d/CVE-2023-23397-POC)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #3

**来源**: [CVE-2023-23397-BillSkiCO_CVE-2023-23397_EXPLOIT.md](../2023/CVE-2023-23397-BillSkiCO_CVE-2023-23397_EXPLOIT.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise

**利用条件:** 攻击者需要向受害者发送特制的邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以利用此漏洞通过发送特制的邮件来窃取受害者的 Net-NTLM hash，从而冒充受害者身份并进行 NTLM 中继攻击。漏洞的根本原因是 Outlook 没有正确处理邮件中的特殊字段（主要是 `PidLidReminderFileParameter` 属性），导致 Outlook 尝试连接到攻击者控制的 UNC 路径，触发 NTLM 认证。由于 Outlook 在无需用户交互的情况下进行认证，因此攻击者可以在受害者不知情的情况下获取其 NTLM hash。

**利用方式：**

1.  攻击者创建一个包含恶意 `PidLidReminderFileParameter` 属性的特制邮件。该属性指向攻击者控制的 UNC 路径（例如 `\\attacker.com\share\file.wav`）。
2.  攻击者将该邮件发送给受害者。
3.  当 Outlook 处理该邮件时，它会尝试连接到攻击者控制的 UNC 路径，从而触发 NTLM 认证。
4.  攻击者捕获 NTLM hash 并使用它进行 NTLM 中继攻击。

**有效性：**

根据搜索结果，此漏洞已被广泛利用，并且 CISA 已将其添加到已知被利用的漏洞目录中。这表明存在可用的漏洞利用代码，并且该漏洞在野外被积极利用。

**投毒风险：**

提供的代码段是 Apache 2.0 许可协议，不是漏洞利用代码本身，因此无法从中分析是否存在投毒代码。考虑到这是一个许可协议，投毒的可能性极低。风险评估为0%。


**项目地址:** [BillSkiCO/CVE-2023-23397_EXPLOIT](https://github.com/BillSkiCO/CVE-2023-23397_EXPLOIT)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #4

**来源**: [CVE-2023-23397-BronzeBee_cve-2023-23397.md](../2023/CVE-2023-23397-BronzeBee_cve-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致Net-NTLM hash泄露和身份冒用

**影响版本:** 受影响版本包括：Microsoft Office LTSC 2021, Microsoft Outlook 2016, Microsoft 365 Apps for Enterprise, Microsoft Office 2019, Microsoft Outlook 2013 Service Pack 1。详细版本信息请参考漏洞库信息。

**利用条件:** 攻击者需要能够发送电子邮件给受害者。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-23397 是 Microsoft Outlook 中的一个权限提升漏洞。攻击者可以利用此漏洞窃取受害者的 Net-NTLM 哈希，从而冒充受害者的身份并进行进一步的攻击。漏洞的根源在于 Outlook 没有正确验证输入，攻击者可以通过在电子邮件中嵌入特制的 UNC 路径来触发漏洞。当 Outlook 处理包含恶意 UNC 路径的电子邮件时，它将尝试连接到该路径，并将用户的 Net-NTLM 哈希发送到攻击者控制的服务器。

**有效性评估：**
根据漏洞库信息和搜索结果，CVE-2023-23397 是一个已被积极利用的漏洞，并且CISA已将其添加到已知被利用的漏洞目录中。提供的漏洞利用代码似乎有效，因为它允许攻击者创建包含恶意 payload 的 TNEF 编码的 Outlook 电子邮件，并通过纯 SMTP 发送，从而触发 Net-NTLM 哈希的泄露。

**投毒风险评估：**
分析提供的POC代码，风险较低。代码主要功能是构造并发送包含漏洞触发payload的邮件。虽然任何代码都存在潜在的恶意修改可能，但该POC代码相对简单，主要利用了已知的漏洞。

**利用方式分析：**
1.  攻击者使用提供的 Python 脚本 (cve-2023-23397.py) 创建一个特制的 Outlook 电子邮件，其中包含一个指向攻击者控制的服务器的恶意 UNC 路径 (例如 \\10.10.10.10\share\1.wav)。这个 UNC 路径被嵌入到电子邮件的某个属性中，例如 `PidLidReminderOverride`。
2.  攻击者通过 SMTP 将此电子邮件发送给受害者。
3.  当受害者使用 Outlook 打开或预览该电子邮件时，Outlook 会尝试连接到恶意 UNC 路径，并自动向攻击者控制的服务器发送受害者的 Net-NTLM 哈希。
4.  攻击者可以使用捕获的 Net-NTLM 哈希进行 NTLM 中继攻击或其他身份验证攻击，从而提升权限并访问受害者的资源。

**缓解措施：**
*   及时安装 Microsoft 提供的安全更新以修复此漏洞。
*   阻止出站 SMB 流量（端口 445）以防止 Net-NTLM 哈希泄露。
*   配置 Outlook 以禁用自动身份验证到 UNC 路径。
*   监视网络流量以检测对外部 SMB 服务器的连接尝试。

**项目地址:** [BronzeBee/cve-2023-23397](https://github.com/BronzeBee/cve-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #5

**来源**: [CVE-2023-23397-Cyb3rMaddy_CVE-2023-23397-Report.md](../2023/CVE-2023-23397-Cyb3rMaddy_CVE-2023-23397-Report.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击，窃取用户身份

**影响版本:** 受影响版本见漏洞库信息

**利用条件:** 攻击者需要能够发送包含恶意扩展MAPI属性的邮件给受害者

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397是一个Microsoft Outlook中的权限提升漏洞。攻击者可以通过发送包含特定格式的扩展MAPI属性（包含指向攻击者控制的SMB服务器的UNC路径）的电子邮件来触发此漏洞。当Outlook处理该邮件时，会自动尝试连接到攻击者的SMB服务器，并将用户的NTLM哈希发送给攻击者。攻击者可以利用收到的NTLM哈希进行NTLM Relay攻击，冒充受害者访问网络资源或执行其他恶意操作。

**有效性：**
根据漏洞描述和搜索结果，POC代码有效。漏洞利用无需用户交互。

**投毒风险：**
POC代码本身是一个利用漏洞的演示，主要包含漏洞利用相关的说明文档。README.md 主要描述了漏洞原理和利用方法，本身不包含恶意代码。投毒风险较低，可能存在恶意作者在其他利用代码中加入后门的可能性，所以投毒风险估计为10%。

**利用方式：**
1.  攻击者构建包含恶意扩展MAPI属性的电子邮件。
2.  恶意MAPI属性包含指向攻击者控制的SMB服务器的UNC路径。
3.  受害者使用Outlook客户端接收并处理该邮件。
4.  Outlook客户端尝试连接到攻击者的SMB服务器。
5.  Outlook客户端将受害者的NTLM哈希发送到攻击者的SMB服务器。
6.  攻击者使用NTLM哈希进行NTLM Relay攻击。

**项目地址:** [Cyb3rMaddy/CVE-2023-23397-Report](https://github.com/Cyb3rMaddy/CVE-2023-23397-Report)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #6

**来源**: [CVE-2023-23397-Muhammad-Ali007_OutlookNTLM_CVE-2023-23397.md](../2023/CVE-2023-23397-Muhammad-Ali007_OutlookNTLM_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本：Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise（具体版本范围参考漏洞库信息）

**利用条件:** 攻击者需要发送特制的日历邀请或邮件，受害者使用受影响的Outlook版本查看邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397是一个Microsoft Outlook权限提升漏洞。攻击者可以通过发送包含指向远程SMB服务器（或其他支持NTLM认证的服务器，如WebDAV）的恶意UNC路径的日历邀请或邮件来利用此漏洞。当Outlook处理该邮件时，会尝试连接到远程服务器以获取声音文件（ReminderSoundFile），这会触发NTLM认证过程，将受害者的Net-NTLM hash发送到攻击者的服务器。攻击者可以利用获取的Net-NTLM hash进行NTLM Relay攻击或其他凭据破解尝试。

**有效性:** 提供的POC代码通过PowerShell脚本实现了发送或保存包含恶意`ReminderSoundFile`属性的日历邀请，该属性指向攻击者控制的远程文件服务器。因此，该POC代码是有效的。

**投毒风险:** 代码功能明确，旨在利用CVE-2023-23397漏洞，没有发现隐藏的恶意代码或后门。代码目的是为了验证漏洞，没有额外恶意行为。因此投毒风险评估为0%。

**利用方式:**
1.  攻击者创建一个恶意的日历邀请或邮件。
2.  攻击者在日历邀请或邮件的`ReminderSoundFile`属性中设置一个UNC路径，指向攻击者控制的远程服务器（例如，`\\attacker_ip\share\file.wav`）。
3.  攻击者将日历邀请或邮件发送给受害者。
4.  当受害者使用受影响的Outlook版本打开该日历邀请或邮件时，Outlook会尝试连接到攻击者的远程服务器以获取声音文件。
5.  Outlook的连接尝试会触发NTLM认证过程，将受害者的Net-NTLM hash发送到攻击者的服务器。
6.  攻击者捕获Net-NTLM hash，并尝试破解或进行NTLM Relay攻击。

**项目地址:** [Muhammad-Ali007/OutlookNTLM_CVE-2023-23397](https://github.com/Muhammad-Ali007/OutlookNTLM_CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #7

**来源**: [CVE-2023-23397-Pushkarup_CVE-2023-23397.md](../2023/CVE-2023-23397-Pushkarup_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击，控制受害者账户

**影响版本:** 受影响版本：Microsoft Outlook 2013 SP1, Outlook 2016, Outlook 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise (查看漏洞库信息中的详细版本范围)

**利用条件:** 攻击者需要知道目标用户的邮件地址，并能够发送邮件到目标用户的Outlook邮箱。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 中的权限提升漏洞。攻击者可以通过发送特制的电子邮件，在无需用户交互的情况下，强制 Outlook 客户端连接到攻击者控制的 SMB 服务器，从而窃取 Net-NTLMv2 哈希。利用方式如下：

1.  **漏洞原理：** Outlook 在处理邮件时，如果邮件中包含 `ReminderSoundFile` 属性指向 UNC 路径（例如 `\\attacker_ip\share\sound.wav`），Outlook 会尝试连接到该路径。该连接使用用户的 Windows 凭据进行身份验证，因此攻击者可以捕获 Net-NTLMv2 哈希。

2.  **PoC 代码分析：**  提供的 PoC 代码 `Exploit.py`  利用 `win32com.client` 库来创建包含恶意 `ReminderSoundFile` 属性的 Outlook 日程安排。脚本会要求攻击者输入目标电子邮件地址和攻击者的 IP 地址（c2，也就是接收哈希的服务器）。然后，它将 UNC 路径设置为 `\\attacker_ip`，并将其设置为 `ReminderSoundFile` 属性。该脚本可以选择将恶意邮件保存为 `.msg` 文件或直接发送。

3.  **有效性评估：** 结合漏洞库信息、搜索引擎结果和 PoC 代码，可以确定该 PoC 代码是有效的。该漏洞已经被广泛研究和利用，并且CISA的已知被利用漏洞目录中也包含了该漏洞。

4.  **投毒风险评估：**  
    *   PoC 代码的主要功能是生成利用 CVE-2023-23397 漏洞的恶意邮件。代码本身看起来比较直接，没有明显的恶意行为，例如安装后门或执行其他未声明的操作。
    *   风险点可能存在于攻击者提供的 `attacker_ip` 参数。如果攻击者控制了该 IP 地址，他们可以捕获 NTLM 哈希。但是，这属于漏洞本身的利用方式，而不是 PoC 代码的投毒行为。
    *   文件LICENSE和README.md没有发现异常
    综合考虑，PoC 代码本身存在作者隐藏的恶意代码的风险较低。但始终需要保持警惕，在运行 PoC 代码之前，应仔细检查代码，并在隔离环境中运行。

5.  **利用方式总结：**
    1.  攻击者构造包含恶意 `ReminderSoundFile` 属性的 Outlook 日程安排。
    2.  将该日程安排以邮件的形式发送给目标用户。
    3.  当目标用户在 Outlook 中打开该邮件时，Outlook 客户端会尝试连接到 `ReminderSoundFile` 属性指定的 UNC 路径。
    4.  攻击者监听 SMB 流量，捕获 Net-NTLMv2 哈希。
    5.  攻击者可以使用捕获的哈希进行 NTLM Relay 攻击或尝试破解哈希以获得用户密码。

**项目地址:** [Pushkarup/CVE-2023-23397](https://github.com/Pushkarup/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #8

**来源**: [CVE-2023-23397-SecCTechs_CVE-2023-23397.md](../2023/CVE-2023-23397-SecCTechs_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击，进而获取用户身份

**影响版本:** 受影响版本包括：Microsoft Outlook 2013 SP1, Outlook 2016, Outlook 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise等。

**利用条件:** 攻击者需要向受害者发送特制的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的邮件，在无需用户交互的情况下，迫使 Outlook 客户端连接到攻击者控制的服务器，从而窃取受害者的 Net-NTLM hash。 这使得攻击者能够冒充受害者身份，进行 NTLM Relay 攻击。

**漏洞利用方式:**
1.  攻击者构造包含恶意 `PidLidReminderFileParameter` 属性的邮件，此属性指向攻击者控制的 UNC 路径。
2.  受害者使用 Outlook 客户端打开或预览该邮件。
3.  Outlook 客户端尝试连接到指定的 UNC 路径，进行身份验证，将 Net-NTLM hash 发送给攻击者。
4.  攻击者利用窃取的 Net-NTLM hash 进行 NTLM Relay 攻击，例如冒充受害者访问网络资源。

**漏洞利用有效性：**
根据搜索结果和漏洞库信息，该漏洞已经被广泛利用，CISA 已经将其列入已知被利用漏洞目录。 漏洞利用的有效性很高，且利用难度相对较低。

**投毒风险：**
提供的漏洞利用代码仅包含 GNU GPL 许可协议，没有发现任何恶意代码。因此，投毒风险较低，评估为0%。但实际环境中利用此漏洞时，需要注意获取PoC代码的来源，确保其安全性。

**项目地址:** [SecCTechs/CVE-2023-23397](https://github.com/SecCTechs/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #9

**来源**: [CVE-2023-23397-Symbolexe_CVE-2023-23397.md](../2023/CVE-2023-23397-Symbolexe_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM relay攻击，获取用户身份

**影响版本:** 受影响版本包括Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise等，具体版本号请参考漏洞库信息。

**利用条件:** 攻击者需要向受害者发送特制的邮件，受害者无需交互，只需预览或打开邮件即可触发。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个存在于 Microsoft Outlook 中的权限提升漏洞。攻击者可以构造特殊的邮件，利用扩展 MAPI (Messaging Application Programming Interface)属性，特别是 `PidLidReminderFileParameter` 属性，指向一个攻击者控制的 UNC 路径。当 Outlook 处理这封邮件时（无需用户点击任何链接，预览或打开邮件即可），会尝试连接到该 UNC 路径，触发 NTLM 认证过程，从而将用户的 NTLM hash 发送到攻击者控制的服务器。攻击者可以通过 NTLM relay攻击冒充用户身份。

**漏洞利用方式：**
1.  攻击者构造包含恶意 `PidLidReminderFileParameter` 属性的邮件，该属性指向攻击者控制的 UNC 路径。
2.  攻击者向受害者发送邮件。
3.  受害者使用 Outlook 预览或打开邮件。
4.  Outlook 尝试连接到 UNC 路径，触发 NTLM 认证。
5.  攻击者捕获 NTLM hash 并利用它进行身份验证。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞已被广泛利用，因此可以判断POC代码是有效的。

**投毒风险：**
提供的POC代码仅包含LICENSE和README.md文件。README.md描述了漏洞原理和利用方法，没有发现明显的恶意代码。但是，实际的漏洞利用工具可能包含额外的功能（例如，自动化的 NTLM relay 攻击等），这些功能可能被滥用于恶意目的。因此，从仓库本身来看，投毒的概率较低，但使用未经审核的第三方工具仍然存在风险。所以投毒风险为10%。

**漏洞库信息摘要：**
*   漏洞类型：权限提升
*   CVSS 评分：9.8 (严重)
*   受影响产品：Microsoft Outlook
*   修复方案：安装 Microsoft 提供的安全更新

**搜索引擎结果摘要：**
*   CVE-2023-23397 已经被 CISA 列入已知被利用漏洞目录。
*   该漏洞允许攻击者窃取 Net-NTLM hash。
*   Microsoft 提供了检测脚本。
*   有针对该漏洞的攻击样本分析报告。

**项目地址:** [Symbolexe/CVE-2023-23397](https://github.com/Symbolexe/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #10

**来源**: [CVE-2023-23397-TheUnknownSoul_CVE-2023-23397-PoW.md](../2023/CVE-2023-23397-TheUnknownSoul_CVE-2023-23397-PoW.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致Net-NTLM哈希泄露，攻击者可冒充受害者身份。

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要能够发送电子邮件给受害者，并且受害者需要使用存在漏洞的Outlook客户端打开邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397是一个Microsoft Outlook权限提升漏洞。该漏洞的利用方式是攻击者发送一封特制的电子邮件，其中包含指向攻击者控制的SMB服务器的UNC路径，当受害者使用存在漏洞的Outlook客户端打开该邮件时，会自动尝试连接到该SMB服务器，并将受害者的Net-NTLM哈希发送给攻击者。攻击者可以使用该哈希进行NTLM中继攻击，从而冒充受害者的身份。

根据提供的漏洞利用代码，该代码通过Python脚本生成包含恶意音频文件链接的Outlook日历邀请（appointment）。当受害者打开该邀请时，Outlook会尝试访问该链接，从而触发NTLM认证并泄露哈希值。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开的PoC代码。因此，提供的PoC代码在一定条件下是有效的。

**投毒风险：**
提供的PoC代码中，主要操作是构造恶意的Outlook日历邀请并发送给目标用户。代码包含发送邮件功能，这需要配置SMTP服务器的地址、端口、用户名和密码。潜在的投毒风险在于：
1.  **SMTP服务器配置:** 如果攻击者诱导用户使用其控制的SMTP服务器，则可能拦截或篡改发送的邮件。
2.  **附件路径:**  `full_path = f'\\\{path}\sound.wav'` 这行代码定义了SMB共享的路径。攻击者可能尝试通过精心构造路径，执行其他恶意操作。例如，如果Outlook客户端对UNC路径处理不当，可能导致文件读取或执行。
3.  **依赖库安全:**  虽然代码本身相对简单，但需要依赖Python环境和第三方库，这些依赖库可能存在安全漏洞。检查库的完整性。

代码中存在使用恶意SMB共享的风险，该路径可能会包含恶意payload或引发其他问题。因此判定存在10%的投毒风险，主要集中在引导用户设置攻击者控制的SMB服务器以及SMTP服务器。

**利用方式：**
1.  攻击者设置一个SMB服务器，并放置一个任意的音频文件（例如sound.wav）。
2.  攻击者运行提供的Python脚本，指定SMB服务器的IP地址和一个包含目标邮箱地址的文本文件。
3.  脚本会构造包含指向SMB服务器上音频文件的日历邀请，并将其发送给目标邮箱。
4.  当目标用户使用存在漏洞的Outlook客户端打开该日历邀请时，Outlook会自动尝试连接到SMB服务器以下载音频文件。
5.  由于SMB协议的认证机制，Outlook会将目标用户的Net-NTLM哈希发送给SMB服务器。
6.  攻击者可以在SMB服务器上捕获该哈希，并使用其进行NTLM中继攻击或其他攻击。


**项目地址:** [TheUnknownSoul/CVE-2023-23397-PoW](https://github.com/TheUnknownSoul/CVE-2023-23397-PoW)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #11

**来源**: [CVE-2023-23397-Trackflaw_CVE-2023-23397.md](../2023/CVE-2023-23397-Trackflaw_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致Net-NTLM hash泄露，进而进行身份冒充和横向移动

**影响版本:** 受影响版本：Microsoft Outlook 2013 SP1, Outlook 2016, Outlook 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise。详见漏洞库信息中的cpeApplicability。

**利用条件:** 攻击者需要能够发送邮件给受害者。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞，攻击者通过构造包含指向恶意 SMB 服务器 UNC 路径的特殊邮件（例如，利用 `reminder_sound_file` 字段），当 Outlook 客户端处理该邮件时，会自动尝试通过 SMB 协议连接到攻击者的服务器，从而泄露受害者的 Net-NTLM hash。由于 Outlook 客户端会自动处理邮件，因此该漏洞是零点击漏洞。

**漏洞利用方式：**
1.  攻击者构造一个恶意的 `.msg` 文件，其中包含指向攻击者控制的 SMB 服务器的 UNC 路径，该路径位于 `reminder_sound_file` 字段中。
2.  攻击者通过邮件将此恶意 `.msg` 文件发送给受害者。
3.  当受害者的 Outlook 客户端收到并处理此邮件时，会自动尝试连接到攻击者的 SMB 服务器。
4.  攻击者的 SMB 服务器捕获受害者的 Net-NTLM hash。
5.  攻击者可以使用此 hash 进行身份冒充或尝试破解密码。

**有效性：**
提供的 POC 代码 `CVE-2023-23397.py` 有效。它利用 `independentsoft.msg` 库创建恶意 `.msg` 文件，并使用 `smtplib` 库将其作为附件发送给受害者。

**投毒风险：**
该仓库中的 POC 代码没有发现明显的投毒代码。代码的主要功能是生成恶意的 Outlook 邮件并发送，以触发漏洞。所有操作都与其描述相符，没有隐藏的恶意行为。

**项目地址:** [Trackflaw/CVE-2023-23397](https://github.com/Trackflaw/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #12

**来源**: [CVE-2023-23397-Zeppperoni_CVE-2023-23397-Patch.md](../2023/CVE-2023-23397-Zeppperoni_CVE-2023-23397-Patch.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者窃取 Net-NTLM 哈希，模拟受害者身份

**影响版本:** 受影响版本包括 Microsoft Outlook 2013 SP1, 2016, 2019, Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021

**利用条件:** 攻击者需要向受害者发送特制的邮件，不需要用户交互

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以构造包含恶意的 `PidLidReminderFileParameter` 属性的电子邮件，当 Outlook 客户端处理这封邮件时，会尝试连接到攻击者控制的 UNC 路径，从而泄露用户的 Net-NTLMv2 哈希。由于 Outlook 会自动处理邮件，因此无需用户交互。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞已被积极利用，CISA 已将其添加到已知被利用的漏洞目录中。漏洞利用的有效性较高。

**投毒风险：**
提供的代码是一个用于修补 CVE-2023-23397 的 PowerShell 脚本。脚本会检查系统上是否已安装相关的安全更新（KB5023696, KB5023706, KB5023702），如果未安装，则从 Microsoft Update Catalog 下载并安装。该脚本相对简单，主要用于自动安装补丁。但仍存在轻微投毒风险，例如脚本可能下载错误或恶意的更新文件（即使可能性较低），或者在特定系统配置下导致意外错误。因此，投毒风险评估为5%。

**利用方式：**
1.  **攻击者构造恶意邮件：** 攻击者创建一个包含恶意 `PidLidReminderFileParameter` 属性的电子邮件。该属性指向攻击者控制的 SMB 服务器。
2.  **受害者接收邮件：** 受害者使用受影响版本的 Microsoft Outlook 接收邮件。
3.  **Outlook 尝试连接：** Outlook 客户端自动处理邮件，并尝试连接到恶意邮件中指定的 UNC 路径。
4.  **NTLM 哈希泄露：** 受害者的 Net-NTLMv2 哈希被发送到攻击者控制的 SMB 服务器。
5.  **攻击者利用哈希：** 攻击者可以使用窃取的 NTLM 哈希进行 NTLM 中继攻击，从而模拟受害者身份并访问网络资源。

**项目地址:** [Zeppperoni/CVE-2023-23397-Patch](https://github.com/Zeppperoni/CVE-2023-23397-Patch)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #13

**来源**: [CVE-2023-23397-ahmedkhlief_CVE-2023-23397-POC-Using-Interop-Outlook.md](../2023/CVE-2023-23397-ahmedkhlief_CVE-2023-23397-POC-Using-Interop-Outlook.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击和权限提升

**影响版本:** 受影响版本：Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise 的特定版本

**利用条件:** 攻击者需要向受害者发送包含恶意属性的邮件、日历邀请或任务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以利用此漏洞窃取受害者的 Net-NTLM 哈希，然后使用该哈希进行 NTLM 中继攻击，从而冒充受害者。漏洞原理是Outlook在处理某些MAPI属性（如ReminderSoundFile）时，会尝试访问指定的 UNC 路径，而无需用户交互。这导致Outlook向该 UNC 路径指向的服务器发送 NTLM 身份验证请求。攻击者可以通过控制这个 UNC 路径，将身份验证请求重定向到攻击者控制的服务器，从而捕获 Net-NTLM 哈希。

**有效性评估：**
提供的 POC 代码尝试创建一个包含特定 ReminderSoundFile 路径的 Outlook 日历项。该路径指向一个攻击者控制的 UNC 路径（`\\192.168.70.222\test.wav`）。通过设置该属性，当 Outlook 处理此日历项时，会尝试访问该路径，从而触发 NTLM 身份验证请求。因此，提供的 POC 代码基本有效，可以用于触发该漏洞。

**投毒风险分析：**
该代码片段的主要功能是创建并配置 Outlook 日历项，并未发现任何与投毒相关的恶意代码。例如，没有下载或执行其他文件的操作，也没有修改系统配置或窃取用户数据的行为。README文件也只是说明了如何使用 Microsoft.Office.Interop.Outlook 实现 POC，并没有任何恶意内容。

**漏洞利用方式：**
1.  攻击者创建一个包含恶意属性（ReminderSoundFile）的 Outlook 日历项、邮件或者任务。
2.  攻击者将包含该恶意属性的 Outlook 日历项发送给受害者。
3.  受害者打开或预览该日历项（无需进一步交互）。
4.  Outlook 尝试访问 ReminderSoundFile 属性中指定的 UNC 路径。
5.  Outlook 向攻击者控制的服务器发送 NTLM 身份验证请求。
6.  攻击者捕获 Net-NTLM 哈希。
7.  攻击者使用捕获的 Net-NTLM 哈希进行 NTLM 中继攻击，提升权限。

**项目地址:** [ahmedkhlief/CVE-2023-23397-POC-Using-Interop-Outlook](https://github.com/ahmedkhlief/CVE-2023-23397-POC-Using-Interop-Outlook)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #14

**来源**: [CVE-2023-23397-ahmedkhlief_CVE-2023-23397-POC.md](../2023/CVE-2023-23397-ahmedkhlief_CVE-2023-23397-POC.md)

## CVE-2023-23397

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致NTLM Relay攻击

**影响版本:** 受影响版本见漏洞库信息

**利用条件:** 攻击者需要发送特制的邮件或日历邀请给受害者

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 的权限提升漏洞。攻击者可以通过发送包含恶意 `PidLidReminderFileParameter` 属性的电子邮件、日历邀请或任务请求来利用此漏洞。当 Outlook 处理此属性时，它会尝试连接到攻击者控制的 UNC 路径，从而强制 Outlook 对攻击者控制的服务器进行身份验证，从而允许 NTLM 中继攻击。漏洞利用方式如下：

1.  **攻击者构造恶意数据：** 攻击者创建一个包含恶意 `PidLidReminderFileParameter` 属性的 Outlook 项目（例如，日历邀请）。此属性指向攻击者控制的 UNC 路径。
2.  **发送给受害者：** 攻击者将此恶意 Outlook 项目发送给受害者。
3.  **Outlook 处理：** 当受害者的 Outlook 客户端处理此项目时，它会尝试访问指定的 UNC 路径，触发 NTLM 身份验证。
4.  **NTLM 中继：** 攻击者可以使用 NTLM 中继攻击来冒充受害者或执行其他恶意操作。

**关于代码的分析：**

提供的 C# 代码片段 `Appointment.cs` 似乎是用于创建和操作 Outlook 约会对象的库的一部分。虽然代码本身没有明显的恶意行为，但重要的是要检查完整的代码库，包括 MsgKit 库的其他部分，以寻找潜在的漏洞或后门。由于MsgKit是一个开源项目，被投毒的可能性较低，但仍然存在风险。

**投毒风险评估：**

评估投毒风险需要检查整个 MsgKit 代码库以及构建和分发过程。在没有完整代码审查的情况下，无法确定代码中是否存在隐藏的恶意代码。但根据以往经验，开源项目的投毒风险较低。此处给出的10% 是基于以下判断：攻击者可能通过提交恶意PR的方式，在不引人注意的情况下添加恶意代码，或者利用MsgKit库的其他漏洞进行攻击。

**有效性评估：**

根据搜索结果，CVE-2023-23397 是一个已知且被积极利用的漏洞，并且有可用的PoC。该漏洞利用的关键在于 `PidLidReminderFileParameter` 属性的处理。代码片段 `Appointment.cs` 似乎与构造包含该属性的 Outlook 对象有关。因此，只要攻击者可以控制 `PidLidReminderFileParameter` 的值，就可以触发该漏洞。

综上所述，该漏洞利用是有效的，并且被广泛利用。

**项目地址:** [ahmedkhlief/CVE-2023-23397-POC](https://github.com/ahmedkhlief/CVE-2023-23397-POC)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #15

**来源**: [CVE-2023-23397-alicangnll_CVE-2023-23397.md](../2023/CVE-2023-23397-alicangnll_CVE-2023-23397.md)

# CVE-2023-23397

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-23397-Agentgilspy_CVE-2023-23397.md](../2023/CVE-2023-23397-Agentgilspy_CVE-2023-23397.md)

## CVE-2023-23397 - Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM哈希泄露，进而提升权限

**影响版本:** 受影响版本包括：Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise (详见漏洞库信息)

**利用条件:** 攻击者需要能够向受害者发送包含特制属性的邮件或日历邀请。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的电子邮件消息，特别是日历邀请，来利用此漏洞。该漏洞允许攻击者窃取受害者的 Net-NTLM 哈希。漏洞利用方式如下：

1.  **攻击者构建包含恶意`ReminderSoundFile`属性的日历邀请或邮件**。该属性指向攻击者控制的SMB服务器（例如 `\\192.168.1.7\nonexistent\sound.wav`）。
2.  **当Outlook客户端处理该邮件时**，即使受害者没有打开邮件，Outlook也会尝试访问该SMB共享以播放提醒声音。
3.  **此访问会触发NTLM身份验证**，将受害者的Net-NTLM哈希发送到攻击者的SMB服务器。
4.  **攻击者捕获Net-NTLM哈希**，并可以使用该哈希进行NTLM中继攻击或离线破解，从而冒充受害者。

**有效性：** 提供的PoC代码尝试通过创建一个新的日历邀请，设置`ReminderSoundFile`属性为攻击者控制的IP地址，并将该邀请发送给目标用户。该PoC代码是有效的，因为它模拟了攻击者可以利用此漏洞的方式。

**投毒风险：** 提供的代码仅包含用于演示漏洞的PoC代码和一个MIT许可协议。它旨在创建一个包含特定属性的Outlook日历项，该属性指向攻击者控制的服务器。没有发现任何作者隐藏的恶意或后门代码，因此投毒风险为0%。该LICENSE文件声明的Copyright (c) 2025 Gilchrist 也无实际意义，因为该漏洞在2023年就被披露。

**利用方式：** 漏洞的利用方式是通过构造包含恶意`ReminderSoundFile`属性的日历邀请或邮件，当受害者的Outlook客户端处理该邮件时，会自动向攻击者控制的SMB服务器发起NTLM认证，从而泄露受害者的Net-NTLM哈希。

**项目地址:** [Agentgilspy/CVE-2023-23397](https://github.com/Agentgilspy/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #2

**来源**: [CVE-2023-23397-AiK1d_CVE-2023-23397-POC.md](../2023/CVE-2023-23397-AiK1d_CVE-2023-23397-POC.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括 Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise 的特定版本。

**利用条件:** 攻击者需要能够发送包含恶意构造的邮件或日历邀请给受害者，受害者需要使用受影响的 Outlook 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的邮件，利用 `reminder_sound_file` 字段指定一个 UNC 路径，当 Outlook 客户端处理该邮件时，会尝试连接到指定的 UNC 路径，从而触发 NTLM 认证。攻击者可以捕获这个 NTLM hash 并进行中继攻击（NTLM Relay），从而冒充受害者的身份。

**有效性：**

提供的 POC 代码是有效的。该脚本会创建一个恶意的 appointment.msg 文件，其中 `reminder_sound_file` 设置为攻击者控制的 UNC 路径。然后，它通过 SMTP 发送包含此附件的电子邮件。当受害者打开电子邮件或 Outlook 处理该日历邀请时，会尝试访问 UNC 路径，从而泄露 NTLM hash。

**投毒风险：**

该仓库存在一定的投毒风险，约10%。

*   虽然核心 POC 代码的功能符合漏洞描述，但攻击者可以修改 `reminder_sound_file`  指向一个非预期的 SMB 服务器。如果攻击者控制的 SMB 服务器本身包含恶意代码，或者被用于投放恶意载荷，那么当受害者连接到该服务器时，可能受到进一步的攻击。例如，攻击者可以利用 Responder 等工具捕获 NTLM hash，然后使用该哈希执行其他攻击。
*   此外，代码中的 SMTP 服务器、用户名和密码为示例值，如果用户不修改这些值直接使用，会导致攻击失败或暴露攻击者信息。
*   README.md 文件比较简单，缺乏详细的漏洞描述和使用说明，可能导致用户误用或理解不足。

**利用方式：**

1.  攻击者构建一个恶意的 appointment.msg 文件，其中 `reminder_sound_file` 字段设置为攻击者控制的 UNC 路径，例如 `\\attacker.com\evilshare\sound.wav`。
2.  攻击者通过电子邮件将此恶意 appointment.msg 文件发送给受害者。
3.  受害者使用受影响的 Outlook 版本打开电子邮件或 Outlook 自动处理该日历邀请。
4.  Outlook 客户端尝试访问 `reminder_sound_file` 字段指定的 UNC 路径，从而向 `attacker.com` 发起 NTLM 认证。
5.  攻击者使用工具（例如 Responder）捕获 NTLM hash。
6.  攻击者使用捕获到的 NTLM hash 进行中继攻击，例如冒充受害者访问内部资源。

**项目地址:** [AiK1d/CVE-2023-23397-POC](https://github.com/AiK1d/CVE-2023-23397-POC)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #3

**来源**: [CVE-2023-23397-BillSkiCO_CVE-2023-23397_EXPLOIT.md](../2023/CVE-2023-23397-BillSkiCO_CVE-2023-23397_EXPLOIT.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise

**利用条件:** 攻击者需要向受害者发送特制的邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以利用此漏洞通过发送特制的邮件来窃取受害者的 Net-NTLM hash，从而冒充受害者身份并进行 NTLM 中继攻击。漏洞的根本原因是 Outlook 没有正确处理邮件中的特殊字段（主要是 `PidLidReminderFileParameter` 属性），导致 Outlook 尝试连接到攻击者控制的 UNC 路径，触发 NTLM 认证。由于 Outlook 在无需用户交互的情况下进行认证，因此攻击者可以在受害者不知情的情况下获取其 NTLM hash。

**利用方式：**

1.  攻击者创建一个包含恶意 `PidLidReminderFileParameter` 属性的特制邮件。该属性指向攻击者控制的 UNC 路径（例如 `\\attacker.com\share\file.wav`）。
2.  攻击者将该邮件发送给受害者。
3.  当 Outlook 处理该邮件时，它会尝试连接到攻击者控制的 UNC 路径，从而触发 NTLM 认证。
4.  攻击者捕获 NTLM hash 并使用它进行 NTLM 中继攻击。

**有效性：**

根据搜索结果，此漏洞已被广泛利用，并且 CISA 已将其添加到已知被利用的漏洞目录中。这表明存在可用的漏洞利用代码，并且该漏洞在野外被积极利用。

**投毒风险：**

提供的代码段是 Apache 2.0 许可协议，不是漏洞利用代码本身，因此无法从中分析是否存在投毒代码。考虑到这是一个许可协议，投毒的可能性极低。风险评估为0%。


**项目地址:** [BillSkiCO/CVE-2023-23397_EXPLOIT](https://github.com/BillSkiCO/CVE-2023-23397_EXPLOIT)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #4

**来源**: [CVE-2023-23397-BronzeBee_cve-2023-23397.md](../2023/CVE-2023-23397-BronzeBee_cve-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致Net-NTLM hash泄露和身份冒用

**影响版本:** 受影响版本包括：Microsoft Office LTSC 2021, Microsoft Outlook 2016, Microsoft 365 Apps for Enterprise, Microsoft Office 2019, Microsoft Outlook 2013 Service Pack 1。详细版本信息请参考漏洞库信息。

**利用条件:** 攻击者需要能够发送电子邮件给受害者。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-23397 是 Microsoft Outlook 中的一个权限提升漏洞。攻击者可以利用此漏洞窃取受害者的 Net-NTLM 哈希，从而冒充受害者的身份并进行进一步的攻击。漏洞的根源在于 Outlook 没有正确验证输入，攻击者可以通过在电子邮件中嵌入特制的 UNC 路径来触发漏洞。当 Outlook 处理包含恶意 UNC 路径的电子邮件时，它将尝试连接到该路径，并将用户的 Net-NTLM 哈希发送到攻击者控制的服务器。

**有效性评估：**
根据漏洞库信息和搜索结果，CVE-2023-23397 是一个已被积极利用的漏洞，并且CISA已将其添加到已知被利用的漏洞目录中。提供的漏洞利用代码似乎有效，因为它允许攻击者创建包含恶意 payload 的 TNEF 编码的 Outlook 电子邮件，并通过纯 SMTP 发送，从而触发 Net-NTLM 哈希的泄露。

**投毒风险评估：**
分析提供的POC代码，风险较低。代码主要功能是构造并发送包含漏洞触发payload的邮件。虽然任何代码都存在潜在的恶意修改可能，但该POC代码相对简单，主要利用了已知的漏洞。

**利用方式分析：**
1.  攻击者使用提供的 Python 脚本 (cve-2023-23397.py) 创建一个特制的 Outlook 电子邮件，其中包含一个指向攻击者控制的服务器的恶意 UNC 路径 (例如 \\10.10.10.10\share\1.wav)。这个 UNC 路径被嵌入到电子邮件的某个属性中，例如 `PidLidReminderOverride`。
2.  攻击者通过 SMTP 将此电子邮件发送给受害者。
3.  当受害者使用 Outlook 打开或预览该电子邮件时，Outlook 会尝试连接到恶意 UNC 路径，并自动向攻击者控制的服务器发送受害者的 Net-NTLM 哈希。
4.  攻击者可以使用捕获的 Net-NTLM 哈希进行 NTLM 中继攻击或其他身份验证攻击，从而提升权限并访问受害者的资源。

**缓解措施：**
*   及时安装 Microsoft 提供的安全更新以修复此漏洞。
*   阻止出站 SMB 流量（端口 445）以防止 Net-NTLM 哈希泄露。
*   配置 Outlook 以禁用自动身份验证到 UNC 路径。
*   监视网络流量以检测对外部 SMB 服务器的连接尝试。

**项目地址:** [BronzeBee/cve-2023-23397](https://github.com/BronzeBee/cve-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #5

**来源**: [CVE-2023-23397-Cyb3rMaddy_CVE-2023-23397-Report.md](../2023/CVE-2023-23397-Cyb3rMaddy_CVE-2023-23397-Report.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击，窃取用户身份

**影响版本:** 受影响版本见漏洞库信息

**利用条件:** 攻击者需要能够发送包含恶意扩展MAPI属性的邮件给受害者

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397是一个Microsoft Outlook中的权限提升漏洞。攻击者可以通过发送包含特定格式的扩展MAPI属性（包含指向攻击者控制的SMB服务器的UNC路径）的电子邮件来触发此漏洞。当Outlook处理该邮件时，会自动尝试连接到攻击者的SMB服务器，并将用户的NTLM哈希发送给攻击者。攻击者可以利用收到的NTLM哈希进行NTLM Relay攻击，冒充受害者访问网络资源或执行其他恶意操作。

**有效性：**
根据漏洞描述和搜索结果，POC代码有效。漏洞利用无需用户交互。

**投毒风险：**
POC代码本身是一个利用漏洞的演示，主要包含漏洞利用相关的说明文档。README.md 主要描述了漏洞原理和利用方法，本身不包含恶意代码。投毒风险较低，可能存在恶意作者在其他利用代码中加入后门的可能性，所以投毒风险估计为10%。

**利用方式：**
1.  攻击者构建包含恶意扩展MAPI属性的电子邮件。
2.  恶意MAPI属性包含指向攻击者控制的SMB服务器的UNC路径。
3.  受害者使用Outlook客户端接收并处理该邮件。
4.  Outlook客户端尝试连接到攻击者的SMB服务器。
5.  Outlook客户端将受害者的NTLM哈希发送到攻击者的SMB服务器。
6.  攻击者使用NTLM哈希进行NTLM Relay攻击。

**项目地址:** [Cyb3rMaddy/CVE-2023-23397-Report](https://github.com/Cyb3rMaddy/CVE-2023-23397-Report)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #6

**来源**: [CVE-2023-23397-Muhammad-Ali007_OutlookNTLM_CVE-2023-23397.md](../2023/CVE-2023-23397-Muhammad-Ali007_OutlookNTLM_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本：Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise（具体版本范围参考漏洞库信息）

**利用条件:** 攻击者需要发送特制的日历邀请或邮件，受害者使用受影响的Outlook版本查看邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397是一个Microsoft Outlook权限提升漏洞。攻击者可以通过发送包含指向远程SMB服务器（或其他支持NTLM认证的服务器，如WebDAV）的恶意UNC路径的日历邀请或邮件来利用此漏洞。当Outlook处理该邮件时，会尝试连接到远程服务器以获取声音文件（ReminderSoundFile），这会触发NTLM认证过程，将受害者的Net-NTLM hash发送到攻击者的服务器。攻击者可以利用获取的Net-NTLM hash进行NTLM Relay攻击或其他凭据破解尝试。

**有效性:** 提供的POC代码通过PowerShell脚本实现了发送或保存包含恶意`ReminderSoundFile`属性的日历邀请，该属性指向攻击者控制的远程文件服务器。因此，该POC代码是有效的。

**投毒风险:** 代码功能明确，旨在利用CVE-2023-23397漏洞，没有发现隐藏的恶意代码或后门。代码目的是为了验证漏洞，没有额外恶意行为。因此投毒风险评估为0%。

**利用方式:**
1.  攻击者创建一个恶意的日历邀请或邮件。
2.  攻击者在日历邀请或邮件的`ReminderSoundFile`属性中设置一个UNC路径，指向攻击者控制的远程服务器（例如，`\\attacker_ip\share\file.wav`）。
3.  攻击者将日历邀请或邮件发送给受害者。
4.  当受害者使用受影响的Outlook版本打开该日历邀请或邮件时，Outlook会尝试连接到攻击者的远程服务器以获取声音文件。
5.  Outlook的连接尝试会触发NTLM认证过程，将受害者的Net-NTLM hash发送到攻击者的服务器。
6.  攻击者捕获Net-NTLM hash，并尝试破解或进行NTLM Relay攻击。

**项目地址:** [Muhammad-Ali007/OutlookNTLM_CVE-2023-23397](https://github.com/Muhammad-Ali007/OutlookNTLM_CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #7

**来源**: [CVE-2023-23397-Pushkarup_CVE-2023-23397.md](../2023/CVE-2023-23397-Pushkarup_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击，控制受害者账户

**影响版本:** 受影响版本：Microsoft Outlook 2013 SP1, Outlook 2016, Outlook 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise (查看漏洞库信息中的详细版本范围)

**利用条件:** 攻击者需要知道目标用户的邮件地址，并能够发送邮件到目标用户的Outlook邮箱。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 中的权限提升漏洞。攻击者可以通过发送特制的电子邮件，在无需用户交互的情况下，强制 Outlook 客户端连接到攻击者控制的 SMB 服务器，从而窃取 Net-NTLMv2 哈希。利用方式如下：

1.  **漏洞原理：** Outlook 在处理邮件时，如果邮件中包含 `ReminderSoundFile` 属性指向 UNC 路径（例如 `\\attacker_ip\share\sound.wav`），Outlook 会尝试连接到该路径。该连接使用用户的 Windows 凭据进行身份验证，因此攻击者可以捕获 Net-NTLMv2 哈希。

2.  **PoC 代码分析：**  提供的 PoC 代码 `Exploit.py`  利用 `win32com.client` 库来创建包含恶意 `ReminderSoundFile` 属性的 Outlook 日程安排。脚本会要求攻击者输入目标电子邮件地址和攻击者的 IP 地址（c2，也就是接收哈希的服务器）。然后，它将 UNC 路径设置为 `\\attacker_ip`，并将其设置为 `ReminderSoundFile` 属性。该脚本可以选择将恶意邮件保存为 `.msg` 文件或直接发送。

3.  **有效性评估：** 结合漏洞库信息、搜索引擎结果和 PoC 代码，可以确定该 PoC 代码是有效的。该漏洞已经被广泛研究和利用，并且CISA的已知被利用漏洞目录中也包含了该漏洞。

4.  **投毒风险评估：**  
    *   PoC 代码的主要功能是生成利用 CVE-2023-23397 漏洞的恶意邮件。代码本身看起来比较直接，没有明显的恶意行为，例如安装后门或执行其他未声明的操作。
    *   风险点可能存在于攻击者提供的 `attacker_ip` 参数。如果攻击者控制了该 IP 地址，他们可以捕获 NTLM 哈希。但是，这属于漏洞本身的利用方式，而不是 PoC 代码的投毒行为。
    *   文件LICENSE和README.md没有发现异常
    综合考虑，PoC 代码本身存在作者隐藏的恶意代码的风险较低。但始终需要保持警惕，在运行 PoC 代码之前，应仔细检查代码，并在隔离环境中运行。

5.  **利用方式总结：**
    1.  攻击者构造包含恶意 `ReminderSoundFile` 属性的 Outlook 日程安排。
    2.  将该日程安排以邮件的形式发送给目标用户。
    3.  当目标用户在 Outlook 中打开该邮件时，Outlook 客户端会尝试连接到 `ReminderSoundFile` 属性指定的 UNC 路径。
    4.  攻击者监听 SMB 流量，捕获 Net-NTLMv2 哈希。
    5.  攻击者可以使用捕获的哈希进行 NTLM Relay 攻击或尝试破解哈希以获得用户密码。

**项目地址:** [Pushkarup/CVE-2023-23397](https://github.com/Pushkarup/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #8

**来源**: [CVE-2023-23397-SecCTechs_CVE-2023-23397.md](../2023/CVE-2023-23397-SecCTechs_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击，进而获取用户身份

**影响版本:** 受影响版本包括：Microsoft Outlook 2013 SP1, Outlook 2016, Outlook 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise等。

**利用条件:** 攻击者需要向受害者发送特制的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的邮件，在无需用户交互的情况下，迫使 Outlook 客户端连接到攻击者控制的服务器，从而窃取受害者的 Net-NTLM hash。 这使得攻击者能够冒充受害者身份，进行 NTLM Relay 攻击。

**漏洞利用方式:**
1.  攻击者构造包含恶意 `PidLidReminderFileParameter` 属性的邮件，此属性指向攻击者控制的 UNC 路径。
2.  受害者使用 Outlook 客户端打开或预览该邮件。
3.  Outlook 客户端尝试连接到指定的 UNC 路径，进行身份验证，将 Net-NTLM hash 发送给攻击者。
4.  攻击者利用窃取的 Net-NTLM hash 进行 NTLM Relay 攻击，例如冒充受害者访问网络资源。

**漏洞利用有效性：**
根据搜索结果和漏洞库信息，该漏洞已经被广泛利用，CISA 已经将其列入已知被利用漏洞目录。 漏洞利用的有效性很高，且利用难度相对较低。

**投毒风险：**
提供的漏洞利用代码仅包含 GNU GPL 许可协议，没有发现任何恶意代码。因此，投毒风险较低，评估为0%。但实际环境中利用此漏洞时，需要注意获取PoC代码的来源，确保其安全性。

**项目地址:** [SecCTechs/CVE-2023-23397](https://github.com/SecCTechs/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #9

**来源**: [CVE-2023-23397-Symbolexe_CVE-2023-23397.md](../2023/CVE-2023-23397-Symbolexe_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM relay攻击，获取用户身份

**影响版本:** 受影响版本包括Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise等，具体版本号请参考漏洞库信息。

**利用条件:** 攻击者需要向受害者发送特制的邮件，受害者无需交互，只需预览或打开邮件即可触发。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个存在于 Microsoft Outlook 中的权限提升漏洞。攻击者可以构造特殊的邮件，利用扩展 MAPI (Messaging Application Programming Interface)属性，特别是 `PidLidReminderFileParameter` 属性，指向一个攻击者控制的 UNC 路径。当 Outlook 处理这封邮件时（无需用户点击任何链接，预览或打开邮件即可），会尝试连接到该 UNC 路径，触发 NTLM 认证过程，从而将用户的 NTLM hash 发送到攻击者控制的服务器。攻击者可以通过 NTLM relay攻击冒充用户身份。

**漏洞利用方式：**
1.  攻击者构造包含恶意 `PidLidReminderFileParameter` 属性的邮件，该属性指向攻击者控制的 UNC 路径。
2.  攻击者向受害者发送邮件。
3.  受害者使用 Outlook 预览或打开邮件。
4.  Outlook 尝试连接到 UNC 路径，触发 NTLM 认证。
5.  攻击者捕获 NTLM hash 并利用它进行身份验证。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞已被广泛利用，因此可以判断POC代码是有效的。

**投毒风险：**
提供的POC代码仅包含LICENSE和README.md文件。README.md描述了漏洞原理和利用方法，没有发现明显的恶意代码。但是，实际的漏洞利用工具可能包含额外的功能（例如，自动化的 NTLM relay 攻击等），这些功能可能被滥用于恶意目的。因此，从仓库本身来看，投毒的概率较低，但使用未经审核的第三方工具仍然存在风险。所以投毒风险为10%。

**漏洞库信息摘要：**
*   漏洞类型：权限提升
*   CVSS 评分：9.8 (严重)
*   受影响产品：Microsoft Outlook
*   修复方案：安装 Microsoft 提供的安全更新

**搜索引擎结果摘要：**
*   CVE-2023-23397 已经被 CISA 列入已知被利用漏洞目录。
*   该漏洞允许攻击者窃取 Net-NTLM hash。
*   Microsoft 提供了检测脚本。
*   有针对该漏洞的攻击样本分析报告。

**项目地址:** [Symbolexe/CVE-2023-23397](https://github.com/Symbolexe/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #10

**来源**: [CVE-2023-23397-TheUnknownSoul_CVE-2023-23397-PoW.md](../2023/CVE-2023-23397-TheUnknownSoul_CVE-2023-23397-PoW.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致Net-NTLM哈希泄露，攻击者可冒充受害者身份。

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要能够发送电子邮件给受害者，并且受害者需要使用存在漏洞的Outlook客户端打开邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397是一个Microsoft Outlook权限提升漏洞。该漏洞的利用方式是攻击者发送一封特制的电子邮件，其中包含指向攻击者控制的SMB服务器的UNC路径，当受害者使用存在漏洞的Outlook客户端打开该邮件时，会自动尝试连接到该SMB服务器，并将受害者的Net-NTLM哈希发送给攻击者。攻击者可以使用该哈希进行NTLM中继攻击，从而冒充受害者的身份。

根据提供的漏洞利用代码，该代码通过Python脚本生成包含恶意音频文件链接的Outlook日历邀请（appointment）。当受害者打开该邀请时，Outlook会尝试访问该链接，从而触发NTLM认证并泄露哈希值。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开的PoC代码。因此，提供的PoC代码在一定条件下是有效的。

**投毒风险：**
提供的PoC代码中，主要操作是构造恶意的Outlook日历邀请并发送给目标用户。代码包含发送邮件功能，这需要配置SMTP服务器的地址、端口、用户名和密码。潜在的投毒风险在于：
1.  **SMTP服务器配置:** 如果攻击者诱导用户使用其控制的SMTP服务器，则可能拦截或篡改发送的邮件。
2.  **附件路径:**  `full_path = f'\\\{path}\sound.wav'` 这行代码定义了SMB共享的路径。攻击者可能尝试通过精心构造路径，执行其他恶意操作。例如，如果Outlook客户端对UNC路径处理不当，可能导致文件读取或执行。
3.  **依赖库安全:**  虽然代码本身相对简单，但需要依赖Python环境和第三方库，这些依赖库可能存在安全漏洞。检查库的完整性。

代码中存在使用恶意SMB共享的风险，该路径可能会包含恶意payload或引发其他问题。因此判定存在10%的投毒风险，主要集中在引导用户设置攻击者控制的SMB服务器以及SMTP服务器。

**利用方式：**
1.  攻击者设置一个SMB服务器，并放置一个任意的音频文件（例如sound.wav）。
2.  攻击者运行提供的Python脚本，指定SMB服务器的IP地址和一个包含目标邮箱地址的文本文件。
3.  脚本会构造包含指向SMB服务器上音频文件的日历邀请，并将其发送给目标邮箱。
4.  当目标用户使用存在漏洞的Outlook客户端打开该日历邀请时，Outlook会自动尝试连接到SMB服务器以下载音频文件。
5.  由于SMB协议的认证机制，Outlook会将目标用户的Net-NTLM哈希发送给SMB服务器。
6.  攻击者可以在SMB服务器上捕获该哈希，并使用其进行NTLM中继攻击或其他攻击。


**项目地址:** [TheUnknownSoul/CVE-2023-23397-PoW](https://github.com/TheUnknownSoul/CVE-2023-23397-PoW)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #11

**来源**: [CVE-2023-23397-Trackflaw_CVE-2023-23397.md](../2023/CVE-2023-23397-Trackflaw_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致Net-NTLM hash泄露，进而进行身份冒充和横向移动

**影响版本:** 受影响版本：Microsoft Outlook 2013 SP1, Outlook 2016, Outlook 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise。详见漏洞库信息中的cpeApplicability。

**利用条件:** 攻击者需要能够发送邮件给受害者。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞，攻击者通过构造包含指向恶意 SMB 服务器 UNC 路径的特殊邮件（例如，利用 `reminder_sound_file` 字段），当 Outlook 客户端处理该邮件时，会自动尝试通过 SMB 协议连接到攻击者的服务器，从而泄露受害者的 Net-NTLM hash。由于 Outlook 客户端会自动处理邮件，因此该漏洞是零点击漏洞。

**漏洞利用方式：**
1.  攻击者构造一个恶意的 `.msg` 文件，其中包含指向攻击者控制的 SMB 服务器的 UNC 路径，该路径位于 `reminder_sound_file` 字段中。
2.  攻击者通过邮件将此恶意 `.msg` 文件发送给受害者。
3.  当受害者的 Outlook 客户端收到并处理此邮件时，会自动尝试连接到攻击者的 SMB 服务器。
4.  攻击者的 SMB 服务器捕获受害者的 Net-NTLM hash。
5.  攻击者可以使用此 hash 进行身份冒充或尝试破解密码。

**有效性：**
提供的 POC 代码 `CVE-2023-23397.py` 有效。它利用 `independentsoft.msg` 库创建恶意 `.msg` 文件，并使用 `smtplib` 库将其作为附件发送给受害者。

**投毒风险：**
该仓库中的 POC 代码没有发现明显的投毒代码。代码的主要功能是生成恶意的 Outlook 邮件并发送，以触发漏洞。所有操作都与其描述相符，没有隐藏的恶意行为。

**项目地址:** [Trackflaw/CVE-2023-23397](https://github.com/Trackflaw/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #12

**来源**: [CVE-2023-23397-Zeppperoni_CVE-2023-23397-Patch.md](../2023/CVE-2023-23397-Zeppperoni_CVE-2023-23397-Patch.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者窃取 Net-NTLM 哈希，模拟受害者身份

**影响版本:** 受影响版本包括 Microsoft Outlook 2013 SP1, 2016, 2019, Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021

**利用条件:** 攻击者需要向受害者发送特制的邮件，不需要用户交互

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以构造包含恶意的 `PidLidReminderFileParameter` 属性的电子邮件，当 Outlook 客户端处理这封邮件时，会尝试连接到攻击者控制的 UNC 路径，从而泄露用户的 Net-NTLMv2 哈希。由于 Outlook 会自动处理邮件，因此无需用户交互。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞已被积极利用，CISA 已将其添加到已知被利用的漏洞目录中。漏洞利用的有效性较高。

**投毒风险：**
提供的代码是一个用于修补 CVE-2023-23397 的 PowerShell 脚本。脚本会检查系统上是否已安装相关的安全更新（KB5023696, KB5023706, KB5023702），如果未安装，则从 Microsoft Update Catalog 下载并安装。该脚本相对简单，主要用于自动安装补丁。但仍存在轻微投毒风险，例如脚本可能下载错误或恶意的更新文件（即使可能性较低），或者在特定系统配置下导致意外错误。因此，投毒风险评估为5%。

**利用方式：**
1.  **攻击者构造恶意邮件：** 攻击者创建一个包含恶意 `PidLidReminderFileParameter` 属性的电子邮件。该属性指向攻击者控制的 SMB 服务器。
2.  **受害者接收邮件：** 受害者使用受影响版本的 Microsoft Outlook 接收邮件。
3.  **Outlook 尝试连接：** Outlook 客户端自动处理邮件，并尝试连接到恶意邮件中指定的 UNC 路径。
4.  **NTLM 哈希泄露：** 受害者的 Net-NTLMv2 哈希被发送到攻击者控制的 SMB 服务器。
5.  **攻击者利用哈希：** 攻击者可以使用窃取的 NTLM 哈希进行 NTLM 中继攻击，从而模拟受害者身份并访问网络资源。

**项目地址:** [Zeppperoni/CVE-2023-23397-Patch](https://github.com/Zeppperoni/CVE-2023-23397-Patch)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #13

**来源**: [CVE-2023-23397-ahmedkhlief_CVE-2023-23397-POC-Using-Interop-Outlook.md](../2023/CVE-2023-23397-ahmedkhlief_CVE-2023-23397-POC-Using-Interop-Outlook.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击和权限提升

**影响版本:** 受影响版本：Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise 的特定版本

**利用条件:** 攻击者需要向受害者发送包含恶意属性的邮件、日历邀请或任务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以利用此漏洞窃取受害者的 Net-NTLM 哈希，然后使用该哈希进行 NTLM 中继攻击，从而冒充受害者。漏洞原理是Outlook在处理某些MAPI属性（如ReminderSoundFile）时，会尝试访问指定的 UNC 路径，而无需用户交互。这导致Outlook向该 UNC 路径指向的服务器发送 NTLM 身份验证请求。攻击者可以通过控制这个 UNC 路径，将身份验证请求重定向到攻击者控制的服务器，从而捕获 Net-NTLM 哈希。

**有效性评估：**
提供的 POC 代码尝试创建一个包含特定 ReminderSoundFile 路径的 Outlook 日历项。该路径指向一个攻击者控制的 UNC 路径（`\\192.168.70.222\test.wav`）。通过设置该属性，当 Outlook 处理此日历项时，会尝试访问该路径，从而触发 NTLM 身份验证请求。因此，提供的 POC 代码基本有效，可以用于触发该漏洞。

**投毒风险分析：**
该代码片段的主要功能是创建并配置 Outlook 日历项，并未发现任何与投毒相关的恶意代码。例如，没有下载或执行其他文件的操作，也没有修改系统配置或窃取用户数据的行为。README文件也只是说明了如何使用 Microsoft.Office.Interop.Outlook 实现 POC，并没有任何恶意内容。

**漏洞利用方式：**
1.  攻击者创建一个包含恶意属性（ReminderSoundFile）的 Outlook 日历项、邮件或者任务。
2.  攻击者将包含该恶意属性的 Outlook 日历项发送给受害者。
3.  受害者打开或预览该日历项（无需进一步交互）。
4.  Outlook 尝试访问 ReminderSoundFile 属性中指定的 UNC 路径。
5.  Outlook 向攻击者控制的服务器发送 NTLM 身份验证请求。
6.  攻击者捕获 Net-NTLM 哈希。
7.  攻击者使用捕获的 Net-NTLM 哈希进行 NTLM 中继攻击，提升权限。

**项目地址:** [ahmedkhlief/CVE-2023-23397-POC-Using-Interop-Outlook](https://github.com/ahmedkhlief/CVE-2023-23397-POC-Using-Interop-Outlook)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #14

**来源**: [CVE-2023-23397-ahmedkhlief_CVE-2023-23397-POC.md](../2023/CVE-2023-23397-ahmedkhlief_CVE-2023-23397-POC.md)

## CVE-2023-23397

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致NTLM Relay攻击

**影响版本:** 受影响版本见漏洞库信息

**利用条件:** 攻击者需要发送特制的邮件或日历邀请给受害者

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 的权限提升漏洞。攻击者可以通过发送包含恶意 `PidLidReminderFileParameter` 属性的电子邮件、日历邀请或任务请求来利用此漏洞。当 Outlook 处理此属性时，它会尝试连接到攻击者控制的 UNC 路径，从而强制 Outlook 对攻击者控制的服务器进行身份验证，从而允许 NTLM 中继攻击。漏洞利用方式如下：

1.  **攻击者构造恶意数据：** 攻击者创建一个包含恶意 `PidLidReminderFileParameter` 属性的 Outlook 项目（例如，日历邀请）。此属性指向攻击者控制的 UNC 路径。
2.  **发送给受害者：** 攻击者将此恶意 Outlook 项目发送给受害者。
3.  **Outlook 处理：** 当受害者的 Outlook 客户端处理此项目时，它会尝试访问指定的 UNC 路径，触发 NTLM 身份验证。
4.  **NTLM 中继：** 攻击者可以使用 NTLM 中继攻击来冒充受害者或执行其他恶意操作。

**关于代码的分析：**

提供的 C# 代码片段 `Appointment.cs` 似乎是用于创建和操作 Outlook 约会对象的库的一部分。虽然代码本身没有明显的恶意行为，但重要的是要检查完整的代码库，包括 MsgKit 库的其他部分，以寻找潜在的漏洞或后门。由于MsgKit是一个开源项目，被投毒的可能性较低，但仍然存在风险。

**投毒风险评估：**

评估投毒风险需要检查整个 MsgKit 代码库以及构建和分发过程。在没有完整代码审查的情况下，无法确定代码中是否存在隐藏的恶意代码。但根据以往经验，开源项目的投毒风险较低。此处给出的10% 是基于以下判断：攻击者可能通过提交恶意PR的方式，在不引人注意的情况下添加恶意代码，或者利用MsgKit库的其他漏洞进行攻击。

**有效性评估：**

根据搜索结果，CVE-2023-23397 是一个已知且被积极利用的漏洞，并且有可用的PoC。该漏洞利用的关键在于 `PidLidReminderFileParameter` 属性的处理。代码片段 `Appointment.cs` 似乎与构造包含该属性的 Outlook 对象有关。因此，只要攻击者可以控制 `PidLidReminderFileParameter` 的值，就可以触发该漏洞。

综上所述，该漏洞利用是有效的，并且被广泛利用。

**项目地址:** [ahmedkhlief/CVE-2023-23397-POC](https://github.com/ahmedkhlief/CVE-2023-23397-POC)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #15

**来源**: [CVE-2023-23397-alicangnll_CVE-2023-23397.md](../2023/CVE-2023-23397-alicangnll_CVE-2023-23397.md)

# CVE-2023-23397

> 📦 该CVE有 **27** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-23397-Agentgilspy_CVE-2023-23397.md](../2023/CVE-2023-23397-Agentgilspy_CVE-2023-23397.md)

## CVE-2023-23397 - Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM哈希泄露，进而提升权限

**影响版本:** 受影响版本包括：Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise (详见漏洞库信息)

**利用条件:** 攻击者需要能够向受害者发送包含特制属性的邮件或日历邀请。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的电子邮件消息，特别是日历邀请，来利用此漏洞。该漏洞允许攻击者窃取受害者的 Net-NTLM 哈希。漏洞利用方式如下：

1.  **攻击者构建包含恶意`ReminderSoundFile`属性的日历邀请或邮件**。该属性指向攻击者控制的SMB服务器（例如 `\\192.168.1.7\nonexistent\sound.wav`）。
2.  **当Outlook客户端处理该邮件时**，即使受害者没有打开邮件，Outlook也会尝试访问该SMB共享以播放提醒声音。
3.  **此访问会触发NTLM身份验证**，将受害者的Net-NTLM哈希发送到攻击者的SMB服务器。
4.  **攻击者捕获Net-NTLM哈希**，并可以使用该哈希进行NTLM中继攻击或离线破解，从而冒充受害者。

**有效性：** 提供的PoC代码尝试通过创建一个新的日历邀请，设置`ReminderSoundFile`属性为攻击者控制的IP地址，并将该邀请发送给目标用户。该PoC代码是有效的，因为它模拟了攻击者可以利用此漏洞的方式。

**投毒风险：** 提供的代码仅包含用于演示漏洞的PoC代码和一个MIT许可协议。它旨在创建一个包含特定属性的Outlook日历项，该属性指向攻击者控制的服务器。没有发现任何作者隐藏的恶意或后门代码，因此投毒风险为0%。该LICENSE文件声明的Copyright (c) 2025 Gilchrist 也无实际意义，因为该漏洞在2023年就被披露。

**利用方式：** 漏洞的利用方式是通过构造包含恶意`ReminderSoundFile`属性的日历邀请或邮件，当受害者的Outlook客户端处理该邮件时，会自动向攻击者控制的SMB服务器发起NTLM认证，从而泄露受害者的Net-NTLM哈希。

**项目地址:** [Agentgilspy/CVE-2023-23397](https://github.com/Agentgilspy/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #2

**来源**: [CVE-2023-23397-AiK1d_CVE-2023-23397-POC.md](../2023/CVE-2023-23397-AiK1d_CVE-2023-23397-POC.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括 Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise 的特定版本。

**利用条件:** 攻击者需要能够发送包含恶意构造的邮件或日历邀请给受害者，受害者需要使用受影响的 Outlook 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的邮件，利用 `reminder_sound_file` 字段指定一个 UNC 路径，当 Outlook 客户端处理该邮件时，会尝试连接到指定的 UNC 路径，从而触发 NTLM 认证。攻击者可以捕获这个 NTLM hash 并进行中继攻击（NTLM Relay），从而冒充受害者的身份。

**有效性：**

提供的 POC 代码是有效的。该脚本会创建一个恶意的 appointment.msg 文件，其中 `reminder_sound_file` 设置为攻击者控制的 UNC 路径。然后，它通过 SMTP 发送包含此附件的电子邮件。当受害者打开电子邮件或 Outlook 处理该日历邀请时，会尝试访问 UNC 路径，从而泄露 NTLM hash。

**投毒风险：**

该仓库存在一定的投毒风险，约10%。

*   虽然核心 POC 代码的功能符合漏洞描述，但攻击者可以修改 `reminder_sound_file`  指向一个非预期的 SMB 服务器。如果攻击者控制的 SMB 服务器本身包含恶意代码，或者被用于投放恶意载荷，那么当受害者连接到该服务器时，可能受到进一步的攻击。例如，攻击者可以利用 Responder 等工具捕获 NTLM hash，然后使用该哈希执行其他攻击。
*   此外，代码中的 SMTP 服务器、用户名和密码为示例值，如果用户不修改这些值直接使用，会导致攻击失败或暴露攻击者信息。
*   README.md 文件比较简单，缺乏详细的漏洞描述和使用说明，可能导致用户误用或理解不足。

**利用方式：**

1.  攻击者构建一个恶意的 appointment.msg 文件，其中 `reminder_sound_file` 字段设置为攻击者控制的 UNC 路径，例如 `\\attacker.com\evilshare\sound.wav`。
2.  攻击者通过电子邮件将此恶意 appointment.msg 文件发送给受害者。
3.  受害者使用受影响的 Outlook 版本打开电子邮件或 Outlook 自动处理该日历邀请。
4.  Outlook 客户端尝试访问 `reminder_sound_file` 字段指定的 UNC 路径，从而向 `attacker.com` 发起 NTLM 认证。
5.  攻击者使用工具（例如 Responder）捕获 NTLM hash。
6.  攻击者使用捕获到的 NTLM hash 进行中继攻击，例如冒充受害者访问内部资源。

**项目地址:** [AiK1d/CVE-2023-23397-POC](https://github.com/AiK1d/CVE-2023-23397-POC)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #3

**来源**: [CVE-2023-23397-BillSkiCO_CVE-2023-23397_EXPLOIT.md](../2023/CVE-2023-23397-BillSkiCO_CVE-2023-23397_EXPLOIT.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise

**利用条件:** 攻击者需要向受害者发送特制的邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以利用此漏洞通过发送特制的邮件来窃取受害者的 Net-NTLM hash，从而冒充受害者身份并进行 NTLM 中继攻击。漏洞的根本原因是 Outlook 没有正确处理邮件中的特殊字段（主要是 `PidLidReminderFileParameter` 属性），导致 Outlook 尝试连接到攻击者控制的 UNC 路径，触发 NTLM 认证。由于 Outlook 在无需用户交互的情况下进行认证，因此攻击者可以在受害者不知情的情况下获取其 NTLM hash。

**利用方式：**

1.  攻击者创建一个包含恶意 `PidLidReminderFileParameter` 属性的特制邮件。该属性指向攻击者控制的 UNC 路径（例如 `\\attacker.com\share\file.wav`）。
2.  攻击者将该邮件发送给受害者。
3.  当 Outlook 处理该邮件时，它会尝试连接到攻击者控制的 UNC 路径，从而触发 NTLM 认证。
4.  攻击者捕获 NTLM hash 并使用它进行 NTLM 中继攻击。

**有效性：**

根据搜索结果，此漏洞已被广泛利用，并且 CISA 已将其添加到已知被利用的漏洞目录中。这表明存在可用的漏洞利用代码，并且该漏洞在野外被积极利用。

**投毒风险：**

提供的代码段是 Apache 2.0 许可协议，不是漏洞利用代码本身，因此无法从中分析是否存在投毒代码。考虑到这是一个许可协议，投毒的可能性极低。风险评估为0%。


**项目地址:** [BillSkiCO/CVE-2023-23397_EXPLOIT](https://github.com/BillSkiCO/CVE-2023-23397_EXPLOIT)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #4

**来源**: [CVE-2023-23397-BronzeBee_cve-2023-23397.md](../2023/CVE-2023-23397-BronzeBee_cve-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致Net-NTLM hash泄露和身份冒用

**影响版本:** 受影响版本包括：Microsoft Office LTSC 2021, Microsoft Outlook 2016, Microsoft 365 Apps for Enterprise, Microsoft Office 2019, Microsoft Outlook 2013 Service Pack 1。详细版本信息请参考漏洞库信息。

**利用条件:** 攻击者需要能够发送电子邮件给受害者。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-23397 是 Microsoft Outlook 中的一个权限提升漏洞。攻击者可以利用此漏洞窃取受害者的 Net-NTLM 哈希，从而冒充受害者的身份并进行进一步的攻击。漏洞的根源在于 Outlook 没有正确验证输入，攻击者可以通过在电子邮件中嵌入特制的 UNC 路径来触发漏洞。当 Outlook 处理包含恶意 UNC 路径的电子邮件时，它将尝试连接到该路径，并将用户的 Net-NTLM 哈希发送到攻击者控制的服务器。

**有效性评估：**
根据漏洞库信息和搜索结果，CVE-2023-23397 是一个已被积极利用的漏洞，并且CISA已将其添加到已知被利用的漏洞目录中。提供的漏洞利用代码似乎有效，因为它允许攻击者创建包含恶意 payload 的 TNEF 编码的 Outlook 电子邮件，并通过纯 SMTP 发送，从而触发 Net-NTLM 哈希的泄露。

**投毒风险评估：**
分析提供的POC代码，风险较低。代码主要功能是构造并发送包含漏洞触发payload的邮件。虽然任何代码都存在潜在的恶意修改可能，但该POC代码相对简单，主要利用了已知的漏洞。

**利用方式分析：**
1.  攻击者使用提供的 Python 脚本 (cve-2023-23397.py) 创建一个特制的 Outlook 电子邮件，其中包含一个指向攻击者控制的服务器的恶意 UNC 路径 (例如 \\10.10.10.10\share\1.wav)。这个 UNC 路径被嵌入到电子邮件的某个属性中，例如 `PidLidReminderOverride`。
2.  攻击者通过 SMTP 将此电子邮件发送给受害者。
3.  当受害者使用 Outlook 打开或预览该电子邮件时，Outlook 会尝试连接到恶意 UNC 路径，并自动向攻击者控制的服务器发送受害者的 Net-NTLM 哈希。
4.  攻击者可以使用捕获的 Net-NTLM 哈希进行 NTLM 中继攻击或其他身份验证攻击，从而提升权限并访问受害者的资源。

**缓解措施：**
*   及时安装 Microsoft 提供的安全更新以修复此漏洞。
*   阻止出站 SMB 流量（端口 445）以防止 Net-NTLM 哈希泄露。
*   配置 Outlook 以禁用自动身份验证到 UNC 路径。
*   监视网络流量以检测对外部 SMB 服务器的连接尝试。

**项目地址:** [BronzeBee/cve-2023-23397](https://github.com/BronzeBee/cve-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #5

**来源**: [CVE-2023-23397-Cyb3rMaddy_CVE-2023-23397-Report.md](../2023/CVE-2023-23397-Cyb3rMaddy_CVE-2023-23397-Report.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击，窃取用户身份

**影响版本:** 受影响版本见漏洞库信息

**利用条件:** 攻击者需要能够发送包含恶意扩展MAPI属性的邮件给受害者

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397是一个Microsoft Outlook中的权限提升漏洞。攻击者可以通过发送包含特定格式的扩展MAPI属性（包含指向攻击者控制的SMB服务器的UNC路径）的电子邮件来触发此漏洞。当Outlook处理该邮件时，会自动尝试连接到攻击者的SMB服务器，并将用户的NTLM哈希发送给攻击者。攻击者可以利用收到的NTLM哈希进行NTLM Relay攻击，冒充受害者访问网络资源或执行其他恶意操作。

**有效性：**
根据漏洞描述和搜索结果，POC代码有效。漏洞利用无需用户交互。

**投毒风险：**
POC代码本身是一个利用漏洞的演示，主要包含漏洞利用相关的说明文档。README.md 主要描述了漏洞原理和利用方法，本身不包含恶意代码。投毒风险较低，可能存在恶意作者在其他利用代码中加入后门的可能性，所以投毒风险估计为10%。

**利用方式：**
1.  攻击者构建包含恶意扩展MAPI属性的电子邮件。
2.  恶意MAPI属性包含指向攻击者控制的SMB服务器的UNC路径。
3.  受害者使用Outlook客户端接收并处理该邮件。
4.  Outlook客户端尝试连接到攻击者的SMB服务器。
5.  Outlook客户端将受害者的NTLM哈希发送到攻击者的SMB服务器。
6.  攻击者使用NTLM哈希进行NTLM Relay攻击。

**项目地址:** [Cyb3rMaddy/CVE-2023-23397-Report](https://github.com/Cyb3rMaddy/CVE-2023-23397-Report)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #6

**来源**: [CVE-2023-23397-Muhammad-Ali007_OutlookNTLM_CVE-2023-23397.md](../2023/CVE-2023-23397-Muhammad-Ali007_OutlookNTLM_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本：Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise（具体版本范围参考漏洞库信息）

**利用条件:** 攻击者需要发送特制的日历邀请或邮件，受害者使用受影响的Outlook版本查看邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397是一个Microsoft Outlook权限提升漏洞。攻击者可以通过发送包含指向远程SMB服务器（或其他支持NTLM认证的服务器，如WebDAV）的恶意UNC路径的日历邀请或邮件来利用此漏洞。当Outlook处理该邮件时，会尝试连接到远程服务器以获取声音文件（ReminderSoundFile），这会触发NTLM认证过程，将受害者的Net-NTLM hash发送到攻击者的服务器。攻击者可以利用获取的Net-NTLM hash进行NTLM Relay攻击或其他凭据破解尝试。

**有效性:** 提供的POC代码通过PowerShell脚本实现了发送或保存包含恶意`ReminderSoundFile`属性的日历邀请，该属性指向攻击者控制的远程文件服务器。因此，该POC代码是有效的。

**投毒风险:** 代码功能明确，旨在利用CVE-2023-23397漏洞，没有发现隐藏的恶意代码或后门。代码目的是为了验证漏洞，没有额外恶意行为。因此投毒风险评估为0%。

**利用方式:**
1.  攻击者创建一个恶意的日历邀请或邮件。
2.  攻击者在日历邀请或邮件的`ReminderSoundFile`属性中设置一个UNC路径，指向攻击者控制的远程服务器（例如，`\\attacker_ip\share\file.wav`）。
3.  攻击者将日历邀请或邮件发送给受害者。
4.  当受害者使用受影响的Outlook版本打开该日历邀请或邮件时，Outlook会尝试连接到攻击者的远程服务器以获取声音文件。
5.  Outlook的连接尝试会触发NTLM认证过程，将受害者的Net-NTLM hash发送到攻击者的服务器。
6.  攻击者捕获Net-NTLM hash，并尝试破解或进行NTLM Relay攻击。

**项目地址:** [Muhammad-Ali007/OutlookNTLM_CVE-2023-23397](https://github.com/Muhammad-Ali007/OutlookNTLM_CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #7

**来源**: [CVE-2023-23397-Pushkarup_CVE-2023-23397.md](../2023/CVE-2023-23397-Pushkarup_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击，控制受害者账户

**影响版本:** 受影响版本：Microsoft Outlook 2013 SP1, Outlook 2016, Outlook 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise (查看漏洞库信息中的详细版本范围)

**利用条件:** 攻击者需要知道目标用户的邮件地址，并能够发送邮件到目标用户的Outlook邮箱。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 中的权限提升漏洞。攻击者可以通过发送特制的电子邮件，在无需用户交互的情况下，强制 Outlook 客户端连接到攻击者控制的 SMB 服务器，从而窃取 Net-NTLMv2 哈希。利用方式如下：

1.  **漏洞原理：** Outlook 在处理邮件时，如果邮件中包含 `ReminderSoundFile` 属性指向 UNC 路径（例如 `\\attacker_ip\share\sound.wav`），Outlook 会尝试连接到该路径。该连接使用用户的 Windows 凭据进行身份验证，因此攻击者可以捕获 Net-NTLMv2 哈希。

2.  **PoC 代码分析：**  提供的 PoC 代码 `Exploit.py`  利用 `win32com.client` 库来创建包含恶意 `ReminderSoundFile` 属性的 Outlook 日程安排。脚本会要求攻击者输入目标电子邮件地址和攻击者的 IP 地址（c2，也就是接收哈希的服务器）。然后，它将 UNC 路径设置为 `\\attacker_ip`，并将其设置为 `ReminderSoundFile` 属性。该脚本可以选择将恶意邮件保存为 `.msg` 文件或直接发送。

3.  **有效性评估：** 结合漏洞库信息、搜索引擎结果和 PoC 代码，可以确定该 PoC 代码是有效的。该漏洞已经被广泛研究和利用，并且CISA的已知被利用漏洞目录中也包含了该漏洞。

4.  **投毒风险评估：**  
    *   PoC 代码的主要功能是生成利用 CVE-2023-23397 漏洞的恶意邮件。代码本身看起来比较直接，没有明显的恶意行为，例如安装后门或执行其他未声明的操作。
    *   风险点可能存在于攻击者提供的 `attacker_ip` 参数。如果攻击者控制了该 IP 地址，他们可以捕获 NTLM 哈希。但是，这属于漏洞本身的利用方式，而不是 PoC 代码的投毒行为。
    *   文件LICENSE和README.md没有发现异常
    综合考虑，PoC 代码本身存在作者隐藏的恶意代码的风险较低。但始终需要保持警惕，在运行 PoC 代码之前，应仔细检查代码，并在隔离环境中运行。

5.  **利用方式总结：**
    1.  攻击者构造包含恶意 `ReminderSoundFile` 属性的 Outlook 日程安排。
    2.  将该日程安排以邮件的形式发送给目标用户。
    3.  当目标用户在 Outlook 中打开该邮件时，Outlook 客户端会尝试连接到 `ReminderSoundFile` 属性指定的 UNC 路径。
    4.  攻击者监听 SMB 流量，捕获 Net-NTLMv2 哈希。
    5.  攻击者可以使用捕获的哈希进行 NTLM Relay 攻击或尝试破解哈希以获得用户密码。

**项目地址:** [Pushkarup/CVE-2023-23397](https://github.com/Pushkarup/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #8

**来源**: [CVE-2023-23397-SecCTechs_CVE-2023-23397.md](../2023/CVE-2023-23397-SecCTechs_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击，进而获取用户身份

**影响版本:** 受影响版本包括：Microsoft Outlook 2013 SP1, Outlook 2016, Outlook 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise等。

**利用条件:** 攻击者需要向受害者发送特制的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的邮件，在无需用户交互的情况下，迫使 Outlook 客户端连接到攻击者控制的服务器，从而窃取受害者的 Net-NTLM hash。 这使得攻击者能够冒充受害者身份，进行 NTLM Relay 攻击。

**漏洞利用方式:**
1.  攻击者构造包含恶意 `PidLidReminderFileParameter` 属性的邮件，此属性指向攻击者控制的 UNC 路径。
2.  受害者使用 Outlook 客户端打开或预览该邮件。
3.  Outlook 客户端尝试连接到指定的 UNC 路径，进行身份验证，将 Net-NTLM hash 发送给攻击者。
4.  攻击者利用窃取的 Net-NTLM hash 进行 NTLM Relay 攻击，例如冒充受害者访问网络资源。

**漏洞利用有效性：**
根据搜索结果和漏洞库信息，该漏洞已经被广泛利用，CISA 已经将其列入已知被利用漏洞目录。 漏洞利用的有效性很高，且利用难度相对较低。

**投毒风险：**
提供的漏洞利用代码仅包含 GNU GPL 许可协议，没有发现任何恶意代码。因此，投毒风险较低，评估为0%。但实际环境中利用此漏洞时，需要注意获取PoC代码的来源，确保其安全性。

**项目地址:** [SecCTechs/CVE-2023-23397](https://github.com/SecCTechs/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #9

**来源**: [CVE-2023-23397-Symbolexe_CVE-2023-23397.md](../2023/CVE-2023-23397-Symbolexe_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM relay攻击，获取用户身份

**影响版本:** 受影响版本包括Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise等，具体版本号请参考漏洞库信息。

**利用条件:** 攻击者需要向受害者发送特制的邮件，受害者无需交互，只需预览或打开邮件即可触发。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个存在于 Microsoft Outlook 中的权限提升漏洞。攻击者可以构造特殊的邮件，利用扩展 MAPI (Messaging Application Programming Interface)属性，特别是 `PidLidReminderFileParameter` 属性，指向一个攻击者控制的 UNC 路径。当 Outlook 处理这封邮件时（无需用户点击任何链接，预览或打开邮件即可），会尝试连接到该 UNC 路径，触发 NTLM 认证过程，从而将用户的 NTLM hash 发送到攻击者控制的服务器。攻击者可以通过 NTLM relay攻击冒充用户身份。

**漏洞利用方式：**
1.  攻击者构造包含恶意 `PidLidReminderFileParameter` 属性的邮件，该属性指向攻击者控制的 UNC 路径。
2.  攻击者向受害者发送邮件。
3.  受害者使用 Outlook 预览或打开邮件。
4.  Outlook 尝试连接到 UNC 路径，触发 NTLM 认证。
5.  攻击者捕获 NTLM hash 并利用它进行身份验证。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞已被广泛利用，因此可以判断POC代码是有效的。

**投毒风险：**
提供的POC代码仅包含LICENSE和README.md文件。README.md描述了漏洞原理和利用方法，没有发现明显的恶意代码。但是，实际的漏洞利用工具可能包含额外的功能（例如，自动化的 NTLM relay 攻击等），这些功能可能被滥用于恶意目的。因此，从仓库本身来看，投毒的概率较低，但使用未经审核的第三方工具仍然存在风险。所以投毒风险为10%。

**漏洞库信息摘要：**
*   漏洞类型：权限提升
*   CVSS 评分：9.8 (严重)
*   受影响产品：Microsoft Outlook
*   修复方案：安装 Microsoft 提供的安全更新

**搜索引擎结果摘要：**
*   CVE-2023-23397 已经被 CISA 列入已知被利用漏洞目录。
*   该漏洞允许攻击者窃取 Net-NTLM hash。
*   Microsoft 提供了检测脚本。
*   有针对该漏洞的攻击样本分析报告。

**项目地址:** [Symbolexe/CVE-2023-23397](https://github.com/Symbolexe/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #10

**来源**: [CVE-2023-23397-TheUnknownSoul_CVE-2023-23397-PoW.md](../2023/CVE-2023-23397-TheUnknownSoul_CVE-2023-23397-PoW.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致Net-NTLM哈希泄露，攻击者可冒充受害者身份。

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要能够发送电子邮件给受害者，并且受害者需要使用存在漏洞的Outlook客户端打开邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397是一个Microsoft Outlook权限提升漏洞。该漏洞的利用方式是攻击者发送一封特制的电子邮件，其中包含指向攻击者控制的SMB服务器的UNC路径，当受害者使用存在漏洞的Outlook客户端打开该邮件时，会自动尝试连接到该SMB服务器，并将受害者的Net-NTLM哈希发送给攻击者。攻击者可以使用该哈希进行NTLM中继攻击，从而冒充受害者的身份。

根据提供的漏洞利用代码，该代码通过Python脚本生成包含恶意音频文件链接的Outlook日历邀请（appointment）。当受害者打开该邀请时，Outlook会尝试访问该链接，从而触发NTLM认证并泄露哈希值。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开的PoC代码。因此，提供的PoC代码在一定条件下是有效的。

**投毒风险：**
提供的PoC代码中，主要操作是构造恶意的Outlook日历邀请并发送给目标用户。代码包含发送邮件功能，这需要配置SMTP服务器的地址、端口、用户名和密码。潜在的投毒风险在于：
1.  **SMTP服务器配置:** 如果攻击者诱导用户使用其控制的SMTP服务器，则可能拦截或篡改发送的邮件。
2.  **附件路径:**  `full_path = f'\\\{path}\sound.wav'` 这行代码定义了SMB共享的路径。攻击者可能尝试通过精心构造路径，执行其他恶意操作。例如，如果Outlook客户端对UNC路径处理不当，可能导致文件读取或执行。
3.  **依赖库安全:**  虽然代码本身相对简单，但需要依赖Python环境和第三方库，这些依赖库可能存在安全漏洞。检查库的完整性。

代码中存在使用恶意SMB共享的风险，该路径可能会包含恶意payload或引发其他问题。因此判定存在10%的投毒风险，主要集中在引导用户设置攻击者控制的SMB服务器以及SMTP服务器。

**利用方式：**
1.  攻击者设置一个SMB服务器，并放置一个任意的音频文件（例如sound.wav）。
2.  攻击者运行提供的Python脚本，指定SMB服务器的IP地址和一个包含目标邮箱地址的文本文件。
3.  脚本会构造包含指向SMB服务器上音频文件的日历邀请，并将其发送给目标邮箱。
4.  当目标用户使用存在漏洞的Outlook客户端打开该日历邀请时，Outlook会自动尝试连接到SMB服务器以下载音频文件。
5.  由于SMB协议的认证机制，Outlook会将目标用户的Net-NTLM哈希发送给SMB服务器。
6.  攻击者可以在SMB服务器上捕获该哈希，并使用其进行NTLM中继攻击或其他攻击。


**项目地址:** [TheUnknownSoul/CVE-2023-23397-PoW](https://github.com/TheUnknownSoul/CVE-2023-23397-PoW)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #11

**来源**: [CVE-2023-23397-Trackflaw_CVE-2023-23397.md](../2023/CVE-2023-23397-Trackflaw_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致Net-NTLM hash泄露，进而进行身份冒充和横向移动

**影响版本:** 受影响版本：Microsoft Outlook 2013 SP1, Outlook 2016, Outlook 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise。详见漏洞库信息中的cpeApplicability。

**利用条件:** 攻击者需要能够发送邮件给受害者。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞，攻击者通过构造包含指向恶意 SMB 服务器 UNC 路径的特殊邮件（例如，利用 `reminder_sound_file` 字段），当 Outlook 客户端处理该邮件时，会自动尝试通过 SMB 协议连接到攻击者的服务器，从而泄露受害者的 Net-NTLM hash。由于 Outlook 客户端会自动处理邮件，因此该漏洞是零点击漏洞。

**漏洞利用方式：**
1.  攻击者构造一个恶意的 `.msg` 文件，其中包含指向攻击者控制的 SMB 服务器的 UNC 路径，该路径位于 `reminder_sound_file` 字段中。
2.  攻击者通过邮件将此恶意 `.msg` 文件发送给受害者。
3.  当受害者的 Outlook 客户端收到并处理此邮件时，会自动尝试连接到攻击者的 SMB 服务器。
4.  攻击者的 SMB 服务器捕获受害者的 Net-NTLM hash。
5.  攻击者可以使用此 hash 进行身份冒充或尝试破解密码。

**有效性：**
提供的 POC 代码 `CVE-2023-23397.py` 有效。它利用 `independentsoft.msg` 库创建恶意 `.msg` 文件，并使用 `smtplib` 库将其作为附件发送给受害者。

**投毒风险：**
该仓库中的 POC 代码没有发现明显的投毒代码。代码的主要功能是生成恶意的 Outlook 邮件并发送，以触发漏洞。所有操作都与其描述相符，没有隐藏的恶意行为。

**项目地址:** [Trackflaw/CVE-2023-23397](https://github.com/Trackflaw/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #12

**来源**: [CVE-2023-23397-Zeppperoni_CVE-2023-23397-Patch.md](../2023/CVE-2023-23397-Zeppperoni_CVE-2023-23397-Patch.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者窃取 Net-NTLM 哈希，模拟受害者身份

**影响版本:** 受影响版本包括 Microsoft Outlook 2013 SP1, 2016, 2019, Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021

**利用条件:** 攻击者需要向受害者发送特制的邮件，不需要用户交互

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以构造包含恶意的 `PidLidReminderFileParameter` 属性的电子邮件，当 Outlook 客户端处理这封邮件时，会尝试连接到攻击者控制的 UNC 路径，从而泄露用户的 Net-NTLMv2 哈希。由于 Outlook 会自动处理邮件，因此无需用户交互。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞已被积极利用，CISA 已将其添加到已知被利用的漏洞目录中。漏洞利用的有效性较高。

**投毒风险：**
提供的代码是一个用于修补 CVE-2023-23397 的 PowerShell 脚本。脚本会检查系统上是否已安装相关的安全更新（KB5023696, KB5023706, KB5023702），如果未安装，则从 Microsoft Update Catalog 下载并安装。该脚本相对简单，主要用于自动安装补丁。但仍存在轻微投毒风险，例如脚本可能下载错误或恶意的更新文件（即使可能性较低），或者在特定系统配置下导致意外错误。因此，投毒风险评估为5%。

**利用方式：**
1.  **攻击者构造恶意邮件：** 攻击者创建一个包含恶意 `PidLidReminderFileParameter` 属性的电子邮件。该属性指向攻击者控制的 SMB 服务器。
2.  **受害者接收邮件：** 受害者使用受影响版本的 Microsoft Outlook 接收邮件。
3.  **Outlook 尝试连接：** Outlook 客户端自动处理邮件，并尝试连接到恶意邮件中指定的 UNC 路径。
4.  **NTLM 哈希泄露：** 受害者的 Net-NTLMv2 哈希被发送到攻击者控制的 SMB 服务器。
5.  **攻击者利用哈希：** 攻击者可以使用窃取的 NTLM 哈希进行 NTLM 中继攻击，从而模拟受害者身份并访问网络资源。

**项目地址:** [Zeppperoni/CVE-2023-23397-Patch](https://github.com/Zeppperoni/CVE-2023-23397-Patch)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #13

**来源**: [CVE-2023-23397-ahmedkhlief_CVE-2023-23397-POC-Using-Interop-Outlook.md](../2023/CVE-2023-23397-ahmedkhlief_CVE-2023-23397-POC-Using-Interop-Outlook.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击和权限提升

**影响版本:** 受影响版本：Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise 的特定版本

**利用条件:** 攻击者需要向受害者发送包含恶意属性的邮件、日历邀请或任务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以利用此漏洞窃取受害者的 Net-NTLM 哈希，然后使用该哈希进行 NTLM 中继攻击，从而冒充受害者。漏洞原理是Outlook在处理某些MAPI属性（如ReminderSoundFile）时，会尝试访问指定的 UNC 路径，而无需用户交互。这导致Outlook向该 UNC 路径指向的服务器发送 NTLM 身份验证请求。攻击者可以通过控制这个 UNC 路径，将身份验证请求重定向到攻击者控制的服务器，从而捕获 Net-NTLM 哈希。

**有效性评估：**
提供的 POC 代码尝试创建一个包含特定 ReminderSoundFile 路径的 Outlook 日历项。该路径指向一个攻击者控制的 UNC 路径（`\\192.168.70.222\test.wav`）。通过设置该属性，当 Outlook 处理此日历项时，会尝试访问该路径，从而触发 NTLM 身份验证请求。因此，提供的 POC 代码基本有效，可以用于触发该漏洞。

**投毒风险分析：**
该代码片段的主要功能是创建并配置 Outlook 日历项，并未发现任何与投毒相关的恶意代码。例如，没有下载或执行其他文件的操作，也没有修改系统配置或窃取用户数据的行为。README文件也只是说明了如何使用 Microsoft.Office.Interop.Outlook 实现 POC，并没有任何恶意内容。

**漏洞利用方式：**
1.  攻击者创建一个包含恶意属性（ReminderSoundFile）的 Outlook 日历项、邮件或者任务。
2.  攻击者将包含该恶意属性的 Outlook 日历项发送给受害者。
3.  受害者打开或预览该日历项（无需进一步交互）。
4.  Outlook 尝试访问 ReminderSoundFile 属性中指定的 UNC 路径。
5.  Outlook 向攻击者控制的服务器发送 NTLM 身份验证请求。
6.  攻击者捕获 Net-NTLM 哈希。
7.  攻击者使用捕获的 Net-NTLM 哈希进行 NTLM 中继攻击，提升权限。

**项目地址:** [ahmedkhlief/CVE-2023-23397-POC-Using-Interop-Outlook](https://github.com/ahmedkhlief/CVE-2023-23397-POC-Using-Interop-Outlook)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #14

**来源**: [CVE-2023-23397-ahmedkhlief_CVE-2023-23397-POC.md](../2023/CVE-2023-23397-ahmedkhlief_CVE-2023-23397-POC.md)

## CVE-2023-23397

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致NTLM Relay攻击

**影响版本:** 受影响版本见漏洞库信息

**利用条件:** 攻击者需要发送特制的邮件或日历邀请给受害者

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 的权限提升漏洞。攻击者可以通过发送包含恶意 `PidLidReminderFileParameter` 属性的电子邮件、日历邀请或任务请求来利用此漏洞。当 Outlook 处理此属性时，它会尝试连接到攻击者控制的 UNC 路径，从而强制 Outlook 对攻击者控制的服务器进行身份验证，从而允许 NTLM 中继攻击。漏洞利用方式如下：

1.  **攻击者构造恶意数据：** 攻击者创建一个包含恶意 `PidLidReminderFileParameter` 属性的 Outlook 项目（例如，日历邀请）。此属性指向攻击者控制的 UNC 路径。
2.  **发送给受害者：** 攻击者将此恶意 Outlook 项目发送给受害者。
3.  **Outlook 处理：** 当受害者的 Outlook 客户端处理此项目时，它会尝试访问指定的 UNC 路径，触发 NTLM 身份验证。
4.  **NTLM 中继：** 攻击者可以使用 NTLM 中继攻击来冒充受害者或执行其他恶意操作。

**关于代码的分析：**

提供的 C# 代码片段 `Appointment.cs` 似乎是用于创建和操作 Outlook 约会对象的库的一部分。虽然代码本身没有明显的恶意行为，但重要的是要检查完整的代码库，包括 MsgKit 库的其他部分，以寻找潜在的漏洞或后门。由于MsgKit是一个开源项目，被投毒的可能性较低，但仍然存在风险。

**投毒风险评估：**

评估投毒风险需要检查整个 MsgKit 代码库以及构建和分发过程。在没有完整代码审查的情况下，无法确定代码中是否存在隐藏的恶意代码。但根据以往经验，开源项目的投毒风险较低。此处给出的10% 是基于以下判断：攻击者可能通过提交恶意PR的方式，在不引人注意的情况下添加恶意代码，或者利用MsgKit库的其他漏洞进行攻击。

**有效性评估：**

根据搜索结果，CVE-2023-23397 是一个已知且被积极利用的漏洞，并且有可用的PoC。该漏洞利用的关键在于 `PidLidReminderFileParameter` 属性的处理。代码片段 `Appointment.cs` 似乎与构造包含该属性的 Outlook 对象有关。因此，只要攻击者可以控制 `PidLidReminderFileParameter` 的值，就可以触发该漏洞。

综上所述，该漏洞利用是有效的，并且被广泛利用。

**项目地址:** [ahmedkhlief/CVE-2023-23397-POC](https://github.com/ahmedkhlief/CVE-2023-23397-POC)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #15

**来源**: [CVE-2023-23397-api0cradle_CVE-2023-23397-POC-Powershell.md](../2023/CVE-2023-23397-api0cradle_CVE-2023-23397-POC-Powershell.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致NTLM Relay攻击，允许攻击者模拟受害者身份

**影响版本:** 受影响版本包括：Microsoft Office LTSC 2021, Microsoft Outlook 2016, Microsoft 365 Apps for Enterprise, Microsoft Office 2019, Microsoft Outlook 2013 Service Pack 1 (具体版本范围见漏洞库信息)

**利用条件:** 攻击者需要向受害者发送包含恶意构造的ReminderSoundFile字段的日历邀请或邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞，该漏洞允许攻击者通过发送特制的电子邮件来窃取受害者的 NTLM hash。攻击者无需与邮件进行任何交互（无需打开、点击等）即可触发漏洞。攻击者通过在Outlook日历邀请的`ReminderSoundFile`字段中指定一个指向远程SMB服务器的UNC路径，当Outlook处理该日历邀请时，会尝试访问该UNC路径，从而触发NTLM认证。攻击者可以捕获到NTLM hash并利用它进行 NTLM relay 攻击。从提供的漏洞利用代码来看，该脚本使用了 PowerShell 和 Outlook COM 对象来创建和发送带有恶意 `ReminderSoundFile` 属性的日历邀请。  该POC代码中不存在明显的投毒代码,它只是利用了该漏洞的特性，创建恶意的日历项目。 搜索引擎结果也印证了该漏洞的利用方式是发送包含恶意构造的日历邀请或邮件。 Microsoft的官方指南提供了检测和修复该漏洞的步骤，CISA也将其列入已知被利用的漏洞目录中，表明该漏洞已被广泛利用。

**项目地址:** [api0cradle/CVE-2023-23397-POC-Powershell](https://github.com/api0cradle/CVE-2023-23397-POC-Powershell)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #16

**来源**: [CVE-2023-23397-cleverg0d_CVE-2023-23397-PoC-PowerShell.md](../2023/CVE-2023-23397-cleverg0d_CVE-2023-23397-PoC-PowerShell.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击并获取用户凭据

**影响版本:** 受影响版本包括Microsoft Outlook 2013 Service Pack 1, Outlook 2016, Office 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise，具体版本号参考漏洞库信息。

**利用条件:** 攻击者需要能够向受害者发送电子邮件，并且受害者使用存在漏洞的Outlook版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的日历邀请或任务，其中包含指向攻击者控制的SMB服务器的UNC路径，来触发此漏洞。当Outlook处理此邀请或任务时，它将尝试连接到UNC路径，从而将受害者的NTLM哈希发送到攻击者的服务器。攻击者可以使用此哈希进行NTLM Relay攻击，或尝试破解哈希以获取用户的凭据。

**利用方式：**

1.  攻击者创建一个恶意的日历邀请或任务，在`ReminderSoundFile`字段中包含指向攻击者控制的SMB服务器的UNC路径（例如`\\attacker.com\evil.wav`）。
2.  攻击者将此日历邀请或任务发送给受害者。
3.  受害者使用易受攻击的Outlook版本打开日历邀请或任务。
4.  Outlook尝试播放提醒声音文件，因此会向攻击者的SMB服务器发送NTLM身份验证请求。
5.  攻击者捕获NTLM哈希并进行NTLM Relay攻击或尝试破解。

**有效性：**

提供的PowerShell PoC代码有效。它通过 `Send-CalendarNTLMLeak` 和 `Save-CalendarNTLMLeak` 函数创建包含恶意`ReminderSoundFile`属性的Outlook日历项目，从而触发漏洞。代码支持通过邮件发送日历或保存日历。

**投毒风险：**

PoC代码本身的功能是利用漏洞，但潜在的投毒风险在于：

*   **参数篡改：** 攻击者可能修改`remotefilepath`参数，使其指向其他恶意资源，例如包含恶意软件的SMB共享。
*   **代码执行：** 虽然PoC本身只是创建Outlook日历项目，但如果攻击者能够进一步利用NTLM Relay等方法，可能最终导致在目标系统上执行任意代码。

考虑到PoC的目的是演示漏洞，并且主要功能是利用Outlook的特性来触发NTLM认证，直接的投毒代码可能性较低。不过，由于PoC本身需要运行PowerShell，并且涉及到网络连接，存在一定的风险。如果用户不小心执行了被篡改过的PoC脚本，可能会带来安全风险。因此，评估投毒风险为10%。风险主要来自于使用者对PoC脚本的来源和内容缺乏验证，导致被恶意篡改的脚本利用。

**项目地址:** [cleverg0d/CVE-2023-23397-PoC-PowerShell](https://github.com/cleverg0d/CVE-2023-23397-PoC-PowerShell)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #17

**来源**: [CVE-2023-23397-djackreuter_CVE-2023-23397-PoC.md](../2023/CVE-2023-23397-djackreuter_CVE-2023-23397-PoC.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者提升权限并可能获取敏感信息

**影响版本:** 受影响版本包括 Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise。

**利用条件:** 攻击者需要能够发送包含特制属性的电子邮件给目标用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是 Microsoft Outlook 中的一个权限提升漏洞。攻击者可以通过发送包含特制 `PidLidReminderFileParameter` 属性的电子邮件，使得 Outlook 在无需用户交互的情况下尝试连接到攻击者控制的 UNC 路径。这导致攻击者可以捕获受害者的 NTLM 哈希。 

**有效性：** 根据搜索结果和漏洞库信息，此漏洞已被广泛利用，且存在公开可用的PoC代码，因此漏洞利用有效性高。

**投毒风险：** 提供的代码主要是一个 Visual Studio 解决方案文件和一个 Apache 2.0 许可文件，以及一个项目文件。虽然许可文件本身不构成风险，但代码中可能存在隐藏的恶意代码。然而，鉴于其整体结构和提供的上下文，直接投毒的可能性相对较低，但也并非完全排除。 因此，推测存在10%的投毒风险，因为下载的解决方案文件可能会包含恶意编译指令或者恶意依赖。

**利用方式：**

1.  **构造恶意邮件：** 攻击者创建一个包含特制`PidLidReminderFileParameter`属性的电子邮件。
2.  **发送邮件：** 攻击者将恶意邮件发送给目标用户。
3.  **触发连接：** 当Outlook处理该邮件时，会自动尝试连接到邮件中指定的UNC路径（攻击者控制的服务器）。
4.  **捕获哈希：** 攻击者利用中间人攻击或其它方式，捕获Outlook连接尝试中泄漏的受害者NTLM哈希。
5.  **权限提升：** 攻击者可以使用捕获的哈希进行NTLM中继攻击或其他攻击，以提升权限。

**项目地址:** [djackreuter/CVE-2023-23397-PoC](https://github.com/djackreuter/CVE-2023-23397-PoC)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #18

**来源**: [CVE-2023-23397-grn-bogo_CVE-2023-23397.md](../2023/CVE-2023-23397-grn-bogo_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击，窃取用户凭据

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, 和 Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要向受害者发送包含恶意属性的电子邮件、日历邀请或任务请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397是一个存在于Microsoft Outlook中的权限提升漏洞。攻击者可以通过发送特制的电子邮件，日历邀请或任务请求利用此漏洞。漏洞原理是Outlook在处理这些消息时，会错误地使用UNC路径作为`reminder_sound_file`属性的值，如果UNC路径指向攻击者控制的服务器，Outlook客户端将尝试通过NTLM身份验证连接到该服务器，从而泄漏用户的NTLM哈希。攻击者可以利用窃取的NTLM哈希进行NTLM中继攻击，冒充受害者。

根据提供的漏洞利用代码，该脚本会创建一个恶意的Outlook消息（.msg文件），该消息设置了`reminder_sound_file`属性为指向攻击者控制的SMB服务器的UNC路径（`\\10.21.22.3\testfile`）。当受害者打开此消息时，Outlook客户端会尝试访问该UNC路径，从而触发NTLM身份验证并泄露NTLM哈希。

**漏洞利用有效性：**
提供的POC代码有效，它展示了如何创建包含恶意`reminder_sound_file`属性的消息，从而触发NTLM哈希泄漏。

**投毒风险：**
此代码段本身没有明显的投毒行为。它只是一个PoC，用于演示漏洞利用过程。作者隐藏恶意代码的可能性较低。分析结果表明投毒风险为0%。

**利用方式：**
1.  攻击者构造包含恶意`reminder_sound_file`属性的Outlook消息（.msg文件）。
2.  攻击者将此消息发送给受害者。
3.  受害者使用Outlook打开该消息。
4.  Outlook客户端尝试访问`reminder_sound_file`指定的UNC路径。
5.  受害者的NTLM哈希通过SMB协议发送到攻击者控制的服务器。
6.  攻击者使用窃取的NTLM哈希进行NTLM中继攻击，冒充受害者。

**项目地址:** [grn-bogo/CVE-2023-23397](https://github.com/grn-bogo/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #19

**来源**: [CVE-2023-23397-im007_CVE-2023-23397.md](../2023/CVE-2023-23397-im007_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致权限提升和NTLM Relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本。

**利用条件:** 攻击者需要向受害者发送特制的邮件，无需用户交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以构造包含恶意 `PidLidReminderFileParameter` 属性的邮件，当 Outlook 处理此邮件时，会自动尝试连接到攻击者控制的 UNC 路径（例如：`\\attacker.com\share\file.wav`）。

由于 Outlook 在连接 UNC 路径时会使用当前用户的 NTLM 凭据进行身份验证，攻击者可以捕获 NTLM 哈希并利用它进行 NTLM Relay 攻击。

**有效性：**
根据漏洞库信息，CISA 已经将该漏洞添加到已知被利用漏洞目录中，搜索引擎结果中也包含了利用分析报告，表明该漏洞的利用是有效的。

**投毒风险：**
提供的漏洞利用代码仅包含 GNU General Public License 的文本，没有发现任何可疑的、与漏洞利用相关的后门代码。因此，投毒风险较低。

**利用方式：**
1.  攻击者构造包含恶意 `PidLidReminderFileParameter` 属性的邮件。
2.  受害者接收并使用受影响的 Outlook 版本打开邮件。
3.  Outlook 尝试连接到攻击者控制的 UNC 路径。
4.  Outlook 在连接时发送受害者的 NTLM 哈希。
5.  攻击者捕获 NTLM 哈希并进行 NTLM Relay 攻击，冒充受害者。

攻击无需用户交互，只需要受害者打开包含恶意属性的邮件。该漏洞的严重性在于其隐蔽性和潜在的 NTLM Relay 攻击。

**项目地址:** [im007/CVE-2023-23397](https://github.com/im007/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #20

**来源**: [CVE-2023-23397-j0eyv_CVE-2023-23397.md](../2023/CVE-2023-23397-j0eyv_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致NTLM Relay攻击，控制受害者账号

**影响版本:** 受影响版本：Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise (具体版本参考漏洞库信息)

**利用条件:** 攻击者需要向受害者发送包含恶意属性的邮件。受害者无需打开邮件，只需预览或接收即可触发漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞，攻击者可以利用该漏洞通过发送特制的电子邮件窃取受害者的 Net-NTLM 哈希值，从而发起 NTLM Relay 攻击。攻击者在邮件中设置一个指向攻击者控制的SMB服务器的`PidLidReminderFileParameter`属性。当Outlook处理该邮件时，会尝试连接该SMB服务器进行身份验证，从而将受害者的 Net-NTLM 哈希值发送给攻击者。此漏洞利用无需用户交互，只需预览或接收邮件即可触发，风险极高。

提供的两个 PowerShell 脚本 (`Detect-M365-Update.ps1` 和 `Remediate-M365-Update.ps1`) 并非直接的漏洞利用代码，而是用于检测和修复漏洞的脚本。 `Detect-M365-Update.ps1` 脚本用于检查 Outlook 是否已安装受影响的版本，而 `Remediate-M365-Update.ps1` 脚本尝试更新 Outlook 以修复漏洞。因此，提供的脚本本身不是漏洞利用，而是补丁检测/修复工具。 

投毒风险评估：虽然脚本本身是用于检测和修复漏洞，但脚本修改了注册表以及执行了更新操作。 如果脚本被篡改，可能存在投毒风险，例如，将更新服务器指向恶意地址，从而安装恶意软件。考虑到这种可能性，投毒风险评估为10%。脚本本身不包含明显的恶意代码，但是任何脚本都可能被篡改，所以存在风险。

**项目地址:** [j0eyv/CVE-2023-23397](https://github.com/j0eyv/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #21

**来源**: [CVE-2023-23397-jacquesquail_CVE-2023-23397.md](../2023/CVE-2023-23397-jacquesquail_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021

**利用条件:** 攻击者需要向受害者发送包含特制日历邀请的电子邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送包含特制日历邀请的电子邮件来利用此漏洞。漏洞利用的关键在于 `ReminderSoundFile` 字段，攻击者可以设置一个指向恶意 SMB 服务器的 UNC 路径。当 Outlook 处理这个日历邀请时，会尝试访问这个 UNC 路径，导致受害者的 Net-NTLM 哈希被发送到攻击者的服务器。这个哈希可以被用于 NTLM Relay 攻击，使攻击者能够冒充受害者。

根据提供的漏洞利用代码，POC.ps1 文件创建了一个 Outlook 日历邀请，并设置了 `ReminderSoundFile` 属性为一个 UNC 路径。攻击者需要修改第 11 行和第 12 行，分别设置攻击者控制的 UNC 路径和目标电子邮件地址。 README.md 文件提供了简单的使用说明。

有效性：提供的 POC 代码有效，可以触发漏洞，导致受害者的 Net-NTLM 哈希被发送到攻击者控制的服务器。

投毒风险：分析 POC 代码内容，并未发现作者隐藏的投毒代码。该仓库中的代码主要用于验证漏洞和安全测试，没有发现任何恶意行为。因此投毒风险为 0%。

利用方式：
1.  攻击者创建一个恶意的日历邀请，其中 `ReminderSoundFile` 属性设置为指向攻击者控制的 SMB 服务器的 UNC 路径。
2.  攻击者将此日历邀请发送给受害者。
3.  当受害者使用 Outlook 打开并处理此日历邀请时，Outlook 会尝试访问 `ReminderSoundFile` 中指定的 UNC 路径。
4.  此操作会触发 SMB 身份验证，导致受害者的 Net-NTLM 哈希被发送到攻击者控制的 SMB 服务器。
5.  攻击者可以使用获得的 Net-NTLM 哈希进行 NTLM Relay 攻击，冒充受害者访问网络资源。

**项目地址:** [jacquesquail/CVE-2023-23397](https://github.com/jacquesquail/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #22

**来源**: [CVE-2023-23397-ka7ana_CVE-2023-23397.md](../2023/CVE-2023-23397-ka7ana_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致身份冒用和NTLM relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021 和 Microsoft 365 Apps for Enterprise的特定版本。

**利用条件:** 攻击者需要向受害者发送包含特制ReminderSoundFile属性的电子邮件或会议邀请。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是 Microsoft Outlook 中的一个权限提升漏洞。该漏洞源于 Outlook 在处理提醒声音文件路径时存在缺陷。攻击者可以通过创建一个包含指向恶意 UNC 路径的 ReminderSoundFile 属性的电子邮件或会议邀请来利用此漏洞。当 Outlook 客户端尝试加载该声音文件时，会向攻击者的 SMB 服务器发送用户的 Net-NTLMv2 哈希，攻击者可以利用该哈希进行 NTLM relay 攻击，从而冒充受害者。

**有效性：** 提供的 PowerShell POC 代码利用了 Outlook 的 ReminderSoundFile 属性来触发漏洞。该代码创建一个带有特定设置的会议邀请，并将 ReminderSoundFile 设置为指向攻击者控制的 UNC 路径。当受害者的 Outlook 客户端处理此会议邀请时，会尝试访问该 UNC 路径，从而暴露 Net-NTLMv2 哈希。

**投毒风险：** 提供的 POC 代码本身不包含任何明显的恶意代码或后门。它只是一个简单的漏洞演示脚本，用于验证漏洞的存在。README.md 文件也只是解释了漏洞原理和POC代码的使用方法。因此，投毒风险为0%。

**利用方式：**

1.  攻击者创建一个恶意的电子邮件或会议邀请，其中包含特制的 ReminderSoundFile 属性，指向攻击者控制的 UNC 路径（例如：\\attacker.com\share\sound.wav）。
2.  攻击者将该电子邮件或会议邀请发送给受害者。
3.  当受害者的 Outlook 客户端收到并处理该邮件时，会尝试访问 ReminderSoundFile 中指定的 UNC 路径。
4.  Outlook 客户端会向攻击者的 SMB 服务器发送用户的 Net-NTLMv2 哈希。
5.  攻击者截获该哈希并使用它进行 NTLM relay 攻击，从而冒充受害者访问网络资源或执行其他恶意操作。

根据搜索引擎结果，此漏洞已被积极利用，CISA 已将其添加到已知被利用的漏洞目录中。因此，及时修补 Outlook 至关重要。

**项目地址:** [ka7ana/CVE-2023-23397](https://github.com/ka7ana/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #23

**来源**: [CVE-2023-23397-moneertv_CVE-2023-23397.md](../2023/CVE-2023-23397-moneertv_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise等，具体版本范围参考漏洞库信息。

**利用条件:** 攻击者需要向受害者发送包含恶意构造属性的邮件或日历邀请。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397是一个Microsoft Outlook权限提升漏洞，攻击者可以利用此漏洞发动NTLM Relay攻击。漏洞原理是Outlook在处理邮件或日历邀请时，会读取某些属性（如PidLidReminderFileParameter）中指定的UNC路径，并尝试进行NTLM身份验证。攻击者可以将此路径设置为指向攻击者控制的服务器，当Outlook尝试连接该服务器时，会将用户的NTLM哈希发送给攻击者。攻击者可以使用此哈希进行NTLM Relay攻击，冒充受害者访问网络资源。

**有效性：** 根据漏洞库信息，该漏洞已被积极利用，POC代码的存在进一步证实了其有效性。

**投毒风险：** 提供的代码片段`/tmp/a829982ba7bdb2d91914433ccf5b5a1f/Appointment.cs`是创建Outlook Appointment的C#代码，来自MsgKit库，用于创建.msg文件。粗略判断，此文件中直接包含明显恶意代码（如反弹shell，恶意下载执行等）的可能性较低。但仍存在一定的投毒风险，例如：

1.  **微妙的属性设置：** 攻击者可能在代码中添加不易察觉的属性设置，例如在`NamedProperties.AddProperty`中插入指向恶意服务器的UNC路径，从而触发漏洞，或者添加其他隐蔽的属性修改，利用其他未知的Outlook特性进行攻击。
2.  **依赖项风险：** 该代码依赖于MsgKit库和OpenMcdf库。这些依赖库本身可能存在漏洞或被植入后门。
3. **编译器和构建过程** 攻击者可能篡改编译配置，引入外部恶意代码

基于代码片段的初步分析，投毒风险较低，但需要更全面的代码审查和依赖项分析才能确定是否存在隐藏的恶意代码，因此给出10%的投毒风险。

**利用方式：**

1.  攻击者构造包含恶意`PidLidReminderFileParameter`或其他相关属性的邮件或日历邀请。
2.  受害者使用受影响版本的Outlook打开该邮件或日历邀请。
3.  Outlook尝试连接恶意UNC路径，并将受害者的NTLM哈希发送到攻击者控制的服务器。
4.  攻击者使用收到的NTLM哈希进行NTLM Relay攻击。

**修复建议：**

*   及时安装Microsoft官方发布的补丁。
*   限制Outlook对外部UNC路径的访问。
*   使用强身份验证方式，例如多因素身份验证，以降低NTLM Relay攻击的风险。

**项目地址:** [moneertv/CVE-2023-23397](https://github.com/moneertv/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #24

**来源**: [CVE-2023-23397-sarsaeroth_CVE-2023-23397-POC.md](../2023/CVE-2023-23397-sarsaeroth_CVE-2023-23397-POC.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括：Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise (详见漏洞库信息)

**利用条件:** 攻击者需要向受害者发送包含恶意属性的邮件或会议邀请。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的电子邮件，在无需用户交互的情况下，强制 Outlook 客户端连接到攻击者控制的 SMB 服务器，从而窃取受害者的 Net-NTLMv2 哈希。该漏洞利用邮件中的 `PidLidReminderFileParameter` 属性，该属性用于指定提醒声音文件的路径。攻击者可以将此路径设置为指向远程 SMB 服务器，当 Outlook 处理邮件时，会自动尝试访问该服务器，触发 NTLM 认证。漏洞利用代码（C implementation of Outlook 0-click vulnerability）的描述表明存在无需用户交互的攻击方式。虽然提供的POC文件只是简单的README.md, 但考虑到该漏洞原理的简单性和公开性，很容易就能实现完整的PoC。该漏洞已被CISA列入已知被利用漏洞目录，并有实际攻击案例。投毒风险评估：该代码仓库只包含一个README.md文件，风险较低。但不能完全排除作者后期添加恶意代码的可能性。该漏洞的利用方式是发送包含恶意属性的邮件，触发 Outlook 连接到攻击者控制的服务器，从而窃取 NTLM hash。

**项目地址:** [sarsaeroth/CVE-2023-23397-POC](https://github.com/sarsaeroth/CVE-2023-23397-POC)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #25

**来源**: [CVE-2023-23397-stevesec_CVE-2023-23397.md](../2023/CVE-2023-23397-stevesec_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致Net-NTLM hash泄露，进而冒充用户身份。

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, Outlook 2016, Office 2019, Office LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本，具体参见CVE描述。

**利用条件:** 攻击者需要向目标用户发送特制的邮件或会议邀请。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397是一个Microsoft Outlook权限提升漏洞。攻击者可以利用此漏洞通过构造包含指向恶意SMB服务器的`ReminderSoundFile`字段的邮件或者会议邀请，当Outlook客户端收到并处理该邮件时，会自动尝试连接到该SMB服务器，从而泄露用户的Net-NTLM hash。该漏洞利用无需用户交互（零点击）。

根据提供的漏洞库信息，该漏洞的CVSS v3.1评分为9.8，属于严重级别，并且已被CISA列入已知被利用漏洞目录。

搜索引擎结果显示，该漏洞已被广泛分析和利用，存在针对该漏洞的检测方法和缓解措施。

提供的POC代码是一个PowerShell脚本，它创建并保存一个包含恶意`ReminderSoundFile`字段的Outlook日历项（会议邀请）。`Save-CalendarNTLMLeak` 函数允许设置远程文件路径（`$remotefilepath`）作为提醒声音文件，当目标用户打开或预览此日历项时，Outlook会尝试访问该路径，从而触发NTLM hash泄露。

**有效性：** 提供的POC代码有效，可以用于触发漏洞，泄露Net-NTLM hash。

**投毒风险：** 提供的POC代码本身不包含明显的恶意代码，主要功能是生成包含漏洞利用载荷的Outlook日历项。因此，投毒风险较低，但不能完全排除作者在其他地方隐藏恶意代码的可能性。 经过分析，确认只有生成日历项功能，没有发现其他恶意代码，因此判定投毒风险为0%。

**利用方式：**
1.  攻击者使用提供的POC代码（或类似工具）生成包含指向攻击者控制的SMB服务器的恶意`ReminderSoundFile`字段的Outlook日历项（.msg文件）。
2.  攻击者将此日历项通过电子邮件发送给目标用户。
3.  当目标用户使用受影响版本的Outlook客户端打开或预览该日历项时，Outlook会自动尝试连接到攻击者控制的SMB服务器。
4.  目标用户的Net-NTLM hash会被发送到攻击者的SMB服务器。
5.  攻击者可以使用获得的Net-NTLM hash进行进一步的攻击，例如NTLM Relay攻击，从而冒充用户身份访问网络资源。

**项目地址:** [stevesec/CVE-2023-23397](https://github.com/stevesec/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #26

**来源**: [CVE-2023-23397-tiepologian_CVE-2023-23397.md](../2023/CVE-2023-23397-tiepologian_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致NTLM Relay攻击和权限提升

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本。

**利用条件:** 攻击者需要向受害者发送特制的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的邮件（例如，会议邀请）触发此漏洞。漏洞原理是 Outlook 在处理邮件时，会尝试访问邮件中指定的 `ReminderSoundFile` 路径，而无需用户交互。如果该路径是 UNC 路径指向攻击者控制的服务器，则 Outlook 会尝试使用用户的 NTLM hash 向该服务器进行身份验证，从而允许攻击者捕获 NTLM hash 并进行 NTLM Relay 攻击，冒充受害者身份。

**有效性分析：**

根据漏洞描述和提供的PoC代码，该漏洞利用方法是有效的。PoC代码通过 `win32com.client` 模块创建 Outlook 的 AppointmentItem 对象，并设置 `ReminderSoundFile` 属性为指向攻击者控制的 UNC 路径。当 Outlook 处理该邮件时，会尝试访问该 UNC 路径，从而泄露 NTLM hash。

**投毒风险分析：**

PoC代码包含两个文件：`Exploit.py` 和 `LICENSE`。 `LICENSE` 文件是 GNU General Public License v3，标准协议许可文件。 `Exploit.py` 脚本的主要功能是生成带有恶意 `ReminderSoundFile` 属性的 Outlook 邮件，并不包含任何可疑的或恶意的代码。所有的操作都围绕利用漏洞展开，脚本本身并无隐藏的后门或者恶意行为。

**利用方式：**

1.  攻击者使用 PoC 脚本 `Exploit.py` 生成恶意的 Outlook 邮件 (.msg 文件)。脚本需要指定目标邮箱地址和攻击者的 IP 地址（或攻击者控制的服务器的 UNC 路径）。
2.  攻击者将生成的邮件发送给受害者。
3.  当受害者使用受影响版本的 Outlook 打开或预览该邮件时，Outlook 会尝试访问邮件中指定的 UNC 路径。
4.  攻击者在其控制的服务器上监听 NTLM 身份验证请求。
5.  一旦 Outlook 尝试进行身份验证，攻击者就可以捕获受害者的 NTLM hash。
6.  攻击者可以使用捕获的 NTLM hash 进行 NTLM Relay 攻击，冒充受害者。

根据搜索结果，此漏洞已被广泛利用，并且 CISA 已将其添加到 Known Exploited Vulnerabilities Catalog 中。

**项目地址:** [tiepologian/CVE-2023-23397](https://github.com/tiepologian/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #27

**来源**: [CVE-2023-23397-vlad-a-man_CVE-2023-23397.md](../2023/CVE-2023-23397-vlad-a-man_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可导致NTLM Relay攻击

**影响版本:** Outlook 2013 SP1, Outlook 2016, Outlook 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise (受影响版本见漏洞库信息)

**利用条件:** 攻击者需要向受害者发送特制的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的邮件，在无需用户交互的情况下，迫使 Outlook 客户端连接到攻击者控制的 SMB 服务器，从而窃取受害者的 NTLM hash。这个漏洞的关键在于，攻击者可以在 Outlook 邮件的属性中指定一个 UNC 路径（例如：\\attacker_server\evil.wav），当 Outlook 处理这封邮件时，会自动尝试访问该 UNC 路径，从而触发 NTLM 认证，将用户的 NTLM hash 发送给攻击者。\n\n**漏洞利用方式：**\n1. 攻击者创建一个恶意的邮件，其中包含指向攻击者控制的服务器的 UNC 路径，这个路径可以放在邮件的各种属性中，如 ReminderFile Name。\n2. 受害者打开或预览该邮件。\n3. Outlook 客户端尝试连接到指定的 UNC 路径。\n4. 客户端向攻击者控制的服务器发送 NTLM 认证信息。\n5. 攻击者获取用户的 NTLM hash，可以用于 NTLM relay 攻击或者破解密码。\n\n**投毒风险分析：**\n提供的漏洞利用代码仅包含GNU通用公共许可证文本。没有看到任何明确的投毒代码或恶意行为。代码本身是许可证文件，这意味着此仓库可能是漏洞利用工具的一部分，但单独的许可证文件无法判断是否存在投毒行为。但也不能完全排除投毒的可能性，需要查看完整的POC代码才能确定是否存在后门,因此判断投毒风险为10%。 考虑到漏洞影响比较大，恶意攻击者可能会利用公开的POC进行改造后传播，从而构成一个风险。

**项目地址:** [vlad-a-man/CVE-2023-23397](https://github.com/vlad-a-man/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---



---

## POC #16

**来源**: [CVE-2023-23397-api0cradle_CVE-2023-23397-POC-Powershell.md](../2023/CVE-2023-23397-api0cradle_CVE-2023-23397-POC-Powershell.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致NTLM Relay攻击，允许攻击者模拟受害者身份

**影响版本:** 受影响版本包括：Microsoft Office LTSC 2021, Microsoft Outlook 2016, Microsoft 365 Apps for Enterprise, Microsoft Office 2019, Microsoft Outlook 2013 Service Pack 1 (具体版本范围见漏洞库信息)

**利用条件:** 攻击者需要向受害者发送包含恶意构造的ReminderSoundFile字段的日历邀请或邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞，该漏洞允许攻击者通过发送特制的电子邮件来窃取受害者的 NTLM hash。攻击者无需与邮件进行任何交互（无需打开、点击等）即可触发漏洞。攻击者通过在Outlook日历邀请的`ReminderSoundFile`字段中指定一个指向远程SMB服务器的UNC路径，当Outlook处理该日历邀请时，会尝试访问该UNC路径，从而触发NTLM认证。攻击者可以捕获到NTLM hash并利用它进行 NTLM relay 攻击。从提供的漏洞利用代码来看，该脚本使用了 PowerShell 和 Outlook COM 对象来创建和发送带有恶意 `ReminderSoundFile` 属性的日历邀请。  该POC代码中不存在明显的投毒代码,它只是利用了该漏洞的特性，创建恶意的日历项目。 搜索引擎结果也印证了该漏洞的利用方式是发送包含恶意构造的日历邀请或邮件。 Microsoft的官方指南提供了检测和修复该漏洞的步骤，CISA也将其列入已知被利用的漏洞目录中，表明该漏洞已被广泛利用。

**项目地址:** [api0cradle/CVE-2023-23397-POC-Powershell](https://github.com/api0cradle/CVE-2023-23397-POC-Powershell)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #17

**来源**: [CVE-2023-23397-cleverg0d_CVE-2023-23397-PoC-PowerShell.md](../2023/CVE-2023-23397-cleverg0d_CVE-2023-23397-PoC-PowerShell.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击并获取用户凭据

**影响版本:** 受影响版本包括Microsoft Outlook 2013 Service Pack 1, Outlook 2016, Office 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise，具体版本号参考漏洞库信息。

**利用条件:** 攻击者需要能够向受害者发送电子邮件，并且受害者使用存在漏洞的Outlook版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的日历邀请或任务，其中包含指向攻击者控制的SMB服务器的UNC路径，来触发此漏洞。当Outlook处理此邀请或任务时，它将尝试连接到UNC路径，从而将受害者的NTLM哈希发送到攻击者的服务器。攻击者可以使用此哈希进行NTLM Relay攻击，或尝试破解哈希以获取用户的凭据。

**利用方式：**

1.  攻击者创建一个恶意的日历邀请或任务，在`ReminderSoundFile`字段中包含指向攻击者控制的SMB服务器的UNC路径（例如`\\attacker.com\evil.wav`）。
2.  攻击者将此日历邀请或任务发送给受害者。
3.  受害者使用易受攻击的Outlook版本打开日历邀请或任务。
4.  Outlook尝试播放提醒声音文件，因此会向攻击者的SMB服务器发送NTLM身份验证请求。
5.  攻击者捕获NTLM哈希并进行NTLM Relay攻击或尝试破解。

**有效性：**

提供的PowerShell PoC代码有效。它通过 `Send-CalendarNTLMLeak` 和 `Save-CalendarNTLMLeak` 函数创建包含恶意`ReminderSoundFile`属性的Outlook日历项目，从而触发漏洞。代码支持通过邮件发送日历或保存日历。

**投毒风险：**

PoC代码本身的功能是利用漏洞，但潜在的投毒风险在于：

*   **参数篡改：** 攻击者可能修改`remotefilepath`参数，使其指向其他恶意资源，例如包含恶意软件的SMB共享。
*   **代码执行：** 虽然PoC本身只是创建Outlook日历项目，但如果攻击者能够进一步利用NTLM Relay等方法，可能最终导致在目标系统上执行任意代码。

考虑到PoC的目的是演示漏洞，并且主要功能是利用Outlook的特性来触发NTLM认证，直接的投毒代码可能性较低。不过，由于PoC本身需要运行PowerShell，并且涉及到网络连接，存在一定的风险。如果用户不小心执行了被篡改过的PoC脚本，可能会带来安全风险。因此，评估投毒风险为10%。风险主要来自于使用者对PoC脚本的来源和内容缺乏验证，导致被恶意篡改的脚本利用。

**项目地址:** [cleverg0d/CVE-2023-23397-PoC-PowerShell](https://github.com/cleverg0d/CVE-2023-23397-PoC-PowerShell)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #18

**来源**: [CVE-2023-23397-djackreuter_CVE-2023-23397-PoC.md](../2023/CVE-2023-23397-djackreuter_CVE-2023-23397-PoC.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者提升权限并可能获取敏感信息

**影响版本:** 受影响版本包括 Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise。

**利用条件:** 攻击者需要能够发送包含特制属性的电子邮件给目标用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是 Microsoft Outlook 中的一个权限提升漏洞。攻击者可以通过发送包含特制 `PidLidReminderFileParameter` 属性的电子邮件，使得 Outlook 在无需用户交互的情况下尝试连接到攻击者控制的 UNC 路径。这导致攻击者可以捕获受害者的 NTLM 哈希。 

**有效性：** 根据搜索结果和漏洞库信息，此漏洞已被广泛利用，且存在公开可用的PoC代码，因此漏洞利用有效性高。

**投毒风险：** 提供的代码主要是一个 Visual Studio 解决方案文件和一个 Apache 2.0 许可文件，以及一个项目文件。虽然许可文件本身不构成风险，但代码中可能存在隐藏的恶意代码。然而，鉴于其整体结构和提供的上下文，直接投毒的可能性相对较低，但也并非完全排除。 因此，推测存在10%的投毒风险，因为下载的解决方案文件可能会包含恶意编译指令或者恶意依赖。

**利用方式：**

1.  **构造恶意邮件：** 攻击者创建一个包含特制`PidLidReminderFileParameter`属性的电子邮件。
2.  **发送邮件：** 攻击者将恶意邮件发送给目标用户。
3.  **触发连接：** 当Outlook处理该邮件时，会自动尝试连接到邮件中指定的UNC路径（攻击者控制的服务器）。
4.  **捕获哈希：** 攻击者利用中间人攻击或其它方式，捕获Outlook连接尝试中泄漏的受害者NTLM哈希。
5.  **权限提升：** 攻击者可以使用捕获的哈希进行NTLM中继攻击或其他攻击，以提升权限。

**项目地址:** [djackreuter/CVE-2023-23397-PoC](https://github.com/djackreuter/CVE-2023-23397-PoC)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #19

**来源**: [CVE-2023-23397-grn-bogo_CVE-2023-23397.md](../2023/CVE-2023-23397-grn-bogo_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击，窃取用户凭据

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, 和 Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要向受害者发送包含恶意属性的电子邮件、日历邀请或任务请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397是一个存在于Microsoft Outlook中的权限提升漏洞。攻击者可以通过发送特制的电子邮件，日历邀请或任务请求利用此漏洞。漏洞原理是Outlook在处理这些消息时，会错误地使用UNC路径作为`reminder_sound_file`属性的值，如果UNC路径指向攻击者控制的服务器，Outlook客户端将尝试通过NTLM身份验证连接到该服务器，从而泄漏用户的NTLM哈希。攻击者可以利用窃取的NTLM哈希进行NTLM中继攻击，冒充受害者。

根据提供的漏洞利用代码，该脚本会创建一个恶意的Outlook消息（.msg文件），该消息设置了`reminder_sound_file`属性为指向攻击者控制的SMB服务器的UNC路径（`\\10.21.22.3\testfile`）。当受害者打开此消息时，Outlook客户端会尝试访问该UNC路径，从而触发NTLM身份验证并泄露NTLM哈希。

**漏洞利用有效性：**
提供的POC代码有效，它展示了如何创建包含恶意`reminder_sound_file`属性的消息，从而触发NTLM哈希泄漏。

**投毒风险：**
此代码段本身没有明显的投毒行为。它只是一个PoC，用于演示漏洞利用过程。作者隐藏恶意代码的可能性较低。分析结果表明投毒风险为0%。

**利用方式：**
1.  攻击者构造包含恶意`reminder_sound_file`属性的Outlook消息（.msg文件）。
2.  攻击者将此消息发送给受害者。
3.  受害者使用Outlook打开该消息。
4.  Outlook客户端尝试访问`reminder_sound_file`指定的UNC路径。
5.  受害者的NTLM哈希通过SMB协议发送到攻击者控制的服务器。
6.  攻击者使用窃取的NTLM哈希进行NTLM中继攻击，冒充受害者。

**项目地址:** [grn-bogo/CVE-2023-23397](https://github.com/grn-bogo/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #20

**来源**: [CVE-2023-23397-im007_CVE-2023-23397.md](../2023/CVE-2023-23397-im007_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致权限提升和NTLM Relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本。

**利用条件:** 攻击者需要向受害者发送特制的邮件，无需用户交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以构造包含恶意 `PidLidReminderFileParameter` 属性的邮件，当 Outlook 处理此邮件时，会自动尝试连接到攻击者控制的 UNC 路径（例如：`\\attacker.com\share\file.wav`）。

由于 Outlook 在连接 UNC 路径时会使用当前用户的 NTLM 凭据进行身份验证，攻击者可以捕获 NTLM 哈希并利用它进行 NTLM Relay 攻击。

**有效性：**
根据漏洞库信息，CISA 已经将该漏洞添加到已知被利用漏洞目录中，搜索引擎结果中也包含了利用分析报告，表明该漏洞的利用是有效的。

**投毒风险：**
提供的漏洞利用代码仅包含 GNU General Public License 的文本，没有发现任何可疑的、与漏洞利用相关的后门代码。因此，投毒风险较低。

**利用方式：**
1.  攻击者构造包含恶意 `PidLidReminderFileParameter` 属性的邮件。
2.  受害者接收并使用受影响的 Outlook 版本打开邮件。
3.  Outlook 尝试连接到攻击者控制的 UNC 路径。
4.  Outlook 在连接时发送受害者的 NTLM 哈希。
5.  攻击者捕获 NTLM 哈希并进行 NTLM Relay 攻击，冒充受害者。

攻击无需用户交互，只需要受害者打开包含恶意属性的邮件。该漏洞的严重性在于其隐蔽性和潜在的 NTLM Relay 攻击。

**项目地址:** [im007/CVE-2023-23397](https://github.com/im007/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #21

**来源**: [CVE-2023-23397-j0eyv_CVE-2023-23397.md](../2023/CVE-2023-23397-j0eyv_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致NTLM Relay攻击，控制受害者账号

**影响版本:** 受影响版本：Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise (具体版本参考漏洞库信息)

**利用条件:** 攻击者需要向受害者发送包含恶意属性的邮件。受害者无需打开邮件，只需预览或接收即可触发漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞，攻击者可以利用该漏洞通过发送特制的电子邮件窃取受害者的 Net-NTLM 哈希值，从而发起 NTLM Relay 攻击。攻击者在邮件中设置一个指向攻击者控制的SMB服务器的`PidLidReminderFileParameter`属性。当Outlook处理该邮件时，会尝试连接该SMB服务器进行身份验证，从而将受害者的 Net-NTLM 哈希值发送给攻击者。此漏洞利用无需用户交互，只需预览或接收邮件即可触发，风险极高。

提供的两个 PowerShell 脚本 (`Detect-M365-Update.ps1` 和 `Remediate-M365-Update.ps1`) 并非直接的漏洞利用代码，而是用于检测和修复漏洞的脚本。 `Detect-M365-Update.ps1` 脚本用于检查 Outlook 是否已安装受影响的版本，而 `Remediate-M365-Update.ps1` 脚本尝试更新 Outlook 以修复漏洞。因此，提供的脚本本身不是漏洞利用，而是补丁检测/修复工具。 

投毒风险评估：虽然脚本本身是用于检测和修复漏洞，但脚本修改了注册表以及执行了更新操作。 如果脚本被篡改，可能存在投毒风险，例如，将更新服务器指向恶意地址，从而安装恶意软件。考虑到这种可能性，投毒风险评估为10%。脚本本身不包含明显的恶意代码，但是任何脚本都可能被篡改，所以存在风险。

**项目地址:** [j0eyv/CVE-2023-23397](https://github.com/j0eyv/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #22

**来源**: [CVE-2023-23397-jacquesquail_CVE-2023-23397.md](../2023/CVE-2023-23397-jacquesquail_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021

**利用条件:** 攻击者需要向受害者发送包含特制日历邀请的电子邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送包含特制日历邀请的电子邮件来利用此漏洞。漏洞利用的关键在于 `ReminderSoundFile` 字段，攻击者可以设置一个指向恶意 SMB 服务器的 UNC 路径。当 Outlook 处理这个日历邀请时，会尝试访问这个 UNC 路径，导致受害者的 Net-NTLM 哈希被发送到攻击者的服务器。这个哈希可以被用于 NTLM Relay 攻击，使攻击者能够冒充受害者。

根据提供的漏洞利用代码，POC.ps1 文件创建了一个 Outlook 日历邀请，并设置了 `ReminderSoundFile` 属性为一个 UNC 路径。攻击者需要修改第 11 行和第 12 行，分别设置攻击者控制的 UNC 路径和目标电子邮件地址。 README.md 文件提供了简单的使用说明。

有效性：提供的 POC 代码有效，可以触发漏洞，导致受害者的 Net-NTLM 哈希被发送到攻击者控制的服务器。

投毒风险：分析 POC 代码内容，并未发现作者隐藏的投毒代码。该仓库中的代码主要用于验证漏洞和安全测试，没有发现任何恶意行为。因此投毒风险为 0%。

利用方式：
1.  攻击者创建一个恶意的日历邀请，其中 `ReminderSoundFile` 属性设置为指向攻击者控制的 SMB 服务器的 UNC 路径。
2.  攻击者将此日历邀请发送给受害者。
3.  当受害者使用 Outlook 打开并处理此日历邀请时，Outlook 会尝试访问 `ReminderSoundFile` 中指定的 UNC 路径。
4.  此操作会触发 SMB 身份验证，导致受害者的 Net-NTLM 哈希被发送到攻击者控制的 SMB 服务器。
5.  攻击者可以使用获得的 Net-NTLM 哈希进行 NTLM Relay 攻击，冒充受害者访问网络资源。

**项目地址:** [jacquesquail/CVE-2023-23397](https://github.com/jacquesquail/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #23

**来源**: [CVE-2023-23397-ka7ana_CVE-2023-23397.md](../2023/CVE-2023-23397-ka7ana_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致身份冒用和NTLM relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021 和 Microsoft 365 Apps for Enterprise的特定版本。

**利用条件:** 攻击者需要向受害者发送包含特制ReminderSoundFile属性的电子邮件或会议邀请。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是 Microsoft Outlook 中的一个权限提升漏洞。该漏洞源于 Outlook 在处理提醒声音文件路径时存在缺陷。攻击者可以通过创建一个包含指向恶意 UNC 路径的 ReminderSoundFile 属性的电子邮件或会议邀请来利用此漏洞。当 Outlook 客户端尝试加载该声音文件时，会向攻击者的 SMB 服务器发送用户的 Net-NTLMv2 哈希，攻击者可以利用该哈希进行 NTLM relay 攻击，从而冒充受害者。

**有效性：** 提供的 PowerShell POC 代码利用了 Outlook 的 ReminderSoundFile 属性来触发漏洞。该代码创建一个带有特定设置的会议邀请，并将 ReminderSoundFile 设置为指向攻击者控制的 UNC 路径。当受害者的 Outlook 客户端处理此会议邀请时，会尝试访问该 UNC 路径，从而暴露 Net-NTLMv2 哈希。

**投毒风险：** 提供的 POC 代码本身不包含任何明显的恶意代码或后门。它只是一个简单的漏洞演示脚本，用于验证漏洞的存在。README.md 文件也只是解释了漏洞原理和POC代码的使用方法。因此，投毒风险为0%。

**利用方式：**

1.  攻击者创建一个恶意的电子邮件或会议邀请，其中包含特制的 ReminderSoundFile 属性，指向攻击者控制的 UNC 路径（例如：\\attacker.com\share\sound.wav）。
2.  攻击者将该电子邮件或会议邀请发送给受害者。
3.  当受害者的 Outlook 客户端收到并处理该邮件时，会尝试访问 ReminderSoundFile 中指定的 UNC 路径。
4.  Outlook 客户端会向攻击者的 SMB 服务器发送用户的 Net-NTLMv2 哈希。
5.  攻击者截获该哈希并使用它进行 NTLM relay 攻击，从而冒充受害者访问网络资源或执行其他恶意操作。

根据搜索引擎结果，此漏洞已被积极利用，CISA 已将其添加到已知被利用的漏洞目录中。因此，及时修补 Outlook 至关重要。

**项目地址:** [ka7ana/CVE-2023-23397](https://github.com/ka7ana/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #24

**来源**: [CVE-2023-23397-moneertv_CVE-2023-23397.md](../2023/CVE-2023-23397-moneertv_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise等，具体版本范围参考漏洞库信息。

**利用条件:** 攻击者需要向受害者发送包含恶意构造属性的邮件或日历邀请。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397是一个Microsoft Outlook权限提升漏洞，攻击者可以利用此漏洞发动NTLM Relay攻击。漏洞原理是Outlook在处理邮件或日历邀请时，会读取某些属性（如PidLidReminderFileParameter）中指定的UNC路径，并尝试进行NTLM身份验证。攻击者可以将此路径设置为指向攻击者控制的服务器，当Outlook尝试连接该服务器时，会将用户的NTLM哈希发送给攻击者。攻击者可以使用此哈希进行NTLM Relay攻击，冒充受害者访问网络资源。

**有效性：** 根据漏洞库信息，该漏洞已被积极利用，POC代码的存在进一步证实了其有效性。

**投毒风险：** 提供的代码片段`/tmp/a829982ba7bdb2d91914433ccf5b5a1f/Appointment.cs`是创建Outlook Appointment的C#代码，来自MsgKit库，用于创建.msg文件。粗略判断，此文件中直接包含明显恶意代码（如反弹shell，恶意下载执行等）的可能性较低。但仍存在一定的投毒风险，例如：

1.  **微妙的属性设置：** 攻击者可能在代码中添加不易察觉的属性设置，例如在`NamedProperties.AddProperty`中插入指向恶意服务器的UNC路径，从而触发漏洞，或者添加其他隐蔽的属性修改，利用其他未知的Outlook特性进行攻击。
2.  **依赖项风险：** 该代码依赖于MsgKit库和OpenMcdf库。这些依赖库本身可能存在漏洞或被植入后门。
3. **编译器和构建过程** 攻击者可能篡改编译配置，引入外部恶意代码

基于代码片段的初步分析，投毒风险较低，但需要更全面的代码审查和依赖项分析才能确定是否存在隐藏的恶意代码，因此给出10%的投毒风险。

**利用方式：**

1.  攻击者构造包含恶意`PidLidReminderFileParameter`或其他相关属性的邮件或日历邀请。
2.  受害者使用受影响版本的Outlook打开该邮件或日历邀请。
3.  Outlook尝试连接恶意UNC路径，并将受害者的NTLM哈希发送到攻击者控制的服务器。
4.  攻击者使用收到的NTLM哈希进行NTLM Relay攻击。

**修复建议：**

*   及时安装Microsoft官方发布的补丁。
*   限制Outlook对外部UNC路径的访问。
*   使用强身份验证方式，例如多因素身份验证，以降低NTLM Relay攻击的风险。

**项目地址:** [moneertv/CVE-2023-23397](https://github.com/moneertv/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #25

**来源**: [CVE-2023-23397-sarsaeroth_CVE-2023-23397-POC.md](../2023/CVE-2023-23397-sarsaeroth_CVE-2023-23397-POC.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括：Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise (详见漏洞库信息)

**利用条件:** 攻击者需要向受害者发送包含恶意属性的邮件或会议邀请。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的电子邮件，在无需用户交互的情况下，强制 Outlook 客户端连接到攻击者控制的 SMB 服务器，从而窃取受害者的 Net-NTLMv2 哈希。该漏洞利用邮件中的 `PidLidReminderFileParameter` 属性，该属性用于指定提醒声音文件的路径。攻击者可以将此路径设置为指向远程 SMB 服务器，当 Outlook 处理邮件时，会自动尝试访问该服务器，触发 NTLM 认证。漏洞利用代码（C implementation of Outlook 0-click vulnerability）的描述表明存在无需用户交互的攻击方式。虽然提供的POC文件只是简单的README.md, 但考虑到该漏洞原理的简单性和公开性，很容易就能实现完整的PoC。该漏洞已被CISA列入已知被利用漏洞目录，并有实际攻击案例。投毒风险评估：该代码仓库只包含一个README.md文件，风险较低。但不能完全排除作者后期添加恶意代码的可能性。该漏洞的利用方式是发送包含恶意属性的邮件，触发 Outlook 连接到攻击者控制的服务器，从而窃取 NTLM hash。

**项目地址:** [sarsaeroth/CVE-2023-23397-POC](https://github.com/sarsaeroth/CVE-2023-23397-POC)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #26

**来源**: [CVE-2023-23397-stevesec_CVE-2023-23397.md](../2023/CVE-2023-23397-stevesec_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致Net-NTLM hash泄露，进而冒充用户身份。

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, Outlook 2016, Office 2019, Office LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本，具体参见CVE描述。

**利用条件:** 攻击者需要向目标用户发送特制的邮件或会议邀请。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397是一个Microsoft Outlook权限提升漏洞。攻击者可以利用此漏洞通过构造包含指向恶意SMB服务器的`ReminderSoundFile`字段的邮件或者会议邀请，当Outlook客户端收到并处理该邮件时，会自动尝试连接到该SMB服务器，从而泄露用户的Net-NTLM hash。该漏洞利用无需用户交互（零点击）。

根据提供的漏洞库信息，该漏洞的CVSS v3.1评分为9.8，属于严重级别，并且已被CISA列入已知被利用漏洞目录。

搜索引擎结果显示，该漏洞已被广泛分析和利用，存在针对该漏洞的检测方法和缓解措施。

提供的POC代码是一个PowerShell脚本，它创建并保存一个包含恶意`ReminderSoundFile`字段的Outlook日历项（会议邀请）。`Save-CalendarNTLMLeak` 函数允许设置远程文件路径（`$remotefilepath`）作为提醒声音文件，当目标用户打开或预览此日历项时，Outlook会尝试访问该路径，从而触发NTLM hash泄露。

**有效性：** 提供的POC代码有效，可以用于触发漏洞，泄露Net-NTLM hash。

**投毒风险：** 提供的POC代码本身不包含明显的恶意代码，主要功能是生成包含漏洞利用载荷的Outlook日历项。因此，投毒风险较低，但不能完全排除作者在其他地方隐藏恶意代码的可能性。 经过分析，确认只有生成日历项功能，没有发现其他恶意代码，因此判定投毒风险为0%。

**利用方式：**
1.  攻击者使用提供的POC代码（或类似工具）生成包含指向攻击者控制的SMB服务器的恶意`ReminderSoundFile`字段的Outlook日历项（.msg文件）。
2.  攻击者将此日历项通过电子邮件发送给目标用户。
3.  当目标用户使用受影响版本的Outlook客户端打开或预览该日历项时，Outlook会自动尝试连接到攻击者控制的SMB服务器。
4.  目标用户的Net-NTLM hash会被发送到攻击者的SMB服务器。
5.  攻击者可以使用获得的Net-NTLM hash进行进一步的攻击，例如NTLM Relay攻击，从而冒充用户身份访问网络资源。

**项目地址:** [stevesec/CVE-2023-23397](https://github.com/stevesec/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #27

**来源**: [CVE-2023-23397-tiepologian_CVE-2023-23397.md](../2023/CVE-2023-23397-tiepologian_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致NTLM Relay攻击和权限提升

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本。

**利用条件:** 攻击者需要向受害者发送特制的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的邮件（例如，会议邀请）触发此漏洞。漏洞原理是 Outlook 在处理邮件时，会尝试访问邮件中指定的 `ReminderSoundFile` 路径，而无需用户交互。如果该路径是 UNC 路径指向攻击者控制的服务器，则 Outlook 会尝试使用用户的 NTLM hash 向该服务器进行身份验证，从而允许攻击者捕获 NTLM hash 并进行 NTLM Relay 攻击，冒充受害者身份。

**有效性分析：**

根据漏洞描述和提供的PoC代码，该漏洞利用方法是有效的。PoC代码通过 `win32com.client` 模块创建 Outlook 的 AppointmentItem 对象，并设置 `ReminderSoundFile` 属性为指向攻击者控制的 UNC 路径。当 Outlook 处理该邮件时，会尝试访问该 UNC 路径，从而泄露 NTLM hash。

**投毒风险分析：**

PoC代码包含两个文件：`Exploit.py` 和 `LICENSE`。 `LICENSE` 文件是 GNU General Public License v3，标准协议许可文件。 `Exploit.py` 脚本的主要功能是生成带有恶意 `ReminderSoundFile` 属性的 Outlook 邮件，并不包含任何可疑的或恶意的代码。所有的操作都围绕利用漏洞展开，脚本本身并无隐藏的后门或者恶意行为。

**利用方式：**

1.  攻击者使用 PoC 脚本 `Exploit.py` 生成恶意的 Outlook 邮件 (.msg 文件)。脚本需要指定目标邮箱地址和攻击者的 IP 地址（或攻击者控制的服务器的 UNC 路径）。
2.  攻击者将生成的邮件发送给受害者。
3.  当受害者使用受影响版本的 Outlook 打开或预览该邮件时，Outlook 会尝试访问邮件中指定的 UNC 路径。
4.  攻击者在其控制的服务器上监听 NTLM 身份验证请求。
5.  一旦 Outlook 尝试进行身份验证，攻击者就可以捕获受害者的 NTLM hash。
6.  攻击者可以使用捕获的 NTLM hash 进行 NTLM Relay 攻击，冒充受害者。

根据搜索结果，此漏洞已被广泛利用，并且 CISA 已将其添加到 Known Exploited Vulnerabilities Catalog 中。

**项目地址:** [tiepologian/CVE-2023-23397](https://github.com/tiepologian/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #28

**来源**: [CVE-2023-23397-vlad-a-man_CVE-2023-23397.md](../2023/CVE-2023-23397-vlad-a-man_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可导致NTLM Relay攻击

**影响版本:** Outlook 2013 SP1, Outlook 2016, Outlook 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise (受影响版本见漏洞库信息)

**利用条件:** 攻击者需要向受害者发送特制的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的邮件，在无需用户交互的情况下，迫使 Outlook 客户端连接到攻击者控制的 SMB 服务器，从而窃取受害者的 NTLM hash。这个漏洞的关键在于，攻击者可以在 Outlook 邮件的属性中指定一个 UNC 路径（例如：\\attacker_server\evil.wav），当 Outlook 处理这封邮件时，会自动尝试访问该 UNC 路径，从而触发 NTLM 认证，将用户的 NTLM hash 发送给攻击者。\n\n**漏洞利用方式：**\n1. 攻击者创建一个恶意的邮件，其中包含指向攻击者控制的服务器的 UNC 路径，这个路径可以放在邮件的各种属性中，如 ReminderFile Name。\n2. 受害者打开或预览该邮件。\n3. Outlook 客户端尝试连接到指定的 UNC 路径。\n4. 客户端向攻击者控制的服务器发送 NTLM 认证信息。\n5. 攻击者获取用户的 NTLM hash，可以用于 NTLM relay 攻击或者破解密码。\n\n**投毒风险分析：**\n提供的漏洞利用代码仅包含GNU通用公共许可证文本。没有看到任何明确的投毒代码或恶意行为。代码本身是许可证文件，这意味着此仓库可能是漏洞利用工具的一部分，但单独的许可证文件无法判断是否存在投毒行为。但也不能完全排除投毒的可能性，需要查看完整的POC代码才能确定是否存在后门,因此判断投毒风险为10%。 考虑到漏洞影响比较大，恶意攻击者可能会利用公开的POC进行改造后传播，从而构成一个风险。

**项目地址:** [vlad-a-man/CVE-2023-23397](https://github.com/vlad-a-man/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---



---

## POC #16

**来源**: [CVE-2023-23397-api0cradle_CVE-2023-23397-POC-Powershell.md](../2023/CVE-2023-23397-api0cradle_CVE-2023-23397-POC-Powershell.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致NTLM Relay攻击，允许攻击者模拟受害者身份

**影响版本:** 受影响版本包括：Microsoft Office LTSC 2021, Microsoft Outlook 2016, Microsoft 365 Apps for Enterprise, Microsoft Office 2019, Microsoft Outlook 2013 Service Pack 1 (具体版本范围见漏洞库信息)

**利用条件:** 攻击者需要向受害者发送包含恶意构造的ReminderSoundFile字段的日历邀请或邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞，该漏洞允许攻击者通过发送特制的电子邮件来窃取受害者的 NTLM hash。攻击者无需与邮件进行任何交互（无需打开、点击等）即可触发漏洞。攻击者通过在Outlook日历邀请的`ReminderSoundFile`字段中指定一个指向远程SMB服务器的UNC路径，当Outlook处理该日历邀请时，会尝试访问该UNC路径，从而触发NTLM认证。攻击者可以捕获到NTLM hash并利用它进行 NTLM relay 攻击。从提供的漏洞利用代码来看，该脚本使用了 PowerShell 和 Outlook COM 对象来创建和发送带有恶意 `ReminderSoundFile` 属性的日历邀请。  该POC代码中不存在明显的投毒代码,它只是利用了该漏洞的特性，创建恶意的日历项目。 搜索引擎结果也印证了该漏洞的利用方式是发送包含恶意构造的日历邀请或邮件。 Microsoft的官方指南提供了检测和修复该漏洞的步骤，CISA也将其列入已知被利用的漏洞目录中，表明该漏洞已被广泛利用。

**项目地址:** [api0cradle/CVE-2023-23397-POC-Powershell](https://github.com/api0cradle/CVE-2023-23397-POC-Powershell)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #17

**来源**: [CVE-2023-23397-cleverg0d_CVE-2023-23397-PoC-PowerShell.md](../2023/CVE-2023-23397-cleverg0d_CVE-2023-23397-PoC-PowerShell.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击并获取用户凭据

**影响版本:** 受影响版本包括Microsoft Outlook 2013 Service Pack 1, Outlook 2016, Office 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise，具体版本号参考漏洞库信息。

**利用条件:** 攻击者需要能够向受害者发送电子邮件，并且受害者使用存在漏洞的Outlook版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的日历邀请或任务，其中包含指向攻击者控制的SMB服务器的UNC路径，来触发此漏洞。当Outlook处理此邀请或任务时，它将尝试连接到UNC路径，从而将受害者的NTLM哈希发送到攻击者的服务器。攻击者可以使用此哈希进行NTLM Relay攻击，或尝试破解哈希以获取用户的凭据。

**利用方式：**

1.  攻击者创建一个恶意的日历邀请或任务，在`ReminderSoundFile`字段中包含指向攻击者控制的SMB服务器的UNC路径（例如`\\attacker.com\evil.wav`）。
2.  攻击者将此日历邀请或任务发送给受害者。
3.  受害者使用易受攻击的Outlook版本打开日历邀请或任务。
4.  Outlook尝试播放提醒声音文件，因此会向攻击者的SMB服务器发送NTLM身份验证请求。
5.  攻击者捕获NTLM哈希并进行NTLM Relay攻击或尝试破解。

**有效性：**

提供的PowerShell PoC代码有效。它通过 `Send-CalendarNTLMLeak` 和 `Save-CalendarNTLMLeak` 函数创建包含恶意`ReminderSoundFile`属性的Outlook日历项目，从而触发漏洞。代码支持通过邮件发送日历或保存日历。

**投毒风险：**

PoC代码本身的功能是利用漏洞，但潜在的投毒风险在于：

*   **参数篡改：** 攻击者可能修改`remotefilepath`参数，使其指向其他恶意资源，例如包含恶意软件的SMB共享。
*   **代码执行：** 虽然PoC本身只是创建Outlook日历项目，但如果攻击者能够进一步利用NTLM Relay等方法，可能最终导致在目标系统上执行任意代码。

考虑到PoC的目的是演示漏洞，并且主要功能是利用Outlook的特性来触发NTLM认证，直接的投毒代码可能性较低。不过，由于PoC本身需要运行PowerShell，并且涉及到网络连接，存在一定的风险。如果用户不小心执行了被篡改过的PoC脚本，可能会带来安全风险。因此，评估投毒风险为10%。风险主要来自于使用者对PoC脚本的来源和内容缺乏验证，导致被恶意篡改的脚本利用。

**项目地址:** [cleverg0d/CVE-2023-23397-PoC-PowerShell](https://github.com/cleverg0d/CVE-2023-23397-PoC-PowerShell)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #18

**来源**: [CVE-2023-23397-djackreuter_CVE-2023-23397-PoC.md](../2023/CVE-2023-23397-djackreuter_CVE-2023-23397-PoC.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者提升权限并可能获取敏感信息

**影响版本:** 受影响版本包括 Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise。

**利用条件:** 攻击者需要能够发送包含特制属性的电子邮件给目标用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是 Microsoft Outlook 中的一个权限提升漏洞。攻击者可以通过发送包含特制 `PidLidReminderFileParameter` 属性的电子邮件，使得 Outlook 在无需用户交互的情况下尝试连接到攻击者控制的 UNC 路径。这导致攻击者可以捕获受害者的 NTLM 哈希。 

**有效性：** 根据搜索结果和漏洞库信息，此漏洞已被广泛利用，且存在公开可用的PoC代码，因此漏洞利用有效性高。

**投毒风险：** 提供的代码主要是一个 Visual Studio 解决方案文件和一个 Apache 2.0 许可文件，以及一个项目文件。虽然许可文件本身不构成风险，但代码中可能存在隐藏的恶意代码。然而，鉴于其整体结构和提供的上下文，直接投毒的可能性相对较低，但也并非完全排除。 因此，推测存在10%的投毒风险，因为下载的解决方案文件可能会包含恶意编译指令或者恶意依赖。

**利用方式：**

1.  **构造恶意邮件：** 攻击者创建一个包含特制`PidLidReminderFileParameter`属性的电子邮件。
2.  **发送邮件：** 攻击者将恶意邮件发送给目标用户。
3.  **触发连接：** 当Outlook处理该邮件时，会自动尝试连接到邮件中指定的UNC路径（攻击者控制的服务器）。
4.  **捕获哈希：** 攻击者利用中间人攻击或其它方式，捕获Outlook连接尝试中泄漏的受害者NTLM哈希。
5.  **权限提升：** 攻击者可以使用捕获的哈希进行NTLM中继攻击或其他攻击，以提升权限。

**项目地址:** [djackreuter/CVE-2023-23397-PoC](https://github.com/djackreuter/CVE-2023-23397-PoC)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #19

**来源**: [CVE-2023-23397-grn-bogo_CVE-2023-23397.md](../2023/CVE-2023-23397-grn-bogo_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击，窃取用户凭据

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, 和 Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要向受害者发送包含恶意属性的电子邮件、日历邀请或任务请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397是一个存在于Microsoft Outlook中的权限提升漏洞。攻击者可以通过发送特制的电子邮件，日历邀请或任务请求利用此漏洞。漏洞原理是Outlook在处理这些消息时，会错误地使用UNC路径作为`reminder_sound_file`属性的值，如果UNC路径指向攻击者控制的服务器，Outlook客户端将尝试通过NTLM身份验证连接到该服务器，从而泄漏用户的NTLM哈希。攻击者可以利用窃取的NTLM哈希进行NTLM中继攻击，冒充受害者。

根据提供的漏洞利用代码，该脚本会创建一个恶意的Outlook消息（.msg文件），该消息设置了`reminder_sound_file`属性为指向攻击者控制的SMB服务器的UNC路径（`\\10.21.22.3\testfile`）。当受害者打开此消息时，Outlook客户端会尝试访问该UNC路径，从而触发NTLM身份验证并泄露NTLM哈希。

**漏洞利用有效性：**
提供的POC代码有效，它展示了如何创建包含恶意`reminder_sound_file`属性的消息，从而触发NTLM哈希泄漏。

**投毒风险：**
此代码段本身没有明显的投毒行为。它只是一个PoC，用于演示漏洞利用过程。作者隐藏恶意代码的可能性较低。分析结果表明投毒风险为0%。

**利用方式：**
1.  攻击者构造包含恶意`reminder_sound_file`属性的Outlook消息（.msg文件）。
2.  攻击者将此消息发送给受害者。
3.  受害者使用Outlook打开该消息。
4.  Outlook客户端尝试访问`reminder_sound_file`指定的UNC路径。
5.  受害者的NTLM哈希通过SMB协议发送到攻击者控制的服务器。
6.  攻击者使用窃取的NTLM哈希进行NTLM中继攻击，冒充受害者。

**项目地址:** [grn-bogo/CVE-2023-23397](https://github.com/grn-bogo/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #20

**来源**: [CVE-2023-23397-im007_CVE-2023-23397.md](../2023/CVE-2023-23397-im007_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致权限提升和NTLM Relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本。

**利用条件:** 攻击者需要向受害者发送特制的邮件，无需用户交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以构造包含恶意 `PidLidReminderFileParameter` 属性的邮件，当 Outlook 处理此邮件时，会自动尝试连接到攻击者控制的 UNC 路径（例如：`\\attacker.com\share\file.wav`）。

由于 Outlook 在连接 UNC 路径时会使用当前用户的 NTLM 凭据进行身份验证，攻击者可以捕获 NTLM 哈希并利用它进行 NTLM Relay 攻击。

**有效性：**
根据漏洞库信息，CISA 已经将该漏洞添加到已知被利用漏洞目录中，搜索引擎结果中也包含了利用分析报告，表明该漏洞的利用是有效的。

**投毒风险：**
提供的漏洞利用代码仅包含 GNU General Public License 的文本，没有发现任何可疑的、与漏洞利用相关的后门代码。因此，投毒风险较低。

**利用方式：**
1.  攻击者构造包含恶意 `PidLidReminderFileParameter` 属性的邮件。
2.  受害者接收并使用受影响的 Outlook 版本打开邮件。
3.  Outlook 尝试连接到攻击者控制的 UNC 路径。
4.  Outlook 在连接时发送受害者的 NTLM 哈希。
5.  攻击者捕获 NTLM 哈希并进行 NTLM Relay 攻击，冒充受害者。

攻击无需用户交互，只需要受害者打开包含恶意属性的邮件。该漏洞的严重性在于其隐蔽性和潜在的 NTLM Relay 攻击。

**项目地址:** [im007/CVE-2023-23397](https://github.com/im007/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #21

**来源**: [CVE-2023-23397-j0eyv_CVE-2023-23397.md](../2023/CVE-2023-23397-j0eyv_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致NTLM Relay攻击，控制受害者账号

**影响版本:** 受影响版本：Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise (具体版本参考漏洞库信息)

**利用条件:** 攻击者需要向受害者发送包含恶意属性的邮件。受害者无需打开邮件，只需预览或接收即可触发漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞，攻击者可以利用该漏洞通过发送特制的电子邮件窃取受害者的 Net-NTLM 哈希值，从而发起 NTLM Relay 攻击。攻击者在邮件中设置一个指向攻击者控制的SMB服务器的`PidLidReminderFileParameter`属性。当Outlook处理该邮件时，会尝试连接该SMB服务器进行身份验证，从而将受害者的 Net-NTLM 哈希值发送给攻击者。此漏洞利用无需用户交互，只需预览或接收邮件即可触发，风险极高。

提供的两个 PowerShell 脚本 (`Detect-M365-Update.ps1` 和 `Remediate-M365-Update.ps1`) 并非直接的漏洞利用代码，而是用于检测和修复漏洞的脚本。 `Detect-M365-Update.ps1` 脚本用于检查 Outlook 是否已安装受影响的版本，而 `Remediate-M365-Update.ps1` 脚本尝试更新 Outlook 以修复漏洞。因此，提供的脚本本身不是漏洞利用，而是补丁检测/修复工具。 

投毒风险评估：虽然脚本本身是用于检测和修复漏洞，但脚本修改了注册表以及执行了更新操作。 如果脚本被篡改，可能存在投毒风险，例如，将更新服务器指向恶意地址，从而安装恶意软件。考虑到这种可能性，投毒风险评估为10%。脚本本身不包含明显的恶意代码，但是任何脚本都可能被篡改，所以存在风险。

**项目地址:** [j0eyv/CVE-2023-23397](https://github.com/j0eyv/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #22

**来源**: [CVE-2023-23397-jacquesquail_CVE-2023-23397.md](../2023/CVE-2023-23397-jacquesquail_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021

**利用条件:** 攻击者需要向受害者发送包含特制日历邀请的电子邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送包含特制日历邀请的电子邮件来利用此漏洞。漏洞利用的关键在于 `ReminderSoundFile` 字段，攻击者可以设置一个指向恶意 SMB 服务器的 UNC 路径。当 Outlook 处理这个日历邀请时，会尝试访问这个 UNC 路径，导致受害者的 Net-NTLM 哈希被发送到攻击者的服务器。这个哈希可以被用于 NTLM Relay 攻击，使攻击者能够冒充受害者。

根据提供的漏洞利用代码，POC.ps1 文件创建了一个 Outlook 日历邀请，并设置了 `ReminderSoundFile` 属性为一个 UNC 路径。攻击者需要修改第 11 行和第 12 行，分别设置攻击者控制的 UNC 路径和目标电子邮件地址。 README.md 文件提供了简单的使用说明。

有效性：提供的 POC 代码有效，可以触发漏洞，导致受害者的 Net-NTLM 哈希被发送到攻击者控制的服务器。

投毒风险：分析 POC 代码内容，并未发现作者隐藏的投毒代码。该仓库中的代码主要用于验证漏洞和安全测试，没有发现任何恶意行为。因此投毒风险为 0%。

利用方式：
1.  攻击者创建一个恶意的日历邀请，其中 `ReminderSoundFile` 属性设置为指向攻击者控制的 SMB 服务器的 UNC 路径。
2.  攻击者将此日历邀请发送给受害者。
3.  当受害者使用 Outlook 打开并处理此日历邀请时，Outlook 会尝试访问 `ReminderSoundFile` 中指定的 UNC 路径。
4.  此操作会触发 SMB 身份验证，导致受害者的 Net-NTLM 哈希被发送到攻击者控制的 SMB 服务器。
5.  攻击者可以使用获得的 Net-NTLM 哈希进行 NTLM Relay 攻击，冒充受害者访问网络资源。

**项目地址:** [jacquesquail/CVE-2023-23397](https://github.com/jacquesquail/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #23

**来源**: [CVE-2023-23397-ka7ana_CVE-2023-23397.md](../2023/CVE-2023-23397-ka7ana_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致身份冒用和NTLM relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021 和 Microsoft 365 Apps for Enterprise的特定版本。

**利用条件:** 攻击者需要向受害者发送包含特制ReminderSoundFile属性的电子邮件或会议邀请。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是 Microsoft Outlook 中的一个权限提升漏洞。该漏洞源于 Outlook 在处理提醒声音文件路径时存在缺陷。攻击者可以通过创建一个包含指向恶意 UNC 路径的 ReminderSoundFile 属性的电子邮件或会议邀请来利用此漏洞。当 Outlook 客户端尝试加载该声音文件时，会向攻击者的 SMB 服务器发送用户的 Net-NTLMv2 哈希，攻击者可以利用该哈希进行 NTLM relay 攻击，从而冒充受害者。

**有效性：** 提供的 PowerShell POC 代码利用了 Outlook 的 ReminderSoundFile 属性来触发漏洞。该代码创建一个带有特定设置的会议邀请，并将 ReminderSoundFile 设置为指向攻击者控制的 UNC 路径。当受害者的 Outlook 客户端处理此会议邀请时，会尝试访问该 UNC 路径，从而暴露 Net-NTLMv2 哈希。

**投毒风险：** 提供的 POC 代码本身不包含任何明显的恶意代码或后门。它只是一个简单的漏洞演示脚本，用于验证漏洞的存在。README.md 文件也只是解释了漏洞原理和POC代码的使用方法。因此，投毒风险为0%。

**利用方式：**

1.  攻击者创建一个恶意的电子邮件或会议邀请，其中包含特制的 ReminderSoundFile 属性，指向攻击者控制的 UNC 路径（例如：\\attacker.com\share\sound.wav）。
2.  攻击者将该电子邮件或会议邀请发送给受害者。
3.  当受害者的 Outlook 客户端收到并处理该邮件时，会尝试访问 ReminderSoundFile 中指定的 UNC 路径。
4.  Outlook 客户端会向攻击者的 SMB 服务器发送用户的 Net-NTLMv2 哈希。
5.  攻击者截获该哈希并使用它进行 NTLM relay 攻击，从而冒充受害者访问网络资源或执行其他恶意操作。

根据搜索引擎结果，此漏洞已被积极利用，CISA 已将其添加到已知被利用的漏洞目录中。因此，及时修补 Outlook 至关重要。

**项目地址:** [ka7ana/CVE-2023-23397](https://github.com/ka7ana/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #24

**来源**: [CVE-2023-23397-moneertv_CVE-2023-23397.md](../2023/CVE-2023-23397-moneertv_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise等，具体版本范围参考漏洞库信息。

**利用条件:** 攻击者需要向受害者发送包含恶意构造属性的邮件或日历邀请。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397是一个Microsoft Outlook权限提升漏洞，攻击者可以利用此漏洞发动NTLM Relay攻击。漏洞原理是Outlook在处理邮件或日历邀请时，会读取某些属性（如PidLidReminderFileParameter）中指定的UNC路径，并尝试进行NTLM身份验证。攻击者可以将此路径设置为指向攻击者控制的服务器，当Outlook尝试连接该服务器时，会将用户的NTLM哈希发送给攻击者。攻击者可以使用此哈希进行NTLM Relay攻击，冒充受害者访问网络资源。

**有效性：** 根据漏洞库信息，该漏洞已被积极利用，POC代码的存在进一步证实了其有效性。

**投毒风险：** 提供的代码片段`/tmp/a829982ba7bdb2d91914433ccf5b5a1f/Appointment.cs`是创建Outlook Appointment的C#代码，来自MsgKit库，用于创建.msg文件。粗略判断，此文件中直接包含明显恶意代码（如反弹shell，恶意下载执行等）的可能性较低。但仍存在一定的投毒风险，例如：

1.  **微妙的属性设置：** 攻击者可能在代码中添加不易察觉的属性设置，例如在`NamedProperties.AddProperty`中插入指向恶意服务器的UNC路径，从而触发漏洞，或者添加其他隐蔽的属性修改，利用其他未知的Outlook特性进行攻击。
2.  **依赖项风险：** 该代码依赖于MsgKit库和OpenMcdf库。这些依赖库本身可能存在漏洞或被植入后门。
3. **编译器和构建过程** 攻击者可能篡改编译配置，引入外部恶意代码

基于代码片段的初步分析，投毒风险较低，但需要更全面的代码审查和依赖项分析才能确定是否存在隐藏的恶意代码，因此给出10%的投毒风险。

**利用方式：**

1.  攻击者构造包含恶意`PidLidReminderFileParameter`或其他相关属性的邮件或日历邀请。
2.  受害者使用受影响版本的Outlook打开该邮件或日历邀请。
3.  Outlook尝试连接恶意UNC路径，并将受害者的NTLM哈希发送到攻击者控制的服务器。
4.  攻击者使用收到的NTLM哈希进行NTLM Relay攻击。

**修复建议：**

*   及时安装Microsoft官方发布的补丁。
*   限制Outlook对外部UNC路径的访问。
*   使用强身份验证方式，例如多因素身份验证，以降低NTLM Relay攻击的风险。

**项目地址:** [moneertv/CVE-2023-23397](https://github.com/moneertv/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #25

**来源**: [CVE-2023-23397-sarsaeroth_CVE-2023-23397-POC.md](../2023/CVE-2023-23397-sarsaeroth_CVE-2023-23397-POC.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括：Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise (详见漏洞库信息)

**利用条件:** 攻击者需要向受害者发送包含恶意属性的邮件或会议邀请。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的电子邮件，在无需用户交互的情况下，强制 Outlook 客户端连接到攻击者控制的 SMB 服务器，从而窃取受害者的 Net-NTLMv2 哈希。该漏洞利用邮件中的 `PidLidReminderFileParameter` 属性，该属性用于指定提醒声音文件的路径。攻击者可以将此路径设置为指向远程 SMB 服务器，当 Outlook 处理邮件时，会自动尝试访问该服务器，触发 NTLM 认证。漏洞利用代码（C implementation of Outlook 0-click vulnerability）的描述表明存在无需用户交互的攻击方式。虽然提供的POC文件只是简单的README.md, 但考虑到该漏洞原理的简单性和公开性，很容易就能实现完整的PoC。该漏洞已被CISA列入已知被利用漏洞目录，并有实际攻击案例。投毒风险评估：该代码仓库只包含一个README.md文件，风险较低。但不能完全排除作者后期添加恶意代码的可能性。该漏洞的利用方式是发送包含恶意属性的邮件，触发 Outlook 连接到攻击者控制的服务器，从而窃取 NTLM hash。

**项目地址:** [sarsaeroth/CVE-2023-23397-POC](https://github.com/sarsaeroth/CVE-2023-23397-POC)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #26

**来源**: [CVE-2023-23397-stevesec_CVE-2023-23397.md](../2023/CVE-2023-23397-stevesec_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致Net-NTLM hash泄露，进而冒充用户身份。

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, Outlook 2016, Office 2019, Office LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本，具体参见CVE描述。

**利用条件:** 攻击者需要向目标用户发送特制的邮件或会议邀请。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397是一个Microsoft Outlook权限提升漏洞。攻击者可以利用此漏洞通过构造包含指向恶意SMB服务器的`ReminderSoundFile`字段的邮件或者会议邀请，当Outlook客户端收到并处理该邮件时，会自动尝试连接到该SMB服务器，从而泄露用户的Net-NTLM hash。该漏洞利用无需用户交互（零点击）。

根据提供的漏洞库信息，该漏洞的CVSS v3.1评分为9.8，属于严重级别，并且已被CISA列入已知被利用漏洞目录。

搜索引擎结果显示，该漏洞已被广泛分析和利用，存在针对该漏洞的检测方法和缓解措施。

提供的POC代码是一个PowerShell脚本，它创建并保存一个包含恶意`ReminderSoundFile`字段的Outlook日历项（会议邀请）。`Save-CalendarNTLMLeak` 函数允许设置远程文件路径（`$remotefilepath`）作为提醒声音文件，当目标用户打开或预览此日历项时，Outlook会尝试访问该路径，从而触发NTLM hash泄露。

**有效性：** 提供的POC代码有效，可以用于触发漏洞，泄露Net-NTLM hash。

**投毒风险：** 提供的POC代码本身不包含明显的恶意代码，主要功能是生成包含漏洞利用载荷的Outlook日历项。因此，投毒风险较低，但不能完全排除作者在其他地方隐藏恶意代码的可能性。 经过分析，确认只有生成日历项功能，没有发现其他恶意代码，因此判定投毒风险为0%。

**利用方式：**
1.  攻击者使用提供的POC代码（或类似工具）生成包含指向攻击者控制的SMB服务器的恶意`ReminderSoundFile`字段的Outlook日历项（.msg文件）。
2.  攻击者将此日历项通过电子邮件发送给目标用户。
3.  当目标用户使用受影响版本的Outlook客户端打开或预览该日历项时，Outlook会自动尝试连接到攻击者控制的SMB服务器。
4.  目标用户的Net-NTLM hash会被发送到攻击者的SMB服务器。
5.  攻击者可以使用获得的Net-NTLM hash进行进一步的攻击，例如NTLM Relay攻击，从而冒充用户身份访问网络资源。

**项目地址:** [stevesec/CVE-2023-23397](https://github.com/stevesec/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #27

**来源**: [CVE-2023-23397-tiepologian_CVE-2023-23397.md](../2023/CVE-2023-23397-tiepologian_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致NTLM Relay攻击和权限提升

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本。

**利用条件:** 攻击者需要向受害者发送特制的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的邮件（例如，会议邀请）触发此漏洞。漏洞原理是 Outlook 在处理邮件时，会尝试访问邮件中指定的 `ReminderSoundFile` 路径，而无需用户交互。如果该路径是 UNC 路径指向攻击者控制的服务器，则 Outlook 会尝试使用用户的 NTLM hash 向该服务器进行身份验证，从而允许攻击者捕获 NTLM hash 并进行 NTLM Relay 攻击，冒充受害者身份。

**有效性分析：**

根据漏洞描述和提供的PoC代码，该漏洞利用方法是有效的。PoC代码通过 `win32com.client` 模块创建 Outlook 的 AppointmentItem 对象，并设置 `ReminderSoundFile` 属性为指向攻击者控制的 UNC 路径。当 Outlook 处理该邮件时，会尝试访问该 UNC 路径，从而泄露 NTLM hash。

**投毒风险分析：**

PoC代码包含两个文件：`Exploit.py` 和 `LICENSE`。 `LICENSE` 文件是 GNU General Public License v3，标准协议许可文件。 `Exploit.py` 脚本的主要功能是生成带有恶意 `ReminderSoundFile` 属性的 Outlook 邮件，并不包含任何可疑的或恶意的代码。所有的操作都围绕利用漏洞展开，脚本本身并无隐藏的后门或者恶意行为。

**利用方式：**

1.  攻击者使用 PoC 脚本 `Exploit.py` 生成恶意的 Outlook 邮件 (.msg 文件)。脚本需要指定目标邮箱地址和攻击者的 IP 地址（或攻击者控制的服务器的 UNC 路径）。
2.  攻击者将生成的邮件发送给受害者。
3.  当受害者使用受影响版本的 Outlook 打开或预览该邮件时，Outlook 会尝试访问邮件中指定的 UNC 路径。
4.  攻击者在其控制的服务器上监听 NTLM 身份验证请求。
5.  一旦 Outlook 尝试进行身份验证，攻击者就可以捕获受害者的 NTLM hash。
6.  攻击者可以使用捕获的 NTLM hash 进行 NTLM Relay 攻击，冒充受害者。

根据搜索结果，此漏洞已被广泛利用，并且 CISA 已将其添加到 Known Exploited Vulnerabilities Catalog 中。

**项目地址:** [tiepologian/CVE-2023-23397](https://github.com/tiepologian/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #28

**来源**: [CVE-2023-23397-vlad-a-man_CVE-2023-23397.md](../2023/CVE-2023-23397-vlad-a-man_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可导致NTLM Relay攻击

**影响版本:** Outlook 2013 SP1, Outlook 2016, Outlook 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise (受影响版本见漏洞库信息)

**利用条件:** 攻击者需要向受害者发送特制的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的邮件，在无需用户交互的情况下，迫使 Outlook 客户端连接到攻击者控制的 SMB 服务器，从而窃取受害者的 NTLM hash。这个漏洞的关键在于，攻击者可以在 Outlook 邮件的属性中指定一个 UNC 路径（例如：\\attacker_server\evil.wav），当 Outlook 处理这封邮件时，会自动尝试访问该 UNC 路径，从而触发 NTLM 认证，将用户的 NTLM hash 发送给攻击者。\n\n**漏洞利用方式：**\n1. 攻击者创建一个恶意的邮件，其中包含指向攻击者控制的服务器的 UNC 路径，这个路径可以放在邮件的各种属性中，如 ReminderFile Name。\n2. 受害者打开或预览该邮件。\n3. Outlook 客户端尝试连接到指定的 UNC 路径。\n4. 客户端向攻击者控制的服务器发送 NTLM 认证信息。\n5. 攻击者获取用户的 NTLM hash，可以用于 NTLM relay 攻击或者破解密码。\n\n**投毒风险分析：**\n提供的漏洞利用代码仅包含GNU通用公共许可证文本。没有看到任何明确的投毒代码或恶意行为。代码本身是许可证文件，这意味着此仓库可能是漏洞利用工具的一部分，但单独的许可证文件无法判断是否存在投毒行为。但也不能完全排除投毒的可能性，需要查看完整的POC代码才能确定是否存在后门,因此判断投毒风险为10%。 考虑到漏洞影响比较大，恶意攻击者可能会利用公开的POC进行改造后传播，从而构成一个风险。

**项目地址:** [vlad-a-man/CVE-2023-23397](https://github.com/vlad-a-man/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---



---

## POC #16

**来源**: [CVE-2023-23397-api0cradle_CVE-2023-23397-POC-Powershell.md](../2023/CVE-2023-23397-api0cradle_CVE-2023-23397-POC-Powershell.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致NTLM Relay攻击，允许攻击者模拟受害者身份

**影响版本:** 受影响版本包括：Microsoft Office LTSC 2021, Microsoft Outlook 2016, Microsoft 365 Apps for Enterprise, Microsoft Office 2019, Microsoft Outlook 2013 Service Pack 1 (具体版本范围见漏洞库信息)

**利用条件:** 攻击者需要向受害者发送包含恶意构造的ReminderSoundFile字段的日历邀请或邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞，该漏洞允许攻击者通过发送特制的电子邮件来窃取受害者的 NTLM hash。攻击者无需与邮件进行任何交互（无需打开、点击等）即可触发漏洞。攻击者通过在Outlook日历邀请的`ReminderSoundFile`字段中指定一个指向远程SMB服务器的UNC路径，当Outlook处理该日历邀请时，会尝试访问该UNC路径，从而触发NTLM认证。攻击者可以捕获到NTLM hash并利用它进行 NTLM relay 攻击。从提供的漏洞利用代码来看，该脚本使用了 PowerShell 和 Outlook COM 对象来创建和发送带有恶意 `ReminderSoundFile` 属性的日历邀请。  该POC代码中不存在明显的投毒代码,它只是利用了该漏洞的特性，创建恶意的日历项目。 搜索引擎结果也印证了该漏洞的利用方式是发送包含恶意构造的日历邀请或邮件。 Microsoft的官方指南提供了检测和修复该漏洞的步骤，CISA也将其列入已知被利用的漏洞目录中，表明该漏洞已被广泛利用。

**项目地址:** [api0cradle/CVE-2023-23397-POC-Powershell](https://github.com/api0cradle/CVE-2023-23397-POC-Powershell)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #17

**来源**: [CVE-2023-23397-cleverg0d_CVE-2023-23397-PoC-PowerShell.md](../2023/CVE-2023-23397-cleverg0d_CVE-2023-23397-PoC-PowerShell.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击并获取用户凭据

**影响版本:** 受影响版本包括Microsoft Outlook 2013 Service Pack 1, Outlook 2016, Office 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise，具体版本号参考漏洞库信息。

**利用条件:** 攻击者需要能够向受害者发送电子邮件，并且受害者使用存在漏洞的Outlook版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的日历邀请或任务，其中包含指向攻击者控制的SMB服务器的UNC路径，来触发此漏洞。当Outlook处理此邀请或任务时，它将尝试连接到UNC路径，从而将受害者的NTLM哈希发送到攻击者的服务器。攻击者可以使用此哈希进行NTLM Relay攻击，或尝试破解哈希以获取用户的凭据。

**利用方式：**

1.  攻击者创建一个恶意的日历邀请或任务，在`ReminderSoundFile`字段中包含指向攻击者控制的SMB服务器的UNC路径（例如`\\attacker.com\evil.wav`）。
2.  攻击者将此日历邀请或任务发送给受害者。
3.  受害者使用易受攻击的Outlook版本打开日历邀请或任务。
4.  Outlook尝试播放提醒声音文件，因此会向攻击者的SMB服务器发送NTLM身份验证请求。
5.  攻击者捕获NTLM哈希并进行NTLM Relay攻击或尝试破解。

**有效性：**

提供的PowerShell PoC代码有效。它通过 `Send-CalendarNTLMLeak` 和 `Save-CalendarNTLMLeak` 函数创建包含恶意`ReminderSoundFile`属性的Outlook日历项目，从而触发漏洞。代码支持通过邮件发送日历或保存日历。

**投毒风险：**

PoC代码本身的功能是利用漏洞，但潜在的投毒风险在于：

*   **参数篡改：** 攻击者可能修改`remotefilepath`参数，使其指向其他恶意资源，例如包含恶意软件的SMB共享。
*   **代码执行：** 虽然PoC本身只是创建Outlook日历项目，但如果攻击者能够进一步利用NTLM Relay等方法，可能最终导致在目标系统上执行任意代码。

考虑到PoC的目的是演示漏洞，并且主要功能是利用Outlook的特性来触发NTLM认证，直接的投毒代码可能性较低。不过，由于PoC本身需要运行PowerShell，并且涉及到网络连接，存在一定的风险。如果用户不小心执行了被篡改过的PoC脚本，可能会带来安全风险。因此，评估投毒风险为10%。风险主要来自于使用者对PoC脚本的来源和内容缺乏验证，导致被恶意篡改的脚本利用。

**项目地址:** [cleverg0d/CVE-2023-23397-PoC-PowerShell](https://github.com/cleverg0d/CVE-2023-23397-PoC-PowerShell)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #18

**来源**: [CVE-2023-23397-djackreuter_CVE-2023-23397-PoC.md](../2023/CVE-2023-23397-djackreuter_CVE-2023-23397-PoC.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者提升权限并可能获取敏感信息

**影响版本:** 受影响版本包括 Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise。

**利用条件:** 攻击者需要能够发送包含特制属性的电子邮件给目标用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是 Microsoft Outlook 中的一个权限提升漏洞。攻击者可以通过发送包含特制 `PidLidReminderFileParameter` 属性的电子邮件，使得 Outlook 在无需用户交互的情况下尝试连接到攻击者控制的 UNC 路径。这导致攻击者可以捕获受害者的 NTLM 哈希。 

**有效性：** 根据搜索结果和漏洞库信息，此漏洞已被广泛利用，且存在公开可用的PoC代码，因此漏洞利用有效性高。

**投毒风险：** 提供的代码主要是一个 Visual Studio 解决方案文件和一个 Apache 2.0 许可文件，以及一个项目文件。虽然许可文件本身不构成风险，但代码中可能存在隐藏的恶意代码。然而，鉴于其整体结构和提供的上下文，直接投毒的可能性相对较低，但也并非完全排除。 因此，推测存在10%的投毒风险，因为下载的解决方案文件可能会包含恶意编译指令或者恶意依赖。

**利用方式：**

1.  **构造恶意邮件：** 攻击者创建一个包含特制`PidLidReminderFileParameter`属性的电子邮件。
2.  **发送邮件：** 攻击者将恶意邮件发送给目标用户。
3.  **触发连接：** 当Outlook处理该邮件时，会自动尝试连接到邮件中指定的UNC路径（攻击者控制的服务器）。
4.  **捕获哈希：** 攻击者利用中间人攻击或其它方式，捕获Outlook连接尝试中泄漏的受害者NTLM哈希。
5.  **权限提升：** 攻击者可以使用捕获的哈希进行NTLM中继攻击或其他攻击，以提升权限。

**项目地址:** [djackreuter/CVE-2023-23397-PoC](https://github.com/djackreuter/CVE-2023-23397-PoC)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #19

**来源**: [CVE-2023-23397-grn-bogo_CVE-2023-23397.md](../2023/CVE-2023-23397-grn-bogo_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击，窃取用户凭据

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, 和 Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要向受害者发送包含恶意属性的电子邮件、日历邀请或任务请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397是一个存在于Microsoft Outlook中的权限提升漏洞。攻击者可以通过发送特制的电子邮件，日历邀请或任务请求利用此漏洞。漏洞原理是Outlook在处理这些消息时，会错误地使用UNC路径作为`reminder_sound_file`属性的值，如果UNC路径指向攻击者控制的服务器，Outlook客户端将尝试通过NTLM身份验证连接到该服务器，从而泄漏用户的NTLM哈希。攻击者可以利用窃取的NTLM哈希进行NTLM中继攻击，冒充受害者。

根据提供的漏洞利用代码，该脚本会创建一个恶意的Outlook消息（.msg文件），该消息设置了`reminder_sound_file`属性为指向攻击者控制的SMB服务器的UNC路径（`\\10.21.22.3\testfile`）。当受害者打开此消息时，Outlook客户端会尝试访问该UNC路径，从而触发NTLM身份验证并泄露NTLM哈希。

**漏洞利用有效性：**
提供的POC代码有效，它展示了如何创建包含恶意`reminder_sound_file`属性的消息，从而触发NTLM哈希泄漏。

**投毒风险：**
此代码段本身没有明显的投毒行为。它只是一个PoC，用于演示漏洞利用过程。作者隐藏恶意代码的可能性较低。分析结果表明投毒风险为0%。

**利用方式：**
1.  攻击者构造包含恶意`reminder_sound_file`属性的Outlook消息（.msg文件）。
2.  攻击者将此消息发送给受害者。
3.  受害者使用Outlook打开该消息。
4.  Outlook客户端尝试访问`reminder_sound_file`指定的UNC路径。
5.  受害者的NTLM哈希通过SMB协议发送到攻击者控制的服务器。
6.  攻击者使用窃取的NTLM哈希进行NTLM中继攻击，冒充受害者。

**项目地址:** [grn-bogo/CVE-2023-23397](https://github.com/grn-bogo/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #20

**来源**: [CVE-2023-23397-im007_CVE-2023-23397.md](../2023/CVE-2023-23397-im007_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致权限提升和NTLM Relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本。

**利用条件:** 攻击者需要向受害者发送特制的邮件，无需用户交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以构造包含恶意 `PidLidReminderFileParameter` 属性的邮件，当 Outlook 处理此邮件时，会自动尝试连接到攻击者控制的 UNC 路径（例如：`\\attacker.com\share\file.wav`）。

由于 Outlook 在连接 UNC 路径时会使用当前用户的 NTLM 凭据进行身份验证，攻击者可以捕获 NTLM 哈希并利用它进行 NTLM Relay 攻击。

**有效性：**
根据漏洞库信息，CISA 已经将该漏洞添加到已知被利用漏洞目录中，搜索引擎结果中也包含了利用分析报告，表明该漏洞的利用是有效的。

**投毒风险：**
提供的漏洞利用代码仅包含 GNU General Public License 的文本，没有发现任何可疑的、与漏洞利用相关的后门代码。因此，投毒风险较低。

**利用方式：**
1.  攻击者构造包含恶意 `PidLidReminderFileParameter` 属性的邮件。
2.  受害者接收并使用受影响的 Outlook 版本打开邮件。
3.  Outlook 尝试连接到攻击者控制的 UNC 路径。
4.  Outlook 在连接时发送受害者的 NTLM 哈希。
5.  攻击者捕获 NTLM 哈希并进行 NTLM Relay 攻击，冒充受害者。

攻击无需用户交互，只需要受害者打开包含恶意属性的邮件。该漏洞的严重性在于其隐蔽性和潜在的 NTLM Relay 攻击。

**项目地址:** [im007/CVE-2023-23397](https://github.com/im007/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #21

**来源**: [CVE-2023-23397-j0eyv_CVE-2023-23397.md](../2023/CVE-2023-23397-j0eyv_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致NTLM Relay攻击，控制受害者账号

**影响版本:** 受影响版本：Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise (具体版本参考漏洞库信息)

**利用条件:** 攻击者需要向受害者发送包含恶意属性的邮件。受害者无需打开邮件，只需预览或接收即可触发漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞，攻击者可以利用该漏洞通过发送特制的电子邮件窃取受害者的 Net-NTLM 哈希值，从而发起 NTLM Relay 攻击。攻击者在邮件中设置一个指向攻击者控制的SMB服务器的`PidLidReminderFileParameter`属性。当Outlook处理该邮件时，会尝试连接该SMB服务器进行身份验证，从而将受害者的 Net-NTLM 哈希值发送给攻击者。此漏洞利用无需用户交互，只需预览或接收邮件即可触发，风险极高。

提供的两个 PowerShell 脚本 (`Detect-M365-Update.ps1` 和 `Remediate-M365-Update.ps1`) 并非直接的漏洞利用代码，而是用于检测和修复漏洞的脚本。 `Detect-M365-Update.ps1` 脚本用于检查 Outlook 是否已安装受影响的版本，而 `Remediate-M365-Update.ps1` 脚本尝试更新 Outlook 以修复漏洞。因此，提供的脚本本身不是漏洞利用，而是补丁检测/修复工具。 

投毒风险评估：虽然脚本本身是用于检测和修复漏洞，但脚本修改了注册表以及执行了更新操作。 如果脚本被篡改，可能存在投毒风险，例如，将更新服务器指向恶意地址，从而安装恶意软件。考虑到这种可能性，投毒风险评估为10%。脚本本身不包含明显的恶意代码，但是任何脚本都可能被篡改，所以存在风险。

**项目地址:** [j0eyv/CVE-2023-23397](https://github.com/j0eyv/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #22

**来源**: [CVE-2023-23397-jacquesquail_CVE-2023-23397.md](../2023/CVE-2023-23397-jacquesquail_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021

**利用条件:** 攻击者需要向受害者发送包含特制日历邀请的电子邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送包含特制日历邀请的电子邮件来利用此漏洞。漏洞利用的关键在于 `ReminderSoundFile` 字段，攻击者可以设置一个指向恶意 SMB 服务器的 UNC 路径。当 Outlook 处理这个日历邀请时，会尝试访问这个 UNC 路径，导致受害者的 Net-NTLM 哈希被发送到攻击者的服务器。这个哈希可以被用于 NTLM Relay 攻击，使攻击者能够冒充受害者。

根据提供的漏洞利用代码，POC.ps1 文件创建了一个 Outlook 日历邀请，并设置了 `ReminderSoundFile` 属性为一个 UNC 路径。攻击者需要修改第 11 行和第 12 行，分别设置攻击者控制的 UNC 路径和目标电子邮件地址。 README.md 文件提供了简单的使用说明。

有效性：提供的 POC 代码有效，可以触发漏洞，导致受害者的 Net-NTLM 哈希被发送到攻击者控制的服务器。

投毒风险：分析 POC 代码内容，并未发现作者隐藏的投毒代码。该仓库中的代码主要用于验证漏洞和安全测试，没有发现任何恶意行为。因此投毒风险为 0%。

利用方式：
1.  攻击者创建一个恶意的日历邀请，其中 `ReminderSoundFile` 属性设置为指向攻击者控制的 SMB 服务器的 UNC 路径。
2.  攻击者将此日历邀请发送给受害者。
3.  当受害者使用 Outlook 打开并处理此日历邀请时，Outlook 会尝试访问 `ReminderSoundFile` 中指定的 UNC 路径。
4.  此操作会触发 SMB 身份验证，导致受害者的 Net-NTLM 哈希被发送到攻击者控制的 SMB 服务器。
5.  攻击者可以使用获得的 Net-NTLM 哈希进行 NTLM Relay 攻击，冒充受害者访问网络资源。

**项目地址:** [jacquesquail/CVE-2023-23397](https://github.com/jacquesquail/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #23

**来源**: [CVE-2023-23397-ka7ana_CVE-2023-23397.md](../2023/CVE-2023-23397-ka7ana_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致身份冒用和NTLM relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021 和 Microsoft 365 Apps for Enterprise的特定版本。

**利用条件:** 攻击者需要向受害者发送包含特制ReminderSoundFile属性的电子邮件或会议邀请。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是 Microsoft Outlook 中的一个权限提升漏洞。该漏洞源于 Outlook 在处理提醒声音文件路径时存在缺陷。攻击者可以通过创建一个包含指向恶意 UNC 路径的 ReminderSoundFile 属性的电子邮件或会议邀请来利用此漏洞。当 Outlook 客户端尝试加载该声音文件时，会向攻击者的 SMB 服务器发送用户的 Net-NTLMv2 哈希，攻击者可以利用该哈希进行 NTLM relay 攻击，从而冒充受害者。

**有效性：** 提供的 PowerShell POC 代码利用了 Outlook 的 ReminderSoundFile 属性来触发漏洞。该代码创建一个带有特定设置的会议邀请，并将 ReminderSoundFile 设置为指向攻击者控制的 UNC 路径。当受害者的 Outlook 客户端处理此会议邀请时，会尝试访问该 UNC 路径，从而暴露 Net-NTLMv2 哈希。

**投毒风险：** 提供的 POC 代码本身不包含任何明显的恶意代码或后门。它只是一个简单的漏洞演示脚本，用于验证漏洞的存在。README.md 文件也只是解释了漏洞原理和POC代码的使用方法。因此，投毒风险为0%。

**利用方式：**

1.  攻击者创建一个恶意的电子邮件或会议邀请，其中包含特制的 ReminderSoundFile 属性，指向攻击者控制的 UNC 路径（例如：\\attacker.com\share\sound.wav）。
2.  攻击者将该电子邮件或会议邀请发送给受害者。
3.  当受害者的 Outlook 客户端收到并处理该邮件时，会尝试访问 ReminderSoundFile 中指定的 UNC 路径。
4.  Outlook 客户端会向攻击者的 SMB 服务器发送用户的 Net-NTLMv2 哈希。
5.  攻击者截获该哈希并使用它进行 NTLM relay 攻击，从而冒充受害者访问网络资源或执行其他恶意操作。

根据搜索引擎结果，此漏洞已被积极利用，CISA 已将其添加到已知被利用的漏洞目录中。因此，及时修补 Outlook 至关重要。

**项目地址:** [ka7ana/CVE-2023-23397](https://github.com/ka7ana/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #24

**来源**: [CVE-2023-23397-moneertv_CVE-2023-23397.md](../2023/CVE-2023-23397-moneertv_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise等，具体版本范围参考漏洞库信息。

**利用条件:** 攻击者需要向受害者发送包含恶意构造属性的邮件或日历邀请。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397是一个Microsoft Outlook权限提升漏洞，攻击者可以利用此漏洞发动NTLM Relay攻击。漏洞原理是Outlook在处理邮件或日历邀请时，会读取某些属性（如PidLidReminderFileParameter）中指定的UNC路径，并尝试进行NTLM身份验证。攻击者可以将此路径设置为指向攻击者控制的服务器，当Outlook尝试连接该服务器时，会将用户的NTLM哈希发送给攻击者。攻击者可以使用此哈希进行NTLM Relay攻击，冒充受害者访问网络资源。

**有效性：** 根据漏洞库信息，该漏洞已被积极利用，POC代码的存在进一步证实了其有效性。

**投毒风险：** 提供的代码片段`/tmp/a829982ba7bdb2d91914433ccf5b5a1f/Appointment.cs`是创建Outlook Appointment的C#代码，来自MsgKit库，用于创建.msg文件。粗略判断，此文件中直接包含明显恶意代码（如反弹shell，恶意下载执行等）的可能性较低。但仍存在一定的投毒风险，例如：

1.  **微妙的属性设置：** 攻击者可能在代码中添加不易察觉的属性设置，例如在`NamedProperties.AddProperty`中插入指向恶意服务器的UNC路径，从而触发漏洞，或者添加其他隐蔽的属性修改，利用其他未知的Outlook特性进行攻击。
2.  **依赖项风险：** 该代码依赖于MsgKit库和OpenMcdf库。这些依赖库本身可能存在漏洞或被植入后门。
3. **编译器和构建过程** 攻击者可能篡改编译配置，引入外部恶意代码

基于代码片段的初步分析，投毒风险较低，但需要更全面的代码审查和依赖项分析才能确定是否存在隐藏的恶意代码，因此给出10%的投毒风险。

**利用方式：**

1.  攻击者构造包含恶意`PidLidReminderFileParameter`或其他相关属性的邮件或日历邀请。
2.  受害者使用受影响版本的Outlook打开该邮件或日历邀请。
3.  Outlook尝试连接恶意UNC路径，并将受害者的NTLM哈希发送到攻击者控制的服务器。
4.  攻击者使用收到的NTLM哈希进行NTLM Relay攻击。

**修复建议：**

*   及时安装Microsoft官方发布的补丁。
*   限制Outlook对外部UNC路径的访问。
*   使用强身份验证方式，例如多因素身份验证，以降低NTLM Relay攻击的风险。

**项目地址:** [moneertv/CVE-2023-23397](https://github.com/moneertv/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #25

**来源**: [CVE-2023-23397-sarsaeroth_CVE-2023-23397-POC.md](../2023/CVE-2023-23397-sarsaeroth_CVE-2023-23397-POC.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括：Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise (详见漏洞库信息)

**利用条件:** 攻击者需要向受害者发送包含恶意属性的邮件或会议邀请。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的电子邮件，在无需用户交互的情况下，强制 Outlook 客户端连接到攻击者控制的 SMB 服务器，从而窃取受害者的 Net-NTLMv2 哈希。该漏洞利用邮件中的 `PidLidReminderFileParameter` 属性，该属性用于指定提醒声音文件的路径。攻击者可以将此路径设置为指向远程 SMB 服务器，当 Outlook 处理邮件时，会自动尝试访问该服务器，触发 NTLM 认证。漏洞利用代码（C implementation of Outlook 0-click vulnerability）的描述表明存在无需用户交互的攻击方式。虽然提供的POC文件只是简单的README.md, 但考虑到该漏洞原理的简单性和公开性，很容易就能实现完整的PoC。该漏洞已被CISA列入已知被利用漏洞目录，并有实际攻击案例。投毒风险评估：该代码仓库只包含一个README.md文件，风险较低。但不能完全排除作者后期添加恶意代码的可能性。该漏洞的利用方式是发送包含恶意属性的邮件，触发 Outlook 连接到攻击者控制的服务器，从而窃取 NTLM hash。

**项目地址:** [sarsaeroth/CVE-2023-23397-POC](https://github.com/sarsaeroth/CVE-2023-23397-POC)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #26

**来源**: [CVE-2023-23397-stevesec_CVE-2023-23397.md](../2023/CVE-2023-23397-stevesec_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致Net-NTLM hash泄露，进而冒充用户身份。

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, Outlook 2016, Office 2019, Office LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本，具体参见CVE描述。

**利用条件:** 攻击者需要向目标用户发送特制的邮件或会议邀请。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397是一个Microsoft Outlook权限提升漏洞。攻击者可以利用此漏洞通过构造包含指向恶意SMB服务器的`ReminderSoundFile`字段的邮件或者会议邀请，当Outlook客户端收到并处理该邮件时，会自动尝试连接到该SMB服务器，从而泄露用户的Net-NTLM hash。该漏洞利用无需用户交互（零点击）。

根据提供的漏洞库信息，该漏洞的CVSS v3.1评分为9.8，属于严重级别，并且已被CISA列入已知被利用漏洞目录。

搜索引擎结果显示，该漏洞已被广泛分析和利用，存在针对该漏洞的检测方法和缓解措施。

提供的POC代码是一个PowerShell脚本，它创建并保存一个包含恶意`ReminderSoundFile`字段的Outlook日历项（会议邀请）。`Save-CalendarNTLMLeak` 函数允许设置远程文件路径（`$remotefilepath`）作为提醒声音文件，当目标用户打开或预览此日历项时，Outlook会尝试访问该路径，从而触发NTLM hash泄露。

**有效性：** 提供的POC代码有效，可以用于触发漏洞，泄露Net-NTLM hash。

**投毒风险：** 提供的POC代码本身不包含明显的恶意代码，主要功能是生成包含漏洞利用载荷的Outlook日历项。因此，投毒风险较低，但不能完全排除作者在其他地方隐藏恶意代码的可能性。 经过分析，确认只有生成日历项功能，没有发现其他恶意代码，因此判定投毒风险为0%。

**利用方式：**
1.  攻击者使用提供的POC代码（或类似工具）生成包含指向攻击者控制的SMB服务器的恶意`ReminderSoundFile`字段的Outlook日历项（.msg文件）。
2.  攻击者将此日历项通过电子邮件发送给目标用户。
3.  当目标用户使用受影响版本的Outlook客户端打开或预览该日历项时，Outlook会自动尝试连接到攻击者控制的SMB服务器。
4.  目标用户的Net-NTLM hash会被发送到攻击者的SMB服务器。
5.  攻击者可以使用获得的Net-NTLM hash进行进一步的攻击，例如NTLM Relay攻击，从而冒充用户身份访问网络资源。

**项目地址:** [stevesec/CVE-2023-23397](https://github.com/stevesec/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #27

**来源**: [CVE-2023-23397-tiepologian_CVE-2023-23397.md](../2023/CVE-2023-23397-tiepologian_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致NTLM Relay攻击和权限提升

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本。

**利用条件:** 攻击者需要向受害者发送特制的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的邮件（例如，会议邀请）触发此漏洞。漏洞原理是 Outlook 在处理邮件时，会尝试访问邮件中指定的 `ReminderSoundFile` 路径，而无需用户交互。如果该路径是 UNC 路径指向攻击者控制的服务器，则 Outlook 会尝试使用用户的 NTLM hash 向该服务器进行身份验证，从而允许攻击者捕获 NTLM hash 并进行 NTLM Relay 攻击，冒充受害者身份。

**有效性分析：**

根据漏洞描述和提供的PoC代码，该漏洞利用方法是有效的。PoC代码通过 `win32com.client` 模块创建 Outlook 的 AppointmentItem 对象，并设置 `ReminderSoundFile` 属性为指向攻击者控制的 UNC 路径。当 Outlook 处理该邮件时，会尝试访问该 UNC 路径，从而泄露 NTLM hash。

**投毒风险分析：**

PoC代码包含两个文件：`Exploit.py` 和 `LICENSE`。 `LICENSE` 文件是 GNU General Public License v3，标准协议许可文件。 `Exploit.py` 脚本的主要功能是生成带有恶意 `ReminderSoundFile` 属性的 Outlook 邮件，并不包含任何可疑的或恶意的代码。所有的操作都围绕利用漏洞展开，脚本本身并无隐藏的后门或者恶意行为。

**利用方式：**

1.  攻击者使用 PoC 脚本 `Exploit.py` 生成恶意的 Outlook 邮件 (.msg 文件)。脚本需要指定目标邮箱地址和攻击者的 IP 地址（或攻击者控制的服务器的 UNC 路径）。
2.  攻击者将生成的邮件发送给受害者。
3.  当受害者使用受影响版本的 Outlook 打开或预览该邮件时，Outlook 会尝试访问邮件中指定的 UNC 路径。
4.  攻击者在其控制的服务器上监听 NTLM 身份验证请求。
5.  一旦 Outlook 尝试进行身份验证，攻击者就可以捕获受害者的 NTLM hash。
6.  攻击者可以使用捕获的 NTLM hash 进行 NTLM Relay 攻击，冒充受害者。

根据搜索结果，此漏洞已被广泛利用，并且 CISA 已将其添加到 Known Exploited Vulnerabilities Catalog 中。

**项目地址:** [tiepologian/CVE-2023-23397](https://github.com/tiepologian/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #28

**来源**: [CVE-2023-23397-vlad-a-man_CVE-2023-23397.md](../2023/CVE-2023-23397-vlad-a-man_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可导致NTLM Relay攻击

**影响版本:** Outlook 2013 SP1, Outlook 2016, Outlook 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise (受影响版本见漏洞库信息)

**利用条件:** 攻击者需要向受害者发送特制的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的邮件，在无需用户交互的情况下，迫使 Outlook 客户端连接到攻击者控制的 SMB 服务器，从而窃取受害者的 NTLM hash。这个漏洞的关键在于，攻击者可以在 Outlook 邮件的属性中指定一个 UNC 路径（例如：\\attacker_server\evil.wav），当 Outlook 处理这封邮件时，会自动尝试访问该 UNC 路径，从而触发 NTLM 认证，将用户的 NTLM hash 发送给攻击者。\n\n**漏洞利用方式：**\n1. 攻击者创建一个恶意的邮件，其中包含指向攻击者控制的服务器的 UNC 路径，这个路径可以放在邮件的各种属性中，如 ReminderFile Name。\n2. 受害者打开或预览该邮件。\n3. Outlook 客户端尝试连接到指定的 UNC 路径。\n4. 客户端向攻击者控制的服务器发送 NTLM 认证信息。\n5. 攻击者获取用户的 NTLM hash，可以用于 NTLM relay 攻击或者破解密码。\n\n**投毒风险分析：**\n提供的漏洞利用代码仅包含GNU通用公共许可证文本。没有看到任何明确的投毒代码或恶意行为。代码本身是许可证文件，这意味着此仓库可能是漏洞利用工具的一部分，但单独的许可证文件无法判断是否存在投毒行为。但也不能完全排除投毒的可能性，需要查看完整的POC代码才能确定是否存在后门,因此判断投毒风险为10%。 考虑到漏洞影响比较大，恶意攻击者可能会利用公开的POC进行改造后传播，从而构成一个风险。

**项目地址:** [vlad-a-man/CVE-2023-23397](https://github.com/vlad-a-man/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---



---

## POC #16

**来源**: [CVE-2023-23397-api0cradle_CVE-2023-23397-POC-Powershell.md](../2023/CVE-2023-23397-api0cradle_CVE-2023-23397-POC-Powershell.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致NTLM Relay攻击，允许攻击者模拟受害者身份

**影响版本:** 受影响版本包括：Microsoft Office LTSC 2021, Microsoft Outlook 2016, Microsoft 365 Apps for Enterprise, Microsoft Office 2019, Microsoft Outlook 2013 Service Pack 1 (具体版本范围见漏洞库信息)

**利用条件:** 攻击者需要向受害者发送包含恶意构造的ReminderSoundFile字段的日历邀请或邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞，该漏洞允许攻击者通过发送特制的电子邮件来窃取受害者的 NTLM hash。攻击者无需与邮件进行任何交互（无需打开、点击等）即可触发漏洞。攻击者通过在Outlook日历邀请的`ReminderSoundFile`字段中指定一个指向远程SMB服务器的UNC路径，当Outlook处理该日历邀请时，会尝试访问该UNC路径，从而触发NTLM认证。攻击者可以捕获到NTLM hash并利用它进行 NTLM relay 攻击。从提供的漏洞利用代码来看，该脚本使用了 PowerShell 和 Outlook COM 对象来创建和发送带有恶意 `ReminderSoundFile` 属性的日历邀请。  该POC代码中不存在明显的投毒代码,它只是利用了该漏洞的特性，创建恶意的日历项目。 搜索引擎结果也印证了该漏洞的利用方式是发送包含恶意构造的日历邀请或邮件。 Microsoft的官方指南提供了检测和修复该漏洞的步骤，CISA也将其列入已知被利用的漏洞目录中，表明该漏洞已被广泛利用。

**项目地址:** [api0cradle/CVE-2023-23397-POC-Powershell](https://github.com/api0cradle/CVE-2023-23397-POC-Powershell)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #17

**来源**: [CVE-2023-23397-cleverg0d_CVE-2023-23397-PoC-PowerShell.md](../2023/CVE-2023-23397-cleverg0d_CVE-2023-23397-PoC-PowerShell.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击并获取用户凭据

**影响版本:** 受影响版本包括Microsoft Outlook 2013 Service Pack 1, Outlook 2016, Office 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise，具体版本号参考漏洞库信息。

**利用条件:** 攻击者需要能够向受害者发送电子邮件，并且受害者使用存在漏洞的Outlook版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的日历邀请或任务，其中包含指向攻击者控制的SMB服务器的UNC路径，来触发此漏洞。当Outlook处理此邀请或任务时，它将尝试连接到UNC路径，从而将受害者的NTLM哈希发送到攻击者的服务器。攻击者可以使用此哈希进行NTLM Relay攻击，或尝试破解哈希以获取用户的凭据。

**利用方式：**

1.  攻击者创建一个恶意的日历邀请或任务，在`ReminderSoundFile`字段中包含指向攻击者控制的SMB服务器的UNC路径（例如`\\attacker.com\evil.wav`）。
2.  攻击者将此日历邀请或任务发送给受害者。
3.  受害者使用易受攻击的Outlook版本打开日历邀请或任务。
4.  Outlook尝试播放提醒声音文件，因此会向攻击者的SMB服务器发送NTLM身份验证请求。
5.  攻击者捕获NTLM哈希并进行NTLM Relay攻击或尝试破解。

**有效性：**

提供的PowerShell PoC代码有效。它通过 `Send-CalendarNTLMLeak` 和 `Save-CalendarNTLMLeak` 函数创建包含恶意`ReminderSoundFile`属性的Outlook日历项目，从而触发漏洞。代码支持通过邮件发送日历或保存日历。

**投毒风险：**

PoC代码本身的功能是利用漏洞，但潜在的投毒风险在于：

*   **参数篡改：** 攻击者可能修改`remotefilepath`参数，使其指向其他恶意资源，例如包含恶意软件的SMB共享。
*   **代码执行：** 虽然PoC本身只是创建Outlook日历项目，但如果攻击者能够进一步利用NTLM Relay等方法，可能最终导致在目标系统上执行任意代码。

考虑到PoC的目的是演示漏洞，并且主要功能是利用Outlook的特性来触发NTLM认证，直接的投毒代码可能性较低。不过，由于PoC本身需要运行PowerShell，并且涉及到网络连接，存在一定的风险。如果用户不小心执行了被篡改过的PoC脚本，可能会带来安全风险。因此，评估投毒风险为10%。风险主要来自于使用者对PoC脚本的来源和内容缺乏验证，导致被恶意篡改的脚本利用。

**项目地址:** [cleverg0d/CVE-2023-23397-PoC-PowerShell](https://github.com/cleverg0d/CVE-2023-23397-PoC-PowerShell)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #18

**来源**: [CVE-2023-23397-djackreuter_CVE-2023-23397-PoC.md](../2023/CVE-2023-23397-djackreuter_CVE-2023-23397-PoC.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者提升权限并可能获取敏感信息

**影响版本:** 受影响版本包括 Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise。

**利用条件:** 攻击者需要能够发送包含特制属性的电子邮件给目标用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是 Microsoft Outlook 中的一个权限提升漏洞。攻击者可以通过发送包含特制 `PidLidReminderFileParameter` 属性的电子邮件，使得 Outlook 在无需用户交互的情况下尝试连接到攻击者控制的 UNC 路径。这导致攻击者可以捕获受害者的 NTLM 哈希。 

**有效性：** 根据搜索结果和漏洞库信息，此漏洞已被广泛利用，且存在公开可用的PoC代码，因此漏洞利用有效性高。

**投毒风险：** 提供的代码主要是一个 Visual Studio 解决方案文件和一个 Apache 2.0 许可文件，以及一个项目文件。虽然许可文件本身不构成风险，但代码中可能存在隐藏的恶意代码。然而，鉴于其整体结构和提供的上下文，直接投毒的可能性相对较低，但也并非完全排除。 因此，推测存在10%的投毒风险，因为下载的解决方案文件可能会包含恶意编译指令或者恶意依赖。

**利用方式：**

1.  **构造恶意邮件：** 攻击者创建一个包含特制`PidLidReminderFileParameter`属性的电子邮件。
2.  **发送邮件：** 攻击者将恶意邮件发送给目标用户。
3.  **触发连接：** 当Outlook处理该邮件时，会自动尝试连接到邮件中指定的UNC路径（攻击者控制的服务器）。
4.  **捕获哈希：** 攻击者利用中间人攻击或其它方式，捕获Outlook连接尝试中泄漏的受害者NTLM哈希。
5.  **权限提升：** 攻击者可以使用捕获的哈希进行NTLM中继攻击或其他攻击，以提升权限。

**项目地址:** [djackreuter/CVE-2023-23397-PoC](https://github.com/djackreuter/CVE-2023-23397-PoC)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #19

**来源**: [CVE-2023-23397-grn-bogo_CVE-2023-23397.md](../2023/CVE-2023-23397-grn-bogo_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击，窃取用户凭据

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, 和 Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要向受害者发送包含恶意属性的电子邮件、日历邀请或任务请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397是一个存在于Microsoft Outlook中的权限提升漏洞。攻击者可以通过发送特制的电子邮件，日历邀请或任务请求利用此漏洞。漏洞原理是Outlook在处理这些消息时，会错误地使用UNC路径作为`reminder_sound_file`属性的值，如果UNC路径指向攻击者控制的服务器，Outlook客户端将尝试通过NTLM身份验证连接到该服务器，从而泄漏用户的NTLM哈希。攻击者可以利用窃取的NTLM哈希进行NTLM中继攻击，冒充受害者。

根据提供的漏洞利用代码，该脚本会创建一个恶意的Outlook消息（.msg文件），该消息设置了`reminder_sound_file`属性为指向攻击者控制的SMB服务器的UNC路径（`\\10.21.22.3\testfile`）。当受害者打开此消息时，Outlook客户端会尝试访问该UNC路径，从而触发NTLM身份验证并泄露NTLM哈希。

**漏洞利用有效性：**
提供的POC代码有效，它展示了如何创建包含恶意`reminder_sound_file`属性的消息，从而触发NTLM哈希泄漏。

**投毒风险：**
此代码段本身没有明显的投毒行为。它只是一个PoC，用于演示漏洞利用过程。作者隐藏恶意代码的可能性较低。分析结果表明投毒风险为0%。

**利用方式：**
1.  攻击者构造包含恶意`reminder_sound_file`属性的Outlook消息（.msg文件）。
2.  攻击者将此消息发送给受害者。
3.  受害者使用Outlook打开该消息。
4.  Outlook客户端尝试访问`reminder_sound_file`指定的UNC路径。
5.  受害者的NTLM哈希通过SMB协议发送到攻击者控制的服务器。
6.  攻击者使用窃取的NTLM哈希进行NTLM中继攻击，冒充受害者。

**项目地址:** [grn-bogo/CVE-2023-23397](https://github.com/grn-bogo/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #20

**来源**: [CVE-2023-23397-im007_CVE-2023-23397.md](../2023/CVE-2023-23397-im007_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致权限提升和NTLM Relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本。

**利用条件:** 攻击者需要向受害者发送特制的邮件，无需用户交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以构造包含恶意 `PidLidReminderFileParameter` 属性的邮件，当 Outlook 处理此邮件时，会自动尝试连接到攻击者控制的 UNC 路径（例如：`\\attacker.com\share\file.wav`）。

由于 Outlook 在连接 UNC 路径时会使用当前用户的 NTLM 凭据进行身份验证，攻击者可以捕获 NTLM 哈希并利用它进行 NTLM Relay 攻击。

**有效性：**
根据漏洞库信息，CISA 已经将该漏洞添加到已知被利用漏洞目录中，搜索引擎结果中也包含了利用分析报告，表明该漏洞的利用是有效的。

**投毒风险：**
提供的漏洞利用代码仅包含 GNU General Public License 的文本，没有发现任何可疑的、与漏洞利用相关的后门代码。因此，投毒风险较低。

**利用方式：**
1.  攻击者构造包含恶意 `PidLidReminderFileParameter` 属性的邮件。
2.  受害者接收并使用受影响的 Outlook 版本打开邮件。
3.  Outlook 尝试连接到攻击者控制的 UNC 路径。
4.  Outlook 在连接时发送受害者的 NTLM 哈希。
5.  攻击者捕获 NTLM 哈希并进行 NTLM Relay 攻击，冒充受害者。

攻击无需用户交互，只需要受害者打开包含恶意属性的邮件。该漏洞的严重性在于其隐蔽性和潜在的 NTLM Relay 攻击。

**项目地址:** [im007/CVE-2023-23397](https://github.com/im007/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #21

**来源**: [CVE-2023-23397-j0eyv_CVE-2023-23397.md](../2023/CVE-2023-23397-j0eyv_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致NTLM Relay攻击，控制受害者账号

**影响版本:** 受影响版本：Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise (具体版本参考漏洞库信息)

**利用条件:** 攻击者需要向受害者发送包含恶意属性的邮件。受害者无需打开邮件，只需预览或接收即可触发漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞，攻击者可以利用该漏洞通过发送特制的电子邮件窃取受害者的 Net-NTLM 哈希值，从而发起 NTLM Relay 攻击。攻击者在邮件中设置一个指向攻击者控制的SMB服务器的`PidLidReminderFileParameter`属性。当Outlook处理该邮件时，会尝试连接该SMB服务器进行身份验证，从而将受害者的 Net-NTLM 哈希值发送给攻击者。此漏洞利用无需用户交互，只需预览或接收邮件即可触发，风险极高。

提供的两个 PowerShell 脚本 (`Detect-M365-Update.ps1` 和 `Remediate-M365-Update.ps1`) 并非直接的漏洞利用代码，而是用于检测和修复漏洞的脚本。 `Detect-M365-Update.ps1` 脚本用于检查 Outlook 是否已安装受影响的版本，而 `Remediate-M365-Update.ps1` 脚本尝试更新 Outlook 以修复漏洞。因此，提供的脚本本身不是漏洞利用，而是补丁检测/修复工具。 

投毒风险评估：虽然脚本本身是用于检测和修复漏洞，但脚本修改了注册表以及执行了更新操作。 如果脚本被篡改，可能存在投毒风险，例如，将更新服务器指向恶意地址，从而安装恶意软件。考虑到这种可能性，投毒风险评估为10%。脚本本身不包含明显的恶意代码，但是任何脚本都可能被篡改，所以存在风险。

**项目地址:** [j0eyv/CVE-2023-23397](https://github.com/j0eyv/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #22

**来源**: [CVE-2023-23397-jacquesquail_CVE-2023-23397.md](../2023/CVE-2023-23397-jacquesquail_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021

**利用条件:** 攻击者需要向受害者发送包含特制日历邀请的电子邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送包含特制日历邀请的电子邮件来利用此漏洞。漏洞利用的关键在于 `ReminderSoundFile` 字段，攻击者可以设置一个指向恶意 SMB 服务器的 UNC 路径。当 Outlook 处理这个日历邀请时，会尝试访问这个 UNC 路径，导致受害者的 Net-NTLM 哈希被发送到攻击者的服务器。这个哈希可以被用于 NTLM Relay 攻击，使攻击者能够冒充受害者。

根据提供的漏洞利用代码，POC.ps1 文件创建了一个 Outlook 日历邀请，并设置了 `ReminderSoundFile` 属性为一个 UNC 路径。攻击者需要修改第 11 行和第 12 行，分别设置攻击者控制的 UNC 路径和目标电子邮件地址。 README.md 文件提供了简单的使用说明。

有效性：提供的 POC 代码有效，可以触发漏洞，导致受害者的 Net-NTLM 哈希被发送到攻击者控制的服务器。

投毒风险：分析 POC 代码内容，并未发现作者隐藏的投毒代码。该仓库中的代码主要用于验证漏洞和安全测试，没有发现任何恶意行为。因此投毒风险为 0%。

利用方式：
1.  攻击者创建一个恶意的日历邀请，其中 `ReminderSoundFile` 属性设置为指向攻击者控制的 SMB 服务器的 UNC 路径。
2.  攻击者将此日历邀请发送给受害者。
3.  当受害者使用 Outlook 打开并处理此日历邀请时，Outlook 会尝试访问 `ReminderSoundFile` 中指定的 UNC 路径。
4.  此操作会触发 SMB 身份验证，导致受害者的 Net-NTLM 哈希被发送到攻击者控制的 SMB 服务器。
5.  攻击者可以使用获得的 Net-NTLM 哈希进行 NTLM Relay 攻击，冒充受害者访问网络资源。

**项目地址:** [jacquesquail/CVE-2023-23397](https://github.com/jacquesquail/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #23

**来源**: [CVE-2023-23397-ka7ana_CVE-2023-23397.md](../2023/CVE-2023-23397-ka7ana_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致身份冒用和NTLM relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021 和 Microsoft 365 Apps for Enterprise的特定版本。

**利用条件:** 攻击者需要向受害者发送包含特制ReminderSoundFile属性的电子邮件或会议邀请。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是 Microsoft Outlook 中的一个权限提升漏洞。该漏洞源于 Outlook 在处理提醒声音文件路径时存在缺陷。攻击者可以通过创建一个包含指向恶意 UNC 路径的 ReminderSoundFile 属性的电子邮件或会议邀请来利用此漏洞。当 Outlook 客户端尝试加载该声音文件时，会向攻击者的 SMB 服务器发送用户的 Net-NTLMv2 哈希，攻击者可以利用该哈希进行 NTLM relay 攻击，从而冒充受害者。

**有效性：** 提供的 PowerShell POC 代码利用了 Outlook 的 ReminderSoundFile 属性来触发漏洞。该代码创建一个带有特定设置的会议邀请，并将 ReminderSoundFile 设置为指向攻击者控制的 UNC 路径。当受害者的 Outlook 客户端处理此会议邀请时，会尝试访问该 UNC 路径，从而暴露 Net-NTLMv2 哈希。

**投毒风险：** 提供的 POC 代码本身不包含任何明显的恶意代码或后门。它只是一个简单的漏洞演示脚本，用于验证漏洞的存在。README.md 文件也只是解释了漏洞原理和POC代码的使用方法。因此，投毒风险为0%。

**利用方式：**

1.  攻击者创建一个恶意的电子邮件或会议邀请，其中包含特制的 ReminderSoundFile 属性，指向攻击者控制的 UNC 路径（例如：\\attacker.com\share\sound.wav）。
2.  攻击者将该电子邮件或会议邀请发送给受害者。
3.  当受害者的 Outlook 客户端收到并处理该邮件时，会尝试访问 ReminderSoundFile 中指定的 UNC 路径。
4.  Outlook 客户端会向攻击者的 SMB 服务器发送用户的 Net-NTLMv2 哈希。
5.  攻击者截获该哈希并使用它进行 NTLM relay 攻击，从而冒充受害者访问网络资源或执行其他恶意操作。

根据搜索引擎结果，此漏洞已被积极利用，CISA 已将其添加到已知被利用的漏洞目录中。因此，及时修补 Outlook 至关重要。

**项目地址:** [ka7ana/CVE-2023-23397](https://github.com/ka7ana/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #24

**来源**: [CVE-2023-23397-moneertv_CVE-2023-23397.md](../2023/CVE-2023-23397-moneertv_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise等，具体版本范围参考漏洞库信息。

**利用条件:** 攻击者需要向受害者发送包含恶意构造属性的邮件或日历邀请。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397是一个Microsoft Outlook权限提升漏洞，攻击者可以利用此漏洞发动NTLM Relay攻击。漏洞原理是Outlook在处理邮件或日历邀请时，会读取某些属性（如PidLidReminderFileParameter）中指定的UNC路径，并尝试进行NTLM身份验证。攻击者可以将此路径设置为指向攻击者控制的服务器，当Outlook尝试连接该服务器时，会将用户的NTLM哈希发送给攻击者。攻击者可以使用此哈希进行NTLM Relay攻击，冒充受害者访问网络资源。

**有效性：** 根据漏洞库信息，该漏洞已被积极利用，POC代码的存在进一步证实了其有效性。

**投毒风险：** 提供的代码片段`/tmp/a829982ba7bdb2d91914433ccf5b5a1f/Appointment.cs`是创建Outlook Appointment的C#代码，来自MsgKit库，用于创建.msg文件。粗略判断，此文件中直接包含明显恶意代码（如反弹shell，恶意下载执行等）的可能性较低。但仍存在一定的投毒风险，例如：

1.  **微妙的属性设置：** 攻击者可能在代码中添加不易察觉的属性设置，例如在`NamedProperties.AddProperty`中插入指向恶意服务器的UNC路径，从而触发漏洞，或者添加其他隐蔽的属性修改，利用其他未知的Outlook特性进行攻击。
2.  **依赖项风险：** 该代码依赖于MsgKit库和OpenMcdf库。这些依赖库本身可能存在漏洞或被植入后门。
3. **编译器和构建过程** 攻击者可能篡改编译配置，引入外部恶意代码

基于代码片段的初步分析，投毒风险较低，但需要更全面的代码审查和依赖项分析才能确定是否存在隐藏的恶意代码，因此给出10%的投毒风险。

**利用方式：**

1.  攻击者构造包含恶意`PidLidReminderFileParameter`或其他相关属性的邮件或日历邀请。
2.  受害者使用受影响版本的Outlook打开该邮件或日历邀请。
3.  Outlook尝试连接恶意UNC路径，并将受害者的NTLM哈希发送到攻击者控制的服务器。
4.  攻击者使用收到的NTLM哈希进行NTLM Relay攻击。

**修复建议：**

*   及时安装Microsoft官方发布的补丁。
*   限制Outlook对外部UNC路径的访问。
*   使用强身份验证方式，例如多因素身份验证，以降低NTLM Relay攻击的风险。

**项目地址:** [moneertv/CVE-2023-23397](https://github.com/moneertv/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #25

**来源**: [CVE-2023-23397-sarsaeroth_CVE-2023-23397-POC.md](../2023/CVE-2023-23397-sarsaeroth_CVE-2023-23397-POC.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括：Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise (详见漏洞库信息)

**利用条件:** 攻击者需要向受害者发送包含恶意属性的邮件或会议邀请。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的电子邮件，在无需用户交互的情况下，强制 Outlook 客户端连接到攻击者控制的 SMB 服务器，从而窃取受害者的 Net-NTLMv2 哈希。该漏洞利用邮件中的 `PidLidReminderFileParameter` 属性，该属性用于指定提醒声音文件的路径。攻击者可以将此路径设置为指向远程 SMB 服务器，当 Outlook 处理邮件时，会自动尝试访问该服务器，触发 NTLM 认证。漏洞利用代码（C implementation of Outlook 0-click vulnerability）的描述表明存在无需用户交互的攻击方式。虽然提供的POC文件只是简单的README.md, 但考虑到该漏洞原理的简单性和公开性，很容易就能实现完整的PoC。该漏洞已被CISA列入已知被利用漏洞目录，并有实际攻击案例。投毒风险评估：该代码仓库只包含一个README.md文件，风险较低。但不能完全排除作者后期添加恶意代码的可能性。该漏洞的利用方式是发送包含恶意属性的邮件，触发 Outlook 连接到攻击者控制的服务器，从而窃取 NTLM hash。

**项目地址:** [sarsaeroth/CVE-2023-23397-POC](https://github.com/sarsaeroth/CVE-2023-23397-POC)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #26

**来源**: [CVE-2023-23397-stevesec_CVE-2023-23397.md](../2023/CVE-2023-23397-stevesec_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致Net-NTLM hash泄露，进而冒充用户身份。

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, Outlook 2016, Office 2019, Office LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本，具体参见CVE描述。

**利用条件:** 攻击者需要向目标用户发送特制的邮件或会议邀请。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397是一个Microsoft Outlook权限提升漏洞。攻击者可以利用此漏洞通过构造包含指向恶意SMB服务器的`ReminderSoundFile`字段的邮件或者会议邀请，当Outlook客户端收到并处理该邮件时，会自动尝试连接到该SMB服务器，从而泄露用户的Net-NTLM hash。该漏洞利用无需用户交互（零点击）。

根据提供的漏洞库信息，该漏洞的CVSS v3.1评分为9.8，属于严重级别，并且已被CISA列入已知被利用漏洞目录。

搜索引擎结果显示，该漏洞已被广泛分析和利用，存在针对该漏洞的检测方法和缓解措施。

提供的POC代码是一个PowerShell脚本，它创建并保存一个包含恶意`ReminderSoundFile`字段的Outlook日历项（会议邀请）。`Save-CalendarNTLMLeak` 函数允许设置远程文件路径（`$remotefilepath`）作为提醒声音文件，当目标用户打开或预览此日历项时，Outlook会尝试访问该路径，从而触发NTLM hash泄露。

**有效性：** 提供的POC代码有效，可以用于触发漏洞，泄露Net-NTLM hash。

**投毒风险：** 提供的POC代码本身不包含明显的恶意代码，主要功能是生成包含漏洞利用载荷的Outlook日历项。因此，投毒风险较低，但不能完全排除作者在其他地方隐藏恶意代码的可能性。 经过分析，确认只有生成日历项功能，没有发现其他恶意代码，因此判定投毒风险为0%。

**利用方式：**
1.  攻击者使用提供的POC代码（或类似工具）生成包含指向攻击者控制的SMB服务器的恶意`ReminderSoundFile`字段的Outlook日历项（.msg文件）。
2.  攻击者将此日历项通过电子邮件发送给目标用户。
3.  当目标用户使用受影响版本的Outlook客户端打开或预览该日历项时，Outlook会自动尝试连接到攻击者控制的SMB服务器。
4.  目标用户的Net-NTLM hash会被发送到攻击者的SMB服务器。
5.  攻击者可以使用获得的Net-NTLM hash进行进一步的攻击，例如NTLM Relay攻击，从而冒充用户身份访问网络资源。

**项目地址:** [stevesec/CVE-2023-23397](https://github.com/stevesec/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #27

**来源**: [CVE-2023-23397-tiepologian_CVE-2023-23397.md](../2023/CVE-2023-23397-tiepologian_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致NTLM Relay攻击和权限提升

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本。

**利用条件:** 攻击者需要向受害者发送特制的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的邮件（例如，会议邀请）触发此漏洞。漏洞原理是 Outlook 在处理邮件时，会尝试访问邮件中指定的 `ReminderSoundFile` 路径，而无需用户交互。如果该路径是 UNC 路径指向攻击者控制的服务器，则 Outlook 会尝试使用用户的 NTLM hash 向该服务器进行身份验证，从而允许攻击者捕获 NTLM hash 并进行 NTLM Relay 攻击，冒充受害者身份。

**有效性分析：**

根据漏洞描述和提供的PoC代码，该漏洞利用方法是有效的。PoC代码通过 `win32com.client` 模块创建 Outlook 的 AppointmentItem 对象，并设置 `ReminderSoundFile` 属性为指向攻击者控制的 UNC 路径。当 Outlook 处理该邮件时，会尝试访问该 UNC 路径，从而泄露 NTLM hash。

**投毒风险分析：**

PoC代码包含两个文件：`Exploit.py` 和 `LICENSE`。 `LICENSE` 文件是 GNU General Public License v3，标准协议许可文件。 `Exploit.py` 脚本的主要功能是生成带有恶意 `ReminderSoundFile` 属性的 Outlook 邮件，并不包含任何可疑的或恶意的代码。所有的操作都围绕利用漏洞展开，脚本本身并无隐藏的后门或者恶意行为。

**利用方式：**

1.  攻击者使用 PoC 脚本 `Exploit.py` 生成恶意的 Outlook 邮件 (.msg 文件)。脚本需要指定目标邮箱地址和攻击者的 IP 地址（或攻击者控制的服务器的 UNC 路径）。
2.  攻击者将生成的邮件发送给受害者。
3.  当受害者使用受影响版本的 Outlook 打开或预览该邮件时，Outlook 会尝试访问邮件中指定的 UNC 路径。
4.  攻击者在其控制的服务器上监听 NTLM 身份验证请求。
5.  一旦 Outlook 尝试进行身份验证，攻击者就可以捕获受害者的 NTLM hash。
6.  攻击者可以使用捕获的 NTLM hash 进行 NTLM Relay 攻击，冒充受害者。

根据搜索结果，此漏洞已被广泛利用，并且 CISA 已将其添加到 Known Exploited Vulnerabilities Catalog 中。

**项目地址:** [tiepologian/CVE-2023-23397](https://github.com/tiepologian/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #28

**来源**: [CVE-2023-23397-vlad-a-man_CVE-2023-23397.md](../2023/CVE-2023-23397-vlad-a-man_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可导致NTLM Relay攻击

**影响版本:** Outlook 2013 SP1, Outlook 2016, Outlook 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise (受影响版本见漏洞库信息)

**利用条件:** 攻击者需要向受害者发送特制的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的邮件，在无需用户交互的情况下，迫使 Outlook 客户端连接到攻击者控制的 SMB 服务器，从而窃取受害者的 NTLM hash。这个漏洞的关键在于，攻击者可以在 Outlook 邮件的属性中指定一个 UNC 路径（例如：\\attacker_server\evil.wav），当 Outlook 处理这封邮件时，会自动尝试访问该 UNC 路径，从而触发 NTLM 认证，将用户的 NTLM hash 发送给攻击者。\n\n**漏洞利用方式：**\n1. 攻击者创建一个恶意的邮件，其中包含指向攻击者控制的服务器的 UNC 路径，这个路径可以放在邮件的各种属性中，如 ReminderFile Name。\n2. 受害者打开或预览该邮件。\n3. Outlook 客户端尝试连接到指定的 UNC 路径。\n4. 客户端向攻击者控制的服务器发送 NTLM 认证信息。\n5. 攻击者获取用户的 NTLM hash，可以用于 NTLM relay 攻击或者破解密码。\n\n**投毒风险分析：**\n提供的漏洞利用代码仅包含GNU通用公共许可证文本。没有看到任何明确的投毒代码或恶意行为。代码本身是许可证文件，这意味着此仓库可能是漏洞利用工具的一部分，但单独的许可证文件无法判断是否存在投毒行为。但也不能完全排除投毒的可能性，需要查看完整的POC代码才能确定是否存在后门,因此判断投毒风险为10%。 考虑到漏洞影响比较大，恶意攻击者可能会利用公开的POC进行改造后传播，从而构成一个风险。

**项目地址:** [vlad-a-man/CVE-2023-23397](https://github.com/vlad-a-man/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---



---

## POC #16

**来源**: [CVE-2023-23397-api0cradle_CVE-2023-23397-POC-Powershell.md](../2023/CVE-2023-23397-api0cradle_CVE-2023-23397-POC-Powershell.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致NTLM Relay攻击，允许攻击者模拟受害者身份

**影响版本:** 受影响版本包括：Microsoft Office LTSC 2021, Microsoft Outlook 2016, Microsoft 365 Apps for Enterprise, Microsoft Office 2019, Microsoft Outlook 2013 Service Pack 1 (具体版本范围见漏洞库信息)

**利用条件:** 攻击者需要向受害者发送包含恶意构造的ReminderSoundFile字段的日历邀请或邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞，该漏洞允许攻击者通过发送特制的电子邮件来窃取受害者的 NTLM hash。攻击者无需与邮件进行任何交互（无需打开、点击等）即可触发漏洞。攻击者通过在Outlook日历邀请的`ReminderSoundFile`字段中指定一个指向远程SMB服务器的UNC路径，当Outlook处理该日历邀请时，会尝试访问该UNC路径，从而触发NTLM认证。攻击者可以捕获到NTLM hash并利用它进行 NTLM relay 攻击。从提供的漏洞利用代码来看，该脚本使用了 PowerShell 和 Outlook COM 对象来创建和发送带有恶意 `ReminderSoundFile` 属性的日历邀请。  该POC代码中不存在明显的投毒代码,它只是利用了该漏洞的特性，创建恶意的日历项目。 搜索引擎结果也印证了该漏洞的利用方式是发送包含恶意构造的日历邀请或邮件。 Microsoft的官方指南提供了检测和修复该漏洞的步骤，CISA也将其列入已知被利用的漏洞目录中，表明该漏洞已被广泛利用。

**项目地址:** [api0cradle/CVE-2023-23397-POC-Powershell](https://github.com/api0cradle/CVE-2023-23397-POC-Powershell)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #17

**来源**: [CVE-2023-23397-cleverg0d_CVE-2023-23397-PoC-PowerShell.md](../2023/CVE-2023-23397-cleverg0d_CVE-2023-23397-PoC-PowerShell.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击并获取用户凭据

**影响版本:** 受影响版本包括Microsoft Outlook 2013 Service Pack 1, Outlook 2016, Office 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise，具体版本号参考漏洞库信息。

**利用条件:** 攻击者需要能够向受害者发送电子邮件，并且受害者使用存在漏洞的Outlook版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的日历邀请或任务，其中包含指向攻击者控制的SMB服务器的UNC路径，来触发此漏洞。当Outlook处理此邀请或任务时，它将尝试连接到UNC路径，从而将受害者的NTLM哈希发送到攻击者的服务器。攻击者可以使用此哈希进行NTLM Relay攻击，或尝试破解哈希以获取用户的凭据。

**利用方式：**

1.  攻击者创建一个恶意的日历邀请或任务，在`ReminderSoundFile`字段中包含指向攻击者控制的SMB服务器的UNC路径（例如`\\attacker.com\evil.wav`）。
2.  攻击者将此日历邀请或任务发送给受害者。
3.  受害者使用易受攻击的Outlook版本打开日历邀请或任务。
4.  Outlook尝试播放提醒声音文件，因此会向攻击者的SMB服务器发送NTLM身份验证请求。
5.  攻击者捕获NTLM哈希并进行NTLM Relay攻击或尝试破解。

**有效性：**

提供的PowerShell PoC代码有效。它通过 `Send-CalendarNTLMLeak` 和 `Save-CalendarNTLMLeak` 函数创建包含恶意`ReminderSoundFile`属性的Outlook日历项目，从而触发漏洞。代码支持通过邮件发送日历或保存日历。

**投毒风险：**

PoC代码本身的功能是利用漏洞，但潜在的投毒风险在于：

*   **参数篡改：** 攻击者可能修改`remotefilepath`参数，使其指向其他恶意资源，例如包含恶意软件的SMB共享。
*   **代码执行：** 虽然PoC本身只是创建Outlook日历项目，但如果攻击者能够进一步利用NTLM Relay等方法，可能最终导致在目标系统上执行任意代码。

考虑到PoC的目的是演示漏洞，并且主要功能是利用Outlook的特性来触发NTLM认证，直接的投毒代码可能性较低。不过，由于PoC本身需要运行PowerShell，并且涉及到网络连接，存在一定的风险。如果用户不小心执行了被篡改过的PoC脚本，可能会带来安全风险。因此，评估投毒风险为10%。风险主要来自于使用者对PoC脚本的来源和内容缺乏验证，导致被恶意篡改的脚本利用。

**项目地址:** [cleverg0d/CVE-2023-23397-PoC-PowerShell](https://github.com/cleverg0d/CVE-2023-23397-PoC-PowerShell)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #18

**来源**: [CVE-2023-23397-djackreuter_CVE-2023-23397-PoC.md](../2023/CVE-2023-23397-djackreuter_CVE-2023-23397-PoC.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者提升权限并可能获取敏感信息

**影响版本:** 受影响版本包括 Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise。

**利用条件:** 攻击者需要能够发送包含特制属性的电子邮件给目标用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是 Microsoft Outlook 中的一个权限提升漏洞。攻击者可以通过发送包含特制 `PidLidReminderFileParameter` 属性的电子邮件，使得 Outlook 在无需用户交互的情况下尝试连接到攻击者控制的 UNC 路径。这导致攻击者可以捕获受害者的 NTLM 哈希。 

**有效性：** 根据搜索结果和漏洞库信息，此漏洞已被广泛利用，且存在公开可用的PoC代码，因此漏洞利用有效性高。

**投毒风险：** 提供的代码主要是一个 Visual Studio 解决方案文件和一个 Apache 2.0 许可文件，以及一个项目文件。虽然许可文件本身不构成风险，但代码中可能存在隐藏的恶意代码。然而，鉴于其整体结构和提供的上下文，直接投毒的可能性相对较低，但也并非完全排除。 因此，推测存在10%的投毒风险，因为下载的解决方案文件可能会包含恶意编译指令或者恶意依赖。

**利用方式：**

1.  **构造恶意邮件：** 攻击者创建一个包含特制`PidLidReminderFileParameter`属性的电子邮件。
2.  **发送邮件：** 攻击者将恶意邮件发送给目标用户。
3.  **触发连接：** 当Outlook处理该邮件时，会自动尝试连接到邮件中指定的UNC路径（攻击者控制的服务器）。
4.  **捕获哈希：** 攻击者利用中间人攻击或其它方式，捕获Outlook连接尝试中泄漏的受害者NTLM哈希。
5.  **权限提升：** 攻击者可以使用捕获的哈希进行NTLM中继攻击或其他攻击，以提升权限。

**项目地址:** [djackreuter/CVE-2023-23397-PoC](https://github.com/djackreuter/CVE-2023-23397-PoC)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #19

**来源**: [CVE-2023-23397-grn-bogo_CVE-2023-23397.md](../2023/CVE-2023-23397-grn-bogo_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击，窃取用户凭据

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, 和 Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要向受害者发送包含恶意属性的电子邮件、日历邀请或任务请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397是一个存在于Microsoft Outlook中的权限提升漏洞。攻击者可以通过发送特制的电子邮件，日历邀请或任务请求利用此漏洞。漏洞原理是Outlook在处理这些消息时，会错误地使用UNC路径作为`reminder_sound_file`属性的值，如果UNC路径指向攻击者控制的服务器，Outlook客户端将尝试通过NTLM身份验证连接到该服务器，从而泄漏用户的NTLM哈希。攻击者可以利用窃取的NTLM哈希进行NTLM中继攻击，冒充受害者。

根据提供的漏洞利用代码，该脚本会创建一个恶意的Outlook消息（.msg文件），该消息设置了`reminder_sound_file`属性为指向攻击者控制的SMB服务器的UNC路径（`\\10.21.22.3\testfile`）。当受害者打开此消息时，Outlook客户端会尝试访问该UNC路径，从而触发NTLM身份验证并泄露NTLM哈希。

**漏洞利用有效性：**
提供的POC代码有效，它展示了如何创建包含恶意`reminder_sound_file`属性的消息，从而触发NTLM哈希泄漏。

**投毒风险：**
此代码段本身没有明显的投毒行为。它只是一个PoC，用于演示漏洞利用过程。作者隐藏恶意代码的可能性较低。分析结果表明投毒风险为0%。

**利用方式：**
1.  攻击者构造包含恶意`reminder_sound_file`属性的Outlook消息（.msg文件）。
2.  攻击者将此消息发送给受害者。
3.  受害者使用Outlook打开该消息。
4.  Outlook客户端尝试访问`reminder_sound_file`指定的UNC路径。
5.  受害者的NTLM哈希通过SMB协议发送到攻击者控制的服务器。
6.  攻击者使用窃取的NTLM哈希进行NTLM中继攻击，冒充受害者。

**项目地址:** [grn-bogo/CVE-2023-23397](https://github.com/grn-bogo/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #20

**来源**: [CVE-2023-23397-im007_CVE-2023-23397.md](../2023/CVE-2023-23397-im007_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致权限提升和NTLM Relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本。

**利用条件:** 攻击者需要向受害者发送特制的邮件，无需用户交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以构造包含恶意 `PidLidReminderFileParameter` 属性的邮件，当 Outlook 处理此邮件时，会自动尝试连接到攻击者控制的 UNC 路径（例如：`\\attacker.com\share\file.wav`）。

由于 Outlook 在连接 UNC 路径时会使用当前用户的 NTLM 凭据进行身份验证，攻击者可以捕获 NTLM 哈希并利用它进行 NTLM Relay 攻击。

**有效性：**
根据漏洞库信息，CISA 已经将该漏洞添加到已知被利用漏洞目录中，搜索引擎结果中也包含了利用分析报告，表明该漏洞的利用是有效的。

**投毒风险：**
提供的漏洞利用代码仅包含 GNU General Public License 的文本，没有发现任何可疑的、与漏洞利用相关的后门代码。因此，投毒风险较低。

**利用方式：**
1.  攻击者构造包含恶意 `PidLidReminderFileParameter` 属性的邮件。
2.  受害者接收并使用受影响的 Outlook 版本打开邮件。
3.  Outlook 尝试连接到攻击者控制的 UNC 路径。
4.  Outlook 在连接时发送受害者的 NTLM 哈希。
5.  攻击者捕获 NTLM 哈希并进行 NTLM Relay 攻击，冒充受害者。

攻击无需用户交互，只需要受害者打开包含恶意属性的邮件。该漏洞的严重性在于其隐蔽性和潜在的 NTLM Relay 攻击。

**项目地址:** [im007/CVE-2023-23397](https://github.com/im007/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #21

**来源**: [CVE-2023-23397-j0eyv_CVE-2023-23397.md](../2023/CVE-2023-23397-j0eyv_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致NTLM Relay攻击，控制受害者账号

**影响版本:** 受影响版本：Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise (具体版本参考漏洞库信息)

**利用条件:** 攻击者需要向受害者发送包含恶意属性的邮件。受害者无需打开邮件，只需预览或接收即可触发漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞，攻击者可以利用该漏洞通过发送特制的电子邮件窃取受害者的 Net-NTLM 哈希值，从而发起 NTLM Relay 攻击。攻击者在邮件中设置一个指向攻击者控制的SMB服务器的`PidLidReminderFileParameter`属性。当Outlook处理该邮件时，会尝试连接该SMB服务器进行身份验证，从而将受害者的 Net-NTLM 哈希值发送给攻击者。此漏洞利用无需用户交互，只需预览或接收邮件即可触发，风险极高。

提供的两个 PowerShell 脚本 (`Detect-M365-Update.ps1` 和 `Remediate-M365-Update.ps1`) 并非直接的漏洞利用代码，而是用于检测和修复漏洞的脚本。 `Detect-M365-Update.ps1` 脚本用于检查 Outlook 是否已安装受影响的版本，而 `Remediate-M365-Update.ps1` 脚本尝试更新 Outlook 以修复漏洞。因此，提供的脚本本身不是漏洞利用，而是补丁检测/修复工具。 

投毒风险评估：虽然脚本本身是用于检测和修复漏洞，但脚本修改了注册表以及执行了更新操作。 如果脚本被篡改，可能存在投毒风险，例如，将更新服务器指向恶意地址，从而安装恶意软件。考虑到这种可能性，投毒风险评估为10%。脚本本身不包含明显的恶意代码，但是任何脚本都可能被篡改，所以存在风险。

**项目地址:** [j0eyv/CVE-2023-23397](https://github.com/j0eyv/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #22

**来源**: [CVE-2023-23397-jacquesquail_CVE-2023-23397.md](../2023/CVE-2023-23397-jacquesquail_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021

**利用条件:** 攻击者需要向受害者发送包含特制日历邀请的电子邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送包含特制日历邀请的电子邮件来利用此漏洞。漏洞利用的关键在于 `ReminderSoundFile` 字段，攻击者可以设置一个指向恶意 SMB 服务器的 UNC 路径。当 Outlook 处理这个日历邀请时，会尝试访问这个 UNC 路径，导致受害者的 Net-NTLM 哈希被发送到攻击者的服务器。这个哈希可以被用于 NTLM Relay 攻击，使攻击者能够冒充受害者。

根据提供的漏洞利用代码，POC.ps1 文件创建了一个 Outlook 日历邀请，并设置了 `ReminderSoundFile` 属性为一个 UNC 路径。攻击者需要修改第 11 行和第 12 行，分别设置攻击者控制的 UNC 路径和目标电子邮件地址。 README.md 文件提供了简单的使用说明。

有效性：提供的 POC 代码有效，可以触发漏洞，导致受害者的 Net-NTLM 哈希被发送到攻击者控制的服务器。

投毒风险：分析 POC 代码内容，并未发现作者隐藏的投毒代码。该仓库中的代码主要用于验证漏洞和安全测试，没有发现任何恶意行为。因此投毒风险为 0%。

利用方式：
1.  攻击者创建一个恶意的日历邀请，其中 `ReminderSoundFile` 属性设置为指向攻击者控制的 SMB 服务器的 UNC 路径。
2.  攻击者将此日历邀请发送给受害者。
3.  当受害者使用 Outlook 打开并处理此日历邀请时，Outlook 会尝试访问 `ReminderSoundFile` 中指定的 UNC 路径。
4.  此操作会触发 SMB 身份验证，导致受害者的 Net-NTLM 哈希被发送到攻击者控制的 SMB 服务器。
5.  攻击者可以使用获得的 Net-NTLM 哈希进行 NTLM Relay 攻击，冒充受害者访问网络资源。

**项目地址:** [jacquesquail/CVE-2023-23397](https://github.com/jacquesquail/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #23

**来源**: [CVE-2023-23397-ka7ana_CVE-2023-23397.md](../2023/CVE-2023-23397-ka7ana_CVE-2023-23397.md)

## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致身份冒用和NTLM relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021 和 Microsoft 365 Apps for Enterprise的特定版本。

**利用条件:** 攻击者需要向受害者发送包含特制ReminderSoundFile属性的电子邮件或会议邀请。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是 Microsoft Outlook 中的一个权限提升漏洞。该漏洞源于 Outlook 在处理提醒声音文件路径时存在缺陷。攻击者可以通过创建一个包含指向恶意 UNC 路径的 ReminderSoundFile 属性的电子邮件或会议邀请来利用此漏洞。当 Outlook 客户端尝试加载该声音文件时，会向攻击者的 SMB 服务器发送用户的 Net-NTLMv2 哈希，攻击者可以利用该哈希进行 NTLM relay 攻击，从而冒充受害者。

**有效性：** 提供的 PowerShell POC 代码利用了 Outlook 的 ReminderSoundFile 属性来触发漏洞。该代码创建一个带有特定设置的会议邀请，并将 ReminderSoundFile 设置为指向攻击者控制的 UNC 路径。当受害者的 Outlook 客户端处理此会议邀请时，会尝试访问该 UNC 路径，从而暴露 Net-NTLMv2 哈希。

**投毒风险：** 提供的 POC 代码本身不包含任何明显的恶意代码或后门。它只是一个简单的漏洞演示脚本，用于验证漏洞的存在。README.md 文件也只是解释了漏洞原理和POC代码的使用方法。因此，投毒风险为0%。

**利用方式：**

1.  攻击者创建一个恶意的电子邮件或会议邀请，其中包含特制的 ReminderSoundFile 属性，指向攻击者控制的 UNC 路径（例如：\\attacker.com\share\sound.wav）。
2.  攻击者将该电子邮件或会议邀请发送给受害者。
3.  当受害者的 Outlook 客户端收到并处理该邮件时，会尝试访问 ReminderSoundFile 中指定的 UNC 路径。
4.  Outlook 客户端会向攻击者的 SMB 服务器发送用户的 Net-NTLMv2 哈希。
5.  攻击者截获该哈希并使用它进行 NTLM relay 攻击，从而冒充受害者访问网络资源或执行其他恶意操作。

根据搜索引擎结果，此漏洞已被积极利用，CISA 已将其添加到已知被利用的漏洞目录中。因此，及时修补 Outlook 至关重要。

**项目地址:** [ka7ana/CVE-2023-23397](https://github.com/ka7ana/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #24

**来源**: [CVE-2023-23397-moneertv_CVE-2023-23397.md](../2023/CVE-2023-23397-moneertv_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise等，具体版本范围参考漏洞库信息。

**利用条件:** 攻击者需要向受害者发送包含恶意构造属性的邮件或日历邀请。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397是一个Microsoft Outlook权限提升漏洞，攻击者可以利用此漏洞发动NTLM Relay攻击。漏洞原理是Outlook在处理邮件或日历邀请时，会读取某些属性（如PidLidReminderFileParameter）中指定的UNC路径，并尝试进行NTLM身份验证。攻击者可以将此路径设置为指向攻击者控制的服务器，当Outlook尝试连接该服务器时，会将用户的NTLM哈希发送给攻击者。攻击者可以使用此哈希进行NTLM Relay攻击，冒充受害者访问网络资源。

**有效性：** 根据漏洞库信息，该漏洞已被积极利用，POC代码的存在进一步证实了其有效性。

**投毒风险：** 提供的代码片段`/tmp/a829982ba7bdb2d91914433ccf5b5a1f/Appointment.cs`是创建Outlook Appointment的C#代码，来自MsgKit库，用于创建.msg文件。粗略判断，此文件中直接包含明显恶意代码（如反弹shell，恶意下载执行等）的可能性较低。但仍存在一定的投毒风险，例如：

1.  **微妙的属性设置：** 攻击者可能在代码中添加不易察觉的属性设置，例如在`NamedProperties.AddProperty`中插入指向恶意服务器的UNC路径，从而触发漏洞，或者添加其他隐蔽的属性修改，利用其他未知的Outlook特性进行攻击。
2.  **依赖项风险：** 该代码依赖于MsgKit库和OpenMcdf库。这些依赖库本身可能存在漏洞或被植入后门。
3. **编译器和构建过程** 攻击者可能篡改编译配置，引入外部恶意代码

基于代码片段的初步分析，投毒风险较低，但需要更全面的代码审查和依赖项分析才能确定是否存在隐藏的恶意代码，因此给出10%的投毒风险。

**利用方式：**

1.  攻击者构造包含恶意`PidLidReminderFileParameter`或其他相关属性的邮件或日历邀请。
2.  受害者使用受影响版本的Outlook打开该邮件或日历邀请。
3.  Outlook尝试连接恶意UNC路径，并将受害者的NTLM哈希发送到攻击者控制的服务器。
4.  攻击者使用收到的NTLM哈希进行NTLM Relay攻击。

**修复建议：**

*   及时安装Microsoft官方发布的补丁。
*   限制Outlook对外部UNC路径的访问。
*   使用强身份验证方式，例如多因素身份验证，以降低NTLM Relay攻击的风险。

**项目地址:** [moneertv/CVE-2023-23397](https://github.com/moneertv/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #25

**来源**: [CVE-2023-23397-sarsaeroth_CVE-2023-23397-POC.md](../2023/CVE-2023-23397-sarsaeroth_CVE-2023-23397-POC.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括：Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise (详见漏洞库信息)

**利用条件:** 攻击者需要向受害者发送包含恶意属性的邮件或会议邀请。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的电子邮件，在无需用户交互的情况下，强制 Outlook 客户端连接到攻击者控制的 SMB 服务器，从而窃取受害者的 Net-NTLMv2 哈希。该漏洞利用邮件中的 `PidLidReminderFileParameter` 属性，该属性用于指定提醒声音文件的路径。攻击者可以将此路径设置为指向远程 SMB 服务器，当 Outlook 处理邮件时，会自动尝试访问该服务器，触发 NTLM 认证。漏洞利用代码（C implementation of Outlook 0-click vulnerability）的描述表明存在无需用户交互的攻击方式。虽然提供的POC文件只是简单的README.md, 但考虑到该漏洞原理的简单性和公开性，很容易就能实现完整的PoC。该漏洞已被CISA列入已知被利用漏洞目录，并有实际攻击案例。投毒风险评估：该代码仓库只包含一个README.md文件，风险较低。但不能完全排除作者后期添加恶意代码的可能性。该漏洞的利用方式是发送包含恶意属性的邮件，触发 Outlook 连接到攻击者控制的服务器，从而窃取 NTLM hash。

**项目地址:** [sarsaeroth/CVE-2023-23397-POC](https://github.com/sarsaeroth/CVE-2023-23397-POC)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #26

**来源**: [CVE-2023-23397-stevesec_CVE-2023-23397.md](../2023/CVE-2023-23397-stevesec_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致Net-NTLM hash泄露，进而冒充用户身份。

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, Outlook 2016, Office 2019, Office LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本，具体参见CVE描述。

**利用条件:** 攻击者需要向目标用户发送特制的邮件或会议邀请。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397是一个Microsoft Outlook权限提升漏洞。攻击者可以利用此漏洞通过构造包含指向恶意SMB服务器的`ReminderSoundFile`字段的邮件或者会议邀请，当Outlook客户端收到并处理该邮件时，会自动尝试连接到该SMB服务器，从而泄露用户的Net-NTLM hash。该漏洞利用无需用户交互（零点击）。

根据提供的漏洞库信息，该漏洞的CVSS v3.1评分为9.8，属于严重级别，并且已被CISA列入已知被利用漏洞目录。

搜索引擎结果显示，该漏洞已被广泛分析和利用，存在针对该漏洞的检测方法和缓解措施。

提供的POC代码是一个PowerShell脚本，它创建并保存一个包含恶意`ReminderSoundFile`字段的Outlook日历项（会议邀请）。`Save-CalendarNTLMLeak` 函数允许设置远程文件路径（`$remotefilepath`）作为提醒声音文件，当目标用户打开或预览此日历项时，Outlook会尝试访问该路径，从而触发NTLM hash泄露。

**有效性：** 提供的POC代码有效，可以用于触发漏洞，泄露Net-NTLM hash。

**投毒风险：** 提供的POC代码本身不包含明显的恶意代码，主要功能是生成包含漏洞利用载荷的Outlook日历项。因此，投毒风险较低，但不能完全排除作者在其他地方隐藏恶意代码的可能性。 经过分析，确认只有生成日历项功能，没有发现其他恶意代码，因此判定投毒风险为0%。

**利用方式：**
1.  攻击者使用提供的POC代码（或类似工具）生成包含指向攻击者控制的SMB服务器的恶意`ReminderSoundFile`字段的Outlook日历项（.msg文件）。
2.  攻击者将此日历项通过电子邮件发送给目标用户。
3.  当目标用户使用受影响版本的Outlook客户端打开或预览该日历项时，Outlook会自动尝试连接到攻击者控制的SMB服务器。
4.  目标用户的Net-NTLM hash会被发送到攻击者的SMB服务器。
5.  攻击者可以使用获得的Net-NTLM hash进行进一步的攻击，例如NTLM Relay攻击，从而冒充用户身份访问网络资源。

**项目地址:** [stevesec/CVE-2023-23397](https://github.com/stevesec/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #27

**来源**: [CVE-2023-23397-tiepologian_CVE-2023-23397.md](../2023/CVE-2023-23397-tiepologian_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致NTLM Relay攻击和权限提升

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本。

**利用条件:** 攻击者需要向受害者发送特制的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的邮件（例如，会议邀请）触发此漏洞。漏洞原理是 Outlook 在处理邮件时，会尝试访问邮件中指定的 `ReminderSoundFile` 路径，而无需用户交互。如果该路径是 UNC 路径指向攻击者控制的服务器，则 Outlook 会尝试使用用户的 NTLM hash 向该服务器进行身份验证，从而允许攻击者捕获 NTLM hash 并进行 NTLM Relay 攻击，冒充受害者身份。

**有效性分析：**

根据漏洞描述和提供的PoC代码，该漏洞利用方法是有效的。PoC代码通过 `win32com.client` 模块创建 Outlook 的 AppointmentItem 对象，并设置 `ReminderSoundFile` 属性为指向攻击者控制的 UNC 路径。当 Outlook 处理该邮件时，会尝试访问该 UNC 路径，从而泄露 NTLM hash。

**投毒风险分析：**

PoC代码包含两个文件：`Exploit.py` 和 `LICENSE`。 `LICENSE` 文件是 GNU General Public License v3，标准协议许可文件。 `Exploit.py` 脚本的主要功能是生成带有恶意 `ReminderSoundFile` 属性的 Outlook 邮件，并不包含任何可疑的或恶意的代码。所有的操作都围绕利用漏洞展开，脚本本身并无隐藏的后门或者恶意行为。

**利用方式：**

1.  攻击者使用 PoC 脚本 `Exploit.py` 生成恶意的 Outlook 邮件 (.msg 文件)。脚本需要指定目标邮箱地址和攻击者的 IP 地址（或攻击者控制的服务器的 UNC 路径）。
2.  攻击者将生成的邮件发送给受害者。
3.  当受害者使用受影响版本的 Outlook 打开或预览该邮件时，Outlook 会尝试访问邮件中指定的 UNC 路径。
4.  攻击者在其控制的服务器上监听 NTLM 身份验证请求。
5.  一旦 Outlook 尝试进行身份验证，攻击者就可以捕获受害者的 NTLM hash。
6.  攻击者可以使用捕获的 NTLM hash 进行 NTLM Relay 攻击，冒充受害者。

根据搜索结果，此漏洞已被广泛利用，并且 CISA 已将其添加到 Known Exploited Vulnerabilities Catalog 中。

**项目地址:** [tiepologian/CVE-2023-23397](https://github.com/tiepologian/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

## POC #28

**来源**: [CVE-2023-23397-vlad-a-man_CVE-2023-23397.md](../2023/CVE-2023-23397-vlad-a-man_CVE-2023-23397.md)

## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可导致NTLM Relay攻击

**影响版本:** Outlook 2013 SP1, Outlook 2016, Outlook 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise (受影响版本见漏洞库信息)

**利用条件:** 攻击者需要向受害者发送特制的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的邮件，在无需用户交互的情况下，迫使 Outlook 客户端连接到攻击者控制的 SMB 服务器，从而窃取受害者的 NTLM hash。这个漏洞的关键在于，攻击者可以在 Outlook 邮件的属性中指定一个 UNC 路径（例如：\\attacker_server\evil.wav），当 Outlook 处理这封邮件时，会自动尝试访问该 UNC 路径，从而触发 NTLM 认证，将用户的 NTLM hash 发送给攻击者。\n\n**漏洞利用方式：**\n1. 攻击者创建一个恶意的邮件，其中包含指向攻击者控制的服务器的 UNC 路径，这个路径可以放在邮件的各种属性中，如 ReminderFile Name。\n2. 受害者打开或预览该邮件。\n3. Outlook 客户端尝试连接到指定的 UNC 路径。\n4. 客户端向攻击者控制的服务器发送 NTLM 认证信息。\n5. 攻击者获取用户的 NTLM hash，可以用于 NTLM relay 攻击或者破解密码。\n\n**投毒风险分析：**\n提供的漏洞利用代码仅包含GNU通用公共许可证文本。没有看到任何明确的投毒代码或恶意行为。代码本身是许可证文件，这意味着此仓库可能是漏洞利用工具的一部分，但单独的许可证文件无法判断是否存在投毒行为。但也不能完全排除投毒的可能性，需要查看完整的POC代码才能确定是否存在后门,因此判断投毒风险为10%。 考虑到漏洞影响比较大，恶意攻击者可能会利用公开的POC进行改造后传播，从而构成一个风险。

**项目地址:** [vlad-a-man/CVE-2023-23397](https://github.com/vlad-a-man/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)

---

