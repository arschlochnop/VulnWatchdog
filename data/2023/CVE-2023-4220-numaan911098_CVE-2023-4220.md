## CVE-2023-4220 - Chamilo LMS RCE (远程代码执行)

**漏洞编号:** CVE-2023-4220

**漏洞类型:** RCE (远程代码执行)

**影响应用:** Chamilo LMS

**危害等级:** High

**CVSS评分:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8)

**影响版本:** <= 1.11.24

**利用条件:** 无需认证，可通过网络直接访问受影响的PHP脚本接口

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

【POC有效性分析】该漏洞存在于Chamilo LMS的bigupload组件中，由于对/main/inc/lib/javascript/bigupload/inc/bigUpload.php接口的文件上传过滤不严，攻击者可以在未经身份验证的情况下上传任意文件。提供的POC代码展示了一个典型的文件上传漏洞利用链：首先，通过发送一个POST请求到接口并带上‘action=post-unsupported’参数，绕过常规逻辑将恶意PHP文件上传至服务器；随后，POC尝试访问该文件在服务器上的默认存放路径（/main/inc/lib/javascript/bigupload/files/）。分析发现，该POC使用了Python的requests库，逻辑非常简洁且直接针对漏洞点。代码中定义的exploit函数成功实现了从本地读取Reverse-shell.php并将其推送到远程主机的过程。由于该漏洞不需要任何登录凭据，且路径相对固定，此POC在未打补丁的Chamilo LMS 1.11.x版本上具有极高的成功率。攻击者可以借此获得Web服务器权限并执行任意操作系统命令。利用步骤如下：1. 准备一个恶意的PHP WebShell（如本例中的反弹Shell脚本）；2. 通过Python脚本调用bigUpload.php接口进行文件上传；3. 脚本会自动触发该文件，从而在目标服务器与攻击者机器之间建立连接。【投毒风险分析】在安全研究背景下，此POC代码本身表现出低投毒风险。代码使用了标准的Python库（requests, sys），没有包含任何经过混淆（Obfuscation）的内容，也没有连接到未知的第三方服务器或执行非预期的本地系统调用。其核心逻辑完全透明，仅用于验证文件上传和触发。虽然其中包含了一个Reverse-shell.php文件，但该脚本属于典型的安全测试载荷，其内容为标准的PHP system调用，且IP和端口留空供研究员填写，不属于恶意后门。分析代码结构发现，除了正常的HTTP代理配置（用于本地流量监控）外，不存在如eval()动态执行加密字符串或下载执行外部Shell脚本等高风险行为。投毒风险评定为10%，主要风险点在于用户在使用此类公开POC时，需谨慎确认下载源的完整性，并检查是否有人在分发过程中替换了合法的载荷为特定木马。从代码层面看，当前提供的逻辑是安全的、教育性的，旨在帮助防御者复现并验证补丁效果。该漏洞的防御措施应集中在禁用该受影响的bigupload模块或升级至Chamilo LMS最新修复版本。

**项目地址:** [https://starlabs.sg/advisories/23/23-4220/](https://starlabs.sg/advisories/23/23-4220/)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)
