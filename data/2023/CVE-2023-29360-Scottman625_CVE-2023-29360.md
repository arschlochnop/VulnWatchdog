# CVE-2023-29360

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-29360-0xDivyanshu-new_CVE-2023-29360.md](../2023/CVE-2023-29360-0xDivyanshu-new_CVE-2023-29360.md)

## CVE-2023-29360-Microsoft Streaming Service Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-29360

**漏洞类型:** 特权提升

**影响应用:** Microsoft Streaming Service (mskssrv.sys)

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** 受影响的Windows版本见漏洞库信息

**利用条件:** 需要在受影响的Windows系统上运行POC代码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-29360是一个Microsoft Streaming Service（mskssrv.sys）驱动程序中的特权提升漏洞。攻击者可以利用此漏洞提升本地权限。

**有效性:**
从提供的漏洞利用代码和博客链接来看，POC代码是有效的。代码实现了对`mskssrv.sys`驱动程序的利用，通过精心构造的IOCTL请求，实现任意地址读写。

**投毒风险:**
代码分析结果显示投毒风险为0%。

*   代码结构清晰，各个函数的功能明确，例如 `InitializeStream`, `PublishTx`, `ConsumeTx`, `DrainTx`等，没有发现隐藏的恶意逻辑。
*   代码主要通过驱动程序通信实现任意地址读写，利用方式较为直接，没有额外的后门或者恶意行为。
*   代码中包含调试信息输出，例如 `std::cout << "[+] Publishing Tx data" << std::endl;`， 这些调试信息表明代码是用于漏洞研究和利用，而非恶意软件。

**利用方式:**
1.  **连接驱动程序:** 使用`CreateFileW`函数连接到`mskssrv.sys`驱动程序。
2.  **初始化流:**  通过`InitializeStream`和`RegisterStream`等函数初始化数据流。
3.  **任意地址读写:**  通过`PublishTx`, `ConsumeTx` 和 `DrainTx` 等函数，结合精心构造的 `FSFrameInfo` 结构体，实现任意地址读写。
    *   `PublishTx` 函数设置要读写的内存地址。
    *   `ConsumeTx` 和 `DrainTx` 函数触发漏洞，实现读写操作。
    *   `FSMemoryStreamArray.switch_case` 的值为 `0xffffffff00000008`时，允许对映射的页面进行读写操作。
4.  **权限提升:** 利用任意地址读写能力，攻击者可以修改内核数据结构，从而提升当前进程的权限。

**项目地址:** [0xDivyanshu-new/CVE-2023-29360](https://github.com/0xDivyanshu-new/CVE-2023-29360)

**漏洞详情:** [CVE-2023-29360](https://nvd.nist.gov/vuln/detail/CVE-2023-29360)

---

## POC #2

**来源**: [CVE-2023-29360-Nero22k_cve-2023-29360.md](../2023/CVE-2023-29360-Nero22k_cve-2023-29360.md)

## CVE-2023-29360 - Microsoft Streaming Service Elevation of Privilege

**漏洞编号:** CVE-2023-29360

**漏洞类型:** 权限提升

**影响应用:** Microsoft Streaming Service (MSKSSRV.SYS)

**危害等级:** 高危，本地权限提升

**影响版本:** 受影响的Windows版本 (参考漏洞库信息)

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-29360 是 Microsoft Streaming Service 中的一个权限提升漏洞，存在于 `MSKSSRV.SYS` 驱动中。攻击者可以通过构造特定的IOCTL请求，利用驱动中的漏洞，最终提升权限。

**有效性：**

根据提供的POC代码，该漏洞的利用通过发送特定的IOCTL到 `MSKSSRV.SYS` 驱动实现。代码中包含了用于与驱动交互的IOCTL码 (例如 `IOCTL_RegisterStream`, `IOCTL_InitializeStream`)，以及构造的输入缓冲区结构体 (`InputBuffer`)。通过调用 `NtDeviceIoControlFile` 函数将这些IOCTL发送到设备驱动，如果驱动没有正确处理这些请求，可能导致权限提升。

**投毒风险：**

虽然POC代码看起来是合法的漏洞利用，但存在一些潜在的投毒风险，占比10%。主要集中在以下几个方面：

*   **硬编码值：** 代码中存在一些硬编码的常量值，例如 `inbuff.Flags = 0x000000136FE7474D`，这些值可能与特定版本的操作系统或驱动相关。如果这些值不正确，可能导致exploit无法正常工作，或者触发其他未知的行为。
*   **驱动依赖：** 该exploit严重依赖于 `MSKSSRV.SYS` 驱动的存在和特定行为。如果目标系统上不存在该驱动，或者驱动版本不兼容，exploit将无法工作。这使得exploit的适用性受到限制。
*   **事件处理：** 代码中使用了 `CreateEventW` 函数来创建事件对象。虽然看起来是标准的Windows API用法，但如果事件没有被正确处理或者泄露，可能导致资源耗尽或拒绝服务。

**利用方式：**

1.  **查找设备：** 首先，需要找到 `MSKSSRV.SYS` 驱动对应的设备句柄。通常可以通过设备接口名称或符号链接来找到该设备。
2.  **构造IOCTL请求：** 根据漏洞原理，构造特定的IOCTL请求和输入缓冲区。代码中已经定义了 `InputBuffer` 结构体，并设置了相应的字段值。
3.  **发送IOCTL请求：** 调用 `NtDeviceIoControlFile` 函数将IOCTL请求发送到设备驱动。
4.  **利用漏洞：** 如果驱动没有正确处理IOCTL请求，可能导致内存破坏、代码执行或权限提升。

**总结：**

提供的POC代码似乎是针对 CVE-2023-29360 的有效利用，但使用前需要仔细审查，并确保目标系统符合漏洞利用的条件。 代码中存在细微的投毒风险，但整体可利用性较高。需要注意的是，不应将POC验证的后门代码误判为投毒代码。需要仔细区分两者。

**项目地址:** [Nero22k/cve-2023-29360](https://github.com/Nero22k/cve-2023-29360)

**漏洞详情:** [CVE-2023-29360](https://nvd.nist.gov/vuln/detail/CVE-2023-29360)

---

## POC #3

**来源**: [CVE-2023-29360-Scottman625_CVE-2023-29360.md](../2023/CVE-2023-29360-Scottman625_CVE-2023-29360.md)

# CVE-2023-29360

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-29360-0xDivyanshu-new_CVE-2023-29360.md](../2023/CVE-2023-29360-0xDivyanshu-new_CVE-2023-29360.md)

## CVE-2023-29360-Microsoft Streaming Service Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-29360

**漏洞类型:** 特权提升

**影响应用:** Microsoft Streaming Service (mskssrv.sys)

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** 受影响的Windows版本见漏洞库信息

**利用条件:** 需要在受影响的Windows系统上运行POC代码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-29360是一个Microsoft Streaming Service（mskssrv.sys）驱动程序中的特权提升漏洞。攻击者可以利用此漏洞提升本地权限。

**有效性:**
从提供的漏洞利用代码和博客链接来看，POC代码是有效的。代码实现了对`mskssrv.sys`驱动程序的利用，通过精心构造的IOCTL请求，实现任意地址读写。

**投毒风险:**
代码分析结果显示投毒风险为0%。

*   代码结构清晰，各个函数的功能明确，例如 `InitializeStream`, `PublishTx`, `ConsumeTx`, `DrainTx`等，没有发现隐藏的恶意逻辑。
*   代码主要通过驱动程序通信实现任意地址读写，利用方式较为直接，没有额外的后门或者恶意行为。
*   代码中包含调试信息输出，例如 `std::cout << "[+] Publishing Tx data" << std::endl;`， 这些调试信息表明代码是用于漏洞研究和利用，而非恶意软件。

**利用方式:**
1.  **连接驱动程序:** 使用`CreateFileW`函数连接到`mskssrv.sys`驱动程序。
2.  **初始化流:**  通过`InitializeStream`和`RegisterStream`等函数初始化数据流。
3.  **任意地址读写:**  通过`PublishTx`, `ConsumeTx` 和 `DrainTx` 等函数，结合精心构造的 `FSFrameInfo` 结构体，实现任意地址读写。
    *   `PublishTx` 函数设置要读写的内存地址。
    *   `ConsumeTx` 和 `DrainTx` 函数触发漏洞，实现读写操作。
    *   `FSMemoryStreamArray.switch_case` 的值为 `0xffffffff00000008`时，允许对映射的页面进行读写操作。
4.  **权限提升:** 利用任意地址读写能力，攻击者可以修改内核数据结构，从而提升当前进程的权限。

**项目地址:** [0xDivyanshu-new/CVE-2023-29360](https://github.com/0xDivyanshu-new/CVE-2023-29360)

**漏洞详情:** [CVE-2023-29360](https://nvd.nist.gov/vuln/detail/CVE-2023-29360)

---

## POC #2

**来源**: [CVE-2023-29360-Nero22k_cve-2023-29360.md](../2023/CVE-2023-29360-Nero22k_cve-2023-29360.md)

## CVE-2023-29360 - Microsoft Streaming Service Elevation of Privilege

**漏洞编号:** CVE-2023-29360

**漏洞类型:** 权限提升

**影响应用:** Microsoft Streaming Service (MSKSSRV.SYS)

**危害等级:** 高危，本地权限提升

**影响版本:** 受影响的Windows版本 (参考漏洞库信息)

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-29360 是 Microsoft Streaming Service 中的一个权限提升漏洞，存在于 `MSKSSRV.SYS` 驱动中。攻击者可以通过构造特定的IOCTL请求，利用驱动中的漏洞，最终提升权限。

**有效性：**

根据提供的POC代码，该漏洞的利用通过发送特定的IOCTL到 `MSKSSRV.SYS` 驱动实现。代码中包含了用于与驱动交互的IOCTL码 (例如 `IOCTL_RegisterStream`, `IOCTL_InitializeStream`)，以及构造的输入缓冲区结构体 (`InputBuffer`)。通过调用 `NtDeviceIoControlFile` 函数将这些IOCTL发送到设备驱动，如果驱动没有正确处理这些请求，可能导致权限提升。

**投毒风险：**

虽然POC代码看起来是合法的漏洞利用，但存在一些潜在的投毒风险，占比10%。主要集中在以下几个方面：

*   **硬编码值：** 代码中存在一些硬编码的常量值，例如 `inbuff.Flags = 0x000000136FE7474D`，这些值可能与特定版本的操作系统或驱动相关。如果这些值不正确，可能导致exploit无法正常工作，或者触发其他未知的行为。
*   **驱动依赖：** 该exploit严重依赖于 `MSKSSRV.SYS` 驱动的存在和特定行为。如果目标系统上不存在该驱动，或者驱动版本不兼容，exploit将无法工作。这使得exploit的适用性受到限制。
*   **事件处理：** 代码中使用了 `CreateEventW` 函数来创建事件对象。虽然看起来是标准的Windows API用法，但如果事件没有被正确处理或者泄露，可能导致资源耗尽或拒绝服务。

**利用方式：**

1.  **查找设备：** 首先，需要找到 `MSKSSRV.SYS` 驱动对应的设备句柄。通常可以通过设备接口名称或符号链接来找到该设备。
2.  **构造IOCTL请求：** 根据漏洞原理，构造特定的IOCTL请求和输入缓冲区。代码中已经定义了 `InputBuffer` 结构体，并设置了相应的字段值。
3.  **发送IOCTL请求：** 调用 `NtDeviceIoControlFile` 函数将IOCTL请求发送到设备驱动。
4.  **利用漏洞：** 如果驱动没有正确处理IOCTL请求，可能导致内存破坏、代码执行或权限提升。

**总结：**

提供的POC代码似乎是针对 CVE-2023-29360 的有效利用，但使用前需要仔细审查，并确保目标系统符合漏洞利用的条件。 代码中存在细微的投毒风险，但整体可利用性较高。需要注意的是，不应将POC验证的后门代码误判为投毒代码。需要仔细区分两者。

**项目地址:** [Nero22k/cve-2023-29360](https://github.com/Nero22k/cve-2023-29360)

**漏洞详情:** [CVE-2023-29360](https://nvd.nist.gov/vuln/detail/CVE-2023-29360)

---

## POC #3

**来源**: [CVE-2023-29360-Scottman625_CVE-2023-29360.md](../2023/CVE-2023-29360-Scottman625_CVE-2023-29360.md)

# CVE-2023-29360

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-29360-0xDivyanshu-new_CVE-2023-29360.md](../2023/CVE-2023-29360-0xDivyanshu-new_CVE-2023-29360.md)

## CVE-2023-29360-Microsoft Streaming Service Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-29360

**漏洞类型:** 特权提升

**影响应用:** Microsoft Streaming Service (mskssrv.sys)

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** 受影响的Windows版本见漏洞库信息

**利用条件:** 需要在受影响的Windows系统上运行POC代码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-29360是一个Microsoft Streaming Service（mskssrv.sys）驱动程序中的特权提升漏洞。攻击者可以利用此漏洞提升本地权限。

**有效性:**
从提供的漏洞利用代码和博客链接来看，POC代码是有效的。代码实现了对`mskssrv.sys`驱动程序的利用，通过精心构造的IOCTL请求，实现任意地址读写。

**投毒风险:**
代码分析结果显示投毒风险为0%。

*   代码结构清晰，各个函数的功能明确，例如 `InitializeStream`, `PublishTx`, `ConsumeTx`, `DrainTx`等，没有发现隐藏的恶意逻辑。
*   代码主要通过驱动程序通信实现任意地址读写，利用方式较为直接，没有额外的后门或者恶意行为。
*   代码中包含调试信息输出，例如 `std::cout << "[+] Publishing Tx data" << std::endl;`， 这些调试信息表明代码是用于漏洞研究和利用，而非恶意软件。

**利用方式:**
1.  **连接驱动程序:** 使用`CreateFileW`函数连接到`mskssrv.sys`驱动程序。
2.  **初始化流:**  通过`InitializeStream`和`RegisterStream`等函数初始化数据流。
3.  **任意地址读写:**  通过`PublishTx`, `ConsumeTx` 和 `DrainTx` 等函数，结合精心构造的 `FSFrameInfo` 结构体，实现任意地址读写。
    *   `PublishTx` 函数设置要读写的内存地址。
    *   `ConsumeTx` 和 `DrainTx` 函数触发漏洞，实现读写操作。
    *   `FSMemoryStreamArray.switch_case` 的值为 `0xffffffff00000008`时，允许对映射的页面进行读写操作。
4.  **权限提升:** 利用任意地址读写能力，攻击者可以修改内核数据结构，从而提升当前进程的权限。

**项目地址:** [0xDivyanshu-new/CVE-2023-29360](https://github.com/0xDivyanshu-new/CVE-2023-29360)

**漏洞详情:** [CVE-2023-29360](https://nvd.nist.gov/vuln/detail/CVE-2023-29360)

---

## POC #2

**来源**: [CVE-2023-29360-Nero22k_cve-2023-29360.md](../2023/CVE-2023-29360-Nero22k_cve-2023-29360.md)

## CVE-2023-29360 - Microsoft Streaming Service Elevation of Privilege

**漏洞编号:** CVE-2023-29360

**漏洞类型:** 权限提升

**影响应用:** Microsoft Streaming Service (MSKSSRV.SYS)

**危害等级:** 高危，本地权限提升

**影响版本:** 受影响的Windows版本 (参考漏洞库信息)

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-29360 是 Microsoft Streaming Service 中的一个权限提升漏洞，存在于 `MSKSSRV.SYS` 驱动中。攻击者可以通过构造特定的IOCTL请求，利用驱动中的漏洞，最终提升权限。

**有效性：**

根据提供的POC代码，该漏洞的利用通过发送特定的IOCTL到 `MSKSSRV.SYS` 驱动实现。代码中包含了用于与驱动交互的IOCTL码 (例如 `IOCTL_RegisterStream`, `IOCTL_InitializeStream`)，以及构造的输入缓冲区结构体 (`InputBuffer`)。通过调用 `NtDeviceIoControlFile` 函数将这些IOCTL发送到设备驱动，如果驱动没有正确处理这些请求，可能导致权限提升。

**投毒风险：**

虽然POC代码看起来是合法的漏洞利用，但存在一些潜在的投毒风险，占比10%。主要集中在以下几个方面：

*   **硬编码值：** 代码中存在一些硬编码的常量值，例如 `inbuff.Flags = 0x000000136FE7474D`，这些值可能与特定版本的操作系统或驱动相关。如果这些值不正确，可能导致exploit无法正常工作，或者触发其他未知的行为。
*   **驱动依赖：** 该exploit严重依赖于 `MSKSSRV.SYS` 驱动的存在和特定行为。如果目标系统上不存在该驱动，或者驱动版本不兼容，exploit将无法工作。这使得exploit的适用性受到限制。
*   **事件处理：** 代码中使用了 `CreateEventW` 函数来创建事件对象。虽然看起来是标准的Windows API用法，但如果事件没有被正确处理或者泄露，可能导致资源耗尽或拒绝服务。

**利用方式：**

1.  **查找设备：** 首先，需要找到 `MSKSSRV.SYS` 驱动对应的设备句柄。通常可以通过设备接口名称或符号链接来找到该设备。
2.  **构造IOCTL请求：** 根据漏洞原理，构造特定的IOCTL请求和输入缓冲区。代码中已经定义了 `InputBuffer` 结构体，并设置了相应的字段值。
3.  **发送IOCTL请求：** 调用 `NtDeviceIoControlFile` 函数将IOCTL请求发送到设备驱动。
4.  **利用漏洞：** 如果驱动没有正确处理IOCTL请求，可能导致内存破坏、代码执行或权限提升。

**总结：**

提供的POC代码似乎是针对 CVE-2023-29360 的有效利用，但使用前需要仔细审查，并确保目标系统符合漏洞利用的条件。 代码中存在细微的投毒风险，但整体可利用性较高。需要注意的是，不应将POC验证的后门代码误判为投毒代码。需要仔细区分两者。

**项目地址:** [Nero22k/cve-2023-29360](https://github.com/Nero22k/cve-2023-29360)

**漏洞详情:** [CVE-2023-29360](https://nvd.nist.gov/vuln/detail/CVE-2023-29360)

---

## POC #3

**来源**: [CVE-2023-29360-Scottman625_CVE-2023-29360.md](../2023/CVE-2023-29360-Scottman625_CVE-2023-29360.md)

# CVE-2023-29360

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-29360-0xDivyanshu-new_CVE-2023-29360.md](../2023/CVE-2023-29360-0xDivyanshu-new_CVE-2023-29360.md)

## CVE-2023-29360-Microsoft Streaming Service Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-29360

**漏洞类型:** 特权提升

**影响应用:** Microsoft Streaming Service (mskssrv.sys)

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** 受影响的Windows版本见漏洞库信息

**利用条件:** 需要在受影响的Windows系统上运行POC代码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-29360是一个Microsoft Streaming Service（mskssrv.sys）驱动程序中的特权提升漏洞。攻击者可以利用此漏洞提升本地权限。

**有效性:**
从提供的漏洞利用代码和博客链接来看，POC代码是有效的。代码实现了对`mskssrv.sys`驱动程序的利用，通过精心构造的IOCTL请求，实现任意地址读写。

**投毒风险:**
代码分析结果显示投毒风险为0%。

*   代码结构清晰，各个函数的功能明确，例如 `InitializeStream`, `PublishTx`, `ConsumeTx`, `DrainTx`等，没有发现隐藏的恶意逻辑。
*   代码主要通过驱动程序通信实现任意地址读写，利用方式较为直接，没有额外的后门或者恶意行为。
*   代码中包含调试信息输出，例如 `std::cout << "[+] Publishing Tx data" << std::endl;`， 这些调试信息表明代码是用于漏洞研究和利用，而非恶意软件。

**利用方式:**
1.  **连接驱动程序:** 使用`CreateFileW`函数连接到`mskssrv.sys`驱动程序。
2.  **初始化流:**  通过`InitializeStream`和`RegisterStream`等函数初始化数据流。
3.  **任意地址读写:**  通过`PublishTx`, `ConsumeTx` 和 `DrainTx` 等函数，结合精心构造的 `FSFrameInfo` 结构体，实现任意地址读写。
    *   `PublishTx` 函数设置要读写的内存地址。
    *   `ConsumeTx` 和 `DrainTx` 函数触发漏洞，实现读写操作。
    *   `FSMemoryStreamArray.switch_case` 的值为 `0xffffffff00000008`时，允许对映射的页面进行读写操作。
4.  **权限提升:** 利用任意地址读写能力，攻击者可以修改内核数据结构，从而提升当前进程的权限。

**项目地址:** [0xDivyanshu-new/CVE-2023-29360](https://github.com/0xDivyanshu-new/CVE-2023-29360)

**漏洞详情:** [CVE-2023-29360](https://nvd.nist.gov/vuln/detail/CVE-2023-29360)

---

## POC #2

**来源**: [CVE-2023-29360-Nero22k_cve-2023-29360.md](../2023/CVE-2023-29360-Nero22k_cve-2023-29360.md)

## CVE-2023-29360 - Microsoft Streaming Service Elevation of Privilege

**漏洞编号:** CVE-2023-29360

**漏洞类型:** 权限提升

**影响应用:** Microsoft Streaming Service (MSKSSRV.SYS)

**危害等级:** 高危，本地权限提升

**影响版本:** 受影响的Windows版本 (参考漏洞库信息)

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-29360 是 Microsoft Streaming Service 中的一个权限提升漏洞，存在于 `MSKSSRV.SYS` 驱动中。攻击者可以通过构造特定的IOCTL请求，利用驱动中的漏洞，最终提升权限。

**有效性：**

根据提供的POC代码，该漏洞的利用通过发送特定的IOCTL到 `MSKSSRV.SYS` 驱动实现。代码中包含了用于与驱动交互的IOCTL码 (例如 `IOCTL_RegisterStream`, `IOCTL_InitializeStream`)，以及构造的输入缓冲区结构体 (`InputBuffer`)。通过调用 `NtDeviceIoControlFile` 函数将这些IOCTL发送到设备驱动，如果驱动没有正确处理这些请求，可能导致权限提升。

**投毒风险：**

虽然POC代码看起来是合法的漏洞利用，但存在一些潜在的投毒风险，占比10%。主要集中在以下几个方面：

*   **硬编码值：** 代码中存在一些硬编码的常量值，例如 `inbuff.Flags = 0x000000136FE7474D`，这些值可能与特定版本的操作系统或驱动相关。如果这些值不正确，可能导致exploit无法正常工作，或者触发其他未知的行为。
*   **驱动依赖：** 该exploit严重依赖于 `MSKSSRV.SYS` 驱动的存在和特定行为。如果目标系统上不存在该驱动，或者驱动版本不兼容，exploit将无法工作。这使得exploit的适用性受到限制。
*   **事件处理：** 代码中使用了 `CreateEventW` 函数来创建事件对象。虽然看起来是标准的Windows API用法，但如果事件没有被正确处理或者泄露，可能导致资源耗尽或拒绝服务。

**利用方式：**

1.  **查找设备：** 首先，需要找到 `MSKSSRV.SYS` 驱动对应的设备句柄。通常可以通过设备接口名称或符号链接来找到该设备。
2.  **构造IOCTL请求：** 根据漏洞原理，构造特定的IOCTL请求和输入缓冲区。代码中已经定义了 `InputBuffer` 结构体，并设置了相应的字段值。
3.  **发送IOCTL请求：** 调用 `NtDeviceIoControlFile` 函数将IOCTL请求发送到设备驱动。
4.  **利用漏洞：** 如果驱动没有正确处理IOCTL请求，可能导致内存破坏、代码执行或权限提升。

**总结：**

提供的POC代码似乎是针对 CVE-2023-29360 的有效利用，但使用前需要仔细审查，并确保目标系统符合漏洞利用的条件。 代码中存在细微的投毒风险，但整体可利用性较高。需要注意的是，不应将POC验证的后门代码误判为投毒代码。需要仔细区分两者。

**项目地址:** [Nero22k/cve-2023-29360](https://github.com/Nero22k/cve-2023-29360)

**漏洞详情:** [CVE-2023-29360](https://nvd.nist.gov/vuln/detail/CVE-2023-29360)

---

## POC #3

**来源**: [CVE-2023-29360-Scottman625_CVE-2023-29360.md](../2023/CVE-2023-29360-Scottman625_CVE-2023-29360.md)

# CVE-2023-29360

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-29360-0xDivyanshu-new_CVE-2023-29360.md](../2023/CVE-2023-29360-0xDivyanshu-new_CVE-2023-29360.md)

## CVE-2023-29360-Microsoft Streaming Service Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-29360

**漏洞类型:** 特权提升

**影响应用:** Microsoft Streaming Service (mskssrv.sys)

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** 受影响的Windows版本见漏洞库信息

**利用条件:** 需要在受影响的Windows系统上运行POC代码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-29360是一个Microsoft Streaming Service（mskssrv.sys）驱动程序中的特权提升漏洞。攻击者可以利用此漏洞提升本地权限。

**有效性:**
从提供的漏洞利用代码和博客链接来看，POC代码是有效的。代码实现了对`mskssrv.sys`驱动程序的利用，通过精心构造的IOCTL请求，实现任意地址读写。

**投毒风险:**
代码分析结果显示投毒风险为0%。

*   代码结构清晰，各个函数的功能明确，例如 `InitializeStream`, `PublishTx`, `ConsumeTx`, `DrainTx`等，没有发现隐藏的恶意逻辑。
*   代码主要通过驱动程序通信实现任意地址读写，利用方式较为直接，没有额外的后门或者恶意行为。
*   代码中包含调试信息输出，例如 `std::cout << "[+] Publishing Tx data" << std::endl;`， 这些调试信息表明代码是用于漏洞研究和利用，而非恶意软件。

**利用方式:**
1.  **连接驱动程序:** 使用`CreateFileW`函数连接到`mskssrv.sys`驱动程序。
2.  **初始化流:**  通过`InitializeStream`和`RegisterStream`等函数初始化数据流。
3.  **任意地址读写:**  通过`PublishTx`, `ConsumeTx` 和 `DrainTx` 等函数，结合精心构造的 `FSFrameInfo` 结构体，实现任意地址读写。
    *   `PublishTx` 函数设置要读写的内存地址。
    *   `ConsumeTx` 和 `DrainTx` 函数触发漏洞，实现读写操作。
    *   `FSMemoryStreamArray.switch_case` 的值为 `0xffffffff00000008`时，允许对映射的页面进行读写操作。
4.  **权限提升:** 利用任意地址读写能力，攻击者可以修改内核数据结构，从而提升当前进程的权限。

**项目地址:** [0xDivyanshu-new/CVE-2023-29360](https://github.com/0xDivyanshu-new/CVE-2023-29360)

**漏洞详情:** [CVE-2023-29360](https://nvd.nist.gov/vuln/detail/CVE-2023-29360)

---

## POC #2

**来源**: [CVE-2023-29360-Nero22k_cve-2023-29360.md](../2023/CVE-2023-29360-Nero22k_cve-2023-29360.md)

## CVE-2023-29360 - Microsoft Streaming Service Elevation of Privilege

**漏洞编号:** CVE-2023-29360

**漏洞类型:** 权限提升

**影响应用:** Microsoft Streaming Service (MSKSSRV.SYS)

**危害等级:** 高危，本地权限提升

**影响版本:** 受影响的Windows版本 (参考漏洞库信息)

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-29360 是 Microsoft Streaming Service 中的一个权限提升漏洞，存在于 `MSKSSRV.SYS` 驱动中。攻击者可以通过构造特定的IOCTL请求，利用驱动中的漏洞，最终提升权限。

**有效性：**

根据提供的POC代码，该漏洞的利用通过发送特定的IOCTL到 `MSKSSRV.SYS` 驱动实现。代码中包含了用于与驱动交互的IOCTL码 (例如 `IOCTL_RegisterStream`, `IOCTL_InitializeStream`)，以及构造的输入缓冲区结构体 (`InputBuffer`)。通过调用 `NtDeviceIoControlFile` 函数将这些IOCTL发送到设备驱动，如果驱动没有正确处理这些请求，可能导致权限提升。

**投毒风险：**

虽然POC代码看起来是合法的漏洞利用，但存在一些潜在的投毒风险，占比10%。主要集中在以下几个方面：

*   **硬编码值：** 代码中存在一些硬编码的常量值，例如 `inbuff.Flags = 0x000000136FE7474D`，这些值可能与特定版本的操作系统或驱动相关。如果这些值不正确，可能导致exploit无法正常工作，或者触发其他未知的行为。
*   **驱动依赖：** 该exploit严重依赖于 `MSKSSRV.SYS` 驱动的存在和特定行为。如果目标系统上不存在该驱动，或者驱动版本不兼容，exploit将无法工作。这使得exploit的适用性受到限制。
*   **事件处理：** 代码中使用了 `CreateEventW` 函数来创建事件对象。虽然看起来是标准的Windows API用法，但如果事件没有被正确处理或者泄露，可能导致资源耗尽或拒绝服务。

**利用方式：**

1.  **查找设备：** 首先，需要找到 `MSKSSRV.SYS` 驱动对应的设备句柄。通常可以通过设备接口名称或符号链接来找到该设备。
2.  **构造IOCTL请求：** 根据漏洞原理，构造特定的IOCTL请求和输入缓冲区。代码中已经定义了 `InputBuffer` 结构体，并设置了相应的字段值。
3.  **发送IOCTL请求：** 调用 `NtDeviceIoControlFile` 函数将IOCTL请求发送到设备驱动。
4.  **利用漏洞：** 如果驱动没有正确处理IOCTL请求，可能导致内存破坏、代码执行或权限提升。

**总结：**

提供的POC代码似乎是针对 CVE-2023-29360 的有效利用，但使用前需要仔细审查，并确保目标系统符合漏洞利用的条件。 代码中存在细微的投毒风险，但整体可利用性较高。需要注意的是，不应将POC验证的后门代码误判为投毒代码。需要仔细区分两者。

**项目地址:** [Nero22k/cve-2023-29360](https://github.com/Nero22k/cve-2023-29360)

**漏洞详情:** [CVE-2023-29360](https://nvd.nist.gov/vuln/detail/CVE-2023-29360)

---

## POC #3

**来源**: [CVE-2023-29360-Scottman625_CVE-2023-29360.md](../2023/CVE-2023-29360-Scottman625_CVE-2023-29360.md)

# CVE-2023-29360

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-29360-0xDivyanshu-new_CVE-2023-29360.md](../2023/CVE-2023-29360-0xDivyanshu-new_CVE-2023-29360.md)

## CVE-2023-29360-Microsoft Streaming Service Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-29360

**漏洞类型:** 特权提升

**影响应用:** Microsoft Streaming Service (mskssrv.sys)

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** 受影响的Windows版本见漏洞库信息

**利用条件:** 需要在受影响的Windows系统上运行POC代码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-29360是一个Microsoft Streaming Service（mskssrv.sys）驱动程序中的特权提升漏洞。攻击者可以利用此漏洞提升本地权限。

**有效性:**
从提供的漏洞利用代码和博客链接来看，POC代码是有效的。代码实现了对`mskssrv.sys`驱动程序的利用，通过精心构造的IOCTL请求，实现任意地址读写。

**投毒风险:**
代码分析结果显示投毒风险为0%。

*   代码结构清晰，各个函数的功能明确，例如 `InitializeStream`, `PublishTx`, `ConsumeTx`, `DrainTx`等，没有发现隐藏的恶意逻辑。
*   代码主要通过驱动程序通信实现任意地址读写，利用方式较为直接，没有额外的后门或者恶意行为。
*   代码中包含调试信息输出，例如 `std::cout << "[+] Publishing Tx data" << std::endl;`， 这些调试信息表明代码是用于漏洞研究和利用，而非恶意软件。

**利用方式:**
1.  **连接驱动程序:** 使用`CreateFileW`函数连接到`mskssrv.sys`驱动程序。
2.  **初始化流:**  通过`InitializeStream`和`RegisterStream`等函数初始化数据流。
3.  **任意地址读写:**  通过`PublishTx`, `ConsumeTx` 和 `DrainTx` 等函数，结合精心构造的 `FSFrameInfo` 结构体，实现任意地址读写。
    *   `PublishTx` 函数设置要读写的内存地址。
    *   `ConsumeTx` 和 `DrainTx` 函数触发漏洞，实现读写操作。
    *   `FSMemoryStreamArray.switch_case` 的值为 `0xffffffff00000008`时，允许对映射的页面进行读写操作。
4.  **权限提升:** 利用任意地址读写能力，攻击者可以修改内核数据结构，从而提升当前进程的权限。

**项目地址:** [0xDivyanshu-new/CVE-2023-29360](https://github.com/0xDivyanshu-new/CVE-2023-29360)

**漏洞详情:** [CVE-2023-29360](https://nvd.nist.gov/vuln/detail/CVE-2023-29360)

---

## POC #2

**来源**: [CVE-2023-29360-Nero22k_cve-2023-29360.md](../2023/CVE-2023-29360-Nero22k_cve-2023-29360.md)

## CVE-2023-29360 - Microsoft Streaming Service Elevation of Privilege

**漏洞编号:** CVE-2023-29360

**漏洞类型:** 权限提升

**影响应用:** Microsoft Streaming Service (MSKSSRV.SYS)

**危害等级:** 高危，本地权限提升

**影响版本:** 受影响的Windows版本 (参考漏洞库信息)

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-29360 是 Microsoft Streaming Service 中的一个权限提升漏洞，存在于 `MSKSSRV.SYS` 驱动中。攻击者可以通过构造特定的IOCTL请求，利用驱动中的漏洞，最终提升权限。

**有效性：**

根据提供的POC代码，该漏洞的利用通过发送特定的IOCTL到 `MSKSSRV.SYS` 驱动实现。代码中包含了用于与驱动交互的IOCTL码 (例如 `IOCTL_RegisterStream`, `IOCTL_InitializeStream`)，以及构造的输入缓冲区结构体 (`InputBuffer`)。通过调用 `NtDeviceIoControlFile` 函数将这些IOCTL发送到设备驱动，如果驱动没有正确处理这些请求，可能导致权限提升。

**投毒风险：**

虽然POC代码看起来是合法的漏洞利用，但存在一些潜在的投毒风险，占比10%。主要集中在以下几个方面：

*   **硬编码值：** 代码中存在一些硬编码的常量值，例如 `inbuff.Flags = 0x000000136FE7474D`，这些值可能与特定版本的操作系统或驱动相关。如果这些值不正确，可能导致exploit无法正常工作，或者触发其他未知的行为。
*   **驱动依赖：** 该exploit严重依赖于 `MSKSSRV.SYS` 驱动的存在和特定行为。如果目标系统上不存在该驱动，或者驱动版本不兼容，exploit将无法工作。这使得exploit的适用性受到限制。
*   **事件处理：** 代码中使用了 `CreateEventW` 函数来创建事件对象。虽然看起来是标准的Windows API用法，但如果事件没有被正确处理或者泄露，可能导致资源耗尽或拒绝服务。

**利用方式：**

1.  **查找设备：** 首先，需要找到 `MSKSSRV.SYS` 驱动对应的设备句柄。通常可以通过设备接口名称或符号链接来找到该设备。
2.  **构造IOCTL请求：** 根据漏洞原理，构造特定的IOCTL请求和输入缓冲区。代码中已经定义了 `InputBuffer` 结构体，并设置了相应的字段值。
3.  **发送IOCTL请求：** 调用 `NtDeviceIoControlFile` 函数将IOCTL请求发送到设备驱动。
4.  **利用漏洞：** 如果驱动没有正确处理IOCTL请求，可能导致内存破坏、代码执行或权限提升。

**总结：**

提供的POC代码似乎是针对 CVE-2023-29360 的有效利用，但使用前需要仔细审查，并确保目标系统符合漏洞利用的条件。 代码中存在细微的投毒风险，但整体可利用性较高。需要注意的是，不应将POC验证的后门代码误判为投毒代码。需要仔细区分两者。

**项目地址:** [Nero22k/cve-2023-29360](https://github.com/Nero22k/cve-2023-29360)

**漏洞详情:** [CVE-2023-29360](https://nvd.nist.gov/vuln/detail/CVE-2023-29360)

---

## POC #3

**来源**: [CVE-2023-29360-Scottman625_CVE-2023-29360.md](../2023/CVE-2023-29360-Scottman625_CVE-2023-29360.md)

# CVE-2023-29360

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-29360-0xDivyanshu-new_CVE-2023-29360.md](../2023/CVE-2023-29360-0xDivyanshu-new_CVE-2023-29360.md)

## CVE-2023-29360-Microsoft Streaming Service Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-29360

**漏洞类型:** 特权提升

**影响应用:** Microsoft Streaming Service (mskssrv.sys)

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** 受影响的Windows版本见漏洞库信息

**利用条件:** 需要在受影响的Windows系统上运行POC代码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-29360是一个Microsoft Streaming Service（mskssrv.sys）驱动程序中的特权提升漏洞。攻击者可以利用此漏洞提升本地权限。

**有效性:**
从提供的漏洞利用代码和博客链接来看，POC代码是有效的。代码实现了对`mskssrv.sys`驱动程序的利用，通过精心构造的IOCTL请求，实现任意地址读写。

**投毒风险:**
代码分析结果显示投毒风险为0%。

*   代码结构清晰，各个函数的功能明确，例如 `InitializeStream`, `PublishTx`, `ConsumeTx`, `DrainTx`等，没有发现隐藏的恶意逻辑。
*   代码主要通过驱动程序通信实现任意地址读写，利用方式较为直接，没有额外的后门或者恶意行为。
*   代码中包含调试信息输出，例如 `std::cout << "[+] Publishing Tx data" << std::endl;`， 这些调试信息表明代码是用于漏洞研究和利用，而非恶意软件。

**利用方式:**
1.  **连接驱动程序:** 使用`CreateFileW`函数连接到`mskssrv.sys`驱动程序。
2.  **初始化流:**  通过`InitializeStream`和`RegisterStream`等函数初始化数据流。
3.  **任意地址读写:**  通过`PublishTx`, `ConsumeTx` 和 `DrainTx` 等函数，结合精心构造的 `FSFrameInfo` 结构体，实现任意地址读写。
    *   `PublishTx` 函数设置要读写的内存地址。
    *   `ConsumeTx` 和 `DrainTx` 函数触发漏洞，实现读写操作。
    *   `FSMemoryStreamArray.switch_case` 的值为 `0xffffffff00000008`时，允许对映射的页面进行读写操作。
4.  **权限提升:** 利用任意地址读写能力，攻击者可以修改内核数据结构，从而提升当前进程的权限。

**项目地址:** [0xDivyanshu-new/CVE-2023-29360](https://github.com/0xDivyanshu-new/CVE-2023-29360)

**漏洞详情:** [CVE-2023-29360](https://nvd.nist.gov/vuln/detail/CVE-2023-29360)

---

## POC #2

**来源**: [CVE-2023-29360-Nero22k_cve-2023-29360.md](../2023/CVE-2023-29360-Nero22k_cve-2023-29360.md)

## CVE-2023-29360 - Microsoft Streaming Service Elevation of Privilege

**漏洞编号:** CVE-2023-29360

**漏洞类型:** 权限提升

**影响应用:** Microsoft Streaming Service (MSKSSRV.SYS)

**危害等级:** 高危，本地权限提升

**影响版本:** 受影响的Windows版本 (参考漏洞库信息)

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-29360 是 Microsoft Streaming Service 中的一个权限提升漏洞，存在于 `MSKSSRV.SYS` 驱动中。攻击者可以通过构造特定的IOCTL请求，利用驱动中的漏洞，最终提升权限。

**有效性：**

根据提供的POC代码，该漏洞的利用通过发送特定的IOCTL到 `MSKSSRV.SYS` 驱动实现。代码中包含了用于与驱动交互的IOCTL码 (例如 `IOCTL_RegisterStream`, `IOCTL_InitializeStream`)，以及构造的输入缓冲区结构体 (`InputBuffer`)。通过调用 `NtDeviceIoControlFile` 函数将这些IOCTL发送到设备驱动，如果驱动没有正确处理这些请求，可能导致权限提升。

**投毒风险：**

虽然POC代码看起来是合法的漏洞利用，但存在一些潜在的投毒风险，占比10%。主要集中在以下几个方面：

*   **硬编码值：** 代码中存在一些硬编码的常量值，例如 `inbuff.Flags = 0x000000136FE7474D`，这些值可能与特定版本的操作系统或驱动相关。如果这些值不正确，可能导致exploit无法正常工作，或者触发其他未知的行为。
*   **驱动依赖：** 该exploit严重依赖于 `MSKSSRV.SYS` 驱动的存在和特定行为。如果目标系统上不存在该驱动，或者驱动版本不兼容，exploit将无法工作。这使得exploit的适用性受到限制。
*   **事件处理：** 代码中使用了 `CreateEventW` 函数来创建事件对象。虽然看起来是标准的Windows API用法，但如果事件没有被正确处理或者泄露，可能导致资源耗尽或拒绝服务。

**利用方式：**

1.  **查找设备：** 首先，需要找到 `MSKSSRV.SYS` 驱动对应的设备句柄。通常可以通过设备接口名称或符号链接来找到该设备。
2.  **构造IOCTL请求：** 根据漏洞原理，构造特定的IOCTL请求和输入缓冲区。代码中已经定义了 `InputBuffer` 结构体，并设置了相应的字段值。
3.  **发送IOCTL请求：** 调用 `NtDeviceIoControlFile` 函数将IOCTL请求发送到设备驱动。
4.  **利用漏洞：** 如果驱动没有正确处理IOCTL请求，可能导致内存破坏、代码执行或权限提升。

**总结：**

提供的POC代码似乎是针对 CVE-2023-29360 的有效利用，但使用前需要仔细审查，并确保目标系统符合漏洞利用的条件。 代码中存在细微的投毒风险，但整体可利用性较高。需要注意的是，不应将POC验证的后门代码误判为投毒代码。需要仔细区分两者。

**项目地址:** [Nero22k/cve-2023-29360](https://github.com/Nero22k/cve-2023-29360)

**漏洞详情:** [CVE-2023-29360](https://nvd.nist.gov/vuln/detail/CVE-2023-29360)

---

## POC #3

**来源**: [CVE-2023-29360-Scottman625_CVE-2023-29360.md](../2023/CVE-2023-29360-Scottman625_CVE-2023-29360.md)

# CVE-2023-29360

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-29360-0xDivyanshu-new_CVE-2023-29360.md](../2023/CVE-2023-29360-0xDivyanshu-new_CVE-2023-29360.md)

## CVE-2023-29360-Microsoft Streaming Service Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-29360

**漏洞类型:** 特权提升

**影响应用:** Microsoft Streaming Service (mskssrv.sys)

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** 受影响的Windows版本见漏洞库信息

**利用条件:** 需要在受影响的Windows系统上运行POC代码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-29360是一个Microsoft Streaming Service（mskssrv.sys）驱动程序中的特权提升漏洞。攻击者可以利用此漏洞提升本地权限。

**有效性:**
从提供的漏洞利用代码和博客链接来看，POC代码是有效的。代码实现了对`mskssrv.sys`驱动程序的利用，通过精心构造的IOCTL请求，实现任意地址读写。

**投毒风险:**
代码分析结果显示投毒风险为0%。

*   代码结构清晰，各个函数的功能明确，例如 `InitializeStream`, `PublishTx`, `ConsumeTx`, `DrainTx`等，没有发现隐藏的恶意逻辑。
*   代码主要通过驱动程序通信实现任意地址读写，利用方式较为直接，没有额外的后门或者恶意行为。
*   代码中包含调试信息输出，例如 `std::cout << "[+] Publishing Tx data" << std::endl;`， 这些调试信息表明代码是用于漏洞研究和利用，而非恶意软件。

**利用方式:**
1.  **连接驱动程序:** 使用`CreateFileW`函数连接到`mskssrv.sys`驱动程序。
2.  **初始化流:**  通过`InitializeStream`和`RegisterStream`等函数初始化数据流。
3.  **任意地址读写:**  通过`PublishTx`, `ConsumeTx` 和 `DrainTx` 等函数，结合精心构造的 `FSFrameInfo` 结构体，实现任意地址读写。
    *   `PublishTx` 函数设置要读写的内存地址。
    *   `ConsumeTx` 和 `DrainTx` 函数触发漏洞，实现读写操作。
    *   `FSMemoryStreamArray.switch_case` 的值为 `0xffffffff00000008`时，允许对映射的页面进行读写操作。
4.  **权限提升:** 利用任意地址读写能力，攻击者可以修改内核数据结构，从而提升当前进程的权限。

**项目地址:** [0xDivyanshu-new/CVE-2023-29360](https://github.com/0xDivyanshu-new/CVE-2023-29360)

**漏洞详情:** [CVE-2023-29360](https://nvd.nist.gov/vuln/detail/CVE-2023-29360)

---

## POC #2

**来源**: [CVE-2023-29360-Nero22k_cve-2023-29360.md](../2023/CVE-2023-29360-Nero22k_cve-2023-29360.md)

## CVE-2023-29360 - Microsoft Streaming Service Elevation of Privilege

**漏洞编号:** CVE-2023-29360

**漏洞类型:** 权限提升

**影响应用:** Microsoft Streaming Service (MSKSSRV.SYS)

**危害等级:** 高危，本地权限提升

**影响版本:** 受影响的Windows版本 (参考漏洞库信息)

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-29360 是 Microsoft Streaming Service 中的一个权限提升漏洞，存在于 `MSKSSRV.SYS` 驱动中。攻击者可以通过构造特定的IOCTL请求，利用驱动中的漏洞，最终提升权限。

**有效性：**

根据提供的POC代码，该漏洞的利用通过发送特定的IOCTL到 `MSKSSRV.SYS` 驱动实现。代码中包含了用于与驱动交互的IOCTL码 (例如 `IOCTL_RegisterStream`, `IOCTL_InitializeStream`)，以及构造的输入缓冲区结构体 (`InputBuffer`)。通过调用 `NtDeviceIoControlFile` 函数将这些IOCTL发送到设备驱动，如果驱动没有正确处理这些请求，可能导致权限提升。

**投毒风险：**

虽然POC代码看起来是合法的漏洞利用，但存在一些潜在的投毒风险，占比10%。主要集中在以下几个方面：

*   **硬编码值：** 代码中存在一些硬编码的常量值，例如 `inbuff.Flags = 0x000000136FE7474D`，这些值可能与特定版本的操作系统或驱动相关。如果这些值不正确，可能导致exploit无法正常工作，或者触发其他未知的行为。
*   **驱动依赖：** 该exploit严重依赖于 `MSKSSRV.SYS` 驱动的存在和特定行为。如果目标系统上不存在该驱动，或者驱动版本不兼容，exploit将无法工作。这使得exploit的适用性受到限制。
*   **事件处理：** 代码中使用了 `CreateEventW` 函数来创建事件对象。虽然看起来是标准的Windows API用法，但如果事件没有被正确处理或者泄露，可能导致资源耗尽或拒绝服务。

**利用方式：**

1.  **查找设备：** 首先，需要找到 `MSKSSRV.SYS` 驱动对应的设备句柄。通常可以通过设备接口名称或符号链接来找到该设备。
2.  **构造IOCTL请求：** 根据漏洞原理，构造特定的IOCTL请求和输入缓冲区。代码中已经定义了 `InputBuffer` 结构体，并设置了相应的字段值。
3.  **发送IOCTL请求：** 调用 `NtDeviceIoControlFile` 函数将IOCTL请求发送到设备驱动。
4.  **利用漏洞：** 如果驱动没有正确处理IOCTL请求，可能导致内存破坏、代码执行或权限提升。

**总结：**

提供的POC代码似乎是针对 CVE-2023-29360 的有效利用，但使用前需要仔细审查，并确保目标系统符合漏洞利用的条件。 代码中存在细微的投毒风险，但整体可利用性较高。需要注意的是，不应将POC验证的后门代码误判为投毒代码。需要仔细区分两者。

**项目地址:** [Nero22k/cve-2023-29360](https://github.com/Nero22k/cve-2023-29360)

**漏洞详情:** [CVE-2023-29360](https://nvd.nist.gov/vuln/detail/CVE-2023-29360)

---

## POC #3

**来源**: [CVE-2023-29360-Scottman625_CVE-2023-29360.md](../2023/CVE-2023-29360-Scottman625_CVE-2023-29360.md)

## CVE-2023-29360 Microsoft Streaming Service Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-29360

**漏洞类型:** 特权提升

**影响应用:** Microsoft Streaming Service

**危害等级:** 高危，可导致本地权限提升

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要在受影响的Windows系统上本地执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息，CVE-2023-29360是Microsoft Streaming Service的特权提升漏洞。该漏洞的CWE为CWE-822: Untrusted Pointer Dereference(不可信指针解引用)。CISA已将其添加到已知被利用的漏洞目录中。从提供的漏洞利用代码来看，利用方式如下：

1.  **句柄泄露：** 利用 `NtQuerySystemInformation` 获取系统句柄信息，从而找到目标进程的句柄。
2.  **设备交互：** 通过打开设备句柄（`DeviceH1`， `DeviceH2`， `DeviceH3`）与Microsoft Streaming Service进行交互。
3.  **上下文、流初始化与注册：** 调用 `FSInitializeContextRendezvous`， `FSInitializeStream`， `FSRegisterStream` 函数，初始化和注册流服务。
4.  **事务处理：** 利用 `PublishTx` 函数发布事务，目标地址为当前进程token的privilege地址（`privAddr = tokenAddress + OFFSET_OF_TOKEN_PRIVILEGES;`），然后利用 `ConsumeTx` 函数消费事务，实现任意地址映射。
5.  **权限修改：** 将Token权限的内存区域填充为0xFF，启用所有特权。
6.  **提权Shell：** 调用 `spawnShell()` 生成提权的cmd进程

**有效性评估：** 根据CISA KEV目录，该漏洞已被积极利用，提供的PoC代码很可能有效，可以在目标系统上实现本地提权。

**投毒风险分析：** 虽然PoC的主要目的是利用漏洞进行提权，但存在一些潜在的投毒风险：

*   **硬编码偏移量：** 代码中存在硬编码的 `OFFSET_OF_TOKEN_PRIVILEGES`，如果目标系统与PoC作者使用的系统版本不一致，偏移量可能不正确，导致提权失败甚至系统崩溃。恶意攻击者可能利用这一点，通过提供错误偏移量的PoC，导致目标系统不稳定。
*   **spawnShell 函数：** 检查 `spawnShell` 函数的具体实现。如果该函数包含任何下载或执行其他恶意代码的逻辑，则存在潜在的投毒风险。由于没有 `spawnShell` 函数的具体代码，这里只能推测。
*   **依赖库投毒：** `compile_c.sh` 脚本中使用了 `x86_64-w64-mingw32-g++` 编译器，该编译器可能被恶意替换或篡改，从而在编译后的可执行文件中注入恶意代码。但这种可能性较低，需要用户主动替换编译器。

总体来说，投毒风险主要集中在偏移量的错误、`spawnShell` 函数的恶意行为以及编译环境的潜在威胁。结合CISA利用信息和对代码的分析,PoC可用,但是存在一定的投毒风险, 概率为10%。

**项目地址:** [Scottman625/CVE-2023-29360](https://github.com/Scottman625/CVE-2023-29360)

**漏洞详情:** [CVE-2023-29360](https://nvd.nist.gov/vuln/detail/CVE-2023-29360)

---



---



---



---



---



---



---



---

