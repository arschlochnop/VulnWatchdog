# CVE-2023-32233

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-32233-Liuk3r_CVE-2023-32233.md](../2023/CVE-2023-32233-Liuk3r_CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter nf_tables Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel Netfilter nf_tables

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** <= 6.3.1

**利用条件:** 需要本地用户权限，目标内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 是 Linux kernel 中 Netfilter nf_tables 组件的 Use-After-Free 漏洞。该漏洞发生在处理批量请求更新 nf_tables 配置时，由于匿名集合处理不当导致。攻击者可以利用此漏洞在内核内存上执行任意读写操作，从而获得 root 权限。 

**漏洞利用有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞利用的有效性较高。搜索引擎结果表明，存在公开的 PoC 代码，并且已被成功利用以实现权限提升。漏洞描述中也明确指出，未授权的本地用户可以利用此漏洞获取 root 权限。

**投毒风险：**
阅读提供的漏洞利用代码片段，主要关注了利用 UAF 漏洞的原理和方法，例如通过竞争条件和内存布局来修改已释放的 `nft_set` 结构体的内容。虽然PoC代码中添加了延时操作和CPU亲和性来增加漏洞触发的概率，但这属于正常的漏洞利用手段，不属于恶意投毒。
投毒风险评估：10%。PoC的主要目的是演示漏洞的可利用性，而非植入后门或执行其他恶意操作。但是，任何未经审核的代码都存在潜在风险，建议在受控环境中测试。

**漏洞利用方式：**
1.  **构造恶意的批量请求：**  攻击者构造包含`NFT_MSG_DELRULE` (删除规则) 和 `NFT_MSG_DELSETELEM` (删除集合元素) 操作的 Netfilter nf_tables 批量请求。
2.  **触发Use-After-Free：**  `NFT_MSG_DELRULE` 操作会释放匿名 `nft_set` 结构体，而随后的 `NFT_MSG_DELSETELEM` 操作会尝试访问已释放的 `nft_set` 结构体，导致 Use-After-Free。
3.  **内存操作：**  攻击者在 `nft_set` 释放后，但在访问之前，尝试重新分配内存并写入特定值，通常是覆盖`set->ops->elemsize`。当后续代码尝试使用已释放的 `nft_set` 结构体时，例如计算偏移量，就会使用被篡改的值，导致访问到错误的内存位置。
4.  **权限提升：**  通过控制内存读写，攻击者可以覆盖内核中的关键数据结构，例如进程的权限信息，从而获得 root 权限。

**项目地址:** [Liuk3r/CVE-2023-32233](https://github.com/Liuk3r/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #2

**来源**: [CVE-2023-32233-PIDAN-HEIDASHUAI_CVE-2023-32233.md](../2023/CVE-2023-32233-PIDAN-HEIDASHUAI_CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel Netfilter nf_tables

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限，需要nf_tables配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 漏洞存在于Linux内核的Netfilter nf_tables子系统中，当处理批量请求以更新nf_tables配置时，会发生use-after-free漏洞。

**漏洞利用有效性:**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，可以判断此漏洞利用是有效的。POC代码描述了利用此漏洞的详细步骤，包括如何触发use-after-free，以及如何赢得与内核后台工作线程的竞争，从而实现可靠的利用。搜索引擎结果中也提到了公开的PoC。

**投毒风险:**
POC代码的目的是演示漏洞利用，并不能完全排除作者隐藏投毒代码的风险。代码中存在一定的复杂性，难以保证完全没有恶意代码。但从代码的功能和目的来看，作为漏洞利用，投毒的可能性较低。对已提供的POC代码进行初步分析，发现并无明显恶意代码，但仍需进一步审查。因此，将投毒风险评估为10%。

**利用方式:**
利用方式如下：
1.  **漏洞触发:** 通过构造恶意的nf_tables批量请求，其中包含删除规则（`NFT_MSG_DELRULE`）和删除集合元素（`NFT_MSG_DELSETELEM`）的操作。
2.  **Use-After-Free:** 删除规则操作会释放匿名集合（`nft_set`）的内存。之后，删除集合元素的操作会尝试访问已释放的内存，从而触发use-after-free漏洞。
3.  **竞争条件:** 攻击者需要与内核后台工作线程`nf_tables_trans_destroy_work()`竞争。为了增加成功率，POC代码会增加延迟，并使其他CPU核心繁忙，从而增加在特定CPU核心上重用已释放内存的机会。
4.  **内存重用:** 攻击者尝试分配新的`nft_set`或其他内核对象来重用已释放的内存。通过精心构造的数据，可以修改`nft_set`中的`ops->elemsize`等关键字段。
5.  **任意读写:**  修改`ops->elemsize`会导致`nft_set_elem_ext`计算出错误的内存地址，最终允许攻击者执行任意内核内存读写操作。
6.  **权限提升:** 攻击者可以使用任意内核内存读写操作来修改进程的凭据（credentials），从而获得root权限。

**项目地址:** [PIDAN-HEIDASHUAI/CVE-2023-32233](https://github.com/PIDAN-HEIDASHUAI/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #3

**来源**: [CVE-2023-32233-RogelioPumajulca_TEST-CVE-2023-32233.md](../2023/CVE-2023-32233-RogelioPumajulca_TEST-CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel Netfilter nf_tables Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限，目标系统运行受影响的Linux内核版本且未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233是Linux内核Netfilter nf_tables组件中的一个使用后释放（Use-After-Free）漏洞。该漏洞发生在处理批量请求更新nf_tables配置时，由于匿名集合处理不当导致。未授权的本地用户可以利用此漏洞在内核内存中执行任意读写操作，从而获得root权限。

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞利用的有效性较高。漏洞库信息表明该漏洞确实存在，并且允许本地提权。搜索引擎结果中也显示存在公开的PoC代码。
提供的PoC代码包含构建和配置说明，以及如何针对不同内核进行调整的指导，包括内核符号地址和机器码的调整。这表明该PoC是经过验证的，并且具有一定的灵活性，可以适应不同的内核版本。

**投毒风险分析：**
分析PoC代码后，发现其中存在一些需要用户手动配置的参数，例如内核符号地址、机器码等。这些参数的配置需要一定的内核知识，如果配置不当，可能会导致PoC无法成功利用，甚至导致系统崩溃。但是，这些配置要求是由于内核版本和编译选项的差异造成的，属于正常情况，并非恶意投毒。
代码中没有发现明显的恶意代码或后门。需要注意的是，PoC本身可能会导致系统不稳定，甚至崩溃，这是利用UAF漏洞的常见风险。因此，在测试PoC时，建议在专用系统上进行，以避免数据损坏。
综合来看，投毒风险较低，大约为10%。主要风险在于PoC本身可能导致系统不稳定。

**利用方式分析：**
1.  **漏洞触发：** 通过精心构造的Netfilter nf_tables批量请求，触发use-after-free漏洞。漏洞的根源在于对匿名集合的处理不当。
2.  **内存破坏：**  利用use-after-free漏洞，在内核内存中执行任意读写操作。这允许攻击者覆盖关键的内核数据结构。
3.  **权限提升：**  通过覆盖`modprobe_path`变量，将执行modprobe的路径修改为攻击者控制的脚本。当内核尝试执行modprobe时，会执行攻击者提供的脚本，从而获得root权限。
4. **代码分析:** exploit.c代码通过利用nf_tables的批量处理机制中的UAF漏洞，精巧地控制内核内存，最终劫持了`modprobe_path`，实现了提权。其中race condition的利用是成功利用漏洞的关键,需要通过调整sleep时间来提高成功率。
5.  **配置需求:**  PoC需要根据不同的内核版本进行配置，包括内核符号地址和机器码的调整，以确保能够正确利用漏洞。

**项目地址:** [RogelioPumajulca/TEST-CVE-2023-32233](https://github.com/RogelioPumajulca/TEST-CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #4

**来源**: [CVE-2023-32233-enlist12_CVE-2023-32233.md](../2023/CVE-2023-32233-enlist12_CVE-2023-32233.md)

## CVE-2023-32233

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel (Netfilter nf_tables)

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-32233是一个Linux内核中的use-after-free漏洞，存在于Netfilter nf_tables子系统中，当处理批量请求时可能被触发。根据漏洞库信息和搜索结果，该漏洞允许未经授权的本地用户通过利用此漏洞在内核内存中执行任意读写操作，从而获得root权限。

**有效性：** 根据搜索结果（例如，来自NSFOCUS CERT的通知），漏洞的PoC代码已被公开披露，表明该漏洞是可以被成功利用的。提供的POC代码片段（myconfig）显示了内核配置选项，例如启用`CONFIG_NETFILTER`，`CONFIG_NF_TABLES`和`User namespaces`，并禁用`CONFIG_WERROR`和`CONFIG_RETPOLINE`。这些配置都是为了便于漏洞的利用，并关闭一些缓解措施。综上，提供的POC代码有效。

**投毒风险：** 分析提供的代码片段：

*   `/README.md`： 包含启用和禁用某些内核配置选项的说明。 这些本身不是恶意代码，而是指示如何配置内核以重现或利用漏洞。
*   `/myconfig`： 这是内核配置文件的摘录，用于构建易受攻击的内核。 它本身也不是恶意代码，但它指定了使系统容易受到攻击的配置。

虽然这些文件本身并没有明显的恶意代码，但是有可能在完整的利用代码中隐藏了某些后门。 由于只提供了部分代码（配置文件和README），因此无法完全排除这种可能性。 这里给出一个较低的概率(5%)表示可能存在投毒代码，但缺乏充分证据。

**利用方式：**

1.  **触发漏洞：** 攻击者需要构造恶意的Netfilter nf_tables批量请求。
2.  **Use-After-Free：**  由于匿名集合处理不当，这会导致use-after-free情况。
3.  **任意读写：** 利用UAF漏洞在内核内存中执行任意读写操作。
4.  **权限提升：**  攻击者可以通过修改内核数据结构来提升自己的权限，最终获得root权限。

**项目地址:** [enlist12/CVE-2023-32233](https://github.com/enlist12/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #5

**来源**: [CVE-2023-32233-oferchen_POC-CVE-2023-32233.md](../2023/CVE-2023-32233-oferchen_POC-CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter nf_tables UAF

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel (Netfilter nf_tables)

**危害等级:** 高危，可导致权限提升

**影响版本:** <= 6.3.1

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 是 Linux 内核 Netfilter nf_tables 组件中的一个使用后释放漏洞。当处理批量请求时，删除规则和规则中的集合元素会导致use-after-free。攻击者可以利用此漏洞在内核内存中执行任意读写操作，从而获得 root 权限。

**漏洞利用方式：**

1.  漏洞存在于 `net/netfilter/nf_tables_api.c` 文件中。
2.  攻击者发送包含两个基本操作的批量请求：
    *   `NFT_MSG_DELRULE`：删除包含匿名 `nft_set` 的 `nft_rule`，这将隐式删除 `lookup` 表达式和匿名 `nft_set`。
    *   `NFT_MSG_DELSETELEM`：删除已删除的匿名 `nft_set` 中的元素。
3.  内核接受批量请求，调用 `nf_tables_commit_release()` 将释放的资源添加到 `nf_tables_destroy_list`。
4.  `nf_tables_trans_destroy_work()` 处理 `nf_tables_destroy_list`，首先通过调用 `nft_commit_release()` -> `nf_tables_rule_destroy()` -> `nf_tables_expr_destroy()` -> `expr->ops->destroy()` (指向 `nft_lookup_destroy()`) -> `nf_tables_destroy_set()` -> `nft_set_destroy()` -> `kvfree()` 释放 `nft_set` 占用的内存。
5.  之后，在处理 `NFT_MSG_DELSETELEM` 操作时，通过 `nft_commit_release()` -> `nf_tables_set_elem_destroy()` -> `nft_set_elem_ext()` 访问已释放的 `nft_set` 内存，导致使用后释放。
6.  `nft_set_elem_ext` 宏尝试访问释放的 `nft_set` 结构中的 `ops->elemsize` 字段，如果该字段被篡改，可能导致访问任意内存地址。
7.  通过竞争 `nf_tables_trans_destroy_work()`，可以尝试在释放的内存被重用之前修改 `nft_set` 的内容。
8.  PoC 通过增加销毁大量元素的 `nft_set` 操作来增加worker线程延迟，并使其他CPU核心繁忙，来增加竞争成功的几率。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞允许本地用户提权，并且存在公开的 PoC 代码。PoC 代码描述了利用 use-after-free 漏洞的技术，包括竞争条件和内存操作。因此，提供的 PoC 代码看起来是有效的。

**投毒风险：**

尽管PoC看起来旨在重现漏洞利用, 但仍然存在一些风险: 
* 仓库名称过于简单，缺乏实质内容, 增加了潜在的风险。
* 描述中存在一些拼写错误（例如：dea），可能是故意为之，以掩盖潜在的恶意代码。
*  通过延迟worker线程方式，增加了不确定性。 
综上所述，作者可能在PoC中加入了一些难以察觉的恶意代码，比如后门或信息收集功能。尽管PoC主要目的是演示漏洞利用，但也不能排除作者恶意投毒的可能性。因此，保守估计投毒风险为10%。建议在使用前进行代码审计。

**项目地址:** [oferchen/POC-CVE-2023-32233](https://github.com/oferchen/POC-CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #6

**来源**: [CVE-2023-32233-void0red_CVE-2023-32233.md](../2023/CVE-2023-32233-void0red_CVE-2023-32233.md)

# CVE-2023-32233

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-32233-Liuk3r_CVE-2023-32233.md](../2023/CVE-2023-32233-Liuk3r_CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter nf_tables Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel Netfilter nf_tables

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** <= 6.3.1

**利用条件:** 需要本地用户权限，目标内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 是 Linux kernel 中 Netfilter nf_tables 组件的 Use-After-Free 漏洞。该漏洞发生在处理批量请求更新 nf_tables 配置时，由于匿名集合处理不当导致。攻击者可以利用此漏洞在内核内存上执行任意读写操作，从而获得 root 权限。 

**漏洞利用有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞利用的有效性较高。搜索引擎结果表明，存在公开的 PoC 代码，并且已被成功利用以实现权限提升。漏洞描述中也明确指出，未授权的本地用户可以利用此漏洞获取 root 权限。

**投毒风险：**
阅读提供的漏洞利用代码片段，主要关注了利用 UAF 漏洞的原理和方法，例如通过竞争条件和内存布局来修改已释放的 `nft_set` 结构体的内容。虽然PoC代码中添加了延时操作和CPU亲和性来增加漏洞触发的概率，但这属于正常的漏洞利用手段，不属于恶意投毒。
投毒风险评估：10%。PoC的主要目的是演示漏洞的可利用性，而非植入后门或执行其他恶意操作。但是，任何未经审核的代码都存在潜在风险，建议在受控环境中测试。

**漏洞利用方式：**
1.  **构造恶意的批量请求：**  攻击者构造包含`NFT_MSG_DELRULE` (删除规则) 和 `NFT_MSG_DELSETELEM` (删除集合元素) 操作的 Netfilter nf_tables 批量请求。
2.  **触发Use-After-Free：**  `NFT_MSG_DELRULE` 操作会释放匿名 `nft_set` 结构体，而随后的 `NFT_MSG_DELSETELEM` 操作会尝试访问已释放的 `nft_set` 结构体，导致 Use-After-Free。
3.  **内存操作：**  攻击者在 `nft_set` 释放后，但在访问之前，尝试重新分配内存并写入特定值，通常是覆盖`set->ops->elemsize`。当后续代码尝试使用已释放的 `nft_set` 结构体时，例如计算偏移量，就会使用被篡改的值，导致访问到错误的内存位置。
4.  **权限提升：**  通过控制内存读写，攻击者可以覆盖内核中的关键数据结构，例如进程的权限信息，从而获得 root 权限。

**项目地址:** [Liuk3r/CVE-2023-32233](https://github.com/Liuk3r/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #2

**来源**: [CVE-2023-32233-PIDAN-HEIDASHUAI_CVE-2023-32233.md](../2023/CVE-2023-32233-PIDAN-HEIDASHUAI_CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel Netfilter nf_tables

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限，需要nf_tables配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 漏洞存在于Linux内核的Netfilter nf_tables子系统中，当处理批量请求以更新nf_tables配置时，会发生use-after-free漏洞。

**漏洞利用有效性:**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，可以判断此漏洞利用是有效的。POC代码描述了利用此漏洞的详细步骤，包括如何触发use-after-free，以及如何赢得与内核后台工作线程的竞争，从而实现可靠的利用。搜索引擎结果中也提到了公开的PoC。

**投毒风险:**
POC代码的目的是演示漏洞利用，并不能完全排除作者隐藏投毒代码的风险。代码中存在一定的复杂性，难以保证完全没有恶意代码。但从代码的功能和目的来看，作为漏洞利用，投毒的可能性较低。对已提供的POC代码进行初步分析，发现并无明显恶意代码，但仍需进一步审查。因此，将投毒风险评估为10%。

**利用方式:**
利用方式如下：
1.  **漏洞触发:** 通过构造恶意的nf_tables批量请求，其中包含删除规则（`NFT_MSG_DELRULE`）和删除集合元素（`NFT_MSG_DELSETELEM`）的操作。
2.  **Use-After-Free:** 删除规则操作会释放匿名集合（`nft_set`）的内存。之后，删除集合元素的操作会尝试访问已释放的内存，从而触发use-after-free漏洞。
3.  **竞争条件:** 攻击者需要与内核后台工作线程`nf_tables_trans_destroy_work()`竞争。为了增加成功率，POC代码会增加延迟，并使其他CPU核心繁忙，从而增加在特定CPU核心上重用已释放内存的机会。
4.  **内存重用:** 攻击者尝试分配新的`nft_set`或其他内核对象来重用已释放的内存。通过精心构造的数据，可以修改`nft_set`中的`ops->elemsize`等关键字段。
5.  **任意读写:**  修改`ops->elemsize`会导致`nft_set_elem_ext`计算出错误的内存地址，最终允许攻击者执行任意内核内存读写操作。
6.  **权限提升:** 攻击者可以使用任意内核内存读写操作来修改进程的凭据（credentials），从而获得root权限。

**项目地址:** [PIDAN-HEIDASHUAI/CVE-2023-32233](https://github.com/PIDAN-HEIDASHUAI/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #3

**来源**: [CVE-2023-32233-RogelioPumajulca_TEST-CVE-2023-32233.md](../2023/CVE-2023-32233-RogelioPumajulca_TEST-CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel Netfilter nf_tables Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限，目标系统运行受影响的Linux内核版本且未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233是Linux内核Netfilter nf_tables组件中的一个使用后释放（Use-After-Free）漏洞。该漏洞发生在处理批量请求更新nf_tables配置时，由于匿名集合处理不当导致。未授权的本地用户可以利用此漏洞在内核内存中执行任意读写操作，从而获得root权限。

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞利用的有效性较高。漏洞库信息表明该漏洞确实存在，并且允许本地提权。搜索引擎结果中也显示存在公开的PoC代码。
提供的PoC代码包含构建和配置说明，以及如何针对不同内核进行调整的指导，包括内核符号地址和机器码的调整。这表明该PoC是经过验证的，并且具有一定的灵活性，可以适应不同的内核版本。

**投毒风险分析：**
分析PoC代码后，发现其中存在一些需要用户手动配置的参数，例如内核符号地址、机器码等。这些参数的配置需要一定的内核知识，如果配置不当，可能会导致PoC无法成功利用，甚至导致系统崩溃。但是，这些配置要求是由于内核版本和编译选项的差异造成的，属于正常情况，并非恶意投毒。
代码中没有发现明显的恶意代码或后门。需要注意的是，PoC本身可能会导致系统不稳定，甚至崩溃，这是利用UAF漏洞的常见风险。因此，在测试PoC时，建议在专用系统上进行，以避免数据损坏。
综合来看，投毒风险较低，大约为10%。主要风险在于PoC本身可能导致系统不稳定。

**利用方式分析：**
1.  **漏洞触发：** 通过精心构造的Netfilter nf_tables批量请求，触发use-after-free漏洞。漏洞的根源在于对匿名集合的处理不当。
2.  **内存破坏：**  利用use-after-free漏洞，在内核内存中执行任意读写操作。这允许攻击者覆盖关键的内核数据结构。
3.  **权限提升：**  通过覆盖`modprobe_path`变量，将执行modprobe的路径修改为攻击者控制的脚本。当内核尝试执行modprobe时，会执行攻击者提供的脚本，从而获得root权限。
4. **代码分析:** exploit.c代码通过利用nf_tables的批量处理机制中的UAF漏洞，精巧地控制内核内存，最终劫持了`modprobe_path`，实现了提权。其中race condition的利用是成功利用漏洞的关键,需要通过调整sleep时间来提高成功率。
5.  **配置需求:**  PoC需要根据不同的内核版本进行配置，包括内核符号地址和机器码的调整，以确保能够正确利用漏洞。

**项目地址:** [RogelioPumajulca/TEST-CVE-2023-32233](https://github.com/RogelioPumajulca/TEST-CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #4

**来源**: [CVE-2023-32233-enlist12_CVE-2023-32233.md](../2023/CVE-2023-32233-enlist12_CVE-2023-32233.md)

## CVE-2023-32233

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel (Netfilter nf_tables)

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-32233是一个Linux内核中的use-after-free漏洞，存在于Netfilter nf_tables子系统中，当处理批量请求时可能被触发。根据漏洞库信息和搜索结果，该漏洞允许未经授权的本地用户通过利用此漏洞在内核内存中执行任意读写操作，从而获得root权限。

**有效性：** 根据搜索结果（例如，来自NSFOCUS CERT的通知），漏洞的PoC代码已被公开披露，表明该漏洞是可以被成功利用的。提供的POC代码片段（myconfig）显示了内核配置选项，例如启用`CONFIG_NETFILTER`，`CONFIG_NF_TABLES`和`User namespaces`，并禁用`CONFIG_WERROR`和`CONFIG_RETPOLINE`。这些配置都是为了便于漏洞的利用，并关闭一些缓解措施。综上，提供的POC代码有效。

**投毒风险：** 分析提供的代码片段：

*   `/README.md`： 包含启用和禁用某些内核配置选项的说明。 这些本身不是恶意代码，而是指示如何配置内核以重现或利用漏洞。
*   `/myconfig`： 这是内核配置文件的摘录，用于构建易受攻击的内核。 它本身也不是恶意代码，但它指定了使系统容易受到攻击的配置。

虽然这些文件本身并没有明显的恶意代码，但是有可能在完整的利用代码中隐藏了某些后门。 由于只提供了部分代码（配置文件和README），因此无法完全排除这种可能性。 这里给出一个较低的概率(5%)表示可能存在投毒代码，但缺乏充分证据。

**利用方式：**

1.  **触发漏洞：** 攻击者需要构造恶意的Netfilter nf_tables批量请求。
2.  **Use-After-Free：**  由于匿名集合处理不当，这会导致use-after-free情况。
3.  **任意读写：** 利用UAF漏洞在内核内存中执行任意读写操作。
4.  **权限提升：**  攻击者可以通过修改内核数据结构来提升自己的权限，最终获得root权限。

**项目地址:** [enlist12/CVE-2023-32233](https://github.com/enlist12/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #5

**来源**: [CVE-2023-32233-oferchen_POC-CVE-2023-32233.md](../2023/CVE-2023-32233-oferchen_POC-CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter nf_tables UAF

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel (Netfilter nf_tables)

**危害等级:** 高危，可导致权限提升

**影响版本:** <= 6.3.1

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 是 Linux 内核 Netfilter nf_tables 组件中的一个使用后释放漏洞。当处理批量请求时，删除规则和规则中的集合元素会导致use-after-free。攻击者可以利用此漏洞在内核内存中执行任意读写操作，从而获得 root 权限。

**漏洞利用方式：**

1.  漏洞存在于 `net/netfilter/nf_tables_api.c` 文件中。
2.  攻击者发送包含两个基本操作的批量请求：
    *   `NFT_MSG_DELRULE`：删除包含匿名 `nft_set` 的 `nft_rule`，这将隐式删除 `lookup` 表达式和匿名 `nft_set`。
    *   `NFT_MSG_DELSETELEM`：删除已删除的匿名 `nft_set` 中的元素。
3.  内核接受批量请求，调用 `nf_tables_commit_release()` 将释放的资源添加到 `nf_tables_destroy_list`。
4.  `nf_tables_trans_destroy_work()` 处理 `nf_tables_destroy_list`，首先通过调用 `nft_commit_release()` -> `nf_tables_rule_destroy()` -> `nf_tables_expr_destroy()` -> `expr->ops->destroy()` (指向 `nft_lookup_destroy()`) -> `nf_tables_destroy_set()` -> `nft_set_destroy()` -> `kvfree()` 释放 `nft_set` 占用的内存。
5.  之后，在处理 `NFT_MSG_DELSETELEM` 操作时，通过 `nft_commit_release()` -> `nf_tables_set_elem_destroy()` -> `nft_set_elem_ext()` 访问已释放的 `nft_set` 内存，导致使用后释放。
6.  `nft_set_elem_ext` 宏尝试访问释放的 `nft_set` 结构中的 `ops->elemsize` 字段，如果该字段被篡改，可能导致访问任意内存地址。
7.  通过竞争 `nf_tables_trans_destroy_work()`，可以尝试在释放的内存被重用之前修改 `nft_set` 的内容。
8.  PoC 通过增加销毁大量元素的 `nft_set` 操作来增加worker线程延迟，并使其他CPU核心繁忙，来增加竞争成功的几率。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞允许本地用户提权，并且存在公开的 PoC 代码。PoC 代码描述了利用 use-after-free 漏洞的技术，包括竞争条件和内存操作。因此，提供的 PoC 代码看起来是有效的。

**投毒风险：**

尽管PoC看起来旨在重现漏洞利用, 但仍然存在一些风险: 
* 仓库名称过于简单，缺乏实质内容, 增加了潜在的风险。
* 描述中存在一些拼写错误（例如：dea），可能是故意为之，以掩盖潜在的恶意代码。
*  通过延迟worker线程方式，增加了不确定性。 
综上所述，作者可能在PoC中加入了一些难以察觉的恶意代码，比如后门或信息收集功能。尽管PoC主要目的是演示漏洞利用，但也不能排除作者恶意投毒的可能性。因此，保守估计投毒风险为10%。建议在使用前进行代码审计。

**项目地址:** [oferchen/POC-CVE-2023-32233](https://github.com/oferchen/POC-CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #6

**来源**: [CVE-2023-32233-void0red_CVE-2023-32233.md](../2023/CVE-2023-32233-void0red_CVE-2023-32233.md)

# CVE-2023-32233

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-32233-Liuk3r_CVE-2023-32233.md](../2023/CVE-2023-32233-Liuk3r_CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter nf_tables Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel Netfilter nf_tables

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** <= 6.3.1

**利用条件:** 需要本地用户权限，目标内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 是 Linux kernel 中 Netfilter nf_tables 组件的 Use-After-Free 漏洞。该漏洞发生在处理批量请求更新 nf_tables 配置时，由于匿名集合处理不当导致。攻击者可以利用此漏洞在内核内存上执行任意读写操作，从而获得 root 权限。 

**漏洞利用有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞利用的有效性较高。搜索引擎结果表明，存在公开的 PoC 代码，并且已被成功利用以实现权限提升。漏洞描述中也明确指出，未授权的本地用户可以利用此漏洞获取 root 权限。

**投毒风险：**
阅读提供的漏洞利用代码片段，主要关注了利用 UAF 漏洞的原理和方法，例如通过竞争条件和内存布局来修改已释放的 `nft_set` 结构体的内容。虽然PoC代码中添加了延时操作和CPU亲和性来增加漏洞触发的概率，但这属于正常的漏洞利用手段，不属于恶意投毒。
投毒风险评估：10%。PoC的主要目的是演示漏洞的可利用性，而非植入后门或执行其他恶意操作。但是，任何未经审核的代码都存在潜在风险，建议在受控环境中测试。

**漏洞利用方式：**
1.  **构造恶意的批量请求：**  攻击者构造包含`NFT_MSG_DELRULE` (删除规则) 和 `NFT_MSG_DELSETELEM` (删除集合元素) 操作的 Netfilter nf_tables 批量请求。
2.  **触发Use-After-Free：**  `NFT_MSG_DELRULE` 操作会释放匿名 `nft_set` 结构体，而随后的 `NFT_MSG_DELSETELEM` 操作会尝试访问已释放的 `nft_set` 结构体，导致 Use-After-Free。
3.  **内存操作：**  攻击者在 `nft_set` 释放后，但在访问之前，尝试重新分配内存并写入特定值，通常是覆盖`set->ops->elemsize`。当后续代码尝试使用已释放的 `nft_set` 结构体时，例如计算偏移量，就会使用被篡改的值，导致访问到错误的内存位置。
4.  **权限提升：**  通过控制内存读写，攻击者可以覆盖内核中的关键数据结构，例如进程的权限信息，从而获得 root 权限。

**项目地址:** [Liuk3r/CVE-2023-32233](https://github.com/Liuk3r/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #2

**来源**: [CVE-2023-32233-PIDAN-HEIDASHUAI_CVE-2023-32233.md](../2023/CVE-2023-32233-PIDAN-HEIDASHUAI_CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel Netfilter nf_tables

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限，需要nf_tables配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 漏洞存在于Linux内核的Netfilter nf_tables子系统中，当处理批量请求以更新nf_tables配置时，会发生use-after-free漏洞。

**漏洞利用有效性:**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，可以判断此漏洞利用是有效的。POC代码描述了利用此漏洞的详细步骤，包括如何触发use-after-free，以及如何赢得与内核后台工作线程的竞争，从而实现可靠的利用。搜索引擎结果中也提到了公开的PoC。

**投毒风险:**
POC代码的目的是演示漏洞利用，并不能完全排除作者隐藏投毒代码的风险。代码中存在一定的复杂性，难以保证完全没有恶意代码。但从代码的功能和目的来看，作为漏洞利用，投毒的可能性较低。对已提供的POC代码进行初步分析，发现并无明显恶意代码，但仍需进一步审查。因此，将投毒风险评估为10%。

**利用方式:**
利用方式如下：
1.  **漏洞触发:** 通过构造恶意的nf_tables批量请求，其中包含删除规则（`NFT_MSG_DELRULE`）和删除集合元素（`NFT_MSG_DELSETELEM`）的操作。
2.  **Use-After-Free:** 删除规则操作会释放匿名集合（`nft_set`）的内存。之后，删除集合元素的操作会尝试访问已释放的内存，从而触发use-after-free漏洞。
3.  **竞争条件:** 攻击者需要与内核后台工作线程`nf_tables_trans_destroy_work()`竞争。为了增加成功率，POC代码会增加延迟，并使其他CPU核心繁忙，从而增加在特定CPU核心上重用已释放内存的机会。
4.  **内存重用:** 攻击者尝试分配新的`nft_set`或其他内核对象来重用已释放的内存。通过精心构造的数据，可以修改`nft_set`中的`ops->elemsize`等关键字段。
5.  **任意读写:**  修改`ops->elemsize`会导致`nft_set_elem_ext`计算出错误的内存地址，最终允许攻击者执行任意内核内存读写操作。
6.  **权限提升:** 攻击者可以使用任意内核内存读写操作来修改进程的凭据（credentials），从而获得root权限。

**项目地址:** [PIDAN-HEIDASHUAI/CVE-2023-32233](https://github.com/PIDAN-HEIDASHUAI/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #3

**来源**: [CVE-2023-32233-RogelioPumajulca_TEST-CVE-2023-32233.md](../2023/CVE-2023-32233-RogelioPumajulca_TEST-CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel Netfilter nf_tables Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限，目标系统运行受影响的Linux内核版本且未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233是Linux内核Netfilter nf_tables组件中的一个使用后释放（Use-After-Free）漏洞。该漏洞发生在处理批量请求更新nf_tables配置时，由于匿名集合处理不当导致。未授权的本地用户可以利用此漏洞在内核内存中执行任意读写操作，从而获得root权限。

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞利用的有效性较高。漏洞库信息表明该漏洞确实存在，并且允许本地提权。搜索引擎结果中也显示存在公开的PoC代码。
提供的PoC代码包含构建和配置说明，以及如何针对不同内核进行调整的指导，包括内核符号地址和机器码的调整。这表明该PoC是经过验证的，并且具有一定的灵活性，可以适应不同的内核版本。

**投毒风险分析：**
分析PoC代码后，发现其中存在一些需要用户手动配置的参数，例如内核符号地址、机器码等。这些参数的配置需要一定的内核知识，如果配置不当，可能会导致PoC无法成功利用，甚至导致系统崩溃。但是，这些配置要求是由于内核版本和编译选项的差异造成的，属于正常情况，并非恶意投毒。
代码中没有发现明显的恶意代码或后门。需要注意的是，PoC本身可能会导致系统不稳定，甚至崩溃，这是利用UAF漏洞的常见风险。因此，在测试PoC时，建议在专用系统上进行，以避免数据损坏。
综合来看，投毒风险较低，大约为10%。主要风险在于PoC本身可能导致系统不稳定。

**利用方式分析：**
1.  **漏洞触发：** 通过精心构造的Netfilter nf_tables批量请求，触发use-after-free漏洞。漏洞的根源在于对匿名集合的处理不当。
2.  **内存破坏：**  利用use-after-free漏洞，在内核内存中执行任意读写操作。这允许攻击者覆盖关键的内核数据结构。
3.  **权限提升：**  通过覆盖`modprobe_path`变量，将执行modprobe的路径修改为攻击者控制的脚本。当内核尝试执行modprobe时，会执行攻击者提供的脚本，从而获得root权限。
4. **代码分析:** exploit.c代码通过利用nf_tables的批量处理机制中的UAF漏洞，精巧地控制内核内存，最终劫持了`modprobe_path`，实现了提权。其中race condition的利用是成功利用漏洞的关键,需要通过调整sleep时间来提高成功率。
5.  **配置需求:**  PoC需要根据不同的内核版本进行配置，包括内核符号地址和机器码的调整，以确保能够正确利用漏洞。

**项目地址:** [RogelioPumajulca/TEST-CVE-2023-32233](https://github.com/RogelioPumajulca/TEST-CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #4

**来源**: [CVE-2023-32233-enlist12_CVE-2023-32233.md](../2023/CVE-2023-32233-enlist12_CVE-2023-32233.md)

## CVE-2023-32233

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel (Netfilter nf_tables)

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-32233是一个Linux内核中的use-after-free漏洞，存在于Netfilter nf_tables子系统中，当处理批量请求时可能被触发。根据漏洞库信息和搜索结果，该漏洞允许未经授权的本地用户通过利用此漏洞在内核内存中执行任意读写操作，从而获得root权限。

**有效性：** 根据搜索结果（例如，来自NSFOCUS CERT的通知），漏洞的PoC代码已被公开披露，表明该漏洞是可以被成功利用的。提供的POC代码片段（myconfig）显示了内核配置选项，例如启用`CONFIG_NETFILTER`，`CONFIG_NF_TABLES`和`User namespaces`，并禁用`CONFIG_WERROR`和`CONFIG_RETPOLINE`。这些配置都是为了便于漏洞的利用，并关闭一些缓解措施。综上，提供的POC代码有效。

**投毒风险：** 分析提供的代码片段：

*   `/README.md`： 包含启用和禁用某些内核配置选项的说明。 这些本身不是恶意代码，而是指示如何配置内核以重现或利用漏洞。
*   `/myconfig`： 这是内核配置文件的摘录，用于构建易受攻击的内核。 它本身也不是恶意代码，但它指定了使系统容易受到攻击的配置。

虽然这些文件本身并没有明显的恶意代码，但是有可能在完整的利用代码中隐藏了某些后门。 由于只提供了部分代码（配置文件和README），因此无法完全排除这种可能性。 这里给出一个较低的概率(5%)表示可能存在投毒代码，但缺乏充分证据。

**利用方式：**

1.  **触发漏洞：** 攻击者需要构造恶意的Netfilter nf_tables批量请求。
2.  **Use-After-Free：**  由于匿名集合处理不当，这会导致use-after-free情况。
3.  **任意读写：** 利用UAF漏洞在内核内存中执行任意读写操作。
4.  **权限提升：**  攻击者可以通过修改内核数据结构来提升自己的权限，最终获得root权限。

**项目地址:** [enlist12/CVE-2023-32233](https://github.com/enlist12/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #5

**来源**: [CVE-2023-32233-oferchen_POC-CVE-2023-32233.md](../2023/CVE-2023-32233-oferchen_POC-CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter nf_tables UAF

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel (Netfilter nf_tables)

**危害等级:** 高危，可导致权限提升

**影响版本:** <= 6.3.1

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 是 Linux 内核 Netfilter nf_tables 组件中的一个使用后释放漏洞。当处理批量请求时，删除规则和规则中的集合元素会导致use-after-free。攻击者可以利用此漏洞在内核内存中执行任意读写操作，从而获得 root 权限。

**漏洞利用方式：**

1.  漏洞存在于 `net/netfilter/nf_tables_api.c` 文件中。
2.  攻击者发送包含两个基本操作的批量请求：
    *   `NFT_MSG_DELRULE`：删除包含匿名 `nft_set` 的 `nft_rule`，这将隐式删除 `lookup` 表达式和匿名 `nft_set`。
    *   `NFT_MSG_DELSETELEM`：删除已删除的匿名 `nft_set` 中的元素。
3.  内核接受批量请求，调用 `nf_tables_commit_release()` 将释放的资源添加到 `nf_tables_destroy_list`。
4.  `nf_tables_trans_destroy_work()` 处理 `nf_tables_destroy_list`，首先通过调用 `nft_commit_release()` -> `nf_tables_rule_destroy()` -> `nf_tables_expr_destroy()` -> `expr->ops->destroy()` (指向 `nft_lookup_destroy()`) -> `nf_tables_destroy_set()` -> `nft_set_destroy()` -> `kvfree()` 释放 `nft_set` 占用的内存。
5.  之后，在处理 `NFT_MSG_DELSETELEM` 操作时，通过 `nft_commit_release()` -> `nf_tables_set_elem_destroy()` -> `nft_set_elem_ext()` 访问已释放的 `nft_set` 内存，导致使用后释放。
6.  `nft_set_elem_ext` 宏尝试访问释放的 `nft_set` 结构中的 `ops->elemsize` 字段，如果该字段被篡改，可能导致访问任意内存地址。
7.  通过竞争 `nf_tables_trans_destroy_work()`，可以尝试在释放的内存被重用之前修改 `nft_set` 的内容。
8.  PoC 通过增加销毁大量元素的 `nft_set` 操作来增加worker线程延迟，并使其他CPU核心繁忙，来增加竞争成功的几率。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞允许本地用户提权，并且存在公开的 PoC 代码。PoC 代码描述了利用 use-after-free 漏洞的技术，包括竞争条件和内存操作。因此，提供的 PoC 代码看起来是有效的。

**投毒风险：**

尽管PoC看起来旨在重现漏洞利用, 但仍然存在一些风险: 
* 仓库名称过于简单，缺乏实质内容, 增加了潜在的风险。
* 描述中存在一些拼写错误（例如：dea），可能是故意为之，以掩盖潜在的恶意代码。
*  通过延迟worker线程方式，增加了不确定性。 
综上所述，作者可能在PoC中加入了一些难以察觉的恶意代码，比如后门或信息收集功能。尽管PoC主要目的是演示漏洞利用，但也不能排除作者恶意投毒的可能性。因此，保守估计投毒风险为10%。建议在使用前进行代码审计。

**项目地址:** [oferchen/POC-CVE-2023-32233](https://github.com/oferchen/POC-CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #6

**来源**: [CVE-2023-32233-void0red_CVE-2023-32233.md](../2023/CVE-2023-32233-void0red_CVE-2023-32233.md)

# CVE-2023-32233

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-32233-Liuk3r_CVE-2023-32233.md](../2023/CVE-2023-32233-Liuk3r_CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter nf_tables Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel Netfilter nf_tables

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** <= 6.3.1

**利用条件:** 需要本地用户权限，目标内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 是 Linux kernel 中 Netfilter nf_tables 组件的 Use-After-Free 漏洞。该漏洞发生在处理批量请求更新 nf_tables 配置时，由于匿名集合处理不当导致。攻击者可以利用此漏洞在内核内存上执行任意读写操作，从而获得 root 权限。 

**漏洞利用有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞利用的有效性较高。搜索引擎结果表明，存在公开的 PoC 代码，并且已被成功利用以实现权限提升。漏洞描述中也明确指出，未授权的本地用户可以利用此漏洞获取 root 权限。

**投毒风险：**
阅读提供的漏洞利用代码片段，主要关注了利用 UAF 漏洞的原理和方法，例如通过竞争条件和内存布局来修改已释放的 `nft_set` 结构体的内容。虽然PoC代码中添加了延时操作和CPU亲和性来增加漏洞触发的概率，但这属于正常的漏洞利用手段，不属于恶意投毒。
投毒风险评估：10%。PoC的主要目的是演示漏洞的可利用性，而非植入后门或执行其他恶意操作。但是，任何未经审核的代码都存在潜在风险，建议在受控环境中测试。

**漏洞利用方式：**
1.  **构造恶意的批量请求：**  攻击者构造包含`NFT_MSG_DELRULE` (删除规则) 和 `NFT_MSG_DELSETELEM` (删除集合元素) 操作的 Netfilter nf_tables 批量请求。
2.  **触发Use-After-Free：**  `NFT_MSG_DELRULE` 操作会释放匿名 `nft_set` 结构体，而随后的 `NFT_MSG_DELSETELEM` 操作会尝试访问已释放的 `nft_set` 结构体，导致 Use-After-Free。
3.  **内存操作：**  攻击者在 `nft_set` 释放后，但在访问之前，尝试重新分配内存并写入特定值，通常是覆盖`set->ops->elemsize`。当后续代码尝试使用已释放的 `nft_set` 结构体时，例如计算偏移量，就会使用被篡改的值，导致访问到错误的内存位置。
4.  **权限提升：**  通过控制内存读写，攻击者可以覆盖内核中的关键数据结构，例如进程的权限信息，从而获得 root 权限。

**项目地址:** [Liuk3r/CVE-2023-32233](https://github.com/Liuk3r/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #2

**来源**: [CVE-2023-32233-PIDAN-HEIDASHUAI_CVE-2023-32233.md](../2023/CVE-2023-32233-PIDAN-HEIDASHUAI_CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel Netfilter nf_tables

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限，需要nf_tables配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 漏洞存在于Linux内核的Netfilter nf_tables子系统中，当处理批量请求以更新nf_tables配置时，会发生use-after-free漏洞。

**漏洞利用有效性:**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，可以判断此漏洞利用是有效的。POC代码描述了利用此漏洞的详细步骤，包括如何触发use-after-free，以及如何赢得与内核后台工作线程的竞争，从而实现可靠的利用。搜索引擎结果中也提到了公开的PoC。

**投毒风险:**
POC代码的目的是演示漏洞利用，并不能完全排除作者隐藏投毒代码的风险。代码中存在一定的复杂性，难以保证完全没有恶意代码。但从代码的功能和目的来看，作为漏洞利用，投毒的可能性较低。对已提供的POC代码进行初步分析，发现并无明显恶意代码，但仍需进一步审查。因此，将投毒风险评估为10%。

**利用方式:**
利用方式如下：
1.  **漏洞触发:** 通过构造恶意的nf_tables批量请求，其中包含删除规则（`NFT_MSG_DELRULE`）和删除集合元素（`NFT_MSG_DELSETELEM`）的操作。
2.  **Use-After-Free:** 删除规则操作会释放匿名集合（`nft_set`）的内存。之后，删除集合元素的操作会尝试访问已释放的内存，从而触发use-after-free漏洞。
3.  **竞争条件:** 攻击者需要与内核后台工作线程`nf_tables_trans_destroy_work()`竞争。为了增加成功率，POC代码会增加延迟，并使其他CPU核心繁忙，从而增加在特定CPU核心上重用已释放内存的机会。
4.  **内存重用:** 攻击者尝试分配新的`nft_set`或其他内核对象来重用已释放的内存。通过精心构造的数据，可以修改`nft_set`中的`ops->elemsize`等关键字段。
5.  **任意读写:**  修改`ops->elemsize`会导致`nft_set_elem_ext`计算出错误的内存地址，最终允许攻击者执行任意内核内存读写操作。
6.  **权限提升:** 攻击者可以使用任意内核内存读写操作来修改进程的凭据（credentials），从而获得root权限。

**项目地址:** [PIDAN-HEIDASHUAI/CVE-2023-32233](https://github.com/PIDAN-HEIDASHUAI/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #3

**来源**: [CVE-2023-32233-RogelioPumajulca_TEST-CVE-2023-32233.md](../2023/CVE-2023-32233-RogelioPumajulca_TEST-CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel Netfilter nf_tables Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限，目标系统运行受影响的Linux内核版本且未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233是Linux内核Netfilter nf_tables组件中的一个使用后释放（Use-After-Free）漏洞。该漏洞发生在处理批量请求更新nf_tables配置时，由于匿名集合处理不当导致。未授权的本地用户可以利用此漏洞在内核内存中执行任意读写操作，从而获得root权限。

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞利用的有效性较高。漏洞库信息表明该漏洞确实存在，并且允许本地提权。搜索引擎结果中也显示存在公开的PoC代码。
提供的PoC代码包含构建和配置说明，以及如何针对不同内核进行调整的指导，包括内核符号地址和机器码的调整。这表明该PoC是经过验证的，并且具有一定的灵活性，可以适应不同的内核版本。

**投毒风险分析：**
分析PoC代码后，发现其中存在一些需要用户手动配置的参数，例如内核符号地址、机器码等。这些参数的配置需要一定的内核知识，如果配置不当，可能会导致PoC无法成功利用，甚至导致系统崩溃。但是，这些配置要求是由于内核版本和编译选项的差异造成的，属于正常情况，并非恶意投毒。
代码中没有发现明显的恶意代码或后门。需要注意的是，PoC本身可能会导致系统不稳定，甚至崩溃，这是利用UAF漏洞的常见风险。因此，在测试PoC时，建议在专用系统上进行，以避免数据损坏。
综合来看，投毒风险较低，大约为10%。主要风险在于PoC本身可能导致系统不稳定。

**利用方式分析：**
1.  **漏洞触发：** 通过精心构造的Netfilter nf_tables批量请求，触发use-after-free漏洞。漏洞的根源在于对匿名集合的处理不当。
2.  **内存破坏：**  利用use-after-free漏洞，在内核内存中执行任意读写操作。这允许攻击者覆盖关键的内核数据结构。
3.  **权限提升：**  通过覆盖`modprobe_path`变量，将执行modprobe的路径修改为攻击者控制的脚本。当内核尝试执行modprobe时，会执行攻击者提供的脚本，从而获得root权限。
4. **代码分析:** exploit.c代码通过利用nf_tables的批量处理机制中的UAF漏洞，精巧地控制内核内存，最终劫持了`modprobe_path`，实现了提权。其中race condition的利用是成功利用漏洞的关键,需要通过调整sleep时间来提高成功率。
5.  **配置需求:**  PoC需要根据不同的内核版本进行配置，包括内核符号地址和机器码的调整，以确保能够正确利用漏洞。

**项目地址:** [RogelioPumajulca/TEST-CVE-2023-32233](https://github.com/RogelioPumajulca/TEST-CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #4

**来源**: [CVE-2023-32233-enlist12_CVE-2023-32233.md](../2023/CVE-2023-32233-enlist12_CVE-2023-32233.md)

## CVE-2023-32233

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel (Netfilter nf_tables)

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-32233是一个Linux内核中的use-after-free漏洞，存在于Netfilter nf_tables子系统中，当处理批量请求时可能被触发。根据漏洞库信息和搜索结果，该漏洞允许未经授权的本地用户通过利用此漏洞在内核内存中执行任意读写操作，从而获得root权限。

**有效性：** 根据搜索结果（例如，来自NSFOCUS CERT的通知），漏洞的PoC代码已被公开披露，表明该漏洞是可以被成功利用的。提供的POC代码片段（myconfig）显示了内核配置选项，例如启用`CONFIG_NETFILTER`，`CONFIG_NF_TABLES`和`User namespaces`，并禁用`CONFIG_WERROR`和`CONFIG_RETPOLINE`。这些配置都是为了便于漏洞的利用，并关闭一些缓解措施。综上，提供的POC代码有效。

**投毒风险：** 分析提供的代码片段：

*   `/README.md`： 包含启用和禁用某些内核配置选项的说明。 这些本身不是恶意代码，而是指示如何配置内核以重现或利用漏洞。
*   `/myconfig`： 这是内核配置文件的摘录，用于构建易受攻击的内核。 它本身也不是恶意代码，但它指定了使系统容易受到攻击的配置。

虽然这些文件本身并没有明显的恶意代码，但是有可能在完整的利用代码中隐藏了某些后门。 由于只提供了部分代码（配置文件和README），因此无法完全排除这种可能性。 这里给出一个较低的概率(5%)表示可能存在投毒代码，但缺乏充分证据。

**利用方式：**

1.  **触发漏洞：** 攻击者需要构造恶意的Netfilter nf_tables批量请求。
2.  **Use-After-Free：**  由于匿名集合处理不当，这会导致use-after-free情况。
3.  **任意读写：** 利用UAF漏洞在内核内存中执行任意读写操作。
4.  **权限提升：**  攻击者可以通过修改内核数据结构来提升自己的权限，最终获得root权限。

**项目地址:** [enlist12/CVE-2023-32233](https://github.com/enlist12/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #5

**来源**: [CVE-2023-32233-oferchen_POC-CVE-2023-32233.md](../2023/CVE-2023-32233-oferchen_POC-CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter nf_tables UAF

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel (Netfilter nf_tables)

**危害等级:** 高危，可导致权限提升

**影响版本:** <= 6.3.1

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 是 Linux 内核 Netfilter nf_tables 组件中的一个使用后释放漏洞。当处理批量请求时，删除规则和规则中的集合元素会导致use-after-free。攻击者可以利用此漏洞在内核内存中执行任意读写操作，从而获得 root 权限。

**漏洞利用方式：**

1.  漏洞存在于 `net/netfilter/nf_tables_api.c` 文件中。
2.  攻击者发送包含两个基本操作的批量请求：
    *   `NFT_MSG_DELRULE`：删除包含匿名 `nft_set` 的 `nft_rule`，这将隐式删除 `lookup` 表达式和匿名 `nft_set`。
    *   `NFT_MSG_DELSETELEM`：删除已删除的匿名 `nft_set` 中的元素。
3.  内核接受批量请求，调用 `nf_tables_commit_release()` 将释放的资源添加到 `nf_tables_destroy_list`。
4.  `nf_tables_trans_destroy_work()` 处理 `nf_tables_destroy_list`，首先通过调用 `nft_commit_release()` -> `nf_tables_rule_destroy()` -> `nf_tables_expr_destroy()` -> `expr->ops->destroy()` (指向 `nft_lookup_destroy()`) -> `nf_tables_destroy_set()` -> `nft_set_destroy()` -> `kvfree()` 释放 `nft_set` 占用的内存。
5.  之后，在处理 `NFT_MSG_DELSETELEM` 操作时，通过 `nft_commit_release()` -> `nf_tables_set_elem_destroy()` -> `nft_set_elem_ext()` 访问已释放的 `nft_set` 内存，导致使用后释放。
6.  `nft_set_elem_ext` 宏尝试访问释放的 `nft_set` 结构中的 `ops->elemsize` 字段，如果该字段被篡改，可能导致访问任意内存地址。
7.  通过竞争 `nf_tables_trans_destroy_work()`，可以尝试在释放的内存被重用之前修改 `nft_set` 的内容。
8.  PoC 通过增加销毁大量元素的 `nft_set` 操作来增加worker线程延迟，并使其他CPU核心繁忙，来增加竞争成功的几率。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞允许本地用户提权，并且存在公开的 PoC 代码。PoC 代码描述了利用 use-after-free 漏洞的技术，包括竞争条件和内存操作。因此，提供的 PoC 代码看起来是有效的。

**投毒风险：**

尽管PoC看起来旨在重现漏洞利用, 但仍然存在一些风险: 
* 仓库名称过于简单，缺乏实质内容, 增加了潜在的风险。
* 描述中存在一些拼写错误（例如：dea），可能是故意为之，以掩盖潜在的恶意代码。
*  通过延迟worker线程方式，增加了不确定性。 
综上所述，作者可能在PoC中加入了一些难以察觉的恶意代码，比如后门或信息收集功能。尽管PoC主要目的是演示漏洞利用，但也不能排除作者恶意投毒的可能性。因此，保守估计投毒风险为10%。建议在使用前进行代码审计。

**项目地址:** [oferchen/POC-CVE-2023-32233](https://github.com/oferchen/POC-CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #6

**来源**: [CVE-2023-32233-void0red_CVE-2023-32233.md](../2023/CVE-2023-32233-void0red_CVE-2023-32233.md)

# CVE-2023-32233

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-32233-Liuk3r_CVE-2023-32233.md](../2023/CVE-2023-32233-Liuk3r_CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter nf_tables Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel Netfilter nf_tables

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** <= 6.3.1

**利用条件:** 需要本地用户权限，目标内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 是 Linux kernel 中 Netfilter nf_tables 组件的 Use-After-Free 漏洞。该漏洞发生在处理批量请求更新 nf_tables 配置时，由于匿名集合处理不当导致。攻击者可以利用此漏洞在内核内存上执行任意读写操作，从而获得 root 权限。 

**漏洞利用有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞利用的有效性较高。搜索引擎结果表明，存在公开的 PoC 代码，并且已被成功利用以实现权限提升。漏洞描述中也明确指出，未授权的本地用户可以利用此漏洞获取 root 权限。

**投毒风险：**
阅读提供的漏洞利用代码片段，主要关注了利用 UAF 漏洞的原理和方法，例如通过竞争条件和内存布局来修改已释放的 `nft_set` 结构体的内容。虽然PoC代码中添加了延时操作和CPU亲和性来增加漏洞触发的概率，但这属于正常的漏洞利用手段，不属于恶意投毒。
投毒风险评估：10%。PoC的主要目的是演示漏洞的可利用性，而非植入后门或执行其他恶意操作。但是，任何未经审核的代码都存在潜在风险，建议在受控环境中测试。

**漏洞利用方式：**
1.  **构造恶意的批量请求：**  攻击者构造包含`NFT_MSG_DELRULE` (删除规则) 和 `NFT_MSG_DELSETELEM` (删除集合元素) 操作的 Netfilter nf_tables 批量请求。
2.  **触发Use-After-Free：**  `NFT_MSG_DELRULE` 操作会释放匿名 `nft_set` 结构体，而随后的 `NFT_MSG_DELSETELEM` 操作会尝试访问已释放的 `nft_set` 结构体，导致 Use-After-Free。
3.  **内存操作：**  攻击者在 `nft_set` 释放后，但在访问之前，尝试重新分配内存并写入特定值，通常是覆盖`set->ops->elemsize`。当后续代码尝试使用已释放的 `nft_set` 结构体时，例如计算偏移量，就会使用被篡改的值，导致访问到错误的内存位置。
4.  **权限提升：**  通过控制内存读写，攻击者可以覆盖内核中的关键数据结构，例如进程的权限信息，从而获得 root 权限。

**项目地址:** [Liuk3r/CVE-2023-32233](https://github.com/Liuk3r/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #2

**来源**: [CVE-2023-32233-PIDAN-HEIDASHUAI_CVE-2023-32233.md](../2023/CVE-2023-32233-PIDAN-HEIDASHUAI_CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel Netfilter nf_tables

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限，需要nf_tables配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 漏洞存在于Linux内核的Netfilter nf_tables子系统中，当处理批量请求以更新nf_tables配置时，会发生use-after-free漏洞。

**漏洞利用有效性:**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，可以判断此漏洞利用是有效的。POC代码描述了利用此漏洞的详细步骤，包括如何触发use-after-free，以及如何赢得与内核后台工作线程的竞争，从而实现可靠的利用。搜索引擎结果中也提到了公开的PoC。

**投毒风险:**
POC代码的目的是演示漏洞利用，并不能完全排除作者隐藏投毒代码的风险。代码中存在一定的复杂性，难以保证完全没有恶意代码。但从代码的功能和目的来看，作为漏洞利用，投毒的可能性较低。对已提供的POC代码进行初步分析，发现并无明显恶意代码，但仍需进一步审查。因此，将投毒风险评估为10%。

**利用方式:**
利用方式如下：
1.  **漏洞触发:** 通过构造恶意的nf_tables批量请求，其中包含删除规则（`NFT_MSG_DELRULE`）和删除集合元素（`NFT_MSG_DELSETELEM`）的操作。
2.  **Use-After-Free:** 删除规则操作会释放匿名集合（`nft_set`）的内存。之后，删除集合元素的操作会尝试访问已释放的内存，从而触发use-after-free漏洞。
3.  **竞争条件:** 攻击者需要与内核后台工作线程`nf_tables_trans_destroy_work()`竞争。为了增加成功率，POC代码会增加延迟，并使其他CPU核心繁忙，从而增加在特定CPU核心上重用已释放内存的机会。
4.  **内存重用:** 攻击者尝试分配新的`nft_set`或其他内核对象来重用已释放的内存。通过精心构造的数据，可以修改`nft_set`中的`ops->elemsize`等关键字段。
5.  **任意读写:**  修改`ops->elemsize`会导致`nft_set_elem_ext`计算出错误的内存地址，最终允许攻击者执行任意内核内存读写操作。
6.  **权限提升:** 攻击者可以使用任意内核内存读写操作来修改进程的凭据（credentials），从而获得root权限。

**项目地址:** [PIDAN-HEIDASHUAI/CVE-2023-32233](https://github.com/PIDAN-HEIDASHUAI/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #3

**来源**: [CVE-2023-32233-RogelioPumajulca_TEST-CVE-2023-32233.md](../2023/CVE-2023-32233-RogelioPumajulca_TEST-CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel Netfilter nf_tables Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限，目标系统运行受影响的Linux内核版本且未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233是Linux内核Netfilter nf_tables组件中的一个使用后释放（Use-After-Free）漏洞。该漏洞发生在处理批量请求更新nf_tables配置时，由于匿名集合处理不当导致。未授权的本地用户可以利用此漏洞在内核内存中执行任意读写操作，从而获得root权限。

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞利用的有效性较高。漏洞库信息表明该漏洞确实存在，并且允许本地提权。搜索引擎结果中也显示存在公开的PoC代码。
提供的PoC代码包含构建和配置说明，以及如何针对不同内核进行调整的指导，包括内核符号地址和机器码的调整。这表明该PoC是经过验证的，并且具有一定的灵活性，可以适应不同的内核版本。

**投毒风险分析：**
分析PoC代码后，发现其中存在一些需要用户手动配置的参数，例如内核符号地址、机器码等。这些参数的配置需要一定的内核知识，如果配置不当，可能会导致PoC无法成功利用，甚至导致系统崩溃。但是，这些配置要求是由于内核版本和编译选项的差异造成的，属于正常情况，并非恶意投毒。
代码中没有发现明显的恶意代码或后门。需要注意的是，PoC本身可能会导致系统不稳定，甚至崩溃，这是利用UAF漏洞的常见风险。因此，在测试PoC时，建议在专用系统上进行，以避免数据损坏。
综合来看，投毒风险较低，大约为10%。主要风险在于PoC本身可能导致系统不稳定。

**利用方式分析：**
1.  **漏洞触发：** 通过精心构造的Netfilter nf_tables批量请求，触发use-after-free漏洞。漏洞的根源在于对匿名集合的处理不当。
2.  **内存破坏：**  利用use-after-free漏洞，在内核内存中执行任意读写操作。这允许攻击者覆盖关键的内核数据结构。
3.  **权限提升：**  通过覆盖`modprobe_path`变量，将执行modprobe的路径修改为攻击者控制的脚本。当内核尝试执行modprobe时，会执行攻击者提供的脚本，从而获得root权限。
4. **代码分析:** exploit.c代码通过利用nf_tables的批量处理机制中的UAF漏洞，精巧地控制内核内存，最终劫持了`modprobe_path`，实现了提权。其中race condition的利用是成功利用漏洞的关键,需要通过调整sleep时间来提高成功率。
5.  **配置需求:**  PoC需要根据不同的内核版本进行配置，包括内核符号地址和机器码的调整，以确保能够正确利用漏洞。

**项目地址:** [RogelioPumajulca/TEST-CVE-2023-32233](https://github.com/RogelioPumajulca/TEST-CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #4

**来源**: [CVE-2023-32233-enlist12_CVE-2023-32233.md](../2023/CVE-2023-32233-enlist12_CVE-2023-32233.md)

## CVE-2023-32233

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel (Netfilter nf_tables)

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-32233是一个Linux内核中的use-after-free漏洞，存在于Netfilter nf_tables子系统中，当处理批量请求时可能被触发。根据漏洞库信息和搜索结果，该漏洞允许未经授权的本地用户通过利用此漏洞在内核内存中执行任意读写操作，从而获得root权限。

**有效性：** 根据搜索结果（例如，来自NSFOCUS CERT的通知），漏洞的PoC代码已被公开披露，表明该漏洞是可以被成功利用的。提供的POC代码片段（myconfig）显示了内核配置选项，例如启用`CONFIG_NETFILTER`，`CONFIG_NF_TABLES`和`User namespaces`，并禁用`CONFIG_WERROR`和`CONFIG_RETPOLINE`。这些配置都是为了便于漏洞的利用，并关闭一些缓解措施。综上，提供的POC代码有效。

**投毒风险：** 分析提供的代码片段：

*   `/README.md`： 包含启用和禁用某些内核配置选项的说明。 这些本身不是恶意代码，而是指示如何配置内核以重现或利用漏洞。
*   `/myconfig`： 这是内核配置文件的摘录，用于构建易受攻击的内核。 它本身也不是恶意代码，但它指定了使系统容易受到攻击的配置。

虽然这些文件本身并没有明显的恶意代码，但是有可能在完整的利用代码中隐藏了某些后门。 由于只提供了部分代码（配置文件和README），因此无法完全排除这种可能性。 这里给出一个较低的概率(5%)表示可能存在投毒代码，但缺乏充分证据。

**利用方式：**

1.  **触发漏洞：** 攻击者需要构造恶意的Netfilter nf_tables批量请求。
2.  **Use-After-Free：**  由于匿名集合处理不当，这会导致use-after-free情况。
3.  **任意读写：** 利用UAF漏洞在内核内存中执行任意读写操作。
4.  **权限提升：**  攻击者可以通过修改内核数据结构来提升自己的权限，最终获得root权限。

**项目地址:** [enlist12/CVE-2023-32233](https://github.com/enlist12/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #5

**来源**: [CVE-2023-32233-oferchen_POC-CVE-2023-32233.md](../2023/CVE-2023-32233-oferchen_POC-CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter nf_tables UAF

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel (Netfilter nf_tables)

**危害等级:** 高危，可导致权限提升

**影响版本:** <= 6.3.1

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 是 Linux 内核 Netfilter nf_tables 组件中的一个使用后释放漏洞。当处理批量请求时，删除规则和规则中的集合元素会导致use-after-free。攻击者可以利用此漏洞在内核内存中执行任意读写操作，从而获得 root 权限。

**漏洞利用方式：**

1.  漏洞存在于 `net/netfilter/nf_tables_api.c` 文件中。
2.  攻击者发送包含两个基本操作的批量请求：
    *   `NFT_MSG_DELRULE`：删除包含匿名 `nft_set` 的 `nft_rule`，这将隐式删除 `lookup` 表达式和匿名 `nft_set`。
    *   `NFT_MSG_DELSETELEM`：删除已删除的匿名 `nft_set` 中的元素。
3.  内核接受批量请求，调用 `nf_tables_commit_release()` 将释放的资源添加到 `nf_tables_destroy_list`。
4.  `nf_tables_trans_destroy_work()` 处理 `nf_tables_destroy_list`，首先通过调用 `nft_commit_release()` -> `nf_tables_rule_destroy()` -> `nf_tables_expr_destroy()` -> `expr->ops->destroy()` (指向 `nft_lookup_destroy()`) -> `nf_tables_destroy_set()` -> `nft_set_destroy()` -> `kvfree()` 释放 `nft_set` 占用的内存。
5.  之后，在处理 `NFT_MSG_DELSETELEM` 操作时，通过 `nft_commit_release()` -> `nf_tables_set_elem_destroy()` -> `nft_set_elem_ext()` 访问已释放的 `nft_set` 内存，导致使用后释放。
6.  `nft_set_elem_ext` 宏尝试访问释放的 `nft_set` 结构中的 `ops->elemsize` 字段，如果该字段被篡改，可能导致访问任意内存地址。
7.  通过竞争 `nf_tables_trans_destroy_work()`，可以尝试在释放的内存被重用之前修改 `nft_set` 的内容。
8.  PoC 通过增加销毁大量元素的 `nft_set` 操作来增加worker线程延迟，并使其他CPU核心繁忙，来增加竞争成功的几率。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞允许本地用户提权，并且存在公开的 PoC 代码。PoC 代码描述了利用 use-after-free 漏洞的技术，包括竞争条件和内存操作。因此，提供的 PoC 代码看起来是有效的。

**投毒风险：**

尽管PoC看起来旨在重现漏洞利用, 但仍然存在一些风险: 
* 仓库名称过于简单，缺乏实质内容, 增加了潜在的风险。
* 描述中存在一些拼写错误（例如：dea），可能是故意为之，以掩盖潜在的恶意代码。
*  通过延迟worker线程方式，增加了不确定性。 
综上所述，作者可能在PoC中加入了一些难以察觉的恶意代码，比如后门或信息收集功能。尽管PoC主要目的是演示漏洞利用，但也不能排除作者恶意投毒的可能性。因此，保守估计投毒风险为10%。建议在使用前进行代码审计。

**项目地址:** [oferchen/POC-CVE-2023-32233](https://github.com/oferchen/POC-CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #6

**来源**: [CVE-2023-32233-void0red_CVE-2023-32233.md](../2023/CVE-2023-32233-void0red_CVE-2023-32233.md)

# CVE-2023-32233

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-32233-Liuk3r_CVE-2023-32233.md](../2023/CVE-2023-32233-Liuk3r_CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter nf_tables Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel Netfilter nf_tables

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** <= 6.3.1

**利用条件:** 需要本地用户权限，目标内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 是 Linux kernel 中 Netfilter nf_tables 组件的 Use-After-Free 漏洞。该漏洞发生在处理批量请求更新 nf_tables 配置时，由于匿名集合处理不当导致。攻击者可以利用此漏洞在内核内存上执行任意读写操作，从而获得 root 权限。 

**漏洞利用有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞利用的有效性较高。搜索引擎结果表明，存在公开的 PoC 代码，并且已被成功利用以实现权限提升。漏洞描述中也明确指出，未授权的本地用户可以利用此漏洞获取 root 权限。

**投毒风险：**
阅读提供的漏洞利用代码片段，主要关注了利用 UAF 漏洞的原理和方法，例如通过竞争条件和内存布局来修改已释放的 `nft_set` 结构体的内容。虽然PoC代码中添加了延时操作和CPU亲和性来增加漏洞触发的概率，但这属于正常的漏洞利用手段，不属于恶意投毒。
投毒风险评估：10%。PoC的主要目的是演示漏洞的可利用性，而非植入后门或执行其他恶意操作。但是，任何未经审核的代码都存在潜在风险，建议在受控环境中测试。

**漏洞利用方式：**
1.  **构造恶意的批量请求：**  攻击者构造包含`NFT_MSG_DELRULE` (删除规则) 和 `NFT_MSG_DELSETELEM` (删除集合元素) 操作的 Netfilter nf_tables 批量请求。
2.  **触发Use-After-Free：**  `NFT_MSG_DELRULE` 操作会释放匿名 `nft_set` 结构体，而随后的 `NFT_MSG_DELSETELEM` 操作会尝试访问已释放的 `nft_set` 结构体，导致 Use-After-Free。
3.  **内存操作：**  攻击者在 `nft_set` 释放后，但在访问之前，尝试重新分配内存并写入特定值，通常是覆盖`set->ops->elemsize`。当后续代码尝试使用已释放的 `nft_set` 结构体时，例如计算偏移量，就会使用被篡改的值，导致访问到错误的内存位置。
4.  **权限提升：**  通过控制内存读写，攻击者可以覆盖内核中的关键数据结构，例如进程的权限信息，从而获得 root 权限。

**项目地址:** [Liuk3r/CVE-2023-32233](https://github.com/Liuk3r/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #2

**来源**: [CVE-2023-32233-PIDAN-HEIDASHUAI_CVE-2023-32233.md](../2023/CVE-2023-32233-PIDAN-HEIDASHUAI_CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel Netfilter nf_tables

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限，需要nf_tables配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 漏洞存在于Linux内核的Netfilter nf_tables子系统中，当处理批量请求以更新nf_tables配置时，会发生use-after-free漏洞。

**漏洞利用有效性:**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，可以判断此漏洞利用是有效的。POC代码描述了利用此漏洞的详细步骤，包括如何触发use-after-free，以及如何赢得与内核后台工作线程的竞争，从而实现可靠的利用。搜索引擎结果中也提到了公开的PoC。

**投毒风险:**
POC代码的目的是演示漏洞利用，并不能完全排除作者隐藏投毒代码的风险。代码中存在一定的复杂性，难以保证完全没有恶意代码。但从代码的功能和目的来看，作为漏洞利用，投毒的可能性较低。对已提供的POC代码进行初步分析，发现并无明显恶意代码，但仍需进一步审查。因此，将投毒风险评估为10%。

**利用方式:**
利用方式如下：
1.  **漏洞触发:** 通过构造恶意的nf_tables批量请求，其中包含删除规则（`NFT_MSG_DELRULE`）和删除集合元素（`NFT_MSG_DELSETELEM`）的操作。
2.  **Use-After-Free:** 删除规则操作会释放匿名集合（`nft_set`）的内存。之后，删除集合元素的操作会尝试访问已释放的内存，从而触发use-after-free漏洞。
3.  **竞争条件:** 攻击者需要与内核后台工作线程`nf_tables_trans_destroy_work()`竞争。为了增加成功率，POC代码会增加延迟，并使其他CPU核心繁忙，从而增加在特定CPU核心上重用已释放内存的机会。
4.  **内存重用:** 攻击者尝试分配新的`nft_set`或其他内核对象来重用已释放的内存。通过精心构造的数据，可以修改`nft_set`中的`ops->elemsize`等关键字段。
5.  **任意读写:**  修改`ops->elemsize`会导致`nft_set_elem_ext`计算出错误的内存地址，最终允许攻击者执行任意内核内存读写操作。
6.  **权限提升:** 攻击者可以使用任意内核内存读写操作来修改进程的凭据（credentials），从而获得root权限。

**项目地址:** [PIDAN-HEIDASHUAI/CVE-2023-32233](https://github.com/PIDAN-HEIDASHUAI/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #3

**来源**: [CVE-2023-32233-RogelioPumajulca_TEST-CVE-2023-32233.md](../2023/CVE-2023-32233-RogelioPumajulca_TEST-CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel Netfilter nf_tables Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限，目标系统运行受影响的Linux内核版本且未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233是Linux内核Netfilter nf_tables组件中的一个使用后释放（Use-After-Free）漏洞。该漏洞发生在处理批量请求更新nf_tables配置时，由于匿名集合处理不当导致。未授权的本地用户可以利用此漏洞在内核内存中执行任意读写操作，从而获得root权限。

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞利用的有效性较高。漏洞库信息表明该漏洞确实存在，并且允许本地提权。搜索引擎结果中也显示存在公开的PoC代码。
提供的PoC代码包含构建和配置说明，以及如何针对不同内核进行调整的指导，包括内核符号地址和机器码的调整。这表明该PoC是经过验证的，并且具有一定的灵活性，可以适应不同的内核版本。

**投毒风险分析：**
分析PoC代码后，发现其中存在一些需要用户手动配置的参数，例如内核符号地址、机器码等。这些参数的配置需要一定的内核知识，如果配置不当，可能会导致PoC无法成功利用，甚至导致系统崩溃。但是，这些配置要求是由于内核版本和编译选项的差异造成的，属于正常情况，并非恶意投毒。
代码中没有发现明显的恶意代码或后门。需要注意的是，PoC本身可能会导致系统不稳定，甚至崩溃，这是利用UAF漏洞的常见风险。因此，在测试PoC时，建议在专用系统上进行，以避免数据损坏。
综合来看，投毒风险较低，大约为10%。主要风险在于PoC本身可能导致系统不稳定。

**利用方式分析：**
1.  **漏洞触发：** 通过精心构造的Netfilter nf_tables批量请求，触发use-after-free漏洞。漏洞的根源在于对匿名集合的处理不当。
2.  **内存破坏：**  利用use-after-free漏洞，在内核内存中执行任意读写操作。这允许攻击者覆盖关键的内核数据结构。
3.  **权限提升：**  通过覆盖`modprobe_path`变量，将执行modprobe的路径修改为攻击者控制的脚本。当内核尝试执行modprobe时，会执行攻击者提供的脚本，从而获得root权限。
4. **代码分析:** exploit.c代码通过利用nf_tables的批量处理机制中的UAF漏洞，精巧地控制内核内存，最终劫持了`modprobe_path`，实现了提权。其中race condition的利用是成功利用漏洞的关键,需要通过调整sleep时间来提高成功率。
5.  **配置需求:**  PoC需要根据不同的内核版本进行配置，包括内核符号地址和机器码的调整，以确保能够正确利用漏洞。

**项目地址:** [RogelioPumajulca/TEST-CVE-2023-32233](https://github.com/RogelioPumajulca/TEST-CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #4

**来源**: [CVE-2023-32233-enlist12_CVE-2023-32233.md](../2023/CVE-2023-32233-enlist12_CVE-2023-32233.md)

## CVE-2023-32233

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel (Netfilter nf_tables)

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-32233是一个Linux内核中的use-after-free漏洞，存在于Netfilter nf_tables子系统中，当处理批量请求时可能被触发。根据漏洞库信息和搜索结果，该漏洞允许未经授权的本地用户通过利用此漏洞在内核内存中执行任意读写操作，从而获得root权限。

**有效性：** 根据搜索结果（例如，来自NSFOCUS CERT的通知），漏洞的PoC代码已被公开披露，表明该漏洞是可以被成功利用的。提供的POC代码片段（myconfig）显示了内核配置选项，例如启用`CONFIG_NETFILTER`，`CONFIG_NF_TABLES`和`User namespaces`，并禁用`CONFIG_WERROR`和`CONFIG_RETPOLINE`。这些配置都是为了便于漏洞的利用，并关闭一些缓解措施。综上，提供的POC代码有效。

**投毒风险：** 分析提供的代码片段：

*   `/README.md`： 包含启用和禁用某些内核配置选项的说明。 这些本身不是恶意代码，而是指示如何配置内核以重现或利用漏洞。
*   `/myconfig`： 这是内核配置文件的摘录，用于构建易受攻击的内核。 它本身也不是恶意代码，但它指定了使系统容易受到攻击的配置。

虽然这些文件本身并没有明显的恶意代码，但是有可能在完整的利用代码中隐藏了某些后门。 由于只提供了部分代码（配置文件和README），因此无法完全排除这种可能性。 这里给出一个较低的概率(5%)表示可能存在投毒代码，但缺乏充分证据。

**利用方式：**

1.  **触发漏洞：** 攻击者需要构造恶意的Netfilter nf_tables批量请求。
2.  **Use-After-Free：**  由于匿名集合处理不当，这会导致use-after-free情况。
3.  **任意读写：** 利用UAF漏洞在内核内存中执行任意读写操作。
4.  **权限提升：**  攻击者可以通过修改内核数据结构来提升自己的权限，最终获得root权限。

**项目地址:** [enlist12/CVE-2023-32233](https://github.com/enlist12/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #5

**来源**: [CVE-2023-32233-oferchen_POC-CVE-2023-32233.md](../2023/CVE-2023-32233-oferchen_POC-CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter nf_tables UAF

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel (Netfilter nf_tables)

**危害等级:** 高危，可导致权限提升

**影响版本:** <= 6.3.1

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 是 Linux 内核 Netfilter nf_tables 组件中的一个使用后释放漏洞。当处理批量请求时，删除规则和规则中的集合元素会导致use-after-free。攻击者可以利用此漏洞在内核内存中执行任意读写操作，从而获得 root 权限。

**漏洞利用方式：**

1.  漏洞存在于 `net/netfilter/nf_tables_api.c` 文件中。
2.  攻击者发送包含两个基本操作的批量请求：
    *   `NFT_MSG_DELRULE`：删除包含匿名 `nft_set` 的 `nft_rule`，这将隐式删除 `lookup` 表达式和匿名 `nft_set`。
    *   `NFT_MSG_DELSETELEM`：删除已删除的匿名 `nft_set` 中的元素。
3.  内核接受批量请求，调用 `nf_tables_commit_release()` 将释放的资源添加到 `nf_tables_destroy_list`。
4.  `nf_tables_trans_destroy_work()` 处理 `nf_tables_destroy_list`，首先通过调用 `nft_commit_release()` -> `nf_tables_rule_destroy()` -> `nf_tables_expr_destroy()` -> `expr->ops->destroy()` (指向 `nft_lookup_destroy()`) -> `nf_tables_destroy_set()` -> `nft_set_destroy()` -> `kvfree()` 释放 `nft_set` 占用的内存。
5.  之后，在处理 `NFT_MSG_DELSETELEM` 操作时，通过 `nft_commit_release()` -> `nf_tables_set_elem_destroy()` -> `nft_set_elem_ext()` 访问已释放的 `nft_set` 内存，导致使用后释放。
6.  `nft_set_elem_ext` 宏尝试访问释放的 `nft_set` 结构中的 `ops->elemsize` 字段，如果该字段被篡改，可能导致访问任意内存地址。
7.  通过竞争 `nf_tables_trans_destroy_work()`，可以尝试在释放的内存被重用之前修改 `nft_set` 的内容。
8.  PoC 通过增加销毁大量元素的 `nft_set` 操作来增加worker线程延迟，并使其他CPU核心繁忙，来增加竞争成功的几率。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞允许本地用户提权，并且存在公开的 PoC 代码。PoC 代码描述了利用 use-after-free 漏洞的技术，包括竞争条件和内存操作。因此，提供的 PoC 代码看起来是有效的。

**投毒风险：**

尽管PoC看起来旨在重现漏洞利用, 但仍然存在一些风险: 
* 仓库名称过于简单，缺乏实质内容, 增加了潜在的风险。
* 描述中存在一些拼写错误（例如：dea），可能是故意为之，以掩盖潜在的恶意代码。
*  通过延迟worker线程方式，增加了不确定性。 
综上所述，作者可能在PoC中加入了一些难以察觉的恶意代码，比如后门或信息收集功能。尽管PoC主要目的是演示漏洞利用，但也不能排除作者恶意投毒的可能性。因此，保守估计投毒风险为10%。建议在使用前进行代码审计。

**项目地址:** [oferchen/POC-CVE-2023-32233](https://github.com/oferchen/POC-CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #6

**来源**: [CVE-2023-32233-void0red_CVE-2023-32233.md](../2023/CVE-2023-32233-void0red_CVE-2023-32233.md)

# CVE-2023-32233

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-32233-Liuk3r_CVE-2023-32233.md](../2023/CVE-2023-32233-Liuk3r_CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter nf_tables Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel Netfilter nf_tables

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** <= 6.3.1

**利用条件:** 需要本地用户权限，目标内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 是 Linux kernel 中 Netfilter nf_tables 组件的 Use-After-Free 漏洞。该漏洞发生在处理批量请求更新 nf_tables 配置时，由于匿名集合处理不当导致。攻击者可以利用此漏洞在内核内存上执行任意读写操作，从而获得 root 权限。 

**漏洞利用有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞利用的有效性较高。搜索引擎结果表明，存在公开的 PoC 代码，并且已被成功利用以实现权限提升。漏洞描述中也明确指出，未授权的本地用户可以利用此漏洞获取 root 权限。

**投毒风险：**
阅读提供的漏洞利用代码片段，主要关注了利用 UAF 漏洞的原理和方法，例如通过竞争条件和内存布局来修改已释放的 `nft_set` 结构体的内容。虽然PoC代码中添加了延时操作和CPU亲和性来增加漏洞触发的概率，但这属于正常的漏洞利用手段，不属于恶意投毒。
投毒风险评估：10%。PoC的主要目的是演示漏洞的可利用性，而非植入后门或执行其他恶意操作。但是，任何未经审核的代码都存在潜在风险，建议在受控环境中测试。

**漏洞利用方式：**
1.  **构造恶意的批量请求：**  攻击者构造包含`NFT_MSG_DELRULE` (删除规则) 和 `NFT_MSG_DELSETELEM` (删除集合元素) 操作的 Netfilter nf_tables 批量请求。
2.  **触发Use-After-Free：**  `NFT_MSG_DELRULE` 操作会释放匿名 `nft_set` 结构体，而随后的 `NFT_MSG_DELSETELEM` 操作会尝试访问已释放的 `nft_set` 结构体，导致 Use-After-Free。
3.  **内存操作：**  攻击者在 `nft_set` 释放后，但在访问之前，尝试重新分配内存并写入特定值，通常是覆盖`set->ops->elemsize`。当后续代码尝试使用已释放的 `nft_set` 结构体时，例如计算偏移量，就会使用被篡改的值，导致访问到错误的内存位置。
4.  **权限提升：**  通过控制内存读写，攻击者可以覆盖内核中的关键数据结构，例如进程的权限信息，从而获得 root 权限。

**项目地址:** [Liuk3r/CVE-2023-32233](https://github.com/Liuk3r/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #2

**来源**: [CVE-2023-32233-PIDAN-HEIDASHUAI_CVE-2023-32233.md](../2023/CVE-2023-32233-PIDAN-HEIDASHUAI_CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel Netfilter nf_tables

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限，需要nf_tables配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 漏洞存在于Linux内核的Netfilter nf_tables子系统中，当处理批量请求以更新nf_tables配置时，会发生use-after-free漏洞。

**漏洞利用有效性:**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，可以判断此漏洞利用是有效的。POC代码描述了利用此漏洞的详细步骤，包括如何触发use-after-free，以及如何赢得与内核后台工作线程的竞争，从而实现可靠的利用。搜索引擎结果中也提到了公开的PoC。

**投毒风险:**
POC代码的目的是演示漏洞利用，并不能完全排除作者隐藏投毒代码的风险。代码中存在一定的复杂性，难以保证完全没有恶意代码。但从代码的功能和目的来看，作为漏洞利用，投毒的可能性较低。对已提供的POC代码进行初步分析，发现并无明显恶意代码，但仍需进一步审查。因此，将投毒风险评估为10%。

**利用方式:**
利用方式如下：
1.  **漏洞触发:** 通过构造恶意的nf_tables批量请求，其中包含删除规则（`NFT_MSG_DELRULE`）和删除集合元素（`NFT_MSG_DELSETELEM`）的操作。
2.  **Use-After-Free:** 删除规则操作会释放匿名集合（`nft_set`）的内存。之后，删除集合元素的操作会尝试访问已释放的内存，从而触发use-after-free漏洞。
3.  **竞争条件:** 攻击者需要与内核后台工作线程`nf_tables_trans_destroy_work()`竞争。为了增加成功率，POC代码会增加延迟，并使其他CPU核心繁忙，从而增加在特定CPU核心上重用已释放内存的机会。
4.  **内存重用:** 攻击者尝试分配新的`nft_set`或其他内核对象来重用已释放的内存。通过精心构造的数据，可以修改`nft_set`中的`ops->elemsize`等关键字段。
5.  **任意读写:**  修改`ops->elemsize`会导致`nft_set_elem_ext`计算出错误的内存地址，最终允许攻击者执行任意内核内存读写操作。
6.  **权限提升:** 攻击者可以使用任意内核内存读写操作来修改进程的凭据（credentials），从而获得root权限。

**项目地址:** [PIDAN-HEIDASHUAI/CVE-2023-32233](https://github.com/PIDAN-HEIDASHUAI/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #3

**来源**: [CVE-2023-32233-RogelioPumajulca_TEST-CVE-2023-32233.md](../2023/CVE-2023-32233-RogelioPumajulca_TEST-CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel Netfilter nf_tables Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限，目标系统运行受影响的Linux内核版本且未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233是Linux内核Netfilter nf_tables组件中的一个使用后释放（Use-After-Free）漏洞。该漏洞发生在处理批量请求更新nf_tables配置时，由于匿名集合处理不当导致。未授权的本地用户可以利用此漏洞在内核内存中执行任意读写操作，从而获得root权限。

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞利用的有效性较高。漏洞库信息表明该漏洞确实存在，并且允许本地提权。搜索引擎结果中也显示存在公开的PoC代码。
提供的PoC代码包含构建和配置说明，以及如何针对不同内核进行调整的指导，包括内核符号地址和机器码的调整。这表明该PoC是经过验证的，并且具有一定的灵活性，可以适应不同的内核版本。

**投毒风险分析：**
分析PoC代码后，发现其中存在一些需要用户手动配置的参数，例如内核符号地址、机器码等。这些参数的配置需要一定的内核知识，如果配置不当，可能会导致PoC无法成功利用，甚至导致系统崩溃。但是，这些配置要求是由于内核版本和编译选项的差异造成的，属于正常情况，并非恶意投毒。
代码中没有发现明显的恶意代码或后门。需要注意的是，PoC本身可能会导致系统不稳定，甚至崩溃，这是利用UAF漏洞的常见风险。因此，在测试PoC时，建议在专用系统上进行，以避免数据损坏。
综合来看，投毒风险较低，大约为10%。主要风险在于PoC本身可能导致系统不稳定。

**利用方式分析：**
1.  **漏洞触发：** 通过精心构造的Netfilter nf_tables批量请求，触发use-after-free漏洞。漏洞的根源在于对匿名集合的处理不当。
2.  **内存破坏：**  利用use-after-free漏洞，在内核内存中执行任意读写操作。这允许攻击者覆盖关键的内核数据结构。
3.  **权限提升：**  通过覆盖`modprobe_path`变量，将执行modprobe的路径修改为攻击者控制的脚本。当内核尝试执行modprobe时，会执行攻击者提供的脚本，从而获得root权限。
4. **代码分析:** exploit.c代码通过利用nf_tables的批量处理机制中的UAF漏洞，精巧地控制内核内存，最终劫持了`modprobe_path`，实现了提权。其中race condition的利用是成功利用漏洞的关键,需要通过调整sleep时间来提高成功率。
5.  **配置需求:**  PoC需要根据不同的内核版本进行配置，包括内核符号地址和机器码的调整，以确保能够正确利用漏洞。

**项目地址:** [RogelioPumajulca/TEST-CVE-2023-32233](https://github.com/RogelioPumajulca/TEST-CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #4

**来源**: [CVE-2023-32233-enlist12_CVE-2023-32233.md](../2023/CVE-2023-32233-enlist12_CVE-2023-32233.md)

## CVE-2023-32233

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel (Netfilter nf_tables)

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-32233是一个Linux内核中的use-after-free漏洞，存在于Netfilter nf_tables子系统中，当处理批量请求时可能被触发。根据漏洞库信息和搜索结果，该漏洞允许未经授权的本地用户通过利用此漏洞在内核内存中执行任意读写操作，从而获得root权限。

**有效性：** 根据搜索结果（例如，来自NSFOCUS CERT的通知），漏洞的PoC代码已被公开披露，表明该漏洞是可以被成功利用的。提供的POC代码片段（myconfig）显示了内核配置选项，例如启用`CONFIG_NETFILTER`，`CONFIG_NF_TABLES`和`User namespaces`，并禁用`CONFIG_WERROR`和`CONFIG_RETPOLINE`。这些配置都是为了便于漏洞的利用，并关闭一些缓解措施。综上，提供的POC代码有效。

**投毒风险：** 分析提供的代码片段：

*   `/README.md`： 包含启用和禁用某些内核配置选项的说明。 这些本身不是恶意代码，而是指示如何配置内核以重现或利用漏洞。
*   `/myconfig`： 这是内核配置文件的摘录，用于构建易受攻击的内核。 它本身也不是恶意代码，但它指定了使系统容易受到攻击的配置。

虽然这些文件本身并没有明显的恶意代码，但是有可能在完整的利用代码中隐藏了某些后门。 由于只提供了部分代码（配置文件和README），因此无法完全排除这种可能性。 这里给出一个较低的概率(5%)表示可能存在投毒代码，但缺乏充分证据。

**利用方式：**

1.  **触发漏洞：** 攻击者需要构造恶意的Netfilter nf_tables批量请求。
2.  **Use-After-Free：**  由于匿名集合处理不当，这会导致use-after-free情况。
3.  **任意读写：** 利用UAF漏洞在内核内存中执行任意读写操作。
4.  **权限提升：**  攻击者可以通过修改内核数据结构来提升自己的权限，最终获得root权限。

**项目地址:** [enlist12/CVE-2023-32233](https://github.com/enlist12/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #5

**来源**: [CVE-2023-32233-oferchen_POC-CVE-2023-32233.md](../2023/CVE-2023-32233-oferchen_POC-CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter nf_tables UAF

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel (Netfilter nf_tables)

**危害等级:** 高危，可导致权限提升

**影响版本:** <= 6.3.1

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 是 Linux 内核 Netfilter nf_tables 组件中的一个使用后释放漏洞。当处理批量请求时，删除规则和规则中的集合元素会导致use-after-free。攻击者可以利用此漏洞在内核内存中执行任意读写操作，从而获得 root 权限。

**漏洞利用方式：**

1.  漏洞存在于 `net/netfilter/nf_tables_api.c` 文件中。
2.  攻击者发送包含两个基本操作的批量请求：
    *   `NFT_MSG_DELRULE`：删除包含匿名 `nft_set` 的 `nft_rule`，这将隐式删除 `lookup` 表达式和匿名 `nft_set`。
    *   `NFT_MSG_DELSETELEM`：删除已删除的匿名 `nft_set` 中的元素。
3.  内核接受批量请求，调用 `nf_tables_commit_release()` 将释放的资源添加到 `nf_tables_destroy_list`。
4.  `nf_tables_trans_destroy_work()` 处理 `nf_tables_destroy_list`，首先通过调用 `nft_commit_release()` -> `nf_tables_rule_destroy()` -> `nf_tables_expr_destroy()` -> `expr->ops->destroy()` (指向 `nft_lookup_destroy()`) -> `nf_tables_destroy_set()` -> `nft_set_destroy()` -> `kvfree()` 释放 `nft_set` 占用的内存。
5.  之后，在处理 `NFT_MSG_DELSETELEM` 操作时，通过 `nft_commit_release()` -> `nf_tables_set_elem_destroy()` -> `nft_set_elem_ext()` 访问已释放的 `nft_set` 内存，导致使用后释放。
6.  `nft_set_elem_ext` 宏尝试访问释放的 `nft_set` 结构中的 `ops->elemsize` 字段，如果该字段被篡改，可能导致访问任意内存地址。
7.  通过竞争 `nf_tables_trans_destroy_work()`，可以尝试在释放的内存被重用之前修改 `nft_set` 的内容。
8.  PoC 通过增加销毁大量元素的 `nft_set` 操作来增加worker线程延迟，并使其他CPU核心繁忙，来增加竞争成功的几率。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞允许本地用户提权，并且存在公开的 PoC 代码。PoC 代码描述了利用 use-after-free 漏洞的技术，包括竞争条件和内存操作。因此，提供的 PoC 代码看起来是有效的。

**投毒风险：**

尽管PoC看起来旨在重现漏洞利用, 但仍然存在一些风险: 
* 仓库名称过于简单，缺乏实质内容, 增加了潜在的风险。
* 描述中存在一些拼写错误（例如：dea），可能是故意为之，以掩盖潜在的恶意代码。
*  通过延迟worker线程方式，增加了不确定性。 
综上所述，作者可能在PoC中加入了一些难以察觉的恶意代码，比如后门或信息收集功能。尽管PoC主要目的是演示漏洞利用，但也不能排除作者恶意投毒的可能性。因此，保守估计投毒风险为10%。建议在使用前进行代码审计。

**项目地址:** [oferchen/POC-CVE-2023-32233](https://github.com/oferchen/POC-CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #6

**来源**: [CVE-2023-32233-void0red_CVE-2023-32233.md](../2023/CVE-2023-32233-void0red_CVE-2023-32233.md)

# CVE-2023-32233

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-32233-Liuk3r_CVE-2023-32233.md](../2023/CVE-2023-32233-Liuk3r_CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter nf_tables Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel Netfilter nf_tables

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** <= 6.3.1

**利用条件:** 需要本地用户权限，目标内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 是 Linux kernel 中 Netfilter nf_tables 组件的 Use-After-Free 漏洞。该漏洞发生在处理批量请求更新 nf_tables 配置时，由于匿名集合处理不当导致。攻击者可以利用此漏洞在内核内存上执行任意读写操作，从而获得 root 权限。 

**漏洞利用有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞利用的有效性较高。搜索引擎结果表明，存在公开的 PoC 代码，并且已被成功利用以实现权限提升。漏洞描述中也明确指出，未授权的本地用户可以利用此漏洞获取 root 权限。

**投毒风险：**
阅读提供的漏洞利用代码片段，主要关注了利用 UAF 漏洞的原理和方法，例如通过竞争条件和内存布局来修改已释放的 `nft_set` 结构体的内容。虽然PoC代码中添加了延时操作和CPU亲和性来增加漏洞触发的概率，但这属于正常的漏洞利用手段，不属于恶意投毒。
投毒风险评估：10%。PoC的主要目的是演示漏洞的可利用性，而非植入后门或执行其他恶意操作。但是，任何未经审核的代码都存在潜在风险，建议在受控环境中测试。

**漏洞利用方式：**
1.  **构造恶意的批量请求：**  攻击者构造包含`NFT_MSG_DELRULE` (删除规则) 和 `NFT_MSG_DELSETELEM` (删除集合元素) 操作的 Netfilter nf_tables 批量请求。
2.  **触发Use-After-Free：**  `NFT_MSG_DELRULE` 操作会释放匿名 `nft_set` 结构体，而随后的 `NFT_MSG_DELSETELEM` 操作会尝试访问已释放的 `nft_set` 结构体，导致 Use-After-Free。
3.  **内存操作：**  攻击者在 `nft_set` 释放后，但在访问之前，尝试重新分配内存并写入特定值，通常是覆盖`set->ops->elemsize`。当后续代码尝试使用已释放的 `nft_set` 结构体时，例如计算偏移量，就会使用被篡改的值，导致访问到错误的内存位置。
4.  **权限提升：**  通过控制内存读写，攻击者可以覆盖内核中的关键数据结构，例如进程的权限信息，从而获得 root 权限。

**项目地址:** [Liuk3r/CVE-2023-32233](https://github.com/Liuk3r/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #2

**来源**: [CVE-2023-32233-PIDAN-HEIDASHUAI_CVE-2023-32233.md](../2023/CVE-2023-32233-PIDAN-HEIDASHUAI_CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel Netfilter nf_tables

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限，需要nf_tables配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 漏洞存在于Linux内核的Netfilter nf_tables子系统中，当处理批量请求以更新nf_tables配置时，会发生use-after-free漏洞。

**漏洞利用有效性:**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，可以判断此漏洞利用是有效的。POC代码描述了利用此漏洞的详细步骤，包括如何触发use-after-free，以及如何赢得与内核后台工作线程的竞争，从而实现可靠的利用。搜索引擎结果中也提到了公开的PoC。

**投毒风险:**
POC代码的目的是演示漏洞利用，并不能完全排除作者隐藏投毒代码的风险。代码中存在一定的复杂性，难以保证完全没有恶意代码。但从代码的功能和目的来看，作为漏洞利用，投毒的可能性较低。对已提供的POC代码进行初步分析，发现并无明显恶意代码，但仍需进一步审查。因此，将投毒风险评估为10%。

**利用方式:**
利用方式如下：
1.  **漏洞触发:** 通过构造恶意的nf_tables批量请求，其中包含删除规则（`NFT_MSG_DELRULE`）和删除集合元素（`NFT_MSG_DELSETELEM`）的操作。
2.  **Use-After-Free:** 删除规则操作会释放匿名集合（`nft_set`）的内存。之后，删除集合元素的操作会尝试访问已释放的内存，从而触发use-after-free漏洞。
3.  **竞争条件:** 攻击者需要与内核后台工作线程`nf_tables_trans_destroy_work()`竞争。为了增加成功率，POC代码会增加延迟，并使其他CPU核心繁忙，从而增加在特定CPU核心上重用已释放内存的机会。
4.  **内存重用:** 攻击者尝试分配新的`nft_set`或其他内核对象来重用已释放的内存。通过精心构造的数据，可以修改`nft_set`中的`ops->elemsize`等关键字段。
5.  **任意读写:**  修改`ops->elemsize`会导致`nft_set_elem_ext`计算出错误的内存地址，最终允许攻击者执行任意内核内存读写操作。
6.  **权限提升:** 攻击者可以使用任意内核内存读写操作来修改进程的凭据（credentials），从而获得root权限。

**项目地址:** [PIDAN-HEIDASHUAI/CVE-2023-32233](https://github.com/PIDAN-HEIDASHUAI/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #3

**来源**: [CVE-2023-32233-RogelioPumajulca_TEST-CVE-2023-32233.md](../2023/CVE-2023-32233-RogelioPumajulca_TEST-CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel Netfilter nf_tables Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限，目标系统运行受影响的Linux内核版本且未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233是Linux内核Netfilter nf_tables组件中的一个使用后释放（Use-After-Free）漏洞。该漏洞发生在处理批量请求更新nf_tables配置时，由于匿名集合处理不当导致。未授权的本地用户可以利用此漏洞在内核内存中执行任意读写操作，从而获得root权限。

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞利用的有效性较高。漏洞库信息表明该漏洞确实存在，并且允许本地提权。搜索引擎结果中也显示存在公开的PoC代码。
提供的PoC代码包含构建和配置说明，以及如何针对不同内核进行调整的指导，包括内核符号地址和机器码的调整。这表明该PoC是经过验证的，并且具有一定的灵活性，可以适应不同的内核版本。

**投毒风险分析：**
分析PoC代码后，发现其中存在一些需要用户手动配置的参数，例如内核符号地址、机器码等。这些参数的配置需要一定的内核知识，如果配置不当，可能会导致PoC无法成功利用，甚至导致系统崩溃。但是，这些配置要求是由于内核版本和编译选项的差异造成的，属于正常情况，并非恶意投毒。
代码中没有发现明显的恶意代码或后门。需要注意的是，PoC本身可能会导致系统不稳定，甚至崩溃，这是利用UAF漏洞的常见风险。因此，在测试PoC时，建议在专用系统上进行，以避免数据损坏。
综合来看，投毒风险较低，大约为10%。主要风险在于PoC本身可能导致系统不稳定。

**利用方式分析：**
1.  **漏洞触发：** 通过精心构造的Netfilter nf_tables批量请求，触发use-after-free漏洞。漏洞的根源在于对匿名集合的处理不当。
2.  **内存破坏：**  利用use-after-free漏洞，在内核内存中执行任意读写操作。这允许攻击者覆盖关键的内核数据结构。
3.  **权限提升：**  通过覆盖`modprobe_path`变量，将执行modprobe的路径修改为攻击者控制的脚本。当内核尝试执行modprobe时，会执行攻击者提供的脚本，从而获得root权限。
4. **代码分析:** exploit.c代码通过利用nf_tables的批量处理机制中的UAF漏洞，精巧地控制内核内存，最终劫持了`modprobe_path`，实现了提权。其中race condition的利用是成功利用漏洞的关键,需要通过调整sleep时间来提高成功率。
5.  **配置需求:**  PoC需要根据不同的内核版本进行配置，包括内核符号地址和机器码的调整，以确保能够正确利用漏洞。

**项目地址:** [RogelioPumajulca/TEST-CVE-2023-32233](https://github.com/RogelioPumajulca/TEST-CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #4

**来源**: [CVE-2023-32233-enlist12_CVE-2023-32233.md](../2023/CVE-2023-32233-enlist12_CVE-2023-32233.md)

## CVE-2023-32233

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel (Netfilter nf_tables)

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-32233是一个Linux内核中的use-after-free漏洞，存在于Netfilter nf_tables子系统中，当处理批量请求时可能被触发。根据漏洞库信息和搜索结果，该漏洞允许未经授权的本地用户通过利用此漏洞在内核内存中执行任意读写操作，从而获得root权限。

**有效性：** 根据搜索结果（例如，来自NSFOCUS CERT的通知），漏洞的PoC代码已被公开披露，表明该漏洞是可以被成功利用的。提供的POC代码片段（myconfig）显示了内核配置选项，例如启用`CONFIG_NETFILTER`，`CONFIG_NF_TABLES`和`User namespaces`，并禁用`CONFIG_WERROR`和`CONFIG_RETPOLINE`。这些配置都是为了便于漏洞的利用，并关闭一些缓解措施。综上，提供的POC代码有效。

**投毒风险：** 分析提供的代码片段：

*   `/README.md`： 包含启用和禁用某些内核配置选项的说明。 这些本身不是恶意代码，而是指示如何配置内核以重现或利用漏洞。
*   `/myconfig`： 这是内核配置文件的摘录，用于构建易受攻击的内核。 它本身也不是恶意代码，但它指定了使系统容易受到攻击的配置。

虽然这些文件本身并没有明显的恶意代码，但是有可能在完整的利用代码中隐藏了某些后门。 由于只提供了部分代码（配置文件和README），因此无法完全排除这种可能性。 这里给出一个较低的概率(5%)表示可能存在投毒代码，但缺乏充分证据。

**利用方式：**

1.  **触发漏洞：** 攻击者需要构造恶意的Netfilter nf_tables批量请求。
2.  **Use-After-Free：**  由于匿名集合处理不当，这会导致use-after-free情况。
3.  **任意读写：** 利用UAF漏洞在内核内存中执行任意读写操作。
4.  **权限提升：**  攻击者可以通过修改内核数据结构来提升自己的权限，最终获得root权限。

**项目地址:** [enlist12/CVE-2023-32233](https://github.com/enlist12/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #5

**来源**: [CVE-2023-32233-oferchen_POC-CVE-2023-32233.md](../2023/CVE-2023-32233-oferchen_POC-CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter nf_tables UAF

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel (Netfilter nf_tables)

**危害等级:** 高危，可导致权限提升

**影响版本:** <= 6.3.1

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 是 Linux 内核 Netfilter nf_tables 组件中的一个使用后释放漏洞。当处理批量请求时，删除规则和规则中的集合元素会导致use-after-free。攻击者可以利用此漏洞在内核内存中执行任意读写操作，从而获得 root 权限。

**漏洞利用方式：**

1.  漏洞存在于 `net/netfilter/nf_tables_api.c` 文件中。
2.  攻击者发送包含两个基本操作的批量请求：
    *   `NFT_MSG_DELRULE`：删除包含匿名 `nft_set` 的 `nft_rule`，这将隐式删除 `lookup` 表达式和匿名 `nft_set`。
    *   `NFT_MSG_DELSETELEM`：删除已删除的匿名 `nft_set` 中的元素。
3.  内核接受批量请求，调用 `nf_tables_commit_release()` 将释放的资源添加到 `nf_tables_destroy_list`。
4.  `nf_tables_trans_destroy_work()` 处理 `nf_tables_destroy_list`，首先通过调用 `nft_commit_release()` -> `nf_tables_rule_destroy()` -> `nf_tables_expr_destroy()` -> `expr->ops->destroy()` (指向 `nft_lookup_destroy()`) -> `nf_tables_destroy_set()` -> `nft_set_destroy()` -> `kvfree()` 释放 `nft_set` 占用的内存。
5.  之后，在处理 `NFT_MSG_DELSETELEM` 操作时，通过 `nft_commit_release()` -> `nf_tables_set_elem_destroy()` -> `nft_set_elem_ext()` 访问已释放的 `nft_set` 内存，导致使用后释放。
6.  `nft_set_elem_ext` 宏尝试访问释放的 `nft_set` 结构中的 `ops->elemsize` 字段，如果该字段被篡改，可能导致访问任意内存地址。
7.  通过竞争 `nf_tables_trans_destroy_work()`，可以尝试在释放的内存被重用之前修改 `nft_set` 的内容。
8.  PoC 通过增加销毁大量元素的 `nft_set` 操作来增加worker线程延迟，并使其他CPU核心繁忙，来增加竞争成功的几率。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞允许本地用户提权，并且存在公开的 PoC 代码。PoC 代码描述了利用 use-after-free 漏洞的技术，包括竞争条件和内存操作。因此，提供的 PoC 代码看起来是有效的。

**投毒风险：**

尽管PoC看起来旨在重现漏洞利用, 但仍然存在一些风险: 
* 仓库名称过于简单，缺乏实质内容, 增加了潜在的风险。
* 描述中存在一些拼写错误（例如：dea），可能是故意为之，以掩盖潜在的恶意代码。
*  通过延迟worker线程方式，增加了不确定性。 
综上所述，作者可能在PoC中加入了一些难以察觉的恶意代码，比如后门或信息收集功能。尽管PoC主要目的是演示漏洞利用，但也不能排除作者恶意投毒的可能性。因此，保守估计投毒风险为10%。建议在使用前进行代码审计。

**项目地址:** [oferchen/POC-CVE-2023-32233](https://github.com/oferchen/POC-CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #6

**来源**: [CVE-2023-32233-void0red_CVE-2023-32233.md](../2023/CVE-2023-32233-void0red_CVE-2023-32233.md)

# CVE-2023-32233

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-32233-Liuk3r_CVE-2023-32233.md](../2023/CVE-2023-32233-Liuk3r_CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter nf_tables Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel Netfilter nf_tables

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** <= 6.3.1

**利用条件:** 需要本地用户权限，目标内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 是 Linux kernel 中 Netfilter nf_tables 组件的 Use-After-Free 漏洞。该漏洞发生在处理批量请求更新 nf_tables 配置时，由于匿名集合处理不当导致。攻击者可以利用此漏洞在内核内存上执行任意读写操作，从而获得 root 权限。 

**漏洞利用有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞利用的有效性较高。搜索引擎结果表明，存在公开的 PoC 代码，并且已被成功利用以实现权限提升。漏洞描述中也明确指出，未授权的本地用户可以利用此漏洞获取 root 权限。

**投毒风险：**
阅读提供的漏洞利用代码片段，主要关注了利用 UAF 漏洞的原理和方法，例如通过竞争条件和内存布局来修改已释放的 `nft_set` 结构体的内容。虽然PoC代码中添加了延时操作和CPU亲和性来增加漏洞触发的概率，但这属于正常的漏洞利用手段，不属于恶意投毒。
投毒风险评估：10%。PoC的主要目的是演示漏洞的可利用性，而非植入后门或执行其他恶意操作。但是，任何未经审核的代码都存在潜在风险，建议在受控环境中测试。

**漏洞利用方式：**
1.  **构造恶意的批量请求：**  攻击者构造包含`NFT_MSG_DELRULE` (删除规则) 和 `NFT_MSG_DELSETELEM` (删除集合元素) 操作的 Netfilter nf_tables 批量请求。
2.  **触发Use-After-Free：**  `NFT_MSG_DELRULE` 操作会释放匿名 `nft_set` 结构体，而随后的 `NFT_MSG_DELSETELEM` 操作会尝试访问已释放的 `nft_set` 结构体，导致 Use-After-Free。
3.  **内存操作：**  攻击者在 `nft_set` 释放后，但在访问之前，尝试重新分配内存并写入特定值，通常是覆盖`set->ops->elemsize`。当后续代码尝试使用已释放的 `nft_set` 结构体时，例如计算偏移量，就会使用被篡改的值，导致访问到错误的内存位置。
4.  **权限提升：**  通过控制内存读写，攻击者可以覆盖内核中的关键数据结构，例如进程的权限信息，从而获得 root 权限。

**项目地址:** [Liuk3r/CVE-2023-32233](https://github.com/Liuk3r/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #2

**来源**: [CVE-2023-32233-PIDAN-HEIDASHUAI_CVE-2023-32233.md](../2023/CVE-2023-32233-PIDAN-HEIDASHUAI_CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel Netfilter nf_tables

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限，需要nf_tables配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 漏洞存在于Linux内核的Netfilter nf_tables子系统中，当处理批量请求以更新nf_tables配置时，会发生use-after-free漏洞。

**漏洞利用有效性:**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，可以判断此漏洞利用是有效的。POC代码描述了利用此漏洞的详细步骤，包括如何触发use-after-free，以及如何赢得与内核后台工作线程的竞争，从而实现可靠的利用。搜索引擎结果中也提到了公开的PoC。

**投毒风险:**
POC代码的目的是演示漏洞利用，并不能完全排除作者隐藏投毒代码的风险。代码中存在一定的复杂性，难以保证完全没有恶意代码。但从代码的功能和目的来看，作为漏洞利用，投毒的可能性较低。对已提供的POC代码进行初步分析，发现并无明显恶意代码，但仍需进一步审查。因此，将投毒风险评估为10%。

**利用方式:**
利用方式如下：
1.  **漏洞触发:** 通过构造恶意的nf_tables批量请求，其中包含删除规则（`NFT_MSG_DELRULE`）和删除集合元素（`NFT_MSG_DELSETELEM`）的操作。
2.  **Use-After-Free:** 删除规则操作会释放匿名集合（`nft_set`）的内存。之后，删除集合元素的操作会尝试访问已释放的内存，从而触发use-after-free漏洞。
3.  **竞争条件:** 攻击者需要与内核后台工作线程`nf_tables_trans_destroy_work()`竞争。为了增加成功率，POC代码会增加延迟，并使其他CPU核心繁忙，从而增加在特定CPU核心上重用已释放内存的机会。
4.  **内存重用:** 攻击者尝试分配新的`nft_set`或其他内核对象来重用已释放的内存。通过精心构造的数据，可以修改`nft_set`中的`ops->elemsize`等关键字段。
5.  **任意读写:**  修改`ops->elemsize`会导致`nft_set_elem_ext`计算出错误的内存地址，最终允许攻击者执行任意内核内存读写操作。
6.  **权限提升:** 攻击者可以使用任意内核内存读写操作来修改进程的凭据（credentials），从而获得root权限。

**项目地址:** [PIDAN-HEIDASHUAI/CVE-2023-32233](https://github.com/PIDAN-HEIDASHUAI/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #3

**来源**: [CVE-2023-32233-RogelioPumajulca_TEST-CVE-2023-32233.md](../2023/CVE-2023-32233-RogelioPumajulca_TEST-CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel Netfilter nf_tables Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限，目标系统运行受影响的Linux内核版本且未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233是Linux内核Netfilter nf_tables组件中的一个使用后释放（Use-After-Free）漏洞。该漏洞发生在处理批量请求更新nf_tables配置时，由于匿名集合处理不当导致。未授权的本地用户可以利用此漏洞在内核内存中执行任意读写操作，从而获得root权限。

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞利用的有效性较高。漏洞库信息表明该漏洞确实存在，并且允许本地提权。搜索引擎结果中也显示存在公开的PoC代码。
提供的PoC代码包含构建和配置说明，以及如何针对不同内核进行调整的指导，包括内核符号地址和机器码的调整。这表明该PoC是经过验证的，并且具有一定的灵活性，可以适应不同的内核版本。

**投毒风险分析：**
分析PoC代码后，发现其中存在一些需要用户手动配置的参数，例如内核符号地址、机器码等。这些参数的配置需要一定的内核知识，如果配置不当，可能会导致PoC无法成功利用，甚至导致系统崩溃。但是，这些配置要求是由于内核版本和编译选项的差异造成的，属于正常情况，并非恶意投毒。
代码中没有发现明显的恶意代码或后门。需要注意的是，PoC本身可能会导致系统不稳定，甚至崩溃，这是利用UAF漏洞的常见风险。因此，在测试PoC时，建议在专用系统上进行，以避免数据损坏。
综合来看，投毒风险较低，大约为10%。主要风险在于PoC本身可能导致系统不稳定。

**利用方式分析：**
1.  **漏洞触发：** 通过精心构造的Netfilter nf_tables批量请求，触发use-after-free漏洞。漏洞的根源在于对匿名集合的处理不当。
2.  **内存破坏：**  利用use-after-free漏洞，在内核内存中执行任意读写操作。这允许攻击者覆盖关键的内核数据结构。
3.  **权限提升：**  通过覆盖`modprobe_path`变量，将执行modprobe的路径修改为攻击者控制的脚本。当内核尝试执行modprobe时，会执行攻击者提供的脚本，从而获得root权限。
4. **代码分析:** exploit.c代码通过利用nf_tables的批量处理机制中的UAF漏洞，精巧地控制内核内存，最终劫持了`modprobe_path`，实现了提权。其中race condition的利用是成功利用漏洞的关键,需要通过调整sleep时间来提高成功率。
5.  **配置需求:**  PoC需要根据不同的内核版本进行配置，包括内核符号地址和机器码的调整，以确保能够正确利用漏洞。

**项目地址:** [RogelioPumajulca/TEST-CVE-2023-32233](https://github.com/RogelioPumajulca/TEST-CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #4

**来源**: [CVE-2023-32233-enlist12_CVE-2023-32233.md](../2023/CVE-2023-32233-enlist12_CVE-2023-32233.md)

## CVE-2023-32233

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel (Netfilter nf_tables)

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-32233是一个Linux内核中的use-after-free漏洞，存在于Netfilter nf_tables子系统中，当处理批量请求时可能被触发。根据漏洞库信息和搜索结果，该漏洞允许未经授权的本地用户通过利用此漏洞在内核内存中执行任意读写操作，从而获得root权限。

**有效性：** 根据搜索结果（例如，来自NSFOCUS CERT的通知），漏洞的PoC代码已被公开披露，表明该漏洞是可以被成功利用的。提供的POC代码片段（myconfig）显示了内核配置选项，例如启用`CONFIG_NETFILTER`，`CONFIG_NF_TABLES`和`User namespaces`，并禁用`CONFIG_WERROR`和`CONFIG_RETPOLINE`。这些配置都是为了便于漏洞的利用，并关闭一些缓解措施。综上，提供的POC代码有效。

**投毒风险：** 分析提供的代码片段：

*   `/README.md`： 包含启用和禁用某些内核配置选项的说明。 这些本身不是恶意代码，而是指示如何配置内核以重现或利用漏洞。
*   `/myconfig`： 这是内核配置文件的摘录，用于构建易受攻击的内核。 它本身也不是恶意代码，但它指定了使系统容易受到攻击的配置。

虽然这些文件本身并没有明显的恶意代码，但是有可能在完整的利用代码中隐藏了某些后门。 由于只提供了部分代码（配置文件和README），因此无法完全排除这种可能性。 这里给出一个较低的概率(5%)表示可能存在投毒代码，但缺乏充分证据。

**利用方式：**

1.  **触发漏洞：** 攻击者需要构造恶意的Netfilter nf_tables批量请求。
2.  **Use-After-Free：**  由于匿名集合处理不当，这会导致use-after-free情况。
3.  **任意读写：** 利用UAF漏洞在内核内存中执行任意读写操作。
4.  **权限提升：**  攻击者可以通过修改内核数据结构来提升自己的权限，最终获得root权限。

**项目地址:** [enlist12/CVE-2023-32233](https://github.com/enlist12/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #5

**来源**: [CVE-2023-32233-oferchen_POC-CVE-2023-32233.md](../2023/CVE-2023-32233-oferchen_POC-CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter nf_tables UAF

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel (Netfilter nf_tables)

**危害等级:** 高危，可导致权限提升

**影响版本:** <= 6.3.1

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 是 Linux 内核 Netfilter nf_tables 组件中的一个使用后释放漏洞。当处理批量请求时，删除规则和规则中的集合元素会导致use-after-free。攻击者可以利用此漏洞在内核内存中执行任意读写操作，从而获得 root 权限。

**漏洞利用方式：**

1.  漏洞存在于 `net/netfilter/nf_tables_api.c` 文件中。
2.  攻击者发送包含两个基本操作的批量请求：
    *   `NFT_MSG_DELRULE`：删除包含匿名 `nft_set` 的 `nft_rule`，这将隐式删除 `lookup` 表达式和匿名 `nft_set`。
    *   `NFT_MSG_DELSETELEM`：删除已删除的匿名 `nft_set` 中的元素。
3.  内核接受批量请求，调用 `nf_tables_commit_release()` 将释放的资源添加到 `nf_tables_destroy_list`。
4.  `nf_tables_trans_destroy_work()` 处理 `nf_tables_destroy_list`，首先通过调用 `nft_commit_release()` -> `nf_tables_rule_destroy()` -> `nf_tables_expr_destroy()` -> `expr->ops->destroy()` (指向 `nft_lookup_destroy()`) -> `nf_tables_destroy_set()` -> `nft_set_destroy()` -> `kvfree()` 释放 `nft_set` 占用的内存。
5.  之后，在处理 `NFT_MSG_DELSETELEM` 操作时，通过 `nft_commit_release()` -> `nf_tables_set_elem_destroy()` -> `nft_set_elem_ext()` 访问已释放的 `nft_set` 内存，导致使用后释放。
6.  `nft_set_elem_ext` 宏尝试访问释放的 `nft_set` 结构中的 `ops->elemsize` 字段，如果该字段被篡改，可能导致访问任意内存地址。
7.  通过竞争 `nf_tables_trans_destroy_work()`，可以尝试在释放的内存被重用之前修改 `nft_set` 的内容。
8.  PoC 通过增加销毁大量元素的 `nft_set` 操作来增加worker线程延迟，并使其他CPU核心繁忙，来增加竞争成功的几率。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞允许本地用户提权，并且存在公开的 PoC 代码。PoC 代码描述了利用 use-after-free 漏洞的技术，包括竞争条件和内存操作。因此，提供的 PoC 代码看起来是有效的。

**投毒风险：**

尽管PoC看起来旨在重现漏洞利用, 但仍然存在一些风险: 
* 仓库名称过于简单，缺乏实质内容, 增加了潜在的风险。
* 描述中存在一些拼写错误（例如：dea），可能是故意为之，以掩盖潜在的恶意代码。
*  通过延迟worker线程方式，增加了不确定性。 
综上所述，作者可能在PoC中加入了一些难以察觉的恶意代码，比如后门或信息收集功能。尽管PoC主要目的是演示漏洞利用，但也不能排除作者恶意投毒的可能性。因此，保守估计投毒风险为10%。建议在使用前进行代码审计。

**项目地址:** [oferchen/POC-CVE-2023-32233](https://github.com/oferchen/POC-CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #6

**来源**: [CVE-2023-32233-void0red_CVE-2023-32233.md](../2023/CVE-2023-32233-void0red_CVE-2023-32233.md)

# CVE-2023-32233

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-32233-Liuk3r_CVE-2023-32233.md](../2023/CVE-2023-32233-Liuk3r_CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter nf_tables Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel Netfilter nf_tables

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** <= 6.3.1

**利用条件:** 需要本地用户权限，目标内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 是 Linux kernel 中 Netfilter nf_tables 组件的 Use-After-Free 漏洞。该漏洞发生在处理批量请求更新 nf_tables 配置时，由于匿名集合处理不当导致。攻击者可以利用此漏洞在内核内存上执行任意读写操作，从而获得 root 权限。 

**漏洞利用有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞利用的有效性较高。搜索引擎结果表明，存在公开的 PoC 代码，并且已被成功利用以实现权限提升。漏洞描述中也明确指出，未授权的本地用户可以利用此漏洞获取 root 权限。

**投毒风险：**
阅读提供的漏洞利用代码片段，主要关注了利用 UAF 漏洞的原理和方法，例如通过竞争条件和内存布局来修改已释放的 `nft_set` 结构体的内容。虽然PoC代码中添加了延时操作和CPU亲和性来增加漏洞触发的概率，但这属于正常的漏洞利用手段，不属于恶意投毒。
投毒风险评估：10%。PoC的主要目的是演示漏洞的可利用性，而非植入后门或执行其他恶意操作。但是，任何未经审核的代码都存在潜在风险，建议在受控环境中测试。

**漏洞利用方式：**
1.  **构造恶意的批量请求：**  攻击者构造包含`NFT_MSG_DELRULE` (删除规则) 和 `NFT_MSG_DELSETELEM` (删除集合元素) 操作的 Netfilter nf_tables 批量请求。
2.  **触发Use-After-Free：**  `NFT_MSG_DELRULE` 操作会释放匿名 `nft_set` 结构体，而随后的 `NFT_MSG_DELSETELEM` 操作会尝试访问已释放的 `nft_set` 结构体，导致 Use-After-Free。
3.  **内存操作：**  攻击者在 `nft_set` 释放后，但在访问之前，尝试重新分配内存并写入特定值，通常是覆盖`set->ops->elemsize`。当后续代码尝试使用已释放的 `nft_set` 结构体时，例如计算偏移量，就会使用被篡改的值，导致访问到错误的内存位置。
4.  **权限提升：**  通过控制内存读写，攻击者可以覆盖内核中的关键数据结构，例如进程的权限信息，从而获得 root 权限。

**项目地址:** [Liuk3r/CVE-2023-32233](https://github.com/Liuk3r/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #2

**来源**: [CVE-2023-32233-PIDAN-HEIDASHUAI_CVE-2023-32233.md](../2023/CVE-2023-32233-PIDAN-HEIDASHUAI_CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel Netfilter nf_tables

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限，需要nf_tables配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 漏洞存在于Linux内核的Netfilter nf_tables子系统中，当处理批量请求以更新nf_tables配置时，会发生use-after-free漏洞。

**漏洞利用有效性:**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，可以判断此漏洞利用是有效的。POC代码描述了利用此漏洞的详细步骤，包括如何触发use-after-free，以及如何赢得与内核后台工作线程的竞争，从而实现可靠的利用。搜索引擎结果中也提到了公开的PoC。

**投毒风险:**
POC代码的目的是演示漏洞利用，并不能完全排除作者隐藏投毒代码的风险。代码中存在一定的复杂性，难以保证完全没有恶意代码。但从代码的功能和目的来看，作为漏洞利用，投毒的可能性较低。对已提供的POC代码进行初步分析，发现并无明显恶意代码，但仍需进一步审查。因此，将投毒风险评估为10%。

**利用方式:**
利用方式如下：
1.  **漏洞触发:** 通过构造恶意的nf_tables批量请求，其中包含删除规则（`NFT_MSG_DELRULE`）和删除集合元素（`NFT_MSG_DELSETELEM`）的操作。
2.  **Use-After-Free:** 删除规则操作会释放匿名集合（`nft_set`）的内存。之后，删除集合元素的操作会尝试访问已释放的内存，从而触发use-after-free漏洞。
3.  **竞争条件:** 攻击者需要与内核后台工作线程`nf_tables_trans_destroy_work()`竞争。为了增加成功率，POC代码会增加延迟，并使其他CPU核心繁忙，从而增加在特定CPU核心上重用已释放内存的机会。
4.  **内存重用:** 攻击者尝试分配新的`nft_set`或其他内核对象来重用已释放的内存。通过精心构造的数据，可以修改`nft_set`中的`ops->elemsize`等关键字段。
5.  **任意读写:**  修改`ops->elemsize`会导致`nft_set_elem_ext`计算出错误的内存地址，最终允许攻击者执行任意内核内存读写操作。
6.  **权限提升:** 攻击者可以使用任意内核内存读写操作来修改进程的凭据（credentials），从而获得root权限。

**项目地址:** [PIDAN-HEIDASHUAI/CVE-2023-32233](https://github.com/PIDAN-HEIDASHUAI/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #3

**来源**: [CVE-2023-32233-RogelioPumajulca_TEST-CVE-2023-32233.md](../2023/CVE-2023-32233-RogelioPumajulca_TEST-CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel Netfilter nf_tables Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限，目标系统运行受影响的Linux内核版本且未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233是Linux内核Netfilter nf_tables组件中的一个使用后释放（Use-After-Free）漏洞。该漏洞发生在处理批量请求更新nf_tables配置时，由于匿名集合处理不当导致。未授权的本地用户可以利用此漏洞在内核内存中执行任意读写操作，从而获得root权限。

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞利用的有效性较高。漏洞库信息表明该漏洞确实存在，并且允许本地提权。搜索引擎结果中也显示存在公开的PoC代码。
提供的PoC代码包含构建和配置说明，以及如何针对不同内核进行调整的指导，包括内核符号地址和机器码的调整。这表明该PoC是经过验证的，并且具有一定的灵活性，可以适应不同的内核版本。

**投毒风险分析：**
分析PoC代码后，发现其中存在一些需要用户手动配置的参数，例如内核符号地址、机器码等。这些参数的配置需要一定的内核知识，如果配置不当，可能会导致PoC无法成功利用，甚至导致系统崩溃。但是，这些配置要求是由于内核版本和编译选项的差异造成的，属于正常情况，并非恶意投毒。
代码中没有发现明显的恶意代码或后门。需要注意的是，PoC本身可能会导致系统不稳定，甚至崩溃，这是利用UAF漏洞的常见风险。因此，在测试PoC时，建议在专用系统上进行，以避免数据损坏。
综合来看，投毒风险较低，大约为10%。主要风险在于PoC本身可能导致系统不稳定。

**利用方式分析：**
1.  **漏洞触发：** 通过精心构造的Netfilter nf_tables批量请求，触发use-after-free漏洞。漏洞的根源在于对匿名集合的处理不当。
2.  **内存破坏：**  利用use-after-free漏洞，在内核内存中执行任意读写操作。这允许攻击者覆盖关键的内核数据结构。
3.  **权限提升：**  通过覆盖`modprobe_path`变量，将执行modprobe的路径修改为攻击者控制的脚本。当内核尝试执行modprobe时，会执行攻击者提供的脚本，从而获得root权限。
4. **代码分析:** exploit.c代码通过利用nf_tables的批量处理机制中的UAF漏洞，精巧地控制内核内存，最终劫持了`modprobe_path`，实现了提权。其中race condition的利用是成功利用漏洞的关键,需要通过调整sleep时间来提高成功率。
5.  **配置需求:**  PoC需要根据不同的内核版本进行配置，包括内核符号地址和机器码的调整，以确保能够正确利用漏洞。

**项目地址:** [RogelioPumajulca/TEST-CVE-2023-32233](https://github.com/RogelioPumajulca/TEST-CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #4

**来源**: [CVE-2023-32233-enlist12_CVE-2023-32233.md](../2023/CVE-2023-32233-enlist12_CVE-2023-32233.md)

## CVE-2023-32233

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel (Netfilter nf_tables)

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-32233是一个Linux内核中的use-after-free漏洞，存在于Netfilter nf_tables子系统中，当处理批量请求时可能被触发。根据漏洞库信息和搜索结果，该漏洞允许未经授权的本地用户通过利用此漏洞在内核内存中执行任意读写操作，从而获得root权限。

**有效性：** 根据搜索结果（例如，来自NSFOCUS CERT的通知），漏洞的PoC代码已被公开披露，表明该漏洞是可以被成功利用的。提供的POC代码片段（myconfig）显示了内核配置选项，例如启用`CONFIG_NETFILTER`，`CONFIG_NF_TABLES`和`User namespaces`，并禁用`CONFIG_WERROR`和`CONFIG_RETPOLINE`。这些配置都是为了便于漏洞的利用，并关闭一些缓解措施。综上，提供的POC代码有效。

**投毒风险：** 分析提供的代码片段：

*   `/README.md`： 包含启用和禁用某些内核配置选项的说明。 这些本身不是恶意代码，而是指示如何配置内核以重现或利用漏洞。
*   `/myconfig`： 这是内核配置文件的摘录，用于构建易受攻击的内核。 它本身也不是恶意代码，但它指定了使系统容易受到攻击的配置。

虽然这些文件本身并没有明显的恶意代码，但是有可能在完整的利用代码中隐藏了某些后门。 由于只提供了部分代码（配置文件和README），因此无法完全排除这种可能性。 这里给出一个较低的概率(5%)表示可能存在投毒代码，但缺乏充分证据。

**利用方式：**

1.  **触发漏洞：** 攻击者需要构造恶意的Netfilter nf_tables批量请求。
2.  **Use-After-Free：**  由于匿名集合处理不当，这会导致use-after-free情况。
3.  **任意读写：** 利用UAF漏洞在内核内存中执行任意读写操作。
4.  **权限提升：**  攻击者可以通过修改内核数据结构来提升自己的权限，最终获得root权限。

**项目地址:** [enlist12/CVE-2023-32233](https://github.com/enlist12/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #5

**来源**: [CVE-2023-32233-oferchen_POC-CVE-2023-32233.md](../2023/CVE-2023-32233-oferchen_POC-CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter nf_tables UAF

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel (Netfilter nf_tables)

**危害等级:** 高危，可导致权限提升

**影响版本:** <= 6.3.1

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 是 Linux 内核 Netfilter nf_tables 组件中的一个使用后释放漏洞。当处理批量请求时，删除规则和规则中的集合元素会导致use-after-free。攻击者可以利用此漏洞在内核内存中执行任意读写操作，从而获得 root 权限。

**漏洞利用方式：**

1.  漏洞存在于 `net/netfilter/nf_tables_api.c` 文件中。
2.  攻击者发送包含两个基本操作的批量请求：
    *   `NFT_MSG_DELRULE`：删除包含匿名 `nft_set` 的 `nft_rule`，这将隐式删除 `lookup` 表达式和匿名 `nft_set`。
    *   `NFT_MSG_DELSETELEM`：删除已删除的匿名 `nft_set` 中的元素。
3.  内核接受批量请求，调用 `nf_tables_commit_release()` 将释放的资源添加到 `nf_tables_destroy_list`。
4.  `nf_tables_trans_destroy_work()` 处理 `nf_tables_destroy_list`，首先通过调用 `nft_commit_release()` -> `nf_tables_rule_destroy()` -> `nf_tables_expr_destroy()` -> `expr->ops->destroy()` (指向 `nft_lookup_destroy()`) -> `nf_tables_destroy_set()` -> `nft_set_destroy()` -> `kvfree()` 释放 `nft_set` 占用的内存。
5.  之后，在处理 `NFT_MSG_DELSETELEM` 操作时，通过 `nft_commit_release()` -> `nf_tables_set_elem_destroy()` -> `nft_set_elem_ext()` 访问已释放的 `nft_set` 内存，导致使用后释放。
6.  `nft_set_elem_ext` 宏尝试访问释放的 `nft_set` 结构中的 `ops->elemsize` 字段，如果该字段被篡改，可能导致访问任意内存地址。
7.  通过竞争 `nf_tables_trans_destroy_work()`，可以尝试在释放的内存被重用之前修改 `nft_set` 的内容。
8.  PoC 通过增加销毁大量元素的 `nft_set` 操作来增加worker线程延迟，并使其他CPU核心繁忙，来增加竞争成功的几率。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞允许本地用户提权，并且存在公开的 PoC 代码。PoC 代码描述了利用 use-after-free 漏洞的技术，包括竞争条件和内存操作。因此，提供的 PoC 代码看起来是有效的。

**投毒风险：**

尽管PoC看起来旨在重现漏洞利用, 但仍然存在一些风险: 
* 仓库名称过于简单，缺乏实质内容, 增加了潜在的风险。
* 描述中存在一些拼写错误（例如：dea），可能是故意为之，以掩盖潜在的恶意代码。
*  通过延迟worker线程方式，增加了不确定性。 
综上所述，作者可能在PoC中加入了一些难以察觉的恶意代码，比如后门或信息收集功能。尽管PoC主要目的是演示漏洞利用，但也不能排除作者恶意投毒的可能性。因此，保守估计投毒风险为10%。建议在使用前进行代码审计。

**项目地址:** [oferchen/POC-CVE-2023-32233](https://github.com/oferchen/POC-CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #6

**来源**: [CVE-2023-32233-void0red_CVE-2023-32233.md](../2023/CVE-2023-32233-void0red_CVE-2023-32233.md)

# CVE-2023-32233

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-32233-Liuk3r_CVE-2023-32233.md](../2023/CVE-2023-32233-Liuk3r_CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter nf_tables Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel Netfilter nf_tables

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** <= 6.3.1

**利用条件:** 需要本地用户权限，目标内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 是 Linux kernel 中 Netfilter nf_tables 组件的 Use-After-Free 漏洞。该漏洞发生在处理批量请求更新 nf_tables 配置时，由于匿名集合处理不当导致。攻击者可以利用此漏洞在内核内存上执行任意读写操作，从而获得 root 权限。 

**漏洞利用有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞利用的有效性较高。搜索引擎结果表明，存在公开的 PoC 代码，并且已被成功利用以实现权限提升。漏洞描述中也明确指出，未授权的本地用户可以利用此漏洞获取 root 权限。

**投毒风险：**
阅读提供的漏洞利用代码片段，主要关注了利用 UAF 漏洞的原理和方法，例如通过竞争条件和内存布局来修改已释放的 `nft_set` 结构体的内容。虽然PoC代码中添加了延时操作和CPU亲和性来增加漏洞触发的概率，但这属于正常的漏洞利用手段，不属于恶意投毒。
投毒风险评估：10%。PoC的主要目的是演示漏洞的可利用性，而非植入后门或执行其他恶意操作。但是，任何未经审核的代码都存在潜在风险，建议在受控环境中测试。

**漏洞利用方式：**
1.  **构造恶意的批量请求：**  攻击者构造包含`NFT_MSG_DELRULE` (删除规则) 和 `NFT_MSG_DELSETELEM` (删除集合元素) 操作的 Netfilter nf_tables 批量请求。
2.  **触发Use-After-Free：**  `NFT_MSG_DELRULE` 操作会释放匿名 `nft_set` 结构体，而随后的 `NFT_MSG_DELSETELEM` 操作会尝试访问已释放的 `nft_set` 结构体，导致 Use-After-Free。
3.  **内存操作：**  攻击者在 `nft_set` 释放后，但在访问之前，尝试重新分配内存并写入特定值，通常是覆盖`set->ops->elemsize`。当后续代码尝试使用已释放的 `nft_set` 结构体时，例如计算偏移量，就会使用被篡改的值，导致访问到错误的内存位置。
4.  **权限提升：**  通过控制内存读写，攻击者可以覆盖内核中的关键数据结构，例如进程的权限信息，从而获得 root 权限。

**项目地址:** [Liuk3r/CVE-2023-32233](https://github.com/Liuk3r/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #2

**来源**: [CVE-2023-32233-PIDAN-HEIDASHUAI_CVE-2023-32233.md](../2023/CVE-2023-32233-PIDAN-HEIDASHUAI_CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel Netfilter nf_tables

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限，需要nf_tables配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 漏洞存在于Linux内核的Netfilter nf_tables子系统中，当处理批量请求以更新nf_tables配置时，会发生use-after-free漏洞。

**漏洞利用有效性:**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，可以判断此漏洞利用是有效的。POC代码描述了利用此漏洞的详细步骤，包括如何触发use-after-free，以及如何赢得与内核后台工作线程的竞争，从而实现可靠的利用。搜索引擎结果中也提到了公开的PoC。

**投毒风险:**
POC代码的目的是演示漏洞利用，并不能完全排除作者隐藏投毒代码的风险。代码中存在一定的复杂性，难以保证完全没有恶意代码。但从代码的功能和目的来看，作为漏洞利用，投毒的可能性较低。对已提供的POC代码进行初步分析，发现并无明显恶意代码，但仍需进一步审查。因此，将投毒风险评估为10%。

**利用方式:**
利用方式如下：
1.  **漏洞触发:** 通过构造恶意的nf_tables批量请求，其中包含删除规则（`NFT_MSG_DELRULE`）和删除集合元素（`NFT_MSG_DELSETELEM`）的操作。
2.  **Use-After-Free:** 删除规则操作会释放匿名集合（`nft_set`）的内存。之后，删除集合元素的操作会尝试访问已释放的内存，从而触发use-after-free漏洞。
3.  **竞争条件:** 攻击者需要与内核后台工作线程`nf_tables_trans_destroy_work()`竞争。为了增加成功率，POC代码会增加延迟，并使其他CPU核心繁忙，从而增加在特定CPU核心上重用已释放内存的机会。
4.  **内存重用:** 攻击者尝试分配新的`nft_set`或其他内核对象来重用已释放的内存。通过精心构造的数据，可以修改`nft_set`中的`ops->elemsize`等关键字段。
5.  **任意读写:**  修改`ops->elemsize`会导致`nft_set_elem_ext`计算出错误的内存地址，最终允许攻击者执行任意内核内存读写操作。
6.  **权限提升:** 攻击者可以使用任意内核内存读写操作来修改进程的凭据（credentials），从而获得root权限。

**项目地址:** [PIDAN-HEIDASHUAI/CVE-2023-32233](https://github.com/PIDAN-HEIDASHUAI/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #3

**来源**: [CVE-2023-32233-RogelioPumajulca_TEST-CVE-2023-32233.md](../2023/CVE-2023-32233-RogelioPumajulca_TEST-CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel Netfilter nf_tables Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限，目标系统运行受影响的Linux内核版本且未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233是Linux内核Netfilter nf_tables组件中的一个使用后释放（Use-After-Free）漏洞。该漏洞发生在处理批量请求更新nf_tables配置时，由于匿名集合处理不当导致。未授权的本地用户可以利用此漏洞在内核内存中执行任意读写操作，从而获得root权限。

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞利用的有效性较高。漏洞库信息表明该漏洞确实存在，并且允许本地提权。搜索引擎结果中也显示存在公开的PoC代码。
提供的PoC代码包含构建和配置说明，以及如何针对不同内核进行调整的指导，包括内核符号地址和机器码的调整。这表明该PoC是经过验证的，并且具有一定的灵活性，可以适应不同的内核版本。

**投毒风险分析：**
分析PoC代码后，发现其中存在一些需要用户手动配置的参数，例如内核符号地址、机器码等。这些参数的配置需要一定的内核知识，如果配置不当，可能会导致PoC无法成功利用，甚至导致系统崩溃。但是，这些配置要求是由于内核版本和编译选项的差异造成的，属于正常情况，并非恶意投毒。
代码中没有发现明显的恶意代码或后门。需要注意的是，PoC本身可能会导致系统不稳定，甚至崩溃，这是利用UAF漏洞的常见风险。因此，在测试PoC时，建议在专用系统上进行，以避免数据损坏。
综合来看，投毒风险较低，大约为10%。主要风险在于PoC本身可能导致系统不稳定。

**利用方式分析：**
1.  **漏洞触发：** 通过精心构造的Netfilter nf_tables批量请求，触发use-after-free漏洞。漏洞的根源在于对匿名集合的处理不当。
2.  **内存破坏：**  利用use-after-free漏洞，在内核内存中执行任意读写操作。这允许攻击者覆盖关键的内核数据结构。
3.  **权限提升：**  通过覆盖`modprobe_path`变量，将执行modprobe的路径修改为攻击者控制的脚本。当内核尝试执行modprobe时，会执行攻击者提供的脚本，从而获得root权限。
4. **代码分析:** exploit.c代码通过利用nf_tables的批量处理机制中的UAF漏洞，精巧地控制内核内存，最终劫持了`modprobe_path`，实现了提权。其中race condition的利用是成功利用漏洞的关键,需要通过调整sleep时间来提高成功率。
5.  **配置需求:**  PoC需要根据不同的内核版本进行配置，包括内核符号地址和机器码的调整，以确保能够正确利用漏洞。

**项目地址:** [RogelioPumajulca/TEST-CVE-2023-32233](https://github.com/RogelioPumajulca/TEST-CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #4

**来源**: [CVE-2023-32233-enlist12_CVE-2023-32233.md](../2023/CVE-2023-32233-enlist12_CVE-2023-32233.md)

## CVE-2023-32233

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel (Netfilter nf_tables)

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-32233是一个Linux内核中的use-after-free漏洞，存在于Netfilter nf_tables子系统中，当处理批量请求时可能被触发。根据漏洞库信息和搜索结果，该漏洞允许未经授权的本地用户通过利用此漏洞在内核内存中执行任意读写操作，从而获得root权限。

**有效性：** 根据搜索结果（例如，来自NSFOCUS CERT的通知），漏洞的PoC代码已被公开披露，表明该漏洞是可以被成功利用的。提供的POC代码片段（myconfig）显示了内核配置选项，例如启用`CONFIG_NETFILTER`，`CONFIG_NF_TABLES`和`User namespaces`，并禁用`CONFIG_WERROR`和`CONFIG_RETPOLINE`。这些配置都是为了便于漏洞的利用，并关闭一些缓解措施。综上，提供的POC代码有效。

**投毒风险：** 分析提供的代码片段：

*   `/README.md`： 包含启用和禁用某些内核配置选项的说明。 这些本身不是恶意代码，而是指示如何配置内核以重现或利用漏洞。
*   `/myconfig`： 这是内核配置文件的摘录，用于构建易受攻击的内核。 它本身也不是恶意代码，但它指定了使系统容易受到攻击的配置。

虽然这些文件本身并没有明显的恶意代码，但是有可能在完整的利用代码中隐藏了某些后门。 由于只提供了部分代码（配置文件和README），因此无法完全排除这种可能性。 这里给出一个较低的概率(5%)表示可能存在投毒代码，但缺乏充分证据。

**利用方式：**

1.  **触发漏洞：** 攻击者需要构造恶意的Netfilter nf_tables批量请求。
2.  **Use-After-Free：**  由于匿名集合处理不当，这会导致use-after-free情况。
3.  **任意读写：** 利用UAF漏洞在内核内存中执行任意读写操作。
4.  **权限提升：**  攻击者可以通过修改内核数据结构来提升自己的权限，最终获得root权限。

**项目地址:** [enlist12/CVE-2023-32233](https://github.com/enlist12/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #5

**来源**: [CVE-2023-32233-oferchen_POC-CVE-2023-32233.md](../2023/CVE-2023-32233-oferchen_POC-CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter nf_tables UAF

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel (Netfilter nf_tables)

**危害等级:** 高危，可导致权限提升

**影响版本:** <= 6.3.1

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 是 Linux 内核 Netfilter nf_tables 组件中的一个使用后释放漏洞。当处理批量请求时，删除规则和规则中的集合元素会导致use-after-free。攻击者可以利用此漏洞在内核内存中执行任意读写操作，从而获得 root 权限。

**漏洞利用方式：**

1.  漏洞存在于 `net/netfilter/nf_tables_api.c` 文件中。
2.  攻击者发送包含两个基本操作的批量请求：
    *   `NFT_MSG_DELRULE`：删除包含匿名 `nft_set` 的 `nft_rule`，这将隐式删除 `lookup` 表达式和匿名 `nft_set`。
    *   `NFT_MSG_DELSETELEM`：删除已删除的匿名 `nft_set` 中的元素。
3.  内核接受批量请求，调用 `nf_tables_commit_release()` 将释放的资源添加到 `nf_tables_destroy_list`。
4.  `nf_tables_trans_destroy_work()` 处理 `nf_tables_destroy_list`，首先通过调用 `nft_commit_release()` -> `nf_tables_rule_destroy()` -> `nf_tables_expr_destroy()` -> `expr->ops->destroy()` (指向 `nft_lookup_destroy()`) -> `nf_tables_destroy_set()` -> `nft_set_destroy()` -> `kvfree()` 释放 `nft_set` 占用的内存。
5.  之后，在处理 `NFT_MSG_DELSETELEM` 操作时，通过 `nft_commit_release()` -> `nf_tables_set_elem_destroy()` -> `nft_set_elem_ext()` 访问已释放的 `nft_set` 内存，导致使用后释放。
6.  `nft_set_elem_ext` 宏尝试访问释放的 `nft_set` 结构中的 `ops->elemsize` 字段，如果该字段被篡改，可能导致访问任意内存地址。
7.  通过竞争 `nf_tables_trans_destroy_work()`，可以尝试在释放的内存被重用之前修改 `nft_set` 的内容。
8.  PoC 通过增加销毁大量元素的 `nft_set` 操作来增加worker线程延迟，并使其他CPU核心繁忙，来增加竞争成功的几率。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞允许本地用户提权，并且存在公开的 PoC 代码。PoC 代码描述了利用 use-after-free 漏洞的技术，包括竞争条件和内存操作。因此，提供的 PoC 代码看起来是有效的。

**投毒风险：**

尽管PoC看起来旨在重现漏洞利用, 但仍然存在一些风险: 
* 仓库名称过于简单，缺乏实质内容, 增加了潜在的风险。
* 描述中存在一些拼写错误（例如：dea），可能是故意为之，以掩盖潜在的恶意代码。
*  通过延迟worker线程方式，增加了不确定性。 
综上所述，作者可能在PoC中加入了一些难以察觉的恶意代码，比如后门或信息收集功能。尽管PoC主要目的是演示漏洞利用，但也不能排除作者恶意投毒的可能性。因此，保守估计投毒风险为10%。建议在使用前进行代码审计。

**项目地址:** [oferchen/POC-CVE-2023-32233](https://github.com/oferchen/POC-CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #6

**来源**: [CVE-2023-32233-void0red_CVE-2023-32233.md](../2023/CVE-2023-32233-void0red_CVE-2023-32233.md)

# CVE-2023-32233

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-32233-Liuk3r_CVE-2023-32233.md](../2023/CVE-2023-32233-Liuk3r_CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter nf_tables Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel Netfilter nf_tables

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** <= 6.3.1

**利用条件:** 需要本地用户权限，目标内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 是 Linux kernel 中 Netfilter nf_tables 组件的 Use-After-Free 漏洞。该漏洞发生在处理批量请求更新 nf_tables 配置时，由于匿名集合处理不当导致。攻击者可以利用此漏洞在内核内存上执行任意读写操作，从而获得 root 权限。 

**漏洞利用有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞利用的有效性较高。搜索引擎结果表明，存在公开的 PoC 代码，并且已被成功利用以实现权限提升。漏洞描述中也明确指出，未授权的本地用户可以利用此漏洞获取 root 权限。

**投毒风险：**
阅读提供的漏洞利用代码片段，主要关注了利用 UAF 漏洞的原理和方法，例如通过竞争条件和内存布局来修改已释放的 `nft_set` 结构体的内容。虽然PoC代码中添加了延时操作和CPU亲和性来增加漏洞触发的概率，但这属于正常的漏洞利用手段，不属于恶意投毒。
投毒风险评估：10%。PoC的主要目的是演示漏洞的可利用性，而非植入后门或执行其他恶意操作。但是，任何未经审核的代码都存在潜在风险，建议在受控环境中测试。

**漏洞利用方式：**
1.  **构造恶意的批量请求：**  攻击者构造包含`NFT_MSG_DELRULE` (删除规则) 和 `NFT_MSG_DELSETELEM` (删除集合元素) 操作的 Netfilter nf_tables 批量请求。
2.  **触发Use-After-Free：**  `NFT_MSG_DELRULE` 操作会释放匿名 `nft_set` 结构体，而随后的 `NFT_MSG_DELSETELEM` 操作会尝试访问已释放的 `nft_set` 结构体，导致 Use-After-Free。
3.  **内存操作：**  攻击者在 `nft_set` 释放后，但在访问之前，尝试重新分配内存并写入特定值，通常是覆盖`set->ops->elemsize`。当后续代码尝试使用已释放的 `nft_set` 结构体时，例如计算偏移量，就会使用被篡改的值，导致访问到错误的内存位置。
4.  **权限提升：**  通过控制内存读写，攻击者可以覆盖内核中的关键数据结构，例如进程的权限信息，从而获得 root 权限。

**项目地址:** [Liuk3r/CVE-2023-32233](https://github.com/Liuk3r/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #2

**来源**: [CVE-2023-32233-PIDAN-HEIDASHUAI_CVE-2023-32233.md](../2023/CVE-2023-32233-PIDAN-HEIDASHUAI_CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel Netfilter nf_tables

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限，需要nf_tables配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 漏洞存在于Linux内核的Netfilter nf_tables子系统中，当处理批量请求以更新nf_tables配置时，会发生use-after-free漏洞。

**漏洞利用有效性:**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，可以判断此漏洞利用是有效的。POC代码描述了利用此漏洞的详细步骤，包括如何触发use-after-free，以及如何赢得与内核后台工作线程的竞争，从而实现可靠的利用。搜索引擎结果中也提到了公开的PoC。

**投毒风险:**
POC代码的目的是演示漏洞利用，并不能完全排除作者隐藏投毒代码的风险。代码中存在一定的复杂性，难以保证完全没有恶意代码。但从代码的功能和目的来看，作为漏洞利用，投毒的可能性较低。对已提供的POC代码进行初步分析，发现并无明显恶意代码，但仍需进一步审查。因此，将投毒风险评估为10%。

**利用方式:**
利用方式如下：
1.  **漏洞触发:** 通过构造恶意的nf_tables批量请求，其中包含删除规则（`NFT_MSG_DELRULE`）和删除集合元素（`NFT_MSG_DELSETELEM`）的操作。
2.  **Use-After-Free:** 删除规则操作会释放匿名集合（`nft_set`）的内存。之后，删除集合元素的操作会尝试访问已释放的内存，从而触发use-after-free漏洞。
3.  **竞争条件:** 攻击者需要与内核后台工作线程`nf_tables_trans_destroy_work()`竞争。为了增加成功率，POC代码会增加延迟，并使其他CPU核心繁忙，从而增加在特定CPU核心上重用已释放内存的机会。
4.  **内存重用:** 攻击者尝试分配新的`nft_set`或其他内核对象来重用已释放的内存。通过精心构造的数据，可以修改`nft_set`中的`ops->elemsize`等关键字段。
5.  **任意读写:**  修改`ops->elemsize`会导致`nft_set_elem_ext`计算出错误的内存地址，最终允许攻击者执行任意内核内存读写操作。
6.  **权限提升:** 攻击者可以使用任意内核内存读写操作来修改进程的凭据（credentials），从而获得root权限。

**项目地址:** [PIDAN-HEIDASHUAI/CVE-2023-32233](https://github.com/PIDAN-HEIDASHUAI/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #3

**来源**: [CVE-2023-32233-RogelioPumajulca_TEST-CVE-2023-32233.md](../2023/CVE-2023-32233-RogelioPumajulca_TEST-CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel Netfilter nf_tables Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限，目标系统运行受影响的Linux内核版本且未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233是Linux内核Netfilter nf_tables组件中的一个使用后释放（Use-After-Free）漏洞。该漏洞发生在处理批量请求更新nf_tables配置时，由于匿名集合处理不当导致。未授权的本地用户可以利用此漏洞在内核内存中执行任意读写操作，从而获得root权限。

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞利用的有效性较高。漏洞库信息表明该漏洞确实存在，并且允许本地提权。搜索引擎结果中也显示存在公开的PoC代码。
提供的PoC代码包含构建和配置说明，以及如何针对不同内核进行调整的指导，包括内核符号地址和机器码的调整。这表明该PoC是经过验证的，并且具有一定的灵活性，可以适应不同的内核版本。

**投毒风险分析：**
分析PoC代码后，发现其中存在一些需要用户手动配置的参数，例如内核符号地址、机器码等。这些参数的配置需要一定的内核知识，如果配置不当，可能会导致PoC无法成功利用，甚至导致系统崩溃。但是，这些配置要求是由于内核版本和编译选项的差异造成的，属于正常情况，并非恶意投毒。
代码中没有发现明显的恶意代码或后门。需要注意的是，PoC本身可能会导致系统不稳定，甚至崩溃，这是利用UAF漏洞的常见风险。因此，在测试PoC时，建议在专用系统上进行，以避免数据损坏。
综合来看，投毒风险较低，大约为10%。主要风险在于PoC本身可能导致系统不稳定。

**利用方式分析：**
1.  **漏洞触发：** 通过精心构造的Netfilter nf_tables批量请求，触发use-after-free漏洞。漏洞的根源在于对匿名集合的处理不当。
2.  **内存破坏：**  利用use-after-free漏洞，在内核内存中执行任意读写操作。这允许攻击者覆盖关键的内核数据结构。
3.  **权限提升：**  通过覆盖`modprobe_path`变量，将执行modprobe的路径修改为攻击者控制的脚本。当内核尝试执行modprobe时，会执行攻击者提供的脚本，从而获得root权限。
4. **代码分析:** exploit.c代码通过利用nf_tables的批量处理机制中的UAF漏洞，精巧地控制内核内存，最终劫持了`modprobe_path`，实现了提权。其中race condition的利用是成功利用漏洞的关键,需要通过调整sleep时间来提高成功率。
5.  **配置需求:**  PoC需要根据不同的内核版本进行配置，包括内核符号地址和机器码的调整，以确保能够正确利用漏洞。

**项目地址:** [RogelioPumajulca/TEST-CVE-2023-32233](https://github.com/RogelioPumajulca/TEST-CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #4

**来源**: [CVE-2023-32233-enlist12_CVE-2023-32233.md](../2023/CVE-2023-32233-enlist12_CVE-2023-32233.md)

## CVE-2023-32233

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel (Netfilter nf_tables)

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-32233是一个Linux内核中的use-after-free漏洞，存在于Netfilter nf_tables子系统中，当处理批量请求时可能被触发。根据漏洞库信息和搜索结果，该漏洞允许未经授权的本地用户通过利用此漏洞在内核内存中执行任意读写操作，从而获得root权限。

**有效性：** 根据搜索结果（例如，来自NSFOCUS CERT的通知），漏洞的PoC代码已被公开披露，表明该漏洞是可以被成功利用的。提供的POC代码片段（myconfig）显示了内核配置选项，例如启用`CONFIG_NETFILTER`，`CONFIG_NF_TABLES`和`User namespaces`，并禁用`CONFIG_WERROR`和`CONFIG_RETPOLINE`。这些配置都是为了便于漏洞的利用，并关闭一些缓解措施。综上，提供的POC代码有效。

**投毒风险：** 分析提供的代码片段：

*   `/README.md`： 包含启用和禁用某些内核配置选项的说明。 这些本身不是恶意代码，而是指示如何配置内核以重现或利用漏洞。
*   `/myconfig`： 这是内核配置文件的摘录，用于构建易受攻击的内核。 它本身也不是恶意代码，但它指定了使系统容易受到攻击的配置。

虽然这些文件本身并没有明显的恶意代码，但是有可能在完整的利用代码中隐藏了某些后门。 由于只提供了部分代码（配置文件和README），因此无法完全排除这种可能性。 这里给出一个较低的概率(5%)表示可能存在投毒代码，但缺乏充分证据。

**利用方式：**

1.  **触发漏洞：** 攻击者需要构造恶意的Netfilter nf_tables批量请求。
2.  **Use-After-Free：**  由于匿名集合处理不当，这会导致use-after-free情况。
3.  **任意读写：** 利用UAF漏洞在内核内存中执行任意读写操作。
4.  **权限提升：**  攻击者可以通过修改内核数据结构来提升自己的权限，最终获得root权限。

**项目地址:** [enlist12/CVE-2023-32233](https://github.com/enlist12/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #5

**来源**: [CVE-2023-32233-oferchen_POC-CVE-2023-32233.md](../2023/CVE-2023-32233-oferchen_POC-CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter nf_tables UAF

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel (Netfilter nf_tables)

**危害等级:** 高危，可导致权限提升

**影响版本:** <= 6.3.1

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 是 Linux 内核 Netfilter nf_tables 组件中的一个使用后释放漏洞。当处理批量请求时，删除规则和规则中的集合元素会导致use-after-free。攻击者可以利用此漏洞在内核内存中执行任意读写操作，从而获得 root 权限。

**漏洞利用方式：**

1.  漏洞存在于 `net/netfilter/nf_tables_api.c` 文件中。
2.  攻击者发送包含两个基本操作的批量请求：
    *   `NFT_MSG_DELRULE`：删除包含匿名 `nft_set` 的 `nft_rule`，这将隐式删除 `lookup` 表达式和匿名 `nft_set`。
    *   `NFT_MSG_DELSETELEM`：删除已删除的匿名 `nft_set` 中的元素。
3.  内核接受批量请求，调用 `nf_tables_commit_release()` 将释放的资源添加到 `nf_tables_destroy_list`。
4.  `nf_tables_trans_destroy_work()` 处理 `nf_tables_destroy_list`，首先通过调用 `nft_commit_release()` -> `nf_tables_rule_destroy()` -> `nf_tables_expr_destroy()` -> `expr->ops->destroy()` (指向 `nft_lookup_destroy()`) -> `nf_tables_destroy_set()` -> `nft_set_destroy()` -> `kvfree()` 释放 `nft_set` 占用的内存。
5.  之后，在处理 `NFT_MSG_DELSETELEM` 操作时，通过 `nft_commit_release()` -> `nf_tables_set_elem_destroy()` -> `nft_set_elem_ext()` 访问已释放的 `nft_set` 内存，导致使用后释放。
6.  `nft_set_elem_ext` 宏尝试访问释放的 `nft_set` 结构中的 `ops->elemsize` 字段，如果该字段被篡改，可能导致访问任意内存地址。
7.  通过竞争 `nf_tables_trans_destroy_work()`，可以尝试在释放的内存被重用之前修改 `nft_set` 的内容。
8.  PoC 通过增加销毁大量元素的 `nft_set` 操作来增加worker线程延迟，并使其他CPU核心繁忙，来增加竞争成功的几率。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞允许本地用户提权，并且存在公开的 PoC 代码。PoC 代码描述了利用 use-after-free 漏洞的技术，包括竞争条件和内存操作。因此，提供的 PoC 代码看起来是有效的。

**投毒风险：**

尽管PoC看起来旨在重现漏洞利用, 但仍然存在一些风险: 
* 仓库名称过于简单，缺乏实质内容, 增加了潜在的风险。
* 描述中存在一些拼写错误（例如：dea），可能是故意为之，以掩盖潜在的恶意代码。
*  通过延迟worker线程方式，增加了不确定性。 
综上所述，作者可能在PoC中加入了一些难以察觉的恶意代码，比如后门或信息收集功能。尽管PoC主要目的是演示漏洞利用，但也不能排除作者恶意投毒的可能性。因此，保守估计投毒风险为10%。建议在使用前进行代码审计。

**项目地址:** [oferchen/POC-CVE-2023-32233](https://github.com/oferchen/POC-CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #6

**来源**: [CVE-2023-32233-void0red_CVE-2023-32233.md](../2023/CVE-2023-32233-void0red_CVE-2023-32233.md)

# CVE-2023-32233

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-32233-Liuk3r_CVE-2023-32233.md](../2023/CVE-2023-32233-Liuk3r_CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter nf_tables Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel Netfilter nf_tables

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** <= 6.3.1

**利用条件:** 需要本地用户权限，目标内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 是 Linux kernel 中 Netfilter nf_tables 组件的 Use-After-Free 漏洞。该漏洞发生在处理批量请求更新 nf_tables 配置时，由于匿名集合处理不当导致。攻击者可以利用此漏洞在内核内存上执行任意读写操作，从而获得 root 权限。 

**漏洞利用有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞利用的有效性较高。搜索引擎结果表明，存在公开的 PoC 代码，并且已被成功利用以实现权限提升。漏洞描述中也明确指出，未授权的本地用户可以利用此漏洞获取 root 权限。

**投毒风险：**
阅读提供的漏洞利用代码片段，主要关注了利用 UAF 漏洞的原理和方法，例如通过竞争条件和内存布局来修改已释放的 `nft_set` 结构体的内容。虽然PoC代码中添加了延时操作和CPU亲和性来增加漏洞触发的概率，但这属于正常的漏洞利用手段，不属于恶意投毒。
投毒风险评估：10%。PoC的主要目的是演示漏洞的可利用性，而非植入后门或执行其他恶意操作。但是，任何未经审核的代码都存在潜在风险，建议在受控环境中测试。

**漏洞利用方式：**
1.  **构造恶意的批量请求：**  攻击者构造包含`NFT_MSG_DELRULE` (删除规则) 和 `NFT_MSG_DELSETELEM` (删除集合元素) 操作的 Netfilter nf_tables 批量请求。
2.  **触发Use-After-Free：**  `NFT_MSG_DELRULE` 操作会释放匿名 `nft_set` 结构体，而随后的 `NFT_MSG_DELSETELEM` 操作会尝试访问已释放的 `nft_set` 结构体，导致 Use-After-Free。
3.  **内存操作：**  攻击者在 `nft_set` 释放后，但在访问之前，尝试重新分配内存并写入特定值，通常是覆盖`set->ops->elemsize`。当后续代码尝试使用已释放的 `nft_set` 结构体时，例如计算偏移量，就会使用被篡改的值，导致访问到错误的内存位置。
4.  **权限提升：**  通过控制内存读写，攻击者可以覆盖内核中的关键数据结构，例如进程的权限信息，从而获得 root 权限。

**项目地址:** [Liuk3r/CVE-2023-32233](https://github.com/Liuk3r/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #2

**来源**: [CVE-2023-32233-PIDAN-HEIDASHUAI_CVE-2023-32233.md](../2023/CVE-2023-32233-PIDAN-HEIDASHUAI_CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel Netfilter nf_tables

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限，需要nf_tables配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 漏洞存在于Linux内核的Netfilter nf_tables子系统中，当处理批量请求以更新nf_tables配置时，会发生use-after-free漏洞。

**漏洞利用有效性:**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，可以判断此漏洞利用是有效的。POC代码描述了利用此漏洞的详细步骤，包括如何触发use-after-free，以及如何赢得与内核后台工作线程的竞争，从而实现可靠的利用。搜索引擎结果中也提到了公开的PoC。

**投毒风险:**
POC代码的目的是演示漏洞利用，并不能完全排除作者隐藏投毒代码的风险。代码中存在一定的复杂性，难以保证完全没有恶意代码。但从代码的功能和目的来看，作为漏洞利用，投毒的可能性较低。对已提供的POC代码进行初步分析，发现并无明显恶意代码，但仍需进一步审查。因此，将投毒风险评估为10%。

**利用方式:**
利用方式如下：
1.  **漏洞触发:** 通过构造恶意的nf_tables批量请求，其中包含删除规则（`NFT_MSG_DELRULE`）和删除集合元素（`NFT_MSG_DELSETELEM`）的操作。
2.  **Use-After-Free:** 删除规则操作会释放匿名集合（`nft_set`）的内存。之后，删除集合元素的操作会尝试访问已释放的内存，从而触发use-after-free漏洞。
3.  **竞争条件:** 攻击者需要与内核后台工作线程`nf_tables_trans_destroy_work()`竞争。为了增加成功率，POC代码会增加延迟，并使其他CPU核心繁忙，从而增加在特定CPU核心上重用已释放内存的机会。
4.  **内存重用:** 攻击者尝试分配新的`nft_set`或其他内核对象来重用已释放的内存。通过精心构造的数据，可以修改`nft_set`中的`ops->elemsize`等关键字段。
5.  **任意读写:**  修改`ops->elemsize`会导致`nft_set_elem_ext`计算出错误的内存地址，最终允许攻击者执行任意内核内存读写操作。
6.  **权限提升:** 攻击者可以使用任意内核内存读写操作来修改进程的凭据（credentials），从而获得root权限。

**项目地址:** [PIDAN-HEIDASHUAI/CVE-2023-32233](https://github.com/PIDAN-HEIDASHUAI/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #3

**来源**: [CVE-2023-32233-RogelioPumajulca_TEST-CVE-2023-32233.md](../2023/CVE-2023-32233-RogelioPumajulca_TEST-CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel Netfilter nf_tables Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限，目标系统运行受影响的Linux内核版本且未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233是Linux内核Netfilter nf_tables组件中的一个使用后释放（Use-After-Free）漏洞。该漏洞发生在处理批量请求更新nf_tables配置时，由于匿名集合处理不当导致。未授权的本地用户可以利用此漏洞在内核内存中执行任意读写操作，从而获得root权限。

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞利用的有效性较高。漏洞库信息表明该漏洞确实存在，并且允许本地提权。搜索引擎结果中也显示存在公开的PoC代码。
提供的PoC代码包含构建和配置说明，以及如何针对不同内核进行调整的指导，包括内核符号地址和机器码的调整。这表明该PoC是经过验证的，并且具有一定的灵活性，可以适应不同的内核版本。

**投毒风险分析：**
分析PoC代码后，发现其中存在一些需要用户手动配置的参数，例如内核符号地址、机器码等。这些参数的配置需要一定的内核知识，如果配置不当，可能会导致PoC无法成功利用，甚至导致系统崩溃。但是，这些配置要求是由于内核版本和编译选项的差异造成的，属于正常情况，并非恶意投毒。
代码中没有发现明显的恶意代码或后门。需要注意的是，PoC本身可能会导致系统不稳定，甚至崩溃，这是利用UAF漏洞的常见风险。因此，在测试PoC时，建议在专用系统上进行，以避免数据损坏。
综合来看，投毒风险较低，大约为10%。主要风险在于PoC本身可能导致系统不稳定。

**利用方式分析：**
1.  **漏洞触发：** 通过精心构造的Netfilter nf_tables批量请求，触发use-after-free漏洞。漏洞的根源在于对匿名集合的处理不当。
2.  **内存破坏：**  利用use-after-free漏洞，在内核内存中执行任意读写操作。这允许攻击者覆盖关键的内核数据结构。
3.  **权限提升：**  通过覆盖`modprobe_path`变量，将执行modprobe的路径修改为攻击者控制的脚本。当内核尝试执行modprobe时，会执行攻击者提供的脚本，从而获得root权限。
4. **代码分析:** exploit.c代码通过利用nf_tables的批量处理机制中的UAF漏洞，精巧地控制内核内存，最终劫持了`modprobe_path`，实现了提权。其中race condition的利用是成功利用漏洞的关键,需要通过调整sleep时间来提高成功率。
5.  **配置需求:**  PoC需要根据不同的内核版本进行配置，包括内核符号地址和机器码的调整，以确保能够正确利用漏洞。

**项目地址:** [RogelioPumajulca/TEST-CVE-2023-32233](https://github.com/RogelioPumajulca/TEST-CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #4

**来源**: [CVE-2023-32233-enlist12_CVE-2023-32233.md](../2023/CVE-2023-32233-enlist12_CVE-2023-32233.md)

## CVE-2023-32233

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel (Netfilter nf_tables)

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-32233是一个Linux内核中的use-after-free漏洞，存在于Netfilter nf_tables子系统中，当处理批量请求时可能被触发。根据漏洞库信息和搜索结果，该漏洞允许未经授权的本地用户通过利用此漏洞在内核内存中执行任意读写操作，从而获得root权限。

**有效性：** 根据搜索结果（例如，来自NSFOCUS CERT的通知），漏洞的PoC代码已被公开披露，表明该漏洞是可以被成功利用的。提供的POC代码片段（myconfig）显示了内核配置选项，例如启用`CONFIG_NETFILTER`，`CONFIG_NF_TABLES`和`User namespaces`，并禁用`CONFIG_WERROR`和`CONFIG_RETPOLINE`。这些配置都是为了便于漏洞的利用，并关闭一些缓解措施。综上，提供的POC代码有效。

**投毒风险：** 分析提供的代码片段：

*   `/README.md`： 包含启用和禁用某些内核配置选项的说明。 这些本身不是恶意代码，而是指示如何配置内核以重现或利用漏洞。
*   `/myconfig`： 这是内核配置文件的摘录，用于构建易受攻击的内核。 它本身也不是恶意代码，但它指定了使系统容易受到攻击的配置。

虽然这些文件本身并没有明显的恶意代码，但是有可能在完整的利用代码中隐藏了某些后门。 由于只提供了部分代码（配置文件和README），因此无法完全排除这种可能性。 这里给出一个较低的概率(5%)表示可能存在投毒代码，但缺乏充分证据。

**利用方式：**

1.  **触发漏洞：** 攻击者需要构造恶意的Netfilter nf_tables批量请求。
2.  **Use-After-Free：**  由于匿名集合处理不当，这会导致use-after-free情况。
3.  **任意读写：** 利用UAF漏洞在内核内存中执行任意读写操作。
4.  **权限提升：**  攻击者可以通过修改内核数据结构来提升自己的权限，最终获得root权限。

**项目地址:** [enlist12/CVE-2023-32233](https://github.com/enlist12/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #5

**来源**: [CVE-2023-32233-oferchen_POC-CVE-2023-32233.md](../2023/CVE-2023-32233-oferchen_POC-CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter nf_tables UAF

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel (Netfilter nf_tables)

**危害等级:** 高危，可导致权限提升

**影响版本:** <= 6.3.1

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 是 Linux 内核 Netfilter nf_tables 组件中的一个使用后释放漏洞。当处理批量请求时，删除规则和规则中的集合元素会导致use-after-free。攻击者可以利用此漏洞在内核内存中执行任意读写操作，从而获得 root 权限。

**漏洞利用方式：**

1.  漏洞存在于 `net/netfilter/nf_tables_api.c` 文件中。
2.  攻击者发送包含两个基本操作的批量请求：
    *   `NFT_MSG_DELRULE`：删除包含匿名 `nft_set` 的 `nft_rule`，这将隐式删除 `lookup` 表达式和匿名 `nft_set`。
    *   `NFT_MSG_DELSETELEM`：删除已删除的匿名 `nft_set` 中的元素。
3.  内核接受批量请求，调用 `nf_tables_commit_release()` 将释放的资源添加到 `nf_tables_destroy_list`。
4.  `nf_tables_trans_destroy_work()` 处理 `nf_tables_destroy_list`，首先通过调用 `nft_commit_release()` -> `nf_tables_rule_destroy()` -> `nf_tables_expr_destroy()` -> `expr->ops->destroy()` (指向 `nft_lookup_destroy()`) -> `nf_tables_destroy_set()` -> `nft_set_destroy()` -> `kvfree()` 释放 `nft_set` 占用的内存。
5.  之后，在处理 `NFT_MSG_DELSETELEM` 操作时，通过 `nft_commit_release()` -> `nf_tables_set_elem_destroy()` -> `nft_set_elem_ext()` 访问已释放的 `nft_set` 内存，导致使用后释放。
6.  `nft_set_elem_ext` 宏尝试访问释放的 `nft_set` 结构中的 `ops->elemsize` 字段，如果该字段被篡改，可能导致访问任意内存地址。
7.  通过竞争 `nf_tables_trans_destroy_work()`，可以尝试在释放的内存被重用之前修改 `nft_set` 的内容。
8.  PoC 通过增加销毁大量元素的 `nft_set` 操作来增加worker线程延迟，并使其他CPU核心繁忙，来增加竞争成功的几率。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞允许本地用户提权，并且存在公开的 PoC 代码。PoC 代码描述了利用 use-after-free 漏洞的技术，包括竞争条件和内存操作。因此，提供的 PoC 代码看起来是有效的。

**投毒风险：**

尽管PoC看起来旨在重现漏洞利用, 但仍然存在一些风险: 
* 仓库名称过于简单，缺乏实质内容, 增加了潜在的风险。
* 描述中存在一些拼写错误（例如：dea），可能是故意为之，以掩盖潜在的恶意代码。
*  通过延迟worker线程方式，增加了不确定性。 
综上所述，作者可能在PoC中加入了一些难以察觉的恶意代码，比如后门或信息收集功能。尽管PoC主要目的是演示漏洞利用，但也不能排除作者恶意投毒的可能性。因此，保守估计投毒风险为10%。建议在使用前进行代码审计。

**项目地址:** [oferchen/POC-CVE-2023-32233](https://github.com/oferchen/POC-CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #6

**来源**: [CVE-2023-32233-void0red_CVE-2023-32233.md](../2023/CVE-2023-32233-void0red_CVE-2023-32233.md)

# CVE-2023-32233

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-32233-Liuk3r_CVE-2023-32233.md](../2023/CVE-2023-32233-Liuk3r_CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter nf_tables Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel Netfilter nf_tables

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** <= 6.3.1

**利用条件:** 需要本地用户权限，目标内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 是 Linux kernel 中 Netfilter nf_tables 组件的 Use-After-Free 漏洞。该漏洞发生在处理批量请求更新 nf_tables 配置时，由于匿名集合处理不当导致。攻击者可以利用此漏洞在内核内存上执行任意读写操作，从而获得 root 权限。 

**漏洞利用有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞利用的有效性较高。搜索引擎结果表明，存在公开的 PoC 代码，并且已被成功利用以实现权限提升。漏洞描述中也明确指出，未授权的本地用户可以利用此漏洞获取 root 权限。

**投毒风险：**
阅读提供的漏洞利用代码片段，主要关注了利用 UAF 漏洞的原理和方法，例如通过竞争条件和内存布局来修改已释放的 `nft_set` 结构体的内容。虽然PoC代码中添加了延时操作和CPU亲和性来增加漏洞触发的概率，但这属于正常的漏洞利用手段，不属于恶意投毒。
投毒风险评估：10%。PoC的主要目的是演示漏洞的可利用性，而非植入后门或执行其他恶意操作。但是，任何未经审核的代码都存在潜在风险，建议在受控环境中测试。

**漏洞利用方式：**
1.  **构造恶意的批量请求：**  攻击者构造包含`NFT_MSG_DELRULE` (删除规则) 和 `NFT_MSG_DELSETELEM` (删除集合元素) 操作的 Netfilter nf_tables 批量请求。
2.  **触发Use-After-Free：**  `NFT_MSG_DELRULE` 操作会释放匿名 `nft_set` 结构体，而随后的 `NFT_MSG_DELSETELEM` 操作会尝试访问已释放的 `nft_set` 结构体，导致 Use-After-Free。
3.  **内存操作：**  攻击者在 `nft_set` 释放后，但在访问之前，尝试重新分配内存并写入特定值，通常是覆盖`set->ops->elemsize`。当后续代码尝试使用已释放的 `nft_set` 结构体时，例如计算偏移量，就会使用被篡改的值，导致访问到错误的内存位置。
4.  **权限提升：**  通过控制内存读写，攻击者可以覆盖内核中的关键数据结构，例如进程的权限信息，从而获得 root 权限。

**项目地址:** [Liuk3r/CVE-2023-32233](https://github.com/Liuk3r/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #2

**来源**: [CVE-2023-32233-PIDAN-HEIDASHUAI_CVE-2023-32233.md](../2023/CVE-2023-32233-PIDAN-HEIDASHUAI_CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel Netfilter nf_tables

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限，需要nf_tables配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 漏洞存在于Linux内核的Netfilter nf_tables子系统中，当处理批量请求以更新nf_tables配置时，会发生use-after-free漏洞。

**漏洞利用有效性:**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，可以判断此漏洞利用是有效的。POC代码描述了利用此漏洞的详细步骤，包括如何触发use-after-free，以及如何赢得与内核后台工作线程的竞争，从而实现可靠的利用。搜索引擎结果中也提到了公开的PoC。

**投毒风险:**
POC代码的目的是演示漏洞利用，并不能完全排除作者隐藏投毒代码的风险。代码中存在一定的复杂性，难以保证完全没有恶意代码。但从代码的功能和目的来看，作为漏洞利用，投毒的可能性较低。对已提供的POC代码进行初步分析，发现并无明显恶意代码，但仍需进一步审查。因此，将投毒风险评估为10%。

**利用方式:**
利用方式如下：
1.  **漏洞触发:** 通过构造恶意的nf_tables批量请求，其中包含删除规则（`NFT_MSG_DELRULE`）和删除集合元素（`NFT_MSG_DELSETELEM`）的操作。
2.  **Use-After-Free:** 删除规则操作会释放匿名集合（`nft_set`）的内存。之后，删除集合元素的操作会尝试访问已释放的内存，从而触发use-after-free漏洞。
3.  **竞争条件:** 攻击者需要与内核后台工作线程`nf_tables_trans_destroy_work()`竞争。为了增加成功率，POC代码会增加延迟，并使其他CPU核心繁忙，从而增加在特定CPU核心上重用已释放内存的机会。
4.  **内存重用:** 攻击者尝试分配新的`nft_set`或其他内核对象来重用已释放的内存。通过精心构造的数据，可以修改`nft_set`中的`ops->elemsize`等关键字段。
5.  **任意读写:**  修改`ops->elemsize`会导致`nft_set_elem_ext`计算出错误的内存地址，最终允许攻击者执行任意内核内存读写操作。
6.  **权限提升:** 攻击者可以使用任意内核内存读写操作来修改进程的凭据（credentials），从而获得root权限。

**项目地址:** [PIDAN-HEIDASHUAI/CVE-2023-32233](https://github.com/PIDAN-HEIDASHUAI/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #3

**来源**: [CVE-2023-32233-RogelioPumajulca_TEST-CVE-2023-32233.md](../2023/CVE-2023-32233-RogelioPumajulca_TEST-CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel Netfilter nf_tables Use-After-Free

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限，目标系统运行受影响的Linux内核版本且未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233是Linux内核Netfilter nf_tables组件中的一个使用后释放（Use-After-Free）漏洞。该漏洞发生在处理批量请求更新nf_tables配置时，由于匿名集合处理不当导致。未授权的本地用户可以利用此漏洞在内核内存中执行任意读写操作，从而获得root权限。

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞利用的有效性较高。漏洞库信息表明该漏洞确实存在，并且允许本地提权。搜索引擎结果中也显示存在公开的PoC代码。
提供的PoC代码包含构建和配置说明，以及如何针对不同内核进行调整的指导，包括内核符号地址和机器码的调整。这表明该PoC是经过验证的，并且具有一定的灵活性，可以适应不同的内核版本。

**投毒风险分析：**
分析PoC代码后，发现其中存在一些需要用户手动配置的参数，例如内核符号地址、机器码等。这些参数的配置需要一定的内核知识，如果配置不当，可能会导致PoC无法成功利用，甚至导致系统崩溃。但是，这些配置要求是由于内核版本和编译选项的差异造成的，属于正常情况，并非恶意投毒。
代码中没有发现明显的恶意代码或后门。需要注意的是，PoC本身可能会导致系统不稳定，甚至崩溃，这是利用UAF漏洞的常见风险。因此，在测试PoC时，建议在专用系统上进行，以避免数据损坏。
综合来看，投毒风险较低，大约为10%。主要风险在于PoC本身可能导致系统不稳定。

**利用方式分析：**
1.  **漏洞触发：** 通过精心构造的Netfilter nf_tables批量请求，触发use-after-free漏洞。漏洞的根源在于对匿名集合的处理不当。
2.  **内存破坏：**  利用use-after-free漏洞，在内核内存中执行任意读写操作。这允许攻击者覆盖关键的内核数据结构。
3.  **权限提升：**  通过覆盖`modprobe_path`变量，将执行modprobe的路径修改为攻击者控制的脚本。当内核尝试执行modprobe时，会执行攻击者提供的脚本，从而获得root权限。
4. **代码分析:** exploit.c代码通过利用nf_tables的批量处理机制中的UAF漏洞，精巧地控制内核内存，最终劫持了`modprobe_path`，实现了提权。其中race condition的利用是成功利用漏洞的关键,需要通过调整sleep时间来提高成功率。
5.  **配置需求:**  PoC需要根据不同的内核版本进行配置，包括内核符号地址和机器码的调整，以确保能够正确利用漏洞。

**项目地址:** [RogelioPumajulca/TEST-CVE-2023-32233](https://github.com/RogelioPumajulca/TEST-CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #4

**来源**: [CVE-2023-32233-enlist12_CVE-2023-32233.md](../2023/CVE-2023-32233-enlist12_CVE-2023-32233.md)

## CVE-2023-32233

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel (Netfilter nf_tables)

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-32233是一个Linux内核中的use-after-free漏洞，存在于Netfilter nf_tables子系统中，当处理批量请求时可能被触发。根据漏洞库信息和搜索结果，该漏洞允许未经授权的本地用户通过利用此漏洞在内核内存中执行任意读写操作，从而获得root权限。

**有效性：** 根据搜索结果（例如，来自NSFOCUS CERT的通知），漏洞的PoC代码已被公开披露，表明该漏洞是可以被成功利用的。提供的POC代码片段（myconfig）显示了内核配置选项，例如启用`CONFIG_NETFILTER`，`CONFIG_NF_TABLES`和`User namespaces`，并禁用`CONFIG_WERROR`和`CONFIG_RETPOLINE`。这些配置都是为了便于漏洞的利用，并关闭一些缓解措施。综上，提供的POC代码有效。

**投毒风险：** 分析提供的代码片段：

*   `/README.md`： 包含启用和禁用某些内核配置选项的说明。 这些本身不是恶意代码，而是指示如何配置内核以重现或利用漏洞。
*   `/myconfig`： 这是内核配置文件的摘录，用于构建易受攻击的内核。 它本身也不是恶意代码，但它指定了使系统容易受到攻击的配置。

虽然这些文件本身并没有明显的恶意代码，但是有可能在完整的利用代码中隐藏了某些后门。 由于只提供了部分代码（配置文件和README），因此无法完全排除这种可能性。 这里给出一个较低的概率(5%)表示可能存在投毒代码，但缺乏充分证据。

**利用方式：**

1.  **触发漏洞：** 攻击者需要构造恶意的Netfilter nf_tables批量请求。
2.  **Use-After-Free：**  由于匿名集合处理不当，这会导致use-after-free情况。
3.  **任意读写：** 利用UAF漏洞在内核内存中执行任意读写操作。
4.  **权限提升：**  攻击者可以通过修改内核数据结构来提升自己的权限，最终获得root权限。

**项目地址:** [enlist12/CVE-2023-32233](https://github.com/enlist12/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---

## POC #5

**来源**: [CVE-2023-32233-oferchen_POC-CVE-2023-32233.md](../2023/CVE-2023-32233-oferchen_POC-CVE-2023-32233.md)

## CVE-2023-32233-Linux Kernel-Netfilter nf_tables UAF

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel (Netfilter nf_tables)

**危害等级:** 高危，可导致权限提升

**影响版本:** <= 6.3.1

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32233 是 Linux 内核 Netfilter nf_tables 组件中的一个使用后释放漏洞。当处理批量请求时，删除规则和规则中的集合元素会导致use-after-free。攻击者可以利用此漏洞在内核内存中执行任意读写操作，从而获得 root 权限。

**漏洞利用方式：**

1.  漏洞存在于 `net/netfilter/nf_tables_api.c` 文件中。
2.  攻击者发送包含两个基本操作的批量请求：
    *   `NFT_MSG_DELRULE`：删除包含匿名 `nft_set` 的 `nft_rule`，这将隐式删除 `lookup` 表达式和匿名 `nft_set`。
    *   `NFT_MSG_DELSETELEM`：删除已删除的匿名 `nft_set` 中的元素。
3.  内核接受批量请求，调用 `nf_tables_commit_release()` 将释放的资源添加到 `nf_tables_destroy_list`。
4.  `nf_tables_trans_destroy_work()` 处理 `nf_tables_destroy_list`，首先通过调用 `nft_commit_release()` -> `nf_tables_rule_destroy()` -> `nf_tables_expr_destroy()` -> `expr->ops->destroy()` (指向 `nft_lookup_destroy()`) -> `nf_tables_destroy_set()` -> `nft_set_destroy()` -> `kvfree()` 释放 `nft_set` 占用的内存。
5.  之后，在处理 `NFT_MSG_DELSETELEM` 操作时，通过 `nft_commit_release()` -> `nf_tables_set_elem_destroy()` -> `nft_set_elem_ext()` 访问已释放的 `nft_set` 内存，导致使用后释放。
6.  `nft_set_elem_ext` 宏尝试访问释放的 `nft_set` 结构中的 `ops->elemsize` 字段，如果该字段被篡改，可能导致访问任意内存地址。
7.  通过竞争 `nf_tables_trans_destroy_work()`，可以尝试在释放的内存被重用之前修改 `nft_set` 的内容。
8.  PoC 通过增加销毁大量元素的 `nft_set` 操作来增加worker线程延迟，并使其他CPU核心繁忙，来增加竞争成功的几率。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞允许本地用户提权，并且存在公开的 PoC 代码。PoC 代码描述了利用 use-after-free 漏洞的技术，包括竞争条件和内存操作。因此，提供的 PoC 代码看起来是有效的。

**投毒风险：**

尽管PoC看起来旨在重现漏洞利用, 但仍然存在一些风险: 
* 仓库名称过于简单，缺乏实质内容, 增加了潜在的风险。
* 描述中存在一些拼写错误（例如：dea），可能是故意为之，以掩盖潜在的恶意代码。
*  通过延迟worker线程方式，增加了不确定性。 
综上所述，作者可能在PoC中加入了一些难以察觉的恶意代码，比如后门或信息收集功能。尽管PoC主要目的是演示漏洞利用，但也不能排除作者恶意投毒的可能性。因此，保守估计投毒风险为10%。建议在使用前进行代码审计。

**项目地址:** [oferchen/POC-CVE-2023-32233](https://github.com/oferchen/POC-CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)

---



---



---



---



---



---



---



---



---



---



---



---



---



---

