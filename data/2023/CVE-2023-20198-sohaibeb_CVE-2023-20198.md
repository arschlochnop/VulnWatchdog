# CVE-2023-20198

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-20198-Arshit01_CVE-2023-20198.md](../2023/CVE-2023-20198-Arshit01_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI权限提升漏洞

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响的Cisco设备

**影响版本:** 16.1.1 to 17.12.1及部分17.x版本

**利用条件:** Web UI功能已启用，且目标设备存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。未经身份验证的攻击者可以利用此漏洞创建具有特权级别15（最高权限）的本地用户，从而完全控制受影响的设备。利用过程分为两个阶段：首先利用CVE-2023-20198创建用户，其次利用CVE-2023-20273提升权限至root并写入植入程序。

**漏洞利用方式：**

1.  **身份验证绕过：** 漏洞允许未经身份验证的攻击者与设备的Web UI进行交互。
2.  **创建特权用户：** 攻击者发送特制的SOAP请求到Web UI，该请求绕过身份验证并允许攻击者创建一个具有特权级别15的新用户。
3.  **远程控制：** 创建具有最高权限的用户后，攻击者可以使用此帐户登录设备，并执行任意命令。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的POC代码，可以确认POC代码是有效的。搜索结果中的文章提到了漏洞的成功利用和概念验证代码的存在。POC代码也显示了通过发送特制的XML SOAP请求来创建新用户的机制。

**投毒风险：**

提供的POC代码存在轻微的投毒风险，约为10%。风险点分析如下：

*   **默认用户名和密码：** POC代码使用了默认的用户名（shellsmoke）和密码（pwned）。虽然这方便了漏洞测试，但如果未经修改直接用于攻击，很容易被检测到或被其他人利用。
*   **硬编码的URI：** POC中`exURI = '%2577eb%2575i_%2577sma_Http'`，如果攻击者修改此URI植入恶意代码，可能会导致拒绝服务或者其他恶意行为。
*   **命令执行：** 漏洞本身允许执行任意命令，攻击者可能通过植入恶意命令来感染设备。

需要注意的是，以上只是一些潜在的风险点，具体的投毒行为还需要进一步分析。POC的主要功能是验证漏洞的存在，而非恶意利用。因此，将其判定为具有投毒代码是不准确的。

**项目地址:** [Arshit01/CVE-2023-20198](https://github.com/Arshit01/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #2

**来源**: [CVE-2023-20198-Atea-Redteam_CVE-2023-20198.md](../2023/CVE-2023-20198-Atea-Redteam_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Software Web UI权限提升漏洞

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，未经身份验证的攻击者可以创建具有特权级别15访问权限的帐户，并最终导致完全控制受影响的系统。

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1以及17.11.99SW等众多版本

**利用条件:** Web UI 功能必须启用。需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个关键漏洞。未经身份验证的远程攻击者可以利用此漏洞在受影响的系统上创建具有特权级别 15（完全访问所有命令）的帐户。利用方式是攻击者发送特制的 HTTP 请求到 `/webui/logoutconfirm.html?logon_hash=1` 路径，绕过身份验证，并执行特权命令以创建本地用户和密码组合。创建用户后，攻击者可以利用另一个漏洞（CVE-2023-20273）提升权限至 root 并写入植入程序到文件系统。提供的 Python 脚本 `CVE-2023-20198.py` 旨在检测是否存在该漏洞，并检查已知的 IOC。  该脚本扫描指定子网，并检查目标设备是否返回预期的响应状态码和内容长度。投毒风险评估：脚本本身主要用于检测，但由于脚本包含发送特定请求到目标设备的逻辑，如果攻击者修改此脚本，可能会加入恶意负载或更改用户创建的用户名/密码，存在一定的投毒风险.脚本中存在User-Agent:Atea Red Team CVE-2023-20198 checkscript特征,可能被安全设备检测到。存在的风险点是如果未经授权的人员使用了修改后的脚本，可能会对网络造成损害。 README.md文件没有发现异常。

**项目地址:** [Atea-Redteam/CVE-2023-20198](https://github.com/Atea-Redteam/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #3

**来源**: [CVE-2023-20198-DOMINIC471_qub-network-security-cve-2023-20198.md](../2023/CVE-2023-20198-DOMINIC471_qub-network-security-cve-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权级别15的账户，完全控制受影响的设备。

**影响版本:** 受影响版本众多，包括16.1.1到17.12.1以及其他版本（详见漏洞库信息）。

**利用条件:** Web UI功能必须已启用。设备需要可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞允许未经身份验证的攻击者在Cisco IOS XE设备上创建具有特权级别15（最高权限）的本地用户。攻击者通过利用Web UI中的漏洞绕过身份验证，并执行特权命令创建用户。结合另一个漏洞CVE-2023-20273，攻击者可以进一步提升权限至root并写入植入程序到文件系统。 

**有效性评估：**
根据提供的漏洞库信息和搜索结果，CVE-2023-20198是一个严重漏洞，已被积极利用。

**投毒风险评估：**
查看提供的POC代码，包括README.md和IOC Summary.md文件。 README.md主要描述了如何分析、检测和缓解此漏洞。IOC Summary.md列出了攻击者IP，受害者IP，使用的header以及payload等。这些信息可以辅助蓝队进行防御。
总体来说，该仓库的目的是为了分析和缓解漏洞，并没有发现明显的投毒代码。但是，由于代码中可能包含攻击载荷或恶意命令示例，如果使用者不小心，可能会误用这些代码进行非授权的渗透测试，从而导致法律风险。因此，评估的投毒风险为10%。

**利用方式：**
1.  **未授权访问：** 攻击者利用漏洞，绕过Web UI的身份验证机制。
2.  **创建特权用户：** 攻击者通过发送特制的HTTP请求，执行CLI命令，创建一个具有特权级别15的本地用户。
3.  **持久化（结合CVE-2023-20273）：** 攻击者利用新创建的本地用户登录，并利用另一个漏洞（CVE-2023-20273）提升权限到root，并在文件系统中写入植入程序，实现持久化控制。

**缓解措施：**
*   禁用Web UI功能，如果不需要使用。
*   升级到已修复漏洞的IOS XE软件版本。
*   使用入侵检测/防御系统（IDS/IPS）检测和阻止利用此漏洞的攻击。
*   检查设备上是否存在异常用户和植入程序。

**项目地址:** [DOMINIC471/qub-network-security-cve-2023-20198](https://github.com/DOMINIC471/qub-network-security-cve-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #4

**来源**: [CVE-2023-20198-G4sul1n_Cisco-IOS-XE-CVE-2023-20198.md](../2023/CVE-2023-20198-G4sul1n_Cisco-IOS-XE-CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权15权限的本地用户，结合CVE-2023-20273可提升至root权限并植入后门。

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他相关版本，具体参见漏洞库信息。

**利用条件:** 需要目标系统启用Web UI功能，且网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。根据漏洞信息和搜索结果，该漏洞允许未经身份验证的远程攻击者在受影响的系统上创建一个具有特权级别 15 访问权限的帐户。Cisco的公告指出，攻击者首先利用此漏洞获得初始访问权限，然后执行特权 15 命令以创建本地用户和密码组合。随后，攻击者利用 CVE-2023-20273 将权限提升到 root 并将植入程序写入文件系统。根据提供的漏洞利用代码，该 PoC 包含以下功能：

*   **漏洞检查**：通过执行 `uname -a` 命令来验证漏洞是否存在。
*   **获取 Cisco 配置**：执行 `sh run` 命令来提取运行配置。
*   **执行命令**：允许执行任意 Cisco IOS 命令，但警告需要谨慎使用，因为没有输入验证。
*   **添加用户**：创建一个新的特权 15 用户帐户，可以选择指定用户名和密码。
*   **删除用户**：从设备中删除用户帐户。

**有效性：**

该 PoC 代码的有效性较高，因为漏洞库信息和搜索结果都表明该漏洞已被 активно используется。此外，该 PoC 提供了多种利用方式，包括漏洞检查、信息收集和权限提升。

**投毒风险：**

尽管 PoC 代码主要用于利用已知的漏洞，但仍存在一定的投毒风险，估计为10%。风险点包括：

*   **命令执行**：通过 `-e` 选项执行任意命令，攻击者可能利用此功能执行恶意操作。
*   **用户管理**：虽然提供了添加和删除用户的选项，但如果被滥用，可能导致拒绝服务或系统损坏。

虽然PoC代码本身看起来是为了复现漏洞，但不能完全排除代码作者在其中隐藏恶意功能的可能性，例如植入后门、收集敏感信息等。因此，在使用 PoC 代码时，需要进行仔细审查和安全评估。

**利用方式：**

1.  **未经身份验证的访问**：利用 CVE-2023-20198 绕过身份验证，访问 `webui_wsma_http` Web 端点。
2.  **创建特权用户**：使用 `cisco:wsma-config` SOAP 端点创建一个具有特权 15 的新用户帐户。
3.  **执行任意命令**：使用 `cisco:wsma-exec` SOAP 端点执行任意 Cisco IOS 命令。
4.  **权限提升 (结合 CVE-2023-20273)**：利用新创建的特权用户，结合 CVE-2023-20273 将权限提升到 root，并在系统上植入后门。

总而言之，CVE-2023-20198 是一个严重的安全漏洞，需要立即采取措施进行修复。在使用 PoC 代码时，需要谨慎评估风险，并确保在受控环境中进行测试。

**项目地址:** [G4sul1n/Cisco-IOS-XE-CVE-2023-20198](https://github.com/G4sul1n/Cisco-IOS-XE-CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #5

**来源**: [CVE-2023-20198-IceBreakerCode_CVE-2023-20198.md](../2023/CVE-2023-20198-IceBreakerCode_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权级别 15 的帐户，从而完全控制设备

**影响版本:** 16.1.1 to 17.12.1 and earlier versions

**利用条件:** Web UI 功能已启用并且设备易受攻击版本的影响。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个漏洞，允许未经身份验证的远程攻击者在受影响的系统上创建具有特权级别 15 访问权限的帐户。 

**漏洞利用方式：**

1.  攻击者发送一个特制的 HTTP POST 请求到 `/webui/logoutconfirm.html?logon_hash=1` 端点，绕过身份验证。
2.  成功利用此漏洞后，攻击者可以执行任意命令，包括创建具有特权级别 15 的本地用户。
3.  然后，攻击者使用另一个漏洞（CVE-2023-20273）并通过新创建的本地用户权限提升到 root 权限，并将植入程序写入文件系统。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判定该漏洞的POC代码是有效的。漏洞库信息明确指出存在正在进行的漏洞利用活动。搜索结果也提供了多个关于该漏洞的深度分析和POC示例的链接，例如horizon3.ai上的POC代码。
提供的python脚本模拟了发送特制HTTP请求的过程，旨在检测目标系统是否存在漏洞。脚本会检查HTTP响应状态码和响应体内容，以判断是否存在潜在的植入程序。

**投毒风险：**

评估POC代码的投毒风险，需要仔细分析代码是否存在恶意行为，例如：
1.  **植入后门：**  代码是否在目标系统上安装未经授权的后门。
2.  **数据窃取：**  代码是否窃取敏感信息并发送到外部服务器。
3.  **拒绝服务：**  代码是否导致目标系统崩溃或无法正常运行。
4.  **恶意传播：**  代码是否试图感染其他系统。

分析提供的python脚本，该脚本主要用于检测漏洞是否存在，并未发现明显的恶意行为。脚本的功能是发送特定的HTTP请求并检查响应，以确定目标系统是否受到CVE-2023-20198漏洞的影响。然而，使用任何未经授权的漏洞利用代码都存在风险，因为代码的作者可能隐藏了不易察觉的恶意功能。因此，在使用任何POC代码之前，务必进行彻底的安全审查。

考虑到以上因素，判定该POC代码存在10%的投毒风险，主要是由于作者可能隐藏了一些不易察觉的恶意代码，但主要功能是漏洞验证。

**缓解措施：**

*   禁用 Web UI 功能，特别是当设备面向互联网时。
*   将 Web UI 访问限制为受信任的网络。
*   升级到已修复漏洞的 Cisco IOS XE 软件版本。

**项目地址:** [IceBreakerCode/CVE-2023-20198](https://github.com/IceBreakerCode/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #6

**来源**: [CVE-2023-20198-JoyGhoshs_CVE-2023-20198.md](../2023/CVE-2023-20198-JoyGhoshs_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可导致完全控制受影响设备

**影响版本:** 受影响版本范围广泛，详见漏洞库信息

**利用条件:** Web UI功能已启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198 允许未经身份验证的攻击者在受影响的系统上创建具有权限级别15（完全访问权限）的帐户。该漏洞利用方式如下：

1.  **初始访问:** 攻击者利用CVE-2023-20198漏洞，通过Web UI创建具有高权限的本地用户。
2.  **权限提升:** 然后，攻击者可能利用CVE-2023-20273（另一个漏洞）或使用新创建的本地用户进一步将权限提升至root。
3.  **植入后门:** 攻击者利用获得的root权限，在文件系统中写入恶意植入。

提供的POC代码`poc.py`是一个**检测工具**，而非完整的漏洞利用代码。它通过发送一个特定的HTTP请求到`/webui/logoutconfirm.html?logon_hash=1`，并检查响应内容是否为十六进制字符串来判断目标是否可能受到了攻击并植入了后门。如果响应是十六进制字符串，则表明设备可能已遭入侵，并存在植入的后门（该后门会返回hex信息）。

该存储库中的`README.md`文件说明，此脚本并非完整的POC，仅用于检查是否存在hex响应。因此，它无法直接用于漏洞利用，而只能用于检测。

**投毒风险分析：**

查看`poc.py`文件内容，发现其功能主要是发送HTTP请求并判断响应内容。该代码的功能比较简单，未发现任何可能导致恶意行为（例如，上传恶意文件、执行任意命令等）的可疑代码。因此，可以认为该存储库不存在作者隐藏的投毒代码。



**项目地址:** [JoyGhoshs/CVE-2023-20198](https://github.com/JoyGhoshs/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #7

**来源**: [CVE-2023-20198-Pushkarup_CVE-2023-20198.md](../2023/CVE-2023-20198-Pushkarup_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的远程攻击者创建管理员账户并完全控制设备

**影响版本:** 受影响版本详见CVE描述

**利用条件:** 目标设备启用了Web UI功能，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞存在于 Cisco IOS XE 软件的 Web UI 中。未经身份验证的远程攻击者可以通过利用此漏洞在受影响的系统上创建具有特权级别 15 访问权限的帐户。创建账户后，攻击者可以使用该账户完全控制受损的机器。

**有效性：**
提供的 POC 代码根据描述能够创建本地用户，安装植入体，重启Web服务，并检查植入体的状态，因此具备有效性。

**投毒风险：**
此仓库中可能存在作者隐藏的投毒代码。尽管自述文件声明 PoC 仅用于教育目的，并且使用需要遵守道德规范，但攻击者可以修改 `config_content` 以包含恶意配置，例如更改防火墙规则或执行其他恶意操作。此外，虽然代码本身没有明显的恶意行为，但其目的是在目标系统上创建具有管理权限的用户，这本身就可以被认为是恶意的。因此，存在一定的投毒风险，但是相对较低，风险评估在10%。此风险评估基于以下因素：
    *   代码可能被用于未授权的系统访问。
    *   配置文件可被修改为包含恶意指令。

**利用方式：**
1.  攻击者利用 CVE-2023-20198 漏洞，通过未授权访问在 Cisco IOS XE 设备上创建一个具有特权级别 15 的本地用户。
2.  攻击者使用新创建的管理员账户登录到设备。
3.  攻击者利用 CVE-2023-20273 漏洞，进一步提升权限至 root 级别，并将恶意植入程序写入文件系统。
4.  攻击者通过植入的后门程序远程控制设备，执行恶意操作，例如数据窃取、网络攻击等。
根据搜索结果，CISA 已将此漏洞添加到已知被利用的漏洞目录中，表明该漏洞已经被广泛利用。

**项目地址:** [Pushkarup/CVE-2023-20198](https://github.com/Pushkarup/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #8

**来源**: [CVE-2023-20198-RevoltSecurities_CVE-2023-20198.md](../2023/CVE-2023-20198-RevoltSecurities_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，可被未授权的攻击者利用创建特权用户，进而完全控制系统。

**影响版本:** 受影响的版本包括16.1.1到17.12.1以及其他一系列17.x版本 (详见漏洞库信息)

**利用条件:** 目标设备启用Web UI功能，并且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。根据漏洞库信息和搜索引擎结果，未经身份验证的攻击者可以利用此漏洞在受影响的系统上创建一个具有 15 级权限（最高权限）的帐户。随后攻击者再利用CVE-2023-20273，将权限提升至root，并写入植入体。该漏洞的利用方式如下：

1.  **漏洞触发：** 攻击者发送特制的HTTP请求到Cisco IOS XE设备的Web UI接口，绕过身份验证。
2.  **创建特权用户：** 请求中包含特定的XML内容，该内容允许攻击者创建一个新的本地用户，并分配最高权限（privilege level 15）。
3.  **权限提升：** 攻击者利用创建的特权用户登录系统。
4.  **植入后门：** 攻击者通过Web UI的另一个组件（CVE-2023-20273）将权限提升至root并写入植入体。

**有效性：** 根据搜索引擎结果（特别是horizon3.ai的POC）以及提供的漏洞利用代码，此漏洞利用是有效的。漏洞利用代码仓库提供了一个Python脚本，可以检测和利用此漏洞。

**投毒风险：** 漏洞利用代码仓库的投毒风险评估为10%。虽然该仓库提供了看似合理的漏洞利用脚本，但存在以下潜在风险点：

*   **自定义配置内容：** 脚本允许用户提供自定义的配置内容（`-cfc` 或 `--config-content` 参数），这可能被滥用以注入恶意代码或配置。
*   **隐蔽后门：** 虽然主要功能是利用漏洞，但作者可能在代码中添加了不易察觉的后门，例如收集目标信息、执行任意命令等。代码量较少，通读代码可以降低风险。

**防范措施：**

*   立即更新Cisco IOS XE软件到已修复的版本。
*   禁用Web UI功能，如果不需要。
*   监控网络流量，检测异常的Web UI请求。
*   使用Cisco提供的软件检查工具来识别和移除潜在的植入体。

**项目地址:** [RevoltSecurities/CVE-2023-20198](https://github.com/RevoltSecurities/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #9

**来源**: [CVE-2023-20198-Shadow0ps_CVE-2023-20198-Scanner.md](../2023/CVE-2023-20198-Shadow0ps_CVE-2023-20198-Scanner.md)

## CVE-2023-20198 Cisco IOS XE Web UI 权限提升漏洞

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权 15 权限的本地用户，从而完全控制受影响的设备。

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1 以及 17.11.99SW

**利用条件:** Web UI 功能必须已启用。攻击者需要能够通过网络访问设备的 Web UI。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。未经身份验证的远程攻击者可以利用此漏洞在受影响的系统上创建一个具有特权 15 访问权限的帐户，本质上是管理员权限。漏洞利用通常与另一个漏洞 CVE-2023-20273 结合使用，后者用于将权限提升到 root 并将植入程序写入文件系统。

**漏洞利用有效性：**

根据漏洞库信息、搜索引擎结果（特别是 horizon3.ai 的 PoC 描述）以及提供的漏洞利用代码片段来看，该漏洞的利用是有效的。存在公开可用的 PoC，允许攻击者绕过身份验证创建具有管理权限的用户。

**投毒风险分析：**

提供的代码片段分析表明，攻击流程依赖于 Nginx 配置和一个 Lua 脚本。Lua 脚本的核心功能在于身份验证绕过和命令执行。脚本通过检查是否存在特定的 "Authorization" Header以及Header的内容是否和通过REDACTED命令执行结果匹配来确定请求是否被授权。

由于 "REDACTED" 信息的缺失，我们无法完全确定是否存在恶意投毒代码。但是lua脚本的下列行为存在潜在的投毒风险：

1.  **外部命令执行:** 脚本多次使用 `io.popen()` 执行外部命令。如果这些命令包含恶意参数或旨在下载和执行其他代码，则可能导致系统受损。
2.  **硬编码的凭据和逻辑：**脚本逻辑依赖于特定的哈希值和其他硬编码的字符串。攻击者可能会修改这些字符串以创建变体，从而绕过安全检测或植入后门。
3.  **对/lua5的请求:** 当common_type=iox时,会调用/lua5,如果/lua5是作者控制的地址,则存在投毒风险。

基于以上分析，虽然无法确定明确的投毒代码，但脚本中使用的技术（尤其是外部命令执行）增加了被用于恶意目的的可能性，估计投毒风险为20%。

**漏洞利用方式：**

1.  **未授权访问:** 攻击者发送一个特制的 HTTP POST 请求到 `/webui/logoutconfirm.html`，绕过身份验证检查（利用 CVE-2023-20198）。这可能涉及到提供特定的 `Authorization` header，该header的值能够通过预设的验证。
2.  **创建高权限用户:** 绕过身份验证后，攻击者可以发送包含创建新用户（具有特权级别 15）的命令的请求体。该命令通过 `io.popen()` 执行，从而创建一个具有管理员权限的本地用户。
3.  **权限提升和植入：** (结合 CVE-2023-20273) 使用新创建的本地用户登录并利用 CVE-2023-20273 将权限提升至 root，从而能够在设备上安装植入程序。


**项目地址:** [Shadow0ps/CVE-2023-20198-Scanner](https://github.com/Shadow0ps/CVE-2023-20198-Scanner)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #10

**来源**: [CVE-2023-20198-Tounsi007_CVE-2023-20198.md](../2023/CVE-2023-20198-Tounsi007_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可能导致完全控制受影响设备

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他版本

**利用条件:** 目标设备启用了Web UI功能并且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞存在于Cisco IOS XE Software的Web UI中，允许未经身份验证的远程攻击者创建一个具有特权级别15（完全访问权限）的本地用户帐户。该漏洞利用方式是通过发送特制的HTTP请求到`/webui/create_user`路径来创建用户。攻击者随后可利用创建的用户并通过另一个漏洞CVE-2023-20273提升权限至root并写入植入程序。提供的POC代码尝试模拟此过程，包括创建用户、安装植入程序、重启Web服务器、检查植入程序状态以及清理创建的用户。 

**有效性：**根据漏洞信息、搜索结果和提供的POC代码，该漏洞是有效的。搜索引擎结果表明该漏洞已被积极利用，并且存在公开可用的POC代码。CISA的已知被利用漏洞目录也收录了该漏洞。

**投毒风险：**POC代码本身存在一定的风险。虽然代码的主要功能是利用漏洞，但`config_content`变量表明存在植入恶意配置的可能性。 用户需要手动插入植入配置,存在被植入后门的风险。
该仓库readme描述，POC仅用于测试和学习，有免责声明。存在一定概率作者未充分测试。

**利用方式：**
1.  **初始访问：** 未经身份验证的攻击者发送特制HTTP请求到存在漏洞的Cisco IOS XE设备的Web UI接口。
2.  **用户创建：**  利用CVE-2023-20198，攻击者通过`/webui/create_user`接口创建一个具有管理员权限的新用户。
3.  **权限提升（CVE-2023-20273）：** 利用新创建的用户，攻击者可以进一步利用Web UI中的另一个漏洞（CVE-2023-20273）来提升权限至root。
4.  **植入后门：** 攻击者可以写入植入程序到文件系统。
5.  **持久化：** 植入程序可以用于维持对受感染设备的访问。
6.  **清理（可选）：** 攻击者可以选择删除他们创建的后门账户，以隐藏其踪迹。

**项目地址:** [Tounsi007/CVE-2023-20198](https://github.com/Tounsi007/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #11

**来源**: [CVE-2023-20198-Vulnmachines_Cisco_CVE-2023-20198.md](../2023/CVE-2023-20198-Vulnmachines_Cisco_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可使未授权的攻击者获得完全管理权限

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1 以及其他多个版本

**利用条件:** Web UI 功能启用并且 HTTP 或 HTTPS 服务器功能开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个关键身份验证绕过漏洞。根据漏洞信息和搜索结果，攻击者利用此漏洞首先获得初始访问权限，然后执行特权 15 命令来创建一个本地用户和密码组合，从而获得管理员权限。之后，攻击者利用 CVE-2023-20273 将权限提升到 root 并在文件系统中写入植入程序。提供的 POC 代码显示了一个用于利用漏洞的 HTTP POST 请求示例。请求的目标 URI 经过编码处理，绕过了身份验证。请求体包含一个 SOAP 信封，该信封尝试使用默认的 "admin" 用户名执行命令 "uname -a"。有效性：根据搜索结果和漏洞描述，提供的 POST 请求通过身份验证绕过在受影响的设备上创建具有特权 15 的用户，因此 POC 代码有效。 投毒风险：README.md 文件描述了漏洞，并提供了一个关于利用该漏洞的概述。Payload 文件包含一个 SOAP 请求，用于发送 CLI 命令。虽然该请求本身看起来无害（执行 `uname -a` 命令），但攻击者可能会修改该请求以执行恶意命令。例如，更改命令以创建具有特权 15 的用户。 因此，存在一定风险，即此仓库可能被用于传播恶意利用程序。Payload 代码文件本身没有明显的投毒代码，但存在被修改利用的风险，因此判定投毒风险为 10%。利用方式：1. 检查目标 Cisco IOS XE 设备是否启用了 Web UI 功能和 HTTP/HTTPS 服务器。2. 发送构造的 HTTP POST 请求到目标设备，利用身份验证绕过漏洞。3. 请求的目标 URI 经过编码处理以绕过身份验证检查。4. POST 请求的内容为 SOAP 信封，其中包含要执行的 CLI 命令。5. 成功利用后，攻击者可以在设备上执行任意 CLI 命令，例如创建新的管理员帐户或植入恶意软件。

**项目地址:** [Vulnmachines/Cisco_CVE-2023-20198](https://github.com/Vulnmachines/Cisco_CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #12

**来源**: [CVE-2023-20198-W01fh4cker_CVE-2023-20198-RCE.md](../2023/CVE-2023-20198-W01fh4cker_CVE-2023-20198-RCE.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权15的用户，进而完全控制受影响的设备。

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1 等多个版本

**利用条件:** Web UI 功能已启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。未经身份验证的远程攻击者可以利用此漏洞在受影响的系统上创建一个具有特权 15 访问权限的帐户，从而完全控制设备。利用方式如下：

1.  **漏洞触发点：** Cisco IOS XE 软件的 Web UI 组件存在漏洞。
2.  **利用过程：** 攻击者通过发送特制的 SOAP 请求到 `/%%77ebui_wsma_https` 或 `/%%77ebui_wsma_Http` URI (具体取决于是否使用 HTTPS) 绕过身份验证。
3.  **命令执行：** 攻击者使用 `urn:cisco:wsma-config` 命名空间执行 CLI 命令，创建新的具有特权 15 的用户。
4.  **后续利用 (CVE-2023-20273):** 在获得初始访问权限后，攻击者可以利用 CVE-2023-20273 将权限提升为 root 并在文件系统中写入植入程序。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞已被积极利用，提供的 PoC 代码有效，可以用于创建具有特权 15 的用户。

**投毒风险：**

PoC 代码主要功能是利用漏洞，创建新用户，从代码本身来看，存在一些潜在的投毒点，例如：

*   **随机用户名/密码生成：**  虽然代码中包含随机用户名生成函数，但实际使用中，攻击者可能会替换为预设的用户名和密码，方便后续控制。
*   **代理服务器使用：**  PoC 代码支持使用代理服务器，攻击者可以借此隐藏真实 IP 地址，增加溯源难度。
*   **异常处理：**  代码中包含异常处理模块，可能用于隐藏利用过程中的错误信息，避免被发现。
*   **User-Agent:** 使用了常见的User-Agent，但是依然存在替换或者增加其他User-Agent进行恶意攻击.

总体来说，PoC 代码的投毒风险较低，主要集中在以上几点，但需要使用者谨慎使用。

**总结：**

该漏洞利用的有效性很高，并且在野外被广泛利用。PoC 代码可以用来验证漏洞的存在并创建管理员用户，但需要注意潜在的投毒风险。利用方式是发送特制的 SOAP 请求，绕过身份验证，然后执行 CLI 命令。

**项目地址:** [W01fh4cker/CVE-2023-20198-RCE](https://github.com/W01fh4cker/CVE-2023-20198-RCE)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #13

**来源**: [CVE-2023-20198-XiaomingX_cve-2023-20198-poc.md](../2023/CVE-2023-20198-XiaomingX_cve-2023-20198-poc.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响设备

**影响版本:** 受影响版本范围广泛，详见漏洞库信息

**利用条件:** Web UI 功能启用且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 存在于 Cisco IOS XE 软件的 Web UI 中。未经身份验证的攻击者可以利用此漏洞创建具有 privilege level 15 权限的本地用户，从而获得对设备的完全控制权。利用方式主要通过发送特制的 SOAP 请求到目标设备的 Web UI 接口，绕过身份验证，执行 CLI 命令。PoC 代码通过构造恶意的 SOAP 消息，例如 `username <username> privilege 15 secret <password>`，添加高权限用户。 

有效性分析：根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开的 PoC。提供的 PoC 代码实现了漏洞利用的基本功能，包括检查漏洞、获取配置、执行命令和添加/删除用户。因此，提供的 PoC 代码是有效的。

投毒风险分析：代码本身主要实现了漏洞利用功能，但仍然存在一定的投毒风险。体现在以下几个方面：

*   **恶意命令执行：** 虽然代码本身没有硬编码的恶意命令，但 `-e` 参数允许攻击者执行任意 Cisco IOS 命令。攻击者可能会使用此参数注入恶意配置或植入后门。
*   **硬编码凭据：** 默认用户名 `shellsmoke` 和密码 `pwned` 如果不修改，可能被其他攻击者利用。虽然这是一个PoC，但在实际使用中容易被忽视，从而导致设备被二次入侵。
*   **异常处理：** 某些异常处理不够完善，可能导致程序崩溃或泄露敏感信息。
*   **Payload内容:** 在SOAP请求模板中，攻击者可能修改命令或者在ADD_USER的情况下，添加后门账户。

综合考虑，该 PoC 存在一定的投毒风险，但主要集中在用户使用不当或被恶意利用的可能性上，PoC本身是漏洞的利用，投毒代码的可能性评判为 10%。建议使用者在使用 PoC 时仔细审查代码，并采取必要的安全措施。

利用方式总结：

1.  **目标确认：** 确定目标 Cisco IOS XE 设备是否启用了 Web UI 功能。
2.  **发送恶意 SOAP 请求：** 构造包含 CLI 命令的恶意 SOAP 请求，绕过身份验证。
3.  **权限提升：** 利用漏洞创建具有 privilege level 15 权限的本地用户。
4.  **完全控制：** 使用新创建的用户登录并完全控制设备。

**项目地址:** [XiaomingX/cve-2023-20198-poc](https://github.com/XiaomingX/cve-2023-20198-poc)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #14

**来源**: [CVE-2023-20198-ZephrFish_CVE-2023-20198-Checker.md](../2023/CVE-2023-20198-ZephrFish_CVE-2023-20198-Checker.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权15权限的本地用户，随后可能被用于植入后门和完全控制设备

**影响版本:** 受影响版本：16.1.1 到 17.12.1，以及其他相关版本（详见漏洞库信息）

**利用条件:** 目标设备启用了Web UI功能，且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞允许未经身份验证的攻击者在受影响的 Cisco IOS XE 设备上创建一个具有特权 15 权限（最高权限）的本地用户。该漏洞存在于 Web UI 功能中。根据搜索引擎结果和漏洞库信息，此漏洞已被积极利用。提供的漏洞利用代码 `XEImplantScanner.py` 主要用于扫描目标系统是否存在漏洞以及是否被植入后门。该脚本通过发送特定的 HTTP 请求到 `/webui/logoutconfirm.html` 端点来检测漏洞和后门的存在。

**利用方式：**

1.  **初始访问：** 未经身份验证的攻击者发送特制的 HTTP 请求到目标设备的 Web UI。
2.  **权限提升：** 利用 CVE-2023-20198，创建一个具有特权 15 权限的本地用户。
3.  **后门植入（CVE-2023-20273）：** 使用新创建的具有特权的用户，攻击者可以进一步利用另一个漏洞（CVE-2023-20273）来提升权限至 root，并将植入体写入文件系统，实现持久化控制。

**有效性：**

根据搜索引擎结果（例如，horizon3.ai 的文章）和漏洞库信息，CVE-2023-20198 漏洞已被成功利用。提供的 POC 代码 `XEImplantScanner.py` 旨在检测漏洞的存在以及后门的植入，本身不包含直接利用漏洞进行权限提升的代码，需要结合 CVE-2023-20273 来完全控制。

**投毒风险：**

POC 代码 `XEImplantScanner.py` 主要功能是扫描，相对安全。可能的投毒风险在于：

*   **结果误导：** 扫描结果可能被篡改，导致用户误判系统的安全状态。
*   **依赖风险：** 脚本依赖于 `requests` 库，如果 `requests` 库被恶意版本替换，可能导致代码执行。
*   **网络钓鱼:** 脚本可能被用于钓鱼，诱导用户扫描恶意服务器，泄露信息。

因此，评估的投毒风险为 10%。主要是考虑到其扫描器性质，以及依赖库被投毒的可能性。

**项目地址:** [ZephrFish/CVE-2023-20198-Checker](https://github.com/ZephrFish/CVE-2023-20198-Checker)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #15

**来源**: [CVE-2023-20198-alekos3_CVE_2023_20198_Detector.md](../2023/CVE-2023-20198-alekos3_CVE_2023_20198_Detector.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响系统

**影响版本:** 见受影响版本列表

**利用条件:** Web UI 功能已启用,网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。攻击者可以利用此漏洞绕过身份验证，创建一个具有 15 级权限的本地用户，从而完全控制受影响的系统。该漏洞结合 CVE-2023-20273 使用，CVE-2023-20198 用于初始访问，CVE-2023-20273 用于提权至 root 并写入植入程序到文件系统。

**利用方式：**

1.  未经身份验证的攻击者发送特制的HTTP请求到启用了Web UI的Cisco IOS XE设备。
2.  利用CVE-2023-20198漏洞，创建一个具有特权级别15的本地用户。
3.  使用新创建的本地用户利用CVE-2023-20273漏洞，将权限提升到root。
4.  将植入程序写入文件系统，从而完全控制设备。

**POC代码分析：**

提供的Python脚本 (`CVE_2023_20198_detector.py`) 主要用于检测设备是否存在漏洞，而不是利用该漏洞。它通过SSH连接到设备，并运行一些命令来检查Web UI是否启用，并尝试检测是否存在攻击迹象，例如存在`ip http server`, `ip http secure-server`,  `ip http active`配置。脚本通过`netmiko`库实现SSH连接和命令执行。该脚本没有直接创建特权用户的恶意代码，只是用于检测是否存在漏洞。该脚本会生成一个csv文件`Results_CVE_2023_20198_{current_timestamp}.csv` 用于记录检测结果。

**有效性：**

根据搜索引擎结果，存在公开的POC代码，可以创建特权用户。`CVE_2023_20198_detector.py`脚本本身并不能直接利用漏洞，它只能用来检测目标是否存在漏洞。

**投毒风险：**

该脚本的投毒风险极低 (0%)。虽然用户需要输入用户名和密码，但是该脚本只是用来检测是否存在漏洞，没有发现任何可疑的代码或后门，也没有修改系统配置的任何行为。LICENSE文件为标准的MIT License。

**项目地址:** [alekos3/CVE_2023_20198_Detector](https://github.com/alekos3/CVE_2023_20198_Detector)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #16

**来源**: [CVE-2023-20198-emomeni_Simple-Ansible-for-CVE-2023-20198.md](../2023/CVE-2023-20198-emomeni_Simple-Ansible-for-CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可导致完全控制受影响的设备

**影响版本:** 16.1.1 to 17.12.1

**利用条件:** Web UI 功能已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。根据漏洞库信息和搜索引擎结果，未经身份验证的攻击者可以利用此漏洞创建一个具有 15 级权限（完全访问所有命令）的本地用户。攻击者首先利用 CVE-2023-20198 获得初始访问权限，然后执行权限 15 命令来创建本地用户和密码组合，允许该用户以普通用户身份登录。 然后攻击者利用 web UI 功能的另一个组件，利用新的本地用户将权限提升到 root 并将植入程序写入文件系统，cve-2023-20273。

**有效性：**
根据搜索引擎结果（例如Horizon3.ai的博客），已经存在公开可用的PoC，并且漏洞被积极利用。提供的Ansible剧本并不是直接的漏洞利用代码，而是用于检测并禁用HTTP/HTTPS服务器以缓解漏洞。它也能检测是否已经遭受攻击，通过分析syslog。

**投毒风险：**
提供的Ansible剧本的主要目的是缓解漏洞，而不是利用漏洞。虽然其中包含连接到Cisco设备的凭据（developer/lastorangerestoreball8876），但这些是 Cisco Always On Sandbox 的公开凭据，用于测试目的。 投毒风险较低，但仍然存在一些风险：

1.  **凭据滥用：**  即使凭据是公开的，也可能有人修改剧本以使用不同的凭据尝试访问其他Cisco设备。
2.  **远程执行：**  Ansible 剧本在目标设备上执行命令。如果剧本被恶意修改，可能会导致设备配置更改或执行其他恶意操作。 鉴于此，大约有10%的可能性存在投毒风险。

**利用方式：**
1.  **初始访问：**  攻击者利用 CVE-2023-20198 中的漏洞，绕过身份验证。
2.  **创建高权限用户：**  攻击者利用未授权访问，创建一个具有 15 级权限的本地用户。
3.  **权限提升(CVE-2023-20273):** 攻击者利用本地用户权限和Web UI的另一个漏洞，将权限提升到 root。
4.  **植入后门：**  攻击者利用 root 权限，在设备上植入后门，以便长期控制。

**项目地址:** [emomeni/Simple-Ansible-for-CVE-2023-20198](https://github.com/emomeni/Simple-Ansible-for-CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #17

**来源**: [CVE-2023-20198-fox-it_cisco-ios-xe-implant-detection.md](../2023/CVE-2023-20198-fox-it_cisco-ios-xe-implant-detection.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未经身份验证的攻击者创建具有特权15的本地用户，最终导致完全控制受影响的设备

**影响版本:** 受影响版本包括16.1.1至17.12.1 以及其他相关版本

**利用条件:** Web UI功能已启用，设备可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198是Cisco IOS XE Software Web UI中的一个权限提升漏洞。攻击者可以利用此漏洞，在未经身份验证的情况下，通过发送特制的HTTP请求绕过身份验证，并在受影响的系统上创建一个具有最高权限（特权级别15）的本地用户。创建具有特权15的用户后，攻击者可以使用该用户登录设备，执行任意命令，并完全控制受影响的Cisco IOS XE设备。攻击者利用CVE-2023-20198获得初始访问权限后，会进一步利用CVE-2023-20273将权限提升到root级别，并在文件系统中写入恶意植入程序。

**利用方式：**

1.  **未经身份验证的访问：** 攻击者通过发送特制的HTTP请求，绕过Cisco IOS XE Web UI的身份验证机制。
2.  **创建特权用户：** 成功绕过身份验证后，攻击者可以执行特权命令，创建一个具有最高权限（特权级别15）的本地用户。
3.  **权限提升：** 使用新创建的具有特权15的用户登录设备。
4.  **植入后门:** 利用CVE-2023-20273，将权限提升到root级别，并在文件系统中写入恶意植入程序。

**关于投毒风险：**

提供的漏洞利用代码仅仅是Apache License 2.0协议，这是一个开源协议，本身不包含任何恶意代码。根据现有信息，没有迹象表明该漏洞利用代码中存在任何隐藏的恶意或投毒代码。

**项目地址:** [fox-it/cisco-ios-xe-implant-detection](https://github.com/fox-it/cisco-ios-xe-implant-detection)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #18

**来源**: [CVE-2023-20198-iveresk_cve-2023-20198.md](../2023/CVE-2023-20198-iveresk_cve-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响的Cisco IOS XE设备

**影响版本:** 受影响版本众多，详见漏洞库信息

**利用条件:** Web UI功能已启用，且设备未打补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-20198是一个Cisco IOS XE Software Web UI中存在的权限提升漏洞。根据漏洞库信息和搜索引擎结果，未经身份验证的攻击者可以通过该漏洞创建具有特权15级别（完全访问权限）的本地用户帐户。攻击者首先利用此漏洞获得初始访问权限，然后结合CVE-2023-20273漏洞，利用新创建的本地用户帐户将权限提升至root级别，并在文件系统中写入植入程序。漏洞利用代码 `cve-2023-20198.py` 提供了 `check` 和 `exploit` 两种模式。`check` 模式用于检测目标是否存在漏洞，`exploit` 模式用于创建本地用户帐户。漏洞利用过程包括向 `/webui/logoutconfirm.html` 发送POST请求进行检测，以及向 `/webui/create_user` 发送POST请求创建用户。投毒风险较低，因为代码主要利用已知的漏洞利用方法，但仍存在被修改以执行恶意操作的可能性，例如在创建用户后立即执行其他命令或植入后门程序。主要风险集中在config_content中，可能会存在其他的攻击代码。

**项目地址:** [iveresk/cve-2023-20198](https://github.com/iveresk/cve-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #19

**来源**: [CVE-2023-20198-kacem-expereo_CVE-2023-20198.md](../2023/CVE-2023-20198-kacem-expereo_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可被未授权的攻击者利用创建具有特权 15 的本地用户，为进一步攻击（如植入后门）铺平道路。

**影响版本:** 16.1.1 to 17.12.1 and potentially other versions as indicated in the CVE description.

**利用条件:** 目标设备启用了 Web UI 功能，且位于攻击者可访问的网络中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。未经身份验证的远程攻击者可以通过向目标设备发送特制的 HTTP 请求来利用此漏洞。该漏洞允许攻击者在受影响的系统上创建一个具有特权级别 15 访问权限的帐户。此漏洞是攻击链的第一步，攻击者利用它来创建具有管理权限的本地用户，然后利用 CVE-2023-20273 进一步提升权限至 root，并在文件系统中写入植入程序。提供的 POC 代码 `main.py` 的作用是检测目标 IP 是否容易受到 CVE-2023-20198 的攻击。它通过发送特定的 GET 和 POST 请求来检查目标设备是否返回预期的响应。如果目标返回指示存在漏洞的响应，脚本将输出 'Vulnerable'，否则输出 'Not Vulnerable'。代码通过发送构造的 HTTP GET 请求来尝试绕过身份验证，并检查是否出现预期的“404 Not Found”响应。同时,代码还发送带有硬编码 Authorization 头的 POST 请求，以进一步确认漏洞的存在。尽管代码本身用于检测漏洞，但潜在的投毒风险在于硬编码的 Authorization 头部，以及对 HTTPS 请求的证书验证的禁用（`verify=False`），这可能被恶意修改以进行中间人攻击或者将流量重定向到恶意服务器，虽然这种可能性不大，只有10%。

**利用方式：**

1.  **未经身份验证的访问：** 攻击者无需任何凭据即可发起攻击。
2.  **特制的 HTTP 请求：**  攻击者构造特定的 HTTP GET/POST 请求，利用漏洞绕过身份验证。
3.  **创建特权用户：** 成功利用漏洞后，攻击者可以创建一个拥有最高权限（特权级别 15）的本地用户。
4.  **后续利用：**  创建的特权用户可被用于进一步的恶意活动，例如植入后门、收集敏感信息等（与 CVE-2023-20273 结合）。

**有效性：**
根据漏洞描述和搜索结果，提供的 POC 代码 `main.py` 旨在检测目标是否存在 CVE-2023-20198 漏洞，而不是直接利用该漏洞创建用户。 它通过发送特定的HTTP请求来验证是否存在漏洞。因此，该POC代码在检测方面是有效的。



**项目地址:** [kacem-expereo/CVE-2023-20198](https://github.com/kacem-expereo/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #20

**来源**: [CVE-2023-20198-mr-r3b00t_CVE-2023-20198-IOS-XE-Scanner.md](../2023/CVE-2023-20198-mr-r3b00t_CVE-2023-20198-IOS-XE-Scanner.md)

## CVE-2023-20198-Cisco IOS XE Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的攻击者创建具有特权15权限的本地用户，进而控制设备。

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他一些版本，具体参考漏洞库信息。

**利用条件:** 目标设备启用了Web UI功能，并且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198 漏洞允许未经身份验证的远程攻击者在受影响的 Cisco IOS XE 设备上创建具有特权级别 15 访问权限的帐户。此漏洞是由于 Web UI 功能中存在未受保护的备用通道漏洞 (CWE-420) 造成的。攻击者可以利用此漏洞获得初始访问权限，然后通过 CVE-2023-20273 进一步提升权限至 root 并植入后门。提供的PoC代码 `implant_scanner.ps1` 实际上是一个检测脚本，用于判断目标系统是否已经被植入后门，通过对比Web页面内容的MD5哈希值来判断。脚本本身没有发现明显的投毒代码，config.json中指定了目标URL和已知的哈希值，用于检测是否存在已知的植入体。因此，该仓库中存在作者隐藏的投毒代码的可能性为0%。利用方式是，首先利用CVE-2023-20198创建一个高权限用户，然后利用CVE-2023-20273提升权限并写入植入体（后门）。

**项目地址:** [mr-r3b00t/CVE-2023-20198-IOS-XE-Scanner](https://github.com/mr-r3b00t/CVE-2023-20198-IOS-XE-Scanner)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #21

**来源**: [CVE-2023-20198-netbell_CVE-2023-20198-Fix.md](../2023/CVE-2023-20198-netbell_CVE-2023-20198-Fix.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权远程攻击者创建特权15用户并控制设备

**影响版本:** 受影响版本众多，详见漏洞库信息

**利用条件:** Web UI功能已启用，设备可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性非常高，因为它已被CISA列入已知被利用漏洞目录，并且Cisco官方也已确认存在活跃的利用。漏洞利用方式如下：

1.  **利用CVE-2023-20198获取初始访问权限:** 未经身份验证的攻击者可以利用此漏洞，通过Web UI创建一个具有特权15（最高权限）的本地用户。
2.  **利用CVE-2023-20273提升权限至Root:** 攻击者创建本地用户后，可以利用CVE-2023-20273进一步提升权限至root，并将恶意程序写入文件系统，实现完全控制。

提供的漏洞利用代码（Ansible playbook）实际上是一个缓解措施，旨在禁用Web UI以阻止利用。虽然主要目的是缓解漏洞，但该仓库中存在一定投毒风险。例如:

*   **inventory.yml中的凭据:**  该文件包含默认用户名和密码（admin/admin_password），这可能会被粗心的用户直接用于生产环境，从而使系统暴露于风险之中。
*   **依赖的安全性:**  Ansible playbook的安全性取决于控制机本身的安全。如果控制机被攻破，攻击者可以修改playbook或inventory，从而造成更大范围的损害。

因此，虽然Playbook本身主要是用于缓解漏洞，但配置不当可能导致其他安全问题，存在潜在的投毒风险。务必负责任地存储凭据，使用Ansible Vault或其他安全方法来保护敏感信息。

**项目地址:** [netbell/CVE-2023-20198-Fix](https://github.com/netbell/CVE-2023-20198-Fix)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #22

**来源**: [CVE-2023-20198-ohlawd_CVE-2023-20198.md](../2023/CVE-2023-20198-ohlawd_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，可导致完全控制受影响系统

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他特定版本

**利用条件:** 需要目标设备启用Web UI功能

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。攻击者可以利用此漏洞，在未经身份验证的情况下，通过发送特制请求创建一个具备特权级别15的本地用户，从而获得对设备的完全控制权。由于提供的POC代码仅打印"how bout u exploit d33z nuts"，并没有实际利用漏洞的代码，所以判断其为无效的POC，且具有100%的投毒风险。漏洞利用方式包括：首先利用CVE-2023-20198漏洞获得初始访问权限，然后执行特权15命令以创建本地用户和密码组合。之后，攻击者可能利用CVE-2023-20273漏洞，利用新创建的本地用户将权限提升为root，并将植入程序写入文件系统。

**项目地址:** [ohlawd/CVE-2023-20198](https://github.com/ohlawd/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #23

**来源**: [CVE-2023-20198-raystr-atearedteam_CVE-2023-20198-checker.md](../2023/CVE-2023-20198-raystr-atearedteam_CVE-2023-20198-checker.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI Privilege Escalation

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可能导致完全控制受影响的设备

**影响版本:** 16.1.1 to 17.12.1a 等多个版本 (参考漏洞库信息)

**利用条件:** Web UI功能必须启用，且设备可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-20198 允许未经身份验证的攻击者在受影响的系统上创建一个具有特权级别 15 访问权限的帐户。根据搜索引擎的结果，该漏洞已被积极利用。利用方式是，攻击者首先利用此漏洞获得初始访问权限，然后发出特权 15 命令来创建本地用户和密码组合。然后，攻击者利用另一个漏洞 (CVE-2023-20273) ，利用新创建的本地用户将权限提升为 root 并在文件系统中写入植入程序。 

提供的POC代码尝试通过向 `/webui/logoutconfirm.html` 发送带有 `logon_hash=1` 的POST请求来探测漏洞。如果响应状态码为200，并且响应内容的长度小于32个字符，则可能存在漏洞。POC代码扫描指定的子网，并尝试利用漏洞。 

关于投毒风险，POC代码本身相对简单，主要是网络扫描和HTTP请求。虽然不能完全排除恶意修改的可能性，但代码结构清晰，功能直接，隐藏恶意代码的概率较低。 投毒风险评估较低，大约5%。主要的风险点在于：
1.  **依赖未验证的requests库**：如果requests库本身被投毒，则会影响此脚本。
2.  **成功标志的判断**: 响应内容长度小于32可能是判断依据不足，如果恶意修改，可能导致误报或者漏报，将正常设备标记为存在漏洞，引导使用者进行进一步的恶意操作。

**项目地址:** [raystr-atearedteam/CVE-2023-20198-checker](https://github.com/raystr-atearedteam/CVE-2023-20198-checker)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #24

**来源**: [CVE-2023-20198-reket99_Cisco_CVE-2023-20198.md](../2023/CVE-2023-20198-reket99_Cisco_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，可导致完全控制受影响的Cisco IOS XE设备

**影响版本:** 16.1.1 to 17.12.1 (部分版本)

**利用条件:** Web UI功能已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。攻击者可以利用此漏洞，在未经身份验证的情况下，创建一个具有特权级别15（完全访问所有命令）的本地用户。接下来，攻击者可以利用CVE-2023-20273，通过新创建的本地用户提升权限至root并在文件系统中写入植入物。漏洞利用流程如下：

1.  **CVE-2023-20198 利用:**  未经验证的攻击者通过发送特制的POST请求到`/webui/logoutconfirm.html`，绕过身份验证，创建一个具有管理员权限的新用户。
2.  **CVE-2023-20273 利用:** 使用步骤1中创建的管理员用户，利用另一个Web UI组件中的漏洞，提升权限到root，并写入恶意植入物。

提供的POC代码尝试通过向目标IP地址的`/webui/logoutconfirm.html`发送POST请求来验证漏洞是否存在。如果响应状态码为200，并且响应长度较短（小于32字节），则认为该IP地址易受攻击。然后，脚本会使用curl再次发送请求，如果返回特定的输出长度，则确认漏洞存在。

**关于投毒风险:**

虽然该脚本的主要目的是验证漏洞的存在，但仍然存在一定的投毒风险。风险点在于subprocess.run函数中，使用shell=True来执行curl命令。这使得代码容易受到命令注入攻击，如果攻击者能够控制IP地址或相关参数，则可能执行任意命令。 此外，脚本会将成功利用漏洞的IP地址记录到results.csv 文件中，这虽然不是恶意行为，但可能被恶意行为者利用。投毒风险评估为10%，主要是因为使用了subprocess.run(shell=True)执行外部命令。

**项目地址:** [reket99/Cisco_CVE-2023-20198](https://github.com/reket99/Cisco_CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #25

**来源**: [CVE-2023-20198-sanan2004_CVE-2023-20198.md](../2023/CVE-2023-20198-sanan2004_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响的系统

**影响版本:** 16.1.1 至 17.12.3 以及其他版本

**利用条件:** 目标系统启用了Web UI功能，且位于网络可达范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 存在于 Cisco IOS XE 软件的 Web UI 中。该漏洞允许未经身份验证的攻击者通过不正确的路径验证绕过 Nginx 过滤，访问 `webui_wsma_http` Web 端点，从而可以执行任意 Cisco IOS 命令或进行配置更改，获得 Privilege 15 权限。该漏洞利用涉及两个 XML SOAP 端点：`cisco:wsma-exec` 和 `cisco:wsma-config`。攻击者可以使用 `cisco:wsma-exec` 端点将命令插入到 `execCLI` 元素标记中，例如获取运行配置或执行任意命令。攻击者还可以使用 `cisco:wsma-config` 端点添加具有 Privilege 15 的新用户。随附的 PoC 脚本提供检查漏洞、获取配置、执行命令以及添加/删除用户的功能。PoC 代码的投毒风险较低 (10%)，主要风险在于不熟悉该漏洞的人员可能意外地在生产环境中执行恶意命令，或在测试时使用了存在后门的IOS版本。脚本本身旨在利用漏洞，并且不包含任何明显的恶意或隐藏功能，仓库的README.md声明了此POC的利用方式,降低了隐藏的恶意代码的风险。

**漏洞利用方式：**

1.  **利用 CVE-2023-20198 绕过身份验证：** 攻击者构造特制的 URL 访问易受攻击的 Web UI 端点。
2.  **提升权限：** 成功绕过身份验证后，攻击者可以利用 `cisco:wsma-exec` 或 `cisco:wsma-config` SOAP接口下发命令。
3.  **创建特权用户：** 攻击者创建一个具有 Privilege 15 权限的新用户，从而获得对系统的完全控制。
4.  **执行任意命令：** 攻击者可以使用提权的会话执行任意 Cisco IOS 命令，包括安装后门、修改配置或窃取敏感信息。

**项目地址:** [sanan2004/CVE-2023-20198](https://github.com/sanan2004/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #26

**来源**: [CVE-2023-20198-securityphoenix_cisco-CVE-2023-20198-tester.md](../2023/CVE-2023-20198-securityphoenix_cisco-CVE-2023-20198-tester.md)

## CVE-2023-20198-Cisco IOS XE Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的攻击者创建具有特权15的本地用户，从而完全控制设备

**影响版本:** 受影响的版本包括 16.1.1 到 17.12.1 以及其他版本

**利用条件:** Web UI 功能必须已启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞信息和搜索结果，CVE-2023-20198 允许未经身份验证的攻击者在受影响的 Cisco IOS XE 设备上创建具有 privilege level 15 （最高权限）的本地用户。漏洞利用涉及向 Web UI 发送特制的 HTTP POST 请求，绕过身份验证机制。创建具有最高权限的用户后，攻击者可以使用该账户执行任意命令，并完全控制设备。提供的 `cisco_tester.py` 脚本旨在检测目标设备是否受到 CVE-2023-20198 的影响。它通过向 `/webui/logoutconfirm.html?logon_hash=1` 发送 POST 请求，并检查响应中是否包含特定的字符串 `1a80b7389ccd0a5dab` 来判断设备是否已被入侵。该字符串很可能是一个被利用的设备的特征。

**有效性:**

根据漏洞库信息、搜索结果（特别是 https://www.horizon3.ai/attack-research/attack-blogs/cisco-ios-xe-cve-2023-20198-deep-dive-and-poc/）和漏洞利用代码，该漏洞的利用是有效的，已经有公开可用的PoC。

**投毒风险:**

提供的Python脚本本身主要是一个检测工具，用于检查Cisco设备是否受到CVE-2023-20198的影响，它通过检测特定Hash值判断系统是否已经被植入后门。该脚本逻辑比较简单，主要功能为发送HTTP请求并匹配特定字符串。风险点可能在于脚本对异常的处理不够严谨，如果目标存在其他漏洞，可能被利用，但从代码本身来看，投毒的可能性较低，例如作者没有隐藏恶意的代码执行、数据窃取等行为。可以认为投毒风险极低，可能性约为1%。

**利用方式:**

1.  **未经身份验证的权限提升:**  攻击者利用 CVE-2023-20198 在 Cisco IOS XE 设备上创建一个具有最高权限 (privilege level 15) 的本地用户。
2.  **初始访问:**  利用漏洞绕过 Web UI 的身份验证机制。
3.  **命令执行:**  使用新创建的特权用户账户登录并执行任意命令，实现对设备的完全控制。
4.  **植入后门:** 利用CVE-2023-20273，提升权限至root,写入后门文件。

总而言之，此漏洞允许攻击者完全控制受影响的Cisco设备，风险极高。

**项目地址:** [securityphoenix/cisco-CVE-2023-20198-tester](https://github.com/securityphoenix/cisco-CVE-2023-20198-tester)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #27

**来源**: [CVE-2023-20198-smokeintheshell_CVE-2023-20198.md](../2023/CVE-2023-20198-smokeintheshell_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权用户创建特权用户并执行任意命令

**影响版本:** 受影响版本包括16.1.1到17.12.1等多个版本

**利用条件:** 需要目标设备启用Web UI功能，且攻击者能够网络访问该Web UI。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。该漏洞源于对 Nginx 过滤器的不当路径验证，允许未经身份验证的攻击者绕过身份验证访问 `webui_wsma_http` Web 端点。

**利用方式：**

1.  攻击者利用漏洞绕过身份验证，向 `webui_wsma_http` 端点发送特制的 XML SOAP 请求。
2.  攻击者可以使用 `cisco:wsma-exec` SOAP 端点执行任意 Cisco IOS 命令，或者使用 `cisco:wsma-config` SOAP 端点创建具有 Privilege 15 权限的本地用户。
3.  创建具有 Privilege 15 权限的用户后，攻击者可以使用该用户登录并执行任何操作。
4.  结合CVE-2023-20273，攻击者可以进一步提升权限至root，并写入植入程序。

**有效性：**

根据漏洞描述和提供的漏洞利用代码，该漏洞利用是有效的。漏洞利用代码包含检查漏洞是否存在、获取 Cisco IOS 运行配置、执行任意 Cisco IOS 命令以及添加/删除特权用户的功能。搜索引擎结果也表明该漏洞已被 активно利用。

**投毒风险：**

分析提供的漏洞利用代码（exploit.py），发现以下潜在风险：

*   虽然代码本身看起来直接实现了漏洞利用，但仍然存在作者在代码中加入恶意行为的可能性。
*   例如，可以修改添加用户的函数，在创建高权限用户的同时，静默地执行其他恶意配置更改（如添加后门路由或修改系统日志设置）。
*   代码中使用了多个 SOAP 端点，虽然文档中只提到了 `cisco:wsma-exec` 和 `cisco:wsma-config`，但作者可能利用其他未公开的端点执行恶意操作。
*   因此，需要仔细审查代码的每一行，特别是与网络请求和配置更改相关的部分，以确保没有隐藏的恶意逻辑。
*  根据代码内容，未发现明显的恶意代码，但由于该漏洞可以创建高权限用户，如果攻击者利用该漏洞，完全可以植入后门，存在投毒风险。
*  代码本身风险较低，投毒风险主要体现在被攻击者利用后实施的恶意行为，故将风险调整为10%。

**项目地址:** [smokeintheshell/CVE-2023-20198](https://github.com/smokeintheshell/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #28

**来源**: [CVE-2023-20198-sohaibeb_CVE-2023-20198.md](../2023/CVE-2023-20198-sohaibeb_CVE-2023-20198.md)

# CVE-2023-20198

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-20198-Arshit01_CVE-2023-20198.md](../2023/CVE-2023-20198-Arshit01_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI权限提升漏洞

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响的Cisco设备

**影响版本:** 16.1.1 to 17.12.1及部分17.x版本

**利用条件:** Web UI功能已启用，且目标设备存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。未经身份验证的攻击者可以利用此漏洞创建具有特权级别15（最高权限）的本地用户，从而完全控制受影响的设备。利用过程分为两个阶段：首先利用CVE-2023-20198创建用户，其次利用CVE-2023-20273提升权限至root并写入植入程序。

**漏洞利用方式：**

1.  **身份验证绕过：** 漏洞允许未经身份验证的攻击者与设备的Web UI进行交互。
2.  **创建特权用户：** 攻击者发送特制的SOAP请求到Web UI，该请求绕过身份验证并允许攻击者创建一个具有特权级别15的新用户。
3.  **远程控制：** 创建具有最高权限的用户后，攻击者可以使用此帐户登录设备，并执行任意命令。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的POC代码，可以确认POC代码是有效的。搜索结果中的文章提到了漏洞的成功利用和概念验证代码的存在。POC代码也显示了通过发送特制的XML SOAP请求来创建新用户的机制。

**投毒风险：**

提供的POC代码存在轻微的投毒风险，约为10%。风险点分析如下：

*   **默认用户名和密码：** POC代码使用了默认的用户名（shellsmoke）和密码（pwned）。虽然这方便了漏洞测试，但如果未经修改直接用于攻击，很容易被检测到或被其他人利用。
*   **硬编码的URI：** POC中`exURI = '%2577eb%2575i_%2577sma_Http'`，如果攻击者修改此URI植入恶意代码，可能会导致拒绝服务或者其他恶意行为。
*   **命令执行：** 漏洞本身允许执行任意命令，攻击者可能通过植入恶意命令来感染设备。

需要注意的是，以上只是一些潜在的风险点，具体的投毒行为还需要进一步分析。POC的主要功能是验证漏洞的存在，而非恶意利用。因此，将其判定为具有投毒代码是不准确的。

**项目地址:** [Arshit01/CVE-2023-20198](https://github.com/Arshit01/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #2

**来源**: [CVE-2023-20198-Atea-Redteam_CVE-2023-20198.md](../2023/CVE-2023-20198-Atea-Redteam_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Software Web UI权限提升漏洞

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，未经身份验证的攻击者可以创建具有特权级别15访问权限的帐户，并最终导致完全控制受影响的系统。

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1以及17.11.99SW等众多版本

**利用条件:** Web UI 功能必须启用。需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个关键漏洞。未经身份验证的远程攻击者可以利用此漏洞在受影响的系统上创建具有特权级别 15（完全访问所有命令）的帐户。利用方式是攻击者发送特制的 HTTP 请求到 `/webui/logoutconfirm.html?logon_hash=1` 路径，绕过身份验证，并执行特权命令以创建本地用户和密码组合。创建用户后，攻击者可以利用另一个漏洞（CVE-2023-20273）提升权限至 root 并写入植入程序到文件系统。提供的 Python 脚本 `CVE-2023-20198.py` 旨在检测是否存在该漏洞，并检查已知的 IOC。  该脚本扫描指定子网，并检查目标设备是否返回预期的响应状态码和内容长度。投毒风险评估：脚本本身主要用于检测，但由于脚本包含发送特定请求到目标设备的逻辑，如果攻击者修改此脚本，可能会加入恶意负载或更改用户创建的用户名/密码，存在一定的投毒风险.脚本中存在User-Agent:Atea Red Team CVE-2023-20198 checkscript特征,可能被安全设备检测到。存在的风险点是如果未经授权的人员使用了修改后的脚本，可能会对网络造成损害。 README.md文件没有发现异常。

**项目地址:** [Atea-Redteam/CVE-2023-20198](https://github.com/Atea-Redteam/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #3

**来源**: [CVE-2023-20198-DOMINIC471_qub-network-security-cve-2023-20198.md](../2023/CVE-2023-20198-DOMINIC471_qub-network-security-cve-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权级别15的账户，完全控制受影响的设备。

**影响版本:** 受影响版本众多，包括16.1.1到17.12.1以及其他版本（详见漏洞库信息）。

**利用条件:** Web UI功能必须已启用。设备需要可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞允许未经身份验证的攻击者在Cisco IOS XE设备上创建具有特权级别15（最高权限）的本地用户。攻击者通过利用Web UI中的漏洞绕过身份验证，并执行特权命令创建用户。结合另一个漏洞CVE-2023-20273，攻击者可以进一步提升权限至root并写入植入程序到文件系统。 

**有效性评估：**
根据提供的漏洞库信息和搜索结果，CVE-2023-20198是一个严重漏洞，已被积极利用。

**投毒风险评估：**
查看提供的POC代码，包括README.md和IOC Summary.md文件。 README.md主要描述了如何分析、检测和缓解此漏洞。IOC Summary.md列出了攻击者IP，受害者IP，使用的header以及payload等。这些信息可以辅助蓝队进行防御。
总体来说，该仓库的目的是为了分析和缓解漏洞，并没有发现明显的投毒代码。但是，由于代码中可能包含攻击载荷或恶意命令示例，如果使用者不小心，可能会误用这些代码进行非授权的渗透测试，从而导致法律风险。因此，评估的投毒风险为10%。

**利用方式：**
1.  **未授权访问：** 攻击者利用漏洞，绕过Web UI的身份验证机制。
2.  **创建特权用户：** 攻击者通过发送特制的HTTP请求，执行CLI命令，创建一个具有特权级别15的本地用户。
3.  **持久化（结合CVE-2023-20273）：** 攻击者利用新创建的本地用户登录，并利用另一个漏洞（CVE-2023-20273）提升权限到root，并在文件系统中写入植入程序，实现持久化控制。

**缓解措施：**
*   禁用Web UI功能，如果不需要使用。
*   升级到已修复漏洞的IOS XE软件版本。
*   使用入侵检测/防御系统（IDS/IPS）检测和阻止利用此漏洞的攻击。
*   检查设备上是否存在异常用户和植入程序。

**项目地址:** [DOMINIC471/qub-network-security-cve-2023-20198](https://github.com/DOMINIC471/qub-network-security-cve-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #4

**来源**: [CVE-2023-20198-G4sul1n_Cisco-IOS-XE-CVE-2023-20198.md](../2023/CVE-2023-20198-G4sul1n_Cisco-IOS-XE-CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权15权限的本地用户，结合CVE-2023-20273可提升至root权限并植入后门。

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他相关版本，具体参见漏洞库信息。

**利用条件:** 需要目标系统启用Web UI功能，且网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。根据漏洞信息和搜索结果，该漏洞允许未经身份验证的远程攻击者在受影响的系统上创建一个具有特权级别 15 访问权限的帐户。Cisco的公告指出，攻击者首先利用此漏洞获得初始访问权限，然后执行特权 15 命令以创建本地用户和密码组合。随后，攻击者利用 CVE-2023-20273 将权限提升到 root 并将植入程序写入文件系统。根据提供的漏洞利用代码，该 PoC 包含以下功能：

*   **漏洞检查**：通过执行 `uname -a` 命令来验证漏洞是否存在。
*   **获取 Cisco 配置**：执行 `sh run` 命令来提取运行配置。
*   **执行命令**：允许执行任意 Cisco IOS 命令，但警告需要谨慎使用，因为没有输入验证。
*   **添加用户**：创建一个新的特权 15 用户帐户，可以选择指定用户名和密码。
*   **删除用户**：从设备中删除用户帐户。

**有效性：**

该 PoC 代码的有效性较高，因为漏洞库信息和搜索结果都表明该漏洞已被 активно используется。此外，该 PoC 提供了多种利用方式，包括漏洞检查、信息收集和权限提升。

**投毒风险：**

尽管 PoC 代码主要用于利用已知的漏洞，但仍存在一定的投毒风险，估计为10%。风险点包括：

*   **命令执行**：通过 `-e` 选项执行任意命令，攻击者可能利用此功能执行恶意操作。
*   **用户管理**：虽然提供了添加和删除用户的选项，但如果被滥用，可能导致拒绝服务或系统损坏。

虽然PoC代码本身看起来是为了复现漏洞，但不能完全排除代码作者在其中隐藏恶意功能的可能性，例如植入后门、收集敏感信息等。因此，在使用 PoC 代码时，需要进行仔细审查和安全评估。

**利用方式：**

1.  **未经身份验证的访问**：利用 CVE-2023-20198 绕过身份验证，访问 `webui_wsma_http` Web 端点。
2.  **创建特权用户**：使用 `cisco:wsma-config` SOAP 端点创建一个具有特权 15 的新用户帐户。
3.  **执行任意命令**：使用 `cisco:wsma-exec` SOAP 端点执行任意 Cisco IOS 命令。
4.  **权限提升 (结合 CVE-2023-20273)**：利用新创建的特权用户，结合 CVE-2023-20273 将权限提升到 root，并在系统上植入后门。

总而言之，CVE-2023-20198 是一个严重的安全漏洞，需要立即采取措施进行修复。在使用 PoC 代码时，需要谨慎评估风险，并确保在受控环境中进行测试。

**项目地址:** [G4sul1n/Cisco-IOS-XE-CVE-2023-20198](https://github.com/G4sul1n/Cisco-IOS-XE-CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #5

**来源**: [CVE-2023-20198-IceBreakerCode_CVE-2023-20198.md](../2023/CVE-2023-20198-IceBreakerCode_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权级别 15 的帐户，从而完全控制设备

**影响版本:** 16.1.1 to 17.12.1 and earlier versions

**利用条件:** Web UI 功能已启用并且设备易受攻击版本的影响。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个漏洞，允许未经身份验证的远程攻击者在受影响的系统上创建具有特权级别 15 访问权限的帐户。 

**漏洞利用方式：**

1.  攻击者发送一个特制的 HTTP POST 请求到 `/webui/logoutconfirm.html?logon_hash=1` 端点，绕过身份验证。
2.  成功利用此漏洞后，攻击者可以执行任意命令，包括创建具有特权级别 15 的本地用户。
3.  然后，攻击者使用另一个漏洞（CVE-2023-20273）并通过新创建的本地用户权限提升到 root 权限，并将植入程序写入文件系统。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判定该漏洞的POC代码是有效的。漏洞库信息明确指出存在正在进行的漏洞利用活动。搜索结果也提供了多个关于该漏洞的深度分析和POC示例的链接，例如horizon3.ai上的POC代码。
提供的python脚本模拟了发送特制HTTP请求的过程，旨在检测目标系统是否存在漏洞。脚本会检查HTTP响应状态码和响应体内容，以判断是否存在潜在的植入程序。

**投毒风险：**

评估POC代码的投毒风险，需要仔细分析代码是否存在恶意行为，例如：
1.  **植入后门：**  代码是否在目标系统上安装未经授权的后门。
2.  **数据窃取：**  代码是否窃取敏感信息并发送到外部服务器。
3.  **拒绝服务：**  代码是否导致目标系统崩溃或无法正常运行。
4.  **恶意传播：**  代码是否试图感染其他系统。

分析提供的python脚本，该脚本主要用于检测漏洞是否存在，并未发现明显的恶意行为。脚本的功能是发送特定的HTTP请求并检查响应，以确定目标系统是否受到CVE-2023-20198漏洞的影响。然而，使用任何未经授权的漏洞利用代码都存在风险，因为代码的作者可能隐藏了不易察觉的恶意功能。因此，在使用任何POC代码之前，务必进行彻底的安全审查。

考虑到以上因素，判定该POC代码存在10%的投毒风险，主要是由于作者可能隐藏了一些不易察觉的恶意代码，但主要功能是漏洞验证。

**缓解措施：**

*   禁用 Web UI 功能，特别是当设备面向互联网时。
*   将 Web UI 访问限制为受信任的网络。
*   升级到已修复漏洞的 Cisco IOS XE 软件版本。

**项目地址:** [IceBreakerCode/CVE-2023-20198](https://github.com/IceBreakerCode/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #6

**来源**: [CVE-2023-20198-JoyGhoshs_CVE-2023-20198.md](../2023/CVE-2023-20198-JoyGhoshs_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可导致完全控制受影响设备

**影响版本:** 受影响版本范围广泛，详见漏洞库信息

**利用条件:** Web UI功能已启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198 允许未经身份验证的攻击者在受影响的系统上创建具有权限级别15（完全访问权限）的帐户。该漏洞利用方式如下：

1.  **初始访问:** 攻击者利用CVE-2023-20198漏洞，通过Web UI创建具有高权限的本地用户。
2.  **权限提升:** 然后，攻击者可能利用CVE-2023-20273（另一个漏洞）或使用新创建的本地用户进一步将权限提升至root。
3.  **植入后门:** 攻击者利用获得的root权限，在文件系统中写入恶意植入。

提供的POC代码`poc.py`是一个**检测工具**，而非完整的漏洞利用代码。它通过发送一个特定的HTTP请求到`/webui/logoutconfirm.html?logon_hash=1`，并检查响应内容是否为十六进制字符串来判断目标是否可能受到了攻击并植入了后门。如果响应是十六进制字符串，则表明设备可能已遭入侵，并存在植入的后门（该后门会返回hex信息）。

该存储库中的`README.md`文件说明，此脚本并非完整的POC，仅用于检查是否存在hex响应。因此，它无法直接用于漏洞利用，而只能用于检测。

**投毒风险分析：**

查看`poc.py`文件内容，发现其功能主要是发送HTTP请求并判断响应内容。该代码的功能比较简单，未发现任何可能导致恶意行为（例如，上传恶意文件、执行任意命令等）的可疑代码。因此，可以认为该存储库不存在作者隐藏的投毒代码。



**项目地址:** [JoyGhoshs/CVE-2023-20198](https://github.com/JoyGhoshs/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #7

**来源**: [CVE-2023-20198-Pushkarup_CVE-2023-20198.md](../2023/CVE-2023-20198-Pushkarup_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的远程攻击者创建管理员账户并完全控制设备

**影响版本:** 受影响版本详见CVE描述

**利用条件:** 目标设备启用了Web UI功能，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞存在于 Cisco IOS XE 软件的 Web UI 中。未经身份验证的远程攻击者可以通过利用此漏洞在受影响的系统上创建具有特权级别 15 访问权限的帐户。创建账户后，攻击者可以使用该账户完全控制受损的机器。

**有效性：**
提供的 POC 代码根据描述能够创建本地用户，安装植入体，重启Web服务，并检查植入体的状态，因此具备有效性。

**投毒风险：**
此仓库中可能存在作者隐藏的投毒代码。尽管自述文件声明 PoC 仅用于教育目的，并且使用需要遵守道德规范，但攻击者可以修改 `config_content` 以包含恶意配置，例如更改防火墙规则或执行其他恶意操作。此外，虽然代码本身没有明显的恶意行为，但其目的是在目标系统上创建具有管理权限的用户，这本身就可以被认为是恶意的。因此，存在一定的投毒风险，但是相对较低，风险评估在10%。此风险评估基于以下因素：
    *   代码可能被用于未授权的系统访问。
    *   配置文件可被修改为包含恶意指令。

**利用方式：**
1.  攻击者利用 CVE-2023-20198 漏洞，通过未授权访问在 Cisco IOS XE 设备上创建一个具有特权级别 15 的本地用户。
2.  攻击者使用新创建的管理员账户登录到设备。
3.  攻击者利用 CVE-2023-20273 漏洞，进一步提升权限至 root 级别，并将恶意植入程序写入文件系统。
4.  攻击者通过植入的后门程序远程控制设备，执行恶意操作，例如数据窃取、网络攻击等。
根据搜索结果，CISA 已将此漏洞添加到已知被利用的漏洞目录中，表明该漏洞已经被广泛利用。

**项目地址:** [Pushkarup/CVE-2023-20198](https://github.com/Pushkarup/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #8

**来源**: [CVE-2023-20198-RevoltSecurities_CVE-2023-20198.md](../2023/CVE-2023-20198-RevoltSecurities_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，可被未授权的攻击者利用创建特权用户，进而完全控制系统。

**影响版本:** 受影响的版本包括16.1.1到17.12.1以及其他一系列17.x版本 (详见漏洞库信息)

**利用条件:** 目标设备启用Web UI功能，并且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。根据漏洞库信息和搜索引擎结果，未经身份验证的攻击者可以利用此漏洞在受影响的系统上创建一个具有 15 级权限（最高权限）的帐户。随后攻击者再利用CVE-2023-20273，将权限提升至root，并写入植入体。该漏洞的利用方式如下：

1.  **漏洞触发：** 攻击者发送特制的HTTP请求到Cisco IOS XE设备的Web UI接口，绕过身份验证。
2.  **创建特权用户：** 请求中包含特定的XML内容，该内容允许攻击者创建一个新的本地用户，并分配最高权限（privilege level 15）。
3.  **权限提升：** 攻击者利用创建的特权用户登录系统。
4.  **植入后门：** 攻击者通过Web UI的另一个组件（CVE-2023-20273）将权限提升至root并写入植入体。

**有效性：** 根据搜索引擎结果（特别是horizon3.ai的POC）以及提供的漏洞利用代码，此漏洞利用是有效的。漏洞利用代码仓库提供了一个Python脚本，可以检测和利用此漏洞。

**投毒风险：** 漏洞利用代码仓库的投毒风险评估为10%。虽然该仓库提供了看似合理的漏洞利用脚本，但存在以下潜在风险点：

*   **自定义配置内容：** 脚本允许用户提供自定义的配置内容（`-cfc` 或 `--config-content` 参数），这可能被滥用以注入恶意代码或配置。
*   **隐蔽后门：** 虽然主要功能是利用漏洞，但作者可能在代码中添加了不易察觉的后门，例如收集目标信息、执行任意命令等。代码量较少，通读代码可以降低风险。

**防范措施：**

*   立即更新Cisco IOS XE软件到已修复的版本。
*   禁用Web UI功能，如果不需要。
*   监控网络流量，检测异常的Web UI请求。
*   使用Cisco提供的软件检查工具来识别和移除潜在的植入体。

**项目地址:** [RevoltSecurities/CVE-2023-20198](https://github.com/RevoltSecurities/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #9

**来源**: [CVE-2023-20198-Shadow0ps_CVE-2023-20198-Scanner.md](../2023/CVE-2023-20198-Shadow0ps_CVE-2023-20198-Scanner.md)

## CVE-2023-20198 Cisco IOS XE Web UI 权限提升漏洞

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权 15 权限的本地用户，从而完全控制受影响的设备。

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1 以及 17.11.99SW

**利用条件:** Web UI 功能必须已启用。攻击者需要能够通过网络访问设备的 Web UI。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。未经身份验证的远程攻击者可以利用此漏洞在受影响的系统上创建一个具有特权 15 访问权限的帐户，本质上是管理员权限。漏洞利用通常与另一个漏洞 CVE-2023-20273 结合使用，后者用于将权限提升到 root 并将植入程序写入文件系统。

**漏洞利用有效性：**

根据漏洞库信息、搜索引擎结果（特别是 horizon3.ai 的 PoC 描述）以及提供的漏洞利用代码片段来看，该漏洞的利用是有效的。存在公开可用的 PoC，允许攻击者绕过身份验证创建具有管理权限的用户。

**投毒风险分析：**

提供的代码片段分析表明，攻击流程依赖于 Nginx 配置和一个 Lua 脚本。Lua 脚本的核心功能在于身份验证绕过和命令执行。脚本通过检查是否存在特定的 "Authorization" Header以及Header的内容是否和通过REDACTED命令执行结果匹配来确定请求是否被授权。

由于 "REDACTED" 信息的缺失，我们无法完全确定是否存在恶意投毒代码。但是lua脚本的下列行为存在潜在的投毒风险：

1.  **外部命令执行:** 脚本多次使用 `io.popen()` 执行外部命令。如果这些命令包含恶意参数或旨在下载和执行其他代码，则可能导致系统受损。
2.  **硬编码的凭据和逻辑：**脚本逻辑依赖于特定的哈希值和其他硬编码的字符串。攻击者可能会修改这些字符串以创建变体，从而绕过安全检测或植入后门。
3.  **对/lua5的请求:** 当common_type=iox时,会调用/lua5,如果/lua5是作者控制的地址,则存在投毒风险。

基于以上分析，虽然无法确定明确的投毒代码，但脚本中使用的技术（尤其是外部命令执行）增加了被用于恶意目的的可能性，估计投毒风险为20%。

**漏洞利用方式：**

1.  **未授权访问:** 攻击者发送一个特制的 HTTP POST 请求到 `/webui/logoutconfirm.html`，绕过身份验证检查（利用 CVE-2023-20198）。这可能涉及到提供特定的 `Authorization` header，该header的值能够通过预设的验证。
2.  **创建高权限用户:** 绕过身份验证后，攻击者可以发送包含创建新用户（具有特权级别 15）的命令的请求体。该命令通过 `io.popen()` 执行，从而创建一个具有管理员权限的本地用户。
3.  **权限提升和植入：** (结合 CVE-2023-20273) 使用新创建的本地用户登录并利用 CVE-2023-20273 将权限提升至 root，从而能够在设备上安装植入程序。


**项目地址:** [Shadow0ps/CVE-2023-20198-Scanner](https://github.com/Shadow0ps/CVE-2023-20198-Scanner)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #10

**来源**: [CVE-2023-20198-Tounsi007_CVE-2023-20198.md](../2023/CVE-2023-20198-Tounsi007_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可能导致完全控制受影响设备

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他版本

**利用条件:** 目标设备启用了Web UI功能并且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞存在于Cisco IOS XE Software的Web UI中，允许未经身份验证的远程攻击者创建一个具有特权级别15（完全访问权限）的本地用户帐户。该漏洞利用方式是通过发送特制的HTTP请求到`/webui/create_user`路径来创建用户。攻击者随后可利用创建的用户并通过另一个漏洞CVE-2023-20273提升权限至root并写入植入程序。提供的POC代码尝试模拟此过程，包括创建用户、安装植入程序、重启Web服务器、检查植入程序状态以及清理创建的用户。 

**有效性：**根据漏洞信息、搜索结果和提供的POC代码，该漏洞是有效的。搜索引擎结果表明该漏洞已被积极利用，并且存在公开可用的POC代码。CISA的已知被利用漏洞目录也收录了该漏洞。

**投毒风险：**POC代码本身存在一定的风险。虽然代码的主要功能是利用漏洞，但`config_content`变量表明存在植入恶意配置的可能性。 用户需要手动插入植入配置,存在被植入后门的风险。
该仓库readme描述，POC仅用于测试和学习，有免责声明。存在一定概率作者未充分测试。

**利用方式：**
1.  **初始访问：** 未经身份验证的攻击者发送特制HTTP请求到存在漏洞的Cisco IOS XE设备的Web UI接口。
2.  **用户创建：**  利用CVE-2023-20198，攻击者通过`/webui/create_user`接口创建一个具有管理员权限的新用户。
3.  **权限提升（CVE-2023-20273）：** 利用新创建的用户，攻击者可以进一步利用Web UI中的另一个漏洞（CVE-2023-20273）来提升权限至root。
4.  **植入后门：** 攻击者可以写入植入程序到文件系统。
5.  **持久化：** 植入程序可以用于维持对受感染设备的访问。
6.  **清理（可选）：** 攻击者可以选择删除他们创建的后门账户，以隐藏其踪迹。

**项目地址:** [Tounsi007/CVE-2023-20198](https://github.com/Tounsi007/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #11

**来源**: [CVE-2023-20198-Vulnmachines_Cisco_CVE-2023-20198.md](../2023/CVE-2023-20198-Vulnmachines_Cisco_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可使未授权的攻击者获得完全管理权限

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1 以及其他多个版本

**利用条件:** Web UI 功能启用并且 HTTP 或 HTTPS 服务器功能开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个关键身份验证绕过漏洞。根据漏洞信息和搜索结果，攻击者利用此漏洞首先获得初始访问权限，然后执行特权 15 命令来创建一个本地用户和密码组合，从而获得管理员权限。之后，攻击者利用 CVE-2023-20273 将权限提升到 root 并在文件系统中写入植入程序。提供的 POC 代码显示了一个用于利用漏洞的 HTTP POST 请求示例。请求的目标 URI 经过编码处理，绕过了身份验证。请求体包含一个 SOAP 信封，该信封尝试使用默认的 "admin" 用户名执行命令 "uname -a"。有效性：根据搜索结果和漏洞描述，提供的 POST 请求通过身份验证绕过在受影响的设备上创建具有特权 15 的用户，因此 POC 代码有效。 投毒风险：README.md 文件描述了漏洞，并提供了一个关于利用该漏洞的概述。Payload 文件包含一个 SOAP 请求，用于发送 CLI 命令。虽然该请求本身看起来无害（执行 `uname -a` 命令），但攻击者可能会修改该请求以执行恶意命令。例如，更改命令以创建具有特权 15 的用户。 因此，存在一定风险，即此仓库可能被用于传播恶意利用程序。Payload 代码文件本身没有明显的投毒代码，但存在被修改利用的风险，因此判定投毒风险为 10%。利用方式：1. 检查目标 Cisco IOS XE 设备是否启用了 Web UI 功能和 HTTP/HTTPS 服务器。2. 发送构造的 HTTP POST 请求到目标设备，利用身份验证绕过漏洞。3. 请求的目标 URI 经过编码处理以绕过身份验证检查。4. POST 请求的内容为 SOAP 信封，其中包含要执行的 CLI 命令。5. 成功利用后，攻击者可以在设备上执行任意 CLI 命令，例如创建新的管理员帐户或植入恶意软件。

**项目地址:** [Vulnmachines/Cisco_CVE-2023-20198](https://github.com/Vulnmachines/Cisco_CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #12

**来源**: [CVE-2023-20198-W01fh4cker_CVE-2023-20198-RCE.md](../2023/CVE-2023-20198-W01fh4cker_CVE-2023-20198-RCE.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权15的用户，进而完全控制受影响的设备。

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1 等多个版本

**利用条件:** Web UI 功能已启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。未经身份验证的远程攻击者可以利用此漏洞在受影响的系统上创建一个具有特权 15 访问权限的帐户，从而完全控制设备。利用方式如下：

1.  **漏洞触发点：** Cisco IOS XE 软件的 Web UI 组件存在漏洞。
2.  **利用过程：** 攻击者通过发送特制的 SOAP 请求到 `/%%77ebui_wsma_https` 或 `/%%77ebui_wsma_Http` URI (具体取决于是否使用 HTTPS) 绕过身份验证。
3.  **命令执行：** 攻击者使用 `urn:cisco:wsma-config` 命名空间执行 CLI 命令，创建新的具有特权 15 的用户。
4.  **后续利用 (CVE-2023-20273):** 在获得初始访问权限后，攻击者可以利用 CVE-2023-20273 将权限提升为 root 并在文件系统中写入植入程序。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞已被积极利用，提供的 PoC 代码有效，可以用于创建具有特权 15 的用户。

**投毒风险：**

PoC 代码主要功能是利用漏洞，创建新用户，从代码本身来看，存在一些潜在的投毒点，例如：

*   **随机用户名/密码生成：**  虽然代码中包含随机用户名生成函数，但实际使用中，攻击者可能会替换为预设的用户名和密码，方便后续控制。
*   **代理服务器使用：**  PoC 代码支持使用代理服务器，攻击者可以借此隐藏真实 IP 地址，增加溯源难度。
*   **异常处理：**  代码中包含异常处理模块，可能用于隐藏利用过程中的错误信息，避免被发现。
*   **User-Agent:** 使用了常见的User-Agent，但是依然存在替换或者增加其他User-Agent进行恶意攻击.

总体来说，PoC 代码的投毒风险较低，主要集中在以上几点，但需要使用者谨慎使用。

**总结：**

该漏洞利用的有效性很高，并且在野外被广泛利用。PoC 代码可以用来验证漏洞的存在并创建管理员用户，但需要注意潜在的投毒风险。利用方式是发送特制的 SOAP 请求，绕过身份验证，然后执行 CLI 命令。

**项目地址:** [W01fh4cker/CVE-2023-20198-RCE](https://github.com/W01fh4cker/CVE-2023-20198-RCE)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #13

**来源**: [CVE-2023-20198-XiaomingX_cve-2023-20198-poc.md](../2023/CVE-2023-20198-XiaomingX_cve-2023-20198-poc.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响设备

**影响版本:** 受影响版本范围广泛，详见漏洞库信息

**利用条件:** Web UI 功能启用且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 存在于 Cisco IOS XE 软件的 Web UI 中。未经身份验证的攻击者可以利用此漏洞创建具有 privilege level 15 权限的本地用户，从而获得对设备的完全控制权。利用方式主要通过发送特制的 SOAP 请求到目标设备的 Web UI 接口，绕过身份验证，执行 CLI 命令。PoC 代码通过构造恶意的 SOAP 消息，例如 `username <username> privilege 15 secret <password>`，添加高权限用户。 

有效性分析：根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开的 PoC。提供的 PoC 代码实现了漏洞利用的基本功能，包括检查漏洞、获取配置、执行命令和添加/删除用户。因此，提供的 PoC 代码是有效的。

投毒风险分析：代码本身主要实现了漏洞利用功能，但仍然存在一定的投毒风险。体现在以下几个方面：

*   **恶意命令执行：** 虽然代码本身没有硬编码的恶意命令，但 `-e` 参数允许攻击者执行任意 Cisco IOS 命令。攻击者可能会使用此参数注入恶意配置或植入后门。
*   **硬编码凭据：** 默认用户名 `shellsmoke` 和密码 `pwned` 如果不修改，可能被其他攻击者利用。虽然这是一个PoC，但在实际使用中容易被忽视，从而导致设备被二次入侵。
*   **异常处理：** 某些异常处理不够完善，可能导致程序崩溃或泄露敏感信息。
*   **Payload内容:** 在SOAP请求模板中，攻击者可能修改命令或者在ADD_USER的情况下，添加后门账户。

综合考虑，该 PoC 存在一定的投毒风险，但主要集中在用户使用不当或被恶意利用的可能性上，PoC本身是漏洞的利用，投毒代码的可能性评判为 10%。建议使用者在使用 PoC 时仔细审查代码，并采取必要的安全措施。

利用方式总结：

1.  **目标确认：** 确定目标 Cisco IOS XE 设备是否启用了 Web UI 功能。
2.  **发送恶意 SOAP 请求：** 构造包含 CLI 命令的恶意 SOAP 请求，绕过身份验证。
3.  **权限提升：** 利用漏洞创建具有 privilege level 15 权限的本地用户。
4.  **完全控制：** 使用新创建的用户登录并完全控制设备。

**项目地址:** [XiaomingX/cve-2023-20198-poc](https://github.com/XiaomingX/cve-2023-20198-poc)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #14

**来源**: [CVE-2023-20198-ZephrFish_CVE-2023-20198-Checker.md](../2023/CVE-2023-20198-ZephrFish_CVE-2023-20198-Checker.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权15权限的本地用户，随后可能被用于植入后门和完全控制设备

**影响版本:** 受影响版本：16.1.1 到 17.12.1，以及其他相关版本（详见漏洞库信息）

**利用条件:** 目标设备启用了Web UI功能，且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞允许未经身份验证的攻击者在受影响的 Cisco IOS XE 设备上创建一个具有特权 15 权限（最高权限）的本地用户。该漏洞存在于 Web UI 功能中。根据搜索引擎结果和漏洞库信息，此漏洞已被积极利用。提供的漏洞利用代码 `XEImplantScanner.py` 主要用于扫描目标系统是否存在漏洞以及是否被植入后门。该脚本通过发送特定的 HTTP 请求到 `/webui/logoutconfirm.html` 端点来检测漏洞和后门的存在。

**利用方式：**

1.  **初始访问：** 未经身份验证的攻击者发送特制的 HTTP 请求到目标设备的 Web UI。
2.  **权限提升：** 利用 CVE-2023-20198，创建一个具有特权 15 权限的本地用户。
3.  **后门植入（CVE-2023-20273）：** 使用新创建的具有特权的用户，攻击者可以进一步利用另一个漏洞（CVE-2023-20273）来提升权限至 root，并将植入体写入文件系统，实现持久化控制。

**有效性：**

根据搜索引擎结果（例如，horizon3.ai 的文章）和漏洞库信息，CVE-2023-20198 漏洞已被成功利用。提供的 POC 代码 `XEImplantScanner.py` 旨在检测漏洞的存在以及后门的植入，本身不包含直接利用漏洞进行权限提升的代码，需要结合 CVE-2023-20273 来完全控制。

**投毒风险：**

POC 代码 `XEImplantScanner.py` 主要功能是扫描，相对安全。可能的投毒风险在于：

*   **结果误导：** 扫描结果可能被篡改，导致用户误判系统的安全状态。
*   **依赖风险：** 脚本依赖于 `requests` 库，如果 `requests` 库被恶意版本替换，可能导致代码执行。
*   **网络钓鱼:** 脚本可能被用于钓鱼，诱导用户扫描恶意服务器，泄露信息。

因此，评估的投毒风险为 10%。主要是考虑到其扫描器性质，以及依赖库被投毒的可能性。

**项目地址:** [ZephrFish/CVE-2023-20198-Checker](https://github.com/ZephrFish/CVE-2023-20198-Checker)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #15

**来源**: [CVE-2023-20198-alekos3_CVE_2023_20198_Detector.md](../2023/CVE-2023-20198-alekos3_CVE_2023_20198_Detector.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响系统

**影响版本:** 见受影响版本列表

**利用条件:** Web UI 功能已启用,网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。攻击者可以利用此漏洞绕过身份验证，创建一个具有 15 级权限的本地用户，从而完全控制受影响的系统。该漏洞结合 CVE-2023-20273 使用，CVE-2023-20198 用于初始访问，CVE-2023-20273 用于提权至 root 并写入植入程序到文件系统。

**利用方式：**

1.  未经身份验证的攻击者发送特制的HTTP请求到启用了Web UI的Cisco IOS XE设备。
2.  利用CVE-2023-20198漏洞，创建一个具有特权级别15的本地用户。
3.  使用新创建的本地用户利用CVE-2023-20273漏洞，将权限提升到root。
4.  将植入程序写入文件系统，从而完全控制设备。

**POC代码分析：**

提供的Python脚本 (`CVE_2023_20198_detector.py`) 主要用于检测设备是否存在漏洞，而不是利用该漏洞。它通过SSH连接到设备，并运行一些命令来检查Web UI是否启用，并尝试检测是否存在攻击迹象，例如存在`ip http server`, `ip http secure-server`,  `ip http active`配置。脚本通过`netmiko`库实现SSH连接和命令执行。该脚本没有直接创建特权用户的恶意代码，只是用于检测是否存在漏洞。该脚本会生成一个csv文件`Results_CVE_2023_20198_{current_timestamp}.csv` 用于记录检测结果。

**有效性：**

根据搜索引擎结果，存在公开的POC代码，可以创建特权用户。`CVE_2023_20198_detector.py`脚本本身并不能直接利用漏洞，它只能用来检测目标是否存在漏洞。

**投毒风险：**

该脚本的投毒风险极低 (0%)。虽然用户需要输入用户名和密码，但是该脚本只是用来检测是否存在漏洞，没有发现任何可疑的代码或后门，也没有修改系统配置的任何行为。LICENSE文件为标准的MIT License。

**项目地址:** [alekos3/CVE_2023_20198_Detector](https://github.com/alekos3/CVE_2023_20198_Detector)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #16

**来源**: [CVE-2023-20198-emomeni_Simple-Ansible-for-CVE-2023-20198.md](../2023/CVE-2023-20198-emomeni_Simple-Ansible-for-CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可导致完全控制受影响的设备

**影响版本:** 16.1.1 to 17.12.1

**利用条件:** Web UI 功能已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。根据漏洞库信息和搜索引擎结果，未经身份验证的攻击者可以利用此漏洞创建一个具有 15 级权限（完全访问所有命令）的本地用户。攻击者首先利用 CVE-2023-20198 获得初始访问权限，然后执行权限 15 命令来创建本地用户和密码组合，允许该用户以普通用户身份登录。 然后攻击者利用 web UI 功能的另一个组件，利用新的本地用户将权限提升到 root 并将植入程序写入文件系统，cve-2023-20273。

**有效性：**
根据搜索引擎结果（例如Horizon3.ai的博客），已经存在公开可用的PoC，并且漏洞被积极利用。提供的Ansible剧本并不是直接的漏洞利用代码，而是用于检测并禁用HTTP/HTTPS服务器以缓解漏洞。它也能检测是否已经遭受攻击，通过分析syslog。

**投毒风险：**
提供的Ansible剧本的主要目的是缓解漏洞，而不是利用漏洞。虽然其中包含连接到Cisco设备的凭据（developer/lastorangerestoreball8876），但这些是 Cisco Always On Sandbox 的公开凭据，用于测试目的。 投毒风险较低，但仍然存在一些风险：

1.  **凭据滥用：**  即使凭据是公开的，也可能有人修改剧本以使用不同的凭据尝试访问其他Cisco设备。
2.  **远程执行：**  Ansible 剧本在目标设备上执行命令。如果剧本被恶意修改，可能会导致设备配置更改或执行其他恶意操作。 鉴于此，大约有10%的可能性存在投毒风险。

**利用方式：**
1.  **初始访问：**  攻击者利用 CVE-2023-20198 中的漏洞，绕过身份验证。
2.  **创建高权限用户：**  攻击者利用未授权访问，创建一个具有 15 级权限的本地用户。
3.  **权限提升(CVE-2023-20273):** 攻击者利用本地用户权限和Web UI的另一个漏洞，将权限提升到 root。
4.  **植入后门：**  攻击者利用 root 权限，在设备上植入后门，以便长期控制。

**项目地址:** [emomeni/Simple-Ansible-for-CVE-2023-20198](https://github.com/emomeni/Simple-Ansible-for-CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #17

**来源**: [CVE-2023-20198-fox-it_cisco-ios-xe-implant-detection.md](../2023/CVE-2023-20198-fox-it_cisco-ios-xe-implant-detection.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未经身份验证的攻击者创建具有特权15的本地用户，最终导致完全控制受影响的设备

**影响版本:** 受影响版本包括16.1.1至17.12.1 以及其他相关版本

**利用条件:** Web UI功能已启用，设备可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198是Cisco IOS XE Software Web UI中的一个权限提升漏洞。攻击者可以利用此漏洞，在未经身份验证的情况下，通过发送特制的HTTP请求绕过身份验证，并在受影响的系统上创建一个具有最高权限（特权级别15）的本地用户。创建具有特权15的用户后，攻击者可以使用该用户登录设备，执行任意命令，并完全控制受影响的Cisco IOS XE设备。攻击者利用CVE-2023-20198获得初始访问权限后，会进一步利用CVE-2023-20273将权限提升到root级别，并在文件系统中写入恶意植入程序。

**利用方式：**

1.  **未经身份验证的访问：** 攻击者通过发送特制的HTTP请求，绕过Cisco IOS XE Web UI的身份验证机制。
2.  **创建特权用户：** 成功绕过身份验证后，攻击者可以执行特权命令，创建一个具有最高权限（特权级别15）的本地用户。
3.  **权限提升：** 使用新创建的具有特权15的用户登录设备。
4.  **植入后门:** 利用CVE-2023-20273，将权限提升到root级别，并在文件系统中写入恶意植入程序。

**关于投毒风险：**

提供的漏洞利用代码仅仅是Apache License 2.0协议，这是一个开源协议，本身不包含任何恶意代码。根据现有信息，没有迹象表明该漏洞利用代码中存在任何隐藏的恶意或投毒代码。

**项目地址:** [fox-it/cisco-ios-xe-implant-detection](https://github.com/fox-it/cisco-ios-xe-implant-detection)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #18

**来源**: [CVE-2023-20198-iveresk_cve-2023-20198.md](../2023/CVE-2023-20198-iveresk_cve-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响的Cisco IOS XE设备

**影响版本:** 受影响版本众多，详见漏洞库信息

**利用条件:** Web UI功能已启用，且设备未打补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-20198是一个Cisco IOS XE Software Web UI中存在的权限提升漏洞。根据漏洞库信息和搜索引擎结果，未经身份验证的攻击者可以通过该漏洞创建具有特权15级别（完全访问权限）的本地用户帐户。攻击者首先利用此漏洞获得初始访问权限，然后结合CVE-2023-20273漏洞，利用新创建的本地用户帐户将权限提升至root级别，并在文件系统中写入植入程序。漏洞利用代码 `cve-2023-20198.py` 提供了 `check` 和 `exploit` 两种模式。`check` 模式用于检测目标是否存在漏洞，`exploit` 模式用于创建本地用户帐户。漏洞利用过程包括向 `/webui/logoutconfirm.html` 发送POST请求进行检测，以及向 `/webui/create_user` 发送POST请求创建用户。投毒风险较低，因为代码主要利用已知的漏洞利用方法，但仍存在被修改以执行恶意操作的可能性，例如在创建用户后立即执行其他命令或植入后门程序。主要风险集中在config_content中，可能会存在其他的攻击代码。

**项目地址:** [iveresk/cve-2023-20198](https://github.com/iveresk/cve-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #19

**来源**: [CVE-2023-20198-kacem-expereo_CVE-2023-20198.md](../2023/CVE-2023-20198-kacem-expereo_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可被未授权的攻击者利用创建具有特权 15 的本地用户，为进一步攻击（如植入后门）铺平道路。

**影响版本:** 16.1.1 to 17.12.1 and potentially other versions as indicated in the CVE description.

**利用条件:** 目标设备启用了 Web UI 功能，且位于攻击者可访问的网络中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。未经身份验证的远程攻击者可以通过向目标设备发送特制的 HTTP 请求来利用此漏洞。该漏洞允许攻击者在受影响的系统上创建一个具有特权级别 15 访问权限的帐户。此漏洞是攻击链的第一步，攻击者利用它来创建具有管理权限的本地用户，然后利用 CVE-2023-20273 进一步提升权限至 root，并在文件系统中写入植入程序。提供的 POC 代码 `main.py` 的作用是检测目标 IP 是否容易受到 CVE-2023-20198 的攻击。它通过发送特定的 GET 和 POST 请求来检查目标设备是否返回预期的响应。如果目标返回指示存在漏洞的响应，脚本将输出 'Vulnerable'，否则输出 'Not Vulnerable'。代码通过发送构造的 HTTP GET 请求来尝试绕过身份验证，并检查是否出现预期的“404 Not Found”响应。同时,代码还发送带有硬编码 Authorization 头的 POST 请求，以进一步确认漏洞的存在。尽管代码本身用于检测漏洞，但潜在的投毒风险在于硬编码的 Authorization 头部，以及对 HTTPS 请求的证书验证的禁用（`verify=False`），这可能被恶意修改以进行中间人攻击或者将流量重定向到恶意服务器，虽然这种可能性不大，只有10%。

**利用方式：**

1.  **未经身份验证的访问：** 攻击者无需任何凭据即可发起攻击。
2.  **特制的 HTTP 请求：**  攻击者构造特定的 HTTP GET/POST 请求，利用漏洞绕过身份验证。
3.  **创建特权用户：** 成功利用漏洞后，攻击者可以创建一个拥有最高权限（特权级别 15）的本地用户。
4.  **后续利用：**  创建的特权用户可被用于进一步的恶意活动，例如植入后门、收集敏感信息等（与 CVE-2023-20273 结合）。

**有效性：**
根据漏洞描述和搜索结果，提供的 POC 代码 `main.py` 旨在检测目标是否存在 CVE-2023-20198 漏洞，而不是直接利用该漏洞创建用户。 它通过发送特定的HTTP请求来验证是否存在漏洞。因此，该POC代码在检测方面是有效的。



**项目地址:** [kacem-expereo/CVE-2023-20198](https://github.com/kacem-expereo/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #20

**来源**: [CVE-2023-20198-mr-r3b00t_CVE-2023-20198-IOS-XE-Scanner.md](../2023/CVE-2023-20198-mr-r3b00t_CVE-2023-20198-IOS-XE-Scanner.md)

## CVE-2023-20198-Cisco IOS XE Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的攻击者创建具有特权15权限的本地用户，进而控制设备。

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他一些版本，具体参考漏洞库信息。

**利用条件:** 目标设备启用了Web UI功能，并且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198 漏洞允许未经身份验证的远程攻击者在受影响的 Cisco IOS XE 设备上创建具有特权级别 15 访问权限的帐户。此漏洞是由于 Web UI 功能中存在未受保护的备用通道漏洞 (CWE-420) 造成的。攻击者可以利用此漏洞获得初始访问权限，然后通过 CVE-2023-20273 进一步提升权限至 root 并植入后门。提供的PoC代码 `implant_scanner.ps1` 实际上是一个检测脚本，用于判断目标系统是否已经被植入后门，通过对比Web页面内容的MD5哈希值来判断。脚本本身没有发现明显的投毒代码，config.json中指定了目标URL和已知的哈希值，用于检测是否存在已知的植入体。因此，该仓库中存在作者隐藏的投毒代码的可能性为0%。利用方式是，首先利用CVE-2023-20198创建一个高权限用户，然后利用CVE-2023-20273提升权限并写入植入体（后门）。

**项目地址:** [mr-r3b00t/CVE-2023-20198-IOS-XE-Scanner](https://github.com/mr-r3b00t/CVE-2023-20198-IOS-XE-Scanner)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #21

**来源**: [CVE-2023-20198-netbell_CVE-2023-20198-Fix.md](../2023/CVE-2023-20198-netbell_CVE-2023-20198-Fix.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权远程攻击者创建特权15用户并控制设备

**影响版本:** 受影响版本众多，详见漏洞库信息

**利用条件:** Web UI功能已启用，设备可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性非常高，因为它已被CISA列入已知被利用漏洞目录，并且Cisco官方也已确认存在活跃的利用。漏洞利用方式如下：

1.  **利用CVE-2023-20198获取初始访问权限:** 未经身份验证的攻击者可以利用此漏洞，通过Web UI创建一个具有特权15（最高权限）的本地用户。
2.  **利用CVE-2023-20273提升权限至Root:** 攻击者创建本地用户后，可以利用CVE-2023-20273进一步提升权限至root，并将恶意程序写入文件系统，实现完全控制。

提供的漏洞利用代码（Ansible playbook）实际上是一个缓解措施，旨在禁用Web UI以阻止利用。虽然主要目的是缓解漏洞，但该仓库中存在一定投毒风险。例如:

*   **inventory.yml中的凭据:**  该文件包含默认用户名和密码（admin/admin_password），这可能会被粗心的用户直接用于生产环境，从而使系统暴露于风险之中。
*   **依赖的安全性:**  Ansible playbook的安全性取决于控制机本身的安全。如果控制机被攻破，攻击者可以修改playbook或inventory，从而造成更大范围的损害。

因此，虽然Playbook本身主要是用于缓解漏洞，但配置不当可能导致其他安全问题，存在潜在的投毒风险。务必负责任地存储凭据，使用Ansible Vault或其他安全方法来保护敏感信息。

**项目地址:** [netbell/CVE-2023-20198-Fix](https://github.com/netbell/CVE-2023-20198-Fix)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #22

**来源**: [CVE-2023-20198-ohlawd_CVE-2023-20198.md](../2023/CVE-2023-20198-ohlawd_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，可导致完全控制受影响系统

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他特定版本

**利用条件:** 需要目标设备启用Web UI功能

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。攻击者可以利用此漏洞，在未经身份验证的情况下，通过发送特制请求创建一个具备特权级别15的本地用户，从而获得对设备的完全控制权。由于提供的POC代码仅打印"how bout u exploit d33z nuts"，并没有实际利用漏洞的代码，所以判断其为无效的POC，且具有100%的投毒风险。漏洞利用方式包括：首先利用CVE-2023-20198漏洞获得初始访问权限，然后执行特权15命令以创建本地用户和密码组合。之后，攻击者可能利用CVE-2023-20273漏洞，利用新创建的本地用户将权限提升为root，并将植入程序写入文件系统。

**项目地址:** [ohlawd/CVE-2023-20198](https://github.com/ohlawd/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #23

**来源**: [CVE-2023-20198-raystr-atearedteam_CVE-2023-20198-checker.md](../2023/CVE-2023-20198-raystr-atearedteam_CVE-2023-20198-checker.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI Privilege Escalation

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可能导致完全控制受影响的设备

**影响版本:** 16.1.1 to 17.12.1a 等多个版本 (参考漏洞库信息)

**利用条件:** Web UI功能必须启用，且设备可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-20198 允许未经身份验证的攻击者在受影响的系统上创建一个具有特权级别 15 访问权限的帐户。根据搜索引擎的结果，该漏洞已被积极利用。利用方式是，攻击者首先利用此漏洞获得初始访问权限，然后发出特权 15 命令来创建本地用户和密码组合。然后，攻击者利用另一个漏洞 (CVE-2023-20273) ，利用新创建的本地用户将权限提升为 root 并在文件系统中写入植入程序。 

提供的POC代码尝试通过向 `/webui/logoutconfirm.html` 发送带有 `logon_hash=1` 的POST请求来探测漏洞。如果响应状态码为200，并且响应内容的长度小于32个字符，则可能存在漏洞。POC代码扫描指定的子网，并尝试利用漏洞。 

关于投毒风险，POC代码本身相对简单，主要是网络扫描和HTTP请求。虽然不能完全排除恶意修改的可能性，但代码结构清晰，功能直接，隐藏恶意代码的概率较低。 投毒风险评估较低，大约5%。主要的风险点在于：
1.  **依赖未验证的requests库**：如果requests库本身被投毒，则会影响此脚本。
2.  **成功标志的判断**: 响应内容长度小于32可能是判断依据不足，如果恶意修改，可能导致误报或者漏报，将正常设备标记为存在漏洞，引导使用者进行进一步的恶意操作。

**项目地址:** [raystr-atearedteam/CVE-2023-20198-checker](https://github.com/raystr-atearedteam/CVE-2023-20198-checker)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #24

**来源**: [CVE-2023-20198-reket99_Cisco_CVE-2023-20198.md](../2023/CVE-2023-20198-reket99_Cisco_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，可导致完全控制受影响的Cisco IOS XE设备

**影响版本:** 16.1.1 to 17.12.1 (部分版本)

**利用条件:** Web UI功能已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。攻击者可以利用此漏洞，在未经身份验证的情况下，创建一个具有特权级别15（完全访问所有命令）的本地用户。接下来，攻击者可以利用CVE-2023-20273，通过新创建的本地用户提升权限至root并在文件系统中写入植入物。漏洞利用流程如下：

1.  **CVE-2023-20198 利用:**  未经验证的攻击者通过发送特制的POST请求到`/webui/logoutconfirm.html`，绕过身份验证，创建一个具有管理员权限的新用户。
2.  **CVE-2023-20273 利用:** 使用步骤1中创建的管理员用户，利用另一个Web UI组件中的漏洞，提升权限到root，并写入恶意植入物。

提供的POC代码尝试通过向目标IP地址的`/webui/logoutconfirm.html`发送POST请求来验证漏洞是否存在。如果响应状态码为200，并且响应长度较短（小于32字节），则认为该IP地址易受攻击。然后，脚本会使用curl再次发送请求，如果返回特定的输出长度，则确认漏洞存在。

**关于投毒风险:**

虽然该脚本的主要目的是验证漏洞的存在，但仍然存在一定的投毒风险。风险点在于subprocess.run函数中，使用shell=True来执行curl命令。这使得代码容易受到命令注入攻击，如果攻击者能够控制IP地址或相关参数，则可能执行任意命令。 此外，脚本会将成功利用漏洞的IP地址记录到results.csv 文件中，这虽然不是恶意行为，但可能被恶意行为者利用。投毒风险评估为10%，主要是因为使用了subprocess.run(shell=True)执行外部命令。

**项目地址:** [reket99/Cisco_CVE-2023-20198](https://github.com/reket99/Cisco_CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #25

**来源**: [CVE-2023-20198-sanan2004_CVE-2023-20198.md](../2023/CVE-2023-20198-sanan2004_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响的系统

**影响版本:** 16.1.1 至 17.12.3 以及其他版本

**利用条件:** 目标系统启用了Web UI功能，且位于网络可达范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 存在于 Cisco IOS XE 软件的 Web UI 中。该漏洞允许未经身份验证的攻击者通过不正确的路径验证绕过 Nginx 过滤，访问 `webui_wsma_http` Web 端点，从而可以执行任意 Cisco IOS 命令或进行配置更改，获得 Privilege 15 权限。该漏洞利用涉及两个 XML SOAP 端点：`cisco:wsma-exec` 和 `cisco:wsma-config`。攻击者可以使用 `cisco:wsma-exec` 端点将命令插入到 `execCLI` 元素标记中，例如获取运行配置或执行任意命令。攻击者还可以使用 `cisco:wsma-config` 端点添加具有 Privilege 15 的新用户。随附的 PoC 脚本提供检查漏洞、获取配置、执行命令以及添加/删除用户的功能。PoC 代码的投毒风险较低 (10%)，主要风险在于不熟悉该漏洞的人员可能意外地在生产环境中执行恶意命令，或在测试时使用了存在后门的IOS版本。脚本本身旨在利用漏洞，并且不包含任何明显的恶意或隐藏功能，仓库的README.md声明了此POC的利用方式,降低了隐藏的恶意代码的风险。

**漏洞利用方式：**

1.  **利用 CVE-2023-20198 绕过身份验证：** 攻击者构造特制的 URL 访问易受攻击的 Web UI 端点。
2.  **提升权限：** 成功绕过身份验证后，攻击者可以利用 `cisco:wsma-exec` 或 `cisco:wsma-config` SOAP接口下发命令。
3.  **创建特权用户：** 攻击者创建一个具有 Privilege 15 权限的新用户，从而获得对系统的完全控制。
4.  **执行任意命令：** 攻击者可以使用提权的会话执行任意 Cisco IOS 命令，包括安装后门、修改配置或窃取敏感信息。

**项目地址:** [sanan2004/CVE-2023-20198](https://github.com/sanan2004/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #26

**来源**: [CVE-2023-20198-securityphoenix_cisco-CVE-2023-20198-tester.md](../2023/CVE-2023-20198-securityphoenix_cisco-CVE-2023-20198-tester.md)

## CVE-2023-20198-Cisco IOS XE Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的攻击者创建具有特权15的本地用户，从而完全控制设备

**影响版本:** 受影响的版本包括 16.1.1 到 17.12.1 以及其他版本

**利用条件:** Web UI 功能必须已启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞信息和搜索结果，CVE-2023-20198 允许未经身份验证的攻击者在受影响的 Cisco IOS XE 设备上创建具有 privilege level 15 （最高权限）的本地用户。漏洞利用涉及向 Web UI 发送特制的 HTTP POST 请求，绕过身份验证机制。创建具有最高权限的用户后，攻击者可以使用该账户执行任意命令，并完全控制设备。提供的 `cisco_tester.py` 脚本旨在检测目标设备是否受到 CVE-2023-20198 的影响。它通过向 `/webui/logoutconfirm.html?logon_hash=1` 发送 POST 请求，并检查响应中是否包含特定的字符串 `1a80b7389ccd0a5dab` 来判断设备是否已被入侵。该字符串很可能是一个被利用的设备的特征。

**有效性:**

根据漏洞库信息、搜索结果（特别是 https://www.horizon3.ai/attack-research/attack-blogs/cisco-ios-xe-cve-2023-20198-deep-dive-and-poc/）和漏洞利用代码，该漏洞的利用是有效的，已经有公开可用的PoC。

**投毒风险:**

提供的Python脚本本身主要是一个检测工具，用于检查Cisco设备是否受到CVE-2023-20198的影响，它通过检测特定Hash值判断系统是否已经被植入后门。该脚本逻辑比较简单，主要功能为发送HTTP请求并匹配特定字符串。风险点可能在于脚本对异常的处理不够严谨，如果目标存在其他漏洞，可能被利用，但从代码本身来看，投毒的可能性较低，例如作者没有隐藏恶意的代码执行、数据窃取等行为。可以认为投毒风险极低，可能性约为1%。

**利用方式:**

1.  **未经身份验证的权限提升:**  攻击者利用 CVE-2023-20198 在 Cisco IOS XE 设备上创建一个具有最高权限 (privilege level 15) 的本地用户。
2.  **初始访问:**  利用漏洞绕过 Web UI 的身份验证机制。
3.  **命令执行:**  使用新创建的特权用户账户登录并执行任意命令，实现对设备的完全控制。
4.  **植入后门:** 利用CVE-2023-20273，提升权限至root,写入后门文件。

总而言之，此漏洞允许攻击者完全控制受影响的Cisco设备，风险极高。

**项目地址:** [securityphoenix/cisco-CVE-2023-20198-tester](https://github.com/securityphoenix/cisco-CVE-2023-20198-tester)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #27

**来源**: [CVE-2023-20198-smokeintheshell_CVE-2023-20198.md](../2023/CVE-2023-20198-smokeintheshell_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权用户创建特权用户并执行任意命令

**影响版本:** 受影响版本包括16.1.1到17.12.1等多个版本

**利用条件:** 需要目标设备启用Web UI功能，且攻击者能够网络访问该Web UI。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。该漏洞源于对 Nginx 过滤器的不当路径验证，允许未经身份验证的攻击者绕过身份验证访问 `webui_wsma_http` Web 端点。

**利用方式：**

1.  攻击者利用漏洞绕过身份验证，向 `webui_wsma_http` 端点发送特制的 XML SOAP 请求。
2.  攻击者可以使用 `cisco:wsma-exec` SOAP 端点执行任意 Cisco IOS 命令，或者使用 `cisco:wsma-config` SOAP 端点创建具有 Privilege 15 权限的本地用户。
3.  创建具有 Privilege 15 权限的用户后，攻击者可以使用该用户登录并执行任何操作。
4.  结合CVE-2023-20273，攻击者可以进一步提升权限至root，并写入植入程序。

**有效性：**

根据漏洞描述和提供的漏洞利用代码，该漏洞利用是有效的。漏洞利用代码包含检查漏洞是否存在、获取 Cisco IOS 运行配置、执行任意 Cisco IOS 命令以及添加/删除特权用户的功能。搜索引擎结果也表明该漏洞已被 активно利用。

**投毒风险：**

分析提供的漏洞利用代码（exploit.py），发现以下潜在风险：

*   虽然代码本身看起来直接实现了漏洞利用，但仍然存在作者在代码中加入恶意行为的可能性。
*   例如，可以修改添加用户的函数，在创建高权限用户的同时，静默地执行其他恶意配置更改（如添加后门路由或修改系统日志设置）。
*   代码中使用了多个 SOAP 端点，虽然文档中只提到了 `cisco:wsma-exec` 和 `cisco:wsma-config`，但作者可能利用其他未公开的端点执行恶意操作。
*   因此，需要仔细审查代码的每一行，特别是与网络请求和配置更改相关的部分，以确保没有隐藏的恶意逻辑。
*  根据代码内容，未发现明显的恶意代码，但由于该漏洞可以创建高权限用户，如果攻击者利用该漏洞，完全可以植入后门，存在投毒风险。
*  代码本身风险较低，投毒风险主要体现在被攻击者利用后实施的恶意行为，故将风险调整为10%。

**项目地址:** [smokeintheshell/CVE-2023-20198](https://github.com/smokeintheshell/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #28

**来源**: [CVE-2023-20198-sohaibeb_CVE-2023-20198.md](../2023/CVE-2023-20198-sohaibeb_CVE-2023-20198.md)

# CVE-2023-20198

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-20198-Arshit01_CVE-2023-20198.md](../2023/CVE-2023-20198-Arshit01_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI权限提升漏洞

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响的Cisco设备

**影响版本:** 16.1.1 to 17.12.1及部分17.x版本

**利用条件:** Web UI功能已启用，且目标设备存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。未经身份验证的攻击者可以利用此漏洞创建具有特权级别15（最高权限）的本地用户，从而完全控制受影响的设备。利用过程分为两个阶段：首先利用CVE-2023-20198创建用户，其次利用CVE-2023-20273提升权限至root并写入植入程序。

**漏洞利用方式：**

1.  **身份验证绕过：** 漏洞允许未经身份验证的攻击者与设备的Web UI进行交互。
2.  **创建特权用户：** 攻击者发送特制的SOAP请求到Web UI，该请求绕过身份验证并允许攻击者创建一个具有特权级别15的新用户。
3.  **远程控制：** 创建具有最高权限的用户后，攻击者可以使用此帐户登录设备，并执行任意命令。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的POC代码，可以确认POC代码是有效的。搜索结果中的文章提到了漏洞的成功利用和概念验证代码的存在。POC代码也显示了通过发送特制的XML SOAP请求来创建新用户的机制。

**投毒风险：**

提供的POC代码存在轻微的投毒风险，约为10%。风险点分析如下：

*   **默认用户名和密码：** POC代码使用了默认的用户名（shellsmoke）和密码（pwned）。虽然这方便了漏洞测试，但如果未经修改直接用于攻击，很容易被检测到或被其他人利用。
*   **硬编码的URI：** POC中`exURI = '%2577eb%2575i_%2577sma_Http'`，如果攻击者修改此URI植入恶意代码，可能会导致拒绝服务或者其他恶意行为。
*   **命令执行：** 漏洞本身允许执行任意命令，攻击者可能通过植入恶意命令来感染设备。

需要注意的是，以上只是一些潜在的风险点，具体的投毒行为还需要进一步分析。POC的主要功能是验证漏洞的存在，而非恶意利用。因此，将其判定为具有投毒代码是不准确的。

**项目地址:** [Arshit01/CVE-2023-20198](https://github.com/Arshit01/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #2

**来源**: [CVE-2023-20198-Atea-Redteam_CVE-2023-20198.md](../2023/CVE-2023-20198-Atea-Redteam_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Software Web UI权限提升漏洞

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，未经身份验证的攻击者可以创建具有特权级别15访问权限的帐户，并最终导致完全控制受影响的系统。

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1以及17.11.99SW等众多版本

**利用条件:** Web UI 功能必须启用。需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个关键漏洞。未经身份验证的远程攻击者可以利用此漏洞在受影响的系统上创建具有特权级别 15（完全访问所有命令）的帐户。利用方式是攻击者发送特制的 HTTP 请求到 `/webui/logoutconfirm.html?logon_hash=1` 路径，绕过身份验证，并执行特权命令以创建本地用户和密码组合。创建用户后，攻击者可以利用另一个漏洞（CVE-2023-20273）提升权限至 root 并写入植入程序到文件系统。提供的 Python 脚本 `CVE-2023-20198.py` 旨在检测是否存在该漏洞，并检查已知的 IOC。  该脚本扫描指定子网，并检查目标设备是否返回预期的响应状态码和内容长度。投毒风险评估：脚本本身主要用于检测，但由于脚本包含发送特定请求到目标设备的逻辑，如果攻击者修改此脚本，可能会加入恶意负载或更改用户创建的用户名/密码，存在一定的投毒风险.脚本中存在User-Agent:Atea Red Team CVE-2023-20198 checkscript特征,可能被安全设备检测到。存在的风险点是如果未经授权的人员使用了修改后的脚本，可能会对网络造成损害。 README.md文件没有发现异常。

**项目地址:** [Atea-Redteam/CVE-2023-20198](https://github.com/Atea-Redteam/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #3

**来源**: [CVE-2023-20198-DOMINIC471_qub-network-security-cve-2023-20198.md](../2023/CVE-2023-20198-DOMINIC471_qub-network-security-cve-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权级别15的账户，完全控制受影响的设备。

**影响版本:** 受影响版本众多，包括16.1.1到17.12.1以及其他版本（详见漏洞库信息）。

**利用条件:** Web UI功能必须已启用。设备需要可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞允许未经身份验证的攻击者在Cisco IOS XE设备上创建具有特权级别15（最高权限）的本地用户。攻击者通过利用Web UI中的漏洞绕过身份验证，并执行特权命令创建用户。结合另一个漏洞CVE-2023-20273，攻击者可以进一步提升权限至root并写入植入程序到文件系统。 

**有效性评估：**
根据提供的漏洞库信息和搜索结果，CVE-2023-20198是一个严重漏洞，已被积极利用。

**投毒风险评估：**
查看提供的POC代码，包括README.md和IOC Summary.md文件。 README.md主要描述了如何分析、检测和缓解此漏洞。IOC Summary.md列出了攻击者IP，受害者IP，使用的header以及payload等。这些信息可以辅助蓝队进行防御。
总体来说，该仓库的目的是为了分析和缓解漏洞，并没有发现明显的投毒代码。但是，由于代码中可能包含攻击载荷或恶意命令示例，如果使用者不小心，可能会误用这些代码进行非授权的渗透测试，从而导致法律风险。因此，评估的投毒风险为10%。

**利用方式：**
1.  **未授权访问：** 攻击者利用漏洞，绕过Web UI的身份验证机制。
2.  **创建特权用户：** 攻击者通过发送特制的HTTP请求，执行CLI命令，创建一个具有特权级别15的本地用户。
3.  **持久化（结合CVE-2023-20273）：** 攻击者利用新创建的本地用户登录，并利用另一个漏洞（CVE-2023-20273）提升权限到root，并在文件系统中写入植入程序，实现持久化控制。

**缓解措施：**
*   禁用Web UI功能，如果不需要使用。
*   升级到已修复漏洞的IOS XE软件版本。
*   使用入侵检测/防御系统（IDS/IPS）检测和阻止利用此漏洞的攻击。
*   检查设备上是否存在异常用户和植入程序。

**项目地址:** [DOMINIC471/qub-network-security-cve-2023-20198](https://github.com/DOMINIC471/qub-network-security-cve-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #4

**来源**: [CVE-2023-20198-G4sul1n_Cisco-IOS-XE-CVE-2023-20198.md](../2023/CVE-2023-20198-G4sul1n_Cisco-IOS-XE-CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权15权限的本地用户，结合CVE-2023-20273可提升至root权限并植入后门。

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他相关版本，具体参见漏洞库信息。

**利用条件:** 需要目标系统启用Web UI功能，且网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。根据漏洞信息和搜索结果，该漏洞允许未经身份验证的远程攻击者在受影响的系统上创建一个具有特权级别 15 访问权限的帐户。Cisco的公告指出，攻击者首先利用此漏洞获得初始访问权限，然后执行特权 15 命令以创建本地用户和密码组合。随后，攻击者利用 CVE-2023-20273 将权限提升到 root 并将植入程序写入文件系统。根据提供的漏洞利用代码，该 PoC 包含以下功能：

*   **漏洞检查**：通过执行 `uname -a` 命令来验证漏洞是否存在。
*   **获取 Cisco 配置**：执行 `sh run` 命令来提取运行配置。
*   **执行命令**：允许执行任意 Cisco IOS 命令，但警告需要谨慎使用，因为没有输入验证。
*   **添加用户**：创建一个新的特权 15 用户帐户，可以选择指定用户名和密码。
*   **删除用户**：从设备中删除用户帐户。

**有效性：**

该 PoC 代码的有效性较高，因为漏洞库信息和搜索结果都表明该漏洞已被 активно используется。此外，该 PoC 提供了多种利用方式，包括漏洞检查、信息收集和权限提升。

**投毒风险：**

尽管 PoC 代码主要用于利用已知的漏洞，但仍存在一定的投毒风险，估计为10%。风险点包括：

*   **命令执行**：通过 `-e` 选项执行任意命令，攻击者可能利用此功能执行恶意操作。
*   **用户管理**：虽然提供了添加和删除用户的选项，但如果被滥用，可能导致拒绝服务或系统损坏。

虽然PoC代码本身看起来是为了复现漏洞，但不能完全排除代码作者在其中隐藏恶意功能的可能性，例如植入后门、收集敏感信息等。因此，在使用 PoC 代码时，需要进行仔细审查和安全评估。

**利用方式：**

1.  **未经身份验证的访问**：利用 CVE-2023-20198 绕过身份验证，访问 `webui_wsma_http` Web 端点。
2.  **创建特权用户**：使用 `cisco:wsma-config` SOAP 端点创建一个具有特权 15 的新用户帐户。
3.  **执行任意命令**：使用 `cisco:wsma-exec` SOAP 端点执行任意 Cisco IOS 命令。
4.  **权限提升 (结合 CVE-2023-20273)**：利用新创建的特权用户，结合 CVE-2023-20273 将权限提升到 root，并在系统上植入后门。

总而言之，CVE-2023-20198 是一个严重的安全漏洞，需要立即采取措施进行修复。在使用 PoC 代码时，需要谨慎评估风险，并确保在受控环境中进行测试。

**项目地址:** [G4sul1n/Cisco-IOS-XE-CVE-2023-20198](https://github.com/G4sul1n/Cisco-IOS-XE-CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #5

**来源**: [CVE-2023-20198-IceBreakerCode_CVE-2023-20198.md](../2023/CVE-2023-20198-IceBreakerCode_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权级别 15 的帐户，从而完全控制设备

**影响版本:** 16.1.1 to 17.12.1 and earlier versions

**利用条件:** Web UI 功能已启用并且设备易受攻击版本的影响。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个漏洞，允许未经身份验证的远程攻击者在受影响的系统上创建具有特权级别 15 访问权限的帐户。 

**漏洞利用方式：**

1.  攻击者发送一个特制的 HTTP POST 请求到 `/webui/logoutconfirm.html?logon_hash=1` 端点，绕过身份验证。
2.  成功利用此漏洞后，攻击者可以执行任意命令，包括创建具有特权级别 15 的本地用户。
3.  然后，攻击者使用另一个漏洞（CVE-2023-20273）并通过新创建的本地用户权限提升到 root 权限，并将植入程序写入文件系统。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判定该漏洞的POC代码是有效的。漏洞库信息明确指出存在正在进行的漏洞利用活动。搜索结果也提供了多个关于该漏洞的深度分析和POC示例的链接，例如horizon3.ai上的POC代码。
提供的python脚本模拟了发送特制HTTP请求的过程，旨在检测目标系统是否存在漏洞。脚本会检查HTTP响应状态码和响应体内容，以判断是否存在潜在的植入程序。

**投毒风险：**

评估POC代码的投毒风险，需要仔细分析代码是否存在恶意行为，例如：
1.  **植入后门：**  代码是否在目标系统上安装未经授权的后门。
2.  **数据窃取：**  代码是否窃取敏感信息并发送到外部服务器。
3.  **拒绝服务：**  代码是否导致目标系统崩溃或无法正常运行。
4.  **恶意传播：**  代码是否试图感染其他系统。

分析提供的python脚本，该脚本主要用于检测漏洞是否存在，并未发现明显的恶意行为。脚本的功能是发送特定的HTTP请求并检查响应，以确定目标系统是否受到CVE-2023-20198漏洞的影响。然而，使用任何未经授权的漏洞利用代码都存在风险，因为代码的作者可能隐藏了不易察觉的恶意功能。因此，在使用任何POC代码之前，务必进行彻底的安全审查。

考虑到以上因素，判定该POC代码存在10%的投毒风险，主要是由于作者可能隐藏了一些不易察觉的恶意代码，但主要功能是漏洞验证。

**缓解措施：**

*   禁用 Web UI 功能，特别是当设备面向互联网时。
*   将 Web UI 访问限制为受信任的网络。
*   升级到已修复漏洞的 Cisco IOS XE 软件版本。

**项目地址:** [IceBreakerCode/CVE-2023-20198](https://github.com/IceBreakerCode/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #6

**来源**: [CVE-2023-20198-JoyGhoshs_CVE-2023-20198.md](../2023/CVE-2023-20198-JoyGhoshs_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可导致完全控制受影响设备

**影响版本:** 受影响版本范围广泛，详见漏洞库信息

**利用条件:** Web UI功能已启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198 允许未经身份验证的攻击者在受影响的系统上创建具有权限级别15（完全访问权限）的帐户。该漏洞利用方式如下：

1.  **初始访问:** 攻击者利用CVE-2023-20198漏洞，通过Web UI创建具有高权限的本地用户。
2.  **权限提升:** 然后，攻击者可能利用CVE-2023-20273（另一个漏洞）或使用新创建的本地用户进一步将权限提升至root。
3.  **植入后门:** 攻击者利用获得的root权限，在文件系统中写入恶意植入。

提供的POC代码`poc.py`是一个**检测工具**，而非完整的漏洞利用代码。它通过发送一个特定的HTTP请求到`/webui/logoutconfirm.html?logon_hash=1`，并检查响应内容是否为十六进制字符串来判断目标是否可能受到了攻击并植入了后门。如果响应是十六进制字符串，则表明设备可能已遭入侵，并存在植入的后门（该后门会返回hex信息）。

该存储库中的`README.md`文件说明，此脚本并非完整的POC，仅用于检查是否存在hex响应。因此，它无法直接用于漏洞利用，而只能用于检测。

**投毒风险分析：**

查看`poc.py`文件内容，发现其功能主要是发送HTTP请求并判断响应内容。该代码的功能比较简单，未发现任何可能导致恶意行为（例如，上传恶意文件、执行任意命令等）的可疑代码。因此，可以认为该存储库不存在作者隐藏的投毒代码。



**项目地址:** [JoyGhoshs/CVE-2023-20198](https://github.com/JoyGhoshs/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #7

**来源**: [CVE-2023-20198-Pushkarup_CVE-2023-20198.md](../2023/CVE-2023-20198-Pushkarup_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的远程攻击者创建管理员账户并完全控制设备

**影响版本:** 受影响版本详见CVE描述

**利用条件:** 目标设备启用了Web UI功能，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞存在于 Cisco IOS XE 软件的 Web UI 中。未经身份验证的远程攻击者可以通过利用此漏洞在受影响的系统上创建具有特权级别 15 访问权限的帐户。创建账户后，攻击者可以使用该账户完全控制受损的机器。

**有效性：**
提供的 POC 代码根据描述能够创建本地用户，安装植入体，重启Web服务，并检查植入体的状态，因此具备有效性。

**投毒风险：**
此仓库中可能存在作者隐藏的投毒代码。尽管自述文件声明 PoC 仅用于教育目的，并且使用需要遵守道德规范，但攻击者可以修改 `config_content` 以包含恶意配置，例如更改防火墙规则或执行其他恶意操作。此外，虽然代码本身没有明显的恶意行为，但其目的是在目标系统上创建具有管理权限的用户，这本身就可以被认为是恶意的。因此，存在一定的投毒风险，但是相对较低，风险评估在10%。此风险评估基于以下因素：
    *   代码可能被用于未授权的系统访问。
    *   配置文件可被修改为包含恶意指令。

**利用方式：**
1.  攻击者利用 CVE-2023-20198 漏洞，通过未授权访问在 Cisco IOS XE 设备上创建一个具有特权级别 15 的本地用户。
2.  攻击者使用新创建的管理员账户登录到设备。
3.  攻击者利用 CVE-2023-20273 漏洞，进一步提升权限至 root 级别，并将恶意植入程序写入文件系统。
4.  攻击者通过植入的后门程序远程控制设备，执行恶意操作，例如数据窃取、网络攻击等。
根据搜索结果，CISA 已将此漏洞添加到已知被利用的漏洞目录中，表明该漏洞已经被广泛利用。

**项目地址:** [Pushkarup/CVE-2023-20198](https://github.com/Pushkarup/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #8

**来源**: [CVE-2023-20198-RevoltSecurities_CVE-2023-20198.md](../2023/CVE-2023-20198-RevoltSecurities_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，可被未授权的攻击者利用创建特权用户，进而完全控制系统。

**影响版本:** 受影响的版本包括16.1.1到17.12.1以及其他一系列17.x版本 (详见漏洞库信息)

**利用条件:** 目标设备启用Web UI功能，并且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。根据漏洞库信息和搜索引擎结果，未经身份验证的攻击者可以利用此漏洞在受影响的系统上创建一个具有 15 级权限（最高权限）的帐户。随后攻击者再利用CVE-2023-20273，将权限提升至root，并写入植入体。该漏洞的利用方式如下：

1.  **漏洞触发：** 攻击者发送特制的HTTP请求到Cisco IOS XE设备的Web UI接口，绕过身份验证。
2.  **创建特权用户：** 请求中包含特定的XML内容，该内容允许攻击者创建一个新的本地用户，并分配最高权限（privilege level 15）。
3.  **权限提升：** 攻击者利用创建的特权用户登录系统。
4.  **植入后门：** 攻击者通过Web UI的另一个组件（CVE-2023-20273）将权限提升至root并写入植入体。

**有效性：** 根据搜索引擎结果（特别是horizon3.ai的POC）以及提供的漏洞利用代码，此漏洞利用是有效的。漏洞利用代码仓库提供了一个Python脚本，可以检测和利用此漏洞。

**投毒风险：** 漏洞利用代码仓库的投毒风险评估为10%。虽然该仓库提供了看似合理的漏洞利用脚本，但存在以下潜在风险点：

*   **自定义配置内容：** 脚本允许用户提供自定义的配置内容（`-cfc` 或 `--config-content` 参数），这可能被滥用以注入恶意代码或配置。
*   **隐蔽后门：** 虽然主要功能是利用漏洞，但作者可能在代码中添加了不易察觉的后门，例如收集目标信息、执行任意命令等。代码量较少，通读代码可以降低风险。

**防范措施：**

*   立即更新Cisco IOS XE软件到已修复的版本。
*   禁用Web UI功能，如果不需要。
*   监控网络流量，检测异常的Web UI请求。
*   使用Cisco提供的软件检查工具来识别和移除潜在的植入体。

**项目地址:** [RevoltSecurities/CVE-2023-20198](https://github.com/RevoltSecurities/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #9

**来源**: [CVE-2023-20198-Shadow0ps_CVE-2023-20198-Scanner.md](../2023/CVE-2023-20198-Shadow0ps_CVE-2023-20198-Scanner.md)

## CVE-2023-20198 Cisco IOS XE Web UI 权限提升漏洞

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权 15 权限的本地用户，从而完全控制受影响的设备。

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1 以及 17.11.99SW

**利用条件:** Web UI 功能必须已启用。攻击者需要能够通过网络访问设备的 Web UI。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。未经身份验证的远程攻击者可以利用此漏洞在受影响的系统上创建一个具有特权 15 访问权限的帐户，本质上是管理员权限。漏洞利用通常与另一个漏洞 CVE-2023-20273 结合使用，后者用于将权限提升到 root 并将植入程序写入文件系统。

**漏洞利用有效性：**

根据漏洞库信息、搜索引擎结果（特别是 horizon3.ai 的 PoC 描述）以及提供的漏洞利用代码片段来看，该漏洞的利用是有效的。存在公开可用的 PoC，允许攻击者绕过身份验证创建具有管理权限的用户。

**投毒风险分析：**

提供的代码片段分析表明，攻击流程依赖于 Nginx 配置和一个 Lua 脚本。Lua 脚本的核心功能在于身份验证绕过和命令执行。脚本通过检查是否存在特定的 "Authorization" Header以及Header的内容是否和通过REDACTED命令执行结果匹配来确定请求是否被授权。

由于 "REDACTED" 信息的缺失，我们无法完全确定是否存在恶意投毒代码。但是lua脚本的下列行为存在潜在的投毒风险：

1.  **外部命令执行:** 脚本多次使用 `io.popen()` 执行外部命令。如果这些命令包含恶意参数或旨在下载和执行其他代码，则可能导致系统受损。
2.  **硬编码的凭据和逻辑：**脚本逻辑依赖于特定的哈希值和其他硬编码的字符串。攻击者可能会修改这些字符串以创建变体，从而绕过安全检测或植入后门。
3.  **对/lua5的请求:** 当common_type=iox时,会调用/lua5,如果/lua5是作者控制的地址,则存在投毒风险。

基于以上分析，虽然无法确定明确的投毒代码，但脚本中使用的技术（尤其是外部命令执行）增加了被用于恶意目的的可能性，估计投毒风险为20%。

**漏洞利用方式：**

1.  **未授权访问:** 攻击者发送一个特制的 HTTP POST 请求到 `/webui/logoutconfirm.html`，绕过身份验证检查（利用 CVE-2023-20198）。这可能涉及到提供特定的 `Authorization` header，该header的值能够通过预设的验证。
2.  **创建高权限用户:** 绕过身份验证后，攻击者可以发送包含创建新用户（具有特权级别 15）的命令的请求体。该命令通过 `io.popen()` 执行，从而创建一个具有管理员权限的本地用户。
3.  **权限提升和植入：** (结合 CVE-2023-20273) 使用新创建的本地用户登录并利用 CVE-2023-20273 将权限提升至 root，从而能够在设备上安装植入程序。


**项目地址:** [Shadow0ps/CVE-2023-20198-Scanner](https://github.com/Shadow0ps/CVE-2023-20198-Scanner)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #10

**来源**: [CVE-2023-20198-Tounsi007_CVE-2023-20198.md](../2023/CVE-2023-20198-Tounsi007_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可能导致完全控制受影响设备

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他版本

**利用条件:** 目标设备启用了Web UI功能并且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞存在于Cisco IOS XE Software的Web UI中，允许未经身份验证的远程攻击者创建一个具有特权级别15（完全访问权限）的本地用户帐户。该漏洞利用方式是通过发送特制的HTTP请求到`/webui/create_user`路径来创建用户。攻击者随后可利用创建的用户并通过另一个漏洞CVE-2023-20273提升权限至root并写入植入程序。提供的POC代码尝试模拟此过程，包括创建用户、安装植入程序、重启Web服务器、检查植入程序状态以及清理创建的用户。 

**有效性：**根据漏洞信息、搜索结果和提供的POC代码，该漏洞是有效的。搜索引擎结果表明该漏洞已被积极利用，并且存在公开可用的POC代码。CISA的已知被利用漏洞目录也收录了该漏洞。

**投毒风险：**POC代码本身存在一定的风险。虽然代码的主要功能是利用漏洞，但`config_content`变量表明存在植入恶意配置的可能性。 用户需要手动插入植入配置,存在被植入后门的风险。
该仓库readme描述，POC仅用于测试和学习，有免责声明。存在一定概率作者未充分测试。

**利用方式：**
1.  **初始访问：** 未经身份验证的攻击者发送特制HTTP请求到存在漏洞的Cisco IOS XE设备的Web UI接口。
2.  **用户创建：**  利用CVE-2023-20198，攻击者通过`/webui/create_user`接口创建一个具有管理员权限的新用户。
3.  **权限提升（CVE-2023-20273）：** 利用新创建的用户，攻击者可以进一步利用Web UI中的另一个漏洞（CVE-2023-20273）来提升权限至root。
4.  **植入后门：** 攻击者可以写入植入程序到文件系统。
5.  **持久化：** 植入程序可以用于维持对受感染设备的访问。
6.  **清理（可选）：** 攻击者可以选择删除他们创建的后门账户，以隐藏其踪迹。

**项目地址:** [Tounsi007/CVE-2023-20198](https://github.com/Tounsi007/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #11

**来源**: [CVE-2023-20198-Vulnmachines_Cisco_CVE-2023-20198.md](../2023/CVE-2023-20198-Vulnmachines_Cisco_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可使未授权的攻击者获得完全管理权限

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1 以及其他多个版本

**利用条件:** Web UI 功能启用并且 HTTP 或 HTTPS 服务器功能开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个关键身份验证绕过漏洞。根据漏洞信息和搜索结果，攻击者利用此漏洞首先获得初始访问权限，然后执行特权 15 命令来创建一个本地用户和密码组合，从而获得管理员权限。之后，攻击者利用 CVE-2023-20273 将权限提升到 root 并在文件系统中写入植入程序。提供的 POC 代码显示了一个用于利用漏洞的 HTTP POST 请求示例。请求的目标 URI 经过编码处理，绕过了身份验证。请求体包含一个 SOAP 信封，该信封尝试使用默认的 "admin" 用户名执行命令 "uname -a"。有效性：根据搜索结果和漏洞描述，提供的 POST 请求通过身份验证绕过在受影响的设备上创建具有特权 15 的用户，因此 POC 代码有效。 投毒风险：README.md 文件描述了漏洞，并提供了一个关于利用该漏洞的概述。Payload 文件包含一个 SOAP 请求，用于发送 CLI 命令。虽然该请求本身看起来无害（执行 `uname -a` 命令），但攻击者可能会修改该请求以执行恶意命令。例如，更改命令以创建具有特权 15 的用户。 因此，存在一定风险，即此仓库可能被用于传播恶意利用程序。Payload 代码文件本身没有明显的投毒代码，但存在被修改利用的风险，因此判定投毒风险为 10%。利用方式：1. 检查目标 Cisco IOS XE 设备是否启用了 Web UI 功能和 HTTP/HTTPS 服务器。2. 发送构造的 HTTP POST 请求到目标设备，利用身份验证绕过漏洞。3. 请求的目标 URI 经过编码处理以绕过身份验证检查。4. POST 请求的内容为 SOAP 信封，其中包含要执行的 CLI 命令。5. 成功利用后，攻击者可以在设备上执行任意 CLI 命令，例如创建新的管理员帐户或植入恶意软件。

**项目地址:** [Vulnmachines/Cisco_CVE-2023-20198](https://github.com/Vulnmachines/Cisco_CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #12

**来源**: [CVE-2023-20198-W01fh4cker_CVE-2023-20198-RCE.md](../2023/CVE-2023-20198-W01fh4cker_CVE-2023-20198-RCE.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权15的用户，进而完全控制受影响的设备。

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1 等多个版本

**利用条件:** Web UI 功能已启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。未经身份验证的远程攻击者可以利用此漏洞在受影响的系统上创建一个具有特权 15 访问权限的帐户，从而完全控制设备。利用方式如下：

1.  **漏洞触发点：** Cisco IOS XE 软件的 Web UI 组件存在漏洞。
2.  **利用过程：** 攻击者通过发送特制的 SOAP 请求到 `/%%77ebui_wsma_https` 或 `/%%77ebui_wsma_Http` URI (具体取决于是否使用 HTTPS) 绕过身份验证。
3.  **命令执行：** 攻击者使用 `urn:cisco:wsma-config` 命名空间执行 CLI 命令，创建新的具有特权 15 的用户。
4.  **后续利用 (CVE-2023-20273):** 在获得初始访问权限后，攻击者可以利用 CVE-2023-20273 将权限提升为 root 并在文件系统中写入植入程序。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞已被积极利用，提供的 PoC 代码有效，可以用于创建具有特权 15 的用户。

**投毒风险：**

PoC 代码主要功能是利用漏洞，创建新用户，从代码本身来看，存在一些潜在的投毒点，例如：

*   **随机用户名/密码生成：**  虽然代码中包含随机用户名生成函数，但实际使用中，攻击者可能会替换为预设的用户名和密码，方便后续控制。
*   **代理服务器使用：**  PoC 代码支持使用代理服务器，攻击者可以借此隐藏真实 IP 地址，增加溯源难度。
*   **异常处理：**  代码中包含异常处理模块，可能用于隐藏利用过程中的错误信息，避免被发现。
*   **User-Agent:** 使用了常见的User-Agent，但是依然存在替换或者增加其他User-Agent进行恶意攻击.

总体来说，PoC 代码的投毒风险较低，主要集中在以上几点，但需要使用者谨慎使用。

**总结：**

该漏洞利用的有效性很高，并且在野外被广泛利用。PoC 代码可以用来验证漏洞的存在并创建管理员用户，但需要注意潜在的投毒风险。利用方式是发送特制的 SOAP 请求，绕过身份验证，然后执行 CLI 命令。

**项目地址:** [W01fh4cker/CVE-2023-20198-RCE](https://github.com/W01fh4cker/CVE-2023-20198-RCE)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #13

**来源**: [CVE-2023-20198-XiaomingX_cve-2023-20198-poc.md](../2023/CVE-2023-20198-XiaomingX_cve-2023-20198-poc.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响设备

**影响版本:** 受影响版本范围广泛，详见漏洞库信息

**利用条件:** Web UI 功能启用且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 存在于 Cisco IOS XE 软件的 Web UI 中。未经身份验证的攻击者可以利用此漏洞创建具有 privilege level 15 权限的本地用户，从而获得对设备的完全控制权。利用方式主要通过发送特制的 SOAP 请求到目标设备的 Web UI 接口，绕过身份验证，执行 CLI 命令。PoC 代码通过构造恶意的 SOAP 消息，例如 `username <username> privilege 15 secret <password>`，添加高权限用户。 

有效性分析：根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开的 PoC。提供的 PoC 代码实现了漏洞利用的基本功能，包括检查漏洞、获取配置、执行命令和添加/删除用户。因此，提供的 PoC 代码是有效的。

投毒风险分析：代码本身主要实现了漏洞利用功能，但仍然存在一定的投毒风险。体现在以下几个方面：

*   **恶意命令执行：** 虽然代码本身没有硬编码的恶意命令，但 `-e` 参数允许攻击者执行任意 Cisco IOS 命令。攻击者可能会使用此参数注入恶意配置或植入后门。
*   **硬编码凭据：** 默认用户名 `shellsmoke` 和密码 `pwned` 如果不修改，可能被其他攻击者利用。虽然这是一个PoC，但在实际使用中容易被忽视，从而导致设备被二次入侵。
*   **异常处理：** 某些异常处理不够完善，可能导致程序崩溃或泄露敏感信息。
*   **Payload内容:** 在SOAP请求模板中，攻击者可能修改命令或者在ADD_USER的情况下，添加后门账户。

综合考虑，该 PoC 存在一定的投毒风险，但主要集中在用户使用不当或被恶意利用的可能性上，PoC本身是漏洞的利用，投毒代码的可能性评判为 10%。建议使用者在使用 PoC 时仔细审查代码，并采取必要的安全措施。

利用方式总结：

1.  **目标确认：** 确定目标 Cisco IOS XE 设备是否启用了 Web UI 功能。
2.  **发送恶意 SOAP 请求：** 构造包含 CLI 命令的恶意 SOAP 请求，绕过身份验证。
3.  **权限提升：** 利用漏洞创建具有 privilege level 15 权限的本地用户。
4.  **完全控制：** 使用新创建的用户登录并完全控制设备。

**项目地址:** [XiaomingX/cve-2023-20198-poc](https://github.com/XiaomingX/cve-2023-20198-poc)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #14

**来源**: [CVE-2023-20198-ZephrFish_CVE-2023-20198-Checker.md](../2023/CVE-2023-20198-ZephrFish_CVE-2023-20198-Checker.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权15权限的本地用户，随后可能被用于植入后门和完全控制设备

**影响版本:** 受影响版本：16.1.1 到 17.12.1，以及其他相关版本（详见漏洞库信息）

**利用条件:** 目标设备启用了Web UI功能，且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞允许未经身份验证的攻击者在受影响的 Cisco IOS XE 设备上创建一个具有特权 15 权限（最高权限）的本地用户。该漏洞存在于 Web UI 功能中。根据搜索引擎结果和漏洞库信息，此漏洞已被积极利用。提供的漏洞利用代码 `XEImplantScanner.py` 主要用于扫描目标系统是否存在漏洞以及是否被植入后门。该脚本通过发送特定的 HTTP 请求到 `/webui/logoutconfirm.html` 端点来检测漏洞和后门的存在。

**利用方式：**

1.  **初始访问：** 未经身份验证的攻击者发送特制的 HTTP 请求到目标设备的 Web UI。
2.  **权限提升：** 利用 CVE-2023-20198，创建一个具有特权 15 权限的本地用户。
3.  **后门植入（CVE-2023-20273）：** 使用新创建的具有特权的用户，攻击者可以进一步利用另一个漏洞（CVE-2023-20273）来提升权限至 root，并将植入体写入文件系统，实现持久化控制。

**有效性：**

根据搜索引擎结果（例如，horizon3.ai 的文章）和漏洞库信息，CVE-2023-20198 漏洞已被成功利用。提供的 POC 代码 `XEImplantScanner.py` 旨在检测漏洞的存在以及后门的植入，本身不包含直接利用漏洞进行权限提升的代码，需要结合 CVE-2023-20273 来完全控制。

**投毒风险：**

POC 代码 `XEImplantScanner.py` 主要功能是扫描，相对安全。可能的投毒风险在于：

*   **结果误导：** 扫描结果可能被篡改，导致用户误判系统的安全状态。
*   **依赖风险：** 脚本依赖于 `requests` 库，如果 `requests` 库被恶意版本替换，可能导致代码执行。
*   **网络钓鱼:** 脚本可能被用于钓鱼，诱导用户扫描恶意服务器，泄露信息。

因此，评估的投毒风险为 10%。主要是考虑到其扫描器性质，以及依赖库被投毒的可能性。

**项目地址:** [ZephrFish/CVE-2023-20198-Checker](https://github.com/ZephrFish/CVE-2023-20198-Checker)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #15

**来源**: [CVE-2023-20198-alekos3_CVE_2023_20198_Detector.md](../2023/CVE-2023-20198-alekos3_CVE_2023_20198_Detector.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响系统

**影响版本:** 见受影响版本列表

**利用条件:** Web UI 功能已启用,网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。攻击者可以利用此漏洞绕过身份验证，创建一个具有 15 级权限的本地用户，从而完全控制受影响的系统。该漏洞结合 CVE-2023-20273 使用，CVE-2023-20198 用于初始访问，CVE-2023-20273 用于提权至 root 并写入植入程序到文件系统。

**利用方式：**

1.  未经身份验证的攻击者发送特制的HTTP请求到启用了Web UI的Cisco IOS XE设备。
2.  利用CVE-2023-20198漏洞，创建一个具有特权级别15的本地用户。
3.  使用新创建的本地用户利用CVE-2023-20273漏洞，将权限提升到root。
4.  将植入程序写入文件系统，从而完全控制设备。

**POC代码分析：**

提供的Python脚本 (`CVE_2023_20198_detector.py`) 主要用于检测设备是否存在漏洞，而不是利用该漏洞。它通过SSH连接到设备，并运行一些命令来检查Web UI是否启用，并尝试检测是否存在攻击迹象，例如存在`ip http server`, `ip http secure-server`,  `ip http active`配置。脚本通过`netmiko`库实现SSH连接和命令执行。该脚本没有直接创建特权用户的恶意代码，只是用于检测是否存在漏洞。该脚本会生成一个csv文件`Results_CVE_2023_20198_{current_timestamp}.csv` 用于记录检测结果。

**有效性：**

根据搜索引擎结果，存在公开的POC代码，可以创建特权用户。`CVE_2023_20198_detector.py`脚本本身并不能直接利用漏洞，它只能用来检测目标是否存在漏洞。

**投毒风险：**

该脚本的投毒风险极低 (0%)。虽然用户需要输入用户名和密码，但是该脚本只是用来检测是否存在漏洞，没有发现任何可疑的代码或后门，也没有修改系统配置的任何行为。LICENSE文件为标准的MIT License。

**项目地址:** [alekos3/CVE_2023_20198_Detector](https://github.com/alekos3/CVE_2023_20198_Detector)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #16

**来源**: [CVE-2023-20198-emomeni_Simple-Ansible-for-CVE-2023-20198.md](../2023/CVE-2023-20198-emomeni_Simple-Ansible-for-CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可导致完全控制受影响的设备

**影响版本:** 16.1.1 to 17.12.1

**利用条件:** Web UI 功能已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。根据漏洞库信息和搜索引擎结果，未经身份验证的攻击者可以利用此漏洞创建一个具有 15 级权限（完全访问所有命令）的本地用户。攻击者首先利用 CVE-2023-20198 获得初始访问权限，然后执行权限 15 命令来创建本地用户和密码组合，允许该用户以普通用户身份登录。 然后攻击者利用 web UI 功能的另一个组件，利用新的本地用户将权限提升到 root 并将植入程序写入文件系统，cve-2023-20273。

**有效性：**
根据搜索引擎结果（例如Horizon3.ai的博客），已经存在公开可用的PoC，并且漏洞被积极利用。提供的Ansible剧本并不是直接的漏洞利用代码，而是用于检测并禁用HTTP/HTTPS服务器以缓解漏洞。它也能检测是否已经遭受攻击，通过分析syslog。

**投毒风险：**
提供的Ansible剧本的主要目的是缓解漏洞，而不是利用漏洞。虽然其中包含连接到Cisco设备的凭据（developer/lastorangerestoreball8876），但这些是 Cisco Always On Sandbox 的公开凭据，用于测试目的。 投毒风险较低，但仍然存在一些风险：

1.  **凭据滥用：**  即使凭据是公开的，也可能有人修改剧本以使用不同的凭据尝试访问其他Cisco设备。
2.  **远程执行：**  Ansible 剧本在目标设备上执行命令。如果剧本被恶意修改，可能会导致设备配置更改或执行其他恶意操作。 鉴于此，大约有10%的可能性存在投毒风险。

**利用方式：**
1.  **初始访问：**  攻击者利用 CVE-2023-20198 中的漏洞，绕过身份验证。
2.  **创建高权限用户：**  攻击者利用未授权访问，创建一个具有 15 级权限的本地用户。
3.  **权限提升(CVE-2023-20273):** 攻击者利用本地用户权限和Web UI的另一个漏洞，将权限提升到 root。
4.  **植入后门：**  攻击者利用 root 权限，在设备上植入后门，以便长期控制。

**项目地址:** [emomeni/Simple-Ansible-for-CVE-2023-20198](https://github.com/emomeni/Simple-Ansible-for-CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #17

**来源**: [CVE-2023-20198-fox-it_cisco-ios-xe-implant-detection.md](../2023/CVE-2023-20198-fox-it_cisco-ios-xe-implant-detection.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未经身份验证的攻击者创建具有特权15的本地用户，最终导致完全控制受影响的设备

**影响版本:** 受影响版本包括16.1.1至17.12.1 以及其他相关版本

**利用条件:** Web UI功能已启用，设备可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198是Cisco IOS XE Software Web UI中的一个权限提升漏洞。攻击者可以利用此漏洞，在未经身份验证的情况下，通过发送特制的HTTP请求绕过身份验证，并在受影响的系统上创建一个具有最高权限（特权级别15）的本地用户。创建具有特权15的用户后，攻击者可以使用该用户登录设备，执行任意命令，并完全控制受影响的Cisco IOS XE设备。攻击者利用CVE-2023-20198获得初始访问权限后，会进一步利用CVE-2023-20273将权限提升到root级别，并在文件系统中写入恶意植入程序。

**利用方式：**

1.  **未经身份验证的访问：** 攻击者通过发送特制的HTTP请求，绕过Cisco IOS XE Web UI的身份验证机制。
2.  **创建特权用户：** 成功绕过身份验证后，攻击者可以执行特权命令，创建一个具有最高权限（特权级别15）的本地用户。
3.  **权限提升：** 使用新创建的具有特权15的用户登录设备。
4.  **植入后门:** 利用CVE-2023-20273，将权限提升到root级别，并在文件系统中写入恶意植入程序。

**关于投毒风险：**

提供的漏洞利用代码仅仅是Apache License 2.0协议，这是一个开源协议，本身不包含任何恶意代码。根据现有信息，没有迹象表明该漏洞利用代码中存在任何隐藏的恶意或投毒代码。

**项目地址:** [fox-it/cisco-ios-xe-implant-detection](https://github.com/fox-it/cisco-ios-xe-implant-detection)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #18

**来源**: [CVE-2023-20198-iveresk_cve-2023-20198.md](../2023/CVE-2023-20198-iveresk_cve-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响的Cisco IOS XE设备

**影响版本:** 受影响版本众多，详见漏洞库信息

**利用条件:** Web UI功能已启用，且设备未打补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-20198是一个Cisco IOS XE Software Web UI中存在的权限提升漏洞。根据漏洞库信息和搜索引擎结果，未经身份验证的攻击者可以通过该漏洞创建具有特权15级别（完全访问权限）的本地用户帐户。攻击者首先利用此漏洞获得初始访问权限，然后结合CVE-2023-20273漏洞，利用新创建的本地用户帐户将权限提升至root级别，并在文件系统中写入植入程序。漏洞利用代码 `cve-2023-20198.py` 提供了 `check` 和 `exploit` 两种模式。`check` 模式用于检测目标是否存在漏洞，`exploit` 模式用于创建本地用户帐户。漏洞利用过程包括向 `/webui/logoutconfirm.html` 发送POST请求进行检测，以及向 `/webui/create_user` 发送POST请求创建用户。投毒风险较低，因为代码主要利用已知的漏洞利用方法，但仍存在被修改以执行恶意操作的可能性，例如在创建用户后立即执行其他命令或植入后门程序。主要风险集中在config_content中，可能会存在其他的攻击代码。

**项目地址:** [iveresk/cve-2023-20198](https://github.com/iveresk/cve-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #19

**来源**: [CVE-2023-20198-kacem-expereo_CVE-2023-20198.md](../2023/CVE-2023-20198-kacem-expereo_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可被未授权的攻击者利用创建具有特权 15 的本地用户，为进一步攻击（如植入后门）铺平道路。

**影响版本:** 16.1.1 to 17.12.1 and potentially other versions as indicated in the CVE description.

**利用条件:** 目标设备启用了 Web UI 功能，且位于攻击者可访问的网络中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。未经身份验证的远程攻击者可以通过向目标设备发送特制的 HTTP 请求来利用此漏洞。该漏洞允许攻击者在受影响的系统上创建一个具有特权级别 15 访问权限的帐户。此漏洞是攻击链的第一步，攻击者利用它来创建具有管理权限的本地用户，然后利用 CVE-2023-20273 进一步提升权限至 root，并在文件系统中写入植入程序。提供的 POC 代码 `main.py` 的作用是检测目标 IP 是否容易受到 CVE-2023-20198 的攻击。它通过发送特定的 GET 和 POST 请求来检查目标设备是否返回预期的响应。如果目标返回指示存在漏洞的响应，脚本将输出 'Vulnerable'，否则输出 'Not Vulnerable'。代码通过发送构造的 HTTP GET 请求来尝试绕过身份验证，并检查是否出现预期的“404 Not Found”响应。同时,代码还发送带有硬编码 Authorization 头的 POST 请求，以进一步确认漏洞的存在。尽管代码本身用于检测漏洞，但潜在的投毒风险在于硬编码的 Authorization 头部，以及对 HTTPS 请求的证书验证的禁用（`verify=False`），这可能被恶意修改以进行中间人攻击或者将流量重定向到恶意服务器，虽然这种可能性不大，只有10%。

**利用方式：**

1.  **未经身份验证的访问：** 攻击者无需任何凭据即可发起攻击。
2.  **特制的 HTTP 请求：**  攻击者构造特定的 HTTP GET/POST 请求，利用漏洞绕过身份验证。
3.  **创建特权用户：** 成功利用漏洞后，攻击者可以创建一个拥有最高权限（特权级别 15）的本地用户。
4.  **后续利用：**  创建的特权用户可被用于进一步的恶意活动，例如植入后门、收集敏感信息等（与 CVE-2023-20273 结合）。

**有效性：**
根据漏洞描述和搜索结果，提供的 POC 代码 `main.py` 旨在检测目标是否存在 CVE-2023-20198 漏洞，而不是直接利用该漏洞创建用户。 它通过发送特定的HTTP请求来验证是否存在漏洞。因此，该POC代码在检测方面是有效的。



**项目地址:** [kacem-expereo/CVE-2023-20198](https://github.com/kacem-expereo/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #20

**来源**: [CVE-2023-20198-mr-r3b00t_CVE-2023-20198-IOS-XE-Scanner.md](../2023/CVE-2023-20198-mr-r3b00t_CVE-2023-20198-IOS-XE-Scanner.md)

## CVE-2023-20198-Cisco IOS XE Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的攻击者创建具有特权15权限的本地用户，进而控制设备。

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他一些版本，具体参考漏洞库信息。

**利用条件:** 目标设备启用了Web UI功能，并且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198 漏洞允许未经身份验证的远程攻击者在受影响的 Cisco IOS XE 设备上创建具有特权级别 15 访问权限的帐户。此漏洞是由于 Web UI 功能中存在未受保护的备用通道漏洞 (CWE-420) 造成的。攻击者可以利用此漏洞获得初始访问权限，然后通过 CVE-2023-20273 进一步提升权限至 root 并植入后门。提供的PoC代码 `implant_scanner.ps1` 实际上是一个检测脚本，用于判断目标系统是否已经被植入后门，通过对比Web页面内容的MD5哈希值来判断。脚本本身没有发现明显的投毒代码，config.json中指定了目标URL和已知的哈希值，用于检测是否存在已知的植入体。因此，该仓库中存在作者隐藏的投毒代码的可能性为0%。利用方式是，首先利用CVE-2023-20198创建一个高权限用户，然后利用CVE-2023-20273提升权限并写入植入体（后门）。

**项目地址:** [mr-r3b00t/CVE-2023-20198-IOS-XE-Scanner](https://github.com/mr-r3b00t/CVE-2023-20198-IOS-XE-Scanner)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #21

**来源**: [CVE-2023-20198-netbell_CVE-2023-20198-Fix.md](../2023/CVE-2023-20198-netbell_CVE-2023-20198-Fix.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权远程攻击者创建特权15用户并控制设备

**影响版本:** 受影响版本众多，详见漏洞库信息

**利用条件:** Web UI功能已启用，设备可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性非常高，因为它已被CISA列入已知被利用漏洞目录，并且Cisco官方也已确认存在活跃的利用。漏洞利用方式如下：

1.  **利用CVE-2023-20198获取初始访问权限:** 未经身份验证的攻击者可以利用此漏洞，通过Web UI创建一个具有特权15（最高权限）的本地用户。
2.  **利用CVE-2023-20273提升权限至Root:** 攻击者创建本地用户后，可以利用CVE-2023-20273进一步提升权限至root，并将恶意程序写入文件系统，实现完全控制。

提供的漏洞利用代码（Ansible playbook）实际上是一个缓解措施，旨在禁用Web UI以阻止利用。虽然主要目的是缓解漏洞，但该仓库中存在一定投毒风险。例如:

*   **inventory.yml中的凭据:**  该文件包含默认用户名和密码（admin/admin_password），这可能会被粗心的用户直接用于生产环境，从而使系统暴露于风险之中。
*   **依赖的安全性:**  Ansible playbook的安全性取决于控制机本身的安全。如果控制机被攻破，攻击者可以修改playbook或inventory，从而造成更大范围的损害。

因此，虽然Playbook本身主要是用于缓解漏洞，但配置不当可能导致其他安全问题，存在潜在的投毒风险。务必负责任地存储凭据，使用Ansible Vault或其他安全方法来保护敏感信息。

**项目地址:** [netbell/CVE-2023-20198-Fix](https://github.com/netbell/CVE-2023-20198-Fix)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #22

**来源**: [CVE-2023-20198-ohlawd_CVE-2023-20198.md](../2023/CVE-2023-20198-ohlawd_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，可导致完全控制受影响系统

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他特定版本

**利用条件:** 需要目标设备启用Web UI功能

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。攻击者可以利用此漏洞，在未经身份验证的情况下，通过发送特制请求创建一个具备特权级别15的本地用户，从而获得对设备的完全控制权。由于提供的POC代码仅打印"how bout u exploit d33z nuts"，并没有实际利用漏洞的代码，所以判断其为无效的POC，且具有100%的投毒风险。漏洞利用方式包括：首先利用CVE-2023-20198漏洞获得初始访问权限，然后执行特权15命令以创建本地用户和密码组合。之后，攻击者可能利用CVE-2023-20273漏洞，利用新创建的本地用户将权限提升为root，并将植入程序写入文件系统。

**项目地址:** [ohlawd/CVE-2023-20198](https://github.com/ohlawd/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #23

**来源**: [CVE-2023-20198-raystr-atearedteam_CVE-2023-20198-checker.md](../2023/CVE-2023-20198-raystr-atearedteam_CVE-2023-20198-checker.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI Privilege Escalation

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可能导致完全控制受影响的设备

**影响版本:** 16.1.1 to 17.12.1a 等多个版本 (参考漏洞库信息)

**利用条件:** Web UI功能必须启用，且设备可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-20198 允许未经身份验证的攻击者在受影响的系统上创建一个具有特权级别 15 访问权限的帐户。根据搜索引擎的结果，该漏洞已被积极利用。利用方式是，攻击者首先利用此漏洞获得初始访问权限，然后发出特权 15 命令来创建本地用户和密码组合。然后，攻击者利用另一个漏洞 (CVE-2023-20273) ，利用新创建的本地用户将权限提升为 root 并在文件系统中写入植入程序。 

提供的POC代码尝试通过向 `/webui/logoutconfirm.html` 发送带有 `logon_hash=1` 的POST请求来探测漏洞。如果响应状态码为200，并且响应内容的长度小于32个字符，则可能存在漏洞。POC代码扫描指定的子网，并尝试利用漏洞。 

关于投毒风险，POC代码本身相对简单，主要是网络扫描和HTTP请求。虽然不能完全排除恶意修改的可能性，但代码结构清晰，功能直接，隐藏恶意代码的概率较低。 投毒风险评估较低，大约5%。主要的风险点在于：
1.  **依赖未验证的requests库**：如果requests库本身被投毒，则会影响此脚本。
2.  **成功标志的判断**: 响应内容长度小于32可能是判断依据不足，如果恶意修改，可能导致误报或者漏报，将正常设备标记为存在漏洞，引导使用者进行进一步的恶意操作。

**项目地址:** [raystr-atearedteam/CVE-2023-20198-checker](https://github.com/raystr-atearedteam/CVE-2023-20198-checker)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #24

**来源**: [CVE-2023-20198-reket99_Cisco_CVE-2023-20198.md](../2023/CVE-2023-20198-reket99_Cisco_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，可导致完全控制受影响的Cisco IOS XE设备

**影响版本:** 16.1.1 to 17.12.1 (部分版本)

**利用条件:** Web UI功能已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。攻击者可以利用此漏洞，在未经身份验证的情况下，创建一个具有特权级别15（完全访问所有命令）的本地用户。接下来，攻击者可以利用CVE-2023-20273，通过新创建的本地用户提升权限至root并在文件系统中写入植入物。漏洞利用流程如下：

1.  **CVE-2023-20198 利用:**  未经验证的攻击者通过发送特制的POST请求到`/webui/logoutconfirm.html`，绕过身份验证，创建一个具有管理员权限的新用户。
2.  **CVE-2023-20273 利用:** 使用步骤1中创建的管理员用户，利用另一个Web UI组件中的漏洞，提升权限到root，并写入恶意植入物。

提供的POC代码尝试通过向目标IP地址的`/webui/logoutconfirm.html`发送POST请求来验证漏洞是否存在。如果响应状态码为200，并且响应长度较短（小于32字节），则认为该IP地址易受攻击。然后，脚本会使用curl再次发送请求，如果返回特定的输出长度，则确认漏洞存在。

**关于投毒风险:**

虽然该脚本的主要目的是验证漏洞的存在，但仍然存在一定的投毒风险。风险点在于subprocess.run函数中，使用shell=True来执行curl命令。这使得代码容易受到命令注入攻击，如果攻击者能够控制IP地址或相关参数，则可能执行任意命令。 此外，脚本会将成功利用漏洞的IP地址记录到results.csv 文件中，这虽然不是恶意行为，但可能被恶意行为者利用。投毒风险评估为10%，主要是因为使用了subprocess.run(shell=True)执行外部命令。

**项目地址:** [reket99/Cisco_CVE-2023-20198](https://github.com/reket99/Cisco_CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #25

**来源**: [CVE-2023-20198-sanan2004_CVE-2023-20198.md](../2023/CVE-2023-20198-sanan2004_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响的系统

**影响版本:** 16.1.1 至 17.12.3 以及其他版本

**利用条件:** 目标系统启用了Web UI功能，且位于网络可达范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 存在于 Cisco IOS XE 软件的 Web UI 中。该漏洞允许未经身份验证的攻击者通过不正确的路径验证绕过 Nginx 过滤，访问 `webui_wsma_http` Web 端点，从而可以执行任意 Cisco IOS 命令或进行配置更改，获得 Privilege 15 权限。该漏洞利用涉及两个 XML SOAP 端点：`cisco:wsma-exec` 和 `cisco:wsma-config`。攻击者可以使用 `cisco:wsma-exec` 端点将命令插入到 `execCLI` 元素标记中，例如获取运行配置或执行任意命令。攻击者还可以使用 `cisco:wsma-config` 端点添加具有 Privilege 15 的新用户。随附的 PoC 脚本提供检查漏洞、获取配置、执行命令以及添加/删除用户的功能。PoC 代码的投毒风险较低 (10%)，主要风险在于不熟悉该漏洞的人员可能意外地在生产环境中执行恶意命令，或在测试时使用了存在后门的IOS版本。脚本本身旨在利用漏洞，并且不包含任何明显的恶意或隐藏功能，仓库的README.md声明了此POC的利用方式,降低了隐藏的恶意代码的风险。

**漏洞利用方式：**

1.  **利用 CVE-2023-20198 绕过身份验证：** 攻击者构造特制的 URL 访问易受攻击的 Web UI 端点。
2.  **提升权限：** 成功绕过身份验证后，攻击者可以利用 `cisco:wsma-exec` 或 `cisco:wsma-config` SOAP接口下发命令。
3.  **创建特权用户：** 攻击者创建一个具有 Privilege 15 权限的新用户，从而获得对系统的完全控制。
4.  **执行任意命令：** 攻击者可以使用提权的会话执行任意 Cisco IOS 命令，包括安装后门、修改配置或窃取敏感信息。

**项目地址:** [sanan2004/CVE-2023-20198](https://github.com/sanan2004/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #26

**来源**: [CVE-2023-20198-securityphoenix_cisco-CVE-2023-20198-tester.md](../2023/CVE-2023-20198-securityphoenix_cisco-CVE-2023-20198-tester.md)

## CVE-2023-20198-Cisco IOS XE Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的攻击者创建具有特权15的本地用户，从而完全控制设备

**影响版本:** 受影响的版本包括 16.1.1 到 17.12.1 以及其他版本

**利用条件:** Web UI 功能必须已启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞信息和搜索结果，CVE-2023-20198 允许未经身份验证的攻击者在受影响的 Cisco IOS XE 设备上创建具有 privilege level 15 （最高权限）的本地用户。漏洞利用涉及向 Web UI 发送特制的 HTTP POST 请求，绕过身份验证机制。创建具有最高权限的用户后，攻击者可以使用该账户执行任意命令，并完全控制设备。提供的 `cisco_tester.py` 脚本旨在检测目标设备是否受到 CVE-2023-20198 的影响。它通过向 `/webui/logoutconfirm.html?logon_hash=1` 发送 POST 请求，并检查响应中是否包含特定的字符串 `1a80b7389ccd0a5dab` 来判断设备是否已被入侵。该字符串很可能是一个被利用的设备的特征。

**有效性:**

根据漏洞库信息、搜索结果（特别是 https://www.horizon3.ai/attack-research/attack-blogs/cisco-ios-xe-cve-2023-20198-deep-dive-and-poc/）和漏洞利用代码，该漏洞的利用是有效的，已经有公开可用的PoC。

**投毒风险:**

提供的Python脚本本身主要是一个检测工具，用于检查Cisco设备是否受到CVE-2023-20198的影响，它通过检测特定Hash值判断系统是否已经被植入后门。该脚本逻辑比较简单，主要功能为发送HTTP请求并匹配特定字符串。风险点可能在于脚本对异常的处理不够严谨，如果目标存在其他漏洞，可能被利用，但从代码本身来看，投毒的可能性较低，例如作者没有隐藏恶意的代码执行、数据窃取等行为。可以认为投毒风险极低，可能性约为1%。

**利用方式:**

1.  **未经身份验证的权限提升:**  攻击者利用 CVE-2023-20198 在 Cisco IOS XE 设备上创建一个具有最高权限 (privilege level 15) 的本地用户。
2.  **初始访问:**  利用漏洞绕过 Web UI 的身份验证机制。
3.  **命令执行:**  使用新创建的特权用户账户登录并执行任意命令，实现对设备的完全控制。
4.  **植入后门:** 利用CVE-2023-20273，提升权限至root,写入后门文件。

总而言之，此漏洞允许攻击者完全控制受影响的Cisco设备，风险极高。

**项目地址:** [securityphoenix/cisco-CVE-2023-20198-tester](https://github.com/securityphoenix/cisco-CVE-2023-20198-tester)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #27

**来源**: [CVE-2023-20198-smokeintheshell_CVE-2023-20198.md](../2023/CVE-2023-20198-smokeintheshell_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权用户创建特权用户并执行任意命令

**影响版本:** 受影响版本包括16.1.1到17.12.1等多个版本

**利用条件:** 需要目标设备启用Web UI功能，且攻击者能够网络访问该Web UI。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。该漏洞源于对 Nginx 过滤器的不当路径验证，允许未经身份验证的攻击者绕过身份验证访问 `webui_wsma_http` Web 端点。

**利用方式：**

1.  攻击者利用漏洞绕过身份验证，向 `webui_wsma_http` 端点发送特制的 XML SOAP 请求。
2.  攻击者可以使用 `cisco:wsma-exec` SOAP 端点执行任意 Cisco IOS 命令，或者使用 `cisco:wsma-config` SOAP 端点创建具有 Privilege 15 权限的本地用户。
3.  创建具有 Privilege 15 权限的用户后，攻击者可以使用该用户登录并执行任何操作。
4.  结合CVE-2023-20273，攻击者可以进一步提升权限至root，并写入植入程序。

**有效性：**

根据漏洞描述和提供的漏洞利用代码，该漏洞利用是有效的。漏洞利用代码包含检查漏洞是否存在、获取 Cisco IOS 运行配置、执行任意 Cisco IOS 命令以及添加/删除特权用户的功能。搜索引擎结果也表明该漏洞已被 активно利用。

**投毒风险：**

分析提供的漏洞利用代码（exploit.py），发现以下潜在风险：

*   虽然代码本身看起来直接实现了漏洞利用，但仍然存在作者在代码中加入恶意行为的可能性。
*   例如，可以修改添加用户的函数，在创建高权限用户的同时，静默地执行其他恶意配置更改（如添加后门路由或修改系统日志设置）。
*   代码中使用了多个 SOAP 端点，虽然文档中只提到了 `cisco:wsma-exec` 和 `cisco:wsma-config`，但作者可能利用其他未公开的端点执行恶意操作。
*   因此，需要仔细审查代码的每一行，特别是与网络请求和配置更改相关的部分，以确保没有隐藏的恶意逻辑。
*  根据代码内容，未发现明显的恶意代码，但由于该漏洞可以创建高权限用户，如果攻击者利用该漏洞，完全可以植入后门，存在投毒风险。
*  代码本身风险较低，投毒风险主要体现在被攻击者利用后实施的恶意行为，故将风险调整为10%。

**项目地址:** [smokeintheshell/CVE-2023-20198](https://github.com/smokeintheshell/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #28

**来源**: [CVE-2023-20198-sohaibeb_CVE-2023-20198.md](../2023/CVE-2023-20198-sohaibeb_CVE-2023-20198.md)

# CVE-2023-20198

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-20198-Arshit01_CVE-2023-20198.md](../2023/CVE-2023-20198-Arshit01_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI权限提升漏洞

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响的Cisco设备

**影响版本:** 16.1.1 to 17.12.1及部分17.x版本

**利用条件:** Web UI功能已启用，且目标设备存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。未经身份验证的攻击者可以利用此漏洞创建具有特权级别15（最高权限）的本地用户，从而完全控制受影响的设备。利用过程分为两个阶段：首先利用CVE-2023-20198创建用户，其次利用CVE-2023-20273提升权限至root并写入植入程序。

**漏洞利用方式：**

1.  **身份验证绕过：** 漏洞允许未经身份验证的攻击者与设备的Web UI进行交互。
2.  **创建特权用户：** 攻击者发送特制的SOAP请求到Web UI，该请求绕过身份验证并允许攻击者创建一个具有特权级别15的新用户。
3.  **远程控制：** 创建具有最高权限的用户后，攻击者可以使用此帐户登录设备，并执行任意命令。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的POC代码，可以确认POC代码是有效的。搜索结果中的文章提到了漏洞的成功利用和概念验证代码的存在。POC代码也显示了通过发送特制的XML SOAP请求来创建新用户的机制。

**投毒风险：**

提供的POC代码存在轻微的投毒风险，约为10%。风险点分析如下：

*   **默认用户名和密码：** POC代码使用了默认的用户名（shellsmoke）和密码（pwned）。虽然这方便了漏洞测试，但如果未经修改直接用于攻击，很容易被检测到或被其他人利用。
*   **硬编码的URI：** POC中`exURI = '%2577eb%2575i_%2577sma_Http'`，如果攻击者修改此URI植入恶意代码，可能会导致拒绝服务或者其他恶意行为。
*   **命令执行：** 漏洞本身允许执行任意命令，攻击者可能通过植入恶意命令来感染设备。

需要注意的是，以上只是一些潜在的风险点，具体的投毒行为还需要进一步分析。POC的主要功能是验证漏洞的存在，而非恶意利用。因此，将其判定为具有投毒代码是不准确的。

**项目地址:** [Arshit01/CVE-2023-20198](https://github.com/Arshit01/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #2

**来源**: [CVE-2023-20198-Atea-Redteam_CVE-2023-20198.md](../2023/CVE-2023-20198-Atea-Redteam_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Software Web UI权限提升漏洞

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，未经身份验证的攻击者可以创建具有特权级别15访问权限的帐户，并最终导致完全控制受影响的系统。

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1以及17.11.99SW等众多版本

**利用条件:** Web UI 功能必须启用。需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个关键漏洞。未经身份验证的远程攻击者可以利用此漏洞在受影响的系统上创建具有特权级别 15（完全访问所有命令）的帐户。利用方式是攻击者发送特制的 HTTP 请求到 `/webui/logoutconfirm.html?logon_hash=1` 路径，绕过身份验证，并执行特权命令以创建本地用户和密码组合。创建用户后，攻击者可以利用另一个漏洞（CVE-2023-20273）提升权限至 root 并写入植入程序到文件系统。提供的 Python 脚本 `CVE-2023-20198.py` 旨在检测是否存在该漏洞，并检查已知的 IOC。  该脚本扫描指定子网，并检查目标设备是否返回预期的响应状态码和内容长度。投毒风险评估：脚本本身主要用于检测，但由于脚本包含发送特定请求到目标设备的逻辑，如果攻击者修改此脚本，可能会加入恶意负载或更改用户创建的用户名/密码，存在一定的投毒风险.脚本中存在User-Agent:Atea Red Team CVE-2023-20198 checkscript特征,可能被安全设备检测到。存在的风险点是如果未经授权的人员使用了修改后的脚本，可能会对网络造成损害。 README.md文件没有发现异常。

**项目地址:** [Atea-Redteam/CVE-2023-20198](https://github.com/Atea-Redteam/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #3

**来源**: [CVE-2023-20198-DOMINIC471_qub-network-security-cve-2023-20198.md](../2023/CVE-2023-20198-DOMINIC471_qub-network-security-cve-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权级别15的账户，完全控制受影响的设备。

**影响版本:** 受影响版本众多，包括16.1.1到17.12.1以及其他版本（详见漏洞库信息）。

**利用条件:** Web UI功能必须已启用。设备需要可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞允许未经身份验证的攻击者在Cisco IOS XE设备上创建具有特权级别15（最高权限）的本地用户。攻击者通过利用Web UI中的漏洞绕过身份验证，并执行特权命令创建用户。结合另一个漏洞CVE-2023-20273，攻击者可以进一步提升权限至root并写入植入程序到文件系统。 

**有效性评估：**
根据提供的漏洞库信息和搜索结果，CVE-2023-20198是一个严重漏洞，已被积极利用。

**投毒风险评估：**
查看提供的POC代码，包括README.md和IOC Summary.md文件。 README.md主要描述了如何分析、检测和缓解此漏洞。IOC Summary.md列出了攻击者IP，受害者IP，使用的header以及payload等。这些信息可以辅助蓝队进行防御。
总体来说，该仓库的目的是为了分析和缓解漏洞，并没有发现明显的投毒代码。但是，由于代码中可能包含攻击载荷或恶意命令示例，如果使用者不小心，可能会误用这些代码进行非授权的渗透测试，从而导致法律风险。因此，评估的投毒风险为10%。

**利用方式：**
1.  **未授权访问：** 攻击者利用漏洞，绕过Web UI的身份验证机制。
2.  **创建特权用户：** 攻击者通过发送特制的HTTP请求，执行CLI命令，创建一个具有特权级别15的本地用户。
3.  **持久化（结合CVE-2023-20273）：** 攻击者利用新创建的本地用户登录，并利用另一个漏洞（CVE-2023-20273）提升权限到root，并在文件系统中写入植入程序，实现持久化控制。

**缓解措施：**
*   禁用Web UI功能，如果不需要使用。
*   升级到已修复漏洞的IOS XE软件版本。
*   使用入侵检测/防御系统（IDS/IPS）检测和阻止利用此漏洞的攻击。
*   检查设备上是否存在异常用户和植入程序。

**项目地址:** [DOMINIC471/qub-network-security-cve-2023-20198](https://github.com/DOMINIC471/qub-network-security-cve-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #4

**来源**: [CVE-2023-20198-G4sul1n_Cisco-IOS-XE-CVE-2023-20198.md](../2023/CVE-2023-20198-G4sul1n_Cisco-IOS-XE-CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权15权限的本地用户，结合CVE-2023-20273可提升至root权限并植入后门。

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他相关版本，具体参见漏洞库信息。

**利用条件:** 需要目标系统启用Web UI功能，且网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。根据漏洞信息和搜索结果，该漏洞允许未经身份验证的远程攻击者在受影响的系统上创建一个具有特权级别 15 访问权限的帐户。Cisco的公告指出，攻击者首先利用此漏洞获得初始访问权限，然后执行特权 15 命令以创建本地用户和密码组合。随后，攻击者利用 CVE-2023-20273 将权限提升到 root 并将植入程序写入文件系统。根据提供的漏洞利用代码，该 PoC 包含以下功能：

*   **漏洞检查**：通过执行 `uname -a` 命令来验证漏洞是否存在。
*   **获取 Cisco 配置**：执行 `sh run` 命令来提取运行配置。
*   **执行命令**：允许执行任意 Cisco IOS 命令，但警告需要谨慎使用，因为没有输入验证。
*   **添加用户**：创建一个新的特权 15 用户帐户，可以选择指定用户名和密码。
*   **删除用户**：从设备中删除用户帐户。

**有效性：**

该 PoC 代码的有效性较高，因为漏洞库信息和搜索结果都表明该漏洞已被 активно используется。此外，该 PoC 提供了多种利用方式，包括漏洞检查、信息收集和权限提升。

**投毒风险：**

尽管 PoC 代码主要用于利用已知的漏洞，但仍存在一定的投毒风险，估计为10%。风险点包括：

*   **命令执行**：通过 `-e` 选项执行任意命令，攻击者可能利用此功能执行恶意操作。
*   **用户管理**：虽然提供了添加和删除用户的选项，但如果被滥用，可能导致拒绝服务或系统损坏。

虽然PoC代码本身看起来是为了复现漏洞，但不能完全排除代码作者在其中隐藏恶意功能的可能性，例如植入后门、收集敏感信息等。因此，在使用 PoC 代码时，需要进行仔细审查和安全评估。

**利用方式：**

1.  **未经身份验证的访问**：利用 CVE-2023-20198 绕过身份验证，访问 `webui_wsma_http` Web 端点。
2.  **创建特权用户**：使用 `cisco:wsma-config` SOAP 端点创建一个具有特权 15 的新用户帐户。
3.  **执行任意命令**：使用 `cisco:wsma-exec` SOAP 端点执行任意 Cisco IOS 命令。
4.  **权限提升 (结合 CVE-2023-20273)**：利用新创建的特权用户，结合 CVE-2023-20273 将权限提升到 root，并在系统上植入后门。

总而言之，CVE-2023-20198 是一个严重的安全漏洞，需要立即采取措施进行修复。在使用 PoC 代码时，需要谨慎评估风险，并确保在受控环境中进行测试。

**项目地址:** [G4sul1n/Cisco-IOS-XE-CVE-2023-20198](https://github.com/G4sul1n/Cisco-IOS-XE-CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #5

**来源**: [CVE-2023-20198-IceBreakerCode_CVE-2023-20198.md](../2023/CVE-2023-20198-IceBreakerCode_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权级别 15 的帐户，从而完全控制设备

**影响版本:** 16.1.1 to 17.12.1 and earlier versions

**利用条件:** Web UI 功能已启用并且设备易受攻击版本的影响。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个漏洞，允许未经身份验证的远程攻击者在受影响的系统上创建具有特权级别 15 访问权限的帐户。 

**漏洞利用方式：**

1.  攻击者发送一个特制的 HTTP POST 请求到 `/webui/logoutconfirm.html?logon_hash=1` 端点，绕过身份验证。
2.  成功利用此漏洞后，攻击者可以执行任意命令，包括创建具有特权级别 15 的本地用户。
3.  然后，攻击者使用另一个漏洞（CVE-2023-20273）并通过新创建的本地用户权限提升到 root 权限，并将植入程序写入文件系统。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判定该漏洞的POC代码是有效的。漏洞库信息明确指出存在正在进行的漏洞利用活动。搜索结果也提供了多个关于该漏洞的深度分析和POC示例的链接，例如horizon3.ai上的POC代码。
提供的python脚本模拟了发送特制HTTP请求的过程，旨在检测目标系统是否存在漏洞。脚本会检查HTTP响应状态码和响应体内容，以判断是否存在潜在的植入程序。

**投毒风险：**

评估POC代码的投毒风险，需要仔细分析代码是否存在恶意行为，例如：
1.  **植入后门：**  代码是否在目标系统上安装未经授权的后门。
2.  **数据窃取：**  代码是否窃取敏感信息并发送到外部服务器。
3.  **拒绝服务：**  代码是否导致目标系统崩溃或无法正常运行。
4.  **恶意传播：**  代码是否试图感染其他系统。

分析提供的python脚本，该脚本主要用于检测漏洞是否存在，并未发现明显的恶意行为。脚本的功能是发送特定的HTTP请求并检查响应，以确定目标系统是否受到CVE-2023-20198漏洞的影响。然而，使用任何未经授权的漏洞利用代码都存在风险，因为代码的作者可能隐藏了不易察觉的恶意功能。因此，在使用任何POC代码之前，务必进行彻底的安全审查。

考虑到以上因素，判定该POC代码存在10%的投毒风险，主要是由于作者可能隐藏了一些不易察觉的恶意代码，但主要功能是漏洞验证。

**缓解措施：**

*   禁用 Web UI 功能，特别是当设备面向互联网时。
*   将 Web UI 访问限制为受信任的网络。
*   升级到已修复漏洞的 Cisco IOS XE 软件版本。

**项目地址:** [IceBreakerCode/CVE-2023-20198](https://github.com/IceBreakerCode/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #6

**来源**: [CVE-2023-20198-JoyGhoshs_CVE-2023-20198.md](../2023/CVE-2023-20198-JoyGhoshs_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可导致完全控制受影响设备

**影响版本:** 受影响版本范围广泛，详见漏洞库信息

**利用条件:** Web UI功能已启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198 允许未经身份验证的攻击者在受影响的系统上创建具有权限级别15（完全访问权限）的帐户。该漏洞利用方式如下：

1.  **初始访问:** 攻击者利用CVE-2023-20198漏洞，通过Web UI创建具有高权限的本地用户。
2.  **权限提升:** 然后，攻击者可能利用CVE-2023-20273（另一个漏洞）或使用新创建的本地用户进一步将权限提升至root。
3.  **植入后门:** 攻击者利用获得的root权限，在文件系统中写入恶意植入。

提供的POC代码`poc.py`是一个**检测工具**，而非完整的漏洞利用代码。它通过发送一个特定的HTTP请求到`/webui/logoutconfirm.html?logon_hash=1`，并检查响应内容是否为十六进制字符串来判断目标是否可能受到了攻击并植入了后门。如果响应是十六进制字符串，则表明设备可能已遭入侵，并存在植入的后门（该后门会返回hex信息）。

该存储库中的`README.md`文件说明，此脚本并非完整的POC，仅用于检查是否存在hex响应。因此，它无法直接用于漏洞利用，而只能用于检测。

**投毒风险分析：**

查看`poc.py`文件内容，发现其功能主要是发送HTTP请求并判断响应内容。该代码的功能比较简单，未发现任何可能导致恶意行为（例如，上传恶意文件、执行任意命令等）的可疑代码。因此，可以认为该存储库不存在作者隐藏的投毒代码。



**项目地址:** [JoyGhoshs/CVE-2023-20198](https://github.com/JoyGhoshs/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #7

**来源**: [CVE-2023-20198-Pushkarup_CVE-2023-20198.md](../2023/CVE-2023-20198-Pushkarup_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的远程攻击者创建管理员账户并完全控制设备

**影响版本:** 受影响版本详见CVE描述

**利用条件:** 目标设备启用了Web UI功能，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞存在于 Cisco IOS XE 软件的 Web UI 中。未经身份验证的远程攻击者可以通过利用此漏洞在受影响的系统上创建具有特权级别 15 访问权限的帐户。创建账户后，攻击者可以使用该账户完全控制受损的机器。

**有效性：**
提供的 POC 代码根据描述能够创建本地用户，安装植入体，重启Web服务，并检查植入体的状态，因此具备有效性。

**投毒风险：**
此仓库中可能存在作者隐藏的投毒代码。尽管自述文件声明 PoC 仅用于教育目的，并且使用需要遵守道德规范，但攻击者可以修改 `config_content` 以包含恶意配置，例如更改防火墙规则或执行其他恶意操作。此外，虽然代码本身没有明显的恶意行为，但其目的是在目标系统上创建具有管理权限的用户，这本身就可以被认为是恶意的。因此，存在一定的投毒风险，但是相对较低，风险评估在10%。此风险评估基于以下因素：
    *   代码可能被用于未授权的系统访问。
    *   配置文件可被修改为包含恶意指令。

**利用方式：**
1.  攻击者利用 CVE-2023-20198 漏洞，通过未授权访问在 Cisco IOS XE 设备上创建一个具有特权级别 15 的本地用户。
2.  攻击者使用新创建的管理员账户登录到设备。
3.  攻击者利用 CVE-2023-20273 漏洞，进一步提升权限至 root 级别，并将恶意植入程序写入文件系统。
4.  攻击者通过植入的后门程序远程控制设备，执行恶意操作，例如数据窃取、网络攻击等。
根据搜索结果，CISA 已将此漏洞添加到已知被利用的漏洞目录中，表明该漏洞已经被广泛利用。

**项目地址:** [Pushkarup/CVE-2023-20198](https://github.com/Pushkarup/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #8

**来源**: [CVE-2023-20198-RevoltSecurities_CVE-2023-20198.md](../2023/CVE-2023-20198-RevoltSecurities_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，可被未授权的攻击者利用创建特权用户，进而完全控制系统。

**影响版本:** 受影响的版本包括16.1.1到17.12.1以及其他一系列17.x版本 (详见漏洞库信息)

**利用条件:** 目标设备启用Web UI功能，并且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。根据漏洞库信息和搜索引擎结果，未经身份验证的攻击者可以利用此漏洞在受影响的系统上创建一个具有 15 级权限（最高权限）的帐户。随后攻击者再利用CVE-2023-20273，将权限提升至root，并写入植入体。该漏洞的利用方式如下：

1.  **漏洞触发：** 攻击者发送特制的HTTP请求到Cisco IOS XE设备的Web UI接口，绕过身份验证。
2.  **创建特权用户：** 请求中包含特定的XML内容，该内容允许攻击者创建一个新的本地用户，并分配最高权限（privilege level 15）。
3.  **权限提升：** 攻击者利用创建的特权用户登录系统。
4.  **植入后门：** 攻击者通过Web UI的另一个组件（CVE-2023-20273）将权限提升至root并写入植入体。

**有效性：** 根据搜索引擎结果（特别是horizon3.ai的POC）以及提供的漏洞利用代码，此漏洞利用是有效的。漏洞利用代码仓库提供了一个Python脚本，可以检测和利用此漏洞。

**投毒风险：** 漏洞利用代码仓库的投毒风险评估为10%。虽然该仓库提供了看似合理的漏洞利用脚本，但存在以下潜在风险点：

*   **自定义配置内容：** 脚本允许用户提供自定义的配置内容（`-cfc` 或 `--config-content` 参数），这可能被滥用以注入恶意代码或配置。
*   **隐蔽后门：** 虽然主要功能是利用漏洞，但作者可能在代码中添加了不易察觉的后门，例如收集目标信息、执行任意命令等。代码量较少，通读代码可以降低风险。

**防范措施：**

*   立即更新Cisco IOS XE软件到已修复的版本。
*   禁用Web UI功能，如果不需要。
*   监控网络流量，检测异常的Web UI请求。
*   使用Cisco提供的软件检查工具来识别和移除潜在的植入体。

**项目地址:** [RevoltSecurities/CVE-2023-20198](https://github.com/RevoltSecurities/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #9

**来源**: [CVE-2023-20198-Shadow0ps_CVE-2023-20198-Scanner.md](../2023/CVE-2023-20198-Shadow0ps_CVE-2023-20198-Scanner.md)

## CVE-2023-20198 Cisco IOS XE Web UI 权限提升漏洞

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权 15 权限的本地用户，从而完全控制受影响的设备。

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1 以及 17.11.99SW

**利用条件:** Web UI 功能必须已启用。攻击者需要能够通过网络访问设备的 Web UI。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。未经身份验证的远程攻击者可以利用此漏洞在受影响的系统上创建一个具有特权 15 访问权限的帐户，本质上是管理员权限。漏洞利用通常与另一个漏洞 CVE-2023-20273 结合使用，后者用于将权限提升到 root 并将植入程序写入文件系统。

**漏洞利用有效性：**

根据漏洞库信息、搜索引擎结果（特别是 horizon3.ai 的 PoC 描述）以及提供的漏洞利用代码片段来看，该漏洞的利用是有效的。存在公开可用的 PoC，允许攻击者绕过身份验证创建具有管理权限的用户。

**投毒风险分析：**

提供的代码片段分析表明，攻击流程依赖于 Nginx 配置和一个 Lua 脚本。Lua 脚本的核心功能在于身份验证绕过和命令执行。脚本通过检查是否存在特定的 "Authorization" Header以及Header的内容是否和通过REDACTED命令执行结果匹配来确定请求是否被授权。

由于 "REDACTED" 信息的缺失，我们无法完全确定是否存在恶意投毒代码。但是lua脚本的下列行为存在潜在的投毒风险：

1.  **外部命令执行:** 脚本多次使用 `io.popen()` 执行外部命令。如果这些命令包含恶意参数或旨在下载和执行其他代码，则可能导致系统受损。
2.  **硬编码的凭据和逻辑：**脚本逻辑依赖于特定的哈希值和其他硬编码的字符串。攻击者可能会修改这些字符串以创建变体，从而绕过安全检测或植入后门。
3.  **对/lua5的请求:** 当common_type=iox时,会调用/lua5,如果/lua5是作者控制的地址,则存在投毒风险。

基于以上分析，虽然无法确定明确的投毒代码，但脚本中使用的技术（尤其是外部命令执行）增加了被用于恶意目的的可能性，估计投毒风险为20%。

**漏洞利用方式：**

1.  **未授权访问:** 攻击者发送一个特制的 HTTP POST 请求到 `/webui/logoutconfirm.html`，绕过身份验证检查（利用 CVE-2023-20198）。这可能涉及到提供特定的 `Authorization` header，该header的值能够通过预设的验证。
2.  **创建高权限用户:** 绕过身份验证后，攻击者可以发送包含创建新用户（具有特权级别 15）的命令的请求体。该命令通过 `io.popen()` 执行，从而创建一个具有管理员权限的本地用户。
3.  **权限提升和植入：** (结合 CVE-2023-20273) 使用新创建的本地用户登录并利用 CVE-2023-20273 将权限提升至 root，从而能够在设备上安装植入程序。


**项目地址:** [Shadow0ps/CVE-2023-20198-Scanner](https://github.com/Shadow0ps/CVE-2023-20198-Scanner)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #10

**来源**: [CVE-2023-20198-Tounsi007_CVE-2023-20198.md](../2023/CVE-2023-20198-Tounsi007_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可能导致完全控制受影响设备

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他版本

**利用条件:** 目标设备启用了Web UI功能并且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞存在于Cisco IOS XE Software的Web UI中，允许未经身份验证的远程攻击者创建一个具有特权级别15（完全访问权限）的本地用户帐户。该漏洞利用方式是通过发送特制的HTTP请求到`/webui/create_user`路径来创建用户。攻击者随后可利用创建的用户并通过另一个漏洞CVE-2023-20273提升权限至root并写入植入程序。提供的POC代码尝试模拟此过程，包括创建用户、安装植入程序、重启Web服务器、检查植入程序状态以及清理创建的用户。 

**有效性：**根据漏洞信息、搜索结果和提供的POC代码，该漏洞是有效的。搜索引擎结果表明该漏洞已被积极利用，并且存在公开可用的POC代码。CISA的已知被利用漏洞目录也收录了该漏洞。

**投毒风险：**POC代码本身存在一定的风险。虽然代码的主要功能是利用漏洞，但`config_content`变量表明存在植入恶意配置的可能性。 用户需要手动插入植入配置,存在被植入后门的风险。
该仓库readme描述，POC仅用于测试和学习，有免责声明。存在一定概率作者未充分测试。

**利用方式：**
1.  **初始访问：** 未经身份验证的攻击者发送特制HTTP请求到存在漏洞的Cisco IOS XE设备的Web UI接口。
2.  **用户创建：**  利用CVE-2023-20198，攻击者通过`/webui/create_user`接口创建一个具有管理员权限的新用户。
3.  **权限提升（CVE-2023-20273）：** 利用新创建的用户，攻击者可以进一步利用Web UI中的另一个漏洞（CVE-2023-20273）来提升权限至root。
4.  **植入后门：** 攻击者可以写入植入程序到文件系统。
5.  **持久化：** 植入程序可以用于维持对受感染设备的访问。
6.  **清理（可选）：** 攻击者可以选择删除他们创建的后门账户，以隐藏其踪迹。

**项目地址:** [Tounsi007/CVE-2023-20198](https://github.com/Tounsi007/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #11

**来源**: [CVE-2023-20198-Vulnmachines_Cisco_CVE-2023-20198.md](../2023/CVE-2023-20198-Vulnmachines_Cisco_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可使未授权的攻击者获得完全管理权限

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1 以及其他多个版本

**利用条件:** Web UI 功能启用并且 HTTP 或 HTTPS 服务器功能开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个关键身份验证绕过漏洞。根据漏洞信息和搜索结果，攻击者利用此漏洞首先获得初始访问权限，然后执行特权 15 命令来创建一个本地用户和密码组合，从而获得管理员权限。之后，攻击者利用 CVE-2023-20273 将权限提升到 root 并在文件系统中写入植入程序。提供的 POC 代码显示了一个用于利用漏洞的 HTTP POST 请求示例。请求的目标 URI 经过编码处理，绕过了身份验证。请求体包含一个 SOAP 信封，该信封尝试使用默认的 "admin" 用户名执行命令 "uname -a"。有效性：根据搜索结果和漏洞描述，提供的 POST 请求通过身份验证绕过在受影响的设备上创建具有特权 15 的用户，因此 POC 代码有效。 投毒风险：README.md 文件描述了漏洞，并提供了一个关于利用该漏洞的概述。Payload 文件包含一个 SOAP 请求，用于发送 CLI 命令。虽然该请求本身看起来无害（执行 `uname -a` 命令），但攻击者可能会修改该请求以执行恶意命令。例如，更改命令以创建具有特权 15 的用户。 因此，存在一定风险，即此仓库可能被用于传播恶意利用程序。Payload 代码文件本身没有明显的投毒代码，但存在被修改利用的风险，因此判定投毒风险为 10%。利用方式：1. 检查目标 Cisco IOS XE 设备是否启用了 Web UI 功能和 HTTP/HTTPS 服务器。2. 发送构造的 HTTP POST 请求到目标设备，利用身份验证绕过漏洞。3. 请求的目标 URI 经过编码处理以绕过身份验证检查。4. POST 请求的内容为 SOAP 信封，其中包含要执行的 CLI 命令。5. 成功利用后，攻击者可以在设备上执行任意 CLI 命令，例如创建新的管理员帐户或植入恶意软件。

**项目地址:** [Vulnmachines/Cisco_CVE-2023-20198](https://github.com/Vulnmachines/Cisco_CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #12

**来源**: [CVE-2023-20198-W01fh4cker_CVE-2023-20198-RCE.md](../2023/CVE-2023-20198-W01fh4cker_CVE-2023-20198-RCE.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权15的用户，进而完全控制受影响的设备。

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1 等多个版本

**利用条件:** Web UI 功能已启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。未经身份验证的远程攻击者可以利用此漏洞在受影响的系统上创建一个具有特权 15 访问权限的帐户，从而完全控制设备。利用方式如下：

1.  **漏洞触发点：** Cisco IOS XE 软件的 Web UI 组件存在漏洞。
2.  **利用过程：** 攻击者通过发送特制的 SOAP 请求到 `/%%77ebui_wsma_https` 或 `/%%77ebui_wsma_Http` URI (具体取决于是否使用 HTTPS) 绕过身份验证。
3.  **命令执行：** 攻击者使用 `urn:cisco:wsma-config` 命名空间执行 CLI 命令，创建新的具有特权 15 的用户。
4.  **后续利用 (CVE-2023-20273):** 在获得初始访问权限后，攻击者可以利用 CVE-2023-20273 将权限提升为 root 并在文件系统中写入植入程序。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞已被积极利用，提供的 PoC 代码有效，可以用于创建具有特权 15 的用户。

**投毒风险：**

PoC 代码主要功能是利用漏洞，创建新用户，从代码本身来看，存在一些潜在的投毒点，例如：

*   **随机用户名/密码生成：**  虽然代码中包含随机用户名生成函数，但实际使用中，攻击者可能会替换为预设的用户名和密码，方便后续控制。
*   **代理服务器使用：**  PoC 代码支持使用代理服务器，攻击者可以借此隐藏真实 IP 地址，增加溯源难度。
*   **异常处理：**  代码中包含异常处理模块，可能用于隐藏利用过程中的错误信息，避免被发现。
*   **User-Agent:** 使用了常见的User-Agent，但是依然存在替换或者增加其他User-Agent进行恶意攻击.

总体来说，PoC 代码的投毒风险较低，主要集中在以上几点，但需要使用者谨慎使用。

**总结：**

该漏洞利用的有效性很高，并且在野外被广泛利用。PoC 代码可以用来验证漏洞的存在并创建管理员用户，但需要注意潜在的投毒风险。利用方式是发送特制的 SOAP 请求，绕过身份验证，然后执行 CLI 命令。

**项目地址:** [W01fh4cker/CVE-2023-20198-RCE](https://github.com/W01fh4cker/CVE-2023-20198-RCE)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #13

**来源**: [CVE-2023-20198-XiaomingX_cve-2023-20198-poc.md](../2023/CVE-2023-20198-XiaomingX_cve-2023-20198-poc.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响设备

**影响版本:** 受影响版本范围广泛，详见漏洞库信息

**利用条件:** Web UI 功能启用且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 存在于 Cisco IOS XE 软件的 Web UI 中。未经身份验证的攻击者可以利用此漏洞创建具有 privilege level 15 权限的本地用户，从而获得对设备的完全控制权。利用方式主要通过发送特制的 SOAP 请求到目标设备的 Web UI 接口，绕过身份验证，执行 CLI 命令。PoC 代码通过构造恶意的 SOAP 消息，例如 `username <username> privilege 15 secret <password>`，添加高权限用户。 

有效性分析：根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开的 PoC。提供的 PoC 代码实现了漏洞利用的基本功能，包括检查漏洞、获取配置、执行命令和添加/删除用户。因此，提供的 PoC 代码是有效的。

投毒风险分析：代码本身主要实现了漏洞利用功能，但仍然存在一定的投毒风险。体现在以下几个方面：

*   **恶意命令执行：** 虽然代码本身没有硬编码的恶意命令，但 `-e` 参数允许攻击者执行任意 Cisco IOS 命令。攻击者可能会使用此参数注入恶意配置或植入后门。
*   **硬编码凭据：** 默认用户名 `shellsmoke` 和密码 `pwned` 如果不修改，可能被其他攻击者利用。虽然这是一个PoC，但在实际使用中容易被忽视，从而导致设备被二次入侵。
*   **异常处理：** 某些异常处理不够完善，可能导致程序崩溃或泄露敏感信息。
*   **Payload内容:** 在SOAP请求模板中，攻击者可能修改命令或者在ADD_USER的情况下，添加后门账户。

综合考虑，该 PoC 存在一定的投毒风险，但主要集中在用户使用不当或被恶意利用的可能性上，PoC本身是漏洞的利用，投毒代码的可能性评判为 10%。建议使用者在使用 PoC 时仔细审查代码，并采取必要的安全措施。

利用方式总结：

1.  **目标确认：** 确定目标 Cisco IOS XE 设备是否启用了 Web UI 功能。
2.  **发送恶意 SOAP 请求：** 构造包含 CLI 命令的恶意 SOAP 请求，绕过身份验证。
3.  **权限提升：** 利用漏洞创建具有 privilege level 15 权限的本地用户。
4.  **完全控制：** 使用新创建的用户登录并完全控制设备。

**项目地址:** [XiaomingX/cve-2023-20198-poc](https://github.com/XiaomingX/cve-2023-20198-poc)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #14

**来源**: [CVE-2023-20198-ZephrFish_CVE-2023-20198-Checker.md](../2023/CVE-2023-20198-ZephrFish_CVE-2023-20198-Checker.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权15权限的本地用户，随后可能被用于植入后门和完全控制设备

**影响版本:** 受影响版本：16.1.1 到 17.12.1，以及其他相关版本（详见漏洞库信息）

**利用条件:** 目标设备启用了Web UI功能，且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞允许未经身份验证的攻击者在受影响的 Cisco IOS XE 设备上创建一个具有特权 15 权限（最高权限）的本地用户。该漏洞存在于 Web UI 功能中。根据搜索引擎结果和漏洞库信息，此漏洞已被积极利用。提供的漏洞利用代码 `XEImplantScanner.py` 主要用于扫描目标系统是否存在漏洞以及是否被植入后门。该脚本通过发送特定的 HTTP 请求到 `/webui/logoutconfirm.html` 端点来检测漏洞和后门的存在。

**利用方式：**

1.  **初始访问：** 未经身份验证的攻击者发送特制的 HTTP 请求到目标设备的 Web UI。
2.  **权限提升：** 利用 CVE-2023-20198，创建一个具有特权 15 权限的本地用户。
3.  **后门植入（CVE-2023-20273）：** 使用新创建的具有特权的用户，攻击者可以进一步利用另一个漏洞（CVE-2023-20273）来提升权限至 root，并将植入体写入文件系统，实现持久化控制。

**有效性：**

根据搜索引擎结果（例如，horizon3.ai 的文章）和漏洞库信息，CVE-2023-20198 漏洞已被成功利用。提供的 POC 代码 `XEImplantScanner.py` 旨在检测漏洞的存在以及后门的植入，本身不包含直接利用漏洞进行权限提升的代码，需要结合 CVE-2023-20273 来完全控制。

**投毒风险：**

POC 代码 `XEImplantScanner.py` 主要功能是扫描，相对安全。可能的投毒风险在于：

*   **结果误导：** 扫描结果可能被篡改，导致用户误判系统的安全状态。
*   **依赖风险：** 脚本依赖于 `requests` 库，如果 `requests` 库被恶意版本替换，可能导致代码执行。
*   **网络钓鱼:** 脚本可能被用于钓鱼，诱导用户扫描恶意服务器，泄露信息。

因此，评估的投毒风险为 10%。主要是考虑到其扫描器性质，以及依赖库被投毒的可能性。

**项目地址:** [ZephrFish/CVE-2023-20198-Checker](https://github.com/ZephrFish/CVE-2023-20198-Checker)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #15

**来源**: [CVE-2023-20198-alekos3_CVE_2023_20198_Detector.md](../2023/CVE-2023-20198-alekos3_CVE_2023_20198_Detector.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响系统

**影响版本:** 见受影响版本列表

**利用条件:** Web UI 功能已启用,网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。攻击者可以利用此漏洞绕过身份验证，创建一个具有 15 级权限的本地用户，从而完全控制受影响的系统。该漏洞结合 CVE-2023-20273 使用，CVE-2023-20198 用于初始访问，CVE-2023-20273 用于提权至 root 并写入植入程序到文件系统。

**利用方式：**

1.  未经身份验证的攻击者发送特制的HTTP请求到启用了Web UI的Cisco IOS XE设备。
2.  利用CVE-2023-20198漏洞，创建一个具有特权级别15的本地用户。
3.  使用新创建的本地用户利用CVE-2023-20273漏洞，将权限提升到root。
4.  将植入程序写入文件系统，从而完全控制设备。

**POC代码分析：**

提供的Python脚本 (`CVE_2023_20198_detector.py`) 主要用于检测设备是否存在漏洞，而不是利用该漏洞。它通过SSH连接到设备，并运行一些命令来检查Web UI是否启用，并尝试检测是否存在攻击迹象，例如存在`ip http server`, `ip http secure-server`,  `ip http active`配置。脚本通过`netmiko`库实现SSH连接和命令执行。该脚本没有直接创建特权用户的恶意代码，只是用于检测是否存在漏洞。该脚本会生成一个csv文件`Results_CVE_2023_20198_{current_timestamp}.csv` 用于记录检测结果。

**有效性：**

根据搜索引擎结果，存在公开的POC代码，可以创建特权用户。`CVE_2023_20198_detector.py`脚本本身并不能直接利用漏洞，它只能用来检测目标是否存在漏洞。

**投毒风险：**

该脚本的投毒风险极低 (0%)。虽然用户需要输入用户名和密码，但是该脚本只是用来检测是否存在漏洞，没有发现任何可疑的代码或后门，也没有修改系统配置的任何行为。LICENSE文件为标准的MIT License。

**项目地址:** [alekos3/CVE_2023_20198_Detector](https://github.com/alekos3/CVE_2023_20198_Detector)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #16

**来源**: [CVE-2023-20198-emomeni_Simple-Ansible-for-CVE-2023-20198.md](../2023/CVE-2023-20198-emomeni_Simple-Ansible-for-CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可导致完全控制受影响的设备

**影响版本:** 16.1.1 to 17.12.1

**利用条件:** Web UI 功能已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。根据漏洞库信息和搜索引擎结果，未经身份验证的攻击者可以利用此漏洞创建一个具有 15 级权限（完全访问所有命令）的本地用户。攻击者首先利用 CVE-2023-20198 获得初始访问权限，然后执行权限 15 命令来创建本地用户和密码组合，允许该用户以普通用户身份登录。 然后攻击者利用 web UI 功能的另一个组件，利用新的本地用户将权限提升到 root 并将植入程序写入文件系统，cve-2023-20273。

**有效性：**
根据搜索引擎结果（例如Horizon3.ai的博客），已经存在公开可用的PoC，并且漏洞被积极利用。提供的Ansible剧本并不是直接的漏洞利用代码，而是用于检测并禁用HTTP/HTTPS服务器以缓解漏洞。它也能检测是否已经遭受攻击，通过分析syslog。

**投毒风险：**
提供的Ansible剧本的主要目的是缓解漏洞，而不是利用漏洞。虽然其中包含连接到Cisco设备的凭据（developer/lastorangerestoreball8876），但这些是 Cisco Always On Sandbox 的公开凭据，用于测试目的。 投毒风险较低，但仍然存在一些风险：

1.  **凭据滥用：**  即使凭据是公开的，也可能有人修改剧本以使用不同的凭据尝试访问其他Cisco设备。
2.  **远程执行：**  Ansible 剧本在目标设备上执行命令。如果剧本被恶意修改，可能会导致设备配置更改或执行其他恶意操作。 鉴于此，大约有10%的可能性存在投毒风险。

**利用方式：**
1.  **初始访问：**  攻击者利用 CVE-2023-20198 中的漏洞，绕过身份验证。
2.  **创建高权限用户：**  攻击者利用未授权访问，创建一个具有 15 级权限的本地用户。
3.  **权限提升(CVE-2023-20273):** 攻击者利用本地用户权限和Web UI的另一个漏洞，将权限提升到 root。
4.  **植入后门：**  攻击者利用 root 权限，在设备上植入后门，以便长期控制。

**项目地址:** [emomeni/Simple-Ansible-for-CVE-2023-20198](https://github.com/emomeni/Simple-Ansible-for-CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #17

**来源**: [CVE-2023-20198-fox-it_cisco-ios-xe-implant-detection.md](../2023/CVE-2023-20198-fox-it_cisco-ios-xe-implant-detection.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未经身份验证的攻击者创建具有特权15的本地用户，最终导致完全控制受影响的设备

**影响版本:** 受影响版本包括16.1.1至17.12.1 以及其他相关版本

**利用条件:** Web UI功能已启用，设备可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198是Cisco IOS XE Software Web UI中的一个权限提升漏洞。攻击者可以利用此漏洞，在未经身份验证的情况下，通过发送特制的HTTP请求绕过身份验证，并在受影响的系统上创建一个具有最高权限（特权级别15）的本地用户。创建具有特权15的用户后，攻击者可以使用该用户登录设备，执行任意命令，并完全控制受影响的Cisco IOS XE设备。攻击者利用CVE-2023-20198获得初始访问权限后，会进一步利用CVE-2023-20273将权限提升到root级别，并在文件系统中写入恶意植入程序。

**利用方式：**

1.  **未经身份验证的访问：** 攻击者通过发送特制的HTTP请求，绕过Cisco IOS XE Web UI的身份验证机制。
2.  **创建特权用户：** 成功绕过身份验证后，攻击者可以执行特权命令，创建一个具有最高权限（特权级别15）的本地用户。
3.  **权限提升：** 使用新创建的具有特权15的用户登录设备。
4.  **植入后门:** 利用CVE-2023-20273，将权限提升到root级别，并在文件系统中写入恶意植入程序。

**关于投毒风险：**

提供的漏洞利用代码仅仅是Apache License 2.0协议，这是一个开源协议，本身不包含任何恶意代码。根据现有信息，没有迹象表明该漏洞利用代码中存在任何隐藏的恶意或投毒代码。

**项目地址:** [fox-it/cisco-ios-xe-implant-detection](https://github.com/fox-it/cisco-ios-xe-implant-detection)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #18

**来源**: [CVE-2023-20198-iveresk_cve-2023-20198.md](../2023/CVE-2023-20198-iveresk_cve-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响的Cisco IOS XE设备

**影响版本:** 受影响版本众多，详见漏洞库信息

**利用条件:** Web UI功能已启用，且设备未打补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-20198是一个Cisco IOS XE Software Web UI中存在的权限提升漏洞。根据漏洞库信息和搜索引擎结果，未经身份验证的攻击者可以通过该漏洞创建具有特权15级别（完全访问权限）的本地用户帐户。攻击者首先利用此漏洞获得初始访问权限，然后结合CVE-2023-20273漏洞，利用新创建的本地用户帐户将权限提升至root级别，并在文件系统中写入植入程序。漏洞利用代码 `cve-2023-20198.py` 提供了 `check` 和 `exploit` 两种模式。`check` 模式用于检测目标是否存在漏洞，`exploit` 模式用于创建本地用户帐户。漏洞利用过程包括向 `/webui/logoutconfirm.html` 发送POST请求进行检测，以及向 `/webui/create_user` 发送POST请求创建用户。投毒风险较低，因为代码主要利用已知的漏洞利用方法，但仍存在被修改以执行恶意操作的可能性，例如在创建用户后立即执行其他命令或植入后门程序。主要风险集中在config_content中，可能会存在其他的攻击代码。

**项目地址:** [iveresk/cve-2023-20198](https://github.com/iveresk/cve-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #19

**来源**: [CVE-2023-20198-kacem-expereo_CVE-2023-20198.md](../2023/CVE-2023-20198-kacem-expereo_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可被未授权的攻击者利用创建具有特权 15 的本地用户，为进一步攻击（如植入后门）铺平道路。

**影响版本:** 16.1.1 to 17.12.1 and potentially other versions as indicated in the CVE description.

**利用条件:** 目标设备启用了 Web UI 功能，且位于攻击者可访问的网络中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。未经身份验证的远程攻击者可以通过向目标设备发送特制的 HTTP 请求来利用此漏洞。该漏洞允许攻击者在受影响的系统上创建一个具有特权级别 15 访问权限的帐户。此漏洞是攻击链的第一步，攻击者利用它来创建具有管理权限的本地用户，然后利用 CVE-2023-20273 进一步提升权限至 root，并在文件系统中写入植入程序。提供的 POC 代码 `main.py` 的作用是检测目标 IP 是否容易受到 CVE-2023-20198 的攻击。它通过发送特定的 GET 和 POST 请求来检查目标设备是否返回预期的响应。如果目标返回指示存在漏洞的响应，脚本将输出 'Vulnerable'，否则输出 'Not Vulnerable'。代码通过发送构造的 HTTP GET 请求来尝试绕过身份验证，并检查是否出现预期的“404 Not Found”响应。同时,代码还发送带有硬编码 Authorization 头的 POST 请求，以进一步确认漏洞的存在。尽管代码本身用于检测漏洞，但潜在的投毒风险在于硬编码的 Authorization 头部，以及对 HTTPS 请求的证书验证的禁用（`verify=False`），这可能被恶意修改以进行中间人攻击或者将流量重定向到恶意服务器，虽然这种可能性不大，只有10%。

**利用方式：**

1.  **未经身份验证的访问：** 攻击者无需任何凭据即可发起攻击。
2.  **特制的 HTTP 请求：**  攻击者构造特定的 HTTP GET/POST 请求，利用漏洞绕过身份验证。
3.  **创建特权用户：** 成功利用漏洞后，攻击者可以创建一个拥有最高权限（特权级别 15）的本地用户。
4.  **后续利用：**  创建的特权用户可被用于进一步的恶意活动，例如植入后门、收集敏感信息等（与 CVE-2023-20273 结合）。

**有效性：**
根据漏洞描述和搜索结果，提供的 POC 代码 `main.py` 旨在检测目标是否存在 CVE-2023-20198 漏洞，而不是直接利用该漏洞创建用户。 它通过发送特定的HTTP请求来验证是否存在漏洞。因此，该POC代码在检测方面是有效的。



**项目地址:** [kacem-expereo/CVE-2023-20198](https://github.com/kacem-expereo/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #20

**来源**: [CVE-2023-20198-mr-r3b00t_CVE-2023-20198-IOS-XE-Scanner.md](../2023/CVE-2023-20198-mr-r3b00t_CVE-2023-20198-IOS-XE-Scanner.md)

## CVE-2023-20198-Cisco IOS XE Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的攻击者创建具有特权15权限的本地用户，进而控制设备。

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他一些版本，具体参考漏洞库信息。

**利用条件:** 目标设备启用了Web UI功能，并且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198 漏洞允许未经身份验证的远程攻击者在受影响的 Cisco IOS XE 设备上创建具有特权级别 15 访问权限的帐户。此漏洞是由于 Web UI 功能中存在未受保护的备用通道漏洞 (CWE-420) 造成的。攻击者可以利用此漏洞获得初始访问权限，然后通过 CVE-2023-20273 进一步提升权限至 root 并植入后门。提供的PoC代码 `implant_scanner.ps1` 实际上是一个检测脚本，用于判断目标系统是否已经被植入后门，通过对比Web页面内容的MD5哈希值来判断。脚本本身没有发现明显的投毒代码，config.json中指定了目标URL和已知的哈希值，用于检测是否存在已知的植入体。因此，该仓库中存在作者隐藏的投毒代码的可能性为0%。利用方式是，首先利用CVE-2023-20198创建一个高权限用户，然后利用CVE-2023-20273提升权限并写入植入体（后门）。

**项目地址:** [mr-r3b00t/CVE-2023-20198-IOS-XE-Scanner](https://github.com/mr-r3b00t/CVE-2023-20198-IOS-XE-Scanner)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #21

**来源**: [CVE-2023-20198-netbell_CVE-2023-20198-Fix.md](../2023/CVE-2023-20198-netbell_CVE-2023-20198-Fix.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权远程攻击者创建特权15用户并控制设备

**影响版本:** 受影响版本众多，详见漏洞库信息

**利用条件:** Web UI功能已启用，设备可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性非常高，因为它已被CISA列入已知被利用漏洞目录，并且Cisco官方也已确认存在活跃的利用。漏洞利用方式如下：

1.  **利用CVE-2023-20198获取初始访问权限:** 未经身份验证的攻击者可以利用此漏洞，通过Web UI创建一个具有特权15（最高权限）的本地用户。
2.  **利用CVE-2023-20273提升权限至Root:** 攻击者创建本地用户后，可以利用CVE-2023-20273进一步提升权限至root，并将恶意程序写入文件系统，实现完全控制。

提供的漏洞利用代码（Ansible playbook）实际上是一个缓解措施，旨在禁用Web UI以阻止利用。虽然主要目的是缓解漏洞，但该仓库中存在一定投毒风险。例如:

*   **inventory.yml中的凭据:**  该文件包含默认用户名和密码（admin/admin_password），这可能会被粗心的用户直接用于生产环境，从而使系统暴露于风险之中。
*   **依赖的安全性:**  Ansible playbook的安全性取决于控制机本身的安全。如果控制机被攻破，攻击者可以修改playbook或inventory，从而造成更大范围的损害。

因此，虽然Playbook本身主要是用于缓解漏洞，但配置不当可能导致其他安全问题，存在潜在的投毒风险。务必负责任地存储凭据，使用Ansible Vault或其他安全方法来保护敏感信息。

**项目地址:** [netbell/CVE-2023-20198-Fix](https://github.com/netbell/CVE-2023-20198-Fix)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #22

**来源**: [CVE-2023-20198-ohlawd_CVE-2023-20198.md](../2023/CVE-2023-20198-ohlawd_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，可导致完全控制受影响系统

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他特定版本

**利用条件:** 需要目标设备启用Web UI功能

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。攻击者可以利用此漏洞，在未经身份验证的情况下，通过发送特制请求创建一个具备特权级别15的本地用户，从而获得对设备的完全控制权。由于提供的POC代码仅打印"how bout u exploit d33z nuts"，并没有实际利用漏洞的代码，所以判断其为无效的POC，且具有100%的投毒风险。漏洞利用方式包括：首先利用CVE-2023-20198漏洞获得初始访问权限，然后执行特权15命令以创建本地用户和密码组合。之后，攻击者可能利用CVE-2023-20273漏洞，利用新创建的本地用户将权限提升为root，并将植入程序写入文件系统。

**项目地址:** [ohlawd/CVE-2023-20198](https://github.com/ohlawd/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #23

**来源**: [CVE-2023-20198-raystr-atearedteam_CVE-2023-20198-checker.md](../2023/CVE-2023-20198-raystr-atearedteam_CVE-2023-20198-checker.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI Privilege Escalation

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可能导致完全控制受影响的设备

**影响版本:** 16.1.1 to 17.12.1a 等多个版本 (参考漏洞库信息)

**利用条件:** Web UI功能必须启用，且设备可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-20198 允许未经身份验证的攻击者在受影响的系统上创建一个具有特权级别 15 访问权限的帐户。根据搜索引擎的结果，该漏洞已被积极利用。利用方式是，攻击者首先利用此漏洞获得初始访问权限，然后发出特权 15 命令来创建本地用户和密码组合。然后，攻击者利用另一个漏洞 (CVE-2023-20273) ，利用新创建的本地用户将权限提升为 root 并在文件系统中写入植入程序。 

提供的POC代码尝试通过向 `/webui/logoutconfirm.html` 发送带有 `logon_hash=1` 的POST请求来探测漏洞。如果响应状态码为200，并且响应内容的长度小于32个字符，则可能存在漏洞。POC代码扫描指定的子网，并尝试利用漏洞。 

关于投毒风险，POC代码本身相对简单，主要是网络扫描和HTTP请求。虽然不能完全排除恶意修改的可能性，但代码结构清晰，功能直接，隐藏恶意代码的概率较低。 投毒风险评估较低，大约5%。主要的风险点在于：
1.  **依赖未验证的requests库**：如果requests库本身被投毒，则会影响此脚本。
2.  **成功标志的判断**: 响应内容长度小于32可能是判断依据不足，如果恶意修改，可能导致误报或者漏报，将正常设备标记为存在漏洞，引导使用者进行进一步的恶意操作。

**项目地址:** [raystr-atearedteam/CVE-2023-20198-checker](https://github.com/raystr-atearedteam/CVE-2023-20198-checker)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #24

**来源**: [CVE-2023-20198-reket99_Cisco_CVE-2023-20198.md](../2023/CVE-2023-20198-reket99_Cisco_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，可导致完全控制受影响的Cisco IOS XE设备

**影响版本:** 16.1.1 to 17.12.1 (部分版本)

**利用条件:** Web UI功能已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。攻击者可以利用此漏洞，在未经身份验证的情况下，创建一个具有特权级别15（完全访问所有命令）的本地用户。接下来，攻击者可以利用CVE-2023-20273，通过新创建的本地用户提升权限至root并在文件系统中写入植入物。漏洞利用流程如下：

1.  **CVE-2023-20198 利用:**  未经验证的攻击者通过发送特制的POST请求到`/webui/logoutconfirm.html`，绕过身份验证，创建一个具有管理员权限的新用户。
2.  **CVE-2023-20273 利用:** 使用步骤1中创建的管理员用户，利用另一个Web UI组件中的漏洞，提升权限到root，并写入恶意植入物。

提供的POC代码尝试通过向目标IP地址的`/webui/logoutconfirm.html`发送POST请求来验证漏洞是否存在。如果响应状态码为200，并且响应长度较短（小于32字节），则认为该IP地址易受攻击。然后，脚本会使用curl再次发送请求，如果返回特定的输出长度，则确认漏洞存在。

**关于投毒风险:**

虽然该脚本的主要目的是验证漏洞的存在，但仍然存在一定的投毒风险。风险点在于subprocess.run函数中，使用shell=True来执行curl命令。这使得代码容易受到命令注入攻击，如果攻击者能够控制IP地址或相关参数，则可能执行任意命令。 此外，脚本会将成功利用漏洞的IP地址记录到results.csv 文件中，这虽然不是恶意行为，但可能被恶意行为者利用。投毒风险评估为10%，主要是因为使用了subprocess.run(shell=True)执行外部命令。

**项目地址:** [reket99/Cisco_CVE-2023-20198](https://github.com/reket99/Cisco_CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #25

**来源**: [CVE-2023-20198-sanan2004_CVE-2023-20198.md](../2023/CVE-2023-20198-sanan2004_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响的系统

**影响版本:** 16.1.1 至 17.12.3 以及其他版本

**利用条件:** 目标系统启用了Web UI功能，且位于网络可达范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 存在于 Cisco IOS XE 软件的 Web UI 中。该漏洞允许未经身份验证的攻击者通过不正确的路径验证绕过 Nginx 过滤，访问 `webui_wsma_http` Web 端点，从而可以执行任意 Cisco IOS 命令或进行配置更改，获得 Privilege 15 权限。该漏洞利用涉及两个 XML SOAP 端点：`cisco:wsma-exec` 和 `cisco:wsma-config`。攻击者可以使用 `cisco:wsma-exec` 端点将命令插入到 `execCLI` 元素标记中，例如获取运行配置或执行任意命令。攻击者还可以使用 `cisco:wsma-config` 端点添加具有 Privilege 15 的新用户。随附的 PoC 脚本提供检查漏洞、获取配置、执行命令以及添加/删除用户的功能。PoC 代码的投毒风险较低 (10%)，主要风险在于不熟悉该漏洞的人员可能意外地在生产环境中执行恶意命令，或在测试时使用了存在后门的IOS版本。脚本本身旨在利用漏洞，并且不包含任何明显的恶意或隐藏功能，仓库的README.md声明了此POC的利用方式,降低了隐藏的恶意代码的风险。

**漏洞利用方式：**

1.  **利用 CVE-2023-20198 绕过身份验证：** 攻击者构造特制的 URL 访问易受攻击的 Web UI 端点。
2.  **提升权限：** 成功绕过身份验证后，攻击者可以利用 `cisco:wsma-exec` 或 `cisco:wsma-config` SOAP接口下发命令。
3.  **创建特权用户：** 攻击者创建一个具有 Privilege 15 权限的新用户，从而获得对系统的完全控制。
4.  **执行任意命令：** 攻击者可以使用提权的会话执行任意 Cisco IOS 命令，包括安装后门、修改配置或窃取敏感信息。

**项目地址:** [sanan2004/CVE-2023-20198](https://github.com/sanan2004/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #26

**来源**: [CVE-2023-20198-securityphoenix_cisco-CVE-2023-20198-tester.md](../2023/CVE-2023-20198-securityphoenix_cisco-CVE-2023-20198-tester.md)

## CVE-2023-20198-Cisco IOS XE Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的攻击者创建具有特权15的本地用户，从而完全控制设备

**影响版本:** 受影响的版本包括 16.1.1 到 17.12.1 以及其他版本

**利用条件:** Web UI 功能必须已启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞信息和搜索结果，CVE-2023-20198 允许未经身份验证的攻击者在受影响的 Cisco IOS XE 设备上创建具有 privilege level 15 （最高权限）的本地用户。漏洞利用涉及向 Web UI 发送特制的 HTTP POST 请求，绕过身份验证机制。创建具有最高权限的用户后，攻击者可以使用该账户执行任意命令，并完全控制设备。提供的 `cisco_tester.py` 脚本旨在检测目标设备是否受到 CVE-2023-20198 的影响。它通过向 `/webui/logoutconfirm.html?logon_hash=1` 发送 POST 请求，并检查响应中是否包含特定的字符串 `1a80b7389ccd0a5dab` 来判断设备是否已被入侵。该字符串很可能是一个被利用的设备的特征。

**有效性:**

根据漏洞库信息、搜索结果（特别是 https://www.horizon3.ai/attack-research/attack-blogs/cisco-ios-xe-cve-2023-20198-deep-dive-and-poc/）和漏洞利用代码，该漏洞的利用是有效的，已经有公开可用的PoC。

**投毒风险:**

提供的Python脚本本身主要是一个检测工具，用于检查Cisco设备是否受到CVE-2023-20198的影响，它通过检测特定Hash值判断系统是否已经被植入后门。该脚本逻辑比较简单，主要功能为发送HTTP请求并匹配特定字符串。风险点可能在于脚本对异常的处理不够严谨，如果目标存在其他漏洞，可能被利用，但从代码本身来看，投毒的可能性较低，例如作者没有隐藏恶意的代码执行、数据窃取等行为。可以认为投毒风险极低，可能性约为1%。

**利用方式:**

1.  **未经身份验证的权限提升:**  攻击者利用 CVE-2023-20198 在 Cisco IOS XE 设备上创建一个具有最高权限 (privilege level 15) 的本地用户。
2.  **初始访问:**  利用漏洞绕过 Web UI 的身份验证机制。
3.  **命令执行:**  使用新创建的特权用户账户登录并执行任意命令，实现对设备的完全控制。
4.  **植入后门:** 利用CVE-2023-20273，提升权限至root,写入后门文件。

总而言之，此漏洞允许攻击者完全控制受影响的Cisco设备，风险极高。

**项目地址:** [securityphoenix/cisco-CVE-2023-20198-tester](https://github.com/securityphoenix/cisco-CVE-2023-20198-tester)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #27

**来源**: [CVE-2023-20198-smokeintheshell_CVE-2023-20198.md](../2023/CVE-2023-20198-smokeintheshell_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权用户创建特权用户并执行任意命令

**影响版本:** 受影响版本包括16.1.1到17.12.1等多个版本

**利用条件:** 需要目标设备启用Web UI功能，且攻击者能够网络访问该Web UI。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。该漏洞源于对 Nginx 过滤器的不当路径验证，允许未经身份验证的攻击者绕过身份验证访问 `webui_wsma_http` Web 端点。

**利用方式：**

1.  攻击者利用漏洞绕过身份验证，向 `webui_wsma_http` 端点发送特制的 XML SOAP 请求。
2.  攻击者可以使用 `cisco:wsma-exec` SOAP 端点执行任意 Cisco IOS 命令，或者使用 `cisco:wsma-config` SOAP 端点创建具有 Privilege 15 权限的本地用户。
3.  创建具有 Privilege 15 权限的用户后，攻击者可以使用该用户登录并执行任何操作。
4.  结合CVE-2023-20273，攻击者可以进一步提升权限至root，并写入植入程序。

**有效性：**

根据漏洞描述和提供的漏洞利用代码，该漏洞利用是有效的。漏洞利用代码包含检查漏洞是否存在、获取 Cisco IOS 运行配置、执行任意 Cisco IOS 命令以及添加/删除特权用户的功能。搜索引擎结果也表明该漏洞已被 активно利用。

**投毒风险：**

分析提供的漏洞利用代码（exploit.py），发现以下潜在风险：

*   虽然代码本身看起来直接实现了漏洞利用，但仍然存在作者在代码中加入恶意行为的可能性。
*   例如，可以修改添加用户的函数，在创建高权限用户的同时，静默地执行其他恶意配置更改（如添加后门路由或修改系统日志设置）。
*   代码中使用了多个 SOAP 端点，虽然文档中只提到了 `cisco:wsma-exec` 和 `cisco:wsma-config`，但作者可能利用其他未公开的端点执行恶意操作。
*   因此，需要仔细审查代码的每一行，特别是与网络请求和配置更改相关的部分，以确保没有隐藏的恶意逻辑。
*  根据代码内容，未发现明显的恶意代码，但由于该漏洞可以创建高权限用户，如果攻击者利用该漏洞，完全可以植入后门，存在投毒风险。
*  代码本身风险较低，投毒风险主要体现在被攻击者利用后实施的恶意行为，故将风险调整为10%。

**项目地址:** [smokeintheshell/CVE-2023-20198](https://github.com/smokeintheshell/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #28

**来源**: [CVE-2023-20198-sohaibeb_CVE-2023-20198.md](../2023/CVE-2023-20198-sohaibeb_CVE-2023-20198.md)

# CVE-2023-20198

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-20198-Arshit01_CVE-2023-20198.md](../2023/CVE-2023-20198-Arshit01_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI权限提升漏洞

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响的Cisco设备

**影响版本:** 16.1.1 to 17.12.1及部分17.x版本

**利用条件:** Web UI功能已启用，且目标设备存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。未经身份验证的攻击者可以利用此漏洞创建具有特权级别15（最高权限）的本地用户，从而完全控制受影响的设备。利用过程分为两个阶段：首先利用CVE-2023-20198创建用户，其次利用CVE-2023-20273提升权限至root并写入植入程序。

**漏洞利用方式：**

1.  **身份验证绕过：** 漏洞允许未经身份验证的攻击者与设备的Web UI进行交互。
2.  **创建特权用户：** 攻击者发送特制的SOAP请求到Web UI，该请求绕过身份验证并允许攻击者创建一个具有特权级别15的新用户。
3.  **远程控制：** 创建具有最高权限的用户后，攻击者可以使用此帐户登录设备，并执行任意命令。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的POC代码，可以确认POC代码是有效的。搜索结果中的文章提到了漏洞的成功利用和概念验证代码的存在。POC代码也显示了通过发送特制的XML SOAP请求来创建新用户的机制。

**投毒风险：**

提供的POC代码存在轻微的投毒风险，约为10%。风险点分析如下：

*   **默认用户名和密码：** POC代码使用了默认的用户名（shellsmoke）和密码（pwned）。虽然这方便了漏洞测试，但如果未经修改直接用于攻击，很容易被检测到或被其他人利用。
*   **硬编码的URI：** POC中`exURI = '%2577eb%2575i_%2577sma_Http'`，如果攻击者修改此URI植入恶意代码，可能会导致拒绝服务或者其他恶意行为。
*   **命令执行：** 漏洞本身允许执行任意命令，攻击者可能通过植入恶意命令来感染设备。

需要注意的是，以上只是一些潜在的风险点，具体的投毒行为还需要进一步分析。POC的主要功能是验证漏洞的存在，而非恶意利用。因此，将其判定为具有投毒代码是不准确的。

**项目地址:** [Arshit01/CVE-2023-20198](https://github.com/Arshit01/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #2

**来源**: [CVE-2023-20198-Atea-Redteam_CVE-2023-20198.md](../2023/CVE-2023-20198-Atea-Redteam_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Software Web UI权限提升漏洞

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，未经身份验证的攻击者可以创建具有特权级别15访问权限的帐户，并最终导致完全控制受影响的系统。

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1以及17.11.99SW等众多版本

**利用条件:** Web UI 功能必须启用。需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个关键漏洞。未经身份验证的远程攻击者可以利用此漏洞在受影响的系统上创建具有特权级别 15（完全访问所有命令）的帐户。利用方式是攻击者发送特制的 HTTP 请求到 `/webui/logoutconfirm.html?logon_hash=1` 路径，绕过身份验证，并执行特权命令以创建本地用户和密码组合。创建用户后，攻击者可以利用另一个漏洞（CVE-2023-20273）提升权限至 root 并写入植入程序到文件系统。提供的 Python 脚本 `CVE-2023-20198.py` 旨在检测是否存在该漏洞，并检查已知的 IOC。  该脚本扫描指定子网，并检查目标设备是否返回预期的响应状态码和内容长度。投毒风险评估：脚本本身主要用于检测，但由于脚本包含发送特定请求到目标设备的逻辑，如果攻击者修改此脚本，可能会加入恶意负载或更改用户创建的用户名/密码，存在一定的投毒风险.脚本中存在User-Agent:Atea Red Team CVE-2023-20198 checkscript特征,可能被安全设备检测到。存在的风险点是如果未经授权的人员使用了修改后的脚本，可能会对网络造成损害。 README.md文件没有发现异常。

**项目地址:** [Atea-Redteam/CVE-2023-20198](https://github.com/Atea-Redteam/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #3

**来源**: [CVE-2023-20198-DOMINIC471_qub-network-security-cve-2023-20198.md](../2023/CVE-2023-20198-DOMINIC471_qub-network-security-cve-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权级别15的账户，完全控制受影响的设备。

**影响版本:** 受影响版本众多，包括16.1.1到17.12.1以及其他版本（详见漏洞库信息）。

**利用条件:** Web UI功能必须已启用。设备需要可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞允许未经身份验证的攻击者在Cisco IOS XE设备上创建具有特权级别15（最高权限）的本地用户。攻击者通过利用Web UI中的漏洞绕过身份验证，并执行特权命令创建用户。结合另一个漏洞CVE-2023-20273，攻击者可以进一步提升权限至root并写入植入程序到文件系统。 

**有效性评估：**
根据提供的漏洞库信息和搜索结果，CVE-2023-20198是一个严重漏洞，已被积极利用。

**投毒风险评估：**
查看提供的POC代码，包括README.md和IOC Summary.md文件。 README.md主要描述了如何分析、检测和缓解此漏洞。IOC Summary.md列出了攻击者IP，受害者IP，使用的header以及payload等。这些信息可以辅助蓝队进行防御。
总体来说，该仓库的目的是为了分析和缓解漏洞，并没有发现明显的投毒代码。但是，由于代码中可能包含攻击载荷或恶意命令示例，如果使用者不小心，可能会误用这些代码进行非授权的渗透测试，从而导致法律风险。因此，评估的投毒风险为10%。

**利用方式：**
1.  **未授权访问：** 攻击者利用漏洞，绕过Web UI的身份验证机制。
2.  **创建特权用户：** 攻击者通过发送特制的HTTP请求，执行CLI命令，创建一个具有特权级别15的本地用户。
3.  **持久化（结合CVE-2023-20273）：** 攻击者利用新创建的本地用户登录，并利用另一个漏洞（CVE-2023-20273）提升权限到root，并在文件系统中写入植入程序，实现持久化控制。

**缓解措施：**
*   禁用Web UI功能，如果不需要使用。
*   升级到已修复漏洞的IOS XE软件版本。
*   使用入侵检测/防御系统（IDS/IPS）检测和阻止利用此漏洞的攻击。
*   检查设备上是否存在异常用户和植入程序。

**项目地址:** [DOMINIC471/qub-network-security-cve-2023-20198](https://github.com/DOMINIC471/qub-network-security-cve-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #4

**来源**: [CVE-2023-20198-G4sul1n_Cisco-IOS-XE-CVE-2023-20198.md](../2023/CVE-2023-20198-G4sul1n_Cisco-IOS-XE-CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权15权限的本地用户，结合CVE-2023-20273可提升至root权限并植入后门。

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他相关版本，具体参见漏洞库信息。

**利用条件:** 需要目标系统启用Web UI功能，且网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。根据漏洞信息和搜索结果，该漏洞允许未经身份验证的远程攻击者在受影响的系统上创建一个具有特权级别 15 访问权限的帐户。Cisco的公告指出，攻击者首先利用此漏洞获得初始访问权限，然后执行特权 15 命令以创建本地用户和密码组合。随后，攻击者利用 CVE-2023-20273 将权限提升到 root 并将植入程序写入文件系统。根据提供的漏洞利用代码，该 PoC 包含以下功能：

*   **漏洞检查**：通过执行 `uname -a` 命令来验证漏洞是否存在。
*   **获取 Cisco 配置**：执行 `sh run` 命令来提取运行配置。
*   **执行命令**：允许执行任意 Cisco IOS 命令，但警告需要谨慎使用，因为没有输入验证。
*   **添加用户**：创建一个新的特权 15 用户帐户，可以选择指定用户名和密码。
*   **删除用户**：从设备中删除用户帐户。

**有效性：**

该 PoC 代码的有效性较高，因为漏洞库信息和搜索结果都表明该漏洞已被 активно используется。此外，该 PoC 提供了多种利用方式，包括漏洞检查、信息收集和权限提升。

**投毒风险：**

尽管 PoC 代码主要用于利用已知的漏洞，但仍存在一定的投毒风险，估计为10%。风险点包括：

*   **命令执行**：通过 `-e` 选项执行任意命令，攻击者可能利用此功能执行恶意操作。
*   **用户管理**：虽然提供了添加和删除用户的选项，但如果被滥用，可能导致拒绝服务或系统损坏。

虽然PoC代码本身看起来是为了复现漏洞，但不能完全排除代码作者在其中隐藏恶意功能的可能性，例如植入后门、收集敏感信息等。因此，在使用 PoC 代码时，需要进行仔细审查和安全评估。

**利用方式：**

1.  **未经身份验证的访问**：利用 CVE-2023-20198 绕过身份验证，访问 `webui_wsma_http` Web 端点。
2.  **创建特权用户**：使用 `cisco:wsma-config` SOAP 端点创建一个具有特权 15 的新用户帐户。
3.  **执行任意命令**：使用 `cisco:wsma-exec` SOAP 端点执行任意 Cisco IOS 命令。
4.  **权限提升 (结合 CVE-2023-20273)**：利用新创建的特权用户，结合 CVE-2023-20273 将权限提升到 root，并在系统上植入后门。

总而言之，CVE-2023-20198 是一个严重的安全漏洞，需要立即采取措施进行修复。在使用 PoC 代码时，需要谨慎评估风险，并确保在受控环境中进行测试。

**项目地址:** [G4sul1n/Cisco-IOS-XE-CVE-2023-20198](https://github.com/G4sul1n/Cisco-IOS-XE-CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #5

**来源**: [CVE-2023-20198-IceBreakerCode_CVE-2023-20198.md](../2023/CVE-2023-20198-IceBreakerCode_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权级别 15 的帐户，从而完全控制设备

**影响版本:** 16.1.1 to 17.12.1 and earlier versions

**利用条件:** Web UI 功能已启用并且设备易受攻击版本的影响。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个漏洞，允许未经身份验证的远程攻击者在受影响的系统上创建具有特权级别 15 访问权限的帐户。 

**漏洞利用方式：**

1.  攻击者发送一个特制的 HTTP POST 请求到 `/webui/logoutconfirm.html?logon_hash=1` 端点，绕过身份验证。
2.  成功利用此漏洞后，攻击者可以执行任意命令，包括创建具有特权级别 15 的本地用户。
3.  然后，攻击者使用另一个漏洞（CVE-2023-20273）并通过新创建的本地用户权限提升到 root 权限，并将植入程序写入文件系统。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判定该漏洞的POC代码是有效的。漏洞库信息明确指出存在正在进行的漏洞利用活动。搜索结果也提供了多个关于该漏洞的深度分析和POC示例的链接，例如horizon3.ai上的POC代码。
提供的python脚本模拟了发送特制HTTP请求的过程，旨在检测目标系统是否存在漏洞。脚本会检查HTTP响应状态码和响应体内容，以判断是否存在潜在的植入程序。

**投毒风险：**

评估POC代码的投毒风险，需要仔细分析代码是否存在恶意行为，例如：
1.  **植入后门：**  代码是否在目标系统上安装未经授权的后门。
2.  **数据窃取：**  代码是否窃取敏感信息并发送到外部服务器。
3.  **拒绝服务：**  代码是否导致目标系统崩溃或无法正常运行。
4.  **恶意传播：**  代码是否试图感染其他系统。

分析提供的python脚本，该脚本主要用于检测漏洞是否存在，并未发现明显的恶意行为。脚本的功能是发送特定的HTTP请求并检查响应，以确定目标系统是否受到CVE-2023-20198漏洞的影响。然而，使用任何未经授权的漏洞利用代码都存在风险，因为代码的作者可能隐藏了不易察觉的恶意功能。因此，在使用任何POC代码之前，务必进行彻底的安全审查。

考虑到以上因素，判定该POC代码存在10%的投毒风险，主要是由于作者可能隐藏了一些不易察觉的恶意代码，但主要功能是漏洞验证。

**缓解措施：**

*   禁用 Web UI 功能，特别是当设备面向互联网时。
*   将 Web UI 访问限制为受信任的网络。
*   升级到已修复漏洞的 Cisco IOS XE 软件版本。

**项目地址:** [IceBreakerCode/CVE-2023-20198](https://github.com/IceBreakerCode/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #6

**来源**: [CVE-2023-20198-JoyGhoshs_CVE-2023-20198.md](../2023/CVE-2023-20198-JoyGhoshs_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可导致完全控制受影响设备

**影响版本:** 受影响版本范围广泛，详见漏洞库信息

**利用条件:** Web UI功能已启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198 允许未经身份验证的攻击者在受影响的系统上创建具有权限级别15（完全访问权限）的帐户。该漏洞利用方式如下：

1.  **初始访问:** 攻击者利用CVE-2023-20198漏洞，通过Web UI创建具有高权限的本地用户。
2.  **权限提升:** 然后，攻击者可能利用CVE-2023-20273（另一个漏洞）或使用新创建的本地用户进一步将权限提升至root。
3.  **植入后门:** 攻击者利用获得的root权限，在文件系统中写入恶意植入。

提供的POC代码`poc.py`是一个**检测工具**，而非完整的漏洞利用代码。它通过发送一个特定的HTTP请求到`/webui/logoutconfirm.html?logon_hash=1`，并检查响应内容是否为十六进制字符串来判断目标是否可能受到了攻击并植入了后门。如果响应是十六进制字符串，则表明设备可能已遭入侵，并存在植入的后门（该后门会返回hex信息）。

该存储库中的`README.md`文件说明，此脚本并非完整的POC，仅用于检查是否存在hex响应。因此，它无法直接用于漏洞利用，而只能用于检测。

**投毒风险分析：**

查看`poc.py`文件内容，发现其功能主要是发送HTTP请求并判断响应内容。该代码的功能比较简单，未发现任何可能导致恶意行为（例如，上传恶意文件、执行任意命令等）的可疑代码。因此，可以认为该存储库不存在作者隐藏的投毒代码。



**项目地址:** [JoyGhoshs/CVE-2023-20198](https://github.com/JoyGhoshs/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #7

**来源**: [CVE-2023-20198-Pushkarup_CVE-2023-20198.md](../2023/CVE-2023-20198-Pushkarup_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的远程攻击者创建管理员账户并完全控制设备

**影响版本:** 受影响版本详见CVE描述

**利用条件:** 目标设备启用了Web UI功能，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞存在于 Cisco IOS XE 软件的 Web UI 中。未经身份验证的远程攻击者可以通过利用此漏洞在受影响的系统上创建具有特权级别 15 访问权限的帐户。创建账户后，攻击者可以使用该账户完全控制受损的机器。

**有效性：**
提供的 POC 代码根据描述能够创建本地用户，安装植入体，重启Web服务，并检查植入体的状态，因此具备有效性。

**投毒风险：**
此仓库中可能存在作者隐藏的投毒代码。尽管自述文件声明 PoC 仅用于教育目的，并且使用需要遵守道德规范，但攻击者可以修改 `config_content` 以包含恶意配置，例如更改防火墙规则或执行其他恶意操作。此外，虽然代码本身没有明显的恶意行为，但其目的是在目标系统上创建具有管理权限的用户，这本身就可以被认为是恶意的。因此，存在一定的投毒风险，但是相对较低，风险评估在10%。此风险评估基于以下因素：
    *   代码可能被用于未授权的系统访问。
    *   配置文件可被修改为包含恶意指令。

**利用方式：**
1.  攻击者利用 CVE-2023-20198 漏洞，通过未授权访问在 Cisco IOS XE 设备上创建一个具有特权级别 15 的本地用户。
2.  攻击者使用新创建的管理员账户登录到设备。
3.  攻击者利用 CVE-2023-20273 漏洞，进一步提升权限至 root 级别，并将恶意植入程序写入文件系统。
4.  攻击者通过植入的后门程序远程控制设备，执行恶意操作，例如数据窃取、网络攻击等。
根据搜索结果，CISA 已将此漏洞添加到已知被利用的漏洞目录中，表明该漏洞已经被广泛利用。

**项目地址:** [Pushkarup/CVE-2023-20198](https://github.com/Pushkarup/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #8

**来源**: [CVE-2023-20198-RevoltSecurities_CVE-2023-20198.md](../2023/CVE-2023-20198-RevoltSecurities_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，可被未授权的攻击者利用创建特权用户，进而完全控制系统。

**影响版本:** 受影响的版本包括16.1.1到17.12.1以及其他一系列17.x版本 (详见漏洞库信息)

**利用条件:** 目标设备启用Web UI功能，并且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。根据漏洞库信息和搜索引擎结果，未经身份验证的攻击者可以利用此漏洞在受影响的系统上创建一个具有 15 级权限（最高权限）的帐户。随后攻击者再利用CVE-2023-20273，将权限提升至root，并写入植入体。该漏洞的利用方式如下：

1.  **漏洞触发：** 攻击者发送特制的HTTP请求到Cisco IOS XE设备的Web UI接口，绕过身份验证。
2.  **创建特权用户：** 请求中包含特定的XML内容，该内容允许攻击者创建一个新的本地用户，并分配最高权限（privilege level 15）。
3.  **权限提升：** 攻击者利用创建的特权用户登录系统。
4.  **植入后门：** 攻击者通过Web UI的另一个组件（CVE-2023-20273）将权限提升至root并写入植入体。

**有效性：** 根据搜索引擎结果（特别是horizon3.ai的POC）以及提供的漏洞利用代码，此漏洞利用是有效的。漏洞利用代码仓库提供了一个Python脚本，可以检测和利用此漏洞。

**投毒风险：** 漏洞利用代码仓库的投毒风险评估为10%。虽然该仓库提供了看似合理的漏洞利用脚本，但存在以下潜在风险点：

*   **自定义配置内容：** 脚本允许用户提供自定义的配置内容（`-cfc` 或 `--config-content` 参数），这可能被滥用以注入恶意代码或配置。
*   **隐蔽后门：** 虽然主要功能是利用漏洞，但作者可能在代码中添加了不易察觉的后门，例如收集目标信息、执行任意命令等。代码量较少，通读代码可以降低风险。

**防范措施：**

*   立即更新Cisco IOS XE软件到已修复的版本。
*   禁用Web UI功能，如果不需要。
*   监控网络流量，检测异常的Web UI请求。
*   使用Cisco提供的软件检查工具来识别和移除潜在的植入体。

**项目地址:** [RevoltSecurities/CVE-2023-20198](https://github.com/RevoltSecurities/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #9

**来源**: [CVE-2023-20198-Shadow0ps_CVE-2023-20198-Scanner.md](../2023/CVE-2023-20198-Shadow0ps_CVE-2023-20198-Scanner.md)

## CVE-2023-20198 Cisco IOS XE Web UI 权限提升漏洞

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权 15 权限的本地用户，从而完全控制受影响的设备。

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1 以及 17.11.99SW

**利用条件:** Web UI 功能必须已启用。攻击者需要能够通过网络访问设备的 Web UI。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。未经身份验证的远程攻击者可以利用此漏洞在受影响的系统上创建一个具有特权 15 访问权限的帐户，本质上是管理员权限。漏洞利用通常与另一个漏洞 CVE-2023-20273 结合使用，后者用于将权限提升到 root 并将植入程序写入文件系统。

**漏洞利用有效性：**

根据漏洞库信息、搜索引擎结果（特别是 horizon3.ai 的 PoC 描述）以及提供的漏洞利用代码片段来看，该漏洞的利用是有效的。存在公开可用的 PoC，允许攻击者绕过身份验证创建具有管理权限的用户。

**投毒风险分析：**

提供的代码片段分析表明，攻击流程依赖于 Nginx 配置和一个 Lua 脚本。Lua 脚本的核心功能在于身份验证绕过和命令执行。脚本通过检查是否存在特定的 "Authorization" Header以及Header的内容是否和通过REDACTED命令执行结果匹配来确定请求是否被授权。

由于 "REDACTED" 信息的缺失，我们无法完全确定是否存在恶意投毒代码。但是lua脚本的下列行为存在潜在的投毒风险：

1.  **外部命令执行:** 脚本多次使用 `io.popen()` 执行外部命令。如果这些命令包含恶意参数或旨在下载和执行其他代码，则可能导致系统受损。
2.  **硬编码的凭据和逻辑：**脚本逻辑依赖于特定的哈希值和其他硬编码的字符串。攻击者可能会修改这些字符串以创建变体，从而绕过安全检测或植入后门。
3.  **对/lua5的请求:** 当common_type=iox时,会调用/lua5,如果/lua5是作者控制的地址,则存在投毒风险。

基于以上分析，虽然无法确定明确的投毒代码，但脚本中使用的技术（尤其是外部命令执行）增加了被用于恶意目的的可能性，估计投毒风险为20%。

**漏洞利用方式：**

1.  **未授权访问:** 攻击者发送一个特制的 HTTP POST 请求到 `/webui/logoutconfirm.html`，绕过身份验证检查（利用 CVE-2023-20198）。这可能涉及到提供特定的 `Authorization` header，该header的值能够通过预设的验证。
2.  **创建高权限用户:** 绕过身份验证后，攻击者可以发送包含创建新用户（具有特权级别 15）的命令的请求体。该命令通过 `io.popen()` 执行，从而创建一个具有管理员权限的本地用户。
3.  **权限提升和植入：** (结合 CVE-2023-20273) 使用新创建的本地用户登录并利用 CVE-2023-20273 将权限提升至 root，从而能够在设备上安装植入程序。


**项目地址:** [Shadow0ps/CVE-2023-20198-Scanner](https://github.com/Shadow0ps/CVE-2023-20198-Scanner)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #10

**来源**: [CVE-2023-20198-Tounsi007_CVE-2023-20198.md](../2023/CVE-2023-20198-Tounsi007_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可能导致完全控制受影响设备

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他版本

**利用条件:** 目标设备启用了Web UI功能并且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞存在于Cisco IOS XE Software的Web UI中，允许未经身份验证的远程攻击者创建一个具有特权级别15（完全访问权限）的本地用户帐户。该漏洞利用方式是通过发送特制的HTTP请求到`/webui/create_user`路径来创建用户。攻击者随后可利用创建的用户并通过另一个漏洞CVE-2023-20273提升权限至root并写入植入程序。提供的POC代码尝试模拟此过程，包括创建用户、安装植入程序、重启Web服务器、检查植入程序状态以及清理创建的用户。 

**有效性：**根据漏洞信息、搜索结果和提供的POC代码，该漏洞是有效的。搜索引擎结果表明该漏洞已被积极利用，并且存在公开可用的POC代码。CISA的已知被利用漏洞目录也收录了该漏洞。

**投毒风险：**POC代码本身存在一定的风险。虽然代码的主要功能是利用漏洞，但`config_content`变量表明存在植入恶意配置的可能性。 用户需要手动插入植入配置,存在被植入后门的风险。
该仓库readme描述，POC仅用于测试和学习，有免责声明。存在一定概率作者未充分测试。

**利用方式：**
1.  **初始访问：** 未经身份验证的攻击者发送特制HTTP请求到存在漏洞的Cisco IOS XE设备的Web UI接口。
2.  **用户创建：**  利用CVE-2023-20198，攻击者通过`/webui/create_user`接口创建一个具有管理员权限的新用户。
3.  **权限提升（CVE-2023-20273）：** 利用新创建的用户，攻击者可以进一步利用Web UI中的另一个漏洞（CVE-2023-20273）来提升权限至root。
4.  **植入后门：** 攻击者可以写入植入程序到文件系统。
5.  **持久化：** 植入程序可以用于维持对受感染设备的访问。
6.  **清理（可选）：** 攻击者可以选择删除他们创建的后门账户，以隐藏其踪迹。

**项目地址:** [Tounsi007/CVE-2023-20198](https://github.com/Tounsi007/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #11

**来源**: [CVE-2023-20198-Vulnmachines_Cisco_CVE-2023-20198.md](../2023/CVE-2023-20198-Vulnmachines_Cisco_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可使未授权的攻击者获得完全管理权限

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1 以及其他多个版本

**利用条件:** Web UI 功能启用并且 HTTP 或 HTTPS 服务器功能开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个关键身份验证绕过漏洞。根据漏洞信息和搜索结果，攻击者利用此漏洞首先获得初始访问权限，然后执行特权 15 命令来创建一个本地用户和密码组合，从而获得管理员权限。之后，攻击者利用 CVE-2023-20273 将权限提升到 root 并在文件系统中写入植入程序。提供的 POC 代码显示了一个用于利用漏洞的 HTTP POST 请求示例。请求的目标 URI 经过编码处理，绕过了身份验证。请求体包含一个 SOAP 信封，该信封尝试使用默认的 "admin" 用户名执行命令 "uname -a"。有效性：根据搜索结果和漏洞描述，提供的 POST 请求通过身份验证绕过在受影响的设备上创建具有特权 15 的用户，因此 POC 代码有效。 投毒风险：README.md 文件描述了漏洞，并提供了一个关于利用该漏洞的概述。Payload 文件包含一个 SOAP 请求，用于发送 CLI 命令。虽然该请求本身看起来无害（执行 `uname -a` 命令），但攻击者可能会修改该请求以执行恶意命令。例如，更改命令以创建具有特权 15 的用户。 因此，存在一定风险，即此仓库可能被用于传播恶意利用程序。Payload 代码文件本身没有明显的投毒代码，但存在被修改利用的风险，因此判定投毒风险为 10%。利用方式：1. 检查目标 Cisco IOS XE 设备是否启用了 Web UI 功能和 HTTP/HTTPS 服务器。2. 发送构造的 HTTP POST 请求到目标设备，利用身份验证绕过漏洞。3. 请求的目标 URI 经过编码处理以绕过身份验证检查。4. POST 请求的内容为 SOAP 信封，其中包含要执行的 CLI 命令。5. 成功利用后，攻击者可以在设备上执行任意 CLI 命令，例如创建新的管理员帐户或植入恶意软件。

**项目地址:** [Vulnmachines/Cisco_CVE-2023-20198](https://github.com/Vulnmachines/Cisco_CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #12

**来源**: [CVE-2023-20198-W01fh4cker_CVE-2023-20198-RCE.md](../2023/CVE-2023-20198-W01fh4cker_CVE-2023-20198-RCE.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权15的用户，进而完全控制受影响的设备。

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1 等多个版本

**利用条件:** Web UI 功能已启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。未经身份验证的远程攻击者可以利用此漏洞在受影响的系统上创建一个具有特权 15 访问权限的帐户，从而完全控制设备。利用方式如下：

1.  **漏洞触发点：** Cisco IOS XE 软件的 Web UI 组件存在漏洞。
2.  **利用过程：** 攻击者通过发送特制的 SOAP 请求到 `/%%77ebui_wsma_https` 或 `/%%77ebui_wsma_Http` URI (具体取决于是否使用 HTTPS) 绕过身份验证。
3.  **命令执行：** 攻击者使用 `urn:cisco:wsma-config` 命名空间执行 CLI 命令，创建新的具有特权 15 的用户。
4.  **后续利用 (CVE-2023-20273):** 在获得初始访问权限后，攻击者可以利用 CVE-2023-20273 将权限提升为 root 并在文件系统中写入植入程序。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞已被积极利用，提供的 PoC 代码有效，可以用于创建具有特权 15 的用户。

**投毒风险：**

PoC 代码主要功能是利用漏洞，创建新用户，从代码本身来看，存在一些潜在的投毒点，例如：

*   **随机用户名/密码生成：**  虽然代码中包含随机用户名生成函数，但实际使用中，攻击者可能会替换为预设的用户名和密码，方便后续控制。
*   **代理服务器使用：**  PoC 代码支持使用代理服务器，攻击者可以借此隐藏真实 IP 地址，增加溯源难度。
*   **异常处理：**  代码中包含异常处理模块，可能用于隐藏利用过程中的错误信息，避免被发现。
*   **User-Agent:** 使用了常见的User-Agent，但是依然存在替换或者增加其他User-Agent进行恶意攻击.

总体来说，PoC 代码的投毒风险较低，主要集中在以上几点，但需要使用者谨慎使用。

**总结：**

该漏洞利用的有效性很高，并且在野外被广泛利用。PoC 代码可以用来验证漏洞的存在并创建管理员用户，但需要注意潜在的投毒风险。利用方式是发送特制的 SOAP 请求，绕过身份验证，然后执行 CLI 命令。

**项目地址:** [W01fh4cker/CVE-2023-20198-RCE](https://github.com/W01fh4cker/CVE-2023-20198-RCE)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #13

**来源**: [CVE-2023-20198-XiaomingX_cve-2023-20198-poc.md](../2023/CVE-2023-20198-XiaomingX_cve-2023-20198-poc.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响设备

**影响版本:** 受影响版本范围广泛，详见漏洞库信息

**利用条件:** Web UI 功能启用且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 存在于 Cisco IOS XE 软件的 Web UI 中。未经身份验证的攻击者可以利用此漏洞创建具有 privilege level 15 权限的本地用户，从而获得对设备的完全控制权。利用方式主要通过发送特制的 SOAP 请求到目标设备的 Web UI 接口，绕过身份验证，执行 CLI 命令。PoC 代码通过构造恶意的 SOAP 消息，例如 `username <username> privilege 15 secret <password>`，添加高权限用户。 

有效性分析：根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开的 PoC。提供的 PoC 代码实现了漏洞利用的基本功能，包括检查漏洞、获取配置、执行命令和添加/删除用户。因此，提供的 PoC 代码是有效的。

投毒风险分析：代码本身主要实现了漏洞利用功能，但仍然存在一定的投毒风险。体现在以下几个方面：

*   **恶意命令执行：** 虽然代码本身没有硬编码的恶意命令，但 `-e` 参数允许攻击者执行任意 Cisco IOS 命令。攻击者可能会使用此参数注入恶意配置或植入后门。
*   **硬编码凭据：** 默认用户名 `shellsmoke` 和密码 `pwned` 如果不修改，可能被其他攻击者利用。虽然这是一个PoC，但在实际使用中容易被忽视，从而导致设备被二次入侵。
*   **异常处理：** 某些异常处理不够完善，可能导致程序崩溃或泄露敏感信息。
*   **Payload内容:** 在SOAP请求模板中，攻击者可能修改命令或者在ADD_USER的情况下，添加后门账户。

综合考虑，该 PoC 存在一定的投毒风险，但主要集中在用户使用不当或被恶意利用的可能性上，PoC本身是漏洞的利用，投毒代码的可能性评判为 10%。建议使用者在使用 PoC 时仔细审查代码，并采取必要的安全措施。

利用方式总结：

1.  **目标确认：** 确定目标 Cisco IOS XE 设备是否启用了 Web UI 功能。
2.  **发送恶意 SOAP 请求：** 构造包含 CLI 命令的恶意 SOAP 请求，绕过身份验证。
3.  **权限提升：** 利用漏洞创建具有 privilege level 15 权限的本地用户。
4.  **完全控制：** 使用新创建的用户登录并完全控制设备。

**项目地址:** [XiaomingX/cve-2023-20198-poc](https://github.com/XiaomingX/cve-2023-20198-poc)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #14

**来源**: [CVE-2023-20198-ZephrFish_CVE-2023-20198-Checker.md](../2023/CVE-2023-20198-ZephrFish_CVE-2023-20198-Checker.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权15权限的本地用户，随后可能被用于植入后门和完全控制设备

**影响版本:** 受影响版本：16.1.1 到 17.12.1，以及其他相关版本（详见漏洞库信息）

**利用条件:** 目标设备启用了Web UI功能，且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞允许未经身份验证的攻击者在受影响的 Cisco IOS XE 设备上创建一个具有特权 15 权限（最高权限）的本地用户。该漏洞存在于 Web UI 功能中。根据搜索引擎结果和漏洞库信息，此漏洞已被积极利用。提供的漏洞利用代码 `XEImplantScanner.py` 主要用于扫描目标系统是否存在漏洞以及是否被植入后门。该脚本通过发送特定的 HTTP 请求到 `/webui/logoutconfirm.html` 端点来检测漏洞和后门的存在。

**利用方式：**

1.  **初始访问：** 未经身份验证的攻击者发送特制的 HTTP 请求到目标设备的 Web UI。
2.  **权限提升：** 利用 CVE-2023-20198，创建一个具有特权 15 权限的本地用户。
3.  **后门植入（CVE-2023-20273）：** 使用新创建的具有特权的用户，攻击者可以进一步利用另一个漏洞（CVE-2023-20273）来提升权限至 root，并将植入体写入文件系统，实现持久化控制。

**有效性：**

根据搜索引擎结果（例如，horizon3.ai 的文章）和漏洞库信息，CVE-2023-20198 漏洞已被成功利用。提供的 POC 代码 `XEImplantScanner.py` 旨在检测漏洞的存在以及后门的植入，本身不包含直接利用漏洞进行权限提升的代码，需要结合 CVE-2023-20273 来完全控制。

**投毒风险：**

POC 代码 `XEImplantScanner.py` 主要功能是扫描，相对安全。可能的投毒风险在于：

*   **结果误导：** 扫描结果可能被篡改，导致用户误判系统的安全状态。
*   **依赖风险：** 脚本依赖于 `requests` 库，如果 `requests` 库被恶意版本替换，可能导致代码执行。
*   **网络钓鱼:** 脚本可能被用于钓鱼，诱导用户扫描恶意服务器，泄露信息。

因此，评估的投毒风险为 10%。主要是考虑到其扫描器性质，以及依赖库被投毒的可能性。

**项目地址:** [ZephrFish/CVE-2023-20198-Checker](https://github.com/ZephrFish/CVE-2023-20198-Checker)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #15

**来源**: [CVE-2023-20198-alekos3_CVE_2023_20198_Detector.md](../2023/CVE-2023-20198-alekos3_CVE_2023_20198_Detector.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响系统

**影响版本:** 见受影响版本列表

**利用条件:** Web UI 功能已启用,网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。攻击者可以利用此漏洞绕过身份验证，创建一个具有 15 级权限的本地用户，从而完全控制受影响的系统。该漏洞结合 CVE-2023-20273 使用，CVE-2023-20198 用于初始访问，CVE-2023-20273 用于提权至 root 并写入植入程序到文件系统。

**利用方式：**

1.  未经身份验证的攻击者发送特制的HTTP请求到启用了Web UI的Cisco IOS XE设备。
2.  利用CVE-2023-20198漏洞，创建一个具有特权级别15的本地用户。
3.  使用新创建的本地用户利用CVE-2023-20273漏洞，将权限提升到root。
4.  将植入程序写入文件系统，从而完全控制设备。

**POC代码分析：**

提供的Python脚本 (`CVE_2023_20198_detector.py`) 主要用于检测设备是否存在漏洞，而不是利用该漏洞。它通过SSH连接到设备，并运行一些命令来检查Web UI是否启用，并尝试检测是否存在攻击迹象，例如存在`ip http server`, `ip http secure-server`,  `ip http active`配置。脚本通过`netmiko`库实现SSH连接和命令执行。该脚本没有直接创建特权用户的恶意代码，只是用于检测是否存在漏洞。该脚本会生成一个csv文件`Results_CVE_2023_20198_{current_timestamp}.csv` 用于记录检测结果。

**有效性：**

根据搜索引擎结果，存在公开的POC代码，可以创建特权用户。`CVE_2023_20198_detector.py`脚本本身并不能直接利用漏洞，它只能用来检测目标是否存在漏洞。

**投毒风险：**

该脚本的投毒风险极低 (0%)。虽然用户需要输入用户名和密码，但是该脚本只是用来检测是否存在漏洞，没有发现任何可疑的代码或后门，也没有修改系统配置的任何行为。LICENSE文件为标准的MIT License。

**项目地址:** [alekos3/CVE_2023_20198_Detector](https://github.com/alekos3/CVE_2023_20198_Detector)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #16

**来源**: [CVE-2023-20198-emomeni_Simple-Ansible-for-CVE-2023-20198.md](../2023/CVE-2023-20198-emomeni_Simple-Ansible-for-CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可导致完全控制受影响的设备

**影响版本:** 16.1.1 to 17.12.1

**利用条件:** Web UI 功能已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。根据漏洞库信息和搜索引擎结果，未经身份验证的攻击者可以利用此漏洞创建一个具有 15 级权限（完全访问所有命令）的本地用户。攻击者首先利用 CVE-2023-20198 获得初始访问权限，然后执行权限 15 命令来创建本地用户和密码组合，允许该用户以普通用户身份登录。 然后攻击者利用 web UI 功能的另一个组件，利用新的本地用户将权限提升到 root 并将植入程序写入文件系统，cve-2023-20273。

**有效性：**
根据搜索引擎结果（例如Horizon3.ai的博客），已经存在公开可用的PoC，并且漏洞被积极利用。提供的Ansible剧本并不是直接的漏洞利用代码，而是用于检测并禁用HTTP/HTTPS服务器以缓解漏洞。它也能检测是否已经遭受攻击，通过分析syslog。

**投毒风险：**
提供的Ansible剧本的主要目的是缓解漏洞，而不是利用漏洞。虽然其中包含连接到Cisco设备的凭据（developer/lastorangerestoreball8876），但这些是 Cisco Always On Sandbox 的公开凭据，用于测试目的。 投毒风险较低，但仍然存在一些风险：

1.  **凭据滥用：**  即使凭据是公开的，也可能有人修改剧本以使用不同的凭据尝试访问其他Cisco设备。
2.  **远程执行：**  Ansible 剧本在目标设备上执行命令。如果剧本被恶意修改，可能会导致设备配置更改或执行其他恶意操作。 鉴于此，大约有10%的可能性存在投毒风险。

**利用方式：**
1.  **初始访问：**  攻击者利用 CVE-2023-20198 中的漏洞，绕过身份验证。
2.  **创建高权限用户：**  攻击者利用未授权访问，创建一个具有 15 级权限的本地用户。
3.  **权限提升(CVE-2023-20273):** 攻击者利用本地用户权限和Web UI的另一个漏洞，将权限提升到 root。
4.  **植入后门：**  攻击者利用 root 权限，在设备上植入后门，以便长期控制。

**项目地址:** [emomeni/Simple-Ansible-for-CVE-2023-20198](https://github.com/emomeni/Simple-Ansible-for-CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #17

**来源**: [CVE-2023-20198-fox-it_cisco-ios-xe-implant-detection.md](../2023/CVE-2023-20198-fox-it_cisco-ios-xe-implant-detection.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未经身份验证的攻击者创建具有特权15的本地用户，最终导致完全控制受影响的设备

**影响版本:** 受影响版本包括16.1.1至17.12.1 以及其他相关版本

**利用条件:** Web UI功能已启用，设备可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198是Cisco IOS XE Software Web UI中的一个权限提升漏洞。攻击者可以利用此漏洞，在未经身份验证的情况下，通过发送特制的HTTP请求绕过身份验证，并在受影响的系统上创建一个具有最高权限（特权级别15）的本地用户。创建具有特权15的用户后，攻击者可以使用该用户登录设备，执行任意命令，并完全控制受影响的Cisco IOS XE设备。攻击者利用CVE-2023-20198获得初始访问权限后，会进一步利用CVE-2023-20273将权限提升到root级别，并在文件系统中写入恶意植入程序。

**利用方式：**

1.  **未经身份验证的访问：** 攻击者通过发送特制的HTTP请求，绕过Cisco IOS XE Web UI的身份验证机制。
2.  **创建特权用户：** 成功绕过身份验证后，攻击者可以执行特权命令，创建一个具有最高权限（特权级别15）的本地用户。
3.  **权限提升：** 使用新创建的具有特权15的用户登录设备。
4.  **植入后门:** 利用CVE-2023-20273，将权限提升到root级别，并在文件系统中写入恶意植入程序。

**关于投毒风险：**

提供的漏洞利用代码仅仅是Apache License 2.0协议，这是一个开源协议，本身不包含任何恶意代码。根据现有信息，没有迹象表明该漏洞利用代码中存在任何隐藏的恶意或投毒代码。

**项目地址:** [fox-it/cisco-ios-xe-implant-detection](https://github.com/fox-it/cisco-ios-xe-implant-detection)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #18

**来源**: [CVE-2023-20198-iveresk_cve-2023-20198.md](../2023/CVE-2023-20198-iveresk_cve-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响的Cisco IOS XE设备

**影响版本:** 受影响版本众多，详见漏洞库信息

**利用条件:** Web UI功能已启用，且设备未打补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-20198是一个Cisco IOS XE Software Web UI中存在的权限提升漏洞。根据漏洞库信息和搜索引擎结果，未经身份验证的攻击者可以通过该漏洞创建具有特权15级别（完全访问权限）的本地用户帐户。攻击者首先利用此漏洞获得初始访问权限，然后结合CVE-2023-20273漏洞，利用新创建的本地用户帐户将权限提升至root级别，并在文件系统中写入植入程序。漏洞利用代码 `cve-2023-20198.py` 提供了 `check` 和 `exploit` 两种模式。`check` 模式用于检测目标是否存在漏洞，`exploit` 模式用于创建本地用户帐户。漏洞利用过程包括向 `/webui/logoutconfirm.html` 发送POST请求进行检测，以及向 `/webui/create_user` 发送POST请求创建用户。投毒风险较低，因为代码主要利用已知的漏洞利用方法，但仍存在被修改以执行恶意操作的可能性，例如在创建用户后立即执行其他命令或植入后门程序。主要风险集中在config_content中，可能会存在其他的攻击代码。

**项目地址:** [iveresk/cve-2023-20198](https://github.com/iveresk/cve-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #19

**来源**: [CVE-2023-20198-kacem-expereo_CVE-2023-20198.md](../2023/CVE-2023-20198-kacem-expereo_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可被未授权的攻击者利用创建具有特权 15 的本地用户，为进一步攻击（如植入后门）铺平道路。

**影响版本:** 16.1.1 to 17.12.1 and potentially other versions as indicated in the CVE description.

**利用条件:** 目标设备启用了 Web UI 功能，且位于攻击者可访问的网络中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。未经身份验证的远程攻击者可以通过向目标设备发送特制的 HTTP 请求来利用此漏洞。该漏洞允许攻击者在受影响的系统上创建一个具有特权级别 15 访问权限的帐户。此漏洞是攻击链的第一步，攻击者利用它来创建具有管理权限的本地用户，然后利用 CVE-2023-20273 进一步提升权限至 root，并在文件系统中写入植入程序。提供的 POC 代码 `main.py` 的作用是检测目标 IP 是否容易受到 CVE-2023-20198 的攻击。它通过发送特定的 GET 和 POST 请求来检查目标设备是否返回预期的响应。如果目标返回指示存在漏洞的响应，脚本将输出 'Vulnerable'，否则输出 'Not Vulnerable'。代码通过发送构造的 HTTP GET 请求来尝试绕过身份验证，并检查是否出现预期的“404 Not Found”响应。同时,代码还发送带有硬编码 Authorization 头的 POST 请求，以进一步确认漏洞的存在。尽管代码本身用于检测漏洞，但潜在的投毒风险在于硬编码的 Authorization 头部，以及对 HTTPS 请求的证书验证的禁用（`verify=False`），这可能被恶意修改以进行中间人攻击或者将流量重定向到恶意服务器，虽然这种可能性不大，只有10%。

**利用方式：**

1.  **未经身份验证的访问：** 攻击者无需任何凭据即可发起攻击。
2.  **特制的 HTTP 请求：**  攻击者构造特定的 HTTP GET/POST 请求，利用漏洞绕过身份验证。
3.  **创建特权用户：** 成功利用漏洞后，攻击者可以创建一个拥有最高权限（特权级别 15）的本地用户。
4.  **后续利用：**  创建的特权用户可被用于进一步的恶意活动，例如植入后门、收集敏感信息等（与 CVE-2023-20273 结合）。

**有效性：**
根据漏洞描述和搜索结果，提供的 POC 代码 `main.py` 旨在检测目标是否存在 CVE-2023-20198 漏洞，而不是直接利用该漏洞创建用户。 它通过发送特定的HTTP请求来验证是否存在漏洞。因此，该POC代码在检测方面是有效的。



**项目地址:** [kacem-expereo/CVE-2023-20198](https://github.com/kacem-expereo/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #20

**来源**: [CVE-2023-20198-mr-r3b00t_CVE-2023-20198-IOS-XE-Scanner.md](../2023/CVE-2023-20198-mr-r3b00t_CVE-2023-20198-IOS-XE-Scanner.md)

## CVE-2023-20198-Cisco IOS XE Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的攻击者创建具有特权15权限的本地用户，进而控制设备。

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他一些版本，具体参考漏洞库信息。

**利用条件:** 目标设备启用了Web UI功能，并且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198 漏洞允许未经身份验证的远程攻击者在受影响的 Cisco IOS XE 设备上创建具有特权级别 15 访问权限的帐户。此漏洞是由于 Web UI 功能中存在未受保护的备用通道漏洞 (CWE-420) 造成的。攻击者可以利用此漏洞获得初始访问权限，然后通过 CVE-2023-20273 进一步提升权限至 root 并植入后门。提供的PoC代码 `implant_scanner.ps1` 实际上是一个检测脚本，用于判断目标系统是否已经被植入后门，通过对比Web页面内容的MD5哈希值来判断。脚本本身没有发现明显的投毒代码，config.json中指定了目标URL和已知的哈希值，用于检测是否存在已知的植入体。因此，该仓库中存在作者隐藏的投毒代码的可能性为0%。利用方式是，首先利用CVE-2023-20198创建一个高权限用户，然后利用CVE-2023-20273提升权限并写入植入体（后门）。

**项目地址:** [mr-r3b00t/CVE-2023-20198-IOS-XE-Scanner](https://github.com/mr-r3b00t/CVE-2023-20198-IOS-XE-Scanner)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #21

**来源**: [CVE-2023-20198-netbell_CVE-2023-20198-Fix.md](../2023/CVE-2023-20198-netbell_CVE-2023-20198-Fix.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权远程攻击者创建特权15用户并控制设备

**影响版本:** 受影响版本众多，详见漏洞库信息

**利用条件:** Web UI功能已启用，设备可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性非常高，因为它已被CISA列入已知被利用漏洞目录，并且Cisco官方也已确认存在活跃的利用。漏洞利用方式如下：

1.  **利用CVE-2023-20198获取初始访问权限:** 未经身份验证的攻击者可以利用此漏洞，通过Web UI创建一个具有特权15（最高权限）的本地用户。
2.  **利用CVE-2023-20273提升权限至Root:** 攻击者创建本地用户后，可以利用CVE-2023-20273进一步提升权限至root，并将恶意程序写入文件系统，实现完全控制。

提供的漏洞利用代码（Ansible playbook）实际上是一个缓解措施，旨在禁用Web UI以阻止利用。虽然主要目的是缓解漏洞，但该仓库中存在一定投毒风险。例如:

*   **inventory.yml中的凭据:**  该文件包含默认用户名和密码（admin/admin_password），这可能会被粗心的用户直接用于生产环境，从而使系统暴露于风险之中。
*   **依赖的安全性:**  Ansible playbook的安全性取决于控制机本身的安全。如果控制机被攻破，攻击者可以修改playbook或inventory，从而造成更大范围的损害。

因此，虽然Playbook本身主要是用于缓解漏洞，但配置不当可能导致其他安全问题，存在潜在的投毒风险。务必负责任地存储凭据，使用Ansible Vault或其他安全方法来保护敏感信息。

**项目地址:** [netbell/CVE-2023-20198-Fix](https://github.com/netbell/CVE-2023-20198-Fix)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #22

**来源**: [CVE-2023-20198-ohlawd_CVE-2023-20198.md](../2023/CVE-2023-20198-ohlawd_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，可导致完全控制受影响系统

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他特定版本

**利用条件:** 需要目标设备启用Web UI功能

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。攻击者可以利用此漏洞，在未经身份验证的情况下，通过发送特制请求创建一个具备特权级别15的本地用户，从而获得对设备的完全控制权。由于提供的POC代码仅打印"how bout u exploit d33z nuts"，并没有实际利用漏洞的代码，所以判断其为无效的POC，且具有100%的投毒风险。漏洞利用方式包括：首先利用CVE-2023-20198漏洞获得初始访问权限，然后执行特权15命令以创建本地用户和密码组合。之后，攻击者可能利用CVE-2023-20273漏洞，利用新创建的本地用户将权限提升为root，并将植入程序写入文件系统。

**项目地址:** [ohlawd/CVE-2023-20198](https://github.com/ohlawd/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #23

**来源**: [CVE-2023-20198-raystr-atearedteam_CVE-2023-20198-checker.md](../2023/CVE-2023-20198-raystr-atearedteam_CVE-2023-20198-checker.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI Privilege Escalation

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可能导致完全控制受影响的设备

**影响版本:** 16.1.1 to 17.12.1a 等多个版本 (参考漏洞库信息)

**利用条件:** Web UI功能必须启用，且设备可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-20198 允许未经身份验证的攻击者在受影响的系统上创建一个具有特权级别 15 访问权限的帐户。根据搜索引擎的结果，该漏洞已被积极利用。利用方式是，攻击者首先利用此漏洞获得初始访问权限，然后发出特权 15 命令来创建本地用户和密码组合。然后，攻击者利用另一个漏洞 (CVE-2023-20273) ，利用新创建的本地用户将权限提升为 root 并在文件系统中写入植入程序。 

提供的POC代码尝试通过向 `/webui/logoutconfirm.html` 发送带有 `logon_hash=1` 的POST请求来探测漏洞。如果响应状态码为200，并且响应内容的长度小于32个字符，则可能存在漏洞。POC代码扫描指定的子网，并尝试利用漏洞。 

关于投毒风险，POC代码本身相对简单，主要是网络扫描和HTTP请求。虽然不能完全排除恶意修改的可能性，但代码结构清晰，功能直接，隐藏恶意代码的概率较低。 投毒风险评估较低，大约5%。主要的风险点在于：
1.  **依赖未验证的requests库**：如果requests库本身被投毒，则会影响此脚本。
2.  **成功标志的判断**: 响应内容长度小于32可能是判断依据不足，如果恶意修改，可能导致误报或者漏报，将正常设备标记为存在漏洞，引导使用者进行进一步的恶意操作。

**项目地址:** [raystr-atearedteam/CVE-2023-20198-checker](https://github.com/raystr-atearedteam/CVE-2023-20198-checker)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #24

**来源**: [CVE-2023-20198-reket99_Cisco_CVE-2023-20198.md](../2023/CVE-2023-20198-reket99_Cisco_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，可导致完全控制受影响的Cisco IOS XE设备

**影响版本:** 16.1.1 to 17.12.1 (部分版本)

**利用条件:** Web UI功能已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。攻击者可以利用此漏洞，在未经身份验证的情况下，创建一个具有特权级别15（完全访问所有命令）的本地用户。接下来，攻击者可以利用CVE-2023-20273，通过新创建的本地用户提升权限至root并在文件系统中写入植入物。漏洞利用流程如下：

1.  **CVE-2023-20198 利用:**  未经验证的攻击者通过发送特制的POST请求到`/webui/logoutconfirm.html`，绕过身份验证，创建一个具有管理员权限的新用户。
2.  **CVE-2023-20273 利用:** 使用步骤1中创建的管理员用户，利用另一个Web UI组件中的漏洞，提升权限到root，并写入恶意植入物。

提供的POC代码尝试通过向目标IP地址的`/webui/logoutconfirm.html`发送POST请求来验证漏洞是否存在。如果响应状态码为200，并且响应长度较短（小于32字节），则认为该IP地址易受攻击。然后，脚本会使用curl再次发送请求，如果返回特定的输出长度，则确认漏洞存在。

**关于投毒风险:**

虽然该脚本的主要目的是验证漏洞的存在，但仍然存在一定的投毒风险。风险点在于subprocess.run函数中，使用shell=True来执行curl命令。这使得代码容易受到命令注入攻击，如果攻击者能够控制IP地址或相关参数，则可能执行任意命令。 此外，脚本会将成功利用漏洞的IP地址记录到results.csv 文件中，这虽然不是恶意行为，但可能被恶意行为者利用。投毒风险评估为10%，主要是因为使用了subprocess.run(shell=True)执行外部命令。

**项目地址:** [reket99/Cisco_CVE-2023-20198](https://github.com/reket99/Cisco_CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #25

**来源**: [CVE-2023-20198-sanan2004_CVE-2023-20198.md](../2023/CVE-2023-20198-sanan2004_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响的系统

**影响版本:** 16.1.1 至 17.12.3 以及其他版本

**利用条件:** 目标系统启用了Web UI功能，且位于网络可达范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 存在于 Cisco IOS XE 软件的 Web UI 中。该漏洞允许未经身份验证的攻击者通过不正确的路径验证绕过 Nginx 过滤，访问 `webui_wsma_http` Web 端点，从而可以执行任意 Cisco IOS 命令或进行配置更改，获得 Privilege 15 权限。该漏洞利用涉及两个 XML SOAP 端点：`cisco:wsma-exec` 和 `cisco:wsma-config`。攻击者可以使用 `cisco:wsma-exec` 端点将命令插入到 `execCLI` 元素标记中，例如获取运行配置或执行任意命令。攻击者还可以使用 `cisco:wsma-config` 端点添加具有 Privilege 15 的新用户。随附的 PoC 脚本提供检查漏洞、获取配置、执行命令以及添加/删除用户的功能。PoC 代码的投毒风险较低 (10%)，主要风险在于不熟悉该漏洞的人员可能意外地在生产环境中执行恶意命令，或在测试时使用了存在后门的IOS版本。脚本本身旨在利用漏洞，并且不包含任何明显的恶意或隐藏功能，仓库的README.md声明了此POC的利用方式,降低了隐藏的恶意代码的风险。

**漏洞利用方式：**

1.  **利用 CVE-2023-20198 绕过身份验证：** 攻击者构造特制的 URL 访问易受攻击的 Web UI 端点。
2.  **提升权限：** 成功绕过身份验证后，攻击者可以利用 `cisco:wsma-exec` 或 `cisco:wsma-config` SOAP接口下发命令。
3.  **创建特权用户：** 攻击者创建一个具有 Privilege 15 权限的新用户，从而获得对系统的完全控制。
4.  **执行任意命令：** 攻击者可以使用提权的会话执行任意 Cisco IOS 命令，包括安装后门、修改配置或窃取敏感信息。

**项目地址:** [sanan2004/CVE-2023-20198](https://github.com/sanan2004/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #26

**来源**: [CVE-2023-20198-securityphoenix_cisco-CVE-2023-20198-tester.md](../2023/CVE-2023-20198-securityphoenix_cisco-CVE-2023-20198-tester.md)

## CVE-2023-20198-Cisco IOS XE Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的攻击者创建具有特权15的本地用户，从而完全控制设备

**影响版本:** 受影响的版本包括 16.1.1 到 17.12.1 以及其他版本

**利用条件:** Web UI 功能必须已启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞信息和搜索结果，CVE-2023-20198 允许未经身份验证的攻击者在受影响的 Cisco IOS XE 设备上创建具有 privilege level 15 （最高权限）的本地用户。漏洞利用涉及向 Web UI 发送特制的 HTTP POST 请求，绕过身份验证机制。创建具有最高权限的用户后，攻击者可以使用该账户执行任意命令，并完全控制设备。提供的 `cisco_tester.py` 脚本旨在检测目标设备是否受到 CVE-2023-20198 的影响。它通过向 `/webui/logoutconfirm.html?logon_hash=1` 发送 POST 请求，并检查响应中是否包含特定的字符串 `1a80b7389ccd0a5dab` 来判断设备是否已被入侵。该字符串很可能是一个被利用的设备的特征。

**有效性:**

根据漏洞库信息、搜索结果（特别是 https://www.horizon3.ai/attack-research/attack-blogs/cisco-ios-xe-cve-2023-20198-deep-dive-and-poc/）和漏洞利用代码，该漏洞的利用是有效的，已经有公开可用的PoC。

**投毒风险:**

提供的Python脚本本身主要是一个检测工具，用于检查Cisco设备是否受到CVE-2023-20198的影响，它通过检测特定Hash值判断系统是否已经被植入后门。该脚本逻辑比较简单，主要功能为发送HTTP请求并匹配特定字符串。风险点可能在于脚本对异常的处理不够严谨，如果目标存在其他漏洞，可能被利用，但从代码本身来看，投毒的可能性较低，例如作者没有隐藏恶意的代码执行、数据窃取等行为。可以认为投毒风险极低，可能性约为1%。

**利用方式:**

1.  **未经身份验证的权限提升:**  攻击者利用 CVE-2023-20198 在 Cisco IOS XE 设备上创建一个具有最高权限 (privilege level 15) 的本地用户。
2.  **初始访问:**  利用漏洞绕过 Web UI 的身份验证机制。
3.  **命令执行:**  使用新创建的特权用户账户登录并执行任意命令，实现对设备的完全控制。
4.  **植入后门:** 利用CVE-2023-20273，提升权限至root,写入后门文件。

总而言之，此漏洞允许攻击者完全控制受影响的Cisco设备，风险极高。

**项目地址:** [securityphoenix/cisco-CVE-2023-20198-tester](https://github.com/securityphoenix/cisco-CVE-2023-20198-tester)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #27

**来源**: [CVE-2023-20198-smokeintheshell_CVE-2023-20198.md](../2023/CVE-2023-20198-smokeintheshell_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权用户创建特权用户并执行任意命令

**影响版本:** 受影响版本包括16.1.1到17.12.1等多个版本

**利用条件:** 需要目标设备启用Web UI功能，且攻击者能够网络访问该Web UI。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。该漏洞源于对 Nginx 过滤器的不当路径验证，允许未经身份验证的攻击者绕过身份验证访问 `webui_wsma_http` Web 端点。

**利用方式：**

1.  攻击者利用漏洞绕过身份验证，向 `webui_wsma_http` 端点发送特制的 XML SOAP 请求。
2.  攻击者可以使用 `cisco:wsma-exec` SOAP 端点执行任意 Cisco IOS 命令，或者使用 `cisco:wsma-config` SOAP 端点创建具有 Privilege 15 权限的本地用户。
3.  创建具有 Privilege 15 权限的用户后，攻击者可以使用该用户登录并执行任何操作。
4.  结合CVE-2023-20273，攻击者可以进一步提升权限至root，并写入植入程序。

**有效性：**

根据漏洞描述和提供的漏洞利用代码，该漏洞利用是有效的。漏洞利用代码包含检查漏洞是否存在、获取 Cisco IOS 运行配置、执行任意 Cisco IOS 命令以及添加/删除特权用户的功能。搜索引擎结果也表明该漏洞已被 активно利用。

**投毒风险：**

分析提供的漏洞利用代码（exploit.py），发现以下潜在风险：

*   虽然代码本身看起来直接实现了漏洞利用，但仍然存在作者在代码中加入恶意行为的可能性。
*   例如，可以修改添加用户的函数，在创建高权限用户的同时，静默地执行其他恶意配置更改（如添加后门路由或修改系统日志设置）。
*   代码中使用了多个 SOAP 端点，虽然文档中只提到了 `cisco:wsma-exec` 和 `cisco:wsma-config`，但作者可能利用其他未公开的端点执行恶意操作。
*   因此，需要仔细审查代码的每一行，特别是与网络请求和配置更改相关的部分，以确保没有隐藏的恶意逻辑。
*  根据代码内容，未发现明显的恶意代码，但由于该漏洞可以创建高权限用户，如果攻击者利用该漏洞，完全可以植入后门，存在投毒风险。
*  代码本身风险较低，投毒风险主要体现在被攻击者利用后实施的恶意行为，故将风险调整为10%。

**项目地址:** [smokeintheshell/CVE-2023-20198](https://github.com/smokeintheshell/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #28

**来源**: [CVE-2023-20198-sohaibeb_CVE-2023-20198.md](../2023/CVE-2023-20198-sohaibeb_CVE-2023-20198.md)

# CVE-2023-20198

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-20198-Arshit01_CVE-2023-20198.md](../2023/CVE-2023-20198-Arshit01_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI权限提升漏洞

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响的Cisco设备

**影响版本:** 16.1.1 to 17.12.1及部分17.x版本

**利用条件:** Web UI功能已启用，且目标设备存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。未经身份验证的攻击者可以利用此漏洞创建具有特权级别15（最高权限）的本地用户，从而完全控制受影响的设备。利用过程分为两个阶段：首先利用CVE-2023-20198创建用户，其次利用CVE-2023-20273提升权限至root并写入植入程序。

**漏洞利用方式：**

1.  **身份验证绕过：** 漏洞允许未经身份验证的攻击者与设备的Web UI进行交互。
2.  **创建特权用户：** 攻击者发送特制的SOAP请求到Web UI，该请求绕过身份验证并允许攻击者创建一个具有特权级别15的新用户。
3.  **远程控制：** 创建具有最高权限的用户后，攻击者可以使用此帐户登录设备，并执行任意命令。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的POC代码，可以确认POC代码是有效的。搜索结果中的文章提到了漏洞的成功利用和概念验证代码的存在。POC代码也显示了通过发送特制的XML SOAP请求来创建新用户的机制。

**投毒风险：**

提供的POC代码存在轻微的投毒风险，约为10%。风险点分析如下：

*   **默认用户名和密码：** POC代码使用了默认的用户名（shellsmoke）和密码（pwned）。虽然这方便了漏洞测试，但如果未经修改直接用于攻击，很容易被检测到或被其他人利用。
*   **硬编码的URI：** POC中`exURI = '%2577eb%2575i_%2577sma_Http'`，如果攻击者修改此URI植入恶意代码，可能会导致拒绝服务或者其他恶意行为。
*   **命令执行：** 漏洞本身允许执行任意命令，攻击者可能通过植入恶意命令来感染设备。

需要注意的是，以上只是一些潜在的风险点，具体的投毒行为还需要进一步分析。POC的主要功能是验证漏洞的存在，而非恶意利用。因此，将其判定为具有投毒代码是不准确的。

**项目地址:** [Arshit01/CVE-2023-20198](https://github.com/Arshit01/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #2

**来源**: [CVE-2023-20198-Atea-Redteam_CVE-2023-20198.md](../2023/CVE-2023-20198-Atea-Redteam_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Software Web UI权限提升漏洞

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，未经身份验证的攻击者可以创建具有特权级别15访问权限的帐户，并最终导致完全控制受影响的系统。

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1以及17.11.99SW等众多版本

**利用条件:** Web UI 功能必须启用。需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个关键漏洞。未经身份验证的远程攻击者可以利用此漏洞在受影响的系统上创建具有特权级别 15（完全访问所有命令）的帐户。利用方式是攻击者发送特制的 HTTP 请求到 `/webui/logoutconfirm.html?logon_hash=1` 路径，绕过身份验证，并执行特权命令以创建本地用户和密码组合。创建用户后，攻击者可以利用另一个漏洞（CVE-2023-20273）提升权限至 root 并写入植入程序到文件系统。提供的 Python 脚本 `CVE-2023-20198.py` 旨在检测是否存在该漏洞，并检查已知的 IOC。  该脚本扫描指定子网，并检查目标设备是否返回预期的响应状态码和内容长度。投毒风险评估：脚本本身主要用于检测，但由于脚本包含发送特定请求到目标设备的逻辑，如果攻击者修改此脚本，可能会加入恶意负载或更改用户创建的用户名/密码，存在一定的投毒风险.脚本中存在User-Agent:Atea Red Team CVE-2023-20198 checkscript特征,可能被安全设备检测到。存在的风险点是如果未经授权的人员使用了修改后的脚本，可能会对网络造成损害。 README.md文件没有发现异常。

**项目地址:** [Atea-Redteam/CVE-2023-20198](https://github.com/Atea-Redteam/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #3

**来源**: [CVE-2023-20198-DOMINIC471_qub-network-security-cve-2023-20198.md](../2023/CVE-2023-20198-DOMINIC471_qub-network-security-cve-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权级别15的账户，完全控制受影响的设备。

**影响版本:** 受影响版本众多，包括16.1.1到17.12.1以及其他版本（详见漏洞库信息）。

**利用条件:** Web UI功能必须已启用。设备需要可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞允许未经身份验证的攻击者在Cisco IOS XE设备上创建具有特权级别15（最高权限）的本地用户。攻击者通过利用Web UI中的漏洞绕过身份验证，并执行特权命令创建用户。结合另一个漏洞CVE-2023-20273，攻击者可以进一步提升权限至root并写入植入程序到文件系统。 

**有效性评估：**
根据提供的漏洞库信息和搜索结果，CVE-2023-20198是一个严重漏洞，已被积极利用。

**投毒风险评估：**
查看提供的POC代码，包括README.md和IOC Summary.md文件。 README.md主要描述了如何分析、检测和缓解此漏洞。IOC Summary.md列出了攻击者IP，受害者IP，使用的header以及payload等。这些信息可以辅助蓝队进行防御。
总体来说，该仓库的目的是为了分析和缓解漏洞，并没有发现明显的投毒代码。但是，由于代码中可能包含攻击载荷或恶意命令示例，如果使用者不小心，可能会误用这些代码进行非授权的渗透测试，从而导致法律风险。因此，评估的投毒风险为10%。

**利用方式：**
1.  **未授权访问：** 攻击者利用漏洞，绕过Web UI的身份验证机制。
2.  **创建特权用户：** 攻击者通过发送特制的HTTP请求，执行CLI命令，创建一个具有特权级别15的本地用户。
3.  **持久化（结合CVE-2023-20273）：** 攻击者利用新创建的本地用户登录，并利用另一个漏洞（CVE-2023-20273）提升权限到root，并在文件系统中写入植入程序，实现持久化控制。

**缓解措施：**
*   禁用Web UI功能，如果不需要使用。
*   升级到已修复漏洞的IOS XE软件版本。
*   使用入侵检测/防御系统（IDS/IPS）检测和阻止利用此漏洞的攻击。
*   检查设备上是否存在异常用户和植入程序。

**项目地址:** [DOMINIC471/qub-network-security-cve-2023-20198](https://github.com/DOMINIC471/qub-network-security-cve-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #4

**来源**: [CVE-2023-20198-G4sul1n_Cisco-IOS-XE-CVE-2023-20198.md](../2023/CVE-2023-20198-G4sul1n_Cisco-IOS-XE-CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权15权限的本地用户，结合CVE-2023-20273可提升至root权限并植入后门。

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他相关版本，具体参见漏洞库信息。

**利用条件:** 需要目标系统启用Web UI功能，且网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。根据漏洞信息和搜索结果，该漏洞允许未经身份验证的远程攻击者在受影响的系统上创建一个具有特权级别 15 访问权限的帐户。Cisco的公告指出，攻击者首先利用此漏洞获得初始访问权限，然后执行特权 15 命令以创建本地用户和密码组合。随后，攻击者利用 CVE-2023-20273 将权限提升到 root 并将植入程序写入文件系统。根据提供的漏洞利用代码，该 PoC 包含以下功能：

*   **漏洞检查**：通过执行 `uname -a` 命令来验证漏洞是否存在。
*   **获取 Cisco 配置**：执行 `sh run` 命令来提取运行配置。
*   **执行命令**：允许执行任意 Cisco IOS 命令，但警告需要谨慎使用，因为没有输入验证。
*   **添加用户**：创建一个新的特权 15 用户帐户，可以选择指定用户名和密码。
*   **删除用户**：从设备中删除用户帐户。

**有效性：**

该 PoC 代码的有效性较高，因为漏洞库信息和搜索结果都表明该漏洞已被 активно используется。此外，该 PoC 提供了多种利用方式，包括漏洞检查、信息收集和权限提升。

**投毒风险：**

尽管 PoC 代码主要用于利用已知的漏洞，但仍存在一定的投毒风险，估计为10%。风险点包括：

*   **命令执行**：通过 `-e` 选项执行任意命令，攻击者可能利用此功能执行恶意操作。
*   **用户管理**：虽然提供了添加和删除用户的选项，但如果被滥用，可能导致拒绝服务或系统损坏。

虽然PoC代码本身看起来是为了复现漏洞，但不能完全排除代码作者在其中隐藏恶意功能的可能性，例如植入后门、收集敏感信息等。因此，在使用 PoC 代码时，需要进行仔细审查和安全评估。

**利用方式：**

1.  **未经身份验证的访问**：利用 CVE-2023-20198 绕过身份验证，访问 `webui_wsma_http` Web 端点。
2.  **创建特权用户**：使用 `cisco:wsma-config` SOAP 端点创建一个具有特权 15 的新用户帐户。
3.  **执行任意命令**：使用 `cisco:wsma-exec` SOAP 端点执行任意 Cisco IOS 命令。
4.  **权限提升 (结合 CVE-2023-20273)**：利用新创建的特权用户，结合 CVE-2023-20273 将权限提升到 root，并在系统上植入后门。

总而言之，CVE-2023-20198 是一个严重的安全漏洞，需要立即采取措施进行修复。在使用 PoC 代码时，需要谨慎评估风险，并确保在受控环境中进行测试。

**项目地址:** [G4sul1n/Cisco-IOS-XE-CVE-2023-20198](https://github.com/G4sul1n/Cisco-IOS-XE-CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #5

**来源**: [CVE-2023-20198-IceBreakerCode_CVE-2023-20198.md](../2023/CVE-2023-20198-IceBreakerCode_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权级别 15 的帐户，从而完全控制设备

**影响版本:** 16.1.1 to 17.12.1 and earlier versions

**利用条件:** Web UI 功能已启用并且设备易受攻击版本的影响。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个漏洞，允许未经身份验证的远程攻击者在受影响的系统上创建具有特权级别 15 访问权限的帐户。 

**漏洞利用方式：**

1.  攻击者发送一个特制的 HTTP POST 请求到 `/webui/logoutconfirm.html?logon_hash=1` 端点，绕过身份验证。
2.  成功利用此漏洞后，攻击者可以执行任意命令，包括创建具有特权级别 15 的本地用户。
3.  然后，攻击者使用另一个漏洞（CVE-2023-20273）并通过新创建的本地用户权限提升到 root 权限，并将植入程序写入文件系统。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判定该漏洞的POC代码是有效的。漏洞库信息明确指出存在正在进行的漏洞利用活动。搜索结果也提供了多个关于该漏洞的深度分析和POC示例的链接，例如horizon3.ai上的POC代码。
提供的python脚本模拟了发送特制HTTP请求的过程，旨在检测目标系统是否存在漏洞。脚本会检查HTTP响应状态码和响应体内容，以判断是否存在潜在的植入程序。

**投毒风险：**

评估POC代码的投毒风险，需要仔细分析代码是否存在恶意行为，例如：
1.  **植入后门：**  代码是否在目标系统上安装未经授权的后门。
2.  **数据窃取：**  代码是否窃取敏感信息并发送到外部服务器。
3.  **拒绝服务：**  代码是否导致目标系统崩溃或无法正常运行。
4.  **恶意传播：**  代码是否试图感染其他系统。

分析提供的python脚本，该脚本主要用于检测漏洞是否存在，并未发现明显的恶意行为。脚本的功能是发送特定的HTTP请求并检查响应，以确定目标系统是否受到CVE-2023-20198漏洞的影响。然而，使用任何未经授权的漏洞利用代码都存在风险，因为代码的作者可能隐藏了不易察觉的恶意功能。因此，在使用任何POC代码之前，务必进行彻底的安全审查。

考虑到以上因素，判定该POC代码存在10%的投毒风险，主要是由于作者可能隐藏了一些不易察觉的恶意代码，但主要功能是漏洞验证。

**缓解措施：**

*   禁用 Web UI 功能，特别是当设备面向互联网时。
*   将 Web UI 访问限制为受信任的网络。
*   升级到已修复漏洞的 Cisco IOS XE 软件版本。

**项目地址:** [IceBreakerCode/CVE-2023-20198](https://github.com/IceBreakerCode/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #6

**来源**: [CVE-2023-20198-JoyGhoshs_CVE-2023-20198.md](../2023/CVE-2023-20198-JoyGhoshs_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可导致完全控制受影响设备

**影响版本:** 受影响版本范围广泛，详见漏洞库信息

**利用条件:** Web UI功能已启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198 允许未经身份验证的攻击者在受影响的系统上创建具有权限级别15（完全访问权限）的帐户。该漏洞利用方式如下：

1.  **初始访问:** 攻击者利用CVE-2023-20198漏洞，通过Web UI创建具有高权限的本地用户。
2.  **权限提升:** 然后，攻击者可能利用CVE-2023-20273（另一个漏洞）或使用新创建的本地用户进一步将权限提升至root。
3.  **植入后门:** 攻击者利用获得的root权限，在文件系统中写入恶意植入。

提供的POC代码`poc.py`是一个**检测工具**，而非完整的漏洞利用代码。它通过发送一个特定的HTTP请求到`/webui/logoutconfirm.html?logon_hash=1`，并检查响应内容是否为十六进制字符串来判断目标是否可能受到了攻击并植入了后门。如果响应是十六进制字符串，则表明设备可能已遭入侵，并存在植入的后门（该后门会返回hex信息）。

该存储库中的`README.md`文件说明，此脚本并非完整的POC，仅用于检查是否存在hex响应。因此，它无法直接用于漏洞利用，而只能用于检测。

**投毒风险分析：**

查看`poc.py`文件内容，发现其功能主要是发送HTTP请求并判断响应内容。该代码的功能比较简单，未发现任何可能导致恶意行为（例如，上传恶意文件、执行任意命令等）的可疑代码。因此，可以认为该存储库不存在作者隐藏的投毒代码。



**项目地址:** [JoyGhoshs/CVE-2023-20198](https://github.com/JoyGhoshs/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #7

**来源**: [CVE-2023-20198-Pushkarup_CVE-2023-20198.md](../2023/CVE-2023-20198-Pushkarup_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的远程攻击者创建管理员账户并完全控制设备

**影响版本:** 受影响版本详见CVE描述

**利用条件:** 目标设备启用了Web UI功能，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞存在于 Cisco IOS XE 软件的 Web UI 中。未经身份验证的远程攻击者可以通过利用此漏洞在受影响的系统上创建具有特权级别 15 访问权限的帐户。创建账户后，攻击者可以使用该账户完全控制受损的机器。

**有效性：**
提供的 POC 代码根据描述能够创建本地用户，安装植入体，重启Web服务，并检查植入体的状态，因此具备有效性。

**投毒风险：**
此仓库中可能存在作者隐藏的投毒代码。尽管自述文件声明 PoC 仅用于教育目的，并且使用需要遵守道德规范，但攻击者可以修改 `config_content` 以包含恶意配置，例如更改防火墙规则或执行其他恶意操作。此外，虽然代码本身没有明显的恶意行为，但其目的是在目标系统上创建具有管理权限的用户，这本身就可以被认为是恶意的。因此，存在一定的投毒风险，但是相对较低，风险评估在10%。此风险评估基于以下因素：
    *   代码可能被用于未授权的系统访问。
    *   配置文件可被修改为包含恶意指令。

**利用方式：**
1.  攻击者利用 CVE-2023-20198 漏洞，通过未授权访问在 Cisco IOS XE 设备上创建一个具有特权级别 15 的本地用户。
2.  攻击者使用新创建的管理员账户登录到设备。
3.  攻击者利用 CVE-2023-20273 漏洞，进一步提升权限至 root 级别，并将恶意植入程序写入文件系统。
4.  攻击者通过植入的后门程序远程控制设备，执行恶意操作，例如数据窃取、网络攻击等。
根据搜索结果，CISA 已将此漏洞添加到已知被利用的漏洞目录中，表明该漏洞已经被广泛利用。

**项目地址:** [Pushkarup/CVE-2023-20198](https://github.com/Pushkarup/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #8

**来源**: [CVE-2023-20198-RevoltSecurities_CVE-2023-20198.md](../2023/CVE-2023-20198-RevoltSecurities_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，可被未授权的攻击者利用创建特权用户，进而完全控制系统。

**影响版本:** 受影响的版本包括16.1.1到17.12.1以及其他一系列17.x版本 (详见漏洞库信息)

**利用条件:** 目标设备启用Web UI功能，并且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。根据漏洞库信息和搜索引擎结果，未经身份验证的攻击者可以利用此漏洞在受影响的系统上创建一个具有 15 级权限（最高权限）的帐户。随后攻击者再利用CVE-2023-20273，将权限提升至root，并写入植入体。该漏洞的利用方式如下：

1.  **漏洞触发：** 攻击者发送特制的HTTP请求到Cisco IOS XE设备的Web UI接口，绕过身份验证。
2.  **创建特权用户：** 请求中包含特定的XML内容，该内容允许攻击者创建一个新的本地用户，并分配最高权限（privilege level 15）。
3.  **权限提升：** 攻击者利用创建的特权用户登录系统。
4.  **植入后门：** 攻击者通过Web UI的另一个组件（CVE-2023-20273）将权限提升至root并写入植入体。

**有效性：** 根据搜索引擎结果（特别是horizon3.ai的POC）以及提供的漏洞利用代码，此漏洞利用是有效的。漏洞利用代码仓库提供了一个Python脚本，可以检测和利用此漏洞。

**投毒风险：** 漏洞利用代码仓库的投毒风险评估为10%。虽然该仓库提供了看似合理的漏洞利用脚本，但存在以下潜在风险点：

*   **自定义配置内容：** 脚本允许用户提供自定义的配置内容（`-cfc` 或 `--config-content` 参数），这可能被滥用以注入恶意代码或配置。
*   **隐蔽后门：** 虽然主要功能是利用漏洞，但作者可能在代码中添加了不易察觉的后门，例如收集目标信息、执行任意命令等。代码量较少，通读代码可以降低风险。

**防范措施：**

*   立即更新Cisco IOS XE软件到已修复的版本。
*   禁用Web UI功能，如果不需要。
*   监控网络流量，检测异常的Web UI请求。
*   使用Cisco提供的软件检查工具来识别和移除潜在的植入体。

**项目地址:** [RevoltSecurities/CVE-2023-20198](https://github.com/RevoltSecurities/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #9

**来源**: [CVE-2023-20198-Shadow0ps_CVE-2023-20198-Scanner.md](../2023/CVE-2023-20198-Shadow0ps_CVE-2023-20198-Scanner.md)

## CVE-2023-20198 Cisco IOS XE Web UI 权限提升漏洞

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权 15 权限的本地用户，从而完全控制受影响的设备。

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1 以及 17.11.99SW

**利用条件:** Web UI 功能必须已启用。攻击者需要能够通过网络访问设备的 Web UI。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。未经身份验证的远程攻击者可以利用此漏洞在受影响的系统上创建一个具有特权 15 访问权限的帐户，本质上是管理员权限。漏洞利用通常与另一个漏洞 CVE-2023-20273 结合使用，后者用于将权限提升到 root 并将植入程序写入文件系统。

**漏洞利用有效性：**

根据漏洞库信息、搜索引擎结果（特别是 horizon3.ai 的 PoC 描述）以及提供的漏洞利用代码片段来看，该漏洞的利用是有效的。存在公开可用的 PoC，允许攻击者绕过身份验证创建具有管理权限的用户。

**投毒风险分析：**

提供的代码片段分析表明，攻击流程依赖于 Nginx 配置和一个 Lua 脚本。Lua 脚本的核心功能在于身份验证绕过和命令执行。脚本通过检查是否存在特定的 "Authorization" Header以及Header的内容是否和通过REDACTED命令执行结果匹配来确定请求是否被授权。

由于 "REDACTED" 信息的缺失，我们无法完全确定是否存在恶意投毒代码。但是lua脚本的下列行为存在潜在的投毒风险：

1.  **外部命令执行:** 脚本多次使用 `io.popen()` 执行外部命令。如果这些命令包含恶意参数或旨在下载和执行其他代码，则可能导致系统受损。
2.  **硬编码的凭据和逻辑：**脚本逻辑依赖于特定的哈希值和其他硬编码的字符串。攻击者可能会修改这些字符串以创建变体，从而绕过安全检测或植入后门。
3.  **对/lua5的请求:** 当common_type=iox时,会调用/lua5,如果/lua5是作者控制的地址,则存在投毒风险。

基于以上分析，虽然无法确定明确的投毒代码，但脚本中使用的技术（尤其是外部命令执行）增加了被用于恶意目的的可能性，估计投毒风险为20%。

**漏洞利用方式：**

1.  **未授权访问:** 攻击者发送一个特制的 HTTP POST 请求到 `/webui/logoutconfirm.html`，绕过身份验证检查（利用 CVE-2023-20198）。这可能涉及到提供特定的 `Authorization` header，该header的值能够通过预设的验证。
2.  **创建高权限用户:** 绕过身份验证后，攻击者可以发送包含创建新用户（具有特权级别 15）的命令的请求体。该命令通过 `io.popen()` 执行，从而创建一个具有管理员权限的本地用户。
3.  **权限提升和植入：** (结合 CVE-2023-20273) 使用新创建的本地用户登录并利用 CVE-2023-20273 将权限提升至 root，从而能够在设备上安装植入程序。


**项目地址:** [Shadow0ps/CVE-2023-20198-Scanner](https://github.com/Shadow0ps/CVE-2023-20198-Scanner)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #10

**来源**: [CVE-2023-20198-Tounsi007_CVE-2023-20198.md](../2023/CVE-2023-20198-Tounsi007_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可能导致完全控制受影响设备

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他版本

**利用条件:** 目标设备启用了Web UI功能并且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞存在于Cisco IOS XE Software的Web UI中，允许未经身份验证的远程攻击者创建一个具有特权级别15（完全访问权限）的本地用户帐户。该漏洞利用方式是通过发送特制的HTTP请求到`/webui/create_user`路径来创建用户。攻击者随后可利用创建的用户并通过另一个漏洞CVE-2023-20273提升权限至root并写入植入程序。提供的POC代码尝试模拟此过程，包括创建用户、安装植入程序、重启Web服务器、检查植入程序状态以及清理创建的用户。 

**有效性：**根据漏洞信息、搜索结果和提供的POC代码，该漏洞是有效的。搜索引擎结果表明该漏洞已被积极利用，并且存在公开可用的POC代码。CISA的已知被利用漏洞目录也收录了该漏洞。

**投毒风险：**POC代码本身存在一定的风险。虽然代码的主要功能是利用漏洞，但`config_content`变量表明存在植入恶意配置的可能性。 用户需要手动插入植入配置,存在被植入后门的风险。
该仓库readme描述，POC仅用于测试和学习，有免责声明。存在一定概率作者未充分测试。

**利用方式：**
1.  **初始访问：** 未经身份验证的攻击者发送特制HTTP请求到存在漏洞的Cisco IOS XE设备的Web UI接口。
2.  **用户创建：**  利用CVE-2023-20198，攻击者通过`/webui/create_user`接口创建一个具有管理员权限的新用户。
3.  **权限提升（CVE-2023-20273）：** 利用新创建的用户，攻击者可以进一步利用Web UI中的另一个漏洞（CVE-2023-20273）来提升权限至root。
4.  **植入后门：** 攻击者可以写入植入程序到文件系统。
5.  **持久化：** 植入程序可以用于维持对受感染设备的访问。
6.  **清理（可选）：** 攻击者可以选择删除他们创建的后门账户，以隐藏其踪迹。

**项目地址:** [Tounsi007/CVE-2023-20198](https://github.com/Tounsi007/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #11

**来源**: [CVE-2023-20198-Vulnmachines_Cisco_CVE-2023-20198.md](../2023/CVE-2023-20198-Vulnmachines_Cisco_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可使未授权的攻击者获得完全管理权限

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1 以及其他多个版本

**利用条件:** Web UI 功能启用并且 HTTP 或 HTTPS 服务器功能开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个关键身份验证绕过漏洞。根据漏洞信息和搜索结果，攻击者利用此漏洞首先获得初始访问权限，然后执行特权 15 命令来创建一个本地用户和密码组合，从而获得管理员权限。之后，攻击者利用 CVE-2023-20273 将权限提升到 root 并在文件系统中写入植入程序。提供的 POC 代码显示了一个用于利用漏洞的 HTTP POST 请求示例。请求的目标 URI 经过编码处理，绕过了身份验证。请求体包含一个 SOAP 信封，该信封尝试使用默认的 "admin" 用户名执行命令 "uname -a"。有效性：根据搜索结果和漏洞描述，提供的 POST 请求通过身份验证绕过在受影响的设备上创建具有特权 15 的用户，因此 POC 代码有效。 投毒风险：README.md 文件描述了漏洞，并提供了一个关于利用该漏洞的概述。Payload 文件包含一个 SOAP 请求，用于发送 CLI 命令。虽然该请求本身看起来无害（执行 `uname -a` 命令），但攻击者可能会修改该请求以执行恶意命令。例如，更改命令以创建具有特权 15 的用户。 因此，存在一定风险，即此仓库可能被用于传播恶意利用程序。Payload 代码文件本身没有明显的投毒代码，但存在被修改利用的风险，因此判定投毒风险为 10%。利用方式：1. 检查目标 Cisco IOS XE 设备是否启用了 Web UI 功能和 HTTP/HTTPS 服务器。2. 发送构造的 HTTP POST 请求到目标设备，利用身份验证绕过漏洞。3. 请求的目标 URI 经过编码处理以绕过身份验证检查。4. POST 请求的内容为 SOAP 信封，其中包含要执行的 CLI 命令。5. 成功利用后，攻击者可以在设备上执行任意 CLI 命令，例如创建新的管理员帐户或植入恶意软件。

**项目地址:** [Vulnmachines/Cisco_CVE-2023-20198](https://github.com/Vulnmachines/Cisco_CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #12

**来源**: [CVE-2023-20198-W01fh4cker_CVE-2023-20198-RCE.md](../2023/CVE-2023-20198-W01fh4cker_CVE-2023-20198-RCE.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权15的用户，进而完全控制受影响的设备。

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1 等多个版本

**利用条件:** Web UI 功能已启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。未经身份验证的远程攻击者可以利用此漏洞在受影响的系统上创建一个具有特权 15 访问权限的帐户，从而完全控制设备。利用方式如下：

1.  **漏洞触发点：** Cisco IOS XE 软件的 Web UI 组件存在漏洞。
2.  **利用过程：** 攻击者通过发送特制的 SOAP 请求到 `/%%77ebui_wsma_https` 或 `/%%77ebui_wsma_Http` URI (具体取决于是否使用 HTTPS) 绕过身份验证。
3.  **命令执行：** 攻击者使用 `urn:cisco:wsma-config` 命名空间执行 CLI 命令，创建新的具有特权 15 的用户。
4.  **后续利用 (CVE-2023-20273):** 在获得初始访问权限后，攻击者可以利用 CVE-2023-20273 将权限提升为 root 并在文件系统中写入植入程序。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞已被积极利用，提供的 PoC 代码有效，可以用于创建具有特权 15 的用户。

**投毒风险：**

PoC 代码主要功能是利用漏洞，创建新用户，从代码本身来看，存在一些潜在的投毒点，例如：

*   **随机用户名/密码生成：**  虽然代码中包含随机用户名生成函数，但实际使用中，攻击者可能会替换为预设的用户名和密码，方便后续控制。
*   **代理服务器使用：**  PoC 代码支持使用代理服务器，攻击者可以借此隐藏真实 IP 地址，增加溯源难度。
*   **异常处理：**  代码中包含异常处理模块，可能用于隐藏利用过程中的错误信息，避免被发现。
*   **User-Agent:** 使用了常见的User-Agent，但是依然存在替换或者增加其他User-Agent进行恶意攻击.

总体来说，PoC 代码的投毒风险较低，主要集中在以上几点，但需要使用者谨慎使用。

**总结：**

该漏洞利用的有效性很高，并且在野外被广泛利用。PoC 代码可以用来验证漏洞的存在并创建管理员用户，但需要注意潜在的投毒风险。利用方式是发送特制的 SOAP 请求，绕过身份验证，然后执行 CLI 命令。

**项目地址:** [W01fh4cker/CVE-2023-20198-RCE](https://github.com/W01fh4cker/CVE-2023-20198-RCE)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #13

**来源**: [CVE-2023-20198-XiaomingX_cve-2023-20198-poc.md](../2023/CVE-2023-20198-XiaomingX_cve-2023-20198-poc.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响设备

**影响版本:** 受影响版本范围广泛，详见漏洞库信息

**利用条件:** Web UI 功能启用且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 存在于 Cisco IOS XE 软件的 Web UI 中。未经身份验证的攻击者可以利用此漏洞创建具有 privilege level 15 权限的本地用户，从而获得对设备的完全控制权。利用方式主要通过发送特制的 SOAP 请求到目标设备的 Web UI 接口，绕过身份验证，执行 CLI 命令。PoC 代码通过构造恶意的 SOAP 消息，例如 `username <username> privilege 15 secret <password>`，添加高权限用户。 

有效性分析：根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开的 PoC。提供的 PoC 代码实现了漏洞利用的基本功能，包括检查漏洞、获取配置、执行命令和添加/删除用户。因此，提供的 PoC 代码是有效的。

投毒风险分析：代码本身主要实现了漏洞利用功能，但仍然存在一定的投毒风险。体现在以下几个方面：

*   **恶意命令执行：** 虽然代码本身没有硬编码的恶意命令，但 `-e` 参数允许攻击者执行任意 Cisco IOS 命令。攻击者可能会使用此参数注入恶意配置或植入后门。
*   **硬编码凭据：** 默认用户名 `shellsmoke` 和密码 `pwned` 如果不修改，可能被其他攻击者利用。虽然这是一个PoC，但在实际使用中容易被忽视，从而导致设备被二次入侵。
*   **异常处理：** 某些异常处理不够完善，可能导致程序崩溃或泄露敏感信息。
*   **Payload内容:** 在SOAP请求模板中，攻击者可能修改命令或者在ADD_USER的情况下，添加后门账户。

综合考虑，该 PoC 存在一定的投毒风险，但主要集中在用户使用不当或被恶意利用的可能性上，PoC本身是漏洞的利用，投毒代码的可能性评判为 10%。建议使用者在使用 PoC 时仔细审查代码，并采取必要的安全措施。

利用方式总结：

1.  **目标确认：** 确定目标 Cisco IOS XE 设备是否启用了 Web UI 功能。
2.  **发送恶意 SOAP 请求：** 构造包含 CLI 命令的恶意 SOAP 请求，绕过身份验证。
3.  **权限提升：** 利用漏洞创建具有 privilege level 15 权限的本地用户。
4.  **完全控制：** 使用新创建的用户登录并完全控制设备。

**项目地址:** [XiaomingX/cve-2023-20198-poc](https://github.com/XiaomingX/cve-2023-20198-poc)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #14

**来源**: [CVE-2023-20198-ZephrFish_CVE-2023-20198-Checker.md](../2023/CVE-2023-20198-ZephrFish_CVE-2023-20198-Checker.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权15权限的本地用户，随后可能被用于植入后门和完全控制设备

**影响版本:** 受影响版本：16.1.1 到 17.12.1，以及其他相关版本（详见漏洞库信息）

**利用条件:** 目标设备启用了Web UI功能，且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞允许未经身份验证的攻击者在受影响的 Cisco IOS XE 设备上创建一个具有特权 15 权限（最高权限）的本地用户。该漏洞存在于 Web UI 功能中。根据搜索引擎结果和漏洞库信息，此漏洞已被积极利用。提供的漏洞利用代码 `XEImplantScanner.py` 主要用于扫描目标系统是否存在漏洞以及是否被植入后门。该脚本通过发送特定的 HTTP 请求到 `/webui/logoutconfirm.html` 端点来检测漏洞和后门的存在。

**利用方式：**

1.  **初始访问：** 未经身份验证的攻击者发送特制的 HTTP 请求到目标设备的 Web UI。
2.  **权限提升：** 利用 CVE-2023-20198，创建一个具有特权 15 权限的本地用户。
3.  **后门植入（CVE-2023-20273）：** 使用新创建的具有特权的用户，攻击者可以进一步利用另一个漏洞（CVE-2023-20273）来提升权限至 root，并将植入体写入文件系统，实现持久化控制。

**有效性：**

根据搜索引擎结果（例如，horizon3.ai 的文章）和漏洞库信息，CVE-2023-20198 漏洞已被成功利用。提供的 POC 代码 `XEImplantScanner.py` 旨在检测漏洞的存在以及后门的植入，本身不包含直接利用漏洞进行权限提升的代码，需要结合 CVE-2023-20273 来完全控制。

**投毒风险：**

POC 代码 `XEImplantScanner.py` 主要功能是扫描，相对安全。可能的投毒风险在于：

*   **结果误导：** 扫描结果可能被篡改，导致用户误判系统的安全状态。
*   **依赖风险：** 脚本依赖于 `requests` 库，如果 `requests` 库被恶意版本替换，可能导致代码执行。
*   **网络钓鱼:** 脚本可能被用于钓鱼，诱导用户扫描恶意服务器，泄露信息。

因此，评估的投毒风险为 10%。主要是考虑到其扫描器性质，以及依赖库被投毒的可能性。

**项目地址:** [ZephrFish/CVE-2023-20198-Checker](https://github.com/ZephrFish/CVE-2023-20198-Checker)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #15

**来源**: [CVE-2023-20198-alekos3_CVE_2023_20198_Detector.md](../2023/CVE-2023-20198-alekos3_CVE_2023_20198_Detector.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响系统

**影响版本:** 见受影响版本列表

**利用条件:** Web UI 功能已启用,网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。攻击者可以利用此漏洞绕过身份验证，创建一个具有 15 级权限的本地用户，从而完全控制受影响的系统。该漏洞结合 CVE-2023-20273 使用，CVE-2023-20198 用于初始访问，CVE-2023-20273 用于提权至 root 并写入植入程序到文件系统。

**利用方式：**

1.  未经身份验证的攻击者发送特制的HTTP请求到启用了Web UI的Cisco IOS XE设备。
2.  利用CVE-2023-20198漏洞，创建一个具有特权级别15的本地用户。
3.  使用新创建的本地用户利用CVE-2023-20273漏洞，将权限提升到root。
4.  将植入程序写入文件系统，从而完全控制设备。

**POC代码分析：**

提供的Python脚本 (`CVE_2023_20198_detector.py`) 主要用于检测设备是否存在漏洞，而不是利用该漏洞。它通过SSH连接到设备，并运行一些命令来检查Web UI是否启用，并尝试检测是否存在攻击迹象，例如存在`ip http server`, `ip http secure-server`,  `ip http active`配置。脚本通过`netmiko`库实现SSH连接和命令执行。该脚本没有直接创建特权用户的恶意代码，只是用于检测是否存在漏洞。该脚本会生成一个csv文件`Results_CVE_2023_20198_{current_timestamp}.csv` 用于记录检测结果。

**有效性：**

根据搜索引擎结果，存在公开的POC代码，可以创建特权用户。`CVE_2023_20198_detector.py`脚本本身并不能直接利用漏洞，它只能用来检测目标是否存在漏洞。

**投毒风险：**

该脚本的投毒风险极低 (0%)。虽然用户需要输入用户名和密码，但是该脚本只是用来检测是否存在漏洞，没有发现任何可疑的代码或后门，也没有修改系统配置的任何行为。LICENSE文件为标准的MIT License。

**项目地址:** [alekos3/CVE_2023_20198_Detector](https://github.com/alekos3/CVE_2023_20198_Detector)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #16

**来源**: [CVE-2023-20198-emomeni_Simple-Ansible-for-CVE-2023-20198.md](../2023/CVE-2023-20198-emomeni_Simple-Ansible-for-CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可导致完全控制受影响的设备

**影响版本:** 16.1.1 to 17.12.1

**利用条件:** Web UI 功能已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。根据漏洞库信息和搜索引擎结果，未经身份验证的攻击者可以利用此漏洞创建一个具有 15 级权限（完全访问所有命令）的本地用户。攻击者首先利用 CVE-2023-20198 获得初始访问权限，然后执行权限 15 命令来创建本地用户和密码组合，允许该用户以普通用户身份登录。 然后攻击者利用 web UI 功能的另一个组件，利用新的本地用户将权限提升到 root 并将植入程序写入文件系统，cve-2023-20273。

**有效性：**
根据搜索引擎结果（例如Horizon3.ai的博客），已经存在公开可用的PoC，并且漏洞被积极利用。提供的Ansible剧本并不是直接的漏洞利用代码，而是用于检测并禁用HTTP/HTTPS服务器以缓解漏洞。它也能检测是否已经遭受攻击，通过分析syslog。

**投毒风险：**
提供的Ansible剧本的主要目的是缓解漏洞，而不是利用漏洞。虽然其中包含连接到Cisco设备的凭据（developer/lastorangerestoreball8876），但这些是 Cisco Always On Sandbox 的公开凭据，用于测试目的。 投毒风险较低，但仍然存在一些风险：

1.  **凭据滥用：**  即使凭据是公开的，也可能有人修改剧本以使用不同的凭据尝试访问其他Cisco设备。
2.  **远程执行：**  Ansible 剧本在目标设备上执行命令。如果剧本被恶意修改，可能会导致设备配置更改或执行其他恶意操作。 鉴于此，大约有10%的可能性存在投毒风险。

**利用方式：**
1.  **初始访问：**  攻击者利用 CVE-2023-20198 中的漏洞，绕过身份验证。
2.  **创建高权限用户：**  攻击者利用未授权访问，创建一个具有 15 级权限的本地用户。
3.  **权限提升(CVE-2023-20273):** 攻击者利用本地用户权限和Web UI的另一个漏洞，将权限提升到 root。
4.  **植入后门：**  攻击者利用 root 权限，在设备上植入后门，以便长期控制。

**项目地址:** [emomeni/Simple-Ansible-for-CVE-2023-20198](https://github.com/emomeni/Simple-Ansible-for-CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #17

**来源**: [CVE-2023-20198-fox-it_cisco-ios-xe-implant-detection.md](../2023/CVE-2023-20198-fox-it_cisco-ios-xe-implant-detection.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未经身份验证的攻击者创建具有特权15的本地用户，最终导致完全控制受影响的设备

**影响版本:** 受影响版本包括16.1.1至17.12.1 以及其他相关版本

**利用条件:** Web UI功能已启用，设备可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198是Cisco IOS XE Software Web UI中的一个权限提升漏洞。攻击者可以利用此漏洞，在未经身份验证的情况下，通过发送特制的HTTP请求绕过身份验证，并在受影响的系统上创建一个具有最高权限（特权级别15）的本地用户。创建具有特权15的用户后，攻击者可以使用该用户登录设备，执行任意命令，并完全控制受影响的Cisco IOS XE设备。攻击者利用CVE-2023-20198获得初始访问权限后，会进一步利用CVE-2023-20273将权限提升到root级别，并在文件系统中写入恶意植入程序。

**利用方式：**

1.  **未经身份验证的访问：** 攻击者通过发送特制的HTTP请求，绕过Cisco IOS XE Web UI的身份验证机制。
2.  **创建特权用户：** 成功绕过身份验证后，攻击者可以执行特权命令，创建一个具有最高权限（特权级别15）的本地用户。
3.  **权限提升：** 使用新创建的具有特权15的用户登录设备。
4.  **植入后门:** 利用CVE-2023-20273，将权限提升到root级别，并在文件系统中写入恶意植入程序。

**关于投毒风险：**

提供的漏洞利用代码仅仅是Apache License 2.0协议，这是一个开源协议，本身不包含任何恶意代码。根据现有信息，没有迹象表明该漏洞利用代码中存在任何隐藏的恶意或投毒代码。

**项目地址:** [fox-it/cisco-ios-xe-implant-detection](https://github.com/fox-it/cisco-ios-xe-implant-detection)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #18

**来源**: [CVE-2023-20198-iveresk_cve-2023-20198.md](../2023/CVE-2023-20198-iveresk_cve-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响的Cisco IOS XE设备

**影响版本:** 受影响版本众多，详见漏洞库信息

**利用条件:** Web UI功能已启用，且设备未打补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-20198是一个Cisco IOS XE Software Web UI中存在的权限提升漏洞。根据漏洞库信息和搜索引擎结果，未经身份验证的攻击者可以通过该漏洞创建具有特权15级别（完全访问权限）的本地用户帐户。攻击者首先利用此漏洞获得初始访问权限，然后结合CVE-2023-20273漏洞，利用新创建的本地用户帐户将权限提升至root级别，并在文件系统中写入植入程序。漏洞利用代码 `cve-2023-20198.py` 提供了 `check` 和 `exploit` 两种模式。`check` 模式用于检测目标是否存在漏洞，`exploit` 模式用于创建本地用户帐户。漏洞利用过程包括向 `/webui/logoutconfirm.html` 发送POST请求进行检测，以及向 `/webui/create_user` 发送POST请求创建用户。投毒风险较低，因为代码主要利用已知的漏洞利用方法，但仍存在被修改以执行恶意操作的可能性，例如在创建用户后立即执行其他命令或植入后门程序。主要风险集中在config_content中，可能会存在其他的攻击代码。

**项目地址:** [iveresk/cve-2023-20198](https://github.com/iveresk/cve-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #19

**来源**: [CVE-2023-20198-kacem-expereo_CVE-2023-20198.md](../2023/CVE-2023-20198-kacem-expereo_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可被未授权的攻击者利用创建具有特权 15 的本地用户，为进一步攻击（如植入后门）铺平道路。

**影响版本:** 16.1.1 to 17.12.1 and potentially other versions as indicated in the CVE description.

**利用条件:** 目标设备启用了 Web UI 功能，且位于攻击者可访问的网络中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。未经身份验证的远程攻击者可以通过向目标设备发送特制的 HTTP 请求来利用此漏洞。该漏洞允许攻击者在受影响的系统上创建一个具有特权级别 15 访问权限的帐户。此漏洞是攻击链的第一步，攻击者利用它来创建具有管理权限的本地用户，然后利用 CVE-2023-20273 进一步提升权限至 root，并在文件系统中写入植入程序。提供的 POC 代码 `main.py` 的作用是检测目标 IP 是否容易受到 CVE-2023-20198 的攻击。它通过发送特定的 GET 和 POST 请求来检查目标设备是否返回预期的响应。如果目标返回指示存在漏洞的响应，脚本将输出 'Vulnerable'，否则输出 'Not Vulnerable'。代码通过发送构造的 HTTP GET 请求来尝试绕过身份验证，并检查是否出现预期的“404 Not Found”响应。同时,代码还发送带有硬编码 Authorization 头的 POST 请求，以进一步确认漏洞的存在。尽管代码本身用于检测漏洞，但潜在的投毒风险在于硬编码的 Authorization 头部，以及对 HTTPS 请求的证书验证的禁用（`verify=False`），这可能被恶意修改以进行中间人攻击或者将流量重定向到恶意服务器，虽然这种可能性不大，只有10%。

**利用方式：**

1.  **未经身份验证的访问：** 攻击者无需任何凭据即可发起攻击。
2.  **特制的 HTTP 请求：**  攻击者构造特定的 HTTP GET/POST 请求，利用漏洞绕过身份验证。
3.  **创建特权用户：** 成功利用漏洞后，攻击者可以创建一个拥有最高权限（特权级别 15）的本地用户。
4.  **后续利用：**  创建的特权用户可被用于进一步的恶意活动，例如植入后门、收集敏感信息等（与 CVE-2023-20273 结合）。

**有效性：**
根据漏洞描述和搜索结果，提供的 POC 代码 `main.py` 旨在检测目标是否存在 CVE-2023-20198 漏洞，而不是直接利用该漏洞创建用户。 它通过发送特定的HTTP请求来验证是否存在漏洞。因此，该POC代码在检测方面是有效的。



**项目地址:** [kacem-expereo/CVE-2023-20198](https://github.com/kacem-expereo/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #20

**来源**: [CVE-2023-20198-mr-r3b00t_CVE-2023-20198-IOS-XE-Scanner.md](../2023/CVE-2023-20198-mr-r3b00t_CVE-2023-20198-IOS-XE-Scanner.md)

## CVE-2023-20198-Cisco IOS XE Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的攻击者创建具有特权15权限的本地用户，进而控制设备。

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他一些版本，具体参考漏洞库信息。

**利用条件:** 目标设备启用了Web UI功能，并且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198 漏洞允许未经身份验证的远程攻击者在受影响的 Cisco IOS XE 设备上创建具有特权级别 15 访问权限的帐户。此漏洞是由于 Web UI 功能中存在未受保护的备用通道漏洞 (CWE-420) 造成的。攻击者可以利用此漏洞获得初始访问权限，然后通过 CVE-2023-20273 进一步提升权限至 root 并植入后门。提供的PoC代码 `implant_scanner.ps1` 实际上是一个检测脚本，用于判断目标系统是否已经被植入后门，通过对比Web页面内容的MD5哈希值来判断。脚本本身没有发现明显的投毒代码，config.json中指定了目标URL和已知的哈希值，用于检测是否存在已知的植入体。因此，该仓库中存在作者隐藏的投毒代码的可能性为0%。利用方式是，首先利用CVE-2023-20198创建一个高权限用户，然后利用CVE-2023-20273提升权限并写入植入体（后门）。

**项目地址:** [mr-r3b00t/CVE-2023-20198-IOS-XE-Scanner](https://github.com/mr-r3b00t/CVE-2023-20198-IOS-XE-Scanner)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #21

**来源**: [CVE-2023-20198-netbell_CVE-2023-20198-Fix.md](../2023/CVE-2023-20198-netbell_CVE-2023-20198-Fix.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权远程攻击者创建特权15用户并控制设备

**影响版本:** 受影响版本众多，详见漏洞库信息

**利用条件:** Web UI功能已启用，设备可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性非常高，因为它已被CISA列入已知被利用漏洞目录，并且Cisco官方也已确认存在活跃的利用。漏洞利用方式如下：

1.  **利用CVE-2023-20198获取初始访问权限:** 未经身份验证的攻击者可以利用此漏洞，通过Web UI创建一个具有特权15（最高权限）的本地用户。
2.  **利用CVE-2023-20273提升权限至Root:** 攻击者创建本地用户后，可以利用CVE-2023-20273进一步提升权限至root，并将恶意程序写入文件系统，实现完全控制。

提供的漏洞利用代码（Ansible playbook）实际上是一个缓解措施，旨在禁用Web UI以阻止利用。虽然主要目的是缓解漏洞，但该仓库中存在一定投毒风险。例如:

*   **inventory.yml中的凭据:**  该文件包含默认用户名和密码（admin/admin_password），这可能会被粗心的用户直接用于生产环境，从而使系统暴露于风险之中。
*   **依赖的安全性:**  Ansible playbook的安全性取决于控制机本身的安全。如果控制机被攻破，攻击者可以修改playbook或inventory，从而造成更大范围的损害。

因此，虽然Playbook本身主要是用于缓解漏洞，但配置不当可能导致其他安全问题，存在潜在的投毒风险。务必负责任地存储凭据，使用Ansible Vault或其他安全方法来保护敏感信息。

**项目地址:** [netbell/CVE-2023-20198-Fix](https://github.com/netbell/CVE-2023-20198-Fix)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #22

**来源**: [CVE-2023-20198-ohlawd_CVE-2023-20198.md](../2023/CVE-2023-20198-ohlawd_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，可导致完全控制受影响系统

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他特定版本

**利用条件:** 需要目标设备启用Web UI功能

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。攻击者可以利用此漏洞，在未经身份验证的情况下，通过发送特制请求创建一个具备特权级别15的本地用户，从而获得对设备的完全控制权。由于提供的POC代码仅打印"how bout u exploit d33z nuts"，并没有实际利用漏洞的代码，所以判断其为无效的POC，且具有100%的投毒风险。漏洞利用方式包括：首先利用CVE-2023-20198漏洞获得初始访问权限，然后执行特权15命令以创建本地用户和密码组合。之后，攻击者可能利用CVE-2023-20273漏洞，利用新创建的本地用户将权限提升为root，并将植入程序写入文件系统。

**项目地址:** [ohlawd/CVE-2023-20198](https://github.com/ohlawd/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #23

**来源**: [CVE-2023-20198-raystr-atearedteam_CVE-2023-20198-checker.md](../2023/CVE-2023-20198-raystr-atearedteam_CVE-2023-20198-checker.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI Privilege Escalation

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可能导致完全控制受影响的设备

**影响版本:** 16.1.1 to 17.12.1a 等多个版本 (参考漏洞库信息)

**利用条件:** Web UI功能必须启用，且设备可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-20198 允许未经身份验证的攻击者在受影响的系统上创建一个具有特权级别 15 访问权限的帐户。根据搜索引擎的结果，该漏洞已被积极利用。利用方式是，攻击者首先利用此漏洞获得初始访问权限，然后发出特权 15 命令来创建本地用户和密码组合。然后，攻击者利用另一个漏洞 (CVE-2023-20273) ，利用新创建的本地用户将权限提升为 root 并在文件系统中写入植入程序。 

提供的POC代码尝试通过向 `/webui/logoutconfirm.html` 发送带有 `logon_hash=1` 的POST请求来探测漏洞。如果响应状态码为200，并且响应内容的长度小于32个字符，则可能存在漏洞。POC代码扫描指定的子网，并尝试利用漏洞。 

关于投毒风险，POC代码本身相对简单，主要是网络扫描和HTTP请求。虽然不能完全排除恶意修改的可能性，但代码结构清晰，功能直接，隐藏恶意代码的概率较低。 投毒风险评估较低，大约5%。主要的风险点在于：
1.  **依赖未验证的requests库**：如果requests库本身被投毒，则会影响此脚本。
2.  **成功标志的判断**: 响应内容长度小于32可能是判断依据不足，如果恶意修改，可能导致误报或者漏报，将正常设备标记为存在漏洞，引导使用者进行进一步的恶意操作。

**项目地址:** [raystr-atearedteam/CVE-2023-20198-checker](https://github.com/raystr-atearedteam/CVE-2023-20198-checker)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #24

**来源**: [CVE-2023-20198-reket99_Cisco_CVE-2023-20198.md](../2023/CVE-2023-20198-reket99_Cisco_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，可导致完全控制受影响的Cisco IOS XE设备

**影响版本:** 16.1.1 to 17.12.1 (部分版本)

**利用条件:** Web UI功能已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。攻击者可以利用此漏洞，在未经身份验证的情况下，创建一个具有特权级别15（完全访问所有命令）的本地用户。接下来，攻击者可以利用CVE-2023-20273，通过新创建的本地用户提升权限至root并在文件系统中写入植入物。漏洞利用流程如下：

1.  **CVE-2023-20198 利用:**  未经验证的攻击者通过发送特制的POST请求到`/webui/logoutconfirm.html`，绕过身份验证，创建一个具有管理员权限的新用户。
2.  **CVE-2023-20273 利用:** 使用步骤1中创建的管理员用户，利用另一个Web UI组件中的漏洞，提升权限到root，并写入恶意植入物。

提供的POC代码尝试通过向目标IP地址的`/webui/logoutconfirm.html`发送POST请求来验证漏洞是否存在。如果响应状态码为200，并且响应长度较短（小于32字节），则认为该IP地址易受攻击。然后，脚本会使用curl再次发送请求，如果返回特定的输出长度，则确认漏洞存在。

**关于投毒风险:**

虽然该脚本的主要目的是验证漏洞的存在，但仍然存在一定的投毒风险。风险点在于subprocess.run函数中，使用shell=True来执行curl命令。这使得代码容易受到命令注入攻击，如果攻击者能够控制IP地址或相关参数，则可能执行任意命令。 此外，脚本会将成功利用漏洞的IP地址记录到results.csv 文件中，这虽然不是恶意行为，但可能被恶意行为者利用。投毒风险评估为10%，主要是因为使用了subprocess.run(shell=True)执行外部命令。

**项目地址:** [reket99/Cisco_CVE-2023-20198](https://github.com/reket99/Cisco_CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #25

**来源**: [CVE-2023-20198-sanan2004_CVE-2023-20198.md](../2023/CVE-2023-20198-sanan2004_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响的系统

**影响版本:** 16.1.1 至 17.12.3 以及其他版本

**利用条件:** 目标系统启用了Web UI功能，且位于网络可达范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 存在于 Cisco IOS XE 软件的 Web UI 中。该漏洞允许未经身份验证的攻击者通过不正确的路径验证绕过 Nginx 过滤，访问 `webui_wsma_http` Web 端点，从而可以执行任意 Cisco IOS 命令或进行配置更改，获得 Privilege 15 权限。该漏洞利用涉及两个 XML SOAP 端点：`cisco:wsma-exec` 和 `cisco:wsma-config`。攻击者可以使用 `cisco:wsma-exec` 端点将命令插入到 `execCLI` 元素标记中，例如获取运行配置或执行任意命令。攻击者还可以使用 `cisco:wsma-config` 端点添加具有 Privilege 15 的新用户。随附的 PoC 脚本提供检查漏洞、获取配置、执行命令以及添加/删除用户的功能。PoC 代码的投毒风险较低 (10%)，主要风险在于不熟悉该漏洞的人员可能意外地在生产环境中执行恶意命令，或在测试时使用了存在后门的IOS版本。脚本本身旨在利用漏洞，并且不包含任何明显的恶意或隐藏功能，仓库的README.md声明了此POC的利用方式,降低了隐藏的恶意代码的风险。

**漏洞利用方式：**

1.  **利用 CVE-2023-20198 绕过身份验证：** 攻击者构造特制的 URL 访问易受攻击的 Web UI 端点。
2.  **提升权限：** 成功绕过身份验证后，攻击者可以利用 `cisco:wsma-exec` 或 `cisco:wsma-config` SOAP接口下发命令。
3.  **创建特权用户：** 攻击者创建一个具有 Privilege 15 权限的新用户，从而获得对系统的完全控制。
4.  **执行任意命令：** 攻击者可以使用提权的会话执行任意 Cisco IOS 命令，包括安装后门、修改配置或窃取敏感信息。

**项目地址:** [sanan2004/CVE-2023-20198](https://github.com/sanan2004/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #26

**来源**: [CVE-2023-20198-securityphoenix_cisco-CVE-2023-20198-tester.md](../2023/CVE-2023-20198-securityphoenix_cisco-CVE-2023-20198-tester.md)

## CVE-2023-20198-Cisco IOS XE Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的攻击者创建具有特权15的本地用户，从而完全控制设备

**影响版本:** 受影响的版本包括 16.1.1 到 17.12.1 以及其他版本

**利用条件:** Web UI 功能必须已启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞信息和搜索结果，CVE-2023-20198 允许未经身份验证的攻击者在受影响的 Cisco IOS XE 设备上创建具有 privilege level 15 （最高权限）的本地用户。漏洞利用涉及向 Web UI 发送特制的 HTTP POST 请求，绕过身份验证机制。创建具有最高权限的用户后，攻击者可以使用该账户执行任意命令，并完全控制设备。提供的 `cisco_tester.py` 脚本旨在检测目标设备是否受到 CVE-2023-20198 的影响。它通过向 `/webui/logoutconfirm.html?logon_hash=1` 发送 POST 请求，并检查响应中是否包含特定的字符串 `1a80b7389ccd0a5dab` 来判断设备是否已被入侵。该字符串很可能是一个被利用的设备的特征。

**有效性:**

根据漏洞库信息、搜索结果（特别是 https://www.horizon3.ai/attack-research/attack-blogs/cisco-ios-xe-cve-2023-20198-deep-dive-and-poc/）和漏洞利用代码，该漏洞的利用是有效的，已经有公开可用的PoC。

**投毒风险:**

提供的Python脚本本身主要是一个检测工具，用于检查Cisco设备是否受到CVE-2023-20198的影响，它通过检测特定Hash值判断系统是否已经被植入后门。该脚本逻辑比较简单，主要功能为发送HTTP请求并匹配特定字符串。风险点可能在于脚本对异常的处理不够严谨，如果目标存在其他漏洞，可能被利用，但从代码本身来看，投毒的可能性较低，例如作者没有隐藏恶意的代码执行、数据窃取等行为。可以认为投毒风险极低，可能性约为1%。

**利用方式:**

1.  **未经身份验证的权限提升:**  攻击者利用 CVE-2023-20198 在 Cisco IOS XE 设备上创建一个具有最高权限 (privilege level 15) 的本地用户。
2.  **初始访问:**  利用漏洞绕过 Web UI 的身份验证机制。
3.  **命令执行:**  使用新创建的特权用户账户登录并执行任意命令，实现对设备的完全控制。
4.  **植入后门:** 利用CVE-2023-20273，提升权限至root,写入后门文件。

总而言之，此漏洞允许攻击者完全控制受影响的Cisco设备，风险极高。

**项目地址:** [securityphoenix/cisco-CVE-2023-20198-tester](https://github.com/securityphoenix/cisco-CVE-2023-20198-tester)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #27

**来源**: [CVE-2023-20198-smokeintheshell_CVE-2023-20198.md](../2023/CVE-2023-20198-smokeintheshell_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权用户创建特权用户并执行任意命令

**影响版本:** 受影响版本包括16.1.1到17.12.1等多个版本

**利用条件:** 需要目标设备启用Web UI功能，且攻击者能够网络访问该Web UI。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。该漏洞源于对 Nginx 过滤器的不当路径验证，允许未经身份验证的攻击者绕过身份验证访问 `webui_wsma_http` Web 端点。

**利用方式：**

1.  攻击者利用漏洞绕过身份验证，向 `webui_wsma_http` 端点发送特制的 XML SOAP 请求。
2.  攻击者可以使用 `cisco:wsma-exec` SOAP 端点执行任意 Cisco IOS 命令，或者使用 `cisco:wsma-config` SOAP 端点创建具有 Privilege 15 权限的本地用户。
3.  创建具有 Privilege 15 权限的用户后，攻击者可以使用该用户登录并执行任何操作。
4.  结合CVE-2023-20273，攻击者可以进一步提升权限至root，并写入植入程序。

**有效性：**

根据漏洞描述和提供的漏洞利用代码，该漏洞利用是有效的。漏洞利用代码包含检查漏洞是否存在、获取 Cisco IOS 运行配置、执行任意 Cisco IOS 命令以及添加/删除特权用户的功能。搜索引擎结果也表明该漏洞已被 активно利用。

**投毒风险：**

分析提供的漏洞利用代码（exploit.py），发现以下潜在风险：

*   虽然代码本身看起来直接实现了漏洞利用，但仍然存在作者在代码中加入恶意行为的可能性。
*   例如，可以修改添加用户的函数，在创建高权限用户的同时，静默地执行其他恶意配置更改（如添加后门路由或修改系统日志设置）。
*   代码中使用了多个 SOAP 端点，虽然文档中只提到了 `cisco:wsma-exec` 和 `cisco:wsma-config`，但作者可能利用其他未公开的端点执行恶意操作。
*   因此，需要仔细审查代码的每一行，特别是与网络请求和配置更改相关的部分，以确保没有隐藏的恶意逻辑。
*  根据代码内容，未发现明显的恶意代码，但由于该漏洞可以创建高权限用户，如果攻击者利用该漏洞，完全可以植入后门，存在投毒风险。
*  代码本身风险较低，投毒风险主要体现在被攻击者利用后实施的恶意行为，故将风险调整为10%。

**项目地址:** [smokeintheshell/CVE-2023-20198](https://github.com/smokeintheshell/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #28

**来源**: [CVE-2023-20198-sohaibeb_CVE-2023-20198.md](../2023/CVE-2023-20198-sohaibeb_CVE-2023-20198.md)

# CVE-2023-20198

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-20198-Arshit01_CVE-2023-20198.md](../2023/CVE-2023-20198-Arshit01_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI权限提升漏洞

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响的Cisco设备

**影响版本:** 16.1.1 to 17.12.1及部分17.x版本

**利用条件:** Web UI功能已启用，且目标设备存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。未经身份验证的攻击者可以利用此漏洞创建具有特权级别15（最高权限）的本地用户，从而完全控制受影响的设备。利用过程分为两个阶段：首先利用CVE-2023-20198创建用户，其次利用CVE-2023-20273提升权限至root并写入植入程序。

**漏洞利用方式：**

1.  **身份验证绕过：** 漏洞允许未经身份验证的攻击者与设备的Web UI进行交互。
2.  **创建特权用户：** 攻击者发送特制的SOAP请求到Web UI，该请求绕过身份验证并允许攻击者创建一个具有特权级别15的新用户。
3.  **远程控制：** 创建具有最高权限的用户后，攻击者可以使用此帐户登录设备，并执行任意命令。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的POC代码，可以确认POC代码是有效的。搜索结果中的文章提到了漏洞的成功利用和概念验证代码的存在。POC代码也显示了通过发送特制的XML SOAP请求来创建新用户的机制。

**投毒风险：**

提供的POC代码存在轻微的投毒风险，约为10%。风险点分析如下：

*   **默认用户名和密码：** POC代码使用了默认的用户名（shellsmoke）和密码（pwned）。虽然这方便了漏洞测试，但如果未经修改直接用于攻击，很容易被检测到或被其他人利用。
*   **硬编码的URI：** POC中`exURI = '%2577eb%2575i_%2577sma_Http'`，如果攻击者修改此URI植入恶意代码，可能会导致拒绝服务或者其他恶意行为。
*   **命令执行：** 漏洞本身允许执行任意命令，攻击者可能通过植入恶意命令来感染设备。

需要注意的是，以上只是一些潜在的风险点，具体的投毒行为还需要进一步分析。POC的主要功能是验证漏洞的存在，而非恶意利用。因此，将其判定为具有投毒代码是不准确的。

**项目地址:** [Arshit01/CVE-2023-20198](https://github.com/Arshit01/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #2

**来源**: [CVE-2023-20198-Atea-Redteam_CVE-2023-20198.md](../2023/CVE-2023-20198-Atea-Redteam_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Software Web UI权限提升漏洞

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，未经身份验证的攻击者可以创建具有特权级别15访问权限的帐户，并最终导致完全控制受影响的系统。

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1以及17.11.99SW等众多版本

**利用条件:** Web UI 功能必须启用。需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个关键漏洞。未经身份验证的远程攻击者可以利用此漏洞在受影响的系统上创建具有特权级别 15（完全访问所有命令）的帐户。利用方式是攻击者发送特制的 HTTP 请求到 `/webui/logoutconfirm.html?logon_hash=1` 路径，绕过身份验证，并执行特权命令以创建本地用户和密码组合。创建用户后，攻击者可以利用另一个漏洞（CVE-2023-20273）提升权限至 root 并写入植入程序到文件系统。提供的 Python 脚本 `CVE-2023-20198.py` 旨在检测是否存在该漏洞，并检查已知的 IOC。  该脚本扫描指定子网，并检查目标设备是否返回预期的响应状态码和内容长度。投毒风险评估：脚本本身主要用于检测，但由于脚本包含发送特定请求到目标设备的逻辑，如果攻击者修改此脚本，可能会加入恶意负载或更改用户创建的用户名/密码，存在一定的投毒风险.脚本中存在User-Agent:Atea Red Team CVE-2023-20198 checkscript特征,可能被安全设备检测到。存在的风险点是如果未经授权的人员使用了修改后的脚本，可能会对网络造成损害。 README.md文件没有发现异常。

**项目地址:** [Atea-Redteam/CVE-2023-20198](https://github.com/Atea-Redteam/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #3

**来源**: [CVE-2023-20198-DOMINIC471_qub-network-security-cve-2023-20198.md](../2023/CVE-2023-20198-DOMINIC471_qub-network-security-cve-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权级别15的账户，完全控制受影响的设备。

**影响版本:** 受影响版本众多，包括16.1.1到17.12.1以及其他版本（详见漏洞库信息）。

**利用条件:** Web UI功能必须已启用。设备需要可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞允许未经身份验证的攻击者在Cisco IOS XE设备上创建具有特权级别15（最高权限）的本地用户。攻击者通过利用Web UI中的漏洞绕过身份验证，并执行特权命令创建用户。结合另一个漏洞CVE-2023-20273，攻击者可以进一步提升权限至root并写入植入程序到文件系统。 

**有效性评估：**
根据提供的漏洞库信息和搜索结果，CVE-2023-20198是一个严重漏洞，已被积极利用。

**投毒风险评估：**
查看提供的POC代码，包括README.md和IOC Summary.md文件。 README.md主要描述了如何分析、检测和缓解此漏洞。IOC Summary.md列出了攻击者IP，受害者IP，使用的header以及payload等。这些信息可以辅助蓝队进行防御。
总体来说，该仓库的目的是为了分析和缓解漏洞，并没有发现明显的投毒代码。但是，由于代码中可能包含攻击载荷或恶意命令示例，如果使用者不小心，可能会误用这些代码进行非授权的渗透测试，从而导致法律风险。因此，评估的投毒风险为10%。

**利用方式：**
1.  **未授权访问：** 攻击者利用漏洞，绕过Web UI的身份验证机制。
2.  **创建特权用户：** 攻击者通过发送特制的HTTP请求，执行CLI命令，创建一个具有特权级别15的本地用户。
3.  **持久化（结合CVE-2023-20273）：** 攻击者利用新创建的本地用户登录，并利用另一个漏洞（CVE-2023-20273）提升权限到root，并在文件系统中写入植入程序，实现持久化控制。

**缓解措施：**
*   禁用Web UI功能，如果不需要使用。
*   升级到已修复漏洞的IOS XE软件版本。
*   使用入侵检测/防御系统（IDS/IPS）检测和阻止利用此漏洞的攻击。
*   检查设备上是否存在异常用户和植入程序。

**项目地址:** [DOMINIC471/qub-network-security-cve-2023-20198](https://github.com/DOMINIC471/qub-network-security-cve-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #4

**来源**: [CVE-2023-20198-G4sul1n_Cisco-IOS-XE-CVE-2023-20198.md](../2023/CVE-2023-20198-G4sul1n_Cisco-IOS-XE-CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权15权限的本地用户，结合CVE-2023-20273可提升至root权限并植入后门。

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他相关版本，具体参见漏洞库信息。

**利用条件:** 需要目标系统启用Web UI功能，且网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。根据漏洞信息和搜索结果，该漏洞允许未经身份验证的远程攻击者在受影响的系统上创建一个具有特权级别 15 访问权限的帐户。Cisco的公告指出，攻击者首先利用此漏洞获得初始访问权限，然后执行特权 15 命令以创建本地用户和密码组合。随后，攻击者利用 CVE-2023-20273 将权限提升到 root 并将植入程序写入文件系统。根据提供的漏洞利用代码，该 PoC 包含以下功能：

*   **漏洞检查**：通过执行 `uname -a` 命令来验证漏洞是否存在。
*   **获取 Cisco 配置**：执行 `sh run` 命令来提取运行配置。
*   **执行命令**：允许执行任意 Cisco IOS 命令，但警告需要谨慎使用，因为没有输入验证。
*   **添加用户**：创建一个新的特权 15 用户帐户，可以选择指定用户名和密码。
*   **删除用户**：从设备中删除用户帐户。

**有效性：**

该 PoC 代码的有效性较高，因为漏洞库信息和搜索结果都表明该漏洞已被 активно используется。此外，该 PoC 提供了多种利用方式，包括漏洞检查、信息收集和权限提升。

**投毒风险：**

尽管 PoC 代码主要用于利用已知的漏洞，但仍存在一定的投毒风险，估计为10%。风险点包括：

*   **命令执行**：通过 `-e` 选项执行任意命令，攻击者可能利用此功能执行恶意操作。
*   **用户管理**：虽然提供了添加和删除用户的选项，但如果被滥用，可能导致拒绝服务或系统损坏。

虽然PoC代码本身看起来是为了复现漏洞，但不能完全排除代码作者在其中隐藏恶意功能的可能性，例如植入后门、收集敏感信息等。因此，在使用 PoC 代码时，需要进行仔细审查和安全评估。

**利用方式：**

1.  **未经身份验证的访问**：利用 CVE-2023-20198 绕过身份验证，访问 `webui_wsma_http` Web 端点。
2.  **创建特权用户**：使用 `cisco:wsma-config` SOAP 端点创建一个具有特权 15 的新用户帐户。
3.  **执行任意命令**：使用 `cisco:wsma-exec` SOAP 端点执行任意 Cisco IOS 命令。
4.  **权限提升 (结合 CVE-2023-20273)**：利用新创建的特权用户，结合 CVE-2023-20273 将权限提升到 root，并在系统上植入后门。

总而言之，CVE-2023-20198 是一个严重的安全漏洞，需要立即采取措施进行修复。在使用 PoC 代码时，需要谨慎评估风险，并确保在受控环境中进行测试。

**项目地址:** [G4sul1n/Cisco-IOS-XE-CVE-2023-20198](https://github.com/G4sul1n/Cisco-IOS-XE-CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #5

**来源**: [CVE-2023-20198-IceBreakerCode_CVE-2023-20198.md](../2023/CVE-2023-20198-IceBreakerCode_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权级别 15 的帐户，从而完全控制设备

**影响版本:** 16.1.1 to 17.12.1 and earlier versions

**利用条件:** Web UI 功能已启用并且设备易受攻击版本的影响。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个漏洞，允许未经身份验证的远程攻击者在受影响的系统上创建具有特权级别 15 访问权限的帐户。 

**漏洞利用方式：**

1.  攻击者发送一个特制的 HTTP POST 请求到 `/webui/logoutconfirm.html?logon_hash=1` 端点，绕过身份验证。
2.  成功利用此漏洞后，攻击者可以执行任意命令，包括创建具有特权级别 15 的本地用户。
3.  然后，攻击者使用另一个漏洞（CVE-2023-20273）并通过新创建的本地用户权限提升到 root 权限，并将植入程序写入文件系统。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判定该漏洞的POC代码是有效的。漏洞库信息明确指出存在正在进行的漏洞利用活动。搜索结果也提供了多个关于该漏洞的深度分析和POC示例的链接，例如horizon3.ai上的POC代码。
提供的python脚本模拟了发送特制HTTP请求的过程，旨在检测目标系统是否存在漏洞。脚本会检查HTTP响应状态码和响应体内容，以判断是否存在潜在的植入程序。

**投毒风险：**

评估POC代码的投毒风险，需要仔细分析代码是否存在恶意行为，例如：
1.  **植入后门：**  代码是否在目标系统上安装未经授权的后门。
2.  **数据窃取：**  代码是否窃取敏感信息并发送到外部服务器。
3.  **拒绝服务：**  代码是否导致目标系统崩溃或无法正常运行。
4.  **恶意传播：**  代码是否试图感染其他系统。

分析提供的python脚本，该脚本主要用于检测漏洞是否存在，并未发现明显的恶意行为。脚本的功能是发送特定的HTTP请求并检查响应，以确定目标系统是否受到CVE-2023-20198漏洞的影响。然而，使用任何未经授权的漏洞利用代码都存在风险，因为代码的作者可能隐藏了不易察觉的恶意功能。因此，在使用任何POC代码之前，务必进行彻底的安全审查。

考虑到以上因素，判定该POC代码存在10%的投毒风险，主要是由于作者可能隐藏了一些不易察觉的恶意代码，但主要功能是漏洞验证。

**缓解措施：**

*   禁用 Web UI 功能，特别是当设备面向互联网时。
*   将 Web UI 访问限制为受信任的网络。
*   升级到已修复漏洞的 Cisco IOS XE 软件版本。

**项目地址:** [IceBreakerCode/CVE-2023-20198](https://github.com/IceBreakerCode/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #6

**来源**: [CVE-2023-20198-JoyGhoshs_CVE-2023-20198.md](../2023/CVE-2023-20198-JoyGhoshs_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可导致完全控制受影响设备

**影响版本:** 受影响版本范围广泛，详见漏洞库信息

**利用条件:** Web UI功能已启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198 允许未经身份验证的攻击者在受影响的系统上创建具有权限级别15（完全访问权限）的帐户。该漏洞利用方式如下：

1.  **初始访问:** 攻击者利用CVE-2023-20198漏洞，通过Web UI创建具有高权限的本地用户。
2.  **权限提升:** 然后，攻击者可能利用CVE-2023-20273（另一个漏洞）或使用新创建的本地用户进一步将权限提升至root。
3.  **植入后门:** 攻击者利用获得的root权限，在文件系统中写入恶意植入。

提供的POC代码`poc.py`是一个**检测工具**，而非完整的漏洞利用代码。它通过发送一个特定的HTTP请求到`/webui/logoutconfirm.html?logon_hash=1`，并检查响应内容是否为十六进制字符串来判断目标是否可能受到了攻击并植入了后门。如果响应是十六进制字符串，则表明设备可能已遭入侵，并存在植入的后门（该后门会返回hex信息）。

该存储库中的`README.md`文件说明，此脚本并非完整的POC，仅用于检查是否存在hex响应。因此，它无法直接用于漏洞利用，而只能用于检测。

**投毒风险分析：**

查看`poc.py`文件内容，发现其功能主要是发送HTTP请求并判断响应内容。该代码的功能比较简单，未发现任何可能导致恶意行为（例如，上传恶意文件、执行任意命令等）的可疑代码。因此，可以认为该存储库不存在作者隐藏的投毒代码。



**项目地址:** [JoyGhoshs/CVE-2023-20198](https://github.com/JoyGhoshs/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #7

**来源**: [CVE-2023-20198-Pushkarup_CVE-2023-20198.md](../2023/CVE-2023-20198-Pushkarup_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的远程攻击者创建管理员账户并完全控制设备

**影响版本:** 受影响版本详见CVE描述

**利用条件:** 目标设备启用了Web UI功能，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞存在于 Cisco IOS XE 软件的 Web UI 中。未经身份验证的远程攻击者可以通过利用此漏洞在受影响的系统上创建具有特权级别 15 访问权限的帐户。创建账户后，攻击者可以使用该账户完全控制受损的机器。

**有效性：**
提供的 POC 代码根据描述能够创建本地用户，安装植入体，重启Web服务，并检查植入体的状态，因此具备有效性。

**投毒风险：**
此仓库中可能存在作者隐藏的投毒代码。尽管自述文件声明 PoC 仅用于教育目的，并且使用需要遵守道德规范，但攻击者可以修改 `config_content` 以包含恶意配置，例如更改防火墙规则或执行其他恶意操作。此外，虽然代码本身没有明显的恶意行为，但其目的是在目标系统上创建具有管理权限的用户，这本身就可以被认为是恶意的。因此，存在一定的投毒风险，但是相对较低，风险评估在10%。此风险评估基于以下因素：
    *   代码可能被用于未授权的系统访问。
    *   配置文件可被修改为包含恶意指令。

**利用方式：**
1.  攻击者利用 CVE-2023-20198 漏洞，通过未授权访问在 Cisco IOS XE 设备上创建一个具有特权级别 15 的本地用户。
2.  攻击者使用新创建的管理员账户登录到设备。
3.  攻击者利用 CVE-2023-20273 漏洞，进一步提升权限至 root 级别，并将恶意植入程序写入文件系统。
4.  攻击者通过植入的后门程序远程控制设备，执行恶意操作，例如数据窃取、网络攻击等。
根据搜索结果，CISA 已将此漏洞添加到已知被利用的漏洞目录中，表明该漏洞已经被广泛利用。

**项目地址:** [Pushkarup/CVE-2023-20198](https://github.com/Pushkarup/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #8

**来源**: [CVE-2023-20198-RevoltSecurities_CVE-2023-20198.md](../2023/CVE-2023-20198-RevoltSecurities_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，可被未授权的攻击者利用创建特权用户，进而完全控制系统。

**影响版本:** 受影响的版本包括16.1.1到17.12.1以及其他一系列17.x版本 (详见漏洞库信息)

**利用条件:** 目标设备启用Web UI功能，并且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。根据漏洞库信息和搜索引擎结果，未经身份验证的攻击者可以利用此漏洞在受影响的系统上创建一个具有 15 级权限（最高权限）的帐户。随后攻击者再利用CVE-2023-20273，将权限提升至root，并写入植入体。该漏洞的利用方式如下：

1.  **漏洞触发：** 攻击者发送特制的HTTP请求到Cisco IOS XE设备的Web UI接口，绕过身份验证。
2.  **创建特权用户：** 请求中包含特定的XML内容，该内容允许攻击者创建一个新的本地用户，并分配最高权限（privilege level 15）。
3.  **权限提升：** 攻击者利用创建的特权用户登录系统。
4.  **植入后门：** 攻击者通过Web UI的另一个组件（CVE-2023-20273）将权限提升至root并写入植入体。

**有效性：** 根据搜索引擎结果（特别是horizon3.ai的POC）以及提供的漏洞利用代码，此漏洞利用是有效的。漏洞利用代码仓库提供了一个Python脚本，可以检测和利用此漏洞。

**投毒风险：** 漏洞利用代码仓库的投毒风险评估为10%。虽然该仓库提供了看似合理的漏洞利用脚本，但存在以下潜在风险点：

*   **自定义配置内容：** 脚本允许用户提供自定义的配置内容（`-cfc` 或 `--config-content` 参数），这可能被滥用以注入恶意代码或配置。
*   **隐蔽后门：** 虽然主要功能是利用漏洞，但作者可能在代码中添加了不易察觉的后门，例如收集目标信息、执行任意命令等。代码量较少，通读代码可以降低风险。

**防范措施：**

*   立即更新Cisco IOS XE软件到已修复的版本。
*   禁用Web UI功能，如果不需要。
*   监控网络流量，检测异常的Web UI请求。
*   使用Cisco提供的软件检查工具来识别和移除潜在的植入体。

**项目地址:** [RevoltSecurities/CVE-2023-20198](https://github.com/RevoltSecurities/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #9

**来源**: [CVE-2023-20198-Shadow0ps_CVE-2023-20198-Scanner.md](../2023/CVE-2023-20198-Shadow0ps_CVE-2023-20198-Scanner.md)

## CVE-2023-20198 Cisco IOS XE Web UI 权限提升漏洞

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权 15 权限的本地用户，从而完全控制受影响的设备。

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1 以及 17.11.99SW

**利用条件:** Web UI 功能必须已启用。攻击者需要能够通过网络访问设备的 Web UI。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。未经身份验证的远程攻击者可以利用此漏洞在受影响的系统上创建一个具有特权 15 访问权限的帐户，本质上是管理员权限。漏洞利用通常与另一个漏洞 CVE-2023-20273 结合使用，后者用于将权限提升到 root 并将植入程序写入文件系统。

**漏洞利用有效性：**

根据漏洞库信息、搜索引擎结果（特别是 horizon3.ai 的 PoC 描述）以及提供的漏洞利用代码片段来看，该漏洞的利用是有效的。存在公开可用的 PoC，允许攻击者绕过身份验证创建具有管理权限的用户。

**投毒风险分析：**

提供的代码片段分析表明，攻击流程依赖于 Nginx 配置和一个 Lua 脚本。Lua 脚本的核心功能在于身份验证绕过和命令执行。脚本通过检查是否存在特定的 "Authorization" Header以及Header的内容是否和通过REDACTED命令执行结果匹配来确定请求是否被授权。

由于 "REDACTED" 信息的缺失，我们无法完全确定是否存在恶意投毒代码。但是lua脚本的下列行为存在潜在的投毒风险：

1.  **外部命令执行:** 脚本多次使用 `io.popen()` 执行外部命令。如果这些命令包含恶意参数或旨在下载和执行其他代码，则可能导致系统受损。
2.  **硬编码的凭据和逻辑：**脚本逻辑依赖于特定的哈希值和其他硬编码的字符串。攻击者可能会修改这些字符串以创建变体，从而绕过安全检测或植入后门。
3.  **对/lua5的请求:** 当common_type=iox时,会调用/lua5,如果/lua5是作者控制的地址,则存在投毒风险。

基于以上分析，虽然无法确定明确的投毒代码，但脚本中使用的技术（尤其是外部命令执行）增加了被用于恶意目的的可能性，估计投毒风险为20%。

**漏洞利用方式：**

1.  **未授权访问:** 攻击者发送一个特制的 HTTP POST 请求到 `/webui/logoutconfirm.html`，绕过身份验证检查（利用 CVE-2023-20198）。这可能涉及到提供特定的 `Authorization` header，该header的值能够通过预设的验证。
2.  **创建高权限用户:** 绕过身份验证后，攻击者可以发送包含创建新用户（具有特权级别 15）的命令的请求体。该命令通过 `io.popen()` 执行，从而创建一个具有管理员权限的本地用户。
3.  **权限提升和植入：** (结合 CVE-2023-20273) 使用新创建的本地用户登录并利用 CVE-2023-20273 将权限提升至 root，从而能够在设备上安装植入程序。


**项目地址:** [Shadow0ps/CVE-2023-20198-Scanner](https://github.com/Shadow0ps/CVE-2023-20198-Scanner)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #10

**来源**: [CVE-2023-20198-Tounsi007_CVE-2023-20198.md](../2023/CVE-2023-20198-Tounsi007_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可能导致完全控制受影响设备

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他版本

**利用条件:** 目标设备启用了Web UI功能并且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞存在于Cisco IOS XE Software的Web UI中，允许未经身份验证的远程攻击者创建一个具有特权级别15（完全访问权限）的本地用户帐户。该漏洞利用方式是通过发送特制的HTTP请求到`/webui/create_user`路径来创建用户。攻击者随后可利用创建的用户并通过另一个漏洞CVE-2023-20273提升权限至root并写入植入程序。提供的POC代码尝试模拟此过程，包括创建用户、安装植入程序、重启Web服务器、检查植入程序状态以及清理创建的用户。 

**有效性：**根据漏洞信息、搜索结果和提供的POC代码，该漏洞是有效的。搜索引擎结果表明该漏洞已被积极利用，并且存在公开可用的POC代码。CISA的已知被利用漏洞目录也收录了该漏洞。

**投毒风险：**POC代码本身存在一定的风险。虽然代码的主要功能是利用漏洞，但`config_content`变量表明存在植入恶意配置的可能性。 用户需要手动插入植入配置,存在被植入后门的风险。
该仓库readme描述，POC仅用于测试和学习，有免责声明。存在一定概率作者未充分测试。

**利用方式：**
1.  **初始访问：** 未经身份验证的攻击者发送特制HTTP请求到存在漏洞的Cisco IOS XE设备的Web UI接口。
2.  **用户创建：**  利用CVE-2023-20198，攻击者通过`/webui/create_user`接口创建一个具有管理员权限的新用户。
3.  **权限提升（CVE-2023-20273）：** 利用新创建的用户，攻击者可以进一步利用Web UI中的另一个漏洞（CVE-2023-20273）来提升权限至root。
4.  **植入后门：** 攻击者可以写入植入程序到文件系统。
5.  **持久化：** 植入程序可以用于维持对受感染设备的访问。
6.  **清理（可选）：** 攻击者可以选择删除他们创建的后门账户，以隐藏其踪迹。

**项目地址:** [Tounsi007/CVE-2023-20198](https://github.com/Tounsi007/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #11

**来源**: [CVE-2023-20198-Vulnmachines_Cisco_CVE-2023-20198.md](../2023/CVE-2023-20198-Vulnmachines_Cisco_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可使未授权的攻击者获得完全管理权限

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1 以及其他多个版本

**利用条件:** Web UI 功能启用并且 HTTP 或 HTTPS 服务器功能开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个关键身份验证绕过漏洞。根据漏洞信息和搜索结果，攻击者利用此漏洞首先获得初始访问权限，然后执行特权 15 命令来创建一个本地用户和密码组合，从而获得管理员权限。之后，攻击者利用 CVE-2023-20273 将权限提升到 root 并在文件系统中写入植入程序。提供的 POC 代码显示了一个用于利用漏洞的 HTTP POST 请求示例。请求的目标 URI 经过编码处理，绕过了身份验证。请求体包含一个 SOAP 信封，该信封尝试使用默认的 "admin" 用户名执行命令 "uname -a"。有效性：根据搜索结果和漏洞描述，提供的 POST 请求通过身份验证绕过在受影响的设备上创建具有特权 15 的用户，因此 POC 代码有效。 投毒风险：README.md 文件描述了漏洞，并提供了一个关于利用该漏洞的概述。Payload 文件包含一个 SOAP 请求，用于发送 CLI 命令。虽然该请求本身看起来无害（执行 `uname -a` 命令），但攻击者可能会修改该请求以执行恶意命令。例如，更改命令以创建具有特权 15 的用户。 因此，存在一定风险，即此仓库可能被用于传播恶意利用程序。Payload 代码文件本身没有明显的投毒代码，但存在被修改利用的风险，因此判定投毒风险为 10%。利用方式：1. 检查目标 Cisco IOS XE 设备是否启用了 Web UI 功能和 HTTP/HTTPS 服务器。2. 发送构造的 HTTP POST 请求到目标设备，利用身份验证绕过漏洞。3. 请求的目标 URI 经过编码处理以绕过身份验证检查。4. POST 请求的内容为 SOAP 信封，其中包含要执行的 CLI 命令。5. 成功利用后，攻击者可以在设备上执行任意 CLI 命令，例如创建新的管理员帐户或植入恶意软件。

**项目地址:** [Vulnmachines/Cisco_CVE-2023-20198](https://github.com/Vulnmachines/Cisco_CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #12

**来源**: [CVE-2023-20198-W01fh4cker_CVE-2023-20198-RCE.md](../2023/CVE-2023-20198-W01fh4cker_CVE-2023-20198-RCE.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权15的用户，进而完全控制受影响的设备。

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1 等多个版本

**利用条件:** Web UI 功能已启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。未经身份验证的远程攻击者可以利用此漏洞在受影响的系统上创建一个具有特权 15 访问权限的帐户，从而完全控制设备。利用方式如下：

1.  **漏洞触发点：** Cisco IOS XE 软件的 Web UI 组件存在漏洞。
2.  **利用过程：** 攻击者通过发送特制的 SOAP 请求到 `/%%77ebui_wsma_https` 或 `/%%77ebui_wsma_Http` URI (具体取决于是否使用 HTTPS) 绕过身份验证。
3.  **命令执行：** 攻击者使用 `urn:cisco:wsma-config` 命名空间执行 CLI 命令，创建新的具有特权 15 的用户。
4.  **后续利用 (CVE-2023-20273):** 在获得初始访问权限后，攻击者可以利用 CVE-2023-20273 将权限提升为 root 并在文件系统中写入植入程序。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞已被积极利用，提供的 PoC 代码有效，可以用于创建具有特权 15 的用户。

**投毒风险：**

PoC 代码主要功能是利用漏洞，创建新用户，从代码本身来看，存在一些潜在的投毒点，例如：

*   **随机用户名/密码生成：**  虽然代码中包含随机用户名生成函数，但实际使用中，攻击者可能会替换为预设的用户名和密码，方便后续控制。
*   **代理服务器使用：**  PoC 代码支持使用代理服务器，攻击者可以借此隐藏真实 IP 地址，增加溯源难度。
*   **异常处理：**  代码中包含异常处理模块，可能用于隐藏利用过程中的错误信息，避免被发现。
*   **User-Agent:** 使用了常见的User-Agent，但是依然存在替换或者增加其他User-Agent进行恶意攻击.

总体来说，PoC 代码的投毒风险较低，主要集中在以上几点，但需要使用者谨慎使用。

**总结：**

该漏洞利用的有效性很高，并且在野外被广泛利用。PoC 代码可以用来验证漏洞的存在并创建管理员用户，但需要注意潜在的投毒风险。利用方式是发送特制的 SOAP 请求，绕过身份验证，然后执行 CLI 命令。

**项目地址:** [W01fh4cker/CVE-2023-20198-RCE](https://github.com/W01fh4cker/CVE-2023-20198-RCE)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #13

**来源**: [CVE-2023-20198-XiaomingX_cve-2023-20198-poc.md](../2023/CVE-2023-20198-XiaomingX_cve-2023-20198-poc.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响设备

**影响版本:** 受影响版本范围广泛，详见漏洞库信息

**利用条件:** Web UI 功能启用且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 存在于 Cisco IOS XE 软件的 Web UI 中。未经身份验证的攻击者可以利用此漏洞创建具有 privilege level 15 权限的本地用户，从而获得对设备的完全控制权。利用方式主要通过发送特制的 SOAP 请求到目标设备的 Web UI 接口，绕过身份验证，执行 CLI 命令。PoC 代码通过构造恶意的 SOAP 消息，例如 `username <username> privilege 15 secret <password>`，添加高权限用户。 

有效性分析：根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开的 PoC。提供的 PoC 代码实现了漏洞利用的基本功能，包括检查漏洞、获取配置、执行命令和添加/删除用户。因此，提供的 PoC 代码是有效的。

投毒风险分析：代码本身主要实现了漏洞利用功能，但仍然存在一定的投毒风险。体现在以下几个方面：

*   **恶意命令执行：** 虽然代码本身没有硬编码的恶意命令，但 `-e` 参数允许攻击者执行任意 Cisco IOS 命令。攻击者可能会使用此参数注入恶意配置或植入后门。
*   **硬编码凭据：** 默认用户名 `shellsmoke` 和密码 `pwned` 如果不修改，可能被其他攻击者利用。虽然这是一个PoC，但在实际使用中容易被忽视，从而导致设备被二次入侵。
*   **异常处理：** 某些异常处理不够完善，可能导致程序崩溃或泄露敏感信息。
*   **Payload内容:** 在SOAP请求模板中，攻击者可能修改命令或者在ADD_USER的情况下，添加后门账户。

综合考虑，该 PoC 存在一定的投毒风险，但主要集中在用户使用不当或被恶意利用的可能性上，PoC本身是漏洞的利用，投毒代码的可能性评判为 10%。建议使用者在使用 PoC 时仔细审查代码，并采取必要的安全措施。

利用方式总结：

1.  **目标确认：** 确定目标 Cisco IOS XE 设备是否启用了 Web UI 功能。
2.  **发送恶意 SOAP 请求：** 构造包含 CLI 命令的恶意 SOAP 请求，绕过身份验证。
3.  **权限提升：** 利用漏洞创建具有 privilege level 15 权限的本地用户。
4.  **完全控制：** 使用新创建的用户登录并完全控制设备。

**项目地址:** [XiaomingX/cve-2023-20198-poc](https://github.com/XiaomingX/cve-2023-20198-poc)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #14

**来源**: [CVE-2023-20198-ZephrFish_CVE-2023-20198-Checker.md](../2023/CVE-2023-20198-ZephrFish_CVE-2023-20198-Checker.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权15权限的本地用户，随后可能被用于植入后门和完全控制设备

**影响版本:** 受影响版本：16.1.1 到 17.12.1，以及其他相关版本（详见漏洞库信息）

**利用条件:** 目标设备启用了Web UI功能，且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞允许未经身份验证的攻击者在受影响的 Cisco IOS XE 设备上创建一个具有特权 15 权限（最高权限）的本地用户。该漏洞存在于 Web UI 功能中。根据搜索引擎结果和漏洞库信息，此漏洞已被积极利用。提供的漏洞利用代码 `XEImplantScanner.py` 主要用于扫描目标系统是否存在漏洞以及是否被植入后门。该脚本通过发送特定的 HTTP 请求到 `/webui/logoutconfirm.html` 端点来检测漏洞和后门的存在。

**利用方式：**

1.  **初始访问：** 未经身份验证的攻击者发送特制的 HTTP 请求到目标设备的 Web UI。
2.  **权限提升：** 利用 CVE-2023-20198，创建一个具有特权 15 权限的本地用户。
3.  **后门植入（CVE-2023-20273）：** 使用新创建的具有特权的用户，攻击者可以进一步利用另一个漏洞（CVE-2023-20273）来提升权限至 root，并将植入体写入文件系统，实现持久化控制。

**有效性：**

根据搜索引擎结果（例如，horizon3.ai 的文章）和漏洞库信息，CVE-2023-20198 漏洞已被成功利用。提供的 POC 代码 `XEImplantScanner.py` 旨在检测漏洞的存在以及后门的植入，本身不包含直接利用漏洞进行权限提升的代码，需要结合 CVE-2023-20273 来完全控制。

**投毒风险：**

POC 代码 `XEImplantScanner.py` 主要功能是扫描，相对安全。可能的投毒风险在于：

*   **结果误导：** 扫描结果可能被篡改，导致用户误判系统的安全状态。
*   **依赖风险：** 脚本依赖于 `requests` 库，如果 `requests` 库被恶意版本替换，可能导致代码执行。
*   **网络钓鱼:** 脚本可能被用于钓鱼，诱导用户扫描恶意服务器，泄露信息。

因此，评估的投毒风险为 10%。主要是考虑到其扫描器性质，以及依赖库被投毒的可能性。

**项目地址:** [ZephrFish/CVE-2023-20198-Checker](https://github.com/ZephrFish/CVE-2023-20198-Checker)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #15

**来源**: [CVE-2023-20198-alekos3_CVE_2023_20198_Detector.md](../2023/CVE-2023-20198-alekos3_CVE_2023_20198_Detector.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响系统

**影响版本:** 见受影响版本列表

**利用条件:** Web UI 功能已启用,网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。攻击者可以利用此漏洞绕过身份验证，创建一个具有 15 级权限的本地用户，从而完全控制受影响的系统。该漏洞结合 CVE-2023-20273 使用，CVE-2023-20198 用于初始访问，CVE-2023-20273 用于提权至 root 并写入植入程序到文件系统。

**利用方式：**

1.  未经身份验证的攻击者发送特制的HTTP请求到启用了Web UI的Cisco IOS XE设备。
2.  利用CVE-2023-20198漏洞，创建一个具有特权级别15的本地用户。
3.  使用新创建的本地用户利用CVE-2023-20273漏洞，将权限提升到root。
4.  将植入程序写入文件系统，从而完全控制设备。

**POC代码分析：**

提供的Python脚本 (`CVE_2023_20198_detector.py`) 主要用于检测设备是否存在漏洞，而不是利用该漏洞。它通过SSH连接到设备，并运行一些命令来检查Web UI是否启用，并尝试检测是否存在攻击迹象，例如存在`ip http server`, `ip http secure-server`,  `ip http active`配置。脚本通过`netmiko`库实现SSH连接和命令执行。该脚本没有直接创建特权用户的恶意代码，只是用于检测是否存在漏洞。该脚本会生成一个csv文件`Results_CVE_2023_20198_{current_timestamp}.csv` 用于记录检测结果。

**有效性：**

根据搜索引擎结果，存在公开的POC代码，可以创建特权用户。`CVE_2023_20198_detector.py`脚本本身并不能直接利用漏洞，它只能用来检测目标是否存在漏洞。

**投毒风险：**

该脚本的投毒风险极低 (0%)。虽然用户需要输入用户名和密码，但是该脚本只是用来检测是否存在漏洞，没有发现任何可疑的代码或后门，也没有修改系统配置的任何行为。LICENSE文件为标准的MIT License。

**项目地址:** [alekos3/CVE_2023_20198_Detector](https://github.com/alekos3/CVE_2023_20198_Detector)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #16

**来源**: [CVE-2023-20198-emomeni_Simple-Ansible-for-CVE-2023-20198.md](../2023/CVE-2023-20198-emomeni_Simple-Ansible-for-CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可导致完全控制受影响的设备

**影响版本:** 16.1.1 to 17.12.1

**利用条件:** Web UI 功能已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。根据漏洞库信息和搜索引擎结果，未经身份验证的攻击者可以利用此漏洞创建一个具有 15 级权限（完全访问所有命令）的本地用户。攻击者首先利用 CVE-2023-20198 获得初始访问权限，然后执行权限 15 命令来创建本地用户和密码组合，允许该用户以普通用户身份登录。 然后攻击者利用 web UI 功能的另一个组件，利用新的本地用户将权限提升到 root 并将植入程序写入文件系统，cve-2023-20273。

**有效性：**
根据搜索引擎结果（例如Horizon3.ai的博客），已经存在公开可用的PoC，并且漏洞被积极利用。提供的Ansible剧本并不是直接的漏洞利用代码，而是用于检测并禁用HTTP/HTTPS服务器以缓解漏洞。它也能检测是否已经遭受攻击，通过分析syslog。

**投毒风险：**
提供的Ansible剧本的主要目的是缓解漏洞，而不是利用漏洞。虽然其中包含连接到Cisco设备的凭据（developer/lastorangerestoreball8876），但这些是 Cisco Always On Sandbox 的公开凭据，用于测试目的。 投毒风险较低，但仍然存在一些风险：

1.  **凭据滥用：**  即使凭据是公开的，也可能有人修改剧本以使用不同的凭据尝试访问其他Cisco设备。
2.  **远程执行：**  Ansible 剧本在目标设备上执行命令。如果剧本被恶意修改，可能会导致设备配置更改或执行其他恶意操作。 鉴于此，大约有10%的可能性存在投毒风险。

**利用方式：**
1.  **初始访问：**  攻击者利用 CVE-2023-20198 中的漏洞，绕过身份验证。
2.  **创建高权限用户：**  攻击者利用未授权访问，创建一个具有 15 级权限的本地用户。
3.  **权限提升(CVE-2023-20273):** 攻击者利用本地用户权限和Web UI的另一个漏洞，将权限提升到 root。
4.  **植入后门：**  攻击者利用 root 权限，在设备上植入后门，以便长期控制。

**项目地址:** [emomeni/Simple-Ansible-for-CVE-2023-20198](https://github.com/emomeni/Simple-Ansible-for-CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #17

**来源**: [CVE-2023-20198-fox-it_cisco-ios-xe-implant-detection.md](../2023/CVE-2023-20198-fox-it_cisco-ios-xe-implant-detection.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未经身份验证的攻击者创建具有特权15的本地用户，最终导致完全控制受影响的设备

**影响版本:** 受影响版本包括16.1.1至17.12.1 以及其他相关版本

**利用条件:** Web UI功能已启用，设备可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198是Cisco IOS XE Software Web UI中的一个权限提升漏洞。攻击者可以利用此漏洞，在未经身份验证的情况下，通过发送特制的HTTP请求绕过身份验证，并在受影响的系统上创建一个具有最高权限（特权级别15）的本地用户。创建具有特权15的用户后，攻击者可以使用该用户登录设备，执行任意命令，并完全控制受影响的Cisco IOS XE设备。攻击者利用CVE-2023-20198获得初始访问权限后，会进一步利用CVE-2023-20273将权限提升到root级别，并在文件系统中写入恶意植入程序。

**利用方式：**

1.  **未经身份验证的访问：** 攻击者通过发送特制的HTTP请求，绕过Cisco IOS XE Web UI的身份验证机制。
2.  **创建特权用户：** 成功绕过身份验证后，攻击者可以执行特权命令，创建一个具有最高权限（特权级别15）的本地用户。
3.  **权限提升：** 使用新创建的具有特权15的用户登录设备。
4.  **植入后门:** 利用CVE-2023-20273，将权限提升到root级别，并在文件系统中写入恶意植入程序。

**关于投毒风险：**

提供的漏洞利用代码仅仅是Apache License 2.0协议，这是一个开源协议，本身不包含任何恶意代码。根据现有信息，没有迹象表明该漏洞利用代码中存在任何隐藏的恶意或投毒代码。

**项目地址:** [fox-it/cisco-ios-xe-implant-detection](https://github.com/fox-it/cisco-ios-xe-implant-detection)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #18

**来源**: [CVE-2023-20198-iveresk_cve-2023-20198.md](../2023/CVE-2023-20198-iveresk_cve-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响的Cisco IOS XE设备

**影响版本:** 受影响版本众多，详见漏洞库信息

**利用条件:** Web UI功能已启用，且设备未打补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-20198是一个Cisco IOS XE Software Web UI中存在的权限提升漏洞。根据漏洞库信息和搜索引擎结果，未经身份验证的攻击者可以通过该漏洞创建具有特权15级别（完全访问权限）的本地用户帐户。攻击者首先利用此漏洞获得初始访问权限，然后结合CVE-2023-20273漏洞，利用新创建的本地用户帐户将权限提升至root级别，并在文件系统中写入植入程序。漏洞利用代码 `cve-2023-20198.py` 提供了 `check` 和 `exploit` 两种模式。`check` 模式用于检测目标是否存在漏洞，`exploit` 模式用于创建本地用户帐户。漏洞利用过程包括向 `/webui/logoutconfirm.html` 发送POST请求进行检测，以及向 `/webui/create_user` 发送POST请求创建用户。投毒风险较低，因为代码主要利用已知的漏洞利用方法，但仍存在被修改以执行恶意操作的可能性，例如在创建用户后立即执行其他命令或植入后门程序。主要风险集中在config_content中，可能会存在其他的攻击代码。

**项目地址:** [iveresk/cve-2023-20198](https://github.com/iveresk/cve-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #19

**来源**: [CVE-2023-20198-kacem-expereo_CVE-2023-20198.md](../2023/CVE-2023-20198-kacem-expereo_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可被未授权的攻击者利用创建具有特权 15 的本地用户，为进一步攻击（如植入后门）铺平道路。

**影响版本:** 16.1.1 to 17.12.1 and potentially other versions as indicated in the CVE description.

**利用条件:** 目标设备启用了 Web UI 功能，且位于攻击者可访问的网络中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。未经身份验证的远程攻击者可以通过向目标设备发送特制的 HTTP 请求来利用此漏洞。该漏洞允许攻击者在受影响的系统上创建一个具有特权级别 15 访问权限的帐户。此漏洞是攻击链的第一步，攻击者利用它来创建具有管理权限的本地用户，然后利用 CVE-2023-20273 进一步提升权限至 root，并在文件系统中写入植入程序。提供的 POC 代码 `main.py` 的作用是检测目标 IP 是否容易受到 CVE-2023-20198 的攻击。它通过发送特定的 GET 和 POST 请求来检查目标设备是否返回预期的响应。如果目标返回指示存在漏洞的响应，脚本将输出 'Vulnerable'，否则输出 'Not Vulnerable'。代码通过发送构造的 HTTP GET 请求来尝试绕过身份验证，并检查是否出现预期的“404 Not Found”响应。同时,代码还发送带有硬编码 Authorization 头的 POST 请求，以进一步确认漏洞的存在。尽管代码本身用于检测漏洞，但潜在的投毒风险在于硬编码的 Authorization 头部，以及对 HTTPS 请求的证书验证的禁用（`verify=False`），这可能被恶意修改以进行中间人攻击或者将流量重定向到恶意服务器，虽然这种可能性不大，只有10%。

**利用方式：**

1.  **未经身份验证的访问：** 攻击者无需任何凭据即可发起攻击。
2.  **特制的 HTTP 请求：**  攻击者构造特定的 HTTP GET/POST 请求，利用漏洞绕过身份验证。
3.  **创建特权用户：** 成功利用漏洞后，攻击者可以创建一个拥有最高权限（特权级别 15）的本地用户。
4.  **后续利用：**  创建的特权用户可被用于进一步的恶意活动，例如植入后门、收集敏感信息等（与 CVE-2023-20273 结合）。

**有效性：**
根据漏洞描述和搜索结果，提供的 POC 代码 `main.py` 旨在检测目标是否存在 CVE-2023-20198 漏洞，而不是直接利用该漏洞创建用户。 它通过发送特定的HTTP请求来验证是否存在漏洞。因此，该POC代码在检测方面是有效的。



**项目地址:** [kacem-expereo/CVE-2023-20198](https://github.com/kacem-expereo/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #20

**来源**: [CVE-2023-20198-mr-r3b00t_CVE-2023-20198-IOS-XE-Scanner.md](../2023/CVE-2023-20198-mr-r3b00t_CVE-2023-20198-IOS-XE-Scanner.md)

## CVE-2023-20198-Cisco IOS XE Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的攻击者创建具有特权15权限的本地用户，进而控制设备。

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他一些版本，具体参考漏洞库信息。

**利用条件:** 目标设备启用了Web UI功能，并且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198 漏洞允许未经身份验证的远程攻击者在受影响的 Cisco IOS XE 设备上创建具有特权级别 15 访问权限的帐户。此漏洞是由于 Web UI 功能中存在未受保护的备用通道漏洞 (CWE-420) 造成的。攻击者可以利用此漏洞获得初始访问权限，然后通过 CVE-2023-20273 进一步提升权限至 root 并植入后门。提供的PoC代码 `implant_scanner.ps1` 实际上是一个检测脚本，用于判断目标系统是否已经被植入后门，通过对比Web页面内容的MD5哈希值来判断。脚本本身没有发现明显的投毒代码，config.json中指定了目标URL和已知的哈希值，用于检测是否存在已知的植入体。因此，该仓库中存在作者隐藏的投毒代码的可能性为0%。利用方式是，首先利用CVE-2023-20198创建一个高权限用户，然后利用CVE-2023-20273提升权限并写入植入体（后门）。

**项目地址:** [mr-r3b00t/CVE-2023-20198-IOS-XE-Scanner](https://github.com/mr-r3b00t/CVE-2023-20198-IOS-XE-Scanner)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #21

**来源**: [CVE-2023-20198-netbell_CVE-2023-20198-Fix.md](../2023/CVE-2023-20198-netbell_CVE-2023-20198-Fix.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权远程攻击者创建特权15用户并控制设备

**影响版本:** 受影响版本众多，详见漏洞库信息

**利用条件:** Web UI功能已启用，设备可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性非常高，因为它已被CISA列入已知被利用漏洞目录，并且Cisco官方也已确认存在活跃的利用。漏洞利用方式如下：

1.  **利用CVE-2023-20198获取初始访问权限:** 未经身份验证的攻击者可以利用此漏洞，通过Web UI创建一个具有特权15（最高权限）的本地用户。
2.  **利用CVE-2023-20273提升权限至Root:** 攻击者创建本地用户后，可以利用CVE-2023-20273进一步提升权限至root，并将恶意程序写入文件系统，实现完全控制。

提供的漏洞利用代码（Ansible playbook）实际上是一个缓解措施，旨在禁用Web UI以阻止利用。虽然主要目的是缓解漏洞，但该仓库中存在一定投毒风险。例如:

*   **inventory.yml中的凭据:**  该文件包含默认用户名和密码（admin/admin_password），这可能会被粗心的用户直接用于生产环境，从而使系统暴露于风险之中。
*   **依赖的安全性:**  Ansible playbook的安全性取决于控制机本身的安全。如果控制机被攻破，攻击者可以修改playbook或inventory，从而造成更大范围的损害。

因此，虽然Playbook本身主要是用于缓解漏洞，但配置不当可能导致其他安全问题，存在潜在的投毒风险。务必负责任地存储凭据，使用Ansible Vault或其他安全方法来保护敏感信息。

**项目地址:** [netbell/CVE-2023-20198-Fix](https://github.com/netbell/CVE-2023-20198-Fix)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #22

**来源**: [CVE-2023-20198-ohlawd_CVE-2023-20198.md](../2023/CVE-2023-20198-ohlawd_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，可导致完全控制受影响系统

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他特定版本

**利用条件:** 需要目标设备启用Web UI功能

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。攻击者可以利用此漏洞，在未经身份验证的情况下，通过发送特制请求创建一个具备特权级别15的本地用户，从而获得对设备的完全控制权。由于提供的POC代码仅打印"how bout u exploit d33z nuts"，并没有实际利用漏洞的代码，所以判断其为无效的POC，且具有100%的投毒风险。漏洞利用方式包括：首先利用CVE-2023-20198漏洞获得初始访问权限，然后执行特权15命令以创建本地用户和密码组合。之后，攻击者可能利用CVE-2023-20273漏洞，利用新创建的本地用户将权限提升为root，并将植入程序写入文件系统。

**项目地址:** [ohlawd/CVE-2023-20198](https://github.com/ohlawd/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #23

**来源**: [CVE-2023-20198-raystr-atearedteam_CVE-2023-20198-checker.md](../2023/CVE-2023-20198-raystr-atearedteam_CVE-2023-20198-checker.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI Privilege Escalation

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可能导致完全控制受影响的设备

**影响版本:** 16.1.1 to 17.12.1a 等多个版本 (参考漏洞库信息)

**利用条件:** Web UI功能必须启用，且设备可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-20198 允许未经身份验证的攻击者在受影响的系统上创建一个具有特权级别 15 访问权限的帐户。根据搜索引擎的结果，该漏洞已被积极利用。利用方式是，攻击者首先利用此漏洞获得初始访问权限，然后发出特权 15 命令来创建本地用户和密码组合。然后，攻击者利用另一个漏洞 (CVE-2023-20273) ，利用新创建的本地用户将权限提升为 root 并在文件系统中写入植入程序。 

提供的POC代码尝试通过向 `/webui/logoutconfirm.html` 发送带有 `logon_hash=1` 的POST请求来探测漏洞。如果响应状态码为200，并且响应内容的长度小于32个字符，则可能存在漏洞。POC代码扫描指定的子网，并尝试利用漏洞。 

关于投毒风险，POC代码本身相对简单，主要是网络扫描和HTTP请求。虽然不能完全排除恶意修改的可能性，但代码结构清晰，功能直接，隐藏恶意代码的概率较低。 投毒风险评估较低，大约5%。主要的风险点在于：
1.  **依赖未验证的requests库**：如果requests库本身被投毒，则会影响此脚本。
2.  **成功标志的判断**: 响应内容长度小于32可能是判断依据不足，如果恶意修改，可能导致误报或者漏报，将正常设备标记为存在漏洞，引导使用者进行进一步的恶意操作。

**项目地址:** [raystr-atearedteam/CVE-2023-20198-checker](https://github.com/raystr-atearedteam/CVE-2023-20198-checker)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #24

**来源**: [CVE-2023-20198-reket99_Cisco_CVE-2023-20198.md](../2023/CVE-2023-20198-reket99_Cisco_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，可导致完全控制受影响的Cisco IOS XE设备

**影响版本:** 16.1.1 to 17.12.1 (部分版本)

**利用条件:** Web UI功能已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。攻击者可以利用此漏洞，在未经身份验证的情况下，创建一个具有特权级别15（完全访问所有命令）的本地用户。接下来，攻击者可以利用CVE-2023-20273，通过新创建的本地用户提升权限至root并在文件系统中写入植入物。漏洞利用流程如下：

1.  **CVE-2023-20198 利用:**  未经验证的攻击者通过发送特制的POST请求到`/webui/logoutconfirm.html`，绕过身份验证，创建一个具有管理员权限的新用户。
2.  **CVE-2023-20273 利用:** 使用步骤1中创建的管理员用户，利用另一个Web UI组件中的漏洞，提升权限到root，并写入恶意植入物。

提供的POC代码尝试通过向目标IP地址的`/webui/logoutconfirm.html`发送POST请求来验证漏洞是否存在。如果响应状态码为200，并且响应长度较短（小于32字节），则认为该IP地址易受攻击。然后，脚本会使用curl再次发送请求，如果返回特定的输出长度，则确认漏洞存在。

**关于投毒风险:**

虽然该脚本的主要目的是验证漏洞的存在，但仍然存在一定的投毒风险。风险点在于subprocess.run函数中，使用shell=True来执行curl命令。这使得代码容易受到命令注入攻击，如果攻击者能够控制IP地址或相关参数，则可能执行任意命令。 此外，脚本会将成功利用漏洞的IP地址记录到results.csv 文件中，这虽然不是恶意行为，但可能被恶意行为者利用。投毒风险评估为10%，主要是因为使用了subprocess.run(shell=True)执行外部命令。

**项目地址:** [reket99/Cisco_CVE-2023-20198](https://github.com/reket99/Cisco_CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #25

**来源**: [CVE-2023-20198-sanan2004_CVE-2023-20198.md](../2023/CVE-2023-20198-sanan2004_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响的系统

**影响版本:** 16.1.1 至 17.12.3 以及其他版本

**利用条件:** 目标系统启用了Web UI功能，且位于网络可达范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 存在于 Cisco IOS XE 软件的 Web UI 中。该漏洞允许未经身份验证的攻击者通过不正确的路径验证绕过 Nginx 过滤，访问 `webui_wsma_http` Web 端点，从而可以执行任意 Cisco IOS 命令或进行配置更改，获得 Privilege 15 权限。该漏洞利用涉及两个 XML SOAP 端点：`cisco:wsma-exec` 和 `cisco:wsma-config`。攻击者可以使用 `cisco:wsma-exec` 端点将命令插入到 `execCLI` 元素标记中，例如获取运行配置或执行任意命令。攻击者还可以使用 `cisco:wsma-config` 端点添加具有 Privilege 15 的新用户。随附的 PoC 脚本提供检查漏洞、获取配置、执行命令以及添加/删除用户的功能。PoC 代码的投毒风险较低 (10%)，主要风险在于不熟悉该漏洞的人员可能意外地在生产环境中执行恶意命令，或在测试时使用了存在后门的IOS版本。脚本本身旨在利用漏洞，并且不包含任何明显的恶意或隐藏功能，仓库的README.md声明了此POC的利用方式,降低了隐藏的恶意代码的风险。

**漏洞利用方式：**

1.  **利用 CVE-2023-20198 绕过身份验证：** 攻击者构造特制的 URL 访问易受攻击的 Web UI 端点。
2.  **提升权限：** 成功绕过身份验证后，攻击者可以利用 `cisco:wsma-exec` 或 `cisco:wsma-config` SOAP接口下发命令。
3.  **创建特权用户：** 攻击者创建一个具有 Privilege 15 权限的新用户，从而获得对系统的完全控制。
4.  **执行任意命令：** 攻击者可以使用提权的会话执行任意 Cisco IOS 命令，包括安装后门、修改配置或窃取敏感信息。

**项目地址:** [sanan2004/CVE-2023-20198](https://github.com/sanan2004/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #26

**来源**: [CVE-2023-20198-securityphoenix_cisco-CVE-2023-20198-tester.md](../2023/CVE-2023-20198-securityphoenix_cisco-CVE-2023-20198-tester.md)

## CVE-2023-20198-Cisco IOS XE Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的攻击者创建具有特权15的本地用户，从而完全控制设备

**影响版本:** 受影响的版本包括 16.1.1 到 17.12.1 以及其他版本

**利用条件:** Web UI 功能必须已启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞信息和搜索结果，CVE-2023-20198 允许未经身份验证的攻击者在受影响的 Cisco IOS XE 设备上创建具有 privilege level 15 （最高权限）的本地用户。漏洞利用涉及向 Web UI 发送特制的 HTTP POST 请求，绕过身份验证机制。创建具有最高权限的用户后，攻击者可以使用该账户执行任意命令，并完全控制设备。提供的 `cisco_tester.py` 脚本旨在检测目标设备是否受到 CVE-2023-20198 的影响。它通过向 `/webui/logoutconfirm.html?logon_hash=1` 发送 POST 请求，并检查响应中是否包含特定的字符串 `1a80b7389ccd0a5dab` 来判断设备是否已被入侵。该字符串很可能是一个被利用的设备的特征。

**有效性:**

根据漏洞库信息、搜索结果（特别是 https://www.horizon3.ai/attack-research/attack-blogs/cisco-ios-xe-cve-2023-20198-deep-dive-and-poc/）和漏洞利用代码，该漏洞的利用是有效的，已经有公开可用的PoC。

**投毒风险:**

提供的Python脚本本身主要是一个检测工具，用于检查Cisco设备是否受到CVE-2023-20198的影响，它通过检测特定Hash值判断系统是否已经被植入后门。该脚本逻辑比较简单，主要功能为发送HTTP请求并匹配特定字符串。风险点可能在于脚本对异常的处理不够严谨，如果目标存在其他漏洞，可能被利用，但从代码本身来看，投毒的可能性较低，例如作者没有隐藏恶意的代码执行、数据窃取等行为。可以认为投毒风险极低，可能性约为1%。

**利用方式:**

1.  **未经身份验证的权限提升:**  攻击者利用 CVE-2023-20198 在 Cisco IOS XE 设备上创建一个具有最高权限 (privilege level 15) 的本地用户。
2.  **初始访问:**  利用漏洞绕过 Web UI 的身份验证机制。
3.  **命令执行:**  使用新创建的特权用户账户登录并执行任意命令，实现对设备的完全控制。
4.  **植入后门:** 利用CVE-2023-20273，提升权限至root,写入后门文件。

总而言之，此漏洞允许攻击者完全控制受影响的Cisco设备，风险极高。

**项目地址:** [securityphoenix/cisco-CVE-2023-20198-tester](https://github.com/securityphoenix/cisco-CVE-2023-20198-tester)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #27

**来源**: [CVE-2023-20198-smokeintheshell_CVE-2023-20198.md](../2023/CVE-2023-20198-smokeintheshell_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权用户创建特权用户并执行任意命令

**影响版本:** 受影响版本包括16.1.1到17.12.1等多个版本

**利用条件:** 需要目标设备启用Web UI功能，且攻击者能够网络访问该Web UI。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。该漏洞源于对 Nginx 过滤器的不当路径验证，允许未经身份验证的攻击者绕过身份验证访问 `webui_wsma_http` Web 端点。

**利用方式：**

1.  攻击者利用漏洞绕过身份验证，向 `webui_wsma_http` 端点发送特制的 XML SOAP 请求。
2.  攻击者可以使用 `cisco:wsma-exec` SOAP 端点执行任意 Cisco IOS 命令，或者使用 `cisco:wsma-config` SOAP 端点创建具有 Privilege 15 权限的本地用户。
3.  创建具有 Privilege 15 权限的用户后，攻击者可以使用该用户登录并执行任何操作。
4.  结合CVE-2023-20273，攻击者可以进一步提升权限至root，并写入植入程序。

**有效性：**

根据漏洞描述和提供的漏洞利用代码，该漏洞利用是有效的。漏洞利用代码包含检查漏洞是否存在、获取 Cisco IOS 运行配置、执行任意 Cisco IOS 命令以及添加/删除特权用户的功能。搜索引擎结果也表明该漏洞已被 активно利用。

**投毒风险：**

分析提供的漏洞利用代码（exploit.py），发现以下潜在风险：

*   虽然代码本身看起来直接实现了漏洞利用，但仍然存在作者在代码中加入恶意行为的可能性。
*   例如，可以修改添加用户的函数，在创建高权限用户的同时，静默地执行其他恶意配置更改（如添加后门路由或修改系统日志设置）。
*   代码中使用了多个 SOAP 端点，虽然文档中只提到了 `cisco:wsma-exec` 和 `cisco:wsma-config`，但作者可能利用其他未公开的端点执行恶意操作。
*   因此，需要仔细审查代码的每一行，特别是与网络请求和配置更改相关的部分，以确保没有隐藏的恶意逻辑。
*  根据代码内容，未发现明显的恶意代码，但由于该漏洞可以创建高权限用户，如果攻击者利用该漏洞，完全可以植入后门，存在投毒风险。
*  代码本身风险较低，投毒风险主要体现在被攻击者利用后实施的恶意行为，故将风险调整为10%。

**项目地址:** [smokeintheshell/CVE-2023-20198](https://github.com/smokeintheshell/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #28

**来源**: [CVE-2023-20198-sohaibeb_CVE-2023-20198.md](../2023/CVE-2023-20198-sohaibeb_CVE-2023-20198.md)

# CVE-2023-20198

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-20198-Arshit01_CVE-2023-20198.md](../2023/CVE-2023-20198-Arshit01_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI权限提升漏洞

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响的Cisco设备

**影响版本:** 16.1.1 to 17.12.1及部分17.x版本

**利用条件:** Web UI功能已启用，且目标设备存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。未经身份验证的攻击者可以利用此漏洞创建具有特权级别15（最高权限）的本地用户，从而完全控制受影响的设备。利用过程分为两个阶段：首先利用CVE-2023-20198创建用户，其次利用CVE-2023-20273提升权限至root并写入植入程序。

**漏洞利用方式：**

1.  **身份验证绕过：** 漏洞允许未经身份验证的攻击者与设备的Web UI进行交互。
2.  **创建特权用户：** 攻击者发送特制的SOAP请求到Web UI，该请求绕过身份验证并允许攻击者创建一个具有特权级别15的新用户。
3.  **远程控制：** 创建具有最高权限的用户后，攻击者可以使用此帐户登录设备，并执行任意命令。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的POC代码，可以确认POC代码是有效的。搜索结果中的文章提到了漏洞的成功利用和概念验证代码的存在。POC代码也显示了通过发送特制的XML SOAP请求来创建新用户的机制。

**投毒风险：**

提供的POC代码存在轻微的投毒风险，约为10%。风险点分析如下：

*   **默认用户名和密码：** POC代码使用了默认的用户名（shellsmoke）和密码（pwned）。虽然这方便了漏洞测试，但如果未经修改直接用于攻击，很容易被检测到或被其他人利用。
*   **硬编码的URI：** POC中`exURI = '%2577eb%2575i_%2577sma_Http'`，如果攻击者修改此URI植入恶意代码，可能会导致拒绝服务或者其他恶意行为。
*   **命令执行：** 漏洞本身允许执行任意命令，攻击者可能通过植入恶意命令来感染设备。

需要注意的是，以上只是一些潜在的风险点，具体的投毒行为还需要进一步分析。POC的主要功能是验证漏洞的存在，而非恶意利用。因此，将其判定为具有投毒代码是不准确的。

**项目地址:** [Arshit01/CVE-2023-20198](https://github.com/Arshit01/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #2

**来源**: [CVE-2023-20198-Atea-Redteam_CVE-2023-20198.md](../2023/CVE-2023-20198-Atea-Redteam_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Software Web UI权限提升漏洞

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，未经身份验证的攻击者可以创建具有特权级别15访问权限的帐户，并最终导致完全控制受影响的系统。

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1以及17.11.99SW等众多版本

**利用条件:** Web UI 功能必须启用。需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个关键漏洞。未经身份验证的远程攻击者可以利用此漏洞在受影响的系统上创建具有特权级别 15（完全访问所有命令）的帐户。利用方式是攻击者发送特制的 HTTP 请求到 `/webui/logoutconfirm.html?logon_hash=1` 路径，绕过身份验证，并执行特权命令以创建本地用户和密码组合。创建用户后，攻击者可以利用另一个漏洞（CVE-2023-20273）提升权限至 root 并写入植入程序到文件系统。提供的 Python 脚本 `CVE-2023-20198.py` 旨在检测是否存在该漏洞，并检查已知的 IOC。  该脚本扫描指定子网，并检查目标设备是否返回预期的响应状态码和内容长度。投毒风险评估：脚本本身主要用于检测，但由于脚本包含发送特定请求到目标设备的逻辑，如果攻击者修改此脚本，可能会加入恶意负载或更改用户创建的用户名/密码，存在一定的投毒风险.脚本中存在User-Agent:Atea Red Team CVE-2023-20198 checkscript特征,可能被安全设备检测到。存在的风险点是如果未经授权的人员使用了修改后的脚本，可能会对网络造成损害。 README.md文件没有发现异常。

**项目地址:** [Atea-Redteam/CVE-2023-20198](https://github.com/Atea-Redteam/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #3

**来源**: [CVE-2023-20198-DOMINIC471_qub-network-security-cve-2023-20198.md](../2023/CVE-2023-20198-DOMINIC471_qub-network-security-cve-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权级别15的账户，完全控制受影响的设备。

**影响版本:** 受影响版本众多，包括16.1.1到17.12.1以及其他版本（详见漏洞库信息）。

**利用条件:** Web UI功能必须已启用。设备需要可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞允许未经身份验证的攻击者在Cisco IOS XE设备上创建具有特权级别15（最高权限）的本地用户。攻击者通过利用Web UI中的漏洞绕过身份验证，并执行特权命令创建用户。结合另一个漏洞CVE-2023-20273，攻击者可以进一步提升权限至root并写入植入程序到文件系统。 

**有效性评估：**
根据提供的漏洞库信息和搜索结果，CVE-2023-20198是一个严重漏洞，已被积极利用。

**投毒风险评估：**
查看提供的POC代码，包括README.md和IOC Summary.md文件。 README.md主要描述了如何分析、检测和缓解此漏洞。IOC Summary.md列出了攻击者IP，受害者IP，使用的header以及payload等。这些信息可以辅助蓝队进行防御。
总体来说，该仓库的目的是为了分析和缓解漏洞，并没有发现明显的投毒代码。但是，由于代码中可能包含攻击载荷或恶意命令示例，如果使用者不小心，可能会误用这些代码进行非授权的渗透测试，从而导致法律风险。因此，评估的投毒风险为10%。

**利用方式：**
1.  **未授权访问：** 攻击者利用漏洞，绕过Web UI的身份验证机制。
2.  **创建特权用户：** 攻击者通过发送特制的HTTP请求，执行CLI命令，创建一个具有特权级别15的本地用户。
3.  **持久化（结合CVE-2023-20273）：** 攻击者利用新创建的本地用户登录，并利用另一个漏洞（CVE-2023-20273）提升权限到root，并在文件系统中写入植入程序，实现持久化控制。

**缓解措施：**
*   禁用Web UI功能，如果不需要使用。
*   升级到已修复漏洞的IOS XE软件版本。
*   使用入侵检测/防御系统（IDS/IPS）检测和阻止利用此漏洞的攻击。
*   检查设备上是否存在异常用户和植入程序。

**项目地址:** [DOMINIC471/qub-network-security-cve-2023-20198](https://github.com/DOMINIC471/qub-network-security-cve-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #4

**来源**: [CVE-2023-20198-G4sul1n_Cisco-IOS-XE-CVE-2023-20198.md](../2023/CVE-2023-20198-G4sul1n_Cisco-IOS-XE-CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权15权限的本地用户，结合CVE-2023-20273可提升至root权限并植入后门。

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他相关版本，具体参见漏洞库信息。

**利用条件:** 需要目标系统启用Web UI功能，且网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。根据漏洞信息和搜索结果，该漏洞允许未经身份验证的远程攻击者在受影响的系统上创建一个具有特权级别 15 访问权限的帐户。Cisco的公告指出，攻击者首先利用此漏洞获得初始访问权限，然后执行特权 15 命令以创建本地用户和密码组合。随后，攻击者利用 CVE-2023-20273 将权限提升到 root 并将植入程序写入文件系统。根据提供的漏洞利用代码，该 PoC 包含以下功能：

*   **漏洞检查**：通过执行 `uname -a` 命令来验证漏洞是否存在。
*   **获取 Cisco 配置**：执行 `sh run` 命令来提取运行配置。
*   **执行命令**：允许执行任意 Cisco IOS 命令，但警告需要谨慎使用，因为没有输入验证。
*   **添加用户**：创建一个新的特权 15 用户帐户，可以选择指定用户名和密码。
*   **删除用户**：从设备中删除用户帐户。

**有效性：**

该 PoC 代码的有效性较高，因为漏洞库信息和搜索结果都表明该漏洞已被 активно используется。此外，该 PoC 提供了多种利用方式，包括漏洞检查、信息收集和权限提升。

**投毒风险：**

尽管 PoC 代码主要用于利用已知的漏洞，但仍存在一定的投毒风险，估计为10%。风险点包括：

*   **命令执行**：通过 `-e` 选项执行任意命令，攻击者可能利用此功能执行恶意操作。
*   **用户管理**：虽然提供了添加和删除用户的选项，但如果被滥用，可能导致拒绝服务或系统损坏。

虽然PoC代码本身看起来是为了复现漏洞，但不能完全排除代码作者在其中隐藏恶意功能的可能性，例如植入后门、收集敏感信息等。因此，在使用 PoC 代码时，需要进行仔细审查和安全评估。

**利用方式：**

1.  **未经身份验证的访问**：利用 CVE-2023-20198 绕过身份验证，访问 `webui_wsma_http` Web 端点。
2.  **创建特权用户**：使用 `cisco:wsma-config` SOAP 端点创建一个具有特权 15 的新用户帐户。
3.  **执行任意命令**：使用 `cisco:wsma-exec` SOAP 端点执行任意 Cisco IOS 命令。
4.  **权限提升 (结合 CVE-2023-20273)**：利用新创建的特权用户，结合 CVE-2023-20273 将权限提升到 root，并在系统上植入后门。

总而言之，CVE-2023-20198 是一个严重的安全漏洞，需要立即采取措施进行修复。在使用 PoC 代码时，需要谨慎评估风险，并确保在受控环境中进行测试。

**项目地址:** [G4sul1n/Cisco-IOS-XE-CVE-2023-20198](https://github.com/G4sul1n/Cisco-IOS-XE-CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #5

**来源**: [CVE-2023-20198-IceBreakerCode_CVE-2023-20198.md](../2023/CVE-2023-20198-IceBreakerCode_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权级别 15 的帐户，从而完全控制设备

**影响版本:** 16.1.1 to 17.12.1 and earlier versions

**利用条件:** Web UI 功能已启用并且设备易受攻击版本的影响。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个漏洞，允许未经身份验证的远程攻击者在受影响的系统上创建具有特权级别 15 访问权限的帐户。 

**漏洞利用方式：**

1.  攻击者发送一个特制的 HTTP POST 请求到 `/webui/logoutconfirm.html?logon_hash=1` 端点，绕过身份验证。
2.  成功利用此漏洞后，攻击者可以执行任意命令，包括创建具有特权级别 15 的本地用户。
3.  然后，攻击者使用另一个漏洞（CVE-2023-20273）并通过新创建的本地用户权限提升到 root 权限，并将植入程序写入文件系统。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判定该漏洞的POC代码是有效的。漏洞库信息明确指出存在正在进行的漏洞利用活动。搜索结果也提供了多个关于该漏洞的深度分析和POC示例的链接，例如horizon3.ai上的POC代码。
提供的python脚本模拟了发送特制HTTP请求的过程，旨在检测目标系统是否存在漏洞。脚本会检查HTTP响应状态码和响应体内容，以判断是否存在潜在的植入程序。

**投毒风险：**

评估POC代码的投毒风险，需要仔细分析代码是否存在恶意行为，例如：
1.  **植入后门：**  代码是否在目标系统上安装未经授权的后门。
2.  **数据窃取：**  代码是否窃取敏感信息并发送到外部服务器。
3.  **拒绝服务：**  代码是否导致目标系统崩溃或无法正常运行。
4.  **恶意传播：**  代码是否试图感染其他系统。

分析提供的python脚本，该脚本主要用于检测漏洞是否存在，并未发现明显的恶意行为。脚本的功能是发送特定的HTTP请求并检查响应，以确定目标系统是否受到CVE-2023-20198漏洞的影响。然而，使用任何未经授权的漏洞利用代码都存在风险，因为代码的作者可能隐藏了不易察觉的恶意功能。因此，在使用任何POC代码之前，务必进行彻底的安全审查。

考虑到以上因素，判定该POC代码存在10%的投毒风险，主要是由于作者可能隐藏了一些不易察觉的恶意代码，但主要功能是漏洞验证。

**缓解措施：**

*   禁用 Web UI 功能，特别是当设备面向互联网时。
*   将 Web UI 访问限制为受信任的网络。
*   升级到已修复漏洞的 Cisco IOS XE 软件版本。

**项目地址:** [IceBreakerCode/CVE-2023-20198](https://github.com/IceBreakerCode/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #6

**来源**: [CVE-2023-20198-JoyGhoshs_CVE-2023-20198.md](../2023/CVE-2023-20198-JoyGhoshs_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可导致完全控制受影响设备

**影响版本:** 受影响版本范围广泛，详见漏洞库信息

**利用条件:** Web UI功能已启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198 允许未经身份验证的攻击者在受影响的系统上创建具有权限级别15（完全访问权限）的帐户。该漏洞利用方式如下：

1.  **初始访问:** 攻击者利用CVE-2023-20198漏洞，通过Web UI创建具有高权限的本地用户。
2.  **权限提升:** 然后，攻击者可能利用CVE-2023-20273（另一个漏洞）或使用新创建的本地用户进一步将权限提升至root。
3.  **植入后门:** 攻击者利用获得的root权限，在文件系统中写入恶意植入。

提供的POC代码`poc.py`是一个**检测工具**，而非完整的漏洞利用代码。它通过发送一个特定的HTTP请求到`/webui/logoutconfirm.html?logon_hash=1`，并检查响应内容是否为十六进制字符串来判断目标是否可能受到了攻击并植入了后门。如果响应是十六进制字符串，则表明设备可能已遭入侵，并存在植入的后门（该后门会返回hex信息）。

该存储库中的`README.md`文件说明，此脚本并非完整的POC，仅用于检查是否存在hex响应。因此，它无法直接用于漏洞利用，而只能用于检测。

**投毒风险分析：**

查看`poc.py`文件内容，发现其功能主要是发送HTTP请求并判断响应内容。该代码的功能比较简单，未发现任何可能导致恶意行为（例如，上传恶意文件、执行任意命令等）的可疑代码。因此，可以认为该存储库不存在作者隐藏的投毒代码。



**项目地址:** [JoyGhoshs/CVE-2023-20198](https://github.com/JoyGhoshs/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #7

**来源**: [CVE-2023-20198-Pushkarup_CVE-2023-20198.md](../2023/CVE-2023-20198-Pushkarup_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的远程攻击者创建管理员账户并完全控制设备

**影响版本:** 受影响版本详见CVE描述

**利用条件:** 目标设备启用了Web UI功能，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞存在于 Cisco IOS XE 软件的 Web UI 中。未经身份验证的远程攻击者可以通过利用此漏洞在受影响的系统上创建具有特权级别 15 访问权限的帐户。创建账户后，攻击者可以使用该账户完全控制受损的机器。

**有效性：**
提供的 POC 代码根据描述能够创建本地用户，安装植入体，重启Web服务，并检查植入体的状态，因此具备有效性。

**投毒风险：**
此仓库中可能存在作者隐藏的投毒代码。尽管自述文件声明 PoC 仅用于教育目的，并且使用需要遵守道德规范，但攻击者可以修改 `config_content` 以包含恶意配置，例如更改防火墙规则或执行其他恶意操作。此外，虽然代码本身没有明显的恶意行为，但其目的是在目标系统上创建具有管理权限的用户，这本身就可以被认为是恶意的。因此，存在一定的投毒风险，但是相对较低，风险评估在10%。此风险评估基于以下因素：
    *   代码可能被用于未授权的系统访问。
    *   配置文件可被修改为包含恶意指令。

**利用方式：**
1.  攻击者利用 CVE-2023-20198 漏洞，通过未授权访问在 Cisco IOS XE 设备上创建一个具有特权级别 15 的本地用户。
2.  攻击者使用新创建的管理员账户登录到设备。
3.  攻击者利用 CVE-2023-20273 漏洞，进一步提升权限至 root 级别，并将恶意植入程序写入文件系统。
4.  攻击者通过植入的后门程序远程控制设备，执行恶意操作，例如数据窃取、网络攻击等。
根据搜索结果，CISA 已将此漏洞添加到已知被利用的漏洞目录中，表明该漏洞已经被广泛利用。

**项目地址:** [Pushkarup/CVE-2023-20198](https://github.com/Pushkarup/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #8

**来源**: [CVE-2023-20198-RevoltSecurities_CVE-2023-20198.md](../2023/CVE-2023-20198-RevoltSecurities_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，可被未授权的攻击者利用创建特权用户，进而完全控制系统。

**影响版本:** 受影响的版本包括16.1.1到17.12.1以及其他一系列17.x版本 (详见漏洞库信息)

**利用条件:** 目标设备启用Web UI功能，并且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。根据漏洞库信息和搜索引擎结果，未经身份验证的攻击者可以利用此漏洞在受影响的系统上创建一个具有 15 级权限（最高权限）的帐户。随后攻击者再利用CVE-2023-20273，将权限提升至root，并写入植入体。该漏洞的利用方式如下：

1.  **漏洞触发：** 攻击者发送特制的HTTP请求到Cisco IOS XE设备的Web UI接口，绕过身份验证。
2.  **创建特权用户：** 请求中包含特定的XML内容，该内容允许攻击者创建一个新的本地用户，并分配最高权限（privilege level 15）。
3.  **权限提升：** 攻击者利用创建的特权用户登录系统。
4.  **植入后门：** 攻击者通过Web UI的另一个组件（CVE-2023-20273）将权限提升至root并写入植入体。

**有效性：** 根据搜索引擎结果（特别是horizon3.ai的POC）以及提供的漏洞利用代码，此漏洞利用是有效的。漏洞利用代码仓库提供了一个Python脚本，可以检测和利用此漏洞。

**投毒风险：** 漏洞利用代码仓库的投毒风险评估为10%。虽然该仓库提供了看似合理的漏洞利用脚本，但存在以下潜在风险点：

*   **自定义配置内容：** 脚本允许用户提供自定义的配置内容（`-cfc` 或 `--config-content` 参数），这可能被滥用以注入恶意代码或配置。
*   **隐蔽后门：** 虽然主要功能是利用漏洞，但作者可能在代码中添加了不易察觉的后门，例如收集目标信息、执行任意命令等。代码量较少，通读代码可以降低风险。

**防范措施：**

*   立即更新Cisco IOS XE软件到已修复的版本。
*   禁用Web UI功能，如果不需要。
*   监控网络流量，检测异常的Web UI请求。
*   使用Cisco提供的软件检查工具来识别和移除潜在的植入体。

**项目地址:** [RevoltSecurities/CVE-2023-20198](https://github.com/RevoltSecurities/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #9

**来源**: [CVE-2023-20198-Shadow0ps_CVE-2023-20198-Scanner.md](../2023/CVE-2023-20198-Shadow0ps_CVE-2023-20198-Scanner.md)

## CVE-2023-20198 Cisco IOS XE Web UI 权限提升漏洞

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权 15 权限的本地用户，从而完全控制受影响的设备。

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1 以及 17.11.99SW

**利用条件:** Web UI 功能必须已启用。攻击者需要能够通过网络访问设备的 Web UI。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。未经身份验证的远程攻击者可以利用此漏洞在受影响的系统上创建一个具有特权 15 访问权限的帐户，本质上是管理员权限。漏洞利用通常与另一个漏洞 CVE-2023-20273 结合使用，后者用于将权限提升到 root 并将植入程序写入文件系统。

**漏洞利用有效性：**

根据漏洞库信息、搜索引擎结果（特别是 horizon3.ai 的 PoC 描述）以及提供的漏洞利用代码片段来看，该漏洞的利用是有效的。存在公开可用的 PoC，允许攻击者绕过身份验证创建具有管理权限的用户。

**投毒风险分析：**

提供的代码片段分析表明，攻击流程依赖于 Nginx 配置和一个 Lua 脚本。Lua 脚本的核心功能在于身份验证绕过和命令执行。脚本通过检查是否存在特定的 "Authorization" Header以及Header的内容是否和通过REDACTED命令执行结果匹配来确定请求是否被授权。

由于 "REDACTED" 信息的缺失，我们无法完全确定是否存在恶意投毒代码。但是lua脚本的下列行为存在潜在的投毒风险：

1.  **外部命令执行:** 脚本多次使用 `io.popen()` 执行外部命令。如果这些命令包含恶意参数或旨在下载和执行其他代码，则可能导致系统受损。
2.  **硬编码的凭据和逻辑：**脚本逻辑依赖于特定的哈希值和其他硬编码的字符串。攻击者可能会修改这些字符串以创建变体，从而绕过安全检测或植入后门。
3.  **对/lua5的请求:** 当common_type=iox时,会调用/lua5,如果/lua5是作者控制的地址,则存在投毒风险。

基于以上分析，虽然无法确定明确的投毒代码，但脚本中使用的技术（尤其是外部命令执行）增加了被用于恶意目的的可能性，估计投毒风险为20%。

**漏洞利用方式：**

1.  **未授权访问:** 攻击者发送一个特制的 HTTP POST 请求到 `/webui/logoutconfirm.html`，绕过身份验证检查（利用 CVE-2023-20198）。这可能涉及到提供特定的 `Authorization` header，该header的值能够通过预设的验证。
2.  **创建高权限用户:** 绕过身份验证后，攻击者可以发送包含创建新用户（具有特权级别 15）的命令的请求体。该命令通过 `io.popen()` 执行，从而创建一个具有管理员权限的本地用户。
3.  **权限提升和植入：** (结合 CVE-2023-20273) 使用新创建的本地用户登录并利用 CVE-2023-20273 将权限提升至 root，从而能够在设备上安装植入程序。


**项目地址:** [Shadow0ps/CVE-2023-20198-Scanner](https://github.com/Shadow0ps/CVE-2023-20198-Scanner)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #10

**来源**: [CVE-2023-20198-Tounsi007_CVE-2023-20198.md](../2023/CVE-2023-20198-Tounsi007_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可能导致完全控制受影响设备

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他版本

**利用条件:** 目标设备启用了Web UI功能并且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞存在于Cisco IOS XE Software的Web UI中，允许未经身份验证的远程攻击者创建一个具有特权级别15（完全访问权限）的本地用户帐户。该漏洞利用方式是通过发送特制的HTTP请求到`/webui/create_user`路径来创建用户。攻击者随后可利用创建的用户并通过另一个漏洞CVE-2023-20273提升权限至root并写入植入程序。提供的POC代码尝试模拟此过程，包括创建用户、安装植入程序、重启Web服务器、检查植入程序状态以及清理创建的用户。 

**有效性：**根据漏洞信息、搜索结果和提供的POC代码，该漏洞是有效的。搜索引擎结果表明该漏洞已被积极利用，并且存在公开可用的POC代码。CISA的已知被利用漏洞目录也收录了该漏洞。

**投毒风险：**POC代码本身存在一定的风险。虽然代码的主要功能是利用漏洞，但`config_content`变量表明存在植入恶意配置的可能性。 用户需要手动插入植入配置,存在被植入后门的风险。
该仓库readme描述，POC仅用于测试和学习，有免责声明。存在一定概率作者未充分测试。

**利用方式：**
1.  **初始访问：** 未经身份验证的攻击者发送特制HTTP请求到存在漏洞的Cisco IOS XE设备的Web UI接口。
2.  **用户创建：**  利用CVE-2023-20198，攻击者通过`/webui/create_user`接口创建一个具有管理员权限的新用户。
3.  **权限提升（CVE-2023-20273）：** 利用新创建的用户，攻击者可以进一步利用Web UI中的另一个漏洞（CVE-2023-20273）来提升权限至root。
4.  **植入后门：** 攻击者可以写入植入程序到文件系统。
5.  **持久化：** 植入程序可以用于维持对受感染设备的访问。
6.  **清理（可选）：** 攻击者可以选择删除他们创建的后门账户，以隐藏其踪迹。

**项目地址:** [Tounsi007/CVE-2023-20198](https://github.com/Tounsi007/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #11

**来源**: [CVE-2023-20198-Vulnmachines_Cisco_CVE-2023-20198.md](../2023/CVE-2023-20198-Vulnmachines_Cisco_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可使未授权的攻击者获得完全管理权限

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1 以及其他多个版本

**利用条件:** Web UI 功能启用并且 HTTP 或 HTTPS 服务器功能开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个关键身份验证绕过漏洞。根据漏洞信息和搜索结果，攻击者利用此漏洞首先获得初始访问权限，然后执行特权 15 命令来创建一个本地用户和密码组合，从而获得管理员权限。之后，攻击者利用 CVE-2023-20273 将权限提升到 root 并在文件系统中写入植入程序。提供的 POC 代码显示了一个用于利用漏洞的 HTTP POST 请求示例。请求的目标 URI 经过编码处理，绕过了身份验证。请求体包含一个 SOAP 信封，该信封尝试使用默认的 "admin" 用户名执行命令 "uname -a"。有效性：根据搜索结果和漏洞描述，提供的 POST 请求通过身份验证绕过在受影响的设备上创建具有特权 15 的用户，因此 POC 代码有效。 投毒风险：README.md 文件描述了漏洞，并提供了一个关于利用该漏洞的概述。Payload 文件包含一个 SOAP 请求，用于发送 CLI 命令。虽然该请求本身看起来无害（执行 `uname -a` 命令），但攻击者可能会修改该请求以执行恶意命令。例如，更改命令以创建具有特权 15 的用户。 因此，存在一定风险，即此仓库可能被用于传播恶意利用程序。Payload 代码文件本身没有明显的投毒代码，但存在被修改利用的风险，因此判定投毒风险为 10%。利用方式：1. 检查目标 Cisco IOS XE 设备是否启用了 Web UI 功能和 HTTP/HTTPS 服务器。2. 发送构造的 HTTP POST 请求到目标设备，利用身份验证绕过漏洞。3. 请求的目标 URI 经过编码处理以绕过身份验证检查。4. POST 请求的内容为 SOAP 信封，其中包含要执行的 CLI 命令。5. 成功利用后，攻击者可以在设备上执行任意 CLI 命令，例如创建新的管理员帐户或植入恶意软件。

**项目地址:** [Vulnmachines/Cisco_CVE-2023-20198](https://github.com/Vulnmachines/Cisco_CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #12

**来源**: [CVE-2023-20198-W01fh4cker_CVE-2023-20198-RCE.md](../2023/CVE-2023-20198-W01fh4cker_CVE-2023-20198-RCE.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权15的用户，进而完全控制受影响的设备。

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1 等多个版本

**利用条件:** Web UI 功能已启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。未经身份验证的远程攻击者可以利用此漏洞在受影响的系统上创建一个具有特权 15 访问权限的帐户，从而完全控制设备。利用方式如下：

1.  **漏洞触发点：** Cisco IOS XE 软件的 Web UI 组件存在漏洞。
2.  **利用过程：** 攻击者通过发送特制的 SOAP 请求到 `/%%77ebui_wsma_https` 或 `/%%77ebui_wsma_Http` URI (具体取决于是否使用 HTTPS) 绕过身份验证。
3.  **命令执行：** 攻击者使用 `urn:cisco:wsma-config` 命名空间执行 CLI 命令，创建新的具有特权 15 的用户。
4.  **后续利用 (CVE-2023-20273):** 在获得初始访问权限后，攻击者可以利用 CVE-2023-20273 将权限提升为 root 并在文件系统中写入植入程序。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞已被积极利用，提供的 PoC 代码有效，可以用于创建具有特权 15 的用户。

**投毒风险：**

PoC 代码主要功能是利用漏洞，创建新用户，从代码本身来看，存在一些潜在的投毒点，例如：

*   **随机用户名/密码生成：**  虽然代码中包含随机用户名生成函数，但实际使用中，攻击者可能会替换为预设的用户名和密码，方便后续控制。
*   **代理服务器使用：**  PoC 代码支持使用代理服务器，攻击者可以借此隐藏真实 IP 地址，增加溯源难度。
*   **异常处理：**  代码中包含异常处理模块，可能用于隐藏利用过程中的错误信息，避免被发现。
*   **User-Agent:** 使用了常见的User-Agent，但是依然存在替换或者增加其他User-Agent进行恶意攻击.

总体来说，PoC 代码的投毒风险较低，主要集中在以上几点，但需要使用者谨慎使用。

**总结：**

该漏洞利用的有效性很高，并且在野外被广泛利用。PoC 代码可以用来验证漏洞的存在并创建管理员用户，但需要注意潜在的投毒风险。利用方式是发送特制的 SOAP 请求，绕过身份验证，然后执行 CLI 命令。

**项目地址:** [W01fh4cker/CVE-2023-20198-RCE](https://github.com/W01fh4cker/CVE-2023-20198-RCE)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #13

**来源**: [CVE-2023-20198-XiaomingX_cve-2023-20198-poc.md](../2023/CVE-2023-20198-XiaomingX_cve-2023-20198-poc.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响设备

**影响版本:** 受影响版本范围广泛，详见漏洞库信息

**利用条件:** Web UI 功能启用且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 存在于 Cisco IOS XE 软件的 Web UI 中。未经身份验证的攻击者可以利用此漏洞创建具有 privilege level 15 权限的本地用户，从而获得对设备的完全控制权。利用方式主要通过发送特制的 SOAP 请求到目标设备的 Web UI 接口，绕过身份验证，执行 CLI 命令。PoC 代码通过构造恶意的 SOAP 消息，例如 `username <username> privilege 15 secret <password>`，添加高权限用户。 

有效性分析：根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开的 PoC。提供的 PoC 代码实现了漏洞利用的基本功能，包括检查漏洞、获取配置、执行命令和添加/删除用户。因此，提供的 PoC 代码是有效的。

投毒风险分析：代码本身主要实现了漏洞利用功能，但仍然存在一定的投毒风险。体现在以下几个方面：

*   **恶意命令执行：** 虽然代码本身没有硬编码的恶意命令，但 `-e` 参数允许攻击者执行任意 Cisco IOS 命令。攻击者可能会使用此参数注入恶意配置或植入后门。
*   **硬编码凭据：** 默认用户名 `shellsmoke` 和密码 `pwned` 如果不修改，可能被其他攻击者利用。虽然这是一个PoC，但在实际使用中容易被忽视，从而导致设备被二次入侵。
*   **异常处理：** 某些异常处理不够完善，可能导致程序崩溃或泄露敏感信息。
*   **Payload内容:** 在SOAP请求模板中，攻击者可能修改命令或者在ADD_USER的情况下，添加后门账户。

综合考虑，该 PoC 存在一定的投毒风险，但主要集中在用户使用不当或被恶意利用的可能性上，PoC本身是漏洞的利用，投毒代码的可能性评判为 10%。建议使用者在使用 PoC 时仔细审查代码，并采取必要的安全措施。

利用方式总结：

1.  **目标确认：** 确定目标 Cisco IOS XE 设备是否启用了 Web UI 功能。
2.  **发送恶意 SOAP 请求：** 构造包含 CLI 命令的恶意 SOAP 请求，绕过身份验证。
3.  **权限提升：** 利用漏洞创建具有 privilege level 15 权限的本地用户。
4.  **完全控制：** 使用新创建的用户登录并完全控制设备。

**项目地址:** [XiaomingX/cve-2023-20198-poc](https://github.com/XiaomingX/cve-2023-20198-poc)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #14

**来源**: [CVE-2023-20198-ZephrFish_CVE-2023-20198-Checker.md](../2023/CVE-2023-20198-ZephrFish_CVE-2023-20198-Checker.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权15权限的本地用户，随后可能被用于植入后门和完全控制设备

**影响版本:** 受影响版本：16.1.1 到 17.12.1，以及其他相关版本（详见漏洞库信息）

**利用条件:** 目标设备启用了Web UI功能，且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞允许未经身份验证的攻击者在受影响的 Cisco IOS XE 设备上创建一个具有特权 15 权限（最高权限）的本地用户。该漏洞存在于 Web UI 功能中。根据搜索引擎结果和漏洞库信息，此漏洞已被积极利用。提供的漏洞利用代码 `XEImplantScanner.py` 主要用于扫描目标系统是否存在漏洞以及是否被植入后门。该脚本通过发送特定的 HTTP 请求到 `/webui/logoutconfirm.html` 端点来检测漏洞和后门的存在。

**利用方式：**

1.  **初始访问：** 未经身份验证的攻击者发送特制的 HTTP 请求到目标设备的 Web UI。
2.  **权限提升：** 利用 CVE-2023-20198，创建一个具有特权 15 权限的本地用户。
3.  **后门植入（CVE-2023-20273）：** 使用新创建的具有特权的用户，攻击者可以进一步利用另一个漏洞（CVE-2023-20273）来提升权限至 root，并将植入体写入文件系统，实现持久化控制。

**有效性：**

根据搜索引擎结果（例如，horizon3.ai 的文章）和漏洞库信息，CVE-2023-20198 漏洞已被成功利用。提供的 POC 代码 `XEImplantScanner.py` 旨在检测漏洞的存在以及后门的植入，本身不包含直接利用漏洞进行权限提升的代码，需要结合 CVE-2023-20273 来完全控制。

**投毒风险：**

POC 代码 `XEImplantScanner.py` 主要功能是扫描，相对安全。可能的投毒风险在于：

*   **结果误导：** 扫描结果可能被篡改，导致用户误判系统的安全状态。
*   **依赖风险：** 脚本依赖于 `requests` 库，如果 `requests` 库被恶意版本替换，可能导致代码执行。
*   **网络钓鱼:** 脚本可能被用于钓鱼，诱导用户扫描恶意服务器，泄露信息。

因此，评估的投毒风险为 10%。主要是考虑到其扫描器性质，以及依赖库被投毒的可能性。

**项目地址:** [ZephrFish/CVE-2023-20198-Checker](https://github.com/ZephrFish/CVE-2023-20198-Checker)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #15

**来源**: [CVE-2023-20198-alekos3_CVE_2023_20198_Detector.md](../2023/CVE-2023-20198-alekos3_CVE_2023_20198_Detector.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响系统

**影响版本:** 见受影响版本列表

**利用条件:** Web UI 功能已启用,网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。攻击者可以利用此漏洞绕过身份验证，创建一个具有 15 级权限的本地用户，从而完全控制受影响的系统。该漏洞结合 CVE-2023-20273 使用，CVE-2023-20198 用于初始访问，CVE-2023-20273 用于提权至 root 并写入植入程序到文件系统。

**利用方式：**

1.  未经身份验证的攻击者发送特制的HTTP请求到启用了Web UI的Cisco IOS XE设备。
2.  利用CVE-2023-20198漏洞，创建一个具有特权级别15的本地用户。
3.  使用新创建的本地用户利用CVE-2023-20273漏洞，将权限提升到root。
4.  将植入程序写入文件系统，从而完全控制设备。

**POC代码分析：**

提供的Python脚本 (`CVE_2023_20198_detector.py`) 主要用于检测设备是否存在漏洞，而不是利用该漏洞。它通过SSH连接到设备，并运行一些命令来检查Web UI是否启用，并尝试检测是否存在攻击迹象，例如存在`ip http server`, `ip http secure-server`,  `ip http active`配置。脚本通过`netmiko`库实现SSH连接和命令执行。该脚本没有直接创建特权用户的恶意代码，只是用于检测是否存在漏洞。该脚本会生成一个csv文件`Results_CVE_2023_20198_{current_timestamp}.csv` 用于记录检测结果。

**有效性：**

根据搜索引擎结果，存在公开的POC代码，可以创建特权用户。`CVE_2023_20198_detector.py`脚本本身并不能直接利用漏洞，它只能用来检测目标是否存在漏洞。

**投毒风险：**

该脚本的投毒风险极低 (0%)。虽然用户需要输入用户名和密码，但是该脚本只是用来检测是否存在漏洞，没有发现任何可疑的代码或后门，也没有修改系统配置的任何行为。LICENSE文件为标准的MIT License。

**项目地址:** [alekos3/CVE_2023_20198_Detector](https://github.com/alekos3/CVE_2023_20198_Detector)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #16

**来源**: [CVE-2023-20198-emomeni_Simple-Ansible-for-CVE-2023-20198.md](../2023/CVE-2023-20198-emomeni_Simple-Ansible-for-CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可导致完全控制受影响的设备

**影响版本:** 16.1.1 to 17.12.1

**利用条件:** Web UI 功能已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。根据漏洞库信息和搜索引擎结果，未经身份验证的攻击者可以利用此漏洞创建一个具有 15 级权限（完全访问所有命令）的本地用户。攻击者首先利用 CVE-2023-20198 获得初始访问权限，然后执行权限 15 命令来创建本地用户和密码组合，允许该用户以普通用户身份登录。 然后攻击者利用 web UI 功能的另一个组件，利用新的本地用户将权限提升到 root 并将植入程序写入文件系统，cve-2023-20273。

**有效性：**
根据搜索引擎结果（例如Horizon3.ai的博客），已经存在公开可用的PoC，并且漏洞被积极利用。提供的Ansible剧本并不是直接的漏洞利用代码，而是用于检测并禁用HTTP/HTTPS服务器以缓解漏洞。它也能检测是否已经遭受攻击，通过分析syslog。

**投毒风险：**
提供的Ansible剧本的主要目的是缓解漏洞，而不是利用漏洞。虽然其中包含连接到Cisco设备的凭据（developer/lastorangerestoreball8876），但这些是 Cisco Always On Sandbox 的公开凭据，用于测试目的。 投毒风险较低，但仍然存在一些风险：

1.  **凭据滥用：**  即使凭据是公开的，也可能有人修改剧本以使用不同的凭据尝试访问其他Cisco设备。
2.  **远程执行：**  Ansible 剧本在目标设备上执行命令。如果剧本被恶意修改，可能会导致设备配置更改或执行其他恶意操作。 鉴于此，大约有10%的可能性存在投毒风险。

**利用方式：**
1.  **初始访问：**  攻击者利用 CVE-2023-20198 中的漏洞，绕过身份验证。
2.  **创建高权限用户：**  攻击者利用未授权访问，创建一个具有 15 级权限的本地用户。
3.  **权限提升(CVE-2023-20273):** 攻击者利用本地用户权限和Web UI的另一个漏洞，将权限提升到 root。
4.  **植入后门：**  攻击者利用 root 权限，在设备上植入后门，以便长期控制。

**项目地址:** [emomeni/Simple-Ansible-for-CVE-2023-20198](https://github.com/emomeni/Simple-Ansible-for-CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #17

**来源**: [CVE-2023-20198-fox-it_cisco-ios-xe-implant-detection.md](../2023/CVE-2023-20198-fox-it_cisco-ios-xe-implant-detection.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未经身份验证的攻击者创建具有特权15的本地用户，最终导致完全控制受影响的设备

**影响版本:** 受影响版本包括16.1.1至17.12.1 以及其他相关版本

**利用条件:** Web UI功能已启用，设备可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198是Cisco IOS XE Software Web UI中的一个权限提升漏洞。攻击者可以利用此漏洞，在未经身份验证的情况下，通过发送特制的HTTP请求绕过身份验证，并在受影响的系统上创建一个具有最高权限（特权级别15）的本地用户。创建具有特权15的用户后，攻击者可以使用该用户登录设备，执行任意命令，并完全控制受影响的Cisco IOS XE设备。攻击者利用CVE-2023-20198获得初始访问权限后，会进一步利用CVE-2023-20273将权限提升到root级别，并在文件系统中写入恶意植入程序。

**利用方式：**

1.  **未经身份验证的访问：** 攻击者通过发送特制的HTTP请求，绕过Cisco IOS XE Web UI的身份验证机制。
2.  **创建特权用户：** 成功绕过身份验证后，攻击者可以执行特权命令，创建一个具有最高权限（特权级别15）的本地用户。
3.  **权限提升：** 使用新创建的具有特权15的用户登录设备。
4.  **植入后门:** 利用CVE-2023-20273，将权限提升到root级别，并在文件系统中写入恶意植入程序。

**关于投毒风险：**

提供的漏洞利用代码仅仅是Apache License 2.0协议，这是一个开源协议，本身不包含任何恶意代码。根据现有信息，没有迹象表明该漏洞利用代码中存在任何隐藏的恶意或投毒代码。

**项目地址:** [fox-it/cisco-ios-xe-implant-detection](https://github.com/fox-it/cisco-ios-xe-implant-detection)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #18

**来源**: [CVE-2023-20198-iveresk_cve-2023-20198.md](../2023/CVE-2023-20198-iveresk_cve-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响的Cisco IOS XE设备

**影响版本:** 受影响版本众多，详见漏洞库信息

**利用条件:** Web UI功能已启用，且设备未打补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-20198是一个Cisco IOS XE Software Web UI中存在的权限提升漏洞。根据漏洞库信息和搜索引擎结果，未经身份验证的攻击者可以通过该漏洞创建具有特权15级别（完全访问权限）的本地用户帐户。攻击者首先利用此漏洞获得初始访问权限，然后结合CVE-2023-20273漏洞，利用新创建的本地用户帐户将权限提升至root级别，并在文件系统中写入植入程序。漏洞利用代码 `cve-2023-20198.py` 提供了 `check` 和 `exploit` 两种模式。`check` 模式用于检测目标是否存在漏洞，`exploit` 模式用于创建本地用户帐户。漏洞利用过程包括向 `/webui/logoutconfirm.html` 发送POST请求进行检测，以及向 `/webui/create_user` 发送POST请求创建用户。投毒风险较低，因为代码主要利用已知的漏洞利用方法，但仍存在被修改以执行恶意操作的可能性，例如在创建用户后立即执行其他命令或植入后门程序。主要风险集中在config_content中，可能会存在其他的攻击代码。

**项目地址:** [iveresk/cve-2023-20198](https://github.com/iveresk/cve-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #19

**来源**: [CVE-2023-20198-kacem-expereo_CVE-2023-20198.md](../2023/CVE-2023-20198-kacem-expereo_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可被未授权的攻击者利用创建具有特权 15 的本地用户，为进一步攻击（如植入后门）铺平道路。

**影响版本:** 16.1.1 to 17.12.1 and potentially other versions as indicated in the CVE description.

**利用条件:** 目标设备启用了 Web UI 功能，且位于攻击者可访问的网络中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。未经身份验证的远程攻击者可以通过向目标设备发送特制的 HTTP 请求来利用此漏洞。该漏洞允许攻击者在受影响的系统上创建一个具有特权级别 15 访问权限的帐户。此漏洞是攻击链的第一步，攻击者利用它来创建具有管理权限的本地用户，然后利用 CVE-2023-20273 进一步提升权限至 root，并在文件系统中写入植入程序。提供的 POC 代码 `main.py` 的作用是检测目标 IP 是否容易受到 CVE-2023-20198 的攻击。它通过发送特定的 GET 和 POST 请求来检查目标设备是否返回预期的响应。如果目标返回指示存在漏洞的响应，脚本将输出 'Vulnerable'，否则输出 'Not Vulnerable'。代码通过发送构造的 HTTP GET 请求来尝试绕过身份验证，并检查是否出现预期的“404 Not Found”响应。同时,代码还发送带有硬编码 Authorization 头的 POST 请求，以进一步确认漏洞的存在。尽管代码本身用于检测漏洞，但潜在的投毒风险在于硬编码的 Authorization 头部，以及对 HTTPS 请求的证书验证的禁用（`verify=False`），这可能被恶意修改以进行中间人攻击或者将流量重定向到恶意服务器，虽然这种可能性不大，只有10%。

**利用方式：**

1.  **未经身份验证的访问：** 攻击者无需任何凭据即可发起攻击。
2.  **特制的 HTTP 请求：**  攻击者构造特定的 HTTP GET/POST 请求，利用漏洞绕过身份验证。
3.  **创建特权用户：** 成功利用漏洞后，攻击者可以创建一个拥有最高权限（特权级别 15）的本地用户。
4.  **后续利用：**  创建的特权用户可被用于进一步的恶意活动，例如植入后门、收集敏感信息等（与 CVE-2023-20273 结合）。

**有效性：**
根据漏洞描述和搜索结果，提供的 POC 代码 `main.py` 旨在检测目标是否存在 CVE-2023-20198 漏洞，而不是直接利用该漏洞创建用户。 它通过发送特定的HTTP请求来验证是否存在漏洞。因此，该POC代码在检测方面是有效的。



**项目地址:** [kacem-expereo/CVE-2023-20198](https://github.com/kacem-expereo/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #20

**来源**: [CVE-2023-20198-mr-r3b00t_CVE-2023-20198-IOS-XE-Scanner.md](../2023/CVE-2023-20198-mr-r3b00t_CVE-2023-20198-IOS-XE-Scanner.md)

## CVE-2023-20198-Cisco IOS XE Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的攻击者创建具有特权15权限的本地用户，进而控制设备。

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他一些版本，具体参考漏洞库信息。

**利用条件:** 目标设备启用了Web UI功能，并且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198 漏洞允许未经身份验证的远程攻击者在受影响的 Cisco IOS XE 设备上创建具有特权级别 15 访问权限的帐户。此漏洞是由于 Web UI 功能中存在未受保护的备用通道漏洞 (CWE-420) 造成的。攻击者可以利用此漏洞获得初始访问权限，然后通过 CVE-2023-20273 进一步提升权限至 root 并植入后门。提供的PoC代码 `implant_scanner.ps1` 实际上是一个检测脚本，用于判断目标系统是否已经被植入后门，通过对比Web页面内容的MD5哈希值来判断。脚本本身没有发现明显的投毒代码，config.json中指定了目标URL和已知的哈希值，用于检测是否存在已知的植入体。因此，该仓库中存在作者隐藏的投毒代码的可能性为0%。利用方式是，首先利用CVE-2023-20198创建一个高权限用户，然后利用CVE-2023-20273提升权限并写入植入体（后门）。

**项目地址:** [mr-r3b00t/CVE-2023-20198-IOS-XE-Scanner](https://github.com/mr-r3b00t/CVE-2023-20198-IOS-XE-Scanner)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #21

**来源**: [CVE-2023-20198-netbell_CVE-2023-20198-Fix.md](../2023/CVE-2023-20198-netbell_CVE-2023-20198-Fix.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权远程攻击者创建特权15用户并控制设备

**影响版本:** 受影响版本众多，详见漏洞库信息

**利用条件:** Web UI功能已启用，设备可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性非常高，因为它已被CISA列入已知被利用漏洞目录，并且Cisco官方也已确认存在活跃的利用。漏洞利用方式如下：

1.  **利用CVE-2023-20198获取初始访问权限:** 未经身份验证的攻击者可以利用此漏洞，通过Web UI创建一个具有特权15（最高权限）的本地用户。
2.  **利用CVE-2023-20273提升权限至Root:** 攻击者创建本地用户后，可以利用CVE-2023-20273进一步提升权限至root，并将恶意程序写入文件系统，实现完全控制。

提供的漏洞利用代码（Ansible playbook）实际上是一个缓解措施，旨在禁用Web UI以阻止利用。虽然主要目的是缓解漏洞，但该仓库中存在一定投毒风险。例如:

*   **inventory.yml中的凭据:**  该文件包含默认用户名和密码（admin/admin_password），这可能会被粗心的用户直接用于生产环境，从而使系统暴露于风险之中。
*   **依赖的安全性:**  Ansible playbook的安全性取决于控制机本身的安全。如果控制机被攻破，攻击者可以修改playbook或inventory，从而造成更大范围的损害。

因此，虽然Playbook本身主要是用于缓解漏洞，但配置不当可能导致其他安全问题，存在潜在的投毒风险。务必负责任地存储凭据，使用Ansible Vault或其他安全方法来保护敏感信息。

**项目地址:** [netbell/CVE-2023-20198-Fix](https://github.com/netbell/CVE-2023-20198-Fix)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #22

**来源**: [CVE-2023-20198-ohlawd_CVE-2023-20198.md](../2023/CVE-2023-20198-ohlawd_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，可导致完全控制受影响系统

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他特定版本

**利用条件:** 需要目标设备启用Web UI功能

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。攻击者可以利用此漏洞，在未经身份验证的情况下，通过发送特制请求创建一个具备特权级别15的本地用户，从而获得对设备的完全控制权。由于提供的POC代码仅打印"how bout u exploit d33z nuts"，并没有实际利用漏洞的代码，所以判断其为无效的POC，且具有100%的投毒风险。漏洞利用方式包括：首先利用CVE-2023-20198漏洞获得初始访问权限，然后执行特权15命令以创建本地用户和密码组合。之后，攻击者可能利用CVE-2023-20273漏洞，利用新创建的本地用户将权限提升为root，并将植入程序写入文件系统。

**项目地址:** [ohlawd/CVE-2023-20198](https://github.com/ohlawd/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #23

**来源**: [CVE-2023-20198-raystr-atearedteam_CVE-2023-20198-checker.md](../2023/CVE-2023-20198-raystr-atearedteam_CVE-2023-20198-checker.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI Privilege Escalation

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可能导致完全控制受影响的设备

**影响版本:** 16.1.1 to 17.12.1a 等多个版本 (参考漏洞库信息)

**利用条件:** Web UI功能必须启用，且设备可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-20198 允许未经身份验证的攻击者在受影响的系统上创建一个具有特权级别 15 访问权限的帐户。根据搜索引擎的结果，该漏洞已被积极利用。利用方式是，攻击者首先利用此漏洞获得初始访问权限，然后发出特权 15 命令来创建本地用户和密码组合。然后，攻击者利用另一个漏洞 (CVE-2023-20273) ，利用新创建的本地用户将权限提升为 root 并在文件系统中写入植入程序。 

提供的POC代码尝试通过向 `/webui/logoutconfirm.html` 发送带有 `logon_hash=1` 的POST请求来探测漏洞。如果响应状态码为200，并且响应内容的长度小于32个字符，则可能存在漏洞。POC代码扫描指定的子网，并尝试利用漏洞。 

关于投毒风险，POC代码本身相对简单，主要是网络扫描和HTTP请求。虽然不能完全排除恶意修改的可能性，但代码结构清晰，功能直接，隐藏恶意代码的概率较低。 投毒风险评估较低，大约5%。主要的风险点在于：
1.  **依赖未验证的requests库**：如果requests库本身被投毒，则会影响此脚本。
2.  **成功标志的判断**: 响应内容长度小于32可能是判断依据不足，如果恶意修改，可能导致误报或者漏报，将正常设备标记为存在漏洞，引导使用者进行进一步的恶意操作。

**项目地址:** [raystr-atearedteam/CVE-2023-20198-checker](https://github.com/raystr-atearedteam/CVE-2023-20198-checker)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #24

**来源**: [CVE-2023-20198-reket99_Cisco_CVE-2023-20198.md](../2023/CVE-2023-20198-reket99_Cisco_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，可导致完全控制受影响的Cisco IOS XE设备

**影响版本:** 16.1.1 to 17.12.1 (部分版本)

**利用条件:** Web UI功能已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。攻击者可以利用此漏洞，在未经身份验证的情况下，创建一个具有特权级别15（完全访问所有命令）的本地用户。接下来，攻击者可以利用CVE-2023-20273，通过新创建的本地用户提升权限至root并在文件系统中写入植入物。漏洞利用流程如下：

1.  **CVE-2023-20198 利用:**  未经验证的攻击者通过发送特制的POST请求到`/webui/logoutconfirm.html`，绕过身份验证，创建一个具有管理员权限的新用户。
2.  **CVE-2023-20273 利用:** 使用步骤1中创建的管理员用户，利用另一个Web UI组件中的漏洞，提升权限到root，并写入恶意植入物。

提供的POC代码尝试通过向目标IP地址的`/webui/logoutconfirm.html`发送POST请求来验证漏洞是否存在。如果响应状态码为200，并且响应长度较短（小于32字节），则认为该IP地址易受攻击。然后，脚本会使用curl再次发送请求，如果返回特定的输出长度，则确认漏洞存在。

**关于投毒风险:**

虽然该脚本的主要目的是验证漏洞的存在，但仍然存在一定的投毒风险。风险点在于subprocess.run函数中，使用shell=True来执行curl命令。这使得代码容易受到命令注入攻击，如果攻击者能够控制IP地址或相关参数，则可能执行任意命令。 此外，脚本会将成功利用漏洞的IP地址记录到results.csv 文件中，这虽然不是恶意行为，但可能被恶意行为者利用。投毒风险评估为10%，主要是因为使用了subprocess.run(shell=True)执行外部命令。

**项目地址:** [reket99/Cisco_CVE-2023-20198](https://github.com/reket99/Cisco_CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #25

**来源**: [CVE-2023-20198-sanan2004_CVE-2023-20198.md](../2023/CVE-2023-20198-sanan2004_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响的系统

**影响版本:** 16.1.1 至 17.12.3 以及其他版本

**利用条件:** 目标系统启用了Web UI功能，且位于网络可达范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 存在于 Cisco IOS XE 软件的 Web UI 中。该漏洞允许未经身份验证的攻击者通过不正确的路径验证绕过 Nginx 过滤，访问 `webui_wsma_http` Web 端点，从而可以执行任意 Cisco IOS 命令或进行配置更改，获得 Privilege 15 权限。该漏洞利用涉及两个 XML SOAP 端点：`cisco:wsma-exec` 和 `cisco:wsma-config`。攻击者可以使用 `cisco:wsma-exec` 端点将命令插入到 `execCLI` 元素标记中，例如获取运行配置或执行任意命令。攻击者还可以使用 `cisco:wsma-config` 端点添加具有 Privilege 15 的新用户。随附的 PoC 脚本提供检查漏洞、获取配置、执行命令以及添加/删除用户的功能。PoC 代码的投毒风险较低 (10%)，主要风险在于不熟悉该漏洞的人员可能意外地在生产环境中执行恶意命令，或在测试时使用了存在后门的IOS版本。脚本本身旨在利用漏洞，并且不包含任何明显的恶意或隐藏功能，仓库的README.md声明了此POC的利用方式,降低了隐藏的恶意代码的风险。

**漏洞利用方式：**

1.  **利用 CVE-2023-20198 绕过身份验证：** 攻击者构造特制的 URL 访问易受攻击的 Web UI 端点。
2.  **提升权限：** 成功绕过身份验证后，攻击者可以利用 `cisco:wsma-exec` 或 `cisco:wsma-config` SOAP接口下发命令。
3.  **创建特权用户：** 攻击者创建一个具有 Privilege 15 权限的新用户，从而获得对系统的完全控制。
4.  **执行任意命令：** 攻击者可以使用提权的会话执行任意 Cisco IOS 命令，包括安装后门、修改配置或窃取敏感信息。

**项目地址:** [sanan2004/CVE-2023-20198](https://github.com/sanan2004/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #26

**来源**: [CVE-2023-20198-securityphoenix_cisco-CVE-2023-20198-tester.md](../2023/CVE-2023-20198-securityphoenix_cisco-CVE-2023-20198-tester.md)

## CVE-2023-20198-Cisco IOS XE Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的攻击者创建具有特权15的本地用户，从而完全控制设备

**影响版本:** 受影响的版本包括 16.1.1 到 17.12.1 以及其他版本

**利用条件:** Web UI 功能必须已启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞信息和搜索结果，CVE-2023-20198 允许未经身份验证的攻击者在受影响的 Cisco IOS XE 设备上创建具有 privilege level 15 （最高权限）的本地用户。漏洞利用涉及向 Web UI 发送特制的 HTTP POST 请求，绕过身份验证机制。创建具有最高权限的用户后，攻击者可以使用该账户执行任意命令，并完全控制设备。提供的 `cisco_tester.py` 脚本旨在检测目标设备是否受到 CVE-2023-20198 的影响。它通过向 `/webui/logoutconfirm.html?logon_hash=1` 发送 POST 请求，并检查响应中是否包含特定的字符串 `1a80b7389ccd0a5dab` 来判断设备是否已被入侵。该字符串很可能是一个被利用的设备的特征。

**有效性:**

根据漏洞库信息、搜索结果（特别是 https://www.horizon3.ai/attack-research/attack-blogs/cisco-ios-xe-cve-2023-20198-deep-dive-and-poc/）和漏洞利用代码，该漏洞的利用是有效的，已经有公开可用的PoC。

**投毒风险:**

提供的Python脚本本身主要是一个检测工具，用于检查Cisco设备是否受到CVE-2023-20198的影响，它通过检测特定Hash值判断系统是否已经被植入后门。该脚本逻辑比较简单，主要功能为发送HTTP请求并匹配特定字符串。风险点可能在于脚本对异常的处理不够严谨，如果目标存在其他漏洞，可能被利用，但从代码本身来看，投毒的可能性较低，例如作者没有隐藏恶意的代码执行、数据窃取等行为。可以认为投毒风险极低，可能性约为1%。

**利用方式:**

1.  **未经身份验证的权限提升:**  攻击者利用 CVE-2023-20198 在 Cisco IOS XE 设备上创建一个具有最高权限 (privilege level 15) 的本地用户。
2.  **初始访问:**  利用漏洞绕过 Web UI 的身份验证机制。
3.  **命令执行:**  使用新创建的特权用户账户登录并执行任意命令，实现对设备的完全控制。
4.  **植入后门:** 利用CVE-2023-20273，提升权限至root,写入后门文件。

总而言之，此漏洞允许攻击者完全控制受影响的Cisco设备，风险极高。

**项目地址:** [securityphoenix/cisco-CVE-2023-20198-tester](https://github.com/securityphoenix/cisco-CVE-2023-20198-tester)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #27

**来源**: [CVE-2023-20198-smokeintheshell_CVE-2023-20198.md](../2023/CVE-2023-20198-smokeintheshell_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权用户创建特权用户并执行任意命令

**影响版本:** 受影响版本包括16.1.1到17.12.1等多个版本

**利用条件:** 需要目标设备启用Web UI功能，且攻击者能够网络访问该Web UI。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。该漏洞源于对 Nginx 过滤器的不当路径验证，允许未经身份验证的攻击者绕过身份验证访问 `webui_wsma_http` Web 端点。

**利用方式：**

1.  攻击者利用漏洞绕过身份验证，向 `webui_wsma_http` 端点发送特制的 XML SOAP 请求。
2.  攻击者可以使用 `cisco:wsma-exec` SOAP 端点执行任意 Cisco IOS 命令，或者使用 `cisco:wsma-config` SOAP 端点创建具有 Privilege 15 权限的本地用户。
3.  创建具有 Privilege 15 权限的用户后，攻击者可以使用该用户登录并执行任何操作。
4.  结合CVE-2023-20273，攻击者可以进一步提升权限至root，并写入植入程序。

**有效性：**

根据漏洞描述和提供的漏洞利用代码，该漏洞利用是有效的。漏洞利用代码包含检查漏洞是否存在、获取 Cisco IOS 运行配置、执行任意 Cisco IOS 命令以及添加/删除特权用户的功能。搜索引擎结果也表明该漏洞已被 активно利用。

**投毒风险：**

分析提供的漏洞利用代码（exploit.py），发现以下潜在风险：

*   虽然代码本身看起来直接实现了漏洞利用，但仍然存在作者在代码中加入恶意行为的可能性。
*   例如，可以修改添加用户的函数，在创建高权限用户的同时，静默地执行其他恶意配置更改（如添加后门路由或修改系统日志设置）。
*   代码中使用了多个 SOAP 端点，虽然文档中只提到了 `cisco:wsma-exec` 和 `cisco:wsma-config`，但作者可能利用其他未公开的端点执行恶意操作。
*   因此，需要仔细审查代码的每一行，特别是与网络请求和配置更改相关的部分，以确保没有隐藏的恶意逻辑。
*  根据代码内容，未发现明显的恶意代码，但由于该漏洞可以创建高权限用户，如果攻击者利用该漏洞，完全可以植入后门，存在投毒风险。
*  代码本身风险较低，投毒风险主要体现在被攻击者利用后实施的恶意行为，故将风险调整为10%。

**项目地址:** [smokeintheshell/CVE-2023-20198](https://github.com/smokeintheshell/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #28

**来源**: [CVE-2023-20198-sohaibeb_CVE-2023-20198.md](../2023/CVE-2023-20198-sohaibeb_CVE-2023-20198.md)

# CVE-2023-20198

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-20198-Arshit01_CVE-2023-20198.md](../2023/CVE-2023-20198-Arshit01_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI权限提升漏洞

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响的Cisco设备

**影响版本:** 16.1.1 to 17.12.1及部分17.x版本

**利用条件:** Web UI功能已启用，且目标设备存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。未经身份验证的攻击者可以利用此漏洞创建具有特权级别15（最高权限）的本地用户，从而完全控制受影响的设备。利用过程分为两个阶段：首先利用CVE-2023-20198创建用户，其次利用CVE-2023-20273提升权限至root并写入植入程序。

**漏洞利用方式：**

1.  **身份验证绕过：** 漏洞允许未经身份验证的攻击者与设备的Web UI进行交互。
2.  **创建特权用户：** 攻击者发送特制的SOAP请求到Web UI，该请求绕过身份验证并允许攻击者创建一个具有特权级别15的新用户。
3.  **远程控制：** 创建具有最高权限的用户后，攻击者可以使用此帐户登录设备，并执行任意命令。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的POC代码，可以确认POC代码是有效的。搜索结果中的文章提到了漏洞的成功利用和概念验证代码的存在。POC代码也显示了通过发送特制的XML SOAP请求来创建新用户的机制。

**投毒风险：**

提供的POC代码存在轻微的投毒风险，约为10%。风险点分析如下：

*   **默认用户名和密码：** POC代码使用了默认的用户名（shellsmoke）和密码（pwned）。虽然这方便了漏洞测试，但如果未经修改直接用于攻击，很容易被检测到或被其他人利用。
*   **硬编码的URI：** POC中`exURI = '%2577eb%2575i_%2577sma_Http'`，如果攻击者修改此URI植入恶意代码，可能会导致拒绝服务或者其他恶意行为。
*   **命令执行：** 漏洞本身允许执行任意命令，攻击者可能通过植入恶意命令来感染设备。

需要注意的是，以上只是一些潜在的风险点，具体的投毒行为还需要进一步分析。POC的主要功能是验证漏洞的存在，而非恶意利用。因此，将其判定为具有投毒代码是不准确的。

**项目地址:** [Arshit01/CVE-2023-20198](https://github.com/Arshit01/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #2

**来源**: [CVE-2023-20198-Atea-Redteam_CVE-2023-20198.md](../2023/CVE-2023-20198-Atea-Redteam_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Software Web UI权限提升漏洞

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，未经身份验证的攻击者可以创建具有特权级别15访问权限的帐户，并最终导致完全控制受影响的系统。

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1以及17.11.99SW等众多版本

**利用条件:** Web UI 功能必须启用。需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个关键漏洞。未经身份验证的远程攻击者可以利用此漏洞在受影响的系统上创建具有特权级别 15（完全访问所有命令）的帐户。利用方式是攻击者发送特制的 HTTP 请求到 `/webui/logoutconfirm.html?logon_hash=1` 路径，绕过身份验证，并执行特权命令以创建本地用户和密码组合。创建用户后，攻击者可以利用另一个漏洞（CVE-2023-20273）提升权限至 root 并写入植入程序到文件系统。提供的 Python 脚本 `CVE-2023-20198.py` 旨在检测是否存在该漏洞，并检查已知的 IOC。  该脚本扫描指定子网，并检查目标设备是否返回预期的响应状态码和内容长度。投毒风险评估：脚本本身主要用于检测，但由于脚本包含发送特定请求到目标设备的逻辑，如果攻击者修改此脚本，可能会加入恶意负载或更改用户创建的用户名/密码，存在一定的投毒风险.脚本中存在User-Agent:Atea Red Team CVE-2023-20198 checkscript特征,可能被安全设备检测到。存在的风险点是如果未经授权的人员使用了修改后的脚本，可能会对网络造成损害。 README.md文件没有发现异常。

**项目地址:** [Atea-Redteam/CVE-2023-20198](https://github.com/Atea-Redteam/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #3

**来源**: [CVE-2023-20198-DOMINIC471_qub-network-security-cve-2023-20198.md](../2023/CVE-2023-20198-DOMINIC471_qub-network-security-cve-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权级别15的账户，完全控制受影响的设备。

**影响版本:** 受影响版本众多，包括16.1.1到17.12.1以及其他版本（详见漏洞库信息）。

**利用条件:** Web UI功能必须已启用。设备需要可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞允许未经身份验证的攻击者在Cisco IOS XE设备上创建具有特权级别15（最高权限）的本地用户。攻击者通过利用Web UI中的漏洞绕过身份验证，并执行特权命令创建用户。结合另一个漏洞CVE-2023-20273，攻击者可以进一步提升权限至root并写入植入程序到文件系统。 

**有效性评估：**
根据提供的漏洞库信息和搜索结果，CVE-2023-20198是一个严重漏洞，已被积极利用。

**投毒风险评估：**
查看提供的POC代码，包括README.md和IOC Summary.md文件。 README.md主要描述了如何分析、检测和缓解此漏洞。IOC Summary.md列出了攻击者IP，受害者IP，使用的header以及payload等。这些信息可以辅助蓝队进行防御。
总体来说，该仓库的目的是为了分析和缓解漏洞，并没有发现明显的投毒代码。但是，由于代码中可能包含攻击载荷或恶意命令示例，如果使用者不小心，可能会误用这些代码进行非授权的渗透测试，从而导致法律风险。因此，评估的投毒风险为10%。

**利用方式：**
1.  **未授权访问：** 攻击者利用漏洞，绕过Web UI的身份验证机制。
2.  **创建特权用户：** 攻击者通过发送特制的HTTP请求，执行CLI命令，创建一个具有特权级别15的本地用户。
3.  **持久化（结合CVE-2023-20273）：** 攻击者利用新创建的本地用户登录，并利用另一个漏洞（CVE-2023-20273）提升权限到root，并在文件系统中写入植入程序，实现持久化控制。

**缓解措施：**
*   禁用Web UI功能，如果不需要使用。
*   升级到已修复漏洞的IOS XE软件版本。
*   使用入侵检测/防御系统（IDS/IPS）检测和阻止利用此漏洞的攻击。
*   检查设备上是否存在异常用户和植入程序。

**项目地址:** [DOMINIC471/qub-network-security-cve-2023-20198](https://github.com/DOMINIC471/qub-network-security-cve-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #4

**来源**: [CVE-2023-20198-G4sul1n_Cisco-IOS-XE-CVE-2023-20198.md](../2023/CVE-2023-20198-G4sul1n_Cisco-IOS-XE-CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权15权限的本地用户，结合CVE-2023-20273可提升至root权限并植入后门。

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他相关版本，具体参见漏洞库信息。

**利用条件:** 需要目标系统启用Web UI功能，且网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。根据漏洞信息和搜索结果，该漏洞允许未经身份验证的远程攻击者在受影响的系统上创建一个具有特权级别 15 访问权限的帐户。Cisco的公告指出，攻击者首先利用此漏洞获得初始访问权限，然后执行特权 15 命令以创建本地用户和密码组合。随后，攻击者利用 CVE-2023-20273 将权限提升到 root 并将植入程序写入文件系统。根据提供的漏洞利用代码，该 PoC 包含以下功能：

*   **漏洞检查**：通过执行 `uname -a` 命令来验证漏洞是否存在。
*   **获取 Cisco 配置**：执行 `sh run` 命令来提取运行配置。
*   **执行命令**：允许执行任意 Cisco IOS 命令，但警告需要谨慎使用，因为没有输入验证。
*   **添加用户**：创建一个新的特权 15 用户帐户，可以选择指定用户名和密码。
*   **删除用户**：从设备中删除用户帐户。

**有效性：**

该 PoC 代码的有效性较高，因为漏洞库信息和搜索结果都表明该漏洞已被 активно используется。此外，该 PoC 提供了多种利用方式，包括漏洞检查、信息收集和权限提升。

**投毒风险：**

尽管 PoC 代码主要用于利用已知的漏洞，但仍存在一定的投毒风险，估计为10%。风险点包括：

*   **命令执行**：通过 `-e` 选项执行任意命令，攻击者可能利用此功能执行恶意操作。
*   **用户管理**：虽然提供了添加和删除用户的选项，但如果被滥用，可能导致拒绝服务或系统损坏。

虽然PoC代码本身看起来是为了复现漏洞，但不能完全排除代码作者在其中隐藏恶意功能的可能性，例如植入后门、收集敏感信息等。因此，在使用 PoC 代码时，需要进行仔细审查和安全评估。

**利用方式：**

1.  **未经身份验证的访问**：利用 CVE-2023-20198 绕过身份验证，访问 `webui_wsma_http` Web 端点。
2.  **创建特权用户**：使用 `cisco:wsma-config` SOAP 端点创建一个具有特权 15 的新用户帐户。
3.  **执行任意命令**：使用 `cisco:wsma-exec` SOAP 端点执行任意 Cisco IOS 命令。
4.  **权限提升 (结合 CVE-2023-20273)**：利用新创建的特权用户，结合 CVE-2023-20273 将权限提升到 root，并在系统上植入后门。

总而言之，CVE-2023-20198 是一个严重的安全漏洞，需要立即采取措施进行修复。在使用 PoC 代码时，需要谨慎评估风险，并确保在受控环境中进行测试。

**项目地址:** [G4sul1n/Cisco-IOS-XE-CVE-2023-20198](https://github.com/G4sul1n/Cisco-IOS-XE-CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #5

**来源**: [CVE-2023-20198-IceBreakerCode_CVE-2023-20198.md](../2023/CVE-2023-20198-IceBreakerCode_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权级别 15 的帐户，从而完全控制设备

**影响版本:** 16.1.1 to 17.12.1 and earlier versions

**利用条件:** Web UI 功能已启用并且设备易受攻击版本的影响。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个漏洞，允许未经身份验证的远程攻击者在受影响的系统上创建具有特权级别 15 访问权限的帐户。 

**漏洞利用方式：**

1.  攻击者发送一个特制的 HTTP POST 请求到 `/webui/logoutconfirm.html?logon_hash=1` 端点，绕过身份验证。
2.  成功利用此漏洞后，攻击者可以执行任意命令，包括创建具有特权级别 15 的本地用户。
3.  然后，攻击者使用另一个漏洞（CVE-2023-20273）并通过新创建的本地用户权限提升到 root 权限，并将植入程序写入文件系统。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判定该漏洞的POC代码是有效的。漏洞库信息明确指出存在正在进行的漏洞利用活动。搜索结果也提供了多个关于该漏洞的深度分析和POC示例的链接，例如horizon3.ai上的POC代码。
提供的python脚本模拟了发送特制HTTP请求的过程，旨在检测目标系统是否存在漏洞。脚本会检查HTTP响应状态码和响应体内容，以判断是否存在潜在的植入程序。

**投毒风险：**

评估POC代码的投毒风险，需要仔细分析代码是否存在恶意行为，例如：
1.  **植入后门：**  代码是否在目标系统上安装未经授权的后门。
2.  **数据窃取：**  代码是否窃取敏感信息并发送到外部服务器。
3.  **拒绝服务：**  代码是否导致目标系统崩溃或无法正常运行。
4.  **恶意传播：**  代码是否试图感染其他系统。

分析提供的python脚本，该脚本主要用于检测漏洞是否存在，并未发现明显的恶意行为。脚本的功能是发送特定的HTTP请求并检查响应，以确定目标系统是否受到CVE-2023-20198漏洞的影响。然而，使用任何未经授权的漏洞利用代码都存在风险，因为代码的作者可能隐藏了不易察觉的恶意功能。因此，在使用任何POC代码之前，务必进行彻底的安全审查。

考虑到以上因素，判定该POC代码存在10%的投毒风险，主要是由于作者可能隐藏了一些不易察觉的恶意代码，但主要功能是漏洞验证。

**缓解措施：**

*   禁用 Web UI 功能，特别是当设备面向互联网时。
*   将 Web UI 访问限制为受信任的网络。
*   升级到已修复漏洞的 Cisco IOS XE 软件版本。

**项目地址:** [IceBreakerCode/CVE-2023-20198](https://github.com/IceBreakerCode/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #6

**来源**: [CVE-2023-20198-JoyGhoshs_CVE-2023-20198.md](../2023/CVE-2023-20198-JoyGhoshs_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可导致完全控制受影响设备

**影响版本:** 受影响版本范围广泛，详见漏洞库信息

**利用条件:** Web UI功能已启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198 允许未经身份验证的攻击者在受影响的系统上创建具有权限级别15（完全访问权限）的帐户。该漏洞利用方式如下：

1.  **初始访问:** 攻击者利用CVE-2023-20198漏洞，通过Web UI创建具有高权限的本地用户。
2.  **权限提升:** 然后，攻击者可能利用CVE-2023-20273（另一个漏洞）或使用新创建的本地用户进一步将权限提升至root。
3.  **植入后门:** 攻击者利用获得的root权限，在文件系统中写入恶意植入。

提供的POC代码`poc.py`是一个**检测工具**，而非完整的漏洞利用代码。它通过发送一个特定的HTTP请求到`/webui/logoutconfirm.html?logon_hash=1`，并检查响应内容是否为十六进制字符串来判断目标是否可能受到了攻击并植入了后门。如果响应是十六进制字符串，则表明设备可能已遭入侵，并存在植入的后门（该后门会返回hex信息）。

该存储库中的`README.md`文件说明，此脚本并非完整的POC，仅用于检查是否存在hex响应。因此，它无法直接用于漏洞利用，而只能用于检测。

**投毒风险分析：**

查看`poc.py`文件内容，发现其功能主要是发送HTTP请求并判断响应内容。该代码的功能比较简单，未发现任何可能导致恶意行为（例如，上传恶意文件、执行任意命令等）的可疑代码。因此，可以认为该存储库不存在作者隐藏的投毒代码。



**项目地址:** [JoyGhoshs/CVE-2023-20198](https://github.com/JoyGhoshs/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #7

**来源**: [CVE-2023-20198-Pushkarup_CVE-2023-20198.md](../2023/CVE-2023-20198-Pushkarup_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的远程攻击者创建管理员账户并完全控制设备

**影响版本:** 受影响版本详见CVE描述

**利用条件:** 目标设备启用了Web UI功能，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞存在于 Cisco IOS XE 软件的 Web UI 中。未经身份验证的远程攻击者可以通过利用此漏洞在受影响的系统上创建具有特权级别 15 访问权限的帐户。创建账户后，攻击者可以使用该账户完全控制受损的机器。

**有效性：**
提供的 POC 代码根据描述能够创建本地用户，安装植入体，重启Web服务，并检查植入体的状态，因此具备有效性。

**投毒风险：**
此仓库中可能存在作者隐藏的投毒代码。尽管自述文件声明 PoC 仅用于教育目的，并且使用需要遵守道德规范，但攻击者可以修改 `config_content` 以包含恶意配置，例如更改防火墙规则或执行其他恶意操作。此外，虽然代码本身没有明显的恶意行为，但其目的是在目标系统上创建具有管理权限的用户，这本身就可以被认为是恶意的。因此，存在一定的投毒风险，但是相对较低，风险评估在10%。此风险评估基于以下因素：
    *   代码可能被用于未授权的系统访问。
    *   配置文件可被修改为包含恶意指令。

**利用方式：**
1.  攻击者利用 CVE-2023-20198 漏洞，通过未授权访问在 Cisco IOS XE 设备上创建一个具有特权级别 15 的本地用户。
2.  攻击者使用新创建的管理员账户登录到设备。
3.  攻击者利用 CVE-2023-20273 漏洞，进一步提升权限至 root 级别，并将恶意植入程序写入文件系统。
4.  攻击者通过植入的后门程序远程控制设备，执行恶意操作，例如数据窃取、网络攻击等。
根据搜索结果，CISA 已将此漏洞添加到已知被利用的漏洞目录中，表明该漏洞已经被广泛利用。

**项目地址:** [Pushkarup/CVE-2023-20198](https://github.com/Pushkarup/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #8

**来源**: [CVE-2023-20198-RevoltSecurities_CVE-2023-20198.md](../2023/CVE-2023-20198-RevoltSecurities_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，可被未授权的攻击者利用创建特权用户，进而完全控制系统。

**影响版本:** 受影响的版本包括16.1.1到17.12.1以及其他一系列17.x版本 (详见漏洞库信息)

**利用条件:** 目标设备启用Web UI功能，并且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。根据漏洞库信息和搜索引擎结果，未经身份验证的攻击者可以利用此漏洞在受影响的系统上创建一个具有 15 级权限（最高权限）的帐户。随后攻击者再利用CVE-2023-20273，将权限提升至root，并写入植入体。该漏洞的利用方式如下：

1.  **漏洞触发：** 攻击者发送特制的HTTP请求到Cisco IOS XE设备的Web UI接口，绕过身份验证。
2.  **创建特权用户：** 请求中包含特定的XML内容，该内容允许攻击者创建一个新的本地用户，并分配最高权限（privilege level 15）。
3.  **权限提升：** 攻击者利用创建的特权用户登录系统。
4.  **植入后门：** 攻击者通过Web UI的另一个组件（CVE-2023-20273）将权限提升至root并写入植入体。

**有效性：** 根据搜索引擎结果（特别是horizon3.ai的POC）以及提供的漏洞利用代码，此漏洞利用是有效的。漏洞利用代码仓库提供了一个Python脚本，可以检测和利用此漏洞。

**投毒风险：** 漏洞利用代码仓库的投毒风险评估为10%。虽然该仓库提供了看似合理的漏洞利用脚本，但存在以下潜在风险点：

*   **自定义配置内容：** 脚本允许用户提供自定义的配置内容（`-cfc` 或 `--config-content` 参数），这可能被滥用以注入恶意代码或配置。
*   **隐蔽后门：** 虽然主要功能是利用漏洞，但作者可能在代码中添加了不易察觉的后门，例如收集目标信息、执行任意命令等。代码量较少，通读代码可以降低风险。

**防范措施：**

*   立即更新Cisco IOS XE软件到已修复的版本。
*   禁用Web UI功能，如果不需要。
*   监控网络流量，检测异常的Web UI请求。
*   使用Cisco提供的软件检查工具来识别和移除潜在的植入体。

**项目地址:** [RevoltSecurities/CVE-2023-20198](https://github.com/RevoltSecurities/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #9

**来源**: [CVE-2023-20198-Shadow0ps_CVE-2023-20198-Scanner.md](../2023/CVE-2023-20198-Shadow0ps_CVE-2023-20198-Scanner.md)

## CVE-2023-20198 Cisco IOS XE Web UI 权限提升漏洞

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权 15 权限的本地用户，从而完全控制受影响的设备。

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1 以及 17.11.99SW

**利用条件:** Web UI 功能必须已启用。攻击者需要能够通过网络访问设备的 Web UI。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。未经身份验证的远程攻击者可以利用此漏洞在受影响的系统上创建一个具有特权 15 访问权限的帐户，本质上是管理员权限。漏洞利用通常与另一个漏洞 CVE-2023-20273 结合使用，后者用于将权限提升到 root 并将植入程序写入文件系统。

**漏洞利用有效性：**

根据漏洞库信息、搜索引擎结果（特别是 horizon3.ai 的 PoC 描述）以及提供的漏洞利用代码片段来看，该漏洞的利用是有效的。存在公开可用的 PoC，允许攻击者绕过身份验证创建具有管理权限的用户。

**投毒风险分析：**

提供的代码片段分析表明，攻击流程依赖于 Nginx 配置和一个 Lua 脚本。Lua 脚本的核心功能在于身份验证绕过和命令执行。脚本通过检查是否存在特定的 "Authorization" Header以及Header的内容是否和通过REDACTED命令执行结果匹配来确定请求是否被授权。

由于 "REDACTED" 信息的缺失，我们无法完全确定是否存在恶意投毒代码。但是lua脚本的下列行为存在潜在的投毒风险：

1.  **外部命令执行:** 脚本多次使用 `io.popen()` 执行外部命令。如果这些命令包含恶意参数或旨在下载和执行其他代码，则可能导致系统受损。
2.  **硬编码的凭据和逻辑：**脚本逻辑依赖于特定的哈希值和其他硬编码的字符串。攻击者可能会修改这些字符串以创建变体，从而绕过安全检测或植入后门。
3.  **对/lua5的请求:** 当common_type=iox时,会调用/lua5,如果/lua5是作者控制的地址,则存在投毒风险。

基于以上分析，虽然无法确定明确的投毒代码，但脚本中使用的技术（尤其是外部命令执行）增加了被用于恶意目的的可能性，估计投毒风险为20%。

**漏洞利用方式：**

1.  **未授权访问:** 攻击者发送一个特制的 HTTP POST 请求到 `/webui/logoutconfirm.html`，绕过身份验证检查（利用 CVE-2023-20198）。这可能涉及到提供特定的 `Authorization` header，该header的值能够通过预设的验证。
2.  **创建高权限用户:** 绕过身份验证后，攻击者可以发送包含创建新用户（具有特权级别 15）的命令的请求体。该命令通过 `io.popen()` 执行，从而创建一个具有管理员权限的本地用户。
3.  **权限提升和植入：** (结合 CVE-2023-20273) 使用新创建的本地用户登录并利用 CVE-2023-20273 将权限提升至 root，从而能够在设备上安装植入程序。


**项目地址:** [Shadow0ps/CVE-2023-20198-Scanner](https://github.com/Shadow0ps/CVE-2023-20198-Scanner)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #10

**来源**: [CVE-2023-20198-Tounsi007_CVE-2023-20198.md](../2023/CVE-2023-20198-Tounsi007_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可能导致完全控制受影响设备

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他版本

**利用条件:** 目标设备启用了Web UI功能并且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞存在于Cisco IOS XE Software的Web UI中，允许未经身份验证的远程攻击者创建一个具有特权级别15（完全访问权限）的本地用户帐户。该漏洞利用方式是通过发送特制的HTTP请求到`/webui/create_user`路径来创建用户。攻击者随后可利用创建的用户并通过另一个漏洞CVE-2023-20273提升权限至root并写入植入程序。提供的POC代码尝试模拟此过程，包括创建用户、安装植入程序、重启Web服务器、检查植入程序状态以及清理创建的用户。 

**有效性：**根据漏洞信息、搜索结果和提供的POC代码，该漏洞是有效的。搜索引擎结果表明该漏洞已被积极利用，并且存在公开可用的POC代码。CISA的已知被利用漏洞目录也收录了该漏洞。

**投毒风险：**POC代码本身存在一定的风险。虽然代码的主要功能是利用漏洞，但`config_content`变量表明存在植入恶意配置的可能性。 用户需要手动插入植入配置,存在被植入后门的风险。
该仓库readme描述，POC仅用于测试和学习，有免责声明。存在一定概率作者未充分测试。

**利用方式：**
1.  **初始访问：** 未经身份验证的攻击者发送特制HTTP请求到存在漏洞的Cisco IOS XE设备的Web UI接口。
2.  **用户创建：**  利用CVE-2023-20198，攻击者通过`/webui/create_user`接口创建一个具有管理员权限的新用户。
3.  **权限提升（CVE-2023-20273）：** 利用新创建的用户，攻击者可以进一步利用Web UI中的另一个漏洞（CVE-2023-20273）来提升权限至root。
4.  **植入后门：** 攻击者可以写入植入程序到文件系统。
5.  **持久化：** 植入程序可以用于维持对受感染设备的访问。
6.  **清理（可选）：** 攻击者可以选择删除他们创建的后门账户，以隐藏其踪迹。

**项目地址:** [Tounsi007/CVE-2023-20198](https://github.com/Tounsi007/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #11

**来源**: [CVE-2023-20198-Vulnmachines_Cisco_CVE-2023-20198.md](../2023/CVE-2023-20198-Vulnmachines_Cisco_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可使未授权的攻击者获得完全管理权限

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1 以及其他多个版本

**利用条件:** Web UI 功能启用并且 HTTP 或 HTTPS 服务器功能开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个关键身份验证绕过漏洞。根据漏洞信息和搜索结果，攻击者利用此漏洞首先获得初始访问权限，然后执行特权 15 命令来创建一个本地用户和密码组合，从而获得管理员权限。之后，攻击者利用 CVE-2023-20273 将权限提升到 root 并在文件系统中写入植入程序。提供的 POC 代码显示了一个用于利用漏洞的 HTTP POST 请求示例。请求的目标 URI 经过编码处理，绕过了身份验证。请求体包含一个 SOAP 信封，该信封尝试使用默认的 "admin" 用户名执行命令 "uname -a"。有效性：根据搜索结果和漏洞描述，提供的 POST 请求通过身份验证绕过在受影响的设备上创建具有特权 15 的用户，因此 POC 代码有效。 投毒风险：README.md 文件描述了漏洞，并提供了一个关于利用该漏洞的概述。Payload 文件包含一个 SOAP 请求，用于发送 CLI 命令。虽然该请求本身看起来无害（执行 `uname -a` 命令），但攻击者可能会修改该请求以执行恶意命令。例如，更改命令以创建具有特权 15 的用户。 因此，存在一定风险，即此仓库可能被用于传播恶意利用程序。Payload 代码文件本身没有明显的投毒代码，但存在被修改利用的风险，因此判定投毒风险为 10%。利用方式：1. 检查目标 Cisco IOS XE 设备是否启用了 Web UI 功能和 HTTP/HTTPS 服务器。2. 发送构造的 HTTP POST 请求到目标设备，利用身份验证绕过漏洞。3. 请求的目标 URI 经过编码处理以绕过身份验证检查。4. POST 请求的内容为 SOAP 信封，其中包含要执行的 CLI 命令。5. 成功利用后，攻击者可以在设备上执行任意 CLI 命令，例如创建新的管理员帐户或植入恶意软件。

**项目地址:** [Vulnmachines/Cisco_CVE-2023-20198](https://github.com/Vulnmachines/Cisco_CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #12

**来源**: [CVE-2023-20198-W01fh4cker_CVE-2023-20198-RCE.md](../2023/CVE-2023-20198-W01fh4cker_CVE-2023-20198-RCE.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权15的用户，进而完全控制受影响的设备。

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1 等多个版本

**利用条件:** Web UI 功能已启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。未经身份验证的远程攻击者可以利用此漏洞在受影响的系统上创建一个具有特权 15 访问权限的帐户，从而完全控制设备。利用方式如下：

1.  **漏洞触发点：** Cisco IOS XE 软件的 Web UI 组件存在漏洞。
2.  **利用过程：** 攻击者通过发送特制的 SOAP 请求到 `/%%77ebui_wsma_https` 或 `/%%77ebui_wsma_Http` URI (具体取决于是否使用 HTTPS) 绕过身份验证。
3.  **命令执行：** 攻击者使用 `urn:cisco:wsma-config` 命名空间执行 CLI 命令，创建新的具有特权 15 的用户。
4.  **后续利用 (CVE-2023-20273):** 在获得初始访问权限后，攻击者可以利用 CVE-2023-20273 将权限提升为 root 并在文件系统中写入植入程序。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞已被积极利用，提供的 PoC 代码有效，可以用于创建具有特权 15 的用户。

**投毒风险：**

PoC 代码主要功能是利用漏洞，创建新用户，从代码本身来看，存在一些潜在的投毒点，例如：

*   **随机用户名/密码生成：**  虽然代码中包含随机用户名生成函数，但实际使用中，攻击者可能会替换为预设的用户名和密码，方便后续控制。
*   **代理服务器使用：**  PoC 代码支持使用代理服务器，攻击者可以借此隐藏真实 IP 地址，增加溯源难度。
*   **异常处理：**  代码中包含异常处理模块，可能用于隐藏利用过程中的错误信息，避免被发现。
*   **User-Agent:** 使用了常见的User-Agent，但是依然存在替换或者增加其他User-Agent进行恶意攻击.

总体来说，PoC 代码的投毒风险较低，主要集中在以上几点，但需要使用者谨慎使用。

**总结：**

该漏洞利用的有效性很高，并且在野外被广泛利用。PoC 代码可以用来验证漏洞的存在并创建管理员用户，但需要注意潜在的投毒风险。利用方式是发送特制的 SOAP 请求，绕过身份验证，然后执行 CLI 命令。

**项目地址:** [W01fh4cker/CVE-2023-20198-RCE](https://github.com/W01fh4cker/CVE-2023-20198-RCE)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #13

**来源**: [CVE-2023-20198-XiaomingX_cve-2023-20198-poc.md](../2023/CVE-2023-20198-XiaomingX_cve-2023-20198-poc.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响设备

**影响版本:** 受影响版本范围广泛，详见漏洞库信息

**利用条件:** Web UI 功能启用且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 存在于 Cisco IOS XE 软件的 Web UI 中。未经身份验证的攻击者可以利用此漏洞创建具有 privilege level 15 权限的本地用户，从而获得对设备的完全控制权。利用方式主要通过发送特制的 SOAP 请求到目标设备的 Web UI 接口，绕过身份验证，执行 CLI 命令。PoC 代码通过构造恶意的 SOAP 消息，例如 `username <username> privilege 15 secret <password>`，添加高权限用户。 

有效性分析：根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开的 PoC。提供的 PoC 代码实现了漏洞利用的基本功能，包括检查漏洞、获取配置、执行命令和添加/删除用户。因此，提供的 PoC 代码是有效的。

投毒风险分析：代码本身主要实现了漏洞利用功能，但仍然存在一定的投毒风险。体现在以下几个方面：

*   **恶意命令执行：** 虽然代码本身没有硬编码的恶意命令，但 `-e` 参数允许攻击者执行任意 Cisco IOS 命令。攻击者可能会使用此参数注入恶意配置或植入后门。
*   **硬编码凭据：** 默认用户名 `shellsmoke` 和密码 `pwned` 如果不修改，可能被其他攻击者利用。虽然这是一个PoC，但在实际使用中容易被忽视，从而导致设备被二次入侵。
*   **异常处理：** 某些异常处理不够完善，可能导致程序崩溃或泄露敏感信息。
*   **Payload内容:** 在SOAP请求模板中，攻击者可能修改命令或者在ADD_USER的情况下，添加后门账户。

综合考虑，该 PoC 存在一定的投毒风险，但主要集中在用户使用不当或被恶意利用的可能性上，PoC本身是漏洞的利用，投毒代码的可能性评判为 10%。建议使用者在使用 PoC 时仔细审查代码，并采取必要的安全措施。

利用方式总结：

1.  **目标确认：** 确定目标 Cisco IOS XE 设备是否启用了 Web UI 功能。
2.  **发送恶意 SOAP 请求：** 构造包含 CLI 命令的恶意 SOAP 请求，绕过身份验证。
3.  **权限提升：** 利用漏洞创建具有 privilege level 15 权限的本地用户。
4.  **完全控制：** 使用新创建的用户登录并完全控制设备。

**项目地址:** [XiaomingX/cve-2023-20198-poc](https://github.com/XiaomingX/cve-2023-20198-poc)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #14

**来源**: [CVE-2023-20198-ZephrFish_CVE-2023-20198-Checker.md](../2023/CVE-2023-20198-ZephrFish_CVE-2023-20198-Checker.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权15权限的本地用户，随后可能被用于植入后门和完全控制设备

**影响版本:** 受影响版本：16.1.1 到 17.12.1，以及其他相关版本（详见漏洞库信息）

**利用条件:** 目标设备启用了Web UI功能，且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞允许未经身份验证的攻击者在受影响的 Cisco IOS XE 设备上创建一个具有特权 15 权限（最高权限）的本地用户。该漏洞存在于 Web UI 功能中。根据搜索引擎结果和漏洞库信息，此漏洞已被积极利用。提供的漏洞利用代码 `XEImplantScanner.py` 主要用于扫描目标系统是否存在漏洞以及是否被植入后门。该脚本通过发送特定的 HTTP 请求到 `/webui/logoutconfirm.html` 端点来检测漏洞和后门的存在。

**利用方式：**

1.  **初始访问：** 未经身份验证的攻击者发送特制的 HTTP 请求到目标设备的 Web UI。
2.  **权限提升：** 利用 CVE-2023-20198，创建一个具有特权 15 权限的本地用户。
3.  **后门植入（CVE-2023-20273）：** 使用新创建的具有特权的用户，攻击者可以进一步利用另一个漏洞（CVE-2023-20273）来提升权限至 root，并将植入体写入文件系统，实现持久化控制。

**有效性：**

根据搜索引擎结果（例如，horizon3.ai 的文章）和漏洞库信息，CVE-2023-20198 漏洞已被成功利用。提供的 POC 代码 `XEImplantScanner.py` 旨在检测漏洞的存在以及后门的植入，本身不包含直接利用漏洞进行权限提升的代码，需要结合 CVE-2023-20273 来完全控制。

**投毒风险：**

POC 代码 `XEImplantScanner.py` 主要功能是扫描，相对安全。可能的投毒风险在于：

*   **结果误导：** 扫描结果可能被篡改，导致用户误判系统的安全状态。
*   **依赖风险：** 脚本依赖于 `requests` 库，如果 `requests` 库被恶意版本替换，可能导致代码执行。
*   **网络钓鱼:** 脚本可能被用于钓鱼，诱导用户扫描恶意服务器，泄露信息。

因此，评估的投毒风险为 10%。主要是考虑到其扫描器性质，以及依赖库被投毒的可能性。

**项目地址:** [ZephrFish/CVE-2023-20198-Checker](https://github.com/ZephrFish/CVE-2023-20198-Checker)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #15

**来源**: [CVE-2023-20198-alekos3_CVE_2023_20198_Detector.md](../2023/CVE-2023-20198-alekos3_CVE_2023_20198_Detector.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响系统

**影响版本:** 见受影响版本列表

**利用条件:** Web UI 功能已启用,网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。攻击者可以利用此漏洞绕过身份验证，创建一个具有 15 级权限的本地用户，从而完全控制受影响的系统。该漏洞结合 CVE-2023-20273 使用，CVE-2023-20198 用于初始访问，CVE-2023-20273 用于提权至 root 并写入植入程序到文件系统。

**利用方式：**

1.  未经身份验证的攻击者发送特制的HTTP请求到启用了Web UI的Cisco IOS XE设备。
2.  利用CVE-2023-20198漏洞，创建一个具有特权级别15的本地用户。
3.  使用新创建的本地用户利用CVE-2023-20273漏洞，将权限提升到root。
4.  将植入程序写入文件系统，从而完全控制设备。

**POC代码分析：**

提供的Python脚本 (`CVE_2023_20198_detector.py`) 主要用于检测设备是否存在漏洞，而不是利用该漏洞。它通过SSH连接到设备，并运行一些命令来检查Web UI是否启用，并尝试检测是否存在攻击迹象，例如存在`ip http server`, `ip http secure-server`,  `ip http active`配置。脚本通过`netmiko`库实现SSH连接和命令执行。该脚本没有直接创建特权用户的恶意代码，只是用于检测是否存在漏洞。该脚本会生成一个csv文件`Results_CVE_2023_20198_{current_timestamp}.csv` 用于记录检测结果。

**有效性：**

根据搜索引擎结果，存在公开的POC代码，可以创建特权用户。`CVE_2023_20198_detector.py`脚本本身并不能直接利用漏洞，它只能用来检测目标是否存在漏洞。

**投毒风险：**

该脚本的投毒风险极低 (0%)。虽然用户需要输入用户名和密码，但是该脚本只是用来检测是否存在漏洞，没有发现任何可疑的代码或后门，也没有修改系统配置的任何行为。LICENSE文件为标准的MIT License。

**项目地址:** [alekos3/CVE_2023_20198_Detector](https://github.com/alekos3/CVE_2023_20198_Detector)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #16

**来源**: [CVE-2023-20198-emomeni_Simple-Ansible-for-CVE-2023-20198.md](../2023/CVE-2023-20198-emomeni_Simple-Ansible-for-CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可导致完全控制受影响的设备

**影响版本:** 16.1.1 to 17.12.1

**利用条件:** Web UI 功能已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。根据漏洞库信息和搜索引擎结果，未经身份验证的攻击者可以利用此漏洞创建一个具有 15 级权限（完全访问所有命令）的本地用户。攻击者首先利用 CVE-2023-20198 获得初始访问权限，然后执行权限 15 命令来创建本地用户和密码组合，允许该用户以普通用户身份登录。 然后攻击者利用 web UI 功能的另一个组件，利用新的本地用户将权限提升到 root 并将植入程序写入文件系统，cve-2023-20273。

**有效性：**
根据搜索引擎结果（例如Horizon3.ai的博客），已经存在公开可用的PoC，并且漏洞被积极利用。提供的Ansible剧本并不是直接的漏洞利用代码，而是用于检测并禁用HTTP/HTTPS服务器以缓解漏洞。它也能检测是否已经遭受攻击，通过分析syslog。

**投毒风险：**
提供的Ansible剧本的主要目的是缓解漏洞，而不是利用漏洞。虽然其中包含连接到Cisco设备的凭据（developer/lastorangerestoreball8876），但这些是 Cisco Always On Sandbox 的公开凭据，用于测试目的。 投毒风险较低，但仍然存在一些风险：

1.  **凭据滥用：**  即使凭据是公开的，也可能有人修改剧本以使用不同的凭据尝试访问其他Cisco设备。
2.  **远程执行：**  Ansible 剧本在目标设备上执行命令。如果剧本被恶意修改，可能会导致设备配置更改或执行其他恶意操作。 鉴于此，大约有10%的可能性存在投毒风险。

**利用方式：**
1.  **初始访问：**  攻击者利用 CVE-2023-20198 中的漏洞，绕过身份验证。
2.  **创建高权限用户：**  攻击者利用未授权访问，创建一个具有 15 级权限的本地用户。
3.  **权限提升(CVE-2023-20273):** 攻击者利用本地用户权限和Web UI的另一个漏洞，将权限提升到 root。
4.  **植入后门：**  攻击者利用 root 权限，在设备上植入后门，以便长期控制。

**项目地址:** [emomeni/Simple-Ansible-for-CVE-2023-20198](https://github.com/emomeni/Simple-Ansible-for-CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #17

**来源**: [CVE-2023-20198-fox-it_cisco-ios-xe-implant-detection.md](../2023/CVE-2023-20198-fox-it_cisco-ios-xe-implant-detection.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未经身份验证的攻击者创建具有特权15的本地用户，最终导致完全控制受影响的设备

**影响版本:** 受影响版本包括16.1.1至17.12.1 以及其他相关版本

**利用条件:** Web UI功能已启用，设备可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198是Cisco IOS XE Software Web UI中的一个权限提升漏洞。攻击者可以利用此漏洞，在未经身份验证的情况下，通过发送特制的HTTP请求绕过身份验证，并在受影响的系统上创建一个具有最高权限（特权级别15）的本地用户。创建具有特权15的用户后，攻击者可以使用该用户登录设备，执行任意命令，并完全控制受影响的Cisco IOS XE设备。攻击者利用CVE-2023-20198获得初始访问权限后，会进一步利用CVE-2023-20273将权限提升到root级别，并在文件系统中写入恶意植入程序。

**利用方式：**

1.  **未经身份验证的访问：** 攻击者通过发送特制的HTTP请求，绕过Cisco IOS XE Web UI的身份验证机制。
2.  **创建特权用户：** 成功绕过身份验证后，攻击者可以执行特权命令，创建一个具有最高权限（特权级别15）的本地用户。
3.  **权限提升：** 使用新创建的具有特权15的用户登录设备。
4.  **植入后门:** 利用CVE-2023-20273，将权限提升到root级别，并在文件系统中写入恶意植入程序。

**关于投毒风险：**

提供的漏洞利用代码仅仅是Apache License 2.0协议，这是一个开源协议，本身不包含任何恶意代码。根据现有信息，没有迹象表明该漏洞利用代码中存在任何隐藏的恶意或投毒代码。

**项目地址:** [fox-it/cisco-ios-xe-implant-detection](https://github.com/fox-it/cisco-ios-xe-implant-detection)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #18

**来源**: [CVE-2023-20198-iveresk_cve-2023-20198.md](../2023/CVE-2023-20198-iveresk_cve-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响的Cisco IOS XE设备

**影响版本:** 受影响版本众多，详见漏洞库信息

**利用条件:** Web UI功能已启用，且设备未打补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-20198是一个Cisco IOS XE Software Web UI中存在的权限提升漏洞。根据漏洞库信息和搜索引擎结果，未经身份验证的攻击者可以通过该漏洞创建具有特权15级别（完全访问权限）的本地用户帐户。攻击者首先利用此漏洞获得初始访问权限，然后结合CVE-2023-20273漏洞，利用新创建的本地用户帐户将权限提升至root级别，并在文件系统中写入植入程序。漏洞利用代码 `cve-2023-20198.py` 提供了 `check` 和 `exploit` 两种模式。`check` 模式用于检测目标是否存在漏洞，`exploit` 模式用于创建本地用户帐户。漏洞利用过程包括向 `/webui/logoutconfirm.html` 发送POST请求进行检测，以及向 `/webui/create_user` 发送POST请求创建用户。投毒风险较低，因为代码主要利用已知的漏洞利用方法，但仍存在被修改以执行恶意操作的可能性，例如在创建用户后立即执行其他命令或植入后门程序。主要风险集中在config_content中，可能会存在其他的攻击代码。

**项目地址:** [iveresk/cve-2023-20198](https://github.com/iveresk/cve-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #19

**来源**: [CVE-2023-20198-kacem-expereo_CVE-2023-20198.md](../2023/CVE-2023-20198-kacem-expereo_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可被未授权的攻击者利用创建具有特权 15 的本地用户，为进一步攻击（如植入后门）铺平道路。

**影响版本:** 16.1.1 to 17.12.1 and potentially other versions as indicated in the CVE description.

**利用条件:** 目标设备启用了 Web UI 功能，且位于攻击者可访问的网络中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。未经身份验证的远程攻击者可以通过向目标设备发送特制的 HTTP 请求来利用此漏洞。该漏洞允许攻击者在受影响的系统上创建一个具有特权级别 15 访问权限的帐户。此漏洞是攻击链的第一步，攻击者利用它来创建具有管理权限的本地用户，然后利用 CVE-2023-20273 进一步提升权限至 root，并在文件系统中写入植入程序。提供的 POC 代码 `main.py` 的作用是检测目标 IP 是否容易受到 CVE-2023-20198 的攻击。它通过发送特定的 GET 和 POST 请求来检查目标设备是否返回预期的响应。如果目标返回指示存在漏洞的响应，脚本将输出 'Vulnerable'，否则输出 'Not Vulnerable'。代码通过发送构造的 HTTP GET 请求来尝试绕过身份验证，并检查是否出现预期的“404 Not Found”响应。同时,代码还发送带有硬编码 Authorization 头的 POST 请求，以进一步确认漏洞的存在。尽管代码本身用于检测漏洞，但潜在的投毒风险在于硬编码的 Authorization 头部，以及对 HTTPS 请求的证书验证的禁用（`verify=False`），这可能被恶意修改以进行中间人攻击或者将流量重定向到恶意服务器，虽然这种可能性不大，只有10%。

**利用方式：**

1.  **未经身份验证的访问：** 攻击者无需任何凭据即可发起攻击。
2.  **特制的 HTTP 请求：**  攻击者构造特定的 HTTP GET/POST 请求，利用漏洞绕过身份验证。
3.  **创建特权用户：** 成功利用漏洞后，攻击者可以创建一个拥有最高权限（特权级别 15）的本地用户。
4.  **后续利用：**  创建的特权用户可被用于进一步的恶意活动，例如植入后门、收集敏感信息等（与 CVE-2023-20273 结合）。

**有效性：**
根据漏洞描述和搜索结果，提供的 POC 代码 `main.py` 旨在检测目标是否存在 CVE-2023-20198 漏洞，而不是直接利用该漏洞创建用户。 它通过发送特定的HTTP请求来验证是否存在漏洞。因此，该POC代码在检测方面是有效的。



**项目地址:** [kacem-expereo/CVE-2023-20198](https://github.com/kacem-expereo/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #20

**来源**: [CVE-2023-20198-mr-r3b00t_CVE-2023-20198-IOS-XE-Scanner.md](../2023/CVE-2023-20198-mr-r3b00t_CVE-2023-20198-IOS-XE-Scanner.md)

## CVE-2023-20198-Cisco IOS XE Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的攻击者创建具有特权15权限的本地用户，进而控制设备。

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他一些版本，具体参考漏洞库信息。

**利用条件:** 目标设备启用了Web UI功能，并且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198 漏洞允许未经身份验证的远程攻击者在受影响的 Cisco IOS XE 设备上创建具有特权级别 15 访问权限的帐户。此漏洞是由于 Web UI 功能中存在未受保护的备用通道漏洞 (CWE-420) 造成的。攻击者可以利用此漏洞获得初始访问权限，然后通过 CVE-2023-20273 进一步提升权限至 root 并植入后门。提供的PoC代码 `implant_scanner.ps1` 实际上是一个检测脚本，用于判断目标系统是否已经被植入后门，通过对比Web页面内容的MD5哈希值来判断。脚本本身没有发现明显的投毒代码，config.json中指定了目标URL和已知的哈希值，用于检测是否存在已知的植入体。因此，该仓库中存在作者隐藏的投毒代码的可能性为0%。利用方式是，首先利用CVE-2023-20198创建一个高权限用户，然后利用CVE-2023-20273提升权限并写入植入体（后门）。

**项目地址:** [mr-r3b00t/CVE-2023-20198-IOS-XE-Scanner](https://github.com/mr-r3b00t/CVE-2023-20198-IOS-XE-Scanner)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #21

**来源**: [CVE-2023-20198-netbell_CVE-2023-20198-Fix.md](../2023/CVE-2023-20198-netbell_CVE-2023-20198-Fix.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权远程攻击者创建特权15用户并控制设备

**影响版本:** 受影响版本众多，详见漏洞库信息

**利用条件:** Web UI功能已启用，设备可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性非常高，因为它已被CISA列入已知被利用漏洞目录，并且Cisco官方也已确认存在活跃的利用。漏洞利用方式如下：

1.  **利用CVE-2023-20198获取初始访问权限:** 未经身份验证的攻击者可以利用此漏洞，通过Web UI创建一个具有特权15（最高权限）的本地用户。
2.  **利用CVE-2023-20273提升权限至Root:** 攻击者创建本地用户后，可以利用CVE-2023-20273进一步提升权限至root，并将恶意程序写入文件系统，实现完全控制。

提供的漏洞利用代码（Ansible playbook）实际上是一个缓解措施，旨在禁用Web UI以阻止利用。虽然主要目的是缓解漏洞，但该仓库中存在一定投毒风险。例如:

*   **inventory.yml中的凭据:**  该文件包含默认用户名和密码（admin/admin_password），这可能会被粗心的用户直接用于生产环境，从而使系统暴露于风险之中。
*   **依赖的安全性:**  Ansible playbook的安全性取决于控制机本身的安全。如果控制机被攻破，攻击者可以修改playbook或inventory，从而造成更大范围的损害。

因此，虽然Playbook本身主要是用于缓解漏洞，但配置不当可能导致其他安全问题，存在潜在的投毒风险。务必负责任地存储凭据，使用Ansible Vault或其他安全方法来保护敏感信息。

**项目地址:** [netbell/CVE-2023-20198-Fix](https://github.com/netbell/CVE-2023-20198-Fix)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #22

**来源**: [CVE-2023-20198-ohlawd_CVE-2023-20198.md](../2023/CVE-2023-20198-ohlawd_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，可导致完全控制受影响系统

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他特定版本

**利用条件:** 需要目标设备启用Web UI功能

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。攻击者可以利用此漏洞，在未经身份验证的情况下，通过发送特制请求创建一个具备特权级别15的本地用户，从而获得对设备的完全控制权。由于提供的POC代码仅打印"how bout u exploit d33z nuts"，并没有实际利用漏洞的代码，所以判断其为无效的POC，且具有100%的投毒风险。漏洞利用方式包括：首先利用CVE-2023-20198漏洞获得初始访问权限，然后执行特权15命令以创建本地用户和密码组合。之后，攻击者可能利用CVE-2023-20273漏洞，利用新创建的本地用户将权限提升为root，并将植入程序写入文件系统。

**项目地址:** [ohlawd/CVE-2023-20198](https://github.com/ohlawd/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #23

**来源**: [CVE-2023-20198-raystr-atearedteam_CVE-2023-20198-checker.md](../2023/CVE-2023-20198-raystr-atearedteam_CVE-2023-20198-checker.md)

## CVE-2023-20198-Cisco IOS XE Software Web UI Privilege Escalation

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可能导致完全控制受影响的设备

**影响版本:** 16.1.1 to 17.12.1a 等多个版本 (参考漏洞库信息)

**利用条件:** Web UI功能必须启用，且设备可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-20198 允许未经身份验证的攻击者在受影响的系统上创建一个具有特权级别 15 访问权限的帐户。根据搜索引擎的结果，该漏洞已被积极利用。利用方式是，攻击者首先利用此漏洞获得初始访问权限，然后发出特权 15 命令来创建本地用户和密码组合。然后，攻击者利用另一个漏洞 (CVE-2023-20273) ，利用新创建的本地用户将权限提升为 root 并在文件系统中写入植入程序。 

提供的POC代码尝试通过向 `/webui/logoutconfirm.html` 发送带有 `logon_hash=1` 的POST请求来探测漏洞。如果响应状态码为200，并且响应内容的长度小于32个字符，则可能存在漏洞。POC代码扫描指定的子网，并尝试利用漏洞。 

关于投毒风险，POC代码本身相对简单，主要是网络扫描和HTTP请求。虽然不能完全排除恶意修改的可能性，但代码结构清晰，功能直接，隐藏恶意代码的概率较低。 投毒风险评估较低，大约5%。主要的风险点在于：
1.  **依赖未验证的requests库**：如果requests库本身被投毒，则会影响此脚本。
2.  **成功标志的判断**: 响应内容长度小于32可能是判断依据不足，如果恶意修改，可能导致误报或者漏报，将正常设备标记为存在漏洞，引导使用者进行进一步的恶意操作。

**项目地址:** [raystr-atearedteam/CVE-2023-20198-checker](https://github.com/raystr-atearedteam/CVE-2023-20198-checker)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #24

**来源**: [CVE-2023-20198-reket99_Cisco_CVE-2023-20198.md](../2023/CVE-2023-20198-reket99_Cisco_CVE-2023-20198.md)

## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，可导致完全控制受影响的Cisco IOS XE设备

**影响版本:** 16.1.1 to 17.12.1 (部分版本)

**利用条件:** Web UI功能已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。攻击者可以利用此漏洞，在未经身份验证的情况下，创建一个具有特权级别15（完全访问所有命令）的本地用户。接下来，攻击者可以利用CVE-2023-20273，通过新创建的本地用户提升权限至root并在文件系统中写入植入物。漏洞利用流程如下：

1.  **CVE-2023-20198 利用:**  未经验证的攻击者通过发送特制的POST请求到`/webui/logoutconfirm.html`，绕过身份验证，创建一个具有管理员权限的新用户。
2.  **CVE-2023-20273 利用:** 使用步骤1中创建的管理员用户，利用另一个Web UI组件中的漏洞，提升权限到root，并写入恶意植入物。

提供的POC代码尝试通过向目标IP地址的`/webui/logoutconfirm.html`发送POST请求来验证漏洞是否存在。如果响应状态码为200，并且响应长度较短（小于32字节），则认为该IP地址易受攻击。然后，脚本会使用curl再次发送请求，如果返回特定的输出长度，则确认漏洞存在。

**关于投毒风险:**

虽然该脚本的主要目的是验证漏洞的存在，但仍然存在一定的投毒风险。风险点在于subprocess.run函数中，使用shell=True来执行curl命令。这使得代码容易受到命令注入攻击，如果攻击者能够控制IP地址或相关参数，则可能执行任意命令。 此外，脚本会将成功利用漏洞的IP地址记录到results.csv 文件中，这虽然不是恶意行为，但可能被恶意行为者利用。投毒风险评估为10%，主要是因为使用了subprocess.run(shell=True)执行外部命令。

**项目地址:** [reket99/Cisco_CVE-2023-20198](https://github.com/reket99/Cisco_CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #25

**来源**: [CVE-2023-20198-sanan2004_CVE-2023-20198.md](../2023/CVE-2023-20198-sanan2004_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响的系统

**影响版本:** 16.1.1 至 17.12.3 以及其他版本

**利用条件:** 目标系统启用了Web UI功能，且位于网络可达范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 存在于 Cisco IOS XE 软件的 Web UI 中。该漏洞允许未经身份验证的攻击者通过不正确的路径验证绕过 Nginx 过滤，访问 `webui_wsma_http` Web 端点，从而可以执行任意 Cisco IOS 命令或进行配置更改，获得 Privilege 15 权限。该漏洞利用涉及两个 XML SOAP 端点：`cisco:wsma-exec` 和 `cisco:wsma-config`。攻击者可以使用 `cisco:wsma-exec` 端点将命令插入到 `execCLI` 元素标记中，例如获取运行配置或执行任意命令。攻击者还可以使用 `cisco:wsma-config` 端点添加具有 Privilege 15 的新用户。随附的 PoC 脚本提供检查漏洞、获取配置、执行命令以及添加/删除用户的功能。PoC 代码的投毒风险较低 (10%)，主要风险在于不熟悉该漏洞的人员可能意外地在生产环境中执行恶意命令，或在测试时使用了存在后门的IOS版本。脚本本身旨在利用漏洞，并且不包含任何明显的恶意或隐藏功能，仓库的README.md声明了此POC的利用方式,降低了隐藏的恶意代码的风险。

**漏洞利用方式：**

1.  **利用 CVE-2023-20198 绕过身份验证：** 攻击者构造特制的 URL 访问易受攻击的 Web UI 端点。
2.  **提升权限：** 成功绕过身份验证后，攻击者可以利用 `cisco:wsma-exec` 或 `cisco:wsma-config` SOAP接口下发命令。
3.  **创建特权用户：** 攻击者创建一个具有 Privilege 15 权限的新用户，从而获得对系统的完全控制。
4.  **执行任意命令：** 攻击者可以使用提权的会话执行任意 Cisco IOS 命令，包括安装后门、修改配置或窃取敏感信息。

**项目地址:** [sanan2004/CVE-2023-20198](https://github.com/sanan2004/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #26

**来源**: [CVE-2023-20198-securityphoenix_cisco-CVE-2023-20198-tester.md](../2023/CVE-2023-20198-securityphoenix_cisco-CVE-2023-20198-tester.md)

## CVE-2023-20198-Cisco IOS XE Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的攻击者创建具有特权15的本地用户，从而完全控制设备

**影响版本:** 受影响的版本包括 16.1.1 到 17.12.1 以及其他版本

**利用条件:** Web UI 功能必须已启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞信息和搜索结果，CVE-2023-20198 允许未经身份验证的攻击者在受影响的 Cisco IOS XE 设备上创建具有 privilege level 15 （最高权限）的本地用户。漏洞利用涉及向 Web UI 发送特制的 HTTP POST 请求，绕过身份验证机制。创建具有最高权限的用户后，攻击者可以使用该账户执行任意命令，并完全控制设备。提供的 `cisco_tester.py` 脚本旨在检测目标设备是否受到 CVE-2023-20198 的影响。它通过向 `/webui/logoutconfirm.html?logon_hash=1` 发送 POST 请求，并检查响应中是否包含特定的字符串 `1a80b7389ccd0a5dab` 来判断设备是否已被入侵。该字符串很可能是一个被利用的设备的特征。

**有效性:**

根据漏洞库信息、搜索结果（特别是 https://www.horizon3.ai/attack-research/attack-blogs/cisco-ios-xe-cve-2023-20198-deep-dive-and-poc/）和漏洞利用代码，该漏洞的利用是有效的，已经有公开可用的PoC。

**投毒风险:**

提供的Python脚本本身主要是一个检测工具，用于检查Cisco设备是否受到CVE-2023-20198的影响，它通过检测特定Hash值判断系统是否已经被植入后门。该脚本逻辑比较简单，主要功能为发送HTTP请求并匹配特定字符串。风险点可能在于脚本对异常的处理不够严谨，如果目标存在其他漏洞，可能被利用，但从代码本身来看，投毒的可能性较低，例如作者没有隐藏恶意的代码执行、数据窃取等行为。可以认为投毒风险极低，可能性约为1%。

**利用方式:**

1.  **未经身份验证的权限提升:**  攻击者利用 CVE-2023-20198 在 Cisco IOS XE 设备上创建一个具有最高权限 (privilege level 15) 的本地用户。
2.  **初始访问:**  利用漏洞绕过 Web UI 的身份验证机制。
3.  **命令执行:**  使用新创建的特权用户账户登录并执行任意命令，实现对设备的完全控制。
4.  **植入后门:** 利用CVE-2023-20273，提升权限至root,写入后门文件。

总而言之，此漏洞允许攻击者完全控制受影响的Cisco设备，风险极高。

**项目地址:** [securityphoenix/cisco-CVE-2023-20198-tester](https://github.com/securityphoenix/cisco-CVE-2023-20198-tester)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #27

**来源**: [CVE-2023-20198-smokeintheshell_CVE-2023-20198.md](../2023/CVE-2023-20198-smokeintheshell_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权用户创建特权用户并执行任意命令

**影响版本:** 受影响版本包括16.1.1到17.12.1等多个版本

**利用条件:** 需要目标设备启用Web UI功能，且攻击者能够网络访问该Web UI。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。该漏洞源于对 Nginx 过滤器的不当路径验证，允许未经身份验证的攻击者绕过身份验证访问 `webui_wsma_http` Web 端点。

**利用方式：**

1.  攻击者利用漏洞绕过身份验证，向 `webui_wsma_http` 端点发送特制的 XML SOAP 请求。
2.  攻击者可以使用 `cisco:wsma-exec` SOAP 端点执行任意 Cisco IOS 命令，或者使用 `cisco:wsma-config` SOAP 端点创建具有 Privilege 15 权限的本地用户。
3.  创建具有 Privilege 15 权限的用户后，攻击者可以使用该用户登录并执行任何操作。
4.  结合CVE-2023-20273，攻击者可以进一步提升权限至root，并写入植入程序。

**有效性：**

根据漏洞描述和提供的漏洞利用代码，该漏洞利用是有效的。漏洞利用代码包含检查漏洞是否存在、获取 Cisco IOS 运行配置、执行任意 Cisco IOS 命令以及添加/删除特权用户的功能。搜索引擎结果也表明该漏洞已被 активно利用。

**投毒风险：**

分析提供的漏洞利用代码（exploit.py），发现以下潜在风险：

*   虽然代码本身看起来直接实现了漏洞利用，但仍然存在作者在代码中加入恶意行为的可能性。
*   例如，可以修改添加用户的函数，在创建高权限用户的同时，静默地执行其他恶意配置更改（如添加后门路由或修改系统日志设置）。
*   代码中使用了多个 SOAP 端点，虽然文档中只提到了 `cisco:wsma-exec` 和 `cisco:wsma-config`，但作者可能利用其他未公开的端点执行恶意操作。
*   因此，需要仔细审查代码的每一行，特别是与网络请求和配置更改相关的部分，以确保没有隐藏的恶意逻辑。
*  根据代码内容，未发现明显的恶意代码，但由于该漏洞可以创建高权限用户，如果攻击者利用该漏洞，完全可以植入后门，存在投毒风险。
*  代码本身风险较低，投毒风险主要体现在被攻击者利用后实施的恶意行为，故将风险调整为10%。

**项目地址:** [smokeintheshell/CVE-2023-20198](https://github.com/smokeintheshell/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---

## POC #28

**来源**: [CVE-2023-20198-sohaibeb_CVE-2023-20198.md](../2023/CVE-2023-20198-sohaibeb_CVE-2023-20198.md)

## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，可被未授权的攻击者利用创建高权限用户并控制设备

**影响版本:** 16.1.1 to 17.12.1 and earlier

**利用条件:** Web UI 功能已启用且可远程访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞存在于 Cisco IOS XE 软件的 Web UI 中。未经身份验证的攻击者可以利用此漏洞在受影响的系统上创建一个具有特权级别 15 访问权限的帐户，即完全控制设备的权限。

**有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞已被积极利用，POC 代码的存在进一步证实了其有效性。

**利用方式：**
1.  攻击者首先利用 CVE-2023-20198 漏洞，通过发送特制的 HTTP POST 请求到 `/create_user` 接口，在目标设备上创建一个具有最高权限（privilege 15）的本地用户帐户。POC 代码中使用了 `requests` 库来发送这些请求。
2.  利用创建的本地用户账户，结合另一个漏洞 CVE-2023-20273（POC中实际上并没有利用这个漏洞, 只是进行了名称上的混淆，代码中根本不存在和该漏洞相关的任何利用代码）将权限提升到 root，并将恶意 implant 写入文件系统。
3.  植入的 implant 可以执行各种恶意操作，如数据窃取、后门访问等。
4.  通过发送 POST 请求到 `/restart_server` 接口重启Web服务使植入生效
5.  通过Get请求 `/implant_status` 来确定植入是否存在
6.  最后，可选地，可以通过 DELETE 请求到 `/delete_user/{username}` 接口删除之前创建的用于提权的用户帐户，以清除痕迹。

**投毒风险分析：**
POC 代码中存在一定的投毒风险，可能性大约为 10%。

*   **植入配置内容：**  `config_content = "<insert implant configuration content here>"`  这部分代码要求用户插入植入的配置内容。如果用户不小心插入了恶意配置，则可能导致目标系统受到感染。
*  **免责声明:** 该漏洞利用代码需要用户自行输入配置，如果用户使用不当，例如植入恶意后门，那么责任需要自行承担。该行为不是来自作者主动投毒，而是用户在不知情的情况下引入的风险。 

**注意：** POC 代码中的 `CVE-2021-1435` 是一个名称混淆，实际利用的是 CVE-2023-20273 或者其它方式来进行提权，但实际代码并没有实现对应功能。实际利用过程中需要结合其他漏洞或者已知信息来实现提权。

**项目地址:** [sohaibeb/CVE-2023-20198](https://github.com/sohaibeb/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)

---



---



---



---



---



---



---



---



---

