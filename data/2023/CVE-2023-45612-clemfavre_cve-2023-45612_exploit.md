# CVE-2023-45612

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45612-aecelen_ktor-xxe-poc.md](../2023/CVE-2023-45612-aecelen_ktor-xxe-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用程序启用ContentNegotiation并使用XML格式，目标服务器可以访问外部资源

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45612是JetBrains Ktor 2.3.5之前的版本中存在的一个XXE（XML外部实体注入）漏洞。当Ktor应用程序使用ContentNegotiation feature处理XML格式数据时，如果默认配置未进行安全加固，攻击者可以通过在XML payload中插入恶意实体引用来读取服务器上的任意文件或进行服务器端请求伪造（SSRF）。

**有效性：**

根据提供的漏洞库信息和漏洞利用代码，该漏洞的POC代码是有效的。漏洞库明确指出Ktor 2.3.5之前的版本存在XXE漏洞，并给出了受影响的版本范围。POC代码提供了重现该漏洞所需的必要组件，包括一个基于Ktor的简单服务器和一个用于发送恶意XML payload的Python脚本。

**投毒风险：**

查看POC代码，包括`README.md`, `build.gradle.kts`, `gradle.properties`, `gradlew`和`test.py`，没有发现任何恶意代码或后门。所有代码都用于设置Ktor服务器并利用XXE漏洞。虽然不能完全排除所有可能性，但根据目前的信息，投毒风险较低，可以认为是0%。`gradlew`只是一个gradle的wrapper脚本，用于在没有全局安装gradle的情况下运行gradle命令。

**利用方式：**

1.  **配置易受攻击的Ktor应用:** 确保目标Ktor应用的版本低于2.3.5，并启用了ContentNegotiation feature，且支持XML格式的处理。
2.  **构造恶意XML Payload:** 攻击者需要构造一个包含外部实体声明的XML payload。例如，payload可能包含一个指向服务器本地文件的实体引用，或者一个指向外部服务器的URL。
3.  **发送Payload到服务器:** 攻击者将构造好的XML payload通过HTTP请求发送到Ktor服务器的某个接受XML数据的端点。
4.  **利用XXE读取文件/SSRF:**  服务器解析XML时，会尝试解析外部实体。如果外部实体指向本地文件，则服务器会将文件内容返回给攻击者（文件读取）。如果外部实体指向外部URL，则服务器会向该URL发起请求（SSRF）。

**漏洞缓解措施：**

*   升级Ktor版本到2.3.5或更高版本。
*   禁用或严格配置XML解析器的外部实体解析功能。在Ktor中，可以通过配置`XML`序列化器来禁用外部实体解析。

**项目地址:** [aecelen/ktor-xxe-poc](https://github.com/aecelen/ktor-xxe-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #2

**来源**: [CVE-2023-45612-bbugdigger_ktor-xxe-poc.md](../2023/CVE-2023-45612-bbugdigger_ktor-xxe-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 目标应用启用了XML ContentNegotiation且使用默认配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612是JetBrains Ktor框架在2.3.5版本之前的XML处理中存在的一个XXE漏洞。默认情况下，ContentNegotiation在使用XML格式时存在安全隐患，允许攻击者通过构造恶意的XML请求来读取服务器上的任意文件或执行其他恶意操作。

**有效性分析：**
根据提供的POC代码，该漏洞的利用步骤如下：
1.  克隆包含漏洞利用代码的`ktor-xxe-poc`仓库。
2.  使用Gradle构建并运行Ktor应用程序（该应用程序模拟了存在漏洞的服务）。
3.  在另一个终端中使用Python脚本`xxe_poc.py`发送包含恶意XML Payload的请求。

通过执行这些步骤，可以验证目标服务是否存在XXE漏洞。

**投毒风险分析：**
代码仓库中可能存在投毒风险，例如在`build.gradle.kts`中引入恶意的依赖，或者在`xxe_poc.py`脚本中执行恶意操作。以下是评估结果：
*   **build.gradle.kts:** 检查依赖项，libs.xmlutil.core、libs.xmlutil.serialization可能存在被替换成恶意依赖的风险，例如，指向一个包含恶意代码的Maven仓库。虽然检查这些依赖库的安全性可以降低风险，但并不能完全排除。
*   **xxe_poc.py:** 此脚本是POC验证脚本，用于发送恶意XML，主要用于读取文件，进行SSRF等操作，但可能存在后门，例如执行系统命令，连接恶意服务器等。需要仔细审查该脚本。
*   **gradlew:** 主要用于构建， 脚本本身没有明显的投毒特征。

由于不清楚`xxe_poc.py`的具体内容，以及无法对远程maven仓库中的依赖项进行安全评估，因此给出10%的投毒风险。

**利用方式：**
攻击者可以发送一个包含恶意XML Payload的请求，该Payload包含一个指向外部实体的声明。当Ktor应用解析该XML时，会尝试加载外部实体，从而导致：
*   **任意文件读取：** 攻击者可以读取服务器上的任意文件，例如配置文件、密钥等。
*   **服务端请求伪造（SSRF）：** 攻击者可以利用服务器作为跳板，向内部网络或外部网络发起请求。
*   **拒绝服务攻击（DoS）：** 通过引用一个无限循环的外部实体，导致服务器资源耗尽。

**项目地址:** [bbugdigger/ktor-xxe-poc](https://github.com/bbugdigger/ktor-xxe-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #3

**来源**: [CVE-2023-45612-clemfavre_cve-2023-45612_exploit.md](../2023/CVE-2023-45612-clemfavre_cve-2023-45612_exploit.md)

# CVE-2023-45612

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45612-aecelen_ktor-xxe-poc.md](../2023/CVE-2023-45612-aecelen_ktor-xxe-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用程序启用ContentNegotiation并使用XML格式，目标服务器可以访问外部资源

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45612是JetBrains Ktor 2.3.5之前的版本中存在的一个XXE（XML外部实体注入）漏洞。当Ktor应用程序使用ContentNegotiation feature处理XML格式数据时，如果默认配置未进行安全加固，攻击者可以通过在XML payload中插入恶意实体引用来读取服务器上的任意文件或进行服务器端请求伪造（SSRF）。

**有效性：**

根据提供的漏洞库信息和漏洞利用代码，该漏洞的POC代码是有效的。漏洞库明确指出Ktor 2.3.5之前的版本存在XXE漏洞，并给出了受影响的版本范围。POC代码提供了重现该漏洞所需的必要组件，包括一个基于Ktor的简单服务器和一个用于发送恶意XML payload的Python脚本。

**投毒风险：**

查看POC代码，包括`README.md`, `build.gradle.kts`, `gradle.properties`, `gradlew`和`test.py`，没有发现任何恶意代码或后门。所有代码都用于设置Ktor服务器并利用XXE漏洞。虽然不能完全排除所有可能性，但根据目前的信息，投毒风险较低，可以认为是0%。`gradlew`只是一个gradle的wrapper脚本，用于在没有全局安装gradle的情况下运行gradle命令。

**利用方式：**

1.  **配置易受攻击的Ktor应用:** 确保目标Ktor应用的版本低于2.3.5，并启用了ContentNegotiation feature，且支持XML格式的处理。
2.  **构造恶意XML Payload:** 攻击者需要构造一个包含外部实体声明的XML payload。例如，payload可能包含一个指向服务器本地文件的实体引用，或者一个指向外部服务器的URL。
3.  **发送Payload到服务器:** 攻击者将构造好的XML payload通过HTTP请求发送到Ktor服务器的某个接受XML数据的端点。
4.  **利用XXE读取文件/SSRF:**  服务器解析XML时，会尝试解析外部实体。如果外部实体指向本地文件，则服务器会将文件内容返回给攻击者（文件读取）。如果外部实体指向外部URL，则服务器会向该URL发起请求（SSRF）。

**漏洞缓解措施：**

*   升级Ktor版本到2.3.5或更高版本。
*   禁用或严格配置XML解析器的外部实体解析功能。在Ktor中，可以通过配置`XML`序列化器来禁用外部实体解析。

**项目地址:** [aecelen/ktor-xxe-poc](https://github.com/aecelen/ktor-xxe-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #2

**来源**: [CVE-2023-45612-bbugdigger_ktor-xxe-poc.md](../2023/CVE-2023-45612-bbugdigger_ktor-xxe-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 目标应用启用了XML ContentNegotiation且使用默认配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612是JetBrains Ktor框架在2.3.5版本之前的XML处理中存在的一个XXE漏洞。默认情况下，ContentNegotiation在使用XML格式时存在安全隐患，允许攻击者通过构造恶意的XML请求来读取服务器上的任意文件或执行其他恶意操作。

**有效性分析：**
根据提供的POC代码，该漏洞的利用步骤如下：
1.  克隆包含漏洞利用代码的`ktor-xxe-poc`仓库。
2.  使用Gradle构建并运行Ktor应用程序（该应用程序模拟了存在漏洞的服务）。
3.  在另一个终端中使用Python脚本`xxe_poc.py`发送包含恶意XML Payload的请求。

通过执行这些步骤，可以验证目标服务是否存在XXE漏洞。

**投毒风险分析：**
代码仓库中可能存在投毒风险，例如在`build.gradle.kts`中引入恶意的依赖，或者在`xxe_poc.py`脚本中执行恶意操作。以下是评估结果：
*   **build.gradle.kts:** 检查依赖项，libs.xmlutil.core、libs.xmlutil.serialization可能存在被替换成恶意依赖的风险，例如，指向一个包含恶意代码的Maven仓库。虽然检查这些依赖库的安全性可以降低风险，但并不能完全排除。
*   **xxe_poc.py:** 此脚本是POC验证脚本，用于发送恶意XML，主要用于读取文件，进行SSRF等操作，但可能存在后门，例如执行系统命令，连接恶意服务器等。需要仔细审查该脚本。
*   **gradlew:** 主要用于构建， 脚本本身没有明显的投毒特征。

由于不清楚`xxe_poc.py`的具体内容，以及无法对远程maven仓库中的依赖项进行安全评估，因此给出10%的投毒风险。

**利用方式：**
攻击者可以发送一个包含恶意XML Payload的请求，该Payload包含一个指向外部实体的声明。当Ktor应用解析该XML时，会尝试加载外部实体，从而导致：
*   **任意文件读取：** 攻击者可以读取服务器上的任意文件，例如配置文件、密钥等。
*   **服务端请求伪造（SSRF）：** 攻击者可以利用服务器作为跳板，向内部网络或外部网络发起请求。
*   **拒绝服务攻击（DoS）：** 通过引用一个无限循环的外部实体，导致服务器资源耗尽。

**项目地址:** [bbugdigger/ktor-xxe-poc](https://github.com/bbugdigger/ktor-xxe-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #3

**来源**: [CVE-2023-45612-clemfavre_cve-2023-45612_exploit.md](../2023/CVE-2023-45612-clemfavre_cve-2023-45612_exploit.md)

# CVE-2023-45612

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45612-aecelen_ktor-xxe-poc.md](../2023/CVE-2023-45612-aecelen_ktor-xxe-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用程序启用ContentNegotiation并使用XML格式，目标服务器可以访问外部资源

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45612是JetBrains Ktor 2.3.5之前的版本中存在的一个XXE（XML外部实体注入）漏洞。当Ktor应用程序使用ContentNegotiation feature处理XML格式数据时，如果默认配置未进行安全加固，攻击者可以通过在XML payload中插入恶意实体引用来读取服务器上的任意文件或进行服务器端请求伪造（SSRF）。

**有效性：**

根据提供的漏洞库信息和漏洞利用代码，该漏洞的POC代码是有效的。漏洞库明确指出Ktor 2.3.5之前的版本存在XXE漏洞，并给出了受影响的版本范围。POC代码提供了重现该漏洞所需的必要组件，包括一个基于Ktor的简单服务器和一个用于发送恶意XML payload的Python脚本。

**投毒风险：**

查看POC代码，包括`README.md`, `build.gradle.kts`, `gradle.properties`, `gradlew`和`test.py`，没有发现任何恶意代码或后门。所有代码都用于设置Ktor服务器并利用XXE漏洞。虽然不能完全排除所有可能性，但根据目前的信息，投毒风险较低，可以认为是0%。`gradlew`只是一个gradle的wrapper脚本，用于在没有全局安装gradle的情况下运行gradle命令。

**利用方式：**

1.  **配置易受攻击的Ktor应用:** 确保目标Ktor应用的版本低于2.3.5，并启用了ContentNegotiation feature，且支持XML格式的处理。
2.  **构造恶意XML Payload:** 攻击者需要构造一个包含外部实体声明的XML payload。例如，payload可能包含一个指向服务器本地文件的实体引用，或者一个指向外部服务器的URL。
3.  **发送Payload到服务器:** 攻击者将构造好的XML payload通过HTTP请求发送到Ktor服务器的某个接受XML数据的端点。
4.  **利用XXE读取文件/SSRF:**  服务器解析XML时，会尝试解析外部实体。如果外部实体指向本地文件，则服务器会将文件内容返回给攻击者（文件读取）。如果外部实体指向外部URL，则服务器会向该URL发起请求（SSRF）。

**漏洞缓解措施：**

*   升级Ktor版本到2.3.5或更高版本。
*   禁用或严格配置XML解析器的外部实体解析功能。在Ktor中，可以通过配置`XML`序列化器来禁用外部实体解析。

**项目地址:** [aecelen/ktor-xxe-poc](https://github.com/aecelen/ktor-xxe-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #2

**来源**: [CVE-2023-45612-bbugdigger_ktor-xxe-poc.md](../2023/CVE-2023-45612-bbugdigger_ktor-xxe-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 目标应用启用了XML ContentNegotiation且使用默认配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612是JetBrains Ktor框架在2.3.5版本之前的XML处理中存在的一个XXE漏洞。默认情况下，ContentNegotiation在使用XML格式时存在安全隐患，允许攻击者通过构造恶意的XML请求来读取服务器上的任意文件或执行其他恶意操作。

**有效性分析：**
根据提供的POC代码，该漏洞的利用步骤如下：
1.  克隆包含漏洞利用代码的`ktor-xxe-poc`仓库。
2.  使用Gradle构建并运行Ktor应用程序（该应用程序模拟了存在漏洞的服务）。
3.  在另一个终端中使用Python脚本`xxe_poc.py`发送包含恶意XML Payload的请求。

通过执行这些步骤，可以验证目标服务是否存在XXE漏洞。

**投毒风险分析：**
代码仓库中可能存在投毒风险，例如在`build.gradle.kts`中引入恶意的依赖，或者在`xxe_poc.py`脚本中执行恶意操作。以下是评估结果：
*   **build.gradle.kts:** 检查依赖项，libs.xmlutil.core、libs.xmlutil.serialization可能存在被替换成恶意依赖的风险，例如，指向一个包含恶意代码的Maven仓库。虽然检查这些依赖库的安全性可以降低风险，但并不能完全排除。
*   **xxe_poc.py:** 此脚本是POC验证脚本，用于发送恶意XML，主要用于读取文件，进行SSRF等操作，但可能存在后门，例如执行系统命令，连接恶意服务器等。需要仔细审查该脚本。
*   **gradlew:** 主要用于构建， 脚本本身没有明显的投毒特征。

由于不清楚`xxe_poc.py`的具体内容，以及无法对远程maven仓库中的依赖项进行安全评估，因此给出10%的投毒风险。

**利用方式：**
攻击者可以发送一个包含恶意XML Payload的请求，该Payload包含一个指向外部实体的声明。当Ktor应用解析该XML时，会尝试加载外部实体，从而导致：
*   **任意文件读取：** 攻击者可以读取服务器上的任意文件，例如配置文件、密钥等。
*   **服务端请求伪造（SSRF）：** 攻击者可以利用服务器作为跳板，向内部网络或外部网络发起请求。
*   **拒绝服务攻击（DoS）：** 通过引用一个无限循环的外部实体，导致服务器资源耗尽。

**项目地址:** [bbugdigger/ktor-xxe-poc](https://github.com/bbugdigger/ktor-xxe-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #3

**来源**: [CVE-2023-45612-clemfavre_cve-2023-45612_exploit.md](../2023/CVE-2023-45612-clemfavre_cve-2023-45612_exploit.md)

# CVE-2023-45612

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45612-aecelen_ktor-xxe-poc.md](../2023/CVE-2023-45612-aecelen_ktor-xxe-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用程序启用ContentNegotiation并使用XML格式，目标服务器可以访问外部资源

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45612是JetBrains Ktor 2.3.5之前的版本中存在的一个XXE（XML外部实体注入）漏洞。当Ktor应用程序使用ContentNegotiation feature处理XML格式数据时，如果默认配置未进行安全加固，攻击者可以通过在XML payload中插入恶意实体引用来读取服务器上的任意文件或进行服务器端请求伪造（SSRF）。

**有效性：**

根据提供的漏洞库信息和漏洞利用代码，该漏洞的POC代码是有效的。漏洞库明确指出Ktor 2.3.5之前的版本存在XXE漏洞，并给出了受影响的版本范围。POC代码提供了重现该漏洞所需的必要组件，包括一个基于Ktor的简单服务器和一个用于发送恶意XML payload的Python脚本。

**投毒风险：**

查看POC代码，包括`README.md`, `build.gradle.kts`, `gradle.properties`, `gradlew`和`test.py`，没有发现任何恶意代码或后门。所有代码都用于设置Ktor服务器并利用XXE漏洞。虽然不能完全排除所有可能性，但根据目前的信息，投毒风险较低，可以认为是0%。`gradlew`只是一个gradle的wrapper脚本，用于在没有全局安装gradle的情况下运行gradle命令。

**利用方式：**

1.  **配置易受攻击的Ktor应用:** 确保目标Ktor应用的版本低于2.3.5，并启用了ContentNegotiation feature，且支持XML格式的处理。
2.  **构造恶意XML Payload:** 攻击者需要构造一个包含外部实体声明的XML payload。例如，payload可能包含一个指向服务器本地文件的实体引用，或者一个指向外部服务器的URL。
3.  **发送Payload到服务器:** 攻击者将构造好的XML payload通过HTTP请求发送到Ktor服务器的某个接受XML数据的端点。
4.  **利用XXE读取文件/SSRF:**  服务器解析XML时，会尝试解析外部实体。如果外部实体指向本地文件，则服务器会将文件内容返回给攻击者（文件读取）。如果外部实体指向外部URL，则服务器会向该URL发起请求（SSRF）。

**漏洞缓解措施：**

*   升级Ktor版本到2.3.5或更高版本。
*   禁用或严格配置XML解析器的外部实体解析功能。在Ktor中，可以通过配置`XML`序列化器来禁用外部实体解析。

**项目地址:** [aecelen/ktor-xxe-poc](https://github.com/aecelen/ktor-xxe-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #2

**来源**: [CVE-2023-45612-bbugdigger_ktor-xxe-poc.md](../2023/CVE-2023-45612-bbugdigger_ktor-xxe-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 目标应用启用了XML ContentNegotiation且使用默认配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612是JetBrains Ktor框架在2.3.5版本之前的XML处理中存在的一个XXE漏洞。默认情况下，ContentNegotiation在使用XML格式时存在安全隐患，允许攻击者通过构造恶意的XML请求来读取服务器上的任意文件或执行其他恶意操作。

**有效性分析：**
根据提供的POC代码，该漏洞的利用步骤如下：
1.  克隆包含漏洞利用代码的`ktor-xxe-poc`仓库。
2.  使用Gradle构建并运行Ktor应用程序（该应用程序模拟了存在漏洞的服务）。
3.  在另一个终端中使用Python脚本`xxe_poc.py`发送包含恶意XML Payload的请求。

通过执行这些步骤，可以验证目标服务是否存在XXE漏洞。

**投毒风险分析：**
代码仓库中可能存在投毒风险，例如在`build.gradle.kts`中引入恶意的依赖，或者在`xxe_poc.py`脚本中执行恶意操作。以下是评估结果：
*   **build.gradle.kts:** 检查依赖项，libs.xmlutil.core、libs.xmlutil.serialization可能存在被替换成恶意依赖的风险，例如，指向一个包含恶意代码的Maven仓库。虽然检查这些依赖库的安全性可以降低风险，但并不能完全排除。
*   **xxe_poc.py:** 此脚本是POC验证脚本，用于发送恶意XML，主要用于读取文件，进行SSRF等操作，但可能存在后门，例如执行系统命令，连接恶意服务器等。需要仔细审查该脚本。
*   **gradlew:** 主要用于构建， 脚本本身没有明显的投毒特征。

由于不清楚`xxe_poc.py`的具体内容，以及无法对远程maven仓库中的依赖项进行安全评估，因此给出10%的投毒风险。

**利用方式：**
攻击者可以发送一个包含恶意XML Payload的请求，该Payload包含一个指向外部实体的声明。当Ktor应用解析该XML时，会尝试加载外部实体，从而导致：
*   **任意文件读取：** 攻击者可以读取服务器上的任意文件，例如配置文件、密钥等。
*   **服务端请求伪造（SSRF）：** 攻击者可以利用服务器作为跳板，向内部网络或外部网络发起请求。
*   **拒绝服务攻击（DoS）：** 通过引用一个无限循环的外部实体，导致服务器资源耗尽。

**项目地址:** [bbugdigger/ktor-xxe-poc](https://github.com/bbugdigger/ktor-xxe-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #3

**来源**: [CVE-2023-45612-clemfavre_cve-2023-45612_exploit.md](../2023/CVE-2023-45612-clemfavre_cve-2023-45612_exploit.md)

# CVE-2023-45612

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45612-aecelen_ktor-xxe-poc.md](../2023/CVE-2023-45612-aecelen_ktor-xxe-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用程序启用ContentNegotiation并使用XML格式，目标服务器可以访问外部资源

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45612是JetBrains Ktor 2.3.5之前的版本中存在的一个XXE（XML外部实体注入）漏洞。当Ktor应用程序使用ContentNegotiation feature处理XML格式数据时，如果默认配置未进行安全加固，攻击者可以通过在XML payload中插入恶意实体引用来读取服务器上的任意文件或进行服务器端请求伪造（SSRF）。

**有效性：**

根据提供的漏洞库信息和漏洞利用代码，该漏洞的POC代码是有效的。漏洞库明确指出Ktor 2.3.5之前的版本存在XXE漏洞，并给出了受影响的版本范围。POC代码提供了重现该漏洞所需的必要组件，包括一个基于Ktor的简单服务器和一个用于发送恶意XML payload的Python脚本。

**投毒风险：**

查看POC代码，包括`README.md`, `build.gradle.kts`, `gradle.properties`, `gradlew`和`test.py`，没有发现任何恶意代码或后门。所有代码都用于设置Ktor服务器并利用XXE漏洞。虽然不能完全排除所有可能性，但根据目前的信息，投毒风险较低，可以认为是0%。`gradlew`只是一个gradle的wrapper脚本，用于在没有全局安装gradle的情况下运行gradle命令。

**利用方式：**

1.  **配置易受攻击的Ktor应用:** 确保目标Ktor应用的版本低于2.3.5，并启用了ContentNegotiation feature，且支持XML格式的处理。
2.  **构造恶意XML Payload:** 攻击者需要构造一个包含外部实体声明的XML payload。例如，payload可能包含一个指向服务器本地文件的实体引用，或者一个指向外部服务器的URL。
3.  **发送Payload到服务器:** 攻击者将构造好的XML payload通过HTTP请求发送到Ktor服务器的某个接受XML数据的端点。
4.  **利用XXE读取文件/SSRF:**  服务器解析XML时，会尝试解析外部实体。如果外部实体指向本地文件，则服务器会将文件内容返回给攻击者（文件读取）。如果外部实体指向外部URL，则服务器会向该URL发起请求（SSRF）。

**漏洞缓解措施：**

*   升级Ktor版本到2.3.5或更高版本。
*   禁用或严格配置XML解析器的外部实体解析功能。在Ktor中，可以通过配置`XML`序列化器来禁用外部实体解析。

**项目地址:** [aecelen/ktor-xxe-poc](https://github.com/aecelen/ktor-xxe-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #2

**来源**: [CVE-2023-45612-bbugdigger_ktor-xxe-poc.md](../2023/CVE-2023-45612-bbugdigger_ktor-xxe-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 目标应用启用了XML ContentNegotiation且使用默认配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612是JetBrains Ktor框架在2.3.5版本之前的XML处理中存在的一个XXE漏洞。默认情况下，ContentNegotiation在使用XML格式时存在安全隐患，允许攻击者通过构造恶意的XML请求来读取服务器上的任意文件或执行其他恶意操作。

**有效性分析：**
根据提供的POC代码，该漏洞的利用步骤如下：
1.  克隆包含漏洞利用代码的`ktor-xxe-poc`仓库。
2.  使用Gradle构建并运行Ktor应用程序（该应用程序模拟了存在漏洞的服务）。
3.  在另一个终端中使用Python脚本`xxe_poc.py`发送包含恶意XML Payload的请求。

通过执行这些步骤，可以验证目标服务是否存在XXE漏洞。

**投毒风险分析：**
代码仓库中可能存在投毒风险，例如在`build.gradle.kts`中引入恶意的依赖，或者在`xxe_poc.py`脚本中执行恶意操作。以下是评估结果：
*   **build.gradle.kts:** 检查依赖项，libs.xmlutil.core、libs.xmlutil.serialization可能存在被替换成恶意依赖的风险，例如，指向一个包含恶意代码的Maven仓库。虽然检查这些依赖库的安全性可以降低风险，但并不能完全排除。
*   **xxe_poc.py:** 此脚本是POC验证脚本，用于发送恶意XML，主要用于读取文件，进行SSRF等操作，但可能存在后门，例如执行系统命令，连接恶意服务器等。需要仔细审查该脚本。
*   **gradlew:** 主要用于构建， 脚本本身没有明显的投毒特征。

由于不清楚`xxe_poc.py`的具体内容，以及无法对远程maven仓库中的依赖项进行安全评估，因此给出10%的投毒风险。

**利用方式：**
攻击者可以发送一个包含恶意XML Payload的请求，该Payload包含一个指向外部实体的声明。当Ktor应用解析该XML时，会尝试加载外部实体，从而导致：
*   **任意文件读取：** 攻击者可以读取服务器上的任意文件，例如配置文件、密钥等。
*   **服务端请求伪造（SSRF）：** 攻击者可以利用服务器作为跳板，向内部网络或外部网络发起请求。
*   **拒绝服务攻击（DoS）：** 通过引用一个无限循环的外部实体，导致服务器资源耗尽。

**项目地址:** [bbugdigger/ktor-xxe-poc](https://github.com/bbugdigger/ktor-xxe-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #3

**来源**: [CVE-2023-45612-clemfavre_cve-2023-45612_exploit.md](../2023/CVE-2023-45612-clemfavre_cve-2023-45612_exploit.md)

# CVE-2023-45612

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45612-aecelen_ktor-xxe-poc.md](../2023/CVE-2023-45612-aecelen_ktor-xxe-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用程序启用ContentNegotiation并使用XML格式，目标服务器可以访问外部资源

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45612是JetBrains Ktor 2.3.5之前的版本中存在的一个XXE（XML外部实体注入）漏洞。当Ktor应用程序使用ContentNegotiation feature处理XML格式数据时，如果默认配置未进行安全加固，攻击者可以通过在XML payload中插入恶意实体引用来读取服务器上的任意文件或进行服务器端请求伪造（SSRF）。

**有效性：**

根据提供的漏洞库信息和漏洞利用代码，该漏洞的POC代码是有效的。漏洞库明确指出Ktor 2.3.5之前的版本存在XXE漏洞，并给出了受影响的版本范围。POC代码提供了重现该漏洞所需的必要组件，包括一个基于Ktor的简单服务器和一个用于发送恶意XML payload的Python脚本。

**投毒风险：**

查看POC代码，包括`README.md`, `build.gradle.kts`, `gradle.properties`, `gradlew`和`test.py`，没有发现任何恶意代码或后门。所有代码都用于设置Ktor服务器并利用XXE漏洞。虽然不能完全排除所有可能性，但根据目前的信息，投毒风险较低，可以认为是0%。`gradlew`只是一个gradle的wrapper脚本，用于在没有全局安装gradle的情况下运行gradle命令。

**利用方式：**

1.  **配置易受攻击的Ktor应用:** 确保目标Ktor应用的版本低于2.3.5，并启用了ContentNegotiation feature，且支持XML格式的处理。
2.  **构造恶意XML Payload:** 攻击者需要构造一个包含外部实体声明的XML payload。例如，payload可能包含一个指向服务器本地文件的实体引用，或者一个指向外部服务器的URL。
3.  **发送Payload到服务器:** 攻击者将构造好的XML payload通过HTTP请求发送到Ktor服务器的某个接受XML数据的端点。
4.  **利用XXE读取文件/SSRF:**  服务器解析XML时，会尝试解析外部实体。如果外部实体指向本地文件，则服务器会将文件内容返回给攻击者（文件读取）。如果外部实体指向外部URL，则服务器会向该URL发起请求（SSRF）。

**漏洞缓解措施：**

*   升级Ktor版本到2.3.5或更高版本。
*   禁用或严格配置XML解析器的外部实体解析功能。在Ktor中，可以通过配置`XML`序列化器来禁用外部实体解析。

**项目地址:** [aecelen/ktor-xxe-poc](https://github.com/aecelen/ktor-xxe-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #2

**来源**: [CVE-2023-45612-bbugdigger_ktor-xxe-poc.md](../2023/CVE-2023-45612-bbugdigger_ktor-xxe-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 目标应用启用了XML ContentNegotiation且使用默认配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612是JetBrains Ktor框架在2.3.5版本之前的XML处理中存在的一个XXE漏洞。默认情况下，ContentNegotiation在使用XML格式时存在安全隐患，允许攻击者通过构造恶意的XML请求来读取服务器上的任意文件或执行其他恶意操作。

**有效性分析：**
根据提供的POC代码，该漏洞的利用步骤如下：
1.  克隆包含漏洞利用代码的`ktor-xxe-poc`仓库。
2.  使用Gradle构建并运行Ktor应用程序（该应用程序模拟了存在漏洞的服务）。
3.  在另一个终端中使用Python脚本`xxe_poc.py`发送包含恶意XML Payload的请求。

通过执行这些步骤，可以验证目标服务是否存在XXE漏洞。

**投毒风险分析：**
代码仓库中可能存在投毒风险，例如在`build.gradle.kts`中引入恶意的依赖，或者在`xxe_poc.py`脚本中执行恶意操作。以下是评估结果：
*   **build.gradle.kts:** 检查依赖项，libs.xmlutil.core、libs.xmlutil.serialization可能存在被替换成恶意依赖的风险，例如，指向一个包含恶意代码的Maven仓库。虽然检查这些依赖库的安全性可以降低风险，但并不能完全排除。
*   **xxe_poc.py:** 此脚本是POC验证脚本，用于发送恶意XML，主要用于读取文件，进行SSRF等操作，但可能存在后门，例如执行系统命令，连接恶意服务器等。需要仔细审查该脚本。
*   **gradlew:** 主要用于构建， 脚本本身没有明显的投毒特征。

由于不清楚`xxe_poc.py`的具体内容，以及无法对远程maven仓库中的依赖项进行安全评估，因此给出10%的投毒风险。

**利用方式：**
攻击者可以发送一个包含恶意XML Payload的请求，该Payload包含一个指向外部实体的声明。当Ktor应用解析该XML时，会尝试加载外部实体，从而导致：
*   **任意文件读取：** 攻击者可以读取服务器上的任意文件，例如配置文件、密钥等。
*   **服务端请求伪造（SSRF）：** 攻击者可以利用服务器作为跳板，向内部网络或外部网络发起请求。
*   **拒绝服务攻击（DoS）：** 通过引用一个无限循环的外部实体，导致服务器资源耗尽。

**项目地址:** [bbugdigger/ktor-xxe-poc](https://github.com/bbugdigger/ktor-xxe-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #3

**来源**: [CVE-2023-45612-clemfavre_cve-2023-45612_exploit.md](../2023/CVE-2023-45612-clemfavre_cve-2023-45612_exploit.md)

# CVE-2023-45612

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45612-aecelen_ktor-xxe-poc.md](../2023/CVE-2023-45612-aecelen_ktor-xxe-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用程序启用ContentNegotiation并使用XML格式，目标服务器可以访问外部资源

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45612是JetBrains Ktor 2.3.5之前的版本中存在的一个XXE（XML外部实体注入）漏洞。当Ktor应用程序使用ContentNegotiation feature处理XML格式数据时，如果默认配置未进行安全加固，攻击者可以通过在XML payload中插入恶意实体引用来读取服务器上的任意文件或进行服务器端请求伪造（SSRF）。

**有效性：**

根据提供的漏洞库信息和漏洞利用代码，该漏洞的POC代码是有效的。漏洞库明确指出Ktor 2.3.5之前的版本存在XXE漏洞，并给出了受影响的版本范围。POC代码提供了重现该漏洞所需的必要组件，包括一个基于Ktor的简单服务器和一个用于发送恶意XML payload的Python脚本。

**投毒风险：**

查看POC代码，包括`README.md`, `build.gradle.kts`, `gradle.properties`, `gradlew`和`test.py`，没有发现任何恶意代码或后门。所有代码都用于设置Ktor服务器并利用XXE漏洞。虽然不能完全排除所有可能性，但根据目前的信息，投毒风险较低，可以认为是0%。`gradlew`只是一个gradle的wrapper脚本，用于在没有全局安装gradle的情况下运行gradle命令。

**利用方式：**

1.  **配置易受攻击的Ktor应用:** 确保目标Ktor应用的版本低于2.3.5，并启用了ContentNegotiation feature，且支持XML格式的处理。
2.  **构造恶意XML Payload:** 攻击者需要构造一个包含外部实体声明的XML payload。例如，payload可能包含一个指向服务器本地文件的实体引用，或者一个指向外部服务器的URL。
3.  **发送Payload到服务器:** 攻击者将构造好的XML payload通过HTTP请求发送到Ktor服务器的某个接受XML数据的端点。
4.  **利用XXE读取文件/SSRF:**  服务器解析XML时，会尝试解析外部实体。如果外部实体指向本地文件，则服务器会将文件内容返回给攻击者（文件读取）。如果外部实体指向外部URL，则服务器会向该URL发起请求（SSRF）。

**漏洞缓解措施：**

*   升级Ktor版本到2.3.5或更高版本。
*   禁用或严格配置XML解析器的外部实体解析功能。在Ktor中，可以通过配置`XML`序列化器来禁用外部实体解析。

**项目地址:** [aecelen/ktor-xxe-poc](https://github.com/aecelen/ktor-xxe-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #2

**来源**: [CVE-2023-45612-bbugdigger_ktor-xxe-poc.md](../2023/CVE-2023-45612-bbugdigger_ktor-xxe-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 目标应用启用了XML ContentNegotiation且使用默认配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612是JetBrains Ktor框架在2.3.5版本之前的XML处理中存在的一个XXE漏洞。默认情况下，ContentNegotiation在使用XML格式时存在安全隐患，允许攻击者通过构造恶意的XML请求来读取服务器上的任意文件或执行其他恶意操作。

**有效性分析：**
根据提供的POC代码，该漏洞的利用步骤如下：
1.  克隆包含漏洞利用代码的`ktor-xxe-poc`仓库。
2.  使用Gradle构建并运行Ktor应用程序（该应用程序模拟了存在漏洞的服务）。
3.  在另一个终端中使用Python脚本`xxe_poc.py`发送包含恶意XML Payload的请求。

通过执行这些步骤，可以验证目标服务是否存在XXE漏洞。

**投毒风险分析：**
代码仓库中可能存在投毒风险，例如在`build.gradle.kts`中引入恶意的依赖，或者在`xxe_poc.py`脚本中执行恶意操作。以下是评估结果：
*   **build.gradle.kts:** 检查依赖项，libs.xmlutil.core、libs.xmlutil.serialization可能存在被替换成恶意依赖的风险，例如，指向一个包含恶意代码的Maven仓库。虽然检查这些依赖库的安全性可以降低风险，但并不能完全排除。
*   **xxe_poc.py:** 此脚本是POC验证脚本，用于发送恶意XML，主要用于读取文件，进行SSRF等操作，但可能存在后门，例如执行系统命令，连接恶意服务器等。需要仔细审查该脚本。
*   **gradlew:** 主要用于构建， 脚本本身没有明显的投毒特征。

由于不清楚`xxe_poc.py`的具体内容，以及无法对远程maven仓库中的依赖项进行安全评估，因此给出10%的投毒风险。

**利用方式：**
攻击者可以发送一个包含恶意XML Payload的请求，该Payload包含一个指向外部实体的声明。当Ktor应用解析该XML时，会尝试加载外部实体，从而导致：
*   **任意文件读取：** 攻击者可以读取服务器上的任意文件，例如配置文件、密钥等。
*   **服务端请求伪造（SSRF）：** 攻击者可以利用服务器作为跳板，向内部网络或外部网络发起请求。
*   **拒绝服务攻击（DoS）：** 通过引用一个无限循环的外部实体，导致服务器资源耗尽。

**项目地址:** [bbugdigger/ktor-xxe-poc](https://github.com/bbugdigger/ktor-xxe-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #3

**来源**: [CVE-2023-45612-clemfavre_cve-2023-45612_exploit.md](../2023/CVE-2023-45612-clemfavre_cve-2023-45612_exploit.md)

# CVE-2023-45612

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45612-aecelen_ktor-xxe-poc.md](../2023/CVE-2023-45612-aecelen_ktor-xxe-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用程序启用ContentNegotiation并使用XML格式，目标服务器可以访问外部资源

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45612是JetBrains Ktor 2.3.5之前的版本中存在的一个XXE（XML外部实体注入）漏洞。当Ktor应用程序使用ContentNegotiation feature处理XML格式数据时，如果默认配置未进行安全加固，攻击者可以通过在XML payload中插入恶意实体引用来读取服务器上的任意文件或进行服务器端请求伪造（SSRF）。

**有效性：**

根据提供的漏洞库信息和漏洞利用代码，该漏洞的POC代码是有效的。漏洞库明确指出Ktor 2.3.5之前的版本存在XXE漏洞，并给出了受影响的版本范围。POC代码提供了重现该漏洞所需的必要组件，包括一个基于Ktor的简单服务器和一个用于发送恶意XML payload的Python脚本。

**投毒风险：**

查看POC代码，包括`README.md`, `build.gradle.kts`, `gradle.properties`, `gradlew`和`test.py`，没有发现任何恶意代码或后门。所有代码都用于设置Ktor服务器并利用XXE漏洞。虽然不能完全排除所有可能性，但根据目前的信息，投毒风险较低，可以认为是0%。`gradlew`只是一个gradle的wrapper脚本，用于在没有全局安装gradle的情况下运行gradle命令。

**利用方式：**

1.  **配置易受攻击的Ktor应用:** 确保目标Ktor应用的版本低于2.3.5，并启用了ContentNegotiation feature，且支持XML格式的处理。
2.  **构造恶意XML Payload:** 攻击者需要构造一个包含外部实体声明的XML payload。例如，payload可能包含一个指向服务器本地文件的实体引用，或者一个指向外部服务器的URL。
3.  **发送Payload到服务器:** 攻击者将构造好的XML payload通过HTTP请求发送到Ktor服务器的某个接受XML数据的端点。
4.  **利用XXE读取文件/SSRF:**  服务器解析XML时，会尝试解析外部实体。如果外部实体指向本地文件，则服务器会将文件内容返回给攻击者（文件读取）。如果外部实体指向外部URL，则服务器会向该URL发起请求（SSRF）。

**漏洞缓解措施：**

*   升级Ktor版本到2.3.5或更高版本。
*   禁用或严格配置XML解析器的外部实体解析功能。在Ktor中，可以通过配置`XML`序列化器来禁用外部实体解析。

**项目地址:** [aecelen/ktor-xxe-poc](https://github.com/aecelen/ktor-xxe-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #2

**来源**: [CVE-2023-45612-bbugdigger_ktor-xxe-poc.md](../2023/CVE-2023-45612-bbugdigger_ktor-xxe-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 目标应用启用了XML ContentNegotiation且使用默认配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612是JetBrains Ktor框架在2.3.5版本之前的XML处理中存在的一个XXE漏洞。默认情况下，ContentNegotiation在使用XML格式时存在安全隐患，允许攻击者通过构造恶意的XML请求来读取服务器上的任意文件或执行其他恶意操作。

**有效性分析：**
根据提供的POC代码，该漏洞的利用步骤如下：
1.  克隆包含漏洞利用代码的`ktor-xxe-poc`仓库。
2.  使用Gradle构建并运行Ktor应用程序（该应用程序模拟了存在漏洞的服务）。
3.  在另一个终端中使用Python脚本`xxe_poc.py`发送包含恶意XML Payload的请求。

通过执行这些步骤，可以验证目标服务是否存在XXE漏洞。

**投毒风险分析：**
代码仓库中可能存在投毒风险，例如在`build.gradle.kts`中引入恶意的依赖，或者在`xxe_poc.py`脚本中执行恶意操作。以下是评估结果：
*   **build.gradle.kts:** 检查依赖项，libs.xmlutil.core、libs.xmlutil.serialization可能存在被替换成恶意依赖的风险，例如，指向一个包含恶意代码的Maven仓库。虽然检查这些依赖库的安全性可以降低风险，但并不能完全排除。
*   **xxe_poc.py:** 此脚本是POC验证脚本，用于发送恶意XML，主要用于读取文件，进行SSRF等操作，但可能存在后门，例如执行系统命令，连接恶意服务器等。需要仔细审查该脚本。
*   **gradlew:** 主要用于构建， 脚本本身没有明显的投毒特征。

由于不清楚`xxe_poc.py`的具体内容，以及无法对远程maven仓库中的依赖项进行安全评估，因此给出10%的投毒风险。

**利用方式：**
攻击者可以发送一个包含恶意XML Payload的请求，该Payload包含一个指向外部实体的声明。当Ktor应用解析该XML时，会尝试加载外部实体，从而导致：
*   **任意文件读取：** 攻击者可以读取服务器上的任意文件，例如配置文件、密钥等。
*   **服务端请求伪造（SSRF）：** 攻击者可以利用服务器作为跳板，向内部网络或外部网络发起请求。
*   **拒绝服务攻击（DoS）：** 通过引用一个无限循环的外部实体，导致服务器资源耗尽。

**项目地址:** [bbugdigger/ktor-xxe-poc](https://github.com/bbugdigger/ktor-xxe-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #3

**来源**: [CVE-2023-45612-clemfavre_cve-2023-45612_exploit.md](../2023/CVE-2023-45612-clemfavre_cve-2023-45612_exploit.md)

# CVE-2023-45612

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45612-aecelen_ktor-xxe-poc.md](../2023/CVE-2023-45612-aecelen_ktor-xxe-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用程序启用ContentNegotiation并使用XML格式，目标服务器可以访问外部资源

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45612是JetBrains Ktor 2.3.5之前的版本中存在的一个XXE（XML外部实体注入）漏洞。当Ktor应用程序使用ContentNegotiation feature处理XML格式数据时，如果默认配置未进行安全加固，攻击者可以通过在XML payload中插入恶意实体引用来读取服务器上的任意文件或进行服务器端请求伪造（SSRF）。

**有效性：**

根据提供的漏洞库信息和漏洞利用代码，该漏洞的POC代码是有效的。漏洞库明确指出Ktor 2.3.5之前的版本存在XXE漏洞，并给出了受影响的版本范围。POC代码提供了重现该漏洞所需的必要组件，包括一个基于Ktor的简单服务器和一个用于发送恶意XML payload的Python脚本。

**投毒风险：**

查看POC代码，包括`README.md`, `build.gradle.kts`, `gradle.properties`, `gradlew`和`test.py`，没有发现任何恶意代码或后门。所有代码都用于设置Ktor服务器并利用XXE漏洞。虽然不能完全排除所有可能性，但根据目前的信息，投毒风险较低，可以认为是0%。`gradlew`只是一个gradle的wrapper脚本，用于在没有全局安装gradle的情况下运行gradle命令。

**利用方式：**

1.  **配置易受攻击的Ktor应用:** 确保目标Ktor应用的版本低于2.3.5，并启用了ContentNegotiation feature，且支持XML格式的处理。
2.  **构造恶意XML Payload:** 攻击者需要构造一个包含外部实体声明的XML payload。例如，payload可能包含一个指向服务器本地文件的实体引用，或者一个指向外部服务器的URL。
3.  **发送Payload到服务器:** 攻击者将构造好的XML payload通过HTTP请求发送到Ktor服务器的某个接受XML数据的端点。
4.  **利用XXE读取文件/SSRF:**  服务器解析XML时，会尝试解析外部实体。如果外部实体指向本地文件，则服务器会将文件内容返回给攻击者（文件读取）。如果外部实体指向外部URL，则服务器会向该URL发起请求（SSRF）。

**漏洞缓解措施：**

*   升级Ktor版本到2.3.5或更高版本。
*   禁用或严格配置XML解析器的外部实体解析功能。在Ktor中，可以通过配置`XML`序列化器来禁用外部实体解析。

**项目地址:** [aecelen/ktor-xxe-poc](https://github.com/aecelen/ktor-xxe-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #2

**来源**: [CVE-2023-45612-bbugdigger_ktor-xxe-poc.md](../2023/CVE-2023-45612-bbugdigger_ktor-xxe-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 目标应用启用了XML ContentNegotiation且使用默认配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612是JetBrains Ktor框架在2.3.5版本之前的XML处理中存在的一个XXE漏洞。默认情况下，ContentNegotiation在使用XML格式时存在安全隐患，允许攻击者通过构造恶意的XML请求来读取服务器上的任意文件或执行其他恶意操作。

**有效性分析：**
根据提供的POC代码，该漏洞的利用步骤如下：
1.  克隆包含漏洞利用代码的`ktor-xxe-poc`仓库。
2.  使用Gradle构建并运行Ktor应用程序（该应用程序模拟了存在漏洞的服务）。
3.  在另一个终端中使用Python脚本`xxe_poc.py`发送包含恶意XML Payload的请求。

通过执行这些步骤，可以验证目标服务是否存在XXE漏洞。

**投毒风险分析：**
代码仓库中可能存在投毒风险，例如在`build.gradle.kts`中引入恶意的依赖，或者在`xxe_poc.py`脚本中执行恶意操作。以下是评估结果：
*   **build.gradle.kts:** 检查依赖项，libs.xmlutil.core、libs.xmlutil.serialization可能存在被替换成恶意依赖的风险，例如，指向一个包含恶意代码的Maven仓库。虽然检查这些依赖库的安全性可以降低风险，但并不能完全排除。
*   **xxe_poc.py:** 此脚本是POC验证脚本，用于发送恶意XML，主要用于读取文件，进行SSRF等操作，但可能存在后门，例如执行系统命令，连接恶意服务器等。需要仔细审查该脚本。
*   **gradlew:** 主要用于构建， 脚本本身没有明显的投毒特征。

由于不清楚`xxe_poc.py`的具体内容，以及无法对远程maven仓库中的依赖项进行安全评估，因此给出10%的投毒风险。

**利用方式：**
攻击者可以发送一个包含恶意XML Payload的请求，该Payload包含一个指向外部实体的声明。当Ktor应用解析该XML时，会尝试加载外部实体，从而导致：
*   **任意文件读取：** 攻击者可以读取服务器上的任意文件，例如配置文件、密钥等。
*   **服务端请求伪造（SSRF）：** 攻击者可以利用服务器作为跳板，向内部网络或外部网络发起请求。
*   **拒绝服务攻击（DoS）：** 通过引用一个无限循环的外部实体，导致服务器资源耗尽。

**项目地址:** [bbugdigger/ktor-xxe-poc](https://github.com/bbugdigger/ktor-xxe-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #3

**来源**: [CVE-2023-45612-clemfavre_cve-2023-45612_exploit.md](../2023/CVE-2023-45612-clemfavre_cve-2023-45612_exploit.md)

# CVE-2023-45612

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45612-aecelen_ktor-xxe-poc.md](../2023/CVE-2023-45612-aecelen_ktor-xxe-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用程序启用ContentNegotiation并使用XML格式，目标服务器可以访问外部资源

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45612是JetBrains Ktor 2.3.5之前的版本中存在的一个XXE（XML外部实体注入）漏洞。当Ktor应用程序使用ContentNegotiation feature处理XML格式数据时，如果默认配置未进行安全加固，攻击者可以通过在XML payload中插入恶意实体引用来读取服务器上的任意文件或进行服务器端请求伪造（SSRF）。

**有效性：**

根据提供的漏洞库信息和漏洞利用代码，该漏洞的POC代码是有效的。漏洞库明确指出Ktor 2.3.5之前的版本存在XXE漏洞，并给出了受影响的版本范围。POC代码提供了重现该漏洞所需的必要组件，包括一个基于Ktor的简单服务器和一个用于发送恶意XML payload的Python脚本。

**投毒风险：**

查看POC代码，包括`README.md`, `build.gradle.kts`, `gradle.properties`, `gradlew`和`test.py`，没有发现任何恶意代码或后门。所有代码都用于设置Ktor服务器并利用XXE漏洞。虽然不能完全排除所有可能性，但根据目前的信息，投毒风险较低，可以认为是0%。`gradlew`只是一个gradle的wrapper脚本，用于在没有全局安装gradle的情况下运行gradle命令。

**利用方式：**

1.  **配置易受攻击的Ktor应用:** 确保目标Ktor应用的版本低于2.3.5，并启用了ContentNegotiation feature，且支持XML格式的处理。
2.  **构造恶意XML Payload:** 攻击者需要构造一个包含外部实体声明的XML payload。例如，payload可能包含一个指向服务器本地文件的实体引用，或者一个指向外部服务器的URL。
3.  **发送Payload到服务器:** 攻击者将构造好的XML payload通过HTTP请求发送到Ktor服务器的某个接受XML数据的端点。
4.  **利用XXE读取文件/SSRF:**  服务器解析XML时，会尝试解析外部实体。如果外部实体指向本地文件，则服务器会将文件内容返回给攻击者（文件读取）。如果外部实体指向外部URL，则服务器会向该URL发起请求（SSRF）。

**漏洞缓解措施：**

*   升级Ktor版本到2.3.5或更高版本。
*   禁用或严格配置XML解析器的外部实体解析功能。在Ktor中，可以通过配置`XML`序列化器来禁用外部实体解析。

**项目地址:** [aecelen/ktor-xxe-poc](https://github.com/aecelen/ktor-xxe-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #2

**来源**: [CVE-2023-45612-bbugdigger_ktor-xxe-poc.md](../2023/CVE-2023-45612-bbugdigger_ktor-xxe-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 目标应用启用了XML ContentNegotiation且使用默认配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612是JetBrains Ktor框架在2.3.5版本之前的XML处理中存在的一个XXE漏洞。默认情况下，ContentNegotiation在使用XML格式时存在安全隐患，允许攻击者通过构造恶意的XML请求来读取服务器上的任意文件或执行其他恶意操作。

**有效性分析：**
根据提供的POC代码，该漏洞的利用步骤如下：
1.  克隆包含漏洞利用代码的`ktor-xxe-poc`仓库。
2.  使用Gradle构建并运行Ktor应用程序（该应用程序模拟了存在漏洞的服务）。
3.  在另一个终端中使用Python脚本`xxe_poc.py`发送包含恶意XML Payload的请求。

通过执行这些步骤，可以验证目标服务是否存在XXE漏洞。

**投毒风险分析：**
代码仓库中可能存在投毒风险，例如在`build.gradle.kts`中引入恶意的依赖，或者在`xxe_poc.py`脚本中执行恶意操作。以下是评估结果：
*   **build.gradle.kts:** 检查依赖项，libs.xmlutil.core、libs.xmlutil.serialization可能存在被替换成恶意依赖的风险，例如，指向一个包含恶意代码的Maven仓库。虽然检查这些依赖库的安全性可以降低风险，但并不能完全排除。
*   **xxe_poc.py:** 此脚本是POC验证脚本，用于发送恶意XML，主要用于读取文件，进行SSRF等操作，但可能存在后门，例如执行系统命令，连接恶意服务器等。需要仔细审查该脚本。
*   **gradlew:** 主要用于构建， 脚本本身没有明显的投毒特征。

由于不清楚`xxe_poc.py`的具体内容，以及无法对远程maven仓库中的依赖项进行安全评估，因此给出10%的投毒风险。

**利用方式：**
攻击者可以发送一个包含恶意XML Payload的请求，该Payload包含一个指向外部实体的声明。当Ktor应用解析该XML时，会尝试加载外部实体，从而导致：
*   **任意文件读取：** 攻击者可以读取服务器上的任意文件，例如配置文件、密钥等。
*   **服务端请求伪造（SSRF）：** 攻击者可以利用服务器作为跳板，向内部网络或外部网络发起请求。
*   **拒绝服务攻击（DoS）：** 通过引用一个无限循环的外部实体，导致服务器资源耗尽。

**项目地址:** [bbugdigger/ktor-xxe-poc](https://github.com/bbugdigger/ktor-xxe-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #3

**来源**: [CVE-2023-45612-clemfavre_cve-2023-45612_exploit.md](../2023/CVE-2023-45612-clemfavre_cve-2023-45612_exploit.md)

# CVE-2023-45612

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45612-aecelen_ktor-xxe-poc.md](../2023/CVE-2023-45612-aecelen_ktor-xxe-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用程序启用ContentNegotiation并使用XML格式，目标服务器可以访问外部资源

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45612是JetBrains Ktor 2.3.5之前的版本中存在的一个XXE（XML外部实体注入）漏洞。当Ktor应用程序使用ContentNegotiation feature处理XML格式数据时，如果默认配置未进行安全加固，攻击者可以通过在XML payload中插入恶意实体引用来读取服务器上的任意文件或进行服务器端请求伪造（SSRF）。

**有效性：**

根据提供的漏洞库信息和漏洞利用代码，该漏洞的POC代码是有效的。漏洞库明确指出Ktor 2.3.5之前的版本存在XXE漏洞，并给出了受影响的版本范围。POC代码提供了重现该漏洞所需的必要组件，包括一个基于Ktor的简单服务器和一个用于发送恶意XML payload的Python脚本。

**投毒风险：**

查看POC代码，包括`README.md`, `build.gradle.kts`, `gradle.properties`, `gradlew`和`test.py`，没有发现任何恶意代码或后门。所有代码都用于设置Ktor服务器并利用XXE漏洞。虽然不能完全排除所有可能性，但根据目前的信息，投毒风险较低，可以认为是0%。`gradlew`只是一个gradle的wrapper脚本，用于在没有全局安装gradle的情况下运行gradle命令。

**利用方式：**

1.  **配置易受攻击的Ktor应用:** 确保目标Ktor应用的版本低于2.3.5，并启用了ContentNegotiation feature，且支持XML格式的处理。
2.  **构造恶意XML Payload:** 攻击者需要构造一个包含外部实体声明的XML payload。例如，payload可能包含一个指向服务器本地文件的实体引用，或者一个指向外部服务器的URL。
3.  **发送Payload到服务器:** 攻击者将构造好的XML payload通过HTTP请求发送到Ktor服务器的某个接受XML数据的端点。
4.  **利用XXE读取文件/SSRF:**  服务器解析XML时，会尝试解析外部实体。如果外部实体指向本地文件，则服务器会将文件内容返回给攻击者（文件读取）。如果外部实体指向外部URL，则服务器会向该URL发起请求（SSRF）。

**漏洞缓解措施：**

*   升级Ktor版本到2.3.5或更高版本。
*   禁用或严格配置XML解析器的外部实体解析功能。在Ktor中，可以通过配置`XML`序列化器来禁用外部实体解析。

**项目地址:** [aecelen/ktor-xxe-poc](https://github.com/aecelen/ktor-xxe-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #2

**来源**: [CVE-2023-45612-bbugdigger_ktor-xxe-poc.md](../2023/CVE-2023-45612-bbugdigger_ktor-xxe-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 目标应用启用了XML ContentNegotiation且使用默认配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612是JetBrains Ktor框架在2.3.5版本之前的XML处理中存在的一个XXE漏洞。默认情况下，ContentNegotiation在使用XML格式时存在安全隐患，允许攻击者通过构造恶意的XML请求来读取服务器上的任意文件或执行其他恶意操作。

**有效性分析：**
根据提供的POC代码，该漏洞的利用步骤如下：
1.  克隆包含漏洞利用代码的`ktor-xxe-poc`仓库。
2.  使用Gradle构建并运行Ktor应用程序（该应用程序模拟了存在漏洞的服务）。
3.  在另一个终端中使用Python脚本`xxe_poc.py`发送包含恶意XML Payload的请求。

通过执行这些步骤，可以验证目标服务是否存在XXE漏洞。

**投毒风险分析：**
代码仓库中可能存在投毒风险，例如在`build.gradle.kts`中引入恶意的依赖，或者在`xxe_poc.py`脚本中执行恶意操作。以下是评估结果：
*   **build.gradle.kts:** 检查依赖项，libs.xmlutil.core、libs.xmlutil.serialization可能存在被替换成恶意依赖的风险，例如，指向一个包含恶意代码的Maven仓库。虽然检查这些依赖库的安全性可以降低风险，但并不能完全排除。
*   **xxe_poc.py:** 此脚本是POC验证脚本，用于发送恶意XML，主要用于读取文件，进行SSRF等操作，但可能存在后门，例如执行系统命令，连接恶意服务器等。需要仔细审查该脚本。
*   **gradlew:** 主要用于构建， 脚本本身没有明显的投毒特征。

由于不清楚`xxe_poc.py`的具体内容，以及无法对远程maven仓库中的依赖项进行安全评估，因此给出10%的投毒风险。

**利用方式：**
攻击者可以发送一个包含恶意XML Payload的请求，该Payload包含一个指向外部实体的声明。当Ktor应用解析该XML时，会尝试加载外部实体，从而导致：
*   **任意文件读取：** 攻击者可以读取服务器上的任意文件，例如配置文件、密钥等。
*   **服务端请求伪造（SSRF）：** 攻击者可以利用服务器作为跳板，向内部网络或外部网络发起请求。
*   **拒绝服务攻击（DoS）：** 通过引用一个无限循环的外部实体，导致服务器资源耗尽。

**项目地址:** [bbugdigger/ktor-xxe-poc](https://github.com/bbugdigger/ktor-xxe-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #3

**来源**: [CVE-2023-45612-clemfavre_cve-2023-45612_exploit.md](../2023/CVE-2023-45612-clemfavre_cve-2023-45612_exploit.md)

# CVE-2023-45612

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45612-aecelen_ktor-xxe-poc.md](../2023/CVE-2023-45612-aecelen_ktor-xxe-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用程序启用ContentNegotiation并使用XML格式，目标服务器可以访问外部资源

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45612是JetBrains Ktor 2.3.5之前的版本中存在的一个XXE（XML外部实体注入）漏洞。当Ktor应用程序使用ContentNegotiation feature处理XML格式数据时，如果默认配置未进行安全加固，攻击者可以通过在XML payload中插入恶意实体引用来读取服务器上的任意文件或进行服务器端请求伪造（SSRF）。

**有效性：**

根据提供的漏洞库信息和漏洞利用代码，该漏洞的POC代码是有效的。漏洞库明确指出Ktor 2.3.5之前的版本存在XXE漏洞，并给出了受影响的版本范围。POC代码提供了重现该漏洞所需的必要组件，包括一个基于Ktor的简单服务器和一个用于发送恶意XML payload的Python脚本。

**投毒风险：**

查看POC代码，包括`README.md`, `build.gradle.kts`, `gradle.properties`, `gradlew`和`test.py`，没有发现任何恶意代码或后门。所有代码都用于设置Ktor服务器并利用XXE漏洞。虽然不能完全排除所有可能性，但根据目前的信息，投毒风险较低，可以认为是0%。`gradlew`只是一个gradle的wrapper脚本，用于在没有全局安装gradle的情况下运行gradle命令。

**利用方式：**

1.  **配置易受攻击的Ktor应用:** 确保目标Ktor应用的版本低于2.3.5，并启用了ContentNegotiation feature，且支持XML格式的处理。
2.  **构造恶意XML Payload:** 攻击者需要构造一个包含外部实体声明的XML payload。例如，payload可能包含一个指向服务器本地文件的实体引用，或者一个指向外部服务器的URL。
3.  **发送Payload到服务器:** 攻击者将构造好的XML payload通过HTTP请求发送到Ktor服务器的某个接受XML数据的端点。
4.  **利用XXE读取文件/SSRF:**  服务器解析XML时，会尝试解析外部实体。如果外部实体指向本地文件，则服务器会将文件内容返回给攻击者（文件读取）。如果外部实体指向外部URL，则服务器会向该URL发起请求（SSRF）。

**漏洞缓解措施：**

*   升级Ktor版本到2.3.5或更高版本。
*   禁用或严格配置XML解析器的外部实体解析功能。在Ktor中，可以通过配置`XML`序列化器来禁用外部实体解析。

**项目地址:** [aecelen/ktor-xxe-poc](https://github.com/aecelen/ktor-xxe-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #2

**来源**: [CVE-2023-45612-bbugdigger_ktor-xxe-poc.md](../2023/CVE-2023-45612-bbugdigger_ktor-xxe-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 目标应用启用了XML ContentNegotiation且使用默认配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612是JetBrains Ktor框架在2.3.5版本之前的XML处理中存在的一个XXE漏洞。默认情况下，ContentNegotiation在使用XML格式时存在安全隐患，允许攻击者通过构造恶意的XML请求来读取服务器上的任意文件或执行其他恶意操作。

**有效性分析：**
根据提供的POC代码，该漏洞的利用步骤如下：
1.  克隆包含漏洞利用代码的`ktor-xxe-poc`仓库。
2.  使用Gradle构建并运行Ktor应用程序（该应用程序模拟了存在漏洞的服务）。
3.  在另一个终端中使用Python脚本`xxe_poc.py`发送包含恶意XML Payload的请求。

通过执行这些步骤，可以验证目标服务是否存在XXE漏洞。

**投毒风险分析：**
代码仓库中可能存在投毒风险，例如在`build.gradle.kts`中引入恶意的依赖，或者在`xxe_poc.py`脚本中执行恶意操作。以下是评估结果：
*   **build.gradle.kts:** 检查依赖项，libs.xmlutil.core、libs.xmlutil.serialization可能存在被替换成恶意依赖的风险，例如，指向一个包含恶意代码的Maven仓库。虽然检查这些依赖库的安全性可以降低风险，但并不能完全排除。
*   **xxe_poc.py:** 此脚本是POC验证脚本，用于发送恶意XML，主要用于读取文件，进行SSRF等操作，但可能存在后门，例如执行系统命令，连接恶意服务器等。需要仔细审查该脚本。
*   **gradlew:** 主要用于构建， 脚本本身没有明显的投毒特征。

由于不清楚`xxe_poc.py`的具体内容，以及无法对远程maven仓库中的依赖项进行安全评估，因此给出10%的投毒风险。

**利用方式：**
攻击者可以发送一个包含恶意XML Payload的请求，该Payload包含一个指向外部实体的声明。当Ktor应用解析该XML时，会尝试加载外部实体，从而导致：
*   **任意文件读取：** 攻击者可以读取服务器上的任意文件，例如配置文件、密钥等。
*   **服务端请求伪造（SSRF）：** 攻击者可以利用服务器作为跳板，向内部网络或外部网络发起请求。
*   **拒绝服务攻击（DoS）：** 通过引用一个无限循环的外部实体，导致服务器资源耗尽。

**项目地址:** [bbugdigger/ktor-xxe-poc](https://github.com/bbugdigger/ktor-xxe-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #3

**来源**: [CVE-2023-45612-clemfavre_cve-2023-45612_exploit.md](../2023/CVE-2023-45612-clemfavre_cve-2023-45612_exploit.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要目标服务器开启了Ktor的XML反序列化功能且版本低于2.3.5，攻击者能够向服务器发送恶意XML数据。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-45612是JetBrains Ktor 2.3.5之前版本中ContentNegotiation的XML格式默认配置存在XXE漏洞。攻击者可以通过发送包含外部实体引用的恶意XML文件，读取服务器上的任意文件。

**有效性:** 提供的PoC代码是有效的。它演示了如何通过构造包含`<!DOCTYPE>`声明的XML文件来利用XXE漏洞。该文件定义了一个外部实体，该实体指向服务器上的敏感文件（例如，`sensitive_infos.txt`），然后该实体在XML文档的`name`字段中被引用。当服务器解析此XML时，它将解析外部实体，从而导致服务器读取并返回敏感文件的内容。

**投毒风险:**  

*   **低风险:** PoC代码主要由示例代码和说明组成，用于重现XXE漏洞。虽然`build.gradle.kts`文件指定了Ktor依赖项的版本，但它也清楚地表明了哪个版本是易受攻击的，哪个版本是已修复的。 `sensitive_infos.txt` 文件是演示用途，本身不具备危害性。
*   **潜在的风险:**  `gradlew`脚本是自动构建工具Gradle的包装器脚本，理论上存在被篡改的风险，但代码比较简单，被植入恶意代码的可能性较低。在检查了提供的文件后，评估投毒风险为5%。

**利用方式:**

1.  **构建恶意XML:** 攻击者构造一个恶意的XML文件，其中包含一个`<!DOCTYPE>`声明，用于定义一个外部实体。该实体指向攻击者想要读取的服务器上的文件。例如:`<!ENTITY exploit SYSTEM "file:///etc/passwd">`
2.  **发送恶意XML:** 攻击者通过HTTP POST请求或其他支持的方式，将恶意XML文件发送到目标服务器的Ktor应用程序。
3.  **触发XXE:** 当Ktor应用程序使用默认配置的XML反序列化功能解析XML文件时，它会尝试解析外部实体。由于外部实体指向服务器上的文件，因此服务器会读取该文件的内容。
4.  **获取敏感信息:** 服务器将读取的文件内容返回给攻击者。攻击者可以利用此漏洞读取服务器上的任何文件，例如配置文件、数据库连接字符串或私钥。

**缓解措施:**

*   升级到Ktor 2.3.5或更高版本。
*   禁用XML外部实体解析。 
*   对XML输入进行严格的验证和过滤。

**项目地址:** [clemfavre/cve-2023-45612_exploit](https://github.com/clemfavre/cve-2023-45612_exploit)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #4

**来源**: [CVE-2023-45612-infernosalex_CVE-2023-45612-PoC.md](../2023/CVE-2023-45612-infernosalex_CVE-2023-45612-PoC.md)

## CVE-2023-45612 - JetBrains Ktor XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** JetBrains Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 目标应用使用了Ktor且启用了ContentNegotiation处理XML，未进行安全配置

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45612 漏洞是JetBrains Ktor在处理XML内容时，由于ContentNegotiation的默认配置存在缺陷，导致可能发生XML外部实体注入(XXE)攻击。攻击者可以构造恶意的XML文档，通过外部实体引用读取服务器上的敏感文件。 

**有效性：**

根据漏洞描述和提供的PoC代码，可以判断该PoC代码是有效的。PoC代码通过构造包含外部实体引用的XML文档，并将其发送到目标Ktor应用的XML处理接口，从而尝试读取指定的文件。如果Ktor应用存在漏洞，则会返回被读取的文件内容。

**投毒风险：**

分析提供的PoC代码，代码本身的功能是利用XXE漏洞读取文件，未发现任何明显的恶意代码或后门。代码主要功能是构造XML payload, 发起HTTP请求，并输出响应结果。可以认为投毒风险很低。

**利用方式：**

1.  **确定目标应用使用了Ktor，并且存在处理XML数据的接口。**  可以通过分析目标应用的请求和响应，或者查看应用的依赖库来判断。
2.  **构造恶意的XML文档。**  XML文档中需要包含DOCTYPE声明，定义外部实体，并引用该实体。
3.  **将构造的XML文档发送到目标应用的XML处理接口。**  可以使用HTTP POST请求，将XML文档作为请求体发送。
4.  **分析响应结果。**  如果目标应用存在漏洞，则响应结果中会包含被读取的文件内容。

**搜索引擎结果分析：**

搜索结果证实了漏洞的存在，并提供了漏洞的详细信息，包括漏洞描述、影响范围和修复建议。


**项目地址:** [infernosalex/CVE-2023-45612-PoC](https://github.com/infernosalex/CVE-2023-45612-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #5

**来源**: [CVE-2023-45612-ksaweryr_CVE-2023-45612-PoC.md](../2023/CVE-2023-45612-ksaweryr_CVE-2023-45612-PoC.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用使用ContentNegotiation且配置XML格式

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612是JetBrains Ktor 2.3.5之前版本中存在的一个XML外部实体注入（XXE）漏洞。该漏洞存在于ContentNegotiation中XML格式的默认配置中。攻击者可以通过发送包含恶意XML payload的请求，读取服务器上的敏感文件。 

**有效性评估:**
提供的PoC代码包含Dockerfile，docker-compose.yaml，以及server和client目录，基本可以判断 PoC 的有效性较高。docker-compose.yaml 编排了 server 和 client 两个服务，server 服务构建一个存在漏洞的 Ktor 应用，client 服务则用于执行 XXE 攻击。Dockerfile 里创建了 /lfi_poc.txt 文件，用于验证 LFI 是否成功，同时安装了 `nc` 工具，用于 healthcheck。PoC 的 README.md 描述了复现步骤。

**投毒风险分析:**
虽然PoC的主要功能是演示XXE漏洞，但仍存在一定投毒风险。例如，`client` 或 `server` 的 `Dockerfile` 可能包含恶意指令，例如在构建过程中下载并执行恶意脚本。此外，`client` 脚本本身也可能尝试执行除LFI之外的恶意操作。该风险评估较低，约为10%，因为主要目的是复现漏洞，但不能完全排除。

**漏洞利用方式:**
1.  目标Ktor应用使用ContentNegotiation并且配置XML格式。
2.  攻击者构造包含恶意XML实体的请求，其中XML实体指向服务器本地文件。
3.  Ktor应用解析XML时，会尝试解析外部实体，从而导致服务器读取并返回攻击者指定的文件内容。
4.  通过docker-compose可以快速搭建漏洞环境，便于漏洞复现与验证

**项目地址:** [ksaweryr/CVE-2023-45612-PoC](https://github.com/ksaweryr/CVE-2023-45612-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #6

**来源**: [CVE-2023-45612-razvanclaudiu_Ktor-XXE-PoC.md](../2023/CVE-2023-45612-razvanclaudiu_Ktor-XXE-PoC.md)

## CVE-2023-45612-JetBrains Ktor XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** JetBrains Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用启用了ContentNegotiation插件并使用默认的xml()序列化器，且目标服务器存在可读取的文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-45612是JetBrains Ktor框架中存在的一个XML外部实体注入（XXE）漏洞。该漏洞影响Ktor 2.3.5之前的版本，当ContentNegotiation插件与默认的xml()序列化器一起使用时，默认XML解析器未配置为阻止外部实体的解析，导致攻击者可以读取服务器上的任意文件。

**有效性评估：**
提供的POC代码有效。README.md文件详细描述了漏洞原理、复现步骤和利用方法，并提供了可执行的示例代码和curl命令。

**投毒风险评估：**
仓库中存在作者隐藏的投毒代码的可能性较低。虽然存在一些潜在风险，例如Gradle脚本中的依赖项可能指向恶意仓库或包含恶意代码，但从提供的代码片段来看，没有明显的恶意行为。gradle.kts定义了kotlin和ktor的依赖，其中风险较高的是版本控制，但是指定版本也是为了复现漏洞，可以判定风险较低。因此，投毒风险评估为5%。

**利用方式：**
1.  攻击者向启用了ContentNegotiation插件的Ktor服务器的某个接收XML数据的端点发送包含恶意XML的请求。
2.  恶意XML中定义了外部实体，指向服务器上的敏感文件，例如/etc/passwd或应用程序的配置文件。
3.  Ktor服务器使用存在漏洞的XML解析器解析XML数据，并解析外部实体，导致服务器读取指定文件内容。
4.  服务器将读取到的文件内容返回给攻击者，造成敏感信息泄露。

**项目地址:** [razvanclaudiu/Ktor-XXE-PoC](https://github.com/razvanclaudiu/Ktor-XXE-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #7

**来源**: [CVE-2023-45612-seraphimi_ktor-xxe.md](../2023/CVE-2023-45612-seraphimi_ktor-xxe.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致信息泄露、SSRF

**影响版本:** < 2.3.5

**利用条件:** 目标Ktor应用启用了ContentNegotiation并且使用XML格式，且未进行安全配置

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-45612是JetBrains Ktor框架中存在的一个XXE漏洞。当Ktor应用使用XML进行内容协商时，如果未正确配置XML解析器，攻击者可以通过发送包含恶意XML Payload的请求来利用此漏洞。

**有效性：**
提供的POC代码看起来是有效的。它包含了一个Ktor服务端示例，以及一个Python脚本 `poc.py`，该脚本用于发送包含XXE Payload的请求。POC提供了两种利用方式：
*   **文件泄露：** 攻击者可以读取服务器上的任意文件（例如，`/etc/hostname`、`/etc/passwd`）。
*   **SSRF：** 攻击者可以利用服务器发起任意的网络请求。

**投毒风险：**
对提供的代码仓库进行分析，发现投毒风险较低。关键点如下：
*   `build.gradle.kts` 文件指定了依赖，版本都是已知的。
*   `README.md` 描述了如何运行和使用POC。
*   `poc.py`  （虽然没有提供），根据README描述可以推断是用于发送恶意XML，没有明显的后门代码。
*   脚本目的是演示漏洞利用，而非植入恶意代码。
因此，仓库存在恶意投毒代码的概率较低，估计在1%左右。

**利用方式：**
1.  **目标应用环境：** 目标Ktor应用必须启用了ContentNegotiation并且使用XML格式，且使用的Ktor版本低于2.3.5。
2.  **恶意XML Payload：** 攻击者构造包含恶意XML实体定义的Payload。例如，Payload可能包含对本地文件的引用或者外部URL的引用。
3.  **发送请求：** 攻击者将包含恶意Payload的XML数据发送到目标Ktor应用的某个端点。
4.  **漏洞触发：** Ktor应用在解析XML数据时，会解析Payload中的恶意实体，从而导致XXE漏洞的触发。
5.  **利用结果：** 攻击者可以利用XXE漏洞读取服务器上的文件、发起SSRF攻击，或者执行其他恶意操作。

**项目地址:** [seraphimi/ktor-xxe](https://github.com/seraphimi/ktor-xxe)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #8

**来源**: [CVE-2023-45612-stefan-500_ktor-cve-2023-45612-poc.md](../2023/CVE-2023-45612-stefan-500_ktor-cve-2023-45612-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 服务器端使用Ktor并且ContentNegotiation配置了XML格式，且使用受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612 是一个存在于 JetBrains Ktor 2.3.5 之前的版本中的 XXE (XML 外部实体) 漏洞。当 Ktor 使用 ContentNegotiation 中 XML 格式的默认配置时，未经授权的攻击者可以通过构造恶意的 XML 输入，读取服务器上的本地文件或访问内部网络资源。 

**漏洞利用分析：**

提供的漏洞利用代码包含一个用于复现该漏洞的 Ktor 应用程序。相关文件包括：

*   `README.md`: 包含漏洞描述、参考链接和 PoC 的基本信息。
*   `build.gradle.kts`: Gradle 构建脚本，定义了项目依赖项，包括 Ktor 2.3.4 和 XML 序列化。
*   `gradle.properties`: Gradle 属性文件。
*   `gradlew`: Gradle 包装器脚本，用于构建和运行应用程序。

关键在于 `build.gradle.kts` 文件中指定了 `io.ktor:ktor-serialization-kotlinx-xml:2.3.4` 和 `io.ktor:ktor-server-content-negotiation:2.3.4`，这使得应用程序容易受到攻击。通过发送包含外部实体定义的恶意 XML 请求，攻击者可以利用 XXE 漏洞。

**投毒风险分析：**

尽管提供的代码旨在演示 XXE 漏洞，但仍存在潜在的投毒风险。尽管代码目的不是恶意行为，但也需要防范以下几点：

*   **供应链风险:**  如果直接使用此仓库的代码，需要确保没有其他恶意代码被添加到项目中的依赖项中。
*   **构建过程:**  需要审核 `build.gradle.kts` 文件，确保没有添加任何可疑的任务或插件。

虽然仓库中直接嵌入恶意代码的可能性较低（估计 10%），但仍然需要谨慎处理，建议手动审查所有代码。

**利用方式总结：**

1.  目标系统使用 Ktor 并且启用了 XML 的 ContentNegotiation，版本低于 2.3.5。
2.  攻击者构造包含恶意外部实体定义的 XML 请求。
3.  服务器解析 XML 请求时，会尝试解析外部实体。
4.  如果未正确配置 XML 解析器以禁用外部实体解析，则服务器会读取本地文件或访问内部网络资源，并将内容返回给攻击者。

**项目地址:** [stefan-500/ktor-cve-2023-45612-poc](https://github.com/stefan-500/ktor-cve-2023-45612-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---



---

## POC #4

**来源**: [CVE-2023-45612-infernosalex_CVE-2023-45612-PoC.md](../2023/CVE-2023-45612-infernosalex_CVE-2023-45612-PoC.md)

## CVE-2023-45612 - JetBrains Ktor XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** JetBrains Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 目标应用使用了Ktor且启用了ContentNegotiation处理XML，未进行安全配置

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45612 漏洞是JetBrains Ktor在处理XML内容时，由于ContentNegotiation的默认配置存在缺陷，导致可能发生XML外部实体注入(XXE)攻击。攻击者可以构造恶意的XML文档，通过外部实体引用读取服务器上的敏感文件。 

**有效性：**

根据漏洞描述和提供的PoC代码，可以判断该PoC代码是有效的。PoC代码通过构造包含外部实体引用的XML文档，并将其发送到目标Ktor应用的XML处理接口，从而尝试读取指定的文件。如果Ktor应用存在漏洞，则会返回被读取的文件内容。

**投毒风险：**

分析提供的PoC代码，代码本身的功能是利用XXE漏洞读取文件，未发现任何明显的恶意代码或后门。代码主要功能是构造XML payload, 发起HTTP请求，并输出响应结果。可以认为投毒风险很低。

**利用方式：**

1.  **确定目标应用使用了Ktor，并且存在处理XML数据的接口。**  可以通过分析目标应用的请求和响应，或者查看应用的依赖库来判断。
2.  **构造恶意的XML文档。**  XML文档中需要包含DOCTYPE声明，定义外部实体，并引用该实体。
3.  **将构造的XML文档发送到目标应用的XML处理接口。**  可以使用HTTP POST请求，将XML文档作为请求体发送。
4.  **分析响应结果。**  如果目标应用存在漏洞，则响应结果中会包含被读取的文件内容。

**搜索引擎结果分析：**

搜索结果证实了漏洞的存在，并提供了漏洞的详细信息，包括漏洞描述、影响范围和修复建议。


**项目地址:** [infernosalex/CVE-2023-45612-PoC](https://github.com/infernosalex/CVE-2023-45612-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #5

**来源**: [CVE-2023-45612-ksaweryr_CVE-2023-45612-PoC.md](../2023/CVE-2023-45612-ksaweryr_CVE-2023-45612-PoC.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用使用ContentNegotiation且配置XML格式

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612是JetBrains Ktor 2.3.5之前版本中存在的一个XML外部实体注入（XXE）漏洞。该漏洞存在于ContentNegotiation中XML格式的默认配置中。攻击者可以通过发送包含恶意XML payload的请求，读取服务器上的敏感文件。 

**有效性评估:**
提供的PoC代码包含Dockerfile，docker-compose.yaml，以及server和client目录，基本可以判断 PoC 的有效性较高。docker-compose.yaml 编排了 server 和 client 两个服务，server 服务构建一个存在漏洞的 Ktor 应用，client 服务则用于执行 XXE 攻击。Dockerfile 里创建了 /lfi_poc.txt 文件，用于验证 LFI 是否成功，同时安装了 `nc` 工具，用于 healthcheck。PoC 的 README.md 描述了复现步骤。

**投毒风险分析:**
虽然PoC的主要功能是演示XXE漏洞，但仍存在一定投毒风险。例如，`client` 或 `server` 的 `Dockerfile` 可能包含恶意指令，例如在构建过程中下载并执行恶意脚本。此外，`client` 脚本本身也可能尝试执行除LFI之外的恶意操作。该风险评估较低，约为10%，因为主要目的是复现漏洞，但不能完全排除。

**漏洞利用方式:**
1.  目标Ktor应用使用ContentNegotiation并且配置XML格式。
2.  攻击者构造包含恶意XML实体的请求，其中XML实体指向服务器本地文件。
3.  Ktor应用解析XML时，会尝试解析外部实体，从而导致服务器读取并返回攻击者指定的文件内容。
4.  通过docker-compose可以快速搭建漏洞环境，便于漏洞复现与验证

**项目地址:** [ksaweryr/CVE-2023-45612-PoC](https://github.com/ksaweryr/CVE-2023-45612-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #6

**来源**: [CVE-2023-45612-razvanclaudiu_Ktor-XXE-PoC.md](../2023/CVE-2023-45612-razvanclaudiu_Ktor-XXE-PoC.md)

## CVE-2023-45612-JetBrains Ktor XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** JetBrains Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用启用了ContentNegotiation插件并使用默认的xml()序列化器，且目标服务器存在可读取的文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-45612是JetBrains Ktor框架中存在的一个XML外部实体注入（XXE）漏洞。该漏洞影响Ktor 2.3.5之前的版本，当ContentNegotiation插件与默认的xml()序列化器一起使用时，默认XML解析器未配置为阻止外部实体的解析，导致攻击者可以读取服务器上的任意文件。

**有效性评估：**
提供的POC代码有效。README.md文件详细描述了漏洞原理、复现步骤和利用方法，并提供了可执行的示例代码和curl命令。

**投毒风险评估：**
仓库中存在作者隐藏的投毒代码的可能性较低。虽然存在一些潜在风险，例如Gradle脚本中的依赖项可能指向恶意仓库或包含恶意代码，但从提供的代码片段来看，没有明显的恶意行为。gradle.kts定义了kotlin和ktor的依赖，其中风险较高的是版本控制，但是指定版本也是为了复现漏洞，可以判定风险较低。因此，投毒风险评估为5%。

**利用方式：**
1.  攻击者向启用了ContentNegotiation插件的Ktor服务器的某个接收XML数据的端点发送包含恶意XML的请求。
2.  恶意XML中定义了外部实体，指向服务器上的敏感文件，例如/etc/passwd或应用程序的配置文件。
3.  Ktor服务器使用存在漏洞的XML解析器解析XML数据，并解析外部实体，导致服务器读取指定文件内容。
4.  服务器将读取到的文件内容返回给攻击者，造成敏感信息泄露。

**项目地址:** [razvanclaudiu/Ktor-XXE-PoC](https://github.com/razvanclaudiu/Ktor-XXE-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #7

**来源**: [CVE-2023-45612-seraphimi_ktor-xxe.md](../2023/CVE-2023-45612-seraphimi_ktor-xxe.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致信息泄露、SSRF

**影响版本:** < 2.3.5

**利用条件:** 目标Ktor应用启用了ContentNegotiation并且使用XML格式，且未进行安全配置

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-45612是JetBrains Ktor框架中存在的一个XXE漏洞。当Ktor应用使用XML进行内容协商时，如果未正确配置XML解析器，攻击者可以通过发送包含恶意XML Payload的请求来利用此漏洞。

**有效性：**
提供的POC代码看起来是有效的。它包含了一个Ktor服务端示例，以及一个Python脚本 `poc.py`，该脚本用于发送包含XXE Payload的请求。POC提供了两种利用方式：
*   **文件泄露：** 攻击者可以读取服务器上的任意文件（例如，`/etc/hostname`、`/etc/passwd`）。
*   **SSRF：** 攻击者可以利用服务器发起任意的网络请求。

**投毒风险：**
对提供的代码仓库进行分析，发现投毒风险较低。关键点如下：
*   `build.gradle.kts` 文件指定了依赖，版本都是已知的。
*   `README.md` 描述了如何运行和使用POC。
*   `poc.py`  （虽然没有提供），根据README描述可以推断是用于发送恶意XML，没有明显的后门代码。
*   脚本目的是演示漏洞利用，而非植入恶意代码。
因此，仓库存在恶意投毒代码的概率较低，估计在1%左右。

**利用方式：**
1.  **目标应用环境：** 目标Ktor应用必须启用了ContentNegotiation并且使用XML格式，且使用的Ktor版本低于2.3.5。
2.  **恶意XML Payload：** 攻击者构造包含恶意XML实体定义的Payload。例如，Payload可能包含对本地文件的引用或者外部URL的引用。
3.  **发送请求：** 攻击者将包含恶意Payload的XML数据发送到目标Ktor应用的某个端点。
4.  **漏洞触发：** Ktor应用在解析XML数据时，会解析Payload中的恶意实体，从而导致XXE漏洞的触发。
5.  **利用结果：** 攻击者可以利用XXE漏洞读取服务器上的文件、发起SSRF攻击，或者执行其他恶意操作。

**项目地址:** [seraphimi/ktor-xxe](https://github.com/seraphimi/ktor-xxe)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #8

**来源**: [CVE-2023-45612-stefan-500_ktor-cve-2023-45612-poc.md](../2023/CVE-2023-45612-stefan-500_ktor-cve-2023-45612-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 服务器端使用Ktor并且ContentNegotiation配置了XML格式，且使用受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612 是一个存在于 JetBrains Ktor 2.3.5 之前的版本中的 XXE (XML 外部实体) 漏洞。当 Ktor 使用 ContentNegotiation 中 XML 格式的默认配置时，未经授权的攻击者可以通过构造恶意的 XML 输入，读取服务器上的本地文件或访问内部网络资源。 

**漏洞利用分析：**

提供的漏洞利用代码包含一个用于复现该漏洞的 Ktor 应用程序。相关文件包括：

*   `README.md`: 包含漏洞描述、参考链接和 PoC 的基本信息。
*   `build.gradle.kts`: Gradle 构建脚本，定义了项目依赖项，包括 Ktor 2.3.4 和 XML 序列化。
*   `gradle.properties`: Gradle 属性文件。
*   `gradlew`: Gradle 包装器脚本，用于构建和运行应用程序。

关键在于 `build.gradle.kts` 文件中指定了 `io.ktor:ktor-serialization-kotlinx-xml:2.3.4` 和 `io.ktor:ktor-server-content-negotiation:2.3.4`，这使得应用程序容易受到攻击。通过发送包含外部实体定义的恶意 XML 请求，攻击者可以利用 XXE 漏洞。

**投毒风险分析：**

尽管提供的代码旨在演示 XXE 漏洞，但仍存在潜在的投毒风险。尽管代码目的不是恶意行为，但也需要防范以下几点：

*   **供应链风险:**  如果直接使用此仓库的代码，需要确保没有其他恶意代码被添加到项目中的依赖项中。
*   **构建过程:**  需要审核 `build.gradle.kts` 文件，确保没有添加任何可疑的任务或插件。

虽然仓库中直接嵌入恶意代码的可能性较低（估计 10%），但仍然需要谨慎处理，建议手动审查所有代码。

**利用方式总结：**

1.  目标系统使用 Ktor 并且启用了 XML 的 ContentNegotiation，版本低于 2.3.5。
2.  攻击者构造包含恶意外部实体定义的 XML 请求。
3.  服务器解析 XML 请求时，会尝试解析外部实体。
4.  如果未正确配置 XML 解析器以禁用外部实体解析，则服务器会读取本地文件或访问内部网络资源，并将内容返回给攻击者。

**项目地址:** [stefan-500/ktor-cve-2023-45612-poc](https://github.com/stefan-500/ktor-cve-2023-45612-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---



---

## POC #4

**来源**: [CVE-2023-45612-infernosalex_CVE-2023-45612-PoC.md](../2023/CVE-2023-45612-infernosalex_CVE-2023-45612-PoC.md)

## CVE-2023-45612 - JetBrains Ktor XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** JetBrains Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 目标应用使用了Ktor且启用了ContentNegotiation处理XML，未进行安全配置

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45612 漏洞是JetBrains Ktor在处理XML内容时，由于ContentNegotiation的默认配置存在缺陷，导致可能发生XML外部实体注入(XXE)攻击。攻击者可以构造恶意的XML文档，通过外部实体引用读取服务器上的敏感文件。 

**有效性：**

根据漏洞描述和提供的PoC代码，可以判断该PoC代码是有效的。PoC代码通过构造包含外部实体引用的XML文档，并将其发送到目标Ktor应用的XML处理接口，从而尝试读取指定的文件。如果Ktor应用存在漏洞，则会返回被读取的文件内容。

**投毒风险：**

分析提供的PoC代码，代码本身的功能是利用XXE漏洞读取文件，未发现任何明显的恶意代码或后门。代码主要功能是构造XML payload, 发起HTTP请求，并输出响应结果。可以认为投毒风险很低。

**利用方式：**

1.  **确定目标应用使用了Ktor，并且存在处理XML数据的接口。**  可以通过分析目标应用的请求和响应，或者查看应用的依赖库来判断。
2.  **构造恶意的XML文档。**  XML文档中需要包含DOCTYPE声明，定义外部实体，并引用该实体。
3.  **将构造的XML文档发送到目标应用的XML处理接口。**  可以使用HTTP POST请求，将XML文档作为请求体发送。
4.  **分析响应结果。**  如果目标应用存在漏洞，则响应结果中会包含被读取的文件内容。

**搜索引擎结果分析：**

搜索结果证实了漏洞的存在，并提供了漏洞的详细信息，包括漏洞描述、影响范围和修复建议。


**项目地址:** [infernosalex/CVE-2023-45612-PoC](https://github.com/infernosalex/CVE-2023-45612-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #5

**来源**: [CVE-2023-45612-ksaweryr_CVE-2023-45612-PoC.md](../2023/CVE-2023-45612-ksaweryr_CVE-2023-45612-PoC.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用使用ContentNegotiation且配置XML格式

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612是JetBrains Ktor 2.3.5之前版本中存在的一个XML外部实体注入（XXE）漏洞。该漏洞存在于ContentNegotiation中XML格式的默认配置中。攻击者可以通过发送包含恶意XML payload的请求，读取服务器上的敏感文件。 

**有效性评估:**
提供的PoC代码包含Dockerfile，docker-compose.yaml，以及server和client目录，基本可以判断 PoC 的有效性较高。docker-compose.yaml 编排了 server 和 client 两个服务，server 服务构建一个存在漏洞的 Ktor 应用，client 服务则用于执行 XXE 攻击。Dockerfile 里创建了 /lfi_poc.txt 文件，用于验证 LFI 是否成功，同时安装了 `nc` 工具，用于 healthcheck。PoC 的 README.md 描述了复现步骤。

**投毒风险分析:**
虽然PoC的主要功能是演示XXE漏洞，但仍存在一定投毒风险。例如，`client` 或 `server` 的 `Dockerfile` 可能包含恶意指令，例如在构建过程中下载并执行恶意脚本。此外，`client` 脚本本身也可能尝试执行除LFI之外的恶意操作。该风险评估较低，约为10%，因为主要目的是复现漏洞，但不能完全排除。

**漏洞利用方式:**
1.  目标Ktor应用使用ContentNegotiation并且配置XML格式。
2.  攻击者构造包含恶意XML实体的请求，其中XML实体指向服务器本地文件。
3.  Ktor应用解析XML时，会尝试解析外部实体，从而导致服务器读取并返回攻击者指定的文件内容。
4.  通过docker-compose可以快速搭建漏洞环境，便于漏洞复现与验证

**项目地址:** [ksaweryr/CVE-2023-45612-PoC](https://github.com/ksaweryr/CVE-2023-45612-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #6

**来源**: [CVE-2023-45612-razvanclaudiu_Ktor-XXE-PoC.md](../2023/CVE-2023-45612-razvanclaudiu_Ktor-XXE-PoC.md)

## CVE-2023-45612-JetBrains Ktor XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** JetBrains Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用启用了ContentNegotiation插件并使用默认的xml()序列化器，且目标服务器存在可读取的文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-45612是JetBrains Ktor框架中存在的一个XML外部实体注入（XXE）漏洞。该漏洞影响Ktor 2.3.5之前的版本，当ContentNegotiation插件与默认的xml()序列化器一起使用时，默认XML解析器未配置为阻止外部实体的解析，导致攻击者可以读取服务器上的任意文件。

**有效性评估：**
提供的POC代码有效。README.md文件详细描述了漏洞原理、复现步骤和利用方法，并提供了可执行的示例代码和curl命令。

**投毒风险评估：**
仓库中存在作者隐藏的投毒代码的可能性较低。虽然存在一些潜在风险，例如Gradle脚本中的依赖项可能指向恶意仓库或包含恶意代码，但从提供的代码片段来看，没有明显的恶意行为。gradle.kts定义了kotlin和ktor的依赖，其中风险较高的是版本控制，但是指定版本也是为了复现漏洞，可以判定风险较低。因此，投毒风险评估为5%。

**利用方式：**
1.  攻击者向启用了ContentNegotiation插件的Ktor服务器的某个接收XML数据的端点发送包含恶意XML的请求。
2.  恶意XML中定义了外部实体，指向服务器上的敏感文件，例如/etc/passwd或应用程序的配置文件。
3.  Ktor服务器使用存在漏洞的XML解析器解析XML数据，并解析外部实体，导致服务器读取指定文件内容。
4.  服务器将读取到的文件内容返回给攻击者，造成敏感信息泄露。

**项目地址:** [razvanclaudiu/Ktor-XXE-PoC](https://github.com/razvanclaudiu/Ktor-XXE-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #7

**来源**: [CVE-2023-45612-seraphimi_ktor-xxe.md](../2023/CVE-2023-45612-seraphimi_ktor-xxe.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致信息泄露、SSRF

**影响版本:** < 2.3.5

**利用条件:** 目标Ktor应用启用了ContentNegotiation并且使用XML格式，且未进行安全配置

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-45612是JetBrains Ktor框架中存在的一个XXE漏洞。当Ktor应用使用XML进行内容协商时，如果未正确配置XML解析器，攻击者可以通过发送包含恶意XML Payload的请求来利用此漏洞。

**有效性：**
提供的POC代码看起来是有效的。它包含了一个Ktor服务端示例，以及一个Python脚本 `poc.py`，该脚本用于发送包含XXE Payload的请求。POC提供了两种利用方式：
*   **文件泄露：** 攻击者可以读取服务器上的任意文件（例如，`/etc/hostname`、`/etc/passwd`）。
*   **SSRF：** 攻击者可以利用服务器发起任意的网络请求。

**投毒风险：**
对提供的代码仓库进行分析，发现投毒风险较低。关键点如下：
*   `build.gradle.kts` 文件指定了依赖，版本都是已知的。
*   `README.md` 描述了如何运行和使用POC。
*   `poc.py`  （虽然没有提供），根据README描述可以推断是用于发送恶意XML，没有明显的后门代码。
*   脚本目的是演示漏洞利用，而非植入恶意代码。
因此，仓库存在恶意投毒代码的概率较低，估计在1%左右。

**利用方式：**
1.  **目标应用环境：** 目标Ktor应用必须启用了ContentNegotiation并且使用XML格式，且使用的Ktor版本低于2.3.5。
2.  **恶意XML Payload：** 攻击者构造包含恶意XML实体定义的Payload。例如，Payload可能包含对本地文件的引用或者外部URL的引用。
3.  **发送请求：** 攻击者将包含恶意Payload的XML数据发送到目标Ktor应用的某个端点。
4.  **漏洞触发：** Ktor应用在解析XML数据时，会解析Payload中的恶意实体，从而导致XXE漏洞的触发。
5.  **利用结果：** 攻击者可以利用XXE漏洞读取服务器上的文件、发起SSRF攻击，或者执行其他恶意操作。

**项目地址:** [seraphimi/ktor-xxe](https://github.com/seraphimi/ktor-xxe)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #8

**来源**: [CVE-2023-45612-stefan-500_ktor-cve-2023-45612-poc.md](../2023/CVE-2023-45612-stefan-500_ktor-cve-2023-45612-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 服务器端使用Ktor并且ContentNegotiation配置了XML格式，且使用受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612 是一个存在于 JetBrains Ktor 2.3.5 之前的版本中的 XXE (XML 外部实体) 漏洞。当 Ktor 使用 ContentNegotiation 中 XML 格式的默认配置时，未经授权的攻击者可以通过构造恶意的 XML 输入，读取服务器上的本地文件或访问内部网络资源。 

**漏洞利用分析：**

提供的漏洞利用代码包含一个用于复现该漏洞的 Ktor 应用程序。相关文件包括：

*   `README.md`: 包含漏洞描述、参考链接和 PoC 的基本信息。
*   `build.gradle.kts`: Gradle 构建脚本，定义了项目依赖项，包括 Ktor 2.3.4 和 XML 序列化。
*   `gradle.properties`: Gradle 属性文件。
*   `gradlew`: Gradle 包装器脚本，用于构建和运行应用程序。

关键在于 `build.gradle.kts` 文件中指定了 `io.ktor:ktor-serialization-kotlinx-xml:2.3.4` 和 `io.ktor:ktor-server-content-negotiation:2.3.4`，这使得应用程序容易受到攻击。通过发送包含外部实体定义的恶意 XML 请求，攻击者可以利用 XXE 漏洞。

**投毒风险分析：**

尽管提供的代码旨在演示 XXE 漏洞，但仍存在潜在的投毒风险。尽管代码目的不是恶意行为，但也需要防范以下几点：

*   **供应链风险:**  如果直接使用此仓库的代码，需要确保没有其他恶意代码被添加到项目中的依赖项中。
*   **构建过程:**  需要审核 `build.gradle.kts` 文件，确保没有添加任何可疑的任务或插件。

虽然仓库中直接嵌入恶意代码的可能性较低（估计 10%），但仍然需要谨慎处理，建议手动审查所有代码。

**利用方式总结：**

1.  目标系统使用 Ktor 并且启用了 XML 的 ContentNegotiation，版本低于 2.3.5。
2.  攻击者构造包含恶意外部实体定义的 XML 请求。
3.  服务器解析 XML 请求时，会尝试解析外部实体。
4.  如果未正确配置 XML 解析器以禁用外部实体解析，则服务器会读取本地文件或访问内部网络资源，并将内容返回给攻击者。

**项目地址:** [stefan-500/ktor-cve-2023-45612-poc](https://github.com/stefan-500/ktor-cve-2023-45612-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---



---

## POC #4

**来源**: [CVE-2023-45612-infernosalex_CVE-2023-45612-PoC.md](../2023/CVE-2023-45612-infernosalex_CVE-2023-45612-PoC.md)

## CVE-2023-45612 - JetBrains Ktor XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** JetBrains Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 目标应用使用了Ktor且启用了ContentNegotiation处理XML，未进行安全配置

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45612 漏洞是JetBrains Ktor在处理XML内容时，由于ContentNegotiation的默认配置存在缺陷，导致可能发生XML外部实体注入(XXE)攻击。攻击者可以构造恶意的XML文档，通过外部实体引用读取服务器上的敏感文件。 

**有效性：**

根据漏洞描述和提供的PoC代码，可以判断该PoC代码是有效的。PoC代码通过构造包含外部实体引用的XML文档，并将其发送到目标Ktor应用的XML处理接口，从而尝试读取指定的文件。如果Ktor应用存在漏洞，则会返回被读取的文件内容。

**投毒风险：**

分析提供的PoC代码，代码本身的功能是利用XXE漏洞读取文件，未发现任何明显的恶意代码或后门。代码主要功能是构造XML payload, 发起HTTP请求，并输出响应结果。可以认为投毒风险很低。

**利用方式：**

1.  **确定目标应用使用了Ktor，并且存在处理XML数据的接口。**  可以通过分析目标应用的请求和响应，或者查看应用的依赖库来判断。
2.  **构造恶意的XML文档。**  XML文档中需要包含DOCTYPE声明，定义外部实体，并引用该实体。
3.  **将构造的XML文档发送到目标应用的XML处理接口。**  可以使用HTTP POST请求，将XML文档作为请求体发送。
4.  **分析响应结果。**  如果目标应用存在漏洞，则响应结果中会包含被读取的文件内容。

**搜索引擎结果分析：**

搜索结果证实了漏洞的存在，并提供了漏洞的详细信息，包括漏洞描述、影响范围和修复建议。


**项目地址:** [infernosalex/CVE-2023-45612-PoC](https://github.com/infernosalex/CVE-2023-45612-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #5

**来源**: [CVE-2023-45612-ksaweryr_CVE-2023-45612-PoC.md](../2023/CVE-2023-45612-ksaweryr_CVE-2023-45612-PoC.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用使用ContentNegotiation且配置XML格式

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612是JetBrains Ktor 2.3.5之前版本中存在的一个XML外部实体注入（XXE）漏洞。该漏洞存在于ContentNegotiation中XML格式的默认配置中。攻击者可以通过发送包含恶意XML payload的请求，读取服务器上的敏感文件。 

**有效性评估:**
提供的PoC代码包含Dockerfile，docker-compose.yaml，以及server和client目录，基本可以判断 PoC 的有效性较高。docker-compose.yaml 编排了 server 和 client 两个服务，server 服务构建一个存在漏洞的 Ktor 应用，client 服务则用于执行 XXE 攻击。Dockerfile 里创建了 /lfi_poc.txt 文件，用于验证 LFI 是否成功，同时安装了 `nc` 工具，用于 healthcheck。PoC 的 README.md 描述了复现步骤。

**投毒风险分析:**
虽然PoC的主要功能是演示XXE漏洞，但仍存在一定投毒风险。例如，`client` 或 `server` 的 `Dockerfile` 可能包含恶意指令，例如在构建过程中下载并执行恶意脚本。此外，`client` 脚本本身也可能尝试执行除LFI之外的恶意操作。该风险评估较低，约为10%，因为主要目的是复现漏洞，但不能完全排除。

**漏洞利用方式:**
1.  目标Ktor应用使用ContentNegotiation并且配置XML格式。
2.  攻击者构造包含恶意XML实体的请求，其中XML实体指向服务器本地文件。
3.  Ktor应用解析XML时，会尝试解析外部实体，从而导致服务器读取并返回攻击者指定的文件内容。
4.  通过docker-compose可以快速搭建漏洞环境，便于漏洞复现与验证

**项目地址:** [ksaweryr/CVE-2023-45612-PoC](https://github.com/ksaweryr/CVE-2023-45612-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #6

**来源**: [CVE-2023-45612-razvanclaudiu_Ktor-XXE-PoC.md](../2023/CVE-2023-45612-razvanclaudiu_Ktor-XXE-PoC.md)

## CVE-2023-45612-JetBrains Ktor XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** JetBrains Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用启用了ContentNegotiation插件并使用默认的xml()序列化器，且目标服务器存在可读取的文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-45612是JetBrains Ktor框架中存在的一个XML外部实体注入（XXE）漏洞。该漏洞影响Ktor 2.3.5之前的版本，当ContentNegotiation插件与默认的xml()序列化器一起使用时，默认XML解析器未配置为阻止外部实体的解析，导致攻击者可以读取服务器上的任意文件。

**有效性评估：**
提供的POC代码有效。README.md文件详细描述了漏洞原理、复现步骤和利用方法，并提供了可执行的示例代码和curl命令。

**投毒风险评估：**
仓库中存在作者隐藏的投毒代码的可能性较低。虽然存在一些潜在风险，例如Gradle脚本中的依赖项可能指向恶意仓库或包含恶意代码，但从提供的代码片段来看，没有明显的恶意行为。gradle.kts定义了kotlin和ktor的依赖，其中风险较高的是版本控制，但是指定版本也是为了复现漏洞，可以判定风险较低。因此，投毒风险评估为5%。

**利用方式：**
1.  攻击者向启用了ContentNegotiation插件的Ktor服务器的某个接收XML数据的端点发送包含恶意XML的请求。
2.  恶意XML中定义了外部实体，指向服务器上的敏感文件，例如/etc/passwd或应用程序的配置文件。
3.  Ktor服务器使用存在漏洞的XML解析器解析XML数据，并解析外部实体，导致服务器读取指定文件内容。
4.  服务器将读取到的文件内容返回给攻击者，造成敏感信息泄露。

**项目地址:** [razvanclaudiu/Ktor-XXE-PoC](https://github.com/razvanclaudiu/Ktor-XXE-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #7

**来源**: [CVE-2023-45612-seraphimi_ktor-xxe.md](../2023/CVE-2023-45612-seraphimi_ktor-xxe.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致信息泄露、SSRF

**影响版本:** < 2.3.5

**利用条件:** 目标Ktor应用启用了ContentNegotiation并且使用XML格式，且未进行安全配置

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-45612是JetBrains Ktor框架中存在的一个XXE漏洞。当Ktor应用使用XML进行内容协商时，如果未正确配置XML解析器，攻击者可以通过发送包含恶意XML Payload的请求来利用此漏洞。

**有效性：**
提供的POC代码看起来是有效的。它包含了一个Ktor服务端示例，以及一个Python脚本 `poc.py`，该脚本用于发送包含XXE Payload的请求。POC提供了两种利用方式：
*   **文件泄露：** 攻击者可以读取服务器上的任意文件（例如，`/etc/hostname`、`/etc/passwd`）。
*   **SSRF：** 攻击者可以利用服务器发起任意的网络请求。

**投毒风险：**
对提供的代码仓库进行分析，发现投毒风险较低。关键点如下：
*   `build.gradle.kts` 文件指定了依赖，版本都是已知的。
*   `README.md` 描述了如何运行和使用POC。
*   `poc.py`  （虽然没有提供），根据README描述可以推断是用于发送恶意XML，没有明显的后门代码。
*   脚本目的是演示漏洞利用，而非植入恶意代码。
因此，仓库存在恶意投毒代码的概率较低，估计在1%左右。

**利用方式：**
1.  **目标应用环境：** 目标Ktor应用必须启用了ContentNegotiation并且使用XML格式，且使用的Ktor版本低于2.3.5。
2.  **恶意XML Payload：** 攻击者构造包含恶意XML实体定义的Payload。例如，Payload可能包含对本地文件的引用或者外部URL的引用。
3.  **发送请求：** 攻击者将包含恶意Payload的XML数据发送到目标Ktor应用的某个端点。
4.  **漏洞触发：** Ktor应用在解析XML数据时，会解析Payload中的恶意实体，从而导致XXE漏洞的触发。
5.  **利用结果：** 攻击者可以利用XXE漏洞读取服务器上的文件、发起SSRF攻击，或者执行其他恶意操作。

**项目地址:** [seraphimi/ktor-xxe](https://github.com/seraphimi/ktor-xxe)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #8

**来源**: [CVE-2023-45612-stefan-500_ktor-cve-2023-45612-poc.md](../2023/CVE-2023-45612-stefan-500_ktor-cve-2023-45612-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 服务器端使用Ktor并且ContentNegotiation配置了XML格式，且使用受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612 是一个存在于 JetBrains Ktor 2.3.5 之前的版本中的 XXE (XML 外部实体) 漏洞。当 Ktor 使用 ContentNegotiation 中 XML 格式的默认配置时，未经授权的攻击者可以通过构造恶意的 XML 输入，读取服务器上的本地文件或访问内部网络资源。 

**漏洞利用分析：**

提供的漏洞利用代码包含一个用于复现该漏洞的 Ktor 应用程序。相关文件包括：

*   `README.md`: 包含漏洞描述、参考链接和 PoC 的基本信息。
*   `build.gradle.kts`: Gradle 构建脚本，定义了项目依赖项，包括 Ktor 2.3.4 和 XML 序列化。
*   `gradle.properties`: Gradle 属性文件。
*   `gradlew`: Gradle 包装器脚本，用于构建和运行应用程序。

关键在于 `build.gradle.kts` 文件中指定了 `io.ktor:ktor-serialization-kotlinx-xml:2.3.4` 和 `io.ktor:ktor-server-content-negotiation:2.3.4`，这使得应用程序容易受到攻击。通过发送包含外部实体定义的恶意 XML 请求，攻击者可以利用 XXE 漏洞。

**投毒风险分析：**

尽管提供的代码旨在演示 XXE 漏洞，但仍存在潜在的投毒风险。尽管代码目的不是恶意行为，但也需要防范以下几点：

*   **供应链风险:**  如果直接使用此仓库的代码，需要确保没有其他恶意代码被添加到项目中的依赖项中。
*   **构建过程:**  需要审核 `build.gradle.kts` 文件，确保没有添加任何可疑的任务或插件。

虽然仓库中直接嵌入恶意代码的可能性较低（估计 10%），但仍然需要谨慎处理，建议手动审查所有代码。

**利用方式总结：**

1.  目标系统使用 Ktor 并且启用了 XML 的 ContentNegotiation，版本低于 2.3.5。
2.  攻击者构造包含恶意外部实体定义的 XML 请求。
3.  服务器解析 XML 请求时，会尝试解析外部实体。
4.  如果未正确配置 XML 解析器以禁用外部实体解析，则服务器会读取本地文件或访问内部网络资源，并将内容返回给攻击者。

**项目地址:** [stefan-500/ktor-cve-2023-45612-poc](https://github.com/stefan-500/ktor-cve-2023-45612-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---



---

## POC #4

**来源**: [CVE-2023-45612-infernosalex_CVE-2023-45612-PoC.md](../2023/CVE-2023-45612-infernosalex_CVE-2023-45612-PoC.md)

## CVE-2023-45612 - JetBrains Ktor XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** JetBrains Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 目标应用使用了Ktor且启用了ContentNegotiation处理XML，未进行安全配置

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45612 漏洞是JetBrains Ktor在处理XML内容时，由于ContentNegotiation的默认配置存在缺陷，导致可能发生XML外部实体注入(XXE)攻击。攻击者可以构造恶意的XML文档，通过外部实体引用读取服务器上的敏感文件。 

**有效性：**

根据漏洞描述和提供的PoC代码，可以判断该PoC代码是有效的。PoC代码通过构造包含外部实体引用的XML文档，并将其发送到目标Ktor应用的XML处理接口，从而尝试读取指定的文件。如果Ktor应用存在漏洞，则会返回被读取的文件内容。

**投毒风险：**

分析提供的PoC代码，代码本身的功能是利用XXE漏洞读取文件，未发现任何明显的恶意代码或后门。代码主要功能是构造XML payload, 发起HTTP请求，并输出响应结果。可以认为投毒风险很低。

**利用方式：**

1.  **确定目标应用使用了Ktor，并且存在处理XML数据的接口。**  可以通过分析目标应用的请求和响应，或者查看应用的依赖库来判断。
2.  **构造恶意的XML文档。**  XML文档中需要包含DOCTYPE声明，定义外部实体，并引用该实体。
3.  **将构造的XML文档发送到目标应用的XML处理接口。**  可以使用HTTP POST请求，将XML文档作为请求体发送。
4.  **分析响应结果。**  如果目标应用存在漏洞，则响应结果中会包含被读取的文件内容。

**搜索引擎结果分析：**

搜索结果证实了漏洞的存在，并提供了漏洞的详细信息，包括漏洞描述、影响范围和修复建议。


**项目地址:** [infernosalex/CVE-2023-45612-PoC](https://github.com/infernosalex/CVE-2023-45612-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #5

**来源**: [CVE-2023-45612-ksaweryr_CVE-2023-45612-PoC.md](../2023/CVE-2023-45612-ksaweryr_CVE-2023-45612-PoC.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用使用ContentNegotiation且配置XML格式

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612是JetBrains Ktor 2.3.5之前版本中存在的一个XML外部实体注入（XXE）漏洞。该漏洞存在于ContentNegotiation中XML格式的默认配置中。攻击者可以通过发送包含恶意XML payload的请求，读取服务器上的敏感文件。 

**有效性评估:**
提供的PoC代码包含Dockerfile，docker-compose.yaml，以及server和client目录，基本可以判断 PoC 的有效性较高。docker-compose.yaml 编排了 server 和 client 两个服务，server 服务构建一个存在漏洞的 Ktor 应用，client 服务则用于执行 XXE 攻击。Dockerfile 里创建了 /lfi_poc.txt 文件，用于验证 LFI 是否成功，同时安装了 `nc` 工具，用于 healthcheck。PoC 的 README.md 描述了复现步骤。

**投毒风险分析:**
虽然PoC的主要功能是演示XXE漏洞，但仍存在一定投毒风险。例如，`client` 或 `server` 的 `Dockerfile` 可能包含恶意指令，例如在构建过程中下载并执行恶意脚本。此外，`client` 脚本本身也可能尝试执行除LFI之外的恶意操作。该风险评估较低，约为10%，因为主要目的是复现漏洞，但不能完全排除。

**漏洞利用方式:**
1.  目标Ktor应用使用ContentNegotiation并且配置XML格式。
2.  攻击者构造包含恶意XML实体的请求，其中XML实体指向服务器本地文件。
3.  Ktor应用解析XML时，会尝试解析外部实体，从而导致服务器读取并返回攻击者指定的文件内容。
4.  通过docker-compose可以快速搭建漏洞环境，便于漏洞复现与验证

**项目地址:** [ksaweryr/CVE-2023-45612-PoC](https://github.com/ksaweryr/CVE-2023-45612-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #6

**来源**: [CVE-2023-45612-razvanclaudiu_Ktor-XXE-PoC.md](../2023/CVE-2023-45612-razvanclaudiu_Ktor-XXE-PoC.md)

## CVE-2023-45612-JetBrains Ktor XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** JetBrains Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用启用了ContentNegotiation插件并使用默认的xml()序列化器，且目标服务器存在可读取的文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-45612是JetBrains Ktor框架中存在的一个XML外部实体注入（XXE）漏洞。该漏洞影响Ktor 2.3.5之前的版本，当ContentNegotiation插件与默认的xml()序列化器一起使用时，默认XML解析器未配置为阻止外部实体的解析，导致攻击者可以读取服务器上的任意文件。

**有效性评估：**
提供的POC代码有效。README.md文件详细描述了漏洞原理、复现步骤和利用方法，并提供了可执行的示例代码和curl命令。

**投毒风险评估：**
仓库中存在作者隐藏的投毒代码的可能性较低。虽然存在一些潜在风险，例如Gradle脚本中的依赖项可能指向恶意仓库或包含恶意代码，但从提供的代码片段来看，没有明显的恶意行为。gradle.kts定义了kotlin和ktor的依赖，其中风险较高的是版本控制，但是指定版本也是为了复现漏洞，可以判定风险较低。因此，投毒风险评估为5%。

**利用方式：**
1.  攻击者向启用了ContentNegotiation插件的Ktor服务器的某个接收XML数据的端点发送包含恶意XML的请求。
2.  恶意XML中定义了外部实体，指向服务器上的敏感文件，例如/etc/passwd或应用程序的配置文件。
3.  Ktor服务器使用存在漏洞的XML解析器解析XML数据，并解析外部实体，导致服务器读取指定文件内容。
4.  服务器将读取到的文件内容返回给攻击者，造成敏感信息泄露。

**项目地址:** [razvanclaudiu/Ktor-XXE-PoC](https://github.com/razvanclaudiu/Ktor-XXE-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #7

**来源**: [CVE-2023-45612-seraphimi_ktor-xxe.md](../2023/CVE-2023-45612-seraphimi_ktor-xxe.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致信息泄露、SSRF

**影响版本:** < 2.3.5

**利用条件:** 目标Ktor应用启用了ContentNegotiation并且使用XML格式，且未进行安全配置

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-45612是JetBrains Ktor框架中存在的一个XXE漏洞。当Ktor应用使用XML进行内容协商时，如果未正确配置XML解析器，攻击者可以通过发送包含恶意XML Payload的请求来利用此漏洞。

**有效性：**
提供的POC代码看起来是有效的。它包含了一个Ktor服务端示例，以及一个Python脚本 `poc.py`，该脚本用于发送包含XXE Payload的请求。POC提供了两种利用方式：
*   **文件泄露：** 攻击者可以读取服务器上的任意文件（例如，`/etc/hostname`、`/etc/passwd`）。
*   **SSRF：** 攻击者可以利用服务器发起任意的网络请求。

**投毒风险：**
对提供的代码仓库进行分析，发现投毒风险较低。关键点如下：
*   `build.gradle.kts` 文件指定了依赖，版本都是已知的。
*   `README.md` 描述了如何运行和使用POC。
*   `poc.py`  （虽然没有提供），根据README描述可以推断是用于发送恶意XML，没有明显的后门代码。
*   脚本目的是演示漏洞利用，而非植入恶意代码。
因此，仓库存在恶意投毒代码的概率较低，估计在1%左右。

**利用方式：**
1.  **目标应用环境：** 目标Ktor应用必须启用了ContentNegotiation并且使用XML格式，且使用的Ktor版本低于2.3.5。
2.  **恶意XML Payload：** 攻击者构造包含恶意XML实体定义的Payload。例如，Payload可能包含对本地文件的引用或者外部URL的引用。
3.  **发送请求：** 攻击者将包含恶意Payload的XML数据发送到目标Ktor应用的某个端点。
4.  **漏洞触发：** Ktor应用在解析XML数据时，会解析Payload中的恶意实体，从而导致XXE漏洞的触发。
5.  **利用结果：** 攻击者可以利用XXE漏洞读取服务器上的文件、发起SSRF攻击，或者执行其他恶意操作。

**项目地址:** [seraphimi/ktor-xxe](https://github.com/seraphimi/ktor-xxe)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #8

**来源**: [CVE-2023-45612-stefan-500_ktor-cve-2023-45612-poc.md](../2023/CVE-2023-45612-stefan-500_ktor-cve-2023-45612-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 服务器端使用Ktor并且ContentNegotiation配置了XML格式，且使用受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612 是一个存在于 JetBrains Ktor 2.3.5 之前的版本中的 XXE (XML 外部实体) 漏洞。当 Ktor 使用 ContentNegotiation 中 XML 格式的默认配置时，未经授权的攻击者可以通过构造恶意的 XML 输入，读取服务器上的本地文件或访问内部网络资源。 

**漏洞利用分析：**

提供的漏洞利用代码包含一个用于复现该漏洞的 Ktor 应用程序。相关文件包括：

*   `README.md`: 包含漏洞描述、参考链接和 PoC 的基本信息。
*   `build.gradle.kts`: Gradle 构建脚本，定义了项目依赖项，包括 Ktor 2.3.4 和 XML 序列化。
*   `gradle.properties`: Gradle 属性文件。
*   `gradlew`: Gradle 包装器脚本，用于构建和运行应用程序。

关键在于 `build.gradle.kts` 文件中指定了 `io.ktor:ktor-serialization-kotlinx-xml:2.3.4` 和 `io.ktor:ktor-server-content-negotiation:2.3.4`，这使得应用程序容易受到攻击。通过发送包含外部实体定义的恶意 XML 请求，攻击者可以利用 XXE 漏洞。

**投毒风险分析：**

尽管提供的代码旨在演示 XXE 漏洞，但仍存在潜在的投毒风险。尽管代码目的不是恶意行为，但也需要防范以下几点：

*   **供应链风险:**  如果直接使用此仓库的代码，需要确保没有其他恶意代码被添加到项目中的依赖项中。
*   **构建过程:**  需要审核 `build.gradle.kts` 文件，确保没有添加任何可疑的任务或插件。

虽然仓库中直接嵌入恶意代码的可能性较低（估计 10%），但仍然需要谨慎处理，建议手动审查所有代码。

**利用方式总结：**

1.  目标系统使用 Ktor 并且启用了 XML 的 ContentNegotiation，版本低于 2.3.5。
2.  攻击者构造包含恶意外部实体定义的 XML 请求。
3.  服务器解析 XML 请求时，会尝试解析外部实体。
4.  如果未正确配置 XML 解析器以禁用外部实体解析，则服务器会读取本地文件或访问内部网络资源，并将内容返回给攻击者。

**项目地址:** [stefan-500/ktor-cve-2023-45612-poc](https://github.com/stefan-500/ktor-cve-2023-45612-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---



---

## POC #4

**来源**: [CVE-2023-45612-infernosalex_CVE-2023-45612-PoC.md](../2023/CVE-2023-45612-infernosalex_CVE-2023-45612-PoC.md)

## CVE-2023-45612 - JetBrains Ktor XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** JetBrains Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 目标应用使用了Ktor且启用了ContentNegotiation处理XML，未进行安全配置

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45612 漏洞是JetBrains Ktor在处理XML内容时，由于ContentNegotiation的默认配置存在缺陷，导致可能发生XML外部实体注入(XXE)攻击。攻击者可以构造恶意的XML文档，通过外部实体引用读取服务器上的敏感文件。 

**有效性：**

根据漏洞描述和提供的PoC代码，可以判断该PoC代码是有效的。PoC代码通过构造包含外部实体引用的XML文档，并将其发送到目标Ktor应用的XML处理接口，从而尝试读取指定的文件。如果Ktor应用存在漏洞，则会返回被读取的文件内容。

**投毒风险：**

分析提供的PoC代码，代码本身的功能是利用XXE漏洞读取文件，未发现任何明显的恶意代码或后门。代码主要功能是构造XML payload, 发起HTTP请求，并输出响应结果。可以认为投毒风险很低。

**利用方式：**

1.  **确定目标应用使用了Ktor，并且存在处理XML数据的接口。**  可以通过分析目标应用的请求和响应，或者查看应用的依赖库来判断。
2.  **构造恶意的XML文档。**  XML文档中需要包含DOCTYPE声明，定义外部实体，并引用该实体。
3.  **将构造的XML文档发送到目标应用的XML处理接口。**  可以使用HTTP POST请求，将XML文档作为请求体发送。
4.  **分析响应结果。**  如果目标应用存在漏洞，则响应结果中会包含被读取的文件内容。

**搜索引擎结果分析：**

搜索结果证实了漏洞的存在，并提供了漏洞的详细信息，包括漏洞描述、影响范围和修复建议。


**项目地址:** [infernosalex/CVE-2023-45612-PoC](https://github.com/infernosalex/CVE-2023-45612-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #5

**来源**: [CVE-2023-45612-ksaweryr_CVE-2023-45612-PoC.md](../2023/CVE-2023-45612-ksaweryr_CVE-2023-45612-PoC.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用使用ContentNegotiation且配置XML格式

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612是JetBrains Ktor 2.3.5之前版本中存在的一个XML外部实体注入（XXE）漏洞。该漏洞存在于ContentNegotiation中XML格式的默认配置中。攻击者可以通过发送包含恶意XML payload的请求，读取服务器上的敏感文件。 

**有效性评估:**
提供的PoC代码包含Dockerfile，docker-compose.yaml，以及server和client目录，基本可以判断 PoC 的有效性较高。docker-compose.yaml 编排了 server 和 client 两个服务，server 服务构建一个存在漏洞的 Ktor 应用，client 服务则用于执行 XXE 攻击。Dockerfile 里创建了 /lfi_poc.txt 文件，用于验证 LFI 是否成功，同时安装了 `nc` 工具，用于 healthcheck。PoC 的 README.md 描述了复现步骤。

**投毒风险分析:**
虽然PoC的主要功能是演示XXE漏洞，但仍存在一定投毒风险。例如，`client` 或 `server` 的 `Dockerfile` 可能包含恶意指令，例如在构建过程中下载并执行恶意脚本。此外，`client` 脚本本身也可能尝试执行除LFI之外的恶意操作。该风险评估较低，约为10%，因为主要目的是复现漏洞，但不能完全排除。

**漏洞利用方式:**
1.  目标Ktor应用使用ContentNegotiation并且配置XML格式。
2.  攻击者构造包含恶意XML实体的请求，其中XML实体指向服务器本地文件。
3.  Ktor应用解析XML时，会尝试解析外部实体，从而导致服务器读取并返回攻击者指定的文件内容。
4.  通过docker-compose可以快速搭建漏洞环境，便于漏洞复现与验证

**项目地址:** [ksaweryr/CVE-2023-45612-PoC](https://github.com/ksaweryr/CVE-2023-45612-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #6

**来源**: [CVE-2023-45612-razvanclaudiu_Ktor-XXE-PoC.md](../2023/CVE-2023-45612-razvanclaudiu_Ktor-XXE-PoC.md)

## CVE-2023-45612-JetBrains Ktor XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** JetBrains Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用启用了ContentNegotiation插件并使用默认的xml()序列化器，且目标服务器存在可读取的文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-45612是JetBrains Ktor框架中存在的一个XML外部实体注入（XXE）漏洞。该漏洞影响Ktor 2.3.5之前的版本，当ContentNegotiation插件与默认的xml()序列化器一起使用时，默认XML解析器未配置为阻止外部实体的解析，导致攻击者可以读取服务器上的任意文件。

**有效性评估：**
提供的POC代码有效。README.md文件详细描述了漏洞原理、复现步骤和利用方法，并提供了可执行的示例代码和curl命令。

**投毒风险评估：**
仓库中存在作者隐藏的投毒代码的可能性较低。虽然存在一些潜在风险，例如Gradle脚本中的依赖项可能指向恶意仓库或包含恶意代码，但从提供的代码片段来看，没有明显的恶意行为。gradle.kts定义了kotlin和ktor的依赖，其中风险较高的是版本控制，但是指定版本也是为了复现漏洞，可以判定风险较低。因此，投毒风险评估为5%。

**利用方式：**
1.  攻击者向启用了ContentNegotiation插件的Ktor服务器的某个接收XML数据的端点发送包含恶意XML的请求。
2.  恶意XML中定义了外部实体，指向服务器上的敏感文件，例如/etc/passwd或应用程序的配置文件。
3.  Ktor服务器使用存在漏洞的XML解析器解析XML数据，并解析外部实体，导致服务器读取指定文件内容。
4.  服务器将读取到的文件内容返回给攻击者，造成敏感信息泄露。

**项目地址:** [razvanclaudiu/Ktor-XXE-PoC](https://github.com/razvanclaudiu/Ktor-XXE-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #7

**来源**: [CVE-2023-45612-seraphimi_ktor-xxe.md](../2023/CVE-2023-45612-seraphimi_ktor-xxe.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致信息泄露、SSRF

**影响版本:** < 2.3.5

**利用条件:** 目标Ktor应用启用了ContentNegotiation并且使用XML格式，且未进行安全配置

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-45612是JetBrains Ktor框架中存在的一个XXE漏洞。当Ktor应用使用XML进行内容协商时，如果未正确配置XML解析器，攻击者可以通过发送包含恶意XML Payload的请求来利用此漏洞。

**有效性：**
提供的POC代码看起来是有效的。它包含了一个Ktor服务端示例，以及一个Python脚本 `poc.py`，该脚本用于发送包含XXE Payload的请求。POC提供了两种利用方式：
*   **文件泄露：** 攻击者可以读取服务器上的任意文件（例如，`/etc/hostname`、`/etc/passwd`）。
*   **SSRF：** 攻击者可以利用服务器发起任意的网络请求。

**投毒风险：**
对提供的代码仓库进行分析，发现投毒风险较低。关键点如下：
*   `build.gradle.kts` 文件指定了依赖，版本都是已知的。
*   `README.md` 描述了如何运行和使用POC。
*   `poc.py`  （虽然没有提供），根据README描述可以推断是用于发送恶意XML，没有明显的后门代码。
*   脚本目的是演示漏洞利用，而非植入恶意代码。
因此，仓库存在恶意投毒代码的概率较低，估计在1%左右。

**利用方式：**
1.  **目标应用环境：** 目标Ktor应用必须启用了ContentNegotiation并且使用XML格式，且使用的Ktor版本低于2.3.5。
2.  **恶意XML Payload：** 攻击者构造包含恶意XML实体定义的Payload。例如，Payload可能包含对本地文件的引用或者外部URL的引用。
3.  **发送请求：** 攻击者将包含恶意Payload的XML数据发送到目标Ktor应用的某个端点。
4.  **漏洞触发：** Ktor应用在解析XML数据时，会解析Payload中的恶意实体，从而导致XXE漏洞的触发。
5.  **利用结果：** 攻击者可以利用XXE漏洞读取服务器上的文件、发起SSRF攻击，或者执行其他恶意操作。

**项目地址:** [seraphimi/ktor-xxe](https://github.com/seraphimi/ktor-xxe)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #8

**来源**: [CVE-2023-45612-stefan-500_ktor-cve-2023-45612-poc.md](../2023/CVE-2023-45612-stefan-500_ktor-cve-2023-45612-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 服务器端使用Ktor并且ContentNegotiation配置了XML格式，且使用受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612 是一个存在于 JetBrains Ktor 2.3.5 之前的版本中的 XXE (XML 外部实体) 漏洞。当 Ktor 使用 ContentNegotiation 中 XML 格式的默认配置时，未经授权的攻击者可以通过构造恶意的 XML 输入，读取服务器上的本地文件或访问内部网络资源。 

**漏洞利用分析：**

提供的漏洞利用代码包含一个用于复现该漏洞的 Ktor 应用程序。相关文件包括：

*   `README.md`: 包含漏洞描述、参考链接和 PoC 的基本信息。
*   `build.gradle.kts`: Gradle 构建脚本，定义了项目依赖项，包括 Ktor 2.3.4 和 XML 序列化。
*   `gradle.properties`: Gradle 属性文件。
*   `gradlew`: Gradle 包装器脚本，用于构建和运行应用程序。

关键在于 `build.gradle.kts` 文件中指定了 `io.ktor:ktor-serialization-kotlinx-xml:2.3.4` 和 `io.ktor:ktor-server-content-negotiation:2.3.4`，这使得应用程序容易受到攻击。通过发送包含外部实体定义的恶意 XML 请求，攻击者可以利用 XXE 漏洞。

**投毒风险分析：**

尽管提供的代码旨在演示 XXE 漏洞，但仍存在潜在的投毒风险。尽管代码目的不是恶意行为，但也需要防范以下几点：

*   **供应链风险:**  如果直接使用此仓库的代码，需要确保没有其他恶意代码被添加到项目中的依赖项中。
*   **构建过程:**  需要审核 `build.gradle.kts` 文件，确保没有添加任何可疑的任务或插件。

虽然仓库中直接嵌入恶意代码的可能性较低（估计 10%），但仍然需要谨慎处理，建议手动审查所有代码。

**利用方式总结：**

1.  目标系统使用 Ktor 并且启用了 XML 的 ContentNegotiation，版本低于 2.3.5。
2.  攻击者构造包含恶意外部实体定义的 XML 请求。
3.  服务器解析 XML 请求时，会尝试解析外部实体。
4.  如果未正确配置 XML 解析器以禁用外部实体解析，则服务器会读取本地文件或访问内部网络资源，并将内容返回给攻击者。

**项目地址:** [stefan-500/ktor-cve-2023-45612-poc](https://github.com/stefan-500/ktor-cve-2023-45612-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---



---

## POC #4

**来源**: [CVE-2023-45612-infernosalex_CVE-2023-45612-PoC.md](../2023/CVE-2023-45612-infernosalex_CVE-2023-45612-PoC.md)

## CVE-2023-45612 - JetBrains Ktor XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** JetBrains Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 目标应用使用了Ktor且启用了ContentNegotiation处理XML，未进行安全配置

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45612 漏洞是JetBrains Ktor在处理XML内容时，由于ContentNegotiation的默认配置存在缺陷，导致可能发生XML外部实体注入(XXE)攻击。攻击者可以构造恶意的XML文档，通过外部实体引用读取服务器上的敏感文件。 

**有效性：**

根据漏洞描述和提供的PoC代码，可以判断该PoC代码是有效的。PoC代码通过构造包含外部实体引用的XML文档，并将其发送到目标Ktor应用的XML处理接口，从而尝试读取指定的文件。如果Ktor应用存在漏洞，则会返回被读取的文件内容。

**投毒风险：**

分析提供的PoC代码，代码本身的功能是利用XXE漏洞读取文件，未发现任何明显的恶意代码或后门。代码主要功能是构造XML payload, 发起HTTP请求，并输出响应结果。可以认为投毒风险很低。

**利用方式：**

1.  **确定目标应用使用了Ktor，并且存在处理XML数据的接口。**  可以通过分析目标应用的请求和响应，或者查看应用的依赖库来判断。
2.  **构造恶意的XML文档。**  XML文档中需要包含DOCTYPE声明，定义外部实体，并引用该实体。
3.  **将构造的XML文档发送到目标应用的XML处理接口。**  可以使用HTTP POST请求，将XML文档作为请求体发送。
4.  **分析响应结果。**  如果目标应用存在漏洞，则响应结果中会包含被读取的文件内容。

**搜索引擎结果分析：**

搜索结果证实了漏洞的存在，并提供了漏洞的详细信息，包括漏洞描述、影响范围和修复建议。


**项目地址:** [infernosalex/CVE-2023-45612-PoC](https://github.com/infernosalex/CVE-2023-45612-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #5

**来源**: [CVE-2023-45612-ksaweryr_CVE-2023-45612-PoC.md](../2023/CVE-2023-45612-ksaweryr_CVE-2023-45612-PoC.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用使用ContentNegotiation且配置XML格式

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612是JetBrains Ktor 2.3.5之前版本中存在的一个XML外部实体注入（XXE）漏洞。该漏洞存在于ContentNegotiation中XML格式的默认配置中。攻击者可以通过发送包含恶意XML payload的请求，读取服务器上的敏感文件。 

**有效性评估:**
提供的PoC代码包含Dockerfile，docker-compose.yaml，以及server和client目录，基本可以判断 PoC 的有效性较高。docker-compose.yaml 编排了 server 和 client 两个服务，server 服务构建一个存在漏洞的 Ktor 应用，client 服务则用于执行 XXE 攻击。Dockerfile 里创建了 /lfi_poc.txt 文件，用于验证 LFI 是否成功，同时安装了 `nc` 工具，用于 healthcheck。PoC 的 README.md 描述了复现步骤。

**投毒风险分析:**
虽然PoC的主要功能是演示XXE漏洞，但仍存在一定投毒风险。例如，`client` 或 `server` 的 `Dockerfile` 可能包含恶意指令，例如在构建过程中下载并执行恶意脚本。此外，`client` 脚本本身也可能尝试执行除LFI之外的恶意操作。该风险评估较低，约为10%，因为主要目的是复现漏洞，但不能完全排除。

**漏洞利用方式:**
1.  目标Ktor应用使用ContentNegotiation并且配置XML格式。
2.  攻击者构造包含恶意XML实体的请求，其中XML实体指向服务器本地文件。
3.  Ktor应用解析XML时，会尝试解析外部实体，从而导致服务器读取并返回攻击者指定的文件内容。
4.  通过docker-compose可以快速搭建漏洞环境，便于漏洞复现与验证

**项目地址:** [ksaweryr/CVE-2023-45612-PoC](https://github.com/ksaweryr/CVE-2023-45612-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #6

**来源**: [CVE-2023-45612-razvanclaudiu_Ktor-XXE-PoC.md](../2023/CVE-2023-45612-razvanclaudiu_Ktor-XXE-PoC.md)

## CVE-2023-45612-JetBrains Ktor XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** JetBrains Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用启用了ContentNegotiation插件并使用默认的xml()序列化器，且目标服务器存在可读取的文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-45612是JetBrains Ktor框架中存在的一个XML外部实体注入（XXE）漏洞。该漏洞影响Ktor 2.3.5之前的版本，当ContentNegotiation插件与默认的xml()序列化器一起使用时，默认XML解析器未配置为阻止外部实体的解析，导致攻击者可以读取服务器上的任意文件。

**有效性评估：**
提供的POC代码有效。README.md文件详细描述了漏洞原理、复现步骤和利用方法，并提供了可执行的示例代码和curl命令。

**投毒风险评估：**
仓库中存在作者隐藏的投毒代码的可能性较低。虽然存在一些潜在风险，例如Gradle脚本中的依赖项可能指向恶意仓库或包含恶意代码，但从提供的代码片段来看，没有明显的恶意行为。gradle.kts定义了kotlin和ktor的依赖，其中风险较高的是版本控制，但是指定版本也是为了复现漏洞，可以判定风险较低。因此，投毒风险评估为5%。

**利用方式：**
1.  攻击者向启用了ContentNegotiation插件的Ktor服务器的某个接收XML数据的端点发送包含恶意XML的请求。
2.  恶意XML中定义了外部实体，指向服务器上的敏感文件，例如/etc/passwd或应用程序的配置文件。
3.  Ktor服务器使用存在漏洞的XML解析器解析XML数据，并解析外部实体，导致服务器读取指定文件内容。
4.  服务器将读取到的文件内容返回给攻击者，造成敏感信息泄露。

**项目地址:** [razvanclaudiu/Ktor-XXE-PoC](https://github.com/razvanclaudiu/Ktor-XXE-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #7

**来源**: [CVE-2023-45612-seraphimi_ktor-xxe.md](../2023/CVE-2023-45612-seraphimi_ktor-xxe.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致信息泄露、SSRF

**影响版本:** < 2.3.5

**利用条件:** 目标Ktor应用启用了ContentNegotiation并且使用XML格式，且未进行安全配置

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-45612是JetBrains Ktor框架中存在的一个XXE漏洞。当Ktor应用使用XML进行内容协商时，如果未正确配置XML解析器，攻击者可以通过发送包含恶意XML Payload的请求来利用此漏洞。

**有效性：**
提供的POC代码看起来是有效的。它包含了一个Ktor服务端示例，以及一个Python脚本 `poc.py`，该脚本用于发送包含XXE Payload的请求。POC提供了两种利用方式：
*   **文件泄露：** 攻击者可以读取服务器上的任意文件（例如，`/etc/hostname`、`/etc/passwd`）。
*   **SSRF：** 攻击者可以利用服务器发起任意的网络请求。

**投毒风险：**
对提供的代码仓库进行分析，发现投毒风险较低。关键点如下：
*   `build.gradle.kts` 文件指定了依赖，版本都是已知的。
*   `README.md` 描述了如何运行和使用POC。
*   `poc.py`  （虽然没有提供），根据README描述可以推断是用于发送恶意XML，没有明显的后门代码。
*   脚本目的是演示漏洞利用，而非植入恶意代码。
因此，仓库存在恶意投毒代码的概率较低，估计在1%左右。

**利用方式：**
1.  **目标应用环境：** 目标Ktor应用必须启用了ContentNegotiation并且使用XML格式，且使用的Ktor版本低于2.3.5。
2.  **恶意XML Payload：** 攻击者构造包含恶意XML实体定义的Payload。例如，Payload可能包含对本地文件的引用或者外部URL的引用。
3.  **发送请求：** 攻击者将包含恶意Payload的XML数据发送到目标Ktor应用的某个端点。
4.  **漏洞触发：** Ktor应用在解析XML数据时，会解析Payload中的恶意实体，从而导致XXE漏洞的触发。
5.  **利用结果：** 攻击者可以利用XXE漏洞读取服务器上的文件、发起SSRF攻击，或者执行其他恶意操作。

**项目地址:** [seraphimi/ktor-xxe](https://github.com/seraphimi/ktor-xxe)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #8

**来源**: [CVE-2023-45612-stefan-500_ktor-cve-2023-45612-poc.md](../2023/CVE-2023-45612-stefan-500_ktor-cve-2023-45612-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 服务器端使用Ktor并且ContentNegotiation配置了XML格式，且使用受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612 是一个存在于 JetBrains Ktor 2.3.5 之前的版本中的 XXE (XML 外部实体) 漏洞。当 Ktor 使用 ContentNegotiation 中 XML 格式的默认配置时，未经授权的攻击者可以通过构造恶意的 XML 输入，读取服务器上的本地文件或访问内部网络资源。 

**漏洞利用分析：**

提供的漏洞利用代码包含一个用于复现该漏洞的 Ktor 应用程序。相关文件包括：

*   `README.md`: 包含漏洞描述、参考链接和 PoC 的基本信息。
*   `build.gradle.kts`: Gradle 构建脚本，定义了项目依赖项，包括 Ktor 2.3.4 和 XML 序列化。
*   `gradle.properties`: Gradle 属性文件。
*   `gradlew`: Gradle 包装器脚本，用于构建和运行应用程序。

关键在于 `build.gradle.kts` 文件中指定了 `io.ktor:ktor-serialization-kotlinx-xml:2.3.4` 和 `io.ktor:ktor-server-content-negotiation:2.3.4`，这使得应用程序容易受到攻击。通过发送包含外部实体定义的恶意 XML 请求，攻击者可以利用 XXE 漏洞。

**投毒风险分析：**

尽管提供的代码旨在演示 XXE 漏洞，但仍存在潜在的投毒风险。尽管代码目的不是恶意行为，但也需要防范以下几点：

*   **供应链风险:**  如果直接使用此仓库的代码，需要确保没有其他恶意代码被添加到项目中的依赖项中。
*   **构建过程:**  需要审核 `build.gradle.kts` 文件，确保没有添加任何可疑的任务或插件。

虽然仓库中直接嵌入恶意代码的可能性较低（估计 10%），但仍然需要谨慎处理，建议手动审查所有代码。

**利用方式总结：**

1.  目标系统使用 Ktor 并且启用了 XML 的 ContentNegotiation，版本低于 2.3.5。
2.  攻击者构造包含恶意外部实体定义的 XML 请求。
3.  服务器解析 XML 请求时，会尝试解析外部实体。
4.  如果未正确配置 XML 解析器以禁用外部实体解析，则服务器会读取本地文件或访问内部网络资源，并将内容返回给攻击者。

**项目地址:** [stefan-500/ktor-cve-2023-45612-poc](https://github.com/stefan-500/ktor-cve-2023-45612-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---



---

## POC #4

**来源**: [CVE-2023-45612-infernosalex_CVE-2023-45612-PoC.md](../2023/CVE-2023-45612-infernosalex_CVE-2023-45612-PoC.md)

## CVE-2023-45612 - JetBrains Ktor XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** JetBrains Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 目标应用使用了Ktor且启用了ContentNegotiation处理XML，未进行安全配置

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45612 漏洞是JetBrains Ktor在处理XML内容时，由于ContentNegotiation的默认配置存在缺陷，导致可能发生XML外部实体注入(XXE)攻击。攻击者可以构造恶意的XML文档，通过外部实体引用读取服务器上的敏感文件。 

**有效性：**

根据漏洞描述和提供的PoC代码，可以判断该PoC代码是有效的。PoC代码通过构造包含外部实体引用的XML文档，并将其发送到目标Ktor应用的XML处理接口，从而尝试读取指定的文件。如果Ktor应用存在漏洞，则会返回被读取的文件内容。

**投毒风险：**

分析提供的PoC代码，代码本身的功能是利用XXE漏洞读取文件，未发现任何明显的恶意代码或后门。代码主要功能是构造XML payload, 发起HTTP请求，并输出响应结果。可以认为投毒风险很低。

**利用方式：**

1.  **确定目标应用使用了Ktor，并且存在处理XML数据的接口。**  可以通过分析目标应用的请求和响应，或者查看应用的依赖库来判断。
2.  **构造恶意的XML文档。**  XML文档中需要包含DOCTYPE声明，定义外部实体，并引用该实体。
3.  **将构造的XML文档发送到目标应用的XML处理接口。**  可以使用HTTP POST请求，将XML文档作为请求体发送。
4.  **分析响应结果。**  如果目标应用存在漏洞，则响应结果中会包含被读取的文件内容。

**搜索引擎结果分析：**

搜索结果证实了漏洞的存在，并提供了漏洞的详细信息，包括漏洞描述、影响范围和修复建议。


**项目地址:** [infernosalex/CVE-2023-45612-PoC](https://github.com/infernosalex/CVE-2023-45612-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #5

**来源**: [CVE-2023-45612-ksaweryr_CVE-2023-45612-PoC.md](../2023/CVE-2023-45612-ksaweryr_CVE-2023-45612-PoC.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用使用ContentNegotiation且配置XML格式

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612是JetBrains Ktor 2.3.5之前版本中存在的一个XML外部实体注入（XXE）漏洞。该漏洞存在于ContentNegotiation中XML格式的默认配置中。攻击者可以通过发送包含恶意XML payload的请求，读取服务器上的敏感文件。 

**有效性评估:**
提供的PoC代码包含Dockerfile，docker-compose.yaml，以及server和client目录，基本可以判断 PoC 的有效性较高。docker-compose.yaml 编排了 server 和 client 两个服务，server 服务构建一个存在漏洞的 Ktor 应用，client 服务则用于执行 XXE 攻击。Dockerfile 里创建了 /lfi_poc.txt 文件，用于验证 LFI 是否成功，同时安装了 `nc` 工具，用于 healthcheck。PoC 的 README.md 描述了复现步骤。

**投毒风险分析:**
虽然PoC的主要功能是演示XXE漏洞，但仍存在一定投毒风险。例如，`client` 或 `server` 的 `Dockerfile` 可能包含恶意指令，例如在构建过程中下载并执行恶意脚本。此外，`client` 脚本本身也可能尝试执行除LFI之外的恶意操作。该风险评估较低，约为10%，因为主要目的是复现漏洞，但不能完全排除。

**漏洞利用方式:**
1.  目标Ktor应用使用ContentNegotiation并且配置XML格式。
2.  攻击者构造包含恶意XML实体的请求，其中XML实体指向服务器本地文件。
3.  Ktor应用解析XML时，会尝试解析外部实体，从而导致服务器读取并返回攻击者指定的文件内容。
4.  通过docker-compose可以快速搭建漏洞环境，便于漏洞复现与验证

**项目地址:** [ksaweryr/CVE-2023-45612-PoC](https://github.com/ksaweryr/CVE-2023-45612-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #6

**来源**: [CVE-2023-45612-razvanclaudiu_Ktor-XXE-PoC.md](../2023/CVE-2023-45612-razvanclaudiu_Ktor-XXE-PoC.md)

## CVE-2023-45612-JetBrains Ktor XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** JetBrains Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用启用了ContentNegotiation插件并使用默认的xml()序列化器，且目标服务器存在可读取的文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-45612是JetBrains Ktor框架中存在的一个XML外部实体注入（XXE）漏洞。该漏洞影响Ktor 2.3.5之前的版本，当ContentNegotiation插件与默认的xml()序列化器一起使用时，默认XML解析器未配置为阻止外部实体的解析，导致攻击者可以读取服务器上的任意文件。

**有效性评估：**
提供的POC代码有效。README.md文件详细描述了漏洞原理、复现步骤和利用方法，并提供了可执行的示例代码和curl命令。

**投毒风险评估：**
仓库中存在作者隐藏的投毒代码的可能性较低。虽然存在一些潜在风险，例如Gradle脚本中的依赖项可能指向恶意仓库或包含恶意代码，但从提供的代码片段来看，没有明显的恶意行为。gradle.kts定义了kotlin和ktor的依赖，其中风险较高的是版本控制，但是指定版本也是为了复现漏洞，可以判定风险较低。因此，投毒风险评估为5%。

**利用方式：**
1.  攻击者向启用了ContentNegotiation插件的Ktor服务器的某个接收XML数据的端点发送包含恶意XML的请求。
2.  恶意XML中定义了外部实体，指向服务器上的敏感文件，例如/etc/passwd或应用程序的配置文件。
3.  Ktor服务器使用存在漏洞的XML解析器解析XML数据，并解析外部实体，导致服务器读取指定文件内容。
4.  服务器将读取到的文件内容返回给攻击者，造成敏感信息泄露。

**项目地址:** [razvanclaudiu/Ktor-XXE-PoC](https://github.com/razvanclaudiu/Ktor-XXE-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #7

**来源**: [CVE-2023-45612-seraphimi_ktor-xxe.md](../2023/CVE-2023-45612-seraphimi_ktor-xxe.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致信息泄露、SSRF

**影响版本:** < 2.3.5

**利用条件:** 目标Ktor应用启用了ContentNegotiation并且使用XML格式，且未进行安全配置

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-45612是JetBrains Ktor框架中存在的一个XXE漏洞。当Ktor应用使用XML进行内容协商时，如果未正确配置XML解析器，攻击者可以通过发送包含恶意XML Payload的请求来利用此漏洞。

**有效性：**
提供的POC代码看起来是有效的。它包含了一个Ktor服务端示例，以及一个Python脚本 `poc.py`，该脚本用于发送包含XXE Payload的请求。POC提供了两种利用方式：
*   **文件泄露：** 攻击者可以读取服务器上的任意文件（例如，`/etc/hostname`、`/etc/passwd`）。
*   **SSRF：** 攻击者可以利用服务器发起任意的网络请求。

**投毒风险：**
对提供的代码仓库进行分析，发现投毒风险较低。关键点如下：
*   `build.gradle.kts` 文件指定了依赖，版本都是已知的。
*   `README.md` 描述了如何运行和使用POC。
*   `poc.py`  （虽然没有提供），根据README描述可以推断是用于发送恶意XML，没有明显的后门代码。
*   脚本目的是演示漏洞利用，而非植入恶意代码。
因此，仓库存在恶意投毒代码的概率较低，估计在1%左右。

**利用方式：**
1.  **目标应用环境：** 目标Ktor应用必须启用了ContentNegotiation并且使用XML格式，且使用的Ktor版本低于2.3.5。
2.  **恶意XML Payload：** 攻击者构造包含恶意XML实体定义的Payload。例如，Payload可能包含对本地文件的引用或者外部URL的引用。
3.  **发送请求：** 攻击者将包含恶意Payload的XML数据发送到目标Ktor应用的某个端点。
4.  **漏洞触发：** Ktor应用在解析XML数据时，会解析Payload中的恶意实体，从而导致XXE漏洞的触发。
5.  **利用结果：** 攻击者可以利用XXE漏洞读取服务器上的文件、发起SSRF攻击，或者执行其他恶意操作。

**项目地址:** [seraphimi/ktor-xxe](https://github.com/seraphimi/ktor-xxe)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #8

**来源**: [CVE-2023-45612-stefan-500_ktor-cve-2023-45612-poc.md](../2023/CVE-2023-45612-stefan-500_ktor-cve-2023-45612-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 服务器端使用Ktor并且ContentNegotiation配置了XML格式，且使用受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612 是一个存在于 JetBrains Ktor 2.3.5 之前的版本中的 XXE (XML 外部实体) 漏洞。当 Ktor 使用 ContentNegotiation 中 XML 格式的默认配置时，未经授权的攻击者可以通过构造恶意的 XML 输入，读取服务器上的本地文件或访问内部网络资源。 

**漏洞利用分析：**

提供的漏洞利用代码包含一个用于复现该漏洞的 Ktor 应用程序。相关文件包括：

*   `README.md`: 包含漏洞描述、参考链接和 PoC 的基本信息。
*   `build.gradle.kts`: Gradle 构建脚本，定义了项目依赖项，包括 Ktor 2.3.4 和 XML 序列化。
*   `gradle.properties`: Gradle 属性文件。
*   `gradlew`: Gradle 包装器脚本，用于构建和运行应用程序。

关键在于 `build.gradle.kts` 文件中指定了 `io.ktor:ktor-serialization-kotlinx-xml:2.3.4` 和 `io.ktor:ktor-server-content-negotiation:2.3.4`，这使得应用程序容易受到攻击。通过发送包含外部实体定义的恶意 XML 请求，攻击者可以利用 XXE 漏洞。

**投毒风险分析：**

尽管提供的代码旨在演示 XXE 漏洞，但仍存在潜在的投毒风险。尽管代码目的不是恶意行为，但也需要防范以下几点：

*   **供应链风险:**  如果直接使用此仓库的代码，需要确保没有其他恶意代码被添加到项目中的依赖项中。
*   **构建过程:**  需要审核 `build.gradle.kts` 文件，确保没有添加任何可疑的任务或插件。

虽然仓库中直接嵌入恶意代码的可能性较低（估计 10%），但仍然需要谨慎处理，建议手动审查所有代码。

**利用方式总结：**

1.  目标系统使用 Ktor 并且启用了 XML 的 ContentNegotiation，版本低于 2.3.5。
2.  攻击者构造包含恶意外部实体定义的 XML 请求。
3.  服务器解析 XML 请求时，会尝试解析外部实体。
4.  如果未正确配置 XML 解析器以禁用外部实体解析，则服务器会读取本地文件或访问内部网络资源，并将内容返回给攻击者。

**项目地址:** [stefan-500/ktor-cve-2023-45612-poc](https://github.com/stefan-500/ktor-cve-2023-45612-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---



---

## POC #4

**来源**: [CVE-2023-45612-infernosalex_CVE-2023-45612-PoC.md](../2023/CVE-2023-45612-infernosalex_CVE-2023-45612-PoC.md)

## CVE-2023-45612 - JetBrains Ktor XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** JetBrains Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 目标应用使用了Ktor且启用了ContentNegotiation处理XML，未进行安全配置

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45612 漏洞是JetBrains Ktor在处理XML内容时，由于ContentNegotiation的默认配置存在缺陷，导致可能发生XML外部实体注入(XXE)攻击。攻击者可以构造恶意的XML文档，通过外部实体引用读取服务器上的敏感文件。 

**有效性：**

根据漏洞描述和提供的PoC代码，可以判断该PoC代码是有效的。PoC代码通过构造包含外部实体引用的XML文档，并将其发送到目标Ktor应用的XML处理接口，从而尝试读取指定的文件。如果Ktor应用存在漏洞，则会返回被读取的文件内容。

**投毒风险：**

分析提供的PoC代码，代码本身的功能是利用XXE漏洞读取文件，未发现任何明显的恶意代码或后门。代码主要功能是构造XML payload, 发起HTTP请求，并输出响应结果。可以认为投毒风险很低。

**利用方式：**

1.  **确定目标应用使用了Ktor，并且存在处理XML数据的接口。**  可以通过分析目标应用的请求和响应，或者查看应用的依赖库来判断。
2.  **构造恶意的XML文档。**  XML文档中需要包含DOCTYPE声明，定义外部实体，并引用该实体。
3.  **将构造的XML文档发送到目标应用的XML处理接口。**  可以使用HTTP POST请求，将XML文档作为请求体发送。
4.  **分析响应结果。**  如果目标应用存在漏洞，则响应结果中会包含被读取的文件内容。

**搜索引擎结果分析：**

搜索结果证实了漏洞的存在，并提供了漏洞的详细信息，包括漏洞描述、影响范围和修复建议。


**项目地址:** [infernosalex/CVE-2023-45612-PoC](https://github.com/infernosalex/CVE-2023-45612-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #5

**来源**: [CVE-2023-45612-ksaweryr_CVE-2023-45612-PoC.md](../2023/CVE-2023-45612-ksaweryr_CVE-2023-45612-PoC.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用使用ContentNegotiation且配置XML格式

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612是JetBrains Ktor 2.3.5之前版本中存在的一个XML外部实体注入（XXE）漏洞。该漏洞存在于ContentNegotiation中XML格式的默认配置中。攻击者可以通过发送包含恶意XML payload的请求，读取服务器上的敏感文件。 

**有效性评估:**
提供的PoC代码包含Dockerfile，docker-compose.yaml，以及server和client目录，基本可以判断 PoC 的有效性较高。docker-compose.yaml 编排了 server 和 client 两个服务，server 服务构建一个存在漏洞的 Ktor 应用，client 服务则用于执行 XXE 攻击。Dockerfile 里创建了 /lfi_poc.txt 文件，用于验证 LFI 是否成功，同时安装了 `nc` 工具，用于 healthcheck。PoC 的 README.md 描述了复现步骤。

**投毒风险分析:**
虽然PoC的主要功能是演示XXE漏洞，但仍存在一定投毒风险。例如，`client` 或 `server` 的 `Dockerfile` 可能包含恶意指令，例如在构建过程中下载并执行恶意脚本。此外，`client` 脚本本身也可能尝试执行除LFI之外的恶意操作。该风险评估较低，约为10%，因为主要目的是复现漏洞，但不能完全排除。

**漏洞利用方式:**
1.  目标Ktor应用使用ContentNegotiation并且配置XML格式。
2.  攻击者构造包含恶意XML实体的请求，其中XML实体指向服务器本地文件。
3.  Ktor应用解析XML时，会尝试解析外部实体，从而导致服务器读取并返回攻击者指定的文件内容。
4.  通过docker-compose可以快速搭建漏洞环境，便于漏洞复现与验证

**项目地址:** [ksaweryr/CVE-2023-45612-PoC](https://github.com/ksaweryr/CVE-2023-45612-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #6

**来源**: [CVE-2023-45612-razvanclaudiu_Ktor-XXE-PoC.md](../2023/CVE-2023-45612-razvanclaudiu_Ktor-XXE-PoC.md)

## CVE-2023-45612-JetBrains Ktor XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** JetBrains Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用启用了ContentNegotiation插件并使用默认的xml()序列化器，且目标服务器存在可读取的文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-45612是JetBrains Ktor框架中存在的一个XML外部实体注入（XXE）漏洞。该漏洞影响Ktor 2.3.5之前的版本，当ContentNegotiation插件与默认的xml()序列化器一起使用时，默认XML解析器未配置为阻止外部实体的解析，导致攻击者可以读取服务器上的任意文件。

**有效性评估：**
提供的POC代码有效。README.md文件详细描述了漏洞原理、复现步骤和利用方法，并提供了可执行的示例代码和curl命令。

**投毒风险评估：**
仓库中存在作者隐藏的投毒代码的可能性较低。虽然存在一些潜在风险，例如Gradle脚本中的依赖项可能指向恶意仓库或包含恶意代码，但从提供的代码片段来看，没有明显的恶意行为。gradle.kts定义了kotlin和ktor的依赖，其中风险较高的是版本控制，但是指定版本也是为了复现漏洞，可以判定风险较低。因此，投毒风险评估为5%。

**利用方式：**
1.  攻击者向启用了ContentNegotiation插件的Ktor服务器的某个接收XML数据的端点发送包含恶意XML的请求。
2.  恶意XML中定义了外部实体，指向服务器上的敏感文件，例如/etc/passwd或应用程序的配置文件。
3.  Ktor服务器使用存在漏洞的XML解析器解析XML数据，并解析外部实体，导致服务器读取指定文件内容。
4.  服务器将读取到的文件内容返回给攻击者，造成敏感信息泄露。

**项目地址:** [razvanclaudiu/Ktor-XXE-PoC](https://github.com/razvanclaudiu/Ktor-XXE-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #7

**来源**: [CVE-2023-45612-seraphimi_ktor-xxe.md](../2023/CVE-2023-45612-seraphimi_ktor-xxe.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致信息泄露、SSRF

**影响版本:** < 2.3.5

**利用条件:** 目标Ktor应用启用了ContentNegotiation并且使用XML格式，且未进行安全配置

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-45612是JetBrains Ktor框架中存在的一个XXE漏洞。当Ktor应用使用XML进行内容协商时，如果未正确配置XML解析器，攻击者可以通过发送包含恶意XML Payload的请求来利用此漏洞。

**有效性：**
提供的POC代码看起来是有效的。它包含了一个Ktor服务端示例，以及一个Python脚本 `poc.py`，该脚本用于发送包含XXE Payload的请求。POC提供了两种利用方式：
*   **文件泄露：** 攻击者可以读取服务器上的任意文件（例如，`/etc/hostname`、`/etc/passwd`）。
*   **SSRF：** 攻击者可以利用服务器发起任意的网络请求。

**投毒风险：**
对提供的代码仓库进行分析，发现投毒风险较低。关键点如下：
*   `build.gradle.kts` 文件指定了依赖，版本都是已知的。
*   `README.md` 描述了如何运行和使用POC。
*   `poc.py`  （虽然没有提供），根据README描述可以推断是用于发送恶意XML，没有明显的后门代码。
*   脚本目的是演示漏洞利用，而非植入恶意代码。
因此，仓库存在恶意投毒代码的概率较低，估计在1%左右。

**利用方式：**
1.  **目标应用环境：** 目标Ktor应用必须启用了ContentNegotiation并且使用XML格式，且使用的Ktor版本低于2.3.5。
2.  **恶意XML Payload：** 攻击者构造包含恶意XML实体定义的Payload。例如，Payload可能包含对本地文件的引用或者外部URL的引用。
3.  **发送请求：** 攻击者将包含恶意Payload的XML数据发送到目标Ktor应用的某个端点。
4.  **漏洞触发：** Ktor应用在解析XML数据时，会解析Payload中的恶意实体，从而导致XXE漏洞的触发。
5.  **利用结果：** 攻击者可以利用XXE漏洞读取服务器上的文件、发起SSRF攻击，或者执行其他恶意操作。

**项目地址:** [seraphimi/ktor-xxe](https://github.com/seraphimi/ktor-xxe)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #8

**来源**: [CVE-2023-45612-stefan-500_ktor-cve-2023-45612-poc.md](../2023/CVE-2023-45612-stefan-500_ktor-cve-2023-45612-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 服务器端使用Ktor并且ContentNegotiation配置了XML格式，且使用受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612 是一个存在于 JetBrains Ktor 2.3.5 之前的版本中的 XXE (XML 外部实体) 漏洞。当 Ktor 使用 ContentNegotiation 中 XML 格式的默认配置时，未经授权的攻击者可以通过构造恶意的 XML 输入，读取服务器上的本地文件或访问内部网络资源。 

**漏洞利用分析：**

提供的漏洞利用代码包含一个用于复现该漏洞的 Ktor 应用程序。相关文件包括：

*   `README.md`: 包含漏洞描述、参考链接和 PoC 的基本信息。
*   `build.gradle.kts`: Gradle 构建脚本，定义了项目依赖项，包括 Ktor 2.3.4 和 XML 序列化。
*   `gradle.properties`: Gradle 属性文件。
*   `gradlew`: Gradle 包装器脚本，用于构建和运行应用程序。

关键在于 `build.gradle.kts` 文件中指定了 `io.ktor:ktor-serialization-kotlinx-xml:2.3.4` 和 `io.ktor:ktor-server-content-negotiation:2.3.4`，这使得应用程序容易受到攻击。通过发送包含外部实体定义的恶意 XML 请求，攻击者可以利用 XXE 漏洞。

**投毒风险分析：**

尽管提供的代码旨在演示 XXE 漏洞，但仍存在潜在的投毒风险。尽管代码目的不是恶意行为，但也需要防范以下几点：

*   **供应链风险:**  如果直接使用此仓库的代码，需要确保没有其他恶意代码被添加到项目中的依赖项中。
*   **构建过程:**  需要审核 `build.gradle.kts` 文件，确保没有添加任何可疑的任务或插件。

虽然仓库中直接嵌入恶意代码的可能性较低（估计 10%），但仍然需要谨慎处理，建议手动审查所有代码。

**利用方式总结：**

1.  目标系统使用 Ktor 并且启用了 XML 的 ContentNegotiation，版本低于 2.3.5。
2.  攻击者构造包含恶意外部实体定义的 XML 请求。
3.  服务器解析 XML 请求时，会尝试解析外部实体。
4.  如果未正确配置 XML 解析器以禁用外部实体解析，则服务器会读取本地文件或访问内部网络资源，并将内容返回给攻击者。

**项目地址:** [stefan-500/ktor-cve-2023-45612-poc](https://github.com/stefan-500/ktor-cve-2023-45612-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---



---

## POC #4

**来源**: [CVE-2023-45612-infernosalex_CVE-2023-45612-PoC.md](../2023/CVE-2023-45612-infernosalex_CVE-2023-45612-PoC.md)

## CVE-2023-45612 - JetBrains Ktor XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** JetBrains Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 目标应用使用了Ktor且启用了ContentNegotiation处理XML，未进行安全配置

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45612 漏洞是JetBrains Ktor在处理XML内容时，由于ContentNegotiation的默认配置存在缺陷，导致可能发生XML外部实体注入(XXE)攻击。攻击者可以构造恶意的XML文档，通过外部实体引用读取服务器上的敏感文件。 

**有效性：**

根据漏洞描述和提供的PoC代码，可以判断该PoC代码是有效的。PoC代码通过构造包含外部实体引用的XML文档，并将其发送到目标Ktor应用的XML处理接口，从而尝试读取指定的文件。如果Ktor应用存在漏洞，则会返回被读取的文件内容。

**投毒风险：**

分析提供的PoC代码，代码本身的功能是利用XXE漏洞读取文件，未发现任何明显的恶意代码或后门。代码主要功能是构造XML payload, 发起HTTP请求，并输出响应结果。可以认为投毒风险很低。

**利用方式：**

1.  **确定目标应用使用了Ktor，并且存在处理XML数据的接口。**  可以通过分析目标应用的请求和响应，或者查看应用的依赖库来判断。
2.  **构造恶意的XML文档。**  XML文档中需要包含DOCTYPE声明，定义外部实体，并引用该实体。
3.  **将构造的XML文档发送到目标应用的XML处理接口。**  可以使用HTTP POST请求，将XML文档作为请求体发送。
4.  **分析响应结果。**  如果目标应用存在漏洞，则响应结果中会包含被读取的文件内容。

**搜索引擎结果分析：**

搜索结果证实了漏洞的存在，并提供了漏洞的详细信息，包括漏洞描述、影响范围和修复建议。


**项目地址:** [infernosalex/CVE-2023-45612-PoC](https://github.com/infernosalex/CVE-2023-45612-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #5

**来源**: [CVE-2023-45612-ksaweryr_CVE-2023-45612-PoC.md](../2023/CVE-2023-45612-ksaweryr_CVE-2023-45612-PoC.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用使用ContentNegotiation且配置XML格式

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612是JetBrains Ktor 2.3.5之前版本中存在的一个XML外部实体注入（XXE）漏洞。该漏洞存在于ContentNegotiation中XML格式的默认配置中。攻击者可以通过发送包含恶意XML payload的请求，读取服务器上的敏感文件。 

**有效性评估:**
提供的PoC代码包含Dockerfile，docker-compose.yaml，以及server和client目录，基本可以判断 PoC 的有效性较高。docker-compose.yaml 编排了 server 和 client 两个服务，server 服务构建一个存在漏洞的 Ktor 应用，client 服务则用于执行 XXE 攻击。Dockerfile 里创建了 /lfi_poc.txt 文件，用于验证 LFI 是否成功，同时安装了 `nc` 工具，用于 healthcheck。PoC 的 README.md 描述了复现步骤。

**投毒风险分析:**
虽然PoC的主要功能是演示XXE漏洞，但仍存在一定投毒风险。例如，`client` 或 `server` 的 `Dockerfile` 可能包含恶意指令，例如在构建过程中下载并执行恶意脚本。此外，`client` 脚本本身也可能尝试执行除LFI之外的恶意操作。该风险评估较低，约为10%，因为主要目的是复现漏洞，但不能完全排除。

**漏洞利用方式:**
1.  目标Ktor应用使用ContentNegotiation并且配置XML格式。
2.  攻击者构造包含恶意XML实体的请求，其中XML实体指向服务器本地文件。
3.  Ktor应用解析XML时，会尝试解析外部实体，从而导致服务器读取并返回攻击者指定的文件内容。
4.  通过docker-compose可以快速搭建漏洞环境，便于漏洞复现与验证

**项目地址:** [ksaweryr/CVE-2023-45612-PoC](https://github.com/ksaweryr/CVE-2023-45612-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #6

**来源**: [CVE-2023-45612-razvanclaudiu_Ktor-XXE-PoC.md](../2023/CVE-2023-45612-razvanclaudiu_Ktor-XXE-PoC.md)

## CVE-2023-45612-JetBrains Ktor XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** JetBrains Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用启用了ContentNegotiation插件并使用默认的xml()序列化器，且目标服务器存在可读取的文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-45612是JetBrains Ktor框架中存在的一个XML外部实体注入（XXE）漏洞。该漏洞影响Ktor 2.3.5之前的版本，当ContentNegotiation插件与默认的xml()序列化器一起使用时，默认XML解析器未配置为阻止外部实体的解析，导致攻击者可以读取服务器上的任意文件。

**有效性评估：**
提供的POC代码有效。README.md文件详细描述了漏洞原理、复现步骤和利用方法，并提供了可执行的示例代码和curl命令。

**投毒风险评估：**
仓库中存在作者隐藏的投毒代码的可能性较低。虽然存在一些潜在风险，例如Gradle脚本中的依赖项可能指向恶意仓库或包含恶意代码，但从提供的代码片段来看，没有明显的恶意行为。gradle.kts定义了kotlin和ktor的依赖，其中风险较高的是版本控制，但是指定版本也是为了复现漏洞，可以判定风险较低。因此，投毒风险评估为5%。

**利用方式：**
1.  攻击者向启用了ContentNegotiation插件的Ktor服务器的某个接收XML数据的端点发送包含恶意XML的请求。
2.  恶意XML中定义了外部实体，指向服务器上的敏感文件，例如/etc/passwd或应用程序的配置文件。
3.  Ktor服务器使用存在漏洞的XML解析器解析XML数据，并解析外部实体，导致服务器读取指定文件内容。
4.  服务器将读取到的文件内容返回给攻击者，造成敏感信息泄露。

**项目地址:** [razvanclaudiu/Ktor-XXE-PoC](https://github.com/razvanclaudiu/Ktor-XXE-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #7

**来源**: [CVE-2023-45612-seraphimi_ktor-xxe.md](../2023/CVE-2023-45612-seraphimi_ktor-xxe.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致信息泄露、SSRF

**影响版本:** < 2.3.5

**利用条件:** 目标Ktor应用启用了ContentNegotiation并且使用XML格式，且未进行安全配置

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-45612是JetBrains Ktor框架中存在的一个XXE漏洞。当Ktor应用使用XML进行内容协商时，如果未正确配置XML解析器，攻击者可以通过发送包含恶意XML Payload的请求来利用此漏洞。

**有效性：**
提供的POC代码看起来是有效的。它包含了一个Ktor服务端示例，以及一个Python脚本 `poc.py`，该脚本用于发送包含XXE Payload的请求。POC提供了两种利用方式：
*   **文件泄露：** 攻击者可以读取服务器上的任意文件（例如，`/etc/hostname`、`/etc/passwd`）。
*   **SSRF：** 攻击者可以利用服务器发起任意的网络请求。

**投毒风险：**
对提供的代码仓库进行分析，发现投毒风险较低。关键点如下：
*   `build.gradle.kts` 文件指定了依赖，版本都是已知的。
*   `README.md` 描述了如何运行和使用POC。
*   `poc.py`  （虽然没有提供），根据README描述可以推断是用于发送恶意XML，没有明显的后门代码。
*   脚本目的是演示漏洞利用，而非植入恶意代码。
因此，仓库存在恶意投毒代码的概率较低，估计在1%左右。

**利用方式：**
1.  **目标应用环境：** 目标Ktor应用必须启用了ContentNegotiation并且使用XML格式，且使用的Ktor版本低于2.3.5。
2.  **恶意XML Payload：** 攻击者构造包含恶意XML实体定义的Payload。例如，Payload可能包含对本地文件的引用或者外部URL的引用。
3.  **发送请求：** 攻击者将包含恶意Payload的XML数据发送到目标Ktor应用的某个端点。
4.  **漏洞触发：** Ktor应用在解析XML数据时，会解析Payload中的恶意实体，从而导致XXE漏洞的触发。
5.  **利用结果：** 攻击者可以利用XXE漏洞读取服务器上的文件、发起SSRF攻击，或者执行其他恶意操作。

**项目地址:** [seraphimi/ktor-xxe](https://github.com/seraphimi/ktor-xxe)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #8

**来源**: [CVE-2023-45612-stefan-500_ktor-cve-2023-45612-poc.md](../2023/CVE-2023-45612-stefan-500_ktor-cve-2023-45612-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 服务器端使用Ktor并且ContentNegotiation配置了XML格式，且使用受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612 是一个存在于 JetBrains Ktor 2.3.5 之前的版本中的 XXE (XML 外部实体) 漏洞。当 Ktor 使用 ContentNegotiation 中 XML 格式的默认配置时，未经授权的攻击者可以通过构造恶意的 XML 输入，读取服务器上的本地文件或访问内部网络资源。 

**漏洞利用分析：**

提供的漏洞利用代码包含一个用于复现该漏洞的 Ktor 应用程序。相关文件包括：

*   `README.md`: 包含漏洞描述、参考链接和 PoC 的基本信息。
*   `build.gradle.kts`: Gradle 构建脚本，定义了项目依赖项，包括 Ktor 2.3.4 和 XML 序列化。
*   `gradle.properties`: Gradle 属性文件。
*   `gradlew`: Gradle 包装器脚本，用于构建和运行应用程序。

关键在于 `build.gradle.kts` 文件中指定了 `io.ktor:ktor-serialization-kotlinx-xml:2.3.4` 和 `io.ktor:ktor-server-content-negotiation:2.3.4`，这使得应用程序容易受到攻击。通过发送包含外部实体定义的恶意 XML 请求，攻击者可以利用 XXE 漏洞。

**投毒风险分析：**

尽管提供的代码旨在演示 XXE 漏洞，但仍存在潜在的投毒风险。尽管代码目的不是恶意行为，但也需要防范以下几点：

*   **供应链风险:**  如果直接使用此仓库的代码，需要确保没有其他恶意代码被添加到项目中的依赖项中。
*   **构建过程:**  需要审核 `build.gradle.kts` 文件，确保没有添加任何可疑的任务或插件。

虽然仓库中直接嵌入恶意代码的可能性较低（估计 10%），但仍然需要谨慎处理，建议手动审查所有代码。

**利用方式总结：**

1.  目标系统使用 Ktor 并且启用了 XML 的 ContentNegotiation，版本低于 2.3.5。
2.  攻击者构造包含恶意外部实体定义的 XML 请求。
3.  服务器解析 XML 请求时，会尝试解析外部实体。
4.  如果未正确配置 XML 解析器以禁用外部实体解析，则服务器会读取本地文件或访问内部网络资源，并将内容返回给攻击者。

**项目地址:** [stefan-500/ktor-cve-2023-45612-poc](https://github.com/stefan-500/ktor-cve-2023-45612-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---



---

## POC #4

**来源**: [CVE-2023-45612-infernosalex_CVE-2023-45612-PoC.md](../2023/CVE-2023-45612-infernosalex_CVE-2023-45612-PoC.md)

## CVE-2023-45612 - JetBrains Ktor XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** JetBrains Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 目标应用使用了Ktor且启用了ContentNegotiation处理XML，未进行安全配置

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45612 漏洞是JetBrains Ktor在处理XML内容时，由于ContentNegotiation的默认配置存在缺陷，导致可能发生XML外部实体注入(XXE)攻击。攻击者可以构造恶意的XML文档，通过外部实体引用读取服务器上的敏感文件。 

**有效性：**

根据漏洞描述和提供的PoC代码，可以判断该PoC代码是有效的。PoC代码通过构造包含外部实体引用的XML文档，并将其发送到目标Ktor应用的XML处理接口，从而尝试读取指定的文件。如果Ktor应用存在漏洞，则会返回被读取的文件内容。

**投毒风险：**

分析提供的PoC代码，代码本身的功能是利用XXE漏洞读取文件，未发现任何明显的恶意代码或后门。代码主要功能是构造XML payload, 发起HTTP请求，并输出响应结果。可以认为投毒风险很低。

**利用方式：**

1.  **确定目标应用使用了Ktor，并且存在处理XML数据的接口。**  可以通过分析目标应用的请求和响应，或者查看应用的依赖库来判断。
2.  **构造恶意的XML文档。**  XML文档中需要包含DOCTYPE声明，定义外部实体，并引用该实体。
3.  **将构造的XML文档发送到目标应用的XML处理接口。**  可以使用HTTP POST请求，将XML文档作为请求体发送。
4.  **分析响应结果。**  如果目标应用存在漏洞，则响应结果中会包含被读取的文件内容。

**搜索引擎结果分析：**

搜索结果证实了漏洞的存在，并提供了漏洞的详细信息，包括漏洞描述、影响范围和修复建议。


**项目地址:** [infernosalex/CVE-2023-45612-PoC](https://github.com/infernosalex/CVE-2023-45612-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #5

**来源**: [CVE-2023-45612-ksaweryr_CVE-2023-45612-PoC.md](../2023/CVE-2023-45612-ksaweryr_CVE-2023-45612-PoC.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用使用ContentNegotiation且配置XML格式

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612是JetBrains Ktor 2.3.5之前版本中存在的一个XML外部实体注入（XXE）漏洞。该漏洞存在于ContentNegotiation中XML格式的默认配置中。攻击者可以通过发送包含恶意XML payload的请求，读取服务器上的敏感文件。 

**有效性评估:**
提供的PoC代码包含Dockerfile，docker-compose.yaml，以及server和client目录，基本可以判断 PoC 的有效性较高。docker-compose.yaml 编排了 server 和 client 两个服务，server 服务构建一个存在漏洞的 Ktor 应用，client 服务则用于执行 XXE 攻击。Dockerfile 里创建了 /lfi_poc.txt 文件，用于验证 LFI 是否成功，同时安装了 `nc` 工具，用于 healthcheck。PoC 的 README.md 描述了复现步骤。

**投毒风险分析:**
虽然PoC的主要功能是演示XXE漏洞，但仍存在一定投毒风险。例如，`client` 或 `server` 的 `Dockerfile` 可能包含恶意指令，例如在构建过程中下载并执行恶意脚本。此外，`client` 脚本本身也可能尝试执行除LFI之外的恶意操作。该风险评估较低，约为10%，因为主要目的是复现漏洞，但不能完全排除。

**漏洞利用方式:**
1.  目标Ktor应用使用ContentNegotiation并且配置XML格式。
2.  攻击者构造包含恶意XML实体的请求，其中XML实体指向服务器本地文件。
3.  Ktor应用解析XML时，会尝试解析外部实体，从而导致服务器读取并返回攻击者指定的文件内容。
4.  通过docker-compose可以快速搭建漏洞环境，便于漏洞复现与验证

**项目地址:** [ksaweryr/CVE-2023-45612-PoC](https://github.com/ksaweryr/CVE-2023-45612-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #6

**来源**: [CVE-2023-45612-razvanclaudiu_Ktor-XXE-PoC.md](../2023/CVE-2023-45612-razvanclaudiu_Ktor-XXE-PoC.md)

## CVE-2023-45612-JetBrains Ktor XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** JetBrains Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用启用了ContentNegotiation插件并使用默认的xml()序列化器，且目标服务器存在可读取的文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-45612是JetBrains Ktor框架中存在的一个XML外部实体注入（XXE）漏洞。该漏洞影响Ktor 2.3.5之前的版本，当ContentNegotiation插件与默认的xml()序列化器一起使用时，默认XML解析器未配置为阻止外部实体的解析，导致攻击者可以读取服务器上的任意文件。

**有效性评估：**
提供的POC代码有效。README.md文件详细描述了漏洞原理、复现步骤和利用方法，并提供了可执行的示例代码和curl命令。

**投毒风险评估：**
仓库中存在作者隐藏的投毒代码的可能性较低。虽然存在一些潜在风险，例如Gradle脚本中的依赖项可能指向恶意仓库或包含恶意代码，但从提供的代码片段来看，没有明显的恶意行为。gradle.kts定义了kotlin和ktor的依赖，其中风险较高的是版本控制，但是指定版本也是为了复现漏洞，可以判定风险较低。因此，投毒风险评估为5%。

**利用方式：**
1.  攻击者向启用了ContentNegotiation插件的Ktor服务器的某个接收XML数据的端点发送包含恶意XML的请求。
2.  恶意XML中定义了外部实体，指向服务器上的敏感文件，例如/etc/passwd或应用程序的配置文件。
3.  Ktor服务器使用存在漏洞的XML解析器解析XML数据，并解析外部实体，导致服务器读取指定文件内容。
4.  服务器将读取到的文件内容返回给攻击者，造成敏感信息泄露。

**项目地址:** [razvanclaudiu/Ktor-XXE-PoC](https://github.com/razvanclaudiu/Ktor-XXE-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #7

**来源**: [CVE-2023-45612-seraphimi_ktor-xxe.md](../2023/CVE-2023-45612-seraphimi_ktor-xxe.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致信息泄露、SSRF

**影响版本:** < 2.3.5

**利用条件:** 目标Ktor应用启用了ContentNegotiation并且使用XML格式，且未进行安全配置

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-45612是JetBrains Ktor框架中存在的一个XXE漏洞。当Ktor应用使用XML进行内容协商时，如果未正确配置XML解析器，攻击者可以通过发送包含恶意XML Payload的请求来利用此漏洞。

**有效性：**
提供的POC代码看起来是有效的。它包含了一个Ktor服务端示例，以及一个Python脚本 `poc.py`，该脚本用于发送包含XXE Payload的请求。POC提供了两种利用方式：
*   **文件泄露：** 攻击者可以读取服务器上的任意文件（例如，`/etc/hostname`、`/etc/passwd`）。
*   **SSRF：** 攻击者可以利用服务器发起任意的网络请求。

**投毒风险：**
对提供的代码仓库进行分析，发现投毒风险较低。关键点如下：
*   `build.gradle.kts` 文件指定了依赖，版本都是已知的。
*   `README.md` 描述了如何运行和使用POC。
*   `poc.py`  （虽然没有提供），根据README描述可以推断是用于发送恶意XML，没有明显的后门代码。
*   脚本目的是演示漏洞利用，而非植入恶意代码。
因此，仓库存在恶意投毒代码的概率较低，估计在1%左右。

**利用方式：**
1.  **目标应用环境：** 目标Ktor应用必须启用了ContentNegotiation并且使用XML格式，且使用的Ktor版本低于2.3.5。
2.  **恶意XML Payload：** 攻击者构造包含恶意XML实体定义的Payload。例如，Payload可能包含对本地文件的引用或者外部URL的引用。
3.  **发送请求：** 攻击者将包含恶意Payload的XML数据发送到目标Ktor应用的某个端点。
4.  **漏洞触发：** Ktor应用在解析XML数据时，会解析Payload中的恶意实体，从而导致XXE漏洞的触发。
5.  **利用结果：** 攻击者可以利用XXE漏洞读取服务器上的文件、发起SSRF攻击，或者执行其他恶意操作。

**项目地址:** [seraphimi/ktor-xxe](https://github.com/seraphimi/ktor-xxe)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #8

**来源**: [CVE-2023-45612-stefan-500_ktor-cve-2023-45612-poc.md](../2023/CVE-2023-45612-stefan-500_ktor-cve-2023-45612-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 服务器端使用Ktor并且ContentNegotiation配置了XML格式，且使用受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612 是一个存在于 JetBrains Ktor 2.3.5 之前的版本中的 XXE (XML 外部实体) 漏洞。当 Ktor 使用 ContentNegotiation 中 XML 格式的默认配置时，未经授权的攻击者可以通过构造恶意的 XML 输入，读取服务器上的本地文件或访问内部网络资源。 

**漏洞利用分析：**

提供的漏洞利用代码包含一个用于复现该漏洞的 Ktor 应用程序。相关文件包括：

*   `README.md`: 包含漏洞描述、参考链接和 PoC 的基本信息。
*   `build.gradle.kts`: Gradle 构建脚本，定义了项目依赖项，包括 Ktor 2.3.4 和 XML 序列化。
*   `gradle.properties`: Gradle 属性文件。
*   `gradlew`: Gradle 包装器脚本，用于构建和运行应用程序。

关键在于 `build.gradle.kts` 文件中指定了 `io.ktor:ktor-serialization-kotlinx-xml:2.3.4` 和 `io.ktor:ktor-server-content-negotiation:2.3.4`，这使得应用程序容易受到攻击。通过发送包含外部实体定义的恶意 XML 请求，攻击者可以利用 XXE 漏洞。

**投毒风险分析：**

尽管提供的代码旨在演示 XXE 漏洞，但仍存在潜在的投毒风险。尽管代码目的不是恶意行为，但也需要防范以下几点：

*   **供应链风险:**  如果直接使用此仓库的代码，需要确保没有其他恶意代码被添加到项目中的依赖项中。
*   **构建过程:**  需要审核 `build.gradle.kts` 文件，确保没有添加任何可疑的任务或插件。

虽然仓库中直接嵌入恶意代码的可能性较低（估计 10%），但仍然需要谨慎处理，建议手动审查所有代码。

**利用方式总结：**

1.  目标系统使用 Ktor 并且启用了 XML 的 ContentNegotiation，版本低于 2.3.5。
2.  攻击者构造包含恶意外部实体定义的 XML 请求。
3.  服务器解析 XML 请求时，会尝试解析外部实体。
4.  如果未正确配置 XML 解析器以禁用外部实体解析，则服务器会读取本地文件或访问内部网络资源，并将内容返回给攻击者。

**项目地址:** [stefan-500/ktor-cve-2023-45612-poc](https://github.com/stefan-500/ktor-cve-2023-45612-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---



---

## POC #4

**来源**: [CVE-2023-45612-infernosalex_CVE-2023-45612-PoC.md](../2023/CVE-2023-45612-infernosalex_CVE-2023-45612-PoC.md)

## CVE-2023-45612 - JetBrains Ktor XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** JetBrains Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 目标应用使用了Ktor且启用了ContentNegotiation处理XML，未进行安全配置

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45612 漏洞是JetBrains Ktor在处理XML内容时，由于ContentNegotiation的默认配置存在缺陷，导致可能发生XML外部实体注入(XXE)攻击。攻击者可以构造恶意的XML文档，通过外部实体引用读取服务器上的敏感文件。 

**有效性：**

根据漏洞描述和提供的PoC代码，可以判断该PoC代码是有效的。PoC代码通过构造包含外部实体引用的XML文档，并将其发送到目标Ktor应用的XML处理接口，从而尝试读取指定的文件。如果Ktor应用存在漏洞，则会返回被读取的文件内容。

**投毒风险：**

分析提供的PoC代码，代码本身的功能是利用XXE漏洞读取文件，未发现任何明显的恶意代码或后门。代码主要功能是构造XML payload, 发起HTTP请求，并输出响应结果。可以认为投毒风险很低。

**利用方式：**

1.  **确定目标应用使用了Ktor，并且存在处理XML数据的接口。**  可以通过分析目标应用的请求和响应，或者查看应用的依赖库来判断。
2.  **构造恶意的XML文档。**  XML文档中需要包含DOCTYPE声明，定义外部实体，并引用该实体。
3.  **将构造的XML文档发送到目标应用的XML处理接口。**  可以使用HTTP POST请求，将XML文档作为请求体发送。
4.  **分析响应结果。**  如果目标应用存在漏洞，则响应结果中会包含被读取的文件内容。

**搜索引擎结果分析：**

搜索结果证实了漏洞的存在，并提供了漏洞的详细信息，包括漏洞描述、影响范围和修复建议。


**项目地址:** [infernosalex/CVE-2023-45612-PoC](https://github.com/infernosalex/CVE-2023-45612-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #5

**来源**: [CVE-2023-45612-ksaweryr_CVE-2023-45612-PoC.md](../2023/CVE-2023-45612-ksaweryr_CVE-2023-45612-PoC.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用使用ContentNegotiation且配置XML格式

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612是JetBrains Ktor 2.3.5之前版本中存在的一个XML外部实体注入（XXE）漏洞。该漏洞存在于ContentNegotiation中XML格式的默认配置中。攻击者可以通过发送包含恶意XML payload的请求，读取服务器上的敏感文件。 

**有效性评估:**
提供的PoC代码包含Dockerfile，docker-compose.yaml，以及server和client目录，基本可以判断 PoC 的有效性较高。docker-compose.yaml 编排了 server 和 client 两个服务，server 服务构建一个存在漏洞的 Ktor 应用，client 服务则用于执行 XXE 攻击。Dockerfile 里创建了 /lfi_poc.txt 文件，用于验证 LFI 是否成功，同时安装了 `nc` 工具，用于 healthcheck。PoC 的 README.md 描述了复现步骤。

**投毒风险分析:**
虽然PoC的主要功能是演示XXE漏洞，但仍存在一定投毒风险。例如，`client` 或 `server` 的 `Dockerfile` 可能包含恶意指令，例如在构建过程中下载并执行恶意脚本。此外，`client` 脚本本身也可能尝试执行除LFI之外的恶意操作。该风险评估较低，约为10%，因为主要目的是复现漏洞，但不能完全排除。

**漏洞利用方式:**
1.  目标Ktor应用使用ContentNegotiation并且配置XML格式。
2.  攻击者构造包含恶意XML实体的请求，其中XML实体指向服务器本地文件。
3.  Ktor应用解析XML时，会尝试解析外部实体，从而导致服务器读取并返回攻击者指定的文件内容。
4.  通过docker-compose可以快速搭建漏洞环境，便于漏洞复现与验证

**项目地址:** [ksaweryr/CVE-2023-45612-PoC](https://github.com/ksaweryr/CVE-2023-45612-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #6

**来源**: [CVE-2023-45612-razvanclaudiu_Ktor-XXE-PoC.md](../2023/CVE-2023-45612-razvanclaudiu_Ktor-XXE-PoC.md)

## CVE-2023-45612-JetBrains Ktor XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** JetBrains Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用启用了ContentNegotiation插件并使用默认的xml()序列化器，且目标服务器存在可读取的文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-45612是JetBrains Ktor框架中存在的一个XML外部实体注入（XXE）漏洞。该漏洞影响Ktor 2.3.5之前的版本，当ContentNegotiation插件与默认的xml()序列化器一起使用时，默认XML解析器未配置为阻止外部实体的解析，导致攻击者可以读取服务器上的任意文件。

**有效性评估：**
提供的POC代码有效。README.md文件详细描述了漏洞原理、复现步骤和利用方法，并提供了可执行的示例代码和curl命令。

**投毒风险评估：**
仓库中存在作者隐藏的投毒代码的可能性较低。虽然存在一些潜在风险，例如Gradle脚本中的依赖项可能指向恶意仓库或包含恶意代码，但从提供的代码片段来看，没有明显的恶意行为。gradle.kts定义了kotlin和ktor的依赖，其中风险较高的是版本控制，但是指定版本也是为了复现漏洞，可以判定风险较低。因此，投毒风险评估为5%。

**利用方式：**
1.  攻击者向启用了ContentNegotiation插件的Ktor服务器的某个接收XML数据的端点发送包含恶意XML的请求。
2.  恶意XML中定义了外部实体，指向服务器上的敏感文件，例如/etc/passwd或应用程序的配置文件。
3.  Ktor服务器使用存在漏洞的XML解析器解析XML数据，并解析外部实体，导致服务器读取指定文件内容。
4.  服务器将读取到的文件内容返回给攻击者，造成敏感信息泄露。

**项目地址:** [razvanclaudiu/Ktor-XXE-PoC](https://github.com/razvanclaudiu/Ktor-XXE-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #7

**来源**: [CVE-2023-45612-seraphimi_ktor-xxe.md](../2023/CVE-2023-45612-seraphimi_ktor-xxe.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致信息泄露、SSRF

**影响版本:** < 2.3.5

**利用条件:** 目标Ktor应用启用了ContentNegotiation并且使用XML格式，且未进行安全配置

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-45612是JetBrains Ktor框架中存在的一个XXE漏洞。当Ktor应用使用XML进行内容协商时，如果未正确配置XML解析器，攻击者可以通过发送包含恶意XML Payload的请求来利用此漏洞。

**有效性：**
提供的POC代码看起来是有效的。它包含了一个Ktor服务端示例，以及一个Python脚本 `poc.py`，该脚本用于发送包含XXE Payload的请求。POC提供了两种利用方式：
*   **文件泄露：** 攻击者可以读取服务器上的任意文件（例如，`/etc/hostname`、`/etc/passwd`）。
*   **SSRF：** 攻击者可以利用服务器发起任意的网络请求。

**投毒风险：**
对提供的代码仓库进行分析，发现投毒风险较低。关键点如下：
*   `build.gradle.kts` 文件指定了依赖，版本都是已知的。
*   `README.md` 描述了如何运行和使用POC。
*   `poc.py`  （虽然没有提供），根据README描述可以推断是用于发送恶意XML，没有明显的后门代码。
*   脚本目的是演示漏洞利用，而非植入恶意代码。
因此，仓库存在恶意投毒代码的概率较低，估计在1%左右。

**利用方式：**
1.  **目标应用环境：** 目标Ktor应用必须启用了ContentNegotiation并且使用XML格式，且使用的Ktor版本低于2.3.5。
2.  **恶意XML Payload：** 攻击者构造包含恶意XML实体定义的Payload。例如，Payload可能包含对本地文件的引用或者外部URL的引用。
3.  **发送请求：** 攻击者将包含恶意Payload的XML数据发送到目标Ktor应用的某个端点。
4.  **漏洞触发：** Ktor应用在解析XML数据时，会解析Payload中的恶意实体，从而导致XXE漏洞的触发。
5.  **利用结果：** 攻击者可以利用XXE漏洞读取服务器上的文件、发起SSRF攻击，或者执行其他恶意操作。

**项目地址:** [seraphimi/ktor-xxe](https://github.com/seraphimi/ktor-xxe)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

## POC #8

**来源**: [CVE-2023-45612-stefan-500_ktor-cve-2023-45612-poc.md](../2023/CVE-2023-45612-stefan-500_ktor-cve-2023-45612-poc.md)

## CVE-2023-45612-Ktor-XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 服务器端使用Ktor并且ContentNegotiation配置了XML格式，且使用受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45612 是一个存在于 JetBrains Ktor 2.3.5 之前的版本中的 XXE (XML 外部实体) 漏洞。当 Ktor 使用 ContentNegotiation 中 XML 格式的默认配置时，未经授权的攻击者可以通过构造恶意的 XML 输入，读取服务器上的本地文件或访问内部网络资源。 

**漏洞利用分析：**

提供的漏洞利用代码包含一个用于复现该漏洞的 Ktor 应用程序。相关文件包括：

*   `README.md`: 包含漏洞描述、参考链接和 PoC 的基本信息。
*   `build.gradle.kts`: Gradle 构建脚本，定义了项目依赖项，包括 Ktor 2.3.4 和 XML 序列化。
*   `gradle.properties`: Gradle 属性文件。
*   `gradlew`: Gradle 包装器脚本，用于构建和运行应用程序。

关键在于 `build.gradle.kts` 文件中指定了 `io.ktor:ktor-serialization-kotlinx-xml:2.3.4` 和 `io.ktor:ktor-server-content-negotiation:2.3.4`，这使得应用程序容易受到攻击。通过发送包含外部实体定义的恶意 XML 请求，攻击者可以利用 XXE 漏洞。

**投毒风险分析：**

尽管提供的代码旨在演示 XXE 漏洞，但仍存在潜在的投毒风险。尽管代码目的不是恶意行为，但也需要防范以下几点：

*   **供应链风险:**  如果直接使用此仓库的代码，需要确保没有其他恶意代码被添加到项目中的依赖项中。
*   **构建过程:**  需要审核 `build.gradle.kts` 文件，确保没有添加任何可疑的任务或插件。

虽然仓库中直接嵌入恶意代码的可能性较低（估计 10%），但仍然需要谨慎处理，建议手动审查所有代码。

**利用方式总结：**

1.  目标系统使用 Ktor 并且启用了 XML 的 ContentNegotiation，版本低于 2.3.5。
2.  攻击者构造包含恶意外部实体定义的 XML 请求。
3.  服务器解析 XML 请求时，会尝试解析外部实体。
4.  如果未正确配置 XML 解析器以禁用外部实体解析，则服务器会读取本地文件或访问内部网络资源，并将内容返回给攻击者。

**项目地址:** [stefan-500/ktor-cve-2023-45612-poc](https://github.com/stefan-500/ktor-cve-2023-45612-poc)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)

---

