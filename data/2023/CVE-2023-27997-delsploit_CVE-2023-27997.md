# CVE-2023-27997

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27997-BishopFox_CVE-2023-27997-check.md](../2023/CVE-2023-27997-BishopFox_CVE-2023-27997-check.md)

## CVE-2023-27997 - FortiOS/FortiProxy SSL-VPN 堆缓冲区溢出

**漏洞编号:** CVE-2023-27997

**漏洞类型:** 堆缓冲区溢出

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: <= 7.2.4, <= 7.0.11, <= 6.4.12, <= 6.0.16; FortiProxy: <= 7.2.3, <= 7.0.9, <= 2.0.12, <= 1.2.13, <= 1.1.6

**利用条件:** 目标开启SSL-VPN服务，且可从网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27997 是 FortiOS 和 FortiProxy SSL-VPN 中的一个堆缓冲区溢出漏洞。未经身份验证的远程攻击者可以通过构造特制的请求来利用此漏洞，从而执行任意代码或命令。

**有效性评估：**

*   根据提供的漏洞库信息、搜索引擎结果（特别是 BishopFox 的博客和 GitHub 仓库），以及 CISA 的已知被利用漏洞目录，此漏洞是**有效**的，并且已经被积极利用。
*   提供的漏洞利用代码 (`CVE-2023-27997-check.py`) 是一个漏洞检测工具，用于判断目标 FortiGate SSL VPN 实例是否存在 CVE-2023-27997 漏洞。 它通过发送具有不同长度的特制请求，并基于响应时间进行统计分析来推断目标是否易受攻击。

**投毒风险评估：**

*   提供的 Python 脚本 (`CVE-2023-27997-check.py`) 的主要目的是检测漏洞，而不是利用漏洞。 它通过计算请求的统计信息进行检测，并没有发现明显的恶意代码植入行为。
*  该脚本只包含标准的Python库，以及`requests`、`struct`、`hashlib`、`sys`、`os`、`re`、`urllib3`、`scipy` 和 `numpy` 这些常见的库，没有发现用于下载或执行其他恶意payload的代码。
*   虽然该工具本身用于漏洞检测，但任何网络工具都有可能被滥用。如果攻击者使用此工具扫描大量目标，可能会对网络造成一定的影响。
*   风险评估：经分析，该脚本投毒的风险较低，约为 **5%**。这个风险主要来源于工具可能被滥用，而非工具本身包含恶意代码。

**利用方式分析：**

1.  攻击者发送特制的 HTTPS 请求到 FortiGate 或 FortiProxy 设备的 SSL-VPN 接口。
2.  `CVE-2023-27997-check.py`通过构造包含`enc`参数的POST请求，该参数的内容包含一个经过特殊编码的头部以及填充数据。头部中包含了长度信息，而填充数据用于触发缓冲区溢出。
3.  `gen_enc_hdr`函数生成加密头，该函数使用 salt 值和请求长度来生成最终发送的加密头。
4.  由于SSL-VPN处理请求时存在缺陷，特制的请求会导致堆缓冲区溢出。
5.  堆缓冲区溢出允许攻击者覆盖内存中的数据，从而可能执行任意代码或命令。攻击者可能通过此漏洞获取设备控制权。

**总结：** CVE-2023-27997 是一个高危漏洞，利用难度相对较低，容易被攻击者利用。建议受影响的用户尽快升级到安全版本。


**项目地址:** [BishopFox/CVE-2023-27997-check](https://github.com/BishopFox/CVE-2023-27997-check)

**漏洞详情:** [CVE-2023-27997](https://nvd.nist.gov/vuln/detail/CVE-2023-27997)

---

## POC #2

**来源**: [CVE-2023-27997-TechinsightsPro_ShodanFortiOS.md](../2023/CVE-2023-27997-TechinsightsPro_ShodanFortiOS.md)

## CVE-2023-27997 - FortiOS SSL-VPN 堆缓冲区溢出

**漏洞编号:** CVE-2023-27997

**漏洞类型:** 堆缓冲区溢出

**影响应用:** FortiOS, FortiProxy

**危害等级:** 高危，可远程代码执行

**影响版本:** FortiOS: <= 7.2.4, <= 7.0.11, <= 6.4.12, <= 6.2.13, <= 6.0.16; FortiProxy: <= 7.2.3, <= 7.0.9, <= 2.0.12, <= 1.2.13, <= 1.1.6

**利用条件:** 需要开启SSL-VPN服务，且目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27997 是 FortiOS 和 FortiProxy SSL-VPN 中的一个堆缓冲区溢出漏洞。攻击者可以通过构造恶意请求，利用此漏洞在目标系统上执行任意代码或命令。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞已被广泛利用。BishopFox 的博客提供了漏洞分析和利用方法，并发布了漏洞检测工具。CISA 将此漏洞列入已知被利用的漏洞目录中。综合来看，该漏洞的 PoC 利用是有效的。

**投毒风险：**
提供的 PoC 代码 `shodan_search.py` 本身是一个用于在 Shodan 上搜索特定地区内最近已修复的 FortiOS 设备的脚本。该脚本通过查询包含特定日期 `Last-Modified` 字段的设备，来判断设备是否在给定的日期范围内进行了更新。脚本本身的功能是用于安全研究和漏洞发现，而非直接攻击或植入后门。但是，使用 Shodan API 需要 API 密钥，如果攻击者获取到该密钥，可以滥用该脚本进行大规模扫描活动，或者在其他脚本中植入恶意代码。因此，存在一定的投毒风险，但风险较低。由于只是简单的信息搜集脚本，并不包含攻击载荷或者恶意操作，投毒风险评估为5%。

**利用方式：**
1.  **漏洞触发：** 攻击者发送特制的 SSL-VPN 请求，利用堆缓冲区溢出漏洞。
2.  **代码执行：** 成功溢出后，攻击者可以控制程序执行流程，注入并执行恶意代码。
3.  **权限获取：** 恶意代码可以执行系统命令，获取系统权限，甚至完全控制受影响的设备。

**项目地址:** [TechinsightsPro/ShodanFortiOS](https://github.com/TechinsightsPro/ShodanFortiOS)

**漏洞详情:** [CVE-2023-27997](https://nvd.nist.gov/vuln/detail/CVE-2023-27997)

---

## POC #3

**来源**: [CVE-2023-27997-delsploit_CVE-2023-27997.md](../2023/CVE-2023-27997-delsploit_CVE-2023-27997.md)

# CVE-2023-27997

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27997-BishopFox_CVE-2023-27997-check.md](../2023/CVE-2023-27997-BishopFox_CVE-2023-27997-check.md)

## CVE-2023-27997 - FortiOS/FortiProxy SSL-VPN 堆缓冲区溢出

**漏洞编号:** CVE-2023-27997

**漏洞类型:** 堆缓冲区溢出

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: <= 7.2.4, <= 7.0.11, <= 6.4.12, <= 6.0.16; FortiProxy: <= 7.2.3, <= 7.0.9, <= 2.0.12, <= 1.2.13, <= 1.1.6

**利用条件:** 目标开启SSL-VPN服务，且可从网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27997 是 FortiOS 和 FortiProxy SSL-VPN 中的一个堆缓冲区溢出漏洞。未经身份验证的远程攻击者可以通过构造特制的请求来利用此漏洞，从而执行任意代码或命令。

**有效性评估：**

*   根据提供的漏洞库信息、搜索引擎结果（特别是 BishopFox 的博客和 GitHub 仓库），以及 CISA 的已知被利用漏洞目录，此漏洞是**有效**的，并且已经被积极利用。
*   提供的漏洞利用代码 (`CVE-2023-27997-check.py`) 是一个漏洞检测工具，用于判断目标 FortiGate SSL VPN 实例是否存在 CVE-2023-27997 漏洞。 它通过发送具有不同长度的特制请求，并基于响应时间进行统计分析来推断目标是否易受攻击。

**投毒风险评估：**

*   提供的 Python 脚本 (`CVE-2023-27997-check.py`) 的主要目的是检测漏洞，而不是利用漏洞。 它通过计算请求的统计信息进行检测，并没有发现明显的恶意代码植入行为。
*  该脚本只包含标准的Python库，以及`requests`、`struct`、`hashlib`、`sys`、`os`、`re`、`urllib3`、`scipy` 和 `numpy` 这些常见的库，没有发现用于下载或执行其他恶意payload的代码。
*   虽然该工具本身用于漏洞检测，但任何网络工具都有可能被滥用。如果攻击者使用此工具扫描大量目标，可能会对网络造成一定的影响。
*   风险评估：经分析，该脚本投毒的风险较低，约为 **5%**。这个风险主要来源于工具可能被滥用，而非工具本身包含恶意代码。

**利用方式分析：**

1.  攻击者发送特制的 HTTPS 请求到 FortiGate 或 FortiProxy 设备的 SSL-VPN 接口。
2.  `CVE-2023-27997-check.py`通过构造包含`enc`参数的POST请求，该参数的内容包含一个经过特殊编码的头部以及填充数据。头部中包含了长度信息，而填充数据用于触发缓冲区溢出。
3.  `gen_enc_hdr`函数生成加密头，该函数使用 salt 值和请求长度来生成最终发送的加密头。
4.  由于SSL-VPN处理请求时存在缺陷，特制的请求会导致堆缓冲区溢出。
5.  堆缓冲区溢出允许攻击者覆盖内存中的数据，从而可能执行任意代码或命令。攻击者可能通过此漏洞获取设备控制权。

**总结：** CVE-2023-27997 是一个高危漏洞，利用难度相对较低，容易被攻击者利用。建议受影响的用户尽快升级到安全版本。


**项目地址:** [BishopFox/CVE-2023-27997-check](https://github.com/BishopFox/CVE-2023-27997-check)

**漏洞详情:** [CVE-2023-27997](https://nvd.nist.gov/vuln/detail/CVE-2023-27997)

---

## POC #2

**来源**: [CVE-2023-27997-TechinsightsPro_ShodanFortiOS.md](../2023/CVE-2023-27997-TechinsightsPro_ShodanFortiOS.md)

## CVE-2023-27997 - FortiOS SSL-VPN 堆缓冲区溢出

**漏洞编号:** CVE-2023-27997

**漏洞类型:** 堆缓冲区溢出

**影响应用:** FortiOS, FortiProxy

**危害等级:** 高危，可远程代码执行

**影响版本:** FortiOS: <= 7.2.4, <= 7.0.11, <= 6.4.12, <= 6.2.13, <= 6.0.16; FortiProxy: <= 7.2.3, <= 7.0.9, <= 2.0.12, <= 1.2.13, <= 1.1.6

**利用条件:** 需要开启SSL-VPN服务，且目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27997 是 FortiOS 和 FortiProxy SSL-VPN 中的一个堆缓冲区溢出漏洞。攻击者可以通过构造恶意请求，利用此漏洞在目标系统上执行任意代码或命令。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞已被广泛利用。BishopFox 的博客提供了漏洞分析和利用方法，并发布了漏洞检测工具。CISA 将此漏洞列入已知被利用的漏洞目录中。综合来看，该漏洞的 PoC 利用是有效的。

**投毒风险：**
提供的 PoC 代码 `shodan_search.py` 本身是一个用于在 Shodan 上搜索特定地区内最近已修复的 FortiOS 设备的脚本。该脚本通过查询包含特定日期 `Last-Modified` 字段的设备，来判断设备是否在给定的日期范围内进行了更新。脚本本身的功能是用于安全研究和漏洞发现，而非直接攻击或植入后门。但是，使用 Shodan API 需要 API 密钥，如果攻击者获取到该密钥，可以滥用该脚本进行大规模扫描活动，或者在其他脚本中植入恶意代码。因此，存在一定的投毒风险，但风险较低。由于只是简单的信息搜集脚本，并不包含攻击载荷或者恶意操作，投毒风险评估为5%。

**利用方式：**
1.  **漏洞触发：** 攻击者发送特制的 SSL-VPN 请求，利用堆缓冲区溢出漏洞。
2.  **代码执行：** 成功溢出后，攻击者可以控制程序执行流程，注入并执行恶意代码。
3.  **权限获取：** 恶意代码可以执行系统命令，获取系统权限，甚至完全控制受影响的设备。

**项目地址:** [TechinsightsPro/ShodanFortiOS](https://github.com/TechinsightsPro/ShodanFortiOS)

**漏洞详情:** [CVE-2023-27997](https://nvd.nist.gov/vuln/detail/CVE-2023-27997)

---

## POC #3

**来源**: [CVE-2023-27997-delsploit_CVE-2023-27997.md](../2023/CVE-2023-27997-delsploit_CVE-2023-27997.md)

# CVE-2023-27997

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27997-BishopFox_CVE-2023-27997-check.md](../2023/CVE-2023-27997-BishopFox_CVE-2023-27997-check.md)

## CVE-2023-27997 - FortiOS/FortiProxy SSL-VPN 堆缓冲区溢出

**漏洞编号:** CVE-2023-27997

**漏洞类型:** 堆缓冲区溢出

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: <= 7.2.4, <= 7.0.11, <= 6.4.12, <= 6.0.16; FortiProxy: <= 7.2.3, <= 7.0.9, <= 2.0.12, <= 1.2.13, <= 1.1.6

**利用条件:** 目标开启SSL-VPN服务，且可从网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27997 是 FortiOS 和 FortiProxy SSL-VPN 中的一个堆缓冲区溢出漏洞。未经身份验证的远程攻击者可以通过构造特制的请求来利用此漏洞，从而执行任意代码或命令。

**有效性评估：**

*   根据提供的漏洞库信息、搜索引擎结果（特别是 BishopFox 的博客和 GitHub 仓库），以及 CISA 的已知被利用漏洞目录，此漏洞是**有效**的，并且已经被积极利用。
*   提供的漏洞利用代码 (`CVE-2023-27997-check.py`) 是一个漏洞检测工具，用于判断目标 FortiGate SSL VPN 实例是否存在 CVE-2023-27997 漏洞。 它通过发送具有不同长度的特制请求，并基于响应时间进行统计分析来推断目标是否易受攻击。

**投毒风险评估：**

*   提供的 Python 脚本 (`CVE-2023-27997-check.py`) 的主要目的是检测漏洞，而不是利用漏洞。 它通过计算请求的统计信息进行检测，并没有发现明显的恶意代码植入行为。
*  该脚本只包含标准的Python库，以及`requests`、`struct`、`hashlib`、`sys`、`os`、`re`、`urllib3`、`scipy` 和 `numpy` 这些常见的库，没有发现用于下载或执行其他恶意payload的代码。
*   虽然该工具本身用于漏洞检测，但任何网络工具都有可能被滥用。如果攻击者使用此工具扫描大量目标，可能会对网络造成一定的影响。
*   风险评估：经分析，该脚本投毒的风险较低，约为 **5%**。这个风险主要来源于工具可能被滥用，而非工具本身包含恶意代码。

**利用方式分析：**

1.  攻击者发送特制的 HTTPS 请求到 FortiGate 或 FortiProxy 设备的 SSL-VPN 接口。
2.  `CVE-2023-27997-check.py`通过构造包含`enc`参数的POST请求，该参数的内容包含一个经过特殊编码的头部以及填充数据。头部中包含了长度信息，而填充数据用于触发缓冲区溢出。
3.  `gen_enc_hdr`函数生成加密头，该函数使用 salt 值和请求长度来生成最终发送的加密头。
4.  由于SSL-VPN处理请求时存在缺陷，特制的请求会导致堆缓冲区溢出。
5.  堆缓冲区溢出允许攻击者覆盖内存中的数据，从而可能执行任意代码或命令。攻击者可能通过此漏洞获取设备控制权。

**总结：** CVE-2023-27997 是一个高危漏洞，利用难度相对较低，容易被攻击者利用。建议受影响的用户尽快升级到安全版本。


**项目地址:** [BishopFox/CVE-2023-27997-check](https://github.com/BishopFox/CVE-2023-27997-check)

**漏洞详情:** [CVE-2023-27997](https://nvd.nist.gov/vuln/detail/CVE-2023-27997)

---

## POC #2

**来源**: [CVE-2023-27997-TechinsightsPro_ShodanFortiOS.md](../2023/CVE-2023-27997-TechinsightsPro_ShodanFortiOS.md)

## CVE-2023-27997 - FortiOS SSL-VPN 堆缓冲区溢出

**漏洞编号:** CVE-2023-27997

**漏洞类型:** 堆缓冲区溢出

**影响应用:** FortiOS, FortiProxy

**危害等级:** 高危，可远程代码执行

**影响版本:** FortiOS: <= 7.2.4, <= 7.0.11, <= 6.4.12, <= 6.2.13, <= 6.0.16; FortiProxy: <= 7.2.3, <= 7.0.9, <= 2.0.12, <= 1.2.13, <= 1.1.6

**利用条件:** 需要开启SSL-VPN服务，且目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27997 是 FortiOS 和 FortiProxy SSL-VPN 中的一个堆缓冲区溢出漏洞。攻击者可以通过构造恶意请求，利用此漏洞在目标系统上执行任意代码或命令。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞已被广泛利用。BishopFox 的博客提供了漏洞分析和利用方法，并发布了漏洞检测工具。CISA 将此漏洞列入已知被利用的漏洞目录中。综合来看，该漏洞的 PoC 利用是有效的。

**投毒风险：**
提供的 PoC 代码 `shodan_search.py` 本身是一个用于在 Shodan 上搜索特定地区内最近已修复的 FortiOS 设备的脚本。该脚本通过查询包含特定日期 `Last-Modified` 字段的设备，来判断设备是否在给定的日期范围内进行了更新。脚本本身的功能是用于安全研究和漏洞发现，而非直接攻击或植入后门。但是，使用 Shodan API 需要 API 密钥，如果攻击者获取到该密钥，可以滥用该脚本进行大规模扫描活动，或者在其他脚本中植入恶意代码。因此，存在一定的投毒风险，但风险较低。由于只是简单的信息搜集脚本，并不包含攻击载荷或者恶意操作，投毒风险评估为5%。

**利用方式：**
1.  **漏洞触发：** 攻击者发送特制的 SSL-VPN 请求，利用堆缓冲区溢出漏洞。
2.  **代码执行：** 成功溢出后，攻击者可以控制程序执行流程，注入并执行恶意代码。
3.  **权限获取：** 恶意代码可以执行系统命令，获取系统权限，甚至完全控制受影响的设备。

**项目地址:** [TechinsightsPro/ShodanFortiOS](https://github.com/TechinsightsPro/ShodanFortiOS)

**漏洞详情:** [CVE-2023-27997](https://nvd.nist.gov/vuln/detail/CVE-2023-27997)

---

## POC #3

**来源**: [CVE-2023-27997-delsploit_CVE-2023-27997.md](../2023/CVE-2023-27997-delsploit_CVE-2023-27997.md)

## CVE-2023-27997-FortiOS-SSL-VPN堆溢出

**漏洞编号:** CVE-2023-27997

**漏洞类型:** 堆溢出

**影响应用:** FortiOS 和 FortiProxy

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 FortiOS 7.2.4 及以下，7.0.11 及以下，6.4.12 及以下，6.0.16 及以下，FortiProxy 7.2.3 及以下，7.0.9 及以下，2.0.12 及以下，1.2 所有版本，1.1 所有版本。

**利用条件:** 需要目标系统开启SSL-VPN服务，并且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27997 是 FortiOS 和 FortiProxy SSL-VPN 中的一个堆溢出漏洞。远程攻击者可以通过构造特制的请求利用此漏洞执行任意代码或命令。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且已经被积极利用。漏洞利用代码仓库提供了一个可行的 PoC，表明该漏洞可以被成功利用。

**投毒风险分析：**

分析提供的PoC代码，初步判断投毒风险较低，大概在10%。

*   **`calc_hashes.py`**: 此脚本用于预计算一些哈希值，以便在漏洞利用过程中使用。没有发现任何可疑代码。
*   **`exploit.py`**: 此脚本是实际的漏洞利用程序。它首先生成 shellcode，然后通过堆喷射技术将 shellcode 注入到目标进程的内存中。最后，它触发漏洞，覆盖返回地址，并将执行流程重定向到 shellcode。可能存在的投毒风险在于shellcode本身，shellcode复用已有的代码，相对安全，但仍然有风险.

**漏洞利用方式：**

1.  **目标确定：** 攻击者首先需要确定目标 FortiOS 或 FortiProxy 设备，并确认其运行着受影响的版本。
2.  **哈希预计算：** 使用 `calc_hashes.py` 预计算一些哈希值。 这些哈希值用于绕过一些安全检查。
3.  **Shellcode 生成：** 生成用于反弹 shell 的 shellcode。 PoC 中使用了 `shellcode.py` 模块 (未提供全部内容)， 用于生成反向shell的shellcode,将目标设备连接到攻击者的机器。
4.  **堆喷射：** 通过建立大量SSL连接, 在堆上喷射数据, 增加shellcode执行的概率
5.  **漏洞触发：**  发送特制的 SSL-VPN 请求，触发堆溢出漏洞，覆盖返回地址。
6.  **代码执行：** 控制程序执行流程，跳转到 shellcode，从而在目标设备上执行任意代码。
7.  **反向 Shell：** Shellcode 运行后，与攻击者控制的服务器建立反向 shell 连接，从而允许攻击者远程控制目标设备。

总而言之，该漏洞是一个高危漏洞，利用难度相对较低，且存在公开可用的 PoC 代码。强烈建议受影响的用户尽快升级到安全版本。

**项目地址:** [delsploit/CVE-2023-27997](https://github.com/delsploit/CVE-2023-27997)

**漏洞详情:** [CVE-2023-27997](https://nvd.nist.gov/vuln/detail/CVE-2023-27997)

---

## POC #4

**来源**: [CVE-2023-27997-imbas007_CVE-2023-27997-Check.md](../2023/CVE-2023-27997-imbas007_CVE-2023-27997-Check.md)

## CVE-2023-27997-FortiOS/FortiProxy SSL-VPN 堆溢出

**漏洞编号:** CVE-2023-27997

**漏洞类型:** 堆溢出

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，可导致远程代码执行

**影响版本:** FortiOS: <= 7.2.4, <= 7.0.11, <= 6.4.12, <= 6.0.16; FortiProxy: <= 7.2.3, <= 7.0.9, <= 2.0.12, <= 1.2.13, <= 1.1.6

**利用条件:** 需要目标开启SSL-VPN服务，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27997 是 FortiOS 和 FortiProxy SSL-VPN 中的一个堆溢出漏洞。 

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判定此漏洞利用的**有效性较高**。
1.  漏洞库信息中，CVSS 评分高达 9.2，属于严重漏洞，并且已经被CISA列入已知被利用漏洞目录。
2.  搜索引擎结果显示，BishopFox 等安全公司已经对该漏洞进行了深入分析，并提供了漏洞验证工具和利用代码，证明了该漏洞的可利用性。
3.  提供的 Python 脚本 `CVE-2023-27997.py` 就是一个漏洞检测工具，通过发送特殊构造的请求，利用统计学方法（t 检验）判断目标是否存在漏洞。 该脚本本身就是POC。

**投毒风险：**
分析提供的 `CVE-2023-27997.py` 脚本，发现投毒的可能性**较低，大约为5%**。
代码主要功能是发送恶意请求并分析响应时间。 该脚本的主要功能是检测目标系统是否存在漏洞，并没有发现明显的恶意代码或后门。风险点在于使用统计学方式判断漏洞是否存在，攻击者可以精心构造服务器响应，使得检测脚本误判，进而攻击实际上已修复的系统。代码中包含以下安全相关的考虑：
*   禁用了urllib3 的 InsecureRequestWarning，这降低了对自签名证书等问题的警告等级，可能隐藏潜在的中间人攻击风险。
*  `reject_outliers` 函数旨在消除延迟中的异常值，从而提高检测的准确性。 然而，如果攻击者能够持续操纵响应时间，使其始终位于过滤范围之内，则可能绕过检测机制。
*   使用 `ttest_ind` 进行统计分析以区分易受攻击和已修补的系统。但是，统计结果的可靠性取决于数据质量和样本大小，攻击者可能会尝试通过噪声数据或干扰来影响这些结果。

**利用方式：**
该漏洞是由于在处理 SSL-VPN 请求时，对用户提供的长度没有进行充分的验证，导致可以写入超出堆缓冲区限制的数据。攻击者可以通过发送特制的请求，触发堆溢出，从而执行任意代码。
1.  攻击者首先需要确定目标 FortiOS/FortiProxy 设备的 SSL-VPN 服务是否开启，以及是否可以从网络上访问。
2.  通过`/remote/info`接口获取salt值。
3.  构造一个包含恶意 payload 的 HTTP POST 请求发送到`/remote/hostcheck_validate`接口，`enc`参数中包含溢出数据。
4.  溢出数据覆盖堆上的其他数据结构，最终导致任意代码执行。

总而言之，这是一个高危漏洞，利用难度相对较低，需要及时修复。

**项目地址:** [imbas007/CVE-2023-27997-Check](https://github.com/imbas007/CVE-2023-27997-Check)

**漏洞详情:** [CVE-2023-27997](https://nvd.nist.gov/vuln/detail/CVE-2023-27997)

---

## POC #5

**来源**: [CVE-2023-27997-lexfo_xortigate-cve-2023-27997.md](../2023/CVE-2023-27997-lexfo_xortigate-cve-2023-27997.md)

## CVE-2023-27997 - FortiOS SSL-VPN 堆缓冲区溢出

**漏洞编号:** CVE-2023-27997

**漏洞类型:** 堆缓冲区溢出

**影响应用:** FortiOS, FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: <= 7.2.4, <= 7.0.11, <= 6.4.12, <= 6.0.16; FortiProxy: <= 7.2.3, <= 7.0.9, <= 2.0.12, <= 1.2.13, <= 1.1.6

**利用条件:** 需要目标系统开启SSL-VPN服务，且攻击者能够发起网络请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27997 是 FortiOS 和 FortiProxy SSL-VPN 中的一个堆缓冲区溢出漏洞。未经身份验证的远程攻击者可以通过构造特制的请求来利用此漏洞，实现在目标系统上执行任意代码或命令。 

**有效性：**
根据漏洞信息和搜索结果，此漏洞已经被广泛研究，并有可用的POC代码。多个安全厂商（如Rapid7, BishopFox）发布了分析报告和利用工具。CISA也将此漏洞加入到已知被利用的漏洞列表中，表明该漏洞在野外已被利用。

提供的POC代码（xortigate-cve-2023-27997）明确指出 "It is not usable \"as-is\" and serves educational purposes."  尽管如此，它为研究人员理解和修改漏洞利用提供了基础。其中利用了MD5哈希碰撞来绕过一些验证，并通过构造特定的数据包来实现堆溢出，最终实现远程代码执行。

**投毒风险：**
代码审计显示该POC代码的功能是演示漏洞，但需要使用者自行修改和适配目标环境。虽然代码作者声明不会进行指纹识别和ROP链验证，降低了直接使用的可能性，但代码中仍然存在潜在的风险，使用者在修改代码时若引入错误或者被作者刻意埋藏后门代码(例如利用glu变量构建恶意负载),可能会导致攻击失败或执行恶意操作。仔细检查代码及依赖项，确保没有引入额外的恶意功能非常重要。从目前的证据来看，作者明确声明了代码用途，并且代码结构比较清晰，未发现明显恶意代码。 假设作者有意投毒的可能性较低，估计为10%。 风险主要在于使用者自行修改和使用过程中引入错误或被攻击。

**利用方式：**
1.  **漏洞触发：**  通过构造恶意SSL-VPN请求触发堆缓冲区溢出。
2.  **内存覆盖：**  利用溢出覆盖堆上的关键数据结构，例如SSL会话结构。
3.  **代码执行：**  通过覆盖SSL会话结构中的函数指针或其他可控变量，实现任意代码执行。 POC中提到了利用MD5进行XOR异或绕过，并构建ROP链。具体利用方式需要根据目标系统的架构和内存布局进行调整。

**总结：**
CVE-2023-27997是一个严重的安全漏洞，利用难度相对较高，但由于在野外已被利用，且存在可用的POC代码，攻击者可以基于POC进行修改和利用。使用者应该尽快修复此漏洞，并对相关系统进行安全检查。

**项目地址:** [lexfo/xortigate-cve-2023-27997](https://github.com/lexfo/xortigate-cve-2023-27997)

**漏洞详情:** [CVE-2023-27997](https://nvd.nist.gov/vuln/detail/CVE-2023-27997)

---

## POC #6

**来源**: [CVE-2023-27997-node011_CVE-2023-27997-POC.md](../2023/CVE-2023-27997-node011_CVE-2023-27997-POC.md)

## CVE-2023-27997-FortiOS/FortiProxy SSL-VPN 堆缓冲区溢出

**漏洞编号:** CVE-2023-27997

**漏洞类型:** 堆缓冲区溢出

**影响应用:** FortiOS/FortiProxy SSL-VPN

**危害等级:** 高危，可导致远程代码执行

**影响版本:** FortiOS: <= 7.2.4, <= 7.0.11, <= 6.4.12, <= 6.0.16; FortiProxy: <= 7.2.3, <= 7.0.9, <= 2.0.12, <= 1.2.13, <= 1.1.6

**利用条件:** 需要网络访问受影响的FortiOS/FortiProxy SSL-VPN服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27997 是 FortiOS 和 FortiProxy SSL-VPN 中的一个堆缓冲区溢出漏洞。未经身份验证的远程攻击者可以通过发送特制的请求利用此漏洞在受影响的系统上执行任意代码或命令。

**有效性:**
根据搜索结果和漏洞库信息，该漏洞已被积极利用，并且存在公开可用的PoC代码。Bishop Fox 等安全公司已经发布了关于如何构建漏洞利用程序的文章。Rapid7也对此漏洞进行了跟踪。

**投毒风险:**
提供的代码包含三个文件：`README.md`、`calc_hashes.py` 和 `exp.py`。`README.md` 只是一个简单的使用说明。`calc_hashes.py` 用于预先计算一些哈希值，这有助于加快漏洞利用的速度。`exp.py` 包含实际的漏洞利用代码。查看`exp.py`，其中alloc_ssl函数创建socket对象，在reverse shell的上下文中可能是投毒代码。综上，这个仓库中存在作者隐藏投毒代码的风险较低，约为10%。

**利用方式:**
1.  **漏洞触发:** 攻击者发送特制的请求到存在漏洞的FortiOS/FortiProxy SSL-VPN服务。
2.  **堆溢出:**  该请求导致堆缓冲区溢出。
3.  **代码执行:**  攻击者利用堆溢出覆盖内存中的关键数据，从而控制程序流程并执行任意代码。
4.  **反弹shell (可能的利用方式):**提供的exp.py包含反弹shell的代码，该代码利用了shellcode.py，其中包含反向连接shellcode，允许攻击者在目标系统上执行命令。

从提供的POC代码看，利用过程涉及：

*   建立SSL连接。
*   进行堆喷射，以便在堆中布置特定的数据结构。
*   计算必要的哈希值以绕过安全检查。
*   生成包含恶意代码的payload，利用堆溢出覆盖相关内存区域，达到RCE的目的。

**缓解措施:**
*   升级到不受影响的FortiOS和FortiProxy版本。
*   如果无法立即升级，可以考虑禁用SSL-VPN服务。

**项目地址:** [node011/CVE-2023-27997-POC](https://github.com/node011/CVE-2023-27997-POC)

**漏洞详情:** [CVE-2023-27997](https://nvd.nist.gov/vuln/detail/CVE-2023-27997)

---

## POC #7

**来源**: [CVE-2023-27997-onurkerembozkurt_fgt-cve-2023-27997-exploit.md](../2023/CVE-2023-27997-onurkerembozkurt_fgt-cve-2023-27997-exploit.md)

## CVE-2023-27997 - FortiOS SSL-VPN 堆溢出漏洞

**漏洞编号:** CVE-2023-27997

**漏洞类型:** 堆溢出

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.2.0-7.2.4, 7.0.0-7.0.11, 6.4.0-6.4.12, 6.2.0-6.2.14, 6.0.0-6.0.16; FortiProxy: 7.2.0-7.2.3, 7.0.0-7.0.9, 2.0.0-2.0.12, 1.2.0-1.2.13, 1.1.0-1.1.6

**利用条件:** 需要网络访问目标FortiGate设备的SSL-VPN端口 (443或10443) 

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27997 是 FortiOS 和 FortiProxy SSL-VPN 中的一个堆溢出漏洞。攻击者可以通过构造特制的请求，在无需身份验证的情况下远程执行任意代码或命令。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞已经被广泛研究和利用。BishopFox 等机构已经发布了相关的分析报告和漏洞检测工具。漏洞利用代码的存在进一步证实了其有效性。搜索引擎结果表明，该漏洞被积极利用，并且被CISA列入已知被利用的漏洞目录。

**投毒风险分析：**

提供的漏洞利用代码（README.md）描述了一个使用 ROP 链的 PoC 脚本。脚本本身的主要功能是利用漏洞执行 `ping` 命令，用于验证漏洞的存在。代码详细描述了如何获取 salt 值、生成 XOR 密钥流、构建 payload 以及 ROP 链。  虽然代码看起来相对直接，但仍然存在潜在的投毒风险：

1.  **隐蔽的后门植入：** 攻击者可能会在 ROP 链中插入恶意代码，例如下载和执行 shellcode，从而在目标系统上植入后门。虽然提供的代码只是 ping 命令，但实际利用中完全可以替换为更具破坏性的操作。
2.  **依赖项投毒：**  虽然 README 提到 `requests` 和 `urllib3` 库，如果实际的利用脚本依赖其他不常见的第三方库，这些库可能被投毒。
3.  **命令注入：** 如果目标环境对命令执行的输入过滤不严格，`ping` 命令本身可能被注入恶意参数。 尽管代码说明了适用于测试环境，依然存在风险。从代码的描述和目的来看，主要的目的是验证漏洞，而不是植入后门，因此投毒的概率较低。基于以上分析，投毒风险约为 10%。

**利用方式：**

1.  **发送 GET /remote/info 请求获取 salt 值。**
2.  **组合 salt 值和 seed 值，使用 MD5 算法生成 XOR 密钥流。**
3.  **构造包含 ROP 链的恶意 payload，利用 XOR 密钥流进行加密。**
4.  **将加密后的 payload 作为 enc 参数，发送到 /remote/hostcheck_validate 接口。**
5.  **触发堆溢出，执行 ROP 链，从而实现远程代码执行。**

攻击的关键在于通过堆溢出覆盖返回地址，然后使用 ROP 链执行恶意代码，例如运行 `system` 函数来执行任意命令。

**项目地址:** [onurkerembozkurt/fgt-cve-2023-27997-exploit](https://github.com/onurkerembozkurt/fgt-cve-2023-27997-exploit)

**漏洞详情:** [CVE-2023-27997](https://nvd.nist.gov/vuln/detail/CVE-2023-27997)

---

## POC #8

**来源**: [CVE-2023-27997-puckiestyle_cve-2023-27997.md](../2023/CVE-2023-27997-puckiestyle_cve-2023-27997.md)

## CVE-2023-27997-FortiOS/FortiProxy-堆缓冲区溢出

**漏洞编号:** CVE-2023-27997

**漏洞类型:** 堆缓冲区溢出

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** FortiOS: <= 7.2.4, <= 7.0.11, <= 6.4.12, <= 6.2.13, <= 6.0.16
FortiProxy: <= 7.2.3, <= 7.0.9, <= 2.0.12, <= 1.2.13, <= 1.1.6

**利用条件:** 需要能够访问FortiOS/FortiProxy设备的SSL-VPN服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27997是一个FortiOS和FortiProxy的SSL-VPN中存在的堆缓冲区溢出漏洞。该漏洞存在于pre-authentication阶段，允许未经身份验证的远程攻击者通过构造特定的请求来执行任意代码或命令。

**有效性:**
根据搜索结果和漏洞库信息，该漏洞已被广泛利用，并且存在公开的PoC代码。BishopFox等安全公司已经发布了漏洞分析报告和利用工具。因此，提供的PoC代码很可能是有效的。

**投毒风险:**
提供的PoC代码（cve-2023-27997.py）是一个简单的利用程序，它通过多线程向目标服务器的`/remote/logincheck`接口发送大量的POST请求，其中包含一个持续增长的`username`参数，该参数由大量的`a`字符构成。目的是触发堆缓冲区溢出。代码本身并没有明显的恶意行为或后门，主要作用是DoS和可能的RCE.

分析后判定，仓库中不存在作者隐藏的投毒代码的概率为100%。

**利用方式:**
1.  攻击者构造一个包含超长`username`参数的POST请求，发送到目标FortiOS/FortiProxy设备的`/remote/logincheck`接口。
2.  由于存在堆缓冲区溢出漏洞，该请求会导致内存溢出。
3.  攻击者可以通过精心构造的溢出数据覆盖内存中的其他区域，从而执行任意代码或命令。
4.  成功利用此漏洞后，攻击者可以完全控制受影响的FortiOS/FortiProxy设备。

**项目地址:** [puckiestyle/cve-2023-27997](https://github.com/puckiestyle/cve-2023-27997)

**漏洞详情:** [CVE-2023-27997](https://nvd.nist.gov/vuln/detail/CVE-2023-27997)

---

## POC #9

**来源**: [CVE-2023-27997-rio128128_CVE-2023-27997-POC.md](../2023/CVE-2023-27997-rio128128_CVE-2023-27997-POC.md)

## CVE-2023-27997 - FortiOS SSL-VPN 堆缓冲区溢出

**漏洞编号:** CVE-2023-27997

**漏洞类型:** 堆缓冲区溢出

**影响应用:** FortiOS, FortiProxy

**危害等级:** 严重，远程代码执行

**影响版本:** FortiOS: <= 7.2.4, <= 7.0.11, <= 6.4.12, <= 6.0.16; FortiProxy: <= 7.2.3, <= 7.0.9, <= 2.0.12, <= 1.2.13, <= 1.1.6

**利用条件:** 需要目标系统开启SSL-VPN服务，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27997是FortiOS和FortiProxy SSL-VPN中的一个堆缓冲区溢出漏洞。未经验证的远程攻击者可以通过发送特制的请求来利用此漏洞，从而实现远程代码执行。

**有效性：**

根据漏洞信息和搜索结果，该漏洞是真实存在的，并且已经被广泛利用。 BishopFox的博客提供了漏洞利用的详细分析和PoC。提供的Python脚本尝试利用此漏洞进行远程代码执行。

**投毒风险：**

该脚本包含一个反向shell功能，如果成功利用，将在目标系统上执行shell，并将shell连接到攻击者指定的IP地址和端口。 这不是漏洞本身的特性，而是PoC的后利用阶段，不能称之为投毒。 该脚本依赖于硬编码的地址`hardcoded = 0x00007fc5f128e000`， 这使得exploit的可靠性降低, 如果该地址在目标系统上不正确，则漏洞利用将失败。Content-Length 非常大，可能导致拒绝服务，增加了风险。
尽管如此，该脚本本身并没有明显的恶意代码，但存在被篡改的风险，因此投毒风险评估为10%。风险主要在于使用者可能不理解代码的全部功能，直接使用导致安全问题。反向shell功能如果被滥用，则可能导致严重的后果。

**利用方式：**

1.  **漏洞触发：** 攻击者发送一个特制的HTTP POST请求到目标系统的`/remote/error`端点。
2.  **缓冲区溢出：** 该请求包含一个超长的payload，导致在堆内存中发生缓冲区溢出。
3.  **ROP链执行：** 溢出数据覆盖堆上的内存，包括返回地址，攻击者通过ROP链控制程序执行流程，执行`execve`系统调用。
4.  **反向Shell：** `execve`调用执行/bin/python脚本，该脚本会连接到攻击者指定的IP地址和端口，从而建立反向shell连接。
5.  **参数传递：** 通过构造内存中的参数，python执行包含reverse shell的命令。

**项目地址:** [rio128128/CVE-2023-27997-POC](https://github.com/rio128128/CVE-2023-27997-POC)

**漏洞详情:** [CVE-2023-27997](https://nvd.nist.gov/vuln/detail/CVE-2023-27997)

---



---

## POC #4

**来源**: [CVE-2023-27997-imbas007_CVE-2023-27997-Check.md](../2023/CVE-2023-27997-imbas007_CVE-2023-27997-Check.md)

## CVE-2023-27997-FortiOS/FortiProxy SSL-VPN 堆溢出

**漏洞编号:** CVE-2023-27997

**漏洞类型:** 堆溢出

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，可导致远程代码执行

**影响版本:** FortiOS: <= 7.2.4, <= 7.0.11, <= 6.4.12, <= 6.0.16; FortiProxy: <= 7.2.3, <= 7.0.9, <= 2.0.12, <= 1.2.13, <= 1.1.6

**利用条件:** 需要目标开启SSL-VPN服务，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27997 是 FortiOS 和 FortiProxy SSL-VPN 中的一个堆溢出漏洞。 

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判定此漏洞利用的**有效性较高**。
1.  漏洞库信息中，CVSS 评分高达 9.2，属于严重漏洞，并且已经被CISA列入已知被利用漏洞目录。
2.  搜索引擎结果显示，BishopFox 等安全公司已经对该漏洞进行了深入分析，并提供了漏洞验证工具和利用代码，证明了该漏洞的可利用性。
3.  提供的 Python 脚本 `CVE-2023-27997.py` 就是一个漏洞检测工具，通过发送特殊构造的请求，利用统计学方法（t 检验）判断目标是否存在漏洞。 该脚本本身就是POC。

**投毒风险：**
分析提供的 `CVE-2023-27997.py` 脚本，发现投毒的可能性**较低，大约为5%**。
代码主要功能是发送恶意请求并分析响应时间。 该脚本的主要功能是检测目标系统是否存在漏洞，并没有发现明显的恶意代码或后门。风险点在于使用统计学方式判断漏洞是否存在，攻击者可以精心构造服务器响应，使得检测脚本误判，进而攻击实际上已修复的系统。代码中包含以下安全相关的考虑：
*   禁用了urllib3 的 InsecureRequestWarning，这降低了对自签名证书等问题的警告等级，可能隐藏潜在的中间人攻击风险。
*  `reject_outliers` 函数旨在消除延迟中的异常值，从而提高检测的准确性。 然而，如果攻击者能够持续操纵响应时间，使其始终位于过滤范围之内，则可能绕过检测机制。
*   使用 `ttest_ind` 进行统计分析以区分易受攻击和已修补的系统。但是，统计结果的可靠性取决于数据质量和样本大小，攻击者可能会尝试通过噪声数据或干扰来影响这些结果。

**利用方式：**
该漏洞是由于在处理 SSL-VPN 请求时，对用户提供的长度没有进行充分的验证，导致可以写入超出堆缓冲区限制的数据。攻击者可以通过发送特制的请求，触发堆溢出，从而执行任意代码。
1.  攻击者首先需要确定目标 FortiOS/FortiProxy 设备的 SSL-VPN 服务是否开启，以及是否可以从网络上访问。
2.  通过`/remote/info`接口获取salt值。
3.  构造一个包含恶意 payload 的 HTTP POST 请求发送到`/remote/hostcheck_validate`接口，`enc`参数中包含溢出数据。
4.  溢出数据覆盖堆上的其他数据结构，最终导致任意代码执行。

总而言之，这是一个高危漏洞，利用难度相对较低，需要及时修复。

**项目地址:** [imbas007/CVE-2023-27997-Check](https://github.com/imbas007/CVE-2023-27997-Check)

**漏洞详情:** [CVE-2023-27997](https://nvd.nist.gov/vuln/detail/CVE-2023-27997)

---

## POC #5

**来源**: [CVE-2023-27997-lexfo_xortigate-cve-2023-27997.md](../2023/CVE-2023-27997-lexfo_xortigate-cve-2023-27997.md)

## CVE-2023-27997 - FortiOS SSL-VPN 堆缓冲区溢出

**漏洞编号:** CVE-2023-27997

**漏洞类型:** 堆缓冲区溢出

**影响应用:** FortiOS, FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: <= 7.2.4, <= 7.0.11, <= 6.4.12, <= 6.0.16; FortiProxy: <= 7.2.3, <= 7.0.9, <= 2.0.12, <= 1.2.13, <= 1.1.6

**利用条件:** 需要目标系统开启SSL-VPN服务，且攻击者能够发起网络请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27997 是 FortiOS 和 FortiProxy SSL-VPN 中的一个堆缓冲区溢出漏洞。未经身份验证的远程攻击者可以通过构造特制的请求来利用此漏洞，实现在目标系统上执行任意代码或命令。 

**有效性：**
根据漏洞信息和搜索结果，此漏洞已经被广泛研究，并有可用的POC代码。多个安全厂商（如Rapid7, BishopFox）发布了分析报告和利用工具。CISA也将此漏洞加入到已知被利用的漏洞列表中，表明该漏洞在野外已被利用。

提供的POC代码（xortigate-cve-2023-27997）明确指出 "It is not usable \"as-is\" and serves educational purposes."  尽管如此，它为研究人员理解和修改漏洞利用提供了基础。其中利用了MD5哈希碰撞来绕过一些验证，并通过构造特定的数据包来实现堆溢出，最终实现远程代码执行。

**投毒风险：**
代码审计显示该POC代码的功能是演示漏洞，但需要使用者自行修改和适配目标环境。虽然代码作者声明不会进行指纹识别和ROP链验证，降低了直接使用的可能性，但代码中仍然存在潜在的风险，使用者在修改代码时若引入错误或者被作者刻意埋藏后门代码(例如利用glu变量构建恶意负载),可能会导致攻击失败或执行恶意操作。仔细检查代码及依赖项，确保没有引入额外的恶意功能非常重要。从目前的证据来看，作者明确声明了代码用途，并且代码结构比较清晰，未发现明显恶意代码。 假设作者有意投毒的可能性较低，估计为10%。 风险主要在于使用者自行修改和使用过程中引入错误或被攻击。

**利用方式：**
1.  **漏洞触发：**  通过构造恶意SSL-VPN请求触发堆缓冲区溢出。
2.  **内存覆盖：**  利用溢出覆盖堆上的关键数据结构，例如SSL会话结构。
3.  **代码执行：**  通过覆盖SSL会话结构中的函数指针或其他可控变量，实现任意代码执行。 POC中提到了利用MD5进行XOR异或绕过，并构建ROP链。具体利用方式需要根据目标系统的架构和内存布局进行调整。

**总结：**
CVE-2023-27997是一个严重的安全漏洞，利用难度相对较高，但由于在野外已被利用，且存在可用的POC代码，攻击者可以基于POC进行修改和利用。使用者应该尽快修复此漏洞，并对相关系统进行安全检查。

**项目地址:** [lexfo/xortigate-cve-2023-27997](https://github.com/lexfo/xortigate-cve-2023-27997)

**漏洞详情:** [CVE-2023-27997](https://nvd.nist.gov/vuln/detail/CVE-2023-27997)

---

## POC #6

**来源**: [CVE-2023-27997-node011_CVE-2023-27997-POC.md](../2023/CVE-2023-27997-node011_CVE-2023-27997-POC.md)

## CVE-2023-27997-FortiOS/FortiProxy SSL-VPN 堆缓冲区溢出

**漏洞编号:** CVE-2023-27997

**漏洞类型:** 堆缓冲区溢出

**影响应用:** FortiOS/FortiProxy SSL-VPN

**危害等级:** 高危，可导致远程代码执行

**影响版本:** FortiOS: <= 7.2.4, <= 7.0.11, <= 6.4.12, <= 6.0.16; FortiProxy: <= 7.2.3, <= 7.0.9, <= 2.0.12, <= 1.2.13, <= 1.1.6

**利用条件:** 需要网络访问受影响的FortiOS/FortiProxy SSL-VPN服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27997 是 FortiOS 和 FortiProxy SSL-VPN 中的一个堆缓冲区溢出漏洞。未经身份验证的远程攻击者可以通过发送特制的请求利用此漏洞在受影响的系统上执行任意代码或命令。

**有效性:**
根据搜索结果和漏洞库信息，该漏洞已被积极利用，并且存在公开可用的PoC代码。Bishop Fox 等安全公司已经发布了关于如何构建漏洞利用程序的文章。Rapid7也对此漏洞进行了跟踪。

**投毒风险:**
提供的代码包含三个文件：`README.md`、`calc_hashes.py` 和 `exp.py`。`README.md` 只是一个简单的使用说明。`calc_hashes.py` 用于预先计算一些哈希值，这有助于加快漏洞利用的速度。`exp.py` 包含实际的漏洞利用代码。查看`exp.py`，其中alloc_ssl函数创建socket对象，在reverse shell的上下文中可能是投毒代码。综上，这个仓库中存在作者隐藏投毒代码的风险较低，约为10%。

**利用方式:**
1.  **漏洞触发:** 攻击者发送特制的请求到存在漏洞的FortiOS/FortiProxy SSL-VPN服务。
2.  **堆溢出:**  该请求导致堆缓冲区溢出。
3.  **代码执行:**  攻击者利用堆溢出覆盖内存中的关键数据，从而控制程序流程并执行任意代码。
4.  **反弹shell (可能的利用方式):**提供的exp.py包含反弹shell的代码，该代码利用了shellcode.py，其中包含反向连接shellcode，允许攻击者在目标系统上执行命令。

从提供的POC代码看，利用过程涉及：

*   建立SSL连接。
*   进行堆喷射，以便在堆中布置特定的数据结构。
*   计算必要的哈希值以绕过安全检查。
*   生成包含恶意代码的payload，利用堆溢出覆盖相关内存区域，达到RCE的目的。

**缓解措施:**
*   升级到不受影响的FortiOS和FortiProxy版本。
*   如果无法立即升级，可以考虑禁用SSL-VPN服务。

**项目地址:** [node011/CVE-2023-27997-POC](https://github.com/node011/CVE-2023-27997-POC)

**漏洞详情:** [CVE-2023-27997](https://nvd.nist.gov/vuln/detail/CVE-2023-27997)

---

## POC #7

**来源**: [CVE-2023-27997-onurkerembozkurt_fgt-cve-2023-27997-exploit.md](../2023/CVE-2023-27997-onurkerembozkurt_fgt-cve-2023-27997-exploit.md)

## CVE-2023-27997 - FortiOS SSL-VPN 堆溢出漏洞

**漏洞编号:** CVE-2023-27997

**漏洞类型:** 堆溢出

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.2.0-7.2.4, 7.0.0-7.0.11, 6.4.0-6.4.12, 6.2.0-6.2.14, 6.0.0-6.0.16; FortiProxy: 7.2.0-7.2.3, 7.0.0-7.0.9, 2.0.0-2.0.12, 1.2.0-1.2.13, 1.1.0-1.1.6

**利用条件:** 需要网络访问目标FortiGate设备的SSL-VPN端口 (443或10443) 

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27997 是 FortiOS 和 FortiProxy SSL-VPN 中的一个堆溢出漏洞。攻击者可以通过构造特制的请求，在无需身份验证的情况下远程执行任意代码或命令。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞已经被广泛研究和利用。BishopFox 等机构已经发布了相关的分析报告和漏洞检测工具。漏洞利用代码的存在进一步证实了其有效性。搜索引擎结果表明，该漏洞被积极利用，并且被CISA列入已知被利用的漏洞目录。

**投毒风险分析：**

提供的漏洞利用代码（README.md）描述了一个使用 ROP 链的 PoC 脚本。脚本本身的主要功能是利用漏洞执行 `ping` 命令，用于验证漏洞的存在。代码详细描述了如何获取 salt 值、生成 XOR 密钥流、构建 payload 以及 ROP 链。  虽然代码看起来相对直接，但仍然存在潜在的投毒风险：

1.  **隐蔽的后门植入：** 攻击者可能会在 ROP 链中插入恶意代码，例如下载和执行 shellcode，从而在目标系统上植入后门。虽然提供的代码只是 ping 命令，但实际利用中完全可以替换为更具破坏性的操作。
2.  **依赖项投毒：**  虽然 README 提到 `requests` 和 `urllib3` 库，如果实际的利用脚本依赖其他不常见的第三方库，这些库可能被投毒。
3.  **命令注入：** 如果目标环境对命令执行的输入过滤不严格，`ping` 命令本身可能被注入恶意参数。 尽管代码说明了适用于测试环境，依然存在风险。从代码的描述和目的来看，主要的目的是验证漏洞，而不是植入后门，因此投毒的概率较低。基于以上分析，投毒风险约为 10%。

**利用方式：**

1.  **发送 GET /remote/info 请求获取 salt 值。**
2.  **组合 salt 值和 seed 值，使用 MD5 算法生成 XOR 密钥流。**
3.  **构造包含 ROP 链的恶意 payload，利用 XOR 密钥流进行加密。**
4.  **将加密后的 payload 作为 enc 参数，发送到 /remote/hostcheck_validate 接口。**
5.  **触发堆溢出，执行 ROP 链，从而实现远程代码执行。**

攻击的关键在于通过堆溢出覆盖返回地址，然后使用 ROP 链执行恶意代码，例如运行 `system` 函数来执行任意命令。

**项目地址:** [onurkerembozkurt/fgt-cve-2023-27997-exploit](https://github.com/onurkerembozkurt/fgt-cve-2023-27997-exploit)

**漏洞详情:** [CVE-2023-27997](https://nvd.nist.gov/vuln/detail/CVE-2023-27997)

---

## POC #8

**来源**: [CVE-2023-27997-puckiestyle_cve-2023-27997.md](../2023/CVE-2023-27997-puckiestyle_cve-2023-27997.md)

## CVE-2023-27997-FortiOS/FortiProxy-堆缓冲区溢出

**漏洞编号:** CVE-2023-27997

**漏洞类型:** 堆缓冲区溢出

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** FortiOS: <= 7.2.4, <= 7.0.11, <= 6.4.12, <= 6.2.13, <= 6.0.16
FortiProxy: <= 7.2.3, <= 7.0.9, <= 2.0.12, <= 1.2.13, <= 1.1.6

**利用条件:** 需要能够访问FortiOS/FortiProxy设备的SSL-VPN服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27997是一个FortiOS和FortiProxy的SSL-VPN中存在的堆缓冲区溢出漏洞。该漏洞存在于pre-authentication阶段，允许未经身份验证的远程攻击者通过构造特定的请求来执行任意代码或命令。

**有效性:**
根据搜索结果和漏洞库信息，该漏洞已被广泛利用，并且存在公开的PoC代码。BishopFox等安全公司已经发布了漏洞分析报告和利用工具。因此，提供的PoC代码很可能是有效的。

**投毒风险:**
提供的PoC代码（cve-2023-27997.py）是一个简单的利用程序，它通过多线程向目标服务器的`/remote/logincheck`接口发送大量的POST请求，其中包含一个持续增长的`username`参数，该参数由大量的`a`字符构成。目的是触发堆缓冲区溢出。代码本身并没有明显的恶意行为或后门，主要作用是DoS和可能的RCE.

分析后判定，仓库中不存在作者隐藏的投毒代码的概率为100%。

**利用方式:**
1.  攻击者构造一个包含超长`username`参数的POST请求，发送到目标FortiOS/FortiProxy设备的`/remote/logincheck`接口。
2.  由于存在堆缓冲区溢出漏洞，该请求会导致内存溢出。
3.  攻击者可以通过精心构造的溢出数据覆盖内存中的其他区域，从而执行任意代码或命令。
4.  成功利用此漏洞后，攻击者可以完全控制受影响的FortiOS/FortiProxy设备。

**项目地址:** [puckiestyle/cve-2023-27997](https://github.com/puckiestyle/cve-2023-27997)

**漏洞详情:** [CVE-2023-27997](https://nvd.nist.gov/vuln/detail/CVE-2023-27997)

---

## POC #9

**来源**: [CVE-2023-27997-rio128128_CVE-2023-27997-POC.md](../2023/CVE-2023-27997-rio128128_CVE-2023-27997-POC.md)

## CVE-2023-27997 - FortiOS SSL-VPN 堆缓冲区溢出

**漏洞编号:** CVE-2023-27997

**漏洞类型:** 堆缓冲区溢出

**影响应用:** FortiOS, FortiProxy

**危害等级:** 严重，远程代码执行

**影响版本:** FortiOS: <= 7.2.4, <= 7.0.11, <= 6.4.12, <= 6.0.16; FortiProxy: <= 7.2.3, <= 7.0.9, <= 2.0.12, <= 1.2.13, <= 1.1.6

**利用条件:** 需要目标系统开启SSL-VPN服务，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27997是FortiOS和FortiProxy SSL-VPN中的一个堆缓冲区溢出漏洞。未经验证的远程攻击者可以通过发送特制的请求来利用此漏洞，从而实现远程代码执行。

**有效性：**

根据漏洞信息和搜索结果，该漏洞是真实存在的，并且已经被广泛利用。 BishopFox的博客提供了漏洞利用的详细分析和PoC。提供的Python脚本尝试利用此漏洞进行远程代码执行。

**投毒风险：**

该脚本包含一个反向shell功能，如果成功利用，将在目标系统上执行shell，并将shell连接到攻击者指定的IP地址和端口。 这不是漏洞本身的特性，而是PoC的后利用阶段，不能称之为投毒。 该脚本依赖于硬编码的地址`hardcoded = 0x00007fc5f128e000`， 这使得exploit的可靠性降低, 如果该地址在目标系统上不正确，则漏洞利用将失败。Content-Length 非常大，可能导致拒绝服务，增加了风险。
尽管如此，该脚本本身并没有明显的恶意代码，但存在被篡改的风险，因此投毒风险评估为10%。风险主要在于使用者可能不理解代码的全部功能，直接使用导致安全问题。反向shell功能如果被滥用，则可能导致严重的后果。

**利用方式：**

1.  **漏洞触发：** 攻击者发送一个特制的HTTP POST请求到目标系统的`/remote/error`端点。
2.  **缓冲区溢出：** 该请求包含一个超长的payload，导致在堆内存中发生缓冲区溢出。
3.  **ROP链执行：** 溢出数据覆盖堆上的内存，包括返回地址，攻击者通过ROP链控制程序执行流程，执行`execve`系统调用。
4.  **反向Shell：** `execve`调用执行/bin/python脚本，该脚本会连接到攻击者指定的IP地址和端口，从而建立反向shell连接。
5.  **参数传递：** 通过构造内存中的参数，python执行包含reverse shell的命令。

**项目地址:** [rio128128/CVE-2023-27997-POC](https://github.com/rio128128/CVE-2023-27997-POC)

**漏洞详情:** [CVE-2023-27997](https://nvd.nist.gov/vuln/detail/CVE-2023-27997)

---



---

## POC #4

**来源**: [CVE-2023-27997-imbas007_CVE-2023-27997-Check.md](../2023/CVE-2023-27997-imbas007_CVE-2023-27997-Check.md)

## CVE-2023-27997-FortiOS/FortiProxy SSL-VPN 堆溢出

**漏洞编号:** CVE-2023-27997

**漏洞类型:** 堆溢出

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，可导致远程代码执行

**影响版本:** FortiOS: <= 7.2.4, <= 7.0.11, <= 6.4.12, <= 6.0.16; FortiProxy: <= 7.2.3, <= 7.0.9, <= 2.0.12, <= 1.2.13, <= 1.1.6

**利用条件:** 需要目标开启SSL-VPN服务，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27997 是 FortiOS 和 FortiProxy SSL-VPN 中的一个堆溢出漏洞。 

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判定此漏洞利用的**有效性较高**。
1.  漏洞库信息中，CVSS 评分高达 9.2，属于严重漏洞，并且已经被CISA列入已知被利用漏洞目录。
2.  搜索引擎结果显示，BishopFox 等安全公司已经对该漏洞进行了深入分析，并提供了漏洞验证工具和利用代码，证明了该漏洞的可利用性。
3.  提供的 Python 脚本 `CVE-2023-27997.py` 就是一个漏洞检测工具，通过发送特殊构造的请求，利用统计学方法（t 检验）判断目标是否存在漏洞。 该脚本本身就是POC。

**投毒风险：**
分析提供的 `CVE-2023-27997.py` 脚本，发现投毒的可能性**较低，大约为5%**。
代码主要功能是发送恶意请求并分析响应时间。 该脚本的主要功能是检测目标系统是否存在漏洞，并没有发现明显的恶意代码或后门。风险点在于使用统计学方式判断漏洞是否存在，攻击者可以精心构造服务器响应，使得检测脚本误判，进而攻击实际上已修复的系统。代码中包含以下安全相关的考虑：
*   禁用了urllib3 的 InsecureRequestWarning，这降低了对自签名证书等问题的警告等级，可能隐藏潜在的中间人攻击风险。
*  `reject_outliers` 函数旨在消除延迟中的异常值，从而提高检测的准确性。 然而，如果攻击者能够持续操纵响应时间，使其始终位于过滤范围之内，则可能绕过检测机制。
*   使用 `ttest_ind` 进行统计分析以区分易受攻击和已修补的系统。但是，统计结果的可靠性取决于数据质量和样本大小，攻击者可能会尝试通过噪声数据或干扰来影响这些结果。

**利用方式：**
该漏洞是由于在处理 SSL-VPN 请求时，对用户提供的长度没有进行充分的验证，导致可以写入超出堆缓冲区限制的数据。攻击者可以通过发送特制的请求，触发堆溢出，从而执行任意代码。
1.  攻击者首先需要确定目标 FortiOS/FortiProxy 设备的 SSL-VPN 服务是否开启，以及是否可以从网络上访问。
2.  通过`/remote/info`接口获取salt值。
3.  构造一个包含恶意 payload 的 HTTP POST 请求发送到`/remote/hostcheck_validate`接口，`enc`参数中包含溢出数据。
4.  溢出数据覆盖堆上的其他数据结构，最终导致任意代码执行。

总而言之，这是一个高危漏洞，利用难度相对较低，需要及时修复。

**项目地址:** [imbas007/CVE-2023-27997-Check](https://github.com/imbas007/CVE-2023-27997-Check)

**漏洞详情:** [CVE-2023-27997](https://nvd.nist.gov/vuln/detail/CVE-2023-27997)

---

## POC #5

**来源**: [CVE-2023-27997-lexfo_xortigate-cve-2023-27997.md](../2023/CVE-2023-27997-lexfo_xortigate-cve-2023-27997.md)

## CVE-2023-27997 - FortiOS SSL-VPN 堆缓冲区溢出

**漏洞编号:** CVE-2023-27997

**漏洞类型:** 堆缓冲区溢出

**影响应用:** FortiOS, FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: <= 7.2.4, <= 7.0.11, <= 6.4.12, <= 6.0.16; FortiProxy: <= 7.2.3, <= 7.0.9, <= 2.0.12, <= 1.2.13, <= 1.1.6

**利用条件:** 需要目标系统开启SSL-VPN服务，且攻击者能够发起网络请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27997 是 FortiOS 和 FortiProxy SSL-VPN 中的一个堆缓冲区溢出漏洞。未经身份验证的远程攻击者可以通过构造特制的请求来利用此漏洞，实现在目标系统上执行任意代码或命令。 

**有效性：**
根据漏洞信息和搜索结果，此漏洞已经被广泛研究，并有可用的POC代码。多个安全厂商（如Rapid7, BishopFox）发布了分析报告和利用工具。CISA也将此漏洞加入到已知被利用的漏洞列表中，表明该漏洞在野外已被利用。

提供的POC代码（xortigate-cve-2023-27997）明确指出 "It is not usable \"as-is\" and serves educational purposes."  尽管如此，它为研究人员理解和修改漏洞利用提供了基础。其中利用了MD5哈希碰撞来绕过一些验证，并通过构造特定的数据包来实现堆溢出，最终实现远程代码执行。

**投毒风险：**
代码审计显示该POC代码的功能是演示漏洞，但需要使用者自行修改和适配目标环境。虽然代码作者声明不会进行指纹识别和ROP链验证，降低了直接使用的可能性，但代码中仍然存在潜在的风险，使用者在修改代码时若引入错误或者被作者刻意埋藏后门代码(例如利用glu变量构建恶意负载),可能会导致攻击失败或执行恶意操作。仔细检查代码及依赖项，确保没有引入额外的恶意功能非常重要。从目前的证据来看，作者明确声明了代码用途，并且代码结构比较清晰，未发现明显恶意代码。 假设作者有意投毒的可能性较低，估计为10%。 风险主要在于使用者自行修改和使用过程中引入错误或被攻击。

**利用方式：**
1.  **漏洞触发：**  通过构造恶意SSL-VPN请求触发堆缓冲区溢出。
2.  **内存覆盖：**  利用溢出覆盖堆上的关键数据结构，例如SSL会话结构。
3.  **代码执行：**  通过覆盖SSL会话结构中的函数指针或其他可控变量，实现任意代码执行。 POC中提到了利用MD5进行XOR异或绕过，并构建ROP链。具体利用方式需要根据目标系统的架构和内存布局进行调整。

**总结：**
CVE-2023-27997是一个严重的安全漏洞，利用难度相对较高，但由于在野外已被利用，且存在可用的POC代码，攻击者可以基于POC进行修改和利用。使用者应该尽快修复此漏洞，并对相关系统进行安全检查。

**项目地址:** [lexfo/xortigate-cve-2023-27997](https://github.com/lexfo/xortigate-cve-2023-27997)

**漏洞详情:** [CVE-2023-27997](https://nvd.nist.gov/vuln/detail/CVE-2023-27997)

---

## POC #6

**来源**: [CVE-2023-27997-node011_CVE-2023-27997-POC.md](../2023/CVE-2023-27997-node011_CVE-2023-27997-POC.md)

## CVE-2023-27997-FortiOS/FortiProxy SSL-VPN 堆缓冲区溢出

**漏洞编号:** CVE-2023-27997

**漏洞类型:** 堆缓冲区溢出

**影响应用:** FortiOS/FortiProxy SSL-VPN

**危害等级:** 高危，可导致远程代码执行

**影响版本:** FortiOS: <= 7.2.4, <= 7.0.11, <= 6.4.12, <= 6.0.16; FortiProxy: <= 7.2.3, <= 7.0.9, <= 2.0.12, <= 1.2.13, <= 1.1.6

**利用条件:** 需要网络访问受影响的FortiOS/FortiProxy SSL-VPN服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27997 是 FortiOS 和 FortiProxy SSL-VPN 中的一个堆缓冲区溢出漏洞。未经身份验证的远程攻击者可以通过发送特制的请求利用此漏洞在受影响的系统上执行任意代码或命令。

**有效性:**
根据搜索结果和漏洞库信息，该漏洞已被积极利用，并且存在公开可用的PoC代码。Bishop Fox 等安全公司已经发布了关于如何构建漏洞利用程序的文章。Rapid7也对此漏洞进行了跟踪。

**投毒风险:**
提供的代码包含三个文件：`README.md`、`calc_hashes.py` 和 `exp.py`。`README.md` 只是一个简单的使用说明。`calc_hashes.py` 用于预先计算一些哈希值，这有助于加快漏洞利用的速度。`exp.py` 包含实际的漏洞利用代码。查看`exp.py`，其中alloc_ssl函数创建socket对象，在reverse shell的上下文中可能是投毒代码。综上，这个仓库中存在作者隐藏投毒代码的风险较低，约为10%。

**利用方式:**
1.  **漏洞触发:** 攻击者发送特制的请求到存在漏洞的FortiOS/FortiProxy SSL-VPN服务。
2.  **堆溢出:**  该请求导致堆缓冲区溢出。
3.  **代码执行:**  攻击者利用堆溢出覆盖内存中的关键数据，从而控制程序流程并执行任意代码。
4.  **反弹shell (可能的利用方式):**提供的exp.py包含反弹shell的代码，该代码利用了shellcode.py，其中包含反向连接shellcode，允许攻击者在目标系统上执行命令。

从提供的POC代码看，利用过程涉及：

*   建立SSL连接。
*   进行堆喷射，以便在堆中布置特定的数据结构。
*   计算必要的哈希值以绕过安全检查。
*   生成包含恶意代码的payload，利用堆溢出覆盖相关内存区域，达到RCE的目的。

**缓解措施:**
*   升级到不受影响的FortiOS和FortiProxy版本。
*   如果无法立即升级，可以考虑禁用SSL-VPN服务。

**项目地址:** [node011/CVE-2023-27997-POC](https://github.com/node011/CVE-2023-27997-POC)

**漏洞详情:** [CVE-2023-27997](https://nvd.nist.gov/vuln/detail/CVE-2023-27997)

---

## POC #7

**来源**: [CVE-2023-27997-onurkerembozkurt_fgt-cve-2023-27997-exploit.md](../2023/CVE-2023-27997-onurkerembozkurt_fgt-cve-2023-27997-exploit.md)

## CVE-2023-27997 - FortiOS SSL-VPN 堆溢出漏洞

**漏洞编号:** CVE-2023-27997

**漏洞类型:** 堆溢出

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.2.0-7.2.4, 7.0.0-7.0.11, 6.4.0-6.4.12, 6.2.0-6.2.14, 6.0.0-6.0.16; FortiProxy: 7.2.0-7.2.3, 7.0.0-7.0.9, 2.0.0-2.0.12, 1.2.0-1.2.13, 1.1.0-1.1.6

**利用条件:** 需要网络访问目标FortiGate设备的SSL-VPN端口 (443或10443) 

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27997 是 FortiOS 和 FortiProxy SSL-VPN 中的一个堆溢出漏洞。攻击者可以通过构造特制的请求，在无需身份验证的情况下远程执行任意代码或命令。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞已经被广泛研究和利用。BishopFox 等机构已经发布了相关的分析报告和漏洞检测工具。漏洞利用代码的存在进一步证实了其有效性。搜索引擎结果表明，该漏洞被积极利用，并且被CISA列入已知被利用的漏洞目录。

**投毒风险分析：**

提供的漏洞利用代码（README.md）描述了一个使用 ROP 链的 PoC 脚本。脚本本身的主要功能是利用漏洞执行 `ping` 命令，用于验证漏洞的存在。代码详细描述了如何获取 salt 值、生成 XOR 密钥流、构建 payload 以及 ROP 链。  虽然代码看起来相对直接，但仍然存在潜在的投毒风险：

1.  **隐蔽的后门植入：** 攻击者可能会在 ROP 链中插入恶意代码，例如下载和执行 shellcode，从而在目标系统上植入后门。虽然提供的代码只是 ping 命令，但实际利用中完全可以替换为更具破坏性的操作。
2.  **依赖项投毒：**  虽然 README 提到 `requests` 和 `urllib3` 库，如果实际的利用脚本依赖其他不常见的第三方库，这些库可能被投毒。
3.  **命令注入：** 如果目标环境对命令执行的输入过滤不严格，`ping` 命令本身可能被注入恶意参数。 尽管代码说明了适用于测试环境，依然存在风险。从代码的描述和目的来看，主要的目的是验证漏洞，而不是植入后门，因此投毒的概率较低。基于以上分析，投毒风险约为 10%。

**利用方式：**

1.  **发送 GET /remote/info 请求获取 salt 值。**
2.  **组合 salt 值和 seed 值，使用 MD5 算法生成 XOR 密钥流。**
3.  **构造包含 ROP 链的恶意 payload，利用 XOR 密钥流进行加密。**
4.  **将加密后的 payload 作为 enc 参数，发送到 /remote/hostcheck_validate 接口。**
5.  **触发堆溢出，执行 ROP 链，从而实现远程代码执行。**

攻击的关键在于通过堆溢出覆盖返回地址，然后使用 ROP 链执行恶意代码，例如运行 `system` 函数来执行任意命令。

**项目地址:** [onurkerembozkurt/fgt-cve-2023-27997-exploit](https://github.com/onurkerembozkurt/fgt-cve-2023-27997-exploit)

**漏洞详情:** [CVE-2023-27997](https://nvd.nist.gov/vuln/detail/CVE-2023-27997)

---

## POC #8

**来源**: [CVE-2023-27997-puckiestyle_cve-2023-27997.md](../2023/CVE-2023-27997-puckiestyle_cve-2023-27997.md)

## CVE-2023-27997-FortiOS/FortiProxy-堆缓冲区溢出

**漏洞编号:** CVE-2023-27997

**漏洞类型:** 堆缓冲区溢出

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** FortiOS: <= 7.2.4, <= 7.0.11, <= 6.4.12, <= 6.2.13, <= 6.0.16
FortiProxy: <= 7.2.3, <= 7.0.9, <= 2.0.12, <= 1.2.13, <= 1.1.6

**利用条件:** 需要能够访问FortiOS/FortiProxy设备的SSL-VPN服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27997是一个FortiOS和FortiProxy的SSL-VPN中存在的堆缓冲区溢出漏洞。该漏洞存在于pre-authentication阶段，允许未经身份验证的远程攻击者通过构造特定的请求来执行任意代码或命令。

**有效性:**
根据搜索结果和漏洞库信息，该漏洞已被广泛利用，并且存在公开的PoC代码。BishopFox等安全公司已经发布了漏洞分析报告和利用工具。因此，提供的PoC代码很可能是有效的。

**投毒风险:**
提供的PoC代码（cve-2023-27997.py）是一个简单的利用程序，它通过多线程向目标服务器的`/remote/logincheck`接口发送大量的POST请求，其中包含一个持续增长的`username`参数，该参数由大量的`a`字符构成。目的是触发堆缓冲区溢出。代码本身并没有明显的恶意行为或后门，主要作用是DoS和可能的RCE.

分析后判定，仓库中不存在作者隐藏的投毒代码的概率为100%。

**利用方式:**
1.  攻击者构造一个包含超长`username`参数的POST请求，发送到目标FortiOS/FortiProxy设备的`/remote/logincheck`接口。
2.  由于存在堆缓冲区溢出漏洞，该请求会导致内存溢出。
3.  攻击者可以通过精心构造的溢出数据覆盖内存中的其他区域，从而执行任意代码或命令。
4.  成功利用此漏洞后，攻击者可以完全控制受影响的FortiOS/FortiProxy设备。

**项目地址:** [puckiestyle/cve-2023-27997](https://github.com/puckiestyle/cve-2023-27997)

**漏洞详情:** [CVE-2023-27997](https://nvd.nist.gov/vuln/detail/CVE-2023-27997)

---

## POC #9

**来源**: [CVE-2023-27997-rio128128_CVE-2023-27997-POC.md](../2023/CVE-2023-27997-rio128128_CVE-2023-27997-POC.md)

## CVE-2023-27997 - FortiOS SSL-VPN 堆缓冲区溢出

**漏洞编号:** CVE-2023-27997

**漏洞类型:** 堆缓冲区溢出

**影响应用:** FortiOS, FortiProxy

**危害等级:** 严重，远程代码执行

**影响版本:** FortiOS: <= 7.2.4, <= 7.0.11, <= 6.4.12, <= 6.0.16; FortiProxy: <= 7.2.3, <= 7.0.9, <= 2.0.12, <= 1.2.13, <= 1.1.6

**利用条件:** 需要目标系统开启SSL-VPN服务，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27997是FortiOS和FortiProxy SSL-VPN中的一个堆缓冲区溢出漏洞。未经验证的远程攻击者可以通过发送特制的请求来利用此漏洞，从而实现远程代码执行。

**有效性：**

根据漏洞信息和搜索结果，该漏洞是真实存在的，并且已经被广泛利用。 BishopFox的博客提供了漏洞利用的详细分析和PoC。提供的Python脚本尝试利用此漏洞进行远程代码执行。

**投毒风险：**

该脚本包含一个反向shell功能，如果成功利用，将在目标系统上执行shell，并将shell连接到攻击者指定的IP地址和端口。 这不是漏洞本身的特性，而是PoC的后利用阶段，不能称之为投毒。 该脚本依赖于硬编码的地址`hardcoded = 0x00007fc5f128e000`， 这使得exploit的可靠性降低, 如果该地址在目标系统上不正确，则漏洞利用将失败。Content-Length 非常大，可能导致拒绝服务，增加了风险。
尽管如此，该脚本本身并没有明显的恶意代码，但存在被篡改的风险，因此投毒风险评估为10%。风险主要在于使用者可能不理解代码的全部功能，直接使用导致安全问题。反向shell功能如果被滥用，则可能导致严重的后果。

**利用方式：**

1.  **漏洞触发：** 攻击者发送一个特制的HTTP POST请求到目标系统的`/remote/error`端点。
2.  **缓冲区溢出：** 该请求包含一个超长的payload，导致在堆内存中发生缓冲区溢出。
3.  **ROP链执行：** 溢出数据覆盖堆上的内存，包括返回地址，攻击者通过ROP链控制程序执行流程，执行`execve`系统调用。
4.  **反向Shell：** `execve`调用执行/bin/python脚本，该脚本会连接到攻击者指定的IP地址和端口，从而建立反向shell连接。
5.  **参数传递：** 通过构造内存中的参数，python执行包含reverse shell的命令。

**项目地址:** [rio128128/CVE-2023-27997-POC](https://github.com/rio128128/CVE-2023-27997-POC)

**漏洞详情:** [CVE-2023-27997](https://nvd.nist.gov/vuln/detail/CVE-2023-27997)

---

