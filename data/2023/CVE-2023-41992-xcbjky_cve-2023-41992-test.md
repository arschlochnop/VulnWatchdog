# CVE-2023-41992

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-41992-karzanWang_CVE-2023-41992.md](../2023/CVE-2023-41992-karzanWang_CVE-2023-41992.md)

## CVE-2023-41992 - iOS/macOS 本地权限提升

**漏洞编号:** CVE-2023-41992

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** XNU Kernel

**危害等级:** 高危，允许本地攻击者提升权限

**影响版本:** macOS Monterey < 12.7, iOS and iPadOS < 16.7, macOS Ventura < 13.6

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-41992是一个存在于XNU内核中的本地权限提升漏洞。Apple已知该漏洞在iOS 16.7之前的版本中被积极利用。漏洞修复方案包括改进的检查机制，已在macOS Monterey 12.7、iOS/iPadOS 16.7以及macOS Ventura 13.6中修复。

**漏洞利用方式：**

1.  漏洞的根源在于`ipc_right_destroy`函数中，当销毁IPC权限时，如果存在“early-return”路径（例如，端口被pinned），会导致`ie_bits`中的类型信息被擦除。
2.  当调用`mach_thread_self()`时，内核会进入`thread_self_trap`，最终调用`ipc_right_copyout`。
3.  在`ipc_right_copyout`函数中，如果`msgt_name`为`MACH_MSG_TYPE_PORT_SEND`，则会检查entry类型。如果entry类型为空，则代码`entry->ie_bits = (bits | MACH_PORT_TYPE_SEND) + 1;`可能导致整数溢出。
4.  如果`urefs`达到0xffff且`ie_bits`中没有类型信息，则溢出可能导致entry类型变为`MACH_PORT_RIGHT_RECEIVE`。
5. PoC代码通过创建特定条件，触发内核crash，以此证明漏洞存在。

**有效性：**

根据漏洞描述和PoC代码，该漏洞是有效的，并且已被在野利用。PoC代码展示了一种触发内核崩溃的方法，虽然不直接提供权限提升，但证实了漏洞的存在。

**投毒风险：**

PoC代码主要由README.md和Objective-C代码组成。README.md描述了漏洞原理和利用思路。Objective-C代码实现了一个简单的应用，旨在触发内核漏洞。代码中没有发现明显的恶意行为或后门代码。但仍然存在一定风险：PoC代码的作者在文档中提到，希望有人可以成功利用此漏洞，作者对漏洞本身的利用表示不确定，暗示可能存在某些未知的利用细节或限制。 考虑到PoC依赖于内核级别的操作，误用或不完全理解可能导致设备不稳定甚至无法启动。因此，仍不能排除潜在的风险。

风险评估：虽然代码本身没有发现恶意行为，但由于内核利用的复杂性和潜在的破坏性，仍然存在一定的投毒风险，占比约为10%。这主要是因为利用代码的编写者可能隐藏了未公开的细节，或者PoC本身可能存在其他未知的副作用，导致利用过程中发生意外情况。

**项目地址:** [karzanWang/CVE-2023-41992](https://github.com/karzanWang/CVE-2023-41992)

**漏洞详情:** [CVE-2023-41992](https://nvd.nist.gov/vuln/detail/CVE-2023-41992)

---

## POC #2

**来源**: [CVE-2023-41992-xcbjky_cve-2023-41992-test.md](../2023/CVE-2023-41992-xcbjky_cve-2023-41992-test.md)

# CVE-2023-41992

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-41992-karzanWang_CVE-2023-41992.md](../2023/CVE-2023-41992-karzanWang_CVE-2023-41992.md)

## CVE-2023-41992 - iOS/macOS 本地权限提升

**漏洞编号:** CVE-2023-41992

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** XNU Kernel

**危害等级:** 高危，允许本地攻击者提升权限

**影响版本:** macOS Monterey < 12.7, iOS and iPadOS < 16.7, macOS Ventura < 13.6

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-41992是一个存在于XNU内核中的本地权限提升漏洞。Apple已知该漏洞在iOS 16.7之前的版本中被积极利用。漏洞修复方案包括改进的检查机制，已在macOS Monterey 12.7、iOS/iPadOS 16.7以及macOS Ventura 13.6中修复。

**漏洞利用方式：**

1.  漏洞的根源在于`ipc_right_destroy`函数中，当销毁IPC权限时，如果存在“early-return”路径（例如，端口被pinned），会导致`ie_bits`中的类型信息被擦除。
2.  当调用`mach_thread_self()`时，内核会进入`thread_self_trap`，最终调用`ipc_right_copyout`。
3.  在`ipc_right_copyout`函数中，如果`msgt_name`为`MACH_MSG_TYPE_PORT_SEND`，则会检查entry类型。如果entry类型为空，则代码`entry->ie_bits = (bits | MACH_PORT_TYPE_SEND) + 1;`可能导致整数溢出。
4.  如果`urefs`达到0xffff且`ie_bits`中没有类型信息，则溢出可能导致entry类型变为`MACH_PORT_RIGHT_RECEIVE`。
5. PoC代码通过创建特定条件，触发内核crash，以此证明漏洞存在。

**有效性：**

根据漏洞描述和PoC代码，该漏洞是有效的，并且已被在野利用。PoC代码展示了一种触发内核崩溃的方法，虽然不直接提供权限提升，但证实了漏洞的存在。

**投毒风险：**

PoC代码主要由README.md和Objective-C代码组成。README.md描述了漏洞原理和利用思路。Objective-C代码实现了一个简单的应用，旨在触发内核漏洞。代码中没有发现明显的恶意行为或后门代码。但仍然存在一定风险：PoC代码的作者在文档中提到，希望有人可以成功利用此漏洞，作者对漏洞本身的利用表示不确定，暗示可能存在某些未知的利用细节或限制。 考虑到PoC依赖于内核级别的操作，误用或不完全理解可能导致设备不稳定甚至无法启动。因此，仍不能排除潜在的风险。

风险评估：虽然代码本身没有发现恶意行为，但由于内核利用的复杂性和潜在的破坏性，仍然存在一定的投毒风险，占比约为10%。这主要是因为利用代码的编写者可能隐藏了未公开的细节，或者PoC本身可能存在其他未知的副作用，导致利用过程中发生意外情况。

**项目地址:** [karzanWang/CVE-2023-41992](https://github.com/karzanWang/CVE-2023-41992)

**漏洞详情:** [CVE-2023-41992](https://nvd.nist.gov/vuln/detail/CVE-2023-41992)

---

## POC #2

**来源**: [CVE-2023-41992-xcbjky_cve-2023-41992-test.md](../2023/CVE-2023-41992-xcbjky_cve-2023-41992-test.md)

# CVE-2023-41992

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-41992-karzanWang_CVE-2023-41992.md](../2023/CVE-2023-41992-karzanWang_CVE-2023-41992.md)

## CVE-2023-41992 - iOS/macOS 本地权限提升

**漏洞编号:** CVE-2023-41992

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** XNU Kernel

**危害等级:** 高危，允许本地攻击者提升权限

**影响版本:** macOS Monterey < 12.7, iOS and iPadOS < 16.7, macOS Ventura < 13.6

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-41992是一个存在于XNU内核中的本地权限提升漏洞。Apple已知该漏洞在iOS 16.7之前的版本中被积极利用。漏洞修复方案包括改进的检查机制，已在macOS Monterey 12.7、iOS/iPadOS 16.7以及macOS Ventura 13.6中修复。

**漏洞利用方式：**

1.  漏洞的根源在于`ipc_right_destroy`函数中，当销毁IPC权限时，如果存在“early-return”路径（例如，端口被pinned），会导致`ie_bits`中的类型信息被擦除。
2.  当调用`mach_thread_self()`时，内核会进入`thread_self_trap`，最终调用`ipc_right_copyout`。
3.  在`ipc_right_copyout`函数中，如果`msgt_name`为`MACH_MSG_TYPE_PORT_SEND`，则会检查entry类型。如果entry类型为空，则代码`entry->ie_bits = (bits | MACH_PORT_TYPE_SEND) + 1;`可能导致整数溢出。
4.  如果`urefs`达到0xffff且`ie_bits`中没有类型信息，则溢出可能导致entry类型变为`MACH_PORT_RIGHT_RECEIVE`。
5. PoC代码通过创建特定条件，触发内核crash，以此证明漏洞存在。

**有效性：**

根据漏洞描述和PoC代码，该漏洞是有效的，并且已被在野利用。PoC代码展示了一种触发内核崩溃的方法，虽然不直接提供权限提升，但证实了漏洞的存在。

**投毒风险：**

PoC代码主要由README.md和Objective-C代码组成。README.md描述了漏洞原理和利用思路。Objective-C代码实现了一个简单的应用，旨在触发内核漏洞。代码中没有发现明显的恶意行为或后门代码。但仍然存在一定风险：PoC代码的作者在文档中提到，希望有人可以成功利用此漏洞，作者对漏洞本身的利用表示不确定，暗示可能存在某些未知的利用细节或限制。 考虑到PoC依赖于内核级别的操作，误用或不完全理解可能导致设备不稳定甚至无法启动。因此，仍不能排除潜在的风险。

风险评估：虽然代码本身没有发现恶意行为，但由于内核利用的复杂性和潜在的破坏性，仍然存在一定的投毒风险，占比约为10%。这主要是因为利用代码的编写者可能隐藏了未公开的细节，或者PoC本身可能存在其他未知的副作用，导致利用过程中发生意外情况。

**项目地址:** [karzanWang/CVE-2023-41992](https://github.com/karzanWang/CVE-2023-41992)

**漏洞详情:** [CVE-2023-41992](https://nvd.nist.gov/vuln/detail/CVE-2023-41992)

---

## POC #2

**来源**: [CVE-2023-41992-xcbjky_cve-2023-41992-test.md](../2023/CVE-2023-41992-xcbjky_cve-2023-41992-test.md)

# CVE-2023-41992

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-41992-karzanWang_CVE-2023-41992.md](../2023/CVE-2023-41992-karzanWang_CVE-2023-41992.md)

## CVE-2023-41992 - iOS/macOS 本地权限提升

**漏洞编号:** CVE-2023-41992

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** XNU Kernel

**危害等级:** 高危，允许本地攻击者提升权限

**影响版本:** macOS Monterey < 12.7, iOS and iPadOS < 16.7, macOS Ventura < 13.6

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-41992是一个存在于XNU内核中的本地权限提升漏洞。Apple已知该漏洞在iOS 16.7之前的版本中被积极利用。漏洞修复方案包括改进的检查机制，已在macOS Monterey 12.7、iOS/iPadOS 16.7以及macOS Ventura 13.6中修复。

**漏洞利用方式：**

1.  漏洞的根源在于`ipc_right_destroy`函数中，当销毁IPC权限时，如果存在“early-return”路径（例如，端口被pinned），会导致`ie_bits`中的类型信息被擦除。
2.  当调用`mach_thread_self()`时，内核会进入`thread_self_trap`，最终调用`ipc_right_copyout`。
3.  在`ipc_right_copyout`函数中，如果`msgt_name`为`MACH_MSG_TYPE_PORT_SEND`，则会检查entry类型。如果entry类型为空，则代码`entry->ie_bits = (bits | MACH_PORT_TYPE_SEND) + 1;`可能导致整数溢出。
4.  如果`urefs`达到0xffff且`ie_bits`中没有类型信息，则溢出可能导致entry类型变为`MACH_PORT_RIGHT_RECEIVE`。
5. PoC代码通过创建特定条件，触发内核crash，以此证明漏洞存在。

**有效性：**

根据漏洞描述和PoC代码，该漏洞是有效的，并且已被在野利用。PoC代码展示了一种触发内核崩溃的方法，虽然不直接提供权限提升，但证实了漏洞的存在。

**投毒风险：**

PoC代码主要由README.md和Objective-C代码组成。README.md描述了漏洞原理和利用思路。Objective-C代码实现了一个简单的应用，旨在触发内核漏洞。代码中没有发现明显的恶意行为或后门代码。但仍然存在一定风险：PoC代码的作者在文档中提到，希望有人可以成功利用此漏洞，作者对漏洞本身的利用表示不确定，暗示可能存在某些未知的利用细节或限制。 考虑到PoC依赖于内核级别的操作，误用或不完全理解可能导致设备不稳定甚至无法启动。因此，仍不能排除潜在的风险。

风险评估：虽然代码本身没有发现恶意行为，但由于内核利用的复杂性和潜在的破坏性，仍然存在一定的投毒风险，占比约为10%。这主要是因为利用代码的编写者可能隐藏了未公开的细节，或者PoC本身可能存在其他未知的副作用，导致利用过程中发生意外情况。

**项目地址:** [karzanWang/CVE-2023-41992](https://github.com/karzanWang/CVE-2023-41992)

**漏洞详情:** [CVE-2023-41992](https://nvd.nist.gov/vuln/detail/CVE-2023-41992)

---

## POC #2

**来源**: [CVE-2023-41992-xcbjky_cve-2023-41992-test.md](../2023/CVE-2023-41992-xcbjky_cve-2023-41992-test.md)

# CVE-2023-41992

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-41992-karzanWang_CVE-2023-41992.md](../2023/CVE-2023-41992-karzanWang_CVE-2023-41992.md)

## CVE-2023-41992 - iOS/macOS 本地权限提升

**漏洞编号:** CVE-2023-41992

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** XNU Kernel

**危害等级:** 高危，允许本地攻击者提升权限

**影响版本:** macOS Monterey < 12.7, iOS and iPadOS < 16.7, macOS Ventura < 13.6

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-41992是一个存在于XNU内核中的本地权限提升漏洞。Apple已知该漏洞在iOS 16.7之前的版本中被积极利用。漏洞修复方案包括改进的检查机制，已在macOS Monterey 12.7、iOS/iPadOS 16.7以及macOS Ventura 13.6中修复。

**漏洞利用方式：**

1.  漏洞的根源在于`ipc_right_destroy`函数中，当销毁IPC权限时，如果存在“early-return”路径（例如，端口被pinned），会导致`ie_bits`中的类型信息被擦除。
2.  当调用`mach_thread_self()`时，内核会进入`thread_self_trap`，最终调用`ipc_right_copyout`。
3.  在`ipc_right_copyout`函数中，如果`msgt_name`为`MACH_MSG_TYPE_PORT_SEND`，则会检查entry类型。如果entry类型为空，则代码`entry->ie_bits = (bits | MACH_PORT_TYPE_SEND) + 1;`可能导致整数溢出。
4.  如果`urefs`达到0xffff且`ie_bits`中没有类型信息，则溢出可能导致entry类型变为`MACH_PORT_RIGHT_RECEIVE`。
5. PoC代码通过创建特定条件，触发内核crash，以此证明漏洞存在。

**有效性：**

根据漏洞描述和PoC代码，该漏洞是有效的，并且已被在野利用。PoC代码展示了一种触发内核崩溃的方法，虽然不直接提供权限提升，但证实了漏洞的存在。

**投毒风险：**

PoC代码主要由README.md和Objective-C代码组成。README.md描述了漏洞原理和利用思路。Objective-C代码实现了一个简单的应用，旨在触发内核漏洞。代码中没有发现明显的恶意行为或后门代码。但仍然存在一定风险：PoC代码的作者在文档中提到，希望有人可以成功利用此漏洞，作者对漏洞本身的利用表示不确定，暗示可能存在某些未知的利用细节或限制。 考虑到PoC依赖于内核级别的操作，误用或不完全理解可能导致设备不稳定甚至无法启动。因此，仍不能排除潜在的风险。

风险评估：虽然代码本身没有发现恶意行为，但由于内核利用的复杂性和潜在的破坏性，仍然存在一定的投毒风险，占比约为10%。这主要是因为利用代码的编写者可能隐藏了未公开的细节，或者PoC本身可能存在其他未知的副作用，导致利用过程中发生意外情况。

**项目地址:** [karzanWang/CVE-2023-41992](https://github.com/karzanWang/CVE-2023-41992)

**漏洞详情:** [CVE-2023-41992](https://nvd.nist.gov/vuln/detail/CVE-2023-41992)

---

## POC #2

**来源**: [CVE-2023-41992-xcbjky_cve-2023-41992-test.md](../2023/CVE-2023-41992-xcbjky_cve-2023-41992-test.md)

# CVE-2023-41992

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-41992-karzanWang_CVE-2023-41992.md](../2023/CVE-2023-41992-karzanWang_CVE-2023-41992.md)

## CVE-2023-41992 - iOS/macOS 本地权限提升

**漏洞编号:** CVE-2023-41992

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** XNU Kernel

**危害等级:** 高危，允许本地攻击者提升权限

**影响版本:** macOS Monterey < 12.7, iOS and iPadOS < 16.7, macOS Ventura < 13.6

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-41992是一个存在于XNU内核中的本地权限提升漏洞。Apple已知该漏洞在iOS 16.7之前的版本中被积极利用。漏洞修复方案包括改进的检查机制，已在macOS Monterey 12.7、iOS/iPadOS 16.7以及macOS Ventura 13.6中修复。

**漏洞利用方式：**

1.  漏洞的根源在于`ipc_right_destroy`函数中，当销毁IPC权限时，如果存在“early-return”路径（例如，端口被pinned），会导致`ie_bits`中的类型信息被擦除。
2.  当调用`mach_thread_self()`时，内核会进入`thread_self_trap`，最终调用`ipc_right_copyout`。
3.  在`ipc_right_copyout`函数中，如果`msgt_name`为`MACH_MSG_TYPE_PORT_SEND`，则会检查entry类型。如果entry类型为空，则代码`entry->ie_bits = (bits | MACH_PORT_TYPE_SEND) + 1;`可能导致整数溢出。
4.  如果`urefs`达到0xffff且`ie_bits`中没有类型信息，则溢出可能导致entry类型变为`MACH_PORT_RIGHT_RECEIVE`。
5. PoC代码通过创建特定条件，触发内核crash，以此证明漏洞存在。

**有效性：**

根据漏洞描述和PoC代码，该漏洞是有效的，并且已被在野利用。PoC代码展示了一种触发内核崩溃的方法，虽然不直接提供权限提升，但证实了漏洞的存在。

**投毒风险：**

PoC代码主要由README.md和Objective-C代码组成。README.md描述了漏洞原理和利用思路。Objective-C代码实现了一个简单的应用，旨在触发内核漏洞。代码中没有发现明显的恶意行为或后门代码。但仍然存在一定风险：PoC代码的作者在文档中提到，希望有人可以成功利用此漏洞，作者对漏洞本身的利用表示不确定，暗示可能存在某些未知的利用细节或限制。 考虑到PoC依赖于内核级别的操作，误用或不完全理解可能导致设备不稳定甚至无法启动。因此，仍不能排除潜在的风险。

风险评估：虽然代码本身没有发现恶意行为，但由于内核利用的复杂性和潜在的破坏性，仍然存在一定的投毒风险，占比约为10%。这主要是因为利用代码的编写者可能隐藏了未公开的细节，或者PoC本身可能存在其他未知的副作用，导致利用过程中发生意外情况。

**项目地址:** [karzanWang/CVE-2023-41992](https://github.com/karzanWang/CVE-2023-41992)

**漏洞详情:** [CVE-2023-41992](https://nvd.nist.gov/vuln/detail/CVE-2023-41992)

---

## POC #2

**来源**: [CVE-2023-41992-xcbjky_cve-2023-41992-test.md](../2023/CVE-2023-41992-xcbjky_cve-2023-41992-test.md)

# CVE-2023-41992

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-41992-karzanWang_CVE-2023-41992.md](../2023/CVE-2023-41992-karzanWang_CVE-2023-41992.md)

## CVE-2023-41992 - iOS/macOS 本地权限提升

**漏洞编号:** CVE-2023-41992

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** XNU Kernel

**危害等级:** 高危，允许本地攻击者提升权限

**影响版本:** macOS Monterey < 12.7, iOS and iPadOS < 16.7, macOS Ventura < 13.6

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-41992是一个存在于XNU内核中的本地权限提升漏洞。Apple已知该漏洞在iOS 16.7之前的版本中被积极利用。漏洞修复方案包括改进的检查机制，已在macOS Monterey 12.7、iOS/iPadOS 16.7以及macOS Ventura 13.6中修复。

**漏洞利用方式：**

1.  漏洞的根源在于`ipc_right_destroy`函数中，当销毁IPC权限时，如果存在“early-return”路径（例如，端口被pinned），会导致`ie_bits`中的类型信息被擦除。
2.  当调用`mach_thread_self()`时，内核会进入`thread_self_trap`，最终调用`ipc_right_copyout`。
3.  在`ipc_right_copyout`函数中，如果`msgt_name`为`MACH_MSG_TYPE_PORT_SEND`，则会检查entry类型。如果entry类型为空，则代码`entry->ie_bits = (bits | MACH_PORT_TYPE_SEND) + 1;`可能导致整数溢出。
4.  如果`urefs`达到0xffff且`ie_bits`中没有类型信息，则溢出可能导致entry类型变为`MACH_PORT_RIGHT_RECEIVE`。
5. PoC代码通过创建特定条件，触发内核crash，以此证明漏洞存在。

**有效性：**

根据漏洞描述和PoC代码，该漏洞是有效的，并且已被在野利用。PoC代码展示了一种触发内核崩溃的方法，虽然不直接提供权限提升，但证实了漏洞的存在。

**投毒风险：**

PoC代码主要由README.md和Objective-C代码组成。README.md描述了漏洞原理和利用思路。Objective-C代码实现了一个简单的应用，旨在触发内核漏洞。代码中没有发现明显的恶意行为或后门代码。但仍然存在一定风险：PoC代码的作者在文档中提到，希望有人可以成功利用此漏洞，作者对漏洞本身的利用表示不确定，暗示可能存在某些未知的利用细节或限制。 考虑到PoC依赖于内核级别的操作，误用或不完全理解可能导致设备不稳定甚至无法启动。因此，仍不能排除潜在的风险。

风险评估：虽然代码本身没有发现恶意行为，但由于内核利用的复杂性和潜在的破坏性，仍然存在一定的投毒风险，占比约为10%。这主要是因为利用代码的编写者可能隐藏了未公开的细节，或者PoC本身可能存在其他未知的副作用，导致利用过程中发生意外情况。

**项目地址:** [karzanWang/CVE-2023-41992](https://github.com/karzanWang/CVE-2023-41992)

**漏洞详情:** [CVE-2023-41992](https://nvd.nist.gov/vuln/detail/CVE-2023-41992)

---

## POC #2

**来源**: [CVE-2023-41992-xcbjky_cve-2023-41992-test.md](../2023/CVE-2023-41992-xcbjky_cve-2023-41992-test.md)

# CVE-2023-41992

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-41992-karzanWang_CVE-2023-41992.md](../2023/CVE-2023-41992-karzanWang_CVE-2023-41992.md)

## CVE-2023-41992 - iOS/macOS 本地权限提升

**漏洞编号:** CVE-2023-41992

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** XNU Kernel

**危害等级:** 高危，允许本地攻击者提升权限

**影响版本:** macOS Monterey < 12.7, iOS and iPadOS < 16.7, macOS Ventura < 13.6

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-41992是一个存在于XNU内核中的本地权限提升漏洞。Apple已知该漏洞在iOS 16.7之前的版本中被积极利用。漏洞修复方案包括改进的检查机制，已在macOS Monterey 12.7、iOS/iPadOS 16.7以及macOS Ventura 13.6中修复。

**漏洞利用方式：**

1.  漏洞的根源在于`ipc_right_destroy`函数中，当销毁IPC权限时，如果存在“early-return”路径（例如，端口被pinned），会导致`ie_bits`中的类型信息被擦除。
2.  当调用`mach_thread_self()`时，内核会进入`thread_self_trap`，最终调用`ipc_right_copyout`。
3.  在`ipc_right_copyout`函数中，如果`msgt_name`为`MACH_MSG_TYPE_PORT_SEND`，则会检查entry类型。如果entry类型为空，则代码`entry->ie_bits = (bits | MACH_PORT_TYPE_SEND) + 1;`可能导致整数溢出。
4.  如果`urefs`达到0xffff且`ie_bits`中没有类型信息，则溢出可能导致entry类型变为`MACH_PORT_RIGHT_RECEIVE`。
5. PoC代码通过创建特定条件，触发内核crash，以此证明漏洞存在。

**有效性：**

根据漏洞描述和PoC代码，该漏洞是有效的，并且已被在野利用。PoC代码展示了一种触发内核崩溃的方法，虽然不直接提供权限提升，但证实了漏洞的存在。

**投毒风险：**

PoC代码主要由README.md和Objective-C代码组成。README.md描述了漏洞原理和利用思路。Objective-C代码实现了一个简单的应用，旨在触发内核漏洞。代码中没有发现明显的恶意行为或后门代码。但仍然存在一定风险：PoC代码的作者在文档中提到，希望有人可以成功利用此漏洞，作者对漏洞本身的利用表示不确定，暗示可能存在某些未知的利用细节或限制。 考虑到PoC依赖于内核级别的操作，误用或不完全理解可能导致设备不稳定甚至无法启动。因此，仍不能排除潜在的风险。

风险评估：虽然代码本身没有发现恶意行为，但由于内核利用的复杂性和潜在的破坏性，仍然存在一定的投毒风险，占比约为10%。这主要是因为利用代码的编写者可能隐藏了未公开的细节，或者PoC本身可能存在其他未知的副作用，导致利用过程中发生意外情况。

**项目地址:** [karzanWang/CVE-2023-41992](https://github.com/karzanWang/CVE-2023-41992)

**漏洞详情:** [CVE-2023-41992](https://nvd.nist.gov/vuln/detail/CVE-2023-41992)

---

## POC #2

**来源**: [CVE-2023-41992-xcbjky_cve-2023-41992-test.md](../2023/CVE-2023-41992-xcbjky_cve-2023-41992-test.md)

## CVE-2023-41992

**漏洞编号:** CVE-2023-41992

**漏洞类型:** 本地提权

**影响应用:** macOS, iOS, iPadOS

**危害等级:** 高危，本地攻击者可能提升权限

**影响版本:** macOS Monterey < 12.7, iOS and iPadOS < 16.7, macOS Ventura < 13.6

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-41992 是一个本地提权漏洞，影响多个 Apple 操作系统。根据漏洞库信息，该漏洞已在 macOS Monterey 12.7、iOS 16.7 和 iPadOS 16.7、macOS Ventura 13.6 中修复。Apple 已经意识到此问题可能已被利用。搜索结果显示，安全研究员分享了该漏洞的PoC。提供的PoC代码是一个 Xcode 项目，名为 CVE202341992PoC，这表明利用方式是通过编译并运行该项目，可能触发漏洞导致权限提升。

**有效性评估：** 根据搜索结果中 "Security researcher shares PoC for CVE-2023-41992 local ..."，表明该PoC可能有效，但需要进一步验证。Readme文件显示开发者水平有限，侧面说明该POC不一定稳定可靠。

**投毒风险分析：** 提供的代码片段是 Xcode 项目文件（project.pbxproj）和README.md，并没有发现明显的恶意代码。Xcode项目本身是编译后才能执行的，恶意代码可以隐藏在源代码中，但是本代码片段主要描述项目结构，没有包含具体实现。因此，无法直接判断是否存在投毒代码。根据目前信息判断投毒风险较低，估计为0%。由于作者的水平有限，投毒的可能性不能完全排除，但目前没有直接证据。

**利用方式分析：** 该漏洞是本地提权漏洞，攻击者需要在目标系统上执行代码。利用方式可能包括：

1.  用户下载并编译运行提供的 Xcode 项目。
2.  PoC 代码利用漏洞，获得更高的权限。
3.  攻击者利用提升的权限执行恶意操作，例如安装恶意软件，窃取敏感数据等。

总之，该漏洞是一个本地提权漏洞，需要本地访问权限才能利用。提供的 PoC 代码可能有效，但需要进一步验证。目前没有发现明显的投毒代码，但仍需谨慎。

**项目地址:** [xcbjky/cve-2023-41992-test](https://github.com/xcbjky/cve-2023-41992-test)

**漏洞详情:** [CVE-2023-41992](https://nvd.nist.gov/vuln/detail/CVE-2023-41992)

---



---



---



---



---



---



---



---

