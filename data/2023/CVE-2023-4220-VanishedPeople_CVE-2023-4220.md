## CVE-2023-4220 - Chamilo LMS RCE (远程代码执行)

**漏洞编号:** CVE-2023-4220

**漏洞类型:** RCE (远程代码执行)

**影响应用:** Chamilo LMS

**危害等级:** High (高危)

**CVSS评分:** 8.1 (CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** <= 1.11.24

**利用条件:** 无需身份验证，需通过网络访问受影响的组件（main/inc/lib/javascript/bigupload/inc/bigUpload.php）

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞存在于Chamilo LMS的BigUpload组件中。攻击者可以通过向`main/inc/lib/javascript/bigupload/inc/bigUpload.php`端点发送构造的恶意请求来利用此漏洞。该组件在处理大文件上传时，未能对上传的文件类型和目标路径进行严格的身份验证和安全校验，允许未经身份验证的用户上传PHP脚本并将其存储在可访问的Web目录中。POC代码展示了完整的自动化流程：首先通过Python的requests库向漏洞路径发送POST请求，利用bigUpload.php的文件分片合并逻辑将恶意Webshell上传至服务器；随后通过访问上传后的PHP路径触发恶意代码。此POC逻辑清晰，使用了标准的argparse进行参数配置，具备较高的实战转换率，在1.11.x版本的环境下具有极高的触发成功率，能够直接获取服务器控制权。利用步骤：1. 确认目标Chamilo版本在1.11.24以下。2. 定位漏洞端点：`http://target/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。3. 准备恶意PHP Payload（如webshell）。4. 执行POC脚本，脚本会将Payload分片或直接作为大文件提交给bigUpload.php。5. 脚本自动探测默认上传目录（通常为/main/default_course_document/webshell.php）。6. 访问该URL确认RCE成功。投毒风险分析：该POC项目代码结构透明，主要使用了Python的requests和argparse等标准库，未发现明显的代码混淆或加密逻辑。通过对README和代码逻辑的静态审查，其主要行为是构造HTTP分段上传请求，不存在静默下载外部二进制文件、修改本地系统hosts文件或反弹Shell至第三方未知IP等典型投毒特征。虽然该漏洞利用涉及到‘大文件上传’，但POC本身并不包含恶意的大型占位文件。风险点在于该项目所在的GitHub仓库是否会被后续修改，以及在使用pip安装requirements.txt时是否存在供应链污染风险（如依赖于恶意的第三方包名）。目前分析，代码逻辑处于安全可控范围，投毒风险评级为15%，属于较低水平，主要来源于GitHub下载源的常规安全考量。建议在隔离的沙箱环境或虚拟机中运行此POC，并对所有外发网络流量进行截获审查，以防范潜在的隐蔽外传行为。

**项目地址:** [https://github.com/VanishedPeople/CVE-2023-4220.git](https://github.com/VanishedPeople/CVE-2023-4220.git)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)
