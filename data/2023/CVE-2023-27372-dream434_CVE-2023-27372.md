## CVE-2023-27372 - SPIP (互联网发布系统) RCE (远程代码执行)

**漏洞编号:** CVE-2023-27372

**漏洞类型:** RCE (远程代码执行)

**影响应用:** SPIP (互联网发布系统)

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** SPIP < 4.2.1, 3.2.17 及更早版本

**利用条件:** 远程网络访问，无需身份验证

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

【POC有效性分析】该漏洞源于SPIP在处理‘oubli’（忘记密码）表单时的序列化处理不当。攻击者可以通过向spip.php?page=spip_pass发送精心构造的Payload，触发PHP反序列化或直接的代码注入。提供的POC代码逻辑清晰且具有较高的实战价值。首先，脚本访问目标站点的密码找回页面，利用BeautifulSoup库解析HTML响应，提取名为‘formulaire_action_args’的CSRF Token（即formulaire_action_args值）。这是后续POST请求能够被服务器接受的关键步骤。接着，POC构造了一个包含PHP system函数调用的序列化Payload：`s:N:"<?php system('whoami'); ?>";`。最后，脚本通过POST请求将该Payload发送至服务器。若漏洞存在，服务器将执行system('whoami')并将结果返回。代码中使用了requests库处理网络请求，逻辑上实现了从Token获取到Payload注入的闭环。由于该漏洞处于预认证阶段（Pre-authentication），攻击者无需登录即可远程执行代码，危害极大。POC中通过验证返回内容是否包含执行结果来判定成功与否，具备很强的自动化扫描能力。【利用步骤】1. 环境准备：安装Python 3及依赖项requests、bs4和colorama。2. 目标识别：确认目标SPIP版本处于受影响范围（< 4.2.1）。3. 初始访问：访问目标URL的/spip.php?page=spip_pass获取必要的表单Token。4. Payload构造：根据目标PHP环境构造合法的序列化字符串，例如执行id或whoami。5. 提交利用：发送POST请求，将Token和Payload作为参数传入，观察HTTP响应中是否包含命令执行的回显内容。【投毒风险分析】经过对提供的POC代码进行静态审计，该脚本展现出较低的投毒风险。代码实现采用了标准的Python库（requests, bs4, colorama），没有使用混淆（Obfuscation）技术。其网络交互逻辑仅限于与用户指定的目标URL进行通信，未发现任何向第三方受控服务器发送敏感信息（如本地凭据、环境变量）的隐蔽请求。脚本结构简单，核心逻辑在于HTTP头部的模拟和POST参数的构造，不存在诸如base64编码的可执行Payload解码执行、下载并执行远程恶意脚本（Webshell或僵尸网络程序）的行为。README文件中提到的安装步骤虽然包含git clone，但这是GitHub存储库的常规使用方式。唯一的小风险点在于此类漏洞公开后，网络上可能出现伪装成该CVE修复工具的二进制文件，但当前的Python脚本本身是安全且透明的。开发者甚至在代码中添加了警告注释，强调了合法合规使用的重要性。综合评估，该POC是一个典型的安全研究辅助脚本，不含恶意后门。

**项目地址:** [https://github.com/dream434/CVE-2023-27372](https://github.com/dream434/CVE-2023-27372)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)
