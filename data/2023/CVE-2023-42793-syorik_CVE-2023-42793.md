## CVE-2023-42793 - JetBrains TeamCity RCE (远程代码执行)

**漏洞编号:** CVE-2023-42793

**漏洞类型:** RCE (远程代码执行)

**影响应用:** JetBrains TeamCity

**危害等级:** 严重 (CRITICAL)

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** TeamCity 2023.05.3 之前的版本

**利用条件:** 无需认证，可通过网络直接访问 TeamCity 服务器

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该 Go 语言编写的 POC 代码展示了针对 CVE-2023-42793 的完整攻击链。该漏洞的核心在于权限绕过，允许未授权用户访问特定接口。POC 通过三个关键阶段实现利用：首先，利用漏洞访问 `/app/rest/users/{id}/tokens/RPC2` 接口，为指定用户（通常是管理员）生成一个新的身份验证令牌，从而绕过认证。其次，通过 `EnableDebugMode` 函数，利用生成的令牌向 `/admin/dataDir.html` 发送请求，修改 `internal.properties` 配置文件，开启 `rest.debug.processes.enable=true` 调试模式。最后，通过 `ExecuteCommand` 函数访问 `/app/rest/debug/processes` 接口，利用 `exePath` 参数执行任意系统命令。代码逻辑清晰，使用了标准的 HTTP 请求处理方式，能够直接在受影响的环境中验证漏洞的存在。利用步骤：1. 识别目标 TeamCity 服务器版本；2. 调用 `Authenticate` 方法获取指定用户的 REST API 令牌；3. 调用 `EnableDebugMode` 方法在服务器端开启调试进程执行权限；4. 调用 `ExecuteCommand` 方法通过 `exePath` 和 `params` 传入想要执行的 shell 命令并获取回显结果。投毒风险分析：该 POC 代码主要使用 Go 标准库（如 net/http, encoding/json）编写，未见明显混淆或加密处理。代码中包含 Taskfile.yml 用于自动化编译，这在合法安全研究工具中很常见。其主要行为是与 TeamCity 的 REST API 交互。虽然该代码不含明显的恶意后门或窃取本地凭据的逻辑，但由于其提供了“一键式”获取管理员权限并执行命令的能力，属于高威力利用脚本。在投毒风险方面，由于代码结构简单且未引入第三方不可信依赖，恶意攻击者很难在不引起注意的情况下植入后门。然而，使用者应注意，由于该漏洞已被俄罗斯 SVR 相关的 APT 29 等组织在实战中大规模利用，运行此类 POC 时必须在隔离环境进行，以防被潜在的蜜罐捕获或触发防御系统的自动化反制。整体代码逻辑透明，投毒风险较低，属于典型的安全研究验证工具。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2023-42793-Exploit](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2023-42793-Exploit)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/cve-2023-42793](https://nvd.nist.gov/vuln/detail/cve-2023-42793)
