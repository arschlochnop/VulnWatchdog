# CVE-2023-5360

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-5360-Chocapikk_CVE-2023-5360.md](../2023/CVE-2023-5360-Chocapikk_CVE-2023-5360.md)

## CVE-2023-5360 - Royal Elementor Addons and Templates 未授权任意文件上传

**漏洞编号:** CVE-2023-5360

**漏洞类型:** 任意文件上传

**影响应用:** Royal Elementor Addons and Templates WordPress插件

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.3.79

**利用条件:** 需要WordPress实例运行Royal Elementor Addons and Templates插件且版本低于1.3.79，并且目标服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-5360 漏洞存在于 Royal Elementor Addons and Templates WordPress 插件 1.3.79 之前的版本中。该漏洞允许未经身份验证的攻击者上传任意文件，包括 PHP 文件，从而导致远程代码执行 (RCE)。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判定该漏洞利用的有效性较高。

*   漏洞库信息明确指出，Royal Elementor Addons and Templates 插件在 1.3.79 之前的版本存在未授权任意文件上传漏洞，且可能导致 RCE。
*   搜索引擎结果中，多个来源证实了该漏洞的存在，并提供了漏洞描述、影响和利用方式。
*   提供的漏洞利用代码（`exploit.py`）实现了利用该漏洞上传任意文件的功能。该代码通过构造恶意的请求，绕过文件上传验证，将恶意 PHP 文件上传到目标服务器。

**投毒风险分析：**

漏洞利用代码中存在一定的投毒风险，但风险较低。

*   代码中存在`custom_file`选项，允许攻击者指定自定义的 PHP 文件上传。如果攻击者上传包含恶意代码的 PHP 文件，可能会对目标服务器造成损害。
*   `_get_nonce`函数看似是为了绕过某些安全机制，实际上，攻击者可以利用这个过程中的漏洞进行攻击。
*    在文件上传部分，poc.ph$p的文件名，可能存在绕过文件上传检测，成功上传后执行恶意代码的风险。但这些文件上传通常会通过后缀检测，以及文件内容检测绕过。

总体来说，代码的大部分功能是实现漏洞利用的核心逻辑，投毒代码的可能性较低，估计在10%左右。

**利用方式：**

1.  克隆漏洞利用代码仓库：`git clone https://github.com/Chocapikk/CVE-2023-5360.git`
2.  安装依赖：`pip install -r requirements.txt`
3.  运行漏洞利用脚本：`python3 exploit.py -u <TARGET_URL> -v`
4.  漏洞利用脚本首先获取目标 WordPress 站点的 nonce 值，然后构造包含恶意 PHP 代码的文件上传请求，绕过文件上传验证，将恶意 PHP 文件上传到目标服务器。
5.  上传成功后，攻击者可以通过访问上传的 PHP 文件来执行任意代码，从而控制目标服务器。

**缓解措施：**

*   将 Royal Elementor Addons and Templates 插件升级到 1.3.79 或更高版本。
*   限制上传文件类型，仅允许上传安全的文件类型。
*   对上传的文件进行严格的安全检查，防止恶意代码执行。
*   加强服务器的安全防护，例如使用防火墙、入侵检测系统等。

**项目地址:** [Chocapikk/CVE-2023-5360](https://github.com/Chocapikk/CVE-2023-5360)

**漏洞详情:** [CVE-2023-5360](https://nvd.nist.gov/vuln/detail/CVE-2023-5360)

---

## POC #2

**来源**: [CVE-2023-5360-Jenderal92_WP-CVE-2023-5360.md](../2023/CVE-2023-5360-Jenderal92_WP-CVE-2023-5360.md)

## CVE-2023-5360-Royal Elementor Addons and Templates-任意文件上传

**漏洞编号:** CVE-2023-5360

**漏洞类型:** 任意文件上传

**影响应用:** Royal Elementor Addons and Templates

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.3.79

**利用条件:** 目标网站安装了Royal Elementor Addons and Templates插件，且版本低于1.3.79，攻击者可以未经身份验证进行攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-5360 存在于 Royal Elementor Addons and Templates WordPress 插件中，版本低于 1.3.79。该漏洞允许未经身份验证的用户上传任意文件，包括 PHP 文件，从而可能导致远程代码执行(RCE)。

**有效性分析：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用的有效性较高。
*   漏洞库信息表明，该插件存在未授权任意文件上传漏洞，且已公开。
*   搜索结果中多个来源确认了该漏洞的存在和严重性，甚至有报告指出该漏洞已被积极利用。
*   提供的漏洞利用代码（`cve-2023-5360.py`）针对该漏洞，尝试上传包含恶意代码的 PHP 文件。

**投毒风险分析：**
*   代码中包含从 `https://raw.githubusercontent.com/ajibarangxploit/shinx/main/shin.php` 下载 shell 的行为。这引入了潜在的投毒风险。如果该远程文件被篡改，攻击者可能会执行非预期代码。
*   尽管如此，主利用逻辑在于利用文件上传漏洞，后门下载可以被视为一种额外的功能，增加了风险，但并非核心利用方式。
*   `scanner.py`的功能主要是版本检测，判断目标是否存在漏洞，没有发现恶意代码。
*   考虑到远程下载的风险，并结合作者的信誉无法评估，因此评估投毒风险为10%。主要的风险还是在于漏洞利用本身，而非代码作者的恶意行为。

**利用方式分析：**
1.  **版本检测：** 使用`scanner.py` 通过访问目标网站的 `readme.txt` 文件，检查 Royal Elementor Addons and Templates 插件的版本。
2.  **Nonce 获取：** 通过请求目标网站页面，利用正则表达式提取 WprConfig 对象的 nonce 值，该值用于后续的上传请求。
3.  **文件上传：** 构造包含恶意 PHP 代码的上传请求，其中 `action` 参数设置为 `wpr_addons_upload_file`，`wpr_addons_nonce` 参数设置为获取的 nonce 值，`uploaded_file` 参数设置为包含恶意 PHP 代码的文件。漏洞利用代码中的恶意 PHP 代码会尝试从远程 URL 下载 shell 文件，然后执行它。文件名被混淆为`shin.ph$p`。
4.  **Shell 访问：** 上传成功后，通过访问上传的文件（`/wp-content/uploads/wpr-addons/forms/shin.php`）来执行恶意代码，从而获得服务器的控制权。

该利用方式利用了插件的文件上传功能，绕过了文件类型验证，从而上传恶意 PHP 文件并执行，最终实现远程代码执行。

**项目地址:** [Jenderal92/WP-CVE-2023-5360](https://github.com/Jenderal92/WP-CVE-2023-5360)

**漏洞详情:** [CVE-2023-5360](https://nvd.nist.gov/vuln/detail/CVE-2023-5360)

---

## POC #3

**来源**: [CVE-2023-5360-Pushkarup_CVE-2023-5360.md](../2023/CVE-2023-5360-Pushkarup_CVE-2023-5360.md)

## CVE-2023-5360 - Royal Elementor Addons and Templates 未授权任意文件上传

**漏洞编号:** CVE-2023-5360

**漏洞类型:** 任意文件上传

**影响应用:** Royal Elementor Addons and Templates WordPress 插件

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.3.79

**利用条件:** 目标 WordPress 站点安装了 Royal Elementor Addons and Templates 插件且版本低于 1.3.79，攻击者无需身份验证即可利用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-5360 漏洞存在于 Royal Elementor Addons and Templates WordPress 插件的早期版本中（< 1.3.79）。该漏洞允许未经身份验证的攻击者上传任意文件，包括 PHP 脚本，从而可能导致远程代码执行。

**漏洞利用方式：**

1.  **上传恶意文件：** 攻击者利用漏洞上传包含恶意代码的 PHP 文件或其他可执行文件到 WordPress 服务器。
2.  **执行恶意代码：** 成功上传后，攻击者可以通过访问上传的文件来执行其中的恶意代码，从而控制服务器。

**POC代码分析：**

提供的 POC 代码是一个 Python 脚本，旨在利用该漏洞。主要步骤如下：

1.  **获取 Nonce 值：** 脚本首先尝试从目标站点获取 Nonce 值，这可能用于绕过某些安全检查。
2.  **上传 PHP Shell：** 脚本构造一个包含 PHP Shell 代码的 POST 请求，并将其发送到目标站点的上传接口。
3.  **验证上传：** 脚本验证文件是否成功上传，并尝试访问上传的文件以触发恶意代码的执行。

**投毒风险分析：**

代码中主要功能是利用漏洞上传webshell,用于漏洞验证,初步判断，该POC代码存在投毒代码的可能性较低。其中包含以下几点：

*   **免责声明：** 代码包含免责声明，表明开发者不负责任。
*   **PHP Shell 代码：** 使用了标准的 PHP Shell 代码，功能是文件上传。
*   **日志记录：** exploit.log会记录漏洞利用过程。
*   **Nonce 获取：** 脚本尝试获取 Nonce 值，增加了攻击的成功率，但同时也暴露了攻击行为。

虽然主要功能是漏洞利用，但是仍然不能排除作者植入后门代码的可能性,比如搜集目标服务器IP等信息,投毒风险评估为1%。

**项目地址:** [Pushkarup/CVE-2023-5360](https://github.com/Pushkarup/CVE-2023-5360)

**漏洞详情:** [CVE-2023-5360](https://nvd.nist.gov/vuln/detail/CVE-2023-5360)

---

## POC #4

**来源**: [CVE-2023-5360-X3RX3SSec_CVE-2023-5360.md](../2023/CVE-2023-5360-X3RX3SSec_CVE-2023-5360.md)

## CVE-2023-5360 - Royal Elementor Addons and Templates - Unauthenticated Arbitrary File Upload

**漏洞编号:** CVE-2023-5360

**漏洞类型:** 任意文件上传

**影响应用:** Royal Elementor Addons and Templates WordPress plugin

**危害等级:** 高危，可能导致远程代码执行 (RCE)

**影响版本:** < 1.3.79

**利用条件:** 目标WordPress站点安装了Royal Elementor Addons and Templates插件，且版本低于1.3.79，无需身份验证即可利用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-5360 漏洞存在于 Royal Elementor Addons and Templates WordPress 插件中，版本低于 1.3.79。该插件未正确验证上传的文件，允许未经身份验证的用户上传任意文件，包括 PHP 文件，从而导致远程代码执行（RCE）。

**漏洞利用方式：**

1.  **获取 Elementor nonce：** 攻击者首先访问包含 Elementor 组件的页面，从 HTML 源代码中提取 `WprConfig` 变量中的 `nonce` 值。该nonce用于绕过插件的安全性检查。
2.  **构造恶意请求：** 攻击者构造一个 POST 请求，发送到 `/wp-admin/admin-ajax.php` 端点，其中包含以下参数：
    *   `wpr_addons_nonce`:  从目标站点获取的 nonce 值。
    *   `max_file_size`:  文件大小限制。
    *   `allowed_file_types`:  允许的文件类型。
    *   `action`:  设置为 `wpr_addons_upload_file`，触发文件上传功能。
    *   `triggering_event`:  触发事件。
    *   `uploaded_file`:  包含恶意 PHP 代码的文件，文件名为 `shell-{random.randint(1000,9999)}.php`。
3.  **上传恶意文件：**  攻击者将构造的 POST 请求发送到目标服务器，服务器将上传恶意 PHP 文件。
4.  **执行恶意代码：**  攻击者通过访问上传的 PHP 文件，即可执行其中的恶意代码，控制目标服务器。

**代码分析和投毒风险评估：**

提供的 Python 脚本 `CVE-2023-5360.py` 实现了上述漏洞利用过程。脚本的主要功能包括：

*   **获取 nonce：**  从目标页面提取 Elementor nonce。
*   **生成 payload：** 允许用户选择简单的webshell或者反弹shell。webshell是利用php的system()函数来执行命令，反弹shell是通过bash反弹shell到攻击者的IP地址和端口。
*   **上传文件：**  构造并发送 POST 请求，上传包含恶意 PHP 代码的文件。
*   **触发 payload：**  访问上传的文件，触发恶意代码的执行。
*   **启动监听器（可选）：**如果选择反弹shell，脚本可以自动启动一个`nc`监听器。

代码中未发现明显的恶意代码或后门，主要功能是利用漏洞上传并执行用户选择的payload。脚本的意图是明确的，即利用 CVE-2023-5360 漏洞进行渗透测试或攻击。

**结论：**

*   **有效性：**  提供的 POC 代码有效，可以利用 CVE-2023-5360 漏洞在目标服务器上上传并执行任意 PHP 代码。
*   **投毒风险：**  代码中没有明显的投毒代码，因此投毒风险较低。可以认为投毒风险为0%。

**项目地址:** [X3RX3SSec/CVE-2023-5360](https://github.com/X3RX3SSec/CVE-2023-5360)

**漏洞详情:** [CVE-2023-5360](https://nvd.nist.gov/vuln/detail/CVE-2023-5360)

---

## POC #5

**来源**: [CVE-2023-5360-nastar-id_CVE-2023-5360.md](../2023/CVE-2023-5360-nastar-id_CVE-2023-5360.md)

# CVE-2023-5360

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-5360-Chocapikk_CVE-2023-5360.md](../2023/CVE-2023-5360-Chocapikk_CVE-2023-5360.md)

## CVE-2023-5360 - Royal Elementor Addons and Templates 未授权任意文件上传

**漏洞编号:** CVE-2023-5360

**漏洞类型:** 任意文件上传

**影响应用:** Royal Elementor Addons and Templates WordPress插件

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.3.79

**利用条件:** 需要WordPress实例运行Royal Elementor Addons and Templates插件且版本低于1.3.79，并且目标服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-5360 漏洞存在于 Royal Elementor Addons and Templates WordPress 插件 1.3.79 之前的版本中。该漏洞允许未经身份验证的攻击者上传任意文件，包括 PHP 文件，从而导致远程代码执行 (RCE)。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判定该漏洞利用的有效性较高。

*   漏洞库信息明确指出，Royal Elementor Addons and Templates 插件在 1.3.79 之前的版本存在未授权任意文件上传漏洞，且可能导致 RCE。
*   搜索引擎结果中，多个来源证实了该漏洞的存在，并提供了漏洞描述、影响和利用方式。
*   提供的漏洞利用代码（`exploit.py`）实现了利用该漏洞上传任意文件的功能。该代码通过构造恶意的请求，绕过文件上传验证，将恶意 PHP 文件上传到目标服务器。

**投毒风险分析：**

漏洞利用代码中存在一定的投毒风险，但风险较低。

*   代码中存在`custom_file`选项，允许攻击者指定自定义的 PHP 文件上传。如果攻击者上传包含恶意代码的 PHP 文件，可能会对目标服务器造成损害。
*   `_get_nonce`函数看似是为了绕过某些安全机制，实际上，攻击者可以利用这个过程中的漏洞进行攻击。
*    在文件上传部分，poc.ph$p的文件名，可能存在绕过文件上传检测，成功上传后执行恶意代码的风险。但这些文件上传通常会通过后缀检测，以及文件内容检测绕过。

总体来说，代码的大部分功能是实现漏洞利用的核心逻辑，投毒代码的可能性较低，估计在10%左右。

**利用方式：**

1.  克隆漏洞利用代码仓库：`git clone https://github.com/Chocapikk/CVE-2023-5360.git`
2.  安装依赖：`pip install -r requirements.txt`
3.  运行漏洞利用脚本：`python3 exploit.py -u <TARGET_URL> -v`
4.  漏洞利用脚本首先获取目标 WordPress 站点的 nonce 值，然后构造包含恶意 PHP 代码的文件上传请求，绕过文件上传验证，将恶意 PHP 文件上传到目标服务器。
5.  上传成功后，攻击者可以通过访问上传的 PHP 文件来执行任意代码，从而控制目标服务器。

**缓解措施：**

*   将 Royal Elementor Addons and Templates 插件升级到 1.3.79 或更高版本。
*   限制上传文件类型，仅允许上传安全的文件类型。
*   对上传的文件进行严格的安全检查，防止恶意代码执行。
*   加强服务器的安全防护，例如使用防火墙、入侵检测系统等。

**项目地址:** [Chocapikk/CVE-2023-5360](https://github.com/Chocapikk/CVE-2023-5360)

**漏洞详情:** [CVE-2023-5360](https://nvd.nist.gov/vuln/detail/CVE-2023-5360)

---

## POC #2

**来源**: [CVE-2023-5360-Jenderal92_WP-CVE-2023-5360.md](../2023/CVE-2023-5360-Jenderal92_WP-CVE-2023-5360.md)

## CVE-2023-5360-Royal Elementor Addons and Templates-任意文件上传

**漏洞编号:** CVE-2023-5360

**漏洞类型:** 任意文件上传

**影响应用:** Royal Elementor Addons and Templates

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.3.79

**利用条件:** 目标网站安装了Royal Elementor Addons and Templates插件，且版本低于1.3.79，攻击者可以未经身份验证进行攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-5360 存在于 Royal Elementor Addons and Templates WordPress 插件中，版本低于 1.3.79。该漏洞允许未经身份验证的用户上传任意文件，包括 PHP 文件，从而可能导致远程代码执行(RCE)。

**有效性分析：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用的有效性较高。
*   漏洞库信息表明，该插件存在未授权任意文件上传漏洞，且已公开。
*   搜索结果中多个来源确认了该漏洞的存在和严重性，甚至有报告指出该漏洞已被积极利用。
*   提供的漏洞利用代码（`cve-2023-5360.py`）针对该漏洞，尝试上传包含恶意代码的 PHP 文件。

**投毒风险分析：**
*   代码中包含从 `https://raw.githubusercontent.com/ajibarangxploit/shinx/main/shin.php` 下载 shell 的行为。这引入了潜在的投毒风险。如果该远程文件被篡改，攻击者可能会执行非预期代码。
*   尽管如此，主利用逻辑在于利用文件上传漏洞，后门下载可以被视为一种额外的功能，增加了风险，但并非核心利用方式。
*   `scanner.py`的功能主要是版本检测，判断目标是否存在漏洞，没有发现恶意代码。
*   考虑到远程下载的风险，并结合作者的信誉无法评估，因此评估投毒风险为10%。主要的风险还是在于漏洞利用本身，而非代码作者的恶意行为。

**利用方式分析：**
1.  **版本检测：** 使用`scanner.py` 通过访问目标网站的 `readme.txt` 文件，检查 Royal Elementor Addons and Templates 插件的版本。
2.  **Nonce 获取：** 通过请求目标网站页面，利用正则表达式提取 WprConfig 对象的 nonce 值，该值用于后续的上传请求。
3.  **文件上传：** 构造包含恶意 PHP 代码的上传请求，其中 `action` 参数设置为 `wpr_addons_upload_file`，`wpr_addons_nonce` 参数设置为获取的 nonce 值，`uploaded_file` 参数设置为包含恶意 PHP 代码的文件。漏洞利用代码中的恶意 PHP 代码会尝试从远程 URL 下载 shell 文件，然后执行它。文件名被混淆为`shin.ph$p`。
4.  **Shell 访问：** 上传成功后，通过访问上传的文件（`/wp-content/uploads/wpr-addons/forms/shin.php`）来执行恶意代码，从而获得服务器的控制权。

该利用方式利用了插件的文件上传功能，绕过了文件类型验证，从而上传恶意 PHP 文件并执行，最终实现远程代码执行。

**项目地址:** [Jenderal92/WP-CVE-2023-5360](https://github.com/Jenderal92/WP-CVE-2023-5360)

**漏洞详情:** [CVE-2023-5360](https://nvd.nist.gov/vuln/detail/CVE-2023-5360)

---

## POC #3

**来源**: [CVE-2023-5360-Pushkarup_CVE-2023-5360.md](../2023/CVE-2023-5360-Pushkarup_CVE-2023-5360.md)

## CVE-2023-5360 - Royal Elementor Addons and Templates 未授权任意文件上传

**漏洞编号:** CVE-2023-5360

**漏洞类型:** 任意文件上传

**影响应用:** Royal Elementor Addons and Templates WordPress 插件

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.3.79

**利用条件:** 目标 WordPress 站点安装了 Royal Elementor Addons and Templates 插件且版本低于 1.3.79，攻击者无需身份验证即可利用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-5360 漏洞存在于 Royal Elementor Addons and Templates WordPress 插件的早期版本中（< 1.3.79）。该漏洞允许未经身份验证的攻击者上传任意文件，包括 PHP 脚本，从而可能导致远程代码执行。

**漏洞利用方式：**

1.  **上传恶意文件：** 攻击者利用漏洞上传包含恶意代码的 PHP 文件或其他可执行文件到 WordPress 服务器。
2.  **执行恶意代码：** 成功上传后，攻击者可以通过访问上传的文件来执行其中的恶意代码，从而控制服务器。

**POC代码分析：**

提供的 POC 代码是一个 Python 脚本，旨在利用该漏洞。主要步骤如下：

1.  **获取 Nonce 值：** 脚本首先尝试从目标站点获取 Nonce 值，这可能用于绕过某些安全检查。
2.  **上传 PHP Shell：** 脚本构造一个包含 PHP Shell 代码的 POST 请求，并将其发送到目标站点的上传接口。
3.  **验证上传：** 脚本验证文件是否成功上传，并尝试访问上传的文件以触发恶意代码的执行。

**投毒风险分析：**

代码中主要功能是利用漏洞上传webshell,用于漏洞验证,初步判断，该POC代码存在投毒代码的可能性较低。其中包含以下几点：

*   **免责声明：** 代码包含免责声明，表明开发者不负责任。
*   **PHP Shell 代码：** 使用了标准的 PHP Shell 代码，功能是文件上传。
*   **日志记录：** exploit.log会记录漏洞利用过程。
*   **Nonce 获取：** 脚本尝试获取 Nonce 值，增加了攻击的成功率，但同时也暴露了攻击行为。

虽然主要功能是漏洞利用，但是仍然不能排除作者植入后门代码的可能性,比如搜集目标服务器IP等信息,投毒风险评估为1%。

**项目地址:** [Pushkarup/CVE-2023-5360](https://github.com/Pushkarup/CVE-2023-5360)

**漏洞详情:** [CVE-2023-5360](https://nvd.nist.gov/vuln/detail/CVE-2023-5360)

---

## POC #4

**来源**: [CVE-2023-5360-X3RX3SSec_CVE-2023-5360.md](../2023/CVE-2023-5360-X3RX3SSec_CVE-2023-5360.md)

## CVE-2023-5360 - Royal Elementor Addons and Templates - Unauthenticated Arbitrary File Upload

**漏洞编号:** CVE-2023-5360

**漏洞类型:** 任意文件上传

**影响应用:** Royal Elementor Addons and Templates WordPress plugin

**危害等级:** 高危，可能导致远程代码执行 (RCE)

**影响版本:** < 1.3.79

**利用条件:** 目标WordPress站点安装了Royal Elementor Addons and Templates插件，且版本低于1.3.79，无需身份验证即可利用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-5360 漏洞存在于 Royal Elementor Addons and Templates WordPress 插件中，版本低于 1.3.79。该插件未正确验证上传的文件，允许未经身份验证的用户上传任意文件，包括 PHP 文件，从而导致远程代码执行（RCE）。

**漏洞利用方式：**

1.  **获取 Elementor nonce：** 攻击者首先访问包含 Elementor 组件的页面，从 HTML 源代码中提取 `WprConfig` 变量中的 `nonce` 值。该nonce用于绕过插件的安全性检查。
2.  **构造恶意请求：** 攻击者构造一个 POST 请求，发送到 `/wp-admin/admin-ajax.php` 端点，其中包含以下参数：
    *   `wpr_addons_nonce`:  从目标站点获取的 nonce 值。
    *   `max_file_size`:  文件大小限制。
    *   `allowed_file_types`:  允许的文件类型。
    *   `action`:  设置为 `wpr_addons_upload_file`，触发文件上传功能。
    *   `triggering_event`:  触发事件。
    *   `uploaded_file`:  包含恶意 PHP 代码的文件，文件名为 `shell-{random.randint(1000,9999)}.php`。
3.  **上传恶意文件：**  攻击者将构造的 POST 请求发送到目标服务器，服务器将上传恶意 PHP 文件。
4.  **执行恶意代码：**  攻击者通过访问上传的 PHP 文件，即可执行其中的恶意代码，控制目标服务器。

**代码分析和投毒风险评估：**

提供的 Python 脚本 `CVE-2023-5360.py` 实现了上述漏洞利用过程。脚本的主要功能包括：

*   **获取 nonce：**  从目标页面提取 Elementor nonce。
*   **生成 payload：** 允许用户选择简单的webshell或者反弹shell。webshell是利用php的system()函数来执行命令，反弹shell是通过bash反弹shell到攻击者的IP地址和端口。
*   **上传文件：**  构造并发送 POST 请求，上传包含恶意 PHP 代码的文件。
*   **触发 payload：**  访问上传的文件，触发恶意代码的执行。
*   **启动监听器（可选）：**如果选择反弹shell，脚本可以自动启动一个`nc`监听器。

代码中未发现明显的恶意代码或后门，主要功能是利用漏洞上传并执行用户选择的payload。脚本的意图是明确的，即利用 CVE-2023-5360 漏洞进行渗透测试或攻击。

**结论：**

*   **有效性：**  提供的 POC 代码有效，可以利用 CVE-2023-5360 漏洞在目标服务器上上传并执行任意 PHP 代码。
*   **投毒风险：**  代码中没有明显的投毒代码，因此投毒风险较低。可以认为投毒风险为0%。

**项目地址:** [X3RX3SSec/CVE-2023-5360](https://github.com/X3RX3SSec/CVE-2023-5360)

**漏洞详情:** [CVE-2023-5360](https://nvd.nist.gov/vuln/detail/CVE-2023-5360)

---

## POC #5

**来源**: [CVE-2023-5360-phankz_Worpress-CVE-2023-5360.md](../2023/CVE-2023-5360-phankz_Worpress-CVE-2023-5360.md)

## CVE-2023-5360 - Royal Elementor Addons and Templates - 任意文件上传

**漏洞编号:** CVE-2023-5360

**漏洞类型:** 任意文件上传

**影响应用:** Royal Elementor Addons and Templates

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.3.79

**利用条件:** WordPress 站点安装了受影响的 Royal Elementor Addons and Templates 插件，且漏洞未修复。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

根据漏洞信息和搜索结果，Royal Elementor Addons and Templates 插件存在一个未经身份验证的任意文件上传漏洞。未经身份验证的用户可以通过上传恶意文件（例如 PHP 文件）来执行远程代码。

**有效性：**
提供的漏洞利用代码 `exploit.py` 包含大量混淆代码。它首先检查 `pycryptodome` 模块是否安装，并声明仅适用于 v3.11 以上版本。 该脚本看起来严重混淆，使用了 `pyobfuscate` ,`base64` ,`codecs`, `zlib` 等库对代码进行多层混淆。解混淆后，预计会执行文件上传操作，上传包含恶意代码的 webshell。

**投毒风险：**
该代码经过了高度混淆，难以直接判断其功能，但是从大量混淆的代码中和访问phankz.com网址 可以初步判定投毒风险非常高，利用价值低。

**利用方式：**
1.  攻击者利用未经身份验证的漏洞，向 WordPress 站点上传包含恶意代码的 PHP 文件 (webshell)。
2.  服务器未正确验证上传的文件类型，允许上传 PHP 文件。
3.  攻击者通过 Web 浏览器访问上传的 PHP 文件。
4.  恶意 PHP 代码在服务器上执行，从而实现远程代码执行。

**项目地址:** [phankz/Worpress-CVE-2023-5360](https://github.com/phankz/Worpress-CVE-2023-5360)

**漏洞详情:** [CVE-2023-5360](https://nvd.nist.gov/vuln/detail/CVE-2023-5360)

---

## POC #6

**来源**: [CVE-2023-5360-sagsooz_CVE-2023-5360.md](../2023/CVE-2023-5360-sagsooz_CVE-2023-5360.md)

## CVE-2023-5360 - Royal Elementor Addons and Templates - Unauthenticated Arbitrary File Upload

**漏洞编号:** CVE-2023-5360

**漏洞类型:** 任意文件上传

**影响应用:** Royal Elementor Addons and Templates

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.3.79

**利用条件:** WordPress插件启用 Royal Elementor Addons and Templates，且版本低于1.3.79，目标服务器可访问

**POC 可用性:** 是

**投毒风险:** 85%

## 详情

CVE-2023-5360 存在于 Royal Elementor Addons and Templates WordPress 插件中。该插件在 1.3.79 之前的版本中，未对上传的文件进行充分验证，导致未经身份验证的攻击者可以上传任意文件，包括 PHP 脚本等，从而实现远程代码执行。

**利用方式：**

1.  攻击者构造恶意请求，上传包含恶意代码的 PHP 文件。
2.  由于文件上传验证不足，恶意文件被成功上传到服务器。
3.  攻击者通过访问上传的 PHP 文件，执行其中的恶意代码，从而控制服务器。

**有效性：**

根据漏洞描述和搜索结果，该漏洞的 POC 代码应该有效，可以实现未经身份验证的任意文件上传。

**投毒风险分析：**

提供的 `exploit.py` 代码进行了混淆处理，降低了可读性，增加了分析难度。代码中存在如下可疑行为：

1.  使用了 `pycryptodome` 库，但没有明确说明用途，可能用于加密或解密恶意代码。
2.  代码中存在 `pyobfuscate` 字符串，暗示代码经过了某种形式的混淆处理（`pyobfuscate.com`）。
3.  代码中包含大量编码和解码操作（base64, zlib），可能用于隐藏恶意代码。
4.  代码中存在设置 `__builtins__` 对象属性的操作，修改了内置函数 `print`、`exec` 和 `eval`，可能用于隐藏恶意行为或绕过安全检测。

综合以上因素，可以判定该 POC 代码存在较高的投毒风险。攻击者可能在混淆的代码中隐藏了恶意后门，例如反弹 shell 或植入恶意软件。在使用该 POC 代码时需要格外小心，避免在生产环境中直接运行。

综上所述，该POC利用的有效性较高，但投毒风险也较高，建议在隔离环境中进行测试和分析。


**项目地址:** [sagsooz/CVE-2023-5360](https://github.com/sagsooz/CVE-2023-5360)

**漏洞详情:** [CVE-2023-5360](https://nvd.nist.gov/vuln/detail/CVE-2023-5360)

---

## POC #7

**来源**: [CVE-2023-5360-tucommenceapousser_CVE-2023-5360.md](../2023/CVE-2023-5360-tucommenceapousser_CVE-2023-5360.md)

## CVE-2023-5360 - Royal Elementor Addons and Templates - 未经验证的任意文件上传

**漏洞编号:** CVE-2023-5360

**漏洞类型:** 任意文件上传

**影响应用:** Royal Elementor Addons and Templates WordPress plugin

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.3.79

**利用条件:** 目标网站安装了Royal Elementor Addons and Templates插件，且版本低于1.3.79，攻击者可以未经身份验证直接上传恶意文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-5360 存在于 Royal Elementor Addons and Templates WordPress 插件的 1.3.79 版本之前。该插件未正确验证上传的文件，允许未经身份验证的用户上传任意文件，包括PHP文件，从而导致远程代码执行（RCE）。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断该漏洞利用代码有效。漏洞库和搜索结果都明确指出该插件存在未授权的任意文件上传漏洞，且漏洞利用代码尝试上传包含恶意PHP代码的文件。

**投毒风险分析：**
在提供的漏洞利用代码中，主要功能是上传一个包含PHP后门代码的文件，暂未发现明显的恶意投毒行为。虽然代码中包含从目标服务器执行任意命令的部分，但这是利用漏洞的预期行为，而不是额外的、与漏洞利用无关的恶意代码。代码结构比较简单，主要由颜色控制，文件上传，表单显示构成。但代码冗余行数比较多，不排除作者隐藏简单后门的可能性，因此判断存在轻微的投毒风险。保守估计投毒风险为10%。

**利用方式分析：**
1.  攻击者利用该漏洞，无需身份验证，直接向存在漏洞的WordPress网站上传恶意PHP文件。
2.  上传的PHP文件包含后门代码，例如webshell，允许攻击者在服务器上执行任意命令。
3.  攻击者通过访问上传的PHP文件，执行恶意代码，从而控制服务器。
4.  利用代码首先生成一个随机文件名，然后构造一个包含PHP代码的文件上传请求，该PHP代码的功能是允许用户上传任意文件。上传成功后，攻击者可以通过浏览器访问上传的文件，从而执行PHP代码。

**项目地址:** [tucommenceapousser/CVE-2023-5360](https://github.com/tucommenceapousser/CVE-2023-5360)

**漏洞详情:** [CVE-2023-5360](https://nvd.nist.gov/vuln/detail/CVE-2023-5360)

---



---

## POC #6

**来源**: [CVE-2023-5360-phankz_Worpress-CVE-2023-5360.md](../2023/CVE-2023-5360-phankz_Worpress-CVE-2023-5360.md)

## CVE-2023-5360 - Royal Elementor Addons and Templates - 任意文件上传

**漏洞编号:** CVE-2023-5360

**漏洞类型:** 任意文件上传

**影响应用:** Royal Elementor Addons and Templates

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.3.79

**利用条件:** WordPress 站点安装了受影响的 Royal Elementor Addons and Templates 插件，且漏洞未修复。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

根据漏洞信息和搜索结果，Royal Elementor Addons and Templates 插件存在一个未经身份验证的任意文件上传漏洞。未经身份验证的用户可以通过上传恶意文件（例如 PHP 文件）来执行远程代码。

**有效性：**
提供的漏洞利用代码 `exploit.py` 包含大量混淆代码。它首先检查 `pycryptodome` 模块是否安装，并声明仅适用于 v3.11 以上版本。 该脚本看起来严重混淆，使用了 `pyobfuscate` ,`base64` ,`codecs`, `zlib` 等库对代码进行多层混淆。解混淆后，预计会执行文件上传操作，上传包含恶意代码的 webshell。

**投毒风险：**
该代码经过了高度混淆，难以直接判断其功能，但是从大量混淆的代码中和访问phankz.com网址 可以初步判定投毒风险非常高，利用价值低。

**利用方式：**
1.  攻击者利用未经身份验证的漏洞，向 WordPress 站点上传包含恶意代码的 PHP 文件 (webshell)。
2.  服务器未正确验证上传的文件类型，允许上传 PHP 文件。
3.  攻击者通过 Web 浏览器访问上传的 PHP 文件。
4.  恶意 PHP 代码在服务器上执行，从而实现远程代码执行。

**项目地址:** [phankz/Worpress-CVE-2023-5360](https://github.com/phankz/Worpress-CVE-2023-5360)

**漏洞详情:** [CVE-2023-5360](https://nvd.nist.gov/vuln/detail/CVE-2023-5360)

---

## POC #7

**来源**: [CVE-2023-5360-sagsooz_CVE-2023-5360.md](../2023/CVE-2023-5360-sagsooz_CVE-2023-5360.md)

## CVE-2023-5360 - Royal Elementor Addons and Templates - Unauthenticated Arbitrary File Upload

**漏洞编号:** CVE-2023-5360

**漏洞类型:** 任意文件上传

**影响应用:** Royal Elementor Addons and Templates

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.3.79

**利用条件:** WordPress插件启用 Royal Elementor Addons and Templates，且版本低于1.3.79，目标服务器可访问

**POC 可用性:** 是

**投毒风险:** 85%

## 详情

CVE-2023-5360 存在于 Royal Elementor Addons and Templates WordPress 插件中。该插件在 1.3.79 之前的版本中，未对上传的文件进行充分验证，导致未经身份验证的攻击者可以上传任意文件，包括 PHP 脚本等，从而实现远程代码执行。

**利用方式：**

1.  攻击者构造恶意请求，上传包含恶意代码的 PHP 文件。
2.  由于文件上传验证不足，恶意文件被成功上传到服务器。
3.  攻击者通过访问上传的 PHP 文件，执行其中的恶意代码，从而控制服务器。

**有效性：**

根据漏洞描述和搜索结果，该漏洞的 POC 代码应该有效，可以实现未经身份验证的任意文件上传。

**投毒风险分析：**

提供的 `exploit.py` 代码进行了混淆处理，降低了可读性，增加了分析难度。代码中存在如下可疑行为：

1.  使用了 `pycryptodome` 库，但没有明确说明用途，可能用于加密或解密恶意代码。
2.  代码中存在 `pyobfuscate` 字符串，暗示代码经过了某种形式的混淆处理（`pyobfuscate.com`）。
3.  代码中包含大量编码和解码操作（base64, zlib），可能用于隐藏恶意代码。
4.  代码中存在设置 `__builtins__` 对象属性的操作，修改了内置函数 `print`、`exec` 和 `eval`，可能用于隐藏恶意行为或绕过安全检测。

综合以上因素，可以判定该 POC 代码存在较高的投毒风险。攻击者可能在混淆的代码中隐藏了恶意后门，例如反弹 shell 或植入恶意软件。在使用该 POC 代码时需要格外小心，避免在生产环境中直接运行。

综上所述，该POC利用的有效性较高，但投毒风险也较高，建议在隔离环境中进行测试和分析。


**项目地址:** [sagsooz/CVE-2023-5360](https://github.com/sagsooz/CVE-2023-5360)

**漏洞详情:** [CVE-2023-5360](https://nvd.nist.gov/vuln/detail/CVE-2023-5360)

---

## POC #8

**来源**: [CVE-2023-5360-tucommenceapousser_CVE-2023-5360.md](../2023/CVE-2023-5360-tucommenceapousser_CVE-2023-5360.md)

## CVE-2023-5360 - Royal Elementor Addons and Templates - 未经验证的任意文件上传

**漏洞编号:** CVE-2023-5360

**漏洞类型:** 任意文件上传

**影响应用:** Royal Elementor Addons and Templates WordPress plugin

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.3.79

**利用条件:** 目标网站安装了Royal Elementor Addons and Templates插件，且版本低于1.3.79，攻击者可以未经身份验证直接上传恶意文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-5360 存在于 Royal Elementor Addons and Templates WordPress 插件的 1.3.79 版本之前。该插件未正确验证上传的文件，允许未经身份验证的用户上传任意文件，包括PHP文件，从而导致远程代码执行（RCE）。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断该漏洞利用代码有效。漏洞库和搜索结果都明确指出该插件存在未授权的任意文件上传漏洞，且漏洞利用代码尝试上传包含恶意PHP代码的文件。

**投毒风险分析：**
在提供的漏洞利用代码中，主要功能是上传一个包含PHP后门代码的文件，暂未发现明显的恶意投毒行为。虽然代码中包含从目标服务器执行任意命令的部分，但这是利用漏洞的预期行为，而不是额外的、与漏洞利用无关的恶意代码。代码结构比较简单，主要由颜色控制，文件上传，表单显示构成。但代码冗余行数比较多，不排除作者隐藏简单后门的可能性，因此判断存在轻微的投毒风险。保守估计投毒风险为10%。

**利用方式分析：**
1.  攻击者利用该漏洞，无需身份验证，直接向存在漏洞的WordPress网站上传恶意PHP文件。
2.  上传的PHP文件包含后门代码，例如webshell，允许攻击者在服务器上执行任意命令。
3.  攻击者通过访问上传的PHP文件，执行恶意代码，从而控制服务器。
4.  利用代码首先生成一个随机文件名，然后构造一个包含PHP代码的文件上传请求，该PHP代码的功能是允许用户上传任意文件。上传成功后，攻击者可以通过浏览器访问上传的文件，从而执行PHP代码。

**项目地址:** [tucommenceapousser/CVE-2023-5360](https://github.com/tucommenceapousser/CVE-2023-5360)

**漏洞详情:** [CVE-2023-5360](https://nvd.nist.gov/vuln/detail/CVE-2023-5360)

---

