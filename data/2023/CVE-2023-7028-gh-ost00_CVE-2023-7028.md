# CVE-2023-7028

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-7028-Esonhugh_gitlab_honeypot.md](../2023/CVE-2023-7028-Esonhugh_gitlab_honeypot.md)

## CVE-2023-7028-GitLab-账户接管

**漏洞编号:** CVE-2023-7028

**漏洞类型:** 弱密码恢复机制

**影响应用:** GitLab

**危害等级:** 高危，允许攻击者无需用户交互即可接管账户，包括管理员账户

**影响版本:** 16.1 直到 16.1.6, 16.2 直到 16.2.9, 16.3 直到 16.3.7, 16.4 直到 16.4.5, 16.5 直到 16.5.6, 16.6 直到 16.6.4, and 16.7 直到 16.7.2

**利用条件:** 需要目标GitLab实例存在受影响的版本，且攻击者能够发送邮件到目标用户邮箱。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-7028 漏洞是 GitLab CE/EE 版本 16.1 到 16.7.2 中存在的一个严重漏洞，该漏洞允许攻击者通过向用户的账户添加未验证的电子邮件地址来重置用户密码，从而无需任何用户交互即可接管账户。 

**有效性：**
提供的 POC 代码是一个包含`ResetPassword.eml`文件的邮件模板。该模板通过在`To:`字段中同时包含目标用户的邮箱地址和攻击者的邮箱地址，来利用漏洞，使得重置密码的链接同时发送到两个邮箱。攻击者收到包含`reset_password_token`的邮件后，即可利用该token重置目标用户的密码。

**投毒风险：**
POC 本身就是一个漏洞验证代码，不具备明显的恶意投毒代码。但是需要注意替换`{SENDER_EMAIL}`，`{ATTACKER_EMAIL}`，`{GITLAB_URL}`，`{GITLAB_LOG_PATH}`和`{HACKER_TOKEN}`这些变量。`{GITLAB_LOG_PATH}`如果设置不当，可能会导致信息泄露，但非恶意投毒。因此认为存在轻微的投毒风险，主要来自对参数替换的不当使用，约为 10%。

**利用方式：**
1.  攻击者构造包含两个邮箱地址（目标用户邮箱和攻击者邮箱）的密码重置请求。
2.  GitLab 存在漏洞的版本会将包含重置密码链接的邮件同时发送到这两个邮箱地址。
3.  攻击者从自己的邮箱中获取重置密码链接中的`reset_password_token`。
4.  攻击者利用该 token 访问密码重置页面，并设置目标用户的新密码。
5.  攻击者使用新密码登录目标用户的账户，完成账户接管。

利用的核心在于 GitLab 允许将密码重置邮件同时发送到多个邮箱，从而使得攻击者可以获取到重置密码的权限。

**项目地址:** [Esonhugh/gitlab_honeypot](https://github.com/Esonhugh/gitlab_honeypot)

**漏洞详情:** [CVE-2023-7028](https://nvd.nist.gov/vuln/detail/CVE-2023-7028)

---

## POC #2

**来源**: [CVE-2023-7028-KameliaZaman_Exploiting-GitLab-CVE-2023-7028.md](../2023/CVE-2023-7028-KameliaZaman_Exploiting-GitLab-CVE-2023-7028.md)

## CVE-2023-7028-GitLab-账户接管

**漏洞编号:** CVE-2023-7028

**漏洞类型:** 弱口令重置机制

**影响应用:** GitLab

**危害等级:** 高危，可能导致账户接管

**影响版本:** 16.1 prior to 16.1.6, 16.2 prior to 16.2.9, 16.3 prior to 16.3.7, 16.4 prior to 16.4.5, 16.5 prior to 16.5.6, 16.6 prior to 16.6.4, and 16.7 prior to 16.7.2

**利用条件:** 目标GitLab实例存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-7028是GitLab中一个严重的安全漏洞，允许攻击者通过向未经验证的电子邮件地址发送用户帐户密码重置电子邮件来潜在地接管帐户。该漏洞影响GitLab CE/EE的多个版本。提供的PoC代码通过以下步骤利用此漏洞：

1.  **获取CSRF Token:** 脚本首先从密码重置页面获取CSRF token，用于后续的密码重置请求。
2.  **构造恶意请求:**  脚本构造一个包含目标用户邮箱和攻击者邮箱的password reset请求。通过将两个邮箱地址都放入`user[email][]`参数中，利用了GitLab的漏洞，使得重置邮件会同时发送到这两个邮箱。
3.  **发送请求:**  脚本使用POST请求将构造的数据发送到 `/users/password` 端点。
4.  **账户接管:** 如果请求成功，攻击者就可以通过攻击者邮箱收到的密码重置链接来重置目标用户的密码，从而接管其账户。

**有效性评估:** PoC代码的逻辑清晰，利用了漏洞描述中提到的邮箱注入漏洞，应能有效利用此漏洞接管目标账户。

**投毒风险评估:**  PoC代码中没有明显的恶意代码。所有的操作都是为了利用这个password reset漏洞，代码整体思路也是围绕这个漏洞来展开，但是不排除作者在其他位置添加隐藏代码，考虑到只是一个简单的POC脚本，隐藏恶意代码的可能性较低，因此，投毒风险评估为5%。

**利用方式总结:** 此漏洞的利用方式是攻击者首先获取CSRF token，然后构造一个包含目标用户邮箱和攻击者邮箱的恶意请求，利用GitLab的缺陷，使得密码重置链接同时发送到两个邮箱，从而攻击者可以通过收到的链接重置密码并接管目标账户。

**项目地址:** [KameliaZaman/Exploiting-GitLab-CVE-2023-7028](https://github.com/KameliaZaman/Exploiting-GitLab-CVE-2023-7028)

**漏洞详情:** [CVE-2023-7028](https://nvd.nist.gov/vuln/detail/CVE-2023-7028)

---

## POC #3

**来源**: [CVE-2023-7028-RandomRobbieBF_CVE-2023-7028.md](../2023/CVE-2023-7028-RandomRobbieBF_CVE-2023-7028.md)

## CVE-2023-7028 - GitLab 弱密码恢复机制漏洞

**漏洞编号:** CVE-2023-7028

**漏洞类型:** 弱密码恢复机制漏洞

**影响应用:** GitLab

**危害等级:** 高危，可能导致账户接管

**影响版本:** 16.1 prior to 16.1.6, 16.2 prior to 16.2.9, 16.3 prior to 16.3.7, 16.4 prior to 16.4.5, 16.5 prior to 16.5.6, 16.6 prior to 16.6.4, and 16.7 prior to 16.7.2

**利用条件:** 目标GitLab实例版本受影响，且未启用双因素认证或使用LDAP登录。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-7028 存在于 GitLab 的密码重置功能中。攻击者可以通过在密码重置请求中提供两个不同的邮箱地址（受害者邮箱和攻击者邮箱），从而将密码重置邮件发送到攻击者的邮箱，最终实现账户接管。

**漏洞利用方式：**
1. 攻击者访问 GitLab 的密码重置页面。
2. 攻击者在密码重置请求中，同时填写受害者的邮箱地址和攻击者自己的邮箱地址。
3. GitLab 服务器验证不严谨，会将密码重置邮件发送到攻击者的邮箱。
4. 攻击者通过邮件中的链接重置受害者的密码，从而控制受害者的账户。

**有效性：**
根据漏洞描述和提供的漏洞利用代码，该 POC 代码有效。漏洞利用代码模拟了上述攻击流程，通过构造包含两个邮箱地址的 POST 请求来触发密码重置。

**投毒风险：**
分析提供的 POC 代码，未发现明显的恶意代码或后门。POC 代码主要功能是利用 GitLab 的密码重置漏洞，没有发现额外执行系统命令、上传文件或其他恶意行为的代码。但是，任何代码都存在一定的风险，例如依赖库的潜在安全问题。因此投毒风险较低，评估为1%。这个评估是主观的，因为对代码的解释和理解会因人而异。


**项目地址:** [RandomRobbieBF/CVE-2023-7028](https://github.com/RandomRobbieBF/CVE-2023-7028)

**漏洞详情:** [CVE-2023-7028](https://nvd.nist.gov/vuln/detail/CVE-2023-7028)

---

## POC #4

**来源**: [CVE-2023-7028-Shimon03_CVE-2023-7028-Account-Take-Over-Gitlab.md](../2023/CVE-2023-7028-Shimon03_CVE-2023-7028-Account-Take-Over-Gitlab.md)

## CVE-2023-7028-GitLab-账户接管

**漏洞编号:** CVE-2023-7028

**漏洞类型:** 弱密码恢复机制

**影响应用:** GitLab

**危害等级:** 高危，允许攻击者无需用户交互即可接管账户

**影响版本:** 16.1 < version < 16.1.6, 16.2 < version < 16.2.9, 16.3 < version < 16.3.7, 16.4 < version < 16.4.5, 16.5 < version < 16.5.6, 16.6 < version < 16.6.4, 16.7 < version < 16.7.2

**利用条件:** 目标GitLab实例存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-7028 是一个影响 GitLab CE/EE 的账户接管漏洞。该漏洞源于密码重置流程中的缺陷，允许攻击者通过提供两个邮箱地址（目标用户的邮箱地址和一个攻击者控制的邮箱地址）来接收密码重置链接，从而控制目标用户的账户。POC代码通过以下步骤利用该漏洞：

1.  **获取 CSRF Token:** 从密码重置页面获取 CSRF token，用于后续的请求。
2.  **发送密码重置请求:** 构造包含两个邮箱地址（目标用户的邮箱和攻击者控制的邮箱）的 POST 请求到 `/users/password` 接口。
3.  **接收重置链接:** 攻击者在其控制的邮箱中收到密码重置链接。
4.  **重置密码:** 使用收到的链接，攻击者可以设置目标用户的密码，从而接管其账户。

**有效性：** 根据漏洞描述和搜索结果，POC代码有效，能够实现账户接管。

**投毒风险：**  POC代码主要功能是利用 GitLab 密码重置漏洞。代码中使用了 `requests` 库发送 HTTP 请求，`re` 库进行正则表达式匹配，`urllib.parse` 库进行 URL 编码，以及`OneSecMail_api`类与临时邮箱服务交互。其中`OneSecMail_api`存在不稳定性，如果临时邮箱服务出现问题，可能影响POC的成功率。

代码中发现潜在风险点是，该脚本使用了外部的 `1secmail.com` 临时邮箱服务。如果该服务被恶意控制或劫持，则可能存在一定投毒风险，例如在邮箱内容中插入恶意链接或脚本。但是，如果该服务正常，则POC代码本身并没有发现明显的恶意代码或后门，因此判定投毒风险较低，约为5%。

**利用方式：** 攻击者需要指定目标用户的邮箱地址和一个攻击者可以接收邮件的邮箱地址。然后，运行POC脚本，脚本会自动完成 CSRF token 获取、密码重置请求发送和密码重置链接提取等步骤。最后，攻击者使用重置链接设置新密码，完成账户接管。

**项目地址:** [Shimon03/CVE-2023-7028-Account-Take-Over-Gitlab](https://github.com/Shimon03/CVE-2023-7028-Account-Take-Over-Gitlab)

**漏洞详情:** [CVE-2023-7028](https://nvd.nist.gov/vuln/detail/CVE-2023-7028)

---

## POC #5

**来源**: [CVE-2023-7028-Sornphut_CVE-2023-7028-GitLab.md](../2023/CVE-2023-7028-Sornphut_CVE-2023-7028-GitLab.md)

## CVE-2023-7028-GitLab-账户接管

**漏洞编号:** CVE-2023-7028

**漏洞类型:** 弱口令重置机制

**影响应用:** GitLab

**危害等级:** 高危，允许攻击者接管任何用户账户，包括管理员账户

**影响版本:** 16.1 prior to 16.1.6, 16.2 prior to 16.2.9, 16.3 prior to 16.3.7, 16.4 prior to 16.4.5, 16.5 prior to 16.5.6, 16.6 prior to 16.6.4, and 16.7 prior to 16.7.2

**利用条件:** 目标GitLab实例存在漏洞，并且攻击者能够访问网络。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-7028 存在于 GitLab 的密码重置功能中。攻击者可以通过提供两个邮箱地址（目标用户的邮箱地址和攻击者控制的邮箱地址）来触发漏洞。当用户请求密码重置时，系统会将重置链接同时发送到这两个邮箱地址。攻击者利用此漏洞可以获取重置链接，从而重置目标用户的密码，实现账户接管。

**有效性：**
根据漏洞信息和搜索结果，提供的PoC代码是有效的。多个来源表明该漏洞允许未经身份验证的攻击者执行账户接管，且CISA已将该漏洞添加到已知被利用的漏洞目录 (KEV)。PoC 代码 `attack.py` 实现了利用该漏洞的逻辑：

1.  **获取 CSRF Token：** 从密码重置页面获取 CSRF token，用于绕过 CSRF 保护。
2.  **发送重置请求：** 构造包含两个邮箱地址 (`target` 和 `evil`) 的 POST 请求到 `/users/password` 接口。`user[email][]` 参数允许传入多个邮箱地址。
3.  **账户接管：**  gitlab会给target和evil邮箱都发送重置邮件。攻击者利用发送到`evil`邮箱的重置链接来重置目标账户。

**投毒风险：**
代码中存在一定的投毒风险，但风险较低。主要风险点在于：

*   **硬编码 Flag 值：** 代码中有一行 `print(f'Flag value: {bytes.fromhex("6163636f756e745f6861636b2364").decode()}')`，这可能是作者故意添加的，用于在成功利用漏洞后显示一个“flag”，误导使用者。虽然它本身不是恶意代码，但可能被滥用，造成误导。

综合评估，投毒风险约为 5%。主要因为PoC的主要功能是实现漏洞利用，而潜在的恶意代码（硬编码flag）相对独立。

**利用方式：**
1.  确定目标GitLab实例存在漏洞。
2.  运行 PoC 脚本，指定目标用户的邮箱地址和攻击者控制的邮箱地址。
3.  检查攻击者控制的邮箱，获取密码重置链接。
4.  使用重置链接重置目标用户的密码，实现账户接管。

**命令示例：**
`python3 attack.py -u http://Target_IP:8000 -t victim@mail.gitlab.thm -e attacker@mail.gitlab.thm`


**项目地址:** [Sornphut/CVE-2023-7028-GitLab](https://github.com/Sornphut/CVE-2023-7028-GitLab)

**漏洞详情:** [CVE-2023-7028](https://nvd.nist.gov/vuln/detail/CVE-2023-7028)

---

## POC #6

**来源**: [CVE-2023-7028-Trackflaw_CVE-2023-7028-Docker.md](../2023/CVE-2023-7028-Trackflaw_CVE-2023-7028-Docker.md)

## CVE-2023-7028-GitLab-账户接管

**漏洞编号:** CVE-2023-7028

**漏洞类型:** 账户接管

**影响应用:** GitLab

**危害等级:** 高危，可导致账户完全控制，包括管理员账户

**影响版本:** 16.1 prior to 16.1.6, 16.2 prior to 16.2.9, 16.3 prior to 16.3.7, 16.4 prior to 16.4.5, 16.5 prior to 16.5.6, 16.6 prior to 16.6.4, and 16.7 prior to 16.7.2

**利用条件:** 目标GitLab实例存在漏洞，攻击者能够通过网络访问目标，并且知晓目标用户的邮箱地址

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-7028 是一个 GitLab CE/EE 的账号接管漏洞。根据漏洞描述和搜索结果，攻击者可以在用户忘记密码时，通过在密码重置请求中提供两个邮箱地址，将密码重置邮件发送到未验证的邮箱地址，从而控制目标账户。利用方式是通过修改密码重置流程，利用未验证的邮箱地址接收重置链接。提供的POC代码是使用Docker搭建一个存在漏洞的GitLab环境，方便进行漏洞验证和学习。虽然没有发现明显的恶意代码，但使用任何来源的代码都需要谨慎，需要仔细检查代码是否存在恶意行为。特别是`docker-compose.yml` 中涉及到了SMTP的配置， 如果配置不当可能导致敏感信息泄露或者被恶意利用。因此投毒风险评定为10%.

**项目地址:** [Trackflaw/CVE-2023-7028-Docker](https://github.com/Trackflaw/CVE-2023-7028-Docker)

**漏洞详情:** [CVE-2023-7028](https://nvd.nist.gov/vuln/detail/CVE-2023-7028)

---

## POC #7

**来源**: [CVE-2023-7028-Vozec_CVE-2023-7028.md](../2023/CVE-2023-7028-Vozec_CVE-2023-7028.md)

## CVE-2023-7028-GitLab-账户接管

**漏洞编号:** CVE-2023-7028

**漏洞类型:** 弱密码恢复机制

**影响应用:** GitLab

**危害等级:** 高危，可导致账户接管

**影响版本:** 16.1 prior to 16.1.6, 16.2 prior to 16.2.9, 16.3 prior to 16.3.7, 16.4 prior to 16.4.5, 16.5 prior to 16.5.6, 16.6 prior to 16.6.4, and 16.7 prior to 16.7.2

**利用条件:** 目标GitLab实例存在漏洞，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-7028是GitLab CE/EE中的一个漏洞，影响多个版本。该漏洞允许攻击者通过提供两个邮箱地址（一个是目标用户的邮箱，一个是攻击者控制的邮箱）来重置目标用户的密码。GitLab会将密码重置邮件同时发送到这两个邮箱。由于某些版本GitLab没有正确验证邮箱地址，攻击者可以利用这一点来接管目标用户的账户。

**有效性分析：**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，可以判断该漏洞利用代码的有效性较高。搜索引擎结果中多个链接都指出该漏洞是一个严重的安全问题，并且已经被公开利用。POC代码通过模拟密码重置流程，向目标用户和攻击者控制的邮箱发送密码重置请求，从而验证漏洞的存在。

**投毒风险分析：**
检查POC代码，发现其主要功能是利用1secmail.com提供的临时邮箱服务，构造包含目标用户邮箱和临时邮箱的密码重置请求。代码中存在一些小的潜在风险，例如对1secmail.com的依赖，如果该服务不可用，则POC无法正常工作。此外，代码中使用的正则表达式可能不够健壮，在某些情况下可能无法正确提取authenticity_token。考虑到这些依赖关系，投毒风险较低，大概为10%。

**利用方式：**
1.  攻击者需要知道目标用户的邮箱地址。
2.  攻击者构造一个包含目标用户邮箱和攻击者控制的邮箱的密码重置请求。
3.  攻击者发送密码重置请求到GitLab服务器。
4.  GitLab服务器将密码重置邮件同时发送到目标用户和攻击者控制的邮箱。
5.  攻击者从其控制的邮箱中获取密码重置链接，并重置目标用户的密码。
6.  攻击者使用新密码登录目标用户的账户，完成账户接管。

**项目地址:** [Vozec/CVE-2023-7028](https://github.com/Vozec/CVE-2023-7028)

**漏洞详情:** [CVE-2023-7028](https://nvd.nist.gov/vuln/detail/CVE-2023-7028)

---

## POC #8

**来源**: [CVE-2023-7028-duy-31_CVE-2023-7028.md](../2023/CVE-2023-7028-duy-31_CVE-2023-7028.md)

## CVE-2023-7028 - GitLab Account Takeover via Password Reset

**漏洞编号:** CVE-2023-7028

**漏洞类型:** 账户接管

**影响应用:** GitLab CE/EE

**危害等级:** 严重，可能导致账户完全控制，数据泄露，代码篡改等

**影响版本:** 16.1 prior to 16.1.6, 16.2 prior to 16.2.9, 16.3 prior to 16.3.7, 16.4 prior to 16.4.5, 16.5 prior to 16.5.6, 16.6 prior to 16.6.4, and 16.7 prior to 16.7.2

**利用条件:** 目标GitLab实例的版本在受影响范围内，且可以访问忘记密码重置页面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-7028 允许攻击者通过在密码重置请求中提供多个电子邮件地址，将重置邮件发送到未经授权的电子邮件地址。该漏洞存在于GitLab CE/EE 的密码重置功能中。攻击者可以利用此漏洞，控制其他用户的账户，包括管理员账户。

**利用方式：**

1.  访问GitLab实例的密码重置页面。
2.  在电子邮件输入字段中，提供目标用户的电子邮件地址以及攻击者控制的电子邮件地址。
3.  提交密码重置请求。
4.  GitLab会将密码重置链接发送到两个电子邮件地址，攻击者可以点击发送到其邮箱的链接来重置目标用户的密码。

**POC有效性：**

提供的POC脚本 `cve-2023-7028.sh` 通过构造包含多个 email 参数的 POST 请求到 `/users/password` 路径来触发漏洞。脚本首先获取 CSRF token 和 session cookie, 然后使用 curl 发送包含两个 email 地址的请求。
根据漏洞描述和搜索引擎结果，该POC是有效的。

**投毒风险分析：**

查看了提供的README.md和cve-2023-7028.sh脚本。

*   `README.md` 提供了漏洞描述，复现步骤和修复建议。
*   `cve-2023-7028.sh` 脚本的功能是利用 curl 发送构造的恶意请求，未发现任何隐藏的恶意代码。

因此，判断此仓库中不存在作者隐藏的投毒代码的概率为100%。

**项目地址:** [duy-31/CVE-2023-7028](https://github.com/duy-31/CVE-2023-7028)

**漏洞详情:** [CVE-2023-7028](https://nvd.nist.gov/vuln/detail/CVE-2023-7028)

---

## POC #9

**来源**: [CVE-2023-7028-googlei1996_CVE-2023-7028.md](../2023/CVE-2023-7028-googlei1996_CVE-2023-7028.md)

## CVE-2023-7028-GitLab账户接管

**漏洞编号:** CVE-2023-7028

**漏洞类型:** 弱口令恢复机制

**影响应用:** GitLab

**危害等级:** 高危，可能导致账户接管

**影响版本:** 16.1之前到16.1.6，16.2之前到16.2.9，16.3之前到16.3.7，16.4之前到16.4.5，16.5之前到16.5.6，16.6之前到16.6.4，以及16.7之前到16.7.2

**利用条件:** 需要目标GitLab实例存在漏洞版本且用户拥有未验证的邮箱地址

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-7028是一个GitLab的账户接管漏洞，源于其密码重置流程中的缺陷。攻击者可以在密码重置请求中提供两个邮箱地址，一个合法的已验证邮箱地址和一个攻击者控制的邮箱地址。由于漏洞，密码重置邮件可能会发送到攻击者控制的邮箱，从而允许攻击者重置目标用户的密码并接管其账户。

**有效性：**
提供的POC代码 `user[email][]=valid@email.com&user[email][]=attacker@email.com` 表明了利用该漏洞的方式，即在密码重置请求中通过 `user[email][]` 参数传递多个邮箱地址。根据漏洞信息和搜索结果，该POC是有效的。

**投毒风险：**
分析提供的漏洞利用代码文件：

*   `/tmp/39bff639f2358389df0f687fbe2dcf48/README.md` 中只包含POC代码和招聘信息。
*   `exp.png` 文件内容未知，无法分析，理论上存在一定的风险，考虑到文件类型为图片，故风险较低。

综合评估，仓库中存在作者隐藏投毒代码的风险较低，约为10%。 主要集中在`exp.png`中，但是由于图片文件类型，所以风险相对较低，且此仓库的主要信息为POC，诱导下载其他恶意代码概率较低

**利用方式：**

1.  **目标确认：** 确定目标GitLab实例的版本是否在受影响的范围内。
2.  **发起密码重置请求：** 针对目标用户的账户，发起密码重置请求。
3.  **构造恶意请求：** 在密码重置请求中，通过修改请求参数，添加两个 `user[email][]` 参数，一个参数为目标用户的已验证邮箱地址，另一个参数为攻击者控制的邮箱地址。
4.  **接收重置链接：** 如果漏洞存在，密码重置链接将会发送到攻击者控制的邮箱地址。
5.  **重置密码：** 使用攻击者邮箱收到的重置链接，重置目标用户的密码。
6.  **账户接管：** 使用新密码登录目标用户的账户，实现账户接管。

**项目地址:** [googlei1996/CVE-2023-7028](https://github.com/googlei1996/CVE-2023-7028)

**漏洞详情:** [CVE-2023-7028](https://nvd.nist.gov/vuln/detail/CVE-2023-7028)

---

## POC #10

**来源**: [CVE-2023-7028-hackeremmen_gitlab-exploit.md](../2023/CVE-2023-7028-hackeremmen_gitlab-exploit.md)

## CVE-2023-7028 - GitLab 弱密码恢复机制漏洞

**漏洞编号:** CVE-2023-7028

**漏洞类型:** 弱密码恢复机制漏洞

**影响应用:** GitLab CE/EE

**危害等级:** 高危，可导致账户接管

**影响版本:** 16.1 prior to 16.1.6, 16.2 prior to 16.2.9, 16.3 prior to 16.3.7, 16.4 prior to 16.4.5, 16.5 prior to 16.5.6, 16.6 prior to 16.6.4, and 16.7 prior to 16.7.2

**利用条件:** 目标GitLab实例存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-7028 存在于 GitLab 的密码重置功能中。攻击者可以通过在密码重置请求中提供两个邮箱地址（目标邮箱和攻击者自己的邮箱），从而使密码重置链接同时发送到这两个邮箱。攻击者可以利用收到的重置链接来重置目标用户的密码并接管其帐户。 

**有效性：** 
提供的POC代码是有效的，它利用了GitLab的弱密码恢复机制漏洞。该代码首先获取CSRF token，然后构造包含目标邮箱和攻击者邮箱的密码重置请求，最后发送请求。如果目标GitLab实例存在漏洞，攻击者将在其邮箱中收到密码重置链接，从而可以重置目标用户的密码。

**投毒风险：** 
分析了提供的POC代码后，存在轻微的投毒风险（10%）。 主要的风险点在于`attack.py`中有一行打印 `Flag value: {bytes.fromhex("6163636f756e745f6861636b2364").decode()}`， 这可能是为了迷惑使用者或用于测试目的。 但是，真正的攻击场景下，攻击者不会这样明目张胆地留下标记。总体而言，该代码的功能主要是实现漏洞利用，没有发现明显的恶意代码或后门，但`Flag value`的存在略微增加了投毒的可能。其他的投毒风险在于代码依赖的requests模块本身的安全问题，如果requests模块被篡改，则可能存在投毒风险。

**利用方式：** 
1.  **目标确定：** 确定存在漏洞的GitLab实例和目标用户。 
2.  **获取CSRF Token：**  使用POC代码中的`get_csrf_token`函数从GitLab的密码重置页面获取CSRF token。 
3.  **构造恶意请求：**  构造包含目标邮箱和攻击者邮箱的密码重置请求。POC代码使用`urllib.parse.urlencode`函数来构造请求体。 
4.  **发送请求：**  使用POC代码中的`ask_reset`函数将构造的请求发送到GitLab的密码重置端点。 
5.  **接收重置链接：**  攻击者在其邮箱中收到密码重置链接。 
6.  **重置密码：**  攻击者使用收到的重置链接重置目标用户的密码并接管其帐户。

**项目地址:** [hackeremmen/gitlab-exploit](https://github.com/hackeremmen/gitlab-exploit)

**漏洞详情:** [CVE-2023-7028](https://nvd.nist.gov/vuln/detail/CVE-2023-7028)

---

## POC #11

**来源**: [CVE-2023-7028-mochammadrafi_CVE-2023-7028.md](../2023/CVE-2023-7028-mochammadrafi_CVE-2023-7028.md)

## CVE-2023-7028-GitLab-账户接管

**漏洞编号:** CVE-2023-7028

**漏洞类型:** 账户接管

**影响应用:** GitLab

**危害等级:** 严重，可能导致账户完全控制

**影响版本:** 16.1 直到 16.1.6, 16.2 直到 16.2.9, 16.3 直到 16.3.7, 16.4 直到 16.4.5, 16.5 直到 16.5.6, 16.6 直到 16.6.4, and 16.7 直到 16.7.2

**利用条件:** 需要未打补丁的GitLab实例，以及目标用户的邮箱地址

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-7028 允许攻击者通过在密码重置过程中利用 email[] 参数，将重置邮件发送到攻击者控制的邮箱，从而接管受害者账户。 

**有效性:**

根据漏洞库信息、搜索引擎结果（特别是HackerOne报告）以及提供的PoC代码，此漏洞的PoC代码是有效的。 PoC 代码通过构造包含两个email参数（目标email和攻击者控制的email）的POST请求到 `/users/password` 端点，利用了 GitLab 的密码重置逻辑缺陷。

**投毒风险:**

检查PoC代码，没有发现明显的恶意代码。所有操作都集中在利用GitLab的密码重置功能。 该脚本的目的就是发送密码重置请求，并打印是否成功。没有发现任何尝试修改文件、执行系统命令或者进行其他恶意操作的代码。 因此，投毒风险为 0%。

**利用方式:**

1.  攻击者需要知道目标用户的邮箱地址。
2.  攻击者向GitLab的密码重置页面（`/users/password/new`）发送一个POST请求。
3.  POST请求的 `user[email][]` 参数包含两个邮箱地址：目标用户的邮箱和攻击者控制的邮箱。
4.  由于漏洞，GitLab会将密码重置邮件同时发送到这两个邮箱。
5.  攻击者通过其控制的邮箱中的链接重置目标用户的密码，从而接管账户。

此漏洞的关键在于`user[email][]`参数的利用，允许同时指定多个邮箱地址，而GitLab没有正确验证或处理这些邮箱地址，导致重置邮件发送到未经授权的邮箱。


**项目地址:** [mochammadrafi/CVE-2023-7028](https://github.com/mochammadrafi/CVE-2023-7028)

**漏洞详情:** [CVE-2023-7028](https://nvd.nist.gov/vuln/detail/CVE-2023-7028)

---

## POC #12

**来源**: [CVE-2023-7028-sariamubeen_CVE-2023-7028.md](../2023/CVE-2023-7028-sariamubeen_CVE-2023-7028.md)

## CVE-2023-7028-GitLab-账户接管

**漏洞编号:** CVE-2023-7028

**漏洞类型:** 弱口令找回机制漏洞

**影响应用:** GitLab

**危害等级:** 高危，可导致任意用户账户接管，包括管理员账户

**影响版本:** 16.1之前到16.1.6, 16.2之前到16.2.9, 16.3之前到16.3.7, 16.4之前到16.4.5, 16.5之前到16.5.6, 16.6之前到16.6.4, 和 16.7之前到16.7.2

**利用条件:** 需要知道目标用户的邮箱地址，并且GitLab实例存在漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-7028是GitLab中一个严重的漏洞，攻击者可以利用该漏洞通过伪造密码重置请求来接管任何用户的帐户。该漏洞存在于密码重置功能中，允许攻击者在重置密码时提供两个电子邮件地址：受害者电子邮件地址和攻击者控制的电子邮件地址。GitLab会将密码重置链接同时发送到这两个地址。攻击者可以点击发送到其邮箱的链接，设置新密码，从而控制受害者的帐户。

**漏洞利用方式：**

1.  **目标锁定：** 攻击者需要确定目标GitLab实例和受害者的电子邮件地址。
2.  **构造恶意请求：** 攻击者使用提供的POC代码（`attack.py`）构造一个包含两个电子邮件地址的密码重置请求：一个是受害者的电子邮件地址，另一个是攻击者控制的电子邮件地址。
3.  **发送请求：**  攻击者将构造的恶意请求发送到GitLab服务器的 `/users/password` 端点。
4.  **接管账户：** GitLab服务器会向两个电子邮件地址发送密码重置链接。攻击者访问自己邮箱中的链接，设置新的密码，然后使用新密码登录受害者的帐户。

**有效性：**
根据漏洞信息、搜索引擎结果以及提供的PoC代码，可以判断该PoC代码是有效的。漏洞库信息显示该漏洞危害严重，CVSS评分高达10。搜索引擎结果中大量的文章和讨论也验证了该漏洞的真实性和可利用性。PoC代码的结构清晰，逻辑简单，易于理解和使用，验证了其有效性。

**投毒风险：**
对PoC代码进行了分析，没有发现任何明显的投毒代码。代码的功能是模拟密码重置过程，向指定的邮箱发送重置链接。虽然攻击者可以利用此代码进行恶意攻击，但代码本身并没有包含任何隐藏的、非预期的恶意行为。从代码的实现来看，主要功能是发送包含target和evil邮箱的密码重置请求，没有其他恶意操作，比如植入后门，收集信息等。因此投毒风险较低，评估为0%。需要注意的是，使用该PoC进行未授权的渗透测试属于非法行为。

**项目地址:** [sariamubeen/CVE-2023-7028](https://github.com/sariamubeen/CVE-2023-7028)

**漏洞详情:** [CVE-2023-7028](https://nvd.nist.gov/vuln/detail/CVE-2023-7028)

---

## POC #13

**来源**: [CVE-2023-7028-soltanali0_CVE-2023-7028.md](../2023/CVE-2023-7028-soltanali0_CVE-2023-7028.md)

## CVE-2023-7028-GitLab-账户接管

**漏洞编号:** CVE-2023-7028

**漏洞类型:** 弱密码恢复机制

**影响应用:** GitLab

**危害等级:** 高危，可导致账户接管

**影响版本:** 16.1 prior to 16.1.6, 16.2 prior to 16.2.9, 16.3 prior to 16.3.7, 16.4 prior to 16.4.5, 16.5 prior to 16.5.6, 16.6 prior to 16.6.4, and 16.7 prior to 16.7.2

**利用条件:** 目标GitLab实例存在漏洞且可公开访问或攻击者可以发送请求到目标实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-7028 是 GitLab CE/EE 版本 16.1 到 16.7 中存在的一个关键漏洞。该漏洞源于密码重置流程中对邮箱地址的校验不严格，攻击者可以通过在密码重置请求中提供两个邮箱地址（一个受害者邮箱，一个攻击者邮箱）来将密码重置邮件发送到未验证的邮箱地址，从而实现账户接管。

**利用方式：**

1.  **目标确定：**  确定存在漏洞的 GitLab 实例。
2.  **发起密码重置请求：**  使用受害者邮箱地址和攻击者控制的邮箱地址，构造恶意的密码重置请求。
3.  **获取重置链接：**  在攻击者控制的邮箱中获取密码重置链接。
4.  **重置密码：**  使用重置链接重置受害者账户的密码。
5.  **账户接管：**  使用新密码登录受害者账户，完成账户接管。

**有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断该POC代码有效， 因为CISA已经将此漏洞加入到已知被利用的漏洞列表，证明该漏洞真实存在，并且已经被攻击者利用。

**投毒风险：**

提供的POC代码主要包含一个`exploit.py`脚本和一个`docker-compose.yml`文件。

*   `docker-compose.yml` 文件用于快速部署一个存在漏洞的GitLab实例，方便漏洞验证，本身不包含恶意代码。
*   `exploit.py` 脚本实现了漏洞利用的自动化， 其中使用OneSecMail_api来获取临时邮箱接收重置密码的链接,代码较为清晰,主要功能是构造恶意请求,没有发现明显的恶意代码。但是利用了第三方临时邮箱，可能会导致token泄漏，存在一定的风险。

**风险评估:**

该漏洞的利用难度较低，且影响严重，建议及时升级 GitLab 版本以修复此漏洞。

**投毒风险评估：**

虽然整体代码看起来较为直接，没有明显的后门或恶意行为。 但是依然存在一些潜在的风险，故给出10%的投毒风险。例如利用临时邮箱存在不稳定性，依赖于外部API，API失效会导致POC无法使用等。

**项目地址:** [soltanali0/CVE-2023-7028](https://github.com/soltanali0/CVE-2023-7028)

**漏洞详情:** [CVE-2023-7028](https://nvd.nist.gov/vuln/detail/CVE-2023-7028)

---

## POC #14

**来源**: [CVE-2023-7028-szybnev_CVE-2023-7028.md](../2023/CVE-2023-7028-szybnev_CVE-2023-7028.md)

## CVE-2023-7028-GitLab-账号接管

**漏洞编号:** CVE-2023-7028

**漏洞类型:** 弱密码恢复机制

**影响应用:** GitLab

**危害等级:** 高危，可导致账户接管

**影响版本:** 16.1 prior to 16.1.6, 16.2 prior to 16.2.9, 16.3 prior to 16.3.7, 16.4 prior to 16.4.5, 16.5 prior to 16.5.6, 16.6 prior to 16.6.4, and 16.7 prior to 16.7.2

**利用条件:** 目标GitLab实例存在漏洞，且攻击者已知目标用户的邮箱地址

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-7028是GitLab CE/EE中的一个严重漏洞，允许攻击者通过向未验证的邮箱地址发送密码重置邮件来接管用户账户。漏洞存在于密码重置流程中，攻击者可以在重置密码时，将目标用户的邮箱和攻击者控制的邮箱同时添加到请求参数中，从而导致重置邮件同时发送到这两个邮箱。攻击者通过获取发送到自己邮箱的重置链接，可以重置目标用户的密码，进而接管其账户。

**有效性：** 提供的POC代码利用了该漏洞，通过构造包含目标用户邮箱和攻击者邮箱的请求来触发密码重置流程，并从临时邮箱服务(1secmail.com)获取重置链接以完成密码重置，从而验证漏洞的有效性。

**投毒风险：** 代码中使用了`1secmail.com`这个临时邮箱服务，目的是为了方便漏洞利用的自动化，本身不属于投毒行为。主要关注点在于是否存在恶意代码植入。代码存在通过网络请求获取和发送数据行为，理论上存在被篡改的风险，但从代码逻辑来看，没有发现明显的后门或恶意行为。考虑到代码较长，存在一定的隐藏风险，但整体风险较低，估计在10%左右。

**利用方式：**
1.  攻击者需要知道目标GitLab实例的URL和目标用户的邮箱地址。
2.  攻击者运行POC脚本，脚本会自动创建一个临时邮箱(如果攻击者没有指定自己的邮箱)。
3.  脚本构造一个包含目标用户邮箱和临时邮箱的密码重置请求，并发送到GitLab服务器。
4.  GitLab服务器会将密码重置链接同时发送到目标用户邮箱和临时邮箱。
5.  脚本从临时邮箱中获取密码重置链接。
6.  脚本使用该链接重置目标用户的密码，从而接管其账户。

**项目地址:** [szybnev/CVE-2023-7028](https://github.com/szybnev/CVE-2023-7028)

**漏洞详情:** [CVE-2023-7028](https://nvd.nist.gov/vuln/detail/CVE-2023-7028)

---

## POC #15

**来源**: [CVE-2023-7028-thanhlam-attt_CVE-2023-7028.md](../2023/CVE-2023-7028-thanhlam-attt_CVE-2023-7028.md)

## CVE-2023-7028 - GitLab Account Takeover

**漏洞编号:** CVE-2023-7028

**漏洞类型:** 账号接管

**影响应用:** GitLab CE/EE

**危害等级:** 高危，可能导致账号接管，数据泄露，权限提升

**影响版本:** 16.1 to 16.1.5, 16.2 to 16.2.8, 16.3 to 16.3.6, 16.4 to 16.4.4, 16.5 to 16.5.5, 16.6 to 16.6.3, 16.7 to 16.7.1

**利用条件:** 目标GitLab实例存在漏洞且可访问密码重置页面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-7028 是一个存在于 GitLab CE/EE 的密码重置功能中的账号接管漏洞。未经身份验证的攻击者可以通过向密码重置端点提供多个电子邮件地址，从而将密码重置链接发送到攻击者控制的电子邮件地址，进而接管受害者帐户。 

**有效性分析：**
提供的 PoC 代码 `CVE-2023-7028 PoC.py` 看起来有效，因为它实现了漏洞利用所需的步骤。 它首先获取 `authenticity_token` 和 `_gitlab_session` cookie。 然后，它构造一个包含受害者和攻击者电子邮件地址的恶意请求，并将其发送到密码重置端点。 如果漏洞存在，则攻击者将收到密码重置链接。

**投毒风险分析：**
PoC 代码本身看起来没有明显的投毒行为。代码逻辑相对简单，主要功能就是利用漏洞，没有发现隐藏的恶意代码或后门。但是，任何从外部来源获取的代码都存在一定的风险，需要仔细审查。 这里给出的投毒风险评分为5%，主要考虑到以下几点：
*   代码依赖 `requests` 和 `colorama` 两个库，这些库本身存在被供应链攻击的风险。
*   虽然代码主体功能明确，但无法完全排除作者在代码中隐藏不明显恶意行为的可能性。
*   代码从 GitLab 实例获取 token 和 cookie，如果 GitLab 实例本身被入侵，获取到的 token 和 cookie 可能已经被篡改。

**利用方式：**
1.  **目标确认：** 确认目标 GitLab 实例的版本在受影响的范围内。
2.  **获取必要信息：** 使用 PoC 脚本的 `get_token` 函数从目标 GitLab 实例的密码重置页面获取 `authenticity_token` 和 `_gitlab_session` cookie。
3.  **构造恶意请求：** 使用获取到的 `authenticity_token` 和 `_gitlab_session` cookie，以及受害者和攻击者的电子邮件地址，构造一个包含两个电子邮件地址的 POST 请求，发送到 `/users/password` 端点。`user[email][]` 参数包含受害者和攻击者的电子邮件地址。
4.  **接收重置链接：** 如果漏洞存在，攻击者的电子邮件地址将收到密码重置链接。
5.  **重置密码：** 攻击者使用收到的密码重置链接重置受害者帐户的密码。
6.  **接管帐户：** 攻击者使用新密码登录受害者帐户。

**项目地址:** [thanhlam-attt/CVE-2023-7028](https://github.com/thanhlam-attt/CVE-2023-7028)

**漏洞详情:** [CVE-2023-7028](https://nvd.nist.gov/vuln/detail/CVE-2023-7028)

---

## POC #16

**来源**: [CVE-2023-7028-yoryio_CVE-2023-7028.md](../2023/CVE-2023-7028-yoryio_CVE-2023-7028.md)

## CVE-2023-7028 - GitLab Account Takeover

**漏洞编号:** CVE-2023-7028

**漏洞类型:** Account Takeover

**影响应用:** GitLab CE/EE

**危害等级:** 高危，可导致未经授权的账户访问和控制

**影响版本:** 16.1 prior to 16.1.6, 16.2 prior to 16.2.9, 16.3 prior to 16.3.7, 16.4 prior to 16.4.5, 16.5 prior to 16.5.6, 16.6 prior to 16.6.4, and 16.7 prior to 16.7.2

**利用条件:** 目标GitLab实例需要存在漏洞，并且攻击者需要知道目标用户的邮箱地址。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-7028是一个GitLab CE/EE中的账户接管漏洞。该漏洞源于密码重置流程中的缺陷，允许攻击者通过向目标用户和一个攻击者控制的邮箱地址同时发送密码重置邮件，从而接管目标账户。攻击者通过提供两个邮箱地址（目标用户的邮箱和攻击者的邮箱）到密码重置接口，GitLab会将密码重置链接发送到两个邮箱。攻击者利用这一点，便可以重置目标用户的密码。POC代码通过发送包含目标用户邮箱和攻击者邮箱的POST请求到/users/password接口来触发密码重置流程。经过分析，仓库中存在投毒代码的可能性较低，主要集中于利用环节，通过双邮箱进行重置，但考虑到存在引入恶意依赖或者其他未知风险，因此判定为5% 。

**项目地址:** [yoryio/CVE-2023-7028](https://github.com/yoryio/CVE-2023-7028)

**漏洞详情:** [CVE-2023-7028](https://nvd.nist.gov/vuln/detail/CVE-2023-7028)

---

