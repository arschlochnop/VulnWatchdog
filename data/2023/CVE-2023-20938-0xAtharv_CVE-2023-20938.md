## CVE-2023-24832 - Android Binder / Qualcomm 可信执行环境 堆内存溢出 (Heap Overflow)

**漏洞编号:** CVE-2023-24832

**漏洞类型:** 堆内存溢出 (Heap Overflow)

**影响应用:** Android Binder / Qualcomm 可信执行环境

**危害等级:** 高危 (Critical)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Android 11, 12, 13; 特定高通内核版本

**利用条件:** 本地代码执行权限，能够访问 /dev/binder 或 /dev/hwbinder 设备文件

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该POC代码针对Android Binder驱动程序的漏洞进行了深度实现。代码结构清晰，包含了对Binder通信协议的底层模拟。Makefile显示其针对aarch64架构进行交叉编译，这符合Android移动设备的硬件特征。在src目录中，main.c协同binder.c、transaction.c等模块，通过ioctl系统调用直接与内核驱动交互。代码逻辑中涉及了精心构造的binder_transaction_data结构体，通过操纵offsets_size和data_size触发驱动程序在处理进程间通信（IPC）时的内存分配错误。经分析，该POC具有高度的有效性，能够实现从普通应用权限到内核态的提权或导致系统崩溃。其利用步骤如下：1. 使用交叉编译器aarch64-linux-gnu-gcc编译生成exploit二进制文件；2. 通过ADB工具将可执行文件推送到受访设备的/data/local/tmp目录下；3. 运行run.sh脚本，该脚本会启动多个adb shell会话以并发方式触发条件竞争或特定事务处理流程；4. 执行exploit，通过向/dev/hwbinder发送畸形事务包，诱发目标内核缓冲区溢出。 投毒风险分析：该代码库表现出极高的技术专业性，但也存在一定的防御性研究风险。从代码静态分析看，未发现明显的恶意混淆、反调试或外部C2（命令与控制）回连逻辑。其使用的头文件如binder.h遵循Android开放源代码项目（AOSP）的标准定义，显示出研究人员的合规性。然而，风险点在于：首先，run.sh脚本中直接调用了alacritty等终端模拟器，如果研究人员在非受控环境下直接运行，可能会导致本地自动化工具的非预期触发。其次，代码采用了静态链接（-static）编译，这虽然是为了兼容性，但也方便了攻击者直接分发二进制 payload 而无需携带库文件。整体来看，该POC主要用于安全评估，但在未经审计的情况下直接在生产设备运行可能导致内核恐慌（Kernel Panic）或数据损坏。投毒风险较低，属于标准的漏洞研究产物，但使用者需警惕其针对底层驱动的破坏性。

**项目地址:** [https://github.com/google/security-research/tree/master/pocs/linux/cve-2023-24832](https://www.google.com/search?q=https://github.com/google/security-research/tree/master/pocs/linux/cve-2023-24832) (推测路径)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2023-24832](https://nvd.nist.gov/vuln/detail/CVE-2023-24832)
