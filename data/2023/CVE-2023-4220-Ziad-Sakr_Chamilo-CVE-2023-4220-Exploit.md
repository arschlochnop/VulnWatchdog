## CVE-2023-4220 - Chamilo LMS RCE (远程代码执行)

**漏洞编号:** CVE-2023-4220

**漏洞类型:** RCE (远程代码执行)

**影响应用:** Chamilo LMS

**危害等级:** High/Critical

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** <= 1.11.24

**利用条件:** 无需身份验证，能够通过网络访问受影响的 bigUpload.php 路径

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：该POC脚本（CVE-2023-4220.sh）针对Chamilo LMS中由于 bigUpload 功能缺乏文件过滤而导致的任意文件上传漏洞。脚本通过向 /main/inc/lib/javascript/bigupload/inc/bigUpload.php 接口发送带有 'action=post-unsupported' 参数的 POST 请求，将用户指定的恶意文件（通常为 PHP Shell）上传至服务器。利用步骤如下：1. 攻击者准备一个包含反弹 Shell 代码的 PHP 文件；2. 运行脚本，使用 -f 参数指定文件，-h 指定目标主机，-p 指定监听端口；3. 脚本通过 curl 执行 multipart/form-data 上传；4. 文件成功上传后，存放于 /main/inc/lib/javascript/bigupload/files/ 目录下；5. 脚本自动发起第二个 curl 请求触发该上传的文件，同时在本地使用 nc (netcat) 开启监听，等待目标服务器回连。该 POC 逻辑清晰、变量定义明确，直接对应了漏洞点，具有极高的实战复现价值。投毒风险分析：经过对脚本源码的详细审计，该脚本主要由标准的 Bash 命令、选项处理逻辑及 curl 请求组成。脚本中唯一的外部连接指向用户输入的目标主机 ($host_link)，不存在向未声明的第三方服务器发送敏感数据（如凭证、环境变量等）的行为。脚本末尾附带的 TTY 交互命令属于标准的渗透测试后处理技巧，旨在提升 Shell 的可用性，不属于恶意后门代码。脚本未执行任何二进制混淆、Base64 加密或远程脚本执行（如 curl | sh）。唯一的潜在风险点在于用户需确保 -f 参数指定的文件是自己受控的，而非来自不可信来源。整体代码透明，属于典型的防御性研究或合法渗透测试工具，投毒风险极低，仅为常规的安全合规性提醒评分。

**项目地址:** [https://github.com/Ziad-Sakr/Chamilo-LMS-CVE-2023-4220-Exploit](https://github.com/Ziad-Sakr/Chamilo-LMS-CVE-2023-4220-Exploit)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)
