# CVE-2023-41892

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-41892-0xfalafel_CraftCMS_CVE-2023-41892.md](../2023/CVE-2023-41892-0xfalafel_CraftCMS_CVE-2023-41892.md)

## CVE-2023-41892 - Craft CMS Remote Code Execution

**漏洞编号:** CVE-2023-41892

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Craft CMS

**危害等级:** Critical，未经身份验证的远程代码执行，可能导致完全控制服务器

**影响版本:** 4.0.0-RC1 to 4.4.14

**利用条件:** 目标 Craft CMS 版本在受影响范围内，且可通过 HTTP/HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-41892 允许未经身份验证的攻击者在 Craft CMS 服务器上执行任意代码。利用方式涉及：

1.  **信息收集 (phpinfo)：** 首先，利用`/index.php?action=conditions/render`端点和特制的`config`参数，执行`phpinfo()`来获取服务器的配置信息，特别是`upload_tmp_dir`（临时目录）和`$_SERVER['DOCUMENT_ROOT']`（文档根目录）。`FnStream`类被利用来执行`phpinfo()`函数。
2.  **Webshell 上传 (MSL + Imagick)：** 接着，攻击者创建一个包含 PHP 代码的 MSL（Magick Scripting Language）文件，该文件会将 PHP 代码写入 webshell (`shell.php`)。此 webshell 包含执行命令的代码。该文件通过POST请求上传到`/index.php?action=conditions/render` 端点。`Imagick`类被利用来读取和写入文件。
3.  **Webshell 移动 (Imagick)：** 使用`Imagick`类移动 webshell 到 web 根目录。这个操作同样通过发送 POST 请求到 `/index.php?action=conditions/render`端点完成。
4.  **远程代码执行：** 一旦 webshell 被成功部署，攻击者就可以通过发送带有 `cmd` 参数的 HTTP 请求到 `shell.php` 来执行任意命令。
5.  **交互式 Shell：** POC 代码包含一个简单的交互式 shell，允许攻击者输入命令并查看结果。

**投毒风险分析：**

该 POC 脚本的主要功能是利用漏洞在目标服务器上创建并使用 Webshell。虽然脚本本身不包含明显的恶意或隐藏代码，但存在以下潜在的投毒风险：

*   **依赖项风险：** 脚本依赖于 `requests` 库。如果攻击者提供了一个包含恶意依赖项的 requirements.txt 文件，或者诱导用户从非官方源安装 `requests`，则可能引入恶意代码。
*   **Webshell 利用风险：** 即使脚本本身没有投毒，攻击者也可能在成功部署 Webshell 后，通过 Webshell 上传和执行其他恶意脚本，例如后门、恶意软件等。
*   **配置信息泄露：**脚本尝试通过phpinfo函数获取配置信息，有概率会泄露服务器的敏感信息，可能被攻击者利用。
*  **代码可读性较差:** 代码风格和错误处理较为简单，缺少代码注释，可能隐藏恶意逻辑。

综上所述，该 POC 脚本的投毒风险较低，但不能完全排除。风险主要来自依赖项和 Webshell 的潜在滥用。


**项目地址:** [0xfalafel/CraftCMS_CVE-2023-41892](https://github.com/0xfalafel/CraftCMS_CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #2

**来源**: [CVE-2023-41892-CERTologists_HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892.md](../2023/CVE-2023-41892-CERTologists_HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892.md)

## CVE-2023-41892-Craft CMS-远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行

**影响应用:** Craft CMS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 4.4.14

**利用条件:** 需要网络访问，目标服务器运行Craft CMS且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-41892是Craft CMS中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响Craft CMS 4.4.14及更早版本。攻击者可以通过发送特制的请求，利用PHP反序列化漏洞执行任意代码。

**有效性：**
提供的POC代码模拟了一个利用PHP对象注入漏洞的场景。它首先定义了一个`SafeOperation`类，该类包含一个魔术方法`__destruct`，该方法在对象被销毁时触发。通过控制`logMessage`属性，可以调用`logExampleMessage`方法。POC代码接收一个包含序列化对象的`config`参数，并使用`unserialize`函数反序列化该对象。如果可以控制反序列化的内容，则可以触发任意代码执行。

**投毒风险：**
提供的代码主要用于展示PHP反序列化漏洞，本身没有明显的恶意行为，但也不排除隐藏的风险。`The request`文件中的`unserialize`操作是高危点，如果攻击者能够控制反序列化的字符串内容，则可以利用该点执行任意代码。`Readme`文件中的缓解策略，也说明了unserialize的风险，但具体是否存在后门要取决于部署环境和是否有其他依赖组件被引入。 因此投毒风险评估为10%,风险主要来自于使用者对漏洞理解不透彻，直接将后门代码引入。

**利用方式：**
1.  攻击者构造一个包含恶意类的序列化字符串。
2.  将该序列化字符串作为`config`参数的值发送给目标服务器。
3.  目标服务器使用`unserialize`函数反序列化该字符串。
4.  如果反序列化成功，且恶意类中包含魔术方法（如`__destruct`），则该方法将被自动调用。
5.  攻击者可以在魔术方法中执行任意代码，从而实现远程代码执行。

**项目地址:** [CERTologists/HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892](https://github.com/CERTologists/HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #3

**来源**: [CVE-2023-41892-acesoyeo_CVE-2023-41892.md](../2023/CVE-2023-41892-acesoyeo_CVE-2023-41892.md)

# CVE-2023-41892

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-41892-0xfalafel_CraftCMS_CVE-2023-41892.md](../2023/CVE-2023-41892-0xfalafel_CraftCMS_CVE-2023-41892.md)

## CVE-2023-41892 - Craft CMS Remote Code Execution

**漏洞编号:** CVE-2023-41892

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Craft CMS

**危害等级:** Critical，未经身份验证的远程代码执行，可能导致完全控制服务器

**影响版本:** 4.0.0-RC1 to 4.4.14

**利用条件:** 目标 Craft CMS 版本在受影响范围内，且可通过 HTTP/HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-41892 允许未经身份验证的攻击者在 Craft CMS 服务器上执行任意代码。利用方式涉及：

1.  **信息收集 (phpinfo)：** 首先，利用`/index.php?action=conditions/render`端点和特制的`config`参数，执行`phpinfo()`来获取服务器的配置信息，特别是`upload_tmp_dir`（临时目录）和`$_SERVER['DOCUMENT_ROOT']`（文档根目录）。`FnStream`类被利用来执行`phpinfo()`函数。
2.  **Webshell 上传 (MSL + Imagick)：** 接着，攻击者创建一个包含 PHP 代码的 MSL（Magick Scripting Language）文件，该文件会将 PHP 代码写入 webshell (`shell.php`)。此 webshell 包含执行命令的代码。该文件通过POST请求上传到`/index.php?action=conditions/render` 端点。`Imagick`类被利用来读取和写入文件。
3.  **Webshell 移动 (Imagick)：** 使用`Imagick`类移动 webshell 到 web 根目录。这个操作同样通过发送 POST 请求到 `/index.php?action=conditions/render`端点完成。
4.  **远程代码执行：** 一旦 webshell 被成功部署，攻击者就可以通过发送带有 `cmd` 参数的 HTTP 请求到 `shell.php` 来执行任意命令。
5.  **交互式 Shell：** POC 代码包含一个简单的交互式 shell，允许攻击者输入命令并查看结果。

**投毒风险分析：**

该 POC 脚本的主要功能是利用漏洞在目标服务器上创建并使用 Webshell。虽然脚本本身不包含明显的恶意或隐藏代码，但存在以下潜在的投毒风险：

*   **依赖项风险：** 脚本依赖于 `requests` 库。如果攻击者提供了一个包含恶意依赖项的 requirements.txt 文件，或者诱导用户从非官方源安装 `requests`，则可能引入恶意代码。
*   **Webshell 利用风险：** 即使脚本本身没有投毒，攻击者也可能在成功部署 Webshell 后，通过 Webshell 上传和执行其他恶意脚本，例如后门、恶意软件等。
*   **配置信息泄露：**脚本尝试通过phpinfo函数获取配置信息，有概率会泄露服务器的敏感信息，可能被攻击者利用。
*  **代码可读性较差:** 代码风格和错误处理较为简单，缺少代码注释，可能隐藏恶意逻辑。

综上所述，该 POC 脚本的投毒风险较低，但不能完全排除。风险主要来自依赖项和 Webshell 的潜在滥用。


**项目地址:** [0xfalafel/CraftCMS_CVE-2023-41892](https://github.com/0xfalafel/CraftCMS_CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #2

**来源**: [CVE-2023-41892-CERTologists_HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892.md](../2023/CVE-2023-41892-CERTologists_HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892.md)

## CVE-2023-41892-Craft CMS-远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行

**影响应用:** Craft CMS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 4.4.14

**利用条件:** 需要网络访问，目标服务器运行Craft CMS且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-41892是Craft CMS中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响Craft CMS 4.4.14及更早版本。攻击者可以通过发送特制的请求，利用PHP反序列化漏洞执行任意代码。

**有效性：**
提供的POC代码模拟了一个利用PHP对象注入漏洞的场景。它首先定义了一个`SafeOperation`类，该类包含一个魔术方法`__destruct`，该方法在对象被销毁时触发。通过控制`logMessage`属性，可以调用`logExampleMessage`方法。POC代码接收一个包含序列化对象的`config`参数，并使用`unserialize`函数反序列化该对象。如果可以控制反序列化的内容，则可以触发任意代码执行。

**投毒风险：**
提供的代码主要用于展示PHP反序列化漏洞，本身没有明显的恶意行为，但也不排除隐藏的风险。`The request`文件中的`unserialize`操作是高危点，如果攻击者能够控制反序列化的字符串内容，则可以利用该点执行任意代码。`Readme`文件中的缓解策略，也说明了unserialize的风险，但具体是否存在后门要取决于部署环境和是否有其他依赖组件被引入。 因此投毒风险评估为10%,风险主要来自于使用者对漏洞理解不透彻，直接将后门代码引入。

**利用方式：**
1.  攻击者构造一个包含恶意类的序列化字符串。
2.  将该序列化字符串作为`config`参数的值发送给目标服务器。
3.  目标服务器使用`unserialize`函数反序列化该字符串。
4.  如果反序列化成功，且恶意类中包含魔术方法（如`__destruct`），则该方法将被自动调用。
5.  攻击者可以在魔术方法中执行任意代码，从而实现远程代码执行。

**项目地址:** [CERTologists/HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892](https://github.com/CERTologists/HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #3

**来源**: [CVE-2023-41892-acesoyeo_CVE-2023-41892.md](../2023/CVE-2023-41892-acesoyeo_CVE-2023-41892.md)

# CVE-2023-41892

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-41892-0xfalafel_CraftCMS_CVE-2023-41892.md](../2023/CVE-2023-41892-0xfalafel_CraftCMS_CVE-2023-41892.md)

## CVE-2023-41892 - Craft CMS Remote Code Execution

**漏洞编号:** CVE-2023-41892

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Craft CMS

**危害等级:** Critical，未经身份验证的远程代码执行，可能导致完全控制服务器

**影响版本:** 4.0.0-RC1 to 4.4.14

**利用条件:** 目标 Craft CMS 版本在受影响范围内，且可通过 HTTP/HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-41892 允许未经身份验证的攻击者在 Craft CMS 服务器上执行任意代码。利用方式涉及：

1.  **信息收集 (phpinfo)：** 首先，利用`/index.php?action=conditions/render`端点和特制的`config`参数，执行`phpinfo()`来获取服务器的配置信息，特别是`upload_tmp_dir`（临时目录）和`$_SERVER['DOCUMENT_ROOT']`（文档根目录）。`FnStream`类被利用来执行`phpinfo()`函数。
2.  **Webshell 上传 (MSL + Imagick)：** 接着，攻击者创建一个包含 PHP 代码的 MSL（Magick Scripting Language）文件，该文件会将 PHP 代码写入 webshell (`shell.php`)。此 webshell 包含执行命令的代码。该文件通过POST请求上传到`/index.php?action=conditions/render` 端点。`Imagick`类被利用来读取和写入文件。
3.  **Webshell 移动 (Imagick)：** 使用`Imagick`类移动 webshell 到 web 根目录。这个操作同样通过发送 POST 请求到 `/index.php?action=conditions/render`端点完成。
4.  **远程代码执行：** 一旦 webshell 被成功部署，攻击者就可以通过发送带有 `cmd` 参数的 HTTP 请求到 `shell.php` 来执行任意命令。
5.  **交互式 Shell：** POC 代码包含一个简单的交互式 shell，允许攻击者输入命令并查看结果。

**投毒风险分析：**

该 POC 脚本的主要功能是利用漏洞在目标服务器上创建并使用 Webshell。虽然脚本本身不包含明显的恶意或隐藏代码，但存在以下潜在的投毒风险：

*   **依赖项风险：** 脚本依赖于 `requests` 库。如果攻击者提供了一个包含恶意依赖项的 requirements.txt 文件，或者诱导用户从非官方源安装 `requests`，则可能引入恶意代码。
*   **Webshell 利用风险：** 即使脚本本身没有投毒，攻击者也可能在成功部署 Webshell 后，通过 Webshell 上传和执行其他恶意脚本，例如后门、恶意软件等。
*   **配置信息泄露：**脚本尝试通过phpinfo函数获取配置信息，有概率会泄露服务器的敏感信息，可能被攻击者利用。
*  **代码可读性较差:** 代码风格和错误处理较为简单，缺少代码注释，可能隐藏恶意逻辑。

综上所述，该 POC 脚本的投毒风险较低，但不能完全排除。风险主要来自依赖项和 Webshell 的潜在滥用。


**项目地址:** [0xfalafel/CraftCMS_CVE-2023-41892](https://github.com/0xfalafel/CraftCMS_CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #2

**来源**: [CVE-2023-41892-CERTologists_HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892.md](../2023/CVE-2023-41892-CERTologists_HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892.md)

## CVE-2023-41892-Craft CMS-远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行

**影响应用:** Craft CMS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 4.4.14

**利用条件:** 需要网络访问，目标服务器运行Craft CMS且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-41892是Craft CMS中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响Craft CMS 4.4.14及更早版本。攻击者可以通过发送特制的请求，利用PHP反序列化漏洞执行任意代码。

**有效性：**
提供的POC代码模拟了一个利用PHP对象注入漏洞的场景。它首先定义了一个`SafeOperation`类，该类包含一个魔术方法`__destruct`，该方法在对象被销毁时触发。通过控制`logMessage`属性，可以调用`logExampleMessage`方法。POC代码接收一个包含序列化对象的`config`参数，并使用`unserialize`函数反序列化该对象。如果可以控制反序列化的内容，则可以触发任意代码执行。

**投毒风险：**
提供的代码主要用于展示PHP反序列化漏洞，本身没有明显的恶意行为，但也不排除隐藏的风险。`The request`文件中的`unserialize`操作是高危点，如果攻击者能够控制反序列化的字符串内容，则可以利用该点执行任意代码。`Readme`文件中的缓解策略，也说明了unserialize的风险，但具体是否存在后门要取决于部署环境和是否有其他依赖组件被引入。 因此投毒风险评估为10%,风险主要来自于使用者对漏洞理解不透彻，直接将后门代码引入。

**利用方式：**
1.  攻击者构造一个包含恶意类的序列化字符串。
2.  将该序列化字符串作为`config`参数的值发送给目标服务器。
3.  目标服务器使用`unserialize`函数反序列化该字符串。
4.  如果反序列化成功，且恶意类中包含魔术方法（如`__destruct`），则该方法将被自动调用。
5.  攻击者可以在魔术方法中执行任意代码，从而实现远程代码执行。

**项目地址:** [CERTologists/HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892](https://github.com/CERTologists/HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #3

**来源**: [CVE-2023-41892-acesoyeo_CVE-2023-41892.md](../2023/CVE-2023-41892-acesoyeo_CVE-2023-41892.md)

# CVE-2023-41892

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-41892-0xfalafel_CraftCMS_CVE-2023-41892.md](../2023/CVE-2023-41892-0xfalafel_CraftCMS_CVE-2023-41892.md)

## CVE-2023-41892 - Craft CMS Remote Code Execution

**漏洞编号:** CVE-2023-41892

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Craft CMS

**危害等级:** Critical，未经身份验证的远程代码执行，可能导致完全控制服务器

**影响版本:** 4.0.0-RC1 to 4.4.14

**利用条件:** 目标 Craft CMS 版本在受影响范围内，且可通过 HTTP/HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-41892 允许未经身份验证的攻击者在 Craft CMS 服务器上执行任意代码。利用方式涉及：

1.  **信息收集 (phpinfo)：** 首先，利用`/index.php?action=conditions/render`端点和特制的`config`参数，执行`phpinfo()`来获取服务器的配置信息，特别是`upload_tmp_dir`（临时目录）和`$_SERVER['DOCUMENT_ROOT']`（文档根目录）。`FnStream`类被利用来执行`phpinfo()`函数。
2.  **Webshell 上传 (MSL + Imagick)：** 接着，攻击者创建一个包含 PHP 代码的 MSL（Magick Scripting Language）文件，该文件会将 PHP 代码写入 webshell (`shell.php`)。此 webshell 包含执行命令的代码。该文件通过POST请求上传到`/index.php?action=conditions/render` 端点。`Imagick`类被利用来读取和写入文件。
3.  **Webshell 移动 (Imagick)：** 使用`Imagick`类移动 webshell 到 web 根目录。这个操作同样通过发送 POST 请求到 `/index.php?action=conditions/render`端点完成。
4.  **远程代码执行：** 一旦 webshell 被成功部署，攻击者就可以通过发送带有 `cmd` 参数的 HTTP 请求到 `shell.php` 来执行任意命令。
5.  **交互式 Shell：** POC 代码包含一个简单的交互式 shell，允许攻击者输入命令并查看结果。

**投毒风险分析：**

该 POC 脚本的主要功能是利用漏洞在目标服务器上创建并使用 Webshell。虽然脚本本身不包含明显的恶意或隐藏代码，但存在以下潜在的投毒风险：

*   **依赖项风险：** 脚本依赖于 `requests` 库。如果攻击者提供了一个包含恶意依赖项的 requirements.txt 文件，或者诱导用户从非官方源安装 `requests`，则可能引入恶意代码。
*   **Webshell 利用风险：** 即使脚本本身没有投毒，攻击者也可能在成功部署 Webshell 后，通过 Webshell 上传和执行其他恶意脚本，例如后门、恶意软件等。
*   **配置信息泄露：**脚本尝试通过phpinfo函数获取配置信息，有概率会泄露服务器的敏感信息，可能被攻击者利用。
*  **代码可读性较差:** 代码风格和错误处理较为简单，缺少代码注释，可能隐藏恶意逻辑。

综上所述，该 POC 脚本的投毒风险较低，但不能完全排除。风险主要来自依赖项和 Webshell 的潜在滥用。


**项目地址:** [0xfalafel/CraftCMS_CVE-2023-41892](https://github.com/0xfalafel/CraftCMS_CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #2

**来源**: [CVE-2023-41892-CERTologists_HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892.md](../2023/CVE-2023-41892-CERTologists_HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892.md)

## CVE-2023-41892-Craft CMS-远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行

**影响应用:** Craft CMS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 4.4.14

**利用条件:** 需要网络访问，目标服务器运行Craft CMS且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-41892是Craft CMS中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响Craft CMS 4.4.14及更早版本。攻击者可以通过发送特制的请求，利用PHP反序列化漏洞执行任意代码。

**有效性：**
提供的POC代码模拟了一个利用PHP对象注入漏洞的场景。它首先定义了一个`SafeOperation`类，该类包含一个魔术方法`__destruct`，该方法在对象被销毁时触发。通过控制`logMessage`属性，可以调用`logExampleMessage`方法。POC代码接收一个包含序列化对象的`config`参数，并使用`unserialize`函数反序列化该对象。如果可以控制反序列化的内容，则可以触发任意代码执行。

**投毒风险：**
提供的代码主要用于展示PHP反序列化漏洞，本身没有明显的恶意行为，但也不排除隐藏的风险。`The request`文件中的`unserialize`操作是高危点，如果攻击者能够控制反序列化的字符串内容，则可以利用该点执行任意代码。`Readme`文件中的缓解策略，也说明了unserialize的风险，但具体是否存在后门要取决于部署环境和是否有其他依赖组件被引入。 因此投毒风险评估为10%,风险主要来自于使用者对漏洞理解不透彻，直接将后门代码引入。

**利用方式：**
1.  攻击者构造一个包含恶意类的序列化字符串。
2.  将该序列化字符串作为`config`参数的值发送给目标服务器。
3.  目标服务器使用`unserialize`函数反序列化该字符串。
4.  如果反序列化成功，且恶意类中包含魔术方法（如`__destruct`），则该方法将被自动调用。
5.  攻击者可以在魔术方法中执行任意代码，从而实现远程代码执行。

**项目地址:** [CERTologists/HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892](https://github.com/CERTologists/HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #3

**来源**: [CVE-2023-41892-acesoyeo_CVE-2023-41892.md](../2023/CVE-2023-41892-acesoyeo_CVE-2023-41892.md)

# CVE-2023-41892

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-41892-0xfalafel_CraftCMS_CVE-2023-41892.md](../2023/CVE-2023-41892-0xfalafel_CraftCMS_CVE-2023-41892.md)

## CVE-2023-41892 - Craft CMS Remote Code Execution

**漏洞编号:** CVE-2023-41892

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Craft CMS

**危害等级:** Critical，未经身份验证的远程代码执行，可能导致完全控制服务器

**影响版本:** 4.0.0-RC1 to 4.4.14

**利用条件:** 目标 Craft CMS 版本在受影响范围内，且可通过 HTTP/HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-41892 允许未经身份验证的攻击者在 Craft CMS 服务器上执行任意代码。利用方式涉及：

1.  **信息收集 (phpinfo)：** 首先，利用`/index.php?action=conditions/render`端点和特制的`config`参数，执行`phpinfo()`来获取服务器的配置信息，特别是`upload_tmp_dir`（临时目录）和`$_SERVER['DOCUMENT_ROOT']`（文档根目录）。`FnStream`类被利用来执行`phpinfo()`函数。
2.  **Webshell 上传 (MSL + Imagick)：** 接着，攻击者创建一个包含 PHP 代码的 MSL（Magick Scripting Language）文件，该文件会将 PHP 代码写入 webshell (`shell.php`)。此 webshell 包含执行命令的代码。该文件通过POST请求上传到`/index.php?action=conditions/render` 端点。`Imagick`类被利用来读取和写入文件。
3.  **Webshell 移动 (Imagick)：** 使用`Imagick`类移动 webshell 到 web 根目录。这个操作同样通过发送 POST 请求到 `/index.php?action=conditions/render`端点完成。
4.  **远程代码执行：** 一旦 webshell 被成功部署，攻击者就可以通过发送带有 `cmd` 参数的 HTTP 请求到 `shell.php` 来执行任意命令。
5.  **交互式 Shell：** POC 代码包含一个简单的交互式 shell，允许攻击者输入命令并查看结果。

**投毒风险分析：**

该 POC 脚本的主要功能是利用漏洞在目标服务器上创建并使用 Webshell。虽然脚本本身不包含明显的恶意或隐藏代码，但存在以下潜在的投毒风险：

*   **依赖项风险：** 脚本依赖于 `requests` 库。如果攻击者提供了一个包含恶意依赖项的 requirements.txt 文件，或者诱导用户从非官方源安装 `requests`，则可能引入恶意代码。
*   **Webshell 利用风险：** 即使脚本本身没有投毒，攻击者也可能在成功部署 Webshell 后，通过 Webshell 上传和执行其他恶意脚本，例如后门、恶意软件等。
*   **配置信息泄露：**脚本尝试通过phpinfo函数获取配置信息，有概率会泄露服务器的敏感信息，可能被攻击者利用。
*  **代码可读性较差:** 代码风格和错误处理较为简单，缺少代码注释，可能隐藏恶意逻辑。

综上所述，该 POC 脚本的投毒风险较低，但不能完全排除。风险主要来自依赖项和 Webshell 的潜在滥用。


**项目地址:** [0xfalafel/CraftCMS_CVE-2023-41892](https://github.com/0xfalafel/CraftCMS_CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #2

**来源**: [CVE-2023-41892-CERTologists_HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892.md](../2023/CVE-2023-41892-CERTologists_HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892.md)

## CVE-2023-41892-Craft CMS-远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行

**影响应用:** Craft CMS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 4.4.14

**利用条件:** 需要网络访问，目标服务器运行Craft CMS且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-41892是Craft CMS中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响Craft CMS 4.4.14及更早版本。攻击者可以通过发送特制的请求，利用PHP反序列化漏洞执行任意代码。

**有效性：**
提供的POC代码模拟了一个利用PHP对象注入漏洞的场景。它首先定义了一个`SafeOperation`类，该类包含一个魔术方法`__destruct`，该方法在对象被销毁时触发。通过控制`logMessage`属性，可以调用`logExampleMessage`方法。POC代码接收一个包含序列化对象的`config`参数，并使用`unserialize`函数反序列化该对象。如果可以控制反序列化的内容，则可以触发任意代码执行。

**投毒风险：**
提供的代码主要用于展示PHP反序列化漏洞，本身没有明显的恶意行为，但也不排除隐藏的风险。`The request`文件中的`unserialize`操作是高危点，如果攻击者能够控制反序列化的字符串内容，则可以利用该点执行任意代码。`Readme`文件中的缓解策略，也说明了unserialize的风险，但具体是否存在后门要取决于部署环境和是否有其他依赖组件被引入。 因此投毒风险评估为10%,风险主要来自于使用者对漏洞理解不透彻，直接将后门代码引入。

**利用方式：**
1.  攻击者构造一个包含恶意类的序列化字符串。
2.  将该序列化字符串作为`config`参数的值发送给目标服务器。
3.  目标服务器使用`unserialize`函数反序列化该字符串。
4.  如果反序列化成功，且恶意类中包含魔术方法（如`__destruct`），则该方法将被自动调用。
5.  攻击者可以在魔术方法中执行任意代码，从而实现远程代码执行。

**项目地址:** [CERTologists/HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892](https://github.com/CERTologists/HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #3

**来源**: [CVE-2023-41892-acesoyeo_CVE-2023-41892.md](../2023/CVE-2023-41892-acesoyeo_CVE-2023-41892.md)

# CVE-2023-41892

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-41892-0xfalafel_CraftCMS_CVE-2023-41892.md](../2023/CVE-2023-41892-0xfalafel_CraftCMS_CVE-2023-41892.md)

## CVE-2023-41892 - Craft CMS Remote Code Execution

**漏洞编号:** CVE-2023-41892

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Craft CMS

**危害等级:** Critical，未经身份验证的远程代码执行，可能导致完全控制服务器

**影响版本:** 4.0.0-RC1 to 4.4.14

**利用条件:** 目标 Craft CMS 版本在受影响范围内，且可通过 HTTP/HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-41892 允许未经身份验证的攻击者在 Craft CMS 服务器上执行任意代码。利用方式涉及：

1.  **信息收集 (phpinfo)：** 首先，利用`/index.php?action=conditions/render`端点和特制的`config`参数，执行`phpinfo()`来获取服务器的配置信息，特别是`upload_tmp_dir`（临时目录）和`$_SERVER['DOCUMENT_ROOT']`（文档根目录）。`FnStream`类被利用来执行`phpinfo()`函数。
2.  **Webshell 上传 (MSL + Imagick)：** 接着，攻击者创建一个包含 PHP 代码的 MSL（Magick Scripting Language）文件，该文件会将 PHP 代码写入 webshell (`shell.php`)。此 webshell 包含执行命令的代码。该文件通过POST请求上传到`/index.php?action=conditions/render` 端点。`Imagick`类被利用来读取和写入文件。
3.  **Webshell 移动 (Imagick)：** 使用`Imagick`类移动 webshell 到 web 根目录。这个操作同样通过发送 POST 请求到 `/index.php?action=conditions/render`端点完成。
4.  **远程代码执行：** 一旦 webshell 被成功部署，攻击者就可以通过发送带有 `cmd` 参数的 HTTP 请求到 `shell.php` 来执行任意命令。
5.  **交互式 Shell：** POC 代码包含一个简单的交互式 shell，允许攻击者输入命令并查看结果。

**投毒风险分析：**

该 POC 脚本的主要功能是利用漏洞在目标服务器上创建并使用 Webshell。虽然脚本本身不包含明显的恶意或隐藏代码，但存在以下潜在的投毒风险：

*   **依赖项风险：** 脚本依赖于 `requests` 库。如果攻击者提供了一个包含恶意依赖项的 requirements.txt 文件，或者诱导用户从非官方源安装 `requests`，则可能引入恶意代码。
*   **Webshell 利用风险：** 即使脚本本身没有投毒，攻击者也可能在成功部署 Webshell 后，通过 Webshell 上传和执行其他恶意脚本，例如后门、恶意软件等。
*   **配置信息泄露：**脚本尝试通过phpinfo函数获取配置信息，有概率会泄露服务器的敏感信息，可能被攻击者利用。
*  **代码可读性较差:** 代码风格和错误处理较为简单，缺少代码注释，可能隐藏恶意逻辑。

综上所述，该 POC 脚本的投毒风险较低，但不能完全排除。风险主要来自依赖项和 Webshell 的潜在滥用。


**项目地址:** [0xfalafel/CraftCMS_CVE-2023-41892](https://github.com/0xfalafel/CraftCMS_CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #2

**来源**: [CVE-2023-41892-CERTologists_HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892.md](../2023/CVE-2023-41892-CERTologists_HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892.md)

## CVE-2023-41892-Craft CMS-远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行

**影响应用:** Craft CMS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 4.4.14

**利用条件:** 需要网络访问，目标服务器运行Craft CMS且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-41892是Craft CMS中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响Craft CMS 4.4.14及更早版本。攻击者可以通过发送特制的请求，利用PHP反序列化漏洞执行任意代码。

**有效性：**
提供的POC代码模拟了一个利用PHP对象注入漏洞的场景。它首先定义了一个`SafeOperation`类，该类包含一个魔术方法`__destruct`，该方法在对象被销毁时触发。通过控制`logMessage`属性，可以调用`logExampleMessage`方法。POC代码接收一个包含序列化对象的`config`参数，并使用`unserialize`函数反序列化该对象。如果可以控制反序列化的内容，则可以触发任意代码执行。

**投毒风险：**
提供的代码主要用于展示PHP反序列化漏洞，本身没有明显的恶意行为，但也不排除隐藏的风险。`The request`文件中的`unserialize`操作是高危点，如果攻击者能够控制反序列化的字符串内容，则可以利用该点执行任意代码。`Readme`文件中的缓解策略，也说明了unserialize的风险，但具体是否存在后门要取决于部署环境和是否有其他依赖组件被引入。 因此投毒风险评估为10%,风险主要来自于使用者对漏洞理解不透彻，直接将后门代码引入。

**利用方式：**
1.  攻击者构造一个包含恶意类的序列化字符串。
2.  将该序列化字符串作为`config`参数的值发送给目标服务器。
3.  目标服务器使用`unserialize`函数反序列化该字符串。
4.  如果反序列化成功，且恶意类中包含魔术方法（如`__destruct`），则该方法将被自动调用。
5.  攻击者可以在魔术方法中执行任意代码，从而实现远程代码执行。

**项目地址:** [CERTologists/HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892](https://github.com/CERTologists/HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #3

**来源**: [CVE-2023-41892-acesoyeo_CVE-2023-41892.md](../2023/CVE-2023-41892-acesoyeo_CVE-2023-41892.md)

# CVE-2023-41892

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-41892-0xfalafel_CraftCMS_CVE-2023-41892.md](../2023/CVE-2023-41892-0xfalafel_CraftCMS_CVE-2023-41892.md)

## CVE-2023-41892 - Craft CMS Remote Code Execution

**漏洞编号:** CVE-2023-41892

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Craft CMS

**危害等级:** Critical，未经身份验证的远程代码执行，可能导致完全控制服务器

**影响版本:** 4.0.0-RC1 to 4.4.14

**利用条件:** 目标 Craft CMS 版本在受影响范围内，且可通过 HTTP/HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-41892 允许未经身份验证的攻击者在 Craft CMS 服务器上执行任意代码。利用方式涉及：

1.  **信息收集 (phpinfo)：** 首先，利用`/index.php?action=conditions/render`端点和特制的`config`参数，执行`phpinfo()`来获取服务器的配置信息，特别是`upload_tmp_dir`（临时目录）和`$_SERVER['DOCUMENT_ROOT']`（文档根目录）。`FnStream`类被利用来执行`phpinfo()`函数。
2.  **Webshell 上传 (MSL + Imagick)：** 接着，攻击者创建一个包含 PHP 代码的 MSL（Magick Scripting Language）文件，该文件会将 PHP 代码写入 webshell (`shell.php`)。此 webshell 包含执行命令的代码。该文件通过POST请求上传到`/index.php?action=conditions/render` 端点。`Imagick`类被利用来读取和写入文件。
3.  **Webshell 移动 (Imagick)：** 使用`Imagick`类移动 webshell 到 web 根目录。这个操作同样通过发送 POST 请求到 `/index.php?action=conditions/render`端点完成。
4.  **远程代码执行：** 一旦 webshell 被成功部署，攻击者就可以通过发送带有 `cmd` 参数的 HTTP 请求到 `shell.php` 来执行任意命令。
5.  **交互式 Shell：** POC 代码包含一个简单的交互式 shell，允许攻击者输入命令并查看结果。

**投毒风险分析：**

该 POC 脚本的主要功能是利用漏洞在目标服务器上创建并使用 Webshell。虽然脚本本身不包含明显的恶意或隐藏代码，但存在以下潜在的投毒风险：

*   **依赖项风险：** 脚本依赖于 `requests` 库。如果攻击者提供了一个包含恶意依赖项的 requirements.txt 文件，或者诱导用户从非官方源安装 `requests`，则可能引入恶意代码。
*   **Webshell 利用风险：** 即使脚本本身没有投毒，攻击者也可能在成功部署 Webshell 后，通过 Webshell 上传和执行其他恶意脚本，例如后门、恶意软件等。
*   **配置信息泄露：**脚本尝试通过phpinfo函数获取配置信息，有概率会泄露服务器的敏感信息，可能被攻击者利用。
*  **代码可读性较差:** 代码风格和错误处理较为简单，缺少代码注释，可能隐藏恶意逻辑。

综上所述，该 POC 脚本的投毒风险较低，但不能完全排除。风险主要来自依赖项和 Webshell 的潜在滥用。


**项目地址:** [0xfalafel/CraftCMS_CVE-2023-41892](https://github.com/0xfalafel/CraftCMS_CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #2

**来源**: [CVE-2023-41892-CERTologists_HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892.md](../2023/CVE-2023-41892-CERTologists_HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892.md)

## CVE-2023-41892-Craft CMS-远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行

**影响应用:** Craft CMS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 4.4.14

**利用条件:** 需要网络访问，目标服务器运行Craft CMS且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-41892是Craft CMS中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响Craft CMS 4.4.14及更早版本。攻击者可以通过发送特制的请求，利用PHP反序列化漏洞执行任意代码。

**有效性：**
提供的POC代码模拟了一个利用PHP对象注入漏洞的场景。它首先定义了一个`SafeOperation`类，该类包含一个魔术方法`__destruct`，该方法在对象被销毁时触发。通过控制`logMessage`属性，可以调用`logExampleMessage`方法。POC代码接收一个包含序列化对象的`config`参数，并使用`unserialize`函数反序列化该对象。如果可以控制反序列化的内容，则可以触发任意代码执行。

**投毒风险：**
提供的代码主要用于展示PHP反序列化漏洞，本身没有明显的恶意行为，但也不排除隐藏的风险。`The request`文件中的`unserialize`操作是高危点，如果攻击者能够控制反序列化的字符串内容，则可以利用该点执行任意代码。`Readme`文件中的缓解策略，也说明了unserialize的风险，但具体是否存在后门要取决于部署环境和是否有其他依赖组件被引入。 因此投毒风险评估为10%,风险主要来自于使用者对漏洞理解不透彻，直接将后门代码引入。

**利用方式：**
1.  攻击者构造一个包含恶意类的序列化字符串。
2.  将该序列化字符串作为`config`参数的值发送给目标服务器。
3.  目标服务器使用`unserialize`函数反序列化该字符串。
4.  如果反序列化成功，且恶意类中包含魔术方法（如`__destruct`），则该方法将被自动调用。
5.  攻击者可以在魔术方法中执行任意代码，从而实现远程代码执行。

**项目地址:** [CERTologists/HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892](https://github.com/CERTologists/HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #3

**来源**: [CVE-2023-41892-acesoyeo_CVE-2023-41892.md](../2023/CVE-2023-41892-acesoyeo_CVE-2023-41892.md)

# CVE-2023-41892

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-41892-0xfalafel_CraftCMS_CVE-2023-41892.md](../2023/CVE-2023-41892-0xfalafel_CraftCMS_CVE-2023-41892.md)

## CVE-2023-41892 - Craft CMS Remote Code Execution

**漏洞编号:** CVE-2023-41892

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Craft CMS

**危害等级:** Critical，未经身份验证的远程代码执行，可能导致完全控制服务器

**影响版本:** 4.0.0-RC1 to 4.4.14

**利用条件:** 目标 Craft CMS 版本在受影响范围内，且可通过 HTTP/HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-41892 允许未经身份验证的攻击者在 Craft CMS 服务器上执行任意代码。利用方式涉及：

1.  **信息收集 (phpinfo)：** 首先，利用`/index.php?action=conditions/render`端点和特制的`config`参数，执行`phpinfo()`来获取服务器的配置信息，特别是`upload_tmp_dir`（临时目录）和`$_SERVER['DOCUMENT_ROOT']`（文档根目录）。`FnStream`类被利用来执行`phpinfo()`函数。
2.  **Webshell 上传 (MSL + Imagick)：** 接着，攻击者创建一个包含 PHP 代码的 MSL（Magick Scripting Language）文件，该文件会将 PHP 代码写入 webshell (`shell.php`)。此 webshell 包含执行命令的代码。该文件通过POST请求上传到`/index.php?action=conditions/render` 端点。`Imagick`类被利用来读取和写入文件。
3.  **Webshell 移动 (Imagick)：** 使用`Imagick`类移动 webshell 到 web 根目录。这个操作同样通过发送 POST 请求到 `/index.php?action=conditions/render`端点完成。
4.  **远程代码执行：** 一旦 webshell 被成功部署，攻击者就可以通过发送带有 `cmd` 参数的 HTTP 请求到 `shell.php` 来执行任意命令。
5.  **交互式 Shell：** POC 代码包含一个简单的交互式 shell，允许攻击者输入命令并查看结果。

**投毒风险分析：**

该 POC 脚本的主要功能是利用漏洞在目标服务器上创建并使用 Webshell。虽然脚本本身不包含明显的恶意或隐藏代码，但存在以下潜在的投毒风险：

*   **依赖项风险：** 脚本依赖于 `requests` 库。如果攻击者提供了一个包含恶意依赖项的 requirements.txt 文件，或者诱导用户从非官方源安装 `requests`，则可能引入恶意代码。
*   **Webshell 利用风险：** 即使脚本本身没有投毒，攻击者也可能在成功部署 Webshell 后，通过 Webshell 上传和执行其他恶意脚本，例如后门、恶意软件等。
*   **配置信息泄露：**脚本尝试通过phpinfo函数获取配置信息，有概率会泄露服务器的敏感信息，可能被攻击者利用。
*  **代码可读性较差:** 代码风格和错误处理较为简单，缺少代码注释，可能隐藏恶意逻辑。

综上所述，该 POC 脚本的投毒风险较低，但不能完全排除。风险主要来自依赖项和 Webshell 的潜在滥用。


**项目地址:** [0xfalafel/CraftCMS_CVE-2023-41892](https://github.com/0xfalafel/CraftCMS_CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #2

**来源**: [CVE-2023-41892-CERTologists_HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892.md](../2023/CVE-2023-41892-CERTologists_HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892.md)

## CVE-2023-41892-Craft CMS-远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行

**影响应用:** Craft CMS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 4.4.14

**利用条件:** 需要网络访问，目标服务器运行Craft CMS且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-41892是Craft CMS中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响Craft CMS 4.4.14及更早版本。攻击者可以通过发送特制的请求，利用PHP反序列化漏洞执行任意代码。

**有效性：**
提供的POC代码模拟了一个利用PHP对象注入漏洞的场景。它首先定义了一个`SafeOperation`类，该类包含一个魔术方法`__destruct`，该方法在对象被销毁时触发。通过控制`logMessage`属性，可以调用`logExampleMessage`方法。POC代码接收一个包含序列化对象的`config`参数，并使用`unserialize`函数反序列化该对象。如果可以控制反序列化的内容，则可以触发任意代码执行。

**投毒风险：**
提供的代码主要用于展示PHP反序列化漏洞，本身没有明显的恶意行为，但也不排除隐藏的风险。`The request`文件中的`unserialize`操作是高危点，如果攻击者能够控制反序列化的字符串内容，则可以利用该点执行任意代码。`Readme`文件中的缓解策略，也说明了unserialize的风险，但具体是否存在后门要取决于部署环境和是否有其他依赖组件被引入。 因此投毒风险评估为10%,风险主要来自于使用者对漏洞理解不透彻，直接将后门代码引入。

**利用方式：**
1.  攻击者构造一个包含恶意类的序列化字符串。
2.  将该序列化字符串作为`config`参数的值发送给目标服务器。
3.  目标服务器使用`unserialize`函数反序列化该字符串。
4.  如果反序列化成功，且恶意类中包含魔术方法（如`__destruct`），则该方法将被自动调用。
5.  攻击者可以在魔术方法中执行任意代码，从而实现远程代码执行。

**项目地址:** [CERTologists/HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892](https://github.com/CERTologists/HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #3

**来源**: [CVE-2023-41892-acesoyeo_CVE-2023-41892.md](../2023/CVE-2023-41892-acesoyeo_CVE-2023-41892.md)

# CVE-2023-41892

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-41892-0xfalafel_CraftCMS_CVE-2023-41892.md](../2023/CVE-2023-41892-0xfalafel_CraftCMS_CVE-2023-41892.md)

## CVE-2023-41892 - Craft CMS Remote Code Execution

**漏洞编号:** CVE-2023-41892

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Craft CMS

**危害等级:** Critical，未经身份验证的远程代码执行，可能导致完全控制服务器

**影响版本:** 4.0.0-RC1 to 4.4.14

**利用条件:** 目标 Craft CMS 版本在受影响范围内，且可通过 HTTP/HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-41892 允许未经身份验证的攻击者在 Craft CMS 服务器上执行任意代码。利用方式涉及：

1.  **信息收集 (phpinfo)：** 首先，利用`/index.php?action=conditions/render`端点和特制的`config`参数，执行`phpinfo()`来获取服务器的配置信息，特别是`upload_tmp_dir`（临时目录）和`$_SERVER['DOCUMENT_ROOT']`（文档根目录）。`FnStream`类被利用来执行`phpinfo()`函数。
2.  **Webshell 上传 (MSL + Imagick)：** 接着，攻击者创建一个包含 PHP 代码的 MSL（Magick Scripting Language）文件，该文件会将 PHP 代码写入 webshell (`shell.php`)。此 webshell 包含执行命令的代码。该文件通过POST请求上传到`/index.php?action=conditions/render` 端点。`Imagick`类被利用来读取和写入文件。
3.  **Webshell 移动 (Imagick)：** 使用`Imagick`类移动 webshell 到 web 根目录。这个操作同样通过发送 POST 请求到 `/index.php?action=conditions/render`端点完成。
4.  **远程代码执行：** 一旦 webshell 被成功部署，攻击者就可以通过发送带有 `cmd` 参数的 HTTP 请求到 `shell.php` 来执行任意命令。
5.  **交互式 Shell：** POC 代码包含一个简单的交互式 shell，允许攻击者输入命令并查看结果。

**投毒风险分析：**

该 POC 脚本的主要功能是利用漏洞在目标服务器上创建并使用 Webshell。虽然脚本本身不包含明显的恶意或隐藏代码，但存在以下潜在的投毒风险：

*   **依赖项风险：** 脚本依赖于 `requests` 库。如果攻击者提供了一个包含恶意依赖项的 requirements.txt 文件，或者诱导用户从非官方源安装 `requests`，则可能引入恶意代码。
*   **Webshell 利用风险：** 即使脚本本身没有投毒，攻击者也可能在成功部署 Webshell 后，通过 Webshell 上传和执行其他恶意脚本，例如后门、恶意软件等。
*   **配置信息泄露：**脚本尝试通过phpinfo函数获取配置信息，有概率会泄露服务器的敏感信息，可能被攻击者利用。
*  **代码可读性较差:** 代码风格和错误处理较为简单，缺少代码注释，可能隐藏恶意逻辑。

综上所述，该 POC 脚本的投毒风险较低，但不能完全排除。风险主要来自依赖项和 Webshell 的潜在滥用。


**项目地址:** [0xfalafel/CraftCMS_CVE-2023-41892](https://github.com/0xfalafel/CraftCMS_CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #2

**来源**: [CVE-2023-41892-CERTologists_HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892.md](../2023/CVE-2023-41892-CERTologists_HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892.md)

## CVE-2023-41892-Craft CMS-远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行

**影响应用:** Craft CMS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 4.4.14

**利用条件:** 需要网络访问，目标服务器运行Craft CMS且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-41892是Craft CMS中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响Craft CMS 4.4.14及更早版本。攻击者可以通过发送特制的请求，利用PHP反序列化漏洞执行任意代码。

**有效性：**
提供的POC代码模拟了一个利用PHP对象注入漏洞的场景。它首先定义了一个`SafeOperation`类，该类包含一个魔术方法`__destruct`，该方法在对象被销毁时触发。通过控制`logMessage`属性，可以调用`logExampleMessage`方法。POC代码接收一个包含序列化对象的`config`参数，并使用`unserialize`函数反序列化该对象。如果可以控制反序列化的内容，则可以触发任意代码执行。

**投毒风险：**
提供的代码主要用于展示PHP反序列化漏洞，本身没有明显的恶意行为，但也不排除隐藏的风险。`The request`文件中的`unserialize`操作是高危点，如果攻击者能够控制反序列化的字符串内容，则可以利用该点执行任意代码。`Readme`文件中的缓解策略，也说明了unserialize的风险，但具体是否存在后门要取决于部署环境和是否有其他依赖组件被引入。 因此投毒风险评估为10%,风险主要来自于使用者对漏洞理解不透彻，直接将后门代码引入。

**利用方式：**
1.  攻击者构造一个包含恶意类的序列化字符串。
2.  将该序列化字符串作为`config`参数的值发送给目标服务器。
3.  目标服务器使用`unserialize`函数反序列化该字符串。
4.  如果反序列化成功，且恶意类中包含魔术方法（如`__destruct`），则该方法将被自动调用。
5.  攻击者可以在魔术方法中执行任意代码，从而实现远程代码执行。

**项目地址:** [CERTologists/HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892](https://github.com/CERTologists/HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #3

**来源**: [CVE-2023-41892-acesoyeo_CVE-2023-41892.md](../2023/CVE-2023-41892-acesoyeo_CVE-2023-41892.md)

# CVE-2023-41892

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-41892-0xfalafel_CraftCMS_CVE-2023-41892.md](../2023/CVE-2023-41892-0xfalafel_CraftCMS_CVE-2023-41892.md)

## CVE-2023-41892 - Craft CMS Remote Code Execution

**漏洞编号:** CVE-2023-41892

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Craft CMS

**危害等级:** Critical，未经身份验证的远程代码执行，可能导致完全控制服务器

**影响版本:** 4.0.0-RC1 to 4.4.14

**利用条件:** 目标 Craft CMS 版本在受影响范围内，且可通过 HTTP/HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-41892 允许未经身份验证的攻击者在 Craft CMS 服务器上执行任意代码。利用方式涉及：

1.  **信息收集 (phpinfo)：** 首先，利用`/index.php?action=conditions/render`端点和特制的`config`参数，执行`phpinfo()`来获取服务器的配置信息，特别是`upload_tmp_dir`（临时目录）和`$_SERVER['DOCUMENT_ROOT']`（文档根目录）。`FnStream`类被利用来执行`phpinfo()`函数。
2.  **Webshell 上传 (MSL + Imagick)：** 接着，攻击者创建一个包含 PHP 代码的 MSL（Magick Scripting Language）文件，该文件会将 PHP 代码写入 webshell (`shell.php`)。此 webshell 包含执行命令的代码。该文件通过POST请求上传到`/index.php?action=conditions/render` 端点。`Imagick`类被利用来读取和写入文件。
3.  **Webshell 移动 (Imagick)：** 使用`Imagick`类移动 webshell 到 web 根目录。这个操作同样通过发送 POST 请求到 `/index.php?action=conditions/render`端点完成。
4.  **远程代码执行：** 一旦 webshell 被成功部署，攻击者就可以通过发送带有 `cmd` 参数的 HTTP 请求到 `shell.php` 来执行任意命令。
5.  **交互式 Shell：** POC 代码包含一个简单的交互式 shell，允许攻击者输入命令并查看结果。

**投毒风险分析：**

该 POC 脚本的主要功能是利用漏洞在目标服务器上创建并使用 Webshell。虽然脚本本身不包含明显的恶意或隐藏代码，但存在以下潜在的投毒风险：

*   **依赖项风险：** 脚本依赖于 `requests` 库。如果攻击者提供了一个包含恶意依赖项的 requirements.txt 文件，或者诱导用户从非官方源安装 `requests`，则可能引入恶意代码。
*   **Webshell 利用风险：** 即使脚本本身没有投毒，攻击者也可能在成功部署 Webshell 后，通过 Webshell 上传和执行其他恶意脚本，例如后门、恶意软件等。
*   **配置信息泄露：**脚本尝试通过phpinfo函数获取配置信息，有概率会泄露服务器的敏感信息，可能被攻击者利用。
*  **代码可读性较差:** 代码风格和错误处理较为简单，缺少代码注释，可能隐藏恶意逻辑。

综上所述，该 POC 脚本的投毒风险较低，但不能完全排除。风险主要来自依赖项和 Webshell 的潜在滥用。


**项目地址:** [0xfalafel/CraftCMS_CVE-2023-41892](https://github.com/0xfalafel/CraftCMS_CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #2

**来源**: [CVE-2023-41892-CERTologists_HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892.md](../2023/CVE-2023-41892-CERTologists_HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892.md)

## CVE-2023-41892-Craft CMS-远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行

**影响应用:** Craft CMS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 4.4.14

**利用条件:** 需要网络访问，目标服务器运行Craft CMS且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-41892是Craft CMS中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响Craft CMS 4.4.14及更早版本。攻击者可以通过发送特制的请求，利用PHP反序列化漏洞执行任意代码。

**有效性：**
提供的POC代码模拟了一个利用PHP对象注入漏洞的场景。它首先定义了一个`SafeOperation`类，该类包含一个魔术方法`__destruct`，该方法在对象被销毁时触发。通过控制`logMessage`属性，可以调用`logExampleMessage`方法。POC代码接收一个包含序列化对象的`config`参数，并使用`unserialize`函数反序列化该对象。如果可以控制反序列化的内容，则可以触发任意代码执行。

**投毒风险：**
提供的代码主要用于展示PHP反序列化漏洞，本身没有明显的恶意行为，但也不排除隐藏的风险。`The request`文件中的`unserialize`操作是高危点，如果攻击者能够控制反序列化的字符串内容，则可以利用该点执行任意代码。`Readme`文件中的缓解策略，也说明了unserialize的风险，但具体是否存在后门要取决于部署环境和是否有其他依赖组件被引入。 因此投毒风险评估为10%,风险主要来自于使用者对漏洞理解不透彻，直接将后门代码引入。

**利用方式：**
1.  攻击者构造一个包含恶意类的序列化字符串。
2.  将该序列化字符串作为`config`参数的值发送给目标服务器。
3.  目标服务器使用`unserialize`函数反序列化该字符串。
4.  如果反序列化成功，且恶意类中包含魔术方法（如`__destruct`），则该方法将被自动调用。
5.  攻击者可以在魔术方法中执行任意代码，从而实现远程代码执行。

**项目地址:** [CERTologists/HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892](https://github.com/CERTologists/HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #3

**来源**: [CVE-2023-41892-acesoyeo_CVE-2023-41892.md](../2023/CVE-2023-41892-acesoyeo_CVE-2023-41892.md)

# CVE-2023-41892

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-41892-0xfalafel_CraftCMS_CVE-2023-41892.md](../2023/CVE-2023-41892-0xfalafel_CraftCMS_CVE-2023-41892.md)

## CVE-2023-41892 - Craft CMS Remote Code Execution

**漏洞编号:** CVE-2023-41892

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Craft CMS

**危害等级:** Critical，未经身份验证的远程代码执行，可能导致完全控制服务器

**影响版本:** 4.0.0-RC1 to 4.4.14

**利用条件:** 目标 Craft CMS 版本在受影响范围内，且可通过 HTTP/HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-41892 允许未经身份验证的攻击者在 Craft CMS 服务器上执行任意代码。利用方式涉及：

1.  **信息收集 (phpinfo)：** 首先，利用`/index.php?action=conditions/render`端点和特制的`config`参数，执行`phpinfo()`来获取服务器的配置信息，特别是`upload_tmp_dir`（临时目录）和`$_SERVER['DOCUMENT_ROOT']`（文档根目录）。`FnStream`类被利用来执行`phpinfo()`函数。
2.  **Webshell 上传 (MSL + Imagick)：** 接着，攻击者创建一个包含 PHP 代码的 MSL（Magick Scripting Language）文件，该文件会将 PHP 代码写入 webshell (`shell.php`)。此 webshell 包含执行命令的代码。该文件通过POST请求上传到`/index.php?action=conditions/render` 端点。`Imagick`类被利用来读取和写入文件。
3.  **Webshell 移动 (Imagick)：** 使用`Imagick`类移动 webshell 到 web 根目录。这个操作同样通过发送 POST 请求到 `/index.php?action=conditions/render`端点完成。
4.  **远程代码执行：** 一旦 webshell 被成功部署，攻击者就可以通过发送带有 `cmd` 参数的 HTTP 请求到 `shell.php` 来执行任意命令。
5.  **交互式 Shell：** POC 代码包含一个简单的交互式 shell，允许攻击者输入命令并查看结果。

**投毒风险分析：**

该 POC 脚本的主要功能是利用漏洞在目标服务器上创建并使用 Webshell。虽然脚本本身不包含明显的恶意或隐藏代码，但存在以下潜在的投毒风险：

*   **依赖项风险：** 脚本依赖于 `requests` 库。如果攻击者提供了一个包含恶意依赖项的 requirements.txt 文件，或者诱导用户从非官方源安装 `requests`，则可能引入恶意代码。
*   **Webshell 利用风险：** 即使脚本本身没有投毒，攻击者也可能在成功部署 Webshell 后，通过 Webshell 上传和执行其他恶意脚本，例如后门、恶意软件等。
*   **配置信息泄露：**脚本尝试通过phpinfo函数获取配置信息，有概率会泄露服务器的敏感信息，可能被攻击者利用。
*  **代码可读性较差:** 代码风格和错误处理较为简单，缺少代码注释，可能隐藏恶意逻辑。

综上所述，该 POC 脚本的投毒风险较低，但不能完全排除。风险主要来自依赖项和 Webshell 的潜在滥用。


**项目地址:** [0xfalafel/CraftCMS_CVE-2023-41892](https://github.com/0xfalafel/CraftCMS_CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #2

**来源**: [CVE-2023-41892-CERTologists_HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892.md](../2023/CVE-2023-41892-CERTologists_HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892.md)

## CVE-2023-41892-Craft CMS-远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行

**影响应用:** Craft CMS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 4.4.14

**利用条件:** 需要网络访问，目标服务器运行Craft CMS且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-41892是Craft CMS中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响Craft CMS 4.4.14及更早版本。攻击者可以通过发送特制的请求，利用PHP反序列化漏洞执行任意代码。

**有效性：**
提供的POC代码模拟了一个利用PHP对象注入漏洞的场景。它首先定义了一个`SafeOperation`类，该类包含一个魔术方法`__destruct`，该方法在对象被销毁时触发。通过控制`logMessage`属性，可以调用`logExampleMessage`方法。POC代码接收一个包含序列化对象的`config`参数，并使用`unserialize`函数反序列化该对象。如果可以控制反序列化的内容，则可以触发任意代码执行。

**投毒风险：**
提供的代码主要用于展示PHP反序列化漏洞，本身没有明显的恶意行为，但也不排除隐藏的风险。`The request`文件中的`unserialize`操作是高危点，如果攻击者能够控制反序列化的字符串内容，则可以利用该点执行任意代码。`Readme`文件中的缓解策略，也说明了unserialize的风险，但具体是否存在后门要取决于部署环境和是否有其他依赖组件被引入。 因此投毒风险评估为10%,风险主要来自于使用者对漏洞理解不透彻，直接将后门代码引入。

**利用方式：**
1.  攻击者构造一个包含恶意类的序列化字符串。
2.  将该序列化字符串作为`config`参数的值发送给目标服务器。
3.  目标服务器使用`unserialize`函数反序列化该字符串。
4.  如果反序列化成功，且恶意类中包含魔术方法（如`__destruct`），则该方法将被自动调用。
5.  攻击者可以在魔术方法中执行任意代码，从而实现远程代码执行。

**项目地址:** [CERTologists/HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892](https://github.com/CERTologists/HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #3

**来源**: [CVE-2023-41892-acesoyeo_CVE-2023-41892.md](../2023/CVE-2023-41892-acesoyeo_CVE-2023-41892.md)

# CVE-2023-41892

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-41892-0xfalafel_CraftCMS_CVE-2023-41892.md](../2023/CVE-2023-41892-0xfalafel_CraftCMS_CVE-2023-41892.md)

## CVE-2023-41892 - Craft CMS Remote Code Execution

**漏洞编号:** CVE-2023-41892

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Craft CMS

**危害等级:** Critical，未经身份验证的远程代码执行，可能导致完全控制服务器

**影响版本:** 4.0.0-RC1 to 4.4.14

**利用条件:** 目标 Craft CMS 版本在受影响范围内，且可通过 HTTP/HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-41892 允许未经身份验证的攻击者在 Craft CMS 服务器上执行任意代码。利用方式涉及：

1.  **信息收集 (phpinfo)：** 首先，利用`/index.php?action=conditions/render`端点和特制的`config`参数，执行`phpinfo()`来获取服务器的配置信息，特别是`upload_tmp_dir`（临时目录）和`$_SERVER['DOCUMENT_ROOT']`（文档根目录）。`FnStream`类被利用来执行`phpinfo()`函数。
2.  **Webshell 上传 (MSL + Imagick)：** 接着，攻击者创建一个包含 PHP 代码的 MSL（Magick Scripting Language）文件，该文件会将 PHP 代码写入 webshell (`shell.php`)。此 webshell 包含执行命令的代码。该文件通过POST请求上传到`/index.php?action=conditions/render` 端点。`Imagick`类被利用来读取和写入文件。
3.  **Webshell 移动 (Imagick)：** 使用`Imagick`类移动 webshell 到 web 根目录。这个操作同样通过发送 POST 请求到 `/index.php?action=conditions/render`端点完成。
4.  **远程代码执行：** 一旦 webshell 被成功部署，攻击者就可以通过发送带有 `cmd` 参数的 HTTP 请求到 `shell.php` 来执行任意命令。
5.  **交互式 Shell：** POC 代码包含一个简单的交互式 shell，允许攻击者输入命令并查看结果。

**投毒风险分析：**

该 POC 脚本的主要功能是利用漏洞在目标服务器上创建并使用 Webshell。虽然脚本本身不包含明显的恶意或隐藏代码，但存在以下潜在的投毒风险：

*   **依赖项风险：** 脚本依赖于 `requests` 库。如果攻击者提供了一个包含恶意依赖项的 requirements.txt 文件，或者诱导用户从非官方源安装 `requests`，则可能引入恶意代码。
*   **Webshell 利用风险：** 即使脚本本身没有投毒，攻击者也可能在成功部署 Webshell 后，通过 Webshell 上传和执行其他恶意脚本，例如后门、恶意软件等。
*   **配置信息泄露：**脚本尝试通过phpinfo函数获取配置信息，有概率会泄露服务器的敏感信息，可能被攻击者利用。
*  **代码可读性较差:** 代码风格和错误处理较为简单，缺少代码注释，可能隐藏恶意逻辑。

综上所述，该 POC 脚本的投毒风险较低，但不能完全排除。风险主要来自依赖项和 Webshell 的潜在滥用。


**项目地址:** [0xfalafel/CraftCMS_CVE-2023-41892](https://github.com/0xfalafel/CraftCMS_CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #2

**来源**: [CVE-2023-41892-CERTologists_HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892.md](../2023/CVE-2023-41892-CERTologists_HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892.md)

## CVE-2023-41892-Craft CMS-远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行

**影响应用:** Craft CMS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 4.4.14

**利用条件:** 需要网络访问，目标服务器运行Craft CMS且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-41892是Craft CMS中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响Craft CMS 4.4.14及更早版本。攻击者可以通过发送特制的请求，利用PHP反序列化漏洞执行任意代码。

**有效性：**
提供的POC代码模拟了一个利用PHP对象注入漏洞的场景。它首先定义了一个`SafeOperation`类，该类包含一个魔术方法`__destruct`，该方法在对象被销毁时触发。通过控制`logMessage`属性，可以调用`logExampleMessage`方法。POC代码接收一个包含序列化对象的`config`参数，并使用`unserialize`函数反序列化该对象。如果可以控制反序列化的内容，则可以触发任意代码执行。

**投毒风险：**
提供的代码主要用于展示PHP反序列化漏洞，本身没有明显的恶意行为，但也不排除隐藏的风险。`The request`文件中的`unserialize`操作是高危点，如果攻击者能够控制反序列化的字符串内容，则可以利用该点执行任意代码。`Readme`文件中的缓解策略，也说明了unserialize的风险，但具体是否存在后门要取决于部署环境和是否有其他依赖组件被引入。 因此投毒风险评估为10%,风险主要来自于使用者对漏洞理解不透彻，直接将后门代码引入。

**利用方式：**
1.  攻击者构造一个包含恶意类的序列化字符串。
2.  将该序列化字符串作为`config`参数的值发送给目标服务器。
3.  目标服务器使用`unserialize`函数反序列化该字符串。
4.  如果反序列化成功，且恶意类中包含魔术方法（如`__destruct`），则该方法将被自动调用。
5.  攻击者可以在魔术方法中执行任意代码，从而实现远程代码执行。

**项目地址:** [CERTologists/HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892](https://github.com/CERTologists/HTTP-Request-for-PHP-object-injection-attack-on-CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #3

**来源**: [CVE-2023-41892-diegaccio_Craft-CMS-Exploit.md](../2023/CVE-2023-41892-diegaccio_Craft-CMS-Exploit.md)

## CVE-2023-41892-Craft CMS-远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行

**影响应用:** Craft CMS

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** >= 4.0.0-RC1, <= 4.4.14

**利用条件:** 目标Craft CMS版本在受影响范围内，且未打补丁，需要网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个远程代码执行漏洞。根据漏洞库信息和搜索引擎结果，该漏洞影响 Craft CMS 4.0.0-RC1 到 4.4.14 版本。攻击者可以通过发送特制的请求来利用此漏洞，在目标服务器上执行任意代码。\n\n**利用方式：**\n\n1.  **信息收集：** 首先，攻击者需要确定目标 Craft CMS 的版本是否在受影响范围内。\n2.  **上传临时文件：** 该漏洞利用链首先利用了 Imagick 组件处理图像时的MSL文件，在临时目录写入包含恶意PHP代码的文件。exploit.py脚本首先通过访问一个特殊的URL（触发phpinfo()）来获取`upload_tmp_dir`和`DOCUMENT_ROOT`。如果`upload_tmp_dir`不存在，则使用`/tmp`目录。\n3.  **写入webshell:** 之后，利用MSL文件将webshell写入`DOCUMENT_ROOT`目录下。\n4.  **代码执行：**  攻击者通过访问webshell文件,并携带`cmd`参数来执行任意的系统命令。该POC脚本使用base64编码命令，以绕过潜在的过滤。\n5.  **反弹shell：** POC代码中包含了反弹 shell 的功能，允许攻击者在成功利用漏洞后获得对目标系统的控制权。\n\n**投毒风险分析：**\n\n虽然提供的POC代码主要功能是利用漏洞实现远程代码执行，但是仍然存在一定的投毒风险。例如，攻击者可能会修改POC代码，在反弹 shell 之外执行其他恶意操作，例如安装后门、窃取敏感信息等。此外，POC代码本身依赖于未授权的远程代码执行，如果被滥用，可能对目标系统造成严重损害。经过代码分析，作者在代码中添加额外后门的可能性较低，主要风险在于代码本身被用于非法用途。 该`exploit.py`脚本没有明显的恶意代码，它的目的是利用已知的RCE漏洞。代码尝试找到临时上传目录和web根目录，然后上传一个PHP文件，该文件允许执行传递给它的命令。最后，它使用该文件来删除临时文件并反弹一个shell。尽管此代码本身没有恶意，但它的确会被用于恶意目的。因此，投毒风险较低，但存在误用的可能。

**项目地址:** [diegaccio/Craft-CMS-Exploit](https://github.com/diegaccio/Craft-CMS-Exploit)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #4

**来源**: [CVE-2023-41892-user01-1_CVE-2023-41892_poc.md](../2023/CVE-2023-41892-user01-1_CVE-2023-41892_poc.md)

## CVE-2023-41892 Craft CMS 远程代码执行漏洞

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，可能导致完全控制服务器

**影响版本:** >= 4.0.0-RC1, <= 4.4.14

**利用条件:** 无需认证，目标服务器需存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个未经身份验证的远程代码执行漏洞。攻击者可以通过精心构造的请求，在目标服务器上执行任意代码。从提供的搜索引擎结果和漏洞库信息来看，该漏洞影响 Craft CMS 4.0.0-RC1 到 4.4.14 版本。漏洞利用代码包括两个 Python 脚本：poc_noauth.py 和 poc_auth.py。

*   **有效性：**
    *   `poc_noauth.py`：这个脚本利用未经身份验证的漏洞，直接执行操作系统命令。它首先通过 `conditions/render` action 获取 `upload_tmp_dir` 和 `DOCUMENT_ROOT`。然后，它上传一个包含 `system($_GET['cmd']);` 的 PHP webshell 到 `DOCUMENT_ROOT/cpresources/shell.php`。最后，攻击者可以通过访问 `shell.php?cmd=<命令>` 来执行任意命令，此PoC直接并且有效。
    *   `poc_auth.py`：这个脚本也利用了相同的漏洞，但增加了一个简单的基于密钥的身份验证层。攻击者需要提供正确的密钥才能执行命令。密钥的 SHA-256 哈希值硬编码在 webshell 中。攻击者需要先计算密钥的 SHA-256 哈希值，然后替换 webshell 代码中的 `YOUR_SECRET_KEY`。使用方法参考脚本内的说明。
*   **投毒风险：**
    *   分析提供的代码，没有发现作者植入恶意代码的迹象，如反向shell，木马程序，删除数据的操作。`poc_auth.py` 的 webshell 部分可以被认为是预期的漏洞利用行为，而不是恶意投毒行为。
    *   考虑到代码的简洁性和目的性（漏洞利用），以及双 PoC 的存在（一个无认证，一个简单认证），投毒的可能性较低。
    *   综合判断，投毒风险评估为0%。
*   **利用方式：**
    1.  **信息收集：** 使用`conditions/render` action和`\GuzzleHttp\Psr7\FnStream`类来获得`upload_tmp_dir` 和 `DOCUMENT_ROOT`的值。因为文档根目录和临时目录对于 webshell 的写入至关重要。
    2.  **上传 Webshell (NoAuth)：**  脚本将一个简单的 PHP webshell (`<?php system($_GET['cmd']); ?>`) 上传到目标服务器的 `DOCUMENT_ROOT/cpresources/shell.php` 路径下。
    3.  **上传 Webshell (Auth):** 脚本利用 `Imagick` 组件上传webshell, webshell 中包含一个密钥验证的逻辑，只有提供正确的密钥才能执行命令。
    4.  **触发 Imagick 组件 (Auth):** 使用 `Imagick` 组件激活webshell，具体函数是 `activate_imagick`。
    5.  **命令执行：**  通过访问 webshell 的 URL 并提供 `cmd` 参数，即可在服务器上执行任意命令 (NoAuth)。或者提供密钥与命令 (Auth)。例如，`{target}/cpresources/shell.php?cmd=id` 或 `{target}/cpresources/shell.php?k=(YOUR_KEY)&c=id`。

总的来说，该漏洞利用过程简单直接，利用成功后，攻击者可以完全控制受影响的 Craft CMS 服务器。

**项目地址:** [user01-1/CVE-2023-41892_poc](https://github.com/user01-1/CVE-2023-41892_poc)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #5

**来源**: [CVE-2023-41892-zaenhaxor_CVE-2023-41892.md](../2023/CVE-2023-41892-zaenhaxor_CVE-2023-41892.md)

## CVE-2023-41892 - Craft CMS 远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 4.0.0-RC1 <= version <= 4.4.14

**利用条件:** 目标Craft CMS实例版本在受影响范围内，且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个远程代码执行漏洞。根据漏洞信息和搜索引擎结果，这是一个高危漏洞，攻击复杂度低，无需身份验证即可利用。提供的POC脚本 (cve.sh) 通过构造恶意的 POST 请求，利用 `conditions/render` action 和 `craft\elements\conditions\users\UserCondition` 类，以及 `\GuzzleHttp\Psr7\FnStream` 类来执行任意 PHP 代码。脚本通过发送包含 `phpinfo()` 函数的payload来验证漏洞是否存在。如果响应中包含 'PHP Credits' 或 'PHP Group'，则认为目标存在漏洞。利用方式是构造特定的请求，触发 Craft CMS 中的代码注入点，从而执行攻击者控制的 PHP 代码。

**有效性：** 提供的POC代码有效，经验证可以执行任意PHP代码。

**投毒风险：** 脚本的功能明确，目的是检测漏洞并验证漏洞的存在。没有发现任何试图在目标系统上植入后门或执行其他恶意操作的迹象。脚本只是利用已知的RCE漏洞执行PHP代码，因此投毒风险为0%。

**利用方式：**
1.  攻击者构造恶意的POST请求，目标URL为`https://[target]/index.php`。
2.  POST数据包含`action=conditions/render`和精心构造的`test[userCondition]`参数，利用`craft\elements\conditions\users\UserCondition`类和`\GuzzleHttp\Psr7\FnStream`类执行任意PHP代码。
3.  POC脚本使用`phpinfo()`作为payload来验证漏洞，实际攻击中可以替换为任何PHP代码，例如执行系统命令。
4.  如果服务器返回包含`PHP Credits`或`PHP Group`的页面，则表明漏洞利用成功。

**项目地址:** [zaenhaxor/CVE-2023-41892](https://github.com/zaenhaxor/CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---



---

## POC #4

**来源**: [CVE-2023-41892-diegaccio_Craft-CMS-Exploit.md](../2023/CVE-2023-41892-diegaccio_Craft-CMS-Exploit.md)

## CVE-2023-41892-Craft CMS-远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行

**影响应用:** Craft CMS

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** >= 4.0.0-RC1, <= 4.4.14

**利用条件:** 目标Craft CMS版本在受影响范围内，且未打补丁，需要网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个远程代码执行漏洞。根据漏洞库信息和搜索引擎结果，该漏洞影响 Craft CMS 4.0.0-RC1 到 4.4.14 版本。攻击者可以通过发送特制的请求来利用此漏洞，在目标服务器上执行任意代码。\n\n**利用方式：**\n\n1.  **信息收集：** 首先，攻击者需要确定目标 Craft CMS 的版本是否在受影响范围内。\n2.  **上传临时文件：** 该漏洞利用链首先利用了 Imagick 组件处理图像时的MSL文件，在临时目录写入包含恶意PHP代码的文件。exploit.py脚本首先通过访问一个特殊的URL（触发phpinfo()）来获取`upload_tmp_dir`和`DOCUMENT_ROOT`。如果`upload_tmp_dir`不存在，则使用`/tmp`目录。\n3.  **写入webshell:** 之后，利用MSL文件将webshell写入`DOCUMENT_ROOT`目录下。\n4.  **代码执行：**  攻击者通过访问webshell文件,并携带`cmd`参数来执行任意的系统命令。该POC脚本使用base64编码命令，以绕过潜在的过滤。\n5.  **反弹shell：** POC代码中包含了反弹 shell 的功能，允许攻击者在成功利用漏洞后获得对目标系统的控制权。\n\n**投毒风险分析：**\n\n虽然提供的POC代码主要功能是利用漏洞实现远程代码执行，但是仍然存在一定的投毒风险。例如，攻击者可能会修改POC代码，在反弹 shell 之外执行其他恶意操作，例如安装后门、窃取敏感信息等。此外，POC代码本身依赖于未授权的远程代码执行，如果被滥用，可能对目标系统造成严重损害。经过代码分析，作者在代码中添加额外后门的可能性较低，主要风险在于代码本身被用于非法用途。 该`exploit.py`脚本没有明显的恶意代码，它的目的是利用已知的RCE漏洞。代码尝试找到临时上传目录和web根目录，然后上传一个PHP文件，该文件允许执行传递给它的命令。最后，它使用该文件来删除临时文件并反弹一个shell。尽管此代码本身没有恶意，但它的确会被用于恶意目的。因此，投毒风险较低，但存在误用的可能。

**项目地址:** [diegaccio/Craft-CMS-Exploit](https://github.com/diegaccio/Craft-CMS-Exploit)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #5

**来源**: [CVE-2023-41892-user01-1_CVE-2023-41892_poc.md](../2023/CVE-2023-41892-user01-1_CVE-2023-41892_poc.md)

## CVE-2023-41892 Craft CMS 远程代码执行漏洞

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，可能导致完全控制服务器

**影响版本:** >= 4.0.0-RC1, <= 4.4.14

**利用条件:** 无需认证，目标服务器需存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个未经身份验证的远程代码执行漏洞。攻击者可以通过精心构造的请求，在目标服务器上执行任意代码。从提供的搜索引擎结果和漏洞库信息来看，该漏洞影响 Craft CMS 4.0.0-RC1 到 4.4.14 版本。漏洞利用代码包括两个 Python 脚本：poc_noauth.py 和 poc_auth.py。

*   **有效性：**
    *   `poc_noauth.py`：这个脚本利用未经身份验证的漏洞，直接执行操作系统命令。它首先通过 `conditions/render` action 获取 `upload_tmp_dir` 和 `DOCUMENT_ROOT`。然后，它上传一个包含 `system($_GET['cmd']);` 的 PHP webshell 到 `DOCUMENT_ROOT/cpresources/shell.php`。最后，攻击者可以通过访问 `shell.php?cmd=<命令>` 来执行任意命令，此PoC直接并且有效。
    *   `poc_auth.py`：这个脚本也利用了相同的漏洞，但增加了一个简单的基于密钥的身份验证层。攻击者需要提供正确的密钥才能执行命令。密钥的 SHA-256 哈希值硬编码在 webshell 中。攻击者需要先计算密钥的 SHA-256 哈希值，然后替换 webshell 代码中的 `YOUR_SECRET_KEY`。使用方法参考脚本内的说明。
*   **投毒风险：**
    *   分析提供的代码，没有发现作者植入恶意代码的迹象，如反向shell，木马程序，删除数据的操作。`poc_auth.py` 的 webshell 部分可以被认为是预期的漏洞利用行为，而不是恶意投毒行为。
    *   考虑到代码的简洁性和目的性（漏洞利用），以及双 PoC 的存在（一个无认证，一个简单认证），投毒的可能性较低。
    *   综合判断，投毒风险评估为0%。
*   **利用方式：**
    1.  **信息收集：** 使用`conditions/render` action和`\GuzzleHttp\Psr7\FnStream`类来获得`upload_tmp_dir` 和 `DOCUMENT_ROOT`的值。因为文档根目录和临时目录对于 webshell 的写入至关重要。
    2.  **上传 Webshell (NoAuth)：**  脚本将一个简单的 PHP webshell (`<?php system($_GET['cmd']); ?>`) 上传到目标服务器的 `DOCUMENT_ROOT/cpresources/shell.php` 路径下。
    3.  **上传 Webshell (Auth):** 脚本利用 `Imagick` 组件上传webshell, webshell 中包含一个密钥验证的逻辑，只有提供正确的密钥才能执行命令。
    4.  **触发 Imagick 组件 (Auth):** 使用 `Imagick` 组件激活webshell，具体函数是 `activate_imagick`。
    5.  **命令执行：**  通过访问 webshell 的 URL 并提供 `cmd` 参数，即可在服务器上执行任意命令 (NoAuth)。或者提供密钥与命令 (Auth)。例如，`{target}/cpresources/shell.php?cmd=id` 或 `{target}/cpresources/shell.php?k=(YOUR_KEY)&c=id`。

总的来说，该漏洞利用过程简单直接，利用成功后，攻击者可以完全控制受影响的 Craft CMS 服务器。

**项目地址:** [user01-1/CVE-2023-41892_poc](https://github.com/user01-1/CVE-2023-41892_poc)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #6

**来源**: [CVE-2023-41892-zaenhaxor_CVE-2023-41892.md](../2023/CVE-2023-41892-zaenhaxor_CVE-2023-41892.md)

## CVE-2023-41892 - Craft CMS 远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 4.0.0-RC1 <= version <= 4.4.14

**利用条件:** 目标Craft CMS实例版本在受影响范围内，且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个远程代码执行漏洞。根据漏洞信息和搜索引擎结果，这是一个高危漏洞，攻击复杂度低，无需身份验证即可利用。提供的POC脚本 (cve.sh) 通过构造恶意的 POST 请求，利用 `conditions/render` action 和 `craft\elements\conditions\users\UserCondition` 类，以及 `\GuzzleHttp\Psr7\FnStream` 类来执行任意 PHP 代码。脚本通过发送包含 `phpinfo()` 函数的payload来验证漏洞是否存在。如果响应中包含 'PHP Credits' 或 'PHP Group'，则认为目标存在漏洞。利用方式是构造特定的请求，触发 Craft CMS 中的代码注入点，从而执行攻击者控制的 PHP 代码。

**有效性：** 提供的POC代码有效，经验证可以执行任意PHP代码。

**投毒风险：** 脚本的功能明确，目的是检测漏洞并验证漏洞的存在。没有发现任何试图在目标系统上植入后门或执行其他恶意操作的迹象。脚本只是利用已知的RCE漏洞执行PHP代码，因此投毒风险为0%。

**利用方式：**
1.  攻击者构造恶意的POST请求，目标URL为`https://[target]/index.php`。
2.  POST数据包含`action=conditions/render`和精心构造的`test[userCondition]`参数，利用`craft\elements\conditions\users\UserCondition`类和`\GuzzleHttp\Psr7\FnStream`类执行任意PHP代码。
3.  POC脚本使用`phpinfo()`作为payload来验证漏洞，实际攻击中可以替换为任何PHP代码，例如执行系统命令。
4.  如果服务器返回包含`PHP Credits`或`PHP Group`的页面，则表明漏洞利用成功。

**项目地址:** [zaenhaxor/CVE-2023-41892](https://github.com/zaenhaxor/CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---



---

## POC #4

**来源**: [CVE-2023-41892-diegaccio_Craft-CMS-Exploit.md](../2023/CVE-2023-41892-diegaccio_Craft-CMS-Exploit.md)

## CVE-2023-41892-Craft CMS-远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行

**影响应用:** Craft CMS

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** >= 4.0.0-RC1, <= 4.4.14

**利用条件:** 目标Craft CMS版本在受影响范围内，且未打补丁，需要网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个远程代码执行漏洞。根据漏洞库信息和搜索引擎结果，该漏洞影响 Craft CMS 4.0.0-RC1 到 4.4.14 版本。攻击者可以通过发送特制的请求来利用此漏洞，在目标服务器上执行任意代码。\n\n**利用方式：**\n\n1.  **信息收集：** 首先，攻击者需要确定目标 Craft CMS 的版本是否在受影响范围内。\n2.  **上传临时文件：** 该漏洞利用链首先利用了 Imagick 组件处理图像时的MSL文件，在临时目录写入包含恶意PHP代码的文件。exploit.py脚本首先通过访问一个特殊的URL（触发phpinfo()）来获取`upload_tmp_dir`和`DOCUMENT_ROOT`。如果`upload_tmp_dir`不存在，则使用`/tmp`目录。\n3.  **写入webshell:** 之后，利用MSL文件将webshell写入`DOCUMENT_ROOT`目录下。\n4.  **代码执行：**  攻击者通过访问webshell文件,并携带`cmd`参数来执行任意的系统命令。该POC脚本使用base64编码命令，以绕过潜在的过滤。\n5.  **反弹shell：** POC代码中包含了反弹 shell 的功能，允许攻击者在成功利用漏洞后获得对目标系统的控制权。\n\n**投毒风险分析：**\n\n虽然提供的POC代码主要功能是利用漏洞实现远程代码执行，但是仍然存在一定的投毒风险。例如，攻击者可能会修改POC代码，在反弹 shell 之外执行其他恶意操作，例如安装后门、窃取敏感信息等。此外，POC代码本身依赖于未授权的远程代码执行，如果被滥用，可能对目标系统造成严重损害。经过代码分析，作者在代码中添加额外后门的可能性较低，主要风险在于代码本身被用于非法用途。 该`exploit.py`脚本没有明显的恶意代码，它的目的是利用已知的RCE漏洞。代码尝试找到临时上传目录和web根目录，然后上传一个PHP文件，该文件允许执行传递给它的命令。最后，它使用该文件来删除临时文件并反弹一个shell。尽管此代码本身没有恶意，但它的确会被用于恶意目的。因此，投毒风险较低，但存在误用的可能。

**项目地址:** [diegaccio/Craft-CMS-Exploit](https://github.com/diegaccio/Craft-CMS-Exploit)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #5

**来源**: [CVE-2023-41892-user01-1_CVE-2023-41892_poc.md](../2023/CVE-2023-41892-user01-1_CVE-2023-41892_poc.md)

## CVE-2023-41892 Craft CMS 远程代码执行漏洞

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，可能导致完全控制服务器

**影响版本:** >= 4.0.0-RC1, <= 4.4.14

**利用条件:** 无需认证，目标服务器需存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个未经身份验证的远程代码执行漏洞。攻击者可以通过精心构造的请求，在目标服务器上执行任意代码。从提供的搜索引擎结果和漏洞库信息来看，该漏洞影响 Craft CMS 4.0.0-RC1 到 4.4.14 版本。漏洞利用代码包括两个 Python 脚本：poc_noauth.py 和 poc_auth.py。

*   **有效性：**
    *   `poc_noauth.py`：这个脚本利用未经身份验证的漏洞，直接执行操作系统命令。它首先通过 `conditions/render` action 获取 `upload_tmp_dir` 和 `DOCUMENT_ROOT`。然后，它上传一个包含 `system($_GET['cmd']);` 的 PHP webshell 到 `DOCUMENT_ROOT/cpresources/shell.php`。最后，攻击者可以通过访问 `shell.php?cmd=<命令>` 来执行任意命令，此PoC直接并且有效。
    *   `poc_auth.py`：这个脚本也利用了相同的漏洞，但增加了一个简单的基于密钥的身份验证层。攻击者需要提供正确的密钥才能执行命令。密钥的 SHA-256 哈希值硬编码在 webshell 中。攻击者需要先计算密钥的 SHA-256 哈希值，然后替换 webshell 代码中的 `YOUR_SECRET_KEY`。使用方法参考脚本内的说明。
*   **投毒风险：**
    *   分析提供的代码，没有发现作者植入恶意代码的迹象，如反向shell，木马程序，删除数据的操作。`poc_auth.py` 的 webshell 部分可以被认为是预期的漏洞利用行为，而不是恶意投毒行为。
    *   考虑到代码的简洁性和目的性（漏洞利用），以及双 PoC 的存在（一个无认证，一个简单认证），投毒的可能性较低。
    *   综合判断，投毒风险评估为0%。
*   **利用方式：**
    1.  **信息收集：** 使用`conditions/render` action和`\GuzzleHttp\Psr7\FnStream`类来获得`upload_tmp_dir` 和 `DOCUMENT_ROOT`的值。因为文档根目录和临时目录对于 webshell 的写入至关重要。
    2.  **上传 Webshell (NoAuth)：**  脚本将一个简单的 PHP webshell (`<?php system($_GET['cmd']); ?>`) 上传到目标服务器的 `DOCUMENT_ROOT/cpresources/shell.php` 路径下。
    3.  **上传 Webshell (Auth):** 脚本利用 `Imagick` 组件上传webshell, webshell 中包含一个密钥验证的逻辑，只有提供正确的密钥才能执行命令。
    4.  **触发 Imagick 组件 (Auth):** 使用 `Imagick` 组件激活webshell，具体函数是 `activate_imagick`。
    5.  **命令执行：**  通过访问 webshell 的 URL 并提供 `cmd` 参数，即可在服务器上执行任意命令 (NoAuth)。或者提供密钥与命令 (Auth)。例如，`{target}/cpresources/shell.php?cmd=id` 或 `{target}/cpresources/shell.php?k=(YOUR_KEY)&c=id`。

总的来说，该漏洞利用过程简单直接，利用成功后，攻击者可以完全控制受影响的 Craft CMS 服务器。

**项目地址:** [user01-1/CVE-2023-41892_poc](https://github.com/user01-1/CVE-2023-41892_poc)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #6

**来源**: [CVE-2023-41892-zaenhaxor_CVE-2023-41892.md](../2023/CVE-2023-41892-zaenhaxor_CVE-2023-41892.md)

## CVE-2023-41892 - Craft CMS 远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 4.0.0-RC1 <= version <= 4.4.14

**利用条件:** 目标Craft CMS实例版本在受影响范围内，且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个远程代码执行漏洞。根据漏洞信息和搜索引擎结果，这是一个高危漏洞，攻击复杂度低，无需身份验证即可利用。提供的POC脚本 (cve.sh) 通过构造恶意的 POST 请求，利用 `conditions/render` action 和 `craft\elements\conditions\users\UserCondition` 类，以及 `\GuzzleHttp\Psr7\FnStream` 类来执行任意 PHP 代码。脚本通过发送包含 `phpinfo()` 函数的payload来验证漏洞是否存在。如果响应中包含 'PHP Credits' 或 'PHP Group'，则认为目标存在漏洞。利用方式是构造特定的请求，触发 Craft CMS 中的代码注入点，从而执行攻击者控制的 PHP 代码。

**有效性：** 提供的POC代码有效，经验证可以执行任意PHP代码。

**投毒风险：** 脚本的功能明确，目的是检测漏洞并验证漏洞的存在。没有发现任何试图在目标系统上植入后门或执行其他恶意操作的迹象。脚本只是利用已知的RCE漏洞执行PHP代码，因此投毒风险为0%。

**利用方式：**
1.  攻击者构造恶意的POST请求，目标URL为`https://[target]/index.php`。
2.  POST数据包含`action=conditions/render`和精心构造的`test[userCondition]`参数，利用`craft\elements\conditions\users\UserCondition`类和`\GuzzleHttp\Psr7\FnStream`类执行任意PHP代码。
3.  POC脚本使用`phpinfo()`作为payload来验证漏洞，实际攻击中可以替换为任何PHP代码，例如执行系统命令。
4.  如果服务器返回包含`PHP Credits`或`PHP Group`的页面，则表明漏洞利用成功。

**项目地址:** [zaenhaxor/CVE-2023-41892](https://github.com/zaenhaxor/CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---



---

## POC #4

**来源**: [CVE-2023-41892-diegaccio_Craft-CMS-Exploit.md](../2023/CVE-2023-41892-diegaccio_Craft-CMS-Exploit.md)

## CVE-2023-41892-Craft CMS-远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行

**影响应用:** Craft CMS

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** >= 4.0.0-RC1, <= 4.4.14

**利用条件:** 目标Craft CMS版本在受影响范围内，且未打补丁，需要网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个远程代码执行漏洞。根据漏洞库信息和搜索引擎结果，该漏洞影响 Craft CMS 4.0.0-RC1 到 4.4.14 版本。攻击者可以通过发送特制的请求来利用此漏洞，在目标服务器上执行任意代码。\n\n**利用方式：**\n\n1.  **信息收集：** 首先，攻击者需要确定目标 Craft CMS 的版本是否在受影响范围内。\n2.  **上传临时文件：** 该漏洞利用链首先利用了 Imagick 组件处理图像时的MSL文件，在临时目录写入包含恶意PHP代码的文件。exploit.py脚本首先通过访问一个特殊的URL（触发phpinfo()）来获取`upload_tmp_dir`和`DOCUMENT_ROOT`。如果`upload_tmp_dir`不存在，则使用`/tmp`目录。\n3.  **写入webshell:** 之后，利用MSL文件将webshell写入`DOCUMENT_ROOT`目录下。\n4.  **代码执行：**  攻击者通过访问webshell文件,并携带`cmd`参数来执行任意的系统命令。该POC脚本使用base64编码命令，以绕过潜在的过滤。\n5.  **反弹shell：** POC代码中包含了反弹 shell 的功能，允许攻击者在成功利用漏洞后获得对目标系统的控制权。\n\n**投毒风险分析：**\n\n虽然提供的POC代码主要功能是利用漏洞实现远程代码执行，但是仍然存在一定的投毒风险。例如，攻击者可能会修改POC代码，在反弹 shell 之外执行其他恶意操作，例如安装后门、窃取敏感信息等。此外，POC代码本身依赖于未授权的远程代码执行，如果被滥用，可能对目标系统造成严重损害。经过代码分析，作者在代码中添加额外后门的可能性较低，主要风险在于代码本身被用于非法用途。 该`exploit.py`脚本没有明显的恶意代码，它的目的是利用已知的RCE漏洞。代码尝试找到临时上传目录和web根目录，然后上传一个PHP文件，该文件允许执行传递给它的命令。最后，它使用该文件来删除临时文件并反弹一个shell。尽管此代码本身没有恶意，但它的确会被用于恶意目的。因此，投毒风险较低，但存在误用的可能。

**项目地址:** [diegaccio/Craft-CMS-Exploit](https://github.com/diegaccio/Craft-CMS-Exploit)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #5

**来源**: [CVE-2023-41892-user01-1_CVE-2023-41892_poc.md](../2023/CVE-2023-41892-user01-1_CVE-2023-41892_poc.md)

## CVE-2023-41892 Craft CMS 远程代码执行漏洞

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，可能导致完全控制服务器

**影响版本:** >= 4.0.0-RC1, <= 4.4.14

**利用条件:** 无需认证，目标服务器需存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个未经身份验证的远程代码执行漏洞。攻击者可以通过精心构造的请求，在目标服务器上执行任意代码。从提供的搜索引擎结果和漏洞库信息来看，该漏洞影响 Craft CMS 4.0.0-RC1 到 4.4.14 版本。漏洞利用代码包括两个 Python 脚本：poc_noauth.py 和 poc_auth.py。

*   **有效性：**
    *   `poc_noauth.py`：这个脚本利用未经身份验证的漏洞，直接执行操作系统命令。它首先通过 `conditions/render` action 获取 `upload_tmp_dir` 和 `DOCUMENT_ROOT`。然后，它上传一个包含 `system($_GET['cmd']);` 的 PHP webshell 到 `DOCUMENT_ROOT/cpresources/shell.php`。最后，攻击者可以通过访问 `shell.php?cmd=<命令>` 来执行任意命令，此PoC直接并且有效。
    *   `poc_auth.py`：这个脚本也利用了相同的漏洞，但增加了一个简单的基于密钥的身份验证层。攻击者需要提供正确的密钥才能执行命令。密钥的 SHA-256 哈希值硬编码在 webshell 中。攻击者需要先计算密钥的 SHA-256 哈希值，然后替换 webshell 代码中的 `YOUR_SECRET_KEY`。使用方法参考脚本内的说明。
*   **投毒风险：**
    *   分析提供的代码，没有发现作者植入恶意代码的迹象，如反向shell，木马程序，删除数据的操作。`poc_auth.py` 的 webshell 部分可以被认为是预期的漏洞利用行为，而不是恶意投毒行为。
    *   考虑到代码的简洁性和目的性（漏洞利用），以及双 PoC 的存在（一个无认证，一个简单认证），投毒的可能性较低。
    *   综合判断，投毒风险评估为0%。
*   **利用方式：**
    1.  **信息收集：** 使用`conditions/render` action和`\GuzzleHttp\Psr7\FnStream`类来获得`upload_tmp_dir` 和 `DOCUMENT_ROOT`的值。因为文档根目录和临时目录对于 webshell 的写入至关重要。
    2.  **上传 Webshell (NoAuth)：**  脚本将一个简单的 PHP webshell (`<?php system($_GET['cmd']); ?>`) 上传到目标服务器的 `DOCUMENT_ROOT/cpresources/shell.php` 路径下。
    3.  **上传 Webshell (Auth):** 脚本利用 `Imagick` 组件上传webshell, webshell 中包含一个密钥验证的逻辑，只有提供正确的密钥才能执行命令。
    4.  **触发 Imagick 组件 (Auth):** 使用 `Imagick` 组件激活webshell，具体函数是 `activate_imagick`。
    5.  **命令执行：**  通过访问 webshell 的 URL 并提供 `cmd` 参数，即可在服务器上执行任意命令 (NoAuth)。或者提供密钥与命令 (Auth)。例如，`{target}/cpresources/shell.php?cmd=id` 或 `{target}/cpresources/shell.php?k=(YOUR_KEY)&c=id`。

总的来说，该漏洞利用过程简单直接，利用成功后，攻击者可以完全控制受影响的 Craft CMS 服务器。

**项目地址:** [user01-1/CVE-2023-41892_poc](https://github.com/user01-1/CVE-2023-41892_poc)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #6

**来源**: [CVE-2023-41892-zaenhaxor_CVE-2023-41892.md](../2023/CVE-2023-41892-zaenhaxor_CVE-2023-41892.md)

## CVE-2023-41892 - Craft CMS 远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 4.0.0-RC1 <= version <= 4.4.14

**利用条件:** 目标Craft CMS实例版本在受影响范围内，且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个远程代码执行漏洞。根据漏洞信息和搜索引擎结果，这是一个高危漏洞，攻击复杂度低，无需身份验证即可利用。提供的POC脚本 (cve.sh) 通过构造恶意的 POST 请求，利用 `conditions/render` action 和 `craft\elements\conditions\users\UserCondition` 类，以及 `\GuzzleHttp\Psr7\FnStream` 类来执行任意 PHP 代码。脚本通过发送包含 `phpinfo()` 函数的payload来验证漏洞是否存在。如果响应中包含 'PHP Credits' 或 'PHP Group'，则认为目标存在漏洞。利用方式是构造特定的请求，触发 Craft CMS 中的代码注入点，从而执行攻击者控制的 PHP 代码。

**有效性：** 提供的POC代码有效，经验证可以执行任意PHP代码。

**投毒风险：** 脚本的功能明确，目的是检测漏洞并验证漏洞的存在。没有发现任何试图在目标系统上植入后门或执行其他恶意操作的迹象。脚本只是利用已知的RCE漏洞执行PHP代码，因此投毒风险为0%。

**利用方式：**
1.  攻击者构造恶意的POST请求，目标URL为`https://[target]/index.php`。
2.  POST数据包含`action=conditions/render`和精心构造的`test[userCondition]`参数，利用`craft\elements\conditions\users\UserCondition`类和`\GuzzleHttp\Psr7\FnStream`类执行任意PHP代码。
3.  POC脚本使用`phpinfo()`作为payload来验证漏洞，实际攻击中可以替换为任何PHP代码，例如执行系统命令。
4.  如果服务器返回包含`PHP Credits`或`PHP Group`的页面，则表明漏洞利用成功。

**项目地址:** [zaenhaxor/CVE-2023-41892](https://github.com/zaenhaxor/CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---



---

## POC #4

**来源**: [CVE-2023-41892-diegaccio_Craft-CMS-Exploit.md](../2023/CVE-2023-41892-diegaccio_Craft-CMS-Exploit.md)

## CVE-2023-41892-Craft CMS-远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行

**影响应用:** Craft CMS

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** >= 4.0.0-RC1, <= 4.4.14

**利用条件:** 目标Craft CMS版本在受影响范围内，且未打补丁，需要网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个远程代码执行漏洞。根据漏洞库信息和搜索引擎结果，该漏洞影响 Craft CMS 4.0.0-RC1 到 4.4.14 版本。攻击者可以通过发送特制的请求来利用此漏洞，在目标服务器上执行任意代码。\n\n**利用方式：**\n\n1.  **信息收集：** 首先，攻击者需要确定目标 Craft CMS 的版本是否在受影响范围内。\n2.  **上传临时文件：** 该漏洞利用链首先利用了 Imagick 组件处理图像时的MSL文件，在临时目录写入包含恶意PHP代码的文件。exploit.py脚本首先通过访问一个特殊的URL（触发phpinfo()）来获取`upload_tmp_dir`和`DOCUMENT_ROOT`。如果`upload_tmp_dir`不存在，则使用`/tmp`目录。\n3.  **写入webshell:** 之后，利用MSL文件将webshell写入`DOCUMENT_ROOT`目录下。\n4.  **代码执行：**  攻击者通过访问webshell文件,并携带`cmd`参数来执行任意的系统命令。该POC脚本使用base64编码命令，以绕过潜在的过滤。\n5.  **反弹shell：** POC代码中包含了反弹 shell 的功能，允许攻击者在成功利用漏洞后获得对目标系统的控制权。\n\n**投毒风险分析：**\n\n虽然提供的POC代码主要功能是利用漏洞实现远程代码执行，但是仍然存在一定的投毒风险。例如，攻击者可能会修改POC代码，在反弹 shell 之外执行其他恶意操作，例如安装后门、窃取敏感信息等。此外，POC代码本身依赖于未授权的远程代码执行，如果被滥用，可能对目标系统造成严重损害。经过代码分析，作者在代码中添加额外后门的可能性较低，主要风险在于代码本身被用于非法用途。 该`exploit.py`脚本没有明显的恶意代码，它的目的是利用已知的RCE漏洞。代码尝试找到临时上传目录和web根目录，然后上传一个PHP文件，该文件允许执行传递给它的命令。最后，它使用该文件来删除临时文件并反弹一个shell。尽管此代码本身没有恶意，但它的确会被用于恶意目的。因此，投毒风险较低，但存在误用的可能。

**项目地址:** [diegaccio/Craft-CMS-Exploit](https://github.com/diegaccio/Craft-CMS-Exploit)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #5

**来源**: [CVE-2023-41892-user01-1_CVE-2023-41892_poc.md](../2023/CVE-2023-41892-user01-1_CVE-2023-41892_poc.md)

## CVE-2023-41892 Craft CMS 远程代码执行漏洞

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，可能导致完全控制服务器

**影响版本:** >= 4.0.0-RC1, <= 4.4.14

**利用条件:** 无需认证，目标服务器需存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个未经身份验证的远程代码执行漏洞。攻击者可以通过精心构造的请求，在目标服务器上执行任意代码。从提供的搜索引擎结果和漏洞库信息来看，该漏洞影响 Craft CMS 4.0.0-RC1 到 4.4.14 版本。漏洞利用代码包括两个 Python 脚本：poc_noauth.py 和 poc_auth.py。

*   **有效性：**
    *   `poc_noauth.py`：这个脚本利用未经身份验证的漏洞，直接执行操作系统命令。它首先通过 `conditions/render` action 获取 `upload_tmp_dir` 和 `DOCUMENT_ROOT`。然后，它上传一个包含 `system($_GET['cmd']);` 的 PHP webshell 到 `DOCUMENT_ROOT/cpresources/shell.php`。最后，攻击者可以通过访问 `shell.php?cmd=<命令>` 来执行任意命令，此PoC直接并且有效。
    *   `poc_auth.py`：这个脚本也利用了相同的漏洞，但增加了一个简单的基于密钥的身份验证层。攻击者需要提供正确的密钥才能执行命令。密钥的 SHA-256 哈希值硬编码在 webshell 中。攻击者需要先计算密钥的 SHA-256 哈希值，然后替换 webshell 代码中的 `YOUR_SECRET_KEY`。使用方法参考脚本内的说明。
*   **投毒风险：**
    *   分析提供的代码，没有发现作者植入恶意代码的迹象，如反向shell，木马程序，删除数据的操作。`poc_auth.py` 的 webshell 部分可以被认为是预期的漏洞利用行为，而不是恶意投毒行为。
    *   考虑到代码的简洁性和目的性（漏洞利用），以及双 PoC 的存在（一个无认证，一个简单认证），投毒的可能性较低。
    *   综合判断，投毒风险评估为0%。
*   **利用方式：**
    1.  **信息收集：** 使用`conditions/render` action和`\GuzzleHttp\Psr7\FnStream`类来获得`upload_tmp_dir` 和 `DOCUMENT_ROOT`的值。因为文档根目录和临时目录对于 webshell 的写入至关重要。
    2.  **上传 Webshell (NoAuth)：**  脚本将一个简单的 PHP webshell (`<?php system($_GET['cmd']); ?>`) 上传到目标服务器的 `DOCUMENT_ROOT/cpresources/shell.php` 路径下。
    3.  **上传 Webshell (Auth):** 脚本利用 `Imagick` 组件上传webshell, webshell 中包含一个密钥验证的逻辑，只有提供正确的密钥才能执行命令。
    4.  **触发 Imagick 组件 (Auth):** 使用 `Imagick` 组件激活webshell，具体函数是 `activate_imagick`。
    5.  **命令执行：**  通过访问 webshell 的 URL 并提供 `cmd` 参数，即可在服务器上执行任意命令 (NoAuth)。或者提供密钥与命令 (Auth)。例如，`{target}/cpresources/shell.php?cmd=id` 或 `{target}/cpresources/shell.php?k=(YOUR_KEY)&c=id`。

总的来说，该漏洞利用过程简单直接，利用成功后，攻击者可以完全控制受影响的 Craft CMS 服务器。

**项目地址:** [user01-1/CVE-2023-41892_poc](https://github.com/user01-1/CVE-2023-41892_poc)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #6

**来源**: [CVE-2023-41892-zaenhaxor_CVE-2023-41892.md](../2023/CVE-2023-41892-zaenhaxor_CVE-2023-41892.md)

## CVE-2023-41892 - Craft CMS 远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 4.0.0-RC1 <= version <= 4.4.14

**利用条件:** 目标Craft CMS实例版本在受影响范围内，且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个远程代码执行漏洞。根据漏洞信息和搜索引擎结果，这是一个高危漏洞，攻击复杂度低，无需身份验证即可利用。提供的POC脚本 (cve.sh) 通过构造恶意的 POST 请求，利用 `conditions/render` action 和 `craft\elements\conditions\users\UserCondition` 类，以及 `\GuzzleHttp\Psr7\FnStream` 类来执行任意 PHP 代码。脚本通过发送包含 `phpinfo()` 函数的payload来验证漏洞是否存在。如果响应中包含 'PHP Credits' 或 'PHP Group'，则认为目标存在漏洞。利用方式是构造特定的请求，触发 Craft CMS 中的代码注入点，从而执行攻击者控制的 PHP 代码。

**有效性：** 提供的POC代码有效，经验证可以执行任意PHP代码。

**投毒风险：** 脚本的功能明确，目的是检测漏洞并验证漏洞的存在。没有发现任何试图在目标系统上植入后门或执行其他恶意操作的迹象。脚本只是利用已知的RCE漏洞执行PHP代码，因此投毒风险为0%。

**利用方式：**
1.  攻击者构造恶意的POST请求，目标URL为`https://[target]/index.php`。
2.  POST数据包含`action=conditions/render`和精心构造的`test[userCondition]`参数，利用`craft\elements\conditions\users\UserCondition`类和`\GuzzleHttp\Psr7\FnStream`类执行任意PHP代码。
3.  POC脚本使用`phpinfo()`作为payload来验证漏洞，实际攻击中可以替换为任何PHP代码，例如执行系统命令。
4.  如果服务器返回包含`PHP Credits`或`PHP Group`的页面，则表明漏洞利用成功。

**项目地址:** [zaenhaxor/CVE-2023-41892](https://github.com/zaenhaxor/CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---



---

## POC #4

**来源**: [CVE-2023-41892-diegaccio_Craft-CMS-Exploit.md](../2023/CVE-2023-41892-diegaccio_Craft-CMS-Exploit.md)

## CVE-2023-41892-Craft CMS-远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行

**影响应用:** Craft CMS

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** >= 4.0.0-RC1, <= 4.4.14

**利用条件:** 目标Craft CMS版本在受影响范围内，且未打补丁，需要网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个远程代码执行漏洞。根据漏洞库信息和搜索引擎结果，该漏洞影响 Craft CMS 4.0.0-RC1 到 4.4.14 版本。攻击者可以通过发送特制的请求来利用此漏洞，在目标服务器上执行任意代码。\n\n**利用方式：**\n\n1.  **信息收集：** 首先，攻击者需要确定目标 Craft CMS 的版本是否在受影响范围内。\n2.  **上传临时文件：** 该漏洞利用链首先利用了 Imagick 组件处理图像时的MSL文件，在临时目录写入包含恶意PHP代码的文件。exploit.py脚本首先通过访问一个特殊的URL（触发phpinfo()）来获取`upload_tmp_dir`和`DOCUMENT_ROOT`。如果`upload_tmp_dir`不存在，则使用`/tmp`目录。\n3.  **写入webshell:** 之后，利用MSL文件将webshell写入`DOCUMENT_ROOT`目录下。\n4.  **代码执行：**  攻击者通过访问webshell文件,并携带`cmd`参数来执行任意的系统命令。该POC脚本使用base64编码命令，以绕过潜在的过滤。\n5.  **反弹shell：** POC代码中包含了反弹 shell 的功能，允许攻击者在成功利用漏洞后获得对目标系统的控制权。\n\n**投毒风险分析：**\n\n虽然提供的POC代码主要功能是利用漏洞实现远程代码执行，但是仍然存在一定的投毒风险。例如，攻击者可能会修改POC代码，在反弹 shell 之外执行其他恶意操作，例如安装后门、窃取敏感信息等。此外，POC代码本身依赖于未授权的远程代码执行，如果被滥用，可能对目标系统造成严重损害。经过代码分析，作者在代码中添加额外后门的可能性较低，主要风险在于代码本身被用于非法用途。 该`exploit.py`脚本没有明显的恶意代码，它的目的是利用已知的RCE漏洞。代码尝试找到临时上传目录和web根目录，然后上传一个PHP文件，该文件允许执行传递给它的命令。最后，它使用该文件来删除临时文件并反弹一个shell。尽管此代码本身没有恶意，但它的确会被用于恶意目的。因此，投毒风险较低，但存在误用的可能。

**项目地址:** [diegaccio/Craft-CMS-Exploit](https://github.com/diegaccio/Craft-CMS-Exploit)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #5

**来源**: [CVE-2023-41892-user01-1_CVE-2023-41892_poc.md](../2023/CVE-2023-41892-user01-1_CVE-2023-41892_poc.md)

## CVE-2023-41892 Craft CMS 远程代码执行漏洞

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，可能导致完全控制服务器

**影响版本:** >= 4.0.0-RC1, <= 4.4.14

**利用条件:** 无需认证，目标服务器需存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个未经身份验证的远程代码执行漏洞。攻击者可以通过精心构造的请求，在目标服务器上执行任意代码。从提供的搜索引擎结果和漏洞库信息来看，该漏洞影响 Craft CMS 4.0.0-RC1 到 4.4.14 版本。漏洞利用代码包括两个 Python 脚本：poc_noauth.py 和 poc_auth.py。

*   **有效性：**
    *   `poc_noauth.py`：这个脚本利用未经身份验证的漏洞，直接执行操作系统命令。它首先通过 `conditions/render` action 获取 `upload_tmp_dir` 和 `DOCUMENT_ROOT`。然后，它上传一个包含 `system($_GET['cmd']);` 的 PHP webshell 到 `DOCUMENT_ROOT/cpresources/shell.php`。最后，攻击者可以通过访问 `shell.php?cmd=<命令>` 来执行任意命令，此PoC直接并且有效。
    *   `poc_auth.py`：这个脚本也利用了相同的漏洞，但增加了一个简单的基于密钥的身份验证层。攻击者需要提供正确的密钥才能执行命令。密钥的 SHA-256 哈希值硬编码在 webshell 中。攻击者需要先计算密钥的 SHA-256 哈希值，然后替换 webshell 代码中的 `YOUR_SECRET_KEY`。使用方法参考脚本内的说明。
*   **投毒风险：**
    *   分析提供的代码，没有发现作者植入恶意代码的迹象，如反向shell，木马程序，删除数据的操作。`poc_auth.py` 的 webshell 部分可以被认为是预期的漏洞利用行为，而不是恶意投毒行为。
    *   考虑到代码的简洁性和目的性（漏洞利用），以及双 PoC 的存在（一个无认证，一个简单认证），投毒的可能性较低。
    *   综合判断，投毒风险评估为0%。
*   **利用方式：**
    1.  **信息收集：** 使用`conditions/render` action和`\GuzzleHttp\Psr7\FnStream`类来获得`upload_tmp_dir` 和 `DOCUMENT_ROOT`的值。因为文档根目录和临时目录对于 webshell 的写入至关重要。
    2.  **上传 Webshell (NoAuth)：**  脚本将一个简单的 PHP webshell (`<?php system($_GET['cmd']); ?>`) 上传到目标服务器的 `DOCUMENT_ROOT/cpresources/shell.php` 路径下。
    3.  **上传 Webshell (Auth):** 脚本利用 `Imagick` 组件上传webshell, webshell 中包含一个密钥验证的逻辑，只有提供正确的密钥才能执行命令。
    4.  **触发 Imagick 组件 (Auth):** 使用 `Imagick` 组件激活webshell，具体函数是 `activate_imagick`。
    5.  **命令执行：**  通过访问 webshell 的 URL 并提供 `cmd` 参数，即可在服务器上执行任意命令 (NoAuth)。或者提供密钥与命令 (Auth)。例如，`{target}/cpresources/shell.php?cmd=id` 或 `{target}/cpresources/shell.php?k=(YOUR_KEY)&c=id`。

总的来说，该漏洞利用过程简单直接，利用成功后，攻击者可以完全控制受影响的 Craft CMS 服务器。

**项目地址:** [user01-1/CVE-2023-41892_poc](https://github.com/user01-1/CVE-2023-41892_poc)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #6

**来源**: [CVE-2023-41892-zaenhaxor_CVE-2023-41892.md](../2023/CVE-2023-41892-zaenhaxor_CVE-2023-41892.md)

## CVE-2023-41892 - Craft CMS 远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 4.0.0-RC1 <= version <= 4.4.14

**利用条件:** 目标Craft CMS实例版本在受影响范围内，且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个远程代码执行漏洞。根据漏洞信息和搜索引擎结果，这是一个高危漏洞，攻击复杂度低，无需身份验证即可利用。提供的POC脚本 (cve.sh) 通过构造恶意的 POST 请求，利用 `conditions/render` action 和 `craft\elements\conditions\users\UserCondition` 类，以及 `\GuzzleHttp\Psr7\FnStream` 类来执行任意 PHP 代码。脚本通过发送包含 `phpinfo()` 函数的payload来验证漏洞是否存在。如果响应中包含 'PHP Credits' 或 'PHP Group'，则认为目标存在漏洞。利用方式是构造特定的请求，触发 Craft CMS 中的代码注入点，从而执行攻击者控制的 PHP 代码。

**有效性：** 提供的POC代码有效，经验证可以执行任意PHP代码。

**投毒风险：** 脚本的功能明确，目的是检测漏洞并验证漏洞的存在。没有发现任何试图在目标系统上植入后门或执行其他恶意操作的迹象。脚本只是利用已知的RCE漏洞执行PHP代码，因此投毒风险为0%。

**利用方式：**
1.  攻击者构造恶意的POST请求，目标URL为`https://[target]/index.php`。
2.  POST数据包含`action=conditions/render`和精心构造的`test[userCondition]`参数，利用`craft\elements\conditions\users\UserCondition`类和`\GuzzleHttp\Psr7\FnStream`类执行任意PHP代码。
3.  POC脚本使用`phpinfo()`作为payload来验证漏洞，实际攻击中可以替换为任何PHP代码，例如执行系统命令。
4.  如果服务器返回包含`PHP Credits`或`PHP Group`的页面，则表明漏洞利用成功。

**项目地址:** [zaenhaxor/CVE-2023-41892](https://github.com/zaenhaxor/CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---



---

## POC #4

**来源**: [CVE-2023-41892-diegaccio_Craft-CMS-Exploit.md](../2023/CVE-2023-41892-diegaccio_Craft-CMS-Exploit.md)

## CVE-2023-41892-Craft CMS-远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行

**影响应用:** Craft CMS

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** >= 4.0.0-RC1, <= 4.4.14

**利用条件:** 目标Craft CMS版本在受影响范围内，且未打补丁，需要网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个远程代码执行漏洞。根据漏洞库信息和搜索引擎结果，该漏洞影响 Craft CMS 4.0.0-RC1 到 4.4.14 版本。攻击者可以通过发送特制的请求来利用此漏洞，在目标服务器上执行任意代码。\n\n**利用方式：**\n\n1.  **信息收集：** 首先，攻击者需要确定目标 Craft CMS 的版本是否在受影响范围内。\n2.  **上传临时文件：** 该漏洞利用链首先利用了 Imagick 组件处理图像时的MSL文件，在临时目录写入包含恶意PHP代码的文件。exploit.py脚本首先通过访问一个特殊的URL（触发phpinfo()）来获取`upload_tmp_dir`和`DOCUMENT_ROOT`。如果`upload_tmp_dir`不存在，则使用`/tmp`目录。\n3.  **写入webshell:** 之后，利用MSL文件将webshell写入`DOCUMENT_ROOT`目录下。\n4.  **代码执行：**  攻击者通过访问webshell文件,并携带`cmd`参数来执行任意的系统命令。该POC脚本使用base64编码命令，以绕过潜在的过滤。\n5.  **反弹shell：** POC代码中包含了反弹 shell 的功能，允许攻击者在成功利用漏洞后获得对目标系统的控制权。\n\n**投毒风险分析：**\n\n虽然提供的POC代码主要功能是利用漏洞实现远程代码执行，但是仍然存在一定的投毒风险。例如，攻击者可能会修改POC代码，在反弹 shell 之外执行其他恶意操作，例如安装后门、窃取敏感信息等。此外，POC代码本身依赖于未授权的远程代码执行，如果被滥用，可能对目标系统造成严重损害。经过代码分析，作者在代码中添加额外后门的可能性较低，主要风险在于代码本身被用于非法用途。 该`exploit.py`脚本没有明显的恶意代码，它的目的是利用已知的RCE漏洞。代码尝试找到临时上传目录和web根目录，然后上传一个PHP文件，该文件允许执行传递给它的命令。最后，它使用该文件来删除临时文件并反弹一个shell。尽管此代码本身没有恶意，但它的确会被用于恶意目的。因此，投毒风险较低，但存在误用的可能。

**项目地址:** [diegaccio/Craft-CMS-Exploit](https://github.com/diegaccio/Craft-CMS-Exploit)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #5

**来源**: [CVE-2023-41892-user01-1_CVE-2023-41892_poc.md](../2023/CVE-2023-41892-user01-1_CVE-2023-41892_poc.md)

## CVE-2023-41892 Craft CMS 远程代码执行漏洞

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，可能导致完全控制服务器

**影响版本:** >= 4.0.0-RC1, <= 4.4.14

**利用条件:** 无需认证，目标服务器需存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个未经身份验证的远程代码执行漏洞。攻击者可以通过精心构造的请求，在目标服务器上执行任意代码。从提供的搜索引擎结果和漏洞库信息来看，该漏洞影响 Craft CMS 4.0.0-RC1 到 4.4.14 版本。漏洞利用代码包括两个 Python 脚本：poc_noauth.py 和 poc_auth.py。

*   **有效性：**
    *   `poc_noauth.py`：这个脚本利用未经身份验证的漏洞，直接执行操作系统命令。它首先通过 `conditions/render` action 获取 `upload_tmp_dir` 和 `DOCUMENT_ROOT`。然后，它上传一个包含 `system($_GET['cmd']);` 的 PHP webshell 到 `DOCUMENT_ROOT/cpresources/shell.php`。最后，攻击者可以通过访问 `shell.php?cmd=<命令>` 来执行任意命令，此PoC直接并且有效。
    *   `poc_auth.py`：这个脚本也利用了相同的漏洞，但增加了一个简单的基于密钥的身份验证层。攻击者需要提供正确的密钥才能执行命令。密钥的 SHA-256 哈希值硬编码在 webshell 中。攻击者需要先计算密钥的 SHA-256 哈希值，然后替换 webshell 代码中的 `YOUR_SECRET_KEY`。使用方法参考脚本内的说明。
*   **投毒风险：**
    *   分析提供的代码，没有发现作者植入恶意代码的迹象，如反向shell，木马程序，删除数据的操作。`poc_auth.py` 的 webshell 部分可以被认为是预期的漏洞利用行为，而不是恶意投毒行为。
    *   考虑到代码的简洁性和目的性（漏洞利用），以及双 PoC 的存在（一个无认证，一个简单认证），投毒的可能性较低。
    *   综合判断，投毒风险评估为0%。
*   **利用方式：**
    1.  **信息收集：** 使用`conditions/render` action和`\GuzzleHttp\Psr7\FnStream`类来获得`upload_tmp_dir` 和 `DOCUMENT_ROOT`的值。因为文档根目录和临时目录对于 webshell 的写入至关重要。
    2.  **上传 Webshell (NoAuth)：**  脚本将一个简单的 PHP webshell (`<?php system($_GET['cmd']); ?>`) 上传到目标服务器的 `DOCUMENT_ROOT/cpresources/shell.php` 路径下。
    3.  **上传 Webshell (Auth):** 脚本利用 `Imagick` 组件上传webshell, webshell 中包含一个密钥验证的逻辑，只有提供正确的密钥才能执行命令。
    4.  **触发 Imagick 组件 (Auth):** 使用 `Imagick` 组件激活webshell，具体函数是 `activate_imagick`。
    5.  **命令执行：**  通过访问 webshell 的 URL 并提供 `cmd` 参数，即可在服务器上执行任意命令 (NoAuth)。或者提供密钥与命令 (Auth)。例如，`{target}/cpresources/shell.php?cmd=id` 或 `{target}/cpresources/shell.php?k=(YOUR_KEY)&c=id`。

总的来说，该漏洞利用过程简单直接，利用成功后，攻击者可以完全控制受影响的 Craft CMS 服务器。

**项目地址:** [user01-1/CVE-2023-41892_poc](https://github.com/user01-1/CVE-2023-41892_poc)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #6

**来源**: [CVE-2023-41892-zaenhaxor_CVE-2023-41892.md](../2023/CVE-2023-41892-zaenhaxor_CVE-2023-41892.md)

## CVE-2023-41892 - Craft CMS 远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 4.0.0-RC1 <= version <= 4.4.14

**利用条件:** 目标Craft CMS实例版本在受影响范围内，且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个远程代码执行漏洞。根据漏洞信息和搜索引擎结果，这是一个高危漏洞，攻击复杂度低，无需身份验证即可利用。提供的POC脚本 (cve.sh) 通过构造恶意的 POST 请求，利用 `conditions/render` action 和 `craft\elements\conditions\users\UserCondition` 类，以及 `\GuzzleHttp\Psr7\FnStream` 类来执行任意 PHP 代码。脚本通过发送包含 `phpinfo()` 函数的payload来验证漏洞是否存在。如果响应中包含 'PHP Credits' 或 'PHP Group'，则认为目标存在漏洞。利用方式是构造特定的请求，触发 Craft CMS 中的代码注入点，从而执行攻击者控制的 PHP 代码。

**有效性：** 提供的POC代码有效，经验证可以执行任意PHP代码。

**投毒风险：** 脚本的功能明确，目的是检测漏洞并验证漏洞的存在。没有发现任何试图在目标系统上植入后门或执行其他恶意操作的迹象。脚本只是利用已知的RCE漏洞执行PHP代码，因此投毒风险为0%。

**利用方式：**
1.  攻击者构造恶意的POST请求，目标URL为`https://[target]/index.php`。
2.  POST数据包含`action=conditions/render`和精心构造的`test[userCondition]`参数，利用`craft\elements\conditions\users\UserCondition`类和`\GuzzleHttp\Psr7\FnStream`类执行任意PHP代码。
3.  POC脚本使用`phpinfo()`作为payload来验证漏洞，实际攻击中可以替换为任何PHP代码，例如执行系统命令。
4.  如果服务器返回包含`PHP Credits`或`PHP Group`的页面，则表明漏洞利用成功。

**项目地址:** [zaenhaxor/CVE-2023-41892](https://github.com/zaenhaxor/CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---



---

## POC #4

**来源**: [CVE-2023-41892-diegaccio_Craft-CMS-Exploit.md](../2023/CVE-2023-41892-diegaccio_Craft-CMS-Exploit.md)

## CVE-2023-41892-Craft CMS-远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行

**影响应用:** Craft CMS

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** >= 4.0.0-RC1, <= 4.4.14

**利用条件:** 目标Craft CMS版本在受影响范围内，且未打补丁，需要网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个远程代码执行漏洞。根据漏洞库信息和搜索引擎结果，该漏洞影响 Craft CMS 4.0.0-RC1 到 4.4.14 版本。攻击者可以通过发送特制的请求来利用此漏洞，在目标服务器上执行任意代码。\n\n**利用方式：**\n\n1.  **信息收集：** 首先，攻击者需要确定目标 Craft CMS 的版本是否在受影响范围内。\n2.  **上传临时文件：** 该漏洞利用链首先利用了 Imagick 组件处理图像时的MSL文件，在临时目录写入包含恶意PHP代码的文件。exploit.py脚本首先通过访问一个特殊的URL（触发phpinfo()）来获取`upload_tmp_dir`和`DOCUMENT_ROOT`。如果`upload_tmp_dir`不存在，则使用`/tmp`目录。\n3.  **写入webshell:** 之后，利用MSL文件将webshell写入`DOCUMENT_ROOT`目录下。\n4.  **代码执行：**  攻击者通过访问webshell文件,并携带`cmd`参数来执行任意的系统命令。该POC脚本使用base64编码命令，以绕过潜在的过滤。\n5.  **反弹shell：** POC代码中包含了反弹 shell 的功能，允许攻击者在成功利用漏洞后获得对目标系统的控制权。\n\n**投毒风险分析：**\n\n虽然提供的POC代码主要功能是利用漏洞实现远程代码执行，但是仍然存在一定的投毒风险。例如，攻击者可能会修改POC代码，在反弹 shell 之外执行其他恶意操作，例如安装后门、窃取敏感信息等。此外，POC代码本身依赖于未授权的远程代码执行，如果被滥用，可能对目标系统造成严重损害。经过代码分析，作者在代码中添加额外后门的可能性较低，主要风险在于代码本身被用于非法用途。 该`exploit.py`脚本没有明显的恶意代码，它的目的是利用已知的RCE漏洞。代码尝试找到临时上传目录和web根目录，然后上传一个PHP文件，该文件允许执行传递给它的命令。最后，它使用该文件来删除临时文件并反弹一个shell。尽管此代码本身没有恶意，但它的确会被用于恶意目的。因此，投毒风险较低，但存在误用的可能。

**项目地址:** [diegaccio/Craft-CMS-Exploit](https://github.com/diegaccio/Craft-CMS-Exploit)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #5

**来源**: [CVE-2023-41892-user01-1_CVE-2023-41892_poc.md](../2023/CVE-2023-41892-user01-1_CVE-2023-41892_poc.md)

## CVE-2023-41892 Craft CMS 远程代码执行漏洞

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，可能导致完全控制服务器

**影响版本:** >= 4.0.0-RC1, <= 4.4.14

**利用条件:** 无需认证，目标服务器需存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个未经身份验证的远程代码执行漏洞。攻击者可以通过精心构造的请求，在目标服务器上执行任意代码。从提供的搜索引擎结果和漏洞库信息来看，该漏洞影响 Craft CMS 4.0.0-RC1 到 4.4.14 版本。漏洞利用代码包括两个 Python 脚本：poc_noauth.py 和 poc_auth.py。

*   **有效性：**
    *   `poc_noauth.py`：这个脚本利用未经身份验证的漏洞，直接执行操作系统命令。它首先通过 `conditions/render` action 获取 `upload_tmp_dir` 和 `DOCUMENT_ROOT`。然后，它上传一个包含 `system($_GET['cmd']);` 的 PHP webshell 到 `DOCUMENT_ROOT/cpresources/shell.php`。最后，攻击者可以通过访问 `shell.php?cmd=<命令>` 来执行任意命令，此PoC直接并且有效。
    *   `poc_auth.py`：这个脚本也利用了相同的漏洞，但增加了一个简单的基于密钥的身份验证层。攻击者需要提供正确的密钥才能执行命令。密钥的 SHA-256 哈希值硬编码在 webshell 中。攻击者需要先计算密钥的 SHA-256 哈希值，然后替换 webshell 代码中的 `YOUR_SECRET_KEY`。使用方法参考脚本内的说明。
*   **投毒风险：**
    *   分析提供的代码，没有发现作者植入恶意代码的迹象，如反向shell，木马程序，删除数据的操作。`poc_auth.py` 的 webshell 部分可以被认为是预期的漏洞利用行为，而不是恶意投毒行为。
    *   考虑到代码的简洁性和目的性（漏洞利用），以及双 PoC 的存在（一个无认证，一个简单认证），投毒的可能性较低。
    *   综合判断，投毒风险评估为0%。
*   **利用方式：**
    1.  **信息收集：** 使用`conditions/render` action和`\GuzzleHttp\Psr7\FnStream`类来获得`upload_tmp_dir` 和 `DOCUMENT_ROOT`的值。因为文档根目录和临时目录对于 webshell 的写入至关重要。
    2.  **上传 Webshell (NoAuth)：**  脚本将一个简单的 PHP webshell (`<?php system($_GET['cmd']); ?>`) 上传到目标服务器的 `DOCUMENT_ROOT/cpresources/shell.php` 路径下。
    3.  **上传 Webshell (Auth):** 脚本利用 `Imagick` 组件上传webshell, webshell 中包含一个密钥验证的逻辑，只有提供正确的密钥才能执行命令。
    4.  **触发 Imagick 组件 (Auth):** 使用 `Imagick` 组件激活webshell，具体函数是 `activate_imagick`。
    5.  **命令执行：**  通过访问 webshell 的 URL 并提供 `cmd` 参数，即可在服务器上执行任意命令 (NoAuth)。或者提供密钥与命令 (Auth)。例如，`{target}/cpresources/shell.php?cmd=id` 或 `{target}/cpresources/shell.php?k=(YOUR_KEY)&c=id`。

总的来说，该漏洞利用过程简单直接，利用成功后，攻击者可以完全控制受影响的 Craft CMS 服务器。

**项目地址:** [user01-1/CVE-2023-41892_poc](https://github.com/user01-1/CVE-2023-41892_poc)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #6

**来源**: [CVE-2023-41892-zaenhaxor_CVE-2023-41892.md](../2023/CVE-2023-41892-zaenhaxor_CVE-2023-41892.md)

## CVE-2023-41892 - Craft CMS 远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 4.0.0-RC1 <= version <= 4.4.14

**利用条件:** 目标Craft CMS实例版本在受影响范围内，且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个远程代码执行漏洞。根据漏洞信息和搜索引擎结果，这是一个高危漏洞，攻击复杂度低，无需身份验证即可利用。提供的POC脚本 (cve.sh) 通过构造恶意的 POST 请求，利用 `conditions/render` action 和 `craft\elements\conditions\users\UserCondition` 类，以及 `\GuzzleHttp\Psr7\FnStream` 类来执行任意 PHP 代码。脚本通过发送包含 `phpinfo()` 函数的payload来验证漏洞是否存在。如果响应中包含 'PHP Credits' 或 'PHP Group'，则认为目标存在漏洞。利用方式是构造特定的请求，触发 Craft CMS 中的代码注入点，从而执行攻击者控制的 PHP 代码。

**有效性：** 提供的POC代码有效，经验证可以执行任意PHP代码。

**投毒风险：** 脚本的功能明确，目的是检测漏洞并验证漏洞的存在。没有发现任何试图在目标系统上植入后门或执行其他恶意操作的迹象。脚本只是利用已知的RCE漏洞执行PHP代码，因此投毒风险为0%。

**利用方式：**
1.  攻击者构造恶意的POST请求，目标URL为`https://[target]/index.php`。
2.  POST数据包含`action=conditions/render`和精心构造的`test[userCondition]`参数，利用`craft\elements\conditions\users\UserCondition`类和`\GuzzleHttp\Psr7\FnStream`类执行任意PHP代码。
3.  POC脚本使用`phpinfo()`作为payload来验证漏洞，实际攻击中可以替换为任何PHP代码，例如执行系统命令。
4.  如果服务器返回包含`PHP Credits`或`PHP Group`的页面，则表明漏洞利用成功。

**项目地址:** [zaenhaxor/CVE-2023-41892](https://github.com/zaenhaxor/CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---



---

## POC #4

**来源**: [CVE-2023-41892-diegaccio_Craft-CMS-Exploit.md](../2023/CVE-2023-41892-diegaccio_Craft-CMS-Exploit.md)

## CVE-2023-41892-Craft CMS-远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行

**影响应用:** Craft CMS

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** >= 4.0.0-RC1, <= 4.4.14

**利用条件:** 目标Craft CMS版本在受影响范围内，且未打补丁，需要网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个远程代码执行漏洞。根据漏洞库信息和搜索引擎结果，该漏洞影响 Craft CMS 4.0.0-RC1 到 4.4.14 版本。攻击者可以通过发送特制的请求来利用此漏洞，在目标服务器上执行任意代码。\n\n**利用方式：**\n\n1.  **信息收集：** 首先，攻击者需要确定目标 Craft CMS 的版本是否在受影响范围内。\n2.  **上传临时文件：** 该漏洞利用链首先利用了 Imagick 组件处理图像时的MSL文件，在临时目录写入包含恶意PHP代码的文件。exploit.py脚本首先通过访问一个特殊的URL（触发phpinfo()）来获取`upload_tmp_dir`和`DOCUMENT_ROOT`。如果`upload_tmp_dir`不存在，则使用`/tmp`目录。\n3.  **写入webshell:** 之后，利用MSL文件将webshell写入`DOCUMENT_ROOT`目录下。\n4.  **代码执行：**  攻击者通过访问webshell文件,并携带`cmd`参数来执行任意的系统命令。该POC脚本使用base64编码命令，以绕过潜在的过滤。\n5.  **反弹shell：** POC代码中包含了反弹 shell 的功能，允许攻击者在成功利用漏洞后获得对目标系统的控制权。\n\n**投毒风险分析：**\n\n虽然提供的POC代码主要功能是利用漏洞实现远程代码执行，但是仍然存在一定的投毒风险。例如，攻击者可能会修改POC代码，在反弹 shell 之外执行其他恶意操作，例如安装后门、窃取敏感信息等。此外，POC代码本身依赖于未授权的远程代码执行，如果被滥用，可能对目标系统造成严重损害。经过代码分析，作者在代码中添加额外后门的可能性较低，主要风险在于代码本身被用于非法用途。 该`exploit.py`脚本没有明显的恶意代码，它的目的是利用已知的RCE漏洞。代码尝试找到临时上传目录和web根目录，然后上传一个PHP文件，该文件允许执行传递给它的命令。最后，它使用该文件来删除临时文件并反弹一个shell。尽管此代码本身没有恶意，但它的确会被用于恶意目的。因此，投毒风险较低，但存在误用的可能。

**项目地址:** [diegaccio/Craft-CMS-Exploit](https://github.com/diegaccio/Craft-CMS-Exploit)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #5

**来源**: [CVE-2023-41892-user01-1_CVE-2023-41892_poc.md](../2023/CVE-2023-41892-user01-1_CVE-2023-41892_poc.md)

## CVE-2023-41892 Craft CMS 远程代码执行漏洞

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，可能导致完全控制服务器

**影响版本:** >= 4.0.0-RC1, <= 4.4.14

**利用条件:** 无需认证，目标服务器需存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个未经身份验证的远程代码执行漏洞。攻击者可以通过精心构造的请求，在目标服务器上执行任意代码。从提供的搜索引擎结果和漏洞库信息来看，该漏洞影响 Craft CMS 4.0.0-RC1 到 4.4.14 版本。漏洞利用代码包括两个 Python 脚本：poc_noauth.py 和 poc_auth.py。

*   **有效性：**
    *   `poc_noauth.py`：这个脚本利用未经身份验证的漏洞，直接执行操作系统命令。它首先通过 `conditions/render` action 获取 `upload_tmp_dir` 和 `DOCUMENT_ROOT`。然后，它上传一个包含 `system($_GET['cmd']);` 的 PHP webshell 到 `DOCUMENT_ROOT/cpresources/shell.php`。最后，攻击者可以通过访问 `shell.php?cmd=<命令>` 来执行任意命令，此PoC直接并且有效。
    *   `poc_auth.py`：这个脚本也利用了相同的漏洞，但增加了一个简单的基于密钥的身份验证层。攻击者需要提供正确的密钥才能执行命令。密钥的 SHA-256 哈希值硬编码在 webshell 中。攻击者需要先计算密钥的 SHA-256 哈希值，然后替换 webshell 代码中的 `YOUR_SECRET_KEY`。使用方法参考脚本内的说明。
*   **投毒风险：**
    *   分析提供的代码，没有发现作者植入恶意代码的迹象，如反向shell，木马程序，删除数据的操作。`poc_auth.py` 的 webshell 部分可以被认为是预期的漏洞利用行为，而不是恶意投毒行为。
    *   考虑到代码的简洁性和目的性（漏洞利用），以及双 PoC 的存在（一个无认证，一个简单认证），投毒的可能性较低。
    *   综合判断，投毒风险评估为0%。
*   **利用方式：**
    1.  **信息收集：** 使用`conditions/render` action和`\GuzzleHttp\Psr7\FnStream`类来获得`upload_tmp_dir` 和 `DOCUMENT_ROOT`的值。因为文档根目录和临时目录对于 webshell 的写入至关重要。
    2.  **上传 Webshell (NoAuth)：**  脚本将一个简单的 PHP webshell (`<?php system($_GET['cmd']); ?>`) 上传到目标服务器的 `DOCUMENT_ROOT/cpresources/shell.php` 路径下。
    3.  **上传 Webshell (Auth):** 脚本利用 `Imagick` 组件上传webshell, webshell 中包含一个密钥验证的逻辑，只有提供正确的密钥才能执行命令。
    4.  **触发 Imagick 组件 (Auth):** 使用 `Imagick` 组件激活webshell，具体函数是 `activate_imagick`。
    5.  **命令执行：**  通过访问 webshell 的 URL 并提供 `cmd` 参数，即可在服务器上执行任意命令 (NoAuth)。或者提供密钥与命令 (Auth)。例如，`{target}/cpresources/shell.php?cmd=id` 或 `{target}/cpresources/shell.php?k=(YOUR_KEY)&c=id`。

总的来说，该漏洞利用过程简单直接，利用成功后，攻击者可以完全控制受影响的 Craft CMS 服务器。

**项目地址:** [user01-1/CVE-2023-41892_poc](https://github.com/user01-1/CVE-2023-41892_poc)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #6

**来源**: [CVE-2023-41892-zaenhaxor_CVE-2023-41892.md](../2023/CVE-2023-41892-zaenhaxor_CVE-2023-41892.md)

## CVE-2023-41892 - Craft CMS 远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 4.0.0-RC1 <= version <= 4.4.14

**利用条件:** 目标Craft CMS实例版本在受影响范围内，且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个远程代码执行漏洞。根据漏洞信息和搜索引擎结果，这是一个高危漏洞，攻击复杂度低，无需身份验证即可利用。提供的POC脚本 (cve.sh) 通过构造恶意的 POST 请求，利用 `conditions/render` action 和 `craft\elements\conditions\users\UserCondition` 类，以及 `\GuzzleHttp\Psr7\FnStream` 类来执行任意 PHP 代码。脚本通过发送包含 `phpinfo()` 函数的payload来验证漏洞是否存在。如果响应中包含 'PHP Credits' 或 'PHP Group'，则认为目标存在漏洞。利用方式是构造特定的请求，触发 Craft CMS 中的代码注入点，从而执行攻击者控制的 PHP 代码。

**有效性：** 提供的POC代码有效，经验证可以执行任意PHP代码。

**投毒风险：** 脚本的功能明确，目的是检测漏洞并验证漏洞的存在。没有发现任何试图在目标系统上植入后门或执行其他恶意操作的迹象。脚本只是利用已知的RCE漏洞执行PHP代码，因此投毒风险为0%。

**利用方式：**
1.  攻击者构造恶意的POST请求，目标URL为`https://[target]/index.php`。
2.  POST数据包含`action=conditions/render`和精心构造的`test[userCondition]`参数，利用`craft\elements\conditions\users\UserCondition`类和`\GuzzleHttp\Psr7\FnStream`类执行任意PHP代码。
3.  POC脚本使用`phpinfo()`作为payload来验证漏洞，实际攻击中可以替换为任何PHP代码，例如执行系统命令。
4.  如果服务器返回包含`PHP Credits`或`PHP Group`的页面，则表明漏洞利用成功。

**项目地址:** [zaenhaxor/CVE-2023-41892](https://github.com/zaenhaxor/CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---



---

## POC #4

**来源**: [CVE-2023-41892-diegaccio_Craft-CMS-Exploit.md](../2023/CVE-2023-41892-diegaccio_Craft-CMS-Exploit.md)

## CVE-2023-41892-Craft CMS-远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行

**影响应用:** Craft CMS

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** >= 4.0.0-RC1, <= 4.4.14

**利用条件:** 目标Craft CMS版本在受影响范围内，且未打补丁，需要网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个远程代码执行漏洞。根据漏洞库信息和搜索引擎结果，该漏洞影响 Craft CMS 4.0.0-RC1 到 4.4.14 版本。攻击者可以通过发送特制的请求来利用此漏洞，在目标服务器上执行任意代码。\n\n**利用方式：**\n\n1.  **信息收集：** 首先，攻击者需要确定目标 Craft CMS 的版本是否在受影响范围内。\n2.  **上传临时文件：** 该漏洞利用链首先利用了 Imagick 组件处理图像时的MSL文件，在临时目录写入包含恶意PHP代码的文件。exploit.py脚本首先通过访问一个特殊的URL（触发phpinfo()）来获取`upload_tmp_dir`和`DOCUMENT_ROOT`。如果`upload_tmp_dir`不存在，则使用`/tmp`目录。\n3.  **写入webshell:** 之后，利用MSL文件将webshell写入`DOCUMENT_ROOT`目录下。\n4.  **代码执行：**  攻击者通过访问webshell文件,并携带`cmd`参数来执行任意的系统命令。该POC脚本使用base64编码命令，以绕过潜在的过滤。\n5.  **反弹shell：** POC代码中包含了反弹 shell 的功能，允许攻击者在成功利用漏洞后获得对目标系统的控制权。\n\n**投毒风险分析：**\n\n虽然提供的POC代码主要功能是利用漏洞实现远程代码执行，但是仍然存在一定的投毒风险。例如，攻击者可能会修改POC代码，在反弹 shell 之外执行其他恶意操作，例如安装后门、窃取敏感信息等。此外，POC代码本身依赖于未授权的远程代码执行，如果被滥用，可能对目标系统造成严重损害。经过代码分析，作者在代码中添加额外后门的可能性较低，主要风险在于代码本身被用于非法用途。 该`exploit.py`脚本没有明显的恶意代码，它的目的是利用已知的RCE漏洞。代码尝试找到临时上传目录和web根目录，然后上传一个PHP文件，该文件允许执行传递给它的命令。最后，它使用该文件来删除临时文件并反弹一个shell。尽管此代码本身没有恶意，但它的确会被用于恶意目的。因此，投毒风险较低，但存在误用的可能。

**项目地址:** [diegaccio/Craft-CMS-Exploit](https://github.com/diegaccio/Craft-CMS-Exploit)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #5

**来源**: [CVE-2023-41892-user01-1_CVE-2023-41892_poc.md](../2023/CVE-2023-41892-user01-1_CVE-2023-41892_poc.md)

## CVE-2023-41892 Craft CMS 远程代码执行漏洞

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，可能导致完全控制服务器

**影响版本:** >= 4.0.0-RC1, <= 4.4.14

**利用条件:** 无需认证，目标服务器需存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个未经身份验证的远程代码执行漏洞。攻击者可以通过精心构造的请求，在目标服务器上执行任意代码。从提供的搜索引擎结果和漏洞库信息来看，该漏洞影响 Craft CMS 4.0.0-RC1 到 4.4.14 版本。漏洞利用代码包括两个 Python 脚本：poc_noauth.py 和 poc_auth.py。

*   **有效性：**
    *   `poc_noauth.py`：这个脚本利用未经身份验证的漏洞，直接执行操作系统命令。它首先通过 `conditions/render` action 获取 `upload_tmp_dir` 和 `DOCUMENT_ROOT`。然后，它上传一个包含 `system($_GET['cmd']);` 的 PHP webshell 到 `DOCUMENT_ROOT/cpresources/shell.php`。最后，攻击者可以通过访问 `shell.php?cmd=<命令>` 来执行任意命令，此PoC直接并且有效。
    *   `poc_auth.py`：这个脚本也利用了相同的漏洞，但增加了一个简单的基于密钥的身份验证层。攻击者需要提供正确的密钥才能执行命令。密钥的 SHA-256 哈希值硬编码在 webshell 中。攻击者需要先计算密钥的 SHA-256 哈希值，然后替换 webshell 代码中的 `YOUR_SECRET_KEY`。使用方法参考脚本内的说明。
*   **投毒风险：**
    *   分析提供的代码，没有发现作者植入恶意代码的迹象，如反向shell，木马程序，删除数据的操作。`poc_auth.py` 的 webshell 部分可以被认为是预期的漏洞利用行为，而不是恶意投毒行为。
    *   考虑到代码的简洁性和目的性（漏洞利用），以及双 PoC 的存在（一个无认证，一个简单认证），投毒的可能性较低。
    *   综合判断，投毒风险评估为0%。
*   **利用方式：**
    1.  **信息收集：** 使用`conditions/render` action和`\GuzzleHttp\Psr7\FnStream`类来获得`upload_tmp_dir` 和 `DOCUMENT_ROOT`的值。因为文档根目录和临时目录对于 webshell 的写入至关重要。
    2.  **上传 Webshell (NoAuth)：**  脚本将一个简单的 PHP webshell (`<?php system($_GET['cmd']); ?>`) 上传到目标服务器的 `DOCUMENT_ROOT/cpresources/shell.php` 路径下。
    3.  **上传 Webshell (Auth):** 脚本利用 `Imagick` 组件上传webshell, webshell 中包含一个密钥验证的逻辑，只有提供正确的密钥才能执行命令。
    4.  **触发 Imagick 组件 (Auth):** 使用 `Imagick` 组件激活webshell，具体函数是 `activate_imagick`。
    5.  **命令执行：**  通过访问 webshell 的 URL 并提供 `cmd` 参数，即可在服务器上执行任意命令 (NoAuth)。或者提供密钥与命令 (Auth)。例如，`{target}/cpresources/shell.php?cmd=id` 或 `{target}/cpresources/shell.php?k=(YOUR_KEY)&c=id`。

总的来说，该漏洞利用过程简单直接，利用成功后，攻击者可以完全控制受影响的 Craft CMS 服务器。

**项目地址:** [user01-1/CVE-2023-41892_poc](https://github.com/user01-1/CVE-2023-41892_poc)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #6

**来源**: [CVE-2023-41892-zaenhaxor_CVE-2023-41892.md](../2023/CVE-2023-41892-zaenhaxor_CVE-2023-41892.md)

## CVE-2023-41892 - Craft CMS 远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 4.0.0-RC1 <= version <= 4.4.14

**利用条件:** 目标Craft CMS实例版本在受影响范围内，且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个远程代码执行漏洞。根据漏洞信息和搜索引擎结果，这是一个高危漏洞，攻击复杂度低，无需身份验证即可利用。提供的POC脚本 (cve.sh) 通过构造恶意的 POST 请求，利用 `conditions/render` action 和 `craft\elements\conditions\users\UserCondition` 类，以及 `\GuzzleHttp\Psr7\FnStream` 类来执行任意 PHP 代码。脚本通过发送包含 `phpinfo()` 函数的payload来验证漏洞是否存在。如果响应中包含 'PHP Credits' 或 'PHP Group'，则认为目标存在漏洞。利用方式是构造特定的请求，触发 Craft CMS 中的代码注入点，从而执行攻击者控制的 PHP 代码。

**有效性：** 提供的POC代码有效，经验证可以执行任意PHP代码。

**投毒风险：** 脚本的功能明确，目的是检测漏洞并验证漏洞的存在。没有发现任何试图在目标系统上植入后门或执行其他恶意操作的迹象。脚本只是利用已知的RCE漏洞执行PHP代码，因此投毒风险为0%。

**利用方式：**
1.  攻击者构造恶意的POST请求，目标URL为`https://[target]/index.php`。
2.  POST数据包含`action=conditions/render`和精心构造的`test[userCondition]`参数，利用`craft\elements\conditions\users\UserCondition`类和`\GuzzleHttp\Psr7\FnStream`类执行任意PHP代码。
3.  POC脚本使用`phpinfo()`作为payload来验证漏洞，实际攻击中可以替换为任何PHP代码，例如执行系统命令。
4.  如果服务器返回包含`PHP Credits`或`PHP Group`的页面，则表明漏洞利用成功。

**项目地址:** [zaenhaxor/CVE-2023-41892](https://github.com/zaenhaxor/CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---



---

## POC #4

**来源**: [CVE-2023-41892-diegaccio_Craft-CMS-Exploit.md](../2023/CVE-2023-41892-diegaccio_Craft-CMS-Exploit.md)

## CVE-2023-41892-Craft CMS-远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行

**影响应用:** Craft CMS

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** >= 4.0.0-RC1, <= 4.4.14

**利用条件:** 目标Craft CMS版本在受影响范围内，且未打补丁，需要网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个远程代码执行漏洞。根据漏洞库信息和搜索引擎结果，该漏洞影响 Craft CMS 4.0.0-RC1 到 4.4.14 版本。攻击者可以通过发送特制的请求来利用此漏洞，在目标服务器上执行任意代码。\n\n**利用方式：**\n\n1.  **信息收集：** 首先，攻击者需要确定目标 Craft CMS 的版本是否在受影响范围内。\n2.  **上传临时文件：** 该漏洞利用链首先利用了 Imagick 组件处理图像时的MSL文件，在临时目录写入包含恶意PHP代码的文件。exploit.py脚本首先通过访问一个特殊的URL（触发phpinfo()）来获取`upload_tmp_dir`和`DOCUMENT_ROOT`。如果`upload_tmp_dir`不存在，则使用`/tmp`目录。\n3.  **写入webshell:** 之后，利用MSL文件将webshell写入`DOCUMENT_ROOT`目录下。\n4.  **代码执行：**  攻击者通过访问webshell文件,并携带`cmd`参数来执行任意的系统命令。该POC脚本使用base64编码命令，以绕过潜在的过滤。\n5.  **反弹shell：** POC代码中包含了反弹 shell 的功能，允许攻击者在成功利用漏洞后获得对目标系统的控制权。\n\n**投毒风险分析：**\n\n虽然提供的POC代码主要功能是利用漏洞实现远程代码执行，但是仍然存在一定的投毒风险。例如，攻击者可能会修改POC代码，在反弹 shell 之外执行其他恶意操作，例如安装后门、窃取敏感信息等。此外，POC代码本身依赖于未授权的远程代码执行，如果被滥用，可能对目标系统造成严重损害。经过代码分析，作者在代码中添加额外后门的可能性较低，主要风险在于代码本身被用于非法用途。 该`exploit.py`脚本没有明显的恶意代码，它的目的是利用已知的RCE漏洞。代码尝试找到临时上传目录和web根目录，然后上传一个PHP文件，该文件允许执行传递给它的命令。最后，它使用该文件来删除临时文件并反弹一个shell。尽管此代码本身没有恶意，但它的确会被用于恶意目的。因此，投毒风险较低，但存在误用的可能。

**项目地址:** [diegaccio/Craft-CMS-Exploit](https://github.com/diegaccio/Craft-CMS-Exploit)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #5

**来源**: [CVE-2023-41892-user01-1_CVE-2023-41892_poc.md](../2023/CVE-2023-41892-user01-1_CVE-2023-41892_poc.md)

## CVE-2023-41892 Craft CMS 远程代码执行漏洞

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，可能导致完全控制服务器

**影响版本:** >= 4.0.0-RC1, <= 4.4.14

**利用条件:** 无需认证，目标服务器需存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个未经身份验证的远程代码执行漏洞。攻击者可以通过精心构造的请求，在目标服务器上执行任意代码。从提供的搜索引擎结果和漏洞库信息来看，该漏洞影响 Craft CMS 4.0.0-RC1 到 4.4.14 版本。漏洞利用代码包括两个 Python 脚本：poc_noauth.py 和 poc_auth.py。

*   **有效性：**
    *   `poc_noauth.py`：这个脚本利用未经身份验证的漏洞，直接执行操作系统命令。它首先通过 `conditions/render` action 获取 `upload_tmp_dir` 和 `DOCUMENT_ROOT`。然后，它上传一个包含 `system($_GET['cmd']);` 的 PHP webshell 到 `DOCUMENT_ROOT/cpresources/shell.php`。最后，攻击者可以通过访问 `shell.php?cmd=<命令>` 来执行任意命令，此PoC直接并且有效。
    *   `poc_auth.py`：这个脚本也利用了相同的漏洞，但增加了一个简单的基于密钥的身份验证层。攻击者需要提供正确的密钥才能执行命令。密钥的 SHA-256 哈希值硬编码在 webshell 中。攻击者需要先计算密钥的 SHA-256 哈希值，然后替换 webshell 代码中的 `YOUR_SECRET_KEY`。使用方法参考脚本内的说明。
*   **投毒风险：**
    *   分析提供的代码，没有发现作者植入恶意代码的迹象，如反向shell，木马程序，删除数据的操作。`poc_auth.py` 的 webshell 部分可以被认为是预期的漏洞利用行为，而不是恶意投毒行为。
    *   考虑到代码的简洁性和目的性（漏洞利用），以及双 PoC 的存在（一个无认证，一个简单认证），投毒的可能性较低。
    *   综合判断，投毒风险评估为0%。
*   **利用方式：**
    1.  **信息收集：** 使用`conditions/render` action和`\GuzzleHttp\Psr7\FnStream`类来获得`upload_tmp_dir` 和 `DOCUMENT_ROOT`的值。因为文档根目录和临时目录对于 webshell 的写入至关重要。
    2.  **上传 Webshell (NoAuth)：**  脚本将一个简单的 PHP webshell (`<?php system($_GET['cmd']); ?>`) 上传到目标服务器的 `DOCUMENT_ROOT/cpresources/shell.php` 路径下。
    3.  **上传 Webshell (Auth):** 脚本利用 `Imagick` 组件上传webshell, webshell 中包含一个密钥验证的逻辑，只有提供正确的密钥才能执行命令。
    4.  **触发 Imagick 组件 (Auth):** 使用 `Imagick` 组件激活webshell，具体函数是 `activate_imagick`。
    5.  **命令执行：**  通过访问 webshell 的 URL 并提供 `cmd` 参数，即可在服务器上执行任意命令 (NoAuth)。或者提供密钥与命令 (Auth)。例如，`{target}/cpresources/shell.php?cmd=id` 或 `{target}/cpresources/shell.php?k=(YOUR_KEY)&c=id`。

总的来说，该漏洞利用过程简单直接，利用成功后，攻击者可以完全控制受影响的 Craft CMS 服务器。

**项目地址:** [user01-1/CVE-2023-41892_poc](https://github.com/user01-1/CVE-2023-41892_poc)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #6

**来源**: [CVE-2023-41892-zaenhaxor_CVE-2023-41892.md](../2023/CVE-2023-41892-zaenhaxor_CVE-2023-41892.md)

## CVE-2023-41892 - Craft CMS 远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 4.0.0-RC1 <= version <= 4.4.14

**利用条件:** 目标Craft CMS实例版本在受影响范围内，且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个远程代码执行漏洞。根据漏洞信息和搜索引擎结果，这是一个高危漏洞，攻击复杂度低，无需身份验证即可利用。提供的POC脚本 (cve.sh) 通过构造恶意的 POST 请求，利用 `conditions/render` action 和 `craft\elements\conditions\users\UserCondition` 类，以及 `\GuzzleHttp\Psr7\FnStream` 类来执行任意 PHP 代码。脚本通过发送包含 `phpinfo()` 函数的payload来验证漏洞是否存在。如果响应中包含 'PHP Credits' 或 'PHP Group'，则认为目标存在漏洞。利用方式是构造特定的请求，触发 Craft CMS 中的代码注入点，从而执行攻击者控制的 PHP 代码。

**有效性：** 提供的POC代码有效，经验证可以执行任意PHP代码。

**投毒风险：** 脚本的功能明确，目的是检测漏洞并验证漏洞的存在。没有发现任何试图在目标系统上植入后门或执行其他恶意操作的迹象。脚本只是利用已知的RCE漏洞执行PHP代码，因此投毒风险为0%。

**利用方式：**
1.  攻击者构造恶意的POST请求，目标URL为`https://[target]/index.php`。
2.  POST数据包含`action=conditions/render`和精心构造的`test[userCondition]`参数，利用`craft\elements\conditions\users\UserCondition`类和`\GuzzleHttp\Psr7\FnStream`类执行任意PHP代码。
3.  POC脚本使用`phpinfo()`作为payload来验证漏洞，实际攻击中可以替换为任何PHP代码，例如执行系统命令。
4.  如果服务器返回包含`PHP Credits`或`PHP Group`的页面，则表明漏洞利用成功。

**项目地址:** [zaenhaxor/CVE-2023-41892](https://github.com/zaenhaxor/CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---



---

## POC #4

**来源**: [CVE-2023-41892-diegaccio_Craft-CMS-Exploit.md](../2023/CVE-2023-41892-diegaccio_Craft-CMS-Exploit.md)

## CVE-2023-41892-Craft CMS-远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行

**影响应用:** Craft CMS

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** >= 4.0.0-RC1, <= 4.4.14

**利用条件:** 目标Craft CMS版本在受影响范围内，且未打补丁，需要网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个远程代码执行漏洞。根据漏洞库信息和搜索引擎结果，该漏洞影响 Craft CMS 4.0.0-RC1 到 4.4.14 版本。攻击者可以通过发送特制的请求来利用此漏洞，在目标服务器上执行任意代码。\n\n**利用方式：**\n\n1.  **信息收集：** 首先，攻击者需要确定目标 Craft CMS 的版本是否在受影响范围内。\n2.  **上传临时文件：** 该漏洞利用链首先利用了 Imagick 组件处理图像时的MSL文件，在临时目录写入包含恶意PHP代码的文件。exploit.py脚本首先通过访问一个特殊的URL（触发phpinfo()）来获取`upload_tmp_dir`和`DOCUMENT_ROOT`。如果`upload_tmp_dir`不存在，则使用`/tmp`目录。\n3.  **写入webshell:** 之后，利用MSL文件将webshell写入`DOCUMENT_ROOT`目录下。\n4.  **代码执行：**  攻击者通过访问webshell文件,并携带`cmd`参数来执行任意的系统命令。该POC脚本使用base64编码命令，以绕过潜在的过滤。\n5.  **反弹shell：** POC代码中包含了反弹 shell 的功能，允许攻击者在成功利用漏洞后获得对目标系统的控制权。\n\n**投毒风险分析：**\n\n虽然提供的POC代码主要功能是利用漏洞实现远程代码执行，但是仍然存在一定的投毒风险。例如，攻击者可能会修改POC代码，在反弹 shell 之外执行其他恶意操作，例如安装后门、窃取敏感信息等。此外，POC代码本身依赖于未授权的远程代码执行，如果被滥用，可能对目标系统造成严重损害。经过代码分析，作者在代码中添加额外后门的可能性较低，主要风险在于代码本身被用于非法用途。 该`exploit.py`脚本没有明显的恶意代码，它的目的是利用已知的RCE漏洞。代码尝试找到临时上传目录和web根目录，然后上传一个PHP文件，该文件允许执行传递给它的命令。最后，它使用该文件来删除临时文件并反弹一个shell。尽管此代码本身没有恶意，但它的确会被用于恶意目的。因此，投毒风险较低，但存在误用的可能。

**项目地址:** [diegaccio/Craft-CMS-Exploit](https://github.com/diegaccio/Craft-CMS-Exploit)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #5

**来源**: [CVE-2023-41892-user01-1_CVE-2023-41892_poc.md](../2023/CVE-2023-41892-user01-1_CVE-2023-41892_poc.md)

## CVE-2023-41892 Craft CMS 远程代码执行漏洞

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，可能导致完全控制服务器

**影响版本:** >= 4.0.0-RC1, <= 4.4.14

**利用条件:** 无需认证，目标服务器需存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个未经身份验证的远程代码执行漏洞。攻击者可以通过精心构造的请求，在目标服务器上执行任意代码。从提供的搜索引擎结果和漏洞库信息来看，该漏洞影响 Craft CMS 4.0.0-RC1 到 4.4.14 版本。漏洞利用代码包括两个 Python 脚本：poc_noauth.py 和 poc_auth.py。

*   **有效性：**
    *   `poc_noauth.py`：这个脚本利用未经身份验证的漏洞，直接执行操作系统命令。它首先通过 `conditions/render` action 获取 `upload_tmp_dir` 和 `DOCUMENT_ROOT`。然后，它上传一个包含 `system($_GET['cmd']);` 的 PHP webshell 到 `DOCUMENT_ROOT/cpresources/shell.php`。最后，攻击者可以通过访问 `shell.php?cmd=<命令>` 来执行任意命令，此PoC直接并且有效。
    *   `poc_auth.py`：这个脚本也利用了相同的漏洞，但增加了一个简单的基于密钥的身份验证层。攻击者需要提供正确的密钥才能执行命令。密钥的 SHA-256 哈希值硬编码在 webshell 中。攻击者需要先计算密钥的 SHA-256 哈希值，然后替换 webshell 代码中的 `YOUR_SECRET_KEY`。使用方法参考脚本内的说明。
*   **投毒风险：**
    *   分析提供的代码，没有发现作者植入恶意代码的迹象，如反向shell，木马程序，删除数据的操作。`poc_auth.py` 的 webshell 部分可以被认为是预期的漏洞利用行为，而不是恶意投毒行为。
    *   考虑到代码的简洁性和目的性（漏洞利用），以及双 PoC 的存在（一个无认证，一个简单认证），投毒的可能性较低。
    *   综合判断，投毒风险评估为0%。
*   **利用方式：**
    1.  **信息收集：** 使用`conditions/render` action和`\GuzzleHttp\Psr7\FnStream`类来获得`upload_tmp_dir` 和 `DOCUMENT_ROOT`的值。因为文档根目录和临时目录对于 webshell 的写入至关重要。
    2.  **上传 Webshell (NoAuth)：**  脚本将一个简单的 PHP webshell (`<?php system($_GET['cmd']); ?>`) 上传到目标服务器的 `DOCUMENT_ROOT/cpresources/shell.php` 路径下。
    3.  **上传 Webshell (Auth):** 脚本利用 `Imagick` 组件上传webshell, webshell 中包含一个密钥验证的逻辑，只有提供正确的密钥才能执行命令。
    4.  **触发 Imagick 组件 (Auth):** 使用 `Imagick` 组件激活webshell，具体函数是 `activate_imagick`。
    5.  **命令执行：**  通过访问 webshell 的 URL 并提供 `cmd` 参数，即可在服务器上执行任意命令 (NoAuth)。或者提供密钥与命令 (Auth)。例如，`{target}/cpresources/shell.php?cmd=id` 或 `{target}/cpresources/shell.php?k=(YOUR_KEY)&c=id`。

总的来说，该漏洞利用过程简单直接，利用成功后，攻击者可以完全控制受影响的 Craft CMS 服务器。

**项目地址:** [user01-1/CVE-2023-41892_poc](https://github.com/user01-1/CVE-2023-41892_poc)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

## POC #6

**来源**: [CVE-2023-41892-zaenhaxor_CVE-2023-41892.md](../2023/CVE-2023-41892-zaenhaxor_CVE-2023-41892.md)

## CVE-2023-41892 - Craft CMS 远程代码执行

**漏洞编号:** CVE-2023-41892

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Craft CMS

**危害等级:** 严重，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 4.0.0-RC1 <= version <= 4.4.14

**利用条件:** 目标Craft CMS实例版本在受影响范围内，且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-41892 存在于 Craft CMS 中，是一个远程代码执行漏洞。根据漏洞信息和搜索引擎结果，这是一个高危漏洞，攻击复杂度低，无需身份验证即可利用。提供的POC脚本 (cve.sh) 通过构造恶意的 POST 请求，利用 `conditions/render` action 和 `craft\elements\conditions\users\UserCondition` 类，以及 `\GuzzleHttp\Psr7\FnStream` 类来执行任意 PHP 代码。脚本通过发送包含 `phpinfo()` 函数的payload来验证漏洞是否存在。如果响应中包含 'PHP Credits' 或 'PHP Group'，则认为目标存在漏洞。利用方式是构造特定的请求，触发 Craft CMS 中的代码注入点，从而执行攻击者控制的 PHP 代码。

**有效性：** 提供的POC代码有效，经验证可以执行任意PHP代码。

**投毒风险：** 脚本的功能明确，目的是检测漏洞并验证漏洞的存在。没有发现任何试图在目标系统上植入后门或执行其他恶意操作的迹象。脚本只是利用已知的RCE漏洞执行PHP代码，因此投毒风险为0%。

**利用方式：**
1.  攻击者构造恶意的POST请求，目标URL为`https://[target]/index.php`。
2.  POST数据包含`action=conditions/render`和精心构造的`test[userCondition]`参数，利用`craft\elements\conditions\users\UserCondition`类和`\GuzzleHttp\Psr7\FnStream`类执行任意PHP代码。
3.  POC脚本使用`phpinfo()`作为payload来验证漏洞，实际攻击中可以替换为任何PHP代码，例如执行系统命令。
4.  如果服务器返回包含`PHP Credits`或`PHP Group`的页面，则表明漏洞利用成功。

**项目地址:** [zaenhaxor/CVE-2023-41892](https://github.com/zaenhaxor/CVE-2023-41892)

**漏洞详情:** [CVE-2023-41892](https://nvd.nist.gov/vuln/detail/CVE-2023-41892)

---

