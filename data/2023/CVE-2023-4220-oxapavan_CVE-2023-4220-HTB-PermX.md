## CVE-2023-4220 - Chamilo LMS 任意文件上传 (Unrestricted File Upload)

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 任意文件上传 (Unrestricted File Upload)

**影响应用:** Chamilo LMS

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** <= v1.11.24

**利用条件:** 无需身份验证，远程网络可访问目标服务器，且bigupload组件未禁用。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

【POC有效性分析】：此POC代码针对Chamilo LMS中的bigupload组件漏洞。该漏洞源于/main/inc/lib/javascript/bigupload/inc/bigUpload.php文件在处理大文件上传请求时，未对上传文件的扩展名或内容进行严格校验。分析提供的脚本发现，POC采用参数化设计，允许用户指定上传文件（-f）、目标主机（-h）及反弹端口（-p）。代码逻辑清晰，首先通过HTTP POST请求将恶意脚本（通常是PHP Webshell或反弹Shell）上传至受影响的目录/main/inc/lib/javascript/bigupload/files/，随后通过直接访问上传后的路径来触发代码执行。由于该漏洞不需要任何登录凭证即可利用，且上传路径固定，POC的有效性和自动化利用程度极高。利用步骤如下：1. 攻击者准备一个包含恶意代码的PHP文件；2. 使用Bash脚本向目标服务器的bigUpload.php端点发送该文件；3. 脚本会自动计算或直接请求位于/files/目录下的对应文件；4. 服务器解析并执行PHP代码，攻击者获取系统控制权。此POC完整实现了从上传到触发的全过程，对于防御方评估风险具有极高的参考价值。【投毒风险分析】：该POC代码的投毒风险被评估为低（10%）。经过对提供的Bash脚本源代码进行审计，脚本使用了标准的ANSI颜色代码进行输出美化，采用getopts处理命令行参数，主要逻辑依赖于标准的curl工具进行HTTP交互。代码中没有发现经过Base64加密、混淆的字符串，也没有发现任何尝试修改本地系统敏感文件、窃取环境变量或向非目标服务器发送数据的后门逻辑。脚本声明了其用于教育和授权研究目的，符合安全研究工具的规范。唯一需要注意的是，用户在使用此类脚本时，应确保从受信任的源下载，以防止第三方在脚本中插入额外的恶意命令（如rm -rf / 或反向Shell到第三方服务器）。目前该样本表现为纯净的漏洞验证工具，逻辑透明，不存在针对研究者机器的恶意行为。

**项目地址:** [https://github.com/m3m0o/Chamilo-LMS-CVE-2023-4220-Exploit](https://www.google.com/search?q=https://github.com/m3m0o/Chamilo-LMS-CVE-2023-4220-Exploit)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)
