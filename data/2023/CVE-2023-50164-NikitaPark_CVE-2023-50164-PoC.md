# CVE-2023-50164

> 📦 该CVE有 **15** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-50164-AsfandAliMemon25_CVE-2023-50164Analysis-.md](../2023/CVE-2023-50164-AsfandAliMemon25_CVE-2023-50164Analysis-.md)

## CVE-2023-50164-Apache Struts 文件上传路径遍历与RCE

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 文件上传路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** 2.0.0 <= version <= 2.5.32, 6.0.0 <= version <= 6.3.0.1

**利用条件:** 需要能够上传文件的入口点，通常是文件上传功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 是 Apache Struts 2 中的一个严重漏洞，源于文件上传组件存在目录遍历缺陷。攻击者可以操纵文件上传参数，实现路径遍历，从而上传恶意文件。在特定情况下，这可能导致远程代码执行。 

**漏洞利用方式：**

1.  **路径遍历：** 攻击者修改文件上传请求中的文件名参数，使其包含目录遍历序列（如 `../`），从而绕过文件上传的限制，将文件上传到服务器的任意位置。
2.  **恶意文件上传：** 攻击者上传包含恶意代码的文件，例如 JSP webshell 或其他可执行文件。
3.  **远程代码执行：** 如果恶意文件上传到Web服务器的可执行目录下，攻击者可以通过访问该文件来执行其中的代码，从而控制服务器。

**POC有效性：**

根据提供的漏洞库信息和搜索结果，CVE-2023-50164是一个已公开的严重漏洞，存在公开的PoC利用代码。提供的POC代码包含Dockerfile，README.md，Maven Wrapper脚本和示例Struts应用程序，用于搭建一个易受攻击的环境，并且提供了python脚本可以利用该漏洞进行攻击，因此判断提供的POC代码有效。

**投毒风险分析：**

检查提供的文件内容，主要关注以下几个方面：

*   **Dockerfile:** 用于构建包含漏洞 Struts 应用程序的 Docker 镜像，其本身并无恶意行为。
*   **README.md:** 提供了如何构建和运行易受攻击的应用程序以及如何使用提供的 PoC 脚本的说明。
*   **struts-app:** 该应用程序包含了漏洞，是漏洞利用的基础，不是投毒。
*   **exploit.py:** 该脚本的目的是利用漏洞，执行文件上传路径遍历，上传webshell，进行RCE。

考虑到POC的目的是为了重现和利用漏洞，其中可能包含webshell上传等操作，这本身不是“投毒”，而是漏洞利用的必要步骤。但是仍需要人工审查该脚本，检查是否存在超出漏洞利用范围的恶意代码，例如反向shell等。考虑到作者在README中提及“This exploit script has been created for the purposes of research. It is not intended to be used for any malicious or unauthorized activities.” 以及“Its recommended to run the application and exploit on Windows host. The exploit may not work on *nix based system sometimes.”，因此可以推测代码可能存在一些限制条件或者本身兼容性不是很好，增加了分析难度。综合判断投毒风险为10%。

**项目地址:** [AsfandAliMemon25/CVE-2023-50164Analysis-](https://github.com/AsfandAliMemon25/CVE-2023-50164Analysis-)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #2

**来源**: [CVE-2023-50164-MKIRAHMET_CVE-2023-50164-HTB-strutted.md](../2023/CVE-2023-50164-MKIRAHMET_CVE-2023-50164-HTB-strutted.md)

## CVE-2023-50164: Apache Struts 文件上传路径遍历导致远程代码执行

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 文件上传路径遍历导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，允许攻击者上传恶意文件并执行任意代码

**影响版本:** 2.0.0 <= Struts <= 2.5.32, 6.0.0 <= Struts <= 6.3.0.1

**利用条件:** 需要应用存在文件上传功能，且未对上传路径进行严格校验

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 存在于 Apache Struts 的文件上传组件中。攻击者可以通过操纵文件上传参数，实现路径遍历，进而上传恶意文件。根据POC，该漏洞的利用方式是上传一个 WAR webshell 到 Tomcat 服务器。

**有效性：**
根据漏洞库信息、搜索结果以及提供的POC代码，该漏洞是有效的，并且存在公开的POC。

**投毒风险：**
POC 代码包含一个 `Vagrantfile`，用于创建一个虚拟机环境来复现漏洞。 exploit.py 脚本用于上传webshell。 检查了 exploit.py（未提供，因此只能根据README推断），Vagrantfile 和 README.md 没有发现明显的恶意代码。投毒风险较低，但仍需谨慎，因为攻击者可能通过其他方式（例如修改依赖）引入恶意代码。

**利用方式：**
1.  攻击者构造包含恶意路径的文件上传请求。
2.  Struts 应用未能正确验证上传路径，允许攻击者将文件上传到任意位置。
3.  攻击者上传包含恶意代码的 WAR 文件 (webshell) 到 Tomcat 的 webapps 目录。
4.  Tomcat 部署该 WAR 文件，攻击者可以通过访问 webshell 执行任意代码。

**搜索引擎结果说明:** 众多安全厂商博客和漏洞库记录显示该漏洞存在且利用方法已经公开。

**项目地址:** [MKIRAHMET/CVE-2023-50164-HTB-strutted](https://github.com/MKIRAHMET/CVE-2023-50164-HTB-strutted)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #3

**来源**: [CVE-2023-50164-NikitaPark_CVE-2023-50164-PoC.md](../2023/CVE-2023-50164-NikitaPark_CVE-2023-50164-PoC.md)

# CVE-2023-50164

> 📦 该CVE有 **15** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-50164-AsfandAliMemon25_CVE-2023-50164Analysis-.md](../2023/CVE-2023-50164-AsfandAliMemon25_CVE-2023-50164Analysis-.md)

## CVE-2023-50164-Apache Struts 文件上传路径遍历与RCE

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 文件上传路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** 2.0.0 <= version <= 2.5.32, 6.0.0 <= version <= 6.3.0.1

**利用条件:** 需要能够上传文件的入口点，通常是文件上传功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 是 Apache Struts 2 中的一个严重漏洞，源于文件上传组件存在目录遍历缺陷。攻击者可以操纵文件上传参数，实现路径遍历，从而上传恶意文件。在特定情况下，这可能导致远程代码执行。 

**漏洞利用方式：**

1.  **路径遍历：** 攻击者修改文件上传请求中的文件名参数，使其包含目录遍历序列（如 `../`），从而绕过文件上传的限制，将文件上传到服务器的任意位置。
2.  **恶意文件上传：** 攻击者上传包含恶意代码的文件，例如 JSP webshell 或其他可执行文件。
3.  **远程代码执行：** 如果恶意文件上传到Web服务器的可执行目录下，攻击者可以通过访问该文件来执行其中的代码，从而控制服务器。

**POC有效性：**

根据提供的漏洞库信息和搜索结果，CVE-2023-50164是一个已公开的严重漏洞，存在公开的PoC利用代码。提供的POC代码包含Dockerfile，README.md，Maven Wrapper脚本和示例Struts应用程序，用于搭建一个易受攻击的环境，并且提供了python脚本可以利用该漏洞进行攻击，因此判断提供的POC代码有效。

**投毒风险分析：**

检查提供的文件内容，主要关注以下几个方面：

*   **Dockerfile:** 用于构建包含漏洞 Struts 应用程序的 Docker 镜像，其本身并无恶意行为。
*   **README.md:** 提供了如何构建和运行易受攻击的应用程序以及如何使用提供的 PoC 脚本的说明。
*   **struts-app:** 该应用程序包含了漏洞，是漏洞利用的基础，不是投毒。
*   **exploit.py:** 该脚本的目的是利用漏洞，执行文件上传路径遍历，上传webshell，进行RCE。

考虑到POC的目的是为了重现和利用漏洞，其中可能包含webshell上传等操作，这本身不是“投毒”，而是漏洞利用的必要步骤。但是仍需要人工审查该脚本，检查是否存在超出漏洞利用范围的恶意代码，例如反向shell等。考虑到作者在README中提及“This exploit script has been created for the purposes of research. It is not intended to be used for any malicious or unauthorized activities.” 以及“Its recommended to run the application and exploit on Windows host. The exploit may not work on *nix based system sometimes.”，因此可以推测代码可能存在一些限制条件或者本身兼容性不是很好，增加了分析难度。综合判断投毒风险为10%。

**项目地址:** [AsfandAliMemon25/CVE-2023-50164Analysis-](https://github.com/AsfandAliMemon25/CVE-2023-50164Analysis-)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #2

**来源**: [CVE-2023-50164-MKIRAHMET_CVE-2023-50164-HTB-strutted.md](../2023/CVE-2023-50164-MKIRAHMET_CVE-2023-50164-HTB-strutted.md)

## CVE-2023-50164: Apache Struts 文件上传路径遍历导致远程代码执行

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 文件上传路径遍历导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，允许攻击者上传恶意文件并执行任意代码

**影响版本:** 2.0.0 <= Struts <= 2.5.32, 6.0.0 <= Struts <= 6.3.0.1

**利用条件:** 需要应用存在文件上传功能，且未对上传路径进行严格校验

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 存在于 Apache Struts 的文件上传组件中。攻击者可以通过操纵文件上传参数，实现路径遍历，进而上传恶意文件。根据POC，该漏洞的利用方式是上传一个 WAR webshell 到 Tomcat 服务器。

**有效性：**
根据漏洞库信息、搜索结果以及提供的POC代码，该漏洞是有效的，并且存在公开的POC。

**投毒风险：**
POC 代码包含一个 `Vagrantfile`，用于创建一个虚拟机环境来复现漏洞。 exploit.py 脚本用于上传webshell。 检查了 exploit.py（未提供，因此只能根据README推断），Vagrantfile 和 README.md 没有发现明显的恶意代码。投毒风险较低，但仍需谨慎，因为攻击者可能通过其他方式（例如修改依赖）引入恶意代码。

**利用方式：**
1.  攻击者构造包含恶意路径的文件上传请求。
2.  Struts 应用未能正确验证上传路径，允许攻击者将文件上传到任意位置。
3.  攻击者上传包含恶意代码的 WAR 文件 (webshell) 到 Tomcat 的 webapps 目录。
4.  Tomcat 部署该 WAR 文件，攻击者可以通过访问 webshell 执行任意代码。

**搜索引擎结果说明:** 众多安全厂商博客和漏洞库记录显示该漏洞存在且利用方法已经公开。

**项目地址:** [MKIRAHMET/CVE-2023-50164-HTB-strutted](https://github.com/MKIRAHMET/CVE-2023-50164-HTB-strutted)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #3

**来源**: [CVE-2023-50164-NikitaPark_CVE-2023-50164-PoC.md](../2023/CVE-2023-50164-NikitaPark_CVE-2023-50164-PoC.md)

# CVE-2023-50164

> 📦 该CVE有 **15** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-50164-AsfandAliMemon25_CVE-2023-50164Analysis-.md](../2023/CVE-2023-50164-AsfandAliMemon25_CVE-2023-50164Analysis-.md)

## CVE-2023-50164-Apache Struts 文件上传路径遍历与RCE

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 文件上传路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** 2.0.0 <= version <= 2.5.32, 6.0.0 <= version <= 6.3.0.1

**利用条件:** 需要能够上传文件的入口点，通常是文件上传功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 是 Apache Struts 2 中的一个严重漏洞，源于文件上传组件存在目录遍历缺陷。攻击者可以操纵文件上传参数，实现路径遍历，从而上传恶意文件。在特定情况下，这可能导致远程代码执行。 

**漏洞利用方式：**

1.  **路径遍历：** 攻击者修改文件上传请求中的文件名参数，使其包含目录遍历序列（如 `../`），从而绕过文件上传的限制，将文件上传到服务器的任意位置。
2.  **恶意文件上传：** 攻击者上传包含恶意代码的文件，例如 JSP webshell 或其他可执行文件。
3.  **远程代码执行：** 如果恶意文件上传到Web服务器的可执行目录下，攻击者可以通过访问该文件来执行其中的代码，从而控制服务器。

**POC有效性：**

根据提供的漏洞库信息和搜索结果，CVE-2023-50164是一个已公开的严重漏洞，存在公开的PoC利用代码。提供的POC代码包含Dockerfile，README.md，Maven Wrapper脚本和示例Struts应用程序，用于搭建一个易受攻击的环境，并且提供了python脚本可以利用该漏洞进行攻击，因此判断提供的POC代码有效。

**投毒风险分析：**

检查提供的文件内容，主要关注以下几个方面：

*   **Dockerfile:** 用于构建包含漏洞 Struts 应用程序的 Docker 镜像，其本身并无恶意行为。
*   **README.md:** 提供了如何构建和运行易受攻击的应用程序以及如何使用提供的 PoC 脚本的说明。
*   **struts-app:** 该应用程序包含了漏洞，是漏洞利用的基础，不是投毒。
*   **exploit.py:** 该脚本的目的是利用漏洞，执行文件上传路径遍历，上传webshell，进行RCE。

考虑到POC的目的是为了重现和利用漏洞，其中可能包含webshell上传等操作，这本身不是“投毒”，而是漏洞利用的必要步骤。但是仍需要人工审查该脚本，检查是否存在超出漏洞利用范围的恶意代码，例如反向shell等。考虑到作者在README中提及“This exploit script has been created for the purposes of research. It is not intended to be used for any malicious or unauthorized activities.” 以及“Its recommended to run the application and exploit on Windows host. The exploit may not work on *nix based system sometimes.”，因此可以推测代码可能存在一些限制条件或者本身兼容性不是很好，增加了分析难度。综合判断投毒风险为10%。

**项目地址:** [AsfandAliMemon25/CVE-2023-50164Analysis-](https://github.com/AsfandAliMemon25/CVE-2023-50164Analysis-)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #2

**来源**: [CVE-2023-50164-MKIRAHMET_CVE-2023-50164-HTB-strutted.md](../2023/CVE-2023-50164-MKIRAHMET_CVE-2023-50164-HTB-strutted.md)

## CVE-2023-50164: Apache Struts 文件上传路径遍历导致远程代码执行

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 文件上传路径遍历导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，允许攻击者上传恶意文件并执行任意代码

**影响版本:** 2.0.0 <= Struts <= 2.5.32, 6.0.0 <= Struts <= 6.3.0.1

**利用条件:** 需要应用存在文件上传功能，且未对上传路径进行严格校验

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 存在于 Apache Struts 的文件上传组件中。攻击者可以通过操纵文件上传参数，实现路径遍历，进而上传恶意文件。根据POC，该漏洞的利用方式是上传一个 WAR webshell 到 Tomcat 服务器。

**有效性：**
根据漏洞库信息、搜索结果以及提供的POC代码，该漏洞是有效的，并且存在公开的POC。

**投毒风险：**
POC 代码包含一个 `Vagrantfile`，用于创建一个虚拟机环境来复现漏洞。 exploit.py 脚本用于上传webshell。 检查了 exploit.py（未提供，因此只能根据README推断），Vagrantfile 和 README.md 没有发现明显的恶意代码。投毒风险较低，但仍需谨慎，因为攻击者可能通过其他方式（例如修改依赖）引入恶意代码。

**利用方式：**
1.  攻击者构造包含恶意路径的文件上传请求。
2.  Struts 应用未能正确验证上传路径，允许攻击者将文件上传到任意位置。
3.  攻击者上传包含恶意代码的 WAR 文件 (webshell) 到 Tomcat 的 webapps 目录。
4.  Tomcat 部署该 WAR 文件，攻击者可以通过访问 webshell 执行任意代码。

**搜索引擎结果说明:** 众多安全厂商博客和漏洞库记录显示该漏洞存在且利用方法已经公开。

**项目地址:** [MKIRAHMET/CVE-2023-50164-HTB-strutted](https://github.com/MKIRAHMET/CVE-2023-50164-HTB-strutted)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #3

**来源**: [CVE-2023-50164-NikitaPark_CVE-2023-50164-PoC.md](../2023/CVE-2023-50164-NikitaPark_CVE-2023-50164-PoC.md)

## CVE-2023-50164-Apache Struts-文件上传路径遍历RCE

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 文件上传路径遍历RCE

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0.0 <= version <= 2.5.32 或 6.0.0 <= version <= 6.3.0.1

**利用条件:** 需要目标系统存在Apache Struts框架且存在文件上传功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164是Apache Struts框架中的一个文件上传路径遍历漏洞。攻击者可以操纵文件上传参数，实现路径遍历，从而上传恶意文件（如webshell），最终导致远程代码执行。

**有效性分析：**
根据漏洞库信息、搜索结果和提供的PoC代码，可以判断该漏洞利用是有效的。

*   漏洞库信息表明该漏洞允许攻击者操纵文件上传参数进行路径遍历，并最终实现RCE。
*   搜索引擎结果显示该漏洞已被广泛讨论，并且存在公开的PoC。
*   提供的PoC代码（exploit.py）展示了如何通过修改文件上传参数，将恶意文件上传到指定位置。

**投毒风险分析：**
PoC代码`/tmp/f2d27f0fde14a46b9c906fdccc67469a/exploit.py`主要功能是构造恶意请求，利用路径遍历漏洞上传文件。`/tmp/f2d27f0fde14a46b9c906fdccc67469a/Dockerfile`用于构建一个包含漏洞的Struts环境。`/tmp/f2d27f0fde14a46b9c906fdccc67469a/README.md`是使用说明，没有可疑代码。

`docker-compose.yml`文件内容不完整，理论上可能存在一定风险，但考虑到PoC的主要逻辑集中在`exploit.py`中，且该脚本主要执行文件上传操作，因此投毒风险较低，估计约为10%。可能的投毒方式包括修改上传文件的内容，或者在构建的Docker镜像中添加后门。

**利用方式：**

1.  **构建包含漏洞的Struts环境：** 使用提供的Dockerfile构建一个包含漏洞的Apache Struts应用程序环境（可选，如果目标环境已存在，则可跳过此步骤）。
2.  **构造恶意请求：** 通过修改HTTP请求中的文件上传参数，利用路径遍历漏洞指定文件上传的路径。
3.  **上传恶意文件：** 将包含恶意代码的文件（如webshell.jsp）上传到目标服务器的可执行目录下，例如webapps/ROOT。
4.  **执行恶意代码：** 通过访问上传的恶意文件，执行其中的恶意代码，从而实现远程代码执行。

总体来说,该漏洞利用比较直接，主要是通过构造畸形的文件上传请求实现路径遍历和任意文件上传。 虽然存在投毒风险，但主要集中在Dockerfile和docker-compose.yml， exploit.py 的投毒风险较低。

**项目地址:** [NikitaPark/CVE-2023-50164-PoC](https://github.com/NikitaPark/CVE-2023-50164-PoC)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #4

**来源**: [CVE-2023-50164-Pixel-DefaultBR_CVE-2023-50164.md](../2023/CVE-2023-50164-Pixel-DefaultBR_CVE-2023-50164.md)

## CVE-2023-50164 - Apache Struts 文件上传路径遍历与远程代码执行

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 文件上传路径遍历与远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器文件泄露，任意文件上传与远程代码执行

**影响版本:** 2.0.0 <= version <= 2.5.32, 6.0.0 <= version <= 6.3.0.1

**利用条件:** 目标系统使用存在漏洞的Apache Struts版本，且存在文件上传功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 存在于 Apache Struts 的文件上传组件中。攻击者可以操纵文件上传参数，利用路径遍历漏洞上传恶意文件，最终导致远程代码执行。

**有效性分析：**

漏洞库信息、搜索引擎结果和提供的漏洞利用代码均表明该漏洞是真实存在的，并且存在公开可用的PoC。 Akamai Security Intelligence Group的报告表明，自漏洞公开以来，已经观察到大量的利用尝试。PoC代码中包含上传PNG图片头和WebShell代码，允许攻击者上传恶意JSP文件。

**投毒风险分析：**

PoC代码中，`exploit.py` 脚本主要功能是构造包含恶意JSP WebShell 的PNG文件，并利用路径穿越漏洞上传到服务器，从而实现远程代码执行。`README.md` 声明该exp仅用于 HackTheBox 实验环境。上传后的JSP WebShell，本身就是攻击payload，风险在于被滥用进行非法渗透测试。投毒风险较低，估计在10%左右。

**利用方式：**

1.  **路径遍历：** 攻击者通过修改上传文件的参数（例如文件名），在文件名中添加`../`等路径遍历字符，使得上传的文件可以被写入到Web服务器的任意目录中。
2.  **恶意文件上传：** 攻击者上传包含恶意代码的文件，例如JSP WebShell。通常会伪装成图片文件（例如PNG），绕过一些基本的上传检查。
3.  **远程代码执行：** 攻击者通过访问上传的恶意文件，触发其中的恶意代码，从而在Web服务器上执行任意命令。

根据提供的利用代码, 漏洞利用包含以下步骤：
    *构造包含PNG文件头的JSP WebShell。
    *通过修改multipart/form-data的boundary来绕过一些WAF的检测。
    *将恶意文件上传到服务器。
    *通过访问上传的文件来执行命令。

**项目地址:** [Pixel-DefaultBR/CVE-2023-50164](https://github.com/Pixel-DefaultBR/CVE-2023-50164)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #5

**来源**: [CVE-2023-50164-Thirukrishnan_CVE-2023-50164-Apache-Struts-RCE.md](../2023/CVE-2023-50164-Thirukrishnan_CVE-2023-50164-Apache-Struts-RCE.md)

## CVE-2023-50164-Apache Struts-RCE

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.0.0 <= Struts <= 2.5.32 或 6.0.0 <= Struts <= 6.3.0.1

**利用条件:** 需要目标系统运行存在漏洞的Apache Struts版本，并且存在文件上传功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164是一个Apache Struts框架中的文件上传漏洞，攻击者可以通过操纵文件上传参数，实现路径遍历，进而上传恶意文件，最终导致远程代码执行。根据搜索引擎结果（例如，Arctic Wolf的博客），已经存在公开的PoC被利用。提供的漏洞利用代码包含一个Dockerfile，用于构建包含漏洞Struts应用的环境。Dockerfile中：

1.  安装了OpenJDK 17和必要的工具（wget, curl）。
2.  下载并配置了存在漏洞的Tomcat 9.0.83。
3.  下载并部署了一个名为"upload-1.0.0.war"的包含漏洞的WAR文件，该文件来自GitHub仓库[https://github.com/Thirukrishnan/CVE-2023-50164-Apache-Struts-RCE/raw/main/upload-1.0.0.war]。这个WAR文件是专门为复现这个漏洞设计的。
4. 暴露了8080端口，用于访问Tomcat服务器。

**有效性：** 提供的Dockerfile和WAR文件可以有效复现CVE-2023-50164漏洞，搭建一个存在漏洞的环境。

**投毒风险：** 虽然整体代码是为了复现漏洞，但存在轻微的投毒风险，原因如下：
*   Dockerfile直接从GitHub下载WAR文件，这依赖于外部资源的可信度。如果GitHub上的WAR文件被篡改，那么构建的镜像也会包含恶意代码。这种风险的百分比估计为10%，因为原作者可能已经做了验证措施,或者github代码库本身有安全保护措施.

**利用方式：**

1.  攻击者利用路径遍历漏洞，通过修改文件上传参数，将恶意文件上传到服务器的任意目录。
2.  上传的文件通常是包含恶意代码的JSP或WAR文件。
3.  攻击者通过访问上传的恶意文件，触发恶意代码，从而实现远程代码执行。
4. 具体而言，通过修改上传的文件名参数，例如`filename="../../../../tmp/shell.jsp"`，可以将文件上传到/tmp目录下。然后，访问`http://ip-address:port/tmp/shell.jsp`即可执行其中的代码。利用方式详细信息见参考链接中的相关分析。


**项目地址:** [Thirukrishnan/CVE-2023-50164-Apache-Struts-RCE](https://github.com/Thirukrishnan/CVE-2023-50164-Apache-Struts-RCE)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #6

**来源**: [CVE-2023-50164-Trackflaw_CVE-2023-50164-ApacheStruts2-Docker.md](../2023/CVE-2023-50164-Trackflaw_CVE-2023-50164-ApacheStruts2-Docker.md)

## CVE-2023-50164-Apache Struts-文件上传路径穿越导致RCE

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 文件上传路径穿越

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0.0 <= version <= 2.5.32 和 6.0.0 <= version <= 6.3.0.1

**利用条件:** 需要目标系统存在文件上传功能并且使用受影响的 Apache Struts 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 是 Apache Struts 2 中的一个严重漏洞，允许攻击者通过操纵文件上传参数来执行路径遍历攻击。如果应用程序存在缺陷，攻击者可以上传恶意文件，从而导致远程代码执行(RCE)。

**有效性：**

提供的 Dockerfile 旨在构建一个易受攻击的 Apache Struts 2 环境，用于演示 CVE-2023-50164。它包含构建和运行 Struts 应用程序所需的步骤。通过构建和运行这个 Docker 镜像，研究人员和安全专业人员可以安全地研究和利用此漏洞。

**投毒风险：**

在提供的文件中，`/tmp/c76c54a0ed5cbc2c09e0533b7830ced8/tomcat-users.xml` 文件包含一个具有预定义用户名“admin”和密码“trackflaw”的 Tomcat 管理员用户。虽然这允许轻松访问 Tomcat 管理界面以进行漏洞利用，但它也引入了投毒风险，如果这个配置被用于生产环境，攻击者可以通过默认凭据控制 Tomcat 服务器。此外，由于 `README.md` 文件中指出“The weaponized exploit code is not supplied.”，这意味着该仓库不包含直接利用漏洞的完整exp，用户需要自行编写利用代码，也增加了一定的投毒可能性，比如引导用户访问恶意网站或者下载包含恶意代码的exp。综合考虑，投毒风险相对较低，估计为10%。

**利用方式：**

根据漏洞库信息和搜索结果，漏洞利用方式如下：

1.  **路径遍历：** 攻击者通过修改文件上传请求中的参数，例如文件名，使其包含路径遍历字符（如 `../`），从而突破文件上传目录的限制。
2.  **恶意文件上传：**  通过路径遍历，攻击者可以将恶意文件上传到服务器上任意可写目录，例如 Web 应用程序的根目录或其他包含可执行脚本的目录。
3.  **远程代码执行 (RCE)：** 上传的恶意文件可以是包含恶意代码的 JSP 文件、Shell 脚本或其他服务器能够执行的文件。一旦该文件被服务器执行，攻击者就可以在服务器上执行任意命令，从而实现远程代码执行。

**项目地址:** [Trackflaw/CVE-2023-50164-ApacheStruts2-Docker](https://github.com/Trackflaw/CVE-2023-50164-ApacheStruts2-Docker)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #7

**来源**: [CVE-2023-50164-aaronm-sysdig_cve-2023-50164.md](../2023/CVE-2023-50164-aaronm-sysdig_cve-2023-50164.md)

## CVE-2023-50164 - Apache Struts 文件上传路径遍历导致远程代码执行

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** 2.0.0 <= version <= 2.5.32, 6.0.0 <= version <= 6.3.0.1

**利用条件:** 存在文件上传功能，且使用了受影响的Struts版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 是 Apache Struts 2 中的一个严重漏洞，攻击者可以通过操纵文件上传参数来利用路径遍历漏洞，在特定情况下，这可能导致上传恶意文件，从而执行远程代码。

**有效性评估：**
根据漏洞库信息和搜索引擎结果，该漏洞已被公开披露，并且存在公开可用的PoC（Proof of Concept）利用代码。提供的代码仓库包含了一个简单的 Struts 2 应用，用于演示漏洞检测。虽然代码本身只是一个演示，但基于已公开的信息和 PoC 的存在，可以判定该漏洞是有效的。

**投毒风险分析：**
提供的代码仓库主要包含以下文件：
*   Dockerfile：用于构建包含 Struts 2 应用的 Docker 镜像。
*   README.md：项目介绍。
*   java-deployment.yaml：Kubernetes 部署文件。
*   pom.xml：Maven 项目配置文件，声明 Struts 2 依赖。
*   src/main/webapp/hello.jsp：JSP 页面。
*   src/main/webapp/WEB-INF/web.xml：Web 应用配置文件。
*   src/main/resources/struts.xml：Struts 配置文件。
*   src/main/java/com/example/HelloAction.java：Struts Action 类。

代码库本身似乎是为了演示漏洞检测而构建的，作者声明Sysdig不对代码提供任何保证。虽然该项目的目的是好的，但是代码仓库中的 `java-deployment.yaml` 文件中 `image: placeholder`，这意味着需要用户手动替换镜像，如果用户替换成包含恶意代码的镜像，那么该项目就会被投毒；其次该项目仓库中使用的是struts2-core 2.5.22版本，该版本已经受到影响，如果被攻击者修改struts.xml等配置文件，放入恶意代码，也会导致投毒。考虑到作者的免责声明，并且代码仓库本身的结构更偏向于演示目的，投毒的可能性较低，大约为 10%。

**利用方式：**
1.  **路径遍历：** 攻击者通过修改文件上传请求中的参数（例如，文件名），使其包含 `../` 等路径遍历字符。
2.  **恶意文件上传：** 攻击者利用路径遍历将恶意文件上传到 Web 服务器的可执行目录下，例如 Web 应用的根目录或 Tomcat 的 webapps 目录。
3.  **远程代码执行：** 攻击者访问上传的恶意文件，触发服务器执行其中的代码，从而实现远程代码执行。

简而言之，利用方式的核心在于利用路径遍历上传一个可执行的文件，例如包含恶意代码的 JSP 文件或者 Servlet，然后通过访问该文件来触发恶意代码的执行。

**项目地址:** [aaronm-sysdig/cve-2023-50164](https://github.com/aaronm-sysdig/cve-2023-50164)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #8

**来源**: [CVE-2023-50164-bcdannyboy_CVE-2023-50164.md](../2023/CVE-2023-50164-bcdannyboy_CVE-2023-50164.md)

## CVE-2023-50164 - Apache Struts 文件上传路径遍历导致远程代码执行

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 2.0.0 <= Struts <= 2.5.32 或 6.0.0 <= Struts <= 6.3.0.1

**利用条件:** 需要目标系统存在文件上传功能，并且该功能受到Struts框架处理。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-50164是Apache Struts 2中的一个文件上传漏洞。攻击者可以操纵文件上传参数，实现路径遍历，进而上传恶意文件，最终可能导致远程代码执行。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8，属于高危漏洞，并且已经存在公开的PoC。

**有效性：**
提供的PoC代码尝试通过修改multipart/form-data请求中的文件名参数，利用路径遍历漏洞，将上传的文件写入到任意位置。它通过上传一个包含 "SUCCESSFULLY EXPLOITED CVE-2023-50164" 字符串的benign.txt文件来验证漏洞的存在。PoC需要用户提供目标URL，上传变量名，文件名变量名和payload路径，这表明漏洞的利用具有一定的环境依赖性。
从搜索结果来看, 存在公开可利用的EXP, 已经有被利用的尝试,可以判断此漏洞利用的有效性很高.

**投毒风险：**
PoC代码本身的功能是上传一个包含特定字符串的benign.txt文件，以验证漏洞是否存在。 虽然PoC允许用户指定任意payload路径，但上传的文件内容是预定义的，相对安全，风险较低。 即使恶意用户指定了系统关键文件路径，覆盖的内容也是无害的，不会直接导致系统崩溃或者执行恶意代码。 此外， PoC需要用户指定uploadVar和filenameVar，也需要用户提供payloadPath，增加了利用的难度，降低了被恶意使用的可能性。PoC上传的文件内容是固定的，不包含任何可执行代码，因此直接被用作恶意软件的可能性较低。综合来看，该PoC代码的投毒风险较低，估计约为1%。

**利用方式：**
1.  攻击者首先需要确定目标系统使用的Struts版本在受影响范围内 (2.0.0 <= Struts <= 2.5.32 或 6.0.0 <= Struts <= 6.3.0.1)。
2.  攻击者需要找到目标系统存在文件上传功能的地方，并分析上传请求的参数，确定`uploadVar`（上传文件的变量名）和 `filenameVar`（上传文件名的变量名）。
3.  利用PoC脚本，通过修改`filenameVar`参数，构造包含路径遍历的payload，例如`../../../../tmp/benign.txt`，将benign.txt上传到指定位置。
4.  如果上传成功，则说明漏洞存在。攻击者可以修改PoC，上传包含恶意代码的payload文件，例如webshell，从而控制目标服务器。

**项目地址:** [bcdannyboy/CVE-2023-50164](https://github.com/bcdannyboy/CVE-2023-50164)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #9

**来源**: [CVE-2023-50164-dwisiswant0_cve-2023-50164-poc.md](../2023/CVE-2023-50164-dwisiswant0_cve-2023-50164-poc.md)

## CVE-2023-50164-Apache Struts-路径遍历与远程代码执行

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 路径遍历与远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 2.0.0 <= version <= 2.5.32, 6.0.0 <= version <= 6.3.0.1

**利用条件:** 需要应用程序存在文件上传功能，并且使用了受影响的Apache Struts版本。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-50164 是 Apache Struts 2 中的一个严重漏洞，允许攻击者通过操纵文件上传参数来执行路径遍历，在某些情况下，这可能导致上传恶意文件，进而实现远程代码执行。

**漏洞分析：**
根据漏洞库信息和搜索结果，该漏洞源于 Apache Struts 在处理文件上传时对路径的验证不足。攻击者可以构造包含路径遍历字符（如`../`）的文件名或路径，从而绕过安全检查，将文件上传到服务器上的任意位置。

**POC有效性：**
提供的POC代码是一个Go程序，它通过以下步骤利用该漏洞：

1.  **WAR文件创建：** 将目标文件压缩成WAR文件， WAR文件相当于一个web项目，里面存放这web项目会执行的jsp等。
2.  **路径检查：** 检查目标路径是否已存在，如果存在则退出。
3.  **文件上传：** 通过修改文件上传参数，尝试将WAR文件上传到目标服务器。
4.  **验证：** 检查上传的文件是否可以通过HTTP访问，以确认上传是否成功。

根据搜索结果和POC代码，该漏洞的利用方式是有效的。多个安全厂商和研究人员已经确认了该漏洞的存在并发布了相关的PoC。

**投毒风险分析：**
查看提供的PoC代码，主要代码功能都集中在利用漏洞本身，没有发现明显的恶意代码或后门。该POC的主要流程是：

1.  生成WAR文件
2.  发送Payload进行攻击
3.  验证Payload是否上传成功

但是，仍然存在一些潜在的投毒风险：

1.  **依赖风险：** 该PoC依赖一些第三方Go模块，这些模块可能存在安全漏洞或被恶意篡改。
2.  **编译风险：** 用户在编译PoC代码时，可能会引入恶意代码。
3.  **参数篡改：** 使用者可能会在使用PoC时修改参数，导致上传的文件包含恶意代码。

总的来说，该PoC代码本身没有明显的投毒代码，但仍然存在一些潜在的风险，需要用户在使用时保持警惕。因此，将投毒风险评估为5%。

**利用方式：**

1.  攻击者构造包含恶意代码（如JSP webshell）的文件。
2.  攻击者使用PoC工具，通过修改文件上传参数，将恶意文件上传到服务器的web目录或其他敏感位置。
3.  攻击者通过访问上传的恶意文件，执行其中的恶意代码，从而控制服务器。

**缓解措施：**

1.  升级到Apache Struts 2.5.33 或 6.3.0.2 或更高版本。
2.  对文件上传进行严格的路径验证和过滤。
3.  限制上传文件的类型。
4.  使用Web应用防火墙（WAF）来检测和阻止恶意文件上传请求。

**项目地址:** [dwisiswant0/cve-2023-50164-poc](https://github.com/dwisiswant0/cve-2023-50164-poc)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #10

**来源**: [CVE-2023-50164-helsecert_cve-2023-50164.md](../2023/CVE-2023-50164-helsecert_cve-2023-50164.md)

## CVE-2023-50164 - Apache Struts 文件上传目录遍历导致远程代码执行

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 2.0.0 <= Struts <= 2.5.32, 6.0.0 <= Struts <= 6.3.0.1

**利用条件:** 需要应用存在文件上传功能，且使用了存在漏洞的Struts版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 是 Apache Struts 2 的一个严重漏洞，攻击者可以操纵文件上传参数来实现路径遍历，在某些情况下，这会导致上传恶意文件，最终实现远程代码执行。

**有效性评估：**
根据漏洞库信息，搜索引擎结果以及漏洞利用代码，该漏洞是一个已确认且被广泛讨论的漏洞。大量安全厂商和研究人员都发布了关于此漏洞的分析和利用报告，证明了其有效性。同时，CISA 将其列为已知被利用的漏洞 (KEV)。

**投毒风险评估：**
提供的漏洞利用代码仓库包含用于查找系统中存在漏洞 Struts 2 应用程序的脚本，这些脚本本身不是漏洞利用代码，而是辅助工具。因此，直接的投毒风险较低，但是存在以下潜在风险：

*   **信息泄露：** 扫描脚本可能会泄露系统中的应用信息，如果攻击者获取这些信息，可能会用于进一步的攻击。
*   **误报：** 脚本可能存在误报，导致安全人员投入不必要的精力。
*   **扫描行为：** 频繁的扫描行为可能被认为是恶意行为，从而触发安全警报。

该仓库的主要作用是协助定位受影响的系统，而不是直接进行漏洞利用，因此，投毒风险较低，估计为 10%。 主要是考虑到脚本可能存在一些隐藏的逻辑，用于收集信息或进行其他恶意行为，但可能性较小。

**利用方式分析：**

1.  **路径遍历：** 攻击者通过修改文件上传请求中的参数（例如文件名），构造包含 `../` 的路径，从而突破上传目录的限制，将文件上传到任意位置。
2.  **恶意文件上传：** 攻击者上传包含恶意代码的文件，例如 JSP webshell。由于可以控制文件上传的位置，攻击者可以将恶意文件上传到 Web 服务器的可执行目录下。
3.  **远程代码执行：** 攻击者通过访问上传的恶意文件，触发其中的恶意代码，最终实现远程代码执行。

**缓解措施：**

*   升级到 Struts 2.5.33 或 6.3.0.2 或更高版本。
*   实施严格的文件上传验证，包括文件名、文件类型和文件大小的验证。
*   配置 Web 服务器，限制文件上传目录的执行权限。

**项目地址:** [helsecert/cve-2023-50164](https://github.com/helsecert/cve-2023-50164)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #11

**来源**: [CVE-2023-50164-hybinn_CVE-2023-50164.md](../2023/CVE-2023-50164-hybinn_CVE-2023-50164.md)

## CVE-2023-50164 Apache Struts 文件上传目录遍历漏洞

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 文件上传目录遍历

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0.0 <= version <= 2.5.32 和 6.0.0 <= version <= 6.3.0.1

**利用条件:** 应用程序使用受影响版本的Apache Struts，且存在文件上传功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 是 Apache Struts 框架中的一个文件上传漏洞，允许攻击者通过操纵文件上传参数实现目录遍历。在特定情况下，这可能导致上传恶意文件，进而执行远程代码。

**有效性：**
根据漏洞库信息和通常的文件上传漏洞利用方式，攻击者可以通过修改上传文件的路径参数（例如，文件名或路径字段）来突破文件上传的限制，将文件上传到服务器上的任意位置。如果上传的文件是可执行文件（例如，JSP、Servlet等），攻击者可以通过访问该文件来执行恶意代码，从而实现远程代码执行。
提供的POC代码`/tmp/51e0f4d2bf9d641c1230687a807c0d75/README.md`仅仅包含 `# CVE-2023-50164`，表明只是漏洞声明，没有实际利用代码. 因此，需要构造专门的请求来利用此漏洞。目前给出的代码无法验证漏洞。

**投毒风险：**
提供的POC代码仅为一个 README.md 文件，内容仅包含漏洞编号，没有包含任何可执行代码。因此投毒风险较低，可以认为几乎不存在投毒代码。 但不能排除该仓库的作者在其他分支或后续提交中添加恶意代码的可能性。因此将投毒风险设置为10%。

**利用方式：**
1.  攻击者构造包含目录遍历payload的文件上传请求。Payload 通常会修改文件上传路径参数，例如使用 `../../` 这样的序列来跳出预定的上传目录。
2.  Struts框架在处理文件上传请求时，如果未对文件路径进行充分验证和清理，会将文件上传到攻击者指定的目录。
3.  攻击者上传包含恶意代码的文件（例如，JSP脚本），并将其上传到Web服务器的可执行目录下。
4.  攻击者通过Web浏览器访问上传的恶意文件，触发恶意代码的执行，从而实现远程代码执行。

**项目地址:** [hybinn/CVE-2023-50164](https://github.com/hybinn/CVE-2023-50164)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #12

**来源**: [CVE-2023-50164-jakabakos_CVE-2023-50164-Apache-Struts-RCE.md](../2023/CVE-2023-50164-jakabakos_CVE-2023-50164-Apache-Struts-RCE.md)

## CVE-2023-50164-Apache Struts文件上传路径遍历导致RCE

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0.0 <= Struts <= 2.5.32 和 6.0.0 <= Struts <= 6.3.0.1

**利用条件:** 需要存在文件上传功能，且应用部署在支持WAR部署的环境，如Tomcat

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 是 Apache Struts 中的一个关键漏洞，攻击者可以通过操纵文件上传参数实现路径遍历。在特定情况下，这可能导致上传恶意文件，进而实现远程代码执行 (RCE)。

**有效性评估：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞的PoC代码有效。漏洞库和搜索结果均表明这是一个严重的安全漏洞，并存在公开可用的PoC。

**投毒风险评估：**

分析提供的PoC代码（README.md 和 Vagrantfile），主要的风险点较低：

*   `README.md`:  该文件详细描述了漏洞和PoC的用法，并包含免责声明，表明其目的是用于研究和防御目的。
*   `Vagrantfile`:  该文件用于创建用于测试的环境，使用 `generic/debian12` 作为基础镜像，并配置了一个私有网络，IP 地址为 `192.168.56.25`。虽然 Vagrantfile 可以执行任意命令，但是目前文件中的命令都是常规配置，用于搭建测试环境。

尽管如此，所有来自第三方的代码都应谨慎对待。该仓库本身结构比较简单，主要功能代码应该在 `exploit.py` (未提供) 文件中。如果没有代码审计`exploit.py`, 不能完全排除隐蔽的恶意代码的可能性。综合评估，投毒风险较低，大约为10%。主要风险可能存在于`exploit.py` 中，例如在上传的webshell中添加后门，或者利用路径遍历写入恶意配置文件。但是鉴于PoC作者已经声明目的为研究，且相关信息比较透明，恶意投毒的可能性相对较低。

**利用方式分析：**

1.  **路径遍历：** 攻击者通过修改文件上传的参数，构造包含 `../` 的路径，突破文件上传的目录限制，实现任意文件写入。
2.  **Webshell 上传：** 攻击者利用路径遍历，将包含恶意代码的 Webshell 文件上传到 Web 服务器的可执行目录下。
3.  **远程代码执行：** 攻击者通过访问上传的 Webshell 文件，执行恶意代码，从而控制服务器。

根据PoC的描述，利用方式需要应用部署在类似Tomcat这样的服务器上，通过上传WAR包形式的Webshell来实现利用。



**项目地址:** [jakabakos/CVE-2023-50164-Apache-Struts-RCE](https://github.com/jakabakos/CVE-2023-50164-Apache-Struts-RCE)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #13

**来源**: [CVE-2023-50164-minhbao15677_CVE-2023-50164.md](../2023/CVE-2023-50164-minhbao15677_CVE-2023-50164.md)

## CVE-2023-50164: Apache Struts 文件上传路径遍历导致RCE漏洞

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 文件上传路径遍历导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致任意文件上传和远程代码执行

**影响版本:** 2.0.0 <= Struts <= 2.5.32, 6.0.0 <= Struts <= 6.3.0.1

**利用条件:** 需要 Struts 应用存在文件上传功能，且应用使用了 ActionSupport 类。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 是 Apache Struts 2 中的一个严重漏洞，允许攻击者通过操纵文件上传参数来执行路径遍历。在某些情况下，这可能导致上传恶意文件，进而执行远程代码。根据漏洞信息，该漏洞的CVSS评分为9.8，表明其严重性。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者可以修改文件上传请求中的参数，利用 `..` 等路径遍历字符，突破上传目录的限制，将文件上传到服务器上的任意位置。
2.  **恶意文件上传：** 通过路径遍历，攻击者可以将包含恶意代码的文件（例如 JSP 文件、Servlet 文件等）上传到 Web 容器的可执行目录下。
3.  **远程代码执行 (RCE)：** 一旦恶意文件被上传到可执行目录，攻击者可以通过访问该文件来触发恶意代码的执行，从而实现远程代码执行。

**POC有效性评估：**

提供的漏洞利用代码是一个简单的说明文档，描述了如何搭建调试环境以及分析漏洞。该文档本身**不是完整的可直接运行的POC**，但它指明了漏洞利用的方向，可以辅助安全研究人员或攻击者复现漏洞。

虽然这里提供的POC只有搭建环境说明，但是参考搜索结果，网上已存在公开的POC，因此可以认为此漏洞利用是有效的。

**投毒风险分析：**

由于提供的漏洞利用代码只是一个README.md文件，描述了搭建调试环境的步骤和漏洞分析的简要说明。该文件本身不包含可执行代码，因此，**该文件本身投毒的可能性非常低。**

但是,考虑到黑客攻击的复杂性，不排除作者在搭建环境过程中，通过其他方式进行投毒的可能性。所以，我个人认为投毒风险为10%。需要进一步分析才能给出更精确的评估。

**总结：**

CVE-2023-50164 是一个高危漏洞，攻击者可以利用该漏洞实现任意文件上传和远程代码执行。建议受影响的用户尽快升级到 Struts 2.5.33 或 Struts 6.3.0.2 或更高版本。

**项目地址:** [minhbao15677/CVE-2023-50164](https://github.com/minhbao15677/CVE-2023-50164)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #14

**来源**: [CVE-2023-50164-snyk-labs_CVE-2023-50164-POC.md](../2023/CVE-2023-50164-snyk-labs_CVE-2023-50164-POC.md)

## CVE-2023-50164-Apache Struts-路径遍历/远程代码执行

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 2.0.0 <= version <= 2.5.32
6.0.0 <= version <= 6.3.0.1

**利用条件:** 需要目标系统使用存在漏洞的Apache Struts版本，且存在文件上传功能。需要网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-50164是Apache Struts中的一个严重漏洞，允许攻击者操纵文件上传参数以实现路径遍历。在某些情况下，这可能导致上传恶意文件，从而导致远程代码执行（RCE）。

**漏洞利用有效性：**
根据漏洞库信息、搜索结果，该漏洞利用POC已公开，且已被观察到实际利用。

**投毒风险：**
提供的漏洞利用代码只是Apache License 2.0的license文件,无任何攻击代码,可以确定不存在投毒。

**利用方式：**
1.  **路径遍历：** 攻击者通过修改文件上传的参数，例如文件名，使其包含路径遍历字符（如`../`），从而能够将文件上传到服务器上的任意位置。
2.  **恶意文件上传：** 攻击者上传一个包含恶意代码的文件，例如JSP文件或者其他类型的可执行文件。
3.  **远程代码执行：** 攻击者通过访问上传的恶意文件，触发其中的恶意代码，从而在服务器上执行任意命令。

**缓解措施：**
*   升级到Struts 2.5.33或Struts 6.3.0.2或更高版本。
*   实施严格的文件上传验证，包括文件名检查、文件类型检查和文件大小限制。
*   配置Web服务器，限制对上传目录的访问权限。


**项目地址:** [snyk-labs/CVE-2023-50164-POC](https://github.com/snyk-labs/CVE-2023-50164-POC)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #15

**来源**: [CVE-2023-50164-sunnyvale-it_CVE-2023-50164-PoC.md](../2023/CVE-2023-50164-sunnyvale-it_CVE-2023-50164-PoC.md)

## CVE-2023-50164-Apache Struts文件上传路径遍历导致RCE

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 文件上传路径遍历导致RCE

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0.0 - 2.5.32, 6.0.0 - 6.3.0.1

**利用条件:** 需要存在文件上传功能且使用受影响的Apache Struts版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164是Apache Struts 2中的一个文件上传漏洞，攻击者可以通过操纵文件上传参数，实现路径遍历，最终上传恶意文件并执行远程代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8，属于高危漏洞。漏洞利用代码中的Dockerfile构建了一个包含Struts2应用程序的Tomcat环境，pom.xml文件指定了存在漏洞的Struts2版本。README.md提供了构建和运行PoC的步骤，以及执行任意命令的示例。利用方式是通过构造恶意的上传请求，将webshell.jsp上传到服务器的webshell目录下，然后通过访问该webshell执行任意命令。POC存在一定投毒风险，虽然主要代码是用来验证漏洞的，但是webshell本身就具有潜在的危险，如果攻击者修改了Dockerfile或者exploit.sh，可能会引入恶意的行为。风险评估基于webshell本身的风险和修改PoC引入恶意代码的潜在可能。

**有效性：** 提供的POC代码是有效的，它成功地演示了CVE-2023-50164漏洞的利用。

**投毒风险：** 存在一定的投毒风险，约为10%。 主要风险点在于：
   1. Dockerfile中的基础镜像可能被替换为包含恶意软件的版本。
   2. exploit.sh脚本可能被修改为执行额外的恶意操作。
   3. webshell.jsp本身可能包含隐藏的后门或恶意代码。

**利用方式：**
   1. 攻击者构造包含恶意路径的文件上传请求。攻击请求中包含了目录遍历的payload，例如：filename="../../../../tmp/shell.jsp"
   2. Struts2应用解析请求，由于漏洞存在，允许将文件上传到任意目录。
   3. 攻击者上传一个webshell（如JSP脚本），该webshell允许执行任意系统命令。
   4. 攻击者通过访问上传的webshell，执行恶意代码，实现远程代码执行。

**搜索引擎结果摘要：** 多个来源确认了CVE-2023-50164是一个高危漏洞，并且已经出现了公开的PoC。漏洞允许攻击者通过文件上传参数操纵实现路径遍历，从而导致远程代码执行。

**项目地址:** [sunnyvale-it/CVE-2023-50164-PoC](https://github.com/sunnyvale-it/CVE-2023-50164-PoC)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---



---

## POC #4

**来源**: [CVE-2023-50164-Pixel-DefaultBR_CVE-2023-50164.md](../2023/CVE-2023-50164-Pixel-DefaultBR_CVE-2023-50164.md)

## CVE-2023-50164 - Apache Struts 文件上传路径遍历与远程代码执行

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 文件上传路径遍历与远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器文件泄露，任意文件上传与远程代码执行

**影响版本:** 2.0.0 <= version <= 2.5.32, 6.0.0 <= version <= 6.3.0.1

**利用条件:** 目标系统使用存在漏洞的Apache Struts版本，且存在文件上传功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 存在于 Apache Struts 的文件上传组件中。攻击者可以操纵文件上传参数，利用路径遍历漏洞上传恶意文件，最终导致远程代码执行。

**有效性分析：**

漏洞库信息、搜索引擎结果和提供的漏洞利用代码均表明该漏洞是真实存在的，并且存在公开可用的PoC。 Akamai Security Intelligence Group的报告表明，自漏洞公开以来，已经观察到大量的利用尝试。PoC代码中包含上传PNG图片头和WebShell代码，允许攻击者上传恶意JSP文件。

**投毒风险分析：**

PoC代码中，`exploit.py` 脚本主要功能是构造包含恶意JSP WebShell 的PNG文件，并利用路径穿越漏洞上传到服务器，从而实现远程代码执行。`README.md` 声明该exp仅用于 HackTheBox 实验环境。上传后的JSP WebShell，本身就是攻击payload，风险在于被滥用进行非法渗透测试。投毒风险较低，估计在10%左右。

**利用方式：**

1.  **路径遍历：** 攻击者通过修改上传文件的参数（例如文件名），在文件名中添加`../`等路径遍历字符，使得上传的文件可以被写入到Web服务器的任意目录中。
2.  **恶意文件上传：** 攻击者上传包含恶意代码的文件，例如JSP WebShell。通常会伪装成图片文件（例如PNG），绕过一些基本的上传检查。
3.  **远程代码执行：** 攻击者通过访问上传的恶意文件，触发其中的恶意代码，从而在Web服务器上执行任意命令。

根据提供的利用代码, 漏洞利用包含以下步骤：
    *构造包含PNG文件头的JSP WebShell。
    *通过修改multipart/form-data的boundary来绕过一些WAF的检测。
    *将恶意文件上传到服务器。
    *通过访问上传的文件来执行命令。

**项目地址:** [Pixel-DefaultBR/CVE-2023-50164](https://github.com/Pixel-DefaultBR/CVE-2023-50164)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #5

**来源**: [CVE-2023-50164-Thirukrishnan_CVE-2023-50164-Apache-Struts-RCE.md](../2023/CVE-2023-50164-Thirukrishnan_CVE-2023-50164-Apache-Struts-RCE.md)

## CVE-2023-50164-Apache Struts-RCE

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.0.0 <= Struts <= 2.5.32 或 6.0.0 <= Struts <= 6.3.0.1

**利用条件:** 需要目标系统运行存在漏洞的Apache Struts版本，并且存在文件上传功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164是一个Apache Struts框架中的文件上传漏洞，攻击者可以通过操纵文件上传参数，实现路径遍历，进而上传恶意文件，最终导致远程代码执行。根据搜索引擎结果（例如，Arctic Wolf的博客），已经存在公开的PoC被利用。提供的漏洞利用代码包含一个Dockerfile，用于构建包含漏洞Struts应用的环境。Dockerfile中：

1.  安装了OpenJDK 17和必要的工具（wget, curl）。
2.  下载并配置了存在漏洞的Tomcat 9.0.83。
3.  下载并部署了一个名为"upload-1.0.0.war"的包含漏洞的WAR文件，该文件来自GitHub仓库[https://github.com/Thirukrishnan/CVE-2023-50164-Apache-Struts-RCE/raw/main/upload-1.0.0.war]。这个WAR文件是专门为复现这个漏洞设计的。
4. 暴露了8080端口，用于访问Tomcat服务器。

**有效性：** 提供的Dockerfile和WAR文件可以有效复现CVE-2023-50164漏洞，搭建一个存在漏洞的环境。

**投毒风险：** 虽然整体代码是为了复现漏洞，但存在轻微的投毒风险，原因如下：
*   Dockerfile直接从GitHub下载WAR文件，这依赖于外部资源的可信度。如果GitHub上的WAR文件被篡改，那么构建的镜像也会包含恶意代码。这种风险的百分比估计为10%，因为原作者可能已经做了验证措施,或者github代码库本身有安全保护措施.

**利用方式：**

1.  攻击者利用路径遍历漏洞，通过修改文件上传参数，将恶意文件上传到服务器的任意目录。
2.  上传的文件通常是包含恶意代码的JSP或WAR文件。
3.  攻击者通过访问上传的恶意文件，触发恶意代码，从而实现远程代码执行。
4. 具体而言，通过修改上传的文件名参数，例如`filename="../../../../tmp/shell.jsp"`，可以将文件上传到/tmp目录下。然后，访问`http://ip-address:port/tmp/shell.jsp`即可执行其中的代码。利用方式详细信息见参考链接中的相关分析。


**项目地址:** [Thirukrishnan/CVE-2023-50164-Apache-Struts-RCE](https://github.com/Thirukrishnan/CVE-2023-50164-Apache-Struts-RCE)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #6

**来源**: [CVE-2023-50164-Trackflaw_CVE-2023-50164-ApacheStruts2-Docker.md](../2023/CVE-2023-50164-Trackflaw_CVE-2023-50164-ApacheStruts2-Docker.md)

## CVE-2023-50164-Apache Struts-文件上传路径穿越导致RCE

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 文件上传路径穿越

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0.0 <= version <= 2.5.32 和 6.0.0 <= version <= 6.3.0.1

**利用条件:** 需要目标系统存在文件上传功能并且使用受影响的 Apache Struts 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 是 Apache Struts 2 中的一个严重漏洞，允许攻击者通过操纵文件上传参数来执行路径遍历攻击。如果应用程序存在缺陷，攻击者可以上传恶意文件，从而导致远程代码执行(RCE)。

**有效性：**

提供的 Dockerfile 旨在构建一个易受攻击的 Apache Struts 2 环境，用于演示 CVE-2023-50164。它包含构建和运行 Struts 应用程序所需的步骤。通过构建和运行这个 Docker 镜像，研究人员和安全专业人员可以安全地研究和利用此漏洞。

**投毒风险：**

在提供的文件中，`/tmp/c76c54a0ed5cbc2c09e0533b7830ced8/tomcat-users.xml` 文件包含一个具有预定义用户名“admin”和密码“trackflaw”的 Tomcat 管理员用户。虽然这允许轻松访问 Tomcat 管理界面以进行漏洞利用，但它也引入了投毒风险，如果这个配置被用于生产环境，攻击者可以通过默认凭据控制 Tomcat 服务器。此外，由于 `README.md` 文件中指出“The weaponized exploit code is not supplied.”，这意味着该仓库不包含直接利用漏洞的完整exp，用户需要自行编写利用代码，也增加了一定的投毒可能性，比如引导用户访问恶意网站或者下载包含恶意代码的exp。综合考虑，投毒风险相对较低，估计为10%。

**利用方式：**

根据漏洞库信息和搜索结果，漏洞利用方式如下：

1.  **路径遍历：** 攻击者通过修改文件上传请求中的参数，例如文件名，使其包含路径遍历字符（如 `../`），从而突破文件上传目录的限制。
2.  **恶意文件上传：**  通过路径遍历，攻击者可以将恶意文件上传到服务器上任意可写目录，例如 Web 应用程序的根目录或其他包含可执行脚本的目录。
3.  **远程代码执行 (RCE)：** 上传的恶意文件可以是包含恶意代码的 JSP 文件、Shell 脚本或其他服务器能够执行的文件。一旦该文件被服务器执行，攻击者就可以在服务器上执行任意命令，从而实现远程代码执行。

**项目地址:** [Trackflaw/CVE-2023-50164-ApacheStruts2-Docker](https://github.com/Trackflaw/CVE-2023-50164-ApacheStruts2-Docker)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #7

**来源**: [CVE-2023-50164-aaronm-sysdig_cve-2023-50164.md](../2023/CVE-2023-50164-aaronm-sysdig_cve-2023-50164.md)

## CVE-2023-50164 - Apache Struts 文件上传路径遍历导致远程代码执行

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** 2.0.0 <= version <= 2.5.32, 6.0.0 <= version <= 6.3.0.1

**利用条件:** 存在文件上传功能，且使用了受影响的Struts版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 是 Apache Struts 2 中的一个严重漏洞，攻击者可以通过操纵文件上传参数来利用路径遍历漏洞，在特定情况下，这可能导致上传恶意文件，从而执行远程代码。

**有效性评估：**
根据漏洞库信息和搜索引擎结果，该漏洞已被公开披露，并且存在公开可用的PoC（Proof of Concept）利用代码。提供的代码仓库包含了一个简单的 Struts 2 应用，用于演示漏洞检测。虽然代码本身只是一个演示，但基于已公开的信息和 PoC 的存在，可以判定该漏洞是有效的。

**投毒风险分析：**
提供的代码仓库主要包含以下文件：
*   Dockerfile：用于构建包含 Struts 2 应用的 Docker 镜像。
*   README.md：项目介绍。
*   java-deployment.yaml：Kubernetes 部署文件。
*   pom.xml：Maven 项目配置文件，声明 Struts 2 依赖。
*   src/main/webapp/hello.jsp：JSP 页面。
*   src/main/webapp/WEB-INF/web.xml：Web 应用配置文件。
*   src/main/resources/struts.xml：Struts 配置文件。
*   src/main/java/com/example/HelloAction.java：Struts Action 类。

代码库本身似乎是为了演示漏洞检测而构建的，作者声明Sysdig不对代码提供任何保证。虽然该项目的目的是好的，但是代码仓库中的 `java-deployment.yaml` 文件中 `image: placeholder`，这意味着需要用户手动替换镜像，如果用户替换成包含恶意代码的镜像，那么该项目就会被投毒；其次该项目仓库中使用的是struts2-core 2.5.22版本，该版本已经受到影响，如果被攻击者修改struts.xml等配置文件，放入恶意代码，也会导致投毒。考虑到作者的免责声明，并且代码仓库本身的结构更偏向于演示目的，投毒的可能性较低，大约为 10%。

**利用方式：**
1.  **路径遍历：** 攻击者通过修改文件上传请求中的参数（例如，文件名），使其包含 `../` 等路径遍历字符。
2.  **恶意文件上传：** 攻击者利用路径遍历将恶意文件上传到 Web 服务器的可执行目录下，例如 Web 应用的根目录或 Tomcat 的 webapps 目录。
3.  **远程代码执行：** 攻击者访问上传的恶意文件，触发服务器执行其中的代码，从而实现远程代码执行。

简而言之，利用方式的核心在于利用路径遍历上传一个可执行的文件，例如包含恶意代码的 JSP 文件或者 Servlet，然后通过访问该文件来触发恶意代码的执行。

**项目地址:** [aaronm-sysdig/cve-2023-50164](https://github.com/aaronm-sysdig/cve-2023-50164)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #8

**来源**: [CVE-2023-50164-bcdannyboy_CVE-2023-50164.md](../2023/CVE-2023-50164-bcdannyboy_CVE-2023-50164.md)

## CVE-2023-50164 - Apache Struts 文件上传路径遍历导致远程代码执行

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 2.0.0 <= Struts <= 2.5.32 或 6.0.0 <= Struts <= 6.3.0.1

**利用条件:** 需要目标系统存在文件上传功能，并且该功能受到Struts框架处理。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-50164是Apache Struts 2中的一个文件上传漏洞。攻击者可以操纵文件上传参数，实现路径遍历，进而上传恶意文件，最终可能导致远程代码执行。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8，属于高危漏洞，并且已经存在公开的PoC。

**有效性：**
提供的PoC代码尝试通过修改multipart/form-data请求中的文件名参数，利用路径遍历漏洞，将上传的文件写入到任意位置。它通过上传一个包含 "SUCCESSFULLY EXPLOITED CVE-2023-50164" 字符串的benign.txt文件来验证漏洞的存在。PoC需要用户提供目标URL，上传变量名，文件名变量名和payload路径，这表明漏洞的利用具有一定的环境依赖性。
从搜索结果来看, 存在公开可利用的EXP, 已经有被利用的尝试,可以判断此漏洞利用的有效性很高.

**投毒风险：**
PoC代码本身的功能是上传一个包含特定字符串的benign.txt文件，以验证漏洞是否存在。 虽然PoC允许用户指定任意payload路径，但上传的文件内容是预定义的，相对安全，风险较低。 即使恶意用户指定了系统关键文件路径，覆盖的内容也是无害的，不会直接导致系统崩溃或者执行恶意代码。 此外， PoC需要用户指定uploadVar和filenameVar，也需要用户提供payloadPath，增加了利用的难度，降低了被恶意使用的可能性。PoC上传的文件内容是固定的，不包含任何可执行代码，因此直接被用作恶意软件的可能性较低。综合来看，该PoC代码的投毒风险较低，估计约为1%。

**利用方式：**
1.  攻击者首先需要确定目标系统使用的Struts版本在受影响范围内 (2.0.0 <= Struts <= 2.5.32 或 6.0.0 <= Struts <= 6.3.0.1)。
2.  攻击者需要找到目标系统存在文件上传功能的地方，并分析上传请求的参数，确定`uploadVar`（上传文件的变量名）和 `filenameVar`（上传文件名的变量名）。
3.  利用PoC脚本，通过修改`filenameVar`参数，构造包含路径遍历的payload，例如`../../../../tmp/benign.txt`，将benign.txt上传到指定位置。
4.  如果上传成功，则说明漏洞存在。攻击者可以修改PoC，上传包含恶意代码的payload文件，例如webshell，从而控制目标服务器。

**项目地址:** [bcdannyboy/CVE-2023-50164](https://github.com/bcdannyboy/CVE-2023-50164)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #9

**来源**: [CVE-2023-50164-dwisiswant0_cve-2023-50164-poc.md](../2023/CVE-2023-50164-dwisiswant0_cve-2023-50164-poc.md)

## CVE-2023-50164-Apache Struts-路径遍历与远程代码执行

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 路径遍历与远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 2.0.0 <= version <= 2.5.32, 6.0.0 <= version <= 6.3.0.1

**利用条件:** 需要应用程序存在文件上传功能，并且使用了受影响的Apache Struts版本。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-50164 是 Apache Struts 2 中的一个严重漏洞，允许攻击者通过操纵文件上传参数来执行路径遍历，在某些情况下，这可能导致上传恶意文件，进而实现远程代码执行。

**漏洞分析：**
根据漏洞库信息和搜索结果，该漏洞源于 Apache Struts 在处理文件上传时对路径的验证不足。攻击者可以构造包含路径遍历字符（如`../`）的文件名或路径，从而绕过安全检查，将文件上传到服务器上的任意位置。

**POC有效性：**
提供的POC代码是一个Go程序，它通过以下步骤利用该漏洞：

1.  **WAR文件创建：** 将目标文件压缩成WAR文件， WAR文件相当于一个web项目，里面存放这web项目会执行的jsp等。
2.  **路径检查：** 检查目标路径是否已存在，如果存在则退出。
3.  **文件上传：** 通过修改文件上传参数，尝试将WAR文件上传到目标服务器。
4.  **验证：** 检查上传的文件是否可以通过HTTP访问，以确认上传是否成功。

根据搜索结果和POC代码，该漏洞的利用方式是有效的。多个安全厂商和研究人员已经确认了该漏洞的存在并发布了相关的PoC。

**投毒风险分析：**
查看提供的PoC代码，主要代码功能都集中在利用漏洞本身，没有发现明显的恶意代码或后门。该POC的主要流程是：

1.  生成WAR文件
2.  发送Payload进行攻击
3.  验证Payload是否上传成功

但是，仍然存在一些潜在的投毒风险：

1.  **依赖风险：** 该PoC依赖一些第三方Go模块，这些模块可能存在安全漏洞或被恶意篡改。
2.  **编译风险：** 用户在编译PoC代码时，可能会引入恶意代码。
3.  **参数篡改：** 使用者可能会在使用PoC时修改参数，导致上传的文件包含恶意代码。

总的来说，该PoC代码本身没有明显的投毒代码，但仍然存在一些潜在的风险，需要用户在使用时保持警惕。因此，将投毒风险评估为5%。

**利用方式：**

1.  攻击者构造包含恶意代码（如JSP webshell）的文件。
2.  攻击者使用PoC工具，通过修改文件上传参数，将恶意文件上传到服务器的web目录或其他敏感位置。
3.  攻击者通过访问上传的恶意文件，执行其中的恶意代码，从而控制服务器。

**缓解措施：**

1.  升级到Apache Struts 2.5.33 或 6.3.0.2 或更高版本。
2.  对文件上传进行严格的路径验证和过滤。
3.  限制上传文件的类型。
4.  使用Web应用防火墙（WAF）来检测和阻止恶意文件上传请求。

**项目地址:** [dwisiswant0/cve-2023-50164-poc](https://github.com/dwisiswant0/cve-2023-50164-poc)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #10

**来源**: [CVE-2023-50164-helsecert_cve-2023-50164.md](../2023/CVE-2023-50164-helsecert_cve-2023-50164.md)

## CVE-2023-50164 - Apache Struts 文件上传目录遍历导致远程代码执行

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 2.0.0 <= Struts <= 2.5.32, 6.0.0 <= Struts <= 6.3.0.1

**利用条件:** 需要应用存在文件上传功能，且使用了存在漏洞的Struts版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 是 Apache Struts 2 的一个严重漏洞，攻击者可以操纵文件上传参数来实现路径遍历，在某些情况下，这会导致上传恶意文件，最终实现远程代码执行。

**有效性评估：**
根据漏洞库信息，搜索引擎结果以及漏洞利用代码，该漏洞是一个已确认且被广泛讨论的漏洞。大量安全厂商和研究人员都发布了关于此漏洞的分析和利用报告，证明了其有效性。同时，CISA 将其列为已知被利用的漏洞 (KEV)。

**投毒风险评估：**
提供的漏洞利用代码仓库包含用于查找系统中存在漏洞 Struts 2 应用程序的脚本，这些脚本本身不是漏洞利用代码，而是辅助工具。因此，直接的投毒风险较低，但是存在以下潜在风险：

*   **信息泄露：** 扫描脚本可能会泄露系统中的应用信息，如果攻击者获取这些信息，可能会用于进一步的攻击。
*   **误报：** 脚本可能存在误报，导致安全人员投入不必要的精力。
*   **扫描行为：** 频繁的扫描行为可能被认为是恶意行为，从而触发安全警报。

该仓库的主要作用是协助定位受影响的系统，而不是直接进行漏洞利用，因此，投毒风险较低，估计为 10%。 主要是考虑到脚本可能存在一些隐藏的逻辑，用于收集信息或进行其他恶意行为，但可能性较小。

**利用方式分析：**

1.  **路径遍历：** 攻击者通过修改文件上传请求中的参数（例如文件名），构造包含 `../` 的路径，从而突破上传目录的限制，将文件上传到任意位置。
2.  **恶意文件上传：** 攻击者上传包含恶意代码的文件，例如 JSP webshell。由于可以控制文件上传的位置，攻击者可以将恶意文件上传到 Web 服务器的可执行目录下。
3.  **远程代码执行：** 攻击者通过访问上传的恶意文件，触发其中的恶意代码，最终实现远程代码执行。

**缓解措施：**

*   升级到 Struts 2.5.33 或 6.3.0.2 或更高版本。
*   实施严格的文件上传验证，包括文件名、文件类型和文件大小的验证。
*   配置 Web 服务器，限制文件上传目录的执行权限。

**项目地址:** [helsecert/cve-2023-50164](https://github.com/helsecert/cve-2023-50164)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #11

**来源**: [CVE-2023-50164-hybinn_CVE-2023-50164.md](../2023/CVE-2023-50164-hybinn_CVE-2023-50164.md)

## CVE-2023-50164 Apache Struts 文件上传目录遍历漏洞

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 文件上传目录遍历

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0.0 <= version <= 2.5.32 和 6.0.0 <= version <= 6.3.0.1

**利用条件:** 应用程序使用受影响版本的Apache Struts，且存在文件上传功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 是 Apache Struts 框架中的一个文件上传漏洞，允许攻击者通过操纵文件上传参数实现目录遍历。在特定情况下，这可能导致上传恶意文件，进而执行远程代码。

**有效性：**
根据漏洞库信息和通常的文件上传漏洞利用方式，攻击者可以通过修改上传文件的路径参数（例如，文件名或路径字段）来突破文件上传的限制，将文件上传到服务器上的任意位置。如果上传的文件是可执行文件（例如，JSP、Servlet等），攻击者可以通过访问该文件来执行恶意代码，从而实现远程代码执行。
提供的POC代码`/tmp/51e0f4d2bf9d641c1230687a807c0d75/README.md`仅仅包含 `# CVE-2023-50164`，表明只是漏洞声明，没有实际利用代码. 因此，需要构造专门的请求来利用此漏洞。目前给出的代码无法验证漏洞。

**投毒风险：**
提供的POC代码仅为一个 README.md 文件，内容仅包含漏洞编号，没有包含任何可执行代码。因此投毒风险较低，可以认为几乎不存在投毒代码。 但不能排除该仓库的作者在其他分支或后续提交中添加恶意代码的可能性。因此将投毒风险设置为10%。

**利用方式：**
1.  攻击者构造包含目录遍历payload的文件上传请求。Payload 通常会修改文件上传路径参数，例如使用 `../../` 这样的序列来跳出预定的上传目录。
2.  Struts框架在处理文件上传请求时，如果未对文件路径进行充分验证和清理，会将文件上传到攻击者指定的目录。
3.  攻击者上传包含恶意代码的文件（例如，JSP脚本），并将其上传到Web服务器的可执行目录下。
4.  攻击者通过Web浏览器访问上传的恶意文件，触发恶意代码的执行，从而实现远程代码执行。

**项目地址:** [hybinn/CVE-2023-50164](https://github.com/hybinn/CVE-2023-50164)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #12

**来源**: [CVE-2023-50164-jakabakos_CVE-2023-50164-Apache-Struts-RCE.md](../2023/CVE-2023-50164-jakabakos_CVE-2023-50164-Apache-Struts-RCE.md)

## CVE-2023-50164-Apache Struts文件上传路径遍历导致RCE

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0.0 <= Struts <= 2.5.32 和 6.0.0 <= Struts <= 6.3.0.1

**利用条件:** 需要存在文件上传功能，且应用部署在支持WAR部署的环境，如Tomcat

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 是 Apache Struts 中的一个关键漏洞，攻击者可以通过操纵文件上传参数实现路径遍历。在特定情况下，这可能导致上传恶意文件，进而实现远程代码执行 (RCE)。

**有效性评估：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞的PoC代码有效。漏洞库和搜索结果均表明这是一个严重的安全漏洞，并存在公开可用的PoC。

**投毒风险评估：**

分析提供的PoC代码（README.md 和 Vagrantfile），主要的风险点较低：

*   `README.md`:  该文件详细描述了漏洞和PoC的用法，并包含免责声明，表明其目的是用于研究和防御目的。
*   `Vagrantfile`:  该文件用于创建用于测试的环境，使用 `generic/debian12` 作为基础镜像，并配置了一个私有网络，IP 地址为 `192.168.56.25`。虽然 Vagrantfile 可以执行任意命令，但是目前文件中的命令都是常规配置，用于搭建测试环境。

尽管如此，所有来自第三方的代码都应谨慎对待。该仓库本身结构比较简单，主要功能代码应该在 `exploit.py` (未提供) 文件中。如果没有代码审计`exploit.py`, 不能完全排除隐蔽的恶意代码的可能性。综合评估，投毒风险较低，大约为10%。主要风险可能存在于`exploit.py` 中，例如在上传的webshell中添加后门，或者利用路径遍历写入恶意配置文件。但是鉴于PoC作者已经声明目的为研究，且相关信息比较透明，恶意投毒的可能性相对较低。

**利用方式分析：**

1.  **路径遍历：** 攻击者通过修改文件上传的参数，构造包含 `../` 的路径，突破文件上传的目录限制，实现任意文件写入。
2.  **Webshell 上传：** 攻击者利用路径遍历，将包含恶意代码的 Webshell 文件上传到 Web 服务器的可执行目录下。
3.  **远程代码执行：** 攻击者通过访问上传的 Webshell 文件，执行恶意代码，从而控制服务器。

根据PoC的描述，利用方式需要应用部署在类似Tomcat这样的服务器上，通过上传WAR包形式的Webshell来实现利用。



**项目地址:** [jakabakos/CVE-2023-50164-Apache-Struts-RCE](https://github.com/jakabakos/CVE-2023-50164-Apache-Struts-RCE)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #13

**来源**: [CVE-2023-50164-minhbao15677_CVE-2023-50164.md](../2023/CVE-2023-50164-minhbao15677_CVE-2023-50164.md)

## CVE-2023-50164: Apache Struts 文件上传路径遍历导致RCE漏洞

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 文件上传路径遍历导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致任意文件上传和远程代码执行

**影响版本:** 2.0.0 <= Struts <= 2.5.32, 6.0.0 <= Struts <= 6.3.0.1

**利用条件:** 需要 Struts 应用存在文件上传功能，且应用使用了 ActionSupport 类。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 是 Apache Struts 2 中的一个严重漏洞，允许攻击者通过操纵文件上传参数来执行路径遍历。在某些情况下，这可能导致上传恶意文件，进而执行远程代码。根据漏洞信息，该漏洞的CVSS评分为9.8，表明其严重性。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者可以修改文件上传请求中的参数，利用 `..` 等路径遍历字符，突破上传目录的限制，将文件上传到服务器上的任意位置。
2.  **恶意文件上传：** 通过路径遍历，攻击者可以将包含恶意代码的文件（例如 JSP 文件、Servlet 文件等）上传到 Web 容器的可执行目录下。
3.  **远程代码执行 (RCE)：** 一旦恶意文件被上传到可执行目录，攻击者可以通过访问该文件来触发恶意代码的执行，从而实现远程代码执行。

**POC有效性评估：**

提供的漏洞利用代码是一个简单的说明文档，描述了如何搭建调试环境以及分析漏洞。该文档本身**不是完整的可直接运行的POC**，但它指明了漏洞利用的方向，可以辅助安全研究人员或攻击者复现漏洞。

虽然这里提供的POC只有搭建环境说明，但是参考搜索结果，网上已存在公开的POC，因此可以认为此漏洞利用是有效的。

**投毒风险分析：**

由于提供的漏洞利用代码只是一个README.md文件，描述了搭建调试环境的步骤和漏洞分析的简要说明。该文件本身不包含可执行代码，因此，**该文件本身投毒的可能性非常低。**

但是,考虑到黑客攻击的复杂性，不排除作者在搭建环境过程中，通过其他方式进行投毒的可能性。所以，我个人认为投毒风险为10%。需要进一步分析才能给出更精确的评估。

**总结：**

CVE-2023-50164 是一个高危漏洞，攻击者可以利用该漏洞实现任意文件上传和远程代码执行。建议受影响的用户尽快升级到 Struts 2.5.33 或 Struts 6.3.0.2 或更高版本。

**项目地址:** [minhbao15677/CVE-2023-50164](https://github.com/minhbao15677/CVE-2023-50164)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #14

**来源**: [CVE-2023-50164-snyk-labs_CVE-2023-50164-POC.md](../2023/CVE-2023-50164-snyk-labs_CVE-2023-50164-POC.md)

## CVE-2023-50164-Apache Struts-路径遍历/远程代码执行

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 2.0.0 <= version <= 2.5.32
6.0.0 <= version <= 6.3.0.1

**利用条件:** 需要目标系统使用存在漏洞的Apache Struts版本，且存在文件上传功能。需要网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-50164是Apache Struts中的一个严重漏洞，允许攻击者操纵文件上传参数以实现路径遍历。在某些情况下，这可能导致上传恶意文件，从而导致远程代码执行（RCE）。

**漏洞利用有效性：**
根据漏洞库信息、搜索结果，该漏洞利用POC已公开，且已被观察到实际利用。

**投毒风险：**
提供的漏洞利用代码只是Apache License 2.0的license文件,无任何攻击代码,可以确定不存在投毒。

**利用方式：**
1.  **路径遍历：** 攻击者通过修改文件上传的参数，例如文件名，使其包含路径遍历字符（如`../`），从而能够将文件上传到服务器上的任意位置。
2.  **恶意文件上传：** 攻击者上传一个包含恶意代码的文件，例如JSP文件或者其他类型的可执行文件。
3.  **远程代码执行：** 攻击者通过访问上传的恶意文件，触发其中的恶意代码，从而在服务器上执行任意命令。

**缓解措施：**
*   升级到Struts 2.5.33或Struts 6.3.0.2或更高版本。
*   实施严格的文件上传验证，包括文件名检查、文件类型检查和文件大小限制。
*   配置Web服务器，限制对上传目录的访问权限。


**项目地址:** [snyk-labs/CVE-2023-50164-POC](https://github.com/snyk-labs/CVE-2023-50164-POC)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #15

**来源**: [CVE-2023-50164-sunnyvale-it_CVE-2023-50164-PoC.md](../2023/CVE-2023-50164-sunnyvale-it_CVE-2023-50164-PoC.md)

## CVE-2023-50164-Apache Struts文件上传路径遍历导致RCE

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 文件上传路径遍历导致RCE

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0.0 - 2.5.32, 6.0.0 - 6.3.0.1

**利用条件:** 需要存在文件上传功能且使用受影响的Apache Struts版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164是Apache Struts 2中的一个文件上传漏洞，攻击者可以通过操纵文件上传参数，实现路径遍历，最终上传恶意文件并执行远程代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8，属于高危漏洞。漏洞利用代码中的Dockerfile构建了一个包含Struts2应用程序的Tomcat环境，pom.xml文件指定了存在漏洞的Struts2版本。README.md提供了构建和运行PoC的步骤，以及执行任意命令的示例。利用方式是通过构造恶意的上传请求，将webshell.jsp上传到服务器的webshell目录下，然后通过访问该webshell执行任意命令。POC存在一定投毒风险，虽然主要代码是用来验证漏洞的，但是webshell本身就具有潜在的危险，如果攻击者修改了Dockerfile或者exploit.sh，可能会引入恶意的行为。风险评估基于webshell本身的风险和修改PoC引入恶意代码的潜在可能。

**有效性：** 提供的POC代码是有效的，它成功地演示了CVE-2023-50164漏洞的利用。

**投毒风险：** 存在一定的投毒风险，约为10%。 主要风险点在于：
   1. Dockerfile中的基础镜像可能被替换为包含恶意软件的版本。
   2. exploit.sh脚本可能被修改为执行额外的恶意操作。
   3. webshell.jsp本身可能包含隐藏的后门或恶意代码。

**利用方式：**
   1. 攻击者构造包含恶意路径的文件上传请求。攻击请求中包含了目录遍历的payload，例如：filename="../../../../tmp/shell.jsp"
   2. Struts2应用解析请求，由于漏洞存在，允许将文件上传到任意目录。
   3. 攻击者上传一个webshell（如JSP脚本），该webshell允许执行任意系统命令。
   4. 攻击者通过访问上传的webshell，执行恶意代码，实现远程代码执行。

**搜索引擎结果摘要：** 多个来源确认了CVE-2023-50164是一个高危漏洞，并且已经出现了公开的PoC。漏洞允许攻击者通过文件上传参数操纵实现路径遍历，从而导致远程代码执行。

**项目地址:** [sunnyvale-it/CVE-2023-50164-PoC](https://github.com/sunnyvale-it/CVE-2023-50164-PoC)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---



---

## POC #4

**来源**: [CVE-2023-50164-Pixel-DefaultBR_CVE-2023-50164.md](../2023/CVE-2023-50164-Pixel-DefaultBR_CVE-2023-50164.md)

## CVE-2023-50164 - Apache Struts 文件上传路径遍历与远程代码执行

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 文件上传路径遍历与远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器文件泄露，任意文件上传与远程代码执行

**影响版本:** 2.0.0 <= version <= 2.5.32, 6.0.0 <= version <= 6.3.0.1

**利用条件:** 目标系统使用存在漏洞的Apache Struts版本，且存在文件上传功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 存在于 Apache Struts 的文件上传组件中。攻击者可以操纵文件上传参数，利用路径遍历漏洞上传恶意文件，最终导致远程代码执行。

**有效性分析：**

漏洞库信息、搜索引擎结果和提供的漏洞利用代码均表明该漏洞是真实存在的，并且存在公开可用的PoC。 Akamai Security Intelligence Group的报告表明，自漏洞公开以来，已经观察到大量的利用尝试。PoC代码中包含上传PNG图片头和WebShell代码，允许攻击者上传恶意JSP文件。

**投毒风险分析：**

PoC代码中，`exploit.py` 脚本主要功能是构造包含恶意JSP WebShell 的PNG文件，并利用路径穿越漏洞上传到服务器，从而实现远程代码执行。`README.md` 声明该exp仅用于 HackTheBox 实验环境。上传后的JSP WebShell，本身就是攻击payload，风险在于被滥用进行非法渗透测试。投毒风险较低，估计在10%左右。

**利用方式：**

1.  **路径遍历：** 攻击者通过修改上传文件的参数（例如文件名），在文件名中添加`../`等路径遍历字符，使得上传的文件可以被写入到Web服务器的任意目录中。
2.  **恶意文件上传：** 攻击者上传包含恶意代码的文件，例如JSP WebShell。通常会伪装成图片文件（例如PNG），绕过一些基本的上传检查。
3.  **远程代码执行：** 攻击者通过访问上传的恶意文件，触发其中的恶意代码，从而在Web服务器上执行任意命令。

根据提供的利用代码, 漏洞利用包含以下步骤：
    *构造包含PNG文件头的JSP WebShell。
    *通过修改multipart/form-data的boundary来绕过一些WAF的检测。
    *将恶意文件上传到服务器。
    *通过访问上传的文件来执行命令。

**项目地址:** [Pixel-DefaultBR/CVE-2023-50164](https://github.com/Pixel-DefaultBR/CVE-2023-50164)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #5

**来源**: [CVE-2023-50164-Thirukrishnan_CVE-2023-50164-Apache-Struts-RCE.md](../2023/CVE-2023-50164-Thirukrishnan_CVE-2023-50164-Apache-Struts-RCE.md)

## CVE-2023-50164-Apache Struts-RCE

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.0.0 <= Struts <= 2.5.32 或 6.0.0 <= Struts <= 6.3.0.1

**利用条件:** 需要目标系统运行存在漏洞的Apache Struts版本，并且存在文件上传功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164是一个Apache Struts框架中的文件上传漏洞，攻击者可以通过操纵文件上传参数，实现路径遍历，进而上传恶意文件，最终导致远程代码执行。根据搜索引擎结果（例如，Arctic Wolf的博客），已经存在公开的PoC被利用。提供的漏洞利用代码包含一个Dockerfile，用于构建包含漏洞Struts应用的环境。Dockerfile中：

1.  安装了OpenJDK 17和必要的工具（wget, curl）。
2.  下载并配置了存在漏洞的Tomcat 9.0.83。
3.  下载并部署了一个名为"upload-1.0.0.war"的包含漏洞的WAR文件，该文件来自GitHub仓库[https://github.com/Thirukrishnan/CVE-2023-50164-Apache-Struts-RCE/raw/main/upload-1.0.0.war]。这个WAR文件是专门为复现这个漏洞设计的。
4. 暴露了8080端口，用于访问Tomcat服务器。

**有效性：** 提供的Dockerfile和WAR文件可以有效复现CVE-2023-50164漏洞，搭建一个存在漏洞的环境。

**投毒风险：** 虽然整体代码是为了复现漏洞，但存在轻微的投毒风险，原因如下：
*   Dockerfile直接从GitHub下载WAR文件，这依赖于外部资源的可信度。如果GitHub上的WAR文件被篡改，那么构建的镜像也会包含恶意代码。这种风险的百分比估计为10%，因为原作者可能已经做了验证措施,或者github代码库本身有安全保护措施.

**利用方式：**

1.  攻击者利用路径遍历漏洞，通过修改文件上传参数，将恶意文件上传到服务器的任意目录。
2.  上传的文件通常是包含恶意代码的JSP或WAR文件。
3.  攻击者通过访问上传的恶意文件，触发恶意代码，从而实现远程代码执行。
4. 具体而言，通过修改上传的文件名参数，例如`filename="../../../../tmp/shell.jsp"`，可以将文件上传到/tmp目录下。然后，访问`http://ip-address:port/tmp/shell.jsp`即可执行其中的代码。利用方式详细信息见参考链接中的相关分析。


**项目地址:** [Thirukrishnan/CVE-2023-50164-Apache-Struts-RCE](https://github.com/Thirukrishnan/CVE-2023-50164-Apache-Struts-RCE)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #6

**来源**: [CVE-2023-50164-Trackflaw_CVE-2023-50164-ApacheStruts2-Docker.md](../2023/CVE-2023-50164-Trackflaw_CVE-2023-50164-ApacheStruts2-Docker.md)

## CVE-2023-50164-Apache Struts-文件上传路径穿越导致RCE

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 文件上传路径穿越

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0.0 <= version <= 2.5.32 和 6.0.0 <= version <= 6.3.0.1

**利用条件:** 需要目标系统存在文件上传功能并且使用受影响的 Apache Struts 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 是 Apache Struts 2 中的一个严重漏洞，允许攻击者通过操纵文件上传参数来执行路径遍历攻击。如果应用程序存在缺陷，攻击者可以上传恶意文件，从而导致远程代码执行(RCE)。

**有效性：**

提供的 Dockerfile 旨在构建一个易受攻击的 Apache Struts 2 环境，用于演示 CVE-2023-50164。它包含构建和运行 Struts 应用程序所需的步骤。通过构建和运行这个 Docker 镜像，研究人员和安全专业人员可以安全地研究和利用此漏洞。

**投毒风险：**

在提供的文件中，`/tmp/c76c54a0ed5cbc2c09e0533b7830ced8/tomcat-users.xml` 文件包含一个具有预定义用户名“admin”和密码“trackflaw”的 Tomcat 管理员用户。虽然这允许轻松访问 Tomcat 管理界面以进行漏洞利用，但它也引入了投毒风险，如果这个配置被用于生产环境，攻击者可以通过默认凭据控制 Tomcat 服务器。此外，由于 `README.md` 文件中指出“The weaponized exploit code is not supplied.”，这意味着该仓库不包含直接利用漏洞的完整exp，用户需要自行编写利用代码，也增加了一定的投毒可能性，比如引导用户访问恶意网站或者下载包含恶意代码的exp。综合考虑，投毒风险相对较低，估计为10%。

**利用方式：**

根据漏洞库信息和搜索结果，漏洞利用方式如下：

1.  **路径遍历：** 攻击者通过修改文件上传请求中的参数，例如文件名，使其包含路径遍历字符（如 `../`），从而突破文件上传目录的限制。
2.  **恶意文件上传：**  通过路径遍历，攻击者可以将恶意文件上传到服务器上任意可写目录，例如 Web 应用程序的根目录或其他包含可执行脚本的目录。
3.  **远程代码执行 (RCE)：** 上传的恶意文件可以是包含恶意代码的 JSP 文件、Shell 脚本或其他服务器能够执行的文件。一旦该文件被服务器执行，攻击者就可以在服务器上执行任意命令，从而实现远程代码执行。

**项目地址:** [Trackflaw/CVE-2023-50164-ApacheStruts2-Docker](https://github.com/Trackflaw/CVE-2023-50164-ApacheStruts2-Docker)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #7

**来源**: [CVE-2023-50164-aaronm-sysdig_cve-2023-50164.md](../2023/CVE-2023-50164-aaronm-sysdig_cve-2023-50164.md)

## CVE-2023-50164 - Apache Struts 文件上传路径遍历导致远程代码执行

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** 2.0.0 <= version <= 2.5.32, 6.0.0 <= version <= 6.3.0.1

**利用条件:** 存在文件上传功能，且使用了受影响的Struts版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 是 Apache Struts 2 中的一个严重漏洞，攻击者可以通过操纵文件上传参数来利用路径遍历漏洞，在特定情况下，这可能导致上传恶意文件，从而执行远程代码。

**有效性评估：**
根据漏洞库信息和搜索引擎结果，该漏洞已被公开披露，并且存在公开可用的PoC（Proof of Concept）利用代码。提供的代码仓库包含了一个简单的 Struts 2 应用，用于演示漏洞检测。虽然代码本身只是一个演示，但基于已公开的信息和 PoC 的存在，可以判定该漏洞是有效的。

**投毒风险分析：**
提供的代码仓库主要包含以下文件：
*   Dockerfile：用于构建包含 Struts 2 应用的 Docker 镜像。
*   README.md：项目介绍。
*   java-deployment.yaml：Kubernetes 部署文件。
*   pom.xml：Maven 项目配置文件，声明 Struts 2 依赖。
*   src/main/webapp/hello.jsp：JSP 页面。
*   src/main/webapp/WEB-INF/web.xml：Web 应用配置文件。
*   src/main/resources/struts.xml：Struts 配置文件。
*   src/main/java/com/example/HelloAction.java：Struts Action 类。

代码库本身似乎是为了演示漏洞检测而构建的，作者声明Sysdig不对代码提供任何保证。虽然该项目的目的是好的，但是代码仓库中的 `java-deployment.yaml` 文件中 `image: placeholder`，这意味着需要用户手动替换镜像，如果用户替换成包含恶意代码的镜像，那么该项目就会被投毒；其次该项目仓库中使用的是struts2-core 2.5.22版本，该版本已经受到影响，如果被攻击者修改struts.xml等配置文件，放入恶意代码，也会导致投毒。考虑到作者的免责声明，并且代码仓库本身的结构更偏向于演示目的，投毒的可能性较低，大约为 10%。

**利用方式：**
1.  **路径遍历：** 攻击者通过修改文件上传请求中的参数（例如，文件名），使其包含 `../` 等路径遍历字符。
2.  **恶意文件上传：** 攻击者利用路径遍历将恶意文件上传到 Web 服务器的可执行目录下，例如 Web 应用的根目录或 Tomcat 的 webapps 目录。
3.  **远程代码执行：** 攻击者访问上传的恶意文件，触发服务器执行其中的代码，从而实现远程代码执行。

简而言之，利用方式的核心在于利用路径遍历上传一个可执行的文件，例如包含恶意代码的 JSP 文件或者 Servlet，然后通过访问该文件来触发恶意代码的执行。

**项目地址:** [aaronm-sysdig/cve-2023-50164](https://github.com/aaronm-sysdig/cve-2023-50164)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #8

**来源**: [CVE-2023-50164-bcdannyboy_CVE-2023-50164.md](../2023/CVE-2023-50164-bcdannyboy_CVE-2023-50164.md)

## CVE-2023-50164 - Apache Struts 文件上传路径遍历导致远程代码执行

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 2.0.0 <= Struts <= 2.5.32 或 6.0.0 <= Struts <= 6.3.0.1

**利用条件:** 需要目标系统存在文件上传功能，并且该功能受到Struts框架处理。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-50164是Apache Struts 2中的一个文件上传漏洞。攻击者可以操纵文件上传参数，实现路径遍历，进而上传恶意文件，最终可能导致远程代码执行。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8，属于高危漏洞，并且已经存在公开的PoC。

**有效性：**
提供的PoC代码尝试通过修改multipart/form-data请求中的文件名参数，利用路径遍历漏洞，将上传的文件写入到任意位置。它通过上传一个包含 "SUCCESSFULLY EXPLOITED CVE-2023-50164" 字符串的benign.txt文件来验证漏洞的存在。PoC需要用户提供目标URL，上传变量名，文件名变量名和payload路径，这表明漏洞的利用具有一定的环境依赖性。
从搜索结果来看, 存在公开可利用的EXP, 已经有被利用的尝试,可以判断此漏洞利用的有效性很高.

**投毒风险：**
PoC代码本身的功能是上传一个包含特定字符串的benign.txt文件，以验证漏洞是否存在。 虽然PoC允许用户指定任意payload路径，但上传的文件内容是预定义的，相对安全，风险较低。 即使恶意用户指定了系统关键文件路径，覆盖的内容也是无害的，不会直接导致系统崩溃或者执行恶意代码。 此外， PoC需要用户指定uploadVar和filenameVar，也需要用户提供payloadPath，增加了利用的难度，降低了被恶意使用的可能性。PoC上传的文件内容是固定的，不包含任何可执行代码，因此直接被用作恶意软件的可能性较低。综合来看，该PoC代码的投毒风险较低，估计约为1%。

**利用方式：**
1.  攻击者首先需要确定目标系统使用的Struts版本在受影响范围内 (2.0.0 <= Struts <= 2.5.32 或 6.0.0 <= Struts <= 6.3.0.1)。
2.  攻击者需要找到目标系统存在文件上传功能的地方，并分析上传请求的参数，确定`uploadVar`（上传文件的变量名）和 `filenameVar`（上传文件名的变量名）。
3.  利用PoC脚本，通过修改`filenameVar`参数，构造包含路径遍历的payload，例如`../../../../tmp/benign.txt`，将benign.txt上传到指定位置。
4.  如果上传成功，则说明漏洞存在。攻击者可以修改PoC，上传包含恶意代码的payload文件，例如webshell，从而控制目标服务器。

**项目地址:** [bcdannyboy/CVE-2023-50164](https://github.com/bcdannyboy/CVE-2023-50164)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #9

**来源**: [CVE-2023-50164-dwisiswant0_cve-2023-50164-poc.md](../2023/CVE-2023-50164-dwisiswant0_cve-2023-50164-poc.md)

## CVE-2023-50164-Apache Struts-路径遍历与远程代码执行

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 路径遍历与远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 2.0.0 <= version <= 2.5.32, 6.0.0 <= version <= 6.3.0.1

**利用条件:** 需要应用程序存在文件上传功能，并且使用了受影响的Apache Struts版本。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-50164 是 Apache Struts 2 中的一个严重漏洞，允许攻击者通过操纵文件上传参数来执行路径遍历，在某些情况下，这可能导致上传恶意文件，进而实现远程代码执行。

**漏洞分析：**
根据漏洞库信息和搜索结果，该漏洞源于 Apache Struts 在处理文件上传时对路径的验证不足。攻击者可以构造包含路径遍历字符（如`../`）的文件名或路径，从而绕过安全检查，将文件上传到服务器上的任意位置。

**POC有效性：**
提供的POC代码是一个Go程序，它通过以下步骤利用该漏洞：

1.  **WAR文件创建：** 将目标文件压缩成WAR文件， WAR文件相当于一个web项目，里面存放这web项目会执行的jsp等。
2.  **路径检查：** 检查目标路径是否已存在，如果存在则退出。
3.  **文件上传：** 通过修改文件上传参数，尝试将WAR文件上传到目标服务器。
4.  **验证：** 检查上传的文件是否可以通过HTTP访问，以确认上传是否成功。

根据搜索结果和POC代码，该漏洞的利用方式是有效的。多个安全厂商和研究人员已经确认了该漏洞的存在并发布了相关的PoC。

**投毒风险分析：**
查看提供的PoC代码，主要代码功能都集中在利用漏洞本身，没有发现明显的恶意代码或后门。该POC的主要流程是：

1.  生成WAR文件
2.  发送Payload进行攻击
3.  验证Payload是否上传成功

但是，仍然存在一些潜在的投毒风险：

1.  **依赖风险：** 该PoC依赖一些第三方Go模块，这些模块可能存在安全漏洞或被恶意篡改。
2.  **编译风险：** 用户在编译PoC代码时，可能会引入恶意代码。
3.  **参数篡改：** 使用者可能会在使用PoC时修改参数，导致上传的文件包含恶意代码。

总的来说，该PoC代码本身没有明显的投毒代码，但仍然存在一些潜在的风险，需要用户在使用时保持警惕。因此，将投毒风险评估为5%。

**利用方式：**

1.  攻击者构造包含恶意代码（如JSP webshell）的文件。
2.  攻击者使用PoC工具，通过修改文件上传参数，将恶意文件上传到服务器的web目录或其他敏感位置。
3.  攻击者通过访问上传的恶意文件，执行其中的恶意代码，从而控制服务器。

**缓解措施：**

1.  升级到Apache Struts 2.5.33 或 6.3.0.2 或更高版本。
2.  对文件上传进行严格的路径验证和过滤。
3.  限制上传文件的类型。
4.  使用Web应用防火墙（WAF）来检测和阻止恶意文件上传请求。

**项目地址:** [dwisiswant0/cve-2023-50164-poc](https://github.com/dwisiswant0/cve-2023-50164-poc)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #10

**来源**: [CVE-2023-50164-helsecert_cve-2023-50164.md](../2023/CVE-2023-50164-helsecert_cve-2023-50164.md)

## CVE-2023-50164 - Apache Struts 文件上传目录遍历导致远程代码执行

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 2.0.0 <= Struts <= 2.5.32, 6.0.0 <= Struts <= 6.3.0.1

**利用条件:** 需要应用存在文件上传功能，且使用了存在漏洞的Struts版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 是 Apache Struts 2 的一个严重漏洞，攻击者可以操纵文件上传参数来实现路径遍历，在某些情况下，这会导致上传恶意文件，最终实现远程代码执行。

**有效性评估：**
根据漏洞库信息，搜索引擎结果以及漏洞利用代码，该漏洞是一个已确认且被广泛讨论的漏洞。大量安全厂商和研究人员都发布了关于此漏洞的分析和利用报告，证明了其有效性。同时，CISA 将其列为已知被利用的漏洞 (KEV)。

**投毒风险评估：**
提供的漏洞利用代码仓库包含用于查找系统中存在漏洞 Struts 2 应用程序的脚本，这些脚本本身不是漏洞利用代码，而是辅助工具。因此，直接的投毒风险较低，但是存在以下潜在风险：

*   **信息泄露：** 扫描脚本可能会泄露系统中的应用信息，如果攻击者获取这些信息，可能会用于进一步的攻击。
*   **误报：** 脚本可能存在误报，导致安全人员投入不必要的精力。
*   **扫描行为：** 频繁的扫描行为可能被认为是恶意行为，从而触发安全警报。

该仓库的主要作用是协助定位受影响的系统，而不是直接进行漏洞利用，因此，投毒风险较低，估计为 10%。 主要是考虑到脚本可能存在一些隐藏的逻辑，用于收集信息或进行其他恶意行为，但可能性较小。

**利用方式分析：**

1.  **路径遍历：** 攻击者通过修改文件上传请求中的参数（例如文件名），构造包含 `../` 的路径，从而突破上传目录的限制，将文件上传到任意位置。
2.  **恶意文件上传：** 攻击者上传包含恶意代码的文件，例如 JSP webshell。由于可以控制文件上传的位置，攻击者可以将恶意文件上传到 Web 服务器的可执行目录下。
3.  **远程代码执行：** 攻击者通过访问上传的恶意文件，触发其中的恶意代码，最终实现远程代码执行。

**缓解措施：**

*   升级到 Struts 2.5.33 或 6.3.0.2 或更高版本。
*   实施严格的文件上传验证，包括文件名、文件类型和文件大小的验证。
*   配置 Web 服务器，限制文件上传目录的执行权限。

**项目地址:** [helsecert/cve-2023-50164](https://github.com/helsecert/cve-2023-50164)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #11

**来源**: [CVE-2023-50164-hybinn_CVE-2023-50164.md](../2023/CVE-2023-50164-hybinn_CVE-2023-50164.md)

## CVE-2023-50164 Apache Struts 文件上传目录遍历漏洞

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 文件上传目录遍历

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0.0 <= version <= 2.5.32 和 6.0.0 <= version <= 6.3.0.1

**利用条件:** 应用程序使用受影响版本的Apache Struts，且存在文件上传功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 是 Apache Struts 框架中的一个文件上传漏洞，允许攻击者通过操纵文件上传参数实现目录遍历。在特定情况下，这可能导致上传恶意文件，进而执行远程代码。

**有效性：**
根据漏洞库信息和通常的文件上传漏洞利用方式，攻击者可以通过修改上传文件的路径参数（例如，文件名或路径字段）来突破文件上传的限制，将文件上传到服务器上的任意位置。如果上传的文件是可执行文件（例如，JSP、Servlet等），攻击者可以通过访问该文件来执行恶意代码，从而实现远程代码执行。
提供的POC代码`/tmp/51e0f4d2bf9d641c1230687a807c0d75/README.md`仅仅包含 `# CVE-2023-50164`，表明只是漏洞声明，没有实际利用代码. 因此，需要构造专门的请求来利用此漏洞。目前给出的代码无法验证漏洞。

**投毒风险：**
提供的POC代码仅为一个 README.md 文件，内容仅包含漏洞编号，没有包含任何可执行代码。因此投毒风险较低，可以认为几乎不存在投毒代码。 但不能排除该仓库的作者在其他分支或后续提交中添加恶意代码的可能性。因此将投毒风险设置为10%。

**利用方式：**
1.  攻击者构造包含目录遍历payload的文件上传请求。Payload 通常会修改文件上传路径参数，例如使用 `../../` 这样的序列来跳出预定的上传目录。
2.  Struts框架在处理文件上传请求时，如果未对文件路径进行充分验证和清理，会将文件上传到攻击者指定的目录。
3.  攻击者上传包含恶意代码的文件（例如，JSP脚本），并将其上传到Web服务器的可执行目录下。
4.  攻击者通过Web浏览器访问上传的恶意文件，触发恶意代码的执行，从而实现远程代码执行。

**项目地址:** [hybinn/CVE-2023-50164](https://github.com/hybinn/CVE-2023-50164)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #12

**来源**: [CVE-2023-50164-jakabakos_CVE-2023-50164-Apache-Struts-RCE.md](../2023/CVE-2023-50164-jakabakos_CVE-2023-50164-Apache-Struts-RCE.md)

## CVE-2023-50164-Apache Struts文件上传路径遍历导致RCE

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0.0 <= Struts <= 2.5.32 和 6.0.0 <= Struts <= 6.3.0.1

**利用条件:** 需要存在文件上传功能，且应用部署在支持WAR部署的环境，如Tomcat

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 是 Apache Struts 中的一个关键漏洞，攻击者可以通过操纵文件上传参数实现路径遍历。在特定情况下，这可能导致上传恶意文件，进而实现远程代码执行 (RCE)。

**有效性评估：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞的PoC代码有效。漏洞库和搜索结果均表明这是一个严重的安全漏洞，并存在公开可用的PoC。

**投毒风险评估：**

分析提供的PoC代码（README.md 和 Vagrantfile），主要的风险点较低：

*   `README.md`:  该文件详细描述了漏洞和PoC的用法，并包含免责声明，表明其目的是用于研究和防御目的。
*   `Vagrantfile`:  该文件用于创建用于测试的环境，使用 `generic/debian12` 作为基础镜像，并配置了一个私有网络，IP 地址为 `192.168.56.25`。虽然 Vagrantfile 可以执行任意命令，但是目前文件中的命令都是常规配置，用于搭建测试环境。

尽管如此，所有来自第三方的代码都应谨慎对待。该仓库本身结构比较简单，主要功能代码应该在 `exploit.py` (未提供) 文件中。如果没有代码审计`exploit.py`, 不能完全排除隐蔽的恶意代码的可能性。综合评估，投毒风险较低，大约为10%。主要风险可能存在于`exploit.py` 中，例如在上传的webshell中添加后门，或者利用路径遍历写入恶意配置文件。但是鉴于PoC作者已经声明目的为研究，且相关信息比较透明，恶意投毒的可能性相对较低。

**利用方式分析：**

1.  **路径遍历：** 攻击者通过修改文件上传的参数，构造包含 `../` 的路径，突破文件上传的目录限制，实现任意文件写入。
2.  **Webshell 上传：** 攻击者利用路径遍历，将包含恶意代码的 Webshell 文件上传到 Web 服务器的可执行目录下。
3.  **远程代码执行：** 攻击者通过访问上传的 Webshell 文件，执行恶意代码，从而控制服务器。

根据PoC的描述，利用方式需要应用部署在类似Tomcat这样的服务器上，通过上传WAR包形式的Webshell来实现利用。



**项目地址:** [jakabakos/CVE-2023-50164-Apache-Struts-RCE](https://github.com/jakabakos/CVE-2023-50164-Apache-Struts-RCE)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #13

**来源**: [CVE-2023-50164-minhbao15677_CVE-2023-50164.md](../2023/CVE-2023-50164-minhbao15677_CVE-2023-50164.md)

## CVE-2023-50164: Apache Struts 文件上传路径遍历导致RCE漏洞

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 文件上传路径遍历导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致任意文件上传和远程代码执行

**影响版本:** 2.0.0 <= Struts <= 2.5.32, 6.0.0 <= Struts <= 6.3.0.1

**利用条件:** 需要 Struts 应用存在文件上传功能，且应用使用了 ActionSupport 类。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 是 Apache Struts 2 中的一个严重漏洞，允许攻击者通过操纵文件上传参数来执行路径遍历。在某些情况下，这可能导致上传恶意文件，进而执行远程代码。根据漏洞信息，该漏洞的CVSS评分为9.8，表明其严重性。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者可以修改文件上传请求中的参数，利用 `..` 等路径遍历字符，突破上传目录的限制，将文件上传到服务器上的任意位置。
2.  **恶意文件上传：** 通过路径遍历，攻击者可以将包含恶意代码的文件（例如 JSP 文件、Servlet 文件等）上传到 Web 容器的可执行目录下。
3.  **远程代码执行 (RCE)：** 一旦恶意文件被上传到可执行目录，攻击者可以通过访问该文件来触发恶意代码的执行，从而实现远程代码执行。

**POC有效性评估：**

提供的漏洞利用代码是一个简单的说明文档，描述了如何搭建调试环境以及分析漏洞。该文档本身**不是完整的可直接运行的POC**，但它指明了漏洞利用的方向，可以辅助安全研究人员或攻击者复现漏洞。

虽然这里提供的POC只有搭建环境说明，但是参考搜索结果，网上已存在公开的POC，因此可以认为此漏洞利用是有效的。

**投毒风险分析：**

由于提供的漏洞利用代码只是一个README.md文件，描述了搭建调试环境的步骤和漏洞分析的简要说明。该文件本身不包含可执行代码，因此，**该文件本身投毒的可能性非常低。**

但是,考虑到黑客攻击的复杂性，不排除作者在搭建环境过程中，通过其他方式进行投毒的可能性。所以，我个人认为投毒风险为10%。需要进一步分析才能给出更精确的评估。

**总结：**

CVE-2023-50164 是一个高危漏洞，攻击者可以利用该漏洞实现任意文件上传和远程代码执行。建议受影响的用户尽快升级到 Struts 2.5.33 或 Struts 6.3.0.2 或更高版本。

**项目地址:** [minhbao15677/CVE-2023-50164](https://github.com/minhbao15677/CVE-2023-50164)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #14

**来源**: [CVE-2023-50164-snyk-labs_CVE-2023-50164-POC.md](../2023/CVE-2023-50164-snyk-labs_CVE-2023-50164-POC.md)

## CVE-2023-50164-Apache Struts-路径遍历/远程代码执行

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 2.0.0 <= version <= 2.5.32
6.0.0 <= version <= 6.3.0.1

**利用条件:** 需要目标系统使用存在漏洞的Apache Struts版本，且存在文件上传功能。需要网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-50164是Apache Struts中的一个严重漏洞，允许攻击者操纵文件上传参数以实现路径遍历。在某些情况下，这可能导致上传恶意文件，从而导致远程代码执行（RCE）。

**漏洞利用有效性：**
根据漏洞库信息、搜索结果，该漏洞利用POC已公开，且已被观察到实际利用。

**投毒风险：**
提供的漏洞利用代码只是Apache License 2.0的license文件,无任何攻击代码,可以确定不存在投毒。

**利用方式：**
1.  **路径遍历：** 攻击者通过修改文件上传的参数，例如文件名，使其包含路径遍历字符（如`../`），从而能够将文件上传到服务器上的任意位置。
2.  **恶意文件上传：** 攻击者上传一个包含恶意代码的文件，例如JSP文件或者其他类型的可执行文件。
3.  **远程代码执行：** 攻击者通过访问上传的恶意文件，触发其中的恶意代码，从而在服务器上执行任意命令。

**缓解措施：**
*   升级到Struts 2.5.33或Struts 6.3.0.2或更高版本。
*   实施严格的文件上传验证，包括文件名检查、文件类型检查和文件大小限制。
*   配置Web服务器，限制对上传目录的访问权限。


**项目地址:** [snyk-labs/CVE-2023-50164-POC](https://github.com/snyk-labs/CVE-2023-50164-POC)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

## POC #15

**来源**: [CVE-2023-50164-sunnyvale-it_CVE-2023-50164-PoC.md](../2023/CVE-2023-50164-sunnyvale-it_CVE-2023-50164-PoC.md)

## CVE-2023-50164-Apache Struts文件上传路径遍历导致RCE

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 文件上传路径遍历导致RCE

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0.0 - 2.5.32, 6.0.0 - 6.3.0.1

**利用条件:** 需要存在文件上传功能且使用受影响的Apache Struts版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164是Apache Struts 2中的一个文件上传漏洞，攻击者可以通过操纵文件上传参数，实现路径遍历，最终上传恶意文件并执行远程代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8，属于高危漏洞。漏洞利用代码中的Dockerfile构建了一个包含Struts2应用程序的Tomcat环境，pom.xml文件指定了存在漏洞的Struts2版本。README.md提供了构建和运行PoC的步骤，以及执行任意命令的示例。利用方式是通过构造恶意的上传请求，将webshell.jsp上传到服务器的webshell目录下，然后通过访问该webshell执行任意命令。POC存在一定投毒风险，虽然主要代码是用来验证漏洞的，但是webshell本身就具有潜在的危险，如果攻击者修改了Dockerfile或者exploit.sh，可能会引入恶意的行为。风险评估基于webshell本身的风险和修改PoC引入恶意代码的潜在可能。

**有效性：** 提供的POC代码是有效的，它成功地演示了CVE-2023-50164漏洞的利用。

**投毒风险：** 存在一定的投毒风险，约为10%。 主要风险点在于：
   1. Dockerfile中的基础镜像可能被替换为包含恶意软件的版本。
   2. exploit.sh脚本可能被修改为执行额外的恶意操作。
   3. webshell.jsp本身可能包含隐藏的后门或恶意代码。

**利用方式：**
   1. 攻击者构造包含恶意路径的文件上传请求。攻击请求中包含了目录遍历的payload，例如：filename="../../../../tmp/shell.jsp"
   2. Struts2应用解析请求，由于漏洞存在，允许将文件上传到任意目录。
   3. 攻击者上传一个webshell（如JSP脚本），该webshell允许执行任意系统命令。
   4. 攻击者通过访问上传的webshell，执行恶意代码，实现远程代码执行。

**搜索引擎结果摘要：** 多个来源确认了CVE-2023-50164是一个高危漏洞，并且已经出现了公开的PoC。漏洞允许攻击者通过文件上传参数操纵实现路径遍历，从而导致远程代码执行。

**项目地址:** [sunnyvale-it/CVE-2023-50164-PoC](https://github.com/sunnyvale-it/CVE-2023-50164-PoC)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)

---

