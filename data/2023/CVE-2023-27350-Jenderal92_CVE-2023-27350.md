# CVE-2023-27350

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27350-0xB0y426_CVE-2023-27350-PoC.md](../2023/CVE-2023-27350-0xB0y426_CVE-2023-27350-PoC.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 8.0 up to, but not including, 20.1.7, 21.2.11, and 22.0.9.  (CVE描述中明确指出22.0.5 Build 63914受影响)

**利用条件:** 目标PaperCut服务器可访问，端口9191开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者可以利用此漏洞绕过身份验证，直接访问管理控制面板，并最终执行远程代码。

**有效性分析：**
根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断此漏洞利用的有效性较高。
*   漏洞库信息明确指出该漏洞允许远程攻击者绕过身份验证并在受影响的PaperCut NG版本上执行任意代码。
*   搜索结果中多个链接表明此漏洞已被积极利用，并导致了Ransomware攻击等严重后果。CISA也发布了相关的安全公告。
*   PoC代码的功能是首先检查目标是否存在漏洞（通过访问SetupCompleted页面并检查返回的版本信息），然后引导用户通过访问特定URL绕过身份验证。PoC验证了身份验证绕过的可行性。根据github说明，漏洞影响8.0到22.0.9之前的版本(不包含).

**投毒风险分析：**
提供的PoC代码主要功能是检测目标PaperCut服务器是否存在漏洞，并提供绕过身份验证的URL链接。代码本身只包含版本检测和URL构造，没有发现任何可疑的后门代码或者恶意操作。因此，投毒风险较低，评估为0%。

**利用方式：**
1.  攻击者首先访问目标PaperCut服务器的`http://<ip>:9191/app?service=page/SetupCompleted`页面。
2.  PoC脚本会自动访问此URL,然后通过解析返回的HTML内容来判断PaperCut的版本信息，以此确定目标是否存在漏洞。
3.  如果目标存在漏洞，PoC会引导攻击者访问`http://<ip>:9191/app?service=page/Dashboard` URL，该URL可以绕过身份验证。
4.  成功绕过身份验证后，攻击者可以访问PaperCut的管理控制面板，从而查看系统设置、日志，甚至更改配置，最终可能导致远程代码执行，控制整个系统。

**项目地址:** [0xB0y426/CVE-2023-27350-PoC](https://github.com/0xB0y426/CVE-2023-27350-PoC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #2

**来源**: [CVE-2023-27350-ASG-CASTLE_CVE-2023-27350.md](../2023/CVE-2023-27350-ASG-CASTLE_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可完全控制受影响系统

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 需要网络访问，目标PaperCut服务器运行在受影响版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350是PaperCut NG/MF软件中的一个漏洞，允许未经身份验证的远程攻击者执行任意代码。漏洞存在于SetupCompleted类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在SYSTEM上下文中执行任意代码。

**有效性:** 根据漏洞信息和搜索结果，此漏洞的POC是可用的，并且已被积极利用。CISA已将其添加到已知被利用的漏洞目录中，表明该漏洞利用的有效性很高。

**投毒风险:** 提供的POC代码仅包含README.md文件，只描述了漏洞信息，没有实际的利用代码。因此投毒风险较低，但由于实际利用代码可能从其他来源获取，不能排除其他来源的POC代码可能存在投毒的情况。这里给出的10%的投毒风险主要是考虑了从其他渠道获取的POC代码可能存在的风险。

**利用方式:** 攻击者通过利用SetupCompleted类中的不当访问控制，绕过身份验证。绕过身份验证后，攻击者可以进一步利用PaperCut的内置脚本功能执行任意代码，从而实现远程代码执行。 根据搜索结果，攻击者可以利用此漏洞安装勒索软件，例如LockBit和Bloody。

**项目地址:** [ASG-CASTLE/CVE-2023-27350](https://github.com/ASG-CASTLE/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #3

**来源**: [CVE-2023-27350-Jenderal92_CVE-2023-27350.md](../2023/CVE-2023-27350-Jenderal92_CVE-2023-27350.md)

# CVE-2023-27350

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27350-0xB0y426_CVE-2023-27350-PoC.md](../2023/CVE-2023-27350-0xB0y426_CVE-2023-27350-PoC.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 8.0 up to, but not including, 20.1.7, 21.2.11, and 22.0.9.  (CVE描述中明确指出22.0.5 Build 63914受影响)

**利用条件:** 目标PaperCut服务器可访问，端口9191开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者可以利用此漏洞绕过身份验证，直接访问管理控制面板，并最终执行远程代码。

**有效性分析：**
根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断此漏洞利用的有效性较高。
*   漏洞库信息明确指出该漏洞允许远程攻击者绕过身份验证并在受影响的PaperCut NG版本上执行任意代码。
*   搜索结果中多个链接表明此漏洞已被积极利用，并导致了Ransomware攻击等严重后果。CISA也发布了相关的安全公告。
*   PoC代码的功能是首先检查目标是否存在漏洞（通过访问SetupCompleted页面并检查返回的版本信息），然后引导用户通过访问特定URL绕过身份验证。PoC验证了身份验证绕过的可行性。根据github说明，漏洞影响8.0到22.0.9之前的版本(不包含).

**投毒风险分析：**
提供的PoC代码主要功能是检测目标PaperCut服务器是否存在漏洞，并提供绕过身份验证的URL链接。代码本身只包含版本检测和URL构造，没有发现任何可疑的后门代码或者恶意操作。因此，投毒风险较低，评估为0%。

**利用方式：**
1.  攻击者首先访问目标PaperCut服务器的`http://<ip>:9191/app?service=page/SetupCompleted`页面。
2.  PoC脚本会自动访问此URL,然后通过解析返回的HTML内容来判断PaperCut的版本信息，以此确定目标是否存在漏洞。
3.  如果目标存在漏洞，PoC会引导攻击者访问`http://<ip>:9191/app?service=page/Dashboard` URL，该URL可以绕过身份验证。
4.  成功绕过身份验证后，攻击者可以访问PaperCut的管理控制面板，从而查看系统设置、日志，甚至更改配置，最终可能导致远程代码执行，控制整个系统。

**项目地址:** [0xB0y426/CVE-2023-27350-PoC](https://github.com/0xB0y426/CVE-2023-27350-PoC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #2

**来源**: [CVE-2023-27350-ASG-CASTLE_CVE-2023-27350.md](../2023/CVE-2023-27350-ASG-CASTLE_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可完全控制受影响系统

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 需要网络访问，目标PaperCut服务器运行在受影响版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350是PaperCut NG/MF软件中的一个漏洞，允许未经身份验证的远程攻击者执行任意代码。漏洞存在于SetupCompleted类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在SYSTEM上下文中执行任意代码。

**有效性:** 根据漏洞信息和搜索结果，此漏洞的POC是可用的，并且已被积极利用。CISA已将其添加到已知被利用的漏洞目录中，表明该漏洞利用的有效性很高。

**投毒风险:** 提供的POC代码仅包含README.md文件，只描述了漏洞信息，没有实际的利用代码。因此投毒风险较低，但由于实际利用代码可能从其他来源获取，不能排除其他来源的POC代码可能存在投毒的情况。这里给出的10%的投毒风险主要是考虑了从其他渠道获取的POC代码可能存在的风险。

**利用方式:** 攻击者通过利用SetupCompleted类中的不当访问控制，绕过身份验证。绕过身份验证后，攻击者可以进一步利用PaperCut的内置脚本功能执行任意代码，从而实现远程代码执行。 根据搜索结果，攻击者可以利用此漏洞安装勒索软件，例如LockBit和Bloody。

**项目地址:** [ASG-CASTLE/CVE-2023-27350](https://github.com/ASG-CASTLE/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #3

**来源**: [CVE-2023-27350-Jenderal92_CVE-2023-27350.md](../2023/CVE-2023-27350-Jenderal92_CVE-2023-27350.md)

# CVE-2023-27350

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27350-0xB0y426_CVE-2023-27350-PoC.md](../2023/CVE-2023-27350-0xB0y426_CVE-2023-27350-PoC.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 8.0 up to, but not including, 20.1.7, 21.2.11, and 22.0.9.  (CVE描述中明确指出22.0.5 Build 63914受影响)

**利用条件:** 目标PaperCut服务器可访问，端口9191开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者可以利用此漏洞绕过身份验证，直接访问管理控制面板，并最终执行远程代码。

**有效性分析：**
根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断此漏洞利用的有效性较高。
*   漏洞库信息明确指出该漏洞允许远程攻击者绕过身份验证并在受影响的PaperCut NG版本上执行任意代码。
*   搜索结果中多个链接表明此漏洞已被积极利用，并导致了Ransomware攻击等严重后果。CISA也发布了相关的安全公告。
*   PoC代码的功能是首先检查目标是否存在漏洞（通过访问SetupCompleted页面并检查返回的版本信息），然后引导用户通过访问特定URL绕过身份验证。PoC验证了身份验证绕过的可行性。根据github说明，漏洞影响8.0到22.0.9之前的版本(不包含).

**投毒风险分析：**
提供的PoC代码主要功能是检测目标PaperCut服务器是否存在漏洞，并提供绕过身份验证的URL链接。代码本身只包含版本检测和URL构造，没有发现任何可疑的后门代码或者恶意操作。因此，投毒风险较低，评估为0%。

**利用方式：**
1.  攻击者首先访问目标PaperCut服务器的`http://<ip>:9191/app?service=page/SetupCompleted`页面。
2.  PoC脚本会自动访问此URL,然后通过解析返回的HTML内容来判断PaperCut的版本信息，以此确定目标是否存在漏洞。
3.  如果目标存在漏洞，PoC会引导攻击者访问`http://<ip>:9191/app?service=page/Dashboard` URL，该URL可以绕过身份验证。
4.  成功绕过身份验证后，攻击者可以访问PaperCut的管理控制面板，从而查看系统设置、日志，甚至更改配置，最终可能导致远程代码执行，控制整个系统。

**项目地址:** [0xB0y426/CVE-2023-27350-PoC](https://github.com/0xB0y426/CVE-2023-27350-PoC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #2

**来源**: [CVE-2023-27350-ASG-CASTLE_CVE-2023-27350.md](../2023/CVE-2023-27350-ASG-CASTLE_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可完全控制受影响系统

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 需要网络访问，目标PaperCut服务器运行在受影响版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350是PaperCut NG/MF软件中的一个漏洞，允许未经身份验证的远程攻击者执行任意代码。漏洞存在于SetupCompleted类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在SYSTEM上下文中执行任意代码。

**有效性:** 根据漏洞信息和搜索结果，此漏洞的POC是可用的，并且已被积极利用。CISA已将其添加到已知被利用的漏洞目录中，表明该漏洞利用的有效性很高。

**投毒风险:** 提供的POC代码仅包含README.md文件，只描述了漏洞信息，没有实际的利用代码。因此投毒风险较低，但由于实际利用代码可能从其他来源获取，不能排除其他来源的POC代码可能存在投毒的情况。这里给出的10%的投毒风险主要是考虑了从其他渠道获取的POC代码可能存在的风险。

**利用方式:** 攻击者通过利用SetupCompleted类中的不当访问控制，绕过身份验证。绕过身份验证后，攻击者可以进一步利用PaperCut的内置脚本功能执行任意代码，从而实现远程代码执行。 根据搜索结果，攻击者可以利用此漏洞安装勒索软件，例如LockBit和Bloody。

**项目地址:** [ASG-CASTLE/CVE-2023-27350](https://github.com/ASG-CASTLE/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #3

**来源**: [CVE-2023-27350-Jenderal92_CVE-2023-27350.md](../2023/CVE-2023-27350-Jenderal92_CVE-2023-27350.md)

# CVE-2023-27350

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27350-0xB0y426_CVE-2023-27350-PoC.md](../2023/CVE-2023-27350-0xB0y426_CVE-2023-27350-PoC.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 8.0 up to, but not including, 20.1.7, 21.2.11, and 22.0.9.  (CVE描述中明确指出22.0.5 Build 63914受影响)

**利用条件:** 目标PaperCut服务器可访问，端口9191开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者可以利用此漏洞绕过身份验证，直接访问管理控制面板，并最终执行远程代码。

**有效性分析：**
根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断此漏洞利用的有效性较高。
*   漏洞库信息明确指出该漏洞允许远程攻击者绕过身份验证并在受影响的PaperCut NG版本上执行任意代码。
*   搜索结果中多个链接表明此漏洞已被积极利用，并导致了Ransomware攻击等严重后果。CISA也发布了相关的安全公告。
*   PoC代码的功能是首先检查目标是否存在漏洞（通过访问SetupCompleted页面并检查返回的版本信息），然后引导用户通过访问特定URL绕过身份验证。PoC验证了身份验证绕过的可行性。根据github说明，漏洞影响8.0到22.0.9之前的版本(不包含).

**投毒风险分析：**
提供的PoC代码主要功能是检测目标PaperCut服务器是否存在漏洞，并提供绕过身份验证的URL链接。代码本身只包含版本检测和URL构造，没有发现任何可疑的后门代码或者恶意操作。因此，投毒风险较低，评估为0%。

**利用方式：**
1.  攻击者首先访问目标PaperCut服务器的`http://<ip>:9191/app?service=page/SetupCompleted`页面。
2.  PoC脚本会自动访问此URL,然后通过解析返回的HTML内容来判断PaperCut的版本信息，以此确定目标是否存在漏洞。
3.  如果目标存在漏洞，PoC会引导攻击者访问`http://<ip>:9191/app?service=page/Dashboard` URL，该URL可以绕过身份验证。
4.  成功绕过身份验证后，攻击者可以访问PaperCut的管理控制面板，从而查看系统设置、日志，甚至更改配置，最终可能导致远程代码执行，控制整个系统。

**项目地址:** [0xB0y426/CVE-2023-27350-PoC](https://github.com/0xB0y426/CVE-2023-27350-PoC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #2

**来源**: [CVE-2023-27350-ASG-CASTLE_CVE-2023-27350.md](../2023/CVE-2023-27350-ASG-CASTLE_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可完全控制受影响系统

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 需要网络访问，目标PaperCut服务器运行在受影响版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350是PaperCut NG/MF软件中的一个漏洞，允许未经身份验证的远程攻击者执行任意代码。漏洞存在于SetupCompleted类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在SYSTEM上下文中执行任意代码。

**有效性:** 根据漏洞信息和搜索结果，此漏洞的POC是可用的，并且已被积极利用。CISA已将其添加到已知被利用的漏洞目录中，表明该漏洞利用的有效性很高。

**投毒风险:** 提供的POC代码仅包含README.md文件，只描述了漏洞信息，没有实际的利用代码。因此投毒风险较低，但由于实际利用代码可能从其他来源获取，不能排除其他来源的POC代码可能存在投毒的情况。这里给出的10%的投毒风险主要是考虑了从其他渠道获取的POC代码可能存在的风险。

**利用方式:** 攻击者通过利用SetupCompleted类中的不当访问控制，绕过身份验证。绕过身份验证后，攻击者可以进一步利用PaperCut的内置脚本功能执行任意代码，从而实现远程代码执行。 根据搜索结果，攻击者可以利用此漏洞安装勒索软件，例如LockBit和Bloody。

**项目地址:** [ASG-CASTLE/CVE-2023-27350](https://github.com/ASG-CASTLE/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #3

**来源**: [CVE-2023-27350-Jenderal92_CVE-2023-27350.md](../2023/CVE-2023-27350-Jenderal92_CVE-2023-27350.md)

# CVE-2023-27350

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27350-0xB0y426_CVE-2023-27350-PoC.md](../2023/CVE-2023-27350-0xB0y426_CVE-2023-27350-PoC.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 8.0 up to, but not including, 20.1.7, 21.2.11, and 22.0.9.  (CVE描述中明确指出22.0.5 Build 63914受影响)

**利用条件:** 目标PaperCut服务器可访问，端口9191开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者可以利用此漏洞绕过身份验证，直接访问管理控制面板，并最终执行远程代码。

**有效性分析：**
根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断此漏洞利用的有效性较高。
*   漏洞库信息明确指出该漏洞允许远程攻击者绕过身份验证并在受影响的PaperCut NG版本上执行任意代码。
*   搜索结果中多个链接表明此漏洞已被积极利用，并导致了Ransomware攻击等严重后果。CISA也发布了相关的安全公告。
*   PoC代码的功能是首先检查目标是否存在漏洞（通过访问SetupCompleted页面并检查返回的版本信息），然后引导用户通过访问特定URL绕过身份验证。PoC验证了身份验证绕过的可行性。根据github说明，漏洞影响8.0到22.0.9之前的版本(不包含).

**投毒风险分析：**
提供的PoC代码主要功能是检测目标PaperCut服务器是否存在漏洞，并提供绕过身份验证的URL链接。代码本身只包含版本检测和URL构造，没有发现任何可疑的后门代码或者恶意操作。因此，投毒风险较低，评估为0%。

**利用方式：**
1.  攻击者首先访问目标PaperCut服务器的`http://<ip>:9191/app?service=page/SetupCompleted`页面。
2.  PoC脚本会自动访问此URL,然后通过解析返回的HTML内容来判断PaperCut的版本信息，以此确定目标是否存在漏洞。
3.  如果目标存在漏洞，PoC会引导攻击者访问`http://<ip>:9191/app?service=page/Dashboard` URL，该URL可以绕过身份验证。
4.  成功绕过身份验证后，攻击者可以访问PaperCut的管理控制面板，从而查看系统设置、日志，甚至更改配置，最终可能导致远程代码执行，控制整个系统。

**项目地址:** [0xB0y426/CVE-2023-27350-PoC](https://github.com/0xB0y426/CVE-2023-27350-PoC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #2

**来源**: [CVE-2023-27350-ASG-CASTLE_CVE-2023-27350.md](../2023/CVE-2023-27350-ASG-CASTLE_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可完全控制受影响系统

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 需要网络访问，目标PaperCut服务器运行在受影响版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350是PaperCut NG/MF软件中的一个漏洞，允许未经身份验证的远程攻击者执行任意代码。漏洞存在于SetupCompleted类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在SYSTEM上下文中执行任意代码。

**有效性:** 根据漏洞信息和搜索结果，此漏洞的POC是可用的，并且已被积极利用。CISA已将其添加到已知被利用的漏洞目录中，表明该漏洞利用的有效性很高。

**投毒风险:** 提供的POC代码仅包含README.md文件，只描述了漏洞信息，没有实际的利用代码。因此投毒风险较低，但由于实际利用代码可能从其他来源获取，不能排除其他来源的POC代码可能存在投毒的情况。这里给出的10%的投毒风险主要是考虑了从其他渠道获取的POC代码可能存在的风险。

**利用方式:** 攻击者通过利用SetupCompleted类中的不当访问控制，绕过身份验证。绕过身份验证后，攻击者可以进一步利用PaperCut的内置脚本功能执行任意代码，从而实现远程代码执行。 根据搜索结果，攻击者可以利用此漏洞安装勒索软件，例如LockBit和Bloody。

**项目地址:** [ASG-CASTLE/CVE-2023-27350](https://github.com/ASG-CASTLE/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #3

**来源**: [CVE-2023-27350-Jenderal92_CVE-2023-27350.md](../2023/CVE-2023-27350-Jenderal92_CVE-2023-27350.md)

# CVE-2023-27350

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27350-0xB0y426_CVE-2023-27350-PoC.md](../2023/CVE-2023-27350-0xB0y426_CVE-2023-27350-PoC.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 8.0 up to, but not including, 20.1.7, 21.2.11, and 22.0.9.  (CVE描述中明确指出22.0.5 Build 63914受影响)

**利用条件:** 目标PaperCut服务器可访问，端口9191开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者可以利用此漏洞绕过身份验证，直接访问管理控制面板，并最终执行远程代码。

**有效性分析：**
根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断此漏洞利用的有效性较高。
*   漏洞库信息明确指出该漏洞允许远程攻击者绕过身份验证并在受影响的PaperCut NG版本上执行任意代码。
*   搜索结果中多个链接表明此漏洞已被积极利用，并导致了Ransomware攻击等严重后果。CISA也发布了相关的安全公告。
*   PoC代码的功能是首先检查目标是否存在漏洞（通过访问SetupCompleted页面并检查返回的版本信息），然后引导用户通过访问特定URL绕过身份验证。PoC验证了身份验证绕过的可行性。根据github说明，漏洞影响8.0到22.0.9之前的版本(不包含).

**投毒风险分析：**
提供的PoC代码主要功能是检测目标PaperCut服务器是否存在漏洞，并提供绕过身份验证的URL链接。代码本身只包含版本检测和URL构造，没有发现任何可疑的后门代码或者恶意操作。因此，投毒风险较低，评估为0%。

**利用方式：**
1.  攻击者首先访问目标PaperCut服务器的`http://<ip>:9191/app?service=page/SetupCompleted`页面。
2.  PoC脚本会自动访问此URL,然后通过解析返回的HTML内容来判断PaperCut的版本信息，以此确定目标是否存在漏洞。
3.  如果目标存在漏洞，PoC会引导攻击者访问`http://<ip>:9191/app?service=page/Dashboard` URL，该URL可以绕过身份验证。
4.  成功绕过身份验证后，攻击者可以访问PaperCut的管理控制面板，从而查看系统设置、日志，甚至更改配置，最终可能导致远程代码执行，控制整个系统。

**项目地址:** [0xB0y426/CVE-2023-27350-PoC](https://github.com/0xB0y426/CVE-2023-27350-PoC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #2

**来源**: [CVE-2023-27350-ASG-CASTLE_CVE-2023-27350.md](../2023/CVE-2023-27350-ASG-CASTLE_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可完全控制受影响系统

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 需要网络访问，目标PaperCut服务器运行在受影响版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350是PaperCut NG/MF软件中的一个漏洞，允许未经身份验证的远程攻击者执行任意代码。漏洞存在于SetupCompleted类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在SYSTEM上下文中执行任意代码。

**有效性:** 根据漏洞信息和搜索结果，此漏洞的POC是可用的，并且已被积极利用。CISA已将其添加到已知被利用的漏洞目录中，表明该漏洞利用的有效性很高。

**投毒风险:** 提供的POC代码仅包含README.md文件，只描述了漏洞信息，没有实际的利用代码。因此投毒风险较低，但由于实际利用代码可能从其他来源获取，不能排除其他来源的POC代码可能存在投毒的情况。这里给出的10%的投毒风险主要是考虑了从其他渠道获取的POC代码可能存在的风险。

**利用方式:** 攻击者通过利用SetupCompleted类中的不当访问控制，绕过身份验证。绕过身份验证后，攻击者可以进一步利用PaperCut的内置脚本功能执行任意代码，从而实现远程代码执行。 根据搜索结果，攻击者可以利用此漏洞安装勒索软件，例如LockBit和Bloody。

**项目地址:** [ASG-CASTLE/CVE-2023-27350](https://github.com/ASG-CASTLE/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #3

**来源**: [CVE-2023-27350-Jenderal92_CVE-2023-27350.md](../2023/CVE-2023-27350-Jenderal92_CVE-2023-27350.md)

# CVE-2023-27350

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27350-0xB0y426_CVE-2023-27350-PoC.md](../2023/CVE-2023-27350-0xB0y426_CVE-2023-27350-PoC.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 8.0 up to, but not including, 20.1.7, 21.2.11, and 22.0.9.  (CVE描述中明确指出22.0.5 Build 63914受影响)

**利用条件:** 目标PaperCut服务器可访问，端口9191开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者可以利用此漏洞绕过身份验证，直接访问管理控制面板，并最终执行远程代码。

**有效性分析：**
根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断此漏洞利用的有效性较高。
*   漏洞库信息明确指出该漏洞允许远程攻击者绕过身份验证并在受影响的PaperCut NG版本上执行任意代码。
*   搜索结果中多个链接表明此漏洞已被积极利用，并导致了Ransomware攻击等严重后果。CISA也发布了相关的安全公告。
*   PoC代码的功能是首先检查目标是否存在漏洞（通过访问SetupCompleted页面并检查返回的版本信息），然后引导用户通过访问特定URL绕过身份验证。PoC验证了身份验证绕过的可行性。根据github说明，漏洞影响8.0到22.0.9之前的版本(不包含).

**投毒风险分析：**
提供的PoC代码主要功能是检测目标PaperCut服务器是否存在漏洞，并提供绕过身份验证的URL链接。代码本身只包含版本检测和URL构造，没有发现任何可疑的后门代码或者恶意操作。因此，投毒风险较低，评估为0%。

**利用方式：**
1.  攻击者首先访问目标PaperCut服务器的`http://<ip>:9191/app?service=page/SetupCompleted`页面。
2.  PoC脚本会自动访问此URL,然后通过解析返回的HTML内容来判断PaperCut的版本信息，以此确定目标是否存在漏洞。
3.  如果目标存在漏洞，PoC会引导攻击者访问`http://<ip>:9191/app?service=page/Dashboard` URL，该URL可以绕过身份验证。
4.  成功绕过身份验证后，攻击者可以访问PaperCut的管理控制面板，从而查看系统设置、日志，甚至更改配置，最终可能导致远程代码执行，控制整个系统。

**项目地址:** [0xB0y426/CVE-2023-27350-PoC](https://github.com/0xB0y426/CVE-2023-27350-PoC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #2

**来源**: [CVE-2023-27350-ASG-CASTLE_CVE-2023-27350.md](../2023/CVE-2023-27350-ASG-CASTLE_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可完全控制受影响系统

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 需要网络访问，目标PaperCut服务器运行在受影响版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350是PaperCut NG/MF软件中的一个漏洞，允许未经身份验证的远程攻击者执行任意代码。漏洞存在于SetupCompleted类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在SYSTEM上下文中执行任意代码。

**有效性:** 根据漏洞信息和搜索结果，此漏洞的POC是可用的，并且已被积极利用。CISA已将其添加到已知被利用的漏洞目录中，表明该漏洞利用的有效性很高。

**投毒风险:** 提供的POC代码仅包含README.md文件，只描述了漏洞信息，没有实际的利用代码。因此投毒风险较低，但由于实际利用代码可能从其他来源获取，不能排除其他来源的POC代码可能存在投毒的情况。这里给出的10%的投毒风险主要是考虑了从其他渠道获取的POC代码可能存在的风险。

**利用方式:** 攻击者通过利用SetupCompleted类中的不当访问控制，绕过身份验证。绕过身份验证后，攻击者可以进一步利用PaperCut的内置脚本功能执行任意代码，从而实现远程代码执行。 根据搜索结果，攻击者可以利用此漏洞安装勒索软件，例如LockBit和Bloody。

**项目地址:** [ASG-CASTLE/CVE-2023-27350](https://github.com/ASG-CASTLE/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #3

**来源**: [CVE-2023-27350-Jenderal92_CVE-2023-27350.md](../2023/CVE-2023-27350-Jenderal92_CVE-2023-27350.md)

# CVE-2023-27350

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27350-0xB0y426_CVE-2023-27350-PoC.md](../2023/CVE-2023-27350-0xB0y426_CVE-2023-27350-PoC.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 8.0 up to, but not including, 20.1.7, 21.2.11, and 22.0.9.  (CVE描述中明确指出22.0.5 Build 63914受影响)

**利用条件:** 目标PaperCut服务器可访问，端口9191开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者可以利用此漏洞绕过身份验证，直接访问管理控制面板，并最终执行远程代码。

**有效性分析：**
根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断此漏洞利用的有效性较高。
*   漏洞库信息明确指出该漏洞允许远程攻击者绕过身份验证并在受影响的PaperCut NG版本上执行任意代码。
*   搜索结果中多个链接表明此漏洞已被积极利用，并导致了Ransomware攻击等严重后果。CISA也发布了相关的安全公告。
*   PoC代码的功能是首先检查目标是否存在漏洞（通过访问SetupCompleted页面并检查返回的版本信息），然后引导用户通过访问特定URL绕过身份验证。PoC验证了身份验证绕过的可行性。根据github说明，漏洞影响8.0到22.0.9之前的版本(不包含).

**投毒风险分析：**
提供的PoC代码主要功能是检测目标PaperCut服务器是否存在漏洞，并提供绕过身份验证的URL链接。代码本身只包含版本检测和URL构造，没有发现任何可疑的后门代码或者恶意操作。因此，投毒风险较低，评估为0%。

**利用方式：**
1.  攻击者首先访问目标PaperCut服务器的`http://<ip>:9191/app?service=page/SetupCompleted`页面。
2.  PoC脚本会自动访问此URL,然后通过解析返回的HTML内容来判断PaperCut的版本信息，以此确定目标是否存在漏洞。
3.  如果目标存在漏洞，PoC会引导攻击者访问`http://<ip>:9191/app?service=page/Dashboard` URL，该URL可以绕过身份验证。
4.  成功绕过身份验证后，攻击者可以访问PaperCut的管理控制面板，从而查看系统设置、日志，甚至更改配置，最终可能导致远程代码执行，控制整个系统。

**项目地址:** [0xB0y426/CVE-2023-27350-PoC](https://github.com/0xB0y426/CVE-2023-27350-PoC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #2

**来源**: [CVE-2023-27350-ASG-CASTLE_CVE-2023-27350.md](../2023/CVE-2023-27350-ASG-CASTLE_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可完全控制受影响系统

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 需要网络访问，目标PaperCut服务器运行在受影响版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350是PaperCut NG/MF软件中的一个漏洞，允许未经身份验证的远程攻击者执行任意代码。漏洞存在于SetupCompleted类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在SYSTEM上下文中执行任意代码。

**有效性:** 根据漏洞信息和搜索结果，此漏洞的POC是可用的，并且已被积极利用。CISA已将其添加到已知被利用的漏洞目录中，表明该漏洞利用的有效性很高。

**投毒风险:** 提供的POC代码仅包含README.md文件，只描述了漏洞信息，没有实际的利用代码。因此投毒风险较低，但由于实际利用代码可能从其他来源获取，不能排除其他来源的POC代码可能存在投毒的情况。这里给出的10%的投毒风险主要是考虑了从其他渠道获取的POC代码可能存在的风险。

**利用方式:** 攻击者通过利用SetupCompleted类中的不当访问控制，绕过身份验证。绕过身份验证后，攻击者可以进一步利用PaperCut的内置脚本功能执行任意代码，从而实现远程代码执行。 根据搜索结果，攻击者可以利用此漏洞安装勒索软件，例如LockBit和Bloody。

**项目地址:** [ASG-CASTLE/CVE-2023-27350](https://github.com/ASG-CASTLE/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #3

**来源**: [CVE-2023-27350-Jenderal92_CVE-2023-27350.md](../2023/CVE-2023-27350-Jenderal92_CVE-2023-27350.md)

# CVE-2023-27350

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27350-0xB0y426_CVE-2023-27350-PoC.md](../2023/CVE-2023-27350-0xB0y426_CVE-2023-27350-PoC.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 8.0 up to, but not including, 20.1.7, 21.2.11, and 22.0.9.  (CVE描述中明确指出22.0.5 Build 63914受影响)

**利用条件:** 目标PaperCut服务器可访问，端口9191开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者可以利用此漏洞绕过身份验证，直接访问管理控制面板，并最终执行远程代码。

**有效性分析：**
根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断此漏洞利用的有效性较高。
*   漏洞库信息明确指出该漏洞允许远程攻击者绕过身份验证并在受影响的PaperCut NG版本上执行任意代码。
*   搜索结果中多个链接表明此漏洞已被积极利用，并导致了Ransomware攻击等严重后果。CISA也发布了相关的安全公告。
*   PoC代码的功能是首先检查目标是否存在漏洞（通过访问SetupCompleted页面并检查返回的版本信息），然后引导用户通过访问特定URL绕过身份验证。PoC验证了身份验证绕过的可行性。根据github说明，漏洞影响8.0到22.0.9之前的版本(不包含).

**投毒风险分析：**
提供的PoC代码主要功能是检测目标PaperCut服务器是否存在漏洞，并提供绕过身份验证的URL链接。代码本身只包含版本检测和URL构造，没有发现任何可疑的后门代码或者恶意操作。因此，投毒风险较低，评估为0%。

**利用方式：**
1.  攻击者首先访问目标PaperCut服务器的`http://<ip>:9191/app?service=page/SetupCompleted`页面。
2.  PoC脚本会自动访问此URL,然后通过解析返回的HTML内容来判断PaperCut的版本信息，以此确定目标是否存在漏洞。
3.  如果目标存在漏洞，PoC会引导攻击者访问`http://<ip>:9191/app?service=page/Dashboard` URL，该URL可以绕过身份验证。
4.  成功绕过身份验证后，攻击者可以访问PaperCut的管理控制面板，从而查看系统设置、日志，甚至更改配置，最终可能导致远程代码执行，控制整个系统。

**项目地址:** [0xB0y426/CVE-2023-27350-PoC](https://github.com/0xB0y426/CVE-2023-27350-PoC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #2

**来源**: [CVE-2023-27350-ASG-CASTLE_CVE-2023-27350.md](../2023/CVE-2023-27350-ASG-CASTLE_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可完全控制受影响系统

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 需要网络访问，目标PaperCut服务器运行在受影响版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350是PaperCut NG/MF软件中的一个漏洞，允许未经身份验证的远程攻击者执行任意代码。漏洞存在于SetupCompleted类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在SYSTEM上下文中执行任意代码。

**有效性:** 根据漏洞信息和搜索结果，此漏洞的POC是可用的，并且已被积极利用。CISA已将其添加到已知被利用的漏洞目录中，表明该漏洞利用的有效性很高。

**投毒风险:** 提供的POC代码仅包含README.md文件，只描述了漏洞信息，没有实际的利用代码。因此投毒风险较低，但由于实际利用代码可能从其他来源获取，不能排除其他来源的POC代码可能存在投毒的情况。这里给出的10%的投毒风险主要是考虑了从其他渠道获取的POC代码可能存在的风险。

**利用方式:** 攻击者通过利用SetupCompleted类中的不当访问控制，绕过身份验证。绕过身份验证后，攻击者可以进一步利用PaperCut的内置脚本功能执行任意代码，从而实现远程代码执行。 根据搜索结果，攻击者可以利用此漏洞安装勒索软件，例如LockBit和Bloody。

**项目地址:** [ASG-CASTLE/CVE-2023-27350](https://github.com/ASG-CASTLE/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #3

**来源**: [CVE-2023-27350-Jenderal92_CVE-2023-27350.md](../2023/CVE-2023-27350-Jenderal92_CVE-2023-27350.md)

# CVE-2023-27350

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27350-0xB0y426_CVE-2023-27350-PoC.md](../2023/CVE-2023-27350-0xB0y426_CVE-2023-27350-PoC.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 8.0 up to, but not including, 20.1.7, 21.2.11, and 22.0.9.  (CVE描述中明确指出22.0.5 Build 63914受影响)

**利用条件:** 目标PaperCut服务器可访问，端口9191开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者可以利用此漏洞绕过身份验证，直接访问管理控制面板，并最终执行远程代码。

**有效性分析：**
根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断此漏洞利用的有效性较高。
*   漏洞库信息明确指出该漏洞允许远程攻击者绕过身份验证并在受影响的PaperCut NG版本上执行任意代码。
*   搜索结果中多个链接表明此漏洞已被积极利用，并导致了Ransomware攻击等严重后果。CISA也发布了相关的安全公告。
*   PoC代码的功能是首先检查目标是否存在漏洞（通过访问SetupCompleted页面并检查返回的版本信息），然后引导用户通过访问特定URL绕过身份验证。PoC验证了身份验证绕过的可行性。根据github说明，漏洞影响8.0到22.0.9之前的版本(不包含).

**投毒风险分析：**
提供的PoC代码主要功能是检测目标PaperCut服务器是否存在漏洞，并提供绕过身份验证的URL链接。代码本身只包含版本检测和URL构造，没有发现任何可疑的后门代码或者恶意操作。因此，投毒风险较低，评估为0%。

**利用方式：**
1.  攻击者首先访问目标PaperCut服务器的`http://<ip>:9191/app?service=page/SetupCompleted`页面。
2.  PoC脚本会自动访问此URL,然后通过解析返回的HTML内容来判断PaperCut的版本信息，以此确定目标是否存在漏洞。
3.  如果目标存在漏洞，PoC会引导攻击者访问`http://<ip>:9191/app?service=page/Dashboard` URL，该URL可以绕过身份验证。
4.  成功绕过身份验证后，攻击者可以访问PaperCut的管理控制面板，从而查看系统设置、日志，甚至更改配置，最终可能导致远程代码执行，控制整个系统。

**项目地址:** [0xB0y426/CVE-2023-27350-PoC](https://github.com/0xB0y426/CVE-2023-27350-PoC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #2

**来源**: [CVE-2023-27350-ASG-CASTLE_CVE-2023-27350.md](../2023/CVE-2023-27350-ASG-CASTLE_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可完全控制受影响系统

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 需要网络访问，目标PaperCut服务器运行在受影响版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350是PaperCut NG/MF软件中的一个漏洞，允许未经身份验证的远程攻击者执行任意代码。漏洞存在于SetupCompleted类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在SYSTEM上下文中执行任意代码。

**有效性:** 根据漏洞信息和搜索结果，此漏洞的POC是可用的，并且已被积极利用。CISA已将其添加到已知被利用的漏洞目录中，表明该漏洞利用的有效性很高。

**投毒风险:** 提供的POC代码仅包含README.md文件，只描述了漏洞信息，没有实际的利用代码。因此投毒风险较低，但由于实际利用代码可能从其他来源获取，不能排除其他来源的POC代码可能存在投毒的情况。这里给出的10%的投毒风险主要是考虑了从其他渠道获取的POC代码可能存在的风险。

**利用方式:** 攻击者通过利用SetupCompleted类中的不当访问控制，绕过身份验证。绕过身份验证后，攻击者可以进一步利用PaperCut的内置脚本功能执行任意代码，从而实现远程代码执行。 根据搜索结果，攻击者可以利用此漏洞安装勒索软件，例如LockBit和Bloody。

**项目地址:** [ASG-CASTLE/CVE-2023-27350](https://github.com/ASG-CASTLE/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #3

**来源**: [CVE-2023-27350-Jenderal92_CVE-2023-27350.md](../2023/CVE-2023-27350-Jenderal92_CVE-2023-27350.md)

# CVE-2023-27350

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27350-0xB0y426_CVE-2023-27350-PoC.md](../2023/CVE-2023-27350-0xB0y426_CVE-2023-27350-PoC.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 8.0 up to, but not including, 20.1.7, 21.2.11, and 22.0.9.  (CVE描述中明确指出22.0.5 Build 63914受影响)

**利用条件:** 目标PaperCut服务器可访问，端口9191开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者可以利用此漏洞绕过身份验证，直接访问管理控制面板，并最终执行远程代码。

**有效性分析：**
根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断此漏洞利用的有效性较高。
*   漏洞库信息明确指出该漏洞允许远程攻击者绕过身份验证并在受影响的PaperCut NG版本上执行任意代码。
*   搜索结果中多个链接表明此漏洞已被积极利用，并导致了Ransomware攻击等严重后果。CISA也发布了相关的安全公告。
*   PoC代码的功能是首先检查目标是否存在漏洞（通过访问SetupCompleted页面并检查返回的版本信息），然后引导用户通过访问特定URL绕过身份验证。PoC验证了身份验证绕过的可行性。根据github说明，漏洞影响8.0到22.0.9之前的版本(不包含).

**投毒风险分析：**
提供的PoC代码主要功能是检测目标PaperCut服务器是否存在漏洞，并提供绕过身份验证的URL链接。代码本身只包含版本检测和URL构造，没有发现任何可疑的后门代码或者恶意操作。因此，投毒风险较低，评估为0%。

**利用方式：**
1.  攻击者首先访问目标PaperCut服务器的`http://<ip>:9191/app?service=page/SetupCompleted`页面。
2.  PoC脚本会自动访问此URL,然后通过解析返回的HTML内容来判断PaperCut的版本信息，以此确定目标是否存在漏洞。
3.  如果目标存在漏洞，PoC会引导攻击者访问`http://<ip>:9191/app?service=page/Dashboard` URL，该URL可以绕过身份验证。
4.  成功绕过身份验证后，攻击者可以访问PaperCut的管理控制面板，从而查看系统设置、日志，甚至更改配置，最终可能导致远程代码执行，控制整个系统。

**项目地址:** [0xB0y426/CVE-2023-27350-PoC](https://github.com/0xB0y426/CVE-2023-27350-PoC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #2

**来源**: [CVE-2023-27350-ASG-CASTLE_CVE-2023-27350.md](../2023/CVE-2023-27350-ASG-CASTLE_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可完全控制受影响系统

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 需要网络访问，目标PaperCut服务器运行在受影响版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350是PaperCut NG/MF软件中的一个漏洞，允许未经身份验证的远程攻击者执行任意代码。漏洞存在于SetupCompleted类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在SYSTEM上下文中执行任意代码。

**有效性:** 根据漏洞信息和搜索结果，此漏洞的POC是可用的，并且已被积极利用。CISA已将其添加到已知被利用的漏洞目录中，表明该漏洞利用的有效性很高。

**投毒风险:** 提供的POC代码仅包含README.md文件，只描述了漏洞信息，没有实际的利用代码。因此投毒风险较低，但由于实际利用代码可能从其他来源获取，不能排除其他来源的POC代码可能存在投毒的情况。这里给出的10%的投毒风险主要是考虑了从其他渠道获取的POC代码可能存在的风险。

**利用方式:** 攻击者通过利用SetupCompleted类中的不当访问控制，绕过身份验证。绕过身份验证后，攻击者可以进一步利用PaperCut的内置脚本功能执行任意代码，从而实现远程代码执行。 根据搜索结果，攻击者可以利用此漏洞安装勒索软件，例如LockBit和Bloody。

**项目地址:** [ASG-CASTLE/CVE-2023-27350](https://github.com/ASG-CASTLE/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #3

**来源**: [CVE-2023-27350-MaanVader_CVE-2023-27350-POC.md](../2023/CVE-2023-27350-MaanVader_CVE-2023-27350-POC.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过与远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可导致完全系统控制

**影响版本:** 22.0.5 (Build 63914) (NG)和受影响的MF版本

**利用条件:** 目标系统运行PaperCut NG/MF，且允许对9191端口的网络访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27350 允许未经身份验证的远程攻击者绕过 PaperCut NG/MF 的身份验证机制，从而实现远程代码执行。漏洞存在于 `SetupCompleted` 类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在 SYSTEM 上下文中执行任意代码。

**有效性：**
从搜索结果以及漏洞描述来看，漏洞真实存在并且已被积极利用。提供的 POC 代码 `find-vuln-ver.py` 旨在检测目标系统是否运行易受攻击的 PaperCut 版本，并通过访问特定的 URL 来引导攻击者进行身份验证绕过。根据github上的其他POC，第一步绕过验证获取权限，第二步利用内置的脚本功能执行代码。

**投毒风险：**
POC 代码 `find-vuln-ver.py` 本身主要用于检测漏洞版本，并给出绕过登录的URL，代码相对简单，不包含任何明显的恶意代码。但是,任何代码都不能保证绝对的安全。因此，极小的可能会有隐藏的投毒代码(比如通过特殊的字符编码、或者利用一些python的特性来执行恶意操作)。但是考虑到其功能主要是版本检测和URL引导，这个可能性非常低。所以投毒风险评定为1%。

**利用方式：**
1.  **版本检测:** 使用POC脚本或者手动访问`http://<ip>:9191/app?service=page/SetupCompleted`来检测PaperCut NG/MF的版本，确定目标系统是否是易受攻击的版本。
2.  **身份验证绕过:**  如果版本确认是易受攻击的版本，攻击者可以通过访问 `http://<ip>:9191/app?service=page/Dashboard` 来绕过身份验证。
3.  **远程代码执行:** 在绕过身份验证后，攻击者可以利用 PaperCut NG/MF 的内置脚本功能来执行任意代码。这通常涉及到上传恶意脚本或者利用已有的脚本执行机制。具体代码执行方式可能需要参考其他的PoC代码，搜索结果中提到了Horizon3ai的PoC。
4.  **权限提升:**  由于漏洞是在 SYSTEM 上下文中执行代码，攻击者可以完全控制受影响的系统。

**总结：**
CVE-2023-27350 是一个严重的安全漏洞，允许未经身份验证的攻击者完全控制 PaperCut NG/MF 服务器。 该漏洞已经被广泛利用，并被列入 CISA 已知被利用漏洞目录中。强烈建议受影响的用户立即应用补丁。

**项目地址:** [MaanVader/CVE-2023-27350-POC](https://github.com/MaanVader/CVE-2023-27350-POC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #4

**来源**: [CVE-2023-27350-Royall-Researchers_CVE-2023-27350.md](../2023/CVE-2023-27350-Royall-Researchers_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过远程代码执行漏洞

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 + 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 22.0.5 (Build 63914) 及 PaperCut MF 或 NG version 8.0 或 later (excluding patched versions) on all OS platforms.

**利用条件:** 目标服务器运行PaperCut NG/MF，且可以通过网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个严重漏洞，允许未经身份验证的远程攻击者绕过身份验证并以 SYSTEM 权限执行任意代码。漏洞存在于 `SetupCompleted` 类中，由于不正确的访问控制导致。

**利用方式：**

1.  **身份验证绕过：** 攻击者通过访问 `/app?service=page/SetupCompleted` 页面，然后发送特定的 POST 请求绕过身份验证。
2.  **配置修改：** 利用绕过的身份验证，攻击者修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 配置，启用脚本执行并禁用沙箱。
3.  **远程代码执行：** 攻击者通过修改打印机设置，插入恶意的 Groovy 脚本，从而在服务器上执行任意代码。脚本功能被滥用。

**POC 有效性：**
提供的 POC 代码通过模拟上述步骤，可以有效利用该漏洞，在目标服务器上执行任意命令。

**投毒风险：**
代码中存在投毒的风险较低。分析POC代码作者的目的是进行漏洞验证，其中`execute`函数中包含了执行命令的代码。通过对脚本的分析，未发现明显的恶意代码。curl命令中存在IP，可能会导致被收集。但总的来说风险较低。

**项目地址:** [Royall-Researchers/CVE-2023-27350](https://github.com/Royall-Researchers/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #5

**来源**: [CVE-2023-27350-ThatNotEasy_CVE-2023-27350.md](../2023/CVE-2023-27350-ThatNotEasy_CVE-2023-27350.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过和远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 极高，可能导致完全系统控制

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统安装了PaperCut NG/MF 22.0.5 (Build 63914)，攻击者需要能够通过网络访问PaperCut服务器。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 存在于 PaperCut NG/MF 软件中，允许未经身份验证的远程攻击者绕过身份验证并执行任意代码。漏洞位于 SetupCompleted 类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在 SYSTEM 上下文中执行任意代码。

**有效性：**
从搜索结果和漏洞库信息来看，该漏洞的POC是可用的，并且已经被积极利用。
提供的Python脚本看起来像是利用了该漏洞，通过访问`/app?service=page/SetupCompleted`路径来绕过身份验证。

**投毒风险：**
查看提供的python代码，代码较为简单，主要用于验证漏洞的存在。代码中引入了requests和BeautifulSoup4库用于发送HTTP请求和解析HTML。该脚本的功能是发送GET请求到目标PaperCut服务器的特定URL，并检查返回的HTML内容是否包含特定的标记，以确定漏洞是否存在。未发现明显的恶意代码。因此，该仓库中存在投毒代码的风险较低，估计在5%左右，主要是考虑到代码可能存在隐藏的缺陷或者依赖项被篡改的风险，但总体上代码逻辑较为清晰。

**利用方式：**
1.  攻击者首先发送特制的HTTP GET请求到目标PaperCut服务器的`/app?service=page/SetupCompleted`端点。
2.  服务器未正确验证身份，允许未经身份验证的访问。
3.  攻击者检查响应的内容以确认漏洞利用是否成功（通过解析HTML查找特定的产品信息）。
4.  成功绕过身份验证后，攻击者可能会利用PaperCut内置的脚本功能来执行任意代码，从而完全控制系统。
5.  参考搜索结果，攻击者可能利用此漏洞安装勒索软件。

**项目地址:** [ThatNotEasy/CVE-2023-27350](https://github.com/ThatNotEasy/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #6

**来源**: [CVE-2023-27350-adhikara13_CVE-2023-27350.md](../2023/CVE-2023-27350-adhikara13_CVE-2023-27350.md)

## CVE-2023-27350-PaperCut-身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 + 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统运行受影响版本的PaperCut NG/MF，且攻击者可以网络访问该系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 中的一个身份验证绕过漏洞。攻击者可以通过向 `/app?service=page/SetupCompleted` 发送特制请求来绕过身份验证。

**利用方式：**

1.  **身份验证绕过：** 未经身份验证的攻击者访问 `/app?service=page/SetupCompleted` 页面，利用不正确的访问控制绕过身份验证。
2.  **获取 Session ID:** 利用绕过的身份验证，通过构造特定的 POST 请求（例如，向 `/app` 发送带有`service=direct/1/SetupCompleted/$Form`的请求）获取有效的 JSESSIONID。
3.  **配置修改：** 使用获得的 JSESSIONID，通过发送 POST 请求到 `/app` 修改 PaperCut 的配置。关键配置包括：
    *   `print-and-device.script.enabled` 设置为 `Y` （启用打印脚本）。
    *   `print.script.sandboxed` 设置为 `N` （禁用脚本沙箱）。
4.  **远程代码执行：** 通过设置打印机脚本来执行任意代码。利用`PrinterDetails/$PrinterDetailsScript.$Form`，将恶意代码注入到`scriptBody`中。该脚本会在打印作业时执行，允许攻击者在系统上执行命令。

**有效性：**

提供的 POC 代码看起来是有效的。它包含以下步骤：

1.  **漏洞检测:**  脚本首先尝试通过访问 `/app?service=page/SetupCompleted` 页面来检测目标是否易受攻击。
2.  **会话获取:** 尝试获取有效的 JSESSIONID。
3.  **配置更改:**  修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 设置。
4.  **命令执行:** 通过打印机脚本注入恶意命令。

根据搜索引擎结果，此漏洞已被积极利用，并且有公开可用的 POC。

**投毒风险分析：**

虽然 POC 主要功能是利用漏洞，但仔细检查发现以下潜在风险：

*   **硬编码的 IP 地址和端口：**POC 中包含一个硬编码的 IP 地址 `10.0.40.83:8081` 在 `execute` 方法中。这可能允许攻击者将受害者信息发送到攻击者控制的服务器。虽然表面上看起来像是用于回调 `whoami` 命令的结果，但恶意攻击者可以修改POC, 也可将其用于收集敏感信息。
*   **Reverse Shell Payload 的修改:** 虽然代码看起来是要设置反向shell, 可以通过修改,将反向shell地址写死,用于恶意用途

因此, 有潜在的投毒风险。由于脚本的行为主要还是漏洞利用,且硬编码的IP地址容易被发现,所以认为投毒风险为**10%**。

**项目地址:** [adhikara13/CVE-2023-27350](https://github.com/adhikara13/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #7

**来源**: [CVE-2023-27350-horizon3ai_CVE-2023-27350.md](../2023/CVE-2023-27350-horizon3ai_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过与远程代码执行漏洞

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统运行受影响版本的PaperCut NG/MF，且攻击者可以访问目标系统的网络。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个漏洞，允许未经身份验证的远程攻击者执行任意代码。攻击者首先利用身份验证绕过漏洞，然后滥用内置的脚本功能来执行代码。 

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用的有效性极高。CISA已经将此漏洞添加到已知被利用漏洞目录中，表明该漏洞正在被积极利用。Sophos等安全厂商也报告了针对该漏洞的攻击。

**投毒风险分析：**

PoC 代码本身主要包含以下几个步骤：

1.  **身份验证绕过：** 通过访问`/app?service=page/SetupCompleted`绕过身份验证。
2.  **设置修改：** 使用`set_setting`函数修改`print-and-device.script.enabled`和`print.script.sandboxed`配置项，启用打印脚本功能并禁用沙盒。
3.  **命令执行：**  通过修改打印机脚本，将攻击者提供的命令注入到`scriptBody`中执行。
4.  **配置恢复：** 执行完成之后恢复`print-and-device.script.enabled`和`print.script.sandboxed`配置项。

在`execute` 函数中，PoC 使用了 `curl` 命令来尝试将`whoami`命令的输出发送到 `http://10.0.40.83:8081`。这可能是PoC作者用于验证漏洞利用成功的一种方式，**但如果直接使用此PoC且目标环境可以访问公网，则可能泄露目标服务器的用户名**。这可以被视为一种潜在的投毒风险。

仔细检查代码后，没有发现明显的恶意代码，例如下载并执行其他程序，或者删除系统文件等。投毒的风险主要在于`execute`函数中硬编码的IP地址和端口号，以及`command`参数的潜在恶意利用。

总体来说，该仓库中存在作者隐藏的投毒代码的可能性较低，风险主要在于使用者不理解PoC代码的含义，直接使用导致的信息泄露，考虑到`curl`命令中的IP地址，以及`command`参数的潜在风险，因此，投毒风险评定为10%。

**利用方式分析：**

1.  攻击者首先利用身份验证绕过漏洞，无需提供任何凭据即可访问 PaperCut NG/MF 的管理界面。
2.  攻击者修改配置，允许执行打印脚本，并禁用脚本沙箱。
3.  攻击者构造包含恶意代码的打印脚本，并将该脚本上传到 PaperCut 服务器。
4.  当 PaperCut 服务器处理打印任务时，恶意脚本会被执行，从而导致远程代码执行。

**项目地址:** [horizon3ai/CVE-2023-27350](https://github.com/horizon3ai/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #8

**来源**: [CVE-2023-27350-imancybersecurity_CVE-2023-27350-POC.md](../2023/CVE-2023-27350-imancybersecurity_CVE-2023-27350-POC.md)

## CVE-2023-27350-PaperCut NG/MF Authentication Bypass and Remote Code Execution

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过,远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 极危，可导致完全系统控制

**影响版本:** 22.0.5 (Build 63914), 8.0 及以上，且低于 20.1.7, 21.2.11, 或 22.0.9

**利用条件:** 目标PaperCut服务器可通过网络访问,9191端口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350是一个存在于PaperCut NG/MF软件中的身份验证绕过漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者绕过身份验证并执行任意代码，获得SYSTEM权限。漏洞存在于SetupCompleted类中，原因是访问控制不当。多个安全厂商和CISA已发布警告，表明该漏洞已被恶意利用。

**有效性分析:**

提供的POC代码 `vuln.py` 主要用于检测目标PaperCut服务器是否存在漏洞，并通过`BeautifulSoup`解析HTML页面以获取版本信息。如果版本在受影响范围内，则脚本会打印易受攻击的信息以及绕过身份验证的URL。`README.md`中提供了利用步骤，包括使用给定的URL绕过身份验证，并利用PaperCut的内置脚本功能执行代码(未在提供的代码中体现，但在描述中提到)。综合来看，该POC代码的有效性较高，可以用来辅助漏洞验证。

**投毒风险分析:**

查看 `vuln.py` 代码，该脚本主要功能是发送HTTP请求、解析HTML并打印信息，未发现明显的恶意代码或后门。脚本依赖于`requests`，`bs4`和`pyfiglet`第三方库，理论上第三方库存在一定投毒风险，但概率较小。`README.md`文件中提供的指令本身不具备投毒行为。因此，综合评估投毒风险较低，约为10%。

**利用方式分析:**

1.  **版本检测:** 使用提供的`vuln.py`脚本检测目标PaperCut服务器的版本。该脚本通过访问`/app?service=page/SetupCompleted`页面，解析HTML获取版本信息。
2.  **身份验证绕过:** 如果版本在受影响范围内，则可以使用`http://<ip>:9191/app?service=page/Dashboard`URL绕过身份验证。
3.  **远程代码执行:** 身份验证绕过后，攻击者可以滥用PaperCut内置的脚本功能来执行任意代码。具体利用方式取决于PaperCut的配置和可用的API，由于未提供具体的执行代码，因此无法详细分析。但根据漏洞信息和搜索结果，执行任意代码是在SYSTEM上下文中进行的。

**项目地址:** [imancybersecurity/CVE-2023-27350-POC](https://github.com/imancybersecurity/CVE-2023-27350-POC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #9

**来源**: [CVE-2023-27350-monke443_CVE-2023-27350.md](../2023/CVE-2023-27350-monke443_CVE-2023-27350.md)

## CVE-2023-27350 - PaperCut NG/MF 身份验证绕过及远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 / 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，允许未经身份验证的远程攻击者以 SYSTEM 权限执行任意代码。

**影响版本:** < 22.0.8

**利用条件:** 目标系统运行受影响版本的 PaperCut NG/MF，且攻击者可访问目标服务器的网络。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 漏洞存在于 PaperCut NG/MF 软件中，允许未经身份验证的攻击者绕过身份验证并远程执行代码。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用方式如下：

1.  **身份验证绕过:** 攻击者利用 `SetupCompleted` Java类中的不当访问控制漏洞，通过构造特定的 HTTP 请求绕过身份验证，从而以管理员身份访问 PaperCut 服务器。
2.  **配置修改:** 绕过身份验证后，攻击者通过修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 配置项，启用打印脚本功能，并禁用沙盒环境。这为执行任意代码创造了条件。
3.  **远程代码执行:** 攻击者利用 PaperCut 软件自身提供的脚本执行功能，执行恶意的脚本代码，从而在服务器上执行任意命令。由于 PaperCut 服务器进程以 SYSTEM 或 root 权限运行，因此执行的命令也具有相应的权限。

**有效性:**

提供的POC代码通过发送特定的POST请求到 `/app?service=page/SetupCompleted` 绕过身份验证。成功后，它禁用打印脚本沙箱并启用打印和设备脚本，允许远程代码执行。PoC 包含检测漏洞是否存在的功能。

**投毒风险评估:**

该漏洞利用代码的 `README.md` 文件中包含警告信息，提示用户谨慎执行该脚本，因为它会重新配置服务器设置以执行命令。虽然脚本在退出时会尝试恢复更改，但在进程被错误终止时可能无法完全恢复。`exploit.py`没有发现恶意行为。但存在极小风险，脚本可能包含隐蔽的、难以检测的恶意代码，或者利用脚本执行远程恶意文件下载和执行。因此，投毒风险评估为 5%。建议在隔离环境中运行和分析该脚本。

**搜索引擎结果补充:**

搜索结果表明 CVE-2023-27350 漏洞被广泛利用，并已被 CISA 列入已知被利用的漏洞目录 (KEV)。多个安全厂商发布了相关的安全公告和分析报告，证实了该漏洞的严重性和利用价值。此外，有报告指出，Bloody 勒索软件团伙也利用该漏洞进行攻击。

**项目地址:** [monke443/CVE-2023-27350](https://github.com/monke443/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---



---

## POC #4

**来源**: [CVE-2023-27350-MaanVader_CVE-2023-27350-POC.md](../2023/CVE-2023-27350-MaanVader_CVE-2023-27350-POC.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过与远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可导致完全系统控制

**影响版本:** 22.0.5 (Build 63914) (NG)和受影响的MF版本

**利用条件:** 目标系统运行PaperCut NG/MF，且允许对9191端口的网络访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27350 允许未经身份验证的远程攻击者绕过 PaperCut NG/MF 的身份验证机制，从而实现远程代码执行。漏洞存在于 `SetupCompleted` 类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在 SYSTEM 上下文中执行任意代码。

**有效性：**
从搜索结果以及漏洞描述来看，漏洞真实存在并且已被积极利用。提供的 POC 代码 `find-vuln-ver.py` 旨在检测目标系统是否运行易受攻击的 PaperCut 版本，并通过访问特定的 URL 来引导攻击者进行身份验证绕过。根据github上的其他POC，第一步绕过验证获取权限，第二步利用内置的脚本功能执行代码。

**投毒风险：**
POC 代码 `find-vuln-ver.py` 本身主要用于检测漏洞版本，并给出绕过登录的URL，代码相对简单，不包含任何明显的恶意代码。但是,任何代码都不能保证绝对的安全。因此，极小的可能会有隐藏的投毒代码(比如通过特殊的字符编码、或者利用一些python的特性来执行恶意操作)。但是考虑到其功能主要是版本检测和URL引导，这个可能性非常低。所以投毒风险评定为1%。

**利用方式：**
1.  **版本检测:** 使用POC脚本或者手动访问`http://<ip>:9191/app?service=page/SetupCompleted`来检测PaperCut NG/MF的版本，确定目标系统是否是易受攻击的版本。
2.  **身份验证绕过:**  如果版本确认是易受攻击的版本，攻击者可以通过访问 `http://<ip>:9191/app?service=page/Dashboard` 来绕过身份验证。
3.  **远程代码执行:** 在绕过身份验证后，攻击者可以利用 PaperCut NG/MF 的内置脚本功能来执行任意代码。这通常涉及到上传恶意脚本或者利用已有的脚本执行机制。具体代码执行方式可能需要参考其他的PoC代码，搜索结果中提到了Horizon3ai的PoC。
4.  **权限提升:**  由于漏洞是在 SYSTEM 上下文中执行代码，攻击者可以完全控制受影响的系统。

**总结：**
CVE-2023-27350 是一个严重的安全漏洞，允许未经身份验证的攻击者完全控制 PaperCut NG/MF 服务器。 该漏洞已经被广泛利用，并被列入 CISA 已知被利用漏洞目录中。强烈建议受影响的用户立即应用补丁。

**项目地址:** [MaanVader/CVE-2023-27350-POC](https://github.com/MaanVader/CVE-2023-27350-POC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #5

**来源**: [CVE-2023-27350-Royall-Researchers_CVE-2023-27350.md](../2023/CVE-2023-27350-Royall-Researchers_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过远程代码执行漏洞

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 + 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 22.0.5 (Build 63914) 及 PaperCut MF 或 NG version 8.0 或 later (excluding patched versions) on all OS platforms.

**利用条件:** 目标服务器运行PaperCut NG/MF，且可以通过网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个严重漏洞，允许未经身份验证的远程攻击者绕过身份验证并以 SYSTEM 权限执行任意代码。漏洞存在于 `SetupCompleted` 类中，由于不正确的访问控制导致。

**利用方式：**

1.  **身份验证绕过：** 攻击者通过访问 `/app?service=page/SetupCompleted` 页面，然后发送特定的 POST 请求绕过身份验证。
2.  **配置修改：** 利用绕过的身份验证，攻击者修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 配置，启用脚本执行并禁用沙箱。
3.  **远程代码执行：** 攻击者通过修改打印机设置，插入恶意的 Groovy 脚本，从而在服务器上执行任意代码。脚本功能被滥用。

**POC 有效性：**
提供的 POC 代码通过模拟上述步骤，可以有效利用该漏洞，在目标服务器上执行任意命令。

**投毒风险：**
代码中存在投毒的风险较低。分析POC代码作者的目的是进行漏洞验证，其中`execute`函数中包含了执行命令的代码。通过对脚本的分析，未发现明显的恶意代码。curl命令中存在IP，可能会导致被收集。但总的来说风险较低。

**项目地址:** [Royall-Researchers/CVE-2023-27350](https://github.com/Royall-Researchers/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #6

**来源**: [CVE-2023-27350-ThatNotEasy_CVE-2023-27350.md](../2023/CVE-2023-27350-ThatNotEasy_CVE-2023-27350.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过和远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 极高，可能导致完全系统控制

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统安装了PaperCut NG/MF 22.0.5 (Build 63914)，攻击者需要能够通过网络访问PaperCut服务器。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 存在于 PaperCut NG/MF 软件中，允许未经身份验证的远程攻击者绕过身份验证并执行任意代码。漏洞位于 SetupCompleted 类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在 SYSTEM 上下文中执行任意代码。

**有效性：**
从搜索结果和漏洞库信息来看，该漏洞的POC是可用的，并且已经被积极利用。
提供的Python脚本看起来像是利用了该漏洞，通过访问`/app?service=page/SetupCompleted`路径来绕过身份验证。

**投毒风险：**
查看提供的python代码，代码较为简单，主要用于验证漏洞的存在。代码中引入了requests和BeautifulSoup4库用于发送HTTP请求和解析HTML。该脚本的功能是发送GET请求到目标PaperCut服务器的特定URL，并检查返回的HTML内容是否包含特定的标记，以确定漏洞是否存在。未发现明显的恶意代码。因此，该仓库中存在投毒代码的风险较低，估计在5%左右，主要是考虑到代码可能存在隐藏的缺陷或者依赖项被篡改的风险，但总体上代码逻辑较为清晰。

**利用方式：**
1.  攻击者首先发送特制的HTTP GET请求到目标PaperCut服务器的`/app?service=page/SetupCompleted`端点。
2.  服务器未正确验证身份，允许未经身份验证的访问。
3.  攻击者检查响应的内容以确认漏洞利用是否成功（通过解析HTML查找特定的产品信息）。
4.  成功绕过身份验证后，攻击者可能会利用PaperCut内置的脚本功能来执行任意代码，从而完全控制系统。
5.  参考搜索结果，攻击者可能利用此漏洞安装勒索软件。

**项目地址:** [ThatNotEasy/CVE-2023-27350](https://github.com/ThatNotEasy/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #7

**来源**: [CVE-2023-27350-adhikara13_CVE-2023-27350.md](../2023/CVE-2023-27350-adhikara13_CVE-2023-27350.md)

## CVE-2023-27350-PaperCut-身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 + 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统运行受影响版本的PaperCut NG/MF，且攻击者可以网络访问该系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 中的一个身份验证绕过漏洞。攻击者可以通过向 `/app?service=page/SetupCompleted` 发送特制请求来绕过身份验证。

**利用方式：**

1.  **身份验证绕过：** 未经身份验证的攻击者访问 `/app?service=page/SetupCompleted` 页面，利用不正确的访问控制绕过身份验证。
2.  **获取 Session ID:** 利用绕过的身份验证，通过构造特定的 POST 请求（例如，向 `/app` 发送带有`service=direct/1/SetupCompleted/$Form`的请求）获取有效的 JSESSIONID。
3.  **配置修改：** 使用获得的 JSESSIONID，通过发送 POST 请求到 `/app` 修改 PaperCut 的配置。关键配置包括：
    *   `print-and-device.script.enabled` 设置为 `Y` （启用打印脚本）。
    *   `print.script.sandboxed` 设置为 `N` （禁用脚本沙箱）。
4.  **远程代码执行：** 通过设置打印机脚本来执行任意代码。利用`PrinterDetails/$PrinterDetailsScript.$Form`，将恶意代码注入到`scriptBody`中。该脚本会在打印作业时执行，允许攻击者在系统上执行命令。

**有效性：**

提供的 POC 代码看起来是有效的。它包含以下步骤：

1.  **漏洞检测:**  脚本首先尝试通过访问 `/app?service=page/SetupCompleted` 页面来检测目标是否易受攻击。
2.  **会话获取:** 尝试获取有效的 JSESSIONID。
3.  **配置更改:**  修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 设置。
4.  **命令执行:** 通过打印机脚本注入恶意命令。

根据搜索引擎结果，此漏洞已被积极利用，并且有公开可用的 POC。

**投毒风险分析：**

虽然 POC 主要功能是利用漏洞，但仔细检查发现以下潜在风险：

*   **硬编码的 IP 地址和端口：**POC 中包含一个硬编码的 IP 地址 `10.0.40.83:8081` 在 `execute` 方法中。这可能允许攻击者将受害者信息发送到攻击者控制的服务器。虽然表面上看起来像是用于回调 `whoami` 命令的结果，但恶意攻击者可以修改POC, 也可将其用于收集敏感信息。
*   **Reverse Shell Payload 的修改:** 虽然代码看起来是要设置反向shell, 可以通过修改,将反向shell地址写死,用于恶意用途

因此, 有潜在的投毒风险。由于脚本的行为主要还是漏洞利用,且硬编码的IP地址容易被发现,所以认为投毒风险为**10%**。

**项目地址:** [adhikara13/CVE-2023-27350](https://github.com/adhikara13/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #8

**来源**: [CVE-2023-27350-horizon3ai_CVE-2023-27350.md](../2023/CVE-2023-27350-horizon3ai_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过与远程代码执行漏洞

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统运行受影响版本的PaperCut NG/MF，且攻击者可以访问目标系统的网络。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个漏洞，允许未经身份验证的远程攻击者执行任意代码。攻击者首先利用身份验证绕过漏洞，然后滥用内置的脚本功能来执行代码。 

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用的有效性极高。CISA已经将此漏洞添加到已知被利用漏洞目录中，表明该漏洞正在被积极利用。Sophos等安全厂商也报告了针对该漏洞的攻击。

**投毒风险分析：**

PoC 代码本身主要包含以下几个步骤：

1.  **身份验证绕过：** 通过访问`/app?service=page/SetupCompleted`绕过身份验证。
2.  **设置修改：** 使用`set_setting`函数修改`print-and-device.script.enabled`和`print.script.sandboxed`配置项，启用打印脚本功能并禁用沙盒。
3.  **命令执行：**  通过修改打印机脚本，将攻击者提供的命令注入到`scriptBody`中执行。
4.  **配置恢复：** 执行完成之后恢复`print-and-device.script.enabled`和`print.script.sandboxed`配置项。

在`execute` 函数中，PoC 使用了 `curl` 命令来尝试将`whoami`命令的输出发送到 `http://10.0.40.83:8081`。这可能是PoC作者用于验证漏洞利用成功的一种方式，**但如果直接使用此PoC且目标环境可以访问公网，则可能泄露目标服务器的用户名**。这可以被视为一种潜在的投毒风险。

仔细检查代码后，没有发现明显的恶意代码，例如下载并执行其他程序，或者删除系统文件等。投毒的风险主要在于`execute`函数中硬编码的IP地址和端口号，以及`command`参数的潜在恶意利用。

总体来说，该仓库中存在作者隐藏的投毒代码的可能性较低，风险主要在于使用者不理解PoC代码的含义，直接使用导致的信息泄露，考虑到`curl`命令中的IP地址，以及`command`参数的潜在风险，因此，投毒风险评定为10%。

**利用方式分析：**

1.  攻击者首先利用身份验证绕过漏洞，无需提供任何凭据即可访问 PaperCut NG/MF 的管理界面。
2.  攻击者修改配置，允许执行打印脚本，并禁用脚本沙箱。
3.  攻击者构造包含恶意代码的打印脚本，并将该脚本上传到 PaperCut 服务器。
4.  当 PaperCut 服务器处理打印任务时，恶意脚本会被执行，从而导致远程代码执行。

**项目地址:** [horizon3ai/CVE-2023-27350](https://github.com/horizon3ai/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #9

**来源**: [CVE-2023-27350-imancybersecurity_CVE-2023-27350-POC.md](../2023/CVE-2023-27350-imancybersecurity_CVE-2023-27350-POC.md)

## CVE-2023-27350-PaperCut NG/MF Authentication Bypass and Remote Code Execution

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过,远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 极危，可导致完全系统控制

**影响版本:** 22.0.5 (Build 63914), 8.0 及以上，且低于 20.1.7, 21.2.11, 或 22.0.9

**利用条件:** 目标PaperCut服务器可通过网络访问,9191端口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350是一个存在于PaperCut NG/MF软件中的身份验证绕过漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者绕过身份验证并执行任意代码，获得SYSTEM权限。漏洞存在于SetupCompleted类中，原因是访问控制不当。多个安全厂商和CISA已发布警告，表明该漏洞已被恶意利用。

**有效性分析:**

提供的POC代码 `vuln.py` 主要用于检测目标PaperCut服务器是否存在漏洞，并通过`BeautifulSoup`解析HTML页面以获取版本信息。如果版本在受影响范围内，则脚本会打印易受攻击的信息以及绕过身份验证的URL。`README.md`中提供了利用步骤，包括使用给定的URL绕过身份验证，并利用PaperCut的内置脚本功能执行代码(未在提供的代码中体现，但在描述中提到)。综合来看，该POC代码的有效性较高，可以用来辅助漏洞验证。

**投毒风险分析:**

查看 `vuln.py` 代码，该脚本主要功能是发送HTTP请求、解析HTML并打印信息，未发现明显的恶意代码或后门。脚本依赖于`requests`，`bs4`和`pyfiglet`第三方库，理论上第三方库存在一定投毒风险，但概率较小。`README.md`文件中提供的指令本身不具备投毒行为。因此，综合评估投毒风险较低，约为10%。

**利用方式分析:**

1.  **版本检测:** 使用提供的`vuln.py`脚本检测目标PaperCut服务器的版本。该脚本通过访问`/app?service=page/SetupCompleted`页面，解析HTML获取版本信息。
2.  **身份验证绕过:** 如果版本在受影响范围内，则可以使用`http://<ip>:9191/app?service=page/Dashboard`URL绕过身份验证。
3.  **远程代码执行:** 身份验证绕过后，攻击者可以滥用PaperCut内置的脚本功能来执行任意代码。具体利用方式取决于PaperCut的配置和可用的API，由于未提供具体的执行代码，因此无法详细分析。但根据漏洞信息和搜索结果，执行任意代码是在SYSTEM上下文中进行的。

**项目地址:** [imancybersecurity/CVE-2023-27350-POC](https://github.com/imancybersecurity/CVE-2023-27350-POC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #10

**来源**: [CVE-2023-27350-monke443_CVE-2023-27350.md](../2023/CVE-2023-27350-monke443_CVE-2023-27350.md)

## CVE-2023-27350 - PaperCut NG/MF 身份验证绕过及远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 / 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，允许未经身份验证的远程攻击者以 SYSTEM 权限执行任意代码。

**影响版本:** < 22.0.8

**利用条件:** 目标系统运行受影响版本的 PaperCut NG/MF，且攻击者可访问目标服务器的网络。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 漏洞存在于 PaperCut NG/MF 软件中，允许未经身份验证的攻击者绕过身份验证并远程执行代码。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用方式如下：

1.  **身份验证绕过:** 攻击者利用 `SetupCompleted` Java类中的不当访问控制漏洞，通过构造特定的 HTTP 请求绕过身份验证，从而以管理员身份访问 PaperCut 服务器。
2.  **配置修改:** 绕过身份验证后，攻击者通过修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 配置项，启用打印脚本功能，并禁用沙盒环境。这为执行任意代码创造了条件。
3.  **远程代码执行:** 攻击者利用 PaperCut 软件自身提供的脚本执行功能，执行恶意的脚本代码，从而在服务器上执行任意命令。由于 PaperCut 服务器进程以 SYSTEM 或 root 权限运行，因此执行的命令也具有相应的权限。

**有效性:**

提供的POC代码通过发送特定的POST请求到 `/app?service=page/SetupCompleted` 绕过身份验证。成功后，它禁用打印脚本沙箱并启用打印和设备脚本，允许远程代码执行。PoC 包含检测漏洞是否存在的功能。

**投毒风险评估:**

该漏洞利用代码的 `README.md` 文件中包含警告信息，提示用户谨慎执行该脚本，因为它会重新配置服务器设置以执行命令。虽然脚本在退出时会尝试恢复更改，但在进程被错误终止时可能无法完全恢复。`exploit.py`没有发现恶意行为。但存在极小风险，脚本可能包含隐蔽的、难以检测的恶意代码，或者利用脚本执行远程恶意文件下载和执行。因此，投毒风险评估为 5%。建议在隔离环境中运行和分析该脚本。

**搜索引擎结果补充:**

搜索结果表明 CVE-2023-27350 漏洞被广泛利用，并已被 CISA 列入已知被利用的漏洞目录 (KEV)。多个安全厂商发布了相关的安全公告和分析报告，证实了该漏洞的严重性和利用价值。此外，有报告指出，Bloody 勒索软件团伙也利用该漏洞进行攻击。

**项目地址:** [monke443/CVE-2023-27350](https://github.com/monke443/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---



---

## POC #4

**来源**: [CVE-2023-27350-MaanVader_CVE-2023-27350-POC.md](../2023/CVE-2023-27350-MaanVader_CVE-2023-27350-POC.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过与远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可导致完全系统控制

**影响版本:** 22.0.5 (Build 63914) (NG)和受影响的MF版本

**利用条件:** 目标系统运行PaperCut NG/MF，且允许对9191端口的网络访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27350 允许未经身份验证的远程攻击者绕过 PaperCut NG/MF 的身份验证机制，从而实现远程代码执行。漏洞存在于 `SetupCompleted` 类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在 SYSTEM 上下文中执行任意代码。

**有效性：**
从搜索结果以及漏洞描述来看，漏洞真实存在并且已被积极利用。提供的 POC 代码 `find-vuln-ver.py` 旨在检测目标系统是否运行易受攻击的 PaperCut 版本，并通过访问特定的 URL 来引导攻击者进行身份验证绕过。根据github上的其他POC，第一步绕过验证获取权限，第二步利用内置的脚本功能执行代码。

**投毒风险：**
POC 代码 `find-vuln-ver.py` 本身主要用于检测漏洞版本，并给出绕过登录的URL，代码相对简单，不包含任何明显的恶意代码。但是,任何代码都不能保证绝对的安全。因此，极小的可能会有隐藏的投毒代码(比如通过特殊的字符编码、或者利用一些python的特性来执行恶意操作)。但是考虑到其功能主要是版本检测和URL引导，这个可能性非常低。所以投毒风险评定为1%。

**利用方式：**
1.  **版本检测:** 使用POC脚本或者手动访问`http://<ip>:9191/app?service=page/SetupCompleted`来检测PaperCut NG/MF的版本，确定目标系统是否是易受攻击的版本。
2.  **身份验证绕过:**  如果版本确认是易受攻击的版本，攻击者可以通过访问 `http://<ip>:9191/app?service=page/Dashboard` 来绕过身份验证。
3.  **远程代码执行:** 在绕过身份验证后，攻击者可以利用 PaperCut NG/MF 的内置脚本功能来执行任意代码。这通常涉及到上传恶意脚本或者利用已有的脚本执行机制。具体代码执行方式可能需要参考其他的PoC代码，搜索结果中提到了Horizon3ai的PoC。
4.  **权限提升:**  由于漏洞是在 SYSTEM 上下文中执行代码，攻击者可以完全控制受影响的系统。

**总结：**
CVE-2023-27350 是一个严重的安全漏洞，允许未经身份验证的攻击者完全控制 PaperCut NG/MF 服务器。 该漏洞已经被广泛利用，并被列入 CISA 已知被利用漏洞目录中。强烈建议受影响的用户立即应用补丁。

**项目地址:** [MaanVader/CVE-2023-27350-POC](https://github.com/MaanVader/CVE-2023-27350-POC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #5

**来源**: [CVE-2023-27350-Royall-Researchers_CVE-2023-27350.md](../2023/CVE-2023-27350-Royall-Researchers_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过远程代码执行漏洞

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 + 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 22.0.5 (Build 63914) 及 PaperCut MF 或 NG version 8.0 或 later (excluding patched versions) on all OS platforms.

**利用条件:** 目标服务器运行PaperCut NG/MF，且可以通过网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个严重漏洞，允许未经身份验证的远程攻击者绕过身份验证并以 SYSTEM 权限执行任意代码。漏洞存在于 `SetupCompleted` 类中，由于不正确的访问控制导致。

**利用方式：**

1.  **身份验证绕过：** 攻击者通过访问 `/app?service=page/SetupCompleted` 页面，然后发送特定的 POST 请求绕过身份验证。
2.  **配置修改：** 利用绕过的身份验证，攻击者修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 配置，启用脚本执行并禁用沙箱。
3.  **远程代码执行：** 攻击者通过修改打印机设置，插入恶意的 Groovy 脚本，从而在服务器上执行任意代码。脚本功能被滥用。

**POC 有效性：**
提供的 POC 代码通过模拟上述步骤，可以有效利用该漏洞，在目标服务器上执行任意命令。

**投毒风险：**
代码中存在投毒的风险较低。分析POC代码作者的目的是进行漏洞验证，其中`execute`函数中包含了执行命令的代码。通过对脚本的分析，未发现明显的恶意代码。curl命令中存在IP，可能会导致被收集。但总的来说风险较低。

**项目地址:** [Royall-Researchers/CVE-2023-27350](https://github.com/Royall-Researchers/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #6

**来源**: [CVE-2023-27350-ThatNotEasy_CVE-2023-27350.md](../2023/CVE-2023-27350-ThatNotEasy_CVE-2023-27350.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过和远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 极高，可能导致完全系统控制

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统安装了PaperCut NG/MF 22.0.5 (Build 63914)，攻击者需要能够通过网络访问PaperCut服务器。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 存在于 PaperCut NG/MF 软件中，允许未经身份验证的远程攻击者绕过身份验证并执行任意代码。漏洞位于 SetupCompleted 类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在 SYSTEM 上下文中执行任意代码。

**有效性：**
从搜索结果和漏洞库信息来看，该漏洞的POC是可用的，并且已经被积极利用。
提供的Python脚本看起来像是利用了该漏洞，通过访问`/app?service=page/SetupCompleted`路径来绕过身份验证。

**投毒风险：**
查看提供的python代码，代码较为简单，主要用于验证漏洞的存在。代码中引入了requests和BeautifulSoup4库用于发送HTTP请求和解析HTML。该脚本的功能是发送GET请求到目标PaperCut服务器的特定URL，并检查返回的HTML内容是否包含特定的标记，以确定漏洞是否存在。未发现明显的恶意代码。因此，该仓库中存在投毒代码的风险较低，估计在5%左右，主要是考虑到代码可能存在隐藏的缺陷或者依赖项被篡改的风险，但总体上代码逻辑较为清晰。

**利用方式：**
1.  攻击者首先发送特制的HTTP GET请求到目标PaperCut服务器的`/app?service=page/SetupCompleted`端点。
2.  服务器未正确验证身份，允许未经身份验证的访问。
3.  攻击者检查响应的内容以确认漏洞利用是否成功（通过解析HTML查找特定的产品信息）。
4.  成功绕过身份验证后，攻击者可能会利用PaperCut内置的脚本功能来执行任意代码，从而完全控制系统。
5.  参考搜索结果，攻击者可能利用此漏洞安装勒索软件。

**项目地址:** [ThatNotEasy/CVE-2023-27350](https://github.com/ThatNotEasy/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #7

**来源**: [CVE-2023-27350-adhikara13_CVE-2023-27350.md](../2023/CVE-2023-27350-adhikara13_CVE-2023-27350.md)

## CVE-2023-27350-PaperCut-身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 + 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统运行受影响版本的PaperCut NG/MF，且攻击者可以网络访问该系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 中的一个身份验证绕过漏洞。攻击者可以通过向 `/app?service=page/SetupCompleted` 发送特制请求来绕过身份验证。

**利用方式：**

1.  **身份验证绕过：** 未经身份验证的攻击者访问 `/app?service=page/SetupCompleted` 页面，利用不正确的访问控制绕过身份验证。
2.  **获取 Session ID:** 利用绕过的身份验证，通过构造特定的 POST 请求（例如，向 `/app` 发送带有`service=direct/1/SetupCompleted/$Form`的请求）获取有效的 JSESSIONID。
3.  **配置修改：** 使用获得的 JSESSIONID，通过发送 POST 请求到 `/app` 修改 PaperCut 的配置。关键配置包括：
    *   `print-and-device.script.enabled` 设置为 `Y` （启用打印脚本）。
    *   `print.script.sandboxed` 设置为 `N` （禁用脚本沙箱）。
4.  **远程代码执行：** 通过设置打印机脚本来执行任意代码。利用`PrinterDetails/$PrinterDetailsScript.$Form`，将恶意代码注入到`scriptBody`中。该脚本会在打印作业时执行，允许攻击者在系统上执行命令。

**有效性：**

提供的 POC 代码看起来是有效的。它包含以下步骤：

1.  **漏洞检测:**  脚本首先尝试通过访问 `/app?service=page/SetupCompleted` 页面来检测目标是否易受攻击。
2.  **会话获取:** 尝试获取有效的 JSESSIONID。
3.  **配置更改:**  修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 设置。
4.  **命令执行:** 通过打印机脚本注入恶意命令。

根据搜索引擎结果，此漏洞已被积极利用，并且有公开可用的 POC。

**投毒风险分析：**

虽然 POC 主要功能是利用漏洞，但仔细检查发现以下潜在风险：

*   **硬编码的 IP 地址和端口：**POC 中包含一个硬编码的 IP 地址 `10.0.40.83:8081` 在 `execute` 方法中。这可能允许攻击者将受害者信息发送到攻击者控制的服务器。虽然表面上看起来像是用于回调 `whoami` 命令的结果，但恶意攻击者可以修改POC, 也可将其用于收集敏感信息。
*   **Reverse Shell Payload 的修改:** 虽然代码看起来是要设置反向shell, 可以通过修改,将反向shell地址写死,用于恶意用途

因此, 有潜在的投毒风险。由于脚本的行为主要还是漏洞利用,且硬编码的IP地址容易被发现,所以认为投毒风险为**10%**。

**项目地址:** [adhikara13/CVE-2023-27350](https://github.com/adhikara13/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #8

**来源**: [CVE-2023-27350-horizon3ai_CVE-2023-27350.md](../2023/CVE-2023-27350-horizon3ai_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过与远程代码执行漏洞

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统运行受影响版本的PaperCut NG/MF，且攻击者可以访问目标系统的网络。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个漏洞，允许未经身份验证的远程攻击者执行任意代码。攻击者首先利用身份验证绕过漏洞，然后滥用内置的脚本功能来执行代码。 

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用的有效性极高。CISA已经将此漏洞添加到已知被利用漏洞目录中，表明该漏洞正在被积极利用。Sophos等安全厂商也报告了针对该漏洞的攻击。

**投毒风险分析：**

PoC 代码本身主要包含以下几个步骤：

1.  **身份验证绕过：** 通过访问`/app?service=page/SetupCompleted`绕过身份验证。
2.  **设置修改：** 使用`set_setting`函数修改`print-and-device.script.enabled`和`print.script.sandboxed`配置项，启用打印脚本功能并禁用沙盒。
3.  **命令执行：**  通过修改打印机脚本，将攻击者提供的命令注入到`scriptBody`中执行。
4.  **配置恢复：** 执行完成之后恢复`print-and-device.script.enabled`和`print.script.sandboxed`配置项。

在`execute` 函数中，PoC 使用了 `curl` 命令来尝试将`whoami`命令的输出发送到 `http://10.0.40.83:8081`。这可能是PoC作者用于验证漏洞利用成功的一种方式，**但如果直接使用此PoC且目标环境可以访问公网，则可能泄露目标服务器的用户名**。这可以被视为一种潜在的投毒风险。

仔细检查代码后，没有发现明显的恶意代码，例如下载并执行其他程序，或者删除系统文件等。投毒的风险主要在于`execute`函数中硬编码的IP地址和端口号，以及`command`参数的潜在恶意利用。

总体来说，该仓库中存在作者隐藏的投毒代码的可能性较低，风险主要在于使用者不理解PoC代码的含义，直接使用导致的信息泄露，考虑到`curl`命令中的IP地址，以及`command`参数的潜在风险，因此，投毒风险评定为10%。

**利用方式分析：**

1.  攻击者首先利用身份验证绕过漏洞，无需提供任何凭据即可访问 PaperCut NG/MF 的管理界面。
2.  攻击者修改配置，允许执行打印脚本，并禁用脚本沙箱。
3.  攻击者构造包含恶意代码的打印脚本，并将该脚本上传到 PaperCut 服务器。
4.  当 PaperCut 服务器处理打印任务时，恶意脚本会被执行，从而导致远程代码执行。

**项目地址:** [horizon3ai/CVE-2023-27350](https://github.com/horizon3ai/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #9

**来源**: [CVE-2023-27350-imancybersecurity_CVE-2023-27350-POC.md](../2023/CVE-2023-27350-imancybersecurity_CVE-2023-27350-POC.md)

## CVE-2023-27350-PaperCut NG/MF Authentication Bypass and Remote Code Execution

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过,远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 极危，可导致完全系统控制

**影响版本:** 22.0.5 (Build 63914), 8.0 及以上，且低于 20.1.7, 21.2.11, 或 22.0.9

**利用条件:** 目标PaperCut服务器可通过网络访问,9191端口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350是一个存在于PaperCut NG/MF软件中的身份验证绕过漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者绕过身份验证并执行任意代码，获得SYSTEM权限。漏洞存在于SetupCompleted类中，原因是访问控制不当。多个安全厂商和CISA已发布警告，表明该漏洞已被恶意利用。

**有效性分析:**

提供的POC代码 `vuln.py` 主要用于检测目标PaperCut服务器是否存在漏洞，并通过`BeautifulSoup`解析HTML页面以获取版本信息。如果版本在受影响范围内，则脚本会打印易受攻击的信息以及绕过身份验证的URL。`README.md`中提供了利用步骤，包括使用给定的URL绕过身份验证，并利用PaperCut的内置脚本功能执行代码(未在提供的代码中体现，但在描述中提到)。综合来看，该POC代码的有效性较高，可以用来辅助漏洞验证。

**投毒风险分析:**

查看 `vuln.py` 代码，该脚本主要功能是发送HTTP请求、解析HTML并打印信息，未发现明显的恶意代码或后门。脚本依赖于`requests`，`bs4`和`pyfiglet`第三方库，理论上第三方库存在一定投毒风险，但概率较小。`README.md`文件中提供的指令本身不具备投毒行为。因此，综合评估投毒风险较低，约为10%。

**利用方式分析:**

1.  **版本检测:** 使用提供的`vuln.py`脚本检测目标PaperCut服务器的版本。该脚本通过访问`/app?service=page/SetupCompleted`页面，解析HTML获取版本信息。
2.  **身份验证绕过:** 如果版本在受影响范围内，则可以使用`http://<ip>:9191/app?service=page/Dashboard`URL绕过身份验证。
3.  **远程代码执行:** 身份验证绕过后，攻击者可以滥用PaperCut内置的脚本功能来执行任意代码。具体利用方式取决于PaperCut的配置和可用的API，由于未提供具体的执行代码，因此无法详细分析。但根据漏洞信息和搜索结果，执行任意代码是在SYSTEM上下文中进行的。

**项目地址:** [imancybersecurity/CVE-2023-27350-POC](https://github.com/imancybersecurity/CVE-2023-27350-POC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #10

**来源**: [CVE-2023-27350-monke443_CVE-2023-27350.md](../2023/CVE-2023-27350-monke443_CVE-2023-27350.md)

## CVE-2023-27350 - PaperCut NG/MF 身份验证绕过及远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 / 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，允许未经身份验证的远程攻击者以 SYSTEM 权限执行任意代码。

**影响版本:** < 22.0.8

**利用条件:** 目标系统运行受影响版本的 PaperCut NG/MF，且攻击者可访问目标服务器的网络。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 漏洞存在于 PaperCut NG/MF 软件中，允许未经身份验证的攻击者绕过身份验证并远程执行代码。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用方式如下：

1.  **身份验证绕过:** 攻击者利用 `SetupCompleted` Java类中的不当访问控制漏洞，通过构造特定的 HTTP 请求绕过身份验证，从而以管理员身份访问 PaperCut 服务器。
2.  **配置修改:** 绕过身份验证后，攻击者通过修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 配置项，启用打印脚本功能，并禁用沙盒环境。这为执行任意代码创造了条件。
3.  **远程代码执行:** 攻击者利用 PaperCut 软件自身提供的脚本执行功能，执行恶意的脚本代码，从而在服务器上执行任意命令。由于 PaperCut 服务器进程以 SYSTEM 或 root 权限运行，因此执行的命令也具有相应的权限。

**有效性:**

提供的POC代码通过发送特定的POST请求到 `/app?service=page/SetupCompleted` 绕过身份验证。成功后，它禁用打印脚本沙箱并启用打印和设备脚本，允许远程代码执行。PoC 包含检测漏洞是否存在的功能。

**投毒风险评估:**

该漏洞利用代码的 `README.md` 文件中包含警告信息，提示用户谨慎执行该脚本，因为它会重新配置服务器设置以执行命令。虽然脚本在退出时会尝试恢复更改，但在进程被错误终止时可能无法完全恢复。`exploit.py`没有发现恶意行为。但存在极小风险，脚本可能包含隐蔽的、难以检测的恶意代码，或者利用脚本执行远程恶意文件下载和执行。因此，投毒风险评估为 5%。建议在隔离环境中运行和分析该脚本。

**搜索引擎结果补充:**

搜索结果表明 CVE-2023-27350 漏洞被广泛利用，并已被 CISA 列入已知被利用的漏洞目录 (KEV)。多个安全厂商发布了相关的安全公告和分析报告，证实了该漏洞的严重性和利用价值。此外，有报告指出，Bloody 勒索软件团伙也利用该漏洞进行攻击。

**项目地址:** [monke443/CVE-2023-27350](https://github.com/monke443/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---



---

## POC #4

**来源**: [CVE-2023-27350-MaanVader_CVE-2023-27350-POC.md](../2023/CVE-2023-27350-MaanVader_CVE-2023-27350-POC.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过与远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可导致完全系统控制

**影响版本:** 22.0.5 (Build 63914) (NG)和受影响的MF版本

**利用条件:** 目标系统运行PaperCut NG/MF，且允许对9191端口的网络访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27350 允许未经身份验证的远程攻击者绕过 PaperCut NG/MF 的身份验证机制，从而实现远程代码执行。漏洞存在于 `SetupCompleted` 类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在 SYSTEM 上下文中执行任意代码。

**有效性：**
从搜索结果以及漏洞描述来看，漏洞真实存在并且已被积极利用。提供的 POC 代码 `find-vuln-ver.py` 旨在检测目标系统是否运行易受攻击的 PaperCut 版本，并通过访问特定的 URL 来引导攻击者进行身份验证绕过。根据github上的其他POC，第一步绕过验证获取权限，第二步利用内置的脚本功能执行代码。

**投毒风险：**
POC 代码 `find-vuln-ver.py` 本身主要用于检测漏洞版本，并给出绕过登录的URL，代码相对简单，不包含任何明显的恶意代码。但是,任何代码都不能保证绝对的安全。因此，极小的可能会有隐藏的投毒代码(比如通过特殊的字符编码、或者利用一些python的特性来执行恶意操作)。但是考虑到其功能主要是版本检测和URL引导，这个可能性非常低。所以投毒风险评定为1%。

**利用方式：**
1.  **版本检测:** 使用POC脚本或者手动访问`http://<ip>:9191/app?service=page/SetupCompleted`来检测PaperCut NG/MF的版本，确定目标系统是否是易受攻击的版本。
2.  **身份验证绕过:**  如果版本确认是易受攻击的版本，攻击者可以通过访问 `http://<ip>:9191/app?service=page/Dashboard` 来绕过身份验证。
3.  **远程代码执行:** 在绕过身份验证后，攻击者可以利用 PaperCut NG/MF 的内置脚本功能来执行任意代码。这通常涉及到上传恶意脚本或者利用已有的脚本执行机制。具体代码执行方式可能需要参考其他的PoC代码，搜索结果中提到了Horizon3ai的PoC。
4.  **权限提升:**  由于漏洞是在 SYSTEM 上下文中执行代码，攻击者可以完全控制受影响的系统。

**总结：**
CVE-2023-27350 是一个严重的安全漏洞，允许未经身份验证的攻击者完全控制 PaperCut NG/MF 服务器。 该漏洞已经被广泛利用，并被列入 CISA 已知被利用漏洞目录中。强烈建议受影响的用户立即应用补丁。

**项目地址:** [MaanVader/CVE-2023-27350-POC](https://github.com/MaanVader/CVE-2023-27350-POC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #5

**来源**: [CVE-2023-27350-Royall-Researchers_CVE-2023-27350.md](../2023/CVE-2023-27350-Royall-Researchers_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过远程代码执行漏洞

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 + 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 22.0.5 (Build 63914) 及 PaperCut MF 或 NG version 8.0 或 later (excluding patched versions) on all OS platforms.

**利用条件:** 目标服务器运行PaperCut NG/MF，且可以通过网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个严重漏洞，允许未经身份验证的远程攻击者绕过身份验证并以 SYSTEM 权限执行任意代码。漏洞存在于 `SetupCompleted` 类中，由于不正确的访问控制导致。

**利用方式：**

1.  **身份验证绕过：** 攻击者通过访问 `/app?service=page/SetupCompleted` 页面，然后发送特定的 POST 请求绕过身份验证。
2.  **配置修改：** 利用绕过的身份验证，攻击者修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 配置，启用脚本执行并禁用沙箱。
3.  **远程代码执行：** 攻击者通过修改打印机设置，插入恶意的 Groovy 脚本，从而在服务器上执行任意代码。脚本功能被滥用。

**POC 有效性：**
提供的 POC 代码通过模拟上述步骤，可以有效利用该漏洞，在目标服务器上执行任意命令。

**投毒风险：**
代码中存在投毒的风险较低。分析POC代码作者的目的是进行漏洞验证，其中`execute`函数中包含了执行命令的代码。通过对脚本的分析，未发现明显的恶意代码。curl命令中存在IP，可能会导致被收集。但总的来说风险较低。

**项目地址:** [Royall-Researchers/CVE-2023-27350](https://github.com/Royall-Researchers/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #6

**来源**: [CVE-2023-27350-ThatNotEasy_CVE-2023-27350.md](../2023/CVE-2023-27350-ThatNotEasy_CVE-2023-27350.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过和远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 极高，可能导致完全系统控制

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统安装了PaperCut NG/MF 22.0.5 (Build 63914)，攻击者需要能够通过网络访问PaperCut服务器。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 存在于 PaperCut NG/MF 软件中，允许未经身份验证的远程攻击者绕过身份验证并执行任意代码。漏洞位于 SetupCompleted 类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在 SYSTEM 上下文中执行任意代码。

**有效性：**
从搜索结果和漏洞库信息来看，该漏洞的POC是可用的，并且已经被积极利用。
提供的Python脚本看起来像是利用了该漏洞，通过访问`/app?service=page/SetupCompleted`路径来绕过身份验证。

**投毒风险：**
查看提供的python代码，代码较为简单，主要用于验证漏洞的存在。代码中引入了requests和BeautifulSoup4库用于发送HTTP请求和解析HTML。该脚本的功能是发送GET请求到目标PaperCut服务器的特定URL，并检查返回的HTML内容是否包含特定的标记，以确定漏洞是否存在。未发现明显的恶意代码。因此，该仓库中存在投毒代码的风险较低，估计在5%左右，主要是考虑到代码可能存在隐藏的缺陷或者依赖项被篡改的风险，但总体上代码逻辑较为清晰。

**利用方式：**
1.  攻击者首先发送特制的HTTP GET请求到目标PaperCut服务器的`/app?service=page/SetupCompleted`端点。
2.  服务器未正确验证身份，允许未经身份验证的访问。
3.  攻击者检查响应的内容以确认漏洞利用是否成功（通过解析HTML查找特定的产品信息）。
4.  成功绕过身份验证后，攻击者可能会利用PaperCut内置的脚本功能来执行任意代码，从而完全控制系统。
5.  参考搜索结果，攻击者可能利用此漏洞安装勒索软件。

**项目地址:** [ThatNotEasy/CVE-2023-27350](https://github.com/ThatNotEasy/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #7

**来源**: [CVE-2023-27350-adhikara13_CVE-2023-27350.md](../2023/CVE-2023-27350-adhikara13_CVE-2023-27350.md)

## CVE-2023-27350-PaperCut-身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 + 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统运行受影响版本的PaperCut NG/MF，且攻击者可以网络访问该系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 中的一个身份验证绕过漏洞。攻击者可以通过向 `/app?service=page/SetupCompleted` 发送特制请求来绕过身份验证。

**利用方式：**

1.  **身份验证绕过：** 未经身份验证的攻击者访问 `/app?service=page/SetupCompleted` 页面，利用不正确的访问控制绕过身份验证。
2.  **获取 Session ID:** 利用绕过的身份验证，通过构造特定的 POST 请求（例如，向 `/app` 发送带有`service=direct/1/SetupCompleted/$Form`的请求）获取有效的 JSESSIONID。
3.  **配置修改：** 使用获得的 JSESSIONID，通过发送 POST 请求到 `/app` 修改 PaperCut 的配置。关键配置包括：
    *   `print-and-device.script.enabled` 设置为 `Y` （启用打印脚本）。
    *   `print.script.sandboxed` 设置为 `N` （禁用脚本沙箱）。
4.  **远程代码执行：** 通过设置打印机脚本来执行任意代码。利用`PrinterDetails/$PrinterDetailsScript.$Form`，将恶意代码注入到`scriptBody`中。该脚本会在打印作业时执行，允许攻击者在系统上执行命令。

**有效性：**

提供的 POC 代码看起来是有效的。它包含以下步骤：

1.  **漏洞检测:**  脚本首先尝试通过访问 `/app?service=page/SetupCompleted` 页面来检测目标是否易受攻击。
2.  **会话获取:** 尝试获取有效的 JSESSIONID。
3.  **配置更改:**  修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 设置。
4.  **命令执行:** 通过打印机脚本注入恶意命令。

根据搜索引擎结果，此漏洞已被积极利用，并且有公开可用的 POC。

**投毒风险分析：**

虽然 POC 主要功能是利用漏洞，但仔细检查发现以下潜在风险：

*   **硬编码的 IP 地址和端口：**POC 中包含一个硬编码的 IP 地址 `10.0.40.83:8081` 在 `execute` 方法中。这可能允许攻击者将受害者信息发送到攻击者控制的服务器。虽然表面上看起来像是用于回调 `whoami` 命令的结果，但恶意攻击者可以修改POC, 也可将其用于收集敏感信息。
*   **Reverse Shell Payload 的修改:** 虽然代码看起来是要设置反向shell, 可以通过修改,将反向shell地址写死,用于恶意用途

因此, 有潜在的投毒风险。由于脚本的行为主要还是漏洞利用,且硬编码的IP地址容易被发现,所以认为投毒风险为**10%**。

**项目地址:** [adhikara13/CVE-2023-27350](https://github.com/adhikara13/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #8

**来源**: [CVE-2023-27350-horizon3ai_CVE-2023-27350.md](../2023/CVE-2023-27350-horizon3ai_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过与远程代码执行漏洞

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统运行受影响版本的PaperCut NG/MF，且攻击者可以访问目标系统的网络。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个漏洞，允许未经身份验证的远程攻击者执行任意代码。攻击者首先利用身份验证绕过漏洞，然后滥用内置的脚本功能来执行代码。 

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用的有效性极高。CISA已经将此漏洞添加到已知被利用漏洞目录中，表明该漏洞正在被积极利用。Sophos等安全厂商也报告了针对该漏洞的攻击。

**投毒风险分析：**

PoC 代码本身主要包含以下几个步骤：

1.  **身份验证绕过：** 通过访问`/app?service=page/SetupCompleted`绕过身份验证。
2.  **设置修改：** 使用`set_setting`函数修改`print-and-device.script.enabled`和`print.script.sandboxed`配置项，启用打印脚本功能并禁用沙盒。
3.  **命令执行：**  通过修改打印机脚本，将攻击者提供的命令注入到`scriptBody`中执行。
4.  **配置恢复：** 执行完成之后恢复`print-and-device.script.enabled`和`print.script.sandboxed`配置项。

在`execute` 函数中，PoC 使用了 `curl` 命令来尝试将`whoami`命令的输出发送到 `http://10.0.40.83:8081`。这可能是PoC作者用于验证漏洞利用成功的一种方式，**但如果直接使用此PoC且目标环境可以访问公网，则可能泄露目标服务器的用户名**。这可以被视为一种潜在的投毒风险。

仔细检查代码后，没有发现明显的恶意代码，例如下载并执行其他程序，或者删除系统文件等。投毒的风险主要在于`execute`函数中硬编码的IP地址和端口号，以及`command`参数的潜在恶意利用。

总体来说，该仓库中存在作者隐藏的投毒代码的可能性较低，风险主要在于使用者不理解PoC代码的含义，直接使用导致的信息泄露，考虑到`curl`命令中的IP地址，以及`command`参数的潜在风险，因此，投毒风险评定为10%。

**利用方式分析：**

1.  攻击者首先利用身份验证绕过漏洞，无需提供任何凭据即可访问 PaperCut NG/MF 的管理界面。
2.  攻击者修改配置，允许执行打印脚本，并禁用脚本沙箱。
3.  攻击者构造包含恶意代码的打印脚本，并将该脚本上传到 PaperCut 服务器。
4.  当 PaperCut 服务器处理打印任务时，恶意脚本会被执行，从而导致远程代码执行。

**项目地址:** [horizon3ai/CVE-2023-27350](https://github.com/horizon3ai/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #9

**来源**: [CVE-2023-27350-imancybersecurity_CVE-2023-27350-POC.md](../2023/CVE-2023-27350-imancybersecurity_CVE-2023-27350-POC.md)

## CVE-2023-27350-PaperCut NG/MF Authentication Bypass and Remote Code Execution

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过,远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 极危，可导致完全系统控制

**影响版本:** 22.0.5 (Build 63914), 8.0 及以上，且低于 20.1.7, 21.2.11, 或 22.0.9

**利用条件:** 目标PaperCut服务器可通过网络访问,9191端口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350是一个存在于PaperCut NG/MF软件中的身份验证绕过漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者绕过身份验证并执行任意代码，获得SYSTEM权限。漏洞存在于SetupCompleted类中，原因是访问控制不当。多个安全厂商和CISA已发布警告，表明该漏洞已被恶意利用。

**有效性分析:**

提供的POC代码 `vuln.py` 主要用于检测目标PaperCut服务器是否存在漏洞，并通过`BeautifulSoup`解析HTML页面以获取版本信息。如果版本在受影响范围内，则脚本会打印易受攻击的信息以及绕过身份验证的URL。`README.md`中提供了利用步骤，包括使用给定的URL绕过身份验证，并利用PaperCut的内置脚本功能执行代码(未在提供的代码中体现，但在描述中提到)。综合来看，该POC代码的有效性较高，可以用来辅助漏洞验证。

**投毒风险分析:**

查看 `vuln.py` 代码，该脚本主要功能是发送HTTP请求、解析HTML并打印信息，未发现明显的恶意代码或后门。脚本依赖于`requests`，`bs4`和`pyfiglet`第三方库，理论上第三方库存在一定投毒风险，但概率较小。`README.md`文件中提供的指令本身不具备投毒行为。因此，综合评估投毒风险较低，约为10%。

**利用方式分析:**

1.  **版本检测:** 使用提供的`vuln.py`脚本检测目标PaperCut服务器的版本。该脚本通过访问`/app?service=page/SetupCompleted`页面，解析HTML获取版本信息。
2.  **身份验证绕过:** 如果版本在受影响范围内，则可以使用`http://<ip>:9191/app?service=page/Dashboard`URL绕过身份验证。
3.  **远程代码执行:** 身份验证绕过后，攻击者可以滥用PaperCut内置的脚本功能来执行任意代码。具体利用方式取决于PaperCut的配置和可用的API，由于未提供具体的执行代码，因此无法详细分析。但根据漏洞信息和搜索结果，执行任意代码是在SYSTEM上下文中进行的。

**项目地址:** [imancybersecurity/CVE-2023-27350-POC](https://github.com/imancybersecurity/CVE-2023-27350-POC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #10

**来源**: [CVE-2023-27350-monke443_CVE-2023-27350.md](../2023/CVE-2023-27350-monke443_CVE-2023-27350.md)

## CVE-2023-27350 - PaperCut NG/MF 身份验证绕过及远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 / 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，允许未经身份验证的远程攻击者以 SYSTEM 权限执行任意代码。

**影响版本:** < 22.0.8

**利用条件:** 目标系统运行受影响版本的 PaperCut NG/MF，且攻击者可访问目标服务器的网络。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 漏洞存在于 PaperCut NG/MF 软件中，允许未经身份验证的攻击者绕过身份验证并远程执行代码。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用方式如下：

1.  **身份验证绕过:** 攻击者利用 `SetupCompleted` Java类中的不当访问控制漏洞，通过构造特定的 HTTP 请求绕过身份验证，从而以管理员身份访问 PaperCut 服务器。
2.  **配置修改:** 绕过身份验证后，攻击者通过修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 配置项，启用打印脚本功能，并禁用沙盒环境。这为执行任意代码创造了条件。
3.  **远程代码执行:** 攻击者利用 PaperCut 软件自身提供的脚本执行功能，执行恶意的脚本代码，从而在服务器上执行任意命令。由于 PaperCut 服务器进程以 SYSTEM 或 root 权限运行，因此执行的命令也具有相应的权限。

**有效性:**

提供的POC代码通过发送特定的POST请求到 `/app?service=page/SetupCompleted` 绕过身份验证。成功后，它禁用打印脚本沙箱并启用打印和设备脚本，允许远程代码执行。PoC 包含检测漏洞是否存在的功能。

**投毒风险评估:**

该漏洞利用代码的 `README.md` 文件中包含警告信息，提示用户谨慎执行该脚本，因为它会重新配置服务器设置以执行命令。虽然脚本在退出时会尝试恢复更改，但在进程被错误终止时可能无法完全恢复。`exploit.py`没有发现恶意行为。但存在极小风险，脚本可能包含隐蔽的、难以检测的恶意代码，或者利用脚本执行远程恶意文件下载和执行。因此，投毒风险评估为 5%。建议在隔离环境中运行和分析该脚本。

**搜索引擎结果补充:**

搜索结果表明 CVE-2023-27350 漏洞被广泛利用，并已被 CISA 列入已知被利用的漏洞目录 (KEV)。多个安全厂商发布了相关的安全公告和分析报告，证实了该漏洞的严重性和利用价值。此外，有报告指出，Bloody 勒索软件团伙也利用该漏洞进行攻击。

**项目地址:** [monke443/CVE-2023-27350](https://github.com/monke443/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---



---

## POC #4

**来源**: [CVE-2023-27350-MaanVader_CVE-2023-27350-POC.md](../2023/CVE-2023-27350-MaanVader_CVE-2023-27350-POC.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过与远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可导致完全系统控制

**影响版本:** 22.0.5 (Build 63914) (NG)和受影响的MF版本

**利用条件:** 目标系统运行PaperCut NG/MF，且允许对9191端口的网络访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27350 允许未经身份验证的远程攻击者绕过 PaperCut NG/MF 的身份验证机制，从而实现远程代码执行。漏洞存在于 `SetupCompleted` 类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在 SYSTEM 上下文中执行任意代码。

**有效性：**
从搜索结果以及漏洞描述来看，漏洞真实存在并且已被积极利用。提供的 POC 代码 `find-vuln-ver.py` 旨在检测目标系统是否运行易受攻击的 PaperCut 版本，并通过访问特定的 URL 来引导攻击者进行身份验证绕过。根据github上的其他POC，第一步绕过验证获取权限，第二步利用内置的脚本功能执行代码。

**投毒风险：**
POC 代码 `find-vuln-ver.py` 本身主要用于检测漏洞版本，并给出绕过登录的URL，代码相对简单，不包含任何明显的恶意代码。但是,任何代码都不能保证绝对的安全。因此，极小的可能会有隐藏的投毒代码(比如通过特殊的字符编码、或者利用一些python的特性来执行恶意操作)。但是考虑到其功能主要是版本检测和URL引导，这个可能性非常低。所以投毒风险评定为1%。

**利用方式：**
1.  **版本检测:** 使用POC脚本或者手动访问`http://<ip>:9191/app?service=page/SetupCompleted`来检测PaperCut NG/MF的版本，确定目标系统是否是易受攻击的版本。
2.  **身份验证绕过:**  如果版本确认是易受攻击的版本，攻击者可以通过访问 `http://<ip>:9191/app?service=page/Dashboard` 来绕过身份验证。
3.  **远程代码执行:** 在绕过身份验证后，攻击者可以利用 PaperCut NG/MF 的内置脚本功能来执行任意代码。这通常涉及到上传恶意脚本或者利用已有的脚本执行机制。具体代码执行方式可能需要参考其他的PoC代码，搜索结果中提到了Horizon3ai的PoC。
4.  **权限提升:**  由于漏洞是在 SYSTEM 上下文中执行代码，攻击者可以完全控制受影响的系统。

**总结：**
CVE-2023-27350 是一个严重的安全漏洞，允许未经身份验证的攻击者完全控制 PaperCut NG/MF 服务器。 该漏洞已经被广泛利用，并被列入 CISA 已知被利用漏洞目录中。强烈建议受影响的用户立即应用补丁。

**项目地址:** [MaanVader/CVE-2023-27350-POC](https://github.com/MaanVader/CVE-2023-27350-POC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #5

**来源**: [CVE-2023-27350-Royall-Researchers_CVE-2023-27350.md](../2023/CVE-2023-27350-Royall-Researchers_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过远程代码执行漏洞

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 + 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 22.0.5 (Build 63914) 及 PaperCut MF 或 NG version 8.0 或 later (excluding patched versions) on all OS platforms.

**利用条件:** 目标服务器运行PaperCut NG/MF，且可以通过网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个严重漏洞，允许未经身份验证的远程攻击者绕过身份验证并以 SYSTEM 权限执行任意代码。漏洞存在于 `SetupCompleted` 类中，由于不正确的访问控制导致。

**利用方式：**

1.  **身份验证绕过：** 攻击者通过访问 `/app?service=page/SetupCompleted` 页面，然后发送特定的 POST 请求绕过身份验证。
2.  **配置修改：** 利用绕过的身份验证，攻击者修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 配置，启用脚本执行并禁用沙箱。
3.  **远程代码执行：** 攻击者通过修改打印机设置，插入恶意的 Groovy 脚本，从而在服务器上执行任意代码。脚本功能被滥用。

**POC 有效性：**
提供的 POC 代码通过模拟上述步骤，可以有效利用该漏洞，在目标服务器上执行任意命令。

**投毒风险：**
代码中存在投毒的风险较低。分析POC代码作者的目的是进行漏洞验证，其中`execute`函数中包含了执行命令的代码。通过对脚本的分析，未发现明显的恶意代码。curl命令中存在IP，可能会导致被收集。但总的来说风险较低。

**项目地址:** [Royall-Researchers/CVE-2023-27350](https://github.com/Royall-Researchers/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #6

**来源**: [CVE-2023-27350-ThatNotEasy_CVE-2023-27350.md](../2023/CVE-2023-27350-ThatNotEasy_CVE-2023-27350.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过和远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 极高，可能导致完全系统控制

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统安装了PaperCut NG/MF 22.0.5 (Build 63914)，攻击者需要能够通过网络访问PaperCut服务器。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 存在于 PaperCut NG/MF 软件中，允许未经身份验证的远程攻击者绕过身份验证并执行任意代码。漏洞位于 SetupCompleted 类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在 SYSTEM 上下文中执行任意代码。

**有效性：**
从搜索结果和漏洞库信息来看，该漏洞的POC是可用的，并且已经被积极利用。
提供的Python脚本看起来像是利用了该漏洞，通过访问`/app?service=page/SetupCompleted`路径来绕过身份验证。

**投毒风险：**
查看提供的python代码，代码较为简单，主要用于验证漏洞的存在。代码中引入了requests和BeautifulSoup4库用于发送HTTP请求和解析HTML。该脚本的功能是发送GET请求到目标PaperCut服务器的特定URL，并检查返回的HTML内容是否包含特定的标记，以确定漏洞是否存在。未发现明显的恶意代码。因此，该仓库中存在投毒代码的风险较低，估计在5%左右，主要是考虑到代码可能存在隐藏的缺陷或者依赖项被篡改的风险，但总体上代码逻辑较为清晰。

**利用方式：**
1.  攻击者首先发送特制的HTTP GET请求到目标PaperCut服务器的`/app?service=page/SetupCompleted`端点。
2.  服务器未正确验证身份，允许未经身份验证的访问。
3.  攻击者检查响应的内容以确认漏洞利用是否成功（通过解析HTML查找特定的产品信息）。
4.  成功绕过身份验证后，攻击者可能会利用PaperCut内置的脚本功能来执行任意代码，从而完全控制系统。
5.  参考搜索结果，攻击者可能利用此漏洞安装勒索软件。

**项目地址:** [ThatNotEasy/CVE-2023-27350](https://github.com/ThatNotEasy/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #7

**来源**: [CVE-2023-27350-adhikara13_CVE-2023-27350.md](../2023/CVE-2023-27350-adhikara13_CVE-2023-27350.md)

## CVE-2023-27350-PaperCut-身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 + 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统运行受影响版本的PaperCut NG/MF，且攻击者可以网络访问该系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 中的一个身份验证绕过漏洞。攻击者可以通过向 `/app?service=page/SetupCompleted` 发送特制请求来绕过身份验证。

**利用方式：**

1.  **身份验证绕过：** 未经身份验证的攻击者访问 `/app?service=page/SetupCompleted` 页面，利用不正确的访问控制绕过身份验证。
2.  **获取 Session ID:** 利用绕过的身份验证，通过构造特定的 POST 请求（例如，向 `/app` 发送带有`service=direct/1/SetupCompleted/$Form`的请求）获取有效的 JSESSIONID。
3.  **配置修改：** 使用获得的 JSESSIONID，通过发送 POST 请求到 `/app` 修改 PaperCut 的配置。关键配置包括：
    *   `print-and-device.script.enabled` 设置为 `Y` （启用打印脚本）。
    *   `print.script.sandboxed` 设置为 `N` （禁用脚本沙箱）。
4.  **远程代码执行：** 通过设置打印机脚本来执行任意代码。利用`PrinterDetails/$PrinterDetailsScript.$Form`，将恶意代码注入到`scriptBody`中。该脚本会在打印作业时执行，允许攻击者在系统上执行命令。

**有效性：**

提供的 POC 代码看起来是有效的。它包含以下步骤：

1.  **漏洞检测:**  脚本首先尝试通过访问 `/app?service=page/SetupCompleted` 页面来检测目标是否易受攻击。
2.  **会话获取:** 尝试获取有效的 JSESSIONID。
3.  **配置更改:**  修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 设置。
4.  **命令执行:** 通过打印机脚本注入恶意命令。

根据搜索引擎结果，此漏洞已被积极利用，并且有公开可用的 POC。

**投毒风险分析：**

虽然 POC 主要功能是利用漏洞，但仔细检查发现以下潜在风险：

*   **硬编码的 IP 地址和端口：**POC 中包含一个硬编码的 IP 地址 `10.0.40.83:8081` 在 `execute` 方法中。这可能允许攻击者将受害者信息发送到攻击者控制的服务器。虽然表面上看起来像是用于回调 `whoami` 命令的结果，但恶意攻击者可以修改POC, 也可将其用于收集敏感信息。
*   **Reverse Shell Payload 的修改:** 虽然代码看起来是要设置反向shell, 可以通过修改,将反向shell地址写死,用于恶意用途

因此, 有潜在的投毒风险。由于脚本的行为主要还是漏洞利用,且硬编码的IP地址容易被发现,所以认为投毒风险为**10%**。

**项目地址:** [adhikara13/CVE-2023-27350](https://github.com/adhikara13/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #8

**来源**: [CVE-2023-27350-horizon3ai_CVE-2023-27350.md](../2023/CVE-2023-27350-horizon3ai_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过与远程代码执行漏洞

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统运行受影响版本的PaperCut NG/MF，且攻击者可以访问目标系统的网络。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个漏洞，允许未经身份验证的远程攻击者执行任意代码。攻击者首先利用身份验证绕过漏洞，然后滥用内置的脚本功能来执行代码。 

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用的有效性极高。CISA已经将此漏洞添加到已知被利用漏洞目录中，表明该漏洞正在被积极利用。Sophos等安全厂商也报告了针对该漏洞的攻击。

**投毒风险分析：**

PoC 代码本身主要包含以下几个步骤：

1.  **身份验证绕过：** 通过访问`/app?service=page/SetupCompleted`绕过身份验证。
2.  **设置修改：** 使用`set_setting`函数修改`print-and-device.script.enabled`和`print.script.sandboxed`配置项，启用打印脚本功能并禁用沙盒。
3.  **命令执行：**  通过修改打印机脚本，将攻击者提供的命令注入到`scriptBody`中执行。
4.  **配置恢复：** 执行完成之后恢复`print-and-device.script.enabled`和`print.script.sandboxed`配置项。

在`execute` 函数中，PoC 使用了 `curl` 命令来尝试将`whoami`命令的输出发送到 `http://10.0.40.83:8081`。这可能是PoC作者用于验证漏洞利用成功的一种方式，**但如果直接使用此PoC且目标环境可以访问公网，则可能泄露目标服务器的用户名**。这可以被视为一种潜在的投毒风险。

仔细检查代码后，没有发现明显的恶意代码，例如下载并执行其他程序，或者删除系统文件等。投毒的风险主要在于`execute`函数中硬编码的IP地址和端口号，以及`command`参数的潜在恶意利用。

总体来说，该仓库中存在作者隐藏的投毒代码的可能性较低，风险主要在于使用者不理解PoC代码的含义，直接使用导致的信息泄露，考虑到`curl`命令中的IP地址，以及`command`参数的潜在风险，因此，投毒风险评定为10%。

**利用方式分析：**

1.  攻击者首先利用身份验证绕过漏洞，无需提供任何凭据即可访问 PaperCut NG/MF 的管理界面。
2.  攻击者修改配置，允许执行打印脚本，并禁用脚本沙箱。
3.  攻击者构造包含恶意代码的打印脚本，并将该脚本上传到 PaperCut 服务器。
4.  当 PaperCut 服务器处理打印任务时，恶意脚本会被执行，从而导致远程代码执行。

**项目地址:** [horizon3ai/CVE-2023-27350](https://github.com/horizon3ai/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #9

**来源**: [CVE-2023-27350-imancybersecurity_CVE-2023-27350-POC.md](../2023/CVE-2023-27350-imancybersecurity_CVE-2023-27350-POC.md)

## CVE-2023-27350-PaperCut NG/MF Authentication Bypass and Remote Code Execution

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过,远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 极危，可导致完全系统控制

**影响版本:** 22.0.5 (Build 63914), 8.0 及以上，且低于 20.1.7, 21.2.11, 或 22.0.9

**利用条件:** 目标PaperCut服务器可通过网络访问,9191端口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350是一个存在于PaperCut NG/MF软件中的身份验证绕过漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者绕过身份验证并执行任意代码，获得SYSTEM权限。漏洞存在于SetupCompleted类中，原因是访问控制不当。多个安全厂商和CISA已发布警告，表明该漏洞已被恶意利用。

**有效性分析:**

提供的POC代码 `vuln.py` 主要用于检测目标PaperCut服务器是否存在漏洞，并通过`BeautifulSoup`解析HTML页面以获取版本信息。如果版本在受影响范围内，则脚本会打印易受攻击的信息以及绕过身份验证的URL。`README.md`中提供了利用步骤，包括使用给定的URL绕过身份验证，并利用PaperCut的内置脚本功能执行代码(未在提供的代码中体现，但在描述中提到)。综合来看，该POC代码的有效性较高，可以用来辅助漏洞验证。

**投毒风险分析:**

查看 `vuln.py` 代码，该脚本主要功能是发送HTTP请求、解析HTML并打印信息，未发现明显的恶意代码或后门。脚本依赖于`requests`，`bs4`和`pyfiglet`第三方库，理论上第三方库存在一定投毒风险，但概率较小。`README.md`文件中提供的指令本身不具备投毒行为。因此，综合评估投毒风险较低，约为10%。

**利用方式分析:**

1.  **版本检测:** 使用提供的`vuln.py`脚本检测目标PaperCut服务器的版本。该脚本通过访问`/app?service=page/SetupCompleted`页面，解析HTML获取版本信息。
2.  **身份验证绕过:** 如果版本在受影响范围内，则可以使用`http://<ip>:9191/app?service=page/Dashboard`URL绕过身份验证。
3.  **远程代码执行:** 身份验证绕过后，攻击者可以滥用PaperCut内置的脚本功能来执行任意代码。具体利用方式取决于PaperCut的配置和可用的API，由于未提供具体的执行代码，因此无法详细分析。但根据漏洞信息和搜索结果，执行任意代码是在SYSTEM上下文中进行的。

**项目地址:** [imancybersecurity/CVE-2023-27350-POC](https://github.com/imancybersecurity/CVE-2023-27350-POC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #10

**来源**: [CVE-2023-27350-monke443_CVE-2023-27350.md](../2023/CVE-2023-27350-monke443_CVE-2023-27350.md)

## CVE-2023-27350 - PaperCut NG/MF 身份验证绕过及远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 / 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，允许未经身份验证的远程攻击者以 SYSTEM 权限执行任意代码。

**影响版本:** < 22.0.8

**利用条件:** 目标系统运行受影响版本的 PaperCut NG/MF，且攻击者可访问目标服务器的网络。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 漏洞存在于 PaperCut NG/MF 软件中，允许未经身份验证的攻击者绕过身份验证并远程执行代码。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用方式如下：

1.  **身份验证绕过:** 攻击者利用 `SetupCompleted` Java类中的不当访问控制漏洞，通过构造特定的 HTTP 请求绕过身份验证，从而以管理员身份访问 PaperCut 服务器。
2.  **配置修改:** 绕过身份验证后，攻击者通过修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 配置项，启用打印脚本功能，并禁用沙盒环境。这为执行任意代码创造了条件。
3.  **远程代码执行:** 攻击者利用 PaperCut 软件自身提供的脚本执行功能，执行恶意的脚本代码，从而在服务器上执行任意命令。由于 PaperCut 服务器进程以 SYSTEM 或 root 权限运行，因此执行的命令也具有相应的权限。

**有效性:**

提供的POC代码通过发送特定的POST请求到 `/app?service=page/SetupCompleted` 绕过身份验证。成功后，它禁用打印脚本沙箱并启用打印和设备脚本，允许远程代码执行。PoC 包含检测漏洞是否存在的功能。

**投毒风险评估:**

该漏洞利用代码的 `README.md` 文件中包含警告信息，提示用户谨慎执行该脚本，因为它会重新配置服务器设置以执行命令。虽然脚本在退出时会尝试恢复更改，但在进程被错误终止时可能无法完全恢复。`exploit.py`没有发现恶意行为。但存在极小风险，脚本可能包含隐蔽的、难以检测的恶意代码，或者利用脚本执行远程恶意文件下载和执行。因此，投毒风险评估为 5%。建议在隔离环境中运行和分析该脚本。

**搜索引擎结果补充:**

搜索结果表明 CVE-2023-27350 漏洞被广泛利用，并已被 CISA 列入已知被利用的漏洞目录 (KEV)。多个安全厂商发布了相关的安全公告和分析报告，证实了该漏洞的严重性和利用价值。此外，有报告指出，Bloody 勒索软件团伙也利用该漏洞进行攻击。

**项目地址:** [monke443/CVE-2023-27350](https://github.com/monke443/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---



---

## POC #4

**来源**: [CVE-2023-27350-MaanVader_CVE-2023-27350-POC.md](../2023/CVE-2023-27350-MaanVader_CVE-2023-27350-POC.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过与远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可导致完全系统控制

**影响版本:** 22.0.5 (Build 63914) (NG)和受影响的MF版本

**利用条件:** 目标系统运行PaperCut NG/MF，且允许对9191端口的网络访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27350 允许未经身份验证的远程攻击者绕过 PaperCut NG/MF 的身份验证机制，从而实现远程代码执行。漏洞存在于 `SetupCompleted` 类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在 SYSTEM 上下文中执行任意代码。

**有效性：**
从搜索结果以及漏洞描述来看，漏洞真实存在并且已被积极利用。提供的 POC 代码 `find-vuln-ver.py` 旨在检测目标系统是否运行易受攻击的 PaperCut 版本，并通过访问特定的 URL 来引导攻击者进行身份验证绕过。根据github上的其他POC，第一步绕过验证获取权限，第二步利用内置的脚本功能执行代码。

**投毒风险：**
POC 代码 `find-vuln-ver.py` 本身主要用于检测漏洞版本，并给出绕过登录的URL，代码相对简单，不包含任何明显的恶意代码。但是,任何代码都不能保证绝对的安全。因此，极小的可能会有隐藏的投毒代码(比如通过特殊的字符编码、或者利用一些python的特性来执行恶意操作)。但是考虑到其功能主要是版本检测和URL引导，这个可能性非常低。所以投毒风险评定为1%。

**利用方式：**
1.  **版本检测:** 使用POC脚本或者手动访问`http://<ip>:9191/app?service=page/SetupCompleted`来检测PaperCut NG/MF的版本，确定目标系统是否是易受攻击的版本。
2.  **身份验证绕过:**  如果版本确认是易受攻击的版本，攻击者可以通过访问 `http://<ip>:9191/app?service=page/Dashboard` 来绕过身份验证。
3.  **远程代码执行:** 在绕过身份验证后，攻击者可以利用 PaperCut NG/MF 的内置脚本功能来执行任意代码。这通常涉及到上传恶意脚本或者利用已有的脚本执行机制。具体代码执行方式可能需要参考其他的PoC代码，搜索结果中提到了Horizon3ai的PoC。
4.  **权限提升:**  由于漏洞是在 SYSTEM 上下文中执行代码，攻击者可以完全控制受影响的系统。

**总结：**
CVE-2023-27350 是一个严重的安全漏洞，允许未经身份验证的攻击者完全控制 PaperCut NG/MF 服务器。 该漏洞已经被广泛利用，并被列入 CISA 已知被利用漏洞目录中。强烈建议受影响的用户立即应用补丁。

**项目地址:** [MaanVader/CVE-2023-27350-POC](https://github.com/MaanVader/CVE-2023-27350-POC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #5

**来源**: [CVE-2023-27350-Royall-Researchers_CVE-2023-27350.md](../2023/CVE-2023-27350-Royall-Researchers_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过远程代码执行漏洞

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 + 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 22.0.5 (Build 63914) 及 PaperCut MF 或 NG version 8.0 或 later (excluding patched versions) on all OS platforms.

**利用条件:** 目标服务器运行PaperCut NG/MF，且可以通过网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个严重漏洞，允许未经身份验证的远程攻击者绕过身份验证并以 SYSTEM 权限执行任意代码。漏洞存在于 `SetupCompleted` 类中，由于不正确的访问控制导致。

**利用方式：**

1.  **身份验证绕过：** 攻击者通过访问 `/app?service=page/SetupCompleted` 页面，然后发送特定的 POST 请求绕过身份验证。
2.  **配置修改：** 利用绕过的身份验证，攻击者修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 配置，启用脚本执行并禁用沙箱。
3.  **远程代码执行：** 攻击者通过修改打印机设置，插入恶意的 Groovy 脚本，从而在服务器上执行任意代码。脚本功能被滥用。

**POC 有效性：**
提供的 POC 代码通过模拟上述步骤，可以有效利用该漏洞，在目标服务器上执行任意命令。

**投毒风险：**
代码中存在投毒的风险较低。分析POC代码作者的目的是进行漏洞验证，其中`execute`函数中包含了执行命令的代码。通过对脚本的分析，未发现明显的恶意代码。curl命令中存在IP，可能会导致被收集。但总的来说风险较低。

**项目地址:** [Royall-Researchers/CVE-2023-27350](https://github.com/Royall-Researchers/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #6

**来源**: [CVE-2023-27350-ThatNotEasy_CVE-2023-27350.md](../2023/CVE-2023-27350-ThatNotEasy_CVE-2023-27350.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过和远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 极高，可能导致完全系统控制

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统安装了PaperCut NG/MF 22.0.5 (Build 63914)，攻击者需要能够通过网络访问PaperCut服务器。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 存在于 PaperCut NG/MF 软件中，允许未经身份验证的远程攻击者绕过身份验证并执行任意代码。漏洞位于 SetupCompleted 类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在 SYSTEM 上下文中执行任意代码。

**有效性：**
从搜索结果和漏洞库信息来看，该漏洞的POC是可用的，并且已经被积极利用。
提供的Python脚本看起来像是利用了该漏洞，通过访问`/app?service=page/SetupCompleted`路径来绕过身份验证。

**投毒风险：**
查看提供的python代码，代码较为简单，主要用于验证漏洞的存在。代码中引入了requests和BeautifulSoup4库用于发送HTTP请求和解析HTML。该脚本的功能是发送GET请求到目标PaperCut服务器的特定URL，并检查返回的HTML内容是否包含特定的标记，以确定漏洞是否存在。未发现明显的恶意代码。因此，该仓库中存在投毒代码的风险较低，估计在5%左右，主要是考虑到代码可能存在隐藏的缺陷或者依赖项被篡改的风险，但总体上代码逻辑较为清晰。

**利用方式：**
1.  攻击者首先发送特制的HTTP GET请求到目标PaperCut服务器的`/app?service=page/SetupCompleted`端点。
2.  服务器未正确验证身份，允许未经身份验证的访问。
3.  攻击者检查响应的内容以确认漏洞利用是否成功（通过解析HTML查找特定的产品信息）。
4.  成功绕过身份验证后，攻击者可能会利用PaperCut内置的脚本功能来执行任意代码，从而完全控制系统。
5.  参考搜索结果，攻击者可能利用此漏洞安装勒索软件。

**项目地址:** [ThatNotEasy/CVE-2023-27350](https://github.com/ThatNotEasy/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #7

**来源**: [CVE-2023-27350-adhikara13_CVE-2023-27350.md](../2023/CVE-2023-27350-adhikara13_CVE-2023-27350.md)

## CVE-2023-27350-PaperCut-身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 + 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统运行受影响版本的PaperCut NG/MF，且攻击者可以网络访问该系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 中的一个身份验证绕过漏洞。攻击者可以通过向 `/app?service=page/SetupCompleted` 发送特制请求来绕过身份验证。

**利用方式：**

1.  **身份验证绕过：** 未经身份验证的攻击者访问 `/app?service=page/SetupCompleted` 页面，利用不正确的访问控制绕过身份验证。
2.  **获取 Session ID:** 利用绕过的身份验证，通过构造特定的 POST 请求（例如，向 `/app` 发送带有`service=direct/1/SetupCompleted/$Form`的请求）获取有效的 JSESSIONID。
3.  **配置修改：** 使用获得的 JSESSIONID，通过发送 POST 请求到 `/app` 修改 PaperCut 的配置。关键配置包括：
    *   `print-and-device.script.enabled` 设置为 `Y` （启用打印脚本）。
    *   `print.script.sandboxed` 设置为 `N` （禁用脚本沙箱）。
4.  **远程代码执行：** 通过设置打印机脚本来执行任意代码。利用`PrinterDetails/$PrinterDetailsScript.$Form`，将恶意代码注入到`scriptBody`中。该脚本会在打印作业时执行，允许攻击者在系统上执行命令。

**有效性：**

提供的 POC 代码看起来是有效的。它包含以下步骤：

1.  **漏洞检测:**  脚本首先尝试通过访问 `/app?service=page/SetupCompleted` 页面来检测目标是否易受攻击。
2.  **会话获取:** 尝试获取有效的 JSESSIONID。
3.  **配置更改:**  修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 设置。
4.  **命令执行:** 通过打印机脚本注入恶意命令。

根据搜索引擎结果，此漏洞已被积极利用，并且有公开可用的 POC。

**投毒风险分析：**

虽然 POC 主要功能是利用漏洞，但仔细检查发现以下潜在风险：

*   **硬编码的 IP 地址和端口：**POC 中包含一个硬编码的 IP 地址 `10.0.40.83:8081` 在 `execute` 方法中。这可能允许攻击者将受害者信息发送到攻击者控制的服务器。虽然表面上看起来像是用于回调 `whoami` 命令的结果，但恶意攻击者可以修改POC, 也可将其用于收集敏感信息。
*   **Reverse Shell Payload 的修改:** 虽然代码看起来是要设置反向shell, 可以通过修改,将反向shell地址写死,用于恶意用途

因此, 有潜在的投毒风险。由于脚本的行为主要还是漏洞利用,且硬编码的IP地址容易被发现,所以认为投毒风险为**10%**。

**项目地址:** [adhikara13/CVE-2023-27350](https://github.com/adhikara13/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #8

**来源**: [CVE-2023-27350-horizon3ai_CVE-2023-27350.md](../2023/CVE-2023-27350-horizon3ai_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过与远程代码执行漏洞

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统运行受影响版本的PaperCut NG/MF，且攻击者可以访问目标系统的网络。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个漏洞，允许未经身份验证的远程攻击者执行任意代码。攻击者首先利用身份验证绕过漏洞，然后滥用内置的脚本功能来执行代码。 

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用的有效性极高。CISA已经将此漏洞添加到已知被利用漏洞目录中，表明该漏洞正在被积极利用。Sophos等安全厂商也报告了针对该漏洞的攻击。

**投毒风险分析：**

PoC 代码本身主要包含以下几个步骤：

1.  **身份验证绕过：** 通过访问`/app?service=page/SetupCompleted`绕过身份验证。
2.  **设置修改：** 使用`set_setting`函数修改`print-and-device.script.enabled`和`print.script.sandboxed`配置项，启用打印脚本功能并禁用沙盒。
3.  **命令执行：**  通过修改打印机脚本，将攻击者提供的命令注入到`scriptBody`中执行。
4.  **配置恢复：** 执行完成之后恢复`print-and-device.script.enabled`和`print.script.sandboxed`配置项。

在`execute` 函数中，PoC 使用了 `curl` 命令来尝试将`whoami`命令的输出发送到 `http://10.0.40.83:8081`。这可能是PoC作者用于验证漏洞利用成功的一种方式，**但如果直接使用此PoC且目标环境可以访问公网，则可能泄露目标服务器的用户名**。这可以被视为一种潜在的投毒风险。

仔细检查代码后，没有发现明显的恶意代码，例如下载并执行其他程序，或者删除系统文件等。投毒的风险主要在于`execute`函数中硬编码的IP地址和端口号，以及`command`参数的潜在恶意利用。

总体来说，该仓库中存在作者隐藏的投毒代码的可能性较低，风险主要在于使用者不理解PoC代码的含义，直接使用导致的信息泄露，考虑到`curl`命令中的IP地址，以及`command`参数的潜在风险，因此，投毒风险评定为10%。

**利用方式分析：**

1.  攻击者首先利用身份验证绕过漏洞，无需提供任何凭据即可访问 PaperCut NG/MF 的管理界面。
2.  攻击者修改配置，允许执行打印脚本，并禁用脚本沙箱。
3.  攻击者构造包含恶意代码的打印脚本，并将该脚本上传到 PaperCut 服务器。
4.  当 PaperCut 服务器处理打印任务时，恶意脚本会被执行，从而导致远程代码执行。

**项目地址:** [horizon3ai/CVE-2023-27350](https://github.com/horizon3ai/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #9

**来源**: [CVE-2023-27350-imancybersecurity_CVE-2023-27350-POC.md](../2023/CVE-2023-27350-imancybersecurity_CVE-2023-27350-POC.md)

## CVE-2023-27350-PaperCut NG/MF Authentication Bypass and Remote Code Execution

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过,远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 极危，可导致完全系统控制

**影响版本:** 22.0.5 (Build 63914), 8.0 及以上，且低于 20.1.7, 21.2.11, 或 22.0.9

**利用条件:** 目标PaperCut服务器可通过网络访问,9191端口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350是一个存在于PaperCut NG/MF软件中的身份验证绕过漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者绕过身份验证并执行任意代码，获得SYSTEM权限。漏洞存在于SetupCompleted类中，原因是访问控制不当。多个安全厂商和CISA已发布警告，表明该漏洞已被恶意利用。

**有效性分析:**

提供的POC代码 `vuln.py` 主要用于检测目标PaperCut服务器是否存在漏洞，并通过`BeautifulSoup`解析HTML页面以获取版本信息。如果版本在受影响范围内，则脚本会打印易受攻击的信息以及绕过身份验证的URL。`README.md`中提供了利用步骤，包括使用给定的URL绕过身份验证，并利用PaperCut的内置脚本功能执行代码(未在提供的代码中体现，但在描述中提到)。综合来看，该POC代码的有效性较高，可以用来辅助漏洞验证。

**投毒风险分析:**

查看 `vuln.py` 代码，该脚本主要功能是发送HTTP请求、解析HTML并打印信息，未发现明显的恶意代码或后门。脚本依赖于`requests`，`bs4`和`pyfiglet`第三方库，理论上第三方库存在一定投毒风险，但概率较小。`README.md`文件中提供的指令本身不具备投毒行为。因此，综合评估投毒风险较低，约为10%。

**利用方式分析:**

1.  **版本检测:** 使用提供的`vuln.py`脚本检测目标PaperCut服务器的版本。该脚本通过访问`/app?service=page/SetupCompleted`页面，解析HTML获取版本信息。
2.  **身份验证绕过:** 如果版本在受影响范围内，则可以使用`http://<ip>:9191/app?service=page/Dashboard`URL绕过身份验证。
3.  **远程代码执行:** 身份验证绕过后，攻击者可以滥用PaperCut内置的脚本功能来执行任意代码。具体利用方式取决于PaperCut的配置和可用的API，由于未提供具体的执行代码，因此无法详细分析。但根据漏洞信息和搜索结果，执行任意代码是在SYSTEM上下文中进行的。

**项目地址:** [imancybersecurity/CVE-2023-27350-POC](https://github.com/imancybersecurity/CVE-2023-27350-POC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #10

**来源**: [CVE-2023-27350-monke443_CVE-2023-27350.md](../2023/CVE-2023-27350-monke443_CVE-2023-27350.md)

## CVE-2023-27350 - PaperCut NG/MF 身份验证绕过及远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 / 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，允许未经身份验证的远程攻击者以 SYSTEM 权限执行任意代码。

**影响版本:** < 22.0.8

**利用条件:** 目标系统运行受影响版本的 PaperCut NG/MF，且攻击者可访问目标服务器的网络。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 漏洞存在于 PaperCut NG/MF 软件中，允许未经身份验证的攻击者绕过身份验证并远程执行代码。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用方式如下：

1.  **身份验证绕过:** 攻击者利用 `SetupCompleted` Java类中的不当访问控制漏洞，通过构造特定的 HTTP 请求绕过身份验证，从而以管理员身份访问 PaperCut 服务器。
2.  **配置修改:** 绕过身份验证后，攻击者通过修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 配置项，启用打印脚本功能，并禁用沙盒环境。这为执行任意代码创造了条件。
3.  **远程代码执行:** 攻击者利用 PaperCut 软件自身提供的脚本执行功能，执行恶意的脚本代码，从而在服务器上执行任意命令。由于 PaperCut 服务器进程以 SYSTEM 或 root 权限运行，因此执行的命令也具有相应的权限。

**有效性:**

提供的POC代码通过发送特定的POST请求到 `/app?service=page/SetupCompleted` 绕过身份验证。成功后，它禁用打印脚本沙箱并启用打印和设备脚本，允许远程代码执行。PoC 包含检测漏洞是否存在的功能。

**投毒风险评估:**

该漏洞利用代码的 `README.md` 文件中包含警告信息，提示用户谨慎执行该脚本，因为它会重新配置服务器设置以执行命令。虽然脚本在退出时会尝试恢复更改，但在进程被错误终止时可能无法完全恢复。`exploit.py`没有发现恶意行为。但存在极小风险，脚本可能包含隐蔽的、难以检测的恶意代码，或者利用脚本执行远程恶意文件下载和执行。因此，投毒风险评估为 5%。建议在隔离环境中运行和分析该脚本。

**搜索引擎结果补充:**

搜索结果表明 CVE-2023-27350 漏洞被广泛利用，并已被 CISA 列入已知被利用的漏洞目录 (KEV)。多个安全厂商发布了相关的安全公告和分析报告，证实了该漏洞的严重性和利用价值。此外，有报告指出，Bloody 勒索软件团伙也利用该漏洞进行攻击。

**项目地址:** [monke443/CVE-2023-27350](https://github.com/monke443/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---



---

## POC #4

**来源**: [CVE-2023-27350-MaanVader_CVE-2023-27350-POC.md](../2023/CVE-2023-27350-MaanVader_CVE-2023-27350-POC.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过与远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可导致完全系统控制

**影响版本:** 22.0.5 (Build 63914) (NG)和受影响的MF版本

**利用条件:** 目标系统运行PaperCut NG/MF，且允许对9191端口的网络访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27350 允许未经身份验证的远程攻击者绕过 PaperCut NG/MF 的身份验证机制，从而实现远程代码执行。漏洞存在于 `SetupCompleted` 类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在 SYSTEM 上下文中执行任意代码。

**有效性：**
从搜索结果以及漏洞描述来看，漏洞真实存在并且已被积极利用。提供的 POC 代码 `find-vuln-ver.py` 旨在检测目标系统是否运行易受攻击的 PaperCut 版本，并通过访问特定的 URL 来引导攻击者进行身份验证绕过。根据github上的其他POC，第一步绕过验证获取权限，第二步利用内置的脚本功能执行代码。

**投毒风险：**
POC 代码 `find-vuln-ver.py` 本身主要用于检测漏洞版本，并给出绕过登录的URL，代码相对简单，不包含任何明显的恶意代码。但是,任何代码都不能保证绝对的安全。因此，极小的可能会有隐藏的投毒代码(比如通过特殊的字符编码、或者利用一些python的特性来执行恶意操作)。但是考虑到其功能主要是版本检测和URL引导，这个可能性非常低。所以投毒风险评定为1%。

**利用方式：**
1.  **版本检测:** 使用POC脚本或者手动访问`http://<ip>:9191/app?service=page/SetupCompleted`来检测PaperCut NG/MF的版本，确定目标系统是否是易受攻击的版本。
2.  **身份验证绕过:**  如果版本确认是易受攻击的版本，攻击者可以通过访问 `http://<ip>:9191/app?service=page/Dashboard` 来绕过身份验证。
3.  **远程代码执行:** 在绕过身份验证后，攻击者可以利用 PaperCut NG/MF 的内置脚本功能来执行任意代码。这通常涉及到上传恶意脚本或者利用已有的脚本执行机制。具体代码执行方式可能需要参考其他的PoC代码，搜索结果中提到了Horizon3ai的PoC。
4.  **权限提升:**  由于漏洞是在 SYSTEM 上下文中执行代码，攻击者可以完全控制受影响的系统。

**总结：**
CVE-2023-27350 是一个严重的安全漏洞，允许未经身份验证的攻击者完全控制 PaperCut NG/MF 服务器。 该漏洞已经被广泛利用，并被列入 CISA 已知被利用漏洞目录中。强烈建议受影响的用户立即应用补丁。

**项目地址:** [MaanVader/CVE-2023-27350-POC](https://github.com/MaanVader/CVE-2023-27350-POC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #5

**来源**: [CVE-2023-27350-Royall-Researchers_CVE-2023-27350.md](../2023/CVE-2023-27350-Royall-Researchers_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过远程代码执行漏洞

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 + 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 22.0.5 (Build 63914) 及 PaperCut MF 或 NG version 8.0 或 later (excluding patched versions) on all OS platforms.

**利用条件:** 目标服务器运行PaperCut NG/MF，且可以通过网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个严重漏洞，允许未经身份验证的远程攻击者绕过身份验证并以 SYSTEM 权限执行任意代码。漏洞存在于 `SetupCompleted` 类中，由于不正确的访问控制导致。

**利用方式：**

1.  **身份验证绕过：** 攻击者通过访问 `/app?service=page/SetupCompleted` 页面，然后发送特定的 POST 请求绕过身份验证。
2.  **配置修改：** 利用绕过的身份验证，攻击者修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 配置，启用脚本执行并禁用沙箱。
3.  **远程代码执行：** 攻击者通过修改打印机设置，插入恶意的 Groovy 脚本，从而在服务器上执行任意代码。脚本功能被滥用。

**POC 有效性：**
提供的 POC 代码通过模拟上述步骤，可以有效利用该漏洞，在目标服务器上执行任意命令。

**投毒风险：**
代码中存在投毒的风险较低。分析POC代码作者的目的是进行漏洞验证，其中`execute`函数中包含了执行命令的代码。通过对脚本的分析，未发现明显的恶意代码。curl命令中存在IP，可能会导致被收集。但总的来说风险较低。

**项目地址:** [Royall-Researchers/CVE-2023-27350](https://github.com/Royall-Researchers/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #6

**来源**: [CVE-2023-27350-ThatNotEasy_CVE-2023-27350.md](../2023/CVE-2023-27350-ThatNotEasy_CVE-2023-27350.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过和远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 极高，可能导致完全系统控制

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统安装了PaperCut NG/MF 22.0.5 (Build 63914)，攻击者需要能够通过网络访问PaperCut服务器。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 存在于 PaperCut NG/MF 软件中，允许未经身份验证的远程攻击者绕过身份验证并执行任意代码。漏洞位于 SetupCompleted 类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在 SYSTEM 上下文中执行任意代码。

**有效性：**
从搜索结果和漏洞库信息来看，该漏洞的POC是可用的，并且已经被积极利用。
提供的Python脚本看起来像是利用了该漏洞，通过访问`/app?service=page/SetupCompleted`路径来绕过身份验证。

**投毒风险：**
查看提供的python代码，代码较为简单，主要用于验证漏洞的存在。代码中引入了requests和BeautifulSoup4库用于发送HTTP请求和解析HTML。该脚本的功能是发送GET请求到目标PaperCut服务器的特定URL，并检查返回的HTML内容是否包含特定的标记，以确定漏洞是否存在。未发现明显的恶意代码。因此，该仓库中存在投毒代码的风险较低，估计在5%左右，主要是考虑到代码可能存在隐藏的缺陷或者依赖项被篡改的风险，但总体上代码逻辑较为清晰。

**利用方式：**
1.  攻击者首先发送特制的HTTP GET请求到目标PaperCut服务器的`/app?service=page/SetupCompleted`端点。
2.  服务器未正确验证身份，允许未经身份验证的访问。
3.  攻击者检查响应的内容以确认漏洞利用是否成功（通过解析HTML查找特定的产品信息）。
4.  成功绕过身份验证后，攻击者可能会利用PaperCut内置的脚本功能来执行任意代码，从而完全控制系统。
5.  参考搜索结果，攻击者可能利用此漏洞安装勒索软件。

**项目地址:** [ThatNotEasy/CVE-2023-27350](https://github.com/ThatNotEasy/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #7

**来源**: [CVE-2023-27350-adhikara13_CVE-2023-27350.md](../2023/CVE-2023-27350-adhikara13_CVE-2023-27350.md)

## CVE-2023-27350-PaperCut-身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 + 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统运行受影响版本的PaperCut NG/MF，且攻击者可以网络访问该系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 中的一个身份验证绕过漏洞。攻击者可以通过向 `/app?service=page/SetupCompleted` 发送特制请求来绕过身份验证。

**利用方式：**

1.  **身份验证绕过：** 未经身份验证的攻击者访问 `/app?service=page/SetupCompleted` 页面，利用不正确的访问控制绕过身份验证。
2.  **获取 Session ID:** 利用绕过的身份验证，通过构造特定的 POST 请求（例如，向 `/app` 发送带有`service=direct/1/SetupCompleted/$Form`的请求）获取有效的 JSESSIONID。
3.  **配置修改：** 使用获得的 JSESSIONID，通过发送 POST 请求到 `/app` 修改 PaperCut 的配置。关键配置包括：
    *   `print-and-device.script.enabled` 设置为 `Y` （启用打印脚本）。
    *   `print.script.sandboxed` 设置为 `N` （禁用脚本沙箱）。
4.  **远程代码执行：** 通过设置打印机脚本来执行任意代码。利用`PrinterDetails/$PrinterDetailsScript.$Form`，将恶意代码注入到`scriptBody`中。该脚本会在打印作业时执行，允许攻击者在系统上执行命令。

**有效性：**

提供的 POC 代码看起来是有效的。它包含以下步骤：

1.  **漏洞检测:**  脚本首先尝试通过访问 `/app?service=page/SetupCompleted` 页面来检测目标是否易受攻击。
2.  **会话获取:** 尝试获取有效的 JSESSIONID。
3.  **配置更改:**  修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 设置。
4.  **命令执行:** 通过打印机脚本注入恶意命令。

根据搜索引擎结果，此漏洞已被积极利用，并且有公开可用的 POC。

**投毒风险分析：**

虽然 POC 主要功能是利用漏洞，但仔细检查发现以下潜在风险：

*   **硬编码的 IP 地址和端口：**POC 中包含一个硬编码的 IP 地址 `10.0.40.83:8081` 在 `execute` 方法中。这可能允许攻击者将受害者信息发送到攻击者控制的服务器。虽然表面上看起来像是用于回调 `whoami` 命令的结果，但恶意攻击者可以修改POC, 也可将其用于收集敏感信息。
*   **Reverse Shell Payload 的修改:** 虽然代码看起来是要设置反向shell, 可以通过修改,将反向shell地址写死,用于恶意用途

因此, 有潜在的投毒风险。由于脚本的行为主要还是漏洞利用,且硬编码的IP地址容易被发现,所以认为投毒风险为**10%**。

**项目地址:** [adhikara13/CVE-2023-27350](https://github.com/adhikara13/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #8

**来源**: [CVE-2023-27350-horizon3ai_CVE-2023-27350.md](../2023/CVE-2023-27350-horizon3ai_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过与远程代码执行漏洞

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统运行受影响版本的PaperCut NG/MF，且攻击者可以访问目标系统的网络。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个漏洞，允许未经身份验证的远程攻击者执行任意代码。攻击者首先利用身份验证绕过漏洞，然后滥用内置的脚本功能来执行代码。 

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用的有效性极高。CISA已经将此漏洞添加到已知被利用漏洞目录中，表明该漏洞正在被积极利用。Sophos等安全厂商也报告了针对该漏洞的攻击。

**投毒风险分析：**

PoC 代码本身主要包含以下几个步骤：

1.  **身份验证绕过：** 通过访问`/app?service=page/SetupCompleted`绕过身份验证。
2.  **设置修改：** 使用`set_setting`函数修改`print-and-device.script.enabled`和`print.script.sandboxed`配置项，启用打印脚本功能并禁用沙盒。
3.  **命令执行：**  通过修改打印机脚本，将攻击者提供的命令注入到`scriptBody`中执行。
4.  **配置恢复：** 执行完成之后恢复`print-and-device.script.enabled`和`print.script.sandboxed`配置项。

在`execute` 函数中，PoC 使用了 `curl` 命令来尝试将`whoami`命令的输出发送到 `http://10.0.40.83:8081`。这可能是PoC作者用于验证漏洞利用成功的一种方式，**但如果直接使用此PoC且目标环境可以访问公网，则可能泄露目标服务器的用户名**。这可以被视为一种潜在的投毒风险。

仔细检查代码后，没有发现明显的恶意代码，例如下载并执行其他程序，或者删除系统文件等。投毒的风险主要在于`execute`函数中硬编码的IP地址和端口号，以及`command`参数的潜在恶意利用。

总体来说，该仓库中存在作者隐藏的投毒代码的可能性较低，风险主要在于使用者不理解PoC代码的含义，直接使用导致的信息泄露，考虑到`curl`命令中的IP地址，以及`command`参数的潜在风险，因此，投毒风险评定为10%。

**利用方式分析：**

1.  攻击者首先利用身份验证绕过漏洞，无需提供任何凭据即可访问 PaperCut NG/MF 的管理界面。
2.  攻击者修改配置，允许执行打印脚本，并禁用脚本沙箱。
3.  攻击者构造包含恶意代码的打印脚本，并将该脚本上传到 PaperCut 服务器。
4.  当 PaperCut 服务器处理打印任务时，恶意脚本会被执行，从而导致远程代码执行。

**项目地址:** [horizon3ai/CVE-2023-27350](https://github.com/horizon3ai/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #9

**来源**: [CVE-2023-27350-imancybersecurity_CVE-2023-27350-POC.md](../2023/CVE-2023-27350-imancybersecurity_CVE-2023-27350-POC.md)

## CVE-2023-27350-PaperCut NG/MF Authentication Bypass and Remote Code Execution

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过,远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 极危，可导致完全系统控制

**影响版本:** 22.0.5 (Build 63914), 8.0 及以上，且低于 20.1.7, 21.2.11, 或 22.0.9

**利用条件:** 目标PaperCut服务器可通过网络访问,9191端口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350是一个存在于PaperCut NG/MF软件中的身份验证绕过漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者绕过身份验证并执行任意代码，获得SYSTEM权限。漏洞存在于SetupCompleted类中，原因是访问控制不当。多个安全厂商和CISA已发布警告，表明该漏洞已被恶意利用。

**有效性分析:**

提供的POC代码 `vuln.py` 主要用于检测目标PaperCut服务器是否存在漏洞，并通过`BeautifulSoup`解析HTML页面以获取版本信息。如果版本在受影响范围内，则脚本会打印易受攻击的信息以及绕过身份验证的URL。`README.md`中提供了利用步骤，包括使用给定的URL绕过身份验证，并利用PaperCut的内置脚本功能执行代码(未在提供的代码中体现，但在描述中提到)。综合来看，该POC代码的有效性较高，可以用来辅助漏洞验证。

**投毒风险分析:**

查看 `vuln.py` 代码，该脚本主要功能是发送HTTP请求、解析HTML并打印信息，未发现明显的恶意代码或后门。脚本依赖于`requests`，`bs4`和`pyfiglet`第三方库，理论上第三方库存在一定投毒风险，但概率较小。`README.md`文件中提供的指令本身不具备投毒行为。因此，综合评估投毒风险较低，约为10%。

**利用方式分析:**

1.  **版本检测:** 使用提供的`vuln.py`脚本检测目标PaperCut服务器的版本。该脚本通过访问`/app?service=page/SetupCompleted`页面，解析HTML获取版本信息。
2.  **身份验证绕过:** 如果版本在受影响范围内，则可以使用`http://<ip>:9191/app?service=page/Dashboard`URL绕过身份验证。
3.  **远程代码执行:** 身份验证绕过后，攻击者可以滥用PaperCut内置的脚本功能来执行任意代码。具体利用方式取决于PaperCut的配置和可用的API，由于未提供具体的执行代码，因此无法详细分析。但根据漏洞信息和搜索结果，执行任意代码是在SYSTEM上下文中进行的。

**项目地址:** [imancybersecurity/CVE-2023-27350-POC](https://github.com/imancybersecurity/CVE-2023-27350-POC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #10

**来源**: [CVE-2023-27350-monke443_CVE-2023-27350.md](../2023/CVE-2023-27350-monke443_CVE-2023-27350.md)

## CVE-2023-27350 - PaperCut NG/MF 身份验证绕过及远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 / 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，允许未经身份验证的远程攻击者以 SYSTEM 权限执行任意代码。

**影响版本:** < 22.0.8

**利用条件:** 目标系统运行受影响版本的 PaperCut NG/MF，且攻击者可访问目标服务器的网络。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 漏洞存在于 PaperCut NG/MF 软件中，允许未经身份验证的攻击者绕过身份验证并远程执行代码。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用方式如下：

1.  **身份验证绕过:** 攻击者利用 `SetupCompleted` Java类中的不当访问控制漏洞，通过构造特定的 HTTP 请求绕过身份验证，从而以管理员身份访问 PaperCut 服务器。
2.  **配置修改:** 绕过身份验证后，攻击者通过修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 配置项，启用打印脚本功能，并禁用沙盒环境。这为执行任意代码创造了条件。
3.  **远程代码执行:** 攻击者利用 PaperCut 软件自身提供的脚本执行功能，执行恶意的脚本代码，从而在服务器上执行任意命令。由于 PaperCut 服务器进程以 SYSTEM 或 root 权限运行，因此执行的命令也具有相应的权限。

**有效性:**

提供的POC代码通过发送特定的POST请求到 `/app?service=page/SetupCompleted` 绕过身份验证。成功后，它禁用打印脚本沙箱并启用打印和设备脚本，允许远程代码执行。PoC 包含检测漏洞是否存在的功能。

**投毒风险评估:**

该漏洞利用代码的 `README.md` 文件中包含警告信息，提示用户谨慎执行该脚本，因为它会重新配置服务器设置以执行命令。虽然脚本在退出时会尝试恢复更改，但在进程被错误终止时可能无法完全恢复。`exploit.py`没有发现恶意行为。但存在极小风险，脚本可能包含隐蔽的、难以检测的恶意代码，或者利用脚本执行远程恶意文件下载和执行。因此，投毒风险评估为 5%。建议在隔离环境中运行和分析该脚本。

**搜索引擎结果补充:**

搜索结果表明 CVE-2023-27350 漏洞被广泛利用，并已被 CISA 列入已知被利用的漏洞目录 (KEV)。多个安全厂商发布了相关的安全公告和分析报告，证实了该漏洞的严重性和利用价值。此外，有报告指出，Bloody 勒索软件团伙也利用该漏洞进行攻击。

**项目地址:** [monke443/CVE-2023-27350](https://github.com/monke443/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---



---

## POC #4

**来源**: [CVE-2023-27350-MaanVader_CVE-2023-27350-POC.md](../2023/CVE-2023-27350-MaanVader_CVE-2023-27350-POC.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过与远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可导致完全系统控制

**影响版本:** 22.0.5 (Build 63914) (NG)和受影响的MF版本

**利用条件:** 目标系统运行PaperCut NG/MF，且允许对9191端口的网络访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27350 允许未经身份验证的远程攻击者绕过 PaperCut NG/MF 的身份验证机制，从而实现远程代码执行。漏洞存在于 `SetupCompleted` 类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在 SYSTEM 上下文中执行任意代码。

**有效性：**
从搜索结果以及漏洞描述来看，漏洞真实存在并且已被积极利用。提供的 POC 代码 `find-vuln-ver.py` 旨在检测目标系统是否运行易受攻击的 PaperCut 版本，并通过访问特定的 URL 来引导攻击者进行身份验证绕过。根据github上的其他POC，第一步绕过验证获取权限，第二步利用内置的脚本功能执行代码。

**投毒风险：**
POC 代码 `find-vuln-ver.py` 本身主要用于检测漏洞版本，并给出绕过登录的URL，代码相对简单，不包含任何明显的恶意代码。但是,任何代码都不能保证绝对的安全。因此，极小的可能会有隐藏的投毒代码(比如通过特殊的字符编码、或者利用一些python的特性来执行恶意操作)。但是考虑到其功能主要是版本检测和URL引导，这个可能性非常低。所以投毒风险评定为1%。

**利用方式：**
1.  **版本检测:** 使用POC脚本或者手动访问`http://<ip>:9191/app?service=page/SetupCompleted`来检测PaperCut NG/MF的版本，确定目标系统是否是易受攻击的版本。
2.  **身份验证绕过:**  如果版本确认是易受攻击的版本，攻击者可以通过访问 `http://<ip>:9191/app?service=page/Dashboard` 来绕过身份验证。
3.  **远程代码执行:** 在绕过身份验证后，攻击者可以利用 PaperCut NG/MF 的内置脚本功能来执行任意代码。这通常涉及到上传恶意脚本或者利用已有的脚本执行机制。具体代码执行方式可能需要参考其他的PoC代码，搜索结果中提到了Horizon3ai的PoC。
4.  **权限提升:**  由于漏洞是在 SYSTEM 上下文中执行代码，攻击者可以完全控制受影响的系统。

**总结：**
CVE-2023-27350 是一个严重的安全漏洞，允许未经身份验证的攻击者完全控制 PaperCut NG/MF 服务器。 该漏洞已经被广泛利用，并被列入 CISA 已知被利用漏洞目录中。强烈建议受影响的用户立即应用补丁。

**项目地址:** [MaanVader/CVE-2023-27350-POC](https://github.com/MaanVader/CVE-2023-27350-POC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #5

**来源**: [CVE-2023-27350-Royall-Researchers_CVE-2023-27350.md](../2023/CVE-2023-27350-Royall-Researchers_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过远程代码执行漏洞

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 + 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 22.0.5 (Build 63914) 及 PaperCut MF 或 NG version 8.0 或 later (excluding patched versions) on all OS platforms.

**利用条件:** 目标服务器运行PaperCut NG/MF，且可以通过网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个严重漏洞，允许未经身份验证的远程攻击者绕过身份验证并以 SYSTEM 权限执行任意代码。漏洞存在于 `SetupCompleted` 类中，由于不正确的访问控制导致。

**利用方式：**

1.  **身份验证绕过：** 攻击者通过访问 `/app?service=page/SetupCompleted` 页面，然后发送特定的 POST 请求绕过身份验证。
2.  **配置修改：** 利用绕过的身份验证，攻击者修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 配置，启用脚本执行并禁用沙箱。
3.  **远程代码执行：** 攻击者通过修改打印机设置，插入恶意的 Groovy 脚本，从而在服务器上执行任意代码。脚本功能被滥用。

**POC 有效性：**
提供的 POC 代码通过模拟上述步骤，可以有效利用该漏洞，在目标服务器上执行任意命令。

**投毒风险：**
代码中存在投毒的风险较低。分析POC代码作者的目的是进行漏洞验证，其中`execute`函数中包含了执行命令的代码。通过对脚本的分析，未发现明显的恶意代码。curl命令中存在IP，可能会导致被收集。但总的来说风险较低。

**项目地址:** [Royall-Researchers/CVE-2023-27350](https://github.com/Royall-Researchers/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #6

**来源**: [CVE-2023-27350-ThatNotEasy_CVE-2023-27350.md](../2023/CVE-2023-27350-ThatNotEasy_CVE-2023-27350.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过和远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 极高，可能导致完全系统控制

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统安装了PaperCut NG/MF 22.0.5 (Build 63914)，攻击者需要能够通过网络访问PaperCut服务器。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 存在于 PaperCut NG/MF 软件中，允许未经身份验证的远程攻击者绕过身份验证并执行任意代码。漏洞位于 SetupCompleted 类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在 SYSTEM 上下文中执行任意代码。

**有效性：**
从搜索结果和漏洞库信息来看，该漏洞的POC是可用的，并且已经被积极利用。
提供的Python脚本看起来像是利用了该漏洞，通过访问`/app?service=page/SetupCompleted`路径来绕过身份验证。

**投毒风险：**
查看提供的python代码，代码较为简单，主要用于验证漏洞的存在。代码中引入了requests和BeautifulSoup4库用于发送HTTP请求和解析HTML。该脚本的功能是发送GET请求到目标PaperCut服务器的特定URL，并检查返回的HTML内容是否包含特定的标记，以确定漏洞是否存在。未发现明显的恶意代码。因此，该仓库中存在投毒代码的风险较低，估计在5%左右，主要是考虑到代码可能存在隐藏的缺陷或者依赖项被篡改的风险，但总体上代码逻辑较为清晰。

**利用方式：**
1.  攻击者首先发送特制的HTTP GET请求到目标PaperCut服务器的`/app?service=page/SetupCompleted`端点。
2.  服务器未正确验证身份，允许未经身份验证的访问。
3.  攻击者检查响应的内容以确认漏洞利用是否成功（通过解析HTML查找特定的产品信息）。
4.  成功绕过身份验证后，攻击者可能会利用PaperCut内置的脚本功能来执行任意代码，从而完全控制系统。
5.  参考搜索结果，攻击者可能利用此漏洞安装勒索软件。

**项目地址:** [ThatNotEasy/CVE-2023-27350](https://github.com/ThatNotEasy/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #7

**来源**: [CVE-2023-27350-adhikara13_CVE-2023-27350.md](../2023/CVE-2023-27350-adhikara13_CVE-2023-27350.md)

## CVE-2023-27350-PaperCut-身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 + 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统运行受影响版本的PaperCut NG/MF，且攻击者可以网络访问该系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 中的一个身份验证绕过漏洞。攻击者可以通过向 `/app?service=page/SetupCompleted` 发送特制请求来绕过身份验证。

**利用方式：**

1.  **身份验证绕过：** 未经身份验证的攻击者访问 `/app?service=page/SetupCompleted` 页面，利用不正确的访问控制绕过身份验证。
2.  **获取 Session ID:** 利用绕过的身份验证，通过构造特定的 POST 请求（例如，向 `/app` 发送带有`service=direct/1/SetupCompleted/$Form`的请求）获取有效的 JSESSIONID。
3.  **配置修改：** 使用获得的 JSESSIONID，通过发送 POST 请求到 `/app` 修改 PaperCut 的配置。关键配置包括：
    *   `print-and-device.script.enabled` 设置为 `Y` （启用打印脚本）。
    *   `print.script.sandboxed` 设置为 `N` （禁用脚本沙箱）。
4.  **远程代码执行：** 通过设置打印机脚本来执行任意代码。利用`PrinterDetails/$PrinterDetailsScript.$Form`，将恶意代码注入到`scriptBody`中。该脚本会在打印作业时执行，允许攻击者在系统上执行命令。

**有效性：**

提供的 POC 代码看起来是有效的。它包含以下步骤：

1.  **漏洞检测:**  脚本首先尝试通过访问 `/app?service=page/SetupCompleted` 页面来检测目标是否易受攻击。
2.  **会话获取:** 尝试获取有效的 JSESSIONID。
3.  **配置更改:**  修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 设置。
4.  **命令执行:** 通过打印机脚本注入恶意命令。

根据搜索引擎结果，此漏洞已被积极利用，并且有公开可用的 POC。

**投毒风险分析：**

虽然 POC 主要功能是利用漏洞，但仔细检查发现以下潜在风险：

*   **硬编码的 IP 地址和端口：**POC 中包含一个硬编码的 IP 地址 `10.0.40.83:8081` 在 `execute` 方法中。这可能允许攻击者将受害者信息发送到攻击者控制的服务器。虽然表面上看起来像是用于回调 `whoami` 命令的结果，但恶意攻击者可以修改POC, 也可将其用于收集敏感信息。
*   **Reverse Shell Payload 的修改:** 虽然代码看起来是要设置反向shell, 可以通过修改,将反向shell地址写死,用于恶意用途

因此, 有潜在的投毒风险。由于脚本的行为主要还是漏洞利用,且硬编码的IP地址容易被发现,所以认为投毒风险为**10%**。

**项目地址:** [adhikara13/CVE-2023-27350](https://github.com/adhikara13/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #8

**来源**: [CVE-2023-27350-horizon3ai_CVE-2023-27350.md](../2023/CVE-2023-27350-horizon3ai_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过与远程代码执行漏洞

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统运行受影响版本的PaperCut NG/MF，且攻击者可以访问目标系统的网络。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个漏洞，允许未经身份验证的远程攻击者执行任意代码。攻击者首先利用身份验证绕过漏洞，然后滥用内置的脚本功能来执行代码。 

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用的有效性极高。CISA已经将此漏洞添加到已知被利用漏洞目录中，表明该漏洞正在被积极利用。Sophos等安全厂商也报告了针对该漏洞的攻击。

**投毒风险分析：**

PoC 代码本身主要包含以下几个步骤：

1.  **身份验证绕过：** 通过访问`/app?service=page/SetupCompleted`绕过身份验证。
2.  **设置修改：** 使用`set_setting`函数修改`print-and-device.script.enabled`和`print.script.sandboxed`配置项，启用打印脚本功能并禁用沙盒。
3.  **命令执行：**  通过修改打印机脚本，将攻击者提供的命令注入到`scriptBody`中执行。
4.  **配置恢复：** 执行完成之后恢复`print-and-device.script.enabled`和`print.script.sandboxed`配置项。

在`execute` 函数中，PoC 使用了 `curl` 命令来尝试将`whoami`命令的输出发送到 `http://10.0.40.83:8081`。这可能是PoC作者用于验证漏洞利用成功的一种方式，**但如果直接使用此PoC且目标环境可以访问公网，则可能泄露目标服务器的用户名**。这可以被视为一种潜在的投毒风险。

仔细检查代码后，没有发现明显的恶意代码，例如下载并执行其他程序，或者删除系统文件等。投毒的风险主要在于`execute`函数中硬编码的IP地址和端口号，以及`command`参数的潜在恶意利用。

总体来说，该仓库中存在作者隐藏的投毒代码的可能性较低，风险主要在于使用者不理解PoC代码的含义，直接使用导致的信息泄露，考虑到`curl`命令中的IP地址，以及`command`参数的潜在风险，因此，投毒风险评定为10%。

**利用方式分析：**

1.  攻击者首先利用身份验证绕过漏洞，无需提供任何凭据即可访问 PaperCut NG/MF 的管理界面。
2.  攻击者修改配置，允许执行打印脚本，并禁用脚本沙箱。
3.  攻击者构造包含恶意代码的打印脚本，并将该脚本上传到 PaperCut 服务器。
4.  当 PaperCut 服务器处理打印任务时，恶意脚本会被执行，从而导致远程代码执行。

**项目地址:** [horizon3ai/CVE-2023-27350](https://github.com/horizon3ai/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #9

**来源**: [CVE-2023-27350-imancybersecurity_CVE-2023-27350-POC.md](../2023/CVE-2023-27350-imancybersecurity_CVE-2023-27350-POC.md)

## CVE-2023-27350-PaperCut NG/MF Authentication Bypass and Remote Code Execution

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过,远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 极危，可导致完全系统控制

**影响版本:** 22.0.5 (Build 63914), 8.0 及以上，且低于 20.1.7, 21.2.11, 或 22.0.9

**利用条件:** 目标PaperCut服务器可通过网络访问,9191端口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350是一个存在于PaperCut NG/MF软件中的身份验证绕过漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者绕过身份验证并执行任意代码，获得SYSTEM权限。漏洞存在于SetupCompleted类中，原因是访问控制不当。多个安全厂商和CISA已发布警告，表明该漏洞已被恶意利用。

**有效性分析:**

提供的POC代码 `vuln.py` 主要用于检测目标PaperCut服务器是否存在漏洞，并通过`BeautifulSoup`解析HTML页面以获取版本信息。如果版本在受影响范围内，则脚本会打印易受攻击的信息以及绕过身份验证的URL。`README.md`中提供了利用步骤，包括使用给定的URL绕过身份验证，并利用PaperCut的内置脚本功能执行代码(未在提供的代码中体现，但在描述中提到)。综合来看，该POC代码的有效性较高，可以用来辅助漏洞验证。

**投毒风险分析:**

查看 `vuln.py` 代码，该脚本主要功能是发送HTTP请求、解析HTML并打印信息，未发现明显的恶意代码或后门。脚本依赖于`requests`，`bs4`和`pyfiglet`第三方库，理论上第三方库存在一定投毒风险，但概率较小。`README.md`文件中提供的指令本身不具备投毒行为。因此，综合评估投毒风险较低，约为10%。

**利用方式分析:**

1.  **版本检测:** 使用提供的`vuln.py`脚本检测目标PaperCut服务器的版本。该脚本通过访问`/app?service=page/SetupCompleted`页面，解析HTML获取版本信息。
2.  **身份验证绕过:** 如果版本在受影响范围内，则可以使用`http://<ip>:9191/app?service=page/Dashboard`URL绕过身份验证。
3.  **远程代码执行:** 身份验证绕过后，攻击者可以滥用PaperCut内置的脚本功能来执行任意代码。具体利用方式取决于PaperCut的配置和可用的API，由于未提供具体的执行代码，因此无法详细分析。但根据漏洞信息和搜索结果，执行任意代码是在SYSTEM上下文中进行的。

**项目地址:** [imancybersecurity/CVE-2023-27350-POC](https://github.com/imancybersecurity/CVE-2023-27350-POC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #10

**来源**: [CVE-2023-27350-monke443_CVE-2023-27350.md](../2023/CVE-2023-27350-monke443_CVE-2023-27350.md)

## CVE-2023-27350 - PaperCut NG/MF 身份验证绕过及远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 / 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，允许未经身份验证的远程攻击者以 SYSTEM 权限执行任意代码。

**影响版本:** < 22.0.8

**利用条件:** 目标系统运行受影响版本的 PaperCut NG/MF，且攻击者可访问目标服务器的网络。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 漏洞存在于 PaperCut NG/MF 软件中，允许未经身份验证的攻击者绕过身份验证并远程执行代码。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用方式如下：

1.  **身份验证绕过:** 攻击者利用 `SetupCompleted` Java类中的不当访问控制漏洞，通过构造特定的 HTTP 请求绕过身份验证，从而以管理员身份访问 PaperCut 服务器。
2.  **配置修改:** 绕过身份验证后，攻击者通过修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 配置项，启用打印脚本功能，并禁用沙盒环境。这为执行任意代码创造了条件。
3.  **远程代码执行:** 攻击者利用 PaperCut 软件自身提供的脚本执行功能，执行恶意的脚本代码，从而在服务器上执行任意命令。由于 PaperCut 服务器进程以 SYSTEM 或 root 权限运行，因此执行的命令也具有相应的权限。

**有效性:**

提供的POC代码通过发送特定的POST请求到 `/app?service=page/SetupCompleted` 绕过身份验证。成功后，它禁用打印脚本沙箱并启用打印和设备脚本，允许远程代码执行。PoC 包含检测漏洞是否存在的功能。

**投毒风险评估:**

该漏洞利用代码的 `README.md` 文件中包含警告信息，提示用户谨慎执行该脚本，因为它会重新配置服务器设置以执行命令。虽然脚本在退出时会尝试恢复更改，但在进程被错误终止时可能无法完全恢复。`exploit.py`没有发现恶意行为。但存在极小风险，脚本可能包含隐蔽的、难以检测的恶意代码，或者利用脚本执行远程恶意文件下载和执行。因此，投毒风险评估为 5%。建议在隔离环境中运行和分析该脚本。

**搜索引擎结果补充:**

搜索结果表明 CVE-2023-27350 漏洞被广泛利用，并已被 CISA 列入已知被利用的漏洞目录 (KEV)。多个安全厂商发布了相关的安全公告和分析报告，证实了该漏洞的严重性和利用价值。此外，有报告指出，Bloody 勒索软件团伙也利用该漏洞进行攻击。

**项目地址:** [monke443/CVE-2023-27350](https://github.com/monke443/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---



---

## POC #4

**来源**: [CVE-2023-27350-MaanVader_CVE-2023-27350-POC.md](../2023/CVE-2023-27350-MaanVader_CVE-2023-27350-POC.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过与远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可导致完全系统控制

**影响版本:** 22.0.5 (Build 63914) (NG)和受影响的MF版本

**利用条件:** 目标系统运行PaperCut NG/MF，且允许对9191端口的网络访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27350 允许未经身份验证的远程攻击者绕过 PaperCut NG/MF 的身份验证机制，从而实现远程代码执行。漏洞存在于 `SetupCompleted` 类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在 SYSTEM 上下文中执行任意代码。

**有效性：**
从搜索结果以及漏洞描述来看，漏洞真实存在并且已被积极利用。提供的 POC 代码 `find-vuln-ver.py` 旨在检测目标系统是否运行易受攻击的 PaperCut 版本，并通过访问特定的 URL 来引导攻击者进行身份验证绕过。根据github上的其他POC，第一步绕过验证获取权限，第二步利用内置的脚本功能执行代码。

**投毒风险：**
POC 代码 `find-vuln-ver.py` 本身主要用于检测漏洞版本，并给出绕过登录的URL，代码相对简单，不包含任何明显的恶意代码。但是,任何代码都不能保证绝对的安全。因此，极小的可能会有隐藏的投毒代码(比如通过特殊的字符编码、或者利用一些python的特性来执行恶意操作)。但是考虑到其功能主要是版本检测和URL引导，这个可能性非常低。所以投毒风险评定为1%。

**利用方式：**
1.  **版本检测:** 使用POC脚本或者手动访问`http://<ip>:9191/app?service=page/SetupCompleted`来检测PaperCut NG/MF的版本，确定目标系统是否是易受攻击的版本。
2.  **身份验证绕过:**  如果版本确认是易受攻击的版本，攻击者可以通过访问 `http://<ip>:9191/app?service=page/Dashboard` 来绕过身份验证。
3.  **远程代码执行:** 在绕过身份验证后，攻击者可以利用 PaperCut NG/MF 的内置脚本功能来执行任意代码。这通常涉及到上传恶意脚本或者利用已有的脚本执行机制。具体代码执行方式可能需要参考其他的PoC代码，搜索结果中提到了Horizon3ai的PoC。
4.  **权限提升:**  由于漏洞是在 SYSTEM 上下文中执行代码，攻击者可以完全控制受影响的系统。

**总结：**
CVE-2023-27350 是一个严重的安全漏洞，允许未经身份验证的攻击者完全控制 PaperCut NG/MF 服务器。 该漏洞已经被广泛利用，并被列入 CISA 已知被利用漏洞目录中。强烈建议受影响的用户立即应用补丁。

**项目地址:** [MaanVader/CVE-2023-27350-POC](https://github.com/MaanVader/CVE-2023-27350-POC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #5

**来源**: [CVE-2023-27350-Royall-Researchers_CVE-2023-27350.md](../2023/CVE-2023-27350-Royall-Researchers_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过远程代码执行漏洞

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 + 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 22.0.5 (Build 63914) 及 PaperCut MF 或 NG version 8.0 或 later (excluding patched versions) on all OS platforms.

**利用条件:** 目标服务器运行PaperCut NG/MF，且可以通过网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个严重漏洞，允许未经身份验证的远程攻击者绕过身份验证并以 SYSTEM 权限执行任意代码。漏洞存在于 `SetupCompleted` 类中，由于不正确的访问控制导致。

**利用方式：**

1.  **身份验证绕过：** 攻击者通过访问 `/app?service=page/SetupCompleted` 页面，然后发送特定的 POST 请求绕过身份验证。
2.  **配置修改：** 利用绕过的身份验证，攻击者修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 配置，启用脚本执行并禁用沙箱。
3.  **远程代码执行：** 攻击者通过修改打印机设置，插入恶意的 Groovy 脚本，从而在服务器上执行任意代码。脚本功能被滥用。

**POC 有效性：**
提供的 POC 代码通过模拟上述步骤，可以有效利用该漏洞，在目标服务器上执行任意命令。

**投毒风险：**
代码中存在投毒的风险较低。分析POC代码作者的目的是进行漏洞验证，其中`execute`函数中包含了执行命令的代码。通过对脚本的分析，未发现明显的恶意代码。curl命令中存在IP，可能会导致被收集。但总的来说风险较低。

**项目地址:** [Royall-Researchers/CVE-2023-27350](https://github.com/Royall-Researchers/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #6

**来源**: [CVE-2023-27350-ThatNotEasy_CVE-2023-27350.md](../2023/CVE-2023-27350-ThatNotEasy_CVE-2023-27350.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过和远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 极高，可能导致完全系统控制

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统安装了PaperCut NG/MF 22.0.5 (Build 63914)，攻击者需要能够通过网络访问PaperCut服务器。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 存在于 PaperCut NG/MF 软件中，允许未经身份验证的远程攻击者绕过身份验证并执行任意代码。漏洞位于 SetupCompleted 类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在 SYSTEM 上下文中执行任意代码。

**有效性：**
从搜索结果和漏洞库信息来看，该漏洞的POC是可用的，并且已经被积极利用。
提供的Python脚本看起来像是利用了该漏洞，通过访问`/app?service=page/SetupCompleted`路径来绕过身份验证。

**投毒风险：**
查看提供的python代码，代码较为简单，主要用于验证漏洞的存在。代码中引入了requests和BeautifulSoup4库用于发送HTTP请求和解析HTML。该脚本的功能是发送GET请求到目标PaperCut服务器的特定URL，并检查返回的HTML内容是否包含特定的标记，以确定漏洞是否存在。未发现明显的恶意代码。因此，该仓库中存在投毒代码的风险较低，估计在5%左右，主要是考虑到代码可能存在隐藏的缺陷或者依赖项被篡改的风险，但总体上代码逻辑较为清晰。

**利用方式：**
1.  攻击者首先发送特制的HTTP GET请求到目标PaperCut服务器的`/app?service=page/SetupCompleted`端点。
2.  服务器未正确验证身份，允许未经身份验证的访问。
3.  攻击者检查响应的内容以确认漏洞利用是否成功（通过解析HTML查找特定的产品信息）。
4.  成功绕过身份验证后，攻击者可能会利用PaperCut内置的脚本功能来执行任意代码，从而完全控制系统。
5.  参考搜索结果，攻击者可能利用此漏洞安装勒索软件。

**项目地址:** [ThatNotEasy/CVE-2023-27350](https://github.com/ThatNotEasy/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #7

**来源**: [CVE-2023-27350-adhikara13_CVE-2023-27350.md](../2023/CVE-2023-27350-adhikara13_CVE-2023-27350.md)

## CVE-2023-27350-PaperCut-身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 + 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统运行受影响版本的PaperCut NG/MF，且攻击者可以网络访问该系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 中的一个身份验证绕过漏洞。攻击者可以通过向 `/app?service=page/SetupCompleted` 发送特制请求来绕过身份验证。

**利用方式：**

1.  **身份验证绕过：** 未经身份验证的攻击者访问 `/app?service=page/SetupCompleted` 页面，利用不正确的访问控制绕过身份验证。
2.  **获取 Session ID:** 利用绕过的身份验证，通过构造特定的 POST 请求（例如，向 `/app` 发送带有`service=direct/1/SetupCompleted/$Form`的请求）获取有效的 JSESSIONID。
3.  **配置修改：** 使用获得的 JSESSIONID，通过发送 POST 请求到 `/app` 修改 PaperCut 的配置。关键配置包括：
    *   `print-and-device.script.enabled` 设置为 `Y` （启用打印脚本）。
    *   `print.script.sandboxed` 设置为 `N` （禁用脚本沙箱）。
4.  **远程代码执行：** 通过设置打印机脚本来执行任意代码。利用`PrinterDetails/$PrinterDetailsScript.$Form`，将恶意代码注入到`scriptBody`中。该脚本会在打印作业时执行，允许攻击者在系统上执行命令。

**有效性：**

提供的 POC 代码看起来是有效的。它包含以下步骤：

1.  **漏洞检测:**  脚本首先尝试通过访问 `/app?service=page/SetupCompleted` 页面来检测目标是否易受攻击。
2.  **会话获取:** 尝试获取有效的 JSESSIONID。
3.  **配置更改:**  修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 设置。
4.  **命令执行:** 通过打印机脚本注入恶意命令。

根据搜索引擎结果，此漏洞已被积极利用，并且有公开可用的 POC。

**投毒风险分析：**

虽然 POC 主要功能是利用漏洞，但仔细检查发现以下潜在风险：

*   **硬编码的 IP 地址和端口：**POC 中包含一个硬编码的 IP 地址 `10.0.40.83:8081` 在 `execute` 方法中。这可能允许攻击者将受害者信息发送到攻击者控制的服务器。虽然表面上看起来像是用于回调 `whoami` 命令的结果，但恶意攻击者可以修改POC, 也可将其用于收集敏感信息。
*   **Reverse Shell Payload 的修改:** 虽然代码看起来是要设置反向shell, 可以通过修改,将反向shell地址写死,用于恶意用途

因此, 有潜在的投毒风险。由于脚本的行为主要还是漏洞利用,且硬编码的IP地址容易被发现,所以认为投毒风险为**10%**。

**项目地址:** [adhikara13/CVE-2023-27350](https://github.com/adhikara13/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #8

**来源**: [CVE-2023-27350-horizon3ai_CVE-2023-27350.md](../2023/CVE-2023-27350-horizon3ai_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过与远程代码执行漏洞

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统运行受影响版本的PaperCut NG/MF，且攻击者可以访问目标系统的网络。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个漏洞，允许未经身份验证的远程攻击者执行任意代码。攻击者首先利用身份验证绕过漏洞，然后滥用内置的脚本功能来执行代码。 

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用的有效性极高。CISA已经将此漏洞添加到已知被利用漏洞目录中，表明该漏洞正在被积极利用。Sophos等安全厂商也报告了针对该漏洞的攻击。

**投毒风险分析：**

PoC 代码本身主要包含以下几个步骤：

1.  **身份验证绕过：** 通过访问`/app?service=page/SetupCompleted`绕过身份验证。
2.  **设置修改：** 使用`set_setting`函数修改`print-and-device.script.enabled`和`print.script.sandboxed`配置项，启用打印脚本功能并禁用沙盒。
3.  **命令执行：**  通过修改打印机脚本，将攻击者提供的命令注入到`scriptBody`中执行。
4.  **配置恢复：** 执行完成之后恢复`print-and-device.script.enabled`和`print.script.sandboxed`配置项。

在`execute` 函数中，PoC 使用了 `curl` 命令来尝试将`whoami`命令的输出发送到 `http://10.0.40.83:8081`。这可能是PoC作者用于验证漏洞利用成功的一种方式，**但如果直接使用此PoC且目标环境可以访问公网，则可能泄露目标服务器的用户名**。这可以被视为一种潜在的投毒风险。

仔细检查代码后，没有发现明显的恶意代码，例如下载并执行其他程序，或者删除系统文件等。投毒的风险主要在于`execute`函数中硬编码的IP地址和端口号，以及`command`参数的潜在恶意利用。

总体来说，该仓库中存在作者隐藏的投毒代码的可能性较低，风险主要在于使用者不理解PoC代码的含义，直接使用导致的信息泄露，考虑到`curl`命令中的IP地址，以及`command`参数的潜在风险，因此，投毒风险评定为10%。

**利用方式分析：**

1.  攻击者首先利用身份验证绕过漏洞，无需提供任何凭据即可访问 PaperCut NG/MF 的管理界面。
2.  攻击者修改配置，允许执行打印脚本，并禁用脚本沙箱。
3.  攻击者构造包含恶意代码的打印脚本，并将该脚本上传到 PaperCut 服务器。
4.  当 PaperCut 服务器处理打印任务时，恶意脚本会被执行，从而导致远程代码执行。

**项目地址:** [horizon3ai/CVE-2023-27350](https://github.com/horizon3ai/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #9

**来源**: [CVE-2023-27350-imancybersecurity_CVE-2023-27350-POC.md](../2023/CVE-2023-27350-imancybersecurity_CVE-2023-27350-POC.md)

## CVE-2023-27350-PaperCut NG/MF Authentication Bypass and Remote Code Execution

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过,远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 极危，可导致完全系统控制

**影响版本:** 22.0.5 (Build 63914), 8.0 及以上，且低于 20.1.7, 21.2.11, 或 22.0.9

**利用条件:** 目标PaperCut服务器可通过网络访问,9191端口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350是一个存在于PaperCut NG/MF软件中的身份验证绕过漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者绕过身份验证并执行任意代码，获得SYSTEM权限。漏洞存在于SetupCompleted类中，原因是访问控制不当。多个安全厂商和CISA已发布警告，表明该漏洞已被恶意利用。

**有效性分析:**

提供的POC代码 `vuln.py` 主要用于检测目标PaperCut服务器是否存在漏洞，并通过`BeautifulSoup`解析HTML页面以获取版本信息。如果版本在受影响范围内，则脚本会打印易受攻击的信息以及绕过身份验证的URL。`README.md`中提供了利用步骤，包括使用给定的URL绕过身份验证，并利用PaperCut的内置脚本功能执行代码(未在提供的代码中体现，但在描述中提到)。综合来看，该POC代码的有效性较高，可以用来辅助漏洞验证。

**投毒风险分析:**

查看 `vuln.py` 代码，该脚本主要功能是发送HTTP请求、解析HTML并打印信息，未发现明显的恶意代码或后门。脚本依赖于`requests`，`bs4`和`pyfiglet`第三方库，理论上第三方库存在一定投毒风险，但概率较小。`README.md`文件中提供的指令本身不具备投毒行为。因此，综合评估投毒风险较低，约为10%。

**利用方式分析:**

1.  **版本检测:** 使用提供的`vuln.py`脚本检测目标PaperCut服务器的版本。该脚本通过访问`/app?service=page/SetupCompleted`页面，解析HTML获取版本信息。
2.  **身份验证绕过:** 如果版本在受影响范围内，则可以使用`http://<ip>:9191/app?service=page/Dashboard`URL绕过身份验证。
3.  **远程代码执行:** 身份验证绕过后，攻击者可以滥用PaperCut内置的脚本功能来执行任意代码。具体利用方式取决于PaperCut的配置和可用的API，由于未提供具体的执行代码，因此无法详细分析。但根据漏洞信息和搜索结果，执行任意代码是在SYSTEM上下文中进行的。

**项目地址:** [imancybersecurity/CVE-2023-27350-POC](https://github.com/imancybersecurity/CVE-2023-27350-POC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #10

**来源**: [CVE-2023-27350-monke443_CVE-2023-27350.md](../2023/CVE-2023-27350-monke443_CVE-2023-27350.md)

## CVE-2023-27350 - PaperCut NG/MF 身份验证绕过及远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 / 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，允许未经身份验证的远程攻击者以 SYSTEM 权限执行任意代码。

**影响版本:** < 22.0.8

**利用条件:** 目标系统运行受影响版本的 PaperCut NG/MF，且攻击者可访问目标服务器的网络。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 漏洞存在于 PaperCut NG/MF 软件中，允许未经身份验证的攻击者绕过身份验证并远程执行代码。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用方式如下：

1.  **身份验证绕过:** 攻击者利用 `SetupCompleted` Java类中的不当访问控制漏洞，通过构造特定的 HTTP 请求绕过身份验证，从而以管理员身份访问 PaperCut 服务器。
2.  **配置修改:** 绕过身份验证后，攻击者通过修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 配置项，启用打印脚本功能，并禁用沙盒环境。这为执行任意代码创造了条件。
3.  **远程代码执行:** 攻击者利用 PaperCut 软件自身提供的脚本执行功能，执行恶意的脚本代码，从而在服务器上执行任意命令。由于 PaperCut 服务器进程以 SYSTEM 或 root 权限运行，因此执行的命令也具有相应的权限。

**有效性:**

提供的POC代码通过发送特定的POST请求到 `/app?service=page/SetupCompleted` 绕过身份验证。成功后，它禁用打印脚本沙箱并启用打印和设备脚本，允许远程代码执行。PoC 包含检测漏洞是否存在的功能。

**投毒风险评估:**

该漏洞利用代码的 `README.md` 文件中包含警告信息，提示用户谨慎执行该脚本，因为它会重新配置服务器设置以执行命令。虽然脚本在退出时会尝试恢复更改，但在进程被错误终止时可能无法完全恢复。`exploit.py`没有发现恶意行为。但存在极小风险，脚本可能包含隐蔽的、难以检测的恶意代码，或者利用脚本执行远程恶意文件下载和执行。因此，投毒风险评估为 5%。建议在隔离环境中运行和分析该脚本。

**搜索引擎结果补充:**

搜索结果表明 CVE-2023-27350 漏洞被广泛利用，并已被 CISA 列入已知被利用的漏洞目录 (KEV)。多个安全厂商发布了相关的安全公告和分析报告，证实了该漏洞的严重性和利用价值。此外，有报告指出，Bloody 勒索软件团伙也利用该漏洞进行攻击。

**项目地址:** [monke443/CVE-2023-27350](https://github.com/monke443/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---



---

## POC #4

**来源**: [CVE-2023-27350-MaanVader_CVE-2023-27350-POC.md](../2023/CVE-2023-27350-MaanVader_CVE-2023-27350-POC.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过与远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可导致完全系统控制

**影响版本:** 22.0.5 (Build 63914) (NG)和受影响的MF版本

**利用条件:** 目标系统运行PaperCut NG/MF，且允许对9191端口的网络访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27350 允许未经身份验证的远程攻击者绕过 PaperCut NG/MF 的身份验证机制，从而实现远程代码执行。漏洞存在于 `SetupCompleted` 类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在 SYSTEM 上下文中执行任意代码。

**有效性：**
从搜索结果以及漏洞描述来看，漏洞真实存在并且已被积极利用。提供的 POC 代码 `find-vuln-ver.py` 旨在检测目标系统是否运行易受攻击的 PaperCut 版本，并通过访问特定的 URL 来引导攻击者进行身份验证绕过。根据github上的其他POC，第一步绕过验证获取权限，第二步利用内置的脚本功能执行代码。

**投毒风险：**
POC 代码 `find-vuln-ver.py` 本身主要用于检测漏洞版本，并给出绕过登录的URL，代码相对简单，不包含任何明显的恶意代码。但是,任何代码都不能保证绝对的安全。因此，极小的可能会有隐藏的投毒代码(比如通过特殊的字符编码、或者利用一些python的特性来执行恶意操作)。但是考虑到其功能主要是版本检测和URL引导，这个可能性非常低。所以投毒风险评定为1%。

**利用方式：**
1.  **版本检测:** 使用POC脚本或者手动访问`http://<ip>:9191/app?service=page/SetupCompleted`来检测PaperCut NG/MF的版本，确定目标系统是否是易受攻击的版本。
2.  **身份验证绕过:**  如果版本确认是易受攻击的版本，攻击者可以通过访问 `http://<ip>:9191/app?service=page/Dashboard` 来绕过身份验证。
3.  **远程代码执行:** 在绕过身份验证后，攻击者可以利用 PaperCut NG/MF 的内置脚本功能来执行任意代码。这通常涉及到上传恶意脚本或者利用已有的脚本执行机制。具体代码执行方式可能需要参考其他的PoC代码，搜索结果中提到了Horizon3ai的PoC。
4.  **权限提升:**  由于漏洞是在 SYSTEM 上下文中执行代码，攻击者可以完全控制受影响的系统。

**总结：**
CVE-2023-27350 是一个严重的安全漏洞，允许未经身份验证的攻击者完全控制 PaperCut NG/MF 服务器。 该漏洞已经被广泛利用，并被列入 CISA 已知被利用漏洞目录中。强烈建议受影响的用户立即应用补丁。

**项目地址:** [MaanVader/CVE-2023-27350-POC](https://github.com/MaanVader/CVE-2023-27350-POC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #5

**来源**: [CVE-2023-27350-Royall-Researchers_CVE-2023-27350.md](../2023/CVE-2023-27350-Royall-Researchers_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过远程代码执行漏洞

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 + 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 22.0.5 (Build 63914) 及 PaperCut MF 或 NG version 8.0 或 later (excluding patched versions) on all OS platforms.

**利用条件:** 目标服务器运行PaperCut NG/MF，且可以通过网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个严重漏洞，允许未经身份验证的远程攻击者绕过身份验证并以 SYSTEM 权限执行任意代码。漏洞存在于 `SetupCompleted` 类中，由于不正确的访问控制导致。

**利用方式：**

1.  **身份验证绕过：** 攻击者通过访问 `/app?service=page/SetupCompleted` 页面，然后发送特定的 POST 请求绕过身份验证。
2.  **配置修改：** 利用绕过的身份验证，攻击者修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 配置，启用脚本执行并禁用沙箱。
3.  **远程代码执行：** 攻击者通过修改打印机设置，插入恶意的 Groovy 脚本，从而在服务器上执行任意代码。脚本功能被滥用。

**POC 有效性：**
提供的 POC 代码通过模拟上述步骤，可以有效利用该漏洞，在目标服务器上执行任意命令。

**投毒风险：**
代码中存在投毒的风险较低。分析POC代码作者的目的是进行漏洞验证，其中`execute`函数中包含了执行命令的代码。通过对脚本的分析，未发现明显的恶意代码。curl命令中存在IP，可能会导致被收集。但总的来说风险较低。

**项目地址:** [Royall-Researchers/CVE-2023-27350](https://github.com/Royall-Researchers/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #6

**来源**: [CVE-2023-27350-ThatNotEasy_CVE-2023-27350.md](../2023/CVE-2023-27350-ThatNotEasy_CVE-2023-27350.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过和远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 极高，可能导致完全系统控制

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统安装了PaperCut NG/MF 22.0.5 (Build 63914)，攻击者需要能够通过网络访问PaperCut服务器。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 存在于 PaperCut NG/MF 软件中，允许未经身份验证的远程攻击者绕过身份验证并执行任意代码。漏洞位于 SetupCompleted 类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在 SYSTEM 上下文中执行任意代码。

**有效性：**
从搜索结果和漏洞库信息来看，该漏洞的POC是可用的，并且已经被积极利用。
提供的Python脚本看起来像是利用了该漏洞，通过访问`/app?service=page/SetupCompleted`路径来绕过身份验证。

**投毒风险：**
查看提供的python代码，代码较为简单，主要用于验证漏洞的存在。代码中引入了requests和BeautifulSoup4库用于发送HTTP请求和解析HTML。该脚本的功能是发送GET请求到目标PaperCut服务器的特定URL，并检查返回的HTML内容是否包含特定的标记，以确定漏洞是否存在。未发现明显的恶意代码。因此，该仓库中存在投毒代码的风险较低，估计在5%左右，主要是考虑到代码可能存在隐藏的缺陷或者依赖项被篡改的风险，但总体上代码逻辑较为清晰。

**利用方式：**
1.  攻击者首先发送特制的HTTP GET请求到目标PaperCut服务器的`/app?service=page/SetupCompleted`端点。
2.  服务器未正确验证身份，允许未经身份验证的访问。
3.  攻击者检查响应的内容以确认漏洞利用是否成功（通过解析HTML查找特定的产品信息）。
4.  成功绕过身份验证后，攻击者可能会利用PaperCut内置的脚本功能来执行任意代码，从而完全控制系统。
5.  参考搜索结果，攻击者可能利用此漏洞安装勒索软件。

**项目地址:** [ThatNotEasy/CVE-2023-27350](https://github.com/ThatNotEasy/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #7

**来源**: [CVE-2023-27350-adhikara13_CVE-2023-27350.md](../2023/CVE-2023-27350-adhikara13_CVE-2023-27350.md)

## CVE-2023-27350-PaperCut-身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 + 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统运行受影响版本的PaperCut NG/MF，且攻击者可以网络访问该系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 中的一个身份验证绕过漏洞。攻击者可以通过向 `/app?service=page/SetupCompleted` 发送特制请求来绕过身份验证。

**利用方式：**

1.  **身份验证绕过：** 未经身份验证的攻击者访问 `/app?service=page/SetupCompleted` 页面，利用不正确的访问控制绕过身份验证。
2.  **获取 Session ID:** 利用绕过的身份验证，通过构造特定的 POST 请求（例如，向 `/app` 发送带有`service=direct/1/SetupCompleted/$Form`的请求）获取有效的 JSESSIONID。
3.  **配置修改：** 使用获得的 JSESSIONID，通过发送 POST 请求到 `/app` 修改 PaperCut 的配置。关键配置包括：
    *   `print-and-device.script.enabled` 设置为 `Y` （启用打印脚本）。
    *   `print.script.sandboxed` 设置为 `N` （禁用脚本沙箱）。
4.  **远程代码执行：** 通过设置打印机脚本来执行任意代码。利用`PrinterDetails/$PrinterDetailsScript.$Form`，将恶意代码注入到`scriptBody`中。该脚本会在打印作业时执行，允许攻击者在系统上执行命令。

**有效性：**

提供的 POC 代码看起来是有效的。它包含以下步骤：

1.  **漏洞检测:**  脚本首先尝试通过访问 `/app?service=page/SetupCompleted` 页面来检测目标是否易受攻击。
2.  **会话获取:** 尝试获取有效的 JSESSIONID。
3.  **配置更改:**  修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 设置。
4.  **命令执行:** 通过打印机脚本注入恶意命令。

根据搜索引擎结果，此漏洞已被积极利用，并且有公开可用的 POC。

**投毒风险分析：**

虽然 POC 主要功能是利用漏洞，但仔细检查发现以下潜在风险：

*   **硬编码的 IP 地址和端口：**POC 中包含一个硬编码的 IP 地址 `10.0.40.83:8081` 在 `execute` 方法中。这可能允许攻击者将受害者信息发送到攻击者控制的服务器。虽然表面上看起来像是用于回调 `whoami` 命令的结果，但恶意攻击者可以修改POC, 也可将其用于收集敏感信息。
*   **Reverse Shell Payload 的修改:** 虽然代码看起来是要设置反向shell, 可以通过修改,将反向shell地址写死,用于恶意用途

因此, 有潜在的投毒风险。由于脚本的行为主要还是漏洞利用,且硬编码的IP地址容易被发现,所以认为投毒风险为**10%**。

**项目地址:** [adhikara13/CVE-2023-27350](https://github.com/adhikara13/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #8

**来源**: [CVE-2023-27350-horizon3ai_CVE-2023-27350.md](../2023/CVE-2023-27350-horizon3ai_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过与远程代码执行漏洞

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统运行受影响版本的PaperCut NG/MF，且攻击者可以访问目标系统的网络。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个漏洞，允许未经身份验证的远程攻击者执行任意代码。攻击者首先利用身份验证绕过漏洞，然后滥用内置的脚本功能来执行代码。 

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用的有效性极高。CISA已经将此漏洞添加到已知被利用漏洞目录中，表明该漏洞正在被积极利用。Sophos等安全厂商也报告了针对该漏洞的攻击。

**投毒风险分析：**

PoC 代码本身主要包含以下几个步骤：

1.  **身份验证绕过：** 通过访问`/app?service=page/SetupCompleted`绕过身份验证。
2.  **设置修改：** 使用`set_setting`函数修改`print-and-device.script.enabled`和`print.script.sandboxed`配置项，启用打印脚本功能并禁用沙盒。
3.  **命令执行：**  通过修改打印机脚本，将攻击者提供的命令注入到`scriptBody`中执行。
4.  **配置恢复：** 执行完成之后恢复`print-and-device.script.enabled`和`print.script.sandboxed`配置项。

在`execute` 函数中，PoC 使用了 `curl` 命令来尝试将`whoami`命令的输出发送到 `http://10.0.40.83:8081`。这可能是PoC作者用于验证漏洞利用成功的一种方式，**但如果直接使用此PoC且目标环境可以访问公网，则可能泄露目标服务器的用户名**。这可以被视为一种潜在的投毒风险。

仔细检查代码后，没有发现明显的恶意代码，例如下载并执行其他程序，或者删除系统文件等。投毒的风险主要在于`execute`函数中硬编码的IP地址和端口号，以及`command`参数的潜在恶意利用。

总体来说，该仓库中存在作者隐藏的投毒代码的可能性较低，风险主要在于使用者不理解PoC代码的含义，直接使用导致的信息泄露，考虑到`curl`命令中的IP地址，以及`command`参数的潜在风险，因此，投毒风险评定为10%。

**利用方式分析：**

1.  攻击者首先利用身份验证绕过漏洞，无需提供任何凭据即可访问 PaperCut NG/MF 的管理界面。
2.  攻击者修改配置，允许执行打印脚本，并禁用脚本沙箱。
3.  攻击者构造包含恶意代码的打印脚本，并将该脚本上传到 PaperCut 服务器。
4.  当 PaperCut 服务器处理打印任务时，恶意脚本会被执行，从而导致远程代码执行。

**项目地址:** [horizon3ai/CVE-2023-27350](https://github.com/horizon3ai/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #9

**来源**: [CVE-2023-27350-imancybersecurity_CVE-2023-27350-POC.md](../2023/CVE-2023-27350-imancybersecurity_CVE-2023-27350-POC.md)

## CVE-2023-27350-PaperCut NG/MF Authentication Bypass and Remote Code Execution

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过,远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 极危，可导致完全系统控制

**影响版本:** 22.0.5 (Build 63914), 8.0 及以上，且低于 20.1.7, 21.2.11, 或 22.0.9

**利用条件:** 目标PaperCut服务器可通过网络访问,9191端口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350是一个存在于PaperCut NG/MF软件中的身份验证绕过漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者绕过身份验证并执行任意代码，获得SYSTEM权限。漏洞存在于SetupCompleted类中，原因是访问控制不当。多个安全厂商和CISA已发布警告，表明该漏洞已被恶意利用。

**有效性分析:**

提供的POC代码 `vuln.py` 主要用于检测目标PaperCut服务器是否存在漏洞，并通过`BeautifulSoup`解析HTML页面以获取版本信息。如果版本在受影响范围内，则脚本会打印易受攻击的信息以及绕过身份验证的URL。`README.md`中提供了利用步骤，包括使用给定的URL绕过身份验证，并利用PaperCut的内置脚本功能执行代码(未在提供的代码中体现，但在描述中提到)。综合来看，该POC代码的有效性较高，可以用来辅助漏洞验证。

**投毒风险分析:**

查看 `vuln.py` 代码，该脚本主要功能是发送HTTP请求、解析HTML并打印信息，未发现明显的恶意代码或后门。脚本依赖于`requests`，`bs4`和`pyfiglet`第三方库，理论上第三方库存在一定投毒风险，但概率较小。`README.md`文件中提供的指令本身不具备投毒行为。因此，综合评估投毒风险较低，约为10%。

**利用方式分析:**

1.  **版本检测:** 使用提供的`vuln.py`脚本检测目标PaperCut服务器的版本。该脚本通过访问`/app?service=page/SetupCompleted`页面，解析HTML获取版本信息。
2.  **身份验证绕过:** 如果版本在受影响范围内，则可以使用`http://<ip>:9191/app?service=page/Dashboard`URL绕过身份验证。
3.  **远程代码执行:** 身份验证绕过后，攻击者可以滥用PaperCut内置的脚本功能来执行任意代码。具体利用方式取决于PaperCut的配置和可用的API，由于未提供具体的执行代码，因此无法详细分析。但根据漏洞信息和搜索结果，执行任意代码是在SYSTEM上下文中进行的。

**项目地址:** [imancybersecurity/CVE-2023-27350-POC](https://github.com/imancybersecurity/CVE-2023-27350-POC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #10

**来源**: [CVE-2023-27350-monke443_CVE-2023-27350.md](../2023/CVE-2023-27350-monke443_CVE-2023-27350.md)

## CVE-2023-27350 - PaperCut NG/MF 身份验证绕过及远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 / 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，允许未经身份验证的远程攻击者以 SYSTEM 权限执行任意代码。

**影响版本:** < 22.0.8

**利用条件:** 目标系统运行受影响版本的 PaperCut NG/MF，且攻击者可访问目标服务器的网络。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 漏洞存在于 PaperCut NG/MF 软件中，允许未经身份验证的攻击者绕过身份验证并远程执行代码。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用方式如下：

1.  **身份验证绕过:** 攻击者利用 `SetupCompleted` Java类中的不当访问控制漏洞，通过构造特定的 HTTP 请求绕过身份验证，从而以管理员身份访问 PaperCut 服务器。
2.  **配置修改:** 绕过身份验证后，攻击者通过修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 配置项，启用打印脚本功能，并禁用沙盒环境。这为执行任意代码创造了条件。
3.  **远程代码执行:** 攻击者利用 PaperCut 软件自身提供的脚本执行功能，执行恶意的脚本代码，从而在服务器上执行任意命令。由于 PaperCut 服务器进程以 SYSTEM 或 root 权限运行，因此执行的命令也具有相应的权限。

**有效性:**

提供的POC代码通过发送特定的POST请求到 `/app?service=page/SetupCompleted` 绕过身份验证。成功后，它禁用打印脚本沙箱并启用打印和设备脚本，允许远程代码执行。PoC 包含检测漏洞是否存在的功能。

**投毒风险评估:**

该漏洞利用代码的 `README.md` 文件中包含警告信息，提示用户谨慎执行该脚本，因为它会重新配置服务器设置以执行命令。虽然脚本在退出时会尝试恢复更改，但在进程被错误终止时可能无法完全恢复。`exploit.py`没有发现恶意行为。但存在极小风险，脚本可能包含隐蔽的、难以检测的恶意代码，或者利用脚本执行远程恶意文件下载和执行。因此，投毒风险评估为 5%。建议在隔离环境中运行和分析该脚本。

**搜索引擎结果补充:**

搜索结果表明 CVE-2023-27350 漏洞被广泛利用，并已被 CISA 列入已知被利用的漏洞目录 (KEV)。多个安全厂商发布了相关的安全公告和分析报告，证实了该漏洞的严重性和利用价值。此外，有报告指出，Bloody 勒索软件团伙也利用该漏洞进行攻击。

**项目地址:** [monke443/CVE-2023-27350](https://github.com/monke443/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---



---

## POC #4

**来源**: [CVE-2023-27350-MaanVader_CVE-2023-27350-POC.md](../2023/CVE-2023-27350-MaanVader_CVE-2023-27350-POC.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过与远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可导致完全系统控制

**影响版本:** 22.0.5 (Build 63914) (NG)和受影响的MF版本

**利用条件:** 目标系统运行PaperCut NG/MF，且允许对9191端口的网络访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27350 允许未经身份验证的远程攻击者绕过 PaperCut NG/MF 的身份验证机制，从而实现远程代码执行。漏洞存在于 `SetupCompleted` 类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在 SYSTEM 上下文中执行任意代码。

**有效性：**
从搜索结果以及漏洞描述来看，漏洞真实存在并且已被积极利用。提供的 POC 代码 `find-vuln-ver.py` 旨在检测目标系统是否运行易受攻击的 PaperCut 版本，并通过访问特定的 URL 来引导攻击者进行身份验证绕过。根据github上的其他POC，第一步绕过验证获取权限，第二步利用内置的脚本功能执行代码。

**投毒风险：**
POC 代码 `find-vuln-ver.py` 本身主要用于检测漏洞版本，并给出绕过登录的URL，代码相对简单，不包含任何明显的恶意代码。但是,任何代码都不能保证绝对的安全。因此，极小的可能会有隐藏的投毒代码(比如通过特殊的字符编码、或者利用一些python的特性来执行恶意操作)。但是考虑到其功能主要是版本检测和URL引导，这个可能性非常低。所以投毒风险评定为1%。

**利用方式：**
1.  **版本检测:** 使用POC脚本或者手动访问`http://<ip>:9191/app?service=page/SetupCompleted`来检测PaperCut NG/MF的版本，确定目标系统是否是易受攻击的版本。
2.  **身份验证绕过:**  如果版本确认是易受攻击的版本，攻击者可以通过访问 `http://<ip>:9191/app?service=page/Dashboard` 来绕过身份验证。
3.  **远程代码执行:** 在绕过身份验证后，攻击者可以利用 PaperCut NG/MF 的内置脚本功能来执行任意代码。这通常涉及到上传恶意脚本或者利用已有的脚本执行机制。具体代码执行方式可能需要参考其他的PoC代码，搜索结果中提到了Horizon3ai的PoC。
4.  **权限提升:**  由于漏洞是在 SYSTEM 上下文中执行代码，攻击者可以完全控制受影响的系统。

**总结：**
CVE-2023-27350 是一个严重的安全漏洞，允许未经身份验证的攻击者完全控制 PaperCut NG/MF 服务器。 该漏洞已经被广泛利用，并被列入 CISA 已知被利用漏洞目录中。强烈建议受影响的用户立即应用补丁。

**项目地址:** [MaanVader/CVE-2023-27350-POC](https://github.com/MaanVader/CVE-2023-27350-POC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #5

**来源**: [CVE-2023-27350-Royall-Researchers_CVE-2023-27350.md](../2023/CVE-2023-27350-Royall-Researchers_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过远程代码执行漏洞

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 + 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 22.0.5 (Build 63914) 及 PaperCut MF 或 NG version 8.0 或 later (excluding patched versions) on all OS platforms.

**利用条件:** 目标服务器运行PaperCut NG/MF，且可以通过网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个严重漏洞，允许未经身份验证的远程攻击者绕过身份验证并以 SYSTEM 权限执行任意代码。漏洞存在于 `SetupCompleted` 类中，由于不正确的访问控制导致。

**利用方式：**

1.  **身份验证绕过：** 攻击者通过访问 `/app?service=page/SetupCompleted` 页面，然后发送特定的 POST 请求绕过身份验证。
2.  **配置修改：** 利用绕过的身份验证，攻击者修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 配置，启用脚本执行并禁用沙箱。
3.  **远程代码执行：** 攻击者通过修改打印机设置，插入恶意的 Groovy 脚本，从而在服务器上执行任意代码。脚本功能被滥用。

**POC 有效性：**
提供的 POC 代码通过模拟上述步骤，可以有效利用该漏洞，在目标服务器上执行任意命令。

**投毒风险：**
代码中存在投毒的风险较低。分析POC代码作者的目的是进行漏洞验证，其中`execute`函数中包含了执行命令的代码。通过对脚本的分析，未发现明显的恶意代码。curl命令中存在IP，可能会导致被收集。但总的来说风险较低。

**项目地址:** [Royall-Researchers/CVE-2023-27350](https://github.com/Royall-Researchers/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #6

**来源**: [CVE-2023-27350-ThatNotEasy_CVE-2023-27350.md](../2023/CVE-2023-27350-ThatNotEasy_CVE-2023-27350.md)

## CVE-2023-27350-PaperCut NG/MF-身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过和远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 极高，可能导致完全系统控制

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统安装了PaperCut NG/MF 22.0.5 (Build 63914)，攻击者需要能够通过网络访问PaperCut服务器。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 存在于 PaperCut NG/MF 软件中，允许未经身份验证的远程攻击者绕过身份验证并执行任意代码。漏洞位于 SetupCompleted 类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在 SYSTEM 上下文中执行任意代码。

**有效性：**
从搜索结果和漏洞库信息来看，该漏洞的POC是可用的，并且已经被积极利用。
提供的Python脚本看起来像是利用了该漏洞，通过访问`/app?service=page/SetupCompleted`路径来绕过身份验证。

**投毒风险：**
查看提供的python代码，代码较为简单，主要用于验证漏洞的存在。代码中引入了requests和BeautifulSoup4库用于发送HTTP请求和解析HTML。该脚本的功能是发送GET请求到目标PaperCut服务器的特定URL，并检查返回的HTML内容是否包含特定的标记，以确定漏洞是否存在。未发现明显的恶意代码。因此，该仓库中存在投毒代码的风险较低，估计在5%左右，主要是考虑到代码可能存在隐藏的缺陷或者依赖项被篡改的风险，但总体上代码逻辑较为清晰。

**利用方式：**
1.  攻击者首先发送特制的HTTP GET请求到目标PaperCut服务器的`/app?service=page/SetupCompleted`端点。
2.  服务器未正确验证身份，允许未经身份验证的访问。
3.  攻击者检查响应的内容以确认漏洞利用是否成功（通过解析HTML查找特定的产品信息）。
4.  成功绕过身份验证后，攻击者可能会利用PaperCut内置的脚本功能来执行任意代码，从而完全控制系统。
5.  参考搜索结果，攻击者可能利用此漏洞安装勒索软件。

**项目地址:** [ThatNotEasy/CVE-2023-27350](https://github.com/ThatNotEasy/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #7

**来源**: [CVE-2023-27350-adhikara13_CVE-2023-27350.md](../2023/CVE-2023-27350-adhikara13_CVE-2023-27350.md)

## CVE-2023-27350-PaperCut-身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 + 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统运行受影响版本的PaperCut NG/MF，且攻击者可以网络访问该系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 中的一个身份验证绕过漏洞。攻击者可以通过向 `/app?service=page/SetupCompleted` 发送特制请求来绕过身份验证。

**利用方式：**

1.  **身份验证绕过：** 未经身份验证的攻击者访问 `/app?service=page/SetupCompleted` 页面，利用不正确的访问控制绕过身份验证。
2.  **获取 Session ID:** 利用绕过的身份验证，通过构造特定的 POST 请求（例如，向 `/app` 发送带有`service=direct/1/SetupCompleted/$Form`的请求）获取有效的 JSESSIONID。
3.  **配置修改：** 使用获得的 JSESSIONID，通过发送 POST 请求到 `/app` 修改 PaperCut 的配置。关键配置包括：
    *   `print-and-device.script.enabled` 设置为 `Y` （启用打印脚本）。
    *   `print.script.sandboxed` 设置为 `N` （禁用脚本沙箱）。
4.  **远程代码执行：** 通过设置打印机脚本来执行任意代码。利用`PrinterDetails/$PrinterDetailsScript.$Form`，将恶意代码注入到`scriptBody`中。该脚本会在打印作业时执行，允许攻击者在系统上执行命令。

**有效性：**

提供的 POC 代码看起来是有效的。它包含以下步骤：

1.  **漏洞检测:**  脚本首先尝试通过访问 `/app?service=page/SetupCompleted` 页面来检测目标是否易受攻击。
2.  **会话获取:** 尝试获取有效的 JSESSIONID。
3.  **配置更改:**  修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 设置。
4.  **命令执行:** 通过打印机脚本注入恶意命令。

根据搜索引擎结果，此漏洞已被积极利用，并且有公开可用的 POC。

**投毒风险分析：**

虽然 POC 主要功能是利用漏洞，但仔细检查发现以下潜在风险：

*   **硬编码的 IP 地址和端口：**POC 中包含一个硬编码的 IP 地址 `10.0.40.83:8081` 在 `execute` 方法中。这可能允许攻击者将受害者信息发送到攻击者控制的服务器。虽然表面上看起来像是用于回调 `whoami` 命令的结果，但恶意攻击者可以修改POC, 也可将其用于收集敏感信息。
*   **Reverse Shell Payload 的修改:** 虽然代码看起来是要设置反向shell, 可以通过修改,将反向shell地址写死,用于恶意用途

因此, 有潜在的投毒风险。由于脚本的行为主要还是漏洞利用,且硬编码的IP地址容易被发现,所以认为投毒风险为**10%**。

**项目地址:** [adhikara13/CVE-2023-27350](https://github.com/adhikara13/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #8

**来源**: [CVE-2023-27350-horizon3ai_CVE-2023-27350.md](../2023/CVE-2023-27350-horizon3ai_CVE-2023-27350.md)

## CVE-2023-27350 PaperCut NG/MF 身份验证绕过与远程代码执行漏洞

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统运行受影响版本的PaperCut NG/MF，且攻击者可以访问目标系统的网络。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个漏洞，允许未经身份验证的远程攻击者执行任意代码。攻击者首先利用身份验证绕过漏洞，然后滥用内置的脚本功能来执行代码。 

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用的有效性极高。CISA已经将此漏洞添加到已知被利用漏洞目录中，表明该漏洞正在被积极利用。Sophos等安全厂商也报告了针对该漏洞的攻击。

**投毒风险分析：**

PoC 代码本身主要包含以下几个步骤：

1.  **身份验证绕过：** 通过访问`/app?service=page/SetupCompleted`绕过身份验证。
2.  **设置修改：** 使用`set_setting`函数修改`print-and-device.script.enabled`和`print.script.sandboxed`配置项，启用打印脚本功能并禁用沙盒。
3.  **命令执行：**  通过修改打印机脚本，将攻击者提供的命令注入到`scriptBody`中执行。
4.  **配置恢复：** 执行完成之后恢复`print-and-device.script.enabled`和`print.script.sandboxed`配置项。

在`execute` 函数中，PoC 使用了 `curl` 命令来尝试将`whoami`命令的输出发送到 `http://10.0.40.83:8081`。这可能是PoC作者用于验证漏洞利用成功的一种方式，**但如果直接使用此PoC且目标环境可以访问公网，则可能泄露目标服务器的用户名**。这可以被视为一种潜在的投毒风险。

仔细检查代码后，没有发现明显的恶意代码，例如下载并执行其他程序，或者删除系统文件等。投毒的风险主要在于`execute`函数中硬编码的IP地址和端口号，以及`command`参数的潜在恶意利用。

总体来说，该仓库中存在作者隐藏的投毒代码的可能性较低，风险主要在于使用者不理解PoC代码的含义，直接使用导致的信息泄露，考虑到`curl`命令中的IP地址，以及`command`参数的潜在风险，因此，投毒风险评定为10%。

**利用方式分析：**

1.  攻击者首先利用身份验证绕过漏洞，无需提供任何凭据即可访问 PaperCut NG/MF 的管理界面。
2.  攻击者修改配置，允许执行打印脚本，并禁用脚本沙箱。
3.  攻击者构造包含恶意代码的打印脚本，并将该脚本上传到 PaperCut 服务器。
4.  当 PaperCut 服务器处理打印任务时，恶意脚本会被执行，从而导致远程代码执行。

**项目地址:** [horizon3ai/CVE-2023-27350](https://github.com/horizon3ai/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #9

**来源**: [CVE-2023-27350-imancybersecurity_CVE-2023-27350-POC.md](../2023/CVE-2023-27350-imancybersecurity_CVE-2023-27350-POC.md)

## CVE-2023-27350-PaperCut NG/MF Authentication Bypass and Remote Code Execution

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过,远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 极危，可导致完全系统控制

**影响版本:** 22.0.5 (Build 63914), 8.0 及以上，且低于 20.1.7, 21.2.11, 或 22.0.9

**利用条件:** 目标PaperCut服务器可通过网络访问,9191端口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350是一个存在于PaperCut NG/MF软件中的身份验证绕过漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者绕过身份验证并执行任意代码，获得SYSTEM权限。漏洞存在于SetupCompleted类中，原因是访问控制不当。多个安全厂商和CISA已发布警告，表明该漏洞已被恶意利用。

**有效性分析:**

提供的POC代码 `vuln.py` 主要用于检测目标PaperCut服务器是否存在漏洞，并通过`BeautifulSoup`解析HTML页面以获取版本信息。如果版本在受影响范围内，则脚本会打印易受攻击的信息以及绕过身份验证的URL。`README.md`中提供了利用步骤，包括使用给定的URL绕过身份验证，并利用PaperCut的内置脚本功能执行代码(未在提供的代码中体现，但在描述中提到)。综合来看，该POC代码的有效性较高，可以用来辅助漏洞验证。

**投毒风险分析:**

查看 `vuln.py` 代码，该脚本主要功能是发送HTTP请求、解析HTML并打印信息，未发现明显的恶意代码或后门。脚本依赖于`requests`，`bs4`和`pyfiglet`第三方库，理论上第三方库存在一定投毒风险，但概率较小。`README.md`文件中提供的指令本身不具备投毒行为。因此，综合评估投毒风险较低，约为10%。

**利用方式分析:**

1.  **版本检测:** 使用提供的`vuln.py`脚本检测目标PaperCut服务器的版本。该脚本通过访问`/app?service=page/SetupCompleted`页面，解析HTML获取版本信息。
2.  **身份验证绕过:** 如果版本在受影响范围内，则可以使用`http://<ip>:9191/app?service=page/Dashboard`URL绕过身份验证。
3.  **远程代码执行:** 身份验证绕过后，攻击者可以滥用PaperCut内置的脚本功能来执行任意代码。具体利用方式取决于PaperCut的配置和可用的API，由于未提供具体的执行代码，因此无法详细分析。但根据漏洞信息和搜索结果，执行任意代码是在SYSTEM上下文中进行的。

**项目地址:** [imancybersecurity/CVE-2023-27350-POC](https://github.com/imancybersecurity/CVE-2023-27350-POC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

## POC #10

**来源**: [CVE-2023-27350-monke443_CVE-2023-27350.md](../2023/CVE-2023-27350-monke443_CVE-2023-27350.md)

## CVE-2023-27350 - PaperCut NG/MF 身份验证绕过及远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 / 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，允许未经身份验证的远程攻击者以 SYSTEM 权限执行任意代码。

**影响版本:** < 22.0.8

**利用条件:** 目标系统运行受影响版本的 PaperCut NG/MF，且攻击者可访问目标服务器的网络。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 漏洞存在于 PaperCut NG/MF 软件中，允许未经身份验证的攻击者绕过身份验证并远程执行代码。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用方式如下：

1.  **身份验证绕过:** 攻击者利用 `SetupCompleted` Java类中的不当访问控制漏洞，通过构造特定的 HTTP 请求绕过身份验证，从而以管理员身份访问 PaperCut 服务器。
2.  **配置修改:** 绕过身份验证后，攻击者通过修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 配置项，启用打印脚本功能，并禁用沙盒环境。这为执行任意代码创造了条件。
3.  **远程代码执行:** 攻击者利用 PaperCut 软件自身提供的脚本执行功能，执行恶意的脚本代码，从而在服务器上执行任意命令。由于 PaperCut 服务器进程以 SYSTEM 或 root 权限运行，因此执行的命令也具有相应的权限。

**有效性:**

提供的POC代码通过发送特定的POST请求到 `/app?service=page/SetupCompleted` 绕过身份验证。成功后，它禁用打印脚本沙箱并启用打印和设备脚本，允许远程代码执行。PoC 包含检测漏洞是否存在的功能。

**投毒风险评估:**

该漏洞利用代码的 `README.md` 文件中包含警告信息，提示用户谨慎执行该脚本，因为它会重新配置服务器设置以执行命令。虽然脚本在退出时会尝试恢复更改，但在进程被错误终止时可能无法完全恢复。`exploit.py`没有发现恶意行为。但存在极小风险，脚本可能包含隐蔽的、难以检测的恶意代码，或者利用脚本执行远程恶意文件下载和执行。因此，投毒风险评估为 5%。建议在隔离环境中运行和分析该脚本。

**搜索引擎结果补充:**

搜索结果表明 CVE-2023-27350 漏洞被广泛利用，并已被 CISA 列入已知被利用的漏洞目录 (KEV)。多个安全厂商发布了相关的安全公告和分析报告，证实了该漏洞的严重性和利用价值。此外，有报告指出，Bloody 勒索软件团伙也利用该漏洞进行攻击。

**项目地址:** [monke443/CVE-2023-27350](https://github.com/monke443/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)

---

