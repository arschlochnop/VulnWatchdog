## CVE-2023-4220 - Chamilo LMS RCE (Remote Code Execution)

**漏洞编号:** CVE-2023-4220

**漏洞类型:** RCE (Remote Code Execution)

**影响应用:** Chamilo LMS

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** Chamilo LMS <= 1.11.24

**利用条件:** 无需身份验证，远程网络访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：该POC针对Chamilo LMS中由于bigupload组件处理不当导致的任意文件上传漏洞。通过深入分析POC代码，该脚本采用Python 3编写，使用了标准的Requests库进行HTTP通信。其核心逻辑分为两个模块：首先，脚本向目标服务器的'/main/inc/lib/javascript/bigupload/inc/bigUpload.php'接口发送POST请求，利用该接口未对上传文件类型进行严格校验的缺陷，上传一个包含恶意PHP指令的Webshell。其次，脚本通过访问上传后的固定路径'/main/inc/lib/javascript/bigupload/files/'来激活并执行上传的PHP文件。此POC提供了完整的参数化输入（如--shell参数自定义文件名），且具备错误处理机制，能够清晰反馈上传结果和执行输出，具有极高的实战化参考价值和复现成功率。利用步骤：1. 准备攻击环境，确保安装Python 3及Requests库；2. 确定目标Chamilo LMS地址，确认bigupload组件路径开放；3. 执行脚本，指定目标URL和待执行的系统命令（如id、whoami）；4. 脚本自动构造多部分表单数据（Multipart form-data）上传PHP Shell；5. 脚本访问生成的Shell地址并解析命令返回结果。投毒风险分析：该POC代码逻辑高度透明，主要依赖Python标准库和第三方公认安全的Requests库。代码中不存在二进制混淆、动态加密执行（如exec(base64)）或可疑的外部网络回调（如向非目标服务器发送敏感数据）。虽然脚本中涉及Payload的上传，但这属于漏洞利用的必要组成部分，并非针对攻击者主机的恶意行为。项目托管于GitHub公开仓库，代码风格符合常规安全研究工具规范。唯一存在的潜在风险点在于用户如果从非官方或第三方未经审计的克隆源下载，可能被植入恶意后门。在本研究范围内，原始POC代码被判定为低投毒风险（10%），主要用于防御性测试和漏洞验证，安全性较高。

**项目地址:** [https://github.com/0x00-null/Chamilo-CVE-2023-4220-RCE-Exploit.git](https://github.com/0x00-null/Chamilo-CVE-2023-4220-RCE-Exploit.git)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)
