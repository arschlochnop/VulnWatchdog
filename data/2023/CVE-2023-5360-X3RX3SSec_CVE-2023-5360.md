## CVE-2023-5360 - WordPress Royal Elementor Addons and Templates plugin RCE (Remote Code Execution)

**漏洞编号:** CVE-2023-5360

**漏洞类型:** RCE (Remote Code Execution)

**影响应用:** WordPress Royal Elementor Addons and Templates plugin

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** < 1.3.79

**利用条件:** 无需身份验证 (Unauthenticated)，插件需处于激活状态，且通常需要能够访问包含 Elementor 编辑器配置的页面以提取 Nonce。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞存在于 Royal Elementor Addons 插件的文件上传功能中。通过提供的 Python POC 代码分析，攻击者首先通过访问目标页面并使用正则表达式提取 'WprConfig' 中的 'nonce'，这是绕过安全验证的关键步骤。一旦获得 Nonce，攻击者利用不安全的文件上传接口，通过特定的 multipart/form-data 请求将恶意的 PHP 脚本（如 WebShell 或反弹 Shell）上传到服务器。由于插件未对上传文件的扩展名或内容进行严格校验，且上传目录通常可直接访问，攻击者可以通过直接请求上传的文件来触发代码执行。POC 实现了从自动化提取 Token 到选择 Payload（简单命令执行或反弹 Bash Shell）的完整流程，并集成了本地 nc 监听功能，具有极高的实战价值。利用步骤：1. 运行 POC 并指定目标 WordPress 页面 URL。2. POC 自动发送 GET 请求并解析 HTML，提取 WprConfig.nonce。3. 攻击者在交互界面选择 Payload 类型（WebShell 或反弹 Shell）。4. POC 构造 POST 请求，携带 Nonce 将恶意 PHP 代码上传至插件预设的上传路径。5. 若选择反弹 Shell，POC 会在本地开启监听并等待连接；若选择 WebShell，则通过 GET 参数 'cmd' 执行系统指令。投毒风险分析：该脚本代码逻辑清晰，主要使用了 Python 的 requests、re 和 subprocess 等标准库，未发现明显的代码混淆、二进制加密或隐藏的远程下发指令（C2）行为。脚本开头带有明显的作者信息标识（X3RX3S），符合安全研究人员发布 POC 的特征。然而，存在两个潜在的中度风险点：第一，脚本集成了自动化的 Shell 反弹和本地监听功能，虽然这极大方便了测试，但也降低了非专业人员利用此工具进行非法攻击的门槛。第二，由于脚本来源于第三方 GitHub 仓库（Chocapikk/CVE-2023-5360），且 Banner 部分提到了其他社交账号（@mindfuckerrrr），在实际下载使用前，必须对 subprocess.call(['nc', ...]) 等调用系统命令的代码块进行审查，防止其在本地执行非预期的恶意指令。目前看，该 POC 属于正常的技术分享，直接针对下载者进行系统投毒的可能性较低，但由于其具备完整的 RCE 能力，在防御性研究时应在隔离环境运行，防止误伤或被反向控制。

**项目地址:** [https://github.com/Chocapikk/CVE-2023-5360](https://github.com/Chocapikk/CVE-2023-5360)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2023-5360](https://nvd.nist.gov/vuln/detail/CVE-2023-5360)
