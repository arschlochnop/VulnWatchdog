## CVE-2023-5360 - Royal Elementor Addons and Templates (WordPress Plugin) 任意文件上传/RCE

**漏洞编号:** CVE-2023-5360

**漏洞类型:** 任意文件上传/RCE

**影响应用:** Royal Elementor Addons and Templates (WordPress Plugin)

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** < 1.3.79

**利用条件:** 无需认证，远程网络访问

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞存在于WordPress的Royal Elementor Addons and Templates插件中，主要原因是插件在处理文件上传请求时缺乏必要的安全验证和类型检查。公开的POC代码展示了攻击者如何利用该漏洞。代码首先探测目标网站是否存在特定的插件路径，随后构造一个带有恶意PHP脚本的multipart/form-data POST请求。由于插件未对上传文件的扩展名或MIME类型进行严格限制，攻击者可以直接上传包含Webshell的PHP文件（如POC中定义的PHP_UPLOAD_CODE）。该POC包含了完整的攻击逻辑：自动化路径探测、利用multipart编码绕过简单的检测、以及上传成功后的URL反馈。此POC能够稳定触发，因为它针对的是插件默认的公开上传接口，且无需任何用户交互或登录凭证，这使得该漏洞在野外极易被大规模利用。利用步骤：1. 准备攻击负载，通常是一个包含文件上传功能或命令执行功能的PHP脚本。2. 使用Python脚本扫描目标，验证插件版本是否低于1.3.79。3. 向受影响的端点发送POST请求，将Payload文件伪装并上传。4. 访问上传后的文件路径以激活Webshell。5. 通过Webshell执行任意系统命令或进一步渗透服务器。投毒风险分析：该POC代码使用了标准库如requests、asyncio和colorama。在代码结构上，它采用了典型的渗透测试框架风格，旨在批量验证目标。经过安全审查，代码主要风险在于其提供的‘PHP_UPLOAD_CODE’片段，这是一个典型的交互式上传Webshell，属于漏洞验证套件的一部分，而非针对研究人员的恶意后门。然而，投毒风险评定为15%，是因为此类脚本常被修改后传播，且使用了‘InsecureRequestWarning’禁用警告。虽然当前代码本身不具备窃取本地敏感信息或反弹Shell至第三方控制服务器的隐蔽恶意行为，但使用者仍需警惕在执行此类自动化脚本时，脚本是否会向非目标域名发送数据包。此脚本清晰、可读，未见明显的混淆手段或eval等高危函数注入，符合安全研究工具的特征。

**项目地址:** [https://wpscan.com/vulnerability/281518ff-7816-4007-b712-63aed7828b34/](https://wpscan.com/vulnerability/281518ff-7816-4007-b712-63aed7828b34/)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2023-5360](https://nvd.nist.gov/vuln/detail/CVE-2023-5360)
