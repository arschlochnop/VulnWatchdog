## CVE-2023-50564 - Pluck CMS 远程代码执行 (RCE)

**漏洞编号:** CVE-2023-50564

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Pluck CMS

**危害等级:** 高危

**CVSS评分:** 7.2 (CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** v4.7.18

**利用条件:** 需要认证 (管理员权限), 需要网络访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

POC有效性分析:
该POC针对Pluck CMS v4.7.18版本中的CVE-2023-50564漏洞，实现了经过身份验证的远程代码执行（RCE）。该漏洞的核心在于一个经过认证的管理员用户可以上传恶意ZIP模块，其中包含PHP WebShell。

该POC的`exploit.py`脚本设计精良，功能完整。首先，它通过向`/login.php`端点发送POST请求，使用提供的用户名和密码尝试登录目标Pluck CMS系统。登录成功后，脚本会使用`zipfile`模块在本地创建一个名为`payload.zip`的压缩文件。这个ZIP文件内部包含用户指定的PHP shell文件（例如反向shell），并将其重命名为`shell.php`。

接下来，脚本将这个恶意的`payload.zip`文件作为模块上传到`/admin.php?action=installmodule`端点。Pluck CMS系统在处理上传的模块时，会将其解压到预定的目录结构中，通常是`/data/modules/payload/`。因此，`shell.php`文件最终会被放置在`/data/modules/payload/shell.php`路径下。

最后，POC通过向`rce_url`（即`/data/modules/payload/shell.php`）发送HTTP请求来触发并执行上传的PHP shell。如果PHP shell是反向shell，这将导致目标服务器连接到攻击者预设的监听器，从而获得远程代码执行的能力。`README.md`文件提供了清晰的用法说明，包括如何设置Netcat监听器和配置PHP反向shell，使得整个利用过程非常直观且易于操作。脚本的参数化设计（支持自定义目标、端口、凭据和shell路径）进一步增强了其可用性和灵活性。根据代码逻辑和文档，该POC在提供管理员凭据的情况下，能够有效利用Pluck CMS v4.7.18的此漏洞。

利用步骤:
1.  **环境准备:** 确保目标系统运行Pluck CMS v4.7.18，并拥有有效的管理员账户凭据。
2.  **获取POC:** 通过Git克隆POC仓库：`git clone https://github.com/glynzr/CVE-2023-50564.git`。
3.  **安装依赖:** 进入POC目录并安装所需的Python库：`cd CVE-2023-50564 && pip3 install -r requirements.txt`。
4.  **准备PHP Shell:** 从`https://github.com/pentestmonkey/php-reverse-shell`等来源下载或创建PHP反向shell文件，并根据攻击者机器的IP地址和监听端口进行配置。
5.  **启动监听器:** 在攻击者机器上启动Netcat监听器，等待反向shell连接：`nc -nvlp <攻击者监听端口>`。
6.  **执行POC:** 运行POC脚本，指定目标、管理员凭据和PHP shell文件的路径：`python3 exploit.py -t <目标IP或域名> -u <管理员用户名> -pass <管理员密码> -path <php-reverse-shell.php文件的路径>`。
7.  **验证RCE:** 如果利用成功，Netcat监听器将收到来自目标Pluck CMS服务器的反向shell连接，表明已获得远程代码执行权限。

投毒风险分析:
该POC代码（`exploit.py`）的目的是演示和利用Pluck CMS `CVE-2023-50564`漏洞，实现远程代码执行。根据对代码的审查，**该POC本身被设计为一个合法的漏洞利用工具，不包含直接的恶意投毒行为。**

1.  **代码透明度与可读性:** `exploit.py`使用Python编写，代码逻辑清晰，易于理解。它采用了标准的Python库，如`requests`用于网络通信，`zipfile`用于文件压缩，`argparse`用于命令行参数解析。没有发现任何形式的代码混淆、加密或尝试隐藏恶意功能的迹象。
2.  **依赖项分析:** `requirements.txt`文件中列出的依赖项包括`requests`和`requests_toolbelt`，这些都是广泛使用且被认为是安全的Python HTTP客户端库，不包含已知的恶意组件。
3.  **外部连接:** 除了与目标Pluck CMS服务器进行漏洞利用所需的HTTP/HTTPS通信外，POC代码本身并未尝试与任何其他未知的或可疑的外部服务器建立连接、下载额外的内容或执行更新操作。所有网络交互都集中在目标系统上。
4.  **本地文件操作:** POC在本地创建并处理`payload.zip`临时文件，这是将用户提供的PHP shell打包以便上传到目标系统所必需的步骤。这种文件操作是漏洞利用过程的正常组成部分，而不是为了在本地机器上植入恶意文件。
5.  **恶意载荷由用户提供:** POC的设计允许用户指定自定义的PHP shell文件作为恶意载荷（通过`-path`参数）。这意味着POC本身并不内置恶意payload，而是依赖于用户提供合法或恶意的payload。因此，潜在的恶意行为风险主要存在于用户选择的PHP shell内容，而非POC脚本本身。

综上所述，该POC代码在透明性、依赖项的安全性以及功能目的方面表现良好。其主要功能是作为一种工具来测试或利用特定漏洞，而不是作为传播恶意软件的媒介。因此，**该POC的投毒风险评估为低（5%）**。建议任何使用此POC进行测试的用户，在执行前仔细审查所有代码，并确保在受控的隔离环境中进行操作，特别是对于自定义的PHP shell载荷。

**项目地址:** https://github.com/glynzr/CVE-2023-50564.git

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2023-50564
