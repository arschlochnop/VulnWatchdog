# CVE-2023-34362

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-34362-Chinyemba-ck_MOVEit-CVE-2023-34362.md](../2023/CVE-2023-34362-Chinyemba-ck_MOVEit-CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未授权访问数据库、数据泄露、修改或删除数据库元素，甚至远程代码执行。

**影响版本:** 受影响版本包括2021.0.6 (13.0.6)之前的所有版本、2021.1.4 (13.1.4)之前的所有版本、2022.0.4 (14.0.4)之前的所有版本、2022.1.5 (14.1.5)之前的所有版本和2023.0.1 (15.0.1)之前的所有版本。包括2020.0和2019x等旧的不受支持的版本。

**利用条件:** 需要通过HTTP或HTTPS网络访问MOVEit Transfer Web应用程序。

**POC 可用性:** 是，但提供的代码仅为分析视频链接，需要自行搜索POC代码。

**投毒风险:** 5%

## 详情

CVE-2023-34362是MOVEit Transfer Web应用程序中发现的一个SQL注入漏洞。未经身份验证的攻击者可以利用此漏洞获得对MOVEit Transfer数据库的访问权限。根据使用的数据库引擎（MySQL、Microsoft SQL Server或Azure SQL），攻击者可能能够推断有关数据库结构和内容的信息，并执行SQL语句来更改或删除数据库元素。该漏洞已被Clop勒索软件团伙利用进行数据窃取。提供的漏洞利用代码只是一个README文件，指向一个分析视频，因此不能直接用于漏洞利用，需要自行搜索并验证可用的POC代码。投毒风险较低，因为提供的代码只包含一个视频链接，并非实际的漏洞利用程序。但如果视频链接指向恶意站点，则存在一定的风险。根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**利用方式：**

1.  **确定目标：** 识别运行MOVEit Transfer且未打补丁的系统。
2.  **SQL注入：** 通过构造恶意的SQL查询，利用未过滤的输入点注入恶意SQL代码。
3.  **信息泄露/数据窃取：** 成功注入SQL代码后，攻击者可以读取数据库中的敏感信息，例如用户名、密码、API密钥和私有数据。
4.  **数据修改/删除：** 攻击者还可以通过SQL注入来修改或删除数据库中的数据，导致服务中断或数据损坏。
5.  **远程代码执行 (可能)：** 在某些数据库配置中，攻击者可能能够通过SQL注入执行操作系统命令，从而获得对服务器的完全控制权。

**项目地址:** [Chinyemba-ck/MOVEit-CVE-2023-34362](https://github.com/Chinyemba-ck/MOVEit-CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #2

**来源**: [CVE-2023-34362-Malwareman007_CVE-2023-34362.md](../2023/CVE-2023-34362-Malwareman007_CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** 受影响版本包括2021.0.6 (13.0.6)之前的版本, 2021.1.4 (13.1.4)之前的版本, 2022.0.4 (14.0.4)之前的版本, 2022.1.5 (14.1.5)之前的版本, 和 2023.0.1 (15.0.1)之前的版本,以及所有早于这五个版本的版本 (例如，2020.0和2019x)

**利用条件:** 需要网络访问，未授权攻击即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34362是MOVEit Transfer中的一个SQL注入漏洞，攻击者可以通过构造恶意的SQL语句，利用guestaccess.aspx页面，从而获取对数据库的未授权访问，甚至执行任意SQL命令。

**漏洞利用有效性:**
根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用的有效性较高。漏洞库信息表明这是一个在野利用的漏洞，搜索引擎结果也证实了这一点，并提到Clop勒索软件团伙利用此漏洞进行攻击。POC代码尝试利用guestaccess.aspx进行SQL注入，通过设置特定的session变量，将SQL语句注入到数据库查询中。

**投毒风险分析:**
POC代码本身看起来是用于利用漏洞的，但存在潜在的投毒风险。create_jwt 函数尝试读取key.pem和cert.crt，如果这两个文件被替换为恶意文件，攻击者有可能通过该POC植入后门。由于需要文件读取，且代码逻辑较为复杂，存在一定被植入恶意代码的风险，风险程度为10%。

**利用方式:**
1.  **获取CSRF Token:** 首先，利用`get_csrf`函数发送POST请求到`guestaccess.aspx`，获取CSRF Token。
2.  **设置Session变量:** 利用`set_session_variables`函数，通过`MOVEitISAPI.dll`设置包含恶意SQL语句的Session变量。该函数通过构造特定的HTTP头，绕过身份验证，将恶意SQL代码传递到后端。
3.  **触发SQL注入:** 调用`do_guest_access`函数，通过发送包含CSRF Token和相关参数的POST请求到`guestaccess.aspx`，触发SQL注入。
4.  **执行SQL语句:** 恶意SQL语句被执行，可能导致数据泄露、篡改或远程代码执行。
5.  **创建JWT(可疑):**create_jwt函数创建jwt，读取证书文件，这可能被用于身份认证绕过或者其他恶意操作，但是否一定存在恶意行为有待进一步分析。

**项目地址:** [Malwareman007/CVE-2023-34362](https://github.com/Malwareman007/CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #3

**来源**: [CVE-2023-34362-Naveenbana5250_CVE-2023-34362-Defense-Package.md](../2023/CVE-2023-34362-Naveenbana5250_CVE-2023-34362-Defense-Package.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，未经身份验证的攻击者可以访问数据库，可能导致信息泄露，修改或删除数据库元素，最终实现远程代码执行。

**影响版本:** 所有版本（例如2020.0和2019x）在五个明确提到的版本之前都受到影响，包括较旧的不受支持的版本。具体受影响版本包括：MOVEit Transfer before 2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), and 2023.0.1 (15.0.1)

**利用条件:** 需要MOVEit Transfer应用程序可通过HTTP或HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34362 是 MOVEit Transfer Web应用程序中发现的 SQL 注入漏洞。未经身份验证的攻击者可以利用此漏洞访问 MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL，Microsoft SQL Server或Azure SQL），攻击者可以推断有关数据库结构和内容的信息，并执行SQL语句来更改或删除数据库元素。漏洞利用通常通过构造恶意的 HTTP POST 请求，目标是 `/moveitisapi.dll?action=m2` 接口，并在 `X-siLock-SessVar` header 中注入 SQL 代码。

**有效性：**
根据漏洞描述和已公开的漏洞利用报告，该漏洞的POC代码有效。大量的实际攻击事件也证实了这一点。

**投毒风险：**
提供的代码仓库主要包含防御规则和IOCs。Suricata规则和Sigma规则用于检测SQL注入攻击和Webshell访问，未发现恶意代码。IOCs列表可以帮助安全分析人员识别受影响的系统。虽然主要目的是防御，但仍然存在一定的投毒风险。例如，Suricata 和 Sigma 规则可能存在误报，导致不必要的警报。此外，IOCs 可能不完整或不准确，导致遗漏真正的攻击。综合考虑，投毒风险较低，大约为10%。

**利用方式：**
1.  **SQL 注入：** 攻击者向 `/moveitisapi.dll?action=m2` 发送带有恶意构造的 `X-siLock-SessVar` header 的 HTTP POST 请求，利用SQL注入漏洞。
2.  **Webshell 部署：** 成功利用SQL注入后，攻击者可以部署Webshell（例如 `human2.aspx`），从而实现远程代码执行。
3.  **数据窃取和持久化：** 攻击者使用Webshell窃取敏感数据，并通过创建后门账户等方式实现持久化访问。

**项目地址:** [Naveenbana5250/CVE-2023-34362-Defense-Package](https://github.com/Naveenbana5250/CVE-2023-34362-Defense-Package)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #4

**来源**: [CVE-2023-34362-deepinstinct_MOVEit_CVE-2023-34362_IOCs.md](../2023/CVE-2023-34362-deepinstinct_MOVEit_CVE-2023-34362_IOCs.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未经授权的数据库访问、信息泄露、数据篡改和远程代码执行

**影响版本:** 所有版本（例如2020.0和2019x）在明确提到的五个版本之前都受影响，包括较旧的不受支持的版本，以及2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), 和 2023.0.1 (15.0.1)

**利用条件:** 未经身份验证的远程攻击，可通过HTTP或HTTPS进行利用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-34362是MOVEit Transfer Web应用程序中发现的SQL注入漏洞。未经身份验证的攻击者可以利用此漏洞访问MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL，Microsoft SQL Server或Azure SQL），攻击者可能能够推断有关数据库结构和内容的信息，并执行SQL语句以更改或删除数据库元素。该漏洞已在野外被利用，Clop勒索软件组织声称对此负责。提供的POC代码是一个CSV文件，包含入侵指标（IOC），如文件路径、HTTP请求、IP地址、域名和SHA256哈希值。这些IOC可以帮助检测和响应针对MOVEit Transfer的攻击。

**有效性评估：** 从搜索结果和漏洞库信息来看，此漏洞的利用是真实且有效的。POC代码提供的IOC列表能够帮助安全分析人员识别潜在的攻击行为。因此，提供的IOC文件本身是有效的，可以作为检测和防御此漏洞攻击的依据。

**投毒风险分析：** 该代码主要是一个包含IOC的CSV文件和一个README文件。其中README文件是一个免责声明。CSV文件中包含了HTTP请求的路径、可疑IP地址，以及可能被利用的ASP.NET文件，以及一些user agent和hash。虽然列出的IP地址可能包含恶意IP，但把IP地址加入IOC列表的行为属于漏洞利用信息的共享，不属于投毒行为。综上，这个仓库本身包含作者隐藏的恶意投毒代码的概率较低，仅存在一些IP地址未来被错误标记的低概率风险。评估风险百分比为5%。

**利用方式分析：** 攻击者利用该漏洞通常通过发送特制的HTTP请求，该请求包含恶意的SQL代码。此SQL代码会被MOVEit Transfer应用解析，并传递给后端的数据库服务器执行。成功利用此漏洞可能允许攻击者：
1.  **数据泄露：** 提取敏感信息，如用户名、密码、用户数据等。
2.  **数据篡改：** 修改数据库中的数据，例如提升权限、篡改文件等。
3.  **远程代码执行：** 在某些数据库配置下，攻击者可能执行操作系统命令，从而完全控制服务器。

从POC代码来看，利用方式主要依赖于构造恶意的HTTP请求，例如`POST /moveitisapi/moveitisapi.dll`，`POST /guestaccess.aspx`， `POST /api/v1/folders/[random]/files`，并通过SQL注入来操纵数据库。

**项目地址:** [deepinstinct/MOVEit_CVE-2023-34362_IOCs](https://github.com/deepinstinct/MOVEit_CVE-2023-34362_IOCs)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #5

**来源**: [CVE-2023-34362-errorfiathck_MOVEit-Exploit.md](../2023/CVE-2023-34362-errorfiathck_MOVEit-Exploit.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未授权访问数据库，信息泄露，甚至远程代码执行。

**影响版本:** < 2021.0.6 (13.0.6), < 2021.1.4 (13.1.4), < 2022.0.4 (14.0.4), < 2022.1.5 (14.1.5), < 2023.0.1 (15.0.1)

**利用条件:** 需要网络访问 MOVEit Transfer Web 应用。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于 MOVEit Transfer Web 应用的 guestaccess.aspx 页面，是一个未经身份验证的 SQL 注入漏洞。攻击者可以通过构造恶意的 SQL 语句注入到 `MyPkgSelfProvisionedRecips` session 变量中，然后触发 `guestaccess.aspx` 的处理逻辑来执行 SQL 语句，从而获取数据库的敏感信息，甚至修改或删除数据库中的数据。POC 代码通过设置特定的 session 变量并发送包含恶意 SQL 语句的请求来利用此漏洞。

**有效性评估：**

*   漏洞库信息和搜索引擎结果表明该漏洞是一个高危且被广泛利用的漏洞。
*   提供的 POC 代码实现了利用该漏洞的步骤，包括获取 CSRF token，设置 session 变量，以及触发 SQL 注入。
*   代码中包含创建 JWT 并获取 access token 的功能，可能用于绕过某些身份验证机制，执行更高级别的操作，例如删除文件。

**投毒风险评估：**

代码主要通过SQL注入利用已知漏洞。`create_jwt`函数依赖`key.pem`和`cert.crt`文件，如果这两个文件本身被替换为恶意文件，可能会导致私钥泄露或权限提升漏洞。代码本身功能比较单一，直接植入后门的可能性较低，投毒的可能性较低。

**利用方式：**

1.  **获取 Session ID:** 向 MOVEit Transfer Web 应用发送请求，获取 `ASP.NET_SessionId` cookie。
2.  **获取 CSRF Token:** 向 `guestaccess.aspx` 发送 POST 请求，获取 CSRF token。
3.  **设置 Session 变量:**  利用 `MOVEitISAPI.dll` 的漏洞，通过设置 `MyPkgSelfProvisionedRecips` session 变量注入恶意 SQL 语句。
4.  **触发 SQL 注入:** 向 `guestaccess.aspx` 发送包含 CSRF token 的 POST 请求，触发 SQL 注入。
5.  **获取 Access Token (可选):** 如果需要执行更高级别的操作，可以使用提供的 JWT 创建功能获取 access token。
6.  **执行恶意操作 (可选):** 使用 access token 执行恶意操作，例如删除文件。

总的来说，这个 POC 的有效性很高，因为它利用了一个已知的、被广泛利用的漏洞。 投毒风险较低，但需要关注 `key.pem`和`cert.crt`文件。

**项目地址:** [errorfiathck/MOVEit-Exploit](https://github.com/errorfiathck/MOVEit-Exploit)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #6

**来源**: [CVE-2023-34362-glen-pearson_MoveIT-CVE-2023-34362-RCE.md](../2023/CVE-2023-34362-glen-pearson_MoveIT-CVE-2023-34362-RCE.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可导致未经身份验证的攻击者访问数据库，远程代码执行。

**影响版本:** 受影响版本包括早于 2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), 和 2023.0.1 (15.0.1) 的版本，以及所有这些版本之前的版本（例如 2020.0 和 2019x）以及较旧的不受支持的版本。

**利用条件:** 需要可以通过HTTP或HTTPS访问MOVEit Transfer的Web应用程序。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-34362 存在于 MOVEit Transfer Web 应用程序中，是一个未经身份验证的 SQL 注入漏洞。攻击者可以利用此漏洞访问 MOVEit Transfer 数据库，并根据使用的数据库引擎（MySQL、Microsoft SQL Server 或 Azure SQL），推断数据库的结构和内容，并执行 SQL 语句来更改或删除数据库元素。根据提供的漏洞利用代码`move.rb`，该漏洞利用脚本首先获取初始会话令牌和InstID，然后创建一个新的sysadmin帐户，利用API访问令牌，找到folderId。该脚本泄露 Org Key 并使用反序列化 Gadget 植入加密的Gadget到数据库中，最后触发 Gadget 反序列化，实现远程代码执行（RCE）。最后，该脚本删除IoC。

**有效性：**

从漏洞库信息、搜索结果和漏洞利用代码来看，该漏洞是真实存在的，并且已经被积极利用。提供的PoC代码通过执行一系列操作，包括创建管理员账户、上传恶意文件（gadget），然后利用反序列化漏洞执行任意代码，验证了漏洞的可利用性。

**投毒风险：**

提供的ruby脚本主要功能是利用漏洞，而不是进行投毒。

*   `move.rb` 脚本看起来是为了利用 MOVEit Transfer 中的 SQL 注入漏洞而设计的，目的是实现远程代码执行。它创建管理员帐户、上传文件、进行反序列化攻击等。这些行为都是直接针对漏洞利用，而不是为了在目标系统上安装恶意后门或进行其他恶意活动。

*   风险评估： 0.1%的可能将漏洞验证过程中写入数据库的后门判定为恶意投毒代码。

**利用方式：**

1.  **SQL 注入：** 攻击者利用 SQL 注入漏洞，在数据库中创建一个新的具有管理员权限的帐户。
2.  **文件上传：** 攻击者上传包含恶意代码的文件（gadget）。
3.  **反序列化：** 攻击者触发反序列化过程，执行上传的恶意代码，从而实现远程代码执行。

总而言之，提供的PoC代码是有效的，并且能够成功利用该漏洞实现远程代码执行。投毒的风险很低。


**项目地址:** [glen-pearson/MoveIT-CVE-2023-34362-RCE](https://github.com/glen-pearson/MoveIT-CVE-2023-34362-RCE)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #7

**来源**: [CVE-2023-34362-horizon3ai_CVE-2023-34362.md](../2023/CVE-2023-34362-horizon3ai_CVE-2023-34362.md)

# CVE-2023-34362

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-34362-Chinyemba-ck_MOVEit-CVE-2023-34362.md](../2023/CVE-2023-34362-Chinyemba-ck_MOVEit-CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未授权访问数据库、数据泄露、修改或删除数据库元素，甚至远程代码执行。

**影响版本:** 受影响版本包括2021.0.6 (13.0.6)之前的所有版本、2021.1.4 (13.1.4)之前的所有版本、2022.0.4 (14.0.4)之前的所有版本、2022.1.5 (14.1.5)之前的所有版本和2023.0.1 (15.0.1)之前的所有版本。包括2020.0和2019x等旧的不受支持的版本。

**利用条件:** 需要通过HTTP或HTTPS网络访问MOVEit Transfer Web应用程序。

**POC 可用性:** 是，但提供的代码仅为分析视频链接，需要自行搜索POC代码。

**投毒风险:** 5%

## 详情

CVE-2023-34362是MOVEit Transfer Web应用程序中发现的一个SQL注入漏洞。未经身份验证的攻击者可以利用此漏洞获得对MOVEit Transfer数据库的访问权限。根据使用的数据库引擎（MySQL、Microsoft SQL Server或Azure SQL），攻击者可能能够推断有关数据库结构和内容的信息，并执行SQL语句来更改或删除数据库元素。该漏洞已被Clop勒索软件团伙利用进行数据窃取。提供的漏洞利用代码只是一个README文件，指向一个分析视频，因此不能直接用于漏洞利用，需要自行搜索并验证可用的POC代码。投毒风险较低，因为提供的代码只包含一个视频链接，并非实际的漏洞利用程序。但如果视频链接指向恶意站点，则存在一定的风险。根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**利用方式：**

1.  **确定目标：** 识别运行MOVEit Transfer且未打补丁的系统。
2.  **SQL注入：** 通过构造恶意的SQL查询，利用未过滤的输入点注入恶意SQL代码。
3.  **信息泄露/数据窃取：** 成功注入SQL代码后，攻击者可以读取数据库中的敏感信息，例如用户名、密码、API密钥和私有数据。
4.  **数据修改/删除：** 攻击者还可以通过SQL注入来修改或删除数据库中的数据，导致服务中断或数据损坏。
5.  **远程代码执行 (可能)：** 在某些数据库配置中，攻击者可能能够通过SQL注入执行操作系统命令，从而获得对服务器的完全控制权。

**项目地址:** [Chinyemba-ck/MOVEit-CVE-2023-34362](https://github.com/Chinyemba-ck/MOVEit-CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #2

**来源**: [CVE-2023-34362-Malwareman007_CVE-2023-34362.md](../2023/CVE-2023-34362-Malwareman007_CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** 受影响版本包括2021.0.6 (13.0.6)之前的版本, 2021.1.4 (13.1.4)之前的版本, 2022.0.4 (14.0.4)之前的版本, 2022.1.5 (14.1.5)之前的版本, 和 2023.0.1 (15.0.1)之前的版本,以及所有早于这五个版本的版本 (例如，2020.0和2019x)

**利用条件:** 需要网络访问，未授权攻击即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34362是MOVEit Transfer中的一个SQL注入漏洞，攻击者可以通过构造恶意的SQL语句，利用guestaccess.aspx页面，从而获取对数据库的未授权访问，甚至执行任意SQL命令。

**漏洞利用有效性:**
根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用的有效性较高。漏洞库信息表明这是一个在野利用的漏洞，搜索引擎结果也证实了这一点，并提到Clop勒索软件团伙利用此漏洞进行攻击。POC代码尝试利用guestaccess.aspx进行SQL注入，通过设置特定的session变量，将SQL语句注入到数据库查询中。

**投毒风险分析:**
POC代码本身看起来是用于利用漏洞的，但存在潜在的投毒风险。create_jwt 函数尝试读取key.pem和cert.crt，如果这两个文件被替换为恶意文件，攻击者有可能通过该POC植入后门。由于需要文件读取，且代码逻辑较为复杂，存在一定被植入恶意代码的风险，风险程度为10%。

**利用方式:**
1.  **获取CSRF Token:** 首先，利用`get_csrf`函数发送POST请求到`guestaccess.aspx`，获取CSRF Token。
2.  **设置Session变量:** 利用`set_session_variables`函数，通过`MOVEitISAPI.dll`设置包含恶意SQL语句的Session变量。该函数通过构造特定的HTTP头，绕过身份验证，将恶意SQL代码传递到后端。
3.  **触发SQL注入:** 调用`do_guest_access`函数，通过发送包含CSRF Token和相关参数的POST请求到`guestaccess.aspx`，触发SQL注入。
4.  **执行SQL语句:** 恶意SQL语句被执行，可能导致数据泄露、篡改或远程代码执行。
5.  **创建JWT(可疑):**create_jwt函数创建jwt，读取证书文件，这可能被用于身份认证绕过或者其他恶意操作，但是否一定存在恶意行为有待进一步分析。

**项目地址:** [Malwareman007/CVE-2023-34362](https://github.com/Malwareman007/CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #3

**来源**: [CVE-2023-34362-Naveenbana5250_CVE-2023-34362-Defense-Package.md](../2023/CVE-2023-34362-Naveenbana5250_CVE-2023-34362-Defense-Package.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，未经身份验证的攻击者可以访问数据库，可能导致信息泄露，修改或删除数据库元素，最终实现远程代码执行。

**影响版本:** 所有版本（例如2020.0和2019x）在五个明确提到的版本之前都受到影响，包括较旧的不受支持的版本。具体受影响版本包括：MOVEit Transfer before 2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), and 2023.0.1 (15.0.1)

**利用条件:** 需要MOVEit Transfer应用程序可通过HTTP或HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34362 是 MOVEit Transfer Web应用程序中发现的 SQL 注入漏洞。未经身份验证的攻击者可以利用此漏洞访问 MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL，Microsoft SQL Server或Azure SQL），攻击者可以推断有关数据库结构和内容的信息，并执行SQL语句来更改或删除数据库元素。漏洞利用通常通过构造恶意的 HTTP POST 请求，目标是 `/moveitisapi.dll?action=m2` 接口，并在 `X-siLock-SessVar` header 中注入 SQL 代码。

**有效性：**
根据漏洞描述和已公开的漏洞利用报告，该漏洞的POC代码有效。大量的实际攻击事件也证实了这一点。

**投毒风险：**
提供的代码仓库主要包含防御规则和IOCs。Suricata规则和Sigma规则用于检测SQL注入攻击和Webshell访问，未发现恶意代码。IOCs列表可以帮助安全分析人员识别受影响的系统。虽然主要目的是防御，但仍然存在一定的投毒风险。例如，Suricata 和 Sigma 规则可能存在误报，导致不必要的警报。此外，IOCs 可能不完整或不准确，导致遗漏真正的攻击。综合考虑，投毒风险较低，大约为10%。

**利用方式：**
1.  **SQL 注入：** 攻击者向 `/moveitisapi.dll?action=m2` 发送带有恶意构造的 `X-siLock-SessVar` header 的 HTTP POST 请求，利用SQL注入漏洞。
2.  **Webshell 部署：** 成功利用SQL注入后，攻击者可以部署Webshell（例如 `human2.aspx`），从而实现远程代码执行。
3.  **数据窃取和持久化：** 攻击者使用Webshell窃取敏感数据，并通过创建后门账户等方式实现持久化访问。

**项目地址:** [Naveenbana5250/CVE-2023-34362-Defense-Package](https://github.com/Naveenbana5250/CVE-2023-34362-Defense-Package)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #4

**来源**: [CVE-2023-34362-deepinstinct_MOVEit_CVE-2023-34362_IOCs.md](../2023/CVE-2023-34362-deepinstinct_MOVEit_CVE-2023-34362_IOCs.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未经授权的数据库访问、信息泄露、数据篡改和远程代码执行

**影响版本:** 所有版本（例如2020.0和2019x）在明确提到的五个版本之前都受影响，包括较旧的不受支持的版本，以及2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), 和 2023.0.1 (15.0.1)

**利用条件:** 未经身份验证的远程攻击，可通过HTTP或HTTPS进行利用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-34362是MOVEit Transfer Web应用程序中发现的SQL注入漏洞。未经身份验证的攻击者可以利用此漏洞访问MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL，Microsoft SQL Server或Azure SQL），攻击者可能能够推断有关数据库结构和内容的信息，并执行SQL语句以更改或删除数据库元素。该漏洞已在野外被利用，Clop勒索软件组织声称对此负责。提供的POC代码是一个CSV文件，包含入侵指标（IOC），如文件路径、HTTP请求、IP地址、域名和SHA256哈希值。这些IOC可以帮助检测和响应针对MOVEit Transfer的攻击。

**有效性评估：** 从搜索结果和漏洞库信息来看，此漏洞的利用是真实且有效的。POC代码提供的IOC列表能够帮助安全分析人员识别潜在的攻击行为。因此，提供的IOC文件本身是有效的，可以作为检测和防御此漏洞攻击的依据。

**投毒风险分析：** 该代码主要是一个包含IOC的CSV文件和一个README文件。其中README文件是一个免责声明。CSV文件中包含了HTTP请求的路径、可疑IP地址，以及可能被利用的ASP.NET文件，以及一些user agent和hash。虽然列出的IP地址可能包含恶意IP，但把IP地址加入IOC列表的行为属于漏洞利用信息的共享，不属于投毒行为。综上，这个仓库本身包含作者隐藏的恶意投毒代码的概率较低，仅存在一些IP地址未来被错误标记的低概率风险。评估风险百分比为5%。

**利用方式分析：** 攻击者利用该漏洞通常通过发送特制的HTTP请求，该请求包含恶意的SQL代码。此SQL代码会被MOVEit Transfer应用解析，并传递给后端的数据库服务器执行。成功利用此漏洞可能允许攻击者：
1.  **数据泄露：** 提取敏感信息，如用户名、密码、用户数据等。
2.  **数据篡改：** 修改数据库中的数据，例如提升权限、篡改文件等。
3.  **远程代码执行：** 在某些数据库配置下，攻击者可能执行操作系统命令，从而完全控制服务器。

从POC代码来看，利用方式主要依赖于构造恶意的HTTP请求，例如`POST /moveitisapi/moveitisapi.dll`，`POST /guestaccess.aspx`， `POST /api/v1/folders/[random]/files`，并通过SQL注入来操纵数据库。

**项目地址:** [deepinstinct/MOVEit_CVE-2023-34362_IOCs](https://github.com/deepinstinct/MOVEit_CVE-2023-34362_IOCs)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #5

**来源**: [CVE-2023-34362-errorfiathck_MOVEit-Exploit.md](../2023/CVE-2023-34362-errorfiathck_MOVEit-Exploit.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未授权访问数据库，信息泄露，甚至远程代码执行。

**影响版本:** < 2021.0.6 (13.0.6), < 2021.1.4 (13.1.4), < 2022.0.4 (14.0.4), < 2022.1.5 (14.1.5), < 2023.0.1 (15.0.1)

**利用条件:** 需要网络访问 MOVEit Transfer Web 应用。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于 MOVEit Transfer Web 应用的 guestaccess.aspx 页面，是一个未经身份验证的 SQL 注入漏洞。攻击者可以通过构造恶意的 SQL 语句注入到 `MyPkgSelfProvisionedRecips` session 变量中，然后触发 `guestaccess.aspx` 的处理逻辑来执行 SQL 语句，从而获取数据库的敏感信息，甚至修改或删除数据库中的数据。POC 代码通过设置特定的 session 变量并发送包含恶意 SQL 语句的请求来利用此漏洞。

**有效性评估：**

*   漏洞库信息和搜索引擎结果表明该漏洞是一个高危且被广泛利用的漏洞。
*   提供的 POC 代码实现了利用该漏洞的步骤，包括获取 CSRF token，设置 session 变量，以及触发 SQL 注入。
*   代码中包含创建 JWT 并获取 access token 的功能，可能用于绕过某些身份验证机制，执行更高级别的操作，例如删除文件。

**投毒风险评估：**

代码主要通过SQL注入利用已知漏洞。`create_jwt`函数依赖`key.pem`和`cert.crt`文件，如果这两个文件本身被替换为恶意文件，可能会导致私钥泄露或权限提升漏洞。代码本身功能比较单一，直接植入后门的可能性较低，投毒的可能性较低。

**利用方式：**

1.  **获取 Session ID:** 向 MOVEit Transfer Web 应用发送请求，获取 `ASP.NET_SessionId` cookie。
2.  **获取 CSRF Token:** 向 `guestaccess.aspx` 发送 POST 请求，获取 CSRF token。
3.  **设置 Session 变量:**  利用 `MOVEitISAPI.dll` 的漏洞，通过设置 `MyPkgSelfProvisionedRecips` session 变量注入恶意 SQL 语句。
4.  **触发 SQL 注入:** 向 `guestaccess.aspx` 发送包含 CSRF token 的 POST 请求，触发 SQL 注入。
5.  **获取 Access Token (可选):** 如果需要执行更高级别的操作，可以使用提供的 JWT 创建功能获取 access token。
6.  **执行恶意操作 (可选):** 使用 access token 执行恶意操作，例如删除文件。

总的来说，这个 POC 的有效性很高，因为它利用了一个已知的、被广泛利用的漏洞。 投毒风险较低，但需要关注 `key.pem`和`cert.crt`文件。

**项目地址:** [errorfiathck/MOVEit-Exploit](https://github.com/errorfiathck/MOVEit-Exploit)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #6

**来源**: [CVE-2023-34362-glen-pearson_MoveIT-CVE-2023-34362-RCE.md](../2023/CVE-2023-34362-glen-pearson_MoveIT-CVE-2023-34362-RCE.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可导致未经身份验证的攻击者访问数据库，远程代码执行。

**影响版本:** 受影响版本包括早于 2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), 和 2023.0.1 (15.0.1) 的版本，以及所有这些版本之前的版本（例如 2020.0 和 2019x）以及较旧的不受支持的版本。

**利用条件:** 需要可以通过HTTP或HTTPS访问MOVEit Transfer的Web应用程序。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-34362 存在于 MOVEit Transfer Web 应用程序中，是一个未经身份验证的 SQL 注入漏洞。攻击者可以利用此漏洞访问 MOVEit Transfer 数据库，并根据使用的数据库引擎（MySQL、Microsoft SQL Server 或 Azure SQL），推断数据库的结构和内容，并执行 SQL 语句来更改或删除数据库元素。根据提供的漏洞利用代码`move.rb`，该漏洞利用脚本首先获取初始会话令牌和InstID，然后创建一个新的sysadmin帐户，利用API访问令牌，找到folderId。该脚本泄露 Org Key 并使用反序列化 Gadget 植入加密的Gadget到数据库中，最后触发 Gadget 反序列化，实现远程代码执行（RCE）。最后，该脚本删除IoC。

**有效性：**

从漏洞库信息、搜索结果和漏洞利用代码来看，该漏洞是真实存在的，并且已经被积极利用。提供的PoC代码通过执行一系列操作，包括创建管理员账户、上传恶意文件（gadget），然后利用反序列化漏洞执行任意代码，验证了漏洞的可利用性。

**投毒风险：**

提供的ruby脚本主要功能是利用漏洞，而不是进行投毒。

*   `move.rb` 脚本看起来是为了利用 MOVEit Transfer 中的 SQL 注入漏洞而设计的，目的是实现远程代码执行。它创建管理员帐户、上传文件、进行反序列化攻击等。这些行为都是直接针对漏洞利用，而不是为了在目标系统上安装恶意后门或进行其他恶意活动。

*   风险评估： 0.1%的可能将漏洞验证过程中写入数据库的后门判定为恶意投毒代码。

**利用方式：**

1.  **SQL 注入：** 攻击者利用 SQL 注入漏洞，在数据库中创建一个新的具有管理员权限的帐户。
2.  **文件上传：** 攻击者上传包含恶意代码的文件（gadget）。
3.  **反序列化：** 攻击者触发反序列化过程，执行上传的恶意代码，从而实现远程代码执行。

总而言之，提供的PoC代码是有效的，并且能够成功利用该漏洞实现远程代码执行。投毒的风险很低。


**项目地址:** [glen-pearson/MoveIT-CVE-2023-34362-RCE](https://github.com/glen-pearson/MoveIT-CVE-2023-34362-RCE)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #7

**来源**: [CVE-2023-34362-horizon3ai_CVE-2023-34362.md](../2023/CVE-2023-34362-horizon3ai_CVE-2023-34362.md)

# CVE-2023-34362

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-34362-Chinyemba-ck_MOVEit-CVE-2023-34362.md](../2023/CVE-2023-34362-Chinyemba-ck_MOVEit-CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未授权访问数据库、数据泄露、修改或删除数据库元素，甚至远程代码执行。

**影响版本:** 受影响版本包括2021.0.6 (13.0.6)之前的所有版本、2021.1.4 (13.1.4)之前的所有版本、2022.0.4 (14.0.4)之前的所有版本、2022.1.5 (14.1.5)之前的所有版本和2023.0.1 (15.0.1)之前的所有版本。包括2020.0和2019x等旧的不受支持的版本。

**利用条件:** 需要通过HTTP或HTTPS网络访问MOVEit Transfer Web应用程序。

**POC 可用性:** 是，但提供的代码仅为分析视频链接，需要自行搜索POC代码。

**投毒风险:** 5%

## 详情

CVE-2023-34362是MOVEit Transfer Web应用程序中发现的一个SQL注入漏洞。未经身份验证的攻击者可以利用此漏洞获得对MOVEit Transfer数据库的访问权限。根据使用的数据库引擎（MySQL、Microsoft SQL Server或Azure SQL），攻击者可能能够推断有关数据库结构和内容的信息，并执行SQL语句来更改或删除数据库元素。该漏洞已被Clop勒索软件团伙利用进行数据窃取。提供的漏洞利用代码只是一个README文件，指向一个分析视频，因此不能直接用于漏洞利用，需要自行搜索并验证可用的POC代码。投毒风险较低，因为提供的代码只包含一个视频链接，并非实际的漏洞利用程序。但如果视频链接指向恶意站点，则存在一定的风险。根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**利用方式：**

1.  **确定目标：** 识别运行MOVEit Transfer且未打补丁的系统。
2.  **SQL注入：** 通过构造恶意的SQL查询，利用未过滤的输入点注入恶意SQL代码。
3.  **信息泄露/数据窃取：** 成功注入SQL代码后，攻击者可以读取数据库中的敏感信息，例如用户名、密码、API密钥和私有数据。
4.  **数据修改/删除：** 攻击者还可以通过SQL注入来修改或删除数据库中的数据，导致服务中断或数据损坏。
5.  **远程代码执行 (可能)：** 在某些数据库配置中，攻击者可能能够通过SQL注入执行操作系统命令，从而获得对服务器的完全控制权。

**项目地址:** [Chinyemba-ck/MOVEit-CVE-2023-34362](https://github.com/Chinyemba-ck/MOVEit-CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #2

**来源**: [CVE-2023-34362-Malwareman007_CVE-2023-34362.md](../2023/CVE-2023-34362-Malwareman007_CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** 受影响版本包括2021.0.6 (13.0.6)之前的版本, 2021.1.4 (13.1.4)之前的版本, 2022.0.4 (14.0.4)之前的版本, 2022.1.5 (14.1.5)之前的版本, 和 2023.0.1 (15.0.1)之前的版本,以及所有早于这五个版本的版本 (例如，2020.0和2019x)

**利用条件:** 需要网络访问，未授权攻击即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34362是MOVEit Transfer中的一个SQL注入漏洞，攻击者可以通过构造恶意的SQL语句，利用guestaccess.aspx页面，从而获取对数据库的未授权访问，甚至执行任意SQL命令。

**漏洞利用有效性:**
根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用的有效性较高。漏洞库信息表明这是一个在野利用的漏洞，搜索引擎结果也证实了这一点，并提到Clop勒索软件团伙利用此漏洞进行攻击。POC代码尝试利用guestaccess.aspx进行SQL注入，通过设置特定的session变量，将SQL语句注入到数据库查询中。

**投毒风险分析:**
POC代码本身看起来是用于利用漏洞的，但存在潜在的投毒风险。create_jwt 函数尝试读取key.pem和cert.crt，如果这两个文件被替换为恶意文件，攻击者有可能通过该POC植入后门。由于需要文件读取，且代码逻辑较为复杂，存在一定被植入恶意代码的风险，风险程度为10%。

**利用方式:**
1.  **获取CSRF Token:** 首先，利用`get_csrf`函数发送POST请求到`guestaccess.aspx`，获取CSRF Token。
2.  **设置Session变量:** 利用`set_session_variables`函数，通过`MOVEitISAPI.dll`设置包含恶意SQL语句的Session变量。该函数通过构造特定的HTTP头，绕过身份验证，将恶意SQL代码传递到后端。
3.  **触发SQL注入:** 调用`do_guest_access`函数，通过发送包含CSRF Token和相关参数的POST请求到`guestaccess.aspx`，触发SQL注入。
4.  **执行SQL语句:** 恶意SQL语句被执行，可能导致数据泄露、篡改或远程代码执行。
5.  **创建JWT(可疑):**create_jwt函数创建jwt，读取证书文件，这可能被用于身份认证绕过或者其他恶意操作，但是否一定存在恶意行为有待进一步分析。

**项目地址:** [Malwareman007/CVE-2023-34362](https://github.com/Malwareman007/CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #3

**来源**: [CVE-2023-34362-Naveenbana5250_CVE-2023-34362-Defense-Package.md](../2023/CVE-2023-34362-Naveenbana5250_CVE-2023-34362-Defense-Package.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，未经身份验证的攻击者可以访问数据库，可能导致信息泄露，修改或删除数据库元素，最终实现远程代码执行。

**影响版本:** 所有版本（例如2020.0和2019x）在五个明确提到的版本之前都受到影响，包括较旧的不受支持的版本。具体受影响版本包括：MOVEit Transfer before 2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), and 2023.0.1 (15.0.1)

**利用条件:** 需要MOVEit Transfer应用程序可通过HTTP或HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34362 是 MOVEit Transfer Web应用程序中发现的 SQL 注入漏洞。未经身份验证的攻击者可以利用此漏洞访问 MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL，Microsoft SQL Server或Azure SQL），攻击者可以推断有关数据库结构和内容的信息，并执行SQL语句来更改或删除数据库元素。漏洞利用通常通过构造恶意的 HTTP POST 请求，目标是 `/moveitisapi.dll?action=m2` 接口，并在 `X-siLock-SessVar` header 中注入 SQL 代码。

**有效性：**
根据漏洞描述和已公开的漏洞利用报告，该漏洞的POC代码有效。大量的实际攻击事件也证实了这一点。

**投毒风险：**
提供的代码仓库主要包含防御规则和IOCs。Suricata规则和Sigma规则用于检测SQL注入攻击和Webshell访问，未发现恶意代码。IOCs列表可以帮助安全分析人员识别受影响的系统。虽然主要目的是防御，但仍然存在一定的投毒风险。例如，Suricata 和 Sigma 规则可能存在误报，导致不必要的警报。此外，IOCs 可能不完整或不准确，导致遗漏真正的攻击。综合考虑，投毒风险较低，大约为10%。

**利用方式：**
1.  **SQL 注入：** 攻击者向 `/moveitisapi.dll?action=m2` 发送带有恶意构造的 `X-siLock-SessVar` header 的 HTTP POST 请求，利用SQL注入漏洞。
2.  **Webshell 部署：** 成功利用SQL注入后，攻击者可以部署Webshell（例如 `human2.aspx`），从而实现远程代码执行。
3.  **数据窃取和持久化：** 攻击者使用Webshell窃取敏感数据，并通过创建后门账户等方式实现持久化访问。

**项目地址:** [Naveenbana5250/CVE-2023-34362-Defense-Package](https://github.com/Naveenbana5250/CVE-2023-34362-Defense-Package)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #4

**来源**: [CVE-2023-34362-deepinstinct_MOVEit_CVE-2023-34362_IOCs.md](../2023/CVE-2023-34362-deepinstinct_MOVEit_CVE-2023-34362_IOCs.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未经授权的数据库访问、信息泄露、数据篡改和远程代码执行

**影响版本:** 所有版本（例如2020.0和2019x）在明确提到的五个版本之前都受影响，包括较旧的不受支持的版本，以及2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), 和 2023.0.1 (15.0.1)

**利用条件:** 未经身份验证的远程攻击，可通过HTTP或HTTPS进行利用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-34362是MOVEit Transfer Web应用程序中发现的SQL注入漏洞。未经身份验证的攻击者可以利用此漏洞访问MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL，Microsoft SQL Server或Azure SQL），攻击者可能能够推断有关数据库结构和内容的信息，并执行SQL语句以更改或删除数据库元素。该漏洞已在野外被利用，Clop勒索软件组织声称对此负责。提供的POC代码是一个CSV文件，包含入侵指标（IOC），如文件路径、HTTP请求、IP地址、域名和SHA256哈希值。这些IOC可以帮助检测和响应针对MOVEit Transfer的攻击。

**有效性评估：** 从搜索结果和漏洞库信息来看，此漏洞的利用是真实且有效的。POC代码提供的IOC列表能够帮助安全分析人员识别潜在的攻击行为。因此，提供的IOC文件本身是有效的，可以作为检测和防御此漏洞攻击的依据。

**投毒风险分析：** 该代码主要是一个包含IOC的CSV文件和一个README文件。其中README文件是一个免责声明。CSV文件中包含了HTTP请求的路径、可疑IP地址，以及可能被利用的ASP.NET文件，以及一些user agent和hash。虽然列出的IP地址可能包含恶意IP，但把IP地址加入IOC列表的行为属于漏洞利用信息的共享，不属于投毒行为。综上，这个仓库本身包含作者隐藏的恶意投毒代码的概率较低，仅存在一些IP地址未来被错误标记的低概率风险。评估风险百分比为5%。

**利用方式分析：** 攻击者利用该漏洞通常通过发送特制的HTTP请求，该请求包含恶意的SQL代码。此SQL代码会被MOVEit Transfer应用解析，并传递给后端的数据库服务器执行。成功利用此漏洞可能允许攻击者：
1.  **数据泄露：** 提取敏感信息，如用户名、密码、用户数据等。
2.  **数据篡改：** 修改数据库中的数据，例如提升权限、篡改文件等。
3.  **远程代码执行：** 在某些数据库配置下，攻击者可能执行操作系统命令，从而完全控制服务器。

从POC代码来看，利用方式主要依赖于构造恶意的HTTP请求，例如`POST /moveitisapi/moveitisapi.dll`，`POST /guestaccess.aspx`， `POST /api/v1/folders/[random]/files`，并通过SQL注入来操纵数据库。

**项目地址:** [deepinstinct/MOVEit_CVE-2023-34362_IOCs](https://github.com/deepinstinct/MOVEit_CVE-2023-34362_IOCs)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #5

**来源**: [CVE-2023-34362-errorfiathck_MOVEit-Exploit.md](../2023/CVE-2023-34362-errorfiathck_MOVEit-Exploit.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未授权访问数据库，信息泄露，甚至远程代码执行。

**影响版本:** < 2021.0.6 (13.0.6), < 2021.1.4 (13.1.4), < 2022.0.4 (14.0.4), < 2022.1.5 (14.1.5), < 2023.0.1 (15.0.1)

**利用条件:** 需要网络访问 MOVEit Transfer Web 应用。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于 MOVEit Transfer Web 应用的 guestaccess.aspx 页面，是一个未经身份验证的 SQL 注入漏洞。攻击者可以通过构造恶意的 SQL 语句注入到 `MyPkgSelfProvisionedRecips` session 变量中，然后触发 `guestaccess.aspx` 的处理逻辑来执行 SQL 语句，从而获取数据库的敏感信息，甚至修改或删除数据库中的数据。POC 代码通过设置特定的 session 变量并发送包含恶意 SQL 语句的请求来利用此漏洞。

**有效性评估：**

*   漏洞库信息和搜索引擎结果表明该漏洞是一个高危且被广泛利用的漏洞。
*   提供的 POC 代码实现了利用该漏洞的步骤，包括获取 CSRF token，设置 session 变量，以及触发 SQL 注入。
*   代码中包含创建 JWT 并获取 access token 的功能，可能用于绕过某些身份验证机制，执行更高级别的操作，例如删除文件。

**投毒风险评估：**

代码主要通过SQL注入利用已知漏洞。`create_jwt`函数依赖`key.pem`和`cert.crt`文件，如果这两个文件本身被替换为恶意文件，可能会导致私钥泄露或权限提升漏洞。代码本身功能比较单一，直接植入后门的可能性较低，投毒的可能性较低。

**利用方式：**

1.  **获取 Session ID:** 向 MOVEit Transfer Web 应用发送请求，获取 `ASP.NET_SessionId` cookie。
2.  **获取 CSRF Token:** 向 `guestaccess.aspx` 发送 POST 请求，获取 CSRF token。
3.  **设置 Session 变量:**  利用 `MOVEitISAPI.dll` 的漏洞，通过设置 `MyPkgSelfProvisionedRecips` session 变量注入恶意 SQL 语句。
4.  **触发 SQL 注入:** 向 `guestaccess.aspx` 发送包含 CSRF token 的 POST 请求，触发 SQL 注入。
5.  **获取 Access Token (可选):** 如果需要执行更高级别的操作，可以使用提供的 JWT 创建功能获取 access token。
6.  **执行恶意操作 (可选):** 使用 access token 执行恶意操作，例如删除文件。

总的来说，这个 POC 的有效性很高，因为它利用了一个已知的、被广泛利用的漏洞。 投毒风险较低，但需要关注 `key.pem`和`cert.crt`文件。

**项目地址:** [errorfiathck/MOVEit-Exploit](https://github.com/errorfiathck/MOVEit-Exploit)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #6

**来源**: [CVE-2023-34362-glen-pearson_MoveIT-CVE-2023-34362-RCE.md](../2023/CVE-2023-34362-glen-pearson_MoveIT-CVE-2023-34362-RCE.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可导致未经身份验证的攻击者访问数据库，远程代码执行。

**影响版本:** 受影响版本包括早于 2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), 和 2023.0.1 (15.0.1) 的版本，以及所有这些版本之前的版本（例如 2020.0 和 2019x）以及较旧的不受支持的版本。

**利用条件:** 需要可以通过HTTP或HTTPS访问MOVEit Transfer的Web应用程序。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-34362 存在于 MOVEit Transfer Web 应用程序中，是一个未经身份验证的 SQL 注入漏洞。攻击者可以利用此漏洞访问 MOVEit Transfer 数据库，并根据使用的数据库引擎（MySQL、Microsoft SQL Server 或 Azure SQL），推断数据库的结构和内容，并执行 SQL 语句来更改或删除数据库元素。根据提供的漏洞利用代码`move.rb`，该漏洞利用脚本首先获取初始会话令牌和InstID，然后创建一个新的sysadmin帐户，利用API访问令牌，找到folderId。该脚本泄露 Org Key 并使用反序列化 Gadget 植入加密的Gadget到数据库中，最后触发 Gadget 反序列化，实现远程代码执行（RCE）。最后，该脚本删除IoC。

**有效性：**

从漏洞库信息、搜索结果和漏洞利用代码来看，该漏洞是真实存在的，并且已经被积极利用。提供的PoC代码通过执行一系列操作，包括创建管理员账户、上传恶意文件（gadget），然后利用反序列化漏洞执行任意代码，验证了漏洞的可利用性。

**投毒风险：**

提供的ruby脚本主要功能是利用漏洞，而不是进行投毒。

*   `move.rb` 脚本看起来是为了利用 MOVEit Transfer 中的 SQL 注入漏洞而设计的，目的是实现远程代码执行。它创建管理员帐户、上传文件、进行反序列化攻击等。这些行为都是直接针对漏洞利用，而不是为了在目标系统上安装恶意后门或进行其他恶意活动。

*   风险评估： 0.1%的可能将漏洞验证过程中写入数据库的后门判定为恶意投毒代码。

**利用方式：**

1.  **SQL 注入：** 攻击者利用 SQL 注入漏洞，在数据库中创建一个新的具有管理员权限的帐户。
2.  **文件上传：** 攻击者上传包含恶意代码的文件（gadget）。
3.  **反序列化：** 攻击者触发反序列化过程，执行上传的恶意代码，从而实现远程代码执行。

总而言之，提供的PoC代码是有效的，并且能够成功利用该漏洞实现远程代码执行。投毒的风险很低。


**项目地址:** [glen-pearson/MoveIT-CVE-2023-34362-RCE](https://github.com/glen-pearson/MoveIT-CVE-2023-34362-RCE)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #7

**来源**: [CVE-2023-34362-horizon3ai_CVE-2023-34362.md](../2023/CVE-2023-34362-horizon3ai_CVE-2023-34362.md)

# CVE-2023-34362

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-34362-Chinyemba-ck_MOVEit-CVE-2023-34362.md](../2023/CVE-2023-34362-Chinyemba-ck_MOVEit-CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未授权访问数据库、数据泄露、修改或删除数据库元素，甚至远程代码执行。

**影响版本:** 受影响版本包括2021.0.6 (13.0.6)之前的所有版本、2021.1.4 (13.1.4)之前的所有版本、2022.0.4 (14.0.4)之前的所有版本、2022.1.5 (14.1.5)之前的所有版本和2023.0.1 (15.0.1)之前的所有版本。包括2020.0和2019x等旧的不受支持的版本。

**利用条件:** 需要通过HTTP或HTTPS网络访问MOVEit Transfer Web应用程序。

**POC 可用性:** 是，但提供的代码仅为分析视频链接，需要自行搜索POC代码。

**投毒风险:** 5%

## 详情

CVE-2023-34362是MOVEit Transfer Web应用程序中发现的一个SQL注入漏洞。未经身份验证的攻击者可以利用此漏洞获得对MOVEit Transfer数据库的访问权限。根据使用的数据库引擎（MySQL、Microsoft SQL Server或Azure SQL），攻击者可能能够推断有关数据库结构和内容的信息，并执行SQL语句来更改或删除数据库元素。该漏洞已被Clop勒索软件团伙利用进行数据窃取。提供的漏洞利用代码只是一个README文件，指向一个分析视频，因此不能直接用于漏洞利用，需要自行搜索并验证可用的POC代码。投毒风险较低，因为提供的代码只包含一个视频链接，并非实际的漏洞利用程序。但如果视频链接指向恶意站点，则存在一定的风险。根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**利用方式：**

1.  **确定目标：** 识别运行MOVEit Transfer且未打补丁的系统。
2.  **SQL注入：** 通过构造恶意的SQL查询，利用未过滤的输入点注入恶意SQL代码。
3.  **信息泄露/数据窃取：** 成功注入SQL代码后，攻击者可以读取数据库中的敏感信息，例如用户名、密码、API密钥和私有数据。
4.  **数据修改/删除：** 攻击者还可以通过SQL注入来修改或删除数据库中的数据，导致服务中断或数据损坏。
5.  **远程代码执行 (可能)：** 在某些数据库配置中，攻击者可能能够通过SQL注入执行操作系统命令，从而获得对服务器的完全控制权。

**项目地址:** [Chinyemba-ck/MOVEit-CVE-2023-34362](https://github.com/Chinyemba-ck/MOVEit-CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #2

**来源**: [CVE-2023-34362-Malwareman007_CVE-2023-34362.md](../2023/CVE-2023-34362-Malwareman007_CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** 受影响版本包括2021.0.6 (13.0.6)之前的版本, 2021.1.4 (13.1.4)之前的版本, 2022.0.4 (14.0.4)之前的版本, 2022.1.5 (14.1.5)之前的版本, 和 2023.0.1 (15.0.1)之前的版本,以及所有早于这五个版本的版本 (例如，2020.0和2019x)

**利用条件:** 需要网络访问，未授权攻击即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34362是MOVEit Transfer中的一个SQL注入漏洞，攻击者可以通过构造恶意的SQL语句，利用guestaccess.aspx页面，从而获取对数据库的未授权访问，甚至执行任意SQL命令。

**漏洞利用有效性:**
根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用的有效性较高。漏洞库信息表明这是一个在野利用的漏洞，搜索引擎结果也证实了这一点，并提到Clop勒索软件团伙利用此漏洞进行攻击。POC代码尝试利用guestaccess.aspx进行SQL注入，通过设置特定的session变量，将SQL语句注入到数据库查询中。

**投毒风险分析:**
POC代码本身看起来是用于利用漏洞的，但存在潜在的投毒风险。create_jwt 函数尝试读取key.pem和cert.crt，如果这两个文件被替换为恶意文件，攻击者有可能通过该POC植入后门。由于需要文件读取，且代码逻辑较为复杂，存在一定被植入恶意代码的风险，风险程度为10%。

**利用方式:**
1.  **获取CSRF Token:** 首先，利用`get_csrf`函数发送POST请求到`guestaccess.aspx`，获取CSRF Token。
2.  **设置Session变量:** 利用`set_session_variables`函数，通过`MOVEitISAPI.dll`设置包含恶意SQL语句的Session变量。该函数通过构造特定的HTTP头，绕过身份验证，将恶意SQL代码传递到后端。
3.  **触发SQL注入:** 调用`do_guest_access`函数，通过发送包含CSRF Token和相关参数的POST请求到`guestaccess.aspx`，触发SQL注入。
4.  **执行SQL语句:** 恶意SQL语句被执行，可能导致数据泄露、篡改或远程代码执行。
5.  **创建JWT(可疑):**create_jwt函数创建jwt，读取证书文件，这可能被用于身份认证绕过或者其他恶意操作，但是否一定存在恶意行为有待进一步分析。

**项目地址:** [Malwareman007/CVE-2023-34362](https://github.com/Malwareman007/CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #3

**来源**: [CVE-2023-34362-Naveenbana5250_CVE-2023-34362-Defense-Package.md](../2023/CVE-2023-34362-Naveenbana5250_CVE-2023-34362-Defense-Package.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，未经身份验证的攻击者可以访问数据库，可能导致信息泄露，修改或删除数据库元素，最终实现远程代码执行。

**影响版本:** 所有版本（例如2020.0和2019x）在五个明确提到的版本之前都受到影响，包括较旧的不受支持的版本。具体受影响版本包括：MOVEit Transfer before 2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), and 2023.0.1 (15.0.1)

**利用条件:** 需要MOVEit Transfer应用程序可通过HTTP或HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34362 是 MOVEit Transfer Web应用程序中发现的 SQL 注入漏洞。未经身份验证的攻击者可以利用此漏洞访问 MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL，Microsoft SQL Server或Azure SQL），攻击者可以推断有关数据库结构和内容的信息，并执行SQL语句来更改或删除数据库元素。漏洞利用通常通过构造恶意的 HTTP POST 请求，目标是 `/moveitisapi.dll?action=m2` 接口，并在 `X-siLock-SessVar` header 中注入 SQL 代码。

**有效性：**
根据漏洞描述和已公开的漏洞利用报告，该漏洞的POC代码有效。大量的实际攻击事件也证实了这一点。

**投毒风险：**
提供的代码仓库主要包含防御规则和IOCs。Suricata规则和Sigma规则用于检测SQL注入攻击和Webshell访问，未发现恶意代码。IOCs列表可以帮助安全分析人员识别受影响的系统。虽然主要目的是防御，但仍然存在一定的投毒风险。例如，Suricata 和 Sigma 规则可能存在误报，导致不必要的警报。此外，IOCs 可能不完整或不准确，导致遗漏真正的攻击。综合考虑，投毒风险较低，大约为10%。

**利用方式：**
1.  **SQL 注入：** 攻击者向 `/moveitisapi.dll?action=m2` 发送带有恶意构造的 `X-siLock-SessVar` header 的 HTTP POST 请求，利用SQL注入漏洞。
2.  **Webshell 部署：** 成功利用SQL注入后，攻击者可以部署Webshell（例如 `human2.aspx`），从而实现远程代码执行。
3.  **数据窃取和持久化：** 攻击者使用Webshell窃取敏感数据，并通过创建后门账户等方式实现持久化访问。

**项目地址:** [Naveenbana5250/CVE-2023-34362-Defense-Package](https://github.com/Naveenbana5250/CVE-2023-34362-Defense-Package)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #4

**来源**: [CVE-2023-34362-deepinstinct_MOVEit_CVE-2023-34362_IOCs.md](../2023/CVE-2023-34362-deepinstinct_MOVEit_CVE-2023-34362_IOCs.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未经授权的数据库访问、信息泄露、数据篡改和远程代码执行

**影响版本:** 所有版本（例如2020.0和2019x）在明确提到的五个版本之前都受影响，包括较旧的不受支持的版本，以及2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), 和 2023.0.1 (15.0.1)

**利用条件:** 未经身份验证的远程攻击，可通过HTTP或HTTPS进行利用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-34362是MOVEit Transfer Web应用程序中发现的SQL注入漏洞。未经身份验证的攻击者可以利用此漏洞访问MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL，Microsoft SQL Server或Azure SQL），攻击者可能能够推断有关数据库结构和内容的信息，并执行SQL语句以更改或删除数据库元素。该漏洞已在野外被利用，Clop勒索软件组织声称对此负责。提供的POC代码是一个CSV文件，包含入侵指标（IOC），如文件路径、HTTP请求、IP地址、域名和SHA256哈希值。这些IOC可以帮助检测和响应针对MOVEit Transfer的攻击。

**有效性评估：** 从搜索结果和漏洞库信息来看，此漏洞的利用是真实且有效的。POC代码提供的IOC列表能够帮助安全分析人员识别潜在的攻击行为。因此，提供的IOC文件本身是有效的，可以作为检测和防御此漏洞攻击的依据。

**投毒风险分析：** 该代码主要是一个包含IOC的CSV文件和一个README文件。其中README文件是一个免责声明。CSV文件中包含了HTTP请求的路径、可疑IP地址，以及可能被利用的ASP.NET文件，以及一些user agent和hash。虽然列出的IP地址可能包含恶意IP，但把IP地址加入IOC列表的行为属于漏洞利用信息的共享，不属于投毒行为。综上，这个仓库本身包含作者隐藏的恶意投毒代码的概率较低，仅存在一些IP地址未来被错误标记的低概率风险。评估风险百分比为5%。

**利用方式分析：** 攻击者利用该漏洞通常通过发送特制的HTTP请求，该请求包含恶意的SQL代码。此SQL代码会被MOVEit Transfer应用解析，并传递给后端的数据库服务器执行。成功利用此漏洞可能允许攻击者：
1.  **数据泄露：** 提取敏感信息，如用户名、密码、用户数据等。
2.  **数据篡改：** 修改数据库中的数据，例如提升权限、篡改文件等。
3.  **远程代码执行：** 在某些数据库配置下，攻击者可能执行操作系统命令，从而完全控制服务器。

从POC代码来看，利用方式主要依赖于构造恶意的HTTP请求，例如`POST /moveitisapi/moveitisapi.dll`，`POST /guestaccess.aspx`， `POST /api/v1/folders/[random]/files`，并通过SQL注入来操纵数据库。

**项目地址:** [deepinstinct/MOVEit_CVE-2023-34362_IOCs](https://github.com/deepinstinct/MOVEit_CVE-2023-34362_IOCs)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #5

**来源**: [CVE-2023-34362-errorfiathck_MOVEit-Exploit.md](../2023/CVE-2023-34362-errorfiathck_MOVEit-Exploit.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未授权访问数据库，信息泄露，甚至远程代码执行。

**影响版本:** < 2021.0.6 (13.0.6), < 2021.1.4 (13.1.4), < 2022.0.4 (14.0.4), < 2022.1.5 (14.1.5), < 2023.0.1 (15.0.1)

**利用条件:** 需要网络访问 MOVEit Transfer Web 应用。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于 MOVEit Transfer Web 应用的 guestaccess.aspx 页面，是一个未经身份验证的 SQL 注入漏洞。攻击者可以通过构造恶意的 SQL 语句注入到 `MyPkgSelfProvisionedRecips` session 变量中，然后触发 `guestaccess.aspx` 的处理逻辑来执行 SQL 语句，从而获取数据库的敏感信息，甚至修改或删除数据库中的数据。POC 代码通过设置特定的 session 变量并发送包含恶意 SQL 语句的请求来利用此漏洞。

**有效性评估：**

*   漏洞库信息和搜索引擎结果表明该漏洞是一个高危且被广泛利用的漏洞。
*   提供的 POC 代码实现了利用该漏洞的步骤，包括获取 CSRF token，设置 session 变量，以及触发 SQL 注入。
*   代码中包含创建 JWT 并获取 access token 的功能，可能用于绕过某些身份验证机制，执行更高级别的操作，例如删除文件。

**投毒风险评估：**

代码主要通过SQL注入利用已知漏洞。`create_jwt`函数依赖`key.pem`和`cert.crt`文件，如果这两个文件本身被替换为恶意文件，可能会导致私钥泄露或权限提升漏洞。代码本身功能比较单一，直接植入后门的可能性较低，投毒的可能性较低。

**利用方式：**

1.  **获取 Session ID:** 向 MOVEit Transfer Web 应用发送请求，获取 `ASP.NET_SessionId` cookie。
2.  **获取 CSRF Token:** 向 `guestaccess.aspx` 发送 POST 请求，获取 CSRF token。
3.  **设置 Session 变量:**  利用 `MOVEitISAPI.dll` 的漏洞，通过设置 `MyPkgSelfProvisionedRecips` session 变量注入恶意 SQL 语句。
4.  **触发 SQL 注入:** 向 `guestaccess.aspx` 发送包含 CSRF token 的 POST 请求，触发 SQL 注入。
5.  **获取 Access Token (可选):** 如果需要执行更高级别的操作，可以使用提供的 JWT 创建功能获取 access token。
6.  **执行恶意操作 (可选):** 使用 access token 执行恶意操作，例如删除文件。

总的来说，这个 POC 的有效性很高，因为它利用了一个已知的、被广泛利用的漏洞。 投毒风险较低，但需要关注 `key.pem`和`cert.crt`文件。

**项目地址:** [errorfiathck/MOVEit-Exploit](https://github.com/errorfiathck/MOVEit-Exploit)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #6

**来源**: [CVE-2023-34362-glen-pearson_MoveIT-CVE-2023-34362-RCE.md](../2023/CVE-2023-34362-glen-pearson_MoveIT-CVE-2023-34362-RCE.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可导致未经身份验证的攻击者访问数据库，远程代码执行。

**影响版本:** 受影响版本包括早于 2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), 和 2023.0.1 (15.0.1) 的版本，以及所有这些版本之前的版本（例如 2020.0 和 2019x）以及较旧的不受支持的版本。

**利用条件:** 需要可以通过HTTP或HTTPS访问MOVEit Transfer的Web应用程序。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-34362 存在于 MOVEit Transfer Web 应用程序中，是一个未经身份验证的 SQL 注入漏洞。攻击者可以利用此漏洞访问 MOVEit Transfer 数据库，并根据使用的数据库引擎（MySQL、Microsoft SQL Server 或 Azure SQL），推断数据库的结构和内容，并执行 SQL 语句来更改或删除数据库元素。根据提供的漏洞利用代码`move.rb`，该漏洞利用脚本首先获取初始会话令牌和InstID，然后创建一个新的sysadmin帐户，利用API访问令牌，找到folderId。该脚本泄露 Org Key 并使用反序列化 Gadget 植入加密的Gadget到数据库中，最后触发 Gadget 反序列化，实现远程代码执行（RCE）。最后，该脚本删除IoC。

**有效性：**

从漏洞库信息、搜索结果和漏洞利用代码来看，该漏洞是真实存在的，并且已经被积极利用。提供的PoC代码通过执行一系列操作，包括创建管理员账户、上传恶意文件（gadget），然后利用反序列化漏洞执行任意代码，验证了漏洞的可利用性。

**投毒风险：**

提供的ruby脚本主要功能是利用漏洞，而不是进行投毒。

*   `move.rb` 脚本看起来是为了利用 MOVEit Transfer 中的 SQL 注入漏洞而设计的，目的是实现远程代码执行。它创建管理员帐户、上传文件、进行反序列化攻击等。这些行为都是直接针对漏洞利用，而不是为了在目标系统上安装恶意后门或进行其他恶意活动。

*   风险评估： 0.1%的可能将漏洞验证过程中写入数据库的后门判定为恶意投毒代码。

**利用方式：**

1.  **SQL 注入：** 攻击者利用 SQL 注入漏洞，在数据库中创建一个新的具有管理员权限的帐户。
2.  **文件上传：** 攻击者上传包含恶意代码的文件（gadget）。
3.  **反序列化：** 攻击者触发反序列化过程，执行上传的恶意代码，从而实现远程代码执行。

总而言之，提供的PoC代码是有效的，并且能够成功利用该漏洞实现远程代码执行。投毒的风险很低。


**项目地址:** [glen-pearson/MoveIT-CVE-2023-34362-RCE](https://github.com/glen-pearson/MoveIT-CVE-2023-34362-RCE)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #7

**来源**: [CVE-2023-34362-horizon3ai_CVE-2023-34362.md](../2023/CVE-2023-34362-horizon3ai_CVE-2023-34362.md)

# CVE-2023-34362

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-34362-Chinyemba-ck_MOVEit-CVE-2023-34362.md](../2023/CVE-2023-34362-Chinyemba-ck_MOVEit-CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未授权访问数据库、数据泄露、修改或删除数据库元素，甚至远程代码执行。

**影响版本:** 受影响版本包括2021.0.6 (13.0.6)之前的所有版本、2021.1.4 (13.1.4)之前的所有版本、2022.0.4 (14.0.4)之前的所有版本、2022.1.5 (14.1.5)之前的所有版本和2023.0.1 (15.0.1)之前的所有版本。包括2020.0和2019x等旧的不受支持的版本。

**利用条件:** 需要通过HTTP或HTTPS网络访问MOVEit Transfer Web应用程序。

**POC 可用性:** 是，但提供的代码仅为分析视频链接，需要自行搜索POC代码。

**投毒风险:** 5%

## 详情

CVE-2023-34362是MOVEit Transfer Web应用程序中发现的一个SQL注入漏洞。未经身份验证的攻击者可以利用此漏洞获得对MOVEit Transfer数据库的访问权限。根据使用的数据库引擎（MySQL、Microsoft SQL Server或Azure SQL），攻击者可能能够推断有关数据库结构和内容的信息，并执行SQL语句来更改或删除数据库元素。该漏洞已被Clop勒索软件团伙利用进行数据窃取。提供的漏洞利用代码只是一个README文件，指向一个分析视频，因此不能直接用于漏洞利用，需要自行搜索并验证可用的POC代码。投毒风险较低，因为提供的代码只包含一个视频链接，并非实际的漏洞利用程序。但如果视频链接指向恶意站点，则存在一定的风险。根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**利用方式：**

1.  **确定目标：** 识别运行MOVEit Transfer且未打补丁的系统。
2.  **SQL注入：** 通过构造恶意的SQL查询，利用未过滤的输入点注入恶意SQL代码。
3.  **信息泄露/数据窃取：** 成功注入SQL代码后，攻击者可以读取数据库中的敏感信息，例如用户名、密码、API密钥和私有数据。
4.  **数据修改/删除：** 攻击者还可以通过SQL注入来修改或删除数据库中的数据，导致服务中断或数据损坏。
5.  **远程代码执行 (可能)：** 在某些数据库配置中，攻击者可能能够通过SQL注入执行操作系统命令，从而获得对服务器的完全控制权。

**项目地址:** [Chinyemba-ck/MOVEit-CVE-2023-34362](https://github.com/Chinyemba-ck/MOVEit-CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #2

**来源**: [CVE-2023-34362-Malwareman007_CVE-2023-34362.md](../2023/CVE-2023-34362-Malwareman007_CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** 受影响版本包括2021.0.6 (13.0.6)之前的版本, 2021.1.4 (13.1.4)之前的版本, 2022.0.4 (14.0.4)之前的版本, 2022.1.5 (14.1.5)之前的版本, 和 2023.0.1 (15.0.1)之前的版本,以及所有早于这五个版本的版本 (例如，2020.0和2019x)

**利用条件:** 需要网络访问，未授权攻击即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34362是MOVEit Transfer中的一个SQL注入漏洞，攻击者可以通过构造恶意的SQL语句，利用guestaccess.aspx页面，从而获取对数据库的未授权访问，甚至执行任意SQL命令。

**漏洞利用有效性:**
根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用的有效性较高。漏洞库信息表明这是一个在野利用的漏洞，搜索引擎结果也证实了这一点，并提到Clop勒索软件团伙利用此漏洞进行攻击。POC代码尝试利用guestaccess.aspx进行SQL注入，通过设置特定的session变量，将SQL语句注入到数据库查询中。

**投毒风险分析:**
POC代码本身看起来是用于利用漏洞的，但存在潜在的投毒风险。create_jwt 函数尝试读取key.pem和cert.crt，如果这两个文件被替换为恶意文件，攻击者有可能通过该POC植入后门。由于需要文件读取，且代码逻辑较为复杂，存在一定被植入恶意代码的风险，风险程度为10%。

**利用方式:**
1.  **获取CSRF Token:** 首先，利用`get_csrf`函数发送POST请求到`guestaccess.aspx`，获取CSRF Token。
2.  **设置Session变量:** 利用`set_session_variables`函数，通过`MOVEitISAPI.dll`设置包含恶意SQL语句的Session变量。该函数通过构造特定的HTTP头，绕过身份验证，将恶意SQL代码传递到后端。
3.  **触发SQL注入:** 调用`do_guest_access`函数，通过发送包含CSRF Token和相关参数的POST请求到`guestaccess.aspx`，触发SQL注入。
4.  **执行SQL语句:** 恶意SQL语句被执行，可能导致数据泄露、篡改或远程代码执行。
5.  **创建JWT(可疑):**create_jwt函数创建jwt，读取证书文件，这可能被用于身份认证绕过或者其他恶意操作，但是否一定存在恶意行为有待进一步分析。

**项目地址:** [Malwareman007/CVE-2023-34362](https://github.com/Malwareman007/CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #3

**来源**: [CVE-2023-34362-Naveenbana5250_CVE-2023-34362-Defense-Package.md](../2023/CVE-2023-34362-Naveenbana5250_CVE-2023-34362-Defense-Package.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，未经身份验证的攻击者可以访问数据库，可能导致信息泄露，修改或删除数据库元素，最终实现远程代码执行。

**影响版本:** 所有版本（例如2020.0和2019x）在五个明确提到的版本之前都受到影响，包括较旧的不受支持的版本。具体受影响版本包括：MOVEit Transfer before 2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), and 2023.0.1 (15.0.1)

**利用条件:** 需要MOVEit Transfer应用程序可通过HTTP或HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34362 是 MOVEit Transfer Web应用程序中发现的 SQL 注入漏洞。未经身份验证的攻击者可以利用此漏洞访问 MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL，Microsoft SQL Server或Azure SQL），攻击者可以推断有关数据库结构和内容的信息，并执行SQL语句来更改或删除数据库元素。漏洞利用通常通过构造恶意的 HTTP POST 请求，目标是 `/moveitisapi.dll?action=m2` 接口，并在 `X-siLock-SessVar` header 中注入 SQL 代码。

**有效性：**
根据漏洞描述和已公开的漏洞利用报告，该漏洞的POC代码有效。大量的实际攻击事件也证实了这一点。

**投毒风险：**
提供的代码仓库主要包含防御规则和IOCs。Suricata规则和Sigma规则用于检测SQL注入攻击和Webshell访问，未发现恶意代码。IOCs列表可以帮助安全分析人员识别受影响的系统。虽然主要目的是防御，但仍然存在一定的投毒风险。例如，Suricata 和 Sigma 规则可能存在误报，导致不必要的警报。此外，IOCs 可能不完整或不准确，导致遗漏真正的攻击。综合考虑，投毒风险较低，大约为10%。

**利用方式：**
1.  **SQL 注入：** 攻击者向 `/moveitisapi.dll?action=m2` 发送带有恶意构造的 `X-siLock-SessVar` header 的 HTTP POST 请求，利用SQL注入漏洞。
2.  **Webshell 部署：** 成功利用SQL注入后，攻击者可以部署Webshell（例如 `human2.aspx`），从而实现远程代码执行。
3.  **数据窃取和持久化：** 攻击者使用Webshell窃取敏感数据，并通过创建后门账户等方式实现持久化访问。

**项目地址:** [Naveenbana5250/CVE-2023-34362-Defense-Package](https://github.com/Naveenbana5250/CVE-2023-34362-Defense-Package)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #4

**来源**: [CVE-2023-34362-deepinstinct_MOVEit_CVE-2023-34362_IOCs.md](../2023/CVE-2023-34362-deepinstinct_MOVEit_CVE-2023-34362_IOCs.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未经授权的数据库访问、信息泄露、数据篡改和远程代码执行

**影响版本:** 所有版本（例如2020.0和2019x）在明确提到的五个版本之前都受影响，包括较旧的不受支持的版本，以及2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), 和 2023.0.1 (15.0.1)

**利用条件:** 未经身份验证的远程攻击，可通过HTTP或HTTPS进行利用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-34362是MOVEit Transfer Web应用程序中发现的SQL注入漏洞。未经身份验证的攻击者可以利用此漏洞访问MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL，Microsoft SQL Server或Azure SQL），攻击者可能能够推断有关数据库结构和内容的信息，并执行SQL语句以更改或删除数据库元素。该漏洞已在野外被利用，Clop勒索软件组织声称对此负责。提供的POC代码是一个CSV文件，包含入侵指标（IOC），如文件路径、HTTP请求、IP地址、域名和SHA256哈希值。这些IOC可以帮助检测和响应针对MOVEit Transfer的攻击。

**有效性评估：** 从搜索结果和漏洞库信息来看，此漏洞的利用是真实且有效的。POC代码提供的IOC列表能够帮助安全分析人员识别潜在的攻击行为。因此，提供的IOC文件本身是有效的，可以作为检测和防御此漏洞攻击的依据。

**投毒风险分析：** 该代码主要是一个包含IOC的CSV文件和一个README文件。其中README文件是一个免责声明。CSV文件中包含了HTTP请求的路径、可疑IP地址，以及可能被利用的ASP.NET文件，以及一些user agent和hash。虽然列出的IP地址可能包含恶意IP，但把IP地址加入IOC列表的行为属于漏洞利用信息的共享，不属于投毒行为。综上，这个仓库本身包含作者隐藏的恶意投毒代码的概率较低，仅存在一些IP地址未来被错误标记的低概率风险。评估风险百分比为5%。

**利用方式分析：** 攻击者利用该漏洞通常通过发送特制的HTTP请求，该请求包含恶意的SQL代码。此SQL代码会被MOVEit Transfer应用解析，并传递给后端的数据库服务器执行。成功利用此漏洞可能允许攻击者：
1.  **数据泄露：** 提取敏感信息，如用户名、密码、用户数据等。
2.  **数据篡改：** 修改数据库中的数据，例如提升权限、篡改文件等。
3.  **远程代码执行：** 在某些数据库配置下，攻击者可能执行操作系统命令，从而完全控制服务器。

从POC代码来看，利用方式主要依赖于构造恶意的HTTP请求，例如`POST /moveitisapi/moveitisapi.dll`，`POST /guestaccess.aspx`， `POST /api/v1/folders/[random]/files`，并通过SQL注入来操纵数据库。

**项目地址:** [deepinstinct/MOVEit_CVE-2023-34362_IOCs](https://github.com/deepinstinct/MOVEit_CVE-2023-34362_IOCs)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #5

**来源**: [CVE-2023-34362-errorfiathck_MOVEit-Exploit.md](../2023/CVE-2023-34362-errorfiathck_MOVEit-Exploit.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未授权访问数据库，信息泄露，甚至远程代码执行。

**影响版本:** < 2021.0.6 (13.0.6), < 2021.1.4 (13.1.4), < 2022.0.4 (14.0.4), < 2022.1.5 (14.1.5), < 2023.0.1 (15.0.1)

**利用条件:** 需要网络访问 MOVEit Transfer Web 应用。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于 MOVEit Transfer Web 应用的 guestaccess.aspx 页面，是一个未经身份验证的 SQL 注入漏洞。攻击者可以通过构造恶意的 SQL 语句注入到 `MyPkgSelfProvisionedRecips` session 变量中，然后触发 `guestaccess.aspx` 的处理逻辑来执行 SQL 语句，从而获取数据库的敏感信息，甚至修改或删除数据库中的数据。POC 代码通过设置特定的 session 变量并发送包含恶意 SQL 语句的请求来利用此漏洞。

**有效性评估：**

*   漏洞库信息和搜索引擎结果表明该漏洞是一个高危且被广泛利用的漏洞。
*   提供的 POC 代码实现了利用该漏洞的步骤，包括获取 CSRF token，设置 session 变量，以及触发 SQL 注入。
*   代码中包含创建 JWT 并获取 access token 的功能，可能用于绕过某些身份验证机制，执行更高级别的操作，例如删除文件。

**投毒风险评估：**

代码主要通过SQL注入利用已知漏洞。`create_jwt`函数依赖`key.pem`和`cert.crt`文件，如果这两个文件本身被替换为恶意文件，可能会导致私钥泄露或权限提升漏洞。代码本身功能比较单一，直接植入后门的可能性较低，投毒的可能性较低。

**利用方式：**

1.  **获取 Session ID:** 向 MOVEit Transfer Web 应用发送请求，获取 `ASP.NET_SessionId` cookie。
2.  **获取 CSRF Token:** 向 `guestaccess.aspx` 发送 POST 请求，获取 CSRF token。
3.  **设置 Session 变量:**  利用 `MOVEitISAPI.dll` 的漏洞，通过设置 `MyPkgSelfProvisionedRecips` session 变量注入恶意 SQL 语句。
4.  **触发 SQL 注入:** 向 `guestaccess.aspx` 发送包含 CSRF token 的 POST 请求，触发 SQL 注入。
5.  **获取 Access Token (可选):** 如果需要执行更高级别的操作，可以使用提供的 JWT 创建功能获取 access token。
6.  **执行恶意操作 (可选):** 使用 access token 执行恶意操作，例如删除文件。

总的来说，这个 POC 的有效性很高，因为它利用了一个已知的、被广泛利用的漏洞。 投毒风险较低，但需要关注 `key.pem`和`cert.crt`文件。

**项目地址:** [errorfiathck/MOVEit-Exploit](https://github.com/errorfiathck/MOVEit-Exploit)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #6

**来源**: [CVE-2023-34362-glen-pearson_MoveIT-CVE-2023-34362-RCE.md](../2023/CVE-2023-34362-glen-pearson_MoveIT-CVE-2023-34362-RCE.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可导致未经身份验证的攻击者访问数据库，远程代码执行。

**影响版本:** 受影响版本包括早于 2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), 和 2023.0.1 (15.0.1) 的版本，以及所有这些版本之前的版本（例如 2020.0 和 2019x）以及较旧的不受支持的版本。

**利用条件:** 需要可以通过HTTP或HTTPS访问MOVEit Transfer的Web应用程序。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-34362 存在于 MOVEit Transfer Web 应用程序中，是一个未经身份验证的 SQL 注入漏洞。攻击者可以利用此漏洞访问 MOVEit Transfer 数据库，并根据使用的数据库引擎（MySQL、Microsoft SQL Server 或 Azure SQL），推断数据库的结构和内容，并执行 SQL 语句来更改或删除数据库元素。根据提供的漏洞利用代码`move.rb`，该漏洞利用脚本首先获取初始会话令牌和InstID，然后创建一个新的sysadmin帐户，利用API访问令牌，找到folderId。该脚本泄露 Org Key 并使用反序列化 Gadget 植入加密的Gadget到数据库中，最后触发 Gadget 反序列化，实现远程代码执行（RCE）。最后，该脚本删除IoC。

**有效性：**

从漏洞库信息、搜索结果和漏洞利用代码来看，该漏洞是真实存在的，并且已经被积极利用。提供的PoC代码通过执行一系列操作，包括创建管理员账户、上传恶意文件（gadget），然后利用反序列化漏洞执行任意代码，验证了漏洞的可利用性。

**投毒风险：**

提供的ruby脚本主要功能是利用漏洞，而不是进行投毒。

*   `move.rb` 脚本看起来是为了利用 MOVEit Transfer 中的 SQL 注入漏洞而设计的，目的是实现远程代码执行。它创建管理员帐户、上传文件、进行反序列化攻击等。这些行为都是直接针对漏洞利用，而不是为了在目标系统上安装恶意后门或进行其他恶意活动。

*   风险评估： 0.1%的可能将漏洞验证过程中写入数据库的后门判定为恶意投毒代码。

**利用方式：**

1.  **SQL 注入：** 攻击者利用 SQL 注入漏洞，在数据库中创建一个新的具有管理员权限的帐户。
2.  **文件上传：** 攻击者上传包含恶意代码的文件（gadget）。
3.  **反序列化：** 攻击者触发反序列化过程，执行上传的恶意代码，从而实现远程代码执行。

总而言之，提供的PoC代码是有效的，并且能够成功利用该漏洞实现远程代码执行。投毒的风险很低。


**项目地址:** [glen-pearson/MoveIT-CVE-2023-34362-RCE](https://github.com/glen-pearson/MoveIT-CVE-2023-34362-RCE)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #7

**来源**: [CVE-2023-34362-horizon3ai_CVE-2023-34362.md](../2023/CVE-2023-34362-horizon3ai_CVE-2023-34362.md)

# CVE-2023-34362

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-34362-Chinyemba-ck_MOVEit-CVE-2023-34362.md](../2023/CVE-2023-34362-Chinyemba-ck_MOVEit-CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未授权访问数据库、数据泄露、修改或删除数据库元素，甚至远程代码执行。

**影响版本:** 受影响版本包括2021.0.6 (13.0.6)之前的所有版本、2021.1.4 (13.1.4)之前的所有版本、2022.0.4 (14.0.4)之前的所有版本、2022.1.5 (14.1.5)之前的所有版本和2023.0.1 (15.0.1)之前的所有版本。包括2020.0和2019x等旧的不受支持的版本。

**利用条件:** 需要通过HTTP或HTTPS网络访问MOVEit Transfer Web应用程序。

**POC 可用性:** 是，但提供的代码仅为分析视频链接，需要自行搜索POC代码。

**投毒风险:** 5%

## 详情

CVE-2023-34362是MOVEit Transfer Web应用程序中发现的一个SQL注入漏洞。未经身份验证的攻击者可以利用此漏洞获得对MOVEit Transfer数据库的访问权限。根据使用的数据库引擎（MySQL、Microsoft SQL Server或Azure SQL），攻击者可能能够推断有关数据库结构和内容的信息，并执行SQL语句来更改或删除数据库元素。该漏洞已被Clop勒索软件团伙利用进行数据窃取。提供的漏洞利用代码只是一个README文件，指向一个分析视频，因此不能直接用于漏洞利用，需要自行搜索并验证可用的POC代码。投毒风险较低，因为提供的代码只包含一个视频链接，并非实际的漏洞利用程序。但如果视频链接指向恶意站点，则存在一定的风险。根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**利用方式：**

1.  **确定目标：** 识别运行MOVEit Transfer且未打补丁的系统。
2.  **SQL注入：** 通过构造恶意的SQL查询，利用未过滤的输入点注入恶意SQL代码。
3.  **信息泄露/数据窃取：** 成功注入SQL代码后，攻击者可以读取数据库中的敏感信息，例如用户名、密码、API密钥和私有数据。
4.  **数据修改/删除：** 攻击者还可以通过SQL注入来修改或删除数据库中的数据，导致服务中断或数据损坏。
5.  **远程代码执行 (可能)：** 在某些数据库配置中，攻击者可能能够通过SQL注入执行操作系统命令，从而获得对服务器的完全控制权。

**项目地址:** [Chinyemba-ck/MOVEit-CVE-2023-34362](https://github.com/Chinyemba-ck/MOVEit-CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #2

**来源**: [CVE-2023-34362-Malwareman007_CVE-2023-34362.md](../2023/CVE-2023-34362-Malwareman007_CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** 受影响版本包括2021.0.6 (13.0.6)之前的版本, 2021.1.4 (13.1.4)之前的版本, 2022.0.4 (14.0.4)之前的版本, 2022.1.5 (14.1.5)之前的版本, 和 2023.0.1 (15.0.1)之前的版本,以及所有早于这五个版本的版本 (例如，2020.0和2019x)

**利用条件:** 需要网络访问，未授权攻击即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34362是MOVEit Transfer中的一个SQL注入漏洞，攻击者可以通过构造恶意的SQL语句，利用guestaccess.aspx页面，从而获取对数据库的未授权访问，甚至执行任意SQL命令。

**漏洞利用有效性:**
根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用的有效性较高。漏洞库信息表明这是一个在野利用的漏洞，搜索引擎结果也证实了这一点，并提到Clop勒索软件团伙利用此漏洞进行攻击。POC代码尝试利用guestaccess.aspx进行SQL注入，通过设置特定的session变量，将SQL语句注入到数据库查询中。

**投毒风险分析:**
POC代码本身看起来是用于利用漏洞的，但存在潜在的投毒风险。create_jwt 函数尝试读取key.pem和cert.crt，如果这两个文件被替换为恶意文件，攻击者有可能通过该POC植入后门。由于需要文件读取，且代码逻辑较为复杂，存在一定被植入恶意代码的风险，风险程度为10%。

**利用方式:**
1.  **获取CSRF Token:** 首先，利用`get_csrf`函数发送POST请求到`guestaccess.aspx`，获取CSRF Token。
2.  **设置Session变量:** 利用`set_session_variables`函数，通过`MOVEitISAPI.dll`设置包含恶意SQL语句的Session变量。该函数通过构造特定的HTTP头，绕过身份验证，将恶意SQL代码传递到后端。
3.  **触发SQL注入:** 调用`do_guest_access`函数，通过发送包含CSRF Token和相关参数的POST请求到`guestaccess.aspx`，触发SQL注入。
4.  **执行SQL语句:** 恶意SQL语句被执行，可能导致数据泄露、篡改或远程代码执行。
5.  **创建JWT(可疑):**create_jwt函数创建jwt，读取证书文件，这可能被用于身份认证绕过或者其他恶意操作，但是否一定存在恶意行为有待进一步分析。

**项目地址:** [Malwareman007/CVE-2023-34362](https://github.com/Malwareman007/CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #3

**来源**: [CVE-2023-34362-Naveenbana5250_CVE-2023-34362-Defense-Package.md](../2023/CVE-2023-34362-Naveenbana5250_CVE-2023-34362-Defense-Package.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，未经身份验证的攻击者可以访问数据库，可能导致信息泄露，修改或删除数据库元素，最终实现远程代码执行。

**影响版本:** 所有版本（例如2020.0和2019x）在五个明确提到的版本之前都受到影响，包括较旧的不受支持的版本。具体受影响版本包括：MOVEit Transfer before 2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), and 2023.0.1 (15.0.1)

**利用条件:** 需要MOVEit Transfer应用程序可通过HTTP或HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34362 是 MOVEit Transfer Web应用程序中发现的 SQL 注入漏洞。未经身份验证的攻击者可以利用此漏洞访问 MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL，Microsoft SQL Server或Azure SQL），攻击者可以推断有关数据库结构和内容的信息，并执行SQL语句来更改或删除数据库元素。漏洞利用通常通过构造恶意的 HTTP POST 请求，目标是 `/moveitisapi.dll?action=m2` 接口，并在 `X-siLock-SessVar` header 中注入 SQL 代码。

**有效性：**
根据漏洞描述和已公开的漏洞利用报告，该漏洞的POC代码有效。大量的实际攻击事件也证实了这一点。

**投毒风险：**
提供的代码仓库主要包含防御规则和IOCs。Suricata规则和Sigma规则用于检测SQL注入攻击和Webshell访问，未发现恶意代码。IOCs列表可以帮助安全分析人员识别受影响的系统。虽然主要目的是防御，但仍然存在一定的投毒风险。例如，Suricata 和 Sigma 规则可能存在误报，导致不必要的警报。此外，IOCs 可能不完整或不准确，导致遗漏真正的攻击。综合考虑，投毒风险较低，大约为10%。

**利用方式：**
1.  **SQL 注入：** 攻击者向 `/moveitisapi.dll?action=m2` 发送带有恶意构造的 `X-siLock-SessVar` header 的 HTTP POST 请求，利用SQL注入漏洞。
2.  **Webshell 部署：** 成功利用SQL注入后，攻击者可以部署Webshell（例如 `human2.aspx`），从而实现远程代码执行。
3.  **数据窃取和持久化：** 攻击者使用Webshell窃取敏感数据，并通过创建后门账户等方式实现持久化访问。

**项目地址:** [Naveenbana5250/CVE-2023-34362-Defense-Package](https://github.com/Naveenbana5250/CVE-2023-34362-Defense-Package)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #4

**来源**: [CVE-2023-34362-deepinstinct_MOVEit_CVE-2023-34362_IOCs.md](../2023/CVE-2023-34362-deepinstinct_MOVEit_CVE-2023-34362_IOCs.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未经授权的数据库访问、信息泄露、数据篡改和远程代码执行

**影响版本:** 所有版本（例如2020.0和2019x）在明确提到的五个版本之前都受影响，包括较旧的不受支持的版本，以及2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), 和 2023.0.1 (15.0.1)

**利用条件:** 未经身份验证的远程攻击，可通过HTTP或HTTPS进行利用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-34362是MOVEit Transfer Web应用程序中发现的SQL注入漏洞。未经身份验证的攻击者可以利用此漏洞访问MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL，Microsoft SQL Server或Azure SQL），攻击者可能能够推断有关数据库结构和内容的信息，并执行SQL语句以更改或删除数据库元素。该漏洞已在野外被利用，Clop勒索软件组织声称对此负责。提供的POC代码是一个CSV文件，包含入侵指标（IOC），如文件路径、HTTP请求、IP地址、域名和SHA256哈希值。这些IOC可以帮助检测和响应针对MOVEit Transfer的攻击。

**有效性评估：** 从搜索结果和漏洞库信息来看，此漏洞的利用是真实且有效的。POC代码提供的IOC列表能够帮助安全分析人员识别潜在的攻击行为。因此，提供的IOC文件本身是有效的，可以作为检测和防御此漏洞攻击的依据。

**投毒风险分析：** 该代码主要是一个包含IOC的CSV文件和一个README文件。其中README文件是一个免责声明。CSV文件中包含了HTTP请求的路径、可疑IP地址，以及可能被利用的ASP.NET文件，以及一些user agent和hash。虽然列出的IP地址可能包含恶意IP，但把IP地址加入IOC列表的行为属于漏洞利用信息的共享，不属于投毒行为。综上，这个仓库本身包含作者隐藏的恶意投毒代码的概率较低，仅存在一些IP地址未来被错误标记的低概率风险。评估风险百分比为5%。

**利用方式分析：** 攻击者利用该漏洞通常通过发送特制的HTTP请求，该请求包含恶意的SQL代码。此SQL代码会被MOVEit Transfer应用解析，并传递给后端的数据库服务器执行。成功利用此漏洞可能允许攻击者：
1.  **数据泄露：** 提取敏感信息，如用户名、密码、用户数据等。
2.  **数据篡改：** 修改数据库中的数据，例如提升权限、篡改文件等。
3.  **远程代码执行：** 在某些数据库配置下，攻击者可能执行操作系统命令，从而完全控制服务器。

从POC代码来看，利用方式主要依赖于构造恶意的HTTP请求，例如`POST /moveitisapi/moveitisapi.dll`，`POST /guestaccess.aspx`， `POST /api/v1/folders/[random]/files`，并通过SQL注入来操纵数据库。

**项目地址:** [deepinstinct/MOVEit_CVE-2023-34362_IOCs](https://github.com/deepinstinct/MOVEit_CVE-2023-34362_IOCs)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #5

**来源**: [CVE-2023-34362-errorfiathck_MOVEit-Exploit.md](../2023/CVE-2023-34362-errorfiathck_MOVEit-Exploit.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未授权访问数据库，信息泄露，甚至远程代码执行。

**影响版本:** < 2021.0.6 (13.0.6), < 2021.1.4 (13.1.4), < 2022.0.4 (14.0.4), < 2022.1.5 (14.1.5), < 2023.0.1 (15.0.1)

**利用条件:** 需要网络访问 MOVEit Transfer Web 应用。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于 MOVEit Transfer Web 应用的 guestaccess.aspx 页面，是一个未经身份验证的 SQL 注入漏洞。攻击者可以通过构造恶意的 SQL 语句注入到 `MyPkgSelfProvisionedRecips` session 变量中，然后触发 `guestaccess.aspx` 的处理逻辑来执行 SQL 语句，从而获取数据库的敏感信息，甚至修改或删除数据库中的数据。POC 代码通过设置特定的 session 变量并发送包含恶意 SQL 语句的请求来利用此漏洞。

**有效性评估：**

*   漏洞库信息和搜索引擎结果表明该漏洞是一个高危且被广泛利用的漏洞。
*   提供的 POC 代码实现了利用该漏洞的步骤，包括获取 CSRF token，设置 session 变量，以及触发 SQL 注入。
*   代码中包含创建 JWT 并获取 access token 的功能，可能用于绕过某些身份验证机制，执行更高级别的操作，例如删除文件。

**投毒风险评估：**

代码主要通过SQL注入利用已知漏洞。`create_jwt`函数依赖`key.pem`和`cert.crt`文件，如果这两个文件本身被替换为恶意文件，可能会导致私钥泄露或权限提升漏洞。代码本身功能比较单一，直接植入后门的可能性较低，投毒的可能性较低。

**利用方式：**

1.  **获取 Session ID:** 向 MOVEit Transfer Web 应用发送请求，获取 `ASP.NET_SessionId` cookie。
2.  **获取 CSRF Token:** 向 `guestaccess.aspx` 发送 POST 请求，获取 CSRF token。
3.  **设置 Session 变量:**  利用 `MOVEitISAPI.dll` 的漏洞，通过设置 `MyPkgSelfProvisionedRecips` session 变量注入恶意 SQL 语句。
4.  **触发 SQL 注入:** 向 `guestaccess.aspx` 发送包含 CSRF token 的 POST 请求，触发 SQL 注入。
5.  **获取 Access Token (可选):** 如果需要执行更高级别的操作，可以使用提供的 JWT 创建功能获取 access token。
6.  **执行恶意操作 (可选):** 使用 access token 执行恶意操作，例如删除文件。

总的来说，这个 POC 的有效性很高，因为它利用了一个已知的、被广泛利用的漏洞。 投毒风险较低，但需要关注 `key.pem`和`cert.crt`文件。

**项目地址:** [errorfiathck/MOVEit-Exploit](https://github.com/errorfiathck/MOVEit-Exploit)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #6

**来源**: [CVE-2023-34362-glen-pearson_MoveIT-CVE-2023-34362-RCE.md](../2023/CVE-2023-34362-glen-pearson_MoveIT-CVE-2023-34362-RCE.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可导致未经身份验证的攻击者访问数据库，远程代码执行。

**影响版本:** 受影响版本包括早于 2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), 和 2023.0.1 (15.0.1) 的版本，以及所有这些版本之前的版本（例如 2020.0 和 2019x）以及较旧的不受支持的版本。

**利用条件:** 需要可以通过HTTP或HTTPS访问MOVEit Transfer的Web应用程序。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-34362 存在于 MOVEit Transfer Web 应用程序中，是一个未经身份验证的 SQL 注入漏洞。攻击者可以利用此漏洞访问 MOVEit Transfer 数据库，并根据使用的数据库引擎（MySQL、Microsoft SQL Server 或 Azure SQL），推断数据库的结构和内容，并执行 SQL 语句来更改或删除数据库元素。根据提供的漏洞利用代码`move.rb`，该漏洞利用脚本首先获取初始会话令牌和InstID，然后创建一个新的sysadmin帐户，利用API访问令牌，找到folderId。该脚本泄露 Org Key 并使用反序列化 Gadget 植入加密的Gadget到数据库中，最后触发 Gadget 反序列化，实现远程代码执行（RCE）。最后，该脚本删除IoC。

**有效性：**

从漏洞库信息、搜索结果和漏洞利用代码来看，该漏洞是真实存在的，并且已经被积极利用。提供的PoC代码通过执行一系列操作，包括创建管理员账户、上传恶意文件（gadget），然后利用反序列化漏洞执行任意代码，验证了漏洞的可利用性。

**投毒风险：**

提供的ruby脚本主要功能是利用漏洞，而不是进行投毒。

*   `move.rb` 脚本看起来是为了利用 MOVEit Transfer 中的 SQL 注入漏洞而设计的，目的是实现远程代码执行。它创建管理员帐户、上传文件、进行反序列化攻击等。这些行为都是直接针对漏洞利用，而不是为了在目标系统上安装恶意后门或进行其他恶意活动。

*   风险评估： 0.1%的可能将漏洞验证过程中写入数据库的后门判定为恶意投毒代码。

**利用方式：**

1.  **SQL 注入：** 攻击者利用 SQL 注入漏洞，在数据库中创建一个新的具有管理员权限的帐户。
2.  **文件上传：** 攻击者上传包含恶意代码的文件（gadget）。
3.  **反序列化：** 攻击者触发反序列化过程，执行上传的恶意代码，从而实现远程代码执行。

总而言之，提供的PoC代码是有效的，并且能够成功利用该漏洞实现远程代码执行。投毒的风险很低。


**项目地址:** [glen-pearson/MoveIT-CVE-2023-34362-RCE](https://github.com/glen-pearson/MoveIT-CVE-2023-34362-RCE)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #7

**来源**: [CVE-2023-34362-horizon3ai_CVE-2023-34362.md](../2023/CVE-2023-34362-horizon3ai_CVE-2023-34362.md)

# CVE-2023-34362

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-34362-Chinyemba-ck_MOVEit-CVE-2023-34362.md](../2023/CVE-2023-34362-Chinyemba-ck_MOVEit-CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未授权访问数据库、数据泄露、修改或删除数据库元素，甚至远程代码执行。

**影响版本:** 受影响版本包括2021.0.6 (13.0.6)之前的所有版本、2021.1.4 (13.1.4)之前的所有版本、2022.0.4 (14.0.4)之前的所有版本、2022.1.5 (14.1.5)之前的所有版本和2023.0.1 (15.0.1)之前的所有版本。包括2020.0和2019x等旧的不受支持的版本。

**利用条件:** 需要通过HTTP或HTTPS网络访问MOVEit Transfer Web应用程序。

**POC 可用性:** 是，但提供的代码仅为分析视频链接，需要自行搜索POC代码。

**投毒风险:** 5%

## 详情

CVE-2023-34362是MOVEit Transfer Web应用程序中发现的一个SQL注入漏洞。未经身份验证的攻击者可以利用此漏洞获得对MOVEit Transfer数据库的访问权限。根据使用的数据库引擎（MySQL、Microsoft SQL Server或Azure SQL），攻击者可能能够推断有关数据库结构和内容的信息，并执行SQL语句来更改或删除数据库元素。该漏洞已被Clop勒索软件团伙利用进行数据窃取。提供的漏洞利用代码只是一个README文件，指向一个分析视频，因此不能直接用于漏洞利用，需要自行搜索并验证可用的POC代码。投毒风险较低，因为提供的代码只包含一个视频链接，并非实际的漏洞利用程序。但如果视频链接指向恶意站点，则存在一定的风险。根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**利用方式：**

1.  **确定目标：** 识别运行MOVEit Transfer且未打补丁的系统。
2.  **SQL注入：** 通过构造恶意的SQL查询，利用未过滤的输入点注入恶意SQL代码。
3.  **信息泄露/数据窃取：** 成功注入SQL代码后，攻击者可以读取数据库中的敏感信息，例如用户名、密码、API密钥和私有数据。
4.  **数据修改/删除：** 攻击者还可以通过SQL注入来修改或删除数据库中的数据，导致服务中断或数据损坏。
5.  **远程代码执行 (可能)：** 在某些数据库配置中，攻击者可能能够通过SQL注入执行操作系统命令，从而获得对服务器的完全控制权。

**项目地址:** [Chinyemba-ck/MOVEit-CVE-2023-34362](https://github.com/Chinyemba-ck/MOVEit-CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #2

**来源**: [CVE-2023-34362-Malwareman007_CVE-2023-34362.md](../2023/CVE-2023-34362-Malwareman007_CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** 受影响版本包括2021.0.6 (13.0.6)之前的版本, 2021.1.4 (13.1.4)之前的版本, 2022.0.4 (14.0.4)之前的版本, 2022.1.5 (14.1.5)之前的版本, 和 2023.0.1 (15.0.1)之前的版本,以及所有早于这五个版本的版本 (例如，2020.0和2019x)

**利用条件:** 需要网络访问，未授权攻击即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34362是MOVEit Transfer中的一个SQL注入漏洞，攻击者可以通过构造恶意的SQL语句，利用guestaccess.aspx页面，从而获取对数据库的未授权访问，甚至执行任意SQL命令。

**漏洞利用有效性:**
根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用的有效性较高。漏洞库信息表明这是一个在野利用的漏洞，搜索引擎结果也证实了这一点，并提到Clop勒索软件团伙利用此漏洞进行攻击。POC代码尝试利用guestaccess.aspx进行SQL注入，通过设置特定的session变量，将SQL语句注入到数据库查询中。

**投毒风险分析:**
POC代码本身看起来是用于利用漏洞的，但存在潜在的投毒风险。create_jwt 函数尝试读取key.pem和cert.crt，如果这两个文件被替换为恶意文件，攻击者有可能通过该POC植入后门。由于需要文件读取，且代码逻辑较为复杂，存在一定被植入恶意代码的风险，风险程度为10%。

**利用方式:**
1.  **获取CSRF Token:** 首先，利用`get_csrf`函数发送POST请求到`guestaccess.aspx`，获取CSRF Token。
2.  **设置Session变量:** 利用`set_session_variables`函数，通过`MOVEitISAPI.dll`设置包含恶意SQL语句的Session变量。该函数通过构造特定的HTTP头，绕过身份验证，将恶意SQL代码传递到后端。
3.  **触发SQL注入:** 调用`do_guest_access`函数，通过发送包含CSRF Token和相关参数的POST请求到`guestaccess.aspx`，触发SQL注入。
4.  **执行SQL语句:** 恶意SQL语句被执行，可能导致数据泄露、篡改或远程代码执行。
5.  **创建JWT(可疑):**create_jwt函数创建jwt，读取证书文件，这可能被用于身份认证绕过或者其他恶意操作，但是否一定存在恶意行为有待进一步分析。

**项目地址:** [Malwareman007/CVE-2023-34362](https://github.com/Malwareman007/CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #3

**来源**: [CVE-2023-34362-Naveenbana5250_CVE-2023-34362-Defense-Package.md](../2023/CVE-2023-34362-Naveenbana5250_CVE-2023-34362-Defense-Package.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，未经身份验证的攻击者可以访问数据库，可能导致信息泄露，修改或删除数据库元素，最终实现远程代码执行。

**影响版本:** 所有版本（例如2020.0和2019x）在五个明确提到的版本之前都受到影响，包括较旧的不受支持的版本。具体受影响版本包括：MOVEit Transfer before 2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), and 2023.0.1 (15.0.1)

**利用条件:** 需要MOVEit Transfer应用程序可通过HTTP或HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34362 是 MOVEit Transfer Web应用程序中发现的 SQL 注入漏洞。未经身份验证的攻击者可以利用此漏洞访问 MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL，Microsoft SQL Server或Azure SQL），攻击者可以推断有关数据库结构和内容的信息，并执行SQL语句来更改或删除数据库元素。漏洞利用通常通过构造恶意的 HTTP POST 请求，目标是 `/moveitisapi.dll?action=m2` 接口，并在 `X-siLock-SessVar` header 中注入 SQL 代码。

**有效性：**
根据漏洞描述和已公开的漏洞利用报告，该漏洞的POC代码有效。大量的实际攻击事件也证实了这一点。

**投毒风险：**
提供的代码仓库主要包含防御规则和IOCs。Suricata规则和Sigma规则用于检测SQL注入攻击和Webshell访问，未发现恶意代码。IOCs列表可以帮助安全分析人员识别受影响的系统。虽然主要目的是防御，但仍然存在一定的投毒风险。例如，Suricata 和 Sigma 规则可能存在误报，导致不必要的警报。此外，IOCs 可能不完整或不准确，导致遗漏真正的攻击。综合考虑，投毒风险较低，大约为10%。

**利用方式：**
1.  **SQL 注入：** 攻击者向 `/moveitisapi.dll?action=m2` 发送带有恶意构造的 `X-siLock-SessVar` header 的 HTTP POST 请求，利用SQL注入漏洞。
2.  **Webshell 部署：** 成功利用SQL注入后，攻击者可以部署Webshell（例如 `human2.aspx`），从而实现远程代码执行。
3.  **数据窃取和持久化：** 攻击者使用Webshell窃取敏感数据，并通过创建后门账户等方式实现持久化访问。

**项目地址:** [Naveenbana5250/CVE-2023-34362-Defense-Package](https://github.com/Naveenbana5250/CVE-2023-34362-Defense-Package)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #4

**来源**: [CVE-2023-34362-deepinstinct_MOVEit_CVE-2023-34362_IOCs.md](../2023/CVE-2023-34362-deepinstinct_MOVEit_CVE-2023-34362_IOCs.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未经授权的数据库访问、信息泄露、数据篡改和远程代码执行

**影响版本:** 所有版本（例如2020.0和2019x）在明确提到的五个版本之前都受影响，包括较旧的不受支持的版本，以及2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), 和 2023.0.1 (15.0.1)

**利用条件:** 未经身份验证的远程攻击，可通过HTTP或HTTPS进行利用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-34362是MOVEit Transfer Web应用程序中发现的SQL注入漏洞。未经身份验证的攻击者可以利用此漏洞访问MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL，Microsoft SQL Server或Azure SQL），攻击者可能能够推断有关数据库结构和内容的信息，并执行SQL语句以更改或删除数据库元素。该漏洞已在野外被利用，Clop勒索软件组织声称对此负责。提供的POC代码是一个CSV文件，包含入侵指标（IOC），如文件路径、HTTP请求、IP地址、域名和SHA256哈希值。这些IOC可以帮助检测和响应针对MOVEit Transfer的攻击。

**有效性评估：** 从搜索结果和漏洞库信息来看，此漏洞的利用是真实且有效的。POC代码提供的IOC列表能够帮助安全分析人员识别潜在的攻击行为。因此，提供的IOC文件本身是有效的，可以作为检测和防御此漏洞攻击的依据。

**投毒风险分析：** 该代码主要是一个包含IOC的CSV文件和一个README文件。其中README文件是一个免责声明。CSV文件中包含了HTTP请求的路径、可疑IP地址，以及可能被利用的ASP.NET文件，以及一些user agent和hash。虽然列出的IP地址可能包含恶意IP，但把IP地址加入IOC列表的行为属于漏洞利用信息的共享，不属于投毒行为。综上，这个仓库本身包含作者隐藏的恶意投毒代码的概率较低，仅存在一些IP地址未来被错误标记的低概率风险。评估风险百分比为5%。

**利用方式分析：** 攻击者利用该漏洞通常通过发送特制的HTTP请求，该请求包含恶意的SQL代码。此SQL代码会被MOVEit Transfer应用解析，并传递给后端的数据库服务器执行。成功利用此漏洞可能允许攻击者：
1.  **数据泄露：** 提取敏感信息，如用户名、密码、用户数据等。
2.  **数据篡改：** 修改数据库中的数据，例如提升权限、篡改文件等。
3.  **远程代码执行：** 在某些数据库配置下，攻击者可能执行操作系统命令，从而完全控制服务器。

从POC代码来看，利用方式主要依赖于构造恶意的HTTP请求，例如`POST /moveitisapi/moveitisapi.dll`，`POST /guestaccess.aspx`， `POST /api/v1/folders/[random]/files`，并通过SQL注入来操纵数据库。

**项目地址:** [deepinstinct/MOVEit_CVE-2023-34362_IOCs](https://github.com/deepinstinct/MOVEit_CVE-2023-34362_IOCs)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #5

**来源**: [CVE-2023-34362-errorfiathck_MOVEit-Exploit.md](../2023/CVE-2023-34362-errorfiathck_MOVEit-Exploit.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未授权访问数据库，信息泄露，甚至远程代码执行。

**影响版本:** < 2021.0.6 (13.0.6), < 2021.1.4 (13.1.4), < 2022.0.4 (14.0.4), < 2022.1.5 (14.1.5), < 2023.0.1 (15.0.1)

**利用条件:** 需要网络访问 MOVEit Transfer Web 应用。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于 MOVEit Transfer Web 应用的 guestaccess.aspx 页面，是一个未经身份验证的 SQL 注入漏洞。攻击者可以通过构造恶意的 SQL 语句注入到 `MyPkgSelfProvisionedRecips` session 变量中，然后触发 `guestaccess.aspx` 的处理逻辑来执行 SQL 语句，从而获取数据库的敏感信息，甚至修改或删除数据库中的数据。POC 代码通过设置特定的 session 变量并发送包含恶意 SQL 语句的请求来利用此漏洞。

**有效性评估：**

*   漏洞库信息和搜索引擎结果表明该漏洞是一个高危且被广泛利用的漏洞。
*   提供的 POC 代码实现了利用该漏洞的步骤，包括获取 CSRF token，设置 session 变量，以及触发 SQL 注入。
*   代码中包含创建 JWT 并获取 access token 的功能，可能用于绕过某些身份验证机制，执行更高级别的操作，例如删除文件。

**投毒风险评估：**

代码主要通过SQL注入利用已知漏洞。`create_jwt`函数依赖`key.pem`和`cert.crt`文件，如果这两个文件本身被替换为恶意文件，可能会导致私钥泄露或权限提升漏洞。代码本身功能比较单一，直接植入后门的可能性较低，投毒的可能性较低。

**利用方式：**

1.  **获取 Session ID:** 向 MOVEit Transfer Web 应用发送请求，获取 `ASP.NET_SessionId` cookie。
2.  **获取 CSRF Token:** 向 `guestaccess.aspx` 发送 POST 请求，获取 CSRF token。
3.  **设置 Session 变量:**  利用 `MOVEitISAPI.dll` 的漏洞，通过设置 `MyPkgSelfProvisionedRecips` session 变量注入恶意 SQL 语句。
4.  **触发 SQL 注入:** 向 `guestaccess.aspx` 发送包含 CSRF token 的 POST 请求，触发 SQL 注入。
5.  **获取 Access Token (可选):** 如果需要执行更高级别的操作，可以使用提供的 JWT 创建功能获取 access token。
6.  **执行恶意操作 (可选):** 使用 access token 执行恶意操作，例如删除文件。

总的来说，这个 POC 的有效性很高，因为它利用了一个已知的、被广泛利用的漏洞。 投毒风险较低，但需要关注 `key.pem`和`cert.crt`文件。

**项目地址:** [errorfiathck/MOVEit-Exploit](https://github.com/errorfiathck/MOVEit-Exploit)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #6

**来源**: [CVE-2023-34362-glen-pearson_MoveIT-CVE-2023-34362-RCE.md](../2023/CVE-2023-34362-glen-pearson_MoveIT-CVE-2023-34362-RCE.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可导致未经身份验证的攻击者访问数据库，远程代码执行。

**影响版本:** 受影响版本包括早于 2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), 和 2023.0.1 (15.0.1) 的版本，以及所有这些版本之前的版本（例如 2020.0 和 2019x）以及较旧的不受支持的版本。

**利用条件:** 需要可以通过HTTP或HTTPS访问MOVEit Transfer的Web应用程序。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-34362 存在于 MOVEit Transfer Web 应用程序中，是一个未经身份验证的 SQL 注入漏洞。攻击者可以利用此漏洞访问 MOVEit Transfer 数据库，并根据使用的数据库引擎（MySQL、Microsoft SQL Server 或 Azure SQL），推断数据库的结构和内容，并执行 SQL 语句来更改或删除数据库元素。根据提供的漏洞利用代码`move.rb`，该漏洞利用脚本首先获取初始会话令牌和InstID，然后创建一个新的sysadmin帐户，利用API访问令牌，找到folderId。该脚本泄露 Org Key 并使用反序列化 Gadget 植入加密的Gadget到数据库中，最后触发 Gadget 反序列化，实现远程代码执行（RCE）。最后，该脚本删除IoC。

**有效性：**

从漏洞库信息、搜索结果和漏洞利用代码来看，该漏洞是真实存在的，并且已经被积极利用。提供的PoC代码通过执行一系列操作，包括创建管理员账户、上传恶意文件（gadget），然后利用反序列化漏洞执行任意代码，验证了漏洞的可利用性。

**投毒风险：**

提供的ruby脚本主要功能是利用漏洞，而不是进行投毒。

*   `move.rb` 脚本看起来是为了利用 MOVEit Transfer 中的 SQL 注入漏洞而设计的，目的是实现远程代码执行。它创建管理员帐户、上传文件、进行反序列化攻击等。这些行为都是直接针对漏洞利用，而不是为了在目标系统上安装恶意后门或进行其他恶意活动。

*   风险评估： 0.1%的可能将漏洞验证过程中写入数据库的后门判定为恶意投毒代码。

**利用方式：**

1.  **SQL 注入：** 攻击者利用 SQL 注入漏洞，在数据库中创建一个新的具有管理员权限的帐户。
2.  **文件上传：** 攻击者上传包含恶意代码的文件（gadget）。
3.  **反序列化：** 攻击者触发反序列化过程，执行上传的恶意代码，从而实现远程代码执行。

总而言之，提供的PoC代码是有效的，并且能够成功利用该漏洞实现远程代码执行。投毒的风险很低。


**项目地址:** [glen-pearson/MoveIT-CVE-2023-34362-RCE](https://github.com/glen-pearson/MoveIT-CVE-2023-34362-RCE)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #7

**来源**: [CVE-2023-34362-kenbuckler_MOVEit-CVE-2023-34362.md](../2023/CVE-2023-34362-kenbuckler_MOVEit-CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未授权访问数据库，信息泄露，数据篡改或删除

**影响版本:** 受影响版本包括2021.0.6之前的所有版本，以及2021.1.4, 2022.0.4, 2022.1.5, 和 2023.0.1这些版本

**利用条件:** 未授权的攻击者通过HTTP或HTTPS协议访问存在漏洞的MOVEit Transfer Web应用程序

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34362是MOVEit Transfer Web应用程序中发现的一个SQL注入漏洞。未经身份验证的攻击者可以利用此漏洞访问MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL, Microsoft SQL Server或Azure SQL），攻击者可能能够推断数据库的结构和内容，并执行SQL语句来更改或删除数据库元素。由于该漏洞在实际环境中被利用，因此评估结果为POC有效。漏洞利用代码中包含了一些用于发现目标的Shodan搜索方法和Google Dork，以及受影响的HTTP标题列表，这些信息可以帮助攻击者快速定位目标。该代码主要是信息收集和目标识别，未发现明显的恶意代码。但考虑到攻击者可能会利用这些信息进行大规模攻击，存在一定的投毒风险，评估结果为10%。利用方式主要通过构造恶意的SQL语句，通过HTTP/HTTPS协议发送到MOVEit Transfer Web应用程序，从而实现对数据库的未授权访问。

**项目地址:** [kenbuckler/MOVEit-CVE-2023-34362](https://github.com/kenbuckler/MOVEit-CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #8

**来源**: [CVE-2023-34362-lithuanian-g_cve-2023-34362-iocs.md](../2023/CVE-2023-34362-lithuanian-g_cve-2023-34362-iocs.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未经授权的数据库访问、数据泄露、远程代码执行

**影响版本:** 受影响版本包括2021.0.6 (13.0.6)之前、2021.1.4 (13.1.4)之前、2022.0.4 (14.0.4)之前、2022.1.5 (14.1.5)之前和2023.0.1 (15.0.1)之前的版本，以及所有早于这五个显式提及的版本的版本

**利用条件:** 无需身份验证，可通过HTTP或HTTPS利用

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-34362是MOVEit Transfer Web应用程序中发现的SQL注入漏洞。未经身份验证的攻击者可以利用此漏洞访问MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL、Microsoft SQL Server或Azure SQL），攻击者可能能够推断有关数据库结构和内容的信息，并执行SQL语句来更改或删除数据库元素。该漏洞已被野外利用。

**利用方式：**

攻击者通过构造恶意的SQL语句，利用MOVEit Transfer Web应用程序的漏洞点，绕过身份验证并执行恶意SQL代码。 这允许他们从数据库中提取敏感信息，修改数据库内容，甚至可能在服务器上执行任意命令。

**有效性评估：**

漏洞库信息和搜索结果均表明此漏洞的POC是有效的，并且已被积极利用。

**投毒风险分析：**

提供的漏洞利用代码`/tmp/855c1feeae0b1ef3a7668b43f388510c/cve-2023-34362-iocs.csv`实际上是一个IOC（Indicators of Compromise）列表，包含攻击者使用的文件路径、HTTP请求、IP地址、域名和哈希值。虽然此列表本身不包含恶意代码，但如果攻击者伪造或篡改IOC列表，并将其用于误导安全分析人员或安全设备，则可能存在投毒风险。 例如,攻击者可能提供大量的正常IP地址,来混淆真实的恶意IP地址，造成分析人员无法准确识别攻击来源。鉴于此IOC列表的性质和潜在的滥用方式，认为存在**20%**的投毒风险。


**项目地址:** [lithuanian-g/cve-2023-34362-iocs](https://github.com/lithuanian-g/cve-2023-34362-iocs)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #9

**来源**: [CVE-2023-34362-sfewer-r7_CVE-2023-34362.md](../2023/CVE-2023-34362-sfewer-r7_CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致数据库访问、数据泄露和远程代码执行

**影响版本:** 受影响版本：2021.0.6 (13.0.6)之前, 2021.1.4 (13.1.4)之前, 2022.0.4 (14.0.4)之前, 2022.1.5 (14.1.5)之前, and 2023.0.1 (15.0.1)之前的所有版本（包括2020.0和2019x以及更早的未支持版本）

**利用条件:** 需要网络访问MOVEit Transfer的web应用程序

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-34362 是 MOVEit Transfer 中的一个 SQL 注入漏洞，未经身份验证的攻击者可以通过该漏洞访问 MOVEit Transfer 的数据库。 根据使用的数据库引擎（MySQL、Microsoft SQL Server 或 Azure SQL），攻击者可能能够推断有关数据库结构和内容的信息，并执行 SQL 语句来更改或删除数据库元素。该漏洞在野外被积极利用。

**漏洞利用方式：**

1.  **SQL注入：** 攻击者利用SQL注入漏洞，向MOVEit Transfer Web应用程序发送特制的SQL查询，绕过身份验证并获得数据库访问权限。
2.  **信息泄露和数据库操作：** 成功利用SQL注入后，攻击者可以读取数据库内容、修改数据、甚至执行任意SQL命令。
3.  **远程代码执行：**  通过执行SQL语句，攻击者可能能够执行系统命令，从而实现远程代码执行。

**POC有效性：**

提供的POC代码看起来是有效的。它利用HTTParty库发送请求，并精心构造了带有SQL注入的Header，结合session变量设置绕过验证。代码目标明确，结构清晰，验证了未授权的RCE利用链。

**投毒风险：**

代码中存在轻微的投毒风险的可能性，但主要集中在以下几个方面：

*   **依赖项：** 代码依赖于httparty和openssl等ruby库。如果这些库本身被投毒，可能会影响漏洞利用的安全性。但这不是POC本身的问题。
*   **目标IP：**  POC代码中定义了TARGET常量，攻击者可能会修改此值，如果未经授权扫描或攻击目标，可能导致法律问题。
*   **远程代码执行的payload：** 目前，exp中硬编码的payload为启动`notepad.exe`，攻击者可以修改此payload以执行其他恶意操作。但这取决于使用exp的人。

风险评估：5%。 此百分比很低，因为代码本身主要关注于利用，而不是分发恶意软件或执行后门操作。主要风险在于使用者对payload的修改和目标的选择，与代码本身关系不大。

**项目地址:** [sfewer-r7/CVE-2023-34362](https://github.com/sfewer-r7/CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #10

**来源**: [CVE-2023-34362-toorandom_moveit-payload-decrypt-CVE-2023-34362.md](../2023/CVE-2023-34362-toorandom_moveit-payload-decrypt-CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致数据泄露、远程代码执行，以及被勒索软件利用

**影响版本:** 受影响版本包括但不限于2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), and 2023.0.1 (15.0.1)，以及所有早于上述五个版本的版本，包括不受支持的旧版本。

**利用条件:** 未授权的攻击者可以通过HTTP或HTTPS访问存在漏洞的MOVEit Transfer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34362是MOVEit Transfer中的一个SQL注入漏洞，允许未经身份验证的攻击者访问MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL、Microsoft SQL Server或Azure SQL），攻击者可能能够推断数据库的结构和内容，并执行SQL语句来修改或删除数据库元素。该漏洞在野外被积极利用，已被CL0P勒索软件团伙利用进行数据盗窃和勒索。

**漏洞利用方式：**

1.  **SQL注入：** 攻击者利用SQL注入漏洞，通过构造恶意的SQL语句，绕过身份验证或直接访问数据库。
2.  **数据访问：** 成功利用SQL注入后，攻击者可以读取数据库中的敏感数据，例如用户名、密码、API密钥等。
3.  **数据篡改/删除：** 攻击者可以执行SQL语句来修改或删除数据库中的数据，导致服务中断或数据损坏。
4.  **远程代码执行：** 在某些情况下，攻击者可能能够利用SQL注入执行操作系统命令，从而实现远程代码执行。

**POC有效性：**

提供的POC代码 (`moveit_payload_decrypt.sh`) 用于解密MOVEit Transfer日志中发现的base64编码的artifact，这与漏洞的利用方式密切相关。攻击者利用SQL注入获得加密payload后，需要使用该脚本来解密payload。 因此，它不是直接利用漏洞的EXP，而是漏洞利用链中的一个环节,用于解密有效载荷， 依赖于已经成功利用SQL注入。 该脚本需要OrgKey 0，该密钥存储在受影响实例的注册表项 `Microsoft/Standard Networks/siLock/Institutions/0` 中。脚本的功能是根据提供的OrgKey 0解析MOVEit日志中base64 artifact的头部并解密序列化的payload对象。

**投毒风险分析：**

查看代码，主要功能集中在payload的解析和解密上。该脚本本身需要从MOVEit服务器的注册表中提取OrgKey 0才能运行，因此投毒风险较低。 但是考虑到以下几点， 仍然存在一定的投毒风险：

1.  **依赖外部命令：** 脚本依赖于`base64`、`cut`、`dd`、`xxd`、`sed`、`openssl`等外部命令。如果这些命令被恶意替换，可能导致脚本执行恶意代码。但这种情况更偏向于系统层面的攻击，而非脚本本身的投毒。
2.  **代码可读性：** 代码相对简单，易于审计，但仍然存在一定的复杂性，可能隐藏不易察觉的漏洞或后门。
3.  **潜在的恶意修改：** 攻击者可能修改脚本，例如在解密后添加恶意代码，或者将解密后的数据发送到远程服务器。

基于以上分析，认为此仓库存在10%的投毒风险。主要风险在于脚本可能被修改或利用来执行恶意操作，而不是脚本本身包含明显的恶意代码。

**项目地址:** [toorandom/moveit-payload-decrypt-CVE-2023-34362](https://github.com/toorandom/moveit-payload-decrypt-CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---



---

## POC #8

**来源**: [CVE-2023-34362-kenbuckler_MOVEit-CVE-2023-34362.md](../2023/CVE-2023-34362-kenbuckler_MOVEit-CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未授权访问数据库，信息泄露，数据篡改或删除

**影响版本:** 受影响版本包括2021.0.6之前的所有版本，以及2021.1.4, 2022.0.4, 2022.1.5, 和 2023.0.1这些版本

**利用条件:** 未授权的攻击者通过HTTP或HTTPS协议访问存在漏洞的MOVEit Transfer Web应用程序

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34362是MOVEit Transfer Web应用程序中发现的一个SQL注入漏洞。未经身份验证的攻击者可以利用此漏洞访问MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL, Microsoft SQL Server或Azure SQL），攻击者可能能够推断数据库的结构和内容，并执行SQL语句来更改或删除数据库元素。由于该漏洞在实际环境中被利用，因此评估结果为POC有效。漏洞利用代码中包含了一些用于发现目标的Shodan搜索方法和Google Dork，以及受影响的HTTP标题列表，这些信息可以帮助攻击者快速定位目标。该代码主要是信息收集和目标识别，未发现明显的恶意代码。但考虑到攻击者可能会利用这些信息进行大规模攻击，存在一定的投毒风险，评估结果为10%。利用方式主要通过构造恶意的SQL语句，通过HTTP/HTTPS协议发送到MOVEit Transfer Web应用程序，从而实现对数据库的未授权访问。

**项目地址:** [kenbuckler/MOVEit-CVE-2023-34362](https://github.com/kenbuckler/MOVEit-CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #9

**来源**: [CVE-2023-34362-lithuanian-g_cve-2023-34362-iocs.md](../2023/CVE-2023-34362-lithuanian-g_cve-2023-34362-iocs.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未经授权的数据库访问、数据泄露、远程代码执行

**影响版本:** 受影响版本包括2021.0.6 (13.0.6)之前、2021.1.4 (13.1.4)之前、2022.0.4 (14.0.4)之前、2022.1.5 (14.1.5)之前和2023.0.1 (15.0.1)之前的版本，以及所有早于这五个显式提及的版本的版本

**利用条件:** 无需身份验证，可通过HTTP或HTTPS利用

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-34362是MOVEit Transfer Web应用程序中发现的SQL注入漏洞。未经身份验证的攻击者可以利用此漏洞访问MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL、Microsoft SQL Server或Azure SQL），攻击者可能能够推断有关数据库结构和内容的信息，并执行SQL语句来更改或删除数据库元素。该漏洞已被野外利用。

**利用方式：**

攻击者通过构造恶意的SQL语句，利用MOVEit Transfer Web应用程序的漏洞点，绕过身份验证并执行恶意SQL代码。 这允许他们从数据库中提取敏感信息，修改数据库内容，甚至可能在服务器上执行任意命令。

**有效性评估：**

漏洞库信息和搜索结果均表明此漏洞的POC是有效的，并且已被积极利用。

**投毒风险分析：**

提供的漏洞利用代码`/tmp/855c1feeae0b1ef3a7668b43f388510c/cve-2023-34362-iocs.csv`实际上是一个IOC（Indicators of Compromise）列表，包含攻击者使用的文件路径、HTTP请求、IP地址、域名和哈希值。虽然此列表本身不包含恶意代码，但如果攻击者伪造或篡改IOC列表，并将其用于误导安全分析人员或安全设备，则可能存在投毒风险。 例如,攻击者可能提供大量的正常IP地址,来混淆真实的恶意IP地址，造成分析人员无法准确识别攻击来源。鉴于此IOC列表的性质和潜在的滥用方式，认为存在**20%**的投毒风险。


**项目地址:** [lithuanian-g/cve-2023-34362-iocs](https://github.com/lithuanian-g/cve-2023-34362-iocs)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #10

**来源**: [CVE-2023-34362-sfewer-r7_CVE-2023-34362.md](../2023/CVE-2023-34362-sfewer-r7_CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致数据库访问、数据泄露和远程代码执行

**影响版本:** 受影响版本：2021.0.6 (13.0.6)之前, 2021.1.4 (13.1.4)之前, 2022.0.4 (14.0.4)之前, 2022.1.5 (14.1.5)之前, and 2023.0.1 (15.0.1)之前的所有版本（包括2020.0和2019x以及更早的未支持版本）

**利用条件:** 需要网络访问MOVEit Transfer的web应用程序

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-34362 是 MOVEit Transfer 中的一个 SQL 注入漏洞，未经身份验证的攻击者可以通过该漏洞访问 MOVEit Transfer 的数据库。 根据使用的数据库引擎（MySQL、Microsoft SQL Server 或 Azure SQL），攻击者可能能够推断有关数据库结构和内容的信息，并执行 SQL 语句来更改或删除数据库元素。该漏洞在野外被积极利用。

**漏洞利用方式：**

1.  **SQL注入：** 攻击者利用SQL注入漏洞，向MOVEit Transfer Web应用程序发送特制的SQL查询，绕过身份验证并获得数据库访问权限。
2.  **信息泄露和数据库操作：** 成功利用SQL注入后，攻击者可以读取数据库内容、修改数据、甚至执行任意SQL命令。
3.  **远程代码执行：**  通过执行SQL语句，攻击者可能能够执行系统命令，从而实现远程代码执行。

**POC有效性：**

提供的POC代码看起来是有效的。它利用HTTParty库发送请求，并精心构造了带有SQL注入的Header，结合session变量设置绕过验证。代码目标明确，结构清晰，验证了未授权的RCE利用链。

**投毒风险：**

代码中存在轻微的投毒风险的可能性，但主要集中在以下几个方面：

*   **依赖项：** 代码依赖于httparty和openssl等ruby库。如果这些库本身被投毒，可能会影响漏洞利用的安全性。但这不是POC本身的问题。
*   **目标IP：**  POC代码中定义了TARGET常量，攻击者可能会修改此值，如果未经授权扫描或攻击目标，可能导致法律问题。
*   **远程代码执行的payload：** 目前，exp中硬编码的payload为启动`notepad.exe`，攻击者可以修改此payload以执行其他恶意操作。但这取决于使用exp的人。

风险评估：5%。 此百分比很低，因为代码本身主要关注于利用，而不是分发恶意软件或执行后门操作。主要风险在于使用者对payload的修改和目标的选择，与代码本身关系不大。

**项目地址:** [sfewer-r7/CVE-2023-34362](https://github.com/sfewer-r7/CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #11

**来源**: [CVE-2023-34362-toorandom_moveit-payload-decrypt-CVE-2023-34362.md](../2023/CVE-2023-34362-toorandom_moveit-payload-decrypt-CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致数据泄露、远程代码执行，以及被勒索软件利用

**影响版本:** 受影响版本包括但不限于2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), and 2023.0.1 (15.0.1)，以及所有早于上述五个版本的版本，包括不受支持的旧版本。

**利用条件:** 未授权的攻击者可以通过HTTP或HTTPS访问存在漏洞的MOVEit Transfer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34362是MOVEit Transfer中的一个SQL注入漏洞，允许未经身份验证的攻击者访问MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL、Microsoft SQL Server或Azure SQL），攻击者可能能够推断数据库的结构和内容，并执行SQL语句来修改或删除数据库元素。该漏洞在野外被积极利用，已被CL0P勒索软件团伙利用进行数据盗窃和勒索。

**漏洞利用方式：**

1.  **SQL注入：** 攻击者利用SQL注入漏洞，通过构造恶意的SQL语句，绕过身份验证或直接访问数据库。
2.  **数据访问：** 成功利用SQL注入后，攻击者可以读取数据库中的敏感数据，例如用户名、密码、API密钥等。
3.  **数据篡改/删除：** 攻击者可以执行SQL语句来修改或删除数据库中的数据，导致服务中断或数据损坏。
4.  **远程代码执行：** 在某些情况下，攻击者可能能够利用SQL注入执行操作系统命令，从而实现远程代码执行。

**POC有效性：**

提供的POC代码 (`moveit_payload_decrypt.sh`) 用于解密MOVEit Transfer日志中发现的base64编码的artifact，这与漏洞的利用方式密切相关。攻击者利用SQL注入获得加密payload后，需要使用该脚本来解密payload。 因此，它不是直接利用漏洞的EXP，而是漏洞利用链中的一个环节,用于解密有效载荷， 依赖于已经成功利用SQL注入。 该脚本需要OrgKey 0，该密钥存储在受影响实例的注册表项 `Microsoft/Standard Networks/siLock/Institutions/0` 中。脚本的功能是根据提供的OrgKey 0解析MOVEit日志中base64 artifact的头部并解密序列化的payload对象。

**投毒风险分析：**

查看代码，主要功能集中在payload的解析和解密上。该脚本本身需要从MOVEit服务器的注册表中提取OrgKey 0才能运行，因此投毒风险较低。 但是考虑到以下几点， 仍然存在一定的投毒风险：

1.  **依赖外部命令：** 脚本依赖于`base64`、`cut`、`dd`、`xxd`、`sed`、`openssl`等外部命令。如果这些命令被恶意替换，可能导致脚本执行恶意代码。但这种情况更偏向于系统层面的攻击，而非脚本本身的投毒。
2.  **代码可读性：** 代码相对简单，易于审计，但仍然存在一定的复杂性，可能隐藏不易察觉的漏洞或后门。
3.  **潜在的恶意修改：** 攻击者可能修改脚本，例如在解密后添加恶意代码，或者将解密后的数据发送到远程服务器。

基于以上分析，认为此仓库存在10%的投毒风险。主要风险在于脚本可能被修改或利用来执行恶意操作，而不是脚本本身包含明显的恶意代码。

**项目地址:** [toorandom/moveit-payload-decrypt-CVE-2023-34362](https://github.com/toorandom/moveit-payload-decrypt-CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---



---

## POC #8

**来源**: [CVE-2023-34362-kenbuckler_MOVEit-CVE-2023-34362.md](../2023/CVE-2023-34362-kenbuckler_MOVEit-CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未授权访问数据库，信息泄露，数据篡改或删除

**影响版本:** 受影响版本包括2021.0.6之前的所有版本，以及2021.1.4, 2022.0.4, 2022.1.5, 和 2023.0.1这些版本

**利用条件:** 未授权的攻击者通过HTTP或HTTPS协议访问存在漏洞的MOVEit Transfer Web应用程序

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34362是MOVEit Transfer Web应用程序中发现的一个SQL注入漏洞。未经身份验证的攻击者可以利用此漏洞访问MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL, Microsoft SQL Server或Azure SQL），攻击者可能能够推断数据库的结构和内容，并执行SQL语句来更改或删除数据库元素。由于该漏洞在实际环境中被利用，因此评估结果为POC有效。漏洞利用代码中包含了一些用于发现目标的Shodan搜索方法和Google Dork，以及受影响的HTTP标题列表，这些信息可以帮助攻击者快速定位目标。该代码主要是信息收集和目标识别，未发现明显的恶意代码。但考虑到攻击者可能会利用这些信息进行大规模攻击，存在一定的投毒风险，评估结果为10%。利用方式主要通过构造恶意的SQL语句，通过HTTP/HTTPS协议发送到MOVEit Transfer Web应用程序，从而实现对数据库的未授权访问。

**项目地址:** [kenbuckler/MOVEit-CVE-2023-34362](https://github.com/kenbuckler/MOVEit-CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #9

**来源**: [CVE-2023-34362-lithuanian-g_cve-2023-34362-iocs.md](../2023/CVE-2023-34362-lithuanian-g_cve-2023-34362-iocs.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未经授权的数据库访问、数据泄露、远程代码执行

**影响版本:** 受影响版本包括2021.0.6 (13.0.6)之前、2021.1.4 (13.1.4)之前、2022.0.4 (14.0.4)之前、2022.1.5 (14.1.5)之前和2023.0.1 (15.0.1)之前的版本，以及所有早于这五个显式提及的版本的版本

**利用条件:** 无需身份验证，可通过HTTP或HTTPS利用

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-34362是MOVEit Transfer Web应用程序中发现的SQL注入漏洞。未经身份验证的攻击者可以利用此漏洞访问MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL、Microsoft SQL Server或Azure SQL），攻击者可能能够推断有关数据库结构和内容的信息，并执行SQL语句来更改或删除数据库元素。该漏洞已被野外利用。

**利用方式：**

攻击者通过构造恶意的SQL语句，利用MOVEit Transfer Web应用程序的漏洞点，绕过身份验证并执行恶意SQL代码。 这允许他们从数据库中提取敏感信息，修改数据库内容，甚至可能在服务器上执行任意命令。

**有效性评估：**

漏洞库信息和搜索结果均表明此漏洞的POC是有效的，并且已被积极利用。

**投毒风险分析：**

提供的漏洞利用代码`/tmp/855c1feeae0b1ef3a7668b43f388510c/cve-2023-34362-iocs.csv`实际上是一个IOC（Indicators of Compromise）列表，包含攻击者使用的文件路径、HTTP请求、IP地址、域名和哈希值。虽然此列表本身不包含恶意代码，但如果攻击者伪造或篡改IOC列表，并将其用于误导安全分析人员或安全设备，则可能存在投毒风险。 例如,攻击者可能提供大量的正常IP地址,来混淆真实的恶意IP地址，造成分析人员无法准确识别攻击来源。鉴于此IOC列表的性质和潜在的滥用方式，认为存在**20%**的投毒风险。


**项目地址:** [lithuanian-g/cve-2023-34362-iocs](https://github.com/lithuanian-g/cve-2023-34362-iocs)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #10

**来源**: [CVE-2023-34362-sfewer-r7_CVE-2023-34362.md](../2023/CVE-2023-34362-sfewer-r7_CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致数据库访问、数据泄露和远程代码执行

**影响版本:** 受影响版本：2021.0.6 (13.0.6)之前, 2021.1.4 (13.1.4)之前, 2022.0.4 (14.0.4)之前, 2022.1.5 (14.1.5)之前, and 2023.0.1 (15.0.1)之前的所有版本（包括2020.0和2019x以及更早的未支持版本）

**利用条件:** 需要网络访问MOVEit Transfer的web应用程序

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-34362 是 MOVEit Transfer 中的一个 SQL 注入漏洞，未经身份验证的攻击者可以通过该漏洞访问 MOVEit Transfer 的数据库。 根据使用的数据库引擎（MySQL、Microsoft SQL Server 或 Azure SQL），攻击者可能能够推断有关数据库结构和内容的信息，并执行 SQL 语句来更改或删除数据库元素。该漏洞在野外被积极利用。

**漏洞利用方式：**

1.  **SQL注入：** 攻击者利用SQL注入漏洞，向MOVEit Transfer Web应用程序发送特制的SQL查询，绕过身份验证并获得数据库访问权限。
2.  **信息泄露和数据库操作：** 成功利用SQL注入后，攻击者可以读取数据库内容、修改数据、甚至执行任意SQL命令。
3.  **远程代码执行：**  通过执行SQL语句，攻击者可能能够执行系统命令，从而实现远程代码执行。

**POC有效性：**

提供的POC代码看起来是有效的。它利用HTTParty库发送请求，并精心构造了带有SQL注入的Header，结合session变量设置绕过验证。代码目标明确，结构清晰，验证了未授权的RCE利用链。

**投毒风险：**

代码中存在轻微的投毒风险的可能性，但主要集中在以下几个方面：

*   **依赖项：** 代码依赖于httparty和openssl等ruby库。如果这些库本身被投毒，可能会影响漏洞利用的安全性。但这不是POC本身的问题。
*   **目标IP：**  POC代码中定义了TARGET常量，攻击者可能会修改此值，如果未经授权扫描或攻击目标，可能导致法律问题。
*   **远程代码执行的payload：** 目前，exp中硬编码的payload为启动`notepad.exe`，攻击者可以修改此payload以执行其他恶意操作。但这取决于使用exp的人。

风险评估：5%。 此百分比很低，因为代码本身主要关注于利用，而不是分发恶意软件或执行后门操作。主要风险在于使用者对payload的修改和目标的选择，与代码本身关系不大。

**项目地址:** [sfewer-r7/CVE-2023-34362](https://github.com/sfewer-r7/CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #11

**来源**: [CVE-2023-34362-toorandom_moveit-payload-decrypt-CVE-2023-34362.md](../2023/CVE-2023-34362-toorandom_moveit-payload-decrypt-CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致数据泄露、远程代码执行，以及被勒索软件利用

**影响版本:** 受影响版本包括但不限于2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), and 2023.0.1 (15.0.1)，以及所有早于上述五个版本的版本，包括不受支持的旧版本。

**利用条件:** 未授权的攻击者可以通过HTTP或HTTPS访问存在漏洞的MOVEit Transfer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34362是MOVEit Transfer中的一个SQL注入漏洞，允许未经身份验证的攻击者访问MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL、Microsoft SQL Server或Azure SQL），攻击者可能能够推断数据库的结构和内容，并执行SQL语句来修改或删除数据库元素。该漏洞在野外被积极利用，已被CL0P勒索软件团伙利用进行数据盗窃和勒索。

**漏洞利用方式：**

1.  **SQL注入：** 攻击者利用SQL注入漏洞，通过构造恶意的SQL语句，绕过身份验证或直接访问数据库。
2.  **数据访问：** 成功利用SQL注入后，攻击者可以读取数据库中的敏感数据，例如用户名、密码、API密钥等。
3.  **数据篡改/删除：** 攻击者可以执行SQL语句来修改或删除数据库中的数据，导致服务中断或数据损坏。
4.  **远程代码执行：** 在某些情况下，攻击者可能能够利用SQL注入执行操作系统命令，从而实现远程代码执行。

**POC有效性：**

提供的POC代码 (`moveit_payload_decrypt.sh`) 用于解密MOVEit Transfer日志中发现的base64编码的artifact，这与漏洞的利用方式密切相关。攻击者利用SQL注入获得加密payload后，需要使用该脚本来解密payload。 因此，它不是直接利用漏洞的EXP，而是漏洞利用链中的一个环节,用于解密有效载荷， 依赖于已经成功利用SQL注入。 该脚本需要OrgKey 0，该密钥存储在受影响实例的注册表项 `Microsoft/Standard Networks/siLock/Institutions/0` 中。脚本的功能是根据提供的OrgKey 0解析MOVEit日志中base64 artifact的头部并解密序列化的payload对象。

**投毒风险分析：**

查看代码，主要功能集中在payload的解析和解密上。该脚本本身需要从MOVEit服务器的注册表中提取OrgKey 0才能运行，因此投毒风险较低。 但是考虑到以下几点， 仍然存在一定的投毒风险：

1.  **依赖外部命令：** 脚本依赖于`base64`、`cut`、`dd`、`xxd`、`sed`、`openssl`等外部命令。如果这些命令被恶意替换，可能导致脚本执行恶意代码。但这种情况更偏向于系统层面的攻击，而非脚本本身的投毒。
2.  **代码可读性：** 代码相对简单，易于审计，但仍然存在一定的复杂性，可能隐藏不易察觉的漏洞或后门。
3.  **潜在的恶意修改：** 攻击者可能修改脚本，例如在解密后添加恶意代码，或者将解密后的数据发送到远程服务器。

基于以上分析，认为此仓库存在10%的投毒风险。主要风险在于脚本可能被修改或利用来执行恶意操作，而不是脚本本身包含明显的恶意代码。

**项目地址:** [toorandom/moveit-payload-decrypt-CVE-2023-34362](https://github.com/toorandom/moveit-payload-decrypt-CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---



---

## POC #8

**来源**: [CVE-2023-34362-kenbuckler_MOVEit-CVE-2023-34362.md](../2023/CVE-2023-34362-kenbuckler_MOVEit-CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未授权访问数据库，信息泄露，数据篡改或删除

**影响版本:** 受影响版本包括2021.0.6之前的所有版本，以及2021.1.4, 2022.0.4, 2022.1.5, 和 2023.0.1这些版本

**利用条件:** 未授权的攻击者通过HTTP或HTTPS协议访问存在漏洞的MOVEit Transfer Web应用程序

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34362是MOVEit Transfer Web应用程序中发现的一个SQL注入漏洞。未经身份验证的攻击者可以利用此漏洞访问MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL, Microsoft SQL Server或Azure SQL），攻击者可能能够推断数据库的结构和内容，并执行SQL语句来更改或删除数据库元素。由于该漏洞在实际环境中被利用，因此评估结果为POC有效。漏洞利用代码中包含了一些用于发现目标的Shodan搜索方法和Google Dork，以及受影响的HTTP标题列表，这些信息可以帮助攻击者快速定位目标。该代码主要是信息收集和目标识别，未发现明显的恶意代码。但考虑到攻击者可能会利用这些信息进行大规模攻击，存在一定的投毒风险，评估结果为10%。利用方式主要通过构造恶意的SQL语句，通过HTTP/HTTPS协议发送到MOVEit Transfer Web应用程序，从而实现对数据库的未授权访问。

**项目地址:** [kenbuckler/MOVEit-CVE-2023-34362](https://github.com/kenbuckler/MOVEit-CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #9

**来源**: [CVE-2023-34362-lithuanian-g_cve-2023-34362-iocs.md](../2023/CVE-2023-34362-lithuanian-g_cve-2023-34362-iocs.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未经授权的数据库访问、数据泄露、远程代码执行

**影响版本:** 受影响版本包括2021.0.6 (13.0.6)之前、2021.1.4 (13.1.4)之前、2022.0.4 (14.0.4)之前、2022.1.5 (14.1.5)之前和2023.0.1 (15.0.1)之前的版本，以及所有早于这五个显式提及的版本的版本

**利用条件:** 无需身份验证，可通过HTTP或HTTPS利用

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-34362是MOVEit Transfer Web应用程序中发现的SQL注入漏洞。未经身份验证的攻击者可以利用此漏洞访问MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL、Microsoft SQL Server或Azure SQL），攻击者可能能够推断有关数据库结构和内容的信息，并执行SQL语句来更改或删除数据库元素。该漏洞已被野外利用。

**利用方式：**

攻击者通过构造恶意的SQL语句，利用MOVEit Transfer Web应用程序的漏洞点，绕过身份验证并执行恶意SQL代码。 这允许他们从数据库中提取敏感信息，修改数据库内容，甚至可能在服务器上执行任意命令。

**有效性评估：**

漏洞库信息和搜索结果均表明此漏洞的POC是有效的，并且已被积极利用。

**投毒风险分析：**

提供的漏洞利用代码`/tmp/855c1feeae0b1ef3a7668b43f388510c/cve-2023-34362-iocs.csv`实际上是一个IOC（Indicators of Compromise）列表，包含攻击者使用的文件路径、HTTP请求、IP地址、域名和哈希值。虽然此列表本身不包含恶意代码，但如果攻击者伪造或篡改IOC列表，并将其用于误导安全分析人员或安全设备，则可能存在投毒风险。 例如,攻击者可能提供大量的正常IP地址,来混淆真实的恶意IP地址，造成分析人员无法准确识别攻击来源。鉴于此IOC列表的性质和潜在的滥用方式，认为存在**20%**的投毒风险。


**项目地址:** [lithuanian-g/cve-2023-34362-iocs](https://github.com/lithuanian-g/cve-2023-34362-iocs)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #10

**来源**: [CVE-2023-34362-sfewer-r7_CVE-2023-34362.md](../2023/CVE-2023-34362-sfewer-r7_CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致数据库访问、数据泄露和远程代码执行

**影响版本:** 受影响版本：2021.0.6 (13.0.6)之前, 2021.1.4 (13.1.4)之前, 2022.0.4 (14.0.4)之前, 2022.1.5 (14.1.5)之前, and 2023.0.1 (15.0.1)之前的所有版本（包括2020.0和2019x以及更早的未支持版本）

**利用条件:** 需要网络访问MOVEit Transfer的web应用程序

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-34362 是 MOVEit Transfer 中的一个 SQL 注入漏洞，未经身份验证的攻击者可以通过该漏洞访问 MOVEit Transfer 的数据库。 根据使用的数据库引擎（MySQL、Microsoft SQL Server 或 Azure SQL），攻击者可能能够推断有关数据库结构和内容的信息，并执行 SQL 语句来更改或删除数据库元素。该漏洞在野外被积极利用。

**漏洞利用方式：**

1.  **SQL注入：** 攻击者利用SQL注入漏洞，向MOVEit Transfer Web应用程序发送特制的SQL查询，绕过身份验证并获得数据库访问权限。
2.  **信息泄露和数据库操作：** 成功利用SQL注入后，攻击者可以读取数据库内容、修改数据、甚至执行任意SQL命令。
3.  **远程代码执行：**  通过执行SQL语句，攻击者可能能够执行系统命令，从而实现远程代码执行。

**POC有效性：**

提供的POC代码看起来是有效的。它利用HTTParty库发送请求，并精心构造了带有SQL注入的Header，结合session变量设置绕过验证。代码目标明确，结构清晰，验证了未授权的RCE利用链。

**投毒风险：**

代码中存在轻微的投毒风险的可能性，但主要集中在以下几个方面：

*   **依赖项：** 代码依赖于httparty和openssl等ruby库。如果这些库本身被投毒，可能会影响漏洞利用的安全性。但这不是POC本身的问题。
*   **目标IP：**  POC代码中定义了TARGET常量，攻击者可能会修改此值，如果未经授权扫描或攻击目标，可能导致法律问题。
*   **远程代码执行的payload：** 目前，exp中硬编码的payload为启动`notepad.exe`，攻击者可以修改此payload以执行其他恶意操作。但这取决于使用exp的人。

风险评估：5%。 此百分比很低，因为代码本身主要关注于利用，而不是分发恶意软件或执行后门操作。主要风险在于使用者对payload的修改和目标的选择，与代码本身关系不大。

**项目地址:** [sfewer-r7/CVE-2023-34362](https://github.com/sfewer-r7/CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #11

**来源**: [CVE-2023-34362-toorandom_moveit-payload-decrypt-CVE-2023-34362.md](../2023/CVE-2023-34362-toorandom_moveit-payload-decrypt-CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致数据泄露、远程代码执行，以及被勒索软件利用

**影响版本:** 受影响版本包括但不限于2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), and 2023.0.1 (15.0.1)，以及所有早于上述五个版本的版本，包括不受支持的旧版本。

**利用条件:** 未授权的攻击者可以通过HTTP或HTTPS访问存在漏洞的MOVEit Transfer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34362是MOVEit Transfer中的一个SQL注入漏洞，允许未经身份验证的攻击者访问MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL、Microsoft SQL Server或Azure SQL），攻击者可能能够推断数据库的结构和内容，并执行SQL语句来修改或删除数据库元素。该漏洞在野外被积极利用，已被CL0P勒索软件团伙利用进行数据盗窃和勒索。

**漏洞利用方式：**

1.  **SQL注入：** 攻击者利用SQL注入漏洞，通过构造恶意的SQL语句，绕过身份验证或直接访问数据库。
2.  **数据访问：** 成功利用SQL注入后，攻击者可以读取数据库中的敏感数据，例如用户名、密码、API密钥等。
3.  **数据篡改/删除：** 攻击者可以执行SQL语句来修改或删除数据库中的数据，导致服务中断或数据损坏。
4.  **远程代码执行：** 在某些情况下，攻击者可能能够利用SQL注入执行操作系统命令，从而实现远程代码执行。

**POC有效性：**

提供的POC代码 (`moveit_payload_decrypt.sh`) 用于解密MOVEit Transfer日志中发现的base64编码的artifact，这与漏洞的利用方式密切相关。攻击者利用SQL注入获得加密payload后，需要使用该脚本来解密payload。 因此，它不是直接利用漏洞的EXP，而是漏洞利用链中的一个环节,用于解密有效载荷， 依赖于已经成功利用SQL注入。 该脚本需要OrgKey 0，该密钥存储在受影响实例的注册表项 `Microsoft/Standard Networks/siLock/Institutions/0` 中。脚本的功能是根据提供的OrgKey 0解析MOVEit日志中base64 artifact的头部并解密序列化的payload对象。

**投毒风险分析：**

查看代码，主要功能集中在payload的解析和解密上。该脚本本身需要从MOVEit服务器的注册表中提取OrgKey 0才能运行，因此投毒风险较低。 但是考虑到以下几点， 仍然存在一定的投毒风险：

1.  **依赖外部命令：** 脚本依赖于`base64`、`cut`、`dd`、`xxd`、`sed`、`openssl`等外部命令。如果这些命令被恶意替换，可能导致脚本执行恶意代码。但这种情况更偏向于系统层面的攻击，而非脚本本身的投毒。
2.  **代码可读性：** 代码相对简单，易于审计，但仍然存在一定的复杂性，可能隐藏不易察觉的漏洞或后门。
3.  **潜在的恶意修改：** 攻击者可能修改脚本，例如在解密后添加恶意代码，或者将解密后的数据发送到远程服务器。

基于以上分析，认为此仓库存在10%的投毒风险。主要风险在于脚本可能被修改或利用来执行恶意操作，而不是脚本本身包含明显的恶意代码。

**项目地址:** [toorandom/moveit-payload-decrypt-CVE-2023-34362](https://github.com/toorandom/moveit-payload-decrypt-CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---



---

## POC #8

**来源**: [CVE-2023-34362-kenbuckler_MOVEit-CVE-2023-34362.md](../2023/CVE-2023-34362-kenbuckler_MOVEit-CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未授权访问数据库，信息泄露，数据篡改或删除

**影响版本:** 受影响版本包括2021.0.6之前的所有版本，以及2021.1.4, 2022.0.4, 2022.1.5, 和 2023.0.1这些版本

**利用条件:** 未授权的攻击者通过HTTP或HTTPS协议访问存在漏洞的MOVEit Transfer Web应用程序

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34362是MOVEit Transfer Web应用程序中发现的一个SQL注入漏洞。未经身份验证的攻击者可以利用此漏洞访问MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL, Microsoft SQL Server或Azure SQL），攻击者可能能够推断数据库的结构和内容，并执行SQL语句来更改或删除数据库元素。由于该漏洞在实际环境中被利用，因此评估结果为POC有效。漏洞利用代码中包含了一些用于发现目标的Shodan搜索方法和Google Dork，以及受影响的HTTP标题列表，这些信息可以帮助攻击者快速定位目标。该代码主要是信息收集和目标识别，未发现明显的恶意代码。但考虑到攻击者可能会利用这些信息进行大规模攻击，存在一定的投毒风险，评估结果为10%。利用方式主要通过构造恶意的SQL语句，通过HTTP/HTTPS协议发送到MOVEit Transfer Web应用程序，从而实现对数据库的未授权访问。

**项目地址:** [kenbuckler/MOVEit-CVE-2023-34362](https://github.com/kenbuckler/MOVEit-CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #9

**来源**: [CVE-2023-34362-lithuanian-g_cve-2023-34362-iocs.md](../2023/CVE-2023-34362-lithuanian-g_cve-2023-34362-iocs.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未经授权的数据库访问、数据泄露、远程代码执行

**影响版本:** 受影响版本包括2021.0.6 (13.0.6)之前、2021.1.4 (13.1.4)之前、2022.0.4 (14.0.4)之前、2022.1.5 (14.1.5)之前和2023.0.1 (15.0.1)之前的版本，以及所有早于这五个显式提及的版本的版本

**利用条件:** 无需身份验证，可通过HTTP或HTTPS利用

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-34362是MOVEit Transfer Web应用程序中发现的SQL注入漏洞。未经身份验证的攻击者可以利用此漏洞访问MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL、Microsoft SQL Server或Azure SQL），攻击者可能能够推断有关数据库结构和内容的信息，并执行SQL语句来更改或删除数据库元素。该漏洞已被野外利用。

**利用方式：**

攻击者通过构造恶意的SQL语句，利用MOVEit Transfer Web应用程序的漏洞点，绕过身份验证并执行恶意SQL代码。 这允许他们从数据库中提取敏感信息，修改数据库内容，甚至可能在服务器上执行任意命令。

**有效性评估：**

漏洞库信息和搜索结果均表明此漏洞的POC是有效的，并且已被积极利用。

**投毒风险分析：**

提供的漏洞利用代码`/tmp/855c1feeae0b1ef3a7668b43f388510c/cve-2023-34362-iocs.csv`实际上是一个IOC（Indicators of Compromise）列表，包含攻击者使用的文件路径、HTTP请求、IP地址、域名和哈希值。虽然此列表本身不包含恶意代码，但如果攻击者伪造或篡改IOC列表，并将其用于误导安全分析人员或安全设备，则可能存在投毒风险。 例如,攻击者可能提供大量的正常IP地址,来混淆真实的恶意IP地址，造成分析人员无法准确识别攻击来源。鉴于此IOC列表的性质和潜在的滥用方式，认为存在**20%**的投毒风险。


**项目地址:** [lithuanian-g/cve-2023-34362-iocs](https://github.com/lithuanian-g/cve-2023-34362-iocs)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #10

**来源**: [CVE-2023-34362-sfewer-r7_CVE-2023-34362.md](../2023/CVE-2023-34362-sfewer-r7_CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致数据库访问、数据泄露和远程代码执行

**影响版本:** 受影响版本：2021.0.6 (13.0.6)之前, 2021.1.4 (13.1.4)之前, 2022.0.4 (14.0.4)之前, 2022.1.5 (14.1.5)之前, and 2023.0.1 (15.0.1)之前的所有版本（包括2020.0和2019x以及更早的未支持版本）

**利用条件:** 需要网络访问MOVEit Transfer的web应用程序

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-34362 是 MOVEit Transfer 中的一个 SQL 注入漏洞，未经身份验证的攻击者可以通过该漏洞访问 MOVEit Transfer 的数据库。 根据使用的数据库引擎（MySQL、Microsoft SQL Server 或 Azure SQL），攻击者可能能够推断有关数据库结构和内容的信息，并执行 SQL 语句来更改或删除数据库元素。该漏洞在野外被积极利用。

**漏洞利用方式：**

1.  **SQL注入：** 攻击者利用SQL注入漏洞，向MOVEit Transfer Web应用程序发送特制的SQL查询，绕过身份验证并获得数据库访问权限。
2.  **信息泄露和数据库操作：** 成功利用SQL注入后，攻击者可以读取数据库内容、修改数据、甚至执行任意SQL命令。
3.  **远程代码执行：**  通过执行SQL语句，攻击者可能能够执行系统命令，从而实现远程代码执行。

**POC有效性：**

提供的POC代码看起来是有效的。它利用HTTParty库发送请求，并精心构造了带有SQL注入的Header，结合session变量设置绕过验证。代码目标明确，结构清晰，验证了未授权的RCE利用链。

**投毒风险：**

代码中存在轻微的投毒风险的可能性，但主要集中在以下几个方面：

*   **依赖项：** 代码依赖于httparty和openssl等ruby库。如果这些库本身被投毒，可能会影响漏洞利用的安全性。但这不是POC本身的问题。
*   **目标IP：**  POC代码中定义了TARGET常量，攻击者可能会修改此值，如果未经授权扫描或攻击目标，可能导致法律问题。
*   **远程代码执行的payload：** 目前，exp中硬编码的payload为启动`notepad.exe`，攻击者可以修改此payload以执行其他恶意操作。但这取决于使用exp的人。

风险评估：5%。 此百分比很低，因为代码本身主要关注于利用，而不是分发恶意软件或执行后门操作。主要风险在于使用者对payload的修改和目标的选择，与代码本身关系不大。

**项目地址:** [sfewer-r7/CVE-2023-34362](https://github.com/sfewer-r7/CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #11

**来源**: [CVE-2023-34362-toorandom_moveit-payload-decrypt-CVE-2023-34362.md](../2023/CVE-2023-34362-toorandom_moveit-payload-decrypt-CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致数据泄露、远程代码执行，以及被勒索软件利用

**影响版本:** 受影响版本包括但不限于2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), and 2023.0.1 (15.0.1)，以及所有早于上述五个版本的版本，包括不受支持的旧版本。

**利用条件:** 未授权的攻击者可以通过HTTP或HTTPS访问存在漏洞的MOVEit Transfer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34362是MOVEit Transfer中的一个SQL注入漏洞，允许未经身份验证的攻击者访问MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL、Microsoft SQL Server或Azure SQL），攻击者可能能够推断数据库的结构和内容，并执行SQL语句来修改或删除数据库元素。该漏洞在野外被积极利用，已被CL0P勒索软件团伙利用进行数据盗窃和勒索。

**漏洞利用方式：**

1.  **SQL注入：** 攻击者利用SQL注入漏洞，通过构造恶意的SQL语句，绕过身份验证或直接访问数据库。
2.  **数据访问：** 成功利用SQL注入后，攻击者可以读取数据库中的敏感数据，例如用户名、密码、API密钥等。
3.  **数据篡改/删除：** 攻击者可以执行SQL语句来修改或删除数据库中的数据，导致服务中断或数据损坏。
4.  **远程代码执行：** 在某些情况下，攻击者可能能够利用SQL注入执行操作系统命令，从而实现远程代码执行。

**POC有效性：**

提供的POC代码 (`moveit_payload_decrypt.sh`) 用于解密MOVEit Transfer日志中发现的base64编码的artifact，这与漏洞的利用方式密切相关。攻击者利用SQL注入获得加密payload后，需要使用该脚本来解密payload。 因此，它不是直接利用漏洞的EXP，而是漏洞利用链中的一个环节,用于解密有效载荷， 依赖于已经成功利用SQL注入。 该脚本需要OrgKey 0，该密钥存储在受影响实例的注册表项 `Microsoft/Standard Networks/siLock/Institutions/0` 中。脚本的功能是根据提供的OrgKey 0解析MOVEit日志中base64 artifact的头部并解密序列化的payload对象。

**投毒风险分析：**

查看代码，主要功能集中在payload的解析和解密上。该脚本本身需要从MOVEit服务器的注册表中提取OrgKey 0才能运行，因此投毒风险较低。 但是考虑到以下几点， 仍然存在一定的投毒风险：

1.  **依赖外部命令：** 脚本依赖于`base64`、`cut`、`dd`、`xxd`、`sed`、`openssl`等外部命令。如果这些命令被恶意替换，可能导致脚本执行恶意代码。但这种情况更偏向于系统层面的攻击，而非脚本本身的投毒。
2.  **代码可读性：** 代码相对简单，易于审计，但仍然存在一定的复杂性，可能隐藏不易察觉的漏洞或后门。
3.  **潜在的恶意修改：** 攻击者可能修改脚本，例如在解密后添加恶意代码，或者将解密后的数据发送到远程服务器。

基于以上分析，认为此仓库存在10%的投毒风险。主要风险在于脚本可能被修改或利用来执行恶意操作，而不是脚本本身包含明显的恶意代码。

**项目地址:** [toorandom/moveit-payload-decrypt-CVE-2023-34362](https://github.com/toorandom/moveit-payload-decrypt-CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---



---

## POC #8

**来源**: [CVE-2023-34362-kenbuckler_MOVEit-CVE-2023-34362.md](../2023/CVE-2023-34362-kenbuckler_MOVEit-CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未授权访问数据库，信息泄露，数据篡改或删除

**影响版本:** 受影响版本包括2021.0.6之前的所有版本，以及2021.1.4, 2022.0.4, 2022.1.5, 和 2023.0.1这些版本

**利用条件:** 未授权的攻击者通过HTTP或HTTPS协议访问存在漏洞的MOVEit Transfer Web应用程序

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34362是MOVEit Transfer Web应用程序中发现的一个SQL注入漏洞。未经身份验证的攻击者可以利用此漏洞访问MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL, Microsoft SQL Server或Azure SQL），攻击者可能能够推断数据库的结构和内容，并执行SQL语句来更改或删除数据库元素。由于该漏洞在实际环境中被利用，因此评估结果为POC有效。漏洞利用代码中包含了一些用于发现目标的Shodan搜索方法和Google Dork，以及受影响的HTTP标题列表，这些信息可以帮助攻击者快速定位目标。该代码主要是信息收集和目标识别，未发现明显的恶意代码。但考虑到攻击者可能会利用这些信息进行大规模攻击，存在一定的投毒风险，评估结果为10%。利用方式主要通过构造恶意的SQL语句，通过HTTP/HTTPS协议发送到MOVEit Transfer Web应用程序，从而实现对数据库的未授权访问。

**项目地址:** [kenbuckler/MOVEit-CVE-2023-34362](https://github.com/kenbuckler/MOVEit-CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #9

**来源**: [CVE-2023-34362-lithuanian-g_cve-2023-34362-iocs.md](../2023/CVE-2023-34362-lithuanian-g_cve-2023-34362-iocs.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未经授权的数据库访问、数据泄露、远程代码执行

**影响版本:** 受影响版本包括2021.0.6 (13.0.6)之前、2021.1.4 (13.1.4)之前、2022.0.4 (14.0.4)之前、2022.1.5 (14.1.5)之前和2023.0.1 (15.0.1)之前的版本，以及所有早于这五个显式提及的版本的版本

**利用条件:** 无需身份验证，可通过HTTP或HTTPS利用

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-34362是MOVEit Transfer Web应用程序中发现的SQL注入漏洞。未经身份验证的攻击者可以利用此漏洞访问MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL、Microsoft SQL Server或Azure SQL），攻击者可能能够推断有关数据库结构和内容的信息，并执行SQL语句来更改或删除数据库元素。该漏洞已被野外利用。

**利用方式：**

攻击者通过构造恶意的SQL语句，利用MOVEit Transfer Web应用程序的漏洞点，绕过身份验证并执行恶意SQL代码。 这允许他们从数据库中提取敏感信息，修改数据库内容，甚至可能在服务器上执行任意命令。

**有效性评估：**

漏洞库信息和搜索结果均表明此漏洞的POC是有效的，并且已被积极利用。

**投毒风险分析：**

提供的漏洞利用代码`/tmp/855c1feeae0b1ef3a7668b43f388510c/cve-2023-34362-iocs.csv`实际上是一个IOC（Indicators of Compromise）列表，包含攻击者使用的文件路径、HTTP请求、IP地址、域名和哈希值。虽然此列表本身不包含恶意代码，但如果攻击者伪造或篡改IOC列表，并将其用于误导安全分析人员或安全设备，则可能存在投毒风险。 例如,攻击者可能提供大量的正常IP地址,来混淆真实的恶意IP地址，造成分析人员无法准确识别攻击来源。鉴于此IOC列表的性质和潜在的滥用方式，认为存在**20%**的投毒风险。


**项目地址:** [lithuanian-g/cve-2023-34362-iocs](https://github.com/lithuanian-g/cve-2023-34362-iocs)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #10

**来源**: [CVE-2023-34362-sfewer-r7_CVE-2023-34362.md](../2023/CVE-2023-34362-sfewer-r7_CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致数据库访问、数据泄露和远程代码执行

**影响版本:** 受影响版本：2021.0.6 (13.0.6)之前, 2021.1.4 (13.1.4)之前, 2022.0.4 (14.0.4)之前, 2022.1.5 (14.1.5)之前, and 2023.0.1 (15.0.1)之前的所有版本（包括2020.0和2019x以及更早的未支持版本）

**利用条件:** 需要网络访问MOVEit Transfer的web应用程序

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-34362 是 MOVEit Transfer 中的一个 SQL 注入漏洞，未经身份验证的攻击者可以通过该漏洞访问 MOVEit Transfer 的数据库。 根据使用的数据库引擎（MySQL、Microsoft SQL Server 或 Azure SQL），攻击者可能能够推断有关数据库结构和内容的信息，并执行 SQL 语句来更改或删除数据库元素。该漏洞在野外被积极利用。

**漏洞利用方式：**

1.  **SQL注入：** 攻击者利用SQL注入漏洞，向MOVEit Transfer Web应用程序发送特制的SQL查询，绕过身份验证并获得数据库访问权限。
2.  **信息泄露和数据库操作：** 成功利用SQL注入后，攻击者可以读取数据库内容、修改数据、甚至执行任意SQL命令。
3.  **远程代码执行：**  通过执行SQL语句，攻击者可能能够执行系统命令，从而实现远程代码执行。

**POC有效性：**

提供的POC代码看起来是有效的。它利用HTTParty库发送请求，并精心构造了带有SQL注入的Header，结合session变量设置绕过验证。代码目标明确，结构清晰，验证了未授权的RCE利用链。

**投毒风险：**

代码中存在轻微的投毒风险的可能性，但主要集中在以下几个方面：

*   **依赖项：** 代码依赖于httparty和openssl等ruby库。如果这些库本身被投毒，可能会影响漏洞利用的安全性。但这不是POC本身的问题。
*   **目标IP：**  POC代码中定义了TARGET常量，攻击者可能会修改此值，如果未经授权扫描或攻击目标，可能导致法律问题。
*   **远程代码执行的payload：** 目前，exp中硬编码的payload为启动`notepad.exe`，攻击者可以修改此payload以执行其他恶意操作。但这取决于使用exp的人。

风险评估：5%。 此百分比很低，因为代码本身主要关注于利用，而不是分发恶意软件或执行后门操作。主要风险在于使用者对payload的修改和目标的选择，与代码本身关系不大。

**项目地址:** [sfewer-r7/CVE-2023-34362](https://github.com/sfewer-r7/CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #11

**来源**: [CVE-2023-34362-toorandom_moveit-payload-decrypt-CVE-2023-34362.md](../2023/CVE-2023-34362-toorandom_moveit-payload-decrypt-CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致数据泄露、远程代码执行，以及被勒索软件利用

**影响版本:** 受影响版本包括但不限于2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), and 2023.0.1 (15.0.1)，以及所有早于上述五个版本的版本，包括不受支持的旧版本。

**利用条件:** 未授权的攻击者可以通过HTTP或HTTPS访问存在漏洞的MOVEit Transfer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34362是MOVEit Transfer中的一个SQL注入漏洞，允许未经身份验证的攻击者访问MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL、Microsoft SQL Server或Azure SQL），攻击者可能能够推断数据库的结构和内容，并执行SQL语句来修改或删除数据库元素。该漏洞在野外被积极利用，已被CL0P勒索软件团伙利用进行数据盗窃和勒索。

**漏洞利用方式：**

1.  **SQL注入：** 攻击者利用SQL注入漏洞，通过构造恶意的SQL语句，绕过身份验证或直接访问数据库。
2.  **数据访问：** 成功利用SQL注入后，攻击者可以读取数据库中的敏感数据，例如用户名、密码、API密钥等。
3.  **数据篡改/删除：** 攻击者可以执行SQL语句来修改或删除数据库中的数据，导致服务中断或数据损坏。
4.  **远程代码执行：** 在某些情况下，攻击者可能能够利用SQL注入执行操作系统命令，从而实现远程代码执行。

**POC有效性：**

提供的POC代码 (`moveit_payload_decrypt.sh`) 用于解密MOVEit Transfer日志中发现的base64编码的artifact，这与漏洞的利用方式密切相关。攻击者利用SQL注入获得加密payload后，需要使用该脚本来解密payload。 因此，它不是直接利用漏洞的EXP，而是漏洞利用链中的一个环节,用于解密有效载荷， 依赖于已经成功利用SQL注入。 该脚本需要OrgKey 0，该密钥存储在受影响实例的注册表项 `Microsoft/Standard Networks/siLock/Institutions/0` 中。脚本的功能是根据提供的OrgKey 0解析MOVEit日志中base64 artifact的头部并解密序列化的payload对象。

**投毒风险分析：**

查看代码，主要功能集中在payload的解析和解密上。该脚本本身需要从MOVEit服务器的注册表中提取OrgKey 0才能运行，因此投毒风险较低。 但是考虑到以下几点， 仍然存在一定的投毒风险：

1.  **依赖外部命令：** 脚本依赖于`base64`、`cut`、`dd`、`xxd`、`sed`、`openssl`等外部命令。如果这些命令被恶意替换，可能导致脚本执行恶意代码。但这种情况更偏向于系统层面的攻击，而非脚本本身的投毒。
2.  **代码可读性：** 代码相对简单，易于审计，但仍然存在一定的复杂性，可能隐藏不易察觉的漏洞或后门。
3.  **潜在的恶意修改：** 攻击者可能修改脚本，例如在解密后添加恶意代码，或者将解密后的数据发送到远程服务器。

基于以上分析，认为此仓库存在10%的投毒风险。主要风险在于脚本可能被修改或利用来执行恶意操作，而不是脚本本身包含明显的恶意代码。

**项目地址:** [toorandom/moveit-payload-decrypt-CVE-2023-34362](https://github.com/toorandom/moveit-payload-decrypt-CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---



---

## POC #8

**来源**: [CVE-2023-34362-kenbuckler_MOVEit-CVE-2023-34362.md](../2023/CVE-2023-34362-kenbuckler_MOVEit-CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未授权访问数据库，信息泄露，数据篡改或删除

**影响版本:** 受影响版本包括2021.0.6之前的所有版本，以及2021.1.4, 2022.0.4, 2022.1.5, 和 2023.0.1这些版本

**利用条件:** 未授权的攻击者通过HTTP或HTTPS协议访问存在漏洞的MOVEit Transfer Web应用程序

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34362是MOVEit Transfer Web应用程序中发现的一个SQL注入漏洞。未经身份验证的攻击者可以利用此漏洞访问MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL, Microsoft SQL Server或Azure SQL），攻击者可能能够推断数据库的结构和内容，并执行SQL语句来更改或删除数据库元素。由于该漏洞在实际环境中被利用，因此评估结果为POC有效。漏洞利用代码中包含了一些用于发现目标的Shodan搜索方法和Google Dork，以及受影响的HTTP标题列表，这些信息可以帮助攻击者快速定位目标。该代码主要是信息收集和目标识别，未发现明显的恶意代码。但考虑到攻击者可能会利用这些信息进行大规模攻击，存在一定的投毒风险，评估结果为10%。利用方式主要通过构造恶意的SQL语句，通过HTTP/HTTPS协议发送到MOVEit Transfer Web应用程序，从而实现对数据库的未授权访问。

**项目地址:** [kenbuckler/MOVEit-CVE-2023-34362](https://github.com/kenbuckler/MOVEit-CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #9

**来源**: [CVE-2023-34362-lithuanian-g_cve-2023-34362-iocs.md](../2023/CVE-2023-34362-lithuanian-g_cve-2023-34362-iocs.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未经授权的数据库访问、数据泄露、远程代码执行

**影响版本:** 受影响版本包括2021.0.6 (13.0.6)之前、2021.1.4 (13.1.4)之前、2022.0.4 (14.0.4)之前、2022.1.5 (14.1.5)之前和2023.0.1 (15.0.1)之前的版本，以及所有早于这五个显式提及的版本的版本

**利用条件:** 无需身份验证，可通过HTTP或HTTPS利用

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-34362是MOVEit Transfer Web应用程序中发现的SQL注入漏洞。未经身份验证的攻击者可以利用此漏洞访问MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL、Microsoft SQL Server或Azure SQL），攻击者可能能够推断有关数据库结构和内容的信息，并执行SQL语句来更改或删除数据库元素。该漏洞已被野外利用。

**利用方式：**

攻击者通过构造恶意的SQL语句，利用MOVEit Transfer Web应用程序的漏洞点，绕过身份验证并执行恶意SQL代码。 这允许他们从数据库中提取敏感信息，修改数据库内容，甚至可能在服务器上执行任意命令。

**有效性评估：**

漏洞库信息和搜索结果均表明此漏洞的POC是有效的，并且已被积极利用。

**投毒风险分析：**

提供的漏洞利用代码`/tmp/855c1feeae0b1ef3a7668b43f388510c/cve-2023-34362-iocs.csv`实际上是一个IOC（Indicators of Compromise）列表，包含攻击者使用的文件路径、HTTP请求、IP地址、域名和哈希值。虽然此列表本身不包含恶意代码，但如果攻击者伪造或篡改IOC列表，并将其用于误导安全分析人员或安全设备，则可能存在投毒风险。 例如,攻击者可能提供大量的正常IP地址,来混淆真实的恶意IP地址，造成分析人员无法准确识别攻击来源。鉴于此IOC列表的性质和潜在的滥用方式，认为存在**20%**的投毒风险。


**项目地址:** [lithuanian-g/cve-2023-34362-iocs](https://github.com/lithuanian-g/cve-2023-34362-iocs)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #10

**来源**: [CVE-2023-34362-sfewer-r7_CVE-2023-34362.md](../2023/CVE-2023-34362-sfewer-r7_CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致数据库访问、数据泄露和远程代码执行

**影响版本:** 受影响版本：2021.0.6 (13.0.6)之前, 2021.1.4 (13.1.4)之前, 2022.0.4 (14.0.4)之前, 2022.1.5 (14.1.5)之前, and 2023.0.1 (15.0.1)之前的所有版本（包括2020.0和2019x以及更早的未支持版本）

**利用条件:** 需要网络访问MOVEit Transfer的web应用程序

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-34362 是 MOVEit Transfer 中的一个 SQL 注入漏洞，未经身份验证的攻击者可以通过该漏洞访问 MOVEit Transfer 的数据库。 根据使用的数据库引擎（MySQL、Microsoft SQL Server 或 Azure SQL），攻击者可能能够推断有关数据库结构和内容的信息，并执行 SQL 语句来更改或删除数据库元素。该漏洞在野外被积极利用。

**漏洞利用方式：**

1.  **SQL注入：** 攻击者利用SQL注入漏洞，向MOVEit Transfer Web应用程序发送特制的SQL查询，绕过身份验证并获得数据库访问权限。
2.  **信息泄露和数据库操作：** 成功利用SQL注入后，攻击者可以读取数据库内容、修改数据、甚至执行任意SQL命令。
3.  **远程代码执行：**  通过执行SQL语句，攻击者可能能够执行系统命令，从而实现远程代码执行。

**POC有效性：**

提供的POC代码看起来是有效的。它利用HTTParty库发送请求，并精心构造了带有SQL注入的Header，结合session变量设置绕过验证。代码目标明确，结构清晰，验证了未授权的RCE利用链。

**投毒风险：**

代码中存在轻微的投毒风险的可能性，但主要集中在以下几个方面：

*   **依赖项：** 代码依赖于httparty和openssl等ruby库。如果这些库本身被投毒，可能会影响漏洞利用的安全性。但这不是POC本身的问题。
*   **目标IP：**  POC代码中定义了TARGET常量，攻击者可能会修改此值，如果未经授权扫描或攻击目标，可能导致法律问题。
*   **远程代码执行的payload：** 目前，exp中硬编码的payload为启动`notepad.exe`，攻击者可以修改此payload以执行其他恶意操作。但这取决于使用exp的人。

风险评估：5%。 此百分比很低，因为代码本身主要关注于利用，而不是分发恶意软件或执行后门操作。主要风险在于使用者对payload的修改和目标的选择，与代码本身关系不大。

**项目地址:** [sfewer-r7/CVE-2023-34362](https://github.com/sfewer-r7/CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

## POC #11

**来源**: [CVE-2023-34362-toorandom_moveit-payload-decrypt-CVE-2023-34362.md](../2023/CVE-2023-34362-toorandom_moveit-payload-decrypt-CVE-2023-34362.md)

## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致数据泄露、远程代码执行，以及被勒索软件利用

**影响版本:** 受影响版本包括但不限于2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), and 2023.0.1 (15.0.1)，以及所有早于上述五个版本的版本，包括不受支持的旧版本。

**利用条件:** 未授权的攻击者可以通过HTTP或HTTPS访问存在漏洞的MOVEit Transfer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34362是MOVEit Transfer中的一个SQL注入漏洞，允许未经身份验证的攻击者访问MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL、Microsoft SQL Server或Azure SQL），攻击者可能能够推断数据库的结构和内容，并执行SQL语句来修改或删除数据库元素。该漏洞在野外被积极利用，已被CL0P勒索软件团伙利用进行数据盗窃和勒索。

**漏洞利用方式：**

1.  **SQL注入：** 攻击者利用SQL注入漏洞，通过构造恶意的SQL语句，绕过身份验证或直接访问数据库。
2.  **数据访问：** 成功利用SQL注入后，攻击者可以读取数据库中的敏感数据，例如用户名、密码、API密钥等。
3.  **数据篡改/删除：** 攻击者可以执行SQL语句来修改或删除数据库中的数据，导致服务中断或数据损坏。
4.  **远程代码执行：** 在某些情况下，攻击者可能能够利用SQL注入执行操作系统命令，从而实现远程代码执行。

**POC有效性：**

提供的POC代码 (`moveit_payload_decrypt.sh`) 用于解密MOVEit Transfer日志中发现的base64编码的artifact，这与漏洞的利用方式密切相关。攻击者利用SQL注入获得加密payload后，需要使用该脚本来解密payload。 因此，它不是直接利用漏洞的EXP，而是漏洞利用链中的一个环节,用于解密有效载荷， 依赖于已经成功利用SQL注入。 该脚本需要OrgKey 0，该密钥存储在受影响实例的注册表项 `Microsoft/Standard Networks/siLock/Institutions/0` 中。脚本的功能是根据提供的OrgKey 0解析MOVEit日志中base64 artifact的头部并解密序列化的payload对象。

**投毒风险分析：**

查看代码，主要功能集中在payload的解析和解密上。该脚本本身需要从MOVEit服务器的注册表中提取OrgKey 0才能运行，因此投毒风险较低。 但是考虑到以下几点， 仍然存在一定的投毒风险：

1.  **依赖外部命令：** 脚本依赖于`base64`、`cut`、`dd`、`xxd`、`sed`、`openssl`等外部命令。如果这些命令被恶意替换，可能导致脚本执行恶意代码。但这种情况更偏向于系统层面的攻击，而非脚本本身的投毒。
2.  **代码可读性：** 代码相对简单，易于审计，但仍然存在一定的复杂性，可能隐藏不易察觉的漏洞或后门。
3.  **潜在的恶意修改：** 攻击者可能修改脚本，例如在解密后添加恶意代码，或者将解密后的数据发送到远程服务器。

基于以上分析，认为此仓库存在10%的投毒风险。主要风险在于脚本可能被修改或利用来执行恶意操作，而不是脚本本身包含明显的恶意代码。

**项目地址:** [toorandom/moveit-payload-decrypt-CVE-2023-34362](https://github.com/toorandom/moveit-payload-decrypt-CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)

---

