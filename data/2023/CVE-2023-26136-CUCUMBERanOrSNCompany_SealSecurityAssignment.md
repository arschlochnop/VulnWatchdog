# CVE-2023-26136

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-26136-CUCUMBERanOrSNCompany_SealSecurityAssignment.md](../2023/CVE-2023-26136-CUCUMBERanOrSNCompany_SealSecurityAssignment.md)

# CVE-2023-26136

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-26136-CUCUMBERanOrSNCompany_SealSecurityAssignment.md](../2023/CVE-2023-26136-CUCUMBERanOrSNCompany_SealSecurityAssignment.md)

# CVE-2023-26136

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-26136-CUCUMBERanOrSNCompany_SealSecurityAssignment.md](../2023/CVE-2023-26136-CUCUMBERanOrSNCompany_SealSecurityAssignment.md)

# CVE-2023-26136

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-26136-CUCUMBERanOrSNCompany_SealSecurityAssignment.md](../2023/CVE-2023-26136-CUCUMBERanOrSNCompany_SealSecurityAssignment.md)

# CVE-2023-26136

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-26136-CUCUMBERanOrSNCompany_SealSecurityAssignment.md](../2023/CVE-2023-26136-CUCUMBERanOrSNCompany_SealSecurityAssignment.md)

# CVE-2023-26136

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-26136-CUCUMBERanOrSNCompany_SealSecurityAssignment.md](../2023/CVE-2023-26136-CUCUMBERanOrSNCompany_SealSecurityAssignment.md)

# CVE-2023-26136

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-26136-CUCUMBERanOrSNCompany_SealSecurityAssignment.md](../2023/CVE-2023-26136-CUCUMBERanOrSNCompany_SealSecurityAssignment.md)

# CVE-2023-26136

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-26136-CUCUMBERanOrSNCompany_SealSecurityAssignment.md](../2023/CVE-2023-26136-CUCUMBERanOrSNCompany_SealSecurityAssignment.md)

# CVE-2023-26136

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-26136-CUCUMBERanOrSNCompany_SealSecurityAssignment.md](../2023/CVE-2023-26136-CUCUMBERanOrSNCompany_SealSecurityAssignment.md)

# CVE-2023-26136

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-26136-CUCUMBERanOrSNCompany_SealSecurityAssignment.md](../2023/CVE-2023-26136-CUCUMBERanOrSNCompany_SealSecurityAssignment.md)

# CVE-2023-26136

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-26136-dani33339_Tough-Cookie-v2.5.0-Patched.md](../2023/CVE-2023-26136-dani33339_Tough-Cookie-v2.5.0-Patched.md)

## CVE-2023-26136-tough-cookie-Prototype Pollution

**漏洞编号:** CVE-2023-26136

**漏洞类型:** Prototype Pollution

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致权限提升和拒绝服务

**影响版本:** < 4.1.3

**利用条件:** 需要CookieJar使用rejectPublicSuffixes=false模式

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包中的一个原型污染漏洞，影响版本低于4.1.3。当CookieJar以`rejectPublicSuffixes=false`模式使用时，由于对Cookie处理不当，可能导致原型污染。具体来说，如果`cookie.domain`被设置为`__proto__`，攻击者可以修改`Object.prototype`，从而影响整个应用程序的行为。根据漏洞信息，该漏洞的CVSS评分为6.5，属于中危漏洞。搜索结果确认了漏洞的存在以及受影响的版本。提供的漏洞利用代码包括Dockerfile、LICENSE和README.md。README.md描述了漏洞和修复方案，以及安装patched版本的说明。Dockerfile用于构建包含易受攻击或修复后的tough-cookie版本的环境。LICENSE是MIT许可证。 

**有效性：**
根据README.md的描述，以及漏洞库信息和搜索结果，该漏洞确实存在并且可以被利用。

**投毒风险：**
检查提供的文件，主要风险点在于Dockerfile。虽然Dockerfile包含了一些常见的操作，例如安装vim和创建用户，但没有发现明显的恶意代码或后门。然而，`chmod -R a+w /usr/local/lib/node_modules`和`chmod -R a+w /usr/local/bin`这两条命令将给予所有用户对node_modules和/usr/local/bin的写权限，这可能被利用来安装恶意模块或者替换系统命令，从而实现投毒。LICENSE文件和README文件本身没有明显的投毒风险。因此，存在一定的投毒风险，但不是非常高，大概10%的风险。

**利用方式：**
利用方式是通过设置`cookie.domain`为`__proto__`来修改`Object.prototype`，进而影响使用tough-cookie的应用程序的行为。需要注意的是，利用需要应用程序配置`rejectPublicSuffixes=false`。攻击者可以通过发送包含特制Cookie的HTTP请求来触发该漏洞。攻击成功后，攻击者可以修改JavaScript对象的默认属性，从而导致权限提升、信息泄露或拒绝服务。

**项目地址:** [dani33339/Tough-Cookie-v2.5.0-Patched](https://github.com/dani33339/Tough-Cookie-v2.5.0-Patched)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #2

**来源**: [CVE-2023-26136-guy2610_tough-cookie-patch-cve-2023-26136.md](../2023/CVE-2023-26136-guy2610_tough-cookie-patch-cve-2023-26136.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或客户端代码执行

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar，并且rejectPublicSuffixes=false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包中的一个原型污染漏洞，影响4.1.3之前的版本。该漏洞是由于在使用CookieJar时，对Cookie的处理不当造成的，特别是当`rejectPublicSuffixes`设置为`false`时。攻击者可以通过构造恶意的Cookie，污染JavaScript对象的原型，从而影响应用程序的行为。虽然漏洞描述中提到影响的是客户端，但是如果服务器端也使用了存在漏洞的tough-cookie版本，并且依赖于受污染的原型属性，那么也可能受到影响。

**有效性：**
漏洞库信息和搜索引擎结果都确认了漏洞的存在，并且提供了commit信息，说明该漏洞已被修复。给出的Dockerfile和代码片段是tough-cookie仓库的代码，包括Dockerfile、LICENSE和README.md。这些文件本身不是漏洞利用代码，而是构建和描述该库的文件。

**投毒风险：**
提供的Dockerfile在构建过程中，修改了`/usr/local/lib/node_modules`和`/usr/local/bin`的权限，允许`cookie`用户写入。虽然这本身不是投毒行为，但如果构建环境或后续使用中存在其他漏洞，攻击者可能利用这些宽松的权限进行投毒，例如通过npm安装恶意依赖。因此，存在一定的投毒风险，但是从提供的代码片段来看，直接投毒的可能性较低，估计为10%。

**利用方式：**
1.  **条件：** 需要应用程序使用`tough-cookie`库的受影响版本（小于4.1.3），并且在创建`CookieJar`实例时，设置`rejectPublicSuffixes`为`false`。
2.  **攻击步骤：** 攻击者构造一个包含恶意属性的Cookie，例如`__proto__.polluted = true`。将此Cookie发送到服务器或客户端。
3.  **结果：** `Object.prototype`会被污染，所有JavaScript对象都会继承`polluted`属性，这可能会导致意外的行为或安全问题。
4. **修复方式：** 更新`tough-cookie`到4.1.3或更高版本。避免设置`rejectPublicSuffixes`为`false`。


**项目地址:** [guy2610/tough-cookie-patch-cve-2023-26136](https://github.com/guy2610/tough-cookie-patch-cve-2023-26136)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #3

**来源**: [CVE-2023-26136-m-lito13_SealSecurity_Exam.md](../2023/CVE-2023-26136-m-lito13_SealSecurity_Exam.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或权限提升

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar且rejectPublicSuffixes=false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包在4.1.3版本之前的原型污染漏洞。当使用CookieJar且`rejectPublicSuffixes=false`时，由于对Cookie处理不当，攻击者可以通过构造恶意的Cookie，例如将Cookie的Domain设置为`__proto__`，从而污染JavaScript对象的原型，影响所有继承该原型的对象。

**有效性：**
提供的POC代码展示了如何利用URL查询参数或者直接设置Cookie的Domain为`__proto__`来污染原型。代码中还提供了修复方案，即在初始化对象时使用`Object.create(null)`，创建一个没有原型的空对象，以防止原型污染。

**投毒风险：**
该仓库中可能存在投毒代码。`changes.diff` 文件中虽然包含了修复漏洞的补丁，但是攻击者可能在提交修复补丁的同时，添加一些不易察觉的恶意代码，例如在其他文件中添加后门，或者修改构建脚本引入恶意依赖。评估投毒风险为10%，主要是因为该仓库看起来是一个学习/演示项目，而非实际的发布包，投毒的动机相对较低。需要仔细审查代码变更，特别是构建和依赖管理部分，才能确定是否存在恶意代码。

**利用方式：**
1.  **构造恶意URL：** 攻击者可以构造包含`__proto__`属性的URL，例如`https://vulnerable-website.com/?__proto__[badProperty]=payload`，当URL解析器处理该URL时，会将`badProperty`添加到所有对象的原型链上。
2.  **设置恶意Cookie：**  攻击者可以设置Cookie的Domain为`__proto__`，并设置相应的属性值。当`tough-cookie`处理该Cookie时，会将属性添加到所有对象的原型链上。示例代码如下：

```javascript
cookiejar.setCookie("Slonser=polluted; Domain=__proto__; Path=/notauth", "https://__proto__/admin", { loose: true }, (err, cookie) => {})
```

**影响：**
成功利用此漏洞后，攻击者可以修改全局对象的属性，从而影响整个应用程序的行为。例如，可以修改内置对象的属性，导致程序崩溃或执行恶意代码。在某些情况下，攻击者还可以利用原型污染漏洞实现权限提升。

**项目地址:** [m-lito13/SealSecurity_Exam](https://github.com/m-lito13/SealSecurity_Exam)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #4

**来源**: [CVE-2023-26136-morrisel_CVE-2023-26136.md](../2023/CVE-2023-26136-morrisel_CVE-2023-26136.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致应用配置被篡改，甚至远程代码执行，取决于应用如何使用受污染的原型

**影响版本:** < 4.1.3

**利用条件:** 需要在使用 tough-cookie 的应用中，CookieJar 的 rejectPublicSuffixes 设置为 false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136 是 tough-cookie 包版本低于 4.1.3 的原型污染漏洞。当 CookieJar 的 rejectPublicSuffixes 设置为 false 时，由于不正确地处理 Cookie，导致原型污染。漏洞出现在对象的初始化方式上。

**有效性：**
提供的 POC 代码通过修改 `memstore.js` 文件，将 `this.idx = {};` 替换为 `this.idx = Object.create(null);` 来修复该漏洞。原始版本在特定配置下确实存在原型污染的风险，而修改后的版本避免了从 `Object.prototype` 继承属性，从而阻止了原型污染。根据提供的 `index.js` 中的测试脚本显示，原始版本会被成功利用（`EXPLOITED SUCCESSFULLY`），而修复后的版本利用会失败（`EXPLOIT FAILED`），验证了 POC 的有效性。

**投毒风险：**
代码库中可能存在投毒风险。虽然主要的修改是为了修复原型污染漏洞，但是仍然存在一些小的风险。

*   **非必要文件：**`README.md`中存在作者信息,增加了溯源的可能性,降低了攻击者匿名性,正常漏洞仓库中不应存在作者信息.
*   **测试代码：** 测试代码中可能存在后门，或者可能被修改为包含恶意行为。

综合考虑，代码库中存在潜在投毒代码的风险较低，约为10%。

**利用方式：**
1.  **漏洞前提：** 应用使用了受影响版本的 `tough-cookie`，并且 `CookieJar` 的 `rejectPublicSuffixes` 设置为 `false`。
2.  **攻击方式：** 攻击者通过构造包含恶意属性的 Cookie，例如 `__proto__.polluted = 'evil'`，并将其注入到 CookieJar 中。
3.  **漏洞结果：** 由于 `tough-cookie` 在初始化对象时存在缺陷，恶意属性会被添加到 `Object.prototype` 上，从而污染了整个 JavaScript 应用的原型链。攻击者可以通过污染原型链来修改应用的行为，例如修改全局配置、注入恶意代码等。具体危害取决于应用如何使用受污染的原型，严重情况下可能导致远程代码执行。
4.  **修复方式：** 使用 `Object.create(null)` 创建对象，避免从 `Object.prototype` 继承属性。

**项目地址:** [morrisel/CVE-2023-26136](https://github.com/morrisel/CVE-2023-26136)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #5

**来源**: [CVE-2023-26136-ronmadar_Open-Source-Seal-Security.md](../2023/CVE-2023-26136-ronmadar_Open-Source-Seal-Security.md)

## CVE-2023-26136-tough-cookie-Prototype污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** Prototype Pollution

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或篡改应用行为

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar，并且rejectPublicSuffixes设置为false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包在4.1.3版本之前存在的一个原型污染漏洞。当使用CookieJar且rejectPublicSuffixes=false时，由于对Cookie处理不当，可能导致原型污染。

**有效性评估：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的。多个来源确认了此漏洞的存在，并提供了修复方案。

**利用方式：**
攻击者可以通过构造恶意的cookie，特别是当cookie的domain设置为`__proto__`时，利用`tough-cookie`库在处理cookie时，向Object.prototype注入恶意属性。由于JavaScript中所有对象都继承自Object.prototype，这会影响应用程序的全局状态，可能导致：

*   **拒绝服务 (DoS):** 通过注入导致异常或无限循环的属性。
*   **篡改应用行为:** 通过注入改变应用程序逻辑的关键属性，影响其行为。

提供的代码尝试通过设置特定的cookie来触发原型污染。`index.js` 脚本的逻辑是创建一个cookie jar，然后尝试设置一个具有特定属性的cookie。`vulnerable`变量控制是否禁用`rejectPublicSuffixes`。如果设置为true，则模拟易受攻击的情况。

**投毒风险评估：**
提供的代码主要包含以下文件：
*   `README.md`: 漏洞描述、修复方案和项目说明。
*   `index.js`: 包含原型污染漏洞的验证代码
    * `test-unit.js`: 测试用例，用于验证修复方案。
    * `testVerifyVulnerable.js`: 测试脚本，用于验证漏洞修复后的行为。

综合评估来看，投毒风险较低。风险点在于 `index.js` 是否存在后门代码，但分析内容可知，该文件主要是漏洞验证代码，不存在恶意行为。

**分析：** 该漏洞利用了JavaScript原型链的特性。通过原型污染，攻击者可以影响所有JavaScript对象的行为。修复此漏洞的关键在于防止在处理cookie时直接操作`Object.prototype`。snyk提供的链接指向的修复方案表明，该漏洞是通过不安全的对象递归合并以及通过路径定义属性造成的。该代码提供了一个简单的原型污染验证，在实际利用中，攻击者可能需要更精细地构造cookie，以便产生更大的影响。

**项目地址:** [ronmadar/Open-Source-Seal-Security](https://github.com/ronmadar/Open-Source-Seal-Security)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #6

**来源**: [CVE-2023-26136-uriyahav_tough-cookie-2.5.0-cve-2023-26136-fix.md](../2023/CVE-2023-26136-uriyahav_tough-cookie-2.5.0-cve-2023-26136-fix.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致应用程序行为被篡改，甚至造成拒绝服务

**影响版本:** < 4.1.3

**利用条件:** 需要应用程序使用受影响版本的tough-cookie，并且在rejectPublicSuffixes=false的模式下使用CookieJar。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-26136是tough-cookie库中一个原型污染漏洞。当CookieJar在rejectPublicSuffixes=false模式下处理Cookie时，由于对象初始化不当导致。攻击者可以通过设置具有恶意域（例如`__proto__`）的cookie来污染`Object.prototype`，从而影响所有继承自该原型的对象。

**有效性分析：**

提供的POC代码（`tough-cookie/index.js`）旨在演示此漏洞，并且`test-cve-2023-26136.js`单元测试验证了修复程序。利用代码的描述表明，它能够成功利用易受攻击的版本，并且针对修补版本会失败，这表明POC是有效的。

**投毒风险分析：**

该仓库包含修复漏洞的代码和测试，以及利用漏洞的演示代码。虽然存在利用代码，但主要目的是验证修复程序。考虑到作者提供了修复方案、测试用例以及详细的漏洞描述，投毒的可能性较低。但仍然存在一定的风险，例如，`tough-cookie/index.js`如果被恶意修改，可能会在不知情的情况下引入后门。总体评估投毒风险为5%，主要是基于对代码质量和作者意图的信任，但不能完全排除。

**利用方式：**

1.  创建一个`CookieJar`实例，并将`rejectPublicSuffixes`设置为`false`。
2.  构造一个包含恶意域名（例如`__proto__`）的Cookie，将其设置为`CookieJar`。
3.  由于`rejectPublicSuffixes`为`false`，`tough-cookie`将尝试设置此cookie，从而污染`Object.prototype`。
4.  一旦`Object.prototype`被污染，所有基于此原型的对象都会受到影响，可能导致应用程序行为异常或安全漏洞。

**项目地址:** [uriyahav/tough-cookie-2.5.0-cve-2023-26136-fix](https://github.com/uriyahav/tough-cookie-2.5.0-cve-2023-26136-fix)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---



---

## POC #2

**来源**: [CVE-2023-26136-dani33339_Tough-Cookie-v2.5.0-Patched.md](../2023/CVE-2023-26136-dani33339_Tough-Cookie-v2.5.0-Patched.md)

## CVE-2023-26136-tough-cookie-Prototype Pollution

**漏洞编号:** CVE-2023-26136

**漏洞类型:** Prototype Pollution

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致权限提升和拒绝服务

**影响版本:** < 4.1.3

**利用条件:** 需要CookieJar使用rejectPublicSuffixes=false模式

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包中的一个原型污染漏洞，影响版本低于4.1.3。当CookieJar以`rejectPublicSuffixes=false`模式使用时，由于对Cookie处理不当，可能导致原型污染。具体来说，如果`cookie.domain`被设置为`__proto__`，攻击者可以修改`Object.prototype`，从而影响整个应用程序的行为。根据漏洞信息，该漏洞的CVSS评分为6.5，属于中危漏洞。搜索结果确认了漏洞的存在以及受影响的版本。提供的漏洞利用代码包括Dockerfile、LICENSE和README.md。README.md描述了漏洞和修复方案，以及安装patched版本的说明。Dockerfile用于构建包含易受攻击或修复后的tough-cookie版本的环境。LICENSE是MIT许可证。 

**有效性：**
根据README.md的描述，以及漏洞库信息和搜索结果，该漏洞确实存在并且可以被利用。

**投毒风险：**
检查提供的文件，主要风险点在于Dockerfile。虽然Dockerfile包含了一些常见的操作，例如安装vim和创建用户，但没有发现明显的恶意代码或后门。然而，`chmod -R a+w /usr/local/lib/node_modules`和`chmod -R a+w /usr/local/bin`这两条命令将给予所有用户对node_modules和/usr/local/bin的写权限，这可能被利用来安装恶意模块或者替换系统命令，从而实现投毒。LICENSE文件和README文件本身没有明显的投毒风险。因此，存在一定的投毒风险，但不是非常高，大概10%的风险。

**利用方式：**
利用方式是通过设置`cookie.domain`为`__proto__`来修改`Object.prototype`，进而影响使用tough-cookie的应用程序的行为。需要注意的是，利用需要应用程序配置`rejectPublicSuffixes=false`。攻击者可以通过发送包含特制Cookie的HTTP请求来触发该漏洞。攻击成功后，攻击者可以修改JavaScript对象的默认属性，从而导致权限提升、信息泄露或拒绝服务。

**项目地址:** [dani33339/Tough-Cookie-v2.5.0-Patched](https://github.com/dani33339/Tough-Cookie-v2.5.0-Patched)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #3

**来源**: [CVE-2023-26136-guy2610_tough-cookie-patch-cve-2023-26136.md](../2023/CVE-2023-26136-guy2610_tough-cookie-patch-cve-2023-26136.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或客户端代码执行

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar，并且rejectPublicSuffixes=false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包中的一个原型污染漏洞，影响4.1.3之前的版本。该漏洞是由于在使用CookieJar时，对Cookie的处理不当造成的，特别是当`rejectPublicSuffixes`设置为`false`时。攻击者可以通过构造恶意的Cookie，污染JavaScript对象的原型，从而影响应用程序的行为。虽然漏洞描述中提到影响的是客户端，但是如果服务器端也使用了存在漏洞的tough-cookie版本，并且依赖于受污染的原型属性，那么也可能受到影响。

**有效性：**
漏洞库信息和搜索引擎结果都确认了漏洞的存在，并且提供了commit信息，说明该漏洞已被修复。给出的Dockerfile和代码片段是tough-cookie仓库的代码，包括Dockerfile、LICENSE和README.md。这些文件本身不是漏洞利用代码，而是构建和描述该库的文件。

**投毒风险：**
提供的Dockerfile在构建过程中，修改了`/usr/local/lib/node_modules`和`/usr/local/bin`的权限，允许`cookie`用户写入。虽然这本身不是投毒行为，但如果构建环境或后续使用中存在其他漏洞，攻击者可能利用这些宽松的权限进行投毒，例如通过npm安装恶意依赖。因此，存在一定的投毒风险，但是从提供的代码片段来看，直接投毒的可能性较低，估计为10%。

**利用方式：**
1.  **条件：** 需要应用程序使用`tough-cookie`库的受影响版本（小于4.1.3），并且在创建`CookieJar`实例时，设置`rejectPublicSuffixes`为`false`。
2.  **攻击步骤：** 攻击者构造一个包含恶意属性的Cookie，例如`__proto__.polluted = true`。将此Cookie发送到服务器或客户端。
3.  **结果：** `Object.prototype`会被污染，所有JavaScript对象都会继承`polluted`属性，这可能会导致意外的行为或安全问题。
4. **修复方式：** 更新`tough-cookie`到4.1.3或更高版本。避免设置`rejectPublicSuffixes`为`false`。


**项目地址:** [guy2610/tough-cookie-patch-cve-2023-26136](https://github.com/guy2610/tough-cookie-patch-cve-2023-26136)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #4

**来源**: [CVE-2023-26136-m-lito13_SealSecurity_Exam.md](../2023/CVE-2023-26136-m-lito13_SealSecurity_Exam.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或权限提升

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar且rejectPublicSuffixes=false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包在4.1.3版本之前的原型污染漏洞。当使用CookieJar且`rejectPublicSuffixes=false`时，由于对Cookie处理不当，攻击者可以通过构造恶意的Cookie，例如将Cookie的Domain设置为`__proto__`，从而污染JavaScript对象的原型，影响所有继承该原型的对象。

**有效性：**
提供的POC代码展示了如何利用URL查询参数或者直接设置Cookie的Domain为`__proto__`来污染原型。代码中还提供了修复方案，即在初始化对象时使用`Object.create(null)`，创建一个没有原型的空对象，以防止原型污染。

**投毒风险：**
该仓库中可能存在投毒代码。`changes.diff` 文件中虽然包含了修复漏洞的补丁，但是攻击者可能在提交修复补丁的同时，添加一些不易察觉的恶意代码，例如在其他文件中添加后门，或者修改构建脚本引入恶意依赖。评估投毒风险为10%，主要是因为该仓库看起来是一个学习/演示项目，而非实际的发布包，投毒的动机相对较低。需要仔细审查代码变更，特别是构建和依赖管理部分，才能确定是否存在恶意代码。

**利用方式：**
1.  **构造恶意URL：** 攻击者可以构造包含`__proto__`属性的URL，例如`https://vulnerable-website.com/?__proto__[badProperty]=payload`，当URL解析器处理该URL时，会将`badProperty`添加到所有对象的原型链上。
2.  **设置恶意Cookie：**  攻击者可以设置Cookie的Domain为`__proto__`，并设置相应的属性值。当`tough-cookie`处理该Cookie时，会将属性添加到所有对象的原型链上。示例代码如下：

```javascript
cookiejar.setCookie("Slonser=polluted; Domain=__proto__; Path=/notauth", "https://__proto__/admin", { loose: true }, (err, cookie) => {})
```

**影响：**
成功利用此漏洞后，攻击者可以修改全局对象的属性，从而影响整个应用程序的行为。例如，可以修改内置对象的属性，导致程序崩溃或执行恶意代码。在某些情况下，攻击者还可以利用原型污染漏洞实现权限提升。

**项目地址:** [m-lito13/SealSecurity_Exam](https://github.com/m-lito13/SealSecurity_Exam)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #5

**来源**: [CVE-2023-26136-morrisel_CVE-2023-26136.md](../2023/CVE-2023-26136-morrisel_CVE-2023-26136.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致应用配置被篡改，甚至远程代码执行，取决于应用如何使用受污染的原型

**影响版本:** < 4.1.3

**利用条件:** 需要在使用 tough-cookie 的应用中，CookieJar 的 rejectPublicSuffixes 设置为 false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136 是 tough-cookie 包版本低于 4.1.3 的原型污染漏洞。当 CookieJar 的 rejectPublicSuffixes 设置为 false 时，由于不正确地处理 Cookie，导致原型污染。漏洞出现在对象的初始化方式上。

**有效性：**
提供的 POC 代码通过修改 `memstore.js` 文件，将 `this.idx = {};` 替换为 `this.idx = Object.create(null);` 来修复该漏洞。原始版本在特定配置下确实存在原型污染的风险，而修改后的版本避免了从 `Object.prototype` 继承属性，从而阻止了原型污染。根据提供的 `index.js` 中的测试脚本显示，原始版本会被成功利用（`EXPLOITED SUCCESSFULLY`），而修复后的版本利用会失败（`EXPLOIT FAILED`），验证了 POC 的有效性。

**投毒风险：**
代码库中可能存在投毒风险。虽然主要的修改是为了修复原型污染漏洞，但是仍然存在一些小的风险。

*   **非必要文件：**`README.md`中存在作者信息,增加了溯源的可能性,降低了攻击者匿名性,正常漏洞仓库中不应存在作者信息.
*   **测试代码：** 测试代码中可能存在后门，或者可能被修改为包含恶意行为。

综合考虑，代码库中存在潜在投毒代码的风险较低，约为10%。

**利用方式：**
1.  **漏洞前提：** 应用使用了受影响版本的 `tough-cookie`，并且 `CookieJar` 的 `rejectPublicSuffixes` 设置为 `false`。
2.  **攻击方式：** 攻击者通过构造包含恶意属性的 Cookie，例如 `__proto__.polluted = 'evil'`，并将其注入到 CookieJar 中。
3.  **漏洞结果：** 由于 `tough-cookie` 在初始化对象时存在缺陷，恶意属性会被添加到 `Object.prototype` 上，从而污染了整个 JavaScript 应用的原型链。攻击者可以通过污染原型链来修改应用的行为，例如修改全局配置、注入恶意代码等。具体危害取决于应用如何使用受污染的原型，严重情况下可能导致远程代码执行。
4.  **修复方式：** 使用 `Object.create(null)` 创建对象，避免从 `Object.prototype` 继承属性。

**项目地址:** [morrisel/CVE-2023-26136](https://github.com/morrisel/CVE-2023-26136)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #6

**来源**: [CVE-2023-26136-ronmadar_Open-Source-Seal-Security.md](../2023/CVE-2023-26136-ronmadar_Open-Source-Seal-Security.md)

## CVE-2023-26136-tough-cookie-Prototype污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** Prototype Pollution

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或篡改应用行为

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar，并且rejectPublicSuffixes设置为false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包在4.1.3版本之前存在的一个原型污染漏洞。当使用CookieJar且rejectPublicSuffixes=false时，由于对Cookie处理不当，可能导致原型污染。

**有效性评估：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的。多个来源确认了此漏洞的存在，并提供了修复方案。

**利用方式：**
攻击者可以通过构造恶意的cookie，特别是当cookie的domain设置为`__proto__`时，利用`tough-cookie`库在处理cookie时，向Object.prototype注入恶意属性。由于JavaScript中所有对象都继承自Object.prototype，这会影响应用程序的全局状态，可能导致：

*   **拒绝服务 (DoS):** 通过注入导致异常或无限循环的属性。
*   **篡改应用行为:** 通过注入改变应用程序逻辑的关键属性，影响其行为。

提供的代码尝试通过设置特定的cookie来触发原型污染。`index.js` 脚本的逻辑是创建一个cookie jar，然后尝试设置一个具有特定属性的cookie。`vulnerable`变量控制是否禁用`rejectPublicSuffixes`。如果设置为true，则模拟易受攻击的情况。

**投毒风险评估：**
提供的代码主要包含以下文件：
*   `README.md`: 漏洞描述、修复方案和项目说明。
*   `index.js`: 包含原型污染漏洞的验证代码
    * `test-unit.js`: 测试用例，用于验证修复方案。
    * `testVerifyVulnerable.js`: 测试脚本，用于验证漏洞修复后的行为。

综合评估来看，投毒风险较低。风险点在于 `index.js` 是否存在后门代码，但分析内容可知，该文件主要是漏洞验证代码，不存在恶意行为。

**分析：** 该漏洞利用了JavaScript原型链的特性。通过原型污染，攻击者可以影响所有JavaScript对象的行为。修复此漏洞的关键在于防止在处理cookie时直接操作`Object.prototype`。snyk提供的链接指向的修复方案表明，该漏洞是通过不安全的对象递归合并以及通过路径定义属性造成的。该代码提供了一个简单的原型污染验证，在实际利用中，攻击者可能需要更精细地构造cookie，以便产生更大的影响。

**项目地址:** [ronmadar/Open-Source-Seal-Security](https://github.com/ronmadar/Open-Source-Seal-Security)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #7

**来源**: [CVE-2023-26136-uriyahav_tough-cookie-2.5.0-cve-2023-26136-fix.md](../2023/CVE-2023-26136-uriyahav_tough-cookie-2.5.0-cve-2023-26136-fix.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致应用程序行为被篡改，甚至造成拒绝服务

**影响版本:** < 4.1.3

**利用条件:** 需要应用程序使用受影响版本的tough-cookie，并且在rejectPublicSuffixes=false的模式下使用CookieJar。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-26136是tough-cookie库中一个原型污染漏洞。当CookieJar在rejectPublicSuffixes=false模式下处理Cookie时，由于对象初始化不当导致。攻击者可以通过设置具有恶意域（例如`__proto__`）的cookie来污染`Object.prototype`，从而影响所有继承自该原型的对象。

**有效性分析：**

提供的POC代码（`tough-cookie/index.js`）旨在演示此漏洞，并且`test-cve-2023-26136.js`单元测试验证了修复程序。利用代码的描述表明，它能够成功利用易受攻击的版本，并且针对修补版本会失败，这表明POC是有效的。

**投毒风险分析：**

该仓库包含修复漏洞的代码和测试，以及利用漏洞的演示代码。虽然存在利用代码，但主要目的是验证修复程序。考虑到作者提供了修复方案、测试用例以及详细的漏洞描述，投毒的可能性较低。但仍然存在一定的风险，例如，`tough-cookie/index.js`如果被恶意修改，可能会在不知情的情况下引入后门。总体评估投毒风险为5%，主要是基于对代码质量和作者意图的信任，但不能完全排除。

**利用方式：**

1.  创建一个`CookieJar`实例，并将`rejectPublicSuffixes`设置为`false`。
2.  构造一个包含恶意域名（例如`__proto__`）的Cookie，将其设置为`CookieJar`。
3.  由于`rejectPublicSuffixes`为`false`，`tough-cookie`将尝试设置此cookie，从而污染`Object.prototype`。
4.  一旦`Object.prototype`被污染，所有基于此原型的对象都会受到影响，可能导致应用程序行为异常或安全漏洞。

**项目地址:** [uriyahav/tough-cookie-2.5.0-cve-2023-26136-fix](https://github.com/uriyahav/tough-cookie-2.5.0-cve-2023-26136-fix)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---



---

## POC #2

**来源**: [CVE-2023-26136-dani33339_Tough-Cookie-v2.5.0-Patched.md](../2023/CVE-2023-26136-dani33339_Tough-Cookie-v2.5.0-Patched.md)

## CVE-2023-26136-tough-cookie-Prototype Pollution

**漏洞编号:** CVE-2023-26136

**漏洞类型:** Prototype Pollution

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致权限提升和拒绝服务

**影响版本:** < 4.1.3

**利用条件:** 需要CookieJar使用rejectPublicSuffixes=false模式

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包中的一个原型污染漏洞，影响版本低于4.1.3。当CookieJar以`rejectPublicSuffixes=false`模式使用时，由于对Cookie处理不当，可能导致原型污染。具体来说，如果`cookie.domain`被设置为`__proto__`，攻击者可以修改`Object.prototype`，从而影响整个应用程序的行为。根据漏洞信息，该漏洞的CVSS评分为6.5，属于中危漏洞。搜索结果确认了漏洞的存在以及受影响的版本。提供的漏洞利用代码包括Dockerfile、LICENSE和README.md。README.md描述了漏洞和修复方案，以及安装patched版本的说明。Dockerfile用于构建包含易受攻击或修复后的tough-cookie版本的环境。LICENSE是MIT许可证。 

**有效性：**
根据README.md的描述，以及漏洞库信息和搜索结果，该漏洞确实存在并且可以被利用。

**投毒风险：**
检查提供的文件，主要风险点在于Dockerfile。虽然Dockerfile包含了一些常见的操作，例如安装vim和创建用户，但没有发现明显的恶意代码或后门。然而，`chmod -R a+w /usr/local/lib/node_modules`和`chmod -R a+w /usr/local/bin`这两条命令将给予所有用户对node_modules和/usr/local/bin的写权限，这可能被利用来安装恶意模块或者替换系统命令，从而实现投毒。LICENSE文件和README文件本身没有明显的投毒风险。因此，存在一定的投毒风险，但不是非常高，大概10%的风险。

**利用方式：**
利用方式是通过设置`cookie.domain`为`__proto__`来修改`Object.prototype`，进而影响使用tough-cookie的应用程序的行为。需要注意的是，利用需要应用程序配置`rejectPublicSuffixes=false`。攻击者可以通过发送包含特制Cookie的HTTP请求来触发该漏洞。攻击成功后，攻击者可以修改JavaScript对象的默认属性，从而导致权限提升、信息泄露或拒绝服务。

**项目地址:** [dani33339/Tough-Cookie-v2.5.0-Patched](https://github.com/dani33339/Tough-Cookie-v2.5.0-Patched)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #3

**来源**: [CVE-2023-26136-guy2610_tough-cookie-patch-cve-2023-26136.md](../2023/CVE-2023-26136-guy2610_tough-cookie-patch-cve-2023-26136.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或客户端代码执行

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar，并且rejectPublicSuffixes=false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包中的一个原型污染漏洞，影响4.1.3之前的版本。该漏洞是由于在使用CookieJar时，对Cookie的处理不当造成的，特别是当`rejectPublicSuffixes`设置为`false`时。攻击者可以通过构造恶意的Cookie，污染JavaScript对象的原型，从而影响应用程序的行为。虽然漏洞描述中提到影响的是客户端，但是如果服务器端也使用了存在漏洞的tough-cookie版本，并且依赖于受污染的原型属性，那么也可能受到影响。

**有效性：**
漏洞库信息和搜索引擎结果都确认了漏洞的存在，并且提供了commit信息，说明该漏洞已被修复。给出的Dockerfile和代码片段是tough-cookie仓库的代码，包括Dockerfile、LICENSE和README.md。这些文件本身不是漏洞利用代码，而是构建和描述该库的文件。

**投毒风险：**
提供的Dockerfile在构建过程中，修改了`/usr/local/lib/node_modules`和`/usr/local/bin`的权限，允许`cookie`用户写入。虽然这本身不是投毒行为，但如果构建环境或后续使用中存在其他漏洞，攻击者可能利用这些宽松的权限进行投毒，例如通过npm安装恶意依赖。因此，存在一定的投毒风险，但是从提供的代码片段来看，直接投毒的可能性较低，估计为10%。

**利用方式：**
1.  **条件：** 需要应用程序使用`tough-cookie`库的受影响版本（小于4.1.3），并且在创建`CookieJar`实例时，设置`rejectPublicSuffixes`为`false`。
2.  **攻击步骤：** 攻击者构造一个包含恶意属性的Cookie，例如`__proto__.polluted = true`。将此Cookie发送到服务器或客户端。
3.  **结果：** `Object.prototype`会被污染，所有JavaScript对象都会继承`polluted`属性，这可能会导致意外的行为或安全问题。
4. **修复方式：** 更新`tough-cookie`到4.1.3或更高版本。避免设置`rejectPublicSuffixes`为`false`。


**项目地址:** [guy2610/tough-cookie-patch-cve-2023-26136](https://github.com/guy2610/tough-cookie-patch-cve-2023-26136)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #4

**来源**: [CVE-2023-26136-m-lito13_SealSecurity_Exam.md](../2023/CVE-2023-26136-m-lito13_SealSecurity_Exam.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或权限提升

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar且rejectPublicSuffixes=false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包在4.1.3版本之前的原型污染漏洞。当使用CookieJar且`rejectPublicSuffixes=false`时，由于对Cookie处理不当，攻击者可以通过构造恶意的Cookie，例如将Cookie的Domain设置为`__proto__`，从而污染JavaScript对象的原型，影响所有继承该原型的对象。

**有效性：**
提供的POC代码展示了如何利用URL查询参数或者直接设置Cookie的Domain为`__proto__`来污染原型。代码中还提供了修复方案，即在初始化对象时使用`Object.create(null)`，创建一个没有原型的空对象，以防止原型污染。

**投毒风险：**
该仓库中可能存在投毒代码。`changes.diff` 文件中虽然包含了修复漏洞的补丁，但是攻击者可能在提交修复补丁的同时，添加一些不易察觉的恶意代码，例如在其他文件中添加后门，或者修改构建脚本引入恶意依赖。评估投毒风险为10%，主要是因为该仓库看起来是一个学习/演示项目，而非实际的发布包，投毒的动机相对较低。需要仔细审查代码变更，特别是构建和依赖管理部分，才能确定是否存在恶意代码。

**利用方式：**
1.  **构造恶意URL：** 攻击者可以构造包含`__proto__`属性的URL，例如`https://vulnerable-website.com/?__proto__[badProperty]=payload`，当URL解析器处理该URL时，会将`badProperty`添加到所有对象的原型链上。
2.  **设置恶意Cookie：**  攻击者可以设置Cookie的Domain为`__proto__`，并设置相应的属性值。当`tough-cookie`处理该Cookie时，会将属性添加到所有对象的原型链上。示例代码如下：

```javascript
cookiejar.setCookie("Slonser=polluted; Domain=__proto__; Path=/notauth", "https://__proto__/admin", { loose: true }, (err, cookie) => {})
```

**影响：**
成功利用此漏洞后，攻击者可以修改全局对象的属性，从而影响整个应用程序的行为。例如，可以修改内置对象的属性，导致程序崩溃或执行恶意代码。在某些情况下，攻击者还可以利用原型污染漏洞实现权限提升。

**项目地址:** [m-lito13/SealSecurity_Exam](https://github.com/m-lito13/SealSecurity_Exam)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #5

**来源**: [CVE-2023-26136-morrisel_CVE-2023-26136.md](../2023/CVE-2023-26136-morrisel_CVE-2023-26136.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致应用配置被篡改，甚至远程代码执行，取决于应用如何使用受污染的原型

**影响版本:** < 4.1.3

**利用条件:** 需要在使用 tough-cookie 的应用中，CookieJar 的 rejectPublicSuffixes 设置为 false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136 是 tough-cookie 包版本低于 4.1.3 的原型污染漏洞。当 CookieJar 的 rejectPublicSuffixes 设置为 false 时，由于不正确地处理 Cookie，导致原型污染。漏洞出现在对象的初始化方式上。

**有效性：**
提供的 POC 代码通过修改 `memstore.js` 文件，将 `this.idx = {};` 替换为 `this.idx = Object.create(null);` 来修复该漏洞。原始版本在特定配置下确实存在原型污染的风险，而修改后的版本避免了从 `Object.prototype` 继承属性，从而阻止了原型污染。根据提供的 `index.js` 中的测试脚本显示，原始版本会被成功利用（`EXPLOITED SUCCESSFULLY`），而修复后的版本利用会失败（`EXPLOIT FAILED`），验证了 POC 的有效性。

**投毒风险：**
代码库中可能存在投毒风险。虽然主要的修改是为了修复原型污染漏洞，但是仍然存在一些小的风险。

*   **非必要文件：**`README.md`中存在作者信息,增加了溯源的可能性,降低了攻击者匿名性,正常漏洞仓库中不应存在作者信息.
*   **测试代码：** 测试代码中可能存在后门，或者可能被修改为包含恶意行为。

综合考虑，代码库中存在潜在投毒代码的风险较低，约为10%。

**利用方式：**
1.  **漏洞前提：** 应用使用了受影响版本的 `tough-cookie`，并且 `CookieJar` 的 `rejectPublicSuffixes` 设置为 `false`。
2.  **攻击方式：** 攻击者通过构造包含恶意属性的 Cookie，例如 `__proto__.polluted = 'evil'`，并将其注入到 CookieJar 中。
3.  **漏洞结果：** 由于 `tough-cookie` 在初始化对象时存在缺陷，恶意属性会被添加到 `Object.prototype` 上，从而污染了整个 JavaScript 应用的原型链。攻击者可以通过污染原型链来修改应用的行为，例如修改全局配置、注入恶意代码等。具体危害取决于应用如何使用受污染的原型，严重情况下可能导致远程代码执行。
4.  **修复方式：** 使用 `Object.create(null)` 创建对象，避免从 `Object.prototype` 继承属性。

**项目地址:** [morrisel/CVE-2023-26136](https://github.com/morrisel/CVE-2023-26136)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #6

**来源**: [CVE-2023-26136-ronmadar_Open-Source-Seal-Security.md](../2023/CVE-2023-26136-ronmadar_Open-Source-Seal-Security.md)

## CVE-2023-26136-tough-cookie-Prototype污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** Prototype Pollution

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或篡改应用行为

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar，并且rejectPublicSuffixes设置为false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包在4.1.3版本之前存在的一个原型污染漏洞。当使用CookieJar且rejectPublicSuffixes=false时，由于对Cookie处理不当，可能导致原型污染。

**有效性评估：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的。多个来源确认了此漏洞的存在，并提供了修复方案。

**利用方式：**
攻击者可以通过构造恶意的cookie，特别是当cookie的domain设置为`__proto__`时，利用`tough-cookie`库在处理cookie时，向Object.prototype注入恶意属性。由于JavaScript中所有对象都继承自Object.prototype，这会影响应用程序的全局状态，可能导致：

*   **拒绝服务 (DoS):** 通过注入导致异常或无限循环的属性。
*   **篡改应用行为:** 通过注入改变应用程序逻辑的关键属性，影响其行为。

提供的代码尝试通过设置特定的cookie来触发原型污染。`index.js` 脚本的逻辑是创建一个cookie jar，然后尝试设置一个具有特定属性的cookie。`vulnerable`变量控制是否禁用`rejectPublicSuffixes`。如果设置为true，则模拟易受攻击的情况。

**投毒风险评估：**
提供的代码主要包含以下文件：
*   `README.md`: 漏洞描述、修复方案和项目说明。
*   `index.js`: 包含原型污染漏洞的验证代码
    * `test-unit.js`: 测试用例，用于验证修复方案。
    * `testVerifyVulnerable.js`: 测试脚本，用于验证漏洞修复后的行为。

综合评估来看，投毒风险较低。风险点在于 `index.js` 是否存在后门代码，但分析内容可知，该文件主要是漏洞验证代码，不存在恶意行为。

**分析：** 该漏洞利用了JavaScript原型链的特性。通过原型污染，攻击者可以影响所有JavaScript对象的行为。修复此漏洞的关键在于防止在处理cookie时直接操作`Object.prototype`。snyk提供的链接指向的修复方案表明，该漏洞是通过不安全的对象递归合并以及通过路径定义属性造成的。该代码提供了一个简单的原型污染验证，在实际利用中，攻击者可能需要更精细地构造cookie，以便产生更大的影响。

**项目地址:** [ronmadar/Open-Source-Seal-Security](https://github.com/ronmadar/Open-Source-Seal-Security)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #7

**来源**: [CVE-2023-26136-uriyahav_tough-cookie-2.5.0-cve-2023-26136-fix.md](../2023/CVE-2023-26136-uriyahav_tough-cookie-2.5.0-cve-2023-26136-fix.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致应用程序行为被篡改，甚至造成拒绝服务

**影响版本:** < 4.1.3

**利用条件:** 需要应用程序使用受影响版本的tough-cookie，并且在rejectPublicSuffixes=false的模式下使用CookieJar。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-26136是tough-cookie库中一个原型污染漏洞。当CookieJar在rejectPublicSuffixes=false模式下处理Cookie时，由于对象初始化不当导致。攻击者可以通过设置具有恶意域（例如`__proto__`）的cookie来污染`Object.prototype`，从而影响所有继承自该原型的对象。

**有效性分析：**

提供的POC代码（`tough-cookie/index.js`）旨在演示此漏洞，并且`test-cve-2023-26136.js`单元测试验证了修复程序。利用代码的描述表明，它能够成功利用易受攻击的版本，并且针对修补版本会失败，这表明POC是有效的。

**投毒风险分析：**

该仓库包含修复漏洞的代码和测试，以及利用漏洞的演示代码。虽然存在利用代码，但主要目的是验证修复程序。考虑到作者提供了修复方案、测试用例以及详细的漏洞描述，投毒的可能性较低。但仍然存在一定的风险，例如，`tough-cookie/index.js`如果被恶意修改，可能会在不知情的情况下引入后门。总体评估投毒风险为5%，主要是基于对代码质量和作者意图的信任，但不能完全排除。

**利用方式：**

1.  创建一个`CookieJar`实例，并将`rejectPublicSuffixes`设置为`false`。
2.  构造一个包含恶意域名（例如`__proto__`）的Cookie，将其设置为`CookieJar`。
3.  由于`rejectPublicSuffixes`为`false`，`tough-cookie`将尝试设置此cookie，从而污染`Object.prototype`。
4.  一旦`Object.prototype`被污染，所有基于此原型的对象都会受到影响，可能导致应用程序行为异常或安全漏洞。

**项目地址:** [uriyahav/tough-cookie-2.5.0-cve-2023-26136-fix](https://github.com/uriyahav/tough-cookie-2.5.0-cve-2023-26136-fix)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---



---

## POC #2

**来源**: [CVE-2023-26136-dani33339_Tough-Cookie-v2.5.0-Patched.md](../2023/CVE-2023-26136-dani33339_Tough-Cookie-v2.5.0-Patched.md)

## CVE-2023-26136-tough-cookie-Prototype Pollution

**漏洞编号:** CVE-2023-26136

**漏洞类型:** Prototype Pollution

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致权限提升和拒绝服务

**影响版本:** < 4.1.3

**利用条件:** 需要CookieJar使用rejectPublicSuffixes=false模式

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包中的一个原型污染漏洞，影响版本低于4.1.3。当CookieJar以`rejectPublicSuffixes=false`模式使用时，由于对Cookie处理不当，可能导致原型污染。具体来说，如果`cookie.domain`被设置为`__proto__`，攻击者可以修改`Object.prototype`，从而影响整个应用程序的行为。根据漏洞信息，该漏洞的CVSS评分为6.5，属于中危漏洞。搜索结果确认了漏洞的存在以及受影响的版本。提供的漏洞利用代码包括Dockerfile、LICENSE和README.md。README.md描述了漏洞和修复方案，以及安装patched版本的说明。Dockerfile用于构建包含易受攻击或修复后的tough-cookie版本的环境。LICENSE是MIT许可证。 

**有效性：**
根据README.md的描述，以及漏洞库信息和搜索结果，该漏洞确实存在并且可以被利用。

**投毒风险：**
检查提供的文件，主要风险点在于Dockerfile。虽然Dockerfile包含了一些常见的操作，例如安装vim和创建用户，但没有发现明显的恶意代码或后门。然而，`chmod -R a+w /usr/local/lib/node_modules`和`chmod -R a+w /usr/local/bin`这两条命令将给予所有用户对node_modules和/usr/local/bin的写权限，这可能被利用来安装恶意模块或者替换系统命令，从而实现投毒。LICENSE文件和README文件本身没有明显的投毒风险。因此，存在一定的投毒风险，但不是非常高，大概10%的风险。

**利用方式：**
利用方式是通过设置`cookie.domain`为`__proto__`来修改`Object.prototype`，进而影响使用tough-cookie的应用程序的行为。需要注意的是，利用需要应用程序配置`rejectPublicSuffixes=false`。攻击者可以通过发送包含特制Cookie的HTTP请求来触发该漏洞。攻击成功后，攻击者可以修改JavaScript对象的默认属性，从而导致权限提升、信息泄露或拒绝服务。

**项目地址:** [dani33339/Tough-Cookie-v2.5.0-Patched](https://github.com/dani33339/Tough-Cookie-v2.5.0-Patched)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #3

**来源**: [CVE-2023-26136-guy2610_tough-cookie-patch-cve-2023-26136.md](../2023/CVE-2023-26136-guy2610_tough-cookie-patch-cve-2023-26136.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或客户端代码执行

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar，并且rejectPublicSuffixes=false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包中的一个原型污染漏洞，影响4.1.3之前的版本。该漏洞是由于在使用CookieJar时，对Cookie的处理不当造成的，特别是当`rejectPublicSuffixes`设置为`false`时。攻击者可以通过构造恶意的Cookie，污染JavaScript对象的原型，从而影响应用程序的行为。虽然漏洞描述中提到影响的是客户端，但是如果服务器端也使用了存在漏洞的tough-cookie版本，并且依赖于受污染的原型属性，那么也可能受到影响。

**有效性：**
漏洞库信息和搜索引擎结果都确认了漏洞的存在，并且提供了commit信息，说明该漏洞已被修复。给出的Dockerfile和代码片段是tough-cookie仓库的代码，包括Dockerfile、LICENSE和README.md。这些文件本身不是漏洞利用代码，而是构建和描述该库的文件。

**投毒风险：**
提供的Dockerfile在构建过程中，修改了`/usr/local/lib/node_modules`和`/usr/local/bin`的权限，允许`cookie`用户写入。虽然这本身不是投毒行为，但如果构建环境或后续使用中存在其他漏洞，攻击者可能利用这些宽松的权限进行投毒，例如通过npm安装恶意依赖。因此，存在一定的投毒风险，但是从提供的代码片段来看，直接投毒的可能性较低，估计为10%。

**利用方式：**
1.  **条件：** 需要应用程序使用`tough-cookie`库的受影响版本（小于4.1.3），并且在创建`CookieJar`实例时，设置`rejectPublicSuffixes`为`false`。
2.  **攻击步骤：** 攻击者构造一个包含恶意属性的Cookie，例如`__proto__.polluted = true`。将此Cookie发送到服务器或客户端。
3.  **结果：** `Object.prototype`会被污染，所有JavaScript对象都会继承`polluted`属性，这可能会导致意外的行为或安全问题。
4. **修复方式：** 更新`tough-cookie`到4.1.3或更高版本。避免设置`rejectPublicSuffixes`为`false`。


**项目地址:** [guy2610/tough-cookie-patch-cve-2023-26136](https://github.com/guy2610/tough-cookie-patch-cve-2023-26136)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #4

**来源**: [CVE-2023-26136-m-lito13_SealSecurity_Exam.md](../2023/CVE-2023-26136-m-lito13_SealSecurity_Exam.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或权限提升

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar且rejectPublicSuffixes=false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包在4.1.3版本之前的原型污染漏洞。当使用CookieJar且`rejectPublicSuffixes=false`时，由于对Cookie处理不当，攻击者可以通过构造恶意的Cookie，例如将Cookie的Domain设置为`__proto__`，从而污染JavaScript对象的原型，影响所有继承该原型的对象。

**有效性：**
提供的POC代码展示了如何利用URL查询参数或者直接设置Cookie的Domain为`__proto__`来污染原型。代码中还提供了修复方案，即在初始化对象时使用`Object.create(null)`，创建一个没有原型的空对象，以防止原型污染。

**投毒风险：**
该仓库中可能存在投毒代码。`changes.diff` 文件中虽然包含了修复漏洞的补丁，但是攻击者可能在提交修复补丁的同时，添加一些不易察觉的恶意代码，例如在其他文件中添加后门，或者修改构建脚本引入恶意依赖。评估投毒风险为10%，主要是因为该仓库看起来是一个学习/演示项目，而非实际的发布包，投毒的动机相对较低。需要仔细审查代码变更，特别是构建和依赖管理部分，才能确定是否存在恶意代码。

**利用方式：**
1.  **构造恶意URL：** 攻击者可以构造包含`__proto__`属性的URL，例如`https://vulnerable-website.com/?__proto__[badProperty]=payload`，当URL解析器处理该URL时，会将`badProperty`添加到所有对象的原型链上。
2.  **设置恶意Cookie：**  攻击者可以设置Cookie的Domain为`__proto__`，并设置相应的属性值。当`tough-cookie`处理该Cookie时，会将属性添加到所有对象的原型链上。示例代码如下：

```javascript
cookiejar.setCookie("Slonser=polluted; Domain=__proto__; Path=/notauth", "https://__proto__/admin", { loose: true }, (err, cookie) => {})
```

**影响：**
成功利用此漏洞后，攻击者可以修改全局对象的属性，从而影响整个应用程序的行为。例如，可以修改内置对象的属性，导致程序崩溃或执行恶意代码。在某些情况下，攻击者还可以利用原型污染漏洞实现权限提升。

**项目地址:** [m-lito13/SealSecurity_Exam](https://github.com/m-lito13/SealSecurity_Exam)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #5

**来源**: [CVE-2023-26136-morrisel_CVE-2023-26136.md](../2023/CVE-2023-26136-morrisel_CVE-2023-26136.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致应用配置被篡改，甚至远程代码执行，取决于应用如何使用受污染的原型

**影响版本:** < 4.1.3

**利用条件:** 需要在使用 tough-cookie 的应用中，CookieJar 的 rejectPublicSuffixes 设置为 false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136 是 tough-cookie 包版本低于 4.1.3 的原型污染漏洞。当 CookieJar 的 rejectPublicSuffixes 设置为 false 时，由于不正确地处理 Cookie，导致原型污染。漏洞出现在对象的初始化方式上。

**有效性：**
提供的 POC 代码通过修改 `memstore.js` 文件，将 `this.idx = {};` 替换为 `this.idx = Object.create(null);` 来修复该漏洞。原始版本在特定配置下确实存在原型污染的风险，而修改后的版本避免了从 `Object.prototype` 继承属性，从而阻止了原型污染。根据提供的 `index.js` 中的测试脚本显示，原始版本会被成功利用（`EXPLOITED SUCCESSFULLY`），而修复后的版本利用会失败（`EXPLOIT FAILED`），验证了 POC 的有效性。

**投毒风险：**
代码库中可能存在投毒风险。虽然主要的修改是为了修复原型污染漏洞，但是仍然存在一些小的风险。

*   **非必要文件：**`README.md`中存在作者信息,增加了溯源的可能性,降低了攻击者匿名性,正常漏洞仓库中不应存在作者信息.
*   **测试代码：** 测试代码中可能存在后门，或者可能被修改为包含恶意行为。

综合考虑，代码库中存在潜在投毒代码的风险较低，约为10%。

**利用方式：**
1.  **漏洞前提：** 应用使用了受影响版本的 `tough-cookie`，并且 `CookieJar` 的 `rejectPublicSuffixes` 设置为 `false`。
2.  **攻击方式：** 攻击者通过构造包含恶意属性的 Cookie，例如 `__proto__.polluted = 'evil'`，并将其注入到 CookieJar 中。
3.  **漏洞结果：** 由于 `tough-cookie` 在初始化对象时存在缺陷，恶意属性会被添加到 `Object.prototype` 上，从而污染了整个 JavaScript 应用的原型链。攻击者可以通过污染原型链来修改应用的行为，例如修改全局配置、注入恶意代码等。具体危害取决于应用如何使用受污染的原型，严重情况下可能导致远程代码执行。
4.  **修复方式：** 使用 `Object.create(null)` 创建对象，避免从 `Object.prototype` 继承属性。

**项目地址:** [morrisel/CVE-2023-26136](https://github.com/morrisel/CVE-2023-26136)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #6

**来源**: [CVE-2023-26136-ronmadar_Open-Source-Seal-Security.md](../2023/CVE-2023-26136-ronmadar_Open-Source-Seal-Security.md)

## CVE-2023-26136-tough-cookie-Prototype污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** Prototype Pollution

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或篡改应用行为

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar，并且rejectPublicSuffixes设置为false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包在4.1.3版本之前存在的一个原型污染漏洞。当使用CookieJar且rejectPublicSuffixes=false时，由于对Cookie处理不当，可能导致原型污染。

**有效性评估：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的。多个来源确认了此漏洞的存在，并提供了修复方案。

**利用方式：**
攻击者可以通过构造恶意的cookie，特别是当cookie的domain设置为`__proto__`时，利用`tough-cookie`库在处理cookie时，向Object.prototype注入恶意属性。由于JavaScript中所有对象都继承自Object.prototype，这会影响应用程序的全局状态，可能导致：

*   **拒绝服务 (DoS):** 通过注入导致异常或无限循环的属性。
*   **篡改应用行为:** 通过注入改变应用程序逻辑的关键属性，影响其行为。

提供的代码尝试通过设置特定的cookie来触发原型污染。`index.js` 脚本的逻辑是创建一个cookie jar，然后尝试设置一个具有特定属性的cookie。`vulnerable`变量控制是否禁用`rejectPublicSuffixes`。如果设置为true，则模拟易受攻击的情况。

**投毒风险评估：**
提供的代码主要包含以下文件：
*   `README.md`: 漏洞描述、修复方案和项目说明。
*   `index.js`: 包含原型污染漏洞的验证代码
    * `test-unit.js`: 测试用例，用于验证修复方案。
    * `testVerifyVulnerable.js`: 测试脚本，用于验证漏洞修复后的行为。

综合评估来看，投毒风险较低。风险点在于 `index.js` 是否存在后门代码，但分析内容可知，该文件主要是漏洞验证代码，不存在恶意行为。

**分析：** 该漏洞利用了JavaScript原型链的特性。通过原型污染，攻击者可以影响所有JavaScript对象的行为。修复此漏洞的关键在于防止在处理cookie时直接操作`Object.prototype`。snyk提供的链接指向的修复方案表明，该漏洞是通过不安全的对象递归合并以及通过路径定义属性造成的。该代码提供了一个简单的原型污染验证，在实际利用中，攻击者可能需要更精细地构造cookie，以便产生更大的影响。

**项目地址:** [ronmadar/Open-Source-Seal-Security](https://github.com/ronmadar/Open-Source-Seal-Security)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #7

**来源**: [CVE-2023-26136-uriyahav_tough-cookie-2.5.0-cve-2023-26136-fix.md](../2023/CVE-2023-26136-uriyahav_tough-cookie-2.5.0-cve-2023-26136-fix.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致应用程序行为被篡改，甚至造成拒绝服务

**影响版本:** < 4.1.3

**利用条件:** 需要应用程序使用受影响版本的tough-cookie，并且在rejectPublicSuffixes=false的模式下使用CookieJar。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-26136是tough-cookie库中一个原型污染漏洞。当CookieJar在rejectPublicSuffixes=false模式下处理Cookie时，由于对象初始化不当导致。攻击者可以通过设置具有恶意域（例如`__proto__`）的cookie来污染`Object.prototype`，从而影响所有继承自该原型的对象。

**有效性分析：**

提供的POC代码（`tough-cookie/index.js`）旨在演示此漏洞，并且`test-cve-2023-26136.js`单元测试验证了修复程序。利用代码的描述表明，它能够成功利用易受攻击的版本，并且针对修补版本会失败，这表明POC是有效的。

**投毒风险分析：**

该仓库包含修复漏洞的代码和测试，以及利用漏洞的演示代码。虽然存在利用代码，但主要目的是验证修复程序。考虑到作者提供了修复方案、测试用例以及详细的漏洞描述，投毒的可能性较低。但仍然存在一定的风险，例如，`tough-cookie/index.js`如果被恶意修改，可能会在不知情的情况下引入后门。总体评估投毒风险为5%，主要是基于对代码质量和作者意图的信任，但不能完全排除。

**利用方式：**

1.  创建一个`CookieJar`实例，并将`rejectPublicSuffixes`设置为`false`。
2.  构造一个包含恶意域名（例如`__proto__`）的Cookie，将其设置为`CookieJar`。
3.  由于`rejectPublicSuffixes`为`false`，`tough-cookie`将尝试设置此cookie，从而污染`Object.prototype`。
4.  一旦`Object.prototype`被污染，所有基于此原型的对象都会受到影响，可能导致应用程序行为异常或安全漏洞。

**项目地址:** [uriyahav/tough-cookie-2.5.0-cve-2023-26136-fix](https://github.com/uriyahav/tough-cookie-2.5.0-cve-2023-26136-fix)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---



---

## POC #2

**来源**: [CVE-2023-26136-dani33339_Tough-Cookie-v2.5.0-Patched.md](../2023/CVE-2023-26136-dani33339_Tough-Cookie-v2.5.0-Patched.md)

## CVE-2023-26136-tough-cookie-Prototype Pollution

**漏洞编号:** CVE-2023-26136

**漏洞类型:** Prototype Pollution

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致权限提升和拒绝服务

**影响版本:** < 4.1.3

**利用条件:** 需要CookieJar使用rejectPublicSuffixes=false模式

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包中的一个原型污染漏洞，影响版本低于4.1.3。当CookieJar以`rejectPublicSuffixes=false`模式使用时，由于对Cookie处理不当，可能导致原型污染。具体来说，如果`cookie.domain`被设置为`__proto__`，攻击者可以修改`Object.prototype`，从而影响整个应用程序的行为。根据漏洞信息，该漏洞的CVSS评分为6.5，属于中危漏洞。搜索结果确认了漏洞的存在以及受影响的版本。提供的漏洞利用代码包括Dockerfile、LICENSE和README.md。README.md描述了漏洞和修复方案，以及安装patched版本的说明。Dockerfile用于构建包含易受攻击或修复后的tough-cookie版本的环境。LICENSE是MIT许可证。 

**有效性：**
根据README.md的描述，以及漏洞库信息和搜索结果，该漏洞确实存在并且可以被利用。

**投毒风险：**
检查提供的文件，主要风险点在于Dockerfile。虽然Dockerfile包含了一些常见的操作，例如安装vim和创建用户，但没有发现明显的恶意代码或后门。然而，`chmod -R a+w /usr/local/lib/node_modules`和`chmod -R a+w /usr/local/bin`这两条命令将给予所有用户对node_modules和/usr/local/bin的写权限，这可能被利用来安装恶意模块或者替换系统命令，从而实现投毒。LICENSE文件和README文件本身没有明显的投毒风险。因此，存在一定的投毒风险，但不是非常高，大概10%的风险。

**利用方式：**
利用方式是通过设置`cookie.domain`为`__proto__`来修改`Object.prototype`，进而影响使用tough-cookie的应用程序的行为。需要注意的是，利用需要应用程序配置`rejectPublicSuffixes=false`。攻击者可以通过发送包含特制Cookie的HTTP请求来触发该漏洞。攻击成功后，攻击者可以修改JavaScript对象的默认属性，从而导致权限提升、信息泄露或拒绝服务。

**项目地址:** [dani33339/Tough-Cookie-v2.5.0-Patched](https://github.com/dani33339/Tough-Cookie-v2.5.0-Patched)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #3

**来源**: [CVE-2023-26136-guy2610_tough-cookie-patch-cve-2023-26136.md](../2023/CVE-2023-26136-guy2610_tough-cookie-patch-cve-2023-26136.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或客户端代码执行

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar，并且rejectPublicSuffixes=false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包中的一个原型污染漏洞，影响4.1.3之前的版本。该漏洞是由于在使用CookieJar时，对Cookie的处理不当造成的，特别是当`rejectPublicSuffixes`设置为`false`时。攻击者可以通过构造恶意的Cookie，污染JavaScript对象的原型，从而影响应用程序的行为。虽然漏洞描述中提到影响的是客户端，但是如果服务器端也使用了存在漏洞的tough-cookie版本，并且依赖于受污染的原型属性，那么也可能受到影响。

**有效性：**
漏洞库信息和搜索引擎结果都确认了漏洞的存在，并且提供了commit信息，说明该漏洞已被修复。给出的Dockerfile和代码片段是tough-cookie仓库的代码，包括Dockerfile、LICENSE和README.md。这些文件本身不是漏洞利用代码，而是构建和描述该库的文件。

**投毒风险：**
提供的Dockerfile在构建过程中，修改了`/usr/local/lib/node_modules`和`/usr/local/bin`的权限，允许`cookie`用户写入。虽然这本身不是投毒行为，但如果构建环境或后续使用中存在其他漏洞，攻击者可能利用这些宽松的权限进行投毒，例如通过npm安装恶意依赖。因此，存在一定的投毒风险，但是从提供的代码片段来看，直接投毒的可能性较低，估计为10%。

**利用方式：**
1.  **条件：** 需要应用程序使用`tough-cookie`库的受影响版本（小于4.1.3），并且在创建`CookieJar`实例时，设置`rejectPublicSuffixes`为`false`。
2.  **攻击步骤：** 攻击者构造一个包含恶意属性的Cookie，例如`__proto__.polluted = true`。将此Cookie发送到服务器或客户端。
3.  **结果：** `Object.prototype`会被污染，所有JavaScript对象都会继承`polluted`属性，这可能会导致意外的行为或安全问题。
4. **修复方式：** 更新`tough-cookie`到4.1.3或更高版本。避免设置`rejectPublicSuffixes`为`false`。


**项目地址:** [guy2610/tough-cookie-patch-cve-2023-26136](https://github.com/guy2610/tough-cookie-patch-cve-2023-26136)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #4

**来源**: [CVE-2023-26136-m-lito13_SealSecurity_Exam.md](../2023/CVE-2023-26136-m-lito13_SealSecurity_Exam.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或权限提升

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar且rejectPublicSuffixes=false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包在4.1.3版本之前的原型污染漏洞。当使用CookieJar且`rejectPublicSuffixes=false`时，由于对Cookie处理不当，攻击者可以通过构造恶意的Cookie，例如将Cookie的Domain设置为`__proto__`，从而污染JavaScript对象的原型，影响所有继承该原型的对象。

**有效性：**
提供的POC代码展示了如何利用URL查询参数或者直接设置Cookie的Domain为`__proto__`来污染原型。代码中还提供了修复方案，即在初始化对象时使用`Object.create(null)`，创建一个没有原型的空对象，以防止原型污染。

**投毒风险：**
该仓库中可能存在投毒代码。`changes.diff` 文件中虽然包含了修复漏洞的补丁，但是攻击者可能在提交修复补丁的同时，添加一些不易察觉的恶意代码，例如在其他文件中添加后门，或者修改构建脚本引入恶意依赖。评估投毒风险为10%，主要是因为该仓库看起来是一个学习/演示项目，而非实际的发布包，投毒的动机相对较低。需要仔细审查代码变更，特别是构建和依赖管理部分，才能确定是否存在恶意代码。

**利用方式：**
1.  **构造恶意URL：** 攻击者可以构造包含`__proto__`属性的URL，例如`https://vulnerable-website.com/?__proto__[badProperty]=payload`，当URL解析器处理该URL时，会将`badProperty`添加到所有对象的原型链上。
2.  **设置恶意Cookie：**  攻击者可以设置Cookie的Domain为`__proto__`，并设置相应的属性值。当`tough-cookie`处理该Cookie时，会将属性添加到所有对象的原型链上。示例代码如下：

```javascript
cookiejar.setCookie("Slonser=polluted; Domain=__proto__; Path=/notauth", "https://__proto__/admin", { loose: true }, (err, cookie) => {})
```

**影响：**
成功利用此漏洞后，攻击者可以修改全局对象的属性，从而影响整个应用程序的行为。例如，可以修改内置对象的属性，导致程序崩溃或执行恶意代码。在某些情况下，攻击者还可以利用原型污染漏洞实现权限提升。

**项目地址:** [m-lito13/SealSecurity_Exam](https://github.com/m-lito13/SealSecurity_Exam)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #5

**来源**: [CVE-2023-26136-morrisel_CVE-2023-26136.md](../2023/CVE-2023-26136-morrisel_CVE-2023-26136.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致应用配置被篡改，甚至远程代码执行，取决于应用如何使用受污染的原型

**影响版本:** < 4.1.3

**利用条件:** 需要在使用 tough-cookie 的应用中，CookieJar 的 rejectPublicSuffixes 设置为 false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136 是 tough-cookie 包版本低于 4.1.3 的原型污染漏洞。当 CookieJar 的 rejectPublicSuffixes 设置为 false 时，由于不正确地处理 Cookie，导致原型污染。漏洞出现在对象的初始化方式上。

**有效性：**
提供的 POC 代码通过修改 `memstore.js` 文件，将 `this.idx = {};` 替换为 `this.idx = Object.create(null);` 来修复该漏洞。原始版本在特定配置下确实存在原型污染的风险，而修改后的版本避免了从 `Object.prototype` 继承属性，从而阻止了原型污染。根据提供的 `index.js` 中的测试脚本显示，原始版本会被成功利用（`EXPLOITED SUCCESSFULLY`），而修复后的版本利用会失败（`EXPLOIT FAILED`），验证了 POC 的有效性。

**投毒风险：**
代码库中可能存在投毒风险。虽然主要的修改是为了修复原型污染漏洞，但是仍然存在一些小的风险。

*   **非必要文件：**`README.md`中存在作者信息,增加了溯源的可能性,降低了攻击者匿名性,正常漏洞仓库中不应存在作者信息.
*   **测试代码：** 测试代码中可能存在后门，或者可能被修改为包含恶意行为。

综合考虑，代码库中存在潜在投毒代码的风险较低，约为10%。

**利用方式：**
1.  **漏洞前提：** 应用使用了受影响版本的 `tough-cookie`，并且 `CookieJar` 的 `rejectPublicSuffixes` 设置为 `false`。
2.  **攻击方式：** 攻击者通过构造包含恶意属性的 Cookie，例如 `__proto__.polluted = 'evil'`，并将其注入到 CookieJar 中。
3.  **漏洞结果：** 由于 `tough-cookie` 在初始化对象时存在缺陷，恶意属性会被添加到 `Object.prototype` 上，从而污染了整个 JavaScript 应用的原型链。攻击者可以通过污染原型链来修改应用的行为，例如修改全局配置、注入恶意代码等。具体危害取决于应用如何使用受污染的原型，严重情况下可能导致远程代码执行。
4.  **修复方式：** 使用 `Object.create(null)` 创建对象，避免从 `Object.prototype` 继承属性。

**项目地址:** [morrisel/CVE-2023-26136](https://github.com/morrisel/CVE-2023-26136)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #6

**来源**: [CVE-2023-26136-ronmadar_Open-Source-Seal-Security.md](../2023/CVE-2023-26136-ronmadar_Open-Source-Seal-Security.md)

## CVE-2023-26136-tough-cookie-Prototype污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** Prototype Pollution

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或篡改应用行为

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar，并且rejectPublicSuffixes设置为false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包在4.1.3版本之前存在的一个原型污染漏洞。当使用CookieJar且rejectPublicSuffixes=false时，由于对Cookie处理不当，可能导致原型污染。

**有效性评估：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的。多个来源确认了此漏洞的存在，并提供了修复方案。

**利用方式：**
攻击者可以通过构造恶意的cookie，特别是当cookie的domain设置为`__proto__`时，利用`tough-cookie`库在处理cookie时，向Object.prototype注入恶意属性。由于JavaScript中所有对象都继承自Object.prototype，这会影响应用程序的全局状态，可能导致：

*   **拒绝服务 (DoS):** 通过注入导致异常或无限循环的属性。
*   **篡改应用行为:** 通过注入改变应用程序逻辑的关键属性，影响其行为。

提供的代码尝试通过设置特定的cookie来触发原型污染。`index.js` 脚本的逻辑是创建一个cookie jar，然后尝试设置一个具有特定属性的cookie。`vulnerable`变量控制是否禁用`rejectPublicSuffixes`。如果设置为true，则模拟易受攻击的情况。

**投毒风险评估：**
提供的代码主要包含以下文件：
*   `README.md`: 漏洞描述、修复方案和项目说明。
*   `index.js`: 包含原型污染漏洞的验证代码
    * `test-unit.js`: 测试用例，用于验证修复方案。
    * `testVerifyVulnerable.js`: 测试脚本，用于验证漏洞修复后的行为。

综合评估来看，投毒风险较低。风险点在于 `index.js` 是否存在后门代码，但分析内容可知，该文件主要是漏洞验证代码，不存在恶意行为。

**分析：** 该漏洞利用了JavaScript原型链的特性。通过原型污染，攻击者可以影响所有JavaScript对象的行为。修复此漏洞的关键在于防止在处理cookie时直接操作`Object.prototype`。snyk提供的链接指向的修复方案表明，该漏洞是通过不安全的对象递归合并以及通过路径定义属性造成的。该代码提供了一个简单的原型污染验证，在实际利用中，攻击者可能需要更精细地构造cookie，以便产生更大的影响。

**项目地址:** [ronmadar/Open-Source-Seal-Security](https://github.com/ronmadar/Open-Source-Seal-Security)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #7

**来源**: [CVE-2023-26136-uriyahav_tough-cookie-2.5.0-cve-2023-26136-fix.md](../2023/CVE-2023-26136-uriyahav_tough-cookie-2.5.0-cve-2023-26136-fix.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致应用程序行为被篡改，甚至造成拒绝服务

**影响版本:** < 4.1.3

**利用条件:** 需要应用程序使用受影响版本的tough-cookie，并且在rejectPublicSuffixes=false的模式下使用CookieJar。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-26136是tough-cookie库中一个原型污染漏洞。当CookieJar在rejectPublicSuffixes=false模式下处理Cookie时，由于对象初始化不当导致。攻击者可以通过设置具有恶意域（例如`__proto__`）的cookie来污染`Object.prototype`，从而影响所有继承自该原型的对象。

**有效性分析：**

提供的POC代码（`tough-cookie/index.js`）旨在演示此漏洞，并且`test-cve-2023-26136.js`单元测试验证了修复程序。利用代码的描述表明，它能够成功利用易受攻击的版本，并且针对修补版本会失败，这表明POC是有效的。

**投毒风险分析：**

该仓库包含修复漏洞的代码和测试，以及利用漏洞的演示代码。虽然存在利用代码，但主要目的是验证修复程序。考虑到作者提供了修复方案、测试用例以及详细的漏洞描述，投毒的可能性较低。但仍然存在一定的风险，例如，`tough-cookie/index.js`如果被恶意修改，可能会在不知情的情况下引入后门。总体评估投毒风险为5%，主要是基于对代码质量和作者意图的信任，但不能完全排除。

**利用方式：**

1.  创建一个`CookieJar`实例，并将`rejectPublicSuffixes`设置为`false`。
2.  构造一个包含恶意域名（例如`__proto__`）的Cookie，将其设置为`CookieJar`。
3.  由于`rejectPublicSuffixes`为`false`，`tough-cookie`将尝试设置此cookie，从而污染`Object.prototype`。
4.  一旦`Object.prototype`被污染，所有基于此原型的对象都会受到影响，可能导致应用程序行为异常或安全漏洞。

**项目地址:** [uriyahav/tough-cookie-2.5.0-cve-2023-26136-fix](https://github.com/uriyahav/tough-cookie-2.5.0-cve-2023-26136-fix)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---



---

## POC #2

**来源**: [CVE-2023-26136-dani33339_Tough-Cookie-v2.5.0-Patched.md](../2023/CVE-2023-26136-dani33339_Tough-Cookie-v2.5.0-Patched.md)

## CVE-2023-26136-tough-cookie-Prototype Pollution

**漏洞编号:** CVE-2023-26136

**漏洞类型:** Prototype Pollution

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致权限提升和拒绝服务

**影响版本:** < 4.1.3

**利用条件:** 需要CookieJar使用rejectPublicSuffixes=false模式

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包中的一个原型污染漏洞，影响版本低于4.1.3。当CookieJar以`rejectPublicSuffixes=false`模式使用时，由于对Cookie处理不当，可能导致原型污染。具体来说，如果`cookie.domain`被设置为`__proto__`，攻击者可以修改`Object.prototype`，从而影响整个应用程序的行为。根据漏洞信息，该漏洞的CVSS评分为6.5，属于中危漏洞。搜索结果确认了漏洞的存在以及受影响的版本。提供的漏洞利用代码包括Dockerfile、LICENSE和README.md。README.md描述了漏洞和修复方案，以及安装patched版本的说明。Dockerfile用于构建包含易受攻击或修复后的tough-cookie版本的环境。LICENSE是MIT许可证。 

**有效性：**
根据README.md的描述，以及漏洞库信息和搜索结果，该漏洞确实存在并且可以被利用。

**投毒风险：**
检查提供的文件，主要风险点在于Dockerfile。虽然Dockerfile包含了一些常见的操作，例如安装vim和创建用户，但没有发现明显的恶意代码或后门。然而，`chmod -R a+w /usr/local/lib/node_modules`和`chmod -R a+w /usr/local/bin`这两条命令将给予所有用户对node_modules和/usr/local/bin的写权限，这可能被利用来安装恶意模块或者替换系统命令，从而实现投毒。LICENSE文件和README文件本身没有明显的投毒风险。因此，存在一定的投毒风险，但不是非常高，大概10%的风险。

**利用方式：**
利用方式是通过设置`cookie.domain`为`__proto__`来修改`Object.prototype`，进而影响使用tough-cookie的应用程序的行为。需要注意的是，利用需要应用程序配置`rejectPublicSuffixes=false`。攻击者可以通过发送包含特制Cookie的HTTP请求来触发该漏洞。攻击成功后，攻击者可以修改JavaScript对象的默认属性，从而导致权限提升、信息泄露或拒绝服务。

**项目地址:** [dani33339/Tough-Cookie-v2.5.0-Patched](https://github.com/dani33339/Tough-Cookie-v2.5.0-Patched)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #3

**来源**: [CVE-2023-26136-guy2610_tough-cookie-patch-cve-2023-26136.md](../2023/CVE-2023-26136-guy2610_tough-cookie-patch-cve-2023-26136.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或客户端代码执行

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar，并且rejectPublicSuffixes=false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包中的一个原型污染漏洞，影响4.1.3之前的版本。该漏洞是由于在使用CookieJar时，对Cookie的处理不当造成的，特别是当`rejectPublicSuffixes`设置为`false`时。攻击者可以通过构造恶意的Cookie，污染JavaScript对象的原型，从而影响应用程序的行为。虽然漏洞描述中提到影响的是客户端，但是如果服务器端也使用了存在漏洞的tough-cookie版本，并且依赖于受污染的原型属性，那么也可能受到影响。

**有效性：**
漏洞库信息和搜索引擎结果都确认了漏洞的存在，并且提供了commit信息，说明该漏洞已被修复。给出的Dockerfile和代码片段是tough-cookie仓库的代码，包括Dockerfile、LICENSE和README.md。这些文件本身不是漏洞利用代码，而是构建和描述该库的文件。

**投毒风险：**
提供的Dockerfile在构建过程中，修改了`/usr/local/lib/node_modules`和`/usr/local/bin`的权限，允许`cookie`用户写入。虽然这本身不是投毒行为，但如果构建环境或后续使用中存在其他漏洞，攻击者可能利用这些宽松的权限进行投毒，例如通过npm安装恶意依赖。因此，存在一定的投毒风险，但是从提供的代码片段来看，直接投毒的可能性较低，估计为10%。

**利用方式：**
1.  **条件：** 需要应用程序使用`tough-cookie`库的受影响版本（小于4.1.3），并且在创建`CookieJar`实例时，设置`rejectPublicSuffixes`为`false`。
2.  **攻击步骤：** 攻击者构造一个包含恶意属性的Cookie，例如`__proto__.polluted = true`。将此Cookie发送到服务器或客户端。
3.  **结果：** `Object.prototype`会被污染，所有JavaScript对象都会继承`polluted`属性，这可能会导致意外的行为或安全问题。
4. **修复方式：** 更新`tough-cookie`到4.1.3或更高版本。避免设置`rejectPublicSuffixes`为`false`。


**项目地址:** [guy2610/tough-cookie-patch-cve-2023-26136](https://github.com/guy2610/tough-cookie-patch-cve-2023-26136)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #4

**来源**: [CVE-2023-26136-m-lito13_SealSecurity_Exam.md](../2023/CVE-2023-26136-m-lito13_SealSecurity_Exam.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或权限提升

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar且rejectPublicSuffixes=false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包在4.1.3版本之前的原型污染漏洞。当使用CookieJar且`rejectPublicSuffixes=false`时，由于对Cookie处理不当，攻击者可以通过构造恶意的Cookie，例如将Cookie的Domain设置为`__proto__`，从而污染JavaScript对象的原型，影响所有继承该原型的对象。

**有效性：**
提供的POC代码展示了如何利用URL查询参数或者直接设置Cookie的Domain为`__proto__`来污染原型。代码中还提供了修复方案，即在初始化对象时使用`Object.create(null)`，创建一个没有原型的空对象，以防止原型污染。

**投毒风险：**
该仓库中可能存在投毒代码。`changes.diff` 文件中虽然包含了修复漏洞的补丁，但是攻击者可能在提交修复补丁的同时，添加一些不易察觉的恶意代码，例如在其他文件中添加后门，或者修改构建脚本引入恶意依赖。评估投毒风险为10%，主要是因为该仓库看起来是一个学习/演示项目，而非实际的发布包，投毒的动机相对较低。需要仔细审查代码变更，特别是构建和依赖管理部分，才能确定是否存在恶意代码。

**利用方式：**
1.  **构造恶意URL：** 攻击者可以构造包含`__proto__`属性的URL，例如`https://vulnerable-website.com/?__proto__[badProperty]=payload`，当URL解析器处理该URL时，会将`badProperty`添加到所有对象的原型链上。
2.  **设置恶意Cookie：**  攻击者可以设置Cookie的Domain为`__proto__`，并设置相应的属性值。当`tough-cookie`处理该Cookie时，会将属性添加到所有对象的原型链上。示例代码如下：

```javascript
cookiejar.setCookie("Slonser=polluted; Domain=__proto__; Path=/notauth", "https://__proto__/admin", { loose: true }, (err, cookie) => {})
```

**影响：**
成功利用此漏洞后，攻击者可以修改全局对象的属性，从而影响整个应用程序的行为。例如，可以修改内置对象的属性，导致程序崩溃或执行恶意代码。在某些情况下，攻击者还可以利用原型污染漏洞实现权限提升。

**项目地址:** [m-lito13/SealSecurity_Exam](https://github.com/m-lito13/SealSecurity_Exam)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #5

**来源**: [CVE-2023-26136-morrisel_CVE-2023-26136.md](../2023/CVE-2023-26136-morrisel_CVE-2023-26136.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致应用配置被篡改，甚至远程代码执行，取决于应用如何使用受污染的原型

**影响版本:** < 4.1.3

**利用条件:** 需要在使用 tough-cookie 的应用中，CookieJar 的 rejectPublicSuffixes 设置为 false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136 是 tough-cookie 包版本低于 4.1.3 的原型污染漏洞。当 CookieJar 的 rejectPublicSuffixes 设置为 false 时，由于不正确地处理 Cookie，导致原型污染。漏洞出现在对象的初始化方式上。

**有效性：**
提供的 POC 代码通过修改 `memstore.js` 文件，将 `this.idx = {};` 替换为 `this.idx = Object.create(null);` 来修复该漏洞。原始版本在特定配置下确实存在原型污染的风险，而修改后的版本避免了从 `Object.prototype` 继承属性，从而阻止了原型污染。根据提供的 `index.js` 中的测试脚本显示，原始版本会被成功利用（`EXPLOITED SUCCESSFULLY`），而修复后的版本利用会失败（`EXPLOIT FAILED`），验证了 POC 的有效性。

**投毒风险：**
代码库中可能存在投毒风险。虽然主要的修改是为了修复原型污染漏洞，但是仍然存在一些小的风险。

*   **非必要文件：**`README.md`中存在作者信息,增加了溯源的可能性,降低了攻击者匿名性,正常漏洞仓库中不应存在作者信息.
*   **测试代码：** 测试代码中可能存在后门，或者可能被修改为包含恶意行为。

综合考虑，代码库中存在潜在投毒代码的风险较低，约为10%。

**利用方式：**
1.  **漏洞前提：** 应用使用了受影响版本的 `tough-cookie`，并且 `CookieJar` 的 `rejectPublicSuffixes` 设置为 `false`。
2.  **攻击方式：** 攻击者通过构造包含恶意属性的 Cookie，例如 `__proto__.polluted = 'evil'`，并将其注入到 CookieJar 中。
3.  **漏洞结果：** 由于 `tough-cookie` 在初始化对象时存在缺陷，恶意属性会被添加到 `Object.prototype` 上，从而污染了整个 JavaScript 应用的原型链。攻击者可以通过污染原型链来修改应用的行为，例如修改全局配置、注入恶意代码等。具体危害取决于应用如何使用受污染的原型，严重情况下可能导致远程代码执行。
4.  **修复方式：** 使用 `Object.create(null)` 创建对象，避免从 `Object.prototype` 继承属性。

**项目地址:** [morrisel/CVE-2023-26136](https://github.com/morrisel/CVE-2023-26136)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #6

**来源**: [CVE-2023-26136-ronmadar_Open-Source-Seal-Security.md](../2023/CVE-2023-26136-ronmadar_Open-Source-Seal-Security.md)

## CVE-2023-26136-tough-cookie-Prototype污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** Prototype Pollution

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或篡改应用行为

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar，并且rejectPublicSuffixes设置为false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包在4.1.3版本之前存在的一个原型污染漏洞。当使用CookieJar且rejectPublicSuffixes=false时，由于对Cookie处理不当，可能导致原型污染。

**有效性评估：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的。多个来源确认了此漏洞的存在，并提供了修复方案。

**利用方式：**
攻击者可以通过构造恶意的cookie，特别是当cookie的domain设置为`__proto__`时，利用`tough-cookie`库在处理cookie时，向Object.prototype注入恶意属性。由于JavaScript中所有对象都继承自Object.prototype，这会影响应用程序的全局状态，可能导致：

*   **拒绝服务 (DoS):** 通过注入导致异常或无限循环的属性。
*   **篡改应用行为:** 通过注入改变应用程序逻辑的关键属性，影响其行为。

提供的代码尝试通过设置特定的cookie来触发原型污染。`index.js` 脚本的逻辑是创建一个cookie jar，然后尝试设置一个具有特定属性的cookie。`vulnerable`变量控制是否禁用`rejectPublicSuffixes`。如果设置为true，则模拟易受攻击的情况。

**投毒风险评估：**
提供的代码主要包含以下文件：
*   `README.md`: 漏洞描述、修复方案和项目说明。
*   `index.js`: 包含原型污染漏洞的验证代码
    * `test-unit.js`: 测试用例，用于验证修复方案。
    * `testVerifyVulnerable.js`: 测试脚本，用于验证漏洞修复后的行为。

综合评估来看，投毒风险较低。风险点在于 `index.js` 是否存在后门代码，但分析内容可知，该文件主要是漏洞验证代码，不存在恶意行为。

**分析：** 该漏洞利用了JavaScript原型链的特性。通过原型污染，攻击者可以影响所有JavaScript对象的行为。修复此漏洞的关键在于防止在处理cookie时直接操作`Object.prototype`。snyk提供的链接指向的修复方案表明，该漏洞是通过不安全的对象递归合并以及通过路径定义属性造成的。该代码提供了一个简单的原型污染验证，在实际利用中，攻击者可能需要更精细地构造cookie，以便产生更大的影响。

**项目地址:** [ronmadar/Open-Source-Seal-Security](https://github.com/ronmadar/Open-Source-Seal-Security)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #7

**来源**: [CVE-2023-26136-uriyahav_tough-cookie-2.5.0-cve-2023-26136-fix.md](../2023/CVE-2023-26136-uriyahav_tough-cookie-2.5.0-cve-2023-26136-fix.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致应用程序行为被篡改，甚至造成拒绝服务

**影响版本:** < 4.1.3

**利用条件:** 需要应用程序使用受影响版本的tough-cookie，并且在rejectPublicSuffixes=false的模式下使用CookieJar。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-26136是tough-cookie库中一个原型污染漏洞。当CookieJar在rejectPublicSuffixes=false模式下处理Cookie时，由于对象初始化不当导致。攻击者可以通过设置具有恶意域（例如`__proto__`）的cookie来污染`Object.prototype`，从而影响所有继承自该原型的对象。

**有效性分析：**

提供的POC代码（`tough-cookie/index.js`）旨在演示此漏洞，并且`test-cve-2023-26136.js`单元测试验证了修复程序。利用代码的描述表明，它能够成功利用易受攻击的版本，并且针对修补版本会失败，这表明POC是有效的。

**投毒风险分析：**

该仓库包含修复漏洞的代码和测试，以及利用漏洞的演示代码。虽然存在利用代码，但主要目的是验证修复程序。考虑到作者提供了修复方案、测试用例以及详细的漏洞描述，投毒的可能性较低。但仍然存在一定的风险，例如，`tough-cookie/index.js`如果被恶意修改，可能会在不知情的情况下引入后门。总体评估投毒风险为5%，主要是基于对代码质量和作者意图的信任，但不能完全排除。

**利用方式：**

1.  创建一个`CookieJar`实例，并将`rejectPublicSuffixes`设置为`false`。
2.  构造一个包含恶意域名（例如`__proto__`）的Cookie，将其设置为`CookieJar`。
3.  由于`rejectPublicSuffixes`为`false`，`tough-cookie`将尝试设置此cookie，从而污染`Object.prototype`。
4.  一旦`Object.prototype`被污染，所有基于此原型的对象都会受到影响，可能导致应用程序行为异常或安全漏洞。

**项目地址:** [uriyahav/tough-cookie-2.5.0-cve-2023-26136-fix](https://github.com/uriyahav/tough-cookie-2.5.0-cve-2023-26136-fix)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---



---

## POC #2

**来源**: [CVE-2023-26136-dani33339_Tough-Cookie-v2.5.0-Patched.md](../2023/CVE-2023-26136-dani33339_Tough-Cookie-v2.5.0-Patched.md)

## CVE-2023-26136-tough-cookie-Prototype Pollution

**漏洞编号:** CVE-2023-26136

**漏洞类型:** Prototype Pollution

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致权限提升和拒绝服务

**影响版本:** < 4.1.3

**利用条件:** 需要CookieJar使用rejectPublicSuffixes=false模式

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包中的一个原型污染漏洞，影响版本低于4.1.3。当CookieJar以`rejectPublicSuffixes=false`模式使用时，由于对Cookie处理不当，可能导致原型污染。具体来说，如果`cookie.domain`被设置为`__proto__`，攻击者可以修改`Object.prototype`，从而影响整个应用程序的行为。根据漏洞信息，该漏洞的CVSS评分为6.5，属于中危漏洞。搜索结果确认了漏洞的存在以及受影响的版本。提供的漏洞利用代码包括Dockerfile、LICENSE和README.md。README.md描述了漏洞和修复方案，以及安装patched版本的说明。Dockerfile用于构建包含易受攻击或修复后的tough-cookie版本的环境。LICENSE是MIT许可证。 

**有效性：**
根据README.md的描述，以及漏洞库信息和搜索结果，该漏洞确实存在并且可以被利用。

**投毒风险：**
检查提供的文件，主要风险点在于Dockerfile。虽然Dockerfile包含了一些常见的操作，例如安装vim和创建用户，但没有发现明显的恶意代码或后门。然而，`chmod -R a+w /usr/local/lib/node_modules`和`chmod -R a+w /usr/local/bin`这两条命令将给予所有用户对node_modules和/usr/local/bin的写权限，这可能被利用来安装恶意模块或者替换系统命令，从而实现投毒。LICENSE文件和README文件本身没有明显的投毒风险。因此，存在一定的投毒风险，但不是非常高，大概10%的风险。

**利用方式：**
利用方式是通过设置`cookie.domain`为`__proto__`来修改`Object.prototype`，进而影响使用tough-cookie的应用程序的行为。需要注意的是，利用需要应用程序配置`rejectPublicSuffixes=false`。攻击者可以通过发送包含特制Cookie的HTTP请求来触发该漏洞。攻击成功后，攻击者可以修改JavaScript对象的默认属性，从而导致权限提升、信息泄露或拒绝服务。

**项目地址:** [dani33339/Tough-Cookie-v2.5.0-Patched](https://github.com/dani33339/Tough-Cookie-v2.5.0-Patched)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #3

**来源**: [CVE-2023-26136-guy2610_tough-cookie-patch-cve-2023-26136.md](../2023/CVE-2023-26136-guy2610_tough-cookie-patch-cve-2023-26136.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或客户端代码执行

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar，并且rejectPublicSuffixes=false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包中的一个原型污染漏洞，影响4.1.3之前的版本。该漏洞是由于在使用CookieJar时，对Cookie的处理不当造成的，特别是当`rejectPublicSuffixes`设置为`false`时。攻击者可以通过构造恶意的Cookie，污染JavaScript对象的原型，从而影响应用程序的行为。虽然漏洞描述中提到影响的是客户端，但是如果服务器端也使用了存在漏洞的tough-cookie版本，并且依赖于受污染的原型属性，那么也可能受到影响。

**有效性：**
漏洞库信息和搜索引擎结果都确认了漏洞的存在，并且提供了commit信息，说明该漏洞已被修复。给出的Dockerfile和代码片段是tough-cookie仓库的代码，包括Dockerfile、LICENSE和README.md。这些文件本身不是漏洞利用代码，而是构建和描述该库的文件。

**投毒风险：**
提供的Dockerfile在构建过程中，修改了`/usr/local/lib/node_modules`和`/usr/local/bin`的权限，允许`cookie`用户写入。虽然这本身不是投毒行为，但如果构建环境或后续使用中存在其他漏洞，攻击者可能利用这些宽松的权限进行投毒，例如通过npm安装恶意依赖。因此，存在一定的投毒风险，但是从提供的代码片段来看，直接投毒的可能性较低，估计为10%。

**利用方式：**
1.  **条件：** 需要应用程序使用`tough-cookie`库的受影响版本（小于4.1.3），并且在创建`CookieJar`实例时，设置`rejectPublicSuffixes`为`false`。
2.  **攻击步骤：** 攻击者构造一个包含恶意属性的Cookie，例如`__proto__.polluted = true`。将此Cookie发送到服务器或客户端。
3.  **结果：** `Object.prototype`会被污染，所有JavaScript对象都会继承`polluted`属性，这可能会导致意外的行为或安全问题。
4. **修复方式：** 更新`tough-cookie`到4.1.3或更高版本。避免设置`rejectPublicSuffixes`为`false`。


**项目地址:** [guy2610/tough-cookie-patch-cve-2023-26136](https://github.com/guy2610/tough-cookie-patch-cve-2023-26136)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #4

**来源**: [CVE-2023-26136-m-lito13_SealSecurity_Exam.md](../2023/CVE-2023-26136-m-lito13_SealSecurity_Exam.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或权限提升

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar且rejectPublicSuffixes=false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包在4.1.3版本之前的原型污染漏洞。当使用CookieJar且`rejectPublicSuffixes=false`时，由于对Cookie处理不当，攻击者可以通过构造恶意的Cookie，例如将Cookie的Domain设置为`__proto__`，从而污染JavaScript对象的原型，影响所有继承该原型的对象。

**有效性：**
提供的POC代码展示了如何利用URL查询参数或者直接设置Cookie的Domain为`__proto__`来污染原型。代码中还提供了修复方案，即在初始化对象时使用`Object.create(null)`，创建一个没有原型的空对象，以防止原型污染。

**投毒风险：**
该仓库中可能存在投毒代码。`changes.diff` 文件中虽然包含了修复漏洞的补丁，但是攻击者可能在提交修复补丁的同时，添加一些不易察觉的恶意代码，例如在其他文件中添加后门，或者修改构建脚本引入恶意依赖。评估投毒风险为10%，主要是因为该仓库看起来是一个学习/演示项目，而非实际的发布包，投毒的动机相对较低。需要仔细审查代码变更，特别是构建和依赖管理部分，才能确定是否存在恶意代码。

**利用方式：**
1.  **构造恶意URL：** 攻击者可以构造包含`__proto__`属性的URL，例如`https://vulnerable-website.com/?__proto__[badProperty]=payload`，当URL解析器处理该URL时，会将`badProperty`添加到所有对象的原型链上。
2.  **设置恶意Cookie：**  攻击者可以设置Cookie的Domain为`__proto__`，并设置相应的属性值。当`tough-cookie`处理该Cookie时，会将属性添加到所有对象的原型链上。示例代码如下：

```javascript
cookiejar.setCookie("Slonser=polluted; Domain=__proto__; Path=/notauth", "https://__proto__/admin", { loose: true }, (err, cookie) => {})
```

**影响：**
成功利用此漏洞后，攻击者可以修改全局对象的属性，从而影响整个应用程序的行为。例如，可以修改内置对象的属性，导致程序崩溃或执行恶意代码。在某些情况下，攻击者还可以利用原型污染漏洞实现权限提升。

**项目地址:** [m-lito13/SealSecurity_Exam](https://github.com/m-lito13/SealSecurity_Exam)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #5

**来源**: [CVE-2023-26136-morrisel_CVE-2023-26136.md](../2023/CVE-2023-26136-morrisel_CVE-2023-26136.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致应用配置被篡改，甚至远程代码执行，取决于应用如何使用受污染的原型

**影响版本:** < 4.1.3

**利用条件:** 需要在使用 tough-cookie 的应用中，CookieJar 的 rejectPublicSuffixes 设置为 false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136 是 tough-cookie 包版本低于 4.1.3 的原型污染漏洞。当 CookieJar 的 rejectPublicSuffixes 设置为 false 时，由于不正确地处理 Cookie，导致原型污染。漏洞出现在对象的初始化方式上。

**有效性：**
提供的 POC 代码通过修改 `memstore.js` 文件，将 `this.idx = {};` 替换为 `this.idx = Object.create(null);` 来修复该漏洞。原始版本在特定配置下确实存在原型污染的风险，而修改后的版本避免了从 `Object.prototype` 继承属性，从而阻止了原型污染。根据提供的 `index.js` 中的测试脚本显示，原始版本会被成功利用（`EXPLOITED SUCCESSFULLY`），而修复后的版本利用会失败（`EXPLOIT FAILED`），验证了 POC 的有效性。

**投毒风险：**
代码库中可能存在投毒风险。虽然主要的修改是为了修复原型污染漏洞，但是仍然存在一些小的风险。

*   **非必要文件：**`README.md`中存在作者信息,增加了溯源的可能性,降低了攻击者匿名性,正常漏洞仓库中不应存在作者信息.
*   **测试代码：** 测试代码中可能存在后门，或者可能被修改为包含恶意行为。

综合考虑，代码库中存在潜在投毒代码的风险较低，约为10%。

**利用方式：**
1.  **漏洞前提：** 应用使用了受影响版本的 `tough-cookie`，并且 `CookieJar` 的 `rejectPublicSuffixes` 设置为 `false`。
2.  **攻击方式：** 攻击者通过构造包含恶意属性的 Cookie，例如 `__proto__.polluted = 'evil'`，并将其注入到 CookieJar 中。
3.  **漏洞结果：** 由于 `tough-cookie` 在初始化对象时存在缺陷，恶意属性会被添加到 `Object.prototype` 上，从而污染了整个 JavaScript 应用的原型链。攻击者可以通过污染原型链来修改应用的行为，例如修改全局配置、注入恶意代码等。具体危害取决于应用如何使用受污染的原型，严重情况下可能导致远程代码执行。
4.  **修复方式：** 使用 `Object.create(null)` 创建对象，避免从 `Object.prototype` 继承属性。

**项目地址:** [morrisel/CVE-2023-26136](https://github.com/morrisel/CVE-2023-26136)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #6

**来源**: [CVE-2023-26136-ronmadar_Open-Source-Seal-Security.md](../2023/CVE-2023-26136-ronmadar_Open-Source-Seal-Security.md)

## CVE-2023-26136-tough-cookie-Prototype污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** Prototype Pollution

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或篡改应用行为

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar，并且rejectPublicSuffixes设置为false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包在4.1.3版本之前存在的一个原型污染漏洞。当使用CookieJar且rejectPublicSuffixes=false时，由于对Cookie处理不当，可能导致原型污染。

**有效性评估：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的。多个来源确认了此漏洞的存在，并提供了修复方案。

**利用方式：**
攻击者可以通过构造恶意的cookie，特别是当cookie的domain设置为`__proto__`时，利用`tough-cookie`库在处理cookie时，向Object.prototype注入恶意属性。由于JavaScript中所有对象都继承自Object.prototype，这会影响应用程序的全局状态，可能导致：

*   **拒绝服务 (DoS):** 通过注入导致异常或无限循环的属性。
*   **篡改应用行为:** 通过注入改变应用程序逻辑的关键属性，影响其行为。

提供的代码尝试通过设置特定的cookie来触发原型污染。`index.js` 脚本的逻辑是创建一个cookie jar，然后尝试设置一个具有特定属性的cookie。`vulnerable`变量控制是否禁用`rejectPublicSuffixes`。如果设置为true，则模拟易受攻击的情况。

**投毒风险评估：**
提供的代码主要包含以下文件：
*   `README.md`: 漏洞描述、修复方案和项目说明。
*   `index.js`: 包含原型污染漏洞的验证代码
    * `test-unit.js`: 测试用例，用于验证修复方案。
    * `testVerifyVulnerable.js`: 测试脚本，用于验证漏洞修复后的行为。

综合评估来看，投毒风险较低。风险点在于 `index.js` 是否存在后门代码，但分析内容可知，该文件主要是漏洞验证代码，不存在恶意行为。

**分析：** 该漏洞利用了JavaScript原型链的特性。通过原型污染，攻击者可以影响所有JavaScript对象的行为。修复此漏洞的关键在于防止在处理cookie时直接操作`Object.prototype`。snyk提供的链接指向的修复方案表明，该漏洞是通过不安全的对象递归合并以及通过路径定义属性造成的。该代码提供了一个简单的原型污染验证，在实际利用中，攻击者可能需要更精细地构造cookie，以便产生更大的影响。

**项目地址:** [ronmadar/Open-Source-Seal-Security](https://github.com/ronmadar/Open-Source-Seal-Security)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #7

**来源**: [CVE-2023-26136-uriyahav_tough-cookie-2.5.0-cve-2023-26136-fix.md](../2023/CVE-2023-26136-uriyahav_tough-cookie-2.5.0-cve-2023-26136-fix.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致应用程序行为被篡改，甚至造成拒绝服务

**影响版本:** < 4.1.3

**利用条件:** 需要应用程序使用受影响版本的tough-cookie，并且在rejectPublicSuffixes=false的模式下使用CookieJar。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-26136是tough-cookie库中一个原型污染漏洞。当CookieJar在rejectPublicSuffixes=false模式下处理Cookie时，由于对象初始化不当导致。攻击者可以通过设置具有恶意域（例如`__proto__`）的cookie来污染`Object.prototype`，从而影响所有继承自该原型的对象。

**有效性分析：**

提供的POC代码（`tough-cookie/index.js`）旨在演示此漏洞，并且`test-cve-2023-26136.js`单元测试验证了修复程序。利用代码的描述表明，它能够成功利用易受攻击的版本，并且针对修补版本会失败，这表明POC是有效的。

**投毒风险分析：**

该仓库包含修复漏洞的代码和测试，以及利用漏洞的演示代码。虽然存在利用代码，但主要目的是验证修复程序。考虑到作者提供了修复方案、测试用例以及详细的漏洞描述，投毒的可能性较低。但仍然存在一定的风险，例如，`tough-cookie/index.js`如果被恶意修改，可能会在不知情的情况下引入后门。总体评估投毒风险为5%，主要是基于对代码质量和作者意图的信任，但不能完全排除。

**利用方式：**

1.  创建一个`CookieJar`实例，并将`rejectPublicSuffixes`设置为`false`。
2.  构造一个包含恶意域名（例如`__proto__`）的Cookie，将其设置为`CookieJar`。
3.  由于`rejectPublicSuffixes`为`false`，`tough-cookie`将尝试设置此cookie，从而污染`Object.prototype`。
4.  一旦`Object.prototype`被污染，所有基于此原型的对象都会受到影响，可能导致应用程序行为异常或安全漏洞。

**项目地址:** [uriyahav/tough-cookie-2.5.0-cve-2023-26136-fix](https://github.com/uriyahav/tough-cookie-2.5.0-cve-2023-26136-fix)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---



---

## POC #2

**来源**: [CVE-2023-26136-dani33339_Tough-Cookie-v2.5.0-Patched.md](../2023/CVE-2023-26136-dani33339_Tough-Cookie-v2.5.0-Patched.md)

## CVE-2023-26136-tough-cookie-Prototype Pollution

**漏洞编号:** CVE-2023-26136

**漏洞类型:** Prototype Pollution

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致权限提升和拒绝服务

**影响版本:** < 4.1.3

**利用条件:** 需要CookieJar使用rejectPublicSuffixes=false模式

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包中的一个原型污染漏洞，影响版本低于4.1.3。当CookieJar以`rejectPublicSuffixes=false`模式使用时，由于对Cookie处理不当，可能导致原型污染。具体来说，如果`cookie.domain`被设置为`__proto__`，攻击者可以修改`Object.prototype`，从而影响整个应用程序的行为。根据漏洞信息，该漏洞的CVSS评分为6.5，属于中危漏洞。搜索结果确认了漏洞的存在以及受影响的版本。提供的漏洞利用代码包括Dockerfile、LICENSE和README.md。README.md描述了漏洞和修复方案，以及安装patched版本的说明。Dockerfile用于构建包含易受攻击或修复后的tough-cookie版本的环境。LICENSE是MIT许可证。 

**有效性：**
根据README.md的描述，以及漏洞库信息和搜索结果，该漏洞确实存在并且可以被利用。

**投毒风险：**
检查提供的文件，主要风险点在于Dockerfile。虽然Dockerfile包含了一些常见的操作，例如安装vim和创建用户，但没有发现明显的恶意代码或后门。然而，`chmod -R a+w /usr/local/lib/node_modules`和`chmod -R a+w /usr/local/bin`这两条命令将给予所有用户对node_modules和/usr/local/bin的写权限，这可能被利用来安装恶意模块或者替换系统命令，从而实现投毒。LICENSE文件和README文件本身没有明显的投毒风险。因此，存在一定的投毒风险，但不是非常高，大概10%的风险。

**利用方式：**
利用方式是通过设置`cookie.domain`为`__proto__`来修改`Object.prototype`，进而影响使用tough-cookie的应用程序的行为。需要注意的是，利用需要应用程序配置`rejectPublicSuffixes=false`。攻击者可以通过发送包含特制Cookie的HTTP请求来触发该漏洞。攻击成功后，攻击者可以修改JavaScript对象的默认属性，从而导致权限提升、信息泄露或拒绝服务。

**项目地址:** [dani33339/Tough-Cookie-v2.5.0-Patched](https://github.com/dani33339/Tough-Cookie-v2.5.0-Patched)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #3

**来源**: [CVE-2023-26136-guy2610_tough-cookie-patch-cve-2023-26136.md](../2023/CVE-2023-26136-guy2610_tough-cookie-patch-cve-2023-26136.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或客户端代码执行

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar，并且rejectPublicSuffixes=false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包中的一个原型污染漏洞，影响4.1.3之前的版本。该漏洞是由于在使用CookieJar时，对Cookie的处理不当造成的，特别是当`rejectPublicSuffixes`设置为`false`时。攻击者可以通过构造恶意的Cookie，污染JavaScript对象的原型，从而影响应用程序的行为。虽然漏洞描述中提到影响的是客户端，但是如果服务器端也使用了存在漏洞的tough-cookie版本，并且依赖于受污染的原型属性，那么也可能受到影响。

**有效性：**
漏洞库信息和搜索引擎结果都确认了漏洞的存在，并且提供了commit信息，说明该漏洞已被修复。给出的Dockerfile和代码片段是tough-cookie仓库的代码，包括Dockerfile、LICENSE和README.md。这些文件本身不是漏洞利用代码，而是构建和描述该库的文件。

**投毒风险：**
提供的Dockerfile在构建过程中，修改了`/usr/local/lib/node_modules`和`/usr/local/bin`的权限，允许`cookie`用户写入。虽然这本身不是投毒行为，但如果构建环境或后续使用中存在其他漏洞，攻击者可能利用这些宽松的权限进行投毒，例如通过npm安装恶意依赖。因此，存在一定的投毒风险，但是从提供的代码片段来看，直接投毒的可能性较低，估计为10%。

**利用方式：**
1.  **条件：** 需要应用程序使用`tough-cookie`库的受影响版本（小于4.1.3），并且在创建`CookieJar`实例时，设置`rejectPublicSuffixes`为`false`。
2.  **攻击步骤：** 攻击者构造一个包含恶意属性的Cookie，例如`__proto__.polluted = true`。将此Cookie发送到服务器或客户端。
3.  **结果：** `Object.prototype`会被污染，所有JavaScript对象都会继承`polluted`属性，这可能会导致意外的行为或安全问题。
4. **修复方式：** 更新`tough-cookie`到4.1.3或更高版本。避免设置`rejectPublicSuffixes`为`false`。


**项目地址:** [guy2610/tough-cookie-patch-cve-2023-26136](https://github.com/guy2610/tough-cookie-patch-cve-2023-26136)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #4

**来源**: [CVE-2023-26136-m-lito13_SealSecurity_Exam.md](../2023/CVE-2023-26136-m-lito13_SealSecurity_Exam.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或权限提升

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar且rejectPublicSuffixes=false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包在4.1.3版本之前的原型污染漏洞。当使用CookieJar且`rejectPublicSuffixes=false`时，由于对Cookie处理不当，攻击者可以通过构造恶意的Cookie，例如将Cookie的Domain设置为`__proto__`，从而污染JavaScript对象的原型，影响所有继承该原型的对象。

**有效性：**
提供的POC代码展示了如何利用URL查询参数或者直接设置Cookie的Domain为`__proto__`来污染原型。代码中还提供了修复方案，即在初始化对象时使用`Object.create(null)`，创建一个没有原型的空对象，以防止原型污染。

**投毒风险：**
该仓库中可能存在投毒代码。`changes.diff` 文件中虽然包含了修复漏洞的补丁，但是攻击者可能在提交修复补丁的同时，添加一些不易察觉的恶意代码，例如在其他文件中添加后门，或者修改构建脚本引入恶意依赖。评估投毒风险为10%，主要是因为该仓库看起来是一个学习/演示项目，而非实际的发布包，投毒的动机相对较低。需要仔细审查代码变更，特别是构建和依赖管理部分，才能确定是否存在恶意代码。

**利用方式：**
1.  **构造恶意URL：** 攻击者可以构造包含`__proto__`属性的URL，例如`https://vulnerable-website.com/?__proto__[badProperty]=payload`，当URL解析器处理该URL时，会将`badProperty`添加到所有对象的原型链上。
2.  **设置恶意Cookie：**  攻击者可以设置Cookie的Domain为`__proto__`，并设置相应的属性值。当`tough-cookie`处理该Cookie时，会将属性添加到所有对象的原型链上。示例代码如下：

```javascript
cookiejar.setCookie("Slonser=polluted; Domain=__proto__; Path=/notauth", "https://__proto__/admin", { loose: true }, (err, cookie) => {})
```

**影响：**
成功利用此漏洞后，攻击者可以修改全局对象的属性，从而影响整个应用程序的行为。例如，可以修改内置对象的属性，导致程序崩溃或执行恶意代码。在某些情况下，攻击者还可以利用原型污染漏洞实现权限提升。

**项目地址:** [m-lito13/SealSecurity_Exam](https://github.com/m-lito13/SealSecurity_Exam)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #5

**来源**: [CVE-2023-26136-morrisel_CVE-2023-26136.md](../2023/CVE-2023-26136-morrisel_CVE-2023-26136.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致应用配置被篡改，甚至远程代码执行，取决于应用如何使用受污染的原型

**影响版本:** < 4.1.3

**利用条件:** 需要在使用 tough-cookie 的应用中，CookieJar 的 rejectPublicSuffixes 设置为 false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136 是 tough-cookie 包版本低于 4.1.3 的原型污染漏洞。当 CookieJar 的 rejectPublicSuffixes 设置为 false 时，由于不正确地处理 Cookie，导致原型污染。漏洞出现在对象的初始化方式上。

**有效性：**
提供的 POC 代码通过修改 `memstore.js` 文件，将 `this.idx = {};` 替换为 `this.idx = Object.create(null);` 来修复该漏洞。原始版本在特定配置下确实存在原型污染的风险，而修改后的版本避免了从 `Object.prototype` 继承属性，从而阻止了原型污染。根据提供的 `index.js` 中的测试脚本显示，原始版本会被成功利用（`EXPLOITED SUCCESSFULLY`），而修复后的版本利用会失败（`EXPLOIT FAILED`），验证了 POC 的有效性。

**投毒风险：**
代码库中可能存在投毒风险。虽然主要的修改是为了修复原型污染漏洞，但是仍然存在一些小的风险。

*   **非必要文件：**`README.md`中存在作者信息,增加了溯源的可能性,降低了攻击者匿名性,正常漏洞仓库中不应存在作者信息.
*   **测试代码：** 测试代码中可能存在后门，或者可能被修改为包含恶意行为。

综合考虑，代码库中存在潜在投毒代码的风险较低，约为10%。

**利用方式：**
1.  **漏洞前提：** 应用使用了受影响版本的 `tough-cookie`，并且 `CookieJar` 的 `rejectPublicSuffixes` 设置为 `false`。
2.  **攻击方式：** 攻击者通过构造包含恶意属性的 Cookie，例如 `__proto__.polluted = 'evil'`，并将其注入到 CookieJar 中。
3.  **漏洞结果：** 由于 `tough-cookie` 在初始化对象时存在缺陷，恶意属性会被添加到 `Object.prototype` 上，从而污染了整个 JavaScript 应用的原型链。攻击者可以通过污染原型链来修改应用的行为，例如修改全局配置、注入恶意代码等。具体危害取决于应用如何使用受污染的原型，严重情况下可能导致远程代码执行。
4.  **修复方式：** 使用 `Object.create(null)` 创建对象，避免从 `Object.prototype` 继承属性。

**项目地址:** [morrisel/CVE-2023-26136](https://github.com/morrisel/CVE-2023-26136)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #6

**来源**: [CVE-2023-26136-ronmadar_Open-Source-Seal-Security.md](../2023/CVE-2023-26136-ronmadar_Open-Source-Seal-Security.md)

## CVE-2023-26136-tough-cookie-Prototype污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** Prototype Pollution

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或篡改应用行为

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar，并且rejectPublicSuffixes设置为false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包在4.1.3版本之前存在的一个原型污染漏洞。当使用CookieJar且rejectPublicSuffixes=false时，由于对Cookie处理不当，可能导致原型污染。

**有效性评估：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的。多个来源确认了此漏洞的存在，并提供了修复方案。

**利用方式：**
攻击者可以通过构造恶意的cookie，特别是当cookie的domain设置为`__proto__`时，利用`tough-cookie`库在处理cookie时，向Object.prototype注入恶意属性。由于JavaScript中所有对象都继承自Object.prototype，这会影响应用程序的全局状态，可能导致：

*   **拒绝服务 (DoS):** 通过注入导致异常或无限循环的属性。
*   **篡改应用行为:** 通过注入改变应用程序逻辑的关键属性，影响其行为。

提供的代码尝试通过设置特定的cookie来触发原型污染。`index.js` 脚本的逻辑是创建一个cookie jar，然后尝试设置一个具有特定属性的cookie。`vulnerable`变量控制是否禁用`rejectPublicSuffixes`。如果设置为true，则模拟易受攻击的情况。

**投毒风险评估：**
提供的代码主要包含以下文件：
*   `README.md`: 漏洞描述、修复方案和项目说明。
*   `index.js`: 包含原型污染漏洞的验证代码
    * `test-unit.js`: 测试用例，用于验证修复方案。
    * `testVerifyVulnerable.js`: 测试脚本，用于验证漏洞修复后的行为。

综合评估来看，投毒风险较低。风险点在于 `index.js` 是否存在后门代码，但分析内容可知，该文件主要是漏洞验证代码，不存在恶意行为。

**分析：** 该漏洞利用了JavaScript原型链的特性。通过原型污染，攻击者可以影响所有JavaScript对象的行为。修复此漏洞的关键在于防止在处理cookie时直接操作`Object.prototype`。snyk提供的链接指向的修复方案表明，该漏洞是通过不安全的对象递归合并以及通过路径定义属性造成的。该代码提供了一个简单的原型污染验证，在实际利用中，攻击者可能需要更精细地构造cookie，以便产生更大的影响。

**项目地址:** [ronmadar/Open-Source-Seal-Security](https://github.com/ronmadar/Open-Source-Seal-Security)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #7

**来源**: [CVE-2023-26136-uriyahav_tough-cookie-2.5.0-cve-2023-26136-fix.md](../2023/CVE-2023-26136-uriyahav_tough-cookie-2.5.0-cve-2023-26136-fix.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致应用程序行为被篡改，甚至造成拒绝服务

**影响版本:** < 4.1.3

**利用条件:** 需要应用程序使用受影响版本的tough-cookie，并且在rejectPublicSuffixes=false的模式下使用CookieJar。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-26136是tough-cookie库中一个原型污染漏洞。当CookieJar在rejectPublicSuffixes=false模式下处理Cookie时，由于对象初始化不当导致。攻击者可以通过设置具有恶意域（例如`__proto__`）的cookie来污染`Object.prototype`，从而影响所有继承自该原型的对象。

**有效性分析：**

提供的POC代码（`tough-cookie/index.js`）旨在演示此漏洞，并且`test-cve-2023-26136.js`单元测试验证了修复程序。利用代码的描述表明，它能够成功利用易受攻击的版本，并且针对修补版本会失败，这表明POC是有效的。

**投毒风险分析：**

该仓库包含修复漏洞的代码和测试，以及利用漏洞的演示代码。虽然存在利用代码，但主要目的是验证修复程序。考虑到作者提供了修复方案、测试用例以及详细的漏洞描述，投毒的可能性较低。但仍然存在一定的风险，例如，`tough-cookie/index.js`如果被恶意修改，可能会在不知情的情况下引入后门。总体评估投毒风险为5%，主要是基于对代码质量和作者意图的信任，但不能完全排除。

**利用方式：**

1.  创建一个`CookieJar`实例，并将`rejectPublicSuffixes`设置为`false`。
2.  构造一个包含恶意域名（例如`__proto__`）的Cookie，将其设置为`CookieJar`。
3.  由于`rejectPublicSuffixes`为`false`，`tough-cookie`将尝试设置此cookie，从而污染`Object.prototype`。
4.  一旦`Object.prototype`被污染，所有基于此原型的对象都会受到影响，可能导致应用程序行为异常或安全漏洞。

**项目地址:** [uriyahav/tough-cookie-2.5.0-cve-2023-26136-fix](https://github.com/uriyahav/tough-cookie-2.5.0-cve-2023-26136-fix)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---



---

## POC #2

**来源**: [CVE-2023-26136-dani33339_Tough-Cookie-v2.5.0-Patched.md](../2023/CVE-2023-26136-dani33339_Tough-Cookie-v2.5.0-Patched.md)

## CVE-2023-26136-tough-cookie-Prototype Pollution

**漏洞编号:** CVE-2023-26136

**漏洞类型:** Prototype Pollution

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致权限提升和拒绝服务

**影响版本:** < 4.1.3

**利用条件:** 需要CookieJar使用rejectPublicSuffixes=false模式

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包中的一个原型污染漏洞，影响版本低于4.1.3。当CookieJar以`rejectPublicSuffixes=false`模式使用时，由于对Cookie处理不当，可能导致原型污染。具体来说，如果`cookie.domain`被设置为`__proto__`，攻击者可以修改`Object.prototype`，从而影响整个应用程序的行为。根据漏洞信息，该漏洞的CVSS评分为6.5，属于中危漏洞。搜索结果确认了漏洞的存在以及受影响的版本。提供的漏洞利用代码包括Dockerfile、LICENSE和README.md。README.md描述了漏洞和修复方案，以及安装patched版本的说明。Dockerfile用于构建包含易受攻击或修复后的tough-cookie版本的环境。LICENSE是MIT许可证。 

**有效性：**
根据README.md的描述，以及漏洞库信息和搜索结果，该漏洞确实存在并且可以被利用。

**投毒风险：**
检查提供的文件，主要风险点在于Dockerfile。虽然Dockerfile包含了一些常见的操作，例如安装vim和创建用户，但没有发现明显的恶意代码或后门。然而，`chmod -R a+w /usr/local/lib/node_modules`和`chmod -R a+w /usr/local/bin`这两条命令将给予所有用户对node_modules和/usr/local/bin的写权限，这可能被利用来安装恶意模块或者替换系统命令，从而实现投毒。LICENSE文件和README文件本身没有明显的投毒风险。因此，存在一定的投毒风险，但不是非常高，大概10%的风险。

**利用方式：**
利用方式是通过设置`cookie.domain`为`__proto__`来修改`Object.prototype`，进而影响使用tough-cookie的应用程序的行为。需要注意的是，利用需要应用程序配置`rejectPublicSuffixes=false`。攻击者可以通过发送包含特制Cookie的HTTP请求来触发该漏洞。攻击成功后，攻击者可以修改JavaScript对象的默认属性，从而导致权限提升、信息泄露或拒绝服务。

**项目地址:** [dani33339/Tough-Cookie-v2.5.0-Patched](https://github.com/dani33339/Tough-Cookie-v2.5.0-Patched)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #3

**来源**: [CVE-2023-26136-guy2610_tough-cookie-patch-cve-2023-26136.md](../2023/CVE-2023-26136-guy2610_tough-cookie-patch-cve-2023-26136.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或客户端代码执行

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar，并且rejectPublicSuffixes=false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包中的一个原型污染漏洞，影响4.1.3之前的版本。该漏洞是由于在使用CookieJar时，对Cookie的处理不当造成的，特别是当`rejectPublicSuffixes`设置为`false`时。攻击者可以通过构造恶意的Cookie，污染JavaScript对象的原型，从而影响应用程序的行为。虽然漏洞描述中提到影响的是客户端，但是如果服务器端也使用了存在漏洞的tough-cookie版本，并且依赖于受污染的原型属性，那么也可能受到影响。

**有效性：**
漏洞库信息和搜索引擎结果都确认了漏洞的存在，并且提供了commit信息，说明该漏洞已被修复。给出的Dockerfile和代码片段是tough-cookie仓库的代码，包括Dockerfile、LICENSE和README.md。这些文件本身不是漏洞利用代码，而是构建和描述该库的文件。

**投毒风险：**
提供的Dockerfile在构建过程中，修改了`/usr/local/lib/node_modules`和`/usr/local/bin`的权限，允许`cookie`用户写入。虽然这本身不是投毒行为，但如果构建环境或后续使用中存在其他漏洞，攻击者可能利用这些宽松的权限进行投毒，例如通过npm安装恶意依赖。因此，存在一定的投毒风险，但是从提供的代码片段来看，直接投毒的可能性较低，估计为10%。

**利用方式：**
1.  **条件：** 需要应用程序使用`tough-cookie`库的受影响版本（小于4.1.3），并且在创建`CookieJar`实例时，设置`rejectPublicSuffixes`为`false`。
2.  **攻击步骤：** 攻击者构造一个包含恶意属性的Cookie，例如`__proto__.polluted = true`。将此Cookie发送到服务器或客户端。
3.  **结果：** `Object.prototype`会被污染，所有JavaScript对象都会继承`polluted`属性，这可能会导致意外的行为或安全问题。
4. **修复方式：** 更新`tough-cookie`到4.1.3或更高版本。避免设置`rejectPublicSuffixes`为`false`。


**项目地址:** [guy2610/tough-cookie-patch-cve-2023-26136](https://github.com/guy2610/tough-cookie-patch-cve-2023-26136)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #4

**来源**: [CVE-2023-26136-m-lito13_SealSecurity_Exam.md](../2023/CVE-2023-26136-m-lito13_SealSecurity_Exam.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或权限提升

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar且rejectPublicSuffixes=false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包在4.1.3版本之前的原型污染漏洞。当使用CookieJar且`rejectPublicSuffixes=false`时，由于对Cookie处理不当，攻击者可以通过构造恶意的Cookie，例如将Cookie的Domain设置为`__proto__`，从而污染JavaScript对象的原型，影响所有继承该原型的对象。

**有效性：**
提供的POC代码展示了如何利用URL查询参数或者直接设置Cookie的Domain为`__proto__`来污染原型。代码中还提供了修复方案，即在初始化对象时使用`Object.create(null)`，创建一个没有原型的空对象，以防止原型污染。

**投毒风险：**
该仓库中可能存在投毒代码。`changes.diff` 文件中虽然包含了修复漏洞的补丁，但是攻击者可能在提交修复补丁的同时，添加一些不易察觉的恶意代码，例如在其他文件中添加后门，或者修改构建脚本引入恶意依赖。评估投毒风险为10%，主要是因为该仓库看起来是一个学习/演示项目，而非实际的发布包，投毒的动机相对较低。需要仔细审查代码变更，特别是构建和依赖管理部分，才能确定是否存在恶意代码。

**利用方式：**
1.  **构造恶意URL：** 攻击者可以构造包含`__proto__`属性的URL，例如`https://vulnerable-website.com/?__proto__[badProperty]=payload`，当URL解析器处理该URL时，会将`badProperty`添加到所有对象的原型链上。
2.  **设置恶意Cookie：**  攻击者可以设置Cookie的Domain为`__proto__`，并设置相应的属性值。当`tough-cookie`处理该Cookie时，会将属性添加到所有对象的原型链上。示例代码如下：

```javascript
cookiejar.setCookie("Slonser=polluted; Domain=__proto__; Path=/notauth", "https://__proto__/admin", { loose: true }, (err, cookie) => {})
```

**影响：**
成功利用此漏洞后，攻击者可以修改全局对象的属性，从而影响整个应用程序的行为。例如，可以修改内置对象的属性，导致程序崩溃或执行恶意代码。在某些情况下，攻击者还可以利用原型污染漏洞实现权限提升。

**项目地址:** [m-lito13/SealSecurity_Exam](https://github.com/m-lito13/SealSecurity_Exam)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #5

**来源**: [CVE-2023-26136-morrisel_CVE-2023-26136.md](../2023/CVE-2023-26136-morrisel_CVE-2023-26136.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致应用配置被篡改，甚至远程代码执行，取决于应用如何使用受污染的原型

**影响版本:** < 4.1.3

**利用条件:** 需要在使用 tough-cookie 的应用中，CookieJar 的 rejectPublicSuffixes 设置为 false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136 是 tough-cookie 包版本低于 4.1.3 的原型污染漏洞。当 CookieJar 的 rejectPublicSuffixes 设置为 false 时，由于不正确地处理 Cookie，导致原型污染。漏洞出现在对象的初始化方式上。

**有效性：**
提供的 POC 代码通过修改 `memstore.js` 文件，将 `this.idx = {};` 替换为 `this.idx = Object.create(null);` 来修复该漏洞。原始版本在特定配置下确实存在原型污染的风险，而修改后的版本避免了从 `Object.prototype` 继承属性，从而阻止了原型污染。根据提供的 `index.js` 中的测试脚本显示，原始版本会被成功利用（`EXPLOITED SUCCESSFULLY`），而修复后的版本利用会失败（`EXPLOIT FAILED`），验证了 POC 的有效性。

**投毒风险：**
代码库中可能存在投毒风险。虽然主要的修改是为了修复原型污染漏洞，但是仍然存在一些小的风险。

*   **非必要文件：**`README.md`中存在作者信息,增加了溯源的可能性,降低了攻击者匿名性,正常漏洞仓库中不应存在作者信息.
*   **测试代码：** 测试代码中可能存在后门，或者可能被修改为包含恶意行为。

综合考虑，代码库中存在潜在投毒代码的风险较低，约为10%。

**利用方式：**
1.  **漏洞前提：** 应用使用了受影响版本的 `tough-cookie`，并且 `CookieJar` 的 `rejectPublicSuffixes` 设置为 `false`。
2.  **攻击方式：** 攻击者通过构造包含恶意属性的 Cookie，例如 `__proto__.polluted = 'evil'`，并将其注入到 CookieJar 中。
3.  **漏洞结果：** 由于 `tough-cookie` 在初始化对象时存在缺陷，恶意属性会被添加到 `Object.prototype` 上，从而污染了整个 JavaScript 应用的原型链。攻击者可以通过污染原型链来修改应用的行为，例如修改全局配置、注入恶意代码等。具体危害取决于应用如何使用受污染的原型，严重情况下可能导致远程代码执行。
4.  **修复方式：** 使用 `Object.create(null)` 创建对象，避免从 `Object.prototype` 继承属性。

**项目地址:** [morrisel/CVE-2023-26136](https://github.com/morrisel/CVE-2023-26136)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #6

**来源**: [CVE-2023-26136-ronmadar_Open-Source-Seal-Security.md](../2023/CVE-2023-26136-ronmadar_Open-Source-Seal-Security.md)

## CVE-2023-26136-tough-cookie-Prototype污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** Prototype Pollution

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或篡改应用行为

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar，并且rejectPublicSuffixes设置为false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包在4.1.3版本之前存在的一个原型污染漏洞。当使用CookieJar且rejectPublicSuffixes=false时，由于对Cookie处理不当，可能导致原型污染。

**有效性评估：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的。多个来源确认了此漏洞的存在，并提供了修复方案。

**利用方式：**
攻击者可以通过构造恶意的cookie，特别是当cookie的domain设置为`__proto__`时，利用`tough-cookie`库在处理cookie时，向Object.prototype注入恶意属性。由于JavaScript中所有对象都继承自Object.prototype，这会影响应用程序的全局状态，可能导致：

*   **拒绝服务 (DoS):** 通过注入导致异常或无限循环的属性。
*   **篡改应用行为:** 通过注入改变应用程序逻辑的关键属性，影响其行为。

提供的代码尝试通过设置特定的cookie来触发原型污染。`index.js` 脚本的逻辑是创建一个cookie jar，然后尝试设置一个具有特定属性的cookie。`vulnerable`变量控制是否禁用`rejectPublicSuffixes`。如果设置为true，则模拟易受攻击的情况。

**投毒风险评估：**
提供的代码主要包含以下文件：
*   `README.md`: 漏洞描述、修复方案和项目说明。
*   `index.js`: 包含原型污染漏洞的验证代码
    * `test-unit.js`: 测试用例，用于验证修复方案。
    * `testVerifyVulnerable.js`: 测试脚本，用于验证漏洞修复后的行为。

综合评估来看，投毒风险较低。风险点在于 `index.js` 是否存在后门代码，但分析内容可知，该文件主要是漏洞验证代码，不存在恶意行为。

**分析：** 该漏洞利用了JavaScript原型链的特性。通过原型污染，攻击者可以影响所有JavaScript对象的行为。修复此漏洞的关键在于防止在处理cookie时直接操作`Object.prototype`。snyk提供的链接指向的修复方案表明，该漏洞是通过不安全的对象递归合并以及通过路径定义属性造成的。该代码提供了一个简单的原型污染验证，在实际利用中，攻击者可能需要更精细地构造cookie，以便产生更大的影响。

**项目地址:** [ronmadar/Open-Source-Seal-Security](https://github.com/ronmadar/Open-Source-Seal-Security)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #7

**来源**: [CVE-2023-26136-uriyahav_tough-cookie-2.5.0-cve-2023-26136-fix.md](../2023/CVE-2023-26136-uriyahav_tough-cookie-2.5.0-cve-2023-26136-fix.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致应用程序行为被篡改，甚至造成拒绝服务

**影响版本:** < 4.1.3

**利用条件:** 需要应用程序使用受影响版本的tough-cookie，并且在rejectPublicSuffixes=false的模式下使用CookieJar。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-26136是tough-cookie库中一个原型污染漏洞。当CookieJar在rejectPublicSuffixes=false模式下处理Cookie时，由于对象初始化不当导致。攻击者可以通过设置具有恶意域（例如`__proto__`）的cookie来污染`Object.prototype`，从而影响所有继承自该原型的对象。

**有效性分析：**

提供的POC代码（`tough-cookie/index.js`）旨在演示此漏洞，并且`test-cve-2023-26136.js`单元测试验证了修复程序。利用代码的描述表明，它能够成功利用易受攻击的版本，并且针对修补版本会失败，这表明POC是有效的。

**投毒风险分析：**

该仓库包含修复漏洞的代码和测试，以及利用漏洞的演示代码。虽然存在利用代码，但主要目的是验证修复程序。考虑到作者提供了修复方案、测试用例以及详细的漏洞描述，投毒的可能性较低。但仍然存在一定的风险，例如，`tough-cookie/index.js`如果被恶意修改，可能会在不知情的情况下引入后门。总体评估投毒风险为5%，主要是基于对代码质量和作者意图的信任，但不能完全排除。

**利用方式：**

1.  创建一个`CookieJar`实例，并将`rejectPublicSuffixes`设置为`false`。
2.  构造一个包含恶意域名（例如`__proto__`）的Cookie，将其设置为`CookieJar`。
3.  由于`rejectPublicSuffixes`为`false`，`tough-cookie`将尝试设置此cookie，从而污染`Object.prototype`。
4.  一旦`Object.prototype`被污染，所有基于此原型的对象都会受到影响，可能导致应用程序行为异常或安全漏洞。

**项目地址:** [uriyahav/tough-cookie-2.5.0-cve-2023-26136-fix](https://github.com/uriyahav/tough-cookie-2.5.0-cve-2023-26136-fix)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---



---

## POC #2

**来源**: [CVE-2023-26136-dani33339_Tough-Cookie-v2.5.0-Patched.md](../2023/CVE-2023-26136-dani33339_Tough-Cookie-v2.5.0-Patched.md)

## CVE-2023-26136-tough-cookie-Prototype Pollution

**漏洞编号:** CVE-2023-26136

**漏洞类型:** Prototype Pollution

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致权限提升和拒绝服务

**影响版本:** < 4.1.3

**利用条件:** 需要CookieJar使用rejectPublicSuffixes=false模式

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包中的一个原型污染漏洞，影响版本低于4.1.3。当CookieJar以`rejectPublicSuffixes=false`模式使用时，由于对Cookie处理不当，可能导致原型污染。具体来说，如果`cookie.domain`被设置为`__proto__`，攻击者可以修改`Object.prototype`，从而影响整个应用程序的行为。根据漏洞信息，该漏洞的CVSS评分为6.5，属于中危漏洞。搜索结果确认了漏洞的存在以及受影响的版本。提供的漏洞利用代码包括Dockerfile、LICENSE和README.md。README.md描述了漏洞和修复方案，以及安装patched版本的说明。Dockerfile用于构建包含易受攻击或修复后的tough-cookie版本的环境。LICENSE是MIT许可证。 

**有效性：**
根据README.md的描述，以及漏洞库信息和搜索结果，该漏洞确实存在并且可以被利用。

**投毒风险：**
检查提供的文件，主要风险点在于Dockerfile。虽然Dockerfile包含了一些常见的操作，例如安装vim和创建用户，但没有发现明显的恶意代码或后门。然而，`chmod -R a+w /usr/local/lib/node_modules`和`chmod -R a+w /usr/local/bin`这两条命令将给予所有用户对node_modules和/usr/local/bin的写权限，这可能被利用来安装恶意模块或者替换系统命令，从而实现投毒。LICENSE文件和README文件本身没有明显的投毒风险。因此，存在一定的投毒风险，但不是非常高，大概10%的风险。

**利用方式：**
利用方式是通过设置`cookie.domain`为`__proto__`来修改`Object.prototype`，进而影响使用tough-cookie的应用程序的行为。需要注意的是，利用需要应用程序配置`rejectPublicSuffixes=false`。攻击者可以通过发送包含特制Cookie的HTTP请求来触发该漏洞。攻击成功后，攻击者可以修改JavaScript对象的默认属性，从而导致权限提升、信息泄露或拒绝服务。

**项目地址:** [dani33339/Tough-Cookie-v2.5.0-Patched](https://github.com/dani33339/Tough-Cookie-v2.5.0-Patched)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #3

**来源**: [CVE-2023-26136-guy2610_tough-cookie-patch-cve-2023-26136.md](../2023/CVE-2023-26136-guy2610_tough-cookie-patch-cve-2023-26136.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或客户端代码执行

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar，并且rejectPublicSuffixes=false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包中的一个原型污染漏洞，影响4.1.3之前的版本。该漏洞是由于在使用CookieJar时，对Cookie的处理不当造成的，特别是当`rejectPublicSuffixes`设置为`false`时。攻击者可以通过构造恶意的Cookie，污染JavaScript对象的原型，从而影响应用程序的行为。虽然漏洞描述中提到影响的是客户端，但是如果服务器端也使用了存在漏洞的tough-cookie版本，并且依赖于受污染的原型属性，那么也可能受到影响。

**有效性：**
漏洞库信息和搜索引擎结果都确认了漏洞的存在，并且提供了commit信息，说明该漏洞已被修复。给出的Dockerfile和代码片段是tough-cookie仓库的代码，包括Dockerfile、LICENSE和README.md。这些文件本身不是漏洞利用代码，而是构建和描述该库的文件。

**投毒风险：**
提供的Dockerfile在构建过程中，修改了`/usr/local/lib/node_modules`和`/usr/local/bin`的权限，允许`cookie`用户写入。虽然这本身不是投毒行为，但如果构建环境或后续使用中存在其他漏洞，攻击者可能利用这些宽松的权限进行投毒，例如通过npm安装恶意依赖。因此，存在一定的投毒风险，但是从提供的代码片段来看，直接投毒的可能性较低，估计为10%。

**利用方式：**
1.  **条件：** 需要应用程序使用`tough-cookie`库的受影响版本（小于4.1.3），并且在创建`CookieJar`实例时，设置`rejectPublicSuffixes`为`false`。
2.  **攻击步骤：** 攻击者构造一个包含恶意属性的Cookie，例如`__proto__.polluted = true`。将此Cookie发送到服务器或客户端。
3.  **结果：** `Object.prototype`会被污染，所有JavaScript对象都会继承`polluted`属性，这可能会导致意外的行为或安全问题。
4. **修复方式：** 更新`tough-cookie`到4.1.3或更高版本。避免设置`rejectPublicSuffixes`为`false`。


**项目地址:** [guy2610/tough-cookie-patch-cve-2023-26136](https://github.com/guy2610/tough-cookie-patch-cve-2023-26136)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #4

**来源**: [CVE-2023-26136-m-lito13_SealSecurity_Exam.md](../2023/CVE-2023-26136-m-lito13_SealSecurity_Exam.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或权限提升

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar且rejectPublicSuffixes=false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包在4.1.3版本之前的原型污染漏洞。当使用CookieJar且`rejectPublicSuffixes=false`时，由于对Cookie处理不当，攻击者可以通过构造恶意的Cookie，例如将Cookie的Domain设置为`__proto__`，从而污染JavaScript对象的原型，影响所有继承该原型的对象。

**有效性：**
提供的POC代码展示了如何利用URL查询参数或者直接设置Cookie的Domain为`__proto__`来污染原型。代码中还提供了修复方案，即在初始化对象时使用`Object.create(null)`，创建一个没有原型的空对象，以防止原型污染。

**投毒风险：**
该仓库中可能存在投毒代码。`changes.diff` 文件中虽然包含了修复漏洞的补丁，但是攻击者可能在提交修复补丁的同时，添加一些不易察觉的恶意代码，例如在其他文件中添加后门，或者修改构建脚本引入恶意依赖。评估投毒风险为10%，主要是因为该仓库看起来是一个学习/演示项目，而非实际的发布包，投毒的动机相对较低。需要仔细审查代码变更，特别是构建和依赖管理部分，才能确定是否存在恶意代码。

**利用方式：**
1.  **构造恶意URL：** 攻击者可以构造包含`__proto__`属性的URL，例如`https://vulnerable-website.com/?__proto__[badProperty]=payload`，当URL解析器处理该URL时，会将`badProperty`添加到所有对象的原型链上。
2.  **设置恶意Cookie：**  攻击者可以设置Cookie的Domain为`__proto__`，并设置相应的属性值。当`tough-cookie`处理该Cookie时，会将属性添加到所有对象的原型链上。示例代码如下：

```javascript
cookiejar.setCookie("Slonser=polluted; Domain=__proto__; Path=/notauth", "https://__proto__/admin", { loose: true }, (err, cookie) => {})
```

**影响：**
成功利用此漏洞后，攻击者可以修改全局对象的属性，从而影响整个应用程序的行为。例如，可以修改内置对象的属性，导致程序崩溃或执行恶意代码。在某些情况下，攻击者还可以利用原型污染漏洞实现权限提升。

**项目地址:** [m-lito13/SealSecurity_Exam](https://github.com/m-lito13/SealSecurity_Exam)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #5

**来源**: [CVE-2023-26136-morrisel_CVE-2023-26136.md](../2023/CVE-2023-26136-morrisel_CVE-2023-26136.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致应用配置被篡改，甚至远程代码执行，取决于应用如何使用受污染的原型

**影响版本:** < 4.1.3

**利用条件:** 需要在使用 tough-cookie 的应用中，CookieJar 的 rejectPublicSuffixes 设置为 false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136 是 tough-cookie 包版本低于 4.1.3 的原型污染漏洞。当 CookieJar 的 rejectPublicSuffixes 设置为 false 时，由于不正确地处理 Cookie，导致原型污染。漏洞出现在对象的初始化方式上。

**有效性：**
提供的 POC 代码通过修改 `memstore.js` 文件，将 `this.idx = {};` 替换为 `this.idx = Object.create(null);` 来修复该漏洞。原始版本在特定配置下确实存在原型污染的风险，而修改后的版本避免了从 `Object.prototype` 继承属性，从而阻止了原型污染。根据提供的 `index.js` 中的测试脚本显示，原始版本会被成功利用（`EXPLOITED SUCCESSFULLY`），而修复后的版本利用会失败（`EXPLOIT FAILED`），验证了 POC 的有效性。

**投毒风险：**
代码库中可能存在投毒风险。虽然主要的修改是为了修复原型污染漏洞，但是仍然存在一些小的风险。

*   **非必要文件：**`README.md`中存在作者信息,增加了溯源的可能性,降低了攻击者匿名性,正常漏洞仓库中不应存在作者信息.
*   **测试代码：** 测试代码中可能存在后门，或者可能被修改为包含恶意行为。

综合考虑，代码库中存在潜在投毒代码的风险较低，约为10%。

**利用方式：**
1.  **漏洞前提：** 应用使用了受影响版本的 `tough-cookie`，并且 `CookieJar` 的 `rejectPublicSuffixes` 设置为 `false`。
2.  **攻击方式：** 攻击者通过构造包含恶意属性的 Cookie，例如 `__proto__.polluted = 'evil'`，并将其注入到 CookieJar 中。
3.  **漏洞结果：** 由于 `tough-cookie` 在初始化对象时存在缺陷，恶意属性会被添加到 `Object.prototype` 上，从而污染了整个 JavaScript 应用的原型链。攻击者可以通过污染原型链来修改应用的行为，例如修改全局配置、注入恶意代码等。具体危害取决于应用如何使用受污染的原型，严重情况下可能导致远程代码执行。
4.  **修复方式：** 使用 `Object.create(null)` 创建对象，避免从 `Object.prototype` 继承属性。

**项目地址:** [morrisel/CVE-2023-26136](https://github.com/morrisel/CVE-2023-26136)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #6

**来源**: [CVE-2023-26136-ronmadar_Open-Source-Seal-Security.md](../2023/CVE-2023-26136-ronmadar_Open-Source-Seal-Security.md)

## CVE-2023-26136-tough-cookie-Prototype污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** Prototype Pollution

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或篡改应用行为

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar，并且rejectPublicSuffixes设置为false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包在4.1.3版本之前存在的一个原型污染漏洞。当使用CookieJar且rejectPublicSuffixes=false时，由于对Cookie处理不当，可能导致原型污染。

**有效性评估：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的。多个来源确认了此漏洞的存在，并提供了修复方案。

**利用方式：**
攻击者可以通过构造恶意的cookie，特别是当cookie的domain设置为`__proto__`时，利用`tough-cookie`库在处理cookie时，向Object.prototype注入恶意属性。由于JavaScript中所有对象都继承自Object.prototype，这会影响应用程序的全局状态，可能导致：

*   **拒绝服务 (DoS):** 通过注入导致异常或无限循环的属性。
*   **篡改应用行为:** 通过注入改变应用程序逻辑的关键属性，影响其行为。

提供的代码尝试通过设置特定的cookie来触发原型污染。`index.js` 脚本的逻辑是创建一个cookie jar，然后尝试设置一个具有特定属性的cookie。`vulnerable`变量控制是否禁用`rejectPublicSuffixes`。如果设置为true，则模拟易受攻击的情况。

**投毒风险评估：**
提供的代码主要包含以下文件：
*   `README.md`: 漏洞描述、修复方案和项目说明。
*   `index.js`: 包含原型污染漏洞的验证代码
    * `test-unit.js`: 测试用例，用于验证修复方案。
    * `testVerifyVulnerable.js`: 测试脚本，用于验证漏洞修复后的行为。

综合评估来看，投毒风险较低。风险点在于 `index.js` 是否存在后门代码，但分析内容可知，该文件主要是漏洞验证代码，不存在恶意行为。

**分析：** 该漏洞利用了JavaScript原型链的特性。通过原型污染，攻击者可以影响所有JavaScript对象的行为。修复此漏洞的关键在于防止在处理cookie时直接操作`Object.prototype`。snyk提供的链接指向的修复方案表明，该漏洞是通过不安全的对象递归合并以及通过路径定义属性造成的。该代码提供了一个简单的原型污染验证，在实际利用中，攻击者可能需要更精细地构造cookie，以便产生更大的影响。

**项目地址:** [ronmadar/Open-Source-Seal-Security](https://github.com/ronmadar/Open-Source-Seal-Security)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #7

**来源**: [CVE-2023-26136-uriyahav_tough-cookie-2.5.0-cve-2023-26136-fix.md](../2023/CVE-2023-26136-uriyahav_tough-cookie-2.5.0-cve-2023-26136-fix.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致应用程序行为被篡改，甚至造成拒绝服务

**影响版本:** < 4.1.3

**利用条件:** 需要应用程序使用受影响版本的tough-cookie，并且在rejectPublicSuffixes=false的模式下使用CookieJar。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-26136是tough-cookie库中一个原型污染漏洞。当CookieJar在rejectPublicSuffixes=false模式下处理Cookie时，由于对象初始化不当导致。攻击者可以通过设置具有恶意域（例如`__proto__`）的cookie来污染`Object.prototype`，从而影响所有继承自该原型的对象。

**有效性分析：**

提供的POC代码（`tough-cookie/index.js`）旨在演示此漏洞，并且`test-cve-2023-26136.js`单元测试验证了修复程序。利用代码的描述表明，它能够成功利用易受攻击的版本，并且针对修补版本会失败，这表明POC是有效的。

**投毒风险分析：**

该仓库包含修复漏洞的代码和测试，以及利用漏洞的演示代码。虽然存在利用代码，但主要目的是验证修复程序。考虑到作者提供了修复方案、测试用例以及详细的漏洞描述，投毒的可能性较低。但仍然存在一定的风险，例如，`tough-cookie/index.js`如果被恶意修改，可能会在不知情的情况下引入后门。总体评估投毒风险为5%，主要是基于对代码质量和作者意图的信任，但不能完全排除。

**利用方式：**

1.  创建一个`CookieJar`实例，并将`rejectPublicSuffixes`设置为`false`。
2.  构造一个包含恶意域名（例如`__proto__`）的Cookie，将其设置为`CookieJar`。
3.  由于`rejectPublicSuffixes`为`false`，`tough-cookie`将尝试设置此cookie，从而污染`Object.prototype`。
4.  一旦`Object.prototype`被污染，所有基于此原型的对象都会受到影响，可能导致应用程序行为异常或安全漏洞。

**项目地址:** [uriyahav/tough-cookie-2.5.0-cve-2023-26136-fix](https://github.com/uriyahav/tough-cookie-2.5.0-cve-2023-26136-fix)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---



---

## POC #2

**来源**: [CVE-2023-26136-dani33339_Tough-Cookie-v2.5.0-Patched.md](../2023/CVE-2023-26136-dani33339_Tough-Cookie-v2.5.0-Patched.md)

## CVE-2023-26136-tough-cookie-Prototype Pollution

**漏洞编号:** CVE-2023-26136

**漏洞类型:** Prototype Pollution

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致权限提升和拒绝服务

**影响版本:** < 4.1.3

**利用条件:** 需要CookieJar使用rejectPublicSuffixes=false模式

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包中的一个原型污染漏洞，影响版本低于4.1.3。当CookieJar以`rejectPublicSuffixes=false`模式使用时，由于对Cookie处理不当，可能导致原型污染。具体来说，如果`cookie.domain`被设置为`__proto__`，攻击者可以修改`Object.prototype`，从而影响整个应用程序的行为。根据漏洞信息，该漏洞的CVSS评分为6.5，属于中危漏洞。搜索结果确认了漏洞的存在以及受影响的版本。提供的漏洞利用代码包括Dockerfile、LICENSE和README.md。README.md描述了漏洞和修复方案，以及安装patched版本的说明。Dockerfile用于构建包含易受攻击或修复后的tough-cookie版本的环境。LICENSE是MIT许可证。 

**有效性：**
根据README.md的描述，以及漏洞库信息和搜索结果，该漏洞确实存在并且可以被利用。

**投毒风险：**
检查提供的文件，主要风险点在于Dockerfile。虽然Dockerfile包含了一些常见的操作，例如安装vim和创建用户，但没有发现明显的恶意代码或后门。然而，`chmod -R a+w /usr/local/lib/node_modules`和`chmod -R a+w /usr/local/bin`这两条命令将给予所有用户对node_modules和/usr/local/bin的写权限，这可能被利用来安装恶意模块或者替换系统命令，从而实现投毒。LICENSE文件和README文件本身没有明显的投毒风险。因此，存在一定的投毒风险，但不是非常高，大概10%的风险。

**利用方式：**
利用方式是通过设置`cookie.domain`为`__proto__`来修改`Object.prototype`，进而影响使用tough-cookie的应用程序的行为。需要注意的是，利用需要应用程序配置`rejectPublicSuffixes=false`。攻击者可以通过发送包含特制Cookie的HTTP请求来触发该漏洞。攻击成功后，攻击者可以修改JavaScript对象的默认属性，从而导致权限提升、信息泄露或拒绝服务。

**项目地址:** [dani33339/Tough-Cookie-v2.5.0-Patched](https://github.com/dani33339/Tough-Cookie-v2.5.0-Patched)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #3

**来源**: [CVE-2023-26136-guy2610_tough-cookie-patch-cve-2023-26136.md](../2023/CVE-2023-26136-guy2610_tough-cookie-patch-cve-2023-26136.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或客户端代码执行

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar，并且rejectPublicSuffixes=false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包中的一个原型污染漏洞，影响4.1.3之前的版本。该漏洞是由于在使用CookieJar时，对Cookie的处理不当造成的，特别是当`rejectPublicSuffixes`设置为`false`时。攻击者可以通过构造恶意的Cookie，污染JavaScript对象的原型，从而影响应用程序的行为。虽然漏洞描述中提到影响的是客户端，但是如果服务器端也使用了存在漏洞的tough-cookie版本，并且依赖于受污染的原型属性，那么也可能受到影响。

**有效性：**
漏洞库信息和搜索引擎结果都确认了漏洞的存在，并且提供了commit信息，说明该漏洞已被修复。给出的Dockerfile和代码片段是tough-cookie仓库的代码，包括Dockerfile、LICENSE和README.md。这些文件本身不是漏洞利用代码，而是构建和描述该库的文件。

**投毒风险：**
提供的Dockerfile在构建过程中，修改了`/usr/local/lib/node_modules`和`/usr/local/bin`的权限，允许`cookie`用户写入。虽然这本身不是投毒行为，但如果构建环境或后续使用中存在其他漏洞，攻击者可能利用这些宽松的权限进行投毒，例如通过npm安装恶意依赖。因此，存在一定的投毒风险，但是从提供的代码片段来看，直接投毒的可能性较低，估计为10%。

**利用方式：**
1.  **条件：** 需要应用程序使用`tough-cookie`库的受影响版本（小于4.1.3），并且在创建`CookieJar`实例时，设置`rejectPublicSuffixes`为`false`。
2.  **攻击步骤：** 攻击者构造一个包含恶意属性的Cookie，例如`__proto__.polluted = true`。将此Cookie发送到服务器或客户端。
3.  **结果：** `Object.prototype`会被污染，所有JavaScript对象都会继承`polluted`属性，这可能会导致意外的行为或安全问题。
4. **修复方式：** 更新`tough-cookie`到4.1.3或更高版本。避免设置`rejectPublicSuffixes`为`false`。


**项目地址:** [guy2610/tough-cookie-patch-cve-2023-26136](https://github.com/guy2610/tough-cookie-patch-cve-2023-26136)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #4

**来源**: [CVE-2023-26136-m-lito13_SealSecurity_Exam.md](../2023/CVE-2023-26136-m-lito13_SealSecurity_Exam.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或权限提升

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar且rejectPublicSuffixes=false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包在4.1.3版本之前的原型污染漏洞。当使用CookieJar且`rejectPublicSuffixes=false`时，由于对Cookie处理不当，攻击者可以通过构造恶意的Cookie，例如将Cookie的Domain设置为`__proto__`，从而污染JavaScript对象的原型，影响所有继承该原型的对象。

**有效性：**
提供的POC代码展示了如何利用URL查询参数或者直接设置Cookie的Domain为`__proto__`来污染原型。代码中还提供了修复方案，即在初始化对象时使用`Object.create(null)`，创建一个没有原型的空对象，以防止原型污染。

**投毒风险：**
该仓库中可能存在投毒代码。`changes.diff` 文件中虽然包含了修复漏洞的补丁，但是攻击者可能在提交修复补丁的同时，添加一些不易察觉的恶意代码，例如在其他文件中添加后门，或者修改构建脚本引入恶意依赖。评估投毒风险为10%，主要是因为该仓库看起来是一个学习/演示项目，而非实际的发布包，投毒的动机相对较低。需要仔细审查代码变更，特别是构建和依赖管理部分，才能确定是否存在恶意代码。

**利用方式：**
1.  **构造恶意URL：** 攻击者可以构造包含`__proto__`属性的URL，例如`https://vulnerable-website.com/?__proto__[badProperty]=payload`，当URL解析器处理该URL时，会将`badProperty`添加到所有对象的原型链上。
2.  **设置恶意Cookie：**  攻击者可以设置Cookie的Domain为`__proto__`，并设置相应的属性值。当`tough-cookie`处理该Cookie时，会将属性添加到所有对象的原型链上。示例代码如下：

```javascript
cookiejar.setCookie("Slonser=polluted; Domain=__proto__; Path=/notauth", "https://__proto__/admin", { loose: true }, (err, cookie) => {})
```

**影响：**
成功利用此漏洞后，攻击者可以修改全局对象的属性，从而影响整个应用程序的行为。例如，可以修改内置对象的属性，导致程序崩溃或执行恶意代码。在某些情况下，攻击者还可以利用原型污染漏洞实现权限提升。

**项目地址:** [m-lito13/SealSecurity_Exam](https://github.com/m-lito13/SealSecurity_Exam)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #5

**来源**: [CVE-2023-26136-morrisel_CVE-2023-26136.md](../2023/CVE-2023-26136-morrisel_CVE-2023-26136.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致应用配置被篡改，甚至远程代码执行，取决于应用如何使用受污染的原型

**影响版本:** < 4.1.3

**利用条件:** 需要在使用 tough-cookie 的应用中，CookieJar 的 rejectPublicSuffixes 设置为 false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136 是 tough-cookie 包版本低于 4.1.3 的原型污染漏洞。当 CookieJar 的 rejectPublicSuffixes 设置为 false 时，由于不正确地处理 Cookie，导致原型污染。漏洞出现在对象的初始化方式上。

**有效性：**
提供的 POC 代码通过修改 `memstore.js` 文件，将 `this.idx = {};` 替换为 `this.idx = Object.create(null);` 来修复该漏洞。原始版本在特定配置下确实存在原型污染的风险，而修改后的版本避免了从 `Object.prototype` 继承属性，从而阻止了原型污染。根据提供的 `index.js` 中的测试脚本显示，原始版本会被成功利用（`EXPLOITED SUCCESSFULLY`），而修复后的版本利用会失败（`EXPLOIT FAILED`），验证了 POC 的有效性。

**投毒风险：**
代码库中可能存在投毒风险。虽然主要的修改是为了修复原型污染漏洞，但是仍然存在一些小的风险。

*   **非必要文件：**`README.md`中存在作者信息,增加了溯源的可能性,降低了攻击者匿名性,正常漏洞仓库中不应存在作者信息.
*   **测试代码：** 测试代码中可能存在后门，或者可能被修改为包含恶意行为。

综合考虑，代码库中存在潜在投毒代码的风险较低，约为10%。

**利用方式：**
1.  **漏洞前提：** 应用使用了受影响版本的 `tough-cookie`，并且 `CookieJar` 的 `rejectPublicSuffixes` 设置为 `false`。
2.  **攻击方式：** 攻击者通过构造包含恶意属性的 Cookie，例如 `__proto__.polluted = 'evil'`，并将其注入到 CookieJar 中。
3.  **漏洞结果：** 由于 `tough-cookie` 在初始化对象时存在缺陷，恶意属性会被添加到 `Object.prototype` 上，从而污染了整个 JavaScript 应用的原型链。攻击者可以通过污染原型链来修改应用的行为，例如修改全局配置、注入恶意代码等。具体危害取决于应用如何使用受污染的原型，严重情况下可能导致远程代码执行。
4.  **修复方式：** 使用 `Object.create(null)` 创建对象，避免从 `Object.prototype` 继承属性。

**项目地址:** [morrisel/CVE-2023-26136](https://github.com/morrisel/CVE-2023-26136)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #6

**来源**: [CVE-2023-26136-ronmadar_Open-Source-Seal-Security.md](../2023/CVE-2023-26136-ronmadar_Open-Source-Seal-Security.md)

## CVE-2023-26136-tough-cookie-Prototype污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** Prototype Pollution

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或篡改应用行为

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar，并且rejectPublicSuffixes设置为false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包在4.1.3版本之前存在的一个原型污染漏洞。当使用CookieJar且rejectPublicSuffixes=false时，由于对Cookie处理不当，可能导致原型污染。

**有效性评估：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的。多个来源确认了此漏洞的存在，并提供了修复方案。

**利用方式：**
攻击者可以通过构造恶意的cookie，特别是当cookie的domain设置为`__proto__`时，利用`tough-cookie`库在处理cookie时，向Object.prototype注入恶意属性。由于JavaScript中所有对象都继承自Object.prototype，这会影响应用程序的全局状态，可能导致：

*   **拒绝服务 (DoS):** 通过注入导致异常或无限循环的属性。
*   **篡改应用行为:** 通过注入改变应用程序逻辑的关键属性，影响其行为。

提供的代码尝试通过设置特定的cookie来触发原型污染。`index.js` 脚本的逻辑是创建一个cookie jar，然后尝试设置一个具有特定属性的cookie。`vulnerable`变量控制是否禁用`rejectPublicSuffixes`。如果设置为true，则模拟易受攻击的情况。

**投毒风险评估：**
提供的代码主要包含以下文件：
*   `README.md`: 漏洞描述、修复方案和项目说明。
*   `index.js`: 包含原型污染漏洞的验证代码
    * `test-unit.js`: 测试用例，用于验证修复方案。
    * `testVerifyVulnerable.js`: 测试脚本，用于验证漏洞修复后的行为。

综合评估来看，投毒风险较低。风险点在于 `index.js` 是否存在后门代码，但分析内容可知，该文件主要是漏洞验证代码，不存在恶意行为。

**分析：** 该漏洞利用了JavaScript原型链的特性。通过原型污染，攻击者可以影响所有JavaScript对象的行为。修复此漏洞的关键在于防止在处理cookie时直接操作`Object.prototype`。snyk提供的链接指向的修复方案表明，该漏洞是通过不安全的对象递归合并以及通过路径定义属性造成的。该代码提供了一个简单的原型污染验证，在实际利用中，攻击者可能需要更精细地构造cookie，以便产生更大的影响。

**项目地址:** [ronmadar/Open-Source-Seal-Security](https://github.com/ronmadar/Open-Source-Seal-Security)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

## POC #7

**来源**: [CVE-2023-26136-uriyahav_tough-cookie-2.5.0-cve-2023-26136-fix.md](../2023/CVE-2023-26136-uriyahav_tough-cookie-2.5.0-cve-2023-26136-fix.md)

## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致应用程序行为被篡改，甚至造成拒绝服务

**影响版本:** < 4.1.3

**利用条件:** 需要应用程序使用受影响版本的tough-cookie，并且在rejectPublicSuffixes=false的模式下使用CookieJar。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-26136是tough-cookie库中一个原型污染漏洞。当CookieJar在rejectPublicSuffixes=false模式下处理Cookie时，由于对象初始化不当导致。攻击者可以通过设置具有恶意域（例如`__proto__`）的cookie来污染`Object.prototype`，从而影响所有继承自该原型的对象。

**有效性分析：**

提供的POC代码（`tough-cookie/index.js`）旨在演示此漏洞，并且`test-cve-2023-26136.js`单元测试验证了修复程序。利用代码的描述表明，它能够成功利用易受攻击的版本，并且针对修补版本会失败，这表明POC是有效的。

**投毒风险分析：**

该仓库包含修复漏洞的代码和测试，以及利用漏洞的演示代码。虽然存在利用代码，但主要目的是验证修复程序。考虑到作者提供了修复方案、测试用例以及详细的漏洞描述，投毒的可能性较低。但仍然存在一定的风险，例如，`tough-cookie/index.js`如果被恶意修改，可能会在不知情的情况下引入后门。总体评估投毒风险为5%，主要是基于对代码质量和作者意图的信任，但不能完全排除。

**利用方式：**

1.  创建一个`CookieJar`实例，并将`rejectPublicSuffixes`设置为`false`。
2.  构造一个包含恶意域名（例如`__proto__`）的Cookie，将其设置为`CookieJar`。
3.  由于`rejectPublicSuffixes`为`false`，`tough-cookie`将尝试设置此cookie，从而污染`Object.prototype`。
4.  一旦`Object.prototype`被污染，所有基于此原型的对象都会受到影响，可能导致应用程序行为异常或安全漏洞。

**项目地址:** [uriyahav/tough-cookie-2.5.0-cve-2023-26136-fix](https://github.com/uriyahav/tough-cookie-2.5.0-cve-2023-26136-fix)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)

---

