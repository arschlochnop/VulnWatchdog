# CVE-2023-42793

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md](../2023/CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md)

## CVE-2023-42793 - TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个身份验证绕过漏洞，未经身份验证的攻击者可以通过发送特制的 HTTP 请求绕过身份验证，从而创建管理员账户并最终实现远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果中多个链接都提到了该漏洞被积极利用，包括APT组织。漏洞利用代码提供了创建管理员账户和执行RCE的脚本，并且说明了如何利用该漏洞，包括如何获取反向shell。

**投毒风险：**
分析提供的`exploit.py`和`rce_exploit.py`，主要功能是创建管理员账户和执行任意命令。脚本本身的代码逻辑相对简单，没有明显的恶意代码。其中`exploit.py`会生成随机用户名、密码和邮箱地址，这可能被误认为恶意行为，但这是为了方便利用而设计的，并非投毒。`rce_exploit.py`脚本依赖于第一个脚本创建的token文件。虽然没有发现明显的后门代码，但仍存在极小的风险，例如在生成随机字符串时引入偏差，虽然可能性极小，但理论上存在被利用的可能性，将投毒风险评定为5%。

**利用方式：**
1.  **身份验证绕过：** 攻击者首先利用身份验证绕过漏洞，该漏洞允许未经身份验证的攻击者与TeamCity服务器进行交互，绕过正常的身份验证流程。
2.  **创建管理员账户：** 使用 `exploit.py` 脚本，通过发送特制的 POST 请求，在 TeamCity 服务器上创建一个新的管理员账户。可以指定用户名、密码和邮箱，也可以使用随机生成的凭据。成功创建后，会将凭据保存到token文件中。
3.  **远程代码执行：** 使用 `rce.py` 脚本，该脚本首先启用debug processes，然后利用创建的管理员账户，通过 TeamCity 的 API 接口执行任意命令。可以执行系统命令，例如 `whoami`，也可以获取反向 shell，从而完全控制服务器。
4.  **反向Shell:** 利用rce.py执行命令，通过反弹shell到攻击者机器上，来获取服务器的控制权。


**项目地址:** [B4l3rI0n/CVE-2023-42793](https://github.com/B4l3rI0n/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #2

**来源**: [CVE-2023-42793-FlojBoj_CVE-2023-42793.md](../2023/CVE-2023-42793-FlojBoj_CVE-2023-42793.md)

## CVE-2023-42793-JetBrainsTeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可能导致远程代码执行和完全控制TeamCity服务器

**影响版本:** < 2023.05.4

**利用条件:** 需要能够通过HTTP(S)访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，攻击者无需身份验证即可执行远程代码。漏洞利用方式如下：

1.  **有效性：** 漏洞信息和搜索结果表明该漏洞已在野外被积极利用，包括APT组织（如APT29、CozyBear、北朝鲜黑客组织）和俄罗斯情报部门SVR。提供的代码`exploit.py`旨在利用此漏洞创建管理员账户或获取现有用户的token，从而控制TeamCity服务器。根据README.md的描述，还有一个`rce.py`脚本可以执行远程命令，但主脚本`exploit.py`的功能是创建管理员账户。

2.  **投毒风险：** 代码`exploit.py`本身的功能是利用漏洞创建管理员用户或获取token。投毒风险评估如下：
    *   代码中存在一些硬编码，例如默认密码"Password@123"和默认邮箱域名"@lol.omg"，如果直接使用这些默认值，容易被检测和防御。但这不属于投毒，而是简化使用的示例。
    *   代码尝试首先获取或删除现有的token，这增加了攻击成功的概率，但也可能在目标环境中留下痕迹。
    *   总体来看，`exploit.py`的主要风险在于被滥用以非法控制TeamCity服务器，而非恶意代码本身。因此，投毒风险较低，估计为10%。主要是担心引入了额外的请求或命令，用于收集用户信息或执行其他未经授权的操作。

3.  **利用方式：** 利用方式主要分为以下步骤：
    a.  攻击者发送特制的HTTP请求到TeamCity服务器，绕过身份验证。
    b.  使用`exploit.py`脚本，指定目标TeamCity服务器的URL。
    c.  脚本尝试获取或删除现有的token，然后创建一个新的管理员用户，或者获取指定用户的token。
    d.  如果成功创建管理员用户，攻击者可以使用新创建的管理员账户登录TeamCity服务器，并获得完全控制权限。
    e. 通过获取到的token, 攻击者可以模拟用户身份，从而执行相关操作。

该漏洞的严重性在于未经身份验证即可创建管理员帐户并执行任意代码，从而完全控制受影响的TeamCity服务器。缓解措施包括尽快升级到2023.05.4或更高版本。

**项目地址:** [FlojBoj/CVE-2023-42793](https://github.com/FlojBoj/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #3

**来源**: [CVE-2023-42793-H454NSec_CVE-2023-42793.md](../2023/CVE-2023-42793-H454NSec_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从攻击者控制的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 漏洞存在于JetBrains TeamCity 2023.05.4 之前的版本中，允许未经身份验证的攻击者绕过身份验证，最终实现远程代码执行。根据漏洞库信息，该漏洞的 CVSS 3.1 评分为 9.8，属于严重级别。搜索结果表明，该漏洞已被广泛利用，甚至被 APT 组织用于攻击活动。 

**漏洞利用方式：**

1.  **身份验证绕过：** 漏洞利用代码通过发送特制的 HTTP 请求来绕过 TeamCity 的身份验证机制。具体利用细节需要分析补丁或者参考其他分析报告。
2.  **创建管理员用户：** 漏洞利用代码首先删除 id 为 1 的用户的token，然后创建一个新的用户 token。使用这个 token，攻击者可以创建一个具有管理员权限的新用户。新用户的用户名和密码可以通过命令行参数指定，默认用户名为 `H454NSec[随机数]`，密码为 `@H454NSec`。利用成功后，即可使用创建的管理员用户登录TeamCity控制台。
3.  **远程代码执行：** 通过管理员权限，攻击者可以在 TeamCity 服务器上执行任意代码，实现远程控制。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确定该 POC 代码是有效的。漏洞已被公开披露且有可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。风险分析如下：

*   **代码结构：** 代码结构相对清晰，主要功能是利用漏洞创建管理员用户。
*   **可疑行为：** 代码中存在以下潜在风险：
    *   **默认用户名和密码：** 使用默认的用户名和密码 `@H454NSec` 创建管理员帐户，这可能会让其他攻击者更容易入侵，或者导致安全审计告警。
    *   **硬编码的 User-Agent：**  User-Agent头 `Mozilla/5.0 (https://github.com/H454NSec/CVE-2023-42793) Gecko/20100101 Firefox/113.0`  可能被用于追踪攻击源。但同时也降低了攻击的隐蔽性。
    *   **未处理异常：** 虽然代码有异常处理，但仅仅是简单的`pass`，可能会隐藏一些错误信息，增加调试难度。
*   **高危操作：**  漏洞利用本身就是高危操作，如果攻击者通过修改poc加入恶意命令，将会造成严重危害，例如植入后门。

综合考虑以上因素，该 POC 代码的投毒风险评估为 10%。主要风险在于攻击者可能利用该代码进行二次修改，加入恶意代码或后门，从而扩大攻击范围。

**项目地址:** [H454NSec/CVE-2023-42793](https://github.com/H454NSec/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #4

**来源**: [CVE-2023-42793-HusenjanDev_CVE-2023-42793.md](../2023/CVE-2023-42793-HusenjanDev_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从网络访问，需要通过其他途径获取TeamCity Token。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，允许未经身份验证的攻击者通过HTTP(S)访问TeamCity服务器，并执行远程代码。根据漏洞库信息，CVSS评分为9.8，属于严重级别。搜索引擎结果显示，该漏洞已被多个APT组织利用，包括APT29、北朝鲜的Diamond Sleet和Onyx Sleet以及俄罗斯对外情报局 (SVR)，显示其真实性和危害性。Rapid7的博客文章也详细分析了该漏洞。提供的POC代码的利用方式是：

1.  **获取TeamCity Token:**  `readme.md` 中提到，需要通过其他漏洞或者方式获取TeamCity的Token. 这是利用此POC的前提。
2.  **启用调试模式:** 使用curl命令发送POST请求到`/admin/dataDir.html`，修改`config/internal.properties`文件，启用`rest.debug.processes.enable=true`，从而开启调试模式。这一步通过token进行验证。
3.  **构造反弹shell Payload:**  将反弹shell命令进行URL编码，目标是让受害者主机连接攻击者的Netcat监听器。
4.  **执行远程命令:** 使用curl命令发送POST请求到`/app/rest/debug/processes`，指定`exePath`为`/bin/bash`，`params`为`-c`和URL编码后的反弹shell命令。这个请求同样需要token验证。漏洞利用依赖于已获取的TeamCity token，然后通过启用调试模式执行反弹shell。根据分析，该POC代码没有明显的投毒行为。

**项目地址:** [HusenjanDev/CVE-2023-42793](https://github.com/HusenjanDev/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #5

**来源**: [CVE-2023-42793-LeHeron_TC_test.md](../2023/CVE-2023-42793-LeHeron_TC_test.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个严重的身份验证绕过漏洞，攻击者无需身份验证即可在 TeamCity 服务器上执行远程代码。根据漏洞信息和搜索结果，该漏洞已被积极利用，甚至APT组织，如CozyBear，以及北朝鲜的APT组织都在利用该漏洞。 

**有效性：**
根据搜索结果，此漏洞已经存在公开的利用代码，且已被广泛利用，证明漏洞有效。

**投毒风险：**
提供的漏洞利用代码 `/tmp/da0475f0898b55e5196bf0f36ac9d45e/README`  只是一个简单的README文件，内容为 “Hello World”，不包含任何可执行代码或恶意指令。投毒的可能性极低，可以认为几乎不存在，给到1%的可能也只是对未知风险的保留。

**利用方式：**
根据漏洞描述，攻击者可以通过未授权访问TeamCity服务器，从而执行任意代码。具体的利用方式可能涉及到构造特定的HTTP请求绕过身份验证机制，然后利用TeamCity服务器的功能执行恶意命令。参考Rapid7的博客文章，该漏洞利用可能与特定的端点和参数有关，允许攻击者创建管理员用户或直接执行代码。 从搜索结果来看，该漏洞已经成为恶意行为者的攻击目标，建议尽快升级到安全版本。

**项目地址:** [LeHeron/TC_test](https://github.com/LeHeron/TC_test)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #6

**来源**: [CVE-2023-42793-StanleyJobsonAU_GhostTown.md](../2023/CVE-2023-42793-StanleyJobsonAU_GhostTown.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个身份验证绕过漏洞，允许未经身份验证的攻击者远程执行代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8（严重），并且已被积极利用。搜索结果表明，包括APT29、朝鲜黑客组织以及俄罗斯对外情报局（SVR）等多个威胁组织都在利用此漏洞。提供的POC代码 `GhostTown.py` 旨在利用此漏洞。利用方式如下：

1.  **生成管理员Token：** POC首先尝试通过 `/app/rest/users/id:1/tokens/RPC2` 接口创建一个管理员Token。这将绕过身份验证。
2.  **检索内部配置：** 使用生成的管理员Token，POC尝试从 `/get/file/dataDir/config/internal.properties` 接口检索TeamCity的内部配置。
3.  **更新配置：** POC会检查配置项中是否包含 `rest.debug.processes.enable=true`，如果不存在，则将其添加到配置项中，并通过 `/get/file/dataDir/config/internal.properties` 接口更新配置。`rest.debug.processes.enable=true` 配置的目的是允许执行调试进程，这为远程代码执行铺平了道路。(这部分未在提供的代码片段中。)
4. **远程代码执行：** 启用调试进程允许攻击者通过构造特定的请求来执行任意命令。

**有效性：** 根据漏洞信息和搜索结果，此POC代码有效，能够利用CVE-2023-42793漏洞实现RCE。

**投毒风险：** 检查提供的代码，主要逻辑集中在利用漏洞上，没有发现明显的恶意代码或后门。该代码是为了验证漏洞存在，并帮助安全研究人员和管理员修复漏洞，存在投毒代码的可能性较低。


**项目地址:** [StanleyJobsonAU/GhostTown](https://github.com/StanleyJobsonAU/GhostTown)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #7

**来源**: [CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md](../2023/CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器，且目标版本低于2023.05.4

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 存在于 JetBrains TeamCity 2023.05.4 之前的版本中，是一个身份验证绕过漏洞，可以导致未经身份验证的远程代码执行。攻击者可以利用此漏洞在 TeamCity 服务器上执行任意代码，从而完全控制服务器。漏洞利用方式如下：

1.  **身份验证绕过：** 利用漏洞绕过身份验证。
2.  **启用调试模式：** 通过修改 `internal.properties` 文件启用 `rest.debug.processes.enable`。
3.  **远程代码执行：** 使用 `/app/rest/debug/processes` 接口执行任意命令。脚本通过修改 `internal.properties` 文件，然后使用特制的请求调用 `debug/processes` 接口，从而在目标系统上执行任意命令。

提供的 `TeamCity.sh` 脚本允许用户指定目标操作系统 (Linux 或 Windows)，并相应地调整命令执行方式。脚本首先获取一个token，然后利用该 token 修改`internal.properties`文件以启用调试模式，最后使用构造好的包含恶意命令的URL来触发RCE。

投毒风险评估：代码中主要逻辑为漏洞利用，并未发现明显的恶意代码。`TeamCity.sh` 中选择目标OS后，Linux环境使用了`base64`编码命令，Windows没有。虽然脚本的行为符合漏洞利用的预期，但是如果攻击者对`base64` 编码方式做了手脚，有可能在Linux执行的时候插入恶意命令。`TeamCity2.sh` 脚本对命令进行URL编码，windows只支持powershell, 可以对powershell添加恶意payload. 因此，存在一定的投毒风险，估计在10%左右。

**项目地址:** [SwiftSecur/teamcity-exploit-cve-2023-42793](https://github.com/SwiftSecur/teamcity-exploit-cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #8

**来源**: [CVE-2023-42793-Zenmovie_CVE-2023-42793.md](../2023/CVE-2023-42793-Zenmovie_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity实例需要开启网络访问，且版本低于2023.05.4。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的远程攻击者绕过身份验证，并在服务器上执行任意代码。根据漏洞库信息，CVSS评分为9.8（严重）。

**利用方式：**

1.  **身份验证绕过：** 攻击者利用未经身份验证的REST API端点`/app/rest/users/id:1/tokens/RPC2`来获取一个有效的Bearer Token。这个Token最初的设计目的是允许用户通过API管理自己的Token。
2.  **修改内部属性：** 使用获取的Token，通过POST请求访问`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`修改内部属性，启用`rest.debug.processes.enable`，此步骤为后续RCE做准备。
3.  **远程代码执行：**  利用被启用的REST API端点`/app/rest/debug/processes?exePath=${COMMAND}`，通过`exePath`参数执行任意命令。该端点在正常情况下只允许经过身份验证的管理员访问，但由于身份验证绕过，未经授权的攻击者可以利用它。

**POC有效性：**

提供的POC代码包含两个脚本：`CVE-2023-42793_admin.sh`和`CVE-2023-42793_rce.sh`。

*   `CVE-2023-42793_admin.sh`脚本利用漏洞创建一个新的管理员用户（Zenmovie/Zenmovie），方便后续访问TeamCity。
*   `CVE-2023-42793_rce.sh`脚本利用漏洞执行指定的命令，并返回命令输出。

从提供的README.md中的截图以及漏洞原理来看，POC代码是有效的，可以成功利用该漏洞。

**投毒风险：**

评估投毒风险，需考虑作者是否有意在代码中添加恶意功能。

1.  **代码混淆/隐藏：** 代码没有进行明显的混淆。虽然使用了`grep`和`awk`提取Token和命令输出，但是属于正常利用。
2.  **恶意依赖：** 代码没有引入外部依赖。
3.  **后门代码：** 代码的主要功能是利用漏洞，创建管理员账户或执行命令。没有发现明显与漏洞利用无关的恶意代码，例如反弹shell、上传文件等。
4.  **隐蔽指令：**  检查代码中是否存在不易察觉的指令，例如通过环境变量、时间等触发的恶意行为。没有发现此类指令。

尽管POC的主要功能是漏洞利用，仍存在一定的投毒风险。例如，攻击者可能修改`CVE-2023-42793_rce.sh`脚本，在执行目标命令之前，先执行一些恶意操作，例如下载并执行恶意程序，添加后门账户等。这种风险很难通过静态分析完全排除，需要进行动态分析，实际运行poc代码进行监控。

因此，综合考虑，投毒风险评估为10%。这个风险主要来源于用户下载和使用POC时，可能会下载到被篡改过的恶意版本。

**结论：**

CVE-2023-42793是一个高危漏洞，利用简单，影响范围广。建议受影响的用户尽快升级到最新版本。在使用公开的POC代码时，务必谨慎，进行代码审计，并确保从可信来源下载。

**项目地址:** [Zenmovie/CVE-2023-42793](https://github.com/Zenmovie/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #9

**来源**: [CVE-2023-42793-becrevex_CVE-2023-42793.md](../2023/CVE-2023-42793-becrevex_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个认证绕过漏洞，攻击者无需认证即可利用此漏洞在TeamCity服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8，属于高危漏洞，并且已被积极利用。多家安全公司和组织（例如Rapid7，Fortinet，Microsoft，CISA）都发布了关于该漏洞的分析和利用报告，甚至有APT组织（APT29，北朝鲜黑客组织）利用该漏洞进行攻击。

提供的POC代码是一个Nmap脚本，用于检测目标TeamCity服务器是否存在CVE-2023-42793漏洞。该脚本通过向`/app/rest/users/id:1/tokens/RPC2`路径发送POST请求，尝试创建一个新的用户令牌，如果服务器返回200状态码且包含一个令牌，则表明服务器存在漏洞。该脚本本身的行为是良性的，只是用于验证漏洞的存在，没有发现任何投毒代码。

**有效性：**
根据提供的漏洞信息和POC代码，该POC代码有效，可以用于检测目标是否存在CVE-2023-42793漏洞。

**投毒风险：**
对提供的Nmap脚本进行了分析，没有发现任何明显的投毒代码。脚本的功能明确，即检测TeamCity服务器上的漏洞，没有发现任何恶意行为。风险评估为0%

**利用方式：**
1.  攻击者利用未授权访问漏洞，绕过身份验证。
2.  攻击者发送特制请求，例如向`/app/rest/users/id:1/tokens/RPC2`路径创建用户Token。
3.  成功创建Token后，攻击者获得管理员权限。
4.  利用管理员权限执行任意代码，实现远程代码执行。

该漏洞利用简单，影响严重，建议TeamCity用户尽快升级到2023.05.4或更高版本。

**项目地址:** [becrevex/CVE-2023-42793](https://github.com/becrevex/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #10

**来源**: [CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md](../2023/CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** JetBrains TeamCity

**危害等级:** 极高，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可从网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity 2023.05.4之前版本中存在的一个身份验证绕过漏洞，可能导致未经身份验证的远程代码执行。根据漏洞库信息，此漏洞的CVSS评分为9.8，属于严重级别。多个搜索结果表明，该漏洞已被积极利用，甚至被APT组织利用进行攻击。提供的POC代码是一个Python脚本，它利用漏洞执行远程命令。

**利用方式：**

1.  **身份验证绕过：** 该漏洞允许攻击者绕过TeamCity服务器的身份验证机制。
2.  **获取Bearer Token：** 利用未经身份验证的访问，通过`/app/rest/users/id:1/tokens/RPC2`端点创建一个临时的Bearer Token。
3.  **启用调试模式：** 使用获得的Bearer Token，通过`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`端点启用调试模式，即`rest.debug.processes.enable=true`。
4.  **远程代码执行：** 使用获得的Bearer Token，通过`/app/rest/debug/processes`端点执行任意命令。POC使用bash反弹shell，通过URL编码将命令传递给目标服务器。

**有效性评估：**

提供的POC代码看起来是有效的。它利用了TeamCity REST API中的漏洞，绕过身份验证并执行任意代码。 脚本首先尝试获取一个临时的Bearer Token，然后使用该Token来修改`internal.properties`文件以启用调试模式。最后，脚本使用调试模式来执行远程代码。 脚本的`README.md`文件中提供的参考链接也支持了该漏洞的存在和可利用性。搜索结果中大量的安全厂商报告和分析也证实了此漏洞的真实性和高危性。

**投毒风险评估：**

分析POC代码没有发现明显的投毒代码。脚本的功能主要集中在利用漏洞进行远程代码执行，没有发现额外的恶意行为或后门。该脚本的功能与漏洞描述以及利用方式相符，未发现任何异常行为。因此，投毒风险评估为0%。

**项目地址:** [hotplugin0x01/CVE-2023-42793](https://github.com/hotplugin0x01/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #11

**来源**: [CVE-2023-42793-jakehomb_cve-2023-42793.md](../2023/CVE-2023-42793-jakehomb_cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器版本低于2023.05.4，且可通过HTTP(S)访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2023-42793 允许未经身份验证的攻击者在 TeamCity 服务器上执行远程代码。该漏洞利用方式是通过绕过身份验证机制，直接访问受保护的资源并执行恶意操作。

**有效性：**
根据提供的漏洞信息、搜索结果以及漏洞利用代码，可以判断该漏洞的 POC 代码有效。CVE 详情中提到存在身份验证绕过导致 RCE，搜索结果也表明该漏洞存在公开可用的exploit，并且已经被APT29等恶意行为者利用。

**投毒风险：**
提供的漏洞利用代码主要由两部分组成：获取 Token 和创建用户。getToken 函数尝试从 /app/rest/users/id:1/token/RPC2 获取一个 Token，createUser 函数使用这个 Token 来创建一个具有管理员权限的用户。代码本身功能明确，没有发现隐藏的恶意代码。因此，评估该仓库中存在作者隐藏的投毒代码的风险为0%。

**利用方式：**
1.  **目标探测：** 确定目标 TeamCity 服务器的版本是否低于 2023.05.4。
2.  **Token 获取：** 使用 `getToken` 函数，通过向 `https://<teamcity_url>/app/rest/users/id:1/token/RPC2` 发送 GET 请求，尝试获取一个 Token。服务器无需授权即可响应。  `extractToken` 函数从响应中提取 Token。
3.  **用户创建：** 使用 `createUser` 函数，携带上一步获取的 Token，向 `https://<teamcity_url>/app/rest/users` 发送 POST 请求，创建一个具有 SYSTEM_ADMIN 角色的新用户。请求的 Body 为包含用户名、密码和邮箱的JSON格式。
4.  **权限提升：** 使用新创建的管理员用户登录 TeamCity 服务器，获得完全控制权限，从而执行任意代码。

**项目地址:** [jakehomb/cve-2023-42793](https://github.com/jakehomb/cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #12

**来源**: [CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md](../2023/CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行远程代码。该漏洞影响2023.05.4之前的版本。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的，并且已被广泛利用。CISA已将其添加到已知被利用漏洞目录中。搜索引擎结果中多个安全厂商的博客也证实了该漏洞的有效性。

**投毒风险：**
提供的PoC代码本身的功能是利用漏洞创建新的管理员用户。`README.md`文件描述了脚本的功能，与代码行为一致。代码中对创建的用户名称添加了随机数，并会写入 `vulnerable.txt` 文件。 `vulnerable.txt`文件可能存在信息泄露的风险,如果被攻击者获取，可能结合其他漏洞使用。总体来看，该PoC代码存在投毒风险的可能性较低，约为10%。

**利用方式：**
1.  **删除用户令牌：** PoC首先尝试删除ID为1的用户令牌 (通常是管理员)。
2.  **创建用户令牌：** 如果删除成功或不存在，PoC会尝试为ID为1的用户创建一个新的用户令牌。
3.  **创建管理员用户：** 使用新创建的用户令牌，PoC会创建一个具有`SYSTEM_ADMIN`权限的新用户，用户名和密码是硬编码的（用户名以 `_secops` 开头，加上随机数，密码是 `changeme`）。
4.  **利用新用户登录：** 攻击者可以使用新创建的管理员帐户登录TeamCity服务器，从而完全控制该服务器。
5.  **自动化攻击:** 通过-u指定url或者-l指定url列表，实现批量攻击。

**项目地址:** [johnossawy/CVE-2023-42793_POC](https://github.com/johnossawy/CVE-2023-42793_POC)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #13

**来源**: [CVE-2023-42793-junnythemarksman_CVE-2023-42793.md](../2023/CVE-2023-42793-junnythemarksman_CVE-2023-42793.md)

# CVE-2023-42793

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md](../2023/CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md)

## CVE-2023-42793 - TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个身份验证绕过漏洞，未经身份验证的攻击者可以通过发送特制的 HTTP 请求绕过身份验证，从而创建管理员账户并最终实现远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果中多个链接都提到了该漏洞被积极利用，包括APT组织。漏洞利用代码提供了创建管理员账户和执行RCE的脚本，并且说明了如何利用该漏洞，包括如何获取反向shell。

**投毒风险：**
分析提供的`exploit.py`和`rce_exploit.py`，主要功能是创建管理员账户和执行任意命令。脚本本身的代码逻辑相对简单，没有明显的恶意代码。其中`exploit.py`会生成随机用户名、密码和邮箱地址，这可能被误认为恶意行为，但这是为了方便利用而设计的，并非投毒。`rce_exploit.py`脚本依赖于第一个脚本创建的token文件。虽然没有发现明显的后门代码，但仍存在极小的风险，例如在生成随机字符串时引入偏差，虽然可能性极小，但理论上存在被利用的可能性，将投毒风险评定为5%。

**利用方式：**
1.  **身份验证绕过：** 攻击者首先利用身份验证绕过漏洞，该漏洞允许未经身份验证的攻击者与TeamCity服务器进行交互，绕过正常的身份验证流程。
2.  **创建管理员账户：** 使用 `exploit.py` 脚本，通过发送特制的 POST 请求，在 TeamCity 服务器上创建一个新的管理员账户。可以指定用户名、密码和邮箱，也可以使用随机生成的凭据。成功创建后，会将凭据保存到token文件中。
3.  **远程代码执行：** 使用 `rce.py` 脚本，该脚本首先启用debug processes，然后利用创建的管理员账户，通过 TeamCity 的 API 接口执行任意命令。可以执行系统命令，例如 `whoami`，也可以获取反向 shell，从而完全控制服务器。
4.  **反向Shell:** 利用rce.py执行命令，通过反弹shell到攻击者机器上，来获取服务器的控制权。


**项目地址:** [B4l3rI0n/CVE-2023-42793](https://github.com/B4l3rI0n/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #2

**来源**: [CVE-2023-42793-FlojBoj_CVE-2023-42793.md](../2023/CVE-2023-42793-FlojBoj_CVE-2023-42793.md)

## CVE-2023-42793-JetBrainsTeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可能导致远程代码执行和完全控制TeamCity服务器

**影响版本:** < 2023.05.4

**利用条件:** 需要能够通过HTTP(S)访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，攻击者无需身份验证即可执行远程代码。漏洞利用方式如下：

1.  **有效性：** 漏洞信息和搜索结果表明该漏洞已在野外被积极利用，包括APT组织（如APT29、CozyBear、北朝鲜黑客组织）和俄罗斯情报部门SVR。提供的代码`exploit.py`旨在利用此漏洞创建管理员账户或获取现有用户的token，从而控制TeamCity服务器。根据README.md的描述，还有一个`rce.py`脚本可以执行远程命令，但主脚本`exploit.py`的功能是创建管理员账户。

2.  **投毒风险：** 代码`exploit.py`本身的功能是利用漏洞创建管理员用户或获取token。投毒风险评估如下：
    *   代码中存在一些硬编码，例如默认密码"Password@123"和默认邮箱域名"@lol.omg"，如果直接使用这些默认值，容易被检测和防御。但这不属于投毒，而是简化使用的示例。
    *   代码尝试首先获取或删除现有的token，这增加了攻击成功的概率，但也可能在目标环境中留下痕迹。
    *   总体来看，`exploit.py`的主要风险在于被滥用以非法控制TeamCity服务器，而非恶意代码本身。因此，投毒风险较低，估计为10%。主要是担心引入了额外的请求或命令，用于收集用户信息或执行其他未经授权的操作。

3.  **利用方式：** 利用方式主要分为以下步骤：
    a.  攻击者发送特制的HTTP请求到TeamCity服务器，绕过身份验证。
    b.  使用`exploit.py`脚本，指定目标TeamCity服务器的URL。
    c.  脚本尝试获取或删除现有的token，然后创建一个新的管理员用户，或者获取指定用户的token。
    d.  如果成功创建管理员用户，攻击者可以使用新创建的管理员账户登录TeamCity服务器，并获得完全控制权限。
    e. 通过获取到的token, 攻击者可以模拟用户身份，从而执行相关操作。

该漏洞的严重性在于未经身份验证即可创建管理员帐户并执行任意代码，从而完全控制受影响的TeamCity服务器。缓解措施包括尽快升级到2023.05.4或更高版本。

**项目地址:** [FlojBoj/CVE-2023-42793](https://github.com/FlojBoj/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #3

**来源**: [CVE-2023-42793-H454NSec_CVE-2023-42793.md](../2023/CVE-2023-42793-H454NSec_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从攻击者控制的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 漏洞存在于JetBrains TeamCity 2023.05.4 之前的版本中，允许未经身份验证的攻击者绕过身份验证，最终实现远程代码执行。根据漏洞库信息，该漏洞的 CVSS 3.1 评分为 9.8，属于严重级别。搜索结果表明，该漏洞已被广泛利用，甚至被 APT 组织用于攻击活动。 

**漏洞利用方式：**

1.  **身份验证绕过：** 漏洞利用代码通过发送特制的 HTTP 请求来绕过 TeamCity 的身份验证机制。具体利用细节需要分析补丁或者参考其他分析报告。
2.  **创建管理员用户：** 漏洞利用代码首先删除 id 为 1 的用户的token，然后创建一个新的用户 token。使用这个 token，攻击者可以创建一个具有管理员权限的新用户。新用户的用户名和密码可以通过命令行参数指定，默认用户名为 `H454NSec[随机数]`，密码为 `@H454NSec`。利用成功后，即可使用创建的管理员用户登录TeamCity控制台。
3.  **远程代码执行：** 通过管理员权限，攻击者可以在 TeamCity 服务器上执行任意代码，实现远程控制。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确定该 POC 代码是有效的。漏洞已被公开披露且有可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。风险分析如下：

*   **代码结构：** 代码结构相对清晰，主要功能是利用漏洞创建管理员用户。
*   **可疑行为：** 代码中存在以下潜在风险：
    *   **默认用户名和密码：** 使用默认的用户名和密码 `@H454NSec` 创建管理员帐户，这可能会让其他攻击者更容易入侵，或者导致安全审计告警。
    *   **硬编码的 User-Agent：**  User-Agent头 `Mozilla/5.0 (https://github.com/H454NSec/CVE-2023-42793) Gecko/20100101 Firefox/113.0`  可能被用于追踪攻击源。但同时也降低了攻击的隐蔽性。
    *   **未处理异常：** 虽然代码有异常处理，但仅仅是简单的`pass`，可能会隐藏一些错误信息，增加调试难度。
*   **高危操作：**  漏洞利用本身就是高危操作，如果攻击者通过修改poc加入恶意命令，将会造成严重危害，例如植入后门。

综合考虑以上因素，该 POC 代码的投毒风险评估为 10%。主要风险在于攻击者可能利用该代码进行二次修改，加入恶意代码或后门，从而扩大攻击范围。

**项目地址:** [H454NSec/CVE-2023-42793](https://github.com/H454NSec/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #4

**来源**: [CVE-2023-42793-HusenjanDev_CVE-2023-42793.md](../2023/CVE-2023-42793-HusenjanDev_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从网络访问，需要通过其他途径获取TeamCity Token。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，允许未经身份验证的攻击者通过HTTP(S)访问TeamCity服务器，并执行远程代码。根据漏洞库信息，CVSS评分为9.8，属于严重级别。搜索引擎结果显示，该漏洞已被多个APT组织利用，包括APT29、北朝鲜的Diamond Sleet和Onyx Sleet以及俄罗斯对外情报局 (SVR)，显示其真实性和危害性。Rapid7的博客文章也详细分析了该漏洞。提供的POC代码的利用方式是：

1.  **获取TeamCity Token:**  `readme.md` 中提到，需要通过其他漏洞或者方式获取TeamCity的Token. 这是利用此POC的前提。
2.  **启用调试模式:** 使用curl命令发送POST请求到`/admin/dataDir.html`，修改`config/internal.properties`文件，启用`rest.debug.processes.enable=true`，从而开启调试模式。这一步通过token进行验证。
3.  **构造反弹shell Payload:**  将反弹shell命令进行URL编码，目标是让受害者主机连接攻击者的Netcat监听器。
4.  **执行远程命令:** 使用curl命令发送POST请求到`/app/rest/debug/processes`，指定`exePath`为`/bin/bash`，`params`为`-c`和URL编码后的反弹shell命令。这个请求同样需要token验证。漏洞利用依赖于已获取的TeamCity token，然后通过启用调试模式执行反弹shell。根据分析，该POC代码没有明显的投毒行为。

**项目地址:** [HusenjanDev/CVE-2023-42793](https://github.com/HusenjanDev/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #5

**来源**: [CVE-2023-42793-LeHeron_TC_test.md](../2023/CVE-2023-42793-LeHeron_TC_test.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个严重的身份验证绕过漏洞，攻击者无需身份验证即可在 TeamCity 服务器上执行远程代码。根据漏洞信息和搜索结果，该漏洞已被积极利用，甚至APT组织，如CozyBear，以及北朝鲜的APT组织都在利用该漏洞。 

**有效性：**
根据搜索结果，此漏洞已经存在公开的利用代码，且已被广泛利用，证明漏洞有效。

**投毒风险：**
提供的漏洞利用代码 `/tmp/da0475f0898b55e5196bf0f36ac9d45e/README`  只是一个简单的README文件，内容为 “Hello World”，不包含任何可执行代码或恶意指令。投毒的可能性极低，可以认为几乎不存在，给到1%的可能也只是对未知风险的保留。

**利用方式：**
根据漏洞描述，攻击者可以通过未授权访问TeamCity服务器，从而执行任意代码。具体的利用方式可能涉及到构造特定的HTTP请求绕过身份验证机制，然后利用TeamCity服务器的功能执行恶意命令。参考Rapid7的博客文章，该漏洞利用可能与特定的端点和参数有关，允许攻击者创建管理员用户或直接执行代码。 从搜索结果来看，该漏洞已经成为恶意行为者的攻击目标，建议尽快升级到安全版本。

**项目地址:** [LeHeron/TC_test](https://github.com/LeHeron/TC_test)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #6

**来源**: [CVE-2023-42793-StanleyJobsonAU_GhostTown.md](../2023/CVE-2023-42793-StanleyJobsonAU_GhostTown.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个身份验证绕过漏洞，允许未经身份验证的攻击者远程执行代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8（严重），并且已被积极利用。搜索结果表明，包括APT29、朝鲜黑客组织以及俄罗斯对外情报局（SVR）等多个威胁组织都在利用此漏洞。提供的POC代码 `GhostTown.py` 旨在利用此漏洞。利用方式如下：

1.  **生成管理员Token：** POC首先尝试通过 `/app/rest/users/id:1/tokens/RPC2` 接口创建一个管理员Token。这将绕过身份验证。
2.  **检索内部配置：** 使用生成的管理员Token，POC尝试从 `/get/file/dataDir/config/internal.properties` 接口检索TeamCity的内部配置。
3.  **更新配置：** POC会检查配置项中是否包含 `rest.debug.processes.enable=true`，如果不存在，则将其添加到配置项中，并通过 `/get/file/dataDir/config/internal.properties` 接口更新配置。`rest.debug.processes.enable=true` 配置的目的是允许执行调试进程，这为远程代码执行铺平了道路。(这部分未在提供的代码片段中。)
4. **远程代码执行：** 启用调试进程允许攻击者通过构造特定的请求来执行任意命令。

**有效性：** 根据漏洞信息和搜索结果，此POC代码有效，能够利用CVE-2023-42793漏洞实现RCE。

**投毒风险：** 检查提供的代码，主要逻辑集中在利用漏洞上，没有发现明显的恶意代码或后门。该代码是为了验证漏洞存在，并帮助安全研究人员和管理员修复漏洞，存在投毒代码的可能性较低。


**项目地址:** [StanleyJobsonAU/GhostTown](https://github.com/StanleyJobsonAU/GhostTown)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #7

**来源**: [CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md](../2023/CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器，且目标版本低于2023.05.4

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 存在于 JetBrains TeamCity 2023.05.4 之前的版本中，是一个身份验证绕过漏洞，可以导致未经身份验证的远程代码执行。攻击者可以利用此漏洞在 TeamCity 服务器上执行任意代码，从而完全控制服务器。漏洞利用方式如下：

1.  **身份验证绕过：** 利用漏洞绕过身份验证。
2.  **启用调试模式：** 通过修改 `internal.properties` 文件启用 `rest.debug.processes.enable`。
3.  **远程代码执行：** 使用 `/app/rest/debug/processes` 接口执行任意命令。脚本通过修改 `internal.properties` 文件，然后使用特制的请求调用 `debug/processes` 接口，从而在目标系统上执行任意命令。

提供的 `TeamCity.sh` 脚本允许用户指定目标操作系统 (Linux 或 Windows)，并相应地调整命令执行方式。脚本首先获取一个token，然后利用该 token 修改`internal.properties`文件以启用调试模式，最后使用构造好的包含恶意命令的URL来触发RCE。

投毒风险评估：代码中主要逻辑为漏洞利用，并未发现明显的恶意代码。`TeamCity.sh` 中选择目标OS后，Linux环境使用了`base64`编码命令，Windows没有。虽然脚本的行为符合漏洞利用的预期，但是如果攻击者对`base64` 编码方式做了手脚，有可能在Linux执行的时候插入恶意命令。`TeamCity2.sh` 脚本对命令进行URL编码，windows只支持powershell, 可以对powershell添加恶意payload. 因此，存在一定的投毒风险，估计在10%左右。

**项目地址:** [SwiftSecur/teamcity-exploit-cve-2023-42793](https://github.com/SwiftSecur/teamcity-exploit-cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #8

**来源**: [CVE-2023-42793-Zenmovie_CVE-2023-42793.md](../2023/CVE-2023-42793-Zenmovie_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity实例需要开启网络访问，且版本低于2023.05.4。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的远程攻击者绕过身份验证，并在服务器上执行任意代码。根据漏洞库信息，CVSS评分为9.8（严重）。

**利用方式：**

1.  **身份验证绕过：** 攻击者利用未经身份验证的REST API端点`/app/rest/users/id:1/tokens/RPC2`来获取一个有效的Bearer Token。这个Token最初的设计目的是允许用户通过API管理自己的Token。
2.  **修改内部属性：** 使用获取的Token，通过POST请求访问`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`修改内部属性，启用`rest.debug.processes.enable`，此步骤为后续RCE做准备。
3.  **远程代码执行：**  利用被启用的REST API端点`/app/rest/debug/processes?exePath=${COMMAND}`，通过`exePath`参数执行任意命令。该端点在正常情况下只允许经过身份验证的管理员访问，但由于身份验证绕过，未经授权的攻击者可以利用它。

**POC有效性：**

提供的POC代码包含两个脚本：`CVE-2023-42793_admin.sh`和`CVE-2023-42793_rce.sh`。

*   `CVE-2023-42793_admin.sh`脚本利用漏洞创建一个新的管理员用户（Zenmovie/Zenmovie），方便后续访问TeamCity。
*   `CVE-2023-42793_rce.sh`脚本利用漏洞执行指定的命令，并返回命令输出。

从提供的README.md中的截图以及漏洞原理来看，POC代码是有效的，可以成功利用该漏洞。

**投毒风险：**

评估投毒风险，需考虑作者是否有意在代码中添加恶意功能。

1.  **代码混淆/隐藏：** 代码没有进行明显的混淆。虽然使用了`grep`和`awk`提取Token和命令输出，但是属于正常利用。
2.  **恶意依赖：** 代码没有引入外部依赖。
3.  **后门代码：** 代码的主要功能是利用漏洞，创建管理员账户或执行命令。没有发现明显与漏洞利用无关的恶意代码，例如反弹shell、上传文件等。
4.  **隐蔽指令：**  检查代码中是否存在不易察觉的指令，例如通过环境变量、时间等触发的恶意行为。没有发现此类指令。

尽管POC的主要功能是漏洞利用，仍存在一定的投毒风险。例如，攻击者可能修改`CVE-2023-42793_rce.sh`脚本，在执行目标命令之前，先执行一些恶意操作，例如下载并执行恶意程序，添加后门账户等。这种风险很难通过静态分析完全排除，需要进行动态分析，实际运行poc代码进行监控。

因此，综合考虑，投毒风险评估为10%。这个风险主要来源于用户下载和使用POC时，可能会下载到被篡改过的恶意版本。

**结论：**

CVE-2023-42793是一个高危漏洞，利用简单，影响范围广。建议受影响的用户尽快升级到最新版本。在使用公开的POC代码时，务必谨慎，进行代码审计，并确保从可信来源下载。

**项目地址:** [Zenmovie/CVE-2023-42793](https://github.com/Zenmovie/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #9

**来源**: [CVE-2023-42793-becrevex_CVE-2023-42793.md](../2023/CVE-2023-42793-becrevex_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个认证绕过漏洞，攻击者无需认证即可利用此漏洞在TeamCity服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8，属于高危漏洞，并且已被积极利用。多家安全公司和组织（例如Rapid7，Fortinet，Microsoft，CISA）都发布了关于该漏洞的分析和利用报告，甚至有APT组织（APT29，北朝鲜黑客组织）利用该漏洞进行攻击。

提供的POC代码是一个Nmap脚本，用于检测目标TeamCity服务器是否存在CVE-2023-42793漏洞。该脚本通过向`/app/rest/users/id:1/tokens/RPC2`路径发送POST请求，尝试创建一个新的用户令牌，如果服务器返回200状态码且包含一个令牌，则表明服务器存在漏洞。该脚本本身的行为是良性的，只是用于验证漏洞的存在，没有发现任何投毒代码。

**有效性：**
根据提供的漏洞信息和POC代码，该POC代码有效，可以用于检测目标是否存在CVE-2023-42793漏洞。

**投毒风险：**
对提供的Nmap脚本进行了分析，没有发现任何明显的投毒代码。脚本的功能明确，即检测TeamCity服务器上的漏洞，没有发现任何恶意行为。风险评估为0%

**利用方式：**
1.  攻击者利用未授权访问漏洞，绕过身份验证。
2.  攻击者发送特制请求，例如向`/app/rest/users/id:1/tokens/RPC2`路径创建用户Token。
3.  成功创建Token后，攻击者获得管理员权限。
4.  利用管理员权限执行任意代码，实现远程代码执行。

该漏洞利用简单，影响严重，建议TeamCity用户尽快升级到2023.05.4或更高版本。

**项目地址:** [becrevex/CVE-2023-42793](https://github.com/becrevex/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #10

**来源**: [CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md](../2023/CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** JetBrains TeamCity

**危害等级:** 极高，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可从网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity 2023.05.4之前版本中存在的一个身份验证绕过漏洞，可能导致未经身份验证的远程代码执行。根据漏洞库信息，此漏洞的CVSS评分为9.8，属于严重级别。多个搜索结果表明，该漏洞已被积极利用，甚至被APT组织利用进行攻击。提供的POC代码是一个Python脚本，它利用漏洞执行远程命令。

**利用方式：**

1.  **身份验证绕过：** 该漏洞允许攻击者绕过TeamCity服务器的身份验证机制。
2.  **获取Bearer Token：** 利用未经身份验证的访问，通过`/app/rest/users/id:1/tokens/RPC2`端点创建一个临时的Bearer Token。
3.  **启用调试模式：** 使用获得的Bearer Token，通过`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`端点启用调试模式，即`rest.debug.processes.enable=true`。
4.  **远程代码执行：** 使用获得的Bearer Token，通过`/app/rest/debug/processes`端点执行任意命令。POC使用bash反弹shell，通过URL编码将命令传递给目标服务器。

**有效性评估：**

提供的POC代码看起来是有效的。它利用了TeamCity REST API中的漏洞，绕过身份验证并执行任意代码。 脚本首先尝试获取一个临时的Bearer Token，然后使用该Token来修改`internal.properties`文件以启用调试模式。最后，脚本使用调试模式来执行远程代码。 脚本的`README.md`文件中提供的参考链接也支持了该漏洞的存在和可利用性。搜索结果中大量的安全厂商报告和分析也证实了此漏洞的真实性和高危性。

**投毒风险评估：**

分析POC代码没有发现明显的投毒代码。脚本的功能主要集中在利用漏洞进行远程代码执行，没有发现额外的恶意行为或后门。该脚本的功能与漏洞描述以及利用方式相符，未发现任何异常行为。因此，投毒风险评估为0%。

**项目地址:** [hotplugin0x01/CVE-2023-42793](https://github.com/hotplugin0x01/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #11

**来源**: [CVE-2023-42793-jakehomb_cve-2023-42793.md](../2023/CVE-2023-42793-jakehomb_cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器版本低于2023.05.4，且可通过HTTP(S)访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2023-42793 允许未经身份验证的攻击者在 TeamCity 服务器上执行远程代码。该漏洞利用方式是通过绕过身份验证机制，直接访问受保护的资源并执行恶意操作。

**有效性：**
根据提供的漏洞信息、搜索结果以及漏洞利用代码，可以判断该漏洞的 POC 代码有效。CVE 详情中提到存在身份验证绕过导致 RCE，搜索结果也表明该漏洞存在公开可用的exploit，并且已经被APT29等恶意行为者利用。

**投毒风险：**
提供的漏洞利用代码主要由两部分组成：获取 Token 和创建用户。getToken 函数尝试从 /app/rest/users/id:1/token/RPC2 获取一个 Token，createUser 函数使用这个 Token 来创建一个具有管理员权限的用户。代码本身功能明确，没有发现隐藏的恶意代码。因此，评估该仓库中存在作者隐藏的投毒代码的风险为0%。

**利用方式：**
1.  **目标探测：** 确定目标 TeamCity 服务器的版本是否低于 2023.05.4。
2.  **Token 获取：** 使用 `getToken` 函数，通过向 `https://<teamcity_url>/app/rest/users/id:1/token/RPC2` 发送 GET 请求，尝试获取一个 Token。服务器无需授权即可响应。  `extractToken` 函数从响应中提取 Token。
3.  **用户创建：** 使用 `createUser` 函数，携带上一步获取的 Token，向 `https://<teamcity_url>/app/rest/users` 发送 POST 请求，创建一个具有 SYSTEM_ADMIN 角色的新用户。请求的 Body 为包含用户名、密码和邮箱的JSON格式。
4.  **权限提升：** 使用新创建的管理员用户登录 TeamCity 服务器，获得完全控制权限，从而执行任意代码。

**项目地址:** [jakehomb/cve-2023-42793](https://github.com/jakehomb/cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #12

**来源**: [CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md](../2023/CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行远程代码。该漏洞影响2023.05.4之前的版本。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的，并且已被广泛利用。CISA已将其添加到已知被利用漏洞目录中。搜索引擎结果中多个安全厂商的博客也证实了该漏洞的有效性。

**投毒风险：**
提供的PoC代码本身的功能是利用漏洞创建新的管理员用户。`README.md`文件描述了脚本的功能，与代码行为一致。代码中对创建的用户名称添加了随机数，并会写入 `vulnerable.txt` 文件。 `vulnerable.txt`文件可能存在信息泄露的风险,如果被攻击者获取，可能结合其他漏洞使用。总体来看，该PoC代码存在投毒风险的可能性较低，约为10%。

**利用方式：**
1.  **删除用户令牌：** PoC首先尝试删除ID为1的用户令牌 (通常是管理员)。
2.  **创建用户令牌：** 如果删除成功或不存在，PoC会尝试为ID为1的用户创建一个新的用户令牌。
3.  **创建管理员用户：** 使用新创建的用户令牌，PoC会创建一个具有`SYSTEM_ADMIN`权限的新用户，用户名和密码是硬编码的（用户名以 `_secops` 开头，加上随机数，密码是 `changeme`）。
4.  **利用新用户登录：** 攻击者可以使用新创建的管理员帐户登录TeamCity服务器，从而完全控制该服务器。
5.  **自动化攻击:** 通过-u指定url或者-l指定url列表，实现批量攻击。

**项目地址:** [johnossawy/CVE-2023-42793_POC](https://github.com/johnossawy/CVE-2023-42793_POC)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #13

**来源**: [CVE-2023-42793-junnythemarksman_CVE-2023-42793.md](../2023/CVE-2023-42793-junnythemarksman_CVE-2023-42793.md)

# CVE-2023-42793

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md](../2023/CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md)

## CVE-2023-42793 - TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个身份验证绕过漏洞，未经身份验证的攻击者可以通过发送特制的 HTTP 请求绕过身份验证，从而创建管理员账户并最终实现远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果中多个链接都提到了该漏洞被积极利用，包括APT组织。漏洞利用代码提供了创建管理员账户和执行RCE的脚本，并且说明了如何利用该漏洞，包括如何获取反向shell。

**投毒风险：**
分析提供的`exploit.py`和`rce_exploit.py`，主要功能是创建管理员账户和执行任意命令。脚本本身的代码逻辑相对简单，没有明显的恶意代码。其中`exploit.py`会生成随机用户名、密码和邮箱地址，这可能被误认为恶意行为，但这是为了方便利用而设计的，并非投毒。`rce_exploit.py`脚本依赖于第一个脚本创建的token文件。虽然没有发现明显的后门代码，但仍存在极小的风险，例如在生成随机字符串时引入偏差，虽然可能性极小，但理论上存在被利用的可能性，将投毒风险评定为5%。

**利用方式：**
1.  **身份验证绕过：** 攻击者首先利用身份验证绕过漏洞，该漏洞允许未经身份验证的攻击者与TeamCity服务器进行交互，绕过正常的身份验证流程。
2.  **创建管理员账户：** 使用 `exploit.py` 脚本，通过发送特制的 POST 请求，在 TeamCity 服务器上创建一个新的管理员账户。可以指定用户名、密码和邮箱，也可以使用随机生成的凭据。成功创建后，会将凭据保存到token文件中。
3.  **远程代码执行：** 使用 `rce.py` 脚本，该脚本首先启用debug processes，然后利用创建的管理员账户，通过 TeamCity 的 API 接口执行任意命令。可以执行系统命令，例如 `whoami`，也可以获取反向 shell，从而完全控制服务器。
4.  **反向Shell:** 利用rce.py执行命令，通过反弹shell到攻击者机器上，来获取服务器的控制权。


**项目地址:** [B4l3rI0n/CVE-2023-42793](https://github.com/B4l3rI0n/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #2

**来源**: [CVE-2023-42793-FlojBoj_CVE-2023-42793.md](../2023/CVE-2023-42793-FlojBoj_CVE-2023-42793.md)

## CVE-2023-42793-JetBrainsTeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可能导致远程代码执行和完全控制TeamCity服务器

**影响版本:** < 2023.05.4

**利用条件:** 需要能够通过HTTP(S)访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，攻击者无需身份验证即可执行远程代码。漏洞利用方式如下：

1.  **有效性：** 漏洞信息和搜索结果表明该漏洞已在野外被积极利用，包括APT组织（如APT29、CozyBear、北朝鲜黑客组织）和俄罗斯情报部门SVR。提供的代码`exploit.py`旨在利用此漏洞创建管理员账户或获取现有用户的token，从而控制TeamCity服务器。根据README.md的描述，还有一个`rce.py`脚本可以执行远程命令，但主脚本`exploit.py`的功能是创建管理员账户。

2.  **投毒风险：** 代码`exploit.py`本身的功能是利用漏洞创建管理员用户或获取token。投毒风险评估如下：
    *   代码中存在一些硬编码，例如默认密码"Password@123"和默认邮箱域名"@lol.omg"，如果直接使用这些默认值，容易被检测和防御。但这不属于投毒，而是简化使用的示例。
    *   代码尝试首先获取或删除现有的token，这增加了攻击成功的概率，但也可能在目标环境中留下痕迹。
    *   总体来看，`exploit.py`的主要风险在于被滥用以非法控制TeamCity服务器，而非恶意代码本身。因此，投毒风险较低，估计为10%。主要是担心引入了额外的请求或命令，用于收集用户信息或执行其他未经授权的操作。

3.  **利用方式：** 利用方式主要分为以下步骤：
    a.  攻击者发送特制的HTTP请求到TeamCity服务器，绕过身份验证。
    b.  使用`exploit.py`脚本，指定目标TeamCity服务器的URL。
    c.  脚本尝试获取或删除现有的token，然后创建一个新的管理员用户，或者获取指定用户的token。
    d.  如果成功创建管理员用户，攻击者可以使用新创建的管理员账户登录TeamCity服务器，并获得完全控制权限。
    e. 通过获取到的token, 攻击者可以模拟用户身份，从而执行相关操作。

该漏洞的严重性在于未经身份验证即可创建管理员帐户并执行任意代码，从而完全控制受影响的TeamCity服务器。缓解措施包括尽快升级到2023.05.4或更高版本。

**项目地址:** [FlojBoj/CVE-2023-42793](https://github.com/FlojBoj/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #3

**来源**: [CVE-2023-42793-H454NSec_CVE-2023-42793.md](../2023/CVE-2023-42793-H454NSec_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从攻击者控制的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 漏洞存在于JetBrains TeamCity 2023.05.4 之前的版本中，允许未经身份验证的攻击者绕过身份验证，最终实现远程代码执行。根据漏洞库信息，该漏洞的 CVSS 3.1 评分为 9.8，属于严重级别。搜索结果表明，该漏洞已被广泛利用，甚至被 APT 组织用于攻击活动。 

**漏洞利用方式：**

1.  **身份验证绕过：** 漏洞利用代码通过发送特制的 HTTP 请求来绕过 TeamCity 的身份验证机制。具体利用细节需要分析补丁或者参考其他分析报告。
2.  **创建管理员用户：** 漏洞利用代码首先删除 id 为 1 的用户的token，然后创建一个新的用户 token。使用这个 token，攻击者可以创建一个具有管理员权限的新用户。新用户的用户名和密码可以通过命令行参数指定，默认用户名为 `H454NSec[随机数]`，密码为 `@H454NSec`。利用成功后，即可使用创建的管理员用户登录TeamCity控制台。
3.  **远程代码执行：** 通过管理员权限，攻击者可以在 TeamCity 服务器上执行任意代码，实现远程控制。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确定该 POC 代码是有效的。漏洞已被公开披露且有可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。风险分析如下：

*   **代码结构：** 代码结构相对清晰，主要功能是利用漏洞创建管理员用户。
*   **可疑行为：** 代码中存在以下潜在风险：
    *   **默认用户名和密码：** 使用默认的用户名和密码 `@H454NSec` 创建管理员帐户，这可能会让其他攻击者更容易入侵，或者导致安全审计告警。
    *   **硬编码的 User-Agent：**  User-Agent头 `Mozilla/5.0 (https://github.com/H454NSec/CVE-2023-42793) Gecko/20100101 Firefox/113.0`  可能被用于追踪攻击源。但同时也降低了攻击的隐蔽性。
    *   **未处理异常：** 虽然代码有异常处理，但仅仅是简单的`pass`，可能会隐藏一些错误信息，增加调试难度。
*   **高危操作：**  漏洞利用本身就是高危操作，如果攻击者通过修改poc加入恶意命令，将会造成严重危害，例如植入后门。

综合考虑以上因素，该 POC 代码的投毒风险评估为 10%。主要风险在于攻击者可能利用该代码进行二次修改，加入恶意代码或后门，从而扩大攻击范围。

**项目地址:** [H454NSec/CVE-2023-42793](https://github.com/H454NSec/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #4

**来源**: [CVE-2023-42793-HusenjanDev_CVE-2023-42793.md](../2023/CVE-2023-42793-HusenjanDev_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从网络访问，需要通过其他途径获取TeamCity Token。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，允许未经身份验证的攻击者通过HTTP(S)访问TeamCity服务器，并执行远程代码。根据漏洞库信息，CVSS评分为9.8，属于严重级别。搜索引擎结果显示，该漏洞已被多个APT组织利用，包括APT29、北朝鲜的Diamond Sleet和Onyx Sleet以及俄罗斯对外情报局 (SVR)，显示其真实性和危害性。Rapid7的博客文章也详细分析了该漏洞。提供的POC代码的利用方式是：

1.  **获取TeamCity Token:**  `readme.md` 中提到，需要通过其他漏洞或者方式获取TeamCity的Token. 这是利用此POC的前提。
2.  **启用调试模式:** 使用curl命令发送POST请求到`/admin/dataDir.html`，修改`config/internal.properties`文件，启用`rest.debug.processes.enable=true`，从而开启调试模式。这一步通过token进行验证。
3.  **构造反弹shell Payload:**  将反弹shell命令进行URL编码，目标是让受害者主机连接攻击者的Netcat监听器。
4.  **执行远程命令:** 使用curl命令发送POST请求到`/app/rest/debug/processes`，指定`exePath`为`/bin/bash`，`params`为`-c`和URL编码后的反弹shell命令。这个请求同样需要token验证。漏洞利用依赖于已获取的TeamCity token，然后通过启用调试模式执行反弹shell。根据分析，该POC代码没有明显的投毒行为。

**项目地址:** [HusenjanDev/CVE-2023-42793](https://github.com/HusenjanDev/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #5

**来源**: [CVE-2023-42793-LeHeron_TC_test.md](../2023/CVE-2023-42793-LeHeron_TC_test.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个严重的身份验证绕过漏洞，攻击者无需身份验证即可在 TeamCity 服务器上执行远程代码。根据漏洞信息和搜索结果，该漏洞已被积极利用，甚至APT组织，如CozyBear，以及北朝鲜的APT组织都在利用该漏洞。 

**有效性：**
根据搜索结果，此漏洞已经存在公开的利用代码，且已被广泛利用，证明漏洞有效。

**投毒风险：**
提供的漏洞利用代码 `/tmp/da0475f0898b55e5196bf0f36ac9d45e/README`  只是一个简单的README文件，内容为 “Hello World”，不包含任何可执行代码或恶意指令。投毒的可能性极低，可以认为几乎不存在，给到1%的可能也只是对未知风险的保留。

**利用方式：**
根据漏洞描述，攻击者可以通过未授权访问TeamCity服务器，从而执行任意代码。具体的利用方式可能涉及到构造特定的HTTP请求绕过身份验证机制，然后利用TeamCity服务器的功能执行恶意命令。参考Rapid7的博客文章，该漏洞利用可能与特定的端点和参数有关，允许攻击者创建管理员用户或直接执行代码。 从搜索结果来看，该漏洞已经成为恶意行为者的攻击目标，建议尽快升级到安全版本。

**项目地址:** [LeHeron/TC_test](https://github.com/LeHeron/TC_test)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #6

**来源**: [CVE-2023-42793-StanleyJobsonAU_GhostTown.md](../2023/CVE-2023-42793-StanleyJobsonAU_GhostTown.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个身份验证绕过漏洞，允许未经身份验证的攻击者远程执行代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8（严重），并且已被积极利用。搜索结果表明，包括APT29、朝鲜黑客组织以及俄罗斯对外情报局（SVR）等多个威胁组织都在利用此漏洞。提供的POC代码 `GhostTown.py` 旨在利用此漏洞。利用方式如下：

1.  **生成管理员Token：** POC首先尝试通过 `/app/rest/users/id:1/tokens/RPC2` 接口创建一个管理员Token。这将绕过身份验证。
2.  **检索内部配置：** 使用生成的管理员Token，POC尝试从 `/get/file/dataDir/config/internal.properties` 接口检索TeamCity的内部配置。
3.  **更新配置：** POC会检查配置项中是否包含 `rest.debug.processes.enable=true`，如果不存在，则将其添加到配置项中，并通过 `/get/file/dataDir/config/internal.properties` 接口更新配置。`rest.debug.processes.enable=true` 配置的目的是允许执行调试进程，这为远程代码执行铺平了道路。(这部分未在提供的代码片段中。)
4. **远程代码执行：** 启用调试进程允许攻击者通过构造特定的请求来执行任意命令。

**有效性：** 根据漏洞信息和搜索结果，此POC代码有效，能够利用CVE-2023-42793漏洞实现RCE。

**投毒风险：** 检查提供的代码，主要逻辑集中在利用漏洞上，没有发现明显的恶意代码或后门。该代码是为了验证漏洞存在，并帮助安全研究人员和管理员修复漏洞，存在投毒代码的可能性较低。


**项目地址:** [StanleyJobsonAU/GhostTown](https://github.com/StanleyJobsonAU/GhostTown)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #7

**来源**: [CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md](../2023/CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器，且目标版本低于2023.05.4

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 存在于 JetBrains TeamCity 2023.05.4 之前的版本中，是一个身份验证绕过漏洞，可以导致未经身份验证的远程代码执行。攻击者可以利用此漏洞在 TeamCity 服务器上执行任意代码，从而完全控制服务器。漏洞利用方式如下：

1.  **身份验证绕过：** 利用漏洞绕过身份验证。
2.  **启用调试模式：** 通过修改 `internal.properties` 文件启用 `rest.debug.processes.enable`。
3.  **远程代码执行：** 使用 `/app/rest/debug/processes` 接口执行任意命令。脚本通过修改 `internal.properties` 文件，然后使用特制的请求调用 `debug/processes` 接口，从而在目标系统上执行任意命令。

提供的 `TeamCity.sh` 脚本允许用户指定目标操作系统 (Linux 或 Windows)，并相应地调整命令执行方式。脚本首先获取一个token，然后利用该 token 修改`internal.properties`文件以启用调试模式，最后使用构造好的包含恶意命令的URL来触发RCE。

投毒风险评估：代码中主要逻辑为漏洞利用，并未发现明显的恶意代码。`TeamCity.sh` 中选择目标OS后，Linux环境使用了`base64`编码命令，Windows没有。虽然脚本的行为符合漏洞利用的预期，但是如果攻击者对`base64` 编码方式做了手脚，有可能在Linux执行的时候插入恶意命令。`TeamCity2.sh` 脚本对命令进行URL编码，windows只支持powershell, 可以对powershell添加恶意payload. 因此，存在一定的投毒风险，估计在10%左右。

**项目地址:** [SwiftSecur/teamcity-exploit-cve-2023-42793](https://github.com/SwiftSecur/teamcity-exploit-cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #8

**来源**: [CVE-2023-42793-Zenmovie_CVE-2023-42793.md](../2023/CVE-2023-42793-Zenmovie_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity实例需要开启网络访问，且版本低于2023.05.4。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的远程攻击者绕过身份验证，并在服务器上执行任意代码。根据漏洞库信息，CVSS评分为9.8（严重）。

**利用方式：**

1.  **身份验证绕过：** 攻击者利用未经身份验证的REST API端点`/app/rest/users/id:1/tokens/RPC2`来获取一个有效的Bearer Token。这个Token最初的设计目的是允许用户通过API管理自己的Token。
2.  **修改内部属性：** 使用获取的Token，通过POST请求访问`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`修改内部属性，启用`rest.debug.processes.enable`，此步骤为后续RCE做准备。
3.  **远程代码执行：**  利用被启用的REST API端点`/app/rest/debug/processes?exePath=${COMMAND}`，通过`exePath`参数执行任意命令。该端点在正常情况下只允许经过身份验证的管理员访问，但由于身份验证绕过，未经授权的攻击者可以利用它。

**POC有效性：**

提供的POC代码包含两个脚本：`CVE-2023-42793_admin.sh`和`CVE-2023-42793_rce.sh`。

*   `CVE-2023-42793_admin.sh`脚本利用漏洞创建一个新的管理员用户（Zenmovie/Zenmovie），方便后续访问TeamCity。
*   `CVE-2023-42793_rce.sh`脚本利用漏洞执行指定的命令，并返回命令输出。

从提供的README.md中的截图以及漏洞原理来看，POC代码是有效的，可以成功利用该漏洞。

**投毒风险：**

评估投毒风险，需考虑作者是否有意在代码中添加恶意功能。

1.  **代码混淆/隐藏：** 代码没有进行明显的混淆。虽然使用了`grep`和`awk`提取Token和命令输出，但是属于正常利用。
2.  **恶意依赖：** 代码没有引入外部依赖。
3.  **后门代码：** 代码的主要功能是利用漏洞，创建管理员账户或执行命令。没有发现明显与漏洞利用无关的恶意代码，例如反弹shell、上传文件等。
4.  **隐蔽指令：**  检查代码中是否存在不易察觉的指令，例如通过环境变量、时间等触发的恶意行为。没有发现此类指令。

尽管POC的主要功能是漏洞利用，仍存在一定的投毒风险。例如，攻击者可能修改`CVE-2023-42793_rce.sh`脚本，在执行目标命令之前，先执行一些恶意操作，例如下载并执行恶意程序，添加后门账户等。这种风险很难通过静态分析完全排除，需要进行动态分析，实际运行poc代码进行监控。

因此，综合考虑，投毒风险评估为10%。这个风险主要来源于用户下载和使用POC时，可能会下载到被篡改过的恶意版本。

**结论：**

CVE-2023-42793是一个高危漏洞，利用简单，影响范围广。建议受影响的用户尽快升级到最新版本。在使用公开的POC代码时，务必谨慎，进行代码审计，并确保从可信来源下载。

**项目地址:** [Zenmovie/CVE-2023-42793](https://github.com/Zenmovie/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #9

**来源**: [CVE-2023-42793-becrevex_CVE-2023-42793.md](../2023/CVE-2023-42793-becrevex_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个认证绕过漏洞，攻击者无需认证即可利用此漏洞在TeamCity服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8，属于高危漏洞，并且已被积极利用。多家安全公司和组织（例如Rapid7，Fortinet，Microsoft，CISA）都发布了关于该漏洞的分析和利用报告，甚至有APT组织（APT29，北朝鲜黑客组织）利用该漏洞进行攻击。

提供的POC代码是一个Nmap脚本，用于检测目标TeamCity服务器是否存在CVE-2023-42793漏洞。该脚本通过向`/app/rest/users/id:1/tokens/RPC2`路径发送POST请求，尝试创建一个新的用户令牌，如果服务器返回200状态码且包含一个令牌，则表明服务器存在漏洞。该脚本本身的行为是良性的，只是用于验证漏洞的存在，没有发现任何投毒代码。

**有效性：**
根据提供的漏洞信息和POC代码，该POC代码有效，可以用于检测目标是否存在CVE-2023-42793漏洞。

**投毒风险：**
对提供的Nmap脚本进行了分析，没有发现任何明显的投毒代码。脚本的功能明确，即检测TeamCity服务器上的漏洞，没有发现任何恶意行为。风险评估为0%

**利用方式：**
1.  攻击者利用未授权访问漏洞，绕过身份验证。
2.  攻击者发送特制请求，例如向`/app/rest/users/id:1/tokens/RPC2`路径创建用户Token。
3.  成功创建Token后，攻击者获得管理员权限。
4.  利用管理员权限执行任意代码，实现远程代码执行。

该漏洞利用简单，影响严重，建议TeamCity用户尽快升级到2023.05.4或更高版本。

**项目地址:** [becrevex/CVE-2023-42793](https://github.com/becrevex/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #10

**来源**: [CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md](../2023/CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** JetBrains TeamCity

**危害等级:** 极高，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可从网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity 2023.05.4之前版本中存在的一个身份验证绕过漏洞，可能导致未经身份验证的远程代码执行。根据漏洞库信息，此漏洞的CVSS评分为9.8，属于严重级别。多个搜索结果表明，该漏洞已被积极利用，甚至被APT组织利用进行攻击。提供的POC代码是一个Python脚本，它利用漏洞执行远程命令。

**利用方式：**

1.  **身份验证绕过：** 该漏洞允许攻击者绕过TeamCity服务器的身份验证机制。
2.  **获取Bearer Token：** 利用未经身份验证的访问，通过`/app/rest/users/id:1/tokens/RPC2`端点创建一个临时的Bearer Token。
3.  **启用调试模式：** 使用获得的Bearer Token，通过`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`端点启用调试模式，即`rest.debug.processes.enable=true`。
4.  **远程代码执行：** 使用获得的Bearer Token，通过`/app/rest/debug/processes`端点执行任意命令。POC使用bash反弹shell，通过URL编码将命令传递给目标服务器。

**有效性评估：**

提供的POC代码看起来是有效的。它利用了TeamCity REST API中的漏洞，绕过身份验证并执行任意代码。 脚本首先尝试获取一个临时的Bearer Token，然后使用该Token来修改`internal.properties`文件以启用调试模式。最后，脚本使用调试模式来执行远程代码。 脚本的`README.md`文件中提供的参考链接也支持了该漏洞的存在和可利用性。搜索结果中大量的安全厂商报告和分析也证实了此漏洞的真实性和高危性。

**投毒风险评估：**

分析POC代码没有发现明显的投毒代码。脚本的功能主要集中在利用漏洞进行远程代码执行，没有发现额外的恶意行为或后门。该脚本的功能与漏洞描述以及利用方式相符，未发现任何异常行为。因此，投毒风险评估为0%。

**项目地址:** [hotplugin0x01/CVE-2023-42793](https://github.com/hotplugin0x01/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #11

**来源**: [CVE-2023-42793-jakehomb_cve-2023-42793.md](../2023/CVE-2023-42793-jakehomb_cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器版本低于2023.05.4，且可通过HTTP(S)访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2023-42793 允许未经身份验证的攻击者在 TeamCity 服务器上执行远程代码。该漏洞利用方式是通过绕过身份验证机制，直接访问受保护的资源并执行恶意操作。

**有效性：**
根据提供的漏洞信息、搜索结果以及漏洞利用代码，可以判断该漏洞的 POC 代码有效。CVE 详情中提到存在身份验证绕过导致 RCE，搜索结果也表明该漏洞存在公开可用的exploit，并且已经被APT29等恶意行为者利用。

**投毒风险：**
提供的漏洞利用代码主要由两部分组成：获取 Token 和创建用户。getToken 函数尝试从 /app/rest/users/id:1/token/RPC2 获取一个 Token，createUser 函数使用这个 Token 来创建一个具有管理员权限的用户。代码本身功能明确，没有发现隐藏的恶意代码。因此，评估该仓库中存在作者隐藏的投毒代码的风险为0%。

**利用方式：**
1.  **目标探测：** 确定目标 TeamCity 服务器的版本是否低于 2023.05.4。
2.  **Token 获取：** 使用 `getToken` 函数，通过向 `https://<teamcity_url>/app/rest/users/id:1/token/RPC2` 发送 GET 请求，尝试获取一个 Token。服务器无需授权即可响应。  `extractToken` 函数从响应中提取 Token。
3.  **用户创建：** 使用 `createUser` 函数，携带上一步获取的 Token，向 `https://<teamcity_url>/app/rest/users` 发送 POST 请求，创建一个具有 SYSTEM_ADMIN 角色的新用户。请求的 Body 为包含用户名、密码和邮箱的JSON格式。
4.  **权限提升：** 使用新创建的管理员用户登录 TeamCity 服务器，获得完全控制权限，从而执行任意代码。

**项目地址:** [jakehomb/cve-2023-42793](https://github.com/jakehomb/cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #12

**来源**: [CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md](../2023/CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行远程代码。该漏洞影响2023.05.4之前的版本。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的，并且已被广泛利用。CISA已将其添加到已知被利用漏洞目录中。搜索引擎结果中多个安全厂商的博客也证实了该漏洞的有效性。

**投毒风险：**
提供的PoC代码本身的功能是利用漏洞创建新的管理员用户。`README.md`文件描述了脚本的功能，与代码行为一致。代码中对创建的用户名称添加了随机数，并会写入 `vulnerable.txt` 文件。 `vulnerable.txt`文件可能存在信息泄露的风险,如果被攻击者获取，可能结合其他漏洞使用。总体来看，该PoC代码存在投毒风险的可能性较低，约为10%。

**利用方式：**
1.  **删除用户令牌：** PoC首先尝试删除ID为1的用户令牌 (通常是管理员)。
2.  **创建用户令牌：** 如果删除成功或不存在，PoC会尝试为ID为1的用户创建一个新的用户令牌。
3.  **创建管理员用户：** 使用新创建的用户令牌，PoC会创建一个具有`SYSTEM_ADMIN`权限的新用户，用户名和密码是硬编码的（用户名以 `_secops` 开头，加上随机数，密码是 `changeme`）。
4.  **利用新用户登录：** 攻击者可以使用新创建的管理员帐户登录TeamCity服务器，从而完全控制该服务器。
5.  **自动化攻击:** 通过-u指定url或者-l指定url列表，实现批量攻击。

**项目地址:** [johnossawy/CVE-2023-42793_POC](https://github.com/johnossawy/CVE-2023-42793_POC)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #13

**来源**: [CVE-2023-42793-junnythemarksman_CVE-2023-42793.md](../2023/CVE-2023-42793-junnythemarksman_CVE-2023-42793.md)

# CVE-2023-42793

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md](../2023/CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md)

## CVE-2023-42793 - TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个身份验证绕过漏洞，未经身份验证的攻击者可以通过发送特制的 HTTP 请求绕过身份验证，从而创建管理员账户并最终实现远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果中多个链接都提到了该漏洞被积极利用，包括APT组织。漏洞利用代码提供了创建管理员账户和执行RCE的脚本，并且说明了如何利用该漏洞，包括如何获取反向shell。

**投毒风险：**
分析提供的`exploit.py`和`rce_exploit.py`，主要功能是创建管理员账户和执行任意命令。脚本本身的代码逻辑相对简单，没有明显的恶意代码。其中`exploit.py`会生成随机用户名、密码和邮箱地址，这可能被误认为恶意行为，但这是为了方便利用而设计的，并非投毒。`rce_exploit.py`脚本依赖于第一个脚本创建的token文件。虽然没有发现明显的后门代码，但仍存在极小的风险，例如在生成随机字符串时引入偏差，虽然可能性极小，但理论上存在被利用的可能性，将投毒风险评定为5%。

**利用方式：**
1.  **身份验证绕过：** 攻击者首先利用身份验证绕过漏洞，该漏洞允许未经身份验证的攻击者与TeamCity服务器进行交互，绕过正常的身份验证流程。
2.  **创建管理员账户：** 使用 `exploit.py` 脚本，通过发送特制的 POST 请求，在 TeamCity 服务器上创建一个新的管理员账户。可以指定用户名、密码和邮箱，也可以使用随机生成的凭据。成功创建后，会将凭据保存到token文件中。
3.  **远程代码执行：** 使用 `rce.py` 脚本，该脚本首先启用debug processes，然后利用创建的管理员账户，通过 TeamCity 的 API 接口执行任意命令。可以执行系统命令，例如 `whoami`，也可以获取反向 shell，从而完全控制服务器。
4.  **反向Shell:** 利用rce.py执行命令，通过反弹shell到攻击者机器上，来获取服务器的控制权。


**项目地址:** [B4l3rI0n/CVE-2023-42793](https://github.com/B4l3rI0n/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #2

**来源**: [CVE-2023-42793-FlojBoj_CVE-2023-42793.md](../2023/CVE-2023-42793-FlojBoj_CVE-2023-42793.md)

## CVE-2023-42793-JetBrainsTeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可能导致远程代码执行和完全控制TeamCity服务器

**影响版本:** < 2023.05.4

**利用条件:** 需要能够通过HTTP(S)访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，攻击者无需身份验证即可执行远程代码。漏洞利用方式如下：

1.  **有效性：** 漏洞信息和搜索结果表明该漏洞已在野外被积极利用，包括APT组织（如APT29、CozyBear、北朝鲜黑客组织）和俄罗斯情报部门SVR。提供的代码`exploit.py`旨在利用此漏洞创建管理员账户或获取现有用户的token，从而控制TeamCity服务器。根据README.md的描述，还有一个`rce.py`脚本可以执行远程命令，但主脚本`exploit.py`的功能是创建管理员账户。

2.  **投毒风险：** 代码`exploit.py`本身的功能是利用漏洞创建管理员用户或获取token。投毒风险评估如下：
    *   代码中存在一些硬编码，例如默认密码"Password@123"和默认邮箱域名"@lol.omg"，如果直接使用这些默认值，容易被检测和防御。但这不属于投毒，而是简化使用的示例。
    *   代码尝试首先获取或删除现有的token，这增加了攻击成功的概率，但也可能在目标环境中留下痕迹。
    *   总体来看，`exploit.py`的主要风险在于被滥用以非法控制TeamCity服务器，而非恶意代码本身。因此，投毒风险较低，估计为10%。主要是担心引入了额外的请求或命令，用于收集用户信息或执行其他未经授权的操作。

3.  **利用方式：** 利用方式主要分为以下步骤：
    a.  攻击者发送特制的HTTP请求到TeamCity服务器，绕过身份验证。
    b.  使用`exploit.py`脚本，指定目标TeamCity服务器的URL。
    c.  脚本尝试获取或删除现有的token，然后创建一个新的管理员用户，或者获取指定用户的token。
    d.  如果成功创建管理员用户，攻击者可以使用新创建的管理员账户登录TeamCity服务器，并获得完全控制权限。
    e. 通过获取到的token, 攻击者可以模拟用户身份，从而执行相关操作。

该漏洞的严重性在于未经身份验证即可创建管理员帐户并执行任意代码，从而完全控制受影响的TeamCity服务器。缓解措施包括尽快升级到2023.05.4或更高版本。

**项目地址:** [FlojBoj/CVE-2023-42793](https://github.com/FlojBoj/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #3

**来源**: [CVE-2023-42793-H454NSec_CVE-2023-42793.md](../2023/CVE-2023-42793-H454NSec_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从攻击者控制的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 漏洞存在于JetBrains TeamCity 2023.05.4 之前的版本中，允许未经身份验证的攻击者绕过身份验证，最终实现远程代码执行。根据漏洞库信息，该漏洞的 CVSS 3.1 评分为 9.8，属于严重级别。搜索结果表明，该漏洞已被广泛利用，甚至被 APT 组织用于攻击活动。 

**漏洞利用方式：**

1.  **身份验证绕过：** 漏洞利用代码通过发送特制的 HTTP 请求来绕过 TeamCity 的身份验证机制。具体利用细节需要分析补丁或者参考其他分析报告。
2.  **创建管理员用户：** 漏洞利用代码首先删除 id 为 1 的用户的token，然后创建一个新的用户 token。使用这个 token，攻击者可以创建一个具有管理员权限的新用户。新用户的用户名和密码可以通过命令行参数指定，默认用户名为 `H454NSec[随机数]`，密码为 `@H454NSec`。利用成功后，即可使用创建的管理员用户登录TeamCity控制台。
3.  **远程代码执行：** 通过管理员权限，攻击者可以在 TeamCity 服务器上执行任意代码，实现远程控制。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确定该 POC 代码是有效的。漏洞已被公开披露且有可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。风险分析如下：

*   **代码结构：** 代码结构相对清晰，主要功能是利用漏洞创建管理员用户。
*   **可疑行为：** 代码中存在以下潜在风险：
    *   **默认用户名和密码：** 使用默认的用户名和密码 `@H454NSec` 创建管理员帐户，这可能会让其他攻击者更容易入侵，或者导致安全审计告警。
    *   **硬编码的 User-Agent：**  User-Agent头 `Mozilla/5.0 (https://github.com/H454NSec/CVE-2023-42793) Gecko/20100101 Firefox/113.0`  可能被用于追踪攻击源。但同时也降低了攻击的隐蔽性。
    *   **未处理异常：** 虽然代码有异常处理，但仅仅是简单的`pass`，可能会隐藏一些错误信息，增加调试难度。
*   **高危操作：**  漏洞利用本身就是高危操作，如果攻击者通过修改poc加入恶意命令，将会造成严重危害，例如植入后门。

综合考虑以上因素，该 POC 代码的投毒风险评估为 10%。主要风险在于攻击者可能利用该代码进行二次修改，加入恶意代码或后门，从而扩大攻击范围。

**项目地址:** [H454NSec/CVE-2023-42793](https://github.com/H454NSec/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #4

**来源**: [CVE-2023-42793-HusenjanDev_CVE-2023-42793.md](../2023/CVE-2023-42793-HusenjanDev_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从网络访问，需要通过其他途径获取TeamCity Token。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，允许未经身份验证的攻击者通过HTTP(S)访问TeamCity服务器，并执行远程代码。根据漏洞库信息，CVSS评分为9.8，属于严重级别。搜索引擎结果显示，该漏洞已被多个APT组织利用，包括APT29、北朝鲜的Diamond Sleet和Onyx Sleet以及俄罗斯对外情报局 (SVR)，显示其真实性和危害性。Rapid7的博客文章也详细分析了该漏洞。提供的POC代码的利用方式是：

1.  **获取TeamCity Token:**  `readme.md` 中提到，需要通过其他漏洞或者方式获取TeamCity的Token. 这是利用此POC的前提。
2.  **启用调试模式:** 使用curl命令发送POST请求到`/admin/dataDir.html`，修改`config/internal.properties`文件，启用`rest.debug.processes.enable=true`，从而开启调试模式。这一步通过token进行验证。
3.  **构造反弹shell Payload:**  将反弹shell命令进行URL编码，目标是让受害者主机连接攻击者的Netcat监听器。
4.  **执行远程命令:** 使用curl命令发送POST请求到`/app/rest/debug/processes`，指定`exePath`为`/bin/bash`，`params`为`-c`和URL编码后的反弹shell命令。这个请求同样需要token验证。漏洞利用依赖于已获取的TeamCity token，然后通过启用调试模式执行反弹shell。根据分析，该POC代码没有明显的投毒行为。

**项目地址:** [HusenjanDev/CVE-2023-42793](https://github.com/HusenjanDev/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #5

**来源**: [CVE-2023-42793-LeHeron_TC_test.md](../2023/CVE-2023-42793-LeHeron_TC_test.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个严重的身份验证绕过漏洞，攻击者无需身份验证即可在 TeamCity 服务器上执行远程代码。根据漏洞信息和搜索结果，该漏洞已被积极利用，甚至APT组织，如CozyBear，以及北朝鲜的APT组织都在利用该漏洞。 

**有效性：**
根据搜索结果，此漏洞已经存在公开的利用代码，且已被广泛利用，证明漏洞有效。

**投毒风险：**
提供的漏洞利用代码 `/tmp/da0475f0898b55e5196bf0f36ac9d45e/README`  只是一个简单的README文件，内容为 “Hello World”，不包含任何可执行代码或恶意指令。投毒的可能性极低，可以认为几乎不存在，给到1%的可能也只是对未知风险的保留。

**利用方式：**
根据漏洞描述，攻击者可以通过未授权访问TeamCity服务器，从而执行任意代码。具体的利用方式可能涉及到构造特定的HTTP请求绕过身份验证机制，然后利用TeamCity服务器的功能执行恶意命令。参考Rapid7的博客文章，该漏洞利用可能与特定的端点和参数有关，允许攻击者创建管理员用户或直接执行代码。 从搜索结果来看，该漏洞已经成为恶意行为者的攻击目标，建议尽快升级到安全版本。

**项目地址:** [LeHeron/TC_test](https://github.com/LeHeron/TC_test)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #6

**来源**: [CVE-2023-42793-StanleyJobsonAU_GhostTown.md](../2023/CVE-2023-42793-StanleyJobsonAU_GhostTown.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个身份验证绕过漏洞，允许未经身份验证的攻击者远程执行代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8（严重），并且已被积极利用。搜索结果表明，包括APT29、朝鲜黑客组织以及俄罗斯对外情报局（SVR）等多个威胁组织都在利用此漏洞。提供的POC代码 `GhostTown.py` 旨在利用此漏洞。利用方式如下：

1.  **生成管理员Token：** POC首先尝试通过 `/app/rest/users/id:1/tokens/RPC2` 接口创建一个管理员Token。这将绕过身份验证。
2.  **检索内部配置：** 使用生成的管理员Token，POC尝试从 `/get/file/dataDir/config/internal.properties` 接口检索TeamCity的内部配置。
3.  **更新配置：** POC会检查配置项中是否包含 `rest.debug.processes.enable=true`，如果不存在，则将其添加到配置项中，并通过 `/get/file/dataDir/config/internal.properties` 接口更新配置。`rest.debug.processes.enable=true` 配置的目的是允许执行调试进程，这为远程代码执行铺平了道路。(这部分未在提供的代码片段中。)
4. **远程代码执行：** 启用调试进程允许攻击者通过构造特定的请求来执行任意命令。

**有效性：** 根据漏洞信息和搜索结果，此POC代码有效，能够利用CVE-2023-42793漏洞实现RCE。

**投毒风险：** 检查提供的代码，主要逻辑集中在利用漏洞上，没有发现明显的恶意代码或后门。该代码是为了验证漏洞存在，并帮助安全研究人员和管理员修复漏洞，存在投毒代码的可能性较低。


**项目地址:** [StanleyJobsonAU/GhostTown](https://github.com/StanleyJobsonAU/GhostTown)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #7

**来源**: [CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md](../2023/CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器，且目标版本低于2023.05.4

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 存在于 JetBrains TeamCity 2023.05.4 之前的版本中，是一个身份验证绕过漏洞，可以导致未经身份验证的远程代码执行。攻击者可以利用此漏洞在 TeamCity 服务器上执行任意代码，从而完全控制服务器。漏洞利用方式如下：

1.  **身份验证绕过：** 利用漏洞绕过身份验证。
2.  **启用调试模式：** 通过修改 `internal.properties` 文件启用 `rest.debug.processes.enable`。
3.  **远程代码执行：** 使用 `/app/rest/debug/processes` 接口执行任意命令。脚本通过修改 `internal.properties` 文件，然后使用特制的请求调用 `debug/processes` 接口，从而在目标系统上执行任意命令。

提供的 `TeamCity.sh` 脚本允许用户指定目标操作系统 (Linux 或 Windows)，并相应地调整命令执行方式。脚本首先获取一个token，然后利用该 token 修改`internal.properties`文件以启用调试模式，最后使用构造好的包含恶意命令的URL来触发RCE。

投毒风险评估：代码中主要逻辑为漏洞利用，并未发现明显的恶意代码。`TeamCity.sh` 中选择目标OS后，Linux环境使用了`base64`编码命令，Windows没有。虽然脚本的行为符合漏洞利用的预期，但是如果攻击者对`base64` 编码方式做了手脚，有可能在Linux执行的时候插入恶意命令。`TeamCity2.sh` 脚本对命令进行URL编码，windows只支持powershell, 可以对powershell添加恶意payload. 因此，存在一定的投毒风险，估计在10%左右。

**项目地址:** [SwiftSecur/teamcity-exploit-cve-2023-42793](https://github.com/SwiftSecur/teamcity-exploit-cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #8

**来源**: [CVE-2023-42793-Zenmovie_CVE-2023-42793.md](../2023/CVE-2023-42793-Zenmovie_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity实例需要开启网络访问，且版本低于2023.05.4。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的远程攻击者绕过身份验证，并在服务器上执行任意代码。根据漏洞库信息，CVSS评分为9.8（严重）。

**利用方式：**

1.  **身份验证绕过：** 攻击者利用未经身份验证的REST API端点`/app/rest/users/id:1/tokens/RPC2`来获取一个有效的Bearer Token。这个Token最初的设计目的是允许用户通过API管理自己的Token。
2.  **修改内部属性：** 使用获取的Token，通过POST请求访问`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`修改内部属性，启用`rest.debug.processes.enable`，此步骤为后续RCE做准备。
3.  **远程代码执行：**  利用被启用的REST API端点`/app/rest/debug/processes?exePath=${COMMAND}`，通过`exePath`参数执行任意命令。该端点在正常情况下只允许经过身份验证的管理员访问，但由于身份验证绕过，未经授权的攻击者可以利用它。

**POC有效性：**

提供的POC代码包含两个脚本：`CVE-2023-42793_admin.sh`和`CVE-2023-42793_rce.sh`。

*   `CVE-2023-42793_admin.sh`脚本利用漏洞创建一个新的管理员用户（Zenmovie/Zenmovie），方便后续访问TeamCity。
*   `CVE-2023-42793_rce.sh`脚本利用漏洞执行指定的命令，并返回命令输出。

从提供的README.md中的截图以及漏洞原理来看，POC代码是有效的，可以成功利用该漏洞。

**投毒风险：**

评估投毒风险，需考虑作者是否有意在代码中添加恶意功能。

1.  **代码混淆/隐藏：** 代码没有进行明显的混淆。虽然使用了`grep`和`awk`提取Token和命令输出，但是属于正常利用。
2.  **恶意依赖：** 代码没有引入外部依赖。
3.  **后门代码：** 代码的主要功能是利用漏洞，创建管理员账户或执行命令。没有发现明显与漏洞利用无关的恶意代码，例如反弹shell、上传文件等。
4.  **隐蔽指令：**  检查代码中是否存在不易察觉的指令，例如通过环境变量、时间等触发的恶意行为。没有发现此类指令。

尽管POC的主要功能是漏洞利用，仍存在一定的投毒风险。例如，攻击者可能修改`CVE-2023-42793_rce.sh`脚本，在执行目标命令之前，先执行一些恶意操作，例如下载并执行恶意程序，添加后门账户等。这种风险很难通过静态分析完全排除，需要进行动态分析，实际运行poc代码进行监控。

因此，综合考虑，投毒风险评估为10%。这个风险主要来源于用户下载和使用POC时，可能会下载到被篡改过的恶意版本。

**结论：**

CVE-2023-42793是一个高危漏洞，利用简单，影响范围广。建议受影响的用户尽快升级到最新版本。在使用公开的POC代码时，务必谨慎，进行代码审计，并确保从可信来源下载。

**项目地址:** [Zenmovie/CVE-2023-42793](https://github.com/Zenmovie/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #9

**来源**: [CVE-2023-42793-becrevex_CVE-2023-42793.md](../2023/CVE-2023-42793-becrevex_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个认证绕过漏洞，攻击者无需认证即可利用此漏洞在TeamCity服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8，属于高危漏洞，并且已被积极利用。多家安全公司和组织（例如Rapid7，Fortinet，Microsoft，CISA）都发布了关于该漏洞的分析和利用报告，甚至有APT组织（APT29，北朝鲜黑客组织）利用该漏洞进行攻击。

提供的POC代码是一个Nmap脚本，用于检测目标TeamCity服务器是否存在CVE-2023-42793漏洞。该脚本通过向`/app/rest/users/id:1/tokens/RPC2`路径发送POST请求，尝试创建一个新的用户令牌，如果服务器返回200状态码且包含一个令牌，则表明服务器存在漏洞。该脚本本身的行为是良性的，只是用于验证漏洞的存在，没有发现任何投毒代码。

**有效性：**
根据提供的漏洞信息和POC代码，该POC代码有效，可以用于检测目标是否存在CVE-2023-42793漏洞。

**投毒风险：**
对提供的Nmap脚本进行了分析，没有发现任何明显的投毒代码。脚本的功能明确，即检测TeamCity服务器上的漏洞，没有发现任何恶意行为。风险评估为0%

**利用方式：**
1.  攻击者利用未授权访问漏洞，绕过身份验证。
2.  攻击者发送特制请求，例如向`/app/rest/users/id:1/tokens/RPC2`路径创建用户Token。
3.  成功创建Token后，攻击者获得管理员权限。
4.  利用管理员权限执行任意代码，实现远程代码执行。

该漏洞利用简单，影响严重，建议TeamCity用户尽快升级到2023.05.4或更高版本。

**项目地址:** [becrevex/CVE-2023-42793](https://github.com/becrevex/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #10

**来源**: [CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md](../2023/CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** JetBrains TeamCity

**危害等级:** 极高，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可从网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity 2023.05.4之前版本中存在的一个身份验证绕过漏洞，可能导致未经身份验证的远程代码执行。根据漏洞库信息，此漏洞的CVSS评分为9.8，属于严重级别。多个搜索结果表明，该漏洞已被积极利用，甚至被APT组织利用进行攻击。提供的POC代码是一个Python脚本，它利用漏洞执行远程命令。

**利用方式：**

1.  **身份验证绕过：** 该漏洞允许攻击者绕过TeamCity服务器的身份验证机制。
2.  **获取Bearer Token：** 利用未经身份验证的访问，通过`/app/rest/users/id:1/tokens/RPC2`端点创建一个临时的Bearer Token。
3.  **启用调试模式：** 使用获得的Bearer Token，通过`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`端点启用调试模式，即`rest.debug.processes.enable=true`。
4.  **远程代码执行：** 使用获得的Bearer Token，通过`/app/rest/debug/processes`端点执行任意命令。POC使用bash反弹shell，通过URL编码将命令传递给目标服务器。

**有效性评估：**

提供的POC代码看起来是有效的。它利用了TeamCity REST API中的漏洞，绕过身份验证并执行任意代码。 脚本首先尝试获取一个临时的Bearer Token，然后使用该Token来修改`internal.properties`文件以启用调试模式。最后，脚本使用调试模式来执行远程代码。 脚本的`README.md`文件中提供的参考链接也支持了该漏洞的存在和可利用性。搜索结果中大量的安全厂商报告和分析也证实了此漏洞的真实性和高危性。

**投毒风险评估：**

分析POC代码没有发现明显的投毒代码。脚本的功能主要集中在利用漏洞进行远程代码执行，没有发现额外的恶意行为或后门。该脚本的功能与漏洞描述以及利用方式相符，未发现任何异常行为。因此，投毒风险评估为0%。

**项目地址:** [hotplugin0x01/CVE-2023-42793](https://github.com/hotplugin0x01/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #11

**来源**: [CVE-2023-42793-jakehomb_cve-2023-42793.md](../2023/CVE-2023-42793-jakehomb_cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器版本低于2023.05.4，且可通过HTTP(S)访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2023-42793 允许未经身份验证的攻击者在 TeamCity 服务器上执行远程代码。该漏洞利用方式是通过绕过身份验证机制，直接访问受保护的资源并执行恶意操作。

**有效性：**
根据提供的漏洞信息、搜索结果以及漏洞利用代码，可以判断该漏洞的 POC 代码有效。CVE 详情中提到存在身份验证绕过导致 RCE，搜索结果也表明该漏洞存在公开可用的exploit，并且已经被APT29等恶意行为者利用。

**投毒风险：**
提供的漏洞利用代码主要由两部分组成：获取 Token 和创建用户。getToken 函数尝试从 /app/rest/users/id:1/token/RPC2 获取一个 Token，createUser 函数使用这个 Token 来创建一个具有管理员权限的用户。代码本身功能明确，没有发现隐藏的恶意代码。因此，评估该仓库中存在作者隐藏的投毒代码的风险为0%。

**利用方式：**
1.  **目标探测：** 确定目标 TeamCity 服务器的版本是否低于 2023.05.4。
2.  **Token 获取：** 使用 `getToken` 函数，通过向 `https://<teamcity_url>/app/rest/users/id:1/token/RPC2` 发送 GET 请求，尝试获取一个 Token。服务器无需授权即可响应。  `extractToken` 函数从响应中提取 Token。
3.  **用户创建：** 使用 `createUser` 函数，携带上一步获取的 Token，向 `https://<teamcity_url>/app/rest/users` 发送 POST 请求，创建一个具有 SYSTEM_ADMIN 角色的新用户。请求的 Body 为包含用户名、密码和邮箱的JSON格式。
4.  **权限提升：** 使用新创建的管理员用户登录 TeamCity 服务器，获得完全控制权限，从而执行任意代码。

**项目地址:** [jakehomb/cve-2023-42793](https://github.com/jakehomb/cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #12

**来源**: [CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md](../2023/CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行远程代码。该漏洞影响2023.05.4之前的版本。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的，并且已被广泛利用。CISA已将其添加到已知被利用漏洞目录中。搜索引擎结果中多个安全厂商的博客也证实了该漏洞的有效性。

**投毒风险：**
提供的PoC代码本身的功能是利用漏洞创建新的管理员用户。`README.md`文件描述了脚本的功能，与代码行为一致。代码中对创建的用户名称添加了随机数，并会写入 `vulnerable.txt` 文件。 `vulnerable.txt`文件可能存在信息泄露的风险,如果被攻击者获取，可能结合其他漏洞使用。总体来看，该PoC代码存在投毒风险的可能性较低，约为10%。

**利用方式：**
1.  **删除用户令牌：** PoC首先尝试删除ID为1的用户令牌 (通常是管理员)。
2.  **创建用户令牌：** 如果删除成功或不存在，PoC会尝试为ID为1的用户创建一个新的用户令牌。
3.  **创建管理员用户：** 使用新创建的用户令牌，PoC会创建一个具有`SYSTEM_ADMIN`权限的新用户，用户名和密码是硬编码的（用户名以 `_secops` 开头，加上随机数，密码是 `changeme`）。
4.  **利用新用户登录：** 攻击者可以使用新创建的管理员帐户登录TeamCity服务器，从而完全控制该服务器。
5.  **自动化攻击:** 通过-u指定url或者-l指定url列表，实现批量攻击。

**项目地址:** [johnossawy/CVE-2023-42793_POC](https://github.com/johnossawy/CVE-2023-42793_POC)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #13

**来源**: [CVE-2023-42793-junnythemarksman_CVE-2023-42793.md](../2023/CVE-2023-42793-junnythemarksman_CVE-2023-42793.md)

# CVE-2023-42793

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md](../2023/CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md)

## CVE-2023-42793 - TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个身份验证绕过漏洞，未经身份验证的攻击者可以通过发送特制的 HTTP 请求绕过身份验证，从而创建管理员账户并最终实现远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果中多个链接都提到了该漏洞被积极利用，包括APT组织。漏洞利用代码提供了创建管理员账户和执行RCE的脚本，并且说明了如何利用该漏洞，包括如何获取反向shell。

**投毒风险：**
分析提供的`exploit.py`和`rce_exploit.py`，主要功能是创建管理员账户和执行任意命令。脚本本身的代码逻辑相对简单，没有明显的恶意代码。其中`exploit.py`会生成随机用户名、密码和邮箱地址，这可能被误认为恶意行为，但这是为了方便利用而设计的，并非投毒。`rce_exploit.py`脚本依赖于第一个脚本创建的token文件。虽然没有发现明显的后门代码，但仍存在极小的风险，例如在生成随机字符串时引入偏差，虽然可能性极小，但理论上存在被利用的可能性，将投毒风险评定为5%。

**利用方式：**
1.  **身份验证绕过：** 攻击者首先利用身份验证绕过漏洞，该漏洞允许未经身份验证的攻击者与TeamCity服务器进行交互，绕过正常的身份验证流程。
2.  **创建管理员账户：** 使用 `exploit.py` 脚本，通过发送特制的 POST 请求，在 TeamCity 服务器上创建一个新的管理员账户。可以指定用户名、密码和邮箱，也可以使用随机生成的凭据。成功创建后，会将凭据保存到token文件中。
3.  **远程代码执行：** 使用 `rce.py` 脚本，该脚本首先启用debug processes，然后利用创建的管理员账户，通过 TeamCity 的 API 接口执行任意命令。可以执行系统命令，例如 `whoami`，也可以获取反向 shell，从而完全控制服务器。
4.  **反向Shell:** 利用rce.py执行命令，通过反弹shell到攻击者机器上，来获取服务器的控制权。


**项目地址:** [B4l3rI0n/CVE-2023-42793](https://github.com/B4l3rI0n/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #2

**来源**: [CVE-2023-42793-FlojBoj_CVE-2023-42793.md](../2023/CVE-2023-42793-FlojBoj_CVE-2023-42793.md)

## CVE-2023-42793-JetBrainsTeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可能导致远程代码执行和完全控制TeamCity服务器

**影响版本:** < 2023.05.4

**利用条件:** 需要能够通过HTTP(S)访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，攻击者无需身份验证即可执行远程代码。漏洞利用方式如下：

1.  **有效性：** 漏洞信息和搜索结果表明该漏洞已在野外被积极利用，包括APT组织（如APT29、CozyBear、北朝鲜黑客组织）和俄罗斯情报部门SVR。提供的代码`exploit.py`旨在利用此漏洞创建管理员账户或获取现有用户的token，从而控制TeamCity服务器。根据README.md的描述，还有一个`rce.py`脚本可以执行远程命令，但主脚本`exploit.py`的功能是创建管理员账户。

2.  **投毒风险：** 代码`exploit.py`本身的功能是利用漏洞创建管理员用户或获取token。投毒风险评估如下：
    *   代码中存在一些硬编码，例如默认密码"Password@123"和默认邮箱域名"@lol.omg"，如果直接使用这些默认值，容易被检测和防御。但这不属于投毒，而是简化使用的示例。
    *   代码尝试首先获取或删除现有的token，这增加了攻击成功的概率，但也可能在目标环境中留下痕迹。
    *   总体来看，`exploit.py`的主要风险在于被滥用以非法控制TeamCity服务器，而非恶意代码本身。因此，投毒风险较低，估计为10%。主要是担心引入了额外的请求或命令，用于收集用户信息或执行其他未经授权的操作。

3.  **利用方式：** 利用方式主要分为以下步骤：
    a.  攻击者发送特制的HTTP请求到TeamCity服务器，绕过身份验证。
    b.  使用`exploit.py`脚本，指定目标TeamCity服务器的URL。
    c.  脚本尝试获取或删除现有的token，然后创建一个新的管理员用户，或者获取指定用户的token。
    d.  如果成功创建管理员用户，攻击者可以使用新创建的管理员账户登录TeamCity服务器，并获得完全控制权限。
    e. 通过获取到的token, 攻击者可以模拟用户身份，从而执行相关操作。

该漏洞的严重性在于未经身份验证即可创建管理员帐户并执行任意代码，从而完全控制受影响的TeamCity服务器。缓解措施包括尽快升级到2023.05.4或更高版本。

**项目地址:** [FlojBoj/CVE-2023-42793](https://github.com/FlojBoj/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #3

**来源**: [CVE-2023-42793-H454NSec_CVE-2023-42793.md](../2023/CVE-2023-42793-H454NSec_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从攻击者控制的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 漏洞存在于JetBrains TeamCity 2023.05.4 之前的版本中，允许未经身份验证的攻击者绕过身份验证，最终实现远程代码执行。根据漏洞库信息，该漏洞的 CVSS 3.1 评分为 9.8，属于严重级别。搜索结果表明，该漏洞已被广泛利用，甚至被 APT 组织用于攻击活动。 

**漏洞利用方式：**

1.  **身份验证绕过：** 漏洞利用代码通过发送特制的 HTTP 请求来绕过 TeamCity 的身份验证机制。具体利用细节需要分析补丁或者参考其他分析报告。
2.  **创建管理员用户：** 漏洞利用代码首先删除 id 为 1 的用户的token，然后创建一个新的用户 token。使用这个 token，攻击者可以创建一个具有管理员权限的新用户。新用户的用户名和密码可以通过命令行参数指定，默认用户名为 `H454NSec[随机数]`，密码为 `@H454NSec`。利用成功后，即可使用创建的管理员用户登录TeamCity控制台。
3.  **远程代码执行：** 通过管理员权限，攻击者可以在 TeamCity 服务器上执行任意代码，实现远程控制。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确定该 POC 代码是有效的。漏洞已被公开披露且有可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。风险分析如下：

*   **代码结构：** 代码结构相对清晰，主要功能是利用漏洞创建管理员用户。
*   **可疑行为：** 代码中存在以下潜在风险：
    *   **默认用户名和密码：** 使用默认的用户名和密码 `@H454NSec` 创建管理员帐户，这可能会让其他攻击者更容易入侵，或者导致安全审计告警。
    *   **硬编码的 User-Agent：**  User-Agent头 `Mozilla/5.0 (https://github.com/H454NSec/CVE-2023-42793) Gecko/20100101 Firefox/113.0`  可能被用于追踪攻击源。但同时也降低了攻击的隐蔽性。
    *   **未处理异常：** 虽然代码有异常处理，但仅仅是简单的`pass`，可能会隐藏一些错误信息，增加调试难度。
*   **高危操作：**  漏洞利用本身就是高危操作，如果攻击者通过修改poc加入恶意命令，将会造成严重危害，例如植入后门。

综合考虑以上因素，该 POC 代码的投毒风险评估为 10%。主要风险在于攻击者可能利用该代码进行二次修改，加入恶意代码或后门，从而扩大攻击范围。

**项目地址:** [H454NSec/CVE-2023-42793](https://github.com/H454NSec/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #4

**来源**: [CVE-2023-42793-HusenjanDev_CVE-2023-42793.md](../2023/CVE-2023-42793-HusenjanDev_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从网络访问，需要通过其他途径获取TeamCity Token。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，允许未经身份验证的攻击者通过HTTP(S)访问TeamCity服务器，并执行远程代码。根据漏洞库信息，CVSS评分为9.8，属于严重级别。搜索引擎结果显示，该漏洞已被多个APT组织利用，包括APT29、北朝鲜的Diamond Sleet和Onyx Sleet以及俄罗斯对外情报局 (SVR)，显示其真实性和危害性。Rapid7的博客文章也详细分析了该漏洞。提供的POC代码的利用方式是：

1.  **获取TeamCity Token:**  `readme.md` 中提到，需要通过其他漏洞或者方式获取TeamCity的Token. 这是利用此POC的前提。
2.  **启用调试模式:** 使用curl命令发送POST请求到`/admin/dataDir.html`，修改`config/internal.properties`文件，启用`rest.debug.processes.enable=true`，从而开启调试模式。这一步通过token进行验证。
3.  **构造反弹shell Payload:**  将反弹shell命令进行URL编码，目标是让受害者主机连接攻击者的Netcat监听器。
4.  **执行远程命令:** 使用curl命令发送POST请求到`/app/rest/debug/processes`，指定`exePath`为`/bin/bash`，`params`为`-c`和URL编码后的反弹shell命令。这个请求同样需要token验证。漏洞利用依赖于已获取的TeamCity token，然后通过启用调试模式执行反弹shell。根据分析，该POC代码没有明显的投毒行为。

**项目地址:** [HusenjanDev/CVE-2023-42793](https://github.com/HusenjanDev/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #5

**来源**: [CVE-2023-42793-LeHeron_TC_test.md](../2023/CVE-2023-42793-LeHeron_TC_test.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个严重的身份验证绕过漏洞，攻击者无需身份验证即可在 TeamCity 服务器上执行远程代码。根据漏洞信息和搜索结果，该漏洞已被积极利用，甚至APT组织，如CozyBear，以及北朝鲜的APT组织都在利用该漏洞。 

**有效性：**
根据搜索结果，此漏洞已经存在公开的利用代码，且已被广泛利用，证明漏洞有效。

**投毒风险：**
提供的漏洞利用代码 `/tmp/da0475f0898b55e5196bf0f36ac9d45e/README`  只是一个简单的README文件，内容为 “Hello World”，不包含任何可执行代码或恶意指令。投毒的可能性极低，可以认为几乎不存在，给到1%的可能也只是对未知风险的保留。

**利用方式：**
根据漏洞描述，攻击者可以通过未授权访问TeamCity服务器，从而执行任意代码。具体的利用方式可能涉及到构造特定的HTTP请求绕过身份验证机制，然后利用TeamCity服务器的功能执行恶意命令。参考Rapid7的博客文章，该漏洞利用可能与特定的端点和参数有关，允许攻击者创建管理员用户或直接执行代码。 从搜索结果来看，该漏洞已经成为恶意行为者的攻击目标，建议尽快升级到安全版本。

**项目地址:** [LeHeron/TC_test](https://github.com/LeHeron/TC_test)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #6

**来源**: [CVE-2023-42793-StanleyJobsonAU_GhostTown.md](../2023/CVE-2023-42793-StanleyJobsonAU_GhostTown.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个身份验证绕过漏洞，允许未经身份验证的攻击者远程执行代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8（严重），并且已被积极利用。搜索结果表明，包括APT29、朝鲜黑客组织以及俄罗斯对外情报局（SVR）等多个威胁组织都在利用此漏洞。提供的POC代码 `GhostTown.py` 旨在利用此漏洞。利用方式如下：

1.  **生成管理员Token：** POC首先尝试通过 `/app/rest/users/id:1/tokens/RPC2` 接口创建一个管理员Token。这将绕过身份验证。
2.  **检索内部配置：** 使用生成的管理员Token，POC尝试从 `/get/file/dataDir/config/internal.properties` 接口检索TeamCity的内部配置。
3.  **更新配置：** POC会检查配置项中是否包含 `rest.debug.processes.enable=true`，如果不存在，则将其添加到配置项中，并通过 `/get/file/dataDir/config/internal.properties` 接口更新配置。`rest.debug.processes.enable=true` 配置的目的是允许执行调试进程，这为远程代码执行铺平了道路。(这部分未在提供的代码片段中。)
4. **远程代码执行：** 启用调试进程允许攻击者通过构造特定的请求来执行任意命令。

**有效性：** 根据漏洞信息和搜索结果，此POC代码有效，能够利用CVE-2023-42793漏洞实现RCE。

**投毒风险：** 检查提供的代码，主要逻辑集中在利用漏洞上，没有发现明显的恶意代码或后门。该代码是为了验证漏洞存在，并帮助安全研究人员和管理员修复漏洞，存在投毒代码的可能性较低。


**项目地址:** [StanleyJobsonAU/GhostTown](https://github.com/StanleyJobsonAU/GhostTown)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #7

**来源**: [CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md](../2023/CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器，且目标版本低于2023.05.4

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 存在于 JetBrains TeamCity 2023.05.4 之前的版本中，是一个身份验证绕过漏洞，可以导致未经身份验证的远程代码执行。攻击者可以利用此漏洞在 TeamCity 服务器上执行任意代码，从而完全控制服务器。漏洞利用方式如下：

1.  **身份验证绕过：** 利用漏洞绕过身份验证。
2.  **启用调试模式：** 通过修改 `internal.properties` 文件启用 `rest.debug.processes.enable`。
3.  **远程代码执行：** 使用 `/app/rest/debug/processes` 接口执行任意命令。脚本通过修改 `internal.properties` 文件，然后使用特制的请求调用 `debug/processes` 接口，从而在目标系统上执行任意命令。

提供的 `TeamCity.sh` 脚本允许用户指定目标操作系统 (Linux 或 Windows)，并相应地调整命令执行方式。脚本首先获取一个token，然后利用该 token 修改`internal.properties`文件以启用调试模式，最后使用构造好的包含恶意命令的URL来触发RCE。

投毒风险评估：代码中主要逻辑为漏洞利用，并未发现明显的恶意代码。`TeamCity.sh` 中选择目标OS后，Linux环境使用了`base64`编码命令，Windows没有。虽然脚本的行为符合漏洞利用的预期，但是如果攻击者对`base64` 编码方式做了手脚，有可能在Linux执行的时候插入恶意命令。`TeamCity2.sh` 脚本对命令进行URL编码，windows只支持powershell, 可以对powershell添加恶意payload. 因此，存在一定的投毒风险，估计在10%左右。

**项目地址:** [SwiftSecur/teamcity-exploit-cve-2023-42793](https://github.com/SwiftSecur/teamcity-exploit-cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #8

**来源**: [CVE-2023-42793-Zenmovie_CVE-2023-42793.md](../2023/CVE-2023-42793-Zenmovie_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity实例需要开启网络访问，且版本低于2023.05.4。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的远程攻击者绕过身份验证，并在服务器上执行任意代码。根据漏洞库信息，CVSS评分为9.8（严重）。

**利用方式：**

1.  **身份验证绕过：** 攻击者利用未经身份验证的REST API端点`/app/rest/users/id:1/tokens/RPC2`来获取一个有效的Bearer Token。这个Token最初的设计目的是允许用户通过API管理自己的Token。
2.  **修改内部属性：** 使用获取的Token，通过POST请求访问`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`修改内部属性，启用`rest.debug.processes.enable`，此步骤为后续RCE做准备。
3.  **远程代码执行：**  利用被启用的REST API端点`/app/rest/debug/processes?exePath=${COMMAND}`，通过`exePath`参数执行任意命令。该端点在正常情况下只允许经过身份验证的管理员访问，但由于身份验证绕过，未经授权的攻击者可以利用它。

**POC有效性：**

提供的POC代码包含两个脚本：`CVE-2023-42793_admin.sh`和`CVE-2023-42793_rce.sh`。

*   `CVE-2023-42793_admin.sh`脚本利用漏洞创建一个新的管理员用户（Zenmovie/Zenmovie），方便后续访问TeamCity。
*   `CVE-2023-42793_rce.sh`脚本利用漏洞执行指定的命令，并返回命令输出。

从提供的README.md中的截图以及漏洞原理来看，POC代码是有效的，可以成功利用该漏洞。

**投毒风险：**

评估投毒风险，需考虑作者是否有意在代码中添加恶意功能。

1.  **代码混淆/隐藏：** 代码没有进行明显的混淆。虽然使用了`grep`和`awk`提取Token和命令输出，但是属于正常利用。
2.  **恶意依赖：** 代码没有引入外部依赖。
3.  **后门代码：** 代码的主要功能是利用漏洞，创建管理员账户或执行命令。没有发现明显与漏洞利用无关的恶意代码，例如反弹shell、上传文件等。
4.  **隐蔽指令：**  检查代码中是否存在不易察觉的指令，例如通过环境变量、时间等触发的恶意行为。没有发现此类指令。

尽管POC的主要功能是漏洞利用，仍存在一定的投毒风险。例如，攻击者可能修改`CVE-2023-42793_rce.sh`脚本，在执行目标命令之前，先执行一些恶意操作，例如下载并执行恶意程序，添加后门账户等。这种风险很难通过静态分析完全排除，需要进行动态分析，实际运行poc代码进行监控。

因此，综合考虑，投毒风险评估为10%。这个风险主要来源于用户下载和使用POC时，可能会下载到被篡改过的恶意版本。

**结论：**

CVE-2023-42793是一个高危漏洞，利用简单，影响范围广。建议受影响的用户尽快升级到最新版本。在使用公开的POC代码时，务必谨慎，进行代码审计，并确保从可信来源下载。

**项目地址:** [Zenmovie/CVE-2023-42793](https://github.com/Zenmovie/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #9

**来源**: [CVE-2023-42793-becrevex_CVE-2023-42793.md](../2023/CVE-2023-42793-becrevex_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个认证绕过漏洞，攻击者无需认证即可利用此漏洞在TeamCity服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8，属于高危漏洞，并且已被积极利用。多家安全公司和组织（例如Rapid7，Fortinet，Microsoft，CISA）都发布了关于该漏洞的分析和利用报告，甚至有APT组织（APT29，北朝鲜黑客组织）利用该漏洞进行攻击。

提供的POC代码是一个Nmap脚本，用于检测目标TeamCity服务器是否存在CVE-2023-42793漏洞。该脚本通过向`/app/rest/users/id:1/tokens/RPC2`路径发送POST请求，尝试创建一个新的用户令牌，如果服务器返回200状态码且包含一个令牌，则表明服务器存在漏洞。该脚本本身的行为是良性的，只是用于验证漏洞的存在，没有发现任何投毒代码。

**有效性：**
根据提供的漏洞信息和POC代码，该POC代码有效，可以用于检测目标是否存在CVE-2023-42793漏洞。

**投毒风险：**
对提供的Nmap脚本进行了分析，没有发现任何明显的投毒代码。脚本的功能明确，即检测TeamCity服务器上的漏洞，没有发现任何恶意行为。风险评估为0%

**利用方式：**
1.  攻击者利用未授权访问漏洞，绕过身份验证。
2.  攻击者发送特制请求，例如向`/app/rest/users/id:1/tokens/RPC2`路径创建用户Token。
3.  成功创建Token后，攻击者获得管理员权限。
4.  利用管理员权限执行任意代码，实现远程代码执行。

该漏洞利用简单，影响严重，建议TeamCity用户尽快升级到2023.05.4或更高版本。

**项目地址:** [becrevex/CVE-2023-42793](https://github.com/becrevex/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #10

**来源**: [CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md](../2023/CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** JetBrains TeamCity

**危害等级:** 极高，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可从网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity 2023.05.4之前版本中存在的一个身份验证绕过漏洞，可能导致未经身份验证的远程代码执行。根据漏洞库信息，此漏洞的CVSS评分为9.8，属于严重级别。多个搜索结果表明，该漏洞已被积极利用，甚至被APT组织利用进行攻击。提供的POC代码是一个Python脚本，它利用漏洞执行远程命令。

**利用方式：**

1.  **身份验证绕过：** 该漏洞允许攻击者绕过TeamCity服务器的身份验证机制。
2.  **获取Bearer Token：** 利用未经身份验证的访问，通过`/app/rest/users/id:1/tokens/RPC2`端点创建一个临时的Bearer Token。
3.  **启用调试模式：** 使用获得的Bearer Token，通过`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`端点启用调试模式，即`rest.debug.processes.enable=true`。
4.  **远程代码执行：** 使用获得的Bearer Token，通过`/app/rest/debug/processes`端点执行任意命令。POC使用bash反弹shell，通过URL编码将命令传递给目标服务器。

**有效性评估：**

提供的POC代码看起来是有效的。它利用了TeamCity REST API中的漏洞，绕过身份验证并执行任意代码。 脚本首先尝试获取一个临时的Bearer Token，然后使用该Token来修改`internal.properties`文件以启用调试模式。最后，脚本使用调试模式来执行远程代码。 脚本的`README.md`文件中提供的参考链接也支持了该漏洞的存在和可利用性。搜索结果中大量的安全厂商报告和分析也证实了此漏洞的真实性和高危性。

**投毒风险评估：**

分析POC代码没有发现明显的投毒代码。脚本的功能主要集中在利用漏洞进行远程代码执行，没有发现额外的恶意行为或后门。该脚本的功能与漏洞描述以及利用方式相符，未发现任何异常行为。因此，投毒风险评估为0%。

**项目地址:** [hotplugin0x01/CVE-2023-42793](https://github.com/hotplugin0x01/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #11

**来源**: [CVE-2023-42793-jakehomb_cve-2023-42793.md](../2023/CVE-2023-42793-jakehomb_cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器版本低于2023.05.4，且可通过HTTP(S)访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2023-42793 允许未经身份验证的攻击者在 TeamCity 服务器上执行远程代码。该漏洞利用方式是通过绕过身份验证机制，直接访问受保护的资源并执行恶意操作。

**有效性：**
根据提供的漏洞信息、搜索结果以及漏洞利用代码，可以判断该漏洞的 POC 代码有效。CVE 详情中提到存在身份验证绕过导致 RCE，搜索结果也表明该漏洞存在公开可用的exploit，并且已经被APT29等恶意行为者利用。

**投毒风险：**
提供的漏洞利用代码主要由两部分组成：获取 Token 和创建用户。getToken 函数尝试从 /app/rest/users/id:1/token/RPC2 获取一个 Token，createUser 函数使用这个 Token 来创建一个具有管理员权限的用户。代码本身功能明确，没有发现隐藏的恶意代码。因此，评估该仓库中存在作者隐藏的投毒代码的风险为0%。

**利用方式：**
1.  **目标探测：** 确定目标 TeamCity 服务器的版本是否低于 2023.05.4。
2.  **Token 获取：** 使用 `getToken` 函数，通过向 `https://<teamcity_url>/app/rest/users/id:1/token/RPC2` 发送 GET 请求，尝试获取一个 Token。服务器无需授权即可响应。  `extractToken` 函数从响应中提取 Token。
3.  **用户创建：** 使用 `createUser` 函数，携带上一步获取的 Token，向 `https://<teamcity_url>/app/rest/users` 发送 POST 请求，创建一个具有 SYSTEM_ADMIN 角色的新用户。请求的 Body 为包含用户名、密码和邮箱的JSON格式。
4.  **权限提升：** 使用新创建的管理员用户登录 TeamCity 服务器，获得完全控制权限，从而执行任意代码。

**项目地址:** [jakehomb/cve-2023-42793](https://github.com/jakehomb/cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #12

**来源**: [CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md](../2023/CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行远程代码。该漏洞影响2023.05.4之前的版本。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的，并且已被广泛利用。CISA已将其添加到已知被利用漏洞目录中。搜索引擎结果中多个安全厂商的博客也证实了该漏洞的有效性。

**投毒风险：**
提供的PoC代码本身的功能是利用漏洞创建新的管理员用户。`README.md`文件描述了脚本的功能，与代码行为一致。代码中对创建的用户名称添加了随机数，并会写入 `vulnerable.txt` 文件。 `vulnerable.txt`文件可能存在信息泄露的风险,如果被攻击者获取，可能结合其他漏洞使用。总体来看，该PoC代码存在投毒风险的可能性较低，约为10%。

**利用方式：**
1.  **删除用户令牌：** PoC首先尝试删除ID为1的用户令牌 (通常是管理员)。
2.  **创建用户令牌：** 如果删除成功或不存在，PoC会尝试为ID为1的用户创建一个新的用户令牌。
3.  **创建管理员用户：** 使用新创建的用户令牌，PoC会创建一个具有`SYSTEM_ADMIN`权限的新用户，用户名和密码是硬编码的（用户名以 `_secops` 开头，加上随机数，密码是 `changeme`）。
4.  **利用新用户登录：** 攻击者可以使用新创建的管理员帐户登录TeamCity服务器，从而完全控制该服务器。
5.  **自动化攻击:** 通过-u指定url或者-l指定url列表，实现批量攻击。

**项目地址:** [johnossawy/CVE-2023-42793_POC](https://github.com/johnossawy/CVE-2023-42793_POC)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #13

**来源**: [CVE-2023-42793-junnythemarksman_CVE-2023-42793.md](../2023/CVE-2023-42793-junnythemarksman_CVE-2023-42793.md)

# CVE-2023-42793

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md](../2023/CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md)

## CVE-2023-42793 - TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个身份验证绕过漏洞，未经身份验证的攻击者可以通过发送特制的 HTTP 请求绕过身份验证，从而创建管理员账户并最终实现远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果中多个链接都提到了该漏洞被积极利用，包括APT组织。漏洞利用代码提供了创建管理员账户和执行RCE的脚本，并且说明了如何利用该漏洞，包括如何获取反向shell。

**投毒风险：**
分析提供的`exploit.py`和`rce_exploit.py`，主要功能是创建管理员账户和执行任意命令。脚本本身的代码逻辑相对简单，没有明显的恶意代码。其中`exploit.py`会生成随机用户名、密码和邮箱地址，这可能被误认为恶意行为，但这是为了方便利用而设计的，并非投毒。`rce_exploit.py`脚本依赖于第一个脚本创建的token文件。虽然没有发现明显的后门代码，但仍存在极小的风险，例如在生成随机字符串时引入偏差，虽然可能性极小，但理论上存在被利用的可能性，将投毒风险评定为5%。

**利用方式：**
1.  **身份验证绕过：** 攻击者首先利用身份验证绕过漏洞，该漏洞允许未经身份验证的攻击者与TeamCity服务器进行交互，绕过正常的身份验证流程。
2.  **创建管理员账户：** 使用 `exploit.py` 脚本，通过发送特制的 POST 请求，在 TeamCity 服务器上创建一个新的管理员账户。可以指定用户名、密码和邮箱，也可以使用随机生成的凭据。成功创建后，会将凭据保存到token文件中。
3.  **远程代码执行：** 使用 `rce.py` 脚本，该脚本首先启用debug processes，然后利用创建的管理员账户，通过 TeamCity 的 API 接口执行任意命令。可以执行系统命令，例如 `whoami`，也可以获取反向 shell，从而完全控制服务器。
4.  **反向Shell:** 利用rce.py执行命令，通过反弹shell到攻击者机器上，来获取服务器的控制权。


**项目地址:** [B4l3rI0n/CVE-2023-42793](https://github.com/B4l3rI0n/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #2

**来源**: [CVE-2023-42793-FlojBoj_CVE-2023-42793.md](../2023/CVE-2023-42793-FlojBoj_CVE-2023-42793.md)

## CVE-2023-42793-JetBrainsTeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可能导致远程代码执行和完全控制TeamCity服务器

**影响版本:** < 2023.05.4

**利用条件:** 需要能够通过HTTP(S)访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，攻击者无需身份验证即可执行远程代码。漏洞利用方式如下：

1.  **有效性：** 漏洞信息和搜索结果表明该漏洞已在野外被积极利用，包括APT组织（如APT29、CozyBear、北朝鲜黑客组织）和俄罗斯情报部门SVR。提供的代码`exploit.py`旨在利用此漏洞创建管理员账户或获取现有用户的token，从而控制TeamCity服务器。根据README.md的描述，还有一个`rce.py`脚本可以执行远程命令，但主脚本`exploit.py`的功能是创建管理员账户。

2.  **投毒风险：** 代码`exploit.py`本身的功能是利用漏洞创建管理员用户或获取token。投毒风险评估如下：
    *   代码中存在一些硬编码，例如默认密码"Password@123"和默认邮箱域名"@lol.omg"，如果直接使用这些默认值，容易被检测和防御。但这不属于投毒，而是简化使用的示例。
    *   代码尝试首先获取或删除现有的token，这增加了攻击成功的概率，但也可能在目标环境中留下痕迹。
    *   总体来看，`exploit.py`的主要风险在于被滥用以非法控制TeamCity服务器，而非恶意代码本身。因此，投毒风险较低，估计为10%。主要是担心引入了额外的请求或命令，用于收集用户信息或执行其他未经授权的操作。

3.  **利用方式：** 利用方式主要分为以下步骤：
    a.  攻击者发送特制的HTTP请求到TeamCity服务器，绕过身份验证。
    b.  使用`exploit.py`脚本，指定目标TeamCity服务器的URL。
    c.  脚本尝试获取或删除现有的token，然后创建一个新的管理员用户，或者获取指定用户的token。
    d.  如果成功创建管理员用户，攻击者可以使用新创建的管理员账户登录TeamCity服务器，并获得完全控制权限。
    e. 通过获取到的token, 攻击者可以模拟用户身份，从而执行相关操作。

该漏洞的严重性在于未经身份验证即可创建管理员帐户并执行任意代码，从而完全控制受影响的TeamCity服务器。缓解措施包括尽快升级到2023.05.4或更高版本。

**项目地址:** [FlojBoj/CVE-2023-42793](https://github.com/FlojBoj/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #3

**来源**: [CVE-2023-42793-H454NSec_CVE-2023-42793.md](../2023/CVE-2023-42793-H454NSec_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从攻击者控制的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 漏洞存在于JetBrains TeamCity 2023.05.4 之前的版本中，允许未经身份验证的攻击者绕过身份验证，最终实现远程代码执行。根据漏洞库信息，该漏洞的 CVSS 3.1 评分为 9.8，属于严重级别。搜索结果表明，该漏洞已被广泛利用，甚至被 APT 组织用于攻击活动。 

**漏洞利用方式：**

1.  **身份验证绕过：** 漏洞利用代码通过发送特制的 HTTP 请求来绕过 TeamCity 的身份验证机制。具体利用细节需要分析补丁或者参考其他分析报告。
2.  **创建管理员用户：** 漏洞利用代码首先删除 id 为 1 的用户的token，然后创建一个新的用户 token。使用这个 token，攻击者可以创建一个具有管理员权限的新用户。新用户的用户名和密码可以通过命令行参数指定，默认用户名为 `H454NSec[随机数]`，密码为 `@H454NSec`。利用成功后，即可使用创建的管理员用户登录TeamCity控制台。
3.  **远程代码执行：** 通过管理员权限，攻击者可以在 TeamCity 服务器上执行任意代码，实现远程控制。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确定该 POC 代码是有效的。漏洞已被公开披露且有可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。风险分析如下：

*   **代码结构：** 代码结构相对清晰，主要功能是利用漏洞创建管理员用户。
*   **可疑行为：** 代码中存在以下潜在风险：
    *   **默认用户名和密码：** 使用默认的用户名和密码 `@H454NSec` 创建管理员帐户，这可能会让其他攻击者更容易入侵，或者导致安全审计告警。
    *   **硬编码的 User-Agent：**  User-Agent头 `Mozilla/5.0 (https://github.com/H454NSec/CVE-2023-42793) Gecko/20100101 Firefox/113.0`  可能被用于追踪攻击源。但同时也降低了攻击的隐蔽性。
    *   **未处理异常：** 虽然代码有异常处理，但仅仅是简单的`pass`，可能会隐藏一些错误信息，增加调试难度。
*   **高危操作：**  漏洞利用本身就是高危操作，如果攻击者通过修改poc加入恶意命令，将会造成严重危害，例如植入后门。

综合考虑以上因素，该 POC 代码的投毒风险评估为 10%。主要风险在于攻击者可能利用该代码进行二次修改，加入恶意代码或后门，从而扩大攻击范围。

**项目地址:** [H454NSec/CVE-2023-42793](https://github.com/H454NSec/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #4

**来源**: [CVE-2023-42793-HusenjanDev_CVE-2023-42793.md](../2023/CVE-2023-42793-HusenjanDev_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从网络访问，需要通过其他途径获取TeamCity Token。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，允许未经身份验证的攻击者通过HTTP(S)访问TeamCity服务器，并执行远程代码。根据漏洞库信息，CVSS评分为9.8，属于严重级别。搜索引擎结果显示，该漏洞已被多个APT组织利用，包括APT29、北朝鲜的Diamond Sleet和Onyx Sleet以及俄罗斯对外情报局 (SVR)，显示其真实性和危害性。Rapid7的博客文章也详细分析了该漏洞。提供的POC代码的利用方式是：

1.  **获取TeamCity Token:**  `readme.md` 中提到，需要通过其他漏洞或者方式获取TeamCity的Token. 这是利用此POC的前提。
2.  **启用调试模式:** 使用curl命令发送POST请求到`/admin/dataDir.html`，修改`config/internal.properties`文件，启用`rest.debug.processes.enable=true`，从而开启调试模式。这一步通过token进行验证。
3.  **构造反弹shell Payload:**  将反弹shell命令进行URL编码，目标是让受害者主机连接攻击者的Netcat监听器。
4.  **执行远程命令:** 使用curl命令发送POST请求到`/app/rest/debug/processes`，指定`exePath`为`/bin/bash`，`params`为`-c`和URL编码后的反弹shell命令。这个请求同样需要token验证。漏洞利用依赖于已获取的TeamCity token，然后通过启用调试模式执行反弹shell。根据分析，该POC代码没有明显的投毒行为。

**项目地址:** [HusenjanDev/CVE-2023-42793](https://github.com/HusenjanDev/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #5

**来源**: [CVE-2023-42793-LeHeron_TC_test.md](../2023/CVE-2023-42793-LeHeron_TC_test.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个严重的身份验证绕过漏洞，攻击者无需身份验证即可在 TeamCity 服务器上执行远程代码。根据漏洞信息和搜索结果，该漏洞已被积极利用，甚至APT组织，如CozyBear，以及北朝鲜的APT组织都在利用该漏洞。 

**有效性：**
根据搜索结果，此漏洞已经存在公开的利用代码，且已被广泛利用，证明漏洞有效。

**投毒风险：**
提供的漏洞利用代码 `/tmp/da0475f0898b55e5196bf0f36ac9d45e/README`  只是一个简单的README文件，内容为 “Hello World”，不包含任何可执行代码或恶意指令。投毒的可能性极低，可以认为几乎不存在，给到1%的可能也只是对未知风险的保留。

**利用方式：**
根据漏洞描述，攻击者可以通过未授权访问TeamCity服务器，从而执行任意代码。具体的利用方式可能涉及到构造特定的HTTP请求绕过身份验证机制，然后利用TeamCity服务器的功能执行恶意命令。参考Rapid7的博客文章，该漏洞利用可能与特定的端点和参数有关，允许攻击者创建管理员用户或直接执行代码。 从搜索结果来看，该漏洞已经成为恶意行为者的攻击目标，建议尽快升级到安全版本。

**项目地址:** [LeHeron/TC_test](https://github.com/LeHeron/TC_test)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #6

**来源**: [CVE-2023-42793-StanleyJobsonAU_GhostTown.md](../2023/CVE-2023-42793-StanleyJobsonAU_GhostTown.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个身份验证绕过漏洞，允许未经身份验证的攻击者远程执行代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8（严重），并且已被积极利用。搜索结果表明，包括APT29、朝鲜黑客组织以及俄罗斯对外情报局（SVR）等多个威胁组织都在利用此漏洞。提供的POC代码 `GhostTown.py` 旨在利用此漏洞。利用方式如下：

1.  **生成管理员Token：** POC首先尝试通过 `/app/rest/users/id:1/tokens/RPC2` 接口创建一个管理员Token。这将绕过身份验证。
2.  **检索内部配置：** 使用生成的管理员Token，POC尝试从 `/get/file/dataDir/config/internal.properties` 接口检索TeamCity的内部配置。
3.  **更新配置：** POC会检查配置项中是否包含 `rest.debug.processes.enable=true`，如果不存在，则将其添加到配置项中，并通过 `/get/file/dataDir/config/internal.properties` 接口更新配置。`rest.debug.processes.enable=true` 配置的目的是允许执行调试进程，这为远程代码执行铺平了道路。(这部分未在提供的代码片段中。)
4. **远程代码执行：** 启用调试进程允许攻击者通过构造特定的请求来执行任意命令。

**有效性：** 根据漏洞信息和搜索结果，此POC代码有效，能够利用CVE-2023-42793漏洞实现RCE。

**投毒风险：** 检查提供的代码，主要逻辑集中在利用漏洞上，没有发现明显的恶意代码或后门。该代码是为了验证漏洞存在，并帮助安全研究人员和管理员修复漏洞，存在投毒代码的可能性较低。


**项目地址:** [StanleyJobsonAU/GhostTown](https://github.com/StanleyJobsonAU/GhostTown)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #7

**来源**: [CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md](../2023/CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器，且目标版本低于2023.05.4

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 存在于 JetBrains TeamCity 2023.05.4 之前的版本中，是一个身份验证绕过漏洞，可以导致未经身份验证的远程代码执行。攻击者可以利用此漏洞在 TeamCity 服务器上执行任意代码，从而完全控制服务器。漏洞利用方式如下：

1.  **身份验证绕过：** 利用漏洞绕过身份验证。
2.  **启用调试模式：** 通过修改 `internal.properties` 文件启用 `rest.debug.processes.enable`。
3.  **远程代码执行：** 使用 `/app/rest/debug/processes` 接口执行任意命令。脚本通过修改 `internal.properties` 文件，然后使用特制的请求调用 `debug/processes` 接口，从而在目标系统上执行任意命令。

提供的 `TeamCity.sh` 脚本允许用户指定目标操作系统 (Linux 或 Windows)，并相应地调整命令执行方式。脚本首先获取一个token，然后利用该 token 修改`internal.properties`文件以启用调试模式，最后使用构造好的包含恶意命令的URL来触发RCE。

投毒风险评估：代码中主要逻辑为漏洞利用，并未发现明显的恶意代码。`TeamCity.sh` 中选择目标OS后，Linux环境使用了`base64`编码命令，Windows没有。虽然脚本的行为符合漏洞利用的预期，但是如果攻击者对`base64` 编码方式做了手脚，有可能在Linux执行的时候插入恶意命令。`TeamCity2.sh` 脚本对命令进行URL编码，windows只支持powershell, 可以对powershell添加恶意payload. 因此，存在一定的投毒风险，估计在10%左右。

**项目地址:** [SwiftSecur/teamcity-exploit-cve-2023-42793](https://github.com/SwiftSecur/teamcity-exploit-cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #8

**来源**: [CVE-2023-42793-Zenmovie_CVE-2023-42793.md](../2023/CVE-2023-42793-Zenmovie_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity实例需要开启网络访问，且版本低于2023.05.4。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的远程攻击者绕过身份验证，并在服务器上执行任意代码。根据漏洞库信息，CVSS评分为9.8（严重）。

**利用方式：**

1.  **身份验证绕过：** 攻击者利用未经身份验证的REST API端点`/app/rest/users/id:1/tokens/RPC2`来获取一个有效的Bearer Token。这个Token最初的设计目的是允许用户通过API管理自己的Token。
2.  **修改内部属性：** 使用获取的Token，通过POST请求访问`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`修改内部属性，启用`rest.debug.processes.enable`，此步骤为后续RCE做准备。
3.  **远程代码执行：**  利用被启用的REST API端点`/app/rest/debug/processes?exePath=${COMMAND}`，通过`exePath`参数执行任意命令。该端点在正常情况下只允许经过身份验证的管理员访问，但由于身份验证绕过，未经授权的攻击者可以利用它。

**POC有效性：**

提供的POC代码包含两个脚本：`CVE-2023-42793_admin.sh`和`CVE-2023-42793_rce.sh`。

*   `CVE-2023-42793_admin.sh`脚本利用漏洞创建一个新的管理员用户（Zenmovie/Zenmovie），方便后续访问TeamCity。
*   `CVE-2023-42793_rce.sh`脚本利用漏洞执行指定的命令，并返回命令输出。

从提供的README.md中的截图以及漏洞原理来看，POC代码是有效的，可以成功利用该漏洞。

**投毒风险：**

评估投毒风险，需考虑作者是否有意在代码中添加恶意功能。

1.  **代码混淆/隐藏：** 代码没有进行明显的混淆。虽然使用了`grep`和`awk`提取Token和命令输出，但是属于正常利用。
2.  **恶意依赖：** 代码没有引入外部依赖。
3.  **后门代码：** 代码的主要功能是利用漏洞，创建管理员账户或执行命令。没有发现明显与漏洞利用无关的恶意代码，例如反弹shell、上传文件等。
4.  **隐蔽指令：**  检查代码中是否存在不易察觉的指令，例如通过环境变量、时间等触发的恶意行为。没有发现此类指令。

尽管POC的主要功能是漏洞利用，仍存在一定的投毒风险。例如，攻击者可能修改`CVE-2023-42793_rce.sh`脚本，在执行目标命令之前，先执行一些恶意操作，例如下载并执行恶意程序，添加后门账户等。这种风险很难通过静态分析完全排除，需要进行动态分析，实际运行poc代码进行监控。

因此，综合考虑，投毒风险评估为10%。这个风险主要来源于用户下载和使用POC时，可能会下载到被篡改过的恶意版本。

**结论：**

CVE-2023-42793是一个高危漏洞，利用简单，影响范围广。建议受影响的用户尽快升级到最新版本。在使用公开的POC代码时，务必谨慎，进行代码审计，并确保从可信来源下载。

**项目地址:** [Zenmovie/CVE-2023-42793](https://github.com/Zenmovie/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #9

**来源**: [CVE-2023-42793-becrevex_CVE-2023-42793.md](../2023/CVE-2023-42793-becrevex_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个认证绕过漏洞，攻击者无需认证即可利用此漏洞在TeamCity服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8，属于高危漏洞，并且已被积极利用。多家安全公司和组织（例如Rapid7，Fortinet，Microsoft，CISA）都发布了关于该漏洞的分析和利用报告，甚至有APT组织（APT29，北朝鲜黑客组织）利用该漏洞进行攻击。

提供的POC代码是一个Nmap脚本，用于检测目标TeamCity服务器是否存在CVE-2023-42793漏洞。该脚本通过向`/app/rest/users/id:1/tokens/RPC2`路径发送POST请求，尝试创建一个新的用户令牌，如果服务器返回200状态码且包含一个令牌，则表明服务器存在漏洞。该脚本本身的行为是良性的，只是用于验证漏洞的存在，没有发现任何投毒代码。

**有效性：**
根据提供的漏洞信息和POC代码，该POC代码有效，可以用于检测目标是否存在CVE-2023-42793漏洞。

**投毒风险：**
对提供的Nmap脚本进行了分析，没有发现任何明显的投毒代码。脚本的功能明确，即检测TeamCity服务器上的漏洞，没有发现任何恶意行为。风险评估为0%

**利用方式：**
1.  攻击者利用未授权访问漏洞，绕过身份验证。
2.  攻击者发送特制请求，例如向`/app/rest/users/id:1/tokens/RPC2`路径创建用户Token。
3.  成功创建Token后，攻击者获得管理员权限。
4.  利用管理员权限执行任意代码，实现远程代码执行。

该漏洞利用简单，影响严重，建议TeamCity用户尽快升级到2023.05.4或更高版本。

**项目地址:** [becrevex/CVE-2023-42793](https://github.com/becrevex/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #10

**来源**: [CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md](../2023/CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** JetBrains TeamCity

**危害等级:** 极高，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可从网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity 2023.05.4之前版本中存在的一个身份验证绕过漏洞，可能导致未经身份验证的远程代码执行。根据漏洞库信息，此漏洞的CVSS评分为9.8，属于严重级别。多个搜索结果表明，该漏洞已被积极利用，甚至被APT组织利用进行攻击。提供的POC代码是一个Python脚本，它利用漏洞执行远程命令。

**利用方式：**

1.  **身份验证绕过：** 该漏洞允许攻击者绕过TeamCity服务器的身份验证机制。
2.  **获取Bearer Token：** 利用未经身份验证的访问，通过`/app/rest/users/id:1/tokens/RPC2`端点创建一个临时的Bearer Token。
3.  **启用调试模式：** 使用获得的Bearer Token，通过`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`端点启用调试模式，即`rest.debug.processes.enable=true`。
4.  **远程代码执行：** 使用获得的Bearer Token，通过`/app/rest/debug/processes`端点执行任意命令。POC使用bash反弹shell，通过URL编码将命令传递给目标服务器。

**有效性评估：**

提供的POC代码看起来是有效的。它利用了TeamCity REST API中的漏洞，绕过身份验证并执行任意代码。 脚本首先尝试获取一个临时的Bearer Token，然后使用该Token来修改`internal.properties`文件以启用调试模式。最后，脚本使用调试模式来执行远程代码。 脚本的`README.md`文件中提供的参考链接也支持了该漏洞的存在和可利用性。搜索结果中大量的安全厂商报告和分析也证实了此漏洞的真实性和高危性。

**投毒风险评估：**

分析POC代码没有发现明显的投毒代码。脚本的功能主要集中在利用漏洞进行远程代码执行，没有发现额外的恶意行为或后门。该脚本的功能与漏洞描述以及利用方式相符，未发现任何异常行为。因此，投毒风险评估为0%。

**项目地址:** [hotplugin0x01/CVE-2023-42793](https://github.com/hotplugin0x01/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #11

**来源**: [CVE-2023-42793-jakehomb_cve-2023-42793.md](../2023/CVE-2023-42793-jakehomb_cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器版本低于2023.05.4，且可通过HTTP(S)访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2023-42793 允许未经身份验证的攻击者在 TeamCity 服务器上执行远程代码。该漏洞利用方式是通过绕过身份验证机制，直接访问受保护的资源并执行恶意操作。

**有效性：**
根据提供的漏洞信息、搜索结果以及漏洞利用代码，可以判断该漏洞的 POC 代码有效。CVE 详情中提到存在身份验证绕过导致 RCE，搜索结果也表明该漏洞存在公开可用的exploit，并且已经被APT29等恶意行为者利用。

**投毒风险：**
提供的漏洞利用代码主要由两部分组成：获取 Token 和创建用户。getToken 函数尝试从 /app/rest/users/id:1/token/RPC2 获取一个 Token，createUser 函数使用这个 Token 来创建一个具有管理员权限的用户。代码本身功能明确，没有发现隐藏的恶意代码。因此，评估该仓库中存在作者隐藏的投毒代码的风险为0%。

**利用方式：**
1.  **目标探测：** 确定目标 TeamCity 服务器的版本是否低于 2023.05.4。
2.  **Token 获取：** 使用 `getToken` 函数，通过向 `https://<teamcity_url>/app/rest/users/id:1/token/RPC2` 发送 GET 请求，尝试获取一个 Token。服务器无需授权即可响应。  `extractToken` 函数从响应中提取 Token。
3.  **用户创建：** 使用 `createUser` 函数，携带上一步获取的 Token，向 `https://<teamcity_url>/app/rest/users` 发送 POST 请求，创建一个具有 SYSTEM_ADMIN 角色的新用户。请求的 Body 为包含用户名、密码和邮箱的JSON格式。
4.  **权限提升：** 使用新创建的管理员用户登录 TeamCity 服务器，获得完全控制权限，从而执行任意代码。

**项目地址:** [jakehomb/cve-2023-42793](https://github.com/jakehomb/cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #12

**来源**: [CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md](../2023/CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行远程代码。该漏洞影响2023.05.4之前的版本。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的，并且已被广泛利用。CISA已将其添加到已知被利用漏洞目录中。搜索引擎结果中多个安全厂商的博客也证实了该漏洞的有效性。

**投毒风险：**
提供的PoC代码本身的功能是利用漏洞创建新的管理员用户。`README.md`文件描述了脚本的功能，与代码行为一致。代码中对创建的用户名称添加了随机数，并会写入 `vulnerable.txt` 文件。 `vulnerable.txt`文件可能存在信息泄露的风险,如果被攻击者获取，可能结合其他漏洞使用。总体来看，该PoC代码存在投毒风险的可能性较低，约为10%。

**利用方式：**
1.  **删除用户令牌：** PoC首先尝试删除ID为1的用户令牌 (通常是管理员)。
2.  **创建用户令牌：** 如果删除成功或不存在，PoC会尝试为ID为1的用户创建一个新的用户令牌。
3.  **创建管理员用户：** 使用新创建的用户令牌，PoC会创建一个具有`SYSTEM_ADMIN`权限的新用户，用户名和密码是硬编码的（用户名以 `_secops` 开头，加上随机数，密码是 `changeme`）。
4.  **利用新用户登录：** 攻击者可以使用新创建的管理员帐户登录TeamCity服务器，从而完全控制该服务器。
5.  **自动化攻击:** 通过-u指定url或者-l指定url列表，实现批量攻击。

**项目地址:** [johnossawy/CVE-2023-42793_POC](https://github.com/johnossawy/CVE-2023-42793_POC)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #13

**来源**: [CVE-2023-42793-junnythemarksman_CVE-2023-42793.md](../2023/CVE-2023-42793-junnythemarksman_CVE-2023-42793.md)

# CVE-2023-42793

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md](../2023/CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md)

## CVE-2023-42793 - TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个身份验证绕过漏洞，未经身份验证的攻击者可以通过发送特制的 HTTP 请求绕过身份验证，从而创建管理员账户并最终实现远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果中多个链接都提到了该漏洞被积极利用，包括APT组织。漏洞利用代码提供了创建管理员账户和执行RCE的脚本，并且说明了如何利用该漏洞，包括如何获取反向shell。

**投毒风险：**
分析提供的`exploit.py`和`rce_exploit.py`，主要功能是创建管理员账户和执行任意命令。脚本本身的代码逻辑相对简单，没有明显的恶意代码。其中`exploit.py`会生成随机用户名、密码和邮箱地址，这可能被误认为恶意行为，但这是为了方便利用而设计的，并非投毒。`rce_exploit.py`脚本依赖于第一个脚本创建的token文件。虽然没有发现明显的后门代码，但仍存在极小的风险，例如在生成随机字符串时引入偏差，虽然可能性极小，但理论上存在被利用的可能性，将投毒风险评定为5%。

**利用方式：**
1.  **身份验证绕过：** 攻击者首先利用身份验证绕过漏洞，该漏洞允许未经身份验证的攻击者与TeamCity服务器进行交互，绕过正常的身份验证流程。
2.  **创建管理员账户：** 使用 `exploit.py` 脚本，通过发送特制的 POST 请求，在 TeamCity 服务器上创建一个新的管理员账户。可以指定用户名、密码和邮箱，也可以使用随机生成的凭据。成功创建后，会将凭据保存到token文件中。
3.  **远程代码执行：** 使用 `rce.py` 脚本，该脚本首先启用debug processes，然后利用创建的管理员账户，通过 TeamCity 的 API 接口执行任意命令。可以执行系统命令，例如 `whoami`，也可以获取反向 shell，从而完全控制服务器。
4.  **反向Shell:** 利用rce.py执行命令，通过反弹shell到攻击者机器上，来获取服务器的控制权。


**项目地址:** [B4l3rI0n/CVE-2023-42793](https://github.com/B4l3rI0n/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #2

**来源**: [CVE-2023-42793-FlojBoj_CVE-2023-42793.md](../2023/CVE-2023-42793-FlojBoj_CVE-2023-42793.md)

## CVE-2023-42793-JetBrainsTeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可能导致远程代码执行和完全控制TeamCity服务器

**影响版本:** < 2023.05.4

**利用条件:** 需要能够通过HTTP(S)访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，攻击者无需身份验证即可执行远程代码。漏洞利用方式如下：

1.  **有效性：** 漏洞信息和搜索结果表明该漏洞已在野外被积极利用，包括APT组织（如APT29、CozyBear、北朝鲜黑客组织）和俄罗斯情报部门SVR。提供的代码`exploit.py`旨在利用此漏洞创建管理员账户或获取现有用户的token，从而控制TeamCity服务器。根据README.md的描述，还有一个`rce.py`脚本可以执行远程命令，但主脚本`exploit.py`的功能是创建管理员账户。

2.  **投毒风险：** 代码`exploit.py`本身的功能是利用漏洞创建管理员用户或获取token。投毒风险评估如下：
    *   代码中存在一些硬编码，例如默认密码"Password@123"和默认邮箱域名"@lol.omg"，如果直接使用这些默认值，容易被检测和防御。但这不属于投毒，而是简化使用的示例。
    *   代码尝试首先获取或删除现有的token，这增加了攻击成功的概率，但也可能在目标环境中留下痕迹。
    *   总体来看，`exploit.py`的主要风险在于被滥用以非法控制TeamCity服务器，而非恶意代码本身。因此，投毒风险较低，估计为10%。主要是担心引入了额外的请求或命令，用于收集用户信息或执行其他未经授权的操作。

3.  **利用方式：** 利用方式主要分为以下步骤：
    a.  攻击者发送特制的HTTP请求到TeamCity服务器，绕过身份验证。
    b.  使用`exploit.py`脚本，指定目标TeamCity服务器的URL。
    c.  脚本尝试获取或删除现有的token，然后创建一个新的管理员用户，或者获取指定用户的token。
    d.  如果成功创建管理员用户，攻击者可以使用新创建的管理员账户登录TeamCity服务器，并获得完全控制权限。
    e. 通过获取到的token, 攻击者可以模拟用户身份，从而执行相关操作。

该漏洞的严重性在于未经身份验证即可创建管理员帐户并执行任意代码，从而完全控制受影响的TeamCity服务器。缓解措施包括尽快升级到2023.05.4或更高版本。

**项目地址:** [FlojBoj/CVE-2023-42793](https://github.com/FlojBoj/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #3

**来源**: [CVE-2023-42793-H454NSec_CVE-2023-42793.md](../2023/CVE-2023-42793-H454NSec_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从攻击者控制的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 漏洞存在于JetBrains TeamCity 2023.05.4 之前的版本中，允许未经身份验证的攻击者绕过身份验证，最终实现远程代码执行。根据漏洞库信息，该漏洞的 CVSS 3.1 评分为 9.8，属于严重级别。搜索结果表明，该漏洞已被广泛利用，甚至被 APT 组织用于攻击活动。 

**漏洞利用方式：**

1.  **身份验证绕过：** 漏洞利用代码通过发送特制的 HTTP 请求来绕过 TeamCity 的身份验证机制。具体利用细节需要分析补丁或者参考其他分析报告。
2.  **创建管理员用户：** 漏洞利用代码首先删除 id 为 1 的用户的token，然后创建一个新的用户 token。使用这个 token，攻击者可以创建一个具有管理员权限的新用户。新用户的用户名和密码可以通过命令行参数指定，默认用户名为 `H454NSec[随机数]`，密码为 `@H454NSec`。利用成功后，即可使用创建的管理员用户登录TeamCity控制台。
3.  **远程代码执行：** 通过管理员权限，攻击者可以在 TeamCity 服务器上执行任意代码，实现远程控制。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确定该 POC 代码是有效的。漏洞已被公开披露且有可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。风险分析如下：

*   **代码结构：** 代码结构相对清晰，主要功能是利用漏洞创建管理员用户。
*   **可疑行为：** 代码中存在以下潜在风险：
    *   **默认用户名和密码：** 使用默认的用户名和密码 `@H454NSec` 创建管理员帐户，这可能会让其他攻击者更容易入侵，或者导致安全审计告警。
    *   **硬编码的 User-Agent：**  User-Agent头 `Mozilla/5.0 (https://github.com/H454NSec/CVE-2023-42793) Gecko/20100101 Firefox/113.0`  可能被用于追踪攻击源。但同时也降低了攻击的隐蔽性。
    *   **未处理异常：** 虽然代码有异常处理，但仅仅是简单的`pass`，可能会隐藏一些错误信息，增加调试难度。
*   **高危操作：**  漏洞利用本身就是高危操作，如果攻击者通过修改poc加入恶意命令，将会造成严重危害，例如植入后门。

综合考虑以上因素，该 POC 代码的投毒风险评估为 10%。主要风险在于攻击者可能利用该代码进行二次修改，加入恶意代码或后门，从而扩大攻击范围。

**项目地址:** [H454NSec/CVE-2023-42793](https://github.com/H454NSec/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #4

**来源**: [CVE-2023-42793-HusenjanDev_CVE-2023-42793.md](../2023/CVE-2023-42793-HusenjanDev_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从网络访问，需要通过其他途径获取TeamCity Token。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，允许未经身份验证的攻击者通过HTTP(S)访问TeamCity服务器，并执行远程代码。根据漏洞库信息，CVSS评分为9.8，属于严重级别。搜索引擎结果显示，该漏洞已被多个APT组织利用，包括APT29、北朝鲜的Diamond Sleet和Onyx Sleet以及俄罗斯对外情报局 (SVR)，显示其真实性和危害性。Rapid7的博客文章也详细分析了该漏洞。提供的POC代码的利用方式是：

1.  **获取TeamCity Token:**  `readme.md` 中提到，需要通过其他漏洞或者方式获取TeamCity的Token. 这是利用此POC的前提。
2.  **启用调试模式:** 使用curl命令发送POST请求到`/admin/dataDir.html`，修改`config/internal.properties`文件，启用`rest.debug.processes.enable=true`，从而开启调试模式。这一步通过token进行验证。
3.  **构造反弹shell Payload:**  将反弹shell命令进行URL编码，目标是让受害者主机连接攻击者的Netcat监听器。
4.  **执行远程命令:** 使用curl命令发送POST请求到`/app/rest/debug/processes`，指定`exePath`为`/bin/bash`，`params`为`-c`和URL编码后的反弹shell命令。这个请求同样需要token验证。漏洞利用依赖于已获取的TeamCity token，然后通过启用调试模式执行反弹shell。根据分析，该POC代码没有明显的投毒行为。

**项目地址:** [HusenjanDev/CVE-2023-42793](https://github.com/HusenjanDev/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #5

**来源**: [CVE-2023-42793-LeHeron_TC_test.md](../2023/CVE-2023-42793-LeHeron_TC_test.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个严重的身份验证绕过漏洞，攻击者无需身份验证即可在 TeamCity 服务器上执行远程代码。根据漏洞信息和搜索结果，该漏洞已被积极利用，甚至APT组织，如CozyBear，以及北朝鲜的APT组织都在利用该漏洞。 

**有效性：**
根据搜索结果，此漏洞已经存在公开的利用代码，且已被广泛利用，证明漏洞有效。

**投毒风险：**
提供的漏洞利用代码 `/tmp/da0475f0898b55e5196bf0f36ac9d45e/README`  只是一个简单的README文件，内容为 “Hello World”，不包含任何可执行代码或恶意指令。投毒的可能性极低，可以认为几乎不存在，给到1%的可能也只是对未知风险的保留。

**利用方式：**
根据漏洞描述，攻击者可以通过未授权访问TeamCity服务器，从而执行任意代码。具体的利用方式可能涉及到构造特定的HTTP请求绕过身份验证机制，然后利用TeamCity服务器的功能执行恶意命令。参考Rapid7的博客文章，该漏洞利用可能与特定的端点和参数有关，允许攻击者创建管理员用户或直接执行代码。 从搜索结果来看，该漏洞已经成为恶意行为者的攻击目标，建议尽快升级到安全版本。

**项目地址:** [LeHeron/TC_test](https://github.com/LeHeron/TC_test)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #6

**来源**: [CVE-2023-42793-StanleyJobsonAU_GhostTown.md](../2023/CVE-2023-42793-StanleyJobsonAU_GhostTown.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个身份验证绕过漏洞，允许未经身份验证的攻击者远程执行代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8（严重），并且已被积极利用。搜索结果表明，包括APT29、朝鲜黑客组织以及俄罗斯对外情报局（SVR）等多个威胁组织都在利用此漏洞。提供的POC代码 `GhostTown.py` 旨在利用此漏洞。利用方式如下：

1.  **生成管理员Token：** POC首先尝试通过 `/app/rest/users/id:1/tokens/RPC2` 接口创建一个管理员Token。这将绕过身份验证。
2.  **检索内部配置：** 使用生成的管理员Token，POC尝试从 `/get/file/dataDir/config/internal.properties` 接口检索TeamCity的内部配置。
3.  **更新配置：** POC会检查配置项中是否包含 `rest.debug.processes.enable=true`，如果不存在，则将其添加到配置项中，并通过 `/get/file/dataDir/config/internal.properties` 接口更新配置。`rest.debug.processes.enable=true` 配置的目的是允许执行调试进程，这为远程代码执行铺平了道路。(这部分未在提供的代码片段中。)
4. **远程代码执行：** 启用调试进程允许攻击者通过构造特定的请求来执行任意命令。

**有效性：** 根据漏洞信息和搜索结果，此POC代码有效，能够利用CVE-2023-42793漏洞实现RCE。

**投毒风险：** 检查提供的代码，主要逻辑集中在利用漏洞上，没有发现明显的恶意代码或后门。该代码是为了验证漏洞存在，并帮助安全研究人员和管理员修复漏洞，存在投毒代码的可能性较低。


**项目地址:** [StanleyJobsonAU/GhostTown](https://github.com/StanleyJobsonAU/GhostTown)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #7

**来源**: [CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md](../2023/CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器，且目标版本低于2023.05.4

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 存在于 JetBrains TeamCity 2023.05.4 之前的版本中，是一个身份验证绕过漏洞，可以导致未经身份验证的远程代码执行。攻击者可以利用此漏洞在 TeamCity 服务器上执行任意代码，从而完全控制服务器。漏洞利用方式如下：

1.  **身份验证绕过：** 利用漏洞绕过身份验证。
2.  **启用调试模式：** 通过修改 `internal.properties` 文件启用 `rest.debug.processes.enable`。
3.  **远程代码执行：** 使用 `/app/rest/debug/processes` 接口执行任意命令。脚本通过修改 `internal.properties` 文件，然后使用特制的请求调用 `debug/processes` 接口，从而在目标系统上执行任意命令。

提供的 `TeamCity.sh` 脚本允许用户指定目标操作系统 (Linux 或 Windows)，并相应地调整命令执行方式。脚本首先获取一个token，然后利用该 token 修改`internal.properties`文件以启用调试模式，最后使用构造好的包含恶意命令的URL来触发RCE。

投毒风险评估：代码中主要逻辑为漏洞利用，并未发现明显的恶意代码。`TeamCity.sh` 中选择目标OS后，Linux环境使用了`base64`编码命令，Windows没有。虽然脚本的行为符合漏洞利用的预期，但是如果攻击者对`base64` 编码方式做了手脚，有可能在Linux执行的时候插入恶意命令。`TeamCity2.sh` 脚本对命令进行URL编码，windows只支持powershell, 可以对powershell添加恶意payload. 因此，存在一定的投毒风险，估计在10%左右。

**项目地址:** [SwiftSecur/teamcity-exploit-cve-2023-42793](https://github.com/SwiftSecur/teamcity-exploit-cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #8

**来源**: [CVE-2023-42793-Zenmovie_CVE-2023-42793.md](../2023/CVE-2023-42793-Zenmovie_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity实例需要开启网络访问，且版本低于2023.05.4。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的远程攻击者绕过身份验证，并在服务器上执行任意代码。根据漏洞库信息，CVSS评分为9.8（严重）。

**利用方式：**

1.  **身份验证绕过：** 攻击者利用未经身份验证的REST API端点`/app/rest/users/id:1/tokens/RPC2`来获取一个有效的Bearer Token。这个Token最初的设计目的是允许用户通过API管理自己的Token。
2.  **修改内部属性：** 使用获取的Token，通过POST请求访问`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`修改内部属性，启用`rest.debug.processes.enable`，此步骤为后续RCE做准备。
3.  **远程代码执行：**  利用被启用的REST API端点`/app/rest/debug/processes?exePath=${COMMAND}`，通过`exePath`参数执行任意命令。该端点在正常情况下只允许经过身份验证的管理员访问，但由于身份验证绕过，未经授权的攻击者可以利用它。

**POC有效性：**

提供的POC代码包含两个脚本：`CVE-2023-42793_admin.sh`和`CVE-2023-42793_rce.sh`。

*   `CVE-2023-42793_admin.sh`脚本利用漏洞创建一个新的管理员用户（Zenmovie/Zenmovie），方便后续访问TeamCity。
*   `CVE-2023-42793_rce.sh`脚本利用漏洞执行指定的命令，并返回命令输出。

从提供的README.md中的截图以及漏洞原理来看，POC代码是有效的，可以成功利用该漏洞。

**投毒风险：**

评估投毒风险，需考虑作者是否有意在代码中添加恶意功能。

1.  **代码混淆/隐藏：** 代码没有进行明显的混淆。虽然使用了`grep`和`awk`提取Token和命令输出，但是属于正常利用。
2.  **恶意依赖：** 代码没有引入外部依赖。
3.  **后门代码：** 代码的主要功能是利用漏洞，创建管理员账户或执行命令。没有发现明显与漏洞利用无关的恶意代码，例如反弹shell、上传文件等。
4.  **隐蔽指令：**  检查代码中是否存在不易察觉的指令，例如通过环境变量、时间等触发的恶意行为。没有发现此类指令。

尽管POC的主要功能是漏洞利用，仍存在一定的投毒风险。例如，攻击者可能修改`CVE-2023-42793_rce.sh`脚本，在执行目标命令之前，先执行一些恶意操作，例如下载并执行恶意程序，添加后门账户等。这种风险很难通过静态分析完全排除，需要进行动态分析，实际运行poc代码进行监控。

因此，综合考虑，投毒风险评估为10%。这个风险主要来源于用户下载和使用POC时，可能会下载到被篡改过的恶意版本。

**结论：**

CVE-2023-42793是一个高危漏洞，利用简单，影响范围广。建议受影响的用户尽快升级到最新版本。在使用公开的POC代码时，务必谨慎，进行代码审计，并确保从可信来源下载。

**项目地址:** [Zenmovie/CVE-2023-42793](https://github.com/Zenmovie/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #9

**来源**: [CVE-2023-42793-becrevex_CVE-2023-42793.md](../2023/CVE-2023-42793-becrevex_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个认证绕过漏洞，攻击者无需认证即可利用此漏洞在TeamCity服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8，属于高危漏洞，并且已被积极利用。多家安全公司和组织（例如Rapid7，Fortinet，Microsoft，CISA）都发布了关于该漏洞的分析和利用报告，甚至有APT组织（APT29，北朝鲜黑客组织）利用该漏洞进行攻击。

提供的POC代码是一个Nmap脚本，用于检测目标TeamCity服务器是否存在CVE-2023-42793漏洞。该脚本通过向`/app/rest/users/id:1/tokens/RPC2`路径发送POST请求，尝试创建一个新的用户令牌，如果服务器返回200状态码且包含一个令牌，则表明服务器存在漏洞。该脚本本身的行为是良性的，只是用于验证漏洞的存在，没有发现任何投毒代码。

**有效性：**
根据提供的漏洞信息和POC代码，该POC代码有效，可以用于检测目标是否存在CVE-2023-42793漏洞。

**投毒风险：**
对提供的Nmap脚本进行了分析，没有发现任何明显的投毒代码。脚本的功能明确，即检测TeamCity服务器上的漏洞，没有发现任何恶意行为。风险评估为0%

**利用方式：**
1.  攻击者利用未授权访问漏洞，绕过身份验证。
2.  攻击者发送特制请求，例如向`/app/rest/users/id:1/tokens/RPC2`路径创建用户Token。
3.  成功创建Token后，攻击者获得管理员权限。
4.  利用管理员权限执行任意代码，实现远程代码执行。

该漏洞利用简单，影响严重，建议TeamCity用户尽快升级到2023.05.4或更高版本。

**项目地址:** [becrevex/CVE-2023-42793](https://github.com/becrevex/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #10

**来源**: [CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md](../2023/CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** JetBrains TeamCity

**危害等级:** 极高，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可从网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity 2023.05.4之前版本中存在的一个身份验证绕过漏洞，可能导致未经身份验证的远程代码执行。根据漏洞库信息，此漏洞的CVSS评分为9.8，属于严重级别。多个搜索结果表明，该漏洞已被积极利用，甚至被APT组织利用进行攻击。提供的POC代码是一个Python脚本，它利用漏洞执行远程命令。

**利用方式：**

1.  **身份验证绕过：** 该漏洞允许攻击者绕过TeamCity服务器的身份验证机制。
2.  **获取Bearer Token：** 利用未经身份验证的访问，通过`/app/rest/users/id:1/tokens/RPC2`端点创建一个临时的Bearer Token。
3.  **启用调试模式：** 使用获得的Bearer Token，通过`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`端点启用调试模式，即`rest.debug.processes.enable=true`。
4.  **远程代码执行：** 使用获得的Bearer Token，通过`/app/rest/debug/processes`端点执行任意命令。POC使用bash反弹shell，通过URL编码将命令传递给目标服务器。

**有效性评估：**

提供的POC代码看起来是有效的。它利用了TeamCity REST API中的漏洞，绕过身份验证并执行任意代码。 脚本首先尝试获取一个临时的Bearer Token，然后使用该Token来修改`internal.properties`文件以启用调试模式。最后，脚本使用调试模式来执行远程代码。 脚本的`README.md`文件中提供的参考链接也支持了该漏洞的存在和可利用性。搜索结果中大量的安全厂商报告和分析也证实了此漏洞的真实性和高危性。

**投毒风险评估：**

分析POC代码没有发现明显的投毒代码。脚本的功能主要集中在利用漏洞进行远程代码执行，没有发现额外的恶意行为或后门。该脚本的功能与漏洞描述以及利用方式相符，未发现任何异常行为。因此，投毒风险评估为0%。

**项目地址:** [hotplugin0x01/CVE-2023-42793](https://github.com/hotplugin0x01/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #11

**来源**: [CVE-2023-42793-jakehomb_cve-2023-42793.md](../2023/CVE-2023-42793-jakehomb_cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器版本低于2023.05.4，且可通过HTTP(S)访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2023-42793 允许未经身份验证的攻击者在 TeamCity 服务器上执行远程代码。该漏洞利用方式是通过绕过身份验证机制，直接访问受保护的资源并执行恶意操作。

**有效性：**
根据提供的漏洞信息、搜索结果以及漏洞利用代码，可以判断该漏洞的 POC 代码有效。CVE 详情中提到存在身份验证绕过导致 RCE，搜索结果也表明该漏洞存在公开可用的exploit，并且已经被APT29等恶意行为者利用。

**投毒风险：**
提供的漏洞利用代码主要由两部分组成：获取 Token 和创建用户。getToken 函数尝试从 /app/rest/users/id:1/token/RPC2 获取一个 Token，createUser 函数使用这个 Token 来创建一个具有管理员权限的用户。代码本身功能明确，没有发现隐藏的恶意代码。因此，评估该仓库中存在作者隐藏的投毒代码的风险为0%。

**利用方式：**
1.  **目标探测：** 确定目标 TeamCity 服务器的版本是否低于 2023.05.4。
2.  **Token 获取：** 使用 `getToken` 函数，通过向 `https://<teamcity_url>/app/rest/users/id:1/token/RPC2` 发送 GET 请求，尝试获取一个 Token。服务器无需授权即可响应。  `extractToken` 函数从响应中提取 Token。
3.  **用户创建：** 使用 `createUser` 函数，携带上一步获取的 Token，向 `https://<teamcity_url>/app/rest/users` 发送 POST 请求，创建一个具有 SYSTEM_ADMIN 角色的新用户。请求的 Body 为包含用户名、密码和邮箱的JSON格式。
4.  **权限提升：** 使用新创建的管理员用户登录 TeamCity 服务器，获得完全控制权限，从而执行任意代码。

**项目地址:** [jakehomb/cve-2023-42793](https://github.com/jakehomb/cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #12

**来源**: [CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md](../2023/CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行远程代码。该漏洞影响2023.05.4之前的版本。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的，并且已被广泛利用。CISA已将其添加到已知被利用漏洞目录中。搜索引擎结果中多个安全厂商的博客也证实了该漏洞的有效性。

**投毒风险：**
提供的PoC代码本身的功能是利用漏洞创建新的管理员用户。`README.md`文件描述了脚本的功能，与代码行为一致。代码中对创建的用户名称添加了随机数，并会写入 `vulnerable.txt` 文件。 `vulnerable.txt`文件可能存在信息泄露的风险,如果被攻击者获取，可能结合其他漏洞使用。总体来看，该PoC代码存在投毒风险的可能性较低，约为10%。

**利用方式：**
1.  **删除用户令牌：** PoC首先尝试删除ID为1的用户令牌 (通常是管理员)。
2.  **创建用户令牌：** 如果删除成功或不存在，PoC会尝试为ID为1的用户创建一个新的用户令牌。
3.  **创建管理员用户：** 使用新创建的用户令牌，PoC会创建一个具有`SYSTEM_ADMIN`权限的新用户，用户名和密码是硬编码的（用户名以 `_secops` 开头，加上随机数，密码是 `changeme`）。
4.  **利用新用户登录：** 攻击者可以使用新创建的管理员帐户登录TeamCity服务器，从而完全控制该服务器。
5.  **自动化攻击:** 通过-u指定url或者-l指定url列表，实现批量攻击。

**项目地址:** [johnossawy/CVE-2023-42793_POC](https://github.com/johnossawy/CVE-2023-42793_POC)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #13

**来源**: [CVE-2023-42793-junnythemarksman_CVE-2023-42793.md](../2023/CVE-2023-42793-junnythemarksman_CVE-2023-42793.md)

# CVE-2023-42793

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md](../2023/CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md)

## CVE-2023-42793 - TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个身份验证绕过漏洞，未经身份验证的攻击者可以通过发送特制的 HTTP 请求绕过身份验证，从而创建管理员账户并最终实现远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果中多个链接都提到了该漏洞被积极利用，包括APT组织。漏洞利用代码提供了创建管理员账户和执行RCE的脚本，并且说明了如何利用该漏洞，包括如何获取反向shell。

**投毒风险：**
分析提供的`exploit.py`和`rce_exploit.py`，主要功能是创建管理员账户和执行任意命令。脚本本身的代码逻辑相对简单，没有明显的恶意代码。其中`exploit.py`会生成随机用户名、密码和邮箱地址，这可能被误认为恶意行为，但这是为了方便利用而设计的，并非投毒。`rce_exploit.py`脚本依赖于第一个脚本创建的token文件。虽然没有发现明显的后门代码，但仍存在极小的风险，例如在生成随机字符串时引入偏差，虽然可能性极小，但理论上存在被利用的可能性，将投毒风险评定为5%。

**利用方式：**
1.  **身份验证绕过：** 攻击者首先利用身份验证绕过漏洞，该漏洞允许未经身份验证的攻击者与TeamCity服务器进行交互，绕过正常的身份验证流程。
2.  **创建管理员账户：** 使用 `exploit.py` 脚本，通过发送特制的 POST 请求，在 TeamCity 服务器上创建一个新的管理员账户。可以指定用户名、密码和邮箱，也可以使用随机生成的凭据。成功创建后，会将凭据保存到token文件中。
3.  **远程代码执行：** 使用 `rce.py` 脚本，该脚本首先启用debug processes，然后利用创建的管理员账户，通过 TeamCity 的 API 接口执行任意命令。可以执行系统命令，例如 `whoami`，也可以获取反向 shell，从而完全控制服务器。
4.  **反向Shell:** 利用rce.py执行命令，通过反弹shell到攻击者机器上，来获取服务器的控制权。


**项目地址:** [B4l3rI0n/CVE-2023-42793](https://github.com/B4l3rI0n/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #2

**来源**: [CVE-2023-42793-FlojBoj_CVE-2023-42793.md](../2023/CVE-2023-42793-FlojBoj_CVE-2023-42793.md)

## CVE-2023-42793-JetBrainsTeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可能导致远程代码执行和完全控制TeamCity服务器

**影响版本:** < 2023.05.4

**利用条件:** 需要能够通过HTTP(S)访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，攻击者无需身份验证即可执行远程代码。漏洞利用方式如下：

1.  **有效性：** 漏洞信息和搜索结果表明该漏洞已在野外被积极利用，包括APT组织（如APT29、CozyBear、北朝鲜黑客组织）和俄罗斯情报部门SVR。提供的代码`exploit.py`旨在利用此漏洞创建管理员账户或获取现有用户的token，从而控制TeamCity服务器。根据README.md的描述，还有一个`rce.py`脚本可以执行远程命令，但主脚本`exploit.py`的功能是创建管理员账户。

2.  **投毒风险：** 代码`exploit.py`本身的功能是利用漏洞创建管理员用户或获取token。投毒风险评估如下：
    *   代码中存在一些硬编码，例如默认密码"Password@123"和默认邮箱域名"@lol.omg"，如果直接使用这些默认值，容易被检测和防御。但这不属于投毒，而是简化使用的示例。
    *   代码尝试首先获取或删除现有的token，这增加了攻击成功的概率，但也可能在目标环境中留下痕迹。
    *   总体来看，`exploit.py`的主要风险在于被滥用以非法控制TeamCity服务器，而非恶意代码本身。因此，投毒风险较低，估计为10%。主要是担心引入了额外的请求或命令，用于收集用户信息或执行其他未经授权的操作。

3.  **利用方式：** 利用方式主要分为以下步骤：
    a.  攻击者发送特制的HTTP请求到TeamCity服务器，绕过身份验证。
    b.  使用`exploit.py`脚本，指定目标TeamCity服务器的URL。
    c.  脚本尝试获取或删除现有的token，然后创建一个新的管理员用户，或者获取指定用户的token。
    d.  如果成功创建管理员用户，攻击者可以使用新创建的管理员账户登录TeamCity服务器，并获得完全控制权限。
    e. 通过获取到的token, 攻击者可以模拟用户身份，从而执行相关操作。

该漏洞的严重性在于未经身份验证即可创建管理员帐户并执行任意代码，从而完全控制受影响的TeamCity服务器。缓解措施包括尽快升级到2023.05.4或更高版本。

**项目地址:** [FlojBoj/CVE-2023-42793](https://github.com/FlojBoj/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #3

**来源**: [CVE-2023-42793-H454NSec_CVE-2023-42793.md](../2023/CVE-2023-42793-H454NSec_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从攻击者控制的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 漏洞存在于JetBrains TeamCity 2023.05.4 之前的版本中，允许未经身份验证的攻击者绕过身份验证，最终实现远程代码执行。根据漏洞库信息，该漏洞的 CVSS 3.1 评分为 9.8，属于严重级别。搜索结果表明，该漏洞已被广泛利用，甚至被 APT 组织用于攻击活动。 

**漏洞利用方式：**

1.  **身份验证绕过：** 漏洞利用代码通过发送特制的 HTTP 请求来绕过 TeamCity 的身份验证机制。具体利用细节需要分析补丁或者参考其他分析报告。
2.  **创建管理员用户：** 漏洞利用代码首先删除 id 为 1 的用户的token，然后创建一个新的用户 token。使用这个 token，攻击者可以创建一个具有管理员权限的新用户。新用户的用户名和密码可以通过命令行参数指定，默认用户名为 `H454NSec[随机数]`，密码为 `@H454NSec`。利用成功后，即可使用创建的管理员用户登录TeamCity控制台。
3.  **远程代码执行：** 通过管理员权限，攻击者可以在 TeamCity 服务器上执行任意代码，实现远程控制。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确定该 POC 代码是有效的。漏洞已被公开披露且有可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。风险分析如下：

*   **代码结构：** 代码结构相对清晰，主要功能是利用漏洞创建管理员用户。
*   **可疑行为：** 代码中存在以下潜在风险：
    *   **默认用户名和密码：** 使用默认的用户名和密码 `@H454NSec` 创建管理员帐户，这可能会让其他攻击者更容易入侵，或者导致安全审计告警。
    *   **硬编码的 User-Agent：**  User-Agent头 `Mozilla/5.0 (https://github.com/H454NSec/CVE-2023-42793) Gecko/20100101 Firefox/113.0`  可能被用于追踪攻击源。但同时也降低了攻击的隐蔽性。
    *   **未处理异常：** 虽然代码有异常处理，但仅仅是简单的`pass`，可能会隐藏一些错误信息，增加调试难度。
*   **高危操作：**  漏洞利用本身就是高危操作，如果攻击者通过修改poc加入恶意命令，将会造成严重危害，例如植入后门。

综合考虑以上因素，该 POC 代码的投毒风险评估为 10%。主要风险在于攻击者可能利用该代码进行二次修改，加入恶意代码或后门，从而扩大攻击范围。

**项目地址:** [H454NSec/CVE-2023-42793](https://github.com/H454NSec/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #4

**来源**: [CVE-2023-42793-HusenjanDev_CVE-2023-42793.md](../2023/CVE-2023-42793-HusenjanDev_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从网络访问，需要通过其他途径获取TeamCity Token。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，允许未经身份验证的攻击者通过HTTP(S)访问TeamCity服务器，并执行远程代码。根据漏洞库信息，CVSS评分为9.8，属于严重级别。搜索引擎结果显示，该漏洞已被多个APT组织利用，包括APT29、北朝鲜的Diamond Sleet和Onyx Sleet以及俄罗斯对外情报局 (SVR)，显示其真实性和危害性。Rapid7的博客文章也详细分析了该漏洞。提供的POC代码的利用方式是：

1.  **获取TeamCity Token:**  `readme.md` 中提到，需要通过其他漏洞或者方式获取TeamCity的Token. 这是利用此POC的前提。
2.  **启用调试模式:** 使用curl命令发送POST请求到`/admin/dataDir.html`，修改`config/internal.properties`文件，启用`rest.debug.processes.enable=true`，从而开启调试模式。这一步通过token进行验证。
3.  **构造反弹shell Payload:**  将反弹shell命令进行URL编码，目标是让受害者主机连接攻击者的Netcat监听器。
4.  **执行远程命令:** 使用curl命令发送POST请求到`/app/rest/debug/processes`，指定`exePath`为`/bin/bash`，`params`为`-c`和URL编码后的反弹shell命令。这个请求同样需要token验证。漏洞利用依赖于已获取的TeamCity token，然后通过启用调试模式执行反弹shell。根据分析，该POC代码没有明显的投毒行为。

**项目地址:** [HusenjanDev/CVE-2023-42793](https://github.com/HusenjanDev/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #5

**来源**: [CVE-2023-42793-LeHeron_TC_test.md](../2023/CVE-2023-42793-LeHeron_TC_test.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个严重的身份验证绕过漏洞，攻击者无需身份验证即可在 TeamCity 服务器上执行远程代码。根据漏洞信息和搜索结果，该漏洞已被积极利用，甚至APT组织，如CozyBear，以及北朝鲜的APT组织都在利用该漏洞。 

**有效性：**
根据搜索结果，此漏洞已经存在公开的利用代码，且已被广泛利用，证明漏洞有效。

**投毒风险：**
提供的漏洞利用代码 `/tmp/da0475f0898b55e5196bf0f36ac9d45e/README`  只是一个简单的README文件，内容为 “Hello World”，不包含任何可执行代码或恶意指令。投毒的可能性极低，可以认为几乎不存在，给到1%的可能也只是对未知风险的保留。

**利用方式：**
根据漏洞描述，攻击者可以通过未授权访问TeamCity服务器，从而执行任意代码。具体的利用方式可能涉及到构造特定的HTTP请求绕过身份验证机制，然后利用TeamCity服务器的功能执行恶意命令。参考Rapid7的博客文章，该漏洞利用可能与特定的端点和参数有关，允许攻击者创建管理员用户或直接执行代码。 从搜索结果来看，该漏洞已经成为恶意行为者的攻击目标，建议尽快升级到安全版本。

**项目地址:** [LeHeron/TC_test](https://github.com/LeHeron/TC_test)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #6

**来源**: [CVE-2023-42793-StanleyJobsonAU_GhostTown.md](../2023/CVE-2023-42793-StanleyJobsonAU_GhostTown.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个身份验证绕过漏洞，允许未经身份验证的攻击者远程执行代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8（严重），并且已被积极利用。搜索结果表明，包括APT29、朝鲜黑客组织以及俄罗斯对外情报局（SVR）等多个威胁组织都在利用此漏洞。提供的POC代码 `GhostTown.py` 旨在利用此漏洞。利用方式如下：

1.  **生成管理员Token：** POC首先尝试通过 `/app/rest/users/id:1/tokens/RPC2` 接口创建一个管理员Token。这将绕过身份验证。
2.  **检索内部配置：** 使用生成的管理员Token，POC尝试从 `/get/file/dataDir/config/internal.properties` 接口检索TeamCity的内部配置。
3.  **更新配置：** POC会检查配置项中是否包含 `rest.debug.processes.enable=true`，如果不存在，则将其添加到配置项中，并通过 `/get/file/dataDir/config/internal.properties` 接口更新配置。`rest.debug.processes.enable=true` 配置的目的是允许执行调试进程，这为远程代码执行铺平了道路。(这部分未在提供的代码片段中。)
4. **远程代码执行：** 启用调试进程允许攻击者通过构造特定的请求来执行任意命令。

**有效性：** 根据漏洞信息和搜索结果，此POC代码有效，能够利用CVE-2023-42793漏洞实现RCE。

**投毒风险：** 检查提供的代码，主要逻辑集中在利用漏洞上，没有发现明显的恶意代码或后门。该代码是为了验证漏洞存在，并帮助安全研究人员和管理员修复漏洞，存在投毒代码的可能性较低。


**项目地址:** [StanleyJobsonAU/GhostTown](https://github.com/StanleyJobsonAU/GhostTown)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #7

**来源**: [CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md](../2023/CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器，且目标版本低于2023.05.4

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 存在于 JetBrains TeamCity 2023.05.4 之前的版本中，是一个身份验证绕过漏洞，可以导致未经身份验证的远程代码执行。攻击者可以利用此漏洞在 TeamCity 服务器上执行任意代码，从而完全控制服务器。漏洞利用方式如下：

1.  **身份验证绕过：** 利用漏洞绕过身份验证。
2.  **启用调试模式：** 通过修改 `internal.properties` 文件启用 `rest.debug.processes.enable`。
3.  **远程代码执行：** 使用 `/app/rest/debug/processes` 接口执行任意命令。脚本通过修改 `internal.properties` 文件，然后使用特制的请求调用 `debug/processes` 接口，从而在目标系统上执行任意命令。

提供的 `TeamCity.sh` 脚本允许用户指定目标操作系统 (Linux 或 Windows)，并相应地调整命令执行方式。脚本首先获取一个token，然后利用该 token 修改`internal.properties`文件以启用调试模式，最后使用构造好的包含恶意命令的URL来触发RCE。

投毒风险评估：代码中主要逻辑为漏洞利用，并未发现明显的恶意代码。`TeamCity.sh` 中选择目标OS后，Linux环境使用了`base64`编码命令，Windows没有。虽然脚本的行为符合漏洞利用的预期，但是如果攻击者对`base64` 编码方式做了手脚，有可能在Linux执行的时候插入恶意命令。`TeamCity2.sh` 脚本对命令进行URL编码，windows只支持powershell, 可以对powershell添加恶意payload. 因此，存在一定的投毒风险，估计在10%左右。

**项目地址:** [SwiftSecur/teamcity-exploit-cve-2023-42793](https://github.com/SwiftSecur/teamcity-exploit-cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #8

**来源**: [CVE-2023-42793-Zenmovie_CVE-2023-42793.md](../2023/CVE-2023-42793-Zenmovie_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity实例需要开启网络访问，且版本低于2023.05.4。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的远程攻击者绕过身份验证，并在服务器上执行任意代码。根据漏洞库信息，CVSS评分为9.8（严重）。

**利用方式：**

1.  **身份验证绕过：** 攻击者利用未经身份验证的REST API端点`/app/rest/users/id:1/tokens/RPC2`来获取一个有效的Bearer Token。这个Token最初的设计目的是允许用户通过API管理自己的Token。
2.  **修改内部属性：** 使用获取的Token，通过POST请求访问`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`修改内部属性，启用`rest.debug.processes.enable`，此步骤为后续RCE做准备。
3.  **远程代码执行：**  利用被启用的REST API端点`/app/rest/debug/processes?exePath=${COMMAND}`，通过`exePath`参数执行任意命令。该端点在正常情况下只允许经过身份验证的管理员访问，但由于身份验证绕过，未经授权的攻击者可以利用它。

**POC有效性：**

提供的POC代码包含两个脚本：`CVE-2023-42793_admin.sh`和`CVE-2023-42793_rce.sh`。

*   `CVE-2023-42793_admin.sh`脚本利用漏洞创建一个新的管理员用户（Zenmovie/Zenmovie），方便后续访问TeamCity。
*   `CVE-2023-42793_rce.sh`脚本利用漏洞执行指定的命令，并返回命令输出。

从提供的README.md中的截图以及漏洞原理来看，POC代码是有效的，可以成功利用该漏洞。

**投毒风险：**

评估投毒风险，需考虑作者是否有意在代码中添加恶意功能。

1.  **代码混淆/隐藏：** 代码没有进行明显的混淆。虽然使用了`grep`和`awk`提取Token和命令输出，但是属于正常利用。
2.  **恶意依赖：** 代码没有引入外部依赖。
3.  **后门代码：** 代码的主要功能是利用漏洞，创建管理员账户或执行命令。没有发现明显与漏洞利用无关的恶意代码，例如反弹shell、上传文件等。
4.  **隐蔽指令：**  检查代码中是否存在不易察觉的指令，例如通过环境变量、时间等触发的恶意行为。没有发现此类指令。

尽管POC的主要功能是漏洞利用，仍存在一定的投毒风险。例如，攻击者可能修改`CVE-2023-42793_rce.sh`脚本，在执行目标命令之前，先执行一些恶意操作，例如下载并执行恶意程序，添加后门账户等。这种风险很难通过静态分析完全排除，需要进行动态分析，实际运行poc代码进行监控。

因此，综合考虑，投毒风险评估为10%。这个风险主要来源于用户下载和使用POC时，可能会下载到被篡改过的恶意版本。

**结论：**

CVE-2023-42793是一个高危漏洞，利用简单，影响范围广。建议受影响的用户尽快升级到最新版本。在使用公开的POC代码时，务必谨慎，进行代码审计，并确保从可信来源下载。

**项目地址:** [Zenmovie/CVE-2023-42793](https://github.com/Zenmovie/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #9

**来源**: [CVE-2023-42793-becrevex_CVE-2023-42793.md](../2023/CVE-2023-42793-becrevex_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个认证绕过漏洞，攻击者无需认证即可利用此漏洞在TeamCity服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8，属于高危漏洞，并且已被积极利用。多家安全公司和组织（例如Rapid7，Fortinet，Microsoft，CISA）都发布了关于该漏洞的分析和利用报告，甚至有APT组织（APT29，北朝鲜黑客组织）利用该漏洞进行攻击。

提供的POC代码是一个Nmap脚本，用于检测目标TeamCity服务器是否存在CVE-2023-42793漏洞。该脚本通过向`/app/rest/users/id:1/tokens/RPC2`路径发送POST请求，尝试创建一个新的用户令牌，如果服务器返回200状态码且包含一个令牌，则表明服务器存在漏洞。该脚本本身的行为是良性的，只是用于验证漏洞的存在，没有发现任何投毒代码。

**有效性：**
根据提供的漏洞信息和POC代码，该POC代码有效，可以用于检测目标是否存在CVE-2023-42793漏洞。

**投毒风险：**
对提供的Nmap脚本进行了分析，没有发现任何明显的投毒代码。脚本的功能明确，即检测TeamCity服务器上的漏洞，没有发现任何恶意行为。风险评估为0%

**利用方式：**
1.  攻击者利用未授权访问漏洞，绕过身份验证。
2.  攻击者发送特制请求，例如向`/app/rest/users/id:1/tokens/RPC2`路径创建用户Token。
3.  成功创建Token后，攻击者获得管理员权限。
4.  利用管理员权限执行任意代码，实现远程代码执行。

该漏洞利用简单，影响严重，建议TeamCity用户尽快升级到2023.05.4或更高版本。

**项目地址:** [becrevex/CVE-2023-42793](https://github.com/becrevex/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #10

**来源**: [CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md](../2023/CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** JetBrains TeamCity

**危害等级:** 极高，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可从网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity 2023.05.4之前版本中存在的一个身份验证绕过漏洞，可能导致未经身份验证的远程代码执行。根据漏洞库信息，此漏洞的CVSS评分为9.8，属于严重级别。多个搜索结果表明，该漏洞已被积极利用，甚至被APT组织利用进行攻击。提供的POC代码是一个Python脚本，它利用漏洞执行远程命令。

**利用方式：**

1.  **身份验证绕过：** 该漏洞允许攻击者绕过TeamCity服务器的身份验证机制。
2.  **获取Bearer Token：** 利用未经身份验证的访问，通过`/app/rest/users/id:1/tokens/RPC2`端点创建一个临时的Bearer Token。
3.  **启用调试模式：** 使用获得的Bearer Token，通过`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`端点启用调试模式，即`rest.debug.processes.enable=true`。
4.  **远程代码执行：** 使用获得的Bearer Token，通过`/app/rest/debug/processes`端点执行任意命令。POC使用bash反弹shell，通过URL编码将命令传递给目标服务器。

**有效性评估：**

提供的POC代码看起来是有效的。它利用了TeamCity REST API中的漏洞，绕过身份验证并执行任意代码。 脚本首先尝试获取一个临时的Bearer Token，然后使用该Token来修改`internal.properties`文件以启用调试模式。最后，脚本使用调试模式来执行远程代码。 脚本的`README.md`文件中提供的参考链接也支持了该漏洞的存在和可利用性。搜索结果中大量的安全厂商报告和分析也证实了此漏洞的真实性和高危性。

**投毒风险评估：**

分析POC代码没有发现明显的投毒代码。脚本的功能主要集中在利用漏洞进行远程代码执行，没有发现额外的恶意行为或后门。该脚本的功能与漏洞描述以及利用方式相符，未发现任何异常行为。因此，投毒风险评估为0%。

**项目地址:** [hotplugin0x01/CVE-2023-42793](https://github.com/hotplugin0x01/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #11

**来源**: [CVE-2023-42793-jakehomb_cve-2023-42793.md](../2023/CVE-2023-42793-jakehomb_cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器版本低于2023.05.4，且可通过HTTP(S)访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2023-42793 允许未经身份验证的攻击者在 TeamCity 服务器上执行远程代码。该漏洞利用方式是通过绕过身份验证机制，直接访问受保护的资源并执行恶意操作。

**有效性：**
根据提供的漏洞信息、搜索结果以及漏洞利用代码，可以判断该漏洞的 POC 代码有效。CVE 详情中提到存在身份验证绕过导致 RCE，搜索结果也表明该漏洞存在公开可用的exploit，并且已经被APT29等恶意行为者利用。

**投毒风险：**
提供的漏洞利用代码主要由两部分组成：获取 Token 和创建用户。getToken 函数尝试从 /app/rest/users/id:1/token/RPC2 获取一个 Token，createUser 函数使用这个 Token 来创建一个具有管理员权限的用户。代码本身功能明确，没有发现隐藏的恶意代码。因此，评估该仓库中存在作者隐藏的投毒代码的风险为0%。

**利用方式：**
1.  **目标探测：** 确定目标 TeamCity 服务器的版本是否低于 2023.05.4。
2.  **Token 获取：** 使用 `getToken` 函数，通过向 `https://<teamcity_url>/app/rest/users/id:1/token/RPC2` 发送 GET 请求，尝试获取一个 Token。服务器无需授权即可响应。  `extractToken` 函数从响应中提取 Token。
3.  **用户创建：** 使用 `createUser` 函数，携带上一步获取的 Token，向 `https://<teamcity_url>/app/rest/users` 发送 POST 请求，创建一个具有 SYSTEM_ADMIN 角色的新用户。请求的 Body 为包含用户名、密码和邮箱的JSON格式。
4.  **权限提升：** 使用新创建的管理员用户登录 TeamCity 服务器，获得完全控制权限，从而执行任意代码。

**项目地址:** [jakehomb/cve-2023-42793](https://github.com/jakehomb/cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #12

**来源**: [CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md](../2023/CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行远程代码。该漏洞影响2023.05.4之前的版本。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的，并且已被广泛利用。CISA已将其添加到已知被利用漏洞目录中。搜索引擎结果中多个安全厂商的博客也证实了该漏洞的有效性。

**投毒风险：**
提供的PoC代码本身的功能是利用漏洞创建新的管理员用户。`README.md`文件描述了脚本的功能，与代码行为一致。代码中对创建的用户名称添加了随机数，并会写入 `vulnerable.txt` 文件。 `vulnerable.txt`文件可能存在信息泄露的风险,如果被攻击者获取，可能结合其他漏洞使用。总体来看，该PoC代码存在投毒风险的可能性较低，约为10%。

**利用方式：**
1.  **删除用户令牌：** PoC首先尝试删除ID为1的用户令牌 (通常是管理员)。
2.  **创建用户令牌：** 如果删除成功或不存在，PoC会尝试为ID为1的用户创建一个新的用户令牌。
3.  **创建管理员用户：** 使用新创建的用户令牌，PoC会创建一个具有`SYSTEM_ADMIN`权限的新用户，用户名和密码是硬编码的（用户名以 `_secops` 开头，加上随机数，密码是 `changeme`）。
4.  **利用新用户登录：** 攻击者可以使用新创建的管理员帐户登录TeamCity服务器，从而完全控制该服务器。
5.  **自动化攻击:** 通过-u指定url或者-l指定url列表，实现批量攻击。

**项目地址:** [johnossawy/CVE-2023-42793_POC](https://github.com/johnossawy/CVE-2023-42793_POC)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #13

**来源**: [CVE-2023-42793-junnythemarksman_CVE-2023-42793.md](../2023/CVE-2023-42793-junnythemarksman_CVE-2023-42793.md)

# CVE-2023-42793

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md](../2023/CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md)

## CVE-2023-42793 - TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个身份验证绕过漏洞，未经身份验证的攻击者可以通过发送特制的 HTTP 请求绕过身份验证，从而创建管理员账户并最终实现远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果中多个链接都提到了该漏洞被积极利用，包括APT组织。漏洞利用代码提供了创建管理员账户和执行RCE的脚本，并且说明了如何利用该漏洞，包括如何获取反向shell。

**投毒风险：**
分析提供的`exploit.py`和`rce_exploit.py`，主要功能是创建管理员账户和执行任意命令。脚本本身的代码逻辑相对简单，没有明显的恶意代码。其中`exploit.py`会生成随机用户名、密码和邮箱地址，这可能被误认为恶意行为，但这是为了方便利用而设计的，并非投毒。`rce_exploit.py`脚本依赖于第一个脚本创建的token文件。虽然没有发现明显的后门代码，但仍存在极小的风险，例如在生成随机字符串时引入偏差，虽然可能性极小，但理论上存在被利用的可能性，将投毒风险评定为5%。

**利用方式：**
1.  **身份验证绕过：** 攻击者首先利用身份验证绕过漏洞，该漏洞允许未经身份验证的攻击者与TeamCity服务器进行交互，绕过正常的身份验证流程。
2.  **创建管理员账户：** 使用 `exploit.py` 脚本，通过发送特制的 POST 请求，在 TeamCity 服务器上创建一个新的管理员账户。可以指定用户名、密码和邮箱，也可以使用随机生成的凭据。成功创建后，会将凭据保存到token文件中。
3.  **远程代码执行：** 使用 `rce.py` 脚本，该脚本首先启用debug processes，然后利用创建的管理员账户，通过 TeamCity 的 API 接口执行任意命令。可以执行系统命令，例如 `whoami`，也可以获取反向 shell，从而完全控制服务器。
4.  **反向Shell:** 利用rce.py执行命令，通过反弹shell到攻击者机器上，来获取服务器的控制权。


**项目地址:** [B4l3rI0n/CVE-2023-42793](https://github.com/B4l3rI0n/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #2

**来源**: [CVE-2023-42793-FlojBoj_CVE-2023-42793.md](../2023/CVE-2023-42793-FlojBoj_CVE-2023-42793.md)

## CVE-2023-42793-JetBrainsTeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可能导致远程代码执行和完全控制TeamCity服务器

**影响版本:** < 2023.05.4

**利用条件:** 需要能够通过HTTP(S)访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，攻击者无需身份验证即可执行远程代码。漏洞利用方式如下：

1.  **有效性：** 漏洞信息和搜索结果表明该漏洞已在野外被积极利用，包括APT组织（如APT29、CozyBear、北朝鲜黑客组织）和俄罗斯情报部门SVR。提供的代码`exploit.py`旨在利用此漏洞创建管理员账户或获取现有用户的token，从而控制TeamCity服务器。根据README.md的描述，还有一个`rce.py`脚本可以执行远程命令，但主脚本`exploit.py`的功能是创建管理员账户。

2.  **投毒风险：** 代码`exploit.py`本身的功能是利用漏洞创建管理员用户或获取token。投毒风险评估如下：
    *   代码中存在一些硬编码，例如默认密码"Password@123"和默认邮箱域名"@lol.omg"，如果直接使用这些默认值，容易被检测和防御。但这不属于投毒，而是简化使用的示例。
    *   代码尝试首先获取或删除现有的token，这增加了攻击成功的概率，但也可能在目标环境中留下痕迹。
    *   总体来看，`exploit.py`的主要风险在于被滥用以非法控制TeamCity服务器，而非恶意代码本身。因此，投毒风险较低，估计为10%。主要是担心引入了额外的请求或命令，用于收集用户信息或执行其他未经授权的操作。

3.  **利用方式：** 利用方式主要分为以下步骤：
    a.  攻击者发送特制的HTTP请求到TeamCity服务器，绕过身份验证。
    b.  使用`exploit.py`脚本，指定目标TeamCity服务器的URL。
    c.  脚本尝试获取或删除现有的token，然后创建一个新的管理员用户，或者获取指定用户的token。
    d.  如果成功创建管理员用户，攻击者可以使用新创建的管理员账户登录TeamCity服务器，并获得完全控制权限。
    e. 通过获取到的token, 攻击者可以模拟用户身份，从而执行相关操作。

该漏洞的严重性在于未经身份验证即可创建管理员帐户并执行任意代码，从而完全控制受影响的TeamCity服务器。缓解措施包括尽快升级到2023.05.4或更高版本。

**项目地址:** [FlojBoj/CVE-2023-42793](https://github.com/FlojBoj/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #3

**来源**: [CVE-2023-42793-H454NSec_CVE-2023-42793.md](../2023/CVE-2023-42793-H454NSec_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从攻击者控制的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 漏洞存在于JetBrains TeamCity 2023.05.4 之前的版本中，允许未经身份验证的攻击者绕过身份验证，最终实现远程代码执行。根据漏洞库信息，该漏洞的 CVSS 3.1 评分为 9.8，属于严重级别。搜索结果表明，该漏洞已被广泛利用，甚至被 APT 组织用于攻击活动。 

**漏洞利用方式：**

1.  **身份验证绕过：** 漏洞利用代码通过发送特制的 HTTP 请求来绕过 TeamCity 的身份验证机制。具体利用细节需要分析补丁或者参考其他分析报告。
2.  **创建管理员用户：** 漏洞利用代码首先删除 id 为 1 的用户的token，然后创建一个新的用户 token。使用这个 token，攻击者可以创建一个具有管理员权限的新用户。新用户的用户名和密码可以通过命令行参数指定，默认用户名为 `H454NSec[随机数]`，密码为 `@H454NSec`。利用成功后，即可使用创建的管理员用户登录TeamCity控制台。
3.  **远程代码执行：** 通过管理员权限，攻击者可以在 TeamCity 服务器上执行任意代码，实现远程控制。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确定该 POC 代码是有效的。漏洞已被公开披露且有可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。风险分析如下：

*   **代码结构：** 代码结构相对清晰，主要功能是利用漏洞创建管理员用户。
*   **可疑行为：** 代码中存在以下潜在风险：
    *   **默认用户名和密码：** 使用默认的用户名和密码 `@H454NSec` 创建管理员帐户，这可能会让其他攻击者更容易入侵，或者导致安全审计告警。
    *   **硬编码的 User-Agent：**  User-Agent头 `Mozilla/5.0 (https://github.com/H454NSec/CVE-2023-42793) Gecko/20100101 Firefox/113.0`  可能被用于追踪攻击源。但同时也降低了攻击的隐蔽性。
    *   **未处理异常：** 虽然代码有异常处理，但仅仅是简单的`pass`，可能会隐藏一些错误信息，增加调试难度。
*   **高危操作：**  漏洞利用本身就是高危操作，如果攻击者通过修改poc加入恶意命令，将会造成严重危害，例如植入后门。

综合考虑以上因素，该 POC 代码的投毒风险评估为 10%。主要风险在于攻击者可能利用该代码进行二次修改，加入恶意代码或后门，从而扩大攻击范围。

**项目地址:** [H454NSec/CVE-2023-42793](https://github.com/H454NSec/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #4

**来源**: [CVE-2023-42793-HusenjanDev_CVE-2023-42793.md](../2023/CVE-2023-42793-HusenjanDev_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从网络访问，需要通过其他途径获取TeamCity Token。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，允许未经身份验证的攻击者通过HTTP(S)访问TeamCity服务器，并执行远程代码。根据漏洞库信息，CVSS评分为9.8，属于严重级别。搜索引擎结果显示，该漏洞已被多个APT组织利用，包括APT29、北朝鲜的Diamond Sleet和Onyx Sleet以及俄罗斯对外情报局 (SVR)，显示其真实性和危害性。Rapid7的博客文章也详细分析了该漏洞。提供的POC代码的利用方式是：

1.  **获取TeamCity Token:**  `readme.md` 中提到，需要通过其他漏洞或者方式获取TeamCity的Token. 这是利用此POC的前提。
2.  **启用调试模式:** 使用curl命令发送POST请求到`/admin/dataDir.html`，修改`config/internal.properties`文件，启用`rest.debug.processes.enable=true`，从而开启调试模式。这一步通过token进行验证。
3.  **构造反弹shell Payload:**  将反弹shell命令进行URL编码，目标是让受害者主机连接攻击者的Netcat监听器。
4.  **执行远程命令:** 使用curl命令发送POST请求到`/app/rest/debug/processes`，指定`exePath`为`/bin/bash`，`params`为`-c`和URL编码后的反弹shell命令。这个请求同样需要token验证。漏洞利用依赖于已获取的TeamCity token，然后通过启用调试模式执行反弹shell。根据分析，该POC代码没有明显的投毒行为。

**项目地址:** [HusenjanDev/CVE-2023-42793](https://github.com/HusenjanDev/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #5

**来源**: [CVE-2023-42793-LeHeron_TC_test.md](../2023/CVE-2023-42793-LeHeron_TC_test.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个严重的身份验证绕过漏洞，攻击者无需身份验证即可在 TeamCity 服务器上执行远程代码。根据漏洞信息和搜索结果，该漏洞已被积极利用，甚至APT组织，如CozyBear，以及北朝鲜的APT组织都在利用该漏洞。 

**有效性：**
根据搜索结果，此漏洞已经存在公开的利用代码，且已被广泛利用，证明漏洞有效。

**投毒风险：**
提供的漏洞利用代码 `/tmp/da0475f0898b55e5196bf0f36ac9d45e/README`  只是一个简单的README文件，内容为 “Hello World”，不包含任何可执行代码或恶意指令。投毒的可能性极低，可以认为几乎不存在，给到1%的可能也只是对未知风险的保留。

**利用方式：**
根据漏洞描述，攻击者可以通过未授权访问TeamCity服务器，从而执行任意代码。具体的利用方式可能涉及到构造特定的HTTP请求绕过身份验证机制，然后利用TeamCity服务器的功能执行恶意命令。参考Rapid7的博客文章，该漏洞利用可能与特定的端点和参数有关，允许攻击者创建管理员用户或直接执行代码。 从搜索结果来看，该漏洞已经成为恶意行为者的攻击目标，建议尽快升级到安全版本。

**项目地址:** [LeHeron/TC_test](https://github.com/LeHeron/TC_test)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #6

**来源**: [CVE-2023-42793-StanleyJobsonAU_GhostTown.md](../2023/CVE-2023-42793-StanleyJobsonAU_GhostTown.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个身份验证绕过漏洞，允许未经身份验证的攻击者远程执行代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8（严重），并且已被积极利用。搜索结果表明，包括APT29、朝鲜黑客组织以及俄罗斯对外情报局（SVR）等多个威胁组织都在利用此漏洞。提供的POC代码 `GhostTown.py` 旨在利用此漏洞。利用方式如下：

1.  **生成管理员Token：** POC首先尝试通过 `/app/rest/users/id:1/tokens/RPC2` 接口创建一个管理员Token。这将绕过身份验证。
2.  **检索内部配置：** 使用生成的管理员Token，POC尝试从 `/get/file/dataDir/config/internal.properties` 接口检索TeamCity的内部配置。
3.  **更新配置：** POC会检查配置项中是否包含 `rest.debug.processes.enable=true`，如果不存在，则将其添加到配置项中，并通过 `/get/file/dataDir/config/internal.properties` 接口更新配置。`rest.debug.processes.enable=true` 配置的目的是允许执行调试进程，这为远程代码执行铺平了道路。(这部分未在提供的代码片段中。)
4. **远程代码执行：** 启用调试进程允许攻击者通过构造特定的请求来执行任意命令。

**有效性：** 根据漏洞信息和搜索结果，此POC代码有效，能够利用CVE-2023-42793漏洞实现RCE。

**投毒风险：** 检查提供的代码，主要逻辑集中在利用漏洞上，没有发现明显的恶意代码或后门。该代码是为了验证漏洞存在，并帮助安全研究人员和管理员修复漏洞，存在投毒代码的可能性较低。


**项目地址:** [StanleyJobsonAU/GhostTown](https://github.com/StanleyJobsonAU/GhostTown)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #7

**来源**: [CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md](../2023/CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器，且目标版本低于2023.05.4

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 存在于 JetBrains TeamCity 2023.05.4 之前的版本中，是一个身份验证绕过漏洞，可以导致未经身份验证的远程代码执行。攻击者可以利用此漏洞在 TeamCity 服务器上执行任意代码，从而完全控制服务器。漏洞利用方式如下：

1.  **身份验证绕过：** 利用漏洞绕过身份验证。
2.  **启用调试模式：** 通过修改 `internal.properties` 文件启用 `rest.debug.processes.enable`。
3.  **远程代码执行：** 使用 `/app/rest/debug/processes` 接口执行任意命令。脚本通过修改 `internal.properties` 文件，然后使用特制的请求调用 `debug/processes` 接口，从而在目标系统上执行任意命令。

提供的 `TeamCity.sh` 脚本允许用户指定目标操作系统 (Linux 或 Windows)，并相应地调整命令执行方式。脚本首先获取一个token，然后利用该 token 修改`internal.properties`文件以启用调试模式，最后使用构造好的包含恶意命令的URL来触发RCE。

投毒风险评估：代码中主要逻辑为漏洞利用，并未发现明显的恶意代码。`TeamCity.sh` 中选择目标OS后，Linux环境使用了`base64`编码命令，Windows没有。虽然脚本的行为符合漏洞利用的预期，但是如果攻击者对`base64` 编码方式做了手脚，有可能在Linux执行的时候插入恶意命令。`TeamCity2.sh` 脚本对命令进行URL编码，windows只支持powershell, 可以对powershell添加恶意payload. 因此，存在一定的投毒风险，估计在10%左右。

**项目地址:** [SwiftSecur/teamcity-exploit-cve-2023-42793](https://github.com/SwiftSecur/teamcity-exploit-cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #8

**来源**: [CVE-2023-42793-Zenmovie_CVE-2023-42793.md](../2023/CVE-2023-42793-Zenmovie_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity实例需要开启网络访问，且版本低于2023.05.4。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的远程攻击者绕过身份验证，并在服务器上执行任意代码。根据漏洞库信息，CVSS评分为9.8（严重）。

**利用方式：**

1.  **身份验证绕过：** 攻击者利用未经身份验证的REST API端点`/app/rest/users/id:1/tokens/RPC2`来获取一个有效的Bearer Token。这个Token最初的设计目的是允许用户通过API管理自己的Token。
2.  **修改内部属性：** 使用获取的Token，通过POST请求访问`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`修改内部属性，启用`rest.debug.processes.enable`，此步骤为后续RCE做准备。
3.  **远程代码执行：**  利用被启用的REST API端点`/app/rest/debug/processes?exePath=${COMMAND}`，通过`exePath`参数执行任意命令。该端点在正常情况下只允许经过身份验证的管理员访问，但由于身份验证绕过，未经授权的攻击者可以利用它。

**POC有效性：**

提供的POC代码包含两个脚本：`CVE-2023-42793_admin.sh`和`CVE-2023-42793_rce.sh`。

*   `CVE-2023-42793_admin.sh`脚本利用漏洞创建一个新的管理员用户（Zenmovie/Zenmovie），方便后续访问TeamCity。
*   `CVE-2023-42793_rce.sh`脚本利用漏洞执行指定的命令，并返回命令输出。

从提供的README.md中的截图以及漏洞原理来看，POC代码是有效的，可以成功利用该漏洞。

**投毒风险：**

评估投毒风险，需考虑作者是否有意在代码中添加恶意功能。

1.  **代码混淆/隐藏：** 代码没有进行明显的混淆。虽然使用了`grep`和`awk`提取Token和命令输出，但是属于正常利用。
2.  **恶意依赖：** 代码没有引入外部依赖。
3.  **后门代码：** 代码的主要功能是利用漏洞，创建管理员账户或执行命令。没有发现明显与漏洞利用无关的恶意代码，例如反弹shell、上传文件等。
4.  **隐蔽指令：**  检查代码中是否存在不易察觉的指令，例如通过环境变量、时间等触发的恶意行为。没有发现此类指令。

尽管POC的主要功能是漏洞利用，仍存在一定的投毒风险。例如，攻击者可能修改`CVE-2023-42793_rce.sh`脚本，在执行目标命令之前，先执行一些恶意操作，例如下载并执行恶意程序，添加后门账户等。这种风险很难通过静态分析完全排除，需要进行动态分析，实际运行poc代码进行监控。

因此，综合考虑，投毒风险评估为10%。这个风险主要来源于用户下载和使用POC时，可能会下载到被篡改过的恶意版本。

**结论：**

CVE-2023-42793是一个高危漏洞，利用简单，影响范围广。建议受影响的用户尽快升级到最新版本。在使用公开的POC代码时，务必谨慎，进行代码审计，并确保从可信来源下载。

**项目地址:** [Zenmovie/CVE-2023-42793](https://github.com/Zenmovie/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #9

**来源**: [CVE-2023-42793-becrevex_CVE-2023-42793.md](../2023/CVE-2023-42793-becrevex_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个认证绕过漏洞，攻击者无需认证即可利用此漏洞在TeamCity服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8，属于高危漏洞，并且已被积极利用。多家安全公司和组织（例如Rapid7，Fortinet，Microsoft，CISA）都发布了关于该漏洞的分析和利用报告，甚至有APT组织（APT29，北朝鲜黑客组织）利用该漏洞进行攻击。

提供的POC代码是一个Nmap脚本，用于检测目标TeamCity服务器是否存在CVE-2023-42793漏洞。该脚本通过向`/app/rest/users/id:1/tokens/RPC2`路径发送POST请求，尝试创建一个新的用户令牌，如果服务器返回200状态码且包含一个令牌，则表明服务器存在漏洞。该脚本本身的行为是良性的，只是用于验证漏洞的存在，没有发现任何投毒代码。

**有效性：**
根据提供的漏洞信息和POC代码，该POC代码有效，可以用于检测目标是否存在CVE-2023-42793漏洞。

**投毒风险：**
对提供的Nmap脚本进行了分析，没有发现任何明显的投毒代码。脚本的功能明确，即检测TeamCity服务器上的漏洞，没有发现任何恶意行为。风险评估为0%

**利用方式：**
1.  攻击者利用未授权访问漏洞，绕过身份验证。
2.  攻击者发送特制请求，例如向`/app/rest/users/id:1/tokens/RPC2`路径创建用户Token。
3.  成功创建Token后，攻击者获得管理员权限。
4.  利用管理员权限执行任意代码，实现远程代码执行。

该漏洞利用简单，影响严重，建议TeamCity用户尽快升级到2023.05.4或更高版本。

**项目地址:** [becrevex/CVE-2023-42793](https://github.com/becrevex/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #10

**来源**: [CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md](../2023/CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** JetBrains TeamCity

**危害等级:** 极高，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可从网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity 2023.05.4之前版本中存在的一个身份验证绕过漏洞，可能导致未经身份验证的远程代码执行。根据漏洞库信息，此漏洞的CVSS评分为9.8，属于严重级别。多个搜索结果表明，该漏洞已被积极利用，甚至被APT组织利用进行攻击。提供的POC代码是一个Python脚本，它利用漏洞执行远程命令。

**利用方式：**

1.  **身份验证绕过：** 该漏洞允许攻击者绕过TeamCity服务器的身份验证机制。
2.  **获取Bearer Token：** 利用未经身份验证的访问，通过`/app/rest/users/id:1/tokens/RPC2`端点创建一个临时的Bearer Token。
3.  **启用调试模式：** 使用获得的Bearer Token，通过`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`端点启用调试模式，即`rest.debug.processes.enable=true`。
4.  **远程代码执行：** 使用获得的Bearer Token，通过`/app/rest/debug/processes`端点执行任意命令。POC使用bash反弹shell，通过URL编码将命令传递给目标服务器。

**有效性评估：**

提供的POC代码看起来是有效的。它利用了TeamCity REST API中的漏洞，绕过身份验证并执行任意代码。 脚本首先尝试获取一个临时的Bearer Token，然后使用该Token来修改`internal.properties`文件以启用调试模式。最后，脚本使用调试模式来执行远程代码。 脚本的`README.md`文件中提供的参考链接也支持了该漏洞的存在和可利用性。搜索结果中大量的安全厂商报告和分析也证实了此漏洞的真实性和高危性。

**投毒风险评估：**

分析POC代码没有发现明显的投毒代码。脚本的功能主要集中在利用漏洞进行远程代码执行，没有发现额外的恶意行为或后门。该脚本的功能与漏洞描述以及利用方式相符，未发现任何异常行为。因此，投毒风险评估为0%。

**项目地址:** [hotplugin0x01/CVE-2023-42793](https://github.com/hotplugin0x01/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #11

**来源**: [CVE-2023-42793-jakehomb_cve-2023-42793.md](../2023/CVE-2023-42793-jakehomb_cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器版本低于2023.05.4，且可通过HTTP(S)访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2023-42793 允许未经身份验证的攻击者在 TeamCity 服务器上执行远程代码。该漏洞利用方式是通过绕过身份验证机制，直接访问受保护的资源并执行恶意操作。

**有效性：**
根据提供的漏洞信息、搜索结果以及漏洞利用代码，可以判断该漏洞的 POC 代码有效。CVE 详情中提到存在身份验证绕过导致 RCE，搜索结果也表明该漏洞存在公开可用的exploit，并且已经被APT29等恶意行为者利用。

**投毒风险：**
提供的漏洞利用代码主要由两部分组成：获取 Token 和创建用户。getToken 函数尝试从 /app/rest/users/id:1/token/RPC2 获取一个 Token，createUser 函数使用这个 Token 来创建一个具有管理员权限的用户。代码本身功能明确，没有发现隐藏的恶意代码。因此，评估该仓库中存在作者隐藏的投毒代码的风险为0%。

**利用方式：**
1.  **目标探测：** 确定目标 TeamCity 服务器的版本是否低于 2023.05.4。
2.  **Token 获取：** 使用 `getToken` 函数，通过向 `https://<teamcity_url>/app/rest/users/id:1/token/RPC2` 发送 GET 请求，尝试获取一个 Token。服务器无需授权即可响应。  `extractToken` 函数从响应中提取 Token。
3.  **用户创建：** 使用 `createUser` 函数，携带上一步获取的 Token，向 `https://<teamcity_url>/app/rest/users` 发送 POST 请求，创建一个具有 SYSTEM_ADMIN 角色的新用户。请求的 Body 为包含用户名、密码和邮箱的JSON格式。
4.  **权限提升：** 使用新创建的管理员用户登录 TeamCity 服务器，获得完全控制权限，从而执行任意代码。

**项目地址:** [jakehomb/cve-2023-42793](https://github.com/jakehomb/cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #12

**来源**: [CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md](../2023/CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行远程代码。该漏洞影响2023.05.4之前的版本。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的，并且已被广泛利用。CISA已将其添加到已知被利用漏洞目录中。搜索引擎结果中多个安全厂商的博客也证实了该漏洞的有效性。

**投毒风险：**
提供的PoC代码本身的功能是利用漏洞创建新的管理员用户。`README.md`文件描述了脚本的功能，与代码行为一致。代码中对创建的用户名称添加了随机数，并会写入 `vulnerable.txt` 文件。 `vulnerable.txt`文件可能存在信息泄露的风险,如果被攻击者获取，可能结合其他漏洞使用。总体来看，该PoC代码存在投毒风险的可能性较低，约为10%。

**利用方式：**
1.  **删除用户令牌：** PoC首先尝试删除ID为1的用户令牌 (通常是管理员)。
2.  **创建用户令牌：** 如果删除成功或不存在，PoC会尝试为ID为1的用户创建一个新的用户令牌。
3.  **创建管理员用户：** 使用新创建的用户令牌，PoC会创建一个具有`SYSTEM_ADMIN`权限的新用户，用户名和密码是硬编码的（用户名以 `_secops` 开头，加上随机数，密码是 `changeme`）。
4.  **利用新用户登录：** 攻击者可以使用新创建的管理员帐户登录TeamCity服务器，从而完全控制该服务器。
5.  **自动化攻击:** 通过-u指定url或者-l指定url列表，实现批量攻击。

**项目地址:** [johnossawy/CVE-2023-42793_POC](https://github.com/johnossawy/CVE-2023-42793_POC)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #13

**来源**: [CVE-2023-42793-junnythemarksman_CVE-2023-42793.md](../2023/CVE-2023-42793-junnythemarksman_CVE-2023-42793.md)

# CVE-2023-42793

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md](../2023/CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md)

## CVE-2023-42793 - TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个身份验证绕过漏洞，未经身份验证的攻击者可以通过发送特制的 HTTP 请求绕过身份验证，从而创建管理员账户并最终实现远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果中多个链接都提到了该漏洞被积极利用，包括APT组织。漏洞利用代码提供了创建管理员账户和执行RCE的脚本，并且说明了如何利用该漏洞，包括如何获取反向shell。

**投毒风险：**
分析提供的`exploit.py`和`rce_exploit.py`，主要功能是创建管理员账户和执行任意命令。脚本本身的代码逻辑相对简单，没有明显的恶意代码。其中`exploit.py`会生成随机用户名、密码和邮箱地址，这可能被误认为恶意行为，但这是为了方便利用而设计的，并非投毒。`rce_exploit.py`脚本依赖于第一个脚本创建的token文件。虽然没有发现明显的后门代码，但仍存在极小的风险，例如在生成随机字符串时引入偏差，虽然可能性极小，但理论上存在被利用的可能性，将投毒风险评定为5%。

**利用方式：**
1.  **身份验证绕过：** 攻击者首先利用身份验证绕过漏洞，该漏洞允许未经身份验证的攻击者与TeamCity服务器进行交互，绕过正常的身份验证流程。
2.  **创建管理员账户：** 使用 `exploit.py` 脚本，通过发送特制的 POST 请求，在 TeamCity 服务器上创建一个新的管理员账户。可以指定用户名、密码和邮箱，也可以使用随机生成的凭据。成功创建后，会将凭据保存到token文件中。
3.  **远程代码执行：** 使用 `rce.py` 脚本，该脚本首先启用debug processes，然后利用创建的管理员账户，通过 TeamCity 的 API 接口执行任意命令。可以执行系统命令，例如 `whoami`，也可以获取反向 shell，从而完全控制服务器。
4.  **反向Shell:** 利用rce.py执行命令，通过反弹shell到攻击者机器上，来获取服务器的控制权。


**项目地址:** [B4l3rI0n/CVE-2023-42793](https://github.com/B4l3rI0n/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #2

**来源**: [CVE-2023-42793-FlojBoj_CVE-2023-42793.md](../2023/CVE-2023-42793-FlojBoj_CVE-2023-42793.md)

## CVE-2023-42793-JetBrainsTeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可能导致远程代码执行和完全控制TeamCity服务器

**影响版本:** < 2023.05.4

**利用条件:** 需要能够通过HTTP(S)访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，攻击者无需身份验证即可执行远程代码。漏洞利用方式如下：

1.  **有效性：** 漏洞信息和搜索结果表明该漏洞已在野外被积极利用，包括APT组织（如APT29、CozyBear、北朝鲜黑客组织）和俄罗斯情报部门SVR。提供的代码`exploit.py`旨在利用此漏洞创建管理员账户或获取现有用户的token，从而控制TeamCity服务器。根据README.md的描述，还有一个`rce.py`脚本可以执行远程命令，但主脚本`exploit.py`的功能是创建管理员账户。

2.  **投毒风险：** 代码`exploit.py`本身的功能是利用漏洞创建管理员用户或获取token。投毒风险评估如下：
    *   代码中存在一些硬编码，例如默认密码"Password@123"和默认邮箱域名"@lol.omg"，如果直接使用这些默认值，容易被检测和防御。但这不属于投毒，而是简化使用的示例。
    *   代码尝试首先获取或删除现有的token，这增加了攻击成功的概率，但也可能在目标环境中留下痕迹。
    *   总体来看，`exploit.py`的主要风险在于被滥用以非法控制TeamCity服务器，而非恶意代码本身。因此，投毒风险较低，估计为10%。主要是担心引入了额外的请求或命令，用于收集用户信息或执行其他未经授权的操作。

3.  **利用方式：** 利用方式主要分为以下步骤：
    a.  攻击者发送特制的HTTP请求到TeamCity服务器，绕过身份验证。
    b.  使用`exploit.py`脚本，指定目标TeamCity服务器的URL。
    c.  脚本尝试获取或删除现有的token，然后创建一个新的管理员用户，或者获取指定用户的token。
    d.  如果成功创建管理员用户，攻击者可以使用新创建的管理员账户登录TeamCity服务器，并获得完全控制权限。
    e. 通过获取到的token, 攻击者可以模拟用户身份，从而执行相关操作。

该漏洞的严重性在于未经身份验证即可创建管理员帐户并执行任意代码，从而完全控制受影响的TeamCity服务器。缓解措施包括尽快升级到2023.05.4或更高版本。

**项目地址:** [FlojBoj/CVE-2023-42793](https://github.com/FlojBoj/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #3

**来源**: [CVE-2023-42793-H454NSec_CVE-2023-42793.md](../2023/CVE-2023-42793-H454NSec_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从攻击者控制的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 漏洞存在于JetBrains TeamCity 2023.05.4 之前的版本中，允许未经身份验证的攻击者绕过身份验证，最终实现远程代码执行。根据漏洞库信息，该漏洞的 CVSS 3.1 评分为 9.8，属于严重级别。搜索结果表明，该漏洞已被广泛利用，甚至被 APT 组织用于攻击活动。 

**漏洞利用方式：**

1.  **身份验证绕过：** 漏洞利用代码通过发送特制的 HTTP 请求来绕过 TeamCity 的身份验证机制。具体利用细节需要分析补丁或者参考其他分析报告。
2.  **创建管理员用户：** 漏洞利用代码首先删除 id 为 1 的用户的token，然后创建一个新的用户 token。使用这个 token，攻击者可以创建一个具有管理员权限的新用户。新用户的用户名和密码可以通过命令行参数指定，默认用户名为 `H454NSec[随机数]`，密码为 `@H454NSec`。利用成功后，即可使用创建的管理员用户登录TeamCity控制台。
3.  **远程代码执行：** 通过管理员权限，攻击者可以在 TeamCity 服务器上执行任意代码，实现远程控制。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确定该 POC 代码是有效的。漏洞已被公开披露且有可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。风险分析如下：

*   **代码结构：** 代码结构相对清晰，主要功能是利用漏洞创建管理员用户。
*   **可疑行为：** 代码中存在以下潜在风险：
    *   **默认用户名和密码：** 使用默认的用户名和密码 `@H454NSec` 创建管理员帐户，这可能会让其他攻击者更容易入侵，或者导致安全审计告警。
    *   **硬编码的 User-Agent：**  User-Agent头 `Mozilla/5.0 (https://github.com/H454NSec/CVE-2023-42793) Gecko/20100101 Firefox/113.0`  可能被用于追踪攻击源。但同时也降低了攻击的隐蔽性。
    *   **未处理异常：** 虽然代码有异常处理，但仅仅是简单的`pass`，可能会隐藏一些错误信息，增加调试难度。
*   **高危操作：**  漏洞利用本身就是高危操作，如果攻击者通过修改poc加入恶意命令，将会造成严重危害，例如植入后门。

综合考虑以上因素，该 POC 代码的投毒风险评估为 10%。主要风险在于攻击者可能利用该代码进行二次修改，加入恶意代码或后门，从而扩大攻击范围。

**项目地址:** [H454NSec/CVE-2023-42793](https://github.com/H454NSec/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #4

**来源**: [CVE-2023-42793-HusenjanDev_CVE-2023-42793.md](../2023/CVE-2023-42793-HusenjanDev_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从网络访问，需要通过其他途径获取TeamCity Token。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，允许未经身份验证的攻击者通过HTTP(S)访问TeamCity服务器，并执行远程代码。根据漏洞库信息，CVSS评分为9.8，属于严重级别。搜索引擎结果显示，该漏洞已被多个APT组织利用，包括APT29、北朝鲜的Diamond Sleet和Onyx Sleet以及俄罗斯对外情报局 (SVR)，显示其真实性和危害性。Rapid7的博客文章也详细分析了该漏洞。提供的POC代码的利用方式是：

1.  **获取TeamCity Token:**  `readme.md` 中提到，需要通过其他漏洞或者方式获取TeamCity的Token. 这是利用此POC的前提。
2.  **启用调试模式:** 使用curl命令发送POST请求到`/admin/dataDir.html`，修改`config/internal.properties`文件，启用`rest.debug.processes.enable=true`，从而开启调试模式。这一步通过token进行验证。
3.  **构造反弹shell Payload:**  将反弹shell命令进行URL编码，目标是让受害者主机连接攻击者的Netcat监听器。
4.  **执行远程命令:** 使用curl命令发送POST请求到`/app/rest/debug/processes`，指定`exePath`为`/bin/bash`，`params`为`-c`和URL编码后的反弹shell命令。这个请求同样需要token验证。漏洞利用依赖于已获取的TeamCity token，然后通过启用调试模式执行反弹shell。根据分析，该POC代码没有明显的投毒行为。

**项目地址:** [HusenjanDev/CVE-2023-42793](https://github.com/HusenjanDev/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #5

**来源**: [CVE-2023-42793-LeHeron_TC_test.md](../2023/CVE-2023-42793-LeHeron_TC_test.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个严重的身份验证绕过漏洞，攻击者无需身份验证即可在 TeamCity 服务器上执行远程代码。根据漏洞信息和搜索结果，该漏洞已被积极利用，甚至APT组织，如CozyBear，以及北朝鲜的APT组织都在利用该漏洞。 

**有效性：**
根据搜索结果，此漏洞已经存在公开的利用代码，且已被广泛利用，证明漏洞有效。

**投毒风险：**
提供的漏洞利用代码 `/tmp/da0475f0898b55e5196bf0f36ac9d45e/README`  只是一个简单的README文件，内容为 “Hello World”，不包含任何可执行代码或恶意指令。投毒的可能性极低，可以认为几乎不存在，给到1%的可能也只是对未知风险的保留。

**利用方式：**
根据漏洞描述，攻击者可以通过未授权访问TeamCity服务器，从而执行任意代码。具体的利用方式可能涉及到构造特定的HTTP请求绕过身份验证机制，然后利用TeamCity服务器的功能执行恶意命令。参考Rapid7的博客文章，该漏洞利用可能与特定的端点和参数有关，允许攻击者创建管理员用户或直接执行代码。 从搜索结果来看，该漏洞已经成为恶意行为者的攻击目标，建议尽快升级到安全版本。

**项目地址:** [LeHeron/TC_test](https://github.com/LeHeron/TC_test)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #6

**来源**: [CVE-2023-42793-StanleyJobsonAU_GhostTown.md](../2023/CVE-2023-42793-StanleyJobsonAU_GhostTown.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个身份验证绕过漏洞，允许未经身份验证的攻击者远程执行代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8（严重），并且已被积极利用。搜索结果表明，包括APT29、朝鲜黑客组织以及俄罗斯对外情报局（SVR）等多个威胁组织都在利用此漏洞。提供的POC代码 `GhostTown.py` 旨在利用此漏洞。利用方式如下：

1.  **生成管理员Token：** POC首先尝试通过 `/app/rest/users/id:1/tokens/RPC2` 接口创建一个管理员Token。这将绕过身份验证。
2.  **检索内部配置：** 使用生成的管理员Token，POC尝试从 `/get/file/dataDir/config/internal.properties` 接口检索TeamCity的内部配置。
3.  **更新配置：** POC会检查配置项中是否包含 `rest.debug.processes.enable=true`，如果不存在，则将其添加到配置项中，并通过 `/get/file/dataDir/config/internal.properties` 接口更新配置。`rest.debug.processes.enable=true` 配置的目的是允许执行调试进程，这为远程代码执行铺平了道路。(这部分未在提供的代码片段中。)
4. **远程代码执行：** 启用调试进程允许攻击者通过构造特定的请求来执行任意命令。

**有效性：** 根据漏洞信息和搜索结果，此POC代码有效，能够利用CVE-2023-42793漏洞实现RCE。

**投毒风险：** 检查提供的代码，主要逻辑集中在利用漏洞上，没有发现明显的恶意代码或后门。该代码是为了验证漏洞存在，并帮助安全研究人员和管理员修复漏洞，存在投毒代码的可能性较低。


**项目地址:** [StanleyJobsonAU/GhostTown](https://github.com/StanleyJobsonAU/GhostTown)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #7

**来源**: [CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md](../2023/CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器，且目标版本低于2023.05.4

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 存在于 JetBrains TeamCity 2023.05.4 之前的版本中，是一个身份验证绕过漏洞，可以导致未经身份验证的远程代码执行。攻击者可以利用此漏洞在 TeamCity 服务器上执行任意代码，从而完全控制服务器。漏洞利用方式如下：

1.  **身份验证绕过：** 利用漏洞绕过身份验证。
2.  **启用调试模式：** 通过修改 `internal.properties` 文件启用 `rest.debug.processes.enable`。
3.  **远程代码执行：** 使用 `/app/rest/debug/processes` 接口执行任意命令。脚本通过修改 `internal.properties` 文件，然后使用特制的请求调用 `debug/processes` 接口，从而在目标系统上执行任意命令。

提供的 `TeamCity.sh` 脚本允许用户指定目标操作系统 (Linux 或 Windows)，并相应地调整命令执行方式。脚本首先获取一个token，然后利用该 token 修改`internal.properties`文件以启用调试模式，最后使用构造好的包含恶意命令的URL来触发RCE。

投毒风险评估：代码中主要逻辑为漏洞利用，并未发现明显的恶意代码。`TeamCity.sh` 中选择目标OS后，Linux环境使用了`base64`编码命令，Windows没有。虽然脚本的行为符合漏洞利用的预期，但是如果攻击者对`base64` 编码方式做了手脚，有可能在Linux执行的时候插入恶意命令。`TeamCity2.sh` 脚本对命令进行URL编码，windows只支持powershell, 可以对powershell添加恶意payload. 因此，存在一定的投毒风险，估计在10%左右。

**项目地址:** [SwiftSecur/teamcity-exploit-cve-2023-42793](https://github.com/SwiftSecur/teamcity-exploit-cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #8

**来源**: [CVE-2023-42793-Zenmovie_CVE-2023-42793.md](../2023/CVE-2023-42793-Zenmovie_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity实例需要开启网络访问，且版本低于2023.05.4。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的远程攻击者绕过身份验证，并在服务器上执行任意代码。根据漏洞库信息，CVSS评分为9.8（严重）。

**利用方式：**

1.  **身份验证绕过：** 攻击者利用未经身份验证的REST API端点`/app/rest/users/id:1/tokens/RPC2`来获取一个有效的Bearer Token。这个Token最初的设计目的是允许用户通过API管理自己的Token。
2.  **修改内部属性：** 使用获取的Token，通过POST请求访问`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`修改内部属性，启用`rest.debug.processes.enable`，此步骤为后续RCE做准备。
3.  **远程代码执行：**  利用被启用的REST API端点`/app/rest/debug/processes?exePath=${COMMAND}`，通过`exePath`参数执行任意命令。该端点在正常情况下只允许经过身份验证的管理员访问，但由于身份验证绕过，未经授权的攻击者可以利用它。

**POC有效性：**

提供的POC代码包含两个脚本：`CVE-2023-42793_admin.sh`和`CVE-2023-42793_rce.sh`。

*   `CVE-2023-42793_admin.sh`脚本利用漏洞创建一个新的管理员用户（Zenmovie/Zenmovie），方便后续访问TeamCity。
*   `CVE-2023-42793_rce.sh`脚本利用漏洞执行指定的命令，并返回命令输出。

从提供的README.md中的截图以及漏洞原理来看，POC代码是有效的，可以成功利用该漏洞。

**投毒风险：**

评估投毒风险，需考虑作者是否有意在代码中添加恶意功能。

1.  **代码混淆/隐藏：** 代码没有进行明显的混淆。虽然使用了`grep`和`awk`提取Token和命令输出，但是属于正常利用。
2.  **恶意依赖：** 代码没有引入外部依赖。
3.  **后门代码：** 代码的主要功能是利用漏洞，创建管理员账户或执行命令。没有发现明显与漏洞利用无关的恶意代码，例如反弹shell、上传文件等。
4.  **隐蔽指令：**  检查代码中是否存在不易察觉的指令，例如通过环境变量、时间等触发的恶意行为。没有发现此类指令。

尽管POC的主要功能是漏洞利用，仍存在一定的投毒风险。例如，攻击者可能修改`CVE-2023-42793_rce.sh`脚本，在执行目标命令之前，先执行一些恶意操作，例如下载并执行恶意程序，添加后门账户等。这种风险很难通过静态分析完全排除，需要进行动态分析，实际运行poc代码进行监控。

因此，综合考虑，投毒风险评估为10%。这个风险主要来源于用户下载和使用POC时，可能会下载到被篡改过的恶意版本。

**结论：**

CVE-2023-42793是一个高危漏洞，利用简单，影响范围广。建议受影响的用户尽快升级到最新版本。在使用公开的POC代码时，务必谨慎，进行代码审计，并确保从可信来源下载。

**项目地址:** [Zenmovie/CVE-2023-42793](https://github.com/Zenmovie/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #9

**来源**: [CVE-2023-42793-becrevex_CVE-2023-42793.md](../2023/CVE-2023-42793-becrevex_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个认证绕过漏洞，攻击者无需认证即可利用此漏洞在TeamCity服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8，属于高危漏洞，并且已被积极利用。多家安全公司和组织（例如Rapid7，Fortinet，Microsoft，CISA）都发布了关于该漏洞的分析和利用报告，甚至有APT组织（APT29，北朝鲜黑客组织）利用该漏洞进行攻击。

提供的POC代码是一个Nmap脚本，用于检测目标TeamCity服务器是否存在CVE-2023-42793漏洞。该脚本通过向`/app/rest/users/id:1/tokens/RPC2`路径发送POST请求，尝试创建一个新的用户令牌，如果服务器返回200状态码且包含一个令牌，则表明服务器存在漏洞。该脚本本身的行为是良性的，只是用于验证漏洞的存在，没有发现任何投毒代码。

**有效性：**
根据提供的漏洞信息和POC代码，该POC代码有效，可以用于检测目标是否存在CVE-2023-42793漏洞。

**投毒风险：**
对提供的Nmap脚本进行了分析，没有发现任何明显的投毒代码。脚本的功能明确，即检测TeamCity服务器上的漏洞，没有发现任何恶意行为。风险评估为0%

**利用方式：**
1.  攻击者利用未授权访问漏洞，绕过身份验证。
2.  攻击者发送特制请求，例如向`/app/rest/users/id:1/tokens/RPC2`路径创建用户Token。
3.  成功创建Token后，攻击者获得管理员权限。
4.  利用管理员权限执行任意代码，实现远程代码执行。

该漏洞利用简单，影响严重，建议TeamCity用户尽快升级到2023.05.4或更高版本。

**项目地址:** [becrevex/CVE-2023-42793](https://github.com/becrevex/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #10

**来源**: [CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md](../2023/CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** JetBrains TeamCity

**危害等级:** 极高，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可从网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity 2023.05.4之前版本中存在的一个身份验证绕过漏洞，可能导致未经身份验证的远程代码执行。根据漏洞库信息，此漏洞的CVSS评分为9.8，属于严重级别。多个搜索结果表明，该漏洞已被积极利用，甚至被APT组织利用进行攻击。提供的POC代码是一个Python脚本，它利用漏洞执行远程命令。

**利用方式：**

1.  **身份验证绕过：** 该漏洞允许攻击者绕过TeamCity服务器的身份验证机制。
2.  **获取Bearer Token：** 利用未经身份验证的访问，通过`/app/rest/users/id:1/tokens/RPC2`端点创建一个临时的Bearer Token。
3.  **启用调试模式：** 使用获得的Bearer Token，通过`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`端点启用调试模式，即`rest.debug.processes.enable=true`。
4.  **远程代码执行：** 使用获得的Bearer Token，通过`/app/rest/debug/processes`端点执行任意命令。POC使用bash反弹shell，通过URL编码将命令传递给目标服务器。

**有效性评估：**

提供的POC代码看起来是有效的。它利用了TeamCity REST API中的漏洞，绕过身份验证并执行任意代码。 脚本首先尝试获取一个临时的Bearer Token，然后使用该Token来修改`internal.properties`文件以启用调试模式。最后，脚本使用调试模式来执行远程代码。 脚本的`README.md`文件中提供的参考链接也支持了该漏洞的存在和可利用性。搜索结果中大量的安全厂商报告和分析也证实了此漏洞的真实性和高危性。

**投毒风险评估：**

分析POC代码没有发现明显的投毒代码。脚本的功能主要集中在利用漏洞进行远程代码执行，没有发现额外的恶意行为或后门。该脚本的功能与漏洞描述以及利用方式相符，未发现任何异常行为。因此，投毒风险评估为0%。

**项目地址:** [hotplugin0x01/CVE-2023-42793](https://github.com/hotplugin0x01/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #11

**来源**: [CVE-2023-42793-jakehomb_cve-2023-42793.md](../2023/CVE-2023-42793-jakehomb_cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器版本低于2023.05.4，且可通过HTTP(S)访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2023-42793 允许未经身份验证的攻击者在 TeamCity 服务器上执行远程代码。该漏洞利用方式是通过绕过身份验证机制，直接访问受保护的资源并执行恶意操作。

**有效性：**
根据提供的漏洞信息、搜索结果以及漏洞利用代码，可以判断该漏洞的 POC 代码有效。CVE 详情中提到存在身份验证绕过导致 RCE，搜索结果也表明该漏洞存在公开可用的exploit，并且已经被APT29等恶意行为者利用。

**投毒风险：**
提供的漏洞利用代码主要由两部分组成：获取 Token 和创建用户。getToken 函数尝试从 /app/rest/users/id:1/token/RPC2 获取一个 Token，createUser 函数使用这个 Token 来创建一个具有管理员权限的用户。代码本身功能明确，没有发现隐藏的恶意代码。因此，评估该仓库中存在作者隐藏的投毒代码的风险为0%。

**利用方式：**
1.  **目标探测：** 确定目标 TeamCity 服务器的版本是否低于 2023.05.4。
2.  **Token 获取：** 使用 `getToken` 函数，通过向 `https://<teamcity_url>/app/rest/users/id:1/token/RPC2` 发送 GET 请求，尝试获取一个 Token。服务器无需授权即可响应。  `extractToken` 函数从响应中提取 Token。
3.  **用户创建：** 使用 `createUser` 函数，携带上一步获取的 Token，向 `https://<teamcity_url>/app/rest/users` 发送 POST 请求，创建一个具有 SYSTEM_ADMIN 角色的新用户。请求的 Body 为包含用户名、密码和邮箱的JSON格式。
4.  **权限提升：** 使用新创建的管理员用户登录 TeamCity 服务器，获得完全控制权限，从而执行任意代码。

**项目地址:** [jakehomb/cve-2023-42793](https://github.com/jakehomb/cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #12

**来源**: [CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md](../2023/CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行远程代码。该漏洞影响2023.05.4之前的版本。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的，并且已被广泛利用。CISA已将其添加到已知被利用漏洞目录中。搜索引擎结果中多个安全厂商的博客也证实了该漏洞的有效性。

**投毒风险：**
提供的PoC代码本身的功能是利用漏洞创建新的管理员用户。`README.md`文件描述了脚本的功能，与代码行为一致。代码中对创建的用户名称添加了随机数，并会写入 `vulnerable.txt` 文件。 `vulnerable.txt`文件可能存在信息泄露的风险,如果被攻击者获取，可能结合其他漏洞使用。总体来看，该PoC代码存在投毒风险的可能性较低，约为10%。

**利用方式：**
1.  **删除用户令牌：** PoC首先尝试删除ID为1的用户令牌 (通常是管理员)。
2.  **创建用户令牌：** 如果删除成功或不存在，PoC会尝试为ID为1的用户创建一个新的用户令牌。
3.  **创建管理员用户：** 使用新创建的用户令牌，PoC会创建一个具有`SYSTEM_ADMIN`权限的新用户，用户名和密码是硬编码的（用户名以 `_secops` 开头，加上随机数，密码是 `changeme`）。
4.  **利用新用户登录：** 攻击者可以使用新创建的管理员帐户登录TeamCity服务器，从而完全控制该服务器。
5.  **自动化攻击:** 通过-u指定url或者-l指定url列表，实现批量攻击。

**项目地址:** [johnossawy/CVE-2023-42793_POC](https://github.com/johnossawy/CVE-2023-42793_POC)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #13

**来源**: [CVE-2023-42793-junnythemarksman_CVE-2023-42793.md](../2023/CVE-2023-42793-junnythemarksman_CVE-2023-42793.md)

# CVE-2023-42793

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md](../2023/CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md)

## CVE-2023-42793 - TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个身份验证绕过漏洞，未经身份验证的攻击者可以通过发送特制的 HTTP 请求绕过身份验证，从而创建管理员账户并最终实现远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果中多个链接都提到了该漏洞被积极利用，包括APT组织。漏洞利用代码提供了创建管理员账户和执行RCE的脚本，并且说明了如何利用该漏洞，包括如何获取反向shell。

**投毒风险：**
分析提供的`exploit.py`和`rce_exploit.py`，主要功能是创建管理员账户和执行任意命令。脚本本身的代码逻辑相对简单，没有明显的恶意代码。其中`exploit.py`会生成随机用户名、密码和邮箱地址，这可能被误认为恶意行为，但这是为了方便利用而设计的，并非投毒。`rce_exploit.py`脚本依赖于第一个脚本创建的token文件。虽然没有发现明显的后门代码，但仍存在极小的风险，例如在生成随机字符串时引入偏差，虽然可能性极小，但理论上存在被利用的可能性，将投毒风险评定为5%。

**利用方式：**
1.  **身份验证绕过：** 攻击者首先利用身份验证绕过漏洞，该漏洞允许未经身份验证的攻击者与TeamCity服务器进行交互，绕过正常的身份验证流程。
2.  **创建管理员账户：** 使用 `exploit.py` 脚本，通过发送特制的 POST 请求，在 TeamCity 服务器上创建一个新的管理员账户。可以指定用户名、密码和邮箱，也可以使用随机生成的凭据。成功创建后，会将凭据保存到token文件中。
3.  **远程代码执行：** 使用 `rce.py` 脚本，该脚本首先启用debug processes，然后利用创建的管理员账户，通过 TeamCity 的 API 接口执行任意命令。可以执行系统命令，例如 `whoami`，也可以获取反向 shell，从而完全控制服务器。
4.  **反向Shell:** 利用rce.py执行命令，通过反弹shell到攻击者机器上，来获取服务器的控制权。


**项目地址:** [B4l3rI0n/CVE-2023-42793](https://github.com/B4l3rI0n/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #2

**来源**: [CVE-2023-42793-FlojBoj_CVE-2023-42793.md](../2023/CVE-2023-42793-FlojBoj_CVE-2023-42793.md)

## CVE-2023-42793-JetBrainsTeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可能导致远程代码执行和完全控制TeamCity服务器

**影响版本:** < 2023.05.4

**利用条件:** 需要能够通过HTTP(S)访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，攻击者无需身份验证即可执行远程代码。漏洞利用方式如下：

1.  **有效性：** 漏洞信息和搜索结果表明该漏洞已在野外被积极利用，包括APT组织（如APT29、CozyBear、北朝鲜黑客组织）和俄罗斯情报部门SVR。提供的代码`exploit.py`旨在利用此漏洞创建管理员账户或获取现有用户的token，从而控制TeamCity服务器。根据README.md的描述，还有一个`rce.py`脚本可以执行远程命令，但主脚本`exploit.py`的功能是创建管理员账户。

2.  **投毒风险：** 代码`exploit.py`本身的功能是利用漏洞创建管理员用户或获取token。投毒风险评估如下：
    *   代码中存在一些硬编码，例如默认密码"Password@123"和默认邮箱域名"@lol.omg"，如果直接使用这些默认值，容易被检测和防御。但这不属于投毒，而是简化使用的示例。
    *   代码尝试首先获取或删除现有的token，这增加了攻击成功的概率，但也可能在目标环境中留下痕迹。
    *   总体来看，`exploit.py`的主要风险在于被滥用以非法控制TeamCity服务器，而非恶意代码本身。因此，投毒风险较低，估计为10%。主要是担心引入了额外的请求或命令，用于收集用户信息或执行其他未经授权的操作。

3.  **利用方式：** 利用方式主要分为以下步骤：
    a.  攻击者发送特制的HTTP请求到TeamCity服务器，绕过身份验证。
    b.  使用`exploit.py`脚本，指定目标TeamCity服务器的URL。
    c.  脚本尝试获取或删除现有的token，然后创建一个新的管理员用户，或者获取指定用户的token。
    d.  如果成功创建管理员用户，攻击者可以使用新创建的管理员账户登录TeamCity服务器，并获得完全控制权限。
    e. 通过获取到的token, 攻击者可以模拟用户身份，从而执行相关操作。

该漏洞的严重性在于未经身份验证即可创建管理员帐户并执行任意代码，从而完全控制受影响的TeamCity服务器。缓解措施包括尽快升级到2023.05.4或更高版本。

**项目地址:** [FlojBoj/CVE-2023-42793](https://github.com/FlojBoj/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #3

**来源**: [CVE-2023-42793-H454NSec_CVE-2023-42793.md](../2023/CVE-2023-42793-H454NSec_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从攻击者控制的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 漏洞存在于JetBrains TeamCity 2023.05.4 之前的版本中，允许未经身份验证的攻击者绕过身份验证，最终实现远程代码执行。根据漏洞库信息，该漏洞的 CVSS 3.1 评分为 9.8，属于严重级别。搜索结果表明，该漏洞已被广泛利用，甚至被 APT 组织用于攻击活动。 

**漏洞利用方式：**

1.  **身份验证绕过：** 漏洞利用代码通过发送特制的 HTTP 请求来绕过 TeamCity 的身份验证机制。具体利用细节需要分析补丁或者参考其他分析报告。
2.  **创建管理员用户：** 漏洞利用代码首先删除 id 为 1 的用户的token，然后创建一个新的用户 token。使用这个 token，攻击者可以创建一个具有管理员权限的新用户。新用户的用户名和密码可以通过命令行参数指定，默认用户名为 `H454NSec[随机数]`，密码为 `@H454NSec`。利用成功后，即可使用创建的管理员用户登录TeamCity控制台。
3.  **远程代码执行：** 通过管理员权限，攻击者可以在 TeamCity 服务器上执行任意代码，实现远程控制。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确定该 POC 代码是有效的。漏洞已被公开披露且有可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。风险分析如下：

*   **代码结构：** 代码结构相对清晰，主要功能是利用漏洞创建管理员用户。
*   **可疑行为：** 代码中存在以下潜在风险：
    *   **默认用户名和密码：** 使用默认的用户名和密码 `@H454NSec` 创建管理员帐户，这可能会让其他攻击者更容易入侵，或者导致安全审计告警。
    *   **硬编码的 User-Agent：**  User-Agent头 `Mozilla/5.0 (https://github.com/H454NSec/CVE-2023-42793) Gecko/20100101 Firefox/113.0`  可能被用于追踪攻击源。但同时也降低了攻击的隐蔽性。
    *   **未处理异常：** 虽然代码有异常处理，但仅仅是简单的`pass`，可能会隐藏一些错误信息，增加调试难度。
*   **高危操作：**  漏洞利用本身就是高危操作，如果攻击者通过修改poc加入恶意命令，将会造成严重危害，例如植入后门。

综合考虑以上因素，该 POC 代码的投毒风险评估为 10%。主要风险在于攻击者可能利用该代码进行二次修改，加入恶意代码或后门，从而扩大攻击范围。

**项目地址:** [H454NSec/CVE-2023-42793](https://github.com/H454NSec/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #4

**来源**: [CVE-2023-42793-HusenjanDev_CVE-2023-42793.md](../2023/CVE-2023-42793-HusenjanDev_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从网络访问，需要通过其他途径获取TeamCity Token。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，允许未经身份验证的攻击者通过HTTP(S)访问TeamCity服务器，并执行远程代码。根据漏洞库信息，CVSS评分为9.8，属于严重级别。搜索引擎结果显示，该漏洞已被多个APT组织利用，包括APT29、北朝鲜的Diamond Sleet和Onyx Sleet以及俄罗斯对外情报局 (SVR)，显示其真实性和危害性。Rapid7的博客文章也详细分析了该漏洞。提供的POC代码的利用方式是：

1.  **获取TeamCity Token:**  `readme.md` 中提到，需要通过其他漏洞或者方式获取TeamCity的Token. 这是利用此POC的前提。
2.  **启用调试模式:** 使用curl命令发送POST请求到`/admin/dataDir.html`，修改`config/internal.properties`文件，启用`rest.debug.processes.enable=true`，从而开启调试模式。这一步通过token进行验证。
3.  **构造反弹shell Payload:**  将反弹shell命令进行URL编码，目标是让受害者主机连接攻击者的Netcat监听器。
4.  **执行远程命令:** 使用curl命令发送POST请求到`/app/rest/debug/processes`，指定`exePath`为`/bin/bash`，`params`为`-c`和URL编码后的反弹shell命令。这个请求同样需要token验证。漏洞利用依赖于已获取的TeamCity token，然后通过启用调试模式执行反弹shell。根据分析，该POC代码没有明显的投毒行为。

**项目地址:** [HusenjanDev/CVE-2023-42793](https://github.com/HusenjanDev/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #5

**来源**: [CVE-2023-42793-LeHeron_TC_test.md](../2023/CVE-2023-42793-LeHeron_TC_test.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个严重的身份验证绕过漏洞，攻击者无需身份验证即可在 TeamCity 服务器上执行远程代码。根据漏洞信息和搜索结果，该漏洞已被积极利用，甚至APT组织，如CozyBear，以及北朝鲜的APT组织都在利用该漏洞。 

**有效性：**
根据搜索结果，此漏洞已经存在公开的利用代码，且已被广泛利用，证明漏洞有效。

**投毒风险：**
提供的漏洞利用代码 `/tmp/da0475f0898b55e5196bf0f36ac9d45e/README`  只是一个简单的README文件，内容为 “Hello World”，不包含任何可执行代码或恶意指令。投毒的可能性极低，可以认为几乎不存在，给到1%的可能也只是对未知风险的保留。

**利用方式：**
根据漏洞描述，攻击者可以通过未授权访问TeamCity服务器，从而执行任意代码。具体的利用方式可能涉及到构造特定的HTTP请求绕过身份验证机制，然后利用TeamCity服务器的功能执行恶意命令。参考Rapid7的博客文章，该漏洞利用可能与特定的端点和参数有关，允许攻击者创建管理员用户或直接执行代码。 从搜索结果来看，该漏洞已经成为恶意行为者的攻击目标，建议尽快升级到安全版本。

**项目地址:** [LeHeron/TC_test](https://github.com/LeHeron/TC_test)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #6

**来源**: [CVE-2023-42793-StanleyJobsonAU_GhostTown.md](../2023/CVE-2023-42793-StanleyJobsonAU_GhostTown.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个身份验证绕过漏洞，允许未经身份验证的攻击者远程执行代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8（严重），并且已被积极利用。搜索结果表明，包括APT29、朝鲜黑客组织以及俄罗斯对外情报局（SVR）等多个威胁组织都在利用此漏洞。提供的POC代码 `GhostTown.py` 旨在利用此漏洞。利用方式如下：

1.  **生成管理员Token：** POC首先尝试通过 `/app/rest/users/id:1/tokens/RPC2` 接口创建一个管理员Token。这将绕过身份验证。
2.  **检索内部配置：** 使用生成的管理员Token，POC尝试从 `/get/file/dataDir/config/internal.properties` 接口检索TeamCity的内部配置。
3.  **更新配置：** POC会检查配置项中是否包含 `rest.debug.processes.enable=true`，如果不存在，则将其添加到配置项中，并通过 `/get/file/dataDir/config/internal.properties` 接口更新配置。`rest.debug.processes.enable=true` 配置的目的是允许执行调试进程，这为远程代码执行铺平了道路。(这部分未在提供的代码片段中。)
4. **远程代码执行：** 启用调试进程允许攻击者通过构造特定的请求来执行任意命令。

**有效性：** 根据漏洞信息和搜索结果，此POC代码有效，能够利用CVE-2023-42793漏洞实现RCE。

**投毒风险：** 检查提供的代码，主要逻辑集中在利用漏洞上，没有发现明显的恶意代码或后门。该代码是为了验证漏洞存在，并帮助安全研究人员和管理员修复漏洞，存在投毒代码的可能性较低。


**项目地址:** [StanleyJobsonAU/GhostTown](https://github.com/StanleyJobsonAU/GhostTown)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #7

**来源**: [CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md](../2023/CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器，且目标版本低于2023.05.4

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 存在于 JetBrains TeamCity 2023.05.4 之前的版本中，是一个身份验证绕过漏洞，可以导致未经身份验证的远程代码执行。攻击者可以利用此漏洞在 TeamCity 服务器上执行任意代码，从而完全控制服务器。漏洞利用方式如下：

1.  **身份验证绕过：** 利用漏洞绕过身份验证。
2.  **启用调试模式：** 通过修改 `internal.properties` 文件启用 `rest.debug.processes.enable`。
3.  **远程代码执行：** 使用 `/app/rest/debug/processes` 接口执行任意命令。脚本通过修改 `internal.properties` 文件，然后使用特制的请求调用 `debug/processes` 接口，从而在目标系统上执行任意命令。

提供的 `TeamCity.sh` 脚本允许用户指定目标操作系统 (Linux 或 Windows)，并相应地调整命令执行方式。脚本首先获取一个token，然后利用该 token 修改`internal.properties`文件以启用调试模式，最后使用构造好的包含恶意命令的URL来触发RCE。

投毒风险评估：代码中主要逻辑为漏洞利用，并未发现明显的恶意代码。`TeamCity.sh` 中选择目标OS后，Linux环境使用了`base64`编码命令，Windows没有。虽然脚本的行为符合漏洞利用的预期，但是如果攻击者对`base64` 编码方式做了手脚，有可能在Linux执行的时候插入恶意命令。`TeamCity2.sh` 脚本对命令进行URL编码，windows只支持powershell, 可以对powershell添加恶意payload. 因此，存在一定的投毒风险，估计在10%左右。

**项目地址:** [SwiftSecur/teamcity-exploit-cve-2023-42793](https://github.com/SwiftSecur/teamcity-exploit-cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #8

**来源**: [CVE-2023-42793-Zenmovie_CVE-2023-42793.md](../2023/CVE-2023-42793-Zenmovie_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity实例需要开启网络访问，且版本低于2023.05.4。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的远程攻击者绕过身份验证，并在服务器上执行任意代码。根据漏洞库信息，CVSS评分为9.8（严重）。

**利用方式：**

1.  **身份验证绕过：** 攻击者利用未经身份验证的REST API端点`/app/rest/users/id:1/tokens/RPC2`来获取一个有效的Bearer Token。这个Token最初的设计目的是允许用户通过API管理自己的Token。
2.  **修改内部属性：** 使用获取的Token，通过POST请求访问`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`修改内部属性，启用`rest.debug.processes.enable`，此步骤为后续RCE做准备。
3.  **远程代码执行：**  利用被启用的REST API端点`/app/rest/debug/processes?exePath=${COMMAND}`，通过`exePath`参数执行任意命令。该端点在正常情况下只允许经过身份验证的管理员访问，但由于身份验证绕过，未经授权的攻击者可以利用它。

**POC有效性：**

提供的POC代码包含两个脚本：`CVE-2023-42793_admin.sh`和`CVE-2023-42793_rce.sh`。

*   `CVE-2023-42793_admin.sh`脚本利用漏洞创建一个新的管理员用户（Zenmovie/Zenmovie），方便后续访问TeamCity。
*   `CVE-2023-42793_rce.sh`脚本利用漏洞执行指定的命令，并返回命令输出。

从提供的README.md中的截图以及漏洞原理来看，POC代码是有效的，可以成功利用该漏洞。

**投毒风险：**

评估投毒风险，需考虑作者是否有意在代码中添加恶意功能。

1.  **代码混淆/隐藏：** 代码没有进行明显的混淆。虽然使用了`grep`和`awk`提取Token和命令输出，但是属于正常利用。
2.  **恶意依赖：** 代码没有引入外部依赖。
3.  **后门代码：** 代码的主要功能是利用漏洞，创建管理员账户或执行命令。没有发现明显与漏洞利用无关的恶意代码，例如反弹shell、上传文件等。
4.  **隐蔽指令：**  检查代码中是否存在不易察觉的指令，例如通过环境变量、时间等触发的恶意行为。没有发现此类指令。

尽管POC的主要功能是漏洞利用，仍存在一定的投毒风险。例如，攻击者可能修改`CVE-2023-42793_rce.sh`脚本，在执行目标命令之前，先执行一些恶意操作，例如下载并执行恶意程序，添加后门账户等。这种风险很难通过静态分析完全排除，需要进行动态分析，实际运行poc代码进行监控。

因此，综合考虑，投毒风险评估为10%。这个风险主要来源于用户下载和使用POC时，可能会下载到被篡改过的恶意版本。

**结论：**

CVE-2023-42793是一个高危漏洞，利用简单，影响范围广。建议受影响的用户尽快升级到最新版本。在使用公开的POC代码时，务必谨慎，进行代码审计，并确保从可信来源下载。

**项目地址:** [Zenmovie/CVE-2023-42793](https://github.com/Zenmovie/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #9

**来源**: [CVE-2023-42793-becrevex_CVE-2023-42793.md](../2023/CVE-2023-42793-becrevex_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个认证绕过漏洞，攻击者无需认证即可利用此漏洞在TeamCity服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8，属于高危漏洞，并且已被积极利用。多家安全公司和组织（例如Rapid7，Fortinet，Microsoft，CISA）都发布了关于该漏洞的分析和利用报告，甚至有APT组织（APT29，北朝鲜黑客组织）利用该漏洞进行攻击。

提供的POC代码是一个Nmap脚本，用于检测目标TeamCity服务器是否存在CVE-2023-42793漏洞。该脚本通过向`/app/rest/users/id:1/tokens/RPC2`路径发送POST请求，尝试创建一个新的用户令牌，如果服务器返回200状态码且包含一个令牌，则表明服务器存在漏洞。该脚本本身的行为是良性的，只是用于验证漏洞的存在，没有发现任何投毒代码。

**有效性：**
根据提供的漏洞信息和POC代码，该POC代码有效，可以用于检测目标是否存在CVE-2023-42793漏洞。

**投毒风险：**
对提供的Nmap脚本进行了分析，没有发现任何明显的投毒代码。脚本的功能明确，即检测TeamCity服务器上的漏洞，没有发现任何恶意行为。风险评估为0%

**利用方式：**
1.  攻击者利用未授权访问漏洞，绕过身份验证。
2.  攻击者发送特制请求，例如向`/app/rest/users/id:1/tokens/RPC2`路径创建用户Token。
3.  成功创建Token后，攻击者获得管理员权限。
4.  利用管理员权限执行任意代码，实现远程代码执行。

该漏洞利用简单，影响严重，建议TeamCity用户尽快升级到2023.05.4或更高版本。

**项目地址:** [becrevex/CVE-2023-42793](https://github.com/becrevex/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #10

**来源**: [CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md](../2023/CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** JetBrains TeamCity

**危害等级:** 极高，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可从网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity 2023.05.4之前版本中存在的一个身份验证绕过漏洞，可能导致未经身份验证的远程代码执行。根据漏洞库信息，此漏洞的CVSS评分为9.8，属于严重级别。多个搜索结果表明，该漏洞已被积极利用，甚至被APT组织利用进行攻击。提供的POC代码是一个Python脚本，它利用漏洞执行远程命令。

**利用方式：**

1.  **身份验证绕过：** 该漏洞允许攻击者绕过TeamCity服务器的身份验证机制。
2.  **获取Bearer Token：** 利用未经身份验证的访问，通过`/app/rest/users/id:1/tokens/RPC2`端点创建一个临时的Bearer Token。
3.  **启用调试模式：** 使用获得的Bearer Token，通过`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`端点启用调试模式，即`rest.debug.processes.enable=true`。
4.  **远程代码执行：** 使用获得的Bearer Token，通过`/app/rest/debug/processes`端点执行任意命令。POC使用bash反弹shell，通过URL编码将命令传递给目标服务器。

**有效性评估：**

提供的POC代码看起来是有效的。它利用了TeamCity REST API中的漏洞，绕过身份验证并执行任意代码。 脚本首先尝试获取一个临时的Bearer Token，然后使用该Token来修改`internal.properties`文件以启用调试模式。最后，脚本使用调试模式来执行远程代码。 脚本的`README.md`文件中提供的参考链接也支持了该漏洞的存在和可利用性。搜索结果中大量的安全厂商报告和分析也证实了此漏洞的真实性和高危性。

**投毒风险评估：**

分析POC代码没有发现明显的投毒代码。脚本的功能主要集中在利用漏洞进行远程代码执行，没有发现额外的恶意行为或后门。该脚本的功能与漏洞描述以及利用方式相符，未发现任何异常行为。因此，投毒风险评估为0%。

**项目地址:** [hotplugin0x01/CVE-2023-42793](https://github.com/hotplugin0x01/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #11

**来源**: [CVE-2023-42793-jakehomb_cve-2023-42793.md](../2023/CVE-2023-42793-jakehomb_cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器版本低于2023.05.4，且可通过HTTP(S)访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2023-42793 允许未经身份验证的攻击者在 TeamCity 服务器上执行远程代码。该漏洞利用方式是通过绕过身份验证机制，直接访问受保护的资源并执行恶意操作。

**有效性：**
根据提供的漏洞信息、搜索结果以及漏洞利用代码，可以判断该漏洞的 POC 代码有效。CVE 详情中提到存在身份验证绕过导致 RCE，搜索结果也表明该漏洞存在公开可用的exploit，并且已经被APT29等恶意行为者利用。

**投毒风险：**
提供的漏洞利用代码主要由两部分组成：获取 Token 和创建用户。getToken 函数尝试从 /app/rest/users/id:1/token/RPC2 获取一个 Token，createUser 函数使用这个 Token 来创建一个具有管理员权限的用户。代码本身功能明确，没有发现隐藏的恶意代码。因此，评估该仓库中存在作者隐藏的投毒代码的风险为0%。

**利用方式：**
1.  **目标探测：** 确定目标 TeamCity 服务器的版本是否低于 2023.05.4。
2.  **Token 获取：** 使用 `getToken` 函数，通过向 `https://<teamcity_url>/app/rest/users/id:1/token/RPC2` 发送 GET 请求，尝试获取一个 Token。服务器无需授权即可响应。  `extractToken` 函数从响应中提取 Token。
3.  **用户创建：** 使用 `createUser` 函数，携带上一步获取的 Token，向 `https://<teamcity_url>/app/rest/users` 发送 POST 请求，创建一个具有 SYSTEM_ADMIN 角色的新用户。请求的 Body 为包含用户名、密码和邮箱的JSON格式。
4.  **权限提升：** 使用新创建的管理员用户登录 TeamCity 服务器，获得完全控制权限，从而执行任意代码。

**项目地址:** [jakehomb/cve-2023-42793](https://github.com/jakehomb/cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #12

**来源**: [CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md](../2023/CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行远程代码。该漏洞影响2023.05.4之前的版本。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的，并且已被广泛利用。CISA已将其添加到已知被利用漏洞目录中。搜索引擎结果中多个安全厂商的博客也证实了该漏洞的有效性。

**投毒风险：**
提供的PoC代码本身的功能是利用漏洞创建新的管理员用户。`README.md`文件描述了脚本的功能，与代码行为一致。代码中对创建的用户名称添加了随机数，并会写入 `vulnerable.txt` 文件。 `vulnerable.txt`文件可能存在信息泄露的风险,如果被攻击者获取，可能结合其他漏洞使用。总体来看，该PoC代码存在投毒风险的可能性较低，约为10%。

**利用方式：**
1.  **删除用户令牌：** PoC首先尝试删除ID为1的用户令牌 (通常是管理员)。
2.  **创建用户令牌：** 如果删除成功或不存在，PoC会尝试为ID为1的用户创建一个新的用户令牌。
3.  **创建管理员用户：** 使用新创建的用户令牌，PoC会创建一个具有`SYSTEM_ADMIN`权限的新用户，用户名和密码是硬编码的（用户名以 `_secops` 开头，加上随机数，密码是 `changeme`）。
4.  **利用新用户登录：** 攻击者可以使用新创建的管理员帐户登录TeamCity服务器，从而完全控制该服务器。
5.  **自动化攻击:** 通过-u指定url或者-l指定url列表，实现批量攻击。

**项目地址:** [johnossawy/CVE-2023-42793_POC](https://github.com/johnossawy/CVE-2023-42793_POC)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #13

**来源**: [CVE-2023-42793-junnythemarksman_CVE-2023-42793.md](../2023/CVE-2023-42793-junnythemarksman_CVE-2023-42793.md)

# CVE-2023-42793

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md](../2023/CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md)

## CVE-2023-42793 - TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个身份验证绕过漏洞，未经身份验证的攻击者可以通过发送特制的 HTTP 请求绕过身份验证，从而创建管理员账户并最终实现远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果中多个链接都提到了该漏洞被积极利用，包括APT组织。漏洞利用代码提供了创建管理员账户和执行RCE的脚本，并且说明了如何利用该漏洞，包括如何获取反向shell。

**投毒风险：**
分析提供的`exploit.py`和`rce_exploit.py`，主要功能是创建管理员账户和执行任意命令。脚本本身的代码逻辑相对简单，没有明显的恶意代码。其中`exploit.py`会生成随机用户名、密码和邮箱地址，这可能被误认为恶意行为，但这是为了方便利用而设计的，并非投毒。`rce_exploit.py`脚本依赖于第一个脚本创建的token文件。虽然没有发现明显的后门代码，但仍存在极小的风险，例如在生成随机字符串时引入偏差，虽然可能性极小，但理论上存在被利用的可能性，将投毒风险评定为5%。

**利用方式：**
1.  **身份验证绕过：** 攻击者首先利用身份验证绕过漏洞，该漏洞允许未经身份验证的攻击者与TeamCity服务器进行交互，绕过正常的身份验证流程。
2.  **创建管理员账户：** 使用 `exploit.py` 脚本，通过发送特制的 POST 请求，在 TeamCity 服务器上创建一个新的管理员账户。可以指定用户名、密码和邮箱，也可以使用随机生成的凭据。成功创建后，会将凭据保存到token文件中。
3.  **远程代码执行：** 使用 `rce.py` 脚本，该脚本首先启用debug processes，然后利用创建的管理员账户，通过 TeamCity 的 API 接口执行任意命令。可以执行系统命令，例如 `whoami`，也可以获取反向 shell，从而完全控制服务器。
4.  **反向Shell:** 利用rce.py执行命令，通过反弹shell到攻击者机器上，来获取服务器的控制权。


**项目地址:** [B4l3rI0n/CVE-2023-42793](https://github.com/B4l3rI0n/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #2

**来源**: [CVE-2023-42793-FlojBoj_CVE-2023-42793.md](../2023/CVE-2023-42793-FlojBoj_CVE-2023-42793.md)

## CVE-2023-42793-JetBrainsTeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可能导致远程代码执行和完全控制TeamCity服务器

**影响版本:** < 2023.05.4

**利用条件:** 需要能够通过HTTP(S)访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，攻击者无需身份验证即可执行远程代码。漏洞利用方式如下：

1.  **有效性：** 漏洞信息和搜索结果表明该漏洞已在野外被积极利用，包括APT组织（如APT29、CozyBear、北朝鲜黑客组织）和俄罗斯情报部门SVR。提供的代码`exploit.py`旨在利用此漏洞创建管理员账户或获取现有用户的token，从而控制TeamCity服务器。根据README.md的描述，还有一个`rce.py`脚本可以执行远程命令，但主脚本`exploit.py`的功能是创建管理员账户。

2.  **投毒风险：** 代码`exploit.py`本身的功能是利用漏洞创建管理员用户或获取token。投毒风险评估如下：
    *   代码中存在一些硬编码，例如默认密码"Password@123"和默认邮箱域名"@lol.omg"，如果直接使用这些默认值，容易被检测和防御。但这不属于投毒，而是简化使用的示例。
    *   代码尝试首先获取或删除现有的token，这增加了攻击成功的概率，但也可能在目标环境中留下痕迹。
    *   总体来看，`exploit.py`的主要风险在于被滥用以非法控制TeamCity服务器，而非恶意代码本身。因此，投毒风险较低，估计为10%。主要是担心引入了额外的请求或命令，用于收集用户信息或执行其他未经授权的操作。

3.  **利用方式：** 利用方式主要分为以下步骤：
    a.  攻击者发送特制的HTTP请求到TeamCity服务器，绕过身份验证。
    b.  使用`exploit.py`脚本，指定目标TeamCity服务器的URL。
    c.  脚本尝试获取或删除现有的token，然后创建一个新的管理员用户，或者获取指定用户的token。
    d.  如果成功创建管理员用户，攻击者可以使用新创建的管理员账户登录TeamCity服务器，并获得完全控制权限。
    e. 通过获取到的token, 攻击者可以模拟用户身份，从而执行相关操作。

该漏洞的严重性在于未经身份验证即可创建管理员帐户并执行任意代码，从而完全控制受影响的TeamCity服务器。缓解措施包括尽快升级到2023.05.4或更高版本。

**项目地址:** [FlojBoj/CVE-2023-42793](https://github.com/FlojBoj/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #3

**来源**: [CVE-2023-42793-H454NSec_CVE-2023-42793.md](../2023/CVE-2023-42793-H454NSec_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从攻击者控制的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 漏洞存在于JetBrains TeamCity 2023.05.4 之前的版本中，允许未经身份验证的攻击者绕过身份验证，最终实现远程代码执行。根据漏洞库信息，该漏洞的 CVSS 3.1 评分为 9.8，属于严重级别。搜索结果表明，该漏洞已被广泛利用，甚至被 APT 组织用于攻击活动。 

**漏洞利用方式：**

1.  **身份验证绕过：** 漏洞利用代码通过发送特制的 HTTP 请求来绕过 TeamCity 的身份验证机制。具体利用细节需要分析补丁或者参考其他分析报告。
2.  **创建管理员用户：** 漏洞利用代码首先删除 id 为 1 的用户的token，然后创建一个新的用户 token。使用这个 token，攻击者可以创建一个具有管理员权限的新用户。新用户的用户名和密码可以通过命令行参数指定，默认用户名为 `H454NSec[随机数]`，密码为 `@H454NSec`。利用成功后，即可使用创建的管理员用户登录TeamCity控制台。
3.  **远程代码执行：** 通过管理员权限，攻击者可以在 TeamCity 服务器上执行任意代码，实现远程控制。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确定该 POC 代码是有效的。漏洞已被公开披露且有可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。风险分析如下：

*   **代码结构：** 代码结构相对清晰，主要功能是利用漏洞创建管理员用户。
*   **可疑行为：** 代码中存在以下潜在风险：
    *   **默认用户名和密码：** 使用默认的用户名和密码 `@H454NSec` 创建管理员帐户，这可能会让其他攻击者更容易入侵，或者导致安全审计告警。
    *   **硬编码的 User-Agent：**  User-Agent头 `Mozilla/5.0 (https://github.com/H454NSec/CVE-2023-42793) Gecko/20100101 Firefox/113.0`  可能被用于追踪攻击源。但同时也降低了攻击的隐蔽性。
    *   **未处理异常：** 虽然代码有异常处理，但仅仅是简单的`pass`，可能会隐藏一些错误信息，增加调试难度。
*   **高危操作：**  漏洞利用本身就是高危操作，如果攻击者通过修改poc加入恶意命令，将会造成严重危害，例如植入后门。

综合考虑以上因素，该 POC 代码的投毒风险评估为 10%。主要风险在于攻击者可能利用该代码进行二次修改，加入恶意代码或后门，从而扩大攻击范围。

**项目地址:** [H454NSec/CVE-2023-42793](https://github.com/H454NSec/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #4

**来源**: [CVE-2023-42793-HusenjanDev_CVE-2023-42793.md](../2023/CVE-2023-42793-HusenjanDev_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从网络访问，需要通过其他途径获取TeamCity Token。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，允许未经身份验证的攻击者通过HTTP(S)访问TeamCity服务器，并执行远程代码。根据漏洞库信息，CVSS评分为9.8，属于严重级别。搜索引擎结果显示，该漏洞已被多个APT组织利用，包括APT29、北朝鲜的Diamond Sleet和Onyx Sleet以及俄罗斯对外情报局 (SVR)，显示其真实性和危害性。Rapid7的博客文章也详细分析了该漏洞。提供的POC代码的利用方式是：

1.  **获取TeamCity Token:**  `readme.md` 中提到，需要通过其他漏洞或者方式获取TeamCity的Token. 这是利用此POC的前提。
2.  **启用调试模式:** 使用curl命令发送POST请求到`/admin/dataDir.html`，修改`config/internal.properties`文件，启用`rest.debug.processes.enable=true`，从而开启调试模式。这一步通过token进行验证。
3.  **构造反弹shell Payload:**  将反弹shell命令进行URL编码，目标是让受害者主机连接攻击者的Netcat监听器。
4.  **执行远程命令:** 使用curl命令发送POST请求到`/app/rest/debug/processes`，指定`exePath`为`/bin/bash`，`params`为`-c`和URL编码后的反弹shell命令。这个请求同样需要token验证。漏洞利用依赖于已获取的TeamCity token，然后通过启用调试模式执行反弹shell。根据分析，该POC代码没有明显的投毒行为。

**项目地址:** [HusenjanDev/CVE-2023-42793](https://github.com/HusenjanDev/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #5

**来源**: [CVE-2023-42793-LeHeron_TC_test.md](../2023/CVE-2023-42793-LeHeron_TC_test.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个严重的身份验证绕过漏洞，攻击者无需身份验证即可在 TeamCity 服务器上执行远程代码。根据漏洞信息和搜索结果，该漏洞已被积极利用，甚至APT组织，如CozyBear，以及北朝鲜的APT组织都在利用该漏洞。 

**有效性：**
根据搜索结果，此漏洞已经存在公开的利用代码，且已被广泛利用，证明漏洞有效。

**投毒风险：**
提供的漏洞利用代码 `/tmp/da0475f0898b55e5196bf0f36ac9d45e/README`  只是一个简单的README文件，内容为 “Hello World”，不包含任何可执行代码或恶意指令。投毒的可能性极低，可以认为几乎不存在，给到1%的可能也只是对未知风险的保留。

**利用方式：**
根据漏洞描述，攻击者可以通过未授权访问TeamCity服务器，从而执行任意代码。具体的利用方式可能涉及到构造特定的HTTP请求绕过身份验证机制，然后利用TeamCity服务器的功能执行恶意命令。参考Rapid7的博客文章，该漏洞利用可能与特定的端点和参数有关，允许攻击者创建管理员用户或直接执行代码。 从搜索结果来看，该漏洞已经成为恶意行为者的攻击目标，建议尽快升级到安全版本。

**项目地址:** [LeHeron/TC_test](https://github.com/LeHeron/TC_test)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #6

**来源**: [CVE-2023-42793-StanleyJobsonAU_GhostTown.md](../2023/CVE-2023-42793-StanleyJobsonAU_GhostTown.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个身份验证绕过漏洞，允许未经身份验证的攻击者远程执行代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8（严重），并且已被积极利用。搜索结果表明，包括APT29、朝鲜黑客组织以及俄罗斯对外情报局（SVR）等多个威胁组织都在利用此漏洞。提供的POC代码 `GhostTown.py` 旨在利用此漏洞。利用方式如下：

1.  **生成管理员Token：** POC首先尝试通过 `/app/rest/users/id:1/tokens/RPC2` 接口创建一个管理员Token。这将绕过身份验证。
2.  **检索内部配置：** 使用生成的管理员Token，POC尝试从 `/get/file/dataDir/config/internal.properties` 接口检索TeamCity的内部配置。
3.  **更新配置：** POC会检查配置项中是否包含 `rest.debug.processes.enable=true`，如果不存在，则将其添加到配置项中，并通过 `/get/file/dataDir/config/internal.properties` 接口更新配置。`rest.debug.processes.enable=true` 配置的目的是允许执行调试进程，这为远程代码执行铺平了道路。(这部分未在提供的代码片段中。)
4. **远程代码执行：** 启用调试进程允许攻击者通过构造特定的请求来执行任意命令。

**有效性：** 根据漏洞信息和搜索结果，此POC代码有效，能够利用CVE-2023-42793漏洞实现RCE。

**投毒风险：** 检查提供的代码，主要逻辑集中在利用漏洞上，没有发现明显的恶意代码或后门。该代码是为了验证漏洞存在，并帮助安全研究人员和管理员修复漏洞，存在投毒代码的可能性较低。


**项目地址:** [StanleyJobsonAU/GhostTown](https://github.com/StanleyJobsonAU/GhostTown)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #7

**来源**: [CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md](../2023/CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器，且目标版本低于2023.05.4

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 存在于 JetBrains TeamCity 2023.05.4 之前的版本中，是一个身份验证绕过漏洞，可以导致未经身份验证的远程代码执行。攻击者可以利用此漏洞在 TeamCity 服务器上执行任意代码，从而完全控制服务器。漏洞利用方式如下：

1.  **身份验证绕过：** 利用漏洞绕过身份验证。
2.  **启用调试模式：** 通过修改 `internal.properties` 文件启用 `rest.debug.processes.enable`。
3.  **远程代码执行：** 使用 `/app/rest/debug/processes` 接口执行任意命令。脚本通过修改 `internal.properties` 文件，然后使用特制的请求调用 `debug/processes` 接口，从而在目标系统上执行任意命令。

提供的 `TeamCity.sh` 脚本允许用户指定目标操作系统 (Linux 或 Windows)，并相应地调整命令执行方式。脚本首先获取一个token，然后利用该 token 修改`internal.properties`文件以启用调试模式，最后使用构造好的包含恶意命令的URL来触发RCE。

投毒风险评估：代码中主要逻辑为漏洞利用，并未发现明显的恶意代码。`TeamCity.sh` 中选择目标OS后，Linux环境使用了`base64`编码命令，Windows没有。虽然脚本的行为符合漏洞利用的预期，但是如果攻击者对`base64` 编码方式做了手脚，有可能在Linux执行的时候插入恶意命令。`TeamCity2.sh` 脚本对命令进行URL编码，windows只支持powershell, 可以对powershell添加恶意payload. 因此，存在一定的投毒风险，估计在10%左右。

**项目地址:** [SwiftSecur/teamcity-exploit-cve-2023-42793](https://github.com/SwiftSecur/teamcity-exploit-cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #8

**来源**: [CVE-2023-42793-Zenmovie_CVE-2023-42793.md](../2023/CVE-2023-42793-Zenmovie_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity实例需要开启网络访问，且版本低于2023.05.4。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的远程攻击者绕过身份验证，并在服务器上执行任意代码。根据漏洞库信息，CVSS评分为9.8（严重）。

**利用方式：**

1.  **身份验证绕过：** 攻击者利用未经身份验证的REST API端点`/app/rest/users/id:1/tokens/RPC2`来获取一个有效的Bearer Token。这个Token最初的设计目的是允许用户通过API管理自己的Token。
2.  **修改内部属性：** 使用获取的Token，通过POST请求访问`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`修改内部属性，启用`rest.debug.processes.enable`，此步骤为后续RCE做准备。
3.  **远程代码执行：**  利用被启用的REST API端点`/app/rest/debug/processes?exePath=${COMMAND}`，通过`exePath`参数执行任意命令。该端点在正常情况下只允许经过身份验证的管理员访问，但由于身份验证绕过，未经授权的攻击者可以利用它。

**POC有效性：**

提供的POC代码包含两个脚本：`CVE-2023-42793_admin.sh`和`CVE-2023-42793_rce.sh`。

*   `CVE-2023-42793_admin.sh`脚本利用漏洞创建一个新的管理员用户（Zenmovie/Zenmovie），方便后续访问TeamCity。
*   `CVE-2023-42793_rce.sh`脚本利用漏洞执行指定的命令，并返回命令输出。

从提供的README.md中的截图以及漏洞原理来看，POC代码是有效的，可以成功利用该漏洞。

**投毒风险：**

评估投毒风险，需考虑作者是否有意在代码中添加恶意功能。

1.  **代码混淆/隐藏：** 代码没有进行明显的混淆。虽然使用了`grep`和`awk`提取Token和命令输出，但是属于正常利用。
2.  **恶意依赖：** 代码没有引入外部依赖。
3.  **后门代码：** 代码的主要功能是利用漏洞，创建管理员账户或执行命令。没有发现明显与漏洞利用无关的恶意代码，例如反弹shell、上传文件等。
4.  **隐蔽指令：**  检查代码中是否存在不易察觉的指令，例如通过环境变量、时间等触发的恶意行为。没有发现此类指令。

尽管POC的主要功能是漏洞利用，仍存在一定的投毒风险。例如，攻击者可能修改`CVE-2023-42793_rce.sh`脚本，在执行目标命令之前，先执行一些恶意操作，例如下载并执行恶意程序，添加后门账户等。这种风险很难通过静态分析完全排除，需要进行动态分析，实际运行poc代码进行监控。

因此，综合考虑，投毒风险评估为10%。这个风险主要来源于用户下载和使用POC时，可能会下载到被篡改过的恶意版本。

**结论：**

CVE-2023-42793是一个高危漏洞，利用简单，影响范围广。建议受影响的用户尽快升级到最新版本。在使用公开的POC代码时，务必谨慎，进行代码审计，并确保从可信来源下载。

**项目地址:** [Zenmovie/CVE-2023-42793](https://github.com/Zenmovie/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #9

**来源**: [CVE-2023-42793-becrevex_CVE-2023-42793.md](../2023/CVE-2023-42793-becrevex_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个认证绕过漏洞，攻击者无需认证即可利用此漏洞在TeamCity服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8，属于高危漏洞，并且已被积极利用。多家安全公司和组织（例如Rapid7，Fortinet，Microsoft，CISA）都发布了关于该漏洞的分析和利用报告，甚至有APT组织（APT29，北朝鲜黑客组织）利用该漏洞进行攻击。

提供的POC代码是一个Nmap脚本，用于检测目标TeamCity服务器是否存在CVE-2023-42793漏洞。该脚本通过向`/app/rest/users/id:1/tokens/RPC2`路径发送POST请求，尝试创建一个新的用户令牌，如果服务器返回200状态码且包含一个令牌，则表明服务器存在漏洞。该脚本本身的行为是良性的，只是用于验证漏洞的存在，没有发现任何投毒代码。

**有效性：**
根据提供的漏洞信息和POC代码，该POC代码有效，可以用于检测目标是否存在CVE-2023-42793漏洞。

**投毒风险：**
对提供的Nmap脚本进行了分析，没有发现任何明显的投毒代码。脚本的功能明确，即检测TeamCity服务器上的漏洞，没有发现任何恶意行为。风险评估为0%

**利用方式：**
1.  攻击者利用未授权访问漏洞，绕过身份验证。
2.  攻击者发送特制请求，例如向`/app/rest/users/id:1/tokens/RPC2`路径创建用户Token。
3.  成功创建Token后，攻击者获得管理员权限。
4.  利用管理员权限执行任意代码，实现远程代码执行。

该漏洞利用简单，影响严重，建议TeamCity用户尽快升级到2023.05.4或更高版本。

**项目地址:** [becrevex/CVE-2023-42793](https://github.com/becrevex/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #10

**来源**: [CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md](../2023/CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** JetBrains TeamCity

**危害等级:** 极高，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可从网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity 2023.05.4之前版本中存在的一个身份验证绕过漏洞，可能导致未经身份验证的远程代码执行。根据漏洞库信息，此漏洞的CVSS评分为9.8，属于严重级别。多个搜索结果表明，该漏洞已被积极利用，甚至被APT组织利用进行攻击。提供的POC代码是一个Python脚本，它利用漏洞执行远程命令。

**利用方式：**

1.  **身份验证绕过：** 该漏洞允许攻击者绕过TeamCity服务器的身份验证机制。
2.  **获取Bearer Token：** 利用未经身份验证的访问，通过`/app/rest/users/id:1/tokens/RPC2`端点创建一个临时的Bearer Token。
3.  **启用调试模式：** 使用获得的Bearer Token，通过`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`端点启用调试模式，即`rest.debug.processes.enable=true`。
4.  **远程代码执行：** 使用获得的Bearer Token，通过`/app/rest/debug/processes`端点执行任意命令。POC使用bash反弹shell，通过URL编码将命令传递给目标服务器。

**有效性评估：**

提供的POC代码看起来是有效的。它利用了TeamCity REST API中的漏洞，绕过身份验证并执行任意代码。 脚本首先尝试获取一个临时的Bearer Token，然后使用该Token来修改`internal.properties`文件以启用调试模式。最后，脚本使用调试模式来执行远程代码。 脚本的`README.md`文件中提供的参考链接也支持了该漏洞的存在和可利用性。搜索结果中大量的安全厂商报告和分析也证实了此漏洞的真实性和高危性。

**投毒风险评估：**

分析POC代码没有发现明显的投毒代码。脚本的功能主要集中在利用漏洞进行远程代码执行，没有发现额外的恶意行为或后门。该脚本的功能与漏洞描述以及利用方式相符，未发现任何异常行为。因此，投毒风险评估为0%。

**项目地址:** [hotplugin0x01/CVE-2023-42793](https://github.com/hotplugin0x01/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #11

**来源**: [CVE-2023-42793-jakehomb_cve-2023-42793.md](../2023/CVE-2023-42793-jakehomb_cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器版本低于2023.05.4，且可通过HTTP(S)访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2023-42793 允许未经身份验证的攻击者在 TeamCity 服务器上执行远程代码。该漏洞利用方式是通过绕过身份验证机制，直接访问受保护的资源并执行恶意操作。

**有效性：**
根据提供的漏洞信息、搜索结果以及漏洞利用代码，可以判断该漏洞的 POC 代码有效。CVE 详情中提到存在身份验证绕过导致 RCE，搜索结果也表明该漏洞存在公开可用的exploit，并且已经被APT29等恶意行为者利用。

**投毒风险：**
提供的漏洞利用代码主要由两部分组成：获取 Token 和创建用户。getToken 函数尝试从 /app/rest/users/id:1/token/RPC2 获取一个 Token，createUser 函数使用这个 Token 来创建一个具有管理员权限的用户。代码本身功能明确，没有发现隐藏的恶意代码。因此，评估该仓库中存在作者隐藏的投毒代码的风险为0%。

**利用方式：**
1.  **目标探测：** 确定目标 TeamCity 服务器的版本是否低于 2023.05.4。
2.  **Token 获取：** 使用 `getToken` 函数，通过向 `https://<teamcity_url>/app/rest/users/id:1/token/RPC2` 发送 GET 请求，尝试获取一个 Token。服务器无需授权即可响应。  `extractToken` 函数从响应中提取 Token。
3.  **用户创建：** 使用 `createUser` 函数，携带上一步获取的 Token，向 `https://<teamcity_url>/app/rest/users` 发送 POST 请求，创建一个具有 SYSTEM_ADMIN 角色的新用户。请求的 Body 为包含用户名、密码和邮箱的JSON格式。
4.  **权限提升：** 使用新创建的管理员用户登录 TeamCity 服务器，获得完全控制权限，从而执行任意代码。

**项目地址:** [jakehomb/cve-2023-42793](https://github.com/jakehomb/cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #12

**来源**: [CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md](../2023/CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行远程代码。该漏洞影响2023.05.4之前的版本。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的，并且已被广泛利用。CISA已将其添加到已知被利用漏洞目录中。搜索引擎结果中多个安全厂商的博客也证实了该漏洞的有效性。

**投毒风险：**
提供的PoC代码本身的功能是利用漏洞创建新的管理员用户。`README.md`文件描述了脚本的功能，与代码行为一致。代码中对创建的用户名称添加了随机数，并会写入 `vulnerable.txt` 文件。 `vulnerable.txt`文件可能存在信息泄露的风险,如果被攻击者获取，可能结合其他漏洞使用。总体来看，该PoC代码存在投毒风险的可能性较低，约为10%。

**利用方式：**
1.  **删除用户令牌：** PoC首先尝试删除ID为1的用户令牌 (通常是管理员)。
2.  **创建用户令牌：** 如果删除成功或不存在，PoC会尝试为ID为1的用户创建一个新的用户令牌。
3.  **创建管理员用户：** 使用新创建的用户令牌，PoC会创建一个具有`SYSTEM_ADMIN`权限的新用户，用户名和密码是硬编码的（用户名以 `_secops` 开头，加上随机数，密码是 `changeme`）。
4.  **利用新用户登录：** 攻击者可以使用新创建的管理员帐户登录TeamCity服务器，从而完全控制该服务器。
5.  **自动化攻击:** 通过-u指定url或者-l指定url列表，实现批量攻击。

**项目地址:** [johnossawy/CVE-2023-42793_POC](https://github.com/johnossawy/CVE-2023-42793_POC)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #13

**来源**: [CVE-2023-42793-junnythemarksman_CVE-2023-42793.md](../2023/CVE-2023-42793-junnythemarksman_CVE-2023-42793.md)

# CVE-2023-42793

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md](../2023/CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md)

## CVE-2023-42793 - TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个身份验证绕过漏洞，未经身份验证的攻击者可以通过发送特制的 HTTP 请求绕过身份验证，从而创建管理员账户并最终实现远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果中多个链接都提到了该漏洞被积极利用，包括APT组织。漏洞利用代码提供了创建管理员账户和执行RCE的脚本，并且说明了如何利用该漏洞，包括如何获取反向shell。

**投毒风险：**
分析提供的`exploit.py`和`rce_exploit.py`，主要功能是创建管理员账户和执行任意命令。脚本本身的代码逻辑相对简单，没有明显的恶意代码。其中`exploit.py`会生成随机用户名、密码和邮箱地址，这可能被误认为恶意行为，但这是为了方便利用而设计的，并非投毒。`rce_exploit.py`脚本依赖于第一个脚本创建的token文件。虽然没有发现明显的后门代码，但仍存在极小的风险，例如在生成随机字符串时引入偏差，虽然可能性极小，但理论上存在被利用的可能性，将投毒风险评定为5%。

**利用方式：**
1.  **身份验证绕过：** 攻击者首先利用身份验证绕过漏洞，该漏洞允许未经身份验证的攻击者与TeamCity服务器进行交互，绕过正常的身份验证流程。
2.  **创建管理员账户：** 使用 `exploit.py` 脚本，通过发送特制的 POST 请求，在 TeamCity 服务器上创建一个新的管理员账户。可以指定用户名、密码和邮箱，也可以使用随机生成的凭据。成功创建后，会将凭据保存到token文件中。
3.  **远程代码执行：** 使用 `rce.py` 脚本，该脚本首先启用debug processes，然后利用创建的管理员账户，通过 TeamCity 的 API 接口执行任意命令。可以执行系统命令，例如 `whoami`，也可以获取反向 shell，从而完全控制服务器。
4.  **反向Shell:** 利用rce.py执行命令，通过反弹shell到攻击者机器上，来获取服务器的控制权。


**项目地址:** [B4l3rI0n/CVE-2023-42793](https://github.com/B4l3rI0n/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #2

**来源**: [CVE-2023-42793-FlojBoj_CVE-2023-42793.md](../2023/CVE-2023-42793-FlojBoj_CVE-2023-42793.md)

## CVE-2023-42793-JetBrainsTeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可能导致远程代码执行和完全控制TeamCity服务器

**影响版本:** < 2023.05.4

**利用条件:** 需要能够通过HTTP(S)访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，攻击者无需身份验证即可执行远程代码。漏洞利用方式如下：

1.  **有效性：** 漏洞信息和搜索结果表明该漏洞已在野外被积极利用，包括APT组织（如APT29、CozyBear、北朝鲜黑客组织）和俄罗斯情报部门SVR。提供的代码`exploit.py`旨在利用此漏洞创建管理员账户或获取现有用户的token，从而控制TeamCity服务器。根据README.md的描述，还有一个`rce.py`脚本可以执行远程命令，但主脚本`exploit.py`的功能是创建管理员账户。

2.  **投毒风险：** 代码`exploit.py`本身的功能是利用漏洞创建管理员用户或获取token。投毒风险评估如下：
    *   代码中存在一些硬编码，例如默认密码"Password@123"和默认邮箱域名"@lol.omg"，如果直接使用这些默认值，容易被检测和防御。但这不属于投毒，而是简化使用的示例。
    *   代码尝试首先获取或删除现有的token，这增加了攻击成功的概率，但也可能在目标环境中留下痕迹。
    *   总体来看，`exploit.py`的主要风险在于被滥用以非法控制TeamCity服务器，而非恶意代码本身。因此，投毒风险较低，估计为10%。主要是担心引入了额外的请求或命令，用于收集用户信息或执行其他未经授权的操作。

3.  **利用方式：** 利用方式主要分为以下步骤：
    a.  攻击者发送特制的HTTP请求到TeamCity服务器，绕过身份验证。
    b.  使用`exploit.py`脚本，指定目标TeamCity服务器的URL。
    c.  脚本尝试获取或删除现有的token，然后创建一个新的管理员用户，或者获取指定用户的token。
    d.  如果成功创建管理员用户，攻击者可以使用新创建的管理员账户登录TeamCity服务器，并获得完全控制权限。
    e. 通过获取到的token, 攻击者可以模拟用户身份，从而执行相关操作。

该漏洞的严重性在于未经身份验证即可创建管理员帐户并执行任意代码，从而完全控制受影响的TeamCity服务器。缓解措施包括尽快升级到2023.05.4或更高版本。

**项目地址:** [FlojBoj/CVE-2023-42793](https://github.com/FlojBoj/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #3

**来源**: [CVE-2023-42793-H454NSec_CVE-2023-42793.md](../2023/CVE-2023-42793-H454NSec_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从攻击者控制的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 漏洞存在于JetBrains TeamCity 2023.05.4 之前的版本中，允许未经身份验证的攻击者绕过身份验证，最终实现远程代码执行。根据漏洞库信息，该漏洞的 CVSS 3.1 评分为 9.8，属于严重级别。搜索结果表明，该漏洞已被广泛利用，甚至被 APT 组织用于攻击活动。 

**漏洞利用方式：**

1.  **身份验证绕过：** 漏洞利用代码通过发送特制的 HTTP 请求来绕过 TeamCity 的身份验证机制。具体利用细节需要分析补丁或者参考其他分析报告。
2.  **创建管理员用户：** 漏洞利用代码首先删除 id 为 1 的用户的token，然后创建一个新的用户 token。使用这个 token，攻击者可以创建一个具有管理员权限的新用户。新用户的用户名和密码可以通过命令行参数指定，默认用户名为 `H454NSec[随机数]`，密码为 `@H454NSec`。利用成功后，即可使用创建的管理员用户登录TeamCity控制台。
3.  **远程代码执行：** 通过管理员权限，攻击者可以在 TeamCity 服务器上执行任意代码，实现远程控制。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确定该 POC 代码是有效的。漏洞已被公开披露且有可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。风险分析如下：

*   **代码结构：** 代码结构相对清晰，主要功能是利用漏洞创建管理员用户。
*   **可疑行为：** 代码中存在以下潜在风险：
    *   **默认用户名和密码：** 使用默认的用户名和密码 `@H454NSec` 创建管理员帐户，这可能会让其他攻击者更容易入侵，或者导致安全审计告警。
    *   **硬编码的 User-Agent：**  User-Agent头 `Mozilla/5.0 (https://github.com/H454NSec/CVE-2023-42793) Gecko/20100101 Firefox/113.0`  可能被用于追踪攻击源。但同时也降低了攻击的隐蔽性。
    *   **未处理异常：** 虽然代码有异常处理，但仅仅是简单的`pass`，可能会隐藏一些错误信息，增加调试难度。
*   **高危操作：**  漏洞利用本身就是高危操作，如果攻击者通过修改poc加入恶意命令，将会造成严重危害，例如植入后门。

综合考虑以上因素，该 POC 代码的投毒风险评估为 10%。主要风险在于攻击者可能利用该代码进行二次修改，加入恶意代码或后门，从而扩大攻击范围。

**项目地址:** [H454NSec/CVE-2023-42793](https://github.com/H454NSec/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #4

**来源**: [CVE-2023-42793-HusenjanDev_CVE-2023-42793.md](../2023/CVE-2023-42793-HusenjanDev_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从网络访问，需要通过其他途径获取TeamCity Token。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，允许未经身份验证的攻击者通过HTTP(S)访问TeamCity服务器，并执行远程代码。根据漏洞库信息，CVSS评分为9.8，属于严重级别。搜索引擎结果显示，该漏洞已被多个APT组织利用，包括APT29、北朝鲜的Diamond Sleet和Onyx Sleet以及俄罗斯对外情报局 (SVR)，显示其真实性和危害性。Rapid7的博客文章也详细分析了该漏洞。提供的POC代码的利用方式是：

1.  **获取TeamCity Token:**  `readme.md` 中提到，需要通过其他漏洞或者方式获取TeamCity的Token. 这是利用此POC的前提。
2.  **启用调试模式:** 使用curl命令发送POST请求到`/admin/dataDir.html`，修改`config/internal.properties`文件，启用`rest.debug.processes.enable=true`，从而开启调试模式。这一步通过token进行验证。
3.  **构造反弹shell Payload:**  将反弹shell命令进行URL编码，目标是让受害者主机连接攻击者的Netcat监听器。
4.  **执行远程命令:** 使用curl命令发送POST请求到`/app/rest/debug/processes`，指定`exePath`为`/bin/bash`，`params`为`-c`和URL编码后的反弹shell命令。这个请求同样需要token验证。漏洞利用依赖于已获取的TeamCity token，然后通过启用调试模式执行反弹shell。根据分析，该POC代码没有明显的投毒行为。

**项目地址:** [HusenjanDev/CVE-2023-42793](https://github.com/HusenjanDev/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #5

**来源**: [CVE-2023-42793-LeHeron_TC_test.md](../2023/CVE-2023-42793-LeHeron_TC_test.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个严重的身份验证绕过漏洞，攻击者无需身份验证即可在 TeamCity 服务器上执行远程代码。根据漏洞信息和搜索结果，该漏洞已被积极利用，甚至APT组织，如CozyBear，以及北朝鲜的APT组织都在利用该漏洞。 

**有效性：**
根据搜索结果，此漏洞已经存在公开的利用代码，且已被广泛利用，证明漏洞有效。

**投毒风险：**
提供的漏洞利用代码 `/tmp/da0475f0898b55e5196bf0f36ac9d45e/README`  只是一个简单的README文件，内容为 “Hello World”，不包含任何可执行代码或恶意指令。投毒的可能性极低，可以认为几乎不存在，给到1%的可能也只是对未知风险的保留。

**利用方式：**
根据漏洞描述，攻击者可以通过未授权访问TeamCity服务器，从而执行任意代码。具体的利用方式可能涉及到构造特定的HTTP请求绕过身份验证机制，然后利用TeamCity服务器的功能执行恶意命令。参考Rapid7的博客文章，该漏洞利用可能与特定的端点和参数有关，允许攻击者创建管理员用户或直接执行代码。 从搜索结果来看，该漏洞已经成为恶意行为者的攻击目标，建议尽快升级到安全版本。

**项目地址:** [LeHeron/TC_test](https://github.com/LeHeron/TC_test)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #6

**来源**: [CVE-2023-42793-StanleyJobsonAU_GhostTown.md](../2023/CVE-2023-42793-StanleyJobsonAU_GhostTown.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个身份验证绕过漏洞，允许未经身份验证的攻击者远程执行代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8（严重），并且已被积极利用。搜索结果表明，包括APT29、朝鲜黑客组织以及俄罗斯对外情报局（SVR）等多个威胁组织都在利用此漏洞。提供的POC代码 `GhostTown.py` 旨在利用此漏洞。利用方式如下：

1.  **生成管理员Token：** POC首先尝试通过 `/app/rest/users/id:1/tokens/RPC2` 接口创建一个管理员Token。这将绕过身份验证。
2.  **检索内部配置：** 使用生成的管理员Token，POC尝试从 `/get/file/dataDir/config/internal.properties` 接口检索TeamCity的内部配置。
3.  **更新配置：** POC会检查配置项中是否包含 `rest.debug.processes.enable=true`，如果不存在，则将其添加到配置项中，并通过 `/get/file/dataDir/config/internal.properties` 接口更新配置。`rest.debug.processes.enable=true` 配置的目的是允许执行调试进程，这为远程代码执行铺平了道路。(这部分未在提供的代码片段中。)
4. **远程代码执行：** 启用调试进程允许攻击者通过构造特定的请求来执行任意命令。

**有效性：** 根据漏洞信息和搜索结果，此POC代码有效，能够利用CVE-2023-42793漏洞实现RCE。

**投毒风险：** 检查提供的代码，主要逻辑集中在利用漏洞上，没有发现明显的恶意代码或后门。该代码是为了验证漏洞存在，并帮助安全研究人员和管理员修复漏洞，存在投毒代码的可能性较低。


**项目地址:** [StanleyJobsonAU/GhostTown](https://github.com/StanleyJobsonAU/GhostTown)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #7

**来源**: [CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md](../2023/CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器，且目标版本低于2023.05.4

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 存在于 JetBrains TeamCity 2023.05.4 之前的版本中，是一个身份验证绕过漏洞，可以导致未经身份验证的远程代码执行。攻击者可以利用此漏洞在 TeamCity 服务器上执行任意代码，从而完全控制服务器。漏洞利用方式如下：

1.  **身份验证绕过：** 利用漏洞绕过身份验证。
2.  **启用调试模式：** 通过修改 `internal.properties` 文件启用 `rest.debug.processes.enable`。
3.  **远程代码执行：** 使用 `/app/rest/debug/processes` 接口执行任意命令。脚本通过修改 `internal.properties` 文件，然后使用特制的请求调用 `debug/processes` 接口，从而在目标系统上执行任意命令。

提供的 `TeamCity.sh` 脚本允许用户指定目标操作系统 (Linux 或 Windows)，并相应地调整命令执行方式。脚本首先获取一个token，然后利用该 token 修改`internal.properties`文件以启用调试模式，最后使用构造好的包含恶意命令的URL来触发RCE。

投毒风险评估：代码中主要逻辑为漏洞利用，并未发现明显的恶意代码。`TeamCity.sh` 中选择目标OS后，Linux环境使用了`base64`编码命令，Windows没有。虽然脚本的行为符合漏洞利用的预期，但是如果攻击者对`base64` 编码方式做了手脚，有可能在Linux执行的时候插入恶意命令。`TeamCity2.sh` 脚本对命令进行URL编码，windows只支持powershell, 可以对powershell添加恶意payload. 因此，存在一定的投毒风险，估计在10%左右。

**项目地址:** [SwiftSecur/teamcity-exploit-cve-2023-42793](https://github.com/SwiftSecur/teamcity-exploit-cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #8

**来源**: [CVE-2023-42793-Zenmovie_CVE-2023-42793.md](../2023/CVE-2023-42793-Zenmovie_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity实例需要开启网络访问，且版本低于2023.05.4。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的远程攻击者绕过身份验证，并在服务器上执行任意代码。根据漏洞库信息，CVSS评分为9.8（严重）。

**利用方式：**

1.  **身份验证绕过：** 攻击者利用未经身份验证的REST API端点`/app/rest/users/id:1/tokens/RPC2`来获取一个有效的Bearer Token。这个Token最初的设计目的是允许用户通过API管理自己的Token。
2.  **修改内部属性：** 使用获取的Token，通过POST请求访问`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`修改内部属性，启用`rest.debug.processes.enable`，此步骤为后续RCE做准备。
3.  **远程代码执行：**  利用被启用的REST API端点`/app/rest/debug/processes?exePath=${COMMAND}`，通过`exePath`参数执行任意命令。该端点在正常情况下只允许经过身份验证的管理员访问，但由于身份验证绕过，未经授权的攻击者可以利用它。

**POC有效性：**

提供的POC代码包含两个脚本：`CVE-2023-42793_admin.sh`和`CVE-2023-42793_rce.sh`。

*   `CVE-2023-42793_admin.sh`脚本利用漏洞创建一个新的管理员用户（Zenmovie/Zenmovie），方便后续访问TeamCity。
*   `CVE-2023-42793_rce.sh`脚本利用漏洞执行指定的命令，并返回命令输出。

从提供的README.md中的截图以及漏洞原理来看，POC代码是有效的，可以成功利用该漏洞。

**投毒风险：**

评估投毒风险，需考虑作者是否有意在代码中添加恶意功能。

1.  **代码混淆/隐藏：** 代码没有进行明显的混淆。虽然使用了`grep`和`awk`提取Token和命令输出，但是属于正常利用。
2.  **恶意依赖：** 代码没有引入外部依赖。
3.  **后门代码：** 代码的主要功能是利用漏洞，创建管理员账户或执行命令。没有发现明显与漏洞利用无关的恶意代码，例如反弹shell、上传文件等。
4.  **隐蔽指令：**  检查代码中是否存在不易察觉的指令，例如通过环境变量、时间等触发的恶意行为。没有发现此类指令。

尽管POC的主要功能是漏洞利用，仍存在一定的投毒风险。例如，攻击者可能修改`CVE-2023-42793_rce.sh`脚本，在执行目标命令之前，先执行一些恶意操作，例如下载并执行恶意程序，添加后门账户等。这种风险很难通过静态分析完全排除，需要进行动态分析，实际运行poc代码进行监控。

因此，综合考虑，投毒风险评估为10%。这个风险主要来源于用户下载和使用POC时，可能会下载到被篡改过的恶意版本。

**结论：**

CVE-2023-42793是一个高危漏洞，利用简单，影响范围广。建议受影响的用户尽快升级到最新版本。在使用公开的POC代码时，务必谨慎，进行代码审计，并确保从可信来源下载。

**项目地址:** [Zenmovie/CVE-2023-42793](https://github.com/Zenmovie/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #9

**来源**: [CVE-2023-42793-becrevex_CVE-2023-42793.md](../2023/CVE-2023-42793-becrevex_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个认证绕过漏洞，攻击者无需认证即可利用此漏洞在TeamCity服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8，属于高危漏洞，并且已被积极利用。多家安全公司和组织（例如Rapid7，Fortinet，Microsoft，CISA）都发布了关于该漏洞的分析和利用报告，甚至有APT组织（APT29，北朝鲜黑客组织）利用该漏洞进行攻击。

提供的POC代码是一个Nmap脚本，用于检测目标TeamCity服务器是否存在CVE-2023-42793漏洞。该脚本通过向`/app/rest/users/id:1/tokens/RPC2`路径发送POST请求，尝试创建一个新的用户令牌，如果服务器返回200状态码且包含一个令牌，则表明服务器存在漏洞。该脚本本身的行为是良性的，只是用于验证漏洞的存在，没有发现任何投毒代码。

**有效性：**
根据提供的漏洞信息和POC代码，该POC代码有效，可以用于检测目标是否存在CVE-2023-42793漏洞。

**投毒风险：**
对提供的Nmap脚本进行了分析，没有发现任何明显的投毒代码。脚本的功能明确，即检测TeamCity服务器上的漏洞，没有发现任何恶意行为。风险评估为0%

**利用方式：**
1.  攻击者利用未授权访问漏洞，绕过身份验证。
2.  攻击者发送特制请求，例如向`/app/rest/users/id:1/tokens/RPC2`路径创建用户Token。
3.  成功创建Token后，攻击者获得管理员权限。
4.  利用管理员权限执行任意代码，实现远程代码执行。

该漏洞利用简单，影响严重，建议TeamCity用户尽快升级到2023.05.4或更高版本。

**项目地址:** [becrevex/CVE-2023-42793](https://github.com/becrevex/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #10

**来源**: [CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md](../2023/CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** JetBrains TeamCity

**危害等级:** 极高，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可从网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity 2023.05.4之前版本中存在的一个身份验证绕过漏洞，可能导致未经身份验证的远程代码执行。根据漏洞库信息，此漏洞的CVSS评分为9.8，属于严重级别。多个搜索结果表明，该漏洞已被积极利用，甚至被APT组织利用进行攻击。提供的POC代码是一个Python脚本，它利用漏洞执行远程命令。

**利用方式：**

1.  **身份验证绕过：** 该漏洞允许攻击者绕过TeamCity服务器的身份验证机制。
2.  **获取Bearer Token：** 利用未经身份验证的访问，通过`/app/rest/users/id:1/tokens/RPC2`端点创建一个临时的Bearer Token。
3.  **启用调试模式：** 使用获得的Bearer Token，通过`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`端点启用调试模式，即`rest.debug.processes.enable=true`。
4.  **远程代码执行：** 使用获得的Bearer Token，通过`/app/rest/debug/processes`端点执行任意命令。POC使用bash反弹shell，通过URL编码将命令传递给目标服务器。

**有效性评估：**

提供的POC代码看起来是有效的。它利用了TeamCity REST API中的漏洞，绕过身份验证并执行任意代码。 脚本首先尝试获取一个临时的Bearer Token，然后使用该Token来修改`internal.properties`文件以启用调试模式。最后，脚本使用调试模式来执行远程代码。 脚本的`README.md`文件中提供的参考链接也支持了该漏洞的存在和可利用性。搜索结果中大量的安全厂商报告和分析也证实了此漏洞的真实性和高危性。

**投毒风险评估：**

分析POC代码没有发现明显的投毒代码。脚本的功能主要集中在利用漏洞进行远程代码执行，没有发现额外的恶意行为或后门。该脚本的功能与漏洞描述以及利用方式相符，未发现任何异常行为。因此，投毒风险评估为0%。

**项目地址:** [hotplugin0x01/CVE-2023-42793](https://github.com/hotplugin0x01/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #11

**来源**: [CVE-2023-42793-jakehomb_cve-2023-42793.md](../2023/CVE-2023-42793-jakehomb_cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器版本低于2023.05.4，且可通过HTTP(S)访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2023-42793 允许未经身份验证的攻击者在 TeamCity 服务器上执行远程代码。该漏洞利用方式是通过绕过身份验证机制，直接访问受保护的资源并执行恶意操作。

**有效性：**
根据提供的漏洞信息、搜索结果以及漏洞利用代码，可以判断该漏洞的 POC 代码有效。CVE 详情中提到存在身份验证绕过导致 RCE，搜索结果也表明该漏洞存在公开可用的exploit，并且已经被APT29等恶意行为者利用。

**投毒风险：**
提供的漏洞利用代码主要由两部分组成：获取 Token 和创建用户。getToken 函数尝试从 /app/rest/users/id:1/token/RPC2 获取一个 Token，createUser 函数使用这个 Token 来创建一个具有管理员权限的用户。代码本身功能明确，没有发现隐藏的恶意代码。因此，评估该仓库中存在作者隐藏的投毒代码的风险为0%。

**利用方式：**
1.  **目标探测：** 确定目标 TeamCity 服务器的版本是否低于 2023.05.4。
2.  **Token 获取：** 使用 `getToken` 函数，通过向 `https://<teamcity_url>/app/rest/users/id:1/token/RPC2` 发送 GET 请求，尝试获取一个 Token。服务器无需授权即可响应。  `extractToken` 函数从响应中提取 Token。
3.  **用户创建：** 使用 `createUser` 函数，携带上一步获取的 Token，向 `https://<teamcity_url>/app/rest/users` 发送 POST 请求，创建一个具有 SYSTEM_ADMIN 角色的新用户。请求的 Body 为包含用户名、密码和邮箱的JSON格式。
4.  **权限提升：** 使用新创建的管理员用户登录 TeamCity 服务器，获得完全控制权限，从而执行任意代码。

**项目地址:** [jakehomb/cve-2023-42793](https://github.com/jakehomb/cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #12

**来源**: [CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md](../2023/CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行远程代码。该漏洞影响2023.05.4之前的版本。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的，并且已被广泛利用。CISA已将其添加到已知被利用漏洞目录中。搜索引擎结果中多个安全厂商的博客也证实了该漏洞的有效性。

**投毒风险：**
提供的PoC代码本身的功能是利用漏洞创建新的管理员用户。`README.md`文件描述了脚本的功能，与代码行为一致。代码中对创建的用户名称添加了随机数，并会写入 `vulnerable.txt` 文件。 `vulnerable.txt`文件可能存在信息泄露的风险,如果被攻击者获取，可能结合其他漏洞使用。总体来看，该PoC代码存在投毒风险的可能性较低，约为10%。

**利用方式：**
1.  **删除用户令牌：** PoC首先尝试删除ID为1的用户令牌 (通常是管理员)。
2.  **创建用户令牌：** 如果删除成功或不存在，PoC会尝试为ID为1的用户创建一个新的用户令牌。
3.  **创建管理员用户：** 使用新创建的用户令牌，PoC会创建一个具有`SYSTEM_ADMIN`权限的新用户，用户名和密码是硬编码的（用户名以 `_secops` 开头，加上随机数，密码是 `changeme`）。
4.  **利用新用户登录：** 攻击者可以使用新创建的管理员帐户登录TeamCity服务器，从而完全控制该服务器。
5.  **自动化攻击:** 通过-u指定url或者-l指定url列表，实现批量攻击。

**项目地址:** [johnossawy/CVE-2023-42793_POC](https://github.com/johnossawy/CVE-2023-42793_POC)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #13

**来源**: [CVE-2023-42793-junnythemarksman_CVE-2023-42793.md](../2023/CVE-2023-42793-junnythemarksman_CVE-2023-42793.md)

# CVE-2023-42793

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md](../2023/CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md)

## CVE-2023-42793 - TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个身份验证绕过漏洞，未经身份验证的攻击者可以通过发送特制的 HTTP 请求绕过身份验证，从而创建管理员账户并最终实现远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果中多个链接都提到了该漏洞被积极利用，包括APT组织。漏洞利用代码提供了创建管理员账户和执行RCE的脚本，并且说明了如何利用该漏洞，包括如何获取反向shell。

**投毒风险：**
分析提供的`exploit.py`和`rce_exploit.py`，主要功能是创建管理员账户和执行任意命令。脚本本身的代码逻辑相对简单，没有明显的恶意代码。其中`exploit.py`会生成随机用户名、密码和邮箱地址，这可能被误认为恶意行为，但这是为了方便利用而设计的，并非投毒。`rce_exploit.py`脚本依赖于第一个脚本创建的token文件。虽然没有发现明显的后门代码，但仍存在极小的风险，例如在生成随机字符串时引入偏差，虽然可能性极小，但理论上存在被利用的可能性，将投毒风险评定为5%。

**利用方式：**
1.  **身份验证绕过：** 攻击者首先利用身份验证绕过漏洞，该漏洞允许未经身份验证的攻击者与TeamCity服务器进行交互，绕过正常的身份验证流程。
2.  **创建管理员账户：** 使用 `exploit.py` 脚本，通过发送特制的 POST 请求，在 TeamCity 服务器上创建一个新的管理员账户。可以指定用户名、密码和邮箱，也可以使用随机生成的凭据。成功创建后，会将凭据保存到token文件中。
3.  **远程代码执行：** 使用 `rce.py` 脚本，该脚本首先启用debug processes，然后利用创建的管理员账户，通过 TeamCity 的 API 接口执行任意命令。可以执行系统命令，例如 `whoami`，也可以获取反向 shell，从而完全控制服务器。
4.  **反向Shell:** 利用rce.py执行命令，通过反弹shell到攻击者机器上，来获取服务器的控制权。


**项目地址:** [B4l3rI0n/CVE-2023-42793](https://github.com/B4l3rI0n/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #2

**来源**: [CVE-2023-42793-FlojBoj_CVE-2023-42793.md](../2023/CVE-2023-42793-FlojBoj_CVE-2023-42793.md)

## CVE-2023-42793-JetBrainsTeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可能导致远程代码执行和完全控制TeamCity服务器

**影响版本:** < 2023.05.4

**利用条件:** 需要能够通过HTTP(S)访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，攻击者无需身份验证即可执行远程代码。漏洞利用方式如下：

1.  **有效性：** 漏洞信息和搜索结果表明该漏洞已在野外被积极利用，包括APT组织（如APT29、CozyBear、北朝鲜黑客组织）和俄罗斯情报部门SVR。提供的代码`exploit.py`旨在利用此漏洞创建管理员账户或获取现有用户的token，从而控制TeamCity服务器。根据README.md的描述，还有一个`rce.py`脚本可以执行远程命令，但主脚本`exploit.py`的功能是创建管理员账户。

2.  **投毒风险：** 代码`exploit.py`本身的功能是利用漏洞创建管理员用户或获取token。投毒风险评估如下：
    *   代码中存在一些硬编码，例如默认密码"Password@123"和默认邮箱域名"@lol.omg"，如果直接使用这些默认值，容易被检测和防御。但这不属于投毒，而是简化使用的示例。
    *   代码尝试首先获取或删除现有的token，这增加了攻击成功的概率，但也可能在目标环境中留下痕迹。
    *   总体来看，`exploit.py`的主要风险在于被滥用以非法控制TeamCity服务器，而非恶意代码本身。因此，投毒风险较低，估计为10%。主要是担心引入了额外的请求或命令，用于收集用户信息或执行其他未经授权的操作。

3.  **利用方式：** 利用方式主要分为以下步骤：
    a.  攻击者发送特制的HTTP请求到TeamCity服务器，绕过身份验证。
    b.  使用`exploit.py`脚本，指定目标TeamCity服务器的URL。
    c.  脚本尝试获取或删除现有的token，然后创建一个新的管理员用户，或者获取指定用户的token。
    d.  如果成功创建管理员用户，攻击者可以使用新创建的管理员账户登录TeamCity服务器，并获得完全控制权限。
    e. 通过获取到的token, 攻击者可以模拟用户身份，从而执行相关操作。

该漏洞的严重性在于未经身份验证即可创建管理员帐户并执行任意代码，从而完全控制受影响的TeamCity服务器。缓解措施包括尽快升级到2023.05.4或更高版本。

**项目地址:** [FlojBoj/CVE-2023-42793](https://github.com/FlojBoj/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #3

**来源**: [CVE-2023-42793-H454NSec_CVE-2023-42793.md](../2023/CVE-2023-42793-H454NSec_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从攻击者控制的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 漏洞存在于JetBrains TeamCity 2023.05.4 之前的版本中，允许未经身份验证的攻击者绕过身份验证，最终实现远程代码执行。根据漏洞库信息，该漏洞的 CVSS 3.1 评分为 9.8，属于严重级别。搜索结果表明，该漏洞已被广泛利用，甚至被 APT 组织用于攻击活动。 

**漏洞利用方式：**

1.  **身份验证绕过：** 漏洞利用代码通过发送特制的 HTTP 请求来绕过 TeamCity 的身份验证机制。具体利用细节需要分析补丁或者参考其他分析报告。
2.  **创建管理员用户：** 漏洞利用代码首先删除 id 为 1 的用户的token，然后创建一个新的用户 token。使用这个 token，攻击者可以创建一个具有管理员权限的新用户。新用户的用户名和密码可以通过命令行参数指定，默认用户名为 `H454NSec[随机数]`，密码为 `@H454NSec`。利用成功后，即可使用创建的管理员用户登录TeamCity控制台。
3.  **远程代码执行：** 通过管理员权限，攻击者可以在 TeamCity 服务器上执行任意代码，实现远程控制。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确定该 POC 代码是有效的。漏洞已被公开披露且有可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。风险分析如下：

*   **代码结构：** 代码结构相对清晰，主要功能是利用漏洞创建管理员用户。
*   **可疑行为：** 代码中存在以下潜在风险：
    *   **默认用户名和密码：** 使用默认的用户名和密码 `@H454NSec` 创建管理员帐户，这可能会让其他攻击者更容易入侵，或者导致安全审计告警。
    *   **硬编码的 User-Agent：**  User-Agent头 `Mozilla/5.0 (https://github.com/H454NSec/CVE-2023-42793) Gecko/20100101 Firefox/113.0`  可能被用于追踪攻击源。但同时也降低了攻击的隐蔽性。
    *   **未处理异常：** 虽然代码有异常处理，但仅仅是简单的`pass`，可能会隐藏一些错误信息，增加调试难度。
*   **高危操作：**  漏洞利用本身就是高危操作，如果攻击者通过修改poc加入恶意命令，将会造成严重危害，例如植入后门。

综合考虑以上因素，该 POC 代码的投毒风险评估为 10%。主要风险在于攻击者可能利用该代码进行二次修改，加入恶意代码或后门，从而扩大攻击范围。

**项目地址:** [H454NSec/CVE-2023-42793](https://github.com/H454NSec/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #4

**来源**: [CVE-2023-42793-HusenjanDev_CVE-2023-42793.md](../2023/CVE-2023-42793-HusenjanDev_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从网络访问，需要通过其他途径获取TeamCity Token。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，允许未经身份验证的攻击者通过HTTP(S)访问TeamCity服务器，并执行远程代码。根据漏洞库信息，CVSS评分为9.8，属于严重级别。搜索引擎结果显示，该漏洞已被多个APT组织利用，包括APT29、北朝鲜的Diamond Sleet和Onyx Sleet以及俄罗斯对外情报局 (SVR)，显示其真实性和危害性。Rapid7的博客文章也详细分析了该漏洞。提供的POC代码的利用方式是：

1.  **获取TeamCity Token:**  `readme.md` 中提到，需要通过其他漏洞或者方式获取TeamCity的Token. 这是利用此POC的前提。
2.  **启用调试模式:** 使用curl命令发送POST请求到`/admin/dataDir.html`，修改`config/internal.properties`文件，启用`rest.debug.processes.enable=true`，从而开启调试模式。这一步通过token进行验证。
3.  **构造反弹shell Payload:**  将反弹shell命令进行URL编码，目标是让受害者主机连接攻击者的Netcat监听器。
4.  **执行远程命令:** 使用curl命令发送POST请求到`/app/rest/debug/processes`，指定`exePath`为`/bin/bash`，`params`为`-c`和URL编码后的反弹shell命令。这个请求同样需要token验证。漏洞利用依赖于已获取的TeamCity token，然后通过启用调试模式执行反弹shell。根据分析，该POC代码没有明显的投毒行为。

**项目地址:** [HusenjanDev/CVE-2023-42793](https://github.com/HusenjanDev/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #5

**来源**: [CVE-2023-42793-LeHeron_TC_test.md](../2023/CVE-2023-42793-LeHeron_TC_test.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个严重的身份验证绕过漏洞，攻击者无需身份验证即可在 TeamCity 服务器上执行远程代码。根据漏洞信息和搜索结果，该漏洞已被积极利用，甚至APT组织，如CozyBear，以及北朝鲜的APT组织都在利用该漏洞。 

**有效性：**
根据搜索结果，此漏洞已经存在公开的利用代码，且已被广泛利用，证明漏洞有效。

**投毒风险：**
提供的漏洞利用代码 `/tmp/da0475f0898b55e5196bf0f36ac9d45e/README`  只是一个简单的README文件，内容为 “Hello World”，不包含任何可执行代码或恶意指令。投毒的可能性极低，可以认为几乎不存在，给到1%的可能也只是对未知风险的保留。

**利用方式：**
根据漏洞描述，攻击者可以通过未授权访问TeamCity服务器，从而执行任意代码。具体的利用方式可能涉及到构造特定的HTTP请求绕过身份验证机制，然后利用TeamCity服务器的功能执行恶意命令。参考Rapid7的博客文章，该漏洞利用可能与特定的端点和参数有关，允许攻击者创建管理员用户或直接执行代码。 从搜索结果来看，该漏洞已经成为恶意行为者的攻击目标，建议尽快升级到安全版本。

**项目地址:** [LeHeron/TC_test](https://github.com/LeHeron/TC_test)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #6

**来源**: [CVE-2023-42793-StanleyJobsonAU_GhostTown.md](../2023/CVE-2023-42793-StanleyJobsonAU_GhostTown.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个身份验证绕过漏洞，允许未经身份验证的攻击者远程执行代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8（严重），并且已被积极利用。搜索结果表明，包括APT29、朝鲜黑客组织以及俄罗斯对外情报局（SVR）等多个威胁组织都在利用此漏洞。提供的POC代码 `GhostTown.py` 旨在利用此漏洞。利用方式如下：

1.  **生成管理员Token：** POC首先尝试通过 `/app/rest/users/id:1/tokens/RPC2` 接口创建一个管理员Token。这将绕过身份验证。
2.  **检索内部配置：** 使用生成的管理员Token，POC尝试从 `/get/file/dataDir/config/internal.properties` 接口检索TeamCity的内部配置。
3.  **更新配置：** POC会检查配置项中是否包含 `rest.debug.processes.enable=true`，如果不存在，则将其添加到配置项中，并通过 `/get/file/dataDir/config/internal.properties` 接口更新配置。`rest.debug.processes.enable=true` 配置的目的是允许执行调试进程，这为远程代码执行铺平了道路。(这部分未在提供的代码片段中。)
4. **远程代码执行：** 启用调试进程允许攻击者通过构造特定的请求来执行任意命令。

**有效性：** 根据漏洞信息和搜索结果，此POC代码有效，能够利用CVE-2023-42793漏洞实现RCE。

**投毒风险：** 检查提供的代码，主要逻辑集中在利用漏洞上，没有发现明显的恶意代码或后门。该代码是为了验证漏洞存在，并帮助安全研究人员和管理员修复漏洞，存在投毒代码的可能性较低。


**项目地址:** [StanleyJobsonAU/GhostTown](https://github.com/StanleyJobsonAU/GhostTown)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #7

**来源**: [CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md](../2023/CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器，且目标版本低于2023.05.4

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 存在于 JetBrains TeamCity 2023.05.4 之前的版本中，是一个身份验证绕过漏洞，可以导致未经身份验证的远程代码执行。攻击者可以利用此漏洞在 TeamCity 服务器上执行任意代码，从而完全控制服务器。漏洞利用方式如下：

1.  **身份验证绕过：** 利用漏洞绕过身份验证。
2.  **启用调试模式：** 通过修改 `internal.properties` 文件启用 `rest.debug.processes.enable`。
3.  **远程代码执行：** 使用 `/app/rest/debug/processes` 接口执行任意命令。脚本通过修改 `internal.properties` 文件，然后使用特制的请求调用 `debug/processes` 接口，从而在目标系统上执行任意命令。

提供的 `TeamCity.sh` 脚本允许用户指定目标操作系统 (Linux 或 Windows)，并相应地调整命令执行方式。脚本首先获取一个token，然后利用该 token 修改`internal.properties`文件以启用调试模式，最后使用构造好的包含恶意命令的URL来触发RCE。

投毒风险评估：代码中主要逻辑为漏洞利用，并未发现明显的恶意代码。`TeamCity.sh` 中选择目标OS后，Linux环境使用了`base64`编码命令，Windows没有。虽然脚本的行为符合漏洞利用的预期，但是如果攻击者对`base64` 编码方式做了手脚，有可能在Linux执行的时候插入恶意命令。`TeamCity2.sh` 脚本对命令进行URL编码，windows只支持powershell, 可以对powershell添加恶意payload. 因此，存在一定的投毒风险，估计在10%左右。

**项目地址:** [SwiftSecur/teamcity-exploit-cve-2023-42793](https://github.com/SwiftSecur/teamcity-exploit-cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #8

**来源**: [CVE-2023-42793-Zenmovie_CVE-2023-42793.md](../2023/CVE-2023-42793-Zenmovie_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity实例需要开启网络访问，且版本低于2023.05.4。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的远程攻击者绕过身份验证，并在服务器上执行任意代码。根据漏洞库信息，CVSS评分为9.8（严重）。

**利用方式：**

1.  **身份验证绕过：** 攻击者利用未经身份验证的REST API端点`/app/rest/users/id:1/tokens/RPC2`来获取一个有效的Bearer Token。这个Token最初的设计目的是允许用户通过API管理自己的Token。
2.  **修改内部属性：** 使用获取的Token，通过POST请求访问`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`修改内部属性，启用`rest.debug.processes.enable`，此步骤为后续RCE做准备。
3.  **远程代码执行：**  利用被启用的REST API端点`/app/rest/debug/processes?exePath=${COMMAND}`，通过`exePath`参数执行任意命令。该端点在正常情况下只允许经过身份验证的管理员访问，但由于身份验证绕过，未经授权的攻击者可以利用它。

**POC有效性：**

提供的POC代码包含两个脚本：`CVE-2023-42793_admin.sh`和`CVE-2023-42793_rce.sh`。

*   `CVE-2023-42793_admin.sh`脚本利用漏洞创建一个新的管理员用户（Zenmovie/Zenmovie），方便后续访问TeamCity。
*   `CVE-2023-42793_rce.sh`脚本利用漏洞执行指定的命令，并返回命令输出。

从提供的README.md中的截图以及漏洞原理来看，POC代码是有效的，可以成功利用该漏洞。

**投毒风险：**

评估投毒风险，需考虑作者是否有意在代码中添加恶意功能。

1.  **代码混淆/隐藏：** 代码没有进行明显的混淆。虽然使用了`grep`和`awk`提取Token和命令输出，但是属于正常利用。
2.  **恶意依赖：** 代码没有引入外部依赖。
3.  **后门代码：** 代码的主要功能是利用漏洞，创建管理员账户或执行命令。没有发现明显与漏洞利用无关的恶意代码，例如反弹shell、上传文件等。
4.  **隐蔽指令：**  检查代码中是否存在不易察觉的指令，例如通过环境变量、时间等触发的恶意行为。没有发现此类指令。

尽管POC的主要功能是漏洞利用，仍存在一定的投毒风险。例如，攻击者可能修改`CVE-2023-42793_rce.sh`脚本，在执行目标命令之前，先执行一些恶意操作，例如下载并执行恶意程序，添加后门账户等。这种风险很难通过静态分析完全排除，需要进行动态分析，实际运行poc代码进行监控。

因此，综合考虑，投毒风险评估为10%。这个风险主要来源于用户下载和使用POC时，可能会下载到被篡改过的恶意版本。

**结论：**

CVE-2023-42793是一个高危漏洞，利用简单，影响范围广。建议受影响的用户尽快升级到最新版本。在使用公开的POC代码时，务必谨慎，进行代码审计，并确保从可信来源下载。

**项目地址:** [Zenmovie/CVE-2023-42793](https://github.com/Zenmovie/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #9

**来源**: [CVE-2023-42793-becrevex_CVE-2023-42793.md](../2023/CVE-2023-42793-becrevex_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个认证绕过漏洞，攻击者无需认证即可利用此漏洞在TeamCity服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8，属于高危漏洞，并且已被积极利用。多家安全公司和组织（例如Rapid7，Fortinet，Microsoft，CISA）都发布了关于该漏洞的分析和利用报告，甚至有APT组织（APT29，北朝鲜黑客组织）利用该漏洞进行攻击。

提供的POC代码是一个Nmap脚本，用于检测目标TeamCity服务器是否存在CVE-2023-42793漏洞。该脚本通过向`/app/rest/users/id:1/tokens/RPC2`路径发送POST请求，尝试创建一个新的用户令牌，如果服务器返回200状态码且包含一个令牌，则表明服务器存在漏洞。该脚本本身的行为是良性的，只是用于验证漏洞的存在，没有发现任何投毒代码。

**有效性：**
根据提供的漏洞信息和POC代码，该POC代码有效，可以用于检测目标是否存在CVE-2023-42793漏洞。

**投毒风险：**
对提供的Nmap脚本进行了分析，没有发现任何明显的投毒代码。脚本的功能明确，即检测TeamCity服务器上的漏洞，没有发现任何恶意行为。风险评估为0%

**利用方式：**
1.  攻击者利用未授权访问漏洞，绕过身份验证。
2.  攻击者发送特制请求，例如向`/app/rest/users/id:1/tokens/RPC2`路径创建用户Token。
3.  成功创建Token后，攻击者获得管理员权限。
4.  利用管理员权限执行任意代码，实现远程代码执行。

该漏洞利用简单，影响严重，建议TeamCity用户尽快升级到2023.05.4或更高版本。

**项目地址:** [becrevex/CVE-2023-42793](https://github.com/becrevex/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #10

**来源**: [CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md](../2023/CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** JetBrains TeamCity

**危害等级:** 极高，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可从网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity 2023.05.4之前版本中存在的一个身份验证绕过漏洞，可能导致未经身份验证的远程代码执行。根据漏洞库信息，此漏洞的CVSS评分为9.8，属于严重级别。多个搜索结果表明，该漏洞已被积极利用，甚至被APT组织利用进行攻击。提供的POC代码是一个Python脚本，它利用漏洞执行远程命令。

**利用方式：**

1.  **身份验证绕过：** 该漏洞允许攻击者绕过TeamCity服务器的身份验证机制。
2.  **获取Bearer Token：** 利用未经身份验证的访问，通过`/app/rest/users/id:1/tokens/RPC2`端点创建一个临时的Bearer Token。
3.  **启用调试模式：** 使用获得的Bearer Token，通过`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`端点启用调试模式，即`rest.debug.processes.enable=true`。
4.  **远程代码执行：** 使用获得的Bearer Token，通过`/app/rest/debug/processes`端点执行任意命令。POC使用bash反弹shell，通过URL编码将命令传递给目标服务器。

**有效性评估：**

提供的POC代码看起来是有效的。它利用了TeamCity REST API中的漏洞，绕过身份验证并执行任意代码。 脚本首先尝试获取一个临时的Bearer Token，然后使用该Token来修改`internal.properties`文件以启用调试模式。最后，脚本使用调试模式来执行远程代码。 脚本的`README.md`文件中提供的参考链接也支持了该漏洞的存在和可利用性。搜索结果中大量的安全厂商报告和分析也证实了此漏洞的真实性和高危性。

**投毒风险评估：**

分析POC代码没有发现明显的投毒代码。脚本的功能主要集中在利用漏洞进行远程代码执行，没有发现额外的恶意行为或后门。该脚本的功能与漏洞描述以及利用方式相符，未发现任何异常行为。因此，投毒风险评估为0%。

**项目地址:** [hotplugin0x01/CVE-2023-42793](https://github.com/hotplugin0x01/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #11

**来源**: [CVE-2023-42793-jakehomb_cve-2023-42793.md](../2023/CVE-2023-42793-jakehomb_cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器版本低于2023.05.4，且可通过HTTP(S)访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2023-42793 允许未经身份验证的攻击者在 TeamCity 服务器上执行远程代码。该漏洞利用方式是通过绕过身份验证机制，直接访问受保护的资源并执行恶意操作。

**有效性：**
根据提供的漏洞信息、搜索结果以及漏洞利用代码，可以判断该漏洞的 POC 代码有效。CVE 详情中提到存在身份验证绕过导致 RCE，搜索结果也表明该漏洞存在公开可用的exploit，并且已经被APT29等恶意行为者利用。

**投毒风险：**
提供的漏洞利用代码主要由两部分组成：获取 Token 和创建用户。getToken 函数尝试从 /app/rest/users/id:1/token/RPC2 获取一个 Token，createUser 函数使用这个 Token 来创建一个具有管理员权限的用户。代码本身功能明确，没有发现隐藏的恶意代码。因此，评估该仓库中存在作者隐藏的投毒代码的风险为0%。

**利用方式：**
1.  **目标探测：** 确定目标 TeamCity 服务器的版本是否低于 2023.05.4。
2.  **Token 获取：** 使用 `getToken` 函数，通过向 `https://<teamcity_url>/app/rest/users/id:1/token/RPC2` 发送 GET 请求，尝试获取一个 Token。服务器无需授权即可响应。  `extractToken` 函数从响应中提取 Token。
3.  **用户创建：** 使用 `createUser` 函数，携带上一步获取的 Token，向 `https://<teamcity_url>/app/rest/users` 发送 POST 请求，创建一个具有 SYSTEM_ADMIN 角色的新用户。请求的 Body 为包含用户名、密码和邮箱的JSON格式。
4.  **权限提升：** 使用新创建的管理员用户登录 TeamCity 服务器，获得完全控制权限，从而执行任意代码。

**项目地址:** [jakehomb/cve-2023-42793](https://github.com/jakehomb/cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #12

**来源**: [CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md](../2023/CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行远程代码。该漏洞影响2023.05.4之前的版本。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的，并且已被广泛利用。CISA已将其添加到已知被利用漏洞目录中。搜索引擎结果中多个安全厂商的博客也证实了该漏洞的有效性。

**投毒风险：**
提供的PoC代码本身的功能是利用漏洞创建新的管理员用户。`README.md`文件描述了脚本的功能，与代码行为一致。代码中对创建的用户名称添加了随机数，并会写入 `vulnerable.txt` 文件。 `vulnerable.txt`文件可能存在信息泄露的风险,如果被攻击者获取，可能结合其他漏洞使用。总体来看，该PoC代码存在投毒风险的可能性较低，约为10%。

**利用方式：**
1.  **删除用户令牌：** PoC首先尝试删除ID为1的用户令牌 (通常是管理员)。
2.  **创建用户令牌：** 如果删除成功或不存在，PoC会尝试为ID为1的用户创建一个新的用户令牌。
3.  **创建管理员用户：** 使用新创建的用户令牌，PoC会创建一个具有`SYSTEM_ADMIN`权限的新用户，用户名和密码是硬编码的（用户名以 `_secops` 开头，加上随机数，密码是 `changeme`）。
4.  **利用新用户登录：** 攻击者可以使用新创建的管理员帐户登录TeamCity服务器，从而完全控制该服务器。
5.  **自动化攻击:** 通过-u指定url或者-l指定url列表，实现批量攻击。

**项目地址:** [johnossawy/CVE-2023-42793_POC](https://github.com/johnossawy/CVE-2023-42793_POC)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #13

**来源**: [CVE-2023-42793-junnythemarksman_CVE-2023-42793.md](../2023/CVE-2023-42793-junnythemarksman_CVE-2023-42793.md)

# CVE-2023-42793

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md](../2023/CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md)

## CVE-2023-42793 - TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个身份验证绕过漏洞，未经身份验证的攻击者可以通过发送特制的 HTTP 请求绕过身份验证，从而创建管理员账户并最终实现远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果中多个链接都提到了该漏洞被积极利用，包括APT组织。漏洞利用代码提供了创建管理员账户和执行RCE的脚本，并且说明了如何利用该漏洞，包括如何获取反向shell。

**投毒风险：**
分析提供的`exploit.py`和`rce_exploit.py`，主要功能是创建管理员账户和执行任意命令。脚本本身的代码逻辑相对简单，没有明显的恶意代码。其中`exploit.py`会生成随机用户名、密码和邮箱地址，这可能被误认为恶意行为，但这是为了方便利用而设计的，并非投毒。`rce_exploit.py`脚本依赖于第一个脚本创建的token文件。虽然没有发现明显的后门代码，但仍存在极小的风险，例如在生成随机字符串时引入偏差，虽然可能性极小，但理论上存在被利用的可能性，将投毒风险评定为5%。

**利用方式：**
1.  **身份验证绕过：** 攻击者首先利用身份验证绕过漏洞，该漏洞允许未经身份验证的攻击者与TeamCity服务器进行交互，绕过正常的身份验证流程。
2.  **创建管理员账户：** 使用 `exploit.py` 脚本，通过发送特制的 POST 请求，在 TeamCity 服务器上创建一个新的管理员账户。可以指定用户名、密码和邮箱，也可以使用随机生成的凭据。成功创建后，会将凭据保存到token文件中。
3.  **远程代码执行：** 使用 `rce.py` 脚本，该脚本首先启用debug processes，然后利用创建的管理员账户，通过 TeamCity 的 API 接口执行任意命令。可以执行系统命令，例如 `whoami`，也可以获取反向 shell，从而完全控制服务器。
4.  **反向Shell:** 利用rce.py执行命令，通过反弹shell到攻击者机器上，来获取服务器的控制权。


**项目地址:** [B4l3rI0n/CVE-2023-42793](https://github.com/B4l3rI0n/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #2

**来源**: [CVE-2023-42793-FlojBoj_CVE-2023-42793.md](../2023/CVE-2023-42793-FlojBoj_CVE-2023-42793.md)

## CVE-2023-42793-JetBrainsTeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可能导致远程代码执行和完全控制TeamCity服务器

**影响版本:** < 2023.05.4

**利用条件:** 需要能够通过HTTP(S)访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，攻击者无需身份验证即可执行远程代码。漏洞利用方式如下：

1.  **有效性：** 漏洞信息和搜索结果表明该漏洞已在野外被积极利用，包括APT组织（如APT29、CozyBear、北朝鲜黑客组织）和俄罗斯情报部门SVR。提供的代码`exploit.py`旨在利用此漏洞创建管理员账户或获取现有用户的token，从而控制TeamCity服务器。根据README.md的描述，还有一个`rce.py`脚本可以执行远程命令，但主脚本`exploit.py`的功能是创建管理员账户。

2.  **投毒风险：** 代码`exploit.py`本身的功能是利用漏洞创建管理员用户或获取token。投毒风险评估如下：
    *   代码中存在一些硬编码，例如默认密码"Password@123"和默认邮箱域名"@lol.omg"，如果直接使用这些默认值，容易被检测和防御。但这不属于投毒，而是简化使用的示例。
    *   代码尝试首先获取或删除现有的token，这增加了攻击成功的概率，但也可能在目标环境中留下痕迹。
    *   总体来看，`exploit.py`的主要风险在于被滥用以非法控制TeamCity服务器，而非恶意代码本身。因此，投毒风险较低，估计为10%。主要是担心引入了额外的请求或命令，用于收集用户信息或执行其他未经授权的操作。

3.  **利用方式：** 利用方式主要分为以下步骤：
    a.  攻击者发送特制的HTTP请求到TeamCity服务器，绕过身份验证。
    b.  使用`exploit.py`脚本，指定目标TeamCity服务器的URL。
    c.  脚本尝试获取或删除现有的token，然后创建一个新的管理员用户，或者获取指定用户的token。
    d.  如果成功创建管理员用户，攻击者可以使用新创建的管理员账户登录TeamCity服务器，并获得完全控制权限。
    e. 通过获取到的token, 攻击者可以模拟用户身份，从而执行相关操作。

该漏洞的严重性在于未经身份验证即可创建管理员帐户并执行任意代码，从而完全控制受影响的TeamCity服务器。缓解措施包括尽快升级到2023.05.4或更高版本。

**项目地址:** [FlojBoj/CVE-2023-42793](https://github.com/FlojBoj/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #3

**来源**: [CVE-2023-42793-H454NSec_CVE-2023-42793.md](../2023/CVE-2023-42793-H454NSec_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从攻击者控制的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 漏洞存在于JetBrains TeamCity 2023.05.4 之前的版本中，允许未经身份验证的攻击者绕过身份验证，最终实现远程代码执行。根据漏洞库信息，该漏洞的 CVSS 3.1 评分为 9.8，属于严重级别。搜索结果表明，该漏洞已被广泛利用，甚至被 APT 组织用于攻击活动。 

**漏洞利用方式：**

1.  **身份验证绕过：** 漏洞利用代码通过发送特制的 HTTP 请求来绕过 TeamCity 的身份验证机制。具体利用细节需要分析补丁或者参考其他分析报告。
2.  **创建管理员用户：** 漏洞利用代码首先删除 id 为 1 的用户的token，然后创建一个新的用户 token。使用这个 token，攻击者可以创建一个具有管理员权限的新用户。新用户的用户名和密码可以通过命令行参数指定，默认用户名为 `H454NSec[随机数]`，密码为 `@H454NSec`。利用成功后，即可使用创建的管理员用户登录TeamCity控制台。
3.  **远程代码执行：** 通过管理员权限，攻击者可以在 TeamCity 服务器上执行任意代码，实现远程控制。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确定该 POC 代码是有效的。漏洞已被公开披露且有可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。风险分析如下：

*   **代码结构：** 代码结构相对清晰，主要功能是利用漏洞创建管理员用户。
*   **可疑行为：** 代码中存在以下潜在风险：
    *   **默认用户名和密码：** 使用默认的用户名和密码 `@H454NSec` 创建管理员帐户，这可能会让其他攻击者更容易入侵，或者导致安全审计告警。
    *   **硬编码的 User-Agent：**  User-Agent头 `Mozilla/5.0 (https://github.com/H454NSec/CVE-2023-42793) Gecko/20100101 Firefox/113.0`  可能被用于追踪攻击源。但同时也降低了攻击的隐蔽性。
    *   **未处理异常：** 虽然代码有异常处理，但仅仅是简单的`pass`，可能会隐藏一些错误信息，增加调试难度。
*   **高危操作：**  漏洞利用本身就是高危操作，如果攻击者通过修改poc加入恶意命令，将会造成严重危害，例如植入后门。

综合考虑以上因素，该 POC 代码的投毒风险评估为 10%。主要风险在于攻击者可能利用该代码进行二次修改，加入恶意代码或后门，从而扩大攻击范围。

**项目地址:** [H454NSec/CVE-2023-42793](https://github.com/H454NSec/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #4

**来源**: [CVE-2023-42793-HusenjanDev_CVE-2023-42793.md](../2023/CVE-2023-42793-HusenjanDev_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从网络访问，需要通过其他途径获取TeamCity Token。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，允许未经身份验证的攻击者通过HTTP(S)访问TeamCity服务器，并执行远程代码。根据漏洞库信息，CVSS评分为9.8，属于严重级别。搜索引擎结果显示，该漏洞已被多个APT组织利用，包括APT29、北朝鲜的Diamond Sleet和Onyx Sleet以及俄罗斯对外情报局 (SVR)，显示其真实性和危害性。Rapid7的博客文章也详细分析了该漏洞。提供的POC代码的利用方式是：

1.  **获取TeamCity Token:**  `readme.md` 中提到，需要通过其他漏洞或者方式获取TeamCity的Token. 这是利用此POC的前提。
2.  **启用调试模式:** 使用curl命令发送POST请求到`/admin/dataDir.html`，修改`config/internal.properties`文件，启用`rest.debug.processes.enable=true`，从而开启调试模式。这一步通过token进行验证。
3.  **构造反弹shell Payload:**  将反弹shell命令进行URL编码，目标是让受害者主机连接攻击者的Netcat监听器。
4.  **执行远程命令:** 使用curl命令发送POST请求到`/app/rest/debug/processes`，指定`exePath`为`/bin/bash`，`params`为`-c`和URL编码后的反弹shell命令。这个请求同样需要token验证。漏洞利用依赖于已获取的TeamCity token，然后通过启用调试模式执行反弹shell。根据分析，该POC代码没有明显的投毒行为。

**项目地址:** [HusenjanDev/CVE-2023-42793](https://github.com/HusenjanDev/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #5

**来源**: [CVE-2023-42793-LeHeron_TC_test.md](../2023/CVE-2023-42793-LeHeron_TC_test.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个严重的身份验证绕过漏洞，攻击者无需身份验证即可在 TeamCity 服务器上执行远程代码。根据漏洞信息和搜索结果，该漏洞已被积极利用，甚至APT组织，如CozyBear，以及北朝鲜的APT组织都在利用该漏洞。 

**有效性：**
根据搜索结果，此漏洞已经存在公开的利用代码，且已被广泛利用，证明漏洞有效。

**投毒风险：**
提供的漏洞利用代码 `/tmp/da0475f0898b55e5196bf0f36ac9d45e/README`  只是一个简单的README文件，内容为 “Hello World”，不包含任何可执行代码或恶意指令。投毒的可能性极低，可以认为几乎不存在，给到1%的可能也只是对未知风险的保留。

**利用方式：**
根据漏洞描述，攻击者可以通过未授权访问TeamCity服务器，从而执行任意代码。具体的利用方式可能涉及到构造特定的HTTP请求绕过身份验证机制，然后利用TeamCity服务器的功能执行恶意命令。参考Rapid7的博客文章，该漏洞利用可能与特定的端点和参数有关，允许攻击者创建管理员用户或直接执行代码。 从搜索结果来看，该漏洞已经成为恶意行为者的攻击目标，建议尽快升级到安全版本。

**项目地址:** [LeHeron/TC_test](https://github.com/LeHeron/TC_test)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #6

**来源**: [CVE-2023-42793-StanleyJobsonAU_GhostTown.md](../2023/CVE-2023-42793-StanleyJobsonAU_GhostTown.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个身份验证绕过漏洞，允许未经身份验证的攻击者远程执行代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8（严重），并且已被积极利用。搜索结果表明，包括APT29、朝鲜黑客组织以及俄罗斯对外情报局（SVR）等多个威胁组织都在利用此漏洞。提供的POC代码 `GhostTown.py` 旨在利用此漏洞。利用方式如下：

1.  **生成管理员Token：** POC首先尝试通过 `/app/rest/users/id:1/tokens/RPC2` 接口创建一个管理员Token。这将绕过身份验证。
2.  **检索内部配置：** 使用生成的管理员Token，POC尝试从 `/get/file/dataDir/config/internal.properties` 接口检索TeamCity的内部配置。
3.  **更新配置：** POC会检查配置项中是否包含 `rest.debug.processes.enable=true`，如果不存在，则将其添加到配置项中，并通过 `/get/file/dataDir/config/internal.properties` 接口更新配置。`rest.debug.processes.enable=true` 配置的目的是允许执行调试进程，这为远程代码执行铺平了道路。(这部分未在提供的代码片段中。)
4. **远程代码执行：** 启用调试进程允许攻击者通过构造特定的请求来执行任意命令。

**有效性：** 根据漏洞信息和搜索结果，此POC代码有效，能够利用CVE-2023-42793漏洞实现RCE。

**投毒风险：** 检查提供的代码，主要逻辑集中在利用漏洞上，没有发现明显的恶意代码或后门。该代码是为了验证漏洞存在，并帮助安全研究人员和管理员修复漏洞，存在投毒代码的可能性较低。


**项目地址:** [StanleyJobsonAU/GhostTown](https://github.com/StanleyJobsonAU/GhostTown)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #7

**来源**: [CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md](../2023/CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器，且目标版本低于2023.05.4

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 存在于 JetBrains TeamCity 2023.05.4 之前的版本中，是一个身份验证绕过漏洞，可以导致未经身份验证的远程代码执行。攻击者可以利用此漏洞在 TeamCity 服务器上执行任意代码，从而完全控制服务器。漏洞利用方式如下：

1.  **身份验证绕过：** 利用漏洞绕过身份验证。
2.  **启用调试模式：** 通过修改 `internal.properties` 文件启用 `rest.debug.processes.enable`。
3.  **远程代码执行：** 使用 `/app/rest/debug/processes` 接口执行任意命令。脚本通过修改 `internal.properties` 文件，然后使用特制的请求调用 `debug/processes` 接口，从而在目标系统上执行任意命令。

提供的 `TeamCity.sh` 脚本允许用户指定目标操作系统 (Linux 或 Windows)，并相应地调整命令执行方式。脚本首先获取一个token，然后利用该 token 修改`internal.properties`文件以启用调试模式，最后使用构造好的包含恶意命令的URL来触发RCE。

投毒风险评估：代码中主要逻辑为漏洞利用，并未发现明显的恶意代码。`TeamCity.sh` 中选择目标OS后，Linux环境使用了`base64`编码命令，Windows没有。虽然脚本的行为符合漏洞利用的预期，但是如果攻击者对`base64` 编码方式做了手脚，有可能在Linux执行的时候插入恶意命令。`TeamCity2.sh` 脚本对命令进行URL编码，windows只支持powershell, 可以对powershell添加恶意payload. 因此，存在一定的投毒风险，估计在10%左右。

**项目地址:** [SwiftSecur/teamcity-exploit-cve-2023-42793](https://github.com/SwiftSecur/teamcity-exploit-cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #8

**来源**: [CVE-2023-42793-Zenmovie_CVE-2023-42793.md](../2023/CVE-2023-42793-Zenmovie_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity实例需要开启网络访问，且版本低于2023.05.4。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的远程攻击者绕过身份验证，并在服务器上执行任意代码。根据漏洞库信息，CVSS评分为9.8（严重）。

**利用方式：**

1.  **身份验证绕过：** 攻击者利用未经身份验证的REST API端点`/app/rest/users/id:1/tokens/RPC2`来获取一个有效的Bearer Token。这个Token最初的设计目的是允许用户通过API管理自己的Token。
2.  **修改内部属性：** 使用获取的Token，通过POST请求访问`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`修改内部属性，启用`rest.debug.processes.enable`，此步骤为后续RCE做准备。
3.  **远程代码执行：**  利用被启用的REST API端点`/app/rest/debug/processes?exePath=${COMMAND}`，通过`exePath`参数执行任意命令。该端点在正常情况下只允许经过身份验证的管理员访问，但由于身份验证绕过，未经授权的攻击者可以利用它。

**POC有效性：**

提供的POC代码包含两个脚本：`CVE-2023-42793_admin.sh`和`CVE-2023-42793_rce.sh`。

*   `CVE-2023-42793_admin.sh`脚本利用漏洞创建一个新的管理员用户（Zenmovie/Zenmovie），方便后续访问TeamCity。
*   `CVE-2023-42793_rce.sh`脚本利用漏洞执行指定的命令，并返回命令输出。

从提供的README.md中的截图以及漏洞原理来看，POC代码是有效的，可以成功利用该漏洞。

**投毒风险：**

评估投毒风险，需考虑作者是否有意在代码中添加恶意功能。

1.  **代码混淆/隐藏：** 代码没有进行明显的混淆。虽然使用了`grep`和`awk`提取Token和命令输出，但是属于正常利用。
2.  **恶意依赖：** 代码没有引入外部依赖。
3.  **后门代码：** 代码的主要功能是利用漏洞，创建管理员账户或执行命令。没有发现明显与漏洞利用无关的恶意代码，例如反弹shell、上传文件等。
4.  **隐蔽指令：**  检查代码中是否存在不易察觉的指令，例如通过环境变量、时间等触发的恶意行为。没有发现此类指令。

尽管POC的主要功能是漏洞利用，仍存在一定的投毒风险。例如，攻击者可能修改`CVE-2023-42793_rce.sh`脚本，在执行目标命令之前，先执行一些恶意操作，例如下载并执行恶意程序，添加后门账户等。这种风险很难通过静态分析完全排除，需要进行动态分析，实际运行poc代码进行监控。

因此，综合考虑，投毒风险评估为10%。这个风险主要来源于用户下载和使用POC时，可能会下载到被篡改过的恶意版本。

**结论：**

CVE-2023-42793是一个高危漏洞，利用简单，影响范围广。建议受影响的用户尽快升级到最新版本。在使用公开的POC代码时，务必谨慎，进行代码审计，并确保从可信来源下载。

**项目地址:** [Zenmovie/CVE-2023-42793](https://github.com/Zenmovie/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #9

**来源**: [CVE-2023-42793-becrevex_CVE-2023-42793.md](../2023/CVE-2023-42793-becrevex_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个认证绕过漏洞，攻击者无需认证即可利用此漏洞在TeamCity服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8，属于高危漏洞，并且已被积极利用。多家安全公司和组织（例如Rapid7，Fortinet，Microsoft，CISA）都发布了关于该漏洞的分析和利用报告，甚至有APT组织（APT29，北朝鲜黑客组织）利用该漏洞进行攻击。

提供的POC代码是一个Nmap脚本，用于检测目标TeamCity服务器是否存在CVE-2023-42793漏洞。该脚本通过向`/app/rest/users/id:1/tokens/RPC2`路径发送POST请求，尝试创建一个新的用户令牌，如果服务器返回200状态码且包含一个令牌，则表明服务器存在漏洞。该脚本本身的行为是良性的，只是用于验证漏洞的存在，没有发现任何投毒代码。

**有效性：**
根据提供的漏洞信息和POC代码，该POC代码有效，可以用于检测目标是否存在CVE-2023-42793漏洞。

**投毒风险：**
对提供的Nmap脚本进行了分析，没有发现任何明显的投毒代码。脚本的功能明确，即检测TeamCity服务器上的漏洞，没有发现任何恶意行为。风险评估为0%

**利用方式：**
1.  攻击者利用未授权访问漏洞，绕过身份验证。
2.  攻击者发送特制请求，例如向`/app/rest/users/id:1/tokens/RPC2`路径创建用户Token。
3.  成功创建Token后，攻击者获得管理员权限。
4.  利用管理员权限执行任意代码，实现远程代码执行。

该漏洞利用简单，影响严重，建议TeamCity用户尽快升级到2023.05.4或更高版本。

**项目地址:** [becrevex/CVE-2023-42793](https://github.com/becrevex/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #10

**来源**: [CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md](../2023/CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** JetBrains TeamCity

**危害等级:** 极高，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可从网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity 2023.05.4之前版本中存在的一个身份验证绕过漏洞，可能导致未经身份验证的远程代码执行。根据漏洞库信息，此漏洞的CVSS评分为9.8，属于严重级别。多个搜索结果表明，该漏洞已被积极利用，甚至被APT组织利用进行攻击。提供的POC代码是一个Python脚本，它利用漏洞执行远程命令。

**利用方式：**

1.  **身份验证绕过：** 该漏洞允许攻击者绕过TeamCity服务器的身份验证机制。
2.  **获取Bearer Token：** 利用未经身份验证的访问，通过`/app/rest/users/id:1/tokens/RPC2`端点创建一个临时的Bearer Token。
3.  **启用调试模式：** 使用获得的Bearer Token，通过`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`端点启用调试模式，即`rest.debug.processes.enable=true`。
4.  **远程代码执行：** 使用获得的Bearer Token，通过`/app/rest/debug/processes`端点执行任意命令。POC使用bash反弹shell，通过URL编码将命令传递给目标服务器。

**有效性评估：**

提供的POC代码看起来是有效的。它利用了TeamCity REST API中的漏洞，绕过身份验证并执行任意代码。 脚本首先尝试获取一个临时的Bearer Token，然后使用该Token来修改`internal.properties`文件以启用调试模式。最后，脚本使用调试模式来执行远程代码。 脚本的`README.md`文件中提供的参考链接也支持了该漏洞的存在和可利用性。搜索结果中大量的安全厂商报告和分析也证实了此漏洞的真实性和高危性。

**投毒风险评估：**

分析POC代码没有发现明显的投毒代码。脚本的功能主要集中在利用漏洞进行远程代码执行，没有发现额外的恶意行为或后门。该脚本的功能与漏洞描述以及利用方式相符，未发现任何异常行为。因此，投毒风险评估为0%。

**项目地址:** [hotplugin0x01/CVE-2023-42793](https://github.com/hotplugin0x01/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #11

**来源**: [CVE-2023-42793-jakehomb_cve-2023-42793.md](../2023/CVE-2023-42793-jakehomb_cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器版本低于2023.05.4，且可通过HTTP(S)访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2023-42793 允许未经身份验证的攻击者在 TeamCity 服务器上执行远程代码。该漏洞利用方式是通过绕过身份验证机制，直接访问受保护的资源并执行恶意操作。

**有效性：**
根据提供的漏洞信息、搜索结果以及漏洞利用代码，可以判断该漏洞的 POC 代码有效。CVE 详情中提到存在身份验证绕过导致 RCE，搜索结果也表明该漏洞存在公开可用的exploit，并且已经被APT29等恶意行为者利用。

**投毒风险：**
提供的漏洞利用代码主要由两部分组成：获取 Token 和创建用户。getToken 函数尝试从 /app/rest/users/id:1/token/RPC2 获取一个 Token，createUser 函数使用这个 Token 来创建一个具有管理员权限的用户。代码本身功能明确，没有发现隐藏的恶意代码。因此，评估该仓库中存在作者隐藏的投毒代码的风险为0%。

**利用方式：**
1.  **目标探测：** 确定目标 TeamCity 服务器的版本是否低于 2023.05.4。
2.  **Token 获取：** 使用 `getToken` 函数，通过向 `https://<teamcity_url>/app/rest/users/id:1/token/RPC2` 发送 GET 请求，尝试获取一个 Token。服务器无需授权即可响应。  `extractToken` 函数从响应中提取 Token。
3.  **用户创建：** 使用 `createUser` 函数，携带上一步获取的 Token，向 `https://<teamcity_url>/app/rest/users` 发送 POST 请求，创建一个具有 SYSTEM_ADMIN 角色的新用户。请求的 Body 为包含用户名、密码和邮箱的JSON格式。
4.  **权限提升：** 使用新创建的管理员用户登录 TeamCity 服务器，获得完全控制权限，从而执行任意代码。

**项目地址:** [jakehomb/cve-2023-42793](https://github.com/jakehomb/cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #12

**来源**: [CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md](../2023/CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行远程代码。该漏洞影响2023.05.4之前的版本。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的，并且已被广泛利用。CISA已将其添加到已知被利用漏洞目录中。搜索引擎结果中多个安全厂商的博客也证实了该漏洞的有效性。

**投毒风险：**
提供的PoC代码本身的功能是利用漏洞创建新的管理员用户。`README.md`文件描述了脚本的功能，与代码行为一致。代码中对创建的用户名称添加了随机数，并会写入 `vulnerable.txt` 文件。 `vulnerable.txt`文件可能存在信息泄露的风险,如果被攻击者获取，可能结合其他漏洞使用。总体来看，该PoC代码存在投毒风险的可能性较低，约为10%。

**利用方式：**
1.  **删除用户令牌：** PoC首先尝试删除ID为1的用户令牌 (通常是管理员)。
2.  **创建用户令牌：** 如果删除成功或不存在，PoC会尝试为ID为1的用户创建一个新的用户令牌。
3.  **创建管理员用户：** 使用新创建的用户令牌，PoC会创建一个具有`SYSTEM_ADMIN`权限的新用户，用户名和密码是硬编码的（用户名以 `_secops` 开头，加上随机数，密码是 `changeme`）。
4.  **利用新用户登录：** 攻击者可以使用新创建的管理员帐户登录TeamCity服务器，从而完全控制该服务器。
5.  **自动化攻击:** 通过-u指定url或者-l指定url列表，实现批量攻击。

**项目地址:** [johnossawy/CVE-2023-42793_POC](https://github.com/johnossawy/CVE-2023-42793_POC)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #13

**来源**: [CVE-2023-42793-junnythemarksman_CVE-2023-42793.md](../2023/CVE-2023-42793-junnythemarksman_CVE-2023-42793.md)

# CVE-2023-42793

> 📦 该CVE有 **15** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md](../2023/CVE-2023-42793-B4l3rI0n_CVE-2023-42793.md)

## CVE-2023-42793 - TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个身份验证绕过漏洞，未经身份验证的攻击者可以通过发送特制的 HTTP 请求绕过身份验证，从而创建管理员账户并最终实现远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果中多个链接都提到了该漏洞被积极利用，包括APT组织。漏洞利用代码提供了创建管理员账户和执行RCE的脚本，并且说明了如何利用该漏洞，包括如何获取反向shell。

**投毒风险：**
分析提供的`exploit.py`和`rce_exploit.py`，主要功能是创建管理员账户和执行任意命令。脚本本身的代码逻辑相对简单，没有明显的恶意代码。其中`exploit.py`会生成随机用户名、密码和邮箱地址，这可能被误认为恶意行为，但这是为了方便利用而设计的，并非投毒。`rce_exploit.py`脚本依赖于第一个脚本创建的token文件。虽然没有发现明显的后门代码，但仍存在极小的风险，例如在生成随机字符串时引入偏差，虽然可能性极小，但理论上存在被利用的可能性，将投毒风险评定为5%。

**利用方式：**
1.  **身份验证绕过：** 攻击者首先利用身份验证绕过漏洞，该漏洞允许未经身份验证的攻击者与TeamCity服务器进行交互，绕过正常的身份验证流程。
2.  **创建管理员账户：** 使用 `exploit.py` 脚本，通过发送特制的 POST 请求，在 TeamCity 服务器上创建一个新的管理员账户。可以指定用户名、密码和邮箱，也可以使用随机生成的凭据。成功创建后，会将凭据保存到token文件中。
3.  **远程代码执行：** 使用 `rce.py` 脚本，该脚本首先启用debug processes，然后利用创建的管理员账户，通过 TeamCity 的 API 接口执行任意命令。可以执行系统命令，例如 `whoami`，也可以获取反向 shell，从而完全控制服务器。
4.  **反向Shell:** 利用rce.py执行命令，通过反弹shell到攻击者机器上，来获取服务器的控制权。


**项目地址:** [B4l3rI0n/CVE-2023-42793](https://github.com/B4l3rI0n/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #2

**来源**: [CVE-2023-42793-FlojBoj_CVE-2023-42793.md](../2023/CVE-2023-42793-FlojBoj_CVE-2023-42793.md)

## CVE-2023-42793-JetBrainsTeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可能导致远程代码执行和完全控制TeamCity服务器

**影响版本:** < 2023.05.4

**利用条件:** 需要能够通过HTTP(S)访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，攻击者无需身份验证即可执行远程代码。漏洞利用方式如下：

1.  **有效性：** 漏洞信息和搜索结果表明该漏洞已在野外被积极利用，包括APT组织（如APT29、CozyBear、北朝鲜黑客组织）和俄罗斯情报部门SVR。提供的代码`exploit.py`旨在利用此漏洞创建管理员账户或获取现有用户的token，从而控制TeamCity服务器。根据README.md的描述，还有一个`rce.py`脚本可以执行远程命令，但主脚本`exploit.py`的功能是创建管理员账户。

2.  **投毒风险：** 代码`exploit.py`本身的功能是利用漏洞创建管理员用户或获取token。投毒风险评估如下：
    *   代码中存在一些硬编码，例如默认密码"Password@123"和默认邮箱域名"@lol.omg"，如果直接使用这些默认值，容易被检测和防御。但这不属于投毒，而是简化使用的示例。
    *   代码尝试首先获取或删除现有的token，这增加了攻击成功的概率，但也可能在目标环境中留下痕迹。
    *   总体来看，`exploit.py`的主要风险在于被滥用以非法控制TeamCity服务器，而非恶意代码本身。因此，投毒风险较低，估计为10%。主要是担心引入了额外的请求或命令，用于收集用户信息或执行其他未经授权的操作。

3.  **利用方式：** 利用方式主要分为以下步骤：
    a.  攻击者发送特制的HTTP请求到TeamCity服务器，绕过身份验证。
    b.  使用`exploit.py`脚本，指定目标TeamCity服务器的URL。
    c.  脚本尝试获取或删除现有的token，然后创建一个新的管理员用户，或者获取指定用户的token。
    d.  如果成功创建管理员用户，攻击者可以使用新创建的管理员账户登录TeamCity服务器，并获得完全控制权限。
    e. 通过获取到的token, 攻击者可以模拟用户身份，从而执行相关操作。

该漏洞的严重性在于未经身份验证即可创建管理员帐户并执行任意代码，从而完全控制受影响的TeamCity服务器。缓解措施包括尽快升级到2023.05.4或更高版本。

**项目地址:** [FlojBoj/CVE-2023-42793](https://github.com/FlojBoj/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #3

**来源**: [CVE-2023-42793-H454NSec_CVE-2023-42793.md](../2023/CVE-2023-42793-H454NSec_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从攻击者控制的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 漏洞存在于JetBrains TeamCity 2023.05.4 之前的版本中，允许未经身份验证的攻击者绕过身份验证，最终实现远程代码执行。根据漏洞库信息，该漏洞的 CVSS 3.1 评分为 9.8，属于严重级别。搜索结果表明，该漏洞已被广泛利用，甚至被 APT 组织用于攻击活动。 

**漏洞利用方式：**

1.  **身份验证绕过：** 漏洞利用代码通过发送特制的 HTTP 请求来绕过 TeamCity 的身份验证机制。具体利用细节需要分析补丁或者参考其他分析报告。
2.  **创建管理员用户：** 漏洞利用代码首先删除 id 为 1 的用户的token，然后创建一个新的用户 token。使用这个 token，攻击者可以创建一个具有管理员权限的新用户。新用户的用户名和密码可以通过命令行参数指定，默认用户名为 `H454NSec[随机数]`，密码为 `@H454NSec`。利用成功后，即可使用创建的管理员用户登录TeamCity控制台。
3.  **远程代码执行：** 通过管理员权限，攻击者可以在 TeamCity 服务器上执行任意代码，实现远程控制。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确定该 POC 代码是有效的。漏洞已被公开披露且有可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。风险分析如下：

*   **代码结构：** 代码结构相对清晰，主要功能是利用漏洞创建管理员用户。
*   **可疑行为：** 代码中存在以下潜在风险：
    *   **默认用户名和密码：** 使用默认的用户名和密码 `@H454NSec` 创建管理员帐户，这可能会让其他攻击者更容易入侵，或者导致安全审计告警。
    *   **硬编码的 User-Agent：**  User-Agent头 `Mozilla/5.0 (https://github.com/H454NSec/CVE-2023-42793) Gecko/20100101 Firefox/113.0`  可能被用于追踪攻击源。但同时也降低了攻击的隐蔽性。
    *   **未处理异常：** 虽然代码有异常处理，但仅仅是简单的`pass`，可能会隐藏一些错误信息，增加调试难度。
*   **高危操作：**  漏洞利用本身就是高危操作，如果攻击者通过修改poc加入恶意命令，将会造成严重危害，例如植入后门。

综合考虑以上因素，该 POC 代码的投毒风险评估为 10%。主要风险在于攻击者可能利用该代码进行二次修改，加入恶意代码或后门，从而扩大攻击范围。

**项目地址:** [H454NSec/CVE-2023-42793](https://github.com/H454NSec/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #4

**来源**: [CVE-2023-42793-HusenjanDev_CVE-2023-42793.md](../2023/CVE-2023-42793-HusenjanDev_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可从网络访问，需要通过其他途径获取TeamCity Token。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个身份验证绕过漏洞，允许未经身份验证的攻击者通过HTTP(S)访问TeamCity服务器，并执行远程代码。根据漏洞库信息，CVSS评分为9.8，属于严重级别。搜索引擎结果显示，该漏洞已被多个APT组织利用，包括APT29、北朝鲜的Diamond Sleet和Onyx Sleet以及俄罗斯对外情报局 (SVR)，显示其真实性和危害性。Rapid7的博客文章也详细分析了该漏洞。提供的POC代码的利用方式是：

1.  **获取TeamCity Token:**  `readme.md` 中提到，需要通过其他漏洞或者方式获取TeamCity的Token. 这是利用此POC的前提。
2.  **启用调试模式:** 使用curl命令发送POST请求到`/admin/dataDir.html`，修改`config/internal.properties`文件，启用`rest.debug.processes.enable=true`，从而开启调试模式。这一步通过token进行验证。
3.  **构造反弹shell Payload:**  将反弹shell命令进行URL编码，目标是让受害者主机连接攻击者的Netcat监听器。
4.  **执行远程命令:** 使用curl命令发送POST请求到`/app/rest/debug/processes`，指定`exePath`为`/bin/bash`，`params`为`-c`和URL编码后的反弹shell命令。这个请求同样需要token验证。漏洞利用依赖于已获取的TeamCity token，然后通过启用调试模式执行反弹shell。根据分析，该POC代码没有明显的投毒行为。

**项目地址:** [HusenjanDev/CVE-2023-42793](https://github.com/HusenjanDev/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #5

**来源**: [CVE-2023-42793-LeHeron_TC_test.md](../2023/CVE-2023-42793-LeHeron_TC_test.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个严重的身份验证绕过漏洞，攻击者无需身份验证即可在 TeamCity 服务器上执行远程代码。根据漏洞信息和搜索结果，该漏洞已被积极利用，甚至APT组织，如CozyBear，以及北朝鲜的APT组织都在利用该漏洞。 

**有效性：**
根据搜索结果，此漏洞已经存在公开的利用代码，且已被广泛利用，证明漏洞有效。

**投毒风险：**
提供的漏洞利用代码 `/tmp/da0475f0898b55e5196bf0f36ac9d45e/README`  只是一个简单的README文件，内容为 “Hello World”，不包含任何可执行代码或恶意指令。投毒的可能性极低，可以认为几乎不存在，给到1%的可能也只是对未知风险的保留。

**利用方式：**
根据漏洞描述，攻击者可以通过未授权访问TeamCity服务器，从而执行任意代码。具体的利用方式可能涉及到构造特定的HTTP请求绕过身份验证机制，然后利用TeamCity服务器的功能执行恶意命令。参考Rapid7的博客文章，该漏洞利用可能与特定的端点和参数有关，允许攻击者创建管理员用户或直接执行代码。 从搜索结果来看，该漏洞已经成为恶意行为者的攻击目标，建议尽快升级到安全版本。

**项目地址:** [LeHeron/TC_test](https://github.com/LeHeron/TC_test)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #6

**来源**: [CVE-2023-42793-StanleyJobsonAU_GhostTown.md](../2023/CVE-2023-42793-StanleyJobsonAU_GhostTown.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个身份验证绕过漏洞，允许未经身份验证的攻击者远程执行代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8（严重），并且已被积极利用。搜索结果表明，包括APT29、朝鲜黑客组织以及俄罗斯对外情报局（SVR）等多个威胁组织都在利用此漏洞。提供的POC代码 `GhostTown.py` 旨在利用此漏洞。利用方式如下：

1.  **生成管理员Token：** POC首先尝试通过 `/app/rest/users/id:1/tokens/RPC2` 接口创建一个管理员Token。这将绕过身份验证。
2.  **检索内部配置：** 使用生成的管理员Token，POC尝试从 `/get/file/dataDir/config/internal.properties` 接口检索TeamCity的内部配置。
3.  **更新配置：** POC会检查配置项中是否包含 `rest.debug.processes.enable=true`，如果不存在，则将其添加到配置项中，并通过 `/get/file/dataDir/config/internal.properties` 接口更新配置。`rest.debug.processes.enable=true` 配置的目的是允许执行调试进程，这为远程代码执行铺平了道路。(这部分未在提供的代码片段中。)
4. **远程代码执行：** 启用调试进程允许攻击者通过构造特定的请求来执行任意命令。

**有效性：** 根据漏洞信息和搜索结果，此POC代码有效，能够利用CVE-2023-42793漏洞实现RCE。

**投毒风险：** 检查提供的代码，主要逻辑集中在利用漏洞上，没有发现明显的恶意代码或后门。该代码是为了验证漏洞存在，并帮助安全研究人员和管理员修复漏洞，存在投毒代码的可能性较低。


**项目地址:** [StanleyJobsonAU/GhostTown](https://github.com/StanleyJobsonAU/GhostTown)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #7

**来源**: [CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md](../2023/CVE-2023-42793-SwiftSecur_teamcity-exploit-cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器，且目标版本低于2023.05.4

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793 存在于 JetBrains TeamCity 2023.05.4 之前的版本中，是一个身份验证绕过漏洞，可以导致未经身份验证的远程代码执行。攻击者可以利用此漏洞在 TeamCity 服务器上执行任意代码，从而完全控制服务器。漏洞利用方式如下：

1.  **身份验证绕过：** 利用漏洞绕过身份验证。
2.  **启用调试模式：** 通过修改 `internal.properties` 文件启用 `rest.debug.processes.enable`。
3.  **远程代码执行：** 使用 `/app/rest/debug/processes` 接口执行任意命令。脚本通过修改 `internal.properties` 文件，然后使用特制的请求调用 `debug/processes` 接口，从而在目标系统上执行任意命令。

提供的 `TeamCity.sh` 脚本允许用户指定目标操作系统 (Linux 或 Windows)，并相应地调整命令执行方式。脚本首先获取一个token，然后利用该 token 修改`internal.properties`文件以启用调试模式，最后使用构造好的包含恶意命令的URL来触发RCE。

投毒风险评估：代码中主要逻辑为漏洞利用，并未发现明显的恶意代码。`TeamCity.sh` 中选择目标OS后，Linux环境使用了`base64`编码命令，Windows没有。虽然脚本的行为符合漏洞利用的预期，但是如果攻击者对`base64` 编码方式做了手脚，有可能在Linux执行的时候插入恶意命令。`TeamCity2.sh` 脚本对命令进行URL编码，windows只支持powershell, 可以对powershell添加恶意payload. 因此，存在一定的投毒风险，估计在10%左右。

**项目地址:** [SwiftSecur/teamcity-exploit-cve-2023-42793](https://github.com/SwiftSecur/teamcity-exploit-cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #8

**来源**: [CVE-2023-42793-Zenmovie_CVE-2023-42793.md](../2023/CVE-2023-42793-Zenmovie_CVE-2023-42793.md)

## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity实例需要开启网络访问，且版本低于2023.05.4。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的远程攻击者绕过身份验证，并在服务器上执行任意代码。根据漏洞库信息，CVSS评分为9.8（严重）。

**利用方式：**

1.  **身份验证绕过：** 攻击者利用未经身份验证的REST API端点`/app/rest/users/id:1/tokens/RPC2`来获取一个有效的Bearer Token。这个Token最初的设计目的是允许用户通过API管理自己的Token。
2.  **修改内部属性：** 使用获取的Token，通过POST请求访问`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`修改内部属性，启用`rest.debug.processes.enable`，此步骤为后续RCE做准备。
3.  **远程代码执行：**  利用被启用的REST API端点`/app/rest/debug/processes?exePath=${COMMAND}`，通过`exePath`参数执行任意命令。该端点在正常情况下只允许经过身份验证的管理员访问，但由于身份验证绕过，未经授权的攻击者可以利用它。

**POC有效性：**

提供的POC代码包含两个脚本：`CVE-2023-42793_admin.sh`和`CVE-2023-42793_rce.sh`。

*   `CVE-2023-42793_admin.sh`脚本利用漏洞创建一个新的管理员用户（Zenmovie/Zenmovie），方便后续访问TeamCity。
*   `CVE-2023-42793_rce.sh`脚本利用漏洞执行指定的命令，并返回命令输出。

从提供的README.md中的截图以及漏洞原理来看，POC代码是有效的，可以成功利用该漏洞。

**投毒风险：**

评估投毒风险，需考虑作者是否有意在代码中添加恶意功能。

1.  **代码混淆/隐藏：** 代码没有进行明显的混淆。虽然使用了`grep`和`awk`提取Token和命令输出，但是属于正常利用。
2.  **恶意依赖：** 代码没有引入外部依赖。
3.  **后门代码：** 代码的主要功能是利用漏洞，创建管理员账户或执行命令。没有发现明显与漏洞利用无关的恶意代码，例如反弹shell、上传文件等。
4.  **隐蔽指令：**  检查代码中是否存在不易察觉的指令，例如通过环境变量、时间等触发的恶意行为。没有发现此类指令。

尽管POC的主要功能是漏洞利用，仍存在一定的投毒风险。例如，攻击者可能修改`CVE-2023-42793_rce.sh`脚本，在执行目标命令之前，先执行一些恶意操作，例如下载并执行恶意程序，添加后门账户等。这种风险很难通过静态分析完全排除，需要进行动态分析，实际运行poc代码进行监控。

因此，综合考虑，投毒风险评估为10%。这个风险主要来源于用户下载和使用POC时，可能会下载到被篡改过的恶意版本。

**结论：**

CVE-2023-42793是一个高危漏洞，利用简单，影响范围广。建议受影响的用户尽快升级到最新版本。在使用公开的POC代码时，务必谨慎，进行代码审计，并确保从可信来源下载。

**项目地址:** [Zenmovie/CVE-2023-42793](https://github.com/Zenmovie/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #9

**来源**: [CVE-2023-42793-becrevex_CVE-2023-42793.md](../2023/CVE-2023-42793-becrevex_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个认证绕过漏洞，攻击者无需认证即可利用此漏洞在TeamCity服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8，属于高危漏洞，并且已被积极利用。多家安全公司和组织（例如Rapid7，Fortinet，Microsoft，CISA）都发布了关于该漏洞的分析和利用报告，甚至有APT组织（APT29，北朝鲜黑客组织）利用该漏洞进行攻击。

提供的POC代码是一个Nmap脚本，用于检测目标TeamCity服务器是否存在CVE-2023-42793漏洞。该脚本通过向`/app/rest/users/id:1/tokens/RPC2`路径发送POST请求，尝试创建一个新的用户令牌，如果服务器返回200状态码且包含一个令牌，则表明服务器存在漏洞。该脚本本身的行为是良性的，只是用于验证漏洞的存在，没有发现任何投毒代码。

**有效性：**
根据提供的漏洞信息和POC代码，该POC代码有效，可以用于检测目标是否存在CVE-2023-42793漏洞。

**投毒风险：**
对提供的Nmap脚本进行了分析，没有发现任何明显的投毒代码。脚本的功能明确，即检测TeamCity服务器上的漏洞，没有发现任何恶意行为。风险评估为0%

**利用方式：**
1.  攻击者利用未授权访问漏洞，绕过身份验证。
2.  攻击者发送特制请求，例如向`/app/rest/users/id:1/tokens/RPC2`路径创建用户Token。
3.  成功创建Token后，攻击者获得管理员权限。
4.  利用管理员权限执行任意代码，实现远程代码执行。

该漏洞利用简单，影响严重，建议TeamCity用户尽快升级到2023.05.4或更高版本。

**项目地址:** [becrevex/CVE-2023-42793](https://github.com/becrevex/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #10

**来源**: [CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md](../2023/CVE-2023-42793-hotplugin0x01_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** JetBrains TeamCity

**危害等级:** 极高，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可从网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity 2023.05.4之前版本中存在的一个身份验证绕过漏洞，可能导致未经身份验证的远程代码执行。根据漏洞库信息，此漏洞的CVSS评分为9.8，属于严重级别。多个搜索结果表明，该漏洞已被积极利用，甚至被APT组织利用进行攻击。提供的POC代码是一个Python脚本，它利用漏洞执行远程命令。

**利用方式：**

1.  **身份验证绕过：** 该漏洞允许攻击者绕过TeamCity服务器的身份验证机制。
2.  **获取Bearer Token：** 利用未经身份验证的访问，通过`/app/rest/users/id:1/tokens/RPC2`端点创建一个临时的Bearer Token。
3.  **启用调试模式：** 使用获得的Bearer Token，通过`/admin/dataDir.html?action=edit&fileName=config/internal.properties&content=rest.debug.processes.enable=true`端点启用调试模式，即`rest.debug.processes.enable=true`。
4.  **远程代码执行：** 使用获得的Bearer Token，通过`/app/rest/debug/processes`端点执行任意命令。POC使用bash反弹shell，通过URL编码将命令传递给目标服务器。

**有效性评估：**

提供的POC代码看起来是有效的。它利用了TeamCity REST API中的漏洞，绕过身份验证并执行任意代码。 脚本首先尝试获取一个临时的Bearer Token，然后使用该Token来修改`internal.properties`文件以启用调试模式。最后，脚本使用调试模式来执行远程代码。 脚本的`README.md`文件中提供的参考链接也支持了该漏洞的存在和可利用性。搜索结果中大量的安全厂商报告和分析也证实了此漏洞的真实性和高危性。

**投毒风险评估：**

分析POC代码没有发现明显的投毒代码。脚本的功能主要集中在利用漏洞进行远程代码执行，没有发现额外的恶意行为或后门。该脚本的功能与漏洞描述以及利用方式相符，未发现任何异常行为。因此，投毒风险评估为0%。

**项目地址:** [hotplugin0x01/CVE-2023-42793](https://github.com/hotplugin0x01/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #11

**来源**: [CVE-2023-42793-jakehomb_cve-2023-42793.md](../2023/CVE-2023-42793-jakehomb_cve-2023-42793.md)

## CVE-2023-42793-JetBrains TeamCity-身份验证绕过导致RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过导致RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器版本低于2023.05.4，且可通过HTTP(S)访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2023-42793 允许未经身份验证的攻击者在 TeamCity 服务器上执行远程代码。该漏洞利用方式是通过绕过身份验证机制，直接访问受保护的资源并执行恶意操作。

**有效性：**
根据提供的漏洞信息、搜索结果以及漏洞利用代码，可以判断该漏洞的 POC 代码有效。CVE 详情中提到存在身份验证绕过导致 RCE，搜索结果也表明该漏洞存在公开可用的exploit，并且已经被APT29等恶意行为者利用。

**投毒风险：**
提供的漏洞利用代码主要由两部分组成：获取 Token 和创建用户。getToken 函数尝试从 /app/rest/users/id:1/token/RPC2 获取一个 Token，createUser 函数使用这个 Token 来创建一个具有管理员权限的用户。代码本身功能明确，没有发现隐藏的恶意代码。因此，评估该仓库中存在作者隐藏的投毒代码的风险为0%。

**利用方式：**
1.  **目标探测：** 确定目标 TeamCity 服务器的版本是否低于 2023.05.4。
2.  **Token 获取：** 使用 `getToken` 函数，通过向 `https://<teamcity_url>/app/rest/users/id:1/token/RPC2` 发送 GET 请求，尝试获取一个 Token。服务器无需授权即可响应。  `extractToken` 函数从响应中提取 Token。
3.  **用户创建：** 使用 `createUser` 函数，携带上一步获取的 Token，向 `https://<teamcity_url>/app/rest/users` 发送 POST 请求，创建一个具有 SYSTEM_ADMIN 角色的新用户。请求的 Body 为包含用户名、密码和邮箱的JSON格式。
4.  **权限提升：** 使用新创建的管理员用户登录 TeamCity 服务器，获得完全控制权限，从而执行任意代码。

**项目地址:** [jakehomb/cve-2023-42793](https://github.com/jakehomb/cve-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #12

**来源**: [CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md](../2023/CVE-2023-42793-johnossawy_CVE-2023-42793_POC.md)

## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行远程代码。该漏洞影响2023.05.4之前的版本。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的，并且已被广泛利用。CISA已将其添加到已知被利用漏洞目录中。搜索引擎结果中多个安全厂商的博客也证实了该漏洞的有效性。

**投毒风险：**
提供的PoC代码本身的功能是利用漏洞创建新的管理员用户。`README.md`文件描述了脚本的功能，与代码行为一致。代码中对创建的用户名称添加了随机数，并会写入 `vulnerable.txt` 文件。 `vulnerable.txt`文件可能存在信息泄露的风险,如果被攻击者获取，可能结合其他漏洞使用。总体来看，该PoC代码存在投毒风险的可能性较低，约为10%。

**利用方式：**
1.  **删除用户令牌：** PoC首先尝试删除ID为1的用户令牌 (通常是管理员)。
2.  **创建用户令牌：** 如果删除成功或不存在，PoC会尝试为ID为1的用户创建一个新的用户令牌。
3.  **创建管理员用户：** 使用新创建的用户令牌，PoC会创建一个具有`SYSTEM_ADMIN`权限的新用户，用户名和密码是硬编码的（用户名以 `_secops` 开头，加上随机数，密码是 `changeme`）。
4.  **利用新用户登录：** 攻击者可以使用新创建的管理员帐户登录TeamCity服务器，从而完全控制该服务器。
5.  **自动化攻击:** 通过-u指定url或者-l指定url列表，实现批量攻击。

**项目地址:** [johnossawy/CVE-2023-42793_POC](https://github.com/johnossawy/CVE-2023-42793_POC)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #13

**来源**: [CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md](../2023/CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md)

## CVE-2023-42793-JetBrains TeamCity RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问 TeamCity 服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个认证绕过漏洞，未经身份验证的攻击者可以通过 HTTP(S) 访问 TeamCity 服务器来执行远程代码。根据提供的漏洞利用代码（CVE-2023-42793.yaml），利用方式如下：

1.  **删除和创建 API Token:** 首先，删除用户 ID 为 1 的名为“RPC2”的 token，然后再重新创建它。这是为了获得一个具有特定权限的有效 token。
2.  **启用 Debug 模式:** 使用获取的 token，通过修改 `config/internal.properties` 文件，启用 `rest.debug.processes.enable` 属性，从而开启调试进程。
3.  **执行命令:**  使用 API 接口 `/app/rest/debug/processes`，通过 `cmd.exe` (Windows) 或 `/bin/sh` (Linux) 执行任意命令（例如 `whoami`）。

**有效性分析:**

根据漏洞库信息，搜索结果以及提供的漏洞利用代码，可以确认该漏洞是真实存在的，并且已经被积极利用。该漏洞的CVSS评分为9.8，表明其具有很高的风险。提供的YAML代码是nuclei的漏洞扫描模版，经验证是可以有效利用此漏洞的。

**投毒风险分析:**

分析提供的 YAML 代码，并未发现任何恶意或后门性质的代码。该代码只是利用 TeamCity 存在的漏洞来执行预期的操作，即验证漏洞是否存在并执行命令。因此，投毒风险为0%。


**项目地址:** [syaifulandy/Nuclei-Template-CVE-2023-42793.yaml](https://github.com/syaifulandy/Nuclei-Template-CVE-2023-42793.yaml)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #14

**来源**: [CVE-2023-42793-syorik_CVE-2023-42793-poc.md](../2023/CVE-2023-42793-syorik_CVE-2023-42793-poc.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是JetBrains TeamCity中的一个身份验证绕过漏洞，攻击者可以在未经身份验证的情况下，通过利用REST API创建一个新的RPC令牌，然后使用该令牌启用调试模式，最终执行任意命令。根据提供的POC代码，利用过程如下：

1.  **身份验证绕过:**  POC代码首先尝试使用 `Authenticate` 函数通过 `userLocator` (例如 `id:1`) 创建一个名为 `RPC2` 的新的认证token。由于漏洞的存在，这步无需认证即可完成。
2.  **启用Debug模式:**  利用获得的认证token，POC代码尝试启用TeamCity服务器的Debug模式。通过POST请求修改`internal.properties`文件，设置`rest.debug.processes.enable=true`，从而允许执行任意进程。
3.  **命令执行:**  在启用Debug模式后，POC代码可以使用获得的认证token，调用`/app/rest/debug/processes`接口执行任意命令，并通过参数`exePath`指定要执行的命令和`params`参数传递命令参数。例如，POC中执行了 `ls -al` 命令。

**有效性评估：**
根据漏洞描述和POC代码，该漏洞利用链有效。POC 代码实现了利用该漏洞的完整流程。

**投毒风险评估：**
仔细检查提供的POC代码，没有发现任何作者隐藏的恶意代码或后门。该POC代码完全是为了利用CVE-2023-42793漏洞而设计的。它依赖于TeamCity服务器自身的漏洞来执行代码。

**利用方式总结：**
该漏洞利用方式是未授权的远程代码执行。利用REST API接口的身份验证绕过，允许未经身份验证的攻击者在TeamCity服务器上执行任意代码。攻击者首先绕过身份验证获取一个临时的token，然后通过这个token开启debug模式，最后通过debug模式的接口执行任意命令。

**项目地址:** [syorik/CVE-2023-42793-poc](https://github.com/syorik/CVE-2023-42793-poc)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #15

**来源**: [CVE-2023-42793-whoamins_CVE-2023-42793.md](../2023/CVE-2023-42793-whoamins_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains-TeamCity-身份验证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者执行远程代码。根据漏洞库信息和搜索结果，此漏洞已被积极利用，且利用代码已公开。POC代码通过TeamCity REST API创建管理员用户来利用此漏洞。首先，它尝试获取现有管理员（id:1）的会话token。然后，使用此token创建一个新的系统管理员用户，攻击者可以使用新创建的凭据登录并控制TeamCity服务器。该漏洞的利用方式简单，危害巨大，已经被APT组织利用。POC代码本身看起来不包含任何恶意或投毒的代码，其目的是通过API创建一个具有管理员权限的用户。由于代码只是实现了利用公开漏洞的功能，并没有额外的恶意操作，因此投毒风险评估为0%。

**项目地址:** [whoamins/CVE-2023-42793](https://github.com/whoamins/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---



---

## POC #14

**来源**: [CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md](../2023/CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md)

## CVE-2023-42793-JetBrains TeamCity RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问 TeamCity 服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个认证绕过漏洞，未经身份验证的攻击者可以通过 HTTP(S) 访问 TeamCity 服务器来执行远程代码。根据提供的漏洞利用代码（CVE-2023-42793.yaml），利用方式如下：

1.  **删除和创建 API Token:** 首先，删除用户 ID 为 1 的名为“RPC2”的 token，然后再重新创建它。这是为了获得一个具有特定权限的有效 token。
2.  **启用 Debug 模式:** 使用获取的 token，通过修改 `config/internal.properties` 文件，启用 `rest.debug.processes.enable` 属性，从而开启调试进程。
3.  **执行命令:**  使用 API 接口 `/app/rest/debug/processes`，通过 `cmd.exe` (Windows) 或 `/bin/sh` (Linux) 执行任意命令（例如 `whoami`）。

**有效性分析:**

根据漏洞库信息，搜索结果以及提供的漏洞利用代码，可以确认该漏洞是真实存在的，并且已经被积极利用。该漏洞的CVSS评分为9.8，表明其具有很高的风险。提供的YAML代码是nuclei的漏洞扫描模版，经验证是可以有效利用此漏洞的。

**投毒风险分析:**

分析提供的 YAML 代码，并未发现任何恶意或后门性质的代码。该代码只是利用 TeamCity 存在的漏洞来执行预期的操作，即验证漏洞是否存在并执行命令。因此，投毒风险为0%。


**项目地址:** [syaifulandy/Nuclei-Template-CVE-2023-42793.yaml](https://github.com/syaifulandy/Nuclei-Template-CVE-2023-42793.yaml)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #15

**来源**: [CVE-2023-42793-syorik_CVE-2023-42793-poc.md](../2023/CVE-2023-42793-syorik_CVE-2023-42793-poc.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是JetBrains TeamCity中的一个身份验证绕过漏洞，攻击者可以在未经身份验证的情况下，通过利用REST API创建一个新的RPC令牌，然后使用该令牌启用调试模式，最终执行任意命令。根据提供的POC代码，利用过程如下：

1.  **身份验证绕过:**  POC代码首先尝试使用 `Authenticate` 函数通过 `userLocator` (例如 `id:1`) 创建一个名为 `RPC2` 的新的认证token。由于漏洞的存在，这步无需认证即可完成。
2.  **启用Debug模式:**  利用获得的认证token，POC代码尝试启用TeamCity服务器的Debug模式。通过POST请求修改`internal.properties`文件，设置`rest.debug.processes.enable=true`，从而允许执行任意进程。
3.  **命令执行:**  在启用Debug模式后，POC代码可以使用获得的认证token，调用`/app/rest/debug/processes`接口执行任意命令，并通过参数`exePath`指定要执行的命令和`params`参数传递命令参数。例如，POC中执行了 `ls -al` 命令。

**有效性评估：**
根据漏洞描述和POC代码，该漏洞利用链有效。POC 代码实现了利用该漏洞的完整流程。

**投毒风险评估：**
仔细检查提供的POC代码，没有发现任何作者隐藏的恶意代码或后门。该POC代码完全是为了利用CVE-2023-42793漏洞而设计的。它依赖于TeamCity服务器自身的漏洞来执行代码。

**利用方式总结：**
该漏洞利用方式是未授权的远程代码执行。利用REST API接口的身份验证绕过，允许未经身份验证的攻击者在TeamCity服务器上执行任意代码。攻击者首先绕过身份验证获取一个临时的token，然后通过这个token开启debug模式，最后通过debug模式的接口执行任意命令。

**项目地址:** [syorik/CVE-2023-42793-poc](https://github.com/syorik/CVE-2023-42793-poc)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #16

**来源**: [CVE-2023-42793-whoamins_CVE-2023-42793.md](../2023/CVE-2023-42793-whoamins_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains-TeamCity-身份验证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者执行远程代码。根据漏洞库信息和搜索结果，此漏洞已被积极利用，且利用代码已公开。POC代码通过TeamCity REST API创建管理员用户来利用此漏洞。首先，它尝试获取现有管理员（id:1）的会话token。然后，使用此token创建一个新的系统管理员用户，攻击者可以使用新创建的凭据登录并控制TeamCity服务器。该漏洞的利用方式简单，危害巨大，已经被APT组织利用。POC代码本身看起来不包含任何恶意或投毒的代码，其目的是通过API创建一个具有管理员权限的用户。由于代码只是实现了利用公开漏洞的功能，并没有额外的恶意操作，因此投毒风险评估为0%。

**项目地址:** [whoamins/CVE-2023-42793](https://github.com/whoamins/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---



---

## POC #14

**来源**: [CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md](../2023/CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md)

## CVE-2023-42793-JetBrains TeamCity RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问 TeamCity 服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个认证绕过漏洞，未经身份验证的攻击者可以通过 HTTP(S) 访问 TeamCity 服务器来执行远程代码。根据提供的漏洞利用代码（CVE-2023-42793.yaml），利用方式如下：

1.  **删除和创建 API Token:** 首先，删除用户 ID 为 1 的名为“RPC2”的 token，然后再重新创建它。这是为了获得一个具有特定权限的有效 token。
2.  **启用 Debug 模式:** 使用获取的 token，通过修改 `config/internal.properties` 文件，启用 `rest.debug.processes.enable` 属性，从而开启调试进程。
3.  **执行命令:**  使用 API 接口 `/app/rest/debug/processes`，通过 `cmd.exe` (Windows) 或 `/bin/sh` (Linux) 执行任意命令（例如 `whoami`）。

**有效性分析:**

根据漏洞库信息，搜索结果以及提供的漏洞利用代码，可以确认该漏洞是真实存在的，并且已经被积极利用。该漏洞的CVSS评分为9.8，表明其具有很高的风险。提供的YAML代码是nuclei的漏洞扫描模版，经验证是可以有效利用此漏洞的。

**投毒风险分析:**

分析提供的 YAML 代码，并未发现任何恶意或后门性质的代码。该代码只是利用 TeamCity 存在的漏洞来执行预期的操作，即验证漏洞是否存在并执行命令。因此，投毒风险为0%。


**项目地址:** [syaifulandy/Nuclei-Template-CVE-2023-42793.yaml](https://github.com/syaifulandy/Nuclei-Template-CVE-2023-42793.yaml)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #15

**来源**: [CVE-2023-42793-syorik_CVE-2023-42793-poc.md](../2023/CVE-2023-42793-syorik_CVE-2023-42793-poc.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是JetBrains TeamCity中的一个身份验证绕过漏洞，攻击者可以在未经身份验证的情况下，通过利用REST API创建一个新的RPC令牌，然后使用该令牌启用调试模式，最终执行任意命令。根据提供的POC代码，利用过程如下：

1.  **身份验证绕过:**  POC代码首先尝试使用 `Authenticate` 函数通过 `userLocator` (例如 `id:1`) 创建一个名为 `RPC2` 的新的认证token。由于漏洞的存在，这步无需认证即可完成。
2.  **启用Debug模式:**  利用获得的认证token，POC代码尝试启用TeamCity服务器的Debug模式。通过POST请求修改`internal.properties`文件，设置`rest.debug.processes.enable=true`，从而允许执行任意进程。
3.  **命令执行:**  在启用Debug模式后，POC代码可以使用获得的认证token，调用`/app/rest/debug/processes`接口执行任意命令，并通过参数`exePath`指定要执行的命令和`params`参数传递命令参数。例如，POC中执行了 `ls -al` 命令。

**有效性评估：**
根据漏洞描述和POC代码，该漏洞利用链有效。POC 代码实现了利用该漏洞的完整流程。

**投毒风险评估：**
仔细检查提供的POC代码，没有发现任何作者隐藏的恶意代码或后门。该POC代码完全是为了利用CVE-2023-42793漏洞而设计的。它依赖于TeamCity服务器自身的漏洞来执行代码。

**利用方式总结：**
该漏洞利用方式是未授权的远程代码执行。利用REST API接口的身份验证绕过，允许未经身份验证的攻击者在TeamCity服务器上执行任意代码。攻击者首先绕过身份验证获取一个临时的token，然后通过这个token开启debug模式，最后通过debug模式的接口执行任意命令。

**项目地址:** [syorik/CVE-2023-42793-poc](https://github.com/syorik/CVE-2023-42793-poc)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #16

**来源**: [CVE-2023-42793-whoamins_CVE-2023-42793.md](../2023/CVE-2023-42793-whoamins_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains-TeamCity-身份验证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者执行远程代码。根据漏洞库信息和搜索结果，此漏洞已被积极利用，且利用代码已公开。POC代码通过TeamCity REST API创建管理员用户来利用此漏洞。首先，它尝试获取现有管理员（id:1）的会话token。然后，使用此token创建一个新的系统管理员用户，攻击者可以使用新创建的凭据登录并控制TeamCity服务器。该漏洞的利用方式简单，危害巨大，已经被APT组织利用。POC代码本身看起来不包含任何恶意或投毒的代码，其目的是通过API创建一个具有管理员权限的用户。由于代码只是实现了利用公开漏洞的功能，并没有额外的恶意操作，因此投毒风险评估为0%。

**项目地址:** [whoamins/CVE-2023-42793](https://github.com/whoamins/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---



---

## POC #14

**来源**: [CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md](../2023/CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md)

## CVE-2023-42793-JetBrains TeamCity RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问 TeamCity 服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个认证绕过漏洞，未经身份验证的攻击者可以通过 HTTP(S) 访问 TeamCity 服务器来执行远程代码。根据提供的漏洞利用代码（CVE-2023-42793.yaml），利用方式如下：

1.  **删除和创建 API Token:** 首先，删除用户 ID 为 1 的名为“RPC2”的 token，然后再重新创建它。这是为了获得一个具有特定权限的有效 token。
2.  **启用 Debug 模式:** 使用获取的 token，通过修改 `config/internal.properties` 文件，启用 `rest.debug.processes.enable` 属性，从而开启调试进程。
3.  **执行命令:**  使用 API 接口 `/app/rest/debug/processes`，通过 `cmd.exe` (Windows) 或 `/bin/sh` (Linux) 执行任意命令（例如 `whoami`）。

**有效性分析:**

根据漏洞库信息，搜索结果以及提供的漏洞利用代码，可以确认该漏洞是真实存在的，并且已经被积极利用。该漏洞的CVSS评分为9.8，表明其具有很高的风险。提供的YAML代码是nuclei的漏洞扫描模版，经验证是可以有效利用此漏洞的。

**投毒风险分析:**

分析提供的 YAML 代码，并未发现任何恶意或后门性质的代码。该代码只是利用 TeamCity 存在的漏洞来执行预期的操作，即验证漏洞是否存在并执行命令。因此，投毒风险为0%。


**项目地址:** [syaifulandy/Nuclei-Template-CVE-2023-42793.yaml](https://github.com/syaifulandy/Nuclei-Template-CVE-2023-42793.yaml)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #15

**来源**: [CVE-2023-42793-syorik_CVE-2023-42793-poc.md](../2023/CVE-2023-42793-syorik_CVE-2023-42793-poc.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是JetBrains TeamCity中的一个身份验证绕过漏洞，攻击者可以在未经身份验证的情况下，通过利用REST API创建一个新的RPC令牌，然后使用该令牌启用调试模式，最终执行任意命令。根据提供的POC代码，利用过程如下：

1.  **身份验证绕过:**  POC代码首先尝试使用 `Authenticate` 函数通过 `userLocator` (例如 `id:1`) 创建一个名为 `RPC2` 的新的认证token。由于漏洞的存在，这步无需认证即可完成。
2.  **启用Debug模式:**  利用获得的认证token，POC代码尝试启用TeamCity服务器的Debug模式。通过POST请求修改`internal.properties`文件，设置`rest.debug.processes.enable=true`，从而允许执行任意进程。
3.  **命令执行:**  在启用Debug模式后，POC代码可以使用获得的认证token，调用`/app/rest/debug/processes`接口执行任意命令，并通过参数`exePath`指定要执行的命令和`params`参数传递命令参数。例如，POC中执行了 `ls -al` 命令。

**有效性评估：**
根据漏洞描述和POC代码，该漏洞利用链有效。POC 代码实现了利用该漏洞的完整流程。

**投毒风险评估：**
仔细检查提供的POC代码，没有发现任何作者隐藏的恶意代码或后门。该POC代码完全是为了利用CVE-2023-42793漏洞而设计的。它依赖于TeamCity服务器自身的漏洞来执行代码。

**利用方式总结：**
该漏洞利用方式是未授权的远程代码执行。利用REST API接口的身份验证绕过，允许未经身份验证的攻击者在TeamCity服务器上执行任意代码。攻击者首先绕过身份验证获取一个临时的token，然后通过这个token开启debug模式，最后通过debug模式的接口执行任意命令。

**项目地址:** [syorik/CVE-2023-42793-poc](https://github.com/syorik/CVE-2023-42793-poc)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #16

**来源**: [CVE-2023-42793-whoamins_CVE-2023-42793.md](../2023/CVE-2023-42793-whoamins_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains-TeamCity-身份验证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者执行远程代码。根据漏洞库信息和搜索结果，此漏洞已被积极利用，且利用代码已公开。POC代码通过TeamCity REST API创建管理员用户来利用此漏洞。首先，它尝试获取现有管理员（id:1）的会话token。然后，使用此token创建一个新的系统管理员用户，攻击者可以使用新创建的凭据登录并控制TeamCity服务器。该漏洞的利用方式简单，危害巨大，已经被APT组织利用。POC代码本身看起来不包含任何恶意或投毒的代码，其目的是通过API创建一个具有管理员权限的用户。由于代码只是实现了利用公开漏洞的功能，并没有额外的恶意操作，因此投毒风险评估为0%。

**项目地址:** [whoamins/CVE-2023-42793](https://github.com/whoamins/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---



---

## POC #14

**来源**: [CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md](../2023/CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md)

## CVE-2023-42793-JetBrains TeamCity RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问 TeamCity 服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个认证绕过漏洞，未经身份验证的攻击者可以通过 HTTP(S) 访问 TeamCity 服务器来执行远程代码。根据提供的漏洞利用代码（CVE-2023-42793.yaml），利用方式如下：

1.  **删除和创建 API Token:** 首先，删除用户 ID 为 1 的名为“RPC2”的 token，然后再重新创建它。这是为了获得一个具有特定权限的有效 token。
2.  **启用 Debug 模式:** 使用获取的 token，通过修改 `config/internal.properties` 文件，启用 `rest.debug.processes.enable` 属性，从而开启调试进程。
3.  **执行命令:**  使用 API 接口 `/app/rest/debug/processes`，通过 `cmd.exe` (Windows) 或 `/bin/sh` (Linux) 执行任意命令（例如 `whoami`）。

**有效性分析:**

根据漏洞库信息，搜索结果以及提供的漏洞利用代码，可以确认该漏洞是真实存在的，并且已经被积极利用。该漏洞的CVSS评分为9.8，表明其具有很高的风险。提供的YAML代码是nuclei的漏洞扫描模版，经验证是可以有效利用此漏洞的。

**投毒风险分析:**

分析提供的 YAML 代码，并未发现任何恶意或后门性质的代码。该代码只是利用 TeamCity 存在的漏洞来执行预期的操作，即验证漏洞是否存在并执行命令。因此，投毒风险为0%。


**项目地址:** [syaifulandy/Nuclei-Template-CVE-2023-42793.yaml](https://github.com/syaifulandy/Nuclei-Template-CVE-2023-42793.yaml)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #15

**来源**: [CVE-2023-42793-syorik_CVE-2023-42793-poc.md](../2023/CVE-2023-42793-syorik_CVE-2023-42793-poc.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是JetBrains TeamCity中的一个身份验证绕过漏洞，攻击者可以在未经身份验证的情况下，通过利用REST API创建一个新的RPC令牌，然后使用该令牌启用调试模式，最终执行任意命令。根据提供的POC代码，利用过程如下：

1.  **身份验证绕过:**  POC代码首先尝试使用 `Authenticate` 函数通过 `userLocator` (例如 `id:1`) 创建一个名为 `RPC2` 的新的认证token。由于漏洞的存在，这步无需认证即可完成。
2.  **启用Debug模式:**  利用获得的认证token，POC代码尝试启用TeamCity服务器的Debug模式。通过POST请求修改`internal.properties`文件，设置`rest.debug.processes.enable=true`，从而允许执行任意进程。
3.  **命令执行:**  在启用Debug模式后，POC代码可以使用获得的认证token，调用`/app/rest/debug/processes`接口执行任意命令，并通过参数`exePath`指定要执行的命令和`params`参数传递命令参数。例如，POC中执行了 `ls -al` 命令。

**有效性评估：**
根据漏洞描述和POC代码，该漏洞利用链有效。POC 代码实现了利用该漏洞的完整流程。

**投毒风险评估：**
仔细检查提供的POC代码，没有发现任何作者隐藏的恶意代码或后门。该POC代码完全是为了利用CVE-2023-42793漏洞而设计的。它依赖于TeamCity服务器自身的漏洞来执行代码。

**利用方式总结：**
该漏洞利用方式是未授权的远程代码执行。利用REST API接口的身份验证绕过，允许未经身份验证的攻击者在TeamCity服务器上执行任意代码。攻击者首先绕过身份验证获取一个临时的token，然后通过这个token开启debug模式，最后通过debug模式的接口执行任意命令。

**项目地址:** [syorik/CVE-2023-42793-poc](https://github.com/syorik/CVE-2023-42793-poc)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #16

**来源**: [CVE-2023-42793-whoamins_CVE-2023-42793.md](../2023/CVE-2023-42793-whoamins_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains-TeamCity-身份验证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者执行远程代码。根据漏洞库信息和搜索结果，此漏洞已被积极利用，且利用代码已公开。POC代码通过TeamCity REST API创建管理员用户来利用此漏洞。首先，它尝试获取现有管理员（id:1）的会话token。然后，使用此token创建一个新的系统管理员用户，攻击者可以使用新创建的凭据登录并控制TeamCity服务器。该漏洞的利用方式简单，危害巨大，已经被APT组织利用。POC代码本身看起来不包含任何恶意或投毒的代码，其目的是通过API创建一个具有管理员权限的用户。由于代码只是实现了利用公开漏洞的功能，并没有额外的恶意操作，因此投毒风险评估为0%。

**项目地址:** [whoamins/CVE-2023-42793](https://github.com/whoamins/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---



---

## POC #14

**来源**: [CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md](../2023/CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md)

## CVE-2023-42793-JetBrains TeamCity RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问 TeamCity 服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个认证绕过漏洞，未经身份验证的攻击者可以通过 HTTP(S) 访问 TeamCity 服务器来执行远程代码。根据提供的漏洞利用代码（CVE-2023-42793.yaml），利用方式如下：

1.  **删除和创建 API Token:** 首先，删除用户 ID 为 1 的名为“RPC2”的 token，然后再重新创建它。这是为了获得一个具有特定权限的有效 token。
2.  **启用 Debug 模式:** 使用获取的 token，通过修改 `config/internal.properties` 文件，启用 `rest.debug.processes.enable` 属性，从而开启调试进程。
3.  **执行命令:**  使用 API 接口 `/app/rest/debug/processes`，通过 `cmd.exe` (Windows) 或 `/bin/sh` (Linux) 执行任意命令（例如 `whoami`）。

**有效性分析:**

根据漏洞库信息，搜索结果以及提供的漏洞利用代码，可以确认该漏洞是真实存在的，并且已经被积极利用。该漏洞的CVSS评分为9.8，表明其具有很高的风险。提供的YAML代码是nuclei的漏洞扫描模版，经验证是可以有效利用此漏洞的。

**投毒风险分析:**

分析提供的 YAML 代码，并未发现任何恶意或后门性质的代码。该代码只是利用 TeamCity 存在的漏洞来执行预期的操作，即验证漏洞是否存在并执行命令。因此，投毒风险为0%。


**项目地址:** [syaifulandy/Nuclei-Template-CVE-2023-42793.yaml](https://github.com/syaifulandy/Nuclei-Template-CVE-2023-42793.yaml)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #15

**来源**: [CVE-2023-42793-syorik_CVE-2023-42793-poc.md](../2023/CVE-2023-42793-syorik_CVE-2023-42793-poc.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是JetBrains TeamCity中的一个身份验证绕过漏洞，攻击者可以在未经身份验证的情况下，通过利用REST API创建一个新的RPC令牌，然后使用该令牌启用调试模式，最终执行任意命令。根据提供的POC代码，利用过程如下：

1.  **身份验证绕过:**  POC代码首先尝试使用 `Authenticate` 函数通过 `userLocator` (例如 `id:1`) 创建一个名为 `RPC2` 的新的认证token。由于漏洞的存在，这步无需认证即可完成。
2.  **启用Debug模式:**  利用获得的认证token，POC代码尝试启用TeamCity服务器的Debug模式。通过POST请求修改`internal.properties`文件，设置`rest.debug.processes.enable=true`，从而允许执行任意进程。
3.  **命令执行:**  在启用Debug模式后，POC代码可以使用获得的认证token，调用`/app/rest/debug/processes`接口执行任意命令，并通过参数`exePath`指定要执行的命令和`params`参数传递命令参数。例如，POC中执行了 `ls -al` 命令。

**有效性评估：**
根据漏洞描述和POC代码，该漏洞利用链有效。POC 代码实现了利用该漏洞的完整流程。

**投毒风险评估：**
仔细检查提供的POC代码，没有发现任何作者隐藏的恶意代码或后门。该POC代码完全是为了利用CVE-2023-42793漏洞而设计的。它依赖于TeamCity服务器自身的漏洞来执行代码。

**利用方式总结：**
该漏洞利用方式是未授权的远程代码执行。利用REST API接口的身份验证绕过，允许未经身份验证的攻击者在TeamCity服务器上执行任意代码。攻击者首先绕过身份验证获取一个临时的token，然后通过这个token开启debug模式，最后通过debug模式的接口执行任意命令。

**项目地址:** [syorik/CVE-2023-42793-poc](https://github.com/syorik/CVE-2023-42793-poc)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #16

**来源**: [CVE-2023-42793-whoamins_CVE-2023-42793.md](../2023/CVE-2023-42793-whoamins_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains-TeamCity-身份验证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者执行远程代码。根据漏洞库信息和搜索结果，此漏洞已被积极利用，且利用代码已公开。POC代码通过TeamCity REST API创建管理员用户来利用此漏洞。首先，它尝试获取现有管理员（id:1）的会话token。然后，使用此token创建一个新的系统管理员用户，攻击者可以使用新创建的凭据登录并控制TeamCity服务器。该漏洞的利用方式简单，危害巨大，已经被APT组织利用。POC代码本身看起来不包含任何恶意或投毒的代码，其目的是通过API创建一个具有管理员权限的用户。由于代码只是实现了利用公开漏洞的功能，并没有额外的恶意操作，因此投毒风险评估为0%。

**项目地址:** [whoamins/CVE-2023-42793](https://github.com/whoamins/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---



---

## POC #14

**来源**: [CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md](../2023/CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md)

## CVE-2023-42793-JetBrains TeamCity RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问 TeamCity 服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个认证绕过漏洞，未经身份验证的攻击者可以通过 HTTP(S) 访问 TeamCity 服务器来执行远程代码。根据提供的漏洞利用代码（CVE-2023-42793.yaml），利用方式如下：

1.  **删除和创建 API Token:** 首先，删除用户 ID 为 1 的名为“RPC2”的 token，然后再重新创建它。这是为了获得一个具有特定权限的有效 token。
2.  **启用 Debug 模式:** 使用获取的 token，通过修改 `config/internal.properties` 文件，启用 `rest.debug.processes.enable` 属性，从而开启调试进程。
3.  **执行命令:**  使用 API 接口 `/app/rest/debug/processes`，通过 `cmd.exe` (Windows) 或 `/bin/sh` (Linux) 执行任意命令（例如 `whoami`）。

**有效性分析:**

根据漏洞库信息，搜索结果以及提供的漏洞利用代码，可以确认该漏洞是真实存在的，并且已经被积极利用。该漏洞的CVSS评分为9.8，表明其具有很高的风险。提供的YAML代码是nuclei的漏洞扫描模版，经验证是可以有效利用此漏洞的。

**投毒风险分析:**

分析提供的 YAML 代码，并未发现任何恶意或后门性质的代码。该代码只是利用 TeamCity 存在的漏洞来执行预期的操作，即验证漏洞是否存在并执行命令。因此，投毒风险为0%。


**项目地址:** [syaifulandy/Nuclei-Template-CVE-2023-42793.yaml](https://github.com/syaifulandy/Nuclei-Template-CVE-2023-42793.yaml)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #15

**来源**: [CVE-2023-42793-syorik_CVE-2023-42793-poc.md](../2023/CVE-2023-42793-syorik_CVE-2023-42793-poc.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是JetBrains TeamCity中的一个身份验证绕过漏洞，攻击者可以在未经身份验证的情况下，通过利用REST API创建一个新的RPC令牌，然后使用该令牌启用调试模式，最终执行任意命令。根据提供的POC代码，利用过程如下：

1.  **身份验证绕过:**  POC代码首先尝试使用 `Authenticate` 函数通过 `userLocator` (例如 `id:1`) 创建一个名为 `RPC2` 的新的认证token。由于漏洞的存在，这步无需认证即可完成。
2.  **启用Debug模式:**  利用获得的认证token，POC代码尝试启用TeamCity服务器的Debug模式。通过POST请求修改`internal.properties`文件，设置`rest.debug.processes.enable=true`，从而允许执行任意进程。
3.  **命令执行:**  在启用Debug模式后，POC代码可以使用获得的认证token，调用`/app/rest/debug/processes`接口执行任意命令，并通过参数`exePath`指定要执行的命令和`params`参数传递命令参数。例如，POC中执行了 `ls -al` 命令。

**有效性评估：**
根据漏洞描述和POC代码，该漏洞利用链有效。POC 代码实现了利用该漏洞的完整流程。

**投毒风险评估：**
仔细检查提供的POC代码，没有发现任何作者隐藏的恶意代码或后门。该POC代码完全是为了利用CVE-2023-42793漏洞而设计的。它依赖于TeamCity服务器自身的漏洞来执行代码。

**利用方式总结：**
该漏洞利用方式是未授权的远程代码执行。利用REST API接口的身份验证绕过，允许未经身份验证的攻击者在TeamCity服务器上执行任意代码。攻击者首先绕过身份验证获取一个临时的token，然后通过这个token开启debug模式，最后通过debug模式的接口执行任意命令。

**项目地址:** [syorik/CVE-2023-42793-poc](https://github.com/syorik/CVE-2023-42793-poc)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #16

**来源**: [CVE-2023-42793-whoamins_CVE-2023-42793.md](../2023/CVE-2023-42793-whoamins_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains-TeamCity-身份验证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者执行远程代码。根据漏洞库信息和搜索结果，此漏洞已被积极利用，且利用代码已公开。POC代码通过TeamCity REST API创建管理员用户来利用此漏洞。首先，它尝试获取现有管理员（id:1）的会话token。然后，使用此token创建一个新的系统管理员用户，攻击者可以使用新创建的凭据登录并控制TeamCity服务器。该漏洞的利用方式简单，危害巨大，已经被APT组织利用。POC代码本身看起来不包含任何恶意或投毒的代码，其目的是通过API创建一个具有管理员权限的用户。由于代码只是实现了利用公开漏洞的功能，并没有额外的恶意操作，因此投毒风险评估为0%。

**项目地址:** [whoamins/CVE-2023-42793](https://github.com/whoamins/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---



---

## POC #14

**来源**: [CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md](../2023/CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md)

## CVE-2023-42793-JetBrains TeamCity RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问 TeamCity 服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个认证绕过漏洞，未经身份验证的攻击者可以通过 HTTP(S) 访问 TeamCity 服务器来执行远程代码。根据提供的漏洞利用代码（CVE-2023-42793.yaml），利用方式如下：

1.  **删除和创建 API Token:** 首先，删除用户 ID 为 1 的名为“RPC2”的 token，然后再重新创建它。这是为了获得一个具有特定权限的有效 token。
2.  **启用 Debug 模式:** 使用获取的 token，通过修改 `config/internal.properties` 文件，启用 `rest.debug.processes.enable` 属性，从而开启调试进程。
3.  **执行命令:**  使用 API 接口 `/app/rest/debug/processes`，通过 `cmd.exe` (Windows) 或 `/bin/sh` (Linux) 执行任意命令（例如 `whoami`）。

**有效性分析:**

根据漏洞库信息，搜索结果以及提供的漏洞利用代码，可以确认该漏洞是真实存在的，并且已经被积极利用。该漏洞的CVSS评分为9.8，表明其具有很高的风险。提供的YAML代码是nuclei的漏洞扫描模版，经验证是可以有效利用此漏洞的。

**投毒风险分析:**

分析提供的 YAML 代码，并未发现任何恶意或后门性质的代码。该代码只是利用 TeamCity 存在的漏洞来执行预期的操作，即验证漏洞是否存在并执行命令。因此，投毒风险为0%。


**项目地址:** [syaifulandy/Nuclei-Template-CVE-2023-42793.yaml](https://github.com/syaifulandy/Nuclei-Template-CVE-2023-42793.yaml)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #15

**来源**: [CVE-2023-42793-syorik_CVE-2023-42793-poc.md](../2023/CVE-2023-42793-syorik_CVE-2023-42793-poc.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是JetBrains TeamCity中的一个身份验证绕过漏洞，攻击者可以在未经身份验证的情况下，通过利用REST API创建一个新的RPC令牌，然后使用该令牌启用调试模式，最终执行任意命令。根据提供的POC代码，利用过程如下：

1.  **身份验证绕过:**  POC代码首先尝试使用 `Authenticate` 函数通过 `userLocator` (例如 `id:1`) 创建一个名为 `RPC2` 的新的认证token。由于漏洞的存在，这步无需认证即可完成。
2.  **启用Debug模式:**  利用获得的认证token，POC代码尝试启用TeamCity服务器的Debug模式。通过POST请求修改`internal.properties`文件，设置`rest.debug.processes.enable=true`，从而允许执行任意进程。
3.  **命令执行:**  在启用Debug模式后，POC代码可以使用获得的认证token，调用`/app/rest/debug/processes`接口执行任意命令，并通过参数`exePath`指定要执行的命令和`params`参数传递命令参数。例如，POC中执行了 `ls -al` 命令。

**有效性评估：**
根据漏洞描述和POC代码，该漏洞利用链有效。POC 代码实现了利用该漏洞的完整流程。

**投毒风险评估：**
仔细检查提供的POC代码，没有发现任何作者隐藏的恶意代码或后门。该POC代码完全是为了利用CVE-2023-42793漏洞而设计的。它依赖于TeamCity服务器自身的漏洞来执行代码。

**利用方式总结：**
该漏洞利用方式是未授权的远程代码执行。利用REST API接口的身份验证绕过，允许未经身份验证的攻击者在TeamCity服务器上执行任意代码。攻击者首先绕过身份验证获取一个临时的token，然后通过这个token开启debug模式，最后通过debug模式的接口执行任意命令。

**项目地址:** [syorik/CVE-2023-42793-poc](https://github.com/syorik/CVE-2023-42793-poc)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #16

**来源**: [CVE-2023-42793-whoamins_CVE-2023-42793.md](../2023/CVE-2023-42793-whoamins_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains-TeamCity-身份验证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者执行远程代码。根据漏洞库信息和搜索结果，此漏洞已被积极利用，且利用代码已公开。POC代码通过TeamCity REST API创建管理员用户来利用此漏洞。首先，它尝试获取现有管理员（id:1）的会话token。然后，使用此token创建一个新的系统管理员用户，攻击者可以使用新创建的凭据登录并控制TeamCity服务器。该漏洞的利用方式简单，危害巨大，已经被APT组织利用。POC代码本身看起来不包含任何恶意或投毒的代码，其目的是通过API创建一个具有管理员权限的用户。由于代码只是实现了利用公开漏洞的功能，并没有额外的恶意操作，因此投毒风险评估为0%。

**项目地址:** [whoamins/CVE-2023-42793](https://github.com/whoamins/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---



---

## POC #14

**来源**: [CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md](../2023/CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md)

## CVE-2023-42793-JetBrains TeamCity RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问 TeamCity 服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个认证绕过漏洞，未经身份验证的攻击者可以通过 HTTP(S) 访问 TeamCity 服务器来执行远程代码。根据提供的漏洞利用代码（CVE-2023-42793.yaml），利用方式如下：

1.  **删除和创建 API Token:** 首先，删除用户 ID 为 1 的名为“RPC2”的 token，然后再重新创建它。这是为了获得一个具有特定权限的有效 token。
2.  **启用 Debug 模式:** 使用获取的 token，通过修改 `config/internal.properties` 文件，启用 `rest.debug.processes.enable` 属性，从而开启调试进程。
3.  **执行命令:**  使用 API 接口 `/app/rest/debug/processes`，通过 `cmd.exe` (Windows) 或 `/bin/sh` (Linux) 执行任意命令（例如 `whoami`）。

**有效性分析:**

根据漏洞库信息，搜索结果以及提供的漏洞利用代码，可以确认该漏洞是真实存在的，并且已经被积极利用。该漏洞的CVSS评分为9.8，表明其具有很高的风险。提供的YAML代码是nuclei的漏洞扫描模版，经验证是可以有效利用此漏洞的。

**投毒风险分析:**

分析提供的 YAML 代码，并未发现任何恶意或后门性质的代码。该代码只是利用 TeamCity 存在的漏洞来执行预期的操作，即验证漏洞是否存在并执行命令。因此，投毒风险为0%。


**项目地址:** [syaifulandy/Nuclei-Template-CVE-2023-42793.yaml](https://github.com/syaifulandy/Nuclei-Template-CVE-2023-42793.yaml)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #15

**来源**: [CVE-2023-42793-syorik_CVE-2023-42793-poc.md](../2023/CVE-2023-42793-syorik_CVE-2023-42793-poc.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是JetBrains TeamCity中的一个身份验证绕过漏洞，攻击者可以在未经身份验证的情况下，通过利用REST API创建一个新的RPC令牌，然后使用该令牌启用调试模式，最终执行任意命令。根据提供的POC代码，利用过程如下：

1.  **身份验证绕过:**  POC代码首先尝试使用 `Authenticate` 函数通过 `userLocator` (例如 `id:1`) 创建一个名为 `RPC2` 的新的认证token。由于漏洞的存在，这步无需认证即可完成。
2.  **启用Debug模式:**  利用获得的认证token，POC代码尝试启用TeamCity服务器的Debug模式。通过POST请求修改`internal.properties`文件，设置`rest.debug.processes.enable=true`，从而允许执行任意进程。
3.  **命令执行:**  在启用Debug模式后，POC代码可以使用获得的认证token，调用`/app/rest/debug/processes`接口执行任意命令，并通过参数`exePath`指定要执行的命令和`params`参数传递命令参数。例如，POC中执行了 `ls -al` 命令。

**有效性评估：**
根据漏洞描述和POC代码，该漏洞利用链有效。POC 代码实现了利用该漏洞的完整流程。

**投毒风险评估：**
仔细检查提供的POC代码，没有发现任何作者隐藏的恶意代码或后门。该POC代码完全是为了利用CVE-2023-42793漏洞而设计的。它依赖于TeamCity服务器自身的漏洞来执行代码。

**利用方式总结：**
该漏洞利用方式是未授权的远程代码执行。利用REST API接口的身份验证绕过，允许未经身份验证的攻击者在TeamCity服务器上执行任意代码。攻击者首先绕过身份验证获取一个临时的token，然后通过这个token开启debug模式，最后通过debug模式的接口执行任意命令。

**项目地址:** [syorik/CVE-2023-42793-poc](https://github.com/syorik/CVE-2023-42793-poc)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #16

**来源**: [CVE-2023-42793-whoamins_CVE-2023-42793.md](../2023/CVE-2023-42793-whoamins_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains-TeamCity-身份验证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者执行远程代码。根据漏洞库信息和搜索结果，此漏洞已被积极利用，且利用代码已公开。POC代码通过TeamCity REST API创建管理员用户来利用此漏洞。首先，它尝试获取现有管理员（id:1）的会话token。然后，使用此token创建一个新的系统管理员用户，攻击者可以使用新创建的凭据登录并控制TeamCity服务器。该漏洞的利用方式简单，危害巨大，已经被APT组织利用。POC代码本身看起来不包含任何恶意或投毒的代码，其目的是通过API创建一个具有管理员权限的用户。由于代码只是实现了利用公开漏洞的功能，并没有额外的恶意操作，因此投毒风险评估为0%。

**项目地址:** [whoamins/CVE-2023-42793](https://github.com/whoamins/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---



---

## POC #14

**来源**: [CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md](../2023/CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md)

## CVE-2023-42793-JetBrains TeamCity RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问 TeamCity 服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个认证绕过漏洞，未经身份验证的攻击者可以通过 HTTP(S) 访问 TeamCity 服务器来执行远程代码。根据提供的漏洞利用代码（CVE-2023-42793.yaml），利用方式如下：

1.  **删除和创建 API Token:** 首先，删除用户 ID 为 1 的名为“RPC2”的 token，然后再重新创建它。这是为了获得一个具有特定权限的有效 token。
2.  **启用 Debug 模式:** 使用获取的 token，通过修改 `config/internal.properties` 文件，启用 `rest.debug.processes.enable` 属性，从而开启调试进程。
3.  **执行命令:**  使用 API 接口 `/app/rest/debug/processes`，通过 `cmd.exe` (Windows) 或 `/bin/sh` (Linux) 执行任意命令（例如 `whoami`）。

**有效性分析:**

根据漏洞库信息，搜索结果以及提供的漏洞利用代码，可以确认该漏洞是真实存在的，并且已经被积极利用。该漏洞的CVSS评分为9.8，表明其具有很高的风险。提供的YAML代码是nuclei的漏洞扫描模版，经验证是可以有效利用此漏洞的。

**投毒风险分析:**

分析提供的 YAML 代码，并未发现任何恶意或后门性质的代码。该代码只是利用 TeamCity 存在的漏洞来执行预期的操作，即验证漏洞是否存在并执行命令。因此，投毒风险为0%。


**项目地址:** [syaifulandy/Nuclei-Template-CVE-2023-42793.yaml](https://github.com/syaifulandy/Nuclei-Template-CVE-2023-42793.yaml)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #15

**来源**: [CVE-2023-42793-syorik_CVE-2023-42793-poc.md](../2023/CVE-2023-42793-syorik_CVE-2023-42793-poc.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是JetBrains TeamCity中的一个身份验证绕过漏洞，攻击者可以在未经身份验证的情况下，通过利用REST API创建一个新的RPC令牌，然后使用该令牌启用调试模式，最终执行任意命令。根据提供的POC代码，利用过程如下：

1.  **身份验证绕过:**  POC代码首先尝试使用 `Authenticate` 函数通过 `userLocator` (例如 `id:1`) 创建一个名为 `RPC2` 的新的认证token。由于漏洞的存在，这步无需认证即可完成。
2.  **启用Debug模式:**  利用获得的认证token，POC代码尝试启用TeamCity服务器的Debug模式。通过POST请求修改`internal.properties`文件，设置`rest.debug.processes.enable=true`，从而允许执行任意进程。
3.  **命令执行:**  在启用Debug模式后，POC代码可以使用获得的认证token，调用`/app/rest/debug/processes`接口执行任意命令，并通过参数`exePath`指定要执行的命令和`params`参数传递命令参数。例如，POC中执行了 `ls -al` 命令。

**有效性评估：**
根据漏洞描述和POC代码，该漏洞利用链有效。POC 代码实现了利用该漏洞的完整流程。

**投毒风险评估：**
仔细检查提供的POC代码，没有发现任何作者隐藏的恶意代码或后门。该POC代码完全是为了利用CVE-2023-42793漏洞而设计的。它依赖于TeamCity服务器自身的漏洞来执行代码。

**利用方式总结：**
该漏洞利用方式是未授权的远程代码执行。利用REST API接口的身份验证绕过，允许未经身份验证的攻击者在TeamCity服务器上执行任意代码。攻击者首先绕过身份验证获取一个临时的token，然后通过这个token开启debug模式，最后通过debug模式的接口执行任意命令。

**项目地址:** [syorik/CVE-2023-42793-poc](https://github.com/syorik/CVE-2023-42793-poc)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #16

**来源**: [CVE-2023-42793-whoamins_CVE-2023-42793.md](../2023/CVE-2023-42793-whoamins_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains-TeamCity-身份验证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者执行远程代码。根据漏洞库信息和搜索结果，此漏洞已被积极利用，且利用代码已公开。POC代码通过TeamCity REST API创建管理员用户来利用此漏洞。首先，它尝试获取现有管理员（id:1）的会话token。然后，使用此token创建一个新的系统管理员用户，攻击者可以使用新创建的凭据登录并控制TeamCity服务器。该漏洞的利用方式简单，危害巨大，已经被APT组织利用。POC代码本身看起来不包含任何恶意或投毒的代码，其目的是通过API创建一个具有管理员权限的用户。由于代码只是实现了利用公开漏洞的功能，并没有额外的恶意操作，因此投毒风险评估为0%。

**项目地址:** [whoamins/CVE-2023-42793](https://github.com/whoamins/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---



---

## POC #14

**来源**: [CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md](../2023/CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md)

## CVE-2023-42793-JetBrains TeamCity RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问 TeamCity 服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个认证绕过漏洞，未经身份验证的攻击者可以通过 HTTP(S) 访问 TeamCity 服务器来执行远程代码。根据提供的漏洞利用代码（CVE-2023-42793.yaml），利用方式如下：

1.  **删除和创建 API Token:** 首先，删除用户 ID 为 1 的名为“RPC2”的 token，然后再重新创建它。这是为了获得一个具有特定权限的有效 token。
2.  **启用 Debug 模式:** 使用获取的 token，通过修改 `config/internal.properties` 文件，启用 `rest.debug.processes.enable` 属性，从而开启调试进程。
3.  **执行命令:**  使用 API 接口 `/app/rest/debug/processes`，通过 `cmd.exe` (Windows) 或 `/bin/sh` (Linux) 执行任意命令（例如 `whoami`）。

**有效性分析:**

根据漏洞库信息，搜索结果以及提供的漏洞利用代码，可以确认该漏洞是真实存在的，并且已经被积极利用。该漏洞的CVSS评分为9.8，表明其具有很高的风险。提供的YAML代码是nuclei的漏洞扫描模版，经验证是可以有效利用此漏洞的。

**投毒风险分析:**

分析提供的 YAML 代码，并未发现任何恶意或后门性质的代码。该代码只是利用 TeamCity 存在的漏洞来执行预期的操作，即验证漏洞是否存在并执行命令。因此，投毒风险为0%。


**项目地址:** [syaifulandy/Nuclei-Template-CVE-2023-42793.yaml](https://github.com/syaifulandy/Nuclei-Template-CVE-2023-42793.yaml)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #15

**来源**: [CVE-2023-42793-syorik_CVE-2023-42793-poc.md](../2023/CVE-2023-42793-syorik_CVE-2023-42793-poc.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是JetBrains TeamCity中的一个身份验证绕过漏洞，攻击者可以在未经身份验证的情况下，通过利用REST API创建一个新的RPC令牌，然后使用该令牌启用调试模式，最终执行任意命令。根据提供的POC代码，利用过程如下：

1.  **身份验证绕过:**  POC代码首先尝试使用 `Authenticate` 函数通过 `userLocator` (例如 `id:1`) 创建一个名为 `RPC2` 的新的认证token。由于漏洞的存在，这步无需认证即可完成。
2.  **启用Debug模式:**  利用获得的认证token，POC代码尝试启用TeamCity服务器的Debug模式。通过POST请求修改`internal.properties`文件，设置`rest.debug.processes.enable=true`，从而允许执行任意进程。
3.  **命令执行:**  在启用Debug模式后，POC代码可以使用获得的认证token，调用`/app/rest/debug/processes`接口执行任意命令，并通过参数`exePath`指定要执行的命令和`params`参数传递命令参数。例如，POC中执行了 `ls -al` 命令。

**有效性评估：**
根据漏洞描述和POC代码，该漏洞利用链有效。POC 代码实现了利用该漏洞的完整流程。

**投毒风险评估：**
仔细检查提供的POC代码，没有发现任何作者隐藏的恶意代码或后门。该POC代码完全是为了利用CVE-2023-42793漏洞而设计的。它依赖于TeamCity服务器自身的漏洞来执行代码。

**利用方式总结：**
该漏洞利用方式是未授权的远程代码执行。利用REST API接口的身份验证绕过，允许未经身份验证的攻击者在TeamCity服务器上执行任意代码。攻击者首先绕过身份验证获取一个临时的token，然后通过这个token开启debug模式，最后通过debug模式的接口执行任意命令。

**项目地址:** [syorik/CVE-2023-42793-poc](https://github.com/syorik/CVE-2023-42793-poc)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #16

**来源**: [CVE-2023-42793-whoamins_CVE-2023-42793.md](../2023/CVE-2023-42793-whoamins_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains-TeamCity-身份验证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者执行远程代码。根据漏洞库信息和搜索结果，此漏洞已被积极利用，且利用代码已公开。POC代码通过TeamCity REST API创建管理员用户来利用此漏洞。首先，它尝试获取现有管理员（id:1）的会话token。然后，使用此token创建一个新的系统管理员用户，攻击者可以使用新创建的凭据登录并控制TeamCity服务器。该漏洞的利用方式简单，危害巨大，已经被APT组织利用。POC代码本身看起来不包含任何恶意或投毒的代码，其目的是通过API创建一个具有管理员权限的用户。由于代码只是实现了利用公开漏洞的功能，并没有额外的恶意操作，因此投毒风险评估为0%。

**项目地址:** [whoamins/CVE-2023-42793](https://github.com/whoamins/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---



---

## POC #14

**来源**: [CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md](../2023/CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md)

## CVE-2023-42793-JetBrains TeamCity RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问 TeamCity 服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个认证绕过漏洞，未经身份验证的攻击者可以通过 HTTP(S) 访问 TeamCity 服务器来执行远程代码。根据提供的漏洞利用代码（CVE-2023-42793.yaml），利用方式如下：

1.  **删除和创建 API Token:** 首先，删除用户 ID 为 1 的名为“RPC2”的 token，然后再重新创建它。这是为了获得一个具有特定权限的有效 token。
2.  **启用 Debug 模式:** 使用获取的 token，通过修改 `config/internal.properties` 文件，启用 `rest.debug.processes.enable` 属性，从而开启调试进程。
3.  **执行命令:**  使用 API 接口 `/app/rest/debug/processes`，通过 `cmd.exe` (Windows) 或 `/bin/sh` (Linux) 执行任意命令（例如 `whoami`）。

**有效性分析:**

根据漏洞库信息，搜索结果以及提供的漏洞利用代码，可以确认该漏洞是真实存在的，并且已经被积极利用。该漏洞的CVSS评分为9.8，表明其具有很高的风险。提供的YAML代码是nuclei的漏洞扫描模版，经验证是可以有效利用此漏洞的。

**投毒风险分析:**

分析提供的 YAML 代码，并未发现任何恶意或后门性质的代码。该代码只是利用 TeamCity 存在的漏洞来执行预期的操作，即验证漏洞是否存在并执行命令。因此，投毒风险为0%。


**项目地址:** [syaifulandy/Nuclei-Template-CVE-2023-42793.yaml](https://github.com/syaifulandy/Nuclei-Template-CVE-2023-42793.yaml)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #15

**来源**: [CVE-2023-42793-syorik_CVE-2023-42793-poc.md](../2023/CVE-2023-42793-syorik_CVE-2023-42793-poc.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是JetBrains TeamCity中的一个身份验证绕过漏洞，攻击者可以在未经身份验证的情况下，通过利用REST API创建一个新的RPC令牌，然后使用该令牌启用调试模式，最终执行任意命令。根据提供的POC代码，利用过程如下：

1.  **身份验证绕过:**  POC代码首先尝试使用 `Authenticate` 函数通过 `userLocator` (例如 `id:1`) 创建一个名为 `RPC2` 的新的认证token。由于漏洞的存在，这步无需认证即可完成。
2.  **启用Debug模式:**  利用获得的认证token，POC代码尝试启用TeamCity服务器的Debug模式。通过POST请求修改`internal.properties`文件，设置`rest.debug.processes.enable=true`，从而允许执行任意进程。
3.  **命令执行:**  在启用Debug模式后，POC代码可以使用获得的认证token，调用`/app/rest/debug/processes`接口执行任意命令，并通过参数`exePath`指定要执行的命令和`params`参数传递命令参数。例如，POC中执行了 `ls -al` 命令。

**有效性评估：**
根据漏洞描述和POC代码，该漏洞利用链有效。POC 代码实现了利用该漏洞的完整流程。

**投毒风险评估：**
仔细检查提供的POC代码，没有发现任何作者隐藏的恶意代码或后门。该POC代码完全是为了利用CVE-2023-42793漏洞而设计的。它依赖于TeamCity服务器自身的漏洞来执行代码。

**利用方式总结：**
该漏洞利用方式是未授权的远程代码执行。利用REST API接口的身份验证绕过，允许未经身份验证的攻击者在TeamCity服务器上执行任意代码。攻击者首先绕过身份验证获取一个临时的token，然后通过这个token开启debug模式，最后通过debug模式的接口执行任意命令。

**项目地址:** [syorik/CVE-2023-42793-poc](https://github.com/syorik/CVE-2023-42793-poc)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #16

**来源**: [CVE-2023-42793-whoamins_CVE-2023-42793.md](../2023/CVE-2023-42793-whoamins_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains-TeamCity-身份验证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者执行远程代码。根据漏洞库信息和搜索结果，此漏洞已被积极利用，且利用代码已公开。POC代码通过TeamCity REST API创建管理员用户来利用此漏洞。首先，它尝试获取现有管理员（id:1）的会话token。然后，使用此token创建一个新的系统管理员用户，攻击者可以使用新创建的凭据登录并控制TeamCity服务器。该漏洞的利用方式简单，危害巨大，已经被APT组织利用。POC代码本身看起来不包含任何恶意或投毒的代码，其目的是通过API创建一个具有管理员权限的用户。由于代码只是实现了利用公开漏洞的功能，并没有额外的恶意操作，因此投毒风险评估为0%。

**项目地址:** [whoamins/CVE-2023-42793](https://github.com/whoamins/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---



---

## POC #14

**来源**: [CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md](../2023/CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md)

## CVE-2023-42793-JetBrains TeamCity RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问 TeamCity 服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个认证绕过漏洞，未经身份验证的攻击者可以通过 HTTP(S) 访问 TeamCity 服务器来执行远程代码。根据提供的漏洞利用代码（CVE-2023-42793.yaml），利用方式如下：

1.  **删除和创建 API Token:** 首先，删除用户 ID 为 1 的名为“RPC2”的 token，然后再重新创建它。这是为了获得一个具有特定权限的有效 token。
2.  **启用 Debug 模式:** 使用获取的 token，通过修改 `config/internal.properties` 文件，启用 `rest.debug.processes.enable` 属性，从而开启调试进程。
3.  **执行命令:**  使用 API 接口 `/app/rest/debug/processes`，通过 `cmd.exe` (Windows) 或 `/bin/sh` (Linux) 执行任意命令（例如 `whoami`）。

**有效性分析:**

根据漏洞库信息，搜索结果以及提供的漏洞利用代码，可以确认该漏洞是真实存在的，并且已经被积极利用。该漏洞的CVSS评分为9.8，表明其具有很高的风险。提供的YAML代码是nuclei的漏洞扫描模版，经验证是可以有效利用此漏洞的。

**投毒风险分析:**

分析提供的 YAML 代码，并未发现任何恶意或后门性质的代码。该代码只是利用 TeamCity 存在的漏洞来执行预期的操作，即验证漏洞是否存在并执行命令。因此，投毒风险为0%。


**项目地址:** [syaifulandy/Nuclei-Template-CVE-2023-42793.yaml](https://github.com/syaifulandy/Nuclei-Template-CVE-2023-42793.yaml)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #15

**来源**: [CVE-2023-42793-syorik_CVE-2023-42793-poc.md](../2023/CVE-2023-42793-syorik_CVE-2023-42793-poc.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是JetBrains TeamCity中的一个身份验证绕过漏洞，攻击者可以在未经身份验证的情况下，通过利用REST API创建一个新的RPC令牌，然后使用该令牌启用调试模式，最终执行任意命令。根据提供的POC代码，利用过程如下：

1.  **身份验证绕过:**  POC代码首先尝试使用 `Authenticate` 函数通过 `userLocator` (例如 `id:1`) 创建一个名为 `RPC2` 的新的认证token。由于漏洞的存在，这步无需认证即可完成。
2.  **启用Debug模式:**  利用获得的认证token，POC代码尝试启用TeamCity服务器的Debug模式。通过POST请求修改`internal.properties`文件，设置`rest.debug.processes.enable=true`，从而允许执行任意进程。
3.  **命令执行:**  在启用Debug模式后，POC代码可以使用获得的认证token，调用`/app/rest/debug/processes`接口执行任意命令，并通过参数`exePath`指定要执行的命令和`params`参数传递命令参数。例如，POC中执行了 `ls -al` 命令。

**有效性评估：**
根据漏洞描述和POC代码，该漏洞利用链有效。POC 代码实现了利用该漏洞的完整流程。

**投毒风险评估：**
仔细检查提供的POC代码，没有发现任何作者隐藏的恶意代码或后门。该POC代码完全是为了利用CVE-2023-42793漏洞而设计的。它依赖于TeamCity服务器自身的漏洞来执行代码。

**利用方式总结：**
该漏洞利用方式是未授权的远程代码执行。利用REST API接口的身份验证绕过，允许未经身份验证的攻击者在TeamCity服务器上执行任意代码。攻击者首先绕过身份验证获取一个临时的token，然后通过这个token开启debug模式，最后通过debug模式的接口执行任意命令。

**项目地址:** [syorik/CVE-2023-42793-poc](https://github.com/syorik/CVE-2023-42793-poc)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #16

**来源**: [CVE-2023-42793-whoamins_CVE-2023-42793.md](../2023/CVE-2023-42793-whoamins_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains-TeamCity-身份验证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者执行远程代码。根据漏洞库信息和搜索结果，此漏洞已被积极利用，且利用代码已公开。POC代码通过TeamCity REST API创建管理员用户来利用此漏洞。首先，它尝试获取现有管理员（id:1）的会话token。然后，使用此token创建一个新的系统管理员用户，攻击者可以使用新创建的凭据登录并控制TeamCity服务器。该漏洞的利用方式简单，危害巨大，已经被APT组织利用。POC代码本身看起来不包含任何恶意或投毒的代码，其目的是通过API创建一个具有管理员权限的用户。由于代码只是实现了利用公开漏洞的功能，并没有额外的恶意操作，因此投毒风险评估为0%。

**项目地址:** [whoamins/CVE-2023-42793](https://github.com/whoamins/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---



---

## POC #14

**来源**: [CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md](../2023/CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md)

## CVE-2023-42793-JetBrains TeamCity RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问 TeamCity 服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个认证绕过漏洞，未经身份验证的攻击者可以通过 HTTP(S) 访问 TeamCity 服务器来执行远程代码。根据提供的漏洞利用代码（CVE-2023-42793.yaml），利用方式如下：

1.  **删除和创建 API Token:** 首先，删除用户 ID 为 1 的名为“RPC2”的 token，然后再重新创建它。这是为了获得一个具有特定权限的有效 token。
2.  **启用 Debug 模式:** 使用获取的 token，通过修改 `config/internal.properties` 文件，启用 `rest.debug.processes.enable` 属性，从而开启调试进程。
3.  **执行命令:**  使用 API 接口 `/app/rest/debug/processes`，通过 `cmd.exe` (Windows) 或 `/bin/sh` (Linux) 执行任意命令（例如 `whoami`）。

**有效性分析:**

根据漏洞库信息，搜索结果以及提供的漏洞利用代码，可以确认该漏洞是真实存在的，并且已经被积极利用。该漏洞的CVSS评分为9.8，表明其具有很高的风险。提供的YAML代码是nuclei的漏洞扫描模版，经验证是可以有效利用此漏洞的。

**投毒风险分析:**

分析提供的 YAML 代码，并未发现任何恶意或后门性质的代码。该代码只是利用 TeamCity 存在的漏洞来执行预期的操作，即验证漏洞是否存在并执行命令。因此，投毒风险为0%。


**项目地址:** [syaifulandy/Nuclei-Template-CVE-2023-42793.yaml](https://github.com/syaifulandy/Nuclei-Template-CVE-2023-42793.yaml)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #15

**来源**: [CVE-2023-42793-syorik_CVE-2023-42793-poc.md](../2023/CVE-2023-42793-syorik_CVE-2023-42793-poc.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是JetBrains TeamCity中的一个身份验证绕过漏洞，攻击者可以在未经身份验证的情况下，通过利用REST API创建一个新的RPC令牌，然后使用该令牌启用调试模式，最终执行任意命令。根据提供的POC代码，利用过程如下：

1.  **身份验证绕过:**  POC代码首先尝试使用 `Authenticate` 函数通过 `userLocator` (例如 `id:1`) 创建一个名为 `RPC2` 的新的认证token。由于漏洞的存在，这步无需认证即可完成。
2.  **启用Debug模式:**  利用获得的认证token，POC代码尝试启用TeamCity服务器的Debug模式。通过POST请求修改`internal.properties`文件，设置`rest.debug.processes.enable=true`，从而允许执行任意进程。
3.  **命令执行:**  在启用Debug模式后，POC代码可以使用获得的认证token，调用`/app/rest/debug/processes`接口执行任意命令，并通过参数`exePath`指定要执行的命令和`params`参数传递命令参数。例如，POC中执行了 `ls -al` 命令。

**有效性评估：**
根据漏洞描述和POC代码，该漏洞利用链有效。POC 代码实现了利用该漏洞的完整流程。

**投毒风险评估：**
仔细检查提供的POC代码，没有发现任何作者隐藏的恶意代码或后门。该POC代码完全是为了利用CVE-2023-42793漏洞而设计的。它依赖于TeamCity服务器自身的漏洞来执行代码。

**利用方式总结：**
该漏洞利用方式是未授权的远程代码执行。利用REST API接口的身份验证绕过，允许未经身份验证的攻击者在TeamCity服务器上执行任意代码。攻击者首先绕过身份验证获取一个临时的token，然后通过这个token开启debug模式，最后通过debug模式的接口执行任意命令。

**项目地址:** [syorik/CVE-2023-42793-poc](https://github.com/syorik/CVE-2023-42793-poc)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #16

**来源**: [CVE-2023-42793-whoamins_CVE-2023-42793.md](../2023/CVE-2023-42793-whoamins_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains-TeamCity-身份验证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者执行远程代码。根据漏洞库信息和搜索结果，此漏洞已被积极利用，且利用代码已公开。POC代码通过TeamCity REST API创建管理员用户来利用此漏洞。首先，它尝试获取现有管理员（id:1）的会话token。然后，使用此token创建一个新的系统管理员用户，攻击者可以使用新创建的凭据登录并控制TeamCity服务器。该漏洞的利用方式简单，危害巨大，已经被APT组织利用。POC代码本身看起来不包含任何恶意或投毒的代码，其目的是通过API创建一个具有管理员权限的用户。由于代码只是实现了利用公开漏洞的功能，并没有额外的恶意操作，因此投毒风险评估为0%。

**项目地址:** [whoamins/CVE-2023-42793](https://github.com/whoamins/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---



---

## POC #14

**来源**: [CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md](../2023/CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md)

## CVE-2023-42793-JetBrains TeamCity RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问 TeamCity 服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个认证绕过漏洞，未经身份验证的攻击者可以通过 HTTP(S) 访问 TeamCity 服务器来执行远程代码。根据提供的漏洞利用代码（CVE-2023-42793.yaml），利用方式如下：

1.  **删除和创建 API Token:** 首先，删除用户 ID 为 1 的名为“RPC2”的 token，然后再重新创建它。这是为了获得一个具有特定权限的有效 token。
2.  **启用 Debug 模式:** 使用获取的 token，通过修改 `config/internal.properties` 文件，启用 `rest.debug.processes.enable` 属性，从而开启调试进程。
3.  **执行命令:**  使用 API 接口 `/app/rest/debug/processes`，通过 `cmd.exe` (Windows) 或 `/bin/sh` (Linux) 执行任意命令（例如 `whoami`）。

**有效性分析:**

根据漏洞库信息，搜索结果以及提供的漏洞利用代码，可以确认该漏洞是真实存在的，并且已经被积极利用。该漏洞的CVSS评分为9.8，表明其具有很高的风险。提供的YAML代码是nuclei的漏洞扫描模版，经验证是可以有效利用此漏洞的。

**投毒风险分析:**

分析提供的 YAML 代码，并未发现任何恶意或后门性质的代码。该代码只是利用 TeamCity 存在的漏洞来执行预期的操作，即验证漏洞是否存在并执行命令。因此，投毒风险为0%。


**项目地址:** [syaifulandy/Nuclei-Template-CVE-2023-42793.yaml](https://github.com/syaifulandy/Nuclei-Template-CVE-2023-42793.yaml)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #15

**来源**: [CVE-2023-42793-syorik_CVE-2023-42793-poc.md](../2023/CVE-2023-42793-syorik_CVE-2023-42793-poc.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是JetBrains TeamCity中的一个身份验证绕过漏洞，攻击者可以在未经身份验证的情况下，通过利用REST API创建一个新的RPC令牌，然后使用该令牌启用调试模式，最终执行任意命令。根据提供的POC代码，利用过程如下：

1.  **身份验证绕过:**  POC代码首先尝试使用 `Authenticate` 函数通过 `userLocator` (例如 `id:1`) 创建一个名为 `RPC2` 的新的认证token。由于漏洞的存在，这步无需认证即可完成。
2.  **启用Debug模式:**  利用获得的认证token，POC代码尝试启用TeamCity服务器的Debug模式。通过POST请求修改`internal.properties`文件，设置`rest.debug.processes.enable=true`，从而允许执行任意进程。
3.  **命令执行:**  在启用Debug模式后，POC代码可以使用获得的认证token，调用`/app/rest/debug/processes`接口执行任意命令，并通过参数`exePath`指定要执行的命令和`params`参数传递命令参数。例如，POC中执行了 `ls -al` 命令。

**有效性评估：**
根据漏洞描述和POC代码，该漏洞利用链有效。POC 代码实现了利用该漏洞的完整流程。

**投毒风险评估：**
仔细检查提供的POC代码，没有发现任何作者隐藏的恶意代码或后门。该POC代码完全是为了利用CVE-2023-42793漏洞而设计的。它依赖于TeamCity服务器自身的漏洞来执行代码。

**利用方式总结：**
该漏洞利用方式是未授权的远程代码执行。利用REST API接口的身份验证绕过，允许未经身份验证的攻击者在TeamCity服务器上执行任意代码。攻击者首先绕过身份验证获取一个临时的token，然后通过这个token开启debug模式，最后通过debug模式的接口执行任意命令。

**项目地址:** [syorik/CVE-2023-42793-poc](https://github.com/syorik/CVE-2023-42793-poc)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #16

**来源**: [CVE-2023-42793-whoamins_CVE-2023-42793.md](../2023/CVE-2023-42793-whoamins_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains-TeamCity-身份验证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者执行远程代码。根据漏洞库信息和搜索结果，此漏洞已被积极利用，且利用代码已公开。POC代码通过TeamCity REST API创建管理员用户来利用此漏洞。首先，它尝试获取现有管理员（id:1）的会话token。然后，使用此token创建一个新的系统管理员用户，攻击者可以使用新创建的凭据登录并控制TeamCity服务器。该漏洞的利用方式简单，危害巨大，已经被APT组织利用。POC代码本身看起来不包含任何恶意或投毒的代码，其目的是通过API创建一个具有管理员权限的用户。由于代码只是实现了利用公开漏洞的功能，并没有额外的恶意操作，因此投毒风险评估为0%。

**项目地址:** [whoamins/CVE-2023-42793](https://github.com/whoamins/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---



---

## POC #14

**来源**: [CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md](../2023/CVE-2023-42793-syaifulandy_Nuclei-Template-CVE-2023-42793.yaml.md)

## CVE-2023-42793-JetBrains TeamCity RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问 TeamCity 服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个认证绕过漏洞，未经身份验证的攻击者可以通过 HTTP(S) 访问 TeamCity 服务器来执行远程代码。根据提供的漏洞利用代码（CVE-2023-42793.yaml），利用方式如下：

1.  **删除和创建 API Token:** 首先，删除用户 ID 为 1 的名为“RPC2”的 token，然后再重新创建它。这是为了获得一个具有特定权限的有效 token。
2.  **启用 Debug 模式:** 使用获取的 token，通过修改 `config/internal.properties` 文件，启用 `rest.debug.processes.enable` 属性，从而开启调试进程。
3.  **执行命令:**  使用 API 接口 `/app/rest/debug/processes`，通过 `cmd.exe` (Windows) 或 `/bin/sh` (Linux) 执行任意命令（例如 `whoami`）。

**有效性分析:**

根据漏洞库信息，搜索结果以及提供的漏洞利用代码，可以确认该漏洞是真实存在的，并且已经被积极利用。该漏洞的CVSS评分为9.8，表明其具有很高的风险。提供的YAML代码是nuclei的漏洞扫描模版，经验证是可以有效利用此漏洞的。

**投毒风险分析:**

分析提供的 YAML 代码，并未发现任何恶意或后门性质的代码。该代码只是利用 TeamCity 存在的漏洞来执行预期的操作，即验证漏洞是否存在并执行命令。因此，投毒风险为0%。


**项目地址:** [syaifulandy/Nuclei-Template-CVE-2023-42793.yaml](https://github.com/syaifulandy/Nuclei-Template-CVE-2023-42793.yaml)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #15

**来源**: [CVE-2023-42793-syorik_CVE-2023-42793-poc.md](../2023/CVE-2023-42793-syorik_CVE-2023-42793-poc.md)

## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是JetBrains TeamCity中的一个身份验证绕过漏洞，攻击者可以在未经身份验证的情况下，通过利用REST API创建一个新的RPC令牌，然后使用该令牌启用调试模式，最终执行任意命令。根据提供的POC代码，利用过程如下：

1.  **身份验证绕过:**  POC代码首先尝试使用 `Authenticate` 函数通过 `userLocator` (例如 `id:1`) 创建一个名为 `RPC2` 的新的认证token。由于漏洞的存在，这步无需认证即可完成。
2.  **启用Debug模式:**  利用获得的认证token，POC代码尝试启用TeamCity服务器的Debug模式。通过POST请求修改`internal.properties`文件，设置`rest.debug.processes.enable=true`，从而允许执行任意进程。
3.  **命令执行:**  在启用Debug模式后，POC代码可以使用获得的认证token，调用`/app/rest/debug/processes`接口执行任意命令，并通过参数`exePath`指定要执行的命令和`params`参数传递命令参数。例如，POC中执行了 `ls -al` 命令。

**有效性评估：**
根据漏洞描述和POC代码，该漏洞利用链有效。POC 代码实现了利用该漏洞的完整流程。

**投毒风险评估：**
仔细检查提供的POC代码，没有发现任何作者隐藏的恶意代码或后门。该POC代码完全是为了利用CVE-2023-42793漏洞而设计的。它依赖于TeamCity服务器自身的漏洞来执行代码。

**利用方式总结：**
该漏洞利用方式是未授权的远程代码执行。利用REST API接口的身份验证绕过，允许未经身份验证的攻击者在TeamCity服务器上执行任意代码。攻击者首先绕过身份验证获取一个临时的token，然后通过这个token开启debug模式，最后通过debug模式的接口执行任意命令。

**项目地址:** [syorik/CVE-2023-42793-poc](https://github.com/syorik/CVE-2023-42793-poc)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

## POC #16

**来源**: [CVE-2023-42793-whoamins_CVE-2023-42793.md](../2023/CVE-2023-42793-whoamins_CVE-2023-42793.md)

## CVE-2023-42793-JetBrains-TeamCity-身份验证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过RCE

**影响应用:** JetBrains TeamCity

**危害等级:** 严重，未授权远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者执行远程代码。根据漏洞库信息和搜索结果，此漏洞已被积极利用，且利用代码已公开。POC代码通过TeamCity REST API创建管理员用户来利用此漏洞。首先，它尝试获取现有管理员（id:1）的会话token。然后，使用此token创建一个新的系统管理员用户，攻击者可以使用新创建的凭据登录并控制TeamCity服务器。该漏洞的利用方式简单，危害巨大，已经被APT组织利用。POC代码本身看起来不包含任何恶意或投毒的代码，其目的是通过API创建一个具有管理员权限的用户。由于代码只是实现了利用公开漏洞的功能，并没有额外的恶意操作，因此投毒风险评估为0%。

**项目地址:** [whoamins/CVE-2023-42793](https://github.com/whoamins/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)

---

