# CVE-2023-21554

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-21554-3tternp_CVE-2023-21554.md](../2023/CVE-2023-21554-3tternp_CVE-2023-21554.md)

## CVE-2023-21554-Microsoft Message Queuing (MSMQ) 远程代码执行漏洞

**漏洞编号:** CVE-2023-21554

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Message Queuing (MSMQ)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响的Windows版本，具体版本范围参考CVE描述

**利用条件:** 目标系统开启MSMQ服务 (端口1801)，攻击者需要能够与目标端口建立TCP连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据提供的漏洞信息，CVE-2023-21554是Microsoft Message Queuing (MSMQ)服务中的一个远程代码执行漏洞。攻击者可以通过发送特制的恶意消息到MSMQ服务，从而在目标系统上执行任意代码。

**有效性评估：**
提供的POC代码的README描述，PoC成功运行的标志是`mqsvc.exe`进程崩溃。 代码通过python脚本，向目标MSMQ服务器的1801端口发送一系列数据包，包括建立连接的数据包(`establish_connection.bin`)、连接参数数据包(`connection_parameters.bin`) 和用户消息数据包(`user_message.bin`)。 根据描述以及代码逻辑，可以初步判断POC的目的是触发`mqsvc.exe` 服务的崩溃，验证漏洞的存在。

**投毒风险评估：**
代码从本地文件读取payload，并发送给目标，因此如果攻击者修改`.\data\`下的二进制文件，就可以修改payload。`poc.py`中`data[0x5e] = i`和`data[0x5f] = 0xff`被注释掉了，这表明原作者可能尝试过修改`user_message.bin`中的特定字节，但最终没有采用。投毒的风险在于，攻击者可以修改这些二进制文件来执行恶意代码，但目前看来，此仓库的投毒风险较小。因为POC本身依赖于特定二进制文件的内容来触发漏洞，如果攻击者随意修改这些文件，可能导致POC失效而不是植入后门。但是Payload文件是二进制，存在被植入后门的风险，故风险值设定为10%。

**利用方式：**
1.  攻击者扫描目标系统，发现开启了MSMQ服务(1801端口)。
2.  攻击者运行POC脚本`poc.py`，输入目标系统的IP地址。
3.  POC脚本会按照预定的顺序，将一系列二进制数据包（`establish_connection.bin`、`connection_parameters.bin`、`user_message.bin`）发送到目标系统的1801端口。
4.  如果目标系统存在CVE-2023-21554漏洞，并且payload构造得当，则MSMQ服务进程`mqsvc.exe`会崩溃。成功利用该漏洞可以执行任意代码，从而完全控制目标系统。

**项目地址:** [3tternp/CVE-2023-21554](https://github.com/3tternp/CVE-2023-21554)

**漏洞详情:** [CVE-2023-21554](https://nvd.nist.gov/vuln/detail/CVE-2023-21554)

---

## POC #2

**来源**: [CVE-2023-21554-Rahul-Thakur7_CVE-2023-21554.md](../2023/CVE-2023-21554-Rahul-Thakur7_CVE-2023-21554.md)

# CVE-2023-21554

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-21554-3tternp_CVE-2023-21554.md](../2023/CVE-2023-21554-3tternp_CVE-2023-21554.md)

## CVE-2023-21554-Microsoft Message Queuing (MSMQ) 远程代码执行漏洞

**漏洞编号:** CVE-2023-21554

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Message Queuing (MSMQ)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响的Windows版本，具体版本范围参考CVE描述

**利用条件:** 目标系统开启MSMQ服务 (端口1801)，攻击者需要能够与目标端口建立TCP连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据提供的漏洞信息，CVE-2023-21554是Microsoft Message Queuing (MSMQ)服务中的一个远程代码执行漏洞。攻击者可以通过发送特制的恶意消息到MSMQ服务，从而在目标系统上执行任意代码。

**有效性评估：**
提供的POC代码的README描述，PoC成功运行的标志是`mqsvc.exe`进程崩溃。 代码通过python脚本，向目标MSMQ服务器的1801端口发送一系列数据包，包括建立连接的数据包(`establish_connection.bin`)、连接参数数据包(`connection_parameters.bin`) 和用户消息数据包(`user_message.bin`)。 根据描述以及代码逻辑，可以初步判断POC的目的是触发`mqsvc.exe` 服务的崩溃，验证漏洞的存在。

**投毒风险评估：**
代码从本地文件读取payload，并发送给目标，因此如果攻击者修改`.\data\`下的二进制文件，就可以修改payload。`poc.py`中`data[0x5e] = i`和`data[0x5f] = 0xff`被注释掉了，这表明原作者可能尝试过修改`user_message.bin`中的特定字节，但最终没有采用。投毒的风险在于，攻击者可以修改这些二进制文件来执行恶意代码，但目前看来，此仓库的投毒风险较小。因为POC本身依赖于特定二进制文件的内容来触发漏洞，如果攻击者随意修改这些文件，可能导致POC失效而不是植入后门。但是Payload文件是二进制，存在被植入后门的风险，故风险值设定为10%。

**利用方式：**
1.  攻击者扫描目标系统，发现开启了MSMQ服务(1801端口)。
2.  攻击者运行POC脚本`poc.py`，输入目标系统的IP地址。
3.  POC脚本会按照预定的顺序，将一系列二进制数据包（`establish_connection.bin`、`connection_parameters.bin`、`user_message.bin`）发送到目标系统的1801端口。
4.  如果目标系统存在CVE-2023-21554漏洞，并且payload构造得当，则MSMQ服务进程`mqsvc.exe`会崩溃。成功利用该漏洞可以执行任意代码，从而完全控制目标系统。

**项目地址:** [3tternp/CVE-2023-21554](https://github.com/3tternp/CVE-2023-21554)

**漏洞详情:** [CVE-2023-21554](https://nvd.nist.gov/vuln/detail/CVE-2023-21554)

---

## POC #2

**来源**: [CVE-2023-21554-Rahul-Thakur7_CVE-2023-21554.md](../2023/CVE-2023-21554-Rahul-Thakur7_CVE-2023-21554.md)

# CVE-2023-21554

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-21554-3tternp_CVE-2023-21554.md](../2023/CVE-2023-21554-3tternp_CVE-2023-21554.md)

## CVE-2023-21554-Microsoft Message Queuing (MSMQ) 远程代码执行漏洞

**漏洞编号:** CVE-2023-21554

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Message Queuing (MSMQ)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响的Windows版本，具体版本范围参考CVE描述

**利用条件:** 目标系统开启MSMQ服务 (端口1801)，攻击者需要能够与目标端口建立TCP连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据提供的漏洞信息，CVE-2023-21554是Microsoft Message Queuing (MSMQ)服务中的一个远程代码执行漏洞。攻击者可以通过发送特制的恶意消息到MSMQ服务，从而在目标系统上执行任意代码。

**有效性评估：**
提供的POC代码的README描述，PoC成功运行的标志是`mqsvc.exe`进程崩溃。 代码通过python脚本，向目标MSMQ服务器的1801端口发送一系列数据包，包括建立连接的数据包(`establish_connection.bin`)、连接参数数据包(`connection_parameters.bin`) 和用户消息数据包(`user_message.bin`)。 根据描述以及代码逻辑，可以初步判断POC的目的是触发`mqsvc.exe` 服务的崩溃，验证漏洞的存在。

**投毒风险评估：**
代码从本地文件读取payload，并发送给目标，因此如果攻击者修改`.\data\`下的二进制文件，就可以修改payload。`poc.py`中`data[0x5e] = i`和`data[0x5f] = 0xff`被注释掉了，这表明原作者可能尝试过修改`user_message.bin`中的特定字节，但最终没有采用。投毒的风险在于，攻击者可以修改这些二进制文件来执行恶意代码，但目前看来，此仓库的投毒风险较小。因为POC本身依赖于特定二进制文件的内容来触发漏洞，如果攻击者随意修改这些文件，可能导致POC失效而不是植入后门。但是Payload文件是二进制，存在被植入后门的风险，故风险值设定为10%。

**利用方式：**
1.  攻击者扫描目标系统，发现开启了MSMQ服务(1801端口)。
2.  攻击者运行POC脚本`poc.py`，输入目标系统的IP地址。
3.  POC脚本会按照预定的顺序，将一系列二进制数据包（`establish_connection.bin`、`connection_parameters.bin`、`user_message.bin`）发送到目标系统的1801端口。
4.  如果目标系统存在CVE-2023-21554漏洞，并且payload构造得当，则MSMQ服务进程`mqsvc.exe`会崩溃。成功利用该漏洞可以执行任意代码，从而完全控制目标系统。

**项目地址:** [3tternp/CVE-2023-21554](https://github.com/3tternp/CVE-2023-21554)

**漏洞详情:** [CVE-2023-21554](https://nvd.nist.gov/vuln/detail/CVE-2023-21554)

---

## POC #2

**来源**: [CVE-2023-21554-Rahul-Thakur7_CVE-2023-21554.md](../2023/CVE-2023-21554-Rahul-Thakur7_CVE-2023-21554.md)

# CVE-2023-21554

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-21554-3tternp_CVE-2023-21554.md](../2023/CVE-2023-21554-3tternp_CVE-2023-21554.md)

## CVE-2023-21554-Microsoft Message Queuing (MSMQ) 远程代码执行漏洞

**漏洞编号:** CVE-2023-21554

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Message Queuing (MSMQ)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响的Windows版本，具体版本范围参考CVE描述

**利用条件:** 目标系统开启MSMQ服务 (端口1801)，攻击者需要能够与目标端口建立TCP连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据提供的漏洞信息，CVE-2023-21554是Microsoft Message Queuing (MSMQ)服务中的一个远程代码执行漏洞。攻击者可以通过发送特制的恶意消息到MSMQ服务，从而在目标系统上执行任意代码。

**有效性评估：**
提供的POC代码的README描述，PoC成功运行的标志是`mqsvc.exe`进程崩溃。 代码通过python脚本，向目标MSMQ服务器的1801端口发送一系列数据包，包括建立连接的数据包(`establish_connection.bin`)、连接参数数据包(`connection_parameters.bin`) 和用户消息数据包(`user_message.bin`)。 根据描述以及代码逻辑，可以初步判断POC的目的是触发`mqsvc.exe` 服务的崩溃，验证漏洞的存在。

**投毒风险评估：**
代码从本地文件读取payload，并发送给目标，因此如果攻击者修改`.\data\`下的二进制文件，就可以修改payload。`poc.py`中`data[0x5e] = i`和`data[0x5f] = 0xff`被注释掉了，这表明原作者可能尝试过修改`user_message.bin`中的特定字节，但最终没有采用。投毒的风险在于，攻击者可以修改这些二进制文件来执行恶意代码，但目前看来，此仓库的投毒风险较小。因为POC本身依赖于特定二进制文件的内容来触发漏洞，如果攻击者随意修改这些文件，可能导致POC失效而不是植入后门。但是Payload文件是二进制，存在被植入后门的风险，故风险值设定为10%。

**利用方式：**
1.  攻击者扫描目标系统，发现开启了MSMQ服务(1801端口)。
2.  攻击者运行POC脚本`poc.py`，输入目标系统的IP地址。
3.  POC脚本会按照预定的顺序，将一系列二进制数据包（`establish_connection.bin`、`connection_parameters.bin`、`user_message.bin`）发送到目标系统的1801端口。
4.  如果目标系统存在CVE-2023-21554漏洞，并且payload构造得当，则MSMQ服务进程`mqsvc.exe`会崩溃。成功利用该漏洞可以执行任意代码，从而完全控制目标系统。

**项目地址:** [3tternp/CVE-2023-21554](https://github.com/3tternp/CVE-2023-21554)

**漏洞详情:** [CVE-2023-21554](https://nvd.nist.gov/vuln/detail/CVE-2023-21554)

---

## POC #2

**来源**: [CVE-2023-21554-Rahul-Thakur7_CVE-2023-21554.md](../2023/CVE-2023-21554-Rahul-Thakur7_CVE-2023-21554.md)

# CVE-2023-21554

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-21554-3tternp_CVE-2023-21554.md](../2023/CVE-2023-21554-3tternp_CVE-2023-21554.md)

## CVE-2023-21554-Microsoft Message Queuing (MSMQ) 远程代码执行漏洞

**漏洞编号:** CVE-2023-21554

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Message Queuing (MSMQ)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响的Windows版本，具体版本范围参考CVE描述

**利用条件:** 目标系统开启MSMQ服务 (端口1801)，攻击者需要能够与目标端口建立TCP连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据提供的漏洞信息，CVE-2023-21554是Microsoft Message Queuing (MSMQ)服务中的一个远程代码执行漏洞。攻击者可以通过发送特制的恶意消息到MSMQ服务，从而在目标系统上执行任意代码。

**有效性评估：**
提供的POC代码的README描述，PoC成功运行的标志是`mqsvc.exe`进程崩溃。 代码通过python脚本，向目标MSMQ服务器的1801端口发送一系列数据包，包括建立连接的数据包(`establish_connection.bin`)、连接参数数据包(`connection_parameters.bin`) 和用户消息数据包(`user_message.bin`)。 根据描述以及代码逻辑，可以初步判断POC的目的是触发`mqsvc.exe` 服务的崩溃，验证漏洞的存在。

**投毒风险评估：**
代码从本地文件读取payload，并发送给目标，因此如果攻击者修改`.\data\`下的二进制文件，就可以修改payload。`poc.py`中`data[0x5e] = i`和`data[0x5f] = 0xff`被注释掉了，这表明原作者可能尝试过修改`user_message.bin`中的特定字节，但最终没有采用。投毒的风险在于，攻击者可以修改这些二进制文件来执行恶意代码，但目前看来，此仓库的投毒风险较小。因为POC本身依赖于特定二进制文件的内容来触发漏洞，如果攻击者随意修改这些文件，可能导致POC失效而不是植入后门。但是Payload文件是二进制，存在被植入后门的风险，故风险值设定为10%。

**利用方式：**
1.  攻击者扫描目标系统，发现开启了MSMQ服务(1801端口)。
2.  攻击者运行POC脚本`poc.py`，输入目标系统的IP地址。
3.  POC脚本会按照预定的顺序，将一系列二进制数据包（`establish_connection.bin`、`connection_parameters.bin`、`user_message.bin`）发送到目标系统的1801端口。
4.  如果目标系统存在CVE-2023-21554漏洞，并且payload构造得当，则MSMQ服务进程`mqsvc.exe`会崩溃。成功利用该漏洞可以执行任意代码，从而完全控制目标系统。

**项目地址:** [3tternp/CVE-2023-21554](https://github.com/3tternp/CVE-2023-21554)

**漏洞详情:** [CVE-2023-21554](https://nvd.nist.gov/vuln/detail/CVE-2023-21554)

---

## POC #2

**来源**: [CVE-2023-21554-Rahul-Thakur7_CVE-2023-21554.md](../2023/CVE-2023-21554-Rahul-Thakur7_CVE-2023-21554.md)

# CVE-2023-21554

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-21554-3tternp_CVE-2023-21554.md](../2023/CVE-2023-21554-3tternp_CVE-2023-21554.md)

## CVE-2023-21554-Microsoft Message Queuing (MSMQ) 远程代码执行漏洞

**漏洞编号:** CVE-2023-21554

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Message Queuing (MSMQ)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响的Windows版本，具体版本范围参考CVE描述

**利用条件:** 目标系统开启MSMQ服务 (端口1801)，攻击者需要能够与目标端口建立TCP连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据提供的漏洞信息，CVE-2023-21554是Microsoft Message Queuing (MSMQ)服务中的一个远程代码执行漏洞。攻击者可以通过发送特制的恶意消息到MSMQ服务，从而在目标系统上执行任意代码。

**有效性评估：**
提供的POC代码的README描述，PoC成功运行的标志是`mqsvc.exe`进程崩溃。 代码通过python脚本，向目标MSMQ服务器的1801端口发送一系列数据包，包括建立连接的数据包(`establish_connection.bin`)、连接参数数据包(`connection_parameters.bin`) 和用户消息数据包(`user_message.bin`)。 根据描述以及代码逻辑，可以初步判断POC的目的是触发`mqsvc.exe` 服务的崩溃，验证漏洞的存在。

**投毒风险评估：**
代码从本地文件读取payload，并发送给目标，因此如果攻击者修改`.\data\`下的二进制文件，就可以修改payload。`poc.py`中`data[0x5e] = i`和`data[0x5f] = 0xff`被注释掉了，这表明原作者可能尝试过修改`user_message.bin`中的特定字节，但最终没有采用。投毒的风险在于，攻击者可以修改这些二进制文件来执行恶意代码，但目前看来，此仓库的投毒风险较小。因为POC本身依赖于特定二进制文件的内容来触发漏洞，如果攻击者随意修改这些文件，可能导致POC失效而不是植入后门。但是Payload文件是二进制，存在被植入后门的风险，故风险值设定为10%。

**利用方式：**
1.  攻击者扫描目标系统，发现开启了MSMQ服务(1801端口)。
2.  攻击者运行POC脚本`poc.py`，输入目标系统的IP地址。
3.  POC脚本会按照预定的顺序，将一系列二进制数据包（`establish_connection.bin`、`connection_parameters.bin`、`user_message.bin`）发送到目标系统的1801端口。
4.  如果目标系统存在CVE-2023-21554漏洞，并且payload构造得当，则MSMQ服务进程`mqsvc.exe`会崩溃。成功利用该漏洞可以执行任意代码，从而完全控制目标系统。

**项目地址:** [3tternp/CVE-2023-21554](https://github.com/3tternp/CVE-2023-21554)

**漏洞详情:** [CVE-2023-21554](https://nvd.nist.gov/vuln/detail/CVE-2023-21554)

---

## POC #2

**来源**: [CVE-2023-21554-Rahul-Thakur7_CVE-2023-21554.md](../2023/CVE-2023-21554-Rahul-Thakur7_CVE-2023-21554.md)

# CVE-2023-21554

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-21554-3tternp_CVE-2023-21554.md](../2023/CVE-2023-21554-3tternp_CVE-2023-21554.md)

## CVE-2023-21554-Microsoft Message Queuing (MSMQ) 远程代码执行漏洞

**漏洞编号:** CVE-2023-21554

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Message Queuing (MSMQ)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响的Windows版本，具体版本范围参考CVE描述

**利用条件:** 目标系统开启MSMQ服务 (端口1801)，攻击者需要能够与目标端口建立TCP连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据提供的漏洞信息，CVE-2023-21554是Microsoft Message Queuing (MSMQ)服务中的一个远程代码执行漏洞。攻击者可以通过发送特制的恶意消息到MSMQ服务，从而在目标系统上执行任意代码。

**有效性评估：**
提供的POC代码的README描述，PoC成功运行的标志是`mqsvc.exe`进程崩溃。 代码通过python脚本，向目标MSMQ服务器的1801端口发送一系列数据包，包括建立连接的数据包(`establish_connection.bin`)、连接参数数据包(`connection_parameters.bin`) 和用户消息数据包(`user_message.bin`)。 根据描述以及代码逻辑，可以初步判断POC的目的是触发`mqsvc.exe` 服务的崩溃，验证漏洞的存在。

**投毒风险评估：**
代码从本地文件读取payload，并发送给目标，因此如果攻击者修改`.\data\`下的二进制文件，就可以修改payload。`poc.py`中`data[0x5e] = i`和`data[0x5f] = 0xff`被注释掉了，这表明原作者可能尝试过修改`user_message.bin`中的特定字节，但最终没有采用。投毒的风险在于，攻击者可以修改这些二进制文件来执行恶意代码，但目前看来，此仓库的投毒风险较小。因为POC本身依赖于特定二进制文件的内容来触发漏洞，如果攻击者随意修改这些文件，可能导致POC失效而不是植入后门。但是Payload文件是二进制，存在被植入后门的风险，故风险值设定为10%。

**利用方式：**
1.  攻击者扫描目标系统，发现开启了MSMQ服务(1801端口)。
2.  攻击者运行POC脚本`poc.py`，输入目标系统的IP地址。
3.  POC脚本会按照预定的顺序，将一系列二进制数据包（`establish_connection.bin`、`connection_parameters.bin`、`user_message.bin`）发送到目标系统的1801端口。
4.  如果目标系统存在CVE-2023-21554漏洞，并且payload构造得当，则MSMQ服务进程`mqsvc.exe`会崩溃。成功利用该漏洞可以执行任意代码，从而完全控制目标系统。

**项目地址:** [3tternp/CVE-2023-21554](https://github.com/3tternp/CVE-2023-21554)

**漏洞详情:** [CVE-2023-21554](https://nvd.nist.gov/vuln/detail/CVE-2023-21554)

---

## POC #2

**来源**: [CVE-2023-21554-Rahul-Thakur7_CVE-2023-21554.md](../2023/CVE-2023-21554-Rahul-Thakur7_CVE-2023-21554.md)

## CVE-2023-21554-Microsoft Message Queuing (MSMQ) 远程代码执行漏洞

**漏洞编号:** CVE-2023-21554

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Message Queuing (MSMQ)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本范围广泛，具体参见漏洞库信息

**利用条件:** 目标系统需要启用MSMQ服务并且攻击者能够通过网络访问MSMQ服务端口（默认1801）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-21554 是一个 Microsoft Message Queuing (MSMQ) 远程代码执行漏洞。攻击者可以通过向 MSMQ 服务发送特制的恶意消息来触发此漏洞，从而在目标系统上执行任意代码。

**有效性：**
提供的POC代码看起来有效。它模拟了MSMQ协议的交互过程，包括建立连接、发送连接参数、用户消息和会话确认。代码从二进制文件中读取数据，并发送到目标IP地址的1801端口。用户可以通过修改`user_message.bin`文件中的数据来尝试不同的攻击载荷。

**投毒风险：**
POC代码本身主要功能是发送预定义的二进制数据包，初步判断高危恶意投毒的可能性较低。
*   **低风险：**代码主要功能是读取预定义的二进制文件并发送它们。虽然这些文件本身可能是恶意的，但脚本本身并没有明显包含恶意代码（如下载并执行任意代码）。
*   **中等风险：**作者可能在`establish_connection.bin`，`connection_parameters.bin`，`user_message.bin`和 `session_acknowledgment.bin`这些二进制文件中植入恶意代码。攻击者可能利用这些文件进行恶意攻击，例如，user_message.bin 可能包含触发漏洞的特定有效载荷。
*   **需要注意的地方：**代码中有部分注释，如`data[0x5e] = i`和`data[0x5f] = 0xff`，表明攻击者可以修改`user_message.bin`的内容。如果这些修改用于执行恶意代码，则存在潜在风险。

总而言之，虽然此脚本直接包含后门代码的风险较低，但它为潜在的恶意利用程序提供了框架。因此，考虑到二进制文件可能被篡改植入恶意payload，代码存在10%的投毒风险。

**利用方式：**
1.  **环境准备：** 确保目标系统上运行着易受攻击的MSMQ服务版本，并且攻击者可以通过网络访问其1801端口。
2.  **准备恶意消息：** 准备包含恶意载荷的`establish_connection.bin`, `connection_parameters.bin`, `user_message.bin`和`session_acknowledgment.bin`文件。通常，`user_message.bin`是放置攻击载荷的常见位置。
3.  **运行POC脚本：** 运行提供的POC脚本，将目标IP地址作为输入。脚本将按照MSMQ协议顺序发送数据包。
4.  **触发漏洞：** 如果`user_message.bin`中的载荷成功利用了漏洞，则可以在目标系统上执行任意代码。

**缓解措施：**
*   应用Microsoft提供的安全补丁。
*   如果不需要，禁用MSMQ服务。
*   限制对MSMQ服务的网络访问。
*   使用网络入侵检测系统(NIDS)监控MSMQ流量中是否存在恶意模式。

**项目地址:** [Rahul-Thakur7/CVE-2023-21554](https://github.com/Rahul-Thakur7/CVE-2023-21554)

**漏洞详情:** [CVE-2023-21554](https://nvd.nist.gov/vuln/detail/CVE-2023-21554)

---

## POC #3

**来源**: [CVE-2023-21554-leongxudong_MSMQ-Vulnerability.md](../2023/CVE-2023-21554-leongxudong_MSMQ-Vulnerability.md)

## CVE-2023-21554 - Microsoft Message Queuing (MSMQ) 远程代码执行漏洞

**漏洞编号:** CVE-2023-21554

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Message Queuing (MSMQ)

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** 受影响的Windows版本详见CVE信息

**利用条件:** 目标系统需要启用并运行MSMQ服务，且攻击者能够访问目标机器的1801端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-21554是一个Microsoft Message Queuing (MSMQ)服务中的远程代码执行漏洞。攻击者可以通过向MSMQ服务发送特制的恶意消息，利用该漏洞在目标系统上执行任意代码。\n\n**有效性分析：**\n根据提供的漏洞信息和利用代码，该漏洞的PoC是可用的。PoC代码（poc.py）通过socket连接目标IP地址的1801端口，然后发送一系列预先准备好的二进制数据包（establish_connection.bin, connection_parameters.bin, user_message.bin）。这些数据包模拟了MSMQ的通信过程，利用了协议解析中的漏洞。攻击者需要根据实际情况修改PoC中的IP地址，并确保相应的数据文件存在。从3tternp的代码库修改而来，降低了投毒的可能性。\n\n**投毒风险分析：**\n虽然PoC代码本身看起来直接利用漏洞，但仍然存在一定的投毒风险。PoC代码依赖于外部二进制文件（.bin文件）。如果这些文件被替换为包含恶意代码的版本，攻击者可以通过该PoC执行任意代码。因此，在运行PoC之前，务必验证这些二进制文件的来源和完整性。通过分析PoC代码，发现其主要功能是发送预先制作好的数据包。如果这些数据包被修改为包含恶意指令，可能导致不可预测的行为。根据文件来源和代码分析，投毒风险估计为10%。\n\n**利用方式分析：**\n1.  **环境准备：** 攻击者需要安装Python，并获取PoC代码和相关的数据文件。\n2.  **目标确定：** 攻击者需要确定目标机器的IP地址，并且目标机器需要运行MSMQ服务。\n3.  **PoC配置：** 攻击者需要修改PoC代码中的IP地址，指向目标机器。\n4.  **漏洞触发：** 攻击者运行PoC代码，PoC代码会连接目标机器的1801端口，并发送恶意消息。\n5.  **代码执行：** 如果漏洞利用成功，攻击者可以在目标机器上执行任意代码。通常，攻击者会利用该漏洞来安装后门程序或执行其他恶意操作。\n\n**缓解措施：**\n1.  及时安装Microsoft提供的安全补丁。\n2.  禁用不需要的MSMQ服务。\n3.  限制MSMQ服务的访问权限。\n4.  使用防火墙阻止对1801端口的未授权访问。\n5.  监控MSMQ服务的异常行为。

**项目地址:** [leongxudong/MSMQ-Vulnerability](https://github.com/leongxudong/MSMQ-Vulnerability)

**漏洞详情:** [CVE-2023-21554](https://nvd.nist.gov/vuln/detail/CVE-2023-21554)

---

## POC #4

**来源**: [CVE-2023-21554-shootweb_CVE-2023-21554.md](../2023/CVE-2023-21554-shootweb_CVE-2023-21554.md)

## CVE-2023-21554-MSMQ远程代码执行

**漏洞编号:** CVE-2023-21554

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Message Queuing (MSMQ)

**危害等级:** 高危，可被未经身份验证的攻击者利用

**影响版本:** 受影响的Windows版本范围广泛，具体请参考CVE信息

**利用条件:** 目标系统需要运行MSMQ服务，且攻击者需要能够访问MSMQ的端口（通常是1801）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-21554 是 Microsoft Message Queuing (MSMQ) 中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过网络发送特制的恶意消息到 MSMQ 服务器，从而在目标系统上执行任意代码。  

**漏洞利用分析：**

提供的 Python 脚本 (poc_check.py) 并非直接利用该漏洞执行代码，而是一个辅助工具，用于测试攻击流程的各个阶段，帮助分析和调试漏洞利用过程。该脚本分阶段发送预定义的数据包（"establish_connection.bin"、"connection_parameters.bin"、"user_message.bin"）到目标 MSMQ 服务器，并捕获服务器的响应。

*   **连接建立阶段 (establish_connection.bin)：**  建立与目标 MSMQ 服务器的 TCP 连接。
*   **连接参数协商阶段 (connection_parameters.bin)：**  发送连接参数，这可能包含触发漏洞的关键数据。
*   **用户消息发送阶段 (user_message.bin)：**  发送包含恶意负载的用户消息。

该脚本会打印服务器的响应、连接状态以及任何异常情况，这有助于确定漏洞利用是否成功。

**有效性：**

该脚本的目的是验证漏洞的存在，而不是完整的漏洞利用，如果配合正确的二进制payload文件，脚本可以成功触发漏洞。

**投毒风险：**

从提供的代码来看，投毒风险较低。脚本本身没有明显的恶意行为，只是一个测试工具。主要的风险在于以下几点：

*   **依赖的二进制文件：** `establish_connection.bin`、`connection_parameters.bin`、`user_message.bin` 这些二进制文件的内容是未知的，如果这些文件被篡改，包含恶意代码，则可能存在投毒风险。但是这个风险较低，因为漏洞利用脚本需要配合漏洞本身的利用链，如果随意投毒，导致利用链断裂，就无法达到攻击的目的，所以这个仓库中投毒的可能性较低。

*   **服务器端漏洞利用：**  最终的远程代码执行依赖于服务器端 MSMQ 服务的漏洞。如果攻击者修改服务器端的 MSMQ 服务代码，使其包含后门，则可能存在投毒风险，但这与此代码仓库无关。

所以，综合来看，此代码仓库本身存在投毒的概率较低，估算为 5%。

**利用方式：**

1.  使用 poc_check.py 脚本，按顺序发送 establish_connection.bin, connection_parameters.bin, user_message.bin 这三个文件。
2.  脚本可以诊断每个阶段的连接状态，发送的数据，以及服务器的响应信息，可以协助漏洞研究人员分析漏洞成因，构造合适的利用数据，最终实现远程代码执行。

根据漏洞库信息，利用该漏洞需要精心构造 MSMQ 消息，利用不当的输入验证缺陷来执行恶意代码。具体利用方式可能涉及缓冲区溢出、类型混淆或其他内存破坏技术。


**项目地址:** [shootweb/CVE-2023-21554](https://github.com/shootweb/CVE-2023-21554)

**漏洞详情:** [CVE-2023-21554](https://nvd.nist.gov/vuln/detail/CVE-2023-21554)

---

## POC #5

**来源**: [CVE-2023-21554-zoemurmure_CVE-2023-21554-PoC.md](../2023/CVE-2023-21554-zoemurmure_CVE-2023-21554-PoC.md)

## CVE-2023-21554-Microsoft Message Queuing (MSMQ) Remote Code Execution Vulnerability

**漏洞编号:** CVE-2023-21554

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Message Queuing (MSMQ)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 目标系统已启用MSMQ服务，且攻击者能够与MSMQ服务端口(通常是1801)建立连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2023-21554是Microsoft Message Queuing (MSMQ) 远程代码执行漏洞。提供的PoC代码尝试利用此漏洞。以下是详细分析：

**1. 有效性：**
根据README.md，PoC成功的标志是`mqsvc.exe`进程的崩溃。PoC代码通过socket连接到目标机器的1801端口(MSMQ默认端口)，然后发送一系列预先准备好的二进制数据包，包括连接建立请求 (`establish_connection.bin`)、连接参数 (`connection_parameters.bin`) 和包含漏洞触发数据的用户消息 (`user_message.bin`)。如果目标系统存在漏洞，则`mqsvc.exe`进程会崩溃，表明利用成功。根据文档，`mqsvc.exe`进程的崩溃而非弹窗是成功利用的标志。

**2. 投毒风险：**
分析PoC代码后，没有发现明显的投毒代码。代码的目的是发送一系列二进制文件到MSMQ服务，触发漏洞导致服务崩溃。它并没有执行任何恶意操作例如下载执行恶意程序，上传用户隐私信息等等。代码主要功能是从本地读取文件然后通过socket发送，投毒风险较低。虽然PoC代码本身尝试利用漏洞，但利用的目的是触发崩溃，而不是植入后门或其他恶意行为。因此，可以认为存在投毒代码的概率为0%。

**3. 利用方式：**
漏洞的利用方式如下：
1.  **建立连接：** PoC首先通过socket连接到目标机器的MSMQ服务端口（1801）。
2.  **发送预定义数据包：**  PoC发送一系列预定义的二进制数据包，这些数据包模拟了MSMQ客户端与服务器之间的正常通信流程，包括建立连接、设置连接参数和发送用户消息。
3.  **触发漏洞：**  `user_message.bin`包含精心构造的恶意数据，当MSMQ服务处理这些数据时，会触发漏洞，导致`mqsvc.exe`进程崩溃，可能最终导致远程代码执行。

简单来说，该漏洞是由于MSMQ服务在处理特定格式的消息时，未进行充分的输入验证，导致可以利用精心构造的消息触发漏洞，进而导致远程代码执行。

**项目地址:** [zoemurmure/CVE-2023-21554-PoC](https://github.com/zoemurmure/CVE-2023-21554-PoC)

**漏洞详情:** [CVE-2023-21554](https://nvd.nist.gov/vuln/detail/CVE-2023-21554)

---



---

## POC #3

**来源**: [CVE-2023-21554-leongxudong_MSMQ-Vulnerability.md](../2023/CVE-2023-21554-leongxudong_MSMQ-Vulnerability.md)

## CVE-2023-21554 - Microsoft Message Queuing (MSMQ) 远程代码执行漏洞

**漏洞编号:** CVE-2023-21554

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Message Queuing (MSMQ)

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** 受影响的Windows版本详见CVE信息

**利用条件:** 目标系统需要启用并运行MSMQ服务，且攻击者能够访问目标机器的1801端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-21554是一个Microsoft Message Queuing (MSMQ)服务中的远程代码执行漏洞。攻击者可以通过向MSMQ服务发送特制的恶意消息，利用该漏洞在目标系统上执行任意代码。\n\n**有效性分析：**\n根据提供的漏洞信息和利用代码，该漏洞的PoC是可用的。PoC代码（poc.py）通过socket连接目标IP地址的1801端口，然后发送一系列预先准备好的二进制数据包（establish_connection.bin, connection_parameters.bin, user_message.bin）。这些数据包模拟了MSMQ的通信过程，利用了协议解析中的漏洞。攻击者需要根据实际情况修改PoC中的IP地址，并确保相应的数据文件存在。从3tternp的代码库修改而来，降低了投毒的可能性。\n\n**投毒风险分析：**\n虽然PoC代码本身看起来直接利用漏洞，但仍然存在一定的投毒风险。PoC代码依赖于外部二进制文件（.bin文件）。如果这些文件被替换为包含恶意代码的版本，攻击者可以通过该PoC执行任意代码。因此，在运行PoC之前，务必验证这些二进制文件的来源和完整性。通过分析PoC代码，发现其主要功能是发送预先制作好的数据包。如果这些数据包被修改为包含恶意指令，可能导致不可预测的行为。根据文件来源和代码分析，投毒风险估计为10%。\n\n**利用方式分析：**\n1.  **环境准备：** 攻击者需要安装Python，并获取PoC代码和相关的数据文件。\n2.  **目标确定：** 攻击者需要确定目标机器的IP地址，并且目标机器需要运行MSMQ服务。\n3.  **PoC配置：** 攻击者需要修改PoC代码中的IP地址，指向目标机器。\n4.  **漏洞触发：** 攻击者运行PoC代码，PoC代码会连接目标机器的1801端口，并发送恶意消息。\n5.  **代码执行：** 如果漏洞利用成功，攻击者可以在目标机器上执行任意代码。通常，攻击者会利用该漏洞来安装后门程序或执行其他恶意操作。\n\n**缓解措施：**\n1.  及时安装Microsoft提供的安全补丁。\n2.  禁用不需要的MSMQ服务。\n3.  限制MSMQ服务的访问权限。\n4.  使用防火墙阻止对1801端口的未授权访问。\n5.  监控MSMQ服务的异常行为。

**项目地址:** [leongxudong/MSMQ-Vulnerability](https://github.com/leongxudong/MSMQ-Vulnerability)

**漏洞详情:** [CVE-2023-21554](https://nvd.nist.gov/vuln/detail/CVE-2023-21554)

---

## POC #4

**来源**: [CVE-2023-21554-shootweb_CVE-2023-21554.md](../2023/CVE-2023-21554-shootweb_CVE-2023-21554.md)

## CVE-2023-21554-MSMQ远程代码执行

**漏洞编号:** CVE-2023-21554

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Message Queuing (MSMQ)

**危害等级:** 高危，可被未经身份验证的攻击者利用

**影响版本:** 受影响的Windows版本范围广泛，具体请参考CVE信息

**利用条件:** 目标系统需要运行MSMQ服务，且攻击者需要能够访问MSMQ的端口（通常是1801）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-21554 是 Microsoft Message Queuing (MSMQ) 中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过网络发送特制的恶意消息到 MSMQ 服务器，从而在目标系统上执行任意代码。  

**漏洞利用分析：**

提供的 Python 脚本 (poc_check.py) 并非直接利用该漏洞执行代码，而是一个辅助工具，用于测试攻击流程的各个阶段，帮助分析和调试漏洞利用过程。该脚本分阶段发送预定义的数据包（"establish_connection.bin"、"connection_parameters.bin"、"user_message.bin"）到目标 MSMQ 服务器，并捕获服务器的响应。

*   **连接建立阶段 (establish_connection.bin)：**  建立与目标 MSMQ 服务器的 TCP 连接。
*   **连接参数协商阶段 (connection_parameters.bin)：**  发送连接参数，这可能包含触发漏洞的关键数据。
*   **用户消息发送阶段 (user_message.bin)：**  发送包含恶意负载的用户消息。

该脚本会打印服务器的响应、连接状态以及任何异常情况，这有助于确定漏洞利用是否成功。

**有效性：**

该脚本的目的是验证漏洞的存在，而不是完整的漏洞利用，如果配合正确的二进制payload文件，脚本可以成功触发漏洞。

**投毒风险：**

从提供的代码来看，投毒风险较低。脚本本身没有明显的恶意行为，只是一个测试工具。主要的风险在于以下几点：

*   **依赖的二进制文件：** `establish_connection.bin`、`connection_parameters.bin`、`user_message.bin` 这些二进制文件的内容是未知的，如果这些文件被篡改，包含恶意代码，则可能存在投毒风险。但是这个风险较低，因为漏洞利用脚本需要配合漏洞本身的利用链，如果随意投毒，导致利用链断裂，就无法达到攻击的目的，所以这个仓库中投毒的可能性较低。

*   **服务器端漏洞利用：**  最终的远程代码执行依赖于服务器端 MSMQ 服务的漏洞。如果攻击者修改服务器端的 MSMQ 服务代码，使其包含后门，则可能存在投毒风险，但这与此代码仓库无关。

所以，综合来看，此代码仓库本身存在投毒的概率较低，估算为 5%。

**利用方式：**

1.  使用 poc_check.py 脚本，按顺序发送 establish_connection.bin, connection_parameters.bin, user_message.bin 这三个文件。
2.  脚本可以诊断每个阶段的连接状态，发送的数据，以及服务器的响应信息，可以协助漏洞研究人员分析漏洞成因，构造合适的利用数据，最终实现远程代码执行。

根据漏洞库信息，利用该漏洞需要精心构造 MSMQ 消息，利用不当的输入验证缺陷来执行恶意代码。具体利用方式可能涉及缓冲区溢出、类型混淆或其他内存破坏技术。


**项目地址:** [shootweb/CVE-2023-21554](https://github.com/shootweb/CVE-2023-21554)

**漏洞详情:** [CVE-2023-21554](https://nvd.nist.gov/vuln/detail/CVE-2023-21554)

---

## POC #5

**来源**: [CVE-2023-21554-zoemurmure_CVE-2023-21554-PoC.md](../2023/CVE-2023-21554-zoemurmure_CVE-2023-21554-PoC.md)

## CVE-2023-21554-Microsoft Message Queuing (MSMQ) Remote Code Execution Vulnerability

**漏洞编号:** CVE-2023-21554

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Message Queuing (MSMQ)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 目标系统已启用MSMQ服务，且攻击者能够与MSMQ服务端口(通常是1801)建立连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2023-21554是Microsoft Message Queuing (MSMQ) 远程代码执行漏洞。提供的PoC代码尝试利用此漏洞。以下是详细分析：

**1. 有效性：**
根据README.md，PoC成功的标志是`mqsvc.exe`进程的崩溃。PoC代码通过socket连接到目标机器的1801端口(MSMQ默认端口)，然后发送一系列预先准备好的二进制数据包，包括连接建立请求 (`establish_connection.bin`)、连接参数 (`connection_parameters.bin`) 和包含漏洞触发数据的用户消息 (`user_message.bin`)。如果目标系统存在漏洞，则`mqsvc.exe`进程会崩溃，表明利用成功。根据文档，`mqsvc.exe`进程的崩溃而非弹窗是成功利用的标志。

**2. 投毒风险：**
分析PoC代码后，没有发现明显的投毒代码。代码的目的是发送一系列二进制文件到MSMQ服务，触发漏洞导致服务崩溃。它并没有执行任何恶意操作例如下载执行恶意程序，上传用户隐私信息等等。代码主要功能是从本地读取文件然后通过socket发送，投毒风险较低。虽然PoC代码本身尝试利用漏洞，但利用的目的是触发崩溃，而不是植入后门或其他恶意行为。因此，可以认为存在投毒代码的概率为0%。

**3. 利用方式：**
漏洞的利用方式如下：
1.  **建立连接：** PoC首先通过socket连接到目标机器的MSMQ服务端口（1801）。
2.  **发送预定义数据包：**  PoC发送一系列预定义的二进制数据包，这些数据包模拟了MSMQ客户端与服务器之间的正常通信流程，包括建立连接、设置连接参数和发送用户消息。
3.  **触发漏洞：**  `user_message.bin`包含精心构造的恶意数据，当MSMQ服务处理这些数据时，会触发漏洞，导致`mqsvc.exe`进程崩溃，可能最终导致远程代码执行。

简单来说，该漏洞是由于MSMQ服务在处理特定格式的消息时，未进行充分的输入验证，导致可以利用精心构造的消息触发漏洞，进而导致远程代码执行。

**项目地址:** [zoemurmure/CVE-2023-21554-PoC](https://github.com/zoemurmure/CVE-2023-21554-PoC)

**漏洞详情:** [CVE-2023-21554](https://nvd.nist.gov/vuln/detail/CVE-2023-21554)

---



---

## POC #3

**来源**: [CVE-2023-21554-leongxudong_MSMQ-Vulnerability.md](../2023/CVE-2023-21554-leongxudong_MSMQ-Vulnerability.md)

## CVE-2023-21554 - Microsoft Message Queuing (MSMQ) 远程代码执行漏洞

**漏洞编号:** CVE-2023-21554

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Message Queuing (MSMQ)

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** 受影响的Windows版本详见CVE信息

**利用条件:** 目标系统需要启用并运行MSMQ服务，且攻击者能够访问目标机器的1801端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-21554是一个Microsoft Message Queuing (MSMQ)服务中的远程代码执行漏洞。攻击者可以通过向MSMQ服务发送特制的恶意消息，利用该漏洞在目标系统上执行任意代码。\n\n**有效性分析：**\n根据提供的漏洞信息和利用代码，该漏洞的PoC是可用的。PoC代码（poc.py）通过socket连接目标IP地址的1801端口，然后发送一系列预先准备好的二进制数据包（establish_connection.bin, connection_parameters.bin, user_message.bin）。这些数据包模拟了MSMQ的通信过程，利用了协议解析中的漏洞。攻击者需要根据实际情况修改PoC中的IP地址，并确保相应的数据文件存在。从3tternp的代码库修改而来，降低了投毒的可能性。\n\n**投毒风险分析：**\n虽然PoC代码本身看起来直接利用漏洞，但仍然存在一定的投毒风险。PoC代码依赖于外部二进制文件（.bin文件）。如果这些文件被替换为包含恶意代码的版本，攻击者可以通过该PoC执行任意代码。因此，在运行PoC之前，务必验证这些二进制文件的来源和完整性。通过分析PoC代码，发现其主要功能是发送预先制作好的数据包。如果这些数据包被修改为包含恶意指令，可能导致不可预测的行为。根据文件来源和代码分析，投毒风险估计为10%。\n\n**利用方式分析：**\n1.  **环境准备：** 攻击者需要安装Python，并获取PoC代码和相关的数据文件。\n2.  **目标确定：** 攻击者需要确定目标机器的IP地址，并且目标机器需要运行MSMQ服务。\n3.  **PoC配置：** 攻击者需要修改PoC代码中的IP地址，指向目标机器。\n4.  **漏洞触发：** 攻击者运行PoC代码，PoC代码会连接目标机器的1801端口，并发送恶意消息。\n5.  **代码执行：** 如果漏洞利用成功，攻击者可以在目标机器上执行任意代码。通常，攻击者会利用该漏洞来安装后门程序或执行其他恶意操作。\n\n**缓解措施：**\n1.  及时安装Microsoft提供的安全补丁。\n2.  禁用不需要的MSMQ服务。\n3.  限制MSMQ服务的访问权限。\n4.  使用防火墙阻止对1801端口的未授权访问。\n5.  监控MSMQ服务的异常行为。

**项目地址:** [leongxudong/MSMQ-Vulnerability](https://github.com/leongxudong/MSMQ-Vulnerability)

**漏洞详情:** [CVE-2023-21554](https://nvd.nist.gov/vuln/detail/CVE-2023-21554)

---

## POC #4

**来源**: [CVE-2023-21554-shootweb_CVE-2023-21554.md](../2023/CVE-2023-21554-shootweb_CVE-2023-21554.md)

## CVE-2023-21554-MSMQ远程代码执行

**漏洞编号:** CVE-2023-21554

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Message Queuing (MSMQ)

**危害等级:** 高危，可被未经身份验证的攻击者利用

**影响版本:** 受影响的Windows版本范围广泛，具体请参考CVE信息

**利用条件:** 目标系统需要运行MSMQ服务，且攻击者需要能够访问MSMQ的端口（通常是1801）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-21554 是 Microsoft Message Queuing (MSMQ) 中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过网络发送特制的恶意消息到 MSMQ 服务器，从而在目标系统上执行任意代码。  

**漏洞利用分析：**

提供的 Python 脚本 (poc_check.py) 并非直接利用该漏洞执行代码，而是一个辅助工具，用于测试攻击流程的各个阶段，帮助分析和调试漏洞利用过程。该脚本分阶段发送预定义的数据包（"establish_connection.bin"、"connection_parameters.bin"、"user_message.bin"）到目标 MSMQ 服务器，并捕获服务器的响应。

*   **连接建立阶段 (establish_connection.bin)：**  建立与目标 MSMQ 服务器的 TCP 连接。
*   **连接参数协商阶段 (connection_parameters.bin)：**  发送连接参数，这可能包含触发漏洞的关键数据。
*   **用户消息发送阶段 (user_message.bin)：**  发送包含恶意负载的用户消息。

该脚本会打印服务器的响应、连接状态以及任何异常情况，这有助于确定漏洞利用是否成功。

**有效性：**

该脚本的目的是验证漏洞的存在，而不是完整的漏洞利用，如果配合正确的二进制payload文件，脚本可以成功触发漏洞。

**投毒风险：**

从提供的代码来看，投毒风险较低。脚本本身没有明显的恶意行为，只是一个测试工具。主要的风险在于以下几点：

*   **依赖的二进制文件：** `establish_connection.bin`、`connection_parameters.bin`、`user_message.bin` 这些二进制文件的内容是未知的，如果这些文件被篡改，包含恶意代码，则可能存在投毒风险。但是这个风险较低，因为漏洞利用脚本需要配合漏洞本身的利用链，如果随意投毒，导致利用链断裂，就无法达到攻击的目的，所以这个仓库中投毒的可能性较低。

*   **服务器端漏洞利用：**  最终的远程代码执行依赖于服务器端 MSMQ 服务的漏洞。如果攻击者修改服务器端的 MSMQ 服务代码，使其包含后门，则可能存在投毒风险，但这与此代码仓库无关。

所以，综合来看，此代码仓库本身存在投毒的概率较低，估算为 5%。

**利用方式：**

1.  使用 poc_check.py 脚本，按顺序发送 establish_connection.bin, connection_parameters.bin, user_message.bin 这三个文件。
2.  脚本可以诊断每个阶段的连接状态，发送的数据，以及服务器的响应信息，可以协助漏洞研究人员分析漏洞成因，构造合适的利用数据，最终实现远程代码执行。

根据漏洞库信息，利用该漏洞需要精心构造 MSMQ 消息，利用不当的输入验证缺陷来执行恶意代码。具体利用方式可能涉及缓冲区溢出、类型混淆或其他内存破坏技术。


**项目地址:** [shootweb/CVE-2023-21554](https://github.com/shootweb/CVE-2023-21554)

**漏洞详情:** [CVE-2023-21554](https://nvd.nist.gov/vuln/detail/CVE-2023-21554)

---

## POC #5

**来源**: [CVE-2023-21554-zoemurmure_CVE-2023-21554-PoC.md](../2023/CVE-2023-21554-zoemurmure_CVE-2023-21554-PoC.md)

## CVE-2023-21554-Microsoft Message Queuing (MSMQ) Remote Code Execution Vulnerability

**漏洞编号:** CVE-2023-21554

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Message Queuing (MSMQ)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 目标系统已启用MSMQ服务，且攻击者能够与MSMQ服务端口(通常是1801)建立连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2023-21554是Microsoft Message Queuing (MSMQ) 远程代码执行漏洞。提供的PoC代码尝试利用此漏洞。以下是详细分析：

**1. 有效性：**
根据README.md，PoC成功的标志是`mqsvc.exe`进程的崩溃。PoC代码通过socket连接到目标机器的1801端口(MSMQ默认端口)，然后发送一系列预先准备好的二进制数据包，包括连接建立请求 (`establish_connection.bin`)、连接参数 (`connection_parameters.bin`) 和包含漏洞触发数据的用户消息 (`user_message.bin`)。如果目标系统存在漏洞，则`mqsvc.exe`进程会崩溃，表明利用成功。根据文档，`mqsvc.exe`进程的崩溃而非弹窗是成功利用的标志。

**2. 投毒风险：**
分析PoC代码后，没有发现明显的投毒代码。代码的目的是发送一系列二进制文件到MSMQ服务，触发漏洞导致服务崩溃。它并没有执行任何恶意操作例如下载执行恶意程序，上传用户隐私信息等等。代码主要功能是从本地读取文件然后通过socket发送，投毒风险较低。虽然PoC代码本身尝试利用漏洞，但利用的目的是触发崩溃，而不是植入后门或其他恶意行为。因此，可以认为存在投毒代码的概率为0%。

**3. 利用方式：**
漏洞的利用方式如下：
1.  **建立连接：** PoC首先通过socket连接到目标机器的MSMQ服务端口（1801）。
2.  **发送预定义数据包：**  PoC发送一系列预定义的二进制数据包，这些数据包模拟了MSMQ客户端与服务器之间的正常通信流程，包括建立连接、设置连接参数和发送用户消息。
3.  **触发漏洞：**  `user_message.bin`包含精心构造的恶意数据，当MSMQ服务处理这些数据时，会触发漏洞，导致`mqsvc.exe`进程崩溃，可能最终导致远程代码执行。

简单来说，该漏洞是由于MSMQ服务在处理特定格式的消息时，未进行充分的输入验证，导致可以利用精心构造的消息触发漏洞，进而导致远程代码执行。

**项目地址:** [zoemurmure/CVE-2023-21554-PoC](https://github.com/zoemurmure/CVE-2023-21554-PoC)

**漏洞详情:** [CVE-2023-21554](https://nvd.nist.gov/vuln/detail/CVE-2023-21554)

---



---

## POC #3

**来源**: [CVE-2023-21554-leongxudong_MSMQ-Vulnerability.md](../2023/CVE-2023-21554-leongxudong_MSMQ-Vulnerability.md)

## CVE-2023-21554 - Microsoft Message Queuing (MSMQ) 远程代码执行漏洞

**漏洞编号:** CVE-2023-21554

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Message Queuing (MSMQ)

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** 受影响的Windows版本详见CVE信息

**利用条件:** 目标系统需要启用并运行MSMQ服务，且攻击者能够访问目标机器的1801端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-21554是一个Microsoft Message Queuing (MSMQ)服务中的远程代码执行漏洞。攻击者可以通过向MSMQ服务发送特制的恶意消息，利用该漏洞在目标系统上执行任意代码。\n\n**有效性分析：**\n根据提供的漏洞信息和利用代码，该漏洞的PoC是可用的。PoC代码（poc.py）通过socket连接目标IP地址的1801端口，然后发送一系列预先准备好的二进制数据包（establish_connection.bin, connection_parameters.bin, user_message.bin）。这些数据包模拟了MSMQ的通信过程，利用了协议解析中的漏洞。攻击者需要根据实际情况修改PoC中的IP地址，并确保相应的数据文件存在。从3tternp的代码库修改而来，降低了投毒的可能性。\n\n**投毒风险分析：**\n虽然PoC代码本身看起来直接利用漏洞，但仍然存在一定的投毒风险。PoC代码依赖于外部二进制文件（.bin文件）。如果这些文件被替换为包含恶意代码的版本，攻击者可以通过该PoC执行任意代码。因此，在运行PoC之前，务必验证这些二进制文件的来源和完整性。通过分析PoC代码，发现其主要功能是发送预先制作好的数据包。如果这些数据包被修改为包含恶意指令，可能导致不可预测的行为。根据文件来源和代码分析，投毒风险估计为10%。\n\n**利用方式分析：**\n1.  **环境准备：** 攻击者需要安装Python，并获取PoC代码和相关的数据文件。\n2.  **目标确定：** 攻击者需要确定目标机器的IP地址，并且目标机器需要运行MSMQ服务。\n3.  **PoC配置：** 攻击者需要修改PoC代码中的IP地址，指向目标机器。\n4.  **漏洞触发：** 攻击者运行PoC代码，PoC代码会连接目标机器的1801端口，并发送恶意消息。\n5.  **代码执行：** 如果漏洞利用成功，攻击者可以在目标机器上执行任意代码。通常，攻击者会利用该漏洞来安装后门程序或执行其他恶意操作。\n\n**缓解措施：**\n1.  及时安装Microsoft提供的安全补丁。\n2.  禁用不需要的MSMQ服务。\n3.  限制MSMQ服务的访问权限。\n4.  使用防火墙阻止对1801端口的未授权访问。\n5.  监控MSMQ服务的异常行为。

**项目地址:** [leongxudong/MSMQ-Vulnerability](https://github.com/leongxudong/MSMQ-Vulnerability)

**漏洞详情:** [CVE-2023-21554](https://nvd.nist.gov/vuln/detail/CVE-2023-21554)

---

## POC #4

**来源**: [CVE-2023-21554-shootweb_CVE-2023-21554.md](../2023/CVE-2023-21554-shootweb_CVE-2023-21554.md)

## CVE-2023-21554-MSMQ远程代码执行

**漏洞编号:** CVE-2023-21554

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Message Queuing (MSMQ)

**危害等级:** 高危，可被未经身份验证的攻击者利用

**影响版本:** 受影响的Windows版本范围广泛，具体请参考CVE信息

**利用条件:** 目标系统需要运行MSMQ服务，且攻击者需要能够访问MSMQ的端口（通常是1801）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-21554 是 Microsoft Message Queuing (MSMQ) 中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过网络发送特制的恶意消息到 MSMQ 服务器，从而在目标系统上执行任意代码。  

**漏洞利用分析：**

提供的 Python 脚本 (poc_check.py) 并非直接利用该漏洞执行代码，而是一个辅助工具，用于测试攻击流程的各个阶段，帮助分析和调试漏洞利用过程。该脚本分阶段发送预定义的数据包（"establish_connection.bin"、"connection_parameters.bin"、"user_message.bin"）到目标 MSMQ 服务器，并捕获服务器的响应。

*   **连接建立阶段 (establish_connection.bin)：**  建立与目标 MSMQ 服务器的 TCP 连接。
*   **连接参数协商阶段 (connection_parameters.bin)：**  发送连接参数，这可能包含触发漏洞的关键数据。
*   **用户消息发送阶段 (user_message.bin)：**  发送包含恶意负载的用户消息。

该脚本会打印服务器的响应、连接状态以及任何异常情况，这有助于确定漏洞利用是否成功。

**有效性：**

该脚本的目的是验证漏洞的存在，而不是完整的漏洞利用，如果配合正确的二进制payload文件，脚本可以成功触发漏洞。

**投毒风险：**

从提供的代码来看，投毒风险较低。脚本本身没有明显的恶意行为，只是一个测试工具。主要的风险在于以下几点：

*   **依赖的二进制文件：** `establish_connection.bin`、`connection_parameters.bin`、`user_message.bin` 这些二进制文件的内容是未知的，如果这些文件被篡改，包含恶意代码，则可能存在投毒风险。但是这个风险较低，因为漏洞利用脚本需要配合漏洞本身的利用链，如果随意投毒，导致利用链断裂，就无法达到攻击的目的，所以这个仓库中投毒的可能性较低。

*   **服务器端漏洞利用：**  最终的远程代码执行依赖于服务器端 MSMQ 服务的漏洞。如果攻击者修改服务器端的 MSMQ 服务代码，使其包含后门，则可能存在投毒风险，但这与此代码仓库无关。

所以，综合来看，此代码仓库本身存在投毒的概率较低，估算为 5%。

**利用方式：**

1.  使用 poc_check.py 脚本，按顺序发送 establish_connection.bin, connection_parameters.bin, user_message.bin 这三个文件。
2.  脚本可以诊断每个阶段的连接状态，发送的数据，以及服务器的响应信息，可以协助漏洞研究人员分析漏洞成因，构造合适的利用数据，最终实现远程代码执行。

根据漏洞库信息，利用该漏洞需要精心构造 MSMQ 消息，利用不当的输入验证缺陷来执行恶意代码。具体利用方式可能涉及缓冲区溢出、类型混淆或其他内存破坏技术。


**项目地址:** [shootweb/CVE-2023-21554](https://github.com/shootweb/CVE-2023-21554)

**漏洞详情:** [CVE-2023-21554](https://nvd.nist.gov/vuln/detail/CVE-2023-21554)

---

## POC #5

**来源**: [CVE-2023-21554-zoemurmure_CVE-2023-21554-PoC.md](../2023/CVE-2023-21554-zoemurmure_CVE-2023-21554-PoC.md)

## CVE-2023-21554-Microsoft Message Queuing (MSMQ) Remote Code Execution Vulnerability

**漏洞编号:** CVE-2023-21554

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Message Queuing (MSMQ)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 目标系统已启用MSMQ服务，且攻击者能够与MSMQ服务端口(通常是1801)建立连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2023-21554是Microsoft Message Queuing (MSMQ) 远程代码执行漏洞。提供的PoC代码尝试利用此漏洞。以下是详细分析：

**1. 有效性：**
根据README.md，PoC成功的标志是`mqsvc.exe`进程的崩溃。PoC代码通过socket连接到目标机器的1801端口(MSMQ默认端口)，然后发送一系列预先准备好的二进制数据包，包括连接建立请求 (`establish_connection.bin`)、连接参数 (`connection_parameters.bin`) 和包含漏洞触发数据的用户消息 (`user_message.bin`)。如果目标系统存在漏洞，则`mqsvc.exe`进程会崩溃，表明利用成功。根据文档，`mqsvc.exe`进程的崩溃而非弹窗是成功利用的标志。

**2. 投毒风险：**
分析PoC代码后，没有发现明显的投毒代码。代码的目的是发送一系列二进制文件到MSMQ服务，触发漏洞导致服务崩溃。它并没有执行任何恶意操作例如下载执行恶意程序，上传用户隐私信息等等。代码主要功能是从本地读取文件然后通过socket发送，投毒风险较低。虽然PoC代码本身尝试利用漏洞，但利用的目的是触发崩溃，而不是植入后门或其他恶意行为。因此，可以认为存在投毒代码的概率为0%。

**3. 利用方式：**
漏洞的利用方式如下：
1.  **建立连接：** PoC首先通过socket连接到目标机器的MSMQ服务端口（1801）。
2.  **发送预定义数据包：**  PoC发送一系列预定义的二进制数据包，这些数据包模拟了MSMQ客户端与服务器之间的正常通信流程，包括建立连接、设置连接参数和发送用户消息。
3.  **触发漏洞：**  `user_message.bin`包含精心构造的恶意数据，当MSMQ服务处理这些数据时，会触发漏洞，导致`mqsvc.exe`进程崩溃，可能最终导致远程代码执行。

简单来说，该漏洞是由于MSMQ服务在处理特定格式的消息时，未进行充分的输入验证，导致可以利用精心构造的消息触发漏洞，进而导致远程代码执行。

**项目地址:** [zoemurmure/CVE-2023-21554-PoC](https://github.com/zoemurmure/CVE-2023-21554-PoC)

**漏洞详情:** [CVE-2023-21554](https://nvd.nist.gov/vuln/detail/CVE-2023-21554)

---



---

## POC #3

**来源**: [CVE-2023-21554-leongxudong_MSMQ-Vulnerability.md](../2023/CVE-2023-21554-leongxudong_MSMQ-Vulnerability.md)

## CVE-2023-21554 - Microsoft Message Queuing (MSMQ) 远程代码执行漏洞

**漏洞编号:** CVE-2023-21554

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Message Queuing (MSMQ)

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** 受影响的Windows版本详见CVE信息

**利用条件:** 目标系统需要启用并运行MSMQ服务，且攻击者能够访问目标机器的1801端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-21554是一个Microsoft Message Queuing (MSMQ)服务中的远程代码执行漏洞。攻击者可以通过向MSMQ服务发送特制的恶意消息，利用该漏洞在目标系统上执行任意代码。\n\n**有效性分析：**\n根据提供的漏洞信息和利用代码，该漏洞的PoC是可用的。PoC代码（poc.py）通过socket连接目标IP地址的1801端口，然后发送一系列预先准备好的二进制数据包（establish_connection.bin, connection_parameters.bin, user_message.bin）。这些数据包模拟了MSMQ的通信过程，利用了协议解析中的漏洞。攻击者需要根据实际情况修改PoC中的IP地址，并确保相应的数据文件存在。从3tternp的代码库修改而来，降低了投毒的可能性。\n\n**投毒风险分析：**\n虽然PoC代码本身看起来直接利用漏洞，但仍然存在一定的投毒风险。PoC代码依赖于外部二进制文件（.bin文件）。如果这些文件被替换为包含恶意代码的版本，攻击者可以通过该PoC执行任意代码。因此，在运行PoC之前，务必验证这些二进制文件的来源和完整性。通过分析PoC代码，发现其主要功能是发送预先制作好的数据包。如果这些数据包被修改为包含恶意指令，可能导致不可预测的行为。根据文件来源和代码分析，投毒风险估计为10%。\n\n**利用方式分析：**\n1.  **环境准备：** 攻击者需要安装Python，并获取PoC代码和相关的数据文件。\n2.  **目标确定：** 攻击者需要确定目标机器的IP地址，并且目标机器需要运行MSMQ服务。\n3.  **PoC配置：** 攻击者需要修改PoC代码中的IP地址，指向目标机器。\n4.  **漏洞触发：** 攻击者运行PoC代码，PoC代码会连接目标机器的1801端口，并发送恶意消息。\n5.  **代码执行：** 如果漏洞利用成功，攻击者可以在目标机器上执行任意代码。通常，攻击者会利用该漏洞来安装后门程序或执行其他恶意操作。\n\n**缓解措施：**\n1.  及时安装Microsoft提供的安全补丁。\n2.  禁用不需要的MSMQ服务。\n3.  限制MSMQ服务的访问权限。\n4.  使用防火墙阻止对1801端口的未授权访问。\n5.  监控MSMQ服务的异常行为。

**项目地址:** [leongxudong/MSMQ-Vulnerability](https://github.com/leongxudong/MSMQ-Vulnerability)

**漏洞详情:** [CVE-2023-21554](https://nvd.nist.gov/vuln/detail/CVE-2023-21554)

---

## POC #4

**来源**: [CVE-2023-21554-shootweb_CVE-2023-21554.md](../2023/CVE-2023-21554-shootweb_CVE-2023-21554.md)

## CVE-2023-21554-MSMQ远程代码执行

**漏洞编号:** CVE-2023-21554

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Message Queuing (MSMQ)

**危害等级:** 高危，可被未经身份验证的攻击者利用

**影响版本:** 受影响的Windows版本范围广泛，具体请参考CVE信息

**利用条件:** 目标系统需要运行MSMQ服务，且攻击者需要能够访问MSMQ的端口（通常是1801）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-21554 是 Microsoft Message Queuing (MSMQ) 中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过网络发送特制的恶意消息到 MSMQ 服务器，从而在目标系统上执行任意代码。  

**漏洞利用分析：**

提供的 Python 脚本 (poc_check.py) 并非直接利用该漏洞执行代码，而是一个辅助工具，用于测试攻击流程的各个阶段，帮助分析和调试漏洞利用过程。该脚本分阶段发送预定义的数据包（"establish_connection.bin"、"connection_parameters.bin"、"user_message.bin"）到目标 MSMQ 服务器，并捕获服务器的响应。

*   **连接建立阶段 (establish_connection.bin)：**  建立与目标 MSMQ 服务器的 TCP 连接。
*   **连接参数协商阶段 (connection_parameters.bin)：**  发送连接参数，这可能包含触发漏洞的关键数据。
*   **用户消息发送阶段 (user_message.bin)：**  发送包含恶意负载的用户消息。

该脚本会打印服务器的响应、连接状态以及任何异常情况，这有助于确定漏洞利用是否成功。

**有效性：**

该脚本的目的是验证漏洞的存在，而不是完整的漏洞利用，如果配合正确的二进制payload文件，脚本可以成功触发漏洞。

**投毒风险：**

从提供的代码来看，投毒风险较低。脚本本身没有明显的恶意行为，只是一个测试工具。主要的风险在于以下几点：

*   **依赖的二进制文件：** `establish_connection.bin`、`connection_parameters.bin`、`user_message.bin` 这些二进制文件的内容是未知的，如果这些文件被篡改，包含恶意代码，则可能存在投毒风险。但是这个风险较低，因为漏洞利用脚本需要配合漏洞本身的利用链，如果随意投毒，导致利用链断裂，就无法达到攻击的目的，所以这个仓库中投毒的可能性较低。

*   **服务器端漏洞利用：**  最终的远程代码执行依赖于服务器端 MSMQ 服务的漏洞。如果攻击者修改服务器端的 MSMQ 服务代码，使其包含后门，则可能存在投毒风险，但这与此代码仓库无关。

所以，综合来看，此代码仓库本身存在投毒的概率较低，估算为 5%。

**利用方式：**

1.  使用 poc_check.py 脚本，按顺序发送 establish_connection.bin, connection_parameters.bin, user_message.bin 这三个文件。
2.  脚本可以诊断每个阶段的连接状态，发送的数据，以及服务器的响应信息，可以协助漏洞研究人员分析漏洞成因，构造合适的利用数据，最终实现远程代码执行。

根据漏洞库信息，利用该漏洞需要精心构造 MSMQ 消息，利用不当的输入验证缺陷来执行恶意代码。具体利用方式可能涉及缓冲区溢出、类型混淆或其他内存破坏技术。


**项目地址:** [shootweb/CVE-2023-21554](https://github.com/shootweb/CVE-2023-21554)

**漏洞详情:** [CVE-2023-21554](https://nvd.nist.gov/vuln/detail/CVE-2023-21554)

---

## POC #5

**来源**: [CVE-2023-21554-zoemurmure_CVE-2023-21554-PoC.md](../2023/CVE-2023-21554-zoemurmure_CVE-2023-21554-PoC.md)

## CVE-2023-21554-Microsoft Message Queuing (MSMQ) Remote Code Execution Vulnerability

**漏洞编号:** CVE-2023-21554

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Message Queuing (MSMQ)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 目标系统已启用MSMQ服务，且攻击者能够与MSMQ服务端口(通常是1801)建立连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2023-21554是Microsoft Message Queuing (MSMQ) 远程代码执行漏洞。提供的PoC代码尝试利用此漏洞。以下是详细分析：

**1. 有效性：**
根据README.md，PoC成功的标志是`mqsvc.exe`进程的崩溃。PoC代码通过socket连接到目标机器的1801端口(MSMQ默认端口)，然后发送一系列预先准备好的二进制数据包，包括连接建立请求 (`establish_connection.bin`)、连接参数 (`connection_parameters.bin`) 和包含漏洞触发数据的用户消息 (`user_message.bin`)。如果目标系统存在漏洞，则`mqsvc.exe`进程会崩溃，表明利用成功。根据文档，`mqsvc.exe`进程的崩溃而非弹窗是成功利用的标志。

**2. 投毒风险：**
分析PoC代码后，没有发现明显的投毒代码。代码的目的是发送一系列二进制文件到MSMQ服务，触发漏洞导致服务崩溃。它并没有执行任何恶意操作例如下载执行恶意程序，上传用户隐私信息等等。代码主要功能是从本地读取文件然后通过socket发送，投毒风险较低。虽然PoC代码本身尝试利用漏洞，但利用的目的是触发崩溃，而不是植入后门或其他恶意行为。因此，可以认为存在投毒代码的概率为0%。

**3. 利用方式：**
漏洞的利用方式如下：
1.  **建立连接：** PoC首先通过socket连接到目标机器的MSMQ服务端口（1801）。
2.  **发送预定义数据包：**  PoC发送一系列预定义的二进制数据包，这些数据包模拟了MSMQ客户端与服务器之间的正常通信流程，包括建立连接、设置连接参数和发送用户消息。
3.  **触发漏洞：**  `user_message.bin`包含精心构造的恶意数据，当MSMQ服务处理这些数据时，会触发漏洞，导致`mqsvc.exe`进程崩溃，可能最终导致远程代码执行。

简单来说，该漏洞是由于MSMQ服务在处理特定格式的消息时，未进行充分的输入验证，导致可以利用精心构造的消息触发漏洞，进而导致远程代码执行。

**项目地址:** [zoemurmure/CVE-2023-21554-PoC](https://github.com/zoemurmure/CVE-2023-21554-PoC)

**漏洞详情:** [CVE-2023-21554](https://nvd.nist.gov/vuln/detail/CVE-2023-21554)

---



---

## POC #3

**来源**: [CVE-2023-21554-leongxudong_MSMQ-Vulnerability.md](../2023/CVE-2023-21554-leongxudong_MSMQ-Vulnerability.md)

## CVE-2023-21554 - Microsoft Message Queuing (MSMQ) 远程代码执行漏洞

**漏洞编号:** CVE-2023-21554

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Message Queuing (MSMQ)

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** 受影响的Windows版本详见CVE信息

**利用条件:** 目标系统需要启用并运行MSMQ服务，且攻击者能够访问目标机器的1801端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-21554是一个Microsoft Message Queuing (MSMQ)服务中的远程代码执行漏洞。攻击者可以通过向MSMQ服务发送特制的恶意消息，利用该漏洞在目标系统上执行任意代码。\n\n**有效性分析：**\n根据提供的漏洞信息和利用代码，该漏洞的PoC是可用的。PoC代码（poc.py）通过socket连接目标IP地址的1801端口，然后发送一系列预先准备好的二进制数据包（establish_connection.bin, connection_parameters.bin, user_message.bin）。这些数据包模拟了MSMQ的通信过程，利用了协议解析中的漏洞。攻击者需要根据实际情况修改PoC中的IP地址，并确保相应的数据文件存在。从3tternp的代码库修改而来，降低了投毒的可能性。\n\n**投毒风险分析：**\n虽然PoC代码本身看起来直接利用漏洞，但仍然存在一定的投毒风险。PoC代码依赖于外部二进制文件（.bin文件）。如果这些文件被替换为包含恶意代码的版本，攻击者可以通过该PoC执行任意代码。因此，在运行PoC之前，务必验证这些二进制文件的来源和完整性。通过分析PoC代码，发现其主要功能是发送预先制作好的数据包。如果这些数据包被修改为包含恶意指令，可能导致不可预测的行为。根据文件来源和代码分析，投毒风险估计为10%。\n\n**利用方式分析：**\n1.  **环境准备：** 攻击者需要安装Python，并获取PoC代码和相关的数据文件。\n2.  **目标确定：** 攻击者需要确定目标机器的IP地址，并且目标机器需要运行MSMQ服务。\n3.  **PoC配置：** 攻击者需要修改PoC代码中的IP地址，指向目标机器。\n4.  **漏洞触发：** 攻击者运行PoC代码，PoC代码会连接目标机器的1801端口，并发送恶意消息。\n5.  **代码执行：** 如果漏洞利用成功，攻击者可以在目标机器上执行任意代码。通常，攻击者会利用该漏洞来安装后门程序或执行其他恶意操作。\n\n**缓解措施：**\n1.  及时安装Microsoft提供的安全补丁。\n2.  禁用不需要的MSMQ服务。\n3.  限制MSMQ服务的访问权限。\n4.  使用防火墙阻止对1801端口的未授权访问。\n5.  监控MSMQ服务的异常行为。

**项目地址:** [leongxudong/MSMQ-Vulnerability](https://github.com/leongxudong/MSMQ-Vulnerability)

**漏洞详情:** [CVE-2023-21554](https://nvd.nist.gov/vuln/detail/CVE-2023-21554)

---

## POC #4

**来源**: [CVE-2023-21554-shootweb_CVE-2023-21554.md](../2023/CVE-2023-21554-shootweb_CVE-2023-21554.md)

## CVE-2023-21554-MSMQ远程代码执行

**漏洞编号:** CVE-2023-21554

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Message Queuing (MSMQ)

**危害等级:** 高危，可被未经身份验证的攻击者利用

**影响版本:** 受影响的Windows版本范围广泛，具体请参考CVE信息

**利用条件:** 目标系统需要运行MSMQ服务，且攻击者需要能够访问MSMQ的端口（通常是1801）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-21554 是 Microsoft Message Queuing (MSMQ) 中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过网络发送特制的恶意消息到 MSMQ 服务器，从而在目标系统上执行任意代码。  

**漏洞利用分析：**

提供的 Python 脚本 (poc_check.py) 并非直接利用该漏洞执行代码，而是一个辅助工具，用于测试攻击流程的各个阶段，帮助分析和调试漏洞利用过程。该脚本分阶段发送预定义的数据包（"establish_connection.bin"、"connection_parameters.bin"、"user_message.bin"）到目标 MSMQ 服务器，并捕获服务器的响应。

*   **连接建立阶段 (establish_connection.bin)：**  建立与目标 MSMQ 服务器的 TCP 连接。
*   **连接参数协商阶段 (connection_parameters.bin)：**  发送连接参数，这可能包含触发漏洞的关键数据。
*   **用户消息发送阶段 (user_message.bin)：**  发送包含恶意负载的用户消息。

该脚本会打印服务器的响应、连接状态以及任何异常情况，这有助于确定漏洞利用是否成功。

**有效性：**

该脚本的目的是验证漏洞的存在，而不是完整的漏洞利用，如果配合正确的二进制payload文件，脚本可以成功触发漏洞。

**投毒风险：**

从提供的代码来看，投毒风险较低。脚本本身没有明显的恶意行为，只是一个测试工具。主要的风险在于以下几点：

*   **依赖的二进制文件：** `establish_connection.bin`、`connection_parameters.bin`、`user_message.bin` 这些二进制文件的内容是未知的，如果这些文件被篡改，包含恶意代码，则可能存在投毒风险。但是这个风险较低，因为漏洞利用脚本需要配合漏洞本身的利用链，如果随意投毒，导致利用链断裂，就无法达到攻击的目的，所以这个仓库中投毒的可能性较低。

*   **服务器端漏洞利用：**  最终的远程代码执行依赖于服务器端 MSMQ 服务的漏洞。如果攻击者修改服务器端的 MSMQ 服务代码，使其包含后门，则可能存在投毒风险，但这与此代码仓库无关。

所以，综合来看，此代码仓库本身存在投毒的概率较低，估算为 5%。

**利用方式：**

1.  使用 poc_check.py 脚本，按顺序发送 establish_connection.bin, connection_parameters.bin, user_message.bin 这三个文件。
2.  脚本可以诊断每个阶段的连接状态，发送的数据，以及服务器的响应信息，可以协助漏洞研究人员分析漏洞成因，构造合适的利用数据，最终实现远程代码执行。

根据漏洞库信息，利用该漏洞需要精心构造 MSMQ 消息，利用不当的输入验证缺陷来执行恶意代码。具体利用方式可能涉及缓冲区溢出、类型混淆或其他内存破坏技术。


**项目地址:** [shootweb/CVE-2023-21554](https://github.com/shootweb/CVE-2023-21554)

**漏洞详情:** [CVE-2023-21554](https://nvd.nist.gov/vuln/detail/CVE-2023-21554)

---

## POC #5

**来源**: [CVE-2023-21554-zoemurmure_CVE-2023-21554-PoC.md](../2023/CVE-2023-21554-zoemurmure_CVE-2023-21554-PoC.md)

## CVE-2023-21554-Microsoft Message Queuing (MSMQ) Remote Code Execution Vulnerability

**漏洞编号:** CVE-2023-21554

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Message Queuing (MSMQ)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 目标系统已启用MSMQ服务，且攻击者能够与MSMQ服务端口(通常是1801)建立连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2023-21554是Microsoft Message Queuing (MSMQ) 远程代码执行漏洞。提供的PoC代码尝试利用此漏洞。以下是详细分析：

**1. 有效性：**
根据README.md，PoC成功的标志是`mqsvc.exe`进程的崩溃。PoC代码通过socket连接到目标机器的1801端口(MSMQ默认端口)，然后发送一系列预先准备好的二进制数据包，包括连接建立请求 (`establish_connection.bin`)、连接参数 (`connection_parameters.bin`) 和包含漏洞触发数据的用户消息 (`user_message.bin`)。如果目标系统存在漏洞，则`mqsvc.exe`进程会崩溃，表明利用成功。根据文档，`mqsvc.exe`进程的崩溃而非弹窗是成功利用的标志。

**2. 投毒风险：**
分析PoC代码后，没有发现明显的投毒代码。代码的目的是发送一系列二进制文件到MSMQ服务，触发漏洞导致服务崩溃。它并没有执行任何恶意操作例如下载执行恶意程序，上传用户隐私信息等等。代码主要功能是从本地读取文件然后通过socket发送，投毒风险较低。虽然PoC代码本身尝试利用漏洞，但利用的目的是触发崩溃，而不是植入后门或其他恶意行为。因此，可以认为存在投毒代码的概率为0%。

**3. 利用方式：**
漏洞的利用方式如下：
1.  **建立连接：** PoC首先通过socket连接到目标机器的MSMQ服务端口（1801）。
2.  **发送预定义数据包：**  PoC发送一系列预定义的二进制数据包，这些数据包模拟了MSMQ客户端与服务器之间的正常通信流程，包括建立连接、设置连接参数和发送用户消息。
3.  **触发漏洞：**  `user_message.bin`包含精心构造的恶意数据，当MSMQ服务处理这些数据时，会触发漏洞，导致`mqsvc.exe`进程崩溃，可能最终导致远程代码执行。

简单来说，该漏洞是由于MSMQ服务在处理特定格式的消息时，未进行充分的输入验证，导致可以利用精心构造的消息触发漏洞，进而导致远程代码执行。

**项目地址:** [zoemurmure/CVE-2023-21554-PoC](https://github.com/zoemurmure/CVE-2023-21554-PoC)

**漏洞详情:** [CVE-2023-21554](https://nvd.nist.gov/vuln/detail/CVE-2023-21554)

---



---

## POC #3

**来源**: [CVE-2023-21554-leongxudong_MSMQ-Vulnerability.md](../2023/CVE-2023-21554-leongxudong_MSMQ-Vulnerability.md)

## CVE-2023-21554 - Microsoft Message Queuing (MSMQ) 远程代码执行漏洞

**漏洞编号:** CVE-2023-21554

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Message Queuing (MSMQ)

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** 受影响的Windows版本详见CVE信息

**利用条件:** 目标系统需要启用并运行MSMQ服务，且攻击者能够访问目标机器的1801端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-21554是一个Microsoft Message Queuing (MSMQ)服务中的远程代码执行漏洞。攻击者可以通过向MSMQ服务发送特制的恶意消息，利用该漏洞在目标系统上执行任意代码。\n\n**有效性分析：**\n根据提供的漏洞信息和利用代码，该漏洞的PoC是可用的。PoC代码（poc.py）通过socket连接目标IP地址的1801端口，然后发送一系列预先准备好的二进制数据包（establish_connection.bin, connection_parameters.bin, user_message.bin）。这些数据包模拟了MSMQ的通信过程，利用了协议解析中的漏洞。攻击者需要根据实际情况修改PoC中的IP地址，并确保相应的数据文件存在。从3tternp的代码库修改而来，降低了投毒的可能性。\n\n**投毒风险分析：**\n虽然PoC代码本身看起来直接利用漏洞，但仍然存在一定的投毒风险。PoC代码依赖于外部二进制文件（.bin文件）。如果这些文件被替换为包含恶意代码的版本，攻击者可以通过该PoC执行任意代码。因此，在运行PoC之前，务必验证这些二进制文件的来源和完整性。通过分析PoC代码，发现其主要功能是发送预先制作好的数据包。如果这些数据包被修改为包含恶意指令，可能导致不可预测的行为。根据文件来源和代码分析，投毒风险估计为10%。\n\n**利用方式分析：**\n1.  **环境准备：** 攻击者需要安装Python，并获取PoC代码和相关的数据文件。\n2.  **目标确定：** 攻击者需要确定目标机器的IP地址，并且目标机器需要运行MSMQ服务。\n3.  **PoC配置：** 攻击者需要修改PoC代码中的IP地址，指向目标机器。\n4.  **漏洞触发：** 攻击者运行PoC代码，PoC代码会连接目标机器的1801端口，并发送恶意消息。\n5.  **代码执行：** 如果漏洞利用成功，攻击者可以在目标机器上执行任意代码。通常，攻击者会利用该漏洞来安装后门程序或执行其他恶意操作。\n\n**缓解措施：**\n1.  及时安装Microsoft提供的安全补丁。\n2.  禁用不需要的MSMQ服务。\n3.  限制MSMQ服务的访问权限。\n4.  使用防火墙阻止对1801端口的未授权访问。\n5.  监控MSMQ服务的异常行为。

**项目地址:** [leongxudong/MSMQ-Vulnerability](https://github.com/leongxudong/MSMQ-Vulnerability)

**漏洞详情:** [CVE-2023-21554](https://nvd.nist.gov/vuln/detail/CVE-2023-21554)

---

## POC #4

**来源**: [CVE-2023-21554-shootweb_CVE-2023-21554.md](../2023/CVE-2023-21554-shootweb_CVE-2023-21554.md)

## CVE-2023-21554-MSMQ远程代码执行

**漏洞编号:** CVE-2023-21554

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Message Queuing (MSMQ)

**危害等级:** 高危，可被未经身份验证的攻击者利用

**影响版本:** 受影响的Windows版本范围广泛，具体请参考CVE信息

**利用条件:** 目标系统需要运行MSMQ服务，且攻击者需要能够访问MSMQ的端口（通常是1801）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-21554 是 Microsoft Message Queuing (MSMQ) 中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过网络发送特制的恶意消息到 MSMQ 服务器，从而在目标系统上执行任意代码。  

**漏洞利用分析：**

提供的 Python 脚本 (poc_check.py) 并非直接利用该漏洞执行代码，而是一个辅助工具，用于测试攻击流程的各个阶段，帮助分析和调试漏洞利用过程。该脚本分阶段发送预定义的数据包（"establish_connection.bin"、"connection_parameters.bin"、"user_message.bin"）到目标 MSMQ 服务器，并捕获服务器的响应。

*   **连接建立阶段 (establish_connection.bin)：**  建立与目标 MSMQ 服务器的 TCP 连接。
*   **连接参数协商阶段 (connection_parameters.bin)：**  发送连接参数，这可能包含触发漏洞的关键数据。
*   **用户消息发送阶段 (user_message.bin)：**  发送包含恶意负载的用户消息。

该脚本会打印服务器的响应、连接状态以及任何异常情况，这有助于确定漏洞利用是否成功。

**有效性：**

该脚本的目的是验证漏洞的存在，而不是完整的漏洞利用，如果配合正确的二进制payload文件，脚本可以成功触发漏洞。

**投毒风险：**

从提供的代码来看，投毒风险较低。脚本本身没有明显的恶意行为，只是一个测试工具。主要的风险在于以下几点：

*   **依赖的二进制文件：** `establish_connection.bin`、`connection_parameters.bin`、`user_message.bin` 这些二进制文件的内容是未知的，如果这些文件被篡改，包含恶意代码，则可能存在投毒风险。但是这个风险较低，因为漏洞利用脚本需要配合漏洞本身的利用链，如果随意投毒，导致利用链断裂，就无法达到攻击的目的，所以这个仓库中投毒的可能性较低。

*   **服务器端漏洞利用：**  最终的远程代码执行依赖于服务器端 MSMQ 服务的漏洞。如果攻击者修改服务器端的 MSMQ 服务代码，使其包含后门，则可能存在投毒风险，但这与此代码仓库无关。

所以，综合来看，此代码仓库本身存在投毒的概率较低，估算为 5%。

**利用方式：**

1.  使用 poc_check.py 脚本，按顺序发送 establish_connection.bin, connection_parameters.bin, user_message.bin 这三个文件。
2.  脚本可以诊断每个阶段的连接状态，发送的数据，以及服务器的响应信息，可以协助漏洞研究人员分析漏洞成因，构造合适的利用数据，最终实现远程代码执行。

根据漏洞库信息，利用该漏洞需要精心构造 MSMQ 消息，利用不当的输入验证缺陷来执行恶意代码。具体利用方式可能涉及缓冲区溢出、类型混淆或其他内存破坏技术。


**项目地址:** [shootweb/CVE-2023-21554](https://github.com/shootweb/CVE-2023-21554)

**漏洞详情:** [CVE-2023-21554](https://nvd.nist.gov/vuln/detail/CVE-2023-21554)

---

## POC #5

**来源**: [CVE-2023-21554-zoemurmure_CVE-2023-21554-PoC.md](../2023/CVE-2023-21554-zoemurmure_CVE-2023-21554-PoC.md)

## CVE-2023-21554-Microsoft Message Queuing (MSMQ) Remote Code Execution Vulnerability

**漏洞编号:** CVE-2023-21554

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Message Queuing (MSMQ)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 目标系统已启用MSMQ服务，且攻击者能够与MSMQ服务端口(通常是1801)建立连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2023-21554是Microsoft Message Queuing (MSMQ) 远程代码执行漏洞。提供的PoC代码尝试利用此漏洞。以下是详细分析：

**1. 有效性：**
根据README.md，PoC成功的标志是`mqsvc.exe`进程的崩溃。PoC代码通过socket连接到目标机器的1801端口(MSMQ默认端口)，然后发送一系列预先准备好的二进制数据包，包括连接建立请求 (`establish_connection.bin`)、连接参数 (`connection_parameters.bin`) 和包含漏洞触发数据的用户消息 (`user_message.bin`)。如果目标系统存在漏洞，则`mqsvc.exe`进程会崩溃，表明利用成功。根据文档，`mqsvc.exe`进程的崩溃而非弹窗是成功利用的标志。

**2. 投毒风险：**
分析PoC代码后，没有发现明显的投毒代码。代码的目的是发送一系列二进制文件到MSMQ服务，触发漏洞导致服务崩溃。它并没有执行任何恶意操作例如下载执行恶意程序，上传用户隐私信息等等。代码主要功能是从本地读取文件然后通过socket发送，投毒风险较低。虽然PoC代码本身尝试利用漏洞，但利用的目的是触发崩溃，而不是植入后门或其他恶意行为。因此，可以认为存在投毒代码的概率为0%。

**3. 利用方式：**
漏洞的利用方式如下：
1.  **建立连接：** PoC首先通过socket连接到目标机器的MSMQ服务端口（1801）。
2.  **发送预定义数据包：**  PoC发送一系列预定义的二进制数据包，这些数据包模拟了MSMQ客户端与服务器之间的正常通信流程，包括建立连接、设置连接参数和发送用户消息。
3.  **触发漏洞：**  `user_message.bin`包含精心构造的恶意数据，当MSMQ服务处理这些数据时，会触发漏洞，导致`mqsvc.exe`进程崩溃，可能最终导致远程代码执行。

简单来说，该漏洞是由于MSMQ服务在处理特定格式的消息时，未进行充分的输入验证，导致可以利用精心构造的消息触发漏洞，进而导致远程代码执行。

**项目地址:** [zoemurmure/CVE-2023-21554-PoC](https://github.com/zoemurmure/CVE-2023-21554-PoC)

**漏洞详情:** [CVE-2023-21554](https://nvd.nist.gov/vuln/detail/CVE-2023-21554)

---

