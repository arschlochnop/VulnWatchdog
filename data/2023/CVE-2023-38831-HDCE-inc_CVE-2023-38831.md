# CVE-2023-38831

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-38831-FirFirdaus_CVE-2023-38831.md](../2023/CVE-2023-38831-FirFirdaus_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开特制的ZIP或RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 存在于 WinRAR 6.23 之前的版本中。该漏洞允许攻击者通过创建一个包含恶意构造的 ZIP 压缩包，在用户尝试访问压缩包内的良性文件时执行任意代码。该ZIP压缩包包含一个良性文件（如 .JPG 文件）以及一个与该良性文件同名的文件夹。WinRAR 在处理压缩包时，会错误地执行该文件夹内的恶意代码。

**有效性：**
根据漏洞信息、搜索结果以及提供的 POC 代码，此漏洞是有效的。多个信息源表明该漏洞已被野外利用，POC代码描述了如何利用该漏洞。

**投毒风险：**
提供的POC代码主要包含以下文件：
*   `document.pdf` (诱饵文件)
*   `exploit.py` (漏洞利用 Python 脚本)
*   `script.bat` (恶意脚本)

`exploit.py` 脚本负责生成恶意的 RAR 文件，`script.bat` 包含实际要执行的命令。 投毒风险较低，主要体现在以下几个方面：

1.  **需要用户交互：** 漏洞利用需要用户打开恶意构造的 RAR 文件，并尝试访问其中的诱饵文件。
2.  **依赖外部命令：** `script.bat` 脚本中使用了 `ncat` 命令来反弹 shell。如果目标系统上没有安装 `ncat`，则利用会失败。 可以通过修改`script.bat`脚本植入恶意代码，但公开的POC中，这种风险较低。
3.  **代码可读性：** 提供的代码（`exploit.py` 和 `script.bat`）相对简单，容易进行审查。但是，任何从网络下载的代码都存在一定的风险，POC作者有可能通过其他方式在压缩包中隐藏恶意代码。

考虑到以上因素，评估投毒风险为10%。

**利用方式：**
1.  **创建恶意压缩包：** 攻击者使用 `exploit.py` 脚本创建包含诱饵文件（如 PDF）和恶意脚本（如 BAT 文件）的 ZIP 或 RAR 压缩包。
2.  **欺骗用户：** 攻击者将恶意压缩包发送给受害者，诱骗其打开。
3.  **触发漏洞：** 当用户尝试使用受影响的 WinRAR 版本打开压缩包并访问诱饵文件时，WinRAR 会错误地执行与诱饵文件同名的文件夹中的恶意脚本。
4.  **执行恶意代码：** 恶意脚本在受害者系统上执行，例如反弹 shell、安装恶意软件或执行其他恶意操作。

总结：利用该漏洞的关键在于精心构造恶意压缩包，并诱骗用户打开它。一旦用户打开压缩包并触发漏洞，攻击者就可以在目标系统上执行任意代码。

**项目地址:** [FirFirdaus/CVE-2023-38831](https://github.com/FirFirdaus/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #2

**来源**: [CVE-2023-38831-HDCE-inc_CVE-2023-38831.md](../2023/CVE-2023-38831-HDCE-inc_CVE-2023-38831.md)

# CVE-2023-38831

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-38831-FirFirdaus_CVE-2023-38831.md](../2023/CVE-2023-38831-FirFirdaus_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开特制的ZIP或RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 存在于 WinRAR 6.23 之前的版本中。该漏洞允许攻击者通过创建一个包含恶意构造的 ZIP 压缩包，在用户尝试访问压缩包内的良性文件时执行任意代码。该ZIP压缩包包含一个良性文件（如 .JPG 文件）以及一个与该良性文件同名的文件夹。WinRAR 在处理压缩包时，会错误地执行该文件夹内的恶意代码。

**有效性：**
根据漏洞信息、搜索结果以及提供的 POC 代码，此漏洞是有效的。多个信息源表明该漏洞已被野外利用，POC代码描述了如何利用该漏洞。

**投毒风险：**
提供的POC代码主要包含以下文件：
*   `document.pdf` (诱饵文件)
*   `exploit.py` (漏洞利用 Python 脚本)
*   `script.bat` (恶意脚本)

`exploit.py` 脚本负责生成恶意的 RAR 文件，`script.bat` 包含实际要执行的命令。 投毒风险较低，主要体现在以下几个方面：

1.  **需要用户交互：** 漏洞利用需要用户打开恶意构造的 RAR 文件，并尝试访问其中的诱饵文件。
2.  **依赖外部命令：** `script.bat` 脚本中使用了 `ncat` 命令来反弹 shell。如果目标系统上没有安装 `ncat`，则利用会失败。 可以通过修改`script.bat`脚本植入恶意代码，但公开的POC中，这种风险较低。
3.  **代码可读性：** 提供的代码（`exploit.py` 和 `script.bat`）相对简单，容易进行审查。但是，任何从网络下载的代码都存在一定的风险，POC作者有可能通过其他方式在压缩包中隐藏恶意代码。

考虑到以上因素，评估投毒风险为10%。

**利用方式：**
1.  **创建恶意压缩包：** 攻击者使用 `exploit.py` 脚本创建包含诱饵文件（如 PDF）和恶意脚本（如 BAT 文件）的 ZIP 或 RAR 压缩包。
2.  **欺骗用户：** 攻击者将恶意压缩包发送给受害者，诱骗其打开。
3.  **触发漏洞：** 当用户尝试使用受影响的 WinRAR 版本打开压缩包并访问诱饵文件时，WinRAR 会错误地执行与诱饵文件同名的文件夹中的恶意脚本。
4.  **执行恶意代码：** 恶意脚本在受害者系统上执行，例如反弹 shell、安装恶意软件或执行其他恶意操作。

总结：利用该漏洞的关键在于精心构造恶意压缩包，并诱骗用户打开它。一旦用户打开压缩包并触发漏洞，攻击者就可以在目标系统上执行任意代码。

**项目地址:** [FirFirdaus/CVE-2023-38831](https://github.com/FirFirdaus/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #2

**来源**: [CVE-2023-38831-HDCE-inc_CVE-2023-38831.md](../2023/CVE-2023-38831-HDCE-inc_CVE-2023-38831.md)

# CVE-2023-38831

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-38831-FirFirdaus_CVE-2023-38831.md](../2023/CVE-2023-38831-FirFirdaus_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开特制的ZIP或RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 存在于 WinRAR 6.23 之前的版本中。该漏洞允许攻击者通过创建一个包含恶意构造的 ZIP 压缩包，在用户尝试访问压缩包内的良性文件时执行任意代码。该ZIP压缩包包含一个良性文件（如 .JPG 文件）以及一个与该良性文件同名的文件夹。WinRAR 在处理压缩包时，会错误地执行该文件夹内的恶意代码。

**有效性：**
根据漏洞信息、搜索结果以及提供的 POC 代码，此漏洞是有效的。多个信息源表明该漏洞已被野外利用，POC代码描述了如何利用该漏洞。

**投毒风险：**
提供的POC代码主要包含以下文件：
*   `document.pdf` (诱饵文件)
*   `exploit.py` (漏洞利用 Python 脚本)
*   `script.bat` (恶意脚本)

`exploit.py` 脚本负责生成恶意的 RAR 文件，`script.bat` 包含实际要执行的命令。 投毒风险较低，主要体现在以下几个方面：

1.  **需要用户交互：** 漏洞利用需要用户打开恶意构造的 RAR 文件，并尝试访问其中的诱饵文件。
2.  **依赖外部命令：** `script.bat` 脚本中使用了 `ncat` 命令来反弹 shell。如果目标系统上没有安装 `ncat`，则利用会失败。 可以通过修改`script.bat`脚本植入恶意代码，但公开的POC中，这种风险较低。
3.  **代码可读性：** 提供的代码（`exploit.py` 和 `script.bat`）相对简单，容易进行审查。但是，任何从网络下载的代码都存在一定的风险，POC作者有可能通过其他方式在压缩包中隐藏恶意代码。

考虑到以上因素，评估投毒风险为10%。

**利用方式：**
1.  **创建恶意压缩包：** 攻击者使用 `exploit.py` 脚本创建包含诱饵文件（如 PDF）和恶意脚本（如 BAT 文件）的 ZIP 或 RAR 压缩包。
2.  **欺骗用户：** 攻击者将恶意压缩包发送给受害者，诱骗其打开。
3.  **触发漏洞：** 当用户尝试使用受影响的 WinRAR 版本打开压缩包并访问诱饵文件时，WinRAR 会错误地执行与诱饵文件同名的文件夹中的恶意脚本。
4.  **执行恶意代码：** 恶意脚本在受害者系统上执行，例如反弹 shell、安装恶意软件或执行其他恶意操作。

总结：利用该漏洞的关键在于精心构造恶意压缩包，并诱骗用户打开它。一旦用户打开压缩包并触发漏洞，攻击者就可以在目标系统上执行任意代码。

**项目地址:** [FirFirdaus/CVE-2023-38831](https://github.com/FirFirdaus/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #2

**来源**: [CVE-2023-38831-HDCE-inc_CVE-2023-38831.md](../2023/CVE-2023-38831-HDCE-inc_CVE-2023-38831.md)

# CVE-2023-38831

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-38831-FirFirdaus_CVE-2023-38831.md](../2023/CVE-2023-38831-FirFirdaus_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开特制的ZIP或RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 存在于 WinRAR 6.23 之前的版本中。该漏洞允许攻击者通过创建一个包含恶意构造的 ZIP 压缩包，在用户尝试访问压缩包内的良性文件时执行任意代码。该ZIP压缩包包含一个良性文件（如 .JPG 文件）以及一个与该良性文件同名的文件夹。WinRAR 在处理压缩包时，会错误地执行该文件夹内的恶意代码。

**有效性：**
根据漏洞信息、搜索结果以及提供的 POC 代码，此漏洞是有效的。多个信息源表明该漏洞已被野外利用，POC代码描述了如何利用该漏洞。

**投毒风险：**
提供的POC代码主要包含以下文件：
*   `document.pdf` (诱饵文件)
*   `exploit.py` (漏洞利用 Python 脚本)
*   `script.bat` (恶意脚本)

`exploit.py` 脚本负责生成恶意的 RAR 文件，`script.bat` 包含实际要执行的命令。 投毒风险较低，主要体现在以下几个方面：

1.  **需要用户交互：** 漏洞利用需要用户打开恶意构造的 RAR 文件，并尝试访问其中的诱饵文件。
2.  **依赖外部命令：** `script.bat` 脚本中使用了 `ncat` 命令来反弹 shell。如果目标系统上没有安装 `ncat`，则利用会失败。 可以通过修改`script.bat`脚本植入恶意代码，但公开的POC中，这种风险较低。
3.  **代码可读性：** 提供的代码（`exploit.py` 和 `script.bat`）相对简单，容易进行审查。但是，任何从网络下载的代码都存在一定的风险，POC作者有可能通过其他方式在压缩包中隐藏恶意代码。

考虑到以上因素，评估投毒风险为10%。

**利用方式：**
1.  **创建恶意压缩包：** 攻击者使用 `exploit.py` 脚本创建包含诱饵文件（如 PDF）和恶意脚本（如 BAT 文件）的 ZIP 或 RAR 压缩包。
2.  **欺骗用户：** 攻击者将恶意压缩包发送给受害者，诱骗其打开。
3.  **触发漏洞：** 当用户尝试使用受影响的 WinRAR 版本打开压缩包并访问诱饵文件时，WinRAR 会错误地执行与诱饵文件同名的文件夹中的恶意脚本。
4.  **执行恶意代码：** 恶意脚本在受害者系统上执行，例如反弹 shell、安装恶意软件或执行其他恶意操作。

总结：利用该漏洞的关键在于精心构造恶意压缩包，并诱骗用户打开它。一旦用户打开压缩包并触发漏洞，攻击者就可以在目标系统上执行任意代码。

**项目地址:** [FirFirdaus/CVE-2023-38831](https://github.com/FirFirdaus/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #2

**来源**: [CVE-2023-38831-HDCE-inc_CVE-2023-38831.md](../2023/CVE-2023-38831-HDCE-inc_CVE-2023-38831.md)

# CVE-2023-38831

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-38831-FirFirdaus_CVE-2023-38831.md](../2023/CVE-2023-38831-FirFirdaus_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开特制的ZIP或RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 存在于 WinRAR 6.23 之前的版本中。该漏洞允许攻击者通过创建一个包含恶意构造的 ZIP 压缩包，在用户尝试访问压缩包内的良性文件时执行任意代码。该ZIP压缩包包含一个良性文件（如 .JPG 文件）以及一个与该良性文件同名的文件夹。WinRAR 在处理压缩包时，会错误地执行该文件夹内的恶意代码。

**有效性：**
根据漏洞信息、搜索结果以及提供的 POC 代码，此漏洞是有效的。多个信息源表明该漏洞已被野外利用，POC代码描述了如何利用该漏洞。

**投毒风险：**
提供的POC代码主要包含以下文件：
*   `document.pdf` (诱饵文件)
*   `exploit.py` (漏洞利用 Python 脚本)
*   `script.bat` (恶意脚本)

`exploit.py` 脚本负责生成恶意的 RAR 文件，`script.bat` 包含实际要执行的命令。 投毒风险较低，主要体现在以下几个方面：

1.  **需要用户交互：** 漏洞利用需要用户打开恶意构造的 RAR 文件，并尝试访问其中的诱饵文件。
2.  **依赖外部命令：** `script.bat` 脚本中使用了 `ncat` 命令来反弹 shell。如果目标系统上没有安装 `ncat`，则利用会失败。 可以通过修改`script.bat`脚本植入恶意代码，但公开的POC中，这种风险较低。
3.  **代码可读性：** 提供的代码（`exploit.py` 和 `script.bat`）相对简单，容易进行审查。但是，任何从网络下载的代码都存在一定的风险，POC作者有可能通过其他方式在压缩包中隐藏恶意代码。

考虑到以上因素，评估投毒风险为10%。

**利用方式：**
1.  **创建恶意压缩包：** 攻击者使用 `exploit.py` 脚本创建包含诱饵文件（如 PDF）和恶意脚本（如 BAT 文件）的 ZIP 或 RAR 压缩包。
2.  **欺骗用户：** 攻击者将恶意压缩包发送给受害者，诱骗其打开。
3.  **触发漏洞：** 当用户尝试使用受影响的 WinRAR 版本打开压缩包并访问诱饵文件时，WinRAR 会错误地执行与诱饵文件同名的文件夹中的恶意脚本。
4.  **执行恶意代码：** 恶意脚本在受害者系统上执行，例如反弹 shell、安装恶意软件或执行其他恶意操作。

总结：利用该漏洞的关键在于精心构造恶意压缩包，并诱骗用户打开它。一旦用户打开压缩包并触发漏洞，攻击者就可以在目标系统上执行任意代码。

**项目地址:** [FirFirdaus/CVE-2023-38831](https://github.com/FirFirdaus/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #2

**来源**: [CVE-2023-38831-HDCE-inc_CVE-2023-38831.md](../2023/CVE-2023-38831-HDCE-inc_CVE-2023-38831.md)

# CVE-2023-38831

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-38831-FirFirdaus_CVE-2023-38831.md](../2023/CVE-2023-38831-FirFirdaus_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开特制的ZIP或RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 存在于 WinRAR 6.23 之前的版本中。该漏洞允许攻击者通过创建一个包含恶意构造的 ZIP 压缩包，在用户尝试访问压缩包内的良性文件时执行任意代码。该ZIP压缩包包含一个良性文件（如 .JPG 文件）以及一个与该良性文件同名的文件夹。WinRAR 在处理压缩包时，会错误地执行该文件夹内的恶意代码。

**有效性：**
根据漏洞信息、搜索结果以及提供的 POC 代码，此漏洞是有效的。多个信息源表明该漏洞已被野外利用，POC代码描述了如何利用该漏洞。

**投毒风险：**
提供的POC代码主要包含以下文件：
*   `document.pdf` (诱饵文件)
*   `exploit.py` (漏洞利用 Python 脚本)
*   `script.bat` (恶意脚本)

`exploit.py` 脚本负责生成恶意的 RAR 文件，`script.bat` 包含实际要执行的命令。 投毒风险较低，主要体现在以下几个方面：

1.  **需要用户交互：** 漏洞利用需要用户打开恶意构造的 RAR 文件，并尝试访问其中的诱饵文件。
2.  **依赖外部命令：** `script.bat` 脚本中使用了 `ncat` 命令来反弹 shell。如果目标系统上没有安装 `ncat`，则利用会失败。 可以通过修改`script.bat`脚本植入恶意代码，但公开的POC中，这种风险较低。
3.  **代码可读性：** 提供的代码（`exploit.py` 和 `script.bat`）相对简单，容易进行审查。但是，任何从网络下载的代码都存在一定的风险，POC作者有可能通过其他方式在压缩包中隐藏恶意代码。

考虑到以上因素，评估投毒风险为10%。

**利用方式：**
1.  **创建恶意压缩包：** 攻击者使用 `exploit.py` 脚本创建包含诱饵文件（如 PDF）和恶意脚本（如 BAT 文件）的 ZIP 或 RAR 压缩包。
2.  **欺骗用户：** 攻击者将恶意压缩包发送给受害者，诱骗其打开。
3.  **触发漏洞：** 当用户尝试使用受影响的 WinRAR 版本打开压缩包并访问诱饵文件时，WinRAR 会错误地执行与诱饵文件同名的文件夹中的恶意脚本。
4.  **执行恶意代码：** 恶意脚本在受害者系统上执行，例如反弹 shell、安装恶意软件或执行其他恶意操作。

总结：利用该漏洞的关键在于精心构造恶意压缩包，并诱骗用户打开它。一旦用户打开压缩包并触发漏洞，攻击者就可以在目标系统上执行任意代码。

**项目地址:** [FirFirdaus/CVE-2023-38831](https://github.com/FirFirdaus/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #2

**来源**: [CVE-2023-38831-HDCE-inc_CVE-2023-38831.md](../2023/CVE-2023-38831-HDCE-inc_CVE-2023-38831.md)

# CVE-2023-38831

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-38831-FirFirdaus_CVE-2023-38831.md](../2023/CVE-2023-38831-FirFirdaus_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开特制的ZIP或RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 存在于 WinRAR 6.23 之前的版本中。该漏洞允许攻击者通过创建一个包含恶意构造的 ZIP 压缩包，在用户尝试访问压缩包内的良性文件时执行任意代码。该ZIP压缩包包含一个良性文件（如 .JPG 文件）以及一个与该良性文件同名的文件夹。WinRAR 在处理压缩包时，会错误地执行该文件夹内的恶意代码。

**有效性：**
根据漏洞信息、搜索结果以及提供的 POC 代码，此漏洞是有效的。多个信息源表明该漏洞已被野外利用，POC代码描述了如何利用该漏洞。

**投毒风险：**
提供的POC代码主要包含以下文件：
*   `document.pdf` (诱饵文件)
*   `exploit.py` (漏洞利用 Python 脚本)
*   `script.bat` (恶意脚本)

`exploit.py` 脚本负责生成恶意的 RAR 文件，`script.bat` 包含实际要执行的命令。 投毒风险较低，主要体现在以下几个方面：

1.  **需要用户交互：** 漏洞利用需要用户打开恶意构造的 RAR 文件，并尝试访问其中的诱饵文件。
2.  **依赖外部命令：** `script.bat` 脚本中使用了 `ncat` 命令来反弹 shell。如果目标系统上没有安装 `ncat`，则利用会失败。 可以通过修改`script.bat`脚本植入恶意代码，但公开的POC中，这种风险较低。
3.  **代码可读性：** 提供的代码（`exploit.py` 和 `script.bat`）相对简单，容易进行审查。但是，任何从网络下载的代码都存在一定的风险，POC作者有可能通过其他方式在压缩包中隐藏恶意代码。

考虑到以上因素，评估投毒风险为10%。

**利用方式：**
1.  **创建恶意压缩包：** 攻击者使用 `exploit.py` 脚本创建包含诱饵文件（如 PDF）和恶意脚本（如 BAT 文件）的 ZIP 或 RAR 压缩包。
2.  **欺骗用户：** 攻击者将恶意压缩包发送给受害者，诱骗其打开。
3.  **触发漏洞：** 当用户尝试使用受影响的 WinRAR 版本打开压缩包并访问诱饵文件时，WinRAR 会错误地执行与诱饵文件同名的文件夹中的恶意脚本。
4.  **执行恶意代码：** 恶意脚本在受害者系统上执行，例如反弹 shell、安装恶意软件或执行其他恶意操作。

总结：利用该漏洞的关键在于精心构造恶意压缩包，并诱骗用户打开它。一旦用户打开压缩包并触发漏洞，攻击者就可以在目标系统上执行任意代码。

**项目地址:** [FirFirdaus/CVE-2023-38831](https://github.com/FirFirdaus/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #2

**来源**: [CVE-2023-38831-HDCE-inc_CVE-2023-38831.md](../2023/CVE-2023-38831-HDCE-inc_CVE-2023-38831.md)

# CVE-2023-38831

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-38831-FirFirdaus_CVE-2023-38831.md](../2023/CVE-2023-38831-FirFirdaus_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开特制的ZIP或RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 存在于 WinRAR 6.23 之前的版本中。该漏洞允许攻击者通过创建一个包含恶意构造的 ZIP 压缩包，在用户尝试访问压缩包内的良性文件时执行任意代码。该ZIP压缩包包含一个良性文件（如 .JPG 文件）以及一个与该良性文件同名的文件夹。WinRAR 在处理压缩包时，会错误地执行该文件夹内的恶意代码。

**有效性：**
根据漏洞信息、搜索结果以及提供的 POC 代码，此漏洞是有效的。多个信息源表明该漏洞已被野外利用，POC代码描述了如何利用该漏洞。

**投毒风险：**
提供的POC代码主要包含以下文件：
*   `document.pdf` (诱饵文件)
*   `exploit.py` (漏洞利用 Python 脚本)
*   `script.bat` (恶意脚本)

`exploit.py` 脚本负责生成恶意的 RAR 文件，`script.bat` 包含实际要执行的命令。 投毒风险较低，主要体现在以下几个方面：

1.  **需要用户交互：** 漏洞利用需要用户打开恶意构造的 RAR 文件，并尝试访问其中的诱饵文件。
2.  **依赖外部命令：** `script.bat` 脚本中使用了 `ncat` 命令来反弹 shell。如果目标系统上没有安装 `ncat`，则利用会失败。 可以通过修改`script.bat`脚本植入恶意代码，但公开的POC中，这种风险较低。
3.  **代码可读性：** 提供的代码（`exploit.py` 和 `script.bat`）相对简单，容易进行审查。但是，任何从网络下载的代码都存在一定的风险，POC作者有可能通过其他方式在压缩包中隐藏恶意代码。

考虑到以上因素，评估投毒风险为10%。

**利用方式：**
1.  **创建恶意压缩包：** 攻击者使用 `exploit.py` 脚本创建包含诱饵文件（如 PDF）和恶意脚本（如 BAT 文件）的 ZIP 或 RAR 压缩包。
2.  **欺骗用户：** 攻击者将恶意压缩包发送给受害者，诱骗其打开。
3.  **触发漏洞：** 当用户尝试使用受影响的 WinRAR 版本打开压缩包并访问诱饵文件时，WinRAR 会错误地执行与诱饵文件同名的文件夹中的恶意脚本。
4.  **执行恶意代码：** 恶意脚本在受害者系统上执行，例如反弹 shell、安装恶意软件或执行其他恶意操作。

总结：利用该漏洞的关键在于精心构造恶意压缩包，并诱骗用户打开它。一旦用户打开压缩包并触发漏洞，攻击者就可以在目标系统上执行任意代码。

**项目地址:** [FirFirdaus/CVE-2023-38831](https://github.com/FirFirdaus/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #2

**来源**: [CVE-2023-38831-HDCE-inc_CVE-2023-38831.md](../2023/CVE-2023-38831-HDCE-inc_CVE-2023-38831.md)

# CVE-2023-38831

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-38831-FirFirdaus_CVE-2023-38831.md](../2023/CVE-2023-38831-FirFirdaus_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开特制的ZIP或RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 存在于 WinRAR 6.23 之前的版本中。该漏洞允许攻击者通过创建一个包含恶意构造的 ZIP 压缩包，在用户尝试访问压缩包内的良性文件时执行任意代码。该ZIP压缩包包含一个良性文件（如 .JPG 文件）以及一个与该良性文件同名的文件夹。WinRAR 在处理压缩包时，会错误地执行该文件夹内的恶意代码。

**有效性：**
根据漏洞信息、搜索结果以及提供的 POC 代码，此漏洞是有效的。多个信息源表明该漏洞已被野外利用，POC代码描述了如何利用该漏洞。

**投毒风险：**
提供的POC代码主要包含以下文件：
*   `document.pdf` (诱饵文件)
*   `exploit.py` (漏洞利用 Python 脚本)
*   `script.bat` (恶意脚本)

`exploit.py` 脚本负责生成恶意的 RAR 文件，`script.bat` 包含实际要执行的命令。 投毒风险较低，主要体现在以下几个方面：

1.  **需要用户交互：** 漏洞利用需要用户打开恶意构造的 RAR 文件，并尝试访问其中的诱饵文件。
2.  **依赖外部命令：** `script.bat` 脚本中使用了 `ncat` 命令来反弹 shell。如果目标系统上没有安装 `ncat`，则利用会失败。 可以通过修改`script.bat`脚本植入恶意代码，但公开的POC中，这种风险较低。
3.  **代码可读性：** 提供的代码（`exploit.py` 和 `script.bat`）相对简单，容易进行审查。但是，任何从网络下载的代码都存在一定的风险，POC作者有可能通过其他方式在压缩包中隐藏恶意代码。

考虑到以上因素，评估投毒风险为10%。

**利用方式：**
1.  **创建恶意压缩包：** 攻击者使用 `exploit.py` 脚本创建包含诱饵文件（如 PDF）和恶意脚本（如 BAT 文件）的 ZIP 或 RAR 压缩包。
2.  **欺骗用户：** 攻击者将恶意压缩包发送给受害者，诱骗其打开。
3.  **触发漏洞：** 当用户尝试使用受影响的 WinRAR 版本打开压缩包并访问诱饵文件时，WinRAR 会错误地执行与诱饵文件同名的文件夹中的恶意脚本。
4.  **执行恶意代码：** 恶意脚本在受害者系统上执行，例如反弹 shell、安装恶意软件或执行其他恶意操作。

总结：利用该漏洞的关键在于精心构造恶意压缩包，并诱骗用户打开它。一旦用户打开压缩包并触发漏洞，攻击者就可以在目标系统上执行任意代码。

**项目地址:** [FirFirdaus/CVE-2023-38831](https://github.com/FirFirdaus/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #2

**来源**: [CVE-2023-38831-HDCE-inc_CVE-2023-38831.md](../2023/CVE-2023-38831-HDCE-inc_CVE-2023-38831.md)

# CVE-2023-38831

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-38831-FirFirdaus_CVE-2023-38831.md](../2023/CVE-2023-38831-FirFirdaus_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开特制的ZIP或RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 存在于 WinRAR 6.23 之前的版本中。该漏洞允许攻击者通过创建一个包含恶意构造的 ZIP 压缩包，在用户尝试访问压缩包内的良性文件时执行任意代码。该ZIP压缩包包含一个良性文件（如 .JPG 文件）以及一个与该良性文件同名的文件夹。WinRAR 在处理压缩包时，会错误地执行该文件夹内的恶意代码。

**有效性：**
根据漏洞信息、搜索结果以及提供的 POC 代码，此漏洞是有效的。多个信息源表明该漏洞已被野外利用，POC代码描述了如何利用该漏洞。

**投毒风险：**
提供的POC代码主要包含以下文件：
*   `document.pdf` (诱饵文件)
*   `exploit.py` (漏洞利用 Python 脚本)
*   `script.bat` (恶意脚本)

`exploit.py` 脚本负责生成恶意的 RAR 文件，`script.bat` 包含实际要执行的命令。 投毒风险较低，主要体现在以下几个方面：

1.  **需要用户交互：** 漏洞利用需要用户打开恶意构造的 RAR 文件，并尝试访问其中的诱饵文件。
2.  **依赖外部命令：** `script.bat` 脚本中使用了 `ncat` 命令来反弹 shell。如果目标系统上没有安装 `ncat`，则利用会失败。 可以通过修改`script.bat`脚本植入恶意代码，但公开的POC中，这种风险较低。
3.  **代码可读性：** 提供的代码（`exploit.py` 和 `script.bat`）相对简单，容易进行审查。但是，任何从网络下载的代码都存在一定的风险，POC作者有可能通过其他方式在压缩包中隐藏恶意代码。

考虑到以上因素，评估投毒风险为10%。

**利用方式：**
1.  **创建恶意压缩包：** 攻击者使用 `exploit.py` 脚本创建包含诱饵文件（如 PDF）和恶意脚本（如 BAT 文件）的 ZIP 或 RAR 压缩包。
2.  **欺骗用户：** 攻击者将恶意压缩包发送给受害者，诱骗其打开。
3.  **触发漏洞：** 当用户尝试使用受影响的 WinRAR 版本打开压缩包并访问诱饵文件时，WinRAR 会错误地执行与诱饵文件同名的文件夹中的恶意脚本。
4.  **执行恶意代码：** 恶意脚本在受害者系统上执行，例如反弹 shell、安装恶意软件或执行其他恶意操作。

总结：利用该漏洞的关键在于精心构造恶意压缩包，并诱骗用户打开它。一旦用户打开压缩包并触发漏洞，攻击者就可以在目标系统上执行任意代码。

**项目地址:** [FirFirdaus/CVE-2023-38831](https://github.com/FirFirdaus/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #2

**来源**: [CVE-2023-38831-HDCE-inc_CVE-2023-38831.md](../2023/CVE-2023-38831-HDCE-inc_CVE-2023-38831.md)

# CVE-2023-38831

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-38831-FirFirdaus_CVE-2023-38831.md](../2023/CVE-2023-38831-FirFirdaus_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开特制的ZIP或RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 存在于 WinRAR 6.23 之前的版本中。该漏洞允许攻击者通过创建一个包含恶意构造的 ZIP 压缩包，在用户尝试访问压缩包内的良性文件时执行任意代码。该ZIP压缩包包含一个良性文件（如 .JPG 文件）以及一个与该良性文件同名的文件夹。WinRAR 在处理压缩包时，会错误地执行该文件夹内的恶意代码。

**有效性：**
根据漏洞信息、搜索结果以及提供的 POC 代码，此漏洞是有效的。多个信息源表明该漏洞已被野外利用，POC代码描述了如何利用该漏洞。

**投毒风险：**
提供的POC代码主要包含以下文件：
*   `document.pdf` (诱饵文件)
*   `exploit.py` (漏洞利用 Python 脚本)
*   `script.bat` (恶意脚本)

`exploit.py` 脚本负责生成恶意的 RAR 文件，`script.bat` 包含实际要执行的命令。 投毒风险较低，主要体现在以下几个方面：

1.  **需要用户交互：** 漏洞利用需要用户打开恶意构造的 RAR 文件，并尝试访问其中的诱饵文件。
2.  **依赖外部命令：** `script.bat` 脚本中使用了 `ncat` 命令来反弹 shell。如果目标系统上没有安装 `ncat`，则利用会失败。 可以通过修改`script.bat`脚本植入恶意代码，但公开的POC中，这种风险较低。
3.  **代码可读性：** 提供的代码（`exploit.py` 和 `script.bat`）相对简单，容易进行审查。但是，任何从网络下载的代码都存在一定的风险，POC作者有可能通过其他方式在压缩包中隐藏恶意代码。

考虑到以上因素，评估投毒风险为10%。

**利用方式：**
1.  **创建恶意压缩包：** 攻击者使用 `exploit.py` 脚本创建包含诱饵文件（如 PDF）和恶意脚本（如 BAT 文件）的 ZIP 或 RAR 压缩包。
2.  **欺骗用户：** 攻击者将恶意压缩包发送给受害者，诱骗其打开。
3.  **触发漏洞：** 当用户尝试使用受影响的 WinRAR 版本打开压缩包并访问诱饵文件时，WinRAR 会错误地执行与诱饵文件同名的文件夹中的恶意脚本。
4.  **执行恶意代码：** 恶意脚本在受害者系统上执行，例如反弹 shell、安装恶意软件或执行其他恶意操作。

总结：利用该漏洞的关键在于精心构造恶意压缩包，并诱骗用户打开它。一旦用户打开压缩包并触发漏洞，攻击者就可以在目标系统上执行任意代码。

**项目地址:** [FirFirdaus/CVE-2023-38831](https://github.com/FirFirdaus/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #2

**来源**: [CVE-2023-38831-HDCE-inc_CVE-2023-38831.md](../2023/CVE-2023-38831-HDCE-inc_CVE-2023-38831.md)

# CVE-2023-38831

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-38831-FirFirdaus_CVE-2023-38831.md](../2023/CVE-2023-38831-FirFirdaus_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开特制的ZIP或RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 存在于 WinRAR 6.23 之前的版本中。该漏洞允许攻击者通过创建一个包含恶意构造的 ZIP 压缩包，在用户尝试访问压缩包内的良性文件时执行任意代码。该ZIP压缩包包含一个良性文件（如 .JPG 文件）以及一个与该良性文件同名的文件夹。WinRAR 在处理压缩包时，会错误地执行该文件夹内的恶意代码。

**有效性：**
根据漏洞信息、搜索结果以及提供的 POC 代码，此漏洞是有效的。多个信息源表明该漏洞已被野外利用，POC代码描述了如何利用该漏洞。

**投毒风险：**
提供的POC代码主要包含以下文件：
*   `document.pdf` (诱饵文件)
*   `exploit.py` (漏洞利用 Python 脚本)
*   `script.bat` (恶意脚本)

`exploit.py` 脚本负责生成恶意的 RAR 文件，`script.bat` 包含实际要执行的命令。 投毒风险较低，主要体现在以下几个方面：

1.  **需要用户交互：** 漏洞利用需要用户打开恶意构造的 RAR 文件，并尝试访问其中的诱饵文件。
2.  **依赖外部命令：** `script.bat` 脚本中使用了 `ncat` 命令来反弹 shell。如果目标系统上没有安装 `ncat`，则利用会失败。 可以通过修改`script.bat`脚本植入恶意代码，但公开的POC中，这种风险较低。
3.  **代码可读性：** 提供的代码（`exploit.py` 和 `script.bat`）相对简单，容易进行审查。但是，任何从网络下载的代码都存在一定的风险，POC作者有可能通过其他方式在压缩包中隐藏恶意代码。

考虑到以上因素，评估投毒风险为10%。

**利用方式：**
1.  **创建恶意压缩包：** 攻击者使用 `exploit.py` 脚本创建包含诱饵文件（如 PDF）和恶意脚本（如 BAT 文件）的 ZIP 或 RAR 压缩包。
2.  **欺骗用户：** 攻击者将恶意压缩包发送给受害者，诱骗其打开。
3.  **触发漏洞：** 当用户尝试使用受影响的 WinRAR 版本打开压缩包并访问诱饵文件时，WinRAR 会错误地执行与诱饵文件同名的文件夹中的恶意脚本。
4.  **执行恶意代码：** 恶意脚本在受害者系统上执行，例如反弹 shell、安装恶意软件或执行其他恶意操作。

总结：利用该漏洞的关键在于精心构造恶意压缩包，并诱骗用户打开它。一旦用户打开压缩包并触发漏洞，攻击者就可以在目标系统上执行任意代码。

**项目地址:** [FirFirdaus/CVE-2023-38831](https://github.com/FirFirdaus/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #2

**来源**: [CVE-2023-38831-HDCE-inc_CVE-2023-38831.md](../2023/CVE-2023-38831-HDCE-inc_CVE-2023-38831.md)

# CVE-2023-38831

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-38831-FirFirdaus_CVE-2023-38831.md](../2023/CVE-2023-38831-FirFirdaus_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开特制的ZIP或RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 存在于 WinRAR 6.23 之前的版本中。该漏洞允许攻击者通过创建一个包含恶意构造的 ZIP 压缩包，在用户尝试访问压缩包内的良性文件时执行任意代码。该ZIP压缩包包含一个良性文件（如 .JPG 文件）以及一个与该良性文件同名的文件夹。WinRAR 在处理压缩包时，会错误地执行该文件夹内的恶意代码。

**有效性：**
根据漏洞信息、搜索结果以及提供的 POC 代码，此漏洞是有效的。多个信息源表明该漏洞已被野外利用，POC代码描述了如何利用该漏洞。

**投毒风险：**
提供的POC代码主要包含以下文件：
*   `document.pdf` (诱饵文件)
*   `exploit.py` (漏洞利用 Python 脚本)
*   `script.bat` (恶意脚本)

`exploit.py` 脚本负责生成恶意的 RAR 文件，`script.bat` 包含实际要执行的命令。 投毒风险较低，主要体现在以下几个方面：

1.  **需要用户交互：** 漏洞利用需要用户打开恶意构造的 RAR 文件，并尝试访问其中的诱饵文件。
2.  **依赖外部命令：** `script.bat` 脚本中使用了 `ncat` 命令来反弹 shell。如果目标系统上没有安装 `ncat`，则利用会失败。 可以通过修改`script.bat`脚本植入恶意代码，但公开的POC中，这种风险较低。
3.  **代码可读性：** 提供的代码（`exploit.py` 和 `script.bat`）相对简单，容易进行审查。但是，任何从网络下载的代码都存在一定的风险，POC作者有可能通过其他方式在压缩包中隐藏恶意代码。

考虑到以上因素，评估投毒风险为10%。

**利用方式：**
1.  **创建恶意压缩包：** 攻击者使用 `exploit.py` 脚本创建包含诱饵文件（如 PDF）和恶意脚本（如 BAT 文件）的 ZIP 或 RAR 压缩包。
2.  **欺骗用户：** 攻击者将恶意压缩包发送给受害者，诱骗其打开。
3.  **触发漏洞：** 当用户尝试使用受影响的 WinRAR 版本打开压缩包并访问诱饵文件时，WinRAR 会错误地执行与诱饵文件同名的文件夹中的恶意脚本。
4.  **执行恶意代码：** 恶意脚本在受害者系统上执行，例如反弹 shell、安装恶意软件或执行其他恶意操作。

总结：利用该漏洞的关键在于精心构造恶意压缩包，并诱骗用户打开它。一旦用户打开压缩包并触发漏洞，攻击者就可以在目标系统上执行任意代码。

**项目地址:** [FirFirdaus/CVE-2023-38831](https://github.com/FirFirdaus/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #2

**来源**: [CVE-2023-38831-HDCE-inc_CVE-2023-38831.md](../2023/CVE-2023-38831-HDCE-inc_CVE-2023-38831.md)

# CVE-2023-38831

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-38831-FirFirdaus_CVE-2023-38831.md](../2023/CVE-2023-38831-FirFirdaus_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开特制的ZIP或RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 存在于 WinRAR 6.23 之前的版本中。该漏洞允许攻击者通过创建一个包含恶意构造的 ZIP 压缩包，在用户尝试访问压缩包内的良性文件时执行任意代码。该ZIP压缩包包含一个良性文件（如 .JPG 文件）以及一个与该良性文件同名的文件夹。WinRAR 在处理压缩包时，会错误地执行该文件夹内的恶意代码。

**有效性：**
根据漏洞信息、搜索结果以及提供的 POC 代码，此漏洞是有效的。多个信息源表明该漏洞已被野外利用，POC代码描述了如何利用该漏洞。

**投毒风险：**
提供的POC代码主要包含以下文件：
*   `document.pdf` (诱饵文件)
*   `exploit.py` (漏洞利用 Python 脚本)
*   `script.bat` (恶意脚本)

`exploit.py` 脚本负责生成恶意的 RAR 文件，`script.bat` 包含实际要执行的命令。 投毒风险较低，主要体现在以下几个方面：

1.  **需要用户交互：** 漏洞利用需要用户打开恶意构造的 RAR 文件，并尝试访问其中的诱饵文件。
2.  **依赖外部命令：** `script.bat` 脚本中使用了 `ncat` 命令来反弹 shell。如果目标系统上没有安装 `ncat`，则利用会失败。 可以通过修改`script.bat`脚本植入恶意代码，但公开的POC中，这种风险较低。
3.  **代码可读性：** 提供的代码（`exploit.py` 和 `script.bat`）相对简单，容易进行审查。但是，任何从网络下载的代码都存在一定的风险，POC作者有可能通过其他方式在压缩包中隐藏恶意代码。

考虑到以上因素，评估投毒风险为10%。

**利用方式：**
1.  **创建恶意压缩包：** 攻击者使用 `exploit.py` 脚本创建包含诱饵文件（如 PDF）和恶意脚本（如 BAT 文件）的 ZIP 或 RAR 压缩包。
2.  **欺骗用户：** 攻击者将恶意压缩包发送给受害者，诱骗其打开。
3.  **触发漏洞：** 当用户尝试使用受影响的 WinRAR 版本打开压缩包并访问诱饵文件时，WinRAR 会错误地执行与诱饵文件同名的文件夹中的恶意脚本。
4.  **执行恶意代码：** 恶意脚本在受害者系统上执行，例如反弹 shell、安装恶意软件或执行其他恶意操作。

总结：利用该漏洞的关键在于精心构造恶意压缩包，并诱骗用户打开它。一旦用户打开压缩包并触发漏洞，攻击者就可以在目标系统上执行任意代码。

**项目地址:** [FirFirdaus/CVE-2023-38831](https://github.com/FirFirdaus/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #2

**来源**: [CVE-2023-38831-HDCE-inc_CVE-2023-38831.md](../2023/CVE-2023-38831-HDCE-inc_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。攻击者可以通过构造特制的ZIP压缩包来利用此漏洞。该ZIP压缩包包含一个良性文件（如.jpg）和一个同名文件夹，该文件夹内包含恶意可执行文件（如.cmd或.exe）。当用户尝试通过WinRAR打开良性文件时，WinRAR会错误地执行同名文件夹中的恶意代码。从搜索引擎结果和漏洞库信息可以看出，此漏洞在野外已被积极利用。提供的POC代码`exploit.py`通过创建包含恶意脚本的同名文件夹，并将良性文件和恶意脚本复制到相应位置，然后替换文件名中的占位符来生成恶意的RAR压缩包。该压缩包在旧版本 WinRAR 中打开时，会执行恶意脚本。从提供的代码来看，`exploit.py` 只是生成恶意的zip压缩文件，不包含任何后门或者其他恶意代码，`script.bat`只是简单的调用`calc.exe`弹出计算器程序，同样不包含投毒代码。因此，该仓库中不存在作者隐藏的投毒代码的风险。

**利用方式：**

1.  攻击者构造一个恶意的ZIP压缩包，其中包含一个良性文件（例如，`document.pdf`）和一个同名文件夹（例如，`document.pdf`）。
2.  在同名文件夹中，攻击者放置恶意可执行文件（例如，`document.pdf.cmd`或`document.pdf.exe`）。
3.  攻击者诱骗受害者使用受影响版本的WinRAR打开此ZIP压缩包。
4.  当受害者尝试打开良性文件时，WinRAR会错误地执行同名文件夹中的恶意代码，从而导致任意代码执行。

**项目地址:** [HDCE-inc/CVE-2023-38831](https://github.com/HDCE-inc/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #3

**来源**: [CVE-2023-38831-MaorBuskila_Windows-X64-RAT.md](../2023/CVE-2023-38831-MaorBuskila_Windows-X64-RAT.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者在用户尝试查看 ZIP 压缩包中的良性文件时执行任意代码。该漏洞源于 WinRAR 处理 ZIP 压缩包时，允许压缩包包含一个良性文件（例如 .JPG）和一个同名文件夹。当用户尝试访问该良性文件时，WinRAR 实际上会处理同名文件夹中的内容，从而允许攻击者在文件夹中放置恶意可执行文件并执行。

**有效性：**
从搜索结果和漏洞库信息来看，该漏洞已经被广泛利用，PoC 代码的存在也进一步验证了其有效性。

**投毒风险：**
提供的 Python 脚本 (`51721.py`) 用于生成 Windows x64 平台的反向 TCP Shellcode。该脚本本身不包含明显的恶意代码，功能是生成 shellcode。需要用户自行配置 IP 地址和端口。但是，由于该代码需要用户执行，并且可以生成任意 shellcode，存在一定投毒风险，例如，如果攻击者提供修改后的脚本，生成包含恶意功能的 shellcode (如删除文件，上传用户信息)，则用户可能无意中执行该恶意 shellcode. 脚本本身不包含网络连接或者其他与远程服务器通信的行为，可以基本判断代码仓库投毒风险较低.

**利用方式：**
1.  攻击者创建一个恶意的 ZIP 压缩包。
2.  该 ZIP 压缩包包含一个良性文件（例如 image.jpg）和一个同名文件夹（image.jpg）。
3.  同名文件夹包含恶意可执行文件，例如 exploit.exe，并可能包含一个 `.lnk` 文件，该快捷方式指向该恶意可执行文件。
4.  攻击者诱骗用户使用受影响版本的 WinRAR 打开该 ZIP 压缩包并尝试查看良性文件。
5.  WinRAR 错误地执行同名文件夹中的恶意可执行文件，从而导致远程代码执行。

**项目地址:** [MaorBuskila/Windows-X64-RAT](https://github.com/MaorBuskila/Windows-X64-RAT)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #4

**来源**: [CVE-2023-38831-MyStuffYT_CVE-2023-38831-POC.md](../2023/CVE-2023-38831-MyStuffYT_CVE-2023-38831-POC.md)

## CVE-2023-38831-WinRAR-远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的恶意ZIP压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个恶意的ZIP压缩文件，其中包含一个良性文件（例如.jpg）和一个同名的文件夹。当用户尝试在 WinRAR 中查看该良性文件时，WinRAR 会错误地执行该文件夹中的内容，从而导致任意代码执行。

**有效性：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。搜索引擎结果表明该漏洞已被广泛利用，POC代码的存在进一步证实了其有效性。

**投毒风险：**

根据对POC代码的分析，存在一定的投毒风险。`script.bat`脚本从github下载`Alert.exe`文件，这本身就存在一定的安全隐患，无法确保下载的文件一定是安全的。此外，脚本同时执行 `alert.exe` 和 `gtaleak.mp4`，而 `gtaleak.mp4` 在 README 中说明是 “zeros without ones”, 可以确定这是一个障眼法，实际的恶意行为是由 `alert.exe` 执行。 因此，作者可能隐藏了投毒代码。

**利用方式：**

1.  攻击者创建一个恶意的ZIP压缩文件，其中包含一个良性文件 (例如 `gtaleak.mp4`) 和一个同名的文件夹。
2.  该文件夹包含一个批处理脚本 (`script.bat`)，该脚本将从远程服务器下载并执行恶意程序 (`Alert.exe`)。
3.  当用户尝试使用 WinRAR 打开压缩文件并查看良性文件 (`gtaleak.mp4`) 时，WinRAR 会错误地执行批处理脚本。
4.  批处理脚本下载并执行恶意程序，从而允许攻击者在受害者的系统上执行任意代码。

**项目地址:** [MyStuffYT/CVE-2023-38831-POC](https://github.com/MyStuffYT/CVE-2023-38831-POC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #5

**来源**: [CVE-2023-38831-Nielk74_CVE-2023-38831.md](../2023/CVE-2023-38831-Nielk74_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本的代码执行漏洞。该漏洞允许攻击者在用户尝试查看ZIP存档中的看似无害的文件时执行任意代码。攻击者通过构造一个包含同名文件和文件夹的恶意ZIP文件，利用WinRAR处理文件路径时的逻辑缺陷，使得文件夹中的恶意可执行文件得以运行。提供的POC代码通过Vagrant自动化部署了一个易受攻击的WinRAR 6.22环境，并向虚拟机桌面添加了一个恶意的rar文件。该rar文件被设计为当用户点击其中的“无害”文件时，执行预先设定的恶意代码。尽管POC的主要目的是演示漏洞，但其中`ChocolateyInstall.ps1`脚本从外部源下载并安装软件包（Chocolatey和WinRAR），存在被篡改从而引入恶意代码的风险，这构成了潜在的投毒风险。虽然这个脚本很常见，但还是存在一定的风险，因此这里给出了10%的投毒风险。

**漏洞利用方式：**

1.  攻击者创建一个恶意的ZIP压缩包，其中包含一个看似无害的文件（例如.jpg），以及一个与该文件同名的文件夹。
2.  该文件夹包含恶意可执行文件，例如.exe或.cmd脚本。
3.  当用户尝试使用WinRAR打开ZIP压缩包并查看“无害”文件时，WinRAR会错误地执行同名文件夹中的恶意可执行文件，从而导致任意代码执行。
4.  攻击者可以利用此漏洞在受害者系统上安装恶意软件、窃取敏感数据或执行其他恶意操作。

**项目地址:** [Nielk74/CVE-2023-38831](https://github.com/Nielk74/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #6

**来源**: [CVE-2023-38831-RomainBayle08_CVE-2023-38831.md](../2023/CVE-2023-38831-RomainBayle08_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP或RAR压缩文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个特殊的 ZIP 压缩文件，该文件包含一个看似无害的文件（例如，.JPG 文件）和一个与该文件同名的文件夹。当用户尝试查看压缩文件中的无害文件时，WinRAR 会错误地执行文件夹中的内容，从而导致任意代码执行。

**有效性分析：**
提供的 POC 代码 `cve-2023-38831-exp-gen.py` 是一个漏洞利用生成器脚本，它接受诱饵文件 (`BAIT_NAME`)、脚本文件 (`SCRIPT_NAME`) 和额外的诱饵文件目录 (`BAIT_FILES`) 作为输入，并生成一个恶意 RAR 压缩文件 (`OUTPUT_NAME`)。脚本首先创建一个包含诱饵文件和脚本文件的临时目录结构，然后使用 `shutil.make_archive` 函数将该目录压缩为 ZIP 文件。关键在于，脚本会替换 ZIP 文件中特定文件的扩展名，利用 WinRAR 的漏洞，在用户尝试打开诱饵文件时执行脚本文件。`script.bat` 脚本会首先尝试打开诱饵文件（模拟用户行为），然后执行 `calc.exe`（作为漏洞利用成功的标志）。该 POC 的有效性较高，因为它模拟了真实的攻击场景。

**投毒风险分析：**
`cve-2023-38831-exp-gen.py` 脚本本身不包含明显的恶意代码或后门。但是，存在一定的投毒风险，因为该脚本允许攻击者指定要执行的任意脚本 (`SCRIPT_NAME`)。攻击者可以替换 `script.bat` 文件为包含恶意代码的文件，例如下载和执行其他恶意软件。此外，该脚本使用了`BAIT_FILES`参数，如果提供包含恶意文件的目录，也会构成投毒风险。所以存在一定投毒风险，但主要取决于用户提供的脚本和目录的内容。

**利用方式分析：**
1.  攻击者构造一个恶意 ZIP 压缩文件，其中包含一个诱饵文件（如 `CLASSIFIED_DOCUMENTS.pdf`）和一个与诱饵文件同名的文件夹。文件夹中包含一个脚本文件（如 `script.bat`）。
2.  攻击者将恶意 ZIP 文件发送给受害者，诱骗其使用 WinRAR 打开。
3.  当受害者尝试查看 ZIP 文件中的诱饵文件时，WinRAR 会错误地执行同名文件夹中的脚本文件。
4.  脚本文件执行任意代码，例如安装恶意软件或窃取敏感信息。

总的来说，该漏洞利用方式简单有效，风险较高。用户应尽快升级到 WinRAR 6.23 或更高版本。

**项目地址:** [RomainBayle08/CVE-2023-38831](https://github.com/RomainBayle08/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #7

**来源**: [CVE-2023-38831-RonF98_CVE-2023-38831-POC.md](../2023/CVE-2023-38831-RonF98_CVE-2023-38831-POC.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致任意代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831 是 WinRAR 在处理 ZIP 压缩文件时存在的一个漏洞。攻击者可以构造一个包含良性文件（例如 .jpg 文件）和一个同名文件夹的 ZIP 压缩包。该文件夹中包含恶意代码（例如 .cmd 文件）。当用户尝试查看良性文件时，WinRAR 会错误地执行文件夹中的恶意代码，从而导致远程代码执行。

**有效性：**

提供的 POC 代码有效，它演示了如何创建一个恶意的 RAR 文件来利用此漏洞。

*   `DoS.cmd` 文件包含恶意代码，用于创建多个消息框，模拟拒绝服务攻击。
*   `exploit.py` 脚本用于生成包含恶意 `DoS.cmd` 文件的 RAR 文件，并利用漏洞触发代码执行。
*   `README.md` 详细解释了漏洞原理和利用方法，并提供了攻击成功的截图。

**投毒风险：**

此仓库中可能存在轻微的投毒风险，约为5%。

*   `DoS.cmd` 只是一个简单的拒绝服务攻击示例，但攻击者可能会将其替换为更具破坏性的恶意代码，例如勒索软件或信息窃取程序。如果下载者不仔细检查 `DoS.cmd` 的内容，可能会在不知情的情况下运行恶意代码。
*   `exploit.py` 脚本本身没有明显的恶意代码，但它可以被修改以生成包含不同恶意代码的 RAR 文件。下载者应该仔细审查脚本的内容，确保它不会被用于传播恶意软件。

**利用方式：**

1.  攻击者创建一个包含良性文件（例如 `image.jpg`）和一个同名文件夹（例如 `image.jpg `）的 ZIP 压缩包。注意文件夹名称后面有一个空格。
2.  在同名文件夹中，攻击者放置恶意代码（例如 `image.jpg .cmd`）。
3.  攻击者将 ZIP 文件转换为 RAR 文件（POC 脚本完成了此过程）。
4.  攻击者诱骗用户使用受影响的 WinRAR 版本打开 RAR 文件并尝试查看良性文件（`image.jpg`）。
5.  WinRAR 错误地执行同名文件夹中的恶意代码 (`image.jpg .cmd`)，从而导致远程代码执行。

由于该漏洞被广泛利用，并且网上存在大量相关的 POC 代码，因此攻击者很容易发起攻击。


**项目地址:** [RonF98/CVE-2023-38831-POC](https://github.com/RonF98/CVE-2023-38831-POC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #8

**来源**: [CVE-2023-38831-SpamixOfficial_CVE-2023-38831.md](../2023/CVE-2023-38831-SpamixOfficial_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前的版本中的代码执行漏洞。攻击者可以制作一个特制的ZIP压缩包，其中包含一个良性文件和一个同名文件夹，文件夹中包含恶意可执行文件。当用户尝试在WinRAR中查看良性文件时，实际上会执行文件夹中的恶意代码。\n\n**有效性：**根据漏洞库信息、搜索结果和漏洞利用代码，该漏洞POC是有效的。漏洞库信息中明确指出该漏洞已在野外被利用。搜索结果中多个链接都指向了关于该漏洞的分析和利用报告。提供的`Cargo.lock`文件很可能只是rust项目依赖管理文件，无法直接证明POC的有效性，需配合rust源码进行分析。\n\n**投毒风险：**分析提供的`Cargo.lock`文件，该文件列出了Rust项目`CVE-2023-38831`的依赖项。虽然`Cargo.lock`本身不包含可执行代码，但是，如果恶意作者修改了依赖项的版本或来源，理论上存在引入被篡改过的crate（Rust包）的风险。不过，由于`Cargo.lock`文件明确指定了每个依赖项的checksum，Cargo在构建项目时会验证下载的crate是否与checksum匹配，从而降低了被投毒的风险。评估投毒风险为10%。\n\n**利用方式：**攻击者创建一个包含以下结构的ZIP压缩包：\n\n1.  一个良性的文件，例如 `image.jpg`\n2.  一个与良性文件同名的文件夹，例如 `image.jpg`\n3.  在同名文件夹中，放置恶意可执行文件，例如 `image.jpg.exe` 或 `image.jpg `(通过空格进行欺骗)。\n\n当用户使用存在漏洞的WinRAR版本打开该ZIP文件并尝试查看`image.jpg`时，WinRAR会错误地执行`image.jpg`文件夹中的恶意程序，从而实现远程代码执行。

**项目地址:** [SpamixOfficial/CVE-2023-38831](https://github.com/SpamixOfficial/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #9

**来源**: [CVE-2023-38831-Tolu12wani_Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution.md](../2023/CVE-2023-38831-Tolu12wani_Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在用户尝试查看 ZIP 压缩包中的文件时执行任意代码。

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开特制的 ZIP 压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者通过构造恶意的 ZIP 压缩包实现远程代码执行。该压缩包包含一个良性文件（例如 JPG）和一个与良性文件同名的文件夹。当用户尝试访问良性文件时，WinRAR 会错误地执行同名文件夹中的内容，从而执行攻击者放置的恶意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被广泛利用。 提供的POC代码描述的是在压缩文件中嵌入恶意payload，并触发反向shell的实验环境验证过程。虽然该代码本身没有包含恶意代码，但描述了如何构建利用该漏洞的压缩文件。

**投毒风险：**
提供的 POC 代码仓库中只包含 PDF 报告和截图，并没有可执行的恶意代码。 但是,README中说明了该仓库展示了恶意payload的嵌入方式，存在一定的潜在风险。 因此，存在一定的投毒风险，但风险较低。根据readme描述和文件结构，投毒风险评估为10%，

**利用方式：**
1.  **创建恶意 ZIP 压缩包：** 攻击者创建一个 ZIP 压缩包，其中包含一个良性文件（例如 JPG）和一个与良性文件同名的文件夹。
2.  **放置恶意代码：** 将恶意可执行文件放置在与良性文件同名的文件夹中。
3.  **诱骗用户：** 诱骗用户使用受影响的 WinRAR 版本打开该 ZIP 压缩包并尝试查看良性文件。
4.  **执行恶意代码：** WinRAR 错误地执行同名文件夹中的恶意代码，从而实现远程代码执行。

根据搜索结果，该漏洞已经被政府支持的攻击者利用，用于投放 RAT（远程访问木马）等恶意软件。

**项目地址:** [Tolu12wani/Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution](https://github.com/Tolu12wani/Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #10

**来源**: [CVE-2023-38831-VictoriousKnight_CVE-2023-38831_Exploit.md](../2023/CVE-2023-38831-VictoriousKnight_CVE-2023-38831_Exploit.md)

## CVE-2023-38831-WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码。

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的恶意ZIP文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个漏洞，它允许攻击者通过构造特殊的ZIP文件来执行任意代码。攻击者创建一个ZIP文件，其中包含一个良性文件（例如，JPG图片）和一个与该良性文件同名的文件夹。该文件夹中包含恶意可执行文件。当用户尝试在WinRAR中查看该良性文件时，WinRAR会错误地执行该文件夹中的恶意代码，从而导致远程代码执行。

**有效性：** 提供的POC代码是有效的。根据漏洞库信息和搜索结果，该漏洞在野外被广泛利用。POC代码通过创建包含良性文件和同名文件夹的恶意ZIP文件，并利用WinRAR处理文件时的缺陷来执行代码。POC代码结构清晰，易于理解和使用。

**投毒风险：** 提供的POC代码本身主要是利用漏洞生成EXP，但仔细检查代码，在`exploit.py`文件的zip文件内容操作部分被截断，没有展示修改zip文件内容的关键代码，作者可能在`Read and manipulate the zip file content`部分添加恶意代码，执行修改zip文件过程中的任何恶意行为。因此存在一定的投毒风险，根据代码完整度，我给出10%的投毒风险。

**利用方式：**
1.  攻击者创建一个恶意ZIP文件，其中包含一个看似无害的文件（例如，一个图片或PDF）。
2.  在ZIP文件中，攻击者同时创建一个与该无害文件同名的文件夹。
3.  该文件夹包含攻击者想要执行的恶意代码，通常是一个可执行文件或脚本。
4.  攻击者诱使用户使用存在漏洞的WinRAR版本打开该ZIP文件。
5.  当用户尝试访问ZIP文件中的“无害”文件时，WinRAR会错误地执行同名文件夹中的恶意代码。

**项目地址:** [VictoriousKnight/CVE-2023-38831_Exploit](https://github.com/VictoriousKnight/CVE-2023-38831_Exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #11

**来源**: [CVE-2023-38831-anelya0333_Exploiting-CVE-2023-38831.md](../2023/CVE-2023-38831-anelya0333_Exploiting-CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开特制的ZIP压缩文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞允许攻击者通过特制的ZIP压缩文件在目标系统上执行任意代码。该漏洞的根源在于WinRAR在处理包含与文件同名文件夹的ZIP文件时存在缺陷。攻击者可以构造一个 ZIP 文件，其中包含一个良性文件（例如.JPG）和一个与其同名的文件夹。当用户尝试在 WinRAR 中查看该良性文件时，WinRAR 会错误地执行该文件夹中的恶意代码。此PoC脚本生成一个ZIP文件，其中包含诱饵文件(bait file)和恶意脚本(script file)，并修改ZIP文件的文件头，以利用此漏洞。脚本创建与诱饵文件同名的文件夹，并将恶意脚本放入其中。然后，将诱饵文件的副本也放入ZIP文件中。通过替换文件名字段中的某些字符，WinRAR会将文件夹中的恶意文件误认为是要执行的文件，最终导致代码执行。由于代码仅仅是构造payload，不存在主动执行恶意代码，因此不存在投毒风险。

**项目地址:** [anelya0333/Exploiting-CVE-2023-38831](https://github.com/anelya0333/Exploiting-CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #12

**来源**: [CVE-2023-38831-b1tg_CVE-2023-38831-winrar-exploit.md](../2023/CVE-2023-38831-b1tg_CVE-2023-38831-winrar-exploit.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可导致完全系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开恶意构造的ZIP文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 允许攻击者通过特制的ZIP文件在受害者系统上执行任意代码。该漏洞源于 WinRAR 处理包含同名文件和文件夹的 ZIP 档案时的不当行为。攻击者可以创建一个 ZIP 文件，其中包含一个良性文件（例如 CLASSIFIED_DOCUMENTS.pdf）和一个同名文件夹（例如 CLASSIFIED_DOCUMENTS.pdf）。当用户尝试访问良性文件时，WinRAR 实际上会执行该文件夹中的内容（例如 script.bat）。

**有效性:**

提供的 POC 代码 `cve-2023-38831-exp-gen.py` 旨在生成利用此漏洞的恶意 RAR 档案。该脚本通过以下步骤工作：

1.  创建临时目录 `TEMPLATE`。
2.  在 `TEMPLATE` 中创建一个与bait文件同名的文件夹，并在其中存放包含恶意命令的script文件（例如 `script.bat`， 其中包含`calc.exe & CLASSIFIED_DOCUMENTS.pdf`）。
3.  将bait文件存放在`TEMPLATE`目录。
4.  将`TEMPLATE`目录压缩为zip文件。
5.  修改压缩包中文件和文件夹的名字，构造漏洞。
6.  最终输出 `CVE-2023-38831-poc.rar`。

该脚本能够有效地生成利用 CVE-2023-38831 的 RAR 文件，因此提供的 POC 代码是有效的。

**投毒风险:**

对提供的 POC 代码 (`cve-2023-38831-exp-gen.py` 和 `script.bat`) 进行分析后，未发现明显的恶意代码或后门。该脚本的功能明确且集中于生成利用 CVE-2023-38831 的 RAR 档案。 `script.bat` 的主要功能是启动计算器程序 (`calc.exe`) 并尝试打开诱饵文档 (`CLASSIFIED_DOCUMENTS.pdf`)，这是一个典型的 PoC 行为。 因此，该仓库中存在作者隐藏的投毒代码的风险极低。

**利用方式:**

1.  攻击者使用 `cve-2023-38831-exp-gen.py` 脚本，指定诱饵文件（例如 `CLASSIFIED_DOCUMENTS.pdf`）和恶意脚本（例如 `script.bat`），生成恶意 RAR 档案。
2.  攻击者通过各种方式（例如，电子邮件、恶意网站）将恶意 RAR 档案分发给受害者。
3.  受害者使用易受攻击的 WinRAR 版本（< 6.23）打开恶意 RAR 档案。
4.  当受害者尝试访问诱饵文件时，WinRAR 错误地执行了同名文件夹中的恶意脚本。
5.  恶意脚本在受害者系统上执行任意代码，例如启动计算器或安装恶意软件。

**项目地址:** [b1tg/CVE-2023-38831-winrar-exploit](https://github.com/b1tg/CVE-2023-38831-winrar-exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #13

**来源**: [CVE-2023-38831-elefantesagradodeluzinfinita_cve-2023-38831.md](../2023/CVE-2023-38831-elefantesagradodeluzinfinita_cve-2023-38831.md)

## CVE-2023-38831 - WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用 WinRAR 打开特制的 ZIP 压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者通过特制的 ZIP 压缩包在受害者系统上执行任意代码。漏洞利用方式是创建一个 ZIP 压缩包，其中包含一个良性文件（例如 .jpg 或 .pdf）以及一个同名的文件夹。该文件夹包含恶意的可执行文件（例如 .cmd 或 .exe）。当用户尝试打开良性文件时，WinRAR 会错误地执行文件夹中的恶意代码。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码分析，该漏洞确实存在并且已经被野外利用。提供的代码描述了一个利用工具 "DR. GANDALF"，它允许用户创建包含此漏洞的 ZIP 文件，表明POC的有效性。

**投毒风险：** 提供的 README.md 文件主要描述了漏洞原理和利用工具的使用方法。但是，由于此工具允许用户自定义注入的代码和二进制文件，因此存在投毒风险。如果用户下载了包含恶意注入代码的ZIP文件，那么这个工具本身可能被利用来传播恶意软件。评估投毒风险为 10%，因为该描述文件本身不包含可以直接执行的后门代码，但生成的ZIP文件可以包含。

**利用方式：**
1.  攻击者创建一个包含恶意 ZIP 压缩包。
2.  ZIP 压缩包中包含一个良性文件（例如，`image.jpg`）和一个同名的文件夹（例如，`image.jpg`）。
3.  `image.jpg` 文件夹包含恶意的可执行文件（例如，`evil.cmd`）。
4.  攻击者诱骗受害者使用存在漏洞的 WinRAR 版本打开该 ZIP 压缩包并尝试访问良性文件 `image.jpg`。
5.  WinRAR 在处理该 ZIP 文件时，会错误地执行 `image.jpg` 文件夹中的恶意代码 `evil.cmd`，从而导致远程代码执行。

**项目地址:** [elefantesagradodeluzinfinita/cve-2023-38831](https://github.com/elefantesagradodeluzinfinita/cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #14

**来源**: [CVE-2023-38831-h3xecute_SideCopy-Exploits-CVE-2023-38831.md](../2023/CVE-2023-38831-h3xecute_SideCopy-Exploits-CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个远程代码执行漏洞。该漏洞的利用方式是构造一个特殊的ZIP压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹。当用户尝试使用WinRAR打开该ZIP压缩包并访问良性文件时，WinRAR会错误地执行文件夹中的恶意代码。

**有效性：**
提供的POC代码描述了漏洞利用的原理，即构造包含同名良性文件和文件夹的ZIP压缩包。根据漏洞信息和搜索结果，此方法是有效的，并且在野外被利用。

**投毒风险：**
该POC本身描述了漏洞的利用方式，包含一个指向YouTube视频的链接，以及对恶意压缩包结构的描述。投毒风险较低，约为10%，因为：
1.  POC主要以描述性文字和图片链接为主。
2.  缺乏直接可执行的payload代码。
3.  作者可能通过YouTube链接传播恶意信息。

**利用方式：**
1.  攻击者创建一个恶意的ZIP压缩包。
2.  该压缩包包含一个良性文件（例如JPG，PDF等）和一个与该文件同名的文件夹。
3.  恶意代码（例如，可执行文件）放置在同名文件夹中。
4.  攻击者诱骗用户使用WinRAR打开这个ZIP压缩包，并尝试访问良性文件。
5.  WinRAR在处理压缩包时，会错误地执行同名文件夹中的恶意代码，从而导致远程代码执行。

**项目地址:** [h3xecute/SideCopy-Exploits-CVE-2023-38831](https://github.com/h3xecute/SideCopy-Exploits-CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #15

**来源**: [CVE-2023-38831-idkwastaken_CVE-2023-38831.md](../2023/CVE-2023-38831-idkwastaken_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意的ZIP文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的漏洞。该漏洞的利用方式是创建一个特制的ZIP文件，其中包含一个良性文件和一个同名文件夹。当用户尝试使用WinRAR打开ZIP文件并访问该良性文件时，WinRAR会错误地执行该同名文件夹中的恶意代码，导致远程代码执行。

**有效性：**
提供的POC代码（exploit.c）利用了该漏洞。该代码生成一个ZIP文件，其中包含一个PDF文件（document.pdf）和一个名为“document.pdf\”的文件夹，该文件夹内包含一个恶意的批处理脚本（script.bat）。当用户在易受攻击的WinRAR版本中打开并尝试访问该PDF文件时，WinRAR将执行该批处理脚本。
checker.bat 是用来检测目标系统是否安装WinRAR，以及WinRAR的版本是否是受影响的版本。
exploit.ps1 看起来不完整，但是其作用应该是检查WinRAR版本。

**投毒风险：**
代码中存在一定的投毒风险，约为10%。原因如下：
*   **脚本内容可控：** exploit.c 中的script_content变量包含了要执行的命令，虽然当前POC仅仅是弹窗，但是攻击者可以修改这个变量，执行任意命令，例如下载恶意软件，执行系统命令等。
*   **复杂的构建过程：** exploit.c 代码本身比较复杂，阅读和分析需要一定的时间和精力。攻击者可以利用这一点，在代码中隐藏不易察觉的恶意代码。
虽然有潜在的投毒风险，但当前代码的主要目的是演示漏洞利用，风险较低，作者没有明显的隐藏后门行为，恶意代码比较容易被发现。

**利用方式：**
1.  攻击者创建一个恶意的ZIP压缩包，其中包含：
    *   一个良性的文件（例如 document.pdf）。
    *   一个与良性文件同名的文件夹（例如 document.pdf/）。
    *   恶意代码位于同名文件夹中（例如 document.pdf/script.bat）。
2.  攻击者诱骗目标用户使用存在漏洞的 WinRAR 版本打开此 ZIP 压缩包。
3.  当用户尝试打开良性文件时，WinRAR 错误地执行同名文件夹中的恶意代码，从而导致任意代码执行。


**项目地址:** [idkwastaken/CVE-2023-38831](https://github.com/idkwastaken/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #16

**来源**: [CVE-2023-38831-imbyter_imbyter-WinRAR_CVE-2023-38831.md](../2023/CVE-2023-38831-imbyter_imbyter-WinRAR_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 6.23

**利用条件:** 用户使用受影响的WinRAR版本打开特制的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于WinRAR 6.23之前的版本中。攻击者可以构造一个恶意的ZIP压缩包，其中包含一个伪装成良性文件的文件（例如 .jpg），以及一个同名的文件夹。当用户尝试在 WinRAR 中查看该“良性文件”时，实际上会执行同名文件夹中的恶意代码（例如 .cmd 或 .exe 文件）。

**有效性：**
根据漏洞信息和搜索结果，提供的POC代码是有效的。该POC利用了WinRAR处理ZIP压缩包时存在的逻辑漏洞，能够实现远程代码执行。

**投毒风险：**
提供的Python脚本 `make-poc.py` 用于生成POC压缩包，其本身的代码逻辑相对简单，主要功能是将指定的文件和脚本打包成特定的ZIP格式，并进行一些字符串替换以触发漏洞。主要风险在于脚本生成的POC包中包含的脚本，如果这个脚本是恶意的，那么整个利用过程就存在投毒风险。 仓库中的README.md文件里的测试脚本就是一个关闭计算机的脚本。代码本身存在一定的投毒风险.

*   脚本逻辑：脚本的功能是创建包含漏洞利用结构的RAR文件。
*   恶意操作：如果脚本被修改以包含下载和执行恶意软件的逻辑，那么用户在使用此脚本创建RAR文件时，就会受到投毒攻击。

**利用方式：**
1.  攻击者使用 `make-poc.py` 脚本构造恶意的ZIP压缩包，需要提供一个“良性”文件和一个恶意脚本。
2.  攻击者将恶意的ZIP压缩包发送给受害者。
3.  受害者使用受影响的WinRAR版本打开该ZIP压缩包，并尝试查看伪装的“良性”文件。
4.  WinRAR错误地执行了与“良性”文件同名的文件夹中的恶意脚本，导致远程代码执行。

**防御措施：**
*   升级WinRAR到6.23或更高版本。
*   谨慎打开来源不明的ZIP压缩包。
*   使用杀毒软件扫描ZIP压缩包。

**项目地址:** [imbyter/imbyter-WinRAR_CVE-2023-38831](https://github.com/imbyter/imbyter-WinRAR_CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #17

**来源**: [CVE-2023-38831-kehrijksen_CVE-2023-38831.md](../2023/CVE-2023-38831-kehrijksen_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 需要用户解压特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个恶意的 ZIP 压缩包，其中包含一个伪装成普通文件的文件和一个同名的文件夹。当用户尝试在 WinRAR 中查看该“普通文件”时，WinRAR 会错误地执行同名文件夹中的内容，从而导致任意代码执行。

**有效性：**
提供的 PoC 代码 `poc.py` 能够生成利用此漏洞的恶意 ZIP 压缩包。该脚本首先创建一个包含恶意 payload (例如 script.bat) 和良性文件 (例如 pepe.jpg) 的目录结构。然后，它将此目录结构压缩成 ZIP 文件，并修改 ZIP 文件中的文件名，以触发漏洞。`script.bat` 的作用是在 `%TEMP%` 目录下提取 ZIP 文件内容，运行良性文件作为诱饵，然后执行恶意操作，例如创建一个包含 “hacked” 内容的文本文件并使用记事本打开。

**投毒风险：**
分析提供的代码，没有发现明显的投毒代码。`poc.py` 的作用是生成恶意 ZIP 文件，而 `script.bat` 包含的是恶意行为的代码，例如运行良性文件，创建 `hacked.txt` 等。这些行为是漏洞利用的一部分，而不是隐藏的恶意代码。虽然利用 `script.bat` 可以执行任意操作，但这属于漏洞利用的范畴，而非代码投毒。

**利用方式：**
1.  攻击者使用 `poc.py` 脚本生成一个恶意的 ZIP 压缩包，其中包含一个良性文件（例如图片）和一个同名的文件夹。
2.  攻击者将此恶意 ZIP 压缩包发送给受害者。
3.  受害者使用 WinRAR (6.23 之前的版本) 打开并尝试查看 ZIP 压缩包中的良性文件。
4.  WinRAR 错误地执行与良性文件同名的文件夹中的内容 (由 `script.bat` 控制)。
5.  `script.bat` 首先将 ZIP 文件的内容解压到临时目录。
6.  `script.bat` 运行良性文件（例如图片）作为诱饵，以迷惑受害者。
7.  `script.bat` 执行任意恶意操作，例如创建文件，修改注册表，安装恶意软件等。


**项目地址:** [kehrijksen/CVE-2023-38831](https://github.com/kehrijksen/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #18

**来源**: [CVE-2023-38831-khanhtranngoccva_cve-2023-38831-poc.md](../2023/CVE-2023-38831-khanhtranngoccva_cve-2023-38831-poc.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。该漏洞源于WinRAR处理ZIP压缩包时，对文件名和文件夹名区分不当。攻击者可以创建一个ZIP压缩包，其中包含一个良性文件（例如JPG）和一个同名的文件夹。该文件夹中包含恶意可执行文件。当用户尝试在WinRAR中打开该良性文件时，WinRAR会错误地执行文件夹中的恶意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已在野外被利用，证明了其有效性。提供的POC代码片段（package-lock.json）显示使用了jszip库，表明该POC可能用于创建恶意的ZIP压缩包，进一步验证漏洞的可利用性。

**投毒风险：**
提供的POC代码片段是`package-lock.json`文件，主要描述了项目依赖。要判断是否存在投毒风险，需要检查实际的利用代码（例如 index.ts/index.js）。
*   这个`package-lock.json`文件本身不包含恶意代码，只是依赖声明。
*   **风险点在于开发者可能在其他代码文件中（如index.ts等，此文件未提供）包含恶意代码**。
*   jszip 库本身是一个常用的 ZIP 文件操作库，被投毒的可能性较低。
*   tsx和typescript是typescript相关工具，本身被投毒的可能性也比较低

由于缺乏实际的利用代码，无法确定是否存在投毒行为，只能根据现有信息进行推测，因此将投毒风险评估为10%。

**利用方式：**
1.  攻击者构造一个恶意的ZIP压缩包。
2.  该ZIP压缩包包含一个良性文件（例如JPG）和一个同名的文件夹。
3.  该文件夹中包含恶意可执行文件（例如EXE、BAT、CMD等）。
4.  攻击者诱骗用户使用受影响的WinRAR版本打开该ZIP压缩包。
5.  用户尝试在WinRAR中打开该良性文件。
6.  WinRAR错误地执行文件夹中的恶意代码，导致远程代码执行。

**项目地址:** [khanhtranngoccva/cve-2023-38831-poc](https://github.com/khanhtranngoccva/cve-2023-38831-poc)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #19

**来源**: [CVE-2023-38831-kuyrathdaro_winrar-cve-2023-38831.md](../2023/CVE-2023-38831-kuyrathdaro_winrar-cve-2023-38831.md)

## CVE-2023-38831-WinRAR代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个代码执行漏洞。该漏洞的利用方式如下：

1.  攻击者创建一个恶意的ZIP压缩包（伪装成RAR格式，后缀名为.rar）。
2.  该压缩包包含一个良性的文件（例如，document.pdf），以及一个与该良性文件同名的文件夹（例如，document.pdf）。
3.  同名文件夹中包含恶意payload（例如，一个.bat或.exe文件），命名为`document.pdfA.cmd`。
4.  用户使用存在漏洞的WinRAR版本打开该压缩包，并尝试打开良性文件（document.pdf）。
5.  由于WinRAR处理文件名的缺陷，实际上执行的是同名文件夹中的恶意payload。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以判断该漏洞PoC有效。搜索引擎结果中多个链接表明该漏洞已被广泛利用，并且Google的威胁分析小组也分析了利用该漏洞进行的攻击活动。提供的PoC代码实现了生成恶意RAR压缩包的逻辑，进一步验证了该漏洞的可利用性。

**投毒风险：**

PoC代码本身的主要功能是生成利用CVE-2023-38831漏洞的恶意压缩包。然而，我们仍然需要评估该代码是否存在潜在的投毒风险。以下是对代码的分析：

*   **代码功能明确：** PoC代码的功能是生成特定的文件结构和内容，以触发WinRAR漏洞。代码逻辑相对简单，易于理解。
*   **输入/输出控制：** PoC代码接受三个输入参数：良性文件、Payload文件和输出文件名。这三个参数都由用户指定，PoC本身没有主动下载或执行任何其他代码的功能。
*   **潜在风险点：** `exploit.py` 脚本使用 `shutil.copyfile` 函数来复制 payload 文件到临时目录，如果payload 文件本身就是恶意的，那么这也会造成风险。此外，尽管脚本尝试确保输出文件以 `.rar` 结尾，但恶意用户可能修改此行为。
*   **间接风险：** 如果攻击者修改了提供的 `exploit.py` 脚本，添加额外的恶意功能（例如，在生成恶意压缩包后，自动上传到恶意服务器），则可能存在投毒风险。但是，这并非原始PoC代码本身的问题。

综合来看，原始PoC代码本身存在直接投毒的风险较低，我估计的投毒风险概率为 **10%**。这主要是因为恶意 payload 本身会带来风险，但 PoC 代码并没有主动引入恶意行为。

**利用方式：**

1.  准备一个良性的文件（例如，document.pdf）和一个恶意payload（例如，script.bat或malware.exe）。
2.  运行PoC脚本，指定良性文件、payload文件和输出文件名。
3.  PoC脚本生成一个恶意的RAR压缩包（实际上是ZIP格式，但后缀名为.rar）。
4.  将该恶意RAR压缩包发送给目标用户。
5.  目标用户使用存在漏洞的WinRAR版本打开该压缩包，并尝试打开良性文件。
6.  WinRAR执行同名文件夹中的恶意payload，从而实现代码执行。


**项目地址:** [kuyrathdaro/winrar-cve-2023-38831](https://github.com/kuyrathdaro/winrar-cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #20

**来源**: [CVE-2023-38831-malvika-thakur_CVE-2023-38831.md](../2023/CVE-2023-38831-malvika-thakur_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以通过创建一个特制的 ZIP 压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹，文件夹中包含恶意可执行文件。当用户尝试在 WinRAR 中查看该良性文件时，由于 WinRAR 处理逻辑的缺陷，会错误地执行文件夹中的恶意代码，从而导致远程代码执行。

**有效性：**

提供的 POC 代码 `poc.py`  可以生成利用此漏洞的 ZIP 文件。代码首先检查恶意脚本和良性文件是否存在，然后创建一个目录，将脚本和良性文件复制到特定结构中，最后将该目录压缩成 ZIP 文件。用户只需双击压缩包内的良性文件即可触发漏洞，执行恶意脚本。因此，POC 代码有效。

**投毒风险：**

分析提供的 `poc.py` 代码，没有发现明显的投毒代码。该脚本的主要功能是生成利用 CVE-2023-38831 漏洞的恶意 ZIP 文件。它需要用户提供恶意脚本和良性文件，然后按照特定目录结构进行组织并压缩。代码中没有发现任何会执行额外恶意操作的逻辑。`README.md` 文件也仅包含漏洞描述和使用说明，没有发现恶意内容。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者创建一个包含良性文件（如 JPG 图片）和一个同名文件夹的 ZIP 压缩包。
2.  该文件夹中包含恶意可执行文件（如 BAT 脚本）。
3.  攻击者将该 ZIP 压缩包发送给目标用户。
4.  目标用户使用受影响的 WinRAR 版本打开该 ZIP 压缩包。
5.  目标用户双击 ZIP 压缩包中的良性文件。
6.  WinRAR 错误地执行同名文件夹中的恶意可执行文件，导致远程代码执行。

**项目地址:** [malvika-thakur/CVE-2023-38831](https://github.com/malvika-thakur/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #21

**来源**: [CVE-2023-38831-r1yaz_winDED.md](../2023/CVE-2023-38831-r1yaz_winDED.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开特制的恶意 ZIP 压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 是 WinRAR 在处理 ZIP 压缩文件时存在的远程代码执行漏洞。当 WinRAR 版本低于 6.23 时，如果用户尝试打开一个包含恶意构造的 ZIP 文件，攻击者可以利用此漏洞执行任意代码。该 ZIP 文件包含一个良性文件（例如 JPG 文件）和一个与其同名的文件夹。攻击者可以将可执行文件放置在该文件夹中，当用户尝试访问良性文件时，WinRAR 会错误地执行文件夹中的可执行文件。

**有效性：**
提供的 POC 代码（winDED）通过生成恶意 ZIP 文件来演示漏洞利用。它创建了一个良性文件和一个同名文件夹，并将恶意脚本放入文件夹中。用户双击压缩包中的 PDF 文件时，实际上会执行该恶意脚本，从而证明漏洞的可利用性。

**投毒风险：**
根据提供的 POC 代码，投毒风险较低。代码主要是为了演示漏洞而设计的，虽然存在执行恶意 `super_sneaky_evil_script.bat` 的可能性，但该脚本本身是由用户提供的，或者可以通过查看代码本身来确认其行为。 然而，仍然存在一些细微的风险，例如，如果 `super_sneaky_evil_script.bat` 本身是从其他来源下载的，则可能包含恶意代码。  总的来说, 投毒风险约 10%。

**利用方式：**
1.  创建一个包含良性文件 (例如，`BILLION_DOLLAR_SECRET.pdf`) 和一个同名文件夹 (`BILLION_DOLLAR_SECRET.pdf`) 的 ZIP 压缩文件。
2.  将恶意脚本 (例如，`super_sneaky_evil_script.bat`) 放入同名文件夹中。
3.  诱骗目标用户使用 WinRAR 打开该 ZIP 文件。
4.  当用户尝试打开良性文件时，WinRAR 错误地执行同名文件夹中的恶意脚本，从而实现远程代码执行。

**项目地址:** [r1yaz/winDED](https://github.com/r1yaz/winDED)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #22

**来源**: [CVE-2023-38831-ra3edAJ_LAB-DFIR-cve-2023-38831.md](../2023/CVE-2023-38831-ra3edAJ_LAB-DFIR-cve-2023-38831.md)

## CVE-2023-38831-WinRAR代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 是 WinRAR 在 6.23 版本之前存在的远程代码执行漏洞。该漏洞源于WinRAR处理ZIP压缩包时，如果压缩包中包含一个良性文件和一个与该良性文件同名的文件夹，WinRAR在尝试访问良性文件时，会错误地执行同名文件夹中的恶意内容。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的PoC是可用的。漏洞在野外被广泛利用，并且CISA已将其添加到已知被利用的漏洞目录中。

**投毒风险：**
提供的漏洞利用代码为一个Github仓库的README.md文件，主要描述了如何利用磁盘镜像调查CVE-2023-38831攻击，并通过Windows注册表、NTFS文件和浏览器缓存理解Windows事件序列。仓库本身目的是为了DFIR分析，因此直接包含恶意代码的可能性较低。但考虑到链接跳转至外部教程网站，存在间接投毒的可能，即教程内容可能包含引导至恶意软件下载或运行恶意脚本的指令。因此，投毒风险较低，评估为10%。

**利用方式：**
1.  **创建恶意的ZIP压缩包：** 压缩包中包含一个良性文件（如JPG图片）和一个与该良性文件同名的文件夹。
2.  **将恶意可执行文件放入同名文件夹：** 该文件夹中的可执行文件会在用户尝试打开良性文件时被执行。
3.  **诱导用户打开ZIP压缩包：** 通过社交工程或其他方式，诱导用户使用受影响版本的WinRAR打开该压缩包。
4.  **触发漏洞执行恶意代码：** 当用户尝试查看ZIP压缩包中的良性文件时，WinRAR会错误地执行同名文件夹中的恶意代码，从而实现远程代码执行。

**总结：**
该漏洞利用方式较为简单，易于传播，危害较大。用户应及时更新WinRAR至最新版本，避免打开来源不明的ZIP压缩包。

**项目地址:** [ra3edAJ/LAB-DFIR-cve-2023-38831](https://github.com/ra3edAJ/LAB-DFIR-cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #23

**来源**: [CVE-2023-38831-ruycr4ft_CVE-2023-38831.md](../2023/CVE-2023-38831-ruycr4ft_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的远程代码执行漏洞。该漏洞源于WinRAR在处理ZIP压缩包时，对文件名和文件夹名相同的情况处理不当。攻击者可以构造一个恶意的ZIP压缩包，其中包含一个看似无害的文件（例如.jpg），同时包含一个同名的文件夹。当用户尝试打开该“无害文件”时，WinRAR会错误地执行同名文件夹中的恶意代码。\n\n**有效性：** 根据漏洞信息、搜索结果以及提供的POC代码，该漏洞利用是有效的。多个来源都表明该漏洞已被广泛利用，POC代码也展示了如何生成包含恶意代码的RAR压缩文件。POC代码通过创建同名文件和文件夹，并在文件夹中放入恶意脚本，利用WinRAR的缺陷触发代码执行。\n\n**投毒风险：**  仓库的投毒风险较低，大概10%。
  *   `poc.py`: 该脚本的功能是生成利用 CVE-2023-38831 的恶意 RAR 文件。虽然它允许用户指定 bait 文件和脚本文件，但脚本本身不包含任何预设的、隐藏的恶意行为。
  *   `script.bat`:  这个批处理文件包含使用 `nc.exe` (netcat) 反弹 shell 的命令。**这里存在一定的投毒风险。** 批处理文件明确地使用了`192.168.0.107`这个IP地址,如果用户直接使用该IP反弹shell,将会连接到攻击者的服务器。虽然IP地址可以被用户更改，但在默认情况下，如果用户不修改，将会连接到攻击者的IP。这是主要的投毒点。
  *   README.md: 该文件仅包含漏洞的简单介绍和演示图片。没有发现恶意代码。

**利用方式：**\n1.  攻击者创建一个恶意的ZIP压缩包。该压缩包包含一个诱饵文件（例如图片.jpg）和一个与其同名的文件夹（例如图片.jpg）。\n2.  攻击者将恶意代码（例如一个批处理脚本或可执行文件）放入同名文件夹中。\n3.  攻击者将包含恶意代码的ZIP压缩包发送给受害者。\n4.  受害者使用存在漏洞的WinRAR版本打开该ZIP压缩包，并尝试打开诱饵文件。\n5.  WinRAR错误地执行同名文件夹中的恶意代码，导致远程代码执行。

**项目地址:** [ruycr4ft/CVE-2023-38831](https://github.com/ruycr4ft/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #24

**来源**: [CVE-2023-38831-s4m98_winrar-cve-2023-38831-poc-gen.md](../2023/CVE-2023-38831-s4m98_winrar-cve-2023-38831-poc-gen.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开恶意的ZIP/RAR压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于WinRAR处理ZIP压缩文件时，由于对文件名和文件夹名处理不当导致。攻击者可以构造一个包含恶意脚本的ZIP压缩文件，该压缩文件包含一个正常的诱饵文件（如PDF、PNG或JPG）和一个同名的文件夹，当用户尝试打开诱饵文件时，WinRAR会错误地执行该文件夹中的恶意脚本。

**有效性：**
根据漏洞信息、搜索引擎结果和漏洞利用代码，该POC代码有效。漏洞库信息表明该漏洞已被野外利用。搜索引擎结果中也包含了大量关于此漏洞的分析和利用报告，证实了该漏洞的有效性。POC代码的描述和实现也符合漏洞的利用方式，通过生成包含恶意脚本和诱饵文件的RAR压缩包来触发漏洞。

**投毒风险：**
代码本身看起来比较直接，主要是生成利用漏洞的压缩包。`script.bat` 这个文件需要额外注意。当前提供的 `script.bat` 只是打开了计算器 `calc.exe` 和 Web_Security.pdf,相对来说是安全的，但用户在使用该漏洞时，完全可以修改此文件，添加更加恶意的payload，具有一定的风险。作者在代码中没有明显投毒行为，主要风险在于用户如何使用该工具生成payload。
投毒风险评估：10% (主要是用户修改 `script.bat` 的风险)

**利用方式：**
1.  **构造恶意ZIP/RAR压缩文件：** 利用提供的Python脚本（cve-2023-38831-exp-gen.py）生成恶意的ZIP/RAR压缩文件。此脚本需要一个诱饵文件（如PDF、PNG、JPG）和一个恶意脚本文件（如BAT、CMD、或可执行文件）。该脚本会创建一个包含诱饵文件和一个同名文件夹的压缩包，并将恶意脚本放置在该文件夹中。
2.  **诱骗用户打开压缩文件：**  将生成的恶意ZIP/RAR压缩文件发送给目标用户。
3.  **执行恶意代码：** 当用户使用受影响的WinRAR版本打开压缩文件并尝试查看诱饵文件时，WinRAR会错误地执行同名文件夹中的恶意脚本，从而实现远程代码执行。

 总体来说，该漏洞利用方式较为简单，攻击成本较低，风险较高。

**项目地址:** [s4m98/winrar-cve-2023-38831-poc-gen](https://github.com/s4m98/winrar-cve-2023-38831-poc-gen)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #25

**来源**: [CVE-2023-38831-solomon12354_VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC.md](../2023/CVE-2023-38831-solomon12354_VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要解压恶意的ZIP/RAR压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 存在于 WinRAR 6.23 之前版本中。攻击者可以构造一个包含良性文件和同名文件夹的 ZIP 压缩包，当用户尝试访问良性文件时，WinRAR 会错误地执行同名文件夹中的恶意代码。提供的 `exploit.py` 脚本可以用于生成包含漏洞利用的RAR压缩文件。脚本首先要求输入良性文件（`bait_file`）、恶意脚本文件（`script_file`）和输出RAR文件名称。然后，它创建一个临时目录，将恶意脚本复制到与良性文件同名的目录中，并将良性文件复制到临时目录中。最后，使用 `shutil.make_archive` 函数将临时目录压缩成 ZIP 文件，并修改 ZIP 文件的内容，将目录名中的 'A' 和 'B' 替换为空格，从而绕过 WinRAR 的安全检查。最终，将修改后的 ZIP 文件重命名为 RAR 文件。

`squid.bat` 用于下载并执行 `volleysquid.exe`。`volleyballsquid.py` 尝试利用 BypassUAC 来提升权限并将程序设置为开机自启。

**有效性:** 根据漏洞信息和利用代码分析，提供的 POC 代码有效，可以利用此漏洞在受害者机器上执行任意代码。

**投毒风险:** 仓库中存在一定的投毒风险，虽然主要功能是利用CVE-2023-38831漏洞，但是 `volleyballsquid.py`和`squid.bat`文件中的行为具有恶意性，特别是`volleyballsquid.py`中尝试使用`BypassUAC`绕过用户账户控制并持久化安装，这可能被用于安装后门或恶意软件。虽然主要目的是展示漏洞，但客观上存在后门功能，因此投毒风险占比为10%。

**利用方式:** 攻击者首先利用 `exploit.py` 脚本生成包含恶意代码的RAR压缩文件。然后，诱骗用户下载并使用 WinRAR 解压此文件。当用户尝试打开压缩包中的“良性”文件时，实际上会执行隐藏在同名目录中的恶意脚本 (例如 `squid.bat`)，下载并执行恶意程序。

根据搜索结果，CVE-2023-38831 漏洞已被广泛利用，并且已被政府背景的攻击者使用，这进一步验证了漏洞的严重性和 POC 代码的有效性。

**项目地址:** [solomon12354/VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC](https://github.com/solomon12354/VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #26

**来源**: [CVE-2023-38831-technicalcorp0_CVE-2023-38831-Exploit.md](../2023/CVE-2023-38831-technicalcorp0_CVE-2023-38831-Exploit.md)

## CVE-2023-38831-WinRAR-任意代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 任意代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个漏洞，该漏洞允许攻击者通过特制的ZIP档案执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** 当WinRAR尝试访问ZIP归档中的良性文件时，如果存在与该良性文件同名的文件夹，WinRAR会处理该文件夹的内容（可能包含可执行内容）。
2.  **利用方式：**
    *   攻击者创建一个恶意的ZIP档案，该档案包含一个良性文件（例如.JPG文件）和一个与该良性文件同名的文件夹。
    *   该文件夹包含恶意可执行文件。
    *   当受害者尝试在WinRAR中查看良性文件时，WinRAR会执行该文件夹中的恶意代码。
3.  **POC有效性：** 提供的POC代码 (CVE-2023-38831-WinRar-Exploit.py) 的目的是生成包含利用此漏洞的恶意 ZIP 文件。根据代码逻辑和漏洞原理，该 POC 可以有效利用该漏洞。
4.  **投毒风险：** 经过对POC代码的分析，发现代码本身实现了漏洞利用过程，但同时也存在一定的投毒风险。`clean_up()`函数会删除临时文件，但不能保证完全清除所有痕迹。攻击者可能通过修改代码，在生成恶意 ZIP 文件后，在目标系统上留下后门或执行其他恶意操作。考虑到实际利用场景中可能存在的恶意修改，投毒风险估计为5%。 主要风险点在于，虽然POC主要目的是生成exploit，但如果恶意人员修改，完全可以添加其他恶意payload，并伪装成CVE-2023-38831的POC进行传播。
5. **搜索引擎结果:** 搜索引擎结果表明此漏洞已被广泛利用，包括政府背景的黑客组织。 多个安全厂商发布了相关的分析和防御措施。

**项目地址:** [technicalcorp0/CVE-2023-38831-Exploit](https://github.com/technicalcorp0/CVE-2023-38831-Exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #27

**来源**: [CVE-2023-38831-xk-mt_WinRAR-Vulnerability-recurrence-tutorial.md](../2023/CVE-2023-38831-xk-mt_WinRAR-Vulnerability-recurrence-tutorial.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。该漏洞允许攻击者通过构造恶意的ZIP压缩包，在用户尝试查看压缩包内的文件时执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，该漏洞已被广泛利用，POC代码的存在也表明其有效性。多个安全厂商和研究人员都对此漏洞进行了分析并提供了相应的缓解措施。

**投毒风险分析：**
提供的POC代码包含以下文件：
*   `README.md`: 漏洞复现教程，包含漏洞信息和参考链接。
*   `执行命令.bat`: 一个简单的批处理文件，用于执行`calc.exe`（计算器程序），用于演示代码执行。
*   `文本.txt`: 包含一个URL地址。
*   `生成压缩包.py`: 一个Python脚本，用于生成包含漏洞的ZIP压缩包。

该脚本的主要功能是：
1.  创建临时目录，并将`执行命令.bat`复制到该目录。
2.  复制`文本.txt`文件到另一个目录。
3.  将上述两个目录打包成ZIP文件。
4.  修改ZIP文件中的文件名，利用漏洞的原理。
从代码本身来看，该脚本并没有明显的恶意代码，但是存在一定的投毒风险。
*   执行命令.bat： 虽然只是简单的calc.exe，但如果攻击者替换成其他恶意命令，则可能造成更大的危害。
*   脚本的依赖： 该脚本依赖Python环境，攻击者可能会通过修改脚本，引入恶意的Python依赖包，从而实现投毒。

综合来看，该仓库中存在一定的投毒风险，但不高。主要是因为演示的`执行命令.bat`内容比较简单，容易被识别。如果使用者直接运行此仓库的代码，有可能会被植入恶意程序。因此，投毒风险评定为10%。

**利用方式：**
1.  攻击者构造一个恶意的ZIP压缩包，该压缩包包含一个良性文件（例如，图片文件`文本.txt`）和一个与该文件同名的文件夹。
2.  该文件夹包含一个恶意可执行文件（例如，`执行命令.bat`并更名为`文本.txtA.cmd`）。
3.  当用户使用受影响的WinRAR版本打开该ZIP压缩包，并尝试查看良性文件时，WinRAR会错误地执行该文件夹中的恶意可执行文件，从而导致任意代码执行。

**项目地址:** [xk-mt/WinRAR-Vulnerability-recurrence-tutorial](https://github.com/xk-mt/WinRAR-Vulnerability-recurrence-tutorial)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #28

**来源**: [CVE-2023-38831-yezzfusl_cve_2023_38831_scanner.md](../2023/CVE-2023-38831-yezzfusl_cve_2023_38831_scanner.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开恶意的 ZIP 压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以通过构造一个特殊的 ZIP 压缩文件来利用此漏洞。该 ZIP 文件包含一个良性文件（例如 JPG）和一个同名的文件夹。当用户尝试访问良性文件时，WinRAR 会错误地执行文件夹中的恶意代码，导致远程代码执行。

**利用方式：**
1.  攻击者创建一个包含良性文件和同名文件夹的恶意 ZIP 文件。
2.  文件夹中包含要执行的恶意代码（例如，可执行文件）。
3.  攻击者诱使用户使用 WinRAR 打开该 ZIP 文件。
4.  当用户尝试访问良性文件时，WinRAR 会执行文件夹中的恶意代码。

**有效性：**
根据漏洞描述和搜索结果，该漏洞已在野外被利用，因此提供的PoC代码如果能够重现该行为，则可以认为是有效的。

**投毒风险：**
提供的代码仓库 `cve_2023_38831_scanner` 本身是一个漏洞扫描器，而非漏洞利用的PoC。尽管如此，仍然存在一定的投毒风险。代码中可能隐藏后门，虽然其主要功能是扫描，但理论上存在被篡改的风险。代码中使用了网络数据包分析、进程内存扫描、沙箱环境执行等模块，这些模块如果被恶意修改，可能被用于执行恶意操作。因此，综合考虑其扫描器的性质和潜在风险，投毒风险估计为10%。这个风险主要来自供应链投毒，如果下载了被篡改过的扫描器，那么扫描器本身可能成为攻击的一部分。

**项目地址:** [yezzfusl/cve_2023_38831_scanner](https://github.com/yezzfusl/cve_2023_38831_scanner)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #29

**来源**: [CVE-2023-38831-youmulijiang_evil-winrar.md](../2023/CVE-2023-38831-youmulijiang_evil-winrar.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 50%

## 详情

CVE-2023-38831是WinRAR在6.23版本之前存在的一个远程代码执行漏洞。该漏洞的利用方式是构造一个特殊的ZIP压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹。当用户尝试在WinRAR中查看该良性文件时，WinRAR会错误地执行该文件夹中的恶意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认该漏洞是有效的，并且已经在野外被利用。漏洞利用代码提供了一个框架，用于生成包含恶意payload的ZIP压缩包，从而实现远程代码执行。

**投毒风险分析：**
提供的代码是一个框架，用于生成漏洞利用的 ZIP 文件，包含生成 exp，邮件发送，下载链接生成等功能。代码中存在潜在的投毒风险，主要体现在以下几个方面：

1.  **Payload 植入:**  该框架可以自定义payload，如果用户在不了解 payload 内容的情况下使用，可能运行恶意指令。
2.  **代码可信度:** 虽然作者声明为安全开发成员，并开源了代码，但代码的安全性仍然需要进一步审计。存在作者预留后门的可能性。 考虑到这是一个漏洞利用框架，其本质就是为了执行恶意代码，所以判定为投毒代码的风险为50%。

**漏洞利用方式：**

1.  攻击者使用该漏洞利用框架(evil-winrar)生成一个恶意的 ZIP 压缩包。
2.  该 ZIP 压缩包包含一个良性文件（如JPG图片）和一个同名的文件夹，文件夹中包含恶意可执行文件。
3.  攻击者通过社会工程学等方式诱骗用户使用存在漏洞的 WinRAR 版本打开该 ZIP 压缩包。
4.  用户尝试查看良性文件时，WinRAR 会错误地执行同名文件夹中的恶意代码。
5.  恶意代码在用户系统上执行，攻击者从而实现远程代码执行，控制受害者的计算机。

**项目地址:** [youmulijiang/evil-winrar](https://github.com/youmulijiang/evil-winrar)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---



---

## POC #3

**来源**: [CVE-2023-38831-MaorBuskila_Windows-X64-RAT.md](../2023/CVE-2023-38831-MaorBuskila_Windows-X64-RAT.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者在用户尝试查看 ZIP 压缩包中的良性文件时执行任意代码。该漏洞源于 WinRAR 处理 ZIP 压缩包时，允许压缩包包含一个良性文件（例如 .JPG）和一个同名文件夹。当用户尝试访问该良性文件时，WinRAR 实际上会处理同名文件夹中的内容，从而允许攻击者在文件夹中放置恶意可执行文件并执行。

**有效性：**
从搜索结果和漏洞库信息来看，该漏洞已经被广泛利用，PoC 代码的存在也进一步验证了其有效性。

**投毒风险：**
提供的 Python 脚本 (`51721.py`) 用于生成 Windows x64 平台的反向 TCP Shellcode。该脚本本身不包含明显的恶意代码，功能是生成 shellcode。需要用户自行配置 IP 地址和端口。但是，由于该代码需要用户执行，并且可以生成任意 shellcode，存在一定投毒风险，例如，如果攻击者提供修改后的脚本，生成包含恶意功能的 shellcode (如删除文件，上传用户信息)，则用户可能无意中执行该恶意 shellcode. 脚本本身不包含网络连接或者其他与远程服务器通信的行为，可以基本判断代码仓库投毒风险较低.

**利用方式：**
1.  攻击者创建一个恶意的 ZIP 压缩包。
2.  该 ZIP 压缩包包含一个良性文件（例如 image.jpg）和一个同名文件夹（image.jpg）。
3.  同名文件夹包含恶意可执行文件，例如 exploit.exe，并可能包含一个 `.lnk` 文件，该快捷方式指向该恶意可执行文件。
4.  攻击者诱骗用户使用受影响版本的 WinRAR 打开该 ZIP 压缩包并尝试查看良性文件。
5.  WinRAR 错误地执行同名文件夹中的恶意可执行文件，从而导致远程代码执行。

**项目地址:** [MaorBuskila/Windows-X64-RAT](https://github.com/MaorBuskila/Windows-X64-RAT)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #4

**来源**: [CVE-2023-38831-MyStuffYT_CVE-2023-38831-POC.md](../2023/CVE-2023-38831-MyStuffYT_CVE-2023-38831-POC.md)

## CVE-2023-38831-WinRAR-远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的恶意ZIP压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个恶意的ZIP压缩文件，其中包含一个良性文件（例如.jpg）和一个同名的文件夹。当用户尝试在 WinRAR 中查看该良性文件时，WinRAR 会错误地执行该文件夹中的内容，从而导致任意代码执行。

**有效性：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。搜索引擎结果表明该漏洞已被广泛利用，POC代码的存在进一步证实了其有效性。

**投毒风险：**

根据对POC代码的分析，存在一定的投毒风险。`script.bat`脚本从github下载`Alert.exe`文件，这本身就存在一定的安全隐患，无法确保下载的文件一定是安全的。此外，脚本同时执行 `alert.exe` 和 `gtaleak.mp4`，而 `gtaleak.mp4` 在 README 中说明是 “zeros without ones”, 可以确定这是一个障眼法，实际的恶意行为是由 `alert.exe` 执行。 因此，作者可能隐藏了投毒代码。

**利用方式：**

1.  攻击者创建一个恶意的ZIP压缩文件，其中包含一个良性文件 (例如 `gtaleak.mp4`) 和一个同名的文件夹。
2.  该文件夹包含一个批处理脚本 (`script.bat`)，该脚本将从远程服务器下载并执行恶意程序 (`Alert.exe`)。
3.  当用户尝试使用 WinRAR 打开压缩文件并查看良性文件 (`gtaleak.mp4`) 时，WinRAR 会错误地执行批处理脚本。
4.  批处理脚本下载并执行恶意程序，从而允许攻击者在受害者的系统上执行任意代码。

**项目地址:** [MyStuffYT/CVE-2023-38831-POC](https://github.com/MyStuffYT/CVE-2023-38831-POC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #5

**来源**: [CVE-2023-38831-Nielk74_CVE-2023-38831.md](../2023/CVE-2023-38831-Nielk74_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本的代码执行漏洞。该漏洞允许攻击者在用户尝试查看ZIP存档中的看似无害的文件时执行任意代码。攻击者通过构造一个包含同名文件和文件夹的恶意ZIP文件，利用WinRAR处理文件路径时的逻辑缺陷，使得文件夹中的恶意可执行文件得以运行。提供的POC代码通过Vagrant自动化部署了一个易受攻击的WinRAR 6.22环境，并向虚拟机桌面添加了一个恶意的rar文件。该rar文件被设计为当用户点击其中的“无害”文件时，执行预先设定的恶意代码。尽管POC的主要目的是演示漏洞，但其中`ChocolateyInstall.ps1`脚本从外部源下载并安装软件包（Chocolatey和WinRAR），存在被篡改从而引入恶意代码的风险，这构成了潜在的投毒风险。虽然这个脚本很常见，但还是存在一定的风险，因此这里给出了10%的投毒风险。

**漏洞利用方式：**

1.  攻击者创建一个恶意的ZIP压缩包，其中包含一个看似无害的文件（例如.jpg），以及一个与该文件同名的文件夹。
2.  该文件夹包含恶意可执行文件，例如.exe或.cmd脚本。
3.  当用户尝试使用WinRAR打开ZIP压缩包并查看“无害”文件时，WinRAR会错误地执行同名文件夹中的恶意可执行文件，从而导致任意代码执行。
4.  攻击者可以利用此漏洞在受害者系统上安装恶意软件、窃取敏感数据或执行其他恶意操作。

**项目地址:** [Nielk74/CVE-2023-38831](https://github.com/Nielk74/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #6

**来源**: [CVE-2023-38831-RomainBayle08_CVE-2023-38831.md](../2023/CVE-2023-38831-RomainBayle08_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP或RAR压缩文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个特殊的 ZIP 压缩文件，该文件包含一个看似无害的文件（例如，.JPG 文件）和一个与该文件同名的文件夹。当用户尝试查看压缩文件中的无害文件时，WinRAR 会错误地执行文件夹中的内容，从而导致任意代码执行。

**有效性分析：**
提供的 POC 代码 `cve-2023-38831-exp-gen.py` 是一个漏洞利用生成器脚本，它接受诱饵文件 (`BAIT_NAME`)、脚本文件 (`SCRIPT_NAME`) 和额外的诱饵文件目录 (`BAIT_FILES`) 作为输入，并生成一个恶意 RAR 压缩文件 (`OUTPUT_NAME`)。脚本首先创建一个包含诱饵文件和脚本文件的临时目录结构，然后使用 `shutil.make_archive` 函数将该目录压缩为 ZIP 文件。关键在于，脚本会替换 ZIP 文件中特定文件的扩展名，利用 WinRAR 的漏洞，在用户尝试打开诱饵文件时执行脚本文件。`script.bat` 脚本会首先尝试打开诱饵文件（模拟用户行为），然后执行 `calc.exe`（作为漏洞利用成功的标志）。该 POC 的有效性较高，因为它模拟了真实的攻击场景。

**投毒风险分析：**
`cve-2023-38831-exp-gen.py` 脚本本身不包含明显的恶意代码或后门。但是，存在一定的投毒风险，因为该脚本允许攻击者指定要执行的任意脚本 (`SCRIPT_NAME`)。攻击者可以替换 `script.bat` 文件为包含恶意代码的文件，例如下载和执行其他恶意软件。此外，该脚本使用了`BAIT_FILES`参数，如果提供包含恶意文件的目录，也会构成投毒风险。所以存在一定投毒风险，但主要取决于用户提供的脚本和目录的内容。

**利用方式分析：**
1.  攻击者构造一个恶意 ZIP 压缩文件，其中包含一个诱饵文件（如 `CLASSIFIED_DOCUMENTS.pdf`）和一个与诱饵文件同名的文件夹。文件夹中包含一个脚本文件（如 `script.bat`）。
2.  攻击者将恶意 ZIP 文件发送给受害者，诱骗其使用 WinRAR 打开。
3.  当受害者尝试查看 ZIP 文件中的诱饵文件时，WinRAR 会错误地执行同名文件夹中的脚本文件。
4.  脚本文件执行任意代码，例如安装恶意软件或窃取敏感信息。

总的来说，该漏洞利用方式简单有效，风险较高。用户应尽快升级到 WinRAR 6.23 或更高版本。

**项目地址:** [RomainBayle08/CVE-2023-38831](https://github.com/RomainBayle08/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #7

**来源**: [CVE-2023-38831-RonF98_CVE-2023-38831-POC.md](../2023/CVE-2023-38831-RonF98_CVE-2023-38831-POC.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致任意代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831 是 WinRAR 在处理 ZIP 压缩文件时存在的一个漏洞。攻击者可以构造一个包含良性文件（例如 .jpg 文件）和一个同名文件夹的 ZIP 压缩包。该文件夹中包含恶意代码（例如 .cmd 文件）。当用户尝试查看良性文件时，WinRAR 会错误地执行文件夹中的恶意代码，从而导致远程代码执行。

**有效性：**

提供的 POC 代码有效，它演示了如何创建一个恶意的 RAR 文件来利用此漏洞。

*   `DoS.cmd` 文件包含恶意代码，用于创建多个消息框，模拟拒绝服务攻击。
*   `exploit.py` 脚本用于生成包含恶意 `DoS.cmd` 文件的 RAR 文件，并利用漏洞触发代码执行。
*   `README.md` 详细解释了漏洞原理和利用方法，并提供了攻击成功的截图。

**投毒风险：**

此仓库中可能存在轻微的投毒风险，约为5%。

*   `DoS.cmd` 只是一个简单的拒绝服务攻击示例，但攻击者可能会将其替换为更具破坏性的恶意代码，例如勒索软件或信息窃取程序。如果下载者不仔细检查 `DoS.cmd` 的内容，可能会在不知情的情况下运行恶意代码。
*   `exploit.py` 脚本本身没有明显的恶意代码，但它可以被修改以生成包含不同恶意代码的 RAR 文件。下载者应该仔细审查脚本的内容，确保它不会被用于传播恶意软件。

**利用方式：**

1.  攻击者创建一个包含良性文件（例如 `image.jpg`）和一个同名文件夹（例如 `image.jpg `）的 ZIP 压缩包。注意文件夹名称后面有一个空格。
2.  在同名文件夹中，攻击者放置恶意代码（例如 `image.jpg .cmd`）。
3.  攻击者将 ZIP 文件转换为 RAR 文件（POC 脚本完成了此过程）。
4.  攻击者诱骗用户使用受影响的 WinRAR 版本打开 RAR 文件并尝试查看良性文件（`image.jpg`）。
5.  WinRAR 错误地执行同名文件夹中的恶意代码 (`image.jpg .cmd`)，从而导致远程代码执行。

由于该漏洞被广泛利用，并且网上存在大量相关的 POC 代码，因此攻击者很容易发起攻击。


**项目地址:** [RonF98/CVE-2023-38831-POC](https://github.com/RonF98/CVE-2023-38831-POC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #8

**来源**: [CVE-2023-38831-SpamixOfficial_CVE-2023-38831.md](../2023/CVE-2023-38831-SpamixOfficial_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前的版本中的代码执行漏洞。攻击者可以制作一个特制的ZIP压缩包，其中包含一个良性文件和一个同名文件夹，文件夹中包含恶意可执行文件。当用户尝试在WinRAR中查看良性文件时，实际上会执行文件夹中的恶意代码。\n\n**有效性：**根据漏洞库信息、搜索结果和漏洞利用代码，该漏洞POC是有效的。漏洞库信息中明确指出该漏洞已在野外被利用。搜索结果中多个链接都指向了关于该漏洞的分析和利用报告。提供的`Cargo.lock`文件很可能只是rust项目依赖管理文件，无法直接证明POC的有效性，需配合rust源码进行分析。\n\n**投毒风险：**分析提供的`Cargo.lock`文件，该文件列出了Rust项目`CVE-2023-38831`的依赖项。虽然`Cargo.lock`本身不包含可执行代码，但是，如果恶意作者修改了依赖项的版本或来源，理论上存在引入被篡改过的crate（Rust包）的风险。不过，由于`Cargo.lock`文件明确指定了每个依赖项的checksum，Cargo在构建项目时会验证下载的crate是否与checksum匹配，从而降低了被投毒的风险。评估投毒风险为10%。\n\n**利用方式：**攻击者创建一个包含以下结构的ZIP压缩包：\n\n1.  一个良性的文件，例如 `image.jpg`\n2.  一个与良性文件同名的文件夹，例如 `image.jpg`\n3.  在同名文件夹中，放置恶意可执行文件，例如 `image.jpg.exe` 或 `image.jpg `(通过空格进行欺骗)。\n\n当用户使用存在漏洞的WinRAR版本打开该ZIP文件并尝试查看`image.jpg`时，WinRAR会错误地执行`image.jpg`文件夹中的恶意程序，从而实现远程代码执行。

**项目地址:** [SpamixOfficial/CVE-2023-38831](https://github.com/SpamixOfficial/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #9

**来源**: [CVE-2023-38831-Tolu12wani_Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution.md](../2023/CVE-2023-38831-Tolu12wani_Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在用户尝试查看 ZIP 压缩包中的文件时执行任意代码。

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开特制的 ZIP 压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者通过构造恶意的 ZIP 压缩包实现远程代码执行。该压缩包包含一个良性文件（例如 JPG）和一个与良性文件同名的文件夹。当用户尝试访问良性文件时，WinRAR 会错误地执行同名文件夹中的内容，从而执行攻击者放置的恶意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被广泛利用。 提供的POC代码描述的是在压缩文件中嵌入恶意payload，并触发反向shell的实验环境验证过程。虽然该代码本身没有包含恶意代码，但描述了如何构建利用该漏洞的压缩文件。

**投毒风险：**
提供的 POC 代码仓库中只包含 PDF 报告和截图，并没有可执行的恶意代码。 但是,README中说明了该仓库展示了恶意payload的嵌入方式，存在一定的潜在风险。 因此，存在一定的投毒风险，但风险较低。根据readme描述和文件结构，投毒风险评估为10%，

**利用方式：**
1.  **创建恶意 ZIP 压缩包：** 攻击者创建一个 ZIP 压缩包，其中包含一个良性文件（例如 JPG）和一个与良性文件同名的文件夹。
2.  **放置恶意代码：** 将恶意可执行文件放置在与良性文件同名的文件夹中。
3.  **诱骗用户：** 诱骗用户使用受影响的 WinRAR 版本打开该 ZIP 压缩包并尝试查看良性文件。
4.  **执行恶意代码：** WinRAR 错误地执行同名文件夹中的恶意代码，从而实现远程代码执行。

根据搜索结果，该漏洞已经被政府支持的攻击者利用，用于投放 RAT（远程访问木马）等恶意软件。

**项目地址:** [Tolu12wani/Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution](https://github.com/Tolu12wani/Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #10

**来源**: [CVE-2023-38831-VictoriousKnight_CVE-2023-38831_Exploit.md](../2023/CVE-2023-38831-VictoriousKnight_CVE-2023-38831_Exploit.md)

## CVE-2023-38831-WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码。

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的恶意ZIP文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个漏洞，它允许攻击者通过构造特殊的ZIP文件来执行任意代码。攻击者创建一个ZIP文件，其中包含一个良性文件（例如，JPG图片）和一个与该良性文件同名的文件夹。该文件夹中包含恶意可执行文件。当用户尝试在WinRAR中查看该良性文件时，WinRAR会错误地执行该文件夹中的恶意代码，从而导致远程代码执行。

**有效性：** 提供的POC代码是有效的。根据漏洞库信息和搜索结果，该漏洞在野外被广泛利用。POC代码通过创建包含良性文件和同名文件夹的恶意ZIP文件，并利用WinRAR处理文件时的缺陷来执行代码。POC代码结构清晰，易于理解和使用。

**投毒风险：** 提供的POC代码本身主要是利用漏洞生成EXP，但仔细检查代码，在`exploit.py`文件的zip文件内容操作部分被截断，没有展示修改zip文件内容的关键代码，作者可能在`Read and manipulate the zip file content`部分添加恶意代码，执行修改zip文件过程中的任何恶意行为。因此存在一定的投毒风险，根据代码完整度，我给出10%的投毒风险。

**利用方式：**
1.  攻击者创建一个恶意ZIP文件，其中包含一个看似无害的文件（例如，一个图片或PDF）。
2.  在ZIP文件中，攻击者同时创建一个与该无害文件同名的文件夹。
3.  该文件夹包含攻击者想要执行的恶意代码，通常是一个可执行文件或脚本。
4.  攻击者诱使用户使用存在漏洞的WinRAR版本打开该ZIP文件。
5.  当用户尝试访问ZIP文件中的“无害”文件时，WinRAR会错误地执行同名文件夹中的恶意代码。

**项目地址:** [VictoriousKnight/CVE-2023-38831_Exploit](https://github.com/VictoriousKnight/CVE-2023-38831_Exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #11

**来源**: [CVE-2023-38831-anelya0333_Exploiting-CVE-2023-38831.md](../2023/CVE-2023-38831-anelya0333_Exploiting-CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开特制的ZIP压缩文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞允许攻击者通过特制的ZIP压缩文件在目标系统上执行任意代码。该漏洞的根源在于WinRAR在处理包含与文件同名文件夹的ZIP文件时存在缺陷。攻击者可以构造一个 ZIP 文件，其中包含一个良性文件（例如.JPG）和一个与其同名的文件夹。当用户尝试在 WinRAR 中查看该良性文件时，WinRAR 会错误地执行该文件夹中的恶意代码。此PoC脚本生成一个ZIP文件，其中包含诱饵文件(bait file)和恶意脚本(script file)，并修改ZIP文件的文件头，以利用此漏洞。脚本创建与诱饵文件同名的文件夹，并将恶意脚本放入其中。然后，将诱饵文件的副本也放入ZIP文件中。通过替换文件名字段中的某些字符，WinRAR会将文件夹中的恶意文件误认为是要执行的文件，最终导致代码执行。由于代码仅仅是构造payload，不存在主动执行恶意代码，因此不存在投毒风险。

**项目地址:** [anelya0333/Exploiting-CVE-2023-38831](https://github.com/anelya0333/Exploiting-CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #12

**来源**: [CVE-2023-38831-b1tg_CVE-2023-38831-winrar-exploit.md](../2023/CVE-2023-38831-b1tg_CVE-2023-38831-winrar-exploit.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可导致完全系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开恶意构造的ZIP文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 允许攻击者通过特制的ZIP文件在受害者系统上执行任意代码。该漏洞源于 WinRAR 处理包含同名文件和文件夹的 ZIP 档案时的不当行为。攻击者可以创建一个 ZIP 文件，其中包含一个良性文件（例如 CLASSIFIED_DOCUMENTS.pdf）和一个同名文件夹（例如 CLASSIFIED_DOCUMENTS.pdf）。当用户尝试访问良性文件时，WinRAR 实际上会执行该文件夹中的内容（例如 script.bat）。

**有效性:**

提供的 POC 代码 `cve-2023-38831-exp-gen.py` 旨在生成利用此漏洞的恶意 RAR 档案。该脚本通过以下步骤工作：

1.  创建临时目录 `TEMPLATE`。
2.  在 `TEMPLATE` 中创建一个与bait文件同名的文件夹，并在其中存放包含恶意命令的script文件（例如 `script.bat`， 其中包含`calc.exe & CLASSIFIED_DOCUMENTS.pdf`）。
3.  将bait文件存放在`TEMPLATE`目录。
4.  将`TEMPLATE`目录压缩为zip文件。
5.  修改压缩包中文件和文件夹的名字，构造漏洞。
6.  最终输出 `CVE-2023-38831-poc.rar`。

该脚本能够有效地生成利用 CVE-2023-38831 的 RAR 文件，因此提供的 POC 代码是有效的。

**投毒风险:**

对提供的 POC 代码 (`cve-2023-38831-exp-gen.py` 和 `script.bat`) 进行分析后，未发现明显的恶意代码或后门。该脚本的功能明确且集中于生成利用 CVE-2023-38831 的 RAR 档案。 `script.bat` 的主要功能是启动计算器程序 (`calc.exe`) 并尝试打开诱饵文档 (`CLASSIFIED_DOCUMENTS.pdf`)，这是一个典型的 PoC 行为。 因此，该仓库中存在作者隐藏的投毒代码的风险极低。

**利用方式:**

1.  攻击者使用 `cve-2023-38831-exp-gen.py` 脚本，指定诱饵文件（例如 `CLASSIFIED_DOCUMENTS.pdf`）和恶意脚本（例如 `script.bat`），生成恶意 RAR 档案。
2.  攻击者通过各种方式（例如，电子邮件、恶意网站）将恶意 RAR 档案分发给受害者。
3.  受害者使用易受攻击的 WinRAR 版本（< 6.23）打开恶意 RAR 档案。
4.  当受害者尝试访问诱饵文件时，WinRAR 错误地执行了同名文件夹中的恶意脚本。
5.  恶意脚本在受害者系统上执行任意代码，例如启动计算器或安装恶意软件。

**项目地址:** [b1tg/CVE-2023-38831-winrar-exploit](https://github.com/b1tg/CVE-2023-38831-winrar-exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #13

**来源**: [CVE-2023-38831-elefantesagradodeluzinfinita_cve-2023-38831.md](../2023/CVE-2023-38831-elefantesagradodeluzinfinita_cve-2023-38831.md)

## CVE-2023-38831 - WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用 WinRAR 打开特制的 ZIP 压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者通过特制的 ZIP 压缩包在受害者系统上执行任意代码。漏洞利用方式是创建一个 ZIP 压缩包，其中包含一个良性文件（例如 .jpg 或 .pdf）以及一个同名的文件夹。该文件夹包含恶意的可执行文件（例如 .cmd 或 .exe）。当用户尝试打开良性文件时，WinRAR 会错误地执行文件夹中的恶意代码。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码分析，该漏洞确实存在并且已经被野外利用。提供的代码描述了一个利用工具 "DR. GANDALF"，它允许用户创建包含此漏洞的 ZIP 文件，表明POC的有效性。

**投毒风险：** 提供的 README.md 文件主要描述了漏洞原理和利用工具的使用方法。但是，由于此工具允许用户自定义注入的代码和二进制文件，因此存在投毒风险。如果用户下载了包含恶意注入代码的ZIP文件，那么这个工具本身可能被利用来传播恶意软件。评估投毒风险为 10%，因为该描述文件本身不包含可以直接执行的后门代码，但生成的ZIP文件可以包含。

**利用方式：**
1.  攻击者创建一个包含恶意 ZIP 压缩包。
2.  ZIP 压缩包中包含一个良性文件（例如，`image.jpg`）和一个同名的文件夹（例如，`image.jpg`）。
3.  `image.jpg` 文件夹包含恶意的可执行文件（例如，`evil.cmd`）。
4.  攻击者诱骗受害者使用存在漏洞的 WinRAR 版本打开该 ZIP 压缩包并尝试访问良性文件 `image.jpg`。
5.  WinRAR 在处理该 ZIP 文件时，会错误地执行 `image.jpg` 文件夹中的恶意代码 `evil.cmd`，从而导致远程代码执行。

**项目地址:** [elefantesagradodeluzinfinita/cve-2023-38831](https://github.com/elefantesagradodeluzinfinita/cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #14

**来源**: [CVE-2023-38831-h3xecute_SideCopy-Exploits-CVE-2023-38831.md](../2023/CVE-2023-38831-h3xecute_SideCopy-Exploits-CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个远程代码执行漏洞。该漏洞的利用方式是构造一个特殊的ZIP压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹。当用户尝试使用WinRAR打开该ZIP压缩包并访问良性文件时，WinRAR会错误地执行文件夹中的恶意代码。

**有效性：**
提供的POC代码描述了漏洞利用的原理，即构造包含同名良性文件和文件夹的ZIP压缩包。根据漏洞信息和搜索结果，此方法是有效的，并且在野外被利用。

**投毒风险：**
该POC本身描述了漏洞的利用方式，包含一个指向YouTube视频的链接，以及对恶意压缩包结构的描述。投毒风险较低，约为10%，因为：
1.  POC主要以描述性文字和图片链接为主。
2.  缺乏直接可执行的payload代码。
3.  作者可能通过YouTube链接传播恶意信息。

**利用方式：**
1.  攻击者创建一个恶意的ZIP压缩包。
2.  该压缩包包含一个良性文件（例如JPG，PDF等）和一个与该文件同名的文件夹。
3.  恶意代码（例如，可执行文件）放置在同名文件夹中。
4.  攻击者诱骗用户使用WinRAR打开这个ZIP压缩包，并尝试访问良性文件。
5.  WinRAR在处理压缩包时，会错误地执行同名文件夹中的恶意代码，从而导致远程代码执行。

**项目地址:** [h3xecute/SideCopy-Exploits-CVE-2023-38831](https://github.com/h3xecute/SideCopy-Exploits-CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #15

**来源**: [CVE-2023-38831-idkwastaken_CVE-2023-38831.md](../2023/CVE-2023-38831-idkwastaken_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意的ZIP文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的漏洞。该漏洞的利用方式是创建一个特制的ZIP文件，其中包含一个良性文件和一个同名文件夹。当用户尝试使用WinRAR打开ZIP文件并访问该良性文件时，WinRAR会错误地执行该同名文件夹中的恶意代码，导致远程代码执行。

**有效性：**
提供的POC代码（exploit.c）利用了该漏洞。该代码生成一个ZIP文件，其中包含一个PDF文件（document.pdf）和一个名为“document.pdf\”的文件夹，该文件夹内包含一个恶意的批处理脚本（script.bat）。当用户在易受攻击的WinRAR版本中打开并尝试访问该PDF文件时，WinRAR将执行该批处理脚本。
checker.bat 是用来检测目标系统是否安装WinRAR，以及WinRAR的版本是否是受影响的版本。
exploit.ps1 看起来不完整，但是其作用应该是检查WinRAR版本。

**投毒风险：**
代码中存在一定的投毒风险，约为10%。原因如下：
*   **脚本内容可控：** exploit.c 中的script_content变量包含了要执行的命令，虽然当前POC仅仅是弹窗，但是攻击者可以修改这个变量，执行任意命令，例如下载恶意软件，执行系统命令等。
*   **复杂的构建过程：** exploit.c 代码本身比较复杂，阅读和分析需要一定的时间和精力。攻击者可以利用这一点，在代码中隐藏不易察觉的恶意代码。
虽然有潜在的投毒风险，但当前代码的主要目的是演示漏洞利用，风险较低，作者没有明显的隐藏后门行为，恶意代码比较容易被发现。

**利用方式：**
1.  攻击者创建一个恶意的ZIP压缩包，其中包含：
    *   一个良性的文件（例如 document.pdf）。
    *   一个与良性文件同名的文件夹（例如 document.pdf/）。
    *   恶意代码位于同名文件夹中（例如 document.pdf/script.bat）。
2.  攻击者诱骗目标用户使用存在漏洞的 WinRAR 版本打开此 ZIP 压缩包。
3.  当用户尝试打开良性文件时，WinRAR 错误地执行同名文件夹中的恶意代码，从而导致任意代码执行。


**项目地址:** [idkwastaken/CVE-2023-38831](https://github.com/idkwastaken/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #16

**来源**: [CVE-2023-38831-imbyter_imbyter-WinRAR_CVE-2023-38831.md](../2023/CVE-2023-38831-imbyter_imbyter-WinRAR_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 6.23

**利用条件:** 用户使用受影响的WinRAR版本打开特制的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于WinRAR 6.23之前的版本中。攻击者可以构造一个恶意的ZIP压缩包，其中包含一个伪装成良性文件的文件（例如 .jpg），以及一个同名的文件夹。当用户尝试在 WinRAR 中查看该“良性文件”时，实际上会执行同名文件夹中的恶意代码（例如 .cmd 或 .exe 文件）。

**有效性：**
根据漏洞信息和搜索结果，提供的POC代码是有效的。该POC利用了WinRAR处理ZIP压缩包时存在的逻辑漏洞，能够实现远程代码执行。

**投毒风险：**
提供的Python脚本 `make-poc.py` 用于生成POC压缩包，其本身的代码逻辑相对简单，主要功能是将指定的文件和脚本打包成特定的ZIP格式，并进行一些字符串替换以触发漏洞。主要风险在于脚本生成的POC包中包含的脚本，如果这个脚本是恶意的，那么整个利用过程就存在投毒风险。 仓库中的README.md文件里的测试脚本就是一个关闭计算机的脚本。代码本身存在一定的投毒风险.

*   脚本逻辑：脚本的功能是创建包含漏洞利用结构的RAR文件。
*   恶意操作：如果脚本被修改以包含下载和执行恶意软件的逻辑，那么用户在使用此脚本创建RAR文件时，就会受到投毒攻击。

**利用方式：**
1.  攻击者使用 `make-poc.py` 脚本构造恶意的ZIP压缩包，需要提供一个“良性”文件和一个恶意脚本。
2.  攻击者将恶意的ZIP压缩包发送给受害者。
3.  受害者使用受影响的WinRAR版本打开该ZIP压缩包，并尝试查看伪装的“良性”文件。
4.  WinRAR错误地执行了与“良性”文件同名的文件夹中的恶意脚本，导致远程代码执行。

**防御措施：**
*   升级WinRAR到6.23或更高版本。
*   谨慎打开来源不明的ZIP压缩包。
*   使用杀毒软件扫描ZIP压缩包。

**项目地址:** [imbyter/imbyter-WinRAR_CVE-2023-38831](https://github.com/imbyter/imbyter-WinRAR_CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #17

**来源**: [CVE-2023-38831-kehrijksen_CVE-2023-38831.md](../2023/CVE-2023-38831-kehrijksen_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 需要用户解压特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个恶意的 ZIP 压缩包，其中包含一个伪装成普通文件的文件和一个同名的文件夹。当用户尝试在 WinRAR 中查看该“普通文件”时，WinRAR 会错误地执行同名文件夹中的内容，从而导致任意代码执行。

**有效性：**
提供的 PoC 代码 `poc.py` 能够生成利用此漏洞的恶意 ZIP 压缩包。该脚本首先创建一个包含恶意 payload (例如 script.bat) 和良性文件 (例如 pepe.jpg) 的目录结构。然后，它将此目录结构压缩成 ZIP 文件，并修改 ZIP 文件中的文件名，以触发漏洞。`script.bat` 的作用是在 `%TEMP%` 目录下提取 ZIP 文件内容，运行良性文件作为诱饵，然后执行恶意操作，例如创建一个包含 “hacked” 内容的文本文件并使用记事本打开。

**投毒风险：**
分析提供的代码，没有发现明显的投毒代码。`poc.py` 的作用是生成恶意 ZIP 文件，而 `script.bat` 包含的是恶意行为的代码，例如运行良性文件，创建 `hacked.txt` 等。这些行为是漏洞利用的一部分，而不是隐藏的恶意代码。虽然利用 `script.bat` 可以执行任意操作，但这属于漏洞利用的范畴，而非代码投毒。

**利用方式：**
1.  攻击者使用 `poc.py` 脚本生成一个恶意的 ZIP 压缩包，其中包含一个良性文件（例如图片）和一个同名的文件夹。
2.  攻击者将此恶意 ZIP 压缩包发送给受害者。
3.  受害者使用 WinRAR (6.23 之前的版本) 打开并尝试查看 ZIP 压缩包中的良性文件。
4.  WinRAR 错误地执行与良性文件同名的文件夹中的内容 (由 `script.bat` 控制)。
5.  `script.bat` 首先将 ZIP 文件的内容解压到临时目录。
6.  `script.bat` 运行良性文件（例如图片）作为诱饵，以迷惑受害者。
7.  `script.bat` 执行任意恶意操作，例如创建文件，修改注册表，安装恶意软件等。


**项目地址:** [kehrijksen/CVE-2023-38831](https://github.com/kehrijksen/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #18

**来源**: [CVE-2023-38831-khanhtranngoccva_cve-2023-38831-poc.md](../2023/CVE-2023-38831-khanhtranngoccva_cve-2023-38831-poc.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。该漏洞源于WinRAR处理ZIP压缩包时，对文件名和文件夹名区分不当。攻击者可以创建一个ZIP压缩包，其中包含一个良性文件（例如JPG）和一个同名的文件夹。该文件夹中包含恶意可执行文件。当用户尝试在WinRAR中打开该良性文件时，WinRAR会错误地执行文件夹中的恶意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已在野外被利用，证明了其有效性。提供的POC代码片段（package-lock.json）显示使用了jszip库，表明该POC可能用于创建恶意的ZIP压缩包，进一步验证漏洞的可利用性。

**投毒风险：**
提供的POC代码片段是`package-lock.json`文件，主要描述了项目依赖。要判断是否存在投毒风险，需要检查实际的利用代码（例如 index.ts/index.js）。
*   这个`package-lock.json`文件本身不包含恶意代码，只是依赖声明。
*   **风险点在于开发者可能在其他代码文件中（如index.ts等，此文件未提供）包含恶意代码**。
*   jszip 库本身是一个常用的 ZIP 文件操作库，被投毒的可能性较低。
*   tsx和typescript是typescript相关工具，本身被投毒的可能性也比较低

由于缺乏实际的利用代码，无法确定是否存在投毒行为，只能根据现有信息进行推测，因此将投毒风险评估为10%。

**利用方式：**
1.  攻击者构造一个恶意的ZIP压缩包。
2.  该ZIP压缩包包含一个良性文件（例如JPG）和一个同名的文件夹。
3.  该文件夹中包含恶意可执行文件（例如EXE、BAT、CMD等）。
4.  攻击者诱骗用户使用受影响的WinRAR版本打开该ZIP压缩包。
5.  用户尝试在WinRAR中打开该良性文件。
6.  WinRAR错误地执行文件夹中的恶意代码，导致远程代码执行。

**项目地址:** [khanhtranngoccva/cve-2023-38831-poc](https://github.com/khanhtranngoccva/cve-2023-38831-poc)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #19

**来源**: [CVE-2023-38831-kuyrathdaro_winrar-cve-2023-38831.md](../2023/CVE-2023-38831-kuyrathdaro_winrar-cve-2023-38831.md)

## CVE-2023-38831-WinRAR代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个代码执行漏洞。该漏洞的利用方式如下：

1.  攻击者创建一个恶意的ZIP压缩包（伪装成RAR格式，后缀名为.rar）。
2.  该压缩包包含一个良性的文件（例如，document.pdf），以及一个与该良性文件同名的文件夹（例如，document.pdf）。
3.  同名文件夹中包含恶意payload（例如，一个.bat或.exe文件），命名为`document.pdfA.cmd`。
4.  用户使用存在漏洞的WinRAR版本打开该压缩包，并尝试打开良性文件（document.pdf）。
5.  由于WinRAR处理文件名的缺陷，实际上执行的是同名文件夹中的恶意payload。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以判断该漏洞PoC有效。搜索引擎结果中多个链接表明该漏洞已被广泛利用，并且Google的威胁分析小组也分析了利用该漏洞进行的攻击活动。提供的PoC代码实现了生成恶意RAR压缩包的逻辑，进一步验证了该漏洞的可利用性。

**投毒风险：**

PoC代码本身的主要功能是生成利用CVE-2023-38831漏洞的恶意压缩包。然而，我们仍然需要评估该代码是否存在潜在的投毒风险。以下是对代码的分析：

*   **代码功能明确：** PoC代码的功能是生成特定的文件结构和内容，以触发WinRAR漏洞。代码逻辑相对简单，易于理解。
*   **输入/输出控制：** PoC代码接受三个输入参数：良性文件、Payload文件和输出文件名。这三个参数都由用户指定，PoC本身没有主动下载或执行任何其他代码的功能。
*   **潜在风险点：** `exploit.py` 脚本使用 `shutil.copyfile` 函数来复制 payload 文件到临时目录，如果payload 文件本身就是恶意的，那么这也会造成风险。此外，尽管脚本尝试确保输出文件以 `.rar` 结尾，但恶意用户可能修改此行为。
*   **间接风险：** 如果攻击者修改了提供的 `exploit.py` 脚本，添加额外的恶意功能（例如，在生成恶意压缩包后，自动上传到恶意服务器），则可能存在投毒风险。但是，这并非原始PoC代码本身的问题。

综合来看，原始PoC代码本身存在直接投毒的风险较低，我估计的投毒风险概率为 **10%**。这主要是因为恶意 payload 本身会带来风险，但 PoC 代码并没有主动引入恶意行为。

**利用方式：**

1.  准备一个良性的文件（例如，document.pdf）和一个恶意payload（例如，script.bat或malware.exe）。
2.  运行PoC脚本，指定良性文件、payload文件和输出文件名。
3.  PoC脚本生成一个恶意的RAR压缩包（实际上是ZIP格式，但后缀名为.rar）。
4.  将该恶意RAR压缩包发送给目标用户。
5.  目标用户使用存在漏洞的WinRAR版本打开该压缩包，并尝试打开良性文件。
6.  WinRAR执行同名文件夹中的恶意payload，从而实现代码执行。


**项目地址:** [kuyrathdaro/winrar-cve-2023-38831](https://github.com/kuyrathdaro/winrar-cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #20

**来源**: [CVE-2023-38831-malvika-thakur_CVE-2023-38831.md](../2023/CVE-2023-38831-malvika-thakur_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以通过创建一个特制的 ZIP 压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹，文件夹中包含恶意可执行文件。当用户尝试在 WinRAR 中查看该良性文件时，由于 WinRAR 处理逻辑的缺陷，会错误地执行文件夹中的恶意代码，从而导致远程代码执行。

**有效性：**

提供的 POC 代码 `poc.py`  可以生成利用此漏洞的 ZIP 文件。代码首先检查恶意脚本和良性文件是否存在，然后创建一个目录，将脚本和良性文件复制到特定结构中，最后将该目录压缩成 ZIP 文件。用户只需双击压缩包内的良性文件即可触发漏洞，执行恶意脚本。因此，POC 代码有效。

**投毒风险：**

分析提供的 `poc.py` 代码，没有发现明显的投毒代码。该脚本的主要功能是生成利用 CVE-2023-38831 漏洞的恶意 ZIP 文件。它需要用户提供恶意脚本和良性文件，然后按照特定目录结构进行组织并压缩。代码中没有发现任何会执行额外恶意操作的逻辑。`README.md` 文件也仅包含漏洞描述和使用说明，没有发现恶意内容。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者创建一个包含良性文件（如 JPG 图片）和一个同名文件夹的 ZIP 压缩包。
2.  该文件夹中包含恶意可执行文件（如 BAT 脚本）。
3.  攻击者将该 ZIP 压缩包发送给目标用户。
4.  目标用户使用受影响的 WinRAR 版本打开该 ZIP 压缩包。
5.  目标用户双击 ZIP 压缩包中的良性文件。
6.  WinRAR 错误地执行同名文件夹中的恶意可执行文件，导致远程代码执行。

**项目地址:** [malvika-thakur/CVE-2023-38831](https://github.com/malvika-thakur/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #21

**来源**: [CVE-2023-38831-r1yaz_winDED.md](../2023/CVE-2023-38831-r1yaz_winDED.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开特制的恶意 ZIP 压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 是 WinRAR 在处理 ZIP 压缩文件时存在的远程代码执行漏洞。当 WinRAR 版本低于 6.23 时，如果用户尝试打开一个包含恶意构造的 ZIP 文件，攻击者可以利用此漏洞执行任意代码。该 ZIP 文件包含一个良性文件（例如 JPG 文件）和一个与其同名的文件夹。攻击者可以将可执行文件放置在该文件夹中，当用户尝试访问良性文件时，WinRAR 会错误地执行文件夹中的可执行文件。

**有效性：**
提供的 POC 代码（winDED）通过生成恶意 ZIP 文件来演示漏洞利用。它创建了一个良性文件和一个同名文件夹，并将恶意脚本放入文件夹中。用户双击压缩包中的 PDF 文件时，实际上会执行该恶意脚本，从而证明漏洞的可利用性。

**投毒风险：**
根据提供的 POC 代码，投毒风险较低。代码主要是为了演示漏洞而设计的，虽然存在执行恶意 `super_sneaky_evil_script.bat` 的可能性，但该脚本本身是由用户提供的，或者可以通过查看代码本身来确认其行为。 然而，仍然存在一些细微的风险，例如，如果 `super_sneaky_evil_script.bat` 本身是从其他来源下载的，则可能包含恶意代码。  总的来说, 投毒风险约 10%。

**利用方式：**
1.  创建一个包含良性文件 (例如，`BILLION_DOLLAR_SECRET.pdf`) 和一个同名文件夹 (`BILLION_DOLLAR_SECRET.pdf`) 的 ZIP 压缩文件。
2.  将恶意脚本 (例如，`super_sneaky_evil_script.bat`) 放入同名文件夹中。
3.  诱骗目标用户使用 WinRAR 打开该 ZIP 文件。
4.  当用户尝试打开良性文件时，WinRAR 错误地执行同名文件夹中的恶意脚本，从而实现远程代码执行。

**项目地址:** [r1yaz/winDED](https://github.com/r1yaz/winDED)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #22

**来源**: [CVE-2023-38831-ra3edAJ_LAB-DFIR-cve-2023-38831.md](../2023/CVE-2023-38831-ra3edAJ_LAB-DFIR-cve-2023-38831.md)

## CVE-2023-38831-WinRAR代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 是 WinRAR 在 6.23 版本之前存在的远程代码执行漏洞。该漏洞源于WinRAR处理ZIP压缩包时，如果压缩包中包含一个良性文件和一个与该良性文件同名的文件夹，WinRAR在尝试访问良性文件时，会错误地执行同名文件夹中的恶意内容。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的PoC是可用的。漏洞在野外被广泛利用，并且CISA已将其添加到已知被利用的漏洞目录中。

**投毒风险：**
提供的漏洞利用代码为一个Github仓库的README.md文件，主要描述了如何利用磁盘镜像调查CVE-2023-38831攻击，并通过Windows注册表、NTFS文件和浏览器缓存理解Windows事件序列。仓库本身目的是为了DFIR分析，因此直接包含恶意代码的可能性较低。但考虑到链接跳转至外部教程网站，存在间接投毒的可能，即教程内容可能包含引导至恶意软件下载或运行恶意脚本的指令。因此，投毒风险较低，评估为10%。

**利用方式：**
1.  **创建恶意的ZIP压缩包：** 压缩包中包含一个良性文件（如JPG图片）和一个与该良性文件同名的文件夹。
2.  **将恶意可执行文件放入同名文件夹：** 该文件夹中的可执行文件会在用户尝试打开良性文件时被执行。
3.  **诱导用户打开ZIP压缩包：** 通过社交工程或其他方式，诱导用户使用受影响版本的WinRAR打开该压缩包。
4.  **触发漏洞执行恶意代码：** 当用户尝试查看ZIP压缩包中的良性文件时，WinRAR会错误地执行同名文件夹中的恶意代码，从而实现远程代码执行。

**总结：**
该漏洞利用方式较为简单，易于传播，危害较大。用户应及时更新WinRAR至最新版本，避免打开来源不明的ZIP压缩包。

**项目地址:** [ra3edAJ/LAB-DFIR-cve-2023-38831](https://github.com/ra3edAJ/LAB-DFIR-cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #23

**来源**: [CVE-2023-38831-ruycr4ft_CVE-2023-38831.md](../2023/CVE-2023-38831-ruycr4ft_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的远程代码执行漏洞。该漏洞源于WinRAR在处理ZIP压缩包时，对文件名和文件夹名相同的情况处理不当。攻击者可以构造一个恶意的ZIP压缩包，其中包含一个看似无害的文件（例如.jpg），同时包含一个同名的文件夹。当用户尝试打开该“无害文件”时，WinRAR会错误地执行同名文件夹中的恶意代码。\n\n**有效性：** 根据漏洞信息、搜索结果以及提供的POC代码，该漏洞利用是有效的。多个来源都表明该漏洞已被广泛利用，POC代码也展示了如何生成包含恶意代码的RAR压缩文件。POC代码通过创建同名文件和文件夹，并在文件夹中放入恶意脚本，利用WinRAR的缺陷触发代码执行。\n\n**投毒风险：**  仓库的投毒风险较低，大概10%。
  *   `poc.py`: 该脚本的功能是生成利用 CVE-2023-38831 的恶意 RAR 文件。虽然它允许用户指定 bait 文件和脚本文件，但脚本本身不包含任何预设的、隐藏的恶意行为。
  *   `script.bat`:  这个批处理文件包含使用 `nc.exe` (netcat) 反弹 shell 的命令。**这里存在一定的投毒风险。** 批处理文件明确地使用了`192.168.0.107`这个IP地址,如果用户直接使用该IP反弹shell,将会连接到攻击者的服务器。虽然IP地址可以被用户更改，但在默认情况下，如果用户不修改，将会连接到攻击者的IP。这是主要的投毒点。
  *   README.md: 该文件仅包含漏洞的简单介绍和演示图片。没有发现恶意代码。

**利用方式：**\n1.  攻击者创建一个恶意的ZIP压缩包。该压缩包包含一个诱饵文件（例如图片.jpg）和一个与其同名的文件夹（例如图片.jpg）。\n2.  攻击者将恶意代码（例如一个批处理脚本或可执行文件）放入同名文件夹中。\n3.  攻击者将包含恶意代码的ZIP压缩包发送给受害者。\n4.  受害者使用存在漏洞的WinRAR版本打开该ZIP压缩包，并尝试打开诱饵文件。\n5.  WinRAR错误地执行同名文件夹中的恶意代码，导致远程代码执行。

**项目地址:** [ruycr4ft/CVE-2023-38831](https://github.com/ruycr4ft/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #24

**来源**: [CVE-2023-38831-s4m98_winrar-cve-2023-38831-poc-gen.md](../2023/CVE-2023-38831-s4m98_winrar-cve-2023-38831-poc-gen.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开恶意的ZIP/RAR压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于WinRAR处理ZIP压缩文件时，由于对文件名和文件夹名处理不当导致。攻击者可以构造一个包含恶意脚本的ZIP压缩文件，该压缩文件包含一个正常的诱饵文件（如PDF、PNG或JPG）和一个同名的文件夹，当用户尝试打开诱饵文件时，WinRAR会错误地执行该文件夹中的恶意脚本。

**有效性：**
根据漏洞信息、搜索引擎结果和漏洞利用代码，该POC代码有效。漏洞库信息表明该漏洞已被野外利用。搜索引擎结果中也包含了大量关于此漏洞的分析和利用报告，证实了该漏洞的有效性。POC代码的描述和实现也符合漏洞的利用方式，通过生成包含恶意脚本和诱饵文件的RAR压缩包来触发漏洞。

**投毒风险：**
代码本身看起来比较直接，主要是生成利用漏洞的压缩包。`script.bat` 这个文件需要额外注意。当前提供的 `script.bat` 只是打开了计算器 `calc.exe` 和 Web_Security.pdf,相对来说是安全的，但用户在使用该漏洞时，完全可以修改此文件，添加更加恶意的payload，具有一定的风险。作者在代码中没有明显投毒行为，主要风险在于用户如何使用该工具生成payload。
投毒风险评估：10% (主要是用户修改 `script.bat` 的风险)

**利用方式：**
1.  **构造恶意ZIP/RAR压缩文件：** 利用提供的Python脚本（cve-2023-38831-exp-gen.py）生成恶意的ZIP/RAR压缩文件。此脚本需要一个诱饵文件（如PDF、PNG、JPG）和一个恶意脚本文件（如BAT、CMD、或可执行文件）。该脚本会创建一个包含诱饵文件和一个同名文件夹的压缩包，并将恶意脚本放置在该文件夹中。
2.  **诱骗用户打开压缩文件：**  将生成的恶意ZIP/RAR压缩文件发送给目标用户。
3.  **执行恶意代码：** 当用户使用受影响的WinRAR版本打开压缩文件并尝试查看诱饵文件时，WinRAR会错误地执行同名文件夹中的恶意脚本，从而实现远程代码执行。

 总体来说，该漏洞利用方式较为简单，攻击成本较低，风险较高。

**项目地址:** [s4m98/winrar-cve-2023-38831-poc-gen](https://github.com/s4m98/winrar-cve-2023-38831-poc-gen)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #25

**来源**: [CVE-2023-38831-solomon12354_VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC.md](../2023/CVE-2023-38831-solomon12354_VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要解压恶意的ZIP/RAR压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 存在于 WinRAR 6.23 之前版本中。攻击者可以构造一个包含良性文件和同名文件夹的 ZIP 压缩包，当用户尝试访问良性文件时，WinRAR 会错误地执行同名文件夹中的恶意代码。提供的 `exploit.py` 脚本可以用于生成包含漏洞利用的RAR压缩文件。脚本首先要求输入良性文件（`bait_file`）、恶意脚本文件（`script_file`）和输出RAR文件名称。然后，它创建一个临时目录，将恶意脚本复制到与良性文件同名的目录中，并将良性文件复制到临时目录中。最后，使用 `shutil.make_archive` 函数将临时目录压缩成 ZIP 文件，并修改 ZIP 文件的内容，将目录名中的 'A' 和 'B' 替换为空格，从而绕过 WinRAR 的安全检查。最终，将修改后的 ZIP 文件重命名为 RAR 文件。

`squid.bat` 用于下载并执行 `volleysquid.exe`。`volleyballsquid.py` 尝试利用 BypassUAC 来提升权限并将程序设置为开机自启。

**有效性:** 根据漏洞信息和利用代码分析，提供的 POC 代码有效，可以利用此漏洞在受害者机器上执行任意代码。

**投毒风险:** 仓库中存在一定的投毒风险，虽然主要功能是利用CVE-2023-38831漏洞，但是 `volleyballsquid.py`和`squid.bat`文件中的行为具有恶意性，特别是`volleyballsquid.py`中尝试使用`BypassUAC`绕过用户账户控制并持久化安装，这可能被用于安装后门或恶意软件。虽然主要目的是展示漏洞，但客观上存在后门功能，因此投毒风险占比为10%。

**利用方式:** 攻击者首先利用 `exploit.py` 脚本生成包含恶意代码的RAR压缩文件。然后，诱骗用户下载并使用 WinRAR 解压此文件。当用户尝试打开压缩包中的“良性”文件时，实际上会执行隐藏在同名目录中的恶意脚本 (例如 `squid.bat`)，下载并执行恶意程序。

根据搜索结果，CVE-2023-38831 漏洞已被广泛利用，并且已被政府背景的攻击者使用，这进一步验证了漏洞的严重性和 POC 代码的有效性。

**项目地址:** [solomon12354/VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC](https://github.com/solomon12354/VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #26

**来源**: [CVE-2023-38831-technicalcorp0_CVE-2023-38831-Exploit.md](../2023/CVE-2023-38831-technicalcorp0_CVE-2023-38831-Exploit.md)

## CVE-2023-38831-WinRAR-任意代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 任意代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个漏洞，该漏洞允许攻击者通过特制的ZIP档案执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** 当WinRAR尝试访问ZIP归档中的良性文件时，如果存在与该良性文件同名的文件夹，WinRAR会处理该文件夹的内容（可能包含可执行内容）。
2.  **利用方式：**
    *   攻击者创建一个恶意的ZIP档案，该档案包含一个良性文件（例如.JPG文件）和一个与该良性文件同名的文件夹。
    *   该文件夹包含恶意可执行文件。
    *   当受害者尝试在WinRAR中查看良性文件时，WinRAR会执行该文件夹中的恶意代码。
3.  **POC有效性：** 提供的POC代码 (CVE-2023-38831-WinRar-Exploit.py) 的目的是生成包含利用此漏洞的恶意 ZIP 文件。根据代码逻辑和漏洞原理，该 POC 可以有效利用该漏洞。
4.  **投毒风险：** 经过对POC代码的分析，发现代码本身实现了漏洞利用过程，但同时也存在一定的投毒风险。`clean_up()`函数会删除临时文件，但不能保证完全清除所有痕迹。攻击者可能通过修改代码，在生成恶意 ZIP 文件后，在目标系统上留下后门或执行其他恶意操作。考虑到实际利用场景中可能存在的恶意修改，投毒风险估计为5%。 主要风险点在于，虽然POC主要目的是生成exploit，但如果恶意人员修改，完全可以添加其他恶意payload，并伪装成CVE-2023-38831的POC进行传播。
5. **搜索引擎结果:** 搜索引擎结果表明此漏洞已被广泛利用，包括政府背景的黑客组织。 多个安全厂商发布了相关的分析和防御措施。

**项目地址:** [technicalcorp0/CVE-2023-38831-Exploit](https://github.com/technicalcorp0/CVE-2023-38831-Exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #27

**来源**: [CVE-2023-38831-xk-mt_WinRAR-Vulnerability-recurrence-tutorial.md](../2023/CVE-2023-38831-xk-mt_WinRAR-Vulnerability-recurrence-tutorial.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。该漏洞允许攻击者通过构造恶意的ZIP压缩包，在用户尝试查看压缩包内的文件时执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，该漏洞已被广泛利用，POC代码的存在也表明其有效性。多个安全厂商和研究人员都对此漏洞进行了分析并提供了相应的缓解措施。

**投毒风险分析：**
提供的POC代码包含以下文件：
*   `README.md`: 漏洞复现教程，包含漏洞信息和参考链接。
*   `执行命令.bat`: 一个简单的批处理文件，用于执行`calc.exe`（计算器程序），用于演示代码执行。
*   `文本.txt`: 包含一个URL地址。
*   `生成压缩包.py`: 一个Python脚本，用于生成包含漏洞的ZIP压缩包。

该脚本的主要功能是：
1.  创建临时目录，并将`执行命令.bat`复制到该目录。
2.  复制`文本.txt`文件到另一个目录。
3.  将上述两个目录打包成ZIP文件。
4.  修改ZIP文件中的文件名，利用漏洞的原理。
从代码本身来看，该脚本并没有明显的恶意代码，但是存在一定的投毒风险。
*   执行命令.bat： 虽然只是简单的calc.exe，但如果攻击者替换成其他恶意命令，则可能造成更大的危害。
*   脚本的依赖： 该脚本依赖Python环境，攻击者可能会通过修改脚本，引入恶意的Python依赖包，从而实现投毒。

综合来看，该仓库中存在一定的投毒风险，但不高。主要是因为演示的`执行命令.bat`内容比较简单，容易被识别。如果使用者直接运行此仓库的代码，有可能会被植入恶意程序。因此，投毒风险评定为10%。

**利用方式：**
1.  攻击者构造一个恶意的ZIP压缩包，该压缩包包含一个良性文件（例如，图片文件`文本.txt`）和一个与该文件同名的文件夹。
2.  该文件夹包含一个恶意可执行文件（例如，`执行命令.bat`并更名为`文本.txtA.cmd`）。
3.  当用户使用受影响的WinRAR版本打开该ZIP压缩包，并尝试查看良性文件时，WinRAR会错误地执行该文件夹中的恶意可执行文件，从而导致任意代码执行。

**项目地址:** [xk-mt/WinRAR-Vulnerability-recurrence-tutorial](https://github.com/xk-mt/WinRAR-Vulnerability-recurrence-tutorial)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #28

**来源**: [CVE-2023-38831-yezzfusl_cve_2023_38831_scanner.md](../2023/CVE-2023-38831-yezzfusl_cve_2023_38831_scanner.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开恶意的 ZIP 压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以通过构造一个特殊的 ZIP 压缩文件来利用此漏洞。该 ZIP 文件包含一个良性文件（例如 JPG）和一个同名的文件夹。当用户尝试访问良性文件时，WinRAR 会错误地执行文件夹中的恶意代码，导致远程代码执行。

**利用方式：**
1.  攻击者创建一个包含良性文件和同名文件夹的恶意 ZIP 文件。
2.  文件夹中包含要执行的恶意代码（例如，可执行文件）。
3.  攻击者诱使用户使用 WinRAR 打开该 ZIP 文件。
4.  当用户尝试访问良性文件时，WinRAR 会执行文件夹中的恶意代码。

**有效性：**
根据漏洞描述和搜索结果，该漏洞已在野外被利用，因此提供的PoC代码如果能够重现该行为，则可以认为是有效的。

**投毒风险：**
提供的代码仓库 `cve_2023_38831_scanner` 本身是一个漏洞扫描器，而非漏洞利用的PoC。尽管如此，仍然存在一定的投毒风险。代码中可能隐藏后门，虽然其主要功能是扫描，但理论上存在被篡改的风险。代码中使用了网络数据包分析、进程内存扫描、沙箱环境执行等模块，这些模块如果被恶意修改，可能被用于执行恶意操作。因此，综合考虑其扫描器的性质和潜在风险，投毒风险估计为10%。这个风险主要来自供应链投毒，如果下载了被篡改过的扫描器，那么扫描器本身可能成为攻击的一部分。

**项目地址:** [yezzfusl/cve_2023_38831_scanner](https://github.com/yezzfusl/cve_2023_38831_scanner)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #29

**来源**: [CVE-2023-38831-youmulijiang_evil-winrar.md](../2023/CVE-2023-38831-youmulijiang_evil-winrar.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 50%

## 详情

CVE-2023-38831是WinRAR在6.23版本之前存在的一个远程代码执行漏洞。该漏洞的利用方式是构造一个特殊的ZIP压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹。当用户尝试在WinRAR中查看该良性文件时，WinRAR会错误地执行该文件夹中的恶意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认该漏洞是有效的，并且已经在野外被利用。漏洞利用代码提供了一个框架，用于生成包含恶意payload的ZIP压缩包，从而实现远程代码执行。

**投毒风险分析：**
提供的代码是一个框架，用于生成漏洞利用的 ZIP 文件，包含生成 exp，邮件发送，下载链接生成等功能。代码中存在潜在的投毒风险，主要体现在以下几个方面：

1.  **Payload 植入:**  该框架可以自定义payload，如果用户在不了解 payload 内容的情况下使用，可能运行恶意指令。
2.  **代码可信度:** 虽然作者声明为安全开发成员，并开源了代码，但代码的安全性仍然需要进一步审计。存在作者预留后门的可能性。 考虑到这是一个漏洞利用框架，其本质就是为了执行恶意代码，所以判定为投毒代码的风险为50%。

**漏洞利用方式：**

1.  攻击者使用该漏洞利用框架(evil-winrar)生成一个恶意的 ZIP 压缩包。
2.  该 ZIP 压缩包包含一个良性文件（如JPG图片）和一个同名的文件夹，文件夹中包含恶意可执行文件。
3.  攻击者通过社会工程学等方式诱骗用户使用存在漏洞的 WinRAR 版本打开该 ZIP 压缩包。
4.  用户尝试查看良性文件时，WinRAR 会错误地执行同名文件夹中的恶意代码。
5.  恶意代码在用户系统上执行，攻击者从而实现远程代码执行，控制受害者的计算机。

**项目地址:** [youmulijiang/evil-winrar](https://github.com/youmulijiang/evil-winrar)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---



---

## POC #3

**来源**: [CVE-2023-38831-MaorBuskila_Windows-X64-RAT.md](../2023/CVE-2023-38831-MaorBuskila_Windows-X64-RAT.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者在用户尝试查看 ZIP 压缩包中的良性文件时执行任意代码。该漏洞源于 WinRAR 处理 ZIP 压缩包时，允许压缩包包含一个良性文件（例如 .JPG）和一个同名文件夹。当用户尝试访问该良性文件时，WinRAR 实际上会处理同名文件夹中的内容，从而允许攻击者在文件夹中放置恶意可执行文件并执行。

**有效性：**
从搜索结果和漏洞库信息来看，该漏洞已经被广泛利用，PoC 代码的存在也进一步验证了其有效性。

**投毒风险：**
提供的 Python 脚本 (`51721.py`) 用于生成 Windows x64 平台的反向 TCP Shellcode。该脚本本身不包含明显的恶意代码，功能是生成 shellcode。需要用户自行配置 IP 地址和端口。但是，由于该代码需要用户执行，并且可以生成任意 shellcode，存在一定投毒风险，例如，如果攻击者提供修改后的脚本，生成包含恶意功能的 shellcode (如删除文件，上传用户信息)，则用户可能无意中执行该恶意 shellcode. 脚本本身不包含网络连接或者其他与远程服务器通信的行为，可以基本判断代码仓库投毒风险较低.

**利用方式：**
1.  攻击者创建一个恶意的 ZIP 压缩包。
2.  该 ZIP 压缩包包含一个良性文件（例如 image.jpg）和一个同名文件夹（image.jpg）。
3.  同名文件夹包含恶意可执行文件，例如 exploit.exe，并可能包含一个 `.lnk` 文件，该快捷方式指向该恶意可执行文件。
4.  攻击者诱骗用户使用受影响版本的 WinRAR 打开该 ZIP 压缩包并尝试查看良性文件。
5.  WinRAR 错误地执行同名文件夹中的恶意可执行文件，从而导致远程代码执行。

**项目地址:** [MaorBuskila/Windows-X64-RAT](https://github.com/MaorBuskila/Windows-X64-RAT)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #4

**来源**: [CVE-2023-38831-MyStuffYT_CVE-2023-38831-POC.md](../2023/CVE-2023-38831-MyStuffYT_CVE-2023-38831-POC.md)

## CVE-2023-38831-WinRAR-远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的恶意ZIP压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个恶意的ZIP压缩文件，其中包含一个良性文件（例如.jpg）和一个同名的文件夹。当用户尝试在 WinRAR 中查看该良性文件时，WinRAR 会错误地执行该文件夹中的内容，从而导致任意代码执行。

**有效性：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。搜索引擎结果表明该漏洞已被广泛利用，POC代码的存在进一步证实了其有效性。

**投毒风险：**

根据对POC代码的分析，存在一定的投毒风险。`script.bat`脚本从github下载`Alert.exe`文件，这本身就存在一定的安全隐患，无法确保下载的文件一定是安全的。此外，脚本同时执行 `alert.exe` 和 `gtaleak.mp4`，而 `gtaleak.mp4` 在 README 中说明是 “zeros without ones”, 可以确定这是一个障眼法，实际的恶意行为是由 `alert.exe` 执行。 因此，作者可能隐藏了投毒代码。

**利用方式：**

1.  攻击者创建一个恶意的ZIP压缩文件，其中包含一个良性文件 (例如 `gtaleak.mp4`) 和一个同名的文件夹。
2.  该文件夹包含一个批处理脚本 (`script.bat`)，该脚本将从远程服务器下载并执行恶意程序 (`Alert.exe`)。
3.  当用户尝试使用 WinRAR 打开压缩文件并查看良性文件 (`gtaleak.mp4`) 时，WinRAR 会错误地执行批处理脚本。
4.  批处理脚本下载并执行恶意程序，从而允许攻击者在受害者的系统上执行任意代码。

**项目地址:** [MyStuffYT/CVE-2023-38831-POC](https://github.com/MyStuffYT/CVE-2023-38831-POC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #5

**来源**: [CVE-2023-38831-Nielk74_CVE-2023-38831.md](../2023/CVE-2023-38831-Nielk74_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本的代码执行漏洞。该漏洞允许攻击者在用户尝试查看ZIP存档中的看似无害的文件时执行任意代码。攻击者通过构造一个包含同名文件和文件夹的恶意ZIP文件，利用WinRAR处理文件路径时的逻辑缺陷，使得文件夹中的恶意可执行文件得以运行。提供的POC代码通过Vagrant自动化部署了一个易受攻击的WinRAR 6.22环境，并向虚拟机桌面添加了一个恶意的rar文件。该rar文件被设计为当用户点击其中的“无害”文件时，执行预先设定的恶意代码。尽管POC的主要目的是演示漏洞，但其中`ChocolateyInstall.ps1`脚本从外部源下载并安装软件包（Chocolatey和WinRAR），存在被篡改从而引入恶意代码的风险，这构成了潜在的投毒风险。虽然这个脚本很常见，但还是存在一定的风险，因此这里给出了10%的投毒风险。

**漏洞利用方式：**

1.  攻击者创建一个恶意的ZIP压缩包，其中包含一个看似无害的文件（例如.jpg），以及一个与该文件同名的文件夹。
2.  该文件夹包含恶意可执行文件，例如.exe或.cmd脚本。
3.  当用户尝试使用WinRAR打开ZIP压缩包并查看“无害”文件时，WinRAR会错误地执行同名文件夹中的恶意可执行文件，从而导致任意代码执行。
4.  攻击者可以利用此漏洞在受害者系统上安装恶意软件、窃取敏感数据或执行其他恶意操作。

**项目地址:** [Nielk74/CVE-2023-38831](https://github.com/Nielk74/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #6

**来源**: [CVE-2023-38831-RomainBayle08_CVE-2023-38831.md](../2023/CVE-2023-38831-RomainBayle08_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP或RAR压缩文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个特殊的 ZIP 压缩文件，该文件包含一个看似无害的文件（例如，.JPG 文件）和一个与该文件同名的文件夹。当用户尝试查看压缩文件中的无害文件时，WinRAR 会错误地执行文件夹中的内容，从而导致任意代码执行。

**有效性分析：**
提供的 POC 代码 `cve-2023-38831-exp-gen.py` 是一个漏洞利用生成器脚本，它接受诱饵文件 (`BAIT_NAME`)、脚本文件 (`SCRIPT_NAME`) 和额外的诱饵文件目录 (`BAIT_FILES`) 作为输入，并生成一个恶意 RAR 压缩文件 (`OUTPUT_NAME`)。脚本首先创建一个包含诱饵文件和脚本文件的临时目录结构，然后使用 `shutil.make_archive` 函数将该目录压缩为 ZIP 文件。关键在于，脚本会替换 ZIP 文件中特定文件的扩展名，利用 WinRAR 的漏洞，在用户尝试打开诱饵文件时执行脚本文件。`script.bat` 脚本会首先尝试打开诱饵文件（模拟用户行为），然后执行 `calc.exe`（作为漏洞利用成功的标志）。该 POC 的有效性较高，因为它模拟了真实的攻击场景。

**投毒风险分析：**
`cve-2023-38831-exp-gen.py` 脚本本身不包含明显的恶意代码或后门。但是，存在一定的投毒风险，因为该脚本允许攻击者指定要执行的任意脚本 (`SCRIPT_NAME`)。攻击者可以替换 `script.bat` 文件为包含恶意代码的文件，例如下载和执行其他恶意软件。此外，该脚本使用了`BAIT_FILES`参数，如果提供包含恶意文件的目录，也会构成投毒风险。所以存在一定投毒风险，但主要取决于用户提供的脚本和目录的内容。

**利用方式分析：**
1.  攻击者构造一个恶意 ZIP 压缩文件，其中包含一个诱饵文件（如 `CLASSIFIED_DOCUMENTS.pdf`）和一个与诱饵文件同名的文件夹。文件夹中包含一个脚本文件（如 `script.bat`）。
2.  攻击者将恶意 ZIP 文件发送给受害者，诱骗其使用 WinRAR 打开。
3.  当受害者尝试查看 ZIP 文件中的诱饵文件时，WinRAR 会错误地执行同名文件夹中的脚本文件。
4.  脚本文件执行任意代码，例如安装恶意软件或窃取敏感信息。

总的来说，该漏洞利用方式简单有效，风险较高。用户应尽快升级到 WinRAR 6.23 或更高版本。

**项目地址:** [RomainBayle08/CVE-2023-38831](https://github.com/RomainBayle08/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #7

**来源**: [CVE-2023-38831-RonF98_CVE-2023-38831-POC.md](../2023/CVE-2023-38831-RonF98_CVE-2023-38831-POC.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致任意代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831 是 WinRAR 在处理 ZIP 压缩文件时存在的一个漏洞。攻击者可以构造一个包含良性文件（例如 .jpg 文件）和一个同名文件夹的 ZIP 压缩包。该文件夹中包含恶意代码（例如 .cmd 文件）。当用户尝试查看良性文件时，WinRAR 会错误地执行文件夹中的恶意代码，从而导致远程代码执行。

**有效性：**

提供的 POC 代码有效，它演示了如何创建一个恶意的 RAR 文件来利用此漏洞。

*   `DoS.cmd` 文件包含恶意代码，用于创建多个消息框，模拟拒绝服务攻击。
*   `exploit.py` 脚本用于生成包含恶意 `DoS.cmd` 文件的 RAR 文件，并利用漏洞触发代码执行。
*   `README.md` 详细解释了漏洞原理和利用方法，并提供了攻击成功的截图。

**投毒风险：**

此仓库中可能存在轻微的投毒风险，约为5%。

*   `DoS.cmd` 只是一个简单的拒绝服务攻击示例，但攻击者可能会将其替换为更具破坏性的恶意代码，例如勒索软件或信息窃取程序。如果下载者不仔细检查 `DoS.cmd` 的内容，可能会在不知情的情况下运行恶意代码。
*   `exploit.py` 脚本本身没有明显的恶意代码，但它可以被修改以生成包含不同恶意代码的 RAR 文件。下载者应该仔细审查脚本的内容，确保它不会被用于传播恶意软件。

**利用方式：**

1.  攻击者创建一个包含良性文件（例如 `image.jpg`）和一个同名文件夹（例如 `image.jpg `）的 ZIP 压缩包。注意文件夹名称后面有一个空格。
2.  在同名文件夹中，攻击者放置恶意代码（例如 `image.jpg .cmd`）。
3.  攻击者将 ZIP 文件转换为 RAR 文件（POC 脚本完成了此过程）。
4.  攻击者诱骗用户使用受影响的 WinRAR 版本打开 RAR 文件并尝试查看良性文件（`image.jpg`）。
5.  WinRAR 错误地执行同名文件夹中的恶意代码 (`image.jpg .cmd`)，从而导致远程代码执行。

由于该漏洞被广泛利用，并且网上存在大量相关的 POC 代码，因此攻击者很容易发起攻击。


**项目地址:** [RonF98/CVE-2023-38831-POC](https://github.com/RonF98/CVE-2023-38831-POC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #8

**来源**: [CVE-2023-38831-SpamixOfficial_CVE-2023-38831.md](../2023/CVE-2023-38831-SpamixOfficial_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前的版本中的代码执行漏洞。攻击者可以制作一个特制的ZIP压缩包，其中包含一个良性文件和一个同名文件夹，文件夹中包含恶意可执行文件。当用户尝试在WinRAR中查看良性文件时，实际上会执行文件夹中的恶意代码。\n\n**有效性：**根据漏洞库信息、搜索结果和漏洞利用代码，该漏洞POC是有效的。漏洞库信息中明确指出该漏洞已在野外被利用。搜索结果中多个链接都指向了关于该漏洞的分析和利用报告。提供的`Cargo.lock`文件很可能只是rust项目依赖管理文件，无法直接证明POC的有效性，需配合rust源码进行分析。\n\n**投毒风险：**分析提供的`Cargo.lock`文件，该文件列出了Rust项目`CVE-2023-38831`的依赖项。虽然`Cargo.lock`本身不包含可执行代码，但是，如果恶意作者修改了依赖项的版本或来源，理论上存在引入被篡改过的crate（Rust包）的风险。不过，由于`Cargo.lock`文件明确指定了每个依赖项的checksum，Cargo在构建项目时会验证下载的crate是否与checksum匹配，从而降低了被投毒的风险。评估投毒风险为10%。\n\n**利用方式：**攻击者创建一个包含以下结构的ZIP压缩包：\n\n1.  一个良性的文件，例如 `image.jpg`\n2.  一个与良性文件同名的文件夹，例如 `image.jpg`\n3.  在同名文件夹中，放置恶意可执行文件，例如 `image.jpg.exe` 或 `image.jpg `(通过空格进行欺骗)。\n\n当用户使用存在漏洞的WinRAR版本打开该ZIP文件并尝试查看`image.jpg`时，WinRAR会错误地执行`image.jpg`文件夹中的恶意程序，从而实现远程代码执行。

**项目地址:** [SpamixOfficial/CVE-2023-38831](https://github.com/SpamixOfficial/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #9

**来源**: [CVE-2023-38831-Tolu12wani_Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution.md](../2023/CVE-2023-38831-Tolu12wani_Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在用户尝试查看 ZIP 压缩包中的文件时执行任意代码。

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开特制的 ZIP 压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者通过构造恶意的 ZIP 压缩包实现远程代码执行。该压缩包包含一个良性文件（例如 JPG）和一个与良性文件同名的文件夹。当用户尝试访问良性文件时，WinRAR 会错误地执行同名文件夹中的内容，从而执行攻击者放置的恶意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被广泛利用。 提供的POC代码描述的是在压缩文件中嵌入恶意payload，并触发反向shell的实验环境验证过程。虽然该代码本身没有包含恶意代码，但描述了如何构建利用该漏洞的压缩文件。

**投毒风险：**
提供的 POC 代码仓库中只包含 PDF 报告和截图，并没有可执行的恶意代码。 但是,README中说明了该仓库展示了恶意payload的嵌入方式，存在一定的潜在风险。 因此，存在一定的投毒风险，但风险较低。根据readme描述和文件结构，投毒风险评估为10%，

**利用方式：**
1.  **创建恶意 ZIP 压缩包：** 攻击者创建一个 ZIP 压缩包，其中包含一个良性文件（例如 JPG）和一个与良性文件同名的文件夹。
2.  **放置恶意代码：** 将恶意可执行文件放置在与良性文件同名的文件夹中。
3.  **诱骗用户：** 诱骗用户使用受影响的 WinRAR 版本打开该 ZIP 压缩包并尝试查看良性文件。
4.  **执行恶意代码：** WinRAR 错误地执行同名文件夹中的恶意代码，从而实现远程代码执行。

根据搜索结果，该漏洞已经被政府支持的攻击者利用，用于投放 RAT（远程访问木马）等恶意软件。

**项目地址:** [Tolu12wani/Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution](https://github.com/Tolu12wani/Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #10

**来源**: [CVE-2023-38831-VictoriousKnight_CVE-2023-38831_Exploit.md](../2023/CVE-2023-38831-VictoriousKnight_CVE-2023-38831_Exploit.md)

## CVE-2023-38831-WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码。

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的恶意ZIP文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个漏洞，它允许攻击者通过构造特殊的ZIP文件来执行任意代码。攻击者创建一个ZIP文件，其中包含一个良性文件（例如，JPG图片）和一个与该良性文件同名的文件夹。该文件夹中包含恶意可执行文件。当用户尝试在WinRAR中查看该良性文件时，WinRAR会错误地执行该文件夹中的恶意代码，从而导致远程代码执行。

**有效性：** 提供的POC代码是有效的。根据漏洞库信息和搜索结果，该漏洞在野外被广泛利用。POC代码通过创建包含良性文件和同名文件夹的恶意ZIP文件，并利用WinRAR处理文件时的缺陷来执行代码。POC代码结构清晰，易于理解和使用。

**投毒风险：** 提供的POC代码本身主要是利用漏洞生成EXP，但仔细检查代码，在`exploit.py`文件的zip文件内容操作部分被截断，没有展示修改zip文件内容的关键代码，作者可能在`Read and manipulate the zip file content`部分添加恶意代码，执行修改zip文件过程中的任何恶意行为。因此存在一定的投毒风险，根据代码完整度，我给出10%的投毒风险。

**利用方式：**
1.  攻击者创建一个恶意ZIP文件，其中包含一个看似无害的文件（例如，一个图片或PDF）。
2.  在ZIP文件中，攻击者同时创建一个与该无害文件同名的文件夹。
3.  该文件夹包含攻击者想要执行的恶意代码，通常是一个可执行文件或脚本。
4.  攻击者诱使用户使用存在漏洞的WinRAR版本打开该ZIP文件。
5.  当用户尝试访问ZIP文件中的“无害”文件时，WinRAR会错误地执行同名文件夹中的恶意代码。

**项目地址:** [VictoriousKnight/CVE-2023-38831_Exploit](https://github.com/VictoriousKnight/CVE-2023-38831_Exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #11

**来源**: [CVE-2023-38831-anelya0333_Exploiting-CVE-2023-38831.md](../2023/CVE-2023-38831-anelya0333_Exploiting-CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开特制的ZIP压缩文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞允许攻击者通过特制的ZIP压缩文件在目标系统上执行任意代码。该漏洞的根源在于WinRAR在处理包含与文件同名文件夹的ZIP文件时存在缺陷。攻击者可以构造一个 ZIP 文件，其中包含一个良性文件（例如.JPG）和一个与其同名的文件夹。当用户尝试在 WinRAR 中查看该良性文件时，WinRAR 会错误地执行该文件夹中的恶意代码。此PoC脚本生成一个ZIP文件，其中包含诱饵文件(bait file)和恶意脚本(script file)，并修改ZIP文件的文件头，以利用此漏洞。脚本创建与诱饵文件同名的文件夹，并将恶意脚本放入其中。然后，将诱饵文件的副本也放入ZIP文件中。通过替换文件名字段中的某些字符，WinRAR会将文件夹中的恶意文件误认为是要执行的文件，最终导致代码执行。由于代码仅仅是构造payload，不存在主动执行恶意代码，因此不存在投毒风险。

**项目地址:** [anelya0333/Exploiting-CVE-2023-38831](https://github.com/anelya0333/Exploiting-CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #12

**来源**: [CVE-2023-38831-b1tg_CVE-2023-38831-winrar-exploit.md](../2023/CVE-2023-38831-b1tg_CVE-2023-38831-winrar-exploit.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可导致完全系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开恶意构造的ZIP文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 允许攻击者通过特制的ZIP文件在受害者系统上执行任意代码。该漏洞源于 WinRAR 处理包含同名文件和文件夹的 ZIP 档案时的不当行为。攻击者可以创建一个 ZIP 文件，其中包含一个良性文件（例如 CLASSIFIED_DOCUMENTS.pdf）和一个同名文件夹（例如 CLASSIFIED_DOCUMENTS.pdf）。当用户尝试访问良性文件时，WinRAR 实际上会执行该文件夹中的内容（例如 script.bat）。

**有效性:**

提供的 POC 代码 `cve-2023-38831-exp-gen.py` 旨在生成利用此漏洞的恶意 RAR 档案。该脚本通过以下步骤工作：

1.  创建临时目录 `TEMPLATE`。
2.  在 `TEMPLATE` 中创建一个与bait文件同名的文件夹，并在其中存放包含恶意命令的script文件（例如 `script.bat`， 其中包含`calc.exe & CLASSIFIED_DOCUMENTS.pdf`）。
3.  将bait文件存放在`TEMPLATE`目录。
4.  将`TEMPLATE`目录压缩为zip文件。
5.  修改压缩包中文件和文件夹的名字，构造漏洞。
6.  最终输出 `CVE-2023-38831-poc.rar`。

该脚本能够有效地生成利用 CVE-2023-38831 的 RAR 文件，因此提供的 POC 代码是有效的。

**投毒风险:**

对提供的 POC 代码 (`cve-2023-38831-exp-gen.py` 和 `script.bat`) 进行分析后，未发现明显的恶意代码或后门。该脚本的功能明确且集中于生成利用 CVE-2023-38831 的 RAR 档案。 `script.bat` 的主要功能是启动计算器程序 (`calc.exe`) 并尝试打开诱饵文档 (`CLASSIFIED_DOCUMENTS.pdf`)，这是一个典型的 PoC 行为。 因此，该仓库中存在作者隐藏的投毒代码的风险极低。

**利用方式:**

1.  攻击者使用 `cve-2023-38831-exp-gen.py` 脚本，指定诱饵文件（例如 `CLASSIFIED_DOCUMENTS.pdf`）和恶意脚本（例如 `script.bat`），生成恶意 RAR 档案。
2.  攻击者通过各种方式（例如，电子邮件、恶意网站）将恶意 RAR 档案分发给受害者。
3.  受害者使用易受攻击的 WinRAR 版本（< 6.23）打开恶意 RAR 档案。
4.  当受害者尝试访问诱饵文件时，WinRAR 错误地执行了同名文件夹中的恶意脚本。
5.  恶意脚本在受害者系统上执行任意代码，例如启动计算器或安装恶意软件。

**项目地址:** [b1tg/CVE-2023-38831-winrar-exploit](https://github.com/b1tg/CVE-2023-38831-winrar-exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #13

**来源**: [CVE-2023-38831-elefantesagradodeluzinfinita_cve-2023-38831.md](../2023/CVE-2023-38831-elefantesagradodeluzinfinita_cve-2023-38831.md)

## CVE-2023-38831 - WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用 WinRAR 打开特制的 ZIP 压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者通过特制的 ZIP 压缩包在受害者系统上执行任意代码。漏洞利用方式是创建一个 ZIP 压缩包，其中包含一个良性文件（例如 .jpg 或 .pdf）以及一个同名的文件夹。该文件夹包含恶意的可执行文件（例如 .cmd 或 .exe）。当用户尝试打开良性文件时，WinRAR 会错误地执行文件夹中的恶意代码。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码分析，该漏洞确实存在并且已经被野外利用。提供的代码描述了一个利用工具 "DR. GANDALF"，它允许用户创建包含此漏洞的 ZIP 文件，表明POC的有效性。

**投毒风险：** 提供的 README.md 文件主要描述了漏洞原理和利用工具的使用方法。但是，由于此工具允许用户自定义注入的代码和二进制文件，因此存在投毒风险。如果用户下载了包含恶意注入代码的ZIP文件，那么这个工具本身可能被利用来传播恶意软件。评估投毒风险为 10%，因为该描述文件本身不包含可以直接执行的后门代码，但生成的ZIP文件可以包含。

**利用方式：**
1.  攻击者创建一个包含恶意 ZIP 压缩包。
2.  ZIP 压缩包中包含一个良性文件（例如，`image.jpg`）和一个同名的文件夹（例如，`image.jpg`）。
3.  `image.jpg` 文件夹包含恶意的可执行文件（例如，`evil.cmd`）。
4.  攻击者诱骗受害者使用存在漏洞的 WinRAR 版本打开该 ZIP 压缩包并尝试访问良性文件 `image.jpg`。
5.  WinRAR 在处理该 ZIP 文件时，会错误地执行 `image.jpg` 文件夹中的恶意代码 `evil.cmd`，从而导致远程代码执行。

**项目地址:** [elefantesagradodeluzinfinita/cve-2023-38831](https://github.com/elefantesagradodeluzinfinita/cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #14

**来源**: [CVE-2023-38831-h3xecute_SideCopy-Exploits-CVE-2023-38831.md](../2023/CVE-2023-38831-h3xecute_SideCopy-Exploits-CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个远程代码执行漏洞。该漏洞的利用方式是构造一个特殊的ZIP压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹。当用户尝试使用WinRAR打开该ZIP压缩包并访问良性文件时，WinRAR会错误地执行文件夹中的恶意代码。

**有效性：**
提供的POC代码描述了漏洞利用的原理，即构造包含同名良性文件和文件夹的ZIP压缩包。根据漏洞信息和搜索结果，此方法是有效的，并且在野外被利用。

**投毒风险：**
该POC本身描述了漏洞的利用方式，包含一个指向YouTube视频的链接，以及对恶意压缩包结构的描述。投毒风险较低，约为10%，因为：
1.  POC主要以描述性文字和图片链接为主。
2.  缺乏直接可执行的payload代码。
3.  作者可能通过YouTube链接传播恶意信息。

**利用方式：**
1.  攻击者创建一个恶意的ZIP压缩包。
2.  该压缩包包含一个良性文件（例如JPG，PDF等）和一个与该文件同名的文件夹。
3.  恶意代码（例如，可执行文件）放置在同名文件夹中。
4.  攻击者诱骗用户使用WinRAR打开这个ZIP压缩包，并尝试访问良性文件。
5.  WinRAR在处理压缩包时，会错误地执行同名文件夹中的恶意代码，从而导致远程代码执行。

**项目地址:** [h3xecute/SideCopy-Exploits-CVE-2023-38831](https://github.com/h3xecute/SideCopy-Exploits-CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #15

**来源**: [CVE-2023-38831-idkwastaken_CVE-2023-38831.md](../2023/CVE-2023-38831-idkwastaken_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意的ZIP文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的漏洞。该漏洞的利用方式是创建一个特制的ZIP文件，其中包含一个良性文件和一个同名文件夹。当用户尝试使用WinRAR打开ZIP文件并访问该良性文件时，WinRAR会错误地执行该同名文件夹中的恶意代码，导致远程代码执行。

**有效性：**
提供的POC代码（exploit.c）利用了该漏洞。该代码生成一个ZIP文件，其中包含一个PDF文件（document.pdf）和一个名为“document.pdf\”的文件夹，该文件夹内包含一个恶意的批处理脚本（script.bat）。当用户在易受攻击的WinRAR版本中打开并尝试访问该PDF文件时，WinRAR将执行该批处理脚本。
checker.bat 是用来检测目标系统是否安装WinRAR，以及WinRAR的版本是否是受影响的版本。
exploit.ps1 看起来不完整，但是其作用应该是检查WinRAR版本。

**投毒风险：**
代码中存在一定的投毒风险，约为10%。原因如下：
*   **脚本内容可控：** exploit.c 中的script_content变量包含了要执行的命令，虽然当前POC仅仅是弹窗，但是攻击者可以修改这个变量，执行任意命令，例如下载恶意软件，执行系统命令等。
*   **复杂的构建过程：** exploit.c 代码本身比较复杂，阅读和分析需要一定的时间和精力。攻击者可以利用这一点，在代码中隐藏不易察觉的恶意代码。
虽然有潜在的投毒风险，但当前代码的主要目的是演示漏洞利用，风险较低，作者没有明显的隐藏后门行为，恶意代码比较容易被发现。

**利用方式：**
1.  攻击者创建一个恶意的ZIP压缩包，其中包含：
    *   一个良性的文件（例如 document.pdf）。
    *   一个与良性文件同名的文件夹（例如 document.pdf/）。
    *   恶意代码位于同名文件夹中（例如 document.pdf/script.bat）。
2.  攻击者诱骗目标用户使用存在漏洞的 WinRAR 版本打开此 ZIP 压缩包。
3.  当用户尝试打开良性文件时，WinRAR 错误地执行同名文件夹中的恶意代码，从而导致任意代码执行。


**项目地址:** [idkwastaken/CVE-2023-38831](https://github.com/idkwastaken/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #16

**来源**: [CVE-2023-38831-imbyter_imbyter-WinRAR_CVE-2023-38831.md](../2023/CVE-2023-38831-imbyter_imbyter-WinRAR_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 6.23

**利用条件:** 用户使用受影响的WinRAR版本打开特制的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于WinRAR 6.23之前的版本中。攻击者可以构造一个恶意的ZIP压缩包，其中包含一个伪装成良性文件的文件（例如 .jpg），以及一个同名的文件夹。当用户尝试在 WinRAR 中查看该“良性文件”时，实际上会执行同名文件夹中的恶意代码（例如 .cmd 或 .exe 文件）。

**有效性：**
根据漏洞信息和搜索结果，提供的POC代码是有效的。该POC利用了WinRAR处理ZIP压缩包时存在的逻辑漏洞，能够实现远程代码执行。

**投毒风险：**
提供的Python脚本 `make-poc.py` 用于生成POC压缩包，其本身的代码逻辑相对简单，主要功能是将指定的文件和脚本打包成特定的ZIP格式，并进行一些字符串替换以触发漏洞。主要风险在于脚本生成的POC包中包含的脚本，如果这个脚本是恶意的，那么整个利用过程就存在投毒风险。 仓库中的README.md文件里的测试脚本就是一个关闭计算机的脚本。代码本身存在一定的投毒风险.

*   脚本逻辑：脚本的功能是创建包含漏洞利用结构的RAR文件。
*   恶意操作：如果脚本被修改以包含下载和执行恶意软件的逻辑，那么用户在使用此脚本创建RAR文件时，就会受到投毒攻击。

**利用方式：**
1.  攻击者使用 `make-poc.py` 脚本构造恶意的ZIP压缩包，需要提供一个“良性”文件和一个恶意脚本。
2.  攻击者将恶意的ZIP压缩包发送给受害者。
3.  受害者使用受影响的WinRAR版本打开该ZIP压缩包，并尝试查看伪装的“良性”文件。
4.  WinRAR错误地执行了与“良性”文件同名的文件夹中的恶意脚本，导致远程代码执行。

**防御措施：**
*   升级WinRAR到6.23或更高版本。
*   谨慎打开来源不明的ZIP压缩包。
*   使用杀毒软件扫描ZIP压缩包。

**项目地址:** [imbyter/imbyter-WinRAR_CVE-2023-38831](https://github.com/imbyter/imbyter-WinRAR_CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #17

**来源**: [CVE-2023-38831-kehrijksen_CVE-2023-38831.md](../2023/CVE-2023-38831-kehrijksen_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 需要用户解压特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个恶意的 ZIP 压缩包，其中包含一个伪装成普通文件的文件和一个同名的文件夹。当用户尝试在 WinRAR 中查看该“普通文件”时，WinRAR 会错误地执行同名文件夹中的内容，从而导致任意代码执行。

**有效性：**
提供的 PoC 代码 `poc.py` 能够生成利用此漏洞的恶意 ZIP 压缩包。该脚本首先创建一个包含恶意 payload (例如 script.bat) 和良性文件 (例如 pepe.jpg) 的目录结构。然后，它将此目录结构压缩成 ZIP 文件，并修改 ZIP 文件中的文件名，以触发漏洞。`script.bat` 的作用是在 `%TEMP%` 目录下提取 ZIP 文件内容，运行良性文件作为诱饵，然后执行恶意操作，例如创建一个包含 “hacked” 内容的文本文件并使用记事本打开。

**投毒风险：**
分析提供的代码，没有发现明显的投毒代码。`poc.py` 的作用是生成恶意 ZIP 文件，而 `script.bat` 包含的是恶意行为的代码，例如运行良性文件，创建 `hacked.txt` 等。这些行为是漏洞利用的一部分，而不是隐藏的恶意代码。虽然利用 `script.bat` 可以执行任意操作，但这属于漏洞利用的范畴，而非代码投毒。

**利用方式：**
1.  攻击者使用 `poc.py` 脚本生成一个恶意的 ZIP 压缩包，其中包含一个良性文件（例如图片）和一个同名的文件夹。
2.  攻击者将此恶意 ZIP 压缩包发送给受害者。
3.  受害者使用 WinRAR (6.23 之前的版本) 打开并尝试查看 ZIP 压缩包中的良性文件。
4.  WinRAR 错误地执行与良性文件同名的文件夹中的内容 (由 `script.bat` 控制)。
5.  `script.bat` 首先将 ZIP 文件的内容解压到临时目录。
6.  `script.bat` 运行良性文件（例如图片）作为诱饵，以迷惑受害者。
7.  `script.bat` 执行任意恶意操作，例如创建文件，修改注册表，安装恶意软件等。


**项目地址:** [kehrijksen/CVE-2023-38831](https://github.com/kehrijksen/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #18

**来源**: [CVE-2023-38831-khanhtranngoccva_cve-2023-38831-poc.md](../2023/CVE-2023-38831-khanhtranngoccva_cve-2023-38831-poc.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。该漏洞源于WinRAR处理ZIP压缩包时，对文件名和文件夹名区分不当。攻击者可以创建一个ZIP压缩包，其中包含一个良性文件（例如JPG）和一个同名的文件夹。该文件夹中包含恶意可执行文件。当用户尝试在WinRAR中打开该良性文件时，WinRAR会错误地执行文件夹中的恶意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已在野外被利用，证明了其有效性。提供的POC代码片段（package-lock.json）显示使用了jszip库，表明该POC可能用于创建恶意的ZIP压缩包，进一步验证漏洞的可利用性。

**投毒风险：**
提供的POC代码片段是`package-lock.json`文件，主要描述了项目依赖。要判断是否存在投毒风险，需要检查实际的利用代码（例如 index.ts/index.js）。
*   这个`package-lock.json`文件本身不包含恶意代码，只是依赖声明。
*   **风险点在于开发者可能在其他代码文件中（如index.ts等，此文件未提供）包含恶意代码**。
*   jszip 库本身是一个常用的 ZIP 文件操作库，被投毒的可能性较低。
*   tsx和typescript是typescript相关工具，本身被投毒的可能性也比较低

由于缺乏实际的利用代码，无法确定是否存在投毒行为，只能根据现有信息进行推测，因此将投毒风险评估为10%。

**利用方式：**
1.  攻击者构造一个恶意的ZIP压缩包。
2.  该ZIP压缩包包含一个良性文件（例如JPG）和一个同名的文件夹。
3.  该文件夹中包含恶意可执行文件（例如EXE、BAT、CMD等）。
4.  攻击者诱骗用户使用受影响的WinRAR版本打开该ZIP压缩包。
5.  用户尝试在WinRAR中打开该良性文件。
6.  WinRAR错误地执行文件夹中的恶意代码，导致远程代码执行。

**项目地址:** [khanhtranngoccva/cve-2023-38831-poc](https://github.com/khanhtranngoccva/cve-2023-38831-poc)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #19

**来源**: [CVE-2023-38831-kuyrathdaro_winrar-cve-2023-38831.md](../2023/CVE-2023-38831-kuyrathdaro_winrar-cve-2023-38831.md)

## CVE-2023-38831-WinRAR代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个代码执行漏洞。该漏洞的利用方式如下：

1.  攻击者创建一个恶意的ZIP压缩包（伪装成RAR格式，后缀名为.rar）。
2.  该压缩包包含一个良性的文件（例如，document.pdf），以及一个与该良性文件同名的文件夹（例如，document.pdf）。
3.  同名文件夹中包含恶意payload（例如，一个.bat或.exe文件），命名为`document.pdfA.cmd`。
4.  用户使用存在漏洞的WinRAR版本打开该压缩包，并尝试打开良性文件（document.pdf）。
5.  由于WinRAR处理文件名的缺陷，实际上执行的是同名文件夹中的恶意payload。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以判断该漏洞PoC有效。搜索引擎结果中多个链接表明该漏洞已被广泛利用，并且Google的威胁分析小组也分析了利用该漏洞进行的攻击活动。提供的PoC代码实现了生成恶意RAR压缩包的逻辑，进一步验证了该漏洞的可利用性。

**投毒风险：**

PoC代码本身的主要功能是生成利用CVE-2023-38831漏洞的恶意压缩包。然而，我们仍然需要评估该代码是否存在潜在的投毒风险。以下是对代码的分析：

*   **代码功能明确：** PoC代码的功能是生成特定的文件结构和内容，以触发WinRAR漏洞。代码逻辑相对简单，易于理解。
*   **输入/输出控制：** PoC代码接受三个输入参数：良性文件、Payload文件和输出文件名。这三个参数都由用户指定，PoC本身没有主动下载或执行任何其他代码的功能。
*   **潜在风险点：** `exploit.py` 脚本使用 `shutil.copyfile` 函数来复制 payload 文件到临时目录，如果payload 文件本身就是恶意的，那么这也会造成风险。此外，尽管脚本尝试确保输出文件以 `.rar` 结尾，但恶意用户可能修改此行为。
*   **间接风险：** 如果攻击者修改了提供的 `exploit.py` 脚本，添加额外的恶意功能（例如，在生成恶意压缩包后，自动上传到恶意服务器），则可能存在投毒风险。但是，这并非原始PoC代码本身的问题。

综合来看，原始PoC代码本身存在直接投毒的风险较低，我估计的投毒风险概率为 **10%**。这主要是因为恶意 payload 本身会带来风险，但 PoC 代码并没有主动引入恶意行为。

**利用方式：**

1.  准备一个良性的文件（例如，document.pdf）和一个恶意payload（例如，script.bat或malware.exe）。
2.  运行PoC脚本，指定良性文件、payload文件和输出文件名。
3.  PoC脚本生成一个恶意的RAR压缩包（实际上是ZIP格式，但后缀名为.rar）。
4.  将该恶意RAR压缩包发送给目标用户。
5.  目标用户使用存在漏洞的WinRAR版本打开该压缩包，并尝试打开良性文件。
6.  WinRAR执行同名文件夹中的恶意payload，从而实现代码执行。


**项目地址:** [kuyrathdaro/winrar-cve-2023-38831](https://github.com/kuyrathdaro/winrar-cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #20

**来源**: [CVE-2023-38831-malvika-thakur_CVE-2023-38831.md](../2023/CVE-2023-38831-malvika-thakur_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以通过创建一个特制的 ZIP 压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹，文件夹中包含恶意可执行文件。当用户尝试在 WinRAR 中查看该良性文件时，由于 WinRAR 处理逻辑的缺陷，会错误地执行文件夹中的恶意代码，从而导致远程代码执行。

**有效性：**

提供的 POC 代码 `poc.py`  可以生成利用此漏洞的 ZIP 文件。代码首先检查恶意脚本和良性文件是否存在，然后创建一个目录，将脚本和良性文件复制到特定结构中，最后将该目录压缩成 ZIP 文件。用户只需双击压缩包内的良性文件即可触发漏洞，执行恶意脚本。因此，POC 代码有效。

**投毒风险：**

分析提供的 `poc.py` 代码，没有发现明显的投毒代码。该脚本的主要功能是生成利用 CVE-2023-38831 漏洞的恶意 ZIP 文件。它需要用户提供恶意脚本和良性文件，然后按照特定目录结构进行组织并压缩。代码中没有发现任何会执行额外恶意操作的逻辑。`README.md` 文件也仅包含漏洞描述和使用说明，没有发现恶意内容。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者创建一个包含良性文件（如 JPG 图片）和一个同名文件夹的 ZIP 压缩包。
2.  该文件夹中包含恶意可执行文件（如 BAT 脚本）。
3.  攻击者将该 ZIP 压缩包发送给目标用户。
4.  目标用户使用受影响的 WinRAR 版本打开该 ZIP 压缩包。
5.  目标用户双击 ZIP 压缩包中的良性文件。
6.  WinRAR 错误地执行同名文件夹中的恶意可执行文件，导致远程代码执行。

**项目地址:** [malvika-thakur/CVE-2023-38831](https://github.com/malvika-thakur/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #21

**来源**: [CVE-2023-38831-r1yaz_winDED.md](../2023/CVE-2023-38831-r1yaz_winDED.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开特制的恶意 ZIP 压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 是 WinRAR 在处理 ZIP 压缩文件时存在的远程代码执行漏洞。当 WinRAR 版本低于 6.23 时，如果用户尝试打开一个包含恶意构造的 ZIP 文件，攻击者可以利用此漏洞执行任意代码。该 ZIP 文件包含一个良性文件（例如 JPG 文件）和一个与其同名的文件夹。攻击者可以将可执行文件放置在该文件夹中，当用户尝试访问良性文件时，WinRAR 会错误地执行文件夹中的可执行文件。

**有效性：**
提供的 POC 代码（winDED）通过生成恶意 ZIP 文件来演示漏洞利用。它创建了一个良性文件和一个同名文件夹，并将恶意脚本放入文件夹中。用户双击压缩包中的 PDF 文件时，实际上会执行该恶意脚本，从而证明漏洞的可利用性。

**投毒风险：**
根据提供的 POC 代码，投毒风险较低。代码主要是为了演示漏洞而设计的，虽然存在执行恶意 `super_sneaky_evil_script.bat` 的可能性，但该脚本本身是由用户提供的，或者可以通过查看代码本身来确认其行为。 然而，仍然存在一些细微的风险，例如，如果 `super_sneaky_evil_script.bat` 本身是从其他来源下载的，则可能包含恶意代码。  总的来说, 投毒风险约 10%。

**利用方式：**
1.  创建一个包含良性文件 (例如，`BILLION_DOLLAR_SECRET.pdf`) 和一个同名文件夹 (`BILLION_DOLLAR_SECRET.pdf`) 的 ZIP 压缩文件。
2.  将恶意脚本 (例如，`super_sneaky_evil_script.bat`) 放入同名文件夹中。
3.  诱骗目标用户使用 WinRAR 打开该 ZIP 文件。
4.  当用户尝试打开良性文件时，WinRAR 错误地执行同名文件夹中的恶意脚本，从而实现远程代码执行。

**项目地址:** [r1yaz/winDED](https://github.com/r1yaz/winDED)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #22

**来源**: [CVE-2023-38831-ra3edAJ_LAB-DFIR-cve-2023-38831.md](../2023/CVE-2023-38831-ra3edAJ_LAB-DFIR-cve-2023-38831.md)

## CVE-2023-38831-WinRAR代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 是 WinRAR 在 6.23 版本之前存在的远程代码执行漏洞。该漏洞源于WinRAR处理ZIP压缩包时，如果压缩包中包含一个良性文件和一个与该良性文件同名的文件夹，WinRAR在尝试访问良性文件时，会错误地执行同名文件夹中的恶意内容。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的PoC是可用的。漏洞在野外被广泛利用，并且CISA已将其添加到已知被利用的漏洞目录中。

**投毒风险：**
提供的漏洞利用代码为一个Github仓库的README.md文件，主要描述了如何利用磁盘镜像调查CVE-2023-38831攻击，并通过Windows注册表、NTFS文件和浏览器缓存理解Windows事件序列。仓库本身目的是为了DFIR分析，因此直接包含恶意代码的可能性较低。但考虑到链接跳转至外部教程网站，存在间接投毒的可能，即教程内容可能包含引导至恶意软件下载或运行恶意脚本的指令。因此，投毒风险较低，评估为10%。

**利用方式：**
1.  **创建恶意的ZIP压缩包：** 压缩包中包含一个良性文件（如JPG图片）和一个与该良性文件同名的文件夹。
2.  **将恶意可执行文件放入同名文件夹：** 该文件夹中的可执行文件会在用户尝试打开良性文件时被执行。
3.  **诱导用户打开ZIP压缩包：** 通过社交工程或其他方式，诱导用户使用受影响版本的WinRAR打开该压缩包。
4.  **触发漏洞执行恶意代码：** 当用户尝试查看ZIP压缩包中的良性文件时，WinRAR会错误地执行同名文件夹中的恶意代码，从而实现远程代码执行。

**总结：**
该漏洞利用方式较为简单，易于传播，危害较大。用户应及时更新WinRAR至最新版本，避免打开来源不明的ZIP压缩包。

**项目地址:** [ra3edAJ/LAB-DFIR-cve-2023-38831](https://github.com/ra3edAJ/LAB-DFIR-cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #23

**来源**: [CVE-2023-38831-ruycr4ft_CVE-2023-38831.md](../2023/CVE-2023-38831-ruycr4ft_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的远程代码执行漏洞。该漏洞源于WinRAR在处理ZIP压缩包时，对文件名和文件夹名相同的情况处理不当。攻击者可以构造一个恶意的ZIP压缩包，其中包含一个看似无害的文件（例如.jpg），同时包含一个同名的文件夹。当用户尝试打开该“无害文件”时，WinRAR会错误地执行同名文件夹中的恶意代码。\n\n**有效性：** 根据漏洞信息、搜索结果以及提供的POC代码，该漏洞利用是有效的。多个来源都表明该漏洞已被广泛利用，POC代码也展示了如何生成包含恶意代码的RAR压缩文件。POC代码通过创建同名文件和文件夹，并在文件夹中放入恶意脚本，利用WinRAR的缺陷触发代码执行。\n\n**投毒风险：**  仓库的投毒风险较低，大概10%。
  *   `poc.py`: 该脚本的功能是生成利用 CVE-2023-38831 的恶意 RAR 文件。虽然它允许用户指定 bait 文件和脚本文件，但脚本本身不包含任何预设的、隐藏的恶意行为。
  *   `script.bat`:  这个批处理文件包含使用 `nc.exe` (netcat) 反弹 shell 的命令。**这里存在一定的投毒风险。** 批处理文件明确地使用了`192.168.0.107`这个IP地址,如果用户直接使用该IP反弹shell,将会连接到攻击者的服务器。虽然IP地址可以被用户更改，但在默认情况下，如果用户不修改，将会连接到攻击者的IP。这是主要的投毒点。
  *   README.md: 该文件仅包含漏洞的简单介绍和演示图片。没有发现恶意代码。

**利用方式：**\n1.  攻击者创建一个恶意的ZIP压缩包。该压缩包包含一个诱饵文件（例如图片.jpg）和一个与其同名的文件夹（例如图片.jpg）。\n2.  攻击者将恶意代码（例如一个批处理脚本或可执行文件）放入同名文件夹中。\n3.  攻击者将包含恶意代码的ZIP压缩包发送给受害者。\n4.  受害者使用存在漏洞的WinRAR版本打开该ZIP压缩包，并尝试打开诱饵文件。\n5.  WinRAR错误地执行同名文件夹中的恶意代码，导致远程代码执行。

**项目地址:** [ruycr4ft/CVE-2023-38831](https://github.com/ruycr4ft/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #24

**来源**: [CVE-2023-38831-s4m98_winrar-cve-2023-38831-poc-gen.md](../2023/CVE-2023-38831-s4m98_winrar-cve-2023-38831-poc-gen.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开恶意的ZIP/RAR压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于WinRAR处理ZIP压缩文件时，由于对文件名和文件夹名处理不当导致。攻击者可以构造一个包含恶意脚本的ZIP压缩文件，该压缩文件包含一个正常的诱饵文件（如PDF、PNG或JPG）和一个同名的文件夹，当用户尝试打开诱饵文件时，WinRAR会错误地执行该文件夹中的恶意脚本。

**有效性：**
根据漏洞信息、搜索引擎结果和漏洞利用代码，该POC代码有效。漏洞库信息表明该漏洞已被野外利用。搜索引擎结果中也包含了大量关于此漏洞的分析和利用报告，证实了该漏洞的有效性。POC代码的描述和实现也符合漏洞的利用方式，通过生成包含恶意脚本和诱饵文件的RAR压缩包来触发漏洞。

**投毒风险：**
代码本身看起来比较直接，主要是生成利用漏洞的压缩包。`script.bat` 这个文件需要额外注意。当前提供的 `script.bat` 只是打开了计算器 `calc.exe` 和 Web_Security.pdf,相对来说是安全的，但用户在使用该漏洞时，完全可以修改此文件，添加更加恶意的payload，具有一定的风险。作者在代码中没有明显投毒行为，主要风险在于用户如何使用该工具生成payload。
投毒风险评估：10% (主要是用户修改 `script.bat` 的风险)

**利用方式：**
1.  **构造恶意ZIP/RAR压缩文件：** 利用提供的Python脚本（cve-2023-38831-exp-gen.py）生成恶意的ZIP/RAR压缩文件。此脚本需要一个诱饵文件（如PDF、PNG、JPG）和一个恶意脚本文件（如BAT、CMD、或可执行文件）。该脚本会创建一个包含诱饵文件和一个同名文件夹的压缩包，并将恶意脚本放置在该文件夹中。
2.  **诱骗用户打开压缩文件：**  将生成的恶意ZIP/RAR压缩文件发送给目标用户。
3.  **执行恶意代码：** 当用户使用受影响的WinRAR版本打开压缩文件并尝试查看诱饵文件时，WinRAR会错误地执行同名文件夹中的恶意脚本，从而实现远程代码执行。

 总体来说，该漏洞利用方式较为简单，攻击成本较低，风险较高。

**项目地址:** [s4m98/winrar-cve-2023-38831-poc-gen](https://github.com/s4m98/winrar-cve-2023-38831-poc-gen)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #25

**来源**: [CVE-2023-38831-solomon12354_VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC.md](../2023/CVE-2023-38831-solomon12354_VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要解压恶意的ZIP/RAR压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 存在于 WinRAR 6.23 之前版本中。攻击者可以构造一个包含良性文件和同名文件夹的 ZIP 压缩包，当用户尝试访问良性文件时，WinRAR 会错误地执行同名文件夹中的恶意代码。提供的 `exploit.py` 脚本可以用于生成包含漏洞利用的RAR压缩文件。脚本首先要求输入良性文件（`bait_file`）、恶意脚本文件（`script_file`）和输出RAR文件名称。然后，它创建一个临时目录，将恶意脚本复制到与良性文件同名的目录中，并将良性文件复制到临时目录中。最后，使用 `shutil.make_archive` 函数将临时目录压缩成 ZIP 文件，并修改 ZIP 文件的内容，将目录名中的 'A' 和 'B' 替换为空格，从而绕过 WinRAR 的安全检查。最终，将修改后的 ZIP 文件重命名为 RAR 文件。

`squid.bat` 用于下载并执行 `volleysquid.exe`。`volleyballsquid.py` 尝试利用 BypassUAC 来提升权限并将程序设置为开机自启。

**有效性:** 根据漏洞信息和利用代码分析，提供的 POC 代码有效，可以利用此漏洞在受害者机器上执行任意代码。

**投毒风险:** 仓库中存在一定的投毒风险，虽然主要功能是利用CVE-2023-38831漏洞，但是 `volleyballsquid.py`和`squid.bat`文件中的行为具有恶意性，特别是`volleyballsquid.py`中尝试使用`BypassUAC`绕过用户账户控制并持久化安装，这可能被用于安装后门或恶意软件。虽然主要目的是展示漏洞，但客观上存在后门功能，因此投毒风险占比为10%。

**利用方式:** 攻击者首先利用 `exploit.py` 脚本生成包含恶意代码的RAR压缩文件。然后，诱骗用户下载并使用 WinRAR 解压此文件。当用户尝试打开压缩包中的“良性”文件时，实际上会执行隐藏在同名目录中的恶意脚本 (例如 `squid.bat`)，下载并执行恶意程序。

根据搜索结果，CVE-2023-38831 漏洞已被广泛利用，并且已被政府背景的攻击者使用，这进一步验证了漏洞的严重性和 POC 代码的有效性。

**项目地址:** [solomon12354/VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC](https://github.com/solomon12354/VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #26

**来源**: [CVE-2023-38831-technicalcorp0_CVE-2023-38831-Exploit.md](../2023/CVE-2023-38831-technicalcorp0_CVE-2023-38831-Exploit.md)

## CVE-2023-38831-WinRAR-任意代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 任意代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个漏洞，该漏洞允许攻击者通过特制的ZIP档案执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** 当WinRAR尝试访问ZIP归档中的良性文件时，如果存在与该良性文件同名的文件夹，WinRAR会处理该文件夹的内容（可能包含可执行内容）。
2.  **利用方式：**
    *   攻击者创建一个恶意的ZIP档案，该档案包含一个良性文件（例如.JPG文件）和一个与该良性文件同名的文件夹。
    *   该文件夹包含恶意可执行文件。
    *   当受害者尝试在WinRAR中查看良性文件时，WinRAR会执行该文件夹中的恶意代码。
3.  **POC有效性：** 提供的POC代码 (CVE-2023-38831-WinRar-Exploit.py) 的目的是生成包含利用此漏洞的恶意 ZIP 文件。根据代码逻辑和漏洞原理，该 POC 可以有效利用该漏洞。
4.  **投毒风险：** 经过对POC代码的分析，发现代码本身实现了漏洞利用过程，但同时也存在一定的投毒风险。`clean_up()`函数会删除临时文件，但不能保证完全清除所有痕迹。攻击者可能通过修改代码，在生成恶意 ZIP 文件后，在目标系统上留下后门或执行其他恶意操作。考虑到实际利用场景中可能存在的恶意修改，投毒风险估计为5%。 主要风险点在于，虽然POC主要目的是生成exploit，但如果恶意人员修改，完全可以添加其他恶意payload，并伪装成CVE-2023-38831的POC进行传播。
5. **搜索引擎结果:** 搜索引擎结果表明此漏洞已被广泛利用，包括政府背景的黑客组织。 多个安全厂商发布了相关的分析和防御措施。

**项目地址:** [technicalcorp0/CVE-2023-38831-Exploit](https://github.com/technicalcorp0/CVE-2023-38831-Exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #27

**来源**: [CVE-2023-38831-xk-mt_WinRAR-Vulnerability-recurrence-tutorial.md](../2023/CVE-2023-38831-xk-mt_WinRAR-Vulnerability-recurrence-tutorial.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。该漏洞允许攻击者通过构造恶意的ZIP压缩包，在用户尝试查看压缩包内的文件时执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，该漏洞已被广泛利用，POC代码的存在也表明其有效性。多个安全厂商和研究人员都对此漏洞进行了分析并提供了相应的缓解措施。

**投毒风险分析：**
提供的POC代码包含以下文件：
*   `README.md`: 漏洞复现教程，包含漏洞信息和参考链接。
*   `执行命令.bat`: 一个简单的批处理文件，用于执行`calc.exe`（计算器程序），用于演示代码执行。
*   `文本.txt`: 包含一个URL地址。
*   `生成压缩包.py`: 一个Python脚本，用于生成包含漏洞的ZIP压缩包。

该脚本的主要功能是：
1.  创建临时目录，并将`执行命令.bat`复制到该目录。
2.  复制`文本.txt`文件到另一个目录。
3.  将上述两个目录打包成ZIP文件。
4.  修改ZIP文件中的文件名，利用漏洞的原理。
从代码本身来看，该脚本并没有明显的恶意代码，但是存在一定的投毒风险。
*   执行命令.bat： 虽然只是简单的calc.exe，但如果攻击者替换成其他恶意命令，则可能造成更大的危害。
*   脚本的依赖： 该脚本依赖Python环境，攻击者可能会通过修改脚本，引入恶意的Python依赖包，从而实现投毒。

综合来看，该仓库中存在一定的投毒风险，但不高。主要是因为演示的`执行命令.bat`内容比较简单，容易被识别。如果使用者直接运行此仓库的代码，有可能会被植入恶意程序。因此，投毒风险评定为10%。

**利用方式：**
1.  攻击者构造一个恶意的ZIP压缩包，该压缩包包含一个良性文件（例如，图片文件`文本.txt`）和一个与该文件同名的文件夹。
2.  该文件夹包含一个恶意可执行文件（例如，`执行命令.bat`并更名为`文本.txtA.cmd`）。
3.  当用户使用受影响的WinRAR版本打开该ZIP压缩包，并尝试查看良性文件时，WinRAR会错误地执行该文件夹中的恶意可执行文件，从而导致任意代码执行。

**项目地址:** [xk-mt/WinRAR-Vulnerability-recurrence-tutorial](https://github.com/xk-mt/WinRAR-Vulnerability-recurrence-tutorial)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #28

**来源**: [CVE-2023-38831-yezzfusl_cve_2023_38831_scanner.md](../2023/CVE-2023-38831-yezzfusl_cve_2023_38831_scanner.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开恶意的 ZIP 压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以通过构造一个特殊的 ZIP 压缩文件来利用此漏洞。该 ZIP 文件包含一个良性文件（例如 JPG）和一个同名的文件夹。当用户尝试访问良性文件时，WinRAR 会错误地执行文件夹中的恶意代码，导致远程代码执行。

**利用方式：**
1.  攻击者创建一个包含良性文件和同名文件夹的恶意 ZIP 文件。
2.  文件夹中包含要执行的恶意代码（例如，可执行文件）。
3.  攻击者诱使用户使用 WinRAR 打开该 ZIP 文件。
4.  当用户尝试访问良性文件时，WinRAR 会执行文件夹中的恶意代码。

**有效性：**
根据漏洞描述和搜索结果，该漏洞已在野外被利用，因此提供的PoC代码如果能够重现该行为，则可以认为是有效的。

**投毒风险：**
提供的代码仓库 `cve_2023_38831_scanner` 本身是一个漏洞扫描器，而非漏洞利用的PoC。尽管如此，仍然存在一定的投毒风险。代码中可能隐藏后门，虽然其主要功能是扫描，但理论上存在被篡改的风险。代码中使用了网络数据包分析、进程内存扫描、沙箱环境执行等模块，这些模块如果被恶意修改，可能被用于执行恶意操作。因此，综合考虑其扫描器的性质和潜在风险，投毒风险估计为10%。这个风险主要来自供应链投毒，如果下载了被篡改过的扫描器，那么扫描器本身可能成为攻击的一部分。

**项目地址:** [yezzfusl/cve_2023_38831_scanner](https://github.com/yezzfusl/cve_2023_38831_scanner)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #29

**来源**: [CVE-2023-38831-youmulijiang_evil-winrar.md](../2023/CVE-2023-38831-youmulijiang_evil-winrar.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 50%

## 详情

CVE-2023-38831是WinRAR在6.23版本之前存在的一个远程代码执行漏洞。该漏洞的利用方式是构造一个特殊的ZIP压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹。当用户尝试在WinRAR中查看该良性文件时，WinRAR会错误地执行该文件夹中的恶意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认该漏洞是有效的，并且已经在野外被利用。漏洞利用代码提供了一个框架，用于生成包含恶意payload的ZIP压缩包，从而实现远程代码执行。

**投毒风险分析：**
提供的代码是一个框架，用于生成漏洞利用的 ZIP 文件，包含生成 exp，邮件发送，下载链接生成等功能。代码中存在潜在的投毒风险，主要体现在以下几个方面：

1.  **Payload 植入:**  该框架可以自定义payload，如果用户在不了解 payload 内容的情况下使用，可能运行恶意指令。
2.  **代码可信度:** 虽然作者声明为安全开发成员，并开源了代码，但代码的安全性仍然需要进一步审计。存在作者预留后门的可能性。 考虑到这是一个漏洞利用框架，其本质就是为了执行恶意代码，所以判定为投毒代码的风险为50%。

**漏洞利用方式：**

1.  攻击者使用该漏洞利用框架(evil-winrar)生成一个恶意的 ZIP 压缩包。
2.  该 ZIP 压缩包包含一个良性文件（如JPG图片）和一个同名的文件夹，文件夹中包含恶意可执行文件。
3.  攻击者通过社会工程学等方式诱骗用户使用存在漏洞的 WinRAR 版本打开该 ZIP 压缩包。
4.  用户尝试查看良性文件时，WinRAR 会错误地执行同名文件夹中的恶意代码。
5.  恶意代码在用户系统上执行，攻击者从而实现远程代码执行，控制受害者的计算机。

**项目地址:** [youmulijiang/evil-winrar](https://github.com/youmulijiang/evil-winrar)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---



---

## POC #3

**来源**: [CVE-2023-38831-MaorBuskila_Windows-X64-RAT.md](../2023/CVE-2023-38831-MaorBuskila_Windows-X64-RAT.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者在用户尝试查看 ZIP 压缩包中的良性文件时执行任意代码。该漏洞源于 WinRAR 处理 ZIP 压缩包时，允许压缩包包含一个良性文件（例如 .JPG）和一个同名文件夹。当用户尝试访问该良性文件时，WinRAR 实际上会处理同名文件夹中的内容，从而允许攻击者在文件夹中放置恶意可执行文件并执行。

**有效性：**
从搜索结果和漏洞库信息来看，该漏洞已经被广泛利用，PoC 代码的存在也进一步验证了其有效性。

**投毒风险：**
提供的 Python 脚本 (`51721.py`) 用于生成 Windows x64 平台的反向 TCP Shellcode。该脚本本身不包含明显的恶意代码，功能是生成 shellcode。需要用户自行配置 IP 地址和端口。但是，由于该代码需要用户执行，并且可以生成任意 shellcode，存在一定投毒风险，例如，如果攻击者提供修改后的脚本，生成包含恶意功能的 shellcode (如删除文件，上传用户信息)，则用户可能无意中执行该恶意 shellcode. 脚本本身不包含网络连接或者其他与远程服务器通信的行为，可以基本判断代码仓库投毒风险较低.

**利用方式：**
1.  攻击者创建一个恶意的 ZIP 压缩包。
2.  该 ZIP 压缩包包含一个良性文件（例如 image.jpg）和一个同名文件夹（image.jpg）。
3.  同名文件夹包含恶意可执行文件，例如 exploit.exe，并可能包含一个 `.lnk` 文件，该快捷方式指向该恶意可执行文件。
4.  攻击者诱骗用户使用受影响版本的 WinRAR 打开该 ZIP 压缩包并尝试查看良性文件。
5.  WinRAR 错误地执行同名文件夹中的恶意可执行文件，从而导致远程代码执行。

**项目地址:** [MaorBuskila/Windows-X64-RAT](https://github.com/MaorBuskila/Windows-X64-RAT)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #4

**来源**: [CVE-2023-38831-MyStuffYT_CVE-2023-38831-POC.md](../2023/CVE-2023-38831-MyStuffYT_CVE-2023-38831-POC.md)

## CVE-2023-38831-WinRAR-远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的恶意ZIP压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个恶意的ZIP压缩文件，其中包含一个良性文件（例如.jpg）和一个同名的文件夹。当用户尝试在 WinRAR 中查看该良性文件时，WinRAR 会错误地执行该文件夹中的内容，从而导致任意代码执行。

**有效性：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。搜索引擎结果表明该漏洞已被广泛利用，POC代码的存在进一步证实了其有效性。

**投毒风险：**

根据对POC代码的分析，存在一定的投毒风险。`script.bat`脚本从github下载`Alert.exe`文件，这本身就存在一定的安全隐患，无法确保下载的文件一定是安全的。此外，脚本同时执行 `alert.exe` 和 `gtaleak.mp4`，而 `gtaleak.mp4` 在 README 中说明是 “zeros without ones”, 可以确定这是一个障眼法，实际的恶意行为是由 `alert.exe` 执行。 因此，作者可能隐藏了投毒代码。

**利用方式：**

1.  攻击者创建一个恶意的ZIP压缩文件，其中包含一个良性文件 (例如 `gtaleak.mp4`) 和一个同名的文件夹。
2.  该文件夹包含一个批处理脚本 (`script.bat`)，该脚本将从远程服务器下载并执行恶意程序 (`Alert.exe`)。
3.  当用户尝试使用 WinRAR 打开压缩文件并查看良性文件 (`gtaleak.mp4`) 时，WinRAR 会错误地执行批处理脚本。
4.  批处理脚本下载并执行恶意程序，从而允许攻击者在受害者的系统上执行任意代码。

**项目地址:** [MyStuffYT/CVE-2023-38831-POC](https://github.com/MyStuffYT/CVE-2023-38831-POC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #5

**来源**: [CVE-2023-38831-Nielk74_CVE-2023-38831.md](../2023/CVE-2023-38831-Nielk74_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本的代码执行漏洞。该漏洞允许攻击者在用户尝试查看ZIP存档中的看似无害的文件时执行任意代码。攻击者通过构造一个包含同名文件和文件夹的恶意ZIP文件，利用WinRAR处理文件路径时的逻辑缺陷，使得文件夹中的恶意可执行文件得以运行。提供的POC代码通过Vagrant自动化部署了一个易受攻击的WinRAR 6.22环境，并向虚拟机桌面添加了一个恶意的rar文件。该rar文件被设计为当用户点击其中的“无害”文件时，执行预先设定的恶意代码。尽管POC的主要目的是演示漏洞，但其中`ChocolateyInstall.ps1`脚本从外部源下载并安装软件包（Chocolatey和WinRAR），存在被篡改从而引入恶意代码的风险，这构成了潜在的投毒风险。虽然这个脚本很常见，但还是存在一定的风险，因此这里给出了10%的投毒风险。

**漏洞利用方式：**

1.  攻击者创建一个恶意的ZIP压缩包，其中包含一个看似无害的文件（例如.jpg），以及一个与该文件同名的文件夹。
2.  该文件夹包含恶意可执行文件，例如.exe或.cmd脚本。
3.  当用户尝试使用WinRAR打开ZIP压缩包并查看“无害”文件时，WinRAR会错误地执行同名文件夹中的恶意可执行文件，从而导致任意代码执行。
4.  攻击者可以利用此漏洞在受害者系统上安装恶意软件、窃取敏感数据或执行其他恶意操作。

**项目地址:** [Nielk74/CVE-2023-38831](https://github.com/Nielk74/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #6

**来源**: [CVE-2023-38831-RomainBayle08_CVE-2023-38831.md](../2023/CVE-2023-38831-RomainBayle08_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP或RAR压缩文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个特殊的 ZIP 压缩文件，该文件包含一个看似无害的文件（例如，.JPG 文件）和一个与该文件同名的文件夹。当用户尝试查看压缩文件中的无害文件时，WinRAR 会错误地执行文件夹中的内容，从而导致任意代码执行。

**有效性分析：**
提供的 POC 代码 `cve-2023-38831-exp-gen.py` 是一个漏洞利用生成器脚本，它接受诱饵文件 (`BAIT_NAME`)、脚本文件 (`SCRIPT_NAME`) 和额外的诱饵文件目录 (`BAIT_FILES`) 作为输入，并生成一个恶意 RAR 压缩文件 (`OUTPUT_NAME`)。脚本首先创建一个包含诱饵文件和脚本文件的临时目录结构，然后使用 `shutil.make_archive` 函数将该目录压缩为 ZIP 文件。关键在于，脚本会替换 ZIP 文件中特定文件的扩展名，利用 WinRAR 的漏洞，在用户尝试打开诱饵文件时执行脚本文件。`script.bat` 脚本会首先尝试打开诱饵文件（模拟用户行为），然后执行 `calc.exe`（作为漏洞利用成功的标志）。该 POC 的有效性较高，因为它模拟了真实的攻击场景。

**投毒风险分析：**
`cve-2023-38831-exp-gen.py` 脚本本身不包含明显的恶意代码或后门。但是，存在一定的投毒风险，因为该脚本允许攻击者指定要执行的任意脚本 (`SCRIPT_NAME`)。攻击者可以替换 `script.bat` 文件为包含恶意代码的文件，例如下载和执行其他恶意软件。此外，该脚本使用了`BAIT_FILES`参数，如果提供包含恶意文件的目录，也会构成投毒风险。所以存在一定投毒风险，但主要取决于用户提供的脚本和目录的内容。

**利用方式分析：**
1.  攻击者构造一个恶意 ZIP 压缩文件，其中包含一个诱饵文件（如 `CLASSIFIED_DOCUMENTS.pdf`）和一个与诱饵文件同名的文件夹。文件夹中包含一个脚本文件（如 `script.bat`）。
2.  攻击者将恶意 ZIP 文件发送给受害者，诱骗其使用 WinRAR 打开。
3.  当受害者尝试查看 ZIP 文件中的诱饵文件时，WinRAR 会错误地执行同名文件夹中的脚本文件。
4.  脚本文件执行任意代码，例如安装恶意软件或窃取敏感信息。

总的来说，该漏洞利用方式简单有效，风险较高。用户应尽快升级到 WinRAR 6.23 或更高版本。

**项目地址:** [RomainBayle08/CVE-2023-38831](https://github.com/RomainBayle08/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #7

**来源**: [CVE-2023-38831-RonF98_CVE-2023-38831-POC.md](../2023/CVE-2023-38831-RonF98_CVE-2023-38831-POC.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致任意代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831 是 WinRAR 在处理 ZIP 压缩文件时存在的一个漏洞。攻击者可以构造一个包含良性文件（例如 .jpg 文件）和一个同名文件夹的 ZIP 压缩包。该文件夹中包含恶意代码（例如 .cmd 文件）。当用户尝试查看良性文件时，WinRAR 会错误地执行文件夹中的恶意代码，从而导致远程代码执行。

**有效性：**

提供的 POC 代码有效，它演示了如何创建一个恶意的 RAR 文件来利用此漏洞。

*   `DoS.cmd` 文件包含恶意代码，用于创建多个消息框，模拟拒绝服务攻击。
*   `exploit.py` 脚本用于生成包含恶意 `DoS.cmd` 文件的 RAR 文件，并利用漏洞触发代码执行。
*   `README.md` 详细解释了漏洞原理和利用方法，并提供了攻击成功的截图。

**投毒风险：**

此仓库中可能存在轻微的投毒风险，约为5%。

*   `DoS.cmd` 只是一个简单的拒绝服务攻击示例，但攻击者可能会将其替换为更具破坏性的恶意代码，例如勒索软件或信息窃取程序。如果下载者不仔细检查 `DoS.cmd` 的内容，可能会在不知情的情况下运行恶意代码。
*   `exploit.py` 脚本本身没有明显的恶意代码，但它可以被修改以生成包含不同恶意代码的 RAR 文件。下载者应该仔细审查脚本的内容，确保它不会被用于传播恶意软件。

**利用方式：**

1.  攻击者创建一个包含良性文件（例如 `image.jpg`）和一个同名文件夹（例如 `image.jpg `）的 ZIP 压缩包。注意文件夹名称后面有一个空格。
2.  在同名文件夹中，攻击者放置恶意代码（例如 `image.jpg .cmd`）。
3.  攻击者将 ZIP 文件转换为 RAR 文件（POC 脚本完成了此过程）。
4.  攻击者诱骗用户使用受影响的 WinRAR 版本打开 RAR 文件并尝试查看良性文件（`image.jpg`）。
5.  WinRAR 错误地执行同名文件夹中的恶意代码 (`image.jpg .cmd`)，从而导致远程代码执行。

由于该漏洞被广泛利用，并且网上存在大量相关的 POC 代码，因此攻击者很容易发起攻击。


**项目地址:** [RonF98/CVE-2023-38831-POC](https://github.com/RonF98/CVE-2023-38831-POC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #8

**来源**: [CVE-2023-38831-SpamixOfficial_CVE-2023-38831.md](../2023/CVE-2023-38831-SpamixOfficial_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前的版本中的代码执行漏洞。攻击者可以制作一个特制的ZIP压缩包，其中包含一个良性文件和一个同名文件夹，文件夹中包含恶意可执行文件。当用户尝试在WinRAR中查看良性文件时，实际上会执行文件夹中的恶意代码。\n\n**有效性：**根据漏洞库信息、搜索结果和漏洞利用代码，该漏洞POC是有效的。漏洞库信息中明确指出该漏洞已在野外被利用。搜索结果中多个链接都指向了关于该漏洞的分析和利用报告。提供的`Cargo.lock`文件很可能只是rust项目依赖管理文件，无法直接证明POC的有效性，需配合rust源码进行分析。\n\n**投毒风险：**分析提供的`Cargo.lock`文件，该文件列出了Rust项目`CVE-2023-38831`的依赖项。虽然`Cargo.lock`本身不包含可执行代码，但是，如果恶意作者修改了依赖项的版本或来源，理论上存在引入被篡改过的crate（Rust包）的风险。不过，由于`Cargo.lock`文件明确指定了每个依赖项的checksum，Cargo在构建项目时会验证下载的crate是否与checksum匹配，从而降低了被投毒的风险。评估投毒风险为10%。\n\n**利用方式：**攻击者创建一个包含以下结构的ZIP压缩包：\n\n1.  一个良性的文件，例如 `image.jpg`\n2.  一个与良性文件同名的文件夹，例如 `image.jpg`\n3.  在同名文件夹中，放置恶意可执行文件，例如 `image.jpg.exe` 或 `image.jpg `(通过空格进行欺骗)。\n\n当用户使用存在漏洞的WinRAR版本打开该ZIP文件并尝试查看`image.jpg`时，WinRAR会错误地执行`image.jpg`文件夹中的恶意程序，从而实现远程代码执行。

**项目地址:** [SpamixOfficial/CVE-2023-38831](https://github.com/SpamixOfficial/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #9

**来源**: [CVE-2023-38831-Tolu12wani_Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution.md](../2023/CVE-2023-38831-Tolu12wani_Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在用户尝试查看 ZIP 压缩包中的文件时执行任意代码。

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开特制的 ZIP 压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者通过构造恶意的 ZIP 压缩包实现远程代码执行。该压缩包包含一个良性文件（例如 JPG）和一个与良性文件同名的文件夹。当用户尝试访问良性文件时，WinRAR 会错误地执行同名文件夹中的内容，从而执行攻击者放置的恶意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被广泛利用。 提供的POC代码描述的是在压缩文件中嵌入恶意payload，并触发反向shell的实验环境验证过程。虽然该代码本身没有包含恶意代码，但描述了如何构建利用该漏洞的压缩文件。

**投毒风险：**
提供的 POC 代码仓库中只包含 PDF 报告和截图，并没有可执行的恶意代码。 但是,README中说明了该仓库展示了恶意payload的嵌入方式，存在一定的潜在风险。 因此，存在一定的投毒风险，但风险较低。根据readme描述和文件结构，投毒风险评估为10%，

**利用方式：**
1.  **创建恶意 ZIP 压缩包：** 攻击者创建一个 ZIP 压缩包，其中包含一个良性文件（例如 JPG）和一个与良性文件同名的文件夹。
2.  **放置恶意代码：** 将恶意可执行文件放置在与良性文件同名的文件夹中。
3.  **诱骗用户：** 诱骗用户使用受影响的 WinRAR 版本打开该 ZIP 压缩包并尝试查看良性文件。
4.  **执行恶意代码：** WinRAR 错误地执行同名文件夹中的恶意代码，从而实现远程代码执行。

根据搜索结果，该漏洞已经被政府支持的攻击者利用，用于投放 RAT（远程访问木马）等恶意软件。

**项目地址:** [Tolu12wani/Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution](https://github.com/Tolu12wani/Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #10

**来源**: [CVE-2023-38831-VictoriousKnight_CVE-2023-38831_Exploit.md](../2023/CVE-2023-38831-VictoriousKnight_CVE-2023-38831_Exploit.md)

## CVE-2023-38831-WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码。

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的恶意ZIP文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个漏洞，它允许攻击者通过构造特殊的ZIP文件来执行任意代码。攻击者创建一个ZIP文件，其中包含一个良性文件（例如，JPG图片）和一个与该良性文件同名的文件夹。该文件夹中包含恶意可执行文件。当用户尝试在WinRAR中查看该良性文件时，WinRAR会错误地执行该文件夹中的恶意代码，从而导致远程代码执行。

**有效性：** 提供的POC代码是有效的。根据漏洞库信息和搜索结果，该漏洞在野外被广泛利用。POC代码通过创建包含良性文件和同名文件夹的恶意ZIP文件，并利用WinRAR处理文件时的缺陷来执行代码。POC代码结构清晰，易于理解和使用。

**投毒风险：** 提供的POC代码本身主要是利用漏洞生成EXP，但仔细检查代码，在`exploit.py`文件的zip文件内容操作部分被截断，没有展示修改zip文件内容的关键代码，作者可能在`Read and manipulate the zip file content`部分添加恶意代码，执行修改zip文件过程中的任何恶意行为。因此存在一定的投毒风险，根据代码完整度，我给出10%的投毒风险。

**利用方式：**
1.  攻击者创建一个恶意ZIP文件，其中包含一个看似无害的文件（例如，一个图片或PDF）。
2.  在ZIP文件中，攻击者同时创建一个与该无害文件同名的文件夹。
3.  该文件夹包含攻击者想要执行的恶意代码，通常是一个可执行文件或脚本。
4.  攻击者诱使用户使用存在漏洞的WinRAR版本打开该ZIP文件。
5.  当用户尝试访问ZIP文件中的“无害”文件时，WinRAR会错误地执行同名文件夹中的恶意代码。

**项目地址:** [VictoriousKnight/CVE-2023-38831_Exploit](https://github.com/VictoriousKnight/CVE-2023-38831_Exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #11

**来源**: [CVE-2023-38831-anelya0333_Exploiting-CVE-2023-38831.md](../2023/CVE-2023-38831-anelya0333_Exploiting-CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开特制的ZIP压缩文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞允许攻击者通过特制的ZIP压缩文件在目标系统上执行任意代码。该漏洞的根源在于WinRAR在处理包含与文件同名文件夹的ZIP文件时存在缺陷。攻击者可以构造一个 ZIP 文件，其中包含一个良性文件（例如.JPG）和一个与其同名的文件夹。当用户尝试在 WinRAR 中查看该良性文件时，WinRAR 会错误地执行该文件夹中的恶意代码。此PoC脚本生成一个ZIP文件，其中包含诱饵文件(bait file)和恶意脚本(script file)，并修改ZIP文件的文件头，以利用此漏洞。脚本创建与诱饵文件同名的文件夹，并将恶意脚本放入其中。然后，将诱饵文件的副本也放入ZIP文件中。通过替换文件名字段中的某些字符，WinRAR会将文件夹中的恶意文件误认为是要执行的文件，最终导致代码执行。由于代码仅仅是构造payload，不存在主动执行恶意代码，因此不存在投毒风险。

**项目地址:** [anelya0333/Exploiting-CVE-2023-38831](https://github.com/anelya0333/Exploiting-CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #12

**来源**: [CVE-2023-38831-b1tg_CVE-2023-38831-winrar-exploit.md](../2023/CVE-2023-38831-b1tg_CVE-2023-38831-winrar-exploit.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可导致完全系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开恶意构造的ZIP文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 允许攻击者通过特制的ZIP文件在受害者系统上执行任意代码。该漏洞源于 WinRAR 处理包含同名文件和文件夹的 ZIP 档案时的不当行为。攻击者可以创建一个 ZIP 文件，其中包含一个良性文件（例如 CLASSIFIED_DOCUMENTS.pdf）和一个同名文件夹（例如 CLASSIFIED_DOCUMENTS.pdf）。当用户尝试访问良性文件时，WinRAR 实际上会执行该文件夹中的内容（例如 script.bat）。

**有效性:**

提供的 POC 代码 `cve-2023-38831-exp-gen.py` 旨在生成利用此漏洞的恶意 RAR 档案。该脚本通过以下步骤工作：

1.  创建临时目录 `TEMPLATE`。
2.  在 `TEMPLATE` 中创建一个与bait文件同名的文件夹，并在其中存放包含恶意命令的script文件（例如 `script.bat`， 其中包含`calc.exe & CLASSIFIED_DOCUMENTS.pdf`）。
3.  将bait文件存放在`TEMPLATE`目录。
4.  将`TEMPLATE`目录压缩为zip文件。
5.  修改压缩包中文件和文件夹的名字，构造漏洞。
6.  最终输出 `CVE-2023-38831-poc.rar`。

该脚本能够有效地生成利用 CVE-2023-38831 的 RAR 文件，因此提供的 POC 代码是有效的。

**投毒风险:**

对提供的 POC 代码 (`cve-2023-38831-exp-gen.py` 和 `script.bat`) 进行分析后，未发现明显的恶意代码或后门。该脚本的功能明确且集中于生成利用 CVE-2023-38831 的 RAR 档案。 `script.bat` 的主要功能是启动计算器程序 (`calc.exe`) 并尝试打开诱饵文档 (`CLASSIFIED_DOCUMENTS.pdf`)，这是一个典型的 PoC 行为。 因此，该仓库中存在作者隐藏的投毒代码的风险极低。

**利用方式:**

1.  攻击者使用 `cve-2023-38831-exp-gen.py` 脚本，指定诱饵文件（例如 `CLASSIFIED_DOCUMENTS.pdf`）和恶意脚本（例如 `script.bat`），生成恶意 RAR 档案。
2.  攻击者通过各种方式（例如，电子邮件、恶意网站）将恶意 RAR 档案分发给受害者。
3.  受害者使用易受攻击的 WinRAR 版本（< 6.23）打开恶意 RAR 档案。
4.  当受害者尝试访问诱饵文件时，WinRAR 错误地执行了同名文件夹中的恶意脚本。
5.  恶意脚本在受害者系统上执行任意代码，例如启动计算器或安装恶意软件。

**项目地址:** [b1tg/CVE-2023-38831-winrar-exploit](https://github.com/b1tg/CVE-2023-38831-winrar-exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #13

**来源**: [CVE-2023-38831-elefantesagradodeluzinfinita_cve-2023-38831.md](../2023/CVE-2023-38831-elefantesagradodeluzinfinita_cve-2023-38831.md)

## CVE-2023-38831 - WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用 WinRAR 打开特制的 ZIP 压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者通过特制的 ZIP 压缩包在受害者系统上执行任意代码。漏洞利用方式是创建一个 ZIP 压缩包，其中包含一个良性文件（例如 .jpg 或 .pdf）以及一个同名的文件夹。该文件夹包含恶意的可执行文件（例如 .cmd 或 .exe）。当用户尝试打开良性文件时，WinRAR 会错误地执行文件夹中的恶意代码。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码分析，该漏洞确实存在并且已经被野外利用。提供的代码描述了一个利用工具 "DR. GANDALF"，它允许用户创建包含此漏洞的 ZIP 文件，表明POC的有效性。

**投毒风险：** 提供的 README.md 文件主要描述了漏洞原理和利用工具的使用方法。但是，由于此工具允许用户自定义注入的代码和二进制文件，因此存在投毒风险。如果用户下载了包含恶意注入代码的ZIP文件，那么这个工具本身可能被利用来传播恶意软件。评估投毒风险为 10%，因为该描述文件本身不包含可以直接执行的后门代码，但生成的ZIP文件可以包含。

**利用方式：**
1.  攻击者创建一个包含恶意 ZIP 压缩包。
2.  ZIP 压缩包中包含一个良性文件（例如，`image.jpg`）和一个同名的文件夹（例如，`image.jpg`）。
3.  `image.jpg` 文件夹包含恶意的可执行文件（例如，`evil.cmd`）。
4.  攻击者诱骗受害者使用存在漏洞的 WinRAR 版本打开该 ZIP 压缩包并尝试访问良性文件 `image.jpg`。
5.  WinRAR 在处理该 ZIP 文件时，会错误地执行 `image.jpg` 文件夹中的恶意代码 `evil.cmd`，从而导致远程代码执行。

**项目地址:** [elefantesagradodeluzinfinita/cve-2023-38831](https://github.com/elefantesagradodeluzinfinita/cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #14

**来源**: [CVE-2023-38831-h3xecute_SideCopy-Exploits-CVE-2023-38831.md](../2023/CVE-2023-38831-h3xecute_SideCopy-Exploits-CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个远程代码执行漏洞。该漏洞的利用方式是构造一个特殊的ZIP压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹。当用户尝试使用WinRAR打开该ZIP压缩包并访问良性文件时，WinRAR会错误地执行文件夹中的恶意代码。

**有效性：**
提供的POC代码描述了漏洞利用的原理，即构造包含同名良性文件和文件夹的ZIP压缩包。根据漏洞信息和搜索结果，此方法是有效的，并且在野外被利用。

**投毒风险：**
该POC本身描述了漏洞的利用方式，包含一个指向YouTube视频的链接，以及对恶意压缩包结构的描述。投毒风险较低，约为10%，因为：
1.  POC主要以描述性文字和图片链接为主。
2.  缺乏直接可执行的payload代码。
3.  作者可能通过YouTube链接传播恶意信息。

**利用方式：**
1.  攻击者创建一个恶意的ZIP压缩包。
2.  该压缩包包含一个良性文件（例如JPG，PDF等）和一个与该文件同名的文件夹。
3.  恶意代码（例如，可执行文件）放置在同名文件夹中。
4.  攻击者诱骗用户使用WinRAR打开这个ZIP压缩包，并尝试访问良性文件。
5.  WinRAR在处理压缩包时，会错误地执行同名文件夹中的恶意代码，从而导致远程代码执行。

**项目地址:** [h3xecute/SideCopy-Exploits-CVE-2023-38831](https://github.com/h3xecute/SideCopy-Exploits-CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #15

**来源**: [CVE-2023-38831-idkwastaken_CVE-2023-38831.md](../2023/CVE-2023-38831-idkwastaken_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意的ZIP文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的漏洞。该漏洞的利用方式是创建一个特制的ZIP文件，其中包含一个良性文件和一个同名文件夹。当用户尝试使用WinRAR打开ZIP文件并访问该良性文件时，WinRAR会错误地执行该同名文件夹中的恶意代码，导致远程代码执行。

**有效性：**
提供的POC代码（exploit.c）利用了该漏洞。该代码生成一个ZIP文件，其中包含一个PDF文件（document.pdf）和一个名为“document.pdf\”的文件夹，该文件夹内包含一个恶意的批处理脚本（script.bat）。当用户在易受攻击的WinRAR版本中打开并尝试访问该PDF文件时，WinRAR将执行该批处理脚本。
checker.bat 是用来检测目标系统是否安装WinRAR，以及WinRAR的版本是否是受影响的版本。
exploit.ps1 看起来不完整，但是其作用应该是检查WinRAR版本。

**投毒风险：**
代码中存在一定的投毒风险，约为10%。原因如下：
*   **脚本内容可控：** exploit.c 中的script_content变量包含了要执行的命令，虽然当前POC仅仅是弹窗，但是攻击者可以修改这个变量，执行任意命令，例如下载恶意软件，执行系统命令等。
*   **复杂的构建过程：** exploit.c 代码本身比较复杂，阅读和分析需要一定的时间和精力。攻击者可以利用这一点，在代码中隐藏不易察觉的恶意代码。
虽然有潜在的投毒风险，但当前代码的主要目的是演示漏洞利用，风险较低，作者没有明显的隐藏后门行为，恶意代码比较容易被发现。

**利用方式：**
1.  攻击者创建一个恶意的ZIP压缩包，其中包含：
    *   一个良性的文件（例如 document.pdf）。
    *   一个与良性文件同名的文件夹（例如 document.pdf/）。
    *   恶意代码位于同名文件夹中（例如 document.pdf/script.bat）。
2.  攻击者诱骗目标用户使用存在漏洞的 WinRAR 版本打开此 ZIP 压缩包。
3.  当用户尝试打开良性文件时，WinRAR 错误地执行同名文件夹中的恶意代码，从而导致任意代码执行。


**项目地址:** [idkwastaken/CVE-2023-38831](https://github.com/idkwastaken/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #16

**来源**: [CVE-2023-38831-imbyter_imbyter-WinRAR_CVE-2023-38831.md](../2023/CVE-2023-38831-imbyter_imbyter-WinRAR_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 6.23

**利用条件:** 用户使用受影响的WinRAR版本打开特制的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于WinRAR 6.23之前的版本中。攻击者可以构造一个恶意的ZIP压缩包，其中包含一个伪装成良性文件的文件（例如 .jpg），以及一个同名的文件夹。当用户尝试在 WinRAR 中查看该“良性文件”时，实际上会执行同名文件夹中的恶意代码（例如 .cmd 或 .exe 文件）。

**有效性：**
根据漏洞信息和搜索结果，提供的POC代码是有效的。该POC利用了WinRAR处理ZIP压缩包时存在的逻辑漏洞，能够实现远程代码执行。

**投毒风险：**
提供的Python脚本 `make-poc.py` 用于生成POC压缩包，其本身的代码逻辑相对简单，主要功能是将指定的文件和脚本打包成特定的ZIP格式，并进行一些字符串替换以触发漏洞。主要风险在于脚本生成的POC包中包含的脚本，如果这个脚本是恶意的，那么整个利用过程就存在投毒风险。 仓库中的README.md文件里的测试脚本就是一个关闭计算机的脚本。代码本身存在一定的投毒风险.

*   脚本逻辑：脚本的功能是创建包含漏洞利用结构的RAR文件。
*   恶意操作：如果脚本被修改以包含下载和执行恶意软件的逻辑，那么用户在使用此脚本创建RAR文件时，就会受到投毒攻击。

**利用方式：**
1.  攻击者使用 `make-poc.py` 脚本构造恶意的ZIP压缩包，需要提供一个“良性”文件和一个恶意脚本。
2.  攻击者将恶意的ZIP压缩包发送给受害者。
3.  受害者使用受影响的WinRAR版本打开该ZIP压缩包，并尝试查看伪装的“良性”文件。
4.  WinRAR错误地执行了与“良性”文件同名的文件夹中的恶意脚本，导致远程代码执行。

**防御措施：**
*   升级WinRAR到6.23或更高版本。
*   谨慎打开来源不明的ZIP压缩包。
*   使用杀毒软件扫描ZIP压缩包。

**项目地址:** [imbyter/imbyter-WinRAR_CVE-2023-38831](https://github.com/imbyter/imbyter-WinRAR_CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #17

**来源**: [CVE-2023-38831-kehrijksen_CVE-2023-38831.md](../2023/CVE-2023-38831-kehrijksen_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 需要用户解压特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个恶意的 ZIP 压缩包，其中包含一个伪装成普通文件的文件和一个同名的文件夹。当用户尝试在 WinRAR 中查看该“普通文件”时，WinRAR 会错误地执行同名文件夹中的内容，从而导致任意代码执行。

**有效性：**
提供的 PoC 代码 `poc.py` 能够生成利用此漏洞的恶意 ZIP 压缩包。该脚本首先创建一个包含恶意 payload (例如 script.bat) 和良性文件 (例如 pepe.jpg) 的目录结构。然后，它将此目录结构压缩成 ZIP 文件，并修改 ZIP 文件中的文件名，以触发漏洞。`script.bat` 的作用是在 `%TEMP%` 目录下提取 ZIP 文件内容，运行良性文件作为诱饵，然后执行恶意操作，例如创建一个包含 “hacked” 内容的文本文件并使用记事本打开。

**投毒风险：**
分析提供的代码，没有发现明显的投毒代码。`poc.py` 的作用是生成恶意 ZIP 文件，而 `script.bat` 包含的是恶意行为的代码，例如运行良性文件，创建 `hacked.txt` 等。这些行为是漏洞利用的一部分，而不是隐藏的恶意代码。虽然利用 `script.bat` 可以执行任意操作，但这属于漏洞利用的范畴，而非代码投毒。

**利用方式：**
1.  攻击者使用 `poc.py` 脚本生成一个恶意的 ZIP 压缩包，其中包含一个良性文件（例如图片）和一个同名的文件夹。
2.  攻击者将此恶意 ZIP 压缩包发送给受害者。
3.  受害者使用 WinRAR (6.23 之前的版本) 打开并尝试查看 ZIP 压缩包中的良性文件。
4.  WinRAR 错误地执行与良性文件同名的文件夹中的内容 (由 `script.bat` 控制)。
5.  `script.bat` 首先将 ZIP 文件的内容解压到临时目录。
6.  `script.bat` 运行良性文件（例如图片）作为诱饵，以迷惑受害者。
7.  `script.bat` 执行任意恶意操作，例如创建文件，修改注册表，安装恶意软件等。


**项目地址:** [kehrijksen/CVE-2023-38831](https://github.com/kehrijksen/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #18

**来源**: [CVE-2023-38831-khanhtranngoccva_cve-2023-38831-poc.md](../2023/CVE-2023-38831-khanhtranngoccva_cve-2023-38831-poc.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。该漏洞源于WinRAR处理ZIP压缩包时，对文件名和文件夹名区分不当。攻击者可以创建一个ZIP压缩包，其中包含一个良性文件（例如JPG）和一个同名的文件夹。该文件夹中包含恶意可执行文件。当用户尝试在WinRAR中打开该良性文件时，WinRAR会错误地执行文件夹中的恶意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已在野外被利用，证明了其有效性。提供的POC代码片段（package-lock.json）显示使用了jszip库，表明该POC可能用于创建恶意的ZIP压缩包，进一步验证漏洞的可利用性。

**投毒风险：**
提供的POC代码片段是`package-lock.json`文件，主要描述了项目依赖。要判断是否存在投毒风险，需要检查实际的利用代码（例如 index.ts/index.js）。
*   这个`package-lock.json`文件本身不包含恶意代码，只是依赖声明。
*   **风险点在于开发者可能在其他代码文件中（如index.ts等，此文件未提供）包含恶意代码**。
*   jszip 库本身是一个常用的 ZIP 文件操作库，被投毒的可能性较低。
*   tsx和typescript是typescript相关工具，本身被投毒的可能性也比较低

由于缺乏实际的利用代码，无法确定是否存在投毒行为，只能根据现有信息进行推测，因此将投毒风险评估为10%。

**利用方式：**
1.  攻击者构造一个恶意的ZIP压缩包。
2.  该ZIP压缩包包含一个良性文件（例如JPG）和一个同名的文件夹。
3.  该文件夹中包含恶意可执行文件（例如EXE、BAT、CMD等）。
4.  攻击者诱骗用户使用受影响的WinRAR版本打开该ZIP压缩包。
5.  用户尝试在WinRAR中打开该良性文件。
6.  WinRAR错误地执行文件夹中的恶意代码，导致远程代码执行。

**项目地址:** [khanhtranngoccva/cve-2023-38831-poc](https://github.com/khanhtranngoccva/cve-2023-38831-poc)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #19

**来源**: [CVE-2023-38831-kuyrathdaro_winrar-cve-2023-38831.md](../2023/CVE-2023-38831-kuyrathdaro_winrar-cve-2023-38831.md)

## CVE-2023-38831-WinRAR代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个代码执行漏洞。该漏洞的利用方式如下：

1.  攻击者创建一个恶意的ZIP压缩包（伪装成RAR格式，后缀名为.rar）。
2.  该压缩包包含一个良性的文件（例如，document.pdf），以及一个与该良性文件同名的文件夹（例如，document.pdf）。
3.  同名文件夹中包含恶意payload（例如，一个.bat或.exe文件），命名为`document.pdfA.cmd`。
4.  用户使用存在漏洞的WinRAR版本打开该压缩包，并尝试打开良性文件（document.pdf）。
5.  由于WinRAR处理文件名的缺陷，实际上执行的是同名文件夹中的恶意payload。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以判断该漏洞PoC有效。搜索引擎结果中多个链接表明该漏洞已被广泛利用，并且Google的威胁分析小组也分析了利用该漏洞进行的攻击活动。提供的PoC代码实现了生成恶意RAR压缩包的逻辑，进一步验证了该漏洞的可利用性。

**投毒风险：**

PoC代码本身的主要功能是生成利用CVE-2023-38831漏洞的恶意压缩包。然而，我们仍然需要评估该代码是否存在潜在的投毒风险。以下是对代码的分析：

*   **代码功能明确：** PoC代码的功能是生成特定的文件结构和内容，以触发WinRAR漏洞。代码逻辑相对简单，易于理解。
*   **输入/输出控制：** PoC代码接受三个输入参数：良性文件、Payload文件和输出文件名。这三个参数都由用户指定，PoC本身没有主动下载或执行任何其他代码的功能。
*   **潜在风险点：** `exploit.py` 脚本使用 `shutil.copyfile` 函数来复制 payload 文件到临时目录，如果payload 文件本身就是恶意的，那么这也会造成风险。此外，尽管脚本尝试确保输出文件以 `.rar` 结尾，但恶意用户可能修改此行为。
*   **间接风险：** 如果攻击者修改了提供的 `exploit.py` 脚本，添加额外的恶意功能（例如，在生成恶意压缩包后，自动上传到恶意服务器），则可能存在投毒风险。但是，这并非原始PoC代码本身的问题。

综合来看，原始PoC代码本身存在直接投毒的风险较低，我估计的投毒风险概率为 **10%**。这主要是因为恶意 payload 本身会带来风险，但 PoC 代码并没有主动引入恶意行为。

**利用方式：**

1.  准备一个良性的文件（例如，document.pdf）和一个恶意payload（例如，script.bat或malware.exe）。
2.  运行PoC脚本，指定良性文件、payload文件和输出文件名。
3.  PoC脚本生成一个恶意的RAR压缩包（实际上是ZIP格式，但后缀名为.rar）。
4.  将该恶意RAR压缩包发送给目标用户。
5.  目标用户使用存在漏洞的WinRAR版本打开该压缩包，并尝试打开良性文件。
6.  WinRAR执行同名文件夹中的恶意payload，从而实现代码执行。


**项目地址:** [kuyrathdaro/winrar-cve-2023-38831](https://github.com/kuyrathdaro/winrar-cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #20

**来源**: [CVE-2023-38831-malvika-thakur_CVE-2023-38831.md](../2023/CVE-2023-38831-malvika-thakur_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以通过创建一个特制的 ZIP 压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹，文件夹中包含恶意可执行文件。当用户尝试在 WinRAR 中查看该良性文件时，由于 WinRAR 处理逻辑的缺陷，会错误地执行文件夹中的恶意代码，从而导致远程代码执行。

**有效性：**

提供的 POC 代码 `poc.py`  可以生成利用此漏洞的 ZIP 文件。代码首先检查恶意脚本和良性文件是否存在，然后创建一个目录，将脚本和良性文件复制到特定结构中，最后将该目录压缩成 ZIP 文件。用户只需双击压缩包内的良性文件即可触发漏洞，执行恶意脚本。因此，POC 代码有效。

**投毒风险：**

分析提供的 `poc.py` 代码，没有发现明显的投毒代码。该脚本的主要功能是生成利用 CVE-2023-38831 漏洞的恶意 ZIP 文件。它需要用户提供恶意脚本和良性文件，然后按照特定目录结构进行组织并压缩。代码中没有发现任何会执行额外恶意操作的逻辑。`README.md` 文件也仅包含漏洞描述和使用说明，没有发现恶意内容。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者创建一个包含良性文件（如 JPG 图片）和一个同名文件夹的 ZIP 压缩包。
2.  该文件夹中包含恶意可执行文件（如 BAT 脚本）。
3.  攻击者将该 ZIP 压缩包发送给目标用户。
4.  目标用户使用受影响的 WinRAR 版本打开该 ZIP 压缩包。
5.  目标用户双击 ZIP 压缩包中的良性文件。
6.  WinRAR 错误地执行同名文件夹中的恶意可执行文件，导致远程代码执行。

**项目地址:** [malvika-thakur/CVE-2023-38831](https://github.com/malvika-thakur/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #21

**来源**: [CVE-2023-38831-r1yaz_winDED.md](../2023/CVE-2023-38831-r1yaz_winDED.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开特制的恶意 ZIP 压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 是 WinRAR 在处理 ZIP 压缩文件时存在的远程代码执行漏洞。当 WinRAR 版本低于 6.23 时，如果用户尝试打开一个包含恶意构造的 ZIP 文件，攻击者可以利用此漏洞执行任意代码。该 ZIP 文件包含一个良性文件（例如 JPG 文件）和一个与其同名的文件夹。攻击者可以将可执行文件放置在该文件夹中，当用户尝试访问良性文件时，WinRAR 会错误地执行文件夹中的可执行文件。

**有效性：**
提供的 POC 代码（winDED）通过生成恶意 ZIP 文件来演示漏洞利用。它创建了一个良性文件和一个同名文件夹，并将恶意脚本放入文件夹中。用户双击压缩包中的 PDF 文件时，实际上会执行该恶意脚本，从而证明漏洞的可利用性。

**投毒风险：**
根据提供的 POC 代码，投毒风险较低。代码主要是为了演示漏洞而设计的，虽然存在执行恶意 `super_sneaky_evil_script.bat` 的可能性，但该脚本本身是由用户提供的，或者可以通过查看代码本身来确认其行为。 然而，仍然存在一些细微的风险，例如，如果 `super_sneaky_evil_script.bat` 本身是从其他来源下载的，则可能包含恶意代码。  总的来说, 投毒风险约 10%。

**利用方式：**
1.  创建一个包含良性文件 (例如，`BILLION_DOLLAR_SECRET.pdf`) 和一个同名文件夹 (`BILLION_DOLLAR_SECRET.pdf`) 的 ZIP 压缩文件。
2.  将恶意脚本 (例如，`super_sneaky_evil_script.bat`) 放入同名文件夹中。
3.  诱骗目标用户使用 WinRAR 打开该 ZIP 文件。
4.  当用户尝试打开良性文件时，WinRAR 错误地执行同名文件夹中的恶意脚本，从而实现远程代码执行。

**项目地址:** [r1yaz/winDED](https://github.com/r1yaz/winDED)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #22

**来源**: [CVE-2023-38831-ra3edAJ_LAB-DFIR-cve-2023-38831.md](../2023/CVE-2023-38831-ra3edAJ_LAB-DFIR-cve-2023-38831.md)

## CVE-2023-38831-WinRAR代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 是 WinRAR 在 6.23 版本之前存在的远程代码执行漏洞。该漏洞源于WinRAR处理ZIP压缩包时，如果压缩包中包含一个良性文件和一个与该良性文件同名的文件夹，WinRAR在尝试访问良性文件时，会错误地执行同名文件夹中的恶意内容。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的PoC是可用的。漏洞在野外被广泛利用，并且CISA已将其添加到已知被利用的漏洞目录中。

**投毒风险：**
提供的漏洞利用代码为一个Github仓库的README.md文件，主要描述了如何利用磁盘镜像调查CVE-2023-38831攻击，并通过Windows注册表、NTFS文件和浏览器缓存理解Windows事件序列。仓库本身目的是为了DFIR分析，因此直接包含恶意代码的可能性较低。但考虑到链接跳转至外部教程网站，存在间接投毒的可能，即教程内容可能包含引导至恶意软件下载或运行恶意脚本的指令。因此，投毒风险较低，评估为10%。

**利用方式：**
1.  **创建恶意的ZIP压缩包：** 压缩包中包含一个良性文件（如JPG图片）和一个与该良性文件同名的文件夹。
2.  **将恶意可执行文件放入同名文件夹：** 该文件夹中的可执行文件会在用户尝试打开良性文件时被执行。
3.  **诱导用户打开ZIP压缩包：** 通过社交工程或其他方式，诱导用户使用受影响版本的WinRAR打开该压缩包。
4.  **触发漏洞执行恶意代码：** 当用户尝试查看ZIP压缩包中的良性文件时，WinRAR会错误地执行同名文件夹中的恶意代码，从而实现远程代码执行。

**总结：**
该漏洞利用方式较为简单，易于传播，危害较大。用户应及时更新WinRAR至最新版本，避免打开来源不明的ZIP压缩包。

**项目地址:** [ra3edAJ/LAB-DFIR-cve-2023-38831](https://github.com/ra3edAJ/LAB-DFIR-cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #23

**来源**: [CVE-2023-38831-ruycr4ft_CVE-2023-38831.md](../2023/CVE-2023-38831-ruycr4ft_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的远程代码执行漏洞。该漏洞源于WinRAR在处理ZIP压缩包时，对文件名和文件夹名相同的情况处理不当。攻击者可以构造一个恶意的ZIP压缩包，其中包含一个看似无害的文件（例如.jpg），同时包含一个同名的文件夹。当用户尝试打开该“无害文件”时，WinRAR会错误地执行同名文件夹中的恶意代码。\n\n**有效性：** 根据漏洞信息、搜索结果以及提供的POC代码，该漏洞利用是有效的。多个来源都表明该漏洞已被广泛利用，POC代码也展示了如何生成包含恶意代码的RAR压缩文件。POC代码通过创建同名文件和文件夹，并在文件夹中放入恶意脚本，利用WinRAR的缺陷触发代码执行。\n\n**投毒风险：**  仓库的投毒风险较低，大概10%。
  *   `poc.py`: 该脚本的功能是生成利用 CVE-2023-38831 的恶意 RAR 文件。虽然它允许用户指定 bait 文件和脚本文件，但脚本本身不包含任何预设的、隐藏的恶意行为。
  *   `script.bat`:  这个批处理文件包含使用 `nc.exe` (netcat) 反弹 shell 的命令。**这里存在一定的投毒风险。** 批处理文件明确地使用了`192.168.0.107`这个IP地址,如果用户直接使用该IP反弹shell,将会连接到攻击者的服务器。虽然IP地址可以被用户更改，但在默认情况下，如果用户不修改，将会连接到攻击者的IP。这是主要的投毒点。
  *   README.md: 该文件仅包含漏洞的简单介绍和演示图片。没有发现恶意代码。

**利用方式：**\n1.  攻击者创建一个恶意的ZIP压缩包。该压缩包包含一个诱饵文件（例如图片.jpg）和一个与其同名的文件夹（例如图片.jpg）。\n2.  攻击者将恶意代码（例如一个批处理脚本或可执行文件）放入同名文件夹中。\n3.  攻击者将包含恶意代码的ZIP压缩包发送给受害者。\n4.  受害者使用存在漏洞的WinRAR版本打开该ZIP压缩包，并尝试打开诱饵文件。\n5.  WinRAR错误地执行同名文件夹中的恶意代码，导致远程代码执行。

**项目地址:** [ruycr4ft/CVE-2023-38831](https://github.com/ruycr4ft/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #24

**来源**: [CVE-2023-38831-s4m98_winrar-cve-2023-38831-poc-gen.md](../2023/CVE-2023-38831-s4m98_winrar-cve-2023-38831-poc-gen.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开恶意的ZIP/RAR压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于WinRAR处理ZIP压缩文件时，由于对文件名和文件夹名处理不当导致。攻击者可以构造一个包含恶意脚本的ZIP压缩文件，该压缩文件包含一个正常的诱饵文件（如PDF、PNG或JPG）和一个同名的文件夹，当用户尝试打开诱饵文件时，WinRAR会错误地执行该文件夹中的恶意脚本。

**有效性：**
根据漏洞信息、搜索引擎结果和漏洞利用代码，该POC代码有效。漏洞库信息表明该漏洞已被野外利用。搜索引擎结果中也包含了大量关于此漏洞的分析和利用报告，证实了该漏洞的有效性。POC代码的描述和实现也符合漏洞的利用方式，通过生成包含恶意脚本和诱饵文件的RAR压缩包来触发漏洞。

**投毒风险：**
代码本身看起来比较直接，主要是生成利用漏洞的压缩包。`script.bat` 这个文件需要额外注意。当前提供的 `script.bat` 只是打开了计算器 `calc.exe` 和 Web_Security.pdf,相对来说是安全的，但用户在使用该漏洞时，完全可以修改此文件，添加更加恶意的payload，具有一定的风险。作者在代码中没有明显投毒行为，主要风险在于用户如何使用该工具生成payload。
投毒风险评估：10% (主要是用户修改 `script.bat` 的风险)

**利用方式：**
1.  **构造恶意ZIP/RAR压缩文件：** 利用提供的Python脚本（cve-2023-38831-exp-gen.py）生成恶意的ZIP/RAR压缩文件。此脚本需要一个诱饵文件（如PDF、PNG、JPG）和一个恶意脚本文件（如BAT、CMD、或可执行文件）。该脚本会创建一个包含诱饵文件和一个同名文件夹的压缩包，并将恶意脚本放置在该文件夹中。
2.  **诱骗用户打开压缩文件：**  将生成的恶意ZIP/RAR压缩文件发送给目标用户。
3.  **执行恶意代码：** 当用户使用受影响的WinRAR版本打开压缩文件并尝试查看诱饵文件时，WinRAR会错误地执行同名文件夹中的恶意脚本，从而实现远程代码执行。

 总体来说，该漏洞利用方式较为简单，攻击成本较低，风险较高。

**项目地址:** [s4m98/winrar-cve-2023-38831-poc-gen](https://github.com/s4m98/winrar-cve-2023-38831-poc-gen)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #25

**来源**: [CVE-2023-38831-solomon12354_VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC.md](../2023/CVE-2023-38831-solomon12354_VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要解压恶意的ZIP/RAR压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 存在于 WinRAR 6.23 之前版本中。攻击者可以构造一个包含良性文件和同名文件夹的 ZIP 压缩包，当用户尝试访问良性文件时，WinRAR 会错误地执行同名文件夹中的恶意代码。提供的 `exploit.py` 脚本可以用于生成包含漏洞利用的RAR压缩文件。脚本首先要求输入良性文件（`bait_file`）、恶意脚本文件（`script_file`）和输出RAR文件名称。然后，它创建一个临时目录，将恶意脚本复制到与良性文件同名的目录中，并将良性文件复制到临时目录中。最后，使用 `shutil.make_archive` 函数将临时目录压缩成 ZIP 文件，并修改 ZIP 文件的内容，将目录名中的 'A' 和 'B' 替换为空格，从而绕过 WinRAR 的安全检查。最终，将修改后的 ZIP 文件重命名为 RAR 文件。

`squid.bat` 用于下载并执行 `volleysquid.exe`。`volleyballsquid.py` 尝试利用 BypassUAC 来提升权限并将程序设置为开机自启。

**有效性:** 根据漏洞信息和利用代码分析，提供的 POC 代码有效，可以利用此漏洞在受害者机器上执行任意代码。

**投毒风险:** 仓库中存在一定的投毒风险，虽然主要功能是利用CVE-2023-38831漏洞，但是 `volleyballsquid.py`和`squid.bat`文件中的行为具有恶意性，特别是`volleyballsquid.py`中尝试使用`BypassUAC`绕过用户账户控制并持久化安装，这可能被用于安装后门或恶意软件。虽然主要目的是展示漏洞，但客观上存在后门功能，因此投毒风险占比为10%。

**利用方式:** 攻击者首先利用 `exploit.py` 脚本生成包含恶意代码的RAR压缩文件。然后，诱骗用户下载并使用 WinRAR 解压此文件。当用户尝试打开压缩包中的“良性”文件时，实际上会执行隐藏在同名目录中的恶意脚本 (例如 `squid.bat`)，下载并执行恶意程序。

根据搜索结果，CVE-2023-38831 漏洞已被广泛利用，并且已被政府背景的攻击者使用，这进一步验证了漏洞的严重性和 POC 代码的有效性。

**项目地址:** [solomon12354/VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC](https://github.com/solomon12354/VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #26

**来源**: [CVE-2023-38831-technicalcorp0_CVE-2023-38831-Exploit.md](../2023/CVE-2023-38831-technicalcorp0_CVE-2023-38831-Exploit.md)

## CVE-2023-38831-WinRAR-任意代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 任意代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个漏洞，该漏洞允许攻击者通过特制的ZIP档案执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** 当WinRAR尝试访问ZIP归档中的良性文件时，如果存在与该良性文件同名的文件夹，WinRAR会处理该文件夹的内容（可能包含可执行内容）。
2.  **利用方式：**
    *   攻击者创建一个恶意的ZIP档案，该档案包含一个良性文件（例如.JPG文件）和一个与该良性文件同名的文件夹。
    *   该文件夹包含恶意可执行文件。
    *   当受害者尝试在WinRAR中查看良性文件时，WinRAR会执行该文件夹中的恶意代码。
3.  **POC有效性：** 提供的POC代码 (CVE-2023-38831-WinRar-Exploit.py) 的目的是生成包含利用此漏洞的恶意 ZIP 文件。根据代码逻辑和漏洞原理，该 POC 可以有效利用该漏洞。
4.  **投毒风险：** 经过对POC代码的分析，发现代码本身实现了漏洞利用过程，但同时也存在一定的投毒风险。`clean_up()`函数会删除临时文件，但不能保证完全清除所有痕迹。攻击者可能通过修改代码，在生成恶意 ZIP 文件后，在目标系统上留下后门或执行其他恶意操作。考虑到实际利用场景中可能存在的恶意修改，投毒风险估计为5%。 主要风险点在于，虽然POC主要目的是生成exploit，但如果恶意人员修改，完全可以添加其他恶意payload，并伪装成CVE-2023-38831的POC进行传播。
5. **搜索引擎结果:** 搜索引擎结果表明此漏洞已被广泛利用，包括政府背景的黑客组织。 多个安全厂商发布了相关的分析和防御措施。

**项目地址:** [technicalcorp0/CVE-2023-38831-Exploit](https://github.com/technicalcorp0/CVE-2023-38831-Exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #27

**来源**: [CVE-2023-38831-xk-mt_WinRAR-Vulnerability-recurrence-tutorial.md](../2023/CVE-2023-38831-xk-mt_WinRAR-Vulnerability-recurrence-tutorial.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。该漏洞允许攻击者通过构造恶意的ZIP压缩包，在用户尝试查看压缩包内的文件时执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，该漏洞已被广泛利用，POC代码的存在也表明其有效性。多个安全厂商和研究人员都对此漏洞进行了分析并提供了相应的缓解措施。

**投毒风险分析：**
提供的POC代码包含以下文件：
*   `README.md`: 漏洞复现教程，包含漏洞信息和参考链接。
*   `执行命令.bat`: 一个简单的批处理文件，用于执行`calc.exe`（计算器程序），用于演示代码执行。
*   `文本.txt`: 包含一个URL地址。
*   `生成压缩包.py`: 一个Python脚本，用于生成包含漏洞的ZIP压缩包。

该脚本的主要功能是：
1.  创建临时目录，并将`执行命令.bat`复制到该目录。
2.  复制`文本.txt`文件到另一个目录。
3.  将上述两个目录打包成ZIP文件。
4.  修改ZIP文件中的文件名，利用漏洞的原理。
从代码本身来看，该脚本并没有明显的恶意代码，但是存在一定的投毒风险。
*   执行命令.bat： 虽然只是简单的calc.exe，但如果攻击者替换成其他恶意命令，则可能造成更大的危害。
*   脚本的依赖： 该脚本依赖Python环境，攻击者可能会通过修改脚本，引入恶意的Python依赖包，从而实现投毒。

综合来看，该仓库中存在一定的投毒风险，但不高。主要是因为演示的`执行命令.bat`内容比较简单，容易被识别。如果使用者直接运行此仓库的代码，有可能会被植入恶意程序。因此，投毒风险评定为10%。

**利用方式：**
1.  攻击者构造一个恶意的ZIP压缩包，该压缩包包含一个良性文件（例如，图片文件`文本.txt`）和一个与该文件同名的文件夹。
2.  该文件夹包含一个恶意可执行文件（例如，`执行命令.bat`并更名为`文本.txtA.cmd`）。
3.  当用户使用受影响的WinRAR版本打开该ZIP压缩包，并尝试查看良性文件时，WinRAR会错误地执行该文件夹中的恶意可执行文件，从而导致任意代码执行。

**项目地址:** [xk-mt/WinRAR-Vulnerability-recurrence-tutorial](https://github.com/xk-mt/WinRAR-Vulnerability-recurrence-tutorial)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #28

**来源**: [CVE-2023-38831-yezzfusl_cve_2023_38831_scanner.md](../2023/CVE-2023-38831-yezzfusl_cve_2023_38831_scanner.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开恶意的 ZIP 压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以通过构造一个特殊的 ZIP 压缩文件来利用此漏洞。该 ZIP 文件包含一个良性文件（例如 JPG）和一个同名的文件夹。当用户尝试访问良性文件时，WinRAR 会错误地执行文件夹中的恶意代码，导致远程代码执行。

**利用方式：**
1.  攻击者创建一个包含良性文件和同名文件夹的恶意 ZIP 文件。
2.  文件夹中包含要执行的恶意代码（例如，可执行文件）。
3.  攻击者诱使用户使用 WinRAR 打开该 ZIP 文件。
4.  当用户尝试访问良性文件时，WinRAR 会执行文件夹中的恶意代码。

**有效性：**
根据漏洞描述和搜索结果，该漏洞已在野外被利用，因此提供的PoC代码如果能够重现该行为，则可以认为是有效的。

**投毒风险：**
提供的代码仓库 `cve_2023_38831_scanner` 本身是一个漏洞扫描器，而非漏洞利用的PoC。尽管如此，仍然存在一定的投毒风险。代码中可能隐藏后门，虽然其主要功能是扫描，但理论上存在被篡改的风险。代码中使用了网络数据包分析、进程内存扫描、沙箱环境执行等模块，这些模块如果被恶意修改，可能被用于执行恶意操作。因此，综合考虑其扫描器的性质和潜在风险，投毒风险估计为10%。这个风险主要来自供应链投毒，如果下载了被篡改过的扫描器，那么扫描器本身可能成为攻击的一部分。

**项目地址:** [yezzfusl/cve_2023_38831_scanner](https://github.com/yezzfusl/cve_2023_38831_scanner)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #29

**来源**: [CVE-2023-38831-youmulijiang_evil-winrar.md](../2023/CVE-2023-38831-youmulijiang_evil-winrar.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 50%

## 详情

CVE-2023-38831是WinRAR在6.23版本之前存在的一个远程代码执行漏洞。该漏洞的利用方式是构造一个特殊的ZIP压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹。当用户尝试在WinRAR中查看该良性文件时，WinRAR会错误地执行该文件夹中的恶意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认该漏洞是有效的，并且已经在野外被利用。漏洞利用代码提供了一个框架，用于生成包含恶意payload的ZIP压缩包，从而实现远程代码执行。

**投毒风险分析：**
提供的代码是一个框架，用于生成漏洞利用的 ZIP 文件，包含生成 exp，邮件发送，下载链接生成等功能。代码中存在潜在的投毒风险，主要体现在以下几个方面：

1.  **Payload 植入:**  该框架可以自定义payload，如果用户在不了解 payload 内容的情况下使用，可能运行恶意指令。
2.  **代码可信度:** 虽然作者声明为安全开发成员，并开源了代码，但代码的安全性仍然需要进一步审计。存在作者预留后门的可能性。 考虑到这是一个漏洞利用框架，其本质就是为了执行恶意代码，所以判定为投毒代码的风险为50%。

**漏洞利用方式：**

1.  攻击者使用该漏洞利用框架(evil-winrar)生成一个恶意的 ZIP 压缩包。
2.  该 ZIP 压缩包包含一个良性文件（如JPG图片）和一个同名的文件夹，文件夹中包含恶意可执行文件。
3.  攻击者通过社会工程学等方式诱骗用户使用存在漏洞的 WinRAR 版本打开该 ZIP 压缩包。
4.  用户尝试查看良性文件时，WinRAR 会错误地执行同名文件夹中的恶意代码。
5.  恶意代码在用户系统上执行，攻击者从而实现远程代码执行，控制受害者的计算机。

**项目地址:** [youmulijiang/evil-winrar](https://github.com/youmulijiang/evil-winrar)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---



---

## POC #3

**来源**: [CVE-2023-38831-MaorBuskila_Windows-X64-RAT.md](../2023/CVE-2023-38831-MaorBuskila_Windows-X64-RAT.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者在用户尝试查看 ZIP 压缩包中的良性文件时执行任意代码。该漏洞源于 WinRAR 处理 ZIP 压缩包时，允许压缩包包含一个良性文件（例如 .JPG）和一个同名文件夹。当用户尝试访问该良性文件时，WinRAR 实际上会处理同名文件夹中的内容，从而允许攻击者在文件夹中放置恶意可执行文件并执行。

**有效性：**
从搜索结果和漏洞库信息来看，该漏洞已经被广泛利用，PoC 代码的存在也进一步验证了其有效性。

**投毒风险：**
提供的 Python 脚本 (`51721.py`) 用于生成 Windows x64 平台的反向 TCP Shellcode。该脚本本身不包含明显的恶意代码，功能是生成 shellcode。需要用户自行配置 IP 地址和端口。但是，由于该代码需要用户执行，并且可以生成任意 shellcode，存在一定投毒风险，例如，如果攻击者提供修改后的脚本，生成包含恶意功能的 shellcode (如删除文件，上传用户信息)，则用户可能无意中执行该恶意 shellcode. 脚本本身不包含网络连接或者其他与远程服务器通信的行为，可以基本判断代码仓库投毒风险较低.

**利用方式：**
1.  攻击者创建一个恶意的 ZIP 压缩包。
2.  该 ZIP 压缩包包含一个良性文件（例如 image.jpg）和一个同名文件夹（image.jpg）。
3.  同名文件夹包含恶意可执行文件，例如 exploit.exe，并可能包含一个 `.lnk` 文件，该快捷方式指向该恶意可执行文件。
4.  攻击者诱骗用户使用受影响版本的 WinRAR 打开该 ZIP 压缩包并尝试查看良性文件。
5.  WinRAR 错误地执行同名文件夹中的恶意可执行文件，从而导致远程代码执行。

**项目地址:** [MaorBuskila/Windows-X64-RAT](https://github.com/MaorBuskila/Windows-X64-RAT)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #4

**来源**: [CVE-2023-38831-MyStuffYT_CVE-2023-38831-POC.md](../2023/CVE-2023-38831-MyStuffYT_CVE-2023-38831-POC.md)

## CVE-2023-38831-WinRAR-远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的恶意ZIP压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个恶意的ZIP压缩文件，其中包含一个良性文件（例如.jpg）和一个同名的文件夹。当用户尝试在 WinRAR 中查看该良性文件时，WinRAR 会错误地执行该文件夹中的内容，从而导致任意代码执行。

**有效性：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。搜索引擎结果表明该漏洞已被广泛利用，POC代码的存在进一步证实了其有效性。

**投毒风险：**

根据对POC代码的分析，存在一定的投毒风险。`script.bat`脚本从github下载`Alert.exe`文件，这本身就存在一定的安全隐患，无法确保下载的文件一定是安全的。此外，脚本同时执行 `alert.exe` 和 `gtaleak.mp4`，而 `gtaleak.mp4` 在 README 中说明是 “zeros without ones”, 可以确定这是一个障眼法，实际的恶意行为是由 `alert.exe` 执行。 因此，作者可能隐藏了投毒代码。

**利用方式：**

1.  攻击者创建一个恶意的ZIP压缩文件，其中包含一个良性文件 (例如 `gtaleak.mp4`) 和一个同名的文件夹。
2.  该文件夹包含一个批处理脚本 (`script.bat`)，该脚本将从远程服务器下载并执行恶意程序 (`Alert.exe`)。
3.  当用户尝试使用 WinRAR 打开压缩文件并查看良性文件 (`gtaleak.mp4`) 时，WinRAR 会错误地执行批处理脚本。
4.  批处理脚本下载并执行恶意程序，从而允许攻击者在受害者的系统上执行任意代码。

**项目地址:** [MyStuffYT/CVE-2023-38831-POC](https://github.com/MyStuffYT/CVE-2023-38831-POC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #5

**来源**: [CVE-2023-38831-Nielk74_CVE-2023-38831.md](../2023/CVE-2023-38831-Nielk74_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本的代码执行漏洞。该漏洞允许攻击者在用户尝试查看ZIP存档中的看似无害的文件时执行任意代码。攻击者通过构造一个包含同名文件和文件夹的恶意ZIP文件，利用WinRAR处理文件路径时的逻辑缺陷，使得文件夹中的恶意可执行文件得以运行。提供的POC代码通过Vagrant自动化部署了一个易受攻击的WinRAR 6.22环境，并向虚拟机桌面添加了一个恶意的rar文件。该rar文件被设计为当用户点击其中的“无害”文件时，执行预先设定的恶意代码。尽管POC的主要目的是演示漏洞，但其中`ChocolateyInstall.ps1`脚本从外部源下载并安装软件包（Chocolatey和WinRAR），存在被篡改从而引入恶意代码的风险，这构成了潜在的投毒风险。虽然这个脚本很常见，但还是存在一定的风险，因此这里给出了10%的投毒风险。

**漏洞利用方式：**

1.  攻击者创建一个恶意的ZIP压缩包，其中包含一个看似无害的文件（例如.jpg），以及一个与该文件同名的文件夹。
2.  该文件夹包含恶意可执行文件，例如.exe或.cmd脚本。
3.  当用户尝试使用WinRAR打开ZIP压缩包并查看“无害”文件时，WinRAR会错误地执行同名文件夹中的恶意可执行文件，从而导致任意代码执行。
4.  攻击者可以利用此漏洞在受害者系统上安装恶意软件、窃取敏感数据或执行其他恶意操作。

**项目地址:** [Nielk74/CVE-2023-38831](https://github.com/Nielk74/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #6

**来源**: [CVE-2023-38831-RomainBayle08_CVE-2023-38831.md](../2023/CVE-2023-38831-RomainBayle08_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP或RAR压缩文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个特殊的 ZIP 压缩文件，该文件包含一个看似无害的文件（例如，.JPG 文件）和一个与该文件同名的文件夹。当用户尝试查看压缩文件中的无害文件时，WinRAR 会错误地执行文件夹中的内容，从而导致任意代码执行。

**有效性分析：**
提供的 POC 代码 `cve-2023-38831-exp-gen.py` 是一个漏洞利用生成器脚本，它接受诱饵文件 (`BAIT_NAME`)、脚本文件 (`SCRIPT_NAME`) 和额外的诱饵文件目录 (`BAIT_FILES`) 作为输入，并生成一个恶意 RAR 压缩文件 (`OUTPUT_NAME`)。脚本首先创建一个包含诱饵文件和脚本文件的临时目录结构，然后使用 `shutil.make_archive` 函数将该目录压缩为 ZIP 文件。关键在于，脚本会替换 ZIP 文件中特定文件的扩展名，利用 WinRAR 的漏洞，在用户尝试打开诱饵文件时执行脚本文件。`script.bat` 脚本会首先尝试打开诱饵文件（模拟用户行为），然后执行 `calc.exe`（作为漏洞利用成功的标志）。该 POC 的有效性较高，因为它模拟了真实的攻击场景。

**投毒风险分析：**
`cve-2023-38831-exp-gen.py` 脚本本身不包含明显的恶意代码或后门。但是，存在一定的投毒风险，因为该脚本允许攻击者指定要执行的任意脚本 (`SCRIPT_NAME`)。攻击者可以替换 `script.bat` 文件为包含恶意代码的文件，例如下载和执行其他恶意软件。此外，该脚本使用了`BAIT_FILES`参数，如果提供包含恶意文件的目录，也会构成投毒风险。所以存在一定投毒风险，但主要取决于用户提供的脚本和目录的内容。

**利用方式分析：**
1.  攻击者构造一个恶意 ZIP 压缩文件，其中包含一个诱饵文件（如 `CLASSIFIED_DOCUMENTS.pdf`）和一个与诱饵文件同名的文件夹。文件夹中包含一个脚本文件（如 `script.bat`）。
2.  攻击者将恶意 ZIP 文件发送给受害者，诱骗其使用 WinRAR 打开。
3.  当受害者尝试查看 ZIP 文件中的诱饵文件时，WinRAR 会错误地执行同名文件夹中的脚本文件。
4.  脚本文件执行任意代码，例如安装恶意软件或窃取敏感信息。

总的来说，该漏洞利用方式简单有效，风险较高。用户应尽快升级到 WinRAR 6.23 或更高版本。

**项目地址:** [RomainBayle08/CVE-2023-38831](https://github.com/RomainBayle08/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #7

**来源**: [CVE-2023-38831-RonF98_CVE-2023-38831-POC.md](../2023/CVE-2023-38831-RonF98_CVE-2023-38831-POC.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致任意代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831 是 WinRAR 在处理 ZIP 压缩文件时存在的一个漏洞。攻击者可以构造一个包含良性文件（例如 .jpg 文件）和一个同名文件夹的 ZIP 压缩包。该文件夹中包含恶意代码（例如 .cmd 文件）。当用户尝试查看良性文件时，WinRAR 会错误地执行文件夹中的恶意代码，从而导致远程代码执行。

**有效性：**

提供的 POC 代码有效，它演示了如何创建一个恶意的 RAR 文件来利用此漏洞。

*   `DoS.cmd` 文件包含恶意代码，用于创建多个消息框，模拟拒绝服务攻击。
*   `exploit.py` 脚本用于生成包含恶意 `DoS.cmd` 文件的 RAR 文件，并利用漏洞触发代码执行。
*   `README.md` 详细解释了漏洞原理和利用方法，并提供了攻击成功的截图。

**投毒风险：**

此仓库中可能存在轻微的投毒风险，约为5%。

*   `DoS.cmd` 只是一个简单的拒绝服务攻击示例，但攻击者可能会将其替换为更具破坏性的恶意代码，例如勒索软件或信息窃取程序。如果下载者不仔细检查 `DoS.cmd` 的内容，可能会在不知情的情况下运行恶意代码。
*   `exploit.py` 脚本本身没有明显的恶意代码，但它可以被修改以生成包含不同恶意代码的 RAR 文件。下载者应该仔细审查脚本的内容，确保它不会被用于传播恶意软件。

**利用方式：**

1.  攻击者创建一个包含良性文件（例如 `image.jpg`）和一个同名文件夹（例如 `image.jpg `）的 ZIP 压缩包。注意文件夹名称后面有一个空格。
2.  在同名文件夹中，攻击者放置恶意代码（例如 `image.jpg .cmd`）。
3.  攻击者将 ZIP 文件转换为 RAR 文件（POC 脚本完成了此过程）。
4.  攻击者诱骗用户使用受影响的 WinRAR 版本打开 RAR 文件并尝试查看良性文件（`image.jpg`）。
5.  WinRAR 错误地执行同名文件夹中的恶意代码 (`image.jpg .cmd`)，从而导致远程代码执行。

由于该漏洞被广泛利用，并且网上存在大量相关的 POC 代码，因此攻击者很容易发起攻击。


**项目地址:** [RonF98/CVE-2023-38831-POC](https://github.com/RonF98/CVE-2023-38831-POC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #8

**来源**: [CVE-2023-38831-SpamixOfficial_CVE-2023-38831.md](../2023/CVE-2023-38831-SpamixOfficial_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前的版本中的代码执行漏洞。攻击者可以制作一个特制的ZIP压缩包，其中包含一个良性文件和一个同名文件夹，文件夹中包含恶意可执行文件。当用户尝试在WinRAR中查看良性文件时，实际上会执行文件夹中的恶意代码。\n\n**有效性：**根据漏洞库信息、搜索结果和漏洞利用代码，该漏洞POC是有效的。漏洞库信息中明确指出该漏洞已在野外被利用。搜索结果中多个链接都指向了关于该漏洞的分析和利用报告。提供的`Cargo.lock`文件很可能只是rust项目依赖管理文件，无法直接证明POC的有效性，需配合rust源码进行分析。\n\n**投毒风险：**分析提供的`Cargo.lock`文件，该文件列出了Rust项目`CVE-2023-38831`的依赖项。虽然`Cargo.lock`本身不包含可执行代码，但是，如果恶意作者修改了依赖项的版本或来源，理论上存在引入被篡改过的crate（Rust包）的风险。不过，由于`Cargo.lock`文件明确指定了每个依赖项的checksum，Cargo在构建项目时会验证下载的crate是否与checksum匹配，从而降低了被投毒的风险。评估投毒风险为10%。\n\n**利用方式：**攻击者创建一个包含以下结构的ZIP压缩包：\n\n1.  一个良性的文件，例如 `image.jpg`\n2.  一个与良性文件同名的文件夹，例如 `image.jpg`\n3.  在同名文件夹中，放置恶意可执行文件，例如 `image.jpg.exe` 或 `image.jpg `(通过空格进行欺骗)。\n\n当用户使用存在漏洞的WinRAR版本打开该ZIP文件并尝试查看`image.jpg`时，WinRAR会错误地执行`image.jpg`文件夹中的恶意程序，从而实现远程代码执行。

**项目地址:** [SpamixOfficial/CVE-2023-38831](https://github.com/SpamixOfficial/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #9

**来源**: [CVE-2023-38831-Tolu12wani_Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution.md](../2023/CVE-2023-38831-Tolu12wani_Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在用户尝试查看 ZIP 压缩包中的文件时执行任意代码。

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开特制的 ZIP 压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者通过构造恶意的 ZIP 压缩包实现远程代码执行。该压缩包包含一个良性文件（例如 JPG）和一个与良性文件同名的文件夹。当用户尝试访问良性文件时，WinRAR 会错误地执行同名文件夹中的内容，从而执行攻击者放置的恶意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被广泛利用。 提供的POC代码描述的是在压缩文件中嵌入恶意payload，并触发反向shell的实验环境验证过程。虽然该代码本身没有包含恶意代码，但描述了如何构建利用该漏洞的压缩文件。

**投毒风险：**
提供的 POC 代码仓库中只包含 PDF 报告和截图，并没有可执行的恶意代码。 但是,README中说明了该仓库展示了恶意payload的嵌入方式，存在一定的潜在风险。 因此，存在一定的投毒风险，但风险较低。根据readme描述和文件结构，投毒风险评估为10%，

**利用方式：**
1.  **创建恶意 ZIP 压缩包：** 攻击者创建一个 ZIP 压缩包，其中包含一个良性文件（例如 JPG）和一个与良性文件同名的文件夹。
2.  **放置恶意代码：** 将恶意可执行文件放置在与良性文件同名的文件夹中。
3.  **诱骗用户：** 诱骗用户使用受影响的 WinRAR 版本打开该 ZIP 压缩包并尝试查看良性文件。
4.  **执行恶意代码：** WinRAR 错误地执行同名文件夹中的恶意代码，从而实现远程代码执行。

根据搜索结果，该漏洞已经被政府支持的攻击者利用，用于投放 RAT（远程访问木马）等恶意软件。

**项目地址:** [Tolu12wani/Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution](https://github.com/Tolu12wani/Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #10

**来源**: [CVE-2023-38831-VictoriousKnight_CVE-2023-38831_Exploit.md](../2023/CVE-2023-38831-VictoriousKnight_CVE-2023-38831_Exploit.md)

## CVE-2023-38831-WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码。

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的恶意ZIP文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个漏洞，它允许攻击者通过构造特殊的ZIP文件来执行任意代码。攻击者创建一个ZIP文件，其中包含一个良性文件（例如，JPG图片）和一个与该良性文件同名的文件夹。该文件夹中包含恶意可执行文件。当用户尝试在WinRAR中查看该良性文件时，WinRAR会错误地执行该文件夹中的恶意代码，从而导致远程代码执行。

**有效性：** 提供的POC代码是有效的。根据漏洞库信息和搜索结果，该漏洞在野外被广泛利用。POC代码通过创建包含良性文件和同名文件夹的恶意ZIP文件，并利用WinRAR处理文件时的缺陷来执行代码。POC代码结构清晰，易于理解和使用。

**投毒风险：** 提供的POC代码本身主要是利用漏洞生成EXP，但仔细检查代码，在`exploit.py`文件的zip文件内容操作部分被截断，没有展示修改zip文件内容的关键代码，作者可能在`Read and manipulate the zip file content`部分添加恶意代码，执行修改zip文件过程中的任何恶意行为。因此存在一定的投毒风险，根据代码完整度，我给出10%的投毒风险。

**利用方式：**
1.  攻击者创建一个恶意ZIP文件，其中包含一个看似无害的文件（例如，一个图片或PDF）。
2.  在ZIP文件中，攻击者同时创建一个与该无害文件同名的文件夹。
3.  该文件夹包含攻击者想要执行的恶意代码，通常是一个可执行文件或脚本。
4.  攻击者诱使用户使用存在漏洞的WinRAR版本打开该ZIP文件。
5.  当用户尝试访问ZIP文件中的“无害”文件时，WinRAR会错误地执行同名文件夹中的恶意代码。

**项目地址:** [VictoriousKnight/CVE-2023-38831_Exploit](https://github.com/VictoriousKnight/CVE-2023-38831_Exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #11

**来源**: [CVE-2023-38831-anelya0333_Exploiting-CVE-2023-38831.md](../2023/CVE-2023-38831-anelya0333_Exploiting-CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开特制的ZIP压缩文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞允许攻击者通过特制的ZIP压缩文件在目标系统上执行任意代码。该漏洞的根源在于WinRAR在处理包含与文件同名文件夹的ZIP文件时存在缺陷。攻击者可以构造一个 ZIP 文件，其中包含一个良性文件（例如.JPG）和一个与其同名的文件夹。当用户尝试在 WinRAR 中查看该良性文件时，WinRAR 会错误地执行该文件夹中的恶意代码。此PoC脚本生成一个ZIP文件，其中包含诱饵文件(bait file)和恶意脚本(script file)，并修改ZIP文件的文件头，以利用此漏洞。脚本创建与诱饵文件同名的文件夹，并将恶意脚本放入其中。然后，将诱饵文件的副本也放入ZIP文件中。通过替换文件名字段中的某些字符，WinRAR会将文件夹中的恶意文件误认为是要执行的文件，最终导致代码执行。由于代码仅仅是构造payload，不存在主动执行恶意代码，因此不存在投毒风险。

**项目地址:** [anelya0333/Exploiting-CVE-2023-38831](https://github.com/anelya0333/Exploiting-CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #12

**来源**: [CVE-2023-38831-b1tg_CVE-2023-38831-winrar-exploit.md](../2023/CVE-2023-38831-b1tg_CVE-2023-38831-winrar-exploit.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可导致完全系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开恶意构造的ZIP文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 允许攻击者通过特制的ZIP文件在受害者系统上执行任意代码。该漏洞源于 WinRAR 处理包含同名文件和文件夹的 ZIP 档案时的不当行为。攻击者可以创建一个 ZIP 文件，其中包含一个良性文件（例如 CLASSIFIED_DOCUMENTS.pdf）和一个同名文件夹（例如 CLASSIFIED_DOCUMENTS.pdf）。当用户尝试访问良性文件时，WinRAR 实际上会执行该文件夹中的内容（例如 script.bat）。

**有效性:**

提供的 POC 代码 `cve-2023-38831-exp-gen.py` 旨在生成利用此漏洞的恶意 RAR 档案。该脚本通过以下步骤工作：

1.  创建临时目录 `TEMPLATE`。
2.  在 `TEMPLATE` 中创建一个与bait文件同名的文件夹，并在其中存放包含恶意命令的script文件（例如 `script.bat`， 其中包含`calc.exe & CLASSIFIED_DOCUMENTS.pdf`）。
3.  将bait文件存放在`TEMPLATE`目录。
4.  将`TEMPLATE`目录压缩为zip文件。
5.  修改压缩包中文件和文件夹的名字，构造漏洞。
6.  最终输出 `CVE-2023-38831-poc.rar`。

该脚本能够有效地生成利用 CVE-2023-38831 的 RAR 文件，因此提供的 POC 代码是有效的。

**投毒风险:**

对提供的 POC 代码 (`cve-2023-38831-exp-gen.py` 和 `script.bat`) 进行分析后，未发现明显的恶意代码或后门。该脚本的功能明确且集中于生成利用 CVE-2023-38831 的 RAR 档案。 `script.bat` 的主要功能是启动计算器程序 (`calc.exe`) 并尝试打开诱饵文档 (`CLASSIFIED_DOCUMENTS.pdf`)，这是一个典型的 PoC 行为。 因此，该仓库中存在作者隐藏的投毒代码的风险极低。

**利用方式:**

1.  攻击者使用 `cve-2023-38831-exp-gen.py` 脚本，指定诱饵文件（例如 `CLASSIFIED_DOCUMENTS.pdf`）和恶意脚本（例如 `script.bat`），生成恶意 RAR 档案。
2.  攻击者通过各种方式（例如，电子邮件、恶意网站）将恶意 RAR 档案分发给受害者。
3.  受害者使用易受攻击的 WinRAR 版本（< 6.23）打开恶意 RAR 档案。
4.  当受害者尝试访问诱饵文件时，WinRAR 错误地执行了同名文件夹中的恶意脚本。
5.  恶意脚本在受害者系统上执行任意代码，例如启动计算器或安装恶意软件。

**项目地址:** [b1tg/CVE-2023-38831-winrar-exploit](https://github.com/b1tg/CVE-2023-38831-winrar-exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #13

**来源**: [CVE-2023-38831-elefantesagradodeluzinfinita_cve-2023-38831.md](../2023/CVE-2023-38831-elefantesagradodeluzinfinita_cve-2023-38831.md)

## CVE-2023-38831 - WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用 WinRAR 打开特制的 ZIP 压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者通过特制的 ZIP 压缩包在受害者系统上执行任意代码。漏洞利用方式是创建一个 ZIP 压缩包，其中包含一个良性文件（例如 .jpg 或 .pdf）以及一个同名的文件夹。该文件夹包含恶意的可执行文件（例如 .cmd 或 .exe）。当用户尝试打开良性文件时，WinRAR 会错误地执行文件夹中的恶意代码。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码分析，该漏洞确实存在并且已经被野外利用。提供的代码描述了一个利用工具 "DR. GANDALF"，它允许用户创建包含此漏洞的 ZIP 文件，表明POC的有效性。

**投毒风险：** 提供的 README.md 文件主要描述了漏洞原理和利用工具的使用方法。但是，由于此工具允许用户自定义注入的代码和二进制文件，因此存在投毒风险。如果用户下载了包含恶意注入代码的ZIP文件，那么这个工具本身可能被利用来传播恶意软件。评估投毒风险为 10%，因为该描述文件本身不包含可以直接执行的后门代码，但生成的ZIP文件可以包含。

**利用方式：**
1.  攻击者创建一个包含恶意 ZIP 压缩包。
2.  ZIP 压缩包中包含一个良性文件（例如，`image.jpg`）和一个同名的文件夹（例如，`image.jpg`）。
3.  `image.jpg` 文件夹包含恶意的可执行文件（例如，`evil.cmd`）。
4.  攻击者诱骗受害者使用存在漏洞的 WinRAR 版本打开该 ZIP 压缩包并尝试访问良性文件 `image.jpg`。
5.  WinRAR 在处理该 ZIP 文件时，会错误地执行 `image.jpg` 文件夹中的恶意代码 `evil.cmd`，从而导致远程代码执行。

**项目地址:** [elefantesagradodeluzinfinita/cve-2023-38831](https://github.com/elefantesagradodeluzinfinita/cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #14

**来源**: [CVE-2023-38831-h3xecute_SideCopy-Exploits-CVE-2023-38831.md](../2023/CVE-2023-38831-h3xecute_SideCopy-Exploits-CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个远程代码执行漏洞。该漏洞的利用方式是构造一个特殊的ZIP压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹。当用户尝试使用WinRAR打开该ZIP压缩包并访问良性文件时，WinRAR会错误地执行文件夹中的恶意代码。

**有效性：**
提供的POC代码描述了漏洞利用的原理，即构造包含同名良性文件和文件夹的ZIP压缩包。根据漏洞信息和搜索结果，此方法是有效的，并且在野外被利用。

**投毒风险：**
该POC本身描述了漏洞的利用方式，包含一个指向YouTube视频的链接，以及对恶意压缩包结构的描述。投毒风险较低，约为10%，因为：
1.  POC主要以描述性文字和图片链接为主。
2.  缺乏直接可执行的payload代码。
3.  作者可能通过YouTube链接传播恶意信息。

**利用方式：**
1.  攻击者创建一个恶意的ZIP压缩包。
2.  该压缩包包含一个良性文件（例如JPG，PDF等）和一个与该文件同名的文件夹。
3.  恶意代码（例如，可执行文件）放置在同名文件夹中。
4.  攻击者诱骗用户使用WinRAR打开这个ZIP压缩包，并尝试访问良性文件。
5.  WinRAR在处理压缩包时，会错误地执行同名文件夹中的恶意代码，从而导致远程代码执行。

**项目地址:** [h3xecute/SideCopy-Exploits-CVE-2023-38831](https://github.com/h3xecute/SideCopy-Exploits-CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #15

**来源**: [CVE-2023-38831-idkwastaken_CVE-2023-38831.md](../2023/CVE-2023-38831-idkwastaken_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意的ZIP文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的漏洞。该漏洞的利用方式是创建一个特制的ZIP文件，其中包含一个良性文件和一个同名文件夹。当用户尝试使用WinRAR打开ZIP文件并访问该良性文件时，WinRAR会错误地执行该同名文件夹中的恶意代码，导致远程代码执行。

**有效性：**
提供的POC代码（exploit.c）利用了该漏洞。该代码生成一个ZIP文件，其中包含一个PDF文件（document.pdf）和一个名为“document.pdf\”的文件夹，该文件夹内包含一个恶意的批处理脚本（script.bat）。当用户在易受攻击的WinRAR版本中打开并尝试访问该PDF文件时，WinRAR将执行该批处理脚本。
checker.bat 是用来检测目标系统是否安装WinRAR，以及WinRAR的版本是否是受影响的版本。
exploit.ps1 看起来不完整，但是其作用应该是检查WinRAR版本。

**投毒风险：**
代码中存在一定的投毒风险，约为10%。原因如下：
*   **脚本内容可控：** exploit.c 中的script_content变量包含了要执行的命令，虽然当前POC仅仅是弹窗，但是攻击者可以修改这个变量，执行任意命令，例如下载恶意软件，执行系统命令等。
*   **复杂的构建过程：** exploit.c 代码本身比较复杂，阅读和分析需要一定的时间和精力。攻击者可以利用这一点，在代码中隐藏不易察觉的恶意代码。
虽然有潜在的投毒风险，但当前代码的主要目的是演示漏洞利用，风险较低，作者没有明显的隐藏后门行为，恶意代码比较容易被发现。

**利用方式：**
1.  攻击者创建一个恶意的ZIP压缩包，其中包含：
    *   一个良性的文件（例如 document.pdf）。
    *   一个与良性文件同名的文件夹（例如 document.pdf/）。
    *   恶意代码位于同名文件夹中（例如 document.pdf/script.bat）。
2.  攻击者诱骗目标用户使用存在漏洞的 WinRAR 版本打开此 ZIP 压缩包。
3.  当用户尝试打开良性文件时，WinRAR 错误地执行同名文件夹中的恶意代码，从而导致任意代码执行。


**项目地址:** [idkwastaken/CVE-2023-38831](https://github.com/idkwastaken/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #16

**来源**: [CVE-2023-38831-imbyter_imbyter-WinRAR_CVE-2023-38831.md](../2023/CVE-2023-38831-imbyter_imbyter-WinRAR_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 6.23

**利用条件:** 用户使用受影响的WinRAR版本打开特制的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于WinRAR 6.23之前的版本中。攻击者可以构造一个恶意的ZIP压缩包，其中包含一个伪装成良性文件的文件（例如 .jpg），以及一个同名的文件夹。当用户尝试在 WinRAR 中查看该“良性文件”时，实际上会执行同名文件夹中的恶意代码（例如 .cmd 或 .exe 文件）。

**有效性：**
根据漏洞信息和搜索结果，提供的POC代码是有效的。该POC利用了WinRAR处理ZIP压缩包时存在的逻辑漏洞，能够实现远程代码执行。

**投毒风险：**
提供的Python脚本 `make-poc.py` 用于生成POC压缩包，其本身的代码逻辑相对简单，主要功能是将指定的文件和脚本打包成特定的ZIP格式，并进行一些字符串替换以触发漏洞。主要风险在于脚本生成的POC包中包含的脚本，如果这个脚本是恶意的，那么整个利用过程就存在投毒风险。 仓库中的README.md文件里的测试脚本就是一个关闭计算机的脚本。代码本身存在一定的投毒风险.

*   脚本逻辑：脚本的功能是创建包含漏洞利用结构的RAR文件。
*   恶意操作：如果脚本被修改以包含下载和执行恶意软件的逻辑，那么用户在使用此脚本创建RAR文件时，就会受到投毒攻击。

**利用方式：**
1.  攻击者使用 `make-poc.py` 脚本构造恶意的ZIP压缩包，需要提供一个“良性”文件和一个恶意脚本。
2.  攻击者将恶意的ZIP压缩包发送给受害者。
3.  受害者使用受影响的WinRAR版本打开该ZIP压缩包，并尝试查看伪装的“良性”文件。
4.  WinRAR错误地执行了与“良性”文件同名的文件夹中的恶意脚本，导致远程代码执行。

**防御措施：**
*   升级WinRAR到6.23或更高版本。
*   谨慎打开来源不明的ZIP压缩包。
*   使用杀毒软件扫描ZIP压缩包。

**项目地址:** [imbyter/imbyter-WinRAR_CVE-2023-38831](https://github.com/imbyter/imbyter-WinRAR_CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #17

**来源**: [CVE-2023-38831-kehrijksen_CVE-2023-38831.md](../2023/CVE-2023-38831-kehrijksen_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 需要用户解压特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个恶意的 ZIP 压缩包，其中包含一个伪装成普通文件的文件和一个同名的文件夹。当用户尝试在 WinRAR 中查看该“普通文件”时，WinRAR 会错误地执行同名文件夹中的内容，从而导致任意代码执行。

**有效性：**
提供的 PoC 代码 `poc.py` 能够生成利用此漏洞的恶意 ZIP 压缩包。该脚本首先创建一个包含恶意 payload (例如 script.bat) 和良性文件 (例如 pepe.jpg) 的目录结构。然后，它将此目录结构压缩成 ZIP 文件，并修改 ZIP 文件中的文件名，以触发漏洞。`script.bat` 的作用是在 `%TEMP%` 目录下提取 ZIP 文件内容，运行良性文件作为诱饵，然后执行恶意操作，例如创建一个包含 “hacked” 内容的文本文件并使用记事本打开。

**投毒风险：**
分析提供的代码，没有发现明显的投毒代码。`poc.py` 的作用是生成恶意 ZIP 文件，而 `script.bat` 包含的是恶意行为的代码，例如运行良性文件，创建 `hacked.txt` 等。这些行为是漏洞利用的一部分，而不是隐藏的恶意代码。虽然利用 `script.bat` 可以执行任意操作，但这属于漏洞利用的范畴，而非代码投毒。

**利用方式：**
1.  攻击者使用 `poc.py` 脚本生成一个恶意的 ZIP 压缩包，其中包含一个良性文件（例如图片）和一个同名的文件夹。
2.  攻击者将此恶意 ZIP 压缩包发送给受害者。
3.  受害者使用 WinRAR (6.23 之前的版本) 打开并尝试查看 ZIP 压缩包中的良性文件。
4.  WinRAR 错误地执行与良性文件同名的文件夹中的内容 (由 `script.bat` 控制)。
5.  `script.bat` 首先将 ZIP 文件的内容解压到临时目录。
6.  `script.bat` 运行良性文件（例如图片）作为诱饵，以迷惑受害者。
7.  `script.bat` 执行任意恶意操作，例如创建文件，修改注册表，安装恶意软件等。


**项目地址:** [kehrijksen/CVE-2023-38831](https://github.com/kehrijksen/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #18

**来源**: [CVE-2023-38831-khanhtranngoccva_cve-2023-38831-poc.md](../2023/CVE-2023-38831-khanhtranngoccva_cve-2023-38831-poc.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。该漏洞源于WinRAR处理ZIP压缩包时，对文件名和文件夹名区分不当。攻击者可以创建一个ZIP压缩包，其中包含一个良性文件（例如JPG）和一个同名的文件夹。该文件夹中包含恶意可执行文件。当用户尝试在WinRAR中打开该良性文件时，WinRAR会错误地执行文件夹中的恶意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已在野外被利用，证明了其有效性。提供的POC代码片段（package-lock.json）显示使用了jszip库，表明该POC可能用于创建恶意的ZIP压缩包，进一步验证漏洞的可利用性。

**投毒风险：**
提供的POC代码片段是`package-lock.json`文件，主要描述了项目依赖。要判断是否存在投毒风险，需要检查实际的利用代码（例如 index.ts/index.js）。
*   这个`package-lock.json`文件本身不包含恶意代码，只是依赖声明。
*   **风险点在于开发者可能在其他代码文件中（如index.ts等，此文件未提供）包含恶意代码**。
*   jszip 库本身是一个常用的 ZIP 文件操作库，被投毒的可能性较低。
*   tsx和typescript是typescript相关工具，本身被投毒的可能性也比较低

由于缺乏实际的利用代码，无法确定是否存在投毒行为，只能根据现有信息进行推测，因此将投毒风险评估为10%。

**利用方式：**
1.  攻击者构造一个恶意的ZIP压缩包。
2.  该ZIP压缩包包含一个良性文件（例如JPG）和一个同名的文件夹。
3.  该文件夹中包含恶意可执行文件（例如EXE、BAT、CMD等）。
4.  攻击者诱骗用户使用受影响的WinRAR版本打开该ZIP压缩包。
5.  用户尝试在WinRAR中打开该良性文件。
6.  WinRAR错误地执行文件夹中的恶意代码，导致远程代码执行。

**项目地址:** [khanhtranngoccva/cve-2023-38831-poc](https://github.com/khanhtranngoccva/cve-2023-38831-poc)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #19

**来源**: [CVE-2023-38831-kuyrathdaro_winrar-cve-2023-38831.md](../2023/CVE-2023-38831-kuyrathdaro_winrar-cve-2023-38831.md)

## CVE-2023-38831-WinRAR代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个代码执行漏洞。该漏洞的利用方式如下：

1.  攻击者创建一个恶意的ZIP压缩包（伪装成RAR格式，后缀名为.rar）。
2.  该压缩包包含一个良性的文件（例如，document.pdf），以及一个与该良性文件同名的文件夹（例如，document.pdf）。
3.  同名文件夹中包含恶意payload（例如，一个.bat或.exe文件），命名为`document.pdfA.cmd`。
4.  用户使用存在漏洞的WinRAR版本打开该压缩包，并尝试打开良性文件（document.pdf）。
5.  由于WinRAR处理文件名的缺陷，实际上执行的是同名文件夹中的恶意payload。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以判断该漏洞PoC有效。搜索引擎结果中多个链接表明该漏洞已被广泛利用，并且Google的威胁分析小组也分析了利用该漏洞进行的攻击活动。提供的PoC代码实现了生成恶意RAR压缩包的逻辑，进一步验证了该漏洞的可利用性。

**投毒风险：**

PoC代码本身的主要功能是生成利用CVE-2023-38831漏洞的恶意压缩包。然而，我们仍然需要评估该代码是否存在潜在的投毒风险。以下是对代码的分析：

*   **代码功能明确：** PoC代码的功能是生成特定的文件结构和内容，以触发WinRAR漏洞。代码逻辑相对简单，易于理解。
*   **输入/输出控制：** PoC代码接受三个输入参数：良性文件、Payload文件和输出文件名。这三个参数都由用户指定，PoC本身没有主动下载或执行任何其他代码的功能。
*   **潜在风险点：** `exploit.py` 脚本使用 `shutil.copyfile` 函数来复制 payload 文件到临时目录，如果payload 文件本身就是恶意的，那么这也会造成风险。此外，尽管脚本尝试确保输出文件以 `.rar` 结尾，但恶意用户可能修改此行为。
*   **间接风险：** 如果攻击者修改了提供的 `exploit.py` 脚本，添加额外的恶意功能（例如，在生成恶意压缩包后，自动上传到恶意服务器），则可能存在投毒风险。但是，这并非原始PoC代码本身的问题。

综合来看，原始PoC代码本身存在直接投毒的风险较低，我估计的投毒风险概率为 **10%**。这主要是因为恶意 payload 本身会带来风险，但 PoC 代码并没有主动引入恶意行为。

**利用方式：**

1.  准备一个良性的文件（例如，document.pdf）和一个恶意payload（例如，script.bat或malware.exe）。
2.  运行PoC脚本，指定良性文件、payload文件和输出文件名。
3.  PoC脚本生成一个恶意的RAR压缩包（实际上是ZIP格式，但后缀名为.rar）。
4.  将该恶意RAR压缩包发送给目标用户。
5.  目标用户使用存在漏洞的WinRAR版本打开该压缩包，并尝试打开良性文件。
6.  WinRAR执行同名文件夹中的恶意payload，从而实现代码执行。


**项目地址:** [kuyrathdaro/winrar-cve-2023-38831](https://github.com/kuyrathdaro/winrar-cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #20

**来源**: [CVE-2023-38831-malvika-thakur_CVE-2023-38831.md](../2023/CVE-2023-38831-malvika-thakur_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以通过创建一个特制的 ZIP 压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹，文件夹中包含恶意可执行文件。当用户尝试在 WinRAR 中查看该良性文件时，由于 WinRAR 处理逻辑的缺陷，会错误地执行文件夹中的恶意代码，从而导致远程代码执行。

**有效性：**

提供的 POC 代码 `poc.py`  可以生成利用此漏洞的 ZIP 文件。代码首先检查恶意脚本和良性文件是否存在，然后创建一个目录，将脚本和良性文件复制到特定结构中，最后将该目录压缩成 ZIP 文件。用户只需双击压缩包内的良性文件即可触发漏洞，执行恶意脚本。因此，POC 代码有效。

**投毒风险：**

分析提供的 `poc.py` 代码，没有发现明显的投毒代码。该脚本的主要功能是生成利用 CVE-2023-38831 漏洞的恶意 ZIP 文件。它需要用户提供恶意脚本和良性文件，然后按照特定目录结构进行组织并压缩。代码中没有发现任何会执行额外恶意操作的逻辑。`README.md` 文件也仅包含漏洞描述和使用说明，没有发现恶意内容。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者创建一个包含良性文件（如 JPG 图片）和一个同名文件夹的 ZIP 压缩包。
2.  该文件夹中包含恶意可执行文件（如 BAT 脚本）。
3.  攻击者将该 ZIP 压缩包发送给目标用户。
4.  目标用户使用受影响的 WinRAR 版本打开该 ZIP 压缩包。
5.  目标用户双击 ZIP 压缩包中的良性文件。
6.  WinRAR 错误地执行同名文件夹中的恶意可执行文件，导致远程代码执行。

**项目地址:** [malvika-thakur/CVE-2023-38831](https://github.com/malvika-thakur/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #21

**来源**: [CVE-2023-38831-r1yaz_winDED.md](../2023/CVE-2023-38831-r1yaz_winDED.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开特制的恶意 ZIP 压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 是 WinRAR 在处理 ZIP 压缩文件时存在的远程代码执行漏洞。当 WinRAR 版本低于 6.23 时，如果用户尝试打开一个包含恶意构造的 ZIP 文件，攻击者可以利用此漏洞执行任意代码。该 ZIP 文件包含一个良性文件（例如 JPG 文件）和一个与其同名的文件夹。攻击者可以将可执行文件放置在该文件夹中，当用户尝试访问良性文件时，WinRAR 会错误地执行文件夹中的可执行文件。

**有效性：**
提供的 POC 代码（winDED）通过生成恶意 ZIP 文件来演示漏洞利用。它创建了一个良性文件和一个同名文件夹，并将恶意脚本放入文件夹中。用户双击压缩包中的 PDF 文件时，实际上会执行该恶意脚本，从而证明漏洞的可利用性。

**投毒风险：**
根据提供的 POC 代码，投毒风险较低。代码主要是为了演示漏洞而设计的，虽然存在执行恶意 `super_sneaky_evil_script.bat` 的可能性，但该脚本本身是由用户提供的，或者可以通过查看代码本身来确认其行为。 然而，仍然存在一些细微的风险，例如，如果 `super_sneaky_evil_script.bat` 本身是从其他来源下载的，则可能包含恶意代码。  总的来说, 投毒风险约 10%。

**利用方式：**
1.  创建一个包含良性文件 (例如，`BILLION_DOLLAR_SECRET.pdf`) 和一个同名文件夹 (`BILLION_DOLLAR_SECRET.pdf`) 的 ZIP 压缩文件。
2.  将恶意脚本 (例如，`super_sneaky_evil_script.bat`) 放入同名文件夹中。
3.  诱骗目标用户使用 WinRAR 打开该 ZIP 文件。
4.  当用户尝试打开良性文件时，WinRAR 错误地执行同名文件夹中的恶意脚本，从而实现远程代码执行。

**项目地址:** [r1yaz/winDED](https://github.com/r1yaz/winDED)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #22

**来源**: [CVE-2023-38831-ra3edAJ_LAB-DFIR-cve-2023-38831.md](../2023/CVE-2023-38831-ra3edAJ_LAB-DFIR-cve-2023-38831.md)

## CVE-2023-38831-WinRAR代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 是 WinRAR 在 6.23 版本之前存在的远程代码执行漏洞。该漏洞源于WinRAR处理ZIP压缩包时，如果压缩包中包含一个良性文件和一个与该良性文件同名的文件夹，WinRAR在尝试访问良性文件时，会错误地执行同名文件夹中的恶意内容。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的PoC是可用的。漏洞在野外被广泛利用，并且CISA已将其添加到已知被利用的漏洞目录中。

**投毒风险：**
提供的漏洞利用代码为一个Github仓库的README.md文件，主要描述了如何利用磁盘镜像调查CVE-2023-38831攻击，并通过Windows注册表、NTFS文件和浏览器缓存理解Windows事件序列。仓库本身目的是为了DFIR分析，因此直接包含恶意代码的可能性较低。但考虑到链接跳转至外部教程网站，存在间接投毒的可能，即教程内容可能包含引导至恶意软件下载或运行恶意脚本的指令。因此，投毒风险较低，评估为10%。

**利用方式：**
1.  **创建恶意的ZIP压缩包：** 压缩包中包含一个良性文件（如JPG图片）和一个与该良性文件同名的文件夹。
2.  **将恶意可执行文件放入同名文件夹：** 该文件夹中的可执行文件会在用户尝试打开良性文件时被执行。
3.  **诱导用户打开ZIP压缩包：** 通过社交工程或其他方式，诱导用户使用受影响版本的WinRAR打开该压缩包。
4.  **触发漏洞执行恶意代码：** 当用户尝试查看ZIP压缩包中的良性文件时，WinRAR会错误地执行同名文件夹中的恶意代码，从而实现远程代码执行。

**总结：**
该漏洞利用方式较为简单，易于传播，危害较大。用户应及时更新WinRAR至最新版本，避免打开来源不明的ZIP压缩包。

**项目地址:** [ra3edAJ/LAB-DFIR-cve-2023-38831](https://github.com/ra3edAJ/LAB-DFIR-cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #23

**来源**: [CVE-2023-38831-ruycr4ft_CVE-2023-38831.md](../2023/CVE-2023-38831-ruycr4ft_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的远程代码执行漏洞。该漏洞源于WinRAR在处理ZIP压缩包时，对文件名和文件夹名相同的情况处理不当。攻击者可以构造一个恶意的ZIP压缩包，其中包含一个看似无害的文件（例如.jpg），同时包含一个同名的文件夹。当用户尝试打开该“无害文件”时，WinRAR会错误地执行同名文件夹中的恶意代码。\n\n**有效性：** 根据漏洞信息、搜索结果以及提供的POC代码，该漏洞利用是有效的。多个来源都表明该漏洞已被广泛利用，POC代码也展示了如何生成包含恶意代码的RAR压缩文件。POC代码通过创建同名文件和文件夹，并在文件夹中放入恶意脚本，利用WinRAR的缺陷触发代码执行。\n\n**投毒风险：**  仓库的投毒风险较低，大概10%。
  *   `poc.py`: 该脚本的功能是生成利用 CVE-2023-38831 的恶意 RAR 文件。虽然它允许用户指定 bait 文件和脚本文件，但脚本本身不包含任何预设的、隐藏的恶意行为。
  *   `script.bat`:  这个批处理文件包含使用 `nc.exe` (netcat) 反弹 shell 的命令。**这里存在一定的投毒风险。** 批处理文件明确地使用了`192.168.0.107`这个IP地址,如果用户直接使用该IP反弹shell,将会连接到攻击者的服务器。虽然IP地址可以被用户更改，但在默认情况下，如果用户不修改，将会连接到攻击者的IP。这是主要的投毒点。
  *   README.md: 该文件仅包含漏洞的简单介绍和演示图片。没有发现恶意代码。

**利用方式：**\n1.  攻击者创建一个恶意的ZIP压缩包。该压缩包包含一个诱饵文件（例如图片.jpg）和一个与其同名的文件夹（例如图片.jpg）。\n2.  攻击者将恶意代码（例如一个批处理脚本或可执行文件）放入同名文件夹中。\n3.  攻击者将包含恶意代码的ZIP压缩包发送给受害者。\n4.  受害者使用存在漏洞的WinRAR版本打开该ZIP压缩包，并尝试打开诱饵文件。\n5.  WinRAR错误地执行同名文件夹中的恶意代码，导致远程代码执行。

**项目地址:** [ruycr4ft/CVE-2023-38831](https://github.com/ruycr4ft/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #24

**来源**: [CVE-2023-38831-s4m98_winrar-cve-2023-38831-poc-gen.md](../2023/CVE-2023-38831-s4m98_winrar-cve-2023-38831-poc-gen.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开恶意的ZIP/RAR压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于WinRAR处理ZIP压缩文件时，由于对文件名和文件夹名处理不当导致。攻击者可以构造一个包含恶意脚本的ZIP压缩文件，该压缩文件包含一个正常的诱饵文件（如PDF、PNG或JPG）和一个同名的文件夹，当用户尝试打开诱饵文件时，WinRAR会错误地执行该文件夹中的恶意脚本。

**有效性：**
根据漏洞信息、搜索引擎结果和漏洞利用代码，该POC代码有效。漏洞库信息表明该漏洞已被野外利用。搜索引擎结果中也包含了大量关于此漏洞的分析和利用报告，证实了该漏洞的有效性。POC代码的描述和实现也符合漏洞的利用方式，通过生成包含恶意脚本和诱饵文件的RAR压缩包来触发漏洞。

**投毒风险：**
代码本身看起来比较直接，主要是生成利用漏洞的压缩包。`script.bat` 这个文件需要额外注意。当前提供的 `script.bat` 只是打开了计算器 `calc.exe` 和 Web_Security.pdf,相对来说是安全的，但用户在使用该漏洞时，完全可以修改此文件，添加更加恶意的payload，具有一定的风险。作者在代码中没有明显投毒行为，主要风险在于用户如何使用该工具生成payload。
投毒风险评估：10% (主要是用户修改 `script.bat` 的风险)

**利用方式：**
1.  **构造恶意ZIP/RAR压缩文件：** 利用提供的Python脚本（cve-2023-38831-exp-gen.py）生成恶意的ZIP/RAR压缩文件。此脚本需要一个诱饵文件（如PDF、PNG、JPG）和一个恶意脚本文件（如BAT、CMD、或可执行文件）。该脚本会创建一个包含诱饵文件和一个同名文件夹的压缩包，并将恶意脚本放置在该文件夹中。
2.  **诱骗用户打开压缩文件：**  将生成的恶意ZIP/RAR压缩文件发送给目标用户。
3.  **执行恶意代码：** 当用户使用受影响的WinRAR版本打开压缩文件并尝试查看诱饵文件时，WinRAR会错误地执行同名文件夹中的恶意脚本，从而实现远程代码执行。

 总体来说，该漏洞利用方式较为简单，攻击成本较低，风险较高。

**项目地址:** [s4m98/winrar-cve-2023-38831-poc-gen](https://github.com/s4m98/winrar-cve-2023-38831-poc-gen)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #25

**来源**: [CVE-2023-38831-solomon12354_VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC.md](../2023/CVE-2023-38831-solomon12354_VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要解压恶意的ZIP/RAR压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 存在于 WinRAR 6.23 之前版本中。攻击者可以构造一个包含良性文件和同名文件夹的 ZIP 压缩包，当用户尝试访问良性文件时，WinRAR 会错误地执行同名文件夹中的恶意代码。提供的 `exploit.py` 脚本可以用于生成包含漏洞利用的RAR压缩文件。脚本首先要求输入良性文件（`bait_file`）、恶意脚本文件（`script_file`）和输出RAR文件名称。然后，它创建一个临时目录，将恶意脚本复制到与良性文件同名的目录中，并将良性文件复制到临时目录中。最后，使用 `shutil.make_archive` 函数将临时目录压缩成 ZIP 文件，并修改 ZIP 文件的内容，将目录名中的 'A' 和 'B' 替换为空格，从而绕过 WinRAR 的安全检查。最终，将修改后的 ZIP 文件重命名为 RAR 文件。

`squid.bat` 用于下载并执行 `volleysquid.exe`。`volleyballsquid.py` 尝试利用 BypassUAC 来提升权限并将程序设置为开机自启。

**有效性:** 根据漏洞信息和利用代码分析，提供的 POC 代码有效，可以利用此漏洞在受害者机器上执行任意代码。

**投毒风险:** 仓库中存在一定的投毒风险，虽然主要功能是利用CVE-2023-38831漏洞，但是 `volleyballsquid.py`和`squid.bat`文件中的行为具有恶意性，特别是`volleyballsquid.py`中尝试使用`BypassUAC`绕过用户账户控制并持久化安装，这可能被用于安装后门或恶意软件。虽然主要目的是展示漏洞，但客观上存在后门功能，因此投毒风险占比为10%。

**利用方式:** 攻击者首先利用 `exploit.py` 脚本生成包含恶意代码的RAR压缩文件。然后，诱骗用户下载并使用 WinRAR 解压此文件。当用户尝试打开压缩包中的“良性”文件时，实际上会执行隐藏在同名目录中的恶意脚本 (例如 `squid.bat`)，下载并执行恶意程序。

根据搜索结果，CVE-2023-38831 漏洞已被广泛利用，并且已被政府背景的攻击者使用，这进一步验证了漏洞的严重性和 POC 代码的有效性。

**项目地址:** [solomon12354/VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC](https://github.com/solomon12354/VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #26

**来源**: [CVE-2023-38831-technicalcorp0_CVE-2023-38831-Exploit.md](../2023/CVE-2023-38831-technicalcorp0_CVE-2023-38831-Exploit.md)

## CVE-2023-38831-WinRAR-任意代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 任意代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个漏洞，该漏洞允许攻击者通过特制的ZIP档案执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** 当WinRAR尝试访问ZIP归档中的良性文件时，如果存在与该良性文件同名的文件夹，WinRAR会处理该文件夹的内容（可能包含可执行内容）。
2.  **利用方式：**
    *   攻击者创建一个恶意的ZIP档案，该档案包含一个良性文件（例如.JPG文件）和一个与该良性文件同名的文件夹。
    *   该文件夹包含恶意可执行文件。
    *   当受害者尝试在WinRAR中查看良性文件时，WinRAR会执行该文件夹中的恶意代码。
3.  **POC有效性：** 提供的POC代码 (CVE-2023-38831-WinRar-Exploit.py) 的目的是生成包含利用此漏洞的恶意 ZIP 文件。根据代码逻辑和漏洞原理，该 POC 可以有效利用该漏洞。
4.  **投毒风险：** 经过对POC代码的分析，发现代码本身实现了漏洞利用过程，但同时也存在一定的投毒风险。`clean_up()`函数会删除临时文件，但不能保证完全清除所有痕迹。攻击者可能通过修改代码，在生成恶意 ZIP 文件后，在目标系统上留下后门或执行其他恶意操作。考虑到实际利用场景中可能存在的恶意修改，投毒风险估计为5%。 主要风险点在于，虽然POC主要目的是生成exploit，但如果恶意人员修改，完全可以添加其他恶意payload，并伪装成CVE-2023-38831的POC进行传播。
5. **搜索引擎结果:** 搜索引擎结果表明此漏洞已被广泛利用，包括政府背景的黑客组织。 多个安全厂商发布了相关的分析和防御措施。

**项目地址:** [technicalcorp0/CVE-2023-38831-Exploit](https://github.com/technicalcorp0/CVE-2023-38831-Exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #27

**来源**: [CVE-2023-38831-xk-mt_WinRAR-Vulnerability-recurrence-tutorial.md](../2023/CVE-2023-38831-xk-mt_WinRAR-Vulnerability-recurrence-tutorial.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。该漏洞允许攻击者通过构造恶意的ZIP压缩包，在用户尝试查看压缩包内的文件时执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，该漏洞已被广泛利用，POC代码的存在也表明其有效性。多个安全厂商和研究人员都对此漏洞进行了分析并提供了相应的缓解措施。

**投毒风险分析：**
提供的POC代码包含以下文件：
*   `README.md`: 漏洞复现教程，包含漏洞信息和参考链接。
*   `执行命令.bat`: 一个简单的批处理文件，用于执行`calc.exe`（计算器程序），用于演示代码执行。
*   `文本.txt`: 包含一个URL地址。
*   `生成压缩包.py`: 一个Python脚本，用于生成包含漏洞的ZIP压缩包。

该脚本的主要功能是：
1.  创建临时目录，并将`执行命令.bat`复制到该目录。
2.  复制`文本.txt`文件到另一个目录。
3.  将上述两个目录打包成ZIP文件。
4.  修改ZIP文件中的文件名，利用漏洞的原理。
从代码本身来看，该脚本并没有明显的恶意代码，但是存在一定的投毒风险。
*   执行命令.bat： 虽然只是简单的calc.exe，但如果攻击者替换成其他恶意命令，则可能造成更大的危害。
*   脚本的依赖： 该脚本依赖Python环境，攻击者可能会通过修改脚本，引入恶意的Python依赖包，从而实现投毒。

综合来看，该仓库中存在一定的投毒风险，但不高。主要是因为演示的`执行命令.bat`内容比较简单，容易被识别。如果使用者直接运行此仓库的代码，有可能会被植入恶意程序。因此，投毒风险评定为10%。

**利用方式：**
1.  攻击者构造一个恶意的ZIP压缩包，该压缩包包含一个良性文件（例如，图片文件`文本.txt`）和一个与该文件同名的文件夹。
2.  该文件夹包含一个恶意可执行文件（例如，`执行命令.bat`并更名为`文本.txtA.cmd`）。
3.  当用户使用受影响的WinRAR版本打开该ZIP压缩包，并尝试查看良性文件时，WinRAR会错误地执行该文件夹中的恶意可执行文件，从而导致任意代码执行。

**项目地址:** [xk-mt/WinRAR-Vulnerability-recurrence-tutorial](https://github.com/xk-mt/WinRAR-Vulnerability-recurrence-tutorial)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #28

**来源**: [CVE-2023-38831-yezzfusl_cve_2023_38831_scanner.md](../2023/CVE-2023-38831-yezzfusl_cve_2023_38831_scanner.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开恶意的 ZIP 压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以通过构造一个特殊的 ZIP 压缩文件来利用此漏洞。该 ZIP 文件包含一个良性文件（例如 JPG）和一个同名的文件夹。当用户尝试访问良性文件时，WinRAR 会错误地执行文件夹中的恶意代码，导致远程代码执行。

**利用方式：**
1.  攻击者创建一个包含良性文件和同名文件夹的恶意 ZIP 文件。
2.  文件夹中包含要执行的恶意代码（例如，可执行文件）。
3.  攻击者诱使用户使用 WinRAR 打开该 ZIP 文件。
4.  当用户尝试访问良性文件时，WinRAR 会执行文件夹中的恶意代码。

**有效性：**
根据漏洞描述和搜索结果，该漏洞已在野外被利用，因此提供的PoC代码如果能够重现该行为，则可以认为是有效的。

**投毒风险：**
提供的代码仓库 `cve_2023_38831_scanner` 本身是一个漏洞扫描器，而非漏洞利用的PoC。尽管如此，仍然存在一定的投毒风险。代码中可能隐藏后门，虽然其主要功能是扫描，但理论上存在被篡改的风险。代码中使用了网络数据包分析、进程内存扫描、沙箱环境执行等模块，这些模块如果被恶意修改，可能被用于执行恶意操作。因此，综合考虑其扫描器的性质和潜在风险，投毒风险估计为10%。这个风险主要来自供应链投毒，如果下载了被篡改过的扫描器，那么扫描器本身可能成为攻击的一部分。

**项目地址:** [yezzfusl/cve_2023_38831_scanner](https://github.com/yezzfusl/cve_2023_38831_scanner)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #29

**来源**: [CVE-2023-38831-youmulijiang_evil-winrar.md](../2023/CVE-2023-38831-youmulijiang_evil-winrar.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 50%

## 详情

CVE-2023-38831是WinRAR在6.23版本之前存在的一个远程代码执行漏洞。该漏洞的利用方式是构造一个特殊的ZIP压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹。当用户尝试在WinRAR中查看该良性文件时，WinRAR会错误地执行该文件夹中的恶意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认该漏洞是有效的，并且已经在野外被利用。漏洞利用代码提供了一个框架，用于生成包含恶意payload的ZIP压缩包，从而实现远程代码执行。

**投毒风险分析：**
提供的代码是一个框架，用于生成漏洞利用的 ZIP 文件，包含生成 exp，邮件发送，下载链接生成等功能。代码中存在潜在的投毒风险，主要体现在以下几个方面：

1.  **Payload 植入:**  该框架可以自定义payload，如果用户在不了解 payload 内容的情况下使用，可能运行恶意指令。
2.  **代码可信度:** 虽然作者声明为安全开发成员，并开源了代码，但代码的安全性仍然需要进一步审计。存在作者预留后门的可能性。 考虑到这是一个漏洞利用框架，其本质就是为了执行恶意代码，所以判定为投毒代码的风险为50%。

**漏洞利用方式：**

1.  攻击者使用该漏洞利用框架(evil-winrar)生成一个恶意的 ZIP 压缩包。
2.  该 ZIP 压缩包包含一个良性文件（如JPG图片）和一个同名的文件夹，文件夹中包含恶意可执行文件。
3.  攻击者通过社会工程学等方式诱骗用户使用存在漏洞的 WinRAR 版本打开该 ZIP 压缩包。
4.  用户尝试查看良性文件时，WinRAR 会错误地执行同名文件夹中的恶意代码。
5.  恶意代码在用户系统上执行，攻击者从而实现远程代码执行，控制受害者的计算机。

**项目地址:** [youmulijiang/evil-winrar](https://github.com/youmulijiang/evil-winrar)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---



---

## POC #3

**来源**: [CVE-2023-38831-MaorBuskila_Windows-X64-RAT.md](../2023/CVE-2023-38831-MaorBuskila_Windows-X64-RAT.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者在用户尝试查看 ZIP 压缩包中的良性文件时执行任意代码。该漏洞源于 WinRAR 处理 ZIP 压缩包时，允许压缩包包含一个良性文件（例如 .JPG）和一个同名文件夹。当用户尝试访问该良性文件时，WinRAR 实际上会处理同名文件夹中的内容，从而允许攻击者在文件夹中放置恶意可执行文件并执行。

**有效性：**
从搜索结果和漏洞库信息来看，该漏洞已经被广泛利用，PoC 代码的存在也进一步验证了其有效性。

**投毒风险：**
提供的 Python 脚本 (`51721.py`) 用于生成 Windows x64 平台的反向 TCP Shellcode。该脚本本身不包含明显的恶意代码，功能是生成 shellcode。需要用户自行配置 IP 地址和端口。但是，由于该代码需要用户执行，并且可以生成任意 shellcode，存在一定投毒风险，例如，如果攻击者提供修改后的脚本，生成包含恶意功能的 shellcode (如删除文件，上传用户信息)，则用户可能无意中执行该恶意 shellcode. 脚本本身不包含网络连接或者其他与远程服务器通信的行为，可以基本判断代码仓库投毒风险较低.

**利用方式：**
1.  攻击者创建一个恶意的 ZIP 压缩包。
2.  该 ZIP 压缩包包含一个良性文件（例如 image.jpg）和一个同名文件夹（image.jpg）。
3.  同名文件夹包含恶意可执行文件，例如 exploit.exe，并可能包含一个 `.lnk` 文件，该快捷方式指向该恶意可执行文件。
4.  攻击者诱骗用户使用受影响版本的 WinRAR 打开该 ZIP 压缩包并尝试查看良性文件。
5.  WinRAR 错误地执行同名文件夹中的恶意可执行文件，从而导致远程代码执行。

**项目地址:** [MaorBuskila/Windows-X64-RAT](https://github.com/MaorBuskila/Windows-X64-RAT)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #4

**来源**: [CVE-2023-38831-MyStuffYT_CVE-2023-38831-POC.md](../2023/CVE-2023-38831-MyStuffYT_CVE-2023-38831-POC.md)

## CVE-2023-38831-WinRAR-远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的恶意ZIP压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个恶意的ZIP压缩文件，其中包含一个良性文件（例如.jpg）和一个同名的文件夹。当用户尝试在 WinRAR 中查看该良性文件时，WinRAR 会错误地执行该文件夹中的内容，从而导致任意代码执行。

**有效性：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。搜索引擎结果表明该漏洞已被广泛利用，POC代码的存在进一步证实了其有效性。

**投毒风险：**

根据对POC代码的分析，存在一定的投毒风险。`script.bat`脚本从github下载`Alert.exe`文件，这本身就存在一定的安全隐患，无法确保下载的文件一定是安全的。此外，脚本同时执行 `alert.exe` 和 `gtaleak.mp4`，而 `gtaleak.mp4` 在 README 中说明是 “zeros without ones”, 可以确定这是一个障眼法，实际的恶意行为是由 `alert.exe` 执行。 因此，作者可能隐藏了投毒代码。

**利用方式：**

1.  攻击者创建一个恶意的ZIP压缩文件，其中包含一个良性文件 (例如 `gtaleak.mp4`) 和一个同名的文件夹。
2.  该文件夹包含一个批处理脚本 (`script.bat`)，该脚本将从远程服务器下载并执行恶意程序 (`Alert.exe`)。
3.  当用户尝试使用 WinRAR 打开压缩文件并查看良性文件 (`gtaleak.mp4`) 时，WinRAR 会错误地执行批处理脚本。
4.  批处理脚本下载并执行恶意程序，从而允许攻击者在受害者的系统上执行任意代码。

**项目地址:** [MyStuffYT/CVE-2023-38831-POC](https://github.com/MyStuffYT/CVE-2023-38831-POC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #5

**来源**: [CVE-2023-38831-Nielk74_CVE-2023-38831.md](../2023/CVE-2023-38831-Nielk74_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本的代码执行漏洞。该漏洞允许攻击者在用户尝试查看ZIP存档中的看似无害的文件时执行任意代码。攻击者通过构造一个包含同名文件和文件夹的恶意ZIP文件，利用WinRAR处理文件路径时的逻辑缺陷，使得文件夹中的恶意可执行文件得以运行。提供的POC代码通过Vagrant自动化部署了一个易受攻击的WinRAR 6.22环境，并向虚拟机桌面添加了一个恶意的rar文件。该rar文件被设计为当用户点击其中的“无害”文件时，执行预先设定的恶意代码。尽管POC的主要目的是演示漏洞，但其中`ChocolateyInstall.ps1`脚本从外部源下载并安装软件包（Chocolatey和WinRAR），存在被篡改从而引入恶意代码的风险，这构成了潜在的投毒风险。虽然这个脚本很常见，但还是存在一定的风险，因此这里给出了10%的投毒风险。

**漏洞利用方式：**

1.  攻击者创建一个恶意的ZIP压缩包，其中包含一个看似无害的文件（例如.jpg），以及一个与该文件同名的文件夹。
2.  该文件夹包含恶意可执行文件，例如.exe或.cmd脚本。
3.  当用户尝试使用WinRAR打开ZIP压缩包并查看“无害”文件时，WinRAR会错误地执行同名文件夹中的恶意可执行文件，从而导致任意代码执行。
4.  攻击者可以利用此漏洞在受害者系统上安装恶意软件、窃取敏感数据或执行其他恶意操作。

**项目地址:** [Nielk74/CVE-2023-38831](https://github.com/Nielk74/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #6

**来源**: [CVE-2023-38831-RomainBayle08_CVE-2023-38831.md](../2023/CVE-2023-38831-RomainBayle08_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP或RAR压缩文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个特殊的 ZIP 压缩文件，该文件包含一个看似无害的文件（例如，.JPG 文件）和一个与该文件同名的文件夹。当用户尝试查看压缩文件中的无害文件时，WinRAR 会错误地执行文件夹中的内容，从而导致任意代码执行。

**有效性分析：**
提供的 POC 代码 `cve-2023-38831-exp-gen.py` 是一个漏洞利用生成器脚本，它接受诱饵文件 (`BAIT_NAME`)、脚本文件 (`SCRIPT_NAME`) 和额外的诱饵文件目录 (`BAIT_FILES`) 作为输入，并生成一个恶意 RAR 压缩文件 (`OUTPUT_NAME`)。脚本首先创建一个包含诱饵文件和脚本文件的临时目录结构，然后使用 `shutil.make_archive` 函数将该目录压缩为 ZIP 文件。关键在于，脚本会替换 ZIP 文件中特定文件的扩展名，利用 WinRAR 的漏洞，在用户尝试打开诱饵文件时执行脚本文件。`script.bat` 脚本会首先尝试打开诱饵文件（模拟用户行为），然后执行 `calc.exe`（作为漏洞利用成功的标志）。该 POC 的有效性较高，因为它模拟了真实的攻击场景。

**投毒风险分析：**
`cve-2023-38831-exp-gen.py` 脚本本身不包含明显的恶意代码或后门。但是，存在一定的投毒风险，因为该脚本允许攻击者指定要执行的任意脚本 (`SCRIPT_NAME`)。攻击者可以替换 `script.bat` 文件为包含恶意代码的文件，例如下载和执行其他恶意软件。此外，该脚本使用了`BAIT_FILES`参数，如果提供包含恶意文件的目录，也会构成投毒风险。所以存在一定投毒风险，但主要取决于用户提供的脚本和目录的内容。

**利用方式分析：**
1.  攻击者构造一个恶意 ZIP 压缩文件，其中包含一个诱饵文件（如 `CLASSIFIED_DOCUMENTS.pdf`）和一个与诱饵文件同名的文件夹。文件夹中包含一个脚本文件（如 `script.bat`）。
2.  攻击者将恶意 ZIP 文件发送给受害者，诱骗其使用 WinRAR 打开。
3.  当受害者尝试查看 ZIP 文件中的诱饵文件时，WinRAR 会错误地执行同名文件夹中的脚本文件。
4.  脚本文件执行任意代码，例如安装恶意软件或窃取敏感信息。

总的来说，该漏洞利用方式简单有效，风险较高。用户应尽快升级到 WinRAR 6.23 或更高版本。

**项目地址:** [RomainBayle08/CVE-2023-38831](https://github.com/RomainBayle08/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #7

**来源**: [CVE-2023-38831-RonF98_CVE-2023-38831-POC.md](../2023/CVE-2023-38831-RonF98_CVE-2023-38831-POC.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致任意代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831 是 WinRAR 在处理 ZIP 压缩文件时存在的一个漏洞。攻击者可以构造一个包含良性文件（例如 .jpg 文件）和一个同名文件夹的 ZIP 压缩包。该文件夹中包含恶意代码（例如 .cmd 文件）。当用户尝试查看良性文件时，WinRAR 会错误地执行文件夹中的恶意代码，从而导致远程代码执行。

**有效性：**

提供的 POC 代码有效，它演示了如何创建一个恶意的 RAR 文件来利用此漏洞。

*   `DoS.cmd` 文件包含恶意代码，用于创建多个消息框，模拟拒绝服务攻击。
*   `exploit.py` 脚本用于生成包含恶意 `DoS.cmd` 文件的 RAR 文件，并利用漏洞触发代码执行。
*   `README.md` 详细解释了漏洞原理和利用方法，并提供了攻击成功的截图。

**投毒风险：**

此仓库中可能存在轻微的投毒风险，约为5%。

*   `DoS.cmd` 只是一个简单的拒绝服务攻击示例，但攻击者可能会将其替换为更具破坏性的恶意代码，例如勒索软件或信息窃取程序。如果下载者不仔细检查 `DoS.cmd` 的内容，可能会在不知情的情况下运行恶意代码。
*   `exploit.py` 脚本本身没有明显的恶意代码，但它可以被修改以生成包含不同恶意代码的 RAR 文件。下载者应该仔细审查脚本的内容，确保它不会被用于传播恶意软件。

**利用方式：**

1.  攻击者创建一个包含良性文件（例如 `image.jpg`）和一个同名文件夹（例如 `image.jpg `）的 ZIP 压缩包。注意文件夹名称后面有一个空格。
2.  在同名文件夹中，攻击者放置恶意代码（例如 `image.jpg .cmd`）。
3.  攻击者将 ZIP 文件转换为 RAR 文件（POC 脚本完成了此过程）。
4.  攻击者诱骗用户使用受影响的 WinRAR 版本打开 RAR 文件并尝试查看良性文件（`image.jpg`）。
5.  WinRAR 错误地执行同名文件夹中的恶意代码 (`image.jpg .cmd`)，从而导致远程代码执行。

由于该漏洞被广泛利用，并且网上存在大量相关的 POC 代码，因此攻击者很容易发起攻击。


**项目地址:** [RonF98/CVE-2023-38831-POC](https://github.com/RonF98/CVE-2023-38831-POC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #8

**来源**: [CVE-2023-38831-SpamixOfficial_CVE-2023-38831.md](../2023/CVE-2023-38831-SpamixOfficial_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前的版本中的代码执行漏洞。攻击者可以制作一个特制的ZIP压缩包，其中包含一个良性文件和一个同名文件夹，文件夹中包含恶意可执行文件。当用户尝试在WinRAR中查看良性文件时，实际上会执行文件夹中的恶意代码。\n\n**有效性：**根据漏洞库信息、搜索结果和漏洞利用代码，该漏洞POC是有效的。漏洞库信息中明确指出该漏洞已在野外被利用。搜索结果中多个链接都指向了关于该漏洞的分析和利用报告。提供的`Cargo.lock`文件很可能只是rust项目依赖管理文件，无法直接证明POC的有效性，需配合rust源码进行分析。\n\n**投毒风险：**分析提供的`Cargo.lock`文件，该文件列出了Rust项目`CVE-2023-38831`的依赖项。虽然`Cargo.lock`本身不包含可执行代码，但是，如果恶意作者修改了依赖项的版本或来源，理论上存在引入被篡改过的crate（Rust包）的风险。不过，由于`Cargo.lock`文件明确指定了每个依赖项的checksum，Cargo在构建项目时会验证下载的crate是否与checksum匹配，从而降低了被投毒的风险。评估投毒风险为10%。\n\n**利用方式：**攻击者创建一个包含以下结构的ZIP压缩包：\n\n1.  一个良性的文件，例如 `image.jpg`\n2.  一个与良性文件同名的文件夹，例如 `image.jpg`\n3.  在同名文件夹中，放置恶意可执行文件，例如 `image.jpg.exe` 或 `image.jpg `(通过空格进行欺骗)。\n\n当用户使用存在漏洞的WinRAR版本打开该ZIP文件并尝试查看`image.jpg`时，WinRAR会错误地执行`image.jpg`文件夹中的恶意程序，从而实现远程代码执行。

**项目地址:** [SpamixOfficial/CVE-2023-38831](https://github.com/SpamixOfficial/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #9

**来源**: [CVE-2023-38831-Tolu12wani_Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution.md](../2023/CVE-2023-38831-Tolu12wani_Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在用户尝试查看 ZIP 压缩包中的文件时执行任意代码。

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开特制的 ZIP 压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者通过构造恶意的 ZIP 压缩包实现远程代码执行。该压缩包包含一个良性文件（例如 JPG）和一个与良性文件同名的文件夹。当用户尝试访问良性文件时，WinRAR 会错误地执行同名文件夹中的内容，从而执行攻击者放置的恶意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被广泛利用。 提供的POC代码描述的是在压缩文件中嵌入恶意payload，并触发反向shell的实验环境验证过程。虽然该代码本身没有包含恶意代码，但描述了如何构建利用该漏洞的压缩文件。

**投毒风险：**
提供的 POC 代码仓库中只包含 PDF 报告和截图，并没有可执行的恶意代码。 但是,README中说明了该仓库展示了恶意payload的嵌入方式，存在一定的潜在风险。 因此，存在一定的投毒风险，但风险较低。根据readme描述和文件结构，投毒风险评估为10%，

**利用方式：**
1.  **创建恶意 ZIP 压缩包：** 攻击者创建一个 ZIP 压缩包，其中包含一个良性文件（例如 JPG）和一个与良性文件同名的文件夹。
2.  **放置恶意代码：** 将恶意可执行文件放置在与良性文件同名的文件夹中。
3.  **诱骗用户：** 诱骗用户使用受影响的 WinRAR 版本打开该 ZIP 压缩包并尝试查看良性文件。
4.  **执行恶意代码：** WinRAR 错误地执行同名文件夹中的恶意代码，从而实现远程代码执行。

根据搜索结果，该漏洞已经被政府支持的攻击者利用，用于投放 RAT（远程访问木马）等恶意软件。

**项目地址:** [Tolu12wani/Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution](https://github.com/Tolu12wani/Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #10

**来源**: [CVE-2023-38831-VictoriousKnight_CVE-2023-38831_Exploit.md](../2023/CVE-2023-38831-VictoriousKnight_CVE-2023-38831_Exploit.md)

## CVE-2023-38831-WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码。

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的恶意ZIP文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个漏洞，它允许攻击者通过构造特殊的ZIP文件来执行任意代码。攻击者创建一个ZIP文件，其中包含一个良性文件（例如，JPG图片）和一个与该良性文件同名的文件夹。该文件夹中包含恶意可执行文件。当用户尝试在WinRAR中查看该良性文件时，WinRAR会错误地执行该文件夹中的恶意代码，从而导致远程代码执行。

**有效性：** 提供的POC代码是有效的。根据漏洞库信息和搜索结果，该漏洞在野外被广泛利用。POC代码通过创建包含良性文件和同名文件夹的恶意ZIP文件，并利用WinRAR处理文件时的缺陷来执行代码。POC代码结构清晰，易于理解和使用。

**投毒风险：** 提供的POC代码本身主要是利用漏洞生成EXP，但仔细检查代码，在`exploit.py`文件的zip文件内容操作部分被截断，没有展示修改zip文件内容的关键代码，作者可能在`Read and manipulate the zip file content`部分添加恶意代码，执行修改zip文件过程中的任何恶意行为。因此存在一定的投毒风险，根据代码完整度，我给出10%的投毒风险。

**利用方式：**
1.  攻击者创建一个恶意ZIP文件，其中包含一个看似无害的文件（例如，一个图片或PDF）。
2.  在ZIP文件中，攻击者同时创建一个与该无害文件同名的文件夹。
3.  该文件夹包含攻击者想要执行的恶意代码，通常是一个可执行文件或脚本。
4.  攻击者诱使用户使用存在漏洞的WinRAR版本打开该ZIP文件。
5.  当用户尝试访问ZIP文件中的“无害”文件时，WinRAR会错误地执行同名文件夹中的恶意代码。

**项目地址:** [VictoriousKnight/CVE-2023-38831_Exploit](https://github.com/VictoriousKnight/CVE-2023-38831_Exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #11

**来源**: [CVE-2023-38831-anelya0333_Exploiting-CVE-2023-38831.md](../2023/CVE-2023-38831-anelya0333_Exploiting-CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开特制的ZIP压缩文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞允许攻击者通过特制的ZIP压缩文件在目标系统上执行任意代码。该漏洞的根源在于WinRAR在处理包含与文件同名文件夹的ZIP文件时存在缺陷。攻击者可以构造一个 ZIP 文件，其中包含一个良性文件（例如.JPG）和一个与其同名的文件夹。当用户尝试在 WinRAR 中查看该良性文件时，WinRAR 会错误地执行该文件夹中的恶意代码。此PoC脚本生成一个ZIP文件，其中包含诱饵文件(bait file)和恶意脚本(script file)，并修改ZIP文件的文件头，以利用此漏洞。脚本创建与诱饵文件同名的文件夹，并将恶意脚本放入其中。然后，将诱饵文件的副本也放入ZIP文件中。通过替换文件名字段中的某些字符，WinRAR会将文件夹中的恶意文件误认为是要执行的文件，最终导致代码执行。由于代码仅仅是构造payload，不存在主动执行恶意代码，因此不存在投毒风险。

**项目地址:** [anelya0333/Exploiting-CVE-2023-38831](https://github.com/anelya0333/Exploiting-CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #12

**来源**: [CVE-2023-38831-b1tg_CVE-2023-38831-winrar-exploit.md](../2023/CVE-2023-38831-b1tg_CVE-2023-38831-winrar-exploit.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可导致完全系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开恶意构造的ZIP文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 允许攻击者通过特制的ZIP文件在受害者系统上执行任意代码。该漏洞源于 WinRAR 处理包含同名文件和文件夹的 ZIP 档案时的不当行为。攻击者可以创建一个 ZIP 文件，其中包含一个良性文件（例如 CLASSIFIED_DOCUMENTS.pdf）和一个同名文件夹（例如 CLASSIFIED_DOCUMENTS.pdf）。当用户尝试访问良性文件时，WinRAR 实际上会执行该文件夹中的内容（例如 script.bat）。

**有效性:**

提供的 POC 代码 `cve-2023-38831-exp-gen.py` 旨在生成利用此漏洞的恶意 RAR 档案。该脚本通过以下步骤工作：

1.  创建临时目录 `TEMPLATE`。
2.  在 `TEMPLATE` 中创建一个与bait文件同名的文件夹，并在其中存放包含恶意命令的script文件（例如 `script.bat`， 其中包含`calc.exe & CLASSIFIED_DOCUMENTS.pdf`）。
3.  将bait文件存放在`TEMPLATE`目录。
4.  将`TEMPLATE`目录压缩为zip文件。
5.  修改压缩包中文件和文件夹的名字，构造漏洞。
6.  最终输出 `CVE-2023-38831-poc.rar`。

该脚本能够有效地生成利用 CVE-2023-38831 的 RAR 文件，因此提供的 POC 代码是有效的。

**投毒风险:**

对提供的 POC 代码 (`cve-2023-38831-exp-gen.py` 和 `script.bat`) 进行分析后，未发现明显的恶意代码或后门。该脚本的功能明确且集中于生成利用 CVE-2023-38831 的 RAR 档案。 `script.bat` 的主要功能是启动计算器程序 (`calc.exe`) 并尝试打开诱饵文档 (`CLASSIFIED_DOCUMENTS.pdf`)，这是一个典型的 PoC 行为。 因此，该仓库中存在作者隐藏的投毒代码的风险极低。

**利用方式:**

1.  攻击者使用 `cve-2023-38831-exp-gen.py` 脚本，指定诱饵文件（例如 `CLASSIFIED_DOCUMENTS.pdf`）和恶意脚本（例如 `script.bat`），生成恶意 RAR 档案。
2.  攻击者通过各种方式（例如，电子邮件、恶意网站）将恶意 RAR 档案分发给受害者。
3.  受害者使用易受攻击的 WinRAR 版本（< 6.23）打开恶意 RAR 档案。
4.  当受害者尝试访问诱饵文件时，WinRAR 错误地执行了同名文件夹中的恶意脚本。
5.  恶意脚本在受害者系统上执行任意代码，例如启动计算器或安装恶意软件。

**项目地址:** [b1tg/CVE-2023-38831-winrar-exploit](https://github.com/b1tg/CVE-2023-38831-winrar-exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #13

**来源**: [CVE-2023-38831-elefantesagradodeluzinfinita_cve-2023-38831.md](../2023/CVE-2023-38831-elefantesagradodeluzinfinita_cve-2023-38831.md)

## CVE-2023-38831 - WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用 WinRAR 打开特制的 ZIP 压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者通过特制的 ZIP 压缩包在受害者系统上执行任意代码。漏洞利用方式是创建一个 ZIP 压缩包，其中包含一个良性文件（例如 .jpg 或 .pdf）以及一个同名的文件夹。该文件夹包含恶意的可执行文件（例如 .cmd 或 .exe）。当用户尝试打开良性文件时，WinRAR 会错误地执行文件夹中的恶意代码。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码分析，该漏洞确实存在并且已经被野外利用。提供的代码描述了一个利用工具 "DR. GANDALF"，它允许用户创建包含此漏洞的 ZIP 文件，表明POC的有效性。

**投毒风险：** 提供的 README.md 文件主要描述了漏洞原理和利用工具的使用方法。但是，由于此工具允许用户自定义注入的代码和二进制文件，因此存在投毒风险。如果用户下载了包含恶意注入代码的ZIP文件，那么这个工具本身可能被利用来传播恶意软件。评估投毒风险为 10%，因为该描述文件本身不包含可以直接执行的后门代码，但生成的ZIP文件可以包含。

**利用方式：**
1.  攻击者创建一个包含恶意 ZIP 压缩包。
2.  ZIP 压缩包中包含一个良性文件（例如，`image.jpg`）和一个同名的文件夹（例如，`image.jpg`）。
3.  `image.jpg` 文件夹包含恶意的可执行文件（例如，`evil.cmd`）。
4.  攻击者诱骗受害者使用存在漏洞的 WinRAR 版本打开该 ZIP 压缩包并尝试访问良性文件 `image.jpg`。
5.  WinRAR 在处理该 ZIP 文件时，会错误地执行 `image.jpg` 文件夹中的恶意代码 `evil.cmd`，从而导致远程代码执行。

**项目地址:** [elefantesagradodeluzinfinita/cve-2023-38831](https://github.com/elefantesagradodeluzinfinita/cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #14

**来源**: [CVE-2023-38831-h3xecute_SideCopy-Exploits-CVE-2023-38831.md](../2023/CVE-2023-38831-h3xecute_SideCopy-Exploits-CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个远程代码执行漏洞。该漏洞的利用方式是构造一个特殊的ZIP压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹。当用户尝试使用WinRAR打开该ZIP压缩包并访问良性文件时，WinRAR会错误地执行文件夹中的恶意代码。

**有效性：**
提供的POC代码描述了漏洞利用的原理，即构造包含同名良性文件和文件夹的ZIP压缩包。根据漏洞信息和搜索结果，此方法是有效的，并且在野外被利用。

**投毒风险：**
该POC本身描述了漏洞的利用方式，包含一个指向YouTube视频的链接，以及对恶意压缩包结构的描述。投毒风险较低，约为10%，因为：
1.  POC主要以描述性文字和图片链接为主。
2.  缺乏直接可执行的payload代码。
3.  作者可能通过YouTube链接传播恶意信息。

**利用方式：**
1.  攻击者创建一个恶意的ZIP压缩包。
2.  该压缩包包含一个良性文件（例如JPG，PDF等）和一个与该文件同名的文件夹。
3.  恶意代码（例如，可执行文件）放置在同名文件夹中。
4.  攻击者诱骗用户使用WinRAR打开这个ZIP压缩包，并尝试访问良性文件。
5.  WinRAR在处理压缩包时，会错误地执行同名文件夹中的恶意代码，从而导致远程代码执行。

**项目地址:** [h3xecute/SideCopy-Exploits-CVE-2023-38831](https://github.com/h3xecute/SideCopy-Exploits-CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #15

**来源**: [CVE-2023-38831-idkwastaken_CVE-2023-38831.md](../2023/CVE-2023-38831-idkwastaken_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意的ZIP文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的漏洞。该漏洞的利用方式是创建一个特制的ZIP文件，其中包含一个良性文件和一个同名文件夹。当用户尝试使用WinRAR打开ZIP文件并访问该良性文件时，WinRAR会错误地执行该同名文件夹中的恶意代码，导致远程代码执行。

**有效性：**
提供的POC代码（exploit.c）利用了该漏洞。该代码生成一个ZIP文件，其中包含一个PDF文件（document.pdf）和一个名为“document.pdf\”的文件夹，该文件夹内包含一个恶意的批处理脚本（script.bat）。当用户在易受攻击的WinRAR版本中打开并尝试访问该PDF文件时，WinRAR将执行该批处理脚本。
checker.bat 是用来检测目标系统是否安装WinRAR，以及WinRAR的版本是否是受影响的版本。
exploit.ps1 看起来不完整，但是其作用应该是检查WinRAR版本。

**投毒风险：**
代码中存在一定的投毒风险，约为10%。原因如下：
*   **脚本内容可控：** exploit.c 中的script_content变量包含了要执行的命令，虽然当前POC仅仅是弹窗，但是攻击者可以修改这个变量，执行任意命令，例如下载恶意软件，执行系统命令等。
*   **复杂的构建过程：** exploit.c 代码本身比较复杂，阅读和分析需要一定的时间和精力。攻击者可以利用这一点，在代码中隐藏不易察觉的恶意代码。
虽然有潜在的投毒风险，但当前代码的主要目的是演示漏洞利用，风险较低，作者没有明显的隐藏后门行为，恶意代码比较容易被发现。

**利用方式：**
1.  攻击者创建一个恶意的ZIP压缩包，其中包含：
    *   一个良性的文件（例如 document.pdf）。
    *   一个与良性文件同名的文件夹（例如 document.pdf/）。
    *   恶意代码位于同名文件夹中（例如 document.pdf/script.bat）。
2.  攻击者诱骗目标用户使用存在漏洞的 WinRAR 版本打开此 ZIP 压缩包。
3.  当用户尝试打开良性文件时，WinRAR 错误地执行同名文件夹中的恶意代码，从而导致任意代码执行。


**项目地址:** [idkwastaken/CVE-2023-38831](https://github.com/idkwastaken/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #16

**来源**: [CVE-2023-38831-imbyter_imbyter-WinRAR_CVE-2023-38831.md](../2023/CVE-2023-38831-imbyter_imbyter-WinRAR_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 6.23

**利用条件:** 用户使用受影响的WinRAR版本打开特制的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于WinRAR 6.23之前的版本中。攻击者可以构造一个恶意的ZIP压缩包，其中包含一个伪装成良性文件的文件（例如 .jpg），以及一个同名的文件夹。当用户尝试在 WinRAR 中查看该“良性文件”时，实际上会执行同名文件夹中的恶意代码（例如 .cmd 或 .exe 文件）。

**有效性：**
根据漏洞信息和搜索结果，提供的POC代码是有效的。该POC利用了WinRAR处理ZIP压缩包时存在的逻辑漏洞，能够实现远程代码执行。

**投毒风险：**
提供的Python脚本 `make-poc.py` 用于生成POC压缩包，其本身的代码逻辑相对简单，主要功能是将指定的文件和脚本打包成特定的ZIP格式，并进行一些字符串替换以触发漏洞。主要风险在于脚本生成的POC包中包含的脚本，如果这个脚本是恶意的，那么整个利用过程就存在投毒风险。 仓库中的README.md文件里的测试脚本就是一个关闭计算机的脚本。代码本身存在一定的投毒风险.

*   脚本逻辑：脚本的功能是创建包含漏洞利用结构的RAR文件。
*   恶意操作：如果脚本被修改以包含下载和执行恶意软件的逻辑，那么用户在使用此脚本创建RAR文件时，就会受到投毒攻击。

**利用方式：**
1.  攻击者使用 `make-poc.py` 脚本构造恶意的ZIP压缩包，需要提供一个“良性”文件和一个恶意脚本。
2.  攻击者将恶意的ZIP压缩包发送给受害者。
3.  受害者使用受影响的WinRAR版本打开该ZIP压缩包，并尝试查看伪装的“良性”文件。
4.  WinRAR错误地执行了与“良性”文件同名的文件夹中的恶意脚本，导致远程代码执行。

**防御措施：**
*   升级WinRAR到6.23或更高版本。
*   谨慎打开来源不明的ZIP压缩包。
*   使用杀毒软件扫描ZIP压缩包。

**项目地址:** [imbyter/imbyter-WinRAR_CVE-2023-38831](https://github.com/imbyter/imbyter-WinRAR_CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #17

**来源**: [CVE-2023-38831-kehrijksen_CVE-2023-38831.md](../2023/CVE-2023-38831-kehrijksen_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 需要用户解压特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个恶意的 ZIP 压缩包，其中包含一个伪装成普通文件的文件和一个同名的文件夹。当用户尝试在 WinRAR 中查看该“普通文件”时，WinRAR 会错误地执行同名文件夹中的内容，从而导致任意代码执行。

**有效性：**
提供的 PoC 代码 `poc.py` 能够生成利用此漏洞的恶意 ZIP 压缩包。该脚本首先创建一个包含恶意 payload (例如 script.bat) 和良性文件 (例如 pepe.jpg) 的目录结构。然后，它将此目录结构压缩成 ZIP 文件，并修改 ZIP 文件中的文件名，以触发漏洞。`script.bat` 的作用是在 `%TEMP%` 目录下提取 ZIP 文件内容，运行良性文件作为诱饵，然后执行恶意操作，例如创建一个包含 “hacked” 内容的文本文件并使用记事本打开。

**投毒风险：**
分析提供的代码，没有发现明显的投毒代码。`poc.py` 的作用是生成恶意 ZIP 文件，而 `script.bat` 包含的是恶意行为的代码，例如运行良性文件，创建 `hacked.txt` 等。这些行为是漏洞利用的一部分，而不是隐藏的恶意代码。虽然利用 `script.bat` 可以执行任意操作，但这属于漏洞利用的范畴，而非代码投毒。

**利用方式：**
1.  攻击者使用 `poc.py` 脚本生成一个恶意的 ZIP 压缩包，其中包含一个良性文件（例如图片）和一个同名的文件夹。
2.  攻击者将此恶意 ZIP 压缩包发送给受害者。
3.  受害者使用 WinRAR (6.23 之前的版本) 打开并尝试查看 ZIP 压缩包中的良性文件。
4.  WinRAR 错误地执行与良性文件同名的文件夹中的内容 (由 `script.bat` 控制)。
5.  `script.bat` 首先将 ZIP 文件的内容解压到临时目录。
6.  `script.bat` 运行良性文件（例如图片）作为诱饵，以迷惑受害者。
7.  `script.bat` 执行任意恶意操作，例如创建文件，修改注册表，安装恶意软件等。


**项目地址:** [kehrijksen/CVE-2023-38831](https://github.com/kehrijksen/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #18

**来源**: [CVE-2023-38831-khanhtranngoccva_cve-2023-38831-poc.md](../2023/CVE-2023-38831-khanhtranngoccva_cve-2023-38831-poc.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。该漏洞源于WinRAR处理ZIP压缩包时，对文件名和文件夹名区分不当。攻击者可以创建一个ZIP压缩包，其中包含一个良性文件（例如JPG）和一个同名的文件夹。该文件夹中包含恶意可执行文件。当用户尝试在WinRAR中打开该良性文件时，WinRAR会错误地执行文件夹中的恶意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已在野外被利用，证明了其有效性。提供的POC代码片段（package-lock.json）显示使用了jszip库，表明该POC可能用于创建恶意的ZIP压缩包，进一步验证漏洞的可利用性。

**投毒风险：**
提供的POC代码片段是`package-lock.json`文件，主要描述了项目依赖。要判断是否存在投毒风险，需要检查实际的利用代码（例如 index.ts/index.js）。
*   这个`package-lock.json`文件本身不包含恶意代码，只是依赖声明。
*   **风险点在于开发者可能在其他代码文件中（如index.ts等，此文件未提供）包含恶意代码**。
*   jszip 库本身是一个常用的 ZIP 文件操作库，被投毒的可能性较低。
*   tsx和typescript是typescript相关工具，本身被投毒的可能性也比较低

由于缺乏实际的利用代码，无法确定是否存在投毒行为，只能根据现有信息进行推测，因此将投毒风险评估为10%。

**利用方式：**
1.  攻击者构造一个恶意的ZIP压缩包。
2.  该ZIP压缩包包含一个良性文件（例如JPG）和一个同名的文件夹。
3.  该文件夹中包含恶意可执行文件（例如EXE、BAT、CMD等）。
4.  攻击者诱骗用户使用受影响的WinRAR版本打开该ZIP压缩包。
5.  用户尝试在WinRAR中打开该良性文件。
6.  WinRAR错误地执行文件夹中的恶意代码，导致远程代码执行。

**项目地址:** [khanhtranngoccva/cve-2023-38831-poc](https://github.com/khanhtranngoccva/cve-2023-38831-poc)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #19

**来源**: [CVE-2023-38831-kuyrathdaro_winrar-cve-2023-38831.md](../2023/CVE-2023-38831-kuyrathdaro_winrar-cve-2023-38831.md)

## CVE-2023-38831-WinRAR代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个代码执行漏洞。该漏洞的利用方式如下：

1.  攻击者创建一个恶意的ZIP压缩包（伪装成RAR格式，后缀名为.rar）。
2.  该压缩包包含一个良性的文件（例如，document.pdf），以及一个与该良性文件同名的文件夹（例如，document.pdf）。
3.  同名文件夹中包含恶意payload（例如，一个.bat或.exe文件），命名为`document.pdfA.cmd`。
4.  用户使用存在漏洞的WinRAR版本打开该压缩包，并尝试打开良性文件（document.pdf）。
5.  由于WinRAR处理文件名的缺陷，实际上执行的是同名文件夹中的恶意payload。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以判断该漏洞PoC有效。搜索引擎结果中多个链接表明该漏洞已被广泛利用，并且Google的威胁分析小组也分析了利用该漏洞进行的攻击活动。提供的PoC代码实现了生成恶意RAR压缩包的逻辑，进一步验证了该漏洞的可利用性。

**投毒风险：**

PoC代码本身的主要功能是生成利用CVE-2023-38831漏洞的恶意压缩包。然而，我们仍然需要评估该代码是否存在潜在的投毒风险。以下是对代码的分析：

*   **代码功能明确：** PoC代码的功能是生成特定的文件结构和内容，以触发WinRAR漏洞。代码逻辑相对简单，易于理解。
*   **输入/输出控制：** PoC代码接受三个输入参数：良性文件、Payload文件和输出文件名。这三个参数都由用户指定，PoC本身没有主动下载或执行任何其他代码的功能。
*   **潜在风险点：** `exploit.py` 脚本使用 `shutil.copyfile` 函数来复制 payload 文件到临时目录，如果payload 文件本身就是恶意的，那么这也会造成风险。此外，尽管脚本尝试确保输出文件以 `.rar` 结尾，但恶意用户可能修改此行为。
*   **间接风险：** 如果攻击者修改了提供的 `exploit.py` 脚本，添加额外的恶意功能（例如，在生成恶意压缩包后，自动上传到恶意服务器），则可能存在投毒风险。但是，这并非原始PoC代码本身的问题。

综合来看，原始PoC代码本身存在直接投毒的风险较低，我估计的投毒风险概率为 **10%**。这主要是因为恶意 payload 本身会带来风险，但 PoC 代码并没有主动引入恶意行为。

**利用方式：**

1.  准备一个良性的文件（例如，document.pdf）和一个恶意payload（例如，script.bat或malware.exe）。
2.  运行PoC脚本，指定良性文件、payload文件和输出文件名。
3.  PoC脚本生成一个恶意的RAR压缩包（实际上是ZIP格式，但后缀名为.rar）。
4.  将该恶意RAR压缩包发送给目标用户。
5.  目标用户使用存在漏洞的WinRAR版本打开该压缩包，并尝试打开良性文件。
6.  WinRAR执行同名文件夹中的恶意payload，从而实现代码执行。


**项目地址:** [kuyrathdaro/winrar-cve-2023-38831](https://github.com/kuyrathdaro/winrar-cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #20

**来源**: [CVE-2023-38831-malvika-thakur_CVE-2023-38831.md](../2023/CVE-2023-38831-malvika-thakur_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以通过创建一个特制的 ZIP 压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹，文件夹中包含恶意可执行文件。当用户尝试在 WinRAR 中查看该良性文件时，由于 WinRAR 处理逻辑的缺陷，会错误地执行文件夹中的恶意代码，从而导致远程代码执行。

**有效性：**

提供的 POC 代码 `poc.py`  可以生成利用此漏洞的 ZIP 文件。代码首先检查恶意脚本和良性文件是否存在，然后创建一个目录，将脚本和良性文件复制到特定结构中，最后将该目录压缩成 ZIP 文件。用户只需双击压缩包内的良性文件即可触发漏洞，执行恶意脚本。因此，POC 代码有效。

**投毒风险：**

分析提供的 `poc.py` 代码，没有发现明显的投毒代码。该脚本的主要功能是生成利用 CVE-2023-38831 漏洞的恶意 ZIP 文件。它需要用户提供恶意脚本和良性文件，然后按照特定目录结构进行组织并压缩。代码中没有发现任何会执行额外恶意操作的逻辑。`README.md` 文件也仅包含漏洞描述和使用说明，没有发现恶意内容。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者创建一个包含良性文件（如 JPG 图片）和一个同名文件夹的 ZIP 压缩包。
2.  该文件夹中包含恶意可执行文件（如 BAT 脚本）。
3.  攻击者将该 ZIP 压缩包发送给目标用户。
4.  目标用户使用受影响的 WinRAR 版本打开该 ZIP 压缩包。
5.  目标用户双击 ZIP 压缩包中的良性文件。
6.  WinRAR 错误地执行同名文件夹中的恶意可执行文件，导致远程代码执行。

**项目地址:** [malvika-thakur/CVE-2023-38831](https://github.com/malvika-thakur/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #21

**来源**: [CVE-2023-38831-r1yaz_winDED.md](../2023/CVE-2023-38831-r1yaz_winDED.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开特制的恶意 ZIP 压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 是 WinRAR 在处理 ZIP 压缩文件时存在的远程代码执行漏洞。当 WinRAR 版本低于 6.23 时，如果用户尝试打开一个包含恶意构造的 ZIP 文件，攻击者可以利用此漏洞执行任意代码。该 ZIP 文件包含一个良性文件（例如 JPG 文件）和一个与其同名的文件夹。攻击者可以将可执行文件放置在该文件夹中，当用户尝试访问良性文件时，WinRAR 会错误地执行文件夹中的可执行文件。

**有效性：**
提供的 POC 代码（winDED）通过生成恶意 ZIP 文件来演示漏洞利用。它创建了一个良性文件和一个同名文件夹，并将恶意脚本放入文件夹中。用户双击压缩包中的 PDF 文件时，实际上会执行该恶意脚本，从而证明漏洞的可利用性。

**投毒风险：**
根据提供的 POC 代码，投毒风险较低。代码主要是为了演示漏洞而设计的，虽然存在执行恶意 `super_sneaky_evil_script.bat` 的可能性，但该脚本本身是由用户提供的，或者可以通过查看代码本身来确认其行为。 然而，仍然存在一些细微的风险，例如，如果 `super_sneaky_evil_script.bat` 本身是从其他来源下载的，则可能包含恶意代码。  总的来说, 投毒风险约 10%。

**利用方式：**
1.  创建一个包含良性文件 (例如，`BILLION_DOLLAR_SECRET.pdf`) 和一个同名文件夹 (`BILLION_DOLLAR_SECRET.pdf`) 的 ZIP 压缩文件。
2.  将恶意脚本 (例如，`super_sneaky_evil_script.bat`) 放入同名文件夹中。
3.  诱骗目标用户使用 WinRAR 打开该 ZIP 文件。
4.  当用户尝试打开良性文件时，WinRAR 错误地执行同名文件夹中的恶意脚本，从而实现远程代码执行。

**项目地址:** [r1yaz/winDED](https://github.com/r1yaz/winDED)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #22

**来源**: [CVE-2023-38831-ra3edAJ_LAB-DFIR-cve-2023-38831.md](../2023/CVE-2023-38831-ra3edAJ_LAB-DFIR-cve-2023-38831.md)

## CVE-2023-38831-WinRAR代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 是 WinRAR 在 6.23 版本之前存在的远程代码执行漏洞。该漏洞源于WinRAR处理ZIP压缩包时，如果压缩包中包含一个良性文件和一个与该良性文件同名的文件夹，WinRAR在尝试访问良性文件时，会错误地执行同名文件夹中的恶意内容。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的PoC是可用的。漏洞在野外被广泛利用，并且CISA已将其添加到已知被利用的漏洞目录中。

**投毒风险：**
提供的漏洞利用代码为一个Github仓库的README.md文件，主要描述了如何利用磁盘镜像调查CVE-2023-38831攻击，并通过Windows注册表、NTFS文件和浏览器缓存理解Windows事件序列。仓库本身目的是为了DFIR分析，因此直接包含恶意代码的可能性较低。但考虑到链接跳转至外部教程网站，存在间接投毒的可能，即教程内容可能包含引导至恶意软件下载或运行恶意脚本的指令。因此，投毒风险较低，评估为10%。

**利用方式：**
1.  **创建恶意的ZIP压缩包：** 压缩包中包含一个良性文件（如JPG图片）和一个与该良性文件同名的文件夹。
2.  **将恶意可执行文件放入同名文件夹：** 该文件夹中的可执行文件会在用户尝试打开良性文件时被执行。
3.  **诱导用户打开ZIP压缩包：** 通过社交工程或其他方式，诱导用户使用受影响版本的WinRAR打开该压缩包。
4.  **触发漏洞执行恶意代码：** 当用户尝试查看ZIP压缩包中的良性文件时，WinRAR会错误地执行同名文件夹中的恶意代码，从而实现远程代码执行。

**总结：**
该漏洞利用方式较为简单，易于传播，危害较大。用户应及时更新WinRAR至最新版本，避免打开来源不明的ZIP压缩包。

**项目地址:** [ra3edAJ/LAB-DFIR-cve-2023-38831](https://github.com/ra3edAJ/LAB-DFIR-cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #23

**来源**: [CVE-2023-38831-ruycr4ft_CVE-2023-38831.md](../2023/CVE-2023-38831-ruycr4ft_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的远程代码执行漏洞。该漏洞源于WinRAR在处理ZIP压缩包时，对文件名和文件夹名相同的情况处理不当。攻击者可以构造一个恶意的ZIP压缩包，其中包含一个看似无害的文件（例如.jpg），同时包含一个同名的文件夹。当用户尝试打开该“无害文件”时，WinRAR会错误地执行同名文件夹中的恶意代码。\n\n**有效性：** 根据漏洞信息、搜索结果以及提供的POC代码，该漏洞利用是有效的。多个来源都表明该漏洞已被广泛利用，POC代码也展示了如何生成包含恶意代码的RAR压缩文件。POC代码通过创建同名文件和文件夹，并在文件夹中放入恶意脚本，利用WinRAR的缺陷触发代码执行。\n\n**投毒风险：**  仓库的投毒风险较低，大概10%。
  *   `poc.py`: 该脚本的功能是生成利用 CVE-2023-38831 的恶意 RAR 文件。虽然它允许用户指定 bait 文件和脚本文件，但脚本本身不包含任何预设的、隐藏的恶意行为。
  *   `script.bat`:  这个批处理文件包含使用 `nc.exe` (netcat) 反弹 shell 的命令。**这里存在一定的投毒风险。** 批处理文件明确地使用了`192.168.0.107`这个IP地址,如果用户直接使用该IP反弹shell,将会连接到攻击者的服务器。虽然IP地址可以被用户更改，但在默认情况下，如果用户不修改，将会连接到攻击者的IP。这是主要的投毒点。
  *   README.md: 该文件仅包含漏洞的简单介绍和演示图片。没有发现恶意代码。

**利用方式：**\n1.  攻击者创建一个恶意的ZIP压缩包。该压缩包包含一个诱饵文件（例如图片.jpg）和一个与其同名的文件夹（例如图片.jpg）。\n2.  攻击者将恶意代码（例如一个批处理脚本或可执行文件）放入同名文件夹中。\n3.  攻击者将包含恶意代码的ZIP压缩包发送给受害者。\n4.  受害者使用存在漏洞的WinRAR版本打开该ZIP压缩包，并尝试打开诱饵文件。\n5.  WinRAR错误地执行同名文件夹中的恶意代码，导致远程代码执行。

**项目地址:** [ruycr4ft/CVE-2023-38831](https://github.com/ruycr4ft/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #24

**来源**: [CVE-2023-38831-s4m98_winrar-cve-2023-38831-poc-gen.md](../2023/CVE-2023-38831-s4m98_winrar-cve-2023-38831-poc-gen.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开恶意的ZIP/RAR压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于WinRAR处理ZIP压缩文件时，由于对文件名和文件夹名处理不当导致。攻击者可以构造一个包含恶意脚本的ZIP压缩文件，该压缩文件包含一个正常的诱饵文件（如PDF、PNG或JPG）和一个同名的文件夹，当用户尝试打开诱饵文件时，WinRAR会错误地执行该文件夹中的恶意脚本。

**有效性：**
根据漏洞信息、搜索引擎结果和漏洞利用代码，该POC代码有效。漏洞库信息表明该漏洞已被野外利用。搜索引擎结果中也包含了大量关于此漏洞的分析和利用报告，证实了该漏洞的有效性。POC代码的描述和实现也符合漏洞的利用方式，通过生成包含恶意脚本和诱饵文件的RAR压缩包来触发漏洞。

**投毒风险：**
代码本身看起来比较直接，主要是生成利用漏洞的压缩包。`script.bat` 这个文件需要额外注意。当前提供的 `script.bat` 只是打开了计算器 `calc.exe` 和 Web_Security.pdf,相对来说是安全的，但用户在使用该漏洞时，完全可以修改此文件，添加更加恶意的payload，具有一定的风险。作者在代码中没有明显投毒行为，主要风险在于用户如何使用该工具生成payload。
投毒风险评估：10% (主要是用户修改 `script.bat` 的风险)

**利用方式：**
1.  **构造恶意ZIP/RAR压缩文件：** 利用提供的Python脚本（cve-2023-38831-exp-gen.py）生成恶意的ZIP/RAR压缩文件。此脚本需要一个诱饵文件（如PDF、PNG、JPG）和一个恶意脚本文件（如BAT、CMD、或可执行文件）。该脚本会创建一个包含诱饵文件和一个同名文件夹的压缩包，并将恶意脚本放置在该文件夹中。
2.  **诱骗用户打开压缩文件：**  将生成的恶意ZIP/RAR压缩文件发送给目标用户。
3.  **执行恶意代码：** 当用户使用受影响的WinRAR版本打开压缩文件并尝试查看诱饵文件时，WinRAR会错误地执行同名文件夹中的恶意脚本，从而实现远程代码执行。

 总体来说，该漏洞利用方式较为简单，攻击成本较低，风险较高。

**项目地址:** [s4m98/winrar-cve-2023-38831-poc-gen](https://github.com/s4m98/winrar-cve-2023-38831-poc-gen)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #25

**来源**: [CVE-2023-38831-solomon12354_VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC.md](../2023/CVE-2023-38831-solomon12354_VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要解压恶意的ZIP/RAR压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 存在于 WinRAR 6.23 之前版本中。攻击者可以构造一个包含良性文件和同名文件夹的 ZIP 压缩包，当用户尝试访问良性文件时，WinRAR 会错误地执行同名文件夹中的恶意代码。提供的 `exploit.py` 脚本可以用于生成包含漏洞利用的RAR压缩文件。脚本首先要求输入良性文件（`bait_file`）、恶意脚本文件（`script_file`）和输出RAR文件名称。然后，它创建一个临时目录，将恶意脚本复制到与良性文件同名的目录中，并将良性文件复制到临时目录中。最后，使用 `shutil.make_archive` 函数将临时目录压缩成 ZIP 文件，并修改 ZIP 文件的内容，将目录名中的 'A' 和 'B' 替换为空格，从而绕过 WinRAR 的安全检查。最终，将修改后的 ZIP 文件重命名为 RAR 文件。

`squid.bat` 用于下载并执行 `volleysquid.exe`。`volleyballsquid.py` 尝试利用 BypassUAC 来提升权限并将程序设置为开机自启。

**有效性:** 根据漏洞信息和利用代码分析，提供的 POC 代码有效，可以利用此漏洞在受害者机器上执行任意代码。

**投毒风险:** 仓库中存在一定的投毒风险，虽然主要功能是利用CVE-2023-38831漏洞，但是 `volleyballsquid.py`和`squid.bat`文件中的行为具有恶意性，特别是`volleyballsquid.py`中尝试使用`BypassUAC`绕过用户账户控制并持久化安装，这可能被用于安装后门或恶意软件。虽然主要目的是展示漏洞，但客观上存在后门功能，因此投毒风险占比为10%。

**利用方式:** 攻击者首先利用 `exploit.py` 脚本生成包含恶意代码的RAR压缩文件。然后，诱骗用户下载并使用 WinRAR 解压此文件。当用户尝试打开压缩包中的“良性”文件时，实际上会执行隐藏在同名目录中的恶意脚本 (例如 `squid.bat`)，下载并执行恶意程序。

根据搜索结果，CVE-2023-38831 漏洞已被广泛利用，并且已被政府背景的攻击者使用，这进一步验证了漏洞的严重性和 POC 代码的有效性。

**项目地址:** [solomon12354/VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC](https://github.com/solomon12354/VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #26

**来源**: [CVE-2023-38831-technicalcorp0_CVE-2023-38831-Exploit.md](../2023/CVE-2023-38831-technicalcorp0_CVE-2023-38831-Exploit.md)

## CVE-2023-38831-WinRAR-任意代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 任意代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个漏洞，该漏洞允许攻击者通过特制的ZIP档案执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** 当WinRAR尝试访问ZIP归档中的良性文件时，如果存在与该良性文件同名的文件夹，WinRAR会处理该文件夹的内容（可能包含可执行内容）。
2.  **利用方式：**
    *   攻击者创建一个恶意的ZIP档案，该档案包含一个良性文件（例如.JPG文件）和一个与该良性文件同名的文件夹。
    *   该文件夹包含恶意可执行文件。
    *   当受害者尝试在WinRAR中查看良性文件时，WinRAR会执行该文件夹中的恶意代码。
3.  **POC有效性：** 提供的POC代码 (CVE-2023-38831-WinRar-Exploit.py) 的目的是生成包含利用此漏洞的恶意 ZIP 文件。根据代码逻辑和漏洞原理，该 POC 可以有效利用该漏洞。
4.  **投毒风险：** 经过对POC代码的分析，发现代码本身实现了漏洞利用过程，但同时也存在一定的投毒风险。`clean_up()`函数会删除临时文件，但不能保证完全清除所有痕迹。攻击者可能通过修改代码，在生成恶意 ZIP 文件后，在目标系统上留下后门或执行其他恶意操作。考虑到实际利用场景中可能存在的恶意修改，投毒风险估计为5%。 主要风险点在于，虽然POC主要目的是生成exploit，但如果恶意人员修改，完全可以添加其他恶意payload，并伪装成CVE-2023-38831的POC进行传播。
5. **搜索引擎结果:** 搜索引擎结果表明此漏洞已被广泛利用，包括政府背景的黑客组织。 多个安全厂商发布了相关的分析和防御措施。

**项目地址:** [technicalcorp0/CVE-2023-38831-Exploit](https://github.com/technicalcorp0/CVE-2023-38831-Exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #27

**来源**: [CVE-2023-38831-xk-mt_WinRAR-Vulnerability-recurrence-tutorial.md](../2023/CVE-2023-38831-xk-mt_WinRAR-Vulnerability-recurrence-tutorial.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。该漏洞允许攻击者通过构造恶意的ZIP压缩包，在用户尝试查看压缩包内的文件时执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，该漏洞已被广泛利用，POC代码的存在也表明其有效性。多个安全厂商和研究人员都对此漏洞进行了分析并提供了相应的缓解措施。

**投毒风险分析：**
提供的POC代码包含以下文件：
*   `README.md`: 漏洞复现教程，包含漏洞信息和参考链接。
*   `执行命令.bat`: 一个简单的批处理文件，用于执行`calc.exe`（计算器程序），用于演示代码执行。
*   `文本.txt`: 包含一个URL地址。
*   `生成压缩包.py`: 一个Python脚本，用于生成包含漏洞的ZIP压缩包。

该脚本的主要功能是：
1.  创建临时目录，并将`执行命令.bat`复制到该目录。
2.  复制`文本.txt`文件到另一个目录。
3.  将上述两个目录打包成ZIP文件。
4.  修改ZIP文件中的文件名，利用漏洞的原理。
从代码本身来看，该脚本并没有明显的恶意代码，但是存在一定的投毒风险。
*   执行命令.bat： 虽然只是简单的calc.exe，但如果攻击者替换成其他恶意命令，则可能造成更大的危害。
*   脚本的依赖： 该脚本依赖Python环境，攻击者可能会通过修改脚本，引入恶意的Python依赖包，从而实现投毒。

综合来看，该仓库中存在一定的投毒风险，但不高。主要是因为演示的`执行命令.bat`内容比较简单，容易被识别。如果使用者直接运行此仓库的代码，有可能会被植入恶意程序。因此，投毒风险评定为10%。

**利用方式：**
1.  攻击者构造一个恶意的ZIP压缩包，该压缩包包含一个良性文件（例如，图片文件`文本.txt`）和一个与该文件同名的文件夹。
2.  该文件夹包含一个恶意可执行文件（例如，`执行命令.bat`并更名为`文本.txtA.cmd`）。
3.  当用户使用受影响的WinRAR版本打开该ZIP压缩包，并尝试查看良性文件时，WinRAR会错误地执行该文件夹中的恶意可执行文件，从而导致任意代码执行。

**项目地址:** [xk-mt/WinRAR-Vulnerability-recurrence-tutorial](https://github.com/xk-mt/WinRAR-Vulnerability-recurrence-tutorial)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #28

**来源**: [CVE-2023-38831-yezzfusl_cve_2023_38831_scanner.md](../2023/CVE-2023-38831-yezzfusl_cve_2023_38831_scanner.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开恶意的 ZIP 压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以通过构造一个特殊的 ZIP 压缩文件来利用此漏洞。该 ZIP 文件包含一个良性文件（例如 JPG）和一个同名的文件夹。当用户尝试访问良性文件时，WinRAR 会错误地执行文件夹中的恶意代码，导致远程代码执行。

**利用方式：**
1.  攻击者创建一个包含良性文件和同名文件夹的恶意 ZIP 文件。
2.  文件夹中包含要执行的恶意代码（例如，可执行文件）。
3.  攻击者诱使用户使用 WinRAR 打开该 ZIP 文件。
4.  当用户尝试访问良性文件时，WinRAR 会执行文件夹中的恶意代码。

**有效性：**
根据漏洞描述和搜索结果，该漏洞已在野外被利用，因此提供的PoC代码如果能够重现该行为，则可以认为是有效的。

**投毒风险：**
提供的代码仓库 `cve_2023_38831_scanner` 本身是一个漏洞扫描器，而非漏洞利用的PoC。尽管如此，仍然存在一定的投毒风险。代码中可能隐藏后门，虽然其主要功能是扫描，但理论上存在被篡改的风险。代码中使用了网络数据包分析、进程内存扫描、沙箱环境执行等模块，这些模块如果被恶意修改，可能被用于执行恶意操作。因此，综合考虑其扫描器的性质和潜在风险，投毒风险估计为10%。这个风险主要来自供应链投毒，如果下载了被篡改过的扫描器，那么扫描器本身可能成为攻击的一部分。

**项目地址:** [yezzfusl/cve_2023_38831_scanner](https://github.com/yezzfusl/cve_2023_38831_scanner)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #29

**来源**: [CVE-2023-38831-youmulijiang_evil-winrar.md](../2023/CVE-2023-38831-youmulijiang_evil-winrar.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 50%

## 详情

CVE-2023-38831是WinRAR在6.23版本之前存在的一个远程代码执行漏洞。该漏洞的利用方式是构造一个特殊的ZIP压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹。当用户尝试在WinRAR中查看该良性文件时，WinRAR会错误地执行该文件夹中的恶意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认该漏洞是有效的，并且已经在野外被利用。漏洞利用代码提供了一个框架，用于生成包含恶意payload的ZIP压缩包，从而实现远程代码执行。

**投毒风险分析：**
提供的代码是一个框架，用于生成漏洞利用的 ZIP 文件，包含生成 exp，邮件发送，下载链接生成等功能。代码中存在潜在的投毒风险，主要体现在以下几个方面：

1.  **Payload 植入:**  该框架可以自定义payload，如果用户在不了解 payload 内容的情况下使用，可能运行恶意指令。
2.  **代码可信度:** 虽然作者声明为安全开发成员，并开源了代码，但代码的安全性仍然需要进一步审计。存在作者预留后门的可能性。 考虑到这是一个漏洞利用框架，其本质就是为了执行恶意代码，所以判定为投毒代码的风险为50%。

**漏洞利用方式：**

1.  攻击者使用该漏洞利用框架(evil-winrar)生成一个恶意的 ZIP 压缩包。
2.  该 ZIP 压缩包包含一个良性文件（如JPG图片）和一个同名的文件夹，文件夹中包含恶意可执行文件。
3.  攻击者通过社会工程学等方式诱骗用户使用存在漏洞的 WinRAR 版本打开该 ZIP 压缩包。
4.  用户尝试查看良性文件时，WinRAR 会错误地执行同名文件夹中的恶意代码。
5.  恶意代码在用户系统上执行，攻击者从而实现远程代码执行，控制受害者的计算机。

**项目地址:** [youmulijiang/evil-winrar](https://github.com/youmulijiang/evil-winrar)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---



---

## POC #3

**来源**: [CVE-2023-38831-MaorBuskila_Windows-X64-RAT.md](../2023/CVE-2023-38831-MaorBuskila_Windows-X64-RAT.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者在用户尝试查看 ZIP 压缩包中的良性文件时执行任意代码。该漏洞源于 WinRAR 处理 ZIP 压缩包时，允许压缩包包含一个良性文件（例如 .JPG）和一个同名文件夹。当用户尝试访问该良性文件时，WinRAR 实际上会处理同名文件夹中的内容，从而允许攻击者在文件夹中放置恶意可执行文件并执行。

**有效性：**
从搜索结果和漏洞库信息来看，该漏洞已经被广泛利用，PoC 代码的存在也进一步验证了其有效性。

**投毒风险：**
提供的 Python 脚本 (`51721.py`) 用于生成 Windows x64 平台的反向 TCP Shellcode。该脚本本身不包含明显的恶意代码，功能是生成 shellcode。需要用户自行配置 IP 地址和端口。但是，由于该代码需要用户执行，并且可以生成任意 shellcode，存在一定投毒风险，例如，如果攻击者提供修改后的脚本，生成包含恶意功能的 shellcode (如删除文件，上传用户信息)，则用户可能无意中执行该恶意 shellcode. 脚本本身不包含网络连接或者其他与远程服务器通信的行为，可以基本判断代码仓库投毒风险较低.

**利用方式：**
1.  攻击者创建一个恶意的 ZIP 压缩包。
2.  该 ZIP 压缩包包含一个良性文件（例如 image.jpg）和一个同名文件夹（image.jpg）。
3.  同名文件夹包含恶意可执行文件，例如 exploit.exe，并可能包含一个 `.lnk` 文件，该快捷方式指向该恶意可执行文件。
4.  攻击者诱骗用户使用受影响版本的 WinRAR 打开该 ZIP 压缩包并尝试查看良性文件。
5.  WinRAR 错误地执行同名文件夹中的恶意可执行文件，从而导致远程代码执行。

**项目地址:** [MaorBuskila/Windows-X64-RAT](https://github.com/MaorBuskila/Windows-X64-RAT)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #4

**来源**: [CVE-2023-38831-MyStuffYT_CVE-2023-38831-POC.md](../2023/CVE-2023-38831-MyStuffYT_CVE-2023-38831-POC.md)

## CVE-2023-38831-WinRAR-远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的恶意ZIP压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个恶意的ZIP压缩文件，其中包含一个良性文件（例如.jpg）和一个同名的文件夹。当用户尝试在 WinRAR 中查看该良性文件时，WinRAR 会错误地执行该文件夹中的内容，从而导致任意代码执行。

**有效性：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。搜索引擎结果表明该漏洞已被广泛利用，POC代码的存在进一步证实了其有效性。

**投毒风险：**

根据对POC代码的分析，存在一定的投毒风险。`script.bat`脚本从github下载`Alert.exe`文件，这本身就存在一定的安全隐患，无法确保下载的文件一定是安全的。此外，脚本同时执行 `alert.exe` 和 `gtaleak.mp4`，而 `gtaleak.mp4` 在 README 中说明是 “zeros without ones”, 可以确定这是一个障眼法，实际的恶意行为是由 `alert.exe` 执行。 因此，作者可能隐藏了投毒代码。

**利用方式：**

1.  攻击者创建一个恶意的ZIP压缩文件，其中包含一个良性文件 (例如 `gtaleak.mp4`) 和一个同名的文件夹。
2.  该文件夹包含一个批处理脚本 (`script.bat`)，该脚本将从远程服务器下载并执行恶意程序 (`Alert.exe`)。
3.  当用户尝试使用 WinRAR 打开压缩文件并查看良性文件 (`gtaleak.mp4`) 时，WinRAR 会错误地执行批处理脚本。
4.  批处理脚本下载并执行恶意程序，从而允许攻击者在受害者的系统上执行任意代码。

**项目地址:** [MyStuffYT/CVE-2023-38831-POC](https://github.com/MyStuffYT/CVE-2023-38831-POC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #5

**来源**: [CVE-2023-38831-Nielk74_CVE-2023-38831.md](../2023/CVE-2023-38831-Nielk74_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本的代码执行漏洞。该漏洞允许攻击者在用户尝试查看ZIP存档中的看似无害的文件时执行任意代码。攻击者通过构造一个包含同名文件和文件夹的恶意ZIP文件，利用WinRAR处理文件路径时的逻辑缺陷，使得文件夹中的恶意可执行文件得以运行。提供的POC代码通过Vagrant自动化部署了一个易受攻击的WinRAR 6.22环境，并向虚拟机桌面添加了一个恶意的rar文件。该rar文件被设计为当用户点击其中的“无害”文件时，执行预先设定的恶意代码。尽管POC的主要目的是演示漏洞，但其中`ChocolateyInstall.ps1`脚本从外部源下载并安装软件包（Chocolatey和WinRAR），存在被篡改从而引入恶意代码的风险，这构成了潜在的投毒风险。虽然这个脚本很常见，但还是存在一定的风险，因此这里给出了10%的投毒风险。

**漏洞利用方式：**

1.  攻击者创建一个恶意的ZIP压缩包，其中包含一个看似无害的文件（例如.jpg），以及一个与该文件同名的文件夹。
2.  该文件夹包含恶意可执行文件，例如.exe或.cmd脚本。
3.  当用户尝试使用WinRAR打开ZIP压缩包并查看“无害”文件时，WinRAR会错误地执行同名文件夹中的恶意可执行文件，从而导致任意代码执行。
4.  攻击者可以利用此漏洞在受害者系统上安装恶意软件、窃取敏感数据或执行其他恶意操作。

**项目地址:** [Nielk74/CVE-2023-38831](https://github.com/Nielk74/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #6

**来源**: [CVE-2023-38831-RomainBayle08_CVE-2023-38831.md](../2023/CVE-2023-38831-RomainBayle08_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP或RAR压缩文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个特殊的 ZIP 压缩文件，该文件包含一个看似无害的文件（例如，.JPG 文件）和一个与该文件同名的文件夹。当用户尝试查看压缩文件中的无害文件时，WinRAR 会错误地执行文件夹中的内容，从而导致任意代码执行。

**有效性分析：**
提供的 POC 代码 `cve-2023-38831-exp-gen.py` 是一个漏洞利用生成器脚本，它接受诱饵文件 (`BAIT_NAME`)、脚本文件 (`SCRIPT_NAME`) 和额外的诱饵文件目录 (`BAIT_FILES`) 作为输入，并生成一个恶意 RAR 压缩文件 (`OUTPUT_NAME`)。脚本首先创建一个包含诱饵文件和脚本文件的临时目录结构，然后使用 `shutil.make_archive` 函数将该目录压缩为 ZIP 文件。关键在于，脚本会替换 ZIP 文件中特定文件的扩展名，利用 WinRAR 的漏洞，在用户尝试打开诱饵文件时执行脚本文件。`script.bat` 脚本会首先尝试打开诱饵文件（模拟用户行为），然后执行 `calc.exe`（作为漏洞利用成功的标志）。该 POC 的有效性较高，因为它模拟了真实的攻击场景。

**投毒风险分析：**
`cve-2023-38831-exp-gen.py` 脚本本身不包含明显的恶意代码或后门。但是，存在一定的投毒风险，因为该脚本允许攻击者指定要执行的任意脚本 (`SCRIPT_NAME`)。攻击者可以替换 `script.bat` 文件为包含恶意代码的文件，例如下载和执行其他恶意软件。此外，该脚本使用了`BAIT_FILES`参数，如果提供包含恶意文件的目录，也会构成投毒风险。所以存在一定投毒风险，但主要取决于用户提供的脚本和目录的内容。

**利用方式分析：**
1.  攻击者构造一个恶意 ZIP 压缩文件，其中包含一个诱饵文件（如 `CLASSIFIED_DOCUMENTS.pdf`）和一个与诱饵文件同名的文件夹。文件夹中包含一个脚本文件（如 `script.bat`）。
2.  攻击者将恶意 ZIP 文件发送给受害者，诱骗其使用 WinRAR 打开。
3.  当受害者尝试查看 ZIP 文件中的诱饵文件时，WinRAR 会错误地执行同名文件夹中的脚本文件。
4.  脚本文件执行任意代码，例如安装恶意软件或窃取敏感信息。

总的来说，该漏洞利用方式简单有效，风险较高。用户应尽快升级到 WinRAR 6.23 或更高版本。

**项目地址:** [RomainBayle08/CVE-2023-38831](https://github.com/RomainBayle08/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #7

**来源**: [CVE-2023-38831-RonF98_CVE-2023-38831-POC.md](../2023/CVE-2023-38831-RonF98_CVE-2023-38831-POC.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致任意代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831 是 WinRAR 在处理 ZIP 压缩文件时存在的一个漏洞。攻击者可以构造一个包含良性文件（例如 .jpg 文件）和一个同名文件夹的 ZIP 压缩包。该文件夹中包含恶意代码（例如 .cmd 文件）。当用户尝试查看良性文件时，WinRAR 会错误地执行文件夹中的恶意代码，从而导致远程代码执行。

**有效性：**

提供的 POC 代码有效，它演示了如何创建一个恶意的 RAR 文件来利用此漏洞。

*   `DoS.cmd` 文件包含恶意代码，用于创建多个消息框，模拟拒绝服务攻击。
*   `exploit.py` 脚本用于生成包含恶意 `DoS.cmd` 文件的 RAR 文件，并利用漏洞触发代码执行。
*   `README.md` 详细解释了漏洞原理和利用方法，并提供了攻击成功的截图。

**投毒风险：**

此仓库中可能存在轻微的投毒风险，约为5%。

*   `DoS.cmd` 只是一个简单的拒绝服务攻击示例，但攻击者可能会将其替换为更具破坏性的恶意代码，例如勒索软件或信息窃取程序。如果下载者不仔细检查 `DoS.cmd` 的内容，可能会在不知情的情况下运行恶意代码。
*   `exploit.py` 脚本本身没有明显的恶意代码，但它可以被修改以生成包含不同恶意代码的 RAR 文件。下载者应该仔细审查脚本的内容，确保它不会被用于传播恶意软件。

**利用方式：**

1.  攻击者创建一个包含良性文件（例如 `image.jpg`）和一个同名文件夹（例如 `image.jpg `）的 ZIP 压缩包。注意文件夹名称后面有一个空格。
2.  在同名文件夹中，攻击者放置恶意代码（例如 `image.jpg .cmd`）。
3.  攻击者将 ZIP 文件转换为 RAR 文件（POC 脚本完成了此过程）。
4.  攻击者诱骗用户使用受影响的 WinRAR 版本打开 RAR 文件并尝试查看良性文件（`image.jpg`）。
5.  WinRAR 错误地执行同名文件夹中的恶意代码 (`image.jpg .cmd`)，从而导致远程代码执行。

由于该漏洞被广泛利用，并且网上存在大量相关的 POC 代码，因此攻击者很容易发起攻击。


**项目地址:** [RonF98/CVE-2023-38831-POC](https://github.com/RonF98/CVE-2023-38831-POC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #8

**来源**: [CVE-2023-38831-SpamixOfficial_CVE-2023-38831.md](../2023/CVE-2023-38831-SpamixOfficial_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前的版本中的代码执行漏洞。攻击者可以制作一个特制的ZIP压缩包，其中包含一个良性文件和一个同名文件夹，文件夹中包含恶意可执行文件。当用户尝试在WinRAR中查看良性文件时，实际上会执行文件夹中的恶意代码。\n\n**有效性：**根据漏洞库信息、搜索结果和漏洞利用代码，该漏洞POC是有效的。漏洞库信息中明确指出该漏洞已在野外被利用。搜索结果中多个链接都指向了关于该漏洞的分析和利用报告。提供的`Cargo.lock`文件很可能只是rust项目依赖管理文件，无法直接证明POC的有效性，需配合rust源码进行分析。\n\n**投毒风险：**分析提供的`Cargo.lock`文件，该文件列出了Rust项目`CVE-2023-38831`的依赖项。虽然`Cargo.lock`本身不包含可执行代码，但是，如果恶意作者修改了依赖项的版本或来源，理论上存在引入被篡改过的crate（Rust包）的风险。不过，由于`Cargo.lock`文件明确指定了每个依赖项的checksum，Cargo在构建项目时会验证下载的crate是否与checksum匹配，从而降低了被投毒的风险。评估投毒风险为10%。\n\n**利用方式：**攻击者创建一个包含以下结构的ZIP压缩包：\n\n1.  一个良性的文件，例如 `image.jpg`\n2.  一个与良性文件同名的文件夹，例如 `image.jpg`\n3.  在同名文件夹中，放置恶意可执行文件，例如 `image.jpg.exe` 或 `image.jpg `(通过空格进行欺骗)。\n\n当用户使用存在漏洞的WinRAR版本打开该ZIP文件并尝试查看`image.jpg`时，WinRAR会错误地执行`image.jpg`文件夹中的恶意程序，从而实现远程代码执行。

**项目地址:** [SpamixOfficial/CVE-2023-38831](https://github.com/SpamixOfficial/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #9

**来源**: [CVE-2023-38831-Tolu12wani_Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution.md](../2023/CVE-2023-38831-Tolu12wani_Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在用户尝试查看 ZIP 压缩包中的文件时执行任意代码。

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开特制的 ZIP 压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者通过构造恶意的 ZIP 压缩包实现远程代码执行。该压缩包包含一个良性文件（例如 JPG）和一个与良性文件同名的文件夹。当用户尝试访问良性文件时，WinRAR 会错误地执行同名文件夹中的内容，从而执行攻击者放置的恶意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被广泛利用。 提供的POC代码描述的是在压缩文件中嵌入恶意payload，并触发反向shell的实验环境验证过程。虽然该代码本身没有包含恶意代码，但描述了如何构建利用该漏洞的压缩文件。

**投毒风险：**
提供的 POC 代码仓库中只包含 PDF 报告和截图，并没有可执行的恶意代码。 但是,README中说明了该仓库展示了恶意payload的嵌入方式，存在一定的潜在风险。 因此，存在一定的投毒风险，但风险较低。根据readme描述和文件结构，投毒风险评估为10%，

**利用方式：**
1.  **创建恶意 ZIP 压缩包：** 攻击者创建一个 ZIP 压缩包，其中包含一个良性文件（例如 JPG）和一个与良性文件同名的文件夹。
2.  **放置恶意代码：** 将恶意可执行文件放置在与良性文件同名的文件夹中。
3.  **诱骗用户：** 诱骗用户使用受影响的 WinRAR 版本打开该 ZIP 压缩包并尝试查看良性文件。
4.  **执行恶意代码：** WinRAR 错误地执行同名文件夹中的恶意代码，从而实现远程代码执行。

根据搜索结果，该漏洞已经被政府支持的攻击者利用，用于投放 RAT（远程访问木马）等恶意软件。

**项目地址:** [Tolu12wani/Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution](https://github.com/Tolu12wani/Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #10

**来源**: [CVE-2023-38831-VictoriousKnight_CVE-2023-38831_Exploit.md](../2023/CVE-2023-38831-VictoriousKnight_CVE-2023-38831_Exploit.md)

## CVE-2023-38831-WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码。

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的恶意ZIP文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个漏洞，它允许攻击者通过构造特殊的ZIP文件来执行任意代码。攻击者创建一个ZIP文件，其中包含一个良性文件（例如，JPG图片）和一个与该良性文件同名的文件夹。该文件夹中包含恶意可执行文件。当用户尝试在WinRAR中查看该良性文件时，WinRAR会错误地执行该文件夹中的恶意代码，从而导致远程代码执行。

**有效性：** 提供的POC代码是有效的。根据漏洞库信息和搜索结果，该漏洞在野外被广泛利用。POC代码通过创建包含良性文件和同名文件夹的恶意ZIP文件，并利用WinRAR处理文件时的缺陷来执行代码。POC代码结构清晰，易于理解和使用。

**投毒风险：** 提供的POC代码本身主要是利用漏洞生成EXP，但仔细检查代码，在`exploit.py`文件的zip文件内容操作部分被截断，没有展示修改zip文件内容的关键代码，作者可能在`Read and manipulate the zip file content`部分添加恶意代码，执行修改zip文件过程中的任何恶意行为。因此存在一定的投毒风险，根据代码完整度，我给出10%的投毒风险。

**利用方式：**
1.  攻击者创建一个恶意ZIP文件，其中包含一个看似无害的文件（例如，一个图片或PDF）。
2.  在ZIP文件中，攻击者同时创建一个与该无害文件同名的文件夹。
3.  该文件夹包含攻击者想要执行的恶意代码，通常是一个可执行文件或脚本。
4.  攻击者诱使用户使用存在漏洞的WinRAR版本打开该ZIP文件。
5.  当用户尝试访问ZIP文件中的“无害”文件时，WinRAR会错误地执行同名文件夹中的恶意代码。

**项目地址:** [VictoriousKnight/CVE-2023-38831_Exploit](https://github.com/VictoriousKnight/CVE-2023-38831_Exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #11

**来源**: [CVE-2023-38831-anelya0333_Exploiting-CVE-2023-38831.md](../2023/CVE-2023-38831-anelya0333_Exploiting-CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开特制的ZIP压缩文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞允许攻击者通过特制的ZIP压缩文件在目标系统上执行任意代码。该漏洞的根源在于WinRAR在处理包含与文件同名文件夹的ZIP文件时存在缺陷。攻击者可以构造一个 ZIP 文件，其中包含一个良性文件（例如.JPG）和一个与其同名的文件夹。当用户尝试在 WinRAR 中查看该良性文件时，WinRAR 会错误地执行该文件夹中的恶意代码。此PoC脚本生成一个ZIP文件，其中包含诱饵文件(bait file)和恶意脚本(script file)，并修改ZIP文件的文件头，以利用此漏洞。脚本创建与诱饵文件同名的文件夹，并将恶意脚本放入其中。然后，将诱饵文件的副本也放入ZIP文件中。通过替换文件名字段中的某些字符，WinRAR会将文件夹中的恶意文件误认为是要执行的文件，最终导致代码执行。由于代码仅仅是构造payload，不存在主动执行恶意代码，因此不存在投毒风险。

**项目地址:** [anelya0333/Exploiting-CVE-2023-38831](https://github.com/anelya0333/Exploiting-CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #12

**来源**: [CVE-2023-38831-b1tg_CVE-2023-38831-winrar-exploit.md](../2023/CVE-2023-38831-b1tg_CVE-2023-38831-winrar-exploit.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可导致完全系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开恶意构造的ZIP文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 允许攻击者通过特制的ZIP文件在受害者系统上执行任意代码。该漏洞源于 WinRAR 处理包含同名文件和文件夹的 ZIP 档案时的不当行为。攻击者可以创建一个 ZIP 文件，其中包含一个良性文件（例如 CLASSIFIED_DOCUMENTS.pdf）和一个同名文件夹（例如 CLASSIFIED_DOCUMENTS.pdf）。当用户尝试访问良性文件时，WinRAR 实际上会执行该文件夹中的内容（例如 script.bat）。

**有效性:**

提供的 POC 代码 `cve-2023-38831-exp-gen.py` 旨在生成利用此漏洞的恶意 RAR 档案。该脚本通过以下步骤工作：

1.  创建临时目录 `TEMPLATE`。
2.  在 `TEMPLATE` 中创建一个与bait文件同名的文件夹，并在其中存放包含恶意命令的script文件（例如 `script.bat`， 其中包含`calc.exe & CLASSIFIED_DOCUMENTS.pdf`）。
3.  将bait文件存放在`TEMPLATE`目录。
4.  将`TEMPLATE`目录压缩为zip文件。
5.  修改压缩包中文件和文件夹的名字，构造漏洞。
6.  最终输出 `CVE-2023-38831-poc.rar`。

该脚本能够有效地生成利用 CVE-2023-38831 的 RAR 文件，因此提供的 POC 代码是有效的。

**投毒风险:**

对提供的 POC 代码 (`cve-2023-38831-exp-gen.py` 和 `script.bat`) 进行分析后，未发现明显的恶意代码或后门。该脚本的功能明确且集中于生成利用 CVE-2023-38831 的 RAR 档案。 `script.bat` 的主要功能是启动计算器程序 (`calc.exe`) 并尝试打开诱饵文档 (`CLASSIFIED_DOCUMENTS.pdf`)，这是一个典型的 PoC 行为。 因此，该仓库中存在作者隐藏的投毒代码的风险极低。

**利用方式:**

1.  攻击者使用 `cve-2023-38831-exp-gen.py` 脚本，指定诱饵文件（例如 `CLASSIFIED_DOCUMENTS.pdf`）和恶意脚本（例如 `script.bat`），生成恶意 RAR 档案。
2.  攻击者通过各种方式（例如，电子邮件、恶意网站）将恶意 RAR 档案分发给受害者。
3.  受害者使用易受攻击的 WinRAR 版本（< 6.23）打开恶意 RAR 档案。
4.  当受害者尝试访问诱饵文件时，WinRAR 错误地执行了同名文件夹中的恶意脚本。
5.  恶意脚本在受害者系统上执行任意代码，例如启动计算器或安装恶意软件。

**项目地址:** [b1tg/CVE-2023-38831-winrar-exploit](https://github.com/b1tg/CVE-2023-38831-winrar-exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #13

**来源**: [CVE-2023-38831-elefantesagradodeluzinfinita_cve-2023-38831.md](../2023/CVE-2023-38831-elefantesagradodeluzinfinita_cve-2023-38831.md)

## CVE-2023-38831 - WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用 WinRAR 打开特制的 ZIP 压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者通过特制的 ZIP 压缩包在受害者系统上执行任意代码。漏洞利用方式是创建一个 ZIP 压缩包，其中包含一个良性文件（例如 .jpg 或 .pdf）以及一个同名的文件夹。该文件夹包含恶意的可执行文件（例如 .cmd 或 .exe）。当用户尝试打开良性文件时，WinRAR 会错误地执行文件夹中的恶意代码。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码分析，该漏洞确实存在并且已经被野外利用。提供的代码描述了一个利用工具 "DR. GANDALF"，它允许用户创建包含此漏洞的 ZIP 文件，表明POC的有效性。

**投毒风险：** 提供的 README.md 文件主要描述了漏洞原理和利用工具的使用方法。但是，由于此工具允许用户自定义注入的代码和二进制文件，因此存在投毒风险。如果用户下载了包含恶意注入代码的ZIP文件，那么这个工具本身可能被利用来传播恶意软件。评估投毒风险为 10%，因为该描述文件本身不包含可以直接执行的后门代码，但生成的ZIP文件可以包含。

**利用方式：**
1.  攻击者创建一个包含恶意 ZIP 压缩包。
2.  ZIP 压缩包中包含一个良性文件（例如，`image.jpg`）和一个同名的文件夹（例如，`image.jpg`）。
3.  `image.jpg` 文件夹包含恶意的可执行文件（例如，`evil.cmd`）。
4.  攻击者诱骗受害者使用存在漏洞的 WinRAR 版本打开该 ZIP 压缩包并尝试访问良性文件 `image.jpg`。
5.  WinRAR 在处理该 ZIP 文件时，会错误地执行 `image.jpg` 文件夹中的恶意代码 `evil.cmd`，从而导致远程代码执行。

**项目地址:** [elefantesagradodeluzinfinita/cve-2023-38831](https://github.com/elefantesagradodeluzinfinita/cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #14

**来源**: [CVE-2023-38831-h3xecute_SideCopy-Exploits-CVE-2023-38831.md](../2023/CVE-2023-38831-h3xecute_SideCopy-Exploits-CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个远程代码执行漏洞。该漏洞的利用方式是构造一个特殊的ZIP压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹。当用户尝试使用WinRAR打开该ZIP压缩包并访问良性文件时，WinRAR会错误地执行文件夹中的恶意代码。

**有效性：**
提供的POC代码描述了漏洞利用的原理，即构造包含同名良性文件和文件夹的ZIP压缩包。根据漏洞信息和搜索结果，此方法是有效的，并且在野外被利用。

**投毒风险：**
该POC本身描述了漏洞的利用方式，包含一个指向YouTube视频的链接，以及对恶意压缩包结构的描述。投毒风险较低，约为10%，因为：
1.  POC主要以描述性文字和图片链接为主。
2.  缺乏直接可执行的payload代码。
3.  作者可能通过YouTube链接传播恶意信息。

**利用方式：**
1.  攻击者创建一个恶意的ZIP压缩包。
2.  该压缩包包含一个良性文件（例如JPG，PDF等）和一个与该文件同名的文件夹。
3.  恶意代码（例如，可执行文件）放置在同名文件夹中。
4.  攻击者诱骗用户使用WinRAR打开这个ZIP压缩包，并尝试访问良性文件。
5.  WinRAR在处理压缩包时，会错误地执行同名文件夹中的恶意代码，从而导致远程代码执行。

**项目地址:** [h3xecute/SideCopy-Exploits-CVE-2023-38831](https://github.com/h3xecute/SideCopy-Exploits-CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #15

**来源**: [CVE-2023-38831-idkwastaken_CVE-2023-38831.md](../2023/CVE-2023-38831-idkwastaken_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意的ZIP文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的漏洞。该漏洞的利用方式是创建一个特制的ZIP文件，其中包含一个良性文件和一个同名文件夹。当用户尝试使用WinRAR打开ZIP文件并访问该良性文件时，WinRAR会错误地执行该同名文件夹中的恶意代码，导致远程代码执行。

**有效性：**
提供的POC代码（exploit.c）利用了该漏洞。该代码生成一个ZIP文件，其中包含一个PDF文件（document.pdf）和一个名为“document.pdf\”的文件夹，该文件夹内包含一个恶意的批处理脚本（script.bat）。当用户在易受攻击的WinRAR版本中打开并尝试访问该PDF文件时，WinRAR将执行该批处理脚本。
checker.bat 是用来检测目标系统是否安装WinRAR，以及WinRAR的版本是否是受影响的版本。
exploit.ps1 看起来不完整，但是其作用应该是检查WinRAR版本。

**投毒风险：**
代码中存在一定的投毒风险，约为10%。原因如下：
*   **脚本内容可控：** exploit.c 中的script_content变量包含了要执行的命令，虽然当前POC仅仅是弹窗，但是攻击者可以修改这个变量，执行任意命令，例如下载恶意软件，执行系统命令等。
*   **复杂的构建过程：** exploit.c 代码本身比较复杂，阅读和分析需要一定的时间和精力。攻击者可以利用这一点，在代码中隐藏不易察觉的恶意代码。
虽然有潜在的投毒风险，但当前代码的主要目的是演示漏洞利用，风险较低，作者没有明显的隐藏后门行为，恶意代码比较容易被发现。

**利用方式：**
1.  攻击者创建一个恶意的ZIP压缩包，其中包含：
    *   一个良性的文件（例如 document.pdf）。
    *   一个与良性文件同名的文件夹（例如 document.pdf/）。
    *   恶意代码位于同名文件夹中（例如 document.pdf/script.bat）。
2.  攻击者诱骗目标用户使用存在漏洞的 WinRAR 版本打开此 ZIP 压缩包。
3.  当用户尝试打开良性文件时，WinRAR 错误地执行同名文件夹中的恶意代码，从而导致任意代码执行。


**项目地址:** [idkwastaken/CVE-2023-38831](https://github.com/idkwastaken/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #16

**来源**: [CVE-2023-38831-imbyter_imbyter-WinRAR_CVE-2023-38831.md](../2023/CVE-2023-38831-imbyter_imbyter-WinRAR_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 6.23

**利用条件:** 用户使用受影响的WinRAR版本打开特制的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于WinRAR 6.23之前的版本中。攻击者可以构造一个恶意的ZIP压缩包，其中包含一个伪装成良性文件的文件（例如 .jpg），以及一个同名的文件夹。当用户尝试在 WinRAR 中查看该“良性文件”时，实际上会执行同名文件夹中的恶意代码（例如 .cmd 或 .exe 文件）。

**有效性：**
根据漏洞信息和搜索结果，提供的POC代码是有效的。该POC利用了WinRAR处理ZIP压缩包时存在的逻辑漏洞，能够实现远程代码执行。

**投毒风险：**
提供的Python脚本 `make-poc.py` 用于生成POC压缩包，其本身的代码逻辑相对简单，主要功能是将指定的文件和脚本打包成特定的ZIP格式，并进行一些字符串替换以触发漏洞。主要风险在于脚本生成的POC包中包含的脚本，如果这个脚本是恶意的，那么整个利用过程就存在投毒风险。 仓库中的README.md文件里的测试脚本就是一个关闭计算机的脚本。代码本身存在一定的投毒风险.

*   脚本逻辑：脚本的功能是创建包含漏洞利用结构的RAR文件。
*   恶意操作：如果脚本被修改以包含下载和执行恶意软件的逻辑，那么用户在使用此脚本创建RAR文件时，就会受到投毒攻击。

**利用方式：**
1.  攻击者使用 `make-poc.py` 脚本构造恶意的ZIP压缩包，需要提供一个“良性”文件和一个恶意脚本。
2.  攻击者将恶意的ZIP压缩包发送给受害者。
3.  受害者使用受影响的WinRAR版本打开该ZIP压缩包，并尝试查看伪装的“良性”文件。
4.  WinRAR错误地执行了与“良性”文件同名的文件夹中的恶意脚本，导致远程代码执行。

**防御措施：**
*   升级WinRAR到6.23或更高版本。
*   谨慎打开来源不明的ZIP压缩包。
*   使用杀毒软件扫描ZIP压缩包。

**项目地址:** [imbyter/imbyter-WinRAR_CVE-2023-38831](https://github.com/imbyter/imbyter-WinRAR_CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #17

**来源**: [CVE-2023-38831-kehrijksen_CVE-2023-38831.md](../2023/CVE-2023-38831-kehrijksen_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 需要用户解压特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个恶意的 ZIP 压缩包，其中包含一个伪装成普通文件的文件和一个同名的文件夹。当用户尝试在 WinRAR 中查看该“普通文件”时，WinRAR 会错误地执行同名文件夹中的内容，从而导致任意代码执行。

**有效性：**
提供的 PoC 代码 `poc.py` 能够生成利用此漏洞的恶意 ZIP 压缩包。该脚本首先创建一个包含恶意 payload (例如 script.bat) 和良性文件 (例如 pepe.jpg) 的目录结构。然后，它将此目录结构压缩成 ZIP 文件，并修改 ZIP 文件中的文件名，以触发漏洞。`script.bat` 的作用是在 `%TEMP%` 目录下提取 ZIP 文件内容，运行良性文件作为诱饵，然后执行恶意操作，例如创建一个包含 “hacked” 内容的文本文件并使用记事本打开。

**投毒风险：**
分析提供的代码，没有发现明显的投毒代码。`poc.py` 的作用是生成恶意 ZIP 文件，而 `script.bat` 包含的是恶意行为的代码，例如运行良性文件，创建 `hacked.txt` 等。这些行为是漏洞利用的一部分，而不是隐藏的恶意代码。虽然利用 `script.bat` 可以执行任意操作，但这属于漏洞利用的范畴，而非代码投毒。

**利用方式：**
1.  攻击者使用 `poc.py` 脚本生成一个恶意的 ZIP 压缩包，其中包含一个良性文件（例如图片）和一个同名的文件夹。
2.  攻击者将此恶意 ZIP 压缩包发送给受害者。
3.  受害者使用 WinRAR (6.23 之前的版本) 打开并尝试查看 ZIP 压缩包中的良性文件。
4.  WinRAR 错误地执行与良性文件同名的文件夹中的内容 (由 `script.bat` 控制)。
5.  `script.bat` 首先将 ZIP 文件的内容解压到临时目录。
6.  `script.bat` 运行良性文件（例如图片）作为诱饵，以迷惑受害者。
7.  `script.bat` 执行任意恶意操作，例如创建文件，修改注册表，安装恶意软件等。


**项目地址:** [kehrijksen/CVE-2023-38831](https://github.com/kehrijksen/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #18

**来源**: [CVE-2023-38831-khanhtranngoccva_cve-2023-38831-poc.md](../2023/CVE-2023-38831-khanhtranngoccva_cve-2023-38831-poc.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。该漏洞源于WinRAR处理ZIP压缩包时，对文件名和文件夹名区分不当。攻击者可以创建一个ZIP压缩包，其中包含一个良性文件（例如JPG）和一个同名的文件夹。该文件夹中包含恶意可执行文件。当用户尝试在WinRAR中打开该良性文件时，WinRAR会错误地执行文件夹中的恶意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已在野外被利用，证明了其有效性。提供的POC代码片段（package-lock.json）显示使用了jszip库，表明该POC可能用于创建恶意的ZIP压缩包，进一步验证漏洞的可利用性。

**投毒风险：**
提供的POC代码片段是`package-lock.json`文件，主要描述了项目依赖。要判断是否存在投毒风险，需要检查实际的利用代码（例如 index.ts/index.js）。
*   这个`package-lock.json`文件本身不包含恶意代码，只是依赖声明。
*   **风险点在于开发者可能在其他代码文件中（如index.ts等，此文件未提供）包含恶意代码**。
*   jszip 库本身是一个常用的 ZIP 文件操作库，被投毒的可能性较低。
*   tsx和typescript是typescript相关工具，本身被投毒的可能性也比较低

由于缺乏实际的利用代码，无法确定是否存在投毒行为，只能根据现有信息进行推测，因此将投毒风险评估为10%。

**利用方式：**
1.  攻击者构造一个恶意的ZIP压缩包。
2.  该ZIP压缩包包含一个良性文件（例如JPG）和一个同名的文件夹。
3.  该文件夹中包含恶意可执行文件（例如EXE、BAT、CMD等）。
4.  攻击者诱骗用户使用受影响的WinRAR版本打开该ZIP压缩包。
5.  用户尝试在WinRAR中打开该良性文件。
6.  WinRAR错误地执行文件夹中的恶意代码，导致远程代码执行。

**项目地址:** [khanhtranngoccva/cve-2023-38831-poc](https://github.com/khanhtranngoccva/cve-2023-38831-poc)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #19

**来源**: [CVE-2023-38831-kuyrathdaro_winrar-cve-2023-38831.md](../2023/CVE-2023-38831-kuyrathdaro_winrar-cve-2023-38831.md)

## CVE-2023-38831-WinRAR代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个代码执行漏洞。该漏洞的利用方式如下：

1.  攻击者创建一个恶意的ZIP压缩包（伪装成RAR格式，后缀名为.rar）。
2.  该压缩包包含一个良性的文件（例如，document.pdf），以及一个与该良性文件同名的文件夹（例如，document.pdf）。
3.  同名文件夹中包含恶意payload（例如，一个.bat或.exe文件），命名为`document.pdfA.cmd`。
4.  用户使用存在漏洞的WinRAR版本打开该压缩包，并尝试打开良性文件（document.pdf）。
5.  由于WinRAR处理文件名的缺陷，实际上执行的是同名文件夹中的恶意payload。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以判断该漏洞PoC有效。搜索引擎结果中多个链接表明该漏洞已被广泛利用，并且Google的威胁分析小组也分析了利用该漏洞进行的攻击活动。提供的PoC代码实现了生成恶意RAR压缩包的逻辑，进一步验证了该漏洞的可利用性。

**投毒风险：**

PoC代码本身的主要功能是生成利用CVE-2023-38831漏洞的恶意压缩包。然而，我们仍然需要评估该代码是否存在潜在的投毒风险。以下是对代码的分析：

*   **代码功能明确：** PoC代码的功能是生成特定的文件结构和内容，以触发WinRAR漏洞。代码逻辑相对简单，易于理解。
*   **输入/输出控制：** PoC代码接受三个输入参数：良性文件、Payload文件和输出文件名。这三个参数都由用户指定，PoC本身没有主动下载或执行任何其他代码的功能。
*   **潜在风险点：** `exploit.py` 脚本使用 `shutil.copyfile` 函数来复制 payload 文件到临时目录，如果payload 文件本身就是恶意的，那么这也会造成风险。此外，尽管脚本尝试确保输出文件以 `.rar` 结尾，但恶意用户可能修改此行为。
*   **间接风险：** 如果攻击者修改了提供的 `exploit.py` 脚本，添加额外的恶意功能（例如，在生成恶意压缩包后，自动上传到恶意服务器），则可能存在投毒风险。但是，这并非原始PoC代码本身的问题。

综合来看，原始PoC代码本身存在直接投毒的风险较低，我估计的投毒风险概率为 **10%**。这主要是因为恶意 payload 本身会带来风险，但 PoC 代码并没有主动引入恶意行为。

**利用方式：**

1.  准备一个良性的文件（例如，document.pdf）和一个恶意payload（例如，script.bat或malware.exe）。
2.  运行PoC脚本，指定良性文件、payload文件和输出文件名。
3.  PoC脚本生成一个恶意的RAR压缩包（实际上是ZIP格式，但后缀名为.rar）。
4.  将该恶意RAR压缩包发送给目标用户。
5.  目标用户使用存在漏洞的WinRAR版本打开该压缩包，并尝试打开良性文件。
6.  WinRAR执行同名文件夹中的恶意payload，从而实现代码执行。


**项目地址:** [kuyrathdaro/winrar-cve-2023-38831](https://github.com/kuyrathdaro/winrar-cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #20

**来源**: [CVE-2023-38831-malvika-thakur_CVE-2023-38831.md](../2023/CVE-2023-38831-malvika-thakur_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以通过创建一个特制的 ZIP 压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹，文件夹中包含恶意可执行文件。当用户尝试在 WinRAR 中查看该良性文件时，由于 WinRAR 处理逻辑的缺陷，会错误地执行文件夹中的恶意代码，从而导致远程代码执行。

**有效性：**

提供的 POC 代码 `poc.py`  可以生成利用此漏洞的 ZIP 文件。代码首先检查恶意脚本和良性文件是否存在，然后创建一个目录，将脚本和良性文件复制到特定结构中，最后将该目录压缩成 ZIP 文件。用户只需双击压缩包内的良性文件即可触发漏洞，执行恶意脚本。因此，POC 代码有效。

**投毒风险：**

分析提供的 `poc.py` 代码，没有发现明显的投毒代码。该脚本的主要功能是生成利用 CVE-2023-38831 漏洞的恶意 ZIP 文件。它需要用户提供恶意脚本和良性文件，然后按照特定目录结构进行组织并压缩。代码中没有发现任何会执行额外恶意操作的逻辑。`README.md` 文件也仅包含漏洞描述和使用说明，没有发现恶意内容。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者创建一个包含良性文件（如 JPG 图片）和一个同名文件夹的 ZIP 压缩包。
2.  该文件夹中包含恶意可执行文件（如 BAT 脚本）。
3.  攻击者将该 ZIP 压缩包发送给目标用户。
4.  目标用户使用受影响的 WinRAR 版本打开该 ZIP 压缩包。
5.  目标用户双击 ZIP 压缩包中的良性文件。
6.  WinRAR 错误地执行同名文件夹中的恶意可执行文件，导致远程代码执行。

**项目地址:** [malvika-thakur/CVE-2023-38831](https://github.com/malvika-thakur/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #21

**来源**: [CVE-2023-38831-r1yaz_winDED.md](../2023/CVE-2023-38831-r1yaz_winDED.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开特制的恶意 ZIP 压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 是 WinRAR 在处理 ZIP 压缩文件时存在的远程代码执行漏洞。当 WinRAR 版本低于 6.23 时，如果用户尝试打开一个包含恶意构造的 ZIP 文件，攻击者可以利用此漏洞执行任意代码。该 ZIP 文件包含一个良性文件（例如 JPG 文件）和一个与其同名的文件夹。攻击者可以将可执行文件放置在该文件夹中，当用户尝试访问良性文件时，WinRAR 会错误地执行文件夹中的可执行文件。

**有效性：**
提供的 POC 代码（winDED）通过生成恶意 ZIP 文件来演示漏洞利用。它创建了一个良性文件和一个同名文件夹，并将恶意脚本放入文件夹中。用户双击压缩包中的 PDF 文件时，实际上会执行该恶意脚本，从而证明漏洞的可利用性。

**投毒风险：**
根据提供的 POC 代码，投毒风险较低。代码主要是为了演示漏洞而设计的，虽然存在执行恶意 `super_sneaky_evil_script.bat` 的可能性，但该脚本本身是由用户提供的，或者可以通过查看代码本身来确认其行为。 然而，仍然存在一些细微的风险，例如，如果 `super_sneaky_evil_script.bat` 本身是从其他来源下载的，则可能包含恶意代码。  总的来说, 投毒风险约 10%。

**利用方式：**
1.  创建一个包含良性文件 (例如，`BILLION_DOLLAR_SECRET.pdf`) 和一个同名文件夹 (`BILLION_DOLLAR_SECRET.pdf`) 的 ZIP 压缩文件。
2.  将恶意脚本 (例如，`super_sneaky_evil_script.bat`) 放入同名文件夹中。
3.  诱骗目标用户使用 WinRAR 打开该 ZIP 文件。
4.  当用户尝试打开良性文件时，WinRAR 错误地执行同名文件夹中的恶意脚本，从而实现远程代码执行。

**项目地址:** [r1yaz/winDED](https://github.com/r1yaz/winDED)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #22

**来源**: [CVE-2023-38831-ra3edAJ_LAB-DFIR-cve-2023-38831.md](../2023/CVE-2023-38831-ra3edAJ_LAB-DFIR-cve-2023-38831.md)

## CVE-2023-38831-WinRAR代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 是 WinRAR 在 6.23 版本之前存在的远程代码执行漏洞。该漏洞源于WinRAR处理ZIP压缩包时，如果压缩包中包含一个良性文件和一个与该良性文件同名的文件夹，WinRAR在尝试访问良性文件时，会错误地执行同名文件夹中的恶意内容。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的PoC是可用的。漏洞在野外被广泛利用，并且CISA已将其添加到已知被利用的漏洞目录中。

**投毒风险：**
提供的漏洞利用代码为一个Github仓库的README.md文件，主要描述了如何利用磁盘镜像调查CVE-2023-38831攻击，并通过Windows注册表、NTFS文件和浏览器缓存理解Windows事件序列。仓库本身目的是为了DFIR分析，因此直接包含恶意代码的可能性较低。但考虑到链接跳转至外部教程网站，存在间接投毒的可能，即教程内容可能包含引导至恶意软件下载或运行恶意脚本的指令。因此，投毒风险较低，评估为10%。

**利用方式：**
1.  **创建恶意的ZIP压缩包：** 压缩包中包含一个良性文件（如JPG图片）和一个与该良性文件同名的文件夹。
2.  **将恶意可执行文件放入同名文件夹：** 该文件夹中的可执行文件会在用户尝试打开良性文件时被执行。
3.  **诱导用户打开ZIP压缩包：** 通过社交工程或其他方式，诱导用户使用受影响版本的WinRAR打开该压缩包。
4.  **触发漏洞执行恶意代码：** 当用户尝试查看ZIP压缩包中的良性文件时，WinRAR会错误地执行同名文件夹中的恶意代码，从而实现远程代码执行。

**总结：**
该漏洞利用方式较为简单，易于传播，危害较大。用户应及时更新WinRAR至最新版本，避免打开来源不明的ZIP压缩包。

**项目地址:** [ra3edAJ/LAB-DFIR-cve-2023-38831](https://github.com/ra3edAJ/LAB-DFIR-cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #23

**来源**: [CVE-2023-38831-ruycr4ft_CVE-2023-38831.md](../2023/CVE-2023-38831-ruycr4ft_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的远程代码执行漏洞。该漏洞源于WinRAR在处理ZIP压缩包时，对文件名和文件夹名相同的情况处理不当。攻击者可以构造一个恶意的ZIP压缩包，其中包含一个看似无害的文件（例如.jpg），同时包含一个同名的文件夹。当用户尝试打开该“无害文件”时，WinRAR会错误地执行同名文件夹中的恶意代码。\n\n**有效性：** 根据漏洞信息、搜索结果以及提供的POC代码，该漏洞利用是有效的。多个来源都表明该漏洞已被广泛利用，POC代码也展示了如何生成包含恶意代码的RAR压缩文件。POC代码通过创建同名文件和文件夹，并在文件夹中放入恶意脚本，利用WinRAR的缺陷触发代码执行。\n\n**投毒风险：**  仓库的投毒风险较低，大概10%。
  *   `poc.py`: 该脚本的功能是生成利用 CVE-2023-38831 的恶意 RAR 文件。虽然它允许用户指定 bait 文件和脚本文件，但脚本本身不包含任何预设的、隐藏的恶意行为。
  *   `script.bat`:  这个批处理文件包含使用 `nc.exe` (netcat) 反弹 shell 的命令。**这里存在一定的投毒风险。** 批处理文件明确地使用了`192.168.0.107`这个IP地址,如果用户直接使用该IP反弹shell,将会连接到攻击者的服务器。虽然IP地址可以被用户更改，但在默认情况下，如果用户不修改，将会连接到攻击者的IP。这是主要的投毒点。
  *   README.md: 该文件仅包含漏洞的简单介绍和演示图片。没有发现恶意代码。

**利用方式：**\n1.  攻击者创建一个恶意的ZIP压缩包。该压缩包包含一个诱饵文件（例如图片.jpg）和一个与其同名的文件夹（例如图片.jpg）。\n2.  攻击者将恶意代码（例如一个批处理脚本或可执行文件）放入同名文件夹中。\n3.  攻击者将包含恶意代码的ZIP压缩包发送给受害者。\n4.  受害者使用存在漏洞的WinRAR版本打开该ZIP压缩包，并尝试打开诱饵文件。\n5.  WinRAR错误地执行同名文件夹中的恶意代码，导致远程代码执行。

**项目地址:** [ruycr4ft/CVE-2023-38831](https://github.com/ruycr4ft/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #24

**来源**: [CVE-2023-38831-s4m98_winrar-cve-2023-38831-poc-gen.md](../2023/CVE-2023-38831-s4m98_winrar-cve-2023-38831-poc-gen.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开恶意的ZIP/RAR压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于WinRAR处理ZIP压缩文件时，由于对文件名和文件夹名处理不当导致。攻击者可以构造一个包含恶意脚本的ZIP压缩文件，该压缩文件包含一个正常的诱饵文件（如PDF、PNG或JPG）和一个同名的文件夹，当用户尝试打开诱饵文件时，WinRAR会错误地执行该文件夹中的恶意脚本。

**有效性：**
根据漏洞信息、搜索引擎结果和漏洞利用代码，该POC代码有效。漏洞库信息表明该漏洞已被野外利用。搜索引擎结果中也包含了大量关于此漏洞的分析和利用报告，证实了该漏洞的有效性。POC代码的描述和实现也符合漏洞的利用方式，通过生成包含恶意脚本和诱饵文件的RAR压缩包来触发漏洞。

**投毒风险：**
代码本身看起来比较直接，主要是生成利用漏洞的压缩包。`script.bat` 这个文件需要额外注意。当前提供的 `script.bat` 只是打开了计算器 `calc.exe` 和 Web_Security.pdf,相对来说是安全的，但用户在使用该漏洞时，完全可以修改此文件，添加更加恶意的payload，具有一定的风险。作者在代码中没有明显投毒行为，主要风险在于用户如何使用该工具生成payload。
投毒风险评估：10% (主要是用户修改 `script.bat` 的风险)

**利用方式：**
1.  **构造恶意ZIP/RAR压缩文件：** 利用提供的Python脚本（cve-2023-38831-exp-gen.py）生成恶意的ZIP/RAR压缩文件。此脚本需要一个诱饵文件（如PDF、PNG、JPG）和一个恶意脚本文件（如BAT、CMD、或可执行文件）。该脚本会创建一个包含诱饵文件和一个同名文件夹的压缩包，并将恶意脚本放置在该文件夹中。
2.  **诱骗用户打开压缩文件：**  将生成的恶意ZIP/RAR压缩文件发送给目标用户。
3.  **执行恶意代码：** 当用户使用受影响的WinRAR版本打开压缩文件并尝试查看诱饵文件时，WinRAR会错误地执行同名文件夹中的恶意脚本，从而实现远程代码执行。

 总体来说，该漏洞利用方式较为简单，攻击成本较低，风险较高。

**项目地址:** [s4m98/winrar-cve-2023-38831-poc-gen](https://github.com/s4m98/winrar-cve-2023-38831-poc-gen)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #25

**来源**: [CVE-2023-38831-solomon12354_VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC.md](../2023/CVE-2023-38831-solomon12354_VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要解压恶意的ZIP/RAR压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 存在于 WinRAR 6.23 之前版本中。攻击者可以构造一个包含良性文件和同名文件夹的 ZIP 压缩包，当用户尝试访问良性文件时，WinRAR 会错误地执行同名文件夹中的恶意代码。提供的 `exploit.py` 脚本可以用于生成包含漏洞利用的RAR压缩文件。脚本首先要求输入良性文件（`bait_file`）、恶意脚本文件（`script_file`）和输出RAR文件名称。然后，它创建一个临时目录，将恶意脚本复制到与良性文件同名的目录中，并将良性文件复制到临时目录中。最后，使用 `shutil.make_archive` 函数将临时目录压缩成 ZIP 文件，并修改 ZIP 文件的内容，将目录名中的 'A' 和 'B' 替换为空格，从而绕过 WinRAR 的安全检查。最终，将修改后的 ZIP 文件重命名为 RAR 文件。

`squid.bat` 用于下载并执行 `volleysquid.exe`。`volleyballsquid.py` 尝试利用 BypassUAC 来提升权限并将程序设置为开机自启。

**有效性:** 根据漏洞信息和利用代码分析，提供的 POC 代码有效，可以利用此漏洞在受害者机器上执行任意代码。

**投毒风险:** 仓库中存在一定的投毒风险，虽然主要功能是利用CVE-2023-38831漏洞，但是 `volleyballsquid.py`和`squid.bat`文件中的行为具有恶意性，特别是`volleyballsquid.py`中尝试使用`BypassUAC`绕过用户账户控制并持久化安装，这可能被用于安装后门或恶意软件。虽然主要目的是展示漏洞，但客观上存在后门功能，因此投毒风险占比为10%。

**利用方式:** 攻击者首先利用 `exploit.py` 脚本生成包含恶意代码的RAR压缩文件。然后，诱骗用户下载并使用 WinRAR 解压此文件。当用户尝试打开压缩包中的“良性”文件时，实际上会执行隐藏在同名目录中的恶意脚本 (例如 `squid.bat`)，下载并执行恶意程序。

根据搜索结果，CVE-2023-38831 漏洞已被广泛利用，并且已被政府背景的攻击者使用，这进一步验证了漏洞的严重性和 POC 代码的有效性。

**项目地址:** [solomon12354/VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC](https://github.com/solomon12354/VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #26

**来源**: [CVE-2023-38831-technicalcorp0_CVE-2023-38831-Exploit.md](../2023/CVE-2023-38831-technicalcorp0_CVE-2023-38831-Exploit.md)

## CVE-2023-38831-WinRAR-任意代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 任意代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个漏洞，该漏洞允许攻击者通过特制的ZIP档案执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** 当WinRAR尝试访问ZIP归档中的良性文件时，如果存在与该良性文件同名的文件夹，WinRAR会处理该文件夹的内容（可能包含可执行内容）。
2.  **利用方式：**
    *   攻击者创建一个恶意的ZIP档案，该档案包含一个良性文件（例如.JPG文件）和一个与该良性文件同名的文件夹。
    *   该文件夹包含恶意可执行文件。
    *   当受害者尝试在WinRAR中查看良性文件时，WinRAR会执行该文件夹中的恶意代码。
3.  **POC有效性：** 提供的POC代码 (CVE-2023-38831-WinRar-Exploit.py) 的目的是生成包含利用此漏洞的恶意 ZIP 文件。根据代码逻辑和漏洞原理，该 POC 可以有效利用该漏洞。
4.  **投毒风险：** 经过对POC代码的分析，发现代码本身实现了漏洞利用过程，但同时也存在一定的投毒风险。`clean_up()`函数会删除临时文件，但不能保证完全清除所有痕迹。攻击者可能通过修改代码，在生成恶意 ZIP 文件后，在目标系统上留下后门或执行其他恶意操作。考虑到实际利用场景中可能存在的恶意修改，投毒风险估计为5%。 主要风险点在于，虽然POC主要目的是生成exploit，但如果恶意人员修改，完全可以添加其他恶意payload，并伪装成CVE-2023-38831的POC进行传播。
5. **搜索引擎结果:** 搜索引擎结果表明此漏洞已被广泛利用，包括政府背景的黑客组织。 多个安全厂商发布了相关的分析和防御措施。

**项目地址:** [technicalcorp0/CVE-2023-38831-Exploit](https://github.com/technicalcorp0/CVE-2023-38831-Exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #27

**来源**: [CVE-2023-38831-xk-mt_WinRAR-Vulnerability-recurrence-tutorial.md](../2023/CVE-2023-38831-xk-mt_WinRAR-Vulnerability-recurrence-tutorial.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。该漏洞允许攻击者通过构造恶意的ZIP压缩包，在用户尝试查看压缩包内的文件时执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，该漏洞已被广泛利用，POC代码的存在也表明其有效性。多个安全厂商和研究人员都对此漏洞进行了分析并提供了相应的缓解措施。

**投毒风险分析：**
提供的POC代码包含以下文件：
*   `README.md`: 漏洞复现教程，包含漏洞信息和参考链接。
*   `执行命令.bat`: 一个简单的批处理文件，用于执行`calc.exe`（计算器程序），用于演示代码执行。
*   `文本.txt`: 包含一个URL地址。
*   `生成压缩包.py`: 一个Python脚本，用于生成包含漏洞的ZIP压缩包。

该脚本的主要功能是：
1.  创建临时目录，并将`执行命令.bat`复制到该目录。
2.  复制`文本.txt`文件到另一个目录。
3.  将上述两个目录打包成ZIP文件。
4.  修改ZIP文件中的文件名，利用漏洞的原理。
从代码本身来看，该脚本并没有明显的恶意代码，但是存在一定的投毒风险。
*   执行命令.bat： 虽然只是简单的calc.exe，但如果攻击者替换成其他恶意命令，则可能造成更大的危害。
*   脚本的依赖： 该脚本依赖Python环境，攻击者可能会通过修改脚本，引入恶意的Python依赖包，从而实现投毒。

综合来看，该仓库中存在一定的投毒风险，但不高。主要是因为演示的`执行命令.bat`内容比较简单，容易被识别。如果使用者直接运行此仓库的代码，有可能会被植入恶意程序。因此，投毒风险评定为10%。

**利用方式：**
1.  攻击者构造一个恶意的ZIP压缩包，该压缩包包含一个良性文件（例如，图片文件`文本.txt`）和一个与该文件同名的文件夹。
2.  该文件夹包含一个恶意可执行文件（例如，`执行命令.bat`并更名为`文本.txtA.cmd`）。
3.  当用户使用受影响的WinRAR版本打开该ZIP压缩包，并尝试查看良性文件时，WinRAR会错误地执行该文件夹中的恶意可执行文件，从而导致任意代码执行。

**项目地址:** [xk-mt/WinRAR-Vulnerability-recurrence-tutorial](https://github.com/xk-mt/WinRAR-Vulnerability-recurrence-tutorial)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #28

**来源**: [CVE-2023-38831-yezzfusl_cve_2023_38831_scanner.md](../2023/CVE-2023-38831-yezzfusl_cve_2023_38831_scanner.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开恶意的 ZIP 压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以通过构造一个特殊的 ZIP 压缩文件来利用此漏洞。该 ZIP 文件包含一个良性文件（例如 JPG）和一个同名的文件夹。当用户尝试访问良性文件时，WinRAR 会错误地执行文件夹中的恶意代码，导致远程代码执行。

**利用方式：**
1.  攻击者创建一个包含良性文件和同名文件夹的恶意 ZIP 文件。
2.  文件夹中包含要执行的恶意代码（例如，可执行文件）。
3.  攻击者诱使用户使用 WinRAR 打开该 ZIP 文件。
4.  当用户尝试访问良性文件时，WinRAR 会执行文件夹中的恶意代码。

**有效性：**
根据漏洞描述和搜索结果，该漏洞已在野外被利用，因此提供的PoC代码如果能够重现该行为，则可以认为是有效的。

**投毒风险：**
提供的代码仓库 `cve_2023_38831_scanner` 本身是一个漏洞扫描器，而非漏洞利用的PoC。尽管如此，仍然存在一定的投毒风险。代码中可能隐藏后门，虽然其主要功能是扫描，但理论上存在被篡改的风险。代码中使用了网络数据包分析、进程内存扫描、沙箱环境执行等模块，这些模块如果被恶意修改，可能被用于执行恶意操作。因此，综合考虑其扫描器的性质和潜在风险，投毒风险估计为10%。这个风险主要来自供应链投毒，如果下载了被篡改过的扫描器，那么扫描器本身可能成为攻击的一部分。

**项目地址:** [yezzfusl/cve_2023_38831_scanner](https://github.com/yezzfusl/cve_2023_38831_scanner)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #29

**来源**: [CVE-2023-38831-youmulijiang_evil-winrar.md](../2023/CVE-2023-38831-youmulijiang_evil-winrar.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 50%

## 详情

CVE-2023-38831是WinRAR在6.23版本之前存在的一个远程代码执行漏洞。该漏洞的利用方式是构造一个特殊的ZIP压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹。当用户尝试在WinRAR中查看该良性文件时，WinRAR会错误地执行该文件夹中的恶意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认该漏洞是有效的，并且已经在野外被利用。漏洞利用代码提供了一个框架，用于生成包含恶意payload的ZIP压缩包，从而实现远程代码执行。

**投毒风险分析：**
提供的代码是一个框架，用于生成漏洞利用的 ZIP 文件，包含生成 exp，邮件发送，下载链接生成等功能。代码中存在潜在的投毒风险，主要体现在以下几个方面：

1.  **Payload 植入:**  该框架可以自定义payload，如果用户在不了解 payload 内容的情况下使用，可能运行恶意指令。
2.  **代码可信度:** 虽然作者声明为安全开发成员，并开源了代码，但代码的安全性仍然需要进一步审计。存在作者预留后门的可能性。 考虑到这是一个漏洞利用框架，其本质就是为了执行恶意代码，所以判定为投毒代码的风险为50%。

**漏洞利用方式：**

1.  攻击者使用该漏洞利用框架(evil-winrar)生成一个恶意的 ZIP 压缩包。
2.  该 ZIP 压缩包包含一个良性文件（如JPG图片）和一个同名的文件夹，文件夹中包含恶意可执行文件。
3.  攻击者通过社会工程学等方式诱骗用户使用存在漏洞的 WinRAR 版本打开该 ZIP 压缩包。
4.  用户尝试查看良性文件时，WinRAR 会错误地执行同名文件夹中的恶意代码。
5.  恶意代码在用户系统上执行，攻击者从而实现远程代码执行，控制受害者的计算机。

**项目地址:** [youmulijiang/evil-winrar](https://github.com/youmulijiang/evil-winrar)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---



---

## POC #3

**来源**: [CVE-2023-38831-MaorBuskila_Windows-X64-RAT.md](../2023/CVE-2023-38831-MaorBuskila_Windows-X64-RAT.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者在用户尝试查看 ZIP 压缩包中的良性文件时执行任意代码。该漏洞源于 WinRAR 处理 ZIP 压缩包时，允许压缩包包含一个良性文件（例如 .JPG）和一个同名文件夹。当用户尝试访问该良性文件时，WinRAR 实际上会处理同名文件夹中的内容，从而允许攻击者在文件夹中放置恶意可执行文件并执行。

**有效性：**
从搜索结果和漏洞库信息来看，该漏洞已经被广泛利用，PoC 代码的存在也进一步验证了其有效性。

**投毒风险：**
提供的 Python 脚本 (`51721.py`) 用于生成 Windows x64 平台的反向 TCP Shellcode。该脚本本身不包含明显的恶意代码，功能是生成 shellcode。需要用户自行配置 IP 地址和端口。但是，由于该代码需要用户执行，并且可以生成任意 shellcode，存在一定投毒风险，例如，如果攻击者提供修改后的脚本，生成包含恶意功能的 shellcode (如删除文件，上传用户信息)，则用户可能无意中执行该恶意 shellcode. 脚本本身不包含网络连接或者其他与远程服务器通信的行为，可以基本判断代码仓库投毒风险较低.

**利用方式：**
1.  攻击者创建一个恶意的 ZIP 压缩包。
2.  该 ZIP 压缩包包含一个良性文件（例如 image.jpg）和一个同名文件夹（image.jpg）。
3.  同名文件夹包含恶意可执行文件，例如 exploit.exe，并可能包含一个 `.lnk` 文件，该快捷方式指向该恶意可执行文件。
4.  攻击者诱骗用户使用受影响版本的 WinRAR 打开该 ZIP 压缩包并尝试查看良性文件。
5.  WinRAR 错误地执行同名文件夹中的恶意可执行文件，从而导致远程代码执行。

**项目地址:** [MaorBuskila/Windows-X64-RAT](https://github.com/MaorBuskila/Windows-X64-RAT)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #4

**来源**: [CVE-2023-38831-MyStuffYT_CVE-2023-38831-POC.md](../2023/CVE-2023-38831-MyStuffYT_CVE-2023-38831-POC.md)

## CVE-2023-38831-WinRAR-远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的恶意ZIP压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个恶意的ZIP压缩文件，其中包含一个良性文件（例如.jpg）和一个同名的文件夹。当用户尝试在 WinRAR 中查看该良性文件时，WinRAR 会错误地执行该文件夹中的内容，从而导致任意代码执行。

**有效性：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。搜索引擎结果表明该漏洞已被广泛利用，POC代码的存在进一步证实了其有效性。

**投毒风险：**

根据对POC代码的分析，存在一定的投毒风险。`script.bat`脚本从github下载`Alert.exe`文件，这本身就存在一定的安全隐患，无法确保下载的文件一定是安全的。此外，脚本同时执行 `alert.exe` 和 `gtaleak.mp4`，而 `gtaleak.mp4` 在 README 中说明是 “zeros without ones”, 可以确定这是一个障眼法，实际的恶意行为是由 `alert.exe` 执行。 因此，作者可能隐藏了投毒代码。

**利用方式：**

1.  攻击者创建一个恶意的ZIP压缩文件，其中包含一个良性文件 (例如 `gtaleak.mp4`) 和一个同名的文件夹。
2.  该文件夹包含一个批处理脚本 (`script.bat`)，该脚本将从远程服务器下载并执行恶意程序 (`Alert.exe`)。
3.  当用户尝试使用 WinRAR 打开压缩文件并查看良性文件 (`gtaleak.mp4`) 时，WinRAR 会错误地执行批处理脚本。
4.  批处理脚本下载并执行恶意程序，从而允许攻击者在受害者的系统上执行任意代码。

**项目地址:** [MyStuffYT/CVE-2023-38831-POC](https://github.com/MyStuffYT/CVE-2023-38831-POC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #5

**来源**: [CVE-2023-38831-Nielk74_CVE-2023-38831.md](../2023/CVE-2023-38831-Nielk74_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本的代码执行漏洞。该漏洞允许攻击者在用户尝试查看ZIP存档中的看似无害的文件时执行任意代码。攻击者通过构造一个包含同名文件和文件夹的恶意ZIP文件，利用WinRAR处理文件路径时的逻辑缺陷，使得文件夹中的恶意可执行文件得以运行。提供的POC代码通过Vagrant自动化部署了一个易受攻击的WinRAR 6.22环境，并向虚拟机桌面添加了一个恶意的rar文件。该rar文件被设计为当用户点击其中的“无害”文件时，执行预先设定的恶意代码。尽管POC的主要目的是演示漏洞，但其中`ChocolateyInstall.ps1`脚本从外部源下载并安装软件包（Chocolatey和WinRAR），存在被篡改从而引入恶意代码的风险，这构成了潜在的投毒风险。虽然这个脚本很常见，但还是存在一定的风险，因此这里给出了10%的投毒风险。

**漏洞利用方式：**

1.  攻击者创建一个恶意的ZIP压缩包，其中包含一个看似无害的文件（例如.jpg），以及一个与该文件同名的文件夹。
2.  该文件夹包含恶意可执行文件，例如.exe或.cmd脚本。
3.  当用户尝试使用WinRAR打开ZIP压缩包并查看“无害”文件时，WinRAR会错误地执行同名文件夹中的恶意可执行文件，从而导致任意代码执行。
4.  攻击者可以利用此漏洞在受害者系统上安装恶意软件、窃取敏感数据或执行其他恶意操作。

**项目地址:** [Nielk74/CVE-2023-38831](https://github.com/Nielk74/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #6

**来源**: [CVE-2023-38831-RomainBayle08_CVE-2023-38831.md](../2023/CVE-2023-38831-RomainBayle08_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP或RAR压缩文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个特殊的 ZIP 压缩文件，该文件包含一个看似无害的文件（例如，.JPG 文件）和一个与该文件同名的文件夹。当用户尝试查看压缩文件中的无害文件时，WinRAR 会错误地执行文件夹中的内容，从而导致任意代码执行。

**有效性分析：**
提供的 POC 代码 `cve-2023-38831-exp-gen.py` 是一个漏洞利用生成器脚本，它接受诱饵文件 (`BAIT_NAME`)、脚本文件 (`SCRIPT_NAME`) 和额外的诱饵文件目录 (`BAIT_FILES`) 作为输入，并生成一个恶意 RAR 压缩文件 (`OUTPUT_NAME`)。脚本首先创建一个包含诱饵文件和脚本文件的临时目录结构，然后使用 `shutil.make_archive` 函数将该目录压缩为 ZIP 文件。关键在于，脚本会替换 ZIP 文件中特定文件的扩展名，利用 WinRAR 的漏洞，在用户尝试打开诱饵文件时执行脚本文件。`script.bat` 脚本会首先尝试打开诱饵文件（模拟用户行为），然后执行 `calc.exe`（作为漏洞利用成功的标志）。该 POC 的有效性较高，因为它模拟了真实的攻击场景。

**投毒风险分析：**
`cve-2023-38831-exp-gen.py` 脚本本身不包含明显的恶意代码或后门。但是，存在一定的投毒风险，因为该脚本允许攻击者指定要执行的任意脚本 (`SCRIPT_NAME`)。攻击者可以替换 `script.bat` 文件为包含恶意代码的文件，例如下载和执行其他恶意软件。此外，该脚本使用了`BAIT_FILES`参数，如果提供包含恶意文件的目录，也会构成投毒风险。所以存在一定投毒风险，但主要取决于用户提供的脚本和目录的内容。

**利用方式分析：**
1.  攻击者构造一个恶意 ZIP 压缩文件，其中包含一个诱饵文件（如 `CLASSIFIED_DOCUMENTS.pdf`）和一个与诱饵文件同名的文件夹。文件夹中包含一个脚本文件（如 `script.bat`）。
2.  攻击者将恶意 ZIP 文件发送给受害者，诱骗其使用 WinRAR 打开。
3.  当受害者尝试查看 ZIP 文件中的诱饵文件时，WinRAR 会错误地执行同名文件夹中的脚本文件。
4.  脚本文件执行任意代码，例如安装恶意软件或窃取敏感信息。

总的来说，该漏洞利用方式简单有效，风险较高。用户应尽快升级到 WinRAR 6.23 或更高版本。

**项目地址:** [RomainBayle08/CVE-2023-38831](https://github.com/RomainBayle08/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #7

**来源**: [CVE-2023-38831-RonF98_CVE-2023-38831-POC.md](../2023/CVE-2023-38831-RonF98_CVE-2023-38831-POC.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致任意代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831 是 WinRAR 在处理 ZIP 压缩文件时存在的一个漏洞。攻击者可以构造一个包含良性文件（例如 .jpg 文件）和一个同名文件夹的 ZIP 压缩包。该文件夹中包含恶意代码（例如 .cmd 文件）。当用户尝试查看良性文件时，WinRAR 会错误地执行文件夹中的恶意代码，从而导致远程代码执行。

**有效性：**

提供的 POC 代码有效，它演示了如何创建一个恶意的 RAR 文件来利用此漏洞。

*   `DoS.cmd` 文件包含恶意代码，用于创建多个消息框，模拟拒绝服务攻击。
*   `exploit.py` 脚本用于生成包含恶意 `DoS.cmd` 文件的 RAR 文件，并利用漏洞触发代码执行。
*   `README.md` 详细解释了漏洞原理和利用方法，并提供了攻击成功的截图。

**投毒风险：**

此仓库中可能存在轻微的投毒风险，约为5%。

*   `DoS.cmd` 只是一个简单的拒绝服务攻击示例，但攻击者可能会将其替换为更具破坏性的恶意代码，例如勒索软件或信息窃取程序。如果下载者不仔细检查 `DoS.cmd` 的内容，可能会在不知情的情况下运行恶意代码。
*   `exploit.py` 脚本本身没有明显的恶意代码，但它可以被修改以生成包含不同恶意代码的 RAR 文件。下载者应该仔细审查脚本的内容，确保它不会被用于传播恶意软件。

**利用方式：**

1.  攻击者创建一个包含良性文件（例如 `image.jpg`）和一个同名文件夹（例如 `image.jpg `）的 ZIP 压缩包。注意文件夹名称后面有一个空格。
2.  在同名文件夹中，攻击者放置恶意代码（例如 `image.jpg .cmd`）。
3.  攻击者将 ZIP 文件转换为 RAR 文件（POC 脚本完成了此过程）。
4.  攻击者诱骗用户使用受影响的 WinRAR 版本打开 RAR 文件并尝试查看良性文件（`image.jpg`）。
5.  WinRAR 错误地执行同名文件夹中的恶意代码 (`image.jpg .cmd`)，从而导致远程代码执行。

由于该漏洞被广泛利用，并且网上存在大量相关的 POC 代码，因此攻击者很容易发起攻击。


**项目地址:** [RonF98/CVE-2023-38831-POC](https://github.com/RonF98/CVE-2023-38831-POC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #8

**来源**: [CVE-2023-38831-SpamixOfficial_CVE-2023-38831.md](../2023/CVE-2023-38831-SpamixOfficial_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前的版本中的代码执行漏洞。攻击者可以制作一个特制的ZIP压缩包，其中包含一个良性文件和一个同名文件夹，文件夹中包含恶意可执行文件。当用户尝试在WinRAR中查看良性文件时，实际上会执行文件夹中的恶意代码。\n\n**有效性：**根据漏洞库信息、搜索结果和漏洞利用代码，该漏洞POC是有效的。漏洞库信息中明确指出该漏洞已在野外被利用。搜索结果中多个链接都指向了关于该漏洞的分析和利用报告。提供的`Cargo.lock`文件很可能只是rust项目依赖管理文件，无法直接证明POC的有效性，需配合rust源码进行分析。\n\n**投毒风险：**分析提供的`Cargo.lock`文件，该文件列出了Rust项目`CVE-2023-38831`的依赖项。虽然`Cargo.lock`本身不包含可执行代码，但是，如果恶意作者修改了依赖项的版本或来源，理论上存在引入被篡改过的crate（Rust包）的风险。不过，由于`Cargo.lock`文件明确指定了每个依赖项的checksum，Cargo在构建项目时会验证下载的crate是否与checksum匹配，从而降低了被投毒的风险。评估投毒风险为10%。\n\n**利用方式：**攻击者创建一个包含以下结构的ZIP压缩包：\n\n1.  一个良性的文件，例如 `image.jpg`\n2.  一个与良性文件同名的文件夹，例如 `image.jpg`\n3.  在同名文件夹中，放置恶意可执行文件，例如 `image.jpg.exe` 或 `image.jpg `(通过空格进行欺骗)。\n\n当用户使用存在漏洞的WinRAR版本打开该ZIP文件并尝试查看`image.jpg`时，WinRAR会错误地执行`image.jpg`文件夹中的恶意程序，从而实现远程代码执行。

**项目地址:** [SpamixOfficial/CVE-2023-38831](https://github.com/SpamixOfficial/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #9

**来源**: [CVE-2023-38831-Tolu12wani_Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution.md](../2023/CVE-2023-38831-Tolu12wani_Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在用户尝试查看 ZIP 压缩包中的文件时执行任意代码。

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开特制的 ZIP 压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者通过构造恶意的 ZIP 压缩包实现远程代码执行。该压缩包包含一个良性文件（例如 JPG）和一个与良性文件同名的文件夹。当用户尝试访问良性文件时，WinRAR 会错误地执行同名文件夹中的内容，从而执行攻击者放置的恶意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被广泛利用。 提供的POC代码描述的是在压缩文件中嵌入恶意payload，并触发反向shell的实验环境验证过程。虽然该代码本身没有包含恶意代码，但描述了如何构建利用该漏洞的压缩文件。

**投毒风险：**
提供的 POC 代码仓库中只包含 PDF 报告和截图，并没有可执行的恶意代码。 但是,README中说明了该仓库展示了恶意payload的嵌入方式，存在一定的潜在风险。 因此，存在一定的投毒风险，但风险较低。根据readme描述和文件结构，投毒风险评估为10%，

**利用方式：**
1.  **创建恶意 ZIP 压缩包：** 攻击者创建一个 ZIP 压缩包，其中包含一个良性文件（例如 JPG）和一个与良性文件同名的文件夹。
2.  **放置恶意代码：** 将恶意可执行文件放置在与良性文件同名的文件夹中。
3.  **诱骗用户：** 诱骗用户使用受影响的 WinRAR 版本打开该 ZIP 压缩包并尝试查看良性文件。
4.  **执行恶意代码：** WinRAR 错误地执行同名文件夹中的恶意代码，从而实现远程代码执行。

根据搜索结果，该漏洞已经被政府支持的攻击者利用，用于投放 RAT（远程访问木马）等恶意软件。

**项目地址:** [Tolu12wani/Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution](https://github.com/Tolu12wani/Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #10

**来源**: [CVE-2023-38831-VictoriousKnight_CVE-2023-38831_Exploit.md](../2023/CVE-2023-38831-VictoriousKnight_CVE-2023-38831_Exploit.md)

## CVE-2023-38831-WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码。

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的恶意ZIP文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个漏洞，它允许攻击者通过构造特殊的ZIP文件来执行任意代码。攻击者创建一个ZIP文件，其中包含一个良性文件（例如，JPG图片）和一个与该良性文件同名的文件夹。该文件夹中包含恶意可执行文件。当用户尝试在WinRAR中查看该良性文件时，WinRAR会错误地执行该文件夹中的恶意代码，从而导致远程代码执行。

**有效性：** 提供的POC代码是有效的。根据漏洞库信息和搜索结果，该漏洞在野外被广泛利用。POC代码通过创建包含良性文件和同名文件夹的恶意ZIP文件，并利用WinRAR处理文件时的缺陷来执行代码。POC代码结构清晰，易于理解和使用。

**投毒风险：** 提供的POC代码本身主要是利用漏洞生成EXP，但仔细检查代码，在`exploit.py`文件的zip文件内容操作部分被截断，没有展示修改zip文件内容的关键代码，作者可能在`Read and manipulate the zip file content`部分添加恶意代码，执行修改zip文件过程中的任何恶意行为。因此存在一定的投毒风险，根据代码完整度，我给出10%的投毒风险。

**利用方式：**
1.  攻击者创建一个恶意ZIP文件，其中包含一个看似无害的文件（例如，一个图片或PDF）。
2.  在ZIP文件中，攻击者同时创建一个与该无害文件同名的文件夹。
3.  该文件夹包含攻击者想要执行的恶意代码，通常是一个可执行文件或脚本。
4.  攻击者诱使用户使用存在漏洞的WinRAR版本打开该ZIP文件。
5.  当用户尝试访问ZIP文件中的“无害”文件时，WinRAR会错误地执行同名文件夹中的恶意代码。

**项目地址:** [VictoriousKnight/CVE-2023-38831_Exploit](https://github.com/VictoriousKnight/CVE-2023-38831_Exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #11

**来源**: [CVE-2023-38831-anelya0333_Exploiting-CVE-2023-38831.md](../2023/CVE-2023-38831-anelya0333_Exploiting-CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开特制的ZIP压缩文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞允许攻击者通过特制的ZIP压缩文件在目标系统上执行任意代码。该漏洞的根源在于WinRAR在处理包含与文件同名文件夹的ZIP文件时存在缺陷。攻击者可以构造一个 ZIP 文件，其中包含一个良性文件（例如.JPG）和一个与其同名的文件夹。当用户尝试在 WinRAR 中查看该良性文件时，WinRAR 会错误地执行该文件夹中的恶意代码。此PoC脚本生成一个ZIP文件，其中包含诱饵文件(bait file)和恶意脚本(script file)，并修改ZIP文件的文件头，以利用此漏洞。脚本创建与诱饵文件同名的文件夹，并将恶意脚本放入其中。然后，将诱饵文件的副本也放入ZIP文件中。通过替换文件名字段中的某些字符，WinRAR会将文件夹中的恶意文件误认为是要执行的文件，最终导致代码执行。由于代码仅仅是构造payload，不存在主动执行恶意代码，因此不存在投毒风险。

**项目地址:** [anelya0333/Exploiting-CVE-2023-38831](https://github.com/anelya0333/Exploiting-CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #12

**来源**: [CVE-2023-38831-b1tg_CVE-2023-38831-winrar-exploit.md](../2023/CVE-2023-38831-b1tg_CVE-2023-38831-winrar-exploit.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可导致完全系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开恶意构造的ZIP文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 允许攻击者通过特制的ZIP文件在受害者系统上执行任意代码。该漏洞源于 WinRAR 处理包含同名文件和文件夹的 ZIP 档案时的不当行为。攻击者可以创建一个 ZIP 文件，其中包含一个良性文件（例如 CLASSIFIED_DOCUMENTS.pdf）和一个同名文件夹（例如 CLASSIFIED_DOCUMENTS.pdf）。当用户尝试访问良性文件时，WinRAR 实际上会执行该文件夹中的内容（例如 script.bat）。

**有效性:**

提供的 POC 代码 `cve-2023-38831-exp-gen.py` 旨在生成利用此漏洞的恶意 RAR 档案。该脚本通过以下步骤工作：

1.  创建临时目录 `TEMPLATE`。
2.  在 `TEMPLATE` 中创建一个与bait文件同名的文件夹，并在其中存放包含恶意命令的script文件（例如 `script.bat`， 其中包含`calc.exe & CLASSIFIED_DOCUMENTS.pdf`）。
3.  将bait文件存放在`TEMPLATE`目录。
4.  将`TEMPLATE`目录压缩为zip文件。
5.  修改压缩包中文件和文件夹的名字，构造漏洞。
6.  最终输出 `CVE-2023-38831-poc.rar`。

该脚本能够有效地生成利用 CVE-2023-38831 的 RAR 文件，因此提供的 POC 代码是有效的。

**投毒风险:**

对提供的 POC 代码 (`cve-2023-38831-exp-gen.py` 和 `script.bat`) 进行分析后，未发现明显的恶意代码或后门。该脚本的功能明确且集中于生成利用 CVE-2023-38831 的 RAR 档案。 `script.bat` 的主要功能是启动计算器程序 (`calc.exe`) 并尝试打开诱饵文档 (`CLASSIFIED_DOCUMENTS.pdf`)，这是一个典型的 PoC 行为。 因此，该仓库中存在作者隐藏的投毒代码的风险极低。

**利用方式:**

1.  攻击者使用 `cve-2023-38831-exp-gen.py` 脚本，指定诱饵文件（例如 `CLASSIFIED_DOCUMENTS.pdf`）和恶意脚本（例如 `script.bat`），生成恶意 RAR 档案。
2.  攻击者通过各种方式（例如，电子邮件、恶意网站）将恶意 RAR 档案分发给受害者。
3.  受害者使用易受攻击的 WinRAR 版本（< 6.23）打开恶意 RAR 档案。
4.  当受害者尝试访问诱饵文件时，WinRAR 错误地执行了同名文件夹中的恶意脚本。
5.  恶意脚本在受害者系统上执行任意代码，例如启动计算器或安装恶意软件。

**项目地址:** [b1tg/CVE-2023-38831-winrar-exploit](https://github.com/b1tg/CVE-2023-38831-winrar-exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #13

**来源**: [CVE-2023-38831-elefantesagradodeluzinfinita_cve-2023-38831.md](../2023/CVE-2023-38831-elefantesagradodeluzinfinita_cve-2023-38831.md)

## CVE-2023-38831 - WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用 WinRAR 打开特制的 ZIP 压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者通过特制的 ZIP 压缩包在受害者系统上执行任意代码。漏洞利用方式是创建一个 ZIP 压缩包，其中包含一个良性文件（例如 .jpg 或 .pdf）以及一个同名的文件夹。该文件夹包含恶意的可执行文件（例如 .cmd 或 .exe）。当用户尝试打开良性文件时，WinRAR 会错误地执行文件夹中的恶意代码。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码分析，该漏洞确实存在并且已经被野外利用。提供的代码描述了一个利用工具 "DR. GANDALF"，它允许用户创建包含此漏洞的 ZIP 文件，表明POC的有效性。

**投毒风险：** 提供的 README.md 文件主要描述了漏洞原理和利用工具的使用方法。但是，由于此工具允许用户自定义注入的代码和二进制文件，因此存在投毒风险。如果用户下载了包含恶意注入代码的ZIP文件，那么这个工具本身可能被利用来传播恶意软件。评估投毒风险为 10%，因为该描述文件本身不包含可以直接执行的后门代码，但生成的ZIP文件可以包含。

**利用方式：**
1.  攻击者创建一个包含恶意 ZIP 压缩包。
2.  ZIP 压缩包中包含一个良性文件（例如，`image.jpg`）和一个同名的文件夹（例如，`image.jpg`）。
3.  `image.jpg` 文件夹包含恶意的可执行文件（例如，`evil.cmd`）。
4.  攻击者诱骗受害者使用存在漏洞的 WinRAR 版本打开该 ZIP 压缩包并尝试访问良性文件 `image.jpg`。
5.  WinRAR 在处理该 ZIP 文件时，会错误地执行 `image.jpg` 文件夹中的恶意代码 `evil.cmd`，从而导致远程代码执行。

**项目地址:** [elefantesagradodeluzinfinita/cve-2023-38831](https://github.com/elefantesagradodeluzinfinita/cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #14

**来源**: [CVE-2023-38831-h3xecute_SideCopy-Exploits-CVE-2023-38831.md](../2023/CVE-2023-38831-h3xecute_SideCopy-Exploits-CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个远程代码执行漏洞。该漏洞的利用方式是构造一个特殊的ZIP压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹。当用户尝试使用WinRAR打开该ZIP压缩包并访问良性文件时，WinRAR会错误地执行文件夹中的恶意代码。

**有效性：**
提供的POC代码描述了漏洞利用的原理，即构造包含同名良性文件和文件夹的ZIP压缩包。根据漏洞信息和搜索结果，此方法是有效的，并且在野外被利用。

**投毒风险：**
该POC本身描述了漏洞的利用方式，包含一个指向YouTube视频的链接，以及对恶意压缩包结构的描述。投毒风险较低，约为10%，因为：
1.  POC主要以描述性文字和图片链接为主。
2.  缺乏直接可执行的payload代码。
3.  作者可能通过YouTube链接传播恶意信息。

**利用方式：**
1.  攻击者创建一个恶意的ZIP压缩包。
2.  该压缩包包含一个良性文件（例如JPG，PDF等）和一个与该文件同名的文件夹。
3.  恶意代码（例如，可执行文件）放置在同名文件夹中。
4.  攻击者诱骗用户使用WinRAR打开这个ZIP压缩包，并尝试访问良性文件。
5.  WinRAR在处理压缩包时，会错误地执行同名文件夹中的恶意代码，从而导致远程代码执行。

**项目地址:** [h3xecute/SideCopy-Exploits-CVE-2023-38831](https://github.com/h3xecute/SideCopy-Exploits-CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #15

**来源**: [CVE-2023-38831-idkwastaken_CVE-2023-38831.md](../2023/CVE-2023-38831-idkwastaken_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意的ZIP文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的漏洞。该漏洞的利用方式是创建一个特制的ZIP文件，其中包含一个良性文件和一个同名文件夹。当用户尝试使用WinRAR打开ZIP文件并访问该良性文件时，WinRAR会错误地执行该同名文件夹中的恶意代码，导致远程代码执行。

**有效性：**
提供的POC代码（exploit.c）利用了该漏洞。该代码生成一个ZIP文件，其中包含一个PDF文件（document.pdf）和一个名为“document.pdf\”的文件夹，该文件夹内包含一个恶意的批处理脚本（script.bat）。当用户在易受攻击的WinRAR版本中打开并尝试访问该PDF文件时，WinRAR将执行该批处理脚本。
checker.bat 是用来检测目标系统是否安装WinRAR，以及WinRAR的版本是否是受影响的版本。
exploit.ps1 看起来不完整，但是其作用应该是检查WinRAR版本。

**投毒风险：**
代码中存在一定的投毒风险，约为10%。原因如下：
*   **脚本内容可控：** exploit.c 中的script_content变量包含了要执行的命令，虽然当前POC仅仅是弹窗，但是攻击者可以修改这个变量，执行任意命令，例如下载恶意软件，执行系统命令等。
*   **复杂的构建过程：** exploit.c 代码本身比较复杂，阅读和分析需要一定的时间和精力。攻击者可以利用这一点，在代码中隐藏不易察觉的恶意代码。
虽然有潜在的投毒风险，但当前代码的主要目的是演示漏洞利用，风险较低，作者没有明显的隐藏后门行为，恶意代码比较容易被发现。

**利用方式：**
1.  攻击者创建一个恶意的ZIP压缩包，其中包含：
    *   一个良性的文件（例如 document.pdf）。
    *   一个与良性文件同名的文件夹（例如 document.pdf/）。
    *   恶意代码位于同名文件夹中（例如 document.pdf/script.bat）。
2.  攻击者诱骗目标用户使用存在漏洞的 WinRAR 版本打开此 ZIP 压缩包。
3.  当用户尝试打开良性文件时，WinRAR 错误地执行同名文件夹中的恶意代码，从而导致任意代码执行。


**项目地址:** [idkwastaken/CVE-2023-38831](https://github.com/idkwastaken/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #16

**来源**: [CVE-2023-38831-imbyter_imbyter-WinRAR_CVE-2023-38831.md](../2023/CVE-2023-38831-imbyter_imbyter-WinRAR_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 6.23

**利用条件:** 用户使用受影响的WinRAR版本打开特制的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于WinRAR 6.23之前的版本中。攻击者可以构造一个恶意的ZIP压缩包，其中包含一个伪装成良性文件的文件（例如 .jpg），以及一个同名的文件夹。当用户尝试在 WinRAR 中查看该“良性文件”时，实际上会执行同名文件夹中的恶意代码（例如 .cmd 或 .exe 文件）。

**有效性：**
根据漏洞信息和搜索结果，提供的POC代码是有效的。该POC利用了WinRAR处理ZIP压缩包时存在的逻辑漏洞，能够实现远程代码执行。

**投毒风险：**
提供的Python脚本 `make-poc.py` 用于生成POC压缩包，其本身的代码逻辑相对简单，主要功能是将指定的文件和脚本打包成特定的ZIP格式，并进行一些字符串替换以触发漏洞。主要风险在于脚本生成的POC包中包含的脚本，如果这个脚本是恶意的，那么整个利用过程就存在投毒风险。 仓库中的README.md文件里的测试脚本就是一个关闭计算机的脚本。代码本身存在一定的投毒风险.

*   脚本逻辑：脚本的功能是创建包含漏洞利用结构的RAR文件。
*   恶意操作：如果脚本被修改以包含下载和执行恶意软件的逻辑，那么用户在使用此脚本创建RAR文件时，就会受到投毒攻击。

**利用方式：**
1.  攻击者使用 `make-poc.py` 脚本构造恶意的ZIP压缩包，需要提供一个“良性”文件和一个恶意脚本。
2.  攻击者将恶意的ZIP压缩包发送给受害者。
3.  受害者使用受影响的WinRAR版本打开该ZIP压缩包，并尝试查看伪装的“良性”文件。
4.  WinRAR错误地执行了与“良性”文件同名的文件夹中的恶意脚本，导致远程代码执行。

**防御措施：**
*   升级WinRAR到6.23或更高版本。
*   谨慎打开来源不明的ZIP压缩包。
*   使用杀毒软件扫描ZIP压缩包。

**项目地址:** [imbyter/imbyter-WinRAR_CVE-2023-38831](https://github.com/imbyter/imbyter-WinRAR_CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #17

**来源**: [CVE-2023-38831-kehrijksen_CVE-2023-38831.md](../2023/CVE-2023-38831-kehrijksen_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 需要用户解压特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个恶意的 ZIP 压缩包，其中包含一个伪装成普通文件的文件和一个同名的文件夹。当用户尝试在 WinRAR 中查看该“普通文件”时，WinRAR 会错误地执行同名文件夹中的内容，从而导致任意代码执行。

**有效性：**
提供的 PoC 代码 `poc.py` 能够生成利用此漏洞的恶意 ZIP 压缩包。该脚本首先创建一个包含恶意 payload (例如 script.bat) 和良性文件 (例如 pepe.jpg) 的目录结构。然后，它将此目录结构压缩成 ZIP 文件，并修改 ZIP 文件中的文件名，以触发漏洞。`script.bat` 的作用是在 `%TEMP%` 目录下提取 ZIP 文件内容，运行良性文件作为诱饵，然后执行恶意操作，例如创建一个包含 “hacked” 内容的文本文件并使用记事本打开。

**投毒风险：**
分析提供的代码，没有发现明显的投毒代码。`poc.py` 的作用是生成恶意 ZIP 文件，而 `script.bat` 包含的是恶意行为的代码，例如运行良性文件，创建 `hacked.txt` 等。这些行为是漏洞利用的一部分，而不是隐藏的恶意代码。虽然利用 `script.bat` 可以执行任意操作，但这属于漏洞利用的范畴，而非代码投毒。

**利用方式：**
1.  攻击者使用 `poc.py` 脚本生成一个恶意的 ZIP 压缩包，其中包含一个良性文件（例如图片）和一个同名的文件夹。
2.  攻击者将此恶意 ZIP 压缩包发送给受害者。
3.  受害者使用 WinRAR (6.23 之前的版本) 打开并尝试查看 ZIP 压缩包中的良性文件。
4.  WinRAR 错误地执行与良性文件同名的文件夹中的内容 (由 `script.bat` 控制)。
5.  `script.bat` 首先将 ZIP 文件的内容解压到临时目录。
6.  `script.bat` 运行良性文件（例如图片）作为诱饵，以迷惑受害者。
7.  `script.bat` 执行任意恶意操作，例如创建文件，修改注册表，安装恶意软件等。


**项目地址:** [kehrijksen/CVE-2023-38831](https://github.com/kehrijksen/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #18

**来源**: [CVE-2023-38831-khanhtranngoccva_cve-2023-38831-poc.md](../2023/CVE-2023-38831-khanhtranngoccva_cve-2023-38831-poc.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。该漏洞源于WinRAR处理ZIP压缩包时，对文件名和文件夹名区分不当。攻击者可以创建一个ZIP压缩包，其中包含一个良性文件（例如JPG）和一个同名的文件夹。该文件夹中包含恶意可执行文件。当用户尝试在WinRAR中打开该良性文件时，WinRAR会错误地执行文件夹中的恶意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已在野外被利用，证明了其有效性。提供的POC代码片段（package-lock.json）显示使用了jszip库，表明该POC可能用于创建恶意的ZIP压缩包，进一步验证漏洞的可利用性。

**投毒风险：**
提供的POC代码片段是`package-lock.json`文件，主要描述了项目依赖。要判断是否存在投毒风险，需要检查实际的利用代码（例如 index.ts/index.js）。
*   这个`package-lock.json`文件本身不包含恶意代码，只是依赖声明。
*   **风险点在于开发者可能在其他代码文件中（如index.ts等，此文件未提供）包含恶意代码**。
*   jszip 库本身是一个常用的 ZIP 文件操作库，被投毒的可能性较低。
*   tsx和typescript是typescript相关工具，本身被投毒的可能性也比较低

由于缺乏实际的利用代码，无法确定是否存在投毒行为，只能根据现有信息进行推测，因此将投毒风险评估为10%。

**利用方式：**
1.  攻击者构造一个恶意的ZIP压缩包。
2.  该ZIP压缩包包含一个良性文件（例如JPG）和一个同名的文件夹。
3.  该文件夹中包含恶意可执行文件（例如EXE、BAT、CMD等）。
4.  攻击者诱骗用户使用受影响的WinRAR版本打开该ZIP压缩包。
5.  用户尝试在WinRAR中打开该良性文件。
6.  WinRAR错误地执行文件夹中的恶意代码，导致远程代码执行。

**项目地址:** [khanhtranngoccva/cve-2023-38831-poc](https://github.com/khanhtranngoccva/cve-2023-38831-poc)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #19

**来源**: [CVE-2023-38831-kuyrathdaro_winrar-cve-2023-38831.md](../2023/CVE-2023-38831-kuyrathdaro_winrar-cve-2023-38831.md)

## CVE-2023-38831-WinRAR代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个代码执行漏洞。该漏洞的利用方式如下：

1.  攻击者创建一个恶意的ZIP压缩包（伪装成RAR格式，后缀名为.rar）。
2.  该压缩包包含一个良性的文件（例如，document.pdf），以及一个与该良性文件同名的文件夹（例如，document.pdf）。
3.  同名文件夹中包含恶意payload（例如，一个.bat或.exe文件），命名为`document.pdfA.cmd`。
4.  用户使用存在漏洞的WinRAR版本打开该压缩包，并尝试打开良性文件（document.pdf）。
5.  由于WinRAR处理文件名的缺陷，实际上执行的是同名文件夹中的恶意payload。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以判断该漏洞PoC有效。搜索引擎结果中多个链接表明该漏洞已被广泛利用，并且Google的威胁分析小组也分析了利用该漏洞进行的攻击活动。提供的PoC代码实现了生成恶意RAR压缩包的逻辑，进一步验证了该漏洞的可利用性。

**投毒风险：**

PoC代码本身的主要功能是生成利用CVE-2023-38831漏洞的恶意压缩包。然而，我们仍然需要评估该代码是否存在潜在的投毒风险。以下是对代码的分析：

*   **代码功能明确：** PoC代码的功能是生成特定的文件结构和内容，以触发WinRAR漏洞。代码逻辑相对简单，易于理解。
*   **输入/输出控制：** PoC代码接受三个输入参数：良性文件、Payload文件和输出文件名。这三个参数都由用户指定，PoC本身没有主动下载或执行任何其他代码的功能。
*   **潜在风险点：** `exploit.py` 脚本使用 `shutil.copyfile` 函数来复制 payload 文件到临时目录，如果payload 文件本身就是恶意的，那么这也会造成风险。此外，尽管脚本尝试确保输出文件以 `.rar` 结尾，但恶意用户可能修改此行为。
*   **间接风险：** 如果攻击者修改了提供的 `exploit.py` 脚本，添加额外的恶意功能（例如，在生成恶意压缩包后，自动上传到恶意服务器），则可能存在投毒风险。但是，这并非原始PoC代码本身的问题。

综合来看，原始PoC代码本身存在直接投毒的风险较低，我估计的投毒风险概率为 **10%**。这主要是因为恶意 payload 本身会带来风险，但 PoC 代码并没有主动引入恶意行为。

**利用方式：**

1.  准备一个良性的文件（例如，document.pdf）和一个恶意payload（例如，script.bat或malware.exe）。
2.  运行PoC脚本，指定良性文件、payload文件和输出文件名。
3.  PoC脚本生成一个恶意的RAR压缩包（实际上是ZIP格式，但后缀名为.rar）。
4.  将该恶意RAR压缩包发送给目标用户。
5.  目标用户使用存在漏洞的WinRAR版本打开该压缩包，并尝试打开良性文件。
6.  WinRAR执行同名文件夹中的恶意payload，从而实现代码执行。


**项目地址:** [kuyrathdaro/winrar-cve-2023-38831](https://github.com/kuyrathdaro/winrar-cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #20

**来源**: [CVE-2023-38831-malvika-thakur_CVE-2023-38831.md](../2023/CVE-2023-38831-malvika-thakur_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以通过创建一个特制的 ZIP 压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹，文件夹中包含恶意可执行文件。当用户尝试在 WinRAR 中查看该良性文件时，由于 WinRAR 处理逻辑的缺陷，会错误地执行文件夹中的恶意代码，从而导致远程代码执行。

**有效性：**

提供的 POC 代码 `poc.py`  可以生成利用此漏洞的 ZIP 文件。代码首先检查恶意脚本和良性文件是否存在，然后创建一个目录，将脚本和良性文件复制到特定结构中，最后将该目录压缩成 ZIP 文件。用户只需双击压缩包内的良性文件即可触发漏洞，执行恶意脚本。因此，POC 代码有效。

**投毒风险：**

分析提供的 `poc.py` 代码，没有发现明显的投毒代码。该脚本的主要功能是生成利用 CVE-2023-38831 漏洞的恶意 ZIP 文件。它需要用户提供恶意脚本和良性文件，然后按照特定目录结构进行组织并压缩。代码中没有发现任何会执行额外恶意操作的逻辑。`README.md` 文件也仅包含漏洞描述和使用说明，没有发现恶意内容。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者创建一个包含良性文件（如 JPG 图片）和一个同名文件夹的 ZIP 压缩包。
2.  该文件夹中包含恶意可执行文件（如 BAT 脚本）。
3.  攻击者将该 ZIP 压缩包发送给目标用户。
4.  目标用户使用受影响的 WinRAR 版本打开该 ZIP 压缩包。
5.  目标用户双击 ZIP 压缩包中的良性文件。
6.  WinRAR 错误地执行同名文件夹中的恶意可执行文件，导致远程代码执行。

**项目地址:** [malvika-thakur/CVE-2023-38831](https://github.com/malvika-thakur/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #21

**来源**: [CVE-2023-38831-r1yaz_winDED.md](../2023/CVE-2023-38831-r1yaz_winDED.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开特制的恶意 ZIP 压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 是 WinRAR 在处理 ZIP 压缩文件时存在的远程代码执行漏洞。当 WinRAR 版本低于 6.23 时，如果用户尝试打开一个包含恶意构造的 ZIP 文件，攻击者可以利用此漏洞执行任意代码。该 ZIP 文件包含一个良性文件（例如 JPG 文件）和一个与其同名的文件夹。攻击者可以将可执行文件放置在该文件夹中，当用户尝试访问良性文件时，WinRAR 会错误地执行文件夹中的可执行文件。

**有效性：**
提供的 POC 代码（winDED）通过生成恶意 ZIP 文件来演示漏洞利用。它创建了一个良性文件和一个同名文件夹，并将恶意脚本放入文件夹中。用户双击压缩包中的 PDF 文件时，实际上会执行该恶意脚本，从而证明漏洞的可利用性。

**投毒风险：**
根据提供的 POC 代码，投毒风险较低。代码主要是为了演示漏洞而设计的，虽然存在执行恶意 `super_sneaky_evil_script.bat` 的可能性，但该脚本本身是由用户提供的，或者可以通过查看代码本身来确认其行为。 然而，仍然存在一些细微的风险，例如，如果 `super_sneaky_evil_script.bat` 本身是从其他来源下载的，则可能包含恶意代码。  总的来说, 投毒风险约 10%。

**利用方式：**
1.  创建一个包含良性文件 (例如，`BILLION_DOLLAR_SECRET.pdf`) 和一个同名文件夹 (`BILLION_DOLLAR_SECRET.pdf`) 的 ZIP 压缩文件。
2.  将恶意脚本 (例如，`super_sneaky_evil_script.bat`) 放入同名文件夹中。
3.  诱骗目标用户使用 WinRAR 打开该 ZIP 文件。
4.  当用户尝试打开良性文件时，WinRAR 错误地执行同名文件夹中的恶意脚本，从而实现远程代码执行。

**项目地址:** [r1yaz/winDED](https://github.com/r1yaz/winDED)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #22

**来源**: [CVE-2023-38831-ra3edAJ_LAB-DFIR-cve-2023-38831.md](../2023/CVE-2023-38831-ra3edAJ_LAB-DFIR-cve-2023-38831.md)

## CVE-2023-38831-WinRAR代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 是 WinRAR 在 6.23 版本之前存在的远程代码执行漏洞。该漏洞源于WinRAR处理ZIP压缩包时，如果压缩包中包含一个良性文件和一个与该良性文件同名的文件夹，WinRAR在尝试访问良性文件时，会错误地执行同名文件夹中的恶意内容。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的PoC是可用的。漏洞在野外被广泛利用，并且CISA已将其添加到已知被利用的漏洞目录中。

**投毒风险：**
提供的漏洞利用代码为一个Github仓库的README.md文件，主要描述了如何利用磁盘镜像调查CVE-2023-38831攻击，并通过Windows注册表、NTFS文件和浏览器缓存理解Windows事件序列。仓库本身目的是为了DFIR分析，因此直接包含恶意代码的可能性较低。但考虑到链接跳转至外部教程网站，存在间接投毒的可能，即教程内容可能包含引导至恶意软件下载或运行恶意脚本的指令。因此，投毒风险较低，评估为10%。

**利用方式：**
1.  **创建恶意的ZIP压缩包：** 压缩包中包含一个良性文件（如JPG图片）和一个与该良性文件同名的文件夹。
2.  **将恶意可执行文件放入同名文件夹：** 该文件夹中的可执行文件会在用户尝试打开良性文件时被执行。
3.  **诱导用户打开ZIP压缩包：** 通过社交工程或其他方式，诱导用户使用受影响版本的WinRAR打开该压缩包。
4.  **触发漏洞执行恶意代码：** 当用户尝试查看ZIP压缩包中的良性文件时，WinRAR会错误地执行同名文件夹中的恶意代码，从而实现远程代码执行。

**总结：**
该漏洞利用方式较为简单，易于传播，危害较大。用户应及时更新WinRAR至最新版本，避免打开来源不明的ZIP压缩包。

**项目地址:** [ra3edAJ/LAB-DFIR-cve-2023-38831](https://github.com/ra3edAJ/LAB-DFIR-cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #23

**来源**: [CVE-2023-38831-ruycr4ft_CVE-2023-38831.md](../2023/CVE-2023-38831-ruycr4ft_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的远程代码执行漏洞。该漏洞源于WinRAR在处理ZIP压缩包时，对文件名和文件夹名相同的情况处理不当。攻击者可以构造一个恶意的ZIP压缩包，其中包含一个看似无害的文件（例如.jpg），同时包含一个同名的文件夹。当用户尝试打开该“无害文件”时，WinRAR会错误地执行同名文件夹中的恶意代码。\n\n**有效性：** 根据漏洞信息、搜索结果以及提供的POC代码，该漏洞利用是有效的。多个来源都表明该漏洞已被广泛利用，POC代码也展示了如何生成包含恶意代码的RAR压缩文件。POC代码通过创建同名文件和文件夹，并在文件夹中放入恶意脚本，利用WinRAR的缺陷触发代码执行。\n\n**投毒风险：**  仓库的投毒风险较低，大概10%。
  *   `poc.py`: 该脚本的功能是生成利用 CVE-2023-38831 的恶意 RAR 文件。虽然它允许用户指定 bait 文件和脚本文件，但脚本本身不包含任何预设的、隐藏的恶意行为。
  *   `script.bat`:  这个批处理文件包含使用 `nc.exe` (netcat) 反弹 shell 的命令。**这里存在一定的投毒风险。** 批处理文件明确地使用了`192.168.0.107`这个IP地址,如果用户直接使用该IP反弹shell,将会连接到攻击者的服务器。虽然IP地址可以被用户更改，但在默认情况下，如果用户不修改，将会连接到攻击者的IP。这是主要的投毒点。
  *   README.md: 该文件仅包含漏洞的简单介绍和演示图片。没有发现恶意代码。

**利用方式：**\n1.  攻击者创建一个恶意的ZIP压缩包。该压缩包包含一个诱饵文件（例如图片.jpg）和一个与其同名的文件夹（例如图片.jpg）。\n2.  攻击者将恶意代码（例如一个批处理脚本或可执行文件）放入同名文件夹中。\n3.  攻击者将包含恶意代码的ZIP压缩包发送给受害者。\n4.  受害者使用存在漏洞的WinRAR版本打开该ZIP压缩包，并尝试打开诱饵文件。\n5.  WinRAR错误地执行同名文件夹中的恶意代码，导致远程代码执行。

**项目地址:** [ruycr4ft/CVE-2023-38831](https://github.com/ruycr4ft/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #24

**来源**: [CVE-2023-38831-s4m98_winrar-cve-2023-38831-poc-gen.md](../2023/CVE-2023-38831-s4m98_winrar-cve-2023-38831-poc-gen.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开恶意的ZIP/RAR压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于WinRAR处理ZIP压缩文件时，由于对文件名和文件夹名处理不当导致。攻击者可以构造一个包含恶意脚本的ZIP压缩文件，该压缩文件包含一个正常的诱饵文件（如PDF、PNG或JPG）和一个同名的文件夹，当用户尝试打开诱饵文件时，WinRAR会错误地执行该文件夹中的恶意脚本。

**有效性：**
根据漏洞信息、搜索引擎结果和漏洞利用代码，该POC代码有效。漏洞库信息表明该漏洞已被野外利用。搜索引擎结果中也包含了大量关于此漏洞的分析和利用报告，证实了该漏洞的有效性。POC代码的描述和实现也符合漏洞的利用方式，通过生成包含恶意脚本和诱饵文件的RAR压缩包来触发漏洞。

**投毒风险：**
代码本身看起来比较直接，主要是生成利用漏洞的压缩包。`script.bat` 这个文件需要额外注意。当前提供的 `script.bat` 只是打开了计算器 `calc.exe` 和 Web_Security.pdf,相对来说是安全的，但用户在使用该漏洞时，完全可以修改此文件，添加更加恶意的payload，具有一定的风险。作者在代码中没有明显投毒行为，主要风险在于用户如何使用该工具生成payload。
投毒风险评估：10% (主要是用户修改 `script.bat` 的风险)

**利用方式：**
1.  **构造恶意ZIP/RAR压缩文件：** 利用提供的Python脚本（cve-2023-38831-exp-gen.py）生成恶意的ZIP/RAR压缩文件。此脚本需要一个诱饵文件（如PDF、PNG、JPG）和一个恶意脚本文件（如BAT、CMD、或可执行文件）。该脚本会创建一个包含诱饵文件和一个同名文件夹的压缩包，并将恶意脚本放置在该文件夹中。
2.  **诱骗用户打开压缩文件：**  将生成的恶意ZIP/RAR压缩文件发送给目标用户。
3.  **执行恶意代码：** 当用户使用受影响的WinRAR版本打开压缩文件并尝试查看诱饵文件时，WinRAR会错误地执行同名文件夹中的恶意脚本，从而实现远程代码执行。

 总体来说，该漏洞利用方式较为简单，攻击成本较低，风险较高。

**项目地址:** [s4m98/winrar-cve-2023-38831-poc-gen](https://github.com/s4m98/winrar-cve-2023-38831-poc-gen)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #25

**来源**: [CVE-2023-38831-solomon12354_VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC.md](../2023/CVE-2023-38831-solomon12354_VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要解压恶意的ZIP/RAR压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 存在于 WinRAR 6.23 之前版本中。攻击者可以构造一个包含良性文件和同名文件夹的 ZIP 压缩包，当用户尝试访问良性文件时，WinRAR 会错误地执行同名文件夹中的恶意代码。提供的 `exploit.py` 脚本可以用于生成包含漏洞利用的RAR压缩文件。脚本首先要求输入良性文件（`bait_file`）、恶意脚本文件（`script_file`）和输出RAR文件名称。然后，它创建一个临时目录，将恶意脚本复制到与良性文件同名的目录中，并将良性文件复制到临时目录中。最后，使用 `shutil.make_archive` 函数将临时目录压缩成 ZIP 文件，并修改 ZIP 文件的内容，将目录名中的 'A' 和 'B' 替换为空格，从而绕过 WinRAR 的安全检查。最终，将修改后的 ZIP 文件重命名为 RAR 文件。

`squid.bat` 用于下载并执行 `volleysquid.exe`。`volleyballsquid.py` 尝试利用 BypassUAC 来提升权限并将程序设置为开机自启。

**有效性:** 根据漏洞信息和利用代码分析，提供的 POC 代码有效，可以利用此漏洞在受害者机器上执行任意代码。

**投毒风险:** 仓库中存在一定的投毒风险，虽然主要功能是利用CVE-2023-38831漏洞，但是 `volleyballsquid.py`和`squid.bat`文件中的行为具有恶意性，特别是`volleyballsquid.py`中尝试使用`BypassUAC`绕过用户账户控制并持久化安装，这可能被用于安装后门或恶意软件。虽然主要目的是展示漏洞，但客观上存在后门功能，因此投毒风险占比为10%。

**利用方式:** 攻击者首先利用 `exploit.py` 脚本生成包含恶意代码的RAR压缩文件。然后，诱骗用户下载并使用 WinRAR 解压此文件。当用户尝试打开压缩包中的“良性”文件时，实际上会执行隐藏在同名目录中的恶意脚本 (例如 `squid.bat`)，下载并执行恶意程序。

根据搜索结果，CVE-2023-38831 漏洞已被广泛利用，并且已被政府背景的攻击者使用，这进一步验证了漏洞的严重性和 POC 代码的有效性。

**项目地址:** [solomon12354/VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC](https://github.com/solomon12354/VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #26

**来源**: [CVE-2023-38831-technicalcorp0_CVE-2023-38831-Exploit.md](../2023/CVE-2023-38831-technicalcorp0_CVE-2023-38831-Exploit.md)

## CVE-2023-38831-WinRAR-任意代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 任意代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个漏洞，该漏洞允许攻击者通过特制的ZIP档案执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** 当WinRAR尝试访问ZIP归档中的良性文件时，如果存在与该良性文件同名的文件夹，WinRAR会处理该文件夹的内容（可能包含可执行内容）。
2.  **利用方式：**
    *   攻击者创建一个恶意的ZIP档案，该档案包含一个良性文件（例如.JPG文件）和一个与该良性文件同名的文件夹。
    *   该文件夹包含恶意可执行文件。
    *   当受害者尝试在WinRAR中查看良性文件时，WinRAR会执行该文件夹中的恶意代码。
3.  **POC有效性：** 提供的POC代码 (CVE-2023-38831-WinRar-Exploit.py) 的目的是生成包含利用此漏洞的恶意 ZIP 文件。根据代码逻辑和漏洞原理，该 POC 可以有效利用该漏洞。
4.  **投毒风险：** 经过对POC代码的分析，发现代码本身实现了漏洞利用过程，但同时也存在一定的投毒风险。`clean_up()`函数会删除临时文件，但不能保证完全清除所有痕迹。攻击者可能通过修改代码，在生成恶意 ZIP 文件后，在目标系统上留下后门或执行其他恶意操作。考虑到实际利用场景中可能存在的恶意修改，投毒风险估计为5%。 主要风险点在于，虽然POC主要目的是生成exploit，但如果恶意人员修改，完全可以添加其他恶意payload，并伪装成CVE-2023-38831的POC进行传播。
5. **搜索引擎结果:** 搜索引擎结果表明此漏洞已被广泛利用，包括政府背景的黑客组织。 多个安全厂商发布了相关的分析和防御措施。

**项目地址:** [technicalcorp0/CVE-2023-38831-Exploit](https://github.com/technicalcorp0/CVE-2023-38831-Exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #27

**来源**: [CVE-2023-38831-xk-mt_WinRAR-Vulnerability-recurrence-tutorial.md](../2023/CVE-2023-38831-xk-mt_WinRAR-Vulnerability-recurrence-tutorial.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。该漏洞允许攻击者通过构造恶意的ZIP压缩包，在用户尝试查看压缩包内的文件时执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，该漏洞已被广泛利用，POC代码的存在也表明其有效性。多个安全厂商和研究人员都对此漏洞进行了分析并提供了相应的缓解措施。

**投毒风险分析：**
提供的POC代码包含以下文件：
*   `README.md`: 漏洞复现教程，包含漏洞信息和参考链接。
*   `执行命令.bat`: 一个简单的批处理文件，用于执行`calc.exe`（计算器程序），用于演示代码执行。
*   `文本.txt`: 包含一个URL地址。
*   `生成压缩包.py`: 一个Python脚本，用于生成包含漏洞的ZIP压缩包。

该脚本的主要功能是：
1.  创建临时目录，并将`执行命令.bat`复制到该目录。
2.  复制`文本.txt`文件到另一个目录。
3.  将上述两个目录打包成ZIP文件。
4.  修改ZIP文件中的文件名，利用漏洞的原理。
从代码本身来看，该脚本并没有明显的恶意代码，但是存在一定的投毒风险。
*   执行命令.bat： 虽然只是简单的calc.exe，但如果攻击者替换成其他恶意命令，则可能造成更大的危害。
*   脚本的依赖： 该脚本依赖Python环境，攻击者可能会通过修改脚本，引入恶意的Python依赖包，从而实现投毒。

综合来看，该仓库中存在一定的投毒风险，但不高。主要是因为演示的`执行命令.bat`内容比较简单，容易被识别。如果使用者直接运行此仓库的代码，有可能会被植入恶意程序。因此，投毒风险评定为10%。

**利用方式：**
1.  攻击者构造一个恶意的ZIP压缩包，该压缩包包含一个良性文件（例如，图片文件`文本.txt`）和一个与该文件同名的文件夹。
2.  该文件夹包含一个恶意可执行文件（例如，`执行命令.bat`并更名为`文本.txtA.cmd`）。
3.  当用户使用受影响的WinRAR版本打开该ZIP压缩包，并尝试查看良性文件时，WinRAR会错误地执行该文件夹中的恶意可执行文件，从而导致任意代码执行。

**项目地址:** [xk-mt/WinRAR-Vulnerability-recurrence-tutorial](https://github.com/xk-mt/WinRAR-Vulnerability-recurrence-tutorial)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #28

**来源**: [CVE-2023-38831-yezzfusl_cve_2023_38831_scanner.md](../2023/CVE-2023-38831-yezzfusl_cve_2023_38831_scanner.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开恶意的 ZIP 压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以通过构造一个特殊的 ZIP 压缩文件来利用此漏洞。该 ZIP 文件包含一个良性文件（例如 JPG）和一个同名的文件夹。当用户尝试访问良性文件时，WinRAR 会错误地执行文件夹中的恶意代码，导致远程代码执行。

**利用方式：**
1.  攻击者创建一个包含良性文件和同名文件夹的恶意 ZIP 文件。
2.  文件夹中包含要执行的恶意代码（例如，可执行文件）。
3.  攻击者诱使用户使用 WinRAR 打开该 ZIP 文件。
4.  当用户尝试访问良性文件时，WinRAR 会执行文件夹中的恶意代码。

**有效性：**
根据漏洞描述和搜索结果，该漏洞已在野外被利用，因此提供的PoC代码如果能够重现该行为，则可以认为是有效的。

**投毒风险：**
提供的代码仓库 `cve_2023_38831_scanner` 本身是一个漏洞扫描器，而非漏洞利用的PoC。尽管如此，仍然存在一定的投毒风险。代码中可能隐藏后门，虽然其主要功能是扫描，但理论上存在被篡改的风险。代码中使用了网络数据包分析、进程内存扫描、沙箱环境执行等模块，这些模块如果被恶意修改，可能被用于执行恶意操作。因此，综合考虑其扫描器的性质和潜在风险，投毒风险估计为10%。这个风险主要来自供应链投毒，如果下载了被篡改过的扫描器，那么扫描器本身可能成为攻击的一部分。

**项目地址:** [yezzfusl/cve_2023_38831_scanner](https://github.com/yezzfusl/cve_2023_38831_scanner)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #29

**来源**: [CVE-2023-38831-youmulijiang_evil-winrar.md](../2023/CVE-2023-38831-youmulijiang_evil-winrar.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 50%

## 详情

CVE-2023-38831是WinRAR在6.23版本之前存在的一个远程代码执行漏洞。该漏洞的利用方式是构造一个特殊的ZIP压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹。当用户尝试在WinRAR中查看该良性文件时，WinRAR会错误地执行该文件夹中的恶意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认该漏洞是有效的，并且已经在野外被利用。漏洞利用代码提供了一个框架，用于生成包含恶意payload的ZIP压缩包，从而实现远程代码执行。

**投毒风险分析：**
提供的代码是一个框架，用于生成漏洞利用的 ZIP 文件，包含生成 exp，邮件发送，下载链接生成等功能。代码中存在潜在的投毒风险，主要体现在以下几个方面：

1.  **Payload 植入:**  该框架可以自定义payload，如果用户在不了解 payload 内容的情况下使用，可能运行恶意指令。
2.  **代码可信度:** 虽然作者声明为安全开发成员，并开源了代码，但代码的安全性仍然需要进一步审计。存在作者预留后门的可能性。 考虑到这是一个漏洞利用框架，其本质就是为了执行恶意代码，所以判定为投毒代码的风险为50%。

**漏洞利用方式：**

1.  攻击者使用该漏洞利用框架(evil-winrar)生成一个恶意的 ZIP 压缩包。
2.  该 ZIP 压缩包包含一个良性文件（如JPG图片）和一个同名的文件夹，文件夹中包含恶意可执行文件。
3.  攻击者通过社会工程学等方式诱骗用户使用存在漏洞的 WinRAR 版本打开该 ZIP 压缩包。
4.  用户尝试查看良性文件时，WinRAR 会错误地执行同名文件夹中的恶意代码。
5.  恶意代码在用户系统上执行，攻击者从而实现远程代码执行，控制受害者的计算机。

**项目地址:** [youmulijiang/evil-winrar](https://github.com/youmulijiang/evil-winrar)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---



---

## POC #3

**来源**: [CVE-2023-38831-MaorBuskila_Windows-X64-RAT.md](../2023/CVE-2023-38831-MaorBuskila_Windows-X64-RAT.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者在用户尝试查看 ZIP 压缩包中的良性文件时执行任意代码。该漏洞源于 WinRAR 处理 ZIP 压缩包时，允许压缩包包含一个良性文件（例如 .JPG）和一个同名文件夹。当用户尝试访问该良性文件时，WinRAR 实际上会处理同名文件夹中的内容，从而允许攻击者在文件夹中放置恶意可执行文件并执行。

**有效性：**
从搜索结果和漏洞库信息来看，该漏洞已经被广泛利用，PoC 代码的存在也进一步验证了其有效性。

**投毒风险：**
提供的 Python 脚本 (`51721.py`) 用于生成 Windows x64 平台的反向 TCP Shellcode。该脚本本身不包含明显的恶意代码，功能是生成 shellcode。需要用户自行配置 IP 地址和端口。但是，由于该代码需要用户执行，并且可以生成任意 shellcode，存在一定投毒风险，例如，如果攻击者提供修改后的脚本，生成包含恶意功能的 shellcode (如删除文件，上传用户信息)，则用户可能无意中执行该恶意 shellcode. 脚本本身不包含网络连接或者其他与远程服务器通信的行为，可以基本判断代码仓库投毒风险较低.

**利用方式：**
1.  攻击者创建一个恶意的 ZIP 压缩包。
2.  该 ZIP 压缩包包含一个良性文件（例如 image.jpg）和一个同名文件夹（image.jpg）。
3.  同名文件夹包含恶意可执行文件，例如 exploit.exe，并可能包含一个 `.lnk` 文件，该快捷方式指向该恶意可执行文件。
4.  攻击者诱骗用户使用受影响版本的 WinRAR 打开该 ZIP 压缩包并尝试查看良性文件。
5.  WinRAR 错误地执行同名文件夹中的恶意可执行文件，从而导致远程代码执行。

**项目地址:** [MaorBuskila/Windows-X64-RAT](https://github.com/MaorBuskila/Windows-X64-RAT)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #4

**来源**: [CVE-2023-38831-MyStuffYT_CVE-2023-38831-POC.md](../2023/CVE-2023-38831-MyStuffYT_CVE-2023-38831-POC.md)

## CVE-2023-38831-WinRAR-远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的恶意ZIP压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个恶意的ZIP压缩文件，其中包含一个良性文件（例如.jpg）和一个同名的文件夹。当用户尝试在 WinRAR 中查看该良性文件时，WinRAR 会错误地执行该文件夹中的内容，从而导致任意代码执行。

**有效性：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。搜索引擎结果表明该漏洞已被广泛利用，POC代码的存在进一步证实了其有效性。

**投毒风险：**

根据对POC代码的分析，存在一定的投毒风险。`script.bat`脚本从github下载`Alert.exe`文件，这本身就存在一定的安全隐患，无法确保下载的文件一定是安全的。此外，脚本同时执行 `alert.exe` 和 `gtaleak.mp4`，而 `gtaleak.mp4` 在 README 中说明是 “zeros without ones”, 可以确定这是一个障眼法，实际的恶意行为是由 `alert.exe` 执行。 因此，作者可能隐藏了投毒代码。

**利用方式：**

1.  攻击者创建一个恶意的ZIP压缩文件，其中包含一个良性文件 (例如 `gtaleak.mp4`) 和一个同名的文件夹。
2.  该文件夹包含一个批处理脚本 (`script.bat`)，该脚本将从远程服务器下载并执行恶意程序 (`Alert.exe`)。
3.  当用户尝试使用 WinRAR 打开压缩文件并查看良性文件 (`gtaleak.mp4`) 时，WinRAR 会错误地执行批处理脚本。
4.  批处理脚本下载并执行恶意程序，从而允许攻击者在受害者的系统上执行任意代码。

**项目地址:** [MyStuffYT/CVE-2023-38831-POC](https://github.com/MyStuffYT/CVE-2023-38831-POC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #5

**来源**: [CVE-2023-38831-Nielk74_CVE-2023-38831.md](../2023/CVE-2023-38831-Nielk74_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本的代码执行漏洞。该漏洞允许攻击者在用户尝试查看ZIP存档中的看似无害的文件时执行任意代码。攻击者通过构造一个包含同名文件和文件夹的恶意ZIP文件，利用WinRAR处理文件路径时的逻辑缺陷，使得文件夹中的恶意可执行文件得以运行。提供的POC代码通过Vagrant自动化部署了一个易受攻击的WinRAR 6.22环境，并向虚拟机桌面添加了一个恶意的rar文件。该rar文件被设计为当用户点击其中的“无害”文件时，执行预先设定的恶意代码。尽管POC的主要目的是演示漏洞，但其中`ChocolateyInstall.ps1`脚本从外部源下载并安装软件包（Chocolatey和WinRAR），存在被篡改从而引入恶意代码的风险，这构成了潜在的投毒风险。虽然这个脚本很常见，但还是存在一定的风险，因此这里给出了10%的投毒风险。

**漏洞利用方式：**

1.  攻击者创建一个恶意的ZIP压缩包，其中包含一个看似无害的文件（例如.jpg），以及一个与该文件同名的文件夹。
2.  该文件夹包含恶意可执行文件，例如.exe或.cmd脚本。
3.  当用户尝试使用WinRAR打开ZIP压缩包并查看“无害”文件时，WinRAR会错误地执行同名文件夹中的恶意可执行文件，从而导致任意代码执行。
4.  攻击者可以利用此漏洞在受害者系统上安装恶意软件、窃取敏感数据或执行其他恶意操作。

**项目地址:** [Nielk74/CVE-2023-38831](https://github.com/Nielk74/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #6

**来源**: [CVE-2023-38831-RomainBayle08_CVE-2023-38831.md](../2023/CVE-2023-38831-RomainBayle08_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP或RAR压缩文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个特殊的 ZIP 压缩文件，该文件包含一个看似无害的文件（例如，.JPG 文件）和一个与该文件同名的文件夹。当用户尝试查看压缩文件中的无害文件时，WinRAR 会错误地执行文件夹中的内容，从而导致任意代码执行。

**有效性分析：**
提供的 POC 代码 `cve-2023-38831-exp-gen.py` 是一个漏洞利用生成器脚本，它接受诱饵文件 (`BAIT_NAME`)、脚本文件 (`SCRIPT_NAME`) 和额外的诱饵文件目录 (`BAIT_FILES`) 作为输入，并生成一个恶意 RAR 压缩文件 (`OUTPUT_NAME`)。脚本首先创建一个包含诱饵文件和脚本文件的临时目录结构，然后使用 `shutil.make_archive` 函数将该目录压缩为 ZIP 文件。关键在于，脚本会替换 ZIP 文件中特定文件的扩展名，利用 WinRAR 的漏洞，在用户尝试打开诱饵文件时执行脚本文件。`script.bat` 脚本会首先尝试打开诱饵文件（模拟用户行为），然后执行 `calc.exe`（作为漏洞利用成功的标志）。该 POC 的有效性较高，因为它模拟了真实的攻击场景。

**投毒风险分析：**
`cve-2023-38831-exp-gen.py` 脚本本身不包含明显的恶意代码或后门。但是，存在一定的投毒风险，因为该脚本允许攻击者指定要执行的任意脚本 (`SCRIPT_NAME`)。攻击者可以替换 `script.bat` 文件为包含恶意代码的文件，例如下载和执行其他恶意软件。此外，该脚本使用了`BAIT_FILES`参数，如果提供包含恶意文件的目录，也会构成投毒风险。所以存在一定投毒风险，但主要取决于用户提供的脚本和目录的内容。

**利用方式分析：**
1.  攻击者构造一个恶意 ZIP 压缩文件，其中包含一个诱饵文件（如 `CLASSIFIED_DOCUMENTS.pdf`）和一个与诱饵文件同名的文件夹。文件夹中包含一个脚本文件（如 `script.bat`）。
2.  攻击者将恶意 ZIP 文件发送给受害者，诱骗其使用 WinRAR 打开。
3.  当受害者尝试查看 ZIP 文件中的诱饵文件时，WinRAR 会错误地执行同名文件夹中的脚本文件。
4.  脚本文件执行任意代码，例如安装恶意软件或窃取敏感信息。

总的来说，该漏洞利用方式简单有效，风险较高。用户应尽快升级到 WinRAR 6.23 或更高版本。

**项目地址:** [RomainBayle08/CVE-2023-38831](https://github.com/RomainBayle08/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #7

**来源**: [CVE-2023-38831-RonF98_CVE-2023-38831-POC.md](../2023/CVE-2023-38831-RonF98_CVE-2023-38831-POC.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致任意代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831 是 WinRAR 在处理 ZIP 压缩文件时存在的一个漏洞。攻击者可以构造一个包含良性文件（例如 .jpg 文件）和一个同名文件夹的 ZIP 压缩包。该文件夹中包含恶意代码（例如 .cmd 文件）。当用户尝试查看良性文件时，WinRAR 会错误地执行文件夹中的恶意代码，从而导致远程代码执行。

**有效性：**

提供的 POC 代码有效，它演示了如何创建一个恶意的 RAR 文件来利用此漏洞。

*   `DoS.cmd` 文件包含恶意代码，用于创建多个消息框，模拟拒绝服务攻击。
*   `exploit.py` 脚本用于生成包含恶意 `DoS.cmd` 文件的 RAR 文件，并利用漏洞触发代码执行。
*   `README.md` 详细解释了漏洞原理和利用方法，并提供了攻击成功的截图。

**投毒风险：**

此仓库中可能存在轻微的投毒风险，约为5%。

*   `DoS.cmd` 只是一个简单的拒绝服务攻击示例，但攻击者可能会将其替换为更具破坏性的恶意代码，例如勒索软件或信息窃取程序。如果下载者不仔细检查 `DoS.cmd` 的内容，可能会在不知情的情况下运行恶意代码。
*   `exploit.py` 脚本本身没有明显的恶意代码，但它可以被修改以生成包含不同恶意代码的 RAR 文件。下载者应该仔细审查脚本的内容，确保它不会被用于传播恶意软件。

**利用方式：**

1.  攻击者创建一个包含良性文件（例如 `image.jpg`）和一个同名文件夹（例如 `image.jpg `）的 ZIP 压缩包。注意文件夹名称后面有一个空格。
2.  在同名文件夹中，攻击者放置恶意代码（例如 `image.jpg .cmd`）。
3.  攻击者将 ZIP 文件转换为 RAR 文件（POC 脚本完成了此过程）。
4.  攻击者诱骗用户使用受影响的 WinRAR 版本打开 RAR 文件并尝试查看良性文件（`image.jpg`）。
5.  WinRAR 错误地执行同名文件夹中的恶意代码 (`image.jpg .cmd`)，从而导致远程代码执行。

由于该漏洞被广泛利用，并且网上存在大量相关的 POC 代码，因此攻击者很容易发起攻击。


**项目地址:** [RonF98/CVE-2023-38831-POC](https://github.com/RonF98/CVE-2023-38831-POC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #8

**来源**: [CVE-2023-38831-SpamixOfficial_CVE-2023-38831.md](../2023/CVE-2023-38831-SpamixOfficial_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前的版本中的代码执行漏洞。攻击者可以制作一个特制的ZIP压缩包，其中包含一个良性文件和一个同名文件夹，文件夹中包含恶意可执行文件。当用户尝试在WinRAR中查看良性文件时，实际上会执行文件夹中的恶意代码。\n\n**有效性：**根据漏洞库信息、搜索结果和漏洞利用代码，该漏洞POC是有效的。漏洞库信息中明确指出该漏洞已在野外被利用。搜索结果中多个链接都指向了关于该漏洞的分析和利用报告。提供的`Cargo.lock`文件很可能只是rust项目依赖管理文件，无法直接证明POC的有效性，需配合rust源码进行分析。\n\n**投毒风险：**分析提供的`Cargo.lock`文件，该文件列出了Rust项目`CVE-2023-38831`的依赖项。虽然`Cargo.lock`本身不包含可执行代码，但是，如果恶意作者修改了依赖项的版本或来源，理论上存在引入被篡改过的crate（Rust包）的风险。不过，由于`Cargo.lock`文件明确指定了每个依赖项的checksum，Cargo在构建项目时会验证下载的crate是否与checksum匹配，从而降低了被投毒的风险。评估投毒风险为10%。\n\n**利用方式：**攻击者创建一个包含以下结构的ZIP压缩包：\n\n1.  一个良性的文件，例如 `image.jpg`\n2.  一个与良性文件同名的文件夹，例如 `image.jpg`\n3.  在同名文件夹中，放置恶意可执行文件，例如 `image.jpg.exe` 或 `image.jpg `(通过空格进行欺骗)。\n\n当用户使用存在漏洞的WinRAR版本打开该ZIP文件并尝试查看`image.jpg`时，WinRAR会错误地执行`image.jpg`文件夹中的恶意程序，从而实现远程代码执行。

**项目地址:** [SpamixOfficial/CVE-2023-38831](https://github.com/SpamixOfficial/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #9

**来源**: [CVE-2023-38831-Tolu12wani_Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution.md](../2023/CVE-2023-38831-Tolu12wani_Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在用户尝试查看 ZIP 压缩包中的文件时执行任意代码。

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开特制的 ZIP 压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者通过构造恶意的 ZIP 压缩包实现远程代码执行。该压缩包包含一个良性文件（例如 JPG）和一个与良性文件同名的文件夹。当用户尝试访问良性文件时，WinRAR 会错误地执行同名文件夹中的内容，从而执行攻击者放置的恶意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被广泛利用。 提供的POC代码描述的是在压缩文件中嵌入恶意payload，并触发反向shell的实验环境验证过程。虽然该代码本身没有包含恶意代码，但描述了如何构建利用该漏洞的压缩文件。

**投毒风险：**
提供的 POC 代码仓库中只包含 PDF 报告和截图，并没有可执行的恶意代码。 但是,README中说明了该仓库展示了恶意payload的嵌入方式，存在一定的潜在风险。 因此，存在一定的投毒风险，但风险较低。根据readme描述和文件结构，投毒风险评估为10%，

**利用方式：**
1.  **创建恶意 ZIP 压缩包：** 攻击者创建一个 ZIP 压缩包，其中包含一个良性文件（例如 JPG）和一个与良性文件同名的文件夹。
2.  **放置恶意代码：** 将恶意可执行文件放置在与良性文件同名的文件夹中。
3.  **诱骗用户：** 诱骗用户使用受影响的 WinRAR 版本打开该 ZIP 压缩包并尝试查看良性文件。
4.  **执行恶意代码：** WinRAR 错误地执行同名文件夹中的恶意代码，从而实现远程代码执行。

根据搜索结果，该漏洞已经被政府支持的攻击者利用，用于投放 RAT（远程访问木马）等恶意软件。

**项目地址:** [Tolu12wani/Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution](https://github.com/Tolu12wani/Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #10

**来源**: [CVE-2023-38831-VictoriousKnight_CVE-2023-38831_Exploit.md](../2023/CVE-2023-38831-VictoriousKnight_CVE-2023-38831_Exploit.md)

## CVE-2023-38831-WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码。

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的恶意ZIP文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个漏洞，它允许攻击者通过构造特殊的ZIP文件来执行任意代码。攻击者创建一个ZIP文件，其中包含一个良性文件（例如，JPG图片）和一个与该良性文件同名的文件夹。该文件夹中包含恶意可执行文件。当用户尝试在WinRAR中查看该良性文件时，WinRAR会错误地执行该文件夹中的恶意代码，从而导致远程代码执行。

**有效性：** 提供的POC代码是有效的。根据漏洞库信息和搜索结果，该漏洞在野外被广泛利用。POC代码通过创建包含良性文件和同名文件夹的恶意ZIP文件，并利用WinRAR处理文件时的缺陷来执行代码。POC代码结构清晰，易于理解和使用。

**投毒风险：** 提供的POC代码本身主要是利用漏洞生成EXP，但仔细检查代码，在`exploit.py`文件的zip文件内容操作部分被截断，没有展示修改zip文件内容的关键代码，作者可能在`Read and manipulate the zip file content`部分添加恶意代码，执行修改zip文件过程中的任何恶意行为。因此存在一定的投毒风险，根据代码完整度，我给出10%的投毒风险。

**利用方式：**
1.  攻击者创建一个恶意ZIP文件，其中包含一个看似无害的文件（例如，一个图片或PDF）。
2.  在ZIP文件中，攻击者同时创建一个与该无害文件同名的文件夹。
3.  该文件夹包含攻击者想要执行的恶意代码，通常是一个可执行文件或脚本。
4.  攻击者诱使用户使用存在漏洞的WinRAR版本打开该ZIP文件。
5.  当用户尝试访问ZIP文件中的“无害”文件时，WinRAR会错误地执行同名文件夹中的恶意代码。

**项目地址:** [VictoriousKnight/CVE-2023-38831_Exploit](https://github.com/VictoriousKnight/CVE-2023-38831_Exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #11

**来源**: [CVE-2023-38831-anelya0333_Exploiting-CVE-2023-38831.md](../2023/CVE-2023-38831-anelya0333_Exploiting-CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开特制的ZIP压缩文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞允许攻击者通过特制的ZIP压缩文件在目标系统上执行任意代码。该漏洞的根源在于WinRAR在处理包含与文件同名文件夹的ZIP文件时存在缺陷。攻击者可以构造一个 ZIP 文件，其中包含一个良性文件（例如.JPG）和一个与其同名的文件夹。当用户尝试在 WinRAR 中查看该良性文件时，WinRAR 会错误地执行该文件夹中的恶意代码。此PoC脚本生成一个ZIP文件，其中包含诱饵文件(bait file)和恶意脚本(script file)，并修改ZIP文件的文件头，以利用此漏洞。脚本创建与诱饵文件同名的文件夹，并将恶意脚本放入其中。然后，将诱饵文件的副本也放入ZIP文件中。通过替换文件名字段中的某些字符，WinRAR会将文件夹中的恶意文件误认为是要执行的文件，最终导致代码执行。由于代码仅仅是构造payload，不存在主动执行恶意代码，因此不存在投毒风险。

**项目地址:** [anelya0333/Exploiting-CVE-2023-38831](https://github.com/anelya0333/Exploiting-CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #12

**来源**: [CVE-2023-38831-b1tg_CVE-2023-38831-winrar-exploit.md](../2023/CVE-2023-38831-b1tg_CVE-2023-38831-winrar-exploit.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可导致完全系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开恶意构造的ZIP文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 允许攻击者通过特制的ZIP文件在受害者系统上执行任意代码。该漏洞源于 WinRAR 处理包含同名文件和文件夹的 ZIP 档案时的不当行为。攻击者可以创建一个 ZIP 文件，其中包含一个良性文件（例如 CLASSIFIED_DOCUMENTS.pdf）和一个同名文件夹（例如 CLASSIFIED_DOCUMENTS.pdf）。当用户尝试访问良性文件时，WinRAR 实际上会执行该文件夹中的内容（例如 script.bat）。

**有效性:**

提供的 POC 代码 `cve-2023-38831-exp-gen.py` 旨在生成利用此漏洞的恶意 RAR 档案。该脚本通过以下步骤工作：

1.  创建临时目录 `TEMPLATE`。
2.  在 `TEMPLATE` 中创建一个与bait文件同名的文件夹，并在其中存放包含恶意命令的script文件（例如 `script.bat`， 其中包含`calc.exe & CLASSIFIED_DOCUMENTS.pdf`）。
3.  将bait文件存放在`TEMPLATE`目录。
4.  将`TEMPLATE`目录压缩为zip文件。
5.  修改压缩包中文件和文件夹的名字，构造漏洞。
6.  最终输出 `CVE-2023-38831-poc.rar`。

该脚本能够有效地生成利用 CVE-2023-38831 的 RAR 文件，因此提供的 POC 代码是有效的。

**投毒风险:**

对提供的 POC 代码 (`cve-2023-38831-exp-gen.py` 和 `script.bat`) 进行分析后，未发现明显的恶意代码或后门。该脚本的功能明确且集中于生成利用 CVE-2023-38831 的 RAR 档案。 `script.bat` 的主要功能是启动计算器程序 (`calc.exe`) 并尝试打开诱饵文档 (`CLASSIFIED_DOCUMENTS.pdf`)，这是一个典型的 PoC 行为。 因此，该仓库中存在作者隐藏的投毒代码的风险极低。

**利用方式:**

1.  攻击者使用 `cve-2023-38831-exp-gen.py` 脚本，指定诱饵文件（例如 `CLASSIFIED_DOCUMENTS.pdf`）和恶意脚本（例如 `script.bat`），生成恶意 RAR 档案。
2.  攻击者通过各种方式（例如，电子邮件、恶意网站）将恶意 RAR 档案分发给受害者。
3.  受害者使用易受攻击的 WinRAR 版本（< 6.23）打开恶意 RAR 档案。
4.  当受害者尝试访问诱饵文件时，WinRAR 错误地执行了同名文件夹中的恶意脚本。
5.  恶意脚本在受害者系统上执行任意代码，例如启动计算器或安装恶意软件。

**项目地址:** [b1tg/CVE-2023-38831-winrar-exploit](https://github.com/b1tg/CVE-2023-38831-winrar-exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #13

**来源**: [CVE-2023-38831-elefantesagradodeluzinfinita_cve-2023-38831.md](../2023/CVE-2023-38831-elefantesagradodeluzinfinita_cve-2023-38831.md)

## CVE-2023-38831 - WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用 WinRAR 打开特制的 ZIP 压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者通过特制的 ZIP 压缩包在受害者系统上执行任意代码。漏洞利用方式是创建一个 ZIP 压缩包，其中包含一个良性文件（例如 .jpg 或 .pdf）以及一个同名的文件夹。该文件夹包含恶意的可执行文件（例如 .cmd 或 .exe）。当用户尝试打开良性文件时，WinRAR 会错误地执行文件夹中的恶意代码。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码分析，该漏洞确实存在并且已经被野外利用。提供的代码描述了一个利用工具 "DR. GANDALF"，它允许用户创建包含此漏洞的 ZIP 文件，表明POC的有效性。

**投毒风险：** 提供的 README.md 文件主要描述了漏洞原理和利用工具的使用方法。但是，由于此工具允许用户自定义注入的代码和二进制文件，因此存在投毒风险。如果用户下载了包含恶意注入代码的ZIP文件，那么这个工具本身可能被利用来传播恶意软件。评估投毒风险为 10%，因为该描述文件本身不包含可以直接执行的后门代码，但生成的ZIP文件可以包含。

**利用方式：**
1.  攻击者创建一个包含恶意 ZIP 压缩包。
2.  ZIP 压缩包中包含一个良性文件（例如，`image.jpg`）和一个同名的文件夹（例如，`image.jpg`）。
3.  `image.jpg` 文件夹包含恶意的可执行文件（例如，`evil.cmd`）。
4.  攻击者诱骗受害者使用存在漏洞的 WinRAR 版本打开该 ZIP 压缩包并尝试访问良性文件 `image.jpg`。
5.  WinRAR 在处理该 ZIP 文件时，会错误地执行 `image.jpg` 文件夹中的恶意代码 `evil.cmd`，从而导致远程代码执行。

**项目地址:** [elefantesagradodeluzinfinita/cve-2023-38831](https://github.com/elefantesagradodeluzinfinita/cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #14

**来源**: [CVE-2023-38831-h3xecute_SideCopy-Exploits-CVE-2023-38831.md](../2023/CVE-2023-38831-h3xecute_SideCopy-Exploits-CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个远程代码执行漏洞。该漏洞的利用方式是构造一个特殊的ZIP压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹。当用户尝试使用WinRAR打开该ZIP压缩包并访问良性文件时，WinRAR会错误地执行文件夹中的恶意代码。

**有效性：**
提供的POC代码描述了漏洞利用的原理，即构造包含同名良性文件和文件夹的ZIP压缩包。根据漏洞信息和搜索结果，此方法是有效的，并且在野外被利用。

**投毒风险：**
该POC本身描述了漏洞的利用方式，包含一个指向YouTube视频的链接，以及对恶意压缩包结构的描述。投毒风险较低，约为10%，因为：
1.  POC主要以描述性文字和图片链接为主。
2.  缺乏直接可执行的payload代码。
3.  作者可能通过YouTube链接传播恶意信息。

**利用方式：**
1.  攻击者创建一个恶意的ZIP压缩包。
2.  该压缩包包含一个良性文件（例如JPG，PDF等）和一个与该文件同名的文件夹。
3.  恶意代码（例如，可执行文件）放置在同名文件夹中。
4.  攻击者诱骗用户使用WinRAR打开这个ZIP压缩包，并尝试访问良性文件。
5.  WinRAR在处理压缩包时，会错误地执行同名文件夹中的恶意代码，从而导致远程代码执行。

**项目地址:** [h3xecute/SideCopy-Exploits-CVE-2023-38831](https://github.com/h3xecute/SideCopy-Exploits-CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #15

**来源**: [CVE-2023-38831-idkwastaken_CVE-2023-38831.md](../2023/CVE-2023-38831-idkwastaken_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意的ZIP文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的漏洞。该漏洞的利用方式是创建一个特制的ZIP文件，其中包含一个良性文件和一个同名文件夹。当用户尝试使用WinRAR打开ZIP文件并访问该良性文件时，WinRAR会错误地执行该同名文件夹中的恶意代码，导致远程代码执行。

**有效性：**
提供的POC代码（exploit.c）利用了该漏洞。该代码生成一个ZIP文件，其中包含一个PDF文件（document.pdf）和一个名为“document.pdf\”的文件夹，该文件夹内包含一个恶意的批处理脚本（script.bat）。当用户在易受攻击的WinRAR版本中打开并尝试访问该PDF文件时，WinRAR将执行该批处理脚本。
checker.bat 是用来检测目标系统是否安装WinRAR，以及WinRAR的版本是否是受影响的版本。
exploit.ps1 看起来不完整，但是其作用应该是检查WinRAR版本。

**投毒风险：**
代码中存在一定的投毒风险，约为10%。原因如下：
*   **脚本内容可控：** exploit.c 中的script_content变量包含了要执行的命令，虽然当前POC仅仅是弹窗，但是攻击者可以修改这个变量，执行任意命令，例如下载恶意软件，执行系统命令等。
*   **复杂的构建过程：** exploit.c 代码本身比较复杂，阅读和分析需要一定的时间和精力。攻击者可以利用这一点，在代码中隐藏不易察觉的恶意代码。
虽然有潜在的投毒风险，但当前代码的主要目的是演示漏洞利用，风险较低，作者没有明显的隐藏后门行为，恶意代码比较容易被发现。

**利用方式：**
1.  攻击者创建一个恶意的ZIP压缩包，其中包含：
    *   一个良性的文件（例如 document.pdf）。
    *   一个与良性文件同名的文件夹（例如 document.pdf/）。
    *   恶意代码位于同名文件夹中（例如 document.pdf/script.bat）。
2.  攻击者诱骗目标用户使用存在漏洞的 WinRAR 版本打开此 ZIP 压缩包。
3.  当用户尝试打开良性文件时，WinRAR 错误地执行同名文件夹中的恶意代码，从而导致任意代码执行。


**项目地址:** [idkwastaken/CVE-2023-38831](https://github.com/idkwastaken/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #16

**来源**: [CVE-2023-38831-imbyter_imbyter-WinRAR_CVE-2023-38831.md](../2023/CVE-2023-38831-imbyter_imbyter-WinRAR_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 6.23

**利用条件:** 用户使用受影响的WinRAR版本打开特制的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于WinRAR 6.23之前的版本中。攻击者可以构造一个恶意的ZIP压缩包，其中包含一个伪装成良性文件的文件（例如 .jpg），以及一个同名的文件夹。当用户尝试在 WinRAR 中查看该“良性文件”时，实际上会执行同名文件夹中的恶意代码（例如 .cmd 或 .exe 文件）。

**有效性：**
根据漏洞信息和搜索结果，提供的POC代码是有效的。该POC利用了WinRAR处理ZIP压缩包时存在的逻辑漏洞，能够实现远程代码执行。

**投毒风险：**
提供的Python脚本 `make-poc.py` 用于生成POC压缩包，其本身的代码逻辑相对简单，主要功能是将指定的文件和脚本打包成特定的ZIP格式，并进行一些字符串替换以触发漏洞。主要风险在于脚本生成的POC包中包含的脚本，如果这个脚本是恶意的，那么整个利用过程就存在投毒风险。 仓库中的README.md文件里的测试脚本就是一个关闭计算机的脚本。代码本身存在一定的投毒风险.

*   脚本逻辑：脚本的功能是创建包含漏洞利用结构的RAR文件。
*   恶意操作：如果脚本被修改以包含下载和执行恶意软件的逻辑，那么用户在使用此脚本创建RAR文件时，就会受到投毒攻击。

**利用方式：**
1.  攻击者使用 `make-poc.py` 脚本构造恶意的ZIP压缩包，需要提供一个“良性”文件和一个恶意脚本。
2.  攻击者将恶意的ZIP压缩包发送给受害者。
3.  受害者使用受影响的WinRAR版本打开该ZIP压缩包，并尝试查看伪装的“良性”文件。
4.  WinRAR错误地执行了与“良性”文件同名的文件夹中的恶意脚本，导致远程代码执行。

**防御措施：**
*   升级WinRAR到6.23或更高版本。
*   谨慎打开来源不明的ZIP压缩包。
*   使用杀毒软件扫描ZIP压缩包。

**项目地址:** [imbyter/imbyter-WinRAR_CVE-2023-38831](https://github.com/imbyter/imbyter-WinRAR_CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #17

**来源**: [CVE-2023-38831-kehrijksen_CVE-2023-38831.md](../2023/CVE-2023-38831-kehrijksen_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 需要用户解压特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个恶意的 ZIP 压缩包，其中包含一个伪装成普通文件的文件和一个同名的文件夹。当用户尝试在 WinRAR 中查看该“普通文件”时，WinRAR 会错误地执行同名文件夹中的内容，从而导致任意代码执行。

**有效性：**
提供的 PoC 代码 `poc.py` 能够生成利用此漏洞的恶意 ZIP 压缩包。该脚本首先创建一个包含恶意 payload (例如 script.bat) 和良性文件 (例如 pepe.jpg) 的目录结构。然后，它将此目录结构压缩成 ZIP 文件，并修改 ZIP 文件中的文件名，以触发漏洞。`script.bat` 的作用是在 `%TEMP%` 目录下提取 ZIP 文件内容，运行良性文件作为诱饵，然后执行恶意操作，例如创建一个包含 “hacked” 内容的文本文件并使用记事本打开。

**投毒风险：**
分析提供的代码，没有发现明显的投毒代码。`poc.py` 的作用是生成恶意 ZIP 文件，而 `script.bat` 包含的是恶意行为的代码，例如运行良性文件，创建 `hacked.txt` 等。这些行为是漏洞利用的一部分，而不是隐藏的恶意代码。虽然利用 `script.bat` 可以执行任意操作，但这属于漏洞利用的范畴，而非代码投毒。

**利用方式：**
1.  攻击者使用 `poc.py` 脚本生成一个恶意的 ZIP 压缩包，其中包含一个良性文件（例如图片）和一个同名的文件夹。
2.  攻击者将此恶意 ZIP 压缩包发送给受害者。
3.  受害者使用 WinRAR (6.23 之前的版本) 打开并尝试查看 ZIP 压缩包中的良性文件。
4.  WinRAR 错误地执行与良性文件同名的文件夹中的内容 (由 `script.bat` 控制)。
5.  `script.bat` 首先将 ZIP 文件的内容解压到临时目录。
6.  `script.bat` 运行良性文件（例如图片）作为诱饵，以迷惑受害者。
7.  `script.bat` 执行任意恶意操作，例如创建文件，修改注册表，安装恶意软件等。


**项目地址:** [kehrijksen/CVE-2023-38831](https://github.com/kehrijksen/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #18

**来源**: [CVE-2023-38831-khanhtranngoccva_cve-2023-38831-poc.md](../2023/CVE-2023-38831-khanhtranngoccva_cve-2023-38831-poc.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。该漏洞源于WinRAR处理ZIP压缩包时，对文件名和文件夹名区分不当。攻击者可以创建一个ZIP压缩包，其中包含一个良性文件（例如JPG）和一个同名的文件夹。该文件夹中包含恶意可执行文件。当用户尝试在WinRAR中打开该良性文件时，WinRAR会错误地执行文件夹中的恶意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已在野外被利用，证明了其有效性。提供的POC代码片段（package-lock.json）显示使用了jszip库，表明该POC可能用于创建恶意的ZIP压缩包，进一步验证漏洞的可利用性。

**投毒风险：**
提供的POC代码片段是`package-lock.json`文件，主要描述了项目依赖。要判断是否存在投毒风险，需要检查实际的利用代码（例如 index.ts/index.js）。
*   这个`package-lock.json`文件本身不包含恶意代码，只是依赖声明。
*   **风险点在于开发者可能在其他代码文件中（如index.ts等，此文件未提供）包含恶意代码**。
*   jszip 库本身是一个常用的 ZIP 文件操作库，被投毒的可能性较低。
*   tsx和typescript是typescript相关工具，本身被投毒的可能性也比较低

由于缺乏实际的利用代码，无法确定是否存在投毒行为，只能根据现有信息进行推测，因此将投毒风险评估为10%。

**利用方式：**
1.  攻击者构造一个恶意的ZIP压缩包。
2.  该ZIP压缩包包含一个良性文件（例如JPG）和一个同名的文件夹。
3.  该文件夹中包含恶意可执行文件（例如EXE、BAT、CMD等）。
4.  攻击者诱骗用户使用受影响的WinRAR版本打开该ZIP压缩包。
5.  用户尝试在WinRAR中打开该良性文件。
6.  WinRAR错误地执行文件夹中的恶意代码，导致远程代码执行。

**项目地址:** [khanhtranngoccva/cve-2023-38831-poc](https://github.com/khanhtranngoccva/cve-2023-38831-poc)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #19

**来源**: [CVE-2023-38831-kuyrathdaro_winrar-cve-2023-38831.md](../2023/CVE-2023-38831-kuyrathdaro_winrar-cve-2023-38831.md)

## CVE-2023-38831-WinRAR代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个代码执行漏洞。该漏洞的利用方式如下：

1.  攻击者创建一个恶意的ZIP压缩包（伪装成RAR格式，后缀名为.rar）。
2.  该压缩包包含一个良性的文件（例如，document.pdf），以及一个与该良性文件同名的文件夹（例如，document.pdf）。
3.  同名文件夹中包含恶意payload（例如，一个.bat或.exe文件），命名为`document.pdfA.cmd`。
4.  用户使用存在漏洞的WinRAR版本打开该压缩包，并尝试打开良性文件（document.pdf）。
5.  由于WinRAR处理文件名的缺陷，实际上执行的是同名文件夹中的恶意payload。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以判断该漏洞PoC有效。搜索引擎结果中多个链接表明该漏洞已被广泛利用，并且Google的威胁分析小组也分析了利用该漏洞进行的攻击活动。提供的PoC代码实现了生成恶意RAR压缩包的逻辑，进一步验证了该漏洞的可利用性。

**投毒风险：**

PoC代码本身的主要功能是生成利用CVE-2023-38831漏洞的恶意压缩包。然而，我们仍然需要评估该代码是否存在潜在的投毒风险。以下是对代码的分析：

*   **代码功能明确：** PoC代码的功能是生成特定的文件结构和内容，以触发WinRAR漏洞。代码逻辑相对简单，易于理解。
*   **输入/输出控制：** PoC代码接受三个输入参数：良性文件、Payload文件和输出文件名。这三个参数都由用户指定，PoC本身没有主动下载或执行任何其他代码的功能。
*   **潜在风险点：** `exploit.py` 脚本使用 `shutil.copyfile` 函数来复制 payload 文件到临时目录，如果payload 文件本身就是恶意的，那么这也会造成风险。此外，尽管脚本尝试确保输出文件以 `.rar` 结尾，但恶意用户可能修改此行为。
*   **间接风险：** 如果攻击者修改了提供的 `exploit.py` 脚本，添加额外的恶意功能（例如，在生成恶意压缩包后，自动上传到恶意服务器），则可能存在投毒风险。但是，这并非原始PoC代码本身的问题。

综合来看，原始PoC代码本身存在直接投毒的风险较低，我估计的投毒风险概率为 **10%**。这主要是因为恶意 payload 本身会带来风险，但 PoC 代码并没有主动引入恶意行为。

**利用方式：**

1.  准备一个良性的文件（例如，document.pdf）和一个恶意payload（例如，script.bat或malware.exe）。
2.  运行PoC脚本，指定良性文件、payload文件和输出文件名。
3.  PoC脚本生成一个恶意的RAR压缩包（实际上是ZIP格式，但后缀名为.rar）。
4.  将该恶意RAR压缩包发送给目标用户。
5.  目标用户使用存在漏洞的WinRAR版本打开该压缩包，并尝试打开良性文件。
6.  WinRAR执行同名文件夹中的恶意payload，从而实现代码执行。


**项目地址:** [kuyrathdaro/winrar-cve-2023-38831](https://github.com/kuyrathdaro/winrar-cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #20

**来源**: [CVE-2023-38831-malvika-thakur_CVE-2023-38831.md](../2023/CVE-2023-38831-malvika-thakur_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以通过创建一个特制的 ZIP 压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹，文件夹中包含恶意可执行文件。当用户尝试在 WinRAR 中查看该良性文件时，由于 WinRAR 处理逻辑的缺陷，会错误地执行文件夹中的恶意代码，从而导致远程代码执行。

**有效性：**

提供的 POC 代码 `poc.py`  可以生成利用此漏洞的 ZIP 文件。代码首先检查恶意脚本和良性文件是否存在，然后创建一个目录，将脚本和良性文件复制到特定结构中，最后将该目录压缩成 ZIP 文件。用户只需双击压缩包内的良性文件即可触发漏洞，执行恶意脚本。因此，POC 代码有效。

**投毒风险：**

分析提供的 `poc.py` 代码，没有发现明显的投毒代码。该脚本的主要功能是生成利用 CVE-2023-38831 漏洞的恶意 ZIP 文件。它需要用户提供恶意脚本和良性文件，然后按照特定目录结构进行组织并压缩。代码中没有发现任何会执行额外恶意操作的逻辑。`README.md` 文件也仅包含漏洞描述和使用说明，没有发现恶意内容。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者创建一个包含良性文件（如 JPG 图片）和一个同名文件夹的 ZIP 压缩包。
2.  该文件夹中包含恶意可执行文件（如 BAT 脚本）。
3.  攻击者将该 ZIP 压缩包发送给目标用户。
4.  目标用户使用受影响的 WinRAR 版本打开该 ZIP 压缩包。
5.  目标用户双击 ZIP 压缩包中的良性文件。
6.  WinRAR 错误地执行同名文件夹中的恶意可执行文件，导致远程代码执行。

**项目地址:** [malvika-thakur/CVE-2023-38831](https://github.com/malvika-thakur/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #21

**来源**: [CVE-2023-38831-r1yaz_winDED.md](../2023/CVE-2023-38831-r1yaz_winDED.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开特制的恶意 ZIP 压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 是 WinRAR 在处理 ZIP 压缩文件时存在的远程代码执行漏洞。当 WinRAR 版本低于 6.23 时，如果用户尝试打开一个包含恶意构造的 ZIP 文件，攻击者可以利用此漏洞执行任意代码。该 ZIP 文件包含一个良性文件（例如 JPG 文件）和一个与其同名的文件夹。攻击者可以将可执行文件放置在该文件夹中，当用户尝试访问良性文件时，WinRAR 会错误地执行文件夹中的可执行文件。

**有效性：**
提供的 POC 代码（winDED）通过生成恶意 ZIP 文件来演示漏洞利用。它创建了一个良性文件和一个同名文件夹，并将恶意脚本放入文件夹中。用户双击压缩包中的 PDF 文件时，实际上会执行该恶意脚本，从而证明漏洞的可利用性。

**投毒风险：**
根据提供的 POC 代码，投毒风险较低。代码主要是为了演示漏洞而设计的，虽然存在执行恶意 `super_sneaky_evil_script.bat` 的可能性，但该脚本本身是由用户提供的，或者可以通过查看代码本身来确认其行为。 然而，仍然存在一些细微的风险，例如，如果 `super_sneaky_evil_script.bat` 本身是从其他来源下载的，则可能包含恶意代码。  总的来说, 投毒风险约 10%。

**利用方式：**
1.  创建一个包含良性文件 (例如，`BILLION_DOLLAR_SECRET.pdf`) 和一个同名文件夹 (`BILLION_DOLLAR_SECRET.pdf`) 的 ZIP 压缩文件。
2.  将恶意脚本 (例如，`super_sneaky_evil_script.bat`) 放入同名文件夹中。
3.  诱骗目标用户使用 WinRAR 打开该 ZIP 文件。
4.  当用户尝试打开良性文件时，WinRAR 错误地执行同名文件夹中的恶意脚本，从而实现远程代码执行。

**项目地址:** [r1yaz/winDED](https://github.com/r1yaz/winDED)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #22

**来源**: [CVE-2023-38831-ra3edAJ_LAB-DFIR-cve-2023-38831.md](../2023/CVE-2023-38831-ra3edAJ_LAB-DFIR-cve-2023-38831.md)

## CVE-2023-38831-WinRAR代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 是 WinRAR 在 6.23 版本之前存在的远程代码执行漏洞。该漏洞源于WinRAR处理ZIP压缩包时，如果压缩包中包含一个良性文件和一个与该良性文件同名的文件夹，WinRAR在尝试访问良性文件时，会错误地执行同名文件夹中的恶意内容。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的PoC是可用的。漏洞在野外被广泛利用，并且CISA已将其添加到已知被利用的漏洞目录中。

**投毒风险：**
提供的漏洞利用代码为一个Github仓库的README.md文件，主要描述了如何利用磁盘镜像调查CVE-2023-38831攻击，并通过Windows注册表、NTFS文件和浏览器缓存理解Windows事件序列。仓库本身目的是为了DFIR分析，因此直接包含恶意代码的可能性较低。但考虑到链接跳转至外部教程网站，存在间接投毒的可能，即教程内容可能包含引导至恶意软件下载或运行恶意脚本的指令。因此，投毒风险较低，评估为10%。

**利用方式：**
1.  **创建恶意的ZIP压缩包：** 压缩包中包含一个良性文件（如JPG图片）和一个与该良性文件同名的文件夹。
2.  **将恶意可执行文件放入同名文件夹：** 该文件夹中的可执行文件会在用户尝试打开良性文件时被执行。
3.  **诱导用户打开ZIP压缩包：** 通过社交工程或其他方式，诱导用户使用受影响版本的WinRAR打开该压缩包。
4.  **触发漏洞执行恶意代码：** 当用户尝试查看ZIP压缩包中的良性文件时，WinRAR会错误地执行同名文件夹中的恶意代码，从而实现远程代码执行。

**总结：**
该漏洞利用方式较为简单，易于传播，危害较大。用户应及时更新WinRAR至最新版本，避免打开来源不明的ZIP压缩包。

**项目地址:** [ra3edAJ/LAB-DFIR-cve-2023-38831](https://github.com/ra3edAJ/LAB-DFIR-cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #23

**来源**: [CVE-2023-38831-ruycr4ft_CVE-2023-38831.md](../2023/CVE-2023-38831-ruycr4ft_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的远程代码执行漏洞。该漏洞源于WinRAR在处理ZIP压缩包时，对文件名和文件夹名相同的情况处理不当。攻击者可以构造一个恶意的ZIP压缩包，其中包含一个看似无害的文件（例如.jpg），同时包含一个同名的文件夹。当用户尝试打开该“无害文件”时，WinRAR会错误地执行同名文件夹中的恶意代码。\n\n**有效性：** 根据漏洞信息、搜索结果以及提供的POC代码，该漏洞利用是有效的。多个来源都表明该漏洞已被广泛利用，POC代码也展示了如何生成包含恶意代码的RAR压缩文件。POC代码通过创建同名文件和文件夹，并在文件夹中放入恶意脚本，利用WinRAR的缺陷触发代码执行。\n\n**投毒风险：**  仓库的投毒风险较低，大概10%。
  *   `poc.py`: 该脚本的功能是生成利用 CVE-2023-38831 的恶意 RAR 文件。虽然它允许用户指定 bait 文件和脚本文件，但脚本本身不包含任何预设的、隐藏的恶意行为。
  *   `script.bat`:  这个批处理文件包含使用 `nc.exe` (netcat) 反弹 shell 的命令。**这里存在一定的投毒风险。** 批处理文件明确地使用了`192.168.0.107`这个IP地址,如果用户直接使用该IP反弹shell,将会连接到攻击者的服务器。虽然IP地址可以被用户更改，但在默认情况下，如果用户不修改，将会连接到攻击者的IP。这是主要的投毒点。
  *   README.md: 该文件仅包含漏洞的简单介绍和演示图片。没有发现恶意代码。

**利用方式：**\n1.  攻击者创建一个恶意的ZIP压缩包。该压缩包包含一个诱饵文件（例如图片.jpg）和一个与其同名的文件夹（例如图片.jpg）。\n2.  攻击者将恶意代码（例如一个批处理脚本或可执行文件）放入同名文件夹中。\n3.  攻击者将包含恶意代码的ZIP压缩包发送给受害者。\n4.  受害者使用存在漏洞的WinRAR版本打开该ZIP压缩包，并尝试打开诱饵文件。\n5.  WinRAR错误地执行同名文件夹中的恶意代码，导致远程代码执行。

**项目地址:** [ruycr4ft/CVE-2023-38831](https://github.com/ruycr4ft/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #24

**来源**: [CVE-2023-38831-s4m98_winrar-cve-2023-38831-poc-gen.md](../2023/CVE-2023-38831-s4m98_winrar-cve-2023-38831-poc-gen.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开恶意的ZIP/RAR压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于WinRAR处理ZIP压缩文件时，由于对文件名和文件夹名处理不当导致。攻击者可以构造一个包含恶意脚本的ZIP压缩文件，该压缩文件包含一个正常的诱饵文件（如PDF、PNG或JPG）和一个同名的文件夹，当用户尝试打开诱饵文件时，WinRAR会错误地执行该文件夹中的恶意脚本。

**有效性：**
根据漏洞信息、搜索引擎结果和漏洞利用代码，该POC代码有效。漏洞库信息表明该漏洞已被野外利用。搜索引擎结果中也包含了大量关于此漏洞的分析和利用报告，证实了该漏洞的有效性。POC代码的描述和实现也符合漏洞的利用方式，通过生成包含恶意脚本和诱饵文件的RAR压缩包来触发漏洞。

**投毒风险：**
代码本身看起来比较直接，主要是生成利用漏洞的压缩包。`script.bat` 这个文件需要额外注意。当前提供的 `script.bat` 只是打开了计算器 `calc.exe` 和 Web_Security.pdf,相对来说是安全的，但用户在使用该漏洞时，完全可以修改此文件，添加更加恶意的payload，具有一定的风险。作者在代码中没有明显投毒行为，主要风险在于用户如何使用该工具生成payload。
投毒风险评估：10% (主要是用户修改 `script.bat` 的风险)

**利用方式：**
1.  **构造恶意ZIP/RAR压缩文件：** 利用提供的Python脚本（cve-2023-38831-exp-gen.py）生成恶意的ZIP/RAR压缩文件。此脚本需要一个诱饵文件（如PDF、PNG、JPG）和一个恶意脚本文件（如BAT、CMD、或可执行文件）。该脚本会创建一个包含诱饵文件和一个同名文件夹的压缩包，并将恶意脚本放置在该文件夹中。
2.  **诱骗用户打开压缩文件：**  将生成的恶意ZIP/RAR压缩文件发送给目标用户。
3.  **执行恶意代码：** 当用户使用受影响的WinRAR版本打开压缩文件并尝试查看诱饵文件时，WinRAR会错误地执行同名文件夹中的恶意脚本，从而实现远程代码执行。

 总体来说，该漏洞利用方式较为简单，攻击成本较低，风险较高。

**项目地址:** [s4m98/winrar-cve-2023-38831-poc-gen](https://github.com/s4m98/winrar-cve-2023-38831-poc-gen)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #25

**来源**: [CVE-2023-38831-solomon12354_VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC.md](../2023/CVE-2023-38831-solomon12354_VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要解压恶意的ZIP/RAR压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 存在于 WinRAR 6.23 之前版本中。攻击者可以构造一个包含良性文件和同名文件夹的 ZIP 压缩包，当用户尝试访问良性文件时，WinRAR 会错误地执行同名文件夹中的恶意代码。提供的 `exploit.py` 脚本可以用于生成包含漏洞利用的RAR压缩文件。脚本首先要求输入良性文件（`bait_file`）、恶意脚本文件（`script_file`）和输出RAR文件名称。然后，它创建一个临时目录，将恶意脚本复制到与良性文件同名的目录中，并将良性文件复制到临时目录中。最后，使用 `shutil.make_archive` 函数将临时目录压缩成 ZIP 文件，并修改 ZIP 文件的内容，将目录名中的 'A' 和 'B' 替换为空格，从而绕过 WinRAR 的安全检查。最终，将修改后的 ZIP 文件重命名为 RAR 文件。

`squid.bat` 用于下载并执行 `volleysquid.exe`。`volleyballsquid.py` 尝试利用 BypassUAC 来提升权限并将程序设置为开机自启。

**有效性:** 根据漏洞信息和利用代码分析，提供的 POC 代码有效，可以利用此漏洞在受害者机器上执行任意代码。

**投毒风险:** 仓库中存在一定的投毒风险，虽然主要功能是利用CVE-2023-38831漏洞，但是 `volleyballsquid.py`和`squid.bat`文件中的行为具有恶意性，特别是`volleyballsquid.py`中尝试使用`BypassUAC`绕过用户账户控制并持久化安装，这可能被用于安装后门或恶意软件。虽然主要目的是展示漏洞，但客观上存在后门功能，因此投毒风险占比为10%。

**利用方式:** 攻击者首先利用 `exploit.py` 脚本生成包含恶意代码的RAR压缩文件。然后，诱骗用户下载并使用 WinRAR 解压此文件。当用户尝试打开压缩包中的“良性”文件时，实际上会执行隐藏在同名目录中的恶意脚本 (例如 `squid.bat`)，下载并执行恶意程序。

根据搜索结果，CVE-2023-38831 漏洞已被广泛利用，并且已被政府背景的攻击者使用，这进一步验证了漏洞的严重性和 POC 代码的有效性。

**项目地址:** [solomon12354/VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC](https://github.com/solomon12354/VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #26

**来源**: [CVE-2023-38831-technicalcorp0_CVE-2023-38831-Exploit.md](../2023/CVE-2023-38831-technicalcorp0_CVE-2023-38831-Exploit.md)

## CVE-2023-38831-WinRAR-任意代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 任意代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个漏洞，该漏洞允许攻击者通过特制的ZIP档案执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** 当WinRAR尝试访问ZIP归档中的良性文件时，如果存在与该良性文件同名的文件夹，WinRAR会处理该文件夹的内容（可能包含可执行内容）。
2.  **利用方式：**
    *   攻击者创建一个恶意的ZIP档案，该档案包含一个良性文件（例如.JPG文件）和一个与该良性文件同名的文件夹。
    *   该文件夹包含恶意可执行文件。
    *   当受害者尝试在WinRAR中查看良性文件时，WinRAR会执行该文件夹中的恶意代码。
3.  **POC有效性：** 提供的POC代码 (CVE-2023-38831-WinRar-Exploit.py) 的目的是生成包含利用此漏洞的恶意 ZIP 文件。根据代码逻辑和漏洞原理，该 POC 可以有效利用该漏洞。
4.  **投毒风险：** 经过对POC代码的分析，发现代码本身实现了漏洞利用过程，但同时也存在一定的投毒风险。`clean_up()`函数会删除临时文件，但不能保证完全清除所有痕迹。攻击者可能通过修改代码，在生成恶意 ZIP 文件后，在目标系统上留下后门或执行其他恶意操作。考虑到实际利用场景中可能存在的恶意修改，投毒风险估计为5%。 主要风险点在于，虽然POC主要目的是生成exploit，但如果恶意人员修改，完全可以添加其他恶意payload，并伪装成CVE-2023-38831的POC进行传播。
5. **搜索引擎结果:** 搜索引擎结果表明此漏洞已被广泛利用，包括政府背景的黑客组织。 多个安全厂商发布了相关的分析和防御措施。

**项目地址:** [technicalcorp0/CVE-2023-38831-Exploit](https://github.com/technicalcorp0/CVE-2023-38831-Exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #27

**来源**: [CVE-2023-38831-xk-mt_WinRAR-Vulnerability-recurrence-tutorial.md](../2023/CVE-2023-38831-xk-mt_WinRAR-Vulnerability-recurrence-tutorial.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。该漏洞允许攻击者通过构造恶意的ZIP压缩包，在用户尝试查看压缩包内的文件时执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，该漏洞已被广泛利用，POC代码的存在也表明其有效性。多个安全厂商和研究人员都对此漏洞进行了分析并提供了相应的缓解措施。

**投毒风险分析：**
提供的POC代码包含以下文件：
*   `README.md`: 漏洞复现教程，包含漏洞信息和参考链接。
*   `执行命令.bat`: 一个简单的批处理文件，用于执行`calc.exe`（计算器程序），用于演示代码执行。
*   `文本.txt`: 包含一个URL地址。
*   `生成压缩包.py`: 一个Python脚本，用于生成包含漏洞的ZIP压缩包。

该脚本的主要功能是：
1.  创建临时目录，并将`执行命令.bat`复制到该目录。
2.  复制`文本.txt`文件到另一个目录。
3.  将上述两个目录打包成ZIP文件。
4.  修改ZIP文件中的文件名，利用漏洞的原理。
从代码本身来看，该脚本并没有明显的恶意代码，但是存在一定的投毒风险。
*   执行命令.bat： 虽然只是简单的calc.exe，但如果攻击者替换成其他恶意命令，则可能造成更大的危害。
*   脚本的依赖： 该脚本依赖Python环境，攻击者可能会通过修改脚本，引入恶意的Python依赖包，从而实现投毒。

综合来看，该仓库中存在一定的投毒风险，但不高。主要是因为演示的`执行命令.bat`内容比较简单，容易被识别。如果使用者直接运行此仓库的代码，有可能会被植入恶意程序。因此，投毒风险评定为10%。

**利用方式：**
1.  攻击者构造一个恶意的ZIP压缩包，该压缩包包含一个良性文件（例如，图片文件`文本.txt`）和一个与该文件同名的文件夹。
2.  该文件夹包含一个恶意可执行文件（例如，`执行命令.bat`并更名为`文本.txtA.cmd`）。
3.  当用户使用受影响的WinRAR版本打开该ZIP压缩包，并尝试查看良性文件时，WinRAR会错误地执行该文件夹中的恶意可执行文件，从而导致任意代码执行。

**项目地址:** [xk-mt/WinRAR-Vulnerability-recurrence-tutorial](https://github.com/xk-mt/WinRAR-Vulnerability-recurrence-tutorial)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #28

**来源**: [CVE-2023-38831-yezzfusl_cve_2023_38831_scanner.md](../2023/CVE-2023-38831-yezzfusl_cve_2023_38831_scanner.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开恶意的 ZIP 压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以通过构造一个特殊的 ZIP 压缩文件来利用此漏洞。该 ZIP 文件包含一个良性文件（例如 JPG）和一个同名的文件夹。当用户尝试访问良性文件时，WinRAR 会错误地执行文件夹中的恶意代码，导致远程代码执行。

**利用方式：**
1.  攻击者创建一个包含良性文件和同名文件夹的恶意 ZIP 文件。
2.  文件夹中包含要执行的恶意代码（例如，可执行文件）。
3.  攻击者诱使用户使用 WinRAR 打开该 ZIP 文件。
4.  当用户尝试访问良性文件时，WinRAR 会执行文件夹中的恶意代码。

**有效性：**
根据漏洞描述和搜索结果，该漏洞已在野外被利用，因此提供的PoC代码如果能够重现该行为，则可以认为是有效的。

**投毒风险：**
提供的代码仓库 `cve_2023_38831_scanner` 本身是一个漏洞扫描器，而非漏洞利用的PoC。尽管如此，仍然存在一定的投毒风险。代码中可能隐藏后门，虽然其主要功能是扫描，但理论上存在被篡改的风险。代码中使用了网络数据包分析、进程内存扫描、沙箱环境执行等模块，这些模块如果被恶意修改，可能被用于执行恶意操作。因此，综合考虑其扫描器的性质和潜在风险，投毒风险估计为10%。这个风险主要来自供应链投毒，如果下载了被篡改过的扫描器，那么扫描器本身可能成为攻击的一部分。

**项目地址:** [yezzfusl/cve_2023_38831_scanner](https://github.com/yezzfusl/cve_2023_38831_scanner)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #29

**来源**: [CVE-2023-38831-youmulijiang_evil-winrar.md](../2023/CVE-2023-38831-youmulijiang_evil-winrar.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 50%

## 详情

CVE-2023-38831是WinRAR在6.23版本之前存在的一个远程代码执行漏洞。该漏洞的利用方式是构造一个特殊的ZIP压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹。当用户尝试在WinRAR中查看该良性文件时，WinRAR会错误地执行该文件夹中的恶意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认该漏洞是有效的，并且已经在野外被利用。漏洞利用代码提供了一个框架，用于生成包含恶意payload的ZIP压缩包，从而实现远程代码执行。

**投毒风险分析：**
提供的代码是一个框架，用于生成漏洞利用的 ZIP 文件，包含生成 exp，邮件发送，下载链接生成等功能。代码中存在潜在的投毒风险，主要体现在以下几个方面：

1.  **Payload 植入:**  该框架可以自定义payload，如果用户在不了解 payload 内容的情况下使用，可能运行恶意指令。
2.  **代码可信度:** 虽然作者声明为安全开发成员，并开源了代码，但代码的安全性仍然需要进一步审计。存在作者预留后门的可能性。 考虑到这是一个漏洞利用框架，其本质就是为了执行恶意代码，所以判定为投毒代码的风险为50%。

**漏洞利用方式：**

1.  攻击者使用该漏洞利用框架(evil-winrar)生成一个恶意的 ZIP 压缩包。
2.  该 ZIP 压缩包包含一个良性文件（如JPG图片）和一个同名的文件夹，文件夹中包含恶意可执行文件。
3.  攻击者通过社会工程学等方式诱骗用户使用存在漏洞的 WinRAR 版本打开该 ZIP 压缩包。
4.  用户尝试查看良性文件时，WinRAR 会错误地执行同名文件夹中的恶意代码。
5.  恶意代码在用户系统上执行，攻击者从而实现远程代码执行，控制受害者的计算机。

**项目地址:** [youmulijiang/evil-winrar](https://github.com/youmulijiang/evil-winrar)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---



---

## POC #3

**来源**: [CVE-2023-38831-MaorBuskila_Windows-X64-RAT.md](../2023/CVE-2023-38831-MaorBuskila_Windows-X64-RAT.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者在用户尝试查看 ZIP 压缩包中的良性文件时执行任意代码。该漏洞源于 WinRAR 处理 ZIP 压缩包时，允许压缩包包含一个良性文件（例如 .JPG）和一个同名文件夹。当用户尝试访问该良性文件时，WinRAR 实际上会处理同名文件夹中的内容，从而允许攻击者在文件夹中放置恶意可执行文件并执行。

**有效性：**
从搜索结果和漏洞库信息来看，该漏洞已经被广泛利用，PoC 代码的存在也进一步验证了其有效性。

**投毒风险：**
提供的 Python 脚本 (`51721.py`) 用于生成 Windows x64 平台的反向 TCP Shellcode。该脚本本身不包含明显的恶意代码，功能是生成 shellcode。需要用户自行配置 IP 地址和端口。但是，由于该代码需要用户执行，并且可以生成任意 shellcode，存在一定投毒风险，例如，如果攻击者提供修改后的脚本，生成包含恶意功能的 shellcode (如删除文件，上传用户信息)，则用户可能无意中执行该恶意 shellcode. 脚本本身不包含网络连接或者其他与远程服务器通信的行为，可以基本判断代码仓库投毒风险较低.

**利用方式：**
1.  攻击者创建一个恶意的 ZIP 压缩包。
2.  该 ZIP 压缩包包含一个良性文件（例如 image.jpg）和一个同名文件夹（image.jpg）。
3.  同名文件夹包含恶意可执行文件，例如 exploit.exe，并可能包含一个 `.lnk` 文件，该快捷方式指向该恶意可执行文件。
4.  攻击者诱骗用户使用受影响版本的 WinRAR 打开该 ZIP 压缩包并尝试查看良性文件。
5.  WinRAR 错误地执行同名文件夹中的恶意可执行文件，从而导致远程代码执行。

**项目地址:** [MaorBuskila/Windows-X64-RAT](https://github.com/MaorBuskila/Windows-X64-RAT)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #4

**来源**: [CVE-2023-38831-MyStuffYT_CVE-2023-38831-POC.md](../2023/CVE-2023-38831-MyStuffYT_CVE-2023-38831-POC.md)

## CVE-2023-38831-WinRAR-远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的恶意ZIP压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个恶意的ZIP压缩文件，其中包含一个良性文件（例如.jpg）和一个同名的文件夹。当用户尝试在 WinRAR 中查看该良性文件时，WinRAR 会错误地执行该文件夹中的内容，从而导致任意代码执行。

**有效性：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。搜索引擎结果表明该漏洞已被广泛利用，POC代码的存在进一步证实了其有效性。

**投毒风险：**

根据对POC代码的分析，存在一定的投毒风险。`script.bat`脚本从github下载`Alert.exe`文件，这本身就存在一定的安全隐患，无法确保下载的文件一定是安全的。此外，脚本同时执行 `alert.exe` 和 `gtaleak.mp4`，而 `gtaleak.mp4` 在 README 中说明是 “zeros without ones”, 可以确定这是一个障眼法，实际的恶意行为是由 `alert.exe` 执行。 因此，作者可能隐藏了投毒代码。

**利用方式：**

1.  攻击者创建一个恶意的ZIP压缩文件，其中包含一个良性文件 (例如 `gtaleak.mp4`) 和一个同名的文件夹。
2.  该文件夹包含一个批处理脚本 (`script.bat`)，该脚本将从远程服务器下载并执行恶意程序 (`Alert.exe`)。
3.  当用户尝试使用 WinRAR 打开压缩文件并查看良性文件 (`gtaleak.mp4`) 时，WinRAR 会错误地执行批处理脚本。
4.  批处理脚本下载并执行恶意程序，从而允许攻击者在受害者的系统上执行任意代码。

**项目地址:** [MyStuffYT/CVE-2023-38831-POC](https://github.com/MyStuffYT/CVE-2023-38831-POC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #5

**来源**: [CVE-2023-38831-Nielk74_CVE-2023-38831.md](../2023/CVE-2023-38831-Nielk74_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本的代码执行漏洞。该漏洞允许攻击者在用户尝试查看ZIP存档中的看似无害的文件时执行任意代码。攻击者通过构造一个包含同名文件和文件夹的恶意ZIP文件，利用WinRAR处理文件路径时的逻辑缺陷，使得文件夹中的恶意可执行文件得以运行。提供的POC代码通过Vagrant自动化部署了一个易受攻击的WinRAR 6.22环境，并向虚拟机桌面添加了一个恶意的rar文件。该rar文件被设计为当用户点击其中的“无害”文件时，执行预先设定的恶意代码。尽管POC的主要目的是演示漏洞，但其中`ChocolateyInstall.ps1`脚本从外部源下载并安装软件包（Chocolatey和WinRAR），存在被篡改从而引入恶意代码的风险，这构成了潜在的投毒风险。虽然这个脚本很常见，但还是存在一定的风险，因此这里给出了10%的投毒风险。

**漏洞利用方式：**

1.  攻击者创建一个恶意的ZIP压缩包，其中包含一个看似无害的文件（例如.jpg），以及一个与该文件同名的文件夹。
2.  该文件夹包含恶意可执行文件，例如.exe或.cmd脚本。
3.  当用户尝试使用WinRAR打开ZIP压缩包并查看“无害”文件时，WinRAR会错误地执行同名文件夹中的恶意可执行文件，从而导致任意代码执行。
4.  攻击者可以利用此漏洞在受害者系统上安装恶意软件、窃取敏感数据或执行其他恶意操作。

**项目地址:** [Nielk74/CVE-2023-38831](https://github.com/Nielk74/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #6

**来源**: [CVE-2023-38831-RomainBayle08_CVE-2023-38831.md](../2023/CVE-2023-38831-RomainBayle08_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP或RAR压缩文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个特殊的 ZIP 压缩文件，该文件包含一个看似无害的文件（例如，.JPG 文件）和一个与该文件同名的文件夹。当用户尝试查看压缩文件中的无害文件时，WinRAR 会错误地执行文件夹中的内容，从而导致任意代码执行。

**有效性分析：**
提供的 POC 代码 `cve-2023-38831-exp-gen.py` 是一个漏洞利用生成器脚本，它接受诱饵文件 (`BAIT_NAME`)、脚本文件 (`SCRIPT_NAME`) 和额外的诱饵文件目录 (`BAIT_FILES`) 作为输入，并生成一个恶意 RAR 压缩文件 (`OUTPUT_NAME`)。脚本首先创建一个包含诱饵文件和脚本文件的临时目录结构，然后使用 `shutil.make_archive` 函数将该目录压缩为 ZIP 文件。关键在于，脚本会替换 ZIP 文件中特定文件的扩展名，利用 WinRAR 的漏洞，在用户尝试打开诱饵文件时执行脚本文件。`script.bat` 脚本会首先尝试打开诱饵文件（模拟用户行为），然后执行 `calc.exe`（作为漏洞利用成功的标志）。该 POC 的有效性较高，因为它模拟了真实的攻击场景。

**投毒风险分析：**
`cve-2023-38831-exp-gen.py` 脚本本身不包含明显的恶意代码或后门。但是，存在一定的投毒风险，因为该脚本允许攻击者指定要执行的任意脚本 (`SCRIPT_NAME`)。攻击者可以替换 `script.bat` 文件为包含恶意代码的文件，例如下载和执行其他恶意软件。此外，该脚本使用了`BAIT_FILES`参数，如果提供包含恶意文件的目录，也会构成投毒风险。所以存在一定投毒风险，但主要取决于用户提供的脚本和目录的内容。

**利用方式分析：**
1.  攻击者构造一个恶意 ZIP 压缩文件，其中包含一个诱饵文件（如 `CLASSIFIED_DOCUMENTS.pdf`）和一个与诱饵文件同名的文件夹。文件夹中包含一个脚本文件（如 `script.bat`）。
2.  攻击者将恶意 ZIP 文件发送给受害者，诱骗其使用 WinRAR 打开。
3.  当受害者尝试查看 ZIP 文件中的诱饵文件时，WinRAR 会错误地执行同名文件夹中的脚本文件。
4.  脚本文件执行任意代码，例如安装恶意软件或窃取敏感信息。

总的来说，该漏洞利用方式简单有效，风险较高。用户应尽快升级到 WinRAR 6.23 或更高版本。

**项目地址:** [RomainBayle08/CVE-2023-38831](https://github.com/RomainBayle08/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #7

**来源**: [CVE-2023-38831-RonF98_CVE-2023-38831-POC.md](../2023/CVE-2023-38831-RonF98_CVE-2023-38831-POC.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致任意代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831 是 WinRAR 在处理 ZIP 压缩文件时存在的一个漏洞。攻击者可以构造一个包含良性文件（例如 .jpg 文件）和一个同名文件夹的 ZIP 压缩包。该文件夹中包含恶意代码（例如 .cmd 文件）。当用户尝试查看良性文件时，WinRAR 会错误地执行文件夹中的恶意代码，从而导致远程代码执行。

**有效性：**

提供的 POC 代码有效，它演示了如何创建一个恶意的 RAR 文件来利用此漏洞。

*   `DoS.cmd` 文件包含恶意代码，用于创建多个消息框，模拟拒绝服务攻击。
*   `exploit.py` 脚本用于生成包含恶意 `DoS.cmd` 文件的 RAR 文件，并利用漏洞触发代码执行。
*   `README.md` 详细解释了漏洞原理和利用方法，并提供了攻击成功的截图。

**投毒风险：**

此仓库中可能存在轻微的投毒风险，约为5%。

*   `DoS.cmd` 只是一个简单的拒绝服务攻击示例，但攻击者可能会将其替换为更具破坏性的恶意代码，例如勒索软件或信息窃取程序。如果下载者不仔细检查 `DoS.cmd` 的内容，可能会在不知情的情况下运行恶意代码。
*   `exploit.py` 脚本本身没有明显的恶意代码，但它可以被修改以生成包含不同恶意代码的 RAR 文件。下载者应该仔细审查脚本的内容，确保它不会被用于传播恶意软件。

**利用方式：**

1.  攻击者创建一个包含良性文件（例如 `image.jpg`）和一个同名文件夹（例如 `image.jpg `）的 ZIP 压缩包。注意文件夹名称后面有一个空格。
2.  在同名文件夹中，攻击者放置恶意代码（例如 `image.jpg .cmd`）。
3.  攻击者将 ZIP 文件转换为 RAR 文件（POC 脚本完成了此过程）。
4.  攻击者诱骗用户使用受影响的 WinRAR 版本打开 RAR 文件并尝试查看良性文件（`image.jpg`）。
5.  WinRAR 错误地执行同名文件夹中的恶意代码 (`image.jpg .cmd`)，从而导致远程代码执行。

由于该漏洞被广泛利用，并且网上存在大量相关的 POC 代码，因此攻击者很容易发起攻击。


**项目地址:** [RonF98/CVE-2023-38831-POC](https://github.com/RonF98/CVE-2023-38831-POC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #8

**来源**: [CVE-2023-38831-SpamixOfficial_CVE-2023-38831.md](../2023/CVE-2023-38831-SpamixOfficial_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前的版本中的代码执行漏洞。攻击者可以制作一个特制的ZIP压缩包，其中包含一个良性文件和一个同名文件夹，文件夹中包含恶意可执行文件。当用户尝试在WinRAR中查看良性文件时，实际上会执行文件夹中的恶意代码。\n\n**有效性：**根据漏洞库信息、搜索结果和漏洞利用代码，该漏洞POC是有效的。漏洞库信息中明确指出该漏洞已在野外被利用。搜索结果中多个链接都指向了关于该漏洞的分析和利用报告。提供的`Cargo.lock`文件很可能只是rust项目依赖管理文件，无法直接证明POC的有效性，需配合rust源码进行分析。\n\n**投毒风险：**分析提供的`Cargo.lock`文件，该文件列出了Rust项目`CVE-2023-38831`的依赖项。虽然`Cargo.lock`本身不包含可执行代码，但是，如果恶意作者修改了依赖项的版本或来源，理论上存在引入被篡改过的crate（Rust包）的风险。不过，由于`Cargo.lock`文件明确指定了每个依赖项的checksum，Cargo在构建项目时会验证下载的crate是否与checksum匹配，从而降低了被投毒的风险。评估投毒风险为10%。\n\n**利用方式：**攻击者创建一个包含以下结构的ZIP压缩包：\n\n1.  一个良性的文件，例如 `image.jpg`\n2.  一个与良性文件同名的文件夹，例如 `image.jpg`\n3.  在同名文件夹中，放置恶意可执行文件，例如 `image.jpg.exe` 或 `image.jpg `(通过空格进行欺骗)。\n\n当用户使用存在漏洞的WinRAR版本打开该ZIP文件并尝试查看`image.jpg`时，WinRAR会错误地执行`image.jpg`文件夹中的恶意程序，从而实现远程代码执行。

**项目地址:** [SpamixOfficial/CVE-2023-38831](https://github.com/SpamixOfficial/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #9

**来源**: [CVE-2023-38831-Tolu12wani_Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution.md](../2023/CVE-2023-38831-Tolu12wani_Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在用户尝试查看 ZIP 压缩包中的文件时执行任意代码。

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开特制的 ZIP 压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者通过构造恶意的 ZIP 压缩包实现远程代码执行。该压缩包包含一个良性文件（例如 JPG）和一个与良性文件同名的文件夹。当用户尝试访问良性文件时，WinRAR 会错误地执行同名文件夹中的内容，从而执行攻击者放置的恶意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被广泛利用。 提供的POC代码描述的是在压缩文件中嵌入恶意payload，并触发反向shell的实验环境验证过程。虽然该代码本身没有包含恶意代码，但描述了如何构建利用该漏洞的压缩文件。

**投毒风险：**
提供的 POC 代码仓库中只包含 PDF 报告和截图，并没有可执行的恶意代码。 但是,README中说明了该仓库展示了恶意payload的嵌入方式，存在一定的潜在风险。 因此，存在一定的投毒风险，但风险较低。根据readme描述和文件结构，投毒风险评估为10%，

**利用方式：**
1.  **创建恶意 ZIP 压缩包：** 攻击者创建一个 ZIP 压缩包，其中包含一个良性文件（例如 JPG）和一个与良性文件同名的文件夹。
2.  **放置恶意代码：** 将恶意可执行文件放置在与良性文件同名的文件夹中。
3.  **诱骗用户：** 诱骗用户使用受影响的 WinRAR 版本打开该 ZIP 压缩包并尝试查看良性文件。
4.  **执行恶意代码：** WinRAR 错误地执行同名文件夹中的恶意代码，从而实现远程代码执行。

根据搜索结果，该漏洞已经被政府支持的攻击者利用，用于投放 RAT（远程访问木马）等恶意软件。

**项目地址:** [Tolu12wani/Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution](https://github.com/Tolu12wani/Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #10

**来源**: [CVE-2023-38831-VictoriousKnight_CVE-2023-38831_Exploit.md](../2023/CVE-2023-38831-VictoriousKnight_CVE-2023-38831_Exploit.md)

## CVE-2023-38831-WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码。

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的恶意ZIP文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个漏洞，它允许攻击者通过构造特殊的ZIP文件来执行任意代码。攻击者创建一个ZIP文件，其中包含一个良性文件（例如，JPG图片）和一个与该良性文件同名的文件夹。该文件夹中包含恶意可执行文件。当用户尝试在WinRAR中查看该良性文件时，WinRAR会错误地执行该文件夹中的恶意代码，从而导致远程代码执行。

**有效性：** 提供的POC代码是有效的。根据漏洞库信息和搜索结果，该漏洞在野外被广泛利用。POC代码通过创建包含良性文件和同名文件夹的恶意ZIP文件，并利用WinRAR处理文件时的缺陷来执行代码。POC代码结构清晰，易于理解和使用。

**投毒风险：** 提供的POC代码本身主要是利用漏洞生成EXP，但仔细检查代码，在`exploit.py`文件的zip文件内容操作部分被截断，没有展示修改zip文件内容的关键代码，作者可能在`Read and manipulate the zip file content`部分添加恶意代码，执行修改zip文件过程中的任何恶意行为。因此存在一定的投毒风险，根据代码完整度，我给出10%的投毒风险。

**利用方式：**
1.  攻击者创建一个恶意ZIP文件，其中包含一个看似无害的文件（例如，一个图片或PDF）。
2.  在ZIP文件中，攻击者同时创建一个与该无害文件同名的文件夹。
3.  该文件夹包含攻击者想要执行的恶意代码，通常是一个可执行文件或脚本。
4.  攻击者诱使用户使用存在漏洞的WinRAR版本打开该ZIP文件。
5.  当用户尝试访问ZIP文件中的“无害”文件时，WinRAR会错误地执行同名文件夹中的恶意代码。

**项目地址:** [VictoriousKnight/CVE-2023-38831_Exploit](https://github.com/VictoriousKnight/CVE-2023-38831_Exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #11

**来源**: [CVE-2023-38831-anelya0333_Exploiting-CVE-2023-38831.md](../2023/CVE-2023-38831-anelya0333_Exploiting-CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开特制的ZIP压缩文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞允许攻击者通过特制的ZIP压缩文件在目标系统上执行任意代码。该漏洞的根源在于WinRAR在处理包含与文件同名文件夹的ZIP文件时存在缺陷。攻击者可以构造一个 ZIP 文件，其中包含一个良性文件（例如.JPG）和一个与其同名的文件夹。当用户尝试在 WinRAR 中查看该良性文件时，WinRAR 会错误地执行该文件夹中的恶意代码。此PoC脚本生成一个ZIP文件，其中包含诱饵文件(bait file)和恶意脚本(script file)，并修改ZIP文件的文件头，以利用此漏洞。脚本创建与诱饵文件同名的文件夹，并将恶意脚本放入其中。然后，将诱饵文件的副本也放入ZIP文件中。通过替换文件名字段中的某些字符，WinRAR会将文件夹中的恶意文件误认为是要执行的文件，最终导致代码执行。由于代码仅仅是构造payload，不存在主动执行恶意代码，因此不存在投毒风险。

**项目地址:** [anelya0333/Exploiting-CVE-2023-38831](https://github.com/anelya0333/Exploiting-CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #12

**来源**: [CVE-2023-38831-b1tg_CVE-2023-38831-winrar-exploit.md](../2023/CVE-2023-38831-b1tg_CVE-2023-38831-winrar-exploit.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可导致完全系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开恶意构造的ZIP文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 允许攻击者通过特制的ZIP文件在受害者系统上执行任意代码。该漏洞源于 WinRAR 处理包含同名文件和文件夹的 ZIP 档案时的不当行为。攻击者可以创建一个 ZIP 文件，其中包含一个良性文件（例如 CLASSIFIED_DOCUMENTS.pdf）和一个同名文件夹（例如 CLASSIFIED_DOCUMENTS.pdf）。当用户尝试访问良性文件时，WinRAR 实际上会执行该文件夹中的内容（例如 script.bat）。

**有效性:**

提供的 POC 代码 `cve-2023-38831-exp-gen.py` 旨在生成利用此漏洞的恶意 RAR 档案。该脚本通过以下步骤工作：

1.  创建临时目录 `TEMPLATE`。
2.  在 `TEMPLATE` 中创建一个与bait文件同名的文件夹，并在其中存放包含恶意命令的script文件（例如 `script.bat`， 其中包含`calc.exe & CLASSIFIED_DOCUMENTS.pdf`）。
3.  将bait文件存放在`TEMPLATE`目录。
4.  将`TEMPLATE`目录压缩为zip文件。
5.  修改压缩包中文件和文件夹的名字，构造漏洞。
6.  最终输出 `CVE-2023-38831-poc.rar`。

该脚本能够有效地生成利用 CVE-2023-38831 的 RAR 文件，因此提供的 POC 代码是有效的。

**投毒风险:**

对提供的 POC 代码 (`cve-2023-38831-exp-gen.py` 和 `script.bat`) 进行分析后，未发现明显的恶意代码或后门。该脚本的功能明确且集中于生成利用 CVE-2023-38831 的 RAR 档案。 `script.bat` 的主要功能是启动计算器程序 (`calc.exe`) 并尝试打开诱饵文档 (`CLASSIFIED_DOCUMENTS.pdf`)，这是一个典型的 PoC 行为。 因此，该仓库中存在作者隐藏的投毒代码的风险极低。

**利用方式:**

1.  攻击者使用 `cve-2023-38831-exp-gen.py` 脚本，指定诱饵文件（例如 `CLASSIFIED_DOCUMENTS.pdf`）和恶意脚本（例如 `script.bat`），生成恶意 RAR 档案。
2.  攻击者通过各种方式（例如，电子邮件、恶意网站）将恶意 RAR 档案分发给受害者。
3.  受害者使用易受攻击的 WinRAR 版本（< 6.23）打开恶意 RAR 档案。
4.  当受害者尝试访问诱饵文件时，WinRAR 错误地执行了同名文件夹中的恶意脚本。
5.  恶意脚本在受害者系统上执行任意代码，例如启动计算器或安装恶意软件。

**项目地址:** [b1tg/CVE-2023-38831-winrar-exploit](https://github.com/b1tg/CVE-2023-38831-winrar-exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #13

**来源**: [CVE-2023-38831-elefantesagradodeluzinfinita_cve-2023-38831.md](../2023/CVE-2023-38831-elefantesagradodeluzinfinita_cve-2023-38831.md)

## CVE-2023-38831 - WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用 WinRAR 打开特制的 ZIP 压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者通过特制的 ZIP 压缩包在受害者系统上执行任意代码。漏洞利用方式是创建一个 ZIP 压缩包，其中包含一个良性文件（例如 .jpg 或 .pdf）以及一个同名的文件夹。该文件夹包含恶意的可执行文件（例如 .cmd 或 .exe）。当用户尝试打开良性文件时，WinRAR 会错误地执行文件夹中的恶意代码。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码分析，该漏洞确实存在并且已经被野外利用。提供的代码描述了一个利用工具 "DR. GANDALF"，它允许用户创建包含此漏洞的 ZIP 文件，表明POC的有效性。

**投毒风险：** 提供的 README.md 文件主要描述了漏洞原理和利用工具的使用方法。但是，由于此工具允许用户自定义注入的代码和二进制文件，因此存在投毒风险。如果用户下载了包含恶意注入代码的ZIP文件，那么这个工具本身可能被利用来传播恶意软件。评估投毒风险为 10%，因为该描述文件本身不包含可以直接执行的后门代码，但生成的ZIP文件可以包含。

**利用方式：**
1.  攻击者创建一个包含恶意 ZIP 压缩包。
2.  ZIP 压缩包中包含一个良性文件（例如，`image.jpg`）和一个同名的文件夹（例如，`image.jpg`）。
3.  `image.jpg` 文件夹包含恶意的可执行文件（例如，`evil.cmd`）。
4.  攻击者诱骗受害者使用存在漏洞的 WinRAR 版本打开该 ZIP 压缩包并尝试访问良性文件 `image.jpg`。
5.  WinRAR 在处理该 ZIP 文件时，会错误地执行 `image.jpg` 文件夹中的恶意代码 `evil.cmd`，从而导致远程代码执行。

**项目地址:** [elefantesagradodeluzinfinita/cve-2023-38831](https://github.com/elefantesagradodeluzinfinita/cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #14

**来源**: [CVE-2023-38831-h3xecute_SideCopy-Exploits-CVE-2023-38831.md](../2023/CVE-2023-38831-h3xecute_SideCopy-Exploits-CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个远程代码执行漏洞。该漏洞的利用方式是构造一个特殊的ZIP压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹。当用户尝试使用WinRAR打开该ZIP压缩包并访问良性文件时，WinRAR会错误地执行文件夹中的恶意代码。

**有效性：**
提供的POC代码描述了漏洞利用的原理，即构造包含同名良性文件和文件夹的ZIP压缩包。根据漏洞信息和搜索结果，此方法是有效的，并且在野外被利用。

**投毒风险：**
该POC本身描述了漏洞的利用方式，包含一个指向YouTube视频的链接，以及对恶意压缩包结构的描述。投毒风险较低，约为10%，因为：
1.  POC主要以描述性文字和图片链接为主。
2.  缺乏直接可执行的payload代码。
3.  作者可能通过YouTube链接传播恶意信息。

**利用方式：**
1.  攻击者创建一个恶意的ZIP压缩包。
2.  该压缩包包含一个良性文件（例如JPG，PDF等）和一个与该文件同名的文件夹。
3.  恶意代码（例如，可执行文件）放置在同名文件夹中。
4.  攻击者诱骗用户使用WinRAR打开这个ZIP压缩包，并尝试访问良性文件。
5.  WinRAR在处理压缩包时，会错误地执行同名文件夹中的恶意代码，从而导致远程代码执行。

**项目地址:** [h3xecute/SideCopy-Exploits-CVE-2023-38831](https://github.com/h3xecute/SideCopy-Exploits-CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #15

**来源**: [CVE-2023-38831-idkwastaken_CVE-2023-38831.md](../2023/CVE-2023-38831-idkwastaken_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意的ZIP文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的漏洞。该漏洞的利用方式是创建一个特制的ZIP文件，其中包含一个良性文件和一个同名文件夹。当用户尝试使用WinRAR打开ZIP文件并访问该良性文件时，WinRAR会错误地执行该同名文件夹中的恶意代码，导致远程代码执行。

**有效性：**
提供的POC代码（exploit.c）利用了该漏洞。该代码生成一个ZIP文件，其中包含一个PDF文件（document.pdf）和一个名为“document.pdf\”的文件夹，该文件夹内包含一个恶意的批处理脚本（script.bat）。当用户在易受攻击的WinRAR版本中打开并尝试访问该PDF文件时，WinRAR将执行该批处理脚本。
checker.bat 是用来检测目标系统是否安装WinRAR，以及WinRAR的版本是否是受影响的版本。
exploit.ps1 看起来不完整，但是其作用应该是检查WinRAR版本。

**投毒风险：**
代码中存在一定的投毒风险，约为10%。原因如下：
*   **脚本内容可控：** exploit.c 中的script_content变量包含了要执行的命令，虽然当前POC仅仅是弹窗，但是攻击者可以修改这个变量，执行任意命令，例如下载恶意软件，执行系统命令等。
*   **复杂的构建过程：** exploit.c 代码本身比较复杂，阅读和分析需要一定的时间和精力。攻击者可以利用这一点，在代码中隐藏不易察觉的恶意代码。
虽然有潜在的投毒风险，但当前代码的主要目的是演示漏洞利用，风险较低，作者没有明显的隐藏后门行为，恶意代码比较容易被发现。

**利用方式：**
1.  攻击者创建一个恶意的ZIP压缩包，其中包含：
    *   一个良性的文件（例如 document.pdf）。
    *   一个与良性文件同名的文件夹（例如 document.pdf/）。
    *   恶意代码位于同名文件夹中（例如 document.pdf/script.bat）。
2.  攻击者诱骗目标用户使用存在漏洞的 WinRAR 版本打开此 ZIP 压缩包。
3.  当用户尝试打开良性文件时，WinRAR 错误地执行同名文件夹中的恶意代码，从而导致任意代码执行。


**项目地址:** [idkwastaken/CVE-2023-38831](https://github.com/idkwastaken/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #16

**来源**: [CVE-2023-38831-imbyter_imbyter-WinRAR_CVE-2023-38831.md](../2023/CVE-2023-38831-imbyter_imbyter-WinRAR_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 6.23

**利用条件:** 用户使用受影响的WinRAR版本打开特制的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于WinRAR 6.23之前的版本中。攻击者可以构造一个恶意的ZIP压缩包，其中包含一个伪装成良性文件的文件（例如 .jpg），以及一个同名的文件夹。当用户尝试在 WinRAR 中查看该“良性文件”时，实际上会执行同名文件夹中的恶意代码（例如 .cmd 或 .exe 文件）。

**有效性：**
根据漏洞信息和搜索结果，提供的POC代码是有效的。该POC利用了WinRAR处理ZIP压缩包时存在的逻辑漏洞，能够实现远程代码执行。

**投毒风险：**
提供的Python脚本 `make-poc.py` 用于生成POC压缩包，其本身的代码逻辑相对简单，主要功能是将指定的文件和脚本打包成特定的ZIP格式，并进行一些字符串替换以触发漏洞。主要风险在于脚本生成的POC包中包含的脚本，如果这个脚本是恶意的，那么整个利用过程就存在投毒风险。 仓库中的README.md文件里的测试脚本就是一个关闭计算机的脚本。代码本身存在一定的投毒风险.

*   脚本逻辑：脚本的功能是创建包含漏洞利用结构的RAR文件。
*   恶意操作：如果脚本被修改以包含下载和执行恶意软件的逻辑，那么用户在使用此脚本创建RAR文件时，就会受到投毒攻击。

**利用方式：**
1.  攻击者使用 `make-poc.py` 脚本构造恶意的ZIP压缩包，需要提供一个“良性”文件和一个恶意脚本。
2.  攻击者将恶意的ZIP压缩包发送给受害者。
3.  受害者使用受影响的WinRAR版本打开该ZIP压缩包，并尝试查看伪装的“良性”文件。
4.  WinRAR错误地执行了与“良性”文件同名的文件夹中的恶意脚本，导致远程代码执行。

**防御措施：**
*   升级WinRAR到6.23或更高版本。
*   谨慎打开来源不明的ZIP压缩包。
*   使用杀毒软件扫描ZIP压缩包。

**项目地址:** [imbyter/imbyter-WinRAR_CVE-2023-38831](https://github.com/imbyter/imbyter-WinRAR_CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #17

**来源**: [CVE-2023-38831-kehrijksen_CVE-2023-38831.md](../2023/CVE-2023-38831-kehrijksen_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 需要用户解压特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个恶意的 ZIP 压缩包，其中包含一个伪装成普通文件的文件和一个同名的文件夹。当用户尝试在 WinRAR 中查看该“普通文件”时，WinRAR 会错误地执行同名文件夹中的内容，从而导致任意代码执行。

**有效性：**
提供的 PoC 代码 `poc.py` 能够生成利用此漏洞的恶意 ZIP 压缩包。该脚本首先创建一个包含恶意 payload (例如 script.bat) 和良性文件 (例如 pepe.jpg) 的目录结构。然后，它将此目录结构压缩成 ZIP 文件，并修改 ZIP 文件中的文件名，以触发漏洞。`script.bat` 的作用是在 `%TEMP%` 目录下提取 ZIP 文件内容，运行良性文件作为诱饵，然后执行恶意操作，例如创建一个包含 “hacked” 内容的文本文件并使用记事本打开。

**投毒风险：**
分析提供的代码，没有发现明显的投毒代码。`poc.py` 的作用是生成恶意 ZIP 文件，而 `script.bat` 包含的是恶意行为的代码，例如运行良性文件，创建 `hacked.txt` 等。这些行为是漏洞利用的一部分，而不是隐藏的恶意代码。虽然利用 `script.bat` 可以执行任意操作，但这属于漏洞利用的范畴，而非代码投毒。

**利用方式：**
1.  攻击者使用 `poc.py` 脚本生成一个恶意的 ZIP 压缩包，其中包含一个良性文件（例如图片）和一个同名的文件夹。
2.  攻击者将此恶意 ZIP 压缩包发送给受害者。
3.  受害者使用 WinRAR (6.23 之前的版本) 打开并尝试查看 ZIP 压缩包中的良性文件。
4.  WinRAR 错误地执行与良性文件同名的文件夹中的内容 (由 `script.bat` 控制)。
5.  `script.bat` 首先将 ZIP 文件的内容解压到临时目录。
6.  `script.bat` 运行良性文件（例如图片）作为诱饵，以迷惑受害者。
7.  `script.bat` 执行任意恶意操作，例如创建文件，修改注册表，安装恶意软件等。


**项目地址:** [kehrijksen/CVE-2023-38831](https://github.com/kehrijksen/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #18

**来源**: [CVE-2023-38831-khanhtranngoccva_cve-2023-38831-poc.md](../2023/CVE-2023-38831-khanhtranngoccva_cve-2023-38831-poc.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。该漏洞源于WinRAR处理ZIP压缩包时，对文件名和文件夹名区分不当。攻击者可以创建一个ZIP压缩包，其中包含一个良性文件（例如JPG）和一个同名的文件夹。该文件夹中包含恶意可执行文件。当用户尝试在WinRAR中打开该良性文件时，WinRAR会错误地执行文件夹中的恶意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已在野外被利用，证明了其有效性。提供的POC代码片段（package-lock.json）显示使用了jszip库，表明该POC可能用于创建恶意的ZIP压缩包，进一步验证漏洞的可利用性。

**投毒风险：**
提供的POC代码片段是`package-lock.json`文件，主要描述了项目依赖。要判断是否存在投毒风险，需要检查实际的利用代码（例如 index.ts/index.js）。
*   这个`package-lock.json`文件本身不包含恶意代码，只是依赖声明。
*   **风险点在于开发者可能在其他代码文件中（如index.ts等，此文件未提供）包含恶意代码**。
*   jszip 库本身是一个常用的 ZIP 文件操作库，被投毒的可能性较低。
*   tsx和typescript是typescript相关工具，本身被投毒的可能性也比较低

由于缺乏实际的利用代码，无法确定是否存在投毒行为，只能根据现有信息进行推测，因此将投毒风险评估为10%。

**利用方式：**
1.  攻击者构造一个恶意的ZIP压缩包。
2.  该ZIP压缩包包含一个良性文件（例如JPG）和一个同名的文件夹。
3.  该文件夹中包含恶意可执行文件（例如EXE、BAT、CMD等）。
4.  攻击者诱骗用户使用受影响的WinRAR版本打开该ZIP压缩包。
5.  用户尝试在WinRAR中打开该良性文件。
6.  WinRAR错误地执行文件夹中的恶意代码，导致远程代码执行。

**项目地址:** [khanhtranngoccva/cve-2023-38831-poc](https://github.com/khanhtranngoccva/cve-2023-38831-poc)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #19

**来源**: [CVE-2023-38831-kuyrathdaro_winrar-cve-2023-38831.md](../2023/CVE-2023-38831-kuyrathdaro_winrar-cve-2023-38831.md)

## CVE-2023-38831-WinRAR代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个代码执行漏洞。该漏洞的利用方式如下：

1.  攻击者创建一个恶意的ZIP压缩包（伪装成RAR格式，后缀名为.rar）。
2.  该压缩包包含一个良性的文件（例如，document.pdf），以及一个与该良性文件同名的文件夹（例如，document.pdf）。
3.  同名文件夹中包含恶意payload（例如，一个.bat或.exe文件），命名为`document.pdfA.cmd`。
4.  用户使用存在漏洞的WinRAR版本打开该压缩包，并尝试打开良性文件（document.pdf）。
5.  由于WinRAR处理文件名的缺陷，实际上执行的是同名文件夹中的恶意payload。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以判断该漏洞PoC有效。搜索引擎结果中多个链接表明该漏洞已被广泛利用，并且Google的威胁分析小组也分析了利用该漏洞进行的攻击活动。提供的PoC代码实现了生成恶意RAR压缩包的逻辑，进一步验证了该漏洞的可利用性。

**投毒风险：**

PoC代码本身的主要功能是生成利用CVE-2023-38831漏洞的恶意压缩包。然而，我们仍然需要评估该代码是否存在潜在的投毒风险。以下是对代码的分析：

*   **代码功能明确：** PoC代码的功能是生成特定的文件结构和内容，以触发WinRAR漏洞。代码逻辑相对简单，易于理解。
*   **输入/输出控制：** PoC代码接受三个输入参数：良性文件、Payload文件和输出文件名。这三个参数都由用户指定，PoC本身没有主动下载或执行任何其他代码的功能。
*   **潜在风险点：** `exploit.py` 脚本使用 `shutil.copyfile` 函数来复制 payload 文件到临时目录，如果payload 文件本身就是恶意的，那么这也会造成风险。此外，尽管脚本尝试确保输出文件以 `.rar` 结尾，但恶意用户可能修改此行为。
*   **间接风险：** 如果攻击者修改了提供的 `exploit.py` 脚本，添加额外的恶意功能（例如，在生成恶意压缩包后，自动上传到恶意服务器），则可能存在投毒风险。但是，这并非原始PoC代码本身的问题。

综合来看，原始PoC代码本身存在直接投毒的风险较低，我估计的投毒风险概率为 **10%**。这主要是因为恶意 payload 本身会带来风险，但 PoC 代码并没有主动引入恶意行为。

**利用方式：**

1.  准备一个良性的文件（例如，document.pdf）和一个恶意payload（例如，script.bat或malware.exe）。
2.  运行PoC脚本，指定良性文件、payload文件和输出文件名。
3.  PoC脚本生成一个恶意的RAR压缩包（实际上是ZIP格式，但后缀名为.rar）。
4.  将该恶意RAR压缩包发送给目标用户。
5.  目标用户使用存在漏洞的WinRAR版本打开该压缩包，并尝试打开良性文件。
6.  WinRAR执行同名文件夹中的恶意payload，从而实现代码执行。


**项目地址:** [kuyrathdaro/winrar-cve-2023-38831](https://github.com/kuyrathdaro/winrar-cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #20

**来源**: [CVE-2023-38831-malvika-thakur_CVE-2023-38831.md](../2023/CVE-2023-38831-malvika-thakur_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以通过创建一个特制的 ZIP 压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹，文件夹中包含恶意可执行文件。当用户尝试在 WinRAR 中查看该良性文件时，由于 WinRAR 处理逻辑的缺陷，会错误地执行文件夹中的恶意代码，从而导致远程代码执行。

**有效性：**

提供的 POC 代码 `poc.py`  可以生成利用此漏洞的 ZIP 文件。代码首先检查恶意脚本和良性文件是否存在，然后创建一个目录，将脚本和良性文件复制到特定结构中，最后将该目录压缩成 ZIP 文件。用户只需双击压缩包内的良性文件即可触发漏洞，执行恶意脚本。因此，POC 代码有效。

**投毒风险：**

分析提供的 `poc.py` 代码，没有发现明显的投毒代码。该脚本的主要功能是生成利用 CVE-2023-38831 漏洞的恶意 ZIP 文件。它需要用户提供恶意脚本和良性文件，然后按照特定目录结构进行组织并压缩。代码中没有发现任何会执行额外恶意操作的逻辑。`README.md` 文件也仅包含漏洞描述和使用说明，没有发现恶意内容。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者创建一个包含良性文件（如 JPG 图片）和一个同名文件夹的 ZIP 压缩包。
2.  该文件夹中包含恶意可执行文件（如 BAT 脚本）。
3.  攻击者将该 ZIP 压缩包发送给目标用户。
4.  目标用户使用受影响的 WinRAR 版本打开该 ZIP 压缩包。
5.  目标用户双击 ZIP 压缩包中的良性文件。
6.  WinRAR 错误地执行同名文件夹中的恶意可执行文件，导致远程代码执行。

**项目地址:** [malvika-thakur/CVE-2023-38831](https://github.com/malvika-thakur/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #21

**来源**: [CVE-2023-38831-r1yaz_winDED.md](../2023/CVE-2023-38831-r1yaz_winDED.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开特制的恶意 ZIP 压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 是 WinRAR 在处理 ZIP 压缩文件时存在的远程代码执行漏洞。当 WinRAR 版本低于 6.23 时，如果用户尝试打开一个包含恶意构造的 ZIP 文件，攻击者可以利用此漏洞执行任意代码。该 ZIP 文件包含一个良性文件（例如 JPG 文件）和一个与其同名的文件夹。攻击者可以将可执行文件放置在该文件夹中，当用户尝试访问良性文件时，WinRAR 会错误地执行文件夹中的可执行文件。

**有效性：**
提供的 POC 代码（winDED）通过生成恶意 ZIP 文件来演示漏洞利用。它创建了一个良性文件和一个同名文件夹，并将恶意脚本放入文件夹中。用户双击压缩包中的 PDF 文件时，实际上会执行该恶意脚本，从而证明漏洞的可利用性。

**投毒风险：**
根据提供的 POC 代码，投毒风险较低。代码主要是为了演示漏洞而设计的，虽然存在执行恶意 `super_sneaky_evil_script.bat` 的可能性，但该脚本本身是由用户提供的，或者可以通过查看代码本身来确认其行为。 然而，仍然存在一些细微的风险，例如，如果 `super_sneaky_evil_script.bat` 本身是从其他来源下载的，则可能包含恶意代码。  总的来说, 投毒风险约 10%。

**利用方式：**
1.  创建一个包含良性文件 (例如，`BILLION_DOLLAR_SECRET.pdf`) 和一个同名文件夹 (`BILLION_DOLLAR_SECRET.pdf`) 的 ZIP 压缩文件。
2.  将恶意脚本 (例如，`super_sneaky_evil_script.bat`) 放入同名文件夹中。
3.  诱骗目标用户使用 WinRAR 打开该 ZIP 文件。
4.  当用户尝试打开良性文件时，WinRAR 错误地执行同名文件夹中的恶意脚本，从而实现远程代码执行。

**项目地址:** [r1yaz/winDED](https://github.com/r1yaz/winDED)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #22

**来源**: [CVE-2023-38831-ra3edAJ_LAB-DFIR-cve-2023-38831.md](../2023/CVE-2023-38831-ra3edAJ_LAB-DFIR-cve-2023-38831.md)

## CVE-2023-38831-WinRAR代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 是 WinRAR 在 6.23 版本之前存在的远程代码执行漏洞。该漏洞源于WinRAR处理ZIP压缩包时，如果压缩包中包含一个良性文件和一个与该良性文件同名的文件夹，WinRAR在尝试访问良性文件时，会错误地执行同名文件夹中的恶意内容。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的PoC是可用的。漏洞在野外被广泛利用，并且CISA已将其添加到已知被利用的漏洞目录中。

**投毒风险：**
提供的漏洞利用代码为一个Github仓库的README.md文件，主要描述了如何利用磁盘镜像调查CVE-2023-38831攻击，并通过Windows注册表、NTFS文件和浏览器缓存理解Windows事件序列。仓库本身目的是为了DFIR分析，因此直接包含恶意代码的可能性较低。但考虑到链接跳转至外部教程网站，存在间接投毒的可能，即教程内容可能包含引导至恶意软件下载或运行恶意脚本的指令。因此，投毒风险较低，评估为10%。

**利用方式：**
1.  **创建恶意的ZIP压缩包：** 压缩包中包含一个良性文件（如JPG图片）和一个与该良性文件同名的文件夹。
2.  **将恶意可执行文件放入同名文件夹：** 该文件夹中的可执行文件会在用户尝试打开良性文件时被执行。
3.  **诱导用户打开ZIP压缩包：** 通过社交工程或其他方式，诱导用户使用受影响版本的WinRAR打开该压缩包。
4.  **触发漏洞执行恶意代码：** 当用户尝试查看ZIP压缩包中的良性文件时，WinRAR会错误地执行同名文件夹中的恶意代码，从而实现远程代码执行。

**总结：**
该漏洞利用方式较为简单，易于传播，危害较大。用户应及时更新WinRAR至最新版本，避免打开来源不明的ZIP压缩包。

**项目地址:** [ra3edAJ/LAB-DFIR-cve-2023-38831](https://github.com/ra3edAJ/LAB-DFIR-cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #23

**来源**: [CVE-2023-38831-ruycr4ft_CVE-2023-38831.md](../2023/CVE-2023-38831-ruycr4ft_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的远程代码执行漏洞。该漏洞源于WinRAR在处理ZIP压缩包时，对文件名和文件夹名相同的情况处理不当。攻击者可以构造一个恶意的ZIP压缩包，其中包含一个看似无害的文件（例如.jpg），同时包含一个同名的文件夹。当用户尝试打开该“无害文件”时，WinRAR会错误地执行同名文件夹中的恶意代码。\n\n**有效性：** 根据漏洞信息、搜索结果以及提供的POC代码，该漏洞利用是有效的。多个来源都表明该漏洞已被广泛利用，POC代码也展示了如何生成包含恶意代码的RAR压缩文件。POC代码通过创建同名文件和文件夹，并在文件夹中放入恶意脚本，利用WinRAR的缺陷触发代码执行。\n\n**投毒风险：**  仓库的投毒风险较低，大概10%。
  *   `poc.py`: 该脚本的功能是生成利用 CVE-2023-38831 的恶意 RAR 文件。虽然它允许用户指定 bait 文件和脚本文件，但脚本本身不包含任何预设的、隐藏的恶意行为。
  *   `script.bat`:  这个批处理文件包含使用 `nc.exe` (netcat) 反弹 shell 的命令。**这里存在一定的投毒风险。** 批处理文件明确地使用了`192.168.0.107`这个IP地址,如果用户直接使用该IP反弹shell,将会连接到攻击者的服务器。虽然IP地址可以被用户更改，但在默认情况下，如果用户不修改，将会连接到攻击者的IP。这是主要的投毒点。
  *   README.md: 该文件仅包含漏洞的简单介绍和演示图片。没有发现恶意代码。

**利用方式：**\n1.  攻击者创建一个恶意的ZIP压缩包。该压缩包包含一个诱饵文件（例如图片.jpg）和一个与其同名的文件夹（例如图片.jpg）。\n2.  攻击者将恶意代码（例如一个批处理脚本或可执行文件）放入同名文件夹中。\n3.  攻击者将包含恶意代码的ZIP压缩包发送给受害者。\n4.  受害者使用存在漏洞的WinRAR版本打开该ZIP压缩包，并尝试打开诱饵文件。\n5.  WinRAR错误地执行同名文件夹中的恶意代码，导致远程代码执行。

**项目地址:** [ruycr4ft/CVE-2023-38831](https://github.com/ruycr4ft/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #24

**来源**: [CVE-2023-38831-s4m98_winrar-cve-2023-38831-poc-gen.md](../2023/CVE-2023-38831-s4m98_winrar-cve-2023-38831-poc-gen.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开恶意的ZIP/RAR压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于WinRAR处理ZIP压缩文件时，由于对文件名和文件夹名处理不当导致。攻击者可以构造一个包含恶意脚本的ZIP压缩文件，该压缩文件包含一个正常的诱饵文件（如PDF、PNG或JPG）和一个同名的文件夹，当用户尝试打开诱饵文件时，WinRAR会错误地执行该文件夹中的恶意脚本。

**有效性：**
根据漏洞信息、搜索引擎结果和漏洞利用代码，该POC代码有效。漏洞库信息表明该漏洞已被野外利用。搜索引擎结果中也包含了大量关于此漏洞的分析和利用报告，证实了该漏洞的有效性。POC代码的描述和实现也符合漏洞的利用方式，通过生成包含恶意脚本和诱饵文件的RAR压缩包来触发漏洞。

**投毒风险：**
代码本身看起来比较直接，主要是生成利用漏洞的压缩包。`script.bat` 这个文件需要额外注意。当前提供的 `script.bat` 只是打开了计算器 `calc.exe` 和 Web_Security.pdf,相对来说是安全的，但用户在使用该漏洞时，完全可以修改此文件，添加更加恶意的payload，具有一定的风险。作者在代码中没有明显投毒行为，主要风险在于用户如何使用该工具生成payload。
投毒风险评估：10% (主要是用户修改 `script.bat` 的风险)

**利用方式：**
1.  **构造恶意ZIP/RAR压缩文件：** 利用提供的Python脚本（cve-2023-38831-exp-gen.py）生成恶意的ZIP/RAR压缩文件。此脚本需要一个诱饵文件（如PDF、PNG、JPG）和一个恶意脚本文件（如BAT、CMD、或可执行文件）。该脚本会创建一个包含诱饵文件和一个同名文件夹的压缩包，并将恶意脚本放置在该文件夹中。
2.  **诱骗用户打开压缩文件：**  将生成的恶意ZIP/RAR压缩文件发送给目标用户。
3.  **执行恶意代码：** 当用户使用受影响的WinRAR版本打开压缩文件并尝试查看诱饵文件时，WinRAR会错误地执行同名文件夹中的恶意脚本，从而实现远程代码执行。

 总体来说，该漏洞利用方式较为简单，攻击成本较低，风险较高。

**项目地址:** [s4m98/winrar-cve-2023-38831-poc-gen](https://github.com/s4m98/winrar-cve-2023-38831-poc-gen)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #25

**来源**: [CVE-2023-38831-solomon12354_VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC.md](../2023/CVE-2023-38831-solomon12354_VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要解压恶意的ZIP/RAR压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 存在于 WinRAR 6.23 之前版本中。攻击者可以构造一个包含良性文件和同名文件夹的 ZIP 压缩包，当用户尝试访问良性文件时，WinRAR 会错误地执行同名文件夹中的恶意代码。提供的 `exploit.py` 脚本可以用于生成包含漏洞利用的RAR压缩文件。脚本首先要求输入良性文件（`bait_file`）、恶意脚本文件（`script_file`）和输出RAR文件名称。然后，它创建一个临时目录，将恶意脚本复制到与良性文件同名的目录中，并将良性文件复制到临时目录中。最后，使用 `shutil.make_archive` 函数将临时目录压缩成 ZIP 文件，并修改 ZIP 文件的内容，将目录名中的 'A' 和 'B' 替换为空格，从而绕过 WinRAR 的安全检查。最终，将修改后的 ZIP 文件重命名为 RAR 文件。

`squid.bat` 用于下载并执行 `volleysquid.exe`。`volleyballsquid.py` 尝试利用 BypassUAC 来提升权限并将程序设置为开机自启。

**有效性:** 根据漏洞信息和利用代码分析，提供的 POC 代码有效，可以利用此漏洞在受害者机器上执行任意代码。

**投毒风险:** 仓库中存在一定的投毒风险，虽然主要功能是利用CVE-2023-38831漏洞，但是 `volleyballsquid.py`和`squid.bat`文件中的行为具有恶意性，特别是`volleyballsquid.py`中尝试使用`BypassUAC`绕过用户账户控制并持久化安装，这可能被用于安装后门或恶意软件。虽然主要目的是展示漏洞，但客观上存在后门功能，因此投毒风险占比为10%。

**利用方式:** 攻击者首先利用 `exploit.py` 脚本生成包含恶意代码的RAR压缩文件。然后，诱骗用户下载并使用 WinRAR 解压此文件。当用户尝试打开压缩包中的“良性”文件时，实际上会执行隐藏在同名目录中的恶意脚本 (例如 `squid.bat`)，下载并执行恶意程序。

根据搜索结果，CVE-2023-38831 漏洞已被广泛利用，并且已被政府背景的攻击者使用，这进一步验证了漏洞的严重性和 POC 代码的有效性。

**项目地址:** [solomon12354/VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC](https://github.com/solomon12354/VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #26

**来源**: [CVE-2023-38831-technicalcorp0_CVE-2023-38831-Exploit.md](../2023/CVE-2023-38831-technicalcorp0_CVE-2023-38831-Exploit.md)

## CVE-2023-38831-WinRAR-任意代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 任意代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个漏洞，该漏洞允许攻击者通过特制的ZIP档案执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** 当WinRAR尝试访问ZIP归档中的良性文件时，如果存在与该良性文件同名的文件夹，WinRAR会处理该文件夹的内容（可能包含可执行内容）。
2.  **利用方式：**
    *   攻击者创建一个恶意的ZIP档案，该档案包含一个良性文件（例如.JPG文件）和一个与该良性文件同名的文件夹。
    *   该文件夹包含恶意可执行文件。
    *   当受害者尝试在WinRAR中查看良性文件时，WinRAR会执行该文件夹中的恶意代码。
3.  **POC有效性：** 提供的POC代码 (CVE-2023-38831-WinRar-Exploit.py) 的目的是生成包含利用此漏洞的恶意 ZIP 文件。根据代码逻辑和漏洞原理，该 POC 可以有效利用该漏洞。
4.  **投毒风险：** 经过对POC代码的分析，发现代码本身实现了漏洞利用过程，但同时也存在一定的投毒风险。`clean_up()`函数会删除临时文件，但不能保证完全清除所有痕迹。攻击者可能通过修改代码，在生成恶意 ZIP 文件后，在目标系统上留下后门或执行其他恶意操作。考虑到实际利用场景中可能存在的恶意修改，投毒风险估计为5%。 主要风险点在于，虽然POC主要目的是生成exploit，但如果恶意人员修改，完全可以添加其他恶意payload，并伪装成CVE-2023-38831的POC进行传播。
5. **搜索引擎结果:** 搜索引擎结果表明此漏洞已被广泛利用，包括政府背景的黑客组织。 多个安全厂商发布了相关的分析和防御措施。

**项目地址:** [technicalcorp0/CVE-2023-38831-Exploit](https://github.com/technicalcorp0/CVE-2023-38831-Exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #27

**来源**: [CVE-2023-38831-xk-mt_WinRAR-Vulnerability-recurrence-tutorial.md](../2023/CVE-2023-38831-xk-mt_WinRAR-Vulnerability-recurrence-tutorial.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。该漏洞允许攻击者通过构造恶意的ZIP压缩包，在用户尝试查看压缩包内的文件时执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，该漏洞已被广泛利用，POC代码的存在也表明其有效性。多个安全厂商和研究人员都对此漏洞进行了分析并提供了相应的缓解措施。

**投毒风险分析：**
提供的POC代码包含以下文件：
*   `README.md`: 漏洞复现教程，包含漏洞信息和参考链接。
*   `执行命令.bat`: 一个简单的批处理文件，用于执行`calc.exe`（计算器程序），用于演示代码执行。
*   `文本.txt`: 包含一个URL地址。
*   `生成压缩包.py`: 一个Python脚本，用于生成包含漏洞的ZIP压缩包。

该脚本的主要功能是：
1.  创建临时目录，并将`执行命令.bat`复制到该目录。
2.  复制`文本.txt`文件到另一个目录。
3.  将上述两个目录打包成ZIP文件。
4.  修改ZIP文件中的文件名，利用漏洞的原理。
从代码本身来看，该脚本并没有明显的恶意代码，但是存在一定的投毒风险。
*   执行命令.bat： 虽然只是简单的calc.exe，但如果攻击者替换成其他恶意命令，则可能造成更大的危害。
*   脚本的依赖： 该脚本依赖Python环境，攻击者可能会通过修改脚本，引入恶意的Python依赖包，从而实现投毒。

综合来看，该仓库中存在一定的投毒风险，但不高。主要是因为演示的`执行命令.bat`内容比较简单，容易被识别。如果使用者直接运行此仓库的代码，有可能会被植入恶意程序。因此，投毒风险评定为10%。

**利用方式：**
1.  攻击者构造一个恶意的ZIP压缩包，该压缩包包含一个良性文件（例如，图片文件`文本.txt`）和一个与该文件同名的文件夹。
2.  该文件夹包含一个恶意可执行文件（例如，`执行命令.bat`并更名为`文本.txtA.cmd`）。
3.  当用户使用受影响的WinRAR版本打开该ZIP压缩包，并尝试查看良性文件时，WinRAR会错误地执行该文件夹中的恶意可执行文件，从而导致任意代码执行。

**项目地址:** [xk-mt/WinRAR-Vulnerability-recurrence-tutorial](https://github.com/xk-mt/WinRAR-Vulnerability-recurrence-tutorial)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #28

**来源**: [CVE-2023-38831-yezzfusl_cve_2023_38831_scanner.md](../2023/CVE-2023-38831-yezzfusl_cve_2023_38831_scanner.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开恶意的 ZIP 压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以通过构造一个特殊的 ZIP 压缩文件来利用此漏洞。该 ZIP 文件包含一个良性文件（例如 JPG）和一个同名的文件夹。当用户尝试访问良性文件时，WinRAR 会错误地执行文件夹中的恶意代码，导致远程代码执行。

**利用方式：**
1.  攻击者创建一个包含良性文件和同名文件夹的恶意 ZIP 文件。
2.  文件夹中包含要执行的恶意代码（例如，可执行文件）。
3.  攻击者诱使用户使用 WinRAR 打开该 ZIP 文件。
4.  当用户尝试访问良性文件时，WinRAR 会执行文件夹中的恶意代码。

**有效性：**
根据漏洞描述和搜索结果，该漏洞已在野外被利用，因此提供的PoC代码如果能够重现该行为，则可以认为是有效的。

**投毒风险：**
提供的代码仓库 `cve_2023_38831_scanner` 本身是一个漏洞扫描器，而非漏洞利用的PoC。尽管如此，仍然存在一定的投毒风险。代码中可能隐藏后门，虽然其主要功能是扫描，但理论上存在被篡改的风险。代码中使用了网络数据包分析、进程内存扫描、沙箱环境执行等模块，这些模块如果被恶意修改，可能被用于执行恶意操作。因此，综合考虑其扫描器的性质和潜在风险，投毒风险估计为10%。这个风险主要来自供应链投毒，如果下载了被篡改过的扫描器，那么扫描器本身可能成为攻击的一部分。

**项目地址:** [yezzfusl/cve_2023_38831_scanner](https://github.com/yezzfusl/cve_2023_38831_scanner)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #29

**来源**: [CVE-2023-38831-youmulijiang_evil-winrar.md](../2023/CVE-2023-38831-youmulijiang_evil-winrar.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 50%

## 详情

CVE-2023-38831是WinRAR在6.23版本之前存在的一个远程代码执行漏洞。该漏洞的利用方式是构造一个特殊的ZIP压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹。当用户尝试在WinRAR中查看该良性文件时，WinRAR会错误地执行该文件夹中的恶意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认该漏洞是有效的，并且已经在野外被利用。漏洞利用代码提供了一个框架，用于生成包含恶意payload的ZIP压缩包，从而实现远程代码执行。

**投毒风险分析：**
提供的代码是一个框架，用于生成漏洞利用的 ZIP 文件，包含生成 exp，邮件发送，下载链接生成等功能。代码中存在潜在的投毒风险，主要体现在以下几个方面：

1.  **Payload 植入:**  该框架可以自定义payload，如果用户在不了解 payload 内容的情况下使用，可能运行恶意指令。
2.  **代码可信度:** 虽然作者声明为安全开发成员，并开源了代码，但代码的安全性仍然需要进一步审计。存在作者预留后门的可能性。 考虑到这是一个漏洞利用框架，其本质就是为了执行恶意代码，所以判定为投毒代码的风险为50%。

**漏洞利用方式：**

1.  攻击者使用该漏洞利用框架(evil-winrar)生成一个恶意的 ZIP 压缩包。
2.  该 ZIP 压缩包包含一个良性文件（如JPG图片）和一个同名的文件夹，文件夹中包含恶意可执行文件。
3.  攻击者通过社会工程学等方式诱骗用户使用存在漏洞的 WinRAR 版本打开该 ZIP 压缩包。
4.  用户尝试查看良性文件时，WinRAR 会错误地执行同名文件夹中的恶意代码。
5.  恶意代码在用户系统上执行，攻击者从而实现远程代码执行，控制受害者的计算机。

**项目地址:** [youmulijiang/evil-winrar](https://github.com/youmulijiang/evil-winrar)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---



---

## POC #3

**来源**: [CVE-2023-38831-MaorBuskila_Windows-X64-RAT.md](../2023/CVE-2023-38831-MaorBuskila_Windows-X64-RAT.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者在用户尝试查看 ZIP 压缩包中的良性文件时执行任意代码。该漏洞源于 WinRAR 处理 ZIP 压缩包时，允许压缩包包含一个良性文件（例如 .JPG）和一个同名文件夹。当用户尝试访问该良性文件时，WinRAR 实际上会处理同名文件夹中的内容，从而允许攻击者在文件夹中放置恶意可执行文件并执行。

**有效性：**
从搜索结果和漏洞库信息来看，该漏洞已经被广泛利用，PoC 代码的存在也进一步验证了其有效性。

**投毒风险：**
提供的 Python 脚本 (`51721.py`) 用于生成 Windows x64 平台的反向 TCP Shellcode。该脚本本身不包含明显的恶意代码，功能是生成 shellcode。需要用户自行配置 IP 地址和端口。但是，由于该代码需要用户执行，并且可以生成任意 shellcode，存在一定投毒风险，例如，如果攻击者提供修改后的脚本，生成包含恶意功能的 shellcode (如删除文件，上传用户信息)，则用户可能无意中执行该恶意 shellcode. 脚本本身不包含网络连接或者其他与远程服务器通信的行为，可以基本判断代码仓库投毒风险较低.

**利用方式：**
1.  攻击者创建一个恶意的 ZIP 压缩包。
2.  该 ZIP 压缩包包含一个良性文件（例如 image.jpg）和一个同名文件夹（image.jpg）。
3.  同名文件夹包含恶意可执行文件，例如 exploit.exe，并可能包含一个 `.lnk` 文件，该快捷方式指向该恶意可执行文件。
4.  攻击者诱骗用户使用受影响版本的 WinRAR 打开该 ZIP 压缩包并尝试查看良性文件。
5.  WinRAR 错误地执行同名文件夹中的恶意可执行文件，从而导致远程代码执行。

**项目地址:** [MaorBuskila/Windows-X64-RAT](https://github.com/MaorBuskila/Windows-X64-RAT)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #4

**来源**: [CVE-2023-38831-MyStuffYT_CVE-2023-38831-POC.md](../2023/CVE-2023-38831-MyStuffYT_CVE-2023-38831-POC.md)

## CVE-2023-38831-WinRAR-远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的恶意ZIP压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个恶意的ZIP压缩文件，其中包含一个良性文件（例如.jpg）和一个同名的文件夹。当用户尝试在 WinRAR 中查看该良性文件时，WinRAR 会错误地执行该文件夹中的内容，从而导致任意代码执行。

**有效性：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。搜索引擎结果表明该漏洞已被广泛利用，POC代码的存在进一步证实了其有效性。

**投毒风险：**

根据对POC代码的分析，存在一定的投毒风险。`script.bat`脚本从github下载`Alert.exe`文件，这本身就存在一定的安全隐患，无法确保下载的文件一定是安全的。此外，脚本同时执行 `alert.exe` 和 `gtaleak.mp4`，而 `gtaleak.mp4` 在 README 中说明是 “zeros without ones”, 可以确定这是一个障眼法，实际的恶意行为是由 `alert.exe` 执行。 因此，作者可能隐藏了投毒代码。

**利用方式：**

1.  攻击者创建一个恶意的ZIP压缩文件，其中包含一个良性文件 (例如 `gtaleak.mp4`) 和一个同名的文件夹。
2.  该文件夹包含一个批处理脚本 (`script.bat`)，该脚本将从远程服务器下载并执行恶意程序 (`Alert.exe`)。
3.  当用户尝试使用 WinRAR 打开压缩文件并查看良性文件 (`gtaleak.mp4`) 时，WinRAR 会错误地执行批处理脚本。
4.  批处理脚本下载并执行恶意程序，从而允许攻击者在受害者的系统上执行任意代码。

**项目地址:** [MyStuffYT/CVE-2023-38831-POC](https://github.com/MyStuffYT/CVE-2023-38831-POC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #5

**来源**: [CVE-2023-38831-Nielk74_CVE-2023-38831.md](../2023/CVE-2023-38831-Nielk74_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本的代码执行漏洞。该漏洞允许攻击者在用户尝试查看ZIP存档中的看似无害的文件时执行任意代码。攻击者通过构造一个包含同名文件和文件夹的恶意ZIP文件，利用WinRAR处理文件路径时的逻辑缺陷，使得文件夹中的恶意可执行文件得以运行。提供的POC代码通过Vagrant自动化部署了一个易受攻击的WinRAR 6.22环境，并向虚拟机桌面添加了一个恶意的rar文件。该rar文件被设计为当用户点击其中的“无害”文件时，执行预先设定的恶意代码。尽管POC的主要目的是演示漏洞，但其中`ChocolateyInstall.ps1`脚本从外部源下载并安装软件包（Chocolatey和WinRAR），存在被篡改从而引入恶意代码的风险，这构成了潜在的投毒风险。虽然这个脚本很常见，但还是存在一定的风险，因此这里给出了10%的投毒风险。

**漏洞利用方式：**

1.  攻击者创建一个恶意的ZIP压缩包，其中包含一个看似无害的文件（例如.jpg），以及一个与该文件同名的文件夹。
2.  该文件夹包含恶意可执行文件，例如.exe或.cmd脚本。
3.  当用户尝试使用WinRAR打开ZIP压缩包并查看“无害”文件时，WinRAR会错误地执行同名文件夹中的恶意可执行文件，从而导致任意代码执行。
4.  攻击者可以利用此漏洞在受害者系统上安装恶意软件、窃取敏感数据或执行其他恶意操作。

**项目地址:** [Nielk74/CVE-2023-38831](https://github.com/Nielk74/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #6

**来源**: [CVE-2023-38831-RomainBayle08_CVE-2023-38831.md](../2023/CVE-2023-38831-RomainBayle08_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP或RAR压缩文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个特殊的 ZIP 压缩文件，该文件包含一个看似无害的文件（例如，.JPG 文件）和一个与该文件同名的文件夹。当用户尝试查看压缩文件中的无害文件时，WinRAR 会错误地执行文件夹中的内容，从而导致任意代码执行。

**有效性分析：**
提供的 POC 代码 `cve-2023-38831-exp-gen.py` 是一个漏洞利用生成器脚本，它接受诱饵文件 (`BAIT_NAME`)、脚本文件 (`SCRIPT_NAME`) 和额外的诱饵文件目录 (`BAIT_FILES`) 作为输入，并生成一个恶意 RAR 压缩文件 (`OUTPUT_NAME`)。脚本首先创建一个包含诱饵文件和脚本文件的临时目录结构，然后使用 `shutil.make_archive` 函数将该目录压缩为 ZIP 文件。关键在于，脚本会替换 ZIP 文件中特定文件的扩展名，利用 WinRAR 的漏洞，在用户尝试打开诱饵文件时执行脚本文件。`script.bat` 脚本会首先尝试打开诱饵文件（模拟用户行为），然后执行 `calc.exe`（作为漏洞利用成功的标志）。该 POC 的有效性较高，因为它模拟了真实的攻击场景。

**投毒风险分析：**
`cve-2023-38831-exp-gen.py` 脚本本身不包含明显的恶意代码或后门。但是，存在一定的投毒风险，因为该脚本允许攻击者指定要执行的任意脚本 (`SCRIPT_NAME`)。攻击者可以替换 `script.bat` 文件为包含恶意代码的文件，例如下载和执行其他恶意软件。此外，该脚本使用了`BAIT_FILES`参数，如果提供包含恶意文件的目录，也会构成投毒风险。所以存在一定投毒风险，但主要取决于用户提供的脚本和目录的内容。

**利用方式分析：**
1.  攻击者构造一个恶意 ZIP 压缩文件，其中包含一个诱饵文件（如 `CLASSIFIED_DOCUMENTS.pdf`）和一个与诱饵文件同名的文件夹。文件夹中包含一个脚本文件（如 `script.bat`）。
2.  攻击者将恶意 ZIP 文件发送给受害者，诱骗其使用 WinRAR 打开。
3.  当受害者尝试查看 ZIP 文件中的诱饵文件时，WinRAR 会错误地执行同名文件夹中的脚本文件。
4.  脚本文件执行任意代码，例如安装恶意软件或窃取敏感信息。

总的来说，该漏洞利用方式简单有效，风险较高。用户应尽快升级到 WinRAR 6.23 或更高版本。

**项目地址:** [RomainBayle08/CVE-2023-38831](https://github.com/RomainBayle08/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #7

**来源**: [CVE-2023-38831-RonF98_CVE-2023-38831-POC.md](../2023/CVE-2023-38831-RonF98_CVE-2023-38831-POC.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致任意代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831 是 WinRAR 在处理 ZIP 压缩文件时存在的一个漏洞。攻击者可以构造一个包含良性文件（例如 .jpg 文件）和一个同名文件夹的 ZIP 压缩包。该文件夹中包含恶意代码（例如 .cmd 文件）。当用户尝试查看良性文件时，WinRAR 会错误地执行文件夹中的恶意代码，从而导致远程代码执行。

**有效性：**

提供的 POC 代码有效，它演示了如何创建一个恶意的 RAR 文件来利用此漏洞。

*   `DoS.cmd` 文件包含恶意代码，用于创建多个消息框，模拟拒绝服务攻击。
*   `exploit.py` 脚本用于生成包含恶意 `DoS.cmd` 文件的 RAR 文件，并利用漏洞触发代码执行。
*   `README.md` 详细解释了漏洞原理和利用方法，并提供了攻击成功的截图。

**投毒风险：**

此仓库中可能存在轻微的投毒风险，约为5%。

*   `DoS.cmd` 只是一个简单的拒绝服务攻击示例，但攻击者可能会将其替换为更具破坏性的恶意代码，例如勒索软件或信息窃取程序。如果下载者不仔细检查 `DoS.cmd` 的内容，可能会在不知情的情况下运行恶意代码。
*   `exploit.py` 脚本本身没有明显的恶意代码，但它可以被修改以生成包含不同恶意代码的 RAR 文件。下载者应该仔细审查脚本的内容，确保它不会被用于传播恶意软件。

**利用方式：**

1.  攻击者创建一个包含良性文件（例如 `image.jpg`）和一个同名文件夹（例如 `image.jpg `）的 ZIP 压缩包。注意文件夹名称后面有一个空格。
2.  在同名文件夹中，攻击者放置恶意代码（例如 `image.jpg .cmd`）。
3.  攻击者将 ZIP 文件转换为 RAR 文件（POC 脚本完成了此过程）。
4.  攻击者诱骗用户使用受影响的 WinRAR 版本打开 RAR 文件并尝试查看良性文件（`image.jpg`）。
5.  WinRAR 错误地执行同名文件夹中的恶意代码 (`image.jpg .cmd`)，从而导致远程代码执行。

由于该漏洞被广泛利用，并且网上存在大量相关的 POC 代码，因此攻击者很容易发起攻击。


**项目地址:** [RonF98/CVE-2023-38831-POC](https://github.com/RonF98/CVE-2023-38831-POC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #8

**来源**: [CVE-2023-38831-SpamixOfficial_CVE-2023-38831.md](../2023/CVE-2023-38831-SpamixOfficial_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前的版本中的代码执行漏洞。攻击者可以制作一个特制的ZIP压缩包，其中包含一个良性文件和一个同名文件夹，文件夹中包含恶意可执行文件。当用户尝试在WinRAR中查看良性文件时，实际上会执行文件夹中的恶意代码。\n\n**有效性：**根据漏洞库信息、搜索结果和漏洞利用代码，该漏洞POC是有效的。漏洞库信息中明确指出该漏洞已在野外被利用。搜索结果中多个链接都指向了关于该漏洞的分析和利用报告。提供的`Cargo.lock`文件很可能只是rust项目依赖管理文件，无法直接证明POC的有效性，需配合rust源码进行分析。\n\n**投毒风险：**分析提供的`Cargo.lock`文件，该文件列出了Rust项目`CVE-2023-38831`的依赖项。虽然`Cargo.lock`本身不包含可执行代码，但是，如果恶意作者修改了依赖项的版本或来源，理论上存在引入被篡改过的crate（Rust包）的风险。不过，由于`Cargo.lock`文件明确指定了每个依赖项的checksum，Cargo在构建项目时会验证下载的crate是否与checksum匹配，从而降低了被投毒的风险。评估投毒风险为10%。\n\n**利用方式：**攻击者创建一个包含以下结构的ZIP压缩包：\n\n1.  一个良性的文件，例如 `image.jpg`\n2.  一个与良性文件同名的文件夹，例如 `image.jpg`\n3.  在同名文件夹中，放置恶意可执行文件，例如 `image.jpg.exe` 或 `image.jpg `(通过空格进行欺骗)。\n\n当用户使用存在漏洞的WinRAR版本打开该ZIP文件并尝试查看`image.jpg`时，WinRAR会错误地执行`image.jpg`文件夹中的恶意程序，从而实现远程代码执行。

**项目地址:** [SpamixOfficial/CVE-2023-38831](https://github.com/SpamixOfficial/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #9

**来源**: [CVE-2023-38831-Tolu12wani_Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution.md](../2023/CVE-2023-38831-Tolu12wani_Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在用户尝试查看 ZIP 压缩包中的文件时执行任意代码。

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开特制的 ZIP 压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者通过构造恶意的 ZIP 压缩包实现远程代码执行。该压缩包包含一个良性文件（例如 JPG）和一个与良性文件同名的文件夹。当用户尝试访问良性文件时，WinRAR 会错误地执行同名文件夹中的内容，从而执行攻击者放置的恶意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被广泛利用。 提供的POC代码描述的是在压缩文件中嵌入恶意payload，并触发反向shell的实验环境验证过程。虽然该代码本身没有包含恶意代码，但描述了如何构建利用该漏洞的压缩文件。

**投毒风险：**
提供的 POC 代码仓库中只包含 PDF 报告和截图，并没有可执行的恶意代码。 但是,README中说明了该仓库展示了恶意payload的嵌入方式，存在一定的潜在风险。 因此，存在一定的投毒风险，但风险较低。根据readme描述和文件结构，投毒风险评估为10%，

**利用方式：**
1.  **创建恶意 ZIP 压缩包：** 攻击者创建一个 ZIP 压缩包，其中包含一个良性文件（例如 JPG）和一个与良性文件同名的文件夹。
2.  **放置恶意代码：** 将恶意可执行文件放置在与良性文件同名的文件夹中。
3.  **诱骗用户：** 诱骗用户使用受影响的 WinRAR 版本打开该 ZIP 压缩包并尝试查看良性文件。
4.  **执行恶意代码：** WinRAR 错误地执行同名文件夹中的恶意代码，从而实现远程代码执行。

根据搜索结果，该漏洞已经被政府支持的攻击者利用，用于投放 RAT（远程访问木马）等恶意软件。

**项目地址:** [Tolu12wani/Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution](https://github.com/Tolu12wani/Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #10

**来源**: [CVE-2023-38831-VictoriousKnight_CVE-2023-38831_Exploit.md](../2023/CVE-2023-38831-VictoriousKnight_CVE-2023-38831_Exploit.md)

## CVE-2023-38831-WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码。

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的恶意ZIP文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个漏洞，它允许攻击者通过构造特殊的ZIP文件来执行任意代码。攻击者创建一个ZIP文件，其中包含一个良性文件（例如，JPG图片）和一个与该良性文件同名的文件夹。该文件夹中包含恶意可执行文件。当用户尝试在WinRAR中查看该良性文件时，WinRAR会错误地执行该文件夹中的恶意代码，从而导致远程代码执行。

**有效性：** 提供的POC代码是有效的。根据漏洞库信息和搜索结果，该漏洞在野外被广泛利用。POC代码通过创建包含良性文件和同名文件夹的恶意ZIP文件，并利用WinRAR处理文件时的缺陷来执行代码。POC代码结构清晰，易于理解和使用。

**投毒风险：** 提供的POC代码本身主要是利用漏洞生成EXP，但仔细检查代码，在`exploit.py`文件的zip文件内容操作部分被截断，没有展示修改zip文件内容的关键代码，作者可能在`Read and manipulate the zip file content`部分添加恶意代码，执行修改zip文件过程中的任何恶意行为。因此存在一定的投毒风险，根据代码完整度，我给出10%的投毒风险。

**利用方式：**
1.  攻击者创建一个恶意ZIP文件，其中包含一个看似无害的文件（例如，一个图片或PDF）。
2.  在ZIP文件中，攻击者同时创建一个与该无害文件同名的文件夹。
3.  该文件夹包含攻击者想要执行的恶意代码，通常是一个可执行文件或脚本。
4.  攻击者诱使用户使用存在漏洞的WinRAR版本打开该ZIP文件。
5.  当用户尝试访问ZIP文件中的“无害”文件时，WinRAR会错误地执行同名文件夹中的恶意代码。

**项目地址:** [VictoriousKnight/CVE-2023-38831_Exploit](https://github.com/VictoriousKnight/CVE-2023-38831_Exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #11

**来源**: [CVE-2023-38831-anelya0333_Exploiting-CVE-2023-38831.md](../2023/CVE-2023-38831-anelya0333_Exploiting-CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开特制的ZIP压缩文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞允许攻击者通过特制的ZIP压缩文件在目标系统上执行任意代码。该漏洞的根源在于WinRAR在处理包含与文件同名文件夹的ZIP文件时存在缺陷。攻击者可以构造一个 ZIP 文件，其中包含一个良性文件（例如.JPG）和一个与其同名的文件夹。当用户尝试在 WinRAR 中查看该良性文件时，WinRAR 会错误地执行该文件夹中的恶意代码。此PoC脚本生成一个ZIP文件，其中包含诱饵文件(bait file)和恶意脚本(script file)，并修改ZIP文件的文件头，以利用此漏洞。脚本创建与诱饵文件同名的文件夹，并将恶意脚本放入其中。然后，将诱饵文件的副本也放入ZIP文件中。通过替换文件名字段中的某些字符，WinRAR会将文件夹中的恶意文件误认为是要执行的文件，最终导致代码执行。由于代码仅仅是构造payload，不存在主动执行恶意代码，因此不存在投毒风险。

**项目地址:** [anelya0333/Exploiting-CVE-2023-38831](https://github.com/anelya0333/Exploiting-CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #12

**来源**: [CVE-2023-38831-b1tg_CVE-2023-38831-winrar-exploit.md](../2023/CVE-2023-38831-b1tg_CVE-2023-38831-winrar-exploit.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可导致完全系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开恶意构造的ZIP文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 允许攻击者通过特制的ZIP文件在受害者系统上执行任意代码。该漏洞源于 WinRAR 处理包含同名文件和文件夹的 ZIP 档案时的不当行为。攻击者可以创建一个 ZIP 文件，其中包含一个良性文件（例如 CLASSIFIED_DOCUMENTS.pdf）和一个同名文件夹（例如 CLASSIFIED_DOCUMENTS.pdf）。当用户尝试访问良性文件时，WinRAR 实际上会执行该文件夹中的内容（例如 script.bat）。

**有效性:**

提供的 POC 代码 `cve-2023-38831-exp-gen.py` 旨在生成利用此漏洞的恶意 RAR 档案。该脚本通过以下步骤工作：

1.  创建临时目录 `TEMPLATE`。
2.  在 `TEMPLATE` 中创建一个与bait文件同名的文件夹，并在其中存放包含恶意命令的script文件（例如 `script.bat`， 其中包含`calc.exe & CLASSIFIED_DOCUMENTS.pdf`）。
3.  将bait文件存放在`TEMPLATE`目录。
4.  将`TEMPLATE`目录压缩为zip文件。
5.  修改压缩包中文件和文件夹的名字，构造漏洞。
6.  最终输出 `CVE-2023-38831-poc.rar`。

该脚本能够有效地生成利用 CVE-2023-38831 的 RAR 文件，因此提供的 POC 代码是有效的。

**投毒风险:**

对提供的 POC 代码 (`cve-2023-38831-exp-gen.py` 和 `script.bat`) 进行分析后，未发现明显的恶意代码或后门。该脚本的功能明确且集中于生成利用 CVE-2023-38831 的 RAR 档案。 `script.bat` 的主要功能是启动计算器程序 (`calc.exe`) 并尝试打开诱饵文档 (`CLASSIFIED_DOCUMENTS.pdf`)，这是一个典型的 PoC 行为。 因此，该仓库中存在作者隐藏的投毒代码的风险极低。

**利用方式:**

1.  攻击者使用 `cve-2023-38831-exp-gen.py` 脚本，指定诱饵文件（例如 `CLASSIFIED_DOCUMENTS.pdf`）和恶意脚本（例如 `script.bat`），生成恶意 RAR 档案。
2.  攻击者通过各种方式（例如，电子邮件、恶意网站）将恶意 RAR 档案分发给受害者。
3.  受害者使用易受攻击的 WinRAR 版本（< 6.23）打开恶意 RAR 档案。
4.  当受害者尝试访问诱饵文件时，WinRAR 错误地执行了同名文件夹中的恶意脚本。
5.  恶意脚本在受害者系统上执行任意代码，例如启动计算器或安装恶意软件。

**项目地址:** [b1tg/CVE-2023-38831-winrar-exploit](https://github.com/b1tg/CVE-2023-38831-winrar-exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #13

**来源**: [CVE-2023-38831-elefantesagradodeluzinfinita_cve-2023-38831.md](../2023/CVE-2023-38831-elefantesagradodeluzinfinita_cve-2023-38831.md)

## CVE-2023-38831 - WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用 WinRAR 打开特制的 ZIP 压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者通过特制的 ZIP 压缩包在受害者系统上执行任意代码。漏洞利用方式是创建一个 ZIP 压缩包，其中包含一个良性文件（例如 .jpg 或 .pdf）以及一个同名的文件夹。该文件夹包含恶意的可执行文件（例如 .cmd 或 .exe）。当用户尝试打开良性文件时，WinRAR 会错误地执行文件夹中的恶意代码。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码分析，该漏洞确实存在并且已经被野外利用。提供的代码描述了一个利用工具 "DR. GANDALF"，它允许用户创建包含此漏洞的 ZIP 文件，表明POC的有效性。

**投毒风险：** 提供的 README.md 文件主要描述了漏洞原理和利用工具的使用方法。但是，由于此工具允许用户自定义注入的代码和二进制文件，因此存在投毒风险。如果用户下载了包含恶意注入代码的ZIP文件，那么这个工具本身可能被利用来传播恶意软件。评估投毒风险为 10%，因为该描述文件本身不包含可以直接执行的后门代码，但生成的ZIP文件可以包含。

**利用方式：**
1.  攻击者创建一个包含恶意 ZIP 压缩包。
2.  ZIP 压缩包中包含一个良性文件（例如，`image.jpg`）和一个同名的文件夹（例如，`image.jpg`）。
3.  `image.jpg` 文件夹包含恶意的可执行文件（例如，`evil.cmd`）。
4.  攻击者诱骗受害者使用存在漏洞的 WinRAR 版本打开该 ZIP 压缩包并尝试访问良性文件 `image.jpg`。
5.  WinRAR 在处理该 ZIP 文件时，会错误地执行 `image.jpg` 文件夹中的恶意代码 `evil.cmd`，从而导致远程代码执行。

**项目地址:** [elefantesagradodeluzinfinita/cve-2023-38831](https://github.com/elefantesagradodeluzinfinita/cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #14

**来源**: [CVE-2023-38831-h3xecute_SideCopy-Exploits-CVE-2023-38831.md](../2023/CVE-2023-38831-h3xecute_SideCopy-Exploits-CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个远程代码执行漏洞。该漏洞的利用方式是构造一个特殊的ZIP压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹。当用户尝试使用WinRAR打开该ZIP压缩包并访问良性文件时，WinRAR会错误地执行文件夹中的恶意代码。

**有效性：**
提供的POC代码描述了漏洞利用的原理，即构造包含同名良性文件和文件夹的ZIP压缩包。根据漏洞信息和搜索结果，此方法是有效的，并且在野外被利用。

**投毒风险：**
该POC本身描述了漏洞的利用方式，包含一个指向YouTube视频的链接，以及对恶意压缩包结构的描述。投毒风险较低，约为10%，因为：
1.  POC主要以描述性文字和图片链接为主。
2.  缺乏直接可执行的payload代码。
3.  作者可能通过YouTube链接传播恶意信息。

**利用方式：**
1.  攻击者创建一个恶意的ZIP压缩包。
2.  该压缩包包含一个良性文件（例如JPG，PDF等）和一个与该文件同名的文件夹。
3.  恶意代码（例如，可执行文件）放置在同名文件夹中。
4.  攻击者诱骗用户使用WinRAR打开这个ZIP压缩包，并尝试访问良性文件。
5.  WinRAR在处理压缩包时，会错误地执行同名文件夹中的恶意代码，从而导致远程代码执行。

**项目地址:** [h3xecute/SideCopy-Exploits-CVE-2023-38831](https://github.com/h3xecute/SideCopy-Exploits-CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #15

**来源**: [CVE-2023-38831-idkwastaken_CVE-2023-38831.md](../2023/CVE-2023-38831-idkwastaken_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意的ZIP文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的漏洞。该漏洞的利用方式是创建一个特制的ZIP文件，其中包含一个良性文件和一个同名文件夹。当用户尝试使用WinRAR打开ZIP文件并访问该良性文件时，WinRAR会错误地执行该同名文件夹中的恶意代码，导致远程代码执行。

**有效性：**
提供的POC代码（exploit.c）利用了该漏洞。该代码生成一个ZIP文件，其中包含一个PDF文件（document.pdf）和一个名为“document.pdf\”的文件夹，该文件夹内包含一个恶意的批处理脚本（script.bat）。当用户在易受攻击的WinRAR版本中打开并尝试访问该PDF文件时，WinRAR将执行该批处理脚本。
checker.bat 是用来检测目标系统是否安装WinRAR，以及WinRAR的版本是否是受影响的版本。
exploit.ps1 看起来不完整，但是其作用应该是检查WinRAR版本。

**投毒风险：**
代码中存在一定的投毒风险，约为10%。原因如下：
*   **脚本内容可控：** exploit.c 中的script_content变量包含了要执行的命令，虽然当前POC仅仅是弹窗，但是攻击者可以修改这个变量，执行任意命令，例如下载恶意软件，执行系统命令等。
*   **复杂的构建过程：** exploit.c 代码本身比较复杂，阅读和分析需要一定的时间和精力。攻击者可以利用这一点，在代码中隐藏不易察觉的恶意代码。
虽然有潜在的投毒风险，但当前代码的主要目的是演示漏洞利用，风险较低，作者没有明显的隐藏后门行为，恶意代码比较容易被发现。

**利用方式：**
1.  攻击者创建一个恶意的ZIP压缩包，其中包含：
    *   一个良性的文件（例如 document.pdf）。
    *   一个与良性文件同名的文件夹（例如 document.pdf/）。
    *   恶意代码位于同名文件夹中（例如 document.pdf/script.bat）。
2.  攻击者诱骗目标用户使用存在漏洞的 WinRAR 版本打开此 ZIP 压缩包。
3.  当用户尝试打开良性文件时，WinRAR 错误地执行同名文件夹中的恶意代码，从而导致任意代码执行。


**项目地址:** [idkwastaken/CVE-2023-38831](https://github.com/idkwastaken/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #16

**来源**: [CVE-2023-38831-imbyter_imbyter-WinRAR_CVE-2023-38831.md](../2023/CVE-2023-38831-imbyter_imbyter-WinRAR_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 6.23

**利用条件:** 用户使用受影响的WinRAR版本打开特制的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于WinRAR 6.23之前的版本中。攻击者可以构造一个恶意的ZIP压缩包，其中包含一个伪装成良性文件的文件（例如 .jpg），以及一个同名的文件夹。当用户尝试在 WinRAR 中查看该“良性文件”时，实际上会执行同名文件夹中的恶意代码（例如 .cmd 或 .exe 文件）。

**有效性：**
根据漏洞信息和搜索结果，提供的POC代码是有效的。该POC利用了WinRAR处理ZIP压缩包时存在的逻辑漏洞，能够实现远程代码执行。

**投毒风险：**
提供的Python脚本 `make-poc.py` 用于生成POC压缩包，其本身的代码逻辑相对简单，主要功能是将指定的文件和脚本打包成特定的ZIP格式，并进行一些字符串替换以触发漏洞。主要风险在于脚本生成的POC包中包含的脚本，如果这个脚本是恶意的，那么整个利用过程就存在投毒风险。 仓库中的README.md文件里的测试脚本就是一个关闭计算机的脚本。代码本身存在一定的投毒风险.

*   脚本逻辑：脚本的功能是创建包含漏洞利用结构的RAR文件。
*   恶意操作：如果脚本被修改以包含下载和执行恶意软件的逻辑，那么用户在使用此脚本创建RAR文件时，就会受到投毒攻击。

**利用方式：**
1.  攻击者使用 `make-poc.py` 脚本构造恶意的ZIP压缩包，需要提供一个“良性”文件和一个恶意脚本。
2.  攻击者将恶意的ZIP压缩包发送给受害者。
3.  受害者使用受影响的WinRAR版本打开该ZIP压缩包，并尝试查看伪装的“良性”文件。
4.  WinRAR错误地执行了与“良性”文件同名的文件夹中的恶意脚本，导致远程代码执行。

**防御措施：**
*   升级WinRAR到6.23或更高版本。
*   谨慎打开来源不明的ZIP压缩包。
*   使用杀毒软件扫描ZIP压缩包。

**项目地址:** [imbyter/imbyter-WinRAR_CVE-2023-38831](https://github.com/imbyter/imbyter-WinRAR_CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #17

**来源**: [CVE-2023-38831-kehrijksen_CVE-2023-38831.md](../2023/CVE-2023-38831-kehrijksen_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 需要用户解压特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个恶意的 ZIP 压缩包，其中包含一个伪装成普通文件的文件和一个同名的文件夹。当用户尝试在 WinRAR 中查看该“普通文件”时，WinRAR 会错误地执行同名文件夹中的内容，从而导致任意代码执行。

**有效性：**
提供的 PoC 代码 `poc.py` 能够生成利用此漏洞的恶意 ZIP 压缩包。该脚本首先创建一个包含恶意 payload (例如 script.bat) 和良性文件 (例如 pepe.jpg) 的目录结构。然后，它将此目录结构压缩成 ZIP 文件，并修改 ZIP 文件中的文件名，以触发漏洞。`script.bat` 的作用是在 `%TEMP%` 目录下提取 ZIP 文件内容，运行良性文件作为诱饵，然后执行恶意操作，例如创建一个包含 “hacked” 内容的文本文件并使用记事本打开。

**投毒风险：**
分析提供的代码，没有发现明显的投毒代码。`poc.py` 的作用是生成恶意 ZIP 文件，而 `script.bat` 包含的是恶意行为的代码，例如运行良性文件，创建 `hacked.txt` 等。这些行为是漏洞利用的一部分，而不是隐藏的恶意代码。虽然利用 `script.bat` 可以执行任意操作，但这属于漏洞利用的范畴，而非代码投毒。

**利用方式：**
1.  攻击者使用 `poc.py` 脚本生成一个恶意的 ZIP 压缩包，其中包含一个良性文件（例如图片）和一个同名的文件夹。
2.  攻击者将此恶意 ZIP 压缩包发送给受害者。
3.  受害者使用 WinRAR (6.23 之前的版本) 打开并尝试查看 ZIP 压缩包中的良性文件。
4.  WinRAR 错误地执行与良性文件同名的文件夹中的内容 (由 `script.bat` 控制)。
5.  `script.bat` 首先将 ZIP 文件的内容解压到临时目录。
6.  `script.bat` 运行良性文件（例如图片）作为诱饵，以迷惑受害者。
7.  `script.bat` 执行任意恶意操作，例如创建文件，修改注册表，安装恶意软件等。


**项目地址:** [kehrijksen/CVE-2023-38831](https://github.com/kehrijksen/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #18

**来源**: [CVE-2023-38831-khanhtranngoccva_cve-2023-38831-poc.md](../2023/CVE-2023-38831-khanhtranngoccva_cve-2023-38831-poc.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。该漏洞源于WinRAR处理ZIP压缩包时，对文件名和文件夹名区分不当。攻击者可以创建一个ZIP压缩包，其中包含一个良性文件（例如JPG）和一个同名的文件夹。该文件夹中包含恶意可执行文件。当用户尝试在WinRAR中打开该良性文件时，WinRAR会错误地执行文件夹中的恶意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已在野外被利用，证明了其有效性。提供的POC代码片段（package-lock.json）显示使用了jszip库，表明该POC可能用于创建恶意的ZIP压缩包，进一步验证漏洞的可利用性。

**投毒风险：**
提供的POC代码片段是`package-lock.json`文件，主要描述了项目依赖。要判断是否存在投毒风险，需要检查实际的利用代码（例如 index.ts/index.js）。
*   这个`package-lock.json`文件本身不包含恶意代码，只是依赖声明。
*   **风险点在于开发者可能在其他代码文件中（如index.ts等，此文件未提供）包含恶意代码**。
*   jszip 库本身是一个常用的 ZIP 文件操作库，被投毒的可能性较低。
*   tsx和typescript是typescript相关工具，本身被投毒的可能性也比较低

由于缺乏实际的利用代码，无法确定是否存在投毒行为，只能根据现有信息进行推测，因此将投毒风险评估为10%。

**利用方式：**
1.  攻击者构造一个恶意的ZIP压缩包。
2.  该ZIP压缩包包含一个良性文件（例如JPG）和一个同名的文件夹。
3.  该文件夹中包含恶意可执行文件（例如EXE、BAT、CMD等）。
4.  攻击者诱骗用户使用受影响的WinRAR版本打开该ZIP压缩包。
5.  用户尝试在WinRAR中打开该良性文件。
6.  WinRAR错误地执行文件夹中的恶意代码，导致远程代码执行。

**项目地址:** [khanhtranngoccva/cve-2023-38831-poc](https://github.com/khanhtranngoccva/cve-2023-38831-poc)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #19

**来源**: [CVE-2023-38831-kuyrathdaro_winrar-cve-2023-38831.md](../2023/CVE-2023-38831-kuyrathdaro_winrar-cve-2023-38831.md)

## CVE-2023-38831-WinRAR代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个代码执行漏洞。该漏洞的利用方式如下：

1.  攻击者创建一个恶意的ZIP压缩包（伪装成RAR格式，后缀名为.rar）。
2.  该压缩包包含一个良性的文件（例如，document.pdf），以及一个与该良性文件同名的文件夹（例如，document.pdf）。
3.  同名文件夹中包含恶意payload（例如，一个.bat或.exe文件），命名为`document.pdfA.cmd`。
4.  用户使用存在漏洞的WinRAR版本打开该压缩包，并尝试打开良性文件（document.pdf）。
5.  由于WinRAR处理文件名的缺陷，实际上执行的是同名文件夹中的恶意payload。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以判断该漏洞PoC有效。搜索引擎结果中多个链接表明该漏洞已被广泛利用，并且Google的威胁分析小组也分析了利用该漏洞进行的攻击活动。提供的PoC代码实现了生成恶意RAR压缩包的逻辑，进一步验证了该漏洞的可利用性。

**投毒风险：**

PoC代码本身的主要功能是生成利用CVE-2023-38831漏洞的恶意压缩包。然而，我们仍然需要评估该代码是否存在潜在的投毒风险。以下是对代码的分析：

*   **代码功能明确：** PoC代码的功能是生成特定的文件结构和内容，以触发WinRAR漏洞。代码逻辑相对简单，易于理解。
*   **输入/输出控制：** PoC代码接受三个输入参数：良性文件、Payload文件和输出文件名。这三个参数都由用户指定，PoC本身没有主动下载或执行任何其他代码的功能。
*   **潜在风险点：** `exploit.py` 脚本使用 `shutil.copyfile` 函数来复制 payload 文件到临时目录，如果payload 文件本身就是恶意的，那么这也会造成风险。此外，尽管脚本尝试确保输出文件以 `.rar` 结尾，但恶意用户可能修改此行为。
*   **间接风险：** 如果攻击者修改了提供的 `exploit.py` 脚本，添加额外的恶意功能（例如，在生成恶意压缩包后，自动上传到恶意服务器），则可能存在投毒风险。但是，这并非原始PoC代码本身的问题。

综合来看，原始PoC代码本身存在直接投毒的风险较低，我估计的投毒风险概率为 **10%**。这主要是因为恶意 payload 本身会带来风险，但 PoC 代码并没有主动引入恶意行为。

**利用方式：**

1.  准备一个良性的文件（例如，document.pdf）和一个恶意payload（例如，script.bat或malware.exe）。
2.  运行PoC脚本，指定良性文件、payload文件和输出文件名。
3.  PoC脚本生成一个恶意的RAR压缩包（实际上是ZIP格式，但后缀名为.rar）。
4.  将该恶意RAR压缩包发送给目标用户。
5.  目标用户使用存在漏洞的WinRAR版本打开该压缩包，并尝试打开良性文件。
6.  WinRAR执行同名文件夹中的恶意payload，从而实现代码执行。


**项目地址:** [kuyrathdaro/winrar-cve-2023-38831](https://github.com/kuyrathdaro/winrar-cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #20

**来源**: [CVE-2023-38831-malvika-thakur_CVE-2023-38831.md](../2023/CVE-2023-38831-malvika-thakur_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以通过创建一个特制的 ZIP 压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹，文件夹中包含恶意可执行文件。当用户尝试在 WinRAR 中查看该良性文件时，由于 WinRAR 处理逻辑的缺陷，会错误地执行文件夹中的恶意代码，从而导致远程代码执行。

**有效性：**

提供的 POC 代码 `poc.py`  可以生成利用此漏洞的 ZIP 文件。代码首先检查恶意脚本和良性文件是否存在，然后创建一个目录，将脚本和良性文件复制到特定结构中，最后将该目录压缩成 ZIP 文件。用户只需双击压缩包内的良性文件即可触发漏洞，执行恶意脚本。因此，POC 代码有效。

**投毒风险：**

分析提供的 `poc.py` 代码，没有发现明显的投毒代码。该脚本的主要功能是生成利用 CVE-2023-38831 漏洞的恶意 ZIP 文件。它需要用户提供恶意脚本和良性文件，然后按照特定目录结构进行组织并压缩。代码中没有发现任何会执行额外恶意操作的逻辑。`README.md` 文件也仅包含漏洞描述和使用说明，没有发现恶意内容。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者创建一个包含良性文件（如 JPG 图片）和一个同名文件夹的 ZIP 压缩包。
2.  该文件夹中包含恶意可执行文件（如 BAT 脚本）。
3.  攻击者将该 ZIP 压缩包发送给目标用户。
4.  目标用户使用受影响的 WinRAR 版本打开该 ZIP 压缩包。
5.  目标用户双击 ZIP 压缩包中的良性文件。
6.  WinRAR 错误地执行同名文件夹中的恶意可执行文件，导致远程代码执行。

**项目地址:** [malvika-thakur/CVE-2023-38831](https://github.com/malvika-thakur/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #21

**来源**: [CVE-2023-38831-r1yaz_winDED.md](../2023/CVE-2023-38831-r1yaz_winDED.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开特制的恶意 ZIP 压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 是 WinRAR 在处理 ZIP 压缩文件时存在的远程代码执行漏洞。当 WinRAR 版本低于 6.23 时，如果用户尝试打开一个包含恶意构造的 ZIP 文件，攻击者可以利用此漏洞执行任意代码。该 ZIP 文件包含一个良性文件（例如 JPG 文件）和一个与其同名的文件夹。攻击者可以将可执行文件放置在该文件夹中，当用户尝试访问良性文件时，WinRAR 会错误地执行文件夹中的可执行文件。

**有效性：**
提供的 POC 代码（winDED）通过生成恶意 ZIP 文件来演示漏洞利用。它创建了一个良性文件和一个同名文件夹，并将恶意脚本放入文件夹中。用户双击压缩包中的 PDF 文件时，实际上会执行该恶意脚本，从而证明漏洞的可利用性。

**投毒风险：**
根据提供的 POC 代码，投毒风险较低。代码主要是为了演示漏洞而设计的，虽然存在执行恶意 `super_sneaky_evil_script.bat` 的可能性，但该脚本本身是由用户提供的，或者可以通过查看代码本身来确认其行为。 然而，仍然存在一些细微的风险，例如，如果 `super_sneaky_evil_script.bat` 本身是从其他来源下载的，则可能包含恶意代码。  总的来说, 投毒风险约 10%。

**利用方式：**
1.  创建一个包含良性文件 (例如，`BILLION_DOLLAR_SECRET.pdf`) 和一个同名文件夹 (`BILLION_DOLLAR_SECRET.pdf`) 的 ZIP 压缩文件。
2.  将恶意脚本 (例如，`super_sneaky_evil_script.bat`) 放入同名文件夹中。
3.  诱骗目标用户使用 WinRAR 打开该 ZIP 文件。
4.  当用户尝试打开良性文件时，WinRAR 错误地执行同名文件夹中的恶意脚本，从而实现远程代码执行。

**项目地址:** [r1yaz/winDED](https://github.com/r1yaz/winDED)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #22

**来源**: [CVE-2023-38831-ra3edAJ_LAB-DFIR-cve-2023-38831.md](../2023/CVE-2023-38831-ra3edAJ_LAB-DFIR-cve-2023-38831.md)

## CVE-2023-38831-WinRAR代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 是 WinRAR 在 6.23 版本之前存在的远程代码执行漏洞。该漏洞源于WinRAR处理ZIP压缩包时，如果压缩包中包含一个良性文件和一个与该良性文件同名的文件夹，WinRAR在尝试访问良性文件时，会错误地执行同名文件夹中的恶意内容。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的PoC是可用的。漏洞在野外被广泛利用，并且CISA已将其添加到已知被利用的漏洞目录中。

**投毒风险：**
提供的漏洞利用代码为一个Github仓库的README.md文件，主要描述了如何利用磁盘镜像调查CVE-2023-38831攻击，并通过Windows注册表、NTFS文件和浏览器缓存理解Windows事件序列。仓库本身目的是为了DFIR分析，因此直接包含恶意代码的可能性较低。但考虑到链接跳转至外部教程网站，存在间接投毒的可能，即教程内容可能包含引导至恶意软件下载或运行恶意脚本的指令。因此，投毒风险较低，评估为10%。

**利用方式：**
1.  **创建恶意的ZIP压缩包：** 压缩包中包含一个良性文件（如JPG图片）和一个与该良性文件同名的文件夹。
2.  **将恶意可执行文件放入同名文件夹：** 该文件夹中的可执行文件会在用户尝试打开良性文件时被执行。
3.  **诱导用户打开ZIP压缩包：** 通过社交工程或其他方式，诱导用户使用受影响版本的WinRAR打开该压缩包。
4.  **触发漏洞执行恶意代码：** 当用户尝试查看ZIP压缩包中的良性文件时，WinRAR会错误地执行同名文件夹中的恶意代码，从而实现远程代码执行。

**总结：**
该漏洞利用方式较为简单，易于传播，危害较大。用户应及时更新WinRAR至最新版本，避免打开来源不明的ZIP压缩包。

**项目地址:** [ra3edAJ/LAB-DFIR-cve-2023-38831](https://github.com/ra3edAJ/LAB-DFIR-cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #23

**来源**: [CVE-2023-38831-ruycr4ft_CVE-2023-38831.md](../2023/CVE-2023-38831-ruycr4ft_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的远程代码执行漏洞。该漏洞源于WinRAR在处理ZIP压缩包时，对文件名和文件夹名相同的情况处理不当。攻击者可以构造一个恶意的ZIP压缩包，其中包含一个看似无害的文件（例如.jpg），同时包含一个同名的文件夹。当用户尝试打开该“无害文件”时，WinRAR会错误地执行同名文件夹中的恶意代码。\n\n**有效性：** 根据漏洞信息、搜索结果以及提供的POC代码，该漏洞利用是有效的。多个来源都表明该漏洞已被广泛利用，POC代码也展示了如何生成包含恶意代码的RAR压缩文件。POC代码通过创建同名文件和文件夹，并在文件夹中放入恶意脚本，利用WinRAR的缺陷触发代码执行。\n\n**投毒风险：**  仓库的投毒风险较低，大概10%。
  *   `poc.py`: 该脚本的功能是生成利用 CVE-2023-38831 的恶意 RAR 文件。虽然它允许用户指定 bait 文件和脚本文件，但脚本本身不包含任何预设的、隐藏的恶意行为。
  *   `script.bat`:  这个批处理文件包含使用 `nc.exe` (netcat) 反弹 shell 的命令。**这里存在一定的投毒风险。** 批处理文件明确地使用了`192.168.0.107`这个IP地址,如果用户直接使用该IP反弹shell,将会连接到攻击者的服务器。虽然IP地址可以被用户更改，但在默认情况下，如果用户不修改，将会连接到攻击者的IP。这是主要的投毒点。
  *   README.md: 该文件仅包含漏洞的简单介绍和演示图片。没有发现恶意代码。

**利用方式：**\n1.  攻击者创建一个恶意的ZIP压缩包。该压缩包包含一个诱饵文件（例如图片.jpg）和一个与其同名的文件夹（例如图片.jpg）。\n2.  攻击者将恶意代码（例如一个批处理脚本或可执行文件）放入同名文件夹中。\n3.  攻击者将包含恶意代码的ZIP压缩包发送给受害者。\n4.  受害者使用存在漏洞的WinRAR版本打开该ZIP压缩包，并尝试打开诱饵文件。\n5.  WinRAR错误地执行同名文件夹中的恶意代码，导致远程代码执行。

**项目地址:** [ruycr4ft/CVE-2023-38831](https://github.com/ruycr4ft/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #24

**来源**: [CVE-2023-38831-s4m98_winrar-cve-2023-38831-poc-gen.md](../2023/CVE-2023-38831-s4m98_winrar-cve-2023-38831-poc-gen.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开恶意的ZIP/RAR压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于WinRAR处理ZIP压缩文件时，由于对文件名和文件夹名处理不当导致。攻击者可以构造一个包含恶意脚本的ZIP压缩文件，该压缩文件包含一个正常的诱饵文件（如PDF、PNG或JPG）和一个同名的文件夹，当用户尝试打开诱饵文件时，WinRAR会错误地执行该文件夹中的恶意脚本。

**有效性：**
根据漏洞信息、搜索引擎结果和漏洞利用代码，该POC代码有效。漏洞库信息表明该漏洞已被野外利用。搜索引擎结果中也包含了大量关于此漏洞的分析和利用报告，证实了该漏洞的有效性。POC代码的描述和实现也符合漏洞的利用方式，通过生成包含恶意脚本和诱饵文件的RAR压缩包来触发漏洞。

**投毒风险：**
代码本身看起来比较直接，主要是生成利用漏洞的压缩包。`script.bat` 这个文件需要额外注意。当前提供的 `script.bat` 只是打开了计算器 `calc.exe` 和 Web_Security.pdf,相对来说是安全的，但用户在使用该漏洞时，完全可以修改此文件，添加更加恶意的payload，具有一定的风险。作者在代码中没有明显投毒行为，主要风险在于用户如何使用该工具生成payload。
投毒风险评估：10% (主要是用户修改 `script.bat` 的风险)

**利用方式：**
1.  **构造恶意ZIP/RAR压缩文件：** 利用提供的Python脚本（cve-2023-38831-exp-gen.py）生成恶意的ZIP/RAR压缩文件。此脚本需要一个诱饵文件（如PDF、PNG、JPG）和一个恶意脚本文件（如BAT、CMD、或可执行文件）。该脚本会创建一个包含诱饵文件和一个同名文件夹的压缩包，并将恶意脚本放置在该文件夹中。
2.  **诱骗用户打开压缩文件：**  将生成的恶意ZIP/RAR压缩文件发送给目标用户。
3.  **执行恶意代码：** 当用户使用受影响的WinRAR版本打开压缩文件并尝试查看诱饵文件时，WinRAR会错误地执行同名文件夹中的恶意脚本，从而实现远程代码执行。

 总体来说，该漏洞利用方式较为简单，攻击成本较低，风险较高。

**项目地址:** [s4m98/winrar-cve-2023-38831-poc-gen](https://github.com/s4m98/winrar-cve-2023-38831-poc-gen)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #25

**来源**: [CVE-2023-38831-solomon12354_VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC.md](../2023/CVE-2023-38831-solomon12354_VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要解压恶意的ZIP/RAR压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 存在于 WinRAR 6.23 之前版本中。攻击者可以构造一个包含良性文件和同名文件夹的 ZIP 压缩包，当用户尝试访问良性文件时，WinRAR 会错误地执行同名文件夹中的恶意代码。提供的 `exploit.py` 脚本可以用于生成包含漏洞利用的RAR压缩文件。脚本首先要求输入良性文件（`bait_file`）、恶意脚本文件（`script_file`）和输出RAR文件名称。然后，它创建一个临时目录，将恶意脚本复制到与良性文件同名的目录中，并将良性文件复制到临时目录中。最后，使用 `shutil.make_archive` 函数将临时目录压缩成 ZIP 文件，并修改 ZIP 文件的内容，将目录名中的 'A' 和 'B' 替换为空格，从而绕过 WinRAR 的安全检查。最终，将修改后的 ZIP 文件重命名为 RAR 文件。

`squid.bat` 用于下载并执行 `volleysquid.exe`。`volleyballsquid.py` 尝试利用 BypassUAC 来提升权限并将程序设置为开机自启。

**有效性:** 根据漏洞信息和利用代码分析，提供的 POC 代码有效，可以利用此漏洞在受害者机器上执行任意代码。

**投毒风险:** 仓库中存在一定的投毒风险，虽然主要功能是利用CVE-2023-38831漏洞，但是 `volleyballsquid.py`和`squid.bat`文件中的行为具有恶意性，特别是`volleyballsquid.py`中尝试使用`BypassUAC`绕过用户账户控制并持久化安装，这可能被用于安装后门或恶意软件。虽然主要目的是展示漏洞，但客观上存在后门功能，因此投毒风险占比为10%。

**利用方式:** 攻击者首先利用 `exploit.py` 脚本生成包含恶意代码的RAR压缩文件。然后，诱骗用户下载并使用 WinRAR 解压此文件。当用户尝试打开压缩包中的“良性”文件时，实际上会执行隐藏在同名目录中的恶意脚本 (例如 `squid.bat`)，下载并执行恶意程序。

根据搜索结果，CVE-2023-38831 漏洞已被广泛利用，并且已被政府背景的攻击者使用，这进一步验证了漏洞的严重性和 POC 代码的有效性。

**项目地址:** [solomon12354/VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC](https://github.com/solomon12354/VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #26

**来源**: [CVE-2023-38831-technicalcorp0_CVE-2023-38831-Exploit.md](../2023/CVE-2023-38831-technicalcorp0_CVE-2023-38831-Exploit.md)

## CVE-2023-38831-WinRAR-任意代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 任意代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个漏洞，该漏洞允许攻击者通过特制的ZIP档案执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** 当WinRAR尝试访问ZIP归档中的良性文件时，如果存在与该良性文件同名的文件夹，WinRAR会处理该文件夹的内容（可能包含可执行内容）。
2.  **利用方式：**
    *   攻击者创建一个恶意的ZIP档案，该档案包含一个良性文件（例如.JPG文件）和一个与该良性文件同名的文件夹。
    *   该文件夹包含恶意可执行文件。
    *   当受害者尝试在WinRAR中查看良性文件时，WinRAR会执行该文件夹中的恶意代码。
3.  **POC有效性：** 提供的POC代码 (CVE-2023-38831-WinRar-Exploit.py) 的目的是生成包含利用此漏洞的恶意 ZIP 文件。根据代码逻辑和漏洞原理，该 POC 可以有效利用该漏洞。
4.  **投毒风险：** 经过对POC代码的分析，发现代码本身实现了漏洞利用过程，但同时也存在一定的投毒风险。`clean_up()`函数会删除临时文件，但不能保证完全清除所有痕迹。攻击者可能通过修改代码，在生成恶意 ZIP 文件后，在目标系统上留下后门或执行其他恶意操作。考虑到实际利用场景中可能存在的恶意修改，投毒风险估计为5%。 主要风险点在于，虽然POC主要目的是生成exploit，但如果恶意人员修改，完全可以添加其他恶意payload，并伪装成CVE-2023-38831的POC进行传播。
5. **搜索引擎结果:** 搜索引擎结果表明此漏洞已被广泛利用，包括政府背景的黑客组织。 多个安全厂商发布了相关的分析和防御措施。

**项目地址:** [technicalcorp0/CVE-2023-38831-Exploit](https://github.com/technicalcorp0/CVE-2023-38831-Exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #27

**来源**: [CVE-2023-38831-xk-mt_WinRAR-Vulnerability-recurrence-tutorial.md](../2023/CVE-2023-38831-xk-mt_WinRAR-Vulnerability-recurrence-tutorial.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。该漏洞允许攻击者通过构造恶意的ZIP压缩包，在用户尝试查看压缩包内的文件时执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，该漏洞已被广泛利用，POC代码的存在也表明其有效性。多个安全厂商和研究人员都对此漏洞进行了分析并提供了相应的缓解措施。

**投毒风险分析：**
提供的POC代码包含以下文件：
*   `README.md`: 漏洞复现教程，包含漏洞信息和参考链接。
*   `执行命令.bat`: 一个简单的批处理文件，用于执行`calc.exe`（计算器程序），用于演示代码执行。
*   `文本.txt`: 包含一个URL地址。
*   `生成压缩包.py`: 一个Python脚本，用于生成包含漏洞的ZIP压缩包。

该脚本的主要功能是：
1.  创建临时目录，并将`执行命令.bat`复制到该目录。
2.  复制`文本.txt`文件到另一个目录。
3.  将上述两个目录打包成ZIP文件。
4.  修改ZIP文件中的文件名，利用漏洞的原理。
从代码本身来看，该脚本并没有明显的恶意代码，但是存在一定的投毒风险。
*   执行命令.bat： 虽然只是简单的calc.exe，但如果攻击者替换成其他恶意命令，则可能造成更大的危害。
*   脚本的依赖： 该脚本依赖Python环境，攻击者可能会通过修改脚本，引入恶意的Python依赖包，从而实现投毒。

综合来看，该仓库中存在一定的投毒风险，但不高。主要是因为演示的`执行命令.bat`内容比较简单，容易被识别。如果使用者直接运行此仓库的代码，有可能会被植入恶意程序。因此，投毒风险评定为10%。

**利用方式：**
1.  攻击者构造一个恶意的ZIP压缩包，该压缩包包含一个良性文件（例如，图片文件`文本.txt`）和一个与该文件同名的文件夹。
2.  该文件夹包含一个恶意可执行文件（例如，`执行命令.bat`并更名为`文本.txtA.cmd`）。
3.  当用户使用受影响的WinRAR版本打开该ZIP压缩包，并尝试查看良性文件时，WinRAR会错误地执行该文件夹中的恶意可执行文件，从而导致任意代码执行。

**项目地址:** [xk-mt/WinRAR-Vulnerability-recurrence-tutorial](https://github.com/xk-mt/WinRAR-Vulnerability-recurrence-tutorial)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #28

**来源**: [CVE-2023-38831-yezzfusl_cve_2023_38831_scanner.md](../2023/CVE-2023-38831-yezzfusl_cve_2023_38831_scanner.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开恶意的 ZIP 压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以通过构造一个特殊的 ZIP 压缩文件来利用此漏洞。该 ZIP 文件包含一个良性文件（例如 JPG）和一个同名的文件夹。当用户尝试访问良性文件时，WinRAR 会错误地执行文件夹中的恶意代码，导致远程代码执行。

**利用方式：**
1.  攻击者创建一个包含良性文件和同名文件夹的恶意 ZIP 文件。
2.  文件夹中包含要执行的恶意代码（例如，可执行文件）。
3.  攻击者诱使用户使用 WinRAR 打开该 ZIP 文件。
4.  当用户尝试访问良性文件时，WinRAR 会执行文件夹中的恶意代码。

**有效性：**
根据漏洞描述和搜索结果，该漏洞已在野外被利用，因此提供的PoC代码如果能够重现该行为，则可以认为是有效的。

**投毒风险：**
提供的代码仓库 `cve_2023_38831_scanner` 本身是一个漏洞扫描器，而非漏洞利用的PoC。尽管如此，仍然存在一定的投毒风险。代码中可能隐藏后门，虽然其主要功能是扫描，但理论上存在被篡改的风险。代码中使用了网络数据包分析、进程内存扫描、沙箱环境执行等模块，这些模块如果被恶意修改，可能被用于执行恶意操作。因此，综合考虑其扫描器的性质和潜在风险，投毒风险估计为10%。这个风险主要来自供应链投毒，如果下载了被篡改过的扫描器，那么扫描器本身可能成为攻击的一部分。

**项目地址:** [yezzfusl/cve_2023_38831_scanner](https://github.com/yezzfusl/cve_2023_38831_scanner)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #29

**来源**: [CVE-2023-38831-youmulijiang_evil-winrar.md](../2023/CVE-2023-38831-youmulijiang_evil-winrar.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 50%

## 详情

CVE-2023-38831是WinRAR在6.23版本之前存在的一个远程代码执行漏洞。该漏洞的利用方式是构造一个特殊的ZIP压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹。当用户尝试在WinRAR中查看该良性文件时，WinRAR会错误地执行该文件夹中的恶意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认该漏洞是有效的，并且已经在野外被利用。漏洞利用代码提供了一个框架，用于生成包含恶意payload的ZIP压缩包，从而实现远程代码执行。

**投毒风险分析：**
提供的代码是一个框架，用于生成漏洞利用的 ZIP 文件，包含生成 exp，邮件发送，下载链接生成等功能。代码中存在潜在的投毒风险，主要体现在以下几个方面：

1.  **Payload 植入:**  该框架可以自定义payload，如果用户在不了解 payload 内容的情况下使用，可能运行恶意指令。
2.  **代码可信度:** 虽然作者声明为安全开发成员，并开源了代码，但代码的安全性仍然需要进一步审计。存在作者预留后门的可能性。 考虑到这是一个漏洞利用框架，其本质就是为了执行恶意代码，所以判定为投毒代码的风险为50%。

**漏洞利用方式：**

1.  攻击者使用该漏洞利用框架(evil-winrar)生成一个恶意的 ZIP 压缩包。
2.  该 ZIP 压缩包包含一个良性文件（如JPG图片）和一个同名的文件夹，文件夹中包含恶意可执行文件。
3.  攻击者通过社会工程学等方式诱骗用户使用存在漏洞的 WinRAR 版本打开该 ZIP 压缩包。
4.  用户尝试查看良性文件时，WinRAR 会错误地执行同名文件夹中的恶意代码。
5.  恶意代码在用户系统上执行，攻击者从而实现远程代码执行，控制受害者的计算机。

**项目地址:** [youmulijiang/evil-winrar](https://github.com/youmulijiang/evil-winrar)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---



---

## POC #3

**来源**: [CVE-2023-38831-MaorBuskila_Windows-X64-RAT.md](../2023/CVE-2023-38831-MaorBuskila_Windows-X64-RAT.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者在用户尝试查看 ZIP 压缩包中的良性文件时执行任意代码。该漏洞源于 WinRAR 处理 ZIP 压缩包时，允许压缩包包含一个良性文件（例如 .JPG）和一个同名文件夹。当用户尝试访问该良性文件时，WinRAR 实际上会处理同名文件夹中的内容，从而允许攻击者在文件夹中放置恶意可执行文件并执行。

**有效性：**
从搜索结果和漏洞库信息来看，该漏洞已经被广泛利用，PoC 代码的存在也进一步验证了其有效性。

**投毒风险：**
提供的 Python 脚本 (`51721.py`) 用于生成 Windows x64 平台的反向 TCP Shellcode。该脚本本身不包含明显的恶意代码，功能是生成 shellcode。需要用户自行配置 IP 地址和端口。但是，由于该代码需要用户执行，并且可以生成任意 shellcode，存在一定投毒风险，例如，如果攻击者提供修改后的脚本，生成包含恶意功能的 shellcode (如删除文件，上传用户信息)，则用户可能无意中执行该恶意 shellcode. 脚本本身不包含网络连接或者其他与远程服务器通信的行为，可以基本判断代码仓库投毒风险较低.

**利用方式：**
1.  攻击者创建一个恶意的 ZIP 压缩包。
2.  该 ZIP 压缩包包含一个良性文件（例如 image.jpg）和一个同名文件夹（image.jpg）。
3.  同名文件夹包含恶意可执行文件，例如 exploit.exe，并可能包含一个 `.lnk` 文件，该快捷方式指向该恶意可执行文件。
4.  攻击者诱骗用户使用受影响版本的 WinRAR 打开该 ZIP 压缩包并尝试查看良性文件。
5.  WinRAR 错误地执行同名文件夹中的恶意可执行文件，从而导致远程代码执行。

**项目地址:** [MaorBuskila/Windows-X64-RAT](https://github.com/MaorBuskila/Windows-X64-RAT)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #4

**来源**: [CVE-2023-38831-MyStuffYT_CVE-2023-38831-POC.md](../2023/CVE-2023-38831-MyStuffYT_CVE-2023-38831-POC.md)

## CVE-2023-38831-WinRAR-远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的恶意ZIP压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个恶意的ZIP压缩文件，其中包含一个良性文件（例如.jpg）和一个同名的文件夹。当用户尝试在 WinRAR 中查看该良性文件时，WinRAR 会错误地执行该文件夹中的内容，从而导致任意代码执行。

**有效性：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。搜索引擎结果表明该漏洞已被广泛利用，POC代码的存在进一步证实了其有效性。

**投毒风险：**

根据对POC代码的分析，存在一定的投毒风险。`script.bat`脚本从github下载`Alert.exe`文件，这本身就存在一定的安全隐患，无法确保下载的文件一定是安全的。此外，脚本同时执行 `alert.exe` 和 `gtaleak.mp4`，而 `gtaleak.mp4` 在 README 中说明是 “zeros without ones”, 可以确定这是一个障眼法，实际的恶意行为是由 `alert.exe` 执行。 因此，作者可能隐藏了投毒代码。

**利用方式：**

1.  攻击者创建一个恶意的ZIP压缩文件，其中包含一个良性文件 (例如 `gtaleak.mp4`) 和一个同名的文件夹。
2.  该文件夹包含一个批处理脚本 (`script.bat`)，该脚本将从远程服务器下载并执行恶意程序 (`Alert.exe`)。
3.  当用户尝试使用 WinRAR 打开压缩文件并查看良性文件 (`gtaleak.mp4`) 时，WinRAR 会错误地执行批处理脚本。
4.  批处理脚本下载并执行恶意程序，从而允许攻击者在受害者的系统上执行任意代码。

**项目地址:** [MyStuffYT/CVE-2023-38831-POC](https://github.com/MyStuffYT/CVE-2023-38831-POC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #5

**来源**: [CVE-2023-38831-Nielk74_CVE-2023-38831.md](../2023/CVE-2023-38831-Nielk74_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本的代码执行漏洞。该漏洞允许攻击者在用户尝试查看ZIP存档中的看似无害的文件时执行任意代码。攻击者通过构造一个包含同名文件和文件夹的恶意ZIP文件，利用WinRAR处理文件路径时的逻辑缺陷，使得文件夹中的恶意可执行文件得以运行。提供的POC代码通过Vagrant自动化部署了一个易受攻击的WinRAR 6.22环境，并向虚拟机桌面添加了一个恶意的rar文件。该rar文件被设计为当用户点击其中的“无害”文件时，执行预先设定的恶意代码。尽管POC的主要目的是演示漏洞，但其中`ChocolateyInstall.ps1`脚本从外部源下载并安装软件包（Chocolatey和WinRAR），存在被篡改从而引入恶意代码的风险，这构成了潜在的投毒风险。虽然这个脚本很常见，但还是存在一定的风险，因此这里给出了10%的投毒风险。

**漏洞利用方式：**

1.  攻击者创建一个恶意的ZIP压缩包，其中包含一个看似无害的文件（例如.jpg），以及一个与该文件同名的文件夹。
2.  该文件夹包含恶意可执行文件，例如.exe或.cmd脚本。
3.  当用户尝试使用WinRAR打开ZIP压缩包并查看“无害”文件时，WinRAR会错误地执行同名文件夹中的恶意可执行文件，从而导致任意代码执行。
4.  攻击者可以利用此漏洞在受害者系统上安装恶意软件、窃取敏感数据或执行其他恶意操作。

**项目地址:** [Nielk74/CVE-2023-38831](https://github.com/Nielk74/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #6

**来源**: [CVE-2023-38831-RomainBayle08_CVE-2023-38831.md](../2023/CVE-2023-38831-RomainBayle08_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP或RAR压缩文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个特殊的 ZIP 压缩文件，该文件包含一个看似无害的文件（例如，.JPG 文件）和一个与该文件同名的文件夹。当用户尝试查看压缩文件中的无害文件时，WinRAR 会错误地执行文件夹中的内容，从而导致任意代码执行。

**有效性分析：**
提供的 POC 代码 `cve-2023-38831-exp-gen.py` 是一个漏洞利用生成器脚本，它接受诱饵文件 (`BAIT_NAME`)、脚本文件 (`SCRIPT_NAME`) 和额外的诱饵文件目录 (`BAIT_FILES`) 作为输入，并生成一个恶意 RAR 压缩文件 (`OUTPUT_NAME`)。脚本首先创建一个包含诱饵文件和脚本文件的临时目录结构，然后使用 `shutil.make_archive` 函数将该目录压缩为 ZIP 文件。关键在于，脚本会替换 ZIP 文件中特定文件的扩展名，利用 WinRAR 的漏洞，在用户尝试打开诱饵文件时执行脚本文件。`script.bat` 脚本会首先尝试打开诱饵文件（模拟用户行为），然后执行 `calc.exe`（作为漏洞利用成功的标志）。该 POC 的有效性较高，因为它模拟了真实的攻击场景。

**投毒风险分析：**
`cve-2023-38831-exp-gen.py` 脚本本身不包含明显的恶意代码或后门。但是，存在一定的投毒风险，因为该脚本允许攻击者指定要执行的任意脚本 (`SCRIPT_NAME`)。攻击者可以替换 `script.bat` 文件为包含恶意代码的文件，例如下载和执行其他恶意软件。此外，该脚本使用了`BAIT_FILES`参数，如果提供包含恶意文件的目录，也会构成投毒风险。所以存在一定投毒风险，但主要取决于用户提供的脚本和目录的内容。

**利用方式分析：**
1.  攻击者构造一个恶意 ZIP 压缩文件，其中包含一个诱饵文件（如 `CLASSIFIED_DOCUMENTS.pdf`）和一个与诱饵文件同名的文件夹。文件夹中包含一个脚本文件（如 `script.bat`）。
2.  攻击者将恶意 ZIP 文件发送给受害者，诱骗其使用 WinRAR 打开。
3.  当受害者尝试查看 ZIP 文件中的诱饵文件时，WinRAR 会错误地执行同名文件夹中的脚本文件。
4.  脚本文件执行任意代码，例如安装恶意软件或窃取敏感信息。

总的来说，该漏洞利用方式简单有效，风险较高。用户应尽快升级到 WinRAR 6.23 或更高版本。

**项目地址:** [RomainBayle08/CVE-2023-38831](https://github.com/RomainBayle08/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #7

**来源**: [CVE-2023-38831-RonF98_CVE-2023-38831-POC.md](../2023/CVE-2023-38831-RonF98_CVE-2023-38831-POC.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致任意代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831 是 WinRAR 在处理 ZIP 压缩文件时存在的一个漏洞。攻击者可以构造一个包含良性文件（例如 .jpg 文件）和一个同名文件夹的 ZIP 压缩包。该文件夹中包含恶意代码（例如 .cmd 文件）。当用户尝试查看良性文件时，WinRAR 会错误地执行文件夹中的恶意代码，从而导致远程代码执行。

**有效性：**

提供的 POC 代码有效，它演示了如何创建一个恶意的 RAR 文件来利用此漏洞。

*   `DoS.cmd` 文件包含恶意代码，用于创建多个消息框，模拟拒绝服务攻击。
*   `exploit.py` 脚本用于生成包含恶意 `DoS.cmd` 文件的 RAR 文件，并利用漏洞触发代码执行。
*   `README.md` 详细解释了漏洞原理和利用方法，并提供了攻击成功的截图。

**投毒风险：**

此仓库中可能存在轻微的投毒风险，约为5%。

*   `DoS.cmd` 只是一个简单的拒绝服务攻击示例，但攻击者可能会将其替换为更具破坏性的恶意代码，例如勒索软件或信息窃取程序。如果下载者不仔细检查 `DoS.cmd` 的内容，可能会在不知情的情况下运行恶意代码。
*   `exploit.py` 脚本本身没有明显的恶意代码，但它可以被修改以生成包含不同恶意代码的 RAR 文件。下载者应该仔细审查脚本的内容，确保它不会被用于传播恶意软件。

**利用方式：**

1.  攻击者创建一个包含良性文件（例如 `image.jpg`）和一个同名文件夹（例如 `image.jpg `）的 ZIP 压缩包。注意文件夹名称后面有一个空格。
2.  在同名文件夹中，攻击者放置恶意代码（例如 `image.jpg .cmd`）。
3.  攻击者将 ZIP 文件转换为 RAR 文件（POC 脚本完成了此过程）。
4.  攻击者诱骗用户使用受影响的 WinRAR 版本打开 RAR 文件并尝试查看良性文件（`image.jpg`）。
5.  WinRAR 错误地执行同名文件夹中的恶意代码 (`image.jpg .cmd`)，从而导致远程代码执行。

由于该漏洞被广泛利用，并且网上存在大量相关的 POC 代码，因此攻击者很容易发起攻击。


**项目地址:** [RonF98/CVE-2023-38831-POC](https://github.com/RonF98/CVE-2023-38831-POC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #8

**来源**: [CVE-2023-38831-SpamixOfficial_CVE-2023-38831.md](../2023/CVE-2023-38831-SpamixOfficial_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前的版本中的代码执行漏洞。攻击者可以制作一个特制的ZIP压缩包，其中包含一个良性文件和一个同名文件夹，文件夹中包含恶意可执行文件。当用户尝试在WinRAR中查看良性文件时，实际上会执行文件夹中的恶意代码。\n\n**有效性：**根据漏洞库信息、搜索结果和漏洞利用代码，该漏洞POC是有效的。漏洞库信息中明确指出该漏洞已在野外被利用。搜索结果中多个链接都指向了关于该漏洞的分析和利用报告。提供的`Cargo.lock`文件很可能只是rust项目依赖管理文件，无法直接证明POC的有效性，需配合rust源码进行分析。\n\n**投毒风险：**分析提供的`Cargo.lock`文件，该文件列出了Rust项目`CVE-2023-38831`的依赖项。虽然`Cargo.lock`本身不包含可执行代码，但是，如果恶意作者修改了依赖项的版本或来源，理论上存在引入被篡改过的crate（Rust包）的风险。不过，由于`Cargo.lock`文件明确指定了每个依赖项的checksum，Cargo在构建项目时会验证下载的crate是否与checksum匹配，从而降低了被投毒的风险。评估投毒风险为10%。\n\n**利用方式：**攻击者创建一个包含以下结构的ZIP压缩包：\n\n1.  一个良性的文件，例如 `image.jpg`\n2.  一个与良性文件同名的文件夹，例如 `image.jpg`\n3.  在同名文件夹中，放置恶意可执行文件，例如 `image.jpg.exe` 或 `image.jpg `(通过空格进行欺骗)。\n\n当用户使用存在漏洞的WinRAR版本打开该ZIP文件并尝试查看`image.jpg`时，WinRAR会错误地执行`image.jpg`文件夹中的恶意程序，从而实现远程代码执行。

**项目地址:** [SpamixOfficial/CVE-2023-38831](https://github.com/SpamixOfficial/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #9

**来源**: [CVE-2023-38831-Tolu12wani_Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution.md](../2023/CVE-2023-38831-Tolu12wani_Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在用户尝试查看 ZIP 压缩包中的文件时执行任意代码。

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开特制的 ZIP 压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者通过构造恶意的 ZIP 压缩包实现远程代码执行。该压缩包包含一个良性文件（例如 JPG）和一个与良性文件同名的文件夹。当用户尝试访问良性文件时，WinRAR 会错误地执行同名文件夹中的内容，从而执行攻击者放置的恶意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被广泛利用。 提供的POC代码描述的是在压缩文件中嵌入恶意payload，并触发反向shell的实验环境验证过程。虽然该代码本身没有包含恶意代码，但描述了如何构建利用该漏洞的压缩文件。

**投毒风险：**
提供的 POC 代码仓库中只包含 PDF 报告和截图，并没有可执行的恶意代码。 但是,README中说明了该仓库展示了恶意payload的嵌入方式，存在一定的潜在风险。 因此，存在一定的投毒风险，但风险较低。根据readme描述和文件结构，投毒风险评估为10%，

**利用方式：**
1.  **创建恶意 ZIP 压缩包：** 攻击者创建一个 ZIP 压缩包，其中包含一个良性文件（例如 JPG）和一个与良性文件同名的文件夹。
2.  **放置恶意代码：** 将恶意可执行文件放置在与良性文件同名的文件夹中。
3.  **诱骗用户：** 诱骗用户使用受影响的 WinRAR 版本打开该 ZIP 压缩包并尝试查看良性文件。
4.  **执行恶意代码：** WinRAR 错误地执行同名文件夹中的恶意代码，从而实现远程代码执行。

根据搜索结果，该漏洞已经被政府支持的攻击者利用，用于投放 RAT（远程访问木马）等恶意软件。

**项目地址:** [Tolu12wani/Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution](https://github.com/Tolu12wani/Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #10

**来源**: [CVE-2023-38831-VictoriousKnight_CVE-2023-38831_Exploit.md](../2023/CVE-2023-38831-VictoriousKnight_CVE-2023-38831_Exploit.md)

## CVE-2023-38831-WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码。

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的恶意ZIP文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个漏洞，它允许攻击者通过构造特殊的ZIP文件来执行任意代码。攻击者创建一个ZIP文件，其中包含一个良性文件（例如，JPG图片）和一个与该良性文件同名的文件夹。该文件夹中包含恶意可执行文件。当用户尝试在WinRAR中查看该良性文件时，WinRAR会错误地执行该文件夹中的恶意代码，从而导致远程代码执行。

**有效性：** 提供的POC代码是有效的。根据漏洞库信息和搜索结果，该漏洞在野外被广泛利用。POC代码通过创建包含良性文件和同名文件夹的恶意ZIP文件，并利用WinRAR处理文件时的缺陷来执行代码。POC代码结构清晰，易于理解和使用。

**投毒风险：** 提供的POC代码本身主要是利用漏洞生成EXP，但仔细检查代码，在`exploit.py`文件的zip文件内容操作部分被截断，没有展示修改zip文件内容的关键代码，作者可能在`Read and manipulate the zip file content`部分添加恶意代码，执行修改zip文件过程中的任何恶意行为。因此存在一定的投毒风险，根据代码完整度，我给出10%的投毒风险。

**利用方式：**
1.  攻击者创建一个恶意ZIP文件，其中包含一个看似无害的文件（例如，一个图片或PDF）。
2.  在ZIP文件中，攻击者同时创建一个与该无害文件同名的文件夹。
3.  该文件夹包含攻击者想要执行的恶意代码，通常是一个可执行文件或脚本。
4.  攻击者诱使用户使用存在漏洞的WinRAR版本打开该ZIP文件。
5.  当用户尝试访问ZIP文件中的“无害”文件时，WinRAR会错误地执行同名文件夹中的恶意代码。

**项目地址:** [VictoriousKnight/CVE-2023-38831_Exploit](https://github.com/VictoriousKnight/CVE-2023-38831_Exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #11

**来源**: [CVE-2023-38831-anelya0333_Exploiting-CVE-2023-38831.md](../2023/CVE-2023-38831-anelya0333_Exploiting-CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开特制的ZIP压缩文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞允许攻击者通过特制的ZIP压缩文件在目标系统上执行任意代码。该漏洞的根源在于WinRAR在处理包含与文件同名文件夹的ZIP文件时存在缺陷。攻击者可以构造一个 ZIP 文件，其中包含一个良性文件（例如.JPG）和一个与其同名的文件夹。当用户尝试在 WinRAR 中查看该良性文件时，WinRAR 会错误地执行该文件夹中的恶意代码。此PoC脚本生成一个ZIP文件，其中包含诱饵文件(bait file)和恶意脚本(script file)，并修改ZIP文件的文件头，以利用此漏洞。脚本创建与诱饵文件同名的文件夹，并将恶意脚本放入其中。然后，将诱饵文件的副本也放入ZIP文件中。通过替换文件名字段中的某些字符，WinRAR会将文件夹中的恶意文件误认为是要执行的文件，最终导致代码执行。由于代码仅仅是构造payload，不存在主动执行恶意代码，因此不存在投毒风险。

**项目地址:** [anelya0333/Exploiting-CVE-2023-38831](https://github.com/anelya0333/Exploiting-CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #12

**来源**: [CVE-2023-38831-b1tg_CVE-2023-38831-winrar-exploit.md](../2023/CVE-2023-38831-b1tg_CVE-2023-38831-winrar-exploit.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可导致完全系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开恶意构造的ZIP文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 允许攻击者通过特制的ZIP文件在受害者系统上执行任意代码。该漏洞源于 WinRAR 处理包含同名文件和文件夹的 ZIP 档案时的不当行为。攻击者可以创建一个 ZIP 文件，其中包含一个良性文件（例如 CLASSIFIED_DOCUMENTS.pdf）和一个同名文件夹（例如 CLASSIFIED_DOCUMENTS.pdf）。当用户尝试访问良性文件时，WinRAR 实际上会执行该文件夹中的内容（例如 script.bat）。

**有效性:**

提供的 POC 代码 `cve-2023-38831-exp-gen.py` 旨在生成利用此漏洞的恶意 RAR 档案。该脚本通过以下步骤工作：

1.  创建临时目录 `TEMPLATE`。
2.  在 `TEMPLATE` 中创建一个与bait文件同名的文件夹，并在其中存放包含恶意命令的script文件（例如 `script.bat`， 其中包含`calc.exe & CLASSIFIED_DOCUMENTS.pdf`）。
3.  将bait文件存放在`TEMPLATE`目录。
4.  将`TEMPLATE`目录压缩为zip文件。
5.  修改压缩包中文件和文件夹的名字，构造漏洞。
6.  最终输出 `CVE-2023-38831-poc.rar`。

该脚本能够有效地生成利用 CVE-2023-38831 的 RAR 文件，因此提供的 POC 代码是有效的。

**投毒风险:**

对提供的 POC 代码 (`cve-2023-38831-exp-gen.py` 和 `script.bat`) 进行分析后，未发现明显的恶意代码或后门。该脚本的功能明确且集中于生成利用 CVE-2023-38831 的 RAR 档案。 `script.bat` 的主要功能是启动计算器程序 (`calc.exe`) 并尝试打开诱饵文档 (`CLASSIFIED_DOCUMENTS.pdf`)，这是一个典型的 PoC 行为。 因此，该仓库中存在作者隐藏的投毒代码的风险极低。

**利用方式:**

1.  攻击者使用 `cve-2023-38831-exp-gen.py` 脚本，指定诱饵文件（例如 `CLASSIFIED_DOCUMENTS.pdf`）和恶意脚本（例如 `script.bat`），生成恶意 RAR 档案。
2.  攻击者通过各种方式（例如，电子邮件、恶意网站）将恶意 RAR 档案分发给受害者。
3.  受害者使用易受攻击的 WinRAR 版本（< 6.23）打开恶意 RAR 档案。
4.  当受害者尝试访问诱饵文件时，WinRAR 错误地执行了同名文件夹中的恶意脚本。
5.  恶意脚本在受害者系统上执行任意代码，例如启动计算器或安装恶意软件。

**项目地址:** [b1tg/CVE-2023-38831-winrar-exploit](https://github.com/b1tg/CVE-2023-38831-winrar-exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #13

**来源**: [CVE-2023-38831-elefantesagradodeluzinfinita_cve-2023-38831.md](../2023/CVE-2023-38831-elefantesagradodeluzinfinita_cve-2023-38831.md)

## CVE-2023-38831 - WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用 WinRAR 打开特制的 ZIP 压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者通过特制的 ZIP 压缩包在受害者系统上执行任意代码。漏洞利用方式是创建一个 ZIP 压缩包，其中包含一个良性文件（例如 .jpg 或 .pdf）以及一个同名的文件夹。该文件夹包含恶意的可执行文件（例如 .cmd 或 .exe）。当用户尝试打开良性文件时，WinRAR 会错误地执行文件夹中的恶意代码。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码分析，该漏洞确实存在并且已经被野外利用。提供的代码描述了一个利用工具 "DR. GANDALF"，它允许用户创建包含此漏洞的 ZIP 文件，表明POC的有效性。

**投毒风险：** 提供的 README.md 文件主要描述了漏洞原理和利用工具的使用方法。但是，由于此工具允许用户自定义注入的代码和二进制文件，因此存在投毒风险。如果用户下载了包含恶意注入代码的ZIP文件，那么这个工具本身可能被利用来传播恶意软件。评估投毒风险为 10%，因为该描述文件本身不包含可以直接执行的后门代码，但生成的ZIP文件可以包含。

**利用方式：**
1.  攻击者创建一个包含恶意 ZIP 压缩包。
2.  ZIP 压缩包中包含一个良性文件（例如，`image.jpg`）和一个同名的文件夹（例如，`image.jpg`）。
3.  `image.jpg` 文件夹包含恶意的可执行文件（例如，`evil.cmd`）。
4.  攻击者诱骗受害者使用存在漏洞的 WinRAR 版本打开该 ZIP 压缩包并尝试访问良性文件 `image.jpg`。
5.  WinRAR 在处理该 ZIP 文件时，会错误地执行 `image.jpg` 文件夹中的恶意代码 `evil.cmd`，从而导致远程代码执行。

**项目地址:** [elefantesagradodeluzinfinita/cve-2023-38831](https://github.com/elefantesagradodeluzinfinita/cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #14

**来源**: [CVE-2023-38831-h3xecute_SideCopy-Exploits-CVE-2023-38831.md](../2023/CVE-2023-38831-h3xecute_SideCopy-Exploits-CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个远程代码执行漏洞。该漏洞的利用方式是构造一个特殊的ZIP压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹。当用户尝试使用WinRAR打开该ZIP压缩包并访问良性文件时，WinRAR会错误地执行文件夹中的恶意代码。

**有效性：**
提供的POC代码描述了漏洞利用的原理，即构造包含同名良性文件和文件夹的ZIP压缩包。根据漏洞信息和搜索结果，此方法是有效的，并且在野外被利用。

**投毒风险：**
该POC本身描述了漏洞的利用方式，包含一个指向YouTube视频的链接，以及对恶意压缩包结构的描述。投毒风险较低，约为10%，因为：
1.  POC主要以描述性文字和图片链接为主。
2.  缺乏直接可执行的payload代码。
3.  作者可能通过YouTube链接传播恶意信息。

**利用方式：**
1.  攻击者创建一个恶意的ZIP压缩包。
2.  该压缩包包含一个良性文件（例如JPG，PDF等）和一个与该文件同名的文件夹。
3.  恶意代码（例如，可执行文件）放置在同名文件夹中。
4.  攻击者诱骗用户使用WinRAR打开这个ZIP压缩包，并尝试访问良性文件。
5.  WinRAR在处理压缩包时，会错误地执行同名文件夹中的恶意代码，从而导致远程代码执行。

**项目地址:** [h3xecute/SideCopy-Exploits-CVE-2023-38831](https://github.com/h3xecute/SideCopy-Exploits-CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #15

**来源**: [CVE-2023-38831-idkwastaken_CVE-2023-38831.md](../2023/CVE-2023-38831-idkwastaken_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意的ZIP文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的漏洞。该漏洞的利用方式是创建一个特制的ZIP文件，其中包含一个良性文件和一个同名文件夹。当用户尝试使用WinRAR打开ZIP文件并访问该良性文件时，WinRAR会错误地执行该同名文件夹中的恶意代码，导致远程代码执行。

**有效性：**
提供的POC代码（exploit.c）利用了该漏洞。该代码生成一个ZIP文件，其中包含一个PDF文件（document.pdf）和一个名为“document.pdf\”的文件夹，该文件夹内包含一个恶意的批处理脚本（script.bat）。当用户在易受攻击的WinRAR版本中打开并尝试访问该PDF文件时，WinRAR将执行该批处理脚本。
checker.bat 是用来检测目标系统是否安装WinRAR，以及WinRAR的版本是否是受影响的版本。
exploit.ps1 看起来不完整，但是其作用应该是检查WinRAR版本。

**投毒风险：**
代码中存在一定的投毒风险，约为10%。原因如下：
*   **脚本内容可控：** exploit.c 中的script_content变量包含了要执行的命令，虽然当前POC仅仅是弹窗，但是攻击者可以修改这个变量，执行任意命令，例如下载恶意软件，执行系统命令等。
*   **复杂的构建过程：** exploit.c 代码本身比较复杂，阅读和分析需要一定的时间和精力。攻击者可以利用这一点，在代码中隐藏不易察觉的恶意代码。
虽然有潜在的投毒风险，但当前代码的主要目的是演示漏洞利用，风险较低，作者没有明显的隐藏后门行为，恶意代码比较容易被发现。

**利用方式：**
1.  攻击者创建一个恶意的ZIP压缩包，其中包含：
    *   一个良性的文件（例如 document.pdf）。
    *   一个与良性文件同名的文件夹（例如 document.pdf/）。
    *   恶意代码位于同名文件夹中（例如 document.pdf/script.bat）。
2.  攻击者诱骗目标用户使用存在漏洞的 WinRAR 版本打开此 ZIP 压缩包。
3.  当用户尝试打开良性文件时，WinRAR 错误地执行同名文件夹中的恶意代码，从而导致任意代码执行。


**项目地址:** [idkwastaken/CVE-2023-38831](https://github.com/idkwastaken/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #16

**来源**: [CVE-2023-38831-imbyter_imbyter-WinRAR_CVE-2023-38831.md](../2023/CVE-2023-38831-imbyter_imbyter-WinRAR_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 6.23

**利用条件:** 用户使用受影响的WinRAR版本打开特制的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于WinRAR 6.23之前的版本中。攻击者可以构造一个恶意的ZIP压缩包，其中包含一个伪装成良性文件的文件（例如 .jpg），以及一个同名的文件夹。当用户尝试在 WinRAR 中查看该“良性文件”时，实际上会执行同名文件夹中的恶意代码（例如 .cmd 或 .exe 文件）。

**有效性：**
根据漏洞信息和搜索结果，提供的POC代码是有效的。该POC利用了WinRAR处理ZIP压缩包时存在的逻辑漏洞，能够实现远程代码执行。

**投毒风险：**
提供的Python脚本 `make-poc.py` 用于生成POC压缩包，其本身的代码逻辑相对简单，主要功能是将指定的文件和脚本打包成特定的ZIP格式，并进行一些字符串替换以触发漏洞。主要风险在于脚本生成的POC包中包含的脚本，如果这个脚本是恶意的，那么整个利用过程就存在投毒风险。 仓库中的README.md文件里的测试脚本就是一个关闭计算机的脚本。代码本身存在一定的投毒风险.

*   脚本逻辑：脚本的功能是创建包含漏洞利用结构的RAR文件。
*   恶意操作：如果脚本被修改以包含下载和执行恶意软件的逻辑，那么用户在使用此脚本创建RAR文件时，就会受到投毒攻击。

**利用方式：**
1.  攻击者使用 `make-poc.py` 脚本构造恶意的ZIP压缩包，需要提供一个“良性”文件和一个恶意脚本。
2.  攻击者将恶意的ZIP压缩包发送给受害者。
3.  受害者使用受影响的WinRAR版本打开该ZIP压缩包，并尝试查看伪装的“良性”文件。
4.  WinRAR错误地执行了与“良性”文件同名的文件夹中的恶意脚本，导致远程代码执行。

**防御措施：**
*   升级WinRAR到6.23或更高版本。
*   谨慎打开来源不明的ZIP压缩包。
*   使用杀毒软件扫描ZIP压缩包。

**项目地址:** [imbyter/imbyter-WinRAR_CVE-2023-38831](https://github.com/imbyter/imbyter-WinRAR_CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #17

**来源**: [CVE-2023-38831-kehrijksen_CVE-2023-38831.md](../2023/CVE-2023-38831-kehrijksen_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 需要用户解压特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个恶意的 ZIP 压缩包，其中包含一个伪装成普通文件的文件和一个同名的文件夹。当用户尝试在 WinRAR 中查看该“普通文件”时，WinRAR 会错误地执行同名文件夹中的内容，从而导致任意代码执行。

**有效性：**
提供的 PoC 代码 `poc.py` 能够生成利用此漏洞的恶意 ZIP 压缩包。该脚本首先创建一个包含恶意 payload (例如 script.bat) 和良性文件 (例如 pepe.jpg) 的目录结构。然后，它将此目录结构压缩成 ZIP 文件，并修改 ZIP 文件中的文件名，以触发漏洞。`script.bat` 的作用是在 `%TEMP%` 目录下提取 ZIP 文件内容，运行良性文件作为诱饵，然后执行恶意操作，例如创建一个包含 “hacked” 内容的文本文件并使用记事本打开。

**投毒风险：**
分析提供的代码，没有发现明显的投毒代码。`poc.py` 的作用是生成恶意 ZIP 文件，而 `script.bat` 包含的是恶意行为的代码，例如运行良性文件，创建 `hacked.txt` 等。这些行为是漏洞利用的一部分，而不是隐藏的恶意代码。虽然利用 `script.bat` 可以执行任意操作，但这属于漏洞利用的范畴，而非代码投毒。

**利用方式：**
1.  攻击者使用 `poc.py` 脚本生成一个恶意的 ZIP 压缩包，其中包含一个良性文件（例如图片）和一个同名的文件夹。
2.  攻击者将此恶意 ZIP 压缩包发送给受害者。
3.  受害者使用 WinRAR (6.23 之前的版本) 打开并尝试查看 ZIP 压缩包中的良性文件。
4.  WinRAR 错误地执行与良性文件同名的文件夹中的内容 (由 `script.bat` 控制)。
5.  `script.bat` 首先将 ZIP 文件的内容解压到临时目录。
6.  `script.bat` 运行良性文件（例如图片）作为诱饵，以迷惑受害者。
7.  `script.bat` 执行任意恶意操作，例如创建文件，修改注册表，安装恶意软件等。


**项目地址:** [kehrijksen/CVE-2023-38831](https://github.com/kehrijksen/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #18

**来源**: [CVE-2023-38831-khanhtranngoccva_cve-2023-38831-poc.md](../2023/CVE-2023-38831-khanhtranngoccva_cve-2023-38831-poc.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。该漏洞源于WinRAR处理ZIP压缩包时，对文件名和文件夹名区分不当。攻击者可以创建一个ZIP压缩包，其中包含一个良性文件（例如JPG）和一个同名的文件夹。该文件夹中包含恶意可执行文件。当用户尝试在WinRAR中打开该良性文件时，WinRAR会错误地执行文件夹中的恶意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已在野外被利用，证明了其有效性。提供的POC代码片段（package-lock.json）显示使用了jszip库，表明该POC可能用于创建恶意的ZIP压缩包，进一步验证漏洞的可利用性。

**投毒风险：**
提供的POC代码片段是`package-lock.json`文件，主要描述了项目依赖。要判断是否存在投毒风险，需要检查实际的利用代码（例如 index.ts/index.js）。
*   这个`package-lock.json`文件本身不包含恶意代码，只是依赖声明。
*   **风险点在于开发者可能在其他代码文件中（如index.ts等，此文件未提供）包含恶意代码**。
*   jszip 库本身是一个常用的 ZIP 文件操作库，被投毒的可能性较低。
*   tsx和typescript是typescript相关工具，本身被投毒的可能性也比较低

由于缺乏实际的利用代码，无法确定是否存在投毒行为，只能根据现有信息进行推测，因此将投毒风险评估为10%。

**利用方式：**
1.  攻击者构造一个恶意的ZIP压缩包。
2.  该ZIP压缩包包含一个良性文件（例如JPG）和一个同名的文件夹。
3.  该文件夹中包含恶意可执行文件（例如EXE、BAT、CMD等）。
4.  攻击者诱骗用户使用受影响的WinRAR版本打开该ZIP压缩包。
5.  用户尝试在WinRAR中打开该良性文件。
6.  WinRAR错误地执行文件夹中的恶意代码，导致远程代码执行。

**项目地址:** [khanhtranngoccva/cve-2023-38831-poc](https://github.com/khanhtranngoccva/cve-2023-38831-poc)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #19

**来源**: [CVE-2023-38831-kuyrathdaro_winrar-cve-2023-38831.md](../2023/CVE-2023-38831-kuyrathdaro_winrar-cve-2023-38831.md)

## CVE-2023-38831-WinRAR代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个代码执行漏洞。该漏洞的利用方式如下：

1.  攻击者创建一个恶意的ZIP压缩包（伪装成RAR格式，后缀名为.rar）。
2.  该压缩包包含一个良性的文件（例如，document.pdf），以及一个与该良性文件同名的文件夹（例如，document.pdf）。
3.  同名文件夹中包含恶意payload（例如，一个.bat或.exe文件），命名为`document.pdfA.cmd`。
4.  用户使用存在漏洞的WinRAR版本打开该压缩包，并尝试打开良性文件（document.pdf）。
5.  由于WinRAR处理文件名的缺陷，实际上执行的是同名文件夹中的恶意payload。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以判断该漏洞PoC有效。搜索引擎结果中多个链接表明该漏洞已被广泛利用，并且Google的威胁分析小组也分析了利用该漏洞进行的攻击活动。提供的PoC代码实现了生成恶意RAR压缩包的逻辑，进一步验证了该漏洞的可利用性。

**投毒风险：**

PoC代码本身的主要功能是生成利用CVE-2023-38831漏洞的恶意压缩包。然而，我们仍然需要评估该代码是否存在潜在的投毒风险。以下是对代码的分析：

*   **代码功能明确：** PoC代码的功能是生成特定的文件结构和内容，以触发WinRAR漏洞。代码逻辑相对简单，易于理解。
*   **输入/输出控制：** PoC代码接受三个输入参数：良性文件、Payload文件和输出文件名。这三个参数都由用户指定，PoC本身没有主动下载或执行任何其他代码的功能。
*   **潜在风险点：** `exploit.py` 脚本使用 `shutil.copyfile` 函数来复制 payload 文件到临时目录，如果payload 文件本身就是恶意的，那么这也会造成风险。此外，尽管脚本尝试确保输出文件以 `.rar` 结尾，但恶意用户可能修改此行为。
*   **间接风险：** 如果攻击者修改了提供的 `exploit.py` 脚本，添加额外的恶意功能（例如，在生成恶意压缩包后，自动上传到恶意服务器），则可能存在投毒风险。但是，这并非原始PoC代码本身的问题。

综合来看，原始PoC代码本身存在直接投毒的风险较低，我估计的投毒风险概率为 **10%**。这主要是因为恶意 payload 本身会带来风险，但 PoC 代码并没有主动引入恶意行为。

**利用方式：**

1.  准备一个良性的文件（例如，document.pdf）和一个恶意payload（例如，script.bat或malware.exe）。
2.  运行PoC脚本，指定良性文件、payload文件和输出文件名。
3.  PoC脚本生成一个恶意的RAR压缩包（实际上是ZIP格式，但后缀名为.rar）。
4.  将该恶意RAR压缩包发送给目标用户。
5.  目标用户使用存在漏洞的WinRAR版本打开该压缩包，并尝试打开良性文件。
6.  WinRAR执行同名文件夹中的恶意payload，从而实现代码执行。


**项目地址:** [kuyrathdaro/winrar-cve-2023-38831](https://github.com/kuyrathdaro/winrar-cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #20

**来源**: [CVE-2023-38831-malvika-thakur_CVE-2023-38831.md](../2023/CVE-2023-38831-malvika-thakur_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以通过创建一个特制的 ZIP 压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹，文件夹中包含恶意可执行文件。当用户尝试在 WinRAR 中查看该良性文件时，由于 WinRAR 处理逻辑的缺陷，会错误地执行文件夹中的恶意代码，从而导致远程代码执行。

**有效性：**

提供的 POC 代码 `poc.py`  可以生成利用此漏洞的 ZIP 文件。代码首先检查恶意脚本和良性文件是否存在，然后创建一个目录，将脚本和良性文件复制到特定结构中，最后将该目录压缩成 ZIP 文件。用户只需双击压缩包内的良性文件即可触发漏洞，执行恶意脚本。因此，POC 代码有效。

**投毒风险：**

分析提供的 `poc.py` 代码，没有发现明显的投毒代码。该脚本的主要功能是生成利用 CVE-2023-38831 漏洞的恶意 ZIP 文件。它需要用户提供恶意脚本和良性文件，然后按照特定目录结构进行组织并压缩。代码中没有发现任何会执行额外恶意操作的逻辑。`README.md` 文件也仅包含漏洞描述和使用说明，没有发现恶意内容。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者创建一个包含良性文件（如 JPG 图片）和一个同名文件夹的 ZIP 压缩包。
2.  该文件夹中包含恶意可执行文件（如 BAT 脚本）。
3.  攻击者将该 ZIP 压缩包发送给目标用户。
4.  目标用户使用受影响的 WinRAR 版本打开该 ZIP 压缩包。
5.  目标用户双击 ZIP 压缩包中的良性文件。
6.  WinRAR 错误地执行同名文件夹中的恶意可执行文件，导致远程代码执行。

**项目地址:** [malvika-thakur/CVE-2023-38831](https://github.com/malvika-thakur/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #21

**来源**: [CVE-2023-38831-r1yaz_winDED.md](../2023/CVE-2023-38831-r1yaz_winDED.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开特制的恶意 ZIP 压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 是 WinRAR 在处理 ZIP 压缩文件时存在的远程代码执行漏洞。当 WinRAR 版本低于 6.23 时，如果用户尝试打开一个包含恶意构造的 ZIP 文件，攻击者可以利用此漏洞执行任意代码。该 ZIP 文件包含一个良性文件（例如 JPG 文件）和一个与其同名的文件夹。攻击者可以将可执行文件放置在该文件夹中，当用户尝试访问良性文件时，WinRAR 会错误地执行文件夹中的可执行文件。

**有效性：**
提供的 POC 代码（winDED）通过生成恶意 ZIP 文件来演示漏洞利用。它创建了一个良性文件和一个同名文件夹，并将恶意脚本放入文件夹中。用户双击压缩包中的 PDF 文件时，实际上会执行该恶意脚本，从而证明漏洞的可利用性。

**投毒风险：**
根据提供的 POC 代码，投毒风险较低。代码主要是为了演示漏洞而设计的，虽然存在执行恶意 `super_sneaky_evil_script.bat` 的可能性，但该脚本本身是由用户提供的，或者可以通过查看代码本身来确认其行为。 然而，仍然存在一些细微的风险，例如，如果 `super_sneaky_evil_script.bat` 本身是从其他来源下载的，则可能包含恶意代码。  总的来说, 投毒风险约 10%。

**利用方式：**
1.  创建一个包含良性文件 (例如，`BILLION_DOLLAR_SECRET.pdf`) 和一个同名文件夹 (`BILLION_DOLLAR_SECRET.pdf`) 的 ZIP 压缩文件。
2.  将恶意脚本 (例如，`super_sneaky_evil_script.bat`) 放入同名文件夹中。
3.  诱骗目标用户使用 WinRAR 打开该 ZIP 文件。
4.  当用户尝试打开良性文件时，WinRAR 错误地执行同名文件夹中的恶意脚本，从而实现远程代码执行。

**项目地址:** [r1yaz/winDED](https://github.com/r1yaz/winDED)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #22

**来源**: [CVE-2023-38831-ra3edAJ_LAB-DFIR-cve-2023-38831.md](../2023/CVE-2023-38831-ra3edAJ_LAB-DFIR-cve-2023-38831.md)

## CVE-2023-38831-WinRAR代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 是 WinRAR 在 6.23 版本之前存在的远程代码执行漏洞。该漏洞源于WinRAR处理ZIP压缩包时，如果压缩包中包含一个良性文件和一个与该良性文件同名的文件夹，WinRAR在尝试访问良性文件时，会错误地执行同名文件夹中的恶意内容。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的PoC是可用的。漏洞在野外被广泛利用，并且CISA已将其添加到已知被利用的漏洞目录中。

**投毒风险：**
提供的漏洞利用代码为一个Github仓库的README.md文件，主要描述了如何利用磁盘镜像调查CVE-2023-38831攻击，并通过Windows注册表、NTFS文件和浏览器缓存理解Windows事件序列。仓库本身目的是为了DFIR分析，因此直接包含恶意代码的可能性较低。但考虑到链接跳转至外部教程网站，存在间接投毒的可能，即教程内容可能包含引导至恶意软件下载或运行恶意脚本的指令。因此，投毒风险较低，评估为10%。

**利用方式：**
1.  **创建恶意的ZIP压缩包：** 压缩包中包含一个良性文件（如JPG图片）和一个与该良性文件同名的文件夹。
2.  **将恶意可执行文件放入同名文件夹：** 该文件夹中的可执行文件会在用户尝试打开良性文件时被执行。
3.  **诱导用户打开ZIP压缩包：** 通过社交工程或其他方式，诱导用户使用受影响版本的WinRAR打开该压缩包。
4.  **触发漏洞执行恶意代码：** 当用户尝试查看ZIP压缩包中的良性文件时，WinRAR会错误地执行同名文件夹中的恶意代码，从而实现远程代码执行。

**总结：**
该漏洞利用方式较为简单，易于传播，危害较大。用户应及时更新WinRAR至最新版本，避免打开来源不明的ZIP压缩包。

**项目地址:** [ra3edAJ/LAB-DFIR-cve-2023-38831](https://github.com/ra3edAJ/LAB-DFIR-cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #23

**来源**: [CVE-2023-38831-ruycr4ft_CVE-2023-38831.md](../2023/CVE-2023-38831-ruycr4ft_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的远程代码执行漏洞。该漏洞源于WinRAR在处理ZIP压缩包时，对文件名和文件夹名相同的情况处理不当。攻击者可以构造一个恶意的ZIP压缩包，其中包含一个看似无害的文件（例如.jpg），同时包含一个同名的文件夹。当用户尝试打开该“无害文件”时，WinRAR会错误地执行同名文件夹中的恶意代码。\n\n**有效性：** 根据漏洞信息、搜索结果以及提供的POC代码，该漏洞利用是有效的。多个来源都表明该漏洞已被广泛利用，POC代码也展示了如何生成包含恶意代码的RAR压缩文件。POC代码通过创建同名文件和文件夹，并在文件夹中放入恶意脚本，利用WinRAR的缺陷触发代码执行。\n\n**投毒风险：**  仓库的投毒风险较低，大概10%。
  *   `poc.py`: 该脚本的功能是生成利用 CVE-2023-38831 的恶意 RAR 文件。虽然它允许用户指定 bait 文件和脚本文件，但脚本本身不包含任何预设的、隐藏的恶意行为。
  *   `script.bat`:  这个批处理文件包含使用 `nc.exe` (netcat) 反弹 shell 的命令。**这里存在一定的投毒风险。** 批处理文件明确地使用了`192.168.0.107`这个IP地址,如果用户直接使用该IP反弹shell,将会连接到攻击者的服务器。虽然IP地址可以被用户更改，但在默认情况下，如果用户不修改，将会连接到攻击者的IP。这是主要的投毒点。
  *   README.md: 该文件仅包含漏洞的简单介绍和演示图片。没有发现恶意代码。

**利用方式：**\n1.  攻击者创建一个恶意的ZIP压缩包。该压缩包包含一个诱饵文件（例如图片.jpg）和一个与其同名的文件夹（例如图片.jpg）。\n2.  攻击者将恶意代码（例如一个批处理脚本或可执行文件）放入同名文件夹中。\n3.  攻击者将包含恶意代码的ZIP压缩包发送给受害者。\n4.  受害者使用存在漏洞的WinRAR版本打开该ZIP压缩包，并尝试打开诱饵文件。\n5.  WinRAR错误地执行同名文件夹中的恶意代码，导致远程代码执行。

**项目地址:** [ruycr4ft/CVE-2023-38831](https://github.com/ruycr4ft/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #24

**来源**: [CVE-2023-38831-s4m98_winrar-cve-2023-38831-poc-gen.md](../2023/CVE-2023-38831-s4m98_winrar-cve-2023-38831-poc-gen.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开恶意的ZIP/RAR压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于WinRAR处理ZIP压缩文件时，由于对文件名和文件夹名处理不当导致。攻击者可以构造一个包含恶意脚本的ZIP压缩文件，该压缩文件包含一个正常的诱饵文件（如PDF、PNG或JPG）和一个同名的文件夹，当用户尝试打开诱饵文件时，WinRAR会错误地执行该文件夹中的恶意脚本。

**有效性：**
根据漏洞信息、搜索引擎结果和漏洞利用代码，该POC代码有效。漏洞库信息表明该漏洞已被野外利用。搜索引擎结果中也包含了大量关于此漏洞的分析和利用报告，证实了该漏洞的有效性。POC代码的描述和实现也符合漏洞的利用方式，通过生成包含恶意脚本和诱饵文件的RAR压缩包来触发漏洞。

**投毒风险：**
代码本身看起来比较直接，主要是生成利用漏洞的压缩包。`script.bat` 这个文件需要额外注意。当前提供的 `script.bat` 只是打开了计算器 `calc.exe` 和 Web_Security.pdf,相对来说是安全的，但用户在使用该漏洞时，完全可以修改此文件，添加更加恶意的payload，具有一定的风险。作者在代码中没有明显投毒行为，主要风险在于用户如何使用该工具生成payload。
投毒风险评估：10% (主要是用户修改 `script.bat` 的风险)

**利用方式：**
1.  **构造恶意ZIP/RAR压缩文件：** 利用提供的Python脚本（cve-2023-38831-exp-gen.py）生成恶意的ZIP/RAR压缩文件。此脚本需要一个诱饵文件（如PDF、PNG、JPG）和一个恶意脚本文件（如BAT、CMD、或可执行文件）。该脚本会创建一个包含诱饵文件和一个同名文件夹的压缩包，并将恶意脚本放置在该文件夹中。
2.  **诱骗用户打开压缩文件：**  将生成的恶意ZIP/RAR压缩文件发送给目标用户。
3.  **执行恶意代码：** 当用户使用受影响的WinRAR版本打开压缩文件并尝试查看诱饵文件时，WinRAR会错误地执行同名文件夹中的恶意脚本，从而实现远程代码执行。

 总体来说，该漏洞利用方式较为简单，攻击成本较低，风险较高。

**项目地址:** [s4m98/winrar-cve-2023-38831-poc-gen](https://github.com/s4m98/winrar-cve-2023-38831-poc-gen)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #25

**来源**: [CVE-2023-38831-solomon12354_VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC.md](../2023/CVE-2023-38831-solomon12354_VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要解压恶意的ZIP/RAR压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 存在于 WinRAR 6.23 之前版本中。攻击者可以构造一个包含良性文件和同名文件夹的 ZIP 压缩包，当用户尝试访问良性文件时，WinRAR 会错误地执行同名文件夹中的恶意代码。提供的 `exploit.py` 脚本可以用于生成包含漏洞利用的RAR压缩文件。脚本首先要求输入良性文件（`bait_file`）、恶意脚本文件（`script_file`）和输出RAR文件名称。然后，它创建一个临时目录，将恶意脚本复制到与良性文件同名的目录中，并将良性文件复制到临时目录中。最后，使用 `shutil.make_archive` 函数将临时目录压缩成 ZIP 文件，并修改 ZIP 文件的内容，将目录名中的 'A' 和 'B' 替换为空格，从而绕过 WinRAR 的安全检查。最终，将修改后的 ZIP 文件重命名为 RAR 文件。

`squid.bat` 用于下载并执行 `volleysquid.exe`。`volleyballsquid.py` 尝试利用 BypassUAC 来提升权限并将程序设置为开机自启。

**有效性:** 根据漏洞信息和利用代码分析，提供的 POC 代码有效，可以利用此漏洞在受害者机器上执行任意代码。

**投毒风险:** 仓库中存在一定的投毒风险，虽然主要功能是利用CVE-2023-38831漏洞，但是 `volleyballsquid.py`和`squid.bat`文件中的行为具有恶意性，特别是`volleyballsquid.py`中尝试使用`BypassUAC`绕过用户账户控制并持久化安装，这可能被用于安装后门或恶意软件。虽然主要目的是展示漏洞，但客观上存在后门功能，因此投毒风险占比为10%。

**利用方式:** 攻击者首先利用 `exploit.py` 脚本生成包含恶意代码的RAR压缩文件。然后，诱骗用户下载并使用 WinRAR 解压此文件。当用户尝试打开压缩包中的“良性”文件时，实际上会执行隐藏在同名目录中的恶意脚本 (例如 `squid.bat`)，下载并执行恶意程序。

根据搜索结果，CVE-2023-38831 漏洞已被广泛利用，并且已被政府背景的攻击者使用，这进一步验证了漏洞的严重性和 POC 代码的有效性。

**项目地址:** [solomon12354/VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC](https://github.com/solomon12354/VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #26

**来源**: [CVE-2023-38831-technicalcorp0_CVE-2023-38831-Exploit.md](../2023/CVE-2023-38831-technicalcorp0_CVE-2023-38831-Exploit.md)

## CVE-2023-38831-WinRAR-任意代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 任意代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个漏洞，该漏洞允许攻击者通过特制的ZIP档案执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** 当WinRAR尝试访问ZIP归档中的良性文件时，如果存在与该良性文件同名的文件夹，WinRAR会处理该文件夹的内容（可能包含可执行内容）。
2.  **利用方式：**
    *   攻击者创建一个恶意的ZIP档案，该档案包含一个良性文件（例如.JPG文件）和一个与该良性文件同名的文件夹。
    *   该文件夹包含恶意可执行文件。
    *   当受害者尝试在WinRAR中查看良性文件时，WinRAR会执行该文件夹中的恶意代码。
3.  **POC有效性：** 提供的POC代码 (CVE-2023-38831-WinRar-Exploit.py) 的目的是生成包含利用此漏洞的恶意 ZIP 文件。根据代码逻辑和漏洞原理，该 POC 可以有效利用该漏洞。
4.  **投毒风险：** 经过对POC代码的分析，发现代码本身实现了漏洞利用过程，但同时也存在一定的投毒风险。`clean_up()`函数会删除临时文件，但不能保证完全清除所有痕迹。攻击者可能通过修改代码，在生成恶意 ZIP 文件后，在目标系统上留下后门或执行其他恶意操作。考虑到实际利用场景中可能存在的恶意修改，投毒风险估计为5%。 主要风险点在于，虽然POC主要目的是生成exploit，但如果恶意人员修改，完全可以添加其他恶意payload，并伪装成CVE-2023-38831的POC进行传播。
5. **搜索引擎结果:** 搜索引擎结果表明此漏洞已被广泛利用，包括政府背景的黑客组织。 多个安全厂商发布了相关的分析和防御措施。

**项目地址:** [technicalcorp0/CVE-2023-38831-Exploit](https://github.com/technicalcorp0/CVE-2023-38831-Exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #27

**来源**: [CVE-2023-38831-xk-mt_WinRAR-Vulnerability-recurrence-tutorial.md](../2023/CVE-2023-38831-xk-mt_WinRAR-Vulnerability-recurrence-tutorial.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。该漏洞允许攻击者通过构造恶意的ZIP压缩包，在用户尝试查看压缩包内的文件时执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，该漏洞已被广泛利用，POC代码的存在也表明其有效性。多个安全厂商和研究人员都对此漏洞进行了分析并提供了相应的缓解措施。

**投毒风险分析：**
提供的POC代码包含以下文件：
*   `README.md`: 漏洞复现教程，包含漏洞信息和参考链接。
*   `执行命令.bat`: 一个简单的批处理文件，用于执行`calc.exe`（计算器程序），用于演示代码执行。
*   `文本.txt`: 包含一个URL地址。
*   `生成压缩包.py`: 一个Python脚本，用于生成包含漏洞的ZIP压缩包。

该脚本的主要功能是：
1.  创建临时目录，并将`执行命令.bat`复制到该目录。
2.  复制`文本.txt`文件到另一个目录。
3.  将上述两个目录打包成ZIP文件。
4.  修改ZIP文件中的文件名，利用漏洞的原理。
从代码本身来看，该脚本并没有明显的恶意代码，但是存在一定的投毒风险。
*   执行命令.bat： 虽然只是简单的calc.exe，但如果攻击者替换成其他恶意命令，则可能造成更大的危害。
*   脚本的依赖： 该脚本依赖Python环境，攻击者可能会通过修改脚本，引入恶意的Python依赖包，从而实现投毒。

综合来看，该仓库中存在一定的投毒风险，但不高。主要是因为演示的`执行命令.bat`内容比较简单，容易被识别。如果使用者直接运行此仓库的代码，有可能会被植入恶意程序。因此，投毒风险评定为10%。

**利用方式：**
1.  攻击者构造一个恶意的ZIP压缩包，该压缩包包含一个良性文件（例如，图片文件`文本.txt`）和一个与该文件同名的文件夹。
2.  该文件夹包含一个恶意可执行文件（例如，`执行命令.bat`并更名为`文本.txtA.cmd`）。
3.  当用户使用受影响的WinRAR版本打开该ZIP压缩包，并尝试查看良性文件时，WinRAR会错误地执行该文件夹中的恶意可执行文件，从而导致任意代码执行。

**项目地址:** [xk-mt/WinRAR-Vulnerability-recurrence-tutorial](https://github.com/xk-mt/WinRAR-Vulnerability-recurrence-tutorial)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #28

**来源**: [CVE-2023-38831-yezzfusl_cve_2023_38831_scanner.md](../2023/CVE-2023-38831-yezzfusl_cve_2023_38831_scanner.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开恶意的 ZIP 压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以通过构造一个特殊的 ZIP 压缩文件来利用此漏洞。该 ZIP 文件包含一个良性文件（例如 JPG）和一个同名的文件夹。当用户尝试访问良性文件时，WinRAR 会错误地执行文件夹中的恶意代码，导致远程代码执行。

**利用方式：**
1.  攻击者创建一个包含良性文件和同名文件夹的恶意 ZIP 文件。
2.  文件夹中包含要执行的恶意代码（例如，可执行文件）。
3.  攻击者诱使用户使用 WinRAR 打开该 ZIP 文件。
4.  当用户尝试访问良性文件时，WinRAR 会执行文件夹中的恶意代码。

**有效性：**
根据漏洞描述和搜索结果，该漏洞已在野外被利用，因此提供的PoC代码如果能够重现该行为，则可以认为是有效的。

**投毒风险：**
提供的代码仓库 `cve_2023_38831_scanner` 本身是一个漏洞扫描器，而非漏洞利用的PoC。尽管如此，仍然存在一定的投毒风险。代码中可能隐藏后门，虽然其主要功能是扫描，但理论上存在被篡改的风险。代码中使用了网络数据包分析、进程内存扫描、沙箱环境执行等模块，这些模块如果被恶意修改，可能被用于执行恶意操作。因此，综合考虑其扫描器的性质和潜在风险，投毒风险估计为10%。这个风险主要来自供应链投毒，如果下载了被篡改过的扫描器，那么扫描器本身可能成为攻击的一部分。

**项目地址:** [yezzfusl/cve_2023_38831_scanner](https://github.com/yezzfusl/cve_2023_38831_scanner)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #29

**来源**: [CVE-2023-38831-youmulijiang_evil-winrar.md](../2023/CVE-2023-38831-youmulijiang_evil-winrar.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 50%

## 详情

CVE-2023-38831是WinRAR在6.23版本之前存在的一个远程代码执行漏洞。该漏洞的利用方式是构造一个特殊的ZIP压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹。当用户尝试在WinRAR中查看该良性文件时，WinRAR会错误地执行该文件夹中的恶意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认该漏洞是有效的，并且已经在野外被利用。漏洞利用代码提供了一个框架，用于生成包含恶意payload的ZIP压缩包，从而实现远程代码执行。

**投毒风险分析：**
提供的代码是一个框架，用于生成漏洞利用的 ZIP 文件，包含生成 exp，邮件发送，下载链接生成等功能。代码中存在潜在的投毒风险，主要体现在以下几个方面：

1.  **Payload 植入:**  该框架可以自定义payload，如果用户在不了解 payload 内容的情况下使用，可能运行恶意指令。
2.  **代码可信度:** 虽然作者声明为安全开发成员，并开源了代码，但代码的安全性仍然需要进一步审计。存在作者预留后门的可能性。 考虑到这是一个漏洞利用框架，其本质就是为了执行恶意代码，所以判定为投毒代码的风险为50%。

**漏洞利用方式：**

1.  攻击者使用该漏洞利用框架(evil-winrar)生成一个恶意的 ZIP 压缩包。
2.  该 ZIP 压缩包包含一个良性文件（如JPG图片）和一个同名的文件夹，文件夹中包含恶意可执行文件。
3.  攻击者通过社会工程学等方式诱骗用户使用存在漏洞的 WinRAR 版本打开该 ZIP 压缩包。
4.  用户尝试查看良性文件时，WinRAR 会错误地执行同名文件夹中的恶意代码。
5.  恶意代码在用户系统上执行，攻击者从而实现远程代码执行，控制受害者的计算机。

**项目地址:** [youmulijiang/evil-winrar](https://github.com/youmulijiang/evil-winrar)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---



---

## POC #3

**来源**: [CVE-2023-38831-MaorBuskila_Windows-X64-RAT.md](../2023/CVE-2023-38831-MaorBuskila_Windows-X64-RAT.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者在用户尝试查看 ZIP 压缩包中的良性文件时执行任意代码。该漏洞源于 WinRAR 处理 ZIP 压缩包时，允许压缩包包含一个良性文件（例如 .JPG）和一个同名文件夹。当用户尝试访问该良性文件时，WinRAR 实际上会处理同名文件夹中的内容，从而允许攻击者在文件夹中放置恶意可执行文件并执行。

**有效性：**
从搜索结果和漏洞库信息来看，该漏洞已经被广泛利用，PoC 代码的存在也进一步验证了其有效性。

**投毒风险：**
提供的 Python 脚本 (`51721.py`) 用于生成 Windows x64 平台的反向 TCP Shellcode。该脚本本身不包含明显的恶意代码，功能是生成 shellcode。需要用户自行配置 IP 地址和端口。但是，由于该代码需要用户执行，并且可以生成任意 shellcode，存在一定投毒风险，例如，如果攻击者提供修改后的脚本，生成包含恶意功能的 shellcode (如删除文件，上传用户信息)，则用户可能无意中执行该恶意 shellcode. 脚本本身不包含网络连接或者其他与远程服务器通信的行为，可以基本判断代码仓库投毒风险较低.

**利用方式：**
1.  攻击者创建一个恶意的 ZIP 压缩包。
2.  该 ZIP 压缩包包含一个良性文件（例如 image.jpg）和一个同名文件夹（image.jpg）。
3.  同名文件夹包含恶意可执行文件，例如 exploit.exe，并可能包含一个 `.lnk` 文件，该快捷方式指向该恶意可执行文件。
4.  攻击者诱骗用户使用受影响版本的 WinRAR 打开该 ZIP 压缩包并尝试查看良性文件。
5.  WinRAR 错误地执行同名文件夹中的恶意可执行文件，从而导致远程代码执行。

**项目地址:** [MaorBuskila/Windows-X64-RAT](https://github.com/MaorBuskila/Windows-X64-RAT)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #4

**来源**: [CVE-2023-38831-MyStuffYT_CVE-2023-38831-POC.md](../2023/CVE-2023-38831-MyStuffYT_CVE-2023-38831-POC.md)

## CVE-2023-38831-WinRAR-远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的恶意ZIP压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个恶意的ZIP压缩文件，其中包含一个良性文件（例如.jpg）和一个同名的文件夹。当用户尝试在 WinRAR 中查看该良性文件时，WinRAR 会错误地执行该文件夹中的内容，从而导致任意代码执行。

**有效性：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。搜索引擎结果表明该漏洞已被广泛利用，POC代码的存在进一步证实了其有效性。

**投毒风险：**

根据对POC代码的分析，存在一定的投毒风险。`script.bat`脚本从github下载`Alert.exe`文件，这本身就存在一定的安全隐患，无法确保下载的文件一定是安全的。此外，脚本同时执行 `alert.exe` 和 `gtaleak.mp4`，而 `gtaleak.mp4` 在 README 中说明是 “zeros without ones”, 可以确定这是一个障眼法，实际的恶意行为是由 `alert.exe` 执行。 因此，作者可能隐藏了投毒代码。

**利用方式：**

1.  攻击者创建一个恶意的ZIP压缩文件，其中包含一个良性文件 (例如 `gtaleak.mp4`) 和一个同名的文件夹。
2.  该文件夹包含一个批处理脚本 (`script.bat`)，该脚本将从远程服务器下载并执行恶意程序 (`Alert.exe`)。
3.  当用户尝试使用 WinRAR 打开压缩文件并查看良性文件 (`gtaleak.mp4`) 时，WinRAR 会错误地执行批处理脚本。
4.  批处理脚本下载并执行恶意程序，从而允许攻击者在受害者的系统上执行任意代码。

**项目地址:** [MyStuffYT/CVE-2023-38831-POC](https://github.com/MyStuffYT/CVE-2023-38831-POC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #5

**来源**: [CVE-2023-38831-Nielk74_CVE-2023-38831.md](../2023/CVE-2023-38831-Nielk74_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本的代码执行漏洞。该漏洞允许攻击者在用户尝试查看ZIP存档中的看似无害的文件时执行任意代码。攻击者通过构造一个包含同名文件和文件夹的恶意ZIP文件，利用WinRAR处理文件路径时的逻辑缺陷，使得文件夹中的恶意可执行文件得以运行。提供的POC代码通过Vagrant自动化部署了一个易受攻击的WinRAR 6.22环境，并向虚拟机桌面添加了一个恶意的rar文件。该rar文件被设计为当用户点击其中的“无害”文件时，执行预先设定的恶意代码。尽管POC的主要目的是演示漏洞，但其中`ChocolateyInstall.ps1`脚本从外部源下载并安装软件包（Chocolatey和WinRAR），存在被篡改从而引入恶意代码的风险，这构成了潜在的投毒风险。虽然这个脚本很常见，但还是存在一定的风险，因此这里给出了10%的投毒风险。

**漏洞利用方式：**

1.  攻击者创建一个恶意的ZIP压缩包，其中包含一个看似无害的文件（例如.jpg），以及一个与该文件同名的文件夹。
2.  该文件夹包含恶意可执行文件，例如.exe或.cmd脚本。
3.  当用户尝试使用WinRAR打开ZIP压缩包并查看“无害”文件时，WinRAR会错误地执行同名文件夹中的恶意可执行文件，从而导致任意代码执行。
4.  攻击者可以利用此漏洞在受害者系统上安装恶意软件、窃取敏感数据或执行其他恶意操作。

**项目地址:** [Nielk74/CVE-2023-38831](https://github.com/Nielk74/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #6

**来源**: [CVE-2023-38831-RomainBayle08_CVE-2023-38831.md](../2023/CVE-2023-38831-RomainBayle08_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP或RAR压缩文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个特殊的 ZIP 压缩文件，该文件包含一个看似无害的文件（例如，.JPG 文件）和一个与该文件同名的文件夹。当用户尝试查看压缩文件中的无害文件时，WinRAR 会错误地执行文件夹中的内容，从而导致任意代码执行。

**有效性分析：**
提供的 POC 代码 `cve-2023-38831-exp-gen.py` 是一个漏洞利用生成器脚本，它接受诱饵文件 (`BAIT_NAME`)、脚本文件 (`SCRIPT_NAME`) 和额外的诱饵文件目录 (`BAIT_FILES`) 作为输入，并生成一个恶意 RAR 压缩文件 (`OUTPUT_NAME`)。脚本首先创建一个包含诱饵文件和脚本文件的临时目录结构，然后使用 `shutil.make_archive` 函数将该目录压缩为 ZIP 文件。关键在于，脚本会替换 ZIP 文件中特定文件的扩展名，利用 WinRAR 的漏洞，在用户尝试打开诱饵文件时执行脚本文件。`script.bat` 脚本会首先尝试打开诱饵文件（模拟用户行为），然后执行 `calc.exe`（作为漏洞利用成功的标志）。该 POC 的有效性较高，因为它模拟了真实的攻击场景。

**投毒风险分析：**
`cve-2023-38831-exp-gen.py` 脚本本身不包含明显的恶意代码或后门。但是，存在一定的投毒风险，因为该脚本允许攻击者指定要执行的任意脚本 (`SCRIPT_NAME`)。攻击者可以替换 `script.bat` 文件为包含恶意代码的文件，例如下载和执行其他恶意软件。此外，该脚本使用了`BAIT_FILES`参数，如果提供包含恶意文件的目录，也会构成投毒风险。所以存在一定投毒风险，但主要取决于用户提供的脚本和目录的内容。

**利用方式分析：**
1.  攻击者构造一个恶意 ZIP 压缩文件，其中包含一个诱饵文件（如 `CLASSIFIED_DOCUMENTS.pdf`）和一个与诱饵文件同名的文件夹。文件夹中包含一个脚本文件（如 `script.bat`）。
2.  攻击者将恶意 ZIP 文件发送给受害者，诱骗其使用 WinRAR 打开。
3.  当受害者尝试查看 ZIP 文件中的诱饵文件时，WinRAR 会错误地执行同名文件夹中的脚本文件。
4.  脚本文件执行任意代码，例如安装恶意软件或窃取敏感信息。

总的来说，该漏洞利用方式简单有效，风险较高。用户应尽快升级到 WinRAR 6.23 或更高版本。

**项目地址:** [RomainBayle08/CVE-2023-38831](https://github.com/RomainBayle08/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #7

**来源**: [CVE-2023-38831-RonF98_CVE-2023-38831-POC.md](../2023/CVE-2023-38831-RonF98_CVE-2023-38831-POC.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致任意代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831 是 WinRAR 在处理 ZIP 压缩文件时存在的一个漏洞。攻击者可以构造一个包含良性文件（例如 .jpg 文件）和一个同名文件夹的 ZIP 压缩包。该文件夹中包含恶意代码（例如 .cmd 文件）。当用户尝试查看良性文件时，WinRAR 会错误地执行文件夹中的恶意代码，从而导致远程代码执行。

**有效性：**

提供的 POC 代码有效，它演示了如何创建一个恶意的 RAR 文件来利用此漏洞。

*   `DoS.cmd` 文件包含恶意代码，用于创建多个消息框，模拟拒绝服务攻击。
*   `exploit.py` 脚本用于生成包含恶意 `DoS.cmd` 文件的 RAR 文件，并利用漏洞触发代码执行。
*   `README.md` 详细解释了漏洞原理和利用方法，并提供了攻击成功的截图。

**投毒风险：**

此仓库中可能存在轻微的投毒风险，约为5%。

*   `DoS.cmd` 只是一个简单的拒绝服务攻击示例，但攻击者可能会将其替换为更具破坏性的恶意代码，例如勒索软件或信息窃取程序。如果下载者不仔细检查 `DoS.cmd` 的内容，可能会在不知情的情况下运行恶意代码。
*   `exploit.py` 脚本本身没有明显的恶意代码，但它可以被修改以生成包含不同恶意代码的 RAR 文件。下载者应该仔细审查脚本的内容，确保它不会被用于传播恶意软件。

**利用方式：**

1.  攻击者创建一个包含良性文件（例如 `image.jpg`）和一个同名文件夹（例如 `image.jpg `）的 ZIP 压缩包。注意文件夹名称后面有一个空格。
2.  在同名文件夹中，攻击者放置恶意代码（例如 `image.jpg .cmd`）。
3.  攻击者将 ZIP 文件转换为 RAR 文件（POC 脚本完成了此过程）。
4.  攻击者诱骗用户使用受影响的 WinRAR 版本打开 RAR 文件并尝试查看良性文件（`image.jpg`）。
5.  WinRAR 错误地执行同名文件夹中的恶意代码 (`image.jpg .cmd`)，从而导致远程代码执行。

由于该漏洞被广泛利用，并且网上存在大量相关的 POC 代码，因此攻击者很容易发起攻击。


**项目地址:** [RonF98/CVE-2023-38831-POC](https://github.com/RonF98/CVE-2023-38831-POC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #8

**来源**: [CVE-2023-38831-SpamixOfficial_CVE-2023-38831.md](../2023/CVE-2023-38831-SpamixOfficial_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前的版本中的代码执行漏洞。攻击者可以制作一个特制的ZIP压缩包，其中包含一个良性文件和一个同名文件夹，文件夹中包含恶意可执行文件。当用户尝试在WinRAR中查看良性文件时，实际上会执行文件夹中的恶意代码。\n\n**有效性：**根据漏洞库信息、搜索结果和漏洞利用代码，该漏洞POC是有效的。漏洞库信息中明确指出该漏洞已在野外被利用。搜索结果中多个链接都指向了关于该漏洞的分析和利用报告。提供的`Cargo.lock`文件很可能只是rust项目依赖管理文件，无法直接证明POC的有效性，需配合rust源码进行分析。\n\n**投毒风险：**分析提供的`Cargo.lock`文件，该文件列出了Rust项目`CVE-2023-38831`的依赖项。虽然`Cargo.lock`本身不包含可执行代码，但是，如果恶意作者修改了依赖项的版本或来源，理论上存在引入被篡改过的crate（Rust包）的风险。不过，由于`Cargo.lock`文件明确指定了每个依赖项的checksum，Cargo在构建项目时会验证下载的crate是否与checksum匹配，从而降低了被投毒的风险。评估投毒风险为10%。\n\n**利用方式：**攻击者创建一个包含以下结构的ZIP压缩包：\n\n1.  一个良性的文件，例如 `image.jpg`\n2.  一个与良性文件同名的文件夹，例如 `image.jpg`\n3.  在同名文件夹中，放置恶意可执行文件，例如 `image.jpg.exe` 或 `image.jpg `(通过空格进行欺骗)。\n\n当用户使用存在漏洞的WinRAR版本打开该ZIP文件并尝试查看`image.jpg`时，WinRAR会错误地执行`image.jpg`文件夹中的恶意程序，从而实现远程代码执行。

**项目地址:** [SpamixOfficial/CVE-2023-38831](https://github.com/SpamixOfficial/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #9

**来源**: [CVE-2023-38831-Tolu12wani_Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution.md](../2023/CVE-2023-38831-Tolu12wani_Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在用户尝试查看 ZIP 压缩包中的文件时执行任意代码。

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开特制的 ZIP 压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者通过构造恶意的 ZIP 压缩包实现远程代码执行。该压缩包包含一个良性文件（例如 JPG）和一个与良性文件同名的文件夹。当用户尝试访问良性文件时，WinRAR 会错误地执行同名文件夹中的内容，从而执行攻击者放置的恶意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被广泛利用。 提供的POC代码描述的是在压缩文件中嵌入恶意payload，并触发反向shell的实验环境验证过程。虽然该代码本身没有包含恶意代码，但描述了如何构建利用该漏洞的压缩文件。

**投毒风险：**
提供的 POC 代码仓库中只包含 PDF 报告和截图，并没有可执行的恶意代码。 但是,README中说明了该仓库展示了恶意payload的嵌入方式，存在一定的潜在风险。 因此，存在一定的投毒风险，但风险较低。根据readme描述和文件结构，投毒风险评估为10%，

**利用方式：**
1.  **创建恶意 ZIP 压缩包：** 攻击者创建一个 ZIP 压缩包，其中包含一个良性文件（例如 JPG）和一个与良性文件同名的文件夹。
2.  **放置恶意代码：** 将恶意可执行文件放置在与良性文件同名的文件夹中。
3.  **诱骗用户：** 诱骗用户使用受影响的 WinRAR 版本打开该 ZIP 压缩包并尝试查看良性文件。
4.  **执行恶意代码：** WinRAR 错误地执行同名文件夹中的恶意代码，从而实现远程代码执行。

根据搜索结果，该漏洞已经被政府支持的攻击者利用，用于投放 RAT（远程访问木马）等恶意软件。

**项目地址:** [Tolu12wani/Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution](https://github.com/Tolu12wani/Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #10

**来源**: [CVE-2023-38831-VictoriousKnight_CVE-2023-38831_Exploit.md](../2023/CVE-2023-38831-VictoriousKnight_CVE-2023-38831_Exploit.md)

## CVE-2023-38831-WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码。

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的恶意ZIP文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个漏洞，它允许攻击者通过构造特殊的ZIP文件来执行任意代码。攻击者创建一个ZIP文件，其中包含一个良性文件（例如，JPG图片）和一个与该良性文件同名的文件夹。该文件夹中包含恶意可执行文件。当用户尝试在WinRAR中查看该良性文件时，WinRAR会错误地执行该文件夹中的恶意代码，从而导致远程代码执行。

**有效性：** 提供的POC代码是有效的。根据漏洞库信息和搜索结果，该漏洞在野外被广泛利用。POC代码通过创建包含良性文件和同名文件夹的恶意ZIP文件，并利用WinRAR处理文件时的缺陷来执行代码。POC代码结构清晰，易于理解和使用。

**投毒风险：** 提供的POC代码本身主要是利用漏洞生成EXP，但仔细检查代码，在`exploit.py`文件的zip文件内容操作部分被截断，没有展示修改zip文件内容的关键代码，作者可能在`Read and manipulate the zip file content`部分添加恶意代码，执行修改zip文件过程中的任何恶意行为。因此存在一定的投毒风险，根据代码完整度，我给出10%的投毒风险。

**利用方式：**
1.  攻击者创建一个恶意ZIP文件，其中包含一个看似无害的文件（例如，一个图片或PDF）。
2.  在ZIP文件中，攻击者同时创建一个与该无害文件同名的文件夹。
3.  该文件夹包含攻击者想要执行的恶意代码，通常是一个可执行文件或脚本。
4.  攻击者诱使用户使用存在漏洞的WinRAR版本打开该ZIP文件。
5.  当用户尝试访问ZIP文件中的“无害”文件时，WinRAR会错误地执行同名文件夹中的恶意代码。

**项目地址:** [VictoriousKnight/CVE-2023-38831_Exploit](https://github.com/VictoriousKnight/CVE-2023-38831_Exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #11

**来源**: [CVE-2023-38831-anelya0333_Exploiting-CVE-2023-38831.md](../2023/CVE-2023-38831-anelya0333_Exploiting-CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开特制的ZIP压缩文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞允许攻击者通过特制的ZIP压缩文件在目标系统上执行任意代码。该漏洞的根源在于WinRAR在处理包含与文件同名文件夹的ZIP文件时存在缺陷。攻击者可以构造一个 ZIP 文件，其中包含一个良性文件（例如.JPG）和一个与其同名的文件夹。当用户尝试在 WinRAR 中查看该良性文件时，WinRAR 会错误地执行该文件夹中的恶意代码。此PoC脚本生成一个ZIP文件，其中包含诱饵文件(bait file)和恶意脚本(script file)，并修改ZIP文件的文件头，以利用此漏洞。脚本创建与诱饵文件同名的文件夹，并将恶意脚本放入其中。然后，将诱饵文件的副本也放入ZIP文件中。通过替换文件名字段中的某些字符，WinRAR会将文件夹中的恶意文件误认为是要执行的文件，最终导致代码执行。由于代码仅仅是构造payload，不存在主动执行恶意代码，因此不存在投毒风险。

**项目地址:** [anelya0333/Exploiting-CVE-2023-38831](https://github.com/anelya0333/Exploiting-CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #12

**来源**: [CVE-2023-38831-b1tg_CVE-2023-38831-winrar-exploit.md](../2023/CVE-2023-38831-b1tg_CVE-2023-38831-winrar-exploit.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可导致完全系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开恶意构造的ZIP文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 允许攻击者通过特制的ZIP文件在受害者系统上执行任意代码。该漏洞源于 WinRAR 处理包含同名文件和文件夹的 ZIP 档案时的不当行为。攻击者可以创建一个 ZIP 文件，其中包含一个良性文件（例如 CLASSIFIED_DOCUMENTS.pdf）和一个同名文件夹（例如 CLASSIFIED_DOCUMENTS.pdf）。当用户尝试访问良性文件时，WinRAR 实际上会执行该文件夹中的内容（例如 script.bat）。

**有效性:**

提供的 POC 代码 `cve-2023-38831-exp-gen.py` 旨在生成利用此漏洞的恶意 RAR 档案。该脚本通过以下步骤工作：

1.  创建临时目录 `TEMPLATE`。
2.  在 `TEMPLATE` 中创建一个与bait文件同名的文件夹，并在其中存放包含恶意命令的script文件（例如 `script.bat`， 其中包含`calc.exe & CLASSIFIED_DOCUMENTS.pdf`）。
3.  将bait文件存放在`TEMPLATE`目录。
4.  将`TEMPLATE`目录压缩为zip文件。
5.  修改压缩包中文件和文件夹的名字，构造漏洞。
6.  最终输出 `CVE-2023-38831-poc.rar`。

该脚本能够有效地生成利用 CVE-2023-38831 的 RAR 文件，因此提供的 POC 代码是有效的。

**投毒风险:**

对提供的 POC 代码 (`cve-2023-38831-exp-gen.py` 和 `script.bat`) 进行分析后，未发现明显的恶意代码或后门。该脚本的功能明确且集中于生成利用 CVE-2023-38831 的 RAR 档案。 `script.bat` 的主要功能是启动计算器程序 (`calc.exe`) 并尝试打开诱饵文档 (`CLASSIFIED_DOCUMENTS.pdf`)，这是一个典型的 PoC 行为。 因此，该仓库中存在作者隐藏的投毒代码的风险极低。

**利用方式:**

1.  攻击者使用 `cve-2023-38831-exp-gen.py` 脚本，指定诱饵文件（例如 `CLASSIFIED_DOCUMENTS.pdf`）和恶意脚本（例如 `script.bat`），生成恶意 RAR 档案。
2.  攻击者通过各种方式（例如，电子邮件、恶意网站）将恶意 RAR 档案分发给受害者。
3.  受害者使用易受攻击的 WinRAR 版本（< 6.23）打开恶意 RAR 档案。
4.  当受害者尝试访问诱饵文件时，WinRAR 错误地执行了同名文件夹中的恶意脚本。
5.  恶意脚本在受害者系统上执行任意代码，例如启动计算器或安装恶意软件。

**项目地址:** [b1tg/CVE-2023-38831-winrar-exploit](https://github.com/b1tg/CVE-2023-38831-winrar-exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #13

**来源**: [CVE-2023-38831-elefantesagradodeluzinfinita_cve-2023-38831.md](../2023/CVE-2023-38831-elefantesagradodeluzinfinita_cve-2023-38831.md)

## CVE-2023-38831 - WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用 WinRAR 打开特制的 ZIP 压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者通过特制的 ZIP 压缩包在受害者系统上执行任意代码。漏洞利用方式是创建一个 ZIP 压缩包，其中包含一个良性文件（例如 .jpg 或 .pdf）以及一个同名的文件夹。该文件夹包含恶意的可执行文件（例如 .cmd 或 .exe）。当用户尝试打开良性文件时，WinRAR 会错误地执行文件夹中的恶意代码。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码分析，该漏洞确实存在并且已经被野外利用。提供的代码描述了一个利用工具 "DR. GANDALF"，它允许用户创建包含此漏洞的 ZIP 文件，表明POC的有效性。

**投毒风险：** 提供的 README.md 文件主要描述了漏洞原理和利用工具的使用方法。但是，由于此工具允许用户自定义注入的代码和二进制文件，因此存在投毒风险。如果用户下载了包含恶意注入代码的ZIP文件，那么这个工具本身可能被利用来传播恶意软件。评估投毒风险为 10%，因为该描述文件本身不包含可以直接执行的后门代码，但生成的ZIP文件可以包含。

**利用方式：**
1.  攻击者创建一个包含恶意 ZIP 压缩包。
2.  ZIP 压缩包中包含一个良性文件（例如，`image.jpg`）和一个同名的文件夹（例如，`image.jpg`）。
3.  `image.jpg` 文件夹包含恶意的可执行文件（例如，`evil.cmd`）。
4.  攻击者诱骗受害者使用存在漏洞的 WinRAR 版本打开该 ZIP 压缩包并尝试访问良性文件 `image.jpg`。
5.  WinRAR 在处理该 ZIP 文件时，会错误地执行 `image.jpg` 文件夹中的恶意代码 `evil.cmd`，从而导致远程代码执行。

**项目地址:** [elefantesagradodeluzinfinita/cve-2023-38831](https://github.com/elefantesagradodeluzinfinita/cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #14

**来源**: [CVE-2023-38831-h3xecute_SideCopy-Exploits-CVE-2023-38831.md](../2023/CVE-2023-38831-h3xecute_SideCopy-Exploits-CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个远程代码执行漏洞。该漏洞的利用方式是构造一个特殊的ZIP压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹。当用户尝试使用WinRAR打开该ZIP压缩包并访问良性文件时，WinRAR会错误地执行文件夹中的恶意代码。

**有效性：**
提供的POC代码描述了漏洞利用的原理，即构造包含同名良性文件和文件夹的ZIP压缩包。根据漏洞信息和搜索结果，此方法是有效的，并且在野外被利用。

**投毒风险：**
该POC本身描述了漏洞的利用方式，包含一个指向YouTube视频的链接，以及对恶意压缩包结构的描述。投毒风险较低，约为10%，因为：
1.  POC主要以描述性文字和图片链接为主。
2.  缺乏直接可执行的payload代码。
3.  作者可能通过YouTube链接传播恶意信息。

**利用方式：**
1.  攻击者创建一个恶意的ZIP压缩包。
2.  该压缩包包含一个良性文件（例如JPG，PDF等）和一个与该文件同名的文件夹。
3.  恶意代码（例如，可执行文件）放置在同名文件夹中。
4.  攻击者诱骗用户使用WinRAR打开这个ZIP压缩包，并尝试访问良性文件。
5.  WinRAR在处理压缩包时，会错误地执行同名文件夹中的恶意代码，从而导致远程代码执行。

**项目地址:** [h3xecute/SideCopy-Exploits-CVE-2023-38831](https://github.com/h3xecute/SideCopy-Exploits-CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #15

**来源**: [CVE-2023-38831-idkwastaken_CVE-2023-38831.md](../2023/CVE-2023-38831-idkwastaken_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意的ZIP文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的漏洞。该漏洞的利用方式是创建一个特制的ZIP文件，其中包含一个良性文件和一个同名文件夹。当用户尝试使用WinRAR打开ZIP文件并访问该良性文件时，WinRAR会错误地执行该同名文件夹中的恶意代码，导致远程代码执行。

**有效性：**
提供的POC代码（exploit.c）利用了该漏洞。该代码生成一个ZIP文件，其中包含一个PDF文件（document.pdf）和一个名为“document.pdf\”的文件夹，该文件夹内包含一个恶意的批处理脚本（script.bat）。当用户在易受攻击的WinRAR版本中打开并尝试访问该PDF文件时，WinRAR将执行该批处理脚本。
checker.bat 是用来检测目标系统是否安装WinRAR，以及WinRAR的版本是否是受影响的版本。
exploit.ps1 看起来不完整，但是其作用应该是检查WinRAR版本。

**投毒风险：**
代码中存在一定的投毒风险，约为10%。原因如下：
*   **脚本内容可控：** exploit.c 中的script_content变量包含了要执行的命令，虽然当前POC仅仅是弹窗，但是攻击者可以修改这个变量，执行任意命令，例如下载恶意软件，执行系统命令等。
*   **复杂的构建过程：** exploit.c 代码本身比较复杂，阅读和分析需要一定的时间和精力。攻击者可以利用这一点，在代码中隐藏不易察觉的恶意代码。
虽然有潜在的投毒风险，但当前代码的主要目的是演示漏洞利用，风险较低，作者没有明显的隐藏后门行为，恶意代码比较容易被发现。

**利用方式：**
1.  攻击者创建一个恶意的ZIP压缩包，其中包含：
    *   一个良性的文件（例如 document.pdf）。
    *   一个与良性文件同名的文件夹（例如 document.pdf/）。
    *   恶意代码位于同名文件夹中（例如 document.pdf/script.bat）。
2.  攻击者诱骗目标用户使用存在漏洞的 WinRAR 版本打开此 ZIP 压缩包。
3.  当用户尝试打开良性文件时，WinRAR 错误地执行同名文件夹中的恶意代码，从而导致任意代码执行。


**项目地址:** [idkwastaken/CVE-2023-38831](https://github.com/idkwastaken/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #16

**来源**: [CVE-2023-38831-imbyter_imbyter-WinRAR_CVE-2023-38831.md](../2023/CVE-2023-38831-imbyter_imbyter-WinRAR_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 6.23

**利用条件:** 用户使用受影响的WinRAR版本打开特制的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于WinRAR 6.23之前的版本中。攻击者可以构造一个恶意的ZIP压缩包，其中包含一个伪装成良性文件的文件（例如 .jpg），以及一个同名的文件夹。当用户尝试在 WinRAR 中查看该“良性文件”时，实际上会执行同名文件夹中的恶意代码（例如 .cmd 或 .exe 文件）。

**有效性：**
根据漏洞信息和搜索结果，提供的POC代码是有效的。该POC利用了WinRAR处理ZIP压缩包时存在的逻辑漏洞，能够实现远程代码执行。

**投毒风险：**
提供的Python脚本 `make-poc.py` 用于生成POC压缩包，其本身的代码逻辑相对简单，主要功能是将指定的文件和脚本打包成特定的ZIP格式，并进行一些字符串替换以触发漏洞。主要风险在于脚本生成的POC包中包含的脚本，如果这个脚本是恶意的，那么整个利用过程就存在投毒风险。 仓库中的README.md文件里的测试脚本就是一个关闭计算机的脚本。代码本身存在一定的投毒风险.

*   脚本逻辑：脚本的功能是创建包含漏洞利用结构的RAR文件。
*   恶意操作：如果脚本被修改以包含下载和执行恶意软件的逻辑，那么用户在使用此脚本创建RAR文件时，就会受到投毒攻击。

**利用方式：**
1.  攻击者使用 `make-poc.py` 脚本构造恶意的ZIP压缩包，需要提供一个“良性”文件和一个恶意脚本。
2.  攻击者将恶意的ZIP压缩包发送给受害者。
3.  受害者使用受影响的WinRAR版本打开该ZIP压缩包，并尝试查看伪装的“良性”文件。
4.  WinRAR错误地执行了与“良性”文件同名的文件夹中的恶意脚本，导致远程代码执行。

**防御措施：**
*   升级WinRAR到6.23或更高版本。
*   谨慎打开来源不明的ZIP压缩包。
*   使用杀毒软件扫描ZIP压缩包。

**项目地址:** [imbyter/imbyter-WinRAR_CVE-2023-38831](https://github.com/imbyter/imbyter-WinRAR_CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #17

**来源**: [CVE-2023-38831-kehrijksen_CVE-2023-38831.md](../2023/CVE-2023-38831-kehrijksen_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 需要用户解压特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个恶意的 ZIP 压缩包，其中包含一个伪装成普通文件的文件和一个同名的文件夹。当用户尝试在 WinRAR 中查看该“普通文件”时，WinRAR 会错误地执行同名文件夹中的内容，从而导致任意代码执行。

**有效性：**
提供的 PoC 代码 `poc.py` 能够生成利用此漏洞的恶意 ZIP 压缩包。该脚本首先创建一个包含恶意 payload (例如 script.bat) 和良性文件 (例如 pepe.jpg) 的目录结构。然后，它将此目录结构压缩成 ZIP 文件，并修改 ZIP 文件中的文件名，以触发漏洞。`script.bat` 的作用是在 `%TEMP%` 目录下提取 ZIP 文件内容，运行良性文件作为诱饵，然后执行恶意操作，例如创建一个包含 “hacked” 内容的文本文件并使用记事本打开。

**投毒风险：**
分析提供的代码，没有发现明显的投毒代码。`poc.py` 的作用是生成恶意 ZIP 文件，而 `script.bat` 包含的是恶意行为的代码，例如运行良性文件，创建 `hacked.txt` 等。这些行为是漏洞利用的一部分，而不是隐藏的恶意代码。虽然利用 `script.bat` 可以执行任意操作，但这属于漏洞利用的范畴，而非代码投毒。

**利用方式：**
1.  攻击者使用 `poc.py` 脚本生成一个恶意的 ZIP 压缩包，其中包含一个良性文件（例如图片）和一个同名的文件夹。
2.  攻击者将此恶意 ZIP 压缩包发送给受害者。
3.  受害者使用 WinRAR (6.23 之前的版本) 打开并尝试查看 ZIP 压缩包中的良性文件。
4.  WinRAR 错误地执行与良性文件同名的文件夹中的内容 (由 `script.bat` 控制)。
5.  `script.bat` 首先将 ZIP 文件的内容解压到临时目录。
6.  `script.bat` 运行良性文件（例如图片）作为诱饵，以迷惑受害者。
7.  `script.bat` 执行任意恶意操作，例如创建文件，修改注册表，安装恶意软件等。


**项目地址:** [kehrijksen/CVE-2023-38831](https://github.com/kehrijksen/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #18

**来源**: [CVE-2023-38831-khanhtranngoccva_cve-2023-38831-poc.md](../2023/CVE-2023-38831-khanhtranngoccva_cve-2023-38831-poc.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。该漏洞源于WinRAR处理ZIP压缩包时，对文件名和文件夹名区分不当。攻击者可以创建一个ZIP压缩包，其中包含一个良性文件（例如JPG）和一个同名的文件夹。该文件夹中包含恶意可执行文件。当用户尝试在WinRAR中打开该良性文件时，WinRAR会错误地执行文件夹中的恶意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已在野外被利用，证明了其有效性。提供的POC代码片段（package-lock.json）显示使用了jszip库，表明该POC可能用于创建恶意的ZIP压缩包，进一步验证漏洞的可利用性。

**投毒风险：**
提供的POC代码片段是`package-lock.json`文件，主要描述了项目依赖。要判断是否存在投毒风险，需要检查实际的利用代码（例如 index.ts/index.js）。
*   这个`package-lock.json`文件本身不包含恶意代码，只是依赖声明。
*   **风险点在于开发者可能在其他代码文件中（如index.ts等，此文件未提供）包含恶意代码**。
*   jszip 库本身是一个常用的 ZIP 文件操作库，被投毒的可能性较低。
*   tsx和typescript是typescript相关工具，本身被投毒的可能性也比较低

由于缺乏实际的利用代码，无法确定是否存在投毒行为，只能根据现有信息进行推测，因此将投毒风险评估为10%。

**利用方式：**
1.  攻击者构造一个恶意的ZIP压缩包。
2.  该ZIP压缩包包含一个良性文件（例如JPG）和一个同名的文件夹。
3.  该文件夹中包含恶意可执行文件（例如EXE、BAT、CMD等）。
4.  攻击者诱骗用户使用受影响的WinRAR版本打开该ZIP压缩包。
5.  用户尝试在WinRAR中打开该良性文件。
6.  WinRAR错误地执行文件夹中的恶意代码，导致远程代码执行。

**项目地址:** [khanhtranngoccva/cve-2023-38831-poc](https://github.com/khanhtranngoccva/cve-2023-38831-poc)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #19

**来源**: [CVE-2023-38831-kuyrathdaro_winrar-cve-2023-38831.md](../2023/CVE-2023-38831-kuyrathdaro_winrar-cve-2023-38831.md)

## CVE-2023-38831-WinRAR代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个代码执行漏洞。该漏洞的利用方式如下：

1.  攻击者创建一个恶意的ZIP压缩包（伪装成RAR格式，后缀名为.rar）。
2.  该压缩包包含一个良性的文件（例如，document.pdf），以及一个与该良性文件同名的文件夹（例如，document.pdf）。
3.  同名文件夹中包含恶意payload（例如，一个.bat或.exe文件），命名为`document.pdfA.cmd`。
4.  用户使用存在漏洞的WinRAR版本打开该压缩包，并尝试打开良性文件（document.pdf）。
5.  由于WinRAR处理文件名的缺陷，实际上执行的是同名文件夹中的恶意payload。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以判断该漏洞PoC有效。搜索引擎结果中多个链接表明该漏洞已被广泛利用，并且Google的威胁分析小组也分析了利用该漏洞进行的攻击活动。提供的PoC代码实现了生成恶意RAR压缩包的逻辑，进一步验证了该漏洞的可利用性。

**投毒风险：**

PoC代码本身的主要功能是生成利用CVE-2023-38831漏洞的恶意压缩包。然而，我们仍然需要评估该代码是否存在潜在的投毒风险。以下是对代码的分析：

*   **代码功能明确：** PoC代码的功能是生成特定的文件结构和内容，以触发WinRAR漏洞。代码逻辑相对简单，易于理解。
*   **输入/输出控制：** PoC代码接受三个输入参数：良性文件、Payload文件和输出文件名。这三个参数都由用户指定，PoC本身没有主动下载或执行任何其他代码的功能。
*   **潜在风险点：** `exploit.py` 脚本使用 `shutil.copyfile` 函数来复制 payload 文件到临时目录，如果payload 文件本身就是恶意的，那么这也会造成风险。此外，尽管脚本尝试确保输出文件以 `.rar` 结尾，但恶意用户可能修改此行为。
*   **间接风险：** 如果攻击者修改了提供的 `exploit.py` 脚本，添加额外的恶意功能（例如，在生成恶意压缩包后，自动上传到恶意服务器），则可能存在投毒风险。但是，这并非原始PoC代码本身的问题。

综合来看，原始PoC代码本身存在直接投毒的风险较低，我估计的投毒风险概率为 **10%**。这主要是因为恶意 payload 本身会带来风险，但 PoC 代码并没有主动引入恶意行为。

**利用方式：**

1.  准备一个良性的文件（例如，document.pdf）和一个恶意payload（例如，script.bat或malware.exe）。
2.  运行PoC脚本，指定良性文件、payload文件和输出文件名。
3.  PoC脚本生成一个恶意的RAR压缩包（实际上是ZIP格式，但后缀名为.rar）。
4.  将该恶意RAR压缩包发送给目标用户。
5.  目标用户使用存在漏洞的WinRAR版本打开该压缩包，并尝试打开良性文件。
6.  WinRAR执行同名文件夹中的恶意payload，从而实现代码执行。


**项目地址:** [kuyrathdaro/winrar-cve-2023-38831](https://github.com/kuyrathdaro/winrar-cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #20

**来源**: [CVE-2023-38831-malvika-thakur_CVE-2023-38831.md](../2023/CVE-2023-38831-malvika-thakur_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以通过创建一个特制的 ZIP 压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹，文件夹中包含恶意可执行文件。当用户尝试在 WinRAR 中查看该良性文件时，由于 WinRAR 处理逻辑的缺陷，会错误地执行文件夹中的恶意代码，从而导致远程代码执行。

**有效性：**

提供的 POC 代码 `poc.py`  可以生成利用此漏洞的 ZIP 文件。代码首先检查恶意脚本和良性文件是否存在，然后创建一个目录，将脚本和良性文件复制到特定结构中，最后将该目录压缩成 ZIP 文件。用户只需双击压缩包内的良性文件即可触发漏洞，执行恶意脚本。因此，POC 代码有效。

**投毒风险：**

分析提供的 `poc.py` 代码，没有发现明显的投毒代码。该脚本的主要功能是生成利用 CVE-2023-38831 漏洞的恶意 ZIP 文件。它需要用户提供恶意脚本和良性文件，然后按照特定目录结构进行组织并压缩。代码中没有发现任何会执行额外恶意操作的逻辑。`README.md` 文件也仅包含漏洞描述和使用说明，没有发现恶意内容。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者创建一个包含良性文件（如 JPG 图片）和一个同名文件夹的 ZIP 压缩包。
2.  该文件夹中包含恶意可执行文件（如 BAT 脚本）。
3.  攻击者将该 ZIP 压缩包发送给目标用户。
4.  目标用户使用受影响的 WinRAR 版本打开该 ZIP 压缩包。
5.  目标用户双击 ZIP 压缩包中的良性文件。
6.  WinRAR 错误地执行同名文件夹中的恶意可执行文件，导致远程代码执行。

**项目地址:** [malvika-thakur/CVE-2023-38831](https://github.com/malvika-thakur/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #21

**来源**: [CVE-2023-38831-r1yaz_winDED.md](../2023/CVE-2023-38831-r1yaz_winDED.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开特制的恶意 ZIP 压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 是 WinRAR 在处理 ZIP 压缩文件时存在的远程代码执行漏洞。当 WinRAR 版本低于 6.23 时，如果用户尝试打开一个包含恶意构造的 ZIP 文件，攻击者可以利用此漏洞执行任意代码。该 ZIP 文件包含一个良性文件（例如 JPG 文件）和一个与其同名的文件夹。攻击者可以将可执行文件放置在该文件夹中，当用户尝试访问良性文件时，WinRAR 会错误地执行文件夹中的可执行文件。

**有效性：**
提供的 POC 代码（winDED）通过生成恶意 ZIP 文件来演示漏洞利用。它创建了一个良性文件和一个同名文件夹，并将恶意脚本放入文件夹中。用户双击压缩包中的 PDF 文件时，实际上会执行该恶意脚本，从而证明漏洞的可利用性。

**投毒风险：**
根据提供的 POC 代码，投毒风险较低。代码主要是为了演示漏洞而设计的，虽然存在执行恶意 `super_sneaky_evil_script.bat` 的可能性，但该脚本本身是由用户提供的，或者可以通过查看代码本身来确认其行为。 然而，仍然存在一些细微的风险，例如，如果 `super_sneaky_evil_script.bat` 本身是从其他来源下载的，则可能包含恶意代码。  总的来说, 投毒风险约 10%。

**利用方式：**
1.  创建一个包含良性文件 (例如，`BILLION_DOLLAR_SECRET.pdf`) 和一个同名文件夹 (`BILLION_DOLLAR_SECRET.pdf`) 的 ZIP 压缩文件。
2.  将恶意脚本 (例如，`super_sneaky_evil_script.bat`) 放入同名文件夹中。
3.  诱骗目标用户使用 WinRAR 打开该 ZIP 文件。
4.  当用户尝试打开良性文件时，WinRAR 错误地执行同名文件夹中的恶意脚本，从而实现远程代码执行。

**项目地址:** [r1yaz/winDED](https://github.com/r1yaz/winDED)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #22

**来源**: [CVE-2023-38831-ra3edAJ_LAB-DFIR-cve-2023-38831.md](../2023/CVE-2023-38831-ra3edAJ_LAB-DFIR-cve-2023-38831.md)

## CVE-2023-38831-WinRAR代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 是 WinRAR 在 6.23 版本之前存在的远程代码执行漏洞。该漏洞源于WinRAR处理ZIP压缩包时，如果压缩包中包含一个良性文件和一个与该良性文件同名的文件夹，WinRAR在尝试访问良性文件时，会错误地执行同名文件夹中的恶意内容。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的PoC是可用的。漏洞在野外被广泛利用，并且CISA已将其添加到已知被利用的漏洞目录中。

**投毒风险：**
提供的漏洞利用代码为一个Github仓库的README.md文件，主要描述了如何利用磁盘镜像调查CVE-2023-38831攻击，并通过Windows注册表、NTFS文件和浏览器缓存理解Windows事件序列。仓库本身目的是为了DFIR分析，因此直接包含恶意代码的可能性较低。但考虑到链接跳转至外部教程网站，存在间接投毒的可能，即教程内容可能包含引导至恶意软件下载或运行恶意脚本的指令。因此，投毒风险较低，评估为10%。

**利用方式：**
1.  **创建恶意的ZIP压缩包：** 压缩包中包含一个良性文件（如JPG图片）和一个与该良性文件同名的文件夹。
2.  **将恶意可执行文件放入同名文件夹：** 该文件夹中的可执行文件会在用户尝试打开良性文件时被执行。
3.  **诱导用户打开ZIP压缩包：** 通过社交工程或其他方式，诱导用户使用受影响版本的WinRAR打开该压缩包。
4.  **触发漏洞执行恶意代码：** 当用户尝试查看ZIP压缩包中的良性文件时，WinRAR会错误地执行同名文件夹中的恶意代码，从而实现远程代码执行。

**总结：**
该漏洞利用方式较为简单，易于传播，危害较大。用户应及时更新WinRAR至最新版本，避免打开来源不明的ZIP压缩包。

**项目地址:** [ra3edAJ/LAB-DFIR-cve-2023-38831](https://github.com/ra3edAJ/LAB-DFIR-cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #23

**来源**: [CVE-2023-38831-ruycr4ft_CVE-2023-38831.md](../2023/CVE-2023-38831-ruycr4ft_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的远程代码执行漏洞。该漏洞源于WinRAR在处理ZIP压缩包时，对文件名和文件夹名相同的情况处理不当。攻击者可以构造一个恶意的ZIP压缩包，其中包含一个看似无害的文件（例如.jpg），同时包含一个同名的文件夹。当用户尝试打开该“无害文件”时，WinRAR会错误地执行同名文件夹中的恶意代码。\n\n**有效性：** 根据漏洞信息、搜索结果以及提供的POC代码，该漏洞利用是有效的。多个来源都表明该漏洞已被广泛利用，POC代码也展示了如何生成包含恶意代码的RAR压缩文件。POC代码通过创建同名文件和文件夹，并在文件夹中放入恶意脚本，利用WinRAR的缺陷触发代码执行。\n\n**投毒风险：**  仓库的投毒风险较低，大概10%。
  *   `poc.py`: 该脚本的功能是生成利用 CVE-2023-38831 的恶意 RAR 文件。虽然它允许用户指定 bait 文件和脚本文件，但脚本本身不包含任何预设的、隐藏的恶意行为。
  *   `script.bat`:  这个批处理文件包含使用 `nc.exe` (netcat) 反弹 shell 的命令。**这里存在一定的投毒风险。** 批处理文件明确地使用了`192.168.0.107`这个IP地址,如果用户直接使用该IP反弹shell,将会连接到攻击者的服务器。虽然IP地址可以被用户更改，但在默认情况下，如果用户不修改，将会连接到攻击者的IP。这是主要的投毒点。
  *   README.md: 该文件仅包含漏洞的简单介绍和演示图片。没有发现恶意代码。

**利用方式：**\n1.  攻击者创建一个恶意的ZIP压缩包。该压缩包包含一个诱饵文件（例如图片.jpg）和一个与其同名的文件夹（例如图片.jpg）。\n2.  攻击者将恶意代码（例如一个批处理脚本或可执行文件）放入同名文件夹中。\n3.  攻击者将包含恶意代码的ZIP压缩包发送给受害者。\n4.  受害者使用存在漏洞的WinRAR版本打开该ZIP压缩包，并尝试打开诱饵文件。\n5.  WinRAR错误地执行同名文件夹中的恶意代码，导致远程代码执行。

**项目地址:** [ruycr4ft/CVE-2023-38831](https://github.com/ruycr4ft/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #24

**来源**: [CVE-2023-38831-s4m98_winrar-cve-2023-38831-poc-gen.md](../2023/CVE-2023-38831-s4m98_winrar-cve-2023-38831-poc-gen.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开恶意的ZIP/RAR压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于WinRAR处理ZIP压缩文件时，由于对文件名和文件夹名处理不当导致。攻击者可以构造一个包含恶意脚本的ZIP压缩文件，该压缩文件包含一个正常的诱饵文件（如PDF、PNG或JPG）和一个同名的文件夹，当用户尝试打开诱饵文件时，WinRAR会错误地执行该文件夹中的恶意脚本。

**有效性：**
根据漏洞信息、搜索引擎结果和漏洞利用代码，该POC代码有效。漏洞库信息表明该漏洞已被野外利用。搜索引擎结果中也包含了大量关于此漏洞的分析和利用报告，证实了该漏洞的有效性。POC代码的描述和实现也符合漏洞的利用方式，通过生成包含恶意脚本和诱饵文件的RAR压缩包来触发漏洞。

**投毒风险：**
代码本身看起来比较直接，主要是生成利用漏洞的压缩包。`script.bat` 这个文件需要额外注意。当前提供的 `script.bat` 只是打开了计算器 `calc.exe` 和 Web_Security.pdf,相对来说是安全的，但用户在使用该漏洞时，完全可以修改此文件，添加更加恶意的payload，具有一定的风险。作者在代码中没有明显投毒行为，主要风险在于用户如何使用该工具生成payload。
投毒风险评估：10% (主要是用户修改 `script.bat` 的风险)

**利用方式：**
1.  **构造恶意ZIP/RAR压缩文件：** 利用提供的Python脚本（cve-2023-38831-exp-gen.py）生成恶意的ZIP/RAR压缩文件。此脚本需要一个诱饵文件（如PDF、PNG、JPG）和一个恶意脚本文件（如BAT、CMD、或可执行文件）。该脚本会创建一个包含诱饵文件和一个同名文件夹的压缩包，并将恶意脚本放置在该文件夹中。
2.  **诱骗用户打开压缩文件：**  将生成的恶意ZIP/RAR压缩文件发送给目标用户。
3.  **执行恶意代码：** 当用户使用受影响的WinRAR版本打开压缩文件并尝试查看诱饵文件时，WinRAR会错误地执行同名文件夹中的恶意脚本，从而实现远程代码执行。

 总体来说，该漏洞利用方式较为简单，攻击成本较低，风险较高。

**项目地址:** [s4m98/winrar-cve-2023-38831-poc-gen](https://github.com/s4m98/winrar-cve-2023-38831-poc-gen)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #25

**来源**: [CVE-2023-38831-solomon12354_VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC.md](../2023/CVE-2023-38831-solomon12354_VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要解压恶意的ZIP/RAR压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 存在于 WinRAR 6.23 之前版本中。攻击者可以构造一个包含良性文件和同名文件夹的 ZIP 压缩包，当用户尝试访问良性文件时，WinRAR 会错误地执行同名文件夹中的恶意代码。提供的 `exploit.py` 脚本可以用于生成包含漏洞利用的RAR压缩文件。脚本首先要求输入良性文件（`bait_file`）、恶意脚本文件（`script_file`）和输出RAR文件名称。然后，它创建一个临时目录，将恶意脚本复制到与良性文件同名的目录中，并将良性文件复制到临时目录中。最后，使用 `shutil.make_archive` 函数将临时目录压缩成 ZIP 文件，并修改 ZIP 文件的内容，将目录名中的 'A' 和 'B' 替换为空格，从而绕过 WinRAR 的安全检查。最终，将修改后的 ZIP 文件重命名为 RAR 文件。

`squid.bat` 用于下载并执行 `volleysquid.exe`。`volleyballsquid.py` 尝试利用 BypassUAC 来提升权限并将程序设置为开机自启。

**有效性:** 根据漏洞信息和利用代码分析，提供的 POC 代码有效，可以利用此漏洞在受害者机器上执行任意代码。

**投毒风险:** 仓库中存在一定的投毒风险，虽然主要功能是利用CVE-2023-38831漏洞，但是 `volleyballsquid.py`和`squid.bat`文件中的行为具有恶意性，特别是`volleyballsquid.py`中尝试使用`BypassUAC`绕过用户账户控制并持久化安装，这可能被用于安装后门或恶意软件。虽然主要目的是展示漏洞，但客观上存在后门功能，因此投毒风险占比为10%。

**利用方式:** 攻击者首先利用 `exploit.py` 脚本生成包含恶意代码的RAR压缩文件。然后，诱骗用户下载并使用 WinRAR 解压此文件。当用户尝试打开压缩包中的“良性”文件时，实际上会执行隐藏在同名目录中的恶意脚本 (例如 `squid.bat`)，下载并执行恶意程序。

根据搜索结果，CVE-2023-38831 漏洞已被广泛利用，并且已被政府背景的攻击者使用，这进一步验证了漏洞的严重性和 POC 代码的有效性。

**项目地址:** [solomon12354/VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC](https://github.com/solomon12354/VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #26

**来源**: [CVE-2023-38831-technicalcorp0_CVE-2023-38831-Exploit.md](../2023/CVE-2023-38831-technicalcorp0_CVE-2023-38831-Exploit.md)

## CVE-2023-38831-WinRAR-任意代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 任意代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个漏洞，该漏洞允许攻击者通过特制的ZIP档案执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** 当WinRAR尝试访问ZIP归档中的良性文件时，如果存在与该良性文件同名的文件夹，WinRAR会处理该文件夹的内容（可能包含可执行内容）。
2.  **利用方式：**
    *   攻击者创建一个恶意的ZIP档案，该档案包含一个良性文件（例如.JPG文件）和一个与该良性文件同名的文件夹。
    *   该文件夹包含恶意可执行文件。
    *   当受害者尝试在WinRAR中查看良性文件时，WinRAR会执行该文件夹中的恶意代码。
3.  **POC有效性：** 提供的POC代码 (CVE-2023-38831-WinRar-Exploit.py) 的目的是生成包含利用此漏洞的恶意 ZIP 文件。根据代码逻辑和漏洞原理，该 POC 可以有效利用该漏洞。
4.  **投毒风险：** 经过对POC代码的分析，发现代码本身实现了漏洞利用过程，但同时也存在一定的投毒风险。`clean_up()`函数会删除临时文件，但不能保证完全清除所有痕迹。攻击者可能通过修改代码，在生成恶意 ZIP 文件后，在目标系统上留下后门或执行其他恶意操作。考虑到实际利用场景中可能存在的恶意修改，投毒风险估计为5%。 主要风险点在于，虽然POC主要目的是生成exploit，但如果恶意人员修改，完全可以添加其他恶意payload，并伪装成CVE-2023-38831的POC进行传播。
5. **搜索引擎结果:** 搜索引擎结果表明此漏洞已被广泛利用，包括政府背景的黑客组织。 多个安全厂商发布了相关的分析和防御措施。

**项目地址:** [technicalcorp0/CVE-2023-38831-Exploit](https://github.com/technicalcorp0/CVE-2023-38831-Exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #27

**来源**: [CVE-2023-38831-xk-mt_WinRAR-Vulnerability-recurrence-tutorial.md](../2023/CVE-2023-38831-xk-mt_WinRAR-Vulnerability-recurrence-tutorial.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。该漏洞允许攻击者通过构造恶意的ZIP压缩包，在用户尝试查看压缩包内的文件时执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，该漏洞已被广泛利用，POC代码的存在也表明其有效性。多个安全厂商和研究人员都对此漏洞进行了分析并提供了相应的缓解措施。

**投毒风险分析：**
提供的POC代码包含以下文件：
*   `README.md`: 漏洞复现教程，包含漏洞信息和参考链接。
*   `执行命令.bat`: 一个简单的批处理文件，用于执行`calc.exe`（计算器程序），用于演示代码执行。
*   `文本.txt`: 包含一个URL地址。
*   `生成压缩包.py`: 一个Python脚本，用于生成包含漏洞的ZIP压缩包。

该脚本的主要功能是：
1.  创建临时目录，并将`执行命令.bat`复制到该目录。
2.  复制`文本.txt`文件到另一个目录。
3.  将上述两个目录打包成ZIP文件。
4.  修改ZIP文件中的文件名，利用漏洞的原理。
从代码本身来看，该脚本并没有明显的恶意代码，但是存在一定的投毒风险。
*   执行命令.bat： 虽然只是简单的calc.exe，但如果攻击者替换成其他恶意命令，则可能造成更大的危害。
*   脚本的依赖： 该脚本依赖Python环境，攻击者可能会通过修改脚本，引入恶意的Python依赖包，从而实现投毒。

综合来看，该仓库中存在一定的投毒风险，但不高。主要是因为演示的`执行命令.bat`内容比较简单，容易被识别。如果使用者直接运行此仓库的代码，有可能会被植入恶意程序。因此，投毒风险评定为10%。

**利用方式：**
1.  攻击者构造一个恶意的ZIP压缩包，该压缩包包含一个良性文件（例如，图片文件`文本.txt`）和一个与该文件同名的文件夹。
2.  该文件夹包含一个恶意可执行文件（例如，`执行命令.bat`并更名为`文本.txtA.cmd`）。
3.  当用户使用受影响的WinRAR版本打开该ZIP压缩包，并尝试查看良性文件时，WinRAR会错误地执行该文件夹中的恶意可执行文件，从而导致任意代码执行。

**项目地址:** [xk-mt/WinRAR-Vulnerability-recurrence-tutorial](https://github.com/xk-mt/WinRAR-Vulnerability-recurrence-tutorial)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #28

**来源**: [CVE-2023-38831-yezzfusl_cve_2023_38831_scanner.md](../2023/CVE-2023-38831-yezzfusl_cve_2023_38831_scanner.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开恶意的 ZIP 压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以通过构造一个特殊的 ZIP 压缩文件来利用此漏洞。该 ZIP 文件包含一个良性文件（例如 JPG）和一个同名的文件夹。当用户尝试访问良性文件时，WinRAR 会错误地执行文件夹中的恶意代码，导致远程代码执行。

**利用方式：**
1.  攻击者创建一个包含良性文件和同名文件夹的恶意 ZIP 文件。
2.  文件夹中包含要执行的恶意代码（例如，可执行文件）。
3.  攻击者诱使用户使用 WinRAR 打开该 ZIP 文件。
4.  当用户尝试访问良性文件时，WinRAR 会执行文件夹中的恶意代码。

**有效性：**
根据漏洞描述和搜索结果，该漏洞已在野外被利用，因此提供的PoC代码如果能够重现该行为，则可以认为是有效的。

**投毒风险：**
提供的代码仓库 `cve_2023_38831_scanner` 本身是一个漏洞扫描器，而非漏洞利用的PoC。尽管如此，仍然存在一定的投毒风险。代码中可能隐藏后门，虽然其主要功能是扫描，但理论上存在被篡改的风险。代码中使用了网络数据包分析、进程内存扫描、沙箱环境执行等模块，这些模块如果被恶意修改，可能被用于执行恶意操作。因此，综合考虑其扫描器的性质和潜在风险，投毒风险估计为10%。这个风险主要来自供应链投毒，如果下载了被篡改过的扫描器，那么扫描器本身可能成为攻击的一部分。

**项目地址:** [yezzfusl/cve_2023_38831_scanner](https://github.com/yezzfusl/cve_2023_38831_scanner)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #29

**来源**: [CVE-2023-38831-youmulijiang_evil-winrar.md](../2023/CVE-2023-38831-youmulijiang_evil-winrar.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 50%

## 详情

CVE-2023-38831是WinRAR在6.23版本之前存在的一个远程代码执行漏洞。该漏洞的利用方式是构造一个特殊的ZIP压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹。当用户尝试在WinRAR中查看该良性文件时，WinRAR会错误地执行该文件夹中的恶意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认该漏洞是有效的，并且已经在野外被利用。漏洞利用代码提供了一个框架，用于生成包含恶意payload的ZIP压缩包，从而实现远程代码执行。

**投毒风险分析：**
提供的代码是一个框架，用于生成漏洞利用的 ZIP 文件，包含生成 exp，邮件发送，下载链接生成等功能。代码中存在潜在的投毒风险，主要体现在以下几个方面：

1.  **Payload 植入:**  该框架可以自定义payload，如果用户在不了解 payload 内容的情况下使用，可能运行恶意指令。
2.  **代码可信度:** 虽然作者声明为安全开发成员，并开源了代码，但代码的安全性仍然需要进一步审计。存在作者预留后门的可能性。 考虑到这是一个漏洞利用框架，其本质就是为了执行恶意代码，所以判定为投毒代码的风险为50%。

**漏洞利用方式：**

1.  攻击者使用该漏洞利用框架(evil-winrar)生成一个恶意的 ZIP 压缩包。
2.  该 ZIP 压缩包包含一个良性文件（如JPG图片）和一个同名的文件夹，文件夹中包含恶意可执行文件。
3.  攻击者通过社会工程学等方式诱骗用户使用存在漏洞的 WinRAR 版本打开该 ZIP 压缩包。
4.  用户尝试查看良性文件时，WinRAR 会错误地执行同名文件夹中的恶意代码。
5.  恶意代码在用户系统上执行，攻击者从而实现远程代码执行，控制受害者的计算机。

**项目地址:** [youmulijiang/evil-winrar](https://github.com/youmulijiang/evil-winrar)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---



---

## POC #3

**来源**: [CVE-2023-38831-MaorBuskila_Windows-X64-RAT.md](../2023/CVE-2023-38831-MaorBuskila_Windows-X64-RAT.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者在用户尝试查看 ZIP 压缩包中的良性文件时执行任意代码。该漏洞源于 WinRAR 处理 ZIP 压缩包时，允许压缩包包含一个良性文件（例如 .JPG）和一个同名文件夹。当用户尝试访问该良性文件时，WinRAR 实际上会处理同名文件夹中的内容，从而允许攻击者在文件夹中放置恶意可执行文件并执行。

**有效性：**
从搜索结果和漏洞库信息来看，该漏洞已经被广泛利用，PoC 代码的存在也进一步验证了其有效性。

**投毒风险：**
提供的 Python 脚本 (`51721.py`) 用于生成 Windows x64 平台的反向 TCP Shellcode。该脚本本身不包含明显的恶意代码，功能是生成 shellcode。需要用户自行配置 IP 地址和端口。但是，由于该代码需要用户执行，并且可以生成任意 shellcode，存在一定投毒风险，例如，如果攻击者提供修改后的脚本，生成包含恶意功能的 shellcode (如删除文件，上传用户信息)，则用户可能无意中执行该恶意 shellcode. 脚本本身不包含网络连接或者其他与远程服务器通信的行为，可以基本判断代码仓库投毒风险较低.

**利用方式：**
1.  攻击者创建一个恶意的 ZIP 压缩包。
2.  该 ZIP 压缩包包含一个良性文件（例如 image.jpg）和一个同名文件夹（image.jpg）。
3.  同名文件夹包含恶意可执行文件，例如 exploit.exe，并可能包含一个 `.lnk` 文件，该快捷方式指向该恶意可执行文件。
4.  攻击者诱骗用户使用受影响版本的 WinRAR 打开该 ZIP 压缩包并尝试查看良性文件。
5.  WinRAR 错误地执行同名文件夹中的恶意可执行文件，从而导致远程代码执行。

**项目地址:** [MaorBuskila/Windows-X64-RAT](https://github.com/MaorBuskila/Windows-X64-RAT)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #4

**来源**: [CVE-2023-38831-MyStuffYT_CVE-2023-38831-POC.md](../2023/CVE-2023-38831-MyStuffYT_CVE-2023-38831-POC.md)

## CVE-2023-38831-WinRAR-远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的恶意ZIP压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个恶意的ZIP压缩文件，其中包含一个良性文件（例如.jpg）和一个同名的文件夹。当用户尝试在 WinRAR 中查看该良性文件时，WinRAR 会错误地执行该文件夹中的内容，从而导致任意代码执行。

**有效性：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。搜索引擎结果表明该漏洞已被广泛利用，POC代码的存在进一步证实了其有效性。

**投毒风险：**

根据对POC代码的分析，存在一定的投毒风险。`script.bat`脚本从github下载`Alert.exe`文件，这本身就存在一定的安全隐患，无法确保下载的文件一定是安全的。此外，脚本同时执行 `alert.exe` 和 `gtaleak.mp4`，而 `gtaleak.mp4` 在 README 中说明是 “zeros without ones”, 可以确定这是一个障眼法，实际的恶意行为是由 `alert.exe` 执行。 因此，作者可能隐藏了投毒代码。

**利用方式：**

1.  攻击者创建一个恶意的ZIP压缩文件，其中包含一个良性文件 (例如 `gtaleak.mp4`) 和一个同名的文件夹。
2.  该文件夹包含一个批处理脚本 (`script.bat`)，该脚本将从远程服务器下载并执行恶意程序 (`Alert.exe`)。
3.  当用户尝试使用 WinRAR 打开压缩文件并查看良性文件 (`gtaleak.mp4`) 时，WinRAR 会错误地执行批处理脚本。
4.  批处理脚本下载并执行恶意程序，从而允许攻击者在受害者的系统上执行任意代码。

**项目地址:** [MyStuffYT/CVE-2023-38831-POC](https://github.com/MyStuffYT/CVE-2023-38831-POC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #5

**来源**: [CVE-2023-38831-Nielk74_CVE-2023-38831.md](../2023/CVE-2023-38831-Nielk74_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本的代码执行漏洞。该漏洞允许攻击者在用户尝试查看ZIP存档中的看似无害的文件时执行任意代码。攻击者通过构造一个包含同名文件和文件夹的恶意ZIP文件，利用WinRAR处理文件路径时的逻辑缺陷，使得文件夹中的恶意可执行文件得以运行。提供的POC代码通过Vagrant自动化部署了一个易受攻击的WinRAR 6.22环境，并向虚拟机桌面添加了一个恶意的rar文件。该rar文件被设计为当用户点击其中的“无害”文件时，执行预先设定的恶意代码。尽管POC的主要目的是演示漏洞，但其中`ChocolateyInstall.ps1`脚本从外部源下载并安装软件包（Chocolatey和WinRAR），存在被篡改从而引入恶意代码的风险，这构成了潜在的投毒风险。虽然这个脚本很常见，但还是存在一定的风险，因此这里给出了10%的投毒风险。

**漏洞利用方式：**

1.  攻击者创建一个恶意的ZIP压缩包，其中包含一个看似无害的文件（例如.jpg），以及一个与该文件同名的文件夹。
2.  该文件夹包含恶意可执行文件，例如.exe或.cmd脚本。
3.  当用户尝试使用WinRAR打开ZIP压缩包并查看“无害”文件时，WinRAR会错误地执行同名文件夹中的恶意可执行文件，从而导致任意代码执行。
4.  攻击者可以利用此漏洞在受害者系统上安装恶意软件、窃取敏感数据或执行其他恶意操作。

**项目地址:** [Nielk74/CVE-2023-38831](https://github.com/Nielk74/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #6

**来源**: [CVE-2023-38831-RomainBayle08_CVE-2023-38831.md](../2023/CVE-2023-38831-RomainBayle08_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP或RAR压缩文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个特殊的 ZIP 压缩文件，该文件包含一个看似无害的文件（例如，.JPG 文件）和一个与该文件同名的文件夹。当用户尝试查看压缩文件中的无害文件时，WinRAR 会错误地执行文件夹中的内容，从而导致任意代码执行。

**有效性分析：**
提供的 POC 代码 `cve-2023-38831-exp-gen.py` 是一个漏洞利用生成器脚本，它接受诱饵文件 (`BAIT_NAME`)、脚本文件 (`SCRIPT_NAME`) 和额外的诱饵文件目录 (`BAIT_FILES`) 作为输入，并生成一个恶意 RAR 压缩文件 (`OUTPUT_NAME`)。脚本首先创建一个包含诱饵文件和脚本文件的临时目录结构，然后使用 `shutil.make_archive` 函数将该目录压缩为 ZIP 文件。关键在于，脚本会替换 ZIP 文件中特定文件的扩展名，利用 WinRAR 的漏洞，在用户尝试打开诱饵文件时执行脚本文件。`script.bat` 脚本会首先尝试打开诱饵文件（模拟用户行为），然后执行 `calc.exe`（作为漏洞利用成功的标志）。该 POC 的有效性较高，因为它模拟了真实的攻击场景。

**投毒风险分析：**
`cve-2023-38831-exp-gen.py` 脚本本身不包含明显的恶意代码或后门。但是，存在一定的投毒风险，因为该脚本允许攻击者指定要执行的任意脚本 (`SCRIPT_NAME`)。攻击者可以替换 `script.bat` 文件为包含恶意代码的文件，例如下载和执行其他恶意软件。此外，该脚本使用了`BAIT_FILES`参数，如果提供包含恶意文件的目录，也会构成投毒风险。所以存在一定投毒风险，但主要取决于用户提供的脚本和目录的内容。

**利用方式分析：**
1.  攻击者构造一个恶意 ZIP 压缩文件，其中包含一个诱饵文件（如 `CLASSIFIED_DOCUMENTS.pdf`）和一个与诱饵文件同名的文件夹。文件夹中包含一个脚本文件（如 `script.bat`）。
2.  攻击者将恶意 ZIP 文件发送给受害者，诱骗其使用 WinRAR 打开。
3.  当受害者尝试查看 ZIP 文件中的诱饵文件时，WinRAR 会错误地执行同名文件夹中的脚本文件。
4.  脚本文件执行任意代码，例如安装恶意软件或窃取敏感信息。

总的来说，该漏洞利用方式简单有效，风险较高。用户应尽快升级到 WinRAR 6.23 或更高版本。

**项目地址:** [RomainBayle08/CVE-2023-38831](https://github.com/RomainBayle08/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #7

**来源**: [CVE-2023-38831-RonF98_CVE-2023-38831-POC.md](../2023/CVE-2023-38831-RonF98_CVE-2023-38831-POC.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致任意代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831 是 WinRAR 在处理 ZIP 压缩文件时存在的一个漏洞。攻击者可以构造一个包含良性文件（例如 .jpg 文件）和一个同名文件夹的 ZIP 压缩包。该文件夹中包含恶意代码（例如 .cmd 文件）。当用户尝试查看良性文件时，WinRAR 会错误地执行文件夹中的恶意代码，从而导致远程代码执行。

**有效性：**

提供的 POC 代码有效，它演示了如何创建一个恶意的 RAR 文件来利用此漏洞。

*   `DoS.cmd` 文件包含恶意代码，用于创建多个消息框，模拟拒绝服务攻击。
*   `exploit.py` 脚本用于生成包含恶意 `DoS.cmd` 文件的 RAR 文件，并利用漏洞触发代码执行。
*   `README.md` 详细解释了漏洞原理和利用方法，并提供了攻击成功的截图。

**投毒风险：**

此仓库中可能存在轻微的投毒风险，约为5%。

*   `DoS.cmd` 只是一个简单的拒绝服务攻击示例，但攻击者可能会将其替换为更具破坏性的恶意代码，例如勒索软件或信息窃取程序。如果下载者不仔细检查 `DoS.cmd` 的内容，可能会在不知情的情况下运行恶意代码。
*   `exploit.py` 脚本本身没有明显的恶意代码，但它可以被修改以生成包含不同恶意代码的 RAR 文件。下载者应该仔细审查脚本的内容，确保它不会被用于传播恶意软件。

**利用方式：**

1.  攻击者创建一个包含良性文件（例如 `image.jpg`）和一个同名文件夹（例如 `image.jpg `）的 ZIP 压缩包。注意文件夹名称后面有一个空格。
2.  在同名文件夹中，攻击者放置恶意代码（例如 `image.jpg .cmd`）。
3.  攻击者将 ZIP 文件转换为 RAR 文件（POC 脚本完成了此过程）。
4.  攻击者诱骗用户使用受影响的 WinRAR 版本打开 RAR 文件并尝试查看良性文件（`image.jpg`）。
5.  WinRAR 错误地执行同名文件夹中的恶意代码 (`image.jpg .cmd`)，从而导致远程代码执行。

由于该漏洞被广泛利用，并且网上存在大量相关的 POC 代码，因此攻击者很容易发起攻击。


**项目地址:** [RonF98/CVE-2023-38831-POC](https://github.com/RonF98/CVE-2023-38831-POC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #8

**来源**: [CVE-2023-38831-SpamixOfficial_CVE-2023-38831.md](../2023/CVE-2023-38831-SpamixOfficial_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前的版本中的代码执行漏洞。攻击者可以制作一个特制的ZIP压缩包，其中包含一个良性文件和一个同名文件夹，文件夹中包含恶意可执行文件。当用户尝试在WinRAR中查看良性文件时，实际上会执行文件夹中的恶意代码。\n\n**有效性：**根据漏洞库信息、搜索结果和漏洞利用代码，该漏洞POC是有效的。漏洞库信息中明确指出该漏洞已在野外被利用。搜索结果中多个链接都指向了关于该漏洞的分析和利用报告。提供的`Cargo.lock`文件很可能只是rust项目依赖管理文件，无法直接证明POC的有效性，需配合rust源码进行分析。\n\n**投毒风险：**分析提供的`Cargo.lock`文件，该文件列出了Rust项目`CVE-2023-38831`的依赖项。虽然`Cargo.lock`本身不包含可执行代码，但是，如果恶意作者修改了依赖项的版本或来源，理论上存在引入被篡改过的crate（Rust包）的风险。不过，由于`Cargo.lock`文件明确指定了每个依赖项的checksum，Cargo在构建项目时会验证下载的crate是否与checksum匹配，从而降低了被投毒的风险。评估投毒风险为10%。\n\n**利用方式：**攻击者创建一个包含以下结构的ZIP压缩包：\n\n1.  一个良性的文件，例如 `image.jpg`\n2.  一个与良性文件同名的文件夹，例如 `image.jpg`\n3.  在同名文件夹中，放置恶意可执行文件，例如 `image.jpg.exe` 或 `image.jpg `(通过空格进行欺骗)。\n\n当用户使用存在漏洞的WinRAR版本打开该ZIP文件并尝试查看`image.jpg`时，WinRAR会错误地执行`image.jpg`文件夹中的恶意程序，从而实现远程代码执行。

**项目地址:** [SpamixOfficial/CVE-2023-38831](https://github.com/SpamixOfficial/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #9

**来源**: [CVE-2023-38831-Tolu12wani_Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution.md](../2023/CVE-2023-38831-Tolu12wani_Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在用户尝试查看 ZIP 压缩包中的文件时执行任意代码。

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开特制的 ZIP 压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者通过构造恶意的 ZIP 压缩包实现远程代码执行。该压缩包包含一个良性文件（例如 JPG）和一个与良性文件同名的文件夹。当用户尝试访问良性文件时，WinRAR 会错误地执行同名文件夹中的内容，从而执行攻击者放置的恶意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被广泛利用。 提供的POC代码描述的是在压缩文件中嵌入恶意payload，并触发反向shell的实验环境验证过程。虽然该代码本身没有包含恶意代码，但描述了如何构建利用该漏洞的压缩文件。

**投毒风险：**
提供的 POC 代码仓库中只包含 PDF 报告和截图，并没有可执行的恶意代码。 但是,README中说明了该仓库展示了恶意payload的嵌入方式，存在一定的潜在风险。 因此，存在一定的投毒风险，但风险较低。根据readme描述和文件结构，投毒风险评估为10%，

**利用方式：**
1.  **创建恶意 ZIP 压缩包：** 攻击者创建一个 ZIP 压缩包，其中包含一个良性文件（例如 JPG）和一个与良性文件同名的文件夹。
2.  **放置恶意代码：** 将恶意可执行文件放置在与良性文件同名的文件夹中。
3.  **诱骗用户：** 诱骗用户使用受影响的 WinRAR 版本打开该 ZIP 压缩包并尝试查看良性文件。
4.  **执行恶意代码：** WinRAR 错误地执行同名文件夹中的恶意代码，从而实现远程代码执行。

根据搜索结果，该漏洞已经被政府支持的攻击者利用，用于投放 RAT（远程访问木马）等恶意软件。

**项目地址:** [Tolu12wani/Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution](https://github.com/Tolu12wani/Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #10

**来源**: [CVE-2023-38831-VictoriousKnight_CVE-2023-38831_Exploit.md](../2023/CVE-2023-38831-VictoriousKnight_CVE-2023-38831_Exploit.md)

## CVE-2023-38831-WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码。

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的恶意ZIP文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个漏洞，它允许攻击者通过构造特殊的ZIP文件来执行任意代码。攻击者创建一个ZIP文件，其中包含一个良性文件（例如，JPG图片）和一个与该良性文件同名的文件夹。该文件夹中包含恶意可执行文件。当用户尝试在WinRAR中查看该良性文件时，WinRAR会错误地执行该文件夹中的恶意代码，从而导致远程代码执行。

**有效性：** 提供的POC代码是有效的。根据漏洞库信息和搜索结果，该漏洞在野外被广泛利用。POC代码通过创建包含良性文件和同名文件夹的恶意ZIP文件，并利用WinRAR处理文件时的缺陷来执行代码。POC代码结构清晰，易于理解和使用。

**投毒风险：** 提供的POC代码本身主要是利用漏洞生成EXP，但仔细检查代码，在`exploit.py`文件的zip文件内容操作部分被截断，没有展示修改zip文件内容的关键代码，作者可能在`Read and manipulate the zip file content`部分添加恶意代码，执行修改zip文件过程中的任何恶意行为。因此存在一定的投毒风险，根据代码完整度，我给出10%的投毒风险。

**利用方式：**
1.  攻击者创建一个恶意ZIP文件，其中包含一个看似无害的文件（例如，一个图片或PDF）。
2.  在ZIP文件中，攻击者同时创建一个与该无害文件同名的文件夹。
3.  该文件夹包含攻击者想要执行的恶意代码，通常是一个可执行文件或脚本。
4.  攻击者诱使用户使用存在漏洞的WinRAR版本打开该ZIP文件。
5.  当用户尝试访问ZIP文件中的“无害”文件时，WinRAR会错误地执行同名文件夹中的恶意代码。

**项目地址:** [VictoriousKnight/CVE-2023-38831_Exploit](https://github.com/VictoriousKnight/CVE-2023-38831_Exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #11

**来源**: [CVE-2023-38831-anelya0333_Exploiting-CVE-2023-38831.md](../2023/CVE-2023-38831-anelya0333_Exploiting-CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开特制的ZIP压缩文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞允许攻击者通过特制的ZIP压缩文件在目标系统上执行任意代码。该漏洞的根源在于WinRAR在处理包含与文件同名文件夹的ZIP文件时存在缺陷。攻击者可以构造一个 ZIP 文件，其中包含一个良性文件（例如.JPG）和一个与其同名的文件夹。当用户尝试在 WinRAR 中查看该良性文件时，WinRAR 会错误地执行该文件夹中的恶意代码。此PoC脚本生成一个ZIP文件，其中包含诱饵文件(bait file)和恶意脚本(script file)，并修改ZIP文件的文件头，以利用此漏洞。脚本创建与诱饵文件同名的文件夹，并将恶意脚本放入其中。然后，将诱饵文件的副本也放入ZIP文件中。通过替换文件名字段中的某些字符，WinRAR会将文件夹中的恶意文件误认为是要执行的文件，最终导致代码执行。由于代码仅仅是构造payload，不存在主动执行恶意代码，因此不存在投毒风险。

**项目地址:** [anelya0333/Exploiting-CVE-2023-38831](https://github.com/anelya0333/Exploiting-CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #12

**来源**: [CVE-2023-38831-b1tg_CVE-2023-38831-winrar-exploit.md](../2023/CVE-2023-38831-b1tg_CVE-2023-38831-winrar-exploit.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可导致完全系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开恶意构造的ZIP文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 允许攻击者通过特制的ZIP文件在受害者系统上执行任意代码。该漏洞源于 WinRAR 处理包含同名文件和文件夹的 ZIP 档案时的不当行为。攻击者可以创建一个 ZIP 文件，其中包含一个良性文件（例如 CLASSIFIED_DOCUMENTS.pdf）和一个同名文件夹（例如 CLASSIFIED_DOCUMENTS.pdf）。当用户尝试访问良性文件时，WinRAR 实际上会执行该文件夹中的内容（例如 script.bat）。

**有效性:**

提供的 POC 代码 `cve-2023-38831-exp-gen.py` 旨在生成利用此漏洞的恶意 RAR 档案。该脚本通过以下步骤工作：

1.  创建临时目录 `TEMPLATE`。
2.  在 `TEMPLATE` 中创建一个与bait文件同名的文件夹，并在其中存放包含恶意命令的script文件（例如 `script.bat`， 其中包含`calc.exe & CLASSIFIED_DOCUMENTS.pdf`）。
3.  将bait文件存放在`TEMPLATE`目录。
4.  将`TEMPLATE`目录压缩为zip文件。
5.  修改压缩包中文件和文件夹的名字，构造漏洞。
6.  最终输出 `CVE-2023-38831-poc.rar`。

该脚本能够有效地生成利用 CVE-2023-38831 的 RAR 文件，因此提供的 POC 代码是有效的。

**投毒风险:**

对提供的 POC 代码 (`cve-2023-38831-exp-gen.py` 和 `script.bat`) 进行分析后，未发现明显的恶意代码或后门。该脚本的功能明确且集中于生成利用 CVE-2023-38831 的 RAR 档案。 `script.bat` 的主要功能是启动计算器程序 (`calc.exe`) 并尝试打开诱饵文档 (`CLASSIFIED_DOCUMENTS.pdf`)，这是一个典型的 PoC 行为。 因此，该仓库中存在作者隐藏的投毒代码的风险极低。

**利用方式:**

1.  攻击者使用 `cve-2023-38831-exp-gen.py` 脚本，指定诱饵文件（例如 `CLASSIFIED_DOCUMENTS.pdf`）和恶意脚本（例如 `script.bat`），生成恶意 RAR 档案。
2.  攻击者通过各种方式（例如，电子邮件、恶意网站）将恶意 RAR 档案分发给受害者。
3.  受害者使用易受攻击的 WinRAR 版本（< 6.23）打开恶意 RAR 档案。
4.  当受害者尝试访问诱饵文件时，WinRAR 错误地执行了同名文件夹中的恶意脚本。
5.  恶意脚本在受害者系统上执行任意代码，例如启动计算器或安装恶意软件。

**项目地址:** [b1tg/CVE-2023-38831-winrar-exploit](https://github.com/b1tg/CVE-2023-38831-winrar-exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #13

**来源**: [CVE-2023-38831-elefantesagradodeluzinfinita_cve-2023-38831.md](../2023/CVE-2023-38831-elefantesagradodeluzinfinita_cve-2023-38831.md)

## CVE-2023-38831 - WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用 WinRAR 打开特制的 ZIP 压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者通过特制的 ZIP 压缩包在受害者系统上执行任意代码。漏洞利用方式是创建一个 ZIP 压缩包，其中包含一个良性文件（例如 .jpg 或 .pdf）以及一个同名的文件夹。该文件夹包含恶意的可执行文件（例如 .cmd 或 .exe）。当用户尝试打开良性文件时，WinRAR 会错误地执行文件夹中的恶意代码。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码分析，该漏洞确实存在并且已经被野外利用。提供的代码描述了一个利用工具 "DR. GANDALF"，它允许用户创建包含此漏洞的 ZIP 文件，表明POC的有效性。

**投毒风险：** 提供的 README.md 文件主要描述了漏洞原理和利用工具的使用方法。但是，由于此工具允许用户自定义注入的代码和二进制文件，因此存在投毒风险。如果用户下载了包含恶意注入代码的ZIP文件，那么这个工具本身可能被利用来传播恶意软件。评估投毒风险为 10%，因为该描述文件本身不包含可以直接执行的后门代码，但生成的ZIP文件可以包含。

**利用方式：**
1.  攻击者创建一个包含恶意 ZIP 压缩包。
2.  ZIP 压缩包中包含一个良性文件（例如，`image.jpg`）和一个同名的文件夹（例如，`image.jpg`）。
3.  `image.jpg` 文件夹包含恶意的可执行文件（例如，`evil.cmd`）。
4.  攻击者诱骗受害者使用存在漏洞的 WinRAR 版本打开该 ZIP 压缩包并尝试访问良性文件 `image.jpg`。
5.  WinRAR 在处理该 ZIP 文件时，会错误地执行 `image.jpg` 文件夹中的恶意代码 `evil.cmd`，从而导致远程代码执行。

**项目地址:** [elefantesagradodeluzinfinita/cve-2023-38831](https://github.com/elefantesagradodeluzinfinita/cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #14

**来源**: [CVE-2023-38831-h3xecute_SideCopy-Exploits-CVE-2023-38831.md](../2023/CVE-2023-38831-h3xecute_SideCopy-Exploits-CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个远程代码执行漏洞。该漏洞的利用方式是构造一个特殊的ZIP压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹。当用户尝试使用WinRAR打开该ZIP压缩包并访问良性文件时，WinRAR会错误地执行文件夹中的恶意代码。

**有效性：**
提供的POC代码描述了漏洞利用的原理，即构造包含同名良性文件和文件夹的ZIP压缩包。根据漏洞信息和搜索结果，此方法是有效的，并且在野外被利用。

**投毒风险：**
该POC本身描述了漏洞的利用方式，包含一个指向YouTube视频的链接，以及对恶意压缩包结构的描述。投毒风险较低，约为10%，因为：
1.  POC主要以描述性文字和图片链接为主。
2.  缺乏直接可执行的payload代码。
3.  作者可能通过YouTube链接传播恶意信息。

**利用方式：**
1.  攻击者创建一个恶意的ZIP压缩包。
2.  该压缩包包含一个良性文件（例如JPG，PDF等）和一个与该文件同名的文件夹。
3.  恶意代码（例如，可执行文件）放置在同名文件夹中。
4.  攻击者诱骗用户使用WinRAR打开这个ZIP压缩包，并尝试访问良性文件。
5.  WinRAR在处理压缩包时，会错误地执行同名文件夹中的恶意代码，从而导致远程代码执行。

**项目地址:** [h3xecute/SideCopy-Exploits-CVE-2023-38831](https://github.com/h3xecute/SideCopy-Exploits-CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #15

**来源**: [CVE-2023-38831-idkwastaken_CVE-2023-38831.md](../2023/CVE-2023-38831-idkwastaken_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意的ZIP文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的漏洞。该漏洞的利用方式是创建一个特制的ZIP文件，其中包含一个良性文件和一个同名文件夹。当用户尝试使用WinRAR打开ZIP文件并访问该良性文件时，WinRAR会错误地执行该同名文件夹中的恶意代码，导致远程代码执行。

**有效性：**
提供的POC代码（exploit.c）利用了该漏洞。该代码生成一个ZIP文件，其中包含一个PDF文件（document.pdf）和一个名为“document.pdf\”的文件夹，该文件夹内包含一个恶意的批处理脚本（script.bat）。当用户在易受攻击的WinRAR版本中打开并尝试访问该PDF文件时，WinRAR将执行该批处理脚本。
checker.bat 是用来检测目标系统是否安装WinRAR，以及WinRAR的版本是否是受影响的版本。
exploit.ps1 看起来不完整，但是其作用应该是检查WinRAR版本。

**投毒风险：**
代码中存在一定的投毒风险，约为10%。原因如下：
*   **脚本内容可控：** exploit.c 中的script_content变量包含了要执行的命令，虽然当前POC仅仅是弹窗，但是攻击者可以修改这个变量，执行任意命令，例如下载恶意软件，执行系统命令等。
*   **复杂的构建过程：** exploit.c 代码本身比较复杂，阅读和分析需要一定的时间和精力。攻击者可以利用这一点，在代码中隐藏不易察觉的恶意代码。
虽然有潜在的投毒风险，但当前代码的主要目的是演示漏洞利用，风险较低，作者没有明显的隐藏后门行为，恶意代码比较容易被发现。

**利用方式：**
1.  攻击者创建一个恶意的ZIP压缩包，其中包含：
    *   一个良性的文件（例如 document.pdf）。
    *   一个与良性文件同名的文件夹（例如 document.pdf/）。
    *   恶意代码位于同名文件夹中（例如 document.pdf/script.bat）。
2.  攻击者诱骗目标用户使用存在漏洞的 WinRAR 版本打开此 ZIP 压缩包。
3.  当用户尝试打开良性文件时，WinRAR 错误地执行同名文件夹中的恶意代码，从而导致任意代码执行。


**项目地址:** [idkwastaken/CVE-2023-38831](https://github.com/idkwastaken/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #16

**来源**: [CVE-2023-38831-imbyter_imbyter-WinRAR_CVE-2023-38831.md](../2023/CVE-2023-38831-imbyter_imbyter-WinRAR_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 6.23

**利用条件:** 用户使用受影响的WinRAR版本打开特制的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于WinRAR 6.23之前的版本中。攻击者可以构造一个恶意的ZIP压缩包，其中包含一个伪装成良性文件的文件（例如 .jpg），以及一个同名的文件夹。当用户尝试在 WinRAR 中查看该“良性文件”时，实际上会执行同名文件夹中的恶意代码（例如 .cmd 或 .exe 文件）。

**有效性：**
根据漏洞信息和搜索结果，提供的POC代码是有效的。该POC利用了WinRAR处理ZIP压缩包时存在的逻辑漏洞，能够实现远程代码执行。

**投毒风险：**
提供的Python脚本 `make-poc.py` 用于生成POC压缩包，其本身的代码逻辑相对简单，主要功能是将指定的文件和脚本打包成特定的ZIP格式，并进行一些字符串替换以触发漏洞。主要风险在于脚本生成的POC包中包含的脚本，如果这个脚本是恶意的，那么整个利用过程就存在投毒风险。 仓库中的README.md文件里的测试脚本就是一个关闭计算机的脚本。代码本身存在一定的投毒风险.

*   脚本逻辑：脚本的功能是创建包含漏洞利用结构的RAR文件。
*   恶意操作：如果脚本被修改以包含下载和执行恶意软件的逻辑，那么用户在使用此脚本创建RAR文件时，就会受到投毒攻击。

**利用方式：**
1.  攻击者使用 `make-poc.py` 脚本构造恶意的ZIP压缩包，需要提供一个“良性”文件和一个恶意脚本。
2.  攻击者将恶意的ZIP压缩包发送给受害者。
3.  受害者使用受影响的WinRAR版本打开该ZIP压缩包，并尝试查看伪装的“良性”文件。
4.  WinRAR错误地执行了与“良性”文件同名的文件夹中的恶意脚本，导致远程代码执行。

**防御措施：**
*   升级WinRAR到6.23或更高版本。
*   谨慎打开来源不明的ZIP压缩包。
*   使用杀毒软件扫描ZIP压缩包。

**项目地址:** [imbyter/imbyter-WinRAR_CVE-2023-38831](https://github.com/imbyter/imbyter-WinRAR_CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #17

**来源**: [CVE-2023-38831-kehrijksen_CVE-2023-38831.md](../2023/CVE-2023-38831-kehrijksen_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 需要用户解压特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个恶意的 ZIP 压缩包，其中包含一个伪装成普通文件的文件和一个同名的文件夹。当用户尝试在 WinRAR 中查看该“普通文件”时，WinRAR 会错误地执行同名文件夹中的内容，从而导致任意代码执行。

**有效性：**
提供的 PoC 代码 `poc.py` 能够生成利用此漏洞的恶意 ZIP 压缩包。该脚本首先创建一个包含恶意 payload (例如 script.bat) 和良性文件 (例如 pepe.jpg) 的目录结构。然后，它将此目录结构压缩成 ZIP 文件，并修改 ZIP 文件中的文件名，以触发漏洞。`script.bat` 的作用是在 `%TEMP%` 目录下提取 ZIP 文件内容，运行良性文件作为诱饵，然后执行恶意操作，例如创建一个包含 “hacked” 内容的文本文件并使用记事本打开。

**投毒风险：**
分析提供的代码，没有发现明显的投毒代码。`poc.py` 的作用是生成恶意 ZIP 文件，而 `script.bat` 包含的是恶意行为的代码，例如运行良性文件，创建 `hacked.txt` 等。这些行为是漏洞利用的一部分，而不是隐藏的恶意代码。虽然利用 `script.bat` 可以执行任意操作，但这属于漏洞利用的范畴，而非代码投毒。

**利用方式：**
1.  攻击者使用 `poc.py` 脚本生成一个恶意的 ZIP 压缩包，其中包含一个良性文件（例如图片）和一个同名的文件夹。
2.  攻击者将此恶意 ZIP 压缩包发送给受害者。
3.  受害者使用 WinRAR (6.23 之前的版本) 打开并尝试查看 ZIP 压缩包中的良性文件。
4.  WinRAR 错误地执行与良性文件同名的文件夹中的内容 (由 `script.bat` 控制)。
5.  `script.bat` 首先将 ZIP 文件的内容解压到临时目录。
6.  `script.bat` 运行良性文件（例如图片）作为诱饵，以迷惑受害者。
7.  `script.bat` 执行任意恶意操作，例如创建文件，修改注册表，安装恶意软件等。


**项目地址:** [kehrijksen/CVE-2023-38831](https://github.com/kehrijksen/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #18

**来源**: [CVE-2023-38831-khanhtranngoccva_cve-2023-38831-poc.md](../2023/CVE-2023-38831-khanhtranngoccva_cve-2023-38831-poc.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。该漏洞源于WinRAR处理ZIP压缩包时，对文件名和文件夹名区分不当。攻击者可以创建一个ZIP压缩包，其中包含一个良性文件（例如JPG）和一个同名的文件夹。该文件夹中包含恶意可执行文件。当用户尝试在WinRAR中打开该良性文件时，WinRAR会错误地执行文件夹中的恶意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已在野外被利用，证明了其有效性。提供的POC代码片段（package-lock.json）显示使用了jszip库，表明该POC可能用于创建恶意的ZIP压缩包，进一步验证漏洞的可利用性。

**投毒风险：**
提供的POC代码片段是`package-lock.json`文件，主要描述了项目依赖。要判断是否存在投毒风险，需要检查实际的利用代码（例如 index.ts/index.js）。
*   这个`package-lock.json`文件本身不包含恶意代码，只是依赖声明。
*   **风险点在于开发者可能在其他代码文件中（如index.ts等，此文件未提供）包含恶意代码**。
*   jszip 库本身是一个常用的 ZIP 文件操作库，被投毒的可能性较低。
*   tsx和typescript是typescript相关工具，本身被投毒的可能性也比较低

由于缺乏实际的利用代码，无法确定是否存在投毒行为，只能根据现有信息进行推测，因此将投毒风险评估为10%。

**利用方式：**
1.  攻击者构造一个恶意的ZIP压缩包。
2.  该ZIP压缩包包含一个良性文件（例如JPG）和一个同名的文件夹。
3.  该文件夹中包含恶意可执行文件（例如EXE、BAT、CMD等）。
4.  攻击者诱骗用户使用受影响的WinRAR版本打开该ZIP压缩包。
5.  用户尝试在WinRAR中打开该良性文件。
6.  WinRAR错误地执行文件夹中的恶意代码，导致远程代码执行。

**项目地址:** [khanhtranngoccva/cve-2023-38831-poc](https://github.com/khanhtranngoccva/cve-2023-38831-poc)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #19

**来源**: [CVE-2023-38831-kuyrathdaro_winrar-cve-2023-38831.md](../2023/CVE-2023-38831-kuyrathdaro_winrar-cve-2023-38831.md)

## CVE-2023-38831-WinRAR代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个代码执行漏洞。该漏洞的利用方式如下：

1.  攻击者创建一个恶意的ZIP压缩包（伪装成RAR格式，后缀名为.rar）。
2.  该压缩包包含一个良性的文件（例如，document.pdf），以及一个与该良性文件同名的文件夹（例如，document.pdf）。
3.  同名文件夹中包含恶意payload（例如，一个.bat或.exe文件），命名为`document.pdfA.cmd`。
4.  用户使用存在漏洞的WinRAR版本打开该压缩包，并尝试打开良性文件（document.pdf）。
5.  由于WinRAR处理文件名的缺陷，实际上执行的是同名文件夹中的恶意payload。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以判断该漏洞PoC有效。搜索引擎结果中多个链接表明该漏洞已被广泛利用，并且Google的威胁分析小组也分析了利用该漏洞进行的攻击活动。提供的PoC代码实现了生成恶意RAR压缩包的逻辑，进一步验证了该漏洞的可利用性。

**投毒风险：**

PoC代码本身的主要功能是生成利用CVE-2023-38831漏洞的恶意压缩包。然而，我们仍然需要评估该代码是否存在潜在的投毒风险。以下是对代码的分析：

*   **代码功能明确：** PoC代码的功能是生成特定的文件结构和内容，以触发WinRAR漏洞。代码逻辑相对简单，易于理解。
*   **输入/输出控制：** PoC代码接受三个输入参数：良性文件、Payload文件和输出文件名。这三个参数都由用户指定，PoC本身没有主动下载或执行任何其他代码的功能。
*   **潜在风险点：** `exploit.py` 脚本使用 `shutil.copyfile` 函数来复制 payload 文件到临时目录，如果payload 文件本身就是恶意的，那么这也会造成风险。此外，尽管脚本尝试确保输出文件以 `.rar` 结尾，但恶意用户可能修改此行为。
*   **间接风险：** 如果攻击者修改了提供的 `exploit.py` 脚本，添加额外的恶意功能（例如，在生成恶意压缩包后，自动上传到恶意服务器），则可能存在投毒风险。但是，这并非原始PoC代码本身的问题。

综合来看，原始PoC代码本身存在直接投毒的风险较低，我估计的投毒风险概率为 **10%**。这主要是因为恶意 payload 本身会带来风险，但 PoC 代码并没有主动引入恶意行为。

**利用方式：**

1.  准备一个良性的文件（例如，document.pdf）和一个恶意payload（例如，script.bat或malware.exe）。
2.  运行PoC脚本，指定良性文件、payload文件和输出文件名。
3.  PoC脚本生成一个恶意的RAR压缩包（实际上是ZIP格式，但后缀名为.rar）。
4.  将该恶意RAR压缩包发送给目标用户。
5.  目标用户使用存在漏洞的WinRAR版本打开该压缩包，并尝试打开良性文件。
6.  WinRAR执行同名文件夹中的恶意payload，从而实现代码执行。


**项目地址:** [kuyrathdaro/winrar-cve-2023-38831](https://github.com/kuyrathdaro/winrar-cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #20

**来源**: [CVE-2023-38831-malvika-thakur_CVE-2023-38831.md](../2023/CVE-2023-38831-malvika-thakur_CVE-2023-38831.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以通过创建一个特制的 ZIP 压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹，文件夹中包含恶意可执行文件。当用户尝试在 WinRAR 中查看该良性文件时，由于 WinRAR 处理逻辑的缺陷，会错误地执行文件夹中的恶意代码，从而导致远程代码执行。

**有效性：**

提供的 POC 代码 `poc.py`  可以生成利用此漏洞的 ZIP 文件。代码首先检查恶意脚本和良性文件是否存在，然后创建一个目录，将脚本和良性文件复制到特定结构中，最后将该目录压缩成 ZIP 文件。用户只需双击压缩包内的良性文件即可触发漏洞，执行恶意脚本。因此，POC 代码有效。

**投毒风险：**

分析提供的 `poc.py` 代码，没有发现明显的投毒代码。该脚本的主要功能是生成利用 CVE-2023-38831 漏洞的恶意 ZIP 文件。它需要用户提供恶意脚本和良性文件，然后按照特定目录结构进行组织并压缩。代码中没有发现任何会执行额外恶意操作的逻辑。`README.md` 文件也仅包含漏洞描述和使用说明，没有发现恶意内容。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者创建一个包含良性文件（如 JPG 图片）和一个同名文件夹的 ZIP 压缩包。
2.  该文件夹中包含恶意可执行文件（如 BAT 脚本）。
3.  攻击者将该 ZIP 压缩包发送给目标用户。
4.  目标用户使用受影响的 WinRAR 版本打开该 ZIP 压缩包。
5.  目标用户双击 ZIP 压缩包中的良性文件。
6.  WinRAR 错误地执行同名文件夹中的恶意可执行文件，导致远程代码执行。

**项目地址:** [malvika-thakur/CVE-2023-38831](https://github.com/malvika-thakur/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #21

**来源**: [CVE-2023-38831-r1yaz_winDED.md](../2023/CVE-2023-38831-r1yaz_winDED.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开特制的恶意 ZIP 压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 是 WinRAR 在处理 ZIP 压缩文件时存在的远程代码执行漏洞。当 WinRAR 版本低于 6.23 时，如果用户尝试打开一个包含恶意构造的 ZIP 文件，攻击者可以利用此漏洞执行任意代码。该 ZIP 文件包含一个良性文件（例如 JPG 文件）和一个与其同名的文件夹。攻击者可以将可执行文件放置在该文件夹中，当用户尝试访问良性文件时，WinRAR 会错误地执行文件夹中的可执行文件。

**有效性：**
提供的 POC 代码（winDED）通过生成恶意 ZIP 文件来演示漏洞利用。它创建了一个良性文件和一个同名文件夹，并将恶意脚本放入文件夹中。用户双击压缩包中的 PDF 文件时，实际上会执行该恶意脚本，从而证明漏洞的可利用性。

**投毒风险：**
根据提供的 POC 代码，投毒风险较低。代码主要是为了演示漏洞而设计的，虽然存在执行恶意 `super_sneaky_evil_script.bat` 的可能性，但该脚本本身是由用户提供的，或者可以通过查看代码本身来确认其行为。 然而，仍然存在一些细微的风险，例如，如果 `super_sneaky_evil_script.bat` 本身是从其他来源下载的，则可能包含恶意代码。  总的来说, 投毒风险约 10%。

**利用方式：**
1.  创建一个包含良性文件 (例如，`BILLION_DOLLAR_SECRET.pdf`) 和一个同名文件夹 (`BILLION_DOLLAR_SECRET.pdf`) 的 ZIP 压缩文件。
2.  将恶意脚本 (例如，`super_sneaky_evil_script.bat`) 放入同名文件夹中。
3.  诱骗目标用户使用 WinRAR 打开该 ZIP 文件。
4.  当用户尝试打开良性文件时，WinRAR 错误地执行同名文件夹中的恶意脚本，从而实现远程代码执行。

**项目地址:** [r1yaz/winDED](https://github.com/r1yaz/winDED)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #22

**来源**: [CVE-2023-38831-ra3edAJ_LAB-DFIR-cve-2023-38831.md](../2023/CVE-2023-38831-ra3edAJ_LAB-DFIR-cve-2023-38831.md)

## CVE-2023-38831-WinRAR代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 是 WinRAR 在 6.23 版本之前存在的远程代码执行漏洞。该漏洞源于WinRAR处理ZIP压缩包时，如果压缩包中包含一个良性文件和一个与该良性文件同名的文件夹，WinRAR在尝试访问良性文件时，会错误地执行同名文件夹中的恶意内容。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的PoC是可用的。漏洞在野外被广泛利用，并且CISA已将其添加到已知被利用的漏洞目录中。

**投毒风险：**
提供的漏洞利用代码为一个Github仓库的README.md文件，主要描述了如何利用磁盘镜像调查CVE-2023-38831攻击，并通过Windows注册表、NTFS文件和浏览器缓存理解Windows事件序列。仓库本身目的是为了DFIR分析，因此直接包含恶意代码的可能性较低。但考虑到链接跳转至外部教程网站，存在间接投毒的可能，即教程内容可能包含引导至恶意软件下载或运行恶意脚本的指令。因此，投毒风险较低，评估为10%。

**利用方式：**
1.  **创建恶意的ZIP压缩包：** 压缩包中包含一个良性文件（如JPG图片）和一个与该良性文件同名的文件夹。
2.  **将恶意可执行文件放入同名文件夹：** 该文件夹中的可执行文件会在用户尝试打开良性文件时被执行。
3.  **诱导用户打开ZIP压缩包：** 通过社交工程或其他方式，诱导用户使用受影响版本的WinRAR打开该压缩包。
4.  **触发漏洞执行恶意代码：** 当用户尝试查看ZIP压缩包中的良性文件时，WinRAR会错误地执行同名文件夹中的恶意代码，从而实现远程代码执行。

**总结：**
该漏洞利用方式较为简单，易于传播，危害较大。用户应及时更新WinRAR至最新版本，避免打开来源不明的ZIP压缩包。

**项目地址:** [ra3edAJ/LAB-DFIR-cve-2023-38831](https://github.com/ra3edAJ/LAB-DFIR-cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #23

**来源**: [CVE-2023-38831-ruycr4ft_CVE-2023-38831.md](../2023/CVE-2023-38831-ruycr4ft_CVE-2023-38831.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的远程代码执行漏洞。该漏洞源于WinRAR在处理ZIP压缩包时，对文件名和文件夹名相同的情况处理不当。攻击者可以构造一个恶意的ZIP压缩包，其中包含一个看似无害的文件（例如.jpg），同时包含一个同名的文件夹。当用户尝试打开该“无害文件”时，WinRAR会错误地执行同名文件夹中的恶意代码。\n\n**有效性：** 根据漏洞信息、搜索结果以及提供的POC代码，该漏洞利用是有效的。多个来源都表明该漏洞已被广泛利用，POC代码也展示了如何生成包含恶意代码的RAR压缩文件。POC代码通过创建同名文件和文件夹，并在文件夹中放入恶意脚本，利用WinRAR的缺陷触发代码执行。\n\n**投毒风险：**  仓库的投毒风险较低，大概10%。
  *   `poc.py`: 该脚本的功能是生成利用 CVE-2023-38831 的恶意 RAR 文件。虽然它允许用户指定 bait 文件和脚本文件，但脚本本身不包含任何预设的、隐藏的恶意行为。
  *   `script.bat`:  这个批处理文件包含使用 `nc.exe` (netcat) 反弹 shell 的命令。**这里存在一定的投毒风险。** 批处理文件明确地使用了`192.168.0.107`这个IP地址,如果用户直接使用该IP反弹shell,将会连接到攻击者的服务器。虽然IP地址可以被用户更改，但在默认情况下，如果用户不修改，将会连接到攻击者的IP。这是主要的投毒点。
  *   README.md: 该文件仅包含漏洞的简单介绍和演示图片。没有发现恶意代码。

**利用方式：**\n1.  攻击者创建一个恶意的ZIP压缩包。该压缩包包含一个诱饵文件（例如图片.jpg）和一个与其同名的文件夹（例如图片.jpg）。\n2.  攻击者将恶意代码（例如一个批处理脚本或可执行文件）放入同名文件夹中。\n3.  攻击者将包含恶意代码的ZIP压缩包发送给受害者。\n4.  受害者使用存在漏洞的WinRAR版本打开该ZIP压缩包，并尝试打开诱饵文件。\n5.  WinRAR错误地执行同名文件夹中的恶意代码，导致远程代码执行。

**项目地址:** [ruycr4ft/CVE-2023-38831](https://github.com/ruycr4ft/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #24

**来源**: [CVE-2023-38831-s4m98_winrar-cve-2023-38831-poc-gen.md](../2023/CVE-2023-38831-s4m98_winrar-cve-2023-38831-poc-gen.md)

## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开恶意的ZIP/RAR压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于WinRAR处理ZIP压缩文件时，由于对文件名和文件夹名处理不当导致。攻击者可以构造一个包含恶意脚本的ZIP压缩文件，该压缩文件包含一个正常的诱饵文件（如PDF、PNG或JPG）和一个同名的文件夹，当用户尝试打开诱饵文件时，WinRAR会错误地执行该文件夹中的恶意脚本。

**有效性：**
根据漏洞信息、搜索引擎结果和漏洞利用代码，该POC代码有效。漏洞库信息表明该漏洞已被野外利用。搜索引擎结果中也包含了大量关于此漏洞的分析和利用报告，证实了该漏洞的有效性。POC代码的描述和实现也符合漏洞的利用方式，通过生成包含恶意脚本和诱饵文件的RAR压缩包来触发漏洞。

**投毒风险：**
代码本身看起来比较直接，主要是生成利用漏洞的压缩包。`script.bat` 这个文件需要额外注意。当前提供的 `script.bat` 只是打开了计算器 `calc.exe` 和 Web_Security.pdf,相对来说是安全的，但用户在使用该漏洞时，完全可以修改此文件，添加更加恶意的payload，具有一定的风险。作者在代码中没有明显投毒行为，主要风险在于用户如何使用该工具生成payload。
投毒风险评估：10% (主要是用户修改 `script.bat` 的风险)

**利用方式：**
1.  **构造恶意ZIP/RAR压缩文件：** 利用提供的Python脚本（cve-2023-38831-exp-gen.py）生成恶意的ZIP/RAR压缩文件。此脚本需要一个诱饵文件（如PDF、PNG、JPG）和一个恶意脚本文件（如BAT、CMD、或可执行文件）。该脚本会创建一个包含诱饵文件和一个同名文件夹的压缩包，并将恶意脚本放置在该文件夹中。
2.  **诱骗用户打开压缩文件：**  将生成的恶意ZIP/RAR压缩文件发送给目标用户。
3.  **执行恶意代码：** 当用户使用受影响的WinRAR版本打开压缩文件并尝试查看诱饵文件时，WinRAR会错误地执行同名文件夹中的恶意脚本，从而实现远程代码执行。

 总体来说，该漏洞利用方式较为简单，攻击成本较低，风险较高。

**项目地址:** [s4m98/winrar-cve-2023-38831-poc-gen](https://github.com/s4m98/winrar-cve-2023-38831-poc-gen)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #25

**来源**: [CVE-2023-38831-solomon12354_VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC.md](../2023/CVE-2023-38831-solomon12354_VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要解压恶意的ZIP/RAR压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 存在于 WinRAR 6.23 之前版本中。攻击者可以构造一个包含良性文件和同名文件夹的 ZIP 压缩包，当用户尝试访问良性文件时，WinRAR 会错误地执行同名文件夹中的恶意代码。提供的 `exploit.py` 脚本可以用于生成包含漏洞利用的RAR压缩文件。脚本首先要求输入良性文件（`bait_file`）、恶意脚本文件（`script_file`）和输出RAR文件名称。然后，它创建一个临时目录，将恶意脚本复制到与良性文件同名的目录中，并将良性文件复制到临时目录中。最后，使用 `shutil.make_archive` 函数将临时目录压缩成 ZIP 文件，并修改 ZIP 文件的内容，将目录名中的 'A' 和 'B' 替换为空格，从而绕过 WinRAR 的安全检查。最终，将修改后的 ZIP 文件重命名为 RAR 文件。

`squid.bat` 用于下载并执行 `volleysquid.exe`。`volleyballsquid.py` 尝试利用 BypassUAC 来提升权限并将程序设置为开机自启。

**有效性:** 根据漏洞信息和利用代码分析，提供的 POC 代码有效，可以利用此漏洞在受害者机器上执行任意代码。

**投毒风险:** 仓库中存在一定的投毒风险，虽然主要功能是利用CVE-2023-38831漏洞，但是 `volleyballsquid.py`和`squid.bat`文件中的行为具有恶意性，特别是`volleyballsquid.py`中尝试使用`BypassUAC`绕过用户账户控制并持久化安装，这可能被用于安装后门或恶意软件。虽然主要目的是展示漏洞，但客观上存在后门功能，因此投毒风险占比为10%。

**利用方式:** 攻击者首先利用 `exploit.py` 脚本生成包含恶意代码的RAR压缩文件。然后，诱骗用户下载并使用 WinRAR 解压此文件。当用户尝试打开压缩包中的“良性”文件时，实际上会执行隐藏在同名目录中的恶意脚本 (例如 `squid.bat`)，下载并执行恶意程序。

根据搜索结果，CVE-2023-38831 漏洞已被广泛利用，并且已被政府背景的攻击者使用，这进一步验证了漏洞的严重性和 POC 代码的有效性。

**项目地址:** [solomon12354/VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC](https://github.com/solomon12354/VolleyballSquid-----CVE-2023-38831-and-Bypass-UAC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #26

**来源**: [CVE-2023-38831-technicalcorp0_CVE-2023-38831-Exploit.md](../2023/CVE-2023-38831-technicalcorp0_CVE-2023-38831-Exploit.md)

## CVE-2023-38831-WinRAR-任意代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 任意代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个漏洞，该漏洞允许攻击者通过特制的ZIP档案执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** 当WinRAR尝试访问ZIP归档中的良性文件时，如果存在与该良性文件同名的文件夹，WinRAR会处理该文件夹的内容（可能包含可执行内容）。
2.  **利用方式：**
    *   攻击者创建一个恶意的ZIP档案，该档案包含一个良性文件（例如.JPG文件）和一个与该良性文件同名的文件夹。
    *   该文件夹包含恶意可执行文件。
    *   当受害者尝试在WinRAR中查看良性文件时，WinRAR会执行该文件夹中的恶意代码。
3.  **POC有效性：** 提供的POC代码 (CVE-2023-38831-WinRar-Exploit.py) 的目的是生成包含利用此漏洞的恶意 ZIP 文件。根据代码逻辑和漏洞原理，该 POC 可以有效利用该漏洞。
4.  **投毒风险：** 经过对POC代码的分析，发现代码本身实现了漏洞利用过程，但同时也存在一定的投毒风险。`clean_up()`函数会删除临时文件，但不能保证完全清除所有痕迹。攻击者可能通过修改代码，在生成恶意 ZIP 文件后，在目标系统上留下后门或执行其他恶意操作。考虑到实际利用场景中可能存在的恶意修改，投毒风险估计为5%。 主要风险点在于，虽然POC主要目的是生成exploit，但如果恶意人员修改，完全可以添加其他恶意payload，并伪装成CVE-2023-38831的POC进行传播。
5. **搜索引擎结果:** 搜索引擎结果表明此漏洞已被广泛利用，包括政府背景的黑客组织。 多个安全厂商发布了相关的分析和防御措施。

**项目地址:** [technicalcorp0/CVE-2023-38831-Exploit](https://github.com/technicalcorp0/CVE-2023-38831-Exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #27

**来源**: [CVE-2023-38831-xk-mt_WinRAR-Vulnerability-recurrence-tutorial.md](../2023/CVE-2023-38831-xk-mt_WinRAR-Vulnerability-recurrence-tutorial.md)

## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。该漏洞允许攻击者通过构造恶意的ZIP压缩包，在用户尝试查看压缩包内的文件时执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，该漏洞已被广泛利用，POC代码的存在也表明其有效性。多个安全厂商和研究人员都对此漏洞进行了分析并提供了相应的缓解措施。

**投毒风险分析：**
提供的POC代码包含以下文件：
*   `README.md`: 漏洞复现教程，包含漏洞信息和参考链接。
*   `执行命令.bat`: 一个简单的批处理文件，用于执行`calc.exe`（计算器程序），用于演示代码执行。
*   `文本.txt`: 包含一个URL地址。
*   `生成压缩包.py`: 一个Python脚本，用于生成包含漏洞的ZIP压缩包。

该脚本的主要功能是：
1.  创建临时目录，并将`执行命令.bat`复制到该目录。
2.  复制`文本.txt`文件到另一个目录。
3.  将上述两个目录打包成ZIP文件。
4.  修改ZIP文件中的文件名，利用漏洞的原理。
从代码本身来看，该脚本并没有明显的恶意代码，但是存在一定的投毒风险。
*   执行命令.bat： 虽然只是简单的calc.exe，但如果攻击者替换成其他恶意命令，则可能造成更大的危害。
*   脚本的依赖： 该脚本依赖Python环境，攻击者可能会通过修改脚本，引入恶意的Python依赖包，从而实现投毒。

综合来看，该仓库中存在一定的投毒风险，但不高。主要是因为演示的`执行命令.bat`内容比较简单，容易被识别。如果使用者直接运行此仓库的代码，有可能会被植入恶意程序。因此，投毒风险评定为10%。

**利用方式：**
1.  攻击者构造一个恶意的ZIP压缩包，该压缩包包含一个良性文件（例如，图片文件`文本.txt`）和一个与该文件同名的文件夹。
2.  该文件夹包含一个恶意可执行文件（例如，`执行命令.bat`并更名为`文本.txtA.cmd`）。
3.  当用户使用受影响的WinRAR版本打开该ZIP压缩包，并尝试查看良性文件时，WinRAR会错误地执行该文件夹中的恶意可执行文件，从而导致任意代码执行。

**项目地址:** [xk-mt/WinRAR-Vulnerability-recurrence-tutorial](https://github.com/xk-mt/WinRAR-Vulnerability-recurrence-tutorial)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #28

**来源**: [CVE-2023-38831-yezzfusl_cve_2023_38831_scanner.md](../2023/CVE-2023-38831-yezzfusl_cve_2023_38831_scanner.md)

## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开恶意的 ZIP 压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以通过构造一个特殊的 ZIP 压缩文件来利用此漏洞。该 ZIP 文件包含一个良性文件（例如 JPG）和一个同名的文件夹。当用户尝试访问良性文件时，WinRAR 会错误地执行文件夹中的恶意代码，导致远程代码执行。

**利用方式：**
1.  攻击者创建一个包含良性文件和同名文件夹的恶意 ZIP 文件。
2.  文件夹中包含要执行的恶意代码（例如，可执行文件）。
3.  攻击者诱使用户使用 WinRAR 打开该 ZIP 文件。
4.  当用户尝试访问良性文件时，WinRAR 会执行文件夹中的恶意代码。

**有效性：**
根据漏洞描述和搜索结果，该漏洞已在野外被利用，因此提供的PoC代码如果能够重现该行为，则可以认为是有效的。

**投毒风险：**
提供的代码仓库 `cve_2023_38831_scanner` 本身是一个漏洞扫描器，而非漏洞利用的PoC。尽管如此，仍然存在一定的投毒风险。代码中可能隐藏后门，虽然其主要功能是扫描，但理论上存在被篡改的风险。代码中使用了网络数据包分析、进程内存扫描、沙箱环境执行等模块，这些模块如果被恶意修改，可能被用于执行恶意操作。因此，综合考虑其扫描器的性质和潜在风险，投毒风险估计为10%。这个风险主要来自供应链投毒，如果下载了被篡改过的扫描器，那么扫描器本身可能成为攻击的一部分。

**项目地址:** [yezzfusl/cve_2023_38831_scanner](https://github.com/yezzfusl/cve_2023_38831_scanner)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

## POC #29

**来源**: [CVE-2023-38831-youmulijiang_evil-winrar.md](../2023/CVE-2023-38831-youmulijiang_evil-winrar.md)

## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 50%

## 详情

CVE-2023-38831是WinRAR在6.23版本之前存在的一个远程代码执行漏洞。该漏洞的利用方式是构造一个特殊的ZIP压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹。当用户尝试在WinRAR中查看该良性文件时，WinRAR会错误地执行该文件夹中的恶意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认该漏洞是有效的，并且已经在野外被利用。漏洞利用代码提供了一个框架，用于生成包含恶意payload的ZIP压缩包，从而实现远程代码执行。

**投毒风险分析：**
提供的代码是一个框架，用于生成漏洞利用的 ZIP 文件，包含生成 exp，邮件发送，下载链接生成等功能。代码中存在潜在的投毒风险，主要体现在以下几个方面：

1.  **Payload 植入:**  该框架可以自定义payload，如果用户在不了解 payload 内容的情况下使用，可能运行恶意指令。
2.  **代码可信度:** 虽然作者声明为安全开发成员，并开源了代码，但代码的安全性仍然需要进一步审计。存在作者预留后门的可能性。 考虑到这是一个漏洞利用框架，其本质就是为了执行恶意代码，所以判定为投毒代码的风险为50%。

**漏洞利用方式：**

1.  攻击者使用该漏洞利用框架(evil-winrar)生成一个恶意的 ZIP 压缩包。
2.  该 ZIP 压缩包包含一个良性文件（如JPG图片）和一个同名的文件夹，文件夹中包含恶意可执行文件。
3.  攻击者通过社会工程学等方式诱骗用户使用存在漏洞的 WinRAR 版本打开该 ZIP 压缩包。
4.  用户尝试查看良性文件时，WinRAR 会错误地执行同名文件夹中的恶意代码。
5.  恶意代码在用户系统上执行，攻击者从而实现远程代码执行，控制受害者的计算机。

**项目地址:** [youmulijiang/evil-winrar](https://github.com/youmulijiang/evil-winrar)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)

---

