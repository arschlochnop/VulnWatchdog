# CVE-2023-27372

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27372-0SPwn_CVE-2023-27372-PoC.md](../2023/CVE-2023-27372-0SPwn_CVE-2023-27372-PoC.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要能够访问SPIP网站的spip_pass页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP内容管理系统中的一个远程代码执行漏洞。该漏洞源于`protege_champ`函数对用户输入的反序列化处理不当，攻击者可以通过构造恶意的序列化数据，并将其作为`oubli`参数传递给`spip.php?page=spip_pass`页面，从而在服务器上执行任意PHP代码。

**有效性分析：**

根据漏洞描述和提供的PoC代码，该漏洞是有效的。PoC代码首先尝试获取CSRF token，然后构造包含恶意PHP代码的序列化payload，最后将其发送到目标服务器。服务器在处理`oubli`参数时，会调用`unserialize`函数，从而触发远程代码执行。

**投毒风险分析：**

PoC代码本身的主要功能是验证漏洞的存在并执行任意命令。PoC中存在执行系统命令的代码，如果使用者不小心，可能会对自己造成危害。仔细阅读代码，发现作者加入恶意代码的可能性较低，但不能完全排除。评估投毒风险为10%。

**利用方式：**

1.  访问目标SPIP网站的`spip.php?page=spip_pass`页面。
2.  获取该页面的CSRF token。
3.  构造包含恶意PHP代码的序列化payload。例如，可以使用`<?php system('whoami'); ?>`来执行`whoami`命令。
4.  将payload作为`oubli`参数，连同CSRF token一起，POST到`spip.php?page=spip_pass`页面。
5.  如果服务器存在漏洞，则会执行payload中的PHP代码，并将结果返回给攻击者。

**缓解措施：**

*   升级SPIP到4.2.1或更高版本。
*   使用提供的patch修复`protege_champ`函数，添加输入验证和过滤。

**项目地址:** [0SPwn/CVE-2023-27372-PoC](https://github.com/0SPwn/CVE-2023-27372-PoC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #2

**来源**: [CVE-2023-27372-1Ronkkeli_spip-cve-2023-27372-rce.md](../2023/CVE-2023-27372-1Ronkkeli_spip-cve-2023-27372-rce.md)

# CVE-2023-27372

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27372-0SPwn_CVE-2023-27372-PoC.md](../2023/CVE-2023-27372-0SPwn_CVE-2023-27372-PoC.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要能够访问SPIP网站的spip_pass页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP内容管理系统中的一个远程代码执行漏洞。该漏洞源于`protege_champ`函数对用户输入的反序列化处理不当，攻击者可以通过构造恶意的序列化数据，并将其作为`oubli`参数传递给`spip.php?page=spip_pass`页面，从而在服务器上执行任意PHP代码。

**有效性分析：**

根据漏洞描述和提供的PoC代码，该漏洞是有效的。PoC代码首先尝试获取CSRF token，然后构造包含恶意PHP代码的序列化payload，最后将其发送到目标服务器。服务器在处理`oubli`参数时，会调用`unserialize`函数，从而触发远程代码执行。

**投毒风险分析：**

PoC代码本身的主要功能是验证漏洞的存在并执行任意命令。PoC中存在执行系统命令的代码，如果使用者不小心，可能会对自己造成危害。仔细阅读代码，发现作者加入恶意代码的可能性较低，但不能完全排除。评估投毒风险为10%。

**利用方式：**

1.  访问目标SPIP网站的`spip.php?page=spip_pass`页面。
2.  获取该页面的CSRF token。
3.  构造包含恶意PHP代码的序列化payload。例如，可以使用`<?php system('whoami'); ?>`来执行`whoami`命令。
4.  将payload作为`oubli`参数，连同CSRF token一起，POST到`spip.php?page=spip_pass`页面。
5.  如果服务器存在漏洞，则会执行payload中的PHP代码，并将结果返回给攻击者。

**缓解措施：**

*   升级SPIP到4.2.1或更高版本。
*   使用提供的patch修复`protege_champ`函数，添加输入验证和过滤。

**项目地址:** [0SPwn/CVE-2023-27372-PoC](https://github.com/0SPwn/CVE-2023-27372-PoC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #2

**来源**: [CVE-2023-27372-1Ronkkeli_spip-cve-2023-27372-rce.md](../2023/CVE-2023-27372-1Ronkkeli_spip-cve-2023-27372-rce.md)

# CVE-2023-27372

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27372-0SPwn_CVE-2023-27372-PoC.md](../2023/CVE-2023-27372-0SPwn_CVE-2023-27372-PoC.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要能够访问SPIP网站的spip_pass页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP内容管理系统中的一个远程代码执行漏洞。该漏洞源于`protege_champ`函数对用户输入的反序列化处理不当，攻击者可以通过构造恶意的序列化数据，并将其作为`oubli`参数传递给`spip.php?page=spip_pass`页面，从而在服务器上执行任意PHP代码。

**有效性分析：**

根据漏洞描述和提供的PoC代码，该漏洞是有效的。PoC代码首先尝试获取CSRF token，然后构造包含恶意PHP代码的序列化payload，最后将其发送到目标服务器。服务器在处理`oubli`参数时，会调用`unserialize`函数，从而触发远程代码执行。

**投毒风险分析：**

PoC代码本身的主要功能是验证漏洞的存在并执行任意命令。PoC中存在执行系统命令的代码，如果使用者不小心，可能会对自己造成危害。仔细阅读代码，发现作者加入恶意代码的可能性较低，但不能完全排除。评估投毒风险为10%。

**利用方式：**

1.  访问目标SPIP网站的`spip.php?page=spip_pass`页面。
2.  获取该页面的CSRF token。
3.  构造包含恶意PHP代码的序列化payload。例如，可以使用`<?php system('whoami'); ?>`来执行`whoami`命令。
4.  将payload作为`oubli`参数，连同CSRF token一起，POST到`spip.php?page=spip_pass`页面。
5.  如果服务器存在漏洞，则会执行payload中的PHP代码，并将结果返回给攻击者。

**缓解措施：**

*   升级SPIP到4.2.1或更高版本。
*   使用提供的patch修复`protege_champ`函数，添加输入验证和过滤。

**项目地址:** [0SPwn/CVE-2023-27372-PoC](https://github.com/0SPwn/CVE-2023-27372-PoC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #2

**来源**: [CVE-2023-27372-1Ronkkeli_spip-cve-2023-27372-rce.md](../2023/CVE-2023-27372-1Ronkkeli_spip-cve-2023-27372-rce.md)

# CVE-2023-27372

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27372-0SPwn_CVE-2023-27372-PoC.md](../2023/CVE-2023-27372-0SPwn_CVE-2023-27372-PoC.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要能够访问SPIP网站的spip_pass页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP内容管理系统中的一个远程代码执行漏洞。该漏洞源于`protege_champ`函数对用户输入的反序列化处理不当，攻击者可以通过构造恶意的序列化数据，并将其作为`oubli`参数传递给`spip.php?page=spip_pass`页面，从而在服务器上执行任意PHP代码。

**有效性分析：**

根据漏洞描述和提供的PoC代码，该漏洞是有效的。PoC代码首先尝试获取CSRF token，然后构造包含恶意PHP代码的序列化payload，最后将其发送到目标服务器。服务器在处理`oubli`参数时，会调用`unserialize`函数，从而触发远程代码执行。

**投毒风险分析：**

PoC代码本身的主要功能是验证漏洞的存在并执行任意命令。PoC中存在执行系统命令的代码，如果使用者不小心，可能会对自己造成危害。仔细阅读代码，发现作者加入恶意代码的可能性较低，但不能完全排除。评估投毒风险为10%。

**利用方式：**

1.  访问目标SPIP网站的`spip.php?page=spip_pass`页面。
2.  获取该页面的CSRF token。
3.  构造包含恶意PHP代码的序列化payload。例如，可以使用`<?php system('whoami'); ?>`来执行`whoami`命令。
4.  将payload作为`oubli`参数，连同CSRF token一起，POST到`spip.php?page=spip_pass`页面。
5.  如果服务器存在漏洞，则会执行payload中的PHP代码，并将结果返回给攻击者。

**缓解措施：**

*   升级SPIP到4.2.1或更高版本。
*   使用提供的patch修复`protege_champ`函数，添加输入验证和过滤。

**项目地址:** [0SPwn/CVE-2023-27372-PoC](https://github.com/0SPwn/CVE-2023-27372-PoC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #2

**来源**: [CVE-2023-27372-1Ronkkeli_spip-cve-2023-27372-rce.md](../2023/CVE-2023-27372-1Ronkkeli_spip-cve-2023-27372-rce.md)

# CVE-2023-27372

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27372-0SPwn_CVE-2023-27372-PoC.md](../2023/CVE-2023-27372-0SPwn_CVE-2023-27372-PoC.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要能够访问SPIP网站的spip_pass页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP内容管理系统中的一个远程代码执行漏洞。该漏洞源于`protege_champ`函数对用户输入的反序列化处理不当，攻击者可以通过构造恶意的序列化数据，并将其作为`oubli`参数传递给`spip.php?page=spip_pass`页面，从而在服务器上执行任意PHP代码。

**有效性分析：**

根据漏洞描述和提供的PoC代码，该漏洞是有效的。PoC代码首先尝试获取CSRF token，然后构造包含恶意PHP代码的序列化payload，最后将其发送到目标服务器。服务器在处理`oubli`参数时，会调用`unserialize`函数，从而触发远程代码执行。

**投毒风险分析：**

PoC代码本身的主要功能是验证漏洞的存在并执行任意命令。PoC中存在执行系统命令的代码，如果使用者不小心，可能会对自己造成危害。仔细阅读代码，发现作者加入恶意代码的可能性较低，但不能完全排除。评估投毒风险为10%。

**利用方式：**

1.  访问目标SPIP网站的`spip.php?page=spip_pass`页面。
2.  获取该页面的CSRF token。
3.  构造包含恶意PHP代码的序列化payload。例如，可以使用`<?php system('whoami'); ?>`来执行`whoami`命令。
4.  将payload作为`oubli`参数，连同CSRF token一起，POST到`spip.php?page=spip_pass`页面。
5.  如果服务器存在漏洞，则会执行payload中的PHP代码，并将结果返回给攻击者。

**缓解措施：**

*   升级SPIP到4.2.1或更高版本。
*   使用提供的patch修复`protege_champ`函数，添加输入验证和过滤。

**项目地址:** [0SPwn/CVE-2023-27372-PoC](https://github.com/0SPwn/CVE-2023-27372-PoC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #2

**来源**: [CVE-2023-27372-1Ronkkeli_spip-cve-2023-27372-rce.md](../2023/CVE-2023-27372-1Ronkkeli_spip-cve-2023-27372-rce.md)

# CVE-2023-27372

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27372-0SPwn_CVE-2023-27372-PoC.md](../2023/CVE-2023-27372-0SPwn_CVE-2023-27372-PoC.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要能够访问SPIP网站的spip_pass页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP内容管理系统中的一个远程代码执行漏洞。该漏洞源于`protege_champ`函数对用户输入的反序列化处理不当，攻击者可以通过构造恶意的序列化数据，并将其作为`oubli`参数传递给`spip.php?page=spip_pass`页面，从而在服务器上执行任意PHP代码。

**有效性分析：**

根据漏洞描述和提供的PoC代码，该漏洞是有效的。PoC代码首先尝试获取CSRF token，然后构造包含恶意PHP代码的序列化payload，最后将其发送到目标服务器。服务器在处理`oubli`参数时，会调用`unserialize`函数，从而触发远程代码执行。

**投毒风险分析：**

PoC代码本身的主要功能是验证漏洞的存在并执行任意命令。PoC中存在执行系统命令的代码，如果使用者不小心，可能会对自己造成危害。仔细阅读代码，发现作者加入恶意代码的可能性较低，但不能完全排除。评估投毒风险为10%。

**利用方式：**

1.  访问目标SPIP网站的`spip.php?page=spip_pass`页面。
2.  获取该页面的CSRF token。
3.  构造包含恶意PHP代码的序列化payload。例如，可以使用`<?php system('whoami'); ?>`来执行`whoami`命令。
4.  将payload作为`oubli`参数，连同CSRF token一起，POST到`spip.php?page=spip_pass`页面。
5.  如果服务器存在漏洞，则会执行payload中的PHP代码，并将结果返回给攻击者。

**缓解措施：**

*   升级SPIP到4.2.1或更高版本。
*   使用提供的patch修复`protege_champ`函数，添加输入验证和过滤。

**项目地址:** [0SPwn/CVE-2023-27372-PoC](https://github.com/0SPwn/CVE-2023-27372-PoC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #2

**来源**: [CVE-2023-27372-1Ronkkeli_spip-cve-2023-27372-rce.md](../2023/CVE-2023-27372-1Ronkkeli_spip-cve-2023-27372-rce.md)

# CVE-2023-27372

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27372-0SPwn_CVE-2023-27372-PoC.md](../2023/CVE-2023-27372-0SPwn_CVE-2023-27372-PoC.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要能够访问SPIP网站的spip_pass页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP内容管理系统中的一个远程代码执行漏洞。该漏洞源于`protege_champ`函数对用户输入的反序列化处理不当，攻击者可以通过构造恶意的序列化数据，并将其作为`oubli`参数传递给`spip.php?page=spip_pass`页面，从而在服务器上执行任意PHP代码。

**有效性分析：**

根据漏洞描述和提供的PoC代码，该漏洞是有效的。PoC代码首先尝试获取CSRF token，然后构造包含恶意PHP代码的序列化payload，最后将其发送到目标服务器。服务器在处理`oubli`参数时，会调用`unserialize`函数，从而触发远程代码执行。

**投毒风险分析：**

PoC代码本身的主要功能是验证漏洞的存在并执行任意命令。PoC中存在执行系统命令的代码，如果使用者不小心，可能会对自己造成危害。仔细阅读代码，发现作者加入恶意代码的可能性较低，但不能完全排除。评估投毒风险为10%。

**利用方式：**

1.  访问目标SPIP网站的`spip.php?page=spip_pass`页面。
2.  获取该页面的CSRF token。
3.  构造包含恶意PHP代码的序列化payload。例如，可以使用`<?php system('whoami'); ?>`来执行`whoami`命令。
4.  将payload作为`oubli`参数，连同CSRF token一起，POST到`spip.php?page=spip_pass`页面。
5.  如果服务器存在漏洞，则会执行payload中的PHP代码，并将结果返回给攻击者。

**缓解措施：**

*   升级SPIP到4.2.1或更高版本。
*   使用提供的patch修复`protege_champ`函数，添加输入验证和过滤。

**项目地址:** [0SPwn/CVE-2023-27372-PoC](https://github.com/0SPwn/CVE-2023-27372-PoC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #2

**来源**: [CVE-2023-27372-1Ronkkeli_spip-cve-2023-27372-rce.md](../2023/CVE-2023-27372-1Ronkkeli_spip-cve-2023-27372-rce.md)

# CVE-2023-27372

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27372-0SPwn_CVE-2023-27372-PoC.md](../2023/CVE-2023-27372-0SPwn_CVE-2023-27372-PoC.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要能够访问SPIP网站的spip_pass页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP内容管理系统中的一个远程代码执行漏洞。该漏洞源于`protege_champ`函数对用户输入的反序列化处理不当，攻击者可以通过构造恶意的序列化数据，并将其作为`oubli`参数传递给`spip.php?page=spip_pass`页面，从而在服务器上执行任意PHP代码。

**有效性分析：**

根据漏洞描述和提供的PoC代码，该漏洞是有效的。PoC代码首先尝试获取CSRF token，然后构造包含恶意PHP代码的序列化payload，最后将其发送到目标服务器。服务器在处理`oubli`参数时，会调用`unserialize`函数，从而触发远程代码执行。

**投毒风险分析：**

PoC代码本身的主要功能是验证漏洞的存在并执行任意命令。PoC中存在执行系统命令的代码，如果使用者不小心，可能会对自己造成危害。仔细阅读代码，发现作者加入恶意代码的可能性较低，但不能完全排除。评估投毒风险为10%。

**利用方式：**

1.  访问目标SPIP网站的`spip.php?page=spip_pass`页面。
2.  获取该页面的CSRF token。
3.  构造包含恶意PHP代码的序列化payload。例如，可以使用`<?php system('whoami'); ?>`来执行`whoami`命令。
4.  将payload作为`oubli`参数，连同CSRF token一起，POST到`spip.php?page=spip_pass`页面。
5.  如果服务器存在漏洞，则会执行payload中的PHP代码，并将结果返回给攻击者。

**缓解措施：**

*   升级SPIP到4.2.1或更高版本。
*   使用提供的patch修复`protege_champ`函数，添加输入验证和过滤。

**项目地址:** [0SPwn/CVE-2023-27372-PoC](https://github.com/0SPwn/CVE-2023-27372-PoC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #2

**来源**: [CVE-2023-27372-1Ronkkeli_spip-cve-2023-27372-rce.md](../2023/CVE-2023-27372-1Ronkkeli_spip-cve-2023-27372-rce.md)

# CVE-2023-27372

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27372-0SPwn_CVE-2023-27372-PoC.md](../2023/CVE-2023-27372-0SPwn_CVE-2023-27372-PoC.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要能够访问SPIP网站的spip_pass页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP内容管理系统中的一个远程代码执行漏洞。该漏洞源于`protege_champ`函数对用户输入的反序列化处理不当，攻击者可以通过构造恶意的序列化数据，并将其作为`oubli`参数传递给`spip.php?page=spip_pass`页面，从而在服务器上执行任意PHP代码。

**有效性分析：**

根据漏洞描述和提供的PoC代码，该漏洞是有效的。PoC代码首先尝试获取CSRF token，然后构造包含恶意PHP代码的序列化payload，最后将其发送到目标服务器。服务器在处理`oubli`参数时，会调用`unserialize`函数，从而触发远程代码执行。

**投毒风险分析：**

PoC代码本身的主要功能是验证漏洞的存在并执行任意命令。PoC中存在执行系统命令的代码，如果使用者不小心，可能会对自己造成危害。仔细阅读代码，发现作者加入恶意代码的可能性较低，但不能完全排除。评估投毒风险为10%。

**利用方式：**

1.  访问目标SPIP网站的`spip.php?page=spip_pass`页面。
2.  获取该页面的CSRF token。
3.  构造包含恶意PHP代码的序列化payload。例如，可以使用`<?php system('whoami'); ?>`来执行`whoami`命令。
4.  将payload作为`oubli`参数，连同CSRF token一起，POST到`spip.php?page=spip_pass`页面。
5.  如果服务器存在漏洞，则会执行payload中的PHP代码，并将结果返回给攻击者。

**缓解措施：**

*   升级SPIP到4.2.1或更高版本。
*   使用提供的patch修复`protege_champ`函数，添加输入验证和过滤。

**项目地址:** [0SPwn/CVE-2023-27372-PoC](https://github.com/0SPwn/CVE-2023-27372-PoC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #2

**来源**: [CVE-2023-27372-1Ronkkeli_spip-cve-2023-27372-rce.md](../2023/CVE-2023-27372-1Ronkkeli_spip-cve-2023-27372-rce.md)

# CVE-2023-27372

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27372-0SPwn_CVE-2023-27372-PoC.md](../2023/CVE-2023-27372-0SPwn_CVE-2023-27372-PoC.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要能够访问SPIP网站的spip_pass页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP内容管理系统中的一个远程代码执行漏洞。该漏洞源于`protege_champ`函数对用户输入的反序列化处理不当，攻击者可以通过构造恶意的序列化数据，并将其作为`oubli`参数传递给`spip.php?page=spip_pass`页面，从而在服务器上执行任意PHP代码。

**有效性分析：**

根据漏洞描述和提供的PoC代码，该漏洞是有效的。PoC代码首先尝试获取CSRF token，然后构造包含恶意PHP代码的序列化payload，最后将其发送到目标服务器。服务器在处理`oubli`参数时，会调用`unserialize`函数，从而触发远程代码执行。

**投毒风险分析：**

PoC代码本身的主要功能是验证漏洞的存在并执行任意命令。PoC中存在执行系统命令的代码，如果使用者不小心，可能会对自己造成危害。仔细阅读代码，发现作者加入恶意代码的可能性较低，但不能完全排除。评估投毒风险为10%。

**利用方式：**

1.  访问目标SPIP网站的`spip.php?page=spip_pass`页面。
2.  获取该页面的CSRF token。
3.  构造包含恶意PHP代码的序列化payload。例如，可以使用`<?php system('whoami'); ?>`来执行`whoami`命令。
4.  将payload作为`oubli`参数，连同CSRF token一起，POST到`spip.php?page=spip_pass`页面。
5.  如果服务器存在漏洞，则会执行payload中的PHP代码，并将结果返回给攻击者。

**缓解措施：**

*   升级SPIP到4.2.1或更高版本。
*   使用提供的patch修复`protege_champ`函数，添加输入验证和过滤。

**项目地址:** [0SPwn/CVE-2023-27372-PoC](https://github.com/0SPwn/CVE-2023-27372-PoC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #2

**来源**: [CVE-2023-27372-1Ronkkeli_spip-cve-2023-27372-rce.md](../2023/CVE-2023-27372-1Ronkkeli_spip-cve-2023-27372-rce.md)

# CVE-2023-27372

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27372-0SPwn_CVE-2023-27372-PoC.md](../2023/CVE-2023-27372-0SPwn_CVE-2023-27372-PoC.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要能够访问SPIP网站的spip_pass页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP内容管理系统中的一个远程代码执行漏洞。该漏洞源于`protege_champ`函数对用户输入的反序列化处理不当，攻击者可以通过构造恶意的序列化数据，并将其作为`oubli`参数传递给`spip.php?page=spip_pass`页面，从而在服务器上执行任意PHP代码。

**有效性分析：**

根据漏洞描述和提供的PoC代码，该漏洞是有效的。PoC代码首先尝试获取CSRF token，然后构造包含恶意PHP代码的序列化payload，最后将其发送到目标服务器。服务器在处理`oubli`参数时，会调用`unserialize`函数，从而触发远程代码执行。

**投毒风险分析：**

PoC代码本身的主要功能是验证漏洞的存在并执行任意命令。PoC中存在执行系统命令的代码，如果使用者不小心，可能会对自己造成危害。仔细阅读代码，发现作者加入恶意代码的可能性较低，但不能完全排除。评估投毒风险为10%。

**利用方式：**

1.  访问目标SPIP网站的`spip.php?page=spip_pass`页面。
2.  获取该页面的CSRF token。
3.  构造包含恶意PHP代码的序列化payload。例如，可以使用`<?php system('whoami'); ?>`来执行`whoami`命令。
4.  将payload作为`oubli`参数，连同CSRF token一起，POST到`spip.php?page=spip_pass`页面。
5.  如果服务器存在漏洞，则会执行payload中的PHP代码，并将结果返回给攻击者。

**缓解措施：**

*   升级SPIP到4.2.1或更高版本。
*   使用提供的patch修复`protege_champ`函数，添加输入验证和过滤。

**项目地址:** [0SPwn/CVE-2023-27372-PoC](https://github.com/0SPwn/CVE-2023-27372-PoC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #2

**来源**: [CVE-2023-27372-1Ronkkeli_spip-cve-2023-27372-rce.md](../2023/CVE-2023-27372-1Ronkkeli_spip-cve-2023-27372-rce.md)

# CVE-2023-27372

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27372-0SPwn_CVE-2023-27372-PoC.md](../2023/CVE-2023-27372-0SPwn_CVE-2023-27372-PoC.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要能够访问SPIP网站的spip_pass页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP内容管理系统中的一个远程代码执行漏洞。该漏洞源于`protege_champ`函数对用户输入的反序列化处理不当，攻击者可以通过构造恶意的序列化数据，并将其作为`oubli`参数传递给`spip.php?page=spip_pass`页面，从而在服务器上执行任意PHP代码。

**有效性分析：**

根据漏洞描述和提供的PoC代码，该漏洞是有效的。PoC代码首先尝试获取CSRF token，然后构造包含恶意PHP代码的序列化payload，最后将其发送到目标服务器。服务器在处理`oubli`参数时，会调用`unserialize`函数，从而触发远程代码执行。

**投毒风险分析：**

PoC代码本身的主要功能是验证漏洞的存在并执行任意命令。PoC中存在执行系统命令的代码，如果使用者不小心，可能会对自己造成危害。仔细阅读代码，发现作者加入恶意代码的可能性较低，但不能完全排除。评估投毒风险为10%。

**利用方式：**

1.  访问目标SPIP网站的`spip.php?page=spip_pass`页面。
2.  获取该页面的CSRF token。
3.  构造包含恶意PHP代码的序列化payload。例如，可以使用`<?php system('whoami'); ?>`来执行`whoami`命令。
4.  将payload作为`oubli`参数，连同CSRF token一起，POST到`spip.php?page=spip_pass`页面。
5.  如果服务器存在漏洞，则会执行payload中的PHP代码，并将结果返回给攻击者。

**缓解措施：**

*   升级SPIP到4.2.1或更高版本。
*   使用提供的patch修复`protege_champ`函数，添加输入验证和过滤。

**项目地址:** [0SPwn/CVE-2023-27372-PoC](https://github.com/0SPwn/CVE-2023-27372-PoC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #2

**来源**: [CVE-2023-27372-1Ronkkeli_spip-cve-2023-27372-rce.md](../2023/CVE-2023-27372-1Ronkkeli_spip-cve-2023-27372-rce.md)

# CVE-2023-27372

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27372-0SPwn_CVE-2023-27372-PoC.md](../2023/CVE-2023-27372-0SPwn_CVE-2023-27372-PoC.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要能够访问SPIP网站的spip_pass页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP内容管理系统中的一个远程代码执行漏洞。该漏洞源于`protege_champ`函数对用户输入的反序列化处理不当，攻击者可以通过构造恶意的序列化数据，并将其作为`oubli`参数传递给`spip.php?page=spip_pass`页面，从而在服务器上执行任意PHP代码。

**有效性分析：**

根据漏洞描述和提供的PoC代码，该漏洞是有效的。PoC代码首先尝试获取CSRF token，然后构造包含恶意PHP代码的序列化payload，最后将其发送到目标服务器。服务器在处理`oubli`参数时，会调用`unserialize`函数，从而触发远程代码执行。

**投毒风险分析：**

PoC代码本身的主要功能是验证漏洞的存在并执行任意命令。PoC中存在执行系统命令的代码，如果使用者不小心，可能会对自己造成危害。仔细阅读代码，发现作者加入恶意代码的可能性较低，但不能完全排除。评估投毒风险为10%。

**利用方式：**

1.  访问目标SPIP网站的`spip.php?page=spip_pass`页面。
2.  获取该页面的CSRF token。
3.  构造包含恶意PHP代码的序列化payload。例如，可以使用`<?php system('whoami'); ?>`来执行`whoami`命令。
4.  将payload作为`oubli`参数，连同CSRF token一起，POST到`spip.php?page=spip_pass`页面。
5.  如果服务器存在漏洞，则会执行payload中的PHP代码，并将结果返回给攻击者。

**缓解措施：**

*   升级SPIP到4.2.1或更高版本。
*   使用提供的patch修复`protege_champ`函数，添加输入验证和过滤。

**项目地址:** [0SPwn/CVE-2023-27372-PoC](https://github.com/0SPwn/CVE-2023-27372-PoC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #2

**来源**: [CVE-2023-27372-1Ronkkeli_spip-cve-2023-27372-rce.md](../2023/CVE-2023-27372-1Ronkkeli_spip-cve-2023-27372-rce.md)

# CVE-2023-27372

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27372-0SPwn_CVE-2023-27372-PoC.md](../2023/CVE-2023-27372-0SPwn_CVE-2023-27372-PoC.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要能够访问SPIP网站的spip_pass页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP内容管理系统中的一个远程代码执行漏洞。该漏洞源于`protege_champ`函数对用户输入的反序列化处理不当，攻击者可以通过构造恶意的序列化数据，并将其作为`oubli`参数传递给`spip.php?page=spip_pass`页面，从而在服务器上执行任意PHP代码。

**有效性分析：**

根据漏洞描述和提供的PoC代码，该漏洞是有效的。PoC代码首先尝试获取CSRF token，然后构造包含恶意PHP代码的序列化payload，最后将其发送到目标服务器。服务器在处理`oubli`参数时，会调用`unserialize`函数，从而触发远程代码执行。

**投毒风险分析：**

PoC代码本身的主要功能是验证漏洞的存在并执行任意命令。PoC中存在执行系统命令的代码，如果使用者不小心，可能会对自己造成危害。仔细阅读代码，发现作者加入恶意代码的可能性较低，但不能完全排除。评估投毒风险为10%。

**利用方式：**

1.  访问目标SPIP网站的`spip.php?page=spip_pass`页面。
2.  获取该页面的CSRF token。
3.  构造包含恶意PHP代码的序列化payload。例如，可以使用`<?php system('whoami'); ?>`来执行`whoami`命令。
4.  将payload作为`oubli`参数，连同CSRF token一起，POST到`spip.php?page=spip_pass`页面。
5.  如果服务器存在漏洞，则会执行payload中的PHP代码，并将结果返回给攻击者。

**缓解措施：**

*   升级SPIP到4.2.1或更高版本。
*   使用提供的patch修复`protege_champ`函数，添加输入验证和过滤。

**项目地址:** [0SPwn/CVE-2023-27372-PoC](https://github.com/0SPwn/CVE-2023-27372-PoC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #2

**来源**: [CVE-2023-27372-1Ronkkeli_spip-cve-2023-27372-rce.md](../2023/CVE-2023-27372-1Ronkkeli_spip-cve-2023-27372-rce.md)

# CVE-2023-27372

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-27372-0SPwn_CVE-2023-27372-PoC.md](../2023/CVE-2023-27372-0SPwn_CVE-2023-27372-PoC.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要能够访问SPIP网站的spip_pass页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP内容管理系统中的一个远程代码执行漏洞。该漏洞源于`protege_champ`函数对用户输入的反序列化处理不当，攻击者可以通过构造恶意的序列化数据，并将其作为`oubli`参数传递给`spip.php?page=spip_pass`页面，从而在服务器上执行任意PHP代码。

**有效性分析：**

根据漏洞描述和提供的PoC代码，该漏洞是有效的。PoC代码首先尝试获取CSRF token，然后构造包含恶意PHP代码的序列化payload，最后将其发送到目标服务器。服务器在处理`oubli`参数时，会调用`unserialize`函数，从而触发远程代码执行。

**投毒风险分析：**

PoC代码本身的主要功能是验证漏洞的存在并执行任意命令。PoC中存在执行系统命令的代码，如果使用者不小心，可能会对自己造成危害。仔细阅读代码，发现作者加入恶意代码的可能性较低，但不能完全排除。评估投毒风险为10%。

**利用方式：**

1.  访问目标SPIP网站的`spip.php?page=spip_pass`页面。
2.  获取该页面的CSRF token。
3.  构造包含恶意PHP代码的序列化payload。例如，可以使用`<?php system('whoami'); ?>`来执行`whoami`命令。
4.  将payload作为`oubli`参数，连同CSRF token一起，POST到`spip.php?page=spip_pass`页面。
5.  如果服务器存在漏洞，则会执行payload中的PHP代码，并将结果返回给攻击者。

**缓解措施：**

*   升级SPIP到4.2.1或更高版本。
*   使用提供的patch修复`protege_champ`函数，添加输入验证和过滤。

**项目地址:** [0SPwn/CVE-2023-27372-PoC](https://github.com/0SPwn/CVE-2023-27372-PoC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #2

**来源**: [CVE-2023-27372-1amthebest1_CVE-2023-27372.md](../2023/CVE-2023-27372-1amthebest1_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1 (受影响版本还包括3.2.x, 4.0.x, 4.1.x)

**利用条件:** 需要能够通过网络访问SPIP站点，且SPIP版本低于4.2.1，未应用安全补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27372 是 SPIP 4.2.1 之前版本中的一个远程代码执行 (RCE) 漏洞。该漏洞的根本原因是程序未正确处理反序列化数据，导致攻击者可以通过构造恶意表单值，在服务器上执行任意代码。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判断该PoC代码有效。
- 漏洞库信息明确指出SPIP在4.2.1之前的版本存在RCE漏洞，并通过不安全的反序列化来实现。
- 搜索引擎结果也证实了该漏洞的存在，并提供了多个漏洞分析和利用链接。
- PoC代码通过利用`spip_pass`页面中的`oubli`参数，传递一个包含PHP代码的序列化字符串，从而执行任意命令。该代码首先获取CSRF token，然后构造包含恶意PHP代码的payload，并发送POST请求到`spip.php?page=spip_pass`。恶意PHP代码使用`system`函数执行经过base64编码的命令。

**投毒风险分析：**
仔细检查了提供的PoC代码，没有发现明显的投毒代码。该代码结构清晰，功能明确，主要用于验证和利用漏洞。风险百分比评估为0%。

**利用方式：**
1.  **漏洞定位：** 该漏洞存在于 SPIP 的前台页面，攻击者无需认证即可利用。
2.  **CSRF Token 获取：** 攻击者首先访问 `spip.php?page=spip_pass` 页面，从中提取 CSRF Token，用于绕过 CSRF 保护。
3.  **Payload 构造：** 攻击者构造一个包含恶意 PHP 代码的序列化字符串。该 PHP 代码通常使用 `system()` 函数执行任意命令。为了避免过滤，命令通常会进行 base64 编码。
4.  **漏洞触发：** 攻击者将构造好的 Payload 放入 `oubli` 参数中，通过 POST 请求发送到 `spip.php?page=spip_pass` 页面，触发反序列化漏洞，从而执行任意代码。
5.  **反弹shell:** 通过反弹shell获得目标机器的权限。


**项目地址:** [1amthebest1/CVE-2023-27372](https://github.com/1amthebest1/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #3

**来源**: [CVE-2023-27372-Chocapikk_CVE-2023-27372.md](../2023/CVE-2023-27372-Chocapikk_CVE-2023-27372.md)

## CVE-2023-27372 SPIP Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要目标SPIP站点存在，且能访问其spip.php?page=spip_pass页面

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27372是SPIP CMS 4.2.1之前版本中的一个远程代码执行漏洞。该漏洞源于程序在处理表单值时，反序列化过程存在缺陷。未经身份验证的攻击者可以通过向易受攻击的SPIP实例上的spip.php?page=spip_pass页面提交特制的表单值，从而利用此漏洞执行任意代码。

**漏洞利用方式：**

1.  **获取Anti-CSRF Token：** PoC脚本首先访问`spip.php?page=spip_pass`页面，解析HTML，提取名为`formulaire_action_args`的input标签中的`value`属性，该值用作Anti-CSRF token。
2.  **构造恶意Payload：**  PoC脚本使用PHP序列化的方式构造恶意代码，通过`oubli`参数传递给`spip.php?page=spip_pass`。
3.  **发送POST请求：**  将包含Anti-CSRF token和恶意payload的POST请求发送到`spip.php?page=spip_pass`，触发反序列化漏洞，从而执行任意代码。
4.  **解析输出：**PoC脚本使用正则表达式提取命令执行结果，如果执行`whoami`成功则认为漏洞存在。

**有效性：**

根据漏洞库信息、搜索结果，以及提供的PoC代码，可以确定该漏洞是真实存在的，并且该PoC代码看起来可以有效利用该漏洞实现远程代码执行。

**投毒风险：**

检查PoC代码发现，该脚本的功能主要是利用CVE-2023-27372漏洞进行RCE验证。通过以下几个方面评估投毒风险：

*   **LeakIX API Key配置:** 脚本中`LEAKIX_API_KEY` 变量需要用户自己配置LeakIX API Key，如果用户不配置则无法从LeakIX获取SPIP URLs。
*   **Payload执行命令:** Payload中执行的命令是`whoami`，这是一个相对安全的命令，用于判断是否成功执行代码。但也存在执行其他命令的潜在风险。
*   **代码逻辑：** 代码逻辑相对清晰，主要是发送请求、解析响应和执行命令。但作者可以加入一些恶意代码来增加风险。
*   **第三方库：** 使用了`requests`、`bs4`、`rich`等第三方库，这些库本身可能存在安全漏洞。

综合考虑，该PoC代码存在少量投毒风险，可能被利用执行未经授权的命令、搜集或窃取用户信息。 风险评估为1%。

**项目地址:** [Chocapikk/CVE-2023-27372](https://github.com/Chocapikk/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #4

**来源**: [CVE-2023-27372-G01d3nW01f_cve-2023-27372.md](../2023/CVE-2023-27372-G01d3nW01f_cve-2023-27372.md)

## CVE-2023-27372 - SPIP Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution

**影响应用:** SPIP

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 4.2.1

**利用条件:** SPIP 实例需要可公开访问，并且运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372 是 SPIP CMS 中的一个远程代码执行漏洞，源于对反序列化数据处理不当。攻击者可以利用此漏洞通过在公共区域的表单值中注入恶意序列化数据来执行任意代码。

**有效性分析：**
提供的 exploit.py 脚本利用了此漏洞。它首先从目标 URL 的 `/spip/spip.php?page=spip_pass` 获取 `formulaire_action_args` 参数。然后，它构造一个包含恶意 PHP 代码的 POST 请求，该代码使用 `system()` 函数执行攻击者提供的命令。该恶意 PHP 代码被序列化并作为 `oubli` 参数传递。脚本的成功执行表明漏洞是可利用的。

**投毒风险分析：**
查看 exploit.py 脚本，其主要功能是利用 CVE-2023-27372 漏洞实现远程代码执行。脚本首先获取目标 URL，然后构造恶意 payload 并发送 POST 请求。脚本本身没有明显的恶意行为，如植入后门或传播恶意软件。
但是，该脚本本身依赖于用户提供的命令来执行 RCE。如果用户不小心执行了包含恶意命令的脚本，可能会导致目标系统受到损害。
在 readme.md 文件中，声明了 “education purpose only!!!!!”，降低了投毒的可能性。
仓库中，可能存在投毒代码的风险较低，约为 10%。

**利用方式：**
1.  攻击者向 SPIP 站点的 `/spip/spip.php?page=spip_pass` 发送 GET 请求。
2.  攻击者解析响应，提取 `formulaire_action_args` 参数。
3.  攻击者构造一个 POST 请求，将 `formulaire_action` 设置为 `oubli`，`formulaire_action_args` 设置为提取的值，并将恶意 PHP 代码序列化后作为 `oubli` 参数的值发送。
4.  SPIP 在处理 POST 请求时，反序列化 `oubli` 参数的值，导致恶意 PHP 代码被执行，从而实现远程代码执行。

**项目地址:** [G01d3nW01f/cve-2023-27372](https://github.com/G01d3nW01f/cve-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #5

**来源**: [CVE-2023-27372-ThatNotEasy_CVE-2023-27372.md](../2023/CVE-2023-27372-ThatNotEasy_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 目标网站必须运行存在漏洞的SPIP版本，且漏洞利用点对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP内容管理系统4.2.1之前版本中的一个远程代码执行漏洞。该漏洞源于SPIP处理反序列化数据的方式不当，允许未经身份验证的攻击者通过表单值执行任意命令。根据提供的漏洞利用代码，攻击者可以指定一个包含多个URL的文件和一个要执行的命令。该脚本会向这些URL发送特制的请求，其中包含序列化的恶意payload，从而在目标服务器上执行指定的命令，获取web用户权限。该漏洞利用代码的投毒风险较低，主要风险在于使用者自身行为，利用此工具进行未授权的渗透测试或攻击。因为代码中包含从 `lib/ua.txt` 读取 User-Agent 的操作，以及输出文件功能，存在一定的信息收集行为，可能用于后期攻击，但总体上代码逻辑清晰，风险可控。

**利用方式：**

1.  **漏洞定位：** SPIP 4.2.1之前的版本存在反序列化漏洞，具体位置在`oubli`参数中，允许在公共区域提交的表单值。
2.  **攻击流程：**
    *   攻击者构造包含恶意代码的序列化payload。
    *   将payload作为表单值提交给存在漏洞的SPIP站点。
    *   SPIP站点反序列化该数据时，恶意代码被执行。
3.  **漏洞利用代码分析：**
    *   `spip.py`脚本接受目标URL列表和要执行的命令作为参数。
    *   脚本使用`requests`库发送HTTP请求，将序列化的payload包含在POST请求的参数中。
    *   服务器端反序列化payload，执行攻击者指定的命令。
4.  **缓解措施：**
    *   将SPIP升级到3.2.18, 4.0.10, 4.1.8, 或 4.2.1及以上版本。
    *   限制对SPIP站点的公共访问。

**项目地址:** [ThatNotEasy/CVE-2023-27372](https://github.com/ThatNotEasy/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #6

**来源**: [CVE-2023-27372-dream434_CVE-2023-27372.md](../2023/CVE-2023-27372-dream434_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要目标SPIP站点存在漏洞页面且可公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27372 是 SPIP 内容管理系统（CMS）中存在的一个远程代码执行漏洞。该漏洞源于 SPIP 在处理表单值时，由于对序列化数据处理不当，导致攻击者可以通过构造恶意的序列化数据，将其作为表单参数提交到存在漏洞的页面，从而在服务器端执行任意代码。

**有效性：**

根据漏洞信息和搜索结果，提供的 POC 代码是有效的。多个资源（如 Packet Storm 和 GitHub 上的 Chocapikk/CVE-2023-27372）都提供了可用于利用该漏洞的 POC 或扫描器。

**投毒风险：**

代码中存在轻微的投毒风险。主要风险点在于：

*   **依赖项安装错误引导:** README.md文件引导用户安装 `collorama` , 正确的安装包应该是 `colorama`，如果用户安装了恶意攻击者伪造的 `collorama` 包，则可能存在安全风险。 *   **执行任意命令：** POC 允许执行任意命令。如果攻击者修改了 POC 中的 `whoami` 命令，替换为恶意命令，可能会造成更大的危害。例如，删除服务器文件、安装恶意软件等。但这种风险主要取决于使用者如何使用 POC，而非 POC 本身包含恶意代码。

考虑到这些因素，我将投毒风险评估为 5%。主要是安装包名称拼写错误引导，存在被利用的可能性。

**利用方式：**

1.  **查找目标：** 寻找运行 SPIP 且版本低于 4.2.1 的站点。
2.  **构造Payload：** 攻击者构造包含恶意 PHP 代码的序列化数据。
3.  **获取CSRF Token：** 首先，向 `/spip.php?page=spip_pass` 页面发起 GET 请求，解析 HTML 响应，提取名为 `formulaire_action_args` 的隐藏输入字段中的 CSRF token。
4.  **发送恶意请求：** 将构造的序列化数据作为 `oubli` 参数的值，连同其他必要的表单参数（包括上一步获取的 CSRF token）通过 POST 请求发送到 `/spip.php?page=spip_pass` 页面。
5.  **代码执行：** SPIP 在处理表单数据时，反序列化 `oubli` 参数，从而执行攻击者注入的恶意 PHP 代码。

简而言之，利用方式是通过构造包含恶意代码的序列化数据，并将其作为表单参数提交到 SPIP 站点，从而实现远程代码执行。

**项目地址:** [dream434/CVE-2023-27372](https://github.com/dream434/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #7

**来源**: [CVE-2023-27372-izzz0_CVE-2023-27372-POC.md](../2023/CVE-2023-27372-izzz0_CVE-2023-27372-POC.md)

## CVE-2023-27372-SPIP远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 目标服务器运行存在漏洞的SPIP版本，且漏洞利用发生在公共区域，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP 4.2.1之前版本中的一个远程代码执行漏洞。该漏洞是由于SPIP处理表单值中的序列化数据不当造成的。攻击者可以通过在公共区域提交包含恶意序列化数据的表单值来利用此漏洞，从而执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，该漏洞是有效的。POC代码通过构造特定的POST请求，向`spip.php?page=spip_pass`页面提交包含恶意PHP代码的序列化字符串，利用SPIP的反序列化漏洞执行代码。如果服务器返回包含`phpinfo()`结果的页面，则表明存在漏洞。

**投毒风险：**
代码主体逻辑是漏洞验证，风险较低。但仍然存在一定的投毒风险，因为攻击者可能修改POC代码，使其包含恶意操作，例如：

*   **植入后门:** POC中可以加入执行任意系统命令的代码，从而在目标服务器上植入后门。
*   **数据窃取:** POC可以被修改为窃取服务器上的敏感数据，例如数据库凭据或配置文件。
*   **拒绝服务攻击:** POC可以被修改为发送大量请求，导致目标服务器过载，从而造成拒绝服务攻击。
POC 使用 phpinfo() 验证，比较安全，但潜在风险依然存在。因此，投毒风险评估为10%。

**利用方式：**
1.  确定目标网站运行的SPIP版本低于4.2.1。
2.  向`spip.php?page=spip_pass`页面发送包含以下参数的POST请求：
    *   `formulaire_action=oubli`
    *   `formulaire_action_args`：从页面中提取的`formulaire_action_args`字段的值，进行URL编码。
    *   `oubli`: 包含恶意PHP代码的序列化字符串，例如`s:19:"<?php phpinfo(); ?>";`
    *   `nobot`：任意值，用于绕过反爬机制
3.  如果服务器返回包含恶意PHP代码执行结果的页面，则表明漏洞利用成功。例如，如果使用`phpinfo()`，则会返回phpinfo页面，或者反序列化任意类的函数，执行恶意代码。

**项目地址:** [izzz0/CVE-2023-27372-POC](https://github.com/izzz0/CVE-2023-27372-POC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #8

**来源**: [CVE-2023-27372-nuts7_CVE-2023-27372.md](../2023/CVE-2023-27372-nuts7_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要能够访问SPIP的登录页面或存在`spip_pass`页面的公开访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27372是SPIP 4.2.1之前的版本中的一个远程代码执行漏洞，原因是程序在处理表单值中的序列化数据时存在缺陷。攻击者可以通过在公共区域提交包含恶意序列化数据的表单，从而执行任意代码。PoC代码显示，它首先获取一个Anti-CSRF token，然后构造一个包含PHP代码的payload，该代码会执行指定的系统命令。这个漏洞的利用方式是，攻击者先访问登录页面 (`spip.php?page=spip_pass`)，获取`formulaire_action_args`的值 (Anti-CSRF token)。然后，攻击者构造一个POST请求，其中包含`page=spip_pass`， `formulaire_action=oubli`, `formulaire_action_args`为之前获取的CSRF token的值，并且`oubli`参数的值为精心构造的PHP序列化字符串，这个序列化字符串包含要执行的PHP代码 (使用 `system()`函数执行命令)。由于SPIP在反序列化这个`oubli`参数时存在漏洞，这会导致恶意代码执行。 

**有效性:** PoC代码有效，成功利用该漏洞能够在目标服务器上执行任意命令。

**投毒风险:** 经过检查`CVE-2023-27372.py`，`CVE-2023-27372.yaml`，`Dockerfile`和`README.md`文件。没有发现明显的恶意代码或者后门。`Dockerfile`用于构建一个包含易受攻击版本SPIP的环境，用于测试和演示漏洞。`CVE-2023-27372.yaml`是一个nuclei模板，用于检测目标是否存在此漏洞，该模板尝试执行phpinfo()，证明可以执行恶意代码。`README.md`提供有关漏洞的信息。

**利用方式:**

1.  **获取Anti-CSRF Token:**  访问受影响的SPIP站点的登录页面（`spip.php?page=spip_pass`），提取`formulaire_action_args`字段的值，即Anti-CSRF token。
2.  **构造Payload:**  构造一个包含恶意PHP代码的序列化字符串，例如`s:28:"<?php system('whoami'); ?>";`。这个字符串的长度需要根据实际的PHP代码长度进行调整。
3.  **发送Payload:**  通过POST请求将构造的Payload发送到`spip.php?page=spip_pass`，同时包含Anti-CSRF token和必要的表单参数。
4.  **执行代码:**  服务器在处理请求时，由于反序列化漏洞，会执行Payload中的PHP代码，从而实现远程代码执行。

**项目地址:** [nuts7/CVE-2023-27372](https://github.com/nuts7/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #9

**来源**: [CVE-2023-27372-redboltsec_CVE-2023-27372-PoC.md](../2023/CVE-2023-27372-redboltsec_CVE-2023-27372-PoC.md)

## CVE-2023-27372 SPIP RCE

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 4.2.1 (受影响版本包括3.2.18之前, 4.0.10之前, 4.1.8之前)

**利用条件:** 目标SPIP站点存在且可访问spip_pass页面，不需要任何权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27372 漏洞存在于 SPIP 4.2.1 之前的版本，允许未经身份验证的远程攻击者通过 `spip.php?page=spip_pass` 页面的 form values 执行任意代码。该漏洞源于 `ecrire/balise/formulaire_.php` 文件中 `protege_champ` 函数对序列化数据处理不当，未进行充分的输入验证，导致反序列化漏洞。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。Packet Storm Security 和 GitHub (Chocapikk/CVE-2023-27372) 都提供了漏洞利用代码或扫描器，证明该漏洞是可以被利用的。POC 代码通过构造恶意的序列化字符串，并将其作为 `oubli` 参数的值发送到 `spip.php?page=spip_pass` 页面，从而触发反序列化漏洞。

**投毒风险：**
分析提供的 PoC 代码 (`cve-2023-27372.py`)，未发现明显的投毒代码。该脚本的主要功能是：

1.  获取 CSRF token (如果存在)。
2.  构造包含恶意 PHP 代码的序列化 payload，该代码使用 `exec` 函数执行命令。
3.  将 payload 发送到目标 SPIP 站点。
4.  解析响应，提取命令执行结果。

脚本本身没有执行任何与目标系统无关的操作，例如上传恶意文件、修改系统配置或连接到外部服务器。因此，投毒风险较低。

**利用方式：**

1.  **定位目标:**  确定存在漏洞的 SPIP 站点，版本低于 4.2.1，且允许公共访问 `spip.php?page=spip_pass` 页面。
2.  **获取 CSRF Token (如果需要):** 访问 `spip.php?page=spip_pass` 页面，提取 CSRF token (`formulaire_action_args`)。有些情况下，可能不需要 CSRF token。
3.  **构造 Payload:**  构造包含恶意 PHP 代码的序列化字符串，用于执行任意命令。例如，使用 `<?php system($_GET['cmd']); ?>` 来执行 GET 请求中的 `cmd` 参数指定的命令。
4.  **发送 Payload:**  将构造的 Payload 作为 `oubli` 参数的值，通过 POST 请求发送到 `spip.php?page=spip_pass` 页面，同时附带 CSRF token (如果需要)。
5.  **执行命令:**  如果 Payload 成功执行，则可以通过构造特定的 HTTP 请求来执行任意命令。例如，访问 `spip.php?page=spip_pass&cmd=whoami` 来执行 `whoami` 命令，获取当前用户。
6.  **交互式 Shell (POC代码)**: PoC中尝试使用`whoami`检测是否RCE成功，如果失败，PoC会尝试生成一个交互式shell。这部分代码可能存在问题，需要用户多次输入命令。

**缓解措施：**
升级到 SPIP 4.2.1 或更高版本，或者应用补丁以修复反序列化漏洞。


**项目地址:** [redboltsec/CVE-2023-27372-PoC](https://github.com/redboltsec/CVE-2023-27372-PoC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---



---

## POC #3

**来源**: [CVE-2023-27372-1amthebest1_CVE-2023-27372.md](../2023/CVE-2023-27372-1amthebest1_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1 (受影响版本还包括3.2.x, 4.0.x, 4.1.x)

**利用条件:** 需要能够通过网络访问SPIP站点，且SPIP版本低于4.2.1，未应用安全补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27372 是 SPIP 4.2.1 之前版本中的一个远程代码执行 (RCE) 漏洞。该漏洞的根本原因是程序未正确处理反序列化数据，导致攻击者可以通过构造恶意表单值，在服务器上执行任意代码。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判断该PoC代码有效。
- 漏洞库信息明确指出SPIP在4.2.1之前的版本存在RCE漏洞，并通过不安全的反序列化来实现。
- 搜索引擎结果也证实了该漏洞的存在，并提供了多个漏洞分析和利用链接。
- PoC代码通过利用`spip_pass`页面中的`oubli`参数，传递一个包含PHP代码的序列化字符串，从而执行任意命令。该代码首先获取CSRF token，然后构造包含恶意PHP代码的payload，并发送POST请求到`spip.php?page=spip_pass`。恶意PHP代码使用`system`函数执行经过base64编码的命令。

**投毒风险分析：**
仔细检查了提供的PoC代码，没有发现明显的投毒代码。该代码结构清晰，功能明确，主要用于验证和利用漏洞。风险百分比评估为0%。

**利用方式：**
1.  **漏洞定位：** 该漏洞存在于 SPIP 的前台页面，攻击者无需认证即可利用。
2.  **CSRF Token 获取：** 攻击者首先访问 `spip.php?page=spip_pass` 页面，从中提取 CSRF Token，用于绕过 CSRF 保护。
3.  **Payload 构造：** 攻击者构造一个包含恶意 PHP 代码的序列化字符串。该 PHP 代码通常使用 `system()` 函数执行任意命令。为了避免过滤，命令通常会进行 base64 编码。
4.  **漏洞触发：** 攻击者将构造好的 Payload 放入 `oubli` 参数中，通过 POST 请求发送到 `spip.php?page=spip_pass` 页面，触发反序列化漏洞，从而执行任意代码。
5.  **反弹shell:** 通过反弹shell获得目标机器的权限。


**项目地址:** [1amthebest1/CVE-2023-27372](https://github.com/1amthebest1/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #4

**来源**: [CVE-2023-27372-Chocapikk_CVE-2023-27372.md](../2023/CVE-2023-27372-Chocapikk_CVE-2023-27372.md)

## CVE-2023-27372 SPIP Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要目标SPIP站点存在，且能访问其spip.php?page=spip_pass页面

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27372是SPIP CMS 4.2.1之前版本中的一个远程代码执行漏洞。该漏洞源于程序在处理表单值时，反序列化过程存在缺陷。未经身份验证的攻击者可以通过向易受攻击的SPIP实例上的spip.php?page=spip_pass页面提交特制的表单值，从而利用此漏洞执行任意代码。

**漏洞利用方式：**

1.  **获取Anti-CSRF Token：** PoC脚本首先访问`spip.php?page=spip_pass`页面，解析HTML，提取名为`formulaire_action_args`的input标签中的`value`属性，该值用作Anti-CSRF token。
2.  **构造恶意Payload：**  PoC脚本使用PHP序列化的方式构造恶意代码，通过`oubli`参数传递给`spip.php?page=spip_pass`。
3.  **发送POST请求：**  将包含Anti-CSRF token和恶意payload的POST请求发送到`spip.php?page=spip_pass`，触发反序列化漏洞，从而执行任意代码。
4.  **解析输出：**PoC脚本使用正则表达式提取命令执行结果，如果执行`whoami`成功则认为漏洞存在。

**有效性：**

根据漏洞库信息、搜索结果，以及提供的PoC代码，可以确定该漏洞是真实存在的，并且该PoC代码看起来可以有效利用该漏洞实现远程代码执行。

**投毒风险：**

检查PoC代码发现，该脚本的功能主要是利用CVE-2023-27372漏洞进行RCE验证。通过以下几个方面评估投毒风险：

*   **LeakIX API Key配置:** 脚本中`LEAKIX_API_KEY` 变量需要用户自己配置LeakIX API Key，如果用户不配置则无法从LeakIX获取SPIP URLs。
*   **Payload执行命令:** Payload中执行的命令是`whoami`，这是一个相对安全的命令，用于判断是否成功执行代码。但也存在执行其他命令的潜在风险。
*   **代码逻辑：** 代码逻辑相对清晰，主要是发送请求、解析响应和执行命令。但作者可以加入一些恶意代码来增加风险。
*   **第三方库：** 使用了`requests`、`bs4`、`rich`等第三方库，这些库本身可能存在安全漏洞。

综合考虑，该PoC代码存在少量投毒风险，可能被利用执行未经授权的命令、搜集或窃取用户信息。 风险评估为1%。

**项目地址:** [Chocapikk/CVE-2023-27372](https://github.com/Chocapikk/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #5

**来源**: [CVE-2023-27372-G01d3nW01f_cve-2023-27372.md](../2023/CVE-2023-27372-G01d3nW01f_cve-2023-27372.md)

## CVE-2023-27372 - SPIP Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution

**影响应用:** SPIP

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 4.2.1

**利用条件:** SPIP 实例需要可公开访问，并且运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372 是 SPIP CMS 中的一个远程代码执行漏洞，源于对反序列化数据处理不当。攻击者可以利用此漏洞通过在公共区域的表单值中注入恶意序列化数据来执行任意代码。

**有效性分析：**
提供的 exploit.py 脚本利用了此漏洞。它首先从目标 URL 的 `/spip/spip.php?page=spip_pass` 获取 `formulaire_action_args` 参数。然后，它构造一个包含恶意 PHP 代码的 POST 请求，该代码使用 `system()` 函数执行攻击者提供的命令。该恶意 PHP 代码被序列化并作为 `oubli` 参数传递。脚本的成功执行表明漏洞是可利用的。

**投毒风险分析：**
查看 exploit.py 脚本，其主要功能是利用 CVE-2023-27372 漏洞实现远程代码执行。脚本首先获取目标 URL，然后构造恶意 payload 并发送 POST 请求。脚本本身没有明显的恶意行为，如植入后门或传播恶意软件。
但是，该脚本本身依赖于用户提供的命令来执行 RCE。如果用户不小心执行了包含恶意命令的脚本，可能会导致目标系统受到损害。
在 readme.md 文件中，声明了 “education purpose only!!!!!”，降低了投毒的可能性。
仓库中，可能存在投毒代码的风险较低，约为 10%。

**利用方式：**
1.  攻击者向 SPIP 站点的 `/spip/spip.php?page=spip_pass` 发送 GET 请求。
2.  攻击者解析响应，提取 `formulaire_action_args` 参数。
3.  攻击者构造一个 POST 请求，将 `formulaire_action` 设置为 `oubli`，`formulaire_action_args` 设置为提取的值，并将恶意 PHP 代码序列化后作为 `oubli` 参数的值发送。
4.  SPIP 在处理 POST 请求时，反序列化 `oubli` 参数的值，导致恶意 PHP 代码被执行，从而实现远程代码执行。

**项目地址:** [G01d3nW01f/cve-2023-27372](https://github.com/G01d3nW01f/cve-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #6

**来源**: [CVE-2023-27372-ThatNotEasy_CVE-2023-27372.md](../2023/CVE-2023-27372-ThatNotEasy_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 目标网站必须运行存在漏洞的SPIP版本，且漏洞利用点对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP内容管理系统4.2.1之前版本中的一个远程代码执行漏洞。该漏洞源于SPIP处理反序列化数据的方式不当，允许未经身份验证的攻击者通过表单值执行任意命令。根据提供的漏洞利用代码，攻击者可以指定一个包含多个URL的文件和一个要执行的命令。该脚本会向这些URL发送特制的请求，其中包含序列化的恶意payload，从而在目标服务器上执行指定的命令，获取web用户权限。该漏洞利用代码的投毒风险较低，主要风险在于使用者自身行为，利用此工具进行未授权的渗透测试或攻击。因为代码中包含从 `lib/ua.txt` 读取 User-Agent 的操作，以及输出文件功能，存在一定的信息收集行为，可能用于后期攻击，但总体上代码逻辑清晰，风险可控。

**利用方式：**

1.  **漏洞定位：** SPIP 4.2.1之前的版本存在反序列化漏洞，具体位置在`oubli`参数中，允许在公共区域提交的表单值。
2.  **攻击流程：**
    *   攻击者构造包含恶意代码的序列化payload。
    *   将payload作为表单值提交给存在漏洞的SPIP站点。
    *   SPIP站点反序列化该数据时，恶意代码被执行。
3.  **漏洞利用代码分析：**
    *   `spip.py`脚本接受目标URL列表和要执行的命令作为参数。
    *   脚本使用`requests`库发送HTTP请求，将序列化的payload包含在POST请求的参数中。
    *   服务器端反序列化payload，执行攻击者指定的命令。
4.  **缓解措施：**
    *   将SPIP升级到3.2.18, 4.0.10, 4.1.8, 或 4.2.1及以上版本。
    *   限制对SPIP站点的公共访问。

**项目地址:** [ThatNotEasy/CVE-2023-27372](https://github.com/ThatNotEasy/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #7

**来源**: [CVE-2023-27372-dream434_CVE-2023-27372.md](../2023/CVE-2023-27372-dream434_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要目标SPIP站点存在漏洞页面且可公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27372 是 SPIP 内容管理系统（CMS）中存在的一个远程代码执行漏洞。该漏洞源于 SPIP 在处理表单值时，由于对序列化数据处理不当，导致攻击者可以通过构造恶意的序列化数据，将其作为表单参数提交到存在漏洞的页面，从而在服务器端执行任意代码。

**有效性：**

根据漏洞信息和搜索结果，提供的 POC 代码是有效的。多个资源（如 Packet Storm 和 GitHub 上的 Chocapikk/CVE-2023-27372）都提供了可用于利用该漏洞的 POC 或扫描器。

**投毒风险：**

代码中存在轻微的投毒风险。主要风险点在于：

*   **依赖项安装错误引导:** README.md文件引导用户安装 `collorama` , 正确的安装包应该是 `colorama`，如果用户安装了恶意攻击者伪造的 `collorama` 包，则可能存在安全风险。 *   **执行任意命令：** POC 允许执行任意命令。如果攻击者修改了 POC 中的 `whoami` 命令，替换为恶意命令，可能会造成更大的危害。例如，删除服务器文件、安装恶意软件等。但这种风险主要取决于使用者如何使用 POC，而非 POC 本身包含恶意代码。

考虑到这些因素，我将投毒风险评估为 5%。主要是安装包名称拼写错误引导，存在被利用的可能性。

**利用方式：**

1.  **查找目标：** 寻找运行 SPIP 且版本低于 4.2.1 的站点。
2.  **构造Payload：** 攻击者构造包含恶意 PHP 代码的序列化数据。
3.  **获取CSRF Token：** 首先，向 `/spip.php?page=spip_pass` 页面发起 GET 请求，解析 HTML 响应，提取名为 `formulaire_action_args` 的隐藏输入字段中的 CSRF token。
4.  **发送恶意请求：** 将构造的序列化数据作为 `oubli` 参数的值，连同其他必要的表单参数（包括上一步获取的 CSRF token）通过 POST 请求发送到 `/spip.php?page=spip_pass` 页面。
5.  **代码执行：** SPIP 在处理表单数据时，反序列化 `oubli` 参数，从而执行攻击者注入的恶意 PHP 代码。

简而言之，利用方式是通过构造包含恶意代码的序列化数据，并将其作为表单参数提交到 SPIP 站点，从而实现远程代码执行。

**项目地址:** [dream434/CVE-2023-27372](https://github.com/dream434/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #8

**来源**: [CVE-2023-27372-izzz0_CVE-2023-27372-POC.md](../2023/CVE-2023-27372-izzz0_CVE-2023-27372-POC.md)

## CVE-2023-27372-SPIP远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 目标服务器运行存在漏洞的SPIP版本，且漏洞利用发生在公共区域，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP 4.2.1之前版本中的一个远程代码执行漏洞。该漏洞是由于SPIP处理表单值中的序列化数据不当造成的。攻击者可以通过在公共区域提交包含恶意序列化数据的表单值来利用此漏洞，从而执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，该漏洞是有效的。POC代码通过构造特定的POST请求，向`spip.php?page=spip_pass`页面提交包含恶意PHP代码的序列化字符串，利用SPIP的反序列化漏洞执行代码。如果服务器返回包含`phpinfo()`结果的页面，则表明存在漏洞。

**投毒风险：**
代码主体逻辑是漏洞验证，风险较低。但仍然存在一定的投毒风险，因为攻击者可能修改POC代码，使其包含恶意操作，例如：

*   **植入后门:** POC中可以加入执行任意系统命令的代码，从而在目标服务器上植入后门。
*   **数据窃取:** POC可以被修改为窃取服务器上的敏感数据，例如数据库凭据或配置文件。
*   **拒绝服务攻击:** POC可以被修改为发送大量请求，导致目标服务器过载，从而造成拒绝服务攻击。
POC 使用 phpinfo() 验证，比较安全，但潜在风险依然存在。因此，投毒风险评估为10%。

**利用方式：**
1.  确定目标网站运行的SPIP版本低于4.2.1。
2.  向`spip.php?page=spip_pass`页面发送包含以下参数的POST请求：
    *   `formulaire_action=oubli`
    *   `formulaire_action_args`：从页面中提取的`formulaire_action_args`字段的值，进行URL编码。
    *   `oubli`: 包含恶意PHP代码的序列化字符串，例如`s:19:"<?php phpinfo(); ?>";`
    *   `nobot`：任意值，用于绕过反爬机制
3.  如果服务器返回包含恶意PHP代码执行结果的页面，则表明漏洞利用成功。例如，如果使用`phpinfo()`，则会返回phpinfo页面，或者反序列化任意类的函数，执行恶意代码。

**项目地址:** [izzz0/CVE-2023-27372-POC](https://github.com/izzz0/CVE-2023-27372-POC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #9

**来源**: [CVE-2023-27372-nuts7_CVE-2023-27372.md](../2023/CVE-2023-27372-nuts7_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要能够访问SPIP的登录页面或存在`spip_pass`页面的公开访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27372是SPIP 4.2.1之前的版本中的一个远程代码执行漏洞，原因是程序在处理表单值中的序列化数据时存在缺陷。攻击者可以通过在公共区域提交包含恶意序列化数据的表单，从而执行任意代码。PoC代码显示，它首先获取一个Anti-CSRF token，然后构造一个包含PHP代码的payload，该代码会执行指定的系统命令。这个漏洞的利用方式是，攻击者先访问登录页面 (`spip.php?page=spip_pass`)，获取`formulaire_action_args`的值 (Anti-CSRF token)。然后，攻击者构造一个POST请求，其中包含`page=spip_pass`， `formulaire_action=oubli`, `formulaire_action_args`为之前获取的CSRF token的值，并且`oubli`参数的值为精心构造的PHP序列化字符串，这个序列化字符串包含要执行的PHP代码 (使用 `system()`函数执行命令)。由于SPIP在反序列化这个`oubli`参数时存在漏洞，这会导致恶意代码执行。 

**有效性:** PoC代码有效，成功利用该漏洞能够在目标服务器上执行任意命令。

**投毒风险:** 经过检查`CVE-2023-27372.py`，`CVE-2023-27372.yaml`，`Dockerfile`和`README.md`文件。没有发现明显的恶意代码或者后门。`Dockerfile`用于构建一个包含易受攻击版本SPIP的环境，用于测试和演示漏洞。`CVE-2023-27372.yaml`是一个nuclei模板，用于检测目标是否存在此漏洞，该模板尝试执行phpinfo()，证明可以执行恶意代码。`README.md`提供有关漏洞的信息。

**利用方式:**

1.  **获取Anti-CSRF Token:**  访问受影响的SPIP站点的登录页面（`spip.php?page=spip_pass`），提取`formulaire_action_args`字段的值，即Anti-CSRF token。
2.  **构造Payload:**  构造一个包含恶意PHP代码的序列化字符串，例如`s:28:"<?php system('whoami'); ?>";`。这个字符串的长度需要根据实际的PHP代码长度进行调整。
3.  **发送Payload:**  通过POST请求将构造的Payload发送到`spip.php?page=spip_pass`，同时包含Anti-CSRF token和必要的表单参数。
4.  **执行代码:**  服务器在处理请求时，由于反序列化漏洞，会执行Payload中的PHP代码，从而实现远程代码执行。

**项目地址:** [nuts7/CVE-2023-27372](https://github.com/nuts7/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #10

**来源**: [CVE-2023-27372-redboltsec_CVE-2023-27372-PoC.md](../2023/CVE-2023-27372-redboltsec_CVE-2023-27372-PoC.md)

## CVE-2023-27372 SPIP RCE

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 4.2.1 (受影响版本包括3.2.18之前, 4.0.10之前, 4.1.8之前)

**利用条件:** 目标SPIP站点存在且可访问spip_pass页面，不需要任何权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27372 漏洞存在于 SPIP 4.2.1 之前的版本，允许未经身份验证的远程攻击者通过 `spip.php?page=spip_pass` 页面的 form values 执行任意代码。该漏洞源于 `ecrire/balise/formulaire_.php` 文件中 `protege_champ` 函数对序列化数据处理不当，未进行充分的输入验证，导致反序列化漏洞。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。Packet Storm Security 和 GitHub (Chocapikk/CVE-2023-27372) 都提供了漏洞利用代码或扫描器，证明该漏洞是可以被利用的。POC 代码通过构造恶意的序列化字符串，并将其作为 `oubli` 参数的值发送到 `spip.php?page=spip_pass` 页面，从而触发反序列化漏洞。

**投毒风险：**
分析提供的 PoC 代码 (`cve-2023-27372.py`)，未发现明显的投毒代码。该脚本的主要功能是：

1.  获取 CSRF token (如果存在)。
2.  构造包含恶意 PHP 代码的序列化 payload，该代码使用 `exec` 函数执行命令。
3.  将 payload 发送到目标 SPIP 站点。
4.  解析响应，提取命令执行结果。

脚本本身没有执行任何与目标系统无关的操作，例如上传恶意文件、修改系统配置或连接到外部服务器。因此，投毒风险较低。

**利用方式：**

1.  **定位目标:**  确定存在漏洞的 SPIP 站点，版本低于 4.2.1，且允许公共访问 `spip.php?page=spip_pass` 页面。
2.  **获取 CSRF Token (如果需要):** 访问 `spip.php?page=spip_pass` 页面，提取 CSRF token (`formulaire_action_args`)。有些情况下，可能不需要 CSRF token。
3.  **构造 Payload:**  构造包含恶意 PHP 代码的序列化字符串，用于执行任意命令。例如，使用 `<?php system($_GET['cmd']); ?>` 来执行 GET 请求中的 `cmd` 参数指定的命令。
4.  **发送 Payload:**  将构造的 Payload 作为 `oubli` 参数的值，通过 POST 请求发送到 `spip.php?page=spip_pass` 页面，同时附带 CSRF token (如果需要)。
5.  **执行命令:**  如果 Payload 成功执行，则可以通过构造特定的 HTTP 请求来执行任意命令。例如，访问 `spip.php?page=spip_pass&cmd=whoami` 来执行 `whoami` 命令，获取当前用户。
6.  **交互式 Shell (POC代码)**: PoC中尝试使用`whoami`检测是否RCE成功，如果失败，PoC会尝试生成一个交互式shell。这部分代码可能存在问题，需要用户多次输入命令。

**缓解措施：**
升级到 SPIP 4.2.1 或更高版本，或者应用补丁以修复反序列化漏洞。


**项目地址:** [redboltsec/CVE-2023-27372-PoC](https://github.com/redboltsec/CVE-2023-27372-PoC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---



---

## POC #3

**来源**: [CVE-2023-27372-1amthebest1_CVE-2023-27372.md](../2023/CVE-2023-27372-1amthebest1_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1 (受影响版本还包括3.2.x, 4.0.x, 4.1.x)

**利用条件:** 需要能够通过网络访问SPIP站点，且SPIP版本低于4.2.1，未应用安全补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27372 是 SPIP 4.2.1 之前版本中的一个远程代码执行 (RCE) 漏洞。该漏洞的根本原因是程序未正确处理反序列化数据，导致攻击者可以通过构造恶意表单值，在服务器上执行任意代码。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判断该PoC代码有效。
- 漏洞库信息明确指出SPIP在4.2.1之前的版本存在RCE漏洞，并通过不安全的反序列化来实现。
- 搜索引擎结果也证实了该漏洞的存在，并提供了多个漏洞分析和利用链接。
- PoC代码通过利用`spip_pass`页面中的`oubli`参数，传递一个包含PHP代码的序列化字符串，从而执行任意命令。该代码首先获取CSRF token，然后构造包含恶意PHP代码的payload，并发送POST请求到`spip.php?page=spip_pass`。恶意PHP代码使用`system`函数执行经过base64编码的命令。

**投毒风险分析：**
仔细检查了提供的PoC代码，没有发现明显的投毒代码。该代码结构清晰，功能明确，主要用于验证和利用漏洞。风险百分比评估为0%。

**利用方式：**
1.  **漏洞定位：** 该漏洞存在于 SPIP 的前台页面，攻击者无需认证即可利用。
2.  **CSRF Token 获取：** 攻击者首先访问 `spip.php?page=spip_pass` 页面，从中提取 CSRF Token，用于绕过 CSRF 保护。
3.  **Payload 构造：** 攻击者构造一个包含恶意 PHP 代码的序列化字符串。该 PHP 代码通常使用 `system()` 函数执行任意命令。为了避免过滤，命令通常会进行 base64 编码。
4.  **漏洞触发：** 攻击者将构造好的 Payload 放入 `oubli` 参数中，通过 POST 请求发送到 `spip.php?page=spip_pass` 页面，触发反序列化漏洞，从而执行任意代码。
5.  **反弹shell:** 通过反弹shell获得目标机器的权限。


**项目地址:** [1amthebest1/CVE-2023-27372](https://github.com/1amthebest1/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #4

**来源**: [CVE-2023-27372-Chocapikk_CVE-2023-27372.md](../2023/CVE-2023-27372-Chocapikk_CVE-2023-27372.md)

## CVE-2023-27372 SPIP Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要目标SPIP站点存在，且能访问其spip.php?page=spip_pass页面

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27372是SPIP CMS 4.2.1之前版本中的一个远程代码执行漏洞。该漏洞源于程序在处理表单值时，反序列化过程存在缺陷。未经身份验证的攻击者可以通过向易受攻击的SPIP实例上的spip.php?page=spip_pass页面提交特制的表单值，从而利用此漏洞执行任意代码。

**漏洞利用方式：**

1.  **获取Anti-CSRF Token：** PoC脚本首先访问`spip.php?page=spip_pass`页面，解析HTML，提取名为`formulaire_action_args`的input标签中的`value`属性，该值用作Anti-CSRF token。
2.  **构造恶意Payload：**  PoC脚本使用PHP序列化的方式构造恶意代码，通过`oubli`参数传递给`spip.php?page=spip_pass`。
3.  **发送POST请求：**  将包含Anti-CSRF token和恶意payload的POST请求发送到`spip.php?page=spip_pass`，触发反序列化漏洞，从而执行任意代码。
4.  **解析输出：**PoC脚本使用正则表达式提取命令执行结果，如果执行`whoami`成功则认为漏洞存在。

**有效性：**

根据漏洞库信息、搜索结果，以及提供的PoC代码，可以确定该漏洞是真实存在的，并且该PoC代码看起来可以有效利用该漏洞实现远程代码执行。

**投毒风险：**

检查PoC代码发现，该脚本的功能主要是利用CVE-2023-27372漏洞进行RCE验证。通过以下几个方面评估投毒风险：

*   **LeakIX API Key配置:** 脚本中`LEAKIX_API_KEY` 变量需要用户自己配置LeakIX API Key，如果用户不配置则无法从LeakIX获取SPIP URLs。
*   **Payload执行命令:** Payload中执行的命令是`whoami`，这是一个相对安全的命令，用于判断是否成功执行代码。但也存在执行其他命令的潜在风险。
*   **代码逻辑：** 代码逻辑相对清晰，主要是发送请求、解析响应和执行命令。但作者可以加入一些恶意代码来增加风险。
*   **第三方库：** 使用了`requests`、`bs4`、`rich`等第三方库，这些库本身可能存在安全漏洞。

综合考虑，该PoC代码存在少量投毒风险，可能被利用执行未经授权的命令、搜集或窃取用户信息。 风险评估为1%。

**项目地址:** [Chocapikk/CVE-2023-27372](https://github.com/Chocapikk/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #5

**来源**: [CVE-2023-27372-G01d3nW01f_cve-2023-27372.md](../2023/CVE-2023-27372-G01d3nW01f_cve-2023-27372.md)

## CVE-2023-27372 - SPIP Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution

**影响应用:** SPIP

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 4.2.1

**利用条件:** SPIP 实例需要可公开访问，并且运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372 是 SPIP CMS 中的一个远程代码执行漏洞，源于对反序列化数据处理不当。攻击者可以利用此漏洞通过在公共区域的表单值中注入恶意序列化数据来执行任意代码。

**有效性分析：**
提供的 exploit.py 脚本利用了此漏洞。它首先从目标 URL 的 `/spip/spip.php?page=spip_pass` 获取 `formulaire_action_args` 参数。然后，它构造一个包含恶意 PHP 代码的 POST 请求，该代码使用 `system()` 函数执行攻击者提供的命令。该恶意 PHP 代码被序列化并作为 `oubli` 参数传递。脚本的成功执行表明漏洞是可利用的。

**投毒风险分析：**
查看 exploit.py 脚本，其主要功能是利用 CVE-2023-27372 漏洞实现远程代码执行。脚本首先获取目标 URL，然后构造恶意 payload 并发送 POST 请求。脚本本身没有明显的恶意行为，如植入后门或传播恶意软件。
但是，该脚本本身依赖于用户提供的命令来执行 RCE。如果用户不小心执行了包含恶意命令的脚本，可能会导致目标系统受到损害。
在 readme.md 文件中，声明了 “education purpose only!!!!!”，降低了投毒的可能性。
仓库中，可能存在投毒代码的风险较低，约为 10%。

**利用方式：**
1.  攻击者向 SPIP 站点的 `/spip/spip.php?page=spip_pass` 发送 GET 请求。
2.  攻击者解析响应，提取 `formulaire_action_args` 参数。
3.  攻击者构造一个 POST 请求，将 `formulaire_action` 设置为 `oubli`，`formulaire_action_args` 设置为提取的值，并将恶意 PHP 代码序列化后作为 `oubli` 参数的值发送。
4.  SPIP 在处理 POST 请求时，反序列化 `oubli` 参数的值，导致恶意 PHP 代码被执行，从而实现远程代码执行。

**项目地址:** [G01d3nW01f/cve-2023-27372](https://github.com/G01d3nW01f/cve-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #6

**来源**: [CVE-2023-27372-ThatNotEasy_CVE-2023-27372.md](../2023/CVE-2023-27372-ThatNotEasy_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 目标网站必须运行存在漏洞的SPIP版本，且漏洞利用点对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP内容管理系统4.2.1之前版本中的一个远程代码执行漏洞。该漏洞源于SPIP处理反序列化数据的方式不当，允许未经身份验证的攻击者通过表单值执行任意命令。根据提供的漏洞利用代码，攻击者可以指定一个包含多个URL的文件和一个要执行的命令。该脚本会向这些URL发送特制的请求，其中包含序列化的恶意payload，从而在目标服务器上执行指定的命令，获取web用户权限。该漏洞利用代码的投毒风险较低，主要风险在于使用者自身行为，利用此工具进行未授权的渗透测试或攻击。因为代码中包含从 `lib/ua.txt` 读取 User-Agent 的操作，以及输出文件功能，存在一定的信息收集行为，可能用于后期攻击，但总体上代码逻辑清晰，风险可控。

**利用方式：**

1.  **漏洞定位：** SPIP 4.2.1之前的版本存在反序列化漏洞，具体位置在`oubli`参数中，允许在公共区域提交的表单值。
2.  **攻击流程：**
    *   攻击者构造包含恶意代码的序列化payload。
    *   将payload作为表单值提交给存在漏洞的SPIP站点。
    *   SPIP站点反序列化该数据时，恶意代码被执行。
3.  **漏洞利用代码分析：**
    *   `spip.py`脚本接受目标URL列表和要执行的命令作为参数。
    *   脚本使用`requests`库发送HTTP请求，将序列化的payload包含在POST请求的参数中。
    *   服务器端反序列化payload，执行攻击者指定的命令。
4.  **缓解措施：**
    *   将SPIP升级到3.2.18, 4.0.10, 4.1.8, 或 4.2.1及以上版本。
    *   限制对SPIP站点的公共访问。

**项目地址:** [ThatNotEasy/CVE-2023-27372](https://github.com/ThatNotEasy/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #7

**来源**: [CVE-2023-27372-dream434_CVE-2023-27372.md](../2023/CVE-2023-27372-dream434_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要目标SPIP站点存在漏洞页面且可公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27372 是 SPIP 内容管理系统（CMS）中存在的一个远程代码执行漏洞。该漏洞源于 SPIP 在处理表单值时，由于对序列化数据处理不当，导致攻击者可以通过构造恶意的序列化数据，将其作为表单参数提交到存在漏洞的页面，从而在服务器端执行任意代码。

**有效性：**

根据漏洞信息和搜索结果，提供的 POC 代码是有效的。多个资源（如 Packet Storm 和 GitHub 上的 Chocapikk/CVE-2023-27372）都提供了可用于利用该漏洞的 POC 或扫描器。

**投毒风险：**

代码中存在轻微的投毒风险。主要风险点在于：

*   **依赖项安装错误引导:** README.md文件引导用户安装 `collorama` , 正确的安装包应该是 `colorama`，如果用户安装了恶意攻击者伪造的 `collorama` 包，则可能存在安全风险。 *   **执行任意命令：** POC 允许执行任意命令。如果攻击者修改了 POC 中的 `whoami` 命令，替换为恶意命令，可能会造成更大的危害。例如，删除服务器文件、安装恶意软件等。但这种风险主要取决于使用者如何使用 POC，而非 POC 本身包含恶意代码。

考虑到这些因素，我将投毒风险评估为 5%。主要是安装包名称拼写错误引导，存在被利用的可能性。

**利用方式：**

1.  **查找目标：** 寻找运行 SPIP 且版本低于 4.2.1 的站点。
2.  **构造Payload：** 攻击者构造包含恶意 PHP 代码的序列化数据。
3.  **获取CSRF Token：** 首先，向 `/spip.php?page=spip_pass` 页面发起 GET 请求，解析 HTML 响应，提取名为 `formulaire_action_args` 的隐藏输入字段中的 CSRF token。
4.  **发送恶意请求：** 将构造的序列化数据作为 `oubli` 参数的值，连同其他必要的表单参数（包括上一步获取的 CSRF token）通过 POST 请求发送到 `/spip.php?page=spip_pass` 页面。
5.  **代码执行：** SPIP 在处理表单数据时，反序列化 `oubli` 参数，从而执行攻击者注入的恶意 PHP 代码。

简而言之，利用方式是通过构造包含恶意代码的序列化数据，并将其作为表单参数提交到 SPIP 站点，从而实现远程代码执行。

**项目地址:** [dream434/CVE-2023-27372](https://github.com/dream434/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #8

**来源**: [CVE-2023-27372-izzz0_CVE-2023-27372-POC.md](../2023/CVE-2023-27372-izzz0_CVE-2023-27372-POC.md)

## CVE-2023-27372-SPIP远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 目标服务器运行存在漏洞的SPIP版本，且漏洞利用发生在公共区域，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP 4.2.1之前版本中的一个远程代码执行漏洞。该漏洞是由于SPIP处理表单值中的序列化数据不当造成的。攻击者可以通过在公共区域提交包含恶意序列化数据的表单值来利用此漏洞，从而执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，该漏洞是有效的。POC代码通过构造特定的POST请求，向`spip.php?page=spip_pass`页面提交包含恶意PHP代码的序列化字符串，利用SPIP的反序列化漏洞执行代码。如果服务器返回包含`phpinfo()`结果的页面，则表明存在漏洞。

**投毒风险：**
代码主体逻辑是漏洞验证，风险较低。但仍然存在一定的投毒风险，因为攻击者可能修改POC代码，使其包含恶意操作，例如：

*   **植入后门:** POC中可以加入执行任意系统命令的代码，从而在目标服务器上植入后门。
*   **数据窃取:** POC可以被修改为窃取服务器上的敏感数据，例如数据库凭据或配置文件。
*   **拒绝服务攻击:** POC可以被修改为发送大量请求，导致目标服务器过载，从而造成拒绝服务攻击。
POC 使用 phpinfo() 验证，比较安全，但潜在风险依然存在。因此，投毒风险评估为10%。

**利用方式：**
1.  确定目标网站运行的SPIP版本低于4.2.1。
2.  向`spip.php?page=spip_pass`页面发送包含以下参数的POST请求：
    *   `formulaire_action=oubli`
    *   `formulaire_action_args`：从页面中提取的`formulaire_action_args`字段的值，进行URL编码。
    *   `oubli`: 包含恶意PHP代码的序列化字符串，例如`s:19:"<?php phpinfo(); ?>";`
    *   `nobot`：任意值，用于绕过反爬机制
3.  如果服务器返回包含恶意PHP代码执行结果的页面，则表明漏洞利用成功。例如，如果使用`phpinfo()`，则会返回phpinfo页面，或者反序列化任意类的函数，执行恶意代码。

**项目地址:** [izzz0/CVE-2023-27372-POC](https://github.com/izzz0/CVE-2023-27372-POC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #9

**来源**: [CVE-2023-27372-nuts7_CVE-2023-27372.md](../2023/CVE-2023-27372-nuts7_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要能够访问SPIP的登录页面或存在`spip_pass`页面的公开访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27372是SPIP 4.2.1之前的版本中的一个远程代码执行漏洞，原因是程序在处理表单值中的序列化数据时存在缺陷。攻击者可以通过在公共区域提交包含恶意序列化数据的表单，从而执行任意代码。PoC代码显示，它首先获取一个Anti-CSRF token，然后构造一个包含PHP代码的payload，该代码会执行指定的系统命令。这个漏洞的利用方式是，攻击者先访问登录页面 (`spip.php?page=spip_pass`)，获取`formulaire_action_args`的值 (Anti-CSRF token)。然后，攻击者构造一个POST请求，其中包含`page=spip_pass`， `formulaire_action=oubli`, `formulaire_action_args`为之前获取的CSRF token的值，并且`oubli`参数的值为精心构造的PHP序列化字符串，这个序列化字符串包含要执行的PHP代码 (使用 `system()`函数执行命令)。由于SPIP在反序列化这个`oubli`参数时存在漏洞，这会导致恶意代码执行。 

**有效性:** PoC代码有效，成功利用该漏洞能够在目标服务器上执行任意命令。

**投毒风险:** 经过检查`CVE-2023-27372.py`，`CVE-2023-27372.yaml`，`Dockerfile`和`README.md`文件。没有发现明显的恶意代码或者后门。`Dockerfile`用于构建一个包含易受攻击版本SPIP的环境，用于测试和演示漏洞。`CVE-2023-27372.yaml`是一个nuclei模板，用于检测目标是否存在此漏洞，该模板尝试执行phpinfo()，证明可以执行恶意代码。`README.md`提供有关漏洞的信息。

**利用方式:**

1.  **获取Anti-CSRF Token:**  访问受影响的SPIP站点的登录页面（`spip.php?page=spip_pass`），提取`formulaire_action_args`字段的值，即Anti-CSRF token。
2.  **构造Payload:**  构造一个包含恶意PHP代码的序列化字符串，例如`s:28:"<?php system('whoami'); ?>";`。这个字符串的长度需要根据实际的PHP代码长度进行调整。
3.  **发送Payload:**  通过POST请求将构造的Payload发送到`spip.php?page=spip_pass`，同时包含Anti-CSRF token和必要的表单参数。
4.  **执行代码:**  服务器在处理请求时，由于反序列化漏洞，会执行Payload中的PHP代码，从而实现远程代码执行。

**项目地址:** [nuts7/CVE-2023-27372](https://github.com/nuts7/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #10

**来源**: [CVE-2023-27372-redboltsec_CVE-2023-27372-PoC.md](../2023/CVE-2023-27372-redboltsec_CVE-2023-27372-PoC.md)

## CVE-2023-27372 SPIP RCE

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 4.2.1 (受影响版本包括3.2.18之前, 4.0.10之前, 4.1.8之前)

**利用条件:** 目标SPIP站点存在且可访问spip_pass页面，不需要任何权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27372 漏洞存在于 SPIP 4.2.1 之前的版本，允许未经身份验证的远程攻击者通过 `spip.php?page=spip_pass` 页面的 form values 执行任意代码。该漏洞源于 `ecrire/balise/formulaire_.php` 文件中 `protege_champ` 函数对序列化数据处理不当，未进行充分的输入验证，导致反序列化漏洞。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。Packet Storm Security 和 GitHub (Chocapikk/CVE-2023-27372) 都提供了漏洞利用代码或扫描器，证明该漏洞是可以被利用的。POC 代码通过构造恶意的序列化字符串，并将其作为 `oubli` 参数的值发送到 `spip.php?page=spip_pass` 页面，从而触发反序列化漏洞。

**投毒风险：**
分析提供的 PoC 代码 (`cve-2023-27372.py`)，未发现明显的投毒代码。该脚本的主要功能是：

1.  获取 CSRF token (如果存在)。
2.  构造包含恶意 PHP 代码的序列化 payload，该代码使用 `exec` 函数执行命令。
3.  将 payload 发送到目标 SPIP 站点。
4.  解析响应，提取命令执行结果。

脚本本身没有执行任何与目标系统无关的操作，例如上传恶意文件、修改系统配置或连接到外部服务器。因此，投毒风险较低。

**利用方式：**

1.  **定位目标:**  确定存在漏洞的 SPIP 站点，版本低于 4.2.1，且允许公共访问 `spip.php?page=spip_pass` 页面。
2.  **获取 CSRF Token (如果需要):** 访问 `spip.php?page=spip_pass` 页面，提取 CSRF token (`formulaire_action_args`)。有些情况下，可能不需要 CSRF token。
3.  **构造 Payload:**  构造包含恶意 PHP 代码的序列化字符串，用于执行任意命令。例如，使用 `<?php system($_GET['cmd']); ?>` 来执行 GET 请求中的 `cmd` 参数指定的命令。
4.  **发送 Payload:**  将构造的 Payload 作为 `oubli` 参数的值，通过 POST 请求发送到 `spip.php?page=spip_pass` 页面，同时附带 CSRF token (如果需要)。
5.  **执行命令:**  如果 Payload 成功执行，则可以通过构造特定的 HTTP 请求来执行任意命令。例如，访问 `spip.php?page=spip_pass&cmd=whoami` 来执行 `whoami` 命令，获取当前用户。
6.  **交互式 Shell (POC代码)**: PoC中尝试使用`whoami`检测是否RCE成功，如果失败，PoC会尝试生成一个交互式shell。这部分代码可能存在问题，需要用户多次输入命令。

**缓解措施：**
升级到 SPIP 4.2.1 或更高版本，或者应用补丁以修复反序列化漏洞。


**项目地址:** [redboltsec/CVE-2023-27372-PoC](https://github.com/redboltsec/CVE-2023-27372-PoC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---



---

## POC #3

**来源**: [CVE-2023-27372-1amthebest1_CVE-2023-27372.md](../2023/CVE-2023-27372-1amthebest1_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1 (受影响版本还包括3.2.x, 4.0.x, 4.1.x)

**利用条件:** 需要能够通过网络访问SPIP站点，且SPIP版本低于4.2.1，未应用安全补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27372 是 SPIP 4.2.1 之前版本中的一个远程代码执行 (RCE) 漏洞。该漏洞的根本原因是程序未正确处理反序列化数据，导致攻击者可以通过构造恶意表单值，在服务器上执行任意代码。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判断该PoC代码有效。
- 漏洞库信息明确指出SPIP在4.2.1之前的版本存在RCE漏洞，并通过不安全的反序列化来实现。
- 搜索引擎结果也证实了该漏洞的存在，并提供了多个漏洞分析和利用链接。
- PoC代码通过利用`spip_pass`页面中的`oubli`参数，传递一个包含PHP代码的序列化字符串，从而执行任意命令。该代码首先获取CSRF token，然后构造包含恶意PHP代码的payload，并发送POST请求到`spip.php?page=spip_pass`。恶意PHP代码使用`system`函数执行经过base64编码的命令。

**投毒风险分析：**
仔细检查了提供的PoC代码，没有发现明显的投毒代码。该代码结构清晰，功能明确，主要用于验证和利用漏洞。风险百分比评估为0%。

**利用方式：**
1.  **漏洞定位：** 该漏洞存在于 SPIP 的前台页面，攻击者无需认证即可利用。
2.  **CSRF Token 获取：** 攻击者首先访问 `spip.php?page=spip_pass` 页面，从中提取 CSRF Token，用于绕过 CSRF 保护。
3.  **Payload 构造：** 攻击者构造一个包含恶意 PHP 代码的序列化字符串。该 PHP 代码通常使用 `system()` 函数执行任意命令。为了避免过滤，命令通常会进行 base64 编码。
4.  **漏洞触发：** 攻击者将构造好的 Payload 放入 `oubli` 参数中，通过 POST 请求发送到 `spip.php?page=spip_pass` 页面，触发反序列化漏洞，从而执行任意代码。
5.  **反弹shell:** 通过反弹shell获得目标机器的权限。


**项目地址:** [1amthebest1/CVE-2023-27372](https://github.com/1amthebest1/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #4

**来源**: [CVE-2023-27372-Chocapikk_CVE-2023-27372.md](../2023/CVE-2023-27372-Chocapikk_CVE-2023-27372.md)

## CVE-2023-27372 SPIP Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要目标SPIP站点存在，且能访问其spip.php?page=spip_pass页面

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27372是SPIP CMS 4.2.1之前版本中的一个远程代码执行漏洞。该漏洞源于程序在处理表单值时，反序列化过程存在缺陷。未经身份验证的攻击者可以通过向易受攻击的SPIP实例上的spip.php?page=spip_pass页面提交特制的表单值，从而利用此漏洞执行任意代码。

**漏洞利用方式：**

1.  **获取Anti-CSRF Token：** PoC脚本首先访问`spip.php?page=spip_pass`页面，解析HTML，提取名为`formulaire_action_args`的input标签中的`value`属性，该值用作Anti-CSRF token。
2.  **构造恶意Payload：**  PoC脚本使用PHP序列化的方式构造恶意代码，通过`oubli`参数传递给`spip.php?page=spip_pass`。
3.  **发送POST请求：**  将包含Anti-CSRF token和恶意payload的POST请求发送到`spip.php?page=spip_pass`，触发反序列化漏洞，从而执行任意代码。
4.  **解析输出：**PoC脚本使用正则表达式提取命令执行结果，如果执行`whoami`成功则认为漏洞存在。

**有效性：**

根据漏洞库信息、搜索结果，以及提供的PoC代码，可以确定该漏洞是真实存在的，并且该PoC代码看起来可以有效利用该漏洞实现远程代码执行。

**投毒风险：**

检查PoC代码发现，该脚本的功能主要是利用CVE-2023-27372漏洞进行RCE验证。通过以下几个方面评估投毒风险：

*   **LeakIX API Key配置:** 脚本中`LEAKIX_API_KEY` 变量需要用户自己配置LeakIX API Key，如果用户不配置则无法从LeakIX获取SPIP URLs。
*   **Payload执行命令:** Payload中执行的命令是`whoami`，这是一个相对安全的命令，用于判断是否成功执行代码。但也存在执行其他命令的潜在风险。
*   **代码逻辑：** 代码逻辑相对清晰，主要是发送请求、解析响应和执行命令。但作者可以加入一些恶意代码来增加风险。
*   **第三方库：** 使用了`requests`、`bs4`、`rich`等第三方库，这些库本身可能存在安全漏洞。

综合考虑，该PoC代码存在少量投毒风险，可能被利用执行未经授权的命令、搜集或窃取用户信息。 风险评估为1%。

**项目地址:** [Chocapikk/CVE-2023-27372](https://github.com/Chocapikk/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #5

**来源**: [CVE-2023-27372-G01d3nW01f_cve-2023-27372.md](../2023/CVE-2023-27372-G01d3nW01f_cve-2023-27372.md)

## CVE-2023-27372 - SPIP Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution

**影响应用:** SPIP

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 4.2.1

**利用条件:** SPIP 实例需要可公开访问，并且运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372 是 SPIP CMS 中的一个远程代码执行漏洞，源于对反序列化数据处理不当。攻击者可以利用此漏洞通过在公共区域的表单值中注入恶意序列化数据来执行任意代码。

**有效性分析：**
提供的 exploit.py 脚本利用了此漏洞。它首先从目标 URL 的 `/spip/spip.php?page=spip_pass` 获取 `formulaire_action_args` 参数。然后，它构造一个包含恶意 PHP 代码的 POST 请求，该代码使用 `system()` 函数执行攻击者提供的命令。该恶意 PHP 代码被序列化并作为 `oubli` 参数传递。脚本的成功执行表明漏洞是可利用的。

**投毒风险分析：**
查看 exploit.py 脚本，其主要功能是利用 CVE-2023-27372 漏洞实现远程代码执行。脚本首先获取目标 URL，然后构造恶意 payload 并发送 POST 请求。脚本本身没有明显的恶意行为，如植入后门或传播恶意软件。
但是，该脚本本身依赖于用户提供的命令来执行 RCE。如果用户不小心执行了包含恶意命令的脚本，可能会导致目标系统受到损害。
在 readme.md 文件中，声明了 “education purpose only!!!!!”，降低了投毒的可能性。
仓库中，可能存在投毒代码的风险较低，约为 10%。

**利用方式：**
1.  攻击者向 SPIP 站点的 `/spip/spip.php?page=spip_pass` 发送 GET 请求。
2.  攻击者解析响应，提取 `formulaire_action_args` 参数。
3.  攻击者构造一个 POST 请求，将 `formulaire_action` 设置为 `oubli`，`formulaire_action_args` 设置为提取的值，并将恶意 PHP 代码序列化后作为 `oubli` 参数的值发送。
4.  SPIP 在处理 POST 请求时，反序列化 `oubli` 参数的值，导致恶意 PHP 代码被执行，从而实现远程代码执行。

**项目地址:** [G01d3nW01f/cve-2023-27372](https://github.com/G01d3nW01f/cve-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #6

**来源**: [CVE-2023-27372-ThatNotEasy_CVE-2023-27372.md](../2023/CVE-2023-27372-ThatNotEasy_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 目标网站必须运行存在漏洞的SPIP版本，且漏洞利用点对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP内容管理系统4.2.1之前版本中的一个远程代码执行漏洞。该漏洞源于SPIP处理反序列化数据的方式不当，允许未经身份验证的攻击者通过表单值执行任意命令。根据提供的漏洞利用代码，攻击者可以指定一个包含多个URL的文件和一个要执行的命令。该脚本会向这些URL发送特制的请求，其中包含序列化的恶意payload，从而在目标服务器上执行指定的命令，获取web用户权限。该漏洞利用代码的投毒风险较低，主要风险在于使用者自身行为，利用此工具进行未授权的渗透测试或攻击。因为代码中包含从 `lib/ua.txt` 读取 User-Agent 的操作，以及输出文件功能，存在一定的信息收集行为，可能用于后期攻击，但总体上代码逻辑清晰，风险可控。

**利用方式：**

1.  **漏洞定位：** SPIP 4.2.1之前的版本存在反序列化漏洞，具体位置在`oubli`参数中，允许在公共区域提交的表单值。
2.  **攻击流程：**
    *   攻击者构造包含恶意代码的序列化payload。
    *   将payload作为表单值提交给存在漏洞的SPIP站点。
    *   SPIP站点反序列化该数据时，恶意代码被执行。
3.  **漏洞利用代码分析：**
    *   `spip.py`脚本接受目标URL列表和要执行的命令作为参数。
    *   脚本使用`requests`库发送HTTP请求，将序列化的payload包含在POST请求的参数中。
    *   服务器端反序列化payload，执行攻击者指定的命令。
4.  **缓解措施：**
    *   将SPIP升级到3.2.18, 4.0.10, 4.1.8, 或 4.2.1及以上版本。
    *   限制对SPIP站点的公共访问。

**项目地址:** [ThatNotEasy/CVE-2023-27372](https://github.com/ThatNotEasy/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #7

**来源**: [CVE-2023-27372-dream434_CVE-2023-27372.md](../2023/CVE-2023-27372-dream434_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要目标SPIP站点存在漏洞页面且可公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27372 是 SPIP 内容管理系统（CMS）中存在的一个远程代码执行漏洞。该漏洞源于 SPIP 在处理表单值时，由于对序列化数据处理不当，导致攻击者可以通过构造恶意的序列化数据，将其作为表单参数提交到存在漏洞的页面，从而在服务器端执行任意代码。

**有效性：**

根据漏洞信息和搜索结果，提供的 POC 代码是有效的。多个资源（如 Packet Storm 和 GitHub 上的 Chocapikk/CVE-2023-27372）都提供了可用于利用该漏洞的 POC 或扫描器。

**投毒风险：**

代码中存在轻微的投毒风险。主要风险点在于：

*   **依赖项安装错误引导:** README.md文件引导用户安装 `collorama` , 正确的安装包应该是 `colorama`，如果用户安装了恶意攻击者伪造的 `collorama` 包，则可能存在安全风险。 *   **执行任意命令：** POC 允许执行任意命令。如果攻击者修改了 POC 中的 `whoami` 命令，替换为恶意命令，可能会造成更大的危害。例如，删除服务器文件、安装恶意软件等。但这种风险主要取决于使用者如何使用 POC，而非 POC 本身包含恶意代码。

考虑到这些因素，我将投毒风险评估为 5%。主要是安装包名称拼写错误引导，存在被利用的可能性。

**利用方式：**

1.  **查找目标：** 寻找运行 SPIP 且版本低于 4.2.1 的站点。
2.  **构造Payload：** 攻击者构造包含恶意 PHP 代码的序列化数据。
3.  **获取CSRF Token：** 首先，向 `/spip.php?page=spip_pass` 页面发起 GET 请求，解析 HTML 响应，提取名为 `formulaire_action_args` 的隐藏输入字段中的 CSRF token。
4.  **发送恶意请求：** 将构造的序列化数据作为 `oubli` 参数的值，连同其他必要的表单参数（包括上一步获取的 CSRF token）通过 POST 请求发送到 `/spip.php?page=spip_pass` 页面。
5.  **代码执行：** SPIP 在处理表单数据时，反序列化 `oubli` 参数，从而执行攻击者注入的恶意 PHP 代码。

简而言之，利用方式是通过构造包含恶意代码的序列化数据，并将其作为表单参数提交到 SPIP 站点，从而实现远程代码执行。

**项目地址:** [dream434/CVE-2023-27372](https://github.com/dream434/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #8

**来源**: [CVE-2023-27372-izzz0_CVE-2023-27372-POC.md](../2023/CVE-2023-27372-izzz0_CVE-2023-27372-POC.md)

## CVE-2023-27372-SPIP远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 目标服务器运行存在漏洞的SPIP版本，且漏洞利用发生在公共区域，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP 4.2.1之前版本中的一个远程代码执行漏洞。该漏洞是由于SPIP处理表单值中的序列化数据不当造成的。攻击者可以通过在公共区域提交包含恶意序列化数据的表单值来利用此漏洞，从而执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，该漏洞是有效的。POC代码通过构造特定的POST请求，向`spip.php?page=spip_pass`页面提交包含恶意PHP代码的序列化字符串，利用SPIP的反序列化漏洞执行代码。如果服务器返回包含`phpinfo()`结果的页面，则表明存在漏洞。

**投毒风险：**
代码主体逻辑是漏洞验证，风险较低。但仍然存在一定的投毒风险，因为攻击者可能修改POC代码，使其包含恶意操作，例如：

*   **植入后门:** POC中可以加入执行任意系统命令的代码，从而在目标服务器上植入后门。
*   **数据窃取:** POC可以被修改为窃取服务器上的敏感数据，例如数据库凭据或配置文件。
*   **拒绝服务攻击:** POC可以被修改为发送大量请求，导致目标服务器过载，从而造成拒绝服务攻击。
POC 使用 phpinfo() 验证，比较安全，但潜在风险依然存在。因此，投毒风险评估为10%。

**利用方式：**
1.  确定目标网站运行的SPIP版本低于4.2.1。
2.  向`spip.php?page=spip_pass`页面发送包含以下参数的POST请求：
    *   `formulaire_action=oubli`
    *   `formulaire_action_args`：从页面中提取的`formulaire_action_args`字段的值，进行URL编码。
    *   `oubli`: 包含恶意PHP代码的序列化字符串，例如`s:19:"<?php phpinfo(); ?>";`
    *   `nobot`：任意值，用于绕过反爬机制
3.  如果服务器返回包含恶意PHP代码执行结果的页面，则表明漏洞利用成功。例如，如果使用`phpinfo()`，则会返回phpinfo页面，或者反序列化任意类的函数，执行恶意代码。

**项目地址:** [izzz0/CVE-2023-27372-POC](https://github.com/izzz0/CVE-2023-27372-POC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #9

**来源**: [CVE-2023-27372-nuts7_CVE-2023-27372.md](../2023/CVE-2023-27372-nuts7_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要能够访问SPIP的登录页面或存在`spip_pass`页面的公开访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27372是SPIP 4.2.1之前的版本中的一个远程代码执行漏洞，原因是程序在处理表单值中的序列化数据时存在缺陷。攻击者可以通过在公共区域提交包含恶意序列化数据的表单，从而执行任意代码。PoC代码显示，它首先获取一个Anti-CSRF token，然后构造一个包含PHP代码的payload，该代码会执行指定的系统命令。这个漏洞的利用方式是，攻击者先访问登录页面 (`spip.php?page=spip_pass`)，获取`formulaire_action_args`的值 (Anti-CSRF token)。然后，攻击者构造一个POST请求，其中包含`page=spip_pass`， `formulaire_action=oubli`, `formulaire_action_args`为之前获取的CSRF token的值，并且`oubli`参数的值为精心构造的PHP序列化字符串，这个序列化字符串包含要执行的PHP代码 (使用 `system()`函数执行命令)。由于SPIP在反序列化这个`oubli`参数时存在漏洞，这会导致恶意代码执行。 

**有效性:** PoC代码有效，成功利用该漏洞能够在目标服务器上执行任意命令。

**投毒风险:** 经过检查`CVE-2023-27372.py`，`CVE-2023-27372.yaml`，`Dockerfile`和`README.md`文件。没有发现明显的恶意代码或者后门。`Dockerfile`用于构建一个包含易受攻击版本SPIP的环境，用于测试和演示漏洞。`CVE-2023-27372.yaml`是一个nuclei模板，用于检测目标是否存在此漏洞，该模板尝试执行phpinfo()，证明可以执行恶意代码。`README.md`提供有关漏洞的信息。

**利用方式:**

1.  **获取Anti-CSRF Token:**  访问受影响的SPIP站点的登录页面（`spip.php?page=spip_pass`），提取`formulaire_action_args`字段的值，即Anti-CSRF token。
2.  **构造Payload:**  构造一个包含恶意PHP代码的序列化字符串，例如`s:28:"<?php system('whoami'); ?>";`。这个字符串的长度需要根据实际的PHP代码长度进行调整。
3.  **发送Payload:**  通过POST请求将构造的Payload发送到`spip.php?page=spip_pass`，同时包含Anti-CSRF token和必要的表单参数。
4.  **执行代码:**  服务器在处理请求时，由于反序列化漏洞，会执行Payload中的PHP代码，从而实现远程代码执行。

**项目地址:** [nuts7/CVE-2023-27372](https://github.com/nuts7/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #10

**来源**: [CVE-2023-27372-redboltsec_CVE-2023-27372-PoC.md](../2023/CVE-2023-27372-redboltsec_CVE-2023-27372-PoC.md)

## CVE-2023-27372 SPIP RCE

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 4.2.1 (受影响版本包括3.2.18之前, 4.0.10之前, 4.1.8之前)

**利用条件:** 目标SPIP站点存在且可访问spip_pass页面，不需要任何权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27372 漏洞存在于 SPIP 4.2.1 之前的版本，允许未经身份验证的远程攻击者通过 `spip.php?page=spip_pass` 页面的 form values 执行任意代码。该漏洞源于 `ecrire/balise/formulaire_.php` 文件中 `protege_champ` 函数对序列化数据处理不当，未进行充分的输入验证，导致反序列化漏洞。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。Packet Storm Security 和 GitHub (Chocapikk/CVE-2023-27372) 都提供了漏洞利用代码或扫描器，证明该漏洞是可以被利用的。POC 代码通过构造恶意的序列化字符串，并将其作为 `oubli` 参数的值发送到 `spip.php?page=spip_pass` 页面，从而触发反序列化漏洞。

**投毒风险：**
分析提供的 PoC 代码 (`cve-2023-27372.py`)，未发现明显的投毒代码。该脚本的主要功能是：

1.  获取 CSRF token (如果存在)。
2.  构造包含恶意 PHP 代码的序列化 payload，该代码使用 `exec` 函数执行命令。
3.  将 payload 发送到目标 SPIP 站点。
4.  解析响应，提取命令执行结果。

脚本本身没有执行任何与目标系统无关的操作，例如上传恶意文件、修改系统配置或连接到外部服务器。因此，投毒风险较低。

**利用方式：**

1.  **定位目标:**  确定存在漏洞的 SPIP 站点，版本低于 4.2.1，且允许公共访问 `spip.php?page=spip_pass` 页面。
2.  **获取 CSRF Token (如果需要):** 访问 `spip.php?page=spip_pass` 页面，提取 CSRF token (`formulaire_action_args`)。有些情况下，可能不需要 CSRF token。
3.  **构造 Payload:**  构造包含恶意 PHP 代码的序列化字符串，用于执行任意命令。例如，使用 `<?php system($_GET['cmd']); ?>` 来执行 GET 请求中的 `cmd` 参数指定的命令。
4.  **发送 Payload:**  将构造的 Payload 作为 `oubli` 参数的值，通过 POST 请求发送到 `spip.php?page=spip_pass` 页面，同时附带 CSRF token (如果需要)。
5.  **执行命令:**  如果 Payload 成功执行，则可以通过构造特定的 HTTP 请求来执行任意命令。例如，访问 `spip.php?page=spip_pass&cmd=whoami` 来执行 `whoami` 命令，获取当前用户。
6.  **交互式 Shell (POC代码)**: PoC中尝试使用`whoami`检测是否RCE成功，如果失败，PoC会尝试生成一个交互式shell。这部分代码可能存在问题，需要用户多次输入命令。

**缓解措施：**
升级到 SPIP 4.2.1 或更高版本，或者应用补丁以修复反序列化漏洞。


**项目地址:** [redboltsec/CVE-2023-27372-PoC](https://github.com/redboltsec/CVE-2023-27372-PoC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---



---

## POC #3

**来源**: [CVE-2023-27372-1amthebest1_CVE-2023-27372.md](../2023/CVE-2023-27372-1amthebest1_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1 (受影响版本还包括3.2.x, 4.0.x, 4.1.x)

**利用条件:** 需要能够通过网络访问SPIP站点，且SPIP版本低于4.2.1，未应用安全补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27372 是 SPIP 4.2.1 之前版本中的一个远程代码执行 (RCE) 漏洞。该漏洞的根本原因是程序未正确处理反序列化数据，导致攻击者可以通过构造恶意表单值，在服务器上执行任意代码。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判断该PoC代码有效。
- 漏洞库信息明确指出SPIP在4.2.1之前的版本存在RCE漏洞，并通过不安全的反序列化来实现。
- 搜索引擎结果也证实了该漏洞的存在，并提供了多个漏洞分析和利用链接。
- PoC代码通过利用`spip_pass`页面中的`oubli`参数，传递一个包含PHP代码的序列化字符串，从而执行任意命令。该代码首先获取CSRF token，然后构造包含恶意PHP代码的payload，并发送POST请求到`spip.php?page=spip_pass`。恶意PHP代码使用`system`函数执行经过base64编码的命令。

**投毒风险分析：**
仔细检查了提供的PoC代码，没有发现明显的投毒代码。该代码结构清晰，功能明确，主要用于验证和利用漏洞。风险百分比评估为0%。

**利用方式：**
1.  **漏洞定位：** 该漏洞存在于 SPIP 的前台页面，攻击者无需认证即可利用。
2.  **CSRF Token 获取：** 攻击者首先访问 `spip.php?page=spip_pass` 页面，从中提取 CSRF Token，用于绕过 CSRF 保护。
3.  **Payload 构造：** 攻击者构造一个包含恶意 PHP 代码的序列化字符串。该 PHP 代码通常使用 `system()` 函数执行任意命令。为了避免过滤，命令通常会进行 base64 编码。
4.  **漏洞触发：** 攻击者将构造好的 Payload 放入 `oubli` 参数中，通过 POST 请求发送到 `spip.php?page=spip_pass` 页面，触发反序列化漏洞，从而执行任意代码。
5.  **反弹shell:** 通过反弹shell获得目标机器的权限。


**项目地址:** [1amthebest1/CVE-2023-27372](https://github.com/1amthebest1/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #4

**来源**: [CVE-2023-27372-Chocapikk_CVE-2023-27372.md](../2023/CVE-2023-27372-Chocapikk_CVE-2023-27372.md)

## CVE-2023-27372 SPIP Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要目标SPIP站点存在，且能访问其spip.php?page=spip_pass页面

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27372是SPIP CMS 4.2.1之前版本中的一个远程代码执行漏洞。该漏洞源于程序在处理表单值时，反序列化过程存在缺陷。未经身份验证的攻击者可以通过向易受攻击的SPIP实例上的spip.php?page=spip_pass页面提交特制的表单值，从而利用此漏洞执行任意代码。

**漏洞利用方式：**

1.  **获取Anti-CSRF Token：** PoC脚本首先访问`spip.php?page=spip_pass`页面，解析HTML，提取名为`formulaire_action_args`的input标签中的`value`属性，该值用作Anti-CSRF token。
2.  **构造恶意Payload：**  PoC脚本使用PHP序列化的方式构造恶意代码，通过`oubli`参数传递给`spip.php?page=spip_pass`。
3.  **发送POST请求：**  将包含Anti-CSRF token和恶意payload的POST请求发送到`spip.php?page=spip_pass`，触发反序列化漏洞，从而执行任意代码。
4.  **解析输出：**PoC脚本使用正则表达式提取命令执行结果，如果执行`whoami`成功则认为漏洞存在。

**有效性：**

根据漏洞库信息、搜索结果，以及提供的PoC代码，可以确定该漏洞是真实存在的，并且该PoC代码看起来可以有效利用该漏洞实现远程代码执行。

**投毒风险：**

检查PoC代码发现，该脚本的功能主要是利用CVE-2023-27372漏洞进行RCE验证。通过以下几个方面评估投毒风险：

*   **LeakIX API Key配置:** 脚本中`LEAKIX_API_KEY` 变量需要用户自己配置LeakIX API Key，如果用户不配置则无法从LeakIX获取SPIP URLs。
*   **Payload执行命令:** Payload中执行的命令是`whoami`，这是一个相对安全的命令，用于判断是否成功执行代码。但也存在执行其他命令的潜在风险。
*   **代码逻辑：** 代码逻辑相对清晰，主要是发送请求、解析响应和执行命令。但作者可以加入一些恶意代码来增加风险。
*   **第三方库：** 使用了`requests`、`bs4`、`rich`等第三方库，这些库本身可能存在安全漏洞。

综合考虑，该PoC代码存在少量投毒风险，可能被利用执行未经授权的命令、搜集或窃取用户信息。 风险评估为1%。

**项目地址:** [Chocapikk/CVE-2023-27372](https://github.com/Chocapikk/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #5

**来源**: [CVE-2023-27372-G01d3nW01f_cve-2023-27372.md](../2023/CVE-2023-27372-G01d3nW01f_cve-2023-27372.md)

## CVE-2023-27372 - SPIP Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution

**影响应用:** SPIP

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 4.2.1

**利用条件:** SPIP 实例需要可公开访问，并且运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372 是 SPIP CMS 中的一个远程代码执行漏洞，源于对反序列化数据处理不当。攻击者可以利用此漏洞通过在公共区域的表单值中注入恶意序列化数据来执行任意代码。

**有效性分析：**
提供的 exploit.py 脚本利用了此漏洞。它首先从目标 URL 的 `/spip/spip.php?page=spip_pass` 获取 `formulaire_action_args` 参数。然后，它构造一个包含恶意 PHP 代码的 POST 请求，该代码使用 `system()` 函数执行攻击者提供的命令。该恶意 PHP 代码被序列化并作为 `oubli` 参数传递。脚本的成功执行表明漏洞是可利用的。

**投毒风险分析：**
查看 exploit.py 脚本，其主要功能是利用 CVE-2023-27372 漏洞实现远程代码执行。脚本首先获取目标 URL，然后构造恶意 payload 并发送 POST 请求。脚本本身没有明显的恶意行为，如植入后门或传播恶意软件。
但是，该脚本本身依赖于用户提供的命令来执行 RCE。如果用户不小心执行了包含恶意命令的脚本，可能会导致目标系统受到损害。
在 readme.md 文件中，声明了 “education purpose only!!!!!”，降低了投毒的可能性。
仓库中，可能存在投毒代码的风险较低，约为 10%。

**利用方式：**
1.  攻击者向 SPIP 站点的 `/spip/spip.php?page=spip_pass` 发送 GET 请求。
2.  攻击者解析响应，提取 `formulaire_action_args` 参数。
3.  攻击者构造一个 POST 请求，将 `formulaire_action` 设置为 `oubli`，`formulaire_action_args` 设置为提取的值，并将恶意 PHP 代码序列化后作为 `oubli` 参数的值发送。
4.  SPIP 在处理 POST 请求时，反序列化 `oubli` 参数的值，导致恶意 PHP 代码被执行，从而实现远程代码执行。

**项目地址:** [G01d3nW01f/cve-2023-27372](https://github.com/G01d3nW01f/cve-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #6

**来源**: [CVE-2023-27372-ThatNotEasy_CVE-2023-27372.md](../2023/CVE-2023-27372-ThatNotEasy_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 目标网站必须运行存在漏洞的SPIP版本，且漏洞利用点对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP内容管理系统4.2.1之前版本中的一个远程代码执行漏洞。该漏洞源于SPIP处理反序列化数据的方式不当，允许未经身份验证的攻击者通过表单值执行任意命令。根据提供的漏洞利用代码，攻击者可以指定一个包含多个URL的文件和一个要执行的命令。该脚本会向这些URL发送特制的请求，其中包含序列化的恶意payload，从而在目标服务器上执行指定的命令，获取web用户权限。该漏洞利用代码的投毒风险较低，主要风险在于使用者自身行为，利用此工具进行未授权的渗透测试或攻击。因为代码中包含从 `lib/ua.txt` 读取 User-Agent 的操作，以及输出文件功能，存在一定的信息收集行为，可能用于后期攻击，但总体上代码逻辑清晰，风险可控。

**利用方式：**

1.  **漏洞定位：** SPIP 4.2.1之前的版本存在反序列化漏洞，具体位置在`oubli`参数中，允许在公共区域提交的表单值。
2.  **攻击流程：**
    *   攻击者构造包含恶意代码的序列化payload。
    *   将payload作为表单值提交给存在漏洞的SPIP站点。
    *   SPIP站点反序列化该数据时，恶意代码被执行。
3.  **漏洞利用代码分析：**
    *   `spip.py`脚本接受目标URL列表和要执行的命令作为参数。
    *   脚本使用`requests`库发送HTTP请求，将序列化的payload包含在POST请求的参数中。
    *   服务器端反序列化payload，执行攻击者指定的命令。
4.  **缓解措施：**
    *   将SPIP升级到3.2.18, 4.0.10, 4.1.8, 或 4.2.1及以上版本。
    *   限制对SPIP站点的公共访问。

**项目地址:** [ThatNotEasy/CVE-2023-27372](https://github.com/ThatNotEasy/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #7

**来源**: [CVE-2023-27372-dream434_CVE-2023-27372.md](../2023/CVE-2023-27372-dream434_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要目标SPIP站点存在漏洞页面且可公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27372 是 SPIP 内容管理系统（CMS）中存在的一个远程代码执行漏洞。该漏洞源于 SPIP 在处理表单值时，由于对序列化数据处理不当，导致攻击者可以通过构造恶意的序列化数据，将其作为表单参数提交到存在漏洞的页面，从而在服务器端执行任意代码。

**有效性：**

根据漏洞信息和搜索结果，提供的 POC 代码是有效的。多个资源（如 Packet Storm 和 GitHub 上的 Chocapikk/CVE-2023-27372）都提供了可用于利用该漏洞的 POC 或扫描器。

**投毒风险：**

代码中存在轻微的投毒风险。主要风险点在于：

*   **依赖项安装错误引导:** README.md文件引导用户安装 `collorama` , 正确的安装包应该是 `colorama`，如果用户安装了恶意攻击者伪造的 `collorama` 包，则可能存在安全风险。 *   **执行任意命令：** POC 允许执行任意命令。如果攻击者修改了 POC 中的 `whoami` 命令，替换为恶意命令，可能会造成更大的危害。例如，删除服务器文件、安装恶意软件等。但这种风险主要取决于使用者如何使用 POC，而非 POC 本身包含恶意代码。

考虑到这些因素，我将投毒风险评估为 5%。主要是安装包名称拼写错误引导，存在被利用的可能性。

**利用方式：**

1.  **查找目标：** 寻找运行 SPIP 且版本低于 4.2.1 的站点。
2.  **构造Payload：** 攻击者构造包含恶意 PHP 代码的序列化数据。
3.  **获取CSRF Token：** 首先，向 `/spip.php?page=spip_pass` 页面发起 GET 请求，解析 HTML 响应，提取名为 `formulaire_action_args` 的隐藏输入字段中的 CSRF token。
4.  **发送恶意请求：** 将构造的序列化数据作为 `oubli` 参数的值，连同其他必要的表单参数（包括上一步获取的 CSRF token）通过 POST 请求发送到 `/spip.php?page=spip_pass` 页面。
5.  **代码执行：** SPIP 在处理表单数据时，反序列化 `oubli` 参数，从而执行攻击者注入的恶意 PHP 代码。

简而言之，利用方式是通过构造包含恶意代码的序列化数据，并将其作为表单参数提交到 SPIP 站点，从而实现远程代码执行。

**项目地址:** [dream434/CVE-2023-27372](https://github.com/dream434/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #8

**来源**: [CVE-2023-27372-izzz0_CVE-2023-27372-POC.md](../2023/CVE-2023-27372-izzz0_CVE-2023-27372-POC.md)

## CVE-2023-27372-SPIP远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 目标服务器运行存在漏洞的SPIP版本，且漏洞利用发生在公共区域，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP 4.2.1之前版本中的一个远程代码执行漏洞。该漏洞是由于SPIP处理表单值中的序列化数据不当造成的。攻击者可以通过在公共区域提交包含恶意序列化数据的表单值来利用此漏洞，从而执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，该漏洞是有效的。POC代码通过构造特定的POST请求，向`spip.php?page=spip_pass`页面提交包含恶意PHP代码的序列化字符串，利用SPIP的反序列化漏洞执行代码。如果服务器返回包含`phpinfo()`结果的页面，则表明存在漏洞。

**投毒风险：**
代码主体逻辑是漏洞验证，风险较低。但仍然存在一定的投毒风险，因为攻击者可能修改POC代码，使其包含恶意操作，例如：

*   **植入后门:** POC中可以加入执行任意系统命令的代码，从而在目标服务器上植入后门。
*   **数据窃取:** POC可以被修改为窃取服务器上的敏感数据，例如数据库凭据或配置文件。
*   **拒绝服务攻击:** POC可以被修改为发送大量请求，导致目标服务器过载，从而造成拒绝服务攻击。
POC 使用 phpinfo() 验证，比较安全，但潜在风险依然存在。因此，投毒风险评估为10%。

**利用方式：**
1.  确定目标网站运行的SPIP版本低于4.2.1。
2.  向`spip.php?page=spip_pass`页面发送包含以下参数的POST请求：
    *   `formulaire_action=oubli`
    *   `formulaire_action_args`：从页面中提取的`formulaire_action_args`字段的值，进行URL编码。
    *   `oubli`: 包含恶意PHP代码的序列化字符串，例如`s:19:"<?php phpinfo(); ?>";`
    *   `nobot`：任意值，用于绕过反爬机制
3.  如果服务器返回包含恶意PHP代码执行结果的页面，则表明漏洞利用成功。例如，如果使用`phpinfo()`，则会返回phpinfo页面，或者反序列化任意类的函数，执行恶意代码。

**项目地址:** [izzz0/CVE-2023-27372-POC](https://github.com/izzz0/CVE-2023-27372-POC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #9

**来源**: [CVE-2023-27372-nuts7_CVE-2023-27372.md](../2023/CVE-2023-27372-nuts7_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要能够访问SPIP的登录页面或存在`spip_pass`页面的公开访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27372是SPIP 4.2.1之前的版本中的一个远程代码执行漏洞，原因是程序在处理表单值中的序列化数据时存在缺陷。攻击者可以通过在公共区域提交包含恶意序列化数据的表单，从而执行任意代码。PoC代码显示，它首先获取一个Anti-CSRF token，然后构造一个包含PHP代码的payload，该代码会执行指定的系统命令。这个漏洞的利用方式是，攻击者先访问登录页面 (`spip.php?page=spip_pass`)，获取`formulaire_action_args`的值 (Anti-CSRF token)。然后，攻击者构造一个POST请求，其中包含`page=spip_pass`， `formulaire_action=oubli`, `formulaire_action_args`为之前获取的CSRF token的值，并且`oubli`参数的值为精心构造的PHP序列化字符串，这个序列化字符串包含要执行的PHP代码 (使用 `system()`函数执行命令)。由于SPIP在反序列化这个`oubli`参数时存在漏洞，这会导致恶意代码执行。 

**有效性:** PoC代码有效，成功利用该漏洞能够在目标服务器上执行任意命令。

**投毒风险:** 经过检查`CVE-2023-27372.py`，`CVE-2023-27372.yaml`，`Dockerfile`和`README.md`文件。没有发现明显的恶意代码或者后门。`Dockerfile`用于构建一个包含易受攻击版本SPIP的环境，用于测试和演示漏洞。`CVE-2023-27372.yaml`是一个nuclei模板，用于检测目标是否存在此漏洞，该模板尝试执行phpinfo()，证明可以执行恶意代码。`README.md`提供有关漏洞的信息。

**利用方式:**

1.  **获取Anti-CSRF Token:**  访问受影响的SPIP站点的登录页面（`spip.php?page=spip_pass`），提取`formulaire_action_args`字段的值，即Anti-CSRF token。
2.  **构造Payload:**  构造一个包含恶意PHP代码的序列化字符串，例如`s:28:"<?php system('whoami'); ?>";`。这个字符串的长度需要根据实际的PHP代码长度进行调整。
3.  **发送Payload:**  通过POST请求将构造的Payload发送到`spip.php?page=spip_pass`，同时包含Anti-CSRF token和必要的表单参数。
4.  **执行代码:**  服务器在处理请求时，由于反序列化漏洞，会执行Payload中的PHP代码，从而实现远程代码执行。

**项目地址:** [nuts7/CVE-2023-27372](https://github.com/nuts7/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #10

**来源**: [CVE-2023-27372-redboltsec_CVE-2023-27372-PoC.md](../2023/CVE-2023-27372-redboltsec_CVE-2023-27372-PoC.md)

## CVE-2023-27372 SPIP RCE

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 4.2.1 (受影响版本包括3.2.18之前, 4.0.10之前, 4.1.8之前)

**利用条件:** 目标SPIP站点存在且可访问spip_pass页面，不需要任何权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27372 漏洞存在于 SPIP 4.2.1 之前的版本，允许未经身份验证的远程攻击者通过 `spip.php?page=spip_pass` 页面的 form values 执行任意代码。该漏洞源于 `ecrire/balise/formulaire_.php` 文件中 `protege_champ` 函数对序列化数据处理不当，未进行充分的输入验证，导致反序列化漏洞。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。Packet Storm Security 和 GitHub (Chocapikk/CVE-2023-27372) 都提供了漏洞利用代码或扫描器，证明该漏洞是可以被利用的。POC 代码通过构造恶意的序列化字符串，并将其作为 `oubli` 参数的值发送到 `spip.php?page=spip_pass` 页面，从而触发反序列化漏洞。

**投毒风险：**
分析提供的 PoC 代码 (`cve-2023-27372.py`)，未发现明显的投毒代码。该脚本的主要功能是：

1.  获取 CSRF token (如果存在)。
2.  构造包含恶意 PHP 代码的序列化 payload，该代码使用 `exec` 函数执行命令。
3.  将 payload 发送到目标 SPIP 站点。
4.  解析响应，提取命令执行结果。

脚本本身没有执行任何与目标系统无关的操作，例如上传恶意文件、修改系统配置或连接到外部服务器。因此，投毒风险较低。

**利用方式：**

1.  **定位目标:**  确定存在漏洞的 SPIP 站点，版本低于 4.2.1，且允许公共访问 `spip.php?page=spip_pass` 页面。
2.  **获取 CSRF Token (如果需要):** 访问 `spip.php?page=spip_pass` 页面，提取 CSRF token (`formulaire_action_args`)。有些情况下，可能不需要 CSRF token。
3.  **构造 Payload:**  构造包含恶意 PHP 代码的序列化字符串，用于执行任意命令。例如，使用 `<?php system($_GET['cmd']); ?>` 来执行 GET 请求中的 `cmd` 参数指定的命令。
4.  **发送 Payload:**  将构造的 Payload 作为 `oubli` 参数的值，通过 POST 请求发送到 `spip.php?page=spip_pass` 页面，同时附带 CSRF token (如果需要)。
5.  **执行命令:**  如果 Payload 成功执行，则可以通过构造特定的 HTTP 请求来执行任意命令。例如，访问 `spip.php?page=spip_pass&cmd=whoami` 来执行 `whoami` 命令，获取当前用户。
6.  **交互式 Shell (POC代码)**: PoC中尝试使用`whoami`检测是否RCE成功，如果失败，PoC会尝试生成一个交互式shell。这部分代码可能存在问题，需要用户多次输入命令。

**缓解措施：**
升级到 SPIP 4.2.1 或更高版本，或者应用补丁以修复反序列化漏洞。


**项目地址:** [redboltsec/CVE-2023-27372-PoC](https://github.com/redboltsec/CVE-2023-27372-PoC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---



---

## POC #3

**来源**: [CVE-2023-27372-1amthebest1_CVE-2023-27372.md](../2023/CVE-2023-27372-1amthebest1_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1 (受影响版本还包括3.2.x, 4.0.x, 4.1.x)

**利用条件:** 需要能够通过网络访问SPIP站点，且SPIP版本低于4.2.1，未应用安全补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27372 是 SPIP 4.2.1 之前版本中的一个远程代码执行 (RCE) 漏洞。该漏洞的根本原因是程序未正确处理反序列化数据，导致攻击者可以通过构造恶意表单值，在服务器上执行任意代码。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判断该PoC代码有效。
- 漏洞库信息明确指出SPIP在4.2.1之前的版本存在RCE漏洞，并通过不安全的反序列化来实现。
- 搜索引擎结果也证实了该漏洞的存在，并提供了多个漏洞分析和利用链接。
- PoC代码通过利用`spip_pass`页面中的`oubli`参数，传递一个包含PHP代码的序列化字符串，从而执行任意命令。该代码首先获取CSRF token，然后构造包含恶意PHP代码的payload，并发送POST请求到`spip.php?page=spip_pass`。恶意PHP代码使用`system`函数执行经过base64编码的命令。

**投毒风险分析：**
仔细检查了提供的PoC代码，没有发现明显的投毒代码。该代码结构清晰，功能明确，主要用于验证和利用漏洞。风险百分比评估为0%。

**利用方式：**
1.  **漏洞定位：** 该漏洞存在于 SPIP 的前台页面，攻击者无需认证即可利用。
2.  **CSRF Token 获取：** 攻击者首先访问 `spip.php?page=spip_pass` 页面，从中提取 CSRF Token，用于绕过 CSRF 保护。
3.  **Payload 构造：** 攻击者构造一个包含恶意 PHP 代码的序列化字符串。该 PHP 代码通常使用 `system()` 函数执行任意命令。为了避免过滤，命令通常会进行 base64 编码。
4.  **漏洞触发：** 攻击者将构造好的 Payload 放入 `oubli` 参数中，通过 POST 请求发送到 `spip.php?page=spip_pass` 页面，触发反序列化漏洞，从而执行任意代码。
5.  **反弹shell:** 通过反弹shell获得目标机器的权限。


**项目地址:** [1amthebest1/CVE-2023-27372](https://github.com/1amthebest1/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #4

**来源**: [CVE-2023-27372-Chocapikk_CVE-2023-27372.md](../2023/CVE-2023-27372-Chocapikk_CVE-2023-27372.md)

## CVE-2023-27372 SPIP Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要目标SPIP站点存在，且能访问其spip.php?page=spip_pass页面

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27372是SPIP CMS 4.2.1之前版本中的一个远程代码执行漏洞。该漏洞源于程序在处理表单值时，反序列化过程存在缺陷。未经身份验证的攻击者可以通过向易受攻击的SPIP实例上的spip.php?page=spip_pass页面提交特制的表单值，从而利用此漏洞执行任意代码。

**漏洞利用方式：**

1.  **获取Anti-CSRF Token：** PoC脚本首先访问`spip.php?page=spip_pass`页面，解析HTML，提取名为`formulaire_action_args`的input标签中的`value`属性，该值用作Anti-CSRF token。
2.  **构造恶意Payload：**  PoC脚本使用PHP序列化的方式构造恶意代码，通过`oubli`参数传递给`spip.php?page=spip_pass`。
3.  **发送POST请求：**  将包含Anti-CSRF token和恶意payload的POST请求发送到`spip.php?page=spip_pass`，触发反序列化漏洞，从而执行任意代码。
4.  **解析输出：**PoC脚本使用正则表达式提取命令执行结果，如果执行`whoami`成功则认为漏洞存在。

**有效性：**

根据漏洞库信息、搜索结果，以及提供的PoC代码，可以确定该漏洞是真实存在的，并且该PoC代码看起来可以有效利用该漏洞实现远程代码执行。

**投毒风险：**

检查PoC代码发现，该脚本的功能主要是利用CVE-2023-27372漏洞进行RCE验证。通过以下几个方面评估投毒风险：

*   **LeakIX API Key配置:** 脚本中`LEAKIX_API_KEY` 变量需要用户自己配置LeakIX API Key，如果用户不配置则无法从LeakIX获取SPIP URLs。
*   **Payload执行命令:** Payload中执行的命令是`whoami`，这是一个相对安全的命令，用于判断是否成功执行代码。但也存在执行其他命令的潜在风险。
*   **代码逻辑：** 代码逻辑相对清晰，主要是发送请求、解析响应和执行命令。但作者可以加入一些恶意代码来增加风险。
*   **第三方库：** 使用了`requests`、`bs4`、`rich`等第三方库，这些库本身可能存在安全漏洞。

综合考虑，该PoC代码存在少量投毒风险，可能被利用执行未经授权的命令、搜集或窃取用户信息。 风险评估为1%。

**项目地址:** [Chocapikk/CVE-2023-27372](https://github.com/Chocapikk/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #5

**来源**: [CVE-2023-27372-G01d3nW01f_cve-2023-27372.md](../2023/CVE-2023-27372-G01d3nW01f_cve-2023-27372.md)

## CVE-2023-27372 - SPIP Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution

**影响应用:** SPIP

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 4.2.1

**利用条件:** SPIP 实例需要可公开访问，并且运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372 是 SPIP CMS 中的一个远程代码执行漏洞，源于对反序列化数据处理不当。攻击者可以利用此漏洞通过在公共区域的表单值中注入恶意序列化数据来执行任意代码。

**有效性分析：**
提供的 exploit.py 脚本利用了此漏洞。它首先从目标 URL 的 `/spip/spip.php?page=spip_pass` 获取 `formulaire_action_args` 参数。然后，它构造一个包含恶意 PHP 代码的 POST 请求，该代码使用 `system()` 函数执行攻击者提供的命令。该恶意 PHP 代码被序列化并作为 `oubli` 参数传递。脚本的成功执行表明漏洞是可利用的。

**投毒风险分析：**
查看 exploit.py 脚本，其主要功能是利用 CVE-2023-27372 漏洞实现远程代码执行。脚本首先获取目标 URL，然后构造恶意 payload 并发送 POST 请求。脚本本身没有明显的恶意行为，如植入后门或传播恶意软件。
但是，该脚本本身依赖于用户提供的命令来执行 RCE。如果用户不小心执行了包含恶意命令的脚本，可能会导致目标系统受到损害。
在 readme.md 文件中，声明了 “education purpose only!!!!!”，降低了投毒的可能性。
仓库中，可能存在投毒代码的风险较低，约为 10%。

**利用方式：**
1.  攻击者向 SPIP 站点的 `/spip/spip.php?page=spip_pass` 发送 GET 请求。
2.  攻击者解析响应，提取 `formulaire_action_args` 参数。
3.  攻击者构造一个 POST 请求，将 `formulaire_action` 设置为 `oubli`，`formulaire_action_args` 设置为提取的值，并将恶意 PHP 代码序列化后作为 `oubli` 参数的值发送。
4.  SPIP 在处理 POST 请求时，反序列化 `oubli` 参数的值，导致恶意 PHP 代码被执行，从而实现远程代码执行。

**项目地址:** [G01d3nW01f/cve-2023-27372](https://github.com/G01d3nW01f/cve-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #6

**来源**: [CVE-2023-27372-ThatNotEasy_CVE-2023-27372.md](../2023/CVE-2023-27372-ThatNotEasy_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 目标网站必须运行存在漏洞的SPIP版本，且漏洞利用点对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP内容管理系统4.2.1之前版本中的一个远程代码执行漏洞。该漏洞源于SPIP处理反序列化数据的方式不当，允许未经身份验证的攻击者通过表单值执行任意命令。根据提供的漏洞利用代码，攻击者可以指定一个包含多个URL的文件和一个要执行的命令。该脚本会向这些URL发送特制的请求，其中包含序列化的恶意payload，从而在目标服务器上执行指定的命令，获取web用户权限。该漏洞利用代码的投毒风险较低，主要风险在于使用者自身行为，利用此工具进行未授权的渗透测试或攻击。因为代码中包含从 `lib/ua.txt` 读取 User-Agent 的操作，以及输出文件功能，存在一定的信息收集行为，可能用于后期攻击，但总体上代码逻辑清晰，风险可控。

**利用方式：**

1.  **漏洞定位：** SPIP 4.2.1之前的版本存在反序列化漏洞，具体位置在`oubli`参数中，允许在公共区域提交的表单值。
2.  **攻击流程：**
    *   攻击者构造包含恶意代码的序列化payload。
    *   将payload作为表单值提交给存在漏洞的SPIP站点。
    *   SPIP站点反序列化该数据时，恶意代码被执行。
3.  **漏洞利用代码分析：**
    *   `spip.py`脚本接受目标URL列表和要执行的命令作为参数。
    *   脚本使用`requests`库发送HTTP请求，将序列化的payload包含在POST请求的参数中。
    *   服务器端反序列化payload，执行攻击者指定的命令。
4.  **缓解措施：**
    *   将SPIP升级到3.2.18, 4.0.10, 4.1.8, 或 4.2.1及以上版本。
    *   限制对SPIP站点的公共访问。

**项目地址:** [ThatNotEasy/CVE-2023-27372](https://github.com/ThatNotEasy/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #7

**来源**: [CVE-2023-27372-dream434_CVE-2023-27372.md](../2023/CVE-2023-27372-dream434_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要目标SPIP站点存在漏洞页面且可公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27372 是 SPIP 内容管理系统（CMS）中存在的一个远程代码执行漏洞。该漏洞源于 SPIP 在处理表单值时，由于对序列化数据处理不当，导致攻击者可以通过构造恶意的序列化数据，将其作为表单参数提交到存在漏洞的页面，从而在服务器端执行任意代码。

**有效性：**

根据漏洞信息和搜索结果，提供的 POC 代码是有效的。多个资源（如 Packet Storm 和 GitHub 上的 Chocapikk/CVE-2023-27372）都提供了可用于利用该漏洞的 POC 或扫描器。

**投毒风险：**

代码中存在轻微的投毒风险。主要风险点在于：

*   **依赖项安装错误引导:** README.md文件引导用户安装 `collorama` , 正确的安装包应该是 `colorama`，如果用户安装了恶意攻击者伪造的 `collorama` 包，则可能存在安全风险。 *   **执行任意命令：** POC 允许执行任意命令。如果攻击者修改了 POC 中的 `whoami` 命令，替换为恶意命令，可能会造成更大的危害。例如，删除服务器文件、安装恶意软件等。但这种风险主要取决于使用者如何使用 POC，而非 POC 本身包含恶意代码。

考虑到这些因素，我将投毒风险评估为 5%。主要是安装包名称拼写错误引导，存在被利用的可能性。

**利用方式：**

1.  **查找目标：** 寻找运行 SPIP 且版本低于 4.2.1 的站点。
2.  **构造Payload：** 攻击者构造包含恶意 PHP 代码的序列化数据。
3.  **获取CSRF Token：** 首先，向 `/spip.php?page=spip_pass` 页面发起 GET 请求，解析 HTML 响应，提取名为 `formulaire_action_args` 的隐藏输入字段中的 CSRF token。
4.  **发送恶意请求：** 将构造的序列化数据作为 `oubli` 参数的值，连同其他必要的表单参数（包括上一步获取的 CSRF token）通过 POST 请求发送到 `/spip.php?page=spip_pass` 页面。
5.  **代码执行：** SPIP 在处理表单数据时，反序列化 `oubli` 参数，从而执行攻击者注入的恶意 PHP 代码。

简而言之，利用方式是通过构造包含恶意代码的序列化数据，并将其作为表单参数提交到 SPIP 站点，从而实现远程代码执行。

**项目地址:** [dream434/CVE-2023-27372](https://github.com/dream434/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #8

**来源**: [CVE-2023-27372-izzz0_CVE-2023-27372-POC.md](../2023/CVE-2023-27372-izzz0_CVE-2023-27372-POC.md)

## CVE-2023-27372-SPIP远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 目标服务器运行存在漏洞的SPIP版本，且漏洞利用发生在公共区域，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP 4.2.1之前版本中的一个远程代码执行漏洞。该漏洞是由于SPIP处理表单值中的序列化数据不当造成的。攻击者可以通过在公共区域提交包含恶意序列化数据的表单值来利用此漏洞，从而执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，该漏洞是有效的。POC代码通过构造特定的POST请求，向`spip.php?page=spip_pass`页面提交包含恶意PHP代码的序列化字符串，利用SPIP的反序列化漏洞执行代码。如果服务器返回包含`phpinfo()`结果的页面，则表明存在漏洞。

**投毒风险：**
代码主体逻辑是漏洞验证，风险较低。但仍然存在一定的投毒风险，因为攻击者可能修改POC代码，使其包含恶意操作，例如：

*   **植入后门:** POC中可以加入执行任意系统命令的代码，从而在目标服务器上植入后门。
*   **数据窃取:** POC可以被修改为窃取服务器上的敏感数据，例如数据库凭据或配置文件。
*   **拒绝服务攻击:** POC可以被修改为发送大量请求，导致目标服务器过载，从而造成拒绝服务攻击。
POC 使用 phpinfo() 验证，比较安全，但潜在风险依然存在。因此，投毒风险评估为10%。

**利用方式：**
1.  确定目标网站运行的SPIP版本低于4.2.1。
2.  向`spip.php?page=spip_pass`页面发送包含以下参数的POST请求：
    *   `formulaire_action=oubli`
    *   `formulaire_action_args`：从页面中提取的`formulaire_action_args`字段的值，进行URL编码。
    *   `oubli`: 包含恶意PHP代码的序列化字符串，例如`s:19:"<?php phpinfo(); ?>";`
    *   `nobot`：任意值，用于绕过反爬机制
3.  如果服务器返回包含恶意PHP代码执行结果的页面，则表明漏洞利用成功。例如，如果使用`phpinfo()`，则会返回phpinfo页面，或者反序列化任意类的函数，执行恶意代码。

**项目地址:** [izzz0/CVE-2023-27372-POC](https://github.com/izzz0/CVE-2023-27372-POC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #9

**来源**: [CVE-2023-27372-nuts7_CVE-2023-27372.md](../2023/CVE-2023-27372-nuts7_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要能够访问SPIP的登录页面或存在`spip_pass`页面的公开访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27372是SPIP 4.2.1之前的版本中的一个远程代码执行漏洞，原因是程序在处理表单值中的序列化数据时存在缺陷。攻击者可以通过在公共区域提交包含恶意序列化数据的表单，从而执行任意代码。PoC代码显示，它首先获取一个Anti-CSRF token，然后构造一个包含PHP代码的payload，该代码会执行指定的系统命令。这个漏洞的利用方式是，攻击者先访问登录页面 (`spip.php?page=spip_pass`)，获取`formulaire_action_args`的值 (Anti-CSRF token)。然后，攻击者构造一个POST请求，其中包含`page=spip_pass`， `formulaire_action=oubli`, `formulaire_action_args`为之前获取的CSRF token的值，并且`oubli`参数的值为精心构造的PHP序列化字符串，这个序列化字符串包含要执行的PHP代码 (使用 `system()`函数执行命令)。由于SPIP在反序列化这个`oubli`参数时存在漏洞，这会导致恶意代码执行。 

**有效性:** PoC代码有效，成功利用该漏洞能够在目标服务器上执行任意命令。

**投毒风险:** 经过检查`CVE-2023-27372.py`，`CVE-2023-27372.yaml`，`Dockerfile`和`README.md`文件。没有发现明显的恶意代码或者后门。`Dockerfile`用于构建一个包含易受攻击版本SPIP的环境，用于测试和演示漏洞。`CVE-2023-27372.yaml`是一个nuclei模板，用于检测目标是否存在此漏洞，该模板尝试执行phpinfo()，证明可以执行恶意代码。`README.md`提供有关漏洞的信息。

**利用方式:**

1.  **获取Anti-CSRF Token:**  访问受影响的SPIP站点的登录页面（`spip.php?page=spip_pass`），提取`formulaire_action_args`字段的值，即Anti-CSRF token。
2.  **构造Payload:**  构造一个包含恶意PHP代码的序列化字符串，例如`s:28:"<?php system('whoami'); ?>";`。这个字符串的长度需要根据实际的PHP代码长度进行调整。
3.  **发送Payload:**  通过POST请求将构造的Payload发送到`spip.php?page=spip_pass`，同时包含Anti-CSRF token和必要的表单参数。
4.  **执行代码:**  服务器在处理请求时，由于反序列化漏洞，会执行Payload中的PHP代码，从而实现远程代码执行。

**项目地址:** [nuts7/CVE-2023-27372](https://github.com/nuts7/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #10

**来源**: [CVE-2023-27372-redboltsec_CVE-2023-27372-PoC.md](../2023/CVE-2023-27372-redboltsec_CVE-2023-27372-PoC.md)

## CVE-2023-27372 SPIP RCE

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 4.2.1 (受影响版本包括3.2.18之前, 4.0.10之前, 4.1.8之前)

**利用条件:** 目标SPIP站点存在且可访问spip_pass页面，不需要任何权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27372 漏洞存在于 SPIP 4.2.1 之前的版本，允许未经身份验证的远程攻击者通过 `spip.php?page=spip_pass` 页面的 form values 执行任意代码。该漏洞源于 `ecrire/balise/formulaire_.php` 文件中 `protege_champ` 函数对序列化数据处理不当，未进行充分的输入验证，导致反序列化漏洞。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。Packet Storm Security 和 GitHub (Chocapikk/CVE-2023-27372) 都提供了漏洞利用代码或扫描器，证明该漏洞是可以被利用的。POC 代码通过构造恶意的序列化字符串，并将其作为 `oubli` 参数的值发送到 `spip.php?page=spip_pass` 页面，从而触发反序列化漏洞。

**投毒风险：**
分析提供的 PoC 代码 (`cve-2023-27372.py`)，未发现明显的投毒代码。该脚本的主要功能是：

1.  获取 CSRF token (如果存在)。
2.  构造包含恶意 PHP 代码的序列化 payload，该代码使用 `exec` 函数执行命令。
3.  将 payload 发送到目标 SPIP 站点。
4.  解析响应，提取命令执行结果。

脚本本身没有执行任何与目标系统无关的操作，例如上传恶意文件、修改系统配置或连接到外部服务器。因此，投毒风险较低。

**利用方式：**

1.  **定位目标:**  确定存在漏洞的 SPIP 站点，版本低于 4.2.1，且允许公共访问 `spip.php?page=spip_pass` 页面。
2.  **获取 CSRF Token (如果需要):** 访问 `spip.php?page=spip_pass` 页面，提取 CSRF token (`formulaire_action_args`)。有些情况下，可能不需要 CSRF token。
3.  **构造 Payload:**  构造包含恶意 PHP 代码的序列化字符串，用于执行任意命令。例如，使用 `<?php system($_GET['cmd']); ?>` 来执行 GET 请求中的 `cmd` 参数指定的命令。
4.  **发送 Payload:**  将构造的 Payload 作为 `oubli` 参数的值，通过 POST 请求发送到 `spip.php?page=spip_pass` 页面，同时附带 CSRF token (如果需要)。
5.  **执行命令:**  如果 Payload 成功执行，则可以通过构造特定的 HTTP 请求来执行任意命令。例如，访问 `spip.php?page=spip_pass&cmd=whoami` 来执行 `whoami` 命令，获取当前用户。
6.  **交互式 Shell (POC代码)**: PoC中尝试使用`whoami`检测是否RCE成功，如果失败，PoC会尝试生成一个交互式shell。这部分代码可能存在问题，需要用户多次输入命令。

**缓解措施：**
升级到 SPIP 4.2.1 或更高版本，或者应用补丁以修复反序列化漏洞。


**项目地址:** [redboltsec/CVE-2023-27372-PoC](https://github.com/redboltsec/CVE-2023-27372-PoC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---



---

## POC #3

**来源**: [CVE-2023-27372-1amthebest1_CVE-2023-27372.md](../2023/CVE-2023-27372-1amthebest1_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1 (受影响版本还包括3.2.x, 4.0.x, 4.1.x)

**利用条件:** 需要能够通过网络访问SPIP站点，且SPIP版本低于4.2.1，未应用安全补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27372 是 SPIP 4.2.1 之前版本中的一个远程代码执行 (RCE) 漏洞。该漏洞的根本原因是程序未正确处理反序列化数据，导致攻击者可以通过构造恶意表单值，在服务器上执行任意代码。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判断该PoC代码有效。
- 漏洞库信息明确指出SPIP在4.2.1之前的版本存在RCE漏洞，并通过不安全的反序列化来实现。
- 搜索引擎结果也证实了该漏洞的存在，并提供了多个漏洞分析和利用链接。
- PoC代码通过利用`spip_pass`页面中的`oubli`参数，传递一个包含PHP代码的序列化字符串，从而执行任意命令。该代码首先获取CSRF token，然后构造包含恶意PHP代码的payload，并发送POST请求到`spip.php?page=spip_pass`。恶意PHP代码使用`system`函数执行经过base64编码的命令。

**投毒风险分析：**
仔细检查了提供的PoC代码，没有发现明显的投毒代码。该代码结构清晰，功能明确，主要用于验证和利用漏洞。风险百分比评估为0%。

**利用方式：**
1.  **漏洞定位：** 该漏洞存在于 SPIP 的前台页面，攻击者无需认证即可利用。
2.  **CSRF Token 获取：** 攻击者首先访问 `spip.php?page=spip_pass` 页面，从中提取 CSRF Token，用于绕过 CSRF 保护。
3.  **Payload 构造：** 攻击者构造一个包含恶意 PHP 代码的序列化字符串。该 PHP 代码通常使用 `system()` 函数执行任意命令。为了避免过滤，命令通常会进行 base64 编码。
4.  **漏洞触发：** 攻击者将构造好的 Payload 放入 `oubli` 参数中，通过 POST 请求发送到 `spip.php?page=spip_pass` 页面，触发反序列化漏洞，从而执行任意代码。
5.  **反弹shell:** 通过反弹shell获得目标机器的权限。


**项目地址:** [1amthebest1/CVE-2023-27372](https://github.com/1amthebest1/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #4

**来源**: [CVE-2023-27372-Chocapikk_CVE-2023-27372.md](../2023/CVE-2023-27372-Chocapikk_CVE-2023-27372.md)

## CVE-2023-27372 SPIP Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要目标SPIP站点存在，且能访问其spip.php?page=spip_pass页面

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27372是SPIP CMS 4.2.1之前版本中的一个远程代码执行漏洞。该漏洞源于程序在处理表单值时，反序列化过程存在缺陷。未经身份验证的攻击者可以通过向易受攻击的SPIP实例上的spip.php?page=spip_pass页面提交特制的表单值，从而利用此漏洞执行任意代码。

**漏洞利用方式：**

1.  **获取Anti-CSRF Token：** PoC脚本首先访问`spip.php?page=spip_pass`页面，解析HTML，提取名为`formulaire_action_args`的input标签中的`value`属性，该值用作Anti-CSRF token。
2.  **构造恶意Payload：**  PoC脚本使用PHP序列化的方式构造恶意代码，通过`oubli`参数传递给`spip.php?page=spip_pass`。
3.  **发送POST请求：**  将包含Anti-CSRF token和恶意payload的POST请求发送到`spip.php?page=spip_pass`，触发反序列化漏洞，从而执行任意代码。
4.  **解析输出：**PoC脚本使用正则表达式提取命令执行结果，如果执行`whoami`成功则认为漏洞存在。

**有效性：**

根据漏洞库信息、搜索结果，以及提供的PoC代码，可以确定该漏洞是真实存在的，并且该PoC代码看起来可以有效利用该漏洞实现远程代码执行。

**投毒风险：**

检查PoC代码发现，该脚本的功能主要是利用CVE-2023-27372漏洞进行RCE验证。通过以下几个方面评估投毒风险：

*   **LeakIX API Key配置:** 脚本中`LEAKIX_API_KEY` 变量需要用户自己配置LeakIX API Key，如果用户不配置则无法从LeakIX获取SPIP URLs。
*   **Payload执行命令:** Payload中执行的命令是`whoami`，这是一个相对安全的命令，用于判断是否成功执行代码。但也存在执行其他命令的潜在风险。
*   **代码逻辑：** 代码逻辑相对清晰，主要是发送请求、解析响应和执行命令。但作者可以加入一些恶意代码来增加风险。
*   **第三方库：** 使用了`requests`、`bs4`、`rich`等第三方库，这些库本身可能存在安全漏洞。

综合考虑，该PoC代码存在少量投毒风险，可能被利用执行未经授权的命令、搜集或窃取用户信息。 风险评估为1%。

**项目地址:** [Chocapikk/CVE-2023-27372](https://github.com/Chocapikk/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #5

**来源**: [CVE-2023-27372-G01d3nW01f_cve-2023-27372.md](../2023/CVE-2023-27372-G01d3nW01f_cve-2023-27372.md)

## CVE-2023-27372 - SPIP Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution

**影响应用:** SPIP

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 4.2.1

**利用条件:** SPIP 实例需要可公开访问，并且运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372 是 SPIP CMS 中的一个远程代码执行漏洞，源于对反序列化数据处理不当。攻击者可以利用此漏洞通过在公共区域的表单值中注入恶意序列化数据来执行任意代码。

**有效性分析：**
提供的 exploit.py 脚本利用了此漏洞。它首先从目标 URL 的 `/spip/spip.php?page=spip_pass` 获取 `formulaire_action_args` 参数。然后，它构造一个包含恶意 PHP 代码的 POST 请求，该代码使用 `system()` 函数执行攻击者提供的命令。该恶意 PHP 代码被序列化并作为 `oubli` 参数传递。脚本的成功执行表明漏洞是可利用的。

**投毒风险分析：**
查看 exploit.py 脚本，其主要功能是利用 CVE-2023-27372 漏洞实现远程代码执行。脚本首先获取目标 URL，然后构造恶意 payload 并发送 POST 请求。脚本本身没有明显的恶意行为，如植入后门或传播恶意软件。
但是，该脚本本身依赖于用户提供的命令来执行 RCE。如果用户不小心执行了包含恶意命令的脚本，可能会导致目标系统受到损害。
在 readme.md 文件中，声明了 “education purpose only!!!!!”，降低了投毒的可能性。
仓库中，可能存在投毒代码的风险较低，约为 10%。

**利用方式：**
1.  攻击者向 SPIP 站点的 `/spip/spip.php?page=spip_pass` 发送 GET 请求。
2.  攻击者解析响应，提取 `formulaire_action_args` 参数。
3.  攻击者构造一个 POST 请求，将 `formulaire_action` 设置为 `oubli`，`formulaire_action_args` 设置为提取的值，并将恶意 PHP 代码序列化后作为 `oubli` 参数的值发送。
4.  SPIP 在处理 POST 请求时，反序列化 `oubli` 参数的值，导致恶意 PHP 代码被执行，从而实现远程代码执行。

**项目地址:** [G01d3nW01f/cve-2023-27372](https://github.com/G01d3nW01f/cve-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #6

**来源**: [CVE-2023-27372-ThatNotEasy_CVE-2023-27372.md](../2023/CVE-2023-27372-ThatNotEasy_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 目标网站必须运行存在漏洞的SPIP版本，且漏洞利用点对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP内容管理系统4.2.1之前版本中的一个远程代码执行漏洞。该漏洞源于SPIP处理反序列化数据的方式不当，允许未经身份验证的攻击者通过表单值执行任意命令。根据提供的漏洞利用代码，攻击者可以指定一个包含多个URL的文件和一个要执行的命令。该脚本会向这些URL发送特制的请求，其中包含序列化的恶意payload，从而在目标服务器上执行指定的命令，获取web用户权限。该漏洞利用代码的投毒风险较低，主要风险在于使用者自身行为，利用此工具进行未授权的渗透测试或攻击。因为代码中包含从 `lib/ua.txt` 读取 User-Agent 的操作，以及输出文件功能，存在一定的信息收集行为，可能用于后期攻击，但总体上代码逻辑清晰，风险可控。

**利用方式：**

1.  **漏洞定位：** SPIP 4.2.1之前的版本存在反序列化漏洞，具体位置在`oubli`参数中，允许在公共区域提交的表单值。
2.  **攻击流程：**
    *   攻击者构造包含恶意代码的序列化payload。
    *   将payload作为表单值提交给存在漏洞的SPIP站点。
    *   SPIP站点反序列化该数据时，恶意代码被执行。
3.  **漏洞利用代码分析：**
    *   `spip.py`脚本接受目标URL列表和要执行的命令作为参数。
    *   脚本使用`requests`库发送HTTP请求，将序列化的payload包含在POST请求的参数中。
    *   服务器端反序列化payload，执行攻击者指定的命令。
4.  **缓解措施：**
    *   将SPIP升级到3.2.18, 4.0.10, 4.1.8, 或 4.2.1及以上版本。
    *   限制对SPIP站点的公共访问。

**项目地址:** [ThatNotEasy/CVE-2023-27372](https://github.com/ThatNotEasy/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #7

**来源**: [CVE-2023-27372-dream434_CVE-2023-27372.md](../2023/CVE-2023-27372-dream434_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要目标SPIP站点存在漏洞页面且可公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27372 是 SPIP 内容管理系统（CMS）中存在的一个远程代码执行漏洞。该漏洞源于 SPIP 在处理表单值时，由于对序列化数据处理不当，导致攻击者可以通过构造恶意的序列化数据，将其作为表单参数提交到存在漏洞的页面，从而在服务器端执行任意代码。

**有效性：**

根据漏洞信息和搜索结果，提供的 POC 代码是有效的。多个资源（如 Packet Storm 和 GitHub 上的 Chocapikk/CVE-2023-27372）都提供了可用于利用该漏洞的 POC 或扫描器。

**投毒风险：**

代码中存在轻微的投毒风险。主要风险点在于：

*   **依赖项安装错误引导:** README.md文件引导用户安装 `collorama` , 正确的安装包应该是 `colorama`，如果用户安装了恶意攻击者伪造的 `collorama` 包，则可能存在安全风险。 *   **执行任意命令：** POC 允许执行任意命令。如果攻击者修改了 POC 中的 `whoami` 命令，替换为恶意命令，可能会造成更大的危害。例如，删除服务器文件、安装恶意软件等。但这种风险主要取决于使用者如何使用 POC，而非 POC 本身包含恶意代码。

考虑到这些因素，我将投毒风险评估为 5%。主要是安装包名称拼写错误引导，存在被利用的可能性。

**利用方式：**

1.  **查找目标：** 寻找运行 SPIP 且版本低于 4.2.1 的站点。
2.  **构造Payload：** 攻击者构造包含恶意 PHP 代码的序列化数据。
3.  **获取CSRF Token：** 首先，向 `/spip.php?page=spip_pass` 页面发起 GET 请求，解析 HTML 响应，提取名为 `formulaire_action_args` 的隐藏输入字段中的 CSRF token。
4.  **发送恶意请求：** 将构造的序列化数据作为 `oubli` 参数的值，连同其他必要的表单参数（包括上一步获取的 CSRF token）通过 POST 请求发送到 `/spip.php?page=spip_pass` 页面。
5.  **代码执行：** SPIP 在处理表单数据时，反序列化 `oubli` 参数，从而执行攻击者注入的恶意 PHP 代码。

简而言之，利用方式是通过构造包含恶意代码的序列化数据，并将其作为表单参数提交到 SPIP 站点，从而实现远程代码执行。

**项目地址:** [dream434/CVE-2023-27372](https://github.com/dream434/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #8

**来源**: [CVE-2023-27372-izzz0_CVE-2023-27372-POC.md](../2023/CVE-2023-27372-izzz0_CVE-2023-27372-POC.md)

## CVE-2023-27372-SPIP远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 目标服务器运行存在漏洞的SPIP版本，且漏洞利用发生在公共区域，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP 4.2.1之前版本中的一个远程代码执行漏洞。该漏洞是由于SPIP处理表单值中的序列化数据不当造成的。攻击者可以通过在公共区域提交包含恶意序列化数据的表单值来利用此漏洞，从而执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，该漏洞是有效的。POC代码通过构造特定的POST请求，向`spip.php?page=spip_pass`页面提交包含恶意PHP代码的序列化字符串，利用SPIP的反序列化漏洞执行代码。如果服务器返回包含`phpinfo()`结果的页面，则表明存在漏洞。

**投毒风险：**
代码主体逻辑是漏洞验证，风险较低。但仍然存在一定的投毒风险，因为攻击者可能修改POC代码，使其包含恶意操作，例如：

*   **植入后门:** POC中可以加入执行任意系统命令的代码，从而在目标服务器上植入后门。
*   **数据窃取:** POC可以被修改为窃取服务器上的敏感数据，例如数据库凭据或配置文件。
*   **拒绝服务攻击:** POC可以被修改为发送大量请求，导致目标服务器过载，从而造成拒绝服务攻击。
POC 使用 phpinfo() 验证，比较安全，但潜在风险依然存在。因此，投毒风险评估为10%。

**利用方式：**
1.  确定目标网站运行的SPIP版本低于4.2.1。
2.  向`spip.php?page=spip_pass`页面发送包含以下参数的POST请求：
    *   `formulaire_action=oubli`
    *   `formulaire_action_args`：从页面中提取的`formulaire_action_args`字段的值，进行URL编码。
    *   `oubli`: 包含恶意PHP代码的序列化字符串，例如`s:19:"<?php phpinfo(); ?>";`
    *   `nobot`：任意值，用于绕过反爬机制
3.  如果服务器返回包含恶意PHP代码执行结果的页面，则表明漏洞利用成功。例如，如果使用`phpinfo()`，则会返回phpinfo页面，或者反序列化任意类的函数，执行恶意代码。

**项目地址:** [izzz0/CVE-2023-27372-POC](https://github.com/izzz0/CVE-2023-27372-POC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #9

**来源**: [CVE-2023-27372-nuts7_CVE-2023-27372.md](../2023/CVE-2023-27372-nuts7_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要能够访问SPIP的登录页面或存在`spip_pass`页面的公开访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27372是SPIP 4.2.1之前的版本中的一个远程代码执行漏洞，原因是程序在处理表单值中的序列化数据时存在缺陷。攻击者可以通过在公共区域提交包含恶意序列化数据的表单，从而执行任意代码。PoC代码显示，它首先获取一个Anti-CSRF token，然后构造一个包含PHP代码的payload，该代码会执行指定的系统命令。这个漏洞的利用方式是，攻击者先访问登录页面 (`spip.php?page=spip_pass`)，获取`formulaire_action_args`的值 (Anti-CSRF token)。然后，攻击者构造一个POST请求，其中包含`page=spip_pass`， `formulaire_action=oubli`, `formulaire_action_args`为之前获取的CSRF token的值，并且`oubli`参数的值为精心构造的PHP序列化字符串，这个序列化字符串包含要执行的PHP代码 (使用 `system()`函数执行命令)。由于SPIP在反序列化这个`oubli`参数时存在漏洞，这会导致恶意代码执行。 

**有效性:** PoC代码有效，成功利用该漏洞能够在目标服务器上执行任意命令。

**投毒风险:** 经过检查`CVE-2023-27372.py`，`CVE-2023-27372.yaml`，`Dockerfile`和`README.md`文件。没有发现明显的恶意代码或者后门。`Dockerfile`用于构建一个包含易受攻击版本SPIP的环境，用于测试和演示漏洞。`CVE-2023-27372.yaml`是一个nuclei模板，用于检测目标是否存在此漏洞，该模板尝试执行phpinfo()，证明可以执行恶意代码。`README.md`提供有关漏洞的信息。

**利用方式:**

1.  **获取Anti-CSRF Token:**  访问受影响的SPIP站点的登录页面（`spip.php?page=spip_pass`），提取`formulaire_action_args`字段的值，即Anti-CSRF token。
2.  **构造Payload:**  构造一个包含恶意PHP代码的序列化字符串，例如`s:28:"<?php system('whoami'); ?>";`。这个字符串的长度需要根据实际的PHP代码长度进行调整。
3.  **发送Payload:**  通过POST请求将构造的Payload发送到`spip.php?page=spip_pass`，同时包含Anti-CSRF token和必要的表单参数。
4.  **执行代码:**  服务器在处理请求时，由于反序列化漏洞，会执行Payload中的PHP代码，从而实现远程代码执行。

**项目地址:** [nuts7/CVE-2023-27372](https://github.com/nuts7/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #10

**来源**: [CVE-2023-27372-redboltsec_CVE-2023-27372-PoC.md](../2023/CVE-2023-27372-redboltsec_CVE-2023-27372-PoC.md)

## CVE-2023-27372 SPIP RCE

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 4.2.1 (受影响版本包括3.2.18之前, 4.0.10之前, 4.1.8之前)

**利用条件:** 目标SPIP站点存在且可访问spip_pass页面，不需要任何权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27372 漏洞存在于 SPIP 4.2.1 之前的版本，允许未经身份验证的远程攻击者通过 `spip.php?page=spip_pass` 页面的 form values 执行任意代码。该漏洞源于 `ecrire/balise/formulaire_.php` 文件中 `protege_champ` 函数对序列化数据处理不当，未进行充分的输入验证，导致反序列化漏洞。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。Packet Storm Security 和 GitHub (Chocapikk/CVE-2023-27372) 都提供了漏洞利用代码或扫描器，证明该漏洞是可以被利用的。POC 代码通过构造恶意的序列化字符串，并将其作为 `oubli` 参数的值发送到 `spip.php?page=spip_pass` 页面，从而触发反序列化漏洞。

**投毒风险：**
分析提供的 PoC 代码 (`cve-2023-27372.py`)，未发现明显的投毒代码。该脚本的主要功能是：

1.  获取 CSRF token (如果存在)。
2.  构造包含恶意 PHP 代码的序列化 payload，该代码使用 `exec` 函数执行命令。
3.  将 payload 发送到目标 SPIP 站点。
4.  解析响应，提取命令执行结果。

脚本本身没有执行任何与目标系统无关的操作，例如上传恶意文件、修改系统配置或连接到外部服务器。因此，投毒风险较低。

**利用方式：**

1.  **定位目标:**  确定存在漏洞的 SPIP 站点，版本低于 4.2.1，且允许公共访问 `spip.php?page=spip_pass` 页面。
2.  **获取 CSRF Token (如果需要):** 访问 `spip.php?page=spip_pass` 页面，提取 CSRF token (`formulaire_action_args`)。有些情况下，可能不需要 CSRF token。
3.  **构造 Payload:**  构造包含恶意 PHP 代码的序列化字符串，用于执行任意命令。例如，使用 `<?php system($_GET['cmd']); ?>` 来执行 GET 请求中的 `cmd` 参数指定的命令。
4.  **发送 Payload:**  将构造的 Payload 作为 `oubli` 参数的值，通过 POST 请求发送到 `spip.php?page=spip_pass` 页面，同时附带 CSRF token (如果需要)。
5.  **执行命令:**  如果 Payload 成功执行，则可以通过构造特定的 HTTP 请求来执行任意命令。例如，访问 `spip.php?page=spip_pass&cmd=whoami` 来执行 `whoami` 命令，获取当前用户。
6.  **交互式 Shell (POC代码)**: PoC中尝试使用`whoami`检测是否RCE成功，如果失败，PoC会尝试生成一个交互式shell。这部分代码可能存在问题，需要用户多次输入命令。

**缓解措施：**
升级到 SPIP 4.2.1 或更高版本，或者应用补丁以修复反序列化漏洞。


**项目地址:** [redboltsec/CVE-2023-27372-PoC](https://github.com/redboltsec/CVE-2023-27372-PoC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---



---

## POC #3

**来源**: [CVE-2023-27372-1amthebest1_CVE-2023-27372.md](../2023/CVE-2023-27372-1amthebest1_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1 (受影响版本还包括3.2.x, 4.0.x, 4.1.x)

**利用条件:** 需要能够通过网络访问SPIP站点，且SPIP版本低于4.2.1，未应用安全补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27372 是 SPIP 4.2.1 之前版本中的一个远程代码执行 (RCE) 漏洞。该漏洞的根本原因是程序未正确处理反序列化数据，导致攻击者可以通过构造恶意表单值，在服务器上执行任意代码。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判断该PoC代码有效。
- 漏洞库信息明确指出SPIP在4.2.1之前的版本存在RCE漏洞，并通过不安全的反序列化来实现。
- 搜索引擎结果也证实了该漏洞的存在，并提供了多个漏洞分析和利用链接。
- PoC代码通过利用`spip_pass`页面中的`oubli`参数，传递一个包含PHP代码的序列化字符串，从而执行任意命令。该代码首先获取CSRF token，然后构造包含恶意PHP代码的payload，并发送POST请求到`spip.php?page=spip_pass`。恶意PHP代码使用`system`函数执行经过base64编码的命令。

**投毒风险分析：**
仔细检查了提供的PoC代码，没有发现明显的投毒代码。该代码结构清晰，功能明确，主要用于验证和利用漏洞。风险百分比评估为0%。

**利用方式：**
1.  **漏洞定位：** 该漏洞存在于 SPIP 的前台页面，攻击者无需认证即可利用。
2.  **CSRF Token 获取：** 攻击者首先访问 `spip.php?page=spip_pass` 页面，从中提取 CSRF Token，用于绕过 CSRF 保护。
3.  **Payload 构造：** 攻击者构造一个包含恶意 PHP 代码的序列化字符串。该 PHP 代码通常使用 `system()` 函数执行任意命令。为了避免过滤，命令通常会进行 base64 编码。
4.  **漏洞触发：** 攻击者将构造好的 Payload 放入 `oubli` 参数中，通过 POST 请求发送到 `spip.php?page=spip_pass` 页面，触发反序列化漏洞，从而执行任意代码。
5.  **反弹shell:** 通过反弹shell获得目标机器的权限。


**项目地址:** [1amthebest1/CVE-2023-27372](https://github.com/1amthebest1/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #4

**来源**: [CVE-2023-27372-Chocapikk_CVE-2023-27372.md](../2023/CVE-2023-27372-Chocapikk_CVE-2023-27372.md)

## CVE-2023-27372 SPIP Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要目标SPIP站点存在，且能访问其spip.php?page=spip_pass页面

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27372是SPIP CMS 4.2.1之前版本中的一个远程代码执行漏洞。该漏洞源于程序在处理表单值时，反序列化过程存在缺陷。未经身份验证的攻击者可以通过向易受攻击的SPIP实例上的spip.php?page=spip_pass页面提交特制的表单值，从而利用此漏洞执行任意代码。

**漏洞利用方式：**

1.  **获取Anti-CSRF Token：** PoC脚本首先访问`spip.php?page=spip_pass`页面，解析HTML，提取名为`formulaire_action_args`的input标签中的`value`属性，该值用作Anti-CSRF token。
2.  **构造恶意Payload：**  PoC脚本使用PHP序列化的方式构造恶意代码，通过`oubli`参数传递给`spip.php?page=spip_pass`。
3.  **发送POST请求：**  将包含Anti-CSRF token和恶意payload的POST请求发送到`spip.php?page=spip_pass`，触发反序列化漏洞，从而执行任意代码。
4.  **解析输出：**PoC脚本使用正则表达式提取命令执行结果，如果执行`whoami`成功则认为漏洞存在。

**有效性：**

根据漏洞库信息、搜索结果，以及提供的PoC代码，可以确定该漏洞是真实存在的，并且该PoC代码看起来可以有效利用该漏洞实现远程代码执行。

**投毒风险：**

检查PoC代码发现，该脚本的功能主要是利用CVE-2023-27372漏洞进行RCE验证。通过以下几个方面评估投毒风险：

*   **LeakIX API Key配置:** 脚本中`LEAKIX_API_KEY` 变量需要用户自己配置LeakIX API Key，如果用户不配置则无法从LeakIX获取SPIP URLs。
*   **Payload执行命令:** Payload中执行的命令是`whoami`，这是一个相对安全的命令，用于判断是否成功执行代码。但也存在执行其他命令的潜在风险。
*   **代码逻辑：** 代码逻辑相对清晰，主要是发送请求、解析响应和执行命令。但作者可以加入一些恶意代码来增加风险。
*   **第三方库：** 使用了`requests`、`bs4`、`rich`等第三方库，这些库本身可能存在安全漏洞。

综合考虑，该PoC代码存在少量投毒风险，可能被利用执行未经授权的命令、搜集或窃取用户信息。 风险评估为1%。

**项目地址:** [Chocapikk/CVE-2023-27372](https://github.com/Chocapikk/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #5

**来源**: [CVE-2023-27372-G01d3nW01f_cve-2023-27372.md](../2023/CVE-2023-27372-G01d3nW01f_cve-2023-27372.md)

## CVE-2023-27372 - SPIP Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution

**影响应用:** SPIP

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 4.2.1

**利用条件:** SPIP 实例需要可公开访问，并且运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372 是 SPIP CMS 中的一个远程代码执行漏洞，源于对反序列化数据处理不当。攻击者可以利用此漏洞通过在公共区域的表单值中注入恶意序列化数据来执行任意代码。

**有效性分析：**
提供的 exploit.py 脚本利用了此漏洞。它首先从目标 URL 的 `/spip/spip.php?page=spip_pass` 获取 `formulaire_action_args` 参数。然后，它构造一个包含恶意 PHP 代码的 POST 请求，该代码使用 `system()` 函数执行攻击者提供的命令。该恶意 PHP 代码被序列化并作为 `oubli` 参数传递。脚本的成功执行表明漏洞是可利用的。

**投毒风险分析：**
查看 exploit.py 脚本，其主要功能是利用 CVE-2023-27372 漏洞实现远程代码执行。脚本首先获取目标 URL，然后构造恶意 payload 并发送 POST 请求。脚本本身没有明显的恶意行为，如植入后门或传播恶意软件。
但是，该脚本本身依赖于用户提供的命令来执行 RCE。如果用户不小心执行了包含恶意命令的脚本，可能会导致目标系统受到损害。
在 readme.md 文件中，声明了 “education purpose only!!!!!”，降低了投毒的可能性。
仓库中，可能存在投毒代码的风险较低，约为 10%。

**利用方式：**
1.  攻击者向 SPIP 站点的 `/spip/spip.php?page=spip_pass` 发送 GET 请求。
2.  攻击者解析响应，提取 `formulaire_action_args` 参数。
3.  攻击者构造一个 POST 请求，将 `formulaire_action` 设置为 `oubli`，`formulaire_action_args` 设置为提取的值，并将恶意 PHP 代码序列化后作为 `oubli` 参数的值发送。
4.  SPIP 在处理 POST 请求时，反序列化 `oubli` 参数的值，导致恶意 PHP 代码被执行，从而实现远程代码执行。

**项目地址:** [G01d3nW01f/cve-2023-27372](https://github.com/G01d3nW01f/cve-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #6

**来源**: [CVE-2023-27372-ThatNotEasy_CVE-2023-27372.md](../2023/CVE-2023-27372-ThatNotEasy_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 目标网站必须运行存在漏洞的SPIP版本，且漏洞利用点对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP内容管理系统4.2.1之前版本中的一个远程代码执行漏洞。该漏洞源于SPIP处理反序列化数据的方式不当，允许未经身份验证的攻击者通过表单值执行任意命令。根据提供的漏洞利用代码，攻击者可以指定一个包含多个URL的文件和一个要执行的命令。该脚本会向这些URL发送特制的请求，其中包含序列化的恶意payload，从而在目标服务器上执行指定的命令，获取web用户权限。该漏洞利用代码的投毒风险较低，主要风险在于使用者自身行为，利用此工具进行未授权的渗透测试或攻击。因为代码中包含从 `lib/ua.txt` 读取 User-Agent 的操作，以及输出文件功能，存在一定的信息收集行为，可能用于后期攻击，但总体上代码逻辑清晰，风险可控。

**利用方式：**

1.  **漏洞定位：** SPIP 4.2.1之前的版本存在反序列化漏洞，具体位置在`oubli`参数中，允许在公共区域提交的表单值。
2.  **攻击流程：**
    *   攻击者构造包含恶意代码的序列化payload。
    *   将payload作为表单值提交给存在漏洞的SPIP站点。
    *   SPIP站点反序列化该数据时，恶意代码被执行。
3.  **漏洞利用代码分析：**
    *   `spip.py`脚本接受目标URL列表和要执行的命令作为参数。
    *   脚本使用`requests`库发送HTTP请求，将序列化的payload包含在POST请求的参数中。
    *   服务器端反序列化payload，执行攻击者指定的命令。
4.  **缓解措施：**
    *   将SPIP升级到3.2.18, 4.0.10, 4.1.8, 或 4.2.1及以上版本。
    *   限制对SPIP站点的公共访问。

**项目地址:** [ThatNotEasy/CVE-2023-27372](https://github.com/ThatNotEasy/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #7

**来源**: [CVE-2023-27372-dream434_CVE-2023-27372.md](../2023/CVE-2023-27372-dream434_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要目标SPIP站点存在漏洞页面且可公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27372 是 SPIP 内容管理系统（CMS）中存在的一个远程代码执行漏洞。该漏洞源于 SPIP 在处理表单值时，由于对序列化数据处理不当，导致攻击者可以通过构造恶意的序列化数据，将其作为表单参数提交到存在漏洞的页面，从而在服务器端执行任意代码。

**有效性：**

根据漏洞信息和搜索结果，提供的 POC 代码是有效的。多个资源（如 Packet Storm 和 GitHub 上的 Chocapikk/CVE-2023-27372）都提供了可用于利用该漏洞的 POC 或扫描器。

**投毒风险：**

代码中存在轻微的投毒风险。主要风险点在于：

*   **依赖项安装错误引导:** README.md文件引导用户安装 `collorama` , 正确的安装包应该是 `colorama`，如果用户安装了恶意攻击者伪造的 `collorama` 包，则可能存在安全风险。 *   **执行任意命令：** POC 允许执行任意命令。如果攻击者修改了 POC 中的 `whoami` 命令，替换为恶意命令，可能会造成更大的危害。例如，删除服务器文件、安装恶意软件等。但这种风险主要取决于使用者如何使用 POC，而非 POC 本身包含恶意代码。

考虑到这些因素，我将投毒风险评估为 5%。主要是安装包名称拼写错误引导，存在被利用的可能性。

**利用方式：**

1.  **查找目标：** 寻找运行 SPIP 且版本低于 4.2.1 的站点。
2.  **构造Payload：** 攻击者构造包含恶意 PHP 代码的序列化数据。
3.  **获取CSRF Token：** 首先，向 `/spip.php?page=spip_pass` 页面发起 GET 请求，解析 HTML 响应，提取名为 `formulaire_action_args` 的隐藏输入字段中的 CSRF token。
4.  **发送恶意请求：** 将构造的序列化数据作为 `oubli` 参数的值，连同其他必要的表单参数（包括上一步获取的 CSRF token）通过 POST 请求发送到 `/spip.php?page=spip_pass` 页面。
5.  **代码执行：** SPIP 在处理表单数据时，反序列化 `oubli` 参数，从而执行攻击者注入的恶意 PHP 代码。

简而言之，利用方式是通过构造包含恶意代码的序列化数据，并将其作为表单参数提交到 SPIP 站点，从而实现远程代码执行。

**项目地址:** [dream434/CVE-2023-27372](https://github.com/dream434/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #8

**来源**: [CVE-2023-27372-izzz0_CVE-2023-27372-POC.md](../2023/CVE-2023-27372-izzz0_CVE-2023-27372-POC.md)

## CVE-2023-27372-SPIP远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 目标服务器运行存在漏洞的SPIP版本，且漏洞利用发生在公共区域，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP 4.2.1之前版本中的一个远程代码执行漏洞。该漏洞是由于SPIP处理表单值中的序列化数据不当造成的。攻击者可以通过在公共区域提交包含恶意序列化数据的表单值来利用此漏洞，从而执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，该漏洞是有效的。POC代码通过构造特定的POST请求，向`spip.php?page=spip_pass`页面提交包含恶意PHP代码的序列化字符串，利用SPIP的反序列化漏洞执行代码。如果服务器返回包含`phpinfo()`结果的页面，则表明存在漏洞。

**投毒风险：**
代码主体逻辑是漏洞验证，风险较低。但仍然存在一定的投毒风险，因为攻击者可能修改POC代码，使其包含恶意操作，例如：

*   **植入后门:** POC中可以加入执行任意系统命令的代码，从而在目标服务器上植入后门。
*   **数据窃取:** POC可以被修改为窃取服务器上的敏感数据，例如数据库凭据或配置文件。
*   **拒绝服务攻击:** POC可以被修改为发送大量请求，导致目标服务器过载，从而造成拒绝服务攻击。
POC 使用 phpinfo() 验证，比较安全，但潜在风险依然存在。因此，投毒风险评估为10%。

**利用方式：**
1.  确定目标网站运行的SPIP版本低于4.2.1。
2.  向`spip.php?page=spip_pass`页面发送包含以下参数的POST请求：
    *   `formulaire_action=oubli`
    *   `formulaire_action_args`：从页面中提取的`formulaire_action_args`字段的值，进行URL编码。
    *   `oubli`: 包含恶意PHP代码的序列化字符串，例如`s:19:"<?php phpinfo(); ?>";`
    *   `nobot`：任意值，用于绕过反爬机制
3.  如果服务器返回包含恶意PHP代码执行结果的页面，则表明漏洞利用成功。例如，如果使用`phpinfo()`，则会返回phpinfo页面，或者反序列化任意类的函数，执行恶意代码。

**项目地址:** [izzz0/CVE-2023-27372-POC](https://github.com/izzz0/CVE-2023-27372-POC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #9

**来源**: [CVE-2023-27372-nuts7_CVE-2023-27372.md](../2023/CVE-2023-27372-nuts7_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要能够访问SPIP的登录页面或存在`spip_pass`页面的公开访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27372是SPIP 4.2.1之前的版本中的一个远程代码执行漏洞，原因是程序在处理表单值中的序列化数据时存在缺陷。攻击者可以通过在公共区域提交包含恶意序列化数据的表单，从而执行任意代码。PoC代码显示，它首先获取一个Anti-CSRF token，然后构造一个包含PHP代码的payload，该代码会执行指定的系统命令。这个漏洞的利用方式是，攻击者先访问登录页面 (`spip.php?page=spip_pass`)，获取`formulaire_action_args`的值 (Anti-CSRF token)。然后，攻击者构造一个POST请求，其中包含`page=spip_pass`， `formulaire_action=oubli`, `formulaire_action_args`为之前获取的CSRF token的值，并且`oubli`参数的值为精心构造的PHP序列化字符串，这个序列化字符串包含要执行的PHP代码 (使用 `system()`函数执行命令)。由于SPIP在反序列化这个`oubli`参数时存在漏洞，这会导致恶意代码执行。 

**有效性:** PoC代码有效，成功利用该漏洞能够在目标服务器上执行任意命令。

**投毒风险:** 经过检查`CVE-2023-27372.py`，`CVE-2023-27372.yaml`，`Dockerfile`和`README.md`文件。没有发现明显的恶意代码或者后门。`Dockerfile`用于构建一个包含易受攻击版本SPIP的环境，用于测试和演示漏洞。`CVE-2023-27372.yaml`是一个nuclei模板，用于检测目标是否存在此漏洞，该模板尝试执行phpinfo()，证明可以执行恶意代码。`README.md`提供有关漏洞的信息。

**利用方式:**

1.  **获取Anti-CSRF Token:**  访问受影响的SPIP站点的登录页面（`spip.php?page=spip_pass`），提取`formulaire_action_args`字段的值，即Anti-CSRF token。
2.  **构造Payload:**  构造一个包含恶意PHP代码的序列化字符串，例如`s:28:"<?php system('whoami'); ?>";`。这个字符串的长度需要根据实际的PHP代码长度进行调整。
3.  **发送Payload:**  通过POST请求将构造的Payload发送到`spip.php?page=spip_pass`，同时包含Anti-CSRF token和必要的表单参数。
4.  **执行代码:**  服务器在处理请求时，由于反序列化漏洞，会执行Payload中的PHP代码，从而实现远程代码执行。

**项目地址:** [nuts7/CVE-2023-27372](https://github.com/nuts7/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #10

**来源**: [CVE-2023-27372-redboltsec_CVE-2023-27372-PoC.md](../2023/CVE-2023-27372-redboltsec_CVE-2023-27372-PoC.md)

## CVE-2023-27372 SPIP RCE

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 4.2.1 (受影响版本包括3.2.18之前, 4.0.10之前, 4.1.8之前)

**利用条件:** 目标SPIP站点存在且可访问spip_pass页面，不需要任何权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27372 漏洞存在于 SPIP 4.2.1 之前的版本，允许未经身份验证的远程攻击者通过 `spip.php?page=spip_pass` 页面的 form values 执行任意代码。该漏洞源于 `ecrire/balise/formulaire_.php` 文件中 `protege_champ` 函数对序列化数据处理不当，未进行充分的输入验证，导致反序列化漏洞。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。Packet Storm Security 和 GitHub (Chocapikk/CVE-2023-27372) 都提供了漏洞利用代码或扫描器，证明该漏洞是可以被利用的。POC 代码通过构造恶意的序列化字符串，并将其作为 `oubli` 参数的值发送到 `spip.php?page=spip_pass` 页面，从而触发反序列化漏洞。

**投毒风险：**
分析提供的 PoC 代码 (`cve-2023-27372.py`)，未发现明显的投毒代码。该脚本的主要功能是：

1.  获取 CSRF token (如果存在)。
2.  构造包含恶意 PHP 代码的序列化 payload，该代码使用 `exec` 函数执行命令。
3.  将 payload 发送到目标 SPIP 站点。
4.  解析响应，提取命令执行结果。

脚本本身没有执行任何与目标系统无关的操作，例如上传恶意文件、修改系统配置或连接到外部服务器。因此，投毒风险较低。

**利用方式：**

1.  **定位目标:**  确定存在漏洞的 SPIP 站点，版本低于 4.2.1，且允许公共访问 `spip.php?page=spip_pass` 页面。
2.  **获取 CSRF Token (如果需要):** 访问 `spip.php?page=spip_pass` 页面，提取 CSRF token (`formulaire_action_args`)。有些情况下，可能不需要 CSRF token。
3.  **构造 Payload:**  构造包含恶意 PHP 代码的序列化字符串，用于执行任意命令。例如，使用 `<?php system($_GET['cmd']); ?>` 来执行 GET 请求中的 `cmd` 参数指定的命令。
4.  **发送 Payload:**  将构造的 Payload 作为 `oubli` 参数的值，通过 POST 请求发送到 `spip.php?page=spip_pass` 页面，同时附带 CSRF token (如果需要)。
5.  **执行命令:**  如果 Payload 成功执行，则可以通过构造特定的 HTTP 请求来执行任意命令。例如，访问 `spip.php?page=spip_pass&cmd=whoami` 来执行 `whoami` 命令，获取当前用户。
6.  **交互式 Shell (POC代码)**: PoC中尝试使用`whoami`检测是否RCE成功，如果失败，PoC会尝试生成一个交互式shell。这部分代码可能存在问题，需要用户多次输入命令。

**缓解措施：**
升级到 SPIP 4.2.1 或更高版本，或者应用补丁以修复反序列化漏洞。


**项目地址:** [redboltsec/CVE-2023-27372-PoC](https://github.com/redboltsec/CVE-2023-27372-PoC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---



---

## POC #3

**来源**: [CVE-2023-27372-1amthebest1_CVE-2023-27372.md](../2023/CVE-2023-27372-1amthebest1_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1 (受影响版本还包括3.2.x, 4.0.x, 4.1.x)

**利用条件:** 需要能够通过网络访问SPIP站点，且SPIP版本低于4.2.1，未应用安全补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27372 是 SPIP 4.2.1 之前版本中的一个远程代码执行 (RCE) 漏洞。该漏洞的根本原因是程序未正确处理反序列化数据，导致攻击者可以通过构造恶意表单值，在服务器上执行任意代码。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判断该PoC代码有效。
- 漏洞库信息明确指出SPIP在4.2.1之前的版本存在RCE漏洞，并通过不安全的反序列化来实现。
- 搜索引擎结果也证实了该漏洞的存在，并提供了多个漏洞分析和利用链接。
- PoC代码通过利用`spip_pass`页面中的`oubli`参数，传递一个包含PHP代码的序列化字符串，从而执行任意命令。该代码首先获取CSRF token，然后构造包含恶意PHP代码的payload，并发送POST请求到`spip.php?page=spip_pass`。恶意PHP代码使用`system`函数执行经过base64编码的命令。

**投毒风险分析：**
仔细检查了提供的PoC代码，没有发现明显的投毒代码。该代码结构清晰，功能明确，主要用于验证和利用漏洞。风险百分比评估为0%。

**利用方式：**
1.  **漏洞定位：** 该漏洞存在于 SPIP 的前台页面，攻击者无需认证即可利用。
2.  **CSRF Token 获取：** 攻击者首先访问 `spip.php?page=spip_pass` 页面，从中提取 CSRF Token，用于绕过 CSRF 保护。
3.  **Payload 构造：** 攻击者构造一个包含恶意 PHP 代码的序列化字符串。该 PHP 代码通常使用 `system()` 函数执行任意命令。为了避免过滤，命令通常会进行 base64 编码。
4.  **漏洞触发：** 攻击者将构造好的 Payload 放入 `oubli` 参数中，通过 POST 请求发送到 `spip.php?page=spip_pass` 页面，触发反序列化漏洞，从而执行任意代码。
5.  **反弹shell:** 通过反弹shell获得目标机器的权限。


**项目地址:** [1amthebest1/CVE-2023-27372](https://github.com/1amthebest1/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #4

**来源**: [CVE-2023-27372-Chocapikk_CVE-2023-27372.md](../2023/CVE-2023-27372-Chocapikk_CVE-2023-27372.md)

## CVE-2023-27372 SPIP Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要目标SPIP站点存在，且能访问其spip.php?page=spip_pass页面

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27372是SPIP CMS 4.2.1之前版本中的一个远程代码执行漏洞。该漏洞源于程序在处理表单值时，反序列化过程存在缺陷。未经身份验证的攻击者可以通过向易受攻击的SPIP实例上的spip.php?page=spip_pass页面提交特制的表单值，从而利用此漏洞执行任意代码。

**漏洞利用方式：**

1.  **获取Anti-CSRF Token：** PoC脚本首先访问`spip.php?page=spip_pass`页面，解析HTML，提取名为`formulaire_action_args`的input标签中的`value`属性，该值用作Anti-CSRF token。
2.  **构造恶意Payload：**  PoC脚本使用PHP序列化的方式构造恶意代码，通过`oubli`参数传递给`spip.php?page=spip_pass`。
3.  **发送POST请求：**  将包含Anti-CSRF token和恶意payload的POST请求发送到`spip.php?page=spip_pass`，触发反序列化漏洞，从而执行任意代码。
4.  **解析输出：**PoC脚本使用正则表达式提取命令执行结果，如果执行`whoami`成功则认为漏洞存在。

**有效性：**

根据漏洞库信息、搜索结果，以及提供的PoC代码，可以确定该漏洞是真实存在的，并且该PoC代码看起来可以有效利用该漏洞实现远程代码执行。

**投毒风险：**

检查PoC代码发现，该脚本的功能主要是利用CVE-2023-27372漏洞进行RCE验证。通过以下几个方面评估投毒风险：

*   **LeakIX API Key配置:** 脚本中`LEAKIX_API_KEY` 变量需要用户自己配置LeakIX API Key，如果用户不配置则无法从LeakIX获取SPIP URLs。
*   **Payload执行命令:** Payload中执行的命令是`whoami`，这是一个相对安全的命令，用于判断是否成功执行代码。但也存在执行其他命令的潜在风险。
*   **代码逻辑：** 代码逻辑相对清晰，主要是发送请求、解析响应和执行命令。但作者可以加入一些恶意代码来增加风险。
*   **第三方库：** 使用了`requests`、`bs4`、`rich`等第三方库，这些库本身可能存在安全漏洞。

综合考虑，该PoC代码存在少量投毒风险，可能被利用执行未经授权的命令、搜集或窃取用户信息。 风险评估为1%。

**项目地址:** [Chocapikk/CVE-2023-27372](https://github.com/Chocapikk/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #5

**来源**: [CVE-2023-27372-G01d3nW01f_cve-2023-27372.md](../2023/CVE-2023-27372-G01d3nW01f_cve-2023-27372.md)

## CVE-2023-27372 - SPIP Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution

**影响应用:** SPIP

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 4.2.1

**利用条件:** SPIP 实例需要可公开访问，并且运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372 是 SPIP CMS 中的一个远程代码执行漏洞，源于对反序列化数据处理不当。攻击者可以利用此漏洞通过在公共区域的表单值中注入恶意序列化数据来执行任意代码。

**有效性分析：**
提供的 exploit.py 脚本利用了此漏洞。它首先从目标 URL 的 `/spip/spip.php?page=spip_pass` 获取 `formulaire_action_args` 参数。然后，它构造一个包含恶意 PHP 代码的 POST 请求，该代码使用 `system()` 函数执行攻击者提供的命令。该恶意 PHP 代码被序列化并作为 `oubli` 参数传递。脚本的成功执行表明漏洞是可利用的。

**投毒风险分析：**
查看 exploit.py 脚本，其主要功能是利用 CVE-2023-27372 漏洞实现远程代码执行。脚本首先获取目标 URL，然后构造恶意 payload 并发送 POST 请求。脚本本身没有明显的恶意行为，如植入后门或传播恶意软件。
但是，该脚本本身依赖于用户提供的命令来执行 RCE。如果用户不小心执行了包含恶意命令的脚本，可能会导致目标系统受到损害。
在 readme.md 文件中，声明了 “education purpose only!!!!!”，降低了投毒的可能性。
仓库中，可能存在投毒代码的风险较低，约为 10%。

**利用方式：**
1.  攻击者向 SPIP 站点的 `/spip/spip.php?page=spip_pass` 发送 GET 请求。
2.  攻击者解析响应，提取 `formulaire_action_args` 参数。
3.  攻击者构造一个 POST 请求，将 `formulaire_action` 设置为 `oubli`，`formulaire_action_args` 设置为提取的值，并将恶意 PHP 代码序列化后作为 `oubli` 参数的值发送。
4.  SPIP 在处理 POST 请求时，反序列化 `oubli` 参数的值，导致恶意 PHP 代码被执行，从而实现远程代码执行。

**项目地址:** [G01d3nW01f/cve-2023-27372](https://github.com/G01d3nW01f/cve-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #6

**来源**: [CVE-2023-27372-ThatNotEasy_CVE-2023-27372.md](../2023/CVE-2023-27372-ThatNotEasy_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 目标网站必须运行存在漏洞的SPIP版本，且漏洞利用点对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP内容管理系统4.2.1之前版本中的一个远程代码执行漏洞。该漏洞源于SPIP处理反序列化数据的方式不当，允许未经身份验证的攻击者通过表单值执行任意命令。根据提供的漏洞利用代码，攻击者可以指定一个包含多个URL的文件和一个要执行的命令。该脚本会向这些URL发送特制的请求，其中包含序列化的恶意payload，从而在目标服务器上执行指定的命令，获取web用户权限。该漏洞利用代码的投毒风险较低，主要风险在于使用者自身行为，利用此工具进行未授权的渗透测试或攻击。因为代码中包含从 `lib/ua.txt` 读取 User-Agent 的操作，以及输出文件功能，存在一定的信息收集行为，可能用于后期攻击，但总体上代码逻辑清晰，风险可控。

**利用方式：**

1.  **漏洞定位：** SPIP 4.2.1之前的版本存在反序列化漏洞，具体位置在`oubli`参数中，允许在公共区域提交的表单值。
2.  **攻击流程：**
    *   攻击者构造包含恶意代码的序列化payload。
    *   将payload作为表单值提交给存在漏洞的SPIP站点。
    *   SPIP站点反序列化该数据时，恶意代码被执行。
3.  **漏洞利用代码分析：**
    *   `spip.py`脚本接受目标URL列表和要执行的命令作为参数。
    *   脚本使用`requests`库发送HTTP请求，将序列化的payload包含在POST请求的参数中。
    *   服务器端反序列化payload，执行攻击者指定的命令。
4.  **缓解措施：**
    *   将SPIP升级到3.2.18, 4.0.10, 4.1.8, 或 4.2.1及以上版本。
    *   限制对SPIP站点的公共访问。

**项目地址:** [ThatNotEasy/CVE-2023-27372](https://github.com/ThatNotEasy/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #7

**来源**: [CVE-2023-27372-dream434_CVE-2023-27372.md](../2023/CVE-2023-27372-dream434_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要目标SPIP站点存在漏洞页面且可公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27372 是 SPIP 内容管理系统（CMS）中存在的一个远程代码执行漏洞。该漏洞源于 SPIP 在处理表单值时，由于对序列化数据处理不当，导致攻击者可以通过构造恶意的序列化数据，将其作为表单参数提交到存在漏洞的页面，从而在服务器端执行任意代码。

**有效性：**

根据漏洞信息和搜索结果，提供的 POC 代码是有效的。多个资源（如 Packet Storm 和 GitHub 上的 Chocapikk/CVE-2023-27372）都提供了可用于利用该漏洞的 POC 或扫描器。

**投毒风险：**

代码中存在轻微的投毒风险。主要风险点在于：

*   **依赖项安装错误引导:** README.md文件引导用户安装 `collorama` , 正确的安装包应该是 `colorama`，如果用户安装了恶意攻击者伪造的 `collorama` 包，则可能存在安全风险。 *   **执行任意命令：** POC 允许执行任意命令。如果攻击者修改了 POC 中的 `whoami` 命令，替换为恶意命令，可能会造成更大的危害。例如，删除服务器文件、安装恶意软件等。但这种风险主要取决于使用者如何使用 POC，而非 POC 本身包含恶意代码。

考虑到这些因素，我将投毒风险评估为 5%。主要是安装包名称拼写错误引导，存在被利用的可能性。

**利用方式：**

1.  **查找目标：** 寻找运行 SPIP 且版本低于 4.2.1 的站点。
2.  **构造Payload：** 攻击者构造包含恶意 PHP 代码的序列化数据。
3.  **获取CSRF Token：** 首先，向 `/spip.php?page=spip_pass` 页面发起 GET 请求，解析 HTML 响应，提取名为 `formulaire_action_args` 的隐藏输入字段中的 CSRF token。
4.  **发送恶意请求：** 将构造的序列化数据作为 `oubli` 参数的值，连同其他必要的表单参数（包括上一步获取的 CSRF token）通过 POST 请求发送到 `/spip.php?page=spip_pass` 页面。
5.  **代码执行：** SPIP 在处理表单数据时，反序列化 `oubli` 参数，从而执行攻击者注入的恶意 PHP 代码。

简而言之，利用方式是通过构造包含恶意代码的序列化数据，并将其作为表单参数提交到 SPIP 站点，从而实现远程代码执行。

**项目地址:** [dream434/CVE-2023-27372](https://github.com/dream434/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #8

**来源**: [CVE-2023-27372-izzz0_CVE-2023-27372-POC.md](../2023/CVE-2023-27372-izzz0_CVE-2023-27372-POC.md)

## CVE-2023-27372-SPIP远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 目标服务器运行存在漏洞的SPIP版本，且漏洞利用发生在公共区域，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP 4.2.1之前版本中的一个远程代码执行漏洞。该漏洞是由于SPIP处理表单值中的序列化数据不当造成的。攻击者可以通过在公共区域提交包含恶意序列化数据的表单值来利用此漏洞，从而执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，该漏洞是有效的。POC代码通过构造特定的POST请求，向`spip.php?page=spip_pass`页面提交包含恶意PHP代码的序列化字符串，利用SPIP的反序列化漏洞执行代码。如果服务器返回包含`phpinfo()`结果的页面，则表明存在漏洞。

**投毒风险：**
代码主体逻辑是漏洞验证，风险较低。但仍然存在一定的投毒风险，因为攻击者可能修改POC代码，使其包含恶意操作，例如：

*   **植入后门:** POC中可以加入执行任意系统命令的代码，从而在目标服务器上植入后门。
*   **数据窃取:** POC可以被修改为窃取服务器上的敏感数据，例如数据库凭据或配置文件。
*   **拒绝服务攻击:** POC可以被修改为发送大量请求，导致目标服务器过载，从而造成拒绝服务攻击。
POC 使用 phpinfo() 验证，比较安全，但潜在风险依然存在。因此，投毒风险评估为10%。

**利用方式：**
1.  确定目标网站运行的SPIP版本低于4.2.1。
2.  向`spip.php?page=spip_pass`页面发送包含以下参数的POST请求：
    *   `formulaire_action=oubli`
    *   `formulaire_action_args`：从页面中提取的`formulaire_action_args`字段的值，进行URL编码。
    *   `oubli`: 包含恶意PHP代码的序列化字符串，例如`s:19:"<?php phpinfo(); ?>";`
    *   `nobot`：任意值，用于绕过反爬机制
3.  如果服务器返回包含恶意PHP代码执行结果的页面，则表明漏洞利用成功。例如，如果使用`phpinfo()`，则会返回phpinfo页面，或者反序列化任意类的函数，执行恶意代码。

**项目地址:** [izzz0/CVE-2023-27372-POC](https://github.com/izzz0/CVE-2023-27372-POC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #9

**来源**: [CVE-2023-27372-nuts7_CVE-2023-27372.md](../2023/CVE-2023-27372-nuts7_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要能够访问SPIP的登录页面或存在`spip_pass`页面的公开访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27372是SPIP 4.2.1之前的版本中的一个远程代码执行漏洞，原因是程序在处理表单值中的序列化数据时存在缺陷。攻击者可以通过在公共区域提交包含恶意序列化数据的表单，从而执行任意代码。PoC代码显示，它首先获取一个Anti-CSRF token，然后构造一个包含PHP代码的payload，该代码会执行指定的系统命令。这个漏洞的利用方式是，攻击者先访问登录页面 (`spip.php?page=spip_pass`)，获取`formulaire_action_args`的值 (Anti-CSRF token)。然后，攻击者构造一个POST请求，其中包含`page=spip_pass`， `formulaire_action=oubli`, `formulaire_action_args`为之前获取的CSRF token的值，并且`oubli`参数的值为精心构造的PHP序列化字符串，这个序列化字符串包含要执行的PHP代码 (使用 `system()`函数执行命令)。由于SPIP在反序列化这个`oubli`参数时存在漏洞，这会导致恶意代码执行。 

**有效性:** PoC代码有效，成功利用该漏洞能够在目标服务器上执行任意命令。

**投毒风险:** 经过检查`CVE-2023-27372.py`，`CVE-2023-27372.yaml`，`Dockerfile`和`README.md`文件。没有发现明显的恶意代码或者后门。`Dockerfile`用于构建一个包含易受攻击版本SPIP的环境，用于测试和演示漏洞。`CVE-2023-27372.yaml`是一个nuclei模板，用于检测目标是否存在此漏洞，该模板尝试执行phpinfo()，证明可以执行恶意代码。`README.md`提供有关漏洞的信息。

**利用方式:**

1.  **获取Anti-CSRF Token:**  访问受影响的SPIP站点的登录页面（`spip.php?page=spip_pass`），提取`formulaire_action_args`字段的值，即Anti-CSRF token。
2.  **构造Payload:**  构造一个包含恶意PHP代码的序列化字符串，例如`s:28:"<?php system('whoami'); ?>";`。这个字符串的长度需要根据实际的PHP代码长度进行调整。
3.  **发送Payload:**  通过POST请求将构造的Payload发送到`spip.php?page=spip_pass`，同时包含Anti-CSRF token和必要的表单参数。
4.  **执行代码:**  服务器在处理请求时，由于反序列化漏洞，会执行Payload中的PHP代码，从而实现远程代码执行。

**项目地址:** [nuts7/CVE-2023-27372](https://github.com/nuts7/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #10

**来源**: [CVE-2023-27372-redboltsec_CVE-2023-27372-PoC.md](../2023/CVE-2023-27372-redboltsec_CVE-2023-27372-PoC.md)

## CVE-2023-27372 SPIP RCE

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 4.2.1 (受影响版本包括3.2.18之前, 4.0.10之前, 4.1.8之前)

**利用条件:** 目标SPIP站点存在且可访问spip_pass页面，不需要任何权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27372 漏洞存在于 SPIP 4.2.1 之前的版本，允许未经身份验证的远程攻击者通过 `spip.php?page=spip_pass` 页面的 form values 执行任意代码。该漏洞源于 `ecrire/balise/formulaire_.php` 文件中 `protege_champ` 函数对序列化数据处理不当，未进行充分的输入验证，导致反序列化漏洞。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。Packet Storm Security 和 GitHub (Chocapikk/CVE-2023-27372) 都提供了漏洞利用代码或扫描器，证明该漏洞是可以被利用的。POC 代码通过构造恶意的序列化字符串，并将其作为 `oubli` 参数的值发送到 `spip.php?page=spip_pass` 页面，从而触发反序列化漏洞。

**投毒风险：**
分析提供的 PoC 代码 (`cve-2023-27372.py`)，未发现明显的投毒代码。该脚本的主要功能是：

1.  获取 CSRF token (如果存在)。
2.  构造包含恶意 PHP 代码的序列化 payload，该代码使用 `exec` 函数执行命令。
3.  将 payload 发送到目标 SPIP 站点。
4.  解析响应，提取命令执行结果。

脚本本身没有执行任何与目标系统无关的操作，例如上传恶意文件、修改系统配置或连接到外部服务器。因此，投毒风险较低。

**利用方式：**

1.  **定位目标:**  确定存在漏洞的 SPIP 站点，版本低于 4.2.1，且允许公共访问 `spip.php?page=spip_pass` 页面。
2.  **获取 CSRF Token (如果需要):** 访问 `spip.php?page=spip_pass` 页面，提取 CSRF token (`formulaire_action_args`)。有些情况下，可能不需要 CSRF token。
3.  **构造 Payload:**  构造包含恶意 PHP 代码的序列化字符串，用于执行任意命令。例如，使用 `<?php system($_GET['cmd']); ?>` 来执行 GET 请求中的 `cmd` 参数指定的命令。
4.  **发送 Payload:**  将构造的 Payload 作为 `oubli` 参数的值，通过 POST 请求发送到 `spip.php?page=spip_pass` 页面，同时附带 CSRF token (如果需要)。
5.  **执行命令:**  如果 Payload 成功执行，则可以通过构造特定的 HTTP 请求来执行任意命令。例如，访问 `spip.php?page=spip_pass&cmd=whoami` 来执行 `whoami` 命令，获取当前用户。
6.  **交互式 Shell (POC代码)**: PoC中尝试使用`whoami`检测是否RCE成功，如果失败，PoC会尝试生成一个交互式shell。这部分代码可能存在问题，需要用户多次输入命令。

**缓解措施：**
升级到 SPIP 4.2.1 或更高版本，或者应用补丁以修复反序列化漏洞。


**项目地址:** [redboltsec/CVE-2023-27372-PoC](https://github.com/redboltsec/CVE-2023-27372-PoC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---



---

## POC #3

**来源**: [CVE-2023-27372-1amthebest1_CVE-2023-27372.md](../2023/CVE-2023-27372-1amthebest1_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1 (受影响版本还包括3.2.x, 4.0.x, 4.1.x)

**利用条件:** 需要能够通过网络访问SPIP站点，且SPIP版本低于4.2.1，未应用安全补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27372 是 SPIP 4.2.1 之前版本中的一个远程代码执行 (RCE) 漏洞。该漏洞的根本原因是程序未正确处理反序列化数据，导致攻击者可以通过构造恶意表单值，在服务器上执行任意代码。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判断该PoC代码有效。
- 漏洞库信息明确指出SPIP在4.2.1之前的版本存在RCE漏洞，并通过不安全的反序列化来实现。
- 搜索引擎结果也证实了该漏洞的存在，并提供了多个漏洞分析和利用链接。
- PoC代码通过利用`spip_pass`页面中的`oubli`参数，传递一个包含PHP代码的序列化字符串，从而执行任意命令。该代码首先获取CSRF token，然后构造包含恶意PHP代码的payload，并发送POST请求到`spip.php?page=spip_pass`。恶意PHP代码使用`system`函数执行经过base64编码的命令。

**投毒风险分析：**
仔细检查了提供的PoC代码，没有发现明显的投毒代码。该代码结构清晰，功能明确，主要用于验证和利用漏洞。风险百分比评估为0%。

**利用方式：**
1.  **漏洞定位：** 该漏洞存在于 SPIP 的前台页面，攻击者无需认证即可利用。
2.  **CSRF Token 获取：** 攻击者首先访问 `spip.php?page=spip_pass` 页面，从中提取 CSRF Token，用于绕过 CSRF 保护。
3.  **Payload 构造：** 攻击者构造一个包含恶意 PHP 代码的序列化字符串。该 PHP 代码通常使用 `system()` 函数执行任意命令。为了避免过滤，命令通常会进行 base64 编码。
4.  **漏洞触发：** 攻击者将构造好的 Payload 放入 `oubli` 参数中，通过 POST 请求发送到 `spip.php?page=spip_pass` 页面，触发反序列化漏洞，从而执行任意代码。
5.  **反弹shell:** 通过反弹shell获得目标机器的权限。


**项目地址:** [1amthebest1/CVE-2023-27372](https://github.com/1amthebest1/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #4

**来源**: [CVE-2023-27372-Chocapikk_CVE-2023-27372.md](../2023/CVE-2023-27372-Chocapikk_CVE-2023-27372.md)

## CVE-2023-27372 SPIP Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要目标SPIP站点存在，且能访问其spip.php?page=spip_pass页面

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27372是SPIP CMS 4.2.1之前版本中的一个远程代码执行漏洞。该漏洞源于程序在处理表单值时，反序列化过程存在缺陷。未经身份验证的攻击者可以通过向易受攻击的SPIP实例上的spip.php?page=spip_pass页面提交特制的表单值，从而利用此漏洞执行任意代码。

**漏洞利用方式：**

1.  **获取Anti-CSRF Token：** PoC脚本首先访问`spip.php?page=spip_pass`页面，解析HTML，提取名为`formulaire_action_args`的input标签中的`value`属性，该值用作Anti-CSRF token。
2.  **构造恶意Payload：**  PoC脚本使用PHP序列化的方式构造恶意代码，通过`oubli`参数传递给`spip.php?page=spip_pass`。
3.  **发送POST请求：**  将包含Anti-CSRF token和恶意payload的POST请求发送到`spip.php?page=spip_pass`，触发反序列化漏洞，从而执行任意代码。
4.  **解析输出：**PoC脚本使用正则表达式提取命令执行结果，如果执行`whoami`成功则认为漏洞存在。

**有效性：**

根据漏洞库信息、搜索结果，以及提供的PoC代码，可以确定该漏洞是真实存在的，并且该PoC代码看起来可以有效利用该漏洞实现远程代码执行。

**投毒风险：**

检查PoC代码发现，该脚本的功能主要是利用CVE-2023-27372漏洞进行RCE验证。通过以下几个方面评估投毒风险：

*   **LeakIX API Key配置:** 脚本中`LEAKIX_API_KEY` 变量需要用户自己配置LeakIX API Key，如果用户不配置则无法从LeakIX获取SPIP URLs。
*   **Payload执行命令:** Payload中执行的命令是`whoami`，这是一个相对安全的命令，用于判断是否成功执行代码。但也存在执行其他命令的潜在风险。
*   **代码逻辑：** 代码逻辑相对清晰，主要是发送请求、解析响应和执行命令。但作者可以加入一些恶意代码来增加风险。
*   **第三方库：** 使用了`requests`、`bs4`、`rich`等第三方库，这些库本身可能存在安全漏洞。

综合考虑，该PoC代码存在少量投毒风险，可能被利用执行未经授权的命令、搜集或窃取用户信息。 风险评估为1%。

**项目地址:** [Chocapikk/CVE-2023-27372](https://github.com/Chocapikk/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #5

**来源**: [CVE-2023-27372-G01d3nW01f_cve-2023-27372.md](../2023/CVE-2023-27372-G01d3nW01f_cve-2023-27372.md)

## CVE-2023-27372 - SPIP Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution

**影响应用:** SPIP

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 4.2.1

**利用条件:** SPIP 实例需要可公开访问，并且运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372 是 SPIP CMS 中的一个远程代码执行漏洞，源于对反序列化数据处理不当。攻击者可以利用此漏洞通过在公共区域的表单值中注入恶意序列化数据来执行任意代码。

**有效性分析：**
提供的 exploit.py 脚本利用了此漏洞。它首先从目标 URL 的 `/spip/spip.php?page=spip_pass` 获取 `formulaire_action_args` 参数。然后，它构造一个包含恶意 PHP 代码的 POST 请求，该代码使用 `system()` 函数执行攻击者提供的命令。该恶意 PHP 代码被序列化并作为 `oubli` 参数传递。脚本的成功执行表明漏洞是可利用的。

**投毒风险分析：**
查看 exploit.py 脚本，其主要功能是利用 CVE-2023-27372 漏洞实现远程代码执行。脚本首先获取目标 URL，然后构造恶意 payload 并发送 POST 请求。脚本本身没有明显的恶意行为，如植入后门或传播恶意软件。
但是，该脚本本身依赖于用户提供的命令来执行 RCE。如果用户不小心执行了包含恶意命令的脚本，可能会导致目标系统受到损害。
在 readme.md 文件中，声明了 “education purpose only!!!!!”，降低了投毒的可能性。
仓库中，可能存在投毒代码的风险较低，约为 10%。

**利用方式：**
1.  攻击者向 SPIP 站点的 `/spip/spip.php?page=spip_pass` 发送 GET 请求。
2.  攻击者解析响应，提取 `formulaire_action_args` 参数。
3.  攻击者构造一个 POST 请求，将 `formulaire_action` 设置为 `oubli`，`formulaire_action_args` 设置为提取的值，并将恶意 PHP 代码序列化后作为 `oubli` 参数的值发送。
4.  SPIP 在处理 POST 请求时，反序列化 `oubli` 参数的值，导致恶意 PHP 代码被执行，从而实现远程代码执行。

**项目地址:** [G01d3nW01f/cve-2023-27372](https://github.com/G01d3nW01f/cve-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #6

**来源**: [CVE-2023-27372-ThatNotEasy_CVE-2023-27372.md](../2023/CVE-2023-27372-ThatNotEasy_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 目标网站必须运行存在漏洞的SPIP版本，且漏洞利用点对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP内容管理系统4.2.1之前版本中的一个远程代码执行漏洞。该漏洞源于SPIP处理反序列化数据的方式不当，允许未经身份验证的攻击者通过表单值执行任意命令。根据提供的漏洞利用代码，攻击者可以指定一个包含多个URL的文件和一个要执行的命令。该脚本会向这些URL发送特制的请求，其中包含序列化的恶意payload，从而在目标服务器上执行指定的命令，获取web用户权限。该漏洞利用代码的投毒风险较低，主要风险在于使用者自身行为，利用此工具进行未授权的渗透测试或攻击。因为代码中包含从 `lib/ua.txt` 读取 User-Agent 的操作，以及输出文件功能，存在一定的信息收集行为，可能用于后期攻击，但总体上代码逻辑清晰，风险可控。

**利用方式：**

1.  **漏洞定位：** SPIP 4.2.1之前的版本存在反序列化漏洞，具体位置在`oubli`参数中，允许在公共区域提交的表单值。
2.  **攻击流程：**
    *   攻击者构造包含恶意代码的序列化payload。
    *   将payload作为表单值提交给存在漏洞的SPIP站点。
    *   SPIP站点反序列化该数据时，恶意代码被执行。
3.  **漏洞利用代码分析：**
    *   `spip.py`脚本接受目标URL列表和要执行的命令作为参数。
    *   脚本使用`requests`库发送HTTP请求，将序列化的payload包含在POST请求的参数中。
    *   服务器端反序列化payload，执行攻击者指定的命令。
4.  **缓解措施：**
    *   将SPIP升级到3.2.18, 4.0.10, 4.1.8, 或 4.2.1及以上版本。
    *   限制对SPIP站点的公共访问。

**项目地址:** [ThatNotEasy/CVE-2023-27372](https://github.com/ThatNotEasy/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #7

**来源**: [CVE-2023-27372-dream434_CVE-2023-27372.md](../2023/CVE-2023-27372-dream434_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要目标SPIP站点存在漏洞页面且可公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27372 是 SPIP 内容管理系统（CMS）中存在的一个远程代码执行漏洞。该漏洞源于 SPIP 在处理表单值时，由于对序列化数据处理不当，导致攻击者可以通过构造恶意的序列化数据，将其作为表单参数提交到存在漏洞的页面，从而在服务器端执行任意代码。

**有效性：**

根据漏洞信息和搜索结果，提供的 POC 代码是有效的。多个资源（如 Packet Storm 和 GitHub 上的 Chocapikk/CVE-2023-27372）都提供了可用于利用该漏洞的 POC 或扫描器。

**投毒风险：**

代码中存在轻微的投毒风险。主要风险点在于：

*   **依赖项安装错误引导:** README.md文件引导用户安装 `collorama` , 正确的安装包应该是 `colorama`，如果用户安装了恶意攻击者伪造的 `collorama` 包，则可能存在安全风险。 *   **执行任意命令：** POC 允许执行任意命令。如果攻击者修改了 POC 中的 `whoami` 命令，替换为恶意命令，可能会造成更大的危害。例如，删除服务器文件、安装恶意软件等。但这种风险主要取决于使用者如何使用 POC，而非 POC 本身包含恶意代码。

考虑到这些因素，我将投毒风险评估为 5%。主要是安装包名称拼写错误引导，存在被利用的可能性。

**利用方式：**

1.  **查找目标：** 寻找运行 SPIP 且版本低于 4.2.1 的站点。
2.  **构造Payload：** 攻击者构造包含恶意 PHP 代码的序列化数据。
3.  **获取CSRF Token：** 首先，向 `/spip.php?page=spip_pass` 页面发起 GET 请求，解析 HTML 响应，提取名为 `formulaire_action_args` 的隐藏输入字段中的 CSRF token。
4.  **发送恶意请求：** 将构造的序列化数据作为 `oubli` 参数的值，连同其他必要的表单参数（包括上一步获取的 CSRF token）通过 POST 请求发送到 `/spip.php?page=spip_pass` 页面。
5.  **代码执行：** SPIP 在处理表单数据时，反序列化 `oubli` 参数，从而执行攻击者注入的恶意 PHP 代码。

简而言之，利用方式是通过构造包含恶意代码的序列化数据，并将其作为表单参数提交到 SPIP 站点，从而实现远程代码执行。

**项目地址:** [dream434/CVE-2023-27372](https://github.com/dream434/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #8

**来源**: [CVE-2023-27372-izzz0_CVE-2023-27372-POC.md](../2023/CVE-2023-27372-izzz0_CVE-2023-27372-POC.md)

## CVE-2023-27372-SPIP远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 目标服务器运行存在漏洞的SPIP版本，且漏洞利用发生在公共区域，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP 4.2.1之前版本中的一个远程代码执行漏洞。该漏洞是由于SPIP处理表单值中的序列化数据不当造成的。攻击者可以通过在公共区域提交包含恶意序列化数据的表单值来利用此漏洞，从而执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，该漏洞是有效的。POC代码通过构造特定的POST请求，向`spip.php?page=spip_pass`页面提交包含恶意PHP代码的序列化字符串，利用SPIP的反序列化漏洞执行代码。如果服务器返回包含`phpinfo()`结果的页面，则表明存在漏洞。

**投毒风险：**
代码主体逻辑是漏洞验证，风险较低。但仍然存在一定的投毒风险，因为攻击者可能修改POC代码，使其包含恶意操作，例如：

*   **植入后门:** POC中可以加入执行任意系统命令的代码，从而在目标服务器上植入后门。
*   **数据窃取:** POC可以被修改为窃取服务器上的敏感数据，例如数据库凭据或配置文件。
*   **拒绝服务攻击:** POC可以被修改为发送大量请求，导致目标服务器过载，从而造成拒绝服务攻击。
POC 使用 phpinfo() 验证，比较安全，但潜在风险依然存在。因此，投毒风险评估为10%。

**利用方式：**
1.  确定目标网站运行的SPIP版本低于4.2.1。
2.  向`spip.php?page=spip_pass`页面发送包含以下参数的POST请求：
    *   `formulaire_action=oubli`
    *   `formulaire_action_args`：从页面中提取的`formulaire_action_args`字段的值，进行URL编码。
    *   `oubli`: 包含恶意PHP代码的序列化字符串，例如`s:19:"<?php phpinfo(); ?>";`
    *   `nobot`：任意值，用于绕过反爬机制
3.  如果服务器返回包含恶意PHP代码执行结果的页面，则表明漏洞利用成功。例如，如果使用`phpinfo()`，则会返回phpinfo页面，或者反序列化任意类的函数，执行恶意代码。

**项目地址:** [izzz0/CVE-2023-27372-POC](https://github.com/izzz0/CVE-2023-27372-POC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #9

**来源**: [CVE-2023-27372-nuts7_CVE-2023-27372.md](../2023/CVE-2023-27372-nuts7_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要能够访问SPIP的登录页面或存在`spip_pass`页面的公开访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27372是SPIP 4.2.1之前的版本中的一个远程代码执行漏洞，原因是程序在处理表单值中的序列化数据时存在缺陷。攻击者可以通过在公共区域提交包含恶意序列化数据的表单，从而执行任意代码。PoC代码显示，它首先获取一个Anti-CSRF token，然后构造一个包含PHP代码的payload，该代码会执行指定的系统命令。这个漏洞的利用方式是，攻击者先访问登录页面 (`spip.php?page=spip_pass`)，获取`formulaire_action_args`的值 (Anti-CSRF token)。然后，攻击者构造一个POST请求，其中包含`page=spip_pass`， `formulaire_action=oubli`, `formulaire_action_args`为之前获取的CSRF token的值，并且`oubli`参数的值为精心构造的PHP序列化字符串，这个序列化字符串包含要执行的PHP代码 (使用 `system()`函数执行命令)。由于SPIP在反序列化这个`oubli`参数时存在漏洞，这会导致恶意代码执行。 

**有效性:** PoC代码有效，成功利用该漏洞能够在目标服务器上执行任意命令。

**投毒风险:** 经过检查`CVE-2023-27372.py`，`CVE-2023-27372.yaml`，`Dockerfile`和`README.md`文件。没有发现明显的恶意代码或者后门。`Dockerfile`用于构建一个包含易受攻击版本SPIP的环境，用于测试和演示漏洞。`CVE-2023-27372.yaml`是一个nuclei模板，用于检测目标是否存在此漏洞，该模板尝试执行phpinfo()，证明可以执行恶意代码。`README.md`提供有关漏洞的信息。

**利用方式:**

1.  **获取Anti-CSRF Token:**  访问受影响的SPIP站点的登录页面（`spip.php?page=spip_pass`），提取`formulaire_action_args`字段的值，即Anti-CSRF token。
2.  **构造Payload:**  构造一个包含恶意PHP代码的序列化字符串，例如`s:28:"<?php system('whoami'); ?>";`。这个字符串的长度需要根据实际的PHP代码长度进行调整。
3.  **发送Payload:**  通过POST请求将构造的Payload发送到`spip.php?page=spip_pass`，同时包含Anti-CSRF token和必要的表单参数。
4.  **执行代码:**  服务器在处理请求时，由于反序列化漏洞，会执行Payload中的PHP代码，从而实现远程代码执行。

**项目地址:** [nuts7/CVE-2023-27372](https://github.com/nuts7/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #10

**来源**: [CVE-2023-27372-redboltsec_CVE-2023-27372-PoC.md](../2023/CVE-2023-27372-redboltsec_CVE-2023-27372-PoC.md)

## CVE-2023-27372 SPIP RCE

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 4.2.1 (受影响版本包括3.2.18之前, 4.0.10之前, 4.1.8之前)

**利用条件:** 目标SPIP站点存在且可访问spip_pass页面，不需要任何权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27372 漏洞存在于 SPIP 4.2.1 之前的版本，允许未经身份验证的远程攻击者通过 `spip.php?page=spip_pass` 页面的 form values 执行任意代码。该漏洞源于 `ecrire/balise/formulaire_.php` 文件中 `protege_champ` 函数对序列化数据处理不当，未进行充分的输入验证，导致反序列化漏洞。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。Packet Storm Security 和 GitHub (Chocapikk/CVE-2023-27372) 都提供了漏洞利用代码或扫描器，证明该漏洞是可以被利用的。POC 代码通过构造恶意的序列化字符串，并将其作为 `oubli` 参数的值发送到 `spip.php?page=spip_pass` 页面，从而触发反序列化漏洞。

**投毒风险：**
分析提供的 PoC 代码 (`cve-2023-27372.py`)，未发现明显的投毒代码。该脚本的主要功能是：

1.  获取 CSRF token (如果存在)。
2.  构造包含恶意 PHP 代码的序列化 payload，该代码使用 `exec` 函数执行命令。
3.  将 payload 发送到目标 SPIP 站点。
4.  解析响应，提取命令执行结果。

脚本本身没有执行任何与目标系统无关的操作，例如上传恶意文件、修改系统配置或连接到外部服务器。因此，投毒风险较低。

**利用方式：**

1.  **定位目标:**  确定存在漏洞的 SPIP 站点，版本低于 4.2.1，且允许公共访问 `spip.php?page=spip_pass` 页面。
2.  **获取 CSRF Token (如果需要):** 访问 `spip.php?page=spip_pass` 页面，提取 CSRF token (`formulaire_action_args`)。有些情况下，可能不需要 CSRF token。
3.  **构造 Payload:**  构造包含恶意 PHP 代码的序列化字符串，用于执行任意命令。例如，使用 `<?php system($_GET['cmd']); ?>` 来执行 GET 请求中的 `cmd` 参数指定的命令。
4.  **发送 Payload:**  将构造的 Payload 作为 `oubli` 参数的值，通过 POST 请求发送到 `spip.php?page=spip_pass` 页面，同时附带 CSRF token (如果需要)。
5.  **执行命令:**  如果 Payload 成功执行，则可以通过构造特定的 HTTP 请求来执行任意命令。例如，访问 `spip.php?page=spip_pass&cmd=whoami` 来执行 `whoami` 命令，获取当前用户。
6.  **交互式 Shell (POC代码)**: PoC中尝试使用`whoami`检测是否RCE成功，如果失败，PoC会尝试生成一个交互式shell。这部分代码可能存在问题，需要用户多次输入命令。

**缓解措施：**
升级到 SPIP 4.2.1 或更高版本，或者应用补丁以修复反序列化漏洞。


**项目地址:** [redboltsec/CVE-2023-27372-PoC](https://github.com/redboltsec/CVE-2023-27372-PoC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---



---

## POC #3

**来源**: [CVE-2023-27372-1amthebest1_CVE-2023-27372.md](../2023/CVE-2023-27372-1amthebest1_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1 (受影响版本还包括3.2.x, 4.0.x, 4.1.x)

**利用条件:** 需要能够通过网络访问SPIP站点，且SPIP版本低于4.2.1，未应用安全补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27372 是 SPIP 4.2.1 之前版本中的一个远程代码执行 (RCE) 漏洞。该漏洞的根本原因是程序未正确处理反序列化数据，导致攻击者可以通过构造恶意表单值，在服务器上执行任意代码。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判断该PoC代码有效。
- 漏洞库信息明确指出SPIP在4.2.1之前的版本存在RCE漏洞，并通过不安全的反序列化来实现。
- 搜索引擎结果也证实了该漏洞的存在，并提供了多个漏洞分析和利用链接。
- PoC代码通过利用`spip_pass`页面中的`oubli`参数，传递一个包含PHP代码的序列化字符串，从而执行任意命令。该代码首先获取CSRF token，然后构造包含恶意PHP代码的payload，并发送POST请求到`spip.php?page=spip_pass`。恶意PHP代码使用`system`函数执行经过base64编码的命令。

**投毒风险分析：**
仔细检查了提供的PoC代码，没有发现明显的投毒代码。该代码结构清晰，功能明确，主要用于验证和利用漏洞。风险百分比评估为0%。

**利用方式：**
1.  **漏洞定位：** 该漏洞存在于 SPIP 的前台页面，攻击者无需认证即可利用。
2.  **CSRF Token 获取：** 攻击者首先访问 `spip.php?page=spip_pass` 页面，从中提取 CSRF Token，用于绕过 CSRF 保护。
3.  **Payload 构造：** 攻击者构造一个包含恶意 PHP 代码的序列化字符串。该 PHP 代码通常使用 `system()` 函数执行任意命令。为了避免过滤，命令通常会进行 base64 编码。
4.  **漏洞触发：** 攻击者将构造好的 Payload 放入 `oubli` 参数中，通过 POST 请求发送到 `spip.php?page=spip_pass` 页面，触发反序列化漏洞，从而执行任意代码。
5.  **反弹shell:** 通过反弹shell获得目标机器的权限。


**项目地址:** [1amthebest1/CVE-2023-27372](https://github.com/1amthebest1/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #4

**来源**: [CVE-2023-27372-Chocapikk_CVE-2023-27372.md](../2023/CVE-2023-27372-Chocapikk_CVE-2023-27372.md)

## CVE-2023-27372 SPIP Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要目标SPIP站点存在，且能访问其spip.php?page=spip_pass页面

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27372是SPIP CMS 4.2.1之前版本中的一个远程代码执行漏洞。该漏洞源于程序在处理表单值时，反序列化过程存在缺陷。未经身份验证的攻击者可以通过向易受攻击的SPIP实例上的spip.php?page=spip_pass页面提交特制的表单值，从而利用此漏洞执行任意代码。

**漏洞利用方式：**

1.  **获取Anti-CSRF Token：** PoC脚本首先访问`spip.php?page=spip_pass`页面，解析HTML，提取名为`formulaire_action_args`的input标签中的`value`属性，该值用作Anti-CSRF token。
2.  **构造恶意Payload：**  PoC脚本使用PHP序列化的方式构造恶意代码，通过`oubli`参数传递给`spip.php?page=spip_pass`。
3.  **发送POST请求：**  将包含Anti-CSRF token和恶意payload的POST请求发送到`spip.php?page=spip_pass`，触发反序列化漏洞，从而执行任意代码。
4.  **解析输出：**PoC脚本使用正则表达式提取命令执行结果，如果执行`whoami`成功则认为漏洞存在。

**有效性：**

根据漏洞库信息、搜索结果，以及提供的PoC代码，可以确定该漏洞是真实存在的，并且该PoC代码看起来可以有效利用该漏洞实现远程代码执行。

**投毒风险：**

检查PoC代码发现，该脚本的功能主要是利用CVE-2023-27372漏洞进行RCE验证。通过以下几个方面评估投毒风险：

*   **LeakIX API Key配置:** 脚本中`LEAKIX_API_KEY` 变量需要用户自己配置LeakIX API Key，如果用户不配置则无法从LeakIX获取SPIP URLs。
*   **Payload执行命令:** Payload中执行的命令是`whoami`，这是一个相对安全的命令，用于判断是否成功执行代码。但也存在执行其他命令的潜在风险。
*   **代码逻辑：** 代码逻辑相对清晰，主要是发送请求、解析响应和执行命令。但作者可以加入一些恶意代码来增加风险。
*   **第三方库：** 使用了`requests`、`bs4`、`rich`等第三方库，这些库本身可能存在安全漏洞。

综合考虑，该PoC代码存在少量投毒风险，可能被利用执行未经授权的命令、搜集或窃取用户信息。 风险评估为1%。

**项目地址:** [Chocapikk/CVE-2023-27372](https://github.com/Chocapikk/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #5

**来源**: [CVE-2023-27372-G01d3nW01f_cve-2023-27372.md](../2023/CVE-2023-27372-G01d3nW01f_cve-2023-27372.md)

## CVE-2023-27372 - SPIP Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution

**影响应用:** SPIP

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 4.2.1

**利用条件:** SPIP 实例需要可公开访问，并且运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372 是 SPIP CMS 中的一个远程代码执行漏洞，源于对反序列化数据处理不当。攻击者可以利用此漏洞通过在公共区域的表单值中注入恶意序列化数据来执行任意代码。

**有效性分析：**
提供的 exploit.py 脚本利用了此漏洞。它首先从目标 URL 的 `/spip/spip.php?page=spip_pass` 获取 `formulaire_action_args` 参数。然后，它构造一个包含恶意 PHP 代码的 POST 请求，该代码使用 `system()` 函数执行攻击者提供的命令。该恶意 PHP 代码被序列化并作为 `oubli` 参数传递。脚本的成功执行表明漏洞是可利用的。

**投毒风险分析：**
查看 exploit.py 脚本，其主要功能是利用 CVE-2023-27372 漏洞实现远程代码执行。脚本首先获取目标 URL，然后构造恶意 payload 并发送 POST 请求。脚本本身没有明显的恶意行为，如植入后门或传播恶意软件。
但是，该脚本本身依赖于用户提供的命令来执行 RCE。如果用户不小心执行了包含恶意命令的脚本，可能会导致目标系统受到损害。
在 readme.md 文件中，声明了 “education purpose only!!!!!”，降低了投毒的可能性。
仓库中，可能存在投毒代码的风险较低，约为 10%。

**利用方式：**
1.  攻击者向 SPIP 站点的 `/spip/spip.php?page=spip_pass` 发送 GET 请求。
2.  攻击者解析响应，提取 `formulaire_action_args` 参数。
3.  攻击者构造一个 POST 请求，将 `formulaire_action` 设置为 `oubli`，`formulaire_action_args` 设置为提取的值，并将恶意 PHP 代码序列化后作为 `oubli` 参数的值发送。
4.  SPIP 在处理 POST 请求时，反序列化 `oubli` 参数的值，导致恶意 PHP 代码被执行，从而实现远程代码执行。

**项目地址:** [G01d3nW01f/cve-2023-27372](https://github.com/G01d3nW01f/cve-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #6

**来源**: [CVE-2023-27372-ThatNotEasy_CVE-2023-27372.md](../2023/CVE-2023-27372-ThatNotEasy_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 目标网站必须运行存在漏洞的SPIP版本，且漏洞利用点对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP内容管理系统4.2.1之前版本中的一个远程代码执行漏洞。该漏洞源于SPIP处理反序列化数据的方式不当，允许未经身份验证的攻击者通过表单值执行任意命令。根据提供的漏洞利用代码，攻击者可以指定一个包含多个URL的文件和一个要执行的命令。该脚本会向这些URL发送特制的请求，其中包含序列化的恶意payload，从而在目标服务器上执行指定的命令，获取web用户权限。该漏洞利用代码的投毒风险较低，主要风险在于使用者自身行为，利用此工具进行未授权的渗透测试或攻击。因为代码中包含从 `lib/ua.txt` 读取 User-Agent 的操作，以及输出文件功能，存在一定的信息收集行为，可能用于后期攻击，但总体上代码逻辑清晰，风险可控。

**利用方式：**

1.  **漏洞定位：** SPIP 4.2.1之前的版本存在反序列化漏洞，具体位置在`oubli`参数中，允许在公共区域提交的表单值。
2.  **攻击流程：**
    *   攻击者构造包含恶意代码的序列化payload。
    *   将payload作为表单值提交给存在漏洞的SPIP站点。
    *   SPIP站点反序列化该数据时，恶意代码被执行。
3.  **漏洞利用代码分析：**
    *   `spip.py`脚本接受目标URL列表和要执行的命令作为参数。
    *   脚本使用`requests`库发送HTTP请求，将序列化的payload包含在POST请求的参数中。
    *   服务器端反序列化payload，执行攻击者指定的命令。
4.  **缓解措施：**
    *   将SPIP升级到3.2.18, 4.0.10, 4.1.8, 或 4.2.1及以上版本。
    *   限制对SPIP站点的公共访问。

**项目地址:** [ThatNotEasy/CVE-2023-27372](https://github.com/ThatNotEasy/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #7

**来源**: [CVE-2023-27372-dream434_CVE-2023-27372.md](../2023/CVE-2023-27372-dream434_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要目标SPIP站点存在漏洞页面且可公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27372 是 SPIP 内容管理系统（CMS）中存在的一个远程代码执行漏洞。该漏洞源于 SPIP 在处理表单值时，由于对序列化数据处理不当，导致攻击者可以通过构造恶意的序列化数据，将其作为表单参数提交到存在漏洞的页面，从而在服务器端执行任意代码。

**有效性：**

根据漏洞信息和搜索结果，提供的 POC 代码是有效的。多个资源（如 Packet Storm 和 GitHub 上的 Chocapikk/CVE-2023-27372）都提供了可用于利用该漏洞的 POC 或扫描器。

**投毒风险：**

代码中存在轻微的投毒风险。主要风险点在于：

*   **依赖项安装错误引导:** README.md文件引导用户安装 `collorama` , 正确的安装包应该是 `colorama`，如果用户安装了恶意攻击者伪造的 `collorama` 包，则可能存在安全风险。 *   **执行任意命令：** POC 允许执行任意命令。如果攻击者修改了 POC 中的 `whoami` 命令，替换为恶意命令，可能会造成更大的危害。例如，删除服务器文件、安装恶意软件等。但这种风险主要取决于使用者如何使用 POC，而非 POC 本身包含恶意代码。

考虑到这些因素，我将投毒风险评估为 5%。主要是安装包名称拼写错误引导，存在被利用的可能性。

**利用方式：**

1.  **查找目标：** 寻找运行 SPIP 且版本低于 4.2.1 的站点。
2.  **构造Payload：** 攻击者构造包含恶意 PHP 代码的序列化数据。
3.  **获取CSRF Token：** 首先，向 `/spip.php?page=spip_pass` 页面发起 GET 请求，解析 HTML 响应，提取名为 `formulaire_action_args` 的隐藏输入字段中的 CSRF token。
4.  **发送恶意请求：** 将构造的序列化数据作为 `oubli` 参数的值，连同其他必要的表单参数（包括上一步获取的 CSRF token）通过 POST 请求发送到 `/spip.php?page=spip_pass` 页面。
5.  **代码执行：** SPIP 在处理表单数据时，反序列化 `oubli` 参数，从而执行攻击者注入的恶意 PHP 代码。

简而言之，利用方式是通过构造包含恶意代码的序列化数据，并将其作为表单参数提交到 SPIP 站点，从而实现远程代码执行。

**项目地址:** [dream434/CVE-2023-27372](https://github.com/dream434/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #8

**来源**: [CVE-2023-27372-izzz0_CVE-2023-27372-POC.md](../2023/CVE-2023-27372-izzz0_CVE-2023-27372-POC.md)

## CVE-2023-27372-SPIP远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 目标服务器运行存在漏洞的SPIP版本，且漏洞利用发生在公共区域，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP 4.2.1之前版本中的一个远程代码执行漏洞。该漏洞是由于SPIP处理表单值中的序列化数据不当造成的。攻击者可以通过在公共区域提交包含恶意序列化数据的表单值来利用此漏洞，从而执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，该漏洞是有效的。POC代码通过构造特定的POST请求，向`spip.php?page=spip_pass`页面提交包含恶意PHP代码的序列化字符串，利用SPIP的反序列化漏洞执行代码。如果服务器返回包含`phpinfo()`结果的页面，则表明存在漏洞。

**投毒风险：**
代码主体逻辑是漏洞验证，风险较低。但仍然存在一定的投毒风险，因为攻击者可能修改POC代码，使其包含恶意操作，例如：

*   **植入后门:** POC中可以加入执行任意系统命令的代码，从而在目标服务器上植入后门。
*   **数据窃取:** POC可以被修改为窃取服务器上的敏感数据，例如数据库凭据或配置文件。
*   **拒绝服务攻击:** POC可以被修改为发送大量请求，导致目标服务器过载，从而造成拒绝服务攻击。
POC 使用 phpinfo() 验证，比较安全，但潜在风险依然存在。因此，投毒风险评估为10%。

**利用方式：**
1.  确定目标网站运行的SPIP版本低于4.2.1。
2.  向`spip.php?page=spip_pass`页面发送包含以下参数的POST请求：
    *   `formulaire_action=oubli`
    *   `formulaire_action_args`：从页面中提取的`formulaire_action_args`字段的值，进行URL编码。
    *   `oubli`: 包含恶意PHP代码的序列化字符串，例如`s:19:"<?php phpinfo(); ?>";`
    *   `nobot`：任意值，用于绕过反爬机制
3.  如果服务器返回包含恶意PHP代码执行结果的页面，则表明漏洞利用成功。例如，如果使用`phpinfo()`，则会返回phpinfo页面，或者反序列化任意类的函数，执行恶意代码。

**项目地址:** [izzz0/CVE-2023-27372-POC](https://github.com/izzz0/CVE-2023-27372-POC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #9

**来源**: [CVE-2023-27372-nuts7_CVE-2023-27372.md](../2023/CVE-2023-27372-nuts7_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要能够访问SPIP的登录页面或存在`spip_pass`页面的公开访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27372是SPIP 4.2.1之前的版本中的一个远程代码执行漏洞，原因是程序在处理表单值中的序列化数据时存在缺陷。攻击者可以通过在公共区域提交包含恶意序列化数据的表单，从而执行任意代码。PoC代码显示，它首先获取一个Anti-CSRF token，然后构造一个包含PHP代码的payload，该代码会执行指定的系统命令。这个漏洞的利用方式是，攻击者先访问登录页面 (`spip.php?page=spip_pass`)，获取`formulaire_action_args`的值 (Anti-CSRF token)。然后，攻击者构造一个POST请求，其中包含`page=spip_pass`， `formulaire_action=oubli`, `formulaire_action_args`为之前获取的CSRF token的值，并且`oubli`参数的值为精心构造的PHP序列化字符串，这个序列化字符串包含要执行的PHP代码 (使用 `system()`函数执行命令)。由于SPIP在反序列化这个`oubli`参数时存在漏洞，这会导致恶意代码执行。 

**有效性:** PoC代码有效，成功利用该漏洞能够在目标服务器上执行任意命令。

**投毒风险:** 经过检查`CVE-2023-27372.py`，`CVE-2023-27372.yaml`，`Dockerfile`和`README.md`文件。没有发现明显的恶意代码或者后门。`Dockerfile`用于构建一个包含易受攻击版本SPIP的环境，用于测试和演示漏洞。`CVE-2023-27372.yaml`是一个nuclei模板，用于检测目标是否存在此漏洞，该模板尝试执行phpinfo()，证明可以执行恶意代码。`README.md`提供有关漏洞的信息。

**利用方式:**

1.  **获取Anti-CSRF Token:**  访问受影响的SPIP站点的登录页面（`spip.php?page=spip_pass`），提取`formulaire_action_args`字段的值，即Anti-CSRF token。
2.  **构造Payload:**  构造一个包含恶意PHP代码的序列化字符串，例如`s:28:"<?php system('whoami'); ?>";`。这个字符串的长度需要根据实际的PHP代码长度进行调整。
3.  **发送Payload:**  通过POST请求将构造的Payload发送到`spip.php?page=spip_pass`，同时包含Anti-CSRF token和必要的表单参数。
4.  **执行代码:**  服务器在处理请求时，由于反序列化漏洞，会执行Payload中的PHP代码，从而实现远程代码执行。

**项目地址:** [nuts7/CVE-2023-27372](https://github.com/nuts7/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #10

**来源**: [CVE-2023-27372-redboltsec_CVE-2023-27372-PoC.md](../2023/CVE-2023-27372-redboltsec_CVE-2023-27372-PoC.md)

## CVE-2023-27372 SPIP RCE

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 4.2.1 (受影响版本包括3.2.18之前, 4.0.10之前, 4.1.8之前)

**利用条件:** 目标SPIP站点存在且可访问spip_pass页面，不需要任何权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27372 漏洞存在于 SPIP 4.2.1 之前的版本，允许未经身份验证的远程攻击者通过 `spip.php?page=spip_pass` 页面的 form values 执行任意代码。该漏洞源于 `ecrire/balise/formulaire_.php` 文件中 `protege_champ` 函数对序列化数据处理不当，未进行充分的输入验证，导致反序列化漏洞。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。Packet Storm Security 和 GitHub (Chocapikk/CVE-2023-27372) 都提供了漏洞利用代码或扫描器，证明该漏洞是可以被利用的。POC 代码通过构造恶意的序列化字符串，并将其作为 `oubli` 参数的值发送到 `spip.php?page=spip_pass` 页面，从而触发反序列化漏洞。

**投毒风险：**
分析提供的 PoC 代码 (`cve-2023-27372.py`)，未发现明显的投毒代码。该脚本的主要功能是：

1.  获取 CSRF token (如果存在)。
2.  构造包含恶意 PHP 代码的序列化 payload，该代码使用 `exec` 函数执行命令。
3.  将 payload 发送到目标 SPIP 站点。
4.  解析响应，提取命令执行结果。

脚本本身没有执行任何与目标系统无关的操作，例如上传恶意文件、修改系统配置或连接到外部服务器。因此，投毒风险较低。

**利用方式：**

1.  **定位目标:**  确定存在漏洞的 SPIP 站点，版本低于 4.2.1，且允许公共访问 `spip.php?page=spip_pass` 页面。
2.  **获取 CSRF Token (如果需要):** 访问 `spip.php?page=spip_pass` 页面，提取 CSRF token (`formulaire_action_args`)。有些情况下，可能不需要 CSRF token。
3.  **构造 Payload:**  构造包含恶意 PHP 代码的序列化字符串，用于执行任意命令。例如，使用 `<?php system($_GET['cmd']); ?>` 来执行 GET 请求中的 `cmd` 参数指定的命令。
4.  **发送 Payload:**  将构造的 Payload 作为 `oubli` 参数的值，通过 POST 请求发送到 `spip.php?page=spip_pass` 页面，同时附带 CSRF token (如果需要)。
5.  **执行命令:**  如果 Payload 成功执行，则可以通过构造特定的 HTTP 请求来执行任意命令。例如，访问 `spip.php?page=spip_pass&cmd=whoami` 来执行 `whoami` 命令，获取当前用户。
6.  **交互式 Shell (POC代码)**: PoC中尝试使用`whoami`检测是否RCE成功，如果失败，PoC会尝试生成一个交互式shell。这部分代码可能存在问题，需要用户多次输入命令。

**缓解措施：**
升级到 SPIP 4.2.1 或更高版本，或者应用补丁以修复反序列化漏洞。


**项目地址:** [redboltsec/CVE-2023-27372-PoC](https://github.com/redboltsec/CVE-2023-27372-PoC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---



---

## POC #3

**来源**: [CVE-2023-27372-1amthebest1_CVE-2023-27372.md](../2023/CVE-2023-27372-1amthebest1_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1 (受影响版本还包括3.2.x, 4.0.x, 4.1.x)

**利用条件:** 需要能够通过网络访问SPIP站点，且SPIP版本低于4.2.1，未应用安全补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27372 是 SPIP 4.2.1 之前版本中的一个远程代码执行 (RCE) 漏洞。该漏洞的根本原因是程序未正确处理反序列化数据，导致攻击者可以通过构造恶意表单值，在服务器上执行任意代码。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判断该PoC代码有效。
- 漏洞库信息明确指出SPIP在4.2.1之前的版本存在RCE漏洞，并通过不安全的反序列化来实现。
- 搜索引擎结果也证实了该漏洞的存在，并提供了多个漏洞分析和利用链接。
- PoC代码通过利用`spip_pass`页面中的`oubli`参数，传递一个包含PHP代码的序列化字符串，从而执行任意命令。该代码首先获取CSRF token，然后构造包含恶意PHP代码的payload，并发送POST请求到`spip.php?page=spip_pass`。恶意PHP代码使用`system`函数执行经过base64编码的命令。

**投毒风险分析：**
仔细检查了提供的PoC代码，没有发现明显的投毒代码。该代码结构清晰，功能明确，主要用于验证和利用漏洞。风险百分比评估为0%。

**利用方式：**
1.  **漏洞定位：** 该漏洞存在于 SPIP 的前台页面，攻击者无需认证即可利用。
2.  **CSRF Token 获取：** 攻击者首先访问 `spip.php?page=spip_pass` 页面，从中提取 CSRF Token，用于绕过 CSRF 保护。
3.  **Payload 构造：** 攻击者构造一个包含恶意 PHP 代码的序列化字符串。该 PHP 代码通常使用 `system()` 函数执行任意命令。为了避免过滤，命令通常会进行 base64 编码。
4.  **漏洞触发：** 攻击者将构造好的 Payload 放入 `oubli` 参数中，通过 POST 请求发送到 `spip.php?page=spip_pass` 页面，触发反序列化漏洞，从而执行任意代码。
5.  **反弹shell:** 通过反弹shell获得目标机器的权限。


**项目地址:** [1amthebest1/CVE-2023-27372](https://github.com/1amthebest1/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #4

**来源**: [CVE-2023-27372-Chocapikk_CVE-2023-27372.md](../2023/CVE-2023-27372-Chocapikk_CVE-2023-27372.md)

## CVE-2023-27372 SPIP Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要目标SPIP站点存在，且能访问其spip.php?page=spip_pass页面

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27372是SPIP CMS 4.2.1之前版本中的一个远程代码执行漏洞。该漏洞源于程序在处理表单值时，反序列化过程存在缺陷。未经身份验证的攻击者可以通过向易受攻击的SPIP实例上的spip.php?page=spip_pass页面提交特制的表单值，从而利用此漏洞执行任意代码。

**漏洞利用方式：**

1.  **获取Anti-CSRF Token：** PoC脚本首先访问`spip.php?page=spip_pass`页面，解析HTML，提取名为`formulaire_action_args`的input标签中的`value`属性，该值用作Anti-CSRF token。
2.  **构造恶意Payload：**  PoC脚本使用PHP序列化的方式构造恶意代码，通过`oubli`参数传递给`spip.php?page=spip_pass`。
3.  **发送POST请求：**  将包含Anti-CSRF token和恶意payload的POST请求发送到`spip.php?page=spip_pass`，触发反序列化漏洞，从而执行任意代码。
4.  **解析输出：**PoC脚本使用正则表达式提取命令执行结果，如果执行`whoami`成功则认为漏洞存在。

**有效性：**

根据漏洞库信息、搜索结果，以及提供的PoC代码，可以确定该漏洞是真实存在的，并且该PoC代码看起来可以有效利用该漏洞实现远程代码执行。

**投毒风险：**

检查PoC代码发现，该脚本的功能主要是利用CVE-2023-27372漏洞进行RCE验证。通过以下几个方面评估投毒风险：

*   **LeakIX API Key配置:** 脚本中`LEAKIX_API_KEY` 变量需要用户自己配置LeakIX API Key，如果用户不配置则无法从LeakIX获取SPIP URLs。
*   **Payload执行命令:** Payload中执行的命令是`whoami`，这是一个相对安全的命令，用于判断是否成功执行代码。但也存在执行其他命令的潜在风险。
*   **代码逻辑：** 代码逻辑相对清晰，主要是发送请求、解析响应和执行命令。但作者可以加入一些恶意代码来增加风险。
*   **第三方库：** 使用了`requests`、`bs4`、`rich`等第三方库，这些库本身可能存在安全漏洞。

综合考虑，该PoC代码存在少量投毒风险，可能被利用执行未经授权的命令、搜集或窃取用户信息。 风险评估为1%。

**项目地址:** [Chocapikk/CVE-2023-27372](https://github.com/Chocapikk/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #5

**来源**: [CVE-2023-27372-G01d3nW01f_cve-2023-27372.md](../2023/CVE-2023-27372-G01d3nW01f_cve-2023-27372.md)

## CVE-2023-27372 - SPIP Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution

**影响应用:** SPIP

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 4.2.1

**利用条件:** SPIP 实例需要可公开访问，并且运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372 是 SPIP CMS 中的一个远程代码执行漏洞，源于对反序列化数据处理不当。攻击者可以利用此漏洞通过在公共区域的表单值中注入恶意序列化数据来执行任意代码。

**有效性分析：**
提供的 exploit.py 脚本利用了此漏洞。它首先从目标 URL 的 `/spip/spip.php?page=spip_pass` 获取 `formulaire_action_args` 参数。然后，它构造一个包含恶意 PHP 代码的 POST 请求，该代码使用 `system()` 函数执行攻击者提供的命令。该恶意 PHP 代码被序列化并作为 `oubli` 参数传递。脚本的成功执行表明漏洞是可利用的。

**投毒风险分析：**
查看 exploit.py 脚本，其主要功能是利用 CVE-2023-27372 漏洞实现远程代码执行。脚本首先获取目标 URL，然后构造恶意 payload 并发送 POST 请求。脚本本身没有明显的恶意行为，如植入后门或传播恶意软件。
但是，该脚本本身依赖于用户提供的命令来执行 RCE。如果用户不小心执行了包含恶意命令的脚本，可能会导致目标系统受到损害。
在 readme.md 文件中，声明了 “education purpose only!!!!!”，降低了投毒的可能性。
仓库中，可能存在投毒代码的风险较低，约为 10%。

**利用方式：**
1.  攻击者向 SPIP 站点的 `/spip/spip.php?page=spip_pass` 发送 GET 请求。
2.  攻击者解析响应，提取 `formulaire_action_args` 参数。
3.  攻击者构造一个 POST 请求，将 `formulaire_action` 设置为 `oubli`，`formulaire_action_args` 设置为提取的值，并将恶意 PHP 代码序列化后作为 `oubli` 参数的值发送。
4.  SPIP 在处理 POST 请求时，反序列化 `oubli` 参数的值，导致恶意 PHP 代码被执行，从而实现远程代码执行。

**项目地址:** [G01d3nW01f/cve-2023-27372](https://github.com/G01d3nW01f/cve-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #6

**来源**: [CVE-2023-27372-ThatNotEasy_CVE-2023-27372.md](../2023/CVE-2023-27372-ThatNotEasy_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 目标网站必须运行存在漏洞的SPIP版本，且漏洞利用点对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP内容管理系统4.2.1之前版本中的一个远程代码执行漏洞。该漏洞源于SPIP处理反序列化数据的方式不当，允许未经身份验证的攻击者通过表单值执行任意命令。根据提供的漏洞利用代码，攻击者可以指定一个包含多个URL的文件和一个要执行的命令。该脚本会向这些URL发送特制的请求，其中包含序列化的恶意payload，从而在目标服务器上执行指定的命令，获取web用户权限。该漏洞利用代码的投毒风险较低，主要风险在于使用者自身行为，利用此工具进行未授权的渗透测试或攻击。因为代码中包含从 `lib/ua.txt` 读取 User-Agent 的操作，以及输出文件功能，存在一定的信息收集行为，可能用于后期攻击，但总体上代码逻辑清晰，风险可控。

**利用方式：**

1.  **漏洞定位：** SPIP 4.2.1之前的版本存在反序列化漏洞，具体位置在`oubli`参数中，允许在公共区域提交的表单值。
2.  **攻击流程：**
    *   攻击者构造包含恶意代码的序列化payload。
    *   将payload作为表单值提交给存在漏洞的SPIP站点。
    *   SPIP站点反序列化该数据时，恶意代码被执行。
3.  **漏洞利用代码分析：**
    *   `spip.py`脚本接受目标URL列表和要执行的命令作为参数。
    *   脚本使用`requests`库发送HTTP请求，将序列化的payload包含在POST请求的参数中。
    *   服务器端反序列化payload，执行攻击者指定的命令。
4.  **缓解措施：**
    *   将SPIP升级到3.2.18, 4.0.10, 4.1.8, 或 4.2.1及以上版本。
    *   限制对SPIP站点的公共访问。

**项目地址:** [ThatNotEasy/CVE-2023-27372](https://github.com/ThatNotEasy/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #7

**来源**: [CVE-2023-27372-dream434_CVE-2023-27372.md](../2023/CVE-2023-27372-dream434_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要目标SPIP站点存在漏洞页面且可公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27372 是 SPIP 内容管理系统（CMS）中存在的一个远程代码执行漏洞。该漏洞源于 SPIP 在处理表单值时，由于对序列化数据处理不当，导致攻击者可以通过构造恶意的序列化数据，将其作为表单参数提交到存在漏洞的页面，从而在服务器端执行任意代码。

**有效性：**

根据漏洞信息和搜索结果，提供的 POC 代码是有效的。多个资源（如 Packet Storm 和 GitHub 上的 Chocapikk/CVE-2023-27372）都提供了可用于利用该漏洞的 POC 或扫描器。

**投毒风险：**

代码中存在轻微的投毒风险。主要风险点在于：

*   **依赖项安装错误引导:** README.md文件引导用户安装 `collorama` , 正确的安装包应该是 `colorama`，如果用户安装了恶意攻击者伪造的 `collorama` 包，则可能存在安全风险。 *   **执行任意命令：** POC 允许执行任意命令。如果攻击者修改了 POC 中的 `whoami` 命令，替换为恶意命令，可能会造成更大的危害。例如，删除服务器文件、安装恶意软件等。但这种风险主要取决于使用者如何使用 POC，而非 POC 本身包含恶意代码。

考虑到这些因素，我将投毒风险评估为 5%。主要是安装包名称拼写错误引导，存在被利用的可能性。

**利用方式：**

1.  **查找目标：** 寻找运行 SPIP 且版本低于 4.2.1 的站点。
2.  **构造Payload：** 攻击者构造包含恶意 PHP 代码的序列化数据。
3.  **获取CSRF Token：** 首先，向 `/spip.php?page=spip_pass` 页面发起 GET 请求，解析 HTML 响应，提取名为 `formulaire_action_args` 的隐藏输入字段中的 CSRF token。
4.  **发送恶意请求：** 将构造的序列化数据作为 `oubli` 参数的值，连同其他必要的表单参数（包括上一步获取的 CSRF token）通过 POST 请求发送到 `/spip.php?page=spip_pass` 页面。
5.  **代码执行：** SPIP 在处理表单数据时，反序列化 `oubli` 参数，从而执行攻击者注入的恶意 PHP 代码。

简而言之，利用方式是通过构造包含恶意代码的序列化数据，并将其作为表单参数提交到 SPIP 站点，从而实现远程代码执行。

**项目地址:** [dream434/CVE-2023-27372](https://github.com/dream434/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #8

**来源**: [CVE-2023-27372-izzz0_CVE-2023-27372-POC.md](../2023/CVE-2023-27372-izzz0_CVE-2023-27372-POC.md)

## CVE-2023-27372-SPIP远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 目标服务器运行存在漏洞的SPIP版本，且漏洞利用发生在公共区域，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP 4.2.1之前版本中的一个远程代码执行漏洞。该漏洞是由于SPIP处理表单值中的序列化数据不当造成的。攻击者可以通过在公共区域提交包含恶意序列化数据的表单值来利用此漏洞，从而执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，该漏洞是有效的。POC代码通过构造特定的POST请求，向`spip.php?page=spip_pass`页面提交包含恶意PHP代码的序列化字符串，利用SPIP的反序列化漏洞执行代码。如果服务器返回包含`phpinfo()`结果的页面，则表明存在漏洞。

**投毒风险：**
代码主体逻辑是漏洞验证，风险较低。但仍然存在一定的投毒风险，因为攻击者可能修改POC代码，使其包含恶意操作，例如：

*   **植入后门:** POC中可以加入执行任意系统命令的代码，从而在目标服务器上植入后门。
*   **数据窃取:** POC可以被修改为窃取服务器上的敏感数据，例如数据库凭据或配置文件。
*   **拒绝服务攻击:** POC可以被修改为发送大量请求，导致目标服务器过载，从而造成拒绝服务攻击。
POC 使用 phpinfo() 验证，比较安全，但潜在风险依然存在。因此，投毒风险评估为10%。

**利用方式：**
1.  确定目标网站运行的SPIP版本低于4.2.1。
2.  向`spip.php?page=spip_pass`页面发送包含以下参数的POST请求：
    *   `formulaire_action=oubli`
    *   `formulaire_action_args`：从页面中提取的`formulaire_action_args`字段的值，进行URL编码。
    *   `oubli`: 包含恶意PHP代码的序列化字符串，例如`s:19:"<?php phpinfo(); ?>";`
    *   `nobot`：任意值，用于绕过反爬机制
3.  如果服务器返回包含恶意PHP代码执行结果的页面，则表明漏洞利用成功。例如，如果使用`phpinfo()`，则会返回phpinfo页面，或者反序列化任意类的函数，执行恶意代码。

**项目地址:** [izzz0/CVE-2023-27372-POC](https://github.com/izzz0/CVE-2023-27372-POC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #9

**来源**: [CVE-2023-27372-nuts7_CVE-2023-27372.md](../2023/CVE-2023-27372-nuts7_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要能够访问SPIP的登录页面或存在`spip_pass`页面的公开访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27372是SPIP 4.2.1之前的版本中的一个远程代码执行漏洞，原因是程序在处理表单值中的序列化数据时存在缺陷。攻击者可以通过在公共区域提交包含恶意序列化数据的表单，从而执行任意代码。PoC代码显示，它首先获取一个Anti-CSRF token，然后构造一个包含PHP代码的payload，该代码会执行指定的系统命令。这个漏洞的利用方式是，攻击者先访问登录页面 (`spip.php?page=spip_pass`)，获取`formulaire_action_args`的值 (Anti-CSRF token)。然后，攻击者构造一个POST请求，其中包含`page=spip_pass`， `formulaire_action=oubli`, `formulaire_action_args`为之前获取的CSRF token的值，并且`oubli`参数的值为精心构造的PHP序列化字符串，这个序列化字符串包含要执行的PHP代码 (使用 `system()`函数执行命令)。由于SPIP在反序列化这个`oubli`参数时存在漏洞，这会导致恶意代码执行。 

**有效性:** PoC代码有效，成功利用该漏洞能够在目标服务器上执行任意命令。

**投毒风险:** 经过检查`CVE-2023-27372.py`，`CVE-2023-27372.yaml`，`Dockerfile`和`README.md`文件。没有发现明显的恶意代码或者后门。`Dockerfile`用于构建一个包含易受攻击版本SPIP的环境，用于测试和演示漏洞。`CVE-2023-27372.yaml`是一个nuclei模板，用于检测目标是否存在此漏洞，该模板尝试执行phpinfo()，证明可以执行恶意代码。`README.md`提供有关漏洞的信息。

**利用方式:**

1.  **获取Anti-CSRF Token:**  访问受影响的SPIP站点的登录页面（`spip.php?page=spip_pass`），提取`formulaire_action_args`字段的值，即Anti-CSRF token。
2.  **构造Payload:**  构造一个包含恶意PHP代码的序列化字符串，例如`s:28:"<?php system('whoami'); ?>";`。这个字符串的长度需要根据实际的PHP代码长度进行调整。
3.  **发送Payload:**  通过POST请求将构造的Payload发送到`spip.php?page=spip_pass`，同时包含Anti-CSRF token和必要的表单参数。
4.  **执行代码:**  服务器在处理请求时，由于反序列化漏洞，会执行Payload中的PHP代码，从而实现远程代码执行。

**项目地址:** [nuts7/CVE-2023-27372](https://github.com/nuts7/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #10

**来源**: [CVE-2023-27372-redboltsec_CVE-2023-27372-PoC.md](../2023/CVE-2023-27372-redboltsec_CVE-2023-27372-PoC.md)

## CVE-2023-27372 SPIP RCE

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 4.2.1 (受影响版本包括3.2.18之前, 4.0.10之前, 4.1.8之前)

**利用条件:** 目标SPIP站点存在且可访问spip_pass页面，不需要任何权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27372 漏洞存在于 SPIP 4.2.1 之前的版本，允许未经身份验证的远程攻击者通过 `spip.php?page=spip_pass` 页面的 form values 执行任意代码。该漏洞源于 `ecrire/balise/formulaire_.php` 文件中 `protege_champ` 函数对序列化数据处理不当，未进行充分的输入验证，导致反序列化漏洞。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。Packet Storm Security 和 GitHub (Chocapikk/CVE-2023-27372) 都提供了漏洞利用代码或扫描器，证明该漏洞是可以被利用的。POC 代码通过构造恶意的序列化字符串，并将其作为 `oubli` 参数的值发送到 `spip.php?page=spip_pass` 页面，从而触发反序列化漏洞。

**投毒风险：**
分析提供的 PoC 代码 (`cve-2023-27372.py`)，未发现明显的投毒代码。该脚本的主要功能是：

1.  获取 CSRF token (如果存在)。
2.  构造包含恶意 PHP 代码的序列化 payload，该代码使用 `exec` 函数执行命令。
3.  将 payload 发送到目标 SPIP 站点。
4.  解析响应，提取命令执行结果。

脚本本身没有执行任何与目标系统无关的操作，例如上传恶意文件、修改系统配置或连接到外部服务器。因此，投毒风险较低。

**利用方式：**

1.  **定位目标:**  确定存在漏洞的 SPIP 站点，版本低于 4.2.1，且允许公共访问 `spip.php?page=spip_pass` 页面。
2.  **获取 CSRF Token (如果需要):** 访问 `spip.php?page=spip_pass` 页面，提取 CSRF token (`formulaire_action_args`)。有些情况下，可能不需要 CSRF token。
3.  **构造 Payload:**  构造包含恶意 PHP 代码的序列化字符串，用于执行任意命令。例如，使用 `<?php system($_GET['cmd']); ?>` 来执行 GET 请求中的 `cmd` 参数指定的命令。
4.  **发送 Payload:**  将构造的 Payload 作为 `oubli` 参数的值，通过 POST 请求发送到 `spip.php?page=spip_pass` 页面，同时附带 CSRF token (如果需要)。
5.  **执行命令:**  如果 Payload 成功执行，则可以通过构造特定的 HTTP 请求来执行任意命令。例如，访问 `spip.php?page=spip_pass&cmd=whoami` 来执行 `whoami` 命令，获取当前用户。
6.  **交互式 Shell (POC代码)**: PoC中尝试使用`whoami`检测是否RCE成功，如果失败，PoC会尝试生成一个交互式shell。这部分代码可能存在问题，需要用户多次输入命令。

**缓解措施：**
升级到 SPIP 4.2.1 或更高版本，或者应用补丁以修复反序列化漏洞。


**项目地址:** [redboltsec/CVE-2023-27372-PoC](https://github.com/redboltsec/CVE-2023-27372-PoC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---



---

## POC #3

**来源**: [CVE-2023-27372-1amthebest1_CVE-2023-27372.md](../2023/CVE-2023-27372-1amthebest1_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1 (受影响版本还包括3.2.x, 4.0.x, 4.1.x)

**利用条件:** 需要能够通过网络访问SPIP站点，且SPIP版本低于4.2.1，未应用安全补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27372 是 SPIP 4.2.1 之前版本中的一个远程代码执行 (RCE) 漏洞。该漏洞的根本原因是程序未正确处理反序列化数据，导致攻击者可以通过构造恶意表单值，在服务器上执行任意代码。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判断该PoC代码有效。
- 漏洞库信息明确指出SPIP在4.2.1之前的版本存在RCE漏洞，并通过不安全的反序列化来实现。
- 搜索引擎结果也证实了该漏洞的存在，并提供了多个漏洞分析和利用链接。
- PoC代码通过利用`spip_pass`页面中的`oubli`参数，传递一个包含PHP代码的序列化字符串，从而执行任意命令。该代码首先获取CSRF token，然后构造包含恶意PHP代码的payload，并发送POST请求到`spip.php?page=spip_pass`。恶意PHP代码使用`system`函数执行经过base64编码的命令。

**投毒风险分析：**
仔细检查了提供的PoC代码，没有发现明显的投毒代码。该代码结构清晰，功能明确，主要用于验证和利用漏洞。风险百分比评估为0%。

**利用方式：**
1.  **漏洞定位：** 该漏洞存在于 SPIP 的前台页面，攻击者无需认证即可利用。
2.  **CSRF Token 获取：** 攻击者首先访问 `spip.php?page=spip_pass` 页面，从中提取 CSRF Token，用于绕过 CSRF 保护。
3.  **Payload 构造：** 攻击者构造一个包含恶意 PHP 代码的序列化字符串。该 PHP 代码通常使用 `system()` 函数执行任意命令。为了避免过滤，命令通常会进行 base64 编码。
4.  **漏洞触发：** 攻击者将构造好的 Payload 放入 `oubli` 参数中，通过 POST 请求发送到 `spip.php?page=spip_pass` 页面，触发反序列化漏洞，从而执行任意代码。
5.  **反弹shell:** 通过反弹shell获得目标机器的权限。


**项目地址:** [1amthebest1/CVE-2023-27372](https://github.com/1amthebest1/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #4

**来源**: [CVE-2023-27372-Chocapikk_CVE-2023-27372.md](../2023/CVE-2023-27372-Chocapikk_CVE-2023-27372.md)

## CVE-2023-27372 SPIP Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要目标SPIP站点存在，且能访问其spip.php?page=spip_pass页面

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27372是SPIP CMS 4.2.1之前版本中的一个远程代码执行漏洞。该漏洞源于程序在处理表单值时，反序列化过程存在缺陷。未经身份验证的攻击者可以通过向易受攻击的SPIP实例上的spip.php?page=spip_pass页面提交特制的表单值，从而利用此漏洞执行任意代码。

**漏洞利用方式：**

1.  **获取Anti-CSRF Token：** PoC脚本首先访问`spip.php?page=spip_pass`页面，解析HTML，提取名为`formulaire_action_args`的input标签中的`value`属性，该值用作Anti-CSRF token。
2.  **构造恶意Payload：**  PoC脚本使用PHP序列化的方式构造恶意代码，通过`oubli`参数传递给`spip.php?page=spip_pass`。
3.  **发送POST请求：**  将包含Anti-CSRF token和恶意payload的POST请求发送到`spip.php?page=spip_pass`，触发反序列化漏洞，从而执行任意代码。
4.  **解析输出：**PoC脚本使用正则表达式提取命令执行结果，如果执行`whoami`成功则认为漏洞存在。

**有效性：**

根据漏洞库信息、搜索结果，以及提供的PoC代码，可以确定该漏洞是真实存在的，并且该PoC代码看起来可以有效利用该漏洞实现远程代码执行。

**投毒风险：**

检查PoC代码发现，该脚本的功能主要是利用CVE-2023-27372漏洞进行RCE验证。通过以下几个方面评估投毒风险：

*   **LeakIX API Key配置:** 脚本中`LEAKIX_API_KEY` 变量需要用户自己配置LeakIX API Key，如果用户不配置则无法从LeakIX获取SPIP URLs。
*   **Payload执行命令:** Payload中执行的命令是`whoami`，这是一个相对安全的命令，用于判断是否成功执行代码。但也存在执行其他命令的潜在风险。
*   **代码逻辑：** 代码逻辑相对清晰，主要是发送请求、解析响应和执行命令。但作者可以加入一些恶意代码来增加风险。
*   **第三方库：** 使用了`requests`、`bs4`、`rich`等第三方库，这些库本身可能存在安全漏洞。

综合考虑，该PoC代码存在少量投毒风险，可能被利用执行未经授权的命令、搜集或窃取用户信息。 风险评估为1%。

**项目地址:** [Chocapikk/CVE-2023-27372](https://github.com/Chocapikk/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #5

**来源**: [CVE-2023-27372-G01d3nW01f_cve-2023-27372.md](../2023/CVE-2023-27372-G01d3nW01f_cve-2023-27372.md)

## CVE-2023-27372 - SPIP Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution

**影响应用:** SPIP

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 4.2.1

**利用条件:** SPIP 实例需要可公开访问，并且运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372 是 SPIP CMS 中的一个远程代码执行漏洞，源于对反序列化数据处理不当。攻击者可以利用此漏洞通过在公共区域的表单值中注入恶意序列化数据来执行任意代码。

**有效性分析：**
提供的 exploit.py 脚本利用了此漏洞。它首先从目标 URL 的 `/spip/spip.php?page=spip_pass` 获取 `formulaire_action_args` 参数。然后，它构造一个包含恶意 PHP 代码的 POST 请求，该代码使用 `system()` 函数执行攻击者提供的命令。该恶意 PHP 代码被序列化并作为 `oubli` 参数传递。脚本的成功执行表明漏洞是可利用的。

**投毒风险分析：**
查看 exploit.py 脚本，其主要功能是利用 CVE-2023-27372 漏洞实现远程代码执行。脚本首先获取目标 URL，然后构造恶意 payload 并发送 POST 请求。脚本本身没有明显的恶意行为，如植入后门或传播恶意软件。
但是，该脚本本身依赖于用户提供的命令来执行 RCE。如果用户不小心执行了包含恶意命令的脚本，可能会导致目标系统受到损害。
在 readme.md 文件中，声明了 “education purpose only!!!!!”，降低了投毒的可能性。
仓库中，可能存在投毒代码的风险较低，约为 10%。

**利用方式：**
1.  攻击者向 SPIP 站点的 `/spip/spip.php?page=spip_pass` 发送 GET 请求。
2.  攻击者解析响应，提取 `formulaire_action_args` 参数。
3.  攻击者构造一个 POST 请求，将 `formulaire_action` 设置为 `oubli`，`formulaire_action_args` 设置为提取的值，并将恶意 PHP 代码序列化后作为 `oubli` 参数的值发送。
4.  SPIP 在处理 POST 请求时，反序列化 `oubli` 参数的值，导致恶意 PHP 代码被执行，从而实现远程代码执行。

**项目地址:** [G01d3nW01f/cve-2023-27372](https://github.com/G01d3nW01f/cve-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #6

**来源**: [CVE-2023-27372-ThatNotEasy_CVE-2023-27372.md](../2023/CVE-2023-27372-ThatNotEasy_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 目标网站必须运行存在漏洞的SPIP版本，且漏洞利用点对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP内容管理系统4.2.1之前版本中的一个远程代码执行漏洞。该漏洞源于SPIP处理反序列化数据的方式不当，允许未经身份验证的攻击者通过表单值执行任意命令。根据提供的漏洞利用代码，攻击者可以指定一个包含多个URL的文件和一个要执行的命令。该脚本会向这些URL发送特制的请求，其中包含序列化的恶意payload，从而在目标服务器上执行指定的命令，获取web用户权限。该漏洞利用代码的投毒风险较低，主要风险在于使用者自身行为，利用此工具进行未授权的渗透测试或攻击。因为代码中包含从 `lib/ua.txt` 读取 User-Agent 的操作，以及输出文件功能，存在一定的信息收集行为，可能用于后期攻击，但总体上代码逻辑清晰，风险可控。

**利用方式：**

1.  **漏洞定位：** SPIP 4.2.1之前的版本存在反序列化漏洞，具体位置在`oubli`参数中，允许在公共区域提交的表单值。
2.  **攻击流程：**
    *   攻击者构造包含恶意代码的序列化payload。
    *   将payload作为表单值提交给存在漏洞的SPIP站点。
    *   SPIP站点反序列化该数据时，恶意代码被执行。
3.  **漏洞利用代码分析：**
    *   `spip.py`脚本接受目标URL列表和要执行的命令作为参数。
    *   脚本使用`requests`库发送HTTP请求，将序列化的payload包含在POST请求的参数中。
    *   服务器端反序列化payload，执行攻击者指定的命令。
4.  **缓解措施：**
    *   将SPIP升级到3.2.18, 4.0.10, 4.1.8, 或 4.2.1及以上版本。
    *   限制对SPIP站点的公共访问。

**项目地址:** [ThatNotEasy/CVE-2023-27372](https://github.com/ThatNotEasy/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #7

**来源**: [CVE-2023-27372-dream434_CVE-2023-27372.md](../2023/CVE-2023-27372-dream434_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要目标SPIP站点存在漏洞页面且可公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27372 是 SPIP 内容管理系统（CMS）中存在的一个远程代码执行漏洞。该漏洞源于 SPIP 在处理表单值时，由于对序列化数据处理不当，导致攻击者可以通过构造恶意的序列化数据，将其作为表单参数提交到存在漏洞的页面，从而在服务器端执行任意代码。

**有效性：**

根据漏洞信息和搜索结果，提供的 POC 代码是有效的。多个资源（如 Packet Storm 和 GitHub 上的 Chocapikk/CVE-2023-27372）都提供了可用于利用该漏洞的 POC 或扫描器。

**投毒风险：**

代码中存在轻微的投毒风险。主要风险点在于：

*   **依赖项安装错误引导:** README.md文件引导用户安装 `collorama` , 正确的安装包应该是 `colorama`，如果用户安装了恶意攻击者伪造的 `collorama` 包，则可能存在安全风险。 *   **执行任意命令：** POC 允许执行任意命令。如果攻击者修改了 POC 中的 `whoami` 命令，替换为恶意命令，可能会造成更大的危害。例如，删除服务器文件、安装恶意软件等。但这种风险主要取决于使用者如何使用 POC，而非 POC 本身包含恶意代码。

考虑到这些因素，我将投毒风险评估为 5%。主要是安装包名称拼写错误引导，存在被利用的可能性。

**利用方式：**

1.  **查找目标：** 寻找运行 SPIP 且版本低于 4.2.1 的站点。
2.  **构造Payload：** 攻击者构造包含恶意 PHP 代码的序列化数据。
3.  **获取CSRF Token：** 首先，向 `/spip.php?page=spip_pass` 页面发起 GET 请求，解析 HTML 响应，提取名为 `formulaire_action_args` 的隐藏输入字段中的 CSRF token。
4.  **发送恶意请求：** 将构造的序列化数据作为 `oubli` 参数的值，连同其他必要的表单参数（包括上一步获取的 CSRF token）通过 POST 请求发送到 `/spip.php?page=spip_pass` 页面。
5.  **代码执行：** SPIP 在处理表单数据时，反序列化 `oubli` 参数，从而执行攻击者注入的恶意 PHP 代码。

简而言之，利用方式是通过构造包含恶意代码的序列化数据，并将其作为表单参数提交到 SPIP 站点，从而实现远程代码执行。

**项目地址:** [dream434/CVE-2023-27372](https://github.com/dream434/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #8

**来源**: [CVE-2023-27372-izzz0_CVE-2023-27372-POC.md](../2023/CVE-2023-27372-izzz0_CVE-2023-27372-POC.md)

## CVE-2023-27372-SPIP远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 目标服务器运行存在漏洞的SPIP版本，且漏洞利用发生在公共区域，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP 4.2.1之前版本中的一个远程代码执行漏洞。该漏洞是由于SPIP处理表单值中的序列化数据不当造成的。攻击者可以通过在公共区域提交包含恶意序列化数据的表单值来利用此漏洞，从而执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，该漏洞是有效的。POC代码通过构造特定的POST请求，向`spip.php?page=spip_pass`页面提交包含恶意PHP代码的序列化字符串，利用SPIP的反序列化漏洞执行代码。如果服务器返回包含`phpinfo()`结果的页面，则表明存在漏洞。

**投毒风险：**
代码主体逻辑是漏洞验证，风险较低。但仍然存在一定的投毒风险，因为攻击者可能修改POC代码，使其包含恶意操作，例如：

*   **植入后门:** POC中可以加入执行任意系统命令的代码，从而在目标服务器上植入后门。
*   **数据窃取:** POC可以被修改为窃取服务器上的敏感数据，例如数据库凭据或配置文件。
*   **拒绝服务攻击:** POC可以被修改为发送大量请求，导致目标服务器过载，从而造成拒绝服务攻击。
POC 使用 phpinfo() 验证，比较安全，但潜在风险依然存在。因此，投毒风险评估为10%。

**利用方式：**
1.  确定目标网站运行的SPIP版本低于4.2.1。
2.  向`spip.php?page=spip_pass`页面发送包含以下参数的POST请求：
    *   `formulaire_action=oubli`
    *   `formulaire_action_args`：从页面中提取的`formulaire_action_args`字段的值，进行URL编码。
    *   `oubli`: 包含恶意PHP代码的序列化字符串，例如`s:19:"<?php phpinfo(); ?>";`
    *   `nobot`：任意值，用于绕过反爬机制
3.  如果服务器返回包含恶意PHP代码执行结果的页面，则表明漏洞利用成功。例如，如果使用`phpinfo()`，则会返回phpinfo页面，或者反序列化任意类的函数，执行恶意代码。

**项目地址:** [izzz0/CVE-2023-27372-POC](https://github.com/izzz0/CVE-2023-27372-POC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #9

**来源**: [CVE-2023-27372-nuts7_CVE-2023-27372.md](../2023/CVE-2023-27372-nuts7_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要能够访问SPIP的登录页面或存在`spip_pass`页面的公开访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27372是SPIP 4.2.1之前的版本中的一个远程代码执行漏洞，原因是程序在处理表单值中的序列化数据时存在缺陷。攻击者可以通过在公共区域提交包含恶意序列化数据的表单，从而执行任意代码。PoC代码显示，它首先获取一个Anti-CSRF token，然后构造一个包含PHP代码的payload，该代码会执行指定的系统命令。这个漏洞的利用方式是，攻击者先访问登录页面 (`spip.php?page=spip_pass`)，获取`formulaire_action_args`的值 (Anti-CSRF token)。然后，攻击者构造一个POST请求，其中包含`page=spip_pass`， `formulaire_action=oubli`, `formulaire_action_args`为之前获取的CSRF token的值，并且`oubli`参数的值为精心构造的PHP序列化字符串，这个序列化字符串包含要执行的PHP代码 (使用 `system()`函数执行命令)。由于SPIP在反序列化这个`oubli`参数时存在漏洞，这会导致恶意代码执行。 

**有效性:** PoC代码有效，成功利用该漏洞能够在目标服务器上执行任意命令。

**投毒风险:** 经过检查`CVE-2023-27372.py`，`CVE-2023-27372.yaml`，`Dockerfile`和`README.md`文件。没有发现明显的恶意代码或者后门。`Dockerfile`用于构建一个包含易受攻击版本SPIP的环境，用于测试和演示漏洞。`CVE-2023-27372.yaml`是一个nuclei模板，用于检测目标是否存在此漏洞，该模板尝试执行phpinfo()，证明可以执行恶意代码。`README.md`提供有关漏洞的信息。

**利用方式:**

1.  **获取Anti-CSRF Token:**  访问受影响的SPIP站点的登录页面（`spip.php?page=spip_pass`），提取`formulaire_action_args`字段的值，即Anti-CSRF token。
2.  **构造Payload:**  构造一个包含恶意PHP代码的序列化字符串，例如`s:28:"<?php system('whoami'); ?>";`。这个字符串的长度需要根据实际的PHP代码长度进行调整。
3.  **发送Payload:**  通过POST请求将构造的Payload发送到`spip.php?page=spip_pass`，同时包含Anti-CSRF token和必要的表单参数。
4.  **执行代码:**  服务器在处理请求时，由于反序列化漏洞，会执行Payload中的PHP代码，从而实现远程代码执行。

**项目地址:** [nuts7/CVE-2023-27372](https://github.com/nuts7/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #10

**来源**: [CVE-2023-27372-redboltsec_CVE-2023-27372-PoC.md](../2023/CVE-2023-27372-redboltsec_CVE-2023-27372-PoC.md)

## CVE-2023-27372 SPIP RCE

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 4.2.1 (受影响版本包括3.2.18之前, 4.0.10之前, 4.1.8之前)

**利用条件:** 目标SPIP站点存在且可访问spip_pass页面，不需要任何权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27372 漏洞存在于 SPIP 4.2.1 之前的版本，允许未经身份验证的远程攻击者通过 `spip.php?page=spip_pass` 页面的 form values 执行任意代码。该漏洞源于 `ecrire/balise/formulaire_.php` 文件中 `protege_champ` 函数对序列化数据处理不当，未进行充分的输入验证，导致反序列化漏洞。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。Packet Storm Security 和 GitHub (Chocapikk/CVE-2023-27372) 都提供了漏洞利用代码或扫描器，证明该漏洞是可以被利用的。POC 代码通过构造恶意的序列化字符串，并将其作为 `oubli` 参数的值发送到 `spip.php?page=spip_pass` 页面，从而触发反序列化漏洞。

**投毒风险：**
分析提供的 PoC 代码 (`cve-2023-27372.py`)，未发现明显的投毒代码。该脚本的主要功能是：

1.  获取 CSRF token (如果存在)。
2.  构造包含恶意 PHP 代码的序列化 payload，该代码使用 `exec` 函数执行命令。
3.  将 payload 发送到目标 SPIP 站点。
4.  解析响应，提取命令执行结果。

脚本本身没有执行任何与目标系统无关的操作，例如上传恶意文件、修改系统配置或连接到外部服务器。因此，投毒风险较低。

**利用方式：**

1.  **定位目标:**  确定存在漏洞的 SPIP 站点，版本低于 4.2.1，且允许公共访问 `spip.php?page=spip_pass` 页面。
2.  **获取 CSRF Token (如果需要):** 访问 `spip.php?page=spip_pass` 页面，提取 CSRF token (`formulaire_action_args`)。有些情况下，可能不需要 CSRF token。
3.  **构造 Payload:**  构造包含恶意 PHP 代码的序列化字符串，用于执行任意命令。例如，使用 `<?php system($_GET['cmd']); ?>` 来执行 GET 请求中的 `cmd` 参数指定的命令。
4.  **发送 Payload:**  将构造的 Payload 作为 `oubli` 参数的值，通过 POST 请求发送到 `spip.php?page=spip_pass` 页面，同时附带 CSRF token (如果需要)。
5.  **执行命令:**  如果 Payload 成功执行，则可以通过构造特定的 HTTP 请求来执行任意命令。例如，访问 `spip.php?page=spip_pass&cmd=whoami` 来执行 `whoami` 命令，获取当前用户。
6.  **交互式 Shell (POC代码)**: PoC中尝试使用`whoami`检测是否RCE成功，如果失败，PoC会尝试生成一个交互式shell。这部分代码可能存在问题，需要用户多次输入命令。

**缓解措施：**
升级到 SPIP 4.2.1 或更高版本，或者应用补丁以修复反序列化漏洞。


**项目地址:** [redboltsec/CVE-2023-27372-PoC](https://github.com/redboltsec/CVE-2023-27372-PoC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---



---

## POC #3

**来源**: [CVE-2023-27372-1amthebest1_CVE-2023-27372.md](../2023/CVE-2023-27372-1amthebest1_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1 (受影响版本还包括3.2.x, 4.0.x, 4.1.x)

**利用条件:** 需要能够通过网络访问SPIP站点，且SPIP版本低于4.2.1，未应用安全补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27372 是 SPIP 4.2.1 之前版本中的一个远程代码执行 (RCE) 漏洞。该漏洞的根本原因是程序未正确处理反序列化数据，导致攻击者可以通过构造恶意表单值，在服务器上执行任意代码。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判断该PoC代码有效。
- 漏洞库信息明确指出SPIP在4.2.1之前的版本存在RCE漏洞，并通过不安全的反序列化来实现。
- 搜索引擎结果也证实了该漏洞的存在，并提供了多个漏洞分析和利用链接。
- PoC代码通过利用`spip_pass`页面中的`oubli`参数，传递一个包含PHP代码的序列化字符串，从而执行任意命令。该代码首先获取CSRF token，然后构造包含恶意PHP代码的payload，并发送POST请求到`spip.php?page=spip_pass`。恶意PHP代码使用`system`函数执行经过base64编码的命令。

**投毒风险分析：**
仔细检查了提供的PoC代码，没有发现明显的投毒代码。该代码结构清晰，功能明确，主要用于验证和利用漏洞。风险百分比评估为0%。

**利用方式：**
1.  **漏洞定位：** 该漏洞存在于 SPIP 的前台页面，攻击者无需认证即可利用。
2.  **CSRF Token 获取：** 攻击者首先访问 `spip.php?page=spip_pass` 页面，从中提取 CSRF Token，用于绕过 CSRF 保护。
3.  **Payload 构造：** 攻击者构造一个包含恶意 PHP 代码的序列化字符串。该 PHP 代码通常使用 `system()` 函数执行任意命令。为了避免过滤，命令通常会进行 base64 编码。
4.  **漏洞触发：** 攻击者将构造好的 Payload 放入 `oubli` 参数中，通过 POST 请求发送到 `spip.php?page=spip_pass` 页面，触发反序列化漏洞，从而执行任意代码。
5.  **反弹shell:** 通过反弹shell获得目标机器的权限。


**项目地址:** [1amthebest1/CVE-2023-27372](https://github.com/1amthebest1/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #4

**来源**: [CVE-2023-27372-Chocapikk_CVE-2023-27372.md](../2023/CVE-2023-27372-Chocapikk_CVE-2023-27372.md)

## CVE-2023-27372 SPIP Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要目标SPIP站点存在，且能访问其spip.php?page=spip_pass页面

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27372是SPIP CMS 4.2.1之前版本中的一个远程代码执行漏洞。该漏洞源于程序在处理表单值时，反序列化过程存在缺陷。未经身份验证的攻击者可以通过向易受攻击的SPIP实例上的spip.php?page=spip_pass页面提交特制的表单值，从而利用此漏洞执行任意代码。

**漏洞利用方式：**

1.  **获取Anti-CSRF Token：** PoC脚本首先访问`spip.php?page=spip_pass`页面，解析HTML，提取名为`formulaire_action_args`的input标签中的`value`属性，该值用作Anti-CSRF token。
2.  **构造恶意Payload：**  PoC脚本使用PHP序列化的方式构造恶意代码，通过`oubli`参数传递给`spip.php?page=spip_pass`。
3.  **发送POST请求：**  将包含Anti-CSRF token和恶意payload的POST请求发送到`spip.php?page=spip_pass`，触发反序列化漏洞，从而执行任意代码。
4.  **解析输出：**PoC脚本使用正则表达式提取命令执行结果，如果执行`whoami`成功则认为漏洞存在。

**有效性：**

根据漏洞库信息、搜索结果，以及提供的PoC代码，可以确定该漏洞是真实存在的，并且该PoC代码看起来可以有效利用该漏洞实现远程代码执行。

**投毒风险：**

检查PoC代码发现，该脚本的功能主要是利用CVE-2023-27372漏洞进行RCE验证。通过以下几个方面评估投毒风险：

*   **LeakIX API Key配置:** 脚本中`LEAKIX_API_KEY` 变量需要用户自己配置LeakIX API Key，如果用户不配置则无法从LeakIX获取SPIP URLs。
*   **Payload执行命令:** Payload中执行的命令是`whoami`，这是一个相对安全的命令，用于判断是否成功执行代码。但也存在执行其他命令的潜在风险。
*   **代码逻辑：** 代码逻辑相对清晰，主要是发送请求、解析响应和执行命令。但作者可以加入一些恶意代码来增加风险。
*   **第三方库：** 使用了`requests`、`bs4`、`rich`等第三方库，这些库本身可能存在安全漏洞。

综合考虑，该PoC代码存在少量投毒风险，可能被利用执行未经授权的命令、搜集或窃取用户信息。 风险评估为1%。

**项目地址:** [Chocapikk/CVE-2023-27372](https://github.com/Chocapikk/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #5

**来源**: [CVE-2023-27372-G01d3nW01f_cve-2023-27372.md](../2023/CVE-2023-27372-G01d3nW01f_cve-2023-27372.md)

## CVE-2023-27372 - SPIP Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution

**影响应用:** SPIP

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 4.2.1

**利用条件:** SPIP 实例需要可公开访问，并且运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372 是 SPIP CMS 中的一个远程代码执行漏洞，源于对反序列化数据处理不当。攻击者可以利用此漏洞通过在公共区域的表单值中注入恶意序列化数据来执行任意代码。

**有效性分析：**
提供的 exploit.py 脚本利用了此漏洞。它首先从目标 URL 的 `/spip/spip.php?page=spip_pass` 获取 `formulaire_action_args` 参数。然后，它构造一个包含恶意 PHP 代码的 POST 请求，该代码使用 `system()` 函数执行攻击者提供的命令。该恶意 PHP 代码被序列化并作为 `oubli` 参数传递。脚本的成功执行表明漏洞是可利用的。

**投毒风险分析：**
查看 exploit.py 脚本，其主要功能是利用 CVE-2023-27372 漏洞实现远程代码执行。脚本首先获取目标 URL，然后构造恶意 payload 并发送 POST 请求。脚本本身没有明显的恶意行为，如植入后门或传播恶意软件。
但是，该脚本本身依赖于用户提供的命令来执行 RCE。如果用户不小心执行了包含恶意命令的脚本，可能会导致目标系统受到损害。
在 readme.md 文件中，声明了 “education purpose only!!!!!”，降低了投毒的可能性。
仓库中，可能存在投毒代码的风险较低，约为 10%。

**利用方式：**
1.  攻击者向 SPIP 站点的 `/spip/spip.php?page=spip_pass` 发送 GET 请求。
2.  攻击者解析响应，提取 `formulaire_action_args` 参数。
3.  攻击者构造一个 POST 请求，将 `formulaire_action` 设置为 `oubli`，`formulaire_action_args` 设置为提取的值，并将恶意 PHP 代码序列化后作为 `oubli` 参数的值发送。
4.  SPIP 在处理 POST 请求时，反序列化 `oubli` 参数的值，导致恶意 PHP 代码被执行，从而实现远程代码执行。

**项目地址:** [G01d3nW01f/cve-2023-27372](https://github.com/G01d3nW01f/cve-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #6

**来源**: [CVE-2023-27372-ThatNotEasy_CVE-2023-27372.md](../2023/CVE-2023-27372-ThatNotEasy_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 目标网站必须运行存在漏洞的SPIP版本，且漏洞利用点对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP内容管理系统4.2.1之前版本中的一个远程代码执行漏洞。该漏洞源于SPIP处理反序列化数据的方式不当，允许未经身份验证的攻击者通过表单值执行任意命令。根据提供的漏洞利用代码，攻击者可以指定一个包含多个URL的文件和一个要执行的命令。该脚本会向这些URL发送特制的请求，其中包含序列化的恶意payload，从而在目标服务器上执行指定的命令，获取web用户权限。该漏洞利用代码的投毒风险较低，主要风险在于使用者自身行为，利用此工具进行未授权的渗透测试或攻击。因为代码中包含从 `lib/ua.txt` 读取 User-Agent 的操作，以及输出文件功能，存在一定的信息收集行为，可能用于后期攻击，但总体上代码逻辑清晰，风险可控。

**利用方式：**

1.  **漏洞定位：** SPIP 4.2.1之前的版本存在反序列化漏洞，具体位置在`oubli`参数中，允许在公共区域提交的表单值。
2.  **攻击流程：**
    *   攻击者构造包含恶意代码的序列化payload。
    *   将payload作为表单值提交给存在漏洞的SPIP站点。
    *   SPIP站点反序列化该数据时，恶意代码被执行。
3.  **漏洞利用代码分析：**
    *   `spip.py`脚本接受目标URL列表和要执行的命令作为参数。
    *   脚本使用`requests`库发送HTTP请求，将序列化的payload包含在POST请求的参数中。
    *   服务器端反序列化payload，执行攻击者指定的命令。
4.  **缓解措施：**
    *   将SPIP升级到3.2.18, 4.0.10, 4.1.8, 或 4.2.1及以上版本。
    *   限制对SPIP站点的公共访问。

**项目地址:** [ThatNotEasy/CVE-2023-27372](https://github.com/ThatNotEasy/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #7

**来源**: [CVE-2023-27372-dream434_CVE-2023-27372.md](../2023/CVE-2023-27372-dream434_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要目标SPIP站点存在漏洞页面且可公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27372 是 SPIP 内容管理系统（CMS）中存在的一个远程代码执行漏洞。该漏洞源于 SPIP 在处理表单值时，由于对序列化数据处理不当，导致攻击者可以通过构造恶意的序列化数据，将其作为表单参数提交到存在漏洞的页面，从而在服务器端执行任意代码。

**有效性：**

根据漏洞信息和搜索结果，提供的 POC 代码是有效的。多个资源（如 Packet Storm 和 GitHub 上的 Chocapikk/CVE-2023-27372）都提供了可用于利用该漏洞的 POC 或扫描器。

**投毒风险：**

代码中存在轻微的投毒风险。主要风险点在于：

*   **依赖项安装错误引导:** README.md文件引导用户安装 `collorama` , 正确的安装包应该是 `colorama`，如果用户安装了恶意攻击者伪造的 `collorama` 包，则可能存在安全风险。 *   **执行任意命令：** POC 允许执行任意命令。如果攻击者修改了 POC 中的 `whoami` 命令，替换为恶意命令，可能会造成更大的危害。例如，删除服务器文件、安装恶意软件等。但这种风险主要取决于使用者如何使用 POC，而非 POC 本身包含恶意代码。

考虑到这些因素，我将投毒风险评估为 5%。主要是安装包名称拼写错误引导，存在被利用的可能性。

**利用方式：**

1.  **查找目标：** 寻找运行 SPIP 且版本低于 4.2.1 的站点。
2.  **构造Payload：** 攻击者构造包含恶意 PHP 代码的序列化数据。
3.  **获取CSRF Token：** 首先，向 `/spip.php?page=spip_pass` 页面发起 GET 请求，解析 HTML 响应，提取名为 `formulaire_action_args` 的隐藏输入字段中的 CSRF token。
4.  **发送恶意请求：** 将构造的序列化数据作为 `oubli` 参数的值，连同其他必要的表单参数（包括上一步获取的 CSRF token）通过 POST 请求发送到 `/spip.php?page=spip_pass` 页面。
5.  **代码执行：** SPIP 在处理表单数据时，反序列化 `oubli` 参数，从而执行攻击者注入的恶意 PHP 代码。

简而言之，利用方式是通过构造包含恶意代码的序列化数据，并将其作为表单参数提交到 SPIP 站点，从而实现远程代码执行。

**项目地址:** [dream434/CVE-2023-27372](https://github.com/dream434/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #8

**来源**: [CVE-2023-27372-izzz0_CVE-2023-27372-POC.md](../2023/CVE-2023-27372-izzz0_CVE-2023-27372-POC.md)

## CVE-2023-27372-SPIP远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 目标服务器运行存在漏洞的SPIP版本，且漏洞利用发生在公共区域，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP 4.2.1之前版本中的一个远程代码执行漏洞。该漏洞是由于SPIP处理表单值中的序列化数据不当造成的。攻击者可以通过在公共区域提交包含恶意序列化数据的表单值来利用此漏洞，从而执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，该漏洞是有效的。POC代码通过构造特定的POST请求，向`spip.php?page=spip_pass`页面提交包含恶意PHP代码的序列化字符串，利用SPIP的反序列化漏洞执行代码。如果服务器返回包含`phpinfo()`结果的页面，则表明存在漏洞。

**投毒风险：**
代码主体逻辑是漏洞验证，风险较低。但仍然存在一定的投毒风险，因为攻击者可能修改POC代码，使其包含恶意操作，例如：

*   **植入后门:** POC中可以加入执行任意系统命令的代码，从而在目标服务器上植入后门。
*   **数据窃取:** POC可以被修改为窃取服务器上的敏感数据，例如数据库凭据或配置文件。
*   **拒绝服务攻击:** POC可以被修改为发送大量请求，导致目标服务器过载，从而造成拒绝服务攻击。
POC 使用 phpinfo() 验证，比较安全，但潜在风险依然存在。因此，投毒风险评估为10%。

**利用方式：**
1.  确定目标网站运行的SPIP版本低于4.2.1。
2.  向`spip.php?page=spip_pass`页面发送包含以下参数的POST请求：
    *   `formulaire_action=oubli`
    *   `formulaire_action_args`：从页面中提取的`formulaire_action_args`字段的值，进行URL编码。
    *   `oubli`: 包含恶意PHP代码的序列化字符串，例如`s:19:"<?php phpinfo(); ?>";`
    *   `nobot`：任意值，用于绕过反爬机制
3.  如果服务器返回包含恶意PHP代码执行结果的页面，则表明漏洞利用成功。例如，如果使用`phpinfo()`，则会返回phpinfo页面，或者反序列化任意类的函数，执行恶意代码。

**项目地址:** [izzz0/CVE-2023-27372-POC](https://github.com/izzz0/CVE-2023-27372-POC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #9

**来源**: [CVE-2023-27372-nuts7_CVE-2023-27372.md](../2023/CVE-2023-27372-nuts7_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要能够访问SPIP的登录页面或存在`spip_pass`页面的公开访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27372是SPIP 4.2.1之前的版本中的一个远程代码执行漏洞，原因是程序在处理表单值中的序列化数据时存在缺陷。攻击者可以通过在公共区域提交包含恶意序列化数据的表单，从而执行任意代码。PoC代码显示，它首先获取一个Anti-CSRF token，然后构造一个包含PHP代码的payload，该代码会执行指定的系统命令。这个漏洞的利用方式是，攻击者先访问登录页面 (`spip.php?page=spip_pass`)，获取`formulaire_action_args`的值 (Anti-CSRF token)。然后，攻击者构造一个POST请求，其中包含`page=spip_pass`， `formulaire_action=oubli`, `formulaire_action_args`为之前获取的CSRF token的值，并且`oubli`参数的值为精心构造的PHP序列化字符串，这个序列化字符串包含要执行的PHP代码 (使用 `system()`函数执行命令)。由于SPIP在反序列化这个`oubli`参数时存在漏洞，这会导致恶意代码执行。 

**有效性:** PoC代码有效，成功利用该漏洞能够在目标服务器上执行任意命令。

**投毒风险:** 经过检查`CVE-2023-27372.py`，`CVE-2023-27372.yaml`，`Dockerfile`和`README.md`文件。没有发现明显的恶意代码或者后门。`Dockerfile`用于构建一个包含易受攻击版本SPIP的环境，用于测试和演示漏洞。`CVE-2023-27372.yaml`是一个nuclei模板，用于检测目标是否存在此漏洞，该模板尝试执行phpinfo()，证明可以执行恶意代码。`README.md`提供有关漏洞的信息。

**利用方式:**

1.  **获取Anti-CSRF Token:**  访问受影响的SPIP站点的登录页面（`spip.php?page=spip_pass`），提取`formulaire_action_args`字段的值，即Anti-CSRF token。
2.  **构造Payload:**  构造一个包含恶意PHP代码的序列化字符串，例如`s:28:"<?php system('whoami'); ?>";`。这个字符串的长度需要根据实际的PHP代码长度进行调整。
3.  **发送Payload:**  通过POST请求将构造的Payload发送到`spip.php?page=spip_pass`，同时包含Anti-CSRF token和必要的表单参数。
4.  **执行代码:**  服务器在处理请求时，由于反序列化漏洞，会执行Payload中的PHP代码，从而实现远程代码执行。

**项目地址:** [nuts7/CVE-2023-27372](https://github.com/nuts7/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #10

**来源**: [CVE-2023-27372-redboltsec_CVE-2023-27372-PoC.md](../2023/CVE-2023-27372-redboltsec_CVE-2023-27372-PoC.md)

## CVE-2023-27372 SPIP RCE

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 4.2.1 (受影响版本包括3.2.18之前, 4.0.10之前, 4.1.8之前)

**利用条件:** 目标SPIP站点存在且可访问spip_pass页面，不需要任何权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27372 漏洞存在于 SPIP 4.2.1 之前的版本，允许未经身份验证的远程攻击者通过 `spip.php?page=spip_pass` 页面的 form values 执行任意代码。该漏洞源于 `ecrire/balise/formulaire_.php` 文件中 `protege_champ` 函数对序列化数据处理不当，未进行充分的输入验证，导致反序列化漏洞。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。Packet Storm Security 和 GitHub (Chocapikk/CVE-2023-27372) 都提供了漏洞利用代码或扫描器，证明该漏洞是可以被利用的。POC 代码通过构造恶意的序列化字符串，并将其作为 `oubli` 参数的值发送到 `spip.php?page=spip_pass` 页面，从而触发反序列化漏洞。

**投毒风险：**
分析提供的 PoC 代码 (`cve-2023-27372.py`)，未发现明显的投毒代码。该脚本的主要功能是：

1.  获取 CSRF token (如果存在)。
2.  构造包含恶意 PHP 代码的序列化 payload，该代码使用 `exec` 函数执行命令。
3.  将 payload 发送到目标 SPIP 站点。
4.  解析响应，提取命令执行结果。

脚本本身没有执行任何与目标系统无关的操作，例如上传恶意文件、修改系统配置或连接到外部服务器。因此，投毒风险较低。

**利用方式：**

1.  **定位目标:**  确定存在漏洞的 SPIP 站点，版本低于 4.2.1，且允许公共访问 `spip.php?page=spip_pass` 页面。
2.  **获取 CSRF Token (如果需要):** 访问 `spip.php?page=spip_pass` 页面，提取 CSRF token (`formulaire_action_args`)。有些情况下，可能不需要 CSRF token。
3.  **构造 Payload:**  构造包含恶意 PHP 代码的序列化字符串，用于执行任意命令。例如，使用 `<?php system($_GET['cmd']); ?>` 来执行 GET 请求中的 `cmd` 参数指定的命令。
4.  **发送 Payload:**  将构造的 Payload 作为 `oubli` 参数的值，通过 POST 请求发送到 `spip.php?page=spip_pass` 页面，同时附带 CSRF token (如果需要)。
5.  **执行命令:**  如果 Payload 成功执行，则可以通过构造特定的 HTTP 请求来执行任意命令。例如，访问 `spip.php?page=spip_pass&cmd=whoami` 来执行 `whoami` 命令，获取当前用户。
6.  **交互式 Shell (POC代码)**: PoC中尝试使用`whoami`检测是否RCE成功，如果失败，PoC会尝试生成一个交互式shell。这部分代码可能存在问题，需要用户多次输入命令。

**缓解措施：**
升级到 SPIP 4.2.1 或更高版本，或者应用补丁以修复反序列化漏洞。


**项目地址:** [redboltsec/CVE-2023-27372-PoC](https://github.com/redboltsec/CVE-2023-27372-PoC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---



---

## POC #3

**来源**: [CVE-2023-27372-1amthebest1_CVE-2023-27372.md](../2023/CVE-2023-27372-1amthebest1_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1 (受影响版本还包括3.2.x, 4.0.x, 4.1.x)

**利用条件:** 需要能够通过网络访问SPIP站点，且SPIP版本低于4.2.1，未应用安全补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27372 是 SPIP 4.2.1 之前版本中的一个远程代码执行 (RCE) 漏洞。该漏洞的根本原因是程序未正确处理反序列化数据，导致攻击者可以通过构造恶意表单值，在服务器上执行任意代码。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判断该PoC代码有效。
- 漏洞库信息明确指出SPIP在4.2.1之前的版本存在RCE漏洞，并通过不安全的反序列化来实现。
- 搜索引擎结果也证实了该漏洞的存在，并提供了多个漏洞分析和利用链接。
- PoC代码通过利用`spip_pass`页面中的`oubli`参数，传递一个包含PHP代码的序列化字符串，从而执行任意命令。该代码首先获取CSRF token，然后构造包含恶意PHP代码的payload，并发送POST请求到`spip.php?page=spip_pass`。恶意PHP代码使用`system`函数执行经过base64编码的命令。

**投毒风险分析：**
仔细检查了提供的PoC代码，没有发现明显的投毒代码。该代码结构清晰，功能明确，主要用于验证和利用漏洞。风险百分比评估为0%。

**利用方式：**
1.  **漏洞定位：** 该漏洞存在于 SPIP 的前台页面，攻击者无需认证即可利用。
2.  **CSRF Token 获取：** 攻击者首先访问 `spip.php?page=spip_pass` 页面，从中提取 CSRF Token，用于绕过 CSRF 保护。
3.  **Payload 构造：** 攻击者构造一个包含恶意 PHP 代码的序列化字符串。该 PHP 代码通常使用 `system()` 函数执行任意命令。为了避免过滤，命令通常会进行 base64 编码。
4.  **漏洞触发：** 攻击者将构造好的 Payload 放入 `oubli` 参数中，通过 POST 请求发送到 `spip.php?page=spip_pass` 页面，触发反序列化漏洞，从而执行任意代码。
5.  **反弹shell:** 通过反弹shell获得目标机器的权限。


**项目地址:** [1amthebest1/CVE-2023-27372](https://github.com/1amthebest1/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #4

**来源**: [CVE-2023-27372-Chocapikk_CVE-2023-27372.md](../2023/CVE-2023-27372-Chocapikk_CVE-2023-27372.md)

## CVE-2023-27372 SPIP Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要目标SPIP站点存在，且能访问其spip.php?page=spip_pass页面

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27372是SPIP CMS 4.2.1之前版本中的一个远程代码执行漏洞。该漏洞源于程序在处理表单值时，反序列化过程存在缺陷。未经身份验证的攻击者可以通过向易受攻击的SPIP实例上的spip.php?page=spip_pass页面提交特制的表单值，从而利用此漏洞执行任意代码。

**漏洞利用方式：**

1.  **获取Anti-CSRF Token：** PoC脚本首先访问`spip.php?page=spip_pass`页面，解析HTML，提取名为`formulaire_action_args`的input标签中的`value`属性，该值用作Anti-CSRF token。
2.  **构造恶意Payload：**  PoC脚本使用PHP序列化的方式构造恶意代码，通过`oubli`参数传递给`spip.php?page=spip_pass`。
3.  **发送POST请求：**  将包含Anti-CSRF token和恶意payload的POST请求发送到`spip.php?page=spip_pass`，触发反序列化漏洞，从而执行任意代码。
4.  **解析输出：**PoC脚本使用正则表达式提取命令执行结果，如果执行`whoami`成功则认为漏洞存在。

**有效性：**

根据漏洞库信息、搜索结果，以及提供的PoC代码，可以确定该漏洞是真实存在的，并且该PoC代码看起来可以有效利用该漏洞实现远程代码执行。

**投毒风险：**

检查PoC代码发现，该脚本的功能主要是利用CVE-2023-27372漏洞进行RCE验证。通过以下几个方面评估投毒风险：

*   **LeakIX API Key配置:** 脚本中`LEAKIX_API_KEY` 变量需要用户自己配置LeakIX API Key，如果用户不配置则无法从LeakIX获取SPIP URLs。
*   **Payload执行命令:** Payload中执行的命令是`whoami`，这是一个相对安全的命令，用于判断是否成功执行代码。但也存在执行其他命令的潜在风险。
*   **代码逻辑：** 代码逻辑相对清晰，主要是发送请求、解析响应和执行命令。但作者可以加入一些恶意代码来增加风险。
*   **第三方库：** 使用了`requests`、`bs4`、`rich`等第三方库，这些库本身可能存在安全漏洞。

综合考虑，该PoC代码存在少量投毒风险，可能被利用执行未经授权的命令、搜集或窃取用户信息。 风险评估为1%。

**项目地址:** [Chocapikk/CVE-2023-27372](https://github.com/Chocapikk/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #5

**来源**: [CVE-2023-27372-G01d3nW01f_cve-2023-27372.md](../2023/CVE-2023-27372-G01d3nW01f_cve-2023-27372.md)

## CVE-2023-27372 - SPIP Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution

**影响应用:** SPIP

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 4.2.1

**利用条件:** SPIP 实例需要可公开访问，并且运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372 是 SPIP CMS 中的一个远程代码执行漏洞，源于对反序列化数据处理不当。攻击者可以利用此漏洞通过在公共区域的表单值中注入恶意序列化数据来执行任意代码。

**有效性分析：**
提供的 exploit.py 脚本利用了此漏洞。它首先从目标 URL 的 `/spip/spip.php?page=spip_pass` 获取 `formulaire_action_args` 参数。然后，它构造一个包含恶意 PHP 代码的 POST 请求，该代码使用 `system()` 函数执行攻击者提供的命令。该恶意 PHP 代码被序列化并作为 `oubli` 参数传递。脚本的成功执行表明漏洞是可利用的。

**投毒风险分析：**
查看 exploit.py 脚本，其主要功能是利用 CVE-2023-27372 漏洞实现远程代码执行。脚本首先获取目标 URL，然后构造恶意 payload 并发送 POST 请求。脚本本身没有明显的恶意行为，如植入后门或传播恶意软件。
但是，该脚本本身依赖于用户提供的命令来执行 RCE。如果用户不小心执行了包含恶意命令的脚本，可能会导致目标系统受到损害。
在 readme.md 文件中，声明了 “education purpose only!!!!!”，降低了投毒的可能性。
仓库中，可能存在投毒代码的风险较低，约为 10%。

**利用方式：**
1.  攻击者向 SPIP 站点的 `/spip/spip.php?page=spip_pass` 发送 GET 请求。
2.  攻击者解析响应，提取 `formulaire_action_args` 参数。
3.  攻击者构造一个 POST 请求，将 `formulaire_action` 设置为 `oubli`，`formulaire_action_args` 设置为提取的值，并将恶意 PHP 代码序列化后作为 `oubli` 参数的值发送。
4.  SPIP 在处理 POST 请求时，反序列化 `oubli` 参数的值，导致恶意 PHP 代码被执行，从而实现远程代码执行。

**项目地址:** [G01d3nW01f/cve-2023-27372](https://github.com/G01d3nW01f/cve-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #6

**来源**: [CVE-2023-27372-ThatNotEasy_CVE-2023-27372.md](../2023/CVE-2023-27372-ThatNotEasy_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 目标网站必须运行存在漏洞的SPIP版本，且漏洞利用点对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP内容管理系统4.2.1之前版本中的一个远程代码执行漏洞。该漏洞源于SPIP处理反序列化数据的方式不当，允许未经身份验证的攻击者通过表单值执行任意命令。根据提供的漏洞利用代码，攻击者可以指定一个包含多个URL的文件和一个要执行的命令。该脚本会向这些URL发送特制的请求，其中包含序列化的恶意payload，从而在目标服务器上执行指定的命令，获取web用户权限。该漏洞利用代码的投毒风险较低，主要风险在于使用者自身行为，利用此工具进行未授权的渗透测试或攻击。因为代码中包含从 `lib/ua.txt` 读取 User-Agent 的操作，以及输出文件功能，存在一定的信息收集行为，可能用于后期攻击，但总体上代码逻辑清晰，风险可控。

**利用方式：**

1.  **漏洞定位：** SPIP 4.2.1之前的版本存在反序列化漏洞，具体位置在`oubli`参数中，允许在公共区域提交的表单值。
2.  **攻击流程：**
    *   攻击者构造包含恶意代码的序列化payload。
    *   将payload作为表单值提交给存在漏洞的SPIP站点。
    *   SPIP站点反序列化该数据时，恶意代码被执行。
3.  **漏洞利用代码分析：**
    *   `spip.py`脚本接受目标URL列表和要执行的命令作为参数。
    *   脚本使用`requests`库发送HTTP请求，将序列化的payload包含在POST请求的参数中。
    *   服务器端反序列化payload，执行攻击者指定的命令。
4.  **缓解措施：**
    *   将SPIP升级到3.2.18, 4.0.10, 4.1.8, 或 4.2.1及以上版本。
    *   限制对SPIP站点的公共访问。

**项目地址:** [ThatNotEasy/CVE-2023-27372](https://github.com/ThatNotEasy/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #7

**来源**: [CVE-2023-27372-dream434_CVE-2023-27372.md](../2023/CVE-2023-27372-dream434_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要目标SPIP站点存在漏洞页面且可公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27372 是 SPIP 内容管理系统（CMS）中存在的一个远程代码执行漏洞。该漏洞源于 SPIP 在处理表单值时，由于对序列化数据处理不当，导致攻击者可以通过构造恶意的序列化数据，将其作为表单参数提交到存在漏洞的页面，从而在服务器端执行任意代码。

**有效性：**

根据漏洞信息和搜索结果，提供的 POC 代码是有效的。多个资源（如 Packet Storm 和 GitHub 上的 Chocapikk/CVE-2023-27372）都提供了可用于利用该漏洞的 POC 或扫描器。

**投毒风险：**

代码中存在轻微的投毒风险。主要风险点在于：

*   **依赖项安装错误引导:** README.md文件引导用户安装 `collorama` , 正确的安装包应该是 `colorama`，如果用户安装了恶意攻击者伪造的 `collorama` 包，则可能存在安全风险。 *   **执行任意命令：** POC 允许执行任意命令。如果攻击者修改了 POC 中的 `whoami` 命令，替换为恶意命令，可能会造成更大的危害。例如，删除服务器文件、安装恶意软件等。但这种风险主要取决于使用者如何使用 POC，而非 POC 本身包含恶意代码。

考虑到这些因素，我将投毒风险评估为 5%。主要是安装包名称拼写错误引导，存在被利用的可能性。

**利用方式：**

1.  **查找目标：** 寻找运行 SPIP 且版本低于 4.2.1 的站点。
2.  **构造Payload：** 攻击者构造包含恶意 PHP 代码的序列化数据。
3.  **获取CSRF Token：** 首先，向 `/spip.php?page=spip_pass` 页面发起 GET 请求，解析 HTML 响应，提取名为 `formulaire_action_args` 的隐藏输入字段中的 CSRF token。
4.  **发送恶意请求：** 将构造的序列化数据作为 `oubli` 参数的值，连同其他必要的表单参数（包括上一步获取的 CSRF token）通过 POST 请求发送到 `/spip.php?page=spip_pass` 页面。
5.  **代码执行：** SPIP 在处理表单数据时，反序列化 `oubli` 参数，从而执行攻击者注入的恶意 PHP 代码。

简而言之，利用方式是通过构造包含恶意代码的序列化数据，并将其作为表单参数提交到 SPIP 站点，从而实现远程代码执行。

**项目地址:** [dream434/CVE-2023-27372](https://github.com/dream434/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #8

**来源**: [CVE-2023-27372-izzz0_CVE-2023-27372-POC.md](../2023/CVE-2023-27372-izzz0_CVE-2023-27372-POC.md)

## CVE-2023-27372-SPIP远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 目标服务器运行存在漏洞的SPIP版本，且漏洞利用发生在公共区域，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP 4.2.1之前版本中的一个远程代码执行漏洞。该漏洞是由于SPIP处理表单值中的序列化数据不当造成的。攻击者可以通过在公共区域提交包含恶意序列化数据的表单值来利用此漏洞，从而执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，该漏洞是有效的。POC代码通过构造特定的POST请求，向`spip.php?page=spip_pass`页面提交包含恶意PHP代码的序列化字符串，利用SPIP的反序列化漏洞执行代码。如果服务器返回包含`phpinfo()`结果的页面，则表明存在漏洞。

**投毒风险：**
代码主体逻辑是漏洞验证，风险较低。但仍然存在一定的投毒风险，因为攻击者可能修改POC代码，使其包含恶意操作，例如：

*   **植入后门:** POC中可以加入执行任意系统命令的代码，从而在目标服务器上植入后门。
*   **数据窃取:** POC可以被修改为窃取服务器上的敏感数据，例如数据库凭据或配置文件。
*   **拒绝服务攻击:** POC可以被修改为发送大量请求，导致目标服务器过载，从而造成拒绝服务攻击。
POC 使用 phpinfo() 验证，比较安全，但潜在风险依然存在。因此，投毒风险评估为10%。

**利用方式：**
1.  确定目标网站运行的SPIP版本低于4.2.1。
2.  向`spip.php?page=spip_pass`页面发送包含以下参数的POST请求：
    *   `formulaire_action=oubli`
    *   `formulaire_action_args`：从页面中提取的`formulaire_action_args`字段的值，进行URL编码。
    *   `oubli`: 包含恶意PHP代码的序列化字符串，例如`s:19:"<?php phpinfo(); ?>";`
    *   `nobot`：任意值，用于绕过反爬机制
3.  如果服务器返回包含恶意PHP代码执行结果的页面，则表明漏洞利用成功。例如，如果使用`phpinfo()`，则会返回phpinfo页面，或者反序列化任意类的函数，执行恶意代码。

**项目地址:** [izzz0/CVE-2023-27372-POC](https://github.com/izzz0/CVE-2023-27372-POC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #9

**来源**: [CVE-2023-27372-nuts7_CVE-2023-27372.md](../2023/CVE-2023-27372-nuts7_CVE-2023-27372.md)

## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要能够访问SPIP的登录页面或存在`spip_pass`页面的公开访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27372是SPIP 4.2.1之前的版本中的一个远程代码执行漏洞，原因是程序在处理表单值中的序列化数据时存在缺陷。攻击者可以通过在公共区域提交包含恶意序列化数据的表单，从而执行任意代码。PoC代码显示，它首先获取一个Anti-CSRF token，然后构造一个包含PHP代码的payload，该代码会执行指定的系统命令。这个漏洞的利用方式是，攻击者先访问登录页面 (`spip.php?page=spip_pass`)，获取`formulaire_action_args`的值 (Anti-CSRF token)。然后，攻击者构造一个POST请求，其中包含`page=spip_pass`， `formulaire_action=oubli`, `formulaire_action_args`为之前获取的CSRF token的值，并且`oubli`参数的值为精心构造的PHP序列化字符串，这个序列化字符串包含要执行的PHP代码 (使用 `system()`函数执行命令)。由于SPIP在反序列化这个`oubli`参数时存在漏洞，这会导致恶意代码执行。 

**有效性:** PoC代码有效，成功利用该漏洞能够在目标服务器上执行任意命令。

**投毒风险:** 经过检查`CVE-2023-27372.py`，`CVE-2023-27372.yaml`，`Dockerfile`和`README.md`文件。没有发现明显的恶意代码或者后门。`Dockerfile`用于构建一个包含易受攻击版本SPIP的环境，用于测试和演示漏洞。`CVE-2023-27372.yaml`是一个nuclei模板，用于检测目标是否存在此漏洞，该模板尝试执行phpinfo()，证明可以执行恶意代码。`README.md`提供有关漏洞的信息。

**利用方式:**

1.  **获取Anti-CSRF Token:**  访问受影响的SPIP站点的登录页面（`spip.php?page=spip_pass`），提取`formulaire_action_args`字段的值，即Anti-CSRF token。
2.  **构造Payload:**  构造一个包含恶意PHP代码的序列化字符串，例如`s:28:"<?php system('whoami'); ?>";`。这个字符串的长度需要根据实际的PHP代码长度进行调整。
3.  **发送Payload:**  通过POST请求将构造的Payload发送到`spip.php?page=spip_pass`，同时包含Anti-CSRF token和必要的表单参数。
4.  **执行代码:**  服务器在处理请求时，由于反序列化漏洞，会执行Payload中的PHP代码，从而实现远程代码执行。

**项目地址:** [nuts7/CVE-2023-27372](https://github.com/nuts7/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

## POC #10

**来源**: [CVE-2023-27372-redboltsec_CVE-2023-27372-PoC.md](../2023/CVE-2023-27372-redboltsec_CVE-2023-27372-PoC.md)

## CVE-2023-27372 SPIP RCE

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 4.2.1 (受影响版本包括3.2.18之前, 4.0.10之前, 4.1.8之前)

**利用条件:** 目标SPIP站点存在且可访问spip_pass页面，不需要任何权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27372 漏洞存在于 SPIP 4.2.1 之前的版本，允许未经身份验证的远程攻击者通过 `spip.php?page=spip_pass` 页面的 form values 执行任意代码。该漏洞源于 `ecrire/balise/formulaire_.php` 文件中 `protege_champ` 函数对序列化数据处理不当，未进行充分的输入验证，导致反序列化漏洞。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。Packet Storm Security 和 GitHub (Chocapikk/CVE-2023-27372) 都提供了漏洞利用代码或扫描器，证明该漏洞是可以被利用的。POC 代码通过构造恶意的序列化字符串，并将其作为 `oubli` 参数的值发送到 `spip.php?page=spip_pass` 页面，从而触发反序列化漏洞。

**投毒风险：**
分析提供的 PoC 代码 (`cve-2023-27372.py`)，未发现明显的投毒代码。该脚本的主要功能是：

1.  获取 CSRF token (如果存在)。
2.  构造包含恶意 PHP 代码的序列化 payload，该代码使用 `exec` 函数执行命令。
3.  将 payload 发送到目标 SPIP 站点。
4.  解析响应，提取命令执行结果。

脚本本身没有执行任何与目标系统无关的操作，例如上传恶意文件、修改系统配置或连接到外部服务器。因此，投毒风险较低。

**利用方式：**

1.  **定位目标:**  确定存在漏洞的 SPIP 站点，版本低于 4.2.1，且允许公共访问 `spip.php?page=spip_pass` 页面。
2.  **获取 CSRF Token (如果需要):** 访问 `spip.php?page=spip_pass` 页面，提取 CSRF token (`formulaire_action_args`)。有些情况下，可能不需要 CSRF token。
3.  **构造 Payload:**  构造包含恶意 PHP 代码的序列化字符串，用于执行任意命令。例如，使用 `<?php system($_GET['cmd']); ?>` 来执行 GET 请求中的 `cmd` 参数指定的命令。
4.  **发送 Payload:**  将构造的 Payload 作为 `oubli` 参数的值，通过 POST 请求发送到 `spip.php?page=spip_pass` 页面，同时附带 CSRF token (如果需要)。
5.  **执行命令:**  如果 Payload 成功执行，则可以通过构造特定的 HTTP 请求来执行任意命令。例如，访问 `spip.php?page=spip_pass&cmd=whoami` 来执行 `whoami` 命令，获取当前用户。
6.  **交互式 Shell (POC代码)**: PoC中尝试使用`whoami`检测是否RCE成功，如果失败，PoC会尝试生成一个交互式shell。这部分代码可能存在问题，需要用户多次输入命令。

**缓解措施：**
升级到 SPIP 4.2.1 或更高版本，或者应用补丁以修复反序列化漏洞。


**项目地址:** [redboltsec/CVE-2023-27372-PoC](https://github.com/redboltsec/CVE-2023-27372-PoC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

---

