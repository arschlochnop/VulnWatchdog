## CVE-2023-5360 - Royal Elementor Addons and Templates (WordPress Plugin) 任意文件上传 (RCE)

**漏洞编号:** CVE-2023-5360

**漏洞类型:** 任意文件上传 (RCE)

**影响应用:** Royal Elementor Addons and Templates (WordPress Plugin)

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** <= 1.3.78

**利用条件:** 未授权 (无需登录)，通过 admin-ajax.php 的 wpr_addons_upload_file 动作触发

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 45%

## 详情

【POC有效性分析】该POC针对WordPress插件Royal Elementor Addons的任意文件上传漏洞。代码逻辑首先通过访问目标首页，利用正则表达式从页面源码中提取名为 'WprConfig' 的配置对象，进而获取关键的 'nonce' 令牌（这是绕过安全校验的核心）。获取nonce后，脚本构建了一个多部分表单请求，指向 wp-admin/admin-ajax.php，并携带 action 为 'wpr_addons_upload_file'。代码中试图绕过文件类型限制，将文件名命名为 'shin.ph$p'，并在参数中声明 allowed_file_types 为 'ph$p'，这反映了漏洞成因在于插件在上传处理逻辑中对文件扩展名的校验存在逻辑缺陷。一旦服务器响应包含 success:true，则表明文件已成功上传至 /wp-content/uploads/wpr-addons/forms/ 目录下。利用步骤如下：1. 准备包含目标域名的List文件；2. 运行脚本并输入List路径；3. 脚本自动抓取Nonce；4. 脚本构造包含恶意PHP WebShell的POST请求；5. 验证上传结果并保存成功链接。该POC结构清晰，自动化程度高，在受影响版本上具有极高的复现成功率。 【投毒风险分析】该POC存在中等程度的投毒嫌疑。首先，在POC源码的第45行，变量 'shell' 定义的Payload并非简单的回显或测试命令，而是通过 PHP eval 执行一段从外部URL（[raw.githubusercontent.com/ajibarangxploit/shinx/main/shin.php](https://raw.githubusercontent.com/ajibarangxploit/shinx/main/shin.php)）动态下载的远程脚本。这种行为在威胁情报分析中被视为典型的“黑吃黑”投毒特征。研究员在使用此POC时，实际上会在受害者机器上植入开发者控制的二阶后门，而非研究员自己的Shell。其次，README中包含多个打赏链接（Bitcoin, Saweria, Trakteer），虽然这本身不是恶意代码，但结合远程Payload下载行为，暗示该POC的发布者具有较强的逐利动机。代码中还使用了 Python 2.7 的过时版本，这在现代安全研究工具中并不多见，增加了运行环境被劫持的潜在风险。建议防御者在进行复现实验时，务必将远程Payload链接修改为本地可控的测试脚本（如 phpinfo），或在完全隔离的沙箱环境中运行该脚本，严禁直接执行指向外部未知域名的代码片段。

**项目地址:** [https://github.com/Chocapikk/CVE-2023-5360](https://github.com/Chocapikk/CVE-2023-5360)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2023-5360](https://nvd.nist.gov/vuln/detail/CVE-2023-5360)
