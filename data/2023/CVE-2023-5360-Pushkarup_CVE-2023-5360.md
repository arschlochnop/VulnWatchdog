## CVE-2023-5360 - Royal Elementor Addons and Templates (WordPress Plugin) 任意文件上传 (Unrestricted File Upload)

**漏洞编号:** CVE-2023-5360

**漏洞类型:** 任意文件上传 (Unrestricted File Upload)

**影响应用:** Royal Elementor Addons and Templates (WordPress Plugin)

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** < 1.3.79

**利用条件:** 无需身份认证 (Unauthenticated), 远程网络访问

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞存在于WordPress的Royal Elementor Addons插件中，主要原因是插件在处理文件上传请求时缺乏必要的合法性校验。在版本1.3.79之前，插件允许未经身份验证的用户通过特定的上传接口上传包含恶意代码的文件（如PHP文件）。提供的POC代码采用Python编写，通过构造特定的HTTP POST请求，模拟插件的上传逻辑，将一个名为PHP_UPLOAD_CODE的恶意Shell植入目标服务器。该POC结构完整，包含了目标扫描、文件路径检测以及Payload的异步发送逻辑。由于插件未对上传文件的扩展名或MIME类型进行严格限制，攻击者可以通过此漏洞在服务器上执行任意代码，实现远程代码执行（RCE）。利用步骤：1. 攻击者首先通过扫描工具或手动查找确定目标WordPress网站是否安装了1.3.79版本之前的Royal Elementor Addons插件。2. 构造一个包含PHP后门代码的multipart/form-data请求，目标指向插件的文件处理接口。3. 发送请求，插件会将文件保存至Web目录下（通常是wp-content/uploads/royal-addons/目录）。4. 攻击者通过浏览器或自动化脚本访问已上传的PHP文件，从而获取系统控制权。投毒风险分析：该POC代码本身主要基于requests和asyncio库构建，代码逻辑清晰，易于审计。虽然代码中定义了一个PHP Shell（包含文件上传和管理界面），但这属于POC验证的一部分，不应视为针对安全研究员的投毒行为。在代码层面，该脚本没有检测到明显的恶意后门植入或对研究员本地机器的破坏行为。其主要的潜在风险在于代码引用了外部资源（如随机字符生成、特定User-Agent模拟等），但在提供的代码段中并未发现加密混淆、反调试或未经授权的远程命令下发逻辑。然而，作为安全研究员，在使用此类脚本时仍需注意其异步并发请求可能对生产环境造成的拒绝服务（DoS）影响，以及在不受信环境下运行可能产生的侧信道泄露风险。综合评估，该POC的投毒风险处于低位，但在实际部署和测试前，建议在隔离环境（沙箱或虚拟机）中运行，并监控其网络请求流向，以确保其仅针对预定目标进行漏洞验证。

**项目地址:** [https://wpscan.com/vulnerability/281518ff-7816-4007-b712-63aed7828b34/](https://wpscan.com/vulnerability/281518ff-7816-4007-b712-63aed7828b34/)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2023-5360](https://nvd.nist.gov/vuln/detail/CVE-2023-5360)
