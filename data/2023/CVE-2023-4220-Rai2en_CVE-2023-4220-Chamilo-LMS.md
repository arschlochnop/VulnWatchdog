## CVE-2023-4220 - Chamilo LMS RCE (远程代码执行)

**漏洞编号:** CVE-2023-4220

**漏洞类型:** RCE (远程代码执行)

**影响应用:** Chamilo LMS

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** < 1.11.24

**利用条件:** 无需身份验证，可直接通过网络访问受影响的BigUpload组件

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC针对Chamilo LMS中/main/inc/lib/javascript/bigupload/inc/bigUpload.php组件的文件上传漏洞。该漏洞源于对大文件上传处理的不当校验，允许未经身份验证的远程攻击者在web目录中上传任意文件。分析提供的代码可知，其逻辑清晰且功能完整，包含了自动化的扫描（Scan）、Webshell部署以及反弹Shell（Revshell）三个模块。利用步骤如下：1. 首先通过访问/main/inc/lib/javascript/bigupload/files/路径确认目标是否存在漏洞，该目录若存在且可访问则具备利用基础。2. 使用HTTP POST请求向bigUpload.php发送恶意PHP文件，POC通过模拟文件流分块上传，绕过了常规的后缀过滤或检查。3. 文件上传成功后，存储在/main/inc/lib/javascript/bigupload/files/目录下。4. 攻击者随后通过访问该路径下的PHP文件触发执行。在Webshell模式下，脚本会建立一个交互式的命令执行环境；在Revshell模式下，则通过部署PHP中转脚本来执行Bash反弹指令，将受害主机的控制权转移给监听端。整个POC使用了Python的requests库，代码结构模块化，具有极高的实战有效性。投毒风险分析：经过对POC源代码的审查，该项目主要使用了标准的Python库如requests和typing，未发现明显的恶意混淆代码。其主要风险点在于其功能的完整性，即它不仅提供了验证（PoC），还提供了武器化的利用手段（Exploit）。代码中硬编码的攻击路径与披露的CVE信息完全吻合，未见隐藏的外部回调或下载器。该POC项目在GitHub上公开，代码透明度高。投毒风险评估为15%，主要由于利用脚本涉及到反弹Shell操作，在测试过程中如果使用不明来源的第三方反弹地址可能导致信息泄露。建议防御方在沙箱环境中进行验证，并检查脚本是否试图向开发者控制的第三方域名发送敏感的Target URL信息。整体来看，该代码属于典型的防御性研究工具，而非恶意投毒样本，但其强大的破坏力要求安全人员在测试时严格限制在授权范围内。

**项目地址:** [https://github.com/m3m0o/chamilo-lms-unauthenticated-big-upload-rce-poc](https://github.com/m3m0o/chamilo-lms-unauthenticated-big-upload-rce-poc)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)
