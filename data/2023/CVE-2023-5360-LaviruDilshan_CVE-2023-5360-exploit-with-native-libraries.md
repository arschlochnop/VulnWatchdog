## CVE-2023-5360 - Royal Elementor Addons and Templates (WordPress Plugin) 任意文件上传 (Unauthenticated Arbitrary File Upload) 转 远程代码执行 (RCE)

**漏洞编号:** CVE-2023-5360

**漏洞类型:** 任意文件上传 (Unauthenticated Arbitrary File Upload) 转 远程代码执行 (RCE)

**影响应用:** Royal Elementor Addons and Templates (WordPress Plugin)

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** <= 1.3.78

**利用条件:** 无需认证 (Unauthenticated)，需要目标安装并启用受影响版本的插件，且 Web 目录具有写权限。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC是一个针对CVE-2023-5360的高质量漏洞利用程序。该漏洞根源在于WordPress插件Royal Elementor Addons的AJAX端点（/wp-admin/admin-ajax.php）在处理文件上传时，未能对用户提交的`allowed_file_types`参数进行严格的后端校验，且仅依赖于可被轻易获取的客户端Nonce。POC的设计非常精巧，它通过解析目标页面的JavaScript对象`WprConfig`来自动提取所需的Nonce令牌，解决了利用过程中的第一个障碍。利用步骤如下：首先，脚本向目标站点发送GET请求以提取Nonce；其次，构造一个包含恶意PHP载荷的多部分表单数据（multipart/form-data）请求。关键的绕过技巧在于利用插件对文件扩展名解析的缺陷，将文件名构造为类似`poc.ph$p`的形式，从而绕过简单的黑名单过滤，最终将文件存储在`/wp-content/uploads/royal-addons/`目录下。脚本成功后会直接返回Webshell的URL。该POC不仅实现了自动化提取凭证，还支持自定义Shell路径，兼容性测试覆盖了Ubuntu、Apache和PHP 8.1环境，在实际渗透测试和安全评估中具有极高的成功率。 投毒风险分析：该POC的投毒风险等级被评估为低（15%）。分析其源代码逻辑可知，该版本是由Laviru Dilshan对原始版本进行的防御性改写，其核心特征是采用了“无依赖化”设计。代码完全使用Python标准库（urllib.request, ssl）编写，弃用了requests和rich等第三方库。这种做法在安全研究中通常是为了降低恶意后门隐藏在第三方依赖包中的可能性。代码逻辑清晰透明，未发现加密混淆、Base64编码的隐藏指令或向非目标IP发送敏感信息的行为。唯一的风险点在于其禁用了SSL证书验证（ssl._create_unverified_context），虽然这是为了提高对自签名证书目标的兼容性，但在极端情况下可能导致中间人攻击。总体而言，该代码具有良好的可读性和审计友好性，不符合投毒代码的典型特征，但在生产环境执行前仍建议在隔离的沙箱中复核。该脚本明确标注了教育用途，不包含任何自动传播或破坏性载荷。

**项目地址:** [https://github.com/Chocapikk/CVE-2023-5360](https://github.com/Chocapikk/CVE-2023-5360)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2023-5360](https://nvd.nist.gov/vuln/detail/CVE-2023-5360)
