## CVE-2023-27372 - SPIP RCE (远程代码执行)

**漏洞编号:** CVE-2023-27372

**漏洞类型:** RCE (远程代码执行)

**影响应用:** SPIP

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** SPIP < 3.2.18, 4.0 < 4.0.10, 4.1 < 4.1.8, 4.2 < 4.2.1

**利用条件:** 无需身份验证，可直接通过网络访问公共区域表单。

**POC 可用性:** 8/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：该漏洞源于SPIP对表单序列化数据处理不当，允许未经身份验证的远程攻击者在目标服务器上执行任意代码。提供的Python脚本逻辑非常清晰且直接：首先通过GET请求获取目标页面 `spip.php?page=spip_pass` 的 `formulaire_action_args` 隐藏字段值，这是SPIP用于验证表单状态的必要参数。接着，脚本构造了一个特制的POST请求，通过将恶意PHP代码包裹在 `oubli` 参数中（使用PHP序列化格式 `s:19:"<?php phpinfo(); ?>";`），迫使后端在反序列化或处理该参数时解析执行PHP代码。脚本通过检查响应中是否包含 `phpinfo()` 的输出来验证漏洞是否存在。这种利用方式高度符合公开披露的漏洞原理，具有极高的实战验证价值。利用步骤：1. 攻击者访问受影响站点的找回密码页面。2. 获取合法的 `formulaire_action_args` 参数。3. 发送包含注入代码的POST请求至 `oubli` 变量。4. 服务器解析该变量导致代码执行。 投毒风险分析：该POC代码具有较低的投毒风险。代码使用了Python标准库 `requests`、`argparse` 和 `BeautifulSoup`，没有引入闭源二进制文件或可疑的第三方库。在对代码进行静态分析时，未发现任何尝试窃取本地敏感信息（如环境变量、SSH密钥、浏览器Cookie）的行为。代码中不包含反向Shell、隐藏的下载器或经过混淆的Base64载荷。唯一的‘恶意’载荷是 `phpinfo()`，这在漏洞研究中是标准的无害检测证明。代码逻辑透明，仅针对目标URL发起通信，没有发现多余的非目标流量请求，也没有检测到代码自毁或持久化驻留逻辑。对于防御性安全研究员来说，在隔离环境下运行该脚本进行资产扫描是相对安全的，但仍建议在使用前核对 `requests` 库的安装源，确保环境纯净。

**项目地址:** [https://github.com/nuts7/CVE-2023-27372](https://github.com/nuts7/CVE-2023-27372)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)
