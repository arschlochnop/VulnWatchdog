## CVE-2023-27372 - SPIP RCE (远程代码执行)

**漏洞编号:** CVE-2023-27372

**漏洞类型:** RCE (远程代码执行)

**影响应用:** SPIP

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** SPIP < 3.2.18, < 4.0.10, < 4.1.13, < 4.2.1

**利用条件:** 无需认证，可通过公网直接访问目标受影响的参数字段进行攻击。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

【POC有效性分析】该漏洞源于SPIP在处理公共区域表单值（具体为oubli参数）时，由于反序列化处理不当，导致攻击者可以绕过过滤执行任意代码。分析提供的spip.py脚本，代码逻辑清晰且目标明确。脚本首先利用BeautifulSoup库解析目标页面的formhash，这是SPIP表单提交的安全令牌。获取令牌后，它构造一个包含恶意payload的POST请求，通过oubli参数注入PHP代码。脚本支持批量检测（从文件读取URL）并能够将成功结果保存到Results目录。代码中使用了标准的requests库进行HTTP通信，逻辑符合已知CVE-2023-27372的利用链，是一个功能完整的自动化利用工具，具备极高的实战有效性。利用步骤如下：1. 准备目标列表文件；2. 安装requirements.txt中的依赖；3. 运行spip.py脚本；4. 脚本将自动检索formhash并发送注入Payload；5. 成功后可在Results文件夹中查看受灾目标。该POC不仅能验证漏洞存在，还能通过构造特定的PHP函数实现命令执行。 【投毒风险分析】经过对POC源码的审计，该工具的投毒风险极低（约10%）。代码主体结构透明，导入的库均为标准安全研究常用库，如argparse、bs4、requests和colorama。虽然代码片段中包含了一些自定义的Banner展示和界面清理指令（os.system('clear')），但这属于常见的POC美化行为。脚本中没有发现Base64加密的混淆Payload，也没有发现会将攻击者机器的敏感信息（如SSH密钥、环境变量）外传到第三方域名的恶意Socket连接。主要的Payload部分针对的是受害者服务器而非运行脚本的分析人员。需要注意的风险点在于，部分POC作者可能会在requirements.txt中引用拼写错误的恶意包（Typosquatting），但本例中的依赖项均指向合法官方库。此外，脚本声明用于教育目的，未发现隐蔽的反向Shell或本地文件删除指令。建议在隔离的沙箱环境中使用此类脚本，以防其在后续更新或未审计的分支中引入恶意后门。总体而言，该代码是一个典型的安全研究脚本，侧重于漏洞复现，而非针对使用者的钓鱼或投毒攻击。

**项目地址:** [https://github.com/Pari-Malam/CVE-2023-27372](https://github.com/Pari-Malam/CVE-2023-27372)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)
