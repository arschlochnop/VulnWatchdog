## CVE-2023-27372 - SPIP CMS RCE (远程代码执行)

**漏洞编号:** CVE-2023-27372

**漏洞类型:** RCE (远程代码执行)

**影响应用:** SPIP CMS

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** SPIP < 4.2.1, 包括 3.2.17 及更早版本

**利用条件:** 无需认证，可通过公共区域的表单值（spip.php?page=spip_pass）进行攻击

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

【POC有效性分析】：此POC具有极高的有效性和工程化程度。它不仅提供了基于Python的漏洞扫描工具（scanner.py），还包含了一个完整的Docker化测试环境（SPIP + MariaDB）。该漏洞的根源在于SPIP在处理密码重置请求（spip.php?page=spip_pass）时，对序列化数据的处理不当，导致PHP代码注入。通过构造恶意的序列化字符串发送至服务器，攻击者可以绕过过滤并执行任意PHP指令。POC中通过执行安全的'ls'或'touch /tmp/pwned.txt'命令来验证漏洞，这种非破坏性的探测方式证明了漏洞的可利用性。代码逻辑清晰，依赖关系通过pyproject.toml管理，且支持容器化部署，极大地降低了环境搭建的门槛。漏洞利用步骤如下：1. 启动Docker实验环境，确保SPIP服务在8080端口运行。2. 使用提供的Python脚本或Docker容器化扫描器，指定目标URL。3. 脚本向`spip.php?page=spip_pass`发送包含恶意序列化载荷的POST请求。4. 通过在目标容器内部检查`/tmp/pwned.txt`文件是否存在来确认RCE是否成功。整个过程无需任何账户凭据，属于典型的预身份验证RCE，危害极大。【投毒风险分析】：该POC项目的投毒风险极低，约为10%。主要原因如下：首先，代码完全开源且结构透明，核心逻辑位于`scanner.py`中，使用的是标准的Python库，未发现经过混淆的Base64字符、eval函数滥用或异常的网络外连行为。其次，该仓库是一个专门用于防御性研究的实验室项目（vulnwatchdog系列），其目的是帮助研究人员理解漏洞机制，而非恶意传播。仓库中包含的Dockerfile和配置文件均为标准配置，未发现针对宿主机的提权脚本或敏感文件窃取逻辑。唯一需要注意的风险点是，任何运行未经审核的第三方代码都存在潜在风险，尤其是当用户在未隔离的环境中执行构建镜像命令时，若依赖镜像源被篡改可能导致间接风险。但就代码层面而言，该POC是纯粹的验证工具，不存在针对安全研究人员的定向投毒特征，属于安全可信的范畴。

**项目地址:** [https://github.com/0SPwn/CVE-2023-27372-PoC](https://github.com/0SPwn/CVE-2023-27372-PoC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)
