# CVE-2023-2598

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-2598-LLfam_CVE-2023-2598.md](../2023/CVE-2023-2598-LLfam_CVE-2023-2598.md)

# CVE-2023-2598

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-2598-LLfam_CVE-2023-2598.md](../2023/CVE-2023-2598-LLfam_CVE-2023-2598.md)

# CVE-2023-2598

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-2598-LLfam_CVE-2023-2598.md](../2023/CVE-2023-2598-LLfam_CVE-2023-2598.md)

# CVE-2023-2598

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-2598-LLfam_CVE-2023-2598.md](../2023/CVE-2023-2598-LLfam_CVE-2023-2598.md)

# CVE-2023-2598

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-2598-LLfam_CVE-2023-2598.md](../2023/CVE-2023-2598-LLfam_CVE-2023-2598.md)

# CVE-2023-2598

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-2598-LLfam_CVE-2023-2598.md](../2023/CVE-2023-2598-LLfam_CVE-2023-2598.md)

# CVE-2023-2598

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-2598-SpongeBob-369_CVE-2023-2598.md](../2023/CVE-2023-2598-SpongeBob-369_CVE-2023-2598.md)

## CVE-2023-2598 - Linux Kernel io_uring 本地提权漏洞

**漏洞编号:** CVE-2023-2598

**漏洞类型:** 内存越界写入/本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Kernel prior to 6.4-rc1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-2598是Linux内核io_uring子系统中的一个漏洞，位于`io_sqe_buffer_register`函数中。该函数在处理固定缓冲区注册时存在缺陷，允许越界访问物理内存，从而导致本地权限提升。

**有效性：**
根据提供的漏洞信息和搜索引擎结果，此漏洞存在PoC利用代码（例如：[https://github.com/ysanatomic/io_uring_LPE-CVE-2023-2598](https://github.com/ysanatomic/io_uring_LPE-CVE-2023-2598)），并且多个来源（NVD、Red Hat、Wiz、CVEdetails、SUSE）确认了该漏洞的存在，因此判断该漏洞的PoC代码有效。

**投毒风险：**
分析提供的部分PoC代码（`README.md`），其描述了漏洞原理，涉及`io_uring`的基本概念，包括提交队列(SQ)和完成队列(CQ)以及`io_sqe_buffer_register`函数的实现细节。该漏洞源于`io_sqe_buffer_register`函数中对物理内存页面的处理不当。具体来说，当应用程序使用`io_uring_register`注册缓冲区时，`io_sqe_buffer_register`函数负责将虚拟地址映射到物理地址。由于逻辑错误，可能导致在`bvec_set_page`处发生越界写入。

**投毒风险分析：**
提供的代码片段主要用于解释漏洞原理，并未发现明显的恶意代码。但是，完整的exploit代码可能包含执行任意代码的部分，具有潜在的投毒风险。考虑到github仓库`ysanatomic/io_uring_LPE-CVE-2023-2598`是公开的，且漏洞利用的复杂性，存在作者有意或无意引入恶意代码的可能。因此，认为存在10%的投毒风险（主要集中在完整的exploit中，而非提供的代码片段）。

**利用方式：**
1.  **漏洞触发：** 通过`io_uring_register`系统调用注册缓冲区。
2.  **越界写入：** 利用`io_sqe_buffer_register`函数中的缺陷，构造特定的`iovec`结构，使得在`bvec_set_page`时发生越界写入，覆盖相邻的内存区域。
3.  **权限提升：** 覆盖内核数据结构，劫持控制流，最终实现本地权限提升。

总而言之，CVE-2023-2598是一个高危漏洞，攻击者可以利用它来获得root权限。提供的PoC代码具有有效性，能够本地提权。但是，不能排除存在投毒代码的可能性，因此在使用前应仔细审查。

**项目地址:** [SpongeBob-369/CVE-2023-2598](https://github.com/SpongeBob-369/CVE-2023-2598)

**漏洞详情:** [CVE-2023-2598](https://nvd.nist.gov/vuln/detail/CVE-2023-2598)

---

## POC #2

**来源**: [CVE-2023-2598-cainiao159357_CVE-2023-2598.md](../2023/CVE-2023-2598-cainiao159357_CVE-2023-2598.md)

## CVE-2023-2598-Linux Kernel io_uring Out-of-Bounds Access

**漏洞编号:** CVE-2023-2598

**漏洞类型:** Out-of-Bounds Write/Read

**影响应用:** Linux Kernel

**危害等级:** 高危，本地权限提升

**影响版本:** Kernel prior to 6.4-rc1

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-2598 存在于 Linux Kernel 的 io_uring fixed buffer registration 代码 (io_sqe_buffer_register in io_uring/rsrc.c) 中。该漏洞允许越界访问物理内存，超出 buffer 范围。PoC 代码表明，该漏洞允许本地权限提升，无需特定地址依赖。

**有效性：**
提供的PoC代码通过修改uid来提权，说明该代码是有效的，因为它能够利用越界读写接口来修改用户ID，从而获得root权限。

**投毒风险：**
PoC 代码中主要的逻辑是利用漏洞进行提权，并没有发现明显的恶意代码。尽管如此，仍然存在一些潜在的风险：
*   **代码复杂性：** io_uring的利用本身就比较复杂，攻击者可能会在细节上做手脚，例如在错误处理流程中引入漏洞或者修改关键参数。
*   **安全假设：** 代码依赖于特定的内核配置或环境，如果环境不符合预期，可能会导致PoC失效甚至系统崩溃。
*   **Cred 喷射：** PoC使用了cred喷射技术，理论上存在污染其他进程cred的可能性，但可能性很低，而且也不是作者故意为之。

综合考虑，该PoC代码的投毒风险较低，但不能完全排除。评估的投毒风险为 10%。

**利用方式：**
1.  **漏洞触发：**
利用io_uring接口注册buffer，通过mmap将同一个物理页表映射到连续的虚拟地址上，绕过内核的检查。

2.  **越界读写：**
注册的buffer size大于实际分配的物理内存，导致可以越界读写。

3.  **提权：**
通过越界读写，修改当前进程的cred结构体中的uid为0，从而获得root权限。

4.  **执行shell：**
利用execve执行/bin/sh，获得root shell。

**项目地址:** [cainiao159357/CVE-2023-2598](https://github.com/cainiao159357/CVE-2023-2598)

**漏洞详情:** [CVE-2023-2598](https://nvd.nist.gov/vuln/detail/CVE-2023-2598)

---

## POC #3

**来源**: [CVE-2023-2598-guard-wait_CVE-2023-2598_EXP.md](../2023/CVE-2023-2598-guard-wait_CVE-2023-2598_EXP.md)

## CVE-2023-2598-Linux Kernel-io_uring 权限提升

**漏洞编号:** CVE-2023-2598

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Kernel prior to 6.4-rc1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞库信息，CVE-2023-2598是Linux内核io_uring子系统中的一个漏洞，具体位于io_sqe_buffer_register函数中。该漏洞允许越界访问物理内存，导致本地权限提升。 

**有效性：** 根据CVE描述，该漏洞的利用可以导致本地权限提升，因此利用代码有效。需要注意的是，kernel的exp编写和调试有一定难度。

**投毒风险：** 提供的代码片段仅为GNU GPL许可证，并非漏洞利用代码。因此无法直接分析该仓库中是否存在投毒代码。但考虑到GPL协议的特性，恶意投毒的可能性较低。但依然不能排除仓库中其他文件存在恶意代码的可能性，评估投毒风险为 5% (主要考虑同仓库下存在其他恶意文件的可能性，而非GPL许可证本身）。

**利用方式：** 漏洞的利用方式是利用io_uring的固定缓冲区注册代码中的缺陷，在注册缓冲区时越界访问物理内存。攻击者可以通过精心构造io_uring请求，触发越界访问，从而改写内核内存，最终实现权限提升。利用通常涉及以下步骤：

1.  **触发漏洞：** 通过特定的io_uring操作（如注册固定缓冲区）触发io_sqe_buffer_register函数中的漏洞。
2.  **越界访问：** 利用漏洞实现对物理内存的越界读写。
3.  **权限提升：** 通过改写内核数据结构（如进程的cred结构体）来提升当前用户的权限。

**项目地址:** [guard-wait/CVE-2023-2598_EXP](https://github.com/guard-wait/CVE-2023-2598_EXP)

**漏洞详情:** [CVE-2023-2598](https://nvd.nist.gov/vuln/detail/CVE-2023-2598)

---

## POC #4

**来源**: [CVE-2023-2598-ysanatomic_io_uring_LPE-CVE-2023-2598.md](../2023/CVE-2023-2598-ysanatomic_io_uring_LPE-CVE-2023-2598.md)

## CVE-2023-2598-Linux内核io_uring本地提权

**漏洞编号:** CVE-2023-2598

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可以提升到root权限

**影响版本:** Kernel prior to 6.4-rc1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-2598 存在于Linux内核的io_uring子系统中，`io_sqe_buffer_register` 函数中存在一个缺陷，允许越界访问物理内存。这个缺陷发生在固定缓冲区注册过程中。攻击者可以利用此漏洞实现本地权限提升。

**有效性：**
根据提供的漏洞库信息、搜索结果和漏洞利用代码，该漏洞的POC是有效的。搜索结果中直接包含指向GitHub上POC代码的链接 (ysanatomic/io_uring_LPE-CVE-2023-2598)。漏洞库信息也表明这是一个可利用的漏洞。

**投毒风险：**
分析提供的POC代码，投毒风险较低。主要风险点在于：
*   `exploit.c`： 这是一个相对完整的提权利用代码，主要通过 io_uring 机制进行内存操作。其中包含设置CPU亲和性、初始化io_uring、创建sockets、创建memfds等操作，最终目的是利用越界访问漏洞读取内核内存，并修改内核结构，实现提权。虽然代码逻辑较为复杂，但主要集中在漏洞利用本身，没有明显的后门或恶意代码。
考虑到作者已经公开了漏洞分析和利用代码，潜在的投毒行为会增加被发现的概率，因此判断存在轻微的投毒风险，主要是为了防止被检测。

**利用方式：**
1.  **漏洞触发：** 该漏洞利用`io_uring`子系统的固定缓冲区注册功能，通过`io_sqe_buffer_register`函数注册固定缓冲区时，存在越界访问漏洞。
2.  **内存布局：** 漏洞利用代码通过创建大量sockets和memfds来控制内核内存布局，为后续的利用创造条件。
3.  **信息泄露：** 利用越界访问漏洞，读取内核内存中的敏感信息，例如内核地址(`kaslr_base`)。
4.  **权限提升：** 通过修改内核结构体(如`cred`结构体)中的`uid`、`gid`等字段，将当前进程的权限提升到root权限。具体的利用手法涉及到 ROP (Return-Oriented Programming)，通过执行一系列预先构造好的指令序列来完成权限提升。
5.  **清理工作：** 清理现场，恢复被修改的内核状态，避免系统崩溃。

综上，此漏洞利用方式较为复杂，需要对`io_uring`子系统和内核内存管理有深入的理解。攻击者需要精心构造`io_uring`请求，控制内存布局，才能成功实现权限提升。

**项目地址:** [ysanatomic/io_uring_LPE-CVE-2023-2598](https://github.com/ysanatomic/io_uring_LPE-CVE-2023-2598)

**漏洞详情:** [CVE-2023-2598](https://nvd.nist.gov/vuln/detail/CVE-2023-2598)

---



---

## POC #2

**来源**: [CVE-2023-2598-SpongeBob-369_CVE-2023-2598.md](../2023/CVE-2023-2598-SpongeBob-369_CVE-2023-2598.md)

## CVE-2023-2598 - Linux Kernel io_uring 本地提权漏洞

**漏洞编号:** CVE-2023-2598

**漏洞类型:** 内存越界写入/本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Kernel prior to 6.4-rc1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-2598是Linux内核io_uring子系统中的一个漏洞，位于`io_sqe_buffer_register`函数中。该函数在处理固定缓冲区注册时存在缺陷，允许越界访问物理内存，从而导致本地权限提升。

**有效性：**
根据提供的漏洞信息和搜索引擎结果，此漏洞存在PoC利用代码（例如：[https://github.com/ysanatomic/io_uring_LPE-CVE-2023-2598](https://github.com/ysanatomic/io_uring_LPE-CVE-2023-2598)），并且多个来源（NVD、Red Hat、Wiz、CVEdetails、SUSE）确认了该漏洞的存在，因此判断该漏洞的PoC代码有效。

**投毒风险：**
分析提供的部分PoC代码（`README.md`），其描述了漏洞原理，涉及`io_uring`的基本概念，包括提交队列(SQ)和完成队列(CQ)以及`io_sqe_buffer_register`函数的实现细节。该漏洞源于`io_sqe_buffer_register`函数中对物理内存页面的处理不当。具体来说，当应用程序使用`io_uring_register`注册缓冲区时，`io_sqe_buffer_register`函数负责将虚拟地址映射到物理地址。由于逻辑错误，可能导致在`bvec_set_page`处发生越界写入。

**投毒风险分析：**
提供的代码片段主要用于解释漏洞原理，并未发现明显的恶意代码。但是，完整的exploit代码可能包含执行任意代码的部分，具有潜在的投毒风险。考虑到github仓库`ysanatomic/io_uring_LPE-CVE-2023-2598`是公开的，且漏洞利用的复杂性，存在作者有意或无意引入恶意代码的可能。因此，认为存在10%的投毒风险（主要集中在完整的exploit中，而非提供的代码片段）。

**利用方式：**
1.  **漏洞触发：** 通过`io_uring_register`系统调用注册缓冲区。
2.  **越界写入：** 利用`io_sqe_buffer_register`函数中的缺陷，构造特定的`iovec`结构，使得在`bvec_set_page`时发生越界写入，覆盖相邻的内存区域。
3.  **权限提升：** 覆盖内核数据结构，劫持控制流，最终实现本地权限提升。

总而言之，CVE-2023-2598是一个高危漏洞，攻击者可以利用它来获得root权限。提供的PoC代码具有有效性，能够本地提权。但是，不能排除存在投毒代码的可能性，因此在使用前应仔细审查。

**项目地址:** [SpongeBob-369/CVE-2023-2598](https://github.com/SpongeBob-369/CVE-2023-2598)

**漏洞详情:** [CVE-2023-2598](https://nvd.nist.gov/vuln/detail/CVE-2023-2598)

---

## POC #3

**来源**: [CVE-2023-2598-cainiao159357_CVE-2023-2598.md](../2023/CVE-2023-2598-cainiao159357_CVE-2023-2598.md)

## CVE-2023-2598-Linux Kernel io_uring Out-of-Bounds Access

**漏洞编号:** CVE-2023-2598

**漏洞类型:** Out-of-Bounds Write/Read

**影响应用:** Linux Kernel

**危害等级:** 高危，本地权限提升

**影响版本:** Kernel prior to 6.4-rc1

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-2598 存在于 Linux Kernel 的 io_uring fixed buffer registration 代码 (io_sqe_buffer_register in io_uring/rsrc.c) 中。该漏洞允许越界访问物理内存，超出 buffer 范围。PoC 代码表明，该漏洞允许本地权限提升，无需特定地址依赖。

**有效性：**
提供的PoC代码通过修改uid来提权，说明该代码是有效的，因为它能够利用越界读写接口来修改用户ID，从而获得root权限。

**投毒风险：**
PoC 代码中主要的逻辑是利用漏洞进行提权，并没有发现明显的恶意代码。尽管如此，仍然存在一些潜在的风险：
*   **代码复杂性：** io_uring的利用本身就比较复杂，攻击者可能会在细节上做手脚，例如在错误处理流程中引入漏洞或者修改关键参数。
*   **安全假设：** 代码依赖于特定的内核配置或环境，如果环境不符合预期，可能会导致PoC失效甚至系统崩溃。
*   **Cred 喷射：** PoC使用了cred喷射技术，理论上存在污染其他进程cred的可能性，但可能性很低，而且也不是作者故意为之。

综合考虑，该PoC代码的投毒风险较低，但不能完全排除。评估的投毒风险为 10%。

**利用方式：**
1.  **漏洞触发：**
利用io_uring接口注册buffer，通过mmap将同一个物理页表映射到连续的虚拟地址上，绕过内核的检查。

2.  **越界读写：**
注册的buffer size大于实际分配的物理内存，导致可以越界读写。

3.  **提权：**
通过越界读写，修改当前进程的cred结构体中的uid为0，从而获得root权限。

4.  **执行shell：**
利用execve执行/bin/sh，获得root shell。

**项目地址:** [cainiao159357/CVE-2023-2598](https://github.com/cainiao159357/CVE-2023-2598)

**漏洞详情:** [CVE-2023-2598](https://nvd.nist.gov/vuln/detail/CVE-2023-2598)

---

## POC #4

**来源**: [CVE-2023-2598-guard-wait_CVE-2023-2598_EXP.md](../2023/CVE-2023-2598-guard-wait_CVE-2023-2598_EXP.md)

## CVE-2023-2598-Linux Kernel-io_uring 权限提升

**漏洞编号:** CVE-2023-2598

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Kernel prior to 6.4-rc1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞库信息，CVE-2023-2598是Linux内核io_uring子系统中的一个漏洞，具体位于io_sqe_buffer_register函数中。该漏洞允许越界访问物理内存，导致本地权限提升。 

**有效性：** 根据CVE描述，该漏洞的利用可以导致本地权限提升，因此利用代码有效。需要注意的是，kernel的exp编写和调试有一定难度。

**投毒风险：** 提供的代码片段仅为GNU GPL许可证，并非漏洞利用代码。因此无法直接分析该仓库中是否存在投毒代码。但考虑到GPL协议的特性，恶意投毒的可能性较低。但依然不能排除仓库中其他文件存在恶意代码的可能性，评估投毒风险为 5% (主要考虑同仓库下存在其他恶意文件的可能性，而非GPL许可证本身）。

**利用方式：** 漏洞的利用方式是利用io_uring的固定缓冲区注册代码中的缺陷，在注册缓冲区时越界访问物理内存。攻击者可以通过精心构造io_uring请求，触发越界访问，从而改写内核内存，最终实现权限提升。利用通常涉及以下步骤：

1.  **触发漏洞：** 通过特定的io_uring操作（如注册固定缓冲区）触发io_sqe_buffer_register函数中的漏洞。
2.  **越界访问：** 利用漏洞实现对物理内存的越界读写。
3.  **权限提升：** 通过改写内核数据结构（如进程的cred结构体）来提升当前用户的权限。

**项目地址:** [guard-wait/CVE-2023-2598_EXP](https://github.com/guard-wait/CVE-2023-2598_EXP)

**漏洞详情:** [CVE-2023-2598](https://nvd.nist.gov/vuln/detail/CVE-2023-2598)

---

## POC #5

**来源**: [CVE-2023-2598-ysanatomic_io_uring_LPE-CVE-2023-2598.md](../2023/CVE-2023-2598-ysanatomic_io_uring_LPE-CVE-2023-2598.md)

## CVE-2023-2598-Linux内核io_uring本地提权

**漏洞编号:** CVE-2023-2598

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可以提升到root权限

**影响版本:** Kernel prior to 6.4-rc1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-2598 存在于Linux内核的io_uring子系统中，`io_sqe_buffer_register` 函数中存在一个缺陷，允许越界访问物理内存。这个缺陷发生在固定缓冲区注册过程中。攻击者可以利用此漏洞实现本地权限提升。

**有效性：**
根据提供的漏洞库信息、搜索结果和漏洞利用代码，该漏洞的POC是有效的。搜索结果中直接包含指向GitHub上POC代码的链接 (ysanatomic/io_uring_LPE-CVE-2023-2598)。漏洞库信息也表明这是一个可利用的漏洞。

**投毒风险：**
分析提供的POC代码，投毒风险较低。主要风险点在于：
*   `exploit.c`： 这是一个相对完整的提权利用代码，主要通过 io_uring 机制进行内存操作。其中包含设置CPU亲和性、初始化io_uring、创建sockets、创建memfds等操作，最终目的是利用越界访问漏洞读取内核内存，并修改内核结构，实现提权。虽然代码逻辑较为复杂，但主要集中在漏洞利用本身，没有明显的后门或恶意代码。
考虑到作者已经公开了漏洞分析和利用代码，潜在的投毒行为会增加被发现的概率，因此判断存在轻微的投毒风险，主要是为了防止被检测。

**利用方式：**
1.  **漏洞触发：** 该漏洞利用`io_uring`子系统的固定缓冲区注册功能，通过`io_sqe_buffer_register`函数注册固定缓冲区时，存在越界访问漏洞。
2.  **内存布局：** 漏洞利用代码通过创建大量sockets和memfds来控制内核内存布局，为后续的利用创造条件。
3.  **信息泄露：** 利用越界访问漏洞，读取内核内存中的敏感信息，例如内核地址(`kaslr_base`)。
4.  **权限提升：** 通过修改内核结构体(如`cred`结构体)中的`uid`、`gid`等字段，将当前进程的权限提升到root权限。具体的利用手法涉及到 ROP (Return-Oriented Programming)，通过执行一系列预先构造好的指令序列来完成权限提升。
5.  **清理工作：** 清理现场，恢复被修改的内核状态，避免系统崩溃。

综上，此漏洞利用方式较为复杂，需要对`io_uring`子系统和内核内存管理有深入的理解。攻击者需要精心构造`io_uring`请求，控制内存布局，才能成功实现权限提升。

**项目地址:** [ysanatomic/io_uring_LPE-CVE-2023-2598](https://github.com/ysanatomic/io_uring_LPE-CVE-2023-2598)

**漏洞详情:** [CVE-2023-2598](https://nvd.nist.gov/vuln/detail/CVE-2023-2598)

---



---

## POC #2

**来源**: [CVE-2023-2598-SpongeBob-369_CVE-2023-2598.md](../2023/CVE-2023-2598-SpongeBob-369_CVE-2023-2598.md)

## CVE-2023-2598 - Linux Kernel io_uring 本地提权漏洞

**漏洞编号:** CVE-2023-2598

**漏洞类型:** 内存越界写入/本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Kernel prior to 6.4-rc1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-2598是Linux内核io_uring子系统中的一个漏洞，位于`io_sqe_buffer_register`函数中。该函数在处理固定缓冲区注册时存在缺陷，允许越界访问物理内存，从而导致本地权限提升。

**有效性：**
根据提供的漏洞信息和搜索引擎结果，此漏洞存在PoC利用代码（例如：[https://github.com/ysanatomic/io_uring_LPE-CVE-2023-2598](https://github.com/ysanatomic/io_uring_LPE-CVE-2023-2598)），并且多个来源（NVD、Red Hat、Wiz、CVEdetails、SUSE）确认了该漏洞的存在，因此判断该漏洞的PoC代码有效。

**投毒风险：**
分析提供的部分PoC代码（`README.md`），其描述了漏洞原理，涉及`io_uring`的基本概念，包括提交队列(SQ)和完成队列(CQ)以及`io_sqe_buffer_register`函数的实现细节。该漏洞源于`io_sqe_buffer_register`函数中对物理内存页面的处理不当。具体来说，当应用程序使用`io_uring_register`注册缓冲区时，`io_sqe_buffer_register`函数负责将虚拟地址映射到物理地址。由于逻辑错误，可能导致在`bvec_set_page`处发生越界写入。

**投毒风险分析：**
提供的代码片段主要用于解释漏洞原理，并未发现明显的恶意代码。但是，完整的exploit代码可能包含执行任意代码的部分，具有潜在的投毒风险。考虑到github仓库`ysanatomic/io_uring_LPE-CVE-2023-2598`是公开的，且漏洞利用的复杂性，存在作者有意或无意引入恶意代码的可能。因此，认为存在10%的投毒风险（主要集中在完整的exploit中，而非提供的代码片段）。

**利用方式：**
1.  **漏洞触发：** 通过`io_uring_register`系统调用注册缓冲区。
2.  **越界写入：** 利用`io_sqe_buffer_register`函数中的缺陷，构造特定的`iovec`结构，使得在`bvec_set_page`时发生越界写入，覆盖相邻的内存区域。
3.  **权限提升：** 覆盖内核数据结构，劫持控制流，最终实现本地权限提升。

总而言之，CVE-2023-2598是一个高危漏洞，攻击者可以利用它来获得root权限。提供的PoC代码具有有效性，能够本地提权。但是，不能排除存在投毒代码的可能性，因此在使用前应仔细审查。

**项目地址:** [SpongeBob-369/CVE-2023-2598](https://github.com/SpongeBob-369/CVE-2023-2598)

**漏洞详情:** [CVE-2023-2598](https://nvd.nist.gov/vuln/detail/CVE-2023-2598)

---

## POC #3

**来源**: [CVE-2023-2598-cainiao159357_CVE-2023-2598.md](../2023/CVE-2023-2598-cainiao159357_CVE-2023-2598.md)

## CVE-2023-2598-Linux Kernel io_uring Out-of-Bounds Access

**漏洞编号:** CVE-2023-2598

**漏洞类型:** Out-of-Bounds Write/Read

**影响应用:** Linux Kernel

**危害等级:** 高危，本地权限提升

**影响版本:** Kernel prior to 6.4-rc1

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-2598 存在于 Linux Kernel 的 io_uring fixed buffer registration 代码 (io_sqe_buffer_register in io_uring/rsrc.c) 中。该漏洞允许越界访问物理内存，超出 buffer 范围。PoC 代码表明，该漏洞允许本地权限提升，无需特定地址依赖。

**有效性：**
提供的PoC代码通过修改uid来提权，说明该代码是有效的，因为它能够利用越界读写接口来修改用户ID，从而获得root权限。

**投毒风险：**
PoC 代码中主要的逻辑是利用漏洞进行提权，并没有发现明显的恶意代码。尽管如此，仍然存在一些潜在的风险：
*   **代码复杂性：** io_uring的利用本身就比较复杂，攻击者可能会在细节上做手脚，例如在错误处理流程中引入漏洞或者修改关键参数。
*   **安全假设：** 代码依赖于特定的内核配置或环境，如果环境不符合预期，可能会导致PoC失效甚至系统崩溃。
*   **Cred 喷射：** PoC使用了cred喷射技术，理论上存在污染其他进程cred的可能性，但可能性很低，而且也不是作者故意为之。

综合考虑，该PoC代码的投毒风险较低，但不能完全排除。评估的投毒风险为 10%。

**利用方式：**
1.  **漏洞触发：**
利用io_uring接口注册buffer，通过mmap将同一个物理页表映射到连续的虚拟地址上，绕过内核的检查。

2.  **越界读写：**
注册的buffer size大于实际分配的物理内存，导致可以越界读写。

3.  **提权：**
通过越界读写，修改当前进程的cred结构体中的uid为0，从而获得root权限。

4.  **执行shell：**
利用execve执行/bin/sh，获得root shell。

**项目地址:** [cainiao159357/CVE-2023-2598](https://github.com/cainiao159357/CVE-2023-2598)

**漏洞详情:** [CVE-2023-2598](https://nvd.nist.gov/vuln/detail/CVE-2023-2598)

---

## POC #4

**来源**: [CVE-2023-2598-guard-wait_CVE-2023-2598_EXP.md](../2023/CVE-2023-2598-guard-wait_CVE-2023-2598_EXP.md)

## CVE-2023-2598-Linux Kernel-io_uring 权限提升

**漏洞编号:** CVE-2023-2598

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Kernel prior to 6.4-rc1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞库信息，CVE-2023-2598是Linux内核io_uring子系统中的一个漏洞，具体位于io_sqe_buffer_register函数中。该漏洞允许越界访问物理内存，导致本地权限提升。 

**有效性：** 根据CVE描述，该漏洞的利用可以导致本地权限提升，因此利用代码有效。需要注意的是，kernel的exp编写和调试有一定难度。

**投毒风险：** 提供的代码片段仅为GNU GPL许可证，并非漏洞利用代码。因此无法直接分析该仓库中是否存在投毒代码。但考虑到GPL协议的特性，恶意投毒的可能性较低。但依然不能排除仓库中其他文件存在恶意代码的可能性，评估投毒风险为 5% (主要考虑同仓库下存在其他恶意文件的可能性，而非GPL许可证本身）。

**利用方式：** 漏洞的利用方式是利用io_uring的固定缓冲区注册代码中的缺陷，在注册缓冲区时越界访问物理内存。攻击者可以通过精心构造io_uring请求，触发越界访问，从而改写内核内存，最终实现权限提升。利用通常涉及以下步骤：

1.  **触发漏洞：** 通过特定的io_uring操作（如注册固定缓冲区）触发io_sqe_buffer_register函数中的漏洞。
2.  **越界访问：** 利用漏洞实现对物理内存的越界读写。
3.  **权限提升：** 通过改写内核数据结构（如进程的cred结构体）来提升当前用户的权限。

**项目地址:** [guard-wait/CVE-2023-2598_EXP](https://github.com/guard-wait/CVE-2023-2598_EXP)

**漏洞详情:** [CVE-2023-2598](https://nvd.nist.gov/vuln/detail/CVE-2023-2598)

---

## POC #5

**来源**: [CVE-2023-2598-ysanatomic_io_uring_LPE-CVE-2023-2598.md](../2023/CVE-2023-2598-ysanatomic_io_uring_LPE-CVE-2023-2598.md)

## CVE-2023-2598-Linux内核io_uring本地提权

**漏洞编号:** CVE-2023-2598

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可以提升到root权限

**影响版本:** Kernel prior to 6.4-rc1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-2598 存在于Linux内核的io_uring子系统中，`io_sqe_buffer_register` 函数中存在一个缺陷，允许越界访问物理内存。这个缺陷发生在固定缓冲区注册过程中。攻击者可以利用此漏洞实现本地权限提升。

**有效性：**
根据提供的漏洞库信息、搜索结果和漏洞利用代码，该漏洞的POC是有效的。搜索结果中直接包含指向GitHub上POC代码的链接 (ysanatomic/io_uring_LPE-CVE-2023-2598)。漏洞库信息也表明这是一个可利用的漏洞。

**投毒风险：**
分析提供的POC代码，投毒风险较低。主要风险点在于：
*   `exploit.c`： 这是一个相对完整的提权利用代码，主要通过 io_uring 机制进行内存操作。其中包含设置CPU亲和性、初始化io_uring、创建sockets、创建memfds等操作，最终目的是利用越界访问漏洞读取内核内存，并修改内核结构，实现提权。虽然代码逻辑较为复杂，但主要集中在漏洞利用本身，没有明显的后门或恶意代码。
考虑到作者已经公开了漏洞分析和利用代码，潜在的投毒行为会增加被发现的概率，因此判断存在轻微的投毒风险，主要是为了防止被检测。

**利用方式：**
1.  **漏洞触发：** 该漏洞利用`io_uring`子系统的固定缓冲区注册功能，通过`io_sqe_buffer_register`函数注册固定缓冲区时，存在越界访问漏洞。
2.  **内存布局：** 漏洞利用代码通过创建大量sockets和memfds来控制内核内存布局，为后续的利用创造条件。
3.  **信息泄露：** 利用越界访问漏洞，读取内核内存中的敏感信息，例如内核地址(`kaslr_base`)。
4.  **权限提升：** 通过修改内核结构体(如`cred`结构体)中的`uid`、`gid`等字段，将当前进程的权限提升到root权限。具体的利用手法涉及到 ROP (Return-Oriented Programming)，通过执行一系列预先构造好的指令序列来完成权限提升。
5.  **清理工作：** 清理现场，恢复被修改的内核状态，避免系统崩溃。

综上，此漏洞利用方式较为复杂，需要对`io_uring`子系统和内核内存管理有深入的理解。攻击者需要精心构造`io_uring`请求，控制内存布局，才能成功实现权限提升。

**项目地址:** [ysanatomic/io_uring_LPE-CVE-2023-2598](https://github.com/ysanatomic/io_uring_LPE-CVE-2023-2598)

**漏洞详情:** [CVE-2023-2598](https://nvd.nist.gov/vuln/detail/CVE-2023-2598)

---



---

## POC #2

**来源**: [CVE-2023-2598-SpongeBob-369_CVE-2023-2598.md](../2023/CVE-2023-2598-SpongeBob-369_CVE-2023-2598.md)

## CVE-2023-2598 - Linux Kernel io_uring 本地提权漏洞

**漏洞编号:** CVE-2023-2598

**漏洞类型:** 内存越界写入/本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Kernel prior to 6.4-rc1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-2598是Linux内核io_uring子系统中的一个漏洞，位于`io_sqe_buffer_register`函数中。该函数在处理固定缓冲区注册时存在缺陷，允许越界访问物理内存，从而导致本地权限提升。

**有效性：**
根据提供的漏洞信息和搜索引擎结果，此漏洞存在PoC利用代码（例如：[https://github.com/ysanatomic/io_uring_LPE-CVE-2023-2598](https://github.com/ysanatomic/io_uring_LPE-CVE-2023-2598)），并且多个来源（NVD、Red Hat、Wiz、CVEdetails、SUSE）确认了该漏洞的存在，因此判断该漏洞的PoC代码有效。

**投毒风险：**
分析提供的部分PoC代码（`README.md`），其描述了漏洞原理，涉及`io_uring`的基本概念，包括提交队列(SQ)和完成队列(CQ)以及`io_sqe_buffer_register`函数的实现细节。该漏洞源于`io_sqe_buffer_register`函数中对物理内存页面的处理不当。具体来说，当应用程序使用`io_uring_register`注册缓冲区时，`io_sqe_buffer_register`函数负责将虚拟地址映射到物理地址。由于逻辑错误，可能导致在`bvec_set_page`处发生越界写入。

**投毒风险分析：**
提供的代码片段主要用于解释漏洞原理，并未发现明显的恶意代码。但是，完整的exploit代码可能包含执行任意代码的部分，具有潜在的投毒风险。考虑到github仓库`ysanatomic/io_uring_LPE-CVE-2023-2598`是公开的，且漏洞利用的复杂性，存在作者有意或无意引入恶意代码的可能。因此，认为存在10%的投毒风险（主要集中在完整的exploit中，而非提供的代码片段）。

**利用方式：**
1.  **漏洞触发：** 通过`io_uring_register`系统调用注册缓冲区。
2.  **越界写入：** 利用`io_sqe_buffer_register`函数中的缺陷，构造特定的`iovec`结构，使得在`bvec_set_page`时发生越界写入，覆盖相邻的内存区域。
3.  **权限提升：** 覆盖内核数据结构，劫持控制流，最终实现本地权限提升。

总而言之，CVE-2023-2598是一个高危漏洞，攻击者可以利用它来获得root权限。提供的PoC代码具有有效性，能够本地提权。但是，不能排除存在投毒代码的可能性，因此在使用前应仔细审查。

**项目地址:** [SpongeBob-369/CVE-2023-2598](https://github.com/SpongeBob-369/CVE-2023-2598)

**漏洞详情:** [CVE-2023-2598](https://nvd.nist.gov/vuln/detail/CVE-2023-2598)

---

## POC #3

**来源**: [CVE-2023-2598-cainiao159357_CVE-2023-2598.md](../2023/CVE-2023-2598-cainiao159357_CVE-2023-2598.md)

## CVE-2023-2598-Linux Kernel io_uring Out-of-Bounds Access

**漏洞编号:** CVE-2023-2598

**漏洞类型:** Out-of-Bounds Write/Read

**影响应用:** Linux Kernel

**危害等级:** 高危，本地权限提升

**影响版本:** Kernel prior to 6.4-rc1

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-2598 存在于 Linux Kernel 的 io_uring fixed buffer registration 代码 (io_sqe_buffer_register in io_uring/rsrc.c) 中。该漏洞允许越界访问物理内存，超出 buffer 范围。PoC 代码表明，该漏洞允许本地权限提升，无需特定地址依赖。

**有效性：**
提供的PoC代码通过修改uid来提权，说明该代码是有效的，因为它能够利用越界读写接口来修改用户ID，从而获得root权限。

**投毒风险：**
PoC 代码中主要的逻辑是利用漏洞进行提权，并没有发现明显的恶意代码。尽管如此，仍然存在一些潜在的风险：
*   **代码复杂性：** io_uring的利用本身就比较复杂，攻击者可能会在细节上做手脚，例如在错误处理流程中引入漏洞或者修改关键参数。
*   **安全假设：** 代码依赖于特定的内核配置或环境，如果环境不符合预期，可能会导致PoC失效甚至系统崩溃。
*   **Cred 喷射：** PoC使用了cred喷射技术，理论上存在污染其他进程cred的可能性，但可能性很低，而且也不是作者故意为之。

综合考虑，该PoC代码的投毒风险较低，但不能完全排除。评估的投毒风险为 10%。

**利用方式：**
1.  **漏洞触发：**
利用io_uring接口注册buffer，通过mmap将同一个物理页表映射到连续的虚拟地址上，绕过内核的检查。

2.  **越界读写：**
注册的buffer size大于实际分配的物理内存，导致可以越界读写。

3.  **提权：**
通过越界读写，修改当前进程的cred结构体中的uid为0，从而获得root权限。

4.  **执行shell：**
利用execve执行/bin/sh，获得root shell。

**项目地址:** [cainiao159357/CVE-2023-2598](https://github.com/cainiao159357/CVE-2023-2598)

**漏洞详情:** [CVE-2023-2598](https://nvd.nist.gov/vuln/detail/CVE-2023-2598)

---

## POC #4

**来源**: [CVE-2023-2598-guard-wait_CVE-2023-2598_EXP.md](../2023/CVE-2023-2598-guard-wait_CVE-2023-2598_EXP.md)

## CVE-2023-2598-Linux Kernel-io_uring 权限提升

**漏洞编号:** CVE-2023-2598

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Kernel prior to 6.4-rc1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞库信息，CVE-2023-2598是Linux内核io_uring子系统中的一个漏洞，具体位于io_sqe_buffer_register函数中。该漏洞允许越界访问物理内存，导致本地权限提升。 

**有效性：** 根据CVE描述，该漏洞的利用可以导致本地权限提升，因此利用代码有效。需要注意的是，kernel的exp编写和调试有一定难度。

**投毒风险：** 提供的代码片段仅为GNU GPL许可证，并非漏洞利用代码。因此无法直接分析该仓库中是否存在投毒代码。但考虑到GPL协议的特性，恶意投毒的可能性较低。但依然不能排除仓库中其他文件存在恶意代码的可能性，评估投毒风险为 5% (主要考虑同仓库下存在其他恶意文件的可能性，而非GPL许可证本身）。

**利用方式：** 漏洞的利用方式是利用io_uring的固定缓冲区注册代码中的缺陷，在注册缓冲区时越界访问物理内存。攻击者可以通过精心构造io_uring请求，触发越界访问，从而改写内核内存，最终实现权限提升。利用通常涉及以下步骤：

1.  **触发漏洞：** 通过特定的io_uring操作（如注册固定缓冲区）触发io_sqe_buffer_register函数中的漏洞。
2.  **越界访问：** 利用漏洞实现对物理内存的越界读写。
3.  **权限提升：** 通过改写内核数据结构（如进程的cred结构体）来提升当前用户的权限。

**项目地址:** [guard-wait/CVE-2023-2598_EXP](https://github.com/guard-wait/CVE-2023-2598_EXP)

**漏洞详情:** [CVE-2023-2598](https://nvd.nist.gov/vuln/detail/CVE-2023-2598)

---

## POC #5

**来源**: [CVE-2023-2598-ysanatomic_io_uring_LPE-CVE-2023-2598.md](../2023/CVE-2023-2598-ysanatomic_io_uring_LPE-CVE-2023-2598.md)

## CVE-2023-2598-Linux内核io_uring本地提权

**漏洞编号:** CVE-2023-2598

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可以提升到root权限

**影响版本:** Kernel prior to 6.4-rc1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-2598 存在于Linux内核的io_uring子系统中，`io_sqe_buffer_register` 函数中存在一个缺陷，允许越界访问物理内存。这个缺陷发生在固定缓冲区注册过程中。攻击者可以利用此漏洞实现本地权限提升。

**有效性：**
根据提供的漏洞库信息、搜索结果和漏洞利用代码，该漏洞的POC是有效的。搜索结果中直接包含指向GitHub上POC代码的链接 (ysanatomic/io_uring_LPE-CVE-2023-2598)。漏洞库信息也表明这是一个可利用的漏洞。

**投毒风险：**
分析提供的POC代码，投毒风险较低。主要风险点在于：
*   `exploit.c`： 这是一个相对完整的提权利用代码，主要通过 io_uring 机制进行内存操作。其中包含设置CPU亲和性、初始化io_uring、创建sockets、创建memfds等操作，最终目的是利用越界访问漏洞读取内核内存，并修改内核结构，实现提权。虽然代码逻辑较为复杂，但主要集中在漏洞利用本身，没有明显的后门或恶意代码。
考虑到作者已经公开了漏洞分析和利用代码，潜在的投毒行为会增加被发现的概率，因此判断存在轻微的投毒风险，主要是为了防止被检测。

**利用方式：**
1.  **漏洞触发：** 该漏洞利用`io_uring`子系统的固定缓冲区注册功能，通过`io_sqe_buffer_register`函数注册固定缓冲区时，存在越界访问漏洞。
2.  **内存布局：** 漏洞利用代码通过创建大量sockets和memfds来控制内核内存布局，为后续的利用创造条件。
3.  **信息泄露：** 利用越界访问漏洞，读取内核内存中的敏感信息，例如内核地址(`kaslr_base`)。
4.  **权限提升：** 通过修改内核结构体(如`cred`结构体)中的`uid`、`gid`等字段，将当前进程的权限提升到root权限。具体的利用手法涉及到 ROP (Return-Oriented Programming)，通过执行一系列预先构造好的指令序列来完成权限提升。
5.  **清理工作：** 清理现场，恢复被修改的内核状态，避免系统崩溃。

综上，此漏洞利用方式较为复杂，需要对`io_uring`子系统和内核内存管理有深入的理解。攻击者需要精心构造`io_uring`请求，控制内存布局，才能成功实现权限提升。

**项目地址:** [ysanatomic/io_uring_LPE-CVE-2023-2598](https://github.com/ysanatomic/io_uring_LPE-CVE-2023-2598)

**漏洞详情:** [CVE-2023-2598](https://nvd.nist.gov/vuln/detail/CVE-2023-2598)

---



---

## POC #2

**来源**: [CVE-2023-2598-SpongeBob-369_CVE-2023-2598.md](../2023/CVE-2023-2598-SpongeBob-369_CVE-2023-2598.md)

## CVE-2023-2598 - Linux Kernel io_uring 本地提权漏洞

**漏洞编号:** CVE-2023-2598

**漏洞类型:** 内存越界写入/本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Kernel prior to 6.4-rc1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-2598是Linux内核io_uring子系统中的一个漏洞，位于`io_sqe_buffer_register`函数中。该函数在处理固定缓冲区注册时存在缺陷，允许越界访问物理内存，从而导致本地权限提升。

**有效性：**
根据提供的漏洞信息和搜索引擎结果，此漏洞存在PoC利用代码（例如：[https://github.com/ysanatomic/io_uring_LPE-CVE-2023-2598](https://github.com/ysanatomic/io_uring_LPE-CVE-2023-2598)），并且多个来源（NVD、Red Hat、Wiz、CVEdetails、SUSE）确认了该漏洞的存在，因此判断该漏洞的PoC代码有效。

**投毒风险：**
分析提供的部分PoC代码（`README.md`），其描述了漏洞原理，涉及`io_uring`的基本概念，包括提交队列(SQ)和完成队列(CQ)以及`io_sqe_buffer_register`函数的实现细节。该漏洞源于`io_sqe_buffer_register`函数中对物理内存页面的处理不当。具体来说，当应用程序使用`io_uring_register`注册缓冲区时，`io_sqe_buffer_register`函数负责将虚拟地址映射到物理地址。由于逻辑错误，可能导致在`bvec_set_page`处发生越界写入。

**投毒风险分析：**
提供的代码片段主要用于解释漏洞原理，并未发现明显的恶意代码。但是，完整的exploit代码可能包含执行任意代码的部分，具有潜在的投毒风险。考虑到github仓库`ysanatomic/io_uring_LPE-CVE-2023-2598`是公开的，且漏洞利用的复杂性，存在作者有意或无意引入恶意代码的可能。因此，认为存在10%的投毒风险（主要集中在完整的exploit中，而非提供的代码片段）。

**利用方式：**
1.  **漏洞触发：** 通过`io_uring_register`系统调用注册缓冲区。
2.  **越界写入：** 利用`io_sqe_buffer_register`函数中的缺陷，构造特定的`iovec`结构，使得在`bvec_set_page`时发生越界写入，覆盖相邻的内存区域。
3.  **权限提升：** 覆盖内核数据结构，劫持控制流，最终实现本地权限提升。

总而言之，CVE-2023-2598是一个高危漏洞，攻击者可以利用它来获得root权限。提供的PoC代码具有有效性，能够本地提权。但是，不能排除存在投毒代码的可能性，因此在使用前应仔细审查。

**项目地址:** [SpongeBob-369/CVE-2023-2598](https://github.com/SpongeBob-369/CVE-2023-2598)

**漏洞详情:** [CVE-2023-2598](https://nvd.nist.gov/vuln/detail/CVE-2023-2598)

---

## POC #3

**来源**: [CVE-2023-2598-cainiao159357_CVE-2023-2598.md](../2023/CVE-2023-2598-cainiao159357_CVE-2023-2598.md)

## CVE-2023-2598-Linux Kernel io_uring Out-of-Bounds Access

**漏洞编号:** CVE-2023-2598

**漏洞类型:** Out-of-Bounds Write/Read

**影响应用:** Linux Kernel

**危害等级:** 高危，本地权限提升

**影响版本:** Kernel prior to 6.4-rc1

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-2598 存在于 Linux Kernel 的 io_uring fixed buffer registration 代码 (io_sqe_buffer_register in io_uring/rsrc.c) 中。该漏洞允许越界访问物理内存，超出 buffer 范围。PoC 代码表明，该漏洞允许本地权限提升，无需特定地址依赖。

**有效性：**
提供的PoC代码通过修改uid来提权，说明该代码是有效的，因为它能够利用越界读写接口来修改用户ID，从而获得root权限。

**投毒风险：**
PoC 代码中主要的逻辑是利用漏洞进行提权，并没有发现明显的恶意代码。尽管如此，仍然存在一些潜在的风险：
*   **代码复杂性：** io_uring的利用本身就比较复杂，攻击者可能会在细节上做手脚，例如在错误处理流程中引入漏洞或者修改关键参数。
*   **安全假设：** 代码依赖于特定的内核配置或环境，如果环境不符合预期，可能会导致PoC失效甚至系统崩溃。
*   **Cred 喷射：** PoC使用了cred喷射技术，理论上存在污染其他进程cred的可能性，但可能性很低，而且也不是作者故意为之。

综合考虑，该PoC代码的投毒风险较低，但不能完全排除。评估的投毒风险为 10%。

**利用方式：**
1.  **漏洞触发：**
利用io_uring接口注册buffer，通过mmap将同一个物理页表映射到连续的虚拟地址上，绕过内核的检查。

2.  **越界读写：**
注册的buffer size大于实际分配的物理内存，导致可以越界读写。

3.  **提权：**
通过越界读写，修改当前进程的cred结构体中的uid为0，从而获得root权限。

4.  **执行shell：**
利用execve执行/bin/sh，获得root shell。

**项目地址:** [cainiao159357/CVE-2023-2598](https://github.com/cainiao159357/CVE-2023-2598)

**漏洞详情:** [CVE-2023-2598](https://nvd.nist.gov/vuln/detail/CVE-2023-2598)

---

## POC #4

**来源**: [CVE-2023-2598-guard-wait_CVE-2023-2598_EXP.md](../2023/CVE-2023-2598-guard-wait_CVE-2023-2598_EXP.md)

## CVE-2023-2598-Linux Kernel-io_uring 权限提升

**漏洞编号:** CVE-2023-2598

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Kernel prior to 6.4-rc1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞库信息，CVE-2023-2598是Linux内核io_uring子系统中的一个漏洞，具体位于io_sqe_buffer_register函数中。该漏洞允许越界访问物理内存，导致本地权限提升。 

**有效性：** 根据CVE描述，该漏洞的利用可以导致本地权限提升，因此利用代码有效。需要注意的是，kernel的exp编写和调试有一定难度。

**投毒风险：** 提供的代码片段仅为GNU GPL许可证，并非漏洞利用代码。因此无法直接分析该仓库中是否存在投毒代码。但考虑到GPL协议的特性，恶意投毒的可能性较低。但依然不能排除仓库中其他文件存在恶意代码的可能性，评估投毒风险为 5% (主要考虑同仓库下存在其他恶意文件的可能性，而非GPL许可证本身）。

**利用方式：** 漏洞的利用方式是利用io_uring的固定缓冲区注册代码中的缺陷，在注册缓冲区时越界访问物理内存。攻击者可以通过精心构造io_uring请求，触发越界访问，从而改写内核内存，最终实现权限提升。利用通常涉及以下步骤：

1.  **触发漏洞：** 通过特定的io_uring操作（如注册固定缓冲区）触发io_sqe_buffer_register函数中的漏洞。
2.  **越界访问：** 利用漏洞实现对物理内存的越界读写。
3.  **权限提升：** 通过改写内核数据结构（如进程的cred结构体）来提升当前用户的权限。

**项目地址:** [guard-wait/CVE-2023-2598_EXP](https://github.com/guard-wait/CVE-2023-2598_EXP)

**漏洞详情:** [CVE-2023-2598](https://nvd.nist.gov/vuln/detail/CVE-2023-2598)

---

## POC #5

**来源**: [CVE-2023-2598-ysanatomic_io_uring_LPE-CVE-2023-2598.md](../2023/CVE-2023-2598-ysanatomic_io_uring_LPE-CVE-2023-2598.md)

## CVE-2023-2598-Linux内核io_uring本地提权

**漏洞编号:** CVE-2023-2598

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可以提升到root权限

**影响版本:** Kernel prior to 6.4-rc1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-2598 存在于Linux内核的io_uring子系统中，`io_sqe_buffer_register` 函数中存在一个缺陷，允许越界访问物理内存。这个缺陷发生在固定缓冲区注册过程中。攻击者可以利用此漏洞实现本地权限提升。

**有效性：**
根据提供的漏洞库信息、搜索结果和漏洞利用代码，该漏洞的POC是有效的。搜索结果中直接包含指向GitHub上POC代码的链接 (ysanatomic/io_uring_LPE-CVE-2023-2598)。漏洞库信息也表明这是一个可利用的漏洞。

**投毒风险：**
分析提供的POC代码，投毒风险较低。主要风险点在于：
*   `exploit.c`： 这是一个相对完整的提权利用代码，主要通过 io_uring 机制进行内存操作。其中包含设置CPU亲和性、初始化io_uring、创建sockets、创建memfds等操作，最终目的是利用越界访问漏洞读取内核内存，并修改内核结构，实现提权。虽然代码逻辑较为复杂，但主要集中在漏洞利用本身，没有明显的后门或恶意代码。
考虑到作者已经公开了漏洞分析和利用代码，潜在的投毒行为会增加被发现的概率，因此判断存在轻微的投毒风险，主要是为了防止被检测。

**利用方式：**
1.  **漏洞触发：** 该漏洞利用`io_uring`子系统的固定缓冲区注册功能，通过`io_sqe_buffer_register`函数注册固定缓冲区时，存在越界访问漏洞。
2.  **内存布局：** 漏洞利用代码通过创建大量sockets和memfds来控制内核内存布局，为后续的利用创造条件。
3.  **信息泄露：** 利用越界访问漏洞，读取内核内存中的敏感信息，例如内核地址(`kaslr_base`)。
4.  **权限提升：** 通过修改内核结构体(如`cred`结构体)中的`uid`、`gid`等字段，将当前进程的权限提升到root权限。具体的利用手法涉及到 ROP (Return-Oriented Programming)，通过执行一系列预先构造好的指令序列来完成权限提升。
5.  **清理工作：** 清理现场，恢复被修改的内核状态，避免系统崩溃。

综上，此漏洞利用方式较为复杂，需要对`io_uring`子系统和内核内存管理有深入的理解。攻击者需要精心构造`io_uring`请求，控制内存布局，才能成功实现权限提升。

**项目地址:** [ysanatomic/io_uring_LPE-CVE-2023-2598](https://github.com/ysanatomic/io_uring_LPE-CVE-2023-2598)

**漏洞详情:** [CVE-2023-2598](https://nvd.nist.gov/vuln/detail/CVE-2023-2598)

---



---

## POC #2

**来源**: [CVE-2023-2598-SpongeBob-369_CVE-2023-2598.md](../2023/CVE-2023-2598-SpongeBob-369_CVE-2023-2598.md)

## CVE-2023-2598 - Linux Kernel io_uring 本地提权漏洞

**漏洞编号:** CVE-2023-2598

**漏洞类型:** 内存越界写入/本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Kernel prior to 6.4-rc1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-2598是Linux内核io_uring子系统中的一个漏洞，位于`io_sqe_buffer_register`函数中。该函数在处理固定缓冲区注册时存在缺陷，允许越界访问物理内存，从而导致本地权限提升。

**有效性：**
根据提供的漏洞信息和搜索引擎结果，此漏洞存在PoC利用代码（例如：[https://github.com/ysanatomic/io_uring_LPE-CVE-2023-2598](https://github.com/ysanatomic/io_uring_LPE-CVE-2023-2598)），并且多个来源（NVD、Red Hat、Wiz、CVEdetails、SUSE）确认了该漏洞的存在，因此判断该漏洞的PoC代码有效。

**投毒风险：**
分析提供的部分PoC代码（`README.md`），其描述了漏洞原理，涉及`io_uring`的基本概念，包括提交队列(SQ)和完成队列(CQ)以及`io_sqe_buffer_register`函数的实现细节。该漏洞源于`io_sqe_buffer_register`函数中对物理内存页面的处理不当。具体来说，当应用程序使用`io_uring_register`注册缓冲区时，`io_sqe_buffer_register`函数负责将虚拟地址映射到物理地址。由于逻辑错误，可能导致在`bvec_set_page`处发生越界写入。

**投毒风险分析：**
提供的代码片段主要用于解释漏洞原理，并未发现明显的恶意代码。但是，完整的exploit代码可能包含执行任意代码的部分，具有潜在的投毒风险。考虑到github仓库`ysanatomic/io_uring_LPE-CVE-2023-2598`是公开的，且漏洞利用的复杂性，存在作者有意或无意引入恶意代码的可能。因此，认为存在10%的投毒风险（主要集中在完整的exploit中，而非提供的代码片段）。

**利用方式：**
1.  **漏洞触发：** 通过`io_uring_register`系统调用注册缓冲区。
2.  **越界写入：** 利用`io_sqe_buffer_register`函数中的缺陷，构造特定的`iovec`结构，使得在`bvec_set_page`时发生越界写入，覆盖相邻的内存区域。
3.  **权限提升：** 覆盖内核数据结构，劫持控制流，最终实现本地权限提升。

总而言之，CVE-2023-2598是一个高危漏洞，攻击者可以利用它来获得root权限。提供的PoC代码具有有效性，能够本地提权。但是，不能排除存在投毒代码的可能性，因此在使用前应仔细审查。

**项目地址:** [SpongeBob-369/CVE-2023-2598](https://github.com/SpongeBob-369/CVE-2023-2598)

**漏洞详情:** [CVE-2023-2598](https://nvd.nist.gov/vuln/detail/CVE-2023-2598)

---

## POC #3

**来源**: [CVE-2023-2598-cainiao159357_CVE-2023-2598.md](../2023/CVE-2023-2598-cainiao159357_CVE-2023-2598.md)

## CVE-2023-2598-Linux Kernel io_uring Out-of-Bounds Access

**漏洞编号:** CVE-2023-2598

**漏洞类型:** Out-of-Bounds Write/Read

**影响应用:** Linux Kernel

**危害等级:** 高危，本地权限提升

**影响版本:** Kernel prior to 6.4-rc1

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-2598 存在于 Linux Kernel 的 io_uring fixed buffer registration 代码 (io_sqe_buffer_register in io_uring/rsrc.c) 中。该漏洞允许越界访问物理内存，超出 buffer 范围。PoC 代码表明，该漏洞允许本地权限提升，无需特定地址依赖。

**有效性：**
提供的PoC代码通过修改uid来提权，说明该代码是有效的，因为它能够利用越界读写接口来修改用户ID，从而获得root权限。

**投毒风险：**
PoC 代码中主要的逻辑是利用漏洞进行提权，并没有发现明显的恶意代码。尽管如此，仍然存在一些潜在的风险：
*   **代码复杂性：** io_uring的利用本身就比较复杂，攻击者可能会在细节上做手脚，例如在错误处理流程中引入漏洞或者修改关键参数。
*   **安全假设：** 代码依赖于特定的内核配置或环境，如果环境不符合预期，可能会导致PoC失效甚至系统崩溃。
*   **Cred 喷射：** PoC使用了cred喷射技术，理论上存在污染其他进程cred的可能性，但可能性很低，而且也不是作者故意为之。

综合考虑，该PoC代码的投毒风险较低，但不能完全排除。评估的投毒风险为 10%。

**利用方式：**
1.  **漏洞触发：**
利用io_uring接口注册buffer，通过mmap将同一个物理页表映射到连续的虚拟地址上，绕过内核的检查。

2.  **越界读写：**
注册的buffer size大于实际分配的物理内存，导致可以越界读写。

3.  **提权：**
通过越界读写，修改当前进程的cred结构体中的uid为0，从而获得root权限。

4.  **执行shell：**
利用execve执行/bin/sh，获得root shell。

**项目地址:** [cainiao159357/CVE-2023-2598](https://github.com/cainiao159357/CVE-2023-2598)

**漏洞详情:** [CVE-2023-2598](https://nvd.nist.gov/vuln/detail/CVE-2023-2598)

---

## POC #4

**来源**: [CVE-2023-2598-guard-wait_CVE-2023-2598_EXP.md](../2023/CVE-2023-2598-guard-wait_CVE-2023-2598_EXP.md)

## CVE-2023-2598-Linux Kernel-io_uring 权限提升

**漏洞编号:** CVE-2023-2598

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Kernel prior to 6.4-rc1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞库信息，CVE-2023-2598是Linux内核io_uring子系统中的一个漏洞，具体位于io_sqe_buffer_register函数中。该漏洞允许越界访问物理内存，导致本地权限提升。 

**有效性：** 根据CVE描述，该漏洞的利用可以导致本地权限提升，因此利用代码有效。需要注意的是，kernel的exp编写和调试有一定难度。

**投毒风险：** 提供的代码片段仅为GNU GPL许可证，并非漏洞利用代码。因此无法直接分析该仓库中是否存在投毒代码。但考虑到GPL协议的特性，恶意投毒的可能性较低。但依然不能排除仓库中其他文件存在恶意代码的可能性，评估投毒风险为 5% (主要考虑同仓库下存在其他恶意文件的可能性，而非GPL许可证本身）。

**利用方式：** 漏洞的利用方式是利用io_uring的固定缓冲区注册代码中的缺陷，在注册缓冲区时越界访问物理内存。攻击者可以通过精心构造io_uring请求，触发越界访问，从而改写内核内存，最终实现权限提升。利用通常涉及以下步骤：

1.  **触发漏洞：** 通过特定的io_uring操作（如注册固定缓冲区）触发io_sqe_buffer_register函数中的漏洞。
2.  **越界访问：** 利用漏洞实现对物理内存的越界读写。
3.  **权限提升：** 通过改写内核数据结构（如进程的cred结构体）来提升当前用户的权限。

**项目地址:** [guard-wait/CVE-2023-2598_EXP](https://github.com/guard-wait/CVE-2023-2598_EXP)

**漏洞详情:** [CVE-2023-2598](https://nvd.nist.gov/vuln/detail/CVE-2023-2598)

---

## POC #5

**来源**: [CVE-2023-2598-ysanatomic_io_uring_LPE-CVE-2023-2598.md](../2023/CVE-2023-2598-ysanatomic_io_uring_LPE-CVE-2023-2598.md)

## CVE-2023-2598-Linux内核io_uring本地提权

**漏洞编号:** CVE-2023-2598

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可以提升到root权限

**影响版本:** Kernel prior to 6.4-rc1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-2598 存在于Linux内核的io_uring子系统中，`io_sqe_buffer_register` 函数中存在一个缺陷，允许越界访问物理内存。这个缺陷发生在固定缓冲区注册过程中。攻击者可以利用此漏洞实现本地权限提升。

**有效性：**
根据提供的漏洞库信息、搜索结果和漏洞利用代码，该漏洞的POC是有效的。搜索结果中直接包含指向GitHub上POC代码的链接 (ysanatomic/io_uring_LPE-CVE-2023-2598)。漏洞库信息也表明这是一个可利用的漏洞。

**投毒风险：**
分析提供的POC代码，投毒风险较低。主要风险点在于：
*   `exploit.c`： 这是一个相对完整的提权利用代码，主要通过 io_uring 机制进行内存操作。其中包含设置CPU亲和性、初始化io_uring、创建sockets、创建memfds等操作，最终目的是利用越界访问漏洞读取内核内存，并修改内核结构，实现提权。虽然代码逻辑较为复杂，但主要集中在漏洞利用本身，没有明显的后门或恶意代码。
考虑到作者已经公开了漏洞分析和利用代码，潜在的投毒行为会增加被发现的概率，因此判断存在轻微的投毒风险，主要是为了防止被检测。

**利用方式：**
1.  **漏洞触发：** 该漏洞利用`io_uring`子系统的固定缓冲区注册功能，通过`io_sqe_buffer_register`函数注册固定缓冲区时，存在越界访问漏洞。
2.  **内存布局：** 漏洞利用代码通过创建大量sockets和memfds来控制内核内存布局，为后续的利用创造条件。
3.  **信息泄露：** 利用越界访问漏洞，读取内核内存中的敏感信息，例如内核地址(`kaslr_base`)。
4.  **权限提升：** 通过修改内核结构体(如`cred`结构体)中的`uid`、`gid`等字段，将当前进程的权限提升到root权限。具体的利用手法涉及到 ROP (Return-Oriented Programming)，通过执行一系列预先构造好的指令序列来完成权限提升。
5.  **清理工作：** 清理现场，恢复被修改的内核状态，避免系统崩溃。

综上，此漏洞利用方式较为复杂，需要对`io_uring`子系统和内核内存管理有深入的理解。攻击者需要精心构造`io_uring`请求，控制内存布局，才能成功实现权限提升。

**项目地址:** [ysanatomic/io_uring_LPE-CVE-2023-2598](https://github.com/ysanatomic/io_uring_LPE-CVE-2023-2598)

**漏洞详情:** [CVE-2023-2598](https://nvd.nist.gov/vuln/detail/CVE-2023-2598)

---



---

## POC #2

**来源**: [CVE-2023-2598-SpongeBob-369_CVE-2023-2598.md](../2023/CVE-2023-2598-SpongeBob-369_CVE-2023-2598.md)

## CVE-2023-2598 - Linux Kernel io_uring 本地提权漏洞

**漏洞编号:** CVE-2023-2598

**漏洞类型:** 内存越界写入/本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Kernel prior to 6.4-rc1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-2598是Linux内核io_uring子系统中的一个漏洞，位于`io_sqe_buffer_register`函数中。该函数在处理固定缓冲区注册时存在缺陷，允许越界访问物理内存，从而导致本地权限提升。

**有效性：**
根据提供的漏洞信息和搜索引擎结果，此漏洞存在PoC利用代码（例如：[https://github.com/ysanatomic/io_uring_LPE-CVE-2023-2598](https://github.com/ysanatomic/io_uring_LPE-CVE-2023-2598)），并且多个来源（NVD、Red Hat、Wiz、CVEdetails、SUSE）确认了该漏洞的存在，因此判断该漏洞的PoC代码有效。

**投毒风险：**
分析提供的部分PoC代码（`README.md`），其描述了漏洞原理，涉及`io_uring`的基本概念，包括提交队列(SQ)和完成队列(CQ)以及`io_sqe_buffer_register`函数的实现细节。该漏洞源于`io_sqe_buffer_register`函数中对物理内存页面的处理不当。具体来说，当应用程序使用`io_uring_register`注册缓冲区时，`io_sqe_buffer_register`函数负责将虚拟地址映射到物理地址。由于逻辑错误，可能导致在`bvec_set_page`处发生越界写入。

**投毒风险分析：**
提供的代码片段主要用于解释漏洞原理，并未发现明显的恶意代码。但是，完整的exploit代码可能包含执行任意代码的部分，具有潜在的投毒风险。考虑到github仓库`ysanatomic/io_uring_LPE-CVE-2023-2598`是公开的，且漏洞利用的复杂性，存在作者有意或无意引入恶意代码的可能。因此，认为存在10%的投毒风险（主要集中在完整的exploit中，而非提供的代码片段）。

**利用方式：**
1.  **漏洞触发：** 通过`io_uring_register`系统调用注册缓冲区。
2.  **越界写入：** 利用`io_sqe_buffer_register`函数中的缺陷，构造特定的`iovec`结构，使得在`bvec_set_page`时发生越界写入，覆盖相邻的内存区域。
3.  **权限提升：** 覆盖内核数据结构，劫持控制流，最终实现本地权限提升。

总而言之，CVE-2023-2598是一个高危漏洞，攻击者可以利用它来获得root权限。提供的PoC代码具有有效性，能够本地提权。但是，不能排除存在投毒代码的可能性，因此在使用前应仔细审查。

**项目地址:** [SpongeBob-369/CVE-2023-2598](https://github.com/SpongeBob-369/CVE-2023-2598)

**漏洞详情:** [CVE-2023-2598](https://nvd.nist.gov/vuln/detail/CVE-2023-2598)

---

## POC #3

**来源**: [CVE-2023-2598-cainiao159357_CVE-2023-2598.md](../2023/CVE-2023-2598-cainiao159357_CVE-2023-2598.md)

## CVE-2023-2598-Linux Kernel io_uring Out-of-Bounds Access

**漏洞编号:** CVE-2023-2598

**漏洞类型:** Out-of-Bounds Write/Read

**影响应用:** Linux Kernel

**危害等级:** 高危，本地权限提升

**影响版本:** Kernel prior to 6.4-rc1

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-2598 存在于 Linux Kernel 的 io_uring fixed buffer registration 代码 (io_sqe_buffer_register in io_uring/rsrc.c) 中。该漏洞允许越界访问物理内存，超出 buffer 范围。PoC 代码表明，该漏洞允许本地权限提升，无需特定地址依赖。

**有效性：**
提供的PoC代码通过修改uid来提权，说明该代码是有效的，因为它能够利用越界读写接口来修改用户ID，从而获得root权限。

**投毒风险：**
PoC 代码中主要的逻辑是利用漏洞进行提权，并没有发现明显的恶意代码。尽管如此，仍然存在一些潜在的风险：
*   **代码复杂性：** io_uring的利用本身就比较复杂，攻击者可能会在细节上做手脚，例如在错误处理流程中引入漏洞或者修改关键参数。
*   **安全假设：** 代码依赖于特定的内核配置或环境，如果环境不符合预期，可能会导致PoC失效甚至系统崩溃。
*   **Cred 喷射：** PoC使用了cred喷射技术，理论上存在污染其他进程cred的可能性，但可能性很低，而且也不是作者故意为之。

综合考虑，该PoC代码的投毒风险较低，但不能完全排除。评估的投毒风险为 10%。

**利用方式：**
1.  **漏洞触发：**
利用io_uring接口注册buffer，通过mmap将同一个物理页表映射到连续的虚拟地址上，绕过内核的检查。

2.  **越界读写：**
注册的buffer size大于实际分配的物理内存，导致可以越界读写。

3.  **提权：**
通过越界读写，修改当前进程的cred结构体中的uid为0，从而获得root权限。

4.  **执行shell：**
利用execve执行/bin/sh，获得root shell。

**项目地址:** [cainiao159357/CVE-2023-2598](https://github.com/cainiao159357/CVE-2023-2598)

**漏洞详情:** [CVE-2023-2598](https://nvd.nist.gov/vuln/detail/CVE-2023-2598)

---

## POC #4

**来源**: [CVE-2023-2598-guard-wait_CVE-2023-2598_EXP.md](../2023/CVE-2023-2598-guard-wait_CVE-2023-2598_EXP.md)

## CVE-2023-2598-Linux Kernel-io_uring 权限提升

**漏洞编号:** CVE-2023-2598

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Kernel prior to 6.4-rc1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞库信息，CVE-2023-2598是Linux内核io_uring子系统中的一个漏洞，具体位于io_sqe_buffer_register函数中。该漏洞允许越界访问物理内存，导致本地权限提升。 

**有效性：** 根据CVE描述，该漏洞的利用可以导致本地权限提升，因此利用代码有效。需要注意的是，kernel的exp编写和调试有一定难度。

**投毒风险：** 提供的代码片段仅为GNU GPL许可证，并非漏洞利用代码。因此无法直接分析该仓库中是否存在投毒代码。但考虑到GPL协议的特性，恶意投毒的可能性较低。但依然不能排除仓库中其他文件存在恶意代码的可能性，评估投毒风险为 5% (主要考虑同仓库下存在其他恶意文件的可能性，而非GPL许可证本身）。

**利用方式：** 漏洞的利用方式是利用io_uring的固定缓冲区注册代码中的缺陷，在注册缓冲区时越界访问物理内存。攻击者可以通过精心构造io_uring请求，触发越界访问，从而改写内核内存，最终实现权限提升。利用通常涉及以下步骤：

1.  **触发漏洞：** 通过特定的io_uring操作（如注册固定缓冲区）触发io_sqe_buffer_register函数中的漏洞。
2.  **越界访问：** 利用漏洞实现对物理内存的越界读写。
3.  **权限提升：** 通过改写内核数据结构（如进程的cred结构体）来提升当前用户的权限。

**项目地址:** [guard-wait/CVE-2023-2598_EXP](https://github.com/guard-wait/CVE-2023-2598_EXP)

**漏洞详情:** [CVE-2023-2598](https://nvd.nist.gov/vuln/detail/CVE-2023-2598)

---

## POC #5

**来源**: [CVE-2023-2598-ysanatomic_io_uring_LPE-CVE-2023-2598.md](../2023/CVE-2023-2598-ysanatomic_io_uring_LPE-CVE-2023-2598.md)

## CVE-2023-2598-Linux内核io_uring本地提权

**漏洞编号:** CVE-2023-2598

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可以提升到root权限

**影响版本:** Kernel prior to 6.4-rc1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-2598 存在于Linux内核的io_uring子系统中，`io_sqe_buffer_register` 函数中存在一个缺陷，允许越界访问物理内存。这个缺陷发生在固定缓冲区注册过程中。攻击者可以利用此漏洞实现本地权限提升。

**有效性：**
根据提供的漏洞库信息、搜索结果和漏洞利用代码，该漏洞的POC是有效的。搜索结果中直接包含指向GitHub上POC代码的链接 (ysanatomic/io_uring_LPE-CVE-2023-2598)。漏洞库信息也表明这是一个可利用的漏洞。

**投毒风险：**
分析提供的POC代码，投毒风险较低。主要风险点在于：
*   `exploit.c`： 这是一个相对完整的提权利用代码，主要通过 io_uring 机制进行内存操作。其中包含设置CPU亲和性、初始化io_uring、创建sockets、创建memfds等操作，最终目的是利用越界访问漏洞读取内核内存，并修改内核结构，实现提权。虽然代码逻辑较为复杂，但主要集中在漏洞利用本身，没有明显的后门或恶意代码。
考虑到作者已经公开了漏洞分析和利用代码，潜在的投毒行为会增加被发现的概率，因此判断存在轻微的投毒风险，主要是为了防止被检测。

**利用方式：**
1.  **漏洞触发：** 该漏洞利用`io_uring`子系统的固定缓冲区注册功能，通过`io_sqe_buffer_register`函数注册固定缓冲区时，存在越界访问漏洞。
2.  **内存布局：** 漏洞利用代码通过创建大量sockets和memfds来控制内核内存布局，为后续的利用创造条件。
3.  **信息泄露：** 利用越界访问漏洞，读取内核内存中的敏感信息，例如内核地址(`kaslr_base`)。
4.  **权限提升：** 通过修改内核结构体(如`cred`结构体)中的`uid`、`gid`等字段，将当前进程的权限提升到root权限。具体的利用手法涉及到 ROP (Return-Oriented Programming)，通过执行一系列预先构造好的指令序列来完成权限提升。
5.  **清理工作：** 清理现场，恢复被修改的内核状态，避免系统崩溃。

综上，此漏洞利用方式较为复杂，需要对`io_uring`子系统和内核内存管理有深入的理解。攻击者需要精心构造`io_uring`请求，控制内存布局，才能成功实现权限提升。

**项目地址:** [ysanatomic/io_uring_LPE-CVE-2023-2598](https://github.com/ysanatomic/io_uring_LPE-CVE-2023-2598)

**漏洞详情:** [CVE-2023-2598](https://nvd.nist.gov/vuln/detail/CVE-2023-2598)

---

