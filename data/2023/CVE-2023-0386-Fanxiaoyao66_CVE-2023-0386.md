# CVE-2023-0386

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-0386-AiK1d_CVE-2023-0386.md](../2023/CVE-2023-0386-AiK1d_CVE-2023-0386.md)

## CVE-2023-0386-Linux Kernel OverlayFS 本地提权

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel OverlayFS

**危害等级:** 高危，本地用户可提升权限

**影响版本:** Linux kernel 6.2-rc6

**利用条件:** 需要存在 OverlayFS 文件系统，用户拥有文件写入权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-0386 漏洞存在于 Linux Kernel 的 OverlayFS 子系统中，允许本地用户通过利用具有 capabilities 的 setuid 文件复制过程中的权限映射错误，将权限提升到 root 权限。

**有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用是有效的。搜索引擎结果中包含多个关于该漏洞的描述和利用示例，表明该漏洞已得到广泛关注和研究。漏洞利用代码 `CVE-2023-0386-exp.c` 提供了一个 POC，通过 FUSE 创建一个文件系统，并在 OverlayFS 中利用该文件系统中的 setuid 文件来提升权限。

**利用方式：**

1.  **创建 FUSE 文件系统：** 漏洞利用代码使用 FUSE（Filesystem in Userspace）创建一个用户态的文件系统。该文件系统包含一个具有 setuid 权限的可执行文件 `/hello`。
2.  **挂载 OverlayFS：** 漏洞利用代码使用 `unshare` 命令创建一个新的 mount namespace，并在该 namespace 中挂载 OverlayFS。OverlayFS 将 FUSE 文件系统作为 lowerdir，并将另外两个目录作为 upperdir 和 workdir。
3.  **触发漏洞：** 当用户尝试访问 OverlayFS 中的 `/hello` 文件时，内核会尝试复制该文件。由于 OverlayFS 存在权限映射错误，复制后的文件会保留 setuid 权限，从而允许本地用户以 root 权限执行该文件。
4.  **权限提升：** 执行具有 setuid 权限的文件会使得本地用户获得 root 权限，从而实现权限提升。

**投毒风险：**

该漏洞利用代码主要用于演示漏洞利用过程，并提升权限。漏洞利用代码中包含的shellcode的功能是通过调用execve执行/bin/sh以提升权限，并没有发现直接的恶意代码或后门逻辑。但是，仍然存在一些潜在的投毒风险：

*   **隐藏的后门代码：** 作者可能在 shellcode 中插入隐藏的后门代码，例如，收集系统信息并发送到远程服务器。 由于汇编指令不易读懂，因此较难进行分析
*   **环境依赖性：** 漏洞利用代码可能依赖特定的系统环境或库，这可能会导致漏洞利用失败，或者在某些情况下，触发意外的行为。 这部分代码有概率包含恶意指令。
*   **覆盖或修改文件：** 漏洞利用代码可能会覆盖或修改系统中的文件，这可能会导致系统不稳定或数据丢失。

综合评估，该漏洞利用代码的投毒风险较低，估计约为 5%。因为这段shellcode很短，执行的操作也很简单，不包含明显的恶意逻辑，但是作者仍然可能通过微妙的方式隐藏恶意行为。


**项目地址:** [AiK1d/CVE-2023-0386](https://github.com/AiK1d/CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #2

**来源**: [CVE-2023-0386-EstamelGG_CVE-2023-0386-libs.md](../2023/CVE-2023-0386-EstamelGG_CVE-2023-0386-libs.md)

## CVE-2023-0386-Linux Kernel OverlayFS权限提升

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel OverlayFS

**危害等级:** 高危，可导致本地用户权限提升至root

**影响版本:** Linux kernel 6.2-rc6 (受影响版本)

**利用条件:** 需要本地用户权限，系统开启OverlayFS

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-0386是Linux内核OverlayFS子系统中的一个权限提升漏洞。该漏洞允许本地用户通过利用uid映射中的bug，将具有capability的文件从nosuid挂载复制到另一个挂载，从而提升权限。

**有效性分析：**
提供的POC代码是一个FUSE文件系统，它模拟了一个包含SUID文件的环境。该SUID文件被设计成执行一个shell。攻击者可以通过OverlayFS将这个SUID文件复制到其他位置并执行，从而提升权限。根据搜索引擎结果和漏洞描述，此漏洞利用方式是有效的。

**投毒风险分析：**
代码本身看起来比较直接，主要功能是创建具有特定权限的文件，并利用OverlayFS的特性进行提权。代码中存在使用`rand()`函数生成随机字符串作为目录名。虽然`rand()`的安全性不高，但是此次作为目录名，可以忽略不计。shellcode简单，功能明确。因此，投毒的可能性极低，可以忽略不计。

**利用方式：**
1.  运行POC代码，它会创建一个FUSE文件系统。
2.  在FUSE文件系统中，会创建一个具有SUID权限的可执行文件。
3.  利用OverlayFS将该SUID文件复制到文件系统的其他位置。
4.  执行复制后的SUID文件，由于OverlayFS的权限处理不当，攻击者可以获得提升的权限。

**项目地址:** [EstamelGG/CVE-2023-0386-libs](https://github.com/EstamelGG/CVE-2023-0386-libs)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #3

**来源**: [CVE-2023-0386-Fanxiaoyao66_CVE-2023-0386.md](../2023/CVE-2023-0386-Fanxiaoyao66_CVE-2023-0386.md)

# CVE-2023-0386

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-0386-AiK1d_CVE-2023-0386.md](../2023/CVE-2023-0386-AiK1d_CVE-2023-0386.md)

## CVE-2023-0386-Linux Kernel OverlayFS 本地提权

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel OverlayFS

**危害等级:** 高危，本地用户可提升权限

**影响版本:** Linux kernel 6.2-rc6

**利用条件:** 需要存在 OverlayFS 文件系统，用户拥有文件写入权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-0386 漏洞存在于 Linux Kernel 的 OverlayFS 子系统中，允许本地用户通过利用具有 capabilities 的 setuid 文件复制过程中的权限映射错误，将权限提升到 root 权限。

**有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用是有效的。搜索引擎结果中包含多个关于该漏洞的描述和利用示例，表明该漏洞已得到广泛关注和研究。漏洞利用代码 `CVE-2023-0386-exp.c` 提供了一个 POC，通过 FUSE 创建一个文件系统，并在 OverlayFS 中利用该文件系统中的 setuid 文件来提升权限。

**利用方式：**

1.  **创建 FUSE 文件系统：** 漏洞利用代码使用 FUSE（Filesystem in Userspace）创建一个用户态的文件系统。该文件系统包含一个具有 setuid 权限的可执行文件 `/hello`。
2.  **挂载 OverlayFS：** 漏洞利用代码使用 `unshare` 命令创建一个新的 mount namespace，并在该 namespace 中挂载 OverlayFS。OverlayFS 将 FUSE 文件系统作为 lowerdir，并将另外两个目录作为 upperdir 和 workdir。
3.  **触发漏洞：** 当用户尝试访问 OverlayFS 中的 `/hello` 文件时，内核会尝试复制该文件。由于 OverlayFS 存在权限映射错误，复制后的文件会保留 setuid 权限，从而允许本地用户以 root 权限执行该文件。
4.  **权限提升：** 执行具有 setuid 权限的文件会使得本地用户获得 root 权限，从而实现权限提升。

**投毒风险：**

该漏洞利用代码主要用于演示漏洞利用过程，并提升权限。漏洞利用代码中包含的shellcode的功能是通过调用execve执行/bin/sh以提升权限，并没有发现直接的恶意代码或后门逻辑。但是，仍然存在一些潜在的投毒风险：

*   **隐藏的后门代码：** 作者可能在 shellcode 中插入隐藏的后门代码，例如，收集系统信息并发送到远程服务器。 由于汇编指令不易读懂，因此较难进行分析
*   **环境依赖性：** 漏洞利用代码可能依赖特定的系统环境或库，这可能会导致漏洞利用失败，或者在某些情况下，触发意外的行为。 这部分代码有概率包含恶意指令。
*   **覆盖或修改文件：** 漏洞利用代码可能会覆盖或修改系统中的文件，这可能会导致系统不稳定或数据丢失。

综合评估，该漏洞利用代码的投毒风险较低，估计约为 5%。因为这段shellcode很短，执行的操作也很简单，不包含明显的恶意逻辑，但是作者仍然可能通过微妙的方式隐藏恶意行为。


**项目地址:** [AiK1d/CVE-2023-0386](https://github.com/AiK1d/CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #2

**来源**: [CVE-2023-0386-EstamelGG_CVE-2023-0386-libs.md](../2023/CVE-2023-0386-EstamelGG_CVE-2023-0386-libs.md)

## CVE-2023-0386-Linux Kernel OverlayFS权限提升

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel OverlayFS

**危害等级:** 高危，可导致本地用户权限提升至root

**影响版本:** Linux kernel 6.2-rc6 (受影响版本)

**利用条件:** 需要本地用户权限，系统开启OverlayFS

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-0386是Linux内核OverlayFS子系统中的一个权限提升漏洞。该漏洞允许本地用户通过利用uid映射中的bug，将具有capability的文件从nosuid挂载复制到另一个挂载，从而提升权限。

**有效性分析：**
提供的POC代码是一个FUSE文件系统，它模拟了一个包含SUID文件的环境。该SUID文件被设计成执行一个shell。攻击者可以通过OverlayFS将这个SUID文件复制到其他位置并执行，从而提升权限。根据搜索引擎结果和漏洞描述，此漏洞利用方式是有效的。

**投毒风险分析：**
代码本身看起来比较直接，主要功能是创建具有特定权限的文件，并利用OverlayFS的特性进行提权。代码中存在使用`rand()`函数生成随机字符串作为目录名。虽然`rand()`的安全性不高，但是此次作为目录名，可以忽略不计。shellcode简单，功能明确。因此，投毒的可能性极低，可以忽略不计。

**利用方式：**
1.  运行POC代码，它会创建一个FUSE文件系统。
2.  在FUSE文件系统中，会创建一个具有SUID权限的可执行文件。
3.  利用OverlayFS将该SUID文件复制到文件系统的其他位置。
4.  执行复制后的SUID文件，由于OverlayFS的权限处理不当，攻击者可以获得提升的权限。

**项目地址:** [EstamelGG/CVE-2023-0386-libs](https://github.com/EstamelGG/CVE-2023-0386-libs)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #3

**来源**: [CVE-2023-0386-Fanxiaoyao66_CVE-2023-0386.md](../2023/CVE-2023-0386-Fanxiaoyao66_CVE-2023-0386.md)

# CVE-2023-0386

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-0386-AiK1d_CVE-2023-0386.md](../2023/CVE-2023-0386-AiK1d_CVE-2023-0386.md)

## CVE-2023-0386-Linux Kernel OverlayFS 本地提权

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel OverlayFS

**危害等级:** 高危，本地用户可提升权限

**影响版本:** Linux kernel 6.2-rc6

**利用条件:** 需要存在 OverlayFS 文件系统，用户拥有文件写入权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-0386 漏洞存在于 Linux Kernel 的 OverlayFS 子系统中，允许本地用户通过利用具有 capabilities 的 setuid 文件复制过程中的权限映射错误，将权限提升到 root 权限。

**有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用是有效的。搜索引擎结果中包含多个关于该漏洞的描述和利用示例，表明该漏洞已得到广泛关注和研究。漏洞利用代码 `CVE-2023-0386-exp.c` 提供了一个 POC，通过 FUSE 创建一个文件系统，并在 OverlayFS 中利用该文件系统中的 setuid 文件来提升权限。

**利用方式：**

1.  **创建 FUSE 文件系统：** 漏洞利用代码使用 FUSE（Filesystem in Userspace）创建一个用户态的文件系统。该文件系统包含一个具有 setuid 权限的可执行文件 `/hello`。
2.  **挂载 OverlayFS：** 漏洞利用代码使用 `unshare` 命令创建一个新的 mount namespace，并在该 namespace 中挂载 OverlayFS。OverlayFS 将 FUSE 文件系统作为 lowerdir，并将另外两个目录作为 upperdir 和 workdir。
3.  **触发漏洞：** 当用户尝试访问 OverlayFS 中的 `/hello` 文件时，内核会尝试复制该文件。由于 OverlayFS 存在权限映射错误，复制后的文件会保留 setuid 权限，从而允许本地用户以 root 权限执行该文件。
4.  **权限提升：** 执行具有 setuid 权限的文件会使得本地用户获得 root 权限，从而实现权限提升。

**投毒风险：**

该漏洞利用代码主要用于演示漏洞利用过程，并提升权限。漏洞利用代码中包含的shellcode的功能是通过调用execve执行/bin/sh以提升权限，并没有发现直接的恶意代码或后门逻辑。但是，仍然存在一些潜在的投毒风险：

*   **隐藏的后门代码：** 作者可能在 shellcode 中插入隐藏的后门代码，例如，收集系统信息并发送到远程服务器。 由于汇编指令不易读懂，因此较难进行分析
*   **环境依赖性：** 漏洞利用代码可能依赖特定的系统环境或库，这可能会导致漏洞利用失败，或者在某些情况下，触发意外的行为。 这部分代码有概率包含恶意指令。
*   **覆盖或修改文件：** 漏洞利用代码可能会覆盖或修改系统中的文件，这可能会导致系统不稳定或数据丢失。

综合评估，该漏洞利用代码的投毒风险较低，估计约为 5%。因为这段shellcode很短，执行的操作也很简单，不包含明显的恶意逻辑，但是作者仍然可能通过微妙的方式隐藏恶意行为。


**项目地址:** [AiK1d/CVE-2023-0386](https://github.com/AiK1d/CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #2

**来源**: [CVE-2023-0386-EstamelGG_CVE-2023-0386-libs.md](../2023/CVE-2023-0386-EstamelGG_CVE-2023-0386-libs.md)

## CVE-2023-0386-Linux Kernel OverlayFS权限提升

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel OverlayFS

**危害等级:** 高危，可导致本地用户权限提升至root

**影响版本:** Linux kernel 6.2-rc6 (受影响版本)

**利用条件:** 需要本地用户权限，系统开启OverlayFS

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-0386是Linux内核OverlayFS子系统中的一个权限提升漏洞。该漏洞允许本地用户通过利用uid映射中的bug，将具有capability的文件从nosuid挂载复制到另一个挂载，从而提升权限。

**有效性分析：**
提供的POC代码是一个FUSE文件系统，它模拟了一个包含SUID文件的环境。该SUID文件被设计成执行一个shell。攻击者可以通过OverlayFS将这个SUID文件复制到其他位置并执行，从而提升权限。根据搜索引擎结果和漏洞描述，此漏洞利用方式是有效的。

**投毒风险分析：**
代码本身看起来比较直接，主要功能是创建具有特定权限的文件，并利用OverlayFS的特性进行提权。代码中存在使用`rand()`函数生成随机字符串作为目录名。虽然`rand()`的安全性不高，但是此次作为目录名，可以忽略不计。shellcode简单，功能明确。因此，投毒的可能性极低，可以忽略不计。

**利用方式：**
1.  运行POC代码，它会创建一个FUSE文件系统。
2.  在FUSE文件系统中，会创建一个具有SUID权限的可执行文件。
3.  利用OverlayFS将该SUID文件复制到文件系统的其他位置。
4.  执行复制后的SUID文件，由于OverlayFS的权限处理不当，攻击者可以获得提升的权限。

**项目地址:** [EstamelGG/CVE-2023-0386-libs](https://github.com/EstamelGG/CVE-2023-0386-libs)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #3

**来源**: [CVE-2023-0386-Satheesh575555_linux-4.19.72_CVE-2023-0386.md](../2023/CVE-2023-0386-Satheesh575555_linux-4.19.72_CVE-2023-0386.md)

## CVE-2023-0386-Linux Kernel OverlayFS权限提升

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户提升权限

**影响版本:** Linux kernel 6.2-rc6 (可能影响其他版本，需要根据补丁判断)

**利用条件:** 需要本地用户权限，目标系统使用 OverlayFS 文件系统。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-0386 漏洞存在于 Linux 内核的 OverlayFS 子系统中。漏洞描述指出，当用户从一个 nosuid 的挂载点复制一个具有 capability 的文件到另一个挂载点时，存在权限映射错误。这使得本地用户能够提升他们在系统上的权限。

**有效性：** 根据搜索结果，存在公开的漏洞利用代码（例如 vicarius.io），证明该漏洞可以被利用。 虽然提供的代码段本身不是完整的PoC，但搜索结果指向了可用的完整PoC，所以判断是有效的。

**投毒风险：** 提供的代码段是Linux内核的COPYING和CREDITS文件，它们是许可信息和贡献者列表，而非可执行代码。 这些文件本身不包含恶意代码。虽然这些文件本身不是漏洞利用程序，但如果将恶意代码伪装成贡献者添加到CREDITS文件中，从理论上讲，可以将恶意代码混入到源代码管理系统中。因为这假设有恶意的人员对代码库提交被篡改的CREDITS文件，概率极低,因此判断投毒风险极低。

**利用方式：** 该漏洞的利用方式涉及以下步骤：
1.  利用OverlayFS文件系统特性，将一个具有 setuid 权限的文件从 nosuid 挂载点复制到其他挂载点。
2.  由于权限映射错误，新复制的文件在目标挂载点上保留了 setuid 权限，但是用户ID 映射不正确。
3.  攻击者可以执行这个具有 setuid 权限的文件，从而以更高的权限运行代码。

搜索引擎结果和漏洞库信息都表明该漏洞允许本地权限提升，所以漏洞利用是有效的。

**项目地址:** [Satheesh575555/linux-4.19.72_CVE-2023-0386](https://github.com/Satheesh575555/linux-4.19.72_CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #4

**来源**: [CVE-2023-0386-bchevCH_CVE-2023-0386.md](../2023/CVE-2023-0386-bchevCH_CVE-2023-0386.md)

## CVE-2023-0386 OverlayFS 本地提权漏洞

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可使普通用户获得root权限

**影响版本:** < 6.2

**利用条件:** 需要本地访问权限，目标系统内核版本低于6.2且OverlayFS未修复

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-0386 是 Linux 内核 OverlayFS 子系统中的一个漏洞，允许本地用户提升权限。该漏洞源于内核在执行 copy-up 操作期间未能正确验证用户/组所有权映射。攻击者可以利用此漏洞：

1.  创建一个具有 root 拥有的 SUID 二进制文件的恶意 FUSE 文件系统。
2.  使用用户和挂载命名空间隔离操作。
3.  创建一个 OverlayFS 挂载，并将 FUSE 文件系统作为 lower layer。
4.  触发一个 copy-up 操作，错误地保留 SUID 位。
5.  执行生成的 SUID 二进制文件以获得 root 权限。

**有效性：** 根据漏洞信息和搜索结果，该漏洞已被积极利用，PoC 代码的存在进一步证实了其有效性。提供的 `README.md` 文件描述了一个完整的安全工具包，包含漏洞测试、缓解和取证分析脚本，说明此漏洞的利用代码已经比较成熟。

**投毒风险：** 虽然该工具包提供了漏洞测试脚本，但同时也包含了缓解和取证分析脚本，相对比较完整。考虑到该漏洞被 CISA 列入已知被利用漏洞目录，说明此漏洞利用的公开程度较高。`README.md` 文件中也包含了免责声明，提示仅在测试系统上运行 PoC。因此，虽然不排除作者可能在脚本中隐藏恶意代码，但概率相对较低，约为10%。需要对脚本内容进行详细审计以确认是否存在投毒行为。

**利用方式：**

1.  **环境准备：** 攻击者需要一个存在漏洞的 Linux 系统，并且能够创建挂载点和用户命名空间。
2.  **FUSE 文件系统创建：** 创建一个 FUSE 文件系统，并在其中放置一个 root 用户拥有的 SUID 可执行文件。
3.  **OverlayFS 挂载：** 使用 FUSE 文件系统作为 lower layer，创建一个 OverlayFS 挂载。
4.  **触发 Copy-up：** 通过访问或修改 FUSE 文件系统中的文件，触发 copy-up 操作。这将导致 SUID 可执行文件被复制到 OverlayFS 的 upper layer。
5.  **权限提升：** 执行 upper layer 中的 SUID 可执行文件，由于漏洞的存在，该文件仍然保留 SUID 位，从而使攻击者获得 root 权限。

**项目地址:** [bchevCH/CVE-2023-0386](https://github.com/bchevCH/CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #5

**来源**: [CVE-2023-0386-chenaotian_CVE-2023-0386.md](../2023/CVE-2023-0386-chenaotian_CVE-2023-0386.md)

## CVE-2023-0386 OverlayFS 本地提权漏洞

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel OverlayFS

**危害等级:** 高危，可导致本地权限提升

**影响版本:** 5.11 ~ 5.19

**利用条件:** 需要能够 unshare 或创建 overlay 文件系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于 Linux 内核的 OverlayFS 子系统中，允许本地用户通过利用 OverlayFS 的特性，结合用户命名空间绕过权限检查，从而将权限提升为 root。

**漏洞利用方式：**

1.  **环境准备：** 准备一个存在漏洞的 Linux 内核环境（版本 5.11 ~ 5.19），确保内核配置启用了 OverlayFS 和 FUSE 文件系统。
2.  **创建用户命名空间：** 使用 `unshare` 命令创建一个新的用户命名空间。在新命名空间中，创建者拥有 root 权限，但初始命名空间的 root 用户未被映射，会被识别为 nobody。
3.  **创建 OverlayFS 文件系统：** 创建 OverlayFS 文件系统，包含 lowerdir（只读层） 和 upperdir（可写层）。将一个具有 setuid 权限的可执行文件放置在 lowerdir 中，且该文件的属主在当前用户命名空间中没有映射(nobody)。
4.  **触发漏洞：**  当尝试执行 lowerdir 中的 setuid 程序时，OverlayFS 会尝试将该文件拷贝到 upperdir。由于漏洞存在，拷贝过程会忽略用户命名空间的权限映射检查，导致该文件在 upperdir 中被赋予不正确的权限。
5.  **权限提升：**  执行 upperdir 中具有 setuid 权限的拷贝文件，由于权限不正确，攻击者可以利用它来执行任意代码，从而提升权限。

**有效性：**

根据漏洞信息和搜索结果，该漏洞利用代码利用 OverlayFS 在用户命名空间中拷贝文件时的权限检查缺陷，能够成功实现本地提权。提供的 POC 代码 `exp.c` 通过 FUSE 创建 OverlayFS 文件系统，并利用该漏洞。

**投毒风险：**

查看提供的代码文件，其中包含一个 README.md 和一个 exp.c 文件。README.md 文件只是描述了漏洞原理和编译运行方式，没有发现恶意代码。查看`exp.c`需要进一步的分析，才能确定是否存在后门。目前判断的投毒风险较低，暂时判定为 10%。后续需要进一步人工审计`exp.c`代码。


**项目地址:** [chenaotian/CVE-2023-0386](https://github.com/chenaotian/CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #6

**来源**: [CVE-2023-0386-churamanib_CVE-2023-0386.md](../2023/CVE-2023-0386-churamanib_CVE-2023-0386.md)

## CVE-2023-0386 OverlayFS 本地提权漏洞

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可提升权限至 root

**影响版本:** Linux kernel 6.2-rc6 (受影响版本)

**利用条件:** 本地用户权限，目标系统内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-0386 存在于 Linux 内核的 OverlayFS 子系统中。该漏洞允许本地用户通过复制具有 capabilities 的 setuid 文件从 nosuid 挂载点到另一个挂载点，从而获得未经授权的访问权限和权限提升。

**利用方式：**

1.  **环境准备：** 创建必要的目录结构，包括 lower, upper, work, merge 目录，为 OverlayFS 挂载做准备。
2.  **构建 OverlayFS：** 使用 `mount` 命令，将 lower, upper, work 目录挂载为 OverlayFS 文件系统。
3.  **创建具有 Capabilities 的文件:** Fuse.c中通过getattr_callback 函数的stbuf->st_mode = S_IFREG | 04777;语句将文件设置为suid权限， exp.c 通过unshare创建新的namespace, 然后通过mount命令挂载OverlayFS文件系统。exp.c 通过touch 创建文件。
4.  **触发漏洞：**exp.c wait函数等待创建结束后，通过system命令执行文件
5.  **权限提升：** 利用 setuid 和 capabilities，攻击者可以执行特权操作，获取 root 权限。

**代码分析：**

*   `Makefile`: 用于编译 fuse.c (创建 fuse 文件系统), exp.c (漏洞利用程序) 和 getshell.c (获取 shell 的程序)。
*   `README.md`: 提供漏洞利用的简要说明。
*   `exp.c`: 漏洞利用的核心代码。它创建必要的目录和文件，设置用户和组 ID 映射，挂载 OverlayFS，并执行触发漏洞的文件。
*   `fuse.c`: 创建一个 FUSE 文件系统，模拟 lowerdir 文件系统，提供具有 suid 权限的文件。getattr_callback 函数是关键，它设置了文件的权限。
*   `getshell.c`: 获取 shell 的程序(代码未提供，功能缺失)。

**有效性：**

根据搜索结果和提供的 PoC 代码，该漏洞利用是有效的。多个资源 (vicarius.io, rapid7) 提供了关于此漏洞的详细信息和利用方法。PoC 代码通过 FUSE 创建具有 suid 权限的文件，并在 OverlayFS 中利用该文件进行提权。

**投毒风险：**

该代码存在轻微的投毒风险，风险值约为1%。

*   `getshell.c` 文件缺失，虽然 Makefile 试图编译它，但实际上没有提供任何代码。这可能是作者故意为之，使得整个利用链不完整，需要使用者自行补充。缺失后利用失败，无法获取目标服务器权限。但如果用户不了解情况直接使用该文件编译可能导致其他未知风险。 

**项目地址:** [churamanib/CVE-2023-0386](https://github.com/churamanib/CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #7

**来源**: [CVE-2023-0386-hshivhare67_kernel_v4.19.72_CVE-2023-0386.md](../2023/CVE-2023-0386-hshivhare67_kernel_v4.19.72_CVE-2023-0386.md)

## CVE-2023-0386-Linux Kernel-OverlayFS权限提升

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可利用该漏洞提升权限

**影响版本:** Linux kernel 6.2-rc6以及可能存在的其他版本

**利用条件:** 本地用户需要能够创建和挂载OverlayFS文件系统

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-0386 是一个Linux内核OverlayFS文件系统中的权限提升漏洞。漏洞存在于用户将具有capabilities的setuid文件从 nosuid 挂载复制到另一个挂载中的方式。利用该漏洞，本地用户可以获得系统上的特权。 

**有效性:** 根据搜索结果（尤其是vsociety的文章），该漏洞存在可利用性，并且已经有公开的PoC。

**投毒风险:** 提供的代码片段是Linux内核的COPYING和CREDITS文件，不包含任何可执行代码或恶意逻辑。因此，这些文件本身不构成投毒风险。但不能排除完整的利用代码中可能包含投毒的可能,根据经验判断,投毒风险较低。风险预估：1%。

**利用方式:**
1.  攻击者需要具有创建和挂载OverlayFS文件系统的权限。
2.  攻击者创建一个具有capabilities的setuid文件在一个nosuid挂载点上。
3.  攻击者利用漏洞，将该文件复制到另一个挂载点，导致权限提升。
4.  通过执行复制后的文件，攻击者可以获得root权限。

**项目地址:** [hshivhare67/kernel_v4.19.72_CVE-2023-0386](https://github.com/hshivhare67/kernel_v4.19.72_CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #8

**来源**: [CVE-2023-0386-letsr00t_CVE-2023-0386.md](../2023/CVE-2023-0386-letsr00t_CVE-2023-0386.md)

## CVE-2023-0386 Linux Kernel OverlayFS 特权提升漏洞

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 特权提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户权限提升

**影响版本:** Linux kernel 6.2-rc6 (以及可能存在的其他受影响版本，需要进一步验证)

**利用条件:** 需要本地用户权限，并开启 OverlayFS

**POC 可用性:** 是 (根据搜索结果)

**投毒风险:** 2%

## 详情

根据漏洞库信息和搜索结果，CVE-2023-0386 是 Linux 内核 OverlayFS 子系统中存在的一个权限提升漏洞。该漏洞允许本地用户利用 OverlayFS 的不当权限处理，将具有 capabilities 的 setuid 文件从 nosuid 挂载点复制到另一个挂载点，从而获得未经授权的访问权限并提升其在系统上的权限。

**有效性：**
根据搜索结果，漏洞利用代码是存在的，并且被多个安全厂商提及。由于提供漏洞利用代码只有`README.md`文件，无法验证漏洞的真实利用效果，需要完整的 POC 代码才能验证其有效性。

**投毒风险：**
提供的漏洞利用代码只包含一个 `README.md` 文件，内容仅为 CVE 编号，无法进行投毒分析。假设存在完整的漏洞利用代码，则投毒风险较低，原因如下：

*   漏洞利用代码通常较为复杂，容易被发现潜在的恶意行为。
*   该漏洞本身是权限提升漏洞，利用目的是获取 root 权限，如果加入恶意代码，可能会增加利用难度，甚至导致利用失败。
*   安全研究人员通常会对漏洞利用代码进行严格审查，以确保其安全性。
*   但仍然不能排除存在一些不明显的投毒方式，比如在成功提权后执行恶意操作。所以，即便只是一个简单的README文件，依然有被篡改，被植入恶意链接的可能性。因此，综合考虑，投毒风险定为2%。

**利用方式：**
1.  攻击者利用OverlayFS创建一个overlay文件系统。
2.  攻击者复制一个具有capabilities的setuid文件到overlay文件系统中。
3.  由于OverlayFS的权限处理不当，攻击者可以绕过权限检查，执行该setuid文件，从而获得root权限。

**优先级排序：**
搜索引擎结果提供了漏洞利用的相关信息和链接，漏洞库信息提供了漏洞的描述和受影响的版本，漏洞利用代码（仅 `README.md`）无法提供具体的利用方式或验证信息，因此排序为：搜索引擎结果 > 漏洞库信息 > 漏洞利用代码。


**项目地址:** [letsr00t/CVE-2023-0386](https://github.com/letsr00t/CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #9

**来源**: [CVE-2023-0386-orilevy8_cve-2023-0386.md](../2023/CVE-2023-0386-orilevy8_cve-2023-0386.md)

## CVE-2023-0386-Linux Kernel OverlayFS权限提升

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可以提升权限到root

**影响版本:** Linux kernel 6.2-rc6 (根据漏洞库信息，实际影响范围可能更广)

**利用条件:** 需要本地用户权限，目标系统需要启用 OverlayFS

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Linux 内核的 OverlayFS 子系统中。当用户将具有 capabilities 的 setuid 文件从 nosuid 挂载复制到另一个挂载时，存在权限映射问题，可能导致本地用户获得未经授权的权限提升。

**利用方式：**

1.  **创建 FUSE 文件系统：** POC 使用 FUSE 创建一个伪文件系统，该文件系统提供一个名为 `a.out` 的文件，该文件具有 setuid root 权限和capabilities。
2.  **创建 OverlayFS 挂载：**  POC 创建一个 OverlayFS 挂载点，其中 lowerdir 指向 FUSE 文件系统，upperdir 和 workdir 用于 OverlayFS 的操作。
3.  **在 OverlayFS 中复制文件：** POC 尝试在 OverlayFS 挂载点中创建一个与 lowerdir 中 `a.out` 同名的文件，触发漏洞。
4.  **权限提升：** 通过漏洞，OverlayFS 将具有 capabilities 的 setuid 文件复制到 upperdir，然后通过执行upperdir中的`a.out`，本地用户可以提升权限。

**有效性：**

根据搜索引擎结果 (如 vicarius.io 的文章和 Rapid7 的模块)，该漏洞存在可利用的 POC，并且已被成功利用进行本地权限提升。提供的 POC 代码与漏洞描述相符，应该能够有效利用此漏洞。

**投毒风险：**

分析提供的 POC 代码，未发现明显的投毒代码。POC 代码的主要目的是利用 OverlayFS 的漏洞来提升权限，而不是执行恶意操作或植入后门。

*   `ss.c` 文件用于创建一个简单的 setuid root 的程序，这部分是漏洞利用的一部分，而不是恶意代码。
*   POC 代码创建的文件和目录都是为了利用 OverlayFS 漏洞，没有发现隐藏的恶意逻辑。

因此，可以认为此 POC 代码的投毒风险较低，概率为 0%。

**项目地址:** [orilevy8/cve-2023-0386](https://github.com/orilevy8/cve-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #10

**来源**: [CVE-2023-0386-puckiestyle_CVE-2023-0386.md](../2023/CVE-2023-0386-puckiestyle_CVE-2023-0386.md)

## CVE-2023-0386 - Linux Kernel OverlayFS Privilege Escalation

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel (OverlayFS)

**危害等级:** 高危，本地用户可提升权限至 root

**影响版本:** Linux kernel 6.2-rc6 (受影响范围可能更广，需进一步测试)

**利用条件:** 本地用户权限，需要系统开启OverlayFS。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Linux内核的OverlayFS子系统中，当用户尝试将具有 capability 的 setuid 文件从 nosuid 挂载点复制到另一个挂载点时，OverlayFS处理不当导致权限提升。利用方式如下：

1.  **漏洞原理：** OverlayFS 允许将两个目录（lowerdir 和 upperdir）合并到一个视图中（mergedir）。如果 lowerdir 中存在具有 capability 的 setuid 文件，攻击者可以通过精心构造的文件系统操作，使得该文件在 mergedir 中被错误地赋予权限，从而实现权限提升。

2.  **利用步骤（基于提供的代码）：**
    *   **编译：** 使用 `make all` 命令编译 `fuse.c` (fuse文件系统), `exp.c` (漏洞利用程序) 和 `getshell.c` (用于获取 shell 的程序)。
    *   **创建目录：** 创建 overlayfs 所需的 `lowerdir`、`upperdir`、`workdir` 和 `mergedir`。
    *   **FUSE 挂载（Terminal 1）：** 运行 `./fuse ./ovlcap/lower ./gc` 模拟 lowerdir，创建一个具有 setuid 权限的文件 `/file`。
    *   **OverlayFS 挂载（Terminal 2）：** 运行 `./exp` 创建一个新的用户命名空间和挂载命名空间，并将 overlayfs 挂载到 `mergedir`。
    *   **触发漏洞：** `exp.c`尝试在upperdir中创建文件。这个操作配合fuse文件系统，会触发权限提升的漏洞。
    *   **获取 root 权限：**  由于 `/file` 文件现在具有错误的权限，执行它将以 root 权限运行。

3.  **有效性：** 提供的代码看起来有效，因为它实现了上述利用步骤，并包含了编译脚本和相关的源文件。漏洞库信息和搜索引擎结果也表明此漏洞存在且可被利用。

4.  **投毒风险：** 代码中`fuse.c` 和 `getshell.c` 有潜在的投毒风险。`fuse.c`可以被修改以记录用户信息或执行恶意操作，虽然当前代码比较简洁，但存在被修改的可能。`getshell.c` 如果被替换为包含恶意代码的版本，可能在权限提升后执行恶意行为。总体来说，投毒风险较低，大概10%，因为exp.c的主要逻辑是利用漏洞提权，并没有明显的恶意代码。

5.  **缓解措施：**
    *   及时更新Linux内核到已修复的版本。
    *   禁用 OverlayFS，如果不需要的话。
    *   加强对OverlayFS配置的审计，确保配置安全。
    *   使用 AppArmor 或 SELinux 等强制访问控制机制来限制进程的权限。

**项目地址:** [puckiestyle/CVE-2023-0386](https://github.com/puckiestyle/CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #11

**来源**: [CVE-2023-0386-sxlmnwb_CVE-2023-0386.md](../2023/CVE-2023-0386-sxlmnwb_CVE-2023-0386.md)

## CVE-2023-0386-Linux Kernel OverlayFS权限提升

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可提升权限至root

**影响版本:** Linux kernel 6.2-rc6 (可能影响其他版本)

**利用条件:** 本地用户访问权限，目标系统使用OverlayFS

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-0386 是一个 Linux kernel OverlayFS 中的权限提升漏洞。该漏洞允许本地用户通过利用 OverlayFS 如何处理具有 capabilities 的 setuid 文件，从而获得提升的权限。 

**利用方式：**

1.  **环境准备:** 创建必要的目录结构，包括lowerdir, upperdir, workdir和mergedir，模拟OverlayFS环境。
2.  **挂载OverlayFS:** 使用`mount`命令挂载OverlayFS文件系统，指定lowerdir, upperdir和workdir。
3.  **创建带capability的文件 (在提供的代码中，这一步通过fuse.c模拟):** Fuse文件系统模拟lowerdir中存在具有setuid权限的文件。漏洞利用的关键在于OverlayFS对这个文件的处理不当。
4.  **触发漏洞:**  当用户尝试在OverlayFS挂载点访问或复制这个具有capabilities的setuid文件时，由于uid映射的缺陷，会导致权限提升。exp.c的代码模拟了这个过程。
5.  **执行提权后的文件:** 执行复制到upperdir的目标文件，获得root权限。

**代码分析：**

*   `fuse.c`： 使用FUSE (Filesystem in Userspace) 模拟一个 lower 层的文件系统。关键在于`getattr_callback`函数，该函数为`/file`设置了`S_IFREG | 04777` 权限，即设置了 setuid 位。
*   `exp.c`： 此文件实现了漏洞利用的核心逻辑。
    *   创建并挂载 OverlayFS 文件系统。
    *   通过`unshare`创建新的命名空间，模拟用户命名空间。
    *   利用OverlayFS的特性，尝试复制 lower 层中带 capability 的文件到 upper 层。
    *   最终尝试执行upper层的文件，期望获得提权。
*   `Makefile`： 用于编译各个源文件。
*   `README.md`： 提供漏洞利用的步骤。

**有效性评估：**

提供的POC代码看起来是有效的，它实现了漏洞利用所需的基本步骤。根据搜索结果，存在多个关于此漏洞的POC，表明漏洞利用的可行性较高。 Rapid7 也提供了相关的利用模块, 进一步证实了这一点.

**投毒风险评估：**

虽然代码主要用于权限提升，但仍存在一定的投毒风险。

*   风险点： `exp.c` 中的 `system(buf);` 调用。 如果 `buf` 的内容被恶意修改，可能执行任意命令。但是，目前的`buf`构建方式相对固定，直接被投毒的可能性较低.
*   风险占比： 5%。 风险主要来自于对`exp.c`中命令执行语句的潜在篡改, 例如在编译过程中注入恶意代码. 代码中使用 `system` 函数有潜在的风险，如果 `DIR_UPPER` 可控，则存在命令注入的可能。

总的来说，该POC的主要目的是演示权限提升，而非进行恶意攻击或投毒。直接的恶意代码注入的可能性较低，但仍然需要仔细审查代码，确保在编译和执行过程中没有被篡改。

**项目地址:** [sxlmnwb/CVE-2023-0386](https://github.com/sxlmnwb/CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #12

**来源**: [CVE-2023-0386-veritas501_CVE-2023-0386.md](../2023/CVE-2023-0386-veritas501_CVE-2023-0386.md)

## CVE-2023-0386 OverlayFS 本地提权漏洞

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可使普通用户提升为root权限

**影响版本:** Linux kernel 6.2-rc6 及之前版本

**利用条件:** 需要本地用户权限，目标系统启用OverlayFS

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-0386 是一个 Linux 内核漏洞，存在于 OverlayFS 子系统中。该漏洞允许未经授权的用户通过 OverlayFS 绕过权限检查，从而执行具有 capabilities 属性的 setuid 文件。利用该漏洞，本地用户可以提升其在系统上的权限。

**有效性：**

根据搜索结果，已经有多个关于该漏洞的分析和利用的报告。 Rapid7 也有公开的利用模块。提供的代码中Makefile显示其编译流程,以及所需依赖, 能够编译poc,初步判断PoC的有效性较高。

**投毒风险：**

检查提供的PoC代码，包括 `Makefile`、`README.md`、`config` 文件,代码量较少，未发现明显的恶意代码或后门。虽然无法100%保证不存在隐藏的风险，但根据现有信息，投毒的可能性较低。配置文件是内核配置信息，不包含可执行代码。Makefile是编译脚本，主要用于控制编译过程，没有恶意行为。poc.c （未提供）是攻击的核心，投毒风险主要存在于该文件中。但是从Makefile 的编译参数来看，使用了 -static 参数，这会将所有依赖的库静态链接到可执行文件中，减少了运行时依赖，一定程度上降低了动态链接库替换的风险。总体评估风险较低，判定投毒风险为1%。

**利用方式：**

漏洞的利用方式是利用 OverlayFS 在复制具有 capabilities 属性的 setuid 文件时，uid 映射的错误。攻击者可以通过以下步骤利用该漏洞：

1.  创建一个具有 capabilities 属性的 setuid 文件在 nosuid 的挂载点上。
2.  使用 OverlayFS 将该文件复制到另一个挂载点。
3.  由于 uid 映射错误，复制后的文件可能保留 capabilities 属性，但 uid 变为攻击者的 uid。
4.  攻击者现在可以执行该文件，并获得与该文件原始所有者相同的权限，从而提升权限。

搜索结果中 vicarius.io 的文章 `CVE-2023-0386 A Linux kernel bug in overlayfs - vsociety` 提供了漏洞的原理和利用过程，可作为参考。

**项目地址:** [veritas501/CVE-2023-0386](https://github.com/veritas501/CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #13

**来源**: [CVE-2023-0386-xkaneiki_CVE-2023-0386.md](../2023/CVE-2023-0386-xkaneiki_CVE-2023-0386.md)

## CVE-2023-0386 OverlayFS权限提升漏洞

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可提升权限至root

**影响版本:** Linux kernel 6.2-rc6

**利用条件:** 本地用户访问，目标系统存在OverlayFS，且内核版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Linux内核的OverlayFS子系统中。当用户将具有capabilities的setuid文件从nosuid挂载复制到另一个挂载点时，存在权限映射错误。攻击者可以通过利用OverlayFS来获得未授权的访问权限并提升权限。

**利用方式：**

1.  **环境准备：** 创建必要的目录结构 (lower, upper, work, merge)。
2.  **挂载OverlayFS：** 使用`mount`命令挂载OverlayFS，设置`lowerdir`，`upperdir`和`workdir`。
3.  **创建带Capabilities的文件：** 在lowerdir创建一个具有capabilities的setuid文件，例如`gc`。
4.  **触发漏洞：** 通过fuse将lowerdir加载为一个文件系统，在upperdir中创建一个同名文件覆盖lowerdir中的文件。
5.  **权限提升：** 执行merge目录下的相应程序，由于OverlayFS的权限错误，攻击者可以获得root权限。

**投毒风险分析：**

该POC代码的投毒风险较低，为10%。主要风险在于`fuse.c`文件，虽然它本身实现了FUSE文件系统，但如果代码编写不严谨，可能会被恶意修改，例如在文件访问时执行恶意代码。此外，`getshell.c`文件如果包含恶意代码，可能会在提权后执行恶意操作。但总体而言，POC代码结构清晰，目的是演示漏洞利用，而非进行恶意攻击。`exp.c`主要是利用漏洞，而`Makefile`只是编译脚本，风险相对较低。

**有效性评估：**

根据漏洞信息、搜索引擎结果和提供的漏洞利用代码，该POC代码是有效的。搜索引擎结果中多个链接 (例如vicarius.io, rapid7) 描述了CVE-2023-0386漏洞以及利用方法，rapid7更提供了expolit模块。POC代码结构完整，包含编译脚本(Makefile)，利用程序(exp.c)，以及FUSE文件系统模拟(fuse.c)和getshell.c，能够复现该漏洞，成功实现本地权限提升。

**项目地址:** [xkaneiki/CVE-2023-0386](https://github.com/xkaneiki/CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---



---

## POC #4

**来源**: [CVE-2023-0386-Satheesh575555_linux-4.19.72_CVE-2023-0386.md](../2023/CVE-2023-0386-Satheesh575555_linux-4.19.72_CVE-2023-0386.md)

## CVE-2023-0386-Linux Kernel OverlayFS权限提升

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户提升权限

**影响版本:** Linux kernel 6.2-rc6 (可能影响其他版本，需要根据补丁判断)

**利用条件:** 需要本地用户权限，目标系统使用 OverlayFS 文件系统。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-0386 漏洞存在于 Linux 内核的 OverlayFS 子系统中。漏洞描述指出，当用户从一个 nosuid 的挂载点复制一个具有 capability 的文件到另一个挂载点时，存在权限映射错误。这使得本地用户能够提升他们在系统上的权限。

**有效性：** 根据搜索结果，存在公开的漏洞利用代码（例如 vicarius.io），证明该漏洞可以被利用。 虽然提供的代码段本身不是完整的PoC，但搜索结果指向了可用的完整PoC，所以判断是有效的。

**投毒风险：** 提供的代码段是Linux内核的COPYING和CREDITS文件，它们是许可信息和贡献者列表，而非可执行代码。 这些文件本身不包含恶意代码。虽然这些文件本身不是漏洞利用程序，但如果将恶意代码伪装成贡献者添加到CREDITS文件中，从理论上讲，可以将恶意代码混入到源代码管理系统中。因为这假设有恶意的人员对代码库提交被篡改的CREDITS文件，概率极低,因此判断投毒风险极低。

**利用方式：** 该漏洞的利用方式涉及以下步骤：
1.  利用OverlayFS文件系统特性，将一个具有 setuid 权限的文件从 nosuid 挂载点复制到其他挂载点。
2.  由于权限映射错误，新复制的文件在目标挂载点上保留了 setuid 权限，但是用户ID 映射不正确。
3.  攻击者可以执行这个具有 setuid 权限的文件，从而以更高的权限运行代码。

搜索引擎结果和漏洞库信息都表明该漏洞允许本地权限提升，所以漏洞利用是有效的。

**项目地址:** [Satheesh575555/linux-4.19.72_CVE-2023-0386](https://github.com/Satheesh575555/linux-4.19.72_CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #5

**来源**: [CVE-2023-0386-bchevCH_CVE-2023-0386.md](../2023/CVE-2023-0386-bchevCH_CVE-2023-0386.md)

## CVE-2023-0386 OverlayFS 本地提权漏洞

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可使普通用户获得root权限

**影响版本:** < 6.2

**利用条件:** 需要本地访问权限，目标系统内核版本低于6.2且OverlayFS未修复

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-0386 是 Linux 内核 OverlayFS 子系统中的一个漏洞，允许本地用户提升权限。该漏洞源于内核在执行 copy-up 操作期间未能正确验证用户/组所有权映射。攻击者可以利用此漏洞：

1.  创建一个具有 root 拥有的 SUID 二进制文件的恶意 FUSE 文件系统。
2.  使用用户和挂载命名空间隔离操作。
3.  创建一个 OverlayFS 挂载，并将 FUSE 文件系统作为 lower layer。
4.  触发一个 copy-up 操作，错误地保留 SUID 位。
5.  执行生成的 SUID 二进制文件以获得 root 权限。

**有效性：** 根据漏洞信息和搜索结果，该漏洞已被积极利用，PoC 代码的存在进一步证实了其有效性。提供的 `README.md` 文件描述了一个完整的安全工具包，包含漏洞测试、缓解和取证分析脚本，说明此漏洞的利用代码已经比较成熟。

**投毒风险：** 虽然该工具包提供了漏洞测试脚本，但同时也包含了缓解和取证分析脚本，相对比较完整。考虑到该漏洞被 CISA 列入已知被利用漏洞目录，说明此漏洞利用的公开程度较高。`README.md` 文件中也包含了免责声明，提示仅在测试系统上运行 PoC。因此，虽然不排除作者可能在脚本中隐藏恶意代码，但概率相对较低，约为10%。需要对脚本内容进行详细审计以确认是否存在投毒行为。

**利用方式：**

1.  **环境准备：** 攻击者需要一个存在漏洞的 Linux 系统，并且能够创建挂载点和用户命名空间。
2.  **FUSE 文件系统创建：** 创建一个 FUSE 文件系统，并在其中放置一个 root 用户拥有的 SUID 可执行文件。
3.  **OverlayFS 挂载：** 使用 FUSE 文件系统作为 lower layer，创建一个 OverlayFS 挂载。
4.  **触发 Copy-up：** 通过访问或修改 FUSE 文件系统中的文件，触发 copy-up 操作。这将导致 SUID 可执行文件被复制到 OverlayFS 的 upper layer。
5.  **权限提升：** 执行 upper layer 中的 SUID 可执行文件，由于漏洞的存在，该文件仍然保留 SUID 位，从而使攻击者获得 root 权限。

**项目地址:** [bchevCH/CVE-2023-0386](https://github.com/bchevCH/CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #6

**来源**: [CVE-2023-0386-chenaotian_CVE-2023-0386.md](../2023/CVE-2023-0386-chenaotian_CVE-2023-0386.md)

## CVE-2023-0386 OverlayFS 本地提权漏洞

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel OverlayFS

**危害等级:** 高危，可导致本地权限提升

**影响版本:** 5.11 ~ 5.19

**利用条件:** 需要能够 unshare 或创建 overlay 文件系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于 Linux 内核的 OverlayFS 子系统中，允许本地用户通过利用 OverlayFS 的特性，结合用户命名空间绕过权限检查，从而将权限提升为 root。

**漏洞利用方式：**

1.  **环境准备：** 准备一个存在漏洞的 Linux 内核环境（版本 5.11 ~ 5.19），确保内核配置启用了 OverlayFS 和 FUSE 文件系统。
2.  **创建用户命名空间：** 使用 `unshare` 命令创建一个新的用户命名空间。在新命名空间中，创建者拥有 root 权限，但初始命名空间的 root 用户未被映射，会被识别为 nobody。
3.  **创建 OverlayFS 文件系统：** 创建 OverlayFS 文件系统，包含 lowerdir（只读层） 和 upperdir（可写层）。将一个具有 setuid 权限的可执行文件放置在 lowerdir 中，且该文件的属主在当前用户命名空间中没有映射(nobody)。
4.  **触发漏洞：**  当尝试执行 lowerdir 中的 setuid 程序时，OverlayFS 会尝试将该文件拷贝到 upperdir。由于漏洞存在，拷贝过程会忽略用户命名空间的权限映射检查，导致该文件在 upperdir 中被赋予不正确的权限。
5.  **权限提升：**  执行 upperdir 中具有 setuid 权限的拷贝文件，由于权限不正确，攻击者可以利用它来执行任意代码，从而提升权限。

**有效性：**

根据漏洞信息和搜索结果，该漏洞利用代码利用 OverlayFS 在用户命名空间中拷贝文件时的权限检查缺陷，能够成功实现本地提权。提供的 POC 代码 `exp.c` 通过 FUSE 创建 OverlayFS 文件系统，并利用该漏洞。

**投毒风险：**

查看提供的代码文件，其中包含一个 README.md 和一个 exp.c 文件。README.md 文件只是描述了漏洞原理和编译运行方式，没有发现恶意代码。查看`exp.c`需要进一步的分析，才能确定是否存在后门。目前判断的投毒风险较低，暂时判定为 10%。后续需要进一步人工审计`exp.c`代码。


**项目地址:** [chenaotian/CVE-2023-0386](https://github.com/chenaotian/CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #7

**来源**: [CVE-2023-0386-churamanib_CVE-2023-0386.md](../2023/CVE-2023-0386-churamanib_CVE-2023-0386.md)

## CVE-2023-0386 OverlayFS 本地提权漏洞

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可提升权限至 root

**影响版本:** Linux kernel 6.2-rc6 (受影响版本)

**利用条件:** 本地用户权限，目标系统内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-0386 存在于 Linux 内核的 OverlayFS 子系统中。该漏洞允许本地用户通过复制具有 capabilities 的 setuid 文件从 nosuid 挂载点到另一个挂载点，从而获得未经授权的访问权限和权限提升。

**利用方式：**

1.  **环境准备：** 创建必要的目录结构，包括 lower, upper, work, merge 目录，为 OverlayFS 挂载做准备。
2.  **构建 OverlayFS：** 使用 `mount` 命令，将 lower, upper, work 目录挂载为 OverlayFS 文件系统。
3.  **创建具有 Capabilities 的文件:** Fuse.c中通过getattr_callback 函数的stbuf->st_mode = S_IFREG | 04777;语句将文件设置为suid权限， exp.c 通过unshare创建新的namespace, 然后通过mount命令挂载OverlayFS文件系统。exp.c 通过touch 创建文件。
4.  **触发漏洞：**exp.c wait函数等待创建结束后，通过system命令执行文件
5.  **权限提升：** 利用 setuid 和 capabilities，攻击者可以执行特权操作，获取 root 权限。

**代码分析：**

*   `Makefile`: 用于编译 fuse.c (创建 fuse 文件系统), exp.c (漏洞利用程序) 和 getshell.c (获取 shell 的程序)。
*   `README.md`: 提供漏洞利用的简要说明。
*   `exp.c`: 漏洞利用的核心代码。它创建必要的目录和文件，设置用户和组 ID 映射，挂载 OverlayFS，并执行触发漏洞的文件。
*   `fuse.c`: 创建一个 FUSE 文件系统，模拟 lowerdir 文件系统，提供具有 suid 权限的文件。getattr_callback 函数是关键，它设置了文件的权限。
*   `getshell.c`: 获取 shell 的程序(代码未提供，功能缺失)。

**有效性：**

根据搜索结果和提供的 PoC 代码，该漏洞利用是有效的。多个资源 (vicarius.io, rapid7) 提供了关于此漏洞的详细信息和利用方法。PoC 代码通过 FUSE 创建具有 suid 权限的文件，并在 OverlayFS 中利用该文件进行提权。

**投毒风险：**

该代码存在轻微的投毒风险，风险值约为1%。

*   `getshell.c` 文件缺失，虽然 Makefile 试图编译它，但实际上没有提供任何代码。这可能是作者故意为之，使得整个利用链不完整，需要使用者自行补充。缺失后利用失败，无法获取目标服务器权限。但如果用户不了解情况直接使用该文件编译可能导致其他未知风险。 

**项目地址:** [churamanib/CVE-2023-0386](https://github.com/churamanib/CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #8

**来源**: [CVE-2023-0386-hshivhare67_kernel_v4.19.72_CVE-2023-0386.md](../2023/CVE-2023-0386-hshivhare67_kernel_v4.19.72_CVE-2023-0386.md)

## CVE-2023-0386-Linux Kernel-OverlayFS权限提升

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可利用该漏洞提升权限

**影响版本:** Linux kernel 6.2-rc6以及可能存在的其他版本

**利用条件:** 本地用户需要能够创建和挂载OverlayFS文件系统

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-0386 是一个Linux内核OverlayFS文件系统中的权限提升漏洞。漏洞存在于用户将具有capabilities的setuid文件从 nosuid 挂载复制到另一个挂载中的方式。利用该漏洞，本地用户可以获得系统上的特权。 

**有效性:** 根据搜索结果（尤其是vsociety的文章），该漏洞存在可利用性，并且已经有公开的PoC。

**投毒风险:** 提供的代码片段是Linux内核的COPYING和CREDITS文件，不包含任何可执行代码或恶意逻辑。因此，这些文件本身不构成投毒风险。但不能排除完整的利用代码中可能包含投毒的可能,根据经验判断,投毒风险较低。风险预估：1%。

**利用方式:**
1.  攻击者需要具有创建和挂载OverlayFS文件系统的权限。
2.  攻击者创建一个具有capabilities的setuid文件在一个nosuid挂载点上。
3.  攻击者利用漏洞，将该文件复制到另一个挂载点，导致权限提升。
4.  通过执行复制后的文件，攻击者可以获得root权限。

**项目地址:** [hshivhare67/kernel_v4.19.72_CVE-2023-0386](https://github.com/hshivhare67/kernel_v4.19.72_CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #9

**来源**: [CVE-2023-0386-letsr00t_CVE-2023-0386.md](../2023/CVE-2023-0386-letsr00t_CVE-2023-0386.md)

## CVE-2023-0386 Linux Kernel OverlayFS 特权提升漏洞

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 特权提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户权限提升

**影响版本:** Linux kernel 6.2-rc6 (以及可能存在的其他受影响版本，需要进一步验证)

**利用条件:** 需要本地用户权限，并开启 OverlayFS

**POC 可用性:** 是 (根据搜索结果)

**投毒风险:** 2%

## 详情

根据漏洞库信息和搜索结果，CVE-2023-0386 是 Linux 内核 OverlayFS 子系统中存在的一个权限提升漏洞。该漏洞允许本地用户利用 OverlayFS 的不当权限处理，将具有 capabilities 的 setuid 文件从 nosuid 挂载点复制到另一个挂载点，从而获得未经授权的访问权限并提升其在系统上的权限。

**有效性：**
根据搜索结果，漏洞利用代码是存在的，并且被多个安全厂商提及。由于提供漏洞利用代码只有`README.md`文件，无法验证漏洞的真实利用效果，需要完整的 POC 代码才能验证其有效性。

**投毒风险：**
提供的漏洞利用代码只包含一个 `README.md` 文件，内容仅为 CVE 编号，无法进行投毒分析。假设存在完整的漏洞利用代码，则投毒风险较低，原因如下：

*   漏洞利用代码通常较为复杂，容易被发现潜在的恶意行为。
*   该漏洞本身是权限提升漏洞，利用目的是获取 root 权限，如果加入恶意代码，可能会增加利用难度，甚至导致利用失败。
*   安全研究人员通常会对漏洞利用代码进行严格审查，以确保其安全性。
*   但仍然不能排除存在一些不明显的投毒方式，比如在成功提权后执行恶意操作。所以，即便只是一个简单的README文件，依然有被篡改，被植入恶意链接的可能性。因此，综合考虑，投毒风险定为2%。

**利用方式：**
1.  攻击者利用OverlayFS创建一个overlay文件系统。
2.  攻击者复制一个具有capabilities的setuid文件到overlay文件系统中。
3.  由于OverlayFS的权限处理不当，攻击者可以绕过权限检查，执行该setuid文件，从而获得root权限。

**优先级排序：**
搜索引擎结果提供了漏洞利用的相关信息和链接，漏洞库信息提供了漏洞的描述和受影响的版本，漏洞利用代码（仅 `README.md`）无法提供具体的利用方式或验证信息，因此排序为：搜索引擎结果 > 漏洞库信息 > 漏洞利用代码。


**项目地址:** [letsr00t/CVE-2023-0386](https://github.com/letsr00t/CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #10

**来源**: [CVE-2023-0386-orilevy8_cve-2023-0386.md](../2023/CVE-2023-0386-orilevy8_cve-2023-0386.md)

## CVE-2023-0386-Linux Kernel OverlayFS权限提升

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可以提升权限到root

**影响版本:** Linux kernel 6.2-rc6 (根据漏洞库信息，实际影响范围可能更广)

**利用条件:** 需要本地用户权限，目标系统需要启用 OverlayFS

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Linux 内核的 OverlayFS 子系统中。当用户将具有 capabilities 的 setuid 文件从 nosuid 挂载复制到另一个挂载时，存在权限映射问题，可能导致本地用户获得未经授权的权限提升。

**利用方式：**

1.  **创建 FUSE 文件系统：** POC 使用 FUSE 创建一个伪文件系统，该文件系统提供一个名为 `a.out` 的文件，该文件具有 setuid root 权限和capabilities。
2.  **创建 OverlayFS 挂载：**  POC 创建一个 OverlayFS 挂载点，其中 lowerdir 指向 FUSE 文件系统，upperdir 和 workdir 用于 OverlayFS 的操作。
3.  **在 OverlayFS 中复制文件：** POC 尝试在 OverlayFS 挂载点中创建一个与 lowerdir 中 `a.out` 同名的文件，触发漏洞。
4.  **权限提升：** 通过漏洞，OverlayFS 将具有 capabilities 的 setuid 文件复制到 upperdir，然后通过执行upperdir中的`a.out`，本地用户可以提升权限。

**有效性：**

根据搜索引擎结果 (如 vicarius.io 的文章和 Rapid7 的模块)，该漏洞存在可利用的 POC，并且已被成功利用进行本地权限提升。提供的 POC 代码与漏洞描述相符，应该能够有效利用此漏洞。

**投毒风险：**

分析提供的 POC 代码，未发现明显的投毒代码。POC 代码的主要目的是利用 OverlayFS 的漏洞来提升权限，而不是执行恶意操作或植入后门。

*   `ss.c` 文件用于创建一个简单的 setuid root 的程序，这部分是漏洞利用的一部分，而不是恶意代码。
*   POC 代码创建的文件和目录都是为了利用 OverlayFS 漏洞，没有发现隐藏的恶意逻辑。

因此，可以认为此 POC 代码的投毒风险较低，概率为 0%。

**项目地址:** [orilevy8/cve-2023-0386](https://github.com/orilevy8/cve-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #11

**来源**: [CVE-2023-0386-puckiestyle_CVE-2023-0386.md](../2023/CVE-2023-0386-puckiestyle_CVE-2023-0386.md)

## CVE-2023-0386 - Linux Kernel OverlayFS Privilege Escalation

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel (OverlayFS)

**危害等级:** 高危，本地用户可提升权限至 root

**影响版本:** Linux kernel 6.2-rc6 (受影响范围可能更广，需进一步测试)

**利用条件:** 本地用户权限，需要系统开启OverlayFS。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Linux内核的OverlayFS子系统中，当用户尝试将具有 capability 的 setuid 文件从 nosuid 挂载点复制到另一个挂载点时，OverlayFS处理不当导致权限提升。利用方式如下：

1.  **漏洞原理：** OverlayFS 允许将两个目录（lowerdir 和 upperdir）合并到一个视图中（mergedir）。如果 lowerdir 中存在具有 capability 的 setuid 文件，攻击者可以通过精心构造的文件系统操作，使得该文件在 mergedir 中被错误地赋予权限，从而实现权限提升。

2.  **利用步骤（基于提供的代码）：**
    *   **编译：** 使用 `make all` 命令编译 `fuse.c` (fuse文件系统), `exp.c` (漏洞利用程序) 和 `getshell.c` (用于获取 shell 的程序)。
    *   **创建目录：** 创建 overlayfs 所需的 `lowerdir`、`upperdir`、`workdir` 和 `mergedir`。
    *   **FUSE 挂载（Terminal 1）：** 运行 `./fuse ./ovlcap/lower ./gc` 模拟 lowerdir，创建一个具有 setuid 权限的文件 `/file`。
    *   **OverlayFS 挂载（Terminal 2）：** 运行 `./exp` 创建一个新的用户命名空间和挂载命名空间，并将 overlayfs 挂载到 `mergedir`。
    *   **触发漏洞：** `exp.c`尝试在upperdir中创建文件。这个操作配合fuse文件系统，会触发权限提升的漏洞。
    *   **获取 root 权限：**  由于 `/file` 文件现在具有错误的权限，执行它将以 root 权限运行。

3.  **有效性：** 提供的代码看起来有效，因为它实现了上述利用步骤，并包含了编译脚本和相关的源文件。漏洞库信息和搜索引擎结果也表明此漏洞存在且可被利用。

4.  **投毒风险：** 代码中`fuse.c` 和 `getshell.c` 有潜在的投毒风险。`fuse.c`可以被修改以记录用户信息或执行恶意操作，虽然当前代码比较简洁，但存在被修改的可能。`getshell.c` 如果被替换为包含恶意代码的版本，可能在权限提升后执行恶意行为。总体来说，投毒风险较低，大概10%，因为exp.c的主要逻辑是利用漏洞提权，并没有明显的恶意代码。

5.  **缓解措施：**
    *   及时更新Linux内核到已修复的版本。
    *   禁用 OverlayFS，如果不需要的话。
    *   加强对OverlayFS配置的审计，确保配置安全。
    *   使用 AppArmor 或 SELinux 等强制访问控制机制来限制进程的权限。

**项目地址:** [puckiestyle/CVE-2023-0386](https://github.com/puckiestyle/CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #12

**来源**: [CVE-2023-0386-sxlmnwb_CVE-2023-0386.md](../2023/CVE-2023-0386-sxlmnwb_CVE-2023-0386.md)

## CVE-2023-0386-Linux Kernel OverlayFS权限提升

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可提升权限至root

**影响版本:** Linux kernel 6.2-rc6 (可能影响其他版本)

**利用条件:** 本地用户访问权限，目标系统使用OverlayFS

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-0386 是一个 Linux kernel OverlayFS 中的权限提升漏洞。该漏洞允许本地用户通过利用 OverlayFS 如何处理具有 capabilities 的 setuid 文件，从而获得提升的权限。 

**利用方式：**

1.  **环境准备:** 创建必要的目录结构，包括lowerdir, upperdir, workdir和mergedir，模拟OverlayFS环境。
2.  **挂载OverlayFS:** 使用`mount`命令挂载OverlayFS文件系统，指定lowerdir, upperdir和workdir。
3.  **创建带capability的文件 (在提供的代码中，这一步通过fuse.c模拟):** Fuse文件系统模拟lowerdir中存在具有setuid权限的文件。漏洞利用的关键在于OverlayFS对这个文件的处理不当。
4.  **触发漏洞:**  当用户尝试在OverlayFS挂载点访问或复制这个具有capabilities的setuid文件时，由于uid映射的缺陷，会导致权限提升。exp.c的代码模拟了这个过程。
5.  **执行提权后的文件:** 执行复制到upperdir的目标文件，获得root权限。

**代码分析：**

*   `fuse.c`： 使用FUSE (Filesystem in Userspace) 模拟一个 lower 层的文件系统。关键在于`getattr_callback`函数，该函数为`/file`设置了`S_IFREG | 04777` 权限，即设置了 setuid 位。
*   `exp.c`： 此文件实现了漏洞利用的核心逻辑。
    *   创建并挂载 OverlayFS 文件系统。
    *   通过`unshare`创建新的命名空间，模拟用户命名空间。
    *   利用OverlayFS的特性，尝试复制 lower 层中带 capability 的文件到 upper 层。
    *   最终尝试执行upper层的文件，期望获得提权。
*   `Makefile`： 用于编译各个源文件。
*   `README.md`： 提供漏洞利用的步骤。

**有效性评估：**

提供的POC代码看起来是有效的，它实现了漏洞利用所需的基本步骤。根据搜索结果，存在多个关于此漏洞的POC，表明漏洞利用的可行性较高。 Rapid7 也提供了相关的利用模块, 进一步证实了这一点.

**投毒风险评估：**

虽然代码主要用于权限提升，但仍存在一定的投毒风险。

*   风险点： `exp.c` 中的 `system(buf);` 调用。 如果 `buf` 的内容被恶意修改，可能执行任意命令。但是，目前的`buf`构建方式相对固定，直接被投毒的可能性较低.
*   风险占比： 5%。 风险主要来自于对`exp.c`中命令执行语句的潜在篡改, 例如在编译过程中注入恶意代码. 代码中使用 `system` 函数有潜在的风险，如果 `DIR_UPPER` 可控，则存在命令注入的可能。

总的来说，该POC的主要目的是演示权限提升，而非进行恶意攻击或投毒。直接的恶意代码注入的可能性较低，但仍然需要仔细审查代码，确保在编译和执行过程中没有被篡改。

**项目地址:** [sxlmnwb/CVE-2023-0386](https://github.com/sxlmnwb/CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #13

**来源**: [CVE-2023-0386-veritas501_CVE-2023-0386.md](../2023/CVE-2023-0386-veritas501_CVE-2023-0386.md)

## CVE-2023-0386 OverlayFS 本地提权漏洞

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可使普通用户提升为root权限

**影响版本:** Linux kernel 6.2-rc6 及之前版本

**利用条件:** 需要本地用户权限，目标系统启用OverlayFS

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-0386 是一个 Linux 内核漏洞，存在于 OverlayFS 子系统中。该漏洞允许未经授权的用户通过 OverlayFS 绕过权限检查，从而执行具有 capabilities 属性的 setuid 文件。利用该漏洞，本地用户可以提升其在系统上的权限。

**有效性：**

根据搜索结果，已经有多个关于该漏洞的分析和利用的报告。 Rapid7 也有公开的利用模块。提供的代码中Makefile显示其编译流程,以及所需依赖, 能够编译poc,初步判断PoC的有效性较高。

**投毒风险：**

检查提供的PoC代码，包括 `Makefile`、`README.md`、`config` 文件,代码量较少，未发现明显的恶意代码或后门。虽然无法100%保证不存在隐藏的风险，但根据现有信息，投毒的可能性较低。配置文件是内核配置信息，不包含可执行代码。Makefile是编译脚本，主要用于控制编译过程，没有恶意行为。poc.c （未提供）是攻击的核心，投毒风险主要存在于该文件中。但是从Makefile 的编译参数来看，使用了 -static 参数，这会将所有依赖的库静态链接到可执行文件中，减少了运行时依赖，一定程度上降低了动态链接库替换的风险。总体评估风险较低，判定投毒风险为1%。

**利用方式：**

漏洞的利用方式是利用 OverlayFS 在复制具有 capabilities 属性的 setuid 文件时，uid 映射的错误。攻击者可以通过以下步骤利用该漏洞：

1.  创建一个具有 capabilities 属性的 setuid 文件在 nosuid 的挂载点上。
2.  使用 OverlayFS 将该文件复制到另一个挂载点。
3.  由于 uid 映射错误，复制后的文件可能保留 capabilities 属性，但 uid 变为攻击者的 uid。
4.  攻击者现在可以执行该文件，并获得与该文件原始所有者相同的权限，从而提升权限。

搜索结果中 vicarius.io 的文章 `CVE-2023-0386 A Linux kernel bug in overlayfs - vsociety` 提供了漏洞的原理和利用过程，可作为参考。

**项目地址:** [veritas501/CVE-2023-0386](https://github.com/veritas501/CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #14

**来源**: [CVE-2023-0386-xkaneiki_CVE-2023-0386.md](../2023/CVE-2023-0386-xkaneiki_CVE-2023-0386.md)

## CVE-2023-0386 OverlayFS权限提升漏洞

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可提升权限至root

**影响版本:** Linux kernel 6.2-rc6

**利用条件:** 本地用户访问，目标系统存在OverlayFS，且内核版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Linux内核的OverlayFS子系统中。当用户将具有capabilities的setuid文件从nosuid挂载复制到另一个挂载点时，存在权限映射错误。攻击者可以通过利用OverlayFS来获得未授权的访问权限并提升权限。

**利用方式：**

1.  **环境准备：** 创建必要的目录结构 (lower, upper, work, merge)。
2.  **挂载OverlayFS：** 使用`mount`命令挂载OverlayFS，设置`lowerdir`，`upperdir`和`workdir`。
3.  **创建带Capabilities的文件：** 在lowerdir创建一个具有capabilities的setuid文件，例如`gc`。
4.  **触发漏洞：** 通过fuse将lowerdir加载为一个文件系统，在upperdir中创建一个同名文件覆盖lowerdir中的文件。
5.  **权限提升：** 执行merge目录下的相应程序，由于OverlayFS的权限错误，攻击者可以获得root权限。

**投毒风险分析：**

该POC代码的投毒风险较低，为10%。主要风险在于`fuse.c`文件，虽然它本身实现了FUSE文件系统，但如果代码编写不严谨，可能会被恶意修改，例如在文件访问时执行恶意代码。此外，`getshell.c`文件如果包含恶意代码，可能会在提权后执行恶意操作。但总体而言，POC代码结构清晰，目的是演示漏洞利用，而非进行恶意攻击。`exp.c`主要是利用漏洞，而`Makefile`只是编译脚本，风险相对较低。

**有效性评估：**

根据漏洞信息、搜索引擎结果和提供的漏洞利用代码，该POC代码是有效的。搜索引擎结果中多个链接 (例如vicarius.io, rapid7) 描述了CVE-2023-0386漏洞以及利用方法，rapid7更提供了expolit模块。POC代码结构完整，包含编译脚本(Makefile)，利用程序(exp.c)，以及FUSE文件系统模拟(fuse.c)和getshell.c，能够复现该漏洞，成功实现本地权限提升。

**项目地址:** [xkaneiki/CVE-2023-0386](https://github.com/xkaneiki/CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---



---

## POC #4

**来源**: [CVE-2023-0386-Satheesh575555_linux-4.19.72_CVE-2023-0386.md](../2023/CVE-2023-0386-Satheesh575555_linux-4.19.72_CVE-2023-0386.md)

## CVE-2023-0386-Linux Kernel OverlayFS权限提升

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户提升权限

**影响版本:** Linux kernel 6.2-rc6 (可能影响其他版本，需要根据补丁判断)

**利用条件:** 需要本地用户权限，目标系统使用 OverlayFS 文件系统。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-0386 漏洞存在于 Linux 内核的 OverlayFS 子系统中。漏洞描述指出，当用户从一个 nosuid 的挂载点复制一个具有 capability 的文件到另一个挂载点时，存在权限映射错误。这使得本地用户能够提升他们在系统上的权限。

**有效性：** 根据搜索结果，存在公开的漏洞利用代码（例如 vicarius.io），证明该漏洞可以被利用。 虽然提供的代码段本身不是完整的PoC，但搜索结果指向了可用的完整PoC，所以判断是有效的。

**投毒风险：** 提供的代码段是Linux内核的COPYING和CREDITS文件，它们是许可信息和贡献者列表，而非可执行代码。 这些文件本身不包含恶意代码。虽然这些文件本身不是漏洞利用程序，但如果将恶意代码伪装成贡献者添加到CREDITS文件中，从理论上讲，可以将恶意代码混入到源代码管理系统中。因为这假设有恶意的人员对代码库提交被篡改的CREDITS文件，概率极低,因此判断投毒风险极低。

**利用方式：** 该漏洞的利用方式涉及以下步骤：
1.  利用OverlayFS文件系统特性，将一个具有 setuid 权限的文件从 nosuid 挂载点复制到其他挂载点。
2.  由于权限映射错误，新复制的文件在目标挂载点上保留了 setuid 权限，但是用户ID 映射不正确。
3.  攻击者可以执行这个具有 setuid 权限的文件，从而以更高的权限运行代码。

搜索引擎结果和漏洞库信息都表明该漏洞允许本地权限提升，所以漏洞利用是有效的。

**项目地址:** [Satheesh575555/linux-4.19.72_CVE-2023-0386](https://github.com/Satheesh575555/linux-4.19.72_CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #5

**来源**: [CVE-2023-0386-bchevCH_CVE-2023-0386.md](../2023/CVE-2023-0386-bchevCH_CVE-2023-0386.md)

## CVE-2023-0386 OverlayFS 本地提权漏洞

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可使普通用户获得root权限

**影响版本:** < 6.2

**利用条件:** 需要本地访问权限，目标系统内核版本低于6.2且OverlayFS未修复

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-0386 是 Linux 内核 OverlayFS 子系统中的一个漏洞，允许本地用户提升权限。该漏洞源于内核在执行 copy-up 操作期间未能正确验证用户/组所有权映射。攻击者可以利用此漏洞：

1.  创建一个具有 root 拥有的 SUID 二进制文件的恶意 FUSE 文件系统。
2.  使用用户和挂载命名空间隔离操作。
3.  创建一个 OverlayFS 挂载，并将 FUSE 文件系统作为 lower layer。
4.  触发一个 copy-up 操作，错误地保留 SUID 位。
5.  执行生成的 SUID 二进制文件以获得 root 权限。

**有效性：** 根据漏洞信息和搜索结果，该漏洞已被积极利用，PoC 代码的存在进一步证实了其有效性。提供的 `README.md` 文件描述了一个完整的安全工具包，包含漏洞测试、缓解和取证分析脚本，说明此漏洞的利用代码已经比较成熟。

**投毒风险：** 虽然该工具包提供了漏洞测试脚本，但同时也包含了缓解和取证分析脚本，相对比较完整。考虑到该漏洞被 CISA 列入已知被利用漏洞目录，说明此漏洞利用的公开程度较高。`README.md` 文件中也包含了免责声明，提示仅在测试系统上运行 PoC。因此，虽然不排除作者可能在脚本中隐藏恶意代码，但概率相对较低，约为10%。需要对脚本内容进行详细审计以确认是否存在投毒行为。

**利用方式：**

1.  **环境准备：** 攻击者需要一个存在漏洞的 Linux 系统，并且能够创建挂载点和用户命名空间。
2.  **FUSE 文件系统创建：** 创建一个 FUSE 文件系统，并在其中放置一个 root 用户拥有的 SUID 可执行文件。
3.  **OverlayFS 挂载：** 使用 FUSE 文件系统作为 lower layer，创建一个 OverlayFS 挂载。
4.  **触发 Copy-up：** 通过访问或修改 FUSE 文件系统中的文件，触发 copy-up 操作。这将导致 SUID 可执行文件被复制到 OverlayFS 的 upper layer。
5.  **权限提升：** 执行 upper layer 中的 SUID 可执行文件，由于漏洞的存在，该文件仍然保留 SUID 位，从而使攻击者获得 root 权限。

**项目地址:** [bchevCH/CVE-2023-0386](https://github.com/bchevCH/CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #6

**来源**: [CVE-2023-0386-chenaotian_CVE-2023-0386.md](../2023/CVE-2023-0386-chenaotian_CVE-2023-0386.md)

## CVE-2023-0386 OverlayFS 本地提权漏洞

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel OverlayFS

**危害等级:** 高危，可导致本地权限提升

**影响版本:** 5.11 ~ 5.19

**利用条件:** 需要能够 unshare 或创建 overlay 文件系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于 Linux 内核的 OverlayFS 子系统中，允许本地用户通过利用 OverlayFS 的特性，结合用户命名空间绕过权限检查，从而将权限提升为 root。

**漏洞利用方式：**

1.  **环境准备：** 准备一个存在漏洞的 Linux 内核环境（版本 5.11 ~ 5.19），确保内核配置启用了 OverlayFS 和 FUSE 文件系统。
2.  **创建用户命名空间：** 使用 `unshare` 命令创建一个新的用户命名空间。在新命名空间中，创建者拥有 root 权限，但初始命名空间的 root 用户未被映射，会被识别为 nobody。
3.  **创建 OverlayFS 文件系统：** 创建 OverlayFS 文件系统，包含 lowerdir（只读层） 和 upperdir（可写层）。将一个具有 setuid 权限的可执行文件放置在 lowerdir 中，且该文件的属主在当前用户命名空间中没有映射(nobody)。
4.  **触发漏洞：**  当尝试执行 lowerdir 中的 setuid 程序时，OverlayFS 会尝试将该文件拷贝到 upperdir。由于漏洞存在，拷贝过程会忽略用户命名空间的权限映射检查，导致该文件在 upperdir 中被赋予不正确的权限。
5.  **权限提升：**  执行 upperdir 中具有 setuid 权限的拷贝文件，由于权限不正确，攻击者可以利用它来执行任意代码，从而提升权限。

**有效性：**

根据漏洞信息和搜索结果，该漏洞利用代码利用 OverlayFS 在用户命名空间中拷贝文件时的权限检查缺陷，能够成功实现本地提权。提供的 POC 代码 `exp.c` 通过 FUSE 创建 OverlayFS 文件系统，并利用该漏洞。

**投毒风险：**

查看提供的代码文件，其中包含一个 README.md 和一个 exp.c 文件。README.md 文件只是描述了漏洞原理和编译运行方式，没有发现恶意代码。查看`exp.c`需要进一步的分析，才能确定是否存在后门。目前判断的投毒风险较低，暂时判定为 10%。后续需要进一步人工审计`exp.c`代码。


**项目地址:** [chenaotian/CVE-2023-0386](https://github.com/chenaotian/CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #7

**来源**: [CVE-2023-0386-churamanib_CVE-2023-0386.md](../2023/CVE-2023-0386-churamanib_CVE-2023-0386.md)

## CVE-2023-0386 OverlayFS 本地提权漏洞

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可提升权限至 root

**影响版本:** Linux kernel 6.2-rc6 (受影响版本)

**利用条件:** 本地用户权限，目标系统内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-0386 存在于 Linux 内核的 OverlayFS 子系统中。该漏洞允许本地用户通过复制具有 capabilities 的 setuid 文件从 nosuid 挂载点到另一个挂载点，从而获得未经授权的访问权限和权限提升。

**利用方式：**

1.  **环境准备：** 创建必要的目录结构，包括 lower, upper, work, merge 目录，为 OverlayFS 挂载做准备。
2.  **构建 OverlayFS：** 使用 `mount` 命令，将 lower, upper, work 目录挂载为 OverlayFS 文件系统。
3.  **创建具有 Capabilities 的文件:** Fuse.c中通过getattr_callback 函数的stbuf->st_mode = S_IFREG | 04777;语句将文件设置为suid权限， exp.c 通过unshare创建新的namespace, 然后通过mount命令挂载OverlayFS文件系统。exp.c 通过touch 创建文件。
4.  **触发漏洞：**exp.c wait函数等待创建结束后，通过system命令执行文件
5.  **权限提升：** 利用 setuid 和 capabilities，攻击者可以执行特权操作，获取 root 权限。

**代码分析：**

*   `Makefile`: 用于编译 fuse.c (创建 fuse 文件系统), exp.c (漏洞利用程序) 和 getshell.c (获取 shell 的程序)。
*   `README.md`: 提供漏洞利用的简要说明。
*   `exp.c`: 漏洞利用的核心代码。它创建必要的目录和文件，设置用户和组 ID 映射，挂载 OverlayFS，并执行触发漏洞的文件。
*   `fuse.c`: 创建一个 FUSE 文件系统，模拟 lowerdir 文件系统，提供具有 suid 权限的文件。getattr_callback 函数是关键，它设置了文件的权限。
*   `getshell.c`: 获取 shell 的程序(代码未提供，功能缺失)。

**有效性：**

根据搜索结果和提供的 PoC 代码，该漏洞利用是有效的。多个资源 (vicarius.io, rapid7) 提供了关于此漏洞的详细信息和利用方法。PoC 代码通过 FUSE 创建具有 suid 权限的文件，并在 OverlayFS 中利用该文件进行提权。

**投毒风险：**

该代码存在轻微的投毒风险，风险值约为1%。

*   `getshell.c` 文件缺失，虽然 Makefile 试图编译它，但实际上没有提供任何代码。这可能是作者故意为之，使得整个利用链不完整，需要使用者自行补充。缺失后利用失败，无法获取目标服务器权限。但如果用户不了解情况直接使用该文件编译可能导致其他未知风险。 

**项目地址:** [churamanib/CVE-2023-0386](https://github.com/churamanib/CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #8

**来源**: [CVE-2023-0386-hshivhare67_kernel_v4.19.72_CVE-2023-0386.md](../2023/CVE-2023-0386-hshivhare67_kernel_v4.19.72_CVE-2023-0386.md)

## CVE-2023-0386-Linux Kernel-OverlayFS权限提升

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可利用该漏洞提升权限

**影响版本:** Linux kernel 6.2-rc6以及可能存在的其他版本

**利用条件:** 本地用户需要能够创建和挂载OverlayFS文件系统

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-0386 是一个Linux内核OverlayFS文件系统中的权限提升漏洞。漏洞存在于用户将具有capabilities的setuid文件从 nosuid 挂载复制到另一个挂载中的方式。利用该漏洞，本地用户可以获得系统上的特权。 

**有效性:** 根据搜索结果（尤其是vsociety的文章），该漏洞存在可利用性，并且已经有公开的PoC。

**投毒风险:** 提供的代码片段是Linux内核的COPYING和CREDITS文件，不包含任何可执行代码或恶意逻辑。因此，这些文件本身不构成投毒风险。但不能排除完整的利用代码中可能包含投毒的可能,根据经验判断,投毒风险较低。风险预估：1%。

**利用方式:**
1.  攻击者需要具有创建和挂载OverlayFS文件系统的权限。
2.  攻击者创建一个具有capabilities的setuid文件在一个nosuid挂载点上。
3.  攻击者利用漏洞，将该文件复制到另一个挂载点，导致权限提升。
4.  通过执行复制后的文件，攻击者可以获得root权限。

**项目地址:** [hshivhare67/kernel_v4.19.72_CVE-2023-0386](https://github.com/hshivhare67/kernel_v4.19.72_CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #9

**来源**: [CVE-2023-0386-letsr00t_CVE-2023-0386.md](../2023/CVE-2023-0386-letsr00t_CVE-2023-0386.md)

## CVE-2023-0386 Linux Kernel OverlayFS 特权提升漏洞

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 特权提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户权限提升

**影响版本:** Linux kernel 6.2-rc6 (以及可能存在的其他受影响版本，需要进一步验证)

**利用条件:** 需要本地用户权限，并开启 OverlayFS

**POC 可用性:** 是 (根据搜索结果)

**投毒风险:** 2%

## 详情

根据漏洞库信息和搜索结果，CVE-2023-0386 是 Linux 内核 OverlayFS 子系统中存在的一个权限提升漏洞。该漏洞允许本地用户利用 OverlayFS 的不当权限处理，将具有 capabilities 的 setuid 文件从 nosuid 挂载点复制到另一个挂载点，从而获得未经授权的访问权限并提升其在系统上的权限。

**有效性：**
根据搜索结果，漏洞利用代码是存在的，并且被多个安全厂商提及。由于提供漏洞利用代码只有`README.md`文件，无法验证漏洞的真实利用效果，需要完整的 POC 代码才能验证其有效性。

**投毒风险：**
提供的漏洞利用代码只包含一个 `README.md` 文件，内容仅为 CVE 编号，无法进行投毒分析。假设存在完整的漏洞利用代码，则投毒风险较低，原因如下：

*   漏洞利用代码通常较为复杂，容易被发现潜在的恶意行为。
*   该漏洞本身是权限提升漏洞，利用目的是获取 root 权限，如果加入恶意代码，可能会增加利用难度，甚至导致利用失败。
*   安全研究人员通常会对漏洞利用代码进行严格审查，以确保其安全性。
*   但仍然不能排除存在一些不明显的投毒方式，比如在成功提权后执行恶意操作。所以，即便只是一个简单的README文件，依然有被篡改，被植入恶意链接的可能性。因此，综合考虑，投毒风险定为2%。

**利用方式：**
1.  攻击者利用OverlayFS创建一个overlay文件系统。
2.  攻击者复制一个具有capabilities的setuid文件到overlay文件系统中。
3.  由于OverlayFS的权限处理不当，攻击者可以绕过权限检查，执行该setuid文件，从而获得root权限。

**优先级排序：**
搜索引擎结果提供了漏洞利用的相关信息和链接，漏洞库信息提供了漏洞的描述和受影响的版本，漏洞利用代码（仅 `README.md`）无法提供具体的利用方式或验证信息，因此排序为：搜索引擎结果 > 漏洞库信息 > 漏洞利用代码。


**项目地址:** [letsr00t/CVE-2023-0386](https://github.com/letsr00t/CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #10

**来源**: [CVE-2023-0386-orilevy8_cve-2023-0386.md](../2023/CVE-2023-0386-orilevy8_cve-2023-0386.md)

## CVE-2023-0386-Linux Kernel OverlayFS权限提升

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可以提升权限到root

**影响版本:** Linux kernel 6.2-rc6 (根据漏洞库信息，实际影响范围可能更广)

**利用条件:** 需要本地用户权限，目标系统需要启用 OverlayFS

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Linux 内核的 OverlayFS 子系统中。当用户将具有 capabilities 的 setuid 文件从 nosuid 挂载复制到另一个挂载时，存在权限映射问题，可能导致本地用户获得未经授权的权限提升。

**利用方式：**

1.  **创建 FUSE 文件系统：** POC 使用 FUSE 创建一个伪文件系统，该文件系统提供一个名为 `a.out` 的文件，该文件具有 setuid root 权限和capabilities。
2.  **创建 OverlayFS 挂载：**  POC 创建一个 OverlayFS 挂载点，其中 lowerdir 指向 FUSE 文件系统，upperdir 和 workdir 用于 OverlayFS 的操作。
3.  **在 OverlayFS 中复制文件：** POC 尝试在 OverlayFS 挂载点中创建一个与 lowerdir 中 `a.out` 同名的文件，触发漏洞。
4.  **权限提升：** 通过漏洞，OverlayFS 将具有 capabilities 的 setuid 文件复制到 upperdir，然后通过执行upperdir中的`a.out`，本地用户可以提升权限。

**有效性：**

根据搜索引擎结果 (如 vicarius.io 的文章和 Rapid7 的模块)，该漏洞存在可利用的 POC，并且已被成功利用进行本地权限提升。提供的 POC 代码与漏洞描述相符，应该能够有效利用此漏洞。

**投毒风险：**

分析提供的 POC 代码，未发现明显的投毒代码。POC 代码的主要目的是利用 OverlayFS 的漏洞来提升权限，而不是执行恶意操作或植入后门。

*   `ss.c` 文件用于创建一个简单的 setuid root 的程序，这部分是漏洞利用的一部分，而不是恶意代码。
*   POC 代码创建的文件和目录都是为了利用 OverlayFS 漏洞，没有发现隐藏的恶意逻辑。

因此，可以认为此 POC 代码的投毒风险较低，概率为 0%。

**项目地址:** [orilevy8/cve-2023-0386](https://github.com/orilevy8/cve-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #11

**来源**: [CVE-2023-0386-puckiestyle_CVE-2023-0386.md](../2023/CVE-2023-0386-puckiestyle_CVE-2023-0386.md)

## CVE-2023-0386 - Linux Kernel OverlayFS Privilege Escalation

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel (OverlayFS)

**危害等级:** 高危，本地用户可提升权限至 root

**影响版本:** Linux kernel 6.2-rc6 (受影响范围可能更广，需进一步测试)

**利用条件:** 本地用户权限，需要系统开启OverlayFS。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Linux内核的OverlayFS子系统中，当用户尝试将具有 capability 的 setuid 文件从 nosuid 挂载点复制到另一个挂载点时，OverlayFS处理不当导致权限提升。利用方式如下：

1.  **漏洞原理：** OverlayFS 允许将两个目录（lowerdir 和 upperdir）合并到一个视图中（mergedir）。如果 lowerdir 中存在具有 capability 的 setuid 文件，攻击者可以通过精心构造的文件系统操作，使得该文件在 mergedir 中被错误地赋予权限，从而实现权限提升。

2.  **利用步骤（基于提供的代码）：**
    *   **编译：** 使用 `make all` 命令编译 `fuse.c` (fuse文件系统), `exp.c` (漏洞利用程序) 和 `getshell.c` (用于获取 shell 的程序)。
    *   **创建目录：** 创建 overlayfs 所需的 `lowerdir`、`upperdir`、`workdir` 和 `mergedir`。
    *   **FUSE 挂载（Terminal 1）：** 运行 `./fuse ./ovlcap/lower ./gc` 模拟 lowerdir，创建一个具有 setuid 权限的文件 `/file`。
    *   **OverlayFS 挂载（Terminal 2）：** 运行 `./exp` 创建一个新的用户命名空间和挂载命名空间，并将 overlayfs 挂载到 `mergedir`。
    *   **触发漏洞：** `exp.c`尝试在upperdir中创建文件。这个操作配合fuse文件系统，会触发权限提升的漏洞。
    *   **获取 root 权限：**  由于 `/file` 文件现在具有错误的权限，执行它将以 root 权限运行。

3.  **有效性：** 提供的代码看起来有效，因为它实现了上述利用步骤，并包含了编译脚本和相关的源文件。漏洞库信息和搜索引擎结果也表明此漏洞存在且可被利用。

4.  **投毒风险：** 代码中`fuse.c` 和 `getshell.c` 有潜在的投毒风险。`fuse.c`可以被修改以记录用户信息或执行恶意操作，虽然当前代码比较简洁，但存在被修改的可能。`getshell.c` 如果被替换为包含恶意代码的版本，可能在权限提升后执行恶意行为。总体来说，投毒风险较低，大概10%，因为exp.c的主要逻辑是利用漏洞提权，并没有明显的恶意代码。

5.  **缓解措施：**
    *   及时更新Linux内核到已修复的版本。
    *   禁用 OverlayFS，如果不需要的话。
    *   加强对OverlayFS配置的审计，确保配置安全。
    *   使用 AppArmor 或 SELinux 等强制访问控制机制来限制进程的权限。

**项目地址:** [puckiestyle/CVE-2023-0386](https://github.com/puckiestyle/CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #12

**来源**: [CVE-2023-0386-sxlmnwb_CVE-2023-0386.md](../2023/CVE-2023-0386-sxlmnwb_CVE-2023-0386.md)

## CVE-2023-0386-Linux Kernel OverlayFS权限提升

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可提升权限至root

**影响版本:** Linux kernel 6.2-rc6 (可能影响其他版本)

**利用条件:** 本地用户访问权限，目标系统使用OverlayFS

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-0386 是一个 Linux kernel OverlayFS 中的权限提升漏洞。该漏洞允许本地用户通过利用 OverlayFS 如何处理具有 capabilities 的 setuid 文件，从而获得提升的权限。 

**利用方式：**

1.  **环境准备:** 创建必要的目录结构，包括lowerdir, upperdir, workdir和mergedir，模拟OverlayFS环境。
2.  **挂载OverlayFS:** 使用`mount`命令挂载OverlayFS文件系统，指定lowerdir, upperdir和workdir。
3.  **创建带capability的文件 (在提供的代码中，这一步通过fuse.c模拟):** Fuse文件系统模拟lowerdir中存在具有setuid权限的文件。漏洞利用的关键在于OverlayFS对这个文件的处理不当。
4.  **触发漏洞:**  当用户尝试在OverlayFS挂载点访问或复制这个具有capabilities的setuid文件时，由于uid映射的缺陷，会导致权限提升。exp.c的代码模拟了这个过程。
5.  **执行提权后的文件:** 执行复制到upperdir的目标文件，获得root权限。

**代码分析：**

*   `fuse.c`： 使用FUSE (Filesystem in Userspace) 模拟一个 lower 层的文件系统。关键在于`getattr_callback`函数，该函数为`/file`设置了`S_IFREG | 04777` 权限，即设置了 setuid 位。
*   `exp.c`： 此文件实现了漏洞利用的核心逻辑。
    *   创建并挂载 OverlayFS 文件系统。
    *   通过`unshare`创建新的命名空间，模拟用户命名空间。
    *   利用OverlayFS的特性，尝试复制 lower 层中带 capability 的文件到 upper 层。
    *   最终尝试执行upper层的文件，期望获得提权。
*   `Makefile`： 用于编译各个源文件。
*   `README.md`： 提供漏洞利用的步骤。

**有效性评估：**

提供的POC代码看起来是有效的，它实现了漏洞利用所需的基本步骤。根据搜索结果，存在多个关于此漏洞的POC，表明漏洞利用的可行性较高。 Rapid7 也提供了相关的利用模块, 进一步证实了这一点.

**投毒风险评估：**

虽然代码主要用于权限提升，但仍存在一定的投毒风险。

*   风险点： `exp.c` 中的 `system(buf);` 调用。 如果 `buf` 的内容被恶意修改，可能执行任意命令。但是，目前的`buf`构建方式相对固定，直接被投毒的可能性较低.
*   风险占比： 5%。 风险主要来自于对`exp.c`中命令执行语句的潜在篡改, 例如在编译过程中注入恶意代码. 代码中使用 `system` 函数有潜在的风险，如果 `DIR_UPPER` 可控，则存在命令注入的可能。

总的来说，该POC的主要目的是演示权限提升，而非进行恶意攻击或投毒。直接的恶意代码注入的可能性较低，但仍然需要仔细审查代码，确保在编译和执行过程中没有被篡改。

**项目地址:** [sxlmnwb/CVE-2023-0386](https://github.com/sxlmnwb/CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #13

**来源**: [CVE-2023-0386-veritas501_CVE-2023-0386.md](../2023/CVE-2023-0386-veritas501_CVE-2023-0386.md)

## CVE-2023-0386 OverlayFS 本地提权漏洞

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可使普通用户提升为root权限

**影响版本:** Linux kernel 6.2-rc6 及之前版本

**利用条件:** 需要本地用户权限，目标系统启用OverlayFS

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-0386 是一个 Linux 内核漏洞，存在于 OverlayFS 子系统中。该漏洞允许未经授权的用户通过 OverlayFS 绕过权限检查，从而执行具有 capabilities 属性的 setuid 文件。利用该漏洞，本地用户可以提升其在系统上的权限。

**有效性：**

根据搜索结果，已经有多个关于该漏洞的分析和利用的报告。 Rapid7 也有公开的利用模块。提供的代码中Makefile显示其编译流程,以及所需依赖, 能够编译poc,初步判断PoC的有效性较高。

**投毒风险：**

检查提供的PoC代码，包括 `Makefile`、`README.md`、`config` 文件,代码量较少，未发现明显的恶意代码或后门。虽然无法100%保证不存在隐藏的风险，但根据现有信息，投毒的可能性较低。配置文件是内核配置信息，不包含可执行代码。Makefile是编译脚本，主要用于控制编译过程，没有恶意行为。poc.c （未提供）是攻击的核心，投毒风险主要存在于该文件中。但是从Makefile 的编译参数来看，使用了 -static 参数，这会将所有依赖的库静态链接到可执行文件中，减少了运行时依赖，一定程度上降低了动态链接库替换的风险。总体评估风险较低，判定投毒风险为1%。

**利用方式：**

漏洞的利用方式是利用 OverlayFS 在复制具有 capabilities 属性的 setuid 文件时，uid 映射的错误。攻击者可以通过以下步骤利用该漏洞：

1.  创建一个具有 capabilities 属性的 setuid 文件在 nosuid 的挂载点上。
2.  使用 OverlayFS 将该文件复制到另一个挂载点。
3.  由于 uid 映射错误，复制后的文件可能保留 capabilities 属性，但 uid 变为攻击者的 uid。
4.  攻击者现在可以执行该文件，并获得与该文件原始所有者相同的权限，从而提升权限。

搜索结果中 vicarius.io 的文章 `CVE-2023-0386 A Linux kernel bug in overlayfs - vsociety` 提供了漏洞的原理和利用过程，可作为参考。

**项目地址:** [veritas501/CVE-2023-0386](https://github.com/veritas501/CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

## POC #14

**来源**: [CVE-2023-0386-xkaneiki_CVE-2023-0386.md](../2023/CVE-2023-0386-xkaneiki_CVE-2023-0386.md)

## CVE-2023-0386 OverlayFS权限提升漏洞

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可提升权限至root

**影响版本:** Linux kernel 6.2-rc6

**利用条件:** 本地用户访问，目标系统存在OverlayFS，且内核版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Linux内核的OverlayFS子系统中。当用户将具有capabilities的setuid文件从nosuid挂载复制到另一个挂载点时，存在权限映射错误。攻击者可以通过利用OverlayFS来获得未授权的访问权限并提升权限。

**利用方式：**

1.  **环境准备：** 创建必要的目录结构 (lower, upper, work, merge)。
2.  **挂载OverlayFS：** 使用`mount`命令挂载OverlayFS，设置`lowerdir`，`upperdir`和`workdir`。
3.  **创建带Capabilities的文件：** 在lowerdir创建一个具有capabilities的setuid文件，例如`gc`。
4.  **触发漏洞：** 通过fuse将lowerdir加载为一个文件系统，在upperdir中创建一个同名文件覆盖lowerdir中的文件。
5.  **权限提升：** 执行merge目录下的相应程序，由于OverlayFS的权限错误，攻击者可以获得root权限。

**投毒风险分析：**

该POC代码的投毒风险较低，为10%。主要风险在于`fuse.c`文件，虽然它本身实现了FUSE文件系统，但如果代码编写不严谨，可能会被恶意修改，例如在文件访问时执行恶意代码。此外，`getshell.c`文件如果包含恶意代码，可能会在提权后执行恶意操作。但总体而言，POC代码结构清晰，目的是演示漏洞利用，而非进行恶意攻击。`exp.c`主要是利用漏洞，而`Makefile`只是编译脚本，风险相对较低。

**有效性评估：**

根据漏洞信息、搜索引擎结果和提供的漏洞利用代码，该POC代码是有效的。搜索引擎结果中多个链接 (例如vicarius.io, rapid7) 描述了CVE-2023-0386漏洞以及利用方法，rapid7更提供了expolit模块。POC代码结构完整，包含编译脚本(Makefile)，利用程序(exp.c)，以及FUSE文件系统模拟(fuse.c)和getshell.c，能够复现该漏洞，成功实现本地权限提升。

**项目地址:** [xkaneiki/CVE-2023-0386](https://github.com/xkaneiki/CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)

---

