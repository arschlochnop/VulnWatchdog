# CVE-2023-37582

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-37582-Malayke_CVE-2023-37582_EXPLOIT.md](../2023/CVE-2023-37582-Malayke_CVE-2023-37582_EXPLOIT.md)

# CVE-2023-37582

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-37582-Malayke_CVE-2023-37582_EXPLOIT.md](../2023/CVE-2023-37582-Malayke_CVE-2023-37582_EXPLOIT.md)

# CVE-2023-37582

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-37582-Malayke_CVE-2023-37582_EXPLOIT.md](../2023/CVE-2023-37582-Malayke_CVE-2023-37582_EXPLOIT.md)

# CVE-2023-37582

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-37582-Malayke_CVE-2023-37582_EXPLOIT.md](../2023/CVE-2023-37582-Malayke_CVE-2023-37582_EXPLOIT.md)

# CVE-2023-37582

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-37582-Malayke_CVE-2023-37582_EXPLOIT.md](../2023/CVE-2023-37582-Malayke_CVE-2023-37582_EXPLOIT.md)

# CVE-2023-37582

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-37582-Malayke_CVE-2023-37582_EXPLOIT.md](../2023/CVE-2023-37582-Malayke_CVE-2023-37582_EXPLOIT.md)

# CVE-2023-37582

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-37582-Malayke_CVE-2023-37582_EXPLOIT.md](../2023/CVE-2023-37582-Malayke_CVE-2023-37582_EXPLOIT.md)

# CVE-2023-37582

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-37582-Malayke_CVE-2023-37582_EXPLOIT.md](../2023/CVE-2023-37582-Malayke_CVE-2023-37582_EXPLOIT.md)

# CVE-2023-37582

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-37582-Malayke_CVE-2023-37582_EXPLOIT.md](../2023/CVE-2023-37582-Malayke_CVE-2023-37582_EXPLOIT.md)

## CVE-2023-37582-Apache RocketMQ-远程命令执行

**漏洞编号:** CVE-2023-37582

**漏洞类型:** 远程命令执行

**影响应用:** Apache RocketMQ NameServer

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 5.0.0 <= version <= 5.1.1; version <= 4.9.6

**利用条件:** NameServer地址泄露到公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-37582是Apache RocketMQ NameServer组件中的一个远程命令执行漏洞。该漏洞是CVE-2023-33246的不完全修复。当NameServer的地址泄露到公网并且缺乏权限验证时，攻击者可以通过更新配置功能执行任意命令，命令将以RocketMQ运行用户的身份执行。

**有效性：** 提供的POC代码通过修改`configStorePath`配置项，尝试在目标服务器上创建`/tmp/pwned`文件。这验证了利用NameServer的配置更新功能执行命令的能力，虽然该POC只是创建了一个文件，但可以扩展到执行更危险的命令，因此POC有效。

**投毒风险：** 提供的代码中没有明显的投毒代码。代码的主要功能是构造特定的请求包，发送到NameServer，并接收响应。代码逻辑相对清晰，没有发现隐藏的恶意行为。LICENSE文件是Apache 2.0许可，属于常规开源许可协议。因此，投毒风险评估为0%。

**利用方式：** 攻击者首先需要获取目标RocketMQ NameServer的地址。然后，使用POC脚本构造包含恶意配置的请求，通过socket连接发送到NameServer的9876端口。  POC代码中构造了两种请求，分别是`GET_NAMESRV_CONFIG` (319)和`UPDATE_NAMESRV_CONFIG` (318)。`UPDATE_NAMESRV_CONFIG`请求通过修改NameServer的配置，可以用于执行任意命令。该POC通过修改`configStorePath`配置项来触发漏洞，但实际攻击中可以构造更复杂的命令来达到控制服务器的目的。漏洞利用的关键在于NameServer未对配置更新操作进行严格的权限验证。

**项目地址:** [Malayke/CVE-2023-37582_EXPLOIT](https://github.com/Malayke/CVE-2023-37582_EXPLOIT)

**漏洞详情:** [CVE-2023-37582](https://nvd.nist.gov/vuln/detail/CVE-2023-37582)

---

## POC #2

**来源**: [CVE-2023-37582-laishouchao_Apache-RocketMQ-RCE-CVE-2023-37582-poc.md](../2023/CVE-2023-37582-laishouchao_Apache-RocketMQ-RCE-CVE-2023-37582-poc.md)

## CVE-2023-37582-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-37582

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 5.0.0 <= version <= 5.1.1, 0 <= version <= 4.9.6

**利用条件:** NameServer地址泄露且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-37582 是 Apache RocketMQ NameServer 组件中的一个远程代码执行漏洞。此漏洞是 CVE-2023-33246 的不完全修复。如果 NameServer 地址泄露到公网且缺乏权限验证，攻击者可以通过更新 NameServer 的配置来执行任意命令，从而完全控制服务器。

**有效性分析：**
根据漏洞描述和搜索结果，POC代码的目的是利用 update configuration 功能来触发远程代码执行。POC通过构造特定的payload发送到目标NameServer的端口，模拟了攻击者利用该漏洞的过程。从代码来看，它首先连接到目标 IP 和端口 (9876)，然后发送一个十六进制编码的 payload，该 payload 旨在利用漏洞执行命令。如果目标存在漏洞，且漏洞利用成功，则会返回包含版本信息的响应。脚本通过正则表达式来确定目标是否存在漏洞以及版本号。因此，如果满足漏洞利用的条件（NameServer地址泄露，缺乏权限验证，且目标版本在受影响范围内），提供的POC代码是有效的。

**投毒风险分析：**
该POC代码的主要功能是漏洞验证，即检测目标系统是否存在 CVE-2023-37582 漏洞。 代码主要由以下几部分组成：定义 payload、创建 socket 连接、发送 payload、接收响应、解析响应并判断目标是否脆弱。

*   **Payload:** Payload 是十六进制编码的字符串，代表一个用于触发漏洞的特殊配置更新请求。该Payload用于触发漏洞，本身不具备恶意代码特性。
*   **Socket 连接:** 这部分代码用于建立与目标 NameServer 的网络连接。
*   **发送和接收数据:** 通过 socket 发送 payload 并接收 NameServer 的响应。
*   **响应解析:** 使用正则表达式解析 NameServer 的响应，以确定目标是否存在漏洞。

代码中没有发现任何明显的恶意行为，例如下载并执行其他程序、修改系统文件、或窃取敏感信息。因此，此仓库中存在作者隐藏的投毒代码的可能性很低。投毒风险评估为 0%。

**利用方式：**
1.  **信息泄露：** 首先，攻击者需要获取 RocketMQ NameServer 的地址，这通常可以通过信息泄露或扫描等方式实现。
2.  **构造 Payload：**  攻击者构造一个包含恶意命令的特殊 Payload，该 Payload 能够利用 NameServer 的配置更新功能执行命令。具体Payload结构在代码中已给出，这是一个JSON格式的配置数据，可能包含命令执行的入口。
3.  **发送请求：** 攻击者通过网络连接将构造好的 Payload 发送到目标 NameServer 的指定端口 (9876)。
4.  **命令执行：** NameServer 在处理配置更新请求时，由于漏洞的存在，会执行 Payload 中包含的恶意命令。
5.  **控制服务器：** 攻击者通过执行的命令获得对服务器的控制权。

**项目地址:** [laishouchao/Apache-RocketMQ-RCE-CVE-2023-37582-poc](https://github.com/laishouchao/Apache-RocketMQ-RCE-CVE-2023-37582-poc)

**漏洞详情:** [CVE-2023-37582](https://nvd.nist.gov/vuln/detail/CVE-2023-37582)

---

## POC #3

**来源**: [CVE-2023-37582-shoucheng3_apache__rocketmq_CVE-2023-37582_4-9-6.md](../2023/CVE-2023-37582-shoucheng3_apache__rocketmq_CVE-2023-37582_4-9-6.md)

## CVE-2023-37582-Apache RocketMQ-远程命令执行

**漏洞编号:** CVE-2023-37582

**漏洞类型:** 远程命令执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 5.0.0 <= version <= 5.1.1, version <= 4.9.6

**利用条件:** NameServer地址泄露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-37582 是 Apache RocketMQ NameServer 组件中的一个远程命令执行漏洞。由于 CVE-2023-33246 的修复不完整，攻击者可以在 NameServer 地址泄露且缺乏权限验证的情况下，利用 update configuration 功能执行任意命令，从而控制服务器。漏洞影响版本包括 RocketMQ 5.0.0 到 5.1.1 以及 4.9.6 及更早版本。

**有效性：**
根据漏洞描述和搜索结果，此漏洞利用代码通过更新 NameServer 的配置来执行命令，因此，如果满足 NameServer 地址泄露且缺乏权限验证这两个条件，那么漏洞利用是有效的。

**投毒风险：**
提供的“漏洞利用代码”实际上是RocketMQ的构建说明，贡献指南，许可证，并非真正的漏洞利用payload。代码中并没有发现明显的恶意代码或后门，因此投毒风险较低,为0%。

**利用方式：**
1.  **发现 NameServer 地址：** 攻击者需要首先获取 NameServer 的公网地址。
2.  **绕过权限验证：**  确定目标 NameServer 没有进行适当的权限验证。
3.  **利用 update configuration 功能：**  构造恶意的配置更新请求，其中包含要执行的系统命令。此命令将以运行 RocketMQ 的系统用户身份执行。
4.  **执行任意命令：**  成功利用漏洞后，攻击者可以执行任何系统命令，从而完全控制服务器。

**项目地址:** [shoucheng3/apache__rocketmq_CVE-2023-37582_4-9-6](https://github.com/shoucheng3/apache__rocketmq_CVE-2023-37582_4-9-6)

**漏洞详情:** [CVE-2023-37582](https://nvd.nist.gov/vuln/detail/CVE-2023-37582)

---



---

## POC #2

**来源**: [CVE-2023-37582-laishouchao_Apache-RocketMQ-RCE-CVE-2023-37582-poc.md](../2023/CVE-2023-37582-laishouchao_Apache-RocketMQ-RCE-CVE-2023-37582-poc.md)

## CVE-2023-37582-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-37582

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 5.0.0 <= version <= 5.1.1, 0 <= version <= 4.9.6

**利用条件:** NameServer地址泄露且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-37582 是 Apache RocketMQ NameServer 组件中的一个远程代码执行漏洞。此漏洞是 CVE-2023-33246 的不完全修复。如果 NameServer 地址泄露到公网且缺乏权限验证，攻击者可以通过更新 NameServer 的配置来执行任意命令，从而完全控制服务器。

**有效性分析：**
根据漏洞描述和搜索结果，POC代码的目的是利用 update configuration 功能来触发远程代码执行。POC通过构造特定的payload发送到目标NameServer的端口，模拟了攻击者利用该漏洞的过程。从代码来看，它首先连接到目标 IP 和端口 (9876)，然后发送一个十六进制编码的 payload，该 payload 旨在利用漏洞执行命令。如果目标存在漏洞，且漏洞利用成功，则会返回包含版本信息的响应。脚本通过正则表达式来确定目标是否存在漏洞以及版本号。因此，如果满足漏洞利用的条件（NameServer地址泄露，缺乏权限验证，且目标版本在受影响范围内），提供的POC代码是有效的。

**投毒风险分析：**
该POC代码的主要功能是漏洞验证，即检测目标系统是否存在 CVE-2023-37582 漏洞。 代码主要由以下几部分组成：定义 payload、创建 socket 连接、发送 payload、接收响应、解析响应并判断目标是否脆弱。

*   **Payload:** Payload 是十六进制编码的字符串，代表一个用于触发漏洞的特殊配置更新请求。该Payload用于触发漏洞，本身不具备恶意代码特性。
*   **Socket 连接:** 这部分代码用于建立与目标 NameServer 的网络连接。
*   **发送和接收数据:** 通过 socket 发送 payload 并接收 NameServer 的响应。
*   **响应解析:** 使用正则表达式解析 NameServer 的响应，以确定目标是否存在漏洞。

代码中没有发现任何明显的恶意行为，例如下载并执行其他程序、修改系统文件、或窃取敏感信息。因此，此仓库中存在作者隐藏的投毒代码的可能性很低。投毒风险评估为 0%。

**利用方式：**
1.  **信息泄露：** 首先，攻击者需要获取 RocketMQ NameServer 的地址，这通常可以通过信息泄露或扫描等方式实现。
2.  **构造 Payload：**  攻击者构造一个包含恶意命令的特殊 Payload，该 Payload 能够利用 NameServer 的配置更新功能执行命令。具体Payload结构在代码中已给出，这是一个JSON格式的配置数据，可能包含命令执行的入口。
3.  **发送请求：** 攻击者通过网络连接将构造好的 Payload 发送到目标 NameServer 的指定端口 (9876)。
4.  **命令执行：** NameServer 在处理配置更新请求时，由于漏洞的存在，会执行 Payload 中包含的恶意命令。
5.  **控制服务器：** 攻击者通过执行的命令获得对服务器的控制权。

**项目地址:** [laishouchao/Apache-RocketMQ-RCE-CVE-2023-37582-poc](https://github.com/laishouchao/Apache-RocketMQ-RCE-CVE-2023-37582-poc)

**漏洞详情:** [CVE-2023-37582](https://nvd.nist.gov/vuln/detail/CVE-2023-37582)

---

## POC #3

**来源**: [CVE-2023-37582-shoucheng3_apache__rocketmq_CVE-2023-37582_4-9-6.md](../2023/CVE-2023-37582-shoucheng3_apache__rocketmq_CVE-2023-37582_4-9-6.md)

## CVE-2023-37582-Apache RocketMQ-远程命令执行

**漏洞编号:** CVE-2023-37582

**漏洞类型:** 远程命令执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 5.0.0 <= version <= 5.1.1, version <= 4.9.6

**利用条件:** NameServer地址泄露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-37582 是 Apache RocketMQ NameServer 组件中的一个远程命令执行漏洞。由于 CVE-2023-33246 的修复不完整，攻击者可以在 NameServer 地址泄露且缺乏权限验证的情况下，利用 update configuration 功能执行任意命令，从而控制服务器。漏洞影响版本包括 RocketMQ 5.0.0 到 5.1.1 以及 4.9.6 及更早版本。

**有效性：**
根据漏洞描述和搜索结果，此漏洞利用代码通过更新 NameServer 的配置来执行命令，因此，如果满足 NameServer 地址泄露且缺乏权限验证这两个条件，那么漏洞利用是有效的。

**投毒风险：**
提供的“漏洞利用代码”实际上是RocketMQ的构建说明，贡献指南，许可证，并非真正的漏洞利用payload。代码中并没有发现明显的恶意代码或后门，因此投毒风险较低,为0%。

**利用方式：**
1.  **发现 NameServer 地址：** 攻击者需要首先获取 NameServer 的公网地址。
2.  **绕过权限验证：**  确定目标 NameServer 没有进行适当的权限验证。
3.  **利用 update configuration 功能：**  构造恶意的配置更新请求，其中包含要执行的系统命令。此命令将以运行 RocketMQ 的系统用户身份执行。
4.  **执行任意命令：**  成功利用漏洞后，攻击者可以执行任何系统命令，从而完全控制服务器。

**项目地址:** [shoucheng3/apache__rocketmq_CVE-2023-37582_4-9-6](https://github.com/shoucheng3/apache__rocketmq_CVE-2023-37582_4-9-6)

**漏洞详情:** [CVE-2023-37582](https://nvd.nist.gov/vuln/detail/CVE-2023-37582)

---



---

## POC #2

**来源**: [CVE-2023-37582-laishouchao_Apache-RocketMQ-RCE-CVE-2023-37582-poc.md](../2023/CVE-2023-37582-laishouchao_Apache-RocketMQ-RCE-CVE-2023-37582-poc.md)

## CVE-2023-37582-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-37582

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 5.0.0 <= version <= 5.1.1, 0 <= version <= 4.9.6

**利用条件:** NameServer地址泄露且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-37582 是 Apache RocketMQ NameServer 组件中的一个远程代码执行漏洞。此漏洞是 CVE-2023-33246 的不完全修复。如果 NameServer 地址泄露到公网且缺乏权限验证，攻击者可以通过更新 NameServer 的配置来执行任意命令，从而完全控制服务器。

**有效性分析：**
根据漏洞描述和搜索结果，POC代码的目的是利用 update configuration 功能来触发远程代码执行。POC通过构造特定的payload发送到目标NameServer的端口，模拟了攻击者利用该漏洞的过程。从代码来看，它首先连接到目标 IP 和端口 (9876)，然后发送一个十六进制编码的 payload，该 payload 旨在利用漏洞执行命令。如果目标存在漏洞，且漏洞利用成功，则会返回包含版本信息的响应。脚本通过正则表达式来确定目标是否存在漏洞以及版本号。因此，如果满足漏洞利用的条件（NameServer地址泄露，缺乏权限验证，且目标版本在受影响范围内），提供的POC代码是有效的。

**投毒风险分析：**
该POC代码的主要功能是漏洞验证，即检测目标系统是否存在 CVE-2023-37582 漏洞。 代码主要由以下几部分组成：定义 payload、创建 socket 连接、发送 payload、接收响应、解析响应并判断目标是否脆弱。

*   **Payload:** Payload 是十六进制编码的字符串，代表一个用于触发漏洞的特殊配置更新请求。该Payload用于触发漏洞，本身不具备恶意代码特性。
*   **Socket 连接:** 这部分代码用于建立与目标 NameServer 的网络连接。
*   **发送和接收数据:** 通过 socket 发送 payload 并接收 NameServer 的响应。
*   **响应解析:** 使用正则表达式解析 NameServer 的响应，以确定目标是否存在漏洞。

代码中没有发现任何明显的恶意行为，例如下载并执行其他程序、修改系统文件、或窃取敏感信息。因此，此仓库中存在作者隐藏的投毒代码的可能性很低。投毒风险评估为 0%。

**利用方式：**
1.  **信息泄露：** 首先，攻击者需要获取 RocketMQ NameServer 的地址，这通常可以通过信息泄露或扫描等方式实现。
2.  **构造 Payload：**  攻击者构造一个包含恶意命令的特殊 Payload，该 Payload 能够利用 NameServer 的配置更新功能执行命令。具体Payload结构在代码中已给出，这是一个JSON格式的配置数据，可能包含命令执行的入口。
3.  **发送请求：** 攻击者通过网络连接将构造好的 Payload 发送到目标 NameServer 的指定端口 (9876)。
4.  **命令执行：** NameServer 在处理配置更新请求时，由于漏洞的存在，会执行 Payload 中包含的恶意命令。
5.  **控制服务器：** 攻击者通过执行的命令获得对服务器的控制权。

**项目地址:** [laishouchao/Apache-RocketMQ-RCE-CVE-2023-37582-poc](https://github.com/laishouchao/Apache-RocketMQ-RCE-CVE-2023-37582-poc)

**漏洞详情:** [CVE-2023-37582](https://nvd.nist.gov/vuln/detail/CVE-2023-37582)

---

## POC #3

**来源**: [CVE-2023-37582-shoucheng3_apache__rocketmq_CVE-2023-37582_4-9-6.md](../2023/CVE-2023-37582-shoucheng3_apache__rocketmq_CVE-2023-37582_4-9-6.md)

## CVE-2023-37582-Apache RocketMQ-远程命令执行

**漏洞编号:** CVE-2023-37582

**漏洞类型:** 远程命令执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 5.0.0 <= version <= 5.1.1, version <= 4.9.6

**利用条件:** NameServer地址泄露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-37582 是 Apache RocketMQ NameServer 组件中的一个远程命令执行漏洞。由于 CVE-2023-33246 的修复不完整，攻击者可以在 NameServer 地址泄露且缺乏权限验证的情况下，利用 update configuration 功能执行任意命令，从而控制服务器。漏洞影响版本包括 RocketMQ 5.0.0 到 5.1.1 以及 4.9.6 及更早版本。

**有效性：**
根据漏洞描述和搜索结果，此漏洞利用代码通过更新 NameServer 的配置来执行命令，因此，如果满足 NameServer 地址泄露且缺乏权限验证这两个条件，那么漏洞利用是有效的。

**投毒风险：**
提供的“漏洞利用代码”实际上是RocketMQ的构建说明，贡献指南，许可证，并非真正的漏洞利用payload。代码中并没有发现明显的恶意代码或后门，因此投毒风险较低,为0%。

**利用方式：**
1.  **发现 NameServer 地址：** 攻击者需要首先获取 NameServer 的公网地址。
2.  **绕过权限验证：**  确定目标 NameServer 没有进行适当的权限验证。
3.  **利用 update configuration 功能：**  构造恶意的配置更新请求，其中包含要执行的系统命令。此命令将以运行 RocketMQ 的系统用户身份执行。
4.  **执行任意命令：**  成功利用漏洞后，攻击者可以执行任何系统命令，从而完全控制服务器。

**项目地址:** [shoucheng3/apache__rocketmq_CVE-2023-37582_4-9-6](https://github.com/shoucheng3/apache__rocketmq_CVE-2023-37582_4-9-6)

**漏洞详情:** [CVE-2023-37582](https://nvd.nist.gov/vuln/detail/CVE-2023-37582)

---



---

## POC #2

**来源**: [CVE-2023-37582-laishouchao_Apache-RocketMQ-RCE-CVE-2023-37582-poc.md](../2023/CVE-2023-37582-laishouchao_Apache-RocketMQ-RCE-CVE-2023-37582-poc.md)

## CVE-2023-37582-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-37582

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 5.0.0 <= version <= 5.1.1, 0 <= version <= 4.9.6

**利用条件:** NameServer地址泄露且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-37582 是 Apache RocketMQ NameServer 组件中的一个远程代码执行漏洞。此漏洞是 CVE-2023-33246 的不完全修复。如果 NameServer 地址泄露到公网且缺乏权限验证，攻击者可以通过更新 NameServer 的配置来执行任意命令，从而完全控制服务器。

**有效性分析：**
根据漏洞描述和搜索结果，POC代码的目的是利用 update configuration 功能来触发远程代码执行。POC通过构造特定的payload发送到目标NameServer的端口，模拟了攻击者利用该漏洞的过程。从代码来看，它首先连接到目标 IP 和端口 (9876)，然后发送一个十六进制编码的 payload，该 payload 旨在利用漏洞执行命令。如果目标存在漏洞，且漏洞利用成功，则会返回包含版本信息的响应。脚本通过正则表达式来确定目标是否存在漏洞以及版本号。因此，如果满足漏洞利用的条件（NameServer地址泄露，缺乏权限验证，且目标版本在受影响范围内），提供的POC代码是有效的。

**投毒风险分析：**
该POC代码的主要功能是漏洞验证，即检测目标系统是否存在 CVE-2023-37582 漏洞。 代码主要由以下几部分组成：定义 payload、创建 socket 连接、发送 payload、接收响应、解析响应并判断目标是否脆弱。

*   **Payload:** Payload 是十六进制编码的字符串，代表一个用于触发漏洞的特殊配置更新请求。该Payload用于触发漏洞，本身不具备恶意代码特性。
*   **Socket 连接:** 这部分代码用于建立与目标 NameServer 的网络连接。
*   **发送和接收数据:** 通过 socket 发送 payload 并接收 NameServer 的响应。
*   **响应解析:** 使用正则表达式解析 NameServer 的响应，以确定目标是否存在漏洞。

代码中没有发现任何明显的恶意行为，例如下载并执行其他程序、修改系统文件、或窃取敏感信息。因此，此仓库中存在作者隐藏的投毒代码的可能性很低。投毒风险评估为 0%。

**利用方式：**
1.  **信息泄露：** 首先，攻击者需要获取 RocketMQ NameServer 的地址，这通常可以通过信息泄露或扫描等方式实现。
2.  **构造 Payload：**  攻击者构造一个包含恶意命令的特殊 Payload，该 Payload 能够利用 NameServer 的配置更新功能执行命令。具体Payload结构在代码中已给出，这是一个JSON格式的配置数据，可能包含命令执行的入口。
3.  **发送请求：** 攻击者通过网络连接将构造好的 Payload 发送到目标 NameServer 的指定端口 (9876)。
4.  **命令执行：** NameServer 在处理配置更新请求时，由于漏洞的存在，会执行 Payload 中包含的恶意命令。
5.  **控制服务器：** 攻击者通过执行的命令获得对服务器的控制权。

**项目地址:** [laishouchao/Apache-RocketMQ-RCE-CVE-2023-37582-poc](https://github.com/laishouchao/Apache-RocketMQ-RCE-CVE-2023-37582-poc)

**漏洞详情:** [CVE-2023-37582](https://nvd.nist.gov/vuln/detail/CVE-2023-37582)

---

## POC #3

**来源**: [CVE-2023-37582-shoucheng3_apache__rocketmq_CVE-2023-37582_4-9-6.md](../2023/CVE-2023-37582-shoucheng3_apache__rocketmq_CVE-2023-37582_4-9-6.md)

## CVE-2023-37582-Apache RocketMQ-远程命令执行

**漏洞编号:** CVE-2023-37582

**漏洞类型:** 远程命令执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 5.0.0 <= version <= 5.1.1, version <= 4.9.6

**利用条件:** NameServer地址泄露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-37582 是 Apache RocketMQ NameServer 组件中的一个远程命令执行漏洞。由于 CVE-2023-33246 的修复不完整，攻击者可以在 NameServer 地址泄露且缺乏权限验证的情况下，利用 update configuration 功能执行任意命令，从而控制服务器。漏洞影响版本包括 RocketMQ 5.0.0 到 5.1.1 以及 4.9.6 及更早版本。

**有效性：**
根据漏洞描述和搜索结果，此漏洞利用代码通过更新 NameServer 的配置来执行命令，因此，如果满足 NameServer 地址泄露且缺乏权限验证这两个条件，那么漏洞利用是有效的。

**投毒风险：**
提供的“漏洞利用代码”实际上是RocketMQ的构建说明，贡献指南，许可证，并非真正的漏洞利用payload。代码中并没有发现明显的恶意代码或后门，因此投毒风险较低,为0%。

**利用方式：**
1.  **发现 NameServer 地址：** 攻击者需要首先获取 NameServer 的公网地址。
2.  **绕过权限验证：**  确定目标 NameServer 没有进行适当的权限验证。
3.  **利用 update configuration 功能：**  构造恶意的配置更新请求，其中包含要执行的系统命令。此命令将以运行 RocketMQ 的系统用户身份执行。
4.  **执行任意命令：**  成功利用漏洞后，攻击者可以执行任何系统命令，从而完全控制服务器。

**项目地址:** [shoucheng3/apache__rocketmq_CVE-2023-37582_4-9-6](https://github.com/shoucheng3/apache__rocketmq_CVE-2023-37582_4-9-6)

**漏洞详情:** [CVE-2023-37582](https://nvd.nist.gov/vuln/detail/CVE-2023-37582)

---



---

## POC #2

**来源**: [CVE-2023-37582-laishouchao_Apache-RocketMQ-RCE-CVE-2023-37582-poc.md](../2023/CVE-2023-37582-laishouchao_Apache-RocketMQ-RCE-CVE-2023-37582-poc.md)

## CVE-2023-37582-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-37582

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 5.0.0 <= version <= 5.1.1, 0 <= version <= 4.9.6

**利用条件:** NameServer地址泄露且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-37582 是 Apache RocketMQ NameServer 组件中的一个远程代码执行漏洞。此漏洞是 CVE-2023-33246 的不完全修复。如果 NameServer 地址泄露到公网且缺乏权限验证，攻击者可以通过更新 NameServer 的配置来执行任意命令，从而完全控制服务器。

**有效性分析：**
根据漏洞描述和搜索结果，POC代码的目的是利用 update configuration 功能来触发远程代码执行。POC通过构造特定的payload发送到目标NameServer的端口，模拟了攻击者利用该漏洞的过程。从代码来看，它首先连接到目标 IP 和端口 (9876)，然后发送一个十六进制编码的 payload，该 payload 旨在利用漏洞执行命令。如果目标存在漏洞，且漏洞利用成功，则会返回包含版本信息的响应。脚本通过正则表达式来确定目标是否存在漏洞以及版本号。因此，如果满足漏洞利用的条件（NameServer地址泄露，缺乏权限验证，且目标版本在受影响范围内），提供的POC代码是有效的。

**投毒风险分析：**
该POC代码的主要功能是漏洞验证，即检测目标系统是否存在 CVE-2023-37582 漏洞。 代码主要由以下几部分组成：定义 payload、创建 socket 连接、发送 payload、接收响应、解析响应并判断目标是否脆弱。

*   **Payload:** Payload 是十六进制编码的字符串，代表一个用于触发漏洞的特殊配置更新请求。该Payload用于触发漏洞，本身不具备恶意代码特性。
*   **Socket 连接:** 这部分代码用于建立与目标 NameServer 的网络连接。
*   **发送和接收数据:** 通过 socket 发送 payload 并接收 NameServer 的响应。
*   **响应解析:** 使用正则表达式解析 NameServer 的响应，以确定目标是否存在漏洞。

代码中没有发现任何明显的恶意行为，例如下载并执行其他程序、修改系统文件、或窃取敏感信息。因此，此仓库中存在作者隐藏的投毒代码的可能性很低。投毒风险评估为 0%。

**利用方式：**
1.  **信息泄露：** 首先，攻击者需要获取 RocketMQ NameServer 的地址，这通常可以通过信息泄露或扫描等方式实现。
2.  **构造 Payload：**  攻击者构造一个包含恶意命令的特殊 Payload，该 Payload 能够利用 NameServer 的配置更新功能执行命令。具体Payload结构在代码中已给出，这是一个JSON格式的配置数据，可能包含命令执行的入口。
3.  **发送请求：** 攻击者通过网络连接将构造好的 Payload 发送到目标 NameServer 的指定端口 (9876)。
4.  **命令执行：** NameServer 在处理配置更新请求时，由于漏洞的存在，会执行 Payload 中包含的恶意命令。
5.  **控制服务器：** 攻击者通过执行的命令获得对服务器的控制权。

**项目地址:** [laishouchao/Apache-RocketMQ-RCE-CVE-2023-37582-poc](https://github.com/laishouchao/Apache-RocketMQ-RCE-CVE-2023-37582-poc)

**漏洞详情:** [CVE-2023-37582](https://nvd.nist.gov/vuln/detail/CVE-2023-37582)

---

## POC #3

**来源**: [CVE-2023-37582-shoucheng3_apache__rocketmq_CVE-2023-37582_4-9-6.md](../2023/CVE-2023-37582-shoucheng3_apache__rocketmq_CVE-2023-37582_4-9-6.md)

## CVE-2023-37582-Apache RocketMQ-远程命令执行

**漏洞编号:** CVE-2023-37582

**漏洞类型:** 远程命令执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 5.0.0 <= version <= 5.1.1, version <= 4.9.6

**利用条件:** NameServer地址泄露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-37582 是 Apache RocketMQ NameServer 组件中的一个远程命令执行漏洞。由于 CVE-2023-33246 的修复不完整，攻击者可以在 NameServer 地址泄露且缺乏权限验证的情况下，利用 update configuration 功能执行任意命令，从而控制服务器。漏洞影响版本包括 RocketMQ 5.0.0 到 5.1.1 以及 4.9.6 及更早版本。

**有效性：**
根据漏洞描述和搜索结果，此漏洞利用代码通过更新 NameServer 的配置来执行命令，因此，如果满足 NameServer 地址泄露且缺乏权限验证这两个条件，那么漏洞利用是有效的。

**投毒风险：**
提供的“漏洞利用代码”实际上是RocketMQ的构建说明，贡献指南，许可证，并非真正的漏洞利用payload。代码中并没有发现明显的恶意代码或后门，因此投毒风险较低,为0%。

**利用方式：**
1.  **发现 NameServer 地址：** 攻击者需要首先获取 NameServer 的公网地址。
2.  **绕过权限验证：**  确定目标 NameServer 没有进行适当的权限验证。
3.  **利用 update configuration 功能：**  构造恶意的配置更新请求，其中包含要执行的系统命令。此命令将以运行 RocketMQ 的系统用户身份执行。
4.  **执行任意命令：**  成功利用漏洞后，攻击者可以执行任何系统命令，从而完全控制服务器。

**项目地址:** [shoucheng3/apache__rocketmq_CVE-2023-37582_4-9-6](https://github.com/shoucheng3/apache__rocketmq_CVE-2023-37582_4-9-6)

**漏洞详情:** [CVE-2023-37582](https://nvd.nist.gov/vuln/detail/CVE-2023-37582)

---



---

## POC #2

**来源**: [CVE-2023-37582-laishouchao_Apache-RocketMQ-RCE-CVE-2023-37582-poc.md](../2023/CVE-2023-37582-laishouchao_Apache-RocketMQ-RCE-CVE-2023-37582-poc.md)

## CVE-2023-37582-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-37582

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 5.0.0 <= version <= 5.1.1, 0 <= version <= 4.9.6

**利用条件:** NameServer地址泄露且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-37582 是 Apache RocketMQ NameServer 组件中的一个远程代码执行漏洞。此漏洞是 CVE-2023-33246 的不完全修复。如果 NameServer 地址泄露到公网且缺乏权限验证，攻击者可以通过更新 NameServer 的配置来执行任意命令，从而完全控制服务器。

**有效性分析：**
根据漏洞描述和搜索结果，POC代码的目的是利用 update configuration 功能来触发远程代码执行。POC通过构造特定的payload发送到目标NameServer的端口，模拟了攻击者利用该漏洞的过程。从代码来看，它首先连接到目标 IP 和端口 (9876)，然后发送一个十六进制编码的 payload，该 payload 旨在利用漏洞执行命令。如果目标存在漏洞，且漏洞利用成功，则会返回包含版本信息的响应。脚本通过正则表达式来确定目标是否存在漏洞以及版本号。因此，如果满足漏洞利用的条件（NameServer地址泄露，缺乏权限验证，且目标版本在受影响范围内），提供的POC代码是有效的。

**投毒风险分析：**
该POC代码的主要功能是漏洞验证，即检测目标系统是否存在 CVE-2023-37582 漏洞。 代码主要由以下几部分组成：定义 payload、创建 socket 连接、发送 payload、接收响应、解析响应并判断目标是否脆弱。

*   **Payload:** Payload 是十六进制编码的字符串，代表一个用于触发漏洞的特殊配置更新请求。该Payload用于触发漏洞，本身不具备恶意代码特性。
*   **Socket 连接:** 这部分代码用于建立与目标 NameServer 的网络连接。
*   **发送和接收数据:** 通过 socket 发送 payload 并接收 NameServer 的响应。
*   **响应解析:** 使用正则表达式解析 NameServer 的响应，以确定目标是否存在漏洞。

代码中没有发现任何明显的恶意行为，例如下载并执行其他程序、修改系统文件、或窃取敏感信息。因此，此仓库中存在作者隐藏的投毒代码的可能性很低。投毒风险评估为 0%。

**利用方式：**
1.  **信息泄露：** 首先，攻击者需要获取 RocketMQ NameServer 的地址，这通常可以通过信息泄露或扫描等方式实现。
2.  **构造 Payload：**  攻击者构造一个包含恶意命令的特殊 Payload，该 Payload 能够利用 NameServer 的配置更新功能执行命令。具体Payload结构在代码中已给出，这是一个JSON格式的配置数据，可能包含命令执行的入口。
3.  **发送请求：** 攻击者通过网络连接将构造好的 Payload 发送到目标 NameServer 的指定端口 (9876)。
4.  **命令执行：** NameServer 在处理配置更新请求时，由于漏洞的存在，会执行 Payload 中包含的恶意命令。
5.  **控制服务器：** 攻击者通过执行的命令获得对服务器的控制权。

**项目地址:** [laishouchao/Apache-RocketMQ-RCE-CVE-2023-37582-poc](https://github.com/laishouchao/Apache-RocketMQ-RCE-CVE-2023-37582-poc)

**漏洞详情:** [CVE-2023-37582](https://nvd.nist.gov/vuln/detail/CVE-2023-37582)

---

## POC #3

**来源**: [CVE-2023-37582-shoucheng3_apache__rocketmq_CVE-2023-37582_4-9-6.md](../2023/CVE-2023-37582-shoucheng3_apache__rocketmq_CVE-2023-37582_4-9-6.md)

## CVE-2023-37582-Apache RocketMQ-远程命令执行

**漏洞编号:** CVE-2023-37582

**漏洞类型:** 远程命令执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 5.0.0 <= version <= 5.1.1, version <= 4.9.6

**利用条件:** NameServer地址泄露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-37582 是 Apache RocketMQ NameServer 组件中的一个远程命令执行漏洞。由于 CVE-2023-33246 的修复不完整，攻击者可以在 NameServer 地址泄露且缺乏权限验证的情况下，利用 update configuration 功能执行任意命令，从而控制服务器。漏洞影响版本包括 RocketMQ 5.0.0 到 5.1.1 以及 4.9.6 及更早版本。

**有效性：**
根据漏洞描述和搜索结果，此漏洞利用代码通过更新 NameServer 的配置来执行命令，因此，如果满足 NameServer 地址泄露且缺乏权限验证这两个条件，那么漏洞利用是有效的。

**投毒风险：**
提供的“漏洞利用代码”实际上是RocketMQ的构建说明，贡献指南，许可证，并非真正的漏洞利用payload。代码中并没有发现明显的恶意代码或后门，因此投毒风险较低,为0%。

**利用方式：**
1.  **发现 NameServer 地址：** 攻击者需要首先获取 NameServer 的公网地址。
2.  **绕过权限验证：**  确定目标 NameServer 没有进行适当的权限验证。
3.  **利用 update configuration 功能：**  构造恶意的配置更新请求，其中包含要执行的系统命令。此命令将以运行 RocketMQ 的系统用户身份执行。
4.  **执行任意命令：**  成功利用漏洞后，攻击者可以执行任何系统命令，从而完全控制服务器。

**项目地址:** [shoucheng3/apache__rocketmq_CVE-2023-37582_4-9-6](https://github.com/shoucheng3/apache__rocketmq_CVE-2023-37582_4-9-6)

**漏洞详情:** [CVE-2023-37582](https://nvd.nist.gov/vuln/detail/CVE-2023-37582)

---



---

## POC #2

**来源**: [CVE-2023-37582-laishouchao_Apache-RocketMQ-RCE-CVE-2023-37582-poc.md](../2023/CVE-2023-37582-laishouchao_Apache-RocketMQ-RCE-CVE-2023-37582-poc.md)

## CVE-2023-37582-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-37582

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 5.0.0 <= version <= 5.1.1, 0 <= version <= 4.9.6

**利用条件:** NameServer地址泄露且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-37582 是 Apache RocketMQ NameServer 组件中的一个远程代码执行漏洞。此漏洞是 CVE-2023-33246 的不完全修复。如果 NameServer 地址泄露到公网且缺乏权限验证，攻击者可以通过更新 NameServer 的配置来执行任意命令，从而完全控制服务器。

**有效性分析：**
根据漏洞描述和搜索结果，POC代码的目的是利用 update configuration 功能来触发远程代码执行。POC通过构造特定的payload发送到目标NameServer的端口，模拟了攻击者利用该漏洞的过程。从代码来看，它首先连接到目标 IP 和端口 (9876)，然后发送一个十六进制编码的 payload，该 payload 旨在利用漏洞执行命令。如果目标存在漏洞，且漏洞利用成功，则会返回包含版本信息的响应。脚本通过正则表达式来确定目标是否存在漏洞以及版本号。因此，如果满足漏洞利用的条件（NameServer地址泄露，缺乏权限验证，且目标版本在受影响范围内），提供的POC代码是有效的。

**投毒风险分析：**
该POC代码的主要功能是漏洞验证，即检测目标系统是否存在 CVE-2023-37582 漏洞。 代码主要由以下几部分组成：定义 payload、创建 socket 连接、发送 payload、接收响应、解析响应并判断目标是否脆弱。

*   **Payload:** Payload 是十六进制编码的字符串，代表一个用于触发漏洞的特殊配置更新请求。该Payload用于触发漏洞，本身不具备恶意代码特性。
*   **Socket 连接:** 这部分代码用于建立与目标 NameServer 的网络连接。
*   **发送和接收数据:** 通过 socket 发送 payload 并接收 NameServer 的响应。
*   **响应解析:** 使用正则表达式解析 NameServer 的响应，以确定目标是否存在漏洞。

代码中没有发现任何明显的恶意行为，例如下载并执行其他程序、修改系统文件、或窃取敏感信息。因此，此仓库中存在作者隐藏的投毒代码的可能性很低。投毒风险评估为 0%。

**利用方式：**
1.  **信息泄露：** 首先，攻击者需要获取 RocketMQ NameServer 的地址，这通常可以通过信息泄露或扫描等方式实现。
2.  **构造 Payload：**  攻击者构造一个包含恶意命令的特殊 Payload，该 Payload 能够利用 NameServer 的配置更新功能执行命令。具体Payload结构在代码中已给出，这是一个JSON格式的配置数据，可能包含命令执行的入口。
3.  **发送请求：** 攻击者通过网络连接将构造好的 Payload 发送到目标 NameServer 的指定端口 (9876)。
4.  **命令执行：** NameServer 在处理配置更新请求时，由于漏洞的存在，会执行 Payload 中包含的恶意命令。
5.  **控制服务器：** 攻击者通过执行的命令获得对服务器的控制权。

**项目地址:** [laishouchao/Apache-RocketMQ-RCE-CVE-2023-37582-poc](https://github.com/laishouchao/Apache-RocketMQ-RCE-CVE-2023-37582-poc)

**漏洞详情:** [CVE-2023-37582](https://nvd.nist.gov/vuln/detail/CVE-2023-37582)

---

## POC #3

**来源**: [CVE-2023-37582-shoucheng3_apache__rocketmq_CVE-2023-37582_4-9-6.md](../2023/CVE-2023-37582-shoucheng3_apache__rocketmq_CVE-2023-37582_4-9-6.md)

## CVE-2023-37582-Apache RocketMQ-远程命令执行

**漏洞编号:** CVE-2023-37582

**漏洞类型:** 远程命令执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 5.0.0 <= version <= 5.1.1, version <= 4.9.6

**利用条件:** NameServer地址泄露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-37582 是 Apache RocketMQ NameServer 组件中的一个远程命令执行漏洞。由于 CVE-2023-33246 的修复不完整，攻击者可以在 NameServer 地址泄露且缺乏权限验证的情况下，利用 update configuration 功能执行任意命令，从而控制服务器。漏洞影响版本包括 RocketMQ 5.0.0 到 5.1.1 以及 4.9.6 及更早版本。

**有效性：**
根据漏洞描述和搜索结果，此漏洞利用代码通过更新 NameServer 的配置来执行命令，因此，如果满足 NameServer 地址泄露且缺乏权限验证这两个条件，那么漏洞利用是有效的。

**投毒风险：**
提供的“漏洞利用代码”实际上是RocketMQ的构建说明，贡献指南，许可证，并非真正的漏洞利用payload。代码中并没有发现明显的恶意代码或后门，因此投毒风险较低,为0%。

**利用方式：**
1.  **发现 NameServer 地址：** 攻击者需要首先获取 NameServer 的公网地址。
2.  **绕过权限验证：**  确定目标 NameServer 没有进行适当的权限验证。
3.  **利用 update configuration 功能：**  构造恶意的配置更新请求，其中包含要执行的系统命令。此命令将以运行 RocketMQ 的系统用户身份执行。
4.  **执行任意命令：**  成功利用漏洞后，攻击者可以执行任何系统命令，从而完全控制服务器。

**项目地址:** [shoucheng3/apache__rocketmq_CVE-2023-37582_4-9-6](https://github.com/shoucheng3/apache__rocketmq_CVE-2023-37582_4-9-6)

**漏洞详情:** [CVE-2023-37582](https://nvd.nist.gov/vuln/detail/CVE-2023-37582)

---



---

## POC #2

**来源**: [CVE-2023-37582-laishouchao_Apache-RocketMQ-RCE-CVE-2023-37582-poc.md](../2023/CVE-2023-37582-laishouchao_Apache-RocketMQ-RCE-CVE-2023-37582-poc.md)

## CVE-2023-37582-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-37582

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 5.0.0 <= version <= 5.1.1, 0 <= version <= 4.9.6

**利用条件:** NameServer地址泄露且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-37582 是 Apache RocketMQ NameServer 组件中的一个远程代码执行漏洞。此漏洞是 CVE-2023-33246 的不完全修复。如果 NameServer 地址泄露到公网且缺乏权限验证，攻击者可以通过更新 NameServer 的配置来执行任意命令，从而完全控制服务器。

**有效性分析：**
根据漏洞描述和搜索结果，POC代码的目的是利用 update configuration 功能来触发远程代码执行。POC通过构造特定的payload发送到目标NameServer的端口，模拟了攻击者利用该漏洞的过程。从代码来看，它首先连接到目标 IP 和端口 (9876)，然后发送一个十六进制编码的 payload，该 payload 旨在利用漏洞执行命令。如果目标存在漏洞，且漏洞利用成功，则会返回包含版本信息的响应。脚本通过正则表达式来确定目标是否存在漏洞以及版本号。因此，如果满足漏洞利用的条件（NameServer地址泄露，缺乏权限验证，且目标版本在受影响范围内），提供的POC代码是有效的。

**投毒风险分析：**
该POC代码的主要功能是漏洞验证，即检测目标系统是否存在 CVE-2023-37582 漏洞。 代码主要由以下几部分组成：定义 payload、创建 socket 连接、发送 payload、接收响应、解析响应并判断目标是否脆弱。

*   **Payload:** Payload 是十六进制编码的字符串，代表一个用于触发漏洞的特殊配置更新请求。该Payload用于触发漏洞，本身不具备恶意代码特性。
*   **Socket 连接:** 这部分代码用于建立与目标 NameServer 的网络连接。
*   **发送和接收数据:** 通过 socket 发送 payload 并接收 NameServer 的响应。
*   **响应解析:** 使用正则表达式解析 NameServer 的响应，以确定目标是否存在漏洞。

代码中没有发现任何明显的恶意行为，例如下载并执行其他程序、修改系统文件、或窃取敏感信息。因此，此仓库中存在作者隐藏的投毒代码的可能性很低。投毒风险评估为 0%。

**利用方式：**
1.  **信息泄露：** 首先，攻击者需要获取 RocketMQ NameServer 的地址，这通常可以通过信息泄露或扫描等方式实现。
2.  **构造 Payload：**  攻击者构造一个包含恶意命令的特殊 Payload，该 Payload 能够利用 NameServer 的配置更新功能执行命令。具体Payload结构在代码中已给出，这是一个JSON格式的配置数据，可能包含命令执行的入口。
3.  **发送请求：** 攻击者通过网络连接将构造好的 Payload 发送到目标 NameServer 的指定端口 (9876)。
4.  **命令执行：** NameServer 在处理配置更新请求时，由于漏洞的存在，会执行 Payload 中包含的恶意命令。
5.  **控制服务器：** 攻击者通过执行的命令获得对服务器的控制权。

**项目地址:** [laishouchao/Apache-RocketMQ-RCE-CVE-2023-37582-poc](https://github.com/laishouchao/Apache-RocketMQ-RCE-CVE-2023-37582-poc)

**漏洞详情:** [CVE-2023-37582](https://nvd.nist.gov/vuln/detail/CVE-2023-37582)

---

## POC #3

**来源**: [CVE-2023-37582-shoucheng3_apache__rocketmq_CVE-2023-37582_4-9-6.md](../2023/CVE-2023-37582-shoucheng3_apache__rocketmq_CVE-2023-37582_4-9-6.md)

## CVE-2023-37582-Apache RocketMQ-远程命令执行

**漏洞编号:** CVE-2023-37582

**漏洞类型:** 远程命令执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 5.0.0 <= version <= 5.1.1, version <= 4.9.6

**利用条件:** NameServer地址泄露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-37582 是 Apache RocketMQ NameServer 组件中的一个远程命令执行漏洞。由于 CVE-2023-33246 的修复不完整，攻击者可以在 NameServer 地址泄露且缺乏权限验证的情况下，利用 update configuration 功能执行任意命令，从而控制服务器。漏洞影响版本包括 RocketMQ 5.0.0 到 5.1.1 以及 4.9.6 及更早版本。

**有效性：**
根据漏洞描述和搜索结果，此漏洞利用代码通过更新 NameServer 的配置来执行命令，因此，如果满足 NameServer 地址泄露且缺乏权限验证这两个条件，那么漏洞利用是有效的。

**投毒风险：**
提供的“漏洞利用代码”实际上是RocketMQ的构建说明，贡献指南，许可证，并非真正的漏洞利用payload。代码中并没有发现明显的恶意代码或后门，因此投毒风险较低,为0%。

**利用方式：**
1.  **发现 NameServer 地址：** 攻击者需要首先获取 NameServer 的公网地址。
2.  **绕过权限验证：**  确定目标 NameServer 没有进行适当的权限验证。
3.  **利用 update configuration 功能：**  构造恶意的配置更新请求，其中包含要执行的系统命令。此命令将以运行 RocketMQ 的系统用户身份执行。
4.  **执行任意命令：**  成功利用漏洞后，攻击者可以执行任何系统命令，从而完全控制服务器。

**项目地址:** [shoucheng3/apache__rocketmq_CVE-2023-37582_4-9-6](https://github.com/shoucheng3/apache__rocketmq_CVE-2023-37582_4-9-6)

**漏洞详情:** [CVE-2023-37582](https://nvd.nist.gov/vuln/detail/CVE-2023-37582)

---



---

## POC #2

**来源**: [CVE-2023-37582-laishouchao_Apache-RocketMQ-RCE-CVE-2023-37582-poc.md](../2023/CVE-2023-37582-laishouchao_Apache-RocketMQ-RCE-CVE-2023-37582-poc.md)

## CVE-2023-37582-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-37582

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 5.0.0 <= version <= 5.1.1, 0 <= version <= 4.9.6

**利用条件:** NameServer地址泄露且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-37582 是 Apache RocketMQ NameServer 组件中的一个远程代码执行漏洞。此漏洞是 CVE-2023-33246 的不完全修复。如果 NameServer 地址泄露到公网且缺乏权限验证，攻击者可以通过更新 NameServer 的配置来执行任意命令，从而完全控制服务器。

**有效性分析：**
根据漏洞描述和搜索结果，POC代码的目的是利用 update configuration 功能来触发远程代码执行。POC通过构造特定的payload发送到目标NameServer的端口，模拟了攻击者利用该漏洞的过程。从代码来看，它首先连接到目标 IP 和端口 (9876)，然后发送一个十六进制编码的 payload，该 payload 旨在利用漏洞执行命令。如果目标存在漏洞，且漏洞利用成功，则会返回包含版本信息的响应。脚本通过正则表达式来确定目标是否存在漏洞以及版本号。因此，如果满足漏洞利用的条件（NameServer地址泄露，缺乏权限验证，且目标版本在受影响范围内），提供的POC代码是有效的。

**投毒风险分析：**
该POC代码的主要功能是漏洞验证，即检测目标系统是否存在 CVE-2023-37582 漏洞。 代码主要由以下几部分组成：定义 payload、创建 socket 连接、发送 payload、接收响应、解析响应并判断目标是否脆弱。

*   **Payload:** Payload 是十六进制编码的字符串，代表一个用于触发漏洞的特殊配置更新请求。该Payload用于触发漏洞，本身不具备恶意代码特性。
*   **Socket 连接:** 这部分代码用于建立与目标 NameServer 的网络连接。
*   **发送和接收数据:** 通过 socket 发送 payload 并接收 NameServer 的响应。
*   **响应解析:** 使用正则表达式解析 NameServer 的响应，以确定目标是否存在漏洞。

代码中没有发现任何明显的恶意行为，例如下载并执行其他程序、修改系统文件、或窃取敏感信息。因此，此仓库中存在作者隐藏的投毒代码的可能性很低。投毒风险评估为 0%。

**利用方式：**
1.  **信息泄露：** 首先，攻击者需要获取 RocketMQ NameServer 的地址，这通常可以通过信息泄露或扫描等方式实现。
2.  **构造 Payload：**  攻击者构造一个包含恶意命令的特殊 Payload，该 Payload 能够利用 NameServer 的配置更新功能执行命令。具体Payload结构在代码中已给出，这是一个JSON格式的配置数据，可能包含命令执行的入口。
3.  **发送请求：** 攻击者通过网络连接将构造好的 Payload 发送到目标 NameServer 的指定端口 (9876)。
4.  **命令执行：** NameServer 在处理配置更新请求时，由于漏洞的存在，会执行 Payload 中包含的恶意命令。
5.  **控制服务器：** 攻击者通过执行的命令获得对服务器的控制权。

**项目地址:** [laishouchao/Apache-RocketMQ-RCE-CVE-2023-37582-poc](https://github.com/laishouchao/Apache-RocketMQ-RCE-CVE-2023-37582-poc)

**漏洞详情:** [CVE-2023-37582](https://nvd.nist.gov/vuln/detail/CVE-2023-37582)

---

## POC #3

**来源**: [CVE-2023-37582-shoucheng3_apache__rocketmq_CVE-2023-37582_4-9-6.md](../2023/CVE-2023-37582-shoucheng3_apache__rocketmq_CVE-2023-37582_4-9-6.md)

## CVE-2023-37582-Apache RocketMQ-远程命令执行

**漏洞编号:** CVE-2023-37582

**漏洞类型:** 远程命令执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 5.0.0 <= version <= 5.1.1, version <= 4.9.6

**利用条件:** NameServer地址泄露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-37582 是 Apache RocketMQ NameServer 组件中的一个远程命令执行漏洞。由于 CVE-2023-33246 的修复不完整，攻击者可以在 NameServer 地址泄露且缺乏权限验证的情况下，利用 update configuration 功能执行任意命令，从而控制服务器。漏洞影响版本包括 RocketMQ 5.0.0 到 5.1.1 以及 4.9.6 及更早版本。

**有效性：**
根据漏洞描述和搜索结果，此漏洞利用代码通过更新 NameServer 的配置来执行命令，因此，如果满足 NameServer 地址泄露且缺乏权限验证这两个条件，那么漏洞利用是有效的。

**投毒风险：**
提供的“漏洞利用代码”实际上是RocketMQ的构建说明，贡献指南，许可证，并非真正的漏洞利用payload。代码中并没有发现明显的恶意代码或后门，因此投毒风险较低,为0%。

**利用方式：**
1.  **发现 NameServer 地址：** 攻击者需要首先获取 NameServer 的公网地址。
2.  **绕过权限验证：**  确定目标 NameServer 没有进行适当的权限验证。
3.  **利用 update configuration 功能：**  构造恶意的配置更新请求，其中包含要执行的系统命令。此命令将以运行 RocketMQ 的系统用户身份执行。
4.  **执行任意命令：**  成功利用漏洞后，攻击者可以执行任何系统命令，从而完全控制服务器。

**项目地址:** [shoucheng3/apache__rocketmq_CVE-2023-37582_4-9-6](https://github.com/shoucheng3/apache__rocketmq_CVE-2023-37582_4-9-6)

**漏洞详情:** [CVE-2023-37582](https://nvd.nist.gov/vuln/detail/CVE-2023-37582)

---

