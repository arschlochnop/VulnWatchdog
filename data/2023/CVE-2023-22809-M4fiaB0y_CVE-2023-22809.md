# CVE-2023-22809

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-22809-AiK1d_CVE-2023-22809-sudo-POC.md](../2023/CVE-2023-22809-AiK1d_CVE-2023-22809-sudo-POC.md)

## CVE-2023-22809-sudo权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许本地攻击者获得root权限

**影响版本:** 1.8.0 到 1.9.12p1

**利用条件:** 用户需要具有使用sudoedit或sudo -e的权限，并且sudo版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 存在于 sudo 1.9.12p2 之前的版本中，sudoedit (或 -e) 功能错误地处理了用户提供的环境变量（SUDO_EDITOR、VISUAL 和 EDITOR）中传递的额外参数，允许本地攻击者将任意条目附加到要处理的文件列表中，导致权限提升。漏洞利用方式是，攻击者可以通过设置恶意的环境变量，例如 EDITOR='vim -- /etc/sudoers'，当使用 sudoedit 编辑文件时，会将 /etc/sudoers 附加到 vim 的命令行参数中，从而允许攻击者以 root 权限编辑 /etc/sudoers 文件。PoC代码首先检查sudo版本是否在受影响的范围内，然后检查当前用户是否具有以root身份运行sudoedit的权限。如果条件满足，PoC会提示用户将包含提权信息的行添加到/etc/sudoers文件中，然后利用漏洞打开sudoers文件。

**项目地址:** [AiK1d/CVE-2023-22809-sudo-POC](https://github.com/AiK1d/CVE-2023-22809-sudo-POC)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #2

**来源**: [CVE-2023-22809-AntiVlad_CVE-2023-22809.md](../2023/CVE-2023-22809-AntiVlad_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许本地低权限用户提升至root权限

**影响版本:** 1.8.0 <= version < 1.9.12p2

**利用条件:** 需要目标系统存在sudo且版本在受影响范围内，并且用户拥有sudoedit权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809是sudoedit中的一个权限提升漏洞。该漏洞源于sudoedit在处理用户提供的环境变量（SUDO_EDITOR, VISUAL, EDITOR）中的额外参数时存在缺陷。攻击者可以通过设置包含`--`参数的恶意编辑器环境变量来绕过保护机制，并附加任意文件到sudoedit处理的文件列表中，从而以root权限编辑或创建任意文件。

**有效性:** 根据漏洞描述和搜索结果，提供的POC代码利用了此漏洞。它通过设置环境变量，使得`sudoedit`可以执行任意命令，进而复制`/bin/bash`并设置SUID位，最终通过执行`/tmp/bash -p`来获取root权限。因此，POC代码是有效的。

**投毒风险:** POC代码的主要目的是提权，执行`cp /bin/bash /tmp/bash && chmod +s /tmp/bash`，这是一个提权的常见手法，验证漏洞是否存在。该脚本中没有明显的恶意代码。但如果此脚本被放入一个恶意软件仓库，则可以被认为含有一定的投毒风险，比如作者可以加入其他恶意操作在提权后执行。风险占比大约10%。

**利用方式:**
1.  攻击者需要在一个已经存在sudo的系统上拥有一个低权限账户，并且该账户可以使用sudoedit命令。
2.  攻击者通过设置环境变量`SUDO_EDITOR`、`VISUAL`或`EDITOR`，使其包含`--`参数以及想要操作的恶意文件路径。
3.  攻击者运行`sudoedit`命令。
4.  `sudoedit`会错误地将恶意文件添加到要编辑的文件列表中，从而允许攻击者以root权限编辑或创建这些文件。
5.  攻击者利用该权限修改系统文件，或者如POC中所示，复制一个具有SUID权限的bash shell，然后执行该shell以获得root权限。

**项目地址:** [AntiVlad/CVE-2023-22809](https://github.com/AntiVlad/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #3

**来源**: [CVE-2023-22809-Chan9Yan9_CVE-2023-22809.md](../2023/CVE-2023-22809-Chan9Yan9_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许低权限用户提升到root权限

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 用户需要具有sudoedit权限，可以编辑至少一个文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809漏洞存在于sudo的sudoedit功能中。该漏洞是由于sudoedit在处理用户提供的环境变量(SUDO_EDITOR, VISUAL, EDITOR)中的额外参数时存在缺陷，允许本地攻击者通过在环境变量中注入包含“--”的恶意参数，将任意文件添加到待编辑的文件列表中，从而绕过sudoers策略，编辑本无权编辑的文件，最终提升权限。

**有效性:** 根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。漏洞利用代码中的exp_passwd.sh脚本通过修改/etc/passwd文件将root用户的权限赋予当前用户，exp_sudoers.sh脚本通过修改/etc/sudoers文件，允许当前用户无密码执行sudo命令，从而实现权限提升。

**投毒风险:** 漏洞利用代码中存在一定的投毒风险，风险评估为10%。

*   **exp_passwd.sh:** 该脚本直接修改/etc/passwd文件，将root的用户名替换为当前用户名。如果攻击者恶意修改该脚本，可能会导致系统账户出现混乱，甚至导致系统无法启动。虽然脚本的目的是为了权限提升，但是修改passwd是比较敏感的操作，有潜在风险。
*   **exp_sudoers.sh:** 该脚本通过修改/etc/sudoers文件，允许当前用户无密码执行sudo命令。如果攻击者恶意修改该脚本，可能会添加其他用户的sudo权限，或者直接禁用所有用户的sudo权限。

**利用方式:**

1.  **检查sudo版本:** 脚本首先检查当前sudo版本是否在受影响范围内。
2.  **检查sudoedit权限:** 脚本检查当前用户是否具有sudoedit权限，并且可以编辑root拥有的文件。
3.  **修改/etc/passwd (exp_passwd.sh):**  如果条件满足，exp_passwd.sh脚本会提示用户修改/etc/passwd文件，将root的用户名替换为当前用户名，从而获得root权限。 需要手动修改，需要用户干预，存在社工风险
4.  **修改/etc/sudoers (exp_sudoers.sh):** 如果条件满足，exp_sudoers.sh脚本会提示用户修改/etc/sudoers文件，添加一行配置，允许当前用户无密码执行sudo命令，然后切换到root用户，从而获得root权限。 需要手动修改，需要用户干预，存在社工风险

总而言之，该漏洞的利用方式是利用sudoedit的参数处理缺陷，篡改敏感文件（/etc/passwd或/etc/sudoers）来实现权限提升。虽然脚本本身提供了提权的手段，但是修改系统关键配置文件始终存在一定的风险，攻击者可以在此基础上进行恶意投毒。

**项目地址:** [Chan9Yan9/CVE-2023-22809](https://github.com/Chan9Yan9/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #4

**来源**: [CVE-2023-22809-D0rDa4aN919_CVE-2023-22809-Exploiter.md](../2023/CVE-2023-22809-D0rDa4aN919_CVE-2023-22809-Exploiter.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，可能导致本地用户权限提升至root

**影响版本:** 1.8.0 through 1.9.12p1

**利用条件:** 需要目标系统安装受影响版本的Sudo，并允许用户通过sudoedit或sudo -e编辑文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809漏洞存在于Sudo 1.8.0到1.9.12p1版本中，`sudoedit` (或者 `sudo -e`) 功能在处理用户提供的环境变量（`SUDO_EDITOR`, `VISUAL`, 和 `EDITOR`）时，错误地处理了额外的参数，导致本地攻击者可以附加任意条目到待处理的文件列表中，从而导致权限提升。例如，设置`EDITOR='vim -- /path/to/extra/file'`可以绕过保护机制。

**有效性评估：**

提供的Python和Bash脚本旨在利用此漏洞，它们通过设置恶意的环境变量来欺骗`sudoedit`，从而允许用户编辑`/etc/sudoers`或其他特权文件。根据漏洞描述，以及提供的代码，该利用方式是有效的，可以导致权限提升。

**投毒风险分析：**

分析提供的代码，发现存在以下风险：

1.  **信息收集：**  脚本中存在收集sudo版本信息的代码，用于判断目标是否受影响。但可能存在未声明的信息收集行为，虽然目前没有发现明显的后门代码，但仍然存在一定的风险，概率约为10%。
2.  **依赖风险：**  虽然脚本自身没有明显的投毒代码，但是考虑到开源项目的依赖风险，以及作者声明免责声明，需要谨慎使用。

**利用方式：**

1.  **漏洞触发：**  通过设置`SUDO_EDITOR`、`VISUAL`或`EDITOR`环境变量，在其中包含`--`参数，以及想要编辑的恶意文件路径。
2.  **权限提升：**  当用户执行`sudoedit`命令时，由于漏洞，`sudoedit`会将恶意文件添加到编辑列表，允许低权限用户编辑高权限文件，例如`/etc/sudoers`，从而获得root权限。
3.  **POC脚本利用：**  提供的POC脚本简化了上述过程，通过执行脚本自动设置环境变量，检查Sudo版本，并尝试利用漏洞。

**项目地址:** [D0rDa4aN919/CVE-2023-22809-Exploiter](https://github.com/D0rDa4aN919/CVE-2023-22809-Exploiter)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #5

**来源**: [CVE-2023-22809-M4fiaB0y_CVE-2023-22809.md](../2023/CVE-2023-22809-M4fiaB0y_CVE-2023-22809.md)

# CVE-2023-22809

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-22809-AiK1d_CVE-2023-22809-sudo-POC.md](../2023/CVE-2023-22809-AiK1d_CVE-2023-22809-sudo-POC.md)

## CVE-2023-22809-sudo权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许本地攻击者获得root权限

**影响版本:** 1.8.0 到 1.9.12p1

**利用条件:** 用户需要具有使用sudoedit或sudo -e的权限，并且sudo版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 存在于 sudo 1.9.12p2 之前的版本中，sudoedit (或 -e) 功能错误地处理了用户提供的环境变量（SUDO_EDITOR、VISUAL 和 EDITOR）中传递的额外参数，允许本地攻击者将任意条目附加到要处理的文件列表中，导致权限提升。漏洞利用方式是，攻击者可以通过设置恶意的环境变量，例如 EDITOR='vim -- /etc/sudoers'，当使用 sudoedit 编辑文件时，会将 /etc/sudoers 附加到 vim 的命令行参数中，从而允许攻击者以 root 权限编辑 /etc/sudoers 文件。PoC代码首先检查sudo版本是否在受影响的范围内，然后检查当前用户是否具有以root身份运行sudoedit的权限。如果条件满足，PoC会提示用户将包含提权信息的行添加到/etc/sudoers文件中，然后利用漏洞打开sudoers文件。

**项目地址:** [AiK1d/CVE-2023-22809-sudo-POC](https://github.com/AiK1d/CVE-2023-22809-sudo-POC)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #2

**来源**: [CVE-2023-22809-AntiVlad_CVE-2023-22809.md](../2023/CVE-2023-22809-AntiVlad_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许本地低权限用户提升至root权限

**影响版本:** 1.8.0 <= version < 1.9.12p2

**利用条件:** 需要目标系统存在sudo且版本在受影响范围内，并且用户拥有sudoedit权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809是sudoedit中的一个权限提升漏洞。该漏洞源于sudoedit在处理用户提供的环境变量（SUDO_EDITOR, VISUAL, EDITOR）中的额外参数时存在缺陷。攻击者可以通过设置包含`--`参数的恶意编辑器环境变量来绕过保护机制，并附加任意文件到sudoedit处理的文件列表中，从而以root权限编辑或创建任意文件。

**有效性:** 根据漏洞描述和搜索结果，提供的POC代码利用了此漏洞。它通过设置环境变量，使得`sudoedit`可以执行任意命令，进而复制`/bin/bash`并设置SUID位，最终通过执行`/tmp/bash -p`来获取root权限。因此，POC代码是有效的。

**投毒风险:** POC代码的主要目的是提权，执行`cp /bin/bash /tmp/bash && chmod +s /tmp/bash`，这是一个提权的常见手法，验证漏洞是否存在。该脚本中没有明显的恶意代码。但如果此脚本被放入一个恶意软件仓库，则可以被认为含有一定的投毒风险，比如作者可以加入其他恶意操作在提权后执行。风险占比大约10%。

**利用方式:**
1.  攻击者需要在一个已经存在sudo的系统上拥有一个低权限账户，并且该账户可以使用sudoedit命令。
2.  攻击者通过设置环境变量`SUDO_EDITOR`、`VISUAL`或`EDITOR`，使其包含`--`参数以及想要操作的恶意文件路径。
3.  攻击者运行`sudoedit`命令。
4.  `sudoedit`会错误地将恶意文件添加到要编辑的文件列表中，从而允许攻击者以root权限编辑或创建这些文件。
5.  攻击者利用该权限修改系统文件，或者如POC中所示，复制一个具有SUID权限的bash shell，然后执行该shell以获得root权限。

**项目地址:** [AntiVlad/CVE-2023-22809](https://github.com/AntiVlad/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #3

**来源**: [CVE-2023-22809-Chan9Yan9_CVE-2023-22809.md](../2023/CVE-2023-22809-Chan9Yan9_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许低权限用户提升到root权限

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 用户需要具有sudoedit权限，可以编辑至少一个文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809漏洞存在于sudo的sudoedit功能中。该漏洞是由于sudoedit在处理用户提供的环境变量(SUDO_EDITOR, VISUAL, EDITOR)中的额外参数时存在缺陷，允许本地攻击者通过在环境变量中注入包含“--”的恶意参数，将任意文件添加到待编辑的文件列表中，从而绕过sudoers策略，编辑本无权编辑的文件，最终提升权限。

**有效性:** 根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。漏洞利用代码中的exp_passwd.sh脚本通过修改/etc/passwd文件将root用户的权限赋予当前用户，exp_sudoers.sh脚本通过修改/etc/sudoers文件，允许当前用户无密码执行sudo命令，从而实现权限提升。

**投毒风险:** 漏洞利用代码中存在一定的投毒风险，风险评估为10%。

*   **exp_passwd.sh:** 该脚本直接修改/etc/passwd文件，将root的用户名替换为当前用户名。如果攻击者恶意修改该脚本，可能会导致系统账户出现混乱，甚至导致系统无法启动。虽然脚本的目的是为了权限提升，但是修改passwd是比较敏感的操作，有潜在风险。
*   **exp_sudoers.sh:** 该脚本通过修改/etc/sudoers文件，允许当前用户无密码执行sudo命令。如果攻击者恶意修改该脚本，可能会添加其他用户的sudo权限，或者直接禁用所有用户的sudo权限。

**利用方式:**

1.  **检查sudo版本:** 脚本首先检查当前sudo版本是否在受影响范围内。
2.  **检查sudoedit权限:** 脚本检查当前用户是否具有sudoedit权限，并且可以编辑root拥有的文件。
3.  **修改/etc/passwd (exp_passwd.sh):**  如果条件满足，exp_passwd.sh脚本会提示用户修改/etc/passwd文件，将root的用户名替换为当前用户名，从而获得root权限。 需要手动修改，需要用户干预，存在社工风险
4.  **修改/etc/sudoers (exp_sudoers.sh):** 如果条件满足，exp_sudoers.sh脚本会提示用户修改/etc/sudoers文件，添加一行配置，允许当前用户无密码执行sudo命令，然后切换到root用户，从而获得root权限。 需要手动修改，需要用户干预，存在社工风险

总而言之，该漏洞的利用方式是利用sudoedit的参数处理缺陷，篡改敏感文件（/etc/passwd或/etc/sudoers）来实现权限提升。虽然脚本本身提供了提权的手段，但是修改系统关键配置文件始终存在一定的风险，攻击者可以在此基础上进行恶意投毒。

**项目地址:** [Chan9Yan9/CVE-2023-22809](https://github.com/Chan9Yan9/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #4

**来源**: [CVE-2023-22809-D0rDa4aN919_CVE-2023-22809-Exploiter.md](../2023/CVE-2023-22809-D0rDa4aN919_CVE-2023-22809-Exploiter.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，可能导致本地用户权限提升至root

**影响版本:** 1.8.0 through 1.9.12p1

**利用条件:** 需要目标系统安装受影响版本的Sudo，并允许用户通过sudoedit或sudo -e编辑文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809漏洞存在于Sudo 1.8.0到1.9.12p1版本中，`sudoedit` (或者 `sudo -e`) 功能在处理用户提供的环境变量（`SUDO_EDITOR`, `VISUAL`, 和 `EDITOR`）时，错误地处理了额外的参数，导致本地攻击者可以附加任意条目到待处理的文件列表中，从而导致权限提升。例如，设置`EDITOR='vim -- /path/to/extra/file'`可以绕过保护机制。

**有效性评估：**

提供的Python和Bash脚本旨在利用此漏洞，它们通过设置恶意的环境变量来欺骗`sudoedit`，从而允许用户编辑`/etc/sudoers`或其他特权文件。根据漏洞描述，以及提供的代码，该利用方式是有效的，可以导致权限提升。

**投毒风险分析：**

分析提供的代码，发现存在以下风险：

1.  **信息收集：**  脚本中存在收集sudo版本信息的代码，用于判断目标是否受影响。但可能存在未声明的信息收集行为，虽然目前没有发现明显的后门代码，但仍然存在一定的风险，概率约为10%。
2.  **依赖风险：**  虽然脚本自身没有明显的投毒代码，但是考虑到开源项目的依赖风险，以及作者声明免责声明，需要谨慎使用。

**利用方式：**

1.  **漏洞触发：**  通过设置`SUDO_EDITOR`、`VISUAL`或`EDITOR`环境变量，在其中包含`--`参数，以及想要编辑的恶意文件路径。
2.  **权限提升：**  当用户执行`sudoedit`命令时，由于漏洞，`sudoedit`会将恶意文件添加到编辑列表，允许低权限用户编辑高权限文件，例如`/etc/sudoers`，从而获得root权限。
3.  **POC脚本利用：**  提供的POC脚本简化了上述过程，通过执行脚本自动设置环境变量，检查Sudo版本，并尝试利用漏洞。

**项目地址:** [D0rDa4aN919/CVE-2023-22809-Exploiter](https://github.com/D0rDa4aN919/CVE-2023-22809-Exploiter)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #5

**来源**: [CVE-2023-22809-M4fiaB0y_CVE-2023-22809.md](../2023/CVE-2023-22809-M4fiaB0y_CVE-2023-22809.md)

# CVE-2023-22809

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-22809-AiK1d_CVE-2023-22809-sudo-POC.md](../2023/CVE-2023-22809-AiK1d_CVE-2023-22809-sudo-POC.md)

## CVE-2023-22809-sudo权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许本地攻击者获得root权限

**影响版本:** 1.8.0 到 1.9.12p1

**利用条件:** 用户需要具有使用sudoedit或sudo -e的权限，并且sudo版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 存在于 sudo 1.9.12p2 之前的版本中，sudoedit (或 -e) 功能错误地处理了用户提供的环境变量（SUDO_EDITOR、VISUAL 和 EDITOR）中传递的额外参数，允许本地攻击者将任意条目附加到要处理的文件列表中，导致权限提升。漏洞利用方式是，攻击者可以通过设置恶意的环境变量，例如 EDITOR='vim -- /etc/sudoers'，当使用 sudoedit 编辑文件时，会将 /etc/sudoers 附加到 vim 的命令行参数中，从而允许攻击者以 root 权限编辑 /etc/sudoers 文件。PoC代码首先检查sudo版本是否在受影响的范围内，然后检查当前用户是否具有以root身份运行sudoedit的权限。如果条件满足，PoC会提示用户将包含提权信息的行添加到/etc/sudoers文件中，然后利用漏洞打开sudoers文件。

**项目地址:** [AiK1d/CVE-2023-22809-sudo-POC](https://github.com/AiK1d/CVE-2023-22809-sudo-POC)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #2

**来源**: [CVE-2023-22809-AntiVlad_CVE-2023-22809.md](../2023/CVE-2023-22809-AntiVlad_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许本地低权限用户提升至root权限

**影响版本:** 1.8.0 <= version < 1.9.12p2

**利用条件:** 需要目标系统存在sudo且版本在受影响范围内，并且用户拥有sudoedit权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809是sudoedit中的一个权限提升漏洞。该漏洞源于sudoedit在处理用户提供的环境变量（SUDO_EDITOR, VISUAL, EDITOR）中的额外参数时存在缺陷。攻击者可以通过设置包含`--`参数的恶意编辑器环境变量来绕过保护机制，并附加任意文件到sudoedit处理的文件列表中，从而以root权限编辑或创建任意文件。

**有效性:** 根据漏洞描述和搜索结果，提供的POC代码利用了此漏洞。它通过设置环境变量，使得`sudoedit`可以执行任意命令，进而复制`/bin/bash`并设置SUID位，最终通过执行`/tmp/bash -p`来获取root权限。因此，POC代码是有效的。

**投毒风险:** POC代码的主要目的是提权，执行`cp /bin/bash /tmp/bash && chmod +s /tmp/bash`，这是一个提权的常见手法，验证漏洞是否存在。该脚本中没有明显的恶意代码。但如果此脚本被放入一个恶意软件仓库，则可以被认为含有一定的投毒风险，比如作者可以加入其他恶意操作在提权后执行。风险占比大约10%。

**利用方式:**
1.  攻击者需要在一个已经存在sudo的系统上拥有一个低权限账户，并且该账户可以使用sudoedit命令。
2.  攻击者通过设置环境变量`SUDO_EDITOR`、`VISUAL`或`EDITOR`，使其包含`--`参数以及想要操作的恶意文件路径。
3.  攻击者运行`sudoedit`命令。
4.  `sudoedit`会错误地将恶意文件添加到要编辑的文件列表中，从而允许攻击者以root权限编辑或创建这些文件。
5.  攻击者利用该权限修改系统文件，或者如POC中所示，复制一个具有SUID权限的bash shell，然后执行该shell以获得root权限。

**项目地址:** [AntiVlad/CVE-2023-22809](https://github.com/AntiVlad/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #3

**来源**: [CVE-2023-22809-Chan9Yan9_CVE-2023-22809.md](../2023/CVE-2023-22809-Chan9Yan9_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许低权限用户提升到root权限

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 用户需要具有sudoedit权限，可以编辑至少一个文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809漏洞存在于sudo的sudoedit功能中。该漏洞是由于sudoedit在处理用户提供的环境变量(SUDO_EDITOR, VISUAL, EDITOR)中的额外参数时存在缺陷，允许本地攻击者通过在环境变量中注入包含“--”的恶意参数，将任意文件添加到待编辑的文件列表中，从而绕过sudoers策略，编辑本无权编辑的文件，最终提升权限。

**有效性:** 根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。漏洞利用代码中的exp_passwd.sh脚本通过修改/etc/passwd文件将root用户的权限赋予当前用户，exp_sudoers.sh脚本通过修改/etc/sudoers文件，允许当前用户无密码执行sudo命令，从而实现权限提升。

**投毒风险:** 漏洞利用代码中存在一定的投毒风险，风险评估为10%。

*   **exp_passwd.sh:** 该脚本直接修改/etc/passwd文件，将root的用户名替换为当前用户名。如果攻击者恶意修改该脚本，可能会导致系统账户出现混乱，甚至导致系统无法启动。虽然脚本的目的是为了权限提升，但是修改passwd是比较敏感的操作，有潜在风险。
*   **exp_sudoers.sh:** 该脚本通过修改/etc/sudoers文件，允许当前用户无密码执行sudo命令。如果攻击者恶意修改该脚本，可能会添加其他用户的sudo权限，或者直接禁用所有用户的sudo权限。

**利用方式:**

1.  **检查sudo版本:** 脚本首先检查当前sudo版本是否在受影响范围内。
2.  **检查sudoedit权限:** 脚本检查当前用户是否具有sudoedit权限，并且可以编辑root拥有的文件。
3.  **修改/etc/passwd (exp_passwd.sh):**  如果条件满足，exp_passwd.sh脚本会提示用户修改/etc/passwd文件，将root的用户名替换为当前用户名，从而获得root权限。 需要手动修改，需要用户干预，存在社工风险
4.  **修改/etc/sudoers (exp_sudoers.sh):** 如果条件满足，exp_sudoers.sh脚本会提示用户修改/etc/sudoers文件，添加一行配置，允许当前用户无密码执行sudo命令，然后切换到root用户，从而获得root权限。 需要手动修改，需要用户干预，存在社工风险

总而言之，该漏洞的利用方式是利用sudoedit的参数处理缺陷，篡改敏感文件（/etc/passwd或/etc/sudoers）来实现权限提升。虽然脚本本身提供了提权的手段，但是修改系统关键配置文件始终存在一定的风险，攻击者可以在此基础上进行恶意投毒。

**项目地址:** [Chan9Yan9/CVE-2023-22809](https://github.com/Chan9Yan9/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #4

**来源**: [CVE-2023-22809-D0rDa4aN919_CVE-2023-22809-Exploiter.md](../2023/CVE-2023-22809-D0rDa4aN919_CVE-2023-22809-Exploiter.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，可能导致本地用户权限提升至root

**影响版本:** 1.8.0 through 1.9.12p1

**利用条件:** 需要目标系统安装受影响版本的Sudo，并允许用户通过sudoedit或sudo -e编辑文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809漏洞存在于Sudo 1.8.0到1.9.12p1版本中，`sudoedit` (或者 `sudo -e`) 功能在处理用户提供的环境变量（`SUDO_EDITOR`, `VISUAL`, 和 `EDITOR`）时，错误地处理了额外的参数，导致本地攻击者可以附加任意条目到待处理的文件列表中，从而导致权限提升。例如，设置`EDITOR='vim -- /path/to/extra/file'`可以绕过保护机制。

**有效性评估：**

提供的Python和Bash脚本旨在利用此漏洞，它们通过设置恶意的环境变量来欺骗`sudoedit`，从而允许用户编辑`/etc/sudoers`或其他特权文件。根据漏洞描述，以及提供的代码，该利用方式是有效的，可以导致权限提升。

**投毒风险分析：**

分析提供的代码，发现存在以下风险：

1.  **信息收集：**  脚本中存在收集sudo版本信息的代码，用于判断目标是否受影响。但可能存在未声明的信息收集行为，虽然目前没有发现明显的后门代码，但仍然存在一定的风险，概率约为10%。
2.  **依赖风险：**  虽然脚本自身没有明显的投毒代码，但是考虑到开源项目的依赖风险，以及作者声明免责声明，需要谨慎使用。

**利用方式：**

1.  **漏洞触发：**  通过设置`SUDO_EDITOR`、`VISUAL`或`EDITOR`环境变量，在其中包含`--`参数，以及想要编辑的恶意文件路径。
2.  **权限提升：**  当用户执行`sudoedit`命令时，由于漏洞，`sudoedit`会将恶意文件添加到编辑列表，允许低权限用户编辑高权限文件，例如`/etc/sudoers`，从而获得root权限。
3.  **POC脚本利用：**  提供的POC脚本简化了上述过程，通过执行脚本自动设置环境变量，检查Sudo版本，并尝试利用漏洞。

**项目地址:** [D0rDa4aN919/CVE-2023-22809-Exploiter](https://github.com/D0rDa4aN919/CVE-2023-22809-Exploiter)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #5

**来源**: [CVE-2023-22809-M4fiaB0y_CVE-2023-22809.md](../2023/CVE-2023-22809-M4fiaB0y_CVE-2023-22809.md)

# CVE-2023-22809

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-22809-AiK1d_CVE-2023-22809-sudo-POC.md](../2023/CVE-2023-22809-AiK1d_CVE-2023-22809-sudo-POC.md)

## CVE-2023-22809-sudo权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许本地攻击者获得root权限

**影响版本:** 1.8.0 到 1.9.12p1

**利用条件:** 用户需要具有使用sudoedit或sudo -e的权限，并且sudo版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 存在于 sudo 1.9.12p2 之前的版本中，sudoedit (或 -e) 功能错误地处理了用户提供的环境变量（SUDO_EDITOR、VISUAL 和 EDITOR）中传递的额外参数，允许本地攻击者将任意条目附加到要处理的文件列表中，导致权限提升。漏洞利用方式是，攻击者可以通过设置恶意的环境变量，例如 EDITOR='vim -- /etc/sudoers'，当使用 sudoedit 编辑文件时，会将 /etc/sudoers 附加到 vim 的命令行参数中，从而允许攻击者以 root 权限编辑 /etc/sudoers 文件。PoC代码首先检查sudo版本是否在受影响的范围内，然后检查当前用户是否具有以root身份运行sudoedit的权限。如果条件满足，PoC会提示用户将包含提权信息的行添加到/etc/sudoers文件中，然后利用漏洞打开sudoers文件。

**项目地址:** [AiK1d/CVE-2023-22809-sudo-POC](https://github.com/AiK1d/CVE-2023-22809-sudo-POC)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #2

**来源**: [CVE-2023-22809-AntiVlad_CVE-2023-22809.md](../2023/CVE-2023-22809-AntiVlad_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许本地低权限用户提升至root权限

**影响版本:** 1.8.0 <= version < 1.9.12p2

**利用条件:** 需要目标系统存在sudo且版本在受影响范围内，并且用户拥有sudoedit权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809是sudoedit中的一个权限提升漏洞。该漏洞源于sudoedit在处理用户提供的环境变量（SUDO_EDITOR, VISUAL, EDITOR）中的额外参数时存在缺陷。攻击者可以通过设置包含`--`参数的恶意编辑器环境变量来绕过保护机制，并附加任意文件到sudoedit处理的文件列表中，从而以root权限编辑或创建任意文件。

**有效性:** 根据漏洞描述和搜索结果，提供的POC代码利用了此漏洞。它通过设置环境变量，使得`sudoedit`可以执行任意命令，进而复制`/bin/bash`并设置SUID位，最终通过执行`/tmp/bash -p`来获取root权限。因此，POC代码是有效的。

**投毒风险:** POC代码的主要目的是提权，执行`cp /bin/bash /tmp/bash && chmod +s /tmp/bash`，这是一个提权的常见手法，验证漏洞是否存在。该脚本中没有明显的恶意代码。但如果此脚本被放入一个恶意软件仓库，则可以被认为含有一定的投毒风险，比如作者可以加入其他恶意操作在提权后执行。风险占比大约10%。

**利用方式:**
1.  攻击者需要在一个已经存在sudo的系统上拥有一个低权限账户，并且该账户可以使用sudoedit命令。
2.  攻击者通过设置环境变量`SUDO_EDITOR`、`VISUAL`或`EDITOR`，使其包含`--`参数以及想要操作的恶意文件路径。
3.  攻击者运行`sudoedit`命令。
4.  `sudoedit`会错误地将恶意文件添加到要编辑的文件列表中，从而允许攻击者以root权限编辑或创建这些文件。
5.  攻击者利用该权限修改系统文件，或者如POC中所示，复制一个具有SUID权限的bash shell，然后执行该shell以获得root权限。

**项目地址:** [AntiVlad/CVE-2023-22809](https://github.com/AntiVlad/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #3

**来源**: [CVE-2023-22809-Chan9Yan9_CVE-2023-22809.md](../2023/CVE-2023-22809-Chan9Yan9_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许低权限用户提升到root权限

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 用户需要具有sudoedit权限，可以编辑至少一个文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809漏洞存在于sudo的sudoedit功能中。该漏洞是由于sudoedit在处理用户提供的环境变量(SUDO_EDITOR, VISUAL, EDITOR)中的额外参数时存在缺陷，允许本地攻击者通过在环境变量中注入包含“--”的恶意参数，将任意文件添加到待编辑的文件列表中，从而绕过sudoers策略，编辑本无权编辑的文件，最终提升权限。

**有效性:** 根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。漏洞利用代码中的exp_passwd.sh脚本通过修改/etc/passwd文件将root用户的权限赋予当前用户，exp_sudoers.sh脚本通过修改/etc/sudoers文件，允许当前用户无密码执行sudo命令，从而实现权限提升。

**投毒风险:** 漏洞利用代码中存在一定的投毒风险，风险评估为10%。

*   **exp_passwd.sh:** 该脚本直接修改/etc/passwd文件，将root的用户名替换为当前用户名。如果攻击者恶意修改该脚本，可能会导致系统账户出现混乱，甚至导致系统无法启动。虽然脚本的目的是为了权限提升，但是修改passwd是比较敏感的操作，有潜在风险。
*   **exp_sudoers.sh:** 该脚本通过修改/etc/sudoers文件，允许当前用户无密码执行sudo命令。如果攻击者恶意修改该脚本，可能会添加其他用户的sudo权限，或者直接禁用所有用户的sudo权限。

**利用方式:**

1.  **检查sudo版本:** 脚本首先检查当前sudo版本是否在受影响范围内。
2.  **检查sudoedit权限:** 脚本检查当前用户是否具有sudoedit权限，并且可以编辑root拥有的文件。
3.  **修改/etc/passwd (exp_passwd.sh):**  如果条件满足，exp_passwd.sh脚本会提示用户修改/etc/passwd文件，将root的用户名替换为当前用户名，从而获得root权限。 需要手动修改，需要用户干预，存在社工风险
4.  **修改/etc/sudoers (exp_sudoers.sh):** 如果条件满足，exp_sudoers.sh脚本会提示用户修改/etc/sudoers文件，添加一行配置，允许当前用户无密码执行sudo命令，然后切换到root用户，从而获得root权限。 需要手动修改，需要用户干预，存在社工风险

总而言之，该漏洞的利用方式是利用sudoedit的参数处理缺陷，篡改敏感文件（/etc/passwd或/etc/sudoers）来实现权限提升。虽然脚本本身提供了提权的手段，但是修改系统关键配置文件始终存在一定的风险，攻击者可以在此基础上进行恶意投毒。

**项目地址:** [Chan9Yan9/CVE-2023-22809](https://github.com/Chan9Yan9/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #4

**来源**: [CVE-2023-22809-D0rDa4aN919_CVE-2023-22809-Exploiter.md](../2023/CVE-2023-22809-D0rDa4aN919_CVE-2023-22809-Exploiter.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，可能导致本地用户权限提升至root

**影响版本:** 1.8.0 through 1.9.12p1

**利用条件:** 需要目标系统安装受影响版本的Sudo，并允许用户通过sudoedit或sudo -e编辑文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809漏洞存在于Sudo 1.8.0到1.9.12p1版本中，`sudoedit` (或者 `sudo -e`) 功能在处理用户提供的环境变量（`SUDO_EDITOR`, `VISUAL`, 和 `EDITOR`）时，错误地处理了额外的参数，导致本地攻击者可以附加任意条目到待处理的文件列表中，从而导致权限提升。例如，设置`EDITOR='vim -- /path/to/extra/file'`可以绕过保护机制。

**有效性评估：**

提供的Python和Bash脚本旨在利用此漏洞，它们通过设置恶意的环境变量来欺骗`sudoedit`，从而允许用户编辑`/etc/sudoers`或其他特权文件。根据漏洞描述，以及提供的代码，该利用方式是有效的，可以导致权限提升。

**投毒风险分析：**

分析提供的代码，发现存在以下风险：

1.  **信息收集：**  脚本中存在收集sudo版本信息的代码，用于判断目标是否受影响。但可能存在未声明的信息收集行为，虽然目前没有发现明显的后门代码，但仍然存在一定的风险，概率约为10%。
2.  **依赖风险：**  虽然脚本自身没有明显的投毒代码，但是考虑到开源项目的依赖风险，以及作者声明免责声明，需要谨慎使用。

**利用方式：**

1.  **漏洞触发：**  通过设置`SUDO_EDITOR`、`VISUAL`或`EDITOR`环境变量，在其中包含`--`参数，以及想要编辑的恶意文件路径。
2.  **权限提升：**  当用户执行`sudoedit`命令时，由于漏洞，`sudoedit`会将恶意文件添加到编辑列表，允许低权限用户编辑高权限文件，例如`/etc/sudoers`，从而获得root权限。
3.  **POC脚本利用：**  提供的POC脚本简化了上述过程，通过执行脚本自动设置环境变量，检查Sudo版本，并尝试利用漏洞。

**项目地址:** [D0rDa4aN919/CVE-2023-22809-Exploiter](https://github.com/D0rDa4aN919/CVE-2023-22809-Exploiter)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #5

**来源**: [CVE-2023-22809-M4fiaB0y_CVE-2023-22809.md](../2023/CVE-2023-22809-M4fiaB0y_CVE-2023-22809.md)

# CVE-2023-22809

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-22809-AiK1d_CVE-2023-22809-sudo-POC.md](../2023/CVE-2023-22809-AiK1d_CVE-2023-22809-sudo-POC.md)

## CVE-2023-22809-sudo权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许本地攻击者获得root权限

**影响版本:** 1.8.0 到 1.9.12p1

**利用条件:** 用户需要具有使用sudoedit或sudo -e的权限，并且sudo版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 存在于 sudo 1.9.12p2 之前的版本中，sudoedit (或 -e) 功能错误地处理了用户提供的环境变量（SUDO_EDITOR、VISUAL 和 EDITOR）中传递的额外参数，允许本地攻击者将任意条目附加到要处理的文件列表中，导致权限提升。漏洞利用方式是，攻击者可以通过设置恶意的环境变量，例如 EDITOR='vim -- /etc/sudoers'，当使用 sudoedit 编辑文件时，会将 /etc/sudoers 附加到 vim 的命令行参数中，从而允许攻击者以 root 权限编辑 /etc/sudoers 文件。PoC代码首先检查sudo版本是否在受影响的范围内，然后检查当前用户是否具有以root身份运行sudoedit的权限。如果条件满足，PoC会提示用户将包含提权信息的行添加到/etc/sudoers文件中，然后利用漏洞打开sudoers文件。

**项目地址:** [AiK1d/CVE-2023-22809-sudo-POC](https://github.com/AiK1d/CVE-2023-22809-sudo-POC)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #2

**来源**: [CVE-2023-22809-AntiVlad_CVE-2023-22809.md](../2023/CVE-2023-22809-AntiVlad_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许本地低权限用户提升至root权限

**影响版本:** 1.8.0 <= version < 1.9.12p2

**利用条件:** 需要目标系统存在sudo且版本在受影响范围内，并且用户拥有sudoedit权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809是sudoedit中的一个权限提升漏洞。该漏洞源于sudoedit在处理用户提供的环境变量（SUDO_EDITOR, VISUAL, EDITOR）中的额外参数时存在缺陷。攻击者可以通过设置包含`--`参数的恶意编辑器环境变量来绕过保护机制，并附加任意文件到sudoedit处理的文件列表中，从而以root权限编辑或创建任意文件。

**有效性:** 根据漏洞描述和搜索结果，提供的POC代码利用了此漏洞。它通过设置环境变量，使得`sudoedit`可以执行任意命令，进而复制`/bin/bash`并设置SUID位，最终通过执行`/tmp/bash -p`来获取root权限。因此，POC代码是有效的。

**投毒风险:** POC代码的主要目的是提权，执行`cp /bin/bash /tmp/bash && chmod +s /tmp/bash`，这是一个提权的常见手法，验证漏洞是否存在。该脚本中没有明显的恶意代码。但如果此脚本被放入一个恶意软件仓库，则可以被认为含有一定的投毒风险，比如作者可以加入其他恶意操作在提权后执行。风险占比大约10%。

**利用方式:**
1.  攻击者需要在一个已经存在sudo的系统上拥有一个低权限账户，并且该账户可以使用sudoedit命令。
2.  攻击者通过设置环境变量`SUDO_EDITOR`、`VISUAL`或`EDITOR`，使其包含`--`参数以及想要操作的恶意文件路径。
3.  攻击者运行`sudoedit`命令。
4.  `sudoedit`会错误地将恶意文件添加到要编辑的文件列表中，从而允许攻击者以root权限编辑或创建这些文件。
5.  攻击者利用该权限修改系统文件，或者如POC中所示，复制一个具有SUID权限的bash shell，然后执行该shell以获得root权限。

**项目地址:** [AntiVlad/CVE-2023-22809](https://github.com/AntiVlad/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #3

**来源**: [CVE-2023-22809-Chan9Yan9_CVE-2023-22809.md](../2023/CVE-2023-22809-Chan9Yan9_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许低权限用户提升到root权限

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 用户需要具有sudoedit权限，可以编辑至少一个文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809漏洞存在于sudo的sudoedit功能中。该漏洞是由于sudoedit在处理用户提供的环境变量(SUDO_EDITOR, VISUAL, EDITOR)中的额外参数时存在缺陷，允许本地攻击者通过在环境变量中注入包含“--”的恶意参数，将任意文件添加到待编辑的文件列表中，从而绕过sudoers策略，编辑本无权编辑的文件，最终提升权限。

**有效性:** 根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。漏洞利用代码中的exp_passwd.sh脚本通过修改/etc/passwd文件将root用户的权限赋予当前用户，exp_sudoers.sh脚本通过修改/etc/sudoers文件，允许当前用户无密码执行sudo命令，从而实现权限提升。

**投毒风险:** 漏洞利用代码中存在一定的投毒风险，风险评估为10%。

*   **exp_passwd.sh:** 该脚本直接修改/etc/passwd文件，将root的用户名替换为当前用户名。如果攻击者恶意修改该脚本，可能会导致系统账户出现混乱，甚至导致系统无法启动。虽然脚本的目的是为了权限提升，但是修改passwd是比较敏感的操作，有潜在风险。
*   **exp_sudoers.sh:** 该脚本通过修改/etc/sudoers文件，允许当前用户无密码执行sudo命令。如果攻击者恶意修改该脚本，可能会添加其他用户的sudo权限，或者直接禁用所有用户的sudo权限。

**利用方式:**

1.  **检查sudo版本:** 脚本首先检查当前sudo版本是否在受影响范围内。
2.  **检查sudoedit权限:** 脚本检查当前用户是否具有sudoedit权限，并且可以编辑root拥有的文件。
3.  **修改/etc/passwd (exp_passwd.sh):**  如果条件满足，exp_passwd.sh脚本会提示用户修改/etc/passwd文件，将root的用户名替换为当前用户名，从而获得root权限。 需要手动修改，需要用户干预，存在社工风险
4.  **修改/etc/sudoers (exp_sudoers.sh):** 如果条件满足，exp_sudoers.sh脚本会提示用户修改/etc/sudoers文件，添加一行配置，允许当前用户无密码执行sudo命令，然后切换到root用户，从而获得root权限。 需要手动修改，需要用户干预，存在社工风险

总而言之，该漏洞的利用方式是利用sudoedit的参数处理缺陷，篡改敏感文件（/etc/passwd或/etc/sudoers）来实现权限提升。虽然脚本本身提供了提权的手段，但是修改系统关键配置文件始终存在一定的风险，攻击者可以在此基础上进行恶意投毒。

**项目地址:** [Chan9Yan9/CVE-2023-22809](https://github.com/Chan9Yan9/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #4

**来源**: [CVE-2023-22809-D0rDa4aN919_CVE-2023-22809-Exploiter.md](../2023/CVE-2023-22809-D0rDa4aN919_CVE-2023-22809-Exploiter.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，可能导致本地用户权限提升至root

**影响版本:** 1.8.0 through 1.9.12p1

**利用条件:** 需要目标系统安装受影响版本的Sudo，并允许用户通过sudoedit或sudo -e编辑文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809漏洞存在于Sudo 1.8.0到1.9.12p1版本中，`sudoedit` (或者 `sudo -e`) 功能在处理用户提供的环境变量（`SUDO_EDITOR`, `VISUAL`, 和 `EDITOR`）时，错误地处理了额外的参数，导致本地攻击者可以附加任意条目到待处理的文件列表中，从而导致权限提升。例如，设置`EDITOR='vim -- /path/to/extra/file'`可以绕过保护机制。

**有效性评估：**

提供的Python和Bash脚本旨在利用此漏洞，它们通过设置恶意的环境变量来欺骗`sudoedit`，从而允许用户编辑`/etc/sudoers`或其他特权文件。根据漏洞描述，以及提供的代码，该利用方式是有效的，可以导致权限提升。

**投毒风险分析：**

分析提供的代码，发现存在以下风险：

1.  **信息收集：**  脚本中存在收集sudo版本信息的代码，用于判断目标是否受影响。但可能存在未声明的信息收集行为，虽然目前没有发现明显的后门代码，但仍然存在一定的风险，概率约为10%。
2.  **依赖风险：**  虽然脚本自身没有明显的投毒代码，但是考虑到开源项目的依赖风险，以及作者声明免责声明，需要谨慎使用。

**利用方式：**

1.  **漏洞触发：**  通过设置`SUDO_EDITOR`、`VISUAL`或`EDITOR`环境变量，在其中包含`--`参数，以及想要编辑的恶意文件路径。
2.  **权限提升：**  当用户执行`sudoedit`命令时，由于漏洞，`sudoedit`会将恶意文件添加到编辑列表，允许低权限用户编辑高权限文件，例如`/etc/sudoers`，从而获得root权限。
3.  **POC脚本利用：**  提供的POC脚本简化了上述过程，通过执行脚本自动设置环境变量，检查Sudo版本，并尝试利用漏洞。

**项目地址:** [D0rDa4aN919/CVE-2023-22809-Exploiter](https://github.com/D0rDa4aN919/CVE-2023-22809-Exploiter)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #5

**来源**: [CVE-2023-22809-M4fiaB0y_CVE-2023-22809.md](../2023/CVE-2023-22809-M4fiaB0y_CVE-2023-22809.md)

# CVE-2023-22809

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-22809-AiK1d_CVE-2023-22809-sudo-POC.md](../2023/CVE-2023-22809-AiK1d_CVE-2023-22809-sudo-POC.md)

## CVE-2023-22809-sudo权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许本地攻击者获得root权限

**影响版本:** 1.8.0 到 1.9.12p1

**利用条件:** 用户需要具有使用sudoedit或sudo -e的权限，并且sudo版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 存在于 sudo 1.9.12p2 之前的版本中，sudoedit (或 -e) 功能错误地处理了用户提供的环境变量（SUDO_EDITOR、VISUAL 和 EDITOR）中传递的额外参数，允许本地攻击者将任意条目附加到要处理的文件列表中，导致权限提升。漏洞利用方式是，攻击者可以通过设置恶意的环境变量，例如 EDITOR='vim -- /etc/sudoers'，当使用 sudoedit 编辑文件时，会将 /etc/sudoers 附加到 vim 的命令行参数中，从而允许攻击者以 root 权限编辑 /etc/sudoers 文件。PoC代码首先检查sudo版本是否在受影响的范围内，然后检查当前用户是否具有以root身份运行sudoedit的权限。如果条件满足，PoC会提示用户将包含提权信息的行添加到/etc/sudoers文件中，然后利用漏洞打开sudoers文件。

**项目地址:** [AiK1d/CVE-2023-22809-sudo-POC](https://github.com/AiK1d/CVE-2023-22809-sudo-POC)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #2

**来源**: [CVE-2023-22809-AntiVlad_CVE-2023-22809.md](../2023/CVE-2023-22809-AntiVlad_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许本地低权限用户提升至root权限

**影响版本:** 1.8.0 <= version < 1.9.12p2

**利用条件:** 需要目标系统存在sudo且版本在受影响范围内，并且用户拥有sudoedit权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809是sudoedit中的一个权限提升漏洞。该漏洞源于sudoedit在处理用户提供的环境变量（SUDO_EDITOR, VISUAL, EDITOR）中的额外参数时存在缺陷。攻击者可以通过设置包含`--`参数的恶意编辑器环境变量来绕过保护机制，并附加任意文件到sudoedit处理的文件列表中，从而以root权限编辑或创建任意文件。

**有效性:** 根据漏洞描述和搜索结果，提供的POC代码利用了此漏洞。它通过设置环境变量，使得`sudoedit`可以执行任意命令，进而复制`/bin/bash`并设置SUID位，最终通过执行`/tmp/bash -p`来获取root权限。因此，POC代码是有效的。

**投毒风险:** POC代码的主要目的是提权，执行`cp /bin/bash /tmp/bash && chmod +s /tmp/bash`，这是一个提权的常见手法，验证漏洞是否存在。该脚本中没有明显的恶意代码。但如果此脚本被放入一个恶意软件仓库，则可以被认为含有一定的投毒风险，比如作者可以加入其他恶意操作在提权后执行。风险占比大约10%。

**利用方式:**
1.  攻击者需要在一个已经存在sudo的系统上拥有一个低权限账户，并且该账户可以使用sudoedit命令。
2.  攻击者通过设置环境变量`SUDO_EDITOR`、`VISUAL`或`EDITOR`，使其包含`--`参数以及想要操作的恶意文件路径。
3.  攻击者运行`sudoedit`命令。
4.  `sudoedit`会错误地将恶意文件添加到要编辑的文件列表中，从而允许攻击者以root权限编辑或创建这些文件。
5.  攻击者利用该权限修改系统文件，或者如POC中所示，复制一个具有SUID权限的bash shell，然后执行该shell以获得root权限。

**项目地址:** [AntiVlad/CVE-2023-22809](https://github.com/AntiVlad/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #3

**来源**: [CVE-2023-22809-Chan9Yan9_CVE-2023-22809.md](../2023/CVE-2023-22809-Chan9Yan9_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许低权限用户提升到root权限

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 用户需要具有sudoedit权限，可以编辑至少一个文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809漏洞存在于sudo的sudoedit功能中。该漏洞是由于sudoedit在处理用户提供的环境变量(SUDO_EDITOR, VISUAL, EDITOR)中的额外参数时存在缺陷，允许本地攻击者通过在环境变量中注入包含“--”的恶意参数，将任意文件添加到待编辑的文件列表中，从而绕过sudoers策略，编辑本无权编辑的文件，最终提升权限。

**有效性:** 根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。漏洞利用代码中的exp_passwd.sh脚本通过修改/etc/passwd文件将root用户的权限赋予当前用户，exp_sudoers.sh脚本通过修改/etc/sudoers文件，允许当前用户无密码执行sudo命令，从而实现权限提升。

**投毒风险:** 漏洞利用代码中存在一定的投毒风险，风险评估为10%。

*   **exp_passwd.sh:** 该脚本直接修改/etc/passwd文件，将root的用户名替换为当前用户名。如果攻击者恶意修改该脚本，可能会导致系统账户出现混乱，甚至导致系统无法启动。虽然脚本的目的是为了权限提升，但是修改passwd是比较敏感的操作，有潜在风险。
*   **exp_sudoers.sh:** 该脚本通过修改/etc/sudoers文件，允许当前用户无密码执行sudo命令。如果攻击者恶意修改该脚本，可能会添加其他用户的sudo权限，或者直接禁用所有用户的sudo权限。

**利用方式:**

1.  **检查sudo版本:** 脚本首先检查当前sudo版本是否在受影响范围内。
2.  **检查sudoedit权限:** 脚本检查当前用户是否具有sudoedit权限，并且可以编辑root拥有的文件。
3.  **修改/etc/passwd (exp_passwd.sh):**  如果条件满足，exp_passwd.sh脚本会提示用户修改/etc/passwd文件，将root的用户名替换为当前用户名，从而获得root权限。 需要手动修改，需要用户干预，存在社工风险
4.  **修改/etc/sudoers (exp_sudoers.sh):** 如果条件满足，exp_sudoers.sh脚本会提示用户修改/etc/sudoers文件，添加一行配置，允许当前用户无密码执行sudo命令，然后切换到root用户，从而获得root权限。 需要手动修改，需要用户干预，存在社工风险

总而言之，该漏洞的利用方式是利用sudoedit的参数处理缺陷，篡改敏感文件（/etc/passwd或/etc/sudoers）来实现权限提升。虽然脚本本身提供了提权的手段，但是修改系统关键配置文件始终存在一定的风险，攻击者可以在此基础上进行恶意投毒。

**项目地址:** [Chan9Yan9/CVE-2023-22809](https://github.com/Chan9Yan9/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #4

**来源**: [CVE-2023-22809-D0rDa4aN919_CVE-2023-22809-Exploiter.md](../2023/CVE-2023-22809-D0rDa4aN919_CVE-2023-22809-Exploiter.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，可能导致本地用户权限提升至root

**影响版本:** 1.8.0 through 1.9.12p1

**利用条件:** 需要目标系统安装受影响版本的Sudo，并允许用户通过sudoedit或sudo -e编辑文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809漏洞存在于Sudo 1.8.0到1.9.12p1版本中，`sudoedit` (或者 `sudo -e`) 功能在处理用户提供的环境变量（`SUDO_EDITOR`, `VISUAL`, 和 `EDITOR`）时，错误地处理了额外的参数，导致本地攻击者可以附加任意条目到待处理的文件列表中，从而导致权限提升。例如，设置`EDITOR='vim -- /path/to/extra/file'`可以绕过保护机制。

**有效性评估：**

提供的Python和Bash脚本旨在利用此漏洞，它们通过设置恶意的环境变量来欺骗`sudoedit`，从而允许用户编辑`/etc/sudoers`或其他特权文件。根据漏洞描述，以及提供的代码，该利用方式是有效的，可以导致权限提升。

**投毒风险分析：**

分析提供的代码，发现存在以下风险：

1.  **信息收集：**  脚本中存在收集sudo版本信息的代码，用于判断目标是否受影响。但可能存在未声明的信息收集行为，虽然目前没有发现明显的后门代码，但仍然存在一定的风险，概率约为10%。
2.  **依赖风险：**  虽然脚本自身没有明显的投毒代码，但是考虑到开源项目的依赖风险，以及作者声明免责声明，需要谨慎使用。

**利用方式：**

1.  **漏洞触发：**  通过设置`SUDO_EDITOR`、`VISUAL`或`EDITOR`环境变量，在其中包含`--`参数，以及想要编辑的恶意文件路径。
2.  **权限提升：**  当用户执行`sudoedit`命令时，由于漏洞，`sudoedit`会将恶意文件添加到编辑列表，允许低权限用户编辑高权限文件，例如`/etc/sudoers`，从而获得root权限。
3.  **POC脚本利用：**  提供的POC脚本简化了上述过程，通过执行脚本自动设置环境变量，检查Sudo版本，并尝试利用漏洞。

**项目地址:** [D0rDa4aN919/CVE-2023-22809-Exploiter](https://github.com/D0rDa4aN919/CVE-2023-22809-Exploiter)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #5

**来源**: [CVE-2023-22809-M4fiaB0y_CVE-2023-22809.md](../2023/CVE-2023-22809-M4fiaB0y_CVE-2023-22809.md)

# CVE-2023-22809

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-22809-AiK1d_CVE-2023-22809-sudo-POC.md](../2023/CVE-2023-22809-AiK1d_CVE-2023-22809-sudo-POC.md)

## CVE-2023-22809-sudo权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许本地攻击者获得root权限

**影响版本:** 1.8.0 到 1.9.12p1

**利用条件:** 用户需要具有使用sudoedit或sudo -e的权限，并且sudo版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 存在于 sudo 1.9.12p2 之前的版本中，sudoedit (或 -e) 功能错误地处理了用户提供的环境变量（SUDO_EDITOR、VISUAL 和 EDITOR）中传递的额外参数，允许本地攻击者将任意条目附加到要处理的文件列表中，导致权限提升。漏洞利用方式是，攻击者可以通过设置恶意的环境变量，例如 EDITOR='vim -- /etc/sudoers'，当使用 sudoedit 编辑文件时，会将 /etc/sudoers 附加到 vim 的命令行参数中，从而允许攻击者以 root 权限编辑 /etc/sudoers 文件。PoC代码首先检查sudo版本是否在受影响的范围内，然后检查当前用户是否具有以root身份运行sudoedit的权限。如果条件满足，PoC会提示用户将包含提权信息的行添加到/etc/sudoers文件中，然后利用漏洞打开sudoers文件。

**项目地址:** [AiK1d/CVE-2023-22809-sudo-POC](https://github.com/AiK1d/CVE-2023-22809-sudo-POC)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #2

**来源**: [CVE-2023-22809-AntiVlad_CVE-2023-22809.md](../2023/CVE-2023-22809-AntiVlad_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许本地低权限用户提升至root权限

**影响版本:** 1.8.0 <= version < 1.9.12p2

**利用条件:** 需要目标系统存在sudo且版本在受影响范围内，并且用户拥有sudoedit权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809是sudoedit中的一个权限提升漏洞。该漏洞源于sudoedit在处理用户提供的环境变量（SUDO_EDITOR, VISUAL, EDITOR）中的额外参数时存在缺陷。攻击者可以通过设置包含`--`参数的恶意编辑器环境变量来绕过保护机制，并附加任意文件到sudoedit处理的文件列表中，从而以root权限编辑或创建任意文件。

**有效性:** 根据漏洞描述和搜索结果，提供的POC代码利用了此漏洞。它通过设置环境变量，使得`sudoedit`可以执行任意命令，进而复制`/bin/bash`并设置SUID位，最终通过执行`/tmp/bash -p`来获取root权限。因此，POC代码是有效的。

**投毒风险:** POC代码的主要目的是提权，执行`cp /bin/bash /tmp/bash && chmod +s /tmp/bash`，这是一个提权的常见手法，验证漏洞是否存在。该脚本中没有明显的恶意代码。但如果此脚本被放入一个恶意软件仓库，则可以被认为含有一定的投毒风险，比如作者可以加入其他恶意操作在提权后执行。风险占比大约10%。

**利用方式:**
1.  攻击者需要在一个已经存在sudo的系统上拥有一个低权限账户，并且该账户可以使用sudoedit命令。
2.  攻击者通过设置环境变量`SUDO_EDITOR`、`VISUAL`或`EDITOR`，使其包含`--`参数以及想要操作的恶意文件路径。
3.  攻击者运行`sudoedit`命令。
4.  `sudoedit`会错误地将恶意文件添加到要编辑的文件列表中，从而允许攻击者以root权限编辑或创建这些文件。
5.  攻击者利用该权限修改系统文件，或者如POC中所示，复制一个具有SUID权限的bash shell，然后执行该shell以获得root权限。

**项目地址:** [AntiVlad/CVE-2023-22809](https://github.com/AntiVlad/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #3

**来源**: [CVE-2023-22809-Chan9Yan9_CVE-2023-22809.md](../2023/CVE-2023-22809-Chan9Yan9_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许低权限用户提升到root权限

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 用户需要具有sudoedit权限，可以编辑至少一个文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809漏洞存在于sudo的sudoedit功能中。该漏洞是由于sudoedit在处理用户提供的环境变量(SUDO_EDITOR, VISUAL, EDITOR)中的额外参数时存在缺陷，允许本地攻击者通过在环境变量中注入包含“--”的恶意参数，将任意文件添加到待编辑的文件列表中，从而绕过sudoers策略，编辑本无权编辑的文件，最终提升权限。

**有效性:** 根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。漏洞利用代码中的exp_passwd.sh脚本通过修改/etc/passwd文件将root用户的权限赋予当前用户，exp_sudoers.sh脚本通过修改/etc/sudoers文件，允许当前用户无密码执行sudo命令，从而实现权限提升。

**投毒风险:** 漏洞利用代码中存在一定的投毒风险，风险评估为10%。

*   **exp_passwd.sh:** 该脚本直接修改/etc/passwd文件，将root的用户名替换为当前用户名。如果攻击者恶意修改该脚本，可能会导致系统账户出现混乱，甚至导致系统无法启动。虽然脚本的目的是为了权限提升，但是修改passwd是比较敏感的操作，有潜在风险。
*   **exp_sudoers.sh:** 该脚本通过修改/etc/sudoers文件，允许当前用户无密码执行sudo命令。如果攻击者恶意修改该脚本，可能会添加其他用户的sudo权限，或者直接禁用所有用户的sudo权限。

**利用方式:**

1.  **检查sudo版本:** 脚本首先检查当前sudo版本是否在受影响范围内。
2.  **检查sudoedit权限:** 脚本检查当前用户是否具有sudoedit权限，并且可以编辑root拥有的文件。
3.  **修改/etc/passwd (exp_passwd.sh):**  如果条件满足，exp_passwd.sh脚本会提示用户修改/etc/passwd文件，将root的用户名替换为当前用户名，从而获得root权限。 需要手动修改，需要用户干预，存在社工风险
4.  **修改/etc/sudoers (exp_sudoers.sh):** 如果条件满足，exp_sudoers.sh脚本会提示用户修改/etc/sudoers文件，添加一行配置，允许当前用户无密码执行sudo命令，然后切换到root用户，从而获得root权限。 需要手动修改，需要用户干预，存在社工风险

总而言之，该漏洞的利用方式是利用sudoedit的参数处理缺陷，篡改敏感文件（/etc/passwd或/etc/sudoers）来实现权限提升。虽然脚本本身提供了提权的手段，但是修改系统关键配置文件始终存在一定的风险，攻击者可以在此基础上进行恶意投毒。

**项目地址:** [Chan9Yan9/CVE-2023-22809](https://github.com/Chan9Yan9/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #4

**来源**: [CVE-2023-22809-D0rDa4aN919_CVE-2023-22809-Exploiter.md](../2023/CVE-2023-22809-D0rDa4aN919_CVE-2023-22809-Exploiter.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，可能导致本地用户权限提升至root

**影响版本:** 1.8.0 through 1.9.12p1

**利用条件:** 需要目标系统安装受影响版本的Sudo，并允许用户通过sudoedit或sudo -e编辑文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809漏洞存在于Sudo 1.8.0到1.9.12p1版本中，`sudoedit` (或者 `sudo -e`) 功能在处理用户提供的环境变量（`SUDO_EDITOR`, `VISUAL`, 和 `EDITOR`）时，错误地处理了额外的参数，导致本地攻击者可以附加任意条目到待处理的文件列表中，从而导致权限提升。例如，设置`EDITOR='vim -- /path/to/extra/file'`可以绕过保护机制。

**有效性评估：**

提供的Python和Bash脚本旨在利用此漏洞，它们通过设置恶意的环境变量来欺骗`sudoedit`，从而允许用户编辑`/etc/sudoers`或其他特权文件。根据漏洞描述，以及提供的代码，该利用方式是有效的，可以导致权限提升。

**投毒风险分析：**

分析提供的代码，发现存在以下风险：

1.  **信息收集：**  脚本中存在收集sudo版本信息的代码，用于判断目标是否受影响。但可能存在未声明的信息收集行为，虽然目前没有发现明显的后门代码，但仍然存在一定的风险，概率约为10%。
2.  **依赖风险：**  虽然脚本自身没有明显的投毒代码，但是考虑到开源项目的依赖风险，以及作者声明免责声明，需要谨慎使用。

**利用方式：**

1.  **漏洞触发：**  通过设置`SUDO_EDITOR`、`VISUAL`或`EDITOR`环境变量，在其中包含`--`参数，以及想要编辑的恶意文件路径。
2.  **权限提升：**  当用户执行`sudoedit`命令时，由于漏洞，`sudoedit`会将恶意文件添加到编辑列表，允许低权限用户编辑高权限文件，例如`/etc/sudoers`，从而获得root权限。
3.  **POC脚本利用：**  提供的POC脚本简化了上述过程，通过执行脚本自动设置环境变量，检查Sudo版本，并尝试利用漏洞。

**项目地址:** [D0rDa4aN919/CVE-2023-22809-Exploiter](https://github.com/D0rDa4aN919/CVE-2023-22809-Exploiter)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #5

**来源**: [CVE-2023-22809-M4fiaB0y_CVE-2023-22809.md](../2023/CVE-2023-22809-M4fiaB0y_CVE-2023-22809.md)

# CVE-2023-22809

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-22809-AiK1d_CVE-2023-22809-sudo-POC.md](../2023/CVE-2023-22809-AiK1d_CVE-2023-22809-sudo-POC.md)

## CVE-2023-22809-sudo权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许本地攻击者获得root权限

**影响版本:** 1.8.0 到 1.9.12p1

**利用条件:** 用户需要具有使用sudoedit或sudo -e的权限，并且sudo版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 存在于 sudo 1.9.12p2 之前的版本中，sudoedit (或 -e) 功能错误地处理了用户提供的环境变量（SUDO_EDITOR、VISUAL 和 EDITOR）中传递的额外参数，允许本地攻击者将任意条目附加到要处理的文件列表中，导致权限提升。漏洞利用方式是，攻击者可以通过设置恶意的环境变量，例如 EDITOR='vim -- /etc/sudoers'，当使用 sudoedit 编辑文件时，会将 /etc/sudoers 附加到 vim 的命令行参数中，从而允许攻击者以 root 权限编辑 /etc/sudoers 文件。PoC代码首先检查sudo版本是否在受影响的范围内，然后检查当前用户是否具有以root身份运行sudoedit的权限。如果条件满足，PoC会提示用户将包含提权信息的行添加到/etc/sudoers文件中，然后利用漏洞打开sudoers文件。

**项目地址:** [AiK1d/CVE-2023-22809-sudo-POC](https://github.com/AiK1d/CVE-2023-22809-sudo-POC)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #2

**来源**: [CVE-2023-22809-AntiVlad_CVE-2023-22809.md](../2023/CVE-2023-22809-AntiVlad_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许本地低权限用户提升至root权限

**影响版本:** 1.8.0 <= version < 1.9.12p2

**利用条件:** 需要目标系统存在sudo且版本在受影响范围内，并且用户拥有sudoedit权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809是sudoedit中的一个权限提升漏洞。该漏洞源于sudoedit在处理用户提供的环境变量（SUDO_EDITOR, VISUAL, EDITOR）中的额外参数时存在缺陷。攻击者可以通过设置包含`--`参数的恶意编辑器环境变量来绕过保护机制，并附加任意文件到sudoedit处理的文件列表中，从而以root权限编辑或创建任意文件。

**有效性:** 根据漏洞描述和搜索结果，提供的POC代码利用了此漏洞。它通过设置环境变量，使得`sudoedit`可以执行任意命令，进而复制`/bin/bash`并设置SUID位，最终通过执行`/tmp/bash -p`来获取root权限。因此，POC代码是有效的。

**投毒风险:** POC代码的主要目的是提权，执行`cp /bin/bash /tmp/bash && chmod +s /tmp/bash`，这是一个提权的常见手法，验证漏洞是否存在。该脚本中没有明显的恶意代码。但如果此脚本被放入一个恶意软件仓库，则可以被认为含有一定的投毒风险，比如作者可以加入其他恶意操作在提权后执行。风险占比大约10%。

**利用方式:**
1.  攻击者需要在一个已经存在sudo的系统上拥有一个低权限账户，并且该账户可以使用sudoedit命令。
2.  攻击者通过设置环境变量`SUDO_EDITOR`、`VISUAL`或`EDITOR`，使其包含`--`参数以及想要操作的恶意文件路径。
3.  攻击者运行`sudoedit`命令。
4.  `sudoedit`会错误地将恶意文件添加到要编辑的文件列表中，从而允许攻击者以root权限编辑或创建这些文件。
5.  攻击者利用该权限修改系统文件，或者如POC中所示，复制一个具有SUID权限的bash shell，然后执行该shell以获得root权限。

**项目地址:** [AntiVlad/CVE-2023-22809](https://github.com/AntiVlad/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #3

**来源**: [CVE-2023-22809-Chan9Yan9_CVE-2023-22809.md](../2023/CVE-2023-22809-Chan9Yan9_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许低权限用户提升到root权限

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 用户需要具有sudoedit权限，可以编辑至少一个文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809漏洞存在于sudo的sudoedit功能中。该漏洞是由于sudoedit在处理用户提供的环境变量(SUDO_EDITOR, VISUAL, EDITOR)中的额外参数时存在缺陷，允许本地攻击者通过在环境变量中注入包含“--”的恶意参数，将任意文件添加到待编辑的文件列表中，从而绕过sudoers策略，编辑本无权编辑的文件，最终提升权限。

**有效性:** 根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。漏洞利用代码中的exp_passwd.sh脚本通过修改/etc/passwd文件将root用户的权限赋予当前用户，exp_sudoers.sh脚本通过修改/etc/sudoers文件，允许当前用户无密码执行sudo命令，从而实现权限提升。

**投毒风险:** 漏洞利用代码中存在一定的投毒风险，风险评估为10%。

*   **exp_passwd.sh:** 该脚本直接修改/etc/passwd文件，将root的用户名替换为当前用户名。如果攻击者恶意修改该脚本，可能会导致系统账户出现混乱，甚至导致系统无法启动。虽然脚本的目的是为了权限提升，但是修改passwd是比较敏感的操作，有潜在风险。
*   **exp_sudoers.sh:** 该脚本通过修改/etc/sudoers文件，允许当前用户无密码执行sudo命令。如果攻击者恶意修改该脚本，可能会添加其他用户的sudo权限，或者直接禁用所有用户的sudo权限。

**利用方式:**

1.  **检查sudo版本:** 脚本首先检查当前sudo版本是否在受影响范围内。
2.  **检查sudoedit权限:** 脚本检查当前用户是否具有sudoedit权限，并且可以编辑root拥有的文件。
3.  **修改/etc/passwd (exp_passwd.sh):**  如果条件满足，exp_passwd.sh脚本会提示用户修改/etc/passwd文件，将root的用户名替换为当前用户名，从而获得root权限。 需要手动修改，需要用户干预，存在社工风险
4.  **修改/etc/sudoers (exp_sudoers.sh):** 如果条件满足，exp_sudoers.sh脚本会提示用户修改/etc/sudoers文件，添加一行配置，允许当前用户无密码执行sudo命令，然后切换到root用户，从而获得root权限。 需要手动修改，需要用户干预，存在社工风险

总而言之，该漏洞的利用方式是利用sudoedit的参数处理缺陷，篡改敏感文件（/etc/passwd或/etc/sudoers）来实现权限提升。虽然脚本本身提供了提权的手段，但是修改系统关键配置文件始终存在一定的风险，攻击者可以在此基础上进行恶意投毒。

**项目地址:** [Chan9Yan9/CVE-2023-22809](https://github.com/Chan9Yan9/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #4

**来源**: [CVE-2023-22809-D0rDa4aN919_CVE-2023-22809-Exploiter.md](../2023/CVE-2023-22809-D0rDa4aN919_CVE-2023-22809-Exploiter.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，可能导致本地用户权限提升至root

**影响版本:** 1.8.0 through 1.9.12p1

**利用条件:** 需要目标系统安装受影响版本的Sudo，并允许用户通过sudoedit或sudo -e编辑文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809漏洞存在于Sudo 1.8.0到1.9.12p1版本中，`sudoedit` (或者 `sudo -e`) 功能在处理用户提供的环境变量（`SUDO_EDITOR`, `VISUAL`, 和 `EDITOR`）时，错误地处理了额外的参数，导致本地攻击者可以附加任意条目到待处理的文件列表中，从而导致权限提升。例如，设置`EDITOR='vim -- /path/to/extra/file'`可以绕过保护机制。

**有效性评估：**

提供的Python和Bash脚本旨在利用此漏洞，它们通过设置恶意的环境变量来欺骗`sudoedit`，从而允许用户编辑`/etc/sudoers`或其他特权文件。根据漏洞描述，以及提供的代码，该利用方式是有效的，可以导致权限提升。

**投毒风险分析：**

分析提供的代码，发现存在以下风险：

1.  **信息收集：**  脚本中存在收集sudo版本信息的代码，用于判断目标是否受影响。但可能存在未声明的信息收集行为，虽然目前没有发现明显的后门代码，但仍然存在一定的风险，概率约为10%。
2.  **依赖风险：**  虽然脚本自身没有明显的投毒代码，但是考虑到开源项目的依赖风险，以及作者声明免责声明，需要谨慎使用。

**利用方式：**

1.  **漏洞触发：**  通过设置`SUDO_EDITOR`、`VISUAL`或`EDITOR`环境变量，在其中包含`--`参数，以及想要编辑的恶意文件路径。
2.  **权限提升：**  当用户执行`sudoedit`命令时，由于漏洞，`sudoedit`会将恶意文件添加到编辑列表，允许低权限用户编辑高权限文件，例如`/etc/sudoers`，从而获得root权限。
3.  **POC脚本利用：**  提供的POC脚本简化了上述过程，通过执行脚本自动设置环境变量，检查Sudo版本，并尝试利用漏洞。

**项目地址:** [D0rDa4aN919/CVE-2023-22809-Exploiter](https://github.com/D0rDa4aN919/CVE-2023-22809-Exploiter)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #5

**来源**: [CVE-2023-22809-M4fiaB0y_CVE-2023-22809.md](../2023/CVE-2023-22809-M4fiaB0y_CVE-2023-22809.md)

# CVE-2023-22809

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-22809-AiK1d_CVE-2023-22809-sudo-POC.md](../2023/CVE-2023-22809-AiK1d_CVE-2023-22809-sudo-POC.md)

## CVE-2023-22809-sudo权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许本地攻击者获得root权限

**影响版本:** 1.8.0 到 1.9.12p1

**利用条件:** 用户需要具有使用sudoedit或sudo -e的权限，并且sudo版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 存在于 sudo 1.9.12p2 之前的版本中，sudoedit (或 -e) 功能错误地处理了用户提供的环境变量（SUDO_EDITOR、VISUAL 和 EDITOR）中传递的额外参数，允许本地攻击者将任意条目附加到要处理的文件列表中，导致权限提升。漏洞利用方式是，攻击者可以通过设置恶意的环境变量，例如 EDITOR='vim -- /etc/sudoers'，当使用 sudoedit 编辑文件时，会将 /etc/sudoers 附加到 vim 的命令行参数中，从而允许攻击者以 root 权限编辑 /etc/sudoers 文件。PoC代码首先检查sudo版本是否在受影响的范围内，然后检查当前用户是否具有以root身份运行sudoedit的权限。如果条件满足，PoC会提示用户将包含提权信息的行添加到/etc/sudoers文件中，然后利用漏洞打开sudoers文件。

**项目地址:** [AiK1d/CVE-2023-22809-sudo-POC](https://github.com/AiK1d/CVE-2023-22809-sudo-POC)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #2

**来源**: [CVE-2023-22809-AntiVlad_CVE-2023-22809.md](../2023/CVE-2023-22809-AntiVlad_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许本地低权限用户提升至root权限

**影响版本:** 1.8.0 <= version < 1.9.12p2

**利用条件:** 需要目标系统存在sudo且版本在受影响范围内，并且用户拥有sudoedit权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809是sudoedit中的一个权限提升漏洞。该漏洞源于sudoedit在处理用户提供的环境变量（SUDO_EDITOR, VISUAL, EDITOR）中的额外参数时存在缺陷。攻击者可以通过设置包含`--`参数的恶意编辑器环境变量来绕过保护机制，并附加任意文件到sudoedit处理的文件列表中，从而以root权限编辑或创建任意文件。

**有效性:** 根据漏洞描述和搜索结果，提供的POC代码利用了此漏洞。它通过设置环境变量，使得`sudoedit`可以执行任意命令，进而复制`/bin/bash`并设置SUID位，最终通过执行`/tmp/bash -p`来获取root权限。因此，POC代码是有效的。

**投毒风险:** POC代码的主要目的是提权，执行`cp /bin/bash /tmp/bash && chmod +s /tmp/bash`，这是一个提权的常见手法，验证漏洞是否存在。该脚本中没有明显的恶意代码。但如果此脚本被放入一个恶意软件仓库，则可以被认为含有一定的投毒风险，比如作者可以加入其他恶意操作在提权后执行。风险占比大约10%。

**利用方式:**
1.  攻击者需要在一个已经存在sudo的系统上拥有一个低权限账户，并且该账户可以使用sudoedit命令。
2.  攻击者通过设置环境变量`SUDO_EDITOR`、`VISUAL`或`EDITOR`，使其包含`--`参数以及想要操作的恶意文件路径。
3.  攻击者运行`sudoedit`命令。
4.  `sudoedit`会错误地将恶意文件添加到要编辑的文件列表中，从而允许攻击者以root权限编辑或创建这些文件。
5.  攻击者利用该权限修改系统文件，或者如POC中所示，复制一个具有SUID权限的bash shell，然后执行该shell以获得root权限。

**项目地址:** [AntiVlad/CVE-2023-22809](https://github.com/AntiVlad/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #3

**来源**: [CVE-2023-22809-Chan9Yan9_CVE-2023-22809.md](../2023/CVE-2023-22809-Chan9Yan9_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许低权限用户提升到root权限

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 用户需要具有sudoedit权限，可以编辑至少一个文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809漏洞存在于sudo的sudoedit功能中。该漏洞是由于sudoedit在处理用户提供的环境变量(SUDO_EDITOR, VISUAL, EDITOR)中的额外参数时存在缺陷，允许本地攻击者通过在环境变量中注入包含“--”的恶意参数，将任意文件添加到待编辑的文件列表中，从而绕过sudoers策略，编辑本无权编辑的文件，最终提升权限。

**有效性:** 根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。漏洞利用代码中的exp_passwd.sh脚本通过修改/etc/passwd文件将root用户的权限赋予当前用户，exp_sudoers.sh脚本通过修改/etc/sudoers文件，允许当前用户无密码执行sudo命令，从而实现权限提升。

**投毒风险:** 漏洞利用代码中存在一定的投毒风险，风险评估为10%。

*   **exp_passwd.sh:** 该脚本直接修改/etc/passwd文件，将root的用户名替换为当前用户名。如果攻击者恶意修改该脚本，可能会导致系统账户出现混乱，甚至导致系统无法启动。虽然脚本的目的是为了权限提升，但是修改passwd是比较敏感的操作，有潜在风险。
*   **exp_sudoers.sh:** 该脚本通过修改/etc/sudoers文件，允许当前用户无密码执行sudo命令。如果攻击者恶意修改该脚本，可能会添加其他用户的sudo权限，或者直接禁用所有用户的sudo权限。

**利用方式:**

1.  **检查sudo版本:** 脚本首先检查当前sudo版本是否在受影响范围内。
2.  **检查sudoedit权限:** 脚本检查当前用户是否具有sudoedit权限，并且可以编辑root拥有的文件。
3.  **修改/etc/passwd (exp_passwd.sh):**  如果条件满足，exp_passwd.sh脚本会提示用户修改/etc/passwd文件，将root的用户名替换为当前用户名，从而获得root权限。 需要手动修改，需要用户干预，存在社工风险
4.  **修改/etc/sudoers (exp_sudoers.sh):** 如果条件满足，exp_sudoers.sh脚本会提示用户修改/etc/sudoers文件，添加一行配置，允许当前用户无密码执行sudo命令，然后切换到root用户，从而获得root权限。 需要手动修改，需要用户干预，存在社工风险

总而言之，该漏洞的利用方式是利用sudoedit的参数处理缺陷，篡改敏感文件（/etc/passwd或/etc/sudoers）来实现权限提升。虽然脚本本身提供了提权的手段，但是修改系统关键配置文件始终存在一定的风险，攻击者可以在此基础上进行恶意投毒。

**项目地址:** [Chan9Yan9/CVE-2023-22809](https://github.com/Chan9Yan9/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #4

**来源**: [CVE-2023-22809-D0rDa4aN919_CVE-2023-22809-Exploiter.md](../2023/CVE-2023-22809-D0rDa4aN919_CVE-2023-22809-Exploiter.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，可能导致本地用户权限提升至root

**影响版本:** 1.8.0 through 1.9.12p1

**利用条件:** 需要目标系统安装受影响版本的Sudo，并允许用户通过sudoedit或sudo -e编辑文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809漏洞存在于Sudo 1.8.0到1.9.12p1版本中，`sudoedit` (或者 `sudo -e`) 功能在处理用户提供的环境变量（`SUDO_EDITOR`, `VISUAL`, 和 `EDITOR`）时，错误地处理了额外的参数，导致本地攻击者可以附加任意条目到待处理的文件列表中，从而导致权限提升。例如，设置`EDITOR='vim -- /path/to/extra/file'`可以绕过保护机制。

**有效性评估：**

提供的Python和Bash脚本旨在利用此漏洞，它们通过设置恶意的环境变量来欺骗`sudoedit`，从而允许用户编辑`/etc/sudoers`或其他特权文件。根据漏洞描述，以及提供的代码，该利用方式是有效的，可以导致权限提升。

**投毒风险分析：**

分析提供的代码，发现存在以下风险：

1.  **信息收集：**  脚本中存在收集sudo版本信息的代码，用于判断目标是否受影响。但可能存在未声明的信息收集行为，虽然目前没有发现明显的后门代码，但仍然存在一定的风险，概率约为10%。
2.  **依赖风险：**  虽然脚本自身没有明显的投毒代码，但是考虑到开源项目的依赖风险，以及作者声明免责声明，需要谨慎使用。

**利用方式：**

1.  **漏洞触发：**  通过设置`SUDO_EDITOR`、`VISUAL`或`EDITOR`环境变量，在其中包含`--`参数，以及想要编辑的恶意文件路径。
2.  **权限提升：**  当用户执行`sudoedit`命令时，由于漏洞，`sudoedit`会将恶意文件添加到编辑列表，允许低权限用户编辑高权限文件，例如`/etc/sudoers`，从而获得root权限。
3.  **POC脚本利用：**  提供的POC脚本简化了上述过程，通过执行脚本自动设置环境变量，检查Sudo版本，并尝试利用漏洞。

**项目地址:** [D0rDa4aN919/CVE-2023-22809-Exploiter](https://github.com/D0rDa4aN919/CVE-2023-22809-Exploiter)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #5

**来源**: [CVE-2023-22809-Toothless5143_CVE-2023-22809.md](../2023/CVE-2023-22809-Toothless5143_CVE-2023-22809.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，本地权限提升至root

**影响版本:** 1.8.0 to 1.9.12p1

**利用条件:** 用户需要具有sudoedit或者sudo -e的权限，且可以以root或者ALL用户运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 是一个 Sudo 的权限提升漏洞，存在于 1.8.0 到 1.9.12p1 版本中。该漏洞是由于 `sudoedit` (也称为 `-e` 功能) 在处理用户提供的环境变量（`SUDO_EDITOR`、`VISUAL` 和 `EDITOR`）中传递的额外参数时存在错误，允许本地攻击者将任意条目附加到要处理的文件列表中，从而导致权限提升。

**利用方式：**
1.  **检查Sudo版本：** 漏洞利用代码首先检查当前安装的 Sudo 版本是否在受影响的范围内 (1.8.0 to 1.9.12p1)。
2.  **检查用户权限：** 漏洞利用代码检查当前用户是否具有使用 `sudoedit` 或 `sudo -e` 命令以 root 身份或以 `ALL` 用户身份运行的权限。这通常意味着用户在 `sudoers` 文件中具有相应的条目。
3.  **利用环境变量注入参数：** 如果满足上述条件，攻击者可以通过设置 `SUDO_EDITOR`、`VISUAL` 或 `EDITOR` 环境变量来注入额外的参数。攻击者可以在这些环境变量中包含 `--` 参数，从而欺骗 `sudoedit` 命令，使其将任意文件添加到要编辑的文件列表中。
4.  **修改sudoers文件：**POC通过vim打开sudoers文件，提示用户添加一行提权配置到sudoers文件中，完成提权。
5.  **获得root权限：**成功修改 `sudoers` 文件后，攻击者可以使用 `sudo su root` 命令获得 root 权限。

**投毒风险评估：**
仔细审查了提供的 POC 代码，没有发现任何明显的恶意代码或后门。该脚本的主要功能是检查 Sudo 版本、用户权限，然后引导用户使用 `sudoedit` 修改 `/etc/sudoers` 文件来提升权限。没有发现任何未经授权的网络连接、文件修改或信息泄露行为。因此，认为该 POC 代码的投毒风险为 0%。

**项目地址:** [Toothless5143/CVE-2023-22809](https://github.com/Toothless5143/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #6

**来源**: [CVE-2023-22809-asepsaepdin_CVE-2023-22809.md](../2023/CVE-2023-22809-asepsaepdin_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升漏洞

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地用户提升至root权限

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 目标系统sudo版本在受影响范围内，当前用户需要具有使用sudoedit或sudo -e命令编辑文件的权限，且目标文件属于root或ALL用户/用户组。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 漏洞存在于 Sudo 1.8.0 到 1.9.12p1 版本中。sudoedit (也称为 -e) 功能错误地处理了用户提供的环境变量（SUDO_EDITOR、VISUAL 和 EDITOR）中传递的额外参数，允许本地攻击者将任意条目附加到要处理的文件列表中。这可能导致权限提升。问题在于用户指定的编辑器可能包含一个“--”参数，该参数会破坏保护机制，例如，EDITOR='vim -- /path/to/extra/file' 值。

**利用方式：**

1.  **检查sudo版本：** 检查目标系统上安装的sudo版本是否在受影响范围内（1.8.0 到 1.9.12p1）。
2.  **验证sudoedit权限：** 确认当前用户是否具有使用`sudoedit`或`sudo -e`命令编辑root权限文件的权限。可以通过`sudo -l`命令查看当前用户的sudo权限。
3.  **设置环境变量：** 设置环境变量`EDITOR`、`VISUAL`或`SUDO_EDITOR`，使其包含恶意参数。例如，`EDITOR='nano -- /etc/sudoers'`。
4.  **执行sudoedit：** 使用`sudoedit`或`sudo -e`命令编辑目标文件。由于环境变量中的恶意参数，实际上可以编辑`/etc/sudoers`文件。
5.  **修改sudoers文件：** 在`/etc/sudoers`文件中添加当前用户具有免密sudo权限的条目，例如`username ALL=(ALL:ALL) ALL`。
6.  **获取root权限：** 使用`sudo su root`或`sudo -i`命令获取root权限。

**有效性：**

提供的POC代码有效。它首先检查sudo版本，然后验证用户是否可以运行sudoedit命令。如果可以，它会指示用户将一行添加到sudoers文件中，以便授予用户root权限。最后，它尝试使用`sudo su root`获取root shell。

**投毒风险：**

查看了exploit.sh脚本。该脚本的主要功能是利用CVE-2023-22809漏洞，通过修改/etc/sudoers文件来提升权限。没有发现任何明显的恶意代码或后门。该脚本的目的是利用漏洞，而不是植入持久性的后门。该脚本需要用户交互，在sudoers文件中添加特定行，这降低了静默投毒的风险。
根据分析，此仓库中存在作者隐藏的投毒代码的可能性为0%。

**项目地址:** [asepsaepdin/CVE-2023-22809](https://github.com/asepsaepdin/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #7

**来源**: [CVE-2023-22809-hello4r1end_patch_CVE-2023-22809.md](../2023/CVE-2023-22809-hello4r1end_patch_CVE-2023-22809.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地攻击者提升权限至root

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 漏洞存在于 Sudo 1.9.12p2 之前的版本中，允许本地攻击者通过操纵 SUDO_EDITOR, VISUAL, 和 EDITOR 环境变量中的参数，利用 sudoedit 命令附加额外的文件进行编辑，从而导致权限提升。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的利用是有效的。多个安全厂商和社区都确认了该漏洞的存在和利用方式。

**投毒风险：**
提供的漏洞利用代码 (`CVE-2023-22809Patch.sh` 和 `README.md`) 实际上是一个用于**更新 Sudo 版本**的脚本，它从 GitHub 下载一个 Debian 包并安装它。这个脚本本身并没有包含任何恶意代码或后门，所以投毒风险评估为0%。它仅仅是尝试修复漏洞，而不是利用漏洞。

**利用方式：**
该漏洞的利用方式是通过设置环境变量 `SUDO_EDITOR`，`VISUAL` 或 `EDITOR`，在其中包含 `--` 参数以及要编辑的恶意文件路径，当用户使用 `sudoedit` 命令时，这些额外的参数会被传递给编辑器，从而允许编辑本来没有权限编辑的文件。例如：`EDITOR='vim -- /etc/shadow'; sudoedit 文件名`。攻击者可以利用此漏洞修改 `/etc/shadow` 文件或其它特权文件，从而获得 root 权限。

**项目地址:** [hello4r1end/patch_CVE-2023-22809](https://github.com/hello4r1end/patch_CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #8

**来源**: [CVE-2023-22809-laxmiyamkolu_SUDO-privilege-escalation.md](../2023/CVE-2023-22809-laxmiyamkolu_SUDO-privilege-escalation.md)

## CVE-2023-22809-Sudoedit特权提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 特权提升

**影响应用:** Sudo

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** 1.8.0 <= Sudo < 1.9.12p2

**利用条件:** 需要用户具有sudoedit权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809 漏洞允许本地攻击者通过 `sudoedit` 命令提升权限。`sudoedit` 功能在处理用户提供的环境变量（`SUDO_EDITOR`、`VISUAL` 和 `EDITOR`）时存在缺陷，允许攻击者向要处理的文件列表中追加任意条目。攻击者可以通过在编辑器环境变量中包含 `--` 参数来绕过保护机制，例如，设置 `EDITOR='vim -- /path/to/extra/file'`。

**漏洞利用方式：**

1.  **检查Sudo版本：** 确认Sudo版本在受影响范围内 (1.8.0 到 1.9.12p1)。
2.  **检查用户权限：** 确认用户拥有使用`sudoedit`编辑文件的权限。
3.  **设置EDITOR环境变量：** 设置`EDITOR`环境变量，使其包含恶意参数，例如`EDITOR='vim -- /etc/passwd'`。
4.  **使用sudoedit编辑文件：** 使用`sudoedit`编辑允许的文件，触发漏洞，从而能够编辑`/etc/passwd`或其他敏感文件。
5.  **修改/etc/passwd：** 修改`/etc/passwd`文件，将当前用户的UID修改为0，使其成为root用户。
6.  **切换用户：** 使用`su`命令切换到被提权的用户。

**有效性：**

提供的POC代码基本有效，它演示了利用漏洞提升权限的步骤。代码首先检查Sudo版本和用户权限，然后指导用户设置`EDITOR`环境变量，并使用`sudoedit`编辑文件。最后，它引导用户手动修改`/etc/passwd`文件并切换用户。该脚本是半自动化的，需要用户手动干预来修改`/etc/passwd`。

**投毒风险：**

该POC代码的投毒风险较低，约为10%。主要风险在于脚本尝试引导用户修改`/etc/passwd`文件。虽然这是漏洞利用的一部分，但如果用户不小心修改了其他重要配置，可能会导致系统不稳定或无法启动。此外，脚本的作者可能在`README.md`或其他文件中包含误导性信息，引导用户执行不安全的操作。但总体而言，代码本身没有明显的恶意行为。

更详细地分析，脚本中需要用户手动修改/etc/passwd这一步，用户可能会犯错，导致系统问题。理论上，攻击者可以将错误的修改方式写入脚本或文档中，让用户误操作，但现有代码并没有此类行为，因此风险较低。

**项目地址:** [laxmiyamkolu/SUDO-privilege-escalation](https://github.com/laxmiyamkolu/SUDO-privilege-escalation)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #9

**来源**: [CVE-2023-22809-n3m1sys_CVE-2023-22809-sudoedit-privesc.md](../2023/CVE-2023-22809-n3m1sys_CVE-2023-22809-sudoedit-privesc.md)

## CVE-2023-22809-sudo-权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许本地低权限用户获得root权限

**影响版本:** 1.8.0 to 1.9.12p1

**利用条件:** 用户需要能够通过sudoedit或sudo -e以root权限编辑文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809是sudo中的一个权限提升漏洞，存在于1.8.0到1.9.12p1版本。sudoedit (或 -e) 功能错误地处理了用户提供的环境变量（SUDO_EDITOR、VISUAL和EDITOR）中传递的额外参数，允许本地攻击者将任意条目附加到要处理的文件列表中。攻击者可以通过设置这些环境变量来包含恶意文件，从而导致权限提升。

**有效性：**
根据漏洞信息和POC代码，该漏洞利用是有效的。POC脚本首先检查sudo版本是否在受影响范围内，然后检查当前用户是否具有使用sudoedit或sudo -e以root权限编辑文件的权限。如果满足这两个条件，它将修改/etc/sudoers文件，为当前用户添加sudo权限，从而获得root shell。

**投毒风险：**
分析提供的POC代码（exploit.sh），没有发现明显的恶意代码或后门。脚本的主要功能是利用漏洞修改sudoers文件以提升权限，这是一个合法的漏洞利用方式，而非植入恶意代码。README.md文件仅是对漏洞和利用方式的描述。

**利用方式：**
1.  **检查sudo版本：** 脚本首先检查当前系统上安装的sudo版本是否在漏洞影响范围内。
2.  **检查sudoedit权限：** 脚本检查当前用户是否可以使用sudoedit或sudo -e以root权限编辑文件。
3.  **修改sudoers文件：** 如果满足上述条件，脚本会使用用户可控的环境变量EDITOR，通过sudoedit命令打开/etc/sudoers文件。由于sudoedit的漏洞，攻击者可以控制传递给EDITOR程序的参数，从而可以添加任意文件到编辑列表。
4.  **权限提升：**  攻击者在sudoers文件中添加一行，允许当前用户使用sudo执行任何命令，从而获得root权限。
5.  **获取root shell：** 最后，脚本使用`sudo su root`命令获得root shell。

**项目地址:** [n3m1sys/CVE-2023-22809-sudoedit-privesc](https://github.com/n3m1sys/CVE-2023-22809-sudoedit-privesc)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #10

**来源**: [CVE-2023-22809-pashayogi_CVE-2023-22809.md](../2023/CVE-2023-22809-pashayogi_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** 1.8.0 to 1.9.12p1

**利用条件:** 用户需要拥有使用 sudoedit 或 sudo -e 命令编辑文件的权限，且目标文件属于root用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 漏洞允许本地攻击者通过滥用 sudoedit（或 -e）功能中对用户提供的环境变量（SUDO_EDITOR、VISUAL 和 EDITOR）的处理方式，将任意条目附加到要处理的文件列表中，从而导致权限提升。

**有效性：**
POC 代码有效。该代码首先检查 sudo 版本是否在受影响范围内，然后检查当前用户是否可以使用 sudoedit 或 sudo -e 以 root 身份运行命令。如果满足条件，则它会通过设置 EDITOR 环境变量，利用 vim 的 `--` 参数绕过保护机制，打开 /etc/sudoers 文件进行编辑，引导用户添加一行配置以获取 root 权限，最终通过 `sudo su root` 获取 root shell。

**投毒风险：**
该 POC 代码中没有明显的投毒代码。脚本的功能很明确，即利用漏洞提升权限。它仅修改 `/etc/sudoers` 文件，而不会尝试植入任何隐藏的后门或其他恶意代码。

**利用方式：**
1.  **检查 sudo 版本：** 首先，检查目标系统上安装的 sudo 版本是否在受影响的范围内（1.8.0 到 1.9.12p1）。
2.  **检查 sudoedit 权限：** 检查当前用户是否具有使用 sudoedit 或 sudo -e 命令编辑文件的权限，并且该文件归 root 用户所有。
3.  **设置 EDITOR 环境变量：** 将 EDITOR 环境变量设置为包含 `--` 参数的恶意值，例如 `EDITOR="vim -- /etc/sudoers"`。
4.  **运行 sudoedit：** 运行 `sudoedit <受root拥有的文件>` 命令。由于环境变量的影响，这会导致使用 vim 打开 `/etc/sudoers` 文件。
5.  **编辑 /etc/sudoers：**  在打开的 `/etc/sudoers` 文件中，添加一行允许当前用户以 root 身份执行任何命令的配置，例如 `<用户名> ALL=(ALL:ALL) ALL`。
6.  **获取 root shell：** 使用 `sudo su root` 命令获取 root shell。

综上所述，提供的POC代码有效，不存在投毒风险，且能成功利用 CVE-2023-22809 漏洞提升权限。

**项目地址:** [pashayogi/CVE-2023-22809](https://github.com/pashayogi/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #11

**来源**: [CVE-2023-22809-spidoman_CVE-2023-22809-automated-python-exploits.md](../2023/CVE-2023-22809-spidoman_CVE-2023-22809-automated-python-exploits.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地低权限用户提升至root权限

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 需要目标系统上存在sudo且版本在受影响范围内，并且用户拥有sudoedit权限。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-22809是sudoedit中的一个权限提升漏洞。该漏洞源于sudoedit在处理用户提供的环境变量（SUDO_EDITOR、VISUAL和EDITOR）时，对额外的参数处理不当。攻击者可以通过在这些环境变量中注入恶意参数，例如`--`，来绕过保护机制，将任意文件添加到sudoedit要处理的文件列表中，从而以root权限编辑这些文件，最终导致权限提升。

**有效性:** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在且危害较高。提供的POC代码仓库的README.md声称可以自动利用该漏洞，但目前只有readme文件，无法判断代码有效性，但是根据描述，该漏洞利用方式比较简单，因此，实现自动利用的代码是可行的。

**投毒风险:** 提供的漏洞利用代码仓库只包含一个README.md文件，没有任何实际的利用代码，因此很难确定是否存在恶意代码。然而，考虑到这是一个可以提升权限的漏洞，攻击者可能会尝试通过包含后门或恶意指令来进一步控制系统。尽管当前没有明确的投毒证据，但考虑到其潜在的风险，投毒风险评估为20%。

**利用方式:**

1.  **利用sudoedit:**  利用sudoedit命令编辑文件。
2.  **设置环境变量:** 设置SUDO_EDITOR, VISUAL, 或者EDITOR环境变量，包含恶意参数。例如 `EDITOR='vim -- /path/to/arbitrary/file'`。
3.  **触发漏洞:**  执行`sudoedit <target_file>`，其中`<target_file>`可以是任意文件，攻击者通过环境变量注入，可以控制实际被编辑的文件，达到修改敏感文件，提升权限的目的。
4.  **权限提升:**  由于sudoedit以root权限运行，攻击者通过修改/etc/passwd或/etc/shadow等文件，或执行其他恶意操作，可以获得root权限。

**项目地址:** [spidoman/CVE-2023-22809-automated-python-exploits](https://github.com/spidoman/CVE-2023-22809-automated-python-exploits)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---



---

## POC #6

**来源**: [CVE-2023-22809-Toothless5143_CVE-2023-22809.md](../2023/CVE-2023-22809-Toothless5143_CVE-2023-22809.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，本地权限提升至root

**影响版本:** 1.8.0 to 1.9.12p1

**利用条件:** 用户需要具有sudoedit或者sudo -e的权限，且可以以root或者ALL用户运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 是一个 Sudo 的权限提升漏洞，存在于 1.8.0 到 1.9.12p1 版本中。该漏洞是由于 `sudoedit` (也称为 `-e` 功能) 在处理用户提供的环境变量（`SUDO_EDITOR`、`VISUAL` 和 `EDITOR`）中传递的额外参数时存在错误，允许本地攻击者将任意条目附加到要处理的文件列表中，从而导致权限提升。

**利用方式：**
1.  **检查Sudo版本：** 漏洞利用代码首先检查当前安装的 Sudo 版本是否在受影响的范围内 (1.8.0 to 1.9.12p1)。
2.  **检查用户权限：** 漏洞利用代码检查当前用户是否具有使用 `sudoedit` 或 `sudo -e` 命令以 root 身份或以 `ALL` 用户身份运行的权限。这通常意味着用户在 `sudoers` 文件中具有相应的条目。
3.  **利用环境变量注入参数：** 如果满足上述条件，攻击者可以通过设置 `SUDO_EDITOR`、`VISUAL` 或 `EDITOR` 环境变量来注入额外的参数。攻击者可以在这些环境变量中包含 `--` 参数，从而欺骗 `sudoedit` 命令，使其将任意文件添加到要编辑的文件列表中。
4.  **修改sudoers文件：**POC通过vim打开sudoers文件，提示用户添加一行提权配置到sudoers文件中，完成提权。
5.  **获得root权限：**成功修改 `sudoers` 文件后，攻击者可以使用 `sudo su root` 命令获得 root 权限。

**投毒风险评估：**
仔细审查了提供的 POC 代码，没有发现任何明显的恶意代码或后门。该脚本的主要功能是检查 Sudo 版本、用户权限，然后引导用户使用 `sudoedit` 修改 `/etc/sudoers` 文件来提升权限。没有发现任何未经授权的网络连接、文件修改或信息泄露行为。因此，认为该 POC 代码的投毒风险为 0%。

**项目地址:** [Toothless5143/CVE-2023-22809](https://github.com/Toothless5143/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #7

**来源**: [CVE-2023-22809-asepsaepdin_CVE-2023-22809.md](../2023/CVE-2023-22809-asepsaepdin_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升漏洞

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地用户提升至root权限

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 目标系统sudo版本在受影响范围内，当前用户需要具有使用sudoedit或sudo -e命令编辑文件的权限，且目标文件属于root或ALL用户/用户组。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 漏洞存在于 Sudo 1.8.0 到 1.9.12p1 版本中。sudoedit (也称为 -e) 功能错误地处理了用户提供的环境变量（SUDO_EDITOR、VISUAL 和 EDITOR）中传递的额外参数，允许本地攻击者将任意条目附加到要处理的文件列表中。这可能导致权限提升。问题在于用户指定的编辑器可能包含一个“--”参数，该参数会破坏保护机制，例如，EDITOR='vim -- /path/to/extra/file' 值。

**利用方式：**

1.  **检查sudo版本：** 检查目标系统上安装的sudo版本是否在受影响范围内（1.8.0 到 1.9.12p1）。
2.  **验证sudoedit权限：** 确认当前用户是否具有使用`sudoedit`或`sudo -e`命令编辑root权限文件的权限。可以通过`sudo -l`命令查看当前用户的sudo权限。
3.  **设置环境变量：** 设置环境变量`EDITOR`、`VISUAL`或`SUDO_EDITOR`，使其包含恶意参数。例如，`EDITOR='nano -- /etc/sudoers'`。
4.  **执行sudoedit：** 使用`sudoedit`或`sudo -e`命令编辑目标文件。由于环境变量中的恶意参数，实际上可以编辑`/etc/sudoers`文件。
5.  **修改sudoers文件：** 在`/etc/sudoers`文件中添加当前用户具有免密sudo权限的条目，例如`username ALL=(ALL:ALL) ALL`。
6.  **获取root权限：** 使用`sudo su root`或`sudo -i`命令获取root权限。

**有效性：**

提供的POC代码有效。它首先检查sudo版本，然后验证用户是否可以运行sudoedit命令。如果可以，它会指示用户将一行添加到sudoers文件中，以便授予用户root权限。最后，它尝试使用`sudo su root`获取root shell。

**投毒风险：**

查看了exploit.sh脚本。该脚本的主要功能是利用CVE-2023-22809漏洞，通过修改/etc/sudoers文件来提升权限。没有发现任何明显的恶意代码或后门。该脚本的目的是利用漏洞，而不是植入持久性的后门。该脚本需要用户交互，在sudoers文件中添加特定行，这降低了静默投毒的风险。
根据分析，此仓库中存在作者隐藏的投毒代码的可能性为0%。

**项目地址:** [asepsaepdin/CVE-2023-22809](https://github.com/asepsaepdin/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #8

**来源**: [CVE-2023-22809-hello4r1end_patch_CVE-2023-22809.md](../2023/CVE-2023-22809-hello4r1end_patch_CVE-2023-22809.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地攻击者提升权限至root

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 漏洞存在于 Sudo 1.9.12p2 之前的版本中，允许本地攻击者通过操纵 SUDO_EDITOR, VISUAL, 和 EDITOR 环境变量中的参数，利用 sudoedit 命令附加额外的文件进行编辑，从而导致权限提升。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的利用是有效的。多个安全厂商和社区都确认了该漏洞的存在和利用方式。

**投毒风险：**
提供的漏洞利用代码 (`CVE-2023-22809Patch.sh` 和 `README.md`) 实际上是一个用于**更新 Sudo 版本**的脚本，它从 GitHub 下载一个 Debian 包并安装它。这个脚本本身并没有包含任何恶意代码或后门，所以投毒风险评估为0%。它仅仅是尝试修复漏洞，而不是利用漏洞。

**利用方式：**
该漏洞的利用方式是通过设置环境变量 `SUDO_EDITOR`，`VISUAL` 或 `EDITOR`，在其中包含 `--` 参数以及要编辑的恶意文件路径，当用户使用 `sudoedit` 命令时，这些额外的参数会被传递给编辑器，从而允许编辑本来没有权限编辑的文件。例如：`EDITOR='vim -- /etc/shadow'; sudoedit 文件名`。攻击者可以利用此漏洞修改 `/etc/shadow` 文件或其它特权文件，从而获得 root 权限。

**项目地址:** [hello4r1end/patch_CVE-2023-22809](https://github.com/hello4r1end/patch_CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #9

**来源**: [CVE-2023-22809-laxmiyamkolu_SUDO-privilege-escalation.md](../2023/CVE-2023-22809-laxmiyamkolu_SUDO-privilege-escalation.md)

## CVE-2023-22809-Sudoedit特权提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 特权提升

**影响应用:** Sudo

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** 1.8.0 <= Sudo < 1.9.12p2

**利用条件:** 需要用户具有sudoedit权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809 漏洞允许本地攻击者通过 `sudoedit` 命令提升权限。`sudoedit` 功能在处理用户提供的环境变量（`SUDO_EDITOR`、`VISUAL` 和 `EDITOR`）时存在缺陷，允许攻击者向要处理的文件列表中追加任意条目。攻击者可以通过在编辑器环境变量中包含 `--` 参数来绕过保护机制，例如，设置 `EDITOR='vim -- /path/to/extra/file'`。

**漏洞利用方式：**

1.  **检查Sudo版本：** 确认Sudo版本在受影响范围内 (1.8.0 到 1.9.12p1)。
2.  **检查用户权限：** 确认用户拥有使用`sudoedit`编辑文件的权限。
3.  **设置EDITOR环境变量：** 设置`EDITOR`环境变量，使其包含恶意参数，例如`EDITOR='vim -- /etc/passwd'`。
4.  **使用sudoedit编辑文件：** 使用`sudoedit`编辑允许的文件，触发漏洞，从而能够编辑`/etc/passwd`或其他敏感文件。
5.  **修改/etc/passwd：** 修改`/etc/passwd`文件，将当前用户的UID修改为0，使其成为root用户。
6.  **切换用户：** 使用`su`命令切换到被提权的用户。

**有效性：**

提供的POC代码基本有效，它演示了利用漏洞提升权限的步骤。代码首先检查Sudo版本和用户权限，然后指导用户设置`EDITOR`环境变量，并使用`sudoedit`编辑文件。最后，它引导用户手动修改`/etc/passwd`文件并切换用户。该脚本是半自动化的，需要用户手动干预来修改`/etc/passwd`。

**投毒风险：**

该POC代码的投毒风险较低，约为10%。主要风险在于脚本尝试引导用户修改`/etc/passwd`文件。虽然这是漏洞利用的一部分，但如果用户不小心修改了其他重要配置，可能会导致系统不稳定或无法启动。此外，脚本的作者可能在`README.md`或其他文件中包含误导性信息，引导用户执行不安全的操作。但总体而言，代码本身没有明显的恶意行为。

更详细地分析，脚本中需要用户手动修改/etc/passwd这一步，用户可能会犯错，导致系统问题。理论上，攻击者可以将错误的修改方式写入脚本或文档中，让用户误操作，但现有代码并没有此类行为，因此风险较低。

**项目地址:** [laxmiyamkolu/SUDO-privilege-escalation](https://github.com/laxmiyamkolu/SUDO-privilege-escalation)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #10

**来源**: [CVE-2023-22809-n3m1sys_CVE-2023-22809-sudoedit-privesc.md](../2023/CVE-2023-22809-n3m1sys_CVE-2023-22809-sudoedit-privesc.md)

## CVE-2023-22809-sudo-权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许本地低权限用户获得root权限

**影响版本:** 1.8.0 to 1.9.12p1

**利用条件:** 用户需要能够通过sudoedit或sudo -e以root权限编辑文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809是sudo中的一个权限提升漏洞，存在于1.8.0到1.9.12p1版本。sudoedit (或 -e) 功能错误地处理了用户提供的环境变量（SUDO_EDITOR、VISUAL和EDITOR）中传递的额外参数，允许本地攻击者将任意条目附加到要处理的文件列表中。攻击者可以通过设置这些环境变量来包含恶意文件，从而导致权限提升。

**有效性：**
根据漏洞信息和POC代码，该漏洞利用是有效的。POC脚本首先检查sudo版本是否在受影响范围内，然后检查当前用户是否具有使用sudoedit或sudo -e以root权限编辑文件的权限。如果满足这两个条件，它将修改/etc/sudoers文件，为当前用户添加sudo权限，从而获得root shell。

**投毒风险：**
分析提供的POC代码（exploit.sh），没有发现明显的恶意代码或后门。脚本的主要功能是利用漏洞修改sudoers文件以提升权限，这是一个合法的漏洞利用方式，而非植入恶意代码。README.md文件仅是对漏洞和利用方式的描述。

**利用方式：**
1.  **检查sudo版本：** 脚本首先检查当前系统上安装的sudo版本是否在漏洞影响范围内。
2.  **检查sudoedit权限：** 脚本检查当前用户是否可以使用sudoedit或sudo -e以root权限编辑文件。
3.  **修改sudoers文件：** 如果满足上述条件，脚本会使用用户可控的环境变量EDITOR，通过sudoedit命令打开/etc/sudoers文件。由于sudoedit的漏洞，攻击者可以控制传递给EDITOR程序的参数，从而可以添加任意文件到编辑列表。
4.  **权限提升：**  攻击者在sudoers文件中添加一行，允许当前用户使用sudo执行任何命令，从而获得root权限。
5.  **获取root shell：** 最后，脚本使用`sudo su root`命令获得root shell。

**项目地址:** [n3m1sys/CVE-2023-22809-sudoedit-privesc](https://github.com/n3m1sys/CVE-2023-22809-sudoedit-privesc)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #11

**来源**: [CVE-2023-22809-pashayogi_CVE-2023-22809.md](../2023/CVE-2023-22809-pashayogi_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** 1.8.0 to 1.9.12p1

**利用条件:** 用户需要拥有使用 sudoedit 或 sudo -e 命令编辑文件的权限，且目标文件属于root用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 漏洞允许本地攻击者通过滥用 sudoedit（或 -e）功能中对用户提供的环境变量（SUDO_EDITOR、VISUAL 和 EDITOR）的处理方式，将任意条目附加到要处理的文件列表中，从而导致权限提升。

**有效性：**
POC 代码有效。该代码首先检查 sudo 版本是否在受影响范围内，然后检查当前用户是否可以使用 sudoedit 或 sudo -e 以 root 身份运行命令。如果满足条件，则它会通过设置 EDITOR 环境变量，利用 vim 的 `--` 参数绕过保护机制，打开 /etc/sudoers 文件进行编辑，引导用户添加一行配置以获取 root 权限，最终通过 `sudo su root` 获取 root shell。

**投毒风险：**
该 POC 代码中没有明显的投毒代码。脚本的功能很明确，即利用漏洞提升权限。它仅修改 `/etc/sudoers` 文件，而不会尝试植入任何隐藏的后门或其他恶意代码。

**利用方式：**
1.  **检查 sudo 版本：** 首先，检查目标系统上安装的 sudo 版本是否在受影响的范围内（1.8.0 到 1.9.12p1）。
2.  **检查 sudoedit 权限：** 检查当前用户是否具有使用 sudoedit 或 sudo -e 命令编辑文件的权限，并且该文件归 root 用户所有。
3.  **设置 EDITOR 环境变量：** 将 EDITOR 环境变量设置为包含 `--` 参数的恶意值，例如 `EDITOR="vim -- /etc/sudoers"`。
4.  **运行 sudoedit：** 运行 `sudoedit <受root拥有的文件>` 命令。由于环境变量的影响，这会导致使用 vim 打开 `/etc/sudoers` 文件。
5.  **编辑 /etc/sudoers：**  在打开的 `/etc/sudoers` 文件中，添加一行允许当前用户以 root 身份执行任何命令的配置，例如 `<用户名> ALL=(ALL:ALL) ALL`。
6.  **获取 root shell：** 使用 `sudo su root` 命令获取 root shell。

综上所述，提供的POC代码有效，不存在投毒风险，且能成功利用 CVE-2023-22809 漏洞提升权限。

**项目地址:** [pashayogi/CVE-2023-22809](https://github.com/pashayogi/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #12

**来源**: [CVE-2023-22809-spidoman_CVE-2023-22809-automated-python-exploits.md](../2023/CVE-2023-22809-spidoman_CVE-2023-22809-automated-python-exploits.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地低权限用户提升至root权限

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 需要目标系统上存在sudo且版本在受影响范围内，并且用户拥有sudoedit权限。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-22809是sudoedit中的一个权限提升漏洞。该漏洞源于sudoedit在处理用户提供的环境变量（SUDO_EDITOR、VISUAL和EDITOR）时，对额外的参数处理不当。攻击者可以通过在这些环境变量中注入恶意参数，例如`--`，来绕过保护机制，将任意文件添加到sudoedit要处理的文件列表中，从而以root权限编辑这些文件，最终导致权限提升。

**有效性:** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在且危害较高。提供的POC代码仓库的README.md声称可以自动利用该漏洞，但目前只有readme文件，无法判断代码有效性，但是根据描述，该漏洞利用方式比较简单，因此，实现自动利用的代码是可行的。

**投毒风险:** 提供的漏洞利用代码仓库只包含一个README.md文件，没有任何实际的利用代码，因此很难确定是否存在恶意代码。然而，考虑到这是一个可以提升权限的漏洞，攻击者可能会尝试通过包含后门或恶意指令来进一步控制系统。尽管当前没有明确的投毒证据，但考虑到其潜在的风险，投毒风险评估为20%。

**利用方式:**

1.  **利用sudoedit:**  利用sudoedit命令编辑文件。
2.  **设置环境变量:** 设置SUDO_EDITOR, VISUAL, 或者EDITOR环境变量，包含恶意参数。例如 `EDITOR='vim -- /path/to/arbitrary/file'`。
3.  **触发漏洞:**  执行`sudoedit <target_file>`，其中`<target_file>`可以是任意文件，攻击者通过环境变量注入，可以控制实际被编辑的文件，达到修改敏感文件，提升权限的目的。
4.  **权限提升:**  由于sudoedit以root权限运行，攻击者通过修改/etc/passwd或/etc/shadow等文件，或执行其他恶意操作，可以获得root权限。

**项目地址:** [spidoman/CVE-2023-22809-automated-python-exploits](https://github.com/spidoman/CVE-2023-22809-automated-python-exploits)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---



---

## POC #6

**来源**: [CVE-2023-22809-Toothless5143_CVE-2023-22809.md](../2023/CVE-2023-22809-Toothless5143_CVE-2023-22809.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，本地权限提升至root

**影响版本:** 1.8.0 to 1.9.12p1

**利用条件:** 用户需要具有sudoedit或者sudo -e的权限，且可以以root或者ALL用户运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 是一个 Sudo 的权限提升漏洞，存在于 1.8.0 到 1.9.12p1 版本中。该漏洞是由于 `sudoedit` (也称为 `-e` 功能) 在处理用户提供的环境变量（`SUDO_EDITOR`、`VISUAL` 和 `EDITOR`）中传递的额外参数时存在错误，允许本地攻击者将任意条目附加到要处理的文件列表中，从而导致权限提升。

**利用方式：**
1.  **检查Sudo版本：** 漏洞利用代码首先检查当前安装的 Sudo 版本是否在受影响的范围内 (1.8.0 to 1.9.12p1)。
2.  **检查用户权限：** 漏洞利用代码检查当前用户是否具有使用 `sudoedit` 或 `sudo -e` 命令以 root 身份或以 `ALL` 用户身份运行的权限。这通常意味着用户在 `sudoers` 文件中具有相应的条目。
3.  **利用环境变量注入参数：** 如果满足上述条件，攻击者可以通过设置 `SUDO_EDITOR`、`VISUAL` 或 `EDITOR` 环境变量来注入额外的参数。攻击者可以在这些环境变量中包含 `--` 参数，从而欺骗 `sudoedit` 命令，使其将任意文件添加到要编辑的文件列表中。
4.  **修改sudoers文件：**POC通过vim打开sudoers文件，提示用户添加一行提权配置到sudoers文件中，完成提权。
5.  **获得root权限：**成功修改 `sudoers` 文件后，攻击者可以使用 `sudo su root` 命令获得 root 权限。

**投毒风险评估：**
仔细审查了提供的 POC 代码，没有发现任何明显的恶意代码或后门。该脚本的主要功能是检查 Sudo 版本、用户权限，然后引导用户使用 `sudoedit` 修改 `/etc/sudoers` 文件来提升权限。没有发现任何未经授权的网络连接、文件修改或信息泄露行为。因此，认为该 POC 代码的投毒风险为 0%。

**项目地址:** [Toothless5143/CVE-2023-22809](https://github.com/Toothless5143/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #7

**来源**: [CVE-2023-22809-asepsaepdin_CVE-2023-22809.md](../2023/CVE-2023-22809-asepsaepdin_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升漏洞

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地用户提升至root权限

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 目标系统sudo版本在受影响范围内，当前用户需要具有使用sudoedit或sudo -e命令编辑文件的权限，且目标文件属于root或ALL用户/用户组。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 漏洞存在于 Sudo 1.8.0 到 1.9.12p1 版本中。sudoedit (也称为 -e) 功能错误地处理了用户提供的环境变量（SUDO_EDITOR、VISUAL 和 EDITOR）中传递的额外参数，允许本地攻击者将任意条目附加到要处理的文件列表中。这可能导致权限提升。问题在于用户指定的编辑器可能包含一个“--”参数，该参数会破坏保护机制，例如，EDITOR='vim -- /path/to/extra/file' 值。

**利用方式：**

1.  **检查sudo版本：** 检查目标系统上安装的sudo版本是否在受影响范围内（1.8.0 到 1.9.12p1）。
2.  **验证sudoedit权限：** 确认当前用户是否具有使用`sudoedit`或`sudo -e`命令编辑root权限文件的权限。可以通过`sudo -l`命令查看当前用户的sudo权限。
3.  **设置环境变量：** 设置环境变量`EDITOR`、`VISUAL`或`SUDO_EDITOR`，使其包含恶意参数。例如，`EDITOR='nano -- /etc/sudoers'`。
4.  **执行sudoedit：** 使用`sudoedit`或`sudo -e`命令编辑目标文件。由于环境变量中的恶意参数，实际上可以编辑`/etc/sudoers`文件。
5.  **修改sudoers文件：** 在`/etc/sudoers`文件中添加当前用户具有免密sudo权限的条目，例如`username ALL=(ALL:ALL) ALL`。
6.  **获取root权限：** 使用`sudo su root`或`sudo -i`命令获取root权限。

**有效性：**

提供的POC代码有效。它首先检查sudo版本，然后验证用户是否可以运行sudoedit命令。如果可以，它会指示用户将一行添加到sudoers文件中，以便授予用户root权限。最后，它尝试使用`sudo su root`获取root shell。

**投毒风险：**

查看了exploit.sh脚本。该脚本的主要功能是利用CVE-2023-22809漏洞，通过修改/etc/sudoers文件来提升权限。没有发现任何明显的恶意代码或后门。该脚本的目的是利用漏洞，而不是植入持久性的后门。该脚本需要用户交互，在sudoers文件中添加特定行，这降低了静默投毒的风险。
根据分析，此仓库中存在作者隐藏的投毒代码的可能性为0%。

**项目地址:** [asepsaepdin/CVE-2023-22809](https://github.com/asepsaepdin/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #8

**来源**: [CVE-2023-22809-hello4r1end_patch_CVE-2023-22809.md](../2023/CVE-2023-22809-hello4r1end_patch_CVE-2023-22809.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地攻击者提升权限至root

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 漏洞存在于 Sudo 1.9.12p2 之前的版本中，允许本地攻击者通过操纵 SUDO_EDITOR, VISUAL, 和 EDITOR 环境变量中的参数，利用 sudoedit 命令附加额外的文件进行编辑，从而导致权限提升。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的利用是有效的。多个安全厂商和社区都确认了该漏洞的存在和利用方式。

**投毒风险：**
提供的漏洞利用代码 (`CVE-2023-22809Patch.sh` 和 `README.md`) 实际上是一个用于**更新 Sudo 版本**的脚本，它从 GitHub 下载一个 Debian 包并安装它。这个脚本本身并没有包含任何恶意代码或后门，所以投毒风险评估为0%。它仅仅是尝试修复漏洞，而不是利用漏洞。

**利用方式：**
该漏洞的利用方式是通过设置环境变量 `SUDO_EDITOR`，`VISUAL` 或 `EDITOR`，在其中包含 `--` 参数以及要编辑的恶意文件路径，当用户使用 `sudoedit` 命令时，这些额外的参数会被传递给编辑器，从而允许编辑本来没有权限编辑的文件。例如：`EDITOR='vim -- /etc/shadow'; sudoedit 文件名`。攻击者可以利用此漏洞修改 `/etc/shadow` 文件或其它特权文件，从而获得 root 权限。

**项目地址:** [hello4r1end/patch_CVE-2023-22809](https://github.com/hello4r1end/patch_CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #9

**来源**: [CVE-2023-22809-laxmiyamkolu_SUDO-privilege-escalation.md](../2023/CVE-2023-22809-laxmiyamkolu_SUDO-privilege-escalation.md)

## CVE-2023-22809-Sudoedit特权提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 特权提升

**影响应用:** Sudo

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** 1.8.0 <= Sudo < 1.9.12p2

**利用条件:** 需要用户具有sudoedit权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809 漏洞允许本地攻击者通过 `sudoedit` 命令提升权限。`sudoedit` 功能在处理用户提供的环境变量（`SUDO_EDITOR`、`VISUAL` 和 `EDITOR`）时存在缺陷，允许攻击者向要处理的文件列表中追加任意条目。攻击者可以通过在编辑器环境变量中包含 `--` 参数来绕过保护机制，例如，设置 `EDITOR='vim -- /path/to/extra/file'`。

**漏洞利用方式：**

1.  **检查Sudo版本：** 确认Sudo版本在受影响范围内 (1.8.0 到 1.9.12p1)。
2.  **检查用户权限：** 确认用户拥有使用`sudoedit`编辑文件的权限。
3.  **设置EDITOR环境变量：** 设置`EDITOR`环境变量，使其包含恶意参数，例如`EDITOR='vim -- /etc/passwd'`。
4.  **使用sudoedit编辑文件：** 使用`sudoedit`编辑允许的文件，触发漏洞，从而能够编辑`/etc/passwd`或其他敏感文件。
5.  **修改/etc/passwd：** 修改`/etc/passwd`文件，将当前用户的UID修改为0，使其成为root用户。
6.  **切换用户：** 使用`su`命令切换到被提权的用户。

**有效性：**

提供的POC代码基本有效，它演示了利用漏洞提升权限的步骤。代码首先检查Sudo版本和用户权限，然后指导用户设置`EDITOR`环境变量，并使用`sudoedit`编辑文件。最后，它引导用户手动修改`/etc/passwd`文件并切换用户。该脚本是半自动化的，需要用户手动干预来修改`/etc/passwd`。

**投毒风险：**

该POC代码的投毒风险较低，约为10%。主要风险在于脚本尝试引导用户修改`/etc/passwd`文件。虽然这是漏洞利用的一部分，但如果用户不小心修改了其他重要配置，可能会导致系统不稳定或无法启动。此外，脚本的作者可能在`README.md`或其他文件中包含误导性信息，引导用户执行不安全的操作。但总体而言，代码本身没有明显的恶意行为。

更详细地分析，脚本中需要用户手动修改/etc/passwd这一步，用户可能会犯错，导致系统问题。理论上，攻击者可以将错误的修改方式写入脚本或文档中，让用户误操作，但现有代码并没有此类行为，因此风险较低。

**项目地址:** [laxmiyamkolu/SUDO-privilege-escalation](https://github.com/laxmiyamkolu/SUDO-privilege-escalation)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #10

**来源**: [CVE-2023-22809-n3m1sys_CVE-2023-22809-sudoedit-privesc.md](../2023/CVE-2023-22809-n3m1sys_CVE-2023-22809-sudoedit-privesc.md)

## CVE-2023-22809-sudo-权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许本地低权限用户获得root权限

**影响版本:** 1.8.0 to 1.9.12p1

**利用条件:** 用户需要能够通过sudoedit或sudo -e以root权限编辑文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809是sudo中的一个权限提升漏洞，存在于1.8.0到1.9.12p1版本。sudoedit (或 -e) 功能错误地处理了用户提供的环境变量（SUDO_EDITOR、VISUAL和EDITOR）中传递的额外参数，允许本地攻击者将任意条目附加到要处理的文件列表中。攻击者可以通过设置这些环境变量来包含恶意文件，从而导致权限提升。

**有效性：**
根据漏洞信息和POC代码，该漏洞利用是有效的。POC脚本首先检查sudo版本是否在受影响范围内，然后检查当前用户是否具有使用sudoedit或sudo -e以root权限编辑文件的权限。如果满足这两个条件，它将修改/etc/sudoers文件，为当前用户添加sudo权限，从而获得root shell。

**投毒风险：**
分析提供的POC代码（exploit.sh），没有发现明显的恶意代码或后门。脚本的主要功能是利用漏洞修改sudoers文件以提升权限，这是一个合法的漏洞利用方式，而非植入恶意代码。README.md文件仅是对漏洞和利用方式的描述。

**利用方式：**
1.  **检查sudo版本：** 脚本首先检查当前系统上安装的sudo版本是否在漏洞影响范围内。
2.  **检查sudoedit权限：** 脚本检查当前用户是否可以使用sudoedit或sudo -e以root权限编辑文件。
3.  **修改sudoers文件：** 如果满足上述条件，脚本会使用用户可控的环境变量EDITOR，通过sudoedit命令打开/etc/sudoers文件。由于sudoedit的漏洞，攻击者可以控制传递给EDITOR程序的参数，从而可以添加任意文件到编辑列表。
4.  **权限提升：**  攻击者在sudoers文件中添加一行，允许当前用户使用sudo执行任何命令，从而获得root权限。
5.  **获取root shell：** 最后，脚本使用`sudo su root`命令获得root shell。

**项目地址:** [n3m1sys/CVE-2023-22809-sudoedit-privesc](https://github.com/n3m1sys/CVE-2023-22809-sudoedit-privesc)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #11

**来源**: [CVE-2023-22809-pashayogi_CVE-2023-22809.md](../2023/CVE-2023-22809-pashayogi_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** 1.8.0 to 1.9.12p1

**利用条件:** 用户需要拥有使用 sudoedit 或 sudo -e 命令编辑文件的权限，且目标文件属于root用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 漏洞允许本地攻击者通过滥用 sudoedit（或 -e）功能中对用户提供的环境变量（SUDO_EDITOR、VISUAL 和 EDITOR）的处理方式，将任意条目附加到要处理的文件列表中，从而导致权限提升。

**有效性：**
POC 代码有效。该代码首先检查 sudo 版本是否在受影响范围内，然后检查当前用户是否可以使用 sudoedit 或 sudo -e 以 root 身份运行命令。如果满足条件，则它会通过设置 EDITOR 环境变量，利用 vim 的 `--` 参数绕过保护机制，打开 /etc/sudoers 文件进行编辑，引导用户添加一行配置以获取 root 权限，最终通过 `sudo su root` 获取 root shell。

**投毒风险：**
该 POC 代码中没有明显的投毒代码。脚本的功能很明确，即利用漏洞提升权限。它仅修改 `/etc/sudoers` 文件，而不会尝试植入任何隐藏的后门或其他恶意代码。

**利用方式：**
1.  **检查 sudo 版本：** 首先，检查目标系统上安装的 sudo 版本是否在受影响的范围内（1.8.0 到 1.9.12p1）。
2.  **检查 sudoedit 权限：** 检查当前用户是否具有使用 sudoedit 或 sudo -e 命令编辑文件的权限，并且该文件归 root 用户所有。
3.  **设置 EDITOR 环境变量：** 将 EDITOR 环境变量设置为包含 `--` 参数的恶意值，例如 `EDITOR="vim -- /etc/sudoers"`。
4.  **运行 sudoedit：** 运行 `sudoedit <受root拥有的文件>` 命令。由于环境变量的影响，这会导致使用 vim 打开 `/etc/sudoers` 文件。
5.  **编辑 /etc/sudoers：**  在打开的 `/etc/sudoers` 文件中，添加一行允许当前用户以 root 身份执行任何命令的配置，例如 `<用户名> ALL=(ALL:ALL) ALL`。
6.  **获取 root shell：** 使用 `sudo su root` 命令获取 root shell。

综上所述，提供的POC代码有效，不存在投毒风险，且能成功利用 CVE-2023-22809 漏洞提升权限。

**项目地址:** [pashayogi/CVE-2023-22809](https://github.com/pashayogi/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #12

**来源**: [CVE-2023-22809-spidoman_CVE-2023-22809-automated-python-exploits.md](../2023/CVE-2023-22809-spidoman_CVE-2023-22809-automated-python-exploits.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地低权限用户提升至root权限

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 需要目标系统上存在sudo且版本在受影响范围内，并且用户拥有sudoedit权限。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-22809是sudoedit中的一个权限提升漏洞。该漏洞源于sudoedit在处理用户提供的环境变量（SUDO_EDITOR、VISUAL和EDITOR）时，对额外的参数处理不当。攻击者可以通过在这些环境变量中注入恶意参数，例如`--`，来绕过保护机制，将任意文件添加到sudoedit要处理的文件列表中，从而以root权限编辑这些文件，最终导致权限提升。

**有效性:** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在且危害较高。提供的POC代码仓库的README.md声称可以自动利用该漏洞，但目前只有readme文件，无法判断代码有效性，但是根据描述，该漏洞利用方式比较简单，因此，实现自动利用的代码是可行的。

**投毒风险:** 提供的漏洞利用代码仓库只包含一个README.md文件，没有任何实际的利用代码，因此很难确定是否存在恶意代码。然而，考虑到这是一个可以提升权限的漏洞，攻击者可能会尝试通过包含后门或恶意指令来进一步控制系统。尽管当前没有明确的投毒证据，但考虑到其潜在的风险，投毒风险评估为20%。

**利用方式:**

1.  **利用sudoedit:**  利用sudoedit命令编辑文件。
2.  **设置环境变量:** 设置SUDO_EDITOR, VISUAL, 或者EDITOR环境变量，包含恶意参数。例如 `EDITOR='vim -- /path/to/arbitrary/file'`。
3.  **触发漏洞:**  执行`sudoedit <target_file>`，其中`<target_file>`可以是任意文件，攻击者通过环境变量注入，可以控制实际被编辑的文件，达到修改敏感文件，提升权限的目的。
4.  **权限提升:**  由于sudoedit以root权限运行，攻击者通过修改/etc/passwd或/etc/shadow等文件，或执行其他恶意操作，可以获得root权限。

**项目地址:** [spidoman/CVE-2023-22809-automated-python-exploits](https://github.com/spidoman/CVE-2023-22809-automated-python-exploits)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---



---

## POC #6

**来源**: [CVE-2023-22809-Toothless5143_CVE-2023-22809.md](../2023/CVE-2023-22809-Toothless5143_CVE-2023-22809.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，本地权限提升至root

**影响版本:** 1.8.0 to 1.9.12p1

**利用条件:** 用户需要具有sudoedit或者sudo -e的权限，且可以以root或者ALL用户运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 是一个 Sudo 的权限提升漏洞，存在于 1.8.0 到 1.9.12p1 版本中。该漏洞是由于 `sudoedit` (也称为 `-e` 功能) 在处理用户提供的环境变量（`SUDO_EDITOR`、`VISUAL` 和 `EDITOR`）中传递的额外参数时存在错误，允许本地攻击者将任意条目附加到要处理的文件列表中，从而导致权限提升。

**利用方式：**
1.  **检查Sudo版本：** 漏洞利用代码首先检查当前安装的 Sudo 版本是否在受影响的范围内 (1.8.0 to 1.9.12p1)。
2.  **检查用户权限：** 漏洞利用代码检查当前用户是否具有使用 `sudoedit` 或 `sudo -e` 命令以 root 身份或以 `ALL` 用户身份运行的权限。这通常意味着用户在 `sudoers` 文件中具有相应的条目。
3.  **利用环境变量注入参数：** 如果满足上述条件，攻击者可以通过设置 `SUDO_EDITOR`、`VISUAL` 或 `EDITOR` 环境变量来注入额外的参数。攻击者可以在这些环境变量中包含 `--` 参数，从而欺骗 `sudoedit` 命令，使其将任意文件添加到要编辑的文件列表中。
4.  **修改sudoers文件：**POC通过vim打开sudoers文件，提示用户添加一行提权配置到sudoers文件中，完成提权。
5.  **获得root权限：**成功修改 `sudoers` 文件后，攻击者可以使用 `sudo su root` 命令获得 root 权限。

**投毒风险评估：**
仔细审查了提供的 POC 代码，没有发现任何明显的恶意代码或后门。该脚本的主要功能是检查 Sudo 版本、用户权限，然后引导用户使用 `sudoedit` 修改 `/etc/sudoers` 文件来提升权限。没有发现任何未经授权的网络连接、文件修改或信息泄露行为。因此，认为该 POC 代码的投毒风险为 0%。

**项目地址:** [Toothless5143/CVE-2023-22809](https://github.com/Toothless5143/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #7

**来源**: [CVE-2023-22809-asepsaepdin_CVE-2023-22809.md](../2023/CVE-2023-22809-asepsaepdin_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升漏洞

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地用户提升至root权限

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 目标系统sudo版本在受影响范围内，当前用户需要具有使用sudoedit或sudo -e命令编辑文件的权限，且目标文件属于root或ALL用户/用户组。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 漏洞存在于 Sudo 1.8.0 到 1.9.12p1 版本中。sudoedit (也称为 -e) 功能错误地处理了用户提供的环境变量（SUDO_EDITOR、VISUAL 和 EDITOR）中传递的额外参数，允许本地攻击者将任意条目附加到要处理的文件列表中。这可能导致权限提升。问题在于用户指定的编辑器可能包含一个“--”参数，该参数会破坏保护机制，例如，EDITOR='vim -- /path/to/extra/file' 值。

**利用方式：**

1.  **检查sudo版本：** 检查目标系统上安装的sudo版本是否在受影响范围内（1.8.0 到 1.9.12p1）。
2.  **验证sudoedit权限：** 确认当前用户是否具有使用`sudoedit`或`sudo -e`命令编辑root权限文件的权限。可以通过`sudo -l`命令查看当前用户的sudo权限。
3.  **设置环境变量：** 设置环境变量`EDITOR`、`VISUAL`或`SUDO_EDITOR`，使其包含恶意参数。例如，`EDITOR='nano -- /etc/sudoers'`。
4.  **执行sudoedit：** 使用`sudoedit`或`sudo -e`命令编辑目标文件。由于环境变量中的恶意参数，实际上可以编辑`/etc/sudoers`文件。
5.  **修改sudoers文件：** 在`/etc/sudoers`文件中添加当前用户具有免密sudo权限的条目，例如`username ALL=(ALL:ALL) ALL`。
6.  **获取root权限：** 使用`sudo su root`或`sudo -i`命令获取root权限。

**有效性：**

提供的POC代码有效。它首先检查sudo版本，然后验证用户是否可以运行sudoedit命令。如果可以，它会指示用户将一行添加到sudoers文件中，以便授予用户root权限。最后，它尝试使用`sudo su root`获取root shell。

**投毒风险：**

查看了exploit.sh脚本。该脚本的主要功能是利用CVE-2023-22809漏洞，通过修改/etc/sudoers文件来提升权限。没有发现任何明显的恶意代码或后门。该脚本的目的是利用漏洞，而不是植入持久性的后门。该脚本需要用户交互，在sudoers文件中添加特定行，这降低了静默投毒的风险。
根据分析，此仓库中存在作者隐藏的投毒代码的可能性为0%。

**项目地址:** [asepsaepdin/CVE-2023-22809](https://github.com/asepsaepdin/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #8

**来源**: [CVE-2023-22809-hello4r1end_patch_CVE-2023-22809.md](../2023/CVE-2023-22809-hello4r1end_patch_CVE-2023-22809.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地攻击者提升权限至root

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 漏洞存在于 Sudo 1.9.12p2 之前的版本中，允许本地攻击者通过操纵 SUDO_EDITOR, VISUAL, 和 EDITOR 环境变量中的参数，利用 sudoedit 命令附加额外的文件进行编辑，从而导致权限提升。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的利用是有效的。多个安全厂商和社区都确认了该漏洞的存在和利用方式。

**投毒风险：**
提供的漏洞利用代码 (`CVE-2023-22809Patch.sh` 和 `README.md`) 实际上是一个用于**更新 Sudo 版本**的脚本，它从 GitHub 下载一个 Debian 包并安装它。这个脚本本身并没有包含任何恶意代码或后门，所以投毒风险评估为0%。它仅仅是尝试修复漏洞，而不是利用漏洞。

**利用方式：**
该漏洞的利用方式是通过设置环境变量 `SUDO_EDITOR`，`VISUAL` 或 `EDITOR`，在其中包含 `--` 参数以及要编辑的恶意文件路径，当用户使用 `sudoedit` 命令时，这些额外的参数会被传递给编辑器，从而允许编辑本来没有权限编辑的文件。例如：`EDITOR='vim -- /etc/shadow'; sudoedit 文件名`。攻击者可以利用此漏洞修改 `/etc/shadow` 文件或其它特权文件，从而获得 root 权限。

**项目地址:** [hello4r1end/patch_CVE-2023-22809](https://github.com/hello4r1end/patch_CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #9

**来源**: [CVE-2023-22809-laxmiyamkolu_SUDO-privilege-escalation.md](../2023/CVE-2023-22809-laxmiyamkolu_SUDO-privilege-escalation.md)

## CVE-2023-22809-Sudoedit特权提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 特权提升

**影响应用:** Sudo

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** 1.8.0 <= Sudo < 1.9.12p2

**利用条件:** 需要用户具有sudoedit权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809 漏洞允许本地攻击者通过 `sudoedit` 命令提升权限。`sudoedit` 功能在处理用户提供的环境变量（`SUDO_EDITOR`、`VISUAL` 和 `EDITOR`）时存在缺陷，允许攻击者向要处理的文件列表中追加任意条目。攻击者可以通过在编辑器环境变量中包含 `--` 参数来绕过保护机制，例如，设置 `EDITOR='vim -- /path/to/extra/file'`。

**漏洞利用方式：**

1.  **检查Sudo版本：** 确认Sudo版本在受影响范围内 (1.8.0 到 1.9.12p1)。
2.  **检查用户权限：** 确认用户拥有使用`sudoedit`编辑文件的权限。
3.  **设置EDITOR环境变量：** 设置`EDITOR`环境变量，使其包含恶意参数，例如`EDITOR='vim -- /etc/passwd'`。
4.  **使用sudoedit编辑文件：** 使用`sudoedit`编辑允许的文件，触发漏洞，从而能够编辑`/etc/passwd`或其他敏感文件。
5.  **修改/etc/passwd：** 修改`/etc/passwd`文件，将当前用户的UID修改为0，使其成为root用户。
6.  **切换用户：** 使用`su`命令切换到被提权的用户。

**有效性：**

提供的POC代码基本有效，它演示了利用漏洞提升权限的步骤。代码首先检查Sudo版本和用户权限，然后指导用户设置`EDITOR`环境变量，并使用`sudoedit`编辑文件。最后，它引导用户手动修改`/etc/passwd`文件并切换用户。该脚本是半自动化的，需要用户手动干预来修改`/etc/passwd`。

**投毒风险：**

该POC代码的投毒风险较低，约为10%。主要风险在于脚本尝试引导用户修改`/etc/passwd`文件。虽然这是漏洞利用的一部分，但如果用户不小心修改了其他重要配置，可能会导致系统不稳定或无法启动。此外，脚本的作者可能在`README.md`或其他文件中包含误导性信息，引导用户执行不安全的操作。但总体而言，代码本身没有明显的恶意行为。

更详细地分析，脚本中需要用户手动修改/etc/passwd这一步，用户可能会犯错，导致系统问题。理论上，攻击者可以将错误的修改方式写入脚本或文档中，让用户误操作，但现有代码并没有此类行为，因此风险较低。

**项目地址:** [laxmiyamkolu/SUDO-privilege-escalation](https://github.com/laxmiyamkolu/SUDO-privilege-escalation)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #10

**来源**: [CVE-2023-22809-n3m1sys_CVE-2023-22809-sudoedit-privesc.md](../2023/CVE-2023-22809-n3m1sys_CVE-2023-22809-sudoedit-privesc.md)

## CVE-2023-22809-sudo-权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许本地低权限用户获得root权限

**影响版本:** 1.8.0 to 1.9.12p1

**利用条件:** 用户需要能够通过sudoedit或sudo -e以root权限编辑文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809是sudo中的一个权限提升漏洞，存在于1.8.0到1.9.12p1版本。sudoedit (或 -e) 功能错误地处理了用户提供的环境变量（SUDO_EDITOR、VISUAL和EDITOR）中传递的额外参数，允许本地攻击者将任意条目附加到要处理的文件列表中。攻击者可以通过设置这些环境变量来包含恶意文件，从而导致权限提升。

**有效性：**
根据漏洞信息和POC代码，该漏洞利用是有效的。POC脚本首先检查sudo版本是否在受影响范围内，然后检查当前用户是否具有使用sudoedit或sudo -e以root权限编辑文件的权限。如果满足这两个条件，它将修改/etc/sudoers文件，为当前用户添加sudo权限，从而获得root shell。

**投毒风险：**
分析提供的POC代码（exploit.sh），没有发现明显的恶意代码或后门。脚本的主要功能是利用漏洞修改sudoers文件以提升权限，这是一个合法的漏洞利用方式，而非植入恶意代码。README.md文件仅是对漏洞和利用方式的描述。

**利用方式：**
1.  **检查sudo版本：** 脚本首先检查当前系统上安装的sudo版本是否在漏洞影响范围内。
2.  **检查sudoedit权限：** 脚本检查当前用户是否可以使用sudoedit或sudo -e以root权限编辑文件。
3.  **修改sudoers文件：** 如果满足上述条件，脚本会使用用户可控的环境变量EDITOR，通过sudoedit命令打开/etc/sudoers文件。由于sudoedit的漏洞，攻击者可以控制传递给EDITOR程序的参数，从而可以添加任意文件到编辑列表。
4.  **权限提升：**  攻击者在sudoers文件中添加一行，允许当前用户使用sudo执行任何命令，从而获得root权限。
5.  **获取root shell：** 最后，脚本使用`sudo su root`命令获得root shell。

**项目地址:** [n3m1sys/CVE-2023-22809-sudoedit-privesc](https://github.com/n3m1sys/CVE-2023-22809-sudoedit-privesc)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #11

**来源**: [CVE-2023-22809-pashayogi_CVE-2023-22809.md](../2023/CVE-2023-22809-pashayogi_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** 1.8.0 to 1.9.12p1

**利用条件:** 用户需要拥有使用 sudoedit 或 sudo -e 命令编辑文件的权限，且目标文件属于root用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 漏洞允许本地攻击者通过滥用 sudoedit（或 -e）功能中对用户提供的环境变量（SUDO_EDITOR、VISUAL 和 EDITOR）的处理方式，将任意条目附加到要处理的文件列表中，从而导致权限提升。

**有效性：**
POC 代码有效。该代码首先检查 sudo 版本是否在受影响范围内，然后检查当前用户是否可以使用 sudoedit 或 sudo -e 以 root 身份运行命令。如果满足条件，则它会通过设置 EDITOR 环境变量，利用 vim 的 `--` 参数绕过保护机制，打开 /etc/sudoers 文件进行编辑，引导用户添加一行配置以获取 root 权限，最终通过 `sudo su root` 获取 root shell。

**投毒风险：**
该 POC 代码中没有明显的投毒代码。脚本的功能很明确，即利用漏洞提升权限。它仅修改 `/etc/sudoers` 文件，而不会尝试植入任何隐藏的后门或其他恶意代码。

**利用方式：**
1.  **检查 sudo 版本：** 首先，检查目标系统上安装的 sudo 版本是否在受影响的范围内（1.8.0 到 1.9.12p1）。
2.  **检查 sudoedit 权限：** 检查当前用户是否具有使用 sudoedit 或 sudo -e 命令编辑文件的权限，并且该文件归 root 用户所有。
3.  **设置 EDITOR 环境变量：** 将 EDITOR 环境变量设置为包含 `--` 参数的恶意值，例如 `EDITOR="vim -- /etc/sudoers"`。
4.  **运行 sudoedit：** 运行 `sudoedit <受root拥有的文件>` 命令。由于环境变量的影响，这会导致使用 vim 打开 `/etc/sudoers` 文件。
5.  **编辑 /etc/sudoers：**  在打开的 `/etc/sudoers` 文件中，添加一行允许当前用户以 root 身份执行任何命令的配置，例如 `<用户名> ALL=(ALL:ALL) ALL`。
6.  **获取 root shell：** 使用 `sudo su root` 命令获取 root shell。

综上所述，提供的POC代码有效，不存在投毒风险，且能成功利用 CVE-2023-22809 漏洞提升权限。

**项目地址:** [pashayogi/CVE-2023-22809](https://github.com/pashayogi/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #12

**来源**: [CVE-2023-22809-spidoman_CVE-2023-22809-automated-python-exploits.md](../2023/CVE-2023-22809-spidoman_CVE-2023-22809-automated-python-exploits.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地低权限用户提升至root权限

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 需要目标系统上存在sudo且版本在受影响范围内，并且用户拥有sudoedit权限。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-22809是sudoedit中的一个权限提升漏洞。该漏洞源于sudoedit在处理用户提供的环境变量（SUDO_EDITOR、VISUAL和EDITOR）时，对额外的参数处理不当。攻击者可以通过在这些环境变量中注入恶意参数，例如`--`，来绕过保护机制，将任意文件添加到sudoedit要处理的文件列表中，从而以root权限编辑这些文件，最终导致权限提升。

**有效性:** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在且危害较高。提供的POC代码仓库的README.md声称可以自动利用该漏洞，但目前只有readme文件，无法判断代码有效性，但是根据描述，该漏洞利用方式比较简单，因此，实现自动利用的代码是可行的。

**投毒风险:** 提供的漏洞利用代码仓库只包含一个README.md文件，没有任何实际的利用代码，因此很难确定是否存在恶意代码。然而，考虑到这是一个可以提升权限的漏洞，攻击者可能会尝试通过包含后门或恶意指令来进一步控制系统。尽管当前没有明确的投毒证据，但考虑到其潜在的风险，投毒风险评估为20%。

**利用方式:**

1.  **利用sudoedit:**  利用sudoedit命令编辑文件。
2.  **设置环境变量:** 设置SUDO_EDITOR, VISUAL, 或者EDITOR环境变量，包含恶意参数。例如 `EDITOR='vim -- /path/to/arbitrary/file'`。
3.  **触发漏洞:**  执行`sudoedit <target_file>`，其中`<target_file>`可以是任意文件，攻击者通过环境变量注入，可以控制实际被编辑的文件，达到修改敏感文件，提升权限的目的。
4.  **权限提升:**  由于sudoedit以root权限运行，攻击者通过修改/etc/passwd或/etc/shadow等文件，或执行其他恶意操作，可以获得root权限。

**项目地址:** [spidoman/CVE-2023-22809-automated-python-exploits](https://github.com/spidoman/CVE-2023-22809-automated-python-exploits)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---



---

## POC #6

**来源**: [CVE-2023-22809-Toothless5143_CVE-2023-22809.md](../2023/CVE-2023-22809-Toothless5143_CVE-2023-22809.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，本地权限提升至root

**影响版本:** 1.8.0 to 1.9.12p1

**利用条件:** 用户需要具有sudoedit或者sudo -e的权限，且可以以root或者ALL用户运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 是一个 Sudo 的权限提升漏洞，存在于 1.8.0 到 1.9.12p1 版本中。该漏洞是由于 `sudoedit` (也称为 `-e` 功能) 在处理用户提供的环境变量（`SUDO_EDITOR`、`VISUAL` 和 `EDITOR`）中传递的额外参数时存在错误，允许本地攻击者将任意条目附加到要处理的文件列表中，从而导致权限提升。

**利用方式：**
1.  **检查Sudo版本：** 漏洞利用代码首先检查当前安装的 Sudo 版本是否在受影响的范围内 (1.8.0 to 1.9.12p1)。
2.  **检查用户权限：** 漏洞利用代码检查当前用户是否具有使用 `sudoedit` 或 `sudo -e` 命令以 root 身份或以 `ALL` 用户身份运行的权限。这通常意味着用户在 `sudoers` 文件中具有相应的条目。
3.  **利用环境变量注入参数：** 如果满足上述条件，攻击者可以通过设置 `SUDO_EDITOR`、`VISUAL` 或 `EDITOR` 环境变量来注入额外的参数。攻击者可以在这些环境变量中包含 `--` 参数，从而欺骗 `sudoedit` 命令，使其将任意文件添加到要编辑的文件列表中。
4.  **修改sudoers文件：**POC通过vim打开sudoers文件，提示用户添加一行提权配置到sudoers文件中，完成提权。
5.  **获得root权限：**成功修改 `sudoers` 文件后，攻击者可以使用 `sudo su root` 命令获得 root 权限。

**投毒风险评估：**
仔细审查了提供的 POC 代码，没有发现任何明显的恶意代码或后门。该脚本的主要功能是检查 Sudo 版本、用户权限，然后引导用户使用 `sudoedit` 修改 `/etc/sudoers` 文件来提升权限。没有发现任何未经授权的网络连接、文件修改或信息泄露行为。因此，认为该 POC 代码的投毒风险为 0%。

**项目地址:** [Toothless5143/CVE-2023-22809](https://github.com/Toothless5143/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #7

**来源**: [CVE-2023-22809-asepsaepdin_CVE-2023-22809.md](../2023/CVE-2023-22809-asepsaepdin_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升漏洞

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地用户提升至root权限

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 目标系统sudo版本在受影响范围内，当前用户需要具有使用sudoedit或sudo -e命令编辑文件的权限，且目标文件属于root或ALL用户/用户组。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 漏洞存在于 Sudo 1.8.0 到 1.9.12p1 版本中。sudoedit (也称为 -e) 功能错误地处理了用户提供的环境变量（SUDO_EDITOR、VISUAL 和 EDITOR）中传递的额外参数，允许本地攻击者将任意条目附加到要处理的文件列表中。这可能导致权限提升。问题在于用户指定的编辑器可能包含一个“--”参数，该参数会破坏保护机制，例如，EDITOR='vim -- /path/to/extra/file' 值。

**利用方式：**

1.  **检查sudo版本：** 检查目标系统上安装的sudo版本是否在受影响范围内（1.8.0 到 1.9.12p1）。
2.  **验证sudoedit权限：** 确认当前用户是否具有使用`sudoedit`或`sudo -e`命令编辑root权限文件的权限。可以通过`sudo -l`命令查看当前用户的sudo权限。
3.  **设置环境变量：** 设置环境变量`EDITOR`、`VISUAL`或`SUDO_EDITOR`，使其包含恶意参数。例如，`EDITOR='nano -- /etc/sudoers'`。
4.  **执行sudoedit：** 使用`sudoedit`或`sudo -e`命令编辑目标文件。由于环境变量中的恶意参数，实际上可以编辑`/etc/sudoers`文件。
5.  **修改sudoers文件：** 在`/etc/sudoers`文件中添加当前用户具有免密sudo权限的条目，例如`username ALL=(ALL:ALL) ALL`。
6.  **获取root权限：** 使用`sudo su root`或`sudo -i`命令获取root权限。

**有效性：**

提供的POC代码有效。它首先检查sudo版本，然后验证用户是否可以运行sudoedit命令。如果可以，它会指示用户将一行添加到sudoers文件中，以便授予用户root权限。最后，它尝试使用`sudo su root`获取root shell。

**投毒风险：**

查看了exploit.sh脚本。该脚本的主要功能是利用CVE-2023-22809漏洞，通过修改/etc/sudoers文件来提升权限。没有发现任何明显的恶意代码或后门。该脚本的目的是利用漏洞，而不是植入持久性的后门。该脚本需要用户交互，在sudoers文件中添加特定行，这降低了静默投毒的风险。
根据分析，此仓库中存在作者隐藏的投毒代码的可能性为0%。

**项目地址:** [asepsaepdin/CVE-2023-22809](https://github.com/asepsaepdin/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #8

**来源**: [CVE-2023-22809-hello4r1end_patch_CVE-2023-22809.md](../2023/CVE-2023-22809-hello4r1end_patch_CVE-2023-22809.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地攻击者提升权限至root

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 漏洞存在于 Sudo 1.9.12p2 之前的版本中，允许本地攻击者通过操纵 SUDO_EDITOR, VISUAL, 和 EDITOR 环境变量中的参数，利用 sudoedit 命令附加额外的文件进行编辑，从而导致权限提升。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的利用是有效的。多个安全厂商和社区都确认了该漏洞的存在和利用方式。

**投毒风险：**
提供的漏洞利用代码 (`CVE-2023-22809Patch.sh` 和 `README.md`) 实际上是一个用于**更新 Sudo 版本**的脚本，它从 GitHub 下载一个 Debian 包并安装它。这个脚本本身并没有包含任何恶意代码或后门，所以投毒风险评估为0%。它仅仅是尝试修复漏洞，而不是利用漏洞。

**利用方式：**
该漏洞的利用方式是通过设置环境变量 `SUDO_EDITOR`，`VISUAL` 或 `EDITOR`，在其中包含 `--` 参数以及要编辑的恶意文件路径，当用户使用 `sudoedit` 命令时，这些额外的参数会被传递给编辑器，从而允许编辑本来没有权限编辑的文件。例如：`EDITOR='vim -- /etc/shadow'; sudoedit 文件名`。攻击者可以利用此漏洞修改 `/etc/shadow` 文件或其它特权文件，从而获得 root 权限。

**项目地址:** [hello4r1end/patch_CVE-2023-22809](https://github.com/hello4r1end/patch_CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #9

**来源**: [CVE-2023-22809-laxmiyamkolu_SUDO-privilege-escalation.md](../2023/CVE-2023-22809-laxmiyamkolu_SUDO-privilege-escalation.md)

## CVE-2023-22809-Sudoedit特权提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 特权提升

**影响应用:** Sudo

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** 1.8.0 <= Sudo < 1.9.12p2

**利用条件:** 需要用户具有sudoedit权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809 漏洞允许本地攻击者通过 `sudoedit` 命令提升权限。`sudoedit` 功能在处理用户提供的环境变量（`SUDO_EDITOR`、`VISUAL` 和 `EDITOR`）时存在缺陷，允许攻击者向要处理的文件列表中追加任意条目。攻击者可以通过在编辑器环境变量中包含 `--` 参数来绕过保护机制，例如，设置 `EDITOR='vim -- /path/to/extra/file'`。

**漏洞利用方式：**

1.  **检查Sudo版本：** 确认Sudo版本在受影响范围内 (1.8.0 到 1.9.12p1)。
2.  **检查用户权限：** 确认用户拥有使用`sudoedit`编辑文件的权限。
3.  **设置EDITOR环境变量：** 设置`EDITOR`环境变量，使其包含恶意参数，例如`EDITOR='vim -- /etc/passwd'`。
4.  **使用sudoedit编辑文件：** 使用`sudoedit`编辑允许的文件，触发漏洞，从而能够编辑`/etc/passwd`或其他敏感文件。
5.  **修改/etc/passwd：** 修改`/etc/passwd`文件，将当前用户的UID修改为0，使其成为root用户。
6.  **切换用户：** 使用`su`命令切换到被提权的用户。

**有效性：**

提供的POC代码基本有效，它演示了利用漏洞提升权限的步骤。代码首先检查Sudo版本和用户权限，然后指导用户设置`EDITOR`环境变量，并使用`sudoedit`编辑文件。最后，它引导用户手动修改`/etc/passwd`文件并切换用户。该脚本是半自动化的，需要用户手动干预来修改`/etc/passwd`。

**投毒风险：**

该POC代码的投毒风险较低，约为10%。主要风险在于脚本尝试引导用户修改`/etc/passwd`文件。虽然这是漏洞利用的一部分，但如果用户不小心修改了其他重要配置，可能会导致系统不稳定或无法启动。此外，脚本的作者可能在`README.md`或其他文件中包含误导性信息，引导用户执行不安全的操作。但总体而言，代码本身没有明显的恶意行为。

更详细地分析，脚本中需要用户手动修改/etc/passwd这一步，用户可能会犯错，导致系统问题。理论上，攻击者可以将错误的修改方式写入脚本或文档中，让用户误操作，但现有代码并没有此类行为，因此风险较低。

**项目地址:** [laxmiyamkolu/SUDO-privilege-escalation](https://github.com/laxmiyamkolu/SUDO-privilege-escalation)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #10

**来源**: [CVE-2023-22809-n3m1sys_CVE-2023-22809-sudoedit-privesc.md](../2023/CVE-2023-22809-n3m1sys_CVE-2023-22809-sudoedit-privesc.md)

## CVE-2023-22809-sudo-权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许本地低权限用户获得root权限

**影响版本:** 1.8.0 to 1.9.12p1

**利用条件:** 用户需要能够通过sudoedit或sudo -e以root权限编辑文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809是sudo中的一个权限提升漏洞，存在于1.8.0到1.9.12p1版本。sudoedit (或 -e) 功能错误地处理了用户提供的环境变量（SUDO_EDITOR、VISUAL和EDITOR）中传递的额外参数，允许本地攻击者将任意条目附加到要处理的文件列表中。攻击者可以通过设置这些环境变量来包含恶意文件，从而导致权限提升。

**有效性：**
根据漏洞信息和POC代码，该漏洞利用是有效的。POC脚本首先检查sudo版本是否在受影响范围内，然后检查当前用户是否具有使用sudoedit或sudo -e以root权限编辑文件的权限。如果满足这两个条件，它将修改/etc/sudoers文件，为当前用户添加sudo权限，从而获得root shell。

**投毒风险：**
分析提供的POC代码（exploit.sh），没有发现明显的恶意代码或后门。脚本的主要功能是利用漏洞修改sudoers文件以提升权限，这是一个合法的漏洞利用方式，而非植入恶意代码。README.md文件仅是对漏洞和利用方式的描述。

**利用方式：**
1.  **检查sudo版本：** 脚本首先检查当前系统上安装的sudo版本是否在漏洞影响范围内。
2.  **检查sudoedit权限：** 脚本检查当前用户是否可以使用sudoedit或sudo -e以root权限编辑文件。
3.  **修改sudoers文件：** 如果满足上述条件，脚本会使用用户可控的环境变量EDITOR，通过sudoedit命令打开/etc/sudoers文件。由于sudoedit的漏洞，攻击者可以控制传递给EDITOR程序的参数，从而可以添加任意文件到编辑列表。
4.  **权限提升：**  攻击者在sudoers文件中添加一行，允许当前用户使用sudo执行任何命令，从而获得root权限。
5.  **获取root shell：** 最后，脚本使用`sudo su root`命令获得root shell。

**项目地址:** [n3m1sys/CVE-2023-22809-sudoedit-privesc](https://github.com/n3m1sys/CVE-2023-22809-sudoedit-privesc)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #11

**来源**: [CVE-2023-22809-pashayogi_CVE-2023-22809.md](../2023/CVE-2023-22809-pashayogi_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** 1.8.0 to 1.9.12p1

**利用条件:** 用户需要拥有使用 sudoedit 或 sudo -e 命令编辑文件的权限，且目标文件属于root用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 漏洞允许本地攻击者通过滥用 sudoedit（或 -e）功能中对用户提供的环境变量（SUDO_EDITOR、VISUAL 和 EDITOR）的处理方式，将任意条目附加到要处理的文件列表中，从而导致权限提升。

**有效性：**
POC 代码有效。该代码首先检查 sudo 版本是否在受影响范围内，然后检查当前用户是否可以使用 sudoedit 或 sudo -e 以 root 身份运行命令。如果满足条件，则它会通过设置 EDITOR 环境变量，利用 vim 的 `--` 参数绕过保护机制，打开 /etc/sudoers 文件进行编辑，引导用户添加一行配置以获取 root 权限，最终通过 `sudo su root` 获取 root shell。

**投毒风险：**
该 POC 代码中没有明显的投毒代码。脚本的功能很明确，即利用漏洞提升权限。它仅修改 `/etc/sudoers` 文件，而不会尝试植入任何隐藏的后门或其他恶意代码。

**利用方式：**
1.  **检查 sudo 版本：** 首先，检查目标系统上安装的 sudo 版本是否在受影响的范围内（1.8.0 到 1.9.12p1）。
2.  **检查 sudoedit 权限：** 检查当前用户是否具有使用 sudoedit 或 sudo -e 命令编辑文件的权限，并且该文件归 root 用户所有。
3.  **设置 EDITOR 环境变量：** 将 EDITOR 环境变量设置为包含 `--` 参数的恶意值，例如 `EDITOR="vim -- /etc/sudoers"`。
4.  **运行 sudoedit：** 运行 `sudoedit <受root拥有的文件>` 命令。由于环境变量的影响，这会导致使用 vim 打开 `/etc/sudoers` 文件。
5.  **编辑 /etc/sudoers：**  在打开的 `/etc/sudoers` 文件中，添加一行允许当前用户以 root 身份执行任何命令的配置，例如 `<用户名> ALL=(ALL:ALL) ALL`。
6.  **获取 root shell：** 使用 `sudo su root` 命令获取 root shell。

综上所述，提供的POC代码有效，不存在投毒风险，且能成功利用 CVE-2023-22809 漏洞提升权限。

**项目地址:** [pashayogi/CVE-2023-22809](https://github.com/pashayogi/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #12

**来源**: [CVE-2023-22809-spidoman_CVE-2023-22809-automated-python-exploits.md](../2023/CVE-2023-22809-spidoman_CVE-2023-22809-automated-python-exploits.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地低权限用户提升至root权限

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 需要目标系统上存在sudo且版本在受影响范围内，并且用户拥有sudoedit权限。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-22809是sudoedit中的一个权限提升漏洞。该漏洞源于sudoedit在处理用户提供的环境变量（SUDO_EDITOR、VISUAL和EDITOR）时，对额外的参数处理不当。攻击者可以通过在这些环境变量中注入恶意参数，例如`--`，来绕过保护机制，将任意文件添加到sudoedit要处理的文件列表中，从而以root权限编辑这些文件，最终导致权限提升。

**有效性:** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在且危害较高。提供的POC代码仓库的README.md声称可以自动利用该漏洞，但目前只有readme文件，无法判断代码有效性，但是根据描述，该漏洞利用方式比较简单，因此，实现自动利用的代码是可行的。

**投毒风险:** 提供的漏洞利用代码仓库只包含一个README.md文件，没有任何实际的利用代码，因此很难确定是否存在恶意代码。然而，考虑到这是一个可以提升权限的漏洞，攻击者可能会尝试通过包含后门或恶意指令来进一步控制系统。尽管当前没有明确的投毒证据，但考虑到其潜在的风险，投毒风险评估为20%。

**利用方式:**

1.  **利用sudoedit:**  利用sudoedit命令编辑文件。
2.  **设置环境变量:** 设置SUDO_EDITOR, VISUAL, 或者EDITOR环境变量，包含恶意参数。例如 `EDITOR='vim -- /path/to/arbitrary/file'`。
3.  **触发漏洞:**  执行`sudoedit <target_file>`，其中`<target_file>`可以是任意文件，攻击者通过环境变量注入，可以控制实际被编辑的文件，达到修改敏感文件，提升权限的目的。
4.  **权限提升:**  由于sudoedit以root权限运行，攻击者通过修改/etc/passwd或/etc/shadow等文件，或执行其他恶意操作，可以获得root权限。

**项目地址:** [spidoman/CVE-2023-22809-automated-python-exploits](https://github.com/spidoman/CVE-2023-22809-automated-python-exploits)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---



---

## POC #6

**来源**: [CVE-2023-22809-Toothless5143_CVE-2023-22809.md](../2023/CVE-2023-22809-Toothless5143_CVE-2023-22809.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，本地权限提升至root

**影响版本:** 1.8.0 to 1.9.12p1

**利用条件:** 用户需要具有sudoedit或者sudo -e的权限，且可以以root或者ALL用户运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 是一个 Sudo 的权限提升漏洞，存在于 1.8.0 到 1.9.12p1 版本中。该漏洞是由于 `sudoedit` (也称为 `-e` 功能) 在处理用户提供的环境变量（`SUDO_EDITOR`、`VISUAL` 和 `EDITOR`）中传递的额外参数时存在错误，允许本地攻击者将任意条目附加到要处理的文件列表中，从而导致权限提升。

**利用方式：**
1.  **检查Sudo版本：** 漏洞利用代码首先检查当前安装的 Sudo 版本是否在受影响的范围内 (1.8.0 to 1.9.12p1)。
2.  **检查用户权限：** 漏洞利用代码检查当前用户是否具有使用 `sudoedit` 或 `sudo -e` 命令以 root 身份或以 `ALL` 用户身份运行的权限。这通常意味着用户在 `sudoers` 文件中具有相应的条目。
3.  **利用环境变量注入参数：** 如果满足上述条件，攻击者可以通过设置 `SUDO_EDITOR`、`VISUAL` 或 `EDITOR` 环境变量来注入额外的参数。攻击者可以在这些环境变量中包含 `--` 参数，从而欺骗 `sudoedit` 命令，使其将任意文件添加到要编辑的文件列表中。
4.  **修改sudoers文件：**POC通过vim打开sudoers文件，提示用户添加一行提权配置到sudoers文件中，完成提权。
5.  **获得root权限：**成功修改 `sudoers` 文件后，攻击者可以使用 `sudo su root` 命令获得 root 权限。

**投毒风险评估：**
仔细审查了提供的 POC 代码，没有发现任何明显的恶意代码或后门。该脚本的主要功能是检查 Sudo 版本、用户权限，然后引导用户使用 `sudoedit` 修改 `/etc/sudoers` 文件来提升权限。没有发现任何未经授权的网络连接、文件修改或信息泄露行为。因此，认为该 POC 代码的投毒风险为 0%。

**项目地址:** [Toothless5143/CVE-2023-22809](https://github.com/Toothless5143/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #7

**来源**: [CVE-2023-22809-asepsaepdin_CVE-2023-22809.md](../2023/CVE-2023-22809-asepsaepdin_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升漏洞

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地用户提升至root权限

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 目标系统sudo版本在受影响范围内，当前用户需要具有使用sudoedit或sudo -e命令编辑文件的权限，且目标文件属于root或ALL用户/用户组。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 漏洞存在于 Sudo 1.8.0 到 1.9.12p1 版本中。sudoedit (也称为 -e) 功能错误地处理了用户提供的环境变量（SUDO_EDITOR、VISUAL 和 EDITOR）中传递的额外参数，允许本地攻击者将任意条目附加到要处理的文件列表中。这可能导致权限提升。问题在于用户指定的编辑器可能包含一个“--”参数，该参数会破坏保护机制，例如，EDITOR='vim -- /path/to/extra/file' 值。

**利用方式：**

1.  **检查sudo版本：** 检查目标系统上安装的sudo版本是否在受影响范围内（1.8.0 到 1.9.12p1）。
2.  **验证sudoedit权限：** 确认当前用户是否具有使用`sudoedit`或`sudo -e`命令编辑root权限文件的权限。可以通过`sudo -l`命令查看当前用户的sudo权限。
3.  **设置环境变量：** 设置环境变量`EDITOR`、`VISUAL`或`SUDO_EDITOR`，使其包含恶意参数。例如，`EDITOR='nano -- /etc/sudoers'`。
4.  **执行sudoedit：** 使用`sudoedit`或`sudo -e`命令编辑目标文件。由于环境变量中的恶意参数，实际上可以编辑`/etc/sudoers`文件。
5.  **修改sudoers文件：** 在`/etc/sudoers`文件中添加当前用户具有免密sudo权限的条目，例如`username ALL=(ALL:ALL) ALL`。
6.  **获取root权限：** 使用`sudo su root`或`sudo -i`命令获取root权限。

**有效性：**

提供的POC代码有效。它首先检查sudo版本，然后验证用户是否可以运行sudoedit命令。如果可以，它会指示用户将一行添加到sudoers文件中，以便授予用户root权限。最后，它尝试使用`sudo su root`获取root shell。

**投毒风险：**

查看了exploit.sh脚本。该脚本的主要功能是利用CVE-2023-22809漏洞，通过修改/etc/sudoers文件来提升权限。没有发现任何明显的恶意代码或后门。该脚本的目的是利用漏洞，而不是植入持久性的后门。该脚本需要用户交互，在sudoers文件中添加特定行，这降低了静默投毒的风险。
根据分析，此仓库中存在作者隐藏的投毒代码的可能性为0%。

**项目地址:** [asepsaepdin/CVE-2023-22809](https://github.com/asepsaepdin/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #8

**来源**: [CVE-2023-22809-hello4r1end_patch_CVE-2023-22809.md](../2023/CVE-2023-22809-hello4r1end_patch_CVE-2023-22809.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地攻击者提升权限至root

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 漏洞存在于 Sudo 1.9.12p2 之前的版本中，允许本地攻击者通过操纵 SUDO_EDITOR, VISUAL, 和 EDITOR 环境变量中的参数，利用 sudoedit 命令附加额外的文件进行编辑，从而导致权限提升。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的利用是有效的。多个安全厂商和社区都确认了该漏洞的存在和利用方式。

**投毒风险：**
提供的漏洞利用代码 (`CVE-2023-22809Patch.sh` 和 `README.md`) 实际上是一个用于**更新 Sudo 版本**的脚本，它从 GitHub 下载一个 Debian 包并安装它。这个脚本本身并没有包含任何恶意代码或后门，所以投毒风险评估为0%。它仅仅是尝试修复漏洞，而不是利用漏洞。

**利用方式：**
该漏洞的利用方式是通过设置环境变量 `SUDO_EDITOR`，`VISUAL` 或 `EDITOR`，在其中包含 `--` 参数以及要编辑的恶意文件路径，当用户使用 `sudoedit` 命令时，这些额外的参数会被传递给编辑器，从而允许编辑本来没有权限编辑的文件。例如：`EDITOR='vim -- /etc/shadow'; sudoedit 文件名`。攻击者可以利用此漏洞修改 `/etc/shadow` 文件或其它特权文件，从而获得 root 权限。

**项目地址:** [hello4r1end/patch_CVE-2023-22809](https://github.com/hello4r1end/patch_CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #9

**来源**: [CVE-2023-22809-laxmiyamkolu_SUDO-privilege-escalation.md](../2023/CVE-2023-22809-laxmiyamkolu_SUDO-privilege-escalation.md)

## CVE-2023-22809-Sudoedit特权提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 特权提升

**影响应用:** Sudo

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** 1.8.0 <= Sudo < 1.9.12p2

**利用条件:** 需要用户具有sudoedit权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809 漏洞允许本地攻击者通过 `sudoedit` 命令提升权限。`sudoedit` 功能在处理用户提供的环境变量（`SUDO_EDITOR`、`VISUAL` 和 `EDITOR`）时存在缺陷，允许攻击者向要处理的文件列表中追加任意条目。攻击者可以通过在编辑器环境变量中包含 `--` 参数来绕过保护机制，例如，设置 `EDITOR='vim -- /path/to/extra/file'`。

**漏洞利用方式：**

1.  **检查Sudo版本：** 确认Sudo版本在受影响范围内 (1.8.0 到 1.9.12p1)。
2.  **检查用户权限：** 确认用户拥有使用`sudoedit`编辑文件的权限。
3.  **设置EDITOR环境变量：** 设置`EDITOR`环境变量，使其包含恶意参数，例如`EDITOR='vim -- /etc/passwd'`。
4.  **使用sudoedit编辑文件：** 使用`sudoedit`编辑允许的文件，触发漏洞，从而能够编辑`/etc/passwd`或其他敏感文件。
5.  **修改/etc/passwd：** 修改`/etc/passwd`文件，将当前用户的UID修改为0，使其成为root用户。
6.  **切换用户：** 使用`su`命令切换到被提权的用户。

**有效性：**

提供的POC代码基本有效，它演示了利用漏洞提升权限的步骤。代码首先检查Sudo版本和用户权限，然后指导用户设置`EDITOR`环境变量，并使用`sudoedit`编辑文件。最后，它引导用户手动修改`/etc/passwd`文件并切换用户。该脚本是半自动化的，需要用户手动干预来修改`/etc/passwd`。

**投毒风险：**

该POC代码的投毒风险较低，约为10%。主要风险在于脚本尝试引导用户修改`/etc/passwd`文件。虽然这是漏洞利用的一部分，但如果用户不小心修改了其他重要配置，可能会导致系统不稳定或无法启动。此外，脚本的作者可能在`README.md`或其他文件中包含误导性信息，引导用户执行不安全的操作。但总体而言，代码本身没有明显的恶意行为。

更详细地分析，脚本中需要用户手动修改/etc/passwd这一步，用户可能会犯错，导致系统问题。理论上，攻击者可以将错误的修改方式写入脚本或文档中，让用户误操作，但现有代码并没有此类行为，因此风险较低。

**项目地址:** [laxmiyamkolu/SUDO-privilege-escalation](https://github.com/laxmiyamkolu/SUDO-privilege-escalation)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #10

**来源**: [CVE-2023-22809-n3m1sys_CVE-2023-22809-sudoedit-privesc.md](../2023/CVE-2023-22809-n3m1sys_CVE-2023-22809-sudoedit-privesc.md)

## CVE-2023-22809-sudo-权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许本地低权限用户获得root权限

**影响版本:** 1.8.0 to 1.9.12p1

**利用条件:** 用户需要能够通过sudoedit或sudo -e以root权限编辑文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809是sudo中的一个权限提升漏洞，存在于1.8.0到1.9.12p1版本。sudoedit (或 -e) 功能错误地处理了用户提供的环境变量（SUDO_EDITOR、VISUAL和EDITOR）中传递的额外参数，允许本地攻击者将任意条目附加到要处理的文件列表中。攻击者可以通过设置这些环境变量来包含恶意文件，从而导致权限提升。

**有效性：**
根据漏洞信息和POC代码，该漏洞利用是有效的。POC脚本首先检查sudo版本是否在受影响范围内，然后检查当前用户是否具有使用sudoedit或sudo -e以root权限编辑文件的权限。如果满足这两个条件，它将修改/etc/sudoers文件，为当前用户添加sudo权限，从而获得root shell。

**投毒风险：**
分析提供的POC代码（exploit.sh），没有发现明显的恶意代码或后门。脚本的主要功能是利用漏洞修改sudoers文件以提升权限，这是一个合法的漏洞利用方式，而非植入恶意代码。README.md文件仅是对漏洞和利用方式的描述。

**利用方式：**
1.  **检查sudo版本：** 脚本首先检查当前系统上安装的sudo版本是否在漏洞影响范围内。
2.  **检查sudoedit权限：** 脚本检查当前用户是否可以使用sudoedit或sudo -e以root权限编辑文件。
3.  **修改sudoers文件：** 如果满足上述条件，脚本会使用用户可控的环境变量EDITOR，通过sudoedit命令打开/etc/sudoers文件。由于sudoedit的漏洞，攻击者可以控制传递给EDITOR程序的参数，从而可以添加任意文件到编辑列表。
4.  **权限提升：**  攻击者在sudoers文件中添加一行，允许当前用户使用sudo执行任何命令，从而获得root权限。
5.  **获取root shell：** 最后，脚本使用`sudo su root`命令获得root shell。

**项目地址:** [n3m1sys/CVE-2023-22809-sudoedit-privesc](https://github.com/n3m1sys/CVE-2023-22809-sudoedit-privesc)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #11

**来源**: [CVE-2023-22809-pashayogi_CVE-2023-22809.md](../2023/CVE-2023-22809-pashayogi_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** 1.8.0 to 1.9.12p1

**利用条件:** 用户需要拥有使用 sudoedit 或 sudo -e 命令编辑文件的权限，且目标文件属于root用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 漏洞允许本地攻击者通过滥用 sudoedit（或 -e）功能中对用户提供的环境变量（SUDO_EDITOR、VISUAL 和 EDITOR）的处理方式，将任意条目附加到要处理的文件列表中，从而导致权限提升。

**有效性：**
POC 代码有效。该代码首先检查 sudo 版本是否在受影响范围内，然后检查当前用户是否可以使用 sudoedit 或 sudo -e 以 root 身份运行命令。如果满足条件，则它会通过设置 EDITOR 环境变量，利用 vim 的 `--` 参数绕过保护机制，打开 /etc/sudoers 文件进行编辑，引导用户添加一行配置以获取 root 权限，最终通过 `sudo su root` 获取 root shell。

**投毒风险：**
该 POC 代码中没有明显的投毒代码。脚本的功能很明确，即利用漏洞提升权限。它仅修改 `/etc/sudoers` 文件，而不会尝试植入任何隐藏的后门或其他恶意代码。

**利用方式：**
1.  **检查 sudo 版本：** 首先，检查目标系统上安装的 sudo 版本是否在受影响的范围内（1.8.0 到 1.9.12p1）。
2.  **检查 sudoedit 权限：** 检查当前用户是否具有使用 sudoedit 或 sudo -e 命令编辑文件的权限，并且该文件归 root 用户所有。
3.  **设置 EDITOR 环境变量：** 将 EDITOR 环境变量设置为包含 `--` 参数的恶意值，例如 `EDITOR="vim -- /etc/sudoers"`。
4.  **运行 sudoedit：** 运行 `sudoedit <受root拥有的文件>` 命令。由于环境变量的影响，这会导致使用 vim 打开 `/etc/sudoers` 文件。
5.  **编辑 /etc/sudoers：**  在打开的 `/etc/sudoers` 文件中，添加一行允许当前用户以 root 身份执行任何命令的配置，例如 `<用户名> ALL=(ALL:ALL) ALL`。
6.  **获取 root shell：** 使用 `sudo su root` 命令获取 root shell。

综上所述，提供的POC代码有效，不存在投毒风险，且能成功利用 CVE-2023-22809 漏洞提升权限。

**项目地址:** [pashayogi/CVE-2023-22809](https://github.com/pashayogi/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #12

**来源**: [CVE-2023-22809-spidoman_CVE-2023-22809-automated-python-exploits.md](../2023/CVE-2023-22809-spidoman_CVE-2023-22809-automated-python-exploits.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地低权限用户提升至root权限

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 需要目标系统上存在sudo且版本在受影响范围内，并且用户拥有sudoedit权限。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-22809是sudoedit中的一个权限提升漏洞。该漏洞源于sudoedit在处理用户提供的环境变量（SUDO_EDITOR、VISUAL和EDITOR）时，对额外的参数处理不当。攻击者可以通过在这些环境变量中注入恶意参数，例如`--`，来绕过保护机制，将任意文件添加到sudoedit要处理的文件列表中，从而以root权限编辑这些文件，最终导致权限提升。

**有效性:** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在且危害较高。提供的POC代码仓库的README.md声称可以自动利用该漏洞，但目前只有readme文件，无法判断代码有效性，但是根据描述，该漏洞利用方式比较简单，因此，实现自动利用的代码是可行的。

**投毒风险:** 提供的漏洞利用代码仓库只包含一个README.md文件，没有任何实际的利用代码，因此很难确定是否存在恶意代码。然而，考虑到这是一个可以提升权限的漏洞，攻击者可能会尝试通过包含后门或恶意指令来进一步控制系统。尽管当前没有明确的投毒证据，但考虑到其潜在的风险，投毒风险评估为20%。

**利用方式:**

1.  **利用sudoedit:**  利用sudoedit命令编辑文件。
2.  **设置环境变量:** 设置SUDO_EDITOR, VISUAL, 或者EDITOR环境变量，包含恶意参数。例如 `EDITOR='vim -- /path/to/arbitrary/file'`。
3.  **触发漏洞:**  执行`sudoedit <target_file>`，其中`<target_file>`可以是任意文件，攻击者通过环境变量注入，可以控制实际被编辑的文件，达到修改敏感文件，提升权限的目的。
4.  **权限提升:**  由于sudoedit以root权限运行，攻击者通过修改/etc/passwd或/etc/shadow等文件，或执行其他恶意操作，可以获得root权限。

**项目地址:** [spidoman/CVE-2023-22809-automated-python-exploits](https://github.com/spidoman/CVE-2023-22809-automated-python-exploits)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---



---

## POC #6

**来源**: [CVE-2023-22809-Toothless5143_CVE-2023-22809.md](../2023/CVE-2023-22809-Toothless5143_CVE-2023-22809.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，本地权限提升至root

**影响版本:** 1.8.0 to 1.9.12p1

**利用条件:** 用户需要具有sudoedit或者sudo -e的权限，且可以以root或者ALL用户运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 是一个 Sudo 的权限提升漏洞，存在于 1.8.0 到 1.9.12p1 版本中。该漏洞是由于 `sudoedit` (也称为 `-e` 功能) 在处理用户提供的环境变量（`SUDO_EDITOR`、`VISUAL` 和 `EDITOR`）中传递的额外参数时存在错误，允许本地攻击者将任意条目附加到要处理的文件列表中，从而导致权限提升。

**利用方式：**
1.  **检查Sudo版本：** 漏洞利用代码首先检查当前安装的 Sudo 版本是否在受影响的范围内 (1.8.0 to 1.9.12p1)。
2.  **检查用户权限：** 漏洞利用代码检查当前用户是否具有使用 `sudoedit` 或 `sudo -e` 命令以 root 身份或以 `ALL` 用户身份运行的权限。这通常意味着用户在 `sudoers` 文件中具有相应的条目。
3.  **利用环境变量注入参数：** 如果满足上述条件，攻击者可以通过设置 `SUDO_EDITOR`、`VISUAL` 或 `EDITOR` 环境变量来注入额外的参数。攻击者可以在这些环境变量中包含 `--` 参数，从而欺骗 `sudoedit` 命令，使其将任意文件添加到要编辑的文件列表中。
4.  **修改sudoers文件：**POC通过vim打开sudoers文件，提示用户添加一行提权配置到sudoers文件中，完成提权。
5.  **获得root权限：**成功修改 `sudoers` 文件后，攻击者可以使用 `sudo su root` 命令获得 root 权限。

**投毒风险评估：**
仔细审查了提供的 POC 代码，没有发现任何明显的恶意代码或后门。该脚本的主要功能是检查 Sudo 版本、用户权限，然后引导用户使用 `sudoedit` 修改 `/etc/sudoers` 文件来提升权限。没有发现任何未经授权的网络连接、文件修改或信息泄露行为。因此，认为该 POC 代码的投毒风险为 0%。

**项目地址:** [Toothless5143/CVE-2023-22809](https://github.com/Toothless5143/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #7

**来源**: [CVE-2023-22809-asepsaepdin_CVE-2023-22809.md](../2023/CVE-2023-22809-asepsaepdin_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升漏洞

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地用户提升至root权限

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 目标系统sudo版本在受影响范围内，当前用户需要具有使用sudoedit或sudo -e命令编辑文件的权限，且目标文件属于root或ALL用户/用户组。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 漏洞存在于 Sudo 1.8.0 到 1.9.12p1 版本中。sudoedit (也称为 -e) 功能错误地处理了用户提供的环境变量（SUDO_EDITOR、VISUAL 和 EDITOR）中传递的额外参数，允许本地攻击者将任意条目附加到要处理的文件列表中。这可能导致权限提升。问题在于用户指定的编辑器可能包含一个“--”参数，该参数会破坏保护机制，例如，EDITOR='vim -- /path/to/extra/file' 值。

**利用方式：**

1.  **检查sudo版本：** 检查目标系统上安装的sudo版本是否在受影响范围内（1.8.0 到 1.9.12p1）。
2.  **验证sudoedit权限：** 确认当前用户是否具有使用`sudoedit`或`sudo -e`命令编辑root权限文件的权限。可以通过`sudo -l`命令查看当前用户的sudo权限。
3.  **设置环境变量：** 设置环境变量`EDITOR`、`VISUAL`或`SUDO_EDITOR`，使其包含恶意参数。例如，`EDITOR='nano -- /etc/sudoers'`。
4.  **执行sudoedit：** 使用`sudoedit`或`sudo -e`命令编辑目标文件。由于环境变量中的恶意参数，实际上可以编辑`/etc/sudoers`文件。
5.  **修改sudoers文件：** 在`/etc/sudoers`文件中添加当前用户具有免密sudo权限的条目，例如`username ALL=(ALL:ALL) ALL`。
6.  **获取root权限：** 使用`sudo su root`或`sudo -i`命令获取root权限。

**有效性：**

提供的POC代码有效。它首先检查sudo版本，然后验证用户是否可以运行sudoedit命令。如果可以，它会指示用户将一行添加到sudoers文件中，以便授予用户root权限。最后，它尝试使用`sudo su root`获取root shell。

**投毒风险：**

查看了exploit.sh脚本。该脚本的主要功能是利用CVE-2023-22809漏洞，通过修改/etc/sudoers文件来提升权限。没有发现任何明显的恶意代码或后门。该脚本的目的是利用漏洞，而不是植入持久性的后门。该脚本需要用户交互，在sudoers文件中添加特定行，这降低了静默投毒的风险。
根据分析，此仓库中存在作者隐藏的投毒代码的可能性为0%。

**项目地址:** [asepsaepdin/CVE-2023-22809](https://github.com/asepsaepdin/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #8

**来源**: [CVE-2023-22809-hello4r1end_patch_CVE-2023-22809.md](../2023/CVE-2023-22809-hello4r1end_patch_CVE-2023-22809.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地攻击者提升权限至root

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 漏洞存在于 Sudo 1.9.12p2 之前的版本中，允许本地攻击者通过操纵 SUDO_EDITOR, VISUAL, 和 EDITOR 环境变量中的参数，利用 sudoedit 命令附加额外的文件进行编辑，从而导致权限提升。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的利用是有效的。多个安全厂商和社区都确认了该漏洞的存在和利用方式。

**投毒风险：**
提供的漏洞利用代码 (`CVE-2023-22809Patch.sh` 和 `README.md`) 实际上是一个用于**更新 Sudo 版本**的脚本，它从 GitHub 下载一个 Debian 包并安装它。这个脚本本身并没有包含任何恶意代码或后门，所以投毒风险评估为0%。它仅仅是尝试修复漏洞，而不是利用漏洞。

**利用方式：**
该漏洞的利用方式是通过设置环境变量 `SUDO_EDITOR`，`VISUAL` 或 `EDITOR`，在其中包含 `--` 参数以及要编辑的恶意文件路径，当用户使用 `sudoedit` 命令时，这些额外的参数会被传递给编辑器，从而允许编辑本来没有权限编辑的文件。例如：`EDITOR='vim -- /etc/shadow'; sudoedit 文件名`。攻击者可以利用此漏洞修改 `/etc/shadow` 文件或其它特权文件，从而获得 root 权限。

**项目地址:** [hello4r1end/patch_CVE-2023-22809](https://github.com/hello4r1end/patch_CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #9

**来源**: [CVE-2023-22809-laxmiyamkolu_SUDO-privilege-escalation.md](../2023/CVE-2023-22809-laxmiyamkolu_SUDO-privilege-escalation.md)

## CVE-2023-22809-Sudoedit特权提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 特权提升

**影响应用:** Sudo

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** 1.8.0 <= Sudo < 1.9.12p2

**利用条件:** 需要用户具有sudoedit权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809 漏洞允许本地攻击者通过 `sudoedit` 命令提升权限。`sudoedit` 功能在处理用户提供的环境变量（`SUDO_EDITOR`、`VISUAL` 和 `EDITOR`）时存在缺陷，允许攻击者向要处理的文件列表中追加任意条目。攻击者可以通过在编辑器环境变量中包含 `--` 参数来绕过保护机制，例如，设置 `EDITOR='vim -- /path/to/extra/file'`。

**漏洞利用方式：**

1.  **检查Sudo版本：** 确认Sudo版本在受影响范围内 (1.8.0 到 1.9.12p1)。
2.  **检查用户权限：** 确认用户拥有使用`sudoedit`编辑文件的权限。
3.  **设置EDITOR环境变量：** 设置`EDITOR`环境变量，使其包含恶意参数，例如`EDITOR='vim -- /etc/passwd'`。
4.  **使用sudoedit编辑文件：** 使用`sudoedit`编辑允许的文件，触发漏洞，从而能够编辑`/etc/passwd`或其他敏感文件。
5.  **修改/etc/passwd：** 修改`/etc/passwd`文件，将当前用户的UID修改为0，使其成为root用户。
6.  **切换用户：** 使用`su`命令切换到被提权的用户。

**有效性：**

提供的POC代码基本有效，它演示了利用漏洞提升权限的步骤。代码首先检查Sudo版本和用户权限，然后指导用户设置`EDITOR`环境变量，并使用`sudoedit`编辑文件。最后，它引导用户手动修改`/etc/passwd`文件并切换用户。该脚本是半自动化的，需要用户手动干预来修改`/etc/passwd`。

**投毒风险：**

该POC代码的投毒风险较低，约为10%。主要风险在于脚本尝试引导用户修改`/etc/passwd`文件。虽然这是漏洞利用的一部分，但如果用户不小心修改了其他重要配置，可能会导致系统不稳定或无法启动。此外，脚本的作者可能在`README.md`或其他文件中包含误导性信息，引导用户执行不安全的操作。但总体而言，代码本身没有明显的恶意行为。

更详细地分析，脚本中需要用户手动修改/etc/passwd这一步，用户可能会犯错，导致系统问题。理论上，攻击者可以将错误的修改方式写入脚本或文档中，让用户误操作，但现有代码并没有此类行为，因此风险较低。

**项目地址:** [laxmiyamkolu/SUDO-privilege-escalation](https://github.com/laxmiyamkolu/SUDO-privilege-escalation)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #10

**来源**: [CVE-2023-22809-n3m1sys_CVE-2023-22809-sudoedit-privesc.md](../2023/CVE-2023-22809-n3m1sys_CVE-2023-22809-sudoedit-privesc.md)

## CVE-2023-22809-sudo-权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许本地低权限用户获得root权限

**影响版本:** 1.8.0 to 1.9.12p1

**利用条件:** 用户需要能够通过sudoedit或sudo -e以root权限编辑文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809是sudo中的一个权限提升漏洞，存在于1.8.0到1.9.12p1版本。sudoedit (或 -e) 功能错误地处理了用户提供的环境变量（SUDO_EDITOR、VISUAL和EDITOR）中传递的额外参数，允许本地攻击者将任意条目附加到要处理的文件列表中。攻击者可以通过设置这些环境变量来包含恶意文件，从而导致权限提升。

**有效性：**
根据漏洞信息和POC代码，该漏洞利用是有效的。POC脚本首先检查sudo版本是否在受影响范围内，然后检查当前用户是否具有使用sudoedit或sudo -e以root权限编辑文件的权限。如果满足这两个条件，它将修改/etc/sudoers文件，为当前用户添加sudo权限，从而获得root shell。

**投毒风险：**
分析提供的POC代码（exploit.sh），没有发现明显的恶意代码或后门。脚本的主要功能是利用漏洞修改sudoers文件以提升权限，这是一个合法的漏洞利用方式，而非植入恶意代码。README.md文件仅是对漏洞和利用方式的描述。

**利用方式：**
1.  **检查sudo版本：** 脚本首先检查当前系统上安装的sudo版本是否在漏洞影响范围内。
2.  **检查sudoedit权限：** 脚本检查当前用户是否可以使用sudoedit或sudo -e以root权限编辑文件。
3.  **修改sudoers文件：** 如果满足上述条件，脚本会使用用户可控的环境变量EDITOR，通过sudoedit命令打开/etc/sudoers文件。由于sudoedit的漏洞，攻击者可以控制传递给EDITOR程序的参数，从而可以添加任意文件到编辑列表。
4.  **权限提升：**  攻击者在sudoers文件中添加一行，允许当前用户使用sudo执行任何命令，从而获得root权限。
5.  **获取root shell：** 最后，脚本使用`sudo su root`命令获得root shell。

**项目地址:** [n3m1sys/CVE-2023-22809-sudoedit-privesc](https://github.com/n3m1sys/CVE-2023-22809-sudoedit-privesc)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #11

**来源**: [CVE-2023-22809-pashayogi_CVE-2023-22809.md](../2023/CVE-2023-22809-pashayogi_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** 1.8.0 to 1.9.12p1

**利用条件:** 用户需要拥有使用 sudoedit 或 sudo -e 命令编辑文件的权限，且目标文件属于root用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 漏洞允许本地攻击者通过滥用 sudoedit（或 -e）功能中对用户提供的环境变量（SUDO_EDITOR、VISUAL 和 EDITOR）的处理方式，将任意条目附加到要处理的文件列表中，从而导致权限提升。

**有效性：**
POC 代码有效。该代码首先检查 sudo 版本是否在受影响范围内，然后检查当前用户是否可以使用 sudoedit 或 sudo -e 以 root 身份运行命令。如果满足条件，则它会通过设置 EDITOR 环境变量，利用 vim 的 `--` 参数绕过保护机制，打开 /etc/sudoers 文件进行编辑，引导用户添加一行配置以获取 root 权限，最终通过 `sudo su root` 获取 root shell。

**投毒风险：**
该 POC 代码中没有明显的投毒代码。脚本的功能很明确，即利用漏洞提升权限。它仅修改 `/etc/sudoers` 文件，而不会尝试植入任何隐藏的后门或其他恶意代码。

**利用方式：**
1.  **检查 sudo 版本：** 首先，检查目标系统上安装的 sudo 版本是否在受影响的范围内（1.8.0 到 1.9.12p1）。
2.  **检查 sudoedit 权限：** 检查当前用户是否具有使用 sudoedit 或 sudo -e 命令编辑文件的权限，并且该文件归 root 用户所有。
3.  **设置 EDITOR 环境变量：** 将 EDITOR 环境变量设置为包含 `--` 参数的恶意值，例如 `EDITOR="vim -- /etc/sudoers"`。
4.  **运行 sudoedit：** 运行 `sudoedit <受root拥有的文件>` 命令。由于环境变量的影响，这会导致使用 vim 打开 `/etc/sudoers` 文件。
5.  **编辑 /etc/sudoers：**  在打开的 `/etc/sudoers` 文件中，添加一行允许当前用户以 root 身份执行任何命令的配置，例如 `<用户名> ALL=(ALL:ALL) ALL`。
6.  **获取 root shell：** 使用 `sudo su root` 命令获取 root shell。

综上所述，提供的POC代码有效，不存在投毒风险，且能成功利用 CVE-2023-22809 漏洞提升权限。

**项目地址:** [pashayogi/CVE-2023-22809](https://github.com/pashayogi/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #12

**来源**: [CVE-2023-22809-spidoman_CVE-2023-22809-automated-python-exploits.md](../2023/CVE-2023-22809-spidoman_CVE-2023-22809-automated-python-exploits.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地低权限用户提升至root权限

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 需要目标系统上存在sudo且版本在受影响范围内，并且用户拥有sudoedit权限。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-22809是sudoedit中的一个权限提升漏洞。该漏洞源于sudoedit在处理用户提供的环境变量（SUDO_EDITOR、VISUAL和EDITOR）时，对额外的参数处理不当。攻击者可以通过在这些环境变量中注入恶意参数，例如`--`，来绕过保护机制，将任意文件添加到sudoedit要处理的文件列表中，从而以root权限编辑这些文件，最终导致权限提升。

**有效性:** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在且危害较高。提供的POC代码仓库的README.md声称可以自动利用该漏洞，但目前只有readme文件，无法判断代码有效性，但是根据描述，该漏洞利用方式比较简单，因此，实现自动利用的代码是可行的。

**投毒风险:** 提供的漏洞利用代码仓库只包含一个README.md文件，没有任何实际的利用代码，因此很难确定是否存在恶意代码。然而，考虑到这是一个可以提升权限的漏洞，攻击者可能会尝试通过包含后门或恶意指令来进一步控制系统。尽管当前没有明确的投毒证据，但考虑到其潜在的风险，投毒风险评估为20%。

**利用方式:**

1.  **利用sudoedit:**  利用sudoedit命令编辑文件。
2.  **设置环境变量:** 设置SUDO_EDITOR, VISUAL, 或者EDITOR环境变量，包含恶意参数。例如 `EDITOR='vim -- /path/to/arbitrary/file'`。
3.  **触发漏洞:**  执行`sudoedit <target_file>`，其中`<target_file>`可以是任意文件，攻击者通过环境变量注入，可以控制实际被编辑的文件，达到修改敏感文件，提升权限的目的。
4.  **权限提升:**  由于sudoedit以root权限运行，攻击者通过修改/etc/passwd或/etc/shadow等文件，或执行其他恶意操作，可以获得root权限。

**项目地址:** [spidoman/CVE-2023-22809-automated-python-exploits](https://github.com/spidoman/CVE-2023-22809-automated-python-exploits)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---



---

## POC #6

**来源**: [CVE-2023-22809-Toothless5143_CVE-2023-22809.md](../2023/CVE-2023-22809-Toothless5143_CVE-2023-22809.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，本地权限提升至root

**影响版本:** 1.8.0 to 1.9.12p1

**利用条件:** 用户需要具有sudoedit或者sudo -e的权限，且可以以root或者ALL用户运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 是一个 Sudo 的权限提升漏洞，存在于 1.8.0 到 1.9.12p1 版本中。该漏洞是由于 `sudoedit` (也称为 `-e` 功能) 在处理用户提供的环境变量（`SUDO_EDITOR`、`VISUAL` 和 `EDITOR`）中传递的额外参数时存在错误，允许本地攻击者将任意条目附加到要处理的文件列表中，从而导致权限提升。

**利用方式：**
1.  **检查Sudo版本：** 漏洞利用代码首先检查当前安装的 Sudo 版本是否在受影响的范围内 (1.8.0 to 1.9.12p1)。
2.  **检查用户权限：** 漏洞利用代码检查当前用户是否具有使用 `sudoedit` 或 `sudo -e` 命令以 root 身份或以 `ALL` 用户身份运行的权限。这通常意味着用户在 `sudoers` 文件中具有相应的条目。
3.  **利用环境变量注入参数：** 如果满足上述条件，攻击者可以通过设置 `SUDO_EDITOR`、`VISUAL` 或 `EDITOR` 环境变量来注入额外的参数。攻击者可以在这些环境变量中包含 `--` 参数，从而欺骗 `sudoedit` 命令，使其将任意文件添加到要编辑的文件列表中。
4.  **修改sudoers文件：**POC通过vim打开sudoers文件，提示用户添加一行提权配置到sudoers文件中，完成提权。
5.  **获得root权限：**成功修改 `sudoers` 文件后，攻击者可以使用 `sudo su root` 命令获得 root 权限。

**投毒风险评估：**
仔细审查了提供的 POC 代码，没有发现任何明显的恶意代码或后门。该脚本的主要功能是检查 Sudo 版本、用户权限，然后引导用户使用 `sudoedit` 修改 `/etc/sudoers` 文件来提升权限。没有发现任何未经授权的网络连接、文件修改或信息泄露行为。因此，认为该 POC 代码的投毒风险为 0%。

**项目地址:** [Toothless5143/CVE-2023-22809](https://github.com/Toothless5143/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #7

**来源**: [CVE-2023-22809-asepsaepdin_CVE-2023-22809.md](../2023/CVE-2023-22809-asepsaepdin_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升漏洞

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地用户提升至root权限

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 目标系统sudo版本在受影响范围内，当前用户需要具有使用sudoedit或sudo -e命令编辑文件的权限，且目标文件属于root或ALL用户/用户组。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 漏洞存在于 Sudo 1.8.0 到 1.9.12p1 版本中。sudoedit (也称为 -e) 功能错误地处理了用户提供的环境变量（SUDO_EDITOR、VISUAL 和 EDITOR）中传递的额外参数，允许本地攻击者将任意条目附加到要处理的文件列表中。这可能导致权限提升。问题在于用户指定的编辑器可能包含一个“--”参数，该参数会破坏保护机制，例如，EDITOR='vim -- /path/to/extra/file' 值。

**利用方式：**

1.  **检查sudo版本：** 检查目标系统上安装的sudo版本是否在受影响范围内（1.8.0 到 1.9.12p1）。
2.  **验证sudoedit权限：** 确认当前用户是否具有使用`sudoedit`或`sudo -e`命令编辑root权限文件的权限。可以通过`sudo -l`命令查看当前用户的sudo权限。
3.  **设置环境变量：** 设置环境变量`EDITOR`、`VISUAL`或`SUDO_EDITOR`，使其包含恶意参数。例如，`EDITOR='nano -- /etc/sudoers'`。
4.  **执行sudoedit：** 使用`sudoedit`或`sudo -e`命令编辑目标文件。由于环境变量中的恶意参数，实际上可以编辑`/etc/sudoers`文件。
5.  **修改sudoers文件：** 在`/etc/sudoers`文件中添加当前用户具有免密sudo权限的条目，例如`username ALL=(ALL:ALL) ALL`。
6.  **获取root权限：** 使用`sudo su root`或`sudo -i`命令获取root权限。

**有效性：**

提供的POC代码有效。它首先检查sudo版本，然后验证用户是否可以运行sudoedit命令。如果可以，它会指示用户将一行添加到sudoers文件中，以便授予用户root权限。最后，它尝试使用`sudo su root`获取root shell。

**投毒风险：**

查看了exploit.sh脚本。该脚本的主要功能是利用CVE-2023-22809漏洞，通过修改/etc/sudoers文件来提升权限。没有发现任何明显的恶意代码或后门。该脚本的目的是利用漏洞，而不是植入持久性的后门。该脚本需要用户交互，在sudoers文件中添加特定行，这降低了静默投毒的风险。
根据分析，此仓库中存在作者隐藏的投毒代码的可能性为0%。

**项目地址:** [asepsaepdin/CVE-2023-22809](https://github.com/asepsaepdin/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #8

**来源**: [CVE-2023-22809-hello4r1end_patch_CVE-2023-22809.md](../2023/CVE-2023-22809-hello4r1end_patch_CVE-2023-22809.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地攻击者提升权限至root

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 漏洞存在于 Sudo 1.9.12p2 之前的版本中，允许本地攻击者通过操纵 SUDO_EDITOR, VISUAL, 和 EDITOR 环境变量中的参数，利用 sudoedit 命令附加额外的文件进行编辑，从而导致权限提升。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的利用是有效的。多个安全厂商和社区都确认了该漏洞的存在和利用方式。

**投毒风险：**
提供的漏洞利用代码 (`CVE-2023-22809Patch.sh` 和 `README.md`) 实际上是一个用于**更新 Sudo 版本**的脚本，它从 GitHub 下载一个 Debian 包并安装它。这个脚本本身并没有包含任何恶意代码或后门，所以投毒风险评估为0%。它仅仅是尝试修复漏洞，而不是利用漏洞。

**利用方式：**
该漏洞的利用方式是通过设置环境变量 `SUDO_EDITOR`，`VISUAL` 或 `EDITOR`，在其中包含 `--` 参数以及要编辑的恶意文件路径，当用户使用 `sudoedit` 命令时，这些额外的参数会被传递给编辑器，从而允许编辑本来没有权限编辑的文件。例如：`EDITOR='vim -- /etc/shadow'; sudoedit 文件名`。攻击者可以利用此漏洞修改 `/etc/shadow` 文件或其它特权文件，从而获得 root 权限。

**项目地址:** [hello4r1end/patch_CVE-2023-22809](https://github.com/hello4r1end/patch_CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #9

**来源**: [CVE-2023-22809-laxmiyamkolu_SUDO-privilege-escalation.md](../2023/CVE-2023-22809-laxmiyamkolu_SUDO-privilege-escalation.md)

## CVE-2023-22809-Sudoedit特权提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 特权提升

**影响应用:** Sudo

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** 1.8.0 <= Sudo < 1.9.12p2

**利用条件:** 需要用户具有sudoedit权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809 漏洞允许本地攻击者通过 `sudoedit` 命令提升权限。`sudoedit` 功能在处理用户提供的环境变量（`SUDO_EDITOR`、`VISUAL` 和 `EDITOR`）时存在缺陷，允许攻击者向要处理的文件列表中追加任意条目。攻击者可以通过在编辑器环境变量中包含 `--` 参数来绕过保护机制，例如，设置 `EDITOR='vim -- /path/to/extra/file'`。

**漏洞利用方式：**

1.  **检查Sudo版本：** 确认Sudo版本在受影响范围内 (1.8.0 到 1.9.12p1)。
2.  **检查用户权限：** 确认用户拥有使用`sudoedit`编辑文件的权限。
3.  **设置EDITOR环境变量：** 设置`EDITOR`环境变量，使其包含恶意参数，例如`EDITOR='vim -- /etc/passwd'`。
4.  **使用sudoedit编辑文件：** 使用`sudoedit`编辑允许的文件，触发漏洞，从而能够编辑`/etc/passwd`或其他敏感文件。
5.  **修改/etc/passwd：** 修改`/etc/passwd`文件，将当前用户的UID修改为0，使其成为root用户。
6.  **切换用户：** 使用`su`命令切换到被提权的用户。

**有效性：**

提供的POC代码基本有效，它演示了利用漏洞提升权限的步骤。代码首先检查Sudo版本和用户权限，然后指导用户设置`EDITOR`环境变量，并使用`sudoedit`编辑文件。最后，它引导用户手动修改`/etc/passwd`文件并切换用户。该脚本是半自动化的，需要用户手动干预来修改`/etc/passwd`。

**投毒风险：**

该POC代码的投毒风险较低，约为10%。主要风险在于脚本尝试引导用户修改`/etc/passwd`文件。虽然这是漏洞利用的一部分，但如果用户不小心修改了其他重要配置，可能会导致系统不稳定或无法启动。此外，脚本的作者可能在`README.md`或其他文件中包含误导性信息，引导用户执行不安全的操作。但总体而言，代码本身没有明显的恶意行为。

更详细地分析，脚本中需要用户手动修改/etc/passwd这一步，用户可能会犯错，导致系统问题。理论上，攻击者可以将错误的修改方式写入脚本或文档中，让用户误操作，但现有代码并没有此类行为，因此风险较低。

**项目地址:** [laxmiyamkolu/SUDO-privilege-escalation](https://github.com/laxmiyamkolu/SUDO-privilege-escalation)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #10

**来源**: [CVE-2023-22809-n3m1sys_CVE-2023-22809-sudoedit-privesc.md](../2023/CVE-2023-22809-n3m1sys_CVE-2023-22809-sudoedit-privesc.md)

## CVE-2023-22809-sudo-权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许本地低权限用户获得root权限

**影响版本:** 1.8.0 to 1.9.12p1

**利用条件:** 用户需要能够通过sudoedit或sudo -e以root权限编辑文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809是sudo中的一个权限提升漏洞，存在于1.8.0到1.9.12p1版本。sudoedit (或 -e) 功能错误地处理了用户提供的环境变量（SUDO_EDITOR、VISUAL和EDITOR）中传递的额外参数，允许本地攻击者将任意条目附加到要处理的文件列表中。攻击者可以通过设置这些环境变量来包含恶意文件，从而导致权限提升。

**有效性：**
根据漏洞信息和POC代码，该漏洞利用是有效的。POC脚本首先检查sudo版本是否在受影响范围内，然后检查当前用户是否具有使用sudoedit或sudo -e以root权限编辑文件的权限。如果满足这两个条件，它将修改/etc/sudoers文件，为当前用户添加sudo权限，从而获得root shell。

**投毒风险：**
分析提供的POC代码（exploit.sh），没有发现明显的恶意代码或后门。脚本的主要功能是利用漏洞修改sudoers文件以提升权限，这是一个合法的漏洞利用方式，而非植入恶意代码。README.md文件仅是对漏洞和利用方式的描述。

**利用方式：**
1.  **检查sudo版本：** 脚本首先检查当前系统上安装的sudo版本是否在漏洞影响范围内。
2.  **检查sudoedit权限：** 脚本检查当前用户是否可以使用sudoedit或sudo -e以root权限编辑文件。
3.  **修改sudoers文件：** 如果满足上述条件，脚本会使用用户可控的环境变量EDITOR，通过sudoedit命令打开/etc/sudoers文件。由于sudoedit的漏洞，攻击者可以控制传递给EDITOR程序的参数，从而可以添加任意文件到编辑列表。
4.  **权限提升：**  攻击者在sudoers文件中添加一行，允许当前用户使用sudo执行任何命令，从而获得root权限。
5.  **获取root shell：** 最后，脚本使用`sudo su root`命令获得root shell。

**项目地址:** [n3m1sys/CVE-2023-22809-sudoedit-privesc](https://github.com/n3m1sys/CVE-2023-22809-sudoedit-privesc)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #11

**来源**: [CVE-2023-22809-pashayogi_CVE-2023-22809.md](../2023/CVE-2023-22809-pashayogi_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** 1.8.0 to 1.9.12p1

**利用条件:** 用户需要拥有使用 sudoedit 或 sudo -e 命令编辑文件的权限，且目标文件属于root用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 漏洞允许本地攻击者通过滥用 sudoedit（或 -e）功能中对用户提供的环境变量（SUDO_EDITOR、VISUAL 和 EDITOR）的处理方式，将任意条目附加到要处理的文件列表中，从而导致权限提升。

**有效性：**
POC 代码有效。该代码首先检查 sudo 版本是否在受影响范围内，然后检查当前用户是否可以使用 sudoedit 或 sudo -e 以 root 身份运行命令。如果满足条件，则它会通过设置 EDITOR 环境变量，利用 vim 的 `--` 参数绕过保护机制，打开 /etc/sudoers 文件进行编辑，引导用户添加一行配置以获取 root 权限，最终通过 `sudo su root` 获取 root shell。

**投毒风险：**
该 POC 代码中没有明显的投毒代码。脚本的功能很明确，即利用漏洞提升权限。它仅修改 `/etc/sudoers` 文件，而不会尝试植入任何隐藏的后门或其他恶意代码。

**利用方式：**
1.  **检查 sudo 版本：** 首先，检查目标系统上安装的 sudo 版本是否在受影响的范围内（1.8.0 到 1.9.12p1）。
2.  **检查 sudoedit 权限：** 检查当前用户是否具有使用 sudoedit 或 sudo -e 命令编辑文件的权限，并且该文件归 root 用户所有。
3.  **设置 EDITOR 环境变量：** 将 EDITOR 环境变量设置为包含 `--` 参数的恶意值，例如 `EDITOR="vim -- /etc/sudoers"`。
4.  **运行 sudoedit：** 运行 `sudoedit <受root拥有的文件>` 命令。由于环境变量的影响，这会导致使用 vim 打开 `/etc/sudoers` 文件。
5.  **编辑 /etc/sudoers：**  在打开的 `/etc/sudoers` 文件中，添加一行允许当前用户以 root 身份执行任何命令的配置，例如 `<用户名> ALL=(ALL:ALL) ALL`。
6.  **获取 root shell：** 使用 `sudo su root` 命令获取 root shell。

综上所述，提供的POC代码有效，不存在投毒风险，且能成功利用 CVE-2023-22809 漏洞提升权限。

**项目地址:** [pashayogi/CVE-2023-22809](https://github.com/pashayogi/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #12

**来源**: [CVE-2023-22809-spidoman_CVE-2023-22809-automated-python-exploits.md](../2023/CVE-2023-22809-spidoman_CVE-2023-22809-automated-python-exploits.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地低权限用户提升至root权限

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 需要目标系统上存在sudo且版本在受影响范围内，并且用户拥有sudoedit权限。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-22809是sudoedit中的一个权限提升漏洞。该漏洞源于sudoedit在处理用户提供的环境变量（SUDO_EDITOR、VISUAL和EDITOR）时，对额外的参数处理不当。攻击者可以通过在这些环境变量中注入恶意参数，例如`--`，来绕过保护机制，将任意文件添加到sudoedit要处理的文件列表中，从而以root权限编辑这些文件，最终导致权限提升。

**有效性:** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在且危害较高。提供的POC代码仓库的README.md声称可以自动利用该漏洞，但目前只有readme文件，无法判断代码有效性，但是根据描述，该漏洞利用方式比较简单，因此，实现自动利用的代码是可行的。

**投毒风险:** 提供的漏洞利用代码仓库只包含一个README.md文件，没有任何实际的利用代码，因此很难确定是否存在恶意代码。然而，考虑到这是一个可以提升权限的漏洞，攻击者可能会尝试通过包含后门或恶意指令来进一步控制系统。尽管当前没有明确的投毒证据，但考虑到其潜在的风险，投毒风险评估为20%。

**利用方式:**

1.  **利用sudoedit:**  利用sudoedit命令编辑文件。
2.  **设置环境变量:** 设置SUDO_EDITOR, VISUAL, 或者EDITOR环境变量，包含恶意参数。例如 `EDITOR='vim -- /path/to/arbitrary/file'`。
3.  **触发漏洞:**  执行`sudoedit <target_file>`，其中`<target_file>`可以是任意文件，攻击者通过环境变量注入，可以控制实际被编辑的文件，达到修改敏感文件，提升权限的目的。
4.  **权限提升:**  由于sudoedit以root权限运行，攻击者通过修改/etc/passwd或/etc/shadow等文件，或执行其他恶意操作，可以获得root权限。

**项目地址:** [spidoman/CVE-2023-22809-automated-python-exploits](https://github.com/spidoman/CVE-2023-22809-automated-python-exploits)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---



---

## POC #6

**来源**: [CVE-2023-22809-Toothless5143_CVE-2023-22809.md](../2023/CVE-2023-22809-Toothless5143_CVE-2023-22809.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，本地权限提升至root

**影响版本:** 1.8.0 to 1.9.12p1

**利用条件:** 用户需要具有sudoedit或者sudo -e的权限，且可以以root或者ALL用户运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 是一个 Sudo 的权限提升漏洞，存在于 1.8.0 到 1.9.12p1 版本中。该漏洞是由于 `sudoedit` (也称为 `-e` 功能) 在处理用户提供的环境变量（`SUDO_EDITOR`、`VISUAL` 和 `EDITOR`）中传递的额外参数时存在错误，允许本地攻击者将任意条目附加到要处理的文件列表中，从而导致权限提升。

**利用方式：**
1.  **检查Sudo版本：** 漏洞利用代码首先检查当前安装的 Sudo 版本是否在受影响的范围内 (1.8.0 to 1.9.12p1)。
2.  **检查用户权限：** 漏洞利用代码检查当前用户是否具有使用 `sudoedit` 或 `sudo -e` 命令以 root 身份或以 `ALL` 用户身份运行的权限。这通常意味着用户在 `sudoers` 文件中具有相应的条目。
3.  **利用环境变量注入参数：** 如果满足上述条件，攻击者可以通过设置 `SUDO_EDITOR`、`VISUAL` 或 `EDITOR` 环境变量来注入额外的参数。攻击者可以在这些环境变量中包含 `--` 参数，从而欺骗 `sudoedit` 命令，使其将任意文件添加到要编辑的文件列表中。
4.  **修改sudoers文件：**POC通过vim打开sudoers文件，提示用户添加一行提权配置到sudoers文件中，完成提权。
5.  **获得root权限：**成功修改 `sudoers` 文件后，攻击者可以使用 `sudo su root` 命令获得 root 权限。

**投毒风险评估：**
仔细审查了提供的 POC 代码，没有发现任何明显的恶意代码或后门。该脚本的主要功能是检查 Sudo 版本、用户权限，然后引导用户使用 `sudoedit` 修改 `/etc/sudoers` 文件来提升权限。没有发现任何未经授权的网络连接、文件修改或信息泄露行为。因此，认为该 POC 代码的投毒风险为 0%。

**项目地址:** [Toothless5143/CVE-2023-22809](https://github.com/Toothless5143/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #7

**来源**: [CVE-2023-22809-asepsaepdin_CVE-2023-22809.md](../2023/CVE-2023-22809-asepsaepdin_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升漏洞

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地用户提升至root权限

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 目标系统sudo版本在受影响范围内，当前用户需要具有使用sudoedit或sudo -e命令编辑文件的权限，且目标文件属于root或ALL用户/用户组。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 漏洞存在于 Sudo 1.8.0 到 1.9.12p1 版本中。sudoedit (也称为 -e) 功能错误地处理了用户提供的环境变量（SUDO_EDITOR、VISUAL 和 EDITOR）中传递的额外参数，允许本地攻击者将任意条目附加到要处理的文件列表中。这可能导致权限提升。问题在于用户指定的编辑器可能包含一个“--”参数，该参数会破坏保护机制，例如，EDITOR='vim -- /path/to/extra/file' 值。

**利用方式：**

1.  **检查sudo版本：** 检查目标系统上安装的sudo版本是否在受影响范围内（1.8.0 到 1.9.12p1）。
2.  **验证sudoedit权限：** 确认当前用户是否具有使用`sudoedit`或`sudo -e`命令编辑root权限文件的权限。可以通过`sudo -l`命令查看当前用户的sudo权限。
3.  **设置环境变量：** 设置环境变量`EDITOR`、`VISUAL`或`SUDO_EDITOR`，使其包含恶意参数。例如，`EDITOR='nano -- /etc/sudoers'`。
4.  **执行sudoedit：** 使用`sudoedit`或`sudo -e`命令编辑目标文件。由于环境变量中的恶意参数，实际上可以编辑`/etc/sudoers`文件。
5.  **修改sudoers文件：** 在`/etc/sudoers`文件中添加当前用户具有免密sudo权限的条目，例如`username ALL=(ALL:ALL) ALL`。
6.  **获取root权限：** 使用`sudo su root`或`sudo -i`命令获取root权限。

**有效性：**

提供的POC代码有效。它首先检查sudo版本，然后验证用户是否可以运行sudoedit命令。如果可以，它会指示用户将一行添加到sudoers文件中，以便授予用户root权限。最后，它尝试使用`sudo su root`获取root shell。

**投毒风险：**

查看了exploit.sh脚本。该脚本的主要功能是利用CVE-2023-22809漏洞，通过修改/etc/sudoers文件来提升权限。没有发现任何明显的恶意代码或后门。该脚本的目的是利用漏洞，而不是植入持久性的后门。该脚本需要用户交互，在sudoers文件中添加特定行，这降低了静默投毒的风险。
根据分析，此仓库中存在作者隐藏的投毒代码的可能性为0%。

**项目地址:** [asepsaepdin/CVE-2023-22809](https://github.com/asepsaepdin/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #8

**来源**: [CVE-2023-22809-hello4r1end_patch_CVE-2023-22809.md](../2023/CVE-2023-22809-hello4r1end_patch_CVE-2023-22809.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地攻击者提升权限至root

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 漏洞存在于 Sudo 1.9.12p2 之前的版本中，允许本地攻击者通过操纵 SUDO_EDITOR, VISUAL, 和 EDITOR 环境变量中的参数，利用 sudoedit 命令附加额外的文件进行编辑，从而导致权限提升。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的利用是有效的。多个安全厂商和社区都确认了该漏洞的存在和利用方式。

**投毒风险：**
提供的漏洞利用代码 (`CVE-2023-22809Patch.sh` 和 `README.md`) 实际上是一个用于**更新 Sudo 版本**的脚本，它从 GitHub 下载一个 Debian 包并安装它。这个脚本本身并没有包含任何恶意代码或后门，所以投毒风险评估为0%。它仅仅是尝试修复漏洞，而不是利用漏洞。

**利用方式：**
该漏洞的利用方式是通过设置环境变量 `SUDO_EDITOR`，`VISUAL` 或 `EDITOR`，在其中包含 `--` 参数以及要编辑的恶意文件路径，当用户使用 `sudoedit` 命令时，这些额外的参数会被传递给编辑器，从而允许编辑本来没有权限编辑的文件。例如：`EDITOR='vim -- /etc/shadow'; sudoedit 文件名`。攻击者可以利用此漏洞修改 `/etc/shadow` 文件或其它特权文件，从而获得 root 权限。

**项目地址:** [hello4r1end/patch_CVE-2023-22809](https://github.com/hello4r1end/patch_CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #9

**来源**: [CVE-2023-22809-laxmiyamkolu_SUDO-privilege-escalation.md](../2023/CVE-2023-22809-laxmiyamkolu_SUDO-privilege-escalation.md)

## CVE-2023-22809-Sudoedit特权提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 特权提升

**影响应用:** Sudo

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** 1.8.0 <= Sudo < 1.9.12p2

**利用条件:** 需要用户具有sudoedit权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22809 漏洞允许本地攻击者通过 `sudoedit` 命令提升权限。`sudoedit` 功能在处理用户提供的环境变量（`SUDO_EDITOR`、`VISUAL` 和 `EDITOR`）时存在缺陷，允许攻击者向要处理的文件列表中追加任意条目。攻击者可以通过在编辑器环境变量中包含 `--` 参数来绕过保护机制，例如，设置 `EDITOR='vim -- /path/to/extra/file'`。

**漏洞利用方式：**

1.  **检查Sudo版本：** 确认Sudo版本在受影响范围内 (1.8.0 到 1.9.12p1)。
2.  **检查用户权限：** 确认用户拥有使用`sudoedit`编辑文件的权限。
3.  **设置EDITOR环境变量：** 设置`EDITOR`环境变量，使其包含恶意参数，例如`EDITOR='vim -- /etc/passwd'`。
4.  **使用sudoedit编辑文件：** 使用`sudoedit`编辑允许的文件，触发漏洞，从而能够编辑`/etc/passwd`或其他敏感文件。
5.  **修改/etc/passwd：** 修改`/etc/passwd`文件，将当前用户的UID修改为0，使其成为root用户。
6.  **切换用户：** 使用`su`命令切换到被提权的用户。

**有效性：**

提供的POC代码基本有效，它演示了利用漏洞提升权限的步骤。代码首先检查Sudo版本和用户权限，然后指导用户设置`EDITOR`环境变量，并使用`sudoedit`编辑文件。最后，它引导用户手动修改`/etc/passwd`文件并切换用户。该脚本是半自动化的，需要用户手动干预来修改`/etc/passwd`。

**投毒风险：**

该POC代码的投毒风险较低，约为10%。主要风险在于脚本尝试引导用户修改`/etc/passwd`文件。虽然这是漏洞利用的一部分，但如果用户不小心修改了其他重要配置，可能会导致系统不稳定或无法启动。此外，脚本的作者可能在`README.md`或其他文件中包含误导性信息，引导用户执行不安全的操作。但总体而言，代码本身没有明显的恶意行为。

更详细地分析，脚本中需要用户手动修改/etc/passwd这一步，用户可能会犯错，导致系统问题。理论上，攻击者可以将错误的修改方式写入脚本或文档中，让用户误操作，但现有代码并没有此类行为，因此风险较低。

**项目地址:** [laxmiyamkolu/SUDO-privilege-escalation](https://github.com/laxmiyamkolu/SUDO-privilege-escalation)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #10

**来源**: [CVE-2023-22809-n3m1sys_CVE-2023-22809-sudoedit-privesc.md](../2023/CVE-2023-22809-n3m1sys_CVE-2023-22809-sudoedit-privesc.md)

## CVE-2023-22809-sudo-权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许本地低权限用户获得root权限

**影响版本:** 1.8.0 to 1.9.12p1

**利用条件:** 用户需要能够通过sudoedit或sudo -e以root权限编辑文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809是sudo中的一个权限提升漏洞，存在于1.8.0到1.9.12p1版本。sudoedit (或 -e) 功能错误地处理了用户提供的环境变量（SUDO_EDITOR、VISUAL和EDITOR）中传递的额外参数，允许本地攻击者将任意条目附加到要处理的文件列表中。攻击者可以通过设置这些环境变量来包含恶意文件，从而导致权限提升。

**有效性：**
根据漏洞信息和POC代码，该漏洞利用是有效的。POC脚本首先检查sudo版本是否在受影响范围内，然后检查当前用户是否具有使用sudoedit或sudo -e以root权限编辑文件的权限。如果满足这两个条件，它将修改/etc/sudoers文件，为当前用户添加sudo权限，从而获得root shell。

**投毒风险：**
分析提供的POC代码（exploit.sh），没有发现明显的恶意代码或后门。脚本的主要功能是利用漏洞修改sudoers文件以提升权限，这是一个合法的漏洞利用方式，而非植入恶意代码。README.md文件仅是对漏洞和利用方式的描述。

**利用方式：**
1.  **检查sudo版本：** 脚本首先检查当前系统上安装的sudo版本是否在漏洞影响范围内。
2.  **检查sudoedit权限：** 脚本检查当前用户是否可以使用sudoedit或sudo -e以root权限编辑文件。
3.  **修改sudoers文件：** 如果满足上述条件，脚本会使用用户可控的环境变量EDITOR，通过sudoedit命令打开/etc/sudoers文件。由于sudoedit的漏洞，攻击者可以控制传递给EDITOR程序的参数，从而可以添加任意文件到编辑列表。
4.  **权限提升：**  攻击者在sudoers文件中添加一行，允许当前用户使用sudo执行任何命令，从而获得root权限。
5.  **获取root shell：** 最后，脚本使用`sudo su root`命令获得root shell。

**项目地址:** [n3m1sys/CVE-2023-22809-sudoedit-privesc](https://github.com/n3m1sys/CVE-2023-22809-sudoedit-privesc)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #11

**来源**: [CVE-2023-22809-pashayogi_CVE-2023-22809.md](../2023/CVE-2023-22809-pashayogi_CVE-2023-22809.md)

## CVE-2023-22809-sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** 1.8.0 to 1.9.12p1

**利用条件:** 用户需要拥有使用 sudoedit 或 sudo -e 命令编辑文件的权限，且目标文件属于root用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 漏洞允许本地攻击者通过滥用 sudoedit（或 -e）功能中对用户提供的环境变量（SUDO_EDITOR、VISUAL 和 EDITOR）的处理方式，将任意条目附加到要处理的文件列表中，从而导致权限提升。

**有效性：**
POC 代码有效。该代码首先检查 sudo 版本是否在受影响范围内，然后检查当前用户是否可以使用 sudoedit 或 sudo -e 以 root 身份运行命令。如果满足条件，则它会通过设置 EDITOR 环境变量，利用 vim 的 `--` 参数绕过保护机制，打开 /etc/sudoers 文件进行编辑，引导用户添加一行配置以获取 root 权限，最终通过 `sudo su root` 获取 root shell。

**投毒风险：**
该 POC 代码中没有明显的投毒代码。脚本的功能很明确，即利用漏洞提升权限。它仅修改 `/etc/sudoers` 文件，而不会尝试植入任何隐藏的后门或其他恶意代码。

**利用方式：**
1.  **检查 sudo 版本：** 首先，检查目标系统上安装的 sudo 版本是否在受影响的范围内（1.8.0 到 1.9.12p1）。
2.  **检查 sudoedit 权限：** 检查当前用户是否具有使用 sudoedit 或 sudo -e 命令编辑文件的权限，并且该文件归 root 用户所有。
3.  **设置 EDITOR 环境变量：** 将 EDITOR 环境变量设置为包含 `--` 参数的恶意值，例如 `EDITOR="vim -- /etc/sudoers"`。
4.  **运行 sudoedit：** 运行 `sudoedit <受root拥有的文件>` 命令。由于环境变量的影响，这会导致使用 vim 打开 `/etc/sudoers` 文件。
5.  **编辑 /etc/sudoers：**  在打开的 `/etc/sudoers` 文件中，添加一行允许当前用户以 root 身份执行任何命令的配置，例如 `<用户名> ALL=(ALL:ALL) ALL`。
6.  **获取 root shell：** 使用 `sudo su root` 命令获取 root shell。

综上所述，提供的POC代码有效，不存在投毒风险，且能成功利用 CVE-2023-22809 漏洞提升权限。

**项目地址:** [pashayogi/CVE-2023-22809](https://github.com/pashayogi/CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

## POC #12

**来源**: [CVE-2023-22809-spidoman_CVE-2023-22809-automated-python-exploits.md](../2023/CVE-2023-22809-spidoman_CVE-2023-22809-automated-python-exploits.md)

## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地低权限用户提升至root权限

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 需要目标系统上存在sudo且版本在受影响范围内，并且用户拥有sudoedit权限。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-22809是sudoedit中的一个权限提升漏洞。该漏洞源于sudoedit在处理用户提供的环境变量（SUDO_EDITOR、VISUAL和EDITOR）时，对额外的参数处理不当。攻击者可以通过在这些环境变量中注入恶意参数，例如`--`，来绕过保护机制，将任意文件添加到sudoedit要处理的文件列表中，从而以root权限编辑这些文件，最终导致权限提升。

**有效性:** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在且危害较高。提供的POC代码仓库的README.md声称可以自动利用该漏洞，但目前只有readme文件，无法判断代码有效性，但是根据描述，该漏洞利用方式比较简单，因此，实现自动利用的代码是可行的。

**投毒风险:** 提供的漏洞利用代码仓库只包含一个README.md文件，没有任何实际的利用代码，因此很难确定是否存在恶意代码。然而，考虑到这是一个可以提升权限的漏洞，攻击者可能会尝试通过包含后门或恶意指令来进一步控制系统。尽管当前没有明确的投毒证据，但考虑到其潜在的风险，投毒风险评估为20%。

**利用方式:**

1.  **利用sudoedit:**  利用sudoedit命令编辑文件。
2.  **设置环境变量:** 设置SUDO_EDITOR, VISUAL, 或者EDITOR环境变量，包含恶意参数。例如 `EDITOR='vim -- /path/to/arbitrary/file'`。
3.  **触发漏洞:**  执行`sudoedit <target_file>`，其中`<target_file>`可以是任意文件，攻击者通过环境变量注入，可以控制实际被编辑的文件，达到修改敏感文件，提升权限的目的。
4.  **权限提升:**  由于sudoedit以root权限运行，攻击者通过修改/etc/passwd或/etc/shadow等文件，或执行其他恶意操作，可以获得root权限。

**项目地址:** [spidoman/CVE-2023-22809-automated-python-exploits](https://github.com/spidoman/CVE-2023-22809-automated-python-exploits)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)

---

