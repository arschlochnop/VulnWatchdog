# CVE-2023-46818

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-46818-SyFi_CVE-2023-46818.md](../2023/CVE-2023-46818-SyFi_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit 必须启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-46818 漏洞存在于 ISPConfig 3.2.11p1 之前的版本中。当 `admin_allow_langedit` 启用时，具有管理员权限的用户可以通过语言文件编辑器注入 PHP 代码，从而导致远程代码执行。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的管理员用户名和密码登录 ISPConfig 控制面板。
2.  **漏洞触发条件判断:** 需要`admin_allow_langedit`配置开启.
3.  **语言文件编辑：** 登录后，攻击者需要访问语言文件编辑器。
4.  **代码注入：** 在语言文件编辑器中，攻击者可以插入恶意的 PHP 代码。
5.  **代码执行：** 当 ISPConfig 执行包含恶意代码的语言文件时，攻击者注入的 PHP 代码将被执行，从而导致远程代码执行。

**POC有效性：**
提供的 Metasploit 模块利用了该漏洞，如果目标满足漏洞利用的条件（ISPConfig 版本 <= 3.2.11, 管理员权限，`admin_allow_langedit`启用），则该 POC 代码有效。

**投毒风险分析：**

通过分析提供的 POC 代码，发现其主要功能是利用漏洞进行代码注入，并创建一个反向 shell。其中存在投毒代码的可能性较低，主要是因为代码整体结构清晰，功能明确，没有发现隐藏的恶意逻辑。
`Metasploit-module/ispconfig_language_edit.rb` 代码的功能是构造恶意请求，向目标服务器发送包含 PHP 代码的payload。该payload 会执行反向连接，获取shell。虽然代码本身不包含恶意逻辑，但攻击者可以使用该模块执行任意命令，存在一定风险。但是根据代码逻辑和模块用途来判断，其目的就是为了漏洞利用，所以不能完全确定存在投毒风险。

**风险评估：**

尽管代码本身没有明显的投毒迹象，但考虑到其漏洞利用的性质，攻击者可以利用该模块进行恶意活动。因此，建议在使用该模块时，对代码进行仔细审查，并仅在授权的渗透测试环境中使用。

**投毒百分比评估：**

由于 POC 代码的主要功能是漏洞利用，没有明显的投毒行为，所以判定投毒风险较低，大约为 10%。 这个风险主要来自于使用者可能会修改payload为恶意脚本,或者作者后期更新版本,添加恶意功能。

**项目地址:** [SyFi/CVE-2023-46818](https://github.com/SyFi/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #2

**来源**: [CVE-2023-46818-ajdumanhug_CVE-2023-46818.md](../2023/CVE-2023-46818-ajdumanhug_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，允许管理员注入并执行任意PHP代码，可能导致服务器完全控制

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，并且`admin_allow_langedit`选项已启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11及更早版本中的一个PHP代码注入漏洞。利用此漏洞，需要满足以下条件：

1.  **管理员权限：** 攻击者必须拥有ISPConfig的管理员账户。
2.  **`admin_allow_langedit`启用：**  `admin_allow_langedit`配置项必须被启用。该漏洞存在于`language_edit.php`文件中，该文件用于编辑语言文件。

**利用方式：**

1.  **登录：** 使用管理员账户登录ISPConfig控制面板。
2.  **获取CSRF令牌：** 访问`language_edit.php`页面，获取CSRF ID和CSRF Key。这个步骤是为了绕过CSRF保护。
3.  **注入恶意代码：** 构造包含恶意PHP代码的请求，通过`records`参数注入，并将其发送到`language_edit.php`。POC代码使用`file_put_contents`函数将一个webshell写入到服务器上的`admin/sh.php`文件中，该webshell接收通过HTTP头`C`传递的base64编码的命令并执行。
4.  **执行命令：** 访问webshell（`admin/sh.php`），并在HTTP头`C`中传递base64编码的命令。服务器会执行该命令并将结果返回。

**关于有效性：**

根据漏洞库信息、搜索引擎结果，以及提供的漏洞利用代码，该漏洞POC代码是有效的。多个来源（NVD、Recorded Future、Sploitus等）都确认了该漏洞的存在，并且提供了利用细节。提供的Python脚本实现了漏洞利用的完整流程。

**关于投毒风险：**

评估投毒风险较低，约为5%。该Python脚本主要功能是利用已知漏洞，但仍然存在极小的潜在风险：

*   **对远程服务器造成破坏的可能性：** POC利用代码中虽然主要目标是执行命令，如果webshell被其他人利用，或者注入的Payload被修改，可能会被用于其他恶意目的，例如删除文件、篡改配置等。
*   **依赖库风险：**  脚本依赖`requests`库，虽然该库本身很常用，如果被供应链投毒，也会影响此脚本。

总体而言，该代码的目的是实现已知的漏洞利用，投毒风险较低，但仍然需要人工审核。

**项目地址:** [ajdumanhug/CVE-2023-46818](https://github.com/ajdumanhug/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #3

**来源**: [CVE-2023-46818-bipbopbup_CVE-2023-46818-python-exploit.md](../2023/CVE-2023-46818-bipbopbup_CVE-2023-46818-python-exploit.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit选项开启

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-46818是一个存在于ISPConfig 3.2.11及之前版本中的PHP代码注入漏洞。该漏洞位于language_edit.php文件中，允许具有管理员权限的用户，如果启用了`admin_allow_langedit`选项，则可以通过修改语言文件注入并执行任意PHP代码。

**漏洞利用方式：**

1.  **身份验证：** 攻击者必须首先以管理员身份登录到ISPConfig控制面板。
2.  **访问语言文件编辑器：** 登录后，攻击者需要导航到语言文件编辑器。
3.  **注入恶意PHP代码：** 攻击者通过`records` POST参数，将恶意PHP代码注入到语言文件的内容中。由于输入没有经过充分的清理，攻击者可以插入任意PHP代码。
4.  **代码执行：** 当ISPConfig加载或执行被修改的语言文件时，注入的PHP代码将被执行，从而允许攻击者在服务器上执行任意命令。

**POC代码分析：**

提供的Python POC代码自动化了漏洞利用过程。它执行以下步骤：

1.  **登录：** 使用提供的URL、用户名和密码登录到ISPConfig。
2.  **构造Payload：** 构造包含恶意PHP代码的Payload，该代码会将一个WebShell写入到服务器上的`sh.php`文件中。
3.  **CSRF Token获取:**  获取CSRF ID和Key，绕过CSRF防御
4.  **注入代码：** 向`language_edit.php`发送包含Payload的POST请求。
5.  **启动Shell：** 连接到新创建的WebShell，允许攻击者执行任意命令。

**有效性评估：**

根据漏洞描述和POC代码，该漏洞利用是有效的。POC代码提供了一个可以直接利用该漏洞的有效方法，搜索结果也确认了该漏洞的存在以及利用的可能性。

**投毒风险评估：**

检查POC代码后，发现该代码主要功能是利用漏洞进行代码注入，在/admin/目录下写入webshell，实现远程代码执行。虽然该代码用于恶意目的，但它本身没有隐藏任何额外的、与漏洞利用无关的恶意代码。因此，投毒风险较低，约为1%。

虽然可以判定POC代码不属于投毒代码,但在实际环境中，利用此漏洞本身就是一种恶意行为，会导致服务器被完全控制。


**项目地址:** [bipbopbup/CVE-2023-46818-python-exploit](https://github.com/bipbopbup/CVE-2023-46818-python-exploit)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #4

**来源**: [CVE-2023-46818-blindma1den_CVE-2023-46818-Exploit.md](../2023/CVE-2023-46818-blindma1den_CVE-2023-46818-Exploit.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要admin_allow_langedit开启，需要管理员权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11版本及之前版本中存在的一个PHP代码注入漏洞。该漏洞允许具有管理员权限的用户，在admin_allow_langedit选项启用的情况下，通过语言文件编辑器注入恶意的PHP代码，从而导致远程代码执行。

**有效性:**
根据提供的漏洞信息、搜索结果以及漏洞利用代码，可以判断该POC代码是有效的。搜索结果中存在多个关于此漏洞的讨论和利用代码，漏洞利用代码的README也表明了该漏洞利用的成功性。POC代码通过模拟管理员登录，利用`language_edit.php`的`records[]`字段注入PHP代码，最终写入一个webshell，证明漏洞可以被成功利用。

**投毒风险:**
通过分析POC代码，投毒风险较低。代码主要功能是自动化利用漏洞，注入webshell，方便后续的远程命令执行。主要的风险点在于：

*   **Webshell：** 注入的 webshell (`sh.php`) 允许攻击者执行任意系统命令。这本身就是一种后门，但并非作者有意植入的“投毒”代码，而是漏洞利用的必然结果。
*  **依赖:** POC代码依赖requests库,如果requests库被替换成恶意版本,可能存在投毒风险, 但这个不是POC代码本身的问题.

代码中并没有发现明显的恶意行为，例如上传额外文件、修改系统配置等。因此，投毒风险主要集中在webshell本身，以及程序依赖的外部库，而不是POC代码作者有意添加的恶意代码。
综合评估，投毒风险约为5%。

**利用方式:**
1.  **身份验证:** 首先，攻击者需要拥有ISPConfig的管理员账户的有效凭据。
2.  **登录:** 使用提供的用户名和密码登录到ISPConfig管理面板。
3.  **CSRF绕过:** 获取并利用CSRF token，绕过CSRF保护。
4.  **语言文件编辑:** 访问`language_edit.php`页面，该页面允许管理员编辑语言文件。
5.  **代码注入:** 利用`records[]`参数，注入包含PHP代码的恶意payload。该payload会在服务器上创建一个webshell文件 (`sh.php`)。
6.  **webshell访问:** 攻击者可以通过访问webshell文件，执行任意系统命令。`sh.php` 接收 `C` header，对其进行base64解码后执行。
7.  **命令执行:** 通过修改header的`C`值，从而发送执行任意命令到目标服务器。命令的输出会被封装在`____`标签之间方便解析。
8.  **权限要求:** 利用此漏洞需要admin_allow_langedit开启,普通权限用户无法进行利用.

**项目地址:** [blindma1den/CVE-2023-46818-Exploit](https://github.com/blindma1den/CVE-2023-46818-Exploit)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #5

**来源**: [CVE-2023-46818-engranaabubakar_CVE-2023-46818.md](../2023/CVE-2023-46818-engranaabubakar_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit 必须启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于ISPConfig 3.2.11及更早版本的language_edit.php中。当admin_allow_langedit启用时，具有管理员权限的用户可以通过修改语言文件，利用 `records[]` 参数注入恶意的PHP代码，从而在服务器上执行任意命令。PoC利用脚本首先登录ISPConfig后台，然后通过构造包含恶意PHP代码的POST请求发送到language_edit.php，将webshell写入服务器。最后，通过webshell执行命令。投毒风险较低，主要体现在脚本在部署webshell后，交互式shell执行命令时会将响应内容与预定义的`____`标记进行比对，若输出内容不是预期格式，会输出原始响应，增加了一些分析难度。虽然有webshell上传，但是webshell的payload不是直接执行恶意代码而是创建一个命令执行的接口，给使用者更多的控制空间。

**项目地址:** [engranaabubakar/CVE-2023-46818](https://github.com/engranaabubakar/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #6

**来源**: [CVE-2023-46818-rvizx_CVE-2023-46818.md](../2023/CVE-2023-46818-rvizx_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限并启用admin_allow_langedit

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11版本及之前版本中存在的一个PHP代码注入漏洞。该漏洞允许具有管理员权限的用户，在启用了`admin_allow_langedit`设置的情况下，通过`language_edit.php`页面的`records[]`参数注入恶意的PHP代码，从而实现远程代码执行。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且已经有公开的PoC利用代码可用。该PoC的`exploit.sh`脚本通过以下步骤利用漏洞：
1.  使用提供的用户名和密码登录ISPConfig管理界面。
2.  获取CSRF令牌（`_csrf_id`和`_csrf_key`）。
3.  构造包含PHP webshell的payload，该webshell允许执行任意命令，并将其base64编码。
4.  将编码后的payload注入到`language_edit.php`的`records[]`参数中，利用PHP代码注入漏洞将webshell写入到服务器的`/admin/`目录下，命名为`sh.php`。
5.  通过访问`/admin/sh.php`，攻击者可以执行任意系统命令。

**投毒风险：**
分析`exploit.sh`脚本，存在轻微的投毒风险。该脚本在部署webshell后，会创建一个交互式shell，允许攻击者持续执行命令。虽然PoC本身的目的在于验证漏洞，但这种交互式shell如果被恶意使用，可能造成更大的危害，例如持续监视或数据窃取。另外，作者可能在脚本中嵌入隐蔽的后门代码，但经过检查，在给定的脚本中没有明显发现这样的代码。但是仍然存在一定几率payload被替换成其他的恶意代码. 风险比例估计为5%。

**利用方式：**
1.  攻击者需要拥有ISPConfig的管理权限。
2.  需要启用`admin_allow_langedit`设置。
3.  攻击者使用`exploit.sh`脚本提供的URL、用户名和密码来利用漏洞，在目标服务器上部署webshell。
4.  攻击者通过访问webshell，执行任意系统命令。

**项目地址:** [rvizx/CVE-2023-46818](https://github.com/rvizx/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #7

**来源**: [CVE-2023-46818-vulnerk0_CVE-2023-46818.md](../2023/CVE-2023-46818-vulnerk0_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit选项开启

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-46818 漏洞存在于 ISPConfig 3.2.11p1 之前的版本中。攻击者（需要管理员权限）可以通过语言文件编辑器注入 PHP 代码。漏洞利用方式如下：

1.  **漏洞描述：**该漏洞允许经过身份验证的管理员用户，在启用了 `admin_allow_langedit` 选项的情况下，通过编辑语言文件注入恶意的 PHP 代码。
2.  **POC有效性：** 提供的 POC 代码 `exploit.py` 看起来是有效的。它首先尝试登录 ISPConfig 管理面板，然后通过编辑语言文件注入 PHP 代码，最后通过访问注入的 PHP 文件来执行任意命令。这个POC的有效性取决于目标ISPConfig实例是否满足漏洞前提条件：版本<=3.2.11，管理员权限，并且admin_allow_langedit选项被启用。
3.  **利用方式：**
    *   使用提供的用户名和密码登录 ISPConfig 管理面板。
    *   找到语言文件编辑功能，编辑一个语言文件。
    *   在语言文件中注入恶意的 PHP 代码，例如 `<?php system($_GET['cmd']); ?>`，这样可以通过 GET 请求传递命令参数来执行任意系统命令。
    *   通过访问包含恶意 PHP 代码的语言文件，执行任意命令。
4.  **投毒风险：** 查看了提供的 exploit.py 脚本和 README.md。该脚本的功能是利用 CVE-2023-46818 在 ISPConfig 系统中进行 PHP 代码注入。脚本的主要功能是：检查连接，尝试使用提供的用户名和密码登录，如果登录成功，则通过修改语言文件注入后门 PHP 代码，最后创建一个webshell，允许通过 GET 请求执行任意命令。该脚本本身没有发现明显的恶意代码，例如未经授权的数据收集、传播恶意软件等。README.md 也只包含漏洞描述和使用方法。
    因此，可以认为该仓库中存在作者隐藏的投毒代码的风险较低。


**项目地址:** [vulnerk0/CVE-2023-46818](https://github.com/vulnerk0/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #8

**来源**: [CVE-2023-46818-z7Akane_CVE-2023-46818.md](../2023/CVE-2023-46818-z7Akane_CVE-2023-46818.md)

## CVE-2023-46818 - ISPConfig PHP 代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP 代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，`admin_allow_langedit` 必须启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818 存在于 ISPConfig 3.2.11p1 之前的版本中。如果管理员启用了 `admin_allow_langedit` 选项，则攻击者（具有管理员权限）可以通过语言文件编辑器注入 PHP 代码。 

**漏洞利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的管理员凭据登录 ISPConfig 控制面板。
2.  **CSRF 令牌获取：** 利用 `language_edit.php` 页面，获取 CSRF ID 和 Key。POC脚本模拟了此过程，构造包含`lang`，`module`，`lang_file`参数的POST请求。`lang_file`参数是随机生成的，目的是创建一个新的语言文件。
3.  **代码注入：** 攻击者通过修改语言文件，将恶意的 PHP 代码注入到 `records[\]` 参数中。POC脚本中，注入的代码会将一个简单的webshell写入到 `/admin/sh.php`。
4.  **Webshell 访问：** 成功注入代码后，攻击者可以通过访问 `/admin/sh.php` 文件来执行任意命令。POC脚本通过GET请求，将需要执行的命令base64编码后放在HTTP Header `C`中传递给webshell。webshell执行命令，并将结果返回。脚本通过正则表达式提取命令执行结果。
5. **有效性：**根据漏洞库信息和搜索引擎结果，该漏洞存在且已公开。提供的POC代码也验证了该漏洞的可利用性。

**投毒风险分析：**

代码中存在投毒的风险较低，约5%。主要考虑以下几点：

*   **Base64 编码的 Payload：** Payload 使用 Base64 编码，方便审计人员进行检查。虽然攻击者可以替换Payload为恶意的代码，但是这种修改很容易被发现。
*  **对ISPConfig目录的写入操作:** 代码在`/admin/` 目录下写入webshell文件`sh.php`。该行为属于攻击行为，会触发安全警报。
*  **公开的利用方式：** 漏洞利用方式比较直接，与其他搜索结果和漏洞描述一致。没有发现隐藏的、非预期的行为。

虽然存在一些微小的风险，但综合来看，该 POC 的主要目的是验证漏洞，而不是进行恶意投毒。攻击者可以修改利用脚本来包含恶意载荷，但这不属于原始代码的投毒行为。

**项目地址:** [z7Akane/CVE-2023-46818](https://github.com/z7Akane/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #9

**来源**: [CVE-2023-46818-zs1n_CVE-2023-46818.md](../2023/CVE-2023-46818-zs1n_CVE-2023-46818.md)

# CVE-2023-46818

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-46818-SyFi_CVE-2023-46818.md](../2023/CVE-2023-46818-SyFi_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit 必须启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-46818 漏洞存在于 ISPConfig 3.2.11p1 之前的版本中。当 `admin_allow_langedit` 启用时，具有管理员权限的用户可以通过语言文件编辑器注入 PHP 代码，从而导致远程代码执行。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的管理员用户名和密码登录 ISPConfig 控制面板。
2.  **漏洞触发条件判断:** 需要`admin_allow_langedit`配置开启.
3.  **语言文件编辑：** 登录后，攻击者需要访问语言文件编辑器。
4.  **代码注入：** 在语言文件编辑器中，攻击者可以插入恶意的 PHP 代码。
5.  **代码执行：** 当 ISPConfig 执行包含恶意代码的语言文件时，攻击者注入的 PHP 代码将被执行，从而导致远程代码执行。

**POC有效性：**
提供的 Metasploit 模块利用了该漏洞，如果目标满足漏洞利用的条件（ISPConfig 版本 <= 3.2.11, 管理员权限，`admin_allow_langedit`启用），则该 POC 代码有效。

**投毒风险分析：**

通过分析提供的 POC 代码，发现其主要功能是利用漏洞进行代码注入，并创建一个反向 shell。其中存在投毒代码的可能性较低，主要是因为代码整体结构清晰，功能明确，没有发现隐藏的恶意逻辑。
`Metasploit-module/ispconfig_language_edit.rb` 代码的功能是构造恶意请求，向目标服务器发送包含 PHP 代码的payload。该payload 会执行反向连接，获取shell。虽然代码本身不包含恶意逻辑，但攻击者可以使用该模块执行任意命令，存在一定风险。但是根据代码逻辑和模块用途来判断，其目的就是为了漏洞利用，所以不能完全确定存在投毒风险。

**风险评估：**

尽管代码本身没有明显的投毒迹象，但考虑到其漏洞利用的性质，攻击者可以利用该模块进行恶意活动。因此，建议在使用该模块时，对代码进行仔细审查，并仅在授权的渗透测试环境中使用。

**投毒百分比评估：**

由于 POC 代码的主要功能是漏洞利用，没有明显的投毒行为，所以判定投毒风险较低，大约为 10%。 这个风险主要来自于使用者可能会修改payload为恶意脚本,或者作者后期更新版本,添加恶意功能。

**项目地址:** [SyFi/CVE-2023-46818](https://github.com/SyFi/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #2

**来源**: [CVE-2023-46818-ajdumanhug_CVE-2023-46818.md](../2023/CVE-2023-46818-ajdumanhug_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，允许管理员注入并执行任意PHP代码，可能导致服务器完全控制

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，并且`admin_allow_langedit`选项已启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11及更早版本中的一个PHP代码注入漏洞。利用此漏洞，需要满足以下条件：

1.  **管理员权限：** 攻击者必须拥有ISPConfig的管理员账户。
2.  **`admin_allow_langedit`启用：**  `admin_allow_langedit`配置项必须被启用。该漏洞存在于`language_edit.php`文件中，该文件用于编辑语言文件。

**利用方式：**

1.  **登录：** 使用管理员账户登录ISPConfig控制面板。
2.  **获取CSRF令牌：** 访问`language_edit.php`页面，获取CSRF ID和CSRF Key。这个步骤是为了绕过CSRF保护。
3.  **注入恶意代码：** 构造包含恶意PHP代码的请求，通过`records`参数注入，并将其发送到`language_edit.php`。POC代码使用`file_put_contents`函数将一个webshell写入到服务器上的`admin/sh.php`文件中，该webshell接收通过HTTP头`C`传递的base64编码的命令并执行。
4.  **执行命令：** 访问webshell（`admin/sh.php`），并在HTTP头`C`中传递base64编码的命令。服务器会执行该命令并将结果返回。

**关于有效性：**

根据漏洞库信息、搜索引擎结果，以及提供的漏洞利用代码，该漏洞POC代码是有效的。多个来源（NVD、Recorded Future、Sploitus等）都确认了该漏洞的存在，并且提供了利用细节。提供的Python脚本实现了漏洞利用的完整流程。

**关于投毒风险：**

评估投毒风险较低，约为5%。该Python脚本主要功能是利用已知漏洞，但仍然存在极小的潜在风险：

*   **对远程服务器造成破坏的可能性：** POC利用代码中虽然主要目标是执行命令，如果webshell被其他人利用，或者注入的Payload被修改，可能会被用于其他恶意目的，例如删除文件、篡改配置等。
*   **依赖库风险：**  脚本依赖`requests`库，虽然该库本身很常用，如果被供应链投毒，也会影响此脚本。

总体而言，该代码的目的是实现已知的漏洞利用，投毒风险较低，但仍然需要人工审核。

**项目地址:** [ajdumanhug/CVE-2023-46818](https://github.com/ajdumanhug/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #3

**来源**: [CVE-2023-46818-bipbopbup_CVE-2023-46818-python-exploit.md](../2023/CVE-2023-46818-bipbopbup_CVE-2023-46818-python-exploit.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit选项开启

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-46818是一个存在于ISPConfig 3.2.11及之前版本中的PHP代码注入漏洞。该漏洞位于language_edit.php文件中，允许具有管理员权限的用户，如果启用了`admin_allow_langedit`选项，则可以通过修改语言文件注入并执行任意PHP代码。

**漏洞利用方式：**

1.  **身份验证：** 攻击者必须首先以管理员身份登录到ISPConfig控制面板。
2.  **访问语言文件编辑器：** 登录后，攻击者需要导航到语言文件编辑器。
3.  **注入恶意PHP代码：** 攻击者通过`records` POST参数，将恶意PHP代码注入到语言文件的内容中。由于输入没有经过充分的清理，攻击者可以插入任意PHP代码。
4.  **代码执行：** 当ISPConfig加载或执行被修改的语言文件时，注入的PHP代码将被执行，从而允许攻击者在服务器上执行任意命令。

**POC代码分析：**

提供的Python POC代码自动化了漏洞利用过程。它执行以下步骤：

1.  **登录：** 使用提供的URL、用户名和密码登录到ISPConfig。
2.  **构造Payload：** 构造包含恶意PHP代码的Payload，该代码会将一个WebShell写入到服务器上的`sh.php`文件中。
3.  **CSRF Token获取:**  获取CSRF ID和Key，绕过CSRF防御
4.  **注入代码：** 向`language_edit.php`发送包含Payload的POST请求。
5.  **启动Shell：** 连接到新创建的WebShell，允许攻击者执行任意命令。

**有效性评估：**

根据漏洞描述和POC代码，该漏洞利用是有效的。POC代码提供了一个可以直接利用该漏洞的有效方法，搜索结果也确认了该漏洞的存在以及利用的可能性。

**投毒风险评估：**

检查POC代码后，发现该代码主要功能是利用漏洞进行代码注入，在/admin/目录下写入webshell，实现远程代码执行。虽然该代码用于恶意目的，但它本身没有隐藏任何额外的、与漏洞利用无关的恶意代码。因此，投毒风险较低，约为1%。

虽然可以判定POC代码不属于投毒代码,但在实际环境中，利用此漏洞本身就是一种恶意行为，会导致服务器被完全控制。


**项目地址:** [bipbopbup/CVE-2023-46818-python-exploit](https://github.com/bipbopbup/CVE-2023-46818-python-exploit)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #4

**来源**: [CVE-2023-46818-blindma1den_CVE-2023-46818-Exploit.md](../2023/CVE-2023-46818-blindma1den_CVE-2023-46818-Exploit.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要admin_allow_langedit开启，需要管理员权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11版本及之前版本中存在的一个PHP代码注入漏洞。该漏洞允许具有管理员权限的用户，在admin_allow_langedit选项启用的情况下，通过语言文件编辑器注入恶意的PHP代码，从而导致远程代码执行。

**有效性:**
根据提供的漏洞信息、搜索结果以及漏洞利用代码，可以判断该POC代码是有效的。搜索结果中存在多个关于此漏洞的讨论和利用代码，漏洞利用代码的README也表明了该漏洞利用的成功性。POC代码通过模拟管理员登录，利用`language_edit.php`的`records[]`字段注入PHP代码，最终写入一个webshell，证明漏洞可以被成功利用。

**投毒风险:**
通过分析POC代码，投毒风险较低。代码主要功能是自动化利用漏洞，注入webshell，方便后续的远程命令执行。主要的风险点在于：

*   **Webshell：** 注入的 webshell (`sh.php`) 允许攻击者执行任意系统命令。这本身就是一种后门，但并非作者有意植入的“投毒”代码，而是漏洞利用的必然结果。
*  **依赖:** POC代码依赖requests库,如果requests库被替换成恶意版本,可能存在投毒风险, 但这个不是POC代码本身的问题.

代码中并没有发现明显的恶意行为，例如上传额外文件、修改系统配置等。因此，投毒风险主要集中在webshell本身，以及程序依赖的外部库，而不是POC代码作者有意添加的恶意代码。
综合评估，投毒风险约为5%。

**利用方式:**
1.  **身份验证:** 首先，攻击者需要拥有ISPConfig的管理员账户的有效凭据。
2.  **登录:** 使用提供的用户名和密码登录到ISPConfig管理面板。
3.  **CSRF绕过:** 获取并利用CSRF token，绕过CSRF保护。
4.  **语言文件编辑:** 访问`language_edit.php`页面，该页面允许管理员编辑语言文件。
5.  **代码注入:** 利用`records[]`参数，注入包含PHP代码的恶意payload。该payload会在服务器上创建一个webshell文件 (`sh.php`)。
6.  **webshell访问:** 攻击者可以通过访问webshell文件，执行任意系统命令。`sh.php` 接收 `C` header，对其进行base64解码后执行。
7.  **命令执行:** 通过修改header的`C`值，从而发送执行任意命令到目标服务器。命令的输出会被封装在`____`标签之间方便解析。
8.  **权限要求:** 利用此漏洞需要admin_allow_langedit开启,普通权限用户无法进行利用.

**项目地址:** [blindma1den/CVE-2023-46818-Exploit](https://github.com/blindma1den/CVE-2023-46818-Exploit)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #5

**来源**: [CVE-2023-46818-engranaabubakar_CVE-2023-46818.md](../2023/CVE-2023-46818-engranaabubakar_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit 必须启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于ISPConfig 3.2.11及更早版本的language_edit.php中。当admin_allow_langedit启用时，具有管理员权限的用户可以通过修改语言文件，利用 `records[]` 参数注入恶意的PHP代码，从而在服务器上执行任意命令。PoC利用脚本首先登录ISPConfig后台，然后通过构造包含恶意PHP代码的POST请求发送到language_edit.php，将webshell写入服务器。最后，通过webshell执行命令。投毒风险较低，主要体现在脚本在部署webshell后，交互式shell执行命令时会将响应内容与预定义的`____`标记进行比对，若输出内容不是预期格式，会输出原始响应，增加了一些分析难度。虽然有webshell上传，但是webshell的payload不是直接执行恶意代码而是创建一个命令执行的接口，给使用者更多的控制空间。

**项目地址:** [engranaabubakar/CVE-2023-46818](https://github.com/engranaabubakar/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #6

**来源**: [CVE-2023-46818-rvizx_CVE-2023-46818.md](../2023/CVE-2023-46818-rvizx_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限并启用admin_allow_langedit

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11版本及之前版本中存在的一个PHP代码注入漏洞。该漏洞允许具有管理员权限的用户，在启用了`admin_allow_langedit`设置的情况下，通过`language_edit.php`页面的`records[]`参数注入恶意的PHP代码，从而实现远程代码执行。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且已经有公开的PoC利用代码可用。该PoC的`exploit.sh`脚本通过以下步骤利用漏洞：
1.  使用提供的用户名和密码登录ISPConfig管理界面。
2.  获取CSRF令牌（`_csrf_id`和`_csrf_key`）。
3.  构造包含PHP webshell的payload，该webshell允许执行任意命令，并将其base64编码。
4.  将编码后的payload注入到`language_edit.php`的`records[]`参数中，利用PHP代码注入漏洞将webshell写入到服务器的`/admin/`目录下，命名为`sh.php`。
5.  通过访问`/admin/sh.php`，攻击者可以执行任意系统命令。

**投毒风险：**
分析`exploit.sh`脚本，存在轻微的投毒风险。该脚本在部署webshell后，会创建一个交互式shell，允许攻击者持续执行命令。虽然PoC本身的目的在于验证漏洞，但这种交互式shell如果被恶意使用，可能造成更大的危害，例如持续监视或数据窃取。另外，作者可能在脚本中嵌入隐蔽的后门代码，但经过检查，在给定的脚本中没有明显发现这样的代码。但是仍然存在一定几率payload被替换成其他的恶意代码. 风险比例估计为5%。

**利用方式：**
1.  攻击者需要拥有ISPConfig的管理权限。
2.  需要启用`admin_allow_langedit`设置。
3.  攻击者使用`exploit.sh`脚本提供的URL、用户名和密码来利用漏洞，在目标服务器上部署webshell。
4.  攻击者通过访问webshell，执行任意系统命令。

**项目地址:** [rvizx/CVE-2023-46818](https://github.com/rvizx/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #7

**来源**: [CVE-2023-46818-vulnerk0_CVE-2023-46818.md](../2023/CVE-2023-46818-vulnerk0_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit选项开启

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-46818 漏洞存在于 ISPConfig 3.2.11p1 之前的版本中。攻击者（需要管理员权限）可以通过语言文件编辑器注入 PHP 代码。漏洞利用方式如下：

1.  **漏洞描述：**该漏洞允许经过身份验证的管理员用户，在启用了 `admin_allow_langedit` 选项的情况下，通过编辑语言文件注入恶意的 PHP 代码。
2.  **POC有效性：** 提供的 POC 代码 `exploit.py` 看起来是有效的。它首先尝试登录 ISPConfig 管理面板，然后通过编辑语言文件注入 PHP 代码，最后通过访问注入的 PHP 文件来执行任意命令。这个POC的有效性取决于目标ISPConfig实例是否满足漏洞前提条件：版本<=3.2.11，管理员权限，并且admin_allow_langedit选项被启用。
3.  **利用方式：**
    *   使用提供的用户名和密码登录 ISPConfig 管理面板。
    *   找到语言文件编辑功能，编辑一个语言文件。
    *   在语言文件中注入恶意的 PHP 代码，例如 `<?php system($_GET['cmd']); ?>`，这样可以通过 GET 请求传递命令参数来执行任意系统命令。
    *   通过访问包含恶意 PHP 代码的语言文件，执行任意命令。
4.  **投毒风险：** 查看了提供的 exploit.py 脚本和 README.md。该脚本的功能是利用 CVE-2023-46818 在 ISPConfig 系统中进行 PHP 代码注入。脚本的主要功能是：检查连接，尝试使用提供的用户名和密码登录，如果登录成功，则通过修改语言文件注入后门 PHP 代码，最后创建一个webshell，允许通过 GET 请求执行任意命令。该脚本本身没有发现明显的恶意代码，例如未经授权的数据收集、传播恶意软件等。README.md 也只包含漏洞描述和使用方法。
    因此，可以认为该仓库中存在作者隐藏的投毒代码的风险较低。


**项目地址:** [vulnerk0/CVE-2023-46818](https://github.com/vulnerk0/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #8

**来源**: [CVE-2023-46818-z7Akane_CVE-2023-46818.md](../2023/CVE-2023-46818-z7Akane_CVE-2023-46818.md)

## CVE-2023-46818 - ISPConfig PHP 代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP 代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，`admin_allow_langedit` 必须启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818 存在于 ISPConfig 3.2.11p1 之前的版本中。如果管理员启用了 `admin_allow_langedit` 选项，则攻击者（具有管理员权限）可以通过语言文件编辑器注入 PHP 代码。 

**漏洞利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的管理员凭据登录 ISPConfig 控制面板。
2.  **CSRF 令牌获取：** 利用 `language_edit.php` 页面，获取 CSRF ID 和 Key。POC脚本模拟了此过程，构造包含`lang`，`module`，`lang_file`参数的POST请求。`lang_file`参数是随机生成的，目的是创建一个新的语言文件。
3.  **代码注入：** 攻击者通过修改语言文件，将恶意的 PHP 代码注入到 `records[\]` 参数中。POC脚本中，注入的代码会将一个简单的webshell写入到 `/admin/sh.php`。
4.  **Webshell 访问：** 成功注入代码后，攻击者可以通过访问 `/admin/sh.php` 文件来执行任意命令。POC脚本通过GET请求，将需要执行的命令base64编码后放在HTTP Header `C`中传递给webshell。webshell执行命令，并将结果返回。脚本通过正则表达式提取命令执行结果。
5. **有效性：**根据漏洞库信息和搜索引擎结果，该漏洞存在且已公开。提供的POC代码也验证了该漏洞的可利用性。

**投毒风险分析：**

代码中存在投毒的风险较低，约5%。主要考虑以下几点：

*   **Base64 编码的 Payload：** Payload 使用 Base64 编码，方便审计人员进行检查。虽然攻击者可以替换Payload为恶意的代码，但是这种修改很容易被发现。
*  **对ISPConfig目录的写入操作:** 代码在`/admin/` 目录下写入webshell文件`sh.php`。该行为属于攻击行为，会触发安全警报。
*  **公开的利用方式：** 漏洞利用方式比较直接，与其他搜索结果和漏洞描述一致。没有发现隐藏的、非预期的行为。

虽然存在一些微小的风险，但综合来看，该 POC 的主要目的是验证漏洞，而不是进行恶意投毒。攻击者可以修改利用脚本来包含恶意载荷，但这不属于原始代码的投毒行为。

**项目地址:** [z7Akane/CVE-2023-46818](https://github.com/z7Akane/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #9

**来源**: [CVE-2023-46818-zs1n_CVE-2023-46818.md](../2023/CVE-2023-46818-zs1n_CVE-2023-46818.md)

# CVE-2023-46818

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-46818-SyFi_CVE-2023-46818.md](../2023/CVE-2023-46818-SyFi_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit 必须启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-46818 漏洞存在于 ISPConfig 3.2.11p1 之前的版本中。当 `admin_allow_langedit` 启用时，具有管理员权限的用户可以通过语言文件编辑器注入 PHP 代码，从而导致远程代码执行。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的管理员用户名和密码登录 ISPConfig 控制面板。
2.  **漏洞触发条件判断:** 需要`admin_allow_langedit`配置开启.
3.  **语言文件编辑：** 登录后，攻击者需要访问语言文件编辑器。
4.  **代码注入：** 在语言文件编辑器中，攻击者可以插入恶意的 PHP 代码。
5.  **代码执行：** 当 ISPConfig 执行包含恶意代码的语言文件时，攻击者注入的 PHP 代码将被执行，从而导致远程代码执行。

**POC有效性：**
提供的 Metasploit 模块利用了该漏洞，如果目标满足漏洞利用的条件（ISPConfig 版本 <= 3.2.11, 管理员权限，`admin_allow_langedit`启用），则该 POC 代码有效。

**投毒风险分析：**

通过分析提供的 POC 代码，发现其主要功能是利用漏洞进行代码注入，并创建一个反向 shell。其中存在投毒代码的可能性较低，主要是因为代码整体结构清晰，功能明确，没有发现隐藏的恶意逻辑。
`Metasploit-module/ispconfig_language_edit.rb` 代码的功能是构造恶意请求，向目标服务器发送包含 PHP 代码的payload。该payload 会执行反向连接，获取shell。虽然代码本身不包含恶意逻辑，但攻击者可以使用该模块执行任意命令，存在一定风险。但是根据代码逻辑和模块用途来判断，其目的就是为了漏洞利用，所以不能完全确定存在投毒风险。

**风险评估：**

尽管代码本身没有明显的投毒迹象，但考虑到其漏洞利用的性质，攻击者可以利用该模块进行恶意活动。因此，建议在使用该模块时，对代码进行仔细审查，并仅在授权的渗透测试环境中使用。

**投毒百分比评估：**

由于 POC 代码的主要功能是漏洞利用，没有明显的投毒行为，所以判定投毒风险较低，大约为 10%。 这个风险主要来自于使用者可能会修改payload为恶意脚本,或者作者后期更新版本,添加恶意功能。

**项目地址:** [SyFi/CVE-2023-46818](https://github.com/SyFi/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #2

**来源**: [CVE-2023-46818-ajdumanhug_CVE-2023-46818.md](../2023/CVE-2023-46818-ajdumanhug_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，允许管理员注入并执行任意PHP代码，可能导致服务器完全控制

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，并且`admin_allow_langedit`选项已启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11及更早版本中的一个PHP代码注入漏洞。利用此漏洞，需要满足以下条件：

1.  **管理员权限：** 攻击者必须拥有ISPConfig的管理员账户。
2.  **`admin_allow_langedit`启用：**  `admin_allow_langedit`配置项必须被启用。该漏洞存在于`language_edit.php`文件中，该文件用于编辑语言文件。

**利用方式：**

1.  **登录：** 使用管理员账户登录ISPConfig控制面板。
2.  **获取CSRF令牌：** 访问`language_edit.php`页面，获取CSRF ID和CSRF Key。这个步骤是为了绕过CSRF保护。
3.  **注入恶意代码：** 构造包含恶意PHP代码的请求，通过`records`参数注入，并将其发送到`language_edit.php`。POC代码使用`file_put_contents`函数将一个webshell写入到服务器上的`admin/sh.php`文件中，该webshell接收通过HTTP头`C`传递的base64编码的命令并执行。
4.  **执行命令：** 访问webshell（`admin/sh.php`），并在HTTP头`C`中传递base64编码的命令。服务器会执行该命令并将结果返回。

**关于有效性：**

根据漏洞库信息、搜索引擎结果，以及提供的漏洞利用代码，该漏洞POC代码是有效的。多个来源（NVD、Recorded Future、Sploitus等）都确认了该漏洞的存在，并且提供了利用细节。提供的Python脚本实现了漏洞利用的完整流程。

**关于投毒风险：**

评估投毒风险较低，约为5%。该Python脚本主要功能是利用已知漏洞，但仍然存在极小的潜在风险：

*   **对远程服务器造成破坏的可能性：** POC利用代码中虽然主要目标是执行命令，如果webshell被其他人利用，或者注入的Payload被修改，可能会被用于其他恶意目的，例如删除文件、篡改配置等。
*   **依赖库风险：**  脚本依赖`requests`库，虽然该库本身很常用，如果被供应链投毒，也会影响此脚本。

总体而言，该代码的目的是实现已知的漏洞利用，投毒风险较低，但仍然需要人工审核。

**项目地址:** [ajdumanhug/CVE-2023-46818](https://github.com/ajdumanhug/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #3

**来源**: [CVE-2023-46818-bipbopbup_CVE-2023-46818-python-exploit.md](../2023/CVE-2023-46818-bipbopbup_CVE-2023-46818-python-exploit.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit选项开启

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-46818是一个存在于ISPConfig 3.2.11及之前版本中的PHP代码注入漏洞。该漏洞位于language_edit.php文件中，允许具有管理员权限的用户，如果启用了`admin_allow_langedit`选项，则可以通过修改语言文件注入并执行任意PHP代码。

**漏洞利用方式：**

1.  **身份验证：** 攻击者必须首先以管理员身份登录到ISPConfig控制面板。
2.  **访问语言文件编辑器：** 登录后，攻击者需要导航到语言文件编辑器。
3.  **注入恶意PHP代码：** 攻击者通过`records` POST参数，将恶意PHP代码注入到语言文件的内容中。由于输入没有经过充分的清理，攻击者可以插入任意PHP代码。
4.  **代码执行：** 当ISPConfig加载或执行被修改的语言文件时，注入的PHP代码将被执行，从而允许攻击者在服务器上执行任意命令。

**POC代码分析：**

提供的Python POC代码自动化了漏洞利用过程。它执行以下步骤：

1.  **登录：** 使用提供的URL、用户名和密码登录到ISPConfig。
2.  **构造Payload：** 构造包含恶意PHP代码的Payload，该代码会将一个WebShell写入到服务器上的`sh.php`文件中。
3.  **CSRF Token获取:**  获取CSRF ID和Key，绕过CSRF防御
4.  **注入代码：** 向`language_edit.php`发送包含Payload的POST请求。
5.  **启动Shell：** 连接到新创建的WebShell，允许攻击者执行任意命令。

**有效性评估：**

根据漏洞描述和POC代码，该漏洞利用是有效的。POC代码提供了一个可以直接利用该漏洞的有效方法，搜索结果也确认了该漏洞的存在以及利用的可能性。

**投毒风险评估：**

检查POC代码后，发现该代码主要功能是利用漏洞进行代码注入，在/admin/目录下写入webshell，实现远程代码执行。虽然该代码用于恶意目的，但它本身没有隐藏任何额外的、与漏洞利用无关的恶意代码。因此，投毒风险较低，约为1%。

虽然可以判定POC代码不属于投毒代码,但在实际环境中，利用此漏洞本身就是一种恶意行为，会导致服务器被完全控制。


**项目地址:** [bipbopbup/CVE-2023-46818-python-exploit](https://github.com/bipbopbup/CVE-2023-46818-python-exploit)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #4

**来源**: [CVE-2023-46818-blindma1den_CVE-2023-46818-Exploit.md](../2023/CVE-2023-46818-blindma1den_CVE-2023-46818-Exploit.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要admin_allow_langedit开启，需要管理员权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11版本及之前版本中存在的一个PHP代码注入漏洞。该漏洞允许具有管理员权限的用户，在admin_allow_langedit选项启用的情况下，通过语言文件编辑器注入恶意的PHP代码，从而导致远程代码执行。

**有效性:**
根据提供的漏洞信息、搜索结果以及漏洞利用代码，可以判断该POC代码是有效的。搜索结果中存在多个关于此漏洞的讨论和利用代码，漏洞利用代码的README也表明了该漏洞利用的成功性。POC代码通过模拟管理员登录，利用`language_edit.php`的`records[]`字段注入PHP代码，最终写入一个webshell，证明漏洞可以被成功利用。

**投毒风险:**
通过分析POC代码，投毒风险较低。代码主要功能是自动化利用漏洞，注入webshell，方便后续的远程命令执行。主要的风险点在于：

*   **Webshell：** 注入的 webshell (`sh.php`) 允许攻击者执行任意系统命令。这本身就是一种后门，但并非作者有意植入的“投毒”代码，而是漏洞利用的必然结果。
*  **依赖:** POC代码依赖requests库,如果requests库被替换成恶意版本,可能存在投毒风险, 但这个不是POC代码本身的问题.

代码中并没有发现明显的恶意行为，例如上传额外文件、修改系统配置等。因此，投毒风险主要集中在webshell本身，以及程序依赖的外部库，而不是POC代码作者有意添加的恶意代码。
综合评估，投毒风险约为5%。

**利用方式:**
1.  **身份验证:** 首先，攻击者需要拥有ISPConfig的管理员账户的有效凭据。
2.  **登录:** 使用提供的用户名和密码登录到ISPConfig管理面板。
3.  **CSRF绕过:** 获取并利用CSRF token，绕过CSRF保护。
4.  **语言文件编辑:** 访问`language_edit.php`页面，该页面允许管理员编辑语言文件。
5.  **代码注入:** 利用`records[]`参数，注入包含PHP代码的恶意payload。该payload会在服务器上创建一个webshell文件 (`sh.php`)。
6.  **webshell访问:** 攻击者可以通过访问webshell文件，执行任意系统命令。`sh.php` 接收 `C` header，对其进行base64解码后执行。
7.  **命令执行:** 通过修改header的`C`值，从而发送执行任意命令到目标服务器。命令的输出会被封装在`____`标签之间方便解析。
8.  **权限要求:** 利用此漏洞需要admin_allow_langedit开启,普通权限用户无法进行利用.

**项目地址:** [blindma1den/CVE-2023-46818-Exploit](https://github.com/blindma1den/CVE-2023-46818-Exploit)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #5

**来源**: [CVE-2023-46818-engranaabubakar_CVE-2023-46818.md](../2023/CVE-2023-46818-engranaabubakar_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit 必须启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于ISPConfig 3.2.11及更早版本的language_edit.php中。当admin_allow_langedit启用时，具有管理员权限的用户可以通过修改语言文件，利用 `records[]` 参数注入恶意的PHP代码，从而在服务器上执行任意命令。PoC利用脚本首先登录ISPConfig后台，然后通过构造包含恶意PHP代码的POST请求发送到language_edit.php，将webshell写入服务器。最后，通过webshell执行命令。投毒风险较低，主要体现在脚本在部署webshell后，交互式shell执行命令时会将响应内容与预定义的`____`标记进行比对，若输出内容不是预期格式，会输出原始响应，增加了一些分析难度。虽然有webshell上传，但是webshell的payload不是直接执行恶意代码而是创建一个命令执行的接口，给使用者更多的控制空间。

**项目地址:** [engranaabubakar/CVE-2023-46818](https://github.com/engranaabubakar/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #6

**来源**: [CVE-2023-46818-rvizx_CVE-2023-46818.md](../2023/CVE-2023-46818-rvizx_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限并启用admin_allow_langedit

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11版本及之前版本中存在的一个PHP代码注入漏洞。该漏洞允许具有管理员权限的用户，在启用了`admin_allow_langedit`设置的情况下，通过`language_edit.php`页面的`records[]`参数注入恶意的PHP代码，从而实现远程代码执行。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且已经有公开的PoC利用代码可用。该PoC的`exploit.sh`脚本通过以下步骤利用漏洞：
1.  使用提供的用户名和密码登录ISPConfig管理界面。
2.  获取CSRF令牌（`_csrf_id`和`_csrf_key`）。
3.  构造包含PHP webshell的payload，该webshell允许执行任意命令，并将其base64编码。
4.  将编码后的payload注入到`language_edit.php`的`records[]`参数中，利用PHP代码注入漏洞将webshell写入到服务器的`/admin/`目录下，命名为`sh.php`。
5.  通过访问`/admin/sh.php`，攻击者可以执行任意系统命令。

**投毒风险：**
分析`exploit.sh`脚本，存在轻微的投毒风险。该脚本在部署webshell后，会创建一个交互式shell，允许攻击者持续执行命令。虽然PoC本身的目的在于验证漏洞，但这种交互式shell如果被恶意使用，可能造成更大的危害，例如持续监视或数据窃取。另外，作者可能在脚本中嵌入隐蔽的后门代码，但经过检查，在给定的脚本中没有明显发现这样的代码。但是仍然存在一定几率payload被替换成其他的恶意代码. 风险比例估计为5%。

**利用方式：**
1.  攻击者需要拥有ISPConfig的管理权限。
2.  需要启用`admin_allow_langedit`设置。
3.  攻击者使用`exploit.sh`脚本提供的URL、用户名和密码来利用漏洞，在目标服务器上部署webshell。
4.  攻击者通过访问webshell，执行任意系统命令。

**项目地址:** [rvizx/CVE-2023-46818](https://github.com/rvizx/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #7

**来源**: [CVE-2023-46818-vulnerk0_CVE-2023-46818.md](../2023/CVE-2023-46818-vulnerk0_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit选项开启

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-46818 漏洞存在于 ISPConfig 3.2.11p1 之前的版本中。攻击者（需要管理员权限）可以通过语言文件编辑器注入 PHP 代码。漏洞利用方式如下：

1.  **漏洞描述：**该漏洞允许经过身份验证的管理员用户，在启用了 `admin_allow_langedit` 选项的情况下，通过编辑语言文件注入恶意的 PHP 代码。
2.  **POC有效性：** 提供的 POC 代码 `exploit.py` 看起来是有效的。它首先尝试登录 ISPConfig 管理面板，然后通过编辑语言文件注入 PHP 代码，最后通过访问注入的 PHP 文件来执行任意命令。这个POC的有效性取决于目标ISPConfig实例是否满足漏洞前提条件：版本<=3.2.11，管理员权限，并且admin_allow_langedit选项被启用。
3.  **利用方式：**
    *   使用提供的用户名和密码登录 ISPConfig 管理面板。
    *   找到语言文件编辑功能，编辑一个语言文件。
    *   在语言文件中注入恶意的 PHP 代码，例如 `<?php system($_GET['cmd']); ?>`，这样可以通过 GET 请求传递命令参数来执行任意系统命令。
    *   通过访问包含恶意 PHP 代码的语言文件，执行任意命令。
4.  **投毒风险：** 查看了提供的 exploit.py 脚本和 README.md。该脚本的功能是利用 CVE-2023-46818 在 ISPConfig 系统中进行 PHP 代码注入。脚本的主要功能是：检查连接，尝试使用提供的用户名和密码登录，如果登录成功，则通过修改语言文件注入后门 PHP 代码，最后创建一个webshell，允许通过 GET 请求执行任意命令。该脚本本身没有发现明显的恶意代码，例如未经授权的数据收集、传播恶意软件等。README.md 也只包含漏洞描述和使用方法。
    因此，可以认为该仓库中存在作者隐藏的投毒代码的风险较低。


**项目地址:** [vulnerk0/CVE-2023-46818](https://github.com/vulnerk0/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #8

**来源**: [CVE-2023-46818-z7Akane_CVE-2023-46818.md](../2023/CVE-2023-46818-z7Akane_CVE-2023-46818.md)

## CVE-2023-46818 - ISPConfig PHP 代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP 代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，`admin_allow_langedit` 必须启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818 存在于 ISPConfig 3.2.11p1 之前的版本中。如果管理员启用了 `admin_allow_langedit` 选项，则攻击者（具有管理员权限）可以通过语言文件编辑器注入 PHP 代码。 

**漏洞利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的管理员凭据登录 ISPConfig 控制面板。
2.  **CSRF 令牌获取：** 利用 `language_edit.php` 页面，获取 CSRF ID 和 Key。POC脚本模拟了此过程，构造包含`lang`，`module`，`lang_file`参数的POST请求。`lang_file`参数是随机生成的，目的是创建一个新的语言文件。
3.  **代码注入：** 攻击者通过修改语言文件，将恶意的 PHP 代码注入到 `records[\]` 参数中。POC脚本中，注入的代码会将一个简单的webshell写入到 `/admin/sh.php`。
4.  **Webshell 访问：** 成功注入代码后，攻击者可以通过访问 `/admin/sh.php` 文件来执行任意命令。POC脚本通过GET请求，将需要执行的命令base64编码后放在HTTP Header `C`中传递给webshell。webshell执行命令，并将结果返回。脚本通过正则表达式提取命令执行结果。
5. **有效性：**根据漏洞库信息和搜索引擎结果，该漏洞存在且已公开。提供的POC代码也验证了该漏洞的可利用性。

**投毒风险分析：**

代码中存在投毒的风险较低，约5%。主要考虑以下几点：

*   **Base64 编码的 Payload：** Payload 使用 Base64 编码，方便审计人员进行检查。虽然攻击者可以替换Payload为恶意的代码，但是这种修改很容易被发现。
*  **对ISPConfig目录的写入操作:** 代码在`/admin/` 目录下写入webshell文件`sh.php`。该行为属于攻击行为，会触发安全警报。
*  **公开的利用方式：** 漏洞利用方式比较直接，与其他搜索结果和漏洞描述一致。没有发现隐藏的、非预期的行为。

虽然存在一些微小的风险，但综合来看，该 POC 的主要目的是验证漏洞，而不是进行恶意投毒。攻击者可以修改利用脚本来包含恶意载荷，但这不属于原始代码的投毒行为。

**项目地址:** [z7Akane/CVE-2023-46818](https://github.com/z7Akane/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #9

**来源**: [CVE-2023-46818-zs1n_CVE-2023-46818.md](../2023/CVE-2023-46818-zs1n_CVE-2023-46818.md)

# CVE-2023-46818

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-46818-SyFi_CVE-2023-46818.md](../2023/CVE-2023-46818-SyFi_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit 必须启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-46818 漏洞存在于 ISPConfig 3.2.11p1 之前的版本中。当 `admin_allow_langedit` 启用时，具有管理员权限的用户可以通过语言文件编辑器注入 PHP 代码，从而导致远程代码执行。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的管理员用户名和密码登录 ISPConfig 控制面板。
2.  **漏洞触发条件判断:** 需要`admin_allow_langedit`配置开启.
3.  **语言文件编辑：** 登录后，攻击者需要访问语言文件编辑器。
4.  **代码注入：** 在语言文件编辑器中，攻击者可以插入恶意的 PHP 代码。
5.  **代码执行：** 当 ISPConfig 执行包含恶意代码的语言文件时，攻击者注入的 PHP 代码将被执行，从而导致远程代码执行。

**POC有效性：**
提供的 Metasploit 模块利用了该漏洞，如果目标满足漏洞利用的条件（ISPConfig 版本 <= 3.2.11, 管理员权限，`admin_allow_langedit`启用），则该 POC 代码有效。

**投毒风险分析：**

通过分析提供的 POC 代码，发现其主要功能是利用漏洞进行代码注入，并创建一个反向 shell。其中存在投毒代码的可能性较低，主要是因为代码整体结构清晰，功能明确，没有发现隐藏的恶意逻辑。
`Metasploit-module/ispconfig_language_edit.rb` 代码的功能是构造恶意请求，向目标服务器发送包含 PHP 代码的payload。该payload 会执行反向连接，获取shell。虽然代码本身不包含恶意逻辑，但攻击者可以使用该模块执行任意命令，存在一定风险。但是根据代码逻辑和模块用途来判断，其目的就是为了漏洞利用，所以不能完全确定存在投毒风险。

**风险评估：**

尽管代码本身没有明显的投毒迹象，但考虑到其漏洞利用的性质，攻击者可以利用该模块进行恶意活动。因此，建议在使用该模块时，对代码进行仔细审查，并仅在授权的渗透测试环境中使用。

**投毒百分比评估：**

由于 POC 代码的主要功能是漏洞利用，没有明显的投毒行为，所以判定投毒风险较低，大约为 10%。 这个风险主要来自于使用者可能会修改payload为恶意脚本,或者作者后期更新版本,添加恶意功能。

**项目地址:** [SyFi/CVE-2023-46818](https://github.com/SyFi/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #2

**来源**: [CVE-2023-46818-ajdumanhug_CVE-2023-46818.md](../2023/CVE-2023-46818-ajdumanhug_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，允许管理员注入并执行任意PHP代码，可能导致服务器完全控制

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，并且`admin_allow_langedit`选项已启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11及更早版本中的一个PHP代码注入漏洞。利用此漏洞，需要满足以下条件：

1.  **管理员权限：** 攻击者必须拥有ISPConfig的管理员账户。
2.  **`admin_allow_langedit`启用：**  `admin_allow_langedit`配置项必须被启用。该漏洞存在于`language_edit.php`文件中，该文件用于编辑语言文件。

**利用方式：**

1.  **登录：** 使用管理员账户登录ISPConfig控制面板。
2.  **获取CSRF令牌：** 访问`language_edit.php`页面，获取CSRF ID和CSRF Key。这个步骤是为了绕过CSRF保护。
3.  **注入恶意代码：** 构造包含恶意PHP代码的请求，通过`records`参数注入，并将其发送到`language_edit.php`。POC代码使用`file_put_contents`函数将一个webshell写入到服务器上的`admin/sh.php`文件中，该webshell接收通过HTTP头`C`传递的base64编码的命令并执行。
4.  **执行命令：** 访问webshell（`admin/sh.php`），并在HTTP头`C`中传递base64编码的命令。服务器会执行该命令并将结果返回。

**关于有效性：**

根据漏洞库信息、搜索引擎结果，以及提供的漏洞利用代码，该漏洞POC代码是有效的。多个来源（NVD、Recorded Future、Sploitus等）都确认了该漏洞的存在，并且提供了利用细节。提供的Python脚本实现了漏洞利用的完整流程。

**关于投毒风险：**

评估投毒风险较低，约为5%。该Python脚本主要功能是利用已知漏洞，但仍然存在极小的潜在风险：

*   **对远程服务器造成破坏的可能性：** POC利用代码中虽然主要目标是执行命令，如果webshell被其他人利用，或者注入的Payload被修改，可能会被用于其他恶意目的，例如删除文件、篡改配置等。
*   **依赖库风险：**  脚本依赖`requests`库，虽然该库本身很常用，如果被供应链投毒，也会影响此脚本。

总体而言，该代码的目的是实现已知的漏洞利用，投毒风险较低，但仍然需要人工审核。

**项目地址:** [ajdumanhug/CVE-2023-46818](https://github.com/ajdumanhug/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #3

**来源**: [CVE-2023-46818-bipbopbup_CVE-2023-46818-python-exploit.md](../2023/CVE-2023-46818-bipbopbup_CVE-2023-46818-python-exploit.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit选项开启

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-46818是一个存在于ISPConfig 3.2.11及之前版本中的PHP代码注入漏洞。该漏洞位于language_edit.php文件中，允许具有管理员权限的用户，如果启用了`admin_allow_langedit`选项，则可以通过修改语言文件注入并执行任意PHP代码。

**漏洞利用方式：**

1.  **身份验证：** 攻击者必须首先以管理员身份登录到ISPConfig控制面板。
2.  **访问语言文件编辑器：** 登录后，攻击者需要导航到语言文件编辑器。
3.  **注入恶意PHP代码：** 攻击者通过`records` POST参数，将恶意PHP代码注入到语言文件的内容中。由于输入没有经过充分的清理，攻击者可以插入任意PHP代码。
4.  **代码执行：** 当ISPConfig加载或执行被修改的语言文件时，注入的PHP代码将被执行，从而允许攻击者在服务器上执行任意命令。

**POC代码分析：**

提供的Python POC代码自动化了漏洞利用过程。它执行以下步骤：

1.  **登录：** 使用提供的URL、用户名和密码登录到ISPConfig。
2.  **构造Payload：** 构造包含恶意PHP代码的Payload，该代码会将一个WebShell写入到服务器上的`sh.php`文件中。
3.  **CSRF Token获取:**  获取CSRF ID和Key，绕过CSRF防御
4.  **注入代码：** 向`language_edit.php`发送包含Payload的POST请求。
5.  **启动Shell：** 连接到新创建的WebShell，允许攻击者执行任意命令。

**有效性评估：**

根据漏洞描述和POC代码，该漏洞利用是有效的。POC代码提供了一个可以直接利用该漏洞的有效方法，搜索结果也确认了该漏洞的存在以及利用的可能性。

**投毒风险评估：**

检查POC代码后，发现该代码主要功能是利用漏洞进行代码注入，在/admin/目录下写入webshell，实现远程代码执行。虽然该代码用于恶意目的，但它本身没有隐藏任何额外的、与漏洞利用无关的恶意代码。因此，投毒风险较低，约为1%。

虽然可以判定POC代码不属于投毒代码,但在实际环境中，利用此漏洞本身就是一种恶意行为，会导致服务器被完全控制。


**项目地址:** [bipbopbup/CVE-2023-46818-python-exploit](https://github.com/bipbopbup/CVE-2023-46818-python-exploit)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #4

**来源**: [CVE-2023-46818-blindma1den_CVE-2023-46818-Exploit.md](../2023/CVE-2023-46818-blindma1den_CVE-2023-46818-Exploit.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要admin_allow_langedit开启，需要管理员权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11版本及之前版本中存在的一个PHP代码注入漏洞。该漏洞允许具有管理员权限的用户，在admin_allow_langedit选项启用的情况下，通过语言文件编辑器注入恶意的PHP代码，从而导致远程代码执行。

**有效性:**
根据提供的漏洞信息、搜索结果以及漏洞利用代码，可以判断该POC代码是有效的。搜索结果中存在多个关于此漏洞的讨论和利用代码，漏洞利用代码的README也表明了该漏洞利用的成功性。POC代码通过模拟管理员登录，利用`language_edit.php`的`records[]`字段注入PHP代码，最终写入一个webshell，证明漏洞可以被成功利用。

**投毒风险:**
通过分析POC代码，投毒风险较低。代码主要功能是自动化利用漏洞，注入webshell，方便后续的远程命令执行。主要的风险点在于：

*   **Webshell：** 注入的 webshell (`sh.php`) 允许攻击者执行任意系统命令。这本身就是一种后门，但并非作者有意植入的“投毒”代码，而是漏洞利用的必然结果。
*  **依赖:** POC代码依赖requests库,如果requests库被替换成恶意版本,可能存在投毒风险, 但这个不是POC代码本身的问题.

代码中并没有发现明显的恶意行为，例如上传额外文件、修改系统配置等。因此，投毒风险主要集中在webshell本身，以及程序依赖的外部库，而不是POC代码作者有意添加的恶意代码。
综合评估，投毒风险约为5%。

**利用方式:**
1.  **身份验证:** 首先，攻击者需要拥有ISPConfig的管理员账户的有效凭据。
2.  **登录:** 使用提供的用户名和密码登录到ISPConfig管理面板。
3.  **CSRF绕过:** 获取并利用CSRF token，绕过CSRF保护。
4.  **语言文件编辑:** 访问`language_edit.php`页面，该页面允许管理员编辑语言文件。
5.  **代码注入:** 利用`records[]`参数，注入包含PHP代码的恶意payload。该payload会在服务器上创建一个webshell文件 (`sh.php`)。
6.  **webshell访问:** 攻击者可以通过访问webshell文件，执行任意系统命令。`sh.php` 接收 `C` header，对其进行base64解码后执行。
7.  **命令执行:** 通过修改header的`C`值，从而发送执行任意命令到目标服务器。命令的输出会被封装在`____`标签之间方便解析。
8.  **权限要求:** 利用此漏洞需要admin_allow_langedit开启,普通权限用户无法进行利用.

**项目地址:** [blindma1den/CVE-2023-46818-Exploit](https://github.com/blindma1den/CVE-2023-46818-Exploit)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #5

**来源**: [CVE-2023-46818-engranaabubakar_CVE-2023-46818.md](../2023/CVE-2023-46818-engranaabubakar_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit 必须启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于ISPConfig 3.2.11及更早版本的language_edit.php中。当admin_allow_langedit启用时，具有管理员权限的用户可以通过修改语言文件，利用 `records[]` 参数注入恶意的PHP代码，从而在服务器上执行任意命令。PoC利用脚本首先登录ISPConfig后台，然后通过构造包含恶意PHP代码的POST请求发送到language_edit.php，将webshell写入服务器。最后，通过webshell执行命令。投毒风险较低，主要体现在脚本在部署webshell后，交互式shell执行命令时会将响应内容与预定义的`____`标记进行比对，若输出内容不是预期格式，会输出原始响应，增加了一些分析难度。虽然有webshell上传，但是webshell的payload不是直接执行恶意代码而是创建一个命令执行的接口，给使用者更多的控制空间。

**项目地址:** [engranaabubakar/CVE-2023-46818](https://github.com/engranaabubakar/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #6

**来源**: [CVE-2023-46818-rvizx_CVE-2023-46818.md](../2023/CVE-2023-46818-rvizx_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限并启用admin_allow_langedit

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11版本及之前版本中存在的一个PHP代码注入漏洞。该漏洞允许具有管理员权限的用户，在启用了`admin_allow_langedit`设置的情况下，通过`language_edit.php`页面的`records[]`参数注入恶意的PHP代码，从而实现远程代码执行。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且已经有公开的PoC利用代码可用。该PoC的`exploit.sh`脚本通过以下步骤利用漏洞：
1.  使用提供的用户名和密码登录ISPConfig管理界面。
2.  获取CSRF令牌（`_csrf_id`和`_csrf_key`）。
3.  构造包含PHP webshell的payload，该webshell允许执行任意命令，并将其base64编码。
4.  将编码后的payload注入到`language_edit.php`的`records[]`参数中，利用PHP代码注入漏洞将webshell写入到服务器的`/admin/`目录下，命名为`sh.php`。
5.  通过访问`/admin/sh.php`，攻击者可以执行任意系统命令。

**投毒风险：**
分析`exploit.sh`脚本，存在轻微的投毒风险。该脚本在部署webshell后，会创建一个交互式shell，允许攻击者持续执行命令。虽然PoC本身的目的在于验证漏洞，但这种交互式shell如果被恶意使用，可能造成更大的危害，例如持续监视或数据窃取。另外，作者可能在脚本中嵌入隐蔽的后门代码，但经过检查，在给定的脚本中没有明显发现这样的代码。但是仍然存在一定几率payload被替换成其他的恶意代码. 风险比例估计为5%。

**利用方式：**
1.  攻击者需要拥有ISPConfig的管理权限。
2.  需要启用`admin_allow_langedit`设置。
3.  攻击者使用`exploit.sh`脚本提供的URL、用户名和密码来利用漏洞，在目标服务器上部署webshell。
4.  攻击者通过访问webshell，执行任意系统命令。

**项目地址:** [rvizx/CVE-2023-46818](https://github.com/rvizx/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #7

**来源**: [CVE-2023-46818-vulnerk0_CVE-2023-46818.md](../2023/CVE-2023-46818-vulnerk0_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit选项开启

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-46818 漏洞存在于 ISPConfig 3.2.11p1 之前的版本中。攻击者（需要管理员权限）可以通过语言文件编辑器注入 PHP 代码。漏洞利用方式如下：

1.  **漏洞描述：**该漏洞允许经过身份验证的管理员用户，在启用了 `admin_allow_langedit` 选项的情况下，通过编辑语言文件注入恶意的 PHP 代码。
2.  **POC有效性：** 提供的 POC 代码 `exploit.py` 看起来是有效的。它首先尝试登录 ISPConfig 管理面板，然后通过编辑语言文件注入 PHP 代码，最后通过访问注入的 PHP 文件来执行任意命令。这个POC的有效性取决于目标ISPConfig实例是否满足漏洞前提条件：版本<=3.2.11，管理员权限，并且admin_allow_langedit选项被启用。
3.  **利用方式：**
    *   使用提供的用户名和密码登录 ISPConfig 管理面板。
    *   找到语言文件编辑功能，编辑一个语言文件。
    *   在语言文件中注入恶意的 PHP 代码，例如 `<?php system($_GET['cmd']); ?>`，这样可以通过 GET 请求传递命令参数来执行任意系统命令。
    *   通过访问包含恶意 PHP 代码的语言文件，执行任意命令。
4.  **投毒风险：** 查看了提供的 exploit.py 脚本和 README.md。该脚本的功能是利用 CVE-2023-46818 在 ISPConfig 系统中进行 PHP 代码注入。脚本的主要功能是：检查连接，尝试使用提供的用户名和密码登录，如果登录成功，则通过修改语言文件注入后门 PHP 代码，最后创建一个webshell，允许通过 GET 请求执行任意命令。该脚本本身没有发现明显的恶意代码，例如未经授权的数据收集、传播恶意软件等。README.md 也只包含漏洞描述和使用方法。
    因此，可以认为该仓库中存在作者隐藏的投毒代码的风险较低。


**项目地址:** [vulnerk0/CVE-2023-46818](https://github.com/vulnerk0/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #8

**来源**: [CVE-2023-46818-z7Akane_CVE-2023-46818.md](../2023/CVE-2023-46818-z7Akane_CVE-2023-46818.md)

## CVE-2023-46818 - ISPConfig PHP 代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP 代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，`admin_allow_langedit` 必须启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818 存在于 ISPConfig 3.2.11p1 之前的版本中。如果管理员启用了 `admin_allow_langedit` 选项，则攻击者（具有管理员权限）可以通过语言文件编辑器注入 PHP 代码。 

**漏洞利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的管理员凭据登录 ISPConfig 控制面板。
2.  **CSRF 令牌获取：** 利用 `language_edit.php` 页面，获取 CSRF ID 和 Key。POC脚本模拟了此过程，构造包含`lang`，`module`，`lang_file`参数的POST请求。`lang_file`参数是随机生成的，目的是创建一个新的语言文件。
3.  **代码注入：** 攻击者通过修改语言文件，将恶意的 PHP 代码注入到 `records[\]` 参数中。POC脚本中，注入的代码会将一个简单的webshell写入到 `/admin/sh.php`。
4.  **Webshell 访问：** 成功注入代码后，攻击者可以通过访问 `/admin/sh.php` 文件来执行任意命令。POC脚本通过GET请求，将需要执行的命令base64编码后放在HTTP Header `C`中传递给webshell。webshell执行命令，并将结果返回。脚本通过正则表达式提取命令执行结果。
5. **有效性：**根据漏洞库信息和搜索引擎结果，该漏洞存在且已公开。提供的POC代码也验证了该漏洞的可利用性。

**投毒风险分析：**

代码中存在投毒的风险较低，约5%。主要考虑以下几点：

*   **Base64 编码的 Payload：** Payload 使用 Base64 编码，方便审计人员进行检查。虽然攻击者可以替换Payload为恶意的代码，但是这种修改很容易被发现。
*  **对ISPConfig目录的写入操作:** 代码在`/admin/` 目录下写入webshell文件`sh.php`。该行为属于攻击行为，会触发安全警报。
*  **公开的利用方式：** 漏洞利用方式比较直接，与其他搜索结果和漏洞描述一致。没有发现隐藏的、非预期的行为。

虽然存在一些微小的风险，但综合来看，该 POC 的主要目的是验证漏洞，而不是进行恶意投毒。攻击者可以修改利用脚本来包含恶意载荷，但这不属于原始代码的投毒行为。

**项目地址:** [z7Akane/CVE-2023-46818](https://github.com/z7Akane/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #9

**来源**: [CVE-2023-46818-zs1n_CVE-2023-46818.md](../2023/CVE-2023-46818-zs1n_CVE-2023-46818.md)

# CVE-2023-46818

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-46818-SyFi_CVE-2023-46818.md](../2023/CVE-2023-46818-SyFi_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit 必须启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-46818 漏洞存在于 ISPConfig 3.2.11p1 之前的版本中。当 `admin_allow_langedit` 启用时，具有管理员权限的用户可以通过语言文件编辑器注入 PHP 代码，从而导致远程代码执行。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的管理员用户名和密码登录 ISPConfig 控制面板。
2.  **漏洞触发条件判断:** 需要`admin_allow_langedit`配置开启.
3.  **语言文件编辑：** 登录后，攻击者需要访问语言文件编辑器。
4.  **代码注入：** 在语言文件编辑器中，攻击者可以插入恶意的 PHP 代码。
5.  **代码执行：** 当 ISPConfig 执行包含恶意代码的语言文件时，攻击者注入的 PHP 代码将被执行，从而导致远程代码执行。

**POC有效性：**
提供的 Metasploit 模块利用了该漏洞，如果目标满足漏洞利用的条件（ISPConfig 版本 <= 3.2.11, 管理员权限，`admin_allow_langedit`启用），则该 POC 代码有效。

**投毒风险分析：**

通过分析提供的 POC 代码，发现其主要功能是利用漏洞进行代码注入，并创建一个反向 shell。其中存在投毒代码的可能性较低，主要是因为代码整体结构清晰，功能明确，没有发现隐藏的恶意逻辑。
`Metasploit-module/ispconfig_language_edit.rb` 代码的功能是构造恶意请求，向目标服务器发送包含 PHP 代码的payload。该payload 会执行反向连接，获取shell。虽然代码本身不包含恶意逻辑，但攻击者可以使用该模块执行任意命令，存在一定风险。但是根据代码逻辑和模块用途来判断，其目的就是为了漏洞利用，所以不能完全确定存在投毒风险。

**风险评估：**

尽管代码本身没有明显的投毒迹象，但考虑到其漏洞利用的性质，攻击者可以利用该模块进行恶意活动。因此，建议在使用该模块时，对代码进行仔细审查，并仅在授权的渗透测试环境中使用。

**投毒百分比评估：**

由于 POC 代码的主要功能是漏洞利用，没有明显的投毒行为，所以判定投毒风险较低，大约为 10%。 这个风险主要来自于使用者可能会修改payload为恶意脚本,或者作者后期更新版本,添加恶意功能。

**项目地址:** [SyFi/CVE-2023-46818](https://github.com/SyFi/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #2

**来源**: [CVE-2023-46818-ajdumanhug_CVE-2023-46818.md](../2023/CVE-2023-46818-ajdumanhug_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，允许管理员注入并执行任意PHP代码，可能导致服务器完全控制

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，并且`admin_allow_langedit`选项已启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11及更早版本中的一个PHP代码注入漏洞。利用此漏洞，需要满足以下条件：

1.  **管理员权限：** 攻击者必须拥有ISPConfig的管理员账户。
2.  **`admin_allow_langedit`启用：**  `admin_allow_langedit`配置项必须被启用。该漏洞存在于`language_edit.php`文件中，该文件用于编辑语言文件。

**利用方式：**

1.  **登录：** 使用管理员账户登录ISPConfig控制面板。
2.  **获取CSRF令牌：** 访问`language_edit.php`页面，获取CSRF ID和CSRF Key。这个步骤是为了绕过CSRF保护。
3.  **注入恶意代码：** 构造包含恶意PHP代码的请求，通过`records`参数注入，并将其发送到`language_edit.php`。POC代码使用`file_put_contents`函数将一个webshell写入到服务器上的`admin/sh.php`文件中，该webshell接收通过HTTP头`C`传递的base64编码的命令并执行。
4.  **执行命令：** 访问webshell（`admin/sh.php`），并在HTTP头`C`中传递base64编码的命令。服务器会执行该命令并将结果返回。

**关于有效性：**

根据漏洞库信息、搜索引擎结果，以及提供的漏洞利用代码，该漏洞POC代码是有效的。多个来源（NVD、Recorded Future、Sploitus等）都确认了该漏洞的存在，并且提供了利用细节。提供的Python脚本实现了漏洞利用的完整流程。

**关于投毒风险：**

评估投毒风险较低，约为5%。该Python脚本主要功能是利用已知漏洞，但仍然存在极小的潜在风险：

*   **对远程服务器造成破坏的可能性：** POC利用代码中虽然主要目标是执行命令，如果webshell被其他人利用，或者注入的Payload被修改，可能会被用于其他恶意目的，例如删除文件、篡改配置等。
*   **依赖库风险：**  脚本依赖`requests`库，虽然该库本身很常用，如果被供应链投毒，也会影响此脚本。

总体而言，该代码的目的是实现已知的漏洞利用，投毒风险较低，但仍然需要人工审核。

**项目地址:** [ajdumanhug/CVE-2023-46818](https://github.com/ajdumanhug/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #3

**来源**: [CVE-2023-46818-bipbopbup_CVE-2023-46818-python-exploit.md](../2023/CVE-2023-46818-bipbopbup_CVE-2023-46818-python-exploit.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit选项开启

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-46818是一个存在于ISPConfig 3.2.11及之前版本中的PHP代码注入漏洞。该漏洞位于language_edit.php文件中，允许具有管理员权限的用户，如果启用了`admin_allow_langedit`选项，则可以通过修改语言文件注入并执行任意PHP代码。

**漏洞利用方式：**

1.  **身份验证：** 攻击者必须首先以管理员身份登录到ISPConfig控制面板。
2.  **访问语言文件编辑器：** 登录后，攻击者需要导航到语言文件编辑器。
3.  **注入恶意PHP代码：** 攻击者通过`records` POST参数，将恶意PHP代码注入到语言文件的内容中。由于输入没有经过充分的清理，攻击者可以插入任意PHP代码。
4.  **代码执行：** 当ISPConfig加载或执行被修改的语言文件时，注入的PHP代码将被执行，从而允许攻击者在服务器上执行任意命令。

**POC代码分析：**

提供的Python POC代码自动化了漏洞利用过程。它执行以下步骤：

1.  **登录：** 使用提供的URL、用户名和密码登录到ISPConfig。
2.  **构造Payload：** 构造包含恶意PHP代码的Payload，该代码会将一个WebShell写入到服务器上的`sh.php`文件中。
3.  **CSRF Token获取:**  获取CSRF ID和Key，绕过CSRF防御
4.  **注入代码：** 向`language_edit.php`发送包含Payload的POST请求。
5.  **启动Shell：** 连接到新创建的WebShell，允许攻击者执行任意命令。

**有效性评估：**

根据漏洞描述和POC代码，该漏洞利用是有效的。POC代码提供了一个可以直接利用该漏洞的有效方法，搜索结果也确认了该漏洞的存在以及利用的可能性。

**投毒风险评估：**

检查POC代码后，发现该代码主要功能是利用漏洞进行代码注入，在/admin/目录下写入webshell，实现远程代码执行。虽然该代码用于恶意目的，但它本身没有隐藏任何额外的、与漏洞利用无关的恶意代码。因此，投毒风险较低，约为1%。

虽然可以判定POC代码不属于投毒代码,但在实际环境中，利用此漏洞本身就是一种恶意行为，会导致服务器被完全控制。


**项目地址:** [bipbopbup/CVE-2023-46818-python-exploit](https://github.com/bipbopbup/CVE-2023-46818-python-exploit)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #4

**来源**: [CVE-2023-46818-blindma1den_CVE-2023-46818-Exploit.md](../2023/CVE-2023-46818-blindma1den_CVE-2023-46818-Exploit.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要admin_allow_langedit开启，需要管理员权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11版本及之前版本中存在的一个PHP代码注入漏洞。该漏洞允许具有管理员权限的用户，在admin_allow_langedit选项启用的情况下，通过语言文件编辑器注入恶意的PHP代码，从而导致远程代码执行。

**有效性:**
根据提供的漏洞信息、搜索结果以及漏洞利用代码，可以判断该POC代码是有效的。搜索结果中存在多个关于此漏洞的讨论和利用代码，漏洞利用代码的README也表明了该漏洞利用的成功性。POC代码通过模拟管理员登录，利用`language_edit.php`的`records[]`字段注入PHP代码，最终写入一个webshell，证明漏洞可以被成功利用。

**投毒风险:**
通过分析POC代码，投毒风险较低。代码主要功能是自动化利用漏洞，注入webshell，方便后续的远程命令执行。主要的风险点在于：

*   **Webshell：** 注入的 webshell (`sh.php`) 允许攻击者执行任意系统命令。这本身就是一种后门，但并非作者有意植入的“投毒”代码，而是漏洞利用的必然结果。
*  **依赖:** POC代码依赖requests库,如果requests库被替换成恶意版本,可能存在投毒风险, 但这个不是POC代码本身的问题.

代码中并没有发现明显的恶意行为，例如上传额外文件、修改系统配置等。因此，投毒风险主要集中在webshell本身，以及程序依赖的外部库，而不是POC代码作者有意添加的恶意代码。
综合评估，投毒风险约为5%。

**利用方式:**
1.  **身份验证:** 首先，攻击者需要拥有ISPConfig的管理员账户的有效凭据。
2.  **登录:** 使用提供的用户名和密码登录到ISPConfig管理面板。
3.  **CSRF绕过:** 获取并利用CSRF token，绕过CSRF保护。
4.  **语言文件编辑:** 访问`language_edit.php`页面，该页面允许管理员编辑语言文件。
5.  **代码注入:** 利用`records[]`参数，注入包含PHP代码的恶意payload。该payload会在服务器上创建一个webshell文件 (`sh.php`)。
6.  **webshell访问:** 攻击者可以通过访问webshell文件，执行任意系统命令。`sh.php` 接收 `C` header，对其进行base64解码后执行。
7.  **命令执行:** 通过修改header的`C`值，从而发送执行任意命令到目标服务器。命令的输出会被封装在`____`标签之间方便解析。
8.  **权限要求:** 利用此漏洞需要admin_allow_langedit开启,普通权限用户无法进行利用.

**项目地址:** [blindma1den/CVE-2023-46818-Exploit](https://github.com/blindma1den/CVE-2023-46818-Exploit)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #5

**来源**: [CVE-2023-46818-engranaabubakar_CVE-2023-46818.md](../2023/CVE-2023-46818-engranaabubakar_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit 必须启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于ISPConfig 3.2.11及更早版本的language_edit.php中。当admin_allow_langedit启用时，具有管理员权限的用户可以通过修改语言文件，利用 `records[]` 参数注入恶意的PHP代码，从而在服务器上执行任意命令。PoC利用脚本首先登录ISPConfig后台，然后通过构造包含恶意PHP代码的POST请求发送到language_edit.php，将webshell写入服务器。最后，通过webshell执行命令。投毒风险较低，主要体现在脚本在部署webshell后，交互式shell执行命令时会将响应内容与预定义的`____`标记进行比对，若输出内容不是预期格式，会输出原始响应，增加了一些分析难度。虽然有webshell上传，但是webshell的payload不是直接执行恶意代码而是创建一个命令执行的接口，给使用者更多的控制空间。

**项目地址:** [engranaabubakar/CVE-2023-46818](https://github.com/engranaabubakar/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #6

**来源**: [CVE-2023-46818-rvizx_CVE-2023-46818.md](../2023/CVE-2023-46818-rvizx_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限并启用admin_allow_langedit

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11版本及之前版本中存在的一个PHP代码注入漏洞。该漏洞允许具有管理员权限的用户，在启用了`admin_allow_langedit`设置的情况下，通过`language_edit.php`页面的`records[]`参数注入恶意的PHP代码，从而实现远程代码执行。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且已经有公开的PoC利用代码可用。该PoC的`exploit.sh`脚本通过以下步骤利用漏洞：
1.  使用提供的用户名和密码登录ISPConfig管理界面。
2.  获取CSRF令牌（`_csrf_id`和`_csrf_key`）。
3.  构造包含PHP webshell的payload，该webshell允许执行任意命令，并将其base64编码。
4.  将编码后的payload注入到`language_edit.php`的`records[]`参数中，利用PHP代码注入漏洞将webshell写入到服务器的`/admin/`目录下，命名为`sh.php`。
5.  通过访问`/admin/sh.php`，攻击者可以执行任意系统命令。

**投毒风险：**
分析`exploit.sh`脚本，存在轻微的投毒风险。该脚本在部署webshell后，会创建一个交互式shell，允许攻击者持续执行命令。虽然PoC本身的目的在于验证漏洞，但这种交互式shell如果被恶意使用，可能造成更大的危害，例如持续监视或数据窃取。另外，作者可能在脚本中嵌入隐蔽的后门代码，但经过检查，在给定的脚本中没有明显发现这样的代码。但是仍然存在一定几率payload被替换成其他的恶意代码. 风险比例估计为5%。

**利用方式：**
1.  攻击者需要拥有ISPConfig的管理权限。
2.  需要启用`admin_allow_langedit`设置。
3.  攻击者使用`exploit.sh`脚本提供的URL、用户名和密码来利用漏洞，在目标服务器上部署webshell。
4.  攻击者通过访问webshell，执行任意系统命令。

**项目地址:** [rvizx/CVE-2023-46818](https://github.com/rvizx/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #7

**来源**: [CVE-2023-46818-vulnerk0_CVE-2023-46818.md](../2023/CVE-2023-46818-vulnerk0_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit选项开启

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-46818 漏洞存在于 ISPConfig 3.2.11p1 之前的版本中。攻击者（需要管理员权限）可以通过语言文件编辑器注入 PHP 代码。漏洞利用方式如下：

1.  **漏洞描述：**该漏洞允许经过身份验证的管理员用户，在启用了 `admin_allow_langedit` 选项的情况下，通过编辑语言文件注入恶意的 PHP 代码。
2.  **POC有效性：** 提供的 POC 代码 `exploit.py` 看起来是有效的。它首先尝试登录 ISPConfig 管理面板，然后通过编辑语言文件注入 PHP 代码，最后通过访问注入的 PHP 文件来执行任意命令。这个POC的有效性取决于目标ISPConfig实例是否满足漏洞前提条件：版本<=3.2.11，管理员权限，并且admin_allow_langedit选项被启用。
3.  **利用方式：**
    *   使用提供的用户名和密码登录 ISPConfig 管理面板。
    *   找到语言文件编辑功能，编辑一个语言文件。
    *   在语言文件中注入恶意的 PHP 代码，例如 `<?php system($_GET['cmd']); ?>`，这样可以通过 GET 请求传递命令参数来执行任意系统命令。
    *   通过访问包含恶意 PHP 代码的语言文件，执行任意命令。
4.  **投毒风险：** 查看了提供的 exploit.py 脚本和 README.md。该脚本的功能是利用 CVE-2023-46818 在 ISPConfig 系统中进行 PHP 代码注入。脚本的主要功能是：检查连接，尝试使用提供的用户名和密码登录，如果登录成功，则通过修改语言文件注入后门 PHP 代码，最后创建一个webshell，允许通过 GET 请求执行任意命令。该脚本本身没有发现明显的恶意代码，例如未经授权的数据收集、传播恶意软件等。README.md 也只包含漏洞描述和使用方法。
    因此，可以认为该仓库中存在作者隐藏的投毒代码的风险较低。


**项目地址:** [vulnerk0/CVE-2023-46818](https://github.com/vulnerk0/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #8

**来源**: [CVE-2023-46818-z7Akane_CVE-2023-46818.md](../2023/CVE-2023-46818-z7Akane_CVE-2023-46818.md)

## CVE-2023-46818 - ISPConfig PHP 代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP 代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，`admin_allow_langedit` 必须启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818 存在于 ISPConfig 3.2.11p1 之前的版本中。如果管理员启用了 `admin_allow_langedit` 选项，则攻击者（具有管理员权限）可以通过语言文件编辑器注入 PHP 代码。 

**漏洞利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的管理员凭据登录 ISPConfig 控制面板。
2.  **CSRF 令牌获取：** 利用 `language_edit.php` 页面，获取 CSRF ID 和 Key。POC脚本模拟了此过程，构造包含`lang`，`module`，`lang_file`参数的POST请求。`lang_file`参数是随机生成的，目的是创建一个新的语言文件。
3.  **代码注入：** 攻击者通过修改语言文件，将恶意的 PHP 代码注入到 `records[\]` 参数中。POC脚本中，注入的代码会将一个简单的webshell写入到 `/admin/sh.php`。
4.  **Webshell 访问：** 成功注入代码后，攻击者可以通过访问 `/admin/sh.php` 文件来执行任意命令。POC脚本通过GET请求，将需要执行的命令base64编码后放在HTTP Header `C`中传递给webshell。webshell执行命令，并将结果返回。脚本通过正则表达式提取命令执行结果。
5. **有效性：**根据漏洞库信息和搜索引擎结果，该漏洞存在且已公开。提供的POC代码也验证了该漏洞的可利用性。

**投毒风险分析：**

代码中存在投毒的风险较低，约5%。主要考虑以下几点：

*   **Base64 编码的 Payload：** Payload 使用 Base64 编码，方便审计人员进行检查。虽然攻击者可以替换Payload为恶意的代码，但是这种修改很容易被发现。
*  **对ISPConfig目录的写入操作:** 代码在`/admin/` 目录下写入webshell文件`sh.php`。该行为属于攻击行为，会触发安全警报。
*  **公开的利用方式：** 漏洞利用方式比较直接，与其他搜索结果和漏洞描述一致。没有发现隐藏的、非预期的行为。

虽然存在一些微小的风险，但综合来看，该 POC 的主要目的是验证漏洞，而不是进行恶意投毒。攻击者可以修改利用脚本来包含恶意载荷，但这不属于原始代码的投毒行为。

**项目地址:** [z7Akane/CVE-2023-46818](https://github.com/z7Akane/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #9

**来源**: [CVE-2023-46818-zs1n_CVE-2023-46818.md](../2023/CVE-2023-46818-zs1n_CVE-2023-46818.md)

# CVE-2023-46818

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-46818-SyFi_CVE-2023-46818.md](../2023/CVE-2023-46818-SyFi_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit 必须启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-46818 漏洞存在于 ISPConfig 3.2.11p1 之前的版本中。当 `admin_allow_langedit` 启用时，具有管理员权限的用户可以通过语言文件编辑器注入 PHP 代码，从而导致远程代码执行。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的管理员用户名和密码登录 ISPConfig 控制面板。
2.  **漏洞触发条件判断:** 需要`admin_allow_langedit`配置开启.
3.  **语言文件编辑：** 登录后，攻击者需要访问语言文件编辑器。
4.  **代码注入：** 在语言文件编辑器中，攻击者可以插入恶意的 PHP 代码。
5.  **代码执行：** 当 ISPConfig 执行包含恶意代码的语言文件时，攻击者注入的 PHP 代码将被执行，从而导致远程代码执行。

**POC有效性：**
提供的 Metasploit 模块利用了该漏洞，如果目标满足漏洞利用的条件（ISPConfig 版本 <= 3.2.11, 管理员权限，`admin_allow_langedit`启用），则该 POC 代码有效。

**投毒风险分析：**

通过分析提供的 POC 代码，发现其主要功能是利用漏洞进行代码注入，并创建一个反向 shell。其中存在投毒代码的可能性较低，主要是因为代码整体结构清晰，功能明确，没有发现隐藏的恶意逻辑。
`Metasploit-module/ispconfig_language_edit.rb` 代码的功能是构造恶意请求，向目标服务器发送包含 PHP 代码的payload。该payload 会执行反向连接，获取shell。虽然代码本身不包含恶意逻辑，但攻击者可以使用该模块执行任意命令，存在一定风险。但是根据代码逻辑和模块用途来判断，其目的就是为了漏洞利用，所以不能完全确定存在投毒风险。

**风险评估：**

尽管代码本身没有明显的投毒迹象，但考虑到其漏洞利用的性质，攻击者可以利用该模块进行恶意活动。因此，建议在使用该模块时，对代码进行仔细审查，并仅在授权的渗透测试环境中使用。

**投毒百分比评估：**

由于 POC 代码的主要功能是漏洞利用，没有明显的投毒行为，所以判定投毒风险较低，大约为 10%。 这个风险主要来自于使用者可能会修改payload为恶意脚本,或者作者后期更新版本,添加恶意功能。

**项目地址:** [SyFi/CVE-2023-46818](https://github.com/SyFi/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #2

**来源**: [CVE-2023-46818-ajdumanhug_CVE-2023-46818.md](../2023/CVE-2023-46818-ajdumanhug_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，允许管理员注入并执行任意PHP代码，可能导致服务器完全控制

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，并且`admin_allow_langedit`选项已启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11及更早版本中的一个PHP代码注入漏洞。利用此漏洞，需要满足以下条件：

1.  **管理员权限：** 攻击者必须拥有ISPConfig的管理员账户。
2.  **`admin_allow_langedit`启用：**  `admin_allow_langedit`配置项必须被启用。该漏洞存在于`language_edit.php`文件中，该文件用于编辑语言文件。

**利用方式：**

1.  **登录：** 使用管理员账户登录ISPConfig控制面板。
2.  **获取CSRF令牌：** 访问`language_edit.php`页面，获取CSRF ID和CSRF Key。这个步骤是为了绕过CSRF保护。
3.  **注入恶意代码：** 构造包含恶意PHP代码的请求，通过`records`参数注入，并将其发送到`language_edit.php`。POC代码使用`file_put_contents`函数将一个webshell写入到服务器上的`admin/sh.php`文件中，该webshell接收通过HTTP头`C`传递的base64编码的命令并执行。
4.  **执行命令：** 访问webshell（`admin/sh.php`），并在HTTP头`C`中传递base64编码的命令。服务器会执行该命令并将结果返回。

**关于有效性：**

根据漏洞库信息、搜索引擎结果，以及提供的漏洞利用代码，该漏洞POC代码是有效的。多个来源（NVD、Recorded Future、Sploitus等）都确认了该漏洞的存在，并且提供了利用细节。提供的Python脚本实现了漏洞利用的完整流程。

**关于投毒风险：**

评估投毒风险较低，约为5%。该Python脚本主要功能是利用已知漏洞，但仍然存在极小的潜在风险：

*   **对远程服务器造成破坏的可能性：** POC利用代码中虽然主要目标是执行命令，如果webshell被其他人利用，或者注入的Payload被修改，可能会被用于其他恶意目的，例如删除文件、篡改配置等。
*   **依赖库风险：**  脚本依赖`requests`库，虽然该库本身很常用，如果被供应链投毒，也会影响此脚本。

总体而言，该代码的目的是实现已知的漏洞利用，投毒风险较低，但仍然需要人工审核。

**项目地址:** [ajdumanhug/CVE-2023-46818](https://github.com/ajdumanhug/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #3

**来源**: [CVE-2023-46818-bipbopbup_CVE-2023-46818-python-exploit.md](../2023/CVE-2023-46818-bipbopbup_CVE-2023-46818-python-exploit.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit选项开启

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-46818是一个存在于ISPConfig 3.2.11及之前版本中的PHP代码注入漏洞。该漏洞位于language_edit.php文件中，允许具有管理员权限的用户，如果启用了`admin_allow_langedit`选项，则可以通过修改语言文件注入并执行任意PHP代码。

**漏洞利用方式：**

1.  **身份验证：** 攻击者必须首先以管理员身份登录到ISPConfig控制面板。
2.  **访问语言文件编辑器：** 登录后，攻击者需要导航到语言文件编辑器。
3.  **注入恶意PHP代码：** 攻击者通过`records` POST参数，将恶意PHP代码注入到语言文件的内容中。由于输入没有经过充分的清理，攻击者可以插入任意PHP代码。
4.  **代码执行：** 当ISPConfig加载或执行被修改的语言文件时，注入的PHP代码将被执行，从而允许攻击者在服务器上执行任意命令。

**POC代码分析：**

提供的Python POC代码自动化了漏洞利用过程。它执行以下步骤：

1.  **登录：** 使用提供的URL、用户名和密码登录到ISPConfig。
2.  **构造Payload：** 构造包含恶意PHP代码的Payload，该代码会将一个WebShell写入到服务器上的`sh.php`文件中。
3.  **CSRF Token获取:**  获取CSRF ID和Key，绕过CSRF防御
4.  **注入代码：** 向`language_edit.php`发送包含Payload的POST请求。
5.  **启动Shell：** 连接到新创建的WebShell，允许攻击者执行任意命令。

**有效性评估：**

根据漏洞描述和POC代码，该漏洞利用是有效的。POC代码提供了一个可以直接利用该漏洞的有效方法，搜索结果也确认了该漏洞的存在以及利用的可能性。

**投毒风险评估：**

检查POC代码后，发现该代码主要功能是利用漏洞进行代码注入，在/admin/目录下写入webshell，实现远程代码执行。虽然该代码用于恶意目的，但它本身没有隐藏任何额外的、与漏洞利用无关的恶意代码。因此，投毒风险较低，约为1%。

虽然可以判定POC代码不属于投毒代码,但在实际环境中，利用此漏洞本身就是一种恶意行为，会导致服务器被完全控制。


**项目地址:** [bipbopbup/CVE-2023-46818-python-exploit](https://github.com/bipbopbup/CVE-2023-46818-python-exploit)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #4

**来源**: [CVE-2023-46818-blindma1den_CVE-2023-46818-Exploit.md](../2023/CVE-2023-46818-blindma1den_CVE-2023-46818-Exploit.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要admin_allow_langedit开启，需要管理员权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11版本及之前版本中存在的一个PHP代码注入漏洞。该漏洞允许具有管理员权限的用户，在admin_allow_langedit选项启用的情况下，通过语言文件编辑器注入恶意的PHP代码，从而导致远程代码执行。

**有效性:**
根据提供的漏洞信息、搜索结果以及漏洞利用代码，可以判断该POC代码是有效的。搜索结果中存在多个关于此漏洞的讨论和利用代码，漏洞利用代码的README也表明了该漏洞利用的成功性。POC代码通过模拟管理员登录，利用`language_edit.php`的`records[]`字段注入PHP代码，最终写入一个webshell，证明漏洞可以被成功利用。

**投毒风险:**
通过分析POC代码，投毒风险较低。代码主要功能是自动化利用漏洞，注入webshell，方便后续的远程命令执行。主要的风险点在于：

*   **Webshell：** 注入的 webshell (`sh.php`) 允许攻击者执行任意系统命令。这本身就是一种后门，但并非作者有意植入的“投毒”代码，而是漏洞利用的必然结果。
*  **依赖:** POC代码依赖requests库,如果requests库被替换成恶意版本,可能存在投毒风险, 但这个不是POC代码本身的问题.

代码中并没有发现明显的恶意行为，例如上传额外文件、修改系统配置等。因此，投毒风险主要集中在webshell本身，以及程序依赖的外部库，而不是POC代码作者有意添加的恶意代码。
综合评估，投毒风险约为5%。

**利用方式:**
1.  **身份验证:** 首先，攻击者需要拥有ISPConfig的管理员账户的有效凭据。
2.  **登录:** 使用提供的用户名和密码登录到ISPConfig管理面板。
3.  **CSRF绕过:** 获取并利用CSRF token，绕过CSRF保护。
4.  **语言文件编辑:** 访问`language_edit.php`页面，该页面允许管理员编辑语言文件。
5.  **代码注入:** 利用`records[]`参数，注入包含PHP代码的恶意payload。该payload会在服务器上创建一个webshell文件 (`sh.php`)。
6.  **webshell访问:** 攻击者可以通过访问webshell文件，执行任意系统命令。`sh.php` 接收 `C` header，对其进行base64解码后执行。
7.  **命令执行:** 通过修改header的`C`值，从而发送执行任意命令到目标服务器。命令的输出会被封装在`____`标签之间方便解析。
8.  **权限要求:** 利用此漏洞需要admin_allow_langedit开启,普通权限用户无法进行利用.

**项目地址:** [blindma1den/CVE-2023-46818-Exploit](https://github.com/blindma1den/CVE-2023-46818-Exploit)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #5

**来源**: [CVE-2023-46818-engranaabubakar_CVE-2023-46818.md](../2023/CVE-2023-46818-engranaabubakar_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit 必须启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于ISPConfig 3.2.11及更早版本的language_edit.php中。当admin_allow_langedit启用时，具有管理员权限的用户可以通过修改语言文件，利用 `records[]` 参数注入恶意的PHP代码，从而在服务器上执行任意命令。PoC利用脚本首先登录ISPConfig后台，然后通过构造包含恶意PHP代码的POST请求发送到language_edit.php，将webshell写入服务器。最后，通过webshell执行命令。投毒风险较低，主要体现在脚本在部署webshell后，交互式shell执行命令时会将响应内容与预定义的`____`标记进行比对，若输出内容不是预期格式，会输出原始响应，增加了一些分析难度。虽然有webshell上传，但是webshell的payload不是直接执行恶意代码而是创建一个命令执行的接口，给使用者更多的控制空间。

**项目地址:** [engranaabubakar/CVE-2023-46818](https://github.com/engranaabubakar/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #6

**来源**: [CVE-2023-46818-rvizx_CVE-2023-46818.md](../2023/CVE-2023-46818-rvizx_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限并启用admin_allow_langedit

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11版本及之前版本中存在的一个PHP代码注入漏洞。该漏洞允许具有管理员权限的用户，在启用了`admin_allow_langedit`设置的情况下，通过`language_edit.php`页面的`records[]`参数注入恶意的PHP代码，从而实现远程代码执行。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且已经有公开的PoC利用代码可用。该PoC的`exploit.sh`脚本通过以下步骤利用漏洞：
1.  使用提供的用户名和密码登录ISPConfig管理界面。
2.  获取CSRF令牌（`_csrf_id`和`_csrf_key`）。
3.  构造包含PHP webshell的payload，该webshell允许执行任意命令，并将其base64编码。
4.  将编码后的payload注入到`language_edit.php`的`records[]`参数中，利用PHP代码注入漏洞将webshell写入到服务器的`/admin/`目录下，命名为`sh.php`。
5.  通过访问`/admin/sh.php`，攻击者可以执行任意系统命令。

**投毒风险：**
分析`exploit.sh`脚本，存在轻微的投毒风险。该脚本在部署webshell后，会创建一个交互式shell，允许攻击者持续执行命令。虽然PoC本身的目的在于验证漏洞，但这种交互式shell如果被恶意使用，可能造成更大的危害，例如持续监视或数据窃取。另外，作者可能在脚本中嵌入隐蔽的后门代码，但经过检查，在给定的脚本中没有明显发现这样的代码。但是仍然存在一定几率payload被替换成其他的恶意代码. 风险比例估计为5%。

**利用方式：**
1.  攻击者需要拥有ISPConfig的管理权限。
2.  需要启用`admin_allow_langedit`设置。
3.  攻击者使用`exploit.sh`脚本提供的URL、用户名和密码来利用漏洞，在目标服务器上部署webshell。
4.  攻击者通过访问webshell，执行任意系统命令。

**项目地址:** [rvizx/CVE-2023-46818](https://github.com/rvizx/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #7

**来源**: [CVE-2023-46818-vulnerk0_CVE-2023-46818.md](../2023/CVE-2023-46818-vulnerk0_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit选项开启

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-46818 漏洞存在于 ISPConfig 3.2.11p1 之前的版本中。攻击者（需要管理员权限）可以通过语言文件编辑器注入 PHP 代码。漏洞利用方式如下：

1.  **漏洞描述：**该漏洞允许经过身份验证的管理员用户，在启用了 `admin_allow_langedit` 选项的情况下，通过编辑语言文件注入恶意的 PHP 代码。
2.  **POC有效性：** 提供的 POC 代码 `exploit.py` 看起来是有效的。它首先尝试登录 ISPConfig 管理面板，然后通过编辑语言文件注入 PHP 代码，最后通过访问注入的 PHP 文件来执行任意命令。这个POC的有效性取决于目标ISPConfig实例是否满足漏洞前提条件：版本<=3.2.11，管理员权限，并且admin_allow_langedit选项被启用。
3.  **利用方式：**
    *   使用提供的用户名和密码登录 ISPConfig 管理面板。
    *   找到语言文件编辑功能，编辑一个语言文件。
    *   在语言文件中注入恶意的 PHP 代码，例如 `<?php system($_GET['cmd']); ?>`，这样可以通过 GET 请求传递命令参数来执行任意系统命令。
    *   通过访问包含恶意 PHP 代码的语言文件，执行任意命令。
4.  **投毒风险：** 查看了提供的 exploit.py 脚本和 README.md。该脚本的功能是利用 CVE-2023-46818 在 ISPConfig 系统中进行 PHP 代码注入。脚本的主要功能是：检查连接，尝试使用提供的用户名和密码登录，如果登录成功，则通过修改语言文件注入后门 PHP 代码，最后创建一个webshell，允许通过 GET 请求执行任意命令。该脚本本身没有发现明显的恶意代码，例如未经授权的数据收集、传播恶意软件等。README.md 也只包含漏洞描述和使用方法。
    因此，可以认为该仓库中存在作者隐藏的投毒代码的风险较低。


**项目地址:** [vulnerk0/CVE-2023-46818](https://github.com/vulnerk0/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #8

**来源**: [CVE-2023-46818-z7Akane_CVE-2023-46818.md](../2023/CVE-2023-46818-z7Akane_CVE-2023-46818.md)

## CVE-2023-46818 - ISPConfig PHP 代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP 代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，`admin_allow_langedit` 必须启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818 存在于 ISPConfig 3.2.11p1 之前的版本中。如果管理员启用了 `admin_allow_langedit` 选项，则攻击者（具有管理员权限）可以通过语言文件编辑器注入 PHP 代码。 

**漏洞利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的管理员凭据登录 ISPConfig 控制面板。
2.  **CSRF 令牌获取：** 利用 `language_edit.php` 页面，获取 CSRF ID 和 Key。POC脚本模拟了此过程，构造包含`lang`，`module`，`lang_file`参数的POST请求。`lang_file`参数是随机生成的，目的是创建一个新的语言文件。
3.  **代码注入：** 攻击者通过修改语言文件，将恶意的 PHP 代码注入到 `records[\]` 参数中。POC脚本中，注入的代码会将一个简单的webshell写入到 `/admin/sh.php`。
4.  **Webshell 访问：** 成功注入代码后，攻击者可以通过访问 `/admin/sh.php` 文件来执行任意命令。POC脚本通过GET请求，将需要执行的命令base64编码后放在HTTP Header `C`中传递给webshell。webshell执行命令，并将结果返回。脚本通过正则表达式提取命令执行结果。
5. **有效性：**根据漏洞库信息和搜索引擎结果，该漏洞存在且已公开。提供的POC代码也验证了该漏洞的可利用性。

**投毒风险分析：**

代码中存在投毒的风险较低，约5%。主要考虑以下几点：

*   **Base64 编码的 Payload：** Payload 使用 Base64 编码，方便审计人员进行检查。虽然攻击者可以替换Payload为恶意的代码，但是这种修改很容易被发现。
*  **对ISPConfig目录的写入操作:** 代码在`/admin/` 目录下写入webshell文件`sh.php`。该行为属于攻击行为，会触发安全警报。
*  **公开的利用方式：** 漏洞利用方式比较直接，与其他搜索结果和漏洞描述一致。没有发现隐藏的、非预期的行为。

虽然存在一些微小的风险，但综合来看，该 POC 的主要目的是验证漏洞，而不是进行恶意投毒。攻击者可以修改利用脚本来包含恶意载荷，但这不属于原始代码的投毒行为。

**项目地址:** [z7Akane/CVE-2023-46818](https://github.com/z7Akane/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #9

**来源**: [CVE-2023-46818-zs1n_CVE-2023-46818.md](../2023/CVE-2023-46818-zs1n_CVE-2023-46818.md)

# CVE-2023-46818

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-46818-SyFi_CVE-2023-46818.md](../2023/CVE-2023-46818-SyFi_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit 必须启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-46818 漏洞存在于 ISPConfig 3.2.11p1 之前的版本中。当 `admin_allow_langedit` 启用时，具有管理员权限的用户可以通过语言文件编辑器注入 PHP 代码，从而导致远程代码执行。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的管理员用户名和密码登录 ISPConfig 控制面板。
2.  **漏洞触发条件判断:** 需要`admin_allow_langedit`配置开启.
3.  **语言文件编辑：** 登录后，攻击者需要访问语言文件编辑器。
4.  **代码注入：** 在语言文件编辑器中，攻击者可以插入恶意的 PHP 代码。
5.  **代码执行：** 当 ISPConfig 执行包含恶意代码的语言文件时，攻击者注入的 PHP 代码将被执行，从而导致远程代码执行。

**POC有效性：**
提供的 Metasploit 模块利用了该漏洞，如果目标满足漏洞利用的条件（ISPConfig 版本 <= 3.2.11, 管理员权限，`admin_allow_langedit`启用），则该 POC 代码有效。

**投毒风险分析：**

通过分析提供的 POC 代码，发现其主要功能是利用漏洞进行代码注入，并创建一个反向 shell。其中存在投毒代码的可能性较低，主要是因为代码整体结构清晰，功能明确，没有发现隐藏的恶意逻辑。
`Metasploit-module/ispconfig_language_edit.rb` 代码的功能是构造恶意请求，向目标服务器发送包含 PHP 代码的payload。该payload 会执行反向连接，获取shell。虽然代码本身不包含恶意逻辑，但攻击者可以使用该模块执行任意命令，存在一定风险。但是根据代码逻辑和模块用途来判断，其目的就是为了漏洞利用，所以不能完全确定存在投毒风险。

**风险评估：**

尽管代码本身没有明显的投毒迹象，但考虑到其漏洞利用的性质，攻击者可以利用该模块进行恶意活动。因此，建议在使用该模块时，对代码进行仔细审查，并仅在授权的渗透测试环境中使用。

**投毒百分比评估：**

由于 POC 代码的主要功能是漏洞利用，没有明显的投毒行为，所以判定投毒风险较低，大约为 10%。 这个风险主要来自于使用者可能会修改payload为恶意脚本,或者作者后期更新版本,添加恶意功能。

**项目地址:** [SyFi/CVE-2023-46818](https://github.com/SyFi/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #2

**来源**: [CVE-2023-46818-ajdumanhug_CVE-2023-46818.md](../2023/CVE-2023-46818-ajdumanhug_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，允许管理员注入并执行任意PHP代码，可能导致服务器完全控制

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，并且`admin_allow_langedit`选项已启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11及更早版本中的一个PHP代码注入漏洞。利用此漏洞，需要满足以下条件：

1.  **管理员权限：** 攻击者必须拥有ISPConfig的管理员账户。
2.  **`admin_allow_langedit`启用：**  `admin_allow_langedit`配置项必须被启用。该漏洞存在于`language_edit.php`文件中，该文件用于编辑语言文件。

**利用方式：**

1.  **登录：** 使用管理员账户登录ISPConfig控制面板。
2.  **获取CSRF令牌：** 访问`language_edit.php`页面，获取CSRF ID和CSRF Key。这个步骤是为了绕过CSRF保护。
3.  **注入恶意代码：** 构造包含恶意PHP代码的请求，通过`records`参数注入，并将其发送到`language_edit.php`。POC代码使用`file_put_contents`函数将一个webshell写入到服务器上的`admin/sh.php`文件中，该webshell接收通过HTTP头`C`传递的base64编码的命令并执行。
4.  **执行命令：** 访问webshell（`admin/sh.php`），并在HTTP头`C`中传递base64编码的命令。服务器会执行该命令并将结果返回。

**关于有效性：**

根据漏洞库信息、搜索引擎结果，以及提供的漏洞利用代码，该漏洞POC代码是有效的。多个来源（NVD、Recorded Future、Sploitus等）都确认了该漏洞的存在，并且提供了利用细节。提供的Python脚本实现了漏洞利用的完整流程。

**关于投毒风险：**

评估投毒风险较低，约为5%。该Python脚本主要功能是利用已知漏洞，但仍然存在极小的潜在风险：

*   **对远程服务器造成破坏的可能性：** POC利用代码中虽然主要目标是执行命令，如果webshell被其他人利用，或者注入的Payload被修改，可能会被用于其他恶意目的，例如删除文件、篡改配置等。
*   **依赖库风险：**  脚本依赖`requests`库，虽然该库本身很常用，如果被供应链投毒，也会影响此脚本。

总体而言，该代码的目的是实现已知的漏洞利用，投毒风险较低，但仍然需要人工审核。

**项目地址:** [ajdumanhug/CVE-2023-46818](https://github.com/ajdumanhug/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #3

**来源**: [CVE-2023-46818-bipbopbup_CVE-2023-46818-python-exploit.md](../2023/CVE-2023-46818-bipbopbup_CVE-2023-46818-python-exploit.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit选项开启

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-46818是一个存在于ISPConfig 3.2.11及之前版本中的PHP代码注入漏洞。该漏洞位于language_edit.php文件中，允许具有管理员权限的用户，如果启用了`admin_allow_langedit`选项，则可以通过修改语言文件注入并执行任意PHP代码。

**漏洞利用方式：**

1.  **身份验证：** 攻击者必须首先以管理员身份登录到ISPConfig控制面板。
2.  **访问语言文件编辑器：** 登录后，攻击者需要导航到语言文件编辑器。
3.  **注入恶意PHP代码：** 攻击者通过`records` POST参数，将恶意PHP代码注入到语言文件的内容中。由于输入没有经过充分的清理，攻击者可以插入任意PHP代码。
4.  **代码执行：** 当ISPConfig加载或执行被修改的语言文件时，注入的PHP代码将被执行，从而允许攻击者在服务器上执行任意命令。

**POC代码分析：**

提供的Python POC代码自动化了漏洞利用过程。它执行以下步骤：

1.  **登录：** 使用提供的URL、用户名和密码登录到ISPConfig。
2.  **构造Payload：** 构造包含恶意PHP代码的Payload，该代码会将一个WebShell写入到服务器上的`sh.php`文件中。
3.  **CSRF Token获取:**  获取CSRF ID和Key，绕过CSRF防御
4.  **注入代码：** 向`language_edit.php`发送包含Payload的POST请求。
5.  **启动Shell：** 连接到新创建的WebShell，允许攻击者执行任意命令。

**有效性评估：**

根据漏洞描述和POC代码，该漏洞利用是有效的。POC代码提供了一个可以直接利用该漏洞的有效方法，搜索结果也确认了该漏洞的存在以及利用的可能性。

**投毒风险评估：**

检查POC代码后，发现该代码主要功能是利用漏洞进行代码注入，在/admin/目录下写入webshell，实现远程代码执行。虽然该代码用于恶意目的，但它本身没有隐藏任何额外的、与漏洞利用无关的恶意代码。因此，投毒风险较低，约为1%。

虽然可以判定POC代码不属于投毒代码,但在实际环境中，利用此漏洞本身就是一种恶意行为，会导致服务器被完全控制。


**项目地址:** [bipbopbup/CVE-2023-46818-python-exploit](https://github.com/bipbopbup/CVE-2023-46818-python-exploit)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #4

**来源**: [CVE-2023-46818-blindma1den_CVE-2023-46818-Exploit.md](../2023/CVE-2023-46818-blindma1den_CVE-2023-46818-Exploit.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要admin_allow_langedit开启，需要管理员权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11版本及之前版本中存在的一个PHP代码注入漏洞。该漏洞允许具有管理员权限的用户，在admin_allow_langedit选项启用的情况下，通过语言文件编辑器注入恶意的PHP代码，从而导致远程代码执行。

**有效性:**
根据提供的漏洞信息、搜索结果以及漏洞利用代码，可以判断该POC代码是有效的。搜索结果中存在多个关于此漏洞的讨论和利用代码，漏洞利用代码的README也表明了该漏洞利用的成功性。POC代码通过模拟管理员登录，利用`language_edit.php`的`records[]`字段注入PHP代码，最终写入一个webshell，证明漏洞可以被成功利用。

**投毒风险:**
通过分析POC代码，投毒风险较低。代码主要功能是自动化利用漏洞，注入webshell，方便后续的远程命令执行。主要的风险点在于：

*   **Webshell：** 注入的 webshell (`sh.php`) 允许攻击者执行任意系统命令。这本身就是一种后门，但并非作者有意植入的“投毒”代码，而是漏洞利用的必然结果。
*  **依赖:** POC代码依赖requests库,如果requests库被替换成恶意版本,可能存在投毒风险, 但这个不是POC代码本身的问题.

代码中并没有发现明显的恶意行为，例如上传额外文件、修改系统配置等。因此，投毒风险主要集中在webshell本身，以及程序依赖的外部库，而不是POC代码作者有意添加的恶意代码。
综合评估，投毒风险约为5%。

**利用方式:**
1.  **身份验证:** 首先，攻击者需要拥有ISPConfig的管理员账户的有效凭据。
2.  **登录:** 使用提供的用户名和密码登录到ISPConfig管理面板。
3.  **CSRF绕过:** 获取并利用CSRF token，绕过CSRF保护。
4.  **语言文件编辑:** 访问`language_edit.php`页面，该页面允许管理员编辑语言文件。
5.  **代码注入:** 利用`records[]`参数，注入包含PHP代码的恶意payload。该payload会在服务器上创建一个webshell文件 (`sh.php`)。
6.  **webshell访问:** 攻击者可以通过访问webshell文件，执行任意系统命令。`sh.php` 接收 `C` header，对其进行base64解码后执行。
7.  **命令执行:** 通过修改header的`C`值，从而发送执行任意命令到目标服务器。命令的输出会被封装在`____`标签之间方便解析。
8.  **权限要求:** 利用此漏洞需要admin_allow_langedit开启,普通权限用户无法进行利用.

**项目地址:** [blindma1den/CVE-2023-46818-Exploit](https://github.com/blindma1den/CVE-2023-46818-Exploit)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #5

**来源**: [CVE-2023-46818-engranaabubakar_CVE-2023-46818.md](../2023/CVE-2023-46818-engranaabubakar_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit 必须启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于ISPConfig 3.2.11及更早版本的language_edit.php中。当admin_allow_langedit启用时，具有管理员权限的用户可以通过修改语言文件，利用 `records[]` 参数注入恶意的PHP代码，从而在服务器上执行任意命令。PoC利用脚本首先登录ISPConfig后台，然后通过构造包含恶意PHP代码的POST请求发送到language_edit.php，将webshell写入服务器。最后，通过webshell执行命令。投毒风险较低，主要体现在脚本在部署webshell后，交互式shell执行命令时会将响应内容与预定义的`____`标记进行比对，若输出内容不是预期格式，会输出原始响应，增加了一些分析难度。虽然有webshell上传，但是webshell的payload不是直接执行恶意代码而是创建一个命令执行的接口，给使用者更多的控制空间。

**项目地址:** [engranaabubakar/CVE-2023-46818](https://github.com/engranaabubakar/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #6

**来源**: [CVE-2023-46818-rvizx_CVE-2023-46818.md](../2023/CVE-2023-46818-rvizx_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限并启用admin_allow_langedit

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11版本及之前版本中存在的一个PHP代码注入漏洞。该漏洞允许具有管理员权限的用户，在启用了`admin_allow_langedit`设置的情况下，通过`language_edit.php`页面的`records[]`参数注入恶意的PHP代码，从而实现远程代码执行。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且已经有公开的PoC利用代码可用。该PoC的`exploit.sh`脚本通过以下步骤利用漏洞：
1.  使用提供的用户名和密码登录ISPConfig管理界面。
2.  获取CSRF令牌（`_csrf_id`和`_csrf_key`）。
3.  构造包含PHP webshell的payload，该webshell允许执行任意命令，并将其base64编码。
4.  将编码后的payload注入到`language_edit.php`的`records[]`参数中，利用PHP代码注入漏洞将webshell写入到服务器的`/admin/`目录下，命名为`sh.php`。
5.  通过访问`/admin/sh.php`，攻击者可以执行任意系统命令。

**投毒风险：**
分析`exploit.sh`脚本，存在轻微的投毒风险。该脚本在部署webshell后，会创建一个交互式shell，允许攻击者持续执行命令。虽然PoC本身的目的在于验证漏洞，但这种交互式shell如果被恶意使用，可能造成更大的危害，例如持续监视或数据窃取。另外，作者可能在脚本中嵌入隐蔽的后门代码，但经过检查，在给定的脚本中没有明显发现这样的代码。但是仍然存在一定几率payload被替换成其他的恶意代码. 风险比例估计为5%。

**利用方式：**
1.  攻击者需要拥有ISPConfig的管理权限。
2.  需要启用`admin_allow_langedit`设置。
3.  攻击者使用`exploit.sh`脚本提供的URL、用户名和密码来利用漏洞，在目标服务器上部署webshell。
4.  攻击者通过访问webshell，执行任意系统命令。

**项目地址:** [rvizx/CVE-2023-46818](https://github.com/rvizx/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #7

**来源**: [CVE-2023-46818-vulnerk0_CVE-2023-46818.md](../2023/CVE-2023-46818-vulnerk0_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit选项开启

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-46818 漏洞存在于 ISPConfig 3.2.11p1 之前的版本中。攻击者（需要管理员权限）可以通过语言文件编辑器注入 PHP 代码。漏洞利用方式如下：

1.  **漏洞描述：**该漏洞允许经过身份验证的管理员用户，在启用了 `admin_allow_langedit` 选项的情况下，通过编辑语言文件注入恶意的 PHP 代码。
2.  **POC有效性：** 提供的 POC 代码 `exploit.py` 看起来是有效的。它首先尝试登录 ISPConfig 管理面板，然后通过编辑语言文件注入 PHP 代码，最后通过访问注入的 PHP 文件来执行任意命令。这个POC的有效性取决于目标ISPConfig实例是否满足漏洞前提条件：版本<=3.2.11，管理员权限，并且admin_allow_langedit选项被启用。
3.  **利用方式：**
    *   使用提供的用户名和密码登录 ISPConfig 管理面板。
    *   找到语言文件编辑功能，编辑一个语言文件。
    *   在语言文件中注入恶意的 PHP 代码，例如 `<?php system($_GET['cmd']); ?>`，这样可以通过 GET 请求传递命令参数来执行任意系统命令。
    *   通过访问包含恶意 PHP 代码的语言文件，执行任意命令。
4.  **投毒风险：** 查看了提供的 exploit.py 脚本和 README.md。该脚本的功能是利用 CVE-2023-46818 在 ISPConfig 系统中进行 PHP 代码注入。脚本的主要功能是：检查连接，尝试使用提供的用户名和密码登录，如果登录成功，则通过修改语言文件注入后门 PHP 代码，最后创建一个webshell，允许通过 GET 请求执行任意命令。该脚本本身没有发现明显的恶意代码，例如未经授权的数据收集、传播恶意软件等。README.md 也只包含漏洞描述和使用方法。
    因此，可以认为该仓库中存在作者隐藏的投毒代码的风险较低。


**项目地址:** [vulnerk0/CVE-2023-46818](https://github.com/vulnerk0/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #8

**来源**: [CVE-2023-46818-z7Akane_CVE-2023-46818.md](../2023/CVE-2023-46818-z7Akane_CVE-2023-46818.md)

## CVE-2023-46818 - ISPConfig PHP 代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP 代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，`admin_allow_langedit` 必须启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818 存在于 ISPConfig 3.2.11p1 之前的版本中。如果管理员启用了 `admin_allow_langedit` 选项，则攻击者（具有管理员权限）可以通过语言文件编辑器注入 PHP 代码。 

**漏洞利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的管理员凭据登录 ISPConfig 控制面板。
2.  **CSRF 令牌获取：** 利用 `language_edit.php` 页面，获取 CSRF ID 和 Key。POC脚本模拟了此过程，构造包含`lang`，`module`，`lang_file`参数的POST请求。`lang_file`参数是随机生成的，目的是创建一个新的语言文件。
3.  **代码注入：** 攻击者通过修改语言文件，将恶意的 PHP 代码注入到 `records[\]` 参数中。POC脚本中，注入的代码会将一个简单的webshell写入到 `/admin/sh.php`。
4.  **Webshell 访问：** 成功注入代码后，攻击者可以通过访问 `/admin/sh.php` 文件来执行任意命令。POC脚本通过GET请求，将需要执行的命令base64编码后放在HTTP Header `C`中传递给webshell。webshell执行命令，并将结果返回。脚本通过正则表达式提取命令执行结果。
5. **有效性：**根据漏洞库信息和搜索引擎结果，该漏洞存在且已公开。提供的POC代码也验证了该漏洞的可利用性。

**投毒风险分析：**

代码中存在投毒的风险较低，约5%。主要考虑以下几点：

*   **Base64 编码的 Payload：** Payload 使用 Base64 编码，方便审计人员进行检查。虽然攻击者可以替换Payload为恶意的代码，但是这种修改很容易被发现。
*  **对ISPConfig目录的写入操作:** 代码在`/admin/` 目录下写入webshell文件`sh.php`。该行为属于攻击行为，会触发安全警报。
*  **公开的利用方式：** 漏洞利用方式比较直接，与其他搜索结果和漏洞描述一致。没有发现隐藏的、非预期的行为。

虽然存在一些微小的风险，但综合来看，该 POC 的主要目的是验证漏洞，而不是进行恶意投毒。攻击者可以修改利用脚本来包含恶意载荷，但这不属于原始代码的投毒行为。

**项目地址:** [z7Akane/CVE-2023-46818](https://github.com/z7Akane/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #9

**来源**: [CVE-2023-46818-zs1n_CVE-2023-46818.md](../2023/CVE-2023-46818-zs1n_CVE-2023-46818.md)

# CVE-2023-46818

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-46818-SyFi_CVE-2023-46818.md](../2023/CVE-2023-46818-SyFi_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit 必须启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-46818 漏洞存在于 ISPConfig 3.2.11p1 之前的版本中。当 `admin_allow_langedit` 启用时，具有管理员权限的用户可以通过语言文件编辑器注入 PHP 代码，从而导致远程代码执行。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的管理员用户名和密码登录 ISPConfig 控制面板。
2.  **漏洞触发条件判断:** 需要`admin_allow_langedit`配置开启.
3.  **语言文件编辑：** 登录后，攻击者需要访问语言文件编辑器。
4.  **代码注入：** 在语言文件编辑器中，攻击者可以插入恶意的 PHP 代码。
5.  **代码执行：** 当 ISPConfig 执行包含恶意代码的语言文件时，攻击者注入的 PHP 代码将被执行，从而导致远程代码执行。

**POC有效性：**
提供的 Metasploit 模块利用了该漏洞，如果目标满足漏洞利用的条件（ISPConfig 版本 <= 3.2.11, 管理员权限，`admin_allow_langedit`启用），则该 POC 代码有效。

**投毒风险分析：**

通过分析提供的 POC 代码，发现其主要功能是利用漏洞进行代码注入，并创建一个反向 shell。其中存在投毒代码的可能性较低，主要是因为代码整体结构清晰，功能明确，没有发现隐藏的恶意逻辑。
`Metasploit-module/ispconfig_language_edit.rb` 代码的功能是构造恶意请求，向目标服务器发送包含 PHP 代码的payload。该payload 会执行反向连接，获取shell。虽然代码本身不包含恶意逻辑，但攻击者可以使用该模块执行任意命令，存在一定风险。但是根据代码逻辑和模块用途来判断，其目的就是为了漏洞利用，所以不能完全确定存在投毒风险。

**风险评估：**

尽管代码本身没有明显的投毒迹象，但考虑到其漏洞利用的性质，攻击者可以利用该模块进行恶意活动。因此，建议在使用该模块时，对代码进行仔细审查，并仅在授权的渗透测试环境中使用。

**投毒百分比评估：**

由于 POC 代码的主要功能是漏洞利用，没有明显的投毒行为，所以判定投毒风险较低，大约为 10%。 这个风险主要来自于使用者可能会修改payload为恶意脚本,或者作者后期更新版本,添加恶意功能。

**项目地址:** [SyFi/CVE-2023-46818](https://github.com/SyFi/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #2

**来源**: [CVE-2023-46818-ajdumanhug_CVE-2023-46818.md](../2023/CVE-2023-46818-ajdumanhug_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，允许管理员注入并执行任意PHP代码，可能导致服务器完全控制

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，并且`admin_allow_langedit`选项已启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11及更早版本中的一个PHP代码注入漏洞。利用此漏洞，需要满足以下条件：

1.  **管理员权限：** 攻击者必须拥有ISPConfig的管理员账户。
2.  **`admin_allow_langedit`启用：**  `admin_allow_langedit`配置项必须被启用。该漏洞存在于`language_edit.php`文件中，该文件用于编辑语言文件。

**利用方式：**

1.  **登录：** 使用管理员账户登录ISPConfig控制面板。
2.  **获取CSRF令牌：** 访问`language_edit.php`页面，获取CSRF ID和CSRF Key。这个步骤是为了绕过CSRF保护。
3.  **注入恶意代码：** 构造包含恶意PHP代码的请求，通过`records`参数注入，并将其发送到`language_edit.php`。POC代码使用`file_put_contents`函数将一个webshell写入到服务器上的`admin/sh.php`文件中，该webshell接收通过HTTP头`C`传递的base64编码的命令并执行。
4.  **执行命令：** 访问webshell（`admin/sh.php`），并在HTTP头`C`中传递base64编码的命令。服务器会执行该命令并将结果返回。

**关于有效性：**

根据漏洞库信息、搜索引擎结果，以及提供的漏洞利用代码，该漏洞POC代码是有效的。多个来源（NVD、Recorded Future、Sploitus等）都确认了该漏洞的存在，并且提供了利用细节。提供的Python脚本实现了漏洞利用的完整流程。

**关于投毒风险：**

评估投毒风险较低，约为5%。该Python脚本主要功能是利用已知漏洞，但仍然存在极小的潜在风险：

*   **对远程服务器造成破坏的可能性：** POC利用代码中虽然主要目标是执行命令，如果webshell被其他人利用，或者注入的Payload被修改，可能会被用于其他恶意目的，例如删除文件、篡改配置等。
*   **依赖库风险：**  脚本依赖`requests`库，虽然该库本身很常用，如果被供应链投毒，也会影响此脚本。

总体而言，该代码的目的是实现已知的漏洞利用，投毒风险较低，但仍然需要人工审核。

**项目地址:** [ajdumanhug/CVE-2023-46818](https://github.com/ajdumanhug/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #3

**来源**: [CVE-2023-46818-bipbopbup_CVE-2023-46818-python-exploit.md](../2023/CVE-2023-46818-bipbopbup_CVE-2023-46818-python-exploit.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit选项开启

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-46818是一个存在于ISPConfig 3.2.11及之前版本中的PHP代码注入漏洞。该漏洞位于language_edit.php文件中，允许具有管理员权限的用户，如果启用了`admin_allow_langedit`选项，则可以通过修改语言文件注入并执行任意PHP代码。

**漏洞利用方式：**

1.  **身份验证：** 攻击者必须首先以管理员身份登录到ISPConfig控制面板。
2.  **访问语言文件编辑器：** 登录后，攻击者需要导航到语言文件编辑器。
3.  **注入恶意PHP代码：** 攻击者通过`records` POST参数，将恶意PHP代码注入到语言文件的内容中。由于输入没有经过充分的清理，攻击者可以插入任意PHP代码。
4.  **代码执行：** 当ISPConfig加载或执行被修改的语言文件时，注入的PHP代码将被执行，从而允许攻击者在服务器上执行任意命令。

**POC代码分析：**

提供的Python POC代码自动化了漏洞利用过程。它执行以下步骤：

1.  **登录：** 使用提供的URL、用户名和密码登录到ISPConfig。
2.  **构造Payload：** 构造包含恶意PHP代码的Payload，该代码会将一个WebShell写入到服务器上的`sh.php`文件中。
3.  **CSRF Token获取:**  获取CSRF ID和Key，绕过CSRF防御
4.  **注入代码：** 向`language_edit.php`发送包含Payload的POST请求。
5.  **启动Shell：** 连接到新创建的WebShell，允许攻击者执行任意命令。

**有效性评估：**

根据漏洞描述和POC代码，该漏洞利用是有效的。POC代码提供了一个可以直接利用该漏洞的有效方法，搜索结果也确认了该漏洞的存在以及利用的可能性。

**投毒风险评估：**

检查POC代码后，发现该代码主要功能是利用漏洞进行代码注入，在/admin/目录下写入webshell，实现远程代码执行。虽然该代码用于恶意目的，但它本身没有隐藏任何额外的、与漏洞利用无关的恶意代码。因此，投毒风险较低，约为1%。

虽然可以判定POC代码不属于投毒代码,但在实际环境中，利用此漏洞本身就是一种恶意行为，会导致服务器被完全控制。


**项目地址:** [bipbopbup/CVE-2023-46818-python-exploit](https://github.com/bipbopbup/CVE-2023-46818-python-exploit)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #4

**来源**: [CVE-2023-46818-blindma1den_CVE-2023-46818-Exploit.md](../2023/CVE-2023-46818-blindma1den_CVE-2023-46818-Exploit.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要admin_allow_langedit开启，需要管理员权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11版本及之前版本中存在的一个PHP代码注入漏洞。该漏洞允许具有管理员权限的用户，在admin_allow_langedit选项启用的情况下，通过语言文件编辑器注入恶意的PHP代码，从而导致远程代码执行。

**有效性:**
根据提供的漏洞信息、搜索结果以及漏洞利用代码，可以判断该POC代码是有效的。搜索结果中存在多个关于此漏洞的讨论和利用代码，漏洞利用代码的README也表明了该漏洞利用的成功性。POC代码通过模拟管理员登录，利用`language_edit.php`的`records[]`字段注入PHP代码，最终写入一个webshell，证明漏洞可以被成功利用。

**投毒风险:**
通过分析POC代码，投毒风险较低。代码主要功能是自动化利用漏洞，注入webshell，方便后续的远程命令执行。主要的风险点在于：

*   **Webshell：** 注入的 webshell (`sh.php`) 允许攻击者执行任意系统命令。这本身就是一种后门，但并非作者有意植入的“投毒”代码，而是漏洞利用的必然结果。
*  **依赖:** POC代码依赖requests库,如果requests库被替换成恶意版本,可能存在投毒风险, 但这个不是POC代码本身的问题.

代码中并没有发现明显的恶意行为，例如上传额外文件、修改系统配置等。因此，投毒风险主要集中在webshell本身，以及程序依赖的外部库，而不是POC代码作者有意添加的恶意代码。
综合评估，投毒风险约为5%。

**利用方式:**
1.  **身份验证:** 首先，攻击者需要拥有ISPConfig的管理员账户的有效凭据。
2.  **登录:** 使用提供的用户名和密码登录到ISPConfig管理面板。
3.  **CSRF绕过:** 获取并利用CSRF token，绕过CSRF保护。
4.  **语言文件编辑:** 访问`language_edit.php`页面，该页面允许管理员编辑语言文件。
5.  **代码注入:** 利用`records[]`参数，注入包含PHP代码的恶意payload。该payload会在服务器上创建一个webshell文件 (`sh.php`)。
6.  **webshell访问:** 攻击者可以通过访问webshell文件，执行任意系统命令。`sh.php` 接收 `C` header，对其进行base64解码后执行。
7.  **命令执行:** 通过修改header的`C`值，从而发送执行任意命令到目标服务器。命令的输出会被封装在`____`标签之间方便解析。
8.  **权限要求:** 利用此漏洞需要admin_allow_langedit开启,普通权限用户无法进行利用.

**项目地址:** [blindma1den/CVE-2023-46818-Exploit](https://github.com/blindma1den/CVE-2023-46818-Exploit)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #5

**来源**: [CVE-2023-46818-engranaabubakar_CVE-2023-46818.md](../2023/CVE-2023-46818-engranaabubakar_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit 必须启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于ISPConfig 3.2.11及更早版本的language_edit.php中。当admin_allow_langedit启用时，具有管理员权限的用户可以通过修改语言文件，利用 `records[]` 参数注入恶意的PHP代码，从而在服务器上执行任意命令。PoC利用脚本首先登录ISPConfig后台，然后通过构造包含恶意PHP代码的POST请求发送到language_edit.php，将webshell写入服务器。最后，通过webshell执行命令。投毒风险较低，主要体现在脚本在部署webshell后，交互式shell执行命令时会将响应内容与预定义的`____`标记进行比对，若输出内容不是预期格式，会输出原始响应，增加了一些分析难度。虽然有webshell上传，但是webshell的payload不是直接执行恶意代码而是创建一个命令执行的接口，给使用者更多的控制空间。

**项目地址:** [engranaabubakar/CVE-2023-46818](https://github.com/engranaabubakar/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #6

**来源**: [CVE-2023-46818-rvizx_CVE-2023-46818.md](../2023/CVE-2023-46818-rvizx_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限并启用admin_allow_langedit

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11版本及之前版本中存在的一个PHP代码注入漏洞。该漏洞允许具有管理员权限的用户，在启用了`admin_allow_langedit`设置的情况下，通过`language_edit.php`页面的`records[]`参数注入恶意的PHP代码，从而实现远程代码执行。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且已经有公开的PoC利用代码可用。该PoC的`exploit.sh`脚本通过以下步骤利用漏洞：
1.  使用提供的用户名和密码登录ISPConfig管理界面。
2.  获取CSRF令牌（`_csrf_id`和`_csrf_key`）。
3.  构造包含PHP webshell的payload，该webshell允许执行任意命令，并将其base64编码。
4.  将编码后的payload注入到`language_edit.php`的`records[]`参数中，利用PHP代码注入漏洞将webshell写入到服务器的`/admin/`目录下，命名为`sh.php`。
5.  通过访问`/admin/sh.php`，攻击者可以执行任意系统命令。

**投毒风险：**
分析`exploit.sh`脚本，存在轻微的投毒风险。该脚本在部署webshell后，会创建一个交互式shell，允许攻击者持续执行命令。虽然PoC本身的目的在于验证漏洞，但这种交互式shell如果被恶意使用，可能造成更大的危害，例如持续监视或数据窃取。另外，作者可能在脚本中嵌入隐蔽的后门代码，但经过检查，在给定的脚本中没有明显发现这样的代码。但是仍然存在一定几率payload被替换成其他的恶意代码. 风险比例估计为5%。

**利用方式：**
1.  攻击者需要拥有ISPConfig的管理权限。
2.  需要启用`admin_allow_langedit`设置。
3.  攻击者使用`exploit.sh`脚本提供的URL、用户名和密码来利用漏洞，在目标服务器上部署webshell。
4.  攻击者通过访问webshell，执行任意系统命令。

**项目地址:** [rvizx/CVE-2023-46818](https://github.com/rvizx/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #7

**来源**: [CVE-2023-46818-vulnerk0_CVE-2023-46818.md](../2023/CVE-2023-46818-vulnerk0_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit选项开启

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-46818 漏洞存在于 ISPConfig 3.2.11p1 之前的版本中。攻击者（需要管理员权限）可以通过语言文件编辑器注入 PHP 代码。漏洞利用方式如下：

1.  **漏洞描述：**该漏洞允许经过身份验证的管理员用户，在启用了 `admin_allow_langedit` 选项的情况下，通过编辑语言文件注入恶意的 PHP 代码。
2.  **POC有效性：** 提供的 POC 代码 `exploit.py` 看起来是有效的。它首先尝试登录 ISPConfig 管理面板，然后通过编辑语言文件注入 PHP 代码，最后通过访问注入的 PHP 文件来执行任意命令。这个POC的有效性取决于目标ISPConfig实例是否满足漏洞前提条件：版本<=3.2.11，管理员权限，并且admin_allow_langedit选项被启用。
3.  **利用方式：**
    *   使用提供的用户名和密码登录 ISPConfig 管理面板。
    *   找到语言文件编辑功能，编辑一个语言文件。
    *   在语言文件中注入恶意的 PHP 代码，例如 `<?php system($_GET['cmd']); ?>`，这样可以通过 GET 请求传递命令参数来执行任意系统命令。
    *   通过访问包含恶意 PHP 代码的语言文件，执行任意命令。
4.  **投毒风险：** 查看了提供的 exploit.py 脚本和 README.md。该脚本的功能是利用 CVE-2023-46818 在 ISPConfig 系统中进行 PHP 代码注入。脚本的主要功能是：检查连接，尝试使用提供的用户名和密码登录，如果登录成功，则通过修改语言文件注入后门 PHP 代码，最后创建一个webshell，允许通过 GET 请求执行任意命令。该脚本本身没有发现明显的恶意代码，例如未经授权的数据收集、传播恶意软件等。README.md 也只包含漏洞描述和使用方法。
    因此，可以认为该仓库中存在作者隐藏的投毒代码的风险较低。


**项目地址:** [vulnerk0/CVE-2023-46818](https://github.com/vulnerk0/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #8

**来源**: [CVE-2023-46818-z7Akane_CVE-2023-46818.md](../2023/CVE-2023-46818-z7Akane_CVE-2023-46818.md)

## CVE-2023-46818 - ISPConfig PHP 代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP 代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，`admin_allow_langedit` 必须启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818 存在于 ISPConfig 3.2.11p1 之前的版本中。如果管理员启用了 `admin_allow_langedit` 选项，则攻击者（具有管理员权限）可以通过语言文件编辑器注入 PHP 代码。 

**漏洞利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的管理员凭据登录 ISPConfig 控制面板。
2.  **CSRF 令牌获取：** 利用 `language_edit.php` 页面，获取 CSRF ID 和 Key。POC脚本模拟了此过程，构造包含`lang`，`module`，`lang_file`参数的POST请求。`lang_file`参数是随机生成的，目的是创建一个新的语言文件。
3.  **代码注入：** 攻击者通过修改语言文件，将恶意的 PHP 代码注入到 `records[\]` 参数中。POC脚本中，注入的代码会将一个简单的webshell写入到 `/admin/sh.php`。
4.  **Webshell 访问：** 成功注入代码后，攻击者可以通过访问 `/admin/sh.php` 文件来执行任意命令。POC脚本通过GET请求，将需要执行的命令base64编码后放在HTTP Header `C`中传递给webshell。webshell执行命令，并将结果返回。脚本通过正则表达式提取命令执行结果。
5. **有效性：**根据漏洞库信息和搜索引擎结果，该漏洞存在且已公开。提供的POC代码也验证了该漏洞的可利用性。

**投毒风险分析：**

代码中存在投毒的风险较低，约5%。主要考虑以下几点：

*   **Base64 编码的 Payload：** Payload 使用 Base64 编码，方便审计人员进行检查。虽然攻击者可以替换Payload为恶意的代码，但是这种修改很容易被发现。
*  **对ISPConfig目录的写入操作:** 代码在`/admin/` 目录下写入webshell文件`sh.php`。该行为属于攻击行为，会触发安全警报。
*  **公开的利用方式：** 漏洞利用方式比较直接，与其他搜索结果和漏洞描述一致。没有发现隐藏的、非预期的行为。

虽然存在一些微小的风险，但综合来看，该 POC 的主要目的是验证漏洞，而不是进行恶意投毒。攻击者可以修改利用脚本来包含恶意载荷，但这不属于原始代码的投毒行为。

**项目地址:** [z7Akane/CVE-2023-46818](https://github.com/z7Akane/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #9

**来源**: [CVE-2023-46818-zs1n_CVE-2023-46818.md](../2023/CVE-2023-46818-zs1n_CVE-2023-46818.md)

# CVE-2023-46818

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-46818-SyFi_CVE-2023-46818.md](../2023/CVE-2023-46818-SyFi_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit 必须启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-46818 漏洞存在于 ISPConfig 3.2.11p1 之前的版本中。当 `admin_allow_langedit` 启用时，具有管理员权限的用户可以通过语言文件编辑器注入 PHP 代码，从而导致远程代码执行。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的管理员用户名和密码登录 ISPConfig 控制面板。
2.  **漏洞触发条件判断:** 需要`admin_allow_langedit`配置开启.
3.  **语言文件编辑：** 登录后，攻击者需要访问语言文件编辑器。
4.  **代码注入：** 在语言文件编辑器中，攻击者可以插入恶意的 PHP 代码。
5.  **代码执行：** 当 ISPConfig 执行包含恶意代码的语言文件时，攻击者注入的 PHP 代码将被执行，从而导致远程代码执行。

**POC有效性：**
提供的 Metasploit 模块利用了该漏洞，如果目标满足漏洞利用的条件（ISPConfig 版本 <= 3.2.11, 管理员权限，`admin_allow_langedit`启用），则该 POC 代码有效。

**投毒风险分析：**

通过分析提供的 POC 代码，发现其主要功能是利用漏洞进行代码注入，并创建一个反向 shell。其中存在投毒代码的可能性较低，主要是因为代码整体结构清晰，功能明确，没有发现隐藏的恶意逻辑。
`Metasploit-module/ispconfig_language_edit.rb` 代码的功能是构造恶意请求，向目标服务器发送包含 PHP 代码的payload。该payload 会执行反向连接，获取shell。虽然代码本身不包含恶意逻辑，但攻击者可以使用该模块执行任意命令，存在一定风险。但是根据代码逻辑和模块用途来判断，其目的就是为了漏洞利用，所以不能完全确定存在投毒风险。

**风险评估：**

尽管代码本身没有明显的投毒迹象，但考虑到其漏洞利用的性质，攻击者可以利用该模块进行恶意活动。因此，建议在使用该模块时，对代码进行仔细审查，并仅在授权的渗透测试环境中使用。

**投毒百分比评估：**

由于 POC 代码的主要功能是漏洞利用，没有明显的投毒行为，所以判定投毒风险较低，大约为 10%。 这个风险主要来自于使用者可能会修改payload为恶意脚本,或者作者后期更新版本,添加恶意功能。

**项目地址:** [SyFi/CVE-2023-46818](https://github.com/SyFi/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #2

**来源**: [CVE-2023-46818-ajdumanhug_CVE-2023-46818.md](../2023/CVE-2023-46818-ajdumanhug_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，允许管理员注入并执行任意PHP代码，可能导致服务器完全控制

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，并且`admin_allow_langedit`选项已启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11及更早版本中的一个PHP代码注入漏洞。利用此漏洞，需要满足以下条件：

1.  **管理员权限：** 攻击者必须拥有ISPConfig的管理员账户。
2.  **`admin_allow_langedit`启用：**  `admin_allow_langedit`配置项必须被启用。该漏洞存在于`language_edit.php`文件中，该文件用于编辑语言文件。

**利用方式：**

1.  **登录：** 使用管理员账户登录ISPConfig控制面板。
2.  **获取CSRF令牌：** 访问`language_edit.php`页面，获取CSRF ID和CSRF Key。这个步骤是为了绕过CSRF保护。
3.  **注入恶意代码：** 构造包含恶意PHP代码的请求，通过`records`参数注入，并将其发送到`language_edit.php`。POC代码使用`file_put_contents`函数将一个webshell写入到服务器上的`admin/sh.php`文件中，该webshell接收通过HTTP头`C`传递的base64编码的命令并执行。
4.  **执行命令：** 访问webshell（`admin/sh.php`），并在HTTP头`C`中传递base64编码的命令。服务器会执行该命令并将结果返回。

**关于有效性：**

根据漏洞库信息、搜索引擎结果，以及提供的漏洞利用代码，该漏洞POC代码是有效的。多个来源（NVD、Recorded Future、Sploitus等）都确认了该漏洞的存在，并且提供了利用细节。提供的Python脚本实现了漏洞利用的完整流程。

**关于投毒风险：**

评估投毒风险较低，约为5%。该Python脚本主要功能是利用已知漏洞，但仍然存在极小的潜在风险：

*   **对远程服务器造成破坏的可能性：** POC利用代码中虽然主要目标是执行命令，如果webshell被其他人利用，或者注入的Payload被修改，可能会被用于其他恶意目的，例如删除文件、篡改配置等。
*   **依赖库风险：**  脚本依赖`requests`库，虽然该库本身很常用，如果被供应链投毒，也会影响此脚本。

总体而言，该代码的目的是实现已知的漏洞利用，投毒风险较低，但仍然需要人工审核。

**项目地址:** [ajdumanhug/CVE-2023-46818](https://github.com/ajdumanhug/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #3

**来源**: [CVE-2023-46818-bipbopbup_CVE-2023-46818-python-exploit.md](../2023/CVE-2023-46818-bipbopbup_CVE-2023-46818-python-exploit.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit选项开启

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-46818是一个存在于ISPConfig 3.2.11及之前版本中的PHP代码注入漏洞。该漏洞位于language_edit.php文件中，允许具有管理员权限的用户，如果启用了`admin_allow_langedit`选项，则可以通过修改语言文件注入并执行任意PHP代码。

**漏洞利用方式：**

1.  **身份验证：** 攻击者必须首先以管理员身份登录到ISPConfig控制面板。
2.  **访问语言文件编辑器：** 登录后，攻击者需要导航到语言文件编辑器。
3.  **注入恶意PHP代码：** 攻击者通过`records` POST参数，将恶意PHP代码注入到语言文件的内容中。由于输入没有经过充分的清理，攻击者可以插入任意PHP代码。
4.  **代码执行：** 当ISPConfig加载或执行被修改的语言文件时，注入的PHP代码将被执行，从而允许攻击者在服务器上执行任意命令。

**POC代码分析：**

提供的Python POC代码自动化了漏洞利用过程。它执行以下步骤：

1.  **登录：** 使用提供的URL、用户名和密码登录到ISPConfig。
2.  **构造Payload：** 构造包含恶意PHP代码的Payload，该代码会将一个WebShell写入到服务器上的`sh.php`文件中。
3.  **CSRF Token获取:**  获取CSRF ID和Key，绕过CSRF防御
4.  **注入代码：** 向`language_edit.php`发送包含Payload的POST请求。
5.  **启动Shell：** 连接到新创建的WebShell，允许攻击者执行任意命令。

**有效性评估：**

根据漏洞描述和POC代码，该漏洞利用是有效的。POC代码提供了一个可以直接利用该漏洞的有效方法，搜索结果也确认了该漏洞的存在以及利用的可能性。

**投毒风险评估：**

检查POC代码后，发现该代码主要功能是利用漏洞进行代码注入，在/admin/目录下写入webshell，实现远程代码执行。虽然该代码用于恶意目的，但它本身没有隐藏任何额外的、与漏洞利用无关的恶意代码。因此，投毒风险较低，约为1%。

虽然可以判定POC代码不属于投毒代码,但在实际环境中，利用此漏洞本身就是一种恶意行为，会导致服务器被完全控制。


**项目地址:** [bipbopbup/CVE-2023-46818-python-exploit](https://github.com/bipbopbup/CVE-2023-46818-python-exploit)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #4

**来源**: [CVE-2023-46818-blindma1den_CVE-2023-46818-Exploit.md](../2023/CVE-2023-46818-blindma1den_CVE-2023-46818-Exploit.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要admin_allow_langedit开启，需要管理员权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11版本及之前版本中存在的一个PHP代码注入漏洞。该漏洞允许具有管理员权限的用户，在admin_allow_langedit选项启用的情况下，通过语言文件编辑器注入恶意的PHP代码，从而导致远程代码执行。

**有效性:**
根据提供的漏洞信息、搜索结果以及漏洞利用代码，可以判断该POC代码是有效的。搜索结果中存在多个关于此漏洞的讨论和利用代码，漏洞利用代码的README也表明了该漏洞利用的成功性。POC代码通过模拟管理员登录，利用`language_edit.php`的`records[]`字段注入PHP代码，最终写入一个webshell，证明漏洞可以被成功利用。

**投毒风险:**
通过分析POC代码，投毒风险较低。代码主要功能是自动化利用漏洞，注入webshell，方便后续的远程命令执行。主要的风险点在于：

*   **Webshell：** 注入的 webshell (`sh.php`) 允许攻击者执行任意系统命令。这本身就是一种后门，但并非作者有意植入的“投毒”代码，而是漏洞利用的必然结果。
*  **依赖:** POC代码依赖requests库,如果requests库被替换成恶意版本,可能存在投毒风险, 但这个不是POC代码本身的问题.

代码中并没有发现明显的恶意行为，例如上传额外文件、修改系统配置等。因此，投毒风险主要集中在webshell本身，以及程序依赖的外部库，而不是POC代码作者有意添加的恶意代码。
综合评估，投毒风险约为5%。

**利用方式:**
1.  **身份验证:** 首先，攻击者需要拥有ISPConfig的管理员账户的有效凭据。
2.  **登录:** 使用提供的用户名和密码登录到ISPConfig管理面板。
3.  **CSRF绕过:** 获取并利用CSRF token，绕过CSRF保护。
4.  **语言文件编辑:** 访问`language_edit.php`页面，该页面允许管理员编辑语言文件。
5.  **代码注入:** 利用`records[]`参数，注入包含PHP代码的恶意payload。该payload会在服务器上创建一个webshell文件 (`sh.php`)。
6.  **webshell访问:** 攻击者可以通过访问webshell文件，执行任意系统命令。`sh.php` 接收 `C` header，对其进行base64解码后执行。
7.  **命令执行:** 通过修改header的`C`值，从而发送执行任意命令到目标服务器。命令的输出会被封装在`____`标签之间方便解析。
8.  **权限要求:** 利用此漏洞需要admin_allow_langedit开启,普通权限用户无法进行利用.

**项目地址:** [blindma1den/CVE-2023-46818-Exploit](https://github.com/blindma1den/CVE-2023-46818-Exploit)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #5

**来源**: [CVE-2023-46818-engranaabubakar_CVE-2023-46818.md](../2023/CVE-2023-46818-engranaabubakar_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit 必须启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于ISPConfig 3.2.11及更早版本的language_edit.php中。当admin_allow_langedit启用时，具有管理员权限的用户可以通过修改语言文件，利用 `records[]` 参数注入恶意的PHP代码，从而在服务器上执行任意命令。PoC利用脚本首先登录ISPConfig后台，然后通过构造包含恶意PHP代码的POST请求发送到language_edit.php，将webshell写入服务器。最后，通过webshell执行命令。投毒风险较低，主要体现在脚本在部署webshell后，交互式shell执行命令时会将响应内容与预定义的`____`标记进行比对，若输出内容不是预期格式，会输出原始响应，增加了一些分析难度。虽然有webshell上传，但是webshell的payload不是直接执行恶意代码而是创建一个命令执行的接口，给使用者更多的控制空间。

**项目地址:** [engranaabubakar/CVE-2023-46818](https://github.com/engranaabubakar/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #6

**来源**: [CVE-2023-46818-rvizx_CVE-2023-46818.md](../2023/CVE-2023-46818-rvizx_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限并启用admin_allow_langedit

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11版本及之前版本中存在的一个PHP代码注入漏洞。该漏洞允许具有管理员权限的用户，在启用了`admin_allow_langedit`设置的情况下，通过`language_edit.php`页面的`records[]`参数注入恶意的PHP代码，从而实现远程代码执行。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且已经有公开的PoC利用代码可用。该PoC的`exploit.sh`脚本通过以下步骤利用漏洞：
1.  使用提供的用户名和密码登录ISPConfig管理界面。
2.  获取CSRF令牌（`_csrf_id`和`_csrf_key`）。
3.  构造包含PHP webshell的payload，该webshell允许执行任意命令，并将其base64编码。
4.  将编码后的payload注入到`language_edit.php`的`records[]`参数中，利用PHP代码注入漏洞将webshell写入到服务器的`/admin/`目录下，命名为`sh.php`。
5.  通过访问`/admin/sh.php`，攻击者可以执行任意系统命令。

**投毒风险：**
分析`exploit.sh`脚本，存在轻微的投毒风险。该脚本在部署webshell后，会创建一个交互式shell，允许攻击者持续执行命令。虽然PoC本身的目的在于验证漏洞，但这种交互式shell如果被恶意使用，可能造成更大的危害，例如持续监视或数据窃取。另外，作者可能在脚本中嵌入隐蔽的后门代码，但经过检查，在给定的脚本中没有明显发现这样的代码。但是仍然存在一定几率payload被替换成其他的恶意代码. 风险比例估计为5%。

**利用方式：**
1.  攻击者需要拥有ISPConfig的管理权限。
2.  需要启用`admin_allow_langedit`设置。
3.  攻击者使用`exploit.sh`脚本提供的URL、用户名和密码来利用漏洞，在目标服务器上部署webshell。
4.  攻击者通过访问webshell，执行任意系统命令。

**项目地址:** [rvizx/CVE-2023-46818](https://github.com/rvizx/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #7

**来源**: [CVE-2023-46818-vulnerk0_CVE-2023-46818.md](../2023/CVE-2023-46818-vulnerk0_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit选项开启

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-46818 漏洞存在于 ISPConfig 3.2.11p1 之前的版本中。攻击者（需要管理员权限）可以通过语言文件编辑器注入 PHP 代码。漏洞利用方式如下：

1.  **漏洞描述：**该漏洞允许经过身份验证的管理员用户，在启用了 `admin_allow_langedit` 选项的情况下，通过编辑语言文件注入恶意的 PHP 代码。
2.  **POC有效性：** 提供的 POC 代码 `exploit.py` 看起来是有效的。它首先尝试登录 ISPConfig 管理面板，然后通过编辑语言文件注入 PHP 代码，最后通过访问注入的 PHP 文件来执行任意命令。这个POC的有效性取决于目标ISPConfig实例是否满足漏洞前提条件：版本<=3.2.11，管理员权限，并且admin_allow_langedit选项被启用。
3.  **利用方式：**
    *   使用提供的用户名和密码登录 ISPConfig 管理面板。
    *   找到语言文件编辑功能，编辑一个语言文件。
    *   在语言文件中注入恶意的 PHP 代码，例如 `<?php system($_GET['cmd']); ?>`，这样可以通过 GET 请求传递命令参数来执行任意系统命令。
    *   通过访问包含恶意 PHP 代码的语言文件，执行任意命令。
4.  **投毒风险：** 查看了提供的 exploit.py 脚本和 README.md。该脚本的功能是利用 CVE-2023-46818 在 ISPConfig 系统中进行 PHP 代码注入。脚本的主要功能是：检查连接，尝试使用提供的用户名和密码登录，如果登录成功，则通过修改语言文件注入后门 PHP 代码，最后创建一个webshell，允许通过 GET 请求执行任意命令。该脚本本身没有发现明显的恶意代码，例如未经授权的数据收集、传播恶意软件等。README.md 也只包含漏洞描述和使用方法。
    因此，可以认为该仓库中存在作者隐藏的投毒代码的风险较低。


**项目地址:** [vulnerk0/CVE-2023-46818](https://github.com/vulnerk0/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #8

**来源**: [CVE-2023-46818-z7Akane_CVE-2023-46818.md](../2023/CVE-2023-46818-z7Akane_CVE-2023-46818.md)

## CVE-2023-46818 - ISPConfig PHP 代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP 代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，`admin_allow_langedit` 必须启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818 存在于 ISPConfig 3.2.11p1 之前的版本中。如果管理员启用了 `admin_allow_langedit` 选项，则攻击者（具有管理员权限）可以通过语言文件编辑器注入 PHP 代码。 

**漏洞利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的管理员凭据登录 ISPConfig 控制面板。
2.  **CSRF 令牌获取：** 利用 `language_edit.php` 页面，获取 CSRF ID 和 Key。POC脚本模拟了此过程，构造包含`lang`，`module`，`lang_file`参数的POST请求。`lang_file`参数是随机生成的，目的是创建一个新的语言文件。
3.  **代码注入：** 攻击者通过修改语言文件，将恶意的 PHP 代码注入到 `records[\]` 参数中。POC脚本中，注入的代码会将一个简单的webshell写入到 `/admin/sh.php`。
4.  **Webshell 访问：** 成功注入代码后，攻击者可以通过访问 `/admin/sh.php` 文件来执行任意命令。POC脚本通过GET请求，将需要执行的命令base64编码后放在HTTP Header `C`中传递给webshell。webshell执行命令，并将结果返回。脚本通过正则表达式提取命令执行结果。
5. **有效性：**根据漏洞库信息和搜索引擎结果，该漏洞存在且已公开。提供的POC代码也验证了该漏洞的可利用性。

**投毒风险分析：**

代码中存在投毒的风险较低，约5%。主要考虑以下几点：

*   **Base64 编码的 Payload：** Payload 使用 Base64 编码，方便审计人员进行检查。虽然攻击者可以替换Payload为恶意的代码，但是这种修改很容易被发现。
*  **对ISPConfig目录的写入操作:** 代码在`/admin/` 目录下写入webshell文件`sh.php`。该行为属于攻击行为，会触发安全警报。
*  **公开的利用方式：** 漏洞利用方式比较直接，与其他搜索结果和漏洞描述一致。没有发现隐藏的、非预期的行为。

虽然存在一些微小的风险，但综合来看，该 POC 的主要目的是验证漏洞，而不是进行恶意投毒。攻击者可以修改利用脚本来包含恶意载荷，但这不属于原始代码的投毒行为。

**项目地址:** [z7Akane/CVE-2023-46818](https://github.com/z7Akane/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #9

**来源**: [CVE-2023-46818-zs1n_CVE-2023-46818.md](../2023/CVE-2023-46818-zs1n_CVE-2023-46818.md)

# CVE-2023-46818

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-46818-SyFi_CVE-2023-46818.md](../2023/CVE-2023-46818-SyFi_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit 必须启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-46818 漏洞存在于 ISPConfig 3.2.11p1 之前的版本中。当 `admin_allow_langedit` 启用时，具有管理员权限的用户可以通过语言文件编辑器注入 PHP 代码，从而导致远程代码执行。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的管理员用户名和密码登录 ISPConfig 控制面板。
2.  **漏洞触发条件判断:** 需要`admin_allow_langedit`配置开启.
3.  **语言文件编辑：** 登录后，攻击者需要访问语言文件编辑器。
4.  **代码注入：** 在语言文件编辑器中，攻击者可以插入恶意的 PHP 代码。
5.  **代码执行：** 当 ISPConfig 执行包含恶意代码的语言文件时，攻击者注入的 PHP 代码将被执行，从而导致远程代码执行。

**POC有效性：**
提供的 Metasploit 模块利用了该漏洞，如果目标满足漏洞利用的条件（ISPConfig 版本 <= 3.2.11, 管理员权限，`admin_allow_langedit`启用），则该 POC 代码有效。

**投毒风险分析：**

通过分析提供的 POC 代码，发现其主要功能是利用漏洞进行代码注入，并创建一个反向 shell。其中存在投毒代码的可能性较低，主要是因为代码整体结构清晰，功能明确，没有发现隐藏的恶意逻辑。
`Metasploit-module/ispconfig_language_edit.rb` 代码的功能是构造恶意请求，向目标服务器发送包含 PHP 代码的payload。该payload 会执行反向连接，获取shell。虽然代码本身不包含恶意逻辑，但攻击者可以使用该模块执行任意命令，存在一定风险。但是根据代码逻辑和模块用途来判断，其目的就是为了漏洞利用，所以不能完全确定存在投毒风险。

**风险评估：**

尽管代码本身没有明显的投毒迹象，但考虑到其漏洞利用的性质，攻击者可以利用该模块进行恶意活动。因此，建议在使用该模块时，对代码进行仔细审查，并仅在授权的渗透测试环境中使用。

**投毒百分比评估：**

由于 POC 代码的主要功能是漏洞利用，没有明显的投毒行为，所以判定投毒风险较低，大约为 10%。 这个风险主要来自于使用者可能会修改payload为恶意脚本,或者作者后期更新版本,添加恶意功能。

**项目地址:** [SyFi/CVE-2023-46818](https://github.com/SyFi/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #2

**来源**: [CVE-2023-46818-ajdumanhug_CVE-2023-46818.md](../2023/CVE-2023-46818-ajdumanhug_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，允许管理员注入并执行任意PHP代码，可能导致服务器完全控制

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，并且`admin_allow_langedit`选项已启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11及更早版本中的一个PHP代码注入漏洞。利用此漏洞，需要满足以下条件：

1.  **管理员权限：** 攻击者必须拥有ISPConfig的管理员账户。
2.  **`admin_allow_langedit`启用：**  `admin_allow_langedit`配置项必须被启用。该漏洞存在于`language_edit.php`文件中，该文件用于编辑语言文件。

**利用方式：**

1.  **登录：** 使用管理员账户登录ISPConfig控制面板。
2.  **获取CSRF令牌：** 访问`language_edit.php`页面，获取CSRF ID和CSRF Key。这个步骤是为了绕过CSRF保护。
3.  **注入恶意代码：** 构造包含恶意PHP代码的请求，通过`records`参数注入，并将其发送到`language_edit.php`。POC代码使用`file_put_contents`函数将一个webshell写入到服务器上的`admin/sh.php`文件中，该webshell接收通过HTTP头`C`传递的base64编码的命令并执行。
4.  **执行命令：** 访问webshell（`admin/sh.php`），并在HTTP头`C`中传递base64编码的命令。服务器会执行该命令并将结果返回。

**关于有效性：**

根据漏洞库信息、搜索引擎结果，以及提供的漏洞利用代码，该漏洞POC代码是有效的。多个来源（NVD、Recorded Future、Sploitus等）都确认了该漏洞的存在，并且提供了利用细节。提供的Python脚本实现了漏洞利用的完整流程。

**关于投毒风险：**

评估投毒风险较低，约为5%。该Python脚本主要功能是利用已知漏洞，但仍然存在极小的潜在风险：

*   **对远程服务器造成破坏的可能性：** POC利用代码中虽然主要目标是执行命令，如果webshell被其他人利用，或者注入的Payload被修改，可能会被用于其他恶意目的，例如删除文件、篡改配置等。
*   **依赖库风险：**  脚本依赖`requests`库，虽然该库本身很常用，如果被供应链投毒，也会影响此脚本。

总体而言，该代码的目的是实现已知的漏洞利用，投毒风险较低，但仍然需要人工审核。

**项目地址:** [ajdumanhug/CVE-2023-46818](https://github.com/ajdumanhug/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #3

**来源**: [CVE-2023-46818-bipbopbup_CVE-2023-46818-python-exploit.md](../2023/CVE-2023-46818-bipbopbup_CVE-2023-46818-python-exploit.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit选项开启

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-46818是一个存在于ISPConfig 3.2.11及之前版本中的PHP代码注入漏洞。该漏洞位于language_edit.php文件中，允许具有管理员权限的用户，如果启用了`admin_allow_langedit`选项，则可以通过修改语言文件注入并执行任意PHP代码。

**漏洞利用方式：**

1.  **身份验证：** 攻击者必须首先以管理员身份登录到ISPConfig控制面板。
2.  **访问语言文件编辑器：** 登录后，攻击者需要导航到语言文件编辑器。
3.  **注入恶意PHP代码：** 攻击者通过`records` POST参数，将恶意PHP代码注入到语言文件的内容中。由于输入没有经过充分的清理，攻击者可以插入任意PHP代码。
4.  **代码执行：** 当ISPConfig加载或执行被修改的语言文件时，注入的PHP代码将被执行，从而允许攻击者在服务器上执行任意命令。

**POC代码分析：**

提供的Python POC代码自动化了漏洞利用过程。它执行以下步骤：

1.  **登录：** 使用提供的URL、用户名和密码登录到ISPConfig。
2.  **构造Payload：** 构造包含恶意PHP代码的Payload，该代码会将一个WebShell写入到服务器上的`sh.php`文件中。
3.  **CSRF Token获取:**  获取CSRF ID和Key，绕过CSRF防御
4.  **注入代码：** 向`language_edit.php`发送包含Payload的POST请求。
5.  **启动Shell：** 连接到新创建的WebShell，允许攻击者执行任意命令。

**有效性评估：**

根据漏洞描述和POC代码，该漏洞利用是有效的。POC代码提供了一个可以直接利用该漏洞的有效方法，搜索结果也确认了该漏洞的存在以及利用的可能性。

**投毒风险评估：**

检查POC代码后，发现该代码主要功能是利用漏洞进行代码注入，在/admin/目录下写入webshell，实现远程代码执行。虽然该代码用于恶意目的，但它本身没有隐藏任何额外的、与漏洞利用无关的恶意代码。因此，投毒风险较低，约为1%。

虽然可以判定POC代码不属于投毒代码,但在实际环境中，利用此漏洞本身就是一种恶意行为，会导致服务器被完全控制。


**项目地址:** [bipbopbup/CVE-2023-46818-python-exploit](https://github.com/bipbopbup/CVE-2023-46818-python-exploit)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #4

**来源**: [CVE-2023-46818-blindma1den_CVE-2023-46818-Exploit.md](../2023/CVE-2023-46818-blindma1den_CVE-2023-46818-Exploit.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要admin_allow_langedit开启，需要管理员权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11版本及之前版本中存在的一个PHP代码注入漏洞。该漏洞允许具有管理员权限的用户，在admin_allow_langedit选项启用的情况下，通过语言文件编辑器注入恶意的PHP代码，从而导致远程代码执行。

**有效性:**
根据提供的漏洞信息、搜索结果以及漏洞利用代码，可以判断该POC代码是有效的。搜索结果中存在多个关于此漏洞的讨论和利用代码，漏洞利用代码的README也表明了该漏洞利用的成功性。POC代码通过模拟管理员登录，利用`language_edit.php`的`records[]`字段注入PHP代码，最终写入一个webshell，证明漏洞可以被成功利用。

**投毒风险:**
通过分析POC代码，投毒风险较低。代码主要功能是自动化利用漏洞，注入webshell，方便后续的远程命令执行。主要的风险点在于：

*   **Webshell：** 注入的 webshell (`sh.php`) 允许攻击者执行任意系统命令。这本身就是一种后门，但并非作者有意植入的“投毒”代码，而是漏洞利用的必然结果。
*  **依赖:** POC代码依赖requests库,如果requests库被替换成恶意版本,可能存在投毒风险, 但这个不是POC代码本身的问题.

代码中并没有发现明显的恶意行为，例如上传额外文件、修改系统配置等。因此，投毒风险主要集中在webshell本身，以及程序依赖的外部库，而不是POC代码作者有意添加的恶意代码。
综合评估，投毒风险约为5%。

**利用方式:**
1.  **身份验证:** 首先，攻击者需要拥有ISPConfig的管理员账户的有效凭据。
2.  **登录:** 使用提供的用户名和密码登录到ISPConfig管理面板。
3.  **CSRF绕过:** 获取并利用CSRF token，绕过CSRF保护。
4.  **语言文件编辑:** 访问`language_edit.php`页面，该页面允许管理员编辑语言文件。
5.  **代码注入:** 利用`records[]`参数，注入包含PHP代码的恶意payload。该payload会在服务器上创建一个webshell文件 (`sh.php`)。
6.  **webshell访问:** 攻击者可以通过访问webshell文件，执行任意系统命令。`sh.php` 接收 `C` header，对其进行base64解码后执行。
7.  **命令执行:** 通过修改header的`C`值，从而发送执行任意命令到目标服务器。命令的输出会被封装在`____`标签之间方便解析。
8.  **权限要求:** 利用此漏洞需要admin_allow_langedit开启,普通权限用户无法进行利用.

**项目地址:** [blindma1den/CVE-2023-46818-Exploit](https://github.com/blindma1den/CVE-2023-46818-Exploit)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #5

**来源**: [CVE-2023-46818-engranaabubakar_CVE-2023-46818.md](../2023/CVE-2023-46818-engranaabubakar_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit 必须启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于ISPConfig 3.2.11及更早版本的language_edit.php中。当admin_allow_langedit启用时，具有管理员权限的用户可以通过修改语言文件，利用 `records[]` 参数注入恶意的PHP代码，从而在服务器上执行任意命令。PoC利用脚本首先登录ISPConfig后台，然后通过构造包含恶意PHP代码的POST请求发送到language_edit.php，将webshell写入服务器。最后，通过webshell执行命令。投毒风险较低，主要体现在脚本在部署webshell后，交互式shell执行命令时会将响应内容与预定义的`____`标记进行比对，若输出内容不是预期格式，会输出原始响应，增加了一些分析难度。虽然有webshell上传，但是webshell的payload不是直接执行恶意代码而是创建一个命令执行的接口，给使用者更多的控制空间。

**项目地址:** [engranaabubakar/CVE-2023-46818](https://github.com/engranaabubakar/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #6

**来源**: [CVE-2023-46818-rvizx_CVE-2023-46818.md](../2023/CVE-2023-46818-rvizx_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限并启用admin_allow_langedit

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11版本及之前版本中存在的一个PHP代码注入漏洞。该漏洞允许具有管理员权限的用户，在启用了`admin_allow_langedit`设置的情况下，通过`language_edit.php`页面的`records[]`参数注入恶意的PHP代码，从而实现远程代码执行。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且已经有公开的PoC利用代码可用。该PoC的`exploit.sh`脚本通过以下步骤利用漏洞：
1.  使用提供的用户名和密码登录ISPConfig管理界面。
2.  获取CSRF令牌（`_csrf_id`和`_csrf_key`）。
3.  构造包含PHP webshell的payload，该webshell允许执行任意命令，并将其base64编码。
4.  将编码后的payload注入到`language_edit.php`的`records[]`参数中，利用PHP代码注入漏洞将webshell写入到服务器的`/admin/`目录下，命名为`sh.php`。
5.  通过访问`/admin/sh.php`，攻击者可以执行任意系统命令。

**投毒风险：**
分析`exploit.sh`脚本，存在轻微的投毒风险。该脚本在部署webshell后，会创建一个交互式shell，允许攻击者持续执行命令。虽然PoC本身的目的在于验证漏洞，但这种交互式shell如果被恶意使用，可能造成更大的危害，例如持续监视或数据窃取。另外，作者可能在脚本中嵌入隐蔽的后门代码，但经过检查，在给定的脚本中没有明显发现这样的代码。但是仍然存在一定几率payload被替换成其他的恶意代码. 风险比例估计为5%。

**利用方式：**
1.  攻击者需要拥有ISPConfig的管理权限。
2.  需要启用`admin_allow_langedit`设置。
3.  攻击者使用`exploit.sh`脚本提供的URL、用户名和密码来利用漏洞，在目标服务器上部署webshell。
4.  攻击者通过访问webshell，执行任意系统命令。

**项目地址:** [rvizx/CVE-2023-46818](https://github.com/rvizx/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #7

**来源**: [CVE-2023-46818-vulnerk0_CVE-2023-46818.md](../2023/CVE-2023-46818-vulnerk0_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit选项开启

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-46818 漏洞存在于 ISPConfig 3.2.11p1 之前的版本中。攻击者（需要管理员权限）可以通过语言文件编辑器注入 PHP 代码。漏洞利用方式如下：

1.  **漏洞描述：**该漏洞允许经过身份验证的管理员用户，在启用了 `admin_allow_langedit` 选项的情况下，通过编辑语言文件注入恶意的 PHP 代码。
2.  **POC有效性：** 提供的 POC 代码 `exploit.py` 看起来是有效的。它首先尝试登录 ISPConfig 管理面板，然后通过编辑语言文件注入 PHP 代码，最后通过访问注入的 PHP 文件来执行任意命令。这个POC的有效性取决于目标ISPConfig实例是否满足漏洞前提条件：版本<=3.2.11，管理员权限，并且admin_allow_langedit选项被启用。
3.  **利用方式：**
    *   使用提供的用户名和密码登录 ISPConfig 管理面板。
    *   找到语言文件编辑功能，编辑一个语言文件。
    *   在语言文件中注入恶意的 PHP 代码，例如 `<?php system($_GET['cmd']); ?>`，这样可以通过 GET 请求传递命令参数来执行任意系统命令。
    *   通过访问包含恶意 PHP 代码的语言文件，执行任意命令。
4.  **投毒风险：** 查看了提供的 exploit.py 脚本和 README.md。该脚本的功能是利用 CVE-2023-46818 在 ISPConfig 系统中进行 PHP 代码注入。脚本的主要功能是：检查连接，尝试使用提供的用户名和密码登录，如果登录成功，则通过修改语言文件注入后门 PHP 代码，最后创建一个webshell，允许通过 GET 请求执行任意命令。该脚本本身没有发现明显的恶意代码，例如未经授权的数据收集、传播恶意软件等。README.md 也只包含漏洞描述和使用方法。
    因此，可以认为该仓库中存在作者隐藏的投毒代码的风险较低。


**项目地址:** [vulnerk0/CVE-2023-46818](https://github.com/vulnerk0/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #8

**来源**: [CVE-2023-46818-z7Akane_CVE-2023-46818.md](../2023/CVE-2023-46818-z7Akane_CVE-2023-46818.md)

## CVE-2023-46818 - ISPConfig PHP 代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP 代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，`admin_allow_langedit` 必须启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818 存在于 ISPConfig 3.2.11p1 之前的版本中。如果管理员启用了 `admin_allow_langedit` 选项，则攻击者（具有管理员权限）可以通过语言文件编辑器注入 PHP 代码。 

**漏洞利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的管理员凭据登录 ISPConfig 控制面板。
2.  **CSRF 令牌获取：** 利用 `language_edit.php` 页面，获取 CSRF ID 和 Key。POC脚本模拟了此过程，构造包含`lang`，`module`，`lang_file`参数的POST请求。`lang_file`参数是随机生成的，目的是创建一个新的语言文件。
3.  **代码注入：** 攻击者通过修改语言文件，将恶意的 PHP 代码注入到 `records[\]` 参数中。POC脚本中，注入的代码会将一个简单的webshell写入到 `/admin/sh.php`。
4.  **Webshell 访问：** 成功注入代码后，攻击者可以通过访问 `/admin/sh.php` 文件来执行任意命令。POC脚本通过GET请求，将需要执行的命令base64编码后放在HTTP Header `C`中传递给webshell。webshell执行命令，并将结果返回。脚本通过正则表达式提取命令执行结果。
5. **有效性：**根据漏洞库信息和搜索引擎结果，该漏洞存在且已公开。提供的POC代码也验证了该漏洞的可利用性。

**投毒风险分析：**

代码中存在投毒的风险较低，约5%。主要考虑以下几点：

*   **Base64 编码的 Payload：** Payload 使用 Base64 编码，方便审计人员进行检查。虽然攻击者可以替换Payload为恶意的代码，但是这种修改很容易被发现。
*  **对ISPConfig目录的写入操作:** 代码在`/admin/` 目录下写入webshell文件`sh.php`。该行为属于攻击行为，会触发安全警报。
*  **公开的利用方式：** 漏洞利用方式比较直接，与其他搜索结果和漏洞描述一致。没有发现隐藏的、非预期的行为。

虽然存在一些微小的风险，但综合来看，该 POC 的主要目的是验证漏洞，而不是进行恶意投毒。攻击者可以修改利用脚本来包含恶意载荷，但这不属于原始代码的投毒行为。

**项目地址:** [z7Akane/CVE-2023-46818](https://github.com/z7Akane/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #9

**来源**: [CVE-2023-46818-zs1n_CVE-2023-46818.md](../2023/CVE-2023-46818-zs1n_CVE-2023-46818.md)

# CVE-2023-46818

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-46818-SyFi_CVE-2023-46818.md](../2023/CVE-2023-46818-SyFi_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit 必须启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-46818 漏洞存在于 ISPConfig 3.2.11p1 之前的版本中。当 `admin_allow_langedit` 启用时，具有管理员权限的用户可以通过语言文件编辑器注入 PHP 代码，从而导致远程代码执行。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的管理员用户名和密码登录 ISPConfig 控制面板。
2.  **漏洞触发条件判断:** 需要`admin_allow_langedit`配置开启.
3.  **语言文件编辑：** 登录后，攻击者需要访问语言文件编辑器。
4.  **代码注入：** 在语言文件编辑器中，攻击者可以插入恶意的 PHP 代码。
5.  **代码执行：** 当 ISPConfig 执行包含恶意代码的语言文件时，攻击者注入的 PHP 代码将被执行，从而导致远程代码执行。

**POC有效性：**
提供的 Metasploit 模块利用了该漏洞，如果目标满足漏洞利用的条件（ISPConfig 版本 <= 3.2.11, 管理员权限，`admin_allow_langedit`启用），则该 POC 代码有效。

**投毒风险分析：**

通过分析提供的 POC 代码，发现其主要功能是利用漏洞进行代码注入，并创建一个反向 shell。其中存在投毒代码的可能性较低，主要是因为代码整体结构清晰，功能明确，没有发现隐藏的恶意逻辑。
`Metasploit-module/ispconfig_language_edit.rb` 代码的功能是构造恶意请求，向目标服务器发送包含 PHP 代码的payload。该payload 会执行反向连接，获取shell。虽然代码本身不包含恶意逻辑，但攻击者可以使用该模块执行任意命令，存在一定风险。但是根据代码逻辑和模块用途来判断，其目的就是为了漏洞利用，所以不能完全确定存在投毒风险。

**风险评估：**

尽管代码本身没有明显的投毒迹象，但考虑到其漏洞利用的性质，攻击者可以利用该模块进行恶意活动。因此，建议在使用该模块时，对代码进行仔细审查，并仅在授权的渗透测试环境中使用。

**投毒百分比评估：**

由于 POC 代码的主要功能是漏洞利用，没有明显的投毒行为，所以判定投毒风险较低，大约为 10%。 这个风险主要来自于使用者可能会修改payload为恶意脚本,或者作者后期更新版本,添加恶意功能。

**项目地址:** [SyFi/CVE-2023-46818](https://github.com/SyFi/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #2

**来源**: [CVE-2023-46818-ajdumanhug_CVE-2023-46818.md](../2023/CVE-2023-46818-ajdumanhug_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，允许管理员注入并执行任意PHP代码，可能导致服务器完全控制

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，并且`admin_allow_langedit`选项已启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11及更早版本中的一个PHP代码注入漏洞。利用此漏洞，需要满足以下条件：

1.  **管理员权限：** 攻击者必须拥有ISPConfig的管理员账户。
2.  **`admin_allow_langedit`启用：**  `admin_allow_langedit`配置项必须被启用。该漏洞存在于`language_edit.php`文件中，该文件用于编辑语言文件。

**利用方式：**

1.  **登录：** 使用管理员账户登录ISPConfig控制面板。
2.  **获取CSRF令牌：** 访问`language_edit.php`页面，获取CSRF ID和CSRF Key。这个步骤是为了绕过CSRF保护。
3.  **注入恶意代码：** 构造包含恶意PHP代码的请求，通过`records`参数注入，并将其发送到`language_edit.php`。POC代码使用`file_put_contents`函数将一个webshell写入到服务器上的`admin/sh.php`文件中，该webshell接收通过HTTP头`C`传递的base64编码的命令并执行。
4.  **执行命令：** 访问webshell（`admin/sh.php`），并在HTTP头`C`中传递base64编码的命令。服务器会执行该命令并将结果返回。

**关于有效性：**

根据漏洞库信息、搜索引擎结果，以及提供的漏洞利用代码，该漏洞POC代码是有效的。多个来源（NVD、Recorded Future、Sploitus等）都确认了该漏洞的存在，并且提供了利用细节。提供的Python脚本实现了漏洞利用的完整流程。

**关于投毒风险：**

评估投毒风险较低，约为5%。该Python脚本主要功能是利用已知漏洞，但仍然存在极小的潜在风险：

*   **对远程服务器造成破坏的可能性：** POC利用代码中虽然主要目标是执行命令，如果webshell被其他人利用，或者注入的Payload被修改，可能会被用于其他恶意目的，例如删除文件、篡改配置等。
*   **依赖库风险：**  脚本依赖`requests`库，虽然该库本身很常用，如果被供应链投毒，也会影响此脚本。

总体而言，该代码的目的是实现已知的漏洞利用，投毒风险较低，但仍然需要人工审核。

**项目地址:** [ajdumanhug/CVE-2023-46818](https://github.com/ajdumanhug/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #3

**来源**: [CVE-2023-46818-bipbopbup_CVE-2023-46818-python-exploit.md](../2023/CVE-2023-46818-bipbopbup_CVE-2023-46818-python-exploit.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit选项开启

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-46818是一个存在于ISPConfig 3.2.11及之前版本中的PHP代码注入漏洞。该漏洞位于language_edit.php文件中，允许具有管理员权限的用户，如果启用了`admin_allow_langedit`选项，则可以通过修改语言文件注入并执行任意PHP代码。

**漏洞利用方式：**

1.  **身份验证：** 攻击者必须首先以管理员身份登录到ISPConfig控制面板。
2.  **访问语言文件编辑器：** 登录后，攻击者需要导航到语言文件编辑器。
3.  **注入恶意PHP代码：** 攻击者通过`records` POST参数，将恶意PHP代码注入到语言文件的内容中。由于输入没有经过充分的清理，攻击者可以插入任意PHP代码。
4.  **代码执行：** 当ISPConfig加载或执行被修改的语言文件时，注入的PHP代码将被执行，从而允许攻击者在服务器上执行任意命令。

**POC代码分析：**

提供的Python POC代码自动化了漏洞利用过程。它执行以下步骤：

1.  **登录：** 使用提供的URL、用户名和密码登录到ISPConfig。
2.  **构造Payload：** 构造包含恶意PHP代码的Payload，该代码会将一个WebShell写入到服务器上的`sh.php`文件中。
3.  **CSRF Token获取:**  获取CSRF ID和Key，绕过CSRF防御
4.  **注入代码：** 向`language_edit.php`发送包含Payload的POST请求。
5.  **启动Shell：** 连接到新创建的WebShell，允许攻击者执行任意命令。

**有效性评估：**

根据漏洞描述和POC代码，该漏洞利用是有效的。POC代码提供了一个可以直接利用该漏洞的有效方法，搜索结果也确认了该漏洞的存在以及利用的可能性。

**投毒风险评估：**

检查POC代码后，发现该代码主要功能是利用漏洞进行代码注入，在/admin/目录下写入webshell，实现远程代码执行。虽然该代码用于恶意目的，但它本身没有隐藏任何额外的、与漏洞利用无关的恶意代码。因此，投毒风险较低，约为1%。

虽然可以判定POC代码不属于投毒代码,但在实际环境中，利用此漏洞本身就是一种恶意行为，会导致服务器被完全控制。


**项目地址:** [bipbopbup/CVE-2023-46818-python-exploit](https://github.com/bipbopbup/CVE-2023-46818-python-exploit)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #4

**来源**: [CVE-2023-46818-blindma1den_CVE-2023-46818-Exploit.md](../2023/CVE-2023-46818-blindma1den_CVE-2023-46818-Exploit.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要admin_allow_langedit开启，需要管理员权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11版本及之前版本中存在的一个PHP代码注入漏洞。该漏洞允许具有管理员权限的用户，在admin_allow_langedit选项启用的情况下，通过语言文件编辑器注入恶意的PHP代码，从而导致远程代码执行。

**有效性:**
根据提供的漏洞信息、搜索结果以及漏洞利用代码，可以判断该POC代码是有效的。搜索结果中存在多个关于此漏洞的讨论和利用代码，漏洞利用代码的README也表明了该漏洞利用的成功性。POC代码通过模拟管理员登录，利用`language_edit.php`的`records[]`字段注入PHP代码，最终写入一个webshell，证明漏洞可以被成功利用。

**投毒风险:**
通过分析POC代码，投毒风险较低。代码主要功能是自动化利用漏洞，注入webshell，方便后续的远程命令执行。主要的风险点在于：

*   **Webshell：** 注入的 webshell (`sh.php`) 允许攻击者执行任意系统命令。这本身就是一种后门，但并非作者有意植入的“投毒”代码，而是漏洞利用的必然结果。
*  **依赖:** POC代码依赖requests库,如果requests库被替换成恶意版本,可能存在投毒风险, 但这个不是POC代码本身的问题.

代码中并没有发现明显的恶意行为，例如上传额外文件、修改系统配置等。因此，投毒风险主要集中在webshell本身，以及程序依赖的外部库，而不是POC代码作者有意添加的恶意代码。
综合评估，投毒风险约为5%。

**利用方式:**
1.  **身份验证:** 首先，攻击者需要拥有ISPConfig的管理员账户的有效凭据。
2.  **登录:** 使用提供的用户名和密码登录到ISPConfig管理面板。
3.  **CSRF绕过:** 获取并利用CSRF token，绕过CSRF保护。
4.  **语言文件编辑:** 访问`language_edit.php`页面，该页面允许管理员编辑语言文件。
5.  **代码注入:** 利用`records[]`参数，注入包含PHP代码的恶意payload。该payload会在服务器上创建一个webshell文件 (`sh.php`)。
6.  **webshell访问:** 攻击者可以通过访问webshell文件，执行任意系统命令。`sh.php` 接收 `C` header，对其进行base64解码后执行。
7.  **命令执行:** 通过修改header的`C`值，从而发送执行任意命令到目标服务器。命令的输出会被封装在`____`标签之间方便解析。
8.  **权限要求:** 利用此漏洞需要admin_allow_langedit开启,普通权限用户无法进行利用.

**项目地址:** [blindma1den/CVE-2023-46818-Exploit](https://github.com/blindma1den/CVE-2023-46818-Exploit)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #5

**来源**: [CVE-2023-46818-engranaabubakar_CVE-2023-46818.md](../2023/CVE-2023-46818-engranaabubakar_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit 必须启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于ISPConfig 3.2.11及更早版本的language_edit.php中。当admin_allow_langedit启用时，具有管理员权限的用户可以通过修改语言文件，利用 `records[]` 参数注入恶意的PHP代码，从而在服务器上执行任意命令。PoC利用脚本首先登录ISPConfig后台，然后通过构造包含恶意PHP代码的POST请求发送到language_edit.php，将webshell写入服务器。最后，通过webshell执行命令。投毒风险较低，主要体现在脚本在部署webshell后，交互式shell执行命令时会将响应内容与预定义的`____`标记进行比对，若输出内容不是预期格式，会输出原始响应，增加了一些分析难度。虽然有webshell上传，但是webshell的payload不是直接执行恶意代码而是创建一个命令执行的接口，给使用者更多的控制空间。

**项目地址:** [engranaabubakar/CVE-2023-46818](https://github.com/engranaabubakar/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #6

**来源**: [CVE-2023-46818-rvizx_CVE-2023-46818.md](../2023/CVE-2023-46818-rvizx_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限并启用admin_allow_langedit

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11版本及之前版本中存在的一个PHP代码注入漏洞。该漏洞允许具有管理员权限的用户，在启用了`admin_allow_langedit`设置的情况下，通过`language_edit.php`页面的`records[]`参数注入恶意的PHP代码，从而实现远程代码执行。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且已经有公开的PoC利用代码可用。该PoC的`exploit.sh`脚本通过以下步骤利用漏洞：
1.  使用提供的用户名和密码登录ISPConfig管理界面。
2.  获取CSRF令牌（`_csrf_id`和`_csrf_key`）。
3.  构造包含PHP webshell的payload，该webshell允许执行任意命令，并将其base64编码。
4.  将编码后的payload注入到`language_edit.php`的`records[]`参数中，利用PHP代码注入漏洞将webshell写入到服务器的`/admin/`目录下，命名为`sh.php`。
5.  通过访问`/admin/sh.php`，攻击者可以执行任意系统命令。

**投毒风险：**
分析`exploit.sh`脚本，存在轻微的投毒风险。该脚本在部署webshell后，会创建一个交互式shell，允许攻击者持续执行命令。虽然PoC本身的目的在于验证漏洞，但这种交互式shell如果被恶意使用，可能造成更大的危害，例如持续监视或数据窃取。另外，作者可能在脚本中嵌入隐蔽的后门代码，但经过检查，在给定的脚本中没有明显发现这样的代码。但是仍然存在一定几率payload被替换成其他的恶意代码. 风险比例估计为5%。

**利用方式：**
1.  攻击者需要拥有ISPConfig的管理权限。
2.  需要启用`admin_allow_langedit`设置。
3.  攻击者使用`exploit.sh`脚本提供的URL、用户名和密码来利用漏洞，在目标服务器上部署webshell。
4.  攻击者通过访问webshell，执行任意系统命令。

**项目地址:** [rvizx/CVE-2023-46818](https://github.com/rvizx/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #7

**来源**: [CVE-2023-46818-vulnerk0_CVE-2023-46818.md](../2023/CVE-2023-46818-vulnerk0_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit选项开启

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-46818 漏洞存在于 ISPConfig 3.2.11p1 之前的版本中。攻击者（需要管理员权限）可以通过语言文件编辑器注入 PHP 代码。漏洞利用方式如下：

1.  **漏洞描述：**该漏洞允许经过身份验证的管理员用户，在启用了 `admin_allow_langedit` 选项的情况下，通过编辑语言文件注入恶意的 PHP 代码。
2.  **POC有效性：** 提供的 POC 代码 `exploit.py` 看起来是有效的。它首先尝试登录 ISPConfig 管理面板，然后通过编辑语言文件注入 PHP 代码，最后通过访问注入的 PHP 文件来执行任意命令。这个POC的有效性取决于目标ISPConfig实例是否满足漏洞前提条件：版本<=3.2.11，管理员权限，并且admin_allow_langedit选项被启用。
3.  **利用方式：**
    *   使用提供的用户名和密码登录 ISPConfig 管理面板。
    *   找到语言文件编辑功能，编辑一个语言文件。
    *   在语言文件中注入恶意的 PHP 代码，例如 `<?php system($_GET['cmd']); ?>`，这样可以通过 GET 请求传递命令参数来执行任意系统命令。
    *   通过访问包含恶意 PHP 代码的语言文件，执行任意命令。
4.  **投毒风险：** 查看了提供的 exploit.py 脚本和 README.md。该脚本的功能是利用 CVE-2023-46818 在 ISPConfig 系统中进行 PHP 代码注入。脚本的主要功能是：检查连接，尝试使用提供的用户名和密码登录，如果登录成功，则通过修改语言文件注入后门 PHP 代码，最后创建一个webshell，允许通过 GET 请求执行任意命令。该脚本本身没有发现明显的恶意代码，例如未经授权的数据收集、传播恶意软件等。README.md 也只包含漏洞描述和使用方法。
    因此，可以认为该仓库中存在作者隐藏的投毒代码的风险较低。


**项目地址:** [vulnerk0/CVE-2023-46818](https://github.com/vulnerk0/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #8

**来源**: [CVE-2023-46818-z7Akane_CVE-2023-46818.md](../2023/CVE-2023-46818-z7Akane_CVE-2023-46818.md)

## CVE-2023-46818 - ISPConfig PHP 代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP 代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，`admin_allow_langedit` 必须启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818 存在于 ISPConfig 3.2.11p1 之前的版本中。如果管理员启用了 `admin_allow_langedit` 选项，则攻击者（具有管理员权限）可以通过语言文件编辑器注入 PHP 代码。 

**漏洞利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的管理员凭据登录 ISPConfig 控制面板。
2.  **CSRF 令牌获取：** 利用 `language_edit.php` 页面，获取 CSRF ID 和 Key。POC脚本模拟了此过程，构造包含`lang`，`module`，`lang_file`参数的POST请求。`lang_file`参数是随机生成的，目的是创建一个新的语言文件。
3.  **代码注入：** 攻击者通过修改语言文件，将恶意的 PHP 代码注入到 `records[\]` 参数中。POC脚本中，注入的代码会将一个简单的webshell写入到 `/admin/sh.php`。
4.  **Webshell 访问：** 成功注入代码后，攻击者可以通过访问 `/admin/sh.php` 文件来执行任意命令。POC脚本通过GET请求，将需要执行的命令base64编码后放在HTTP Header `C`中传递给webshell。webshell执行命令，并将结果返回。脚本通过正则表达式提取命令执行结果。
5. **有效性：**根据漏洞库信息和搜索引擎结果，该漏洞存在且已公开。提供的POC代码也验证了该漏洞的可利用性。

**投毒风险分析：**

代码中存在投毒的风险较低，约5%。主要考虑以下几点：

*   **Base64 编码的 Payload：** Payload 使用 Base64 编码，方便审计人员进行检查。虽然攻击者可以替换Payload为恶意的代码，但是这种修改很容易被发现。
*  **对ISPConfig目录的写入操作:** 代码在`/admin/` 目录下写入webshell文件`sh.php`。该行为属于攻击行为，会触发安全警报。
*  **公开的利用方式：** 漏洞利用方式比较直接，与其他搜索结果和漏洞描述一致。没有发现隐藏的、非预期的行为。

虽然存在一些微小的风险，但综合来看，该 POC 的主要目的是验证漏洞，而不是进行恶意投毒。攻击者可以修改利用脚本来包含恶意载荷，但这不属于原始代码的投毒行为。

**项目地址:** [z7Akane/CVE-2023-46818](https://github.com/z7Akane/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #9

**来源**: [CVE-2023-46818-zs1n_CVE-2023-46818.md](../2023/CVE-2023-46818-zs1n_CVE-2023-46818.md)

# CVE-2023-46818

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-46818-SyFi_CVE-2023-46818.md](../2023/CVE-2023-46818-SyFi_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit 必须启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-46818 漏洞存在于 ISPConfig 3.2.11p1 之前的版本中。当 `admin_allow_langedit` 启用时，具有管理员权限的用户可以通过语言文件编辑器注入 PHP 代码，从而导致远程代码执行。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的管理员用户名和密码登录 ISPConfig 控制面板。
2.  **漏洞触发条件判断:** 需要`admin_allow_langedit`配置开启.
3.  **语言文件编辑：** 登录后，攻击者需要访问语言文件编辑器。
4.  **代码注入：** 在语言文件编辑器中，攻击者可以插入恶意的 PHP 代码。
5.  **代码执行：** 当 ISPConfig 执行包含恶意代码的语言文件时，攻击者注入的 PHP 代码将被执行，从而导致远程代码执行。

**POC有效性：**
提供的 Metasploit 模块利用了该漏洞，如果目标满足漏洞利用的条件（ISPConfig 版本 <= 3.2.11, 管理员权限，`admin_allow_langedit`启用），则该 POC 代码有效。

**投毒风险分析：**

通过分析提供的 POC 代码，发现其主要功能是利用漏洞进行代码注入，并创建一个反向 shell。其中存在投毒代码的可能性较低，主要是因为代码整体结构清晰，功能明确，没有发现隐藏的恶意逻辑。
`Metasploit-module/ispconfig_language_edit.rb` 代码的功能是构造恶意请求，向目标服务器发送包含 PHP 代码的payload。该payload 会执行反向连接，获取shell。虽然代码本身不包含恶意逻辑，但攻击者可以使用该模块执行任意命令，存在一定风险。但是根据代码逻辑和模块用途来判断，其目的就是为了漏洞利用，所以不能完全确定存在投毒风险。

**风险评估：**

尽管代码本身没有明显的投毒迹象，但考虑到其漏洞利用的性质，攻击者可以利用该模块进行恶意活动。因此，建议在使用该模块时，对代码进行仔细审查，并仅在授权的渗透测试环境中使用。

**投毒百分比评估：**

由于 POC 代码的主要功能是漏洞利用，没有明显的投毒行为，所以判定投毒风险较低，大约为 10%。 这个风险主要来自于使用者可能会修改payload为恶意脚本,或者作者后期更新版本,添加恶意功能。

**项目地址:** [SyFi/CVE-2023-46818](https://github.com/SyFi/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #2

**来源**: [CVE-2023-46818-ajdumanhug_CVE-2023-46818.md](../2023/CVE-2023-46818-ajdumanhug_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，允许管理员注入并执行任意PHP代码，可能导致服务器完全控制

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，并且`admin_allow_langedit`选项已启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11及更早版本中的一个PHP代码注入漏洞。利用此漏洞，需要满足以下条件：

1.  **管理员权限：** 攻击者必须拥有ISPConfig的管理员账户。
2.  **`admin_allow_langedit`启用：**  `admin_allow_langedit`配置项必须被启用。该漏洞存在于`language_edit.php`文件中，该文件用于编辑语言文件。

**利用方式：**

1.  **登录：** 使用管理员账户登录ISPConfig控制面板。
2.  **获取CSRF令牌：** 访问`language_edit.php`页面，获取CSRF ID和CSRF Key。这个步骤是为了绕过CSRF保护。
3.  **注入恶意代码：** 构造包含恶意PHP代码的请求，通过`records`参数注入，并将其发送到`language_edit.php`。POC代码使用`file_put_contents`函数将一个webshell写入到服务器上的`admin/sh.php`文件中，该webshell接收通过HTTP头`C`传递的base64编码的命令并执行。
4.  **执行命令：** 访问webshell（`admin/sh.php`），并在HTTP头`C`中传递base64编码的命令。服务器会执行该命令并将结果返回。

**关于有效性：**

根据漏洞库信息、搜索引擎结果，以及提供的漏洞利用代码，该漏洞POC代码是有效的。多个来源（NVD、Recorded Future、Sploitus等）都确认了该漏洞的存在，并且提供了利用细节。提供的Python脚本实现了漏洞利用的完整流程。

**关于投毒风险：**

评估投毒风险较低，约为5%。该Python脚本主要功能是利用已知漏洞，但仍然存在极小的潜在风险：

*   **对远程服务器造成破坏的可能性：** POC利用代码中虽然主要目标是执行命令，如果webshell被其他人利用，或者注入的Payload被修改，可能会被用于其他恶意目的，例如删除文件、篡改配置等。
*   **依赖库风险：**  脚本依赖`requests`库，虽然该库本身很常用，如果被供应链投毒，也会影响此脚本。

总体而言，该代码的目的是实现已知的漏洞利用，投毒风险较低，但仍然需要人工审核。

**项目地址:** [ajdumanhug/CVE-2023-46818](https://github.com/ajdumanhug/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #3

**来源**: [CVE-2023-46818-bipbopbup_CVE-2023-46818-python-exploit.md](../2023/CVE-2023-46818-bipbopbup_CVE-2023-46818-python-exploit.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit选项开启

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-46818是一个存在于ISPConfig 3.2.11及之前版本中的PHP代码注入漏洞。该漏洞位于language_edit.php文件中，允许具有管理员权限的用户，如果启用了`admin_allow_langedit`选项，则可以通过修改语言文件注入并执行任意PHP代码。

**漏洞利用方式：**

1.  **身份验证：** 攻击者必须首先以管理员身份登录到ISPConfig控制面板。
2.  **访问语言文件编辑器：** 登录后，攻击者需要导航到语言文件编辑器。
3.  **注入恶意PHP代码：** 攻击者通过`records` POST参数，将恶意PHP代码注入到语言文件的内容中。由于输入没有经过充分的清理，攻击者可以插入任意PHP代码。
4.  **代码执行：** 当ISPConfig加载或执行被修改的语言文件时，注入的PHP代码将被执行，从而允许攻击者在服务器上执行任意命令。

**POC代码分析：**

提供的Python POC代码自动化了漏洞利用过程。它执行以下步骤：

1.  **登录：** 使用提供的URL、用户名和密码登录到ISPConfig。
2.  **构造Payload：** 构造包含恶意PHP代码的Payload，该代码会将一个WebShell写入到服务器上的`sh.php`文件中。
3.  **CSRF Token获取:**  获取CSRF ID和Key，绕过CSRF防御
4.  **注入代码：** 向`language_edit.php`发送包含Payload的POST请求。
5.  **启动Shell：** 连接到新创建的WebShell，允许攻击者执行任意命令。

**有效性评估：**

根据漏洞描述和POC代码，该漏洞利用是有效的。POC代码提供了一个可以直接利用该漏洞的有效方法，搜索结果也确认了该漏洞的存在以及利用的可能性。

**投毒风险评估：**

检查POC代码后，发现该代码主要功能是利用漏洞进行代码注入，在/admin/目录下写入webshell，实现远程代码执行。虽然该代码用于恶意目的，但它本身没有隐藏任何额外的、与漏洞利用无关的恶意代码。因此，投毒风险较低，约为1%。

虽然可以判定POC代码不属于投毒代码,但在实际环境中，利用此漏洞本身就是一种恶意行为，会导致服务器被完全控制。


**项目地址:** [bipbopbup/CVE-2023-46818-python-exploit](https://github.com/bipbopbup/CVE-2023-46818-python-exploit)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #4

**来源**: [CVE-2023-46818-blindma1den_CVE-2023-46818-Exploit.md](../2023/CVE-2023-46818-blindma1den_CVE-2023-46818-Exploit.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要admin_allow_langedit开启，需要管理员权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11版本及之前版本中存在的一个PHP代码注入漏洞。该漏洞允许具有管理员权限的用户，在admin_allow_langedit选项启用的情况下，通过语言文件编辑器注入恶意的PHP代码，从而导致远程代码执行。

**有效性:**
根据提供的漏洞信息、搜索结果以及漏洞利用代码，可以判断该POC代码是有效的。搜索结果中存在多个关于此漏洞的讨论和利用代码，漏洞利用代码的README也表明了该漏洞利用的成功性。POC代码通过模拟管理员登录，利用`language_edit.php`的`records[]`字段注入PHP代码，最终写入一个webshell，证明漏洞可以被成功利用。

**投毒风险:**
通过分析POC代码，投毒风险较低。代码主要功能是自动化利用漏洞，注入webshell，方便后续的远程命令执行。主要的风险点在于：

*   **Webshell：** 注入的 webshell (`sh.php`) 允许攻击者执行任意系统命令。这本身就是一种后门，但并非作者有意植入的“投毒”代码，而是漏洞利用的必然结果。
*  **依赖:** POC代码依赖requests库,如果requests库被替换成恶意版本,可能存在投毒风险, 但这个不是POC代码本身的问题.

代码中并没有发现明显的恶意行为，例如上传额外文件、修改系统配置等。因此，投毒风险主要集中在webshell本身，以及程序依赖的外部库，而不是POC代码作者有意添加的恶意代码。
综合评估，投毒风险约为5%。

**利用方式:**
1.  **身份验证:** 首先，攻击者需要拥有ISPConfig的管理员账户的有效凭据。
2.  **登录:** 使用提供的用户名和密码登录到ISPConfig管理面板。
3.  **CSRF绕过:** 获取并利用CSRF token，绕过CSRF保护。
4.  **语言文件编辑:** 访问`language_edit.php`页面，该页面允许管理员编辑语言文件。
5.  **代码注入:** 利用`records[]`参数，注入包含PHP代码的恶意payload。该payload会在服务器上创建一个webshell文件 (`sh.php`)。
6.  **webshell访问:** 攻击者可以通过访问webshell文件，执行任意系统命令。`sh.php` 接收 `C` header，对其进行base64解码后执行。
7.  **命令执行:** 通过修改header的`C`值，从而发送执行任意命令到目标服务器。命令的输出会被封装在`____`标签之间方便解析。
8.  **权限要求:** 利用此漏洞需要admin_allow_langedit开启,普通权限用户无法进行利用.

**项目地址:** [blindma1den/CVE-2023-46818-Exploit](https://github.com/blindma1den/CVE-2023-46818-Exploit)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #5

**来源**: [CVE-2023-46818-engranaabubakar_CVE-2023-46818.md](../2023/CVE-2023-46818-engranaabubakar_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit 必须启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于ISPConfig 3.2.11及更早版本的language_edit.php中。当admin_allow_langedit启用时，具有管理员权限的用户可以通过修改语言文件，利用 `records[]` 参数注入恶意的PHP代码，从而在服务器上执行任意命令。PoC利用脚本首先登录ISPConfig后台，然后通过构造包含恶意PHP代码的POST请求发送到language_edit.php，将webshell写入服务器。最后，通过webshell执行命令。投毒风险较低，主要体现在脚本在部署webshell后，交互式shell执行命令时会将响应内容与预定义的`____`标记进行比对，若输出内容不是预期格式，会输出原始响应，增加了一些分析难度。虽然有webshell上传，但是webshell的payload不是直接执行恶意代码而是创建一个命令执行的接口，给使用者更多的控制空间。

**项目地址:** [engranaabubakar/CVE-2023-46818](https://github.com/engranaabubakar/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #6

**来源**: [CVE-2023-46818-rvizx_CVE-2023-46818.md](../2023/CVE-2023-46818-rvizx_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限并启用admin_allow_langedit

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818是ISPConfig 3.2.11版本及之前版本中存在的一个PHP代码注入漏洞。该漏洞允许具有管理员权限的用户，在启用了`admin_allow_langedit`设置的情况下，通过`language_edit.php`页面的`records[]`参数注入恶意的PHP代码，从而实现远程代码执行。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且已经有公开的PoC利用代码可用。该PoC的`exploit.sh`脚本通过以下步骤利用漏洞：
1.  使用提供的用户名和密码登录ISPConfig管理界面。
2.  获取CSRF令牌（`_csrf_id`和`_csrf_key`）。
3.  构造包含PHP webshell的payload，该webshell允许执行任意命令，并将其base64编码。
4.  将编码后的payload注入到`language_edit.php`的`records[]`参数中，利用PHP代码注入漏洞将webshell写入到服务器的`/admin/`目录下，命名为`sh.php`。
5.  通过访问`/admin/sh.php`，攻击者可以执行任意系统命令。

**投毒风险：**
分析`exploit.sh`脚本，存在轻微的投毒风险。该脚本在部署webshell后，会创建一个交互式shell，允许攻击者持续执行命令。虽然PoC本身的目的在于验证漏洞，但这种交互式shell如果被恶意使用，可能造成更大的危害，例如持续监视或数据窃取。另外，作者可能在脚本中嵌入隐蔽的后门代码，但经过检查，在给定的脚本中没有明显发现这样的代码。但是仍然存在一定几率payload被替换成其他的恶意代码. 风险比例估计为5%。

**利用方式：**
1.  攻击者需要拥有ISPConfig的管理权限。
2.  需要启用`admin_allow_langedit`设置。
3.  攻击者使用`exploit.sh`脚本提供的URL、用户名和密码来利用漏洞，在目标服务器上部署webshell。
4.  攻击者通过访问webshell，执行任意系统命令。

**项目地址:** [rvizx/CVE-2023-46818](https://github.com/rvizx/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #7

**来源**: [CVE-2023-46818-vulnerk0_CVE-2023-46818.md](../2023/CVE-2023-46818-vulnerk0_CVE-2023-46818.md)

## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit选项开启

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-46818 漏洞存在于 ISPConfig 3.2.11p1 之前的版本中。攻击者（需要管理员权限）可以通过语言文件编辑器注入 PHP 代码。漏洞利用方式如下：

1.  **漏洞描述：**该漏洞允许经过身份验证的管理员用户，在启用了 `admin_allow_langedit` 选项的情况下，通过编辑语言文件注入恶意的 PHP 代码。
2.  **POC有效性：** 提供的 POC 代码 `exploit.py` 看起来是有效的。它首先尝试登录 ISPConfig 管理面板，然后通过编辑语言文件注入 PHP 代码，最后通过访问注入的 PHP 文件来执行任意命令。这个POC的有效性取决于目标ISPConfig实例是否满足漏洞前提条件：版本<=3.2.11，管理员权限，并且admin_allow_langedit选项被启用。
3.  **利用方式：**
    *   使用提供的用户名和密码登录 ISPConfig 管理面板。
    *   找到语言文件编辑功能，编辑一个语言文件。
    *   在语言文件中注入恶意的 PHP 代码，例如 `<?php system($_GET['cmd']); ?>`，这样可以通过 GET 请求传递命令参数来执行任意系统命令。
    *   通过访问包含恶意 PHP 代码的语言文件，执行任意命令。
4.  **投毒风险：** 查看了提供的 exploit.py 脚本和 README.md。该脚本的功能是利用 CVE-2023-46818 在 ISPConfig 系统中进行 PHP 代码注入。脚本的主要功能是：检查连接，尝试使用提供的用户名和密码登录，如果登录成功，则通过修改语言文件注入后门 PHP 代码，最后创建一个webshell，允许通过 GET 请求执行任意命令。该脚本本身没有发现明显的恶意代码，例如未经授权的数据收集、传播恶意软件等。README.md 也只包含漏洞描述和使用方法。
    因此，可以认为该仓库中存在作者隐藏的投毒代码的风险较低。


**项目地址:** [vulnerk0/CVE-2023-46818](https://github.com/vulnerk0/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---

## POC #8

**来源**: [CVE-2023-46818-z7Akane_CVE-2023-46818.md](../2023/CVE-2023-46818-z7Akane_CVE-2023-46818.md)

## CVE-2023-46818 - ISPConfig PHP 代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP 代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，`admin_allow_langedit` 必须启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46818 存在于 ISPConfig 3.2.11p1 之前的版本中。如果管理员启用了 `admin_allow_langedit` 选项，则攻击者（具有管理员权限）可以通过语言文件编辑器注入 PHP 代码。 

**漏洞利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的管理员凭据登录 ISPConfig 控制面板。
2.  **CSRF 令牌获取：** 利用 `language_edit.php` 页面，获取 CSRF ID 和 Key。POC脚本模拟了此过程，构造包含`lang`，`module`，`lang_file`参数的POST请求。`lang_file`参数是随机生成的，目的是创建一个新的语言文件。
3.  **代码注入：** 攻击者通过修改语言文件，将恶意的 PHP 代码注入到 `records[\]` 参数中。POC脚本中，注入的代码会将一个简单的webshell写入到 `/admin/sh.php`。
4.  **Webshell 访问：** 成功注入代码后，攻击者可以通过访问 `/admin/sh.php` 文件来执行任意命令。POC脚本通过GET请求，将需要执行的命令base64编码后放在HTTP Header `C`中传递给webshell。webshell执行命令，并将结果返回。脚本通过正则表达式提取命令执行结果。
5. **有效性：**根据漏洞库信息和搜索引擎结果，该漏洞存在且已公开。提供的POC代码也验证了该漏洞的可利用性。

**投毒风险分析：**

代码中存在投毒的风险较低，约5%。主要考虑以下几点：

*   **Base64 编码的 Payload：** Payload 使用 Base64 编码，方便审计人员进行检查。虽然攻击者可以替换Payload为恶意的代码，但是这种修改很容易被发现。
*  **对ISPConfig目录的写入操作:** 代码在`/admin/` 目录下写入webshell文件`sh.php`。该行为属于攻击行为，会触发安全警报。
*  **公开的利用方式：** 漏洞利用方式比较直接，与其他搜索结果和漏洞描述一致。没有发现隐藏的、非预期的行为。

虽然存在一些微小的风险，但综合来看，该 POC 的主要目的是验证漏洞，而不是进行恶意投毒。攻击者可以修改利用脚本来包含恶意载荷，但这不属于原始代码的投毒行为。

**项目地址:** [z7Akane/CVE-2023-46818](https://github.com/z7Akane/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)

---



---



---



---



---



---



---



---



---



---



---



---

