# CVE-2023-42931

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-42931-d0rb_CVE-2023-42931.md](../2023/CVE-2023-42931-d0rb_CVE-2023-42931.md)

## CVE-2023-42931 - macOS Privilege Escalation

**漏洞编号:** CVE-2023-42931

**漏洞类型:** 权限提升

**影响应用:** macOS

**危害等级:** 高危，可获取Root权限

**影响版本:** macOS Monterey < 12.7.2, macOS Ventura < 13.6.3, macOS Sonoma < 14.2

**利用条件:** 本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42931 允许低权限用户提升至 root 权限。根据搜索引擎结果（webpage 1, 4, 9），此漏洞与 'diskutil' 命令有关，允许利用不正确的权限处理来提升权限。漏洞利用代码（PoC.py）证实了这一点，通过以下步骤实现权限提升：

1.  **创建 Setuid Shell:**  创建一个具有 setuid 权限的 shell 程序，当执行该 shell 时，将以文件所有者的权限（即 root）运行。
2.  **挂载文件系统 (noowners):** 使用 `diskutil mount -mountOptions noowners /dev/disk3s4` 命令以 `noowners` 标志挂载文件系统。`noowners` 标志使得文件所有权的检查被忽略。
3.  **修改 .file 权限:**  将根目录下的 `.file` 文件的权限修改为 777，使其可读写可执行，从而允许任何用户修改该文件。
4.  **拷贝 Payload:** 将编译好的 setuid shell 程序拷贝到 `.file`。
5.  **设置 .file 权限:**  将 `.file` 的权限设置为 +sx，使其具有 setuid 权限。
6.  **重新挂载文件系统 (owners, suid):** 使用 `diskutil mount -mountOptions owners,suid /dev/disk3s4` 命令，以 `owners` 和 `suid` 标志重新挂载文件系统。这样，setuid 权限才能生效。
7.  **执行 Payload:**  执行位于根目录下的 `.file` 文件，由于该文件是 setuid 程序，因此会以 root 权限运行，从而获得 root shell。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在可用的PoC利用代码。提供的PoC代码的逻辑与漏洞描述相符，因此判断该PoC代码有效。

**投毒风险：**

*   `README.md`文件中包含指向`bringthemhomenow.net`的链接，这是一个政治声明，虽然不直接构成投毒，但表明作者具有一定的政治倾向，不排除在代码中加入恶意行为的可能性。
*   PoC的代码比较直接，目的是利用漏洞提升权限，没有发现明显的恶意行为。但是，该脚本直接使用 `os.system` 函数执行系统命令，这本身就存在一定的风险，如果作者有意为之，可以通过构造恶意的命令来执行任意代码。
*   此外，PoC 需要编译 C 代码，并将编译后的二进制文件复制到系统目录，这个过程也存在被篡改的风险。

综合考虑，虽然目前代码本身看起来没有明显的投毒行为，但是考虑到作者的政治倾向、`os.system` 的使用以及编译过程的潜在风险，认为存在10%的投毒风险。

**利用方式：** 该漏洞的利用方式是利用 'diskutil' 命令的权限管理缺陷，通过修改文件系统挂载选项，使得攻击者能够创建一个 setuid 程序，并以 root 权限执行。

**项目地址:** [d0rb/CVE-2023-42931](https://github.com/d0rb/CVE-2023-42931)

**漏洞详情:** [CVE-2023-42931](https://nvd.nist.gov/vuln/detail/CVE-2023-42931)

---

## POC #2

**来源**: [CVE-2023-42931-tageniu_CVE-2023-42931.md](../2023/CVE-2023-42931-tageniu_CVE-2023-42931.md)

# CVE-2023-42931

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-42931-d0rb_CVE-2023-42931.md](../2023/CVE-2023-42931-d0rb_CVE-2023-42931.md)

## CVE-2023-42931 - macOS Privilege Escalation

**漏洞编号:** CVE-2023-42931

**漏洞类型:** 权限提升

**影响应用:** macOS

**危害等级:** 高危，可获取Root权限

**影响版本:** macOS Monterey < 12.7.2, macOS Ventura < 13.6.3, macOS Sonoma < 14.2

**利用条件:** 本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42931 允许低权限用户提升至 root 权限。根据搜索引擎结果（webpage 1, 4, 9），此漏洞与 'diskutil' 命令有关，允许利用不正确的权限处理来提升权限。漏洞利用代码（PoC.py）证实了这一点，通过以下步骤实现权限提升：

1.  **创建 Setuid Shell:**  创建一个具有 setuid 权限的 shell 程序，当执行该 shell 时，将以文件所有者的权限（即 root）运行。
2.  **挂载文件系统 (noowners):** 使用 `diskutil mount -mountOptions noowners /dev/disk3s4` 命令以 `noowners` 标志挂载文件系统。`noowners` 标志使得文件所有权的检查被忽略。
3.  **修改 .file 权限:**  将根目录下的 `.file` 文件的权限修改为 777，使其可读写可执行，从而允许任何用户修改该文件。
4.  **拷贝 Payload:** 将编译好的 setuid shell 程序拷贝到 `.file`。
5.  **设置 .file 权限:**  将 `.file` 的权限设置为 +sx，使其具有 setuid 权限。
6.  **重新挂载文件系统 (owners, suid):** 使用 `diskutil mount -mountOptions owners,suid /dev/disk3s4` 命令，以 `owners` 和 `suid` 标志重新挂载文件系统。这样，setuid 权限才能生效。
7.  **执行 Payload:**  执行位于根目录下的 `.file` 文件，由于该文件是 setuid 程序，因此会以 root 权限运行，从而获得 root shell。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在可用的PoC利用代码。提供的PoC代码的逻辑与漏洞描述相符，因此判断该PoC代码有效。

**投毒风险：**

*   `README.md`文件中包含指向`bringthemhomenow.net`的链接，这是一个政治声明，虽然不直接构成投毒，但表明作者具有一定的政治倾向，不排除在代码中加入恶意行为的可能性。
*   PoC的代码比较直接，目的是利用漏洞提升权限，没有发现明显的恶意行为。但是，该脚本直接使用 `os.system` 函数执行系统命令，这本身就存在一定的风险，如果作者有意为之，可以通过构造恶意的命令来执行任意代码。
*   此外，PoC 需要编译 C 代码，并将编译后的二进制文件复制到系统目录，这个过程也存在被篡改的风险。

综合考虑，虽然目前代码本身看起来没有明显的投毒行为，但是考虑到作者的政治倾向、`os.system` 的使用以及编译过程的潜在风险，认为存在10%的投毒风险。

**利用方式：** 该漏洞的利用方式是利用 'diskutil' 命令的权限管理缺陷，通过修改文件系统挂载选项，使得攻击者能够创建一个 setuid 程序，并以 root 权限执行。

**项目地址:** [d0rb/CVE-2023-42931](https://github.com/d0rb/CVE-2023-42931)

**漏洞详情:** [CVE-2023-42931](https://nvd.nist.gov/vuln/detail/CVE-2023-42931)

---

## POC #2

**来源**: [CVE-2023-42931-tageniu_CVE-2023-42931.md](../2023/CVE-2023-42931-tageniu_CVE-2023-42931.md)

# CVE-2023-42931

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-42931-d0rb_CVE-2023-42931.md](../2023/CVE-2023-42931-d0rb_CVE-2023-42931.md)

## CVE-2023-42931 - macOS Privilege Escalation

**漏洞编号:** CVE-2023-42931

**漏洞类型:** 权限提升

**影响应用:** macOS

**危害等级:** 高危，可获取Root权限

**影响版本:** macOS Monterey < 12.7.2, macOS Ventura < 13.6.3, macOS Sonoma < 14.2

**利用条件:** 本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42931 允许低权限用户提升至 root 权限。根据搜索引擎结果（webpage 1, 4, 9），此漏洞与 'diskutil' 命令有关，允许利用不正确的权限处理来提升权限。漏洞利用代码（PoC.py）证实了这一点，通过以下步骤实现权限提升：

1.  **创建 Setuid Shell:**  创建一个具有 setuid 权限的 shell 程序，当执行该 shell 时，将以文件所有者的权限（即 root）运行。
2.  **挂载文件系统 (noowners):** 使用 `diskutil mount -mountOptions noowners /dev/disk3s4` 命令以 `noowners` 标志挂载文件系统。`noowners` 标志使得文件所有权的检查被忽略。
3.  **修改 .file 权限:**  将根目录下的 `.file` 文件的权限修改为 777，使其可读写可执行，从而允许任何用户修改该文件。
4.  **拷贝 Payload:** 将编译好的 setuid shell 程序拷贝到 `.file`。
5.  **设置 .file 权限:**  将 `.file` 的权限设置为 +sx，使其具有 setuid 权限。
6.  **重新挂载文件系统 (owners, suid):** 使用 `diskutil mount -mountOptions owners,suid /dev/disk3s4` 命令，以 `owners` 和 `suid` 标志重新挂载文件系统。这样，setuid 权限才能生效。
7.  **执行 Payload:**  执行位于根目录下的 `.file` 文件，由于该文件是 setuid 程序，因此会以 root 权限运行，从而获得 root shell。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在可用的PoC利用代码。提供的PoC代码的逻辑与漏洞描述相符，因此判断该PoC代码有效。

**投毒风险：**

*   `README.md`文件中包含指向`bringthemhomenow.net`的链接，这是一个政治声明，虽然不直接构成投毒，但表明作者具有一定的政治倾向，不排除在代码中加入恶意行为的可能性。
*   PoC的代码比较直接，目的是利用漏洞提升权限，没有发现明显的恶意行为。但是，该脚本直接使用 `os.system` 函数执行系统命令，这本身就存在一定的风险，如果作者有意为之，可以通过构造恶意的命令来执行任意代码。
*   此外，PoC 需要编译 C 代码，并将编译后的二进制文件复制到系统目录，这个过程也存在被篡改的风险。

综合考虑，虽然目前代码本身看起来没有明显的投毒行为，但是考虑到作者的政治倾向、`os.system` 的使用以及编译过程的潜在风险，认为存在10%的投毒风险。

**利用方式：** 该漏洞的利用方式是利用 'diskutil' 命令的权限管理缺陷，通过修改文件系统挂载选项，使得攻击者能够创建一个 setuid 程序，并以 root 权限执行。

**项目地址:** [d0rb/CVE-2023-42931](https://github.com/d0rb/CVE-2023-42931)

**漏洞详情:** [CVE-2023-42931](https://nvd.nist.gov/vuln/detail/CVE-2023-42931)

---

## POC #2

**来源**: [CVE-2023-42931-tageniu_CVE-2023-42931.md](../2023/CVE-2023-42931-tageniu_CVE-2023-42931.md)

# CVE-2023-42931

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-42931-d0rb_CVE-2023-42931.md](../2023/CVE-2023-42931-d0rb_CVE-2023-42931.md)

## CVE-2023-42931 - macOS Privilege Escalation

**漏洞编号:** CVE-2023-42931

**漏洞类型:** 权限提升

**影响应用:** macOS

**危害等级:** 高危，可获取Root权限

**影响版本:** macOS Monterey < 12.7.2, macOS Ventura < 13.6.3, macOS Sonoma < 14.2

**利用条件:** 本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42931 允许低权限用户提升至 root 权限。根据搜索引擎结果（webpage 1, 4, 9），此漏洞与 'diskutil' 命令有关，允许利用不正确的权限处理来提升权限。漏洞利用代码（PoC.py）证实了这一点，通过以下步骤实现权限提升：

1.  **创建 Setuid Shell:**  创建一个具有 setuid 权限的 shell 程序，当执行该 shell 时，将以文件所有者的权限（即 root）运行。
2.  **挂载文件系统 (noowners):** 使用 `diskutil mount -mountOptions noowners /dev/disk3s4` 命令以 `noowners` 标志挂载文件系统。`noowners` 标志使得文件所有权的检查被忽略。
3.  **修改 .file 权限:**  将根目录下的 `.file` 文件的权限修改为 777，使其可读写可执行，从而允许任何用户修改该文件。
4.  **拷贝 Payload:** 将编译好的 setuid shell 程序拷贝到 `.file`。
5.  **设置 .file 权限:**  将 `.file` 的权限设置为 +sx，使其具有 setuid 权限。
6.  **重新挂载文件系统 (owners, suid):** 使用 `diskutil mount -mountOptions owners,suid /dev/disk3s4` 命令，以 `owners` 和 `suid` 标志重新挂载文件系统。这样，setuid 权限才能生效。
7.  **执行 Payload:**  执行位于根目录下的 `.file` 文件，由于该文件是 setuid 程序，因此会以 root 权限运行，从而获得 root shell。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在可用的PoC利用代码。提供的PoC代码的逻辑与漏洞描述相符，因此判断该PoC代码有效。

**投毒风险：**

*   `README.md`文件中包含指向`bringthemhomenow.net`的链接，这是一个政治声明，虽然不直接构成投毒，但表明作者具有一定的政治倾向，不排除在代码中加入恶意行为的可能性。
*   PoC的代码比较直接，目的是利用漏洞提升权限，没有发现明显的恶意行为。但是，该脚本直接使用 `os.system` 函数执行系统命令，这本身就存在一定的风险，如果作者有意为之，可以通过构造恶意的命令来执行任意代码。
*   此外，PoC 需要编译 C 代码，并将编译后的二进制文件复制到系统目录，这个过程也存在被篡改的风险。

综合考虑，虽然目前代码本身看起来没有明显的投毒行为，但是考虑到作者的政治倾向、`os.system` 的使用以及编译过程的潜在风险，认为存在10%的投毒风险。

**利用方式：** 该漏洞的利用方式是利用 'diskutil' 命令的权限管理缺陷，通过修改文件系统挂载选项，使得攻击者能够创建一个 setuid 程序，并以 root 权限执行。

**项目地址:** [d0rb/CVE-2023-42931](https://github.com/d0rb/CVE-2023-42931)

**漏洞详情:** [CVE-2023-42931](https://nvd.nist.gov/vuln/detail/CVE-2023-42931)

---

## POC #2

**来源**: [CVE-2023-42931-tageniu_CVE-2023-42931.md](../2023/CVE-2023-42931-tageniu_CVE-2023-42931.md)

# CVE-2023-42931

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-42931-d0rb_CVE-2023-42931.md](../2023/CVE-2023-42931-d0rb_CVE-2023-42931.md)

## CVE-2023-42931 - macOS Privilege Escalation

**漏洞编号:** CVE-2023-42931

**漏洞类型:** 权限提升

**影响应用:** macOS

**危害等级:** 高危，可获取Root权限

**影响版本:** macOS Monterey < 12.7.2, macOS Ventura < 13.6.3, macOS Sonoma < 14.2

**利用条件:** 本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42931 允许低权限用户提升至 root 权限。根据搜索引擎结果（webpage 1, 4, 9），此漏洞与 'diskutil' 命令有关，允许利用不正确的权限处理来提升权限。漏洞利用代码（PoC.py）证实了这一点，通过以下步骤实现权限提升：

1.  **创建 Setuid Shell:**  创建一个具有 setuid 权限的 shell 程序，当执行该 shell 时，将以文件所有者的权限（即 root）运行。
2.  **挂载文件系统 (noowners):** 使用 `diskutil mount -mountOptions noowners /dev/disk3s4` 命令以 `noowners` 标志挂载文件系统。`noowners` 标志使得文件所有权的检查被忽略。
3.  **修改 .file 权限:**  将根目录下的 `.file` 文件的权限修改为 777，使其可读写可执行，从而允许任何用户修改该文件。
4.  **拷贝 Payload:** 将编译好的 setuid shell 程序拷贝到 `.file`。
5.  **设置 .file 权限:**  将 `.file` 的权限设置为 +sx，使其具有 setuid 权限。
6.  **重新挂载文件系统 (owners, suid):** 使用 `diskutil mount -mountOptions owners,suid /dev/disk3s4` 命令，以 `owners` 和 `suid` 标志重新挂载文件系统。这样，setuid 权限才能生效。
7.  **执行 Payload:**  执行位于根目录下的 `.file` 文件，由于该文件是 setuid 程序，因此会以 root 权限运行，从而获得 root shell。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在可用的PoC利用代码。提供的PoC代码的逻辑与漏洞描述相符，因此判断该PoC代码有效。

**投毒风险：**

*   `README.md`文件中包含指向`bringthemhomenow.net`的链接，这是一个政治声明，虽然不直接构成投毒，但表明作者具有一定的政治倾向，不排除在代码中加入恶意行为的可能性。
*   PoC的代码比较直接，目的是利用漏洞提升权限，没有发现明显的恶意行为。但是，该脚本直接使用 `os.system` 函数执行系统命令，这本身就存在一定的风险，如果作者有意为之，可以通过构造恶意的命令来执行任意代码。
*   此外，PoC 需要编译 C 代码，并将编译后的二进制文件复制到系统目录，这个过程也存在被篡改的风险。

综合考虑，虽然目前代码本身看起来没有明显的投毒行为，但是考虑到作者的政治倾向、`os.system` 的使用以及编译过程的潜在风险，认为存在10%的投毒风险。

**利用方式：** 该漏洞的利用方式是利用 'diskutil' 命令的权限管理缺陷，通过修改文件系统挂载选项，使得攻击者能够创建一个 setuid 程序，并以 root 权限执行。

**项目地址:** [d0rb/CVE-2023-42931](https://github.com/d0rb/CVE-2023-42931)

**漏洞详情:** [CVE-2023-42931](https://nvd.nist.gov/vuln/detail/CVE-2023-42931)

---

## POC #2

**来源**: [CVE-2023-42931-tageniu_CVE-2023-42931.md](../2023/CVE-2023-42931-tageniu_CVE-2023-42931.md)

# CVE-2023-42931

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-42931-d0rb_CVE-2023-42931.md](../2023/CVE-2023-42931-d0rb_CVE-2023-42931.md)

## CVE-2023-42931 - macOS Privilege Escalation

**漏洞编号:** CVE-2023-42931

**漏洞类型:** 权限提升

**影响应用:** macOS

**危害等级:** 高危，可获取Root权限

**影响版本:** macOS Monterey < 12.7.2, macOS Ventura < 13.6.3, macOS Sonoma < 14.2

**利用条件:** 本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42931 允许低权限用户提升至 root 权限。根据搜索引擎结果（webpage 1, 4, 9），此漏洞与 'diskutil' 命令有关，允许利用不正确的权限处理来提升权限。漏洞利用代码（PoC.py）证实了这一点，通过以下步骤实现权限提升：

1.  **创建 Setuid Shell:**  创建一个具有 setuid 权限的 shell 程序，当执行该 shell 时，将以文件所有者的权限（即 root）运行。
2.  **挂载文件系统 (noowners):** 使用 `diskutil mount -mountOptions noowners /dev/disk3s4` 命令以 `noowners` 标志挂载文件系统。`noowners` 标志使得文件所有权的检查被忽略。
3.  **修改 .file 权限:**  将根目录下的 `.file` 文件的权限修改为 777，使其可读写可执行，从而允许任何用户修改该文件。
4.  **拷贝 Payload:** 将编译好的 setuid shell 程序拷贝到 `.file`。
5.  **设置 .file 权限:**  将 `.file` 的权限设置为 +sx，使其具有 setuid 权限。
6.  **重新挂载文件系统 (owners, suid):** 使用 `diskutil mount -mountOptions owners,suid /dev/disk3s4` 命令，以 `owners` 和 `suid` 标志重新挂载文件系统。这样，setuid 权限才能生效。
7.  **执行 Payload:**  执行位于根目录下的 `.file` 文件，由于该文件是 setuid 程序，因此会以 root 权限运行，从而获得 root shell。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在可用的PoC利用代码。提供的PoC代码的逻辑与漏洞描述相符，因此判断该PoC代码有效。

**投毒风险：**

*   `README.md`文件中包含指向`bringthemhomenow.net`的链接，这是一个政治声明，虽然不直接构成投毒，但表明作者具有一定的政治倾向，不排除在代码中加入恶意行为的可能性。
*   PoC的代码比较直接，目的是利用漏洞提升权限，没有发现明显的恶意行为。但是，该脚本直接使用 `os.system` 函数执行系统命令，这本身就存在一定的风险，如果作者有意为之，可以通过构造恶意的命令来执行任意代码。
*   此外，PoC 需要编译 C 代码，并将编译后的二进制文件复制到系统目录，这个过程也存在被篡改的风险。

综合考虑，虽然目前代码本身看起来没有明显的投毒行为，但是考虑到作者的政治倾向、`os.system` 的使用以及编译过程的潜在风险，认为存在10%的投毒风险。

**利用方式：** 该漏洞的利用方式是利用 'diskutil' 命令的权限管理缺陷，通过修改文件系统挂载选项，使得攻击者能够创建一个 setuid 程序，并以 root 权限执行。

**项目地址:** [d0rb/CVE-2023-42931](https://github.com/d0rb/CVE-2023-42931)

**漏洞详情:** [CVE-2023-42931](https://nvd.nist.gov/vuln/detail/CVE-2023-42931)

---

## POC #2

**来源**: [CVE-2023-42931-tageniu_CVE-2023-42931.md](../2023/CVE-2023-42931-tageniu_CVE-2023-42931.md)

# CVE-2023-42931

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-42931-d0rb_CVE-2023-42931.md](../2023/CVE-2023-42931-d0rb_CVE-2023-42931.md)

## CVE-2023-42931 - macOS Privilege Escalation

**漏洞编号:** CVE-2023-42931

**漏洞类型:** 权限提升

**影响应用:** macOS

**危害等级:** 高危，可获取Root权限

**影响版本:** macOS Monterey < 12.7.2, macOS Ventura < 13.6.3, macOS Sonoma < 14.2

**利用条件:** 本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42931 允许低权限用户提升至 root 权限。根据搜索引擎结果（webpage 1, 4, 9），此漏洞与 'diskutil' 命令有关，允许利用不正确的权限处理来提升权限。漏洞利用代码（PoC.py）证实了这一点，通过以下步骤实现权限提升：

1.  **创建 Setuid Shell:**  创建一个具有 setuid 权限的 shell 程序，当执行该 shell 时，将以文件所有者的权限（即 root）运行。
2.  **挂载文件系统 (noowners):** 使用 `diskutil mount -mountOptions noowners /dev/disk3s4` 命令以 `noowners` 标志挂载文件系统。`noowners` 标志使得文件所有权的检查被忽略。
3.  **修改 .file 权限:**  将根目录下的 `.file` 文件的权限修改为 777，使其可读写可执行，从而允许任何用户修改该文件。
4.  **拷贝 Payload:** 将编译好的 setuid shell 程序拷贝到 `.file`。
5.  **设置 .file 权限:**  将 `.file` 的权限设置为 +sx，使其具有 setuid 权限。
6.  **重新挂载文件系统 (owners, suid):** 使用 `diskutil mount -mountOptions owners,suid /dev/disk3s4` 命令，以 `owners` 和 `suid` 标志重新挂载文件系统。这样，setuid 权限才能生效。
7.  **执行 Payload:**  执行位于根目录下的 `.file` 文件，由于该文件是 setuid 程序，因此会以 root 权限运行，从而获得 root shell。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在可用的PoC利用代码。提供的PoC代码的逻辑与漏洞描述相符，因此判断该PoC代码有效。

**投毒风险：**

*   `README.md`文件中包含指向`bringthemhomenow.net`的链接，这是一个政治声明，虽然不直接构成投毒，但表明作者具有一定的政治倾向，不排除在代码中加入恶意行为的可能性。
*   PoC的代码比较直接，目的是利用漏洞提升权限，没有发现明显的恶意行为。但是，该脚本直接使用 `os.system` 函数执行系统命令，这本身就存在一定的风险，如果作者有意为之，可以通过构造恶意的命令来执行任意代码。
*   此外，PoC 需要编译 C 代码，并将编译后的二进制文件复制到系统目录，这个过程也存在被篡改的风险。

综合考虑，虽然目前代码本身看起来没有明显的投毒行为，但是考虑到作者的政治倾向、`os.system` 的使用以及编译过程的潜在风险，认为存在10%的投毒风险。

**利用方式：** 该漏洞的利用方式是利用 'diskutil' 命令的权限管理缺陷，通过修改文件系统挂载选项，使得攻击者能够创建一个 setuid 程序，并以 root 权限执行。

**项目地址:** [d0rb/CVE-2023-42931](https://github.com/d0rb/CVE-2023-42931)

**漏洞详情:** [CVE-2023-42931](https://nvd.nist.gov/vuln/detail/CVE-2023-42931)

---

## POC #2

**来源**: [CVE-2023-42931-tageniu_CVE-2023-42931.md](../2023/CVE-2023-42931-tageniu_CVE-2023-42931.md)

# CVE-2023-42931

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-42931-d0rb_CVE-2023-42931.md](../2023/CVE-2023-42931-d0rb_CVE-2023-42931.md)

## CVE-2023-42931 - macOS Privilege Escalation

**漏洞编号:** CVE-2023-42931

**漏洞类型:** 权限提升

**影响应用:** macOS

**危害等级:** 高危，可获取Root权限

**影响版本:** macOS Monterey < 12.7.2, macOS Ventura < 13.6.3, macOS Sonoma < 14.2

**利用条件:** 本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42931 允许低权限用户提升至 root 权限。根据搜索引擎结果（webpage 1, 4, 9），此漏洞与 'diskutil' 命令有关，允许利用不正确的权限处理来提升权限。漏洞利用代码（PoC.py）证实了这一点，通过以下步骤实现权限提升：

1.  **创建 Setuid Shell:**  创建一个具有 setuid 权限的 shell 程序，当执行该 shell 时，将以文件所有者的权限（即 root）运行。
2.  **挂载文件系统 (noowners):** 使用 `diskutil mount -mountOptions noowners /dev/disk3s4` 命令以 `noowners` 标志挂载文件系统。`noowners` 标志使得文件所有权的检查被忽略。
3.  **修改 .file 权限:**  将根目录下的 `.file` 文件的权限修改为 777，使其可读写可执行，从而允许任何用户修改该文件。
4.  **拷贝 Payload:** 将编译好的 setuid shell 程序拷贝到 `.file`。
5.  **设置 .file 权限:**  将 `.file` 的权限设置为 +sx，使其具有 setuid 权限。
6.  **重新挂载文件系统 (owners, suid):** 使用 `diskutil mount -mountOptions owners,suid /dev/disk3s4` 命令，以 `owners` 和 `suid` 标志重新挂载文件系统。这样，setuid 权限才能生效。
7.  **执行 Payload:**  执行位于根目录下的 `.file` 文件，由于该文件是 setuid 程序，因此会以 root 权限运行，从而获得 root shell。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在可用的PoC利用代码。提供的PoC代码的逻辑与漏洞描述相符，因此判断该PoC代码有效。

**投毒风险：**

*   `README.md`文件中包含指向`bringthemhomenow.net`的链接，这是一个政治声明，虽然不直接构成投毒，但表明作者具有一定的政治倾向，不排除在代码中加入恶意行为的可能性。
*   PoC的代码比较直接，目的是利用漏洞提升权限，没有发现明显的恶意行为。但是，该脚本直接使用 `os.system` 函数执行系统命令，这本身就存在一定的风险，如果作者有意为之，可以通过构造恶意的命令来执行任意代码。
*   此外，PoC 需要编译 C 代码，并将编译后的二进制文件复制到系统目录，这个过程也存在被篡改的风险。

综合考虑，虽然目前代码本身看起来没有明显的投毒行为，但是考虑到作者的政治倾向、`os.system` 的使用以及编译过程的潜在风险，认为存在10%的投毒风险。

**利用方式：** 该漏洞的利用方式是利用 'diskutil' 命令的权限管理缺陷，通过修改文件系统挂载选项，使得攻击者能够创建一个 setuid 程序，并以 root 权限执行。

**项目地址:** [d0rb/CVE-2023-42931](https://github.com/d0rb/CVE-2023-42931)

**漏洞详情:** [CVE-2023-42931](https://nvd.nist.gov/vuln/detail/CVE-2023-42931)

---

## POC #2

**来源**: [CVE-2023-42931-tageniu_CVE-2023-42931.md](../2023/CVE-2023-42931-tageniu_CVE-2023-42931.md)

# CVE-2023-42931

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-42931-d0rb_CVE-2023-42931.md](../2023/CVE-2023-42931-d0rb_CVE-2023-42931.md)

## CVE-2023-42931 - macOS Privilege Escalation

**漏洞编号:** CVE-2023-42931

**漏洞类型:** 权限提升

**影响应用:** macOS

**危害等级:** 高危，可获取Root权限

**影响版本:** macOS Monterey < 12.7.2, macOS Ventura < 13.6.3, macOS Sonoma < 14.2

**利用条件:** 本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42931 允许低权限用户提升至 root 权限。根据搜索引擎结果（webpage 1, 4, 9），此漏洞与 'diskutil' 命令有关，允许利用不正确的权限处理来提升权限。漏洞利用代码（PoC.py）证实了这一点，通过以下步骤实现权限提升：

1.  **创建 Setuid Shell:**  创建一个具有 setuid 权限的 shell 程序，当执行该 shell 时，将以文件所有者的权限（即 root）运行。
2.  **挂载文件系统 (noowners):** 使用 `diskutil mount -mountOptions noowners /dev/disk3s4` 命令以 `noowners` 标志挂载文件系统。`noowners` 标志使得文件所有权的检查被忽略。
3.  **修改 .file 权限:**  将根目录下的 `.file` 文件的权限修改为 777，使其可读写可执行，从而允许任何用户修改该文件。
4.  **拷贝 Payload:** 将编译好的 setuid shell 程序拷贝到 `.file`。
5.  **设置 .file 权限:**  将 `.file` 的权限设置为 +sx，使其具有 setuid 权限。
6.  **重新挂载文件系统 (owners, suid):** 使用 `diskutil mount -mountOptions owners,suid /dev/disk3s4` 命令，以 `owners` 和 `suid` 标志重新挂载文件系统。这样，setuid 权限才能生效。
7.  **执行 Payload:**  执行位于根目录下的 `.file` 文件，由于该文件是 setuid 程序，因此会以 root 权限运行，从而获得 root shell。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在可用的PoC利用代码。提供的PoC代码的逻辑与漏洞描述相符，因此判断该PoC代码有效。

**投毒风险：**

*   `README.md`文件中包含指向`bringthemhomenow.net`的链接，这是一个政治声明，虽然不直接构成投毒，但表明作者具有一定的政治倾向，不排除在代码中加入恶意行为的可能性。
*   PoC的代码比较直接，目的是利用漏洞提升权限，没有发现明显的恶意行为。但是，该脚本直接使用 `os.system` 函数执行系统命令，这本身就存在一定的风险，如果作者有意为之，可以通过构造恶意的命令来执行任意代码。
*   此外，PoC 需要编译 C 代码，并将编译后的二进制文件复制到系统目录，这个过程也存在被篡改的风险。

综合考虑，虽然目前代码本身看起来没有明显的投毒行为，但是考虑到作者的政治倾向、`os.system` 的使用以及编译过程的潜在风险，认为存在10%的投毒风险。

**利用方式：** 该漏洞的利用方式是利用 'diskutil' 命令的权限管理缺陷，通过修改文件系统挂载选项，使得攻击者能够创建一个 setuid 程序，并以 root 权限执行。

**项目地址:** [d0rb/CVE-2023-42931](https://github.com/d0rb/CVE-2023-42931)

**漏洞详情:** [CVE-2023-42931](https://nvd.nist.gov/vuln/detail/CVE-2023-42931)

---

## POC #2

**来源**: [CVE-2023-42931-tageniu_CVE-2023-42931.md](../2023/CVE-2023-42931-tageniu_CVE-2023-42931.md)

# CVE-2023-42931

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-42931-d0rb_CVE-2023-42931.md](../2023/CVE-2023-42931-d0rb_CVE-2023-42931.md)

## CVE-2023-42931 - macOS Privilege Escalation

**漏洞编号:** CVE-2023-42931

**漏洞类型:** 权限提升

**影响应用:** macOS

**危害等级:** 高危，可获取Root权限

**影响版本:** macOS Monterey < 12.7.2, macOS Ventura < 13.6.3, macOS Sonoma < 14.2

**利用条件:** 本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42931 允许低权限用户提升至 root 权限。根据搜索引擎结果（webpage 1, 4, 9），此漏洞与 'diskutil' 命令有关，允许利用不正确的权限处理来提升权限。漏洞利用代码（PoC.py）证实了这一点，通过以下步骤实现权限提升：

1.  **创建 Setuid Shell:**  创建一个具有 setuid 权限的 shell 程序，当执行该 shell 时，将以文件所有者的权限（即 root）运行。
2.  **挂载文件系统 (noowners):** 使用 `diskutil mount -mountOptions noowners /dev/disk3s4` 命令以 `noowners` 标志挂载文件系统。`noowners` 标志使得文件所有权的检查被忽略。
3.  **修改 .file 权限:**  将根目录下的 `.file` 文件的权限修改为 777，使其可读写可执行，从而允许任何用户修改该文件。
4.  **拷贝 Payload:** 将编译好的 setuid shell 程序拷贝到 `.file`。
5.  **设置 .file 权限:**  将 `.file` 的权限设置为 +sx，使其具有 setuid 权限。
6.  **重新挂载文件系统 (owners, suid):** 使用 `diskutil mount -mountOptions owners,suid /dev/disk3s4` 命令，以 `owners` 和 `suid` 标志重新挂载文件系统。这样，setuid 权限才能生效。
7.  **执行 Payload:**  执行位于根目录下的 `.file` 文件，由于该文件是 setuid 程序，因此会以 root 权限运行，从而获得 root shell。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在可用的PoC利用代码。提供的PoC代码的逻辑与漏洞描述相符，因此判断该PoC代码有效。

**投毒风险：**

*   `README.md`文件中包含指向`bringthemhomenow.net`的链接，这是一个政治声明，虽然不直接构成投毒，但表明作者具有一定的政治倾向，不排除在代码中加入恶意行为的可能性。
*   PoC的代码比较直接，目的是利用漏洞提升权限，没有发现明显的恶意行为。但是，该脚本直接使用 `os.system` 函数执行系统命令，这本身就存在一定的风险，如果作者有意为之，可以通过构造恶意的命令来执行任意代码。
*   此外，PoC 需要编译 C 代码，并将编译后的二进制文件复制到系统目录，这个过程也存在被篡改的风险。

综合考虑，虽然目前代码本身看起来没有明显的投毒行为，但是考虑到作者的政治倾向、`os.system` 的使用以及编译过程的潜在风险，认为存在10%的投毒风险。

**利用方式：** 该漏洞的利用方式是利用 'diskutil' 命令的权限管理缺陷，通过修改文件系统挂载选项，使得攻击者能够创建一个 setuid 程序，并以 root 权限执行。

**项目地址:** [d0rb/CVE-2023-42931](https://github.com/d0rb/CVE-2023-42931)

**漏洞详情:** [CVE-2023-42931](https://nvd.nist.gov/vuln/detail/CVE-2023-42931)

---

## POC #2

**来源**: [CVE-2023-42931-tageniu_CVE-2023-42931.md](../2023/CVE-2023-42931-tageniu_CVE-2023-42931.md)

# CVE-2023-42931

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-42931-d0rb_CVE-2023-42931.md](../2023/CVE-2023-42931-d0rb_CVE-2023-42931.md)

## CVE-2023-42931 - macOS Privilege Escalation

**漏洞编号:** CVE-2023-42931

**漏洞类型:** 权限提升

**影响应用:** macOS

**危害等级:** 高危，可获取Root权限

**影响版本:** macOS Monterey < 12.7.2, macOS Ventura < 13.6.3, macOS Sonoma < 14.2

**利用条件:** 本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42931 允许低权限用户提升至 root 权限。根据搜索引擎结果（webpage 1, 4, 9），此漏洞与 'diskutil' 命令有关，允许利用不正确的权限处理来提升权限。漏洞利用代码（PoC.py）证实了这一点，通过以下步骤实现权限提升：

1.  **创建 Setuid Shell:**  创建一个具有 setuid 权限的 shell 程序，当执行该 shell 时，将以文件所有者的权限（即 root）运行。
2.  **挂载文件系统 (noowners):** 使用 `diskutil mount -mountOptions noowners /dev/disk3s4` 命令以 `noowners` 标志挂载文件系统。`noowners` 标志使得文件所有权的检查被忽略。
3.  **修改 .file 权限:**  将根目录下的 `.file` 文件的权限修改为 777，使其可读写可执行，从而允许任何用户修改该文件。
4.  **拷贝 Payload:** 将编译好的 setuid shell 程序拷贝到 `.file`。
5.  **设置 .file 权限:**  将 `.file` 的权限设置为 +sx，使其具有 setuid 权限。
6.  **重新挂载文件系统 (owners, suid):** 使用 `diskutil mount -mountOptions owners,suid /dev/disk3s4` 命令，以 `owners` 和 `suid` 标志重新挂载文件系统。这样，setuid 权限才能生效。
7.  **执行 Payload:**  执行位于根目录下的 `.file` 文件，由于该文件是 setuid 程序，因此会以 root 权限运行，从而获得 root shell。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在可用的PoC利用代码。提供的PoC代码的逻辑与漏洞描述相符，因此判断该PoC代码有效。

**投毒风险：**

*   `README.md`文件中包含指向`bringthemhomenow.net`的链接，这是一个政治声明，虽然不直接构成投毒，但表明作者具有一定的政治倾向，不排除在代码中加入恶意行为的可能性。
*   PoC的代码比较直接，目的是利用漏洞提升权限，没有发现明显的恶意行为。但是，该脚本直接使用 `os.system` 函数执行系统命令，这本身就存在一定的风险，如果作者有意为之，可以通过构造恶意的命令来执行任意代码。
*   此外，PoC 需要编译 C 代码，并将编译后的二进制文件复制到系统目录，这个过程也存在被篡改的风险。

综合考虑，虽然目前代码本身看起来没有明显的投毒行为，但是考虑到作者的政治倾向、`os.system` 的使用以及编译过程的潜在风险，认为存在10%的投毒风险。

**利用方式：** 该漏洞的利用方式是利用 'diskutil' 命令的权限管理缺陷，通过修改文件系统挂载选项，使得攻击者能够创建一个 setuid 程序，并以 root 权限执行。

**项目地址:** [d0rb/CVE-2023-42931](https://github.com/d0rb/CVE-2023-42931)

**漏洞详情:** [CVE-2023-42931](https://nvd.nist.gov/vuln/detail/CVE-2023-42931)

---

## POC #2

**来源**: [CVE-2023-42931-tageniu_CVE-2023-42931.md](../2023/CVE-2023-42931-tageniu_CVE-2023-42931.md)

# CVE-2023-42931

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-42931-d0rb_CVE-2023-42931.md](../2023/CVE-2023-42931-d0rb_CVE-2023-42931.md)

## CVE-2023-42931 - macOS Privilege Escalation

**漏洞编号:** CVE-2023-42931

**漏洞类型:** 权限提升

**影响应用:** macOS

**危害等级:** 高危，可获取Root权限

**影响版本:** macOS Monterey < 12.7.2, macOS Ventura < 13.6.3, macOS Sonoma < 14.2

**利用条件:** 本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42931 允许低权限用户提升至 root 权限。根据搜索引擎结果（webpage 1, 4, 9），此漏洞与 'diskutil' 命令有关，允许利用不正确的权限处理来提升权限。漏洞利用代码（PoC.py）证实了这一点，通过以下步骤实现权限提升：

1.  **创建 Setuid Shell:**  创建一个具有 setuid 权限的 shell 程序，当执行该 shell 时，将以文件所有者的权限（即 root）运行。
2.  **挂载文件系统 (noowners):** 使用 `diskutil mount -mountOptions noowners /dev/disk3s4` 命令以 `noowners` 标志挂载文件系统。`noowners` 标志使得文件所有权的检查被忽略。
3.  **修改 .file 权限:**  将根目录下的 `.file` 文件的权限修改为 777，使其可读写可执行，从而允许任何用户修改该文件。
4.  **拷贝 Payload:** 将编译好的 setuid shell 程序拷贝到 `.file`。
5.  **设置 .file 权限:**  将 `.file` 的权限设置为 +sx，使其具有 setuid 权限。
6.  **重新挂载文件系统 (owners, suid):** 使用 `diskutil mount -mountOptions owners,suid /dev/disk3s4` 命令，以 `owners` 和 `suid` 标志重新挂载文件系统。这样，setuid 权限才能生效。
7.  **执行 Payload:**  执行位于根目录下的 `.file` 文件，由于该文件是 setuid 程序，因此会以 root 权限运行，从而获得 root shell。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在可用的PoC利用代码。提供的PoC代码的逻辑与漏洞描述相符，因此判断该PoC代码有效。

**投毒风险：**

*   `README.md`文件中包含指向`bringthemhomenow.net`的链接，这是一个政治声明，虽然不直接构成投毒，但表明作者具有一定的政治倾向，不排除在代码中加入恶意行为的可能性。
*   PoC的代码比较直接，目的是利用漏洞提升权限，没有发现明显的恶意行为。但是，该脚本直接使用 `os.system` 函数执行系统命令，这本身就存在一定的风险，如果作者有意为之，可以通过构造恶意的命令来执行任意代码。
*   此外，PoC 需要编译 C 代码，并将编译后的二进制文件复制到系统目录，这个过程也存在被篡改的风险。

综合考虑，虽然目前代码本身看起来没有明显的投毒行为，但是考虑到作者的政治倾向、`os.system` 的使用以及编译过程的潜在风险，认为存在10%的投毒风险。

**利用方式：** 该漏洞的利用方式是利用 'diskutil' 命令的权限管理缺陷，通过修改文件系统挂载选项，使得攻击者能够创建一个 setuid 程序，并以 root 权限执行。

**项目地址:** [d0rb/CVE-2023-42931](https://github.com/d0rb/CVE-2023-42931)

**漏洞详情:** [CVE-2023-42931](https://nvd.nist.gov/vuln/detail/CVE-2023-42931)

---

## POC #2

**来源**: [CVE-2023-42931-tageniu_CVE-2023-42931.md](../2023/CVE-2023-42931-tageniu_CVE-2023-42931.md)

# CVE-2023-42931

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-42931-d0rb_CVE-2023-42931.md](../2023/CVE-2023-42931-d0rb_CVE-2023-42931.md)

## CVE-2023-42931 - macOS Privilege Escalation

**漏洞编号:** CVE-2023-42931

**漏洞类型:** 权限提升

**影响应用:** macOS

**危害等级:** 高危，可获取Root权限

**影响版本:** macOS Monterey < 12.7.2, macOS Ventura < 13.6.3, macOS Sonoma < 14.2

**利用条件:** 本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42931 允许低权限用户提升至 root 权限。根据搜索引擎结果（webpage 1, 4, 9），此漏洞与 'diskutil' 命令有关，允许利用不正确的权限处理来提升权限。漏洞利用代码（PoC.py）证实了这一点，通过以下步骤实现权限提升：

1.  **创建 Setuid Shell:**  创建一个具有 setuid 权限的 shell 程序，当执行该 shell 时，将以文件所有者的权限（即 root）运行。
2.  **挂载文件系统 (noowners):** 使用 `diskutil mount -mountOptions noowners /dev/disk3s4` 命令以 `noowners` 标志挂载文件系统。`noowners` 标志使得文件所有权的检查被忽略。
3.  **修改 .file 权限:**  将根目录下的 `.file` 文件的权限修改为 777，使其可读写可执行，从而允许任何用户修改该文件。
4.  **拷贝 Payload:** 将编译好的 setuid shell 程序拷贝到 `.file`。
5.  **设置 .file 权限:**  将 `.file` 的权限设置为 +sx，使其具有 setuid 权限。
6.  **重新挂载文件系统 (owners, suid):** 使用 `diskutil mount -mountOptions owners,suid /dev/disk3s4` 命令，以 `owners` 和 `suid` 标志重新挂载文件系统。这样，setuid 权限才能生效。
7.  **执行 Payload:**  执行位于根目录下的 `.file` 文件，由于该文件是 setuid 程序，因此会以 root 权限运行，从而获得 root shell。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在可用的PoC利用代码。提供的PoC代码的逻辑与漏洞描述相符，因此判断该PoC代码有效。

**投毒风险：**

*   `README.md`文件中包含指向`bringthemhomenow.net`的链接，这是一个政治声明，虽然不直接构成投毒，但表明作者具有一定的政治倾向，不排除在代码中加入恶意行为的可能性。
*   PoC的代码比较直接，目的是利用漏洞提升权限，没有发现明显的恶意行为。但是，该脚本直接使用 `os.system` 函数执行系统命令，这本身就存在一定的风险，如果作者有意为之，可以通过构造恶意的命令来执行任意代码。
*   此外，PoC 需要编译 C 代码，并将编译后的二进制文件复制到系统目录，这个过程也存在被篡改的风险。

综合考虑，虽然目前代码本身看起来没有明显的投毒行为，但是考虑到作者的政治倾向、`os.system` 的使用以及编译过程的潜在风险，认为存在10%的投毒风险。

**利用方式：** 该漏洞的利用方式是利用 'diskutil' 命令的权限管理缺陷，通过修改文件系统挂载选项，使得攻击者能够创建一个 setuid 程序，并以 root 权限执行。

**项目地址:** [d0rb/CVE-2023-42931](https://github.com/d0rb/CVE-2023-42931)

**漏洞详情:** [CVE-2023-42931](https://nvd.nist.gov/vuln/detail/CVE-2023-42931)

---

## POC #2

**来源**: [CVE-2023-42931-tageniu_CVE-2023-42931.md](../2023/CVE-2023-42931-tageniu_CVE-2023-42931.md)

# CVE-2023-42931

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-42931-d0rb_CVE-2023-42931.md](../2023/CVE-2023-42931-d0rb_CVE-2023-42931.md)

## CVE-2023-42931 - macOS Privilege Escalation

**漏洞编号:** CVE-2023-42931

**漏洞类型:** 权限提升

**影响应用:** macOS

**危害等级:** 高危，可获取Root权限

**影响版本:** macOS Monterey < 12.7.2, macOS Ventura < 13.6.3, macOS Sonoma < 14.2

**利用条件:** 本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42931 允许低权限用户提升至 root 权限。根据搜索引擎结果（webpage 1, 4, 9），此漏洞与 'diskutil' 命令有关，允许利用不正确的权限处理来提升权限。漏洞利用代码（PoC.py）证实了这一点，通过以下步骤实现权限提升：

1.  **创建 Setuid Shell:**  创建一个具有 setuid 权限的 shell 程序，当执行该 shell 时，将以文件所有者的权限（即 root）运行。
2.  **挂载文件系统 (noowners):** 使用 `diskutil mount -mountOptions noowners /dev/disk3s4` 命令以 `noowners` 标志挂载文件系统。`noowners` 标志使得文件所有权的检查被忽略。
3.  **修改 .file 权限:**  将根目录下的 `.file` 文件的权限修改为 777，使其可读写可执行，从而允许任何用户修改该文件。
4.  **拷贝 Payload:** 将编译好的 setuid shell 程序拷贝到 `.file`。
5.  **设置 .file 权限:**  将 `.file` 的权限设置为 +sx，使其具有 setuid 权限。
6.  **重新挂载文件系统 (owners, suid):** 使用 `diskutil mount -mountOptions owners,suid /dev/disk3s4` 命令，以 `owners` 和 `suid` 标志重新挂载文件系统。这样，setuid 权限才能生效。
7.  **执行 Payload:**  执行位于根目录下的 `.file` 文件，由于该文件是 setuid 程序，因此会以 root 权限运行，从而获得 root shell。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在可用的PoC利用代码。提供的PoC代码的逻辑与漏洞描述相符，因此判断该PoC代码有效。

**投毒风险：**

*   `README.md`文件中包含指向`bringthemhomenow.net`的链接，这是一个政治声明，虽然不直接构成投毒，但表明作者具有一定的政治倾向，不排除在代码中加入恶意行为的可能性。
*   PoC的代码比较直接，目的是利用漏洞提升权限，没有发现明显的恶意行为。但是，该脚本直接使用 `os.system` 函数执行系统命令，这本身就存在一定的风险，如果作者有意为之，可以通过构造恶意的命令来执行任意代码。
*   此外，PoC 需要编译 C 代码，并将编译后的二进制文件复制到系统目录，这个过程也存在被篡改的风险。

综合考虑，虽然目前代码本身看起来没有明显的投毒行为，但是考虑到作者的政治倾向、`os.system` 的使用以及编译过程的潜在风险，认为存在10%的投毒风险。

**利用方式：** 该漏洞的利用方式是利用 'diskutil' 命令的权限管理缺陷，通过修改文件系统挂载选项，使得攻击者能够创建一个 setuid 程序，并以 root 权限执行。

**项目地址:** [d0rb/CVE-2023-42931](https://github.com/d0rb/CVE-2023-42931)

**漏洞详情:** [CVE-2023-42931](https://nvd.nist.gov/vuln/detail/CVE-2023-42931)

---

## POC #2

**来源**: [CVE-2023-42931-tageniu_CVE-2023-42931.md](../2023/CVE-2023-42931-tageniu_CVE-2023-42931.md)

## CVE-2023-42931 - macOS Privilege Escalation

**漏洞编号:** CVE-2023-42931

**漏洞类型:** 特权提升

**影响应用:** macOS

**危害等级:** 高危，可导致未经授权的管理员权限获取

**影响版本:** macOS 14.0-14.1.2, 13.0-13.6.2, 12.0-12.7.1

**利用条件:** 本地访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42931 是 macOS 中的一个特权提升漏洞。根据漏洞库信息，未经授权的进程可以获得管理员权限。搜索引擎结果显示，该漏洞存在于 macOS Monterey、Ventura 和 Sonoma 的特定版本中，并在后续更新中得到了修复。提供的PoC代码尝试利用此漏洞：

1.  **有效性：**PoC代码的主要思路是利用`diskutil`命令，首先以`noowners`选项挂载文件系统，这将允许修改文件权限。然后，它创建一个setuid shell，将其复制到`.file`目录，设置权限，最后执行该shell来获得root权限。这种方法如果成功，就可以绕过权限检查获得root权限。从搜索结果中来看，Github上已经有相关的POC存在，所以**POC的有效性较高**。

2.  **投毒风险：**

*   **Payload创建：**PoC创建了一个简单的setuid shell，这是提权的标准方法，本身不包含恶意代码。
*   **挂载选项：**使用`noowners`挂载选项是漏洞利用的关键，允许修改文件权限。
*   **.file目录：**目标是复制到`.file`，然后更改`.file`的权限。这是一个常见的利用方式，但需要注意是否包含其他恶意操作。如果`.file`目录事先已经存在恶意文件，或者在复制setuid shell之后还存在其他操作，则可能构成投毒。
*   **代码审查：**仔细审查PoC脚本，发现没有明显的恶意代码注入或后门。脚本执行的每一步都有明确的目的，并且与漏洞利用相关。

综合分析，该PoC代码中**可能存在投毒代码的可能性较低**，大约为10%。风险主要集中在：如果攻击者修改了原始的`/tmp/suidshell.c`文件，在`system("/bin/bash")`之前或者之后加入一些恶意的操作，就有可能存在投毒风险。

3.  **利用方式：**
    *   **查找根磁盘标识符:** 使用`diskutil info`命令获取根磁盘的标识符。
    *   **以`noowners`挂载:** 使用`diskutil`命令以`noowners`选项卸载并重新挂载根文件系统。这将允许修改文件权限，而无需进行严格的权限检查。
    *   **创建和复制setuid shell:** 创建一个setuid shell，并将其复制到根文件系统中的`.file`隐藏目录。将该shell设置为setuid，以便以root权限运行。
    *   **执行setuid shell:** 通过运行位于`.file`目录中的setuid shell，攻击者可以获得root权限。
    *   **重新挂载文件系统:** 重新挂载文件系统，恢复原始状态。

该漏洞的本质是macOS在处理文件系统权限时存在缺陷，允许攻击者通过修改挂载选项和利用setuid机制来提升权限。

**项目地址:** [tageniu/CVE-2023-42931](https://github.com/tageniu/CVE-2023-42931)

**漏洞详情:** [CVE-2023-42931](https://nvd.nist.gov/vuln/detail/CVE-2023-42931)

---



---



---



---



---



---



---



---



---



---



---



---



---



---

