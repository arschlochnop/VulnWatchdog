## CVE-2023-4220 - Chamilo LMS 远程代码执行 (RCE)

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Chamilo LMS

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** <= 1.11.24

**利用条件:** 无需认证，可通过网络直接访问目标系统。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞存在于Chamilo LMS的bigupload组件中。由于/main/inc/lib/javascript/bigupload/inc/bigUpload.php脚本在处理文件上传请求时未对用户身份进行充分验证，且允许上传不受支持的文件类型（action=post-unsupported），攻击者可以上传恶意的PHP WebShell。POC中提供的Bash脚本和Python脚本通过简单的HTTP POST请求将PHP代码（如jiji.php）上传至服务器的指定目录（/main/inc/lib/javascript/bigupload/files/），随后通过GET请求执行该文件。该POC包含了多种Payload选项，包括交互式反弹Shell（Reverse Shell），经测试其利用逻辑完全符合该漏洞的CVE描述。利用步骤：1. 攻击者首先通过本地构造包含system()或exec()函数的PHP文件；2. 发送包含该文件的HTTP POST请求至目标服务器的bigUpload.php接口；3. 服务器由于校验缺失将文件保存至Web公开目录；4. 攻击者访问该上传文件的URL并附带指令参数，从而在目标服务器上实现任意命令执行。投毒风险分析：该POC项目代码透明度较高，主要逻辑由Python和Bash脚本组成。在Python脚本中，其主要操作是调用系统原生的curl命令或使用标准输入输出，未发现明显的代码混淆或加壳行为。脚本中包含的Payload（如mkfifo、nc、python pty等）均属于合法的渗透测试常用反弹Shell命令，不应将其判定为恶意投毒。然而，风险点在于其依赖库的使用，如pyfiglet和colorama，在实际部署防御措施时，需注意从官方仓库获取这些依赖。POC中没有发现隐藏的外部服务器通信、自动删除痕迹或加密混淆等典型的投毒特征。虽然存在少量的外部链接引用（StarLabs咨询页面），但均属于安全研究机构的正规文档。综合评估，该POC是合法的安全研究代码，投毒风险较低，主要风险来自于该漏洞极易被武器化利用，组织应立即针对相关路径实施阻断或更新补丁。

**项目地址:** [https://starlabs.sg/advisories/23/23-4220/](https://starlabs.sg/advisories/23/23-4220/)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)
