# CVE-2023-1698

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-1698-Chocapikk_CVE-2023-1698.md](../2023/CVE-2023-1698-Chocapikk_CVE-2023-1698.md)

# CVE-2023-1698

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-1698-Chocapikk_CVE-2023-1698.md](../2023/CVE-2023-1698-Chocapikk_CVE-2023-1698.md)

# CVE-2023-1698

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-1698-Chocapikk_CVE-2023-1698.md](../2023/CVE-2023-1698-Chocapikk_CVE-2023-1698.md)

# CVE-2023-1698

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-1698-Chocapikk_CVE-2023-1698.md](../2023/CVE-2023-1698-Chocapikk_CVE-2023-1698.md)

# CVE-2023-1698

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-1698-Chocapikk_CVE-2023-1698.md](../2023/CVE-2023-1698-Chocapikk_CVE-2023-1698.md)

# CVE-2023-1698

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-1698-Chocapikk_CVE-2023-1698.md](../2023/CVE-2023-1698-Chocapikk_CVE-2023-1698.md)

# CVE-2023-1698

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-1698-Chocapikk_CVE-2023-1698.md](../2023/CVE-2023-1698-Chocapikk_CVE-2023-1698.md)

# CVE-2023-1698

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-1698-Chocapikk_CVE-2023-1698.md](../2023/CVE-2023-1698-Chocapikk_CVE-2023-1698.md)

# CVE-2023-1698

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-1698-Chocapikk_CVE-2023-1698.md](../2023/CVE-2023-1698-Chocapikk_CVE-2023-1698.md)

## CVE-2023-1698 WAGO Remote Code Execution

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WAGO Compact Controller CC100, Edge Controller, PFC100, PFC200, Touch Panel 600系列

**危害等级:** 高危，未经身份验证的远程攻击者可以创建新用户、更改设备配置，导致拒绝服务和完全系统入侵

**影响版本:** FW20 <= 版本 <= FW22, FW23

**利用条件:** 目标设备需开启Web管理界面，攻击者需要能够通过网络访问目标设备

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-1698 是 WAGO 产品中的一个命令注入漏洞，未经身份验证的远程攻击者可利用此漏洞执行任意命令。根据漏洞库信息，受影响的产品包括 Compact Controller CC100, Edge Controller, PFC100, PFC200 以及 Touch Panel 600 系列，受影响的固件版本主要是FW20到FW22，以及FW23。

**有效性：**
根据搜索结果和漏洞利用代码，该漏洞的POC是有效的。GitHub上存在公开的漏洞利用脚本，并且有安全厂商发布了相关的漏洞分析报告，证明了该漏洞的可利用性。

**投毒风险：**
该 POC 脚本主要通过构造恶意的 HTTP POST 请求，向 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 发送包含恶意 payload 的 `package` 参数，其中 `XXX` 表示具体的产品型号（PFC100, PFC200等）。Payload 中使用 `echo -n [S]` 和 `echo -n [E]` 来标记命令执行结果的开始和结束，以便提取执行结果。脚本中没有明显的投毒代码，只是一个简单的命令执行利用工具。

因此，投毒风险较低，约为1%。主要是因为该代码的功能明确，没有发现任何隐藏的、与漏洞利用无关的恶意行为。极小概率的风险可能来自于代码中潜在的、未知的bug，但从目前的分析来看，这种可能性很小。

**利用方式：**
1.  **漏洞定位：**  该漏洞位于 WAGO 设备的 Web 管理界面中的 "Legal Information" 插件。
2.  **攻击向量：**  通过向特定的 URL（`/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php`）发送特制的 HTTP POST 请求。
3.  **Payload 构造：**  在 POST 请求的 `package` 参数中包含恶意命令，利用命令注入漏洞执行任意系统命令。
4.  **命令执行：**  WAGO 设备在处理该请求时，由于未对 `package` 参数进行充分的验证和过滤，导致系统执行了攻击者注入的命令。
5.  **结果提取：**  利用 `echo` 命令标记命令执行结果的开始和结束，从而方便从响应中提取命令执行的结果。
6.  **权限提升/控制：** 攻击者可以通过该漏洞创建新用户，修改设备配置，甚至完全控制受影响的 WAGO 设备，造成拒绝服务或系统完全入侵。

**项目地址:** [Chocapikk/CVE-2023-1698](https://github.com/Chocapikk/CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---

## POC #2

**来源**: [CVE-2023-1698-X3RX3SSec_CVE-2023-1698.md](../2023/CVE-2023-1698-X3RX3SSec_CVE-2023-1698.md)

## CVE-2023-1698-WAGO-RCE

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行

**影响应用:** WAGO PFC100, PFC200, CC100, Edge Controller, Touch Panel 600 Standard, Advanced and Marine Line

**危害等级:** 高危，允许未授权远程攻击者创建新用户并更改设备配置，可能导致拒绝服务和完全系统破坏

**影响版本:** <= FW22 (FW20, FW23也受影响)

**利用条件:** 需要网络访问目标WAGO PLC设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-1698是一个WAGO产品中的远程代码执行漏洞。未经身份验证的远程攻击者可以利用此漏洞创建新用户并更改设备配置，从而导致拒绝服务或完全系统入侵。

**有效性：**
提供的PoC代码 `wago_exploit.py` 旨在利用 CVE-2023-1698，通过向 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 发送包含恶意命令的 POST 请求来执行任意命令。代码使用 `requests` 库发送 HTTP 请求，并通过正则表达式提取命令执行的结果。根据描述和代码结构，PoC 有效。

**投毒风险：**
PoC代码主要功能是发送包含恶意命令的payload，并提取返回结果。该代码结构相对简单，主要功能是发送恶意请求，提取结果，因此投毒风险较低。但仍存在潜在风险：

*   **依赖项投毒：** `requirements.txt` 文件中存在 `requests` 和 `colorama` 依赖。存在依赖包被恶意篡改的可能，但需要攻击者替换官方源或进行中间人攻击，概率较低。
*   **命令注入风险：** PoC允许用户自定义命令，若用户输入不当命令可能造成自身系统损害。
*   **代码逻辑混淆：** 代码中存在一定量的注释和字符串，可以隐藏恶意代码。但当前代码逻辑比较清晰，恶意代码隐藏的难度较大。

基于以上分析，投毒风险较低，约为 10%。

**利用方式：**
1.  攻击者首先需要确定目标WAGO设备的IP地址和端口。
2.  攻击者运行 `wago_exploit.py` 脚本，并指定目标设备的URL。
3.  脚本会构造一个包含恶意命令的POST请求，并将其发送到目标设备的 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 接口。
4.  目标设备执行恶意命令。
5.  脚本解析响应，提取命令执行的结果并显示给攻击者。

通过此方法，攻击者可以在目标设备上执行任意命令，包括创建新用户、更改设备配置、读取敏感信息等。

**结论：**
CVE-2023-1698 是一个严重的安全漏洞，利用门槛低，危害性高。提供的 PoC 代码可以有效地利用此漏洞。虽然投毒风险较低，但在使用任何公开的漏洞利用代码时，都应谨慎评估风险。

**项目地址:** [X3RX3SSec/CVE-2023-1698](https://github.com/X3RX3SSec/CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---

## POC #3

**来源**: [CVE-2023-1698-deIndra_CVE-2023-1698.md](../2023/CVE-2023-1698-deIndra_CVE-2023-1698.md)

## CVE-2023-1698-WAGO-远程代码执行

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行

**影响应用:** WAGO Compact Controller CC100, Edge Controller, PFC100, PFC200, Touch Panel 600系列

**危害等级:** 高危，允许未经验证的远程攻击者创建新用户并更改设备配置，可能导致拒绝服务和完全系统入侵。

**影响版本:** Compact Controller CC100 (FW20 <= FW <= FW22, FW23), Edge Controller (FW22), PFC100 (FW20 <= FW <= FW22, FW23), PFC200 (FW20 <= FW <= FW22, FW23), Touch Panel 600 (FW22)

**利用条件:** 目标设备必须存在漏洞，攻击者需要能够通过网络访问目标设备的Web管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-1698 存在于 WAGO 的多个产品中，是一个未经身份验证的远程命令注入漏洞。攻击者可以通过向 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 发送特制的 POST 请求，在 `package` 参数中注入恶意代码来执行任意命令。从搜索结果和漏洞利用代码来看，该漏洞存在公开可用的 PoC 并且已经被积极利用。该PoC利用了wbm-legal-information插件中的命令注入漏洞，通过修改package的值来执行系统命令。投毒风险评估为10%，原因是代码中直接硬编码了请求路径和参数，降低了攻击者修改Payload后进行更大规模恶意传播的可能性，且代码中未发现明显的后门或恶意行为，只有可能攻击者在exp文件中加入恶意代码。

利用方式：
1.  攻击者构造包含恶意命令的 POST 请求，发送到目标设备的 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 路径，其中 XXX 需要根据目标设备的型号进行调整。
2.  恶意命令被服务器执行，攻击者从而控制设备。
3. 攻击者可以创建新用户，修改配置，甚至完全控制系统。

参考信息：
*   漏洞库信息表明该漏洞影响多个 WAGO 产品，CVSS 评分为 9.8，属于严重漏洞。
*   搜索结果表明存在公开的漏洞细节和 PoC 代码。
*   漏洞利用代码验证了该漏洞的存在，通过修改`package`参数实现了命令执行。

**项目地址:** [deIndra/CVE-2023-1698](https://github.com/deIndra/CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---

## POC #4

**来源**: [CVE-2023-1698-ibrahmsql_CVE-2023-1698.md](../2023/CVE-2023-1698-ibrahmsql_CVE-2023-1698.md)

## CVE-2023-1698-WAGO-远程代码执行

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** WAGO Compact Controller CC100, Edge Controller, PFC100, PFC200, Touch Panel 600 系列

**危害等级:** 高危，可能导致完全系统控制、拒绝服务、未授权访问和配置更改

**影响版本:** FW20 <= 版本 <= FW22, FW23 (部分产品)

**利用条件:** 目标设备开启了Web管理界面，且攻击者可以发起网络请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-1698 是 WAGO 产品中的一个远程代码执行漏洞。未经身份验证的远程攻击者可以通过构造恶意请求，利用该漏洞在目标系统上执行任意命令，例如创建新用户和更改设备配置。漏洞存在于 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 接口。POC代码通过构造包含恶意命令的JSON数据包，利用 `Package` 字段中的命令注入点执行系统命令，并通过 `[PWNED_START]` 和 `[PWNED_END]` 标记来解析命令执行结果。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用的有效性较高。搜索引擎中存在多个关于此漏洞的描述和利用工具的链接，表明该漏洞已得到广泛关注和研究。提供的漏洞利用代码是一个使用 Go 语言编写的 PoC，能够远程执行命令，进一步验证了漏洞的有效性。

**投毒风险：**
该PoC代码存在轻微的投毒风险。主要风险点在于以下几个方面：
1.  **自定义User-Agent：** PoC允许自定义User-Agent，攻击者可以将User-Agent设置为恶意值，用于进一步攻击或识别。
2.  **InsecureSkipVerify：** PoC中的TLS配置`InsecureSkipVerify: true` 会跳过SSL证书验证，如果目标网络存在中间人攻击，可能导致敏感信息泄露。
3. **命令执行回显：** PoC会将命令执行结果回显，这可能泄露敏感信息。
4. **交互式Shell：** PoC包含一个启动交互式shell的函数，该shell存在被滥用的风险。

虽然以上存在一些风险，但是PoC代码主体是实现了漏洞利用的功能，恶意投毒概率较低，故投毒概率为5%.

**利用方式：**
1.  **确定目标：** 找到存在漏洞的WAGO设备，并确认其Web管理界面开启。确认目标设备的固件版本是否在受影响的范围内。
2.  **构造Payload：**  使用提供的 PoC 脚本，构造包含要执行命令的 JSON Payload。关键在于 `Package` 字段，攻击者将要执行的命令嵌入到该字段中。
3.  **发送请求：**  使用 HTTP POST 请求将构造的 Payload 发送到目标设备的 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 接口。
4.  **解析结果：**  从响应中提取命令执行的结果。PoC 使用 `[PWNED_START]` 和 `[PWNED_END]` 作为分隔符，方便解析命令执行的输出。
5.  **后续操作：** 根据执行命令的结果，进一步控制系统，例如创建新用户、修改配置、安装恶意软件等。

**项目地址:** [ibrahmsql/CVE-2023-1698](https://github.com/ibrahmsql/CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---

## POC #5

**来源**: [CVE-2023-1698-thedarknessdied_WAGO-CVE-2023-1698.md](../2023/CVE-2023-1698-thedarknessdied_WAGO-CVE-2023-1698.md)

## CVE-2023-1698-WAGO产品远程代码执行

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行

**影响应用:** WAGO Compact Controller CC100, Edge Controller, PFC100, PFC200, Touch Panel 600系列

**危害等级:** 高危，允许未授权远程攻击者创建新用户并更改设备配置，导致拒绝服务和完全系统入侵

**影响版本:** Compact Controller CC100 (FW20 <= FW <= FW22, FW23), Edge Controller (FW22), PFC100 (FW20 <= FW <= FW22, FW23), PFC200 (FW20 <= FW <= FW22, FW23), Touch Panel 600 (FW22)

**利用条件:** 目标设备存在漏洞且网络可达，无需身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以进行以下分析：

1.  **有效性：**  提供的POC代码（WAGO-CVE-2023-1698.py）是一个Python脚本，旨在利用CVE-2023-1698漏洞。 搜索结果表明，存在公开可用的漏洞利用工具和脚本，进一步支持了POC的有效性。该脚本允许通过指定URL或文件列表来利用漏洞，并支持执行远程命令、包含远程或本地文件等功能。因此，提供的POC代码是有效的。

2.  **投毒风险：**  查看提供的POC代码，主要功能是发送恶意请求，并没有发现明显的后门或者恶意代码。主要代码包括参数解析，发送HTTP请求，从远程拉取文件执行命令等功能，这些都是正常的漏洞利用方式，因此，投毒风险较低，可以认为投毒风险为0%。脚本本身功能即为漏洞利用，需要使用者具有一定风险意识。

3.  **利用方式：**  漏洞的利用方式是通过发送特制的HTTP请求，利用WAGO设备Web管理界面中存在的命令注入漏洞。攻击者可以利用该漏洞执行以下操作：
    *   创建新用户
    *   更改设备配置
    *   执行任意系统命令
    *   包含远程或本地文件（可能导致代码执行）

    POC代码提供了多种利用方式，包括：
    *   `--remote-file-include`: 指定远程文件URL，通过`curl`或`wget`将文件上传到`/tmp`或当前目录，然后在目标系统上执行。
    *   `--local-file-include`: 解析本地的shell脚本文件并在远端执行。
    *   `--remote-command`: 执行一条系统命令。

    攻击者可以通过这些方式在目标系统上执行任意代码，从而完全控制设备。

**项目地址:** [thedarknessdied/WAGO-CVE-2023-1698](https://github.com/thedarknessdied/WAGO-CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---



---

## POC #2

**来源**: [CVE-2023-1698-X3RX3SSec_CVE-2023-1698.md](../2023/CVE-2023-1698-X3RX3SSec_CVE-2023-1698.md)

## CVE-2023-1698-WAGO-RCE

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行

**影响应用:** WAGO PFC100, PFC200, CC100, Edge Controller, Touch Panel 600 Standard, Advanced and Marine Line

**危害等级:** 高危，允许未授权远程攻击者创建新用户并更改设备配置，可能导致拒绝服务和完全系统破坏

**影响版本:** <= FW22 (FW20, FW23也受影响)

**利用条件:** 需要网络访问目标WAGO PLC设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-1698是一个WAGO产品中的远程代码执行漏洞。未经身份验证的远程攻击者可以利用此漏洞创建新用户并更改设备配置，从而导致拒绝服务或完全系统入侵。

**有效性：**
提供的PoC代码 `wago_exploit.py` 旨在利用 CVE-2023-1698，通过向 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 发送包含恶意命令的 POST 请求来执行任意命令。代码使用 `requests` 库发送 HTTP 请求，并通过正则表达式提取命令执行的结果。根据描述和代码结构，PoC 有效。

**投毒风险：**
PoC代码主要功能是发送包含恶意命令的payload，并提取返回结果。该代码结构相对简单，主要功能是发送恶意请求，提取结果，因此投毒风险较低。但仍存在潜在风险：

*   **依赖项投毒：** `requirements.txt` 文件中存在 `requests` 和 `colorama` 依赖。存在依赖包被恶意篡改的可能，但需要攻击者替换官方源或进行中间人攻击，概率较低。
*   **命令注入风险：** PoC允许用户自定义命令，若用户输入不当命令可能造成自身系统损害。
*   **代码逻辑混淆：** 代码中存在一定量的注释和字符串，可以隐藏恶意代码。但当前代码逻辑比较清晰，恶意代码隐藏的难度较大。

基于以上分析，投毒风险较低，约为 10%。

**利用方式：**
1.  攻击者首先需要确定目标WAGO设备的IP地址和端口。
2.  攻击者运行 `wago_exploit.py` 脚本，并指定目标设备的URL。
3.  脚本会构造一个包含恶意命令的POST请求，并将其发送到目标设备的 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 接口。
4.  目标设备执行恶意命令。
5.  脚本解析响应，提取命令执行的结果并显示给攻击者。

通过此方法，攻击者可以在目标设备上执行任意命令，包括创建新用户、更改设备配置、读取敏感信息等。

**结论：**
CVE-2023-1698 是一个严重的安全漏洞，利用门槛低，危害性高。提供的 PoC 代码可以有效地利用此漏洞。虽然投毒风险较低，但在使用任何公开的漏洞利用代码时，都应谨慎评估风险。

**项目地址:** [X3RX3SSec/CVE-2023-1698](https://github.com/X3RX3SSec/CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---

## POC #3

**来源**: [CVE-2023-1698-deIndra_CVE-2023-1698.md](../2023/CVE-2023-1698-deIndra_CVE-2023-1698.md)

## CVE-2023-1698-WAGO-远程代码执行

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行

**影响应用:** WAGO Compact Controller CC100, Edge Controller, PFC100, PFC200, Touch Panel 600系列

**危害等级:** 高危，允许未经验证的远程攻击者创建新用户并更改设备配置，可能导致拒绝服务和完全系统入侵。

**影响版本:** Compact Controller CC100 (FW20 <= FW <= FW22, FW23), Edge Controller (FW22), PFC100 (FW20 <= FW <= FW22, FW23), PFC200 (FW20 <= FW <= FW22, FW23), Touch Panel 600 (FW22)

**利用条件:** 目标设备必须存在漏洞，攻击者需要能够通过网络访问目标设备的Web管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-1698 存在于 WAGO 的多个产品中，是一个未经身份验证的远程命令注入漏洞。攻击者可以通过向 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 发送特制的 POST 请求，在 `package` 参数中注入恶意代码来执行任意命令。从搜索结果和漏洞利用代码来看，该漏洞存在公开可用的 PoC 并且已经被积极利用。该PoC利用了wbm-legal-information插件中的命令注入漏洞，通过修改package的值来执行系统命令。投毒风险评估为10%，原因是代码中直接硬编码了请求路径和参数，降低了攻击者修改Payload后进行更大规模恶意传播的可能性，且代码中未发现明显的后门或恶意行为，只有可能攻击者在exp文件中加入恶意代码。

利用方式：
1.  攻击者构造包含恶意命令的 POST 请求，发送到目标设备的 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 路径，其中 XXX 需要根据目标设备的型号进行调整。
2.  恶意命令被服务器执行，攻击者从而控制设备。
3. 攻击者可以创建新用户，修改配置，甚至完全控制系统。

参考信息：
*   漏洞库信息表明该漏洞影响多个 WAGO 产品，CVSS 评分为 9.8，属于严重漏洞。
*   搜索结果表明存在公开的漏洞细节和 PoC 代码。
*   漏洞利用代码验证了该漏洞的存在，通过修改`package`参数实现了命令执行。

**项目地址:** [deIndra/CVE-2023-1698](https://github.com/deIndra/CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---

## POC #4

**来源**: [CVE-2023-1698-ibrahmsql_CVE-2023-1698.md](../2023/CVE-2023-1698-ibrahmsql_CVE-2023-1698.md)

## CVE-2023-1698-WAGO-远程代码执行

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** WAGO Compact Controller CC100, Edge Controller, PFC100, PFC200, Touch Panel 600 系列

**危害等级:** 高危，可能导致完全系统控制、拒绝服务、未授权访问和配置更改

**影响版本:** FW20 <= 版本 <= FW22, FW23 (部分产品)

**利用条件:** 目标设备开启了Web管理界面，且攻击者可以发起网络请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-1698 是 WAGO 产品中的一个远程代码执行漏洞。未经身份验证的远程攻击者可以通过构造恶意请求，利用该漏洞在目标系统上执行任意命令，例如创建新用户和更改设备配置。漏洞存在于 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 接口。POC代码通过构造包含恶意命令的JSON数据包，利用 `Package` 字段中的命令注入点执行系统命令，并通过 `[PWNED_START]` 和 `[PWNED_END]` 标记来解析命令执行结果。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用的有效性较高。搜索引擎中存在多个关于此漏洞的描述和利用工具的链接，表明该漏洞已得到广泛关注和研究。提供的漏洞利用代码是一个使用 Go 语言编写的 PoC，能够远程执行命令，进一步验证了漏洞的有效性。

**投毒风险：**
该PoC代码存在轻微的投毒风险。主要风险点在于以下几个方面：
1.  **自定义User-Agent：** PoC允许自定义User-Agent，攻击者可以将User-Agent设置为恶意值，用于进一步攻击或识别。
2.  **InsecureSkipVerify：** PoC中的TLS配置`InsecureSkipVerify: true` 会跳过SSL证书验证，如果目标网络存在中间人攻击，可能导致敏感信息泄露。
3. **命令执行回显：** PoC会将命令执行结果回显，这可能泄露敏感信息。
4. **交互式Shell：** PoC包含一个启动交互式shell的函数，该shell存在被滥用的风险。

虽然以上存在一些风险，但是PoC代码主体是实现了漏洞利用的功能，恶意投毒概率较低，故投毒概率为5%.

**利用方式：**
1.  **确定目标：** 找到存在漏洞的WAGO设备，并确认其Web管理界面开启。确认目标设备的固件版本是否在受影响的范围内。
2.  **构造Payload：**  使用提供的 PoC 脚本，构造包含要执行命令的 JSON Payload。关键在于 `Package` 字段，攻击者将要执行的命令嵌入到该字段中。
3.  **发送请求：**  使用 HTTP POST 请求将构造的 Payload 发送到目标设备的 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 接口。
4.  **解析结果：**  从响应中提取命令执行的结果。PoC 使用 `[PWNED_START]` 和 `[PWNED_END]` 作为分隔符，方便解析命令执行的输出。
5.  **后续操作：** 根据执行命令的结果，进一步控制系统，例如创建新用户、修改配置、安装恶意软件等。

**项目地址:** [ibrahmsql/CVE-2023-1698](https://github.com/ibrahmsql/CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---

## POC #5

**来源**: [CVE-2023-1698-thedarknessdied_WAGO-CVE-2023-1698.md](../2023/CVE-2023-1698-thedarknessdied_WAGO-CVE-2023-1698.md)

## CVE-2023-1698-WAGO产品远程代码执行

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行

**影响应用:** WAGO Compact Controller CC100, Edge Controller, PFC100, PFC200, Touch Panel 600系列

**危害等级:** 高危，允许未授权远程攻击者创建新用户并更改设备配置，导致拒绝服务和完全系统入侵

**影响版本:** Compact Controller CC100 (FW20 <= FW <= FW22, FW23), Edge Controller (FW22), PFC100 (FW20 <= FW <= FW22, FW23), PFC200 (FW20 <= FW <= FW22, FW23), Touch Panel 600 (FW22)

**利用条件:** 目标设备存在漏洞且网络可达，无需身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以进行以下分析：

1.  **有效性：**  提供的POC代码（WAGO-CVE-2023-1698.py）是一个Python脚本，旨在利用CVE-2023-1698漏洞。 搜索结果表明，存在公开可用的漏洞利用工具和脚本，进一步支持了POC的有效性。该脚本允许通过指定URL或文件列表来利用漏洞，并支持执行远程命令、包含远程或本地文件等功能。因此，提供的POC代码是有效的。

2.  **投毒风险：**  查看提供的POC代码，主要功能是发送恶意请求，并没有发现明显的后门或者恶意代码。主要代码包括参数解析，发送HTTP请求，从远程拉取文件执行命令等功能，这些都是正常的漏洞利用方式，因此，投毒风险较低，可以认为投毒风险为0%。脚本本身功能即为漏洞利用，需要使用者具有一定风险意识。

3.  **利用方式：**  漏洞的利用方式是通过发送特制的HTTP请求，利用WAGO设备Web管理界面中存在的命令注入漏洞。攻击者可以利用该漏洞执行以下操作：
    *   创建新用户
    *   更改设备配置
    *   执行任意系统命令
    *   包含远程或本地文件（可能导致代码执行）

    POC代码提供了多种利用方式，包括：
    *   `--remote-file-include`: 指定远程文件URL，通过`curl`或`wget`将文件上传到`/tmp`或当前目录，然后在目标系统上执行。
    *   `--local-file-include`: 解析本地的shell脚本文件并在远端执行。
    *   `--remote-command`: 执行一条系统命令。

    攻击者可以通过这些方式在目标系统上执行任意代码，从而完全控制设备。

**项目地址:** [thedarknessdied/WAGO-CVE-2023-1698](https://github.com/thedarknessdied/WAGO-CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---



---

## POC #2

**来源**: [CVE-2023-1698-X3RX3SSec_CVE-2023-1698.md](../2023/CVE-2023-1698-X3RX3SSec_CVE-2023-1698.md)

## CVE-2023-1698-WAGO-RCE

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行

**影响应用:** WAGO PFC100, PFC200, CC100, Edge Controller, Touch Panel 600 Standard, Advanced and Marine Line

**危害等级:** 高危，允许未授权远程攻击者创建新用户并更改设备配置，可能导致拒绝服务和完全系统破坏

**影响版本:** <= FW22 (FW20, FW23也受影响)

**利用条件:** 需要网络访问目标WAGO PLC设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-1698是一个WAGO产品中的远程代码执行漏洞。未经身份验证的远程攻击者可以利用此漏洞创建新用户并更改设备配置，从而导致拒绝服务或完全系统入侵。

**有效性：**
提供的PoC代码 `wago_exploit.py` 旨在利用 CVE-2023-1698，通过向 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 发送包含恶意命令的 POST 请求来执行任意命令。代码使用 `requests` 库发送 HTTP 请求，并通过正则表达式提取命令执行的结果。根据描述和代码结构，PoC 有效。

**投毒风险：**
PoC代码主要功能是发送包含恶意命令的payload，并提取返回结果。该代码结构相对简单，主要功能是发送恶意请求，提取结果，因此投毒风险较低。但仍存在潜在风险：

*   **依赖项投毒：** `requirements.txt` 文件中存在 `requests` 和 `colorama` 依赖。存在依赖包被恶意篡改的可能，但需要攻击者替换官方源或进行中间人攻击，概率较低。
*   **命令注入风险：** PoC允许用户自定义命令，若用户输入不当命令可能造成自身系统损害。
*   **代码逻辑混淆：** 代码中存在一定量的注释和字符串，可以隐藏恶意代码。但当前代码逻辑比较清晰，恶意代码隐藏的难度较大。

基于以上分析，投毒风险较低，约为 10%。

**利用方式：**
1.  攻击者首先需要确定目标WAGO设备的IP地址和端口。
2.  攻击者运行 `wago_exploit.py` 脚本，并指定目标设备的URL。
3.  脚本会构造一个包含恶意命令的POST请求，并将其发送到目标设备的 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 接口。
4.  目标设备执行恶意命令。
5.  脚本解析响应，提取命令执行的结果并显示给攻击者。

通过此方法，攻击者可以在目标设备上执行任意命令，包括创建新用户、更改设备配置、读取敏感信息等。

**结论：**
CVE-2023-1698 是一个严重的安全漏洞，利用门槛低，危害性高。提供的 PoC 代码可以有效地利用此漏洞。虽然投毒风险较低，但在使用任何公开的漏洞利用代码时，都应谨慎评估风险。

**项目地址:** [X3RX3SSec/CVE-2023-1698](https://github.com/X3RX3SSec/CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---

## POC #3

**来源**: [CVE-2023-1698-deIndra_CVE-2023-1698.md](../2023/CVE-2023-1698-deIndra_CVE-2023-1698.md)

## CVE-2023-1698-WAGO-远程代码执行

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行

**影响应用:** WAGO Compact Controller CC100, Edge Controller, PFC100, PFC200, Touch Panel 600系列

**危害等级:** 高危，允许未经验证的远程攻击者创建新用户并更改设备配置，可能导致拒绝服务和完全系统入侵。

**影响版本:** Compact Controller CC100 (FW20 <= FW <= FW22, FW23), Edge Controller (FW22), PFC100 (FW20 <= FW <= FW22, FW23), PFC200 (FW20 <= FW <= FW22, FW23), Touch Panel 600 (FW22)

**利用条件:** 目标设备必须存在漏洞，攻击者需要能够通过网络访问目标设备的Web管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-1698 存在于 WAGO 的多个产品中，是一个未经身份验证的远程命令注入漏洞。攻击者可以通过向 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 发送特制的 POST 请求，在 `package` 参数中注入恶意代码来执行任意命令。从搜索结果和漏洞利用代码来看，该漏洞存在公开可用的 PoC 并且已经被积极利用。该PoC利用了wbm-legal-information插件中的命令注入漏洞，通过修改package的值来执行系统命令。投毒风险评估为10%，原因是代码中直接硬编码了请求路径和参数，降低了攻击者修改Payload后进行更大规模恶意传播的可能性，且代码中未发现明显的后门或恶意行为，只有可能攻击者在exp文件中加入恶意代码。

利用方式：
1.  攻击者构造包含恶意命令的 POST 请求，发送到目标设备的 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 路径，其中 XXX 需要根据目标设备的型号进行调整。
2.  恶意命令被服务器执行，攻击者从而控制设备。
3. 攻击者可以创建新用户，修改配置，甚至完全控制系统。

参考信息：
*   漏洞库信息表明该漏洞影响多个 WAGO 产品，CVSS 评分为 9.8，属于严重漏洞。
*   搜索结果表明存在公开的漏洞细节和 PoC 代码。
*   漏洞利用代码验证了该漏洞的存在，通过修改`package`参数实现了命令执行。

**项目地址:** [deIndra/CVE-2023-1698](https://github.com/deIndra/CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---

## POC #4

**来源**: [CVE-2023-1698-ibrahmsql_CVE-2023-1698.md](../2023/CVE-2023-1698-ibrahmsql_CVE-2023-1698.md)

## CVE-2023-1698-WAGO-远程代码执行

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** WAGO Compact Controller CC100, Edge Controller, PFC100, PFC200, Touch Panel 600 系列

**危害等级:** 高危，可能导致完全系统控制、拒绝服务、未授权访问和配置更改

**影响版本:** FW20 <= 版本 <= FW22, FW23 (部分产品)

**利用条件:** 目标设备开启了Web管理界面，且攻击者可以发起网络请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-1698 是 WAGO 产品中的一个远程代码执行漏洞。未经身份验证的远程攻击者可以通过构造恶意请求，利用该漏洞在目标系统上执行任意命令，例如创建新用户和更改设备配置。漏洞存在于 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 接口。POC代码通过构造包含恶意命令的JSON数据包，利用 `Package` 字段中的命令注入点执行系统命令，并通过 `[PWNED_START]` 和 `[PWNED_END]` 标记来解析命令执行结果。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用的有效性较高。搜索引擎中存在多个关于此漏洞的描述和利用工具的链接，表明该漏洞已得到广泛关注和研究。提供的漏洞利用代码是一个使用 Go 语言编写的 PoC，能够远程执行命令，进一步验证了漏洞的有效性。

**投毒风险：**
该PoC代码存在轻微的投毒风险。主要风险点在于以下几个方面：
1.  **自定义User-Agent：** PoC允许自定义User-Agent，攻击者可以将User-Agent设置为恶意值，用于进一步攻击或识别。
2.  **InsecureSkipVerify：** PoC中的TLS配置`InsecureSkipVerify: true` 会跳过SSL证书验证，如果目标网络存在中间人攻击，可能导致敏感信息泄露。
3. **命令执行回显：** PoC会将命令执行结果回显，这可能泄露敏感信息。
4. **交互式Shell：** PoC包含一个启动交互式shell的函数，该shell存在被滥用的风险。

虽然以上存在一些风险，但是PoC代码主体是实现了漏洞利用的功能，恶意投毒概率较低，故投毒概率为5%.

**利用方式：**
1.  **确定目标：** 找到存在漏洞的WAGO设备，并确认其Web管理界面开启。确认目标设备的固件版本是否在受影响的范围内。
2.  **构造Payload：**  使用提供的 PoC 脚本，构造包含要执行命令的 JSON Payload。关键在于 `Package` 字段，攻击者将要执行的命令嵌入到该字段中。
3.  **发送请求：**  使用 HTTP POST 请求将构造的 Payload 发送到目标设备的 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 接口。
4.  **解析结果：**  从响应中提取命令执行的结果。PoC 使用 `[PWNED_START]` 和 `[PWNED_END]` 作为分隔符，方便解析命令执行的输出。
5.  **后续操作：** 根据执行命令的结果，进一步控制系统，例如创建新用户、修改配置、安装恶意软件等。

**项目地址:** [ibrahmsql/CVE-2023-1698](https://github.com/ibrahmsql/CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---

## POC #5

**来源**: [CVE-2023-1698-thedarknessdied_WAGO-CVE-2023-1698.md](../2023/CVE-2023-1698-thedarknessdied_WAGO-CVE-2023-1698.md)

## CVE-2023-1698-WAGO产品远程代码执行

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行

**影响应用:** WAGO Compact Controller CC100, Edge Controller, PFC100, PFC200, Touch Panel 600系列

**危害等级:** 高危，允许未授权远程攻击者创建新用户并更改设备配置，导致拒绝服务和完全系统入侵

**影响版本:** Compact Controller CC100 (FW20 <= FW <= FW22, FW23), Edge Controller (FW22), PFC100 (FW20 <= FW <= FW22, FW23), PFC200 (FW20 <= FW <= FW22, FW23), Touch Panel 600 (FW22)

**利用条件:** 目标设备存在漏洞且网络可达，无需身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以进行以下分析：

1.  **有效性：**  提供的POC代码（WAGO-CVE-2023-1698.py）是一个Python脚本，旨在利用CVE-2023-1698漏洞。 搜索结果表明，存在公开可用的漏洞利用工具和脚本，进一步支持了POC的有效性。该脚本允许通过指定URL或文件列表来利用漏洞，并支持执行远程命令、包含远程或本地文件等功能。因此，提供的POC代码是有效的。

2.  **投毒风险：**  查看提供的POC代码，主要功能是发送恶意请求，并没有发现明显的后门或者恶意代码。主要代码包括参数解析，发送HTTP请求，从远程拉取文件执行命令等功能，这些都是正常的漏洞利用方式，因此，投毒风险较低，可以认为投毒风险为0%。脚本本身功能即为漏洞利用，需要使用者具有一定风险意识。

3.  **利用方式：**  漏洞的利用方式是通过发送特制的HTTP请求，利用WAGO设备Web管理界面中存在的命令注入漏洞。攻击者可以利用该漏洞执行以下操作：
    *   创建新用户
    *   更改设备配置
    *   执行任意系统命令
    *   包含远程或本地文件（可能导致代码执行）

    POC代码提供了多种利用方式，包括：
    *   `--remote-file-include`: 指定远程文件URL，通过`curl`或`wget`将文件上传到`/tmp`或当前目录，然后在目标系统上执行。
    *   `--local-file-include`: 解析本地的shell脚本文件并在远端执行。
    *   `--remote-command`: 执行一条系统命令。

    攻击者可以通过这些方式在目标系统上执行任意代码，从而完全控制设备。

**项目地址:** [thedarknessdied/WAGO-CVE-2023-1698](https://github.com/thedarknessdied/WAGO-CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---



---

## POC #2

**来源**: [CVE-2023-1698-X3RX3SSec_CVE-2023-1698.md](../2023/CVE-2023-1698-X3RX3SSec_CVE-2023-1698.md)

## CVE-2023-1698-WAGO-RCE

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行

**影响应用:** WAGO PFC100, PFC200, CC100, Edge Controller, Touch Panel 600 Standard, Advanced and Marine Line

**危害等级:** 高危，允许未授权远程攻击者创建新用户并更改设备配置，可能导致拒绝服务和完全系统破坏

**影响版本:** <= FW22 (FW20, FW23也受影响)

**利用条件:** 需要网络访问目标WAGO PLC设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-1698是一个WAGO产品中的远程代码执行漏洞。未经身份验证的远程攻击者可以利用此漏洞创建新用户并更改设备配置，从而导致拒绝服务或完全系统入侵。

**有效性：**
提供的PoC代码 `wago_exploit.py` 旨在利用 CVE-2023-1698，通过向 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 发送包含恶意命令的 POST 请求来执行任意命令。代码使用 `requests` 库发送 HTTP 请求，并通过正则表达式提取命令执行的结果。根据描述和代码结构，PoC 有效。

**投毒风险：**
PoC代码主要功能是发送包含恶意命令的payload，并提取返回结果。该代码结构相对简单，主要功能是发送恶意请求，提取结果，因此投毒风险较低。但仍存在潜在风险：

*   **依赖项投毒：** `requirements.txt` 文件中存在 `requests` 和 `colorama` 依赖。存在依赖包被恶意篡改的可能，但需要攻击者替换官方源或进行中间人攻击，概率较低。
*   **命令注入风险：** PoC允许用户自定义命令，若用户输入不当命令可能造成自身系统损害。
*   **代码逻辑混淆：** 代码中存在一定量的注释和字符串，可以隐藏恶意代码。但当前代码逻辑比较清晰，恶意代码隐藏的难度较大。

基于以上分析，投毒风险较低，约为 10%。

**利用方式：**
1.  攻击者首先需要确定目标WAGO设备的IP地址和端口。
2.  攻击者运行 `wago_exploit.py` 脚本，并指定目标设备的URL。
3.  脚本会构造一个包含恶意命令的POST请求，并将其发送到目标设备的 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 接口。
4.  目标设备执行恶意命令。
5.  脚本解析响应，提取命令执行的结果并显示给攻击者。

通过此方法，攻击者可以在目标设备上执行任意命令，包括创建新用户、更改设备配置、读取敏感信息等。

**结论：**
CVE-2023-1698 是一个严重的安全漏洞，利用门槛低，危害性高。提供的 PoC 代码可以有效地利用此漏洞。虽然投毒风险较低，但在使用任何公开的漏洞利用代码时，都应谨慎评估风险。

**项目地址:** [X3RX3SSec/CVE-2023-1698](https://github.com/X3RX3SSec/CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---

## POC #3

**来源**: [CVE-2023-1698-deIndra_CVE-2023-1698.md](../2023/CVE-2023-1698-deIndra_CVE-2023-1698.md)

## CVE-2023-1698-WAGO-远程代码执行

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行

**影响应用:** WAGO Compact Controller CC100, Edge Controller, PFC100, PFC200, Touch Panel 600系列

**危害等级:** 高危，允许未经验证的远程攻击者创建新用户并更改设备配置，可能导致拒绝服务和完全系统入侵。

**影响版本:** Compact Controller CC100 (FW20 <= FW <= FW22, FW23), Edge Controller (FW22), PFC100 (FW20 <= FW <= FW22, FW23), PFC200 (FW20 <= FW <= FW22, FW23), Touch Panel 600 (FW22)

**利用条件:** 目标设备必须存在漏洞，攻击者需要能够通过网络访问目标设备的Web管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-1698 存在于 WAGO 的多个产品中，是一个未经身份验证的远程命令注入漏洞。攻击者可以通过向 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 发送特制的 POST 请求，在 `package` 参数中注入恶意代码来执行任意命令。从搜索结果和漏洞利用代码来看，该漏洞存在公开可用的 PoC 并且已经被积极利用。该PoC利用了wbm-legal-information插件中的命令注入漏洞，通过修改package的值来执行系统命令。投毒风险评估为10%，原因是代码中直接硬编码了请求路径和参数，降低了攻击者修改Payload后进行更大规模恶意传播的可能性，且代码中未发现明显的后门或恶意行为，只有可能攻击者在exp文件中加入恶意代码。

利用方式：
1.  攻击者构造包含恶意命令的 POST 请求，发送到目标设备的 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 路径，其中 XXX 需要根据目标设备的型号进行调整。
2.  恶意命令被服务器执行，攻击者从而控制设备。
3. 攻击者可以创建新用户，修改配置，甚至完全控制系统。

参考信息：
*   漏洞库信息表明该漏洞影响多个 WAGO 产品，CVSS 评分为 9.8，属于严重漏洞。
*   搜索结果表明存在公开的漏洞细节和 PoC 代码。
*   漏洞利用代码验证了该漏洞的存在，通过修改`package`参数实现了命令执行。

**项目地址:** [deIndra/CVE-2023-1698](https://github.com/deIndra/CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---

## POC #4

**来源**: [CVE-2023-1698-ibrahmsql_CVE-2023-1698.md](../2023/CVE-2023-1698-ibrahmsql_CVE-2023-1698.md)

## CVE-2023-1698-WAGO-远程代码执行

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** WAGO Compact Controller CC100, Edge Controller, PFC100, PFC200, Touch Panel 600 系列

**危害等级:** 高危，可能导致完全系统控制、拒绝服务、未授权访问和配置更改

**影响版本:** FW20 <= 版本 <= FW22, FW23 (部分产品)

**利用条件:** 目标设备开启了Web管理界面，且攻击者可以发起网络请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-1698 是 WAGO 产品中的一个远程代码执行漏洞。未经身份验证的远程攻击者可以通过构造恶意请求，利用该漏洞在目标系统上执行任意命令，例如创建新用户和更改设备配置。漏洞存在于 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 接口。POC代码通过构造包含恶意命令的JSON数据包，利用 `Package` 字段中的命令注入点执行系统命令，并通过 `[PWNED_START]` 和 `[PWNED_END]` 标记来解析命令执行结果。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用的有效性较高。搜索引擎中存在多个关于此漏洞的描述和利用工具的链接，表明该漏洞已得到广泛关注和研究。提供的漏洞利用代码是一个使用 Go 语言编写的 PoC，能够远程执行命令，进一步验证了漏洞的有效性。

**投毒风险：**
该PoC代码存在轻微的投毒风险。主要风险点在于以下几个方面：
1.  **自定义User-Agent：** PoC允许自定义User-Agent，攻击者可以将User-Agent设置为恶意值，用于进一步攻击或识别。
2.  **InsecureSkipVerify：** PoC中的TLS配置`InsecureSkipVerify: true` 会跳过SSL证书验证，如果目标网络存在中间人攻击，可能导致敏感信息泄露。
3. **命令执行回显：** PoC会将命令执行结果回显，这可能泄露敏感信息。
4. **交互式Shell：** PoC包含一个启动交互式shell的函数，该shell存在被滥用的风险。

虽然以上存在一些风险，但是PoC代码主体是实现了漏洞利用的功能，恶意投毒概率较低，故投毒概率为5%.

**利用方式：**
1.  **确定目标：** 找到存在漏洞的WAGO设备，并确认其Web管理界面开启。确认目标设备的固件版本是否在受影响的范围内。
2.  **构造Payload：**  使用提供的 PoC 脚本，构造包含要执行命令的 JSON Payload。关键在于 `Package` 字段，攻击者将要执行的命令嵌入到该字段中。
3.  **发送请求：**  使用 HTTP POST 请求将构造的 Payload 发送到目标设备的 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 接口。
4.  **解析结果：**  从响应中提取命令执行的结果。PoC 使用 `[PWNED_START]` 和 `[PWNED_END]` 作为分隔符，方便解析命令执行的输出。
5.  **后续操作：** 根据执行命令的结果，进一步控制系统，例如创建新用户、修改配置、安装恶意软件等。

**项目地址:** [ibrahmsql/CVE-2023-1698](https://github.com/ibrahmsql/CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---

## POC #5

**来源**: [CVE-2023-1698-thedarknessdied_WAGO-CVE-2023-1698.md](../2023/CVE-2023-1698-thedarknessdied_WAGO-CVE-2023-1698.md)

## CVE-2023-1698-WAGO产品远程代码执行

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行

**影响应用:** WAGO Compact Controller CC100, Edge Controller, PFC100, PFC200, Touch Panel 600系列

**危害等级:** 高危，允许未授权远程攻击者创建新用户并更改设备配置，导致拒绝服务和完全系统入侵

**影响版本:** Compact Controller CC100 (FW20 <= FW <= FW22, FW23), Edge Controller (FW22), PFC100 (FW20 <= FW <= FW22, FW23), PFC200 (FW20 <= FW <= FW22, FW23), Touch Panel 600 (FW22)

**利用条件:** 目标设备存在漏洞且网络可达，无需身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以进行以下分析：

1.  **有效性：**  提供的POC代码（WAGO-CVE-2023-1698.py）是一个Python脚本，旨在利用CVE-2023-1698漏洞。 搜索结果表明，存在公开可用的漏洞利用工具和脚本，进一步支持了POC的有效性。该脚本允许通过指定URL或文件列表来利用漏洞，并支持执行远程命令、包含远程或本地文件等功能。因此，提供的POC代码是有效的。

2.  **投毒风险：**  查看提供的POC代码，主要功能是发送恶意请求，并没有发现明显的后门或者恶意代码。主要代码包括参数解析，发送HTTP请求，从远程拉取文件执行命令等功能，这些都是正常的漏洞利用方式，因此，投毒风险较低，可以认为投毒风险为0%。脚本本身功能即为漏洞利用，需要使用者具有一定风险意识。

3.  **利用方式：**  漏洞的利用方式是通过发送特制的HTTP请求，利用WAGO设备Web管理界面中存在的命令注入漏洞。攻击者可以利用该漏洞执行以下操作：
    *   创建新用户
    *   更改设备配置
    *   执行任意系统命令
    *   包含远程或本地文件（可能导致代码执行）

    POC代码提供了多种利用方式，包括：
    *   `--remote-file-include`: 指定远程文件URL，通过`curl`或`wget`将文件上传到`/tmp`或当前目录，然后在目标系统上执行。
    *   `--local-file-include`: 解析本地的shell脚本文件并在远端执行。
    *   `--remote-command`: 执行一条系统命令。

    攻击者可以通过这些方式在目标系统上执行任意代码，从而完全控制设备。

**项目地址:** [thedarknessdied/WAGO-CVE-2023-1698](https://github.com/thedarknessdied/WAGO-CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---



---

## POC #2

**来源**: [CVE-2023-1698-X3RX3SSec_CVE-2023-1698.md](../2023/CVE-2023-1698-X3RX3SSec_CVE-2023-1698.md)

## CVE-2023-1698-WAGO-RCE

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行

**影响应用:** WAGO PFC100, PFC200, CC100, Edge Controller, Touch Panel 600 Standard, Advanced and Marine Line

**危害等级:** 高危，允许未授权远程攻击者创建新用户并更改设备配置，可能导致拒绝服务和完全系统破坏

**影响版本:** <= FW22 (FW20, FW23也受影响)

**利用条件:** 需要网络访问目标WAGO PLC设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-1698是一个WAGO产品中的远程代码执行漏洞。未经身份验证的远程攻击者可以利用此漏洞创建新用户并更改设备配置，从而导致拒绝服务或完全系统入侵。

**有效性：**
提供的PoC代码 `wago_exploit.py` 旨在利用 CVE-2023-1698，通过向 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 发送包含恶意命令的 POST 请求来执行任意命令。代码使用 `requests` 库发送 HTTP 请求，并通过正则表达式提取命令执行的结果。根据描述和代码结构，PoC 有效。

**投毒风险：**
PoC代码主要功能是发送包含恶意命令的payload，并提取返回结果。该代码结构相对简单，主要功能是发送恶意请求，提取结果，因此投毒风险较低。但仍存在潜在风险：

*   **依赖项投毒：** `requirements.txt` 文件中存在 `requests` 和 `colorama` 依赖。存在依赖包被恶意篡改的可能，但需要攻击者替换官方源或进行中间人攻击，概率较低。
*   **命令注入风险：** PoC允许用户自定义命令，若用户输入不当命令可能造成自身系统损害。
*   **代码逻辑混淆：** 代码中存在一定量的注释和字符串，可以隐藏恶意代码。但当前代码逻辑比较清晰，恶意代码隐藏的难度较大。

基于以上分析，投毒风险较低，约为 10%。

**利用方式：**
1.  攻击者首先需要确定目标WAGO设备的IP地址和端口。
2.  攻击者运行 `wago_exploit.py` 脚本，并指定目标设备的URL。
3.  脚本会构造一个包含恶意命令的POST请求，并将其发送到目标设备的 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 接口。
4.  目标设备执行恶意命令。
5.  脚本解析响应，提取命令执行的结果并显示给攻击者。

通过此方法，攻击者可以在目标设备上执行任意命令，包括创建新用户、更改设备配置、读取敏感信息等。

**结论：**
CVE-2023-1698 是一个严重的安全漏洞，利用门槛低，危害性高。提供的 PoC 代码可以有效地利用此漏洞。虽然投毒风险较低，但在使用任何公开的漏洞利用代码时，都应谨慎评估风险。

**项目地址:** [X3RX3SSec/CVE-2023-1698](https://github.com/X3RX3SSec/CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---

## POC #3

**来源**: [CVE-2023-1698-deIndra_CVE-2023-1698.md](../2023/CVE-2023-1698-deIndra_CVE-2023-1698.md)

## CVE-2023-1698-WAGO-远程代码执行

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行

**影响应用:** WAGO Compact Controller CC100, Edge Controller, PFC100, PFC200, Touch Panel 600系列

**危害等级:** 高危，允许未经验证的远程攻击者创建新用户并更改设备配置，可能导致拒绝服务和完全系统入侵。

**影响版本:** Compact Controller CC100 (FW20 <= FW <= FW22, FW23), Edge Controller (FW22), PFC100 (FW20 <= FW <= FW22, FW23), PFC200 (FW20 <= FW <= FW22, FW23), Touch Panel 600 (FW22)

**利用条件:** 目标设备必须存在漏洞，攻击者需要能够通过网络访问目标设备的Web管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-1698 存在于 WAGO 的多个产品中，是一个未经身份验证的远程命令注入漏洞。攻击者可以通过向 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 发送特制的 POST 请求，在 `package` 参数中注入恶意代码来执行任意命令。从搜索结果和漏洞利用代码来看，该漏洞存在公开可用的 PoC 并且已经被积极利用。该PoC利用了wbm-legal-information插件中的命令注入漏洞，通过修改package的值来执行系统命令。投毒风险评估为10%，原因是代码中直接硬编码了请求路径和参数，降低了攻击者修改Payload后进行更大规模恶意传播的可能性，且代码中未发现明显的后门或恶意行为，只有可能攻击者在exp文件中加入恶意代码。

利用方式：
1.  攻击者构造包含恶意命令的 POST 请求，发送到目标设备的 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 路径，其中 XXX 需要根据目标设备的型号进行调整。
2.  恶意命令被服务器执行，攻击者从而控制设备。
3. 攻击者可以创建新用户，修改配置，甚至完全控制系统。

参考信息：
*   漏洞库信息表明该漏洞影响多个 WAGO 产品，CVSS 评分为 9.8，属于严重漏洞。
*   搜索结果表明存在公开的漏洞细节和 PoC 代码。
*   漏洞利用代码验证了该漏洞的存在，通过修改`package`参数实现了命令执行。

**项目地址:** [deIndra/CVE-2023-1698](https://github.com/deIndra/CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---

## POC #4

**来源**: [CVE-2023-1698-ibrahmsql_CVE-2023-1698.md](../2023/CVE-2023-1698-ibrahmsql_CVE-2023-1698.md)

## CVE-2023-1698-WAGO-远程代码执行

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** WAGO Compact Controller CC100, Edge Controller, PFC100, PFC200, Touch Panel 600 系列

**危害等级:** 高危，可能导致完全系统控制、拒绝服务、未授权访问和配置更改

**影响版本:** FW20 <= 版本 <= FW22, FW23 (部分产品)

**利用条件:** 目标设备开启了Web管理界面，且攻击者可以发起网络请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-1698 是 WAGO 产品中的一个远程代码执行漏洞。未经身份验证的远程攻击者可以通过构造恶意请求，利用该漏洞在目标系统上执行任意命令，例如创建新用户和更改设备配置。漏洞存在于 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 接口。POC代码通过构造包含恶意命令的JSON数据包，利用 `Package` 字段中的命令注入点执行系统命令，并通过 `[PWNED_START]` 和 `[PWNED_END]` 标记来解析命令执行结果。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用的有效性较高。搜索引擎中存在多个关于此漏洞的描述和利用工具的链接，表明该漏洞已得到广泛关注和研究。提供的漏洞利用代码是一个使用 Go 语言编写的 PoC，能够远程执行命令，进一步验证了漏洞的有效性。

**投毒风险：**
该PoC代码存在轻微的投毒风险。主要风险点在于以下几个方面：
1.  **自定义User-Agent：** PoC允许自定义User-Agent，攻击者可以将User-Agent设置为恶意值，用于进一步攻击或识别。
2.  **InsecureSkipVerify：** PoC中的TLS配置`InsecureSkipVerify: true` 会跳过SSL证书验证，如果目标网络存在中间人攻击，可能导致敏感信息泄露。
3. **命令执行回显：** PoC会将命令执行结果回显，这可能泄露敏感信息。
4. **交互式Shell：** PoC包含一个启动交互式shell的函数，该shell存在被滥用的风险。

虽然以上存在一些风险，但是PoC代码主体是实现了漏洞利用的功能，恶意投毒概率较低，故投毒概率为5%.

**利用方式：**
1.  **确定目标：** 找到存在漏洞的WAGO设备，并确认其Web管理界面开启。确认目标设备的固件版本是否在受影响的范围内。
2.  **构造Payload：**  使用提供的 PoC 脚本，构造包含要执行命令的 JSON Payload。关键在于 `Package` 字段，攻击者将要执行的命令嵌入到该字段中。
3.  **发送请求：**  使用 HTTP POST 请求将构造的 Payload 发送到目标设备的 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 接口。
4.  **解析结果：**  从响应中提取命令执行的结果。PoC 使用 `[PWNED_START]` 和 `[PWNED_END]` 作为分隔符，方便解析命令执行的输出。
5.  **后续操作：** 根据执行命令的结果，进一步控制系统，例如创建新用户、修改配置、安装恶意软件等。

**项目地址:** [ibrahmsql/CVE-2023-1698](https://github.com/ibrahmsql/CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---

## POC #5

**来源**: [CVE-2023-1698-thedarknessdied_WAGO-CVE-2023-1698.md](../2023/CVE-2023-1698-thedarknessdied_WAGO-CVE-2023-1698.md)

## CVE-2023-1698-WAGO产品远程代码执行

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行

**影响应用:** WAGO Compact Controller CC100, Edge Controller, PFC100, PFC200, Touch Panel 600系列

**危害等级:** 高危，允许未授权远程攻击者创建新用户并更改设备配置，导致拒绝服务和完全系统入侵

**影响版本:** Compact Controller CC100 (FW20 <= FW <= FW22, FW23), Edge Controller (FW22), PFC100 (FW20 <= FW <= FW22, FW23), PFC200 (FW20 <= FW <= FW22, FW23), Touch Panel 600 (FW22)

**利用条件:** 目标设备存在漏洞且网络可达，无需身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以进行以下分析：

1.  **有效性：**  提供的POC代码（WAGO-CVE-2023-1698.py）是一个Python脚本，旨在利用CVE-2023-1698漏洞。 搜索结果表明，存在公开可用的漏洞利用工具和脚本，进一步支持了POC的有效性。该脚本允许通过指定URL或文件列表来利用漏洞，并支持执行远程命令、包含远程或本地文件等功能。因此，提供的POC代码是有效的。

2.  **投毒风险：**  查看提供的POC代码，主要功能是发送恶意请求，并没有发现明显的后门或者恶意代码。主要代码包括参数解析，发送HTTP请求，从远程拉取文件执行命令等功能，这些都是正常的漏洞利用方式，因此，投毒风险较低，可以认为投毒风险为0%。脚本本身功能即为漏洞利用，需要使用者具有一定风险意识。

3.  **利用方式：**  漏洞的利用方式是通过发送特制的HTTP请求，利用WAGO设备Web管理界面中存在的命令注入漏洞。攻击者可以利用该漏洞执行以下操作：
    *   创建新用户
    *   更改设备配置
    *   执行任意系统命令
    *   包含远程或本地文件（可能导致代码执行）

    POC代码提供了多种利用方式，包括：
    *   `--remote-file-include`: 指定远程文件URL，通过`curl`或`wget`将文件上传到`/tmp`或当前目录，然后在目标系统上执行。
    *   `--local-file-include`: 解析本地的shell脚本文件并在远端执行。
    *   `--remote-command`: 执行一条系统命令。

    攻击者可以通过这些方式在目标系统上执行任意代码，从而完全控制设备。

**项目地址:** [thedarknessdied/WAGO-CVE-2023-1698](https://github.com/thedarknessdied/WAGO-CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---



---

## POC #2

**来源**: [CVE-2023-1698-X3RX3SSec_CVE-2023-1698.md](../2023/CVE-2023-1698-X3RX3SSec_CVE-2023-1698.md)

## CVE-2023-1698-WAGO-RCE

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行

**影响应用:** WAGO PFC100, PFC200, CC100, Edge Controller, Touch Panel 600 Standard, Advanced and Marine Line

**危害等级:** 高危，允许未授权远程攻击者创建新用户并更改设备配置，可能导致拒绝服务和完全系统破坏

**影响版本:** <= FW22 (FW20, FW23也受影响)

**利用条件:** 需要网络访问目标WAGO PLC设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-1698是一个WAGO产品中的远程代码执行漏洞。未经身份验证的远程攻击者可以利用此漏洞创建新用户并更改设备配置，从而导致拒绝服务或完全系统入侵。

**有效性：**
提供的PoC代码 `wago_exploit.py` 旨在利用 CVE-2023-1698，通过向 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 发送包含恶意命令的 POST 请求来执行任意命令。代码使用 `requests` 库发送 HTTP 请求，并通过正则表达式提取命令执行的结果。根据描述和代码结构，PoC 有效。

**投毒风险：**
PoC代码主要功能是发送包含恶意命令的payload，并提取返回结果。该代码结构相对简单，主要功能是发送恶意请求，提取结果，因此投毒风险较低。但仍存在潜在风险：

*   **依赖项投毒：** `requirements.txt` 文件中存在 `requests` 和 `colorama` 依赖。存在依赖包被恶意篡改的可能，但需要攻击者替换官方源或进行中间人攻击，概率较低。
*   **命令注入风险：** PoC允许用户自定义命令，若用户输入不当命令可能造成自身系统损害。
*   **代码逻辑混淆：** 代码中存在一定量的注释和字符串，可以隐藏恶意代码。但当前代码逻辑比较清晰，恶意代码隐藏的难度较大。

基于以上分析，投毒风险较低，约为 10%。

**利用方式：**
1.  攻击者首先需要确定目标WAGO设备的IP地址和端口。
2.  攻击者运行 `wago_exploit.py` 脚本，并指定目标设备的URL。
3.  脚本会构造一个包含恶意命令的POST请求，并将其发送到目标设备的 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 接口。
4.  目标设备执行恶意命令。
5.  脚本解析响应，提取命令执行的结果并显示给攻击者。

通过此方法，攻击者可以在目标设备上执行任意命令，包括创建新用户、更改设备配置、读取敏感信息等。

**结论：**
CVE-2023-1698 是一个严重的安全漏洞，利用门槛低，危害性高。提供的 PoC 代码可以有效地利用此漏洞。虽然投毒风险较低，但在使用任何公开的漏洞利用代码时，都应谨慎评估风险。

**项目地址:** [X3RX3SSec/CVE-2023-1698](https://github.com/X3RX3SSec/CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---

## POC #3

**来源**: [CVE-2023-1698-deIndra_CVE-2023-1698.md](../2023/CVE-2023-1698-deIndra_CVE-2023-1698.md)

## CVE-2023-1698-WAGO-远程代码执行

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行

**影响应用:** WAGO Compact Controller CC100, Edge Controller, PFC100, PFC200, Touch Panel 600系列

**危害等级:** 高危，允许未经验证的远程攻击者创建新用户并更改设备配置，可能导致拒绝服务和完全系统入侵。

**影响版本:** Compact Controller CC100 (FW20 <= FW <= FW22, FW23), Edge Controller (FW22), PFC100 (FW20 <= FW <= FW22, FW23), PFC200 (FW20 <= FW <= FW22, FW23), Touch Panel 600 (FW22)

**利用条件:** 目标设备必须存在漏洞，攻击者需要能够通过网络访问目标设备的Web管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-1698 存在于 WAGO 的多个产品中，是一个未经身份验证的远程命令注入漏洞。攻击者可以通过向 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 发送特制的 POST 请求，在 `package` 参数中注入恶意代码来执行任意命令。从搜索结果和漏洞利用代码来看，该漏洞存在公开可用的 PoC 并且已经被积极利用。该PoC利用了wbm-legal-information插件中的命令注入漏洞，通过修改package的值来执行系统命令。投毒风险评估为10%，原因是代码中直接硬编码了请求路径和参数，降低了攻击者修改Payload后进行更大规模恶意传播的可能性，且代码中未发现明显的后门或恶意行为，只有可能攻击者在exp文件中加入恶意代码。

利用方式：
1.  攻击者构造包含恶意命令的 POST 请求，发送到目标设备的 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 路径，其中 XXX 需要根据目标设备的型号进行调整。
2.  恶意命令被服务器执行，攻击者从而控制设备。
3. 攻击者可以创建新用户，修改配置，甚至完全控制系统。

参考信息：
*   漏洞库信息表明该漏洞影响多个 WAGO 产品，CVSS 评分为 9.8，属于严重漏洞。
*   搜索结果表明存在公开的漏洞细节和 PoC 代码。
*   漏洞利用代码验证了该漏洞的存在，通过修改`package`参数实现了命令执行。

**项目地址:** [deIndra/CVE-2023-1698](https://github.com/deIndra/CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---

## POC #4

**来源**: [CVE-2023-1698-ibrahmsql_CVE-2023-1698.md](../2023/CVE-2023-1698-ibrahmsql_CVE-2023-1698.md)

## CVE-2023-1698-WAGO-远程代码执行

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** WAGO Compact Controller CC100, Edge Controller, PFC100, PFC200, Touch Panel 600 系列

**危害等级:** 高危，可能导致完全系统控制、拒绝服务、未授权访问和配置更改

**影响版本:** FW20 <= 版本 <= FW22, FW23 (部分产品)

**利用条件:** 目标设备开启了Web管理界面，且攻击者可以发起网络请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-1698 是 WAGO 产品中的一个远程代码执行漏洞。未经身份验证的远程攻击者可以通过构造恶意请求，利用该漏洞在目标系统上执行任意命令，例如创建新用户和更改设备配置。漏洞存在于 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 接口。POC代码通过构造包含恶意命令的JSON数据包，利用 `Package` 字段中的命令注入点执行系统命令，并通过 `[PWNED_START]` 和 `[PWNED_END]` 标记来解析命令执行结果。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用的有效性较高。搜索引擎中存在多个关于此漏洞的描述和利用工具的链接，表明该漏洞已得到广泛关注和研究。提供的漏洞利用代码是一个使用 Go 语言编写的 PoC，能够远程执行命令，进一步验证了漏洞的有效性。

**投毒风险：**
该PoC代码存在轻微的投毒风险。主要风险点在于以下几个方面：
1.  **自定义User-Agent：** PoC允许自定义User-Agent，攻击者可以将User-Agent设置为恶意值，用于进一步攻击或识别。
2.  **InsecureSkipVerify：** PoC中的TLS配置`InsecureSkipVerify: true` 会跳过SSL证书验证，如果目标网络存在中间人攻击，可能导致敏感信息泄露。
3. **命令执行回显：** PoC会将命令执行结果回显，这可能泄露敏感信息。
4. **交互式Shell：** PoC包含一个启动交互式shell的函数，该shell存在被滥用的风险。

虽然以上存在一些风险，但是PoC代码主体是实现了漏洞利用的功能，恶意投毒概率较低，故投毒概率为5%.

**利用方式：**
1.  **确定目标：** 找到存在漏洞的WAGO设备，并确认其Web管理界面开启。确认目标设备的固件版本是否在受影响的范围内。
2.  **构造Payload：**  使用提供的 PoC 脚本，构造包含要执行命令的 JSON Payload。关键在于 `Package` 字段，攻击者将要执行的命令嵌入到该字段中。
3.  **发送请求：**  使用 HTTP POST 请求将构造的 Payload 发送到目标设备的 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 接口。
4.  **解析结果：**  从响应中提取命令执行的结果。PoC 使用 `[PWNED_START]` 和 `[PWNED_END]` 作为分隔符，方便解析命令执行的输出。
5.  **后续操作：** 根据执行命令的结果，进一步控制系统，例如创建新用户、修改配置、安装恶意软件等。

**项目地址:** [ibrahmsql/CVE-2023-1698](https://github.com/ibrahmsql/CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---

## POC #5

**来源**: [CVE-2023-1698-thedarknessdied_WAGO-CVE-2023-1698.md](../2023/CVE-2023-1698-thedarknessdied_WAGO-CVE-2023-1698.md)

## CVE-2023-1698-WAGO产品远程代码执行

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行

**影响应用:** WAGO Compact Controller CC100, Edge Controller, PFC100, PFC200, Touch Panel 600系列

**危害等级:** 高危，允许未授权远程攻击者创建新用户并更改设备配置，导致拒绝服务和完全系统入侵

**影响版本:** Compact Controller CC100 (FW20 <= FW <= FW22, FW23), Edge Controller (FW22), PFC100 (FW20 <= FW <= FW22, FW23), PFC200 (FW20 <= FW <= FW22, FW23), Touch Panel 600 (FW22)

**利用条件:** 目标设备存在漏洞且网络可达，无需身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以进行以下分析：

1.  **有效性：**  提供的POC代码（WAGO-CVE-2023-1698.py）是一个Python脚本，旨在利用CVE-2023-1698漏洞。 搜索结果表明，存在公开可用的漏洞利用工具和脚本，进一步支持了POC的有效性。该脚本允许通过指定URL或文件列表来利用漏洞，并支持执行远程命令、包含远程或本地文件等功能。因此，提供的POC代码是有效的。

2.  **投毒风险：**  查看提供的POC代码，主要功能是发送恶意请求，并没有发现明显的后门或者恶意代码。主要代码包括参数解析，发送HTTP请求，从远程拉取文件执行命令等功能，这些都是正常的漏洞利用方式，因此，投毒风险较低，可以认为投毒风险为0%。脚本本身功能即为漏洞利用，需要使用者具有一定风险意识。

3.  **利用方式：**  漏洞的利用方式是通过发送特制的HTTP请求，利用WAGO设备Web管理界面中存在的命令注入漏洞。攻击者可以利用该漏洞执行以下操作：
    *   创建新用户
    *   更改设备配置
    *   执行任意系统命令
    *   包含远程或本地文件（可能导致代码执行）

    POC代码提供了多种利用方式，包括：
    *   `--remote-file-include`: 指定远程文件URL，通过`curl`或`wget`将文件上传到`/tmp`或当前目录，然后在目标系统上执行。
    *   `--local-file-include`: 解析本地的shell脚本文件并在远端执行。
    *   `--remote-command`: 执行一条系统命令。

    攻击者可以通过这些方式在目标系统上执行任意代码，从而完全控制设备。

**项目地址:** [thedarknessdied/WAGO-CVE-2023-1698](https://github.com/thedarknessdied/WAGO-CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---



---

## POC #2

**来源**: [CVE-2023-1698-X3RX3SSec_CVE-2023-1698.md](../2023/CVE-2023-1698-X3RX3SSec_CVE-2023-1698.md)

## CVE-2023-1698-WAGO-RCE

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行

**影响应用:** WAGO PFC100, PFC200, CC100, Edge Controller, Touch Panel 600 Standard, Advanced and Marine Line

**危害等级:** 高危，允许未授权远程攻击者创建新用户并更改设备配置，可能导致拒绝服务和完全系统破坏

**影响版本:** <= FW22 (FW20, FW23也受影响)

**利用条件:** 需要网络访问目标WAGO PLC设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-1698是一个WAGO产品中的远程代码执行漏洞。未经身份验证的远程攻击者可以利用此漏洞创建新用户并更改设备配置，从而导致拒绝服务或完全系统入侵。

**有效性：**
提供的PoC代码 `wago_exploit.py` 旨在利用 CVE-2023-1698，通过向 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 发送包含恶意命令的 POST 请求来执行任意命令。代码使用 `requests` 库发送 HTTP 请求，并通过正则表达式提取命令执行的结果。根据描述和代码结构，PoC 有效。

**投毒风险：**
PoC代码主要功能是发送包含恶意命令的payload，并提取返回结果。该代码结构相对简单，主要功能是发送恶意请求，提取结果，因此投毒风险较低。但仍存在潜在风险：

*   **依赖项投毒：** `requirements.txt` 文件中存在 `requests` 和 `colorama` 依赖。存在依赖包被恶意篡改的可能，但需要攻击者替换官方源或进行中间人攻击，概率较低。
*   **命令注入风险：** PoC允许用户自定义命令，若用户输入不当命令可能造成自身系统损害。
*   **代码逻辑混淆：** 代码中存在一定量的注释和字符串，可以隐藏恶意代码。但当前代码逻辑比较清晰，恶意代码隐藏的难度较大。

基于以上分析，投毒风险较低，约为 10%。

**利用方式：**
1.  攻击者首先需要确定目标WAGO设备的IP地址和端口。
2.  攻击者运行 `wago_exploit.py` 脚本，并指定目标设备的URL。
3.  脚本会构造一个包含恶意命令的POST请求，并将其发送到目标设备的 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 接口。
4.  目标设备执行恶意命令。
5.  脚本解析响应，提取命令执行的结果并显示给攻击者。

通过此方法，攻击者可以在目标设备上执行任意命令，包括创建新用户、更改设备配置、读取敏感信息等。

**结论：**
CVE-2023-1698 是一个严重的安全漏洞，利用门槛低，危害性高。提供的 PoC 代码可以有效地利用此漏洞。虽然投毒风险较低，但在使用任何公开的漏洞利用代码时，都应谨慎评估风险。

**项目地址:** [X3RX3SSec/CVE-2023-1698](https://github.com/X3RX3SSec/CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---

## POC #3

**来源**: [CVE-2023-1698-deIndra_CVE-2023-1698.md](../2023/CVE-2023-1698-deIndra_CVE-2023-1698.md)

## CVE-2023-1698-WAGO-远程代码执行

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行

**影响应用:** WAGO Compact Controller CC100, Edge Controller, PFC100, PFC200, Touch Panel 600系列

**危害等级:** 高危，允许未经验证的远程攻击者创建新用户并更改设备配置，可能导致拒绝服务和完全系统入侵。

**影响版本:** Compact Controller CC100 (FW20 <= FW <= FW22, FW23), Edge Controller (FW22), PFC100 (FW20 <= FW <= FW22, FW23), PFC200 (FW20 <= FW <= FW22, FW23), Touch Panel 600 (FW22)

**利用条件:** 目标设备必须存在漏洞，攻击者需要能够通过网络访问目标设备的Web管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-1698 存在于 WAGO 的多个产品中，是一个未经身份验证的远程命令注入漏洞。攻击者可以通过向 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 发送特制的 POST 请求，在 `package` 参数中注入恶意代码来执行任意命令。从搜索结果和漏洞利用代码来看，该漏洞存在公开可用的 PoC 并且已经被积极利用。该PoC利用了wbm-legal-information插件中的命令注入漏洞，通过修改package的值来执行系统命令。投毒风险评估为10%，原因是代码中直接硬编码了请求路径和参数，降低了攻击者修改Payload后进行更大规模恶意传播的可能性，且代码中未发现明显的后门或恶意行为，只有可能攻击者在exp文件中加入恶意代码。

利用方式：
1.  攻击者构造包含恶意命令的 POST 请求，发送到目标设备的 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 路径，其中 XXX 需要根据目标设备的型号进行调整。
2.  恶意命令被服务器执行，攻击者从而控制设备。
3. 攻击者可以创建新用户，修改配置，甚至完全控制系统。

参考信息：
*   漏洞库信息表明该漏洞影响多个 WAGO 产品，CVSS 评分为 9.8，属于严重漏洞。
*   搜索结果表明存在公开的漏洞细节和 PoC 代码。
*   漏洞利用代码验证了该漏洞的存在，通过修改`package`参数实现了命令执行。

**项目地址:** [deIndra/CVE-2023-1698](https://github.com/deIndra/CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---

## POC #4

**来源**: [CVE-2023-1698-ibrahmsql_CVE-2023-1698.md](../2023/CVE-2023-1698-ibrahmsql_CVE-2023-1698.md)

## CVE-2023-1698-WAGO-远程代码执行

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** WAGO Compact Controller CC100, Edge Controller, PFC100, PFC200, Touch Panel 600 系列

**危害等级:** 高危，可能导致完全系统控制、拒绝服务、未授权访问和配置更改

**影响版本:** FW20 <= 版本 <= FW22, FW23 (部分产品)

**利用条件:** 目标设备开启了Web管理界面，且攻击者可以发起网络请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-1698 是 WAGO 产品中的一个远程代码执行漏洞。未经身份验证的远程攻击者可以通过构造恶意请求，利用该漏洞在目标系统上执行任意命令，例如创建新用户和更改设备配置。漏洞存在于 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 接口。POC代码通过构造包含恶意命令的JSON数据包，利用 `Package` 字段中的命令注入点执行系统命令，并通过 `[PWNED_START]` 和 `[PWNED_END]` 标记来解析命令执行结果。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用的有效性较高。搜索引擎中存在多个关于此漏洞的描述和利用工具的链接，表明该漏洞已得到广泛关注和研究。提供的漏洞利用代码是一个使用 Go 语言编写的 PoC，能够远程执行命令，进一步验证了漏洞的有效性。

**投毒风险：**
该PoC代码存在轻微的投毒风险。主要风险点在于以下几个方面：
1.  **自定义User-Agent：** PoC允许自定义User-Agent，攻击者可以将User-Agent设置为恶意值，用于进一步攻击或识别。
2.  **InsecureSkipVerify：** PoC中的TLS配置`InsecureSkipVerify: true` 会跳过SSL证书验证，如果目标网络存在中间人攻击，可能导致敏感信息泄露。
3. **命令执行回显：** PoC会将命令执行结果回显，这可能泄露敏感信息。
4. **交互式Shell：** PoC包含一个启动交互式shell的函数，该shell存在被滥用的风险。

虽然以上存在一些风险，但是PoC代码主体是实现了漏洞利用的功能，恶意投毒概率较低，故投毒概率为5%.

**利用方式：**
1.  **确定目标：** 找到存在漏洞的WAGO设备，并确认其Web管理界面开启。确认目标设备的固件版本是否在受影响的范围内。
2.  **构造Payload：**  使用提供的 PoC 脚本，构造包含要执行命令的 JSON Payload。关键在于 `Package` 字段，攻击者将要执行的命令嵌入到该字段中。
3.  **发送请求：**  使用 HTTP POST 请求将构造的 Payload 发送到目标设备的 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 接口。
4.  **解析结果：**  从响应中提取命令执行的结果。PoC 使用 `[PWNED_START]` 和 `[PWNED_END]` 作为分隔符，方便解析命令执行的输出。
5.  **后续操作：** 根据执行命令的结果，进一步控制系统，例如创建新用户、修改配置、安装恶意软件等。

**项目地址:** [ibrahmsql/CVE-2023-1698](https://github.com/ibrahmsql/CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---

## POC #5

**来源**: [CVE-2023-1698-thedarknessdied_WAGO-CVE-2023-1698.md](../2023/CVE-2023-1698-thedarknessdied_WAGO-CVE-2023-1698.md)

## CVE-2023-1698-WAGO产品远程代码执行

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行

**影响应用:** WAGO Compact Controller CC100, Edge Controller, PFC100, PFC200, Touch Panel 600系列

**危害等级:** 高危，允许未授权远程攻击者创建新用户并更改设备配置，导致拒绝服务和完全系统入侵

**影响版本:** Compact Controller CC100 (FW20 <= FW <= FW22, FW23), Edge Controller (FW22), PFC100 (FW20 <= FW <= FW22, FW23), PFC200 (FW20 <= FW <= FW22, FW23), Touch Panel 600 (FW22)

**利用条件:** 目标设备存在漏洞且网络可达，无需身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以进行以下分析：

1.  **有效性：**  提供的POC代码（WAGO-CVE-2023-1698.py）是一个Python脚本，旨在利用CVE-2023-1698漏洞。 搜索结果表明，存在公开可用的漏洞利用工具和脚本，进一步支持了POC的有效性。该脚本允许通过指定URL或文件列表来利用漏洞，并支持执行远程命令、包含远程或本地文件等功能。因此，提供的POC代码是有效的。

2.  **投毒风险：**  查看提供的POC代码，主要功能是发送恶意请求，并没有发现明显的后门或者恶意代码。主要代码包括参数解析，发送HTTP请求，从远程拉取文件执行命令等功能，这些都是正常的漏洞利用方式，因此，投毒风险较低，可以认为投毒风险为0%。脚本本身功能即为漏洞利用，需要使用者具有一定风险意识。

3.  **利用方式：**  漏洞的利用方式是通过发送特制的HTTP请求，利用WAGO设备Web管理界面中存在的命令注入漏洞。攻击者可以利用该漏洞执行以下操作：
    *   创建新用户
    *   更改设备配置
    *   执行任意系统命令
    *   包含远程或本地文件（可能导致代码执行）

    POC代码提供了多种利用方式，包括：
    *   `--remote-file-include`: 指定远程文件URL，通过`curl`或`wget`将文件上传到`/tmp`或当前目录，然后在目标系统上执行。
    *   `--local-file-include`: 解析本地的shell脚本文件并在远端执行。
    *   `--remote-command`: 执行一条系统命令。

    攻击者可以通过这些方式在目标系统上执行任意代码，从而完全控制设备。

**项目地址:** [thedarknessdied/WAGO-CVE-2023-1698](https://github.com/thedarknessdied/WAGO-CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---



---

## POC #2

**来源**: [CVE-2023-1698-X3RX3SSec_CVE-2023-1698.md](../2023/CVE-2023-1698-X3RX3SSec_CVE-2023-1698.md)

## CVE-2023-1698-WAGO-RCE

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行

**影响应用:** WAGO PFC100, PFC200, CC100, Edge Controller, Touch Panel 600 Standard, Advanced and Marine Line

**危害等级:** 高危，允许未授权远程攻击者创建新用户并更改设备配置，可能导致拒绝服务和完全系统破坏

**影响版本:** <= FW22 (FW20, FW23也受影响)

**利用条件:** 需要网络访问目标WAGO PLC设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-1698是一个WAGO产品中的远程代码执行漏洞。未经身份验证的远程攻击者可以利用此漏洞创建新用户并更改设备配置，从而导致拒绝服务或完全系统入侵。

**有效性：**
提供的PoC代码 `wago_exploit.py` 旨在利用 CVE-2023-1698，通过向 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 发送包含恶意命令的 POST 请求来执行任意命令。代码使用 `requests` 库发送 HTTP 请求，并通过正则表达式提取命令执行的结果。根据描述和代码结构，PoC 有效。

**投毒风险：**
PoC代码主要功能是发送包含恶意命令的payload，并提取返回结果。该代码结构相对简单，主要功能是发送恶意请求，提取结果，因此投毒风险较低。但仍存在潜在风险：

*   **依赖项投毒：** `requirements.txt` 文件中存在 `requests` 和 `colorama` 依赖。存在依赖包被恶意篡改的可能，但需要攻击者替换官方源或进行中间人攻击，概率较低。
*   **命令注入风险：** PoC允许用户自定义命令，若用户输入不当命令可能造成自身系统损害。
*   **代码逻辑混淆：** 代码中存在一定量的注释和字符串，可以隐藏恶意代码。但当前代码逻辑比较清晰，恶意代码隐藏的难度较大。

基于以上分析，投毒风险较低，约为 10%。

**利用方式：**
1.  攻击者首先需要确定目标WAGO设备的IP地址和端口。
2.  攻击者运行 `wago_exploit.py` 脚本，并指定目标设备的URL。
3.  脚本会构造一个包含恶意命令的POST请求，并将其发送到目标设备的 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 接口。
4.  目标设备执行恶意命令。
5.  脚本解析响应，提取命令执行的结果并显示给攻击者。

通过此方法，攻击者可以在目标设备上执行任意命令，包括创建新用户、更改设备配置、读取敏感信息等。

**结论：**
CVE-2023-1698 是一个严重的安全漏洞，利用门槛低，危害性高。提供的 PoC 代码可以有效地利用此漏洞。虽然投毒风险较低，但在使用任何公开的漏洞利用代码时，都应谨慎评估风险。

**项目地址:** [X3RX3SSec/CVE-2023-1698](https://github.com/X3RX3SSec/CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---

## POC #3

**来源**: [CVE-2023-1698-deIndra_CVE-2023-1698.md](../2023/CVE-2023-1698-deIndra_CVE-2023-1698.md)

## CVE-2023-1698-WAGO-远程代码执行

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行

**影响应用:** WAGO Compact Controller CC100, Edge Controller, PFC100, PFC200, Touch Panel 600系列

**危害等级:** 高危，允许未经验证的远程攻击者创建新用户并更改设备配置，可能导致拒绝服务和完全系统入侵。

**影响版本:** Compact Controller CC100 (FW20 <= FW <= FW22, FW23), Edge Controller (FW22), PFC100 (FW20 <= FW <= FW22, FW23), PFC200 (FW20 <= FW <= FW22, FW23), Touch Panel 600 (FW22)

**利用条件:** 目标设备必须存在漏洞，攻击者需要能够通过网络访问目标设备的Web管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-1698 存在于 WAGO 的多个产品中，是一个未经身份验证的远程命令注入漏洞。攻击者可以通过向 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 发送特制的 POST 请求，在 `package` 参数中注入恶意代码来执行任意命令。从搜索结果和漏洞利用代码来看，该漏洞存在公开可用的 PoC 并且已经被积极利用。该PoC利用了wbm-legal-information插件中的命令注入漏洞，通过修改package的值来执行系统命令。投毒风险评估为10%，原因是代码中直接硬编码了请求路径和参数，降低了攻击者修改Payload后进行更大规模恶意传播的可能性，且代码中未发现明显的后门或恶意行为，只有可能攻击者在exp文件中加入恶意代码。

利用方式：
1.  攻击者构造包含恶意命令的 POST 请求，发送到目标设备的 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 路径，其中 XXX 需要根据目标设备的型号进行调整。
2.  恶意命令被服务器执行，攻击者从而控制设备。
3. 攻击者可以创建新用户，修改配置，甚至完全控制系统。

参考信息：
*   漏洞库信息表明该漏洞影响多个 WAGO 产品，CVSS 评分为 9.8，属于严重漏洞。
*   搜索结果表明存在公开的漏洞细节和 PoC 代码。
*   漏洞利用代码验证了该漏洞的存在，通过修改`package`参数实现了命令执行。

**项目地址:** [deIndra/CVE-2023-1698](https://github.com/deIndra/CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---

## POC #4

**来源**: [CVE-2023-1698-ibrahmsql_CVE-2023-1698.md](../2023/CVE-2023-1698-ibrahmsql_CVE-2023-1698.md)

## CVE-2023-1698-WAGO-远程代码执行

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** WAGO Compact Controller CC100, Edge Controller, PFC100, PFC200, Touch Panel 600 系列

**危害等级:** 高危，可能导致完全系统控制、拒绝服务、未授权访问和配置更改

**影响版本:** FW20 <= 版本 <= FW22, FW23 (部分产品)

**利用条件:** 目标设备开启了Web管理界面，且攻击者可以发起网络请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-1698 是 WAGO 产品中的一个远程代码执行漏洞。未经身份验证的远程攻击者可以通过构造恶意请求，利用该漏洞在目标系统上执行任意命令，例如创建新用户和更改设备配置。漏洞存在于 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 接口。POC代码通过构造包含恶意命令的JSON数据包，利用 `Package` 字段中的命令注入点执行系统命令，并通过 `[PWNED_START]` 和 `[PWNED_END]` 标记来解析命令执行结果。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用的有效性较高。搜索引擎中存在多个关于此漏洞的描述和利用工具的链接，表明该漏洞已得到广泛关注和研究。提供的漏洞利用代码是一个使用 Go 语言编写的 PoC，能够远程执行命令，进一步验证了漏洞的有效性。

**投毒风险：**
该PoC代码存在轻微的投毒风险。主要风险点在于以下几个方面：
1.  **自定义User-Agent：** PoC允许自定义User-Agent，攻击者可以将User-Agent设置为恶意值，用于进一步攻击或识别。
2.  **InsecureSkipVerify：** PoC中的TLS配置`InsecureSkipVerify: true` 会跳过SSL证书验证，如果目标网络存在中间人攻击，可能导致敏感信息泄露。
3. **命令执行回显：** PoC会将命令执行结果回显，这可能泄露敏感信息。
4. **交互式Shell：** PoC包含一个启动交互式shell的函数，该shell存在被滥用的风险。

虽然以上存在一些风险，但是PoC代码主体是实现了漏洞利用的功能，恶意投毒概率较低，故投毒概率为5%.

**利用方式：**
1.  **确定目标：** 找到存在漏洞的WAGO设备，并确认其Web管理界面开启。确认目标设备的固件版本是否在受影响的范围内。
2.  **构造Payload：**  使用提供的 PoC 脚本，构造包含要执行命令的 JSON Payload。关键在于 `Package` 字段，攻击者将要执行的命令嵌入到该字段中。
3.  **发送请求：**  使用 HTTP POST 请求将构造的 Payload 发送到目标设备的 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 接口。
4.  **解析结果：**  从响应中提取命令执行的结果。PoC 使用 `[PWNED_START]` 和 `[PWNED_END]` 作为分隔符，方便解析命令执行的输出。
5.  **后续操作：** 根据执行命令的结果，进一步控制系统，例如创建新用户、修改配置、安装恶意软件等。

**项目地址:** [ibrahmsql/CVE-2023-1698](https://github.com/ibrahmsql/CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---

## POC #5

**来源**: [CVE-2023-1698-thedarknessdied_WAGO-CVE-2023-1698.md](../2023/CVE-2023-1698-thedarknessdied_WAGO-CVE-2023-1698.md)

## CVE-2023-1698-WAGO产品远程代码执行

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行

**影响应用:** WAGO Compact Controller CC100, Edge Controller, PFC100, PFC200, Touch Panel 600系列

**危害等级:** 高危，允许未授权远程攻击者创建新用户并更改设备配置，导致拒绝服务和完全系统入侵

**影响版本:** Compact Controller CC100 (FW20 <= FW <= FW22, FW23), Edge Controller (FW22), PFC100 (FW20 <= FW <= FW22, FW23), PFC200 (FW20 <= FW <= FW22, FW23), Touch Panel 600 (FW22)

**利用条件:** 目标设备存在漏洞且网络可达，无需身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以进行以下分析：

1.  **有效性：**  提供的POC代码（WAGO-CVE-2023-1698.py）是一个Python脚本，旨在利用CVE-2023-1698漏洞。 搜索结果表明，存在公开可用的漏洞利用工具和脚本，进一步支持了POC的有效性。该脚本允许通过指定URL或文件列表来利用漏洞，并支持执行远程命令、包含远程或本地文件等功能。因此，提供的POC代码是有效的。

2.  **投毒风险：**  查看提供的POC代码，主要功能是发送恶意请求，并没有发现明显的后门或者恶意代码。主要代码包括参数解析，发送HTTP请求，从远程拉取文件执行命令等功能，这些都是正常的漏洞利用方式，因此，投毒风险较低，可以认为投毒风险为0%。脚本本身功能即为漏洞利用，需要使用者具有一定风险意识。

3.  **利用方式：**  漏洞的利用方式是通过发送特制的HTTP请求，利用WAGO设备Web管理界面中存在的命令注入漏洞。攻击者可以利用该漏洞执行以下操作：
    *   创建新用户
    *   更改设备配置
    *   执行任意系统命令
    *   包含远程或本地文件（可能导致代码执行）

    POC代码提供了多种利用方式，包括：
    *   `--remote-file-include`: 指定远程文件URL，通过`curl`或`wget`将文件上传到`/tmp`或当前目录，然后在目标系统上执行。
    *   `--local-file-include`: 解析本地的shell脚本文件并在远端执行。
    *   `--remote-command`: 执行一条系统命令。

    攻击者可以通过这些方式在目标系统上执行任意代码，从而完全控制设备。

**项目地址:** [thedarknessdied/WAGO-CVE-2023-1698](https://github.com/thedarknessdied/WAGO-CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---



---

## POC #2

**来源**: [CVE-2023-1698-X3RX3SSec_CVE-2023-1698.md](../2023/CVE-2023-1698-X3RX3SSec_CVE-2023-1698.md)

## CVE-2023-1698-WAGO-RCE

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行

**影响应用:** WAGO PFC100, PFC200, CC100, Edge Controller, Touch Panel 600 Standard, Advanced and Marine Line

**危害等级:** 高危，允许未授权远程攻击者创建新用户并更改设备配置，可能导致拒绝服务和完全系统破坏

**影响版本:** <= FW22 (FW20, FW23也受影响)

**利用条件:** 需要网络访问目标WAGO PLC设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-1698是一个WAGO产品中的远程代码执行漏洞。未经身份验证的远程攻击者可以利用此漏洞创建新用户并更改设备配置，从而导致拒绝服务或完全系统入侵。

**有效性：**
提供的PoC代码 `wago_exploit.py` 旨在利用 CVE-2023-1698，通过向 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 发送包含恶意命令的 POST 请求来执行任意命令。代码使用 `requests` 库发送 HTTP 请求，并通过正则表达式提取命令执行的结果。根据描述和代码结构，PoC 有效。

**投毒风险：**
PoC代码主要功能是发送包含恶意命令的payload，并提取返回结果。该代码结构相对简单，主要功能是发送恶意请求，提取结果，因此投毒风险较低。但仍存在潜在风险：

*   **依赖项投毒：** `requirements.txt` 文件中存在 `requests` 和 `colorama` 依赖。存在依赖包被恶意篡改的可能，但需要攻击者替换官方源或进行中间人攻击，概率较低。
*   **命令注入风险：** PoC允许用户自定义命令，若用户输入不当命令可能造成自身系统损害。
*   **代码逻辑混淆：** 代码中存在一定量的注释和字符串，可以隐藏恶意代码。但当前代码逻辑比较清晰，恶意代码隐藏的难度较大。

基于以上分析，投毒风险较低，约为 10%。

**利用方式：**
1.  攻击者首先需要确定目标WAGO设备的IP地址和端口。
2.  攻击者运行 `wago_exploit.py` 脚本，并指定目标设备的URL。
3.  脚本会构造一个包含恶意命令的POST请求，并将其发送到目标设备的 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 接口。
4.  目标设备执行恶意命令。
5.  脚本解析响应，提取命令执行的结果并显示给攻击者。

通过此方法，攻击者可以在目标设备上执行任意命令，包括创建新用户、更改设备配置、读取敏感信息等。

**结论：**
CVE-2023-1698 是一个严重的安全漏洞，利用门槛低，危害性高。提供的 PoC 代码可以有效地利用此漏洞。虽然投毒风险较低，但在使用任何公开的漏洞利用代码时，都应谨慎评估风险。

**项目地址:** [X3RX3SSec/CVE-2023-1698](https://github.com/X3RX3SSec/CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---

## POC #3

**来源**: [CVE-2023-1698-deIndra_CVE-2023-1698.md](../2023/CVE-2023-1698-deIndra_CVE-2023-1698.md)

## CVE-2023-1698-WAGO-远程代码执行

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行

**影响应用:** WAGO Compact Controller CC100, Edge Controller, PFC100, PFC200, Touch Panel 600系列

**危害等级:** 高危，允许未经验证的远程攻击者创建新用户并更改设备配置，可能导致拒绝服务和完全系统入侵。

**影响版本:** Compact Controller CC100 (FW20 <= FW <= FW22, FW23), Edge Controller (FW22), PFC100 (FW20 <= FW <= FW22, FW23), PFC200 (FW20 <= FW <= FW22, FW23), Touch Panel 600 (FW22)

**利用条件:** 目标设备必须存在漏洞，攻击者需要能够通过网络访问目标设备的Web管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-1698 存在于 WAGO 的多个产品中，是一个未经身份验证的远程命令注入漏洞。攻击者可以通过向 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 发送特制的 POST 请求，在 `package` 参数中注入恶意代码来执行任意命令。从搜索结果和漏洞利用代码来看，该漏洞存在公开可用的 PoC 并且已经被积极利用。该PoC利用了wbm-legal-information插件中的命令注入漏洞，通过修改package的值来执行系统命令。投毒风险评估为10%，原因是代码中直接硬编码了请求路径和参数，降低了攻击者修改Payload后进行更大规模恶意传播的可能性，且代码中未发现明显的后门或恶意行为，只有可能攻击者在exp文件中加入恶意代码。

利用方式：
1.  攻击者构造包含恶意命令的 POST 请求，发送到目标设备的 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 路径，其中 XXX 需要根据目标设备的型号进行调整。
2.  恶意命令被服务器执行，攻击者从而控制设备。
3. 攻击者可以创建新用户，修改配置，甚至完全控制系统。

参考信息：
*   漏洞库信息表明该漏洞影响多个 WAGO 产品，CVSS 评分为 9.8，属于严重漏洞。
*   搜索结果表明存在公开的漏洞细节和 PoC 代码。
*   漏洞利用代码验证了该漏洞的存在，通过修改`package`参数实现了命令执行。

**项目地址:** [deIndra/CVE-2023-1698](https://github.com/deIndra/CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---

## POC #4

**来源**: [CVE-2023-1698-ibrahmsql_CVE-2023-1698.md](../2023/CVE-2023-1698-ibrahmsql_CVE-2023-1698.md)

## CVE-2023-1698-WAGO-远程代码执行

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** WAGO Compact Controller CC100, Edge Controller, PFC100, PFC200, Touch Panel 600 系列

**危害等级:** 高危，可能导致完全系统控制、拒绝服务、未授权访问和配置更改

**影响版本:** FW20 <= 版本 <= FW22, FW23 (部分产品)

**利用条件:** 目标设备开启了Web管理界面，且攻击者可以发起网络请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-1698 是 WAGO 产品中的一个远程代码执行漏洞。未经身份验证的远程攻击者可以通过构造恶意请求，利用该漏洞在目标系统上执行任意命令，例如创建新用户和更改设备配置。漏洞存在于 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 接口。POC代码通过构造包含恶意命令的JSON数据包，利用 `Package` 字段中的命令注入点执行系统命令，并通过 `[PWNED_START]` 和 `[PWNED_END]` 标记来解析命令执行结果。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用的有效性较高。搜索引擎中存在多个关于此漏洞的描述和利用工具的链接，表明该漏洞已得到广泛关注和研究。提供的漏洞利用代码是一个使用 Go 语言编写的 PoC，能够远程执行命令，进一步验证了漏洞的有效性。

**投毒风险：**
该PoC代码存在轻微的投毒风险。主要风险点在于以下几个方面：
1.  **自定义User-Agent：** PoC允许自定义User-Agent，攻击者可以将User-Agent设置为恶意值，用于进一步攻击或识别。
2.  **InsecureSkipVerify：** PoC中的TLS配置`InsecureSkipVerify: true` 会跳过SSL证书验证，如果目标网络存在中间人攻击，可能导致敏感信息泄露。
3. **命令执行回显：** PoC会将命令执行结果回显，这可能泄露敏感信息。
4. **交互式Shell：** PoC包含一个启动交互式shell的函数，该shell存在被滥用的风险。

虽然以上存在一些风险，但是PoC代码主体是实现了漏洞利用的功能，恶意投毒概率较低，故投毒概率为5%.

**利用方式：**
1.  **确定目标：** 找到存在漏洞的WAGO设备，并确认其Web管理界面开启。确认目标设备的固件版本是否在受影响的范围内。
2.  **构造Payload：**  使用提供的 PoC 脚本，构造包含要执行命令的 JSON Payload。关键在于 `Package` 字段，攻击者将要执行的命令嵌入到该字段中。
3.  **发送请求：**  使用 HTTP POST 请求将构造的 Payload 发送到目标设备的 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 接口。
4.  **解析结果：**  从响应中提取命令执行的结果。PoC 使用 `[PWNED_START]` 和 `[PWNED_END]` 作为分隔符，方便解析命令执行的输出。
5.  **后续操作：** 根据执行命令的结果，进一步控制系统，例如创建新用户、修改配置、安装恶意软件等。

**项目地址:** [ibrahmsql/CVE-2023-1698](https://github.com/ibrahmsql/CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---

## POC #5

**来源**: [CVE-2023-1698-thedarknessdied_WAGO-CVE-2023-1698.md](../2023/CVE-2023-1698-thedarknessdied_WAGO-CVE-2023-1698.md)

## CVE-2023-1698-WAGO产品远程代码执行

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行

**影响应用:** WAGO Compact Controller CC100, Edge Controller, PFC100, PFC200, Touch Panel 600系列

**危害等级:** 高危，允许未授权远程攻击者创建新用户并更改设备配置，导致拒绝服务和完全系统入侵

**影响版本:** Compact Controller CC100 (FW20 <= FW <= FW22, FW23), Edge Controller (FW22), PFC100 (FW20 <= FW <= FW22, FW23), PFC200 (FW20 <= FW <= FW22, FW23), Touch Panel 600 (FW22)

**利用条件:** 目标设备存在漏洞且网络可达，无需身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以进行以下分析：

1.  **有效性：**  提供的POC代码（WAGO-CVE-2023-1698.py）是一个Python脚本，旨在利用CVE-2023-1698漏洞。 搜索结果表明，存在公开可用的漏洞利用工具和脚本，进一步支持了POC的有效性。该脚本允许通过指定URL或文件列表来利用漏洞，并支持执行远程命令、包含远程或本地文件等功能。因此，提供的POC代码是有效的。

2.  **投毒风险：**  查看提供的POC代码，主要功能是发送恶意请求，并没有发现明显的后门或者恶意代码。主要代码包括参数解析，发送HTTP请求，从远程拉取文件执行命令等功能，这些都是正常的漏洞利用方式，因此，投毒风险较低，可以认为投毒风险为0%。脚本本身功能即为漏洞利用，需要使用者具有一定风险意识。

3.  **利用方式：**  漏洞的利用方式是通过发送特制的HTTP请求，利用WAGO设备Web管理界面中存在的命令注入漏洞。攻击者可以利用该漏洞执行以下操作：
    *   创建新用户
    *   更改设备配置
    *   执行任意系统命令
    *   包含远程或本地文件（可能导致代码执行）

    POC代码提供了多种利用方式，包括：
    *   `--remote-file-include`: 指定远程文件URL，通过`curl`或`wget`将文件上传到`/tmp`或当前目录，然后在目标系统上执行。
    *   `--local-file-include`: 解析本地的shell脚本文件并在远端执行。
    *   `--remote-command`: 执行一条系统命令。

    攻击者可以通过这些方式在目标系统上执行任意代码，从而完全控制设备。

**项目地址:** [thedarknessdied/WAGO-CVE-2023-1698](https://github.com/thedarknessdied/WAGO-CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)

---

