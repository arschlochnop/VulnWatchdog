# CVE-2023-45866

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45866-AvishekDhakal_CVE-2023-45866_EXPLOITS.md](../2023/CVE-2023-45866-AvishekDhakal_CVE-2023-45866_EXPLOITS.md)

## CVE-2023-45866-BlueZ-蓝牙HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致键盘注入攻击，远程命令执行

**影响版本:** bluez <= 5.64 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需在蓝牙通信范围内，目标设备蓝牙开启且易受攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经验证的蓝牙HID外围设备发起和建立加密连接，并接受HID键盘报告，从而可能注入HID消息。攻击者可以伪装成蓝牙键盘，在目标设备未授权的情况下发送键盘输入，实现远程命令执行等恶意操作。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞允许攻击者在未经用户授权的情况下，通过蓝牙连接并模拟键盘输入，具有较高的利用价值。提供的POC代码似乎包含多种攻击场景，如暴力破解密码、相机劫持（camphish）、恶意APK下载和安装、文件上传以及发送WhatsApp消息。虽然具体效果取决于目标设备和配置，但整体来看，这些POC代码具备一定的有效性。

**投毒风险评估：**

提供的POC代码主要利用键盘输入模拟用户操作，实现特定功能。虽然这些功能本身可能被滥用，但代码本身并未发现明显的恶意后门或植入行为，判断该仓库的投毒风险为10%。

**利用方式分析：**

1.  **连接阶段绕过：** 漏洞核心在于绕过蓝牙HID连接时的身份验证或授权机制，允许攻击者控制的设备未经许可建立连接。
2.  **HID消息注入：** 成功建立连接后，攻击者可以发送任意HID消息，模拟键盘输入、鼠标点击等操作。
3.  **利用场景：**
    *   **密码暴力破解：** 通过模拟键盘输入，尝试不同的密码组合。
    *   **恶意链接打开：** 注入URL，诱导用户访问恶意网站，例如下载恶意APK。
    *   **摄像头劫持：** 通过注入特定URL，利用WebRTC等技术访问摄像头，拍摄照片。
    *   **文件上传：** 打开文件上传页面，模拟用户操作选择并上传文件。
    *   **发送消息：** 打开WhatsApp网页版，模拟用户输入并发送消息。
4.  **攻击流程示例（恶意APK安装）：**
    *   攻击者伪装成蓝牙键盘，连接目标设备。
    *   注入包含恶意APK下载链接的URL，打开浏览器。
    *   模拟键盘输入，点击下载按钮。
    *   模拟键盘输入，允许安装未知来源应用。
    *   模拟键盘输入，完成APK安装。

**优先级：**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

**项目地址:** [AvishekDhakal/CVE-2023-45866_EXPLOITS](https://github.com/AvishekDhakal/CVE-2023-45866_EXPLOITS)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #2

**来源**: [CVE-2023-45866-Chedrian07_CVE-2023-45866-POC.md](../2023/CVE-2023-45866-Chedrian07_CVE-2023-45866-POC.md)

## CVE-2023-45866 BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.64 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需要在目标设备蓝牙范围内，且目标设备未进行必要的身份验证或配对。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙外围设备模拟HID设备（例如键盘），并向主机系统注入恶意输入。该漏洞存在于BlueZ蓝牙协议栈中，攻击者可以绕过身份验证，建立加密连接，并发送HID报告，从而模拟键盘输入，执行任意命令。

**有效性分析：**
根据漏洞信息，搜索引擎结果以及提供的POC代码，可以判定该漏洞是有效的。POC代码是一个Python脚本，它模拟了一个蓝牙键盘，并尝试连接到目标设备并发送按键输入。脚本中实现了HID报告的构造和发送，以及DuckyScript的解析功能，可以执行预定义的恶意payload。

**投毒风险分析：**
虽然脚本本身旨在利用该漏洞，但其中可能存在一些潜在的投毒风险。例如，脚本可能包含：
1.  **恶意Payload：** DuckyScript部分，攻击者可能将脚本配置为执行破坏性的命令，例如删除文件、安装恶意软件或窃取敏感数据。
2.  **后门功能：** 脚本可能包含额外的代码，用于在目标系统上安装后门，允许攻击者在以后重新访问该系统。
3.  **信息收集：** 脚本可以收集有关目标系统的信息，例如操作系统版本、已安装的软件或网络配置，并将这些信息发送给攻击者。

对代码进行分析后，发现代码的功能主要集中在模拟蓝牙键盘和发送预定义的按键序列。但是，`process_duckyscript` 函数允许执行任意的DuckyScript命令，这本身就具有潜在的风险。因此投毒风险定为10%,主要集中在DuckyScript的 payload 部分。

**利用方式：**
1.  **准备：** 攻击者需要一台配备蓝牙功能的设备，并安装必要的软件库（例如Python的`bluetooth`库）。
2.  **扫描：** 使用蓝牙扫描工具查找附近易受攻击的设备。
3.  **连接：** 使用POC代码中提供的蓝牙地址连接到目标设备。
4.  **注入：** 通过发送HID报告模拟键盘输入，执行恶意命令。

总而言之，CVE-2023-45866是一个严重的安全漏洞，攻击者可以利用它来远程控制受影响的设备。用户应及时更新BlueZ版本，或者禁用蓝牙功能来防范攻击。

**项目地址:** [Chedrian07/CVE-2023-45866-POC](https://github.com/Chedrian07/CVE-2023-45866-POC)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #3

**来源**: [CVE-2023-45866-Danyw24_blueXploit.md](../2023/CVE-2023-45866-Danyw24_blueXploit.md)

## CVE-2023-45866 - BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** bluez 5.64-0ubuntu1 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需在蓝牙通信范围内，目标设备开启蓝牙且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许未经验证的攻击者通过伪装成蓝牙HID设备，在受害者设备上注入键盘输入。利用方式如下：

1.  攻击者使用特定的蓝牙HID设备（如伪造的键盘）发起连接。
2.  由于BlueZ在某些版本中未正确处理身份验证，攻击者可以绕过配对流程，建立加密连接。
3.  攻击者随后可以发送恶意HID报告，模拟键盘输入。
4.  通过模拟按键，攻击者可以执行任意命令，如打开终端、下载恶意软件等。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开可用的POC。因此，漏洞利用具有有效性。

**投毒风险评估：**

查看提供的漏洞利用代码（blueXploit），发现代码主要功能是利用CVE-2023-45866漏洞进行蓝牙HID注入攻击。代码包含自动生成payload并注入到APK的功能，存在一定的风险，但更多是利用msfvenom等工具生成payload, **所以判断投毒概率较低,大约为5%。**

**利用方式分析：**

blueXploit利用工具：

1.  **模拟HID设备：** 代码可能使用Linux的蓝牙工具（如`bluez-tools`）来模拟HID设备，使其能够发送键盘和鼠标事件。
2.  **绕过认证：** 漏洞的核心在于绕过蓝牙HID的认证机制。POC代码会尝试建立未认证的连接，或者利用已知的漏洞来欺骗目标设备。
3.  **Payload注入：** 成功建立连接后，POC代码会注入预先定义的payload，这些payload通常包含一系列键盘指令，用于在目标设备上执行命令。利用APK的组件，可能导致恶意软件安装或其他恶意行为。

**结论：**

CVE-2023-45866是一个严重的安全漏洞，允许未经授权的攻击者通过蓝牙注入键盘输入，从而控制受害者设备。提供的POC代码可以有效利用该漏洞。存在少许投毒风险但主要集中在自动化payload生成和注入方面，需要谨慎使用。攻击者需要具备一定的蓝牙协议和Linux系统知识才能成功利用该漏洞。

**项目地址:** [Danyw24/blueXploit](https://github.com/Danyw24/blueXploit)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #4

**来源**: [CVE-2023-45866-Eason-zz_BluetoothDucky.md](../2023/CVE-2023-45866-Eason-zz_BluetoothDucky.md)

## CVE-2023-45866-BlueZ-蓝牙HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，允许未授权的蓝牙HID设备注入键盘事件，可能导致任意命令执行

**影响版本:** 5.64-0ubuntu1 (Ubuntu 22.04LTS)等受影响版本

**利用条件:** 攻击者需要在蓝牙通信范围内，目标设备开启蓝牙功能且未采取CVE-2020-0556的缓解措施。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未认证的蓝牙外围设备 (Peripheral role HID Device) 发起并建立加密连接，并接收 HID 键盘报告。攻击者可以伪装成蓝牙键盘，在没有用户交互的情况下向主机注入 HID 消息，例如键盘按键，从而执行任意命令。 

**有效性评估：**
根据漏洞信息和搜索引擎结果，该漏洞利用的关键在于绕过蓝牙配对认证，从而模拟键盘输入。提供的Python脚本`BluetoothDucky.py`尝试自动化此过程。脚本通过以下步骤利用漏洞：

1.  **蓝牙适配器初始化：** 重启蓝牙服务，配置适配器名称和类别。
2.  **HID Profile注册：** 注册HID profile，使系统认为该设备是HID设备。
3.  **连接目标设备：** 尝试连接目标设备的SDP服务，并进行配对。
4.  **HID连接：** 连接HID中断和控制端口。
5.  **Payload执行：** 从指定文件读取Ducky脚本，并将其转换为HID键盘报告发送到目标设备。

根据搜索结果，该漏洞影响包括Android、iOS和Linux等多个平台。因此，如果脚本能够成功建立蓝牙连接并绕过认证，则漏洞利用应该是有效的。

**投毒风险分析：**
分析提供的Python脚本 `BluetoothDucky.py`，未发现明显的恶意代码或后门。脚本主要功能是模拟蓝牙键盘并发送预定义的按键序列。

以下是未发现明显投毒代码的理由：

*   脚本的主要功能是模拟键盘输入，逻辑清晰。
*   脚本依赖于标准的Python库和Linux工具 (例如 `bluetooth`, `hcitool`)。
*   脚本没有尝试访问本地文件系统、网络连接或执行其他可疑操作。
*   `injector` 目录下的文件需要进一步分析, 但当前的代码片段没有展示出恶意行为。

虽然没有发现明显的投毒代码，但仍存在以下潜在风险：

*   Ducky脚本本身可能包含恶意命令，例如下载和执行恶意软件。这取决于攻击者提供的payload。
*   脚本的依赖项 (例如 `injector` 目录下的模块) 可能包含漏洞或恶意代码。由于没有提供完整代码，无法进行全面分析。
*   脚本的实现可能存在缺陷，导致意外行为或安全问题。

综合考虑，投毒风险较低，但不能完全排除。给予10%的投毒风险评估。

**利用方式：**

1.  **扫描目标设备：** 使用蓝牙扫描工具 (例如 `bluetooth.discover_devices`) 查找附近的蓝牙设备。
2.  **配置攻击环境：** 安装必要的Python库 (例如 `pybluez`)，并确保蓝牙适配器正常工作。
3.  **运行攻击脚本：** 运行 `BluetoothDucky.py` 脚本，指定目标设备的蓝牙地址和用于攻击的蓝牙接口。
4.  **建立连接：** 脚本尝试与目标设备建立蓝牙连接，并绕过认证。
5.  **注入键盘事件：** 脚本将Ducky脚本转换为HID键盘报告，并发送到目标设备。

**总结：**
CVE-2023-45866是一个高危漏洞，攻击者可以通过模拟蓝牙键盘注入恶意键盘事件，从而控制目标设备。提供的POC代码具有一定的有效性，但需要进一步测试和验证。投毒风险较低，但不能完全排除。

**项目地址:** [Eason-zz/BluetoothDucky](https://github.com/Eason-zz/BluetoothDucky)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #5

**来源**: [CVE-2023-45866-cisnarfu_Bluepop.md](../2023/CVE-2023-45866-cisnarfu_Bluepop.md)

# CVE-2023-45866

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45866-AvishekDhakal_CVE-2023-45866_EXPLOITS.md](../2023/CVE-2023-45866-AvishekDhakal_CVE-2023-45866_EXPLOITS.md)

## CVE-2023-45866-BlueZ-蓝牙HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致键盘注入攻击，远程命令执行

**影响版本:** bluez <= 5.64 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需在蓝牙通信范围内，目标设备蓝牙开启且易受攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经验证的蓝牙HID外围设备发起和建立加密连接，并接受HID键盘报告，从而可能注入HID消息。攻击者可以伪装成蓝牙键盘，在目标设备未授权的情况下发送键盘输入，实现远程命令执行等恶意操作。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞允许攻击者在未经用户授权的情况下，通过蓝牙连接并模拟键盘输入，具有较高的利用价值。提供的POC代码似乎包含多种攻击场景，如暴力破解密码、相机劫持（camphish）、恶意APK下载和安装、文件上传以及发送WhatsApp消息。虽然具体效果取决于目标设备和配置，但整体来看，这些POC代码具备一定的有效性。

**投毒风险评估：**

提供的POC代码主要利用键盘输入模拟用户操作，实现特定功能。虽然这些功能本身可能被滥用，但代码本身并未发现明显的恶意后门或植入行为，判断该仓库的投毒风险为10%。

**利用方式分析：**

1.  **连接阶段绕过：** 漏洞核心在于绕过蓝牙HID连接时的身份验证或授权机制，允许攻击者控制的设备未经许可建立连接。
2.  **HID消息注入：** 成功建立连接后，攻击者可以发送任意HID消息，模拟键盘输入、鼠标点击等操作。
3.  **利用场景：**
    *   **密码暴力破解：** 通过模拟键盘输入，尝试不同的密码组合。
    *   **恶意链接打开：** 注入URL，诱导用户访问恶意网站，例如下载恶意APK。
    *   **摄像头劫持：** 通过注入特定URL，利用WebRTC等技术访问摄像头，拍摄照片。
    *   **文件上传：** 打开文件上传页面，模拟用户操作选择并上传文件。
    *   **发送消息：** 打开WhatsApp网页版，模拟用户输入并发送消息。
4.  **攻击流程示例（恶意APK安装）：**
    *   攻击者伪装成蓝牙键盘，连接目标设备。
    *   注入包含恶意APK下载链接的URL，打开浏览器。
    *   模拟键盘输入，点击下载按钮。
    *   模拟键盘输入，允许安装未知来源应用。
    *   模拟键盘输入，完成APK安装。

**优先级：**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

**项目地址:** [AvishekDhakal/CVE-2023-45866_EXPLOITS](https://github.com/AvishekDhakal/CVE-2023-45866_EXPLOITS)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #2

**来源**: [CVE-2023-45866-Chedrian07_CVE-2023-45866-POC.md](../2023/CVE-2023-45866-Chedrian07_CVE-2023-45866-POC.md)

## CVE-2023-45866 BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.64 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需要在目标设备蓝牙范围内，且目标设备未进行必要的身份验证或配对。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙外围设备模拟HID设备（例如键盘），并向主机系统注入恶意输入。该漏洞存在于BlueZ蓝牙协议栈中，攻击者可以绕过身份验证，建立加密连接，并发送HID报告，从而模拟键盘输入，执行任意命令。

**有效性分析：**
根据漏洞信息，搜索引擎结果以及提供的POC代码，可以判定该漏洞是有效的。POC代码是一个Python脚本，它模拟了一个蓝牙键盘，并尝试连接到目标设备并发送按键输入。脚本中实现了HID报告的构造和发送，以及DuckyScript的解析功能，可以执行预定义的恶意payload。

**投毒风险分析：**
虽然脚本本身旨在利用该漏洞，但其中可能存在一些潜在的投毒风险。例如，脚本可能包含：
1.  **恶意Payload：** DuckyScript部分，攻击者可能将脚本配置为执行破坏性的命令，例如删除文件、安装恶意软件或窃取敏感数据。
2.  **后门功能：** 脚本可能包含额外的代码，用于在目标系统上安装后门，允许攻击者在以后重新访问该系统。
3.  **信息收集：** 脚本可以收集有关目标系统的信息，例如操作系统版本、已安装的软件或网络配置，并将这些信息发送给攻击者。

对代码进行分析后，发现代码的功能主要集中在模拟蓝牙键盘和发送预定义的按键序列。但是，`process_duckyscript` 函数允许执行任意的DuckyScript命令，这本身就具有潜在的风险。因此投毒风险定为10%,主要集中在DuckyScript的 payload 部分。

**利用方式：**
1.  **准备：** 攻击者需要一台配备蓝牙功能的设备，并安装必要的软件库（例如Python的`bluetooth`库）。
2.  **扫描：** 使用蓝牙扫描工具查找附近易受攻击的设备。
3.  **连接：** 使用POC代码中提供的蓝牙地址连接到目标设备。
4.  **注入：** 通过发送HID报告模拟键盘输入，执行恶意命令。

总而言之，CVE-2023-45866是一个严重的安全漏洞，攻击者可以利用它来远程控制受影响的设备。用户应及时更新BlueZ版本，或者禁用蓝牙功能来防范攻击。

**项目地址:** [Chedrian07/CVE-2023-45866-POC](https://github.com/Chedrian07/CVE-2023-45866-POC)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #3

**来源**: [CVE-2023-45866-Danyw24_blueXploit.md](../2023/CVE-2023-45866-Danyw24_blueXploit.md)

## CVE-2023-45866 - BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** bluez 5.64-0ubuntu1 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需在蓝牙通信范围内，目标设备开启蓝牙且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许未经验证的攻击者通过伪装成蓝牙HID设备，在受害者设备上注入键盘输入。利用方式如下：

1.  攻击者使用特定的蓝牙HID设备（如伪造的键盘）发起连接。
2.  由于BlueZ在某些版本中未正确处理身份验证，攻击者可以绕过配对流程，建立加密连接。
3.  攻击者随后可以发送恶意HID报告，模拟键盘输入。
4.  通过模拟按键，攻击者可以执行任意命令，如打开终端、下载恶意软件等。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开可用的POC。因此，漏洞利用具有有效性。

**投毒风险评估：**

查看提供的漏洞利用代码（blueXploit），发现代码主要功能是利用CVE-2023-45866漏洞进行蓝牙HID注入攻击。代码包含自动生成payload并注入到APK的功能，存在一定的风险，但更多是利用msfvenom等工具生成payload, **所以判断投毒概率较低,大约为5%。**

**利用方式分析：**

blueXploit利用工具：

1.  **模拟HID设备：** 代码可能使用Linux的蓝牙工具（如`bluez-tools`）来模拟HID设备，使其能够发送键盘和鼠标事件。
2.  **绕过认证：** 漏洞的核心在于绕过蓝牙HID的认证机制。POC代码会尝试建立未认证的连接，或者利用已知的漏洞来欺骗目标设备。
3.  **Payload注入：** 成功建立连接后，POC代码会注入预先定义的payload，这些payload通常包含一系列键盘指令，用于在目标设备上执行命令。利用APK的组件，可能导致恶意软件安装或其他恶意行为。

**结论：**

CVE-2023-45866是一个严重的安全漏洞，允许未经授权的攻击者通过蓝牙注入键盘输入，从而控制受害者设备。提供的POC代码可以有效利用该漏洞。存在少许投毒风险但主要集中在自动化payload生成和注入方面，需要谨慎使用。攻击者需要具备一定的蓝牙协议和Linux系统知识才能成功利用该漏洞。

**项目地址:** [Danyw24/blueXploit](https://github.com/Danyw24/blueXploit)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #4

**来源**: [CVE-2023-45866-Eason-zz_BluetoothDucky.md](../2023/CVE-2023-45866-Eason-zz_BluetoothDucky.md)

## CVE-2023-45866-BlueZ-蓝牙HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，允许未授权的蓝牙HID设备注入键盘事件，可能导致任意命令执行

**影响版本:** 5.64-0ubuntu1 (Ubuntu 22.04LTS)等受影响版本

**利用条件:** 攻击者需要在蓝牙通信范围内，目标设备开启蓝牙功能且未采取CVE-2020-0556的缓解措施。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未认证的蓝牙外围设备 (Peripheral role HID Device) 发起并建立加密连接，并接收 HID 键盘报告。攻击者可以伪装成蓝牙键盘，在没有用户交互的情况下向主机注入 HID 消息，例如键盘按键，从而执行任意命令。 

**有效性评估：**
根据漏洞信息和搜索引擎结果，该漏洞利用的关键在于绕过蓝牙配对认证，从而模拟键盘输入。提供的Python脚本`BluetoothDucky.py`尝试自动化此过程。脚本通过以下步骤利用漏洞：

1.  **蓝牙适配器初始化：** 重启蓝牙服务，配置适配器名称和类别。
2.  **HID Profile注册：** 注册HID profile，使系统认为该设备是HID设备。
3.  **连接目标设备：** 尝试连接目标设备的SDP服务，并进行配对。
4.  **HID连接：** 连接HID中断和控制端口。
5.  **Payload执行：** 从指定文件读取Ducky脚本，并将其转换为HID键盘报告发送到目标设备。

根据搜索结果，该漏洞影响包括Android、iOS和Linux等多个平台。因此，如果脚本能够成功建立蓝牙连接并绕过认证，则漏洞利用应该是有效的。

**投毒风险分析：**
分析提供的Python脚本 `BluetoothDucky.py`，未发现明显的恶意代码或后门。脚本主要功能是模拟蓝牙键盘并发送预定义的按键序列。

以下是未发现明显投毒代码的理由：

*   脚本的主要功能是模拟键盘输入，逻辑清晰。
*   脚本依赖于标准的Python库和Linux工具 (例如 `bluetooth`, `hcitool`)。
*   脚本没有尝试访问本地文件系统、网络连接或执行其他可疑操作。
*   `injector` 目录下的文件需要进一步分析, 但当前的代码片段没有展示出恶意行为。

虽然没有发现明显的投毒代码，但仍存在以下潜在风险：

*   Ducky脚本本身可能包含恶意命令，例如下载和执行恶意软件。这取决于攻击者提供的payload。
*   脚本的依赖项 (例如 `injector` 目录下的模块) 可能包含漏洞或恶意代码。由于没有提供完整代码，无法进行全面分析。
*   脚本的实现可能存在缺陷，导致意外行为或安全问题。

综合考虑，投毒风险较低，但不能完全排除。给予10%的投毒风险评估。

**利用方式：**

1.  **扫描目标设备：** 使用蓝牙扫描工具 (例如 `bluetooth.discover_devices`) 查找附近的蓝牙设备。
2.  **配置攻击环境：** 安装必要的Python库 (例如 `pybluez`)，并确保蓝牙适配器正常工作。
3.  **运行攻击脚本：** 运行 `BluetoothDucky.py` 脚本，指定目标设备的蓝牙地址和用于攻击的蓝牙接口。
4.  **建立连接：** 脚本尝试与目标设备建立蓝牙连接，并绕过认证。
5.  **注入键盘事件：** 脚本将Ducky脚本转换为HID键盘报告，并发送到目标设备。

**总结：**
CVE-2023-45866是一个高危漏洞，攻击者可以通过模拟蓝牙键盘注入恶意键盘事件，从而控制目标设备。提供的POC代码具有一定的有效性，但需要进一步测试和验证。投毒风险较低，但不能完全排除。

**项目地址:** [Eason-zz/BluetoothDucky](https://github.com/Eason-zz/BluetoothDucky)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #5

**来源**: [CVE-2023-45866-cisnarfu_Bluepop.md](../2023/CVE-2023-45866-cisnarfu_Bluepop.md)

# CVE-2023-45866

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45866-AvishekDhakal_CVE-2023-45866_EXPLOITS.md](../2023/CVE-2023-45866-AvishekDhakal_CVE-2023-45866_EXPLOITS.md)

## CVE-2023-45866-BlueZ-蓝牙HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致键盘注入攻击，远程命令执行

**影响版本:** bluez <= 5.64 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需在蓝牙通信范围内，目标设备蓝牙开启且易受攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经验证的蓝牙HID外围设备发起和建立加密连接，并接受HID键盘报告，从而可能注入HID消息。攻击者可以伪装成蓝牙键盘，在目标设备未授权的情况下发送键盘输入，实现远程命令执行等恶意操作。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞允许攻击者在未经用户授权的情况下，通过蓝牙连接并模拟键盘输入，具有较高的利用价值。提供的POC代码似乎包含多种攻击场景，如暴力破解密码、相机劫持（camphish）、恶意APK下载和安装、文件上传以及发送WhatsApp消息。虽然具体效果取决于目标设备和配置，但整体来看，这些POC代码具备一定的有效性。

**投毒风险评估：**

提供的POC代码主要利用键盘输入模拟用户操作，实现特定功能。虽然这些功能本身可能被滥用，但代码本身并未发现明显的恶意后门或植入行为，判断该仓库的投毒风险为10%。

**利用方式分析：**

1.  **连接阶段绕过：** 漏洞核心在于绕过蓝牙HID连接时的身份验证或授权机制，允许攻击者控制的设备未经许可建立连接。
2.  **HID消息注入：** 成功建立连接后，攻击者可以发送任意HID消息，模拟键盘输入、鼠标点击等操作。
3.  **利用场景：**
    *   **密码暴力破解：** 通过模拟键盘输入，尝试不同的密码组合。
    *   **恶意链接打开：** 注入URL，诱导用户访问恶意网站，例如下载恶意APK。
    *   **摄像头劫持：** 通过注入特定URL，利用WebRTC等技术访问摄像头，拍摄照片。
    *   **文件上传：** 打开文件上传页面，模拟用户操作选择并上传文件。
    *   **发送消息：** 打开WhatsApp网页版，模拟用户输入并发送消息。
4.  **攻击流程示例（恶意APK安装）：**
    *   攻击者伪装成蓝牙键盘，连接目标设备。
    *   注入包含恶意APK下载链接的URL，打开浏览器。
    *   模拟键盘输入，点击下载按钮。
    *   模拟键盘输入，允许安装未知来源应用。
    *   模拟键盘输入，完成APK安装。

**优先级：**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

**项目地址:** [AvishekDhakal/CVE-2023-45866_EXPLOITS](https://github.com/AvishekDhakal/CVE-2023-45866_EXPLOITS)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #2

**来源**: [CVE-2023-45866-Chedrian07_CVE-2023-45866-POC.md](../2023/CVE-2023-45866-Chedrian07_CVE-2023-45866-POC.md)

## CVE-2023-45866 BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.64 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需要在目标设备蓝牙范围内，且目标设备未进行必要的身份验证或配对。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙外围设备模拟HID设备（例如键盘），并向主机系统注入恶意输入。该漏洞存在于BlueZ蓝牙协议栈中，攻击者可以绕过身份验证，建立加密连接，并发送HID报告，从而模拟键盘输入，执行任意命令。

**有效性分析：**
根据漏洞信息，搜索引擎结果以及提供的POC代码，可以判定该漏洞是有效的。POC代码是一个Python脚本，它模拟了一个蓝牙键盘，并尝试连接到目标设备并发送按键输入。脚本中实现了HID报告的构造和发送，以及DuckyScript的解析功能，可以执行预定义的恶意payload。

**投毒风险分析：**
虽然脚本本身旨在利用该漏洞，但其中可能存在一些潜在的投毒风险。例如，脚本可能包含：
1.  **恶意Payload：** DuckyScript部分，攻击者可能将脚本配置为执行破坏性的命令，例如删除文件、安装恶意软件或窃取敏感数据。
2.  **后门功能：** 脚本可能包含额外的代码，用于在目标系统上安装后门，允许攻击者在以后重新访问该系统。
3.  **信息收集：** 脚本可以收集有关目标系统的信息，例如操作系统版本、已安装的软件或网络配置，并将这些信息发送给攻击者。

对代码进行分析后，发现代码的功能主要集中在模拟蓝牙键盘和发送预定义的按键序列。但是，`process_duckyscript` 函数允许执行任意的DuckyScript命令，这本身就具有潜在的风险。因此投毒风险定为10%,主要集中在DuckyScript的 payload 部分。

**利用方式：**
1.  **准备：** 攻击者需要一台配备蓝牙功能的设备，并安装必要的软件库（例如Python的`bluetooth`库）。
2.  **扫描：** 使用蓝牙扫描工具查找附近易受攻击的设备。
3.  **连接：** 使用POC代码中提供的蓝牙地址连接到目标设备。
4.  **注入：** 通过发送HID报告模拟键盘输入，执行恶意命令。

总而言之，CVE-2023-45866是一个严重的安全漏洞，攻击者可以利用它来远程控制受影响的设备。用户应及时更新BlueZ版本，或者禁用蓝牙功能来防范攻击。

**项目地址:** [Chedrian07/CVE-2023-45866-POC](https://github.com/Chedrian07/CVE-2023-45866-POC)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #3

**来源**: [CVE-2023-45866-Danyw24_blueXploit.md](../2023/CVE-2023-45866-Danyw24_blueXploit.md)

## CVE-2023-45866 - BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** bluez 5.64-0ubuntu1 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需在蓝牙通信范围内，目标设备开启蓝牙且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许未经验证的攻击者通过伪装成蓝牙HID设备，在受害者设备上注入键盘输入。利用方式如下：

1.  攻击者使用特定的蓝牙HID设备（如伪造的键盘）发起连接。
2.  由于BlueZ在某些版本中未正确处理身份验证，攻击者可以绕过配对流程，建立加密连接。
3.  攻击者随后可以发送恶意HID报告，模拟键盘输入。
4.  通过模拟按键，攻击者可以执行任意命令，如打开终端、下载恶意软件等。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开可用的POC。因此，漏洞利用具有有效性。

**投毒风险评估：**

查看提供的漏洞利用代码（blueXploit），发现代码主要功能是利用CVE-2023-45866漏洞进行蓝牙HID注入攻击。代码包含自动生成payload并注入到APK的功能，存在一定的风险，但更多是利用msfvenom等工具生成payload, **所以判断投毒概率较低,大约为5%。**

**利用方式分析：**

blueXploit利用工具：

1.  **模拟HID设备：** 代码可能使用Linux的蓝牙工具（如`bluez-tools`）来模拟HID设备，使其能够发送键盘和鼠标事件。
2.  **绕过认证：** 漏洞的核心在于绕过蓝牙HID的认证机制。POC代码会尝试建立未认证的连接，或者利用已知的漏洞来欺骗目标设备。
3.  **Payload注入：** 成功建立连接后，POC代码会注入预先定义的payload，这些payload通常包含一系列键盘指令，用于在目标设备上执行命令。利用APK的组件，可能导致恶意软件安装或其他恶意行为。

**结论：**

CVE-2023-45866是一个严重的安全漏洞，允许未经授权的攻击者通过蓝牙注入键盘输入，从而控制受害者设备。提供的POC代码可以有效利用该漏洞。存在少许投毒风险但主要集中在自动化payload生成和注入方面，需要谨慎使用。攻击者需要具备一定的蓝牙协议和Linux系统知识才能成功利用该漏洞。

**项目地址:** [Danyw24/blueXploit](https://github.com/Danyw24/blueXploit)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #4

**来源**: [CVE-2023-45866-Eason-zz_BluetoothDucky.md](../2023/CVE-2023-45866-Eason-zz_BluetoothDucky.md)

## CVE-2023-45866-BlueZ-蓝牙HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，允许未授权的蓝牙HID设备注入键盘事件，可能导致任意命令执行

**影响版本:** 5.64-0ubuntu1 (Ubuntu 22.04LTS)等受影响版本

**利用条件:** 攻击者需要在蓝牙通信范围内，目标设备开启蓝牙功能且未采取CVE-2020-0556的缓解措施。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未认证的蓝牙外围设备 (Peripheral role HID Device) 发起并建立加密连接，并接收 HID 键盘报告。攻击者可以伪装成蓝牙键盘，在没有用户交互的情况下向主机注入 HID 消息，例如键盘按键，从而执行任意命令。 

**有效性评估：**
根据漏洞信息和搜索引擎结果，该漏洞利用的关键在于绕过蓝牙配对认证，从而模拟键盘输入。提供的Python脚本`BluetoothDucky.py`尝试自动化此过程。脚本通过以下步骤利用漏洞：

1.  **蓝牙适配器初始化：** 重启蓝牙服务，配置适配器名称和类别。
2.  **HID Profile注册：** 注册HID profile，使系统认为该设备是HID设备。
3.  **连接目标设备：** 尝试连接目标设备的SDP服务，并进行配对。
4.  **HID连接：** 连接HID中断和控制端口。
5.  **Payload执行：** 从指定文件读取Ducky脚本，并将其转换为HID键盘报告发送到目标设备。

根据搜索结果，该漏洞影响包括Android、iOS和Linux等多个平台。因此，如果脚本能够成功建立蓝牙连接并绕过认证，则漏洞利用应该是有效的。

**投毒风险分析：**
分析提供的Python脚本 `BluetoothDucky.py`，未发现明显的恶意代码或后门。脚本主要功能是模拟蓝牙键盘并发送预定义的按键序列。

以下是未发现明显投毒代码的理由：

*   脚本的主要功能是模拟键盘输入，逻辑清晰。
*   脚本依赖于标准的Python库和Linux工具 (例如 `bluetooth`, `hcitool`)。
*   脚本没有尝试访问本地文件系统、网络连接或执行其他可疑操作。
*   `injector` 目录下的文件需要进一步分析, 但当前的代码片段没有展示出恶意行为。

虽然没有发现明显的投毒代码，但仍存在以下潜在风险：

*   Ducky脚本本身可能包含恶意命令，例如下载和执行恶意软件。这取决于攻击者提供的payload。
*   脚本的依赖项 (例如 `injector` 目录下的模块) 可能包含漏洞或恶意代码。由于没有提供完整代码，无法进行全面分析。
*   脚本的实现可能存在缺陷，导致意外行为或安全问题。

综合考虑，投毒风险较低，但不能完全排除。给予10%的投毒风险评估。

**利用方式：**

1.  **扫描目标设备：** 使用蓝牙扫描工具 (例如 `bluetooth.discover_devices`) 查找附近的蓝牙设备。
2.  **配置攻击环境：** 安装必要的Python库 (例如 `pybluez`)，并确保蓝牙适配器正常工作。
3.  **运行攻击脚本：** 运行 `BluetoothDucky.py` 脚本，指定目标设备的蓝牙地址和用于攻击的蓝牙接口。
4.  **建立连接：** 脚本尝试与目标设备建立蓝牙连接，并绕过认证。
5.  **注入键盘事件：** 脚本将Ducky脚本转换为HID键盘报告，并发送到目标设备。

**总结：**
CVE-2023-45866是一个高危漏洞，攻击者可以通过模拟蓝牙键盘注入恶意键盘事件，从而控制目标设备。提供的POC代码具有一定的有效性，但需要进一步测试和验证。投毒风险较低，但不能完全排除。

**项目地址:** [Eason-zz/BluetoothDucky](https://github.com/Eason-zz/BluetoothDucky)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #5

**来源**: [CVE-2023-45866-cisnarfu_Bluepop.md](../2023/CVE-2023-45866-cisnarfu_Bluepop.md)

# CVE-2023-45866

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45866-AvishekDhakal_CVE-2023-45866_EXPLOITS.md](../2023/CVE-2023-45866-AvishekDhakal_CVE-2023-45866_EXPLOITS.md)

## CVE-2023-45866-BlueZ-蓝牙HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致键盘注入攻击，远程命令执行

**影响版本:** bluez <= 5.64 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需在蓝牙通信范围内，目标设备蓝牙开启且易受攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经验证的蓝牙HID外围设备发起和建立加密连接，并接受HID键盘报告，从而可能注入HID消息。攻击者可以伪装成蓝牙键盘，在目标设备未授权的情况下发送键盘输入，实现远程命令执行等恶意操作。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞允许攻击者在未经用户授权的情况下，通过蓝牙连接并模拟键盘输入，具有较高的利用价值。提供的POC代码似乎包含多种攻击场景，如暴力破解密码、相机劫持（camphish）、恶意APK下载和安装、文件上传以及发送WhatsApp消息。虽然具体效果取决于目标设备和配置，但整体来看，这些POC代码具备一定的有效性。

**投毒风险评估：**

提供的POC代码主要利用键盘输入模拟用户操作，实现特定功能。虽然这些功能本身可能被滥用，但代码本身并未发现明显的恶意后门或植入行为，判断该仓库的投毒风险为10%。

**利用方式分析：**

1.  **连接阶段绕过：** 漏洞核心在于绕过蓝牙HID连接时的身份验证或授权机制，允许攻击者控制的设备未经许可建立连接。
2.  **HID消息注入：** 成功建立连接后，攻击者可以发送任意HID消息，模拟键盘输入、鼠标点击等操作。
3.  **利用场景：**
    *   **密码暴力破解：** 通过模拟键盘输入，尝试不同的密码组合。
    *   **恶意链接打开：** 注入URL，诱导用户访问恶意网站，例如下载恶意APK。
    *   **摄像头劫持：** 通过注入特定URL，利用WebRTC等技术访问摄像头，拍摄照片。
    *   **文件上传：** 打开文件上传页面，模拟用户操作选择并上传文件。
    *   **发送消息：** 打开WhatsApp网页版，模拟用户输入并发送消息。
4.  **攻击流程示例（恶意APK安装）：**
    *   攻击者伪装成蓝牙键盘，连接目标设备。
    *   注入包含恶意APK下载链接的URL，打开浏览器。
    *   模拟键盘输入，点击下载按钮。
    *   模拟键盘输入，允许安装未知来源应用。
    *   模拟键盘输入，完成APK安装。

**优先级：**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

**项目地址:** [AvishekDhakal/CVE-2023-45866_EXPLOITS](https://github.com/AvishekDhakal/CVE-2023-45866_EXPLOITS)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #2

**来源**: [CVE-2023-45866-Chedrian07_CVE-2023-45866-POC.md](../2023/CVE-2023-45866-Chedrian07_CVE-2023-45866-POC.md)

## CVE-2023-45866 BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.64 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需要在目标设备蓝牙范围内，且目标设备未进行必要的身份验证或配对。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙外围设备模拟HID设备（例如键盘），并向主机系统注入恶意输入。该漏洞存在于BlueZ蓝牙协议栈中，攻击者可以绕过身份验证，建立加密连接，并发送HID报告，从而模拟键盘输入，执行任意命令。

**有效性分析：**
根据漏洞信息，搜索引擎结果以及提供的POC代码，可以判定该漏洞是有效的。POC代码是一个Python脚本，它模拟了一个蓝牙键盘，并尝试连接到目标设备并发送按键输入。脚本中实现了HID报告的构造和发送，以及DuckyScript的解析功能，可以执行预定义的恶意payload。

**投毒风险分析：**
虽然脚本本身旨在利用该漏洞，但其中可能存在一些潜在的投毒风险。例如，脚本可能包含：
1.  **恶意Payload：** DuckyScript部分，攻击者可能将脚本配置为执行破坏性的命令，例如删除文件、安装恶意软件或窃取敏感数据。
2.  **后门功能：** 脚本可能包含额外的代码，用于在目标系统上安装后门，允许攻击者在以后重新访问该系统。
3.  **信息收集：** 脚本可以收集有关目标系统的信息，例如操作系统版本、已安装的软件或网络配置，并将这些信息发送给攻击者。

对代码进行分析后，发现代码的功能主要集中在模拟蓝牙键盘和发送预定义的按键序列。但是，`process_duckyscript` 函数允许执行任意的DuckyScript命令，这本身就具有潜在的风险。因此投毒风险定为10%,主要集中在DuckyScript的 payload 部分。

**利用方式：**
1.  **准备：** 攻击者需要一台配备蓝牙功能的设备，并安装必要的软件库（例如Python的`bluetooth`库）。
2.  **扫描：** 使用蓝牙扫描工具查找附近易受攻击的设备。
3.  **连接：** 使用POC代码中提供的蓝牙地址连接到目标设备。
4.  **注入：** 通过发送HID报告模拟键盘输入，执行恶意命令。

总而言之，CVE-2023-45866是一个严重的安全漏洞，攻击者可以利用它来远程控制受影响的设备。用户应及时更新BlueZ版本，或者禁用蓝牙功能来防范攻击。

**项目地址:** [Chedrian07/CVE-2023-45866-POC](https://github.com/Chedrian07/CVE-2023-45866-POC)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #3

**来源**: [CVE-2023-45866-Danyw24_blueXploit.md](../2023/CVE-2023-45866-Danyw24_blueXploit.md)

## CVE-2023-45866 - BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** bluez 5.64-0ubuntu1 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需在蓝牙通信范围内，目标设备开启蓝牙且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许未经验证的攻击者通过伪装成蓝牙HID设备，在受害者设备上注入键盘输入。利用方式如下：

1.  攻击者使用特定的蓝牙HID设备（如伪造的键盘）发起连接。
2.  由于BlueZ在某些版本中未正确处理身份验证，攻击者可以绕过配对流程，建立加密连接。
3.  攻击者随后可以发送恶意HID报告，模拟键盘输入。
4.  通过模拟按键，攻击者可以执行任意命令，如打开终端、下载恶意软件等。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开可用的POC。因此，漏洞利用具有有效性。

**投毒风险评估：**

查看提供的漏洞利用代码（blueXploit），发现代码主要功能是利用CVE-2023-45866漏洞进行蓝牙HID注入攻击。代码包含自动生成payload并注入到APK的功能，存在一定的风险，但更多是利用msfvenom等工具生成payload, **所以判断投毒概率较低,大约为5%。**

**利用方式分析：**

blueXploit利用工具：

1.  **模拟HID设备：** 代码可能使用Linux的蓝牙工具（如`bluez-tools`）来模拟HID设备，使其能够发送键盘和鼠标事件。
2.  **绕过认证：** 漏洞的核心在于绕过蓝牙HID的认证机制。POC代码会尝试建立未认证的连接，或者利用已知的漏洞来欺骗目标设备。
3.  **Payload注入：** 成功建立连接后，POC代码会注入预先定义的payload，这些payload通常包含一系列键盘指令，用于在目标设备上执行命令。利用APK的组件，可能导致恶意软件安装或其他恶意行为。

**结论：**

CVE-2023-45866是一个严重的安全漏洞，允许未经授权的攻击者通过蓝牙注入键盘输入，从而控制受害者设备。提供的POC代码可以有效利用该漏洞。存在少许投毒风险但主要集中在自动化payload生成和注入方面，需要谨慎使用。攻击者需要具备一定的蓝牙协议和Linux系统知识才能成功利用该漏洞。

**项目地址:** [Danyw24/blueXploit](https://github.com/Danyw24/blueXploit)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #4

**来源**: [CVE-2023-45866-Eason-zz_BluetoothDucky.md](../2023/CVE-2023-45866-Eason-zz_BluetoothDucky.md)

## CVE-2023-45866-BlueZ-蓝牙HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，允许未授权的蓝牙HID设备注入键盘事件，可能导致任意命令执行

**影响版本:** 5.64-0ubuntu1 (Ubuntu 22.04LTS)等受影响版本

**利用条件:** 攻击者需要在蓝牙通信范围内，目标设备开启蓝牙功能且未采取CVE-2020-0556的缓解措施。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未认证的蓝牙外围设备 (Peripheral role HID Device) 发起并建立加密连接，并接收 HID 键盘报告。攻击者可以伪装成蓝牙键盘，在没有用户交互的情况下向主机注入 HID 消息，例如键盘按键，从而执行任意命令。 

**有效性评估：**
根据漏洞信息和搜索引擎结果，该漏洞利用的关键在于绕过蓝牙配对认证，从而模拟键盘输入。提供的Python脚本`BluetoothDucky.py`尝试自动化此过程。脚本通过以下步骤利用漏洞：

1.  **蓝牙适配器初始化：** 重启蓝牙服务，配置适配器名称和类别。
2.  **HID Profile注册：** 注册HID profile，使系统认为该设备是HID设备。
3.  **连接目标设备：** 尝试连接目标设备的SDP服务，并进行配对。
4.  **HID连接：** 连接HID中断和控制端口。
5.  **Payload执行：** 从指定文件读取Ducky脚本，并将其转换为HID键盘报告发送到目标设备。

根据搜索结果，该漏洞影响包括Android、iOS和Linux等多个平台。因此，如果脚本能够成功建立蓝牙连接并绕过认证，则漏洞利用应该是有效的。

**投毒风险分析：**
分析提供的Python脚本 `BluetoothDucky.py`，未发现明显的恶意代码或后门。脚本主要功能是模拟蓝牙键盘并发送预定义的按键序列。

以下是未发现明显投毒代码的理由：

*   脚本的主要功能是模拟键盘输入，逻辑清晰。
*   脚本依赖于标准的Python库和Linux工具 (例如 `bluetooth`, `hcitool`)。
*   脚本没有尝试访问本地文件系统、网络连接或执行其他可疑操作。
*   `injector` 目录下的文件需要进一步分析, 但当前的代码片段没有展示出恶意行为。

虽然没有发现明显的投毒代码，但仍存在以下潜在风险：

*   Ducky脚本本身可能包含恶意命令，例如下载和执行恶意软件。这取决于攻击者提供的payload。
*   脚本的依赖项 (例如 `injector` 目录下的模块) 可能包含漏洞或恶意代码。由于没有提供完整代码，无法进行全面分析。
*   脚本的实现可能存在缺陷，导致意外行为或安全问题。

综合考虑，投毒风险较低，但不能完全排除。给予10%的投毒风险评估。

**利用方式：**

1.  **扫描目标设备：** 使用蓝牙扫描工具 (例如 `bluetooth.discover_devices`) 查找附近的蓝牙设备。
2.  **配置攻击环境：** 安装必要的Python库 (例如 `pybluez`)，并确保蓝牙适配器正常工作。
3.  **运行攻击脚本：** 运行 `BluetoothDucky.py` 脚本，指定目标设备的蓝牙地址和用于攻击的蓝牙接口。
4.  **建立连接：** 脚本尝试与目标设备建立蓝牙连接，并绕过认证。
5.  **注入键盘事件：** 脚本将Ducky脚本转换为HID键盘报告，并发送到目标设备。

**总结：**
CVE-2023-45866是一个高危漏洞，攻击者可以通过模拟蓝牙键盘注入恶意键盘事件，从而控制目标设备。提供的POC代码具有一定的有效性，但需要进一步测试和验证。投毒风险较低，但不能完全排除。

**项目地址:** [Eason-zz/BluetoothDucky](https://github.com/Eason-zz/BluetoothDucky)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #5

**来源**: [CVE-2023-45866-cisnarfu_Bluepop.md](../2023/CVE-2023-45866-cisnarfu_Bluepop.md)

# CVE-2023-45866

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45866-AvishekDhakal_CVE-2023-45866_EXPLOITS.md](../2023/CVE-2023-45866-AvishekDhakal_CVE-2023-45866_EXPLOITS.md)

## CVE-2023-45866-BlueZ-蓝牙HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致键盘注入攻击，远程命令执行

**影响版本:** bluez <= 5.64 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需在蓝牙通信范围内，目标设备蓝牙开启且易受攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经验证的蓝牙HID外围设备发起和建立加密连接，并接受HID键盘报告，从而可能注入HID消息。攻击者可以伪装成蓝牙键盘，在目标设备未授权的情况下发送键盘输入，实现远程命令执行等恶意操作。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞允许攻击者在未经用户授权的情况下，通过蓝牙连接并模拟键盘输入，具有较高的利用价值。提供的POC代码似乎包含多种攻击场景，如暴力破解密码、相机劫持（camphish）、恶意APK下载和安装、文件上传以及发送WhatsApp消息。虽然具体效果取决于目标设备和配置，但整体来看，这些POC代码具备一定的有效性。

**投毒风险评估：**

提供的POC代码主要利用键盘输入模拟用户操作，实现特定功能。虽然这些功能本身可能被滥用，但代码本身并未发现明显的恶意后门或植入行为，判断该仓库的投毒风险为10%。

**利用方式分析：**

1.  **连接阶段绕过：** 漏洞核心在于绕过蓝牙HID连接时的身份验证或授权机制，允许攻击者控制的设备未经许可建立连接。
2.  **HID消息注入：** 成功建立连接后，攻击者可以发送任意HID消息，模拟键盘输入、鼠标点击等操作。
3.  **利用场景：**
    *   **密码暴力破解：** 通过模拟键盘输入，尝试不同的密码组合。
    *   **恶意链接打开：** 注入URL，诱导用户访问恶意网站，例如下载恶意APK。
    *   **摄像头劫持：** 通过注入特定URL，利用WebRTC等技术访问摄像头，拍摄照片。
    *   **文件上传：** 打开文件上传页面，模拟用户操作选择并上传文件。
    *   **发送消息：** 打开WhatsApp网页版，模拟用户输入并发送消息。
4.  **攻击流程示例（恶意APK安装）：**
    *   攻击者伪装成蓝牙键盘，连接目标设备。
    *   注入包含恶意APK下载链接的URL，打开浏览器。
    *   模拟键盘输入，点击下载按钮。
    *   模拟键盘输入，允许安装未知来源应用。
    *   模拟键盘输入，完成APK安装。

**优先级：**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

**项目地址:** [AvishekDhakal/CVE-2023-45866_EXPLOITS](https://github.com/AvishekDhakal/CVE-2023-45866_EXPLOITS)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #2

**来源**: [CVE-2023-45866-Chedrian07_CVE-2023-45866-POC.md](../2023/CVE-2023-45866-Chedrian07_CVE-2023-45866-POC.md)

## CVE-2023-45866 BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.64 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需要在目标设备蓝牙范围内，且目标设备未进行必要的身份验证或配对。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙外围设备模拟HID设备（例如键盘），并向主机系统注入恶意输入。该漏洞存在于BlueZ蓝牙协议栈中，攻击者可以绕过身份验证，建立加密连接，并发送HID报告，从而模拟键盘输入，执行任意命令。

**有效性分析：**
根据漏洞信息，搜索引擎结果以及提供的POC代码，可以判定该漏洞是有效的。POC代码是一个Python脚本，它模拟了一个蓝牙键盘，并尝试连接到目标设备并发送按键输入。脚本中实现了HID报告的构造和发送，以及DuckyScript的解析功能，可以执行预定义的恶意payload。

**投毒风险分析：**
虽然脚本本身旨在利用该漏洞，但其中可能存在一些潜在的投毒风险。例如，脚本可能包含：
1.  **恶意Payload：** DuckyScript部分，攻击者可能将脚本配置为执行破坏性的命令，例如删除文件、安装恶意软件或窃取敏感数据。
2.  **后门功能：** 脚本可能包含额外的代码，用于在目标系统上安装后门，允许攻击者在以后重新访问该系统。
3.  **信息收集：** 脚本可以收集有关目标系统的信息，例如操作系统版本、已安装的软件或网络配置，并将这些信息发送给攻击者。

对代码进行分析后，发现代码的功能主要集中在模拟蓝牙键盘和发送预定义的按键序列。但是，`process_duckyscript` 函数允许执行任意的DuckyScript命令，这本身就具有潜在的风险。因此投毒风险定为10%,主要集中在DuckyScript的 payload 部分。

**利用方式：**
1.  **准备：** 攻击者需要一台配备蓝牙功能的设备，并安装必要的软件库（例如Python的`bluetooth`库）。
2.  **扫描：** 使用蓝牙扫描工具查找附近易受攻击的设备。
3.  **连接：** 使用POC代码中提供的蓝牙地址连接到目标设备。
4.  **注入：** 通过发送HID报告模拟键盘输入，执行恶意命令。

总而言之，CVE-2023-45866是一个严重的安全漏洞，攻击者可以利用它来远程控制受影响的设备。用户应及时更新BlueZ版本，或者禁用蓝牙功能来防范攻击。

**项目地址:** [Chedrian07/CVE-2023-45866-POC](https://github.com/Chedrian07/CVE-2023-45866-POC)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #3

**来源**: [CVE-2023-45866-Danyw24_blueXploit.md](../2023/CVE-2023-45866-Danyw24_blueXploit.md)

## CVE-2023-45866 - BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** bluez 5.64-0ubuntu1 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需在蓝牙通信范围内，目标设备开启蓝牙且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许未经验证的攻击者通过伪装成蓝牙HID设备，在受害者设备上注入键盘输入。利用方式如下：

1.  攻击者使用特定的蓝牙HID设备（如伪造的键盘）发起连接。
2.  由于BlueZ在某些版本中未正确处理身份验证，攻击者可以绕过配对流程，建立加密连接。
3.  攻击者随后可以发送恶意HID报告，模拟键盘输入。
4.  通过模拟按键，攻击者可以执行任意命令，如打开终端、下载恶意软件等。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开可用的POC。因此，漏洞利用具有有效性。

**投毒风险评估：**

查看提供的漏洞利用代码（blueXploit），发现代码主要功能是利用CVE-2023-45866漏洞进行蓝牙HID注入攻击。代码包含自动生成payload并注入到APK的功能，存在一定的风险，但更多是利用msfvenom等工具生成payload, **所以判断投毒概率较低,大约为5%。**

**利用方式分析：**

blueXploit利用工具：

1.  **模拟HID设备：** 代码可能使用Linux的蓝牙工具（如`bluez-tools`）来模拟HID设备，使其能够发送键盘和鼠标事件。
2.  **绕过认证：** 漏洞的核心在于绕过蓝牙HID的认证机制。POC代码会尝试建立未认证的连接，或者利用已知的漏洞来欺骗目标设备。
3.  **Payload注入：** 成功建立连接后，POC代码会注入预先定义的payload，这些payload通常包含一系列键盘指令，用于在目标设备上执行命令。利用APK的组件，可能导致恶意软件安装或其他恶意行为。

**结论：**

CVE-2023-45866是一个严重的安全漏洞，允许未经授权的攻击者通过蓝牙注入键盘输入，从而控制受害者设备。提供的POC代码可以有效利用该漏洞。存在少许投毒风险但主要集中在自动化payload生成和注入方面，需要谨慎使用。攻击者需要具备一定的蓝牙协议和Linux系统知识才能成功利用该漏洞。

**项目地址:** [Danyw24/blueXploit](https://github.com/Danyw24/blueXploit)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #4

**来源**: [CVE-2023-45866-Eason-zz_BluetoothDucky.md](../2023/CVE-2023-45866-Eason-zz_BluetoothDucky.md)

## CVE-2023-45866-BlueZ-蓝牙HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，允许未授权的蓝牙HID设备注入键盘事件，可能导致任意命令执行

**影响版本:** 5.64-0ubuntu1 (Ubuntu 22.04LTS)等受影响版本

**利用条件:** 攻击者需要在蓝牙通信范围内，目标设备开启蓝牙功能且未采取CVE-2020-0556的缓解措施。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未认证的蓝牙外围设备 (Peripheral role HID Device) 发起并建立加密连接，并接收 HID 键盘报告。攻击者可以伪装成蓝牙键盘，在没有用户交互的情况下向主机注入 HID 消息，例如键盘按键，从而执行任意命令。 

**有效性评估：**
根据漏洞信息和搜索引擎结果，该漏洞利用的关键在于绕过蓝牙配对认证，从而模拟键盘输入。提供的Python脚本`BluetoothDucky.py`尝试自动化此过程。脚本通过以下步骤利用漏洞：

1.  **蓝牙适配器初始化：** 重启蓝牙服务，配置适配器名称和类别。
2.  **HID Profile注册：** 注册HID profile，使系统认为该设备是HID设备。
3.  **连接目标设备：** 尝试连接目标设备的SDP服务，并进行配对。
4.  **HID连接：** 连接HID中断和控制端口。
5.  **Payload执行：** 从指定文件读取Ducky脚本，并将其转换为HID键盘报告发送到目标设备。

根据搜索结果，该漏洞影响包括Android、iOS和Linux等多个平台。因此，如果脚本能够成功建立蓝牙连接并绕过认证，则漏洞利用应该是有效的。

**投毒风险分析：**
分析提供的Python脚本 `BluetoothDucky.py`，未发现明显的恶意代码或后门。脚本主要功能是模拟蓝牙键盘并发送预定义的按键序列。

以下是未发现明显投毒代码的理由：

*   脚本的主要功能是模拟键盘输入，逻辑清晰。
*   脚本依赖于标准的Python库和Linux工具 (例如 `bluetooth`, `hcitool`)。
*   脚本没有尝试访问本地文件系统、网络连接或执行其他可疑操作。
*   `injector` 目录下的文件需要进一步分析, 但当前的代码片段没有展示出恶意行为。

虽然没有发现明显的投毒代码，但仍存在以下潜在风险：

*   Ducky脚本本身可能包含恶意命令，例如下载和执行恶意软件。这取决于攻击者提供的payload。
*   脚本的依赖项 (例如 `injector` 目录下的模块) 可能包含漏洞或恶意代码。由于没有提供完整代码，无法进行全面分析。
*   脚本的实现可能存在缺陷，导致意外行为或安全问题。

综合考虑，投毒风险较低，但不能完全排除。给予10%的投毒风险评估。

**利用方式：**

1.  **扫描目标设备：** 使用蓝牙扫描工具 (例如 `bluetooth.discover_devices`) 查找附近的蓝牙设备。
2.  **配置攻击环境：** 安装必要的Python库 (例如 `pybluez`)，并确保蓝牙适配器正常工作。
3.  **运行攻击脚本：** 运行 `BluetoothDucky.py` 脚本，指定目标设备的蓝牙地址和用于攻击的蓝牙接口。
4.  **建立连接：** 脚本尝试与目标设备建立蓝牙连接，并绕过认证。
5.  **注入键盘事件：** 脚本将Ducky脚本转换为HID键盘报告，并发送到目标设备。

**总结：**
CVE-2023-45866是一个高危漏洞，攻击者可以通过模拟蓝牙键盘注入恶意键盘事件，从而控制目标设备。提供的POC代码具有一定的有效性，但需要进一步测试和验证。投毒风险较低，但不能完全排除。

**项目地址:** [Eason-zz/BluetoothDucky](https://github.com/Eason-zz/BluetoothDucky)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #5

**来源**: [CVE-2023-45866-cisnarfu_Bluepop.md](../2023/CVE-2023-45866-cisnarfu_Bluepop.md)

# CVE-2023-45866

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45866-AvishekDhakal_CVE-2023-45866_EXPLOITS.md](../2023/CVE-2023-45866-AvishekDhakal_CVE-2023-45866_EXPLOITS.md)

## CVE-2023-45866-BlueZ-蓝牙HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致键盘注入攻击，远程命令执行

**影响版本:** bluez <= 5.64 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需在蓝牙通信范围内，目标设备蓝牙开启且易受攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经验证的蓝牙HID外围设备发起和建立加密连接，并接受HID键盘报告，从而可能注入HID消息。攻击者可以伪装成蓝牙键盘，在目标设备未授权的情况下发送键盘输入，实现远程命令执行等恶意操作。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞允许攻击者在未经用户授权的情况下，通过蓝牙连接并模拟键盘输入，具有较高的利用价值。提供的POC代码似乎包含多种攻击场景，如暴力破解密码、相机劫持（camphish）、恶意APK下载和安装、文件上传以及发送WhatsApp消息。虽然具体效果取决于目标设备和配置，但整体来看，这些POC代码具备一定的有效性。

**投毒风险评估：**

提供的POC代码主要利用键盘输入模拟用户操作，实现特定功能。虽然这些功能本身可能被滥用，但代码本身并未发现明显的恶意后门或植入行为，判断该仓库的投毒风险为10%。

**利用方式分析：**

1.  **连接阶段绕过：** 漏洞核心在于绕过蓝牙HID连接时的身份验证或授权机制，允许攻击者控制的设备未经许可建立连接。
2.  **HID消息注入：** 成功建立连接后，攻击者可以发送任意HID消息，模拟键盘输入、鼠标点击等操作。
3.  **利用场景：**
    *   **密码暴力破解：** 通过模拟键盘输入，尝试不同的密码组合。
    *   **恶意链接打开：** 注入URL，诱导用户访问恶意网站，例如下载恶意APK。
    *   **摄像头劫持：** 通过注入特定URL，利用WebRTC等技术访问摄像头，拍摄照片。
    *   **文件上传：** 打开文件上传页面，模拟用户操作选择并上传文件。
    *   **发送消息：** 打开WhatsApp网页版，模拟用户输入并发送消息。
4.  **攻击流程示例（恶意APK安装）：**
    *   攻击者伪装成蓝牙键盘，连接目标设备。
    *   注入包含恶意APK下载链接的URL，打开浏览器。
    *   模拟键盘输入，点击下载按钮。
    *   模拟键盘输入，允许安装未知来源应用。
    *   模拟键盘输入，完成APK安装。

**优先级：**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

**项目地址:** [AvishekDhakal/CVE-2023-45866_EXPLOITS](https://github.com/AvishekDhakal/CVE-2023-45866_EXPLOITS)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #2

**来源**: [CVE-2023-45866-Chedrian07_CVE-2023-45866-POC.md](../2023/CVE-2023-45866-Chedrian07_CVE-2023-45866-POC.md)

## CVE-2023-45866 BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.64 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需要在目标设备蓝牙范围内，且目标设备未进行必要的身份验证或配对。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙外围设备模拟HID设备（例如键盘），并向主机系统注入恶意输入。该漏洞存在于BlueZ蓝牙协议栈中，攻击者可以绕过身份验证，建立加密连接，并发送HID报告，从而模拟键盘输入，执行任意命令。

**有效性分析：**
根据漏洞信息，搜索引擎结果以及提供的POC代码，可以判定该漏洞是有效的。POC代码是一个Python脚本，它模拟了一个蓝牙键盘，并尝试连接到目标设备并发送按键输入。脚本中实现了HID报告的构造和发送，以及DuckyScript的解析功能，可以执行预定义的恶意payload。

**投毒风险分析：**
虽然脚本本身旨在利用该漏洞，但其中可能存在一些潜在的投毒风险。例如，脚本可能包含：
1.  **恶意Payload：** DuckyScript部分，攻击者可能将脚本配置为执行破坏性的命令，例如删除文件、安装恶意软件或窃取敏感数据。
2.  **后门功能：** 脚本可能包含额外的代码，用于在目标系统上安装后门，允许攻击者在以后重新访问该系统。
3.  **信息收集：** 脚本可以收集有关目标系统的信息，例如操作系统版本、已安装的软件或网络配置，并将这些信息发送给攻击者。

对代码进行分析后，发现代码的功能主要集中在模拟蓝牙键盘和发送预定义的按键序列。但是，`process_duckyscript` 函数允许执行任意的DuckyScript命令，这本身就具有潜在的风险。因此投毒风险定为10%,主要集中在DuckyScript的 payload 部分。

**利用方式：**
1.  **准备：** 攻击者需要一台配备蓝牙功能的设备，并安装必要的软件库（例如Python的`bluetooth`库）。
2.  **扫描：** 使用蓝牙扫描工具查找附近易受攻击的设备。
3.  **连接：** 使用POC代码中提供的蓝牙地址连接到目标设备。
4.  **注入：** 通过发送HID报告模拟键盘输入，执行恶意命令。

总而言之，CVE-2023-45866是一个严重的安全漏洞，攻击者可以利用它来远程控制受影响的设备。用户应及时更新BlueZ版本，或者禁用蓝牙功能来防范攻击。

**项目地址:** [Chedrian07/CVE-2023-45866-POC](https://github.com/Chedrian07/CVE-2023-45866-POC)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #3

**来源**: [CVE-2023-45866-Danyw24_blueXploit.md](../2023/CVE-2023-45866-Danyw24_blueXploit.md)

## CVE-2023-45866 - BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** bluez 5.64-0ubuntu1 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需在蓝牙通信范围内，目标设备开启蓝牙且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许未经验证的攻击者通过伪装成蓝牙HID设备，在受害者设备上注入键盘输入。利用方式如下：

1.  攻击者使用特定的蓝牙HID设备（如伪造的键盘）发起连接。
2.  由于BlueZ在某些版本中未正确处理身份验证，攻击者可以绕过配对流程，建立加密连接。
3.  攻击者随后可以发送恶意HID报告，模拟键盘输入。
4.  通过模拟按键，攻击者可以执行任意命令，如打开终端、下载恶意软件等。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开可用的POC。因此，漏洞利用具有有效性。

**投毒风险评估：**

查看提供的漏洞利用代码（blueXploit），发现代码主要功能是利用CVE-2023-45866漏洞进行蓝牙HID注入攻击。代码包含自动生成payload并注入到APK的功能，存在一定的风险，但更多是利用msfvenom等工具生成payload, **所以判断投毒概率较低,大约为5%。**

**利用方式分析：**

blueXploit利用工具：

1.  **模拟HID设备：** 代码可能使用Linux的蓝牙工具（如`bluez-tools`）来模拟HID设备，使其能够发送键盘和鼠标事件。
2.  **绕过认证：** 漏洞的核心在于绕过蓝牙HID的认证机制。POC代码会尝试建立未认证的连接，或者利用已知的漏洞来欺骗目标设备。
3.  **Payload注入：** 成功建立连接后，POC代码会注入预先定义的payload，这些payload通常包含一系列键盘指令，用于在目标设备上执行命令。利用APK的组件，可能导致恶意软件安装或其他恶意行为。

**结论：**

CVE-2023-45866是一个严重的安全漏洞，允许未经授权的攻击者通过蓝牙注入键盘输入，从而控制受害者设备。提供的POC代码可以有效利用该漏洞。存在少许投毒风险但主要集中在自动化payload生成和注入方面，需要谨慎使用。攻击者需要具备一定的蓝牙协议和Linux系统知识才能成功利用该漏洞。

**项目地址:** [Danyw24/blueXploit](https://github.com/Danyw24/blueXploit)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #4

**来源**: [CVE-2023-45866-Eason-zz_BluetoothDucky.md](../2023/CVE-2023-45866-Eason-zz_BluetoothDucky.md)

## CVE-2023-45866-BlueZ-蓝牙HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，允许未授权的蓝牙HID设备注入键盘事件，可能导致任意命令执行

**影响版本:** 5.64-0ubuntu1 (Ubuntu 22.04LTS)等受影响版本

**利用条件:** 攻击者需要在蓝牙通信范围内，目标设备开启蓝牙功能且未采取CVE-2020-0556的缓解措施。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未认证的蓝牙外围设备 (Peripheral role HID Device) 发起并建立加密连接，并接收 HID 键盘报告。攻击者可以伪装成蓝牙键盘，在没有用户交互的情况下向主机注入 HID 消息，例如键盘按键，从而执行任意命令。 

**有效性评估：**
根据漏洞信息和搜索引擎结果，该漏洞利用的关键在于绕过蓝牙配对认证，从而模拟键盘输入。提供的Python脚本`BluetoothDucky.py`尝试自动化此过程。脚本通过以下步骤利用漏洞：

1.  **蓝牙适配器初始化：** 重启蓝牙服务，配置适配器名称和类别。
2.  **HID Profile注册：** 注册HID profile，使系统认为该设备是HID设备。
3.  **连接目标设备：** 尝试连接目标设备的SDP服务，并进行配对。
4.  **HID连接：** 连接HID中断和控制端口。
5.  **Payload执行：** 从指定文件读取Ducky脚本，并将其转换为HID键盘报告发送到目标设备。

根据搜索结果，该漏洞影响包括Android、iOS和Linux等多个平台。因此，如果脚本能够成功建立蓝牙连接并绕过认证，则漏洞利用应该是有效的。

**投毒风险分析：**
分析提供的Python脚本 `BluetoothDucky.py`，未发现明显的恶意代码或后门。脚本主要功能是模拟蓝牙键盘并发送预定义的按键序列。

以下是未发现明显投毒代码的理由：

*   脚本的主要功能是模拟键盘输入，逻辑清晰。
*   脚本依赖于标准的Python库和Linux工具 (例如 `bluetooth`, `hcitool`)。
*   脚本没有尝试访问本地文件系统、网络连接或执行其他可疑操作。
*   `injector` 目录下的文件需要进一步分析, 但当前的代码片段没有展示出恶意行为。

虽然没有发现明显的投毒代码，但仍存在以下潜在风险：

*   Ducky脚本本身可能包含恶意命令，例如下载和执行恶意软件。这取决于攻击者提供的payload。
*   脚本的依赖项 (例如 `injector` 目录下的模块) 可能包含漏洞或恶意代码。由于没有提供完整代码，无法进行全面分析。
*   脚本的实现可能存在缺陷，导致意外行为或安全问题。

综合考虑，投毒风险较低，但不能完全排除。给予10%的投毒风险评估。

**利用方式：**

1.  **扫描目标设备：** 使用蓝牙扫描工具 (例如 `bluetooth.discover_devices`) 查找附近的蓝牙设备。
2.  **配置攻击环境：** 安装必要的Python库 (例如 `pybluez`)，并确保蓝牙适配器正常工作。
3.  **运行攻击脚本：** 运行 `BluetoothDucky.py` 脚本，指定目标设备的蓝牙地址和用于攻击的蓝牙接口。
4.  **建立连接：** 脚本尝试与目标设备建立蓝牙连接，并绕过认证。
5.  **注入键盘事件：** 脚本将Ducky脚本转换为HID键盘报告，并发送到目标设备。

**总结：**
CVE-2023-45866是一个高危漏洞，攻击者可以通过模拟蓝牙键盘注入恶意键盘事件，从而控制目标设备。提供的POC代码具有一定的有效性，但需要进一步测试和验证。投毒风险较低，但不能完全排除。

**项目地址:** [Eason-zz/BluetoothDucky](https://github.com/Eason-zz/BluetoothDucky)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #5

**来源**: [CVE-2023-45866-cisnarfu_Bluepop.md](../2023/CVE-2023-45866-cisnarfu_Bluepop.md)

# CVE-2023-45866

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45866-AvishekDhakal_CVE-2023-45866_EXPLOITS.md](../2023/CVE-2023-45866-AvishekDhakal_CVE-2023-45866_EXPLOITS.md)

## CVE-2023-45866-BlueZ-蓝牙HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致键盘注入攻击，远程命令执行

**影响版本:** bluez <= 5.64 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需在蓝牙通信范围内，目标设备蓝牙开启且易受攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经验证的蓝牙HID外围设备发起和建立加密连接，并接受HID键盘报告，从而可能注入HID消息。攻击者可以伪装成蓝牙键盘，在目标设备未授权的情况下发送键盘输入，实现远程命令执行等恶意操作。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞允许攻击者在未经用户授权的情况下，通过蓝牙连接并模拟键盘输入，具有较高的利用价值。提供的POC代码似乎包含多种攻击场景，如暴力破解密码、相机劫持（camphish）、恶意APK下载和安装、文件上传以及发送WhatsApp消息。虽然具体效果取决于目标设备和配置，但整体来看，这些POC代码具备一定的有效性。

**投毒风险评估：**

提供的POC代码主要利用键盘输入模拟用户操作，实现特定功能。虽然这些功能本身可能被滥用，但代码本身并未发现明显的恶意后门或植入行为，判断该仓库的投毒风险为10%。

**利用方式分析：**

1.  **连接阶段绕过：** 漏洞核心在于绕过蓝牙HID连接时的身份验证或授权机制，允许攻击者控制的设备未经许可建立连接。
2.  **HID消息注入：** 成功建立连接后，攻击者可以发送任意HID消息，模拟键盘输入、鼠标点击等操作。
3.  **利用场景：**
    *   **密码暴力破解：** 通过模拟键盘输入，尝试不同的密码组合。
    *   **恶意链接打开：** 注入URL，诱导用户访问恶意网站，例如下载恶意APK。
    *   **摄像头劫持：** 通过注入特定URL，利用WebRTC等技术访问摄像头，拍摄照片。
    *   **文件上传：** 打开文件上传页面，模拟用户操作选择并上传文件。
    *   **发送消息：** 打开WhatsApp网页版，模拟用户输入并发送消息。
4.  **攻击流程示例（恶意APK安装）：**
    *   攻击者伪装成蓝牙键盘，连接目标设备。
    *   注入包含恶意APK下载链接的URL，打开浏览器。
    *   模拟键盘输入，点击下载按钮。
    *   模拟键盘输入，允许安装未知来源应用。
    *   模拟键盘输入，完成APK安装。

**优先级：**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

**项目地址:** [AvishekDhakal/CVE-2023-45866_EXPLOITS](https://github.com/AvishekDhakal/CVE-2023-45866_EXPLOITS)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #2

**来源**: [CVE-2023-45866-Chedrian07_CVE-2023-45866-POC.md](../2023/CVE-2023-45866-Chedrian07_CVE-2023-45866-POC.md)

## CVE-2023-45866 BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.64 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需要在目标设备蓝牙范围内，且目标设备未进行必要的身份验证或配对。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙外围设备模拟HID设备（例如键盘），并向主机系统注入恶意输入。该漏洞存在于BlueZ蓝牙协议栈中，攻击者可以绕过身份验证，建立加密连接，并发送HID报告，从而模拟键盘输入，执行任意命令。

**有效性分析：**
根据漏洞信息，搜索引擎结果以及提供的POC代码，可以判定该漏洞是有效的。POC代码是一个Python脚本，它模拟了一个蓝牙键盘，并尝试连接到目标设备并发送按键输入。脚本中实现了HID报告的构造和发送，以及DuckyScript的解析功能，可以执行预定义的恶意payload。

**投毒风险分析：**
虽然脚本本身旨在利用该漏洞，但其中可能存在一些潜在的投毒风险。例如，脚本可能包含：
1.  **恶意Payload：** DuckyScript部分，攻击者可能将脚本配置为执行破坏性的命令，例如删除文件、安装恶意软件或窃取敏感数据。
2.  **后门功能：** 脚本可能包含额外的代码，用于在目标系统上安装后门，允许攻击者在以后重新访问该系统。
3.  **信息收集：** 脚本可以收集有关目标系统的信息，例如操作系统版本、已安装的软件或网络配置，并将这些信息发送给攻击者。

对代码进行分析后，发现代码的功能主要集中在模拟蓝牙键盘和发送预定义的按键序列。但是，`process_duckyscript` 函数允许执行任意的DuckyScript命令，这本身就具有潜在的风险。因此投毒风险定为10%,主要集中在DuckyScript的 payload 部分。

**利用方式：**
1.  **准备：** 攻击者需要一台配备蓝牙功能的设备，并安装必要的软件库（例如Python的`bluetooth`库）。
2.  **扫描：** 使用蓝牙扫描工具查找附近易受攻击的设备。
3.  **连接：** 使用POC代码中提供的蓝牙地址连接到目标设备。
4.  **注入：** 通过发送HID报告模拟键盘输入，执行恶意命令。

总而言之，CVE-2023-45866是一个严重的安全漏洞，攻击者可以利用它来远程控制受影响的设备。用户应及时更新BlueZ版本，或者禁用蓝牙功能来防范攻击。

**项目地址:** [Chedrian07/CVE-2023-45866-POC](https://github.com/Chedrian07/CVE-2023-45866-POC)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #3

**来源**: [CVE-2023-45866-Danyw24_blueXploit.md](../2023/CVE-2023-45866-Danyw24_blueXploit.md)

## CVE-2023-45866 - BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** bluez 5.64-0ubuntu1 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需在蓝牙通信范围内，目标设备开启蓝牙且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许未经验证的攻击者通过伪装成蓝牙HID设备，在受害者设备上注入键盘输入。利用方式如下：

1.  攻击者使用特定的蓝牙HID设备（如伪造的键盘）发起连接。
2.  由于BlueZ在某些版本中未正确处理身份验证，攻击者可以绕过配对流程，建立加密连接。
3.  攻击者随后可以发送恶意HID报告，模拟键盘输入。
4.  通过模拟按键，攻击者可以执行任意命令，如打开终端、下载恶意软件等。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开可用的POC。因此，漏洞利用具有有效性。

**投毒风险评估：**

查看提供的漏洞利用代码（blueXploit），发现代码主要功能是利用CVE-2023-45866漏洞进行蓝牙HID注入攻击。代码包含自动生成payload并注入到APK的功能，存在一定的风险，但更多是利用msfvenom等工具生成payload, **所以判断投毒概率较低,大约为5%。**

**利用方式分析：**

blueXploit利用工具：

1.  **模拟HID设备：** 代码可能使用Linux的蓝牙工具（如`bluez-tools`）来模拟HID设备，使其能够发送键盘和鼠标事件。
2.  **绕过认证：** 漏洞的核心在于绕过蓝牙HID的认证机制。POC代码会尝试建立未认证的连接，或者利用已知的漏洞来欺骗目标设备。
3.  **Payload注入：** 成功建立连接后，POC代码会注入预先定义的payload，这些payload通常包含一系列键盘指令，用于在目标设备上执行命令。利用APK的组件，可能导致恶意软件安装或其他恶意行为。

**结论：**

CVE-2023-45866是一个严重的安全漏洞，允许未经授权的攻击者通过蓝牙注入键盘输入，从而控制受害者设备。提供的POC代码可以有效利用该漏洞。存在少许投毒风险但主要集中在自动化payload生成和注入方面，需要谨慎使用。攻击者需要具备一定的蓝牙协议和Linux系统知识才能成功利用该漏洞。

**项目地址:** [Danyw24/blueXploit](https://github.com/Danyw24/blueXploit)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #4

**来源**: [CVE-2023-45866-Eason-zz_BluetoothDucky.md](../2023/CVE-2023-45866-Eason-zz_BluetoothDucky.md)

## CVE-2023-45866-BlueZ-蓝牙HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，允许未授权的蓝牙HID设备注入键盘事件，可能导致任意命令执行

**影响版本:** 5.64-0ubuntu1 (Ubuntu 22.04LTS)等受影响版本

**利用条件:** 攻击者需要在蓝牙通信范围内，目标设备开启蓝牙功能且未采取CVE-2020-0556的缓解措施。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未认证的蓝牙外围设备 (Peripheral role HID Device) 发起并建立加密连接，并接收 HID 键盘报告。攻击者可以伪装成蓝牙键盘，在没有用户交互的情况下向主机注入 HID 消息，例如键盘按键，从而执行任意命令。 

**有效性评估：**
根据漏洞信息和搜索引擎结果，该漏洞利用的关键在于绕过蓝牙配对认证，从而模拟键盘输入。提供的Python脚本`BluetoothDucky.py`尝试自动化此过程。脚本通过以下步骤利用漏洞：

1.  **蓝牙适配器初始化：** 重启蓝牙服务，配置适配器名称和类别。
2.  **HID Profile注册：** 注册HID profile，使系统认为该设备是HID设备。
3.  **连接目标设备：** 尝试连接目标设备的SDP服务，并进行配对。
4.  **HID连接：** 连接HID中断和控制端口。
5.  **Payload执行：** 从指定文件读取Ducky脚本，并将其转换为HID键盘报告发送到目标设备。

根据搜索结果，该漏洞影响包括Android、iOS和Linux等多个平台。因此，如果脚本能够成功建立蓝牙连接并绕过认证，则漏洞利用应该是有效的。

**投毒风险分析：**
分析提供的Python脚本 `BluetoothDucky.py`，未发现明显的恶意代码或后门。脚本主要功能是模拟蓝牙键盘并发送预定义的按键序列。

以下是未发现明显投毒代码的理由：

*   脚本的主要功能是模拟键盘输入，逻辑清晰。
*   脚本依赖于标准的Python库和Linux工具 (例如 `bluetooth`, `hcitool`)。
*   脚本没有尝试访问本地文件系统、网络连接或执行其他可疑操作。
*   `injector` 目录下的文件需要进一步分析, 但当前的代码片段没有展示出恶意行为。

虽然没有发现明显的投毒代码，但仍存在以下潜在风险：

*   Ducky脚本本身可能包含恶意命令，例如下载和执行恶意软件。这取决于攻击者提供的payload。
*   脚本的依赖项 (例如 `injector` 目录下的模块) 可能包含漏洞或恶意代码。由于没有提供完整代码，无法进行全面分析。
*   脚本的实现可能存在缺陷，导致意外行为或安全问题。

综合考虑，投毒风险较低，但不能完全排除。给予10%的投毒风险评估。

**利用方式：**

1.  **扫描目标设备：** 使用蓝牙扫描工具 (例如 `bluetooth.discover_devices`) 查找附近的蓝牙设备。
2.  **配置攻击环境：** 安装必要的Python库 (例如 `pybluez`)，并确保蓝牙适配器正常工作。
3.  **运行攻击脚本：** 运行 `BluetoothDucky.py` 脚本，指定目标设备的蓝牙地址和用于攻击的蓝牙接口。
4.  **建立连接：** 脚本尝试与目标设备建立蓝牙连接，并绕过认证。
5.  **注入键盘事件：** 脚本将Ducky脚本转换为HID键盘报告，并发送到目标设备。

**总结：**
CVE-2023-45866是一个高危漏洞，攻击者可以通过模拟蓝牙键盘注入恶意键盘事件，从而控制目标设备。提供的POC代码具有一定的有效性，但需要进一步测试和验证。投毒风险较低，但不能完全排除。

**项目地址:** [Eason-zz/BluetoothDucky](https://github.com/Eason-zz/BluetoothDucky)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #5

**来源**: [CVE-2023-45866-cisnarfu_Bluepop.md](../2023/CVE-2023-45866-cisnarfu_Bluepop.md)

# CVE-2023-45866

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45866-AvishekDhakal_CVE-2023-45866_EXPLOITS.md](../2023/CVE-2023-45866-AvishekDhakal_CVE-2023-45866_EXPLOITS.md)

## CVE-2023-45866-BlueZ-蓝牙HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致键盘注入攻击，远程命令执行

**影响版本:** bluez <= 5.64 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需在蓝牙通信范围内，目标设备蓝牙开启且易受攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经验证的蓝牙HID外围设备发起和建立加密连接，并接受HID键盘报告，从而可能注入HID消息。攻击者可以伪装成蓝牙键盘，在目标设备未授权的情况下发送键盘输入，实现远程命令执行等恶意操作。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞允许攻击者在未经用户授权的情况下，通过蓝牙连接并模拟键盘输入，具有较高的利用价值。提供的POC代码似乎包含多种攻击场景，如暴力破解密码、相机劫持（camphish）、恶意APK下载和安装、文件上传以及发送WhatsApp消息。虽然具体效果取决于目标设备和配置，但整体来看，这些POC代码具备一定的有效性。

**投毒风险评估：**

提供的POC代码主要利用键盘输入模拟用户操作，实现特定功能。虽然这些功能本身可能被滥用，但代码本身并未发现明显的恶意后门或植入行为，判断该仓库的投毒风险为10%。

**利用方式分析：**

1.  **连接阶段绕过：** 漏洞核心在于绕过蓝牙HID连接时的身份验证或授权机制，允许攻击者控制的设备未经许可建立连接。
2.  **HID消息注入：** 成功建立连接后，攻击者可以发送任意HID消息，模拟键盘输入、鼠标点击等操作。
3.  **利用场景：**
    *   **密码暴力破解：** 通过模拟键盘输入，尝试不同的密码组合。
    *   **恶意链接打开：** 注入URL，诱导用户访问恶意网站，例如下载恶意APK。
    *   **摄像头劫持：** 通过注入特定URL，利用WebRTC等技术访问摄像头，拍摄照片。
    *   **文件上传：** 打开文件上传页面，模拟用户操作选择并上传文件。
    *   **发送消息：** 打开WhatsApp网页版，模拟用户输入并发送消息。
4.  **攻击流程示例（恶意APK安装）：**
    *   攻击者伪装成蓝牙键盘，连接目标设备。
    *   注入包含恶意APK下载链接的URL，打开浏览器。
    *   模拟键盘输入，点击下载按钮。
    *   模拟键盘输入，允许安装未知来源应用。
    *   模拟键盘输入，完成APK安装。

**优先级：**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

**项目地址:** [AvishekDhakal/CVE-2023-45866_EXPLOITS](https://github.com/AvishekDhakal/CVE-2023-45866_EXPLOITS)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #2

**来源**: [CVE-2023-45866-Chedrian07_CVE-2023-45866-POC.md](../2023/CVE-2023-45866-Chedrian07_CVE-2023-45866-POC.md)

## CVE-2023-45866 BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.64 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需要在目标设备蓝牙范围内，且目标设备未进行必要的身份验证或配对。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙外围设备模拟HID设备（例如键盘），并向主机系统注入恶意输入。该漏洞存在于BlueZ蓝牙协议栈中，攻击者可以绕过身份验证，建立加密连接，并发送HID报告，从而模拟键盘输入，执行任意命令。

**有效性分析：**
根据漏洞信息，搜索引擎结果以及提供的POC代码，可以判定该漏洞是有效的。POC代码是一个Python脚本，它模拟了一个蓝牙键盘，并尝试连接到目标设备并发送按键输入。脚本中实现了HID报告的构造和发送，以及DuckyScript的解析功能，可以执行预定义的恶意payload。

**投毒风险分析：**
虽然脚本本身旨在利用该漏洞，但其中可能存在一些潜在的投毒风险。例如，脚本可能包含：
1.  **恶意Payload：** DuckyScript部分，攻击者可能将脚本配置为执行破坏性的命令，例如删除文件、安装恶意软件或窃取敏感数据。
2.  **后门功能：** 脚本可能包含额外的代码，用于在目标系统上安装后门，允许攻击者在以后重新访问该系统。
3.  **信息收集：** 脚本可以收集有关目标系统的信息，例如操作系统版本、已安装的软件或网络配置，并将这些信息发送给攻击者。

对代码进行分析后，发现代码的功能主要集中在模拟蓝牙键盘和发送预定义的按键序列。但是，`process_duckyscript` 函数允许执行任意的DuckyScript命令，这本身就具有潜在的风险。因此投毒风险定为10%,主要集中在DuckyScript的 payload 部分。

**利用方式：**
1.  **准备：** 攻击者需要一台配备蓝牙功能的设备，并安装必要的软件库（例如Python的`bluetooth`库）。
2.  **扫描：** 使用蓝牙扫描工具查找附近易受攻击的设备。
3.  **连接：** 使用POC代码中提供的蓝牙地址连接到目标设备。
4.  **注入：** 通过发送HID报告模拟键盘输入，执行恶意命令。

总而言之，CVE-2023-45866是一个严重的安全漏洞，攻击者可以利用它来远程控制受影响的设备。用户应及时更新BlueZ版本，或者禁用蓝牙功能来防范攻击。

**项目地址:** [Chedrian07/CVE-2023-45866-POC](https://github.com/Chedrian07/CVE-2023-45866-POC)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #3

**来源**: [CVE-2023-45866-Danyw24_blueXploit.md](../2023/CVE-2023-45866-Danyw24_blueXploit.md)

## CVE-2023-45866 - BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** bluez 5.64-0ubuntu1 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需在蓝牙通信范围内，目标设备开启蓝牙且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许未经验证的攻击者通过伪装成蓝牙HID设备，在受害者设备上注入键盘输入。利用方式如下：

1.  攻击者使用特定的蓝牙HID设备（如伪造的键盘）发起连接。
2.  由于BlueZ在某些版本中未正确处理身份验证，攻击者可以绕过配对流程，建立加密连接。
3.  攻击者随后可以发送恶意HID报告，模拟键盘输入。
4.  通过模拟按键，攻击者可以执行任意命令，如打开终端、下载恶意软件等。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开可用的POC。因此，漏洞利用具有有效性。

**投毒风险评估：**

查看提供的漏洞利用代码（blueXploit），发现代码主要功能是利用CVE-2023-45866漏洞进行蓝牙HID注入攻击。代码包含自动生成payload并注入到APK的功能，存在一定的风险，但更多是利用msfvenom等工具生成payload, **所以判断投毒概率较低,大约为5%。**

**利用方式分析：**

blueXploit利用工具：

1.  **模拟HID设备：** 代码可能使用Linux的蓝牙工具（如`bluez-tools`）来模拟HID设备，使其能够发送键盘和鼠标事件。
2.  **绕过认证：** 漏洞的核心在于绕过蓝牙HID的认证机制。POC代码会尝试建立未认证的连接，或者利用已知的漏洞来欺骗目标设备。
3.  **Payload注入：** 成功建立连接后，POC代码会注入预先定义的payload，这些payload通常包含一系列键盘指令，用于在目标设备上执行命令。利用APK的组件，可能导致恶意软件安装或其他恶意行为。

**结论：**

CVE-2023-45866是一个严重的安全漏洞，允许未经授权的攻击者通过蓝牙注入键盘输入，从而控制受害者设备。提供的POC代码可以有效利用该漏洞。存在少许投毒风险但主要集中在自动化payload生成和注入方面，需要谨慎使用。攻击者需要具备一定的蓝牙协议和Linux系统知识才能成功利用该漏洞。

**项目地址:** [Danyw24/blueXploit](https://github.com/Danyw24/blueXploit)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #4

**来源**: [CVE-2023-45866-Eason-zz_BluetoothDucky.md](../2023/CVE-2023-45866-Eason-zz_BluetoothDucky.md)

## CVE-2023-45866-BlueZ-蓝牙HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，允许未授权的蓝牙HID设备注入键盘事件，可能导致任意命令执行

**影响版本:** 5.64-0ubuntu1 (Ubuntu 22.04LTS)等受影响版本

**利用条件:** 攻击者需要在蓝牙通信范围内，目标设备开启蓝牙功能且未采取CVE-2020-0556的缓解措施。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未认证的蓝牙外围设备 (Peripheral role HID Device) 发起并建立加密连接，并接收 HID 键盘报告。攻击者可以伪装成蓝牙键盘，在没有用户交互的情况下向主机注入 HID 消息，例如键盘按键，从而执行任意命令。 

**有效性评估：**
根据漏洞信息和搜索引擎结果，该漏洞利用的关键在于绕过蓝牙配对认证，从而模拟键盘输入。提供的Python脚本`BluetoothDucky.py`尝试自动化此过程。脚本通过以下步骤利用漏洞：

1.  **蓝牙适配器初始化：** 重启蓝牙服务，配置适配器名称和类别。
2.  **HID Profile注册：** 注册HID profile，使系统认为该设备是HID设备。
3.  **连接目标设备：** 尝试连接目标设备的SDP服务，并进行配对。
4.  **HID连接：** 连接HID中断和控制端口。
5.  **Payload执行：** 从指定文件读取Ducky脚本，并将其转换为HID键盘报告发送到目标设备。

根据搜索结果，该漏洞影响包括Android、iOS和Linux等多个平台。因此，如果脚本能够成功建立蓝牙连接并绕过认证，则漏洞利用应该是有效的。

**投毒风险分析：**
分析提供的Python脚本 `BluetoothDucky.py`，未发现明显的恶意代码或后门。脚本主要功能是模拟蓝牙键盘并发送预定义的按键序列。

以下是未发现明显投毒代码的理由：

*   脚本的主要功能是模拟键盘输入，逻辑清晰。
*   脚本依赖于标准的Python库和Linux工具 (例如 `bluetooth`, `hcitool`)。
*   脚本没有尝试访问本地文件系统、网络连接或执行其他可疑操作。
*   `injector` 目录下的文件需要进一步分析, 但当前的代码片段没有展示出恶意行为。

虽然没有发现明显的投毒代码，但仍存在以下潜在风险：

*   Ducky脚本本身可能包含恶意命令，例如下载和执行恶意软件。这取决于攻击者提供的payload。
*   脚本的依赖项 (例如 `injector` 目录下的模块) 可能包含漏洞或恶意代码。由于没有提供完整代码，无法进行全面分析。
*   脚本的实现可能存在缺陷，导致意外行为或安全问题。

综合考虑，投毒风险较低，但不能完全排除。给予10%的投毒风险评估。

**利用方式：**

1.  **扫描目标设备：** 使用蓝牙扫描工具 (例如 `bluetooth.discover_devices`) 查找附近的蓝牙设备。
2.  **配置攻击环境：** 安装必要的Python库 (例如 `pybluez`)，并确保蓝牙适配器正常工作。
3.  **运行攻击脚本：** 运行 `BluetoothDucky.py` 脚本，指定目标设备的蓝牙地址和用于攻击的蓝牙接口。
4.  **建立连接：** 脚本尝试与目标设备建立蓝牙连接，并绕过认证。
5.  **注入键盘事件：** 脚本将Ducky脚本转换为HID键盘报告，并发送到目标设备。

**总结：**
CVE-2023-45866是一个高危漏洞，攻击者可以通过模拟蓝牙键盘注入恶意键盘事件，从而控制目标设备。提供的POC代码具有一定的有效性，但需要进一步测试和验证。投毒风险较低，但不能完全排除。

**项目地址:** [Eason-zz/BluetoothDucky](https://github.com/Eason-zz/BluetoothDucky)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #5

**来源**: [CVE-2023-45866-cisnarfu_Bluepop.md](../2023/CVE-2023-45866-cisnarfu_Bluepop.md)

# CVE-2023-45866

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45866-AvishekDhakal_CVE-2023-45866_EXPLOITS.md](../2023/CVE-2023-45866-AvishekDhakal_CVE-2023-45866_EXPLOITS.md)

## CVE-2023-45866-BlueZ-蓝牙HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致键盘注入攻击，远程命令执行

**影响版本:** bluez <= 5.64 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需在蓝牙通信范围内，目标设备蓝牙开启且易受攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经验证的蓝牙HID外围设备发起和建立加密连接，并接受HID键盘报告，从而可能注入HID消息。攻击者可以伪装成蓝牙键盘，在目标设备未授权的情况下发送键盘输入，实现远程命令执行等恶意操作。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞允许攻击者在未经用户授权的情况下，通过蓝牙连接并模拟键盘输入，具有较高的利用价值。提供的POC代码似乎包含多种攻击场景，如暴力破解密码、相机劫持（camphish）、恶意APK下载和安装、文件上传以及发送WhatsApp消息。虽然具体效果取决于目标设备和配置，但整体来看，这些POC代码具备一定的有效性。

**投毒风险评估：**

提供的POC代码主要利用键盘输入模拟用户操作，实现特定功能。虽然这些功能本身可能被滥用，但代码本身并未发现明显的恶意后门或植入行为，判断该仓库的投毒风险为10%。

**利用方式分析：**

1.  **连接阶段绕过：** 漏洞核心在于绕过蓝牙HID连接时的身份验证或授权机制，允许攻击者控制的设备未经许可建立连接。
2.  **HID消息注入：** 成功建立连接后，攻击者可以发送任意HID消息，模拟键盘输入、鼠标点击等操作。
3.  **利用场景：**
    *   **密码暴力破解：** 通过模拟键盘输入，尝试不同的密码组合。
    *   **恶意链接打开：** 注入URL，诱导用户访问恶意网站，例如下载恶意APK。
    *   **摄像头劫持：** 通过注入特定URL，利用WebRTC等技术访问摄像头，拍摄照片。
    *   **文件上传：** 打开文件上传页面，模拟用户操作选择并上传文件。
    *   **发送消息：** 打开WhatsApp网页版，模拟用户输入并发送消息。
4.  **攻击流程示例（恶意APK安装）：**
    *   攻击者伪装成蓝牙键盘，连接目标设备。
    *   注入包含恶意APK下载链接的URL，打开浏览器。
    *   模拟键盘输入，点击下载按钮。
    *   模拟键盘输入，允许安装未知来源应用。
    *   模拟键盘输入，完成APK安装。

**优先级：**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

**项目地址:** [AvishekDhakal/CVE-2023-45866_EXPLOITS](https://github.com/AvishekDhakal/CVE-2023-45866_EXPLOITS)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #2

**来源**: [CVE-2023-45866-Chedrian07_CVE-2023-45866-POC.md](../2023/CVE-2023-45866-Chedrian07_CVE-2023-45866-POC.md)

## CVE-2023-45866 BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.64 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需要在目标设备蓝牙范围内，且目标设备未进行必要的身份验证或配对。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙外围设备模拟HID设备（例如键盘），并向主机系统注入恶意输入。该漏洞存在于BlueZ蓝牙协议栈中，攻击者可以绕过身份验证，建立加密连接，并发送HID报告，从而模拟键盘输入，执行任意命令。

**有效性分析：**
根据漏洞信息，搜索引擎结果以及提供的POC代码，可以判定该漏洞是有效的。POC代码是一个Python脚本，它模拟了一个蓝牙键盘，并尝试连接到目标设备并发送按键输入。脚本中实现了HID报告的构造和发送，以及DuckyScript的解析功能，可以执行预定义的恶意payload。

**投毒风险分析：**
虽然脚本本身旨在利用该漏洞，但其中可能存在一些潜在的投毒风险。例如，脚本可能包含：
1.  **恶意Payload：** DuckyScript部分，攻击者可能将脚本配置为执行破坏性的命令，例如删除文件、安装恶意软件或窃取敏感数据。
2.  **后门功能：** 脚本可能包含额外的代码，用于在目标系统上安装后门，允许攻击者在以后重新访问该系统。
3.  **信息收集：** 脚本可以收集有关目标系统的信息，例如操作系统版本、已安装的软件或网络配置，并将这些信息发送给攻击者。

对代码进行分析后，发现代码的功能主要集中在模拟蓝牙键盘和发送预定义的按键序列。但是，`process_duckyscript` 函数允许执行任意的DuckyScript命令，这本身就具有潜在的风险。因此投毒风险定为10%,主要集中在DuckyScript的 payload 部分。

**利用方式：**
1.  **准备：** 攻击者需要一台配备蓝牙功能的设备，并安装必要的软件库（例如Python的`bluetooth`库）。
2.  **扫描：** 使用蓝牙扫描工具查找附近易受攻击的设备。
3.  **连接：** 使用POC代码中提供的蓝牙地址连接到目标设备。
4.  **注入：** 通过发送HID报告模拟键盘输入，执行恶意命令。

总而言之，CVE-2023-45866是一个严重的安全漏洞，攻击者可以利用它来远程控制受影响的设备。用户应及时更新BlueZ版本，或者禁用蓝牙功能来防范攻击。

**项目地址:** [Chedrian07/CVE-2023-45866-POC](https://github.com/Chedrian07/CVE-2023-45866-POC)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #3

**来源**: [CVE-2023-45866-Danyw24_blueXploit.md](../2023/CVE-2023-45866-Danyw24_blueXploit.md)

## CVE-2023-45866 - BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** bluez 5.64-0ubuntu1 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需在蓝牙通信范围内，目标设备开启蓝牙且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许未经验证的攻击者通过伪装成蓝牙HID设备，在受害者设备上注入键盘输入。利用方式如下：

1.  攻击者使用特定的蓝牙HID设备（如伪造的键盘）发起连接。
2.  由于BlueZ在某些版本中未正确处理身份验证，攻击者可以绕过配对流程，建立加密连接。
3.  攻击者随后可以发送恶意HID报告，模拟键盘输入。
4.  通过模拟按键，攻击者可以执行任意命令，如打开终端、下载恶意软件等。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开可用的POC。因此，漏洞利用具有有效性。

**投毒风险评估：**

查看提供的漏洞利用代码（blueXploit），发现代码主要功能是利用CVE-2023-45866漏洞进行蓝牙HID注入攻击。代码包含自动生成payload并注入到APK的功能，存在一定的风险，但更多是利用msfvenom等工具生成payload, **所以判断投毒概率较低,大约为5%。**

**利用方式分析：**

blueXploit利用工具：

1.  **模拟HID设备：** 代码可能使用Linux的蓝牙工具（如`bluez-tools`）来模拟HID设备，使其能够发送键盘和鼠标事件。
2.  **绕过认证：** 漏洞的核心在于绕过蓝牙HID的认证机制。POC代码会尝试建立未认证的连接，或者利用已知的漏洞来欺骗目标设备。
3.  **Payload注入：** 成功建立连接后，POC代码会注入预先定义的payload，这些payload通常包含一系列键盘指令，用于在目标设备上执行命令。利用APK的组件，可能导致恶意软件安装或其他恶意行为。

**结论：**

CVE-2023-45866是一个严重的安全漏洞，允许未经授权的攻击者通过蓝牙注入键盘输入，从而控制受害者设备。提供的POC代码可以有效利用该漏洞。存在少许投毒风险但主要集中在自动化payload生成和注入方面，需要谨慎使用。攻击者需要具备一定的蓝牙协议和Linux系统知识才能成功利用该漏洞。

**项目地址:** [Danyw24/blueXploit](https://github.com/Danyw24/blueXploit)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #4

**来源**: [CVE-2023-45866-Eason-zz_BluetoothDucky.md](../2023/CVE-2023-45866-Eason-zz_BluetoothDucky.md)

## CVE-2023-45866-BlueZ-蓝牙HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，允许未授权的蓝牙HID设备注入键盘事件，可能导致任意命令执行

**影响版本:** 5.64-0ubuntu1 (Ubuntu 22.04LTS)等受影响版本

**利用条件:** 攻击者需要在蓝牙通信范围内，目标设备开启蓝牙功能且未采取CVE-2020-0556的缓解措施。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未认证的蓝牙外围设备 (Peripheral role HID Device) 发起并建立加密连接，并接收 HID 键盘报告。攻击者可以伪装成蓝牙键盘，在没有用户交互的情况下向主机注入 HID 消息，例如键盘按键，从而执行任意命令。 

**有效性评估：**
根据漏洞信息和搜索引擎结果，该漏洞利用的关键在于绕过蓝牙配对认证，从而模拟键盘输入。提供的Python脚本`BluetoothDucky.py`尝试自动化此过程。脚本通过以下步骤利用漏洞：

1.  **蓝牙适配器初始化：** 重启蓝牙服务，配置适配器名称和类别。
2.  **HID Profile注册：** 注册HID profile，使系统认为该设备是HID设备。
3.  **连接目标设备：** 尝试连接目标设备的SDP服务，并进行配对。
4.  **HID连接：** 连接HID中断和控制端口。
5.  **Payload执行：** 从指定文件读取Ducky脚本，并将其转换为HID键盘报告发送到目标设备。

根据搜索结果，该漏洞影响包括Android、iOS和Linux等多个平台。因此，如果脚本能够成功建立蓝牙连接并绕过认证，则漏洞利用应该是有效的。

**投毒风险分析：**
分析提供的Python脚本 `BluetoothDucky.py`，未发现明显的恶意代码或后门。脚本主要功能是模拟蓝牙键盘并发送预定义的按键序列。

以下是未发现明显投毒代码的理由：

*   脚本的主要功能是模拟键盘输入，逻辑清晰。
*   脚本依赖于标准的Python库和Linux工具 (例如 `bluetooth`, `hcitool`)。
*   脚本没有尝试访问本地文件系统、网络连接或执行其他可疑操作。
*   `injector` 目录下的文件需要进一步分析, 但当前的代码片段没有展示出恶意行为。

虽然没有发现明显的投毒代码，但仍存在以下潜在风险：

*   Ducky脚本本身可能包含恶意命令，例如下载和执行恶意软件。这取决于攻击者提供的payload。
*   脚本的依赖项 (例如 `injector` 目录下的模块) 可能包含漏洞或恶意代码。由于没有提供完整代码，无法进行全面分析。
*   脚本的实现可能存在缺陷，导致意外行为或安全问题。

综合考虑，投毒风险较低，但不能完全排除。给予10%的投毒风险评估。

**利用方式：**

1.  **扫描目标设备：** 使用蓝牙扫描工具 (例如 `bluetooth.discover_devices`) 查找附近的蓝牙设备。
2.  **配置攻击环境：** 安装必要的Python库 (例如 `pybluez`)，并确保蓝牙适配器正常工作。
3.  **运行攻击脚本：** 运行 `BluetoothDucky.py` 脚本，指定目标设备的蓝牙地址和用于攻击的蓝牙接口。
4.  **建立连接：** 脚本尝试与目标设备建立蓝牙连接，并绕过认证。
5.  **注入键盘事件：** 脚本将Ducky脚本转换为HID键盘报告，并发送到目标设备。

**总结：**
CVE-2023-45866是一个高危漏洞，攻击者可以通过模拟蓝牙键盘注入恶意键盘事件，从而控制目标设备。提供的POC代码具有一定的有效性，但需要进一步测试和验证。投毒风险较低，但不能完全排除。

**项目地址:** [Eason-zz/BluetoothDucky](https://github.com/Eason-zz/BluetoothDucky)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #5

**来源**: [CVE-2023-45866-cisnarfu_Bluepop.md](../2023/CVE-2023-45866-cisnarfu_Bluepop.md)

# CVE-2023-45866

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45866-AvishekDhakal_CVE-2023-45866_EXPLOITS.md](../2023/CVE-2023-45866-AvishekDhakal_CVE-2023-45866_EXPLOITS.md)

## CVE-2023-45866-BlueZ-蓝牙HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致键盘注入攻击，远程命令执行

**影响版本:** bluez <= 5.64 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需在蓝牙通信范围内，目标设备蓝牙开启且易受攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经验证的蓝牙HID外围设备发起和建立加密连接，并接受HID键盘报告，从而可能注入HID消息。攻击者可以伪装成蓝牙键盘，在目标设备未授权的情况下发送键盘输入，实现远程命令执行等恶意操作。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞允许攻击者在未经用户授权的情况下，通过蓝牙连接并模拟键盘输入，具有较高的利用价值。提供的POC代码似乎包含多种攻击场景，如暴力破解密码、相机劫持（camphish）、恶意APK下载和安装、文件上传以及发送WhatsApp消息。虽然具体效果取决于目标设备和配置，但整体来看，这些POC代码具备一定的有效性。

**投毒风险评估：**

提供的POC代码主要利用键盘输入模拟用户操作，实现特定功能。虽然这些功能本身可能被滥用，但代码本身并未发现明显的恶意后门或植入行为，判断该仓库的投毒风险为10%。

**利用方式分析：**

1.  **连接阶段绕过：** 漏洞核心在于绕过蓝牙HID连接时的身份验证或授权机制，允许攻击者控制的设备未经许可建立连接。
2.  **HID消息注入：** 成功建立连接后，攻击者可以发送任意HID消息，模拟键盘输入、鼠标点击等操作。
3.  **利用场景：**
    *   **密码暴力破解：** 通过模拟键盘输入，尝试不同的密码组合。
    *   **恶意链接打开：** 注入URL，诱导用户访问恶意网站，例如下载恶意APK。
    *   **摄像头劫持：** 通过注入特定URL，利用WebRTC等技术访问摄像头，拍摄照片。
    *   **文件上传：** 打开文件上传页面，模拟用户操作选择并上传文件。
    *   **发送消息：** 打开WhatsApp网页版，模拟用户输入并发送消息。
4.  **攻击流程示例（恶意APK安装）：**
    *   攻击者伪装成蓝牙键盘，连接目标设备。
    *   注入包含恶意APK下载链接的URL，打开浏览器。
    *   模拟键盘输入，点击下载按钮。
    *   模拟键盘输入，允许安装未知来源应用。
    *   模拟键盘输入，完成APK安装。

**优先级：**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

**项目地址:** [AvishekDhakal/CVE-2023-45866_EXPLOITS](https://github.com/AvishekDhakal/CVE-2023-45866_EXPLOITS)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #2

**来源**: [CVE-2023-45866-Chedrian07_CVE-2023-45866-POC.md](../2023/CVE-2023-45866-Chedrian07_CVE-2023-45866-POC.md)

## CVE-2023-45866 BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.64 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需要在目标设备蓝牙范围内，且目标设备未进行必要的身份验证或配对。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙外围设备模拟HID设备（例如键盘），并向主机系统注入恶意输入。该漏洞存在于BlueZ蓝牙协议栈中，攻击者可以绕过身份验证，建立加密连接，并发送HID报告，从而模拟键盘输入，执行任意命令。

**有效性分析：**
根据漏洞信息，搜索引擎结果以及提供的POC代码，可以判定该漏洞是有效的。POC代码是一个Python脚本，它模拟了一个蓝牙键盘，并尝试连接到目标设备并发送按键输入。脚本中实现了HID报告的构造和发送，以及DuckyScript的解析功能，可以执行预定义的恶意payload。

**投毒风险分析：**
虽然脚本本身旨在利用该漏洞，但其中可能存在一些潜在的投毒风险。例如，脚本可能包含：
1.  **恶意Payload：** DuckyScript部分，攻击者可能将脚本配置为执行破坏性的命令，例如删除文件、安装恶意软件或窃取敏感数据。
2.  **后门功能：** 脚本可能包含额外的代码，用于在目标系统上安装后门，允许攻击者在以后重新访问该系统。
3.  **信息收集：** 脚本可以收集有关目标系统的信息，例如操作系统版本、已安装的软件或网络配置，并将这些信息发送给攻击者。

对代码进行分析后，发现代码的功能主要集中在模拟蓝牙键盘和发送预定义的按键序列。但是，`process_duckyscript` 函数允许执行任意的DuckyScript命令，这本身就具有潜在的风险。因此投毒风险定为10%,主要集中在DuckyScript的 payload 部分。

**利用方式：**
1.  **准备：** 攻击者需要一台配备蓝牙功能的设备，并安装必要的软件库（例如Python的`bluetooth`库）。
2.  **扫描：** 使用蓝牙扫描工具查找附近易受攻击的设备。
3.  **连接：** 使用POC代码中提供的蓝牙地址连接到目标设备。
4.  **注入：** 通过发送HID报告模拟键盘输入，执行恶意命令。

总而言之，CVE-2023-45866是一个严重的安全漏洞，攻击者可以利用它来远程控制受影响的设备。用户应及时更新BlueZ版本，或者禁用蓝牙功能来防范攻击。

**项目地址:** [Chedrian07/CVE-2023-45866-POC](https://github.com/Chedrian07/CVE-2023-45866-POC)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #3

**来源**: [CVE-2023-45866-Danyw24_blueXploit.md](../2023/CVE-2023-45866-Danyw24_blueXploit.md)

## CVE-2023-45866 - BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** bluez 5.64-0ubuntu1 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需在蓝牙通信范围内，目标设备开启蓝牙且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许未经验证的攻击者通过伪装成蓝牙HID设备，在受害者设备上注入键盘输入。利用方式如下：

1.  攻击者使用特定的蓝牙HID设备（如伪造的键盘）发起连接。
2.  由于BlueZ在某些版本中未正确处理身份验证，攻击者可以绕过配对流程，建立加密连接。
3.  攻击者随后可以发送恶意HID报告，模拟键盘输入。
4.  通过模拟按键，攻击者可以执行任意命令，如打开终端、下载恶意软件等。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开可用的POC。因此，漏洞利用具有有效性。

**投毒风险评估：**

查看提供的漏洞利用代码（blueXploit），发现代码主要功能是利用CVE-2023-45866漏洞进行蓝牙HID注入攻击。代码包含自动生成payload并注入到APK的功能，存在一定的风险，但更多是利用msfvenom等工具生成payload, **所以判断投毒概率较低,大约为5%。**

**利用方式分析：**

blueXploit利用工具：

1.  **模拟HID设备：** 代码可能使用Linux的蓝牙工具（如`bluez-tools`）来模拟HID设备，使其能够发送键盘和鼠标事件。
2.  **绕过认证：** 漏洞的核心在于绕过蓝牙HID的认证机制。POC代码会尝试建立未认证的连接，或者利用已知的漏洞来欺骗目标设备。
3.  **Payload注入：** 成功建立连接后，POC代码会注入预先定义的payload，这些payload通常包含一系列键盘指令，用于在目标设备上执行命令。利用APK的组件，可能导致恶意软件安装或其他恶意行为。

**结论：**

CVE-2023-45866是一个严重的安全漏洞，允许未经授权的攻击者通过蓝牙注入键盘输入，从而控制受害者设备。提供的POC代码可以有效利用该漏洞。存在少许投毒风险但主要集中在自动化payload生成和注入方面，需要谨慎使用。攻击者需要具备一定的蓝牙协议和Linux系统知识才能成功利用该漏洞。

**项目地址:** [Danyw24/blueXploit](https://github.com/Danyw24/blueXploit)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #4

**来源**: [CVE-2023-45866-Eason-zz_BluetoothDucky.md](../2023/CVE-2023-45866-Eason-zz_BluetoothDucky.md)

## CVE-2023-45866-BlueZ-蓝牙HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，允许未授权的蓝牙HID设备注入键盘事件，可能导致任意命令执行

**影响版本:** 5.64-0ubuntu1 (Ubuntu 22.04LTS)等受影响版本

**利用条件:** 攻击者需要在蓝牙通信范围内，目标设备开启蓝牙功能且未采取CVE-2020-0556的缓解措施。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未认证的蓝牙外围设备 (Peripheral role HID Device) 发起并建立加密连接，并接收 HID 键盘报告。攻击者可以伪装成蓝牙键盘，在没有用户交互的情况下向主机注入 HID 消息，例如键盘按键，从而执行任意命令。 

**有效性评估：**
根据漏洞信息和搜索引擎结果，该漏洞利用的关键在于绕过蓝牙配对认证，从而模拟键盘输入。提供的Python脚本`BluetoothDucky.py`尝试自动化此过程。脚本通过以下步骤利用漏洞：

1.  **蓝牙适配器初始化：** 重启蓝牙服务，配置适配器名称和类别。
2.  **HID Profile注册：** 注册HID profile，使系统认为该设备是HID设备。
3.  **连接目标设备：** 尝试连接目标设备的SDP服务，并进行配对。
4.  **HID连接：** 连接HID中断和控制端口。
5.  **Payload执行：** 从指定文件读取Ducky脚本，并将其转换为HID键盘报告发送到目标设备。

根据搜索结果，该漏洞影响包括Android、iOS和Linux等多个平台。因此，如果脚本能够成功建立蓝牙连接并绕过认证，则漏洞利用应该是有效的。

**投毒风险分析：**
分析提供的Python脚本 `BluetoothDucky.py`，未发现明显的恶意代码或后门。脚本主要功能是模拟蓝牙键盘并发送预定义的按键序列。

以下是未发现明显投毒代码的理由：

*   脚本的主要功能是模拟键盘输入，逻辑清晰。
*   脚本依赖于标准的Python库和Linux工具 (例如 `bluetooth`, `hcitool`)。
*   脚本没有尝试访问本地文件系统、网络连接或执行其他可疑操作。
*   `injector` 目录下的文件需要进一步分析, 但当前的代码片段没有展示出恶意行为。

虽然没有发现明显的投毒代码，但仍存在以下潜在风险：

*   Ducky脚本本身可能包含恶意命令，例如下载和执行恶意软件。这取决于攻击者提供的payload。
*   脚本的依赖项 (例如 `injector` 目录下的模块) 可能包含漏洞或恶意代码。由于没有提供完整代码，无法进行全面分析。
*   脚本的实现可能存在缺陷，导致意外行为或安全问题。

综合考虑，投毒风险较低，但不能完全排除。给予10%的投毒风险评估。

**利用方式：**

1.  **扫描目标设备：** 使用蓝牙扫描工具 (例如 `bluetooth.discover_devices`) 查找附近的蓝牙设备。
2.  **配置攻击环境：** 安装必要的Python库 (例如 `pybluez`)，并确保蓝牙适配器正常工作。
3.  **运行攻击脚本：** 运行 `BluetoothDucky.py` 脚本，指定目标设备的蓝牙地址和用于攻击的蓝牙接口。
4.  **建立连接：** 脚本尝试与目标设备建立蓝牙连接，并绕过认证。
5.  **注入键盘事件：** 脚本将Ducky脚本转换为HID键盘报告，并发送到目标设备。

**总结：**
CVE-2023-45866是一个高危漏洞，攻击者可以通过模拟蓝牙键盘注入恶意键盘事件，从而控制目标设备。提供的POC代码具有一定的有效性，但需要进一步测试和验证。投毒风险较低，但不能完全排除。

**项目地址:** [Eason-zz/BluetoothDucky](https://github.com/Eason-zz/BluetoothDucky)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #5

**来源**: [CVE-2023-45866-cisnarfu_Bluepop.md](../2023/CVE-2023-45866-cisnarfu_Bluepop.md)

# CVE-2023-45866

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45866-AvishekDhakal_CVE-2023-45866_EXPLOITS.md](../2023/CVE-2023-45866-AvishekDhakal_CVE-2023-45866_EXPLOITS.md)

## CVE-2023-45866-BlueZ-蓝牙HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致键盘注入攻击，远程命令执行

**影响版本:** bluez <= 5.64 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需在蓝牙通信范围内，目标设备蓝牙开启且易受攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经验证的蓝牙HID外围设备发起和建立加密连接，并接受HID键盘报告，从而可能注入HID消息。攻击者可以伪装成蓝牙键盘，在目标设备未授权的情况下发送键盘输入，实现远程命令执行等恶意操作。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞允许攻击者在未经用户授权的情况下，通过蓝牙连接并模拟键盘输入，具有较高的利用价值。提供的POC代码似乎包含多种攻击场景，如暴力破解密码、相机劫持（camphish）、恶意APK下载和安装、文件上传以及发送WhatsApp消息。虽然具体效果取决于目标设备和配置，但整体来看，这些POC代码具备一定的有效性。

**投毒风险评估：**

提供的POC代码主要利用键盘输入模拟用户操作，实现特定功能。虽然这些功能本身可能被滥用，但代码本身并未发现明显的恶意后门或植入行为，判断该仓库的投毒风险为10%。

**利用方式分析：**

1.  **连接阶段绕过：** 漏洞核心在于绕过蓝牙HID连接时的身份验证或授权机制，允许攻击者控制的设备未经许可建立连接。
2.  **HID消息注入：** 成功建立连接后，攻击者可以发送任意HID消息，模拟键盘输入、鼠标点击等操作。
3.  **利用场景：**
    *   **密码暴力破解：** 通过模拟键盘输入，尝试不同的密码组合。
    *   **恶意链接打开：** 注入URL，诱导用户访问恶意网站，例如下载恶意APK。
    *   **摄像头劫持：** 通过注入特定URL，利用WebRTC等技术访问摄像头，拍摄照片。
    *   **文件上传：** 打开文件上传页面，模拟用户操作选择并上传文件。
    *   **发送消息：** 打开WhatsApp网页版，模拟用户输入并发送消息。
4.  **攻击流程示例（恶意APK安装）：**
    *   攻击者伪装成蓝牙键盘，连接目标设备。
    *   注入包含恶意APK下载链接的URL，打开浏览器。
    *   模拟键盘输入，点击下载按钮。
    *   模拟键盘输入，允许安装未知来源应用。
    *   模拟键盘输入，完成APK安装。

**优先级：**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

**项目地址:** [AvishekDhakal/CVE-2023-45866_EXPLOITS](https://github.com/AvishekDhakal/CVE-2023-45866_EXPLOITS)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #2

**来源**: [CVE-2023-45866-Chedrian07_CVE-2023-45866-POC.md](../2023/CVE-2023-45866-Chedrian07_CVE-2023-45866-POC.md)

## CVE-2023-45866 BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.64 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需要在目标设备蓝牙范围内，且目标设备未进行必要的身份验证或配对。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙外围设备模拟HID设备（例如键盘），并向主机系统注入恶意输入。该漏洞存在于BlueZ蓝牙协议栈中，攻击者可以绕过身份验证，建立加密连接，并发送HID报告，从而模拟键盘输入，执行任意命令。

**有效性分析：**
根据漏洞信息，搜索引擎结果以及提供的POC代码，可以判定该漏洞是有效的。POC代码是一个Python脚本，它模拟了一个蓝牙键盘，并尝试连接到目标设备并发送按键输入。脚本中实现了HID报告的构造和发送，以及DuckyScript的解析功能，可以执行预定义的恶意payload。

**投毒风险分析：**
虽然脚本本身旨在利用该漏洞，但其中可能存在一些潜在的投毒风险。例如，脚本可能包含：
1.  **恶意Payload：** DuckyScript部分，攻击者可能将脚本配置为执行破坏性的命令，例如删除文件、安装恶意软件或窃取敏感数据。
2.  **后门功能：** 脚本可能包含额外的代码，用于在目标系统上安装后门，允许攻击者在以后重新访问该系统。
3.  **信息收集：** 脚本可以收集有关目标系统的信息，例如操作系统版本、已安装的软件或网络配置，并将这些信息发送给攻击者。

对代码进行分析后，发现代码的功能主要集中在模拟蓝牙键盘和发送预定义的按键序列。但是，`process_duckyscript` 函数允许执行任意的DuckyScript命令，这本身就具有潜在的风险。因此投毒风险定为10%,主要集中在DuckyScript的 payload 部分。

**利用方式：**
1.  **准备：** 攻击者需要一台配备蓝牙功能的设备，并安装必要的软件库（例如Python的`bluetooth`库）。
2.  **扫描：** 使用蓝牙扫描工具查找附近易受攻击的设备。
3.  **连接：** 使用POC代码中提供的蓝牙地址连接到目标设备。
4.  **注入：** 通过发送HID报告模拟键盘输入，执行恶意命令。

总而言之，CVE-2023-45866是一个严重的安全漏洞，攻击者可以利用它来远程控制受影响的设备。用户应及时更新BlueZ版本，或者禁用蓝牙功能来防范攻击。

**项目地址:** [Chedrian07/CVE-2023-45866-POC](https://github.com/Chedrian07/CVE-2023-45866-POC)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #3

**来源**: [CVE-2023-45866-Danyw24_blueXploit.md](../2023/CVE-2023-45866-Danyw24_blueXploit.md)

## CVE-2023-45866 - BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** bluez 5.64-0ubuntu1 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需在蓝牙通信范围内，目标设备开启蓝牙且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许未经验证的攻击者通过伪装成蓝牙HID设备，在受害者设备上注入键盘输入。利用方式如下：

1.  攻击者使用特定的蓝牙HID设备（如伪造的键盘）发起连接。
2.  由于BlueZ在某些版本中未正确处理身份验证，攻击者可以绕过配对流程，建立加密连接。
3.  攻击者随后可以发送恶意HID报告，模拟键盘输入。
4.  通过模拟按键，攻击者可以执行任意命令，如打开终端、下载恶意软件等。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开可用的POC。因此，漏洞利用具有有效性。

**投毒风险评估：**

查看提供的漏洞利用代码（blueXploit），发现代码主要功能是利用CVE-2023-45866漏洞进行蓝牙HID注入攻击。代码包含自动生成payload并注入到APK的功能，存在一定的风险，但更多是利用msfvenom等工具生成payload, **所以判断投毒概率较低,大约为5%。**

**利用方式分析：**

blueXploit利用工具：

1.  **模拟HID设备：** 代码可能使用Linux的蓝牙工具（如`bluez-tools`）来模拟HID设备，使其能够发送键盘和鼠标事件。
2.  **绕过认证：** 漏洞的核心在于绕过蓝牙HID的认证机制。POC代码会尝试建立未认证的连接，或者利用已知的漏洞来欺骗目标设备。
3.  **Payload注入：** 成功建立连接后，POC代码会注入预先定义的payload，这些payload通常包含一系列键盘指令，用于在目标设备上执行命令。利用APK的组件，可能导致恶意软件安装或其他恶意行为。

**结论：**

CVE-2023-45866是一个严重的安全漏洞，允许未经授权的攻击者通过蓝牙注入键盘输入，从而控制受害者设备。提供的POC代码可以有效利用该漏洞。存在少许投毒风险但主要集中在自动化payload生成和注入方面，需要谨慎使用。攻击者需要具备一定的蓝牙协议和Linux系统知识才能成功利用该漏洞。

**项目地址:** [Danyw24/blueXploit](https://github.com/Danyw24/blueXploit)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #4

**来源**: [CVE-2023-45866-Eason-zz_BluetoothDucky.md](../2023/CVE-2023-45866-Eason-zz_BluetoothDucky.md)

## CVE-2023-45866-BlueZ-蓝牙HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，允许未授权的蓝牙HID设备注入键盘事件，可能导致任意命令执行

**影响版本:** 5.64-0ubuntu1 (Ubuntu 22.04LTS)等受影响版本

**利用条件:** 攻击者需要在蓝牙通信范围内，目标设备开启蓝牙功能且未采取CVE-2020-0556的缓解措施。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未认证的蓝牙外围设备 (Peripheral role HID Device) 发起并建立加密连接，并接收 HID 键盘报告。攻击者可以伪装成蓝牙键盘，在没有用户交互的情况下向主机注入 HID 消息，例如键盘按键，从而执行任意命令。 

**有效性评估：**
根据漏洞信息和搜索引擎结果，该漏洞利用的关键在于绕过蓝牙配对认证，从而模拟键盘输入。提供的Python脚本`BluetoothDucky.py`尝试自动化此过程。脚本通过以下步骤利用漏洞：

1.  **蓝牙适配器初始化：** 重启蓝牙服务，配置适配器名称和类别。
2.  **HID Profile注册：** 注册HID profile，使系统认为该设备是HID设备。
3.  **连接目标设备：** 尝试连接目标设备的SDP服务，并进行配对。
4.  **HID连接：** 连接HID中断和控制端口。
5.  **Payload执行：** 从指定文件读取Ducky脚本，并将其转换为HID键盘报告发送到目标设备。

根据搜索结果，该漏洞影响包括Android、iOS和Linux等多个平台。因此，如果脚本能够成功建立蓝牙连接并绕过认证，则漏洞利用应该是有效的。

**投毒风险分析：**
分析提供的Python脚本 `BluetoothDucky.py`，未发现明显的恶意代码或后门。脚本主要功能是模拟蓝牙键盘并发送预定义的按键序列。

以下是未发现明显投毒代码的理由：

*   脚本的主要功能是模拟键盘输入，逻辑清晰。
*   脚本依赖于标准的Python库和Linux工具 (例如 `bluetooth`, `hcitool`)。
*   脚本没有尝试访问本地文件系统、网络连接或执行其他可疑操作。
*   `injector` 目录下的文件需要进一步分析, 但当前的代码片段没有展示出恶意行为。

虽然没有发现明显的投毒代码，但仍存在以下潜在风险：

*   Ducky脚本本身可能包含恶意命令，例如下载和执行恶意软件。这取决于攻击者提供的payload。
*   脚本的依赖项 (例如 `injector` 目录下的模块) 可能包含漏洞或恶意代码。由于没有提供完整代码，无法进行全面分析。
*   脚本的实现可能存在缺陷，导致意外行为或安全问题。

综合考虑，投毒风险较低，但不能完全排除。给予10%的投毒风险评估。

**利用方式：**

1.  **扫描目标设备：** 使用蓝牙扫描工具 (例如 `bluetooth.discover_devices`) 查找附近的蓝牙设备。
2.  **配置攻击环境：** 安装必要的Python库 (例如 `pybluez`)，并确保蓝牙适配器正常工作。
3.  **运行攻击脚本：** 运行 `BluetoothDucky.py` 脚本，指定目标设备的蓝牙地址和用于攻击的蓝牙接口。
4.  **建立连接：** 脚本尝试与目标设备建立蓝牙连接，并绕过认证。
5.  **注入键盘事件：** 脚本将Ducky脚本转换为HID键盘报告，并发送到目标设备。

**总结：**
CVE-2023-45866是一个高危漏洞，攻击者可以通过模拟蓝牙键盘注入恶意键盘事件，从而控制目标设备。提供的POC代码具有一定的有效性，但需要进一步测试和验证。投毒风险较低，但不能完全排除。

**项目地址:** [Eason-zz/BluetoothDucky](https://github.com/Eason-zz/BluetoothDucky)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #5

**来源**: [CVE-2023-45866-cisnarfu_Bluepop.md](../2023/CVE-2023-45866-cisnarfu_Bluepop.md)

# CVE-2023-45866

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45866-AvishekDhakal_CVE-2023-45866_EXPLOITS.md](../2023/CVE-2023-45866-AvishekDhakal_CVE-2023-45866_EXPLOITS.md)

## CVE-2023-45866-BlueZ-蓝牙HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致键盘注入攻击，远程命令执行

**影响版本:** bluez <= 5.64 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需在蓝牙通信范围内，目标设备蓝牙开启且易受攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经验证的蓝牙HID外围设备发起和建立加密连接，并接受HID键盘报告，从而可能注入HID消息。攻击者可以伪装成蓝牙键盘，在目标设备未授权的情况下发送键盘输入，实现远程命令执行等恶意操作。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞允许攻击者在未经用户授权的情况下，通过蓝牙连接并模拟键盘输入，具有较高的利用价值。提供的POC代码似乎包含多种攻击场景，如暴力破解密码、相机劫持（camphish）、恶意APK下载和安装、文件上传以及发送WhatsApp消息。虽然具体效果取决于目标设备和配置，但整体来看，这些POC代码具备一定的有效性。

**投毒风险评估：**

提供的POC代码主要利用键盘输入模拟用户操作，实现特定功能。虽然这些功能本身可能被滥用，但代码本身并未发现明显的恶意后门或植入行为，判断该仓库的投毒风险为10%。

**利用方式分析：**

1.  **连接阶段绕过：** 漏洞核心在于绕过蓝牙HID连接时的身份验证或授权机制，允许攻击者控制的设备未经许可建立连接。
2.  **HID消息注入：** 成功建立连接后，攻击者可以发送任意HID消息，模拟键盘输入、鼠标点击等操作。
3.  **利用场景：**
    *   **密码暴力破解：** 通过模拟键盘输入，尝试不同的密码组合。
    *   **恶意链接打开：** 注入URL，诱导用户访问恶意网站，例如下载恶意APK。
    *   **摄像头劫持：** 通过注入特定URL，利用WebRTC等技术访问摄像头，拍摄照片。
    *   **文件上传：** 打开文件上传页面，模拟用户操作选择并上传文件。
    *   **发送消息：** 打开WhatsApp网页版，模拟用户输入并发送消息。
4.  **攻击流程示例（恶意APK安装）：**
    *   攻击者伪装成蓝牙键盘，连接目标设备。
    *   注入包含恶意APK下载链接的URL，打开浏览器。
    *   模拟键盘输入，点击下载按钮。
    *   模拟键盘输入，允许安装未知来源应用。
    *   模拟键盘输入，完成APK安装。

**优先级：**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

**项目地址:** [AvishekDhakal/CVE-2023-45866_EXPLOITS](https://github.com/AvishekDhakal/CVE-2023-45866_EXPLOITS)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #2

**来源**: [CVE-2023-45866-Chedrian07_CVE-2023-45866-POC.md](../2023/CVE-2023-45866-Chedrian07_CVE-2023-45866-POC.md)

## CVE-2023-45866 BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.64 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需要在目标设备蓝牙范围内，且目标设备未进行必要的身份验证或配对。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙外围设备模拟HID设备（例如键盘），并向主机系统注入恶意输入。该漏洞存在于BlueZ蓝牙协议栈中，攻击者可以绕过身份验证，建立加密连接，并发送HID报告，从而模拟键盘输入，执行任意命令。

**有效性分析：**
根据漏洞信息，搜索引擎结果以及提供的POC代码，可以判定该漏洞是有效的。POC代码是一个Python脚本，它模拟了一个蓝牙键盘，并尝试连接到目标设备并发送按键输入。脚本中实现了HID报告的构造和发送，以及DuckyScript的解析功能，可以执行预定义的恶意payload。

**投毒风险分析：**
虽然脚本本身旨在利用该漏洞，但其中可能存在一些潜在的投毒风险。例如，脚本可能包含：
1.  **恶意Payload：** DuckyScript部分，攻击者可能将脚本配置为执行破坏性的命令，例如删除文件、安装恶意软件或窃取敏感数据。
2.  **后门功能：** 脚本可能包含额外的代码，用于在目标系统上安装后门，允许攻击者在以后重新访问该系统。
3.  **信息收集：** 脚本可以收集有关目标系统的信息，例如操作系统版本、已安装的软件或网络配置，并将这些信息发送给攻击者。

对代码进行分析后，发现代码的功能主要集中在模拟蓝牙键盘和发送预定义的按键序列。但是，`process_duckyscript` 函数允许执行任意的DuckyScript命令，这本身就具有潜在的风险。因此投毒风险定为10%,主要集中在DuckyScript的 payload 部分。

**利用方式：**
1.  **准备：** 攻击者需要一台配备蓝牙功能的设备，并安装必要的软件库（例如Python的`bluetooth`库）。
2.  **扫描：** 使用蓝牙扫描工具查找附近易受攻击的设备。
3.  **连接：** 使用POC代码中提供的蓝牙地址连接到目标设备。
4.  **注入：** 通过发送HID报告模拟键盘输入，执行恶意命令。

总而言之，CVE-2023-45866是一个严重的安全漏洞，攻击者可以利用它来远程控制受影响的设备。用户应及时更新BlueZ版本，或者禁用蓝牙功能来防范攻击。

**项目地址:** [Chedrian07/CVE-2023-45866-POC](https://github.com/Chedrian07/CVE-2023-45866-POC)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #3

**来源**: [CVE-2023-45866-Danyw24_blueXploit.md](../2023/CVE-2023-45866-Danyw24_blueXploit.md)

## CVE-2023-45866 - BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** bluez 5.64-0ubuntu1 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需在蓝牙通信范围内，目标设备开启蓝牙且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许未经验证的攻击者通过伪装成蓝牙HID设备，在受害者设备上注入键盘输入。利用方式如下：

1.  攻击者使用特定的蓝牙HID设备（如伪造的键盘）发起连接。
2.  由于BlueZ在某些版本中未正确处理身份验证，攻击者可以绕过配对流程，建立加密连接。
3.  攻击者随后可以发送恶意HID报告，模拟键盘输入。
4.  通过模拟按键，攻击者可以执行任意命令，如打开终端、下载恶意软件等。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开可用的POC。因此，漏洞利用具有有效性。

**投毒风险评估：**

查看提供的漏洞利用代码（blueXploit），发现代码主要功能是利用CVE-2023-45866漏洞进行蓝牙HID注入攻击。代码包含自动生成payload并注入到APK的功能，存在一定的风险，但更多是利用msfvenom等工具生成payload, **所以判断投毒概率较低,大约为5%。**

**利用方式分析：**

blueXploit利用工具：

1.  **模拟HID设备：** 代码可能使用Linux的蓝牙工具（如`bluez-tools`）来模拟HID设备，使其能够发送键盘和鼠标事件。
2.  **绕过认证：** 漏洞的核心在于绕过蓝牙HID的认证机制。POC代码会尝试建立未认证的连接，或者利用已知的漏洞来欺骗目标设备。
3.  **Payload注入：** 成功建立连接后，POC代码会注入预先定义的payload，这些payload通常包含一系列键盘指令，用于在目标设备上执行命令。利用APK的组件，可能导致恶意软件安装或其他恶意行为。

**结论：**

CVE-2023-45866是一个严重的安全漏洞，允许未经授权的攻击者通过蓝牙注入键盘输入，从而控制受害者设备。提供的POC代码可以有效利用该漏洞。存在少许投毒风险但主要集中在自动化payload生成和注入方面，需要谨慎使用。攻击者需要具备一定的蓝牙协议和Linux系统知识才能成功利用该漏洞。

**项目地址:** [Danyw24/blueXploit](https://github.com/Danyw24/blueXploit)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #4

**来源**: [CVE-2023-45866-Eason-zz_BluetoothDucky.md](../2023/CVE-2023-45866-Eason-zz_BluetoothDucky.md)

## CVE-2023-45866-BlueZ-蓝牙HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，允许未授权的蓝牙HID设备注入键盘事件，可能导致任意命令执行

**影响版本:** 5.64-0ubuntu1 (Ubuntu 22.04LTS)等受影响版本

**利用条件:** 攻击者需要在蓝牙通信范围内，目标设备开启蓝牙功能且未采取CVE-2020-0556的缓解措施。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未认证的蓝牙外围设备 (Peripheral role HID Device) 发起并建立加密连接，并接收 HID 键盘报告。攻击者可以伪装成蓝牙键盘，在没有用户交互的情况下向主机注入 HID 消息，例如键盘按键，从而执行任意命令。 

**有效性评估：**
根据漏洞信息和搜索引擎结果，该漏洞利用的关键在于绕过蓝牙配对认证，从而模拟键盘输入。提供的Python脚本`BluetoothDucky.py`尝试自动化此过程。脚本通过以下步骤利用漏洞：

1.  **蓝牙适配器初始化：** 重启蓝牙服务，配置适配器名称和类别。
2.  **HID Profile注册：** 注册HID profile，使系统认为该设备是HID设备。
3.  **连接目标设备：** 尝试连接目标设备的SDP服务，并进行配对。
4.  **HID连接：** 连接HID中断和控制端口。
5.  **Payload执行：** 从指定文件读取Ducky脚本，并将其转换为HID键盘报告发送到目标设备。

根据搜索结果，该漏洞影响包括Android、iOS和Linux等多个平台。因此，如果脚本能够成功建立蓝牙连接并绕过认证，则漏洞利用应该是有效的。

**投毒风险分析：**
分析提供的Python脚本 `BluetoothDucky.py`，未发现明显的恶意代码或后门。脚本主要功能是模拟蓝牙键盘并发送预定义的按键序列。

以下是未发现明显投毒代码的理由：

*   脚本的主要功能是模拟键盘输入，逻辑清晰。
*   脚本依赖于标准的Python库和Linux工具 (例如 `bluetooth`, `hcitool`)。
*   脚本没有尝试访问本地文件系统、网络连接或执行其他可疑操作。
*   `injector` 目录下的文件需要进一步分析, 但当前的代码片段没有展示出恶意行为。

虽然没有发现明显的投毒代码，但仍存在以下潜在风险：

*   Ducky脚本本身可能包含恶意命令，例如下载和执行恶意软件。这取决于攻击者提供的payload。
*   脚本的依赖项 (例如 `injector` 目录下的模块) 可能包含漏洞或恶意代码。由于没有提供完整代码，无法进行全面分析。
*   脚本的实现可能存在缺陷，导致意外行为或安全问题。

综合考虑，投毒风险较低，但不能完全排除。给予10%的投毒风险评估。

**利用方式：**

1.  **扫描目标设备：** 使用蓝牙扫描工具 (例如 `bluetooth.discover_devices`) 查找附近的蓝牙设备。
2.  **配置攻击环境：** 安装必要的Python库 (例如 `pybluez`)，并确保蓝牙适配器正常工作。
3.  **运行攻击脚本：** 运行 `BluetoothDucky.py` 脚本，指定目标设备的蓝牙地址和用于攻击的蓝牙接口。
4.  **建立连接：** 脚本尝试与目标设备建立蓝牙连接，并绕过认证。
5.  **注入键盘事件：** 脚本将Ducky脚本转换为HID键盘报告，并发送到目标设备。

**总结：**
CVE-2023-45866是一个高危漏洞，攻击者可以通过模拟蓝牙键盘注入恶意键盘事件，从而控制目标设备。提供的POC代码具有一定的有效性，但需要进一步测试和验证。投毒风险较低，但不能完全排除。

**项目地址:** [Eason-zz/BluetoothDucky](https://github.com/Eason-zz/BluetoothDucky)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #5

**来源**: [CVE-2023-45866-cisnarfu_Bluepop.md](../2023/CVE-2023-45866-cisnarfu_Bluepop.md)

# CVE-2023-45866

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45866-AvishekDhakal_CVE-2023-45866_EXPLOITS.md](../2023/CVE-2023-45866-AvishekDhakal_CVE-2023-45866_EXPLOITS.md)

## CVE-2023-45866-BlueZ-蓝牙HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致键盘注入攻击，远程命令执行

**影响版本:** bluez <= 5.64 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需在蓝牙通信范围内，目标设备蓝牙开启且易受攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经验证的蓝牙HID外围设备发起和建立加密连接，并接受HID键盘报告，从而可能注入HID消息。攻击者可以伪装成蓝牙键盘，在目标设备未授权的情况下发送键盘输入，实现远程命令执行等恶意操作。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞允许攻击者在未经用户授权的情况下，通过蓝牙连接并模拟键盘输入，具有较高的利用价值。提供的POC代码似乎包含多种攻击场景，如暴力破解密码、相机劫持（camphish）、恶意APK下载和安装、文件上传以及发送WhatsApp消息。虽然具体效果取决于目标设备和配置，但整体来看，这些POC代码具备一定的有效性。

**投毒风险评估：**

提供的POC代码主要利用键盘输入模拟用户操作，实现特定功能。虽然这些功能本身可能被滥用，但代码本身并未发现明显的恶意后门或植入行为，判断该仓库的投毒风险为10%。

**利用方式分析：**

1.  **连接阶段绕过：** 漏洞核心在于绕过蓝牙HID连接时的身份验证或授权机制，允许攻击者控制的设备未经许可建立连接。
2.  **HID消息注入：** 成功建立连接后，攻击者可以发送任意HID消息，模拟键盘输入、鼠标点击等操作。
3.  **利用场景：**
    *   **密码暴力破解：** 通过模拟键盘输入，尝试不同的密码组合。
    *   **恶意链接打开：** 注入URL，诱导用户访问恶意网站，例如下载恶意APK。
    *   **摄像头劫持：** 通过注入特定URL，利用WebRTC等技术访问摄像头，拍摄照片。
    *   **文件上传：** 打开文件上传页面，模拟用户操作选择并上传文件。
    *   **发送消息：** 打开WhatsApp网页版，模拟用户输入并发送消息。
4.  **攻击流程示例（恶意APK安装）：**
    *   攻击者伪装成蓝牙键盘，连接目标设备。
    *   注入包含恶意APK下载链接的URL，打开浏览器。
    *   模拟键盘输入，点击下载按钮。
    *   模拟键盘输入，允许安装未知来源应用。
    *   模拟键盘输入，完成APK安装。

**优先级：**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

**项目地址:** [AvishekDhakal/CVE-2023-45866_EXPLOITS](https://github.com/AvishekDhakal/CVE-2023-45866_EXPLOITS)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #2

**来源**: [CVE-2023-45866-Chedrian07_CVE-2023-45866-POC.md](../2023/CVE-2023-45866-Chedrian07_CVE-2023-45866-POC.md)

## CVE-2023-45866 BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.64 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需要在目标设备蓝牙范围内，且目标设备未进行必要的身份验证或配对。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙外围设备模拟HID设备（例如键盘），并向主机系统注入恶意输入。该漏洞存在于BlueZ蓝牙协议栈中，攻击者可以绕过身份验证，建立加密连接，并发送HID报告，从而模拟键盘输入，执行任意命令。

**有效性分析：**
根据漏洞信息，搜索引擎结果以及提供的POC代码，可以判定该漏洞是有效的。POC代码是一个Python脚本，它模拟了一个蓝牙键盘，并尝试连接到目标设备并发送按键输入。脚本中实现了HID报告的构造和发送，以及DuckyScript的解析功能，可以执行预定义的恶意payload。

**投毒风险分析：**
虽然脚本本身旨在利用该漏洞，但其中可能存在一些潜在的投毒风险。例如，脚本可能包含：
1.  **恶意Payload：** DuckyScript部分，攻击者可能将脚本配置为执行破坏性的命令，例如删除文件、安装恶意软件或窃取敏感数据。
2.  **后门功能：** 脚本可能包含额外的代码，用于在目标系统上安装后门，允许攻击者在以后重新访问该系统。
3.  **信息收集：** 脚本可以收集有关目标系统的信息，例如操作系统版本、已安装的软件或网络配置，并将这些信息发送给攻击者。

对代码进行分析后，发现代码的功能主要集中在模拟蓝牙键盘和发送预定义的按键序列。但是，`process_duckyscript` 函数允许执行任意的DuckyScript命令，这本身就具有潜在的风险。因此投毒风险定为10%,主要集中在DuckyScript的 payload 部分。

**利用方式：**
1.  **准备：** 攻击者需要一台配备蓝牙功能的设备，并安装必要的软件库（例如Python的`bluetooth`库）。
2.  **扫描：** 使用蓝牙扫描工具查找附近易受攻击的设备。
3.  **连接：** 使用POC代码中提供的蓝牙地址连接到目标设备。
4.  **注入：** 通过发送HID报告模拟键盘输入，执行恶意命令。

总而言之，CVE-2023-45866是一个严重的安全漏洞，攻击者可以利用它来远程控制受影响的设备。用户应及时更新BlueZ版本，或者禁用蓝牙功能来防范攻击。

**项目地址:** [Chedrian07/CVE-2023-45866-POC](https://github.com/Chedrian07/CVE-2023-45866-POC)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #3

**来源**: [CVE-2023-45866-Danyw24_blueXploit.md](../2023/CVE-2023-45866-Danyw24_blueXploit.md)

## CVE-2023-45866 - BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** bluez 5.64-0ubuntu1 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需在蓝牙通信范围内，目标设备开启蓝牙且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许未经验证的攻击者通过伪装成蓝牙HID设备，在受害者设备上注入键盘输入。利用方式如下：

1.  攻击者使用特定的蓝牙HID设备（如伪造的键盘）发起连接。
2.  由于BlueZ在某些版本中未正确处理身份验证，攻击者可以绕过配对流程，建立加密连接。
3.  攻击者随后可以发送恶意HID报告，模拟键盘输入。
4.  通过模拟按键，攻击者可以执行任意命令，如打开终端、下载恶意软件等。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开可用的POC。因此，漏洞利用具有有效性。

**投毒风险评估：**

查看提供的漏洞利用代码（blueXploit），发现代码主要功能是利用CVE-2023-45866漏洞进行蓝牙HID注入攻击。代码包含自动生成payload并注入到APK的功能，存在一定的风险，但更多是利用msfvenom等工具生成payload, **所以判断投毒概率较低,大约为5%。**

**利用方式分析：**

blueXploit利用工具：

1.  **模拟HID设备：** 代码可能使用Linux的蓝牙工具（如`bluez-tools`）来模拟HID设备，使其能够发送键盘和鼠标事件。
2.  **绕过认证：** 漏洞的核心在于绕过蓝牙HID的认证机制。POC代码会尝试建立未认证的连接，或者利用已知的漏洞来欺骗目标设备。
3.  **Payload注入：** 成功建立连接后，POC代码会注入预先定义的payload，这些payload通常包含一系列键盘指令，用于在目标设备上执行命令。利用APK的组件，可能导致恶意软件安装或其他恶意行为。

**结论：**

CVE-2023-45866是一个严重的安全漏洞，允许未经授权的攻击者通过蓝牙注入键盘输入，从而控制受害者设备。提供的POC代码可以有效利用该漏洞。存在少许投毒风险但主要集中在自动化payload生成和注入方面，需要谨慎使用。攻击者需要具备一定的蓝牙协议和Linux系统知识才能成功利用该漏洞。

**项目地址:** [Danyw24/blueXploit](https://github.com/Danyw24/blueXploit)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #4

**来源**: [CVE-2023-45866-Eason-zz_BluetoothDucky.md](../2023/CVE-2023-45866-Eason-zz_BluetoothDucky.md)

## CVE-2023-45866-BlueZ-蓝牙HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，允许未授权的蓝牙HID设备注入键盘事件，可能导致任意命令执行

**影响版本:** 5.64-0ubuntu1 (Ubuntu 22.04LTS)等受影响版本

**利用条件:** 攻击者需要在蓝牙通信范围内，目标设备开启蓝牙功能且未采取CVE-2020-0556的缓解措施。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未认证的蓝牙外围设备 (Peripheral role HID Device) 发起并建立加密连接，并接收 HID 键盘报告。攻击者可以伪装成蓝牙键盘，在没有用户交互的情况下向主机注入 HID 消息，例如键盘按键，从而执行任意命令。 

**有效性评估：**
根据漏洞信息和搜索引擎结果，该漏洞利用的关键在于绕过蓝牙配对认证，从而模拟键盘输入。提供的Python脚本`BluetoothDucky.py`尝试自动化此过程。脚本通过以下步骤利用漏洞：

1.  **蓝牙适配器初始化：** 重启蓝牙服务，配置适配器名称和类别。
2.  **HID Profile注册：** 注册HID profile，使系统认为该设备是HID设备。
3.  **连接目标设备：** 尝试连接目标设备的SDP服务，并进行配对。
4.  **HID连接：** 连接HID中断和控制端口。
5.  **Payload执行：** 从指定文件读取Ducky脚本，并将其转换为HID键盘报告发送到目标设备。

根据搜索结果，该漏洞影响包括Android、iOS和Linux等多个平台。因此，如果脚本能够成功建立蓝牙连接并绕过认证，则漏洞利用应该是有效的。

**投毒风险分析：**
分析提供的Python脚本 `BluetoothDucky.py`，未发现明显的恶意代码或后门。脚本主要功能是模拟蓝牙键盘并发送预定义的按键序列。

以下是未发现明显投毒代码的理由：

*   脚本的主要功能是模拟键盘输入，逻辑清晰。
*   脚本依赖于标准的Python库和Linux工具 (例如 `bluetooth`, `hcitool`)。
*   脚本没有尝试访问本地文件系统、网络连接或执行其他可疑操作。
*   `injector` 目录下的文件需要进一步分析, 但当前的代码片段没有展示出恶意行为。

虽然没有发现明显的投毒代码，但仍存在以下潜在风险：

*   Ducky脚本本身可能包含恶意命令，例如下载和执行恶意软件。这取决于攻击者提供的payload。
*   脚本的依赖项 (例如 `injector` 目录下的模块) 可能包含漏洞或恶意代码。由于没有提供完整代码，无法进行全面分析。
*   脚本的实现可能存在缺陷，导致意外行为或安全问题。

综合考虑，投毒风险较低，但不能完全排除。给予10%的投毒风险评估。

**利用方式：**

1.  **扫描目标设备：** 使用蓝牙扫描工具 (例如 `bluetooth.discover_devices`) 查找附近的蓝牙设备。
2.  **配置攻击环境：** 安装必要的Python库 (例如 `pybluez`)，并确保蓝牙适配器正常工作。
3.  **运行攻击脚本：** 运行 `BluetoothDucky.py` 脚本，指定目标设备的蓝牙地址和用于攻击的蓝牙接口。
4.  **建立连接：** 脚本尝试与目标设备建立蓝牙连接，并绕过认证。
5.  **注入键盘事件：** 脚本将Ducky脚本转换为HID键盘报告，并发送到目标设备。

**总结：**
CVE-2023-45866是一个高危漏洞，攻击者可以通过模拟蓝牙键盘注入恶意键盘事件，从而控制目标设备。提供的POC代码具有一定的有效性，但需要进一步测试和验证。投毒风险较低，但不能完全排除。

**项目地址:** [Eason-zz/BluetoothDucky](https://github.com/Eason-zz/BluetoothDucky)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #5

**来源**: [CVE-2023-45866-cisnarfu_Bluepop.md](../2023/CVE-2023-45866-cisnarfu_Bluepop.md)

# CVE-2023-45866

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-45866-AvishekDhakal_CVE-2023-45866_EXPLOITS.md](../2023/CVE-2023-45866-AvishekDhakal_CVE-2023-45866_EXPLOITS.md)

## CVE-2023-45866-BlueZ-蓝牙HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致键盘注入攻击，远程命令执行

**影响版本:** bluez <= 5.64 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需在蓝牙通信范围内，目标设备蓝牙开启且易受攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经验证的蓝牙HID外围设备发起和建立加密连接，并接受HID键盘报告，从而可能注入HID消息。攻击者可以伪装成蓝牙键盘，在目标设备未授权的情况下发送键盘输入，实现远程命令执行等恶意操作。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞允许攻击者在未经用户授权的情况下，通过蓝牙连接并模拟键盘输入，具有较高的利用价值。提供的POC代码似乎包含多种攻击场景，如暴力破解密码、相机劫持（camphish）、恶意APK下载和安装、文件上传以及发送WhatsApp消息。虽然具体效果取决于目标设备和配置，但整体来看，这些POC代码具备一定的有效性。

**投毒风险评估：**

提供的POC代码主要利用键盘输入模拟用户操作，实现特定功能。虽然这些功能本身可能被滥用，但代码本身并未发现明显的恶意后门或植入行为，判断该仓库的投毒风险为10%。

**利用方式分析：**

1.  **连接阶段绕过：** 漏洞核心在于绕过蓝牙HID连接时的身份验证或授权机制，允许攻击者控制的设备未经许可建立连接。
2.  **HID消息注入：** 成功建立连接后，攻击者可以发送任意HID消息，模拟键盘输入、鼠标点击等操作。
3.  **利用场景：**
    *   **密码暴力破解：** 通过模拟键盘输入，尝试不同的密码组合。
    *   **恶意链接打开：** 注入URL，诱导用户访问恶意网站，例如下载恶意APK。
    *   **摄像头劫持：** 通过注入特定URL，利用WebRTC等技术访问摄像头，拍摄照片。
    *   **文件上传：** 打开文件上传页面，模拟用户操作选择并上传文件。
    *   **发送消息：** 打开WhatsApp网页版，模拟用户输入并发送消息。
4.  **攻击流程示例（恶意APK安装）：**
    *   攻击者伪装成蓝牙键盘，连接目标设备。
    *   注入包含恶意APK下载链接的URL，打开浏览器。
    *   模拟键盘输入，点击下载按钮。
    *   模拟键盘输入，允许安装未知来源应用。
    *   模拟键盘输入，完成APK安装。

**优先级：**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

**项目地址:** [AvishekDhakal/CVE-2023-45866_EXPLOITS](https://github.com/AvishekDhakal/CVE-2023-45866_EXPLOITS)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #2

**来源**: [CVE-2023-45866-Chedrian07_CVE-2023-45866-POC.md](../2023/CVE-2023-45866-Chedrian07_CVE-2023-45866-POC.md)

## CVE-2023-45866 BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.64 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需要在目标设备蓝牙范围内，且目标设备未进行必要的身份验证或配对。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙外围设备模拟HID设备（例如键盘），并向主机系统注入恶意输入。该漏洞存在于BlueZ蓝牙协议栈中，攻击者可以绕过身份验证，建立加密连接，并发送HID报告，从而模拟键盘输入，执行任意命令。

**有效性分析：**
根据漏洞信息，搜索引擎结果以及提供的POC代码，可以判定该漏洞是有效的。POC代码是一个Python脚本，它模拟了一个蓝牙键盘，并尝试连接到目标设备并发送按键输入。脚本中实现了HID报告的构造和发送，以及DuckyScript的解析功能，可以执行预定义的恶意payload。

**投毒风险分析：**
虽然脚本本身旨在利用该漏洞，但其中可能存在一些潜在的投毒风险。例如，脚本可能包含：
1.  **恶意Payload：** DuckyScript部分，攻击者可能将脚本配置为执行破坏性的命令，例如删除文件、安装恶意软件或窃取敏感数据。
2.  **后门功能：** 脚本可能包含额外的代码，用于在目标系统上安装后门，允许攻击者在以后重新访问该系统。
3.  **信息收集：** 脚本可以收集有关目标系统的信息，例如操作系统版本、已安装的软件或网络配置，并将这些信息发送给攻击者。

对代码进行分析后，发现代码的功能主要集中在模拟蓝牙键盘和发送预定义的按键序列。但是，`process_duckyscript` 函数允许执行任意的DuckyScript命令，这本身就具有潜在的风险。因此投毒风险定为10%,主要集中在DuckyScript的 payload 部分。

**利用方式：**
1.  **准备：** 攻击者需要一台配备蓝牙功能的设备，并安装必要的软件库（例如Python的`bluetooth`库）。
2.  **扫描：** 使用蓝牙扫描工具查找附近易受攻击的设备。
3.  **连接：** 使用POC代码中提供的蓝牙地址连接到目标设备。
4.  **注入：** 通过发送HID报告模拟键盘输入，执行恶意命令。

总而言之，CVE-2023-45866是一个严重的安全漏洞，攻击者可以利用它来远程控制受影响的设备。用户应及时更新BlueZ版本，或者禁用蓝牙功能来防范攻击。

**项目地址:** [Chedrian07/CVE-2023-45866-POC](https://github.com/Chedrian07/CVE-2023-45866-POC)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #3

**来源**: [CVE-2023-45866-Danyw24_blueXploit.md](../2023/CVE-2023-45866-Danyw24_blueXploit.md)

## CVE-2023-45866 - BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** bluez 5.64-0ubuntu1 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需在蓝牙通信范围内，目标设备开启蓝牙且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许未经验证的攻击者通过伪装成蓝牙HID设备，在受害者设备上注入键盘输入。利用方式如下：

1.  攻击者使用特定的蓝牙HID设备（如伪造的键盘）发起连接。
2.  由于BlueZ在某些版本中未正确处理身份验证，攻击者可以绕过配对流程，建立加密连接。
3.  攻击者随后可以发送恶意HID报告，模拟键盘输入。
4.  通过模拟按键，攻击者可以执行任意命令，如打开终端、下载恶意软件等。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开可用的POC。因此，漏洞利用具有有效性。

**投毒风险评估：**

查看提供的漏洞利用代码（blueXploit），发现代码主要功能是利用CVE-2023-45866漏洞进行蓝牙HID注入攻击。代码包含自动生成payload并注入到APK的功能，存在一定的风险，但更多是利用msfvenom等工具生成payload, **所以判断投毒概率较低,大约为5%。**

**利用方式分析：**

blueXploit利用工具：

1.  **模拟HID设备：** 代码可能使用Linux的蓝牙工具（如`bluez-tools`）来模拟HID设备，使其能够发送键盘和鼠标事件。
2.  **绕过认证：** 漏洞的核心在于绕过蓝牙HID的认证机制。POC代码会尝试建立未认证的连接，或者利用已知的漏洞来欺骗目标设备。
3.  **Payload注入：** 成功建立连接后，POC代码会注入预先定义的payload，这些payload通常包含一系列键盘指令，用于在目标设备上执行命令。利用APK的组件，可能导致恶意软件安装或其他恶意行为。

**结论：**

CVE-2023-45866是一个严重的安全漏洞，允许未经授权的攻击者通过蓝牙注入键盘输入，从而控制受害者设备。提供的POC代码可以有效利用该漏洞。存在少许投毒风险但主要集中在自动化payload生成和注入方面，需要谨慎使用。攻击者需要具备一定的蓝牙协议和Linux系统知识才能成功利用该漏洞。

**项目地址:** [Danyw24/blueXploit](https://github.com/Danyw24/blueXploit)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #4

**来源**: [CVE-2023-45866-Eason-zz_BluetoothDucky.md](../2023/CVE-2023-45866-Eason-zz_BluetoothDucky.md)

## CVE-2023-45866-BlueZ-蓝牙HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，允许未授权的蓝牙HID设备注入键盘事件，可能导致任意命令执行

**影响版本:** 5.64-0ubuntu1 (Ubuntu 22.04LTS)等受影响版本

**利用条件:** 攻击者需要在蓝牙通信范围内，目标设备开启蓝牙功能且未采取CVE-2020-0556的缓解措施。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未认证的蓝牙外围设备 (Peripheral role HID Device) 发起并建立加密连接，并接收 HID 键盘报告。攻击者可以伪装成蓝牙键盘，在没有用户交互的情况下向主机注入 HID 消息，例如键盘按键，从而执行任意命令。 

**有效性评估：**
根据漏洞信息和搜索引擎结果，该漏洞利用的关键在于绕过蓝牙配对认证，从而模拟键盘输入。提供的Python脚本`BluetoothDucky.py`尝试自动化此过程。脚本通过以下步骤利用漏洞：

1.  **蓝牙适配器初始化：** 重启蓝牙服务，配置适配器名称和类别。
2.  **HID Profile注册：** 注册HID profile，使系统认为该设备是HID设备。
3.  **连接目标设备：** 尝试连接目标设备的SDP服务，并进行配对。
4.  **HID连接：** 连接HID中断和控制端口。
5.  **Payload执行：** 从指定文件读取Ducky脚本，并将其转换为HID键盘报告发送到目标设备。

根据搜索结果，该漏洞影响包括Android、iOS和Linux等多个平台。因此，如果脚本能够成功建立蓝牙连接并绕过认证，则漏洞利用应该是有效的。

**投毒风险分析：**
分析提供的Python脚本 `BluetoothDucky.py`，未发现明显的恶意代码或后门。脚本主要功能是模拟蓝牙键盘并发送预定义的按键序列。

以下是未发现明显投毒代码的理由：

*   脚本的主要功能是模拟键盘输入，逻辑清晰。
*   脚本依赖于标准的Python库和Linux工具 (例如 `bluetooth`, `hcitool`)。
*   脚本没有尝试访问本地文件系统、网络连接或执行其他可疑操作。
*   `injector` 目录下的文件需要进一步分析, 但当前的代码片段没有展示出恶意行为。

虽然没有发现明显的投毒代码，但仍存在以下潜在风险：

*   Ducky脚本本身可能包含恶意命令，例如下载和执行恶意软件。这取决于攻击者提供的payload。
*   脚本的依赖项 (例如 `injector` 目录下的模块) 可能包含漏洞或恶意代码。由于没有提供完整代码，无法进行全面分析。
*   脚本的实现可能存在缺陷，导致意外行为或安全问题。

综合考虑，投毒风险较低，但不能完全排除。给予10%的投毒风险评估。

**利用方式：**

1.  **扫描目标设备：** 使用蓝牙扫描工具 (例如 `bluetooth.discover_devices`) 查找附近的蓝牙设备。
2.  **配置攻击环境：** 安装必要的Python库 (例如 `pybluez`)，并确保蓝牙适配器正常工作。
3.  **运行攻击脚本：** 运行 `BluetoothDucky.py` 脚本，指定目标设备的蓝牙地址和用于攻击的蓝牙接口。
4.  **建立连接：** 脚本尝试与目标设备建立蓝牙连接，并绕过认证。
5.  **注入键盘事件：** 脚本将Ducky脚本转换为HID键盘报告，并发送到目标设备。

**总结：**
CVE-2023-45866是一个高危漏洞，攻击者可以通过模拟蓝牙键盘注入恶意键盘事件，从而控制目标设备。提供的POC代码具有一定的有效性，但需要进一步测试和验证。投毒风险较低，但不能完全排除。

**项目地址:** [Eason-zz/BluetoothDucky](https://github.com/Eason-zz/BluetoothDucky)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #5

**来源**: [CVE-2023-45866-jjjjjjjj987_cve-2023-45866-py.md](../2023/CVE-2023-45866-jjjjjjjj987_cve-2023-45866-py.md)

## CVE-2023-45866-BlueZ-HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，允许未授权的设备注入HID消息

**影响版本:** bluez 5.64-0ubuntu1 (Ubuntu 22.04LTS)及其他受影响版本

**利用条件:** 攻击者需要在蓝牙范围内，目标设备使用受影响的BlueZ版本，且未应用CVE-2020-0556的缓解措施

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2023-45866 允许未经验证的外围设备 (Peripheral role HID Device) 在 BlueZ 中发起和建立加密连接，并接受 HID 键盘报告。这使得攻击者无需用户交互即可注入 HID 消息。从搜索引擎结果和漏洞库信息来看，攻击者可以利用该漏洞模拟键盘输入，从而执行任意命令。提供的POC代码似乎是重定向到Rick Astley的“Never Gonna Give You Up”视频，并不是真正的漏洞利用代码，仅仅是一个恶搞。但是考虑到提供的代码被包含在github上的一个项目中，该项目的目的是研究 CVE-2023-45866 漏洞，因此存在一定的投毒风险，即可能存在其他恶意代码被隐藏在仓库中的其他位置的可能性。由于POC本身不具备实际攻击能力，而 github上的其他代码内容未知。因此，投毒风险极高，判断为95%。利用方式主要通过模拟蓝牙键盘，在未经授权的情况下，向目标设备发送恶意指令。

**项目地址:** [jjjjjjjj987/cve-2023-45866-py](https://github.com/jjjjjjjj987/cve-2023-45866-py)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #6

**来源**: [CVE-2023-45866-ladyg00se_CVE-2023-45866_WIP.md](../2023/CVE-2023-45866-ladyg00se_CVE-2023-45866_WIP.md)

## CVE-2023-45866-BlueZ蓝牙HID主机未授权连接

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 认证绕过

**影响应用:** BlueZ

**危害等级:** 高危，可能导致未经授权的键盘输入和命令执行

**影响版本:** bluez <= 5.64 (例如Ubuntu 22.04LTS中的bluez 5.64-0ubuntu1)

**利用条件:** 攻击者需要在目标蓝牙设备的附近

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经验证的蓝牙 HID 设备（作为Peripheral角色）发起并建立加密连接，并接受 HID 键盘报告。这使得攻击者能够在Central角色没有用户交互的情况下注入 HID 消息。根据搜索结果，该漏洞影响 Apple、Android 和 Linux 设备，尤其是与 Apple Magic Keyboard 配对时。利用方式包括欺骗蓝牙主机状态机，使其与伪造的键盘配对，而无需用户确认。提供的漏洞利用代码仅包含 GNU GPL 许可证，没有发现直接的利用代码，但参考[webpage 7 begin]  reblog/cve-2023-45866/README.md at main  [description] The vulnerabilities work by tricking the Bluetooth host state-machine into pairing with a fake keyboard without user-confirmation.，说明存在绕过用户确认进行蓝牙配对的方式。

**有效性评估:**
  虽然提供的代码片段只是一个许可证，但结合漏洞描述和搜索结果可以推断出，如果结合特定的漏洞利用技术（例如欺骗蓝牙主机状态机），该漏洞是可利用的。

**投毒风险分析:**
  提供的代码片段是GNU通用公共许可证，本身不包含任何恶意代码。然而，考虑到漏洞利用通常需要编写额外的代码来模拟HID设备并发送恶意输入，攻击者可能在其他地方发布的POC中包含恶意代码。因此，从其他来源获取的漏洞利用代码存在一定的投毒风险（约为10%）。例如，攻击者可能会添加后门，在成功注入键盘输入后，进一步执行恶意命令。

**漏洞利用方式:**
1.  **被动监听:** 攻击者监听附近的蓝牙设备。
2.  **模拟HID设备:**  攻击者创建一个假的蓝牙HID设备（如键盘）。
3.  **建立连接:** 利用漏洞，在未经用户授权的情况下与目标蓝牙主机建立加密连接。
4.  **注入HID消息:**  攻击者通过建立的连接发送恶意键盘输入，执行任意命令。

利用的关键在于绕过认证，并在建立连接后能够模拟键盘输入。

**项目地址:** [ladyg00se/CVE-2023-45866_WIP](https://github.com/ladyg00se/CVE-2023-45866_WIP)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #7

**来源**: [CVE-2023-45866-pentestfunctions_BlueDucky.md](../2023/CVE-2023-45866-pentestfunctions_BlueDucky.md)

## CVE-2023-45866

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID协议未授权连接漏洞

**影响应用:** BlueZ

**危害等级:** 高危，可能导致未授权的键盘输入注入

**影响版本:** bluez 5.64-0ubuntu1 in Ubuntu 22.04LTS (受影响版本可能更多)

**利用条件:** 攻击者需要在蓝牙通信范围内，目标设备开启蓝牙且未进行适当的配对授权

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙外围设备（如恶意键盘）在 BlueZ 中发起和建立加密连接，并发送 HID 键盘报告。由于在中央角色设备上未进行用户交互以授权访问，攻击者可以注入 HID 消息。POC代码 `BlueDucky.py` 通过模拟蓝牙键盘，尝试绕过认证过程并向目标主机发送预定义的按键序列（duckyscript）。

**有效性评估：**
根据漏洞描述和搜索引擎结果，该漏洞允许攻击者在没有用户交互的情况下，注入键盘输入，因此提供的POC代码理论上是有效的，只要满足漏洞利用的先决条件，如目标设备运行受影响的 BlueZ 版本，并且攻击者在蓝牙通信范围内。

**投毒风险评估：**
分析 `BlueDucky.py` 代码，存在一定的投毒风险，但风险较低。主要风险点体现在以下几个方面：
1.  **依赖项安装：** 代码依赖于 `pydbus` 和 `bluetooth` 库，如果攻击者篡改安装源，可能引入恶意依赖。
2.  **duckyscript内容：**虽然代码本身没有明显恶意行为，但duckyscript 内容可以被修改成任何指令，从而达到植入后门，执行恶意程序等目的。
3. **subprocess 滥用**: 代码中频繁使用了 `subprocess` 模块，如果参数构造不当，容易引入命令注入风险。
4.  **注册HID配置文件：** 代码使用 `register_hid_profile` 注册HID profile，如果profile内容被篡改，可以导致目标系统出现意外行为。
综合考虑，主要风险来自duckyscript的内容，和profile内容，以及对`subprocess`模块的滥用，因此投毒风险评估为10%。

**利用方式：**
1.  **扫描目标：** 攻击者使用蓝牙扫描工具找到可攻击的目标设备。
2.  **模拟蓝牙键盘：** 攻击者运行 `BlueDucky.py` 脚本，模拟一个蓝牙键盘。
3.  **绕过认证：** 脚本利用漏洞，尝试与目标设备建立未经授权的加密连接。
4.  **注入按键：** 成功建立连接后，脚本执行 duckyscript 文件中的指令，向目标主机注入预定义的按键序列，从而控制目标设备。

**项目地址:** [pentestfunctions/BlueDucky](https://github.com/pentestfunctions/BlueDucky)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #8

**来源**: [CVE-2023-45866-xG3nesis_RustyInjector.md](../2023/CVE-2023-45866-xG3nesis_RustyInjector.md)

## CVE-2023-45866 - BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能允许未经验证的外围设备注入HID消息

**影响版本:** bluez 5.64-0ubuntu1 in Ubuntu 22.04LTS及其他受影响版本

**利用条件:** 攻击者需在蓝牙范围内，目标设备开启蓝牙且允许未授权HID连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙HID设备在BlueZ主机上发起加密连接并发送HID报告，从而可能在无需用户交互的情况下注入HID消息。漏洞存在于BlueZ的蓝牙HID主机中，攻击者可以伪装成蓝牙键盘，在目标设备上执行任意按键操作，从而执行命令。PoC代码使用Rust编写，利用`bluer`库进行蓝牙通信，模拟HID设备发送恶意输入。尽管PoC自述文件声明仅用于教育目的，但存在一定的投毒风险，因为攻击者可以修改代码以适应特定的攻击场景或添加恶意功能。自述文件中警告使用者承担责任，降低了部分风险。该漏洞利用依赖于设备之间的BR/EDR连接，并且攻击者需要绕过配对和授权机制。PoC代码本身看起来直接实现了漏洞利用，但使用者需要自行承担风险。

**项目地址:** [xG3nesis/RustyInjector](https://github.com/xG3nesis/RustyInjector)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---



---

## POC #6

**来源**: [CVE-2023-45866-jjjjjjjj987_cve-2023-45866-py.md](../2023/CVE-2023-45866-jjjjjjjj987_cve-2023-45866-py.md)

## CVE-2023-45866-BlueZ-HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，允许未授权的设备注入HID消息

**影响版本:** bluez 5.64-0ubuntu1 (Ubuntu 22.04LTS)及其他受影响版本

**利用条件:** 攻击者需要在蓝牙范围内，目标设备使用受影响的BlueZ版本，且未应用CVE-2020-0556的缓解措施

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2023-45866 允许未经验证的外围设备 (Peripheral role HID Device) 在 BlueZ 中发起和建立加密连接，并接受 HID 键盘报告。这使得攻击者无需用户交互即可注入 HID 消息。从搜索引擎结果和漏洞库信息来看，攻击者可以利用该漏洞模拟键盘输入，从而执行任意命令。提供的POC代码似乎是重定向到Rick Astley的“Never Gonna Give You Up”视频，并不是真正的漏洞利用代码，仅仅是一个恶搞。但是考虑到提供的代码被包含在github上的一个项目中，该项目的目的是研究 CVE-2023-45866 漏洞，因此存在一定的投毒风险，即可能存在其他恶意代码被隐藏在仓库中的其他位置的可能性。由于POC本身不具备实际攻击能力，而 github上的其他代码内容未知。因此，投毒风险极高，判断为95%。利用方式主要通过模拟蓝牙键盘，在未经授权的情况下，向目标设备发送恶意指令。

**项目地址:** [jjjjjjjj987/cve-2023-45866-py](https://github.com/jjjjjjjj987/cve-2023-45866-py)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #7

**来源**: [CVE-2023-45866-ladyg00se_CVE-2023-45866_WIP.md](../2023/CVE-2023-45866-ladyg00se_CVE-2023-45866_WIP.md)

## CVE-2023-45866-BlueZ蓝牙HID主机未授权连接

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 认证绕过

**影响应用:** BlueZ

**危害等级:** 高危，可能导致未经授权的键盘输入和命令执行

**影响版本:** bluez <= 5.64 (例如Ubuntu 22.04LTS中的bluez 5.64-0ubuntu1)

**利用条件:** 攻击者需要在目标蓝牙设备的附近

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经验证的蓝牙 HID 设备（作为Peripheral角色）发起并建立加密连接，并接受 HID 键盘报告。这使得攻击者能够在Central角色没有用户交互的情况下注入 HID 消息。根据搜索结果，该漏洞影响 Apple、Android 和 Linux 设备，尤其是与 Apple Magic Keyboard 配对时。利用方式包括欺骗蓝牙主机状态机，使其与伪造的键盘配对，而无需用户确认。提供的漏洞利用代码仅包含 GNU GPL 许可证，没有发现直接的利用代码，但参考[webpage 7 begin]  reblog/cve-2023-45866/README.md at main  [description] The vulnerabilities work by tricking the Bluetooth host state-machine into pairing with a fake keyboard without user-confirmation.，说明存在绕过用户确认进行蓝牙配对的方式。

**有效性评估:**
  虽然提供的代码片段只是一个许可证，但结合漏洞描述和搜索结果可以推断出，如果结合特定的漏洞利用技术（例如欺骗蓝牙主机状态机），该漏洞是可利用的。

**投毒风险分析:**
  提供的代码片段是GNU通用公共许可证，本身不包含任何恶意代码。然而，考虑到漏洞利用通常需要编写额外的代码来模拟HID设备并发送恶意输入，攻击者可能在其他地方发布的POC中包含恶意代码。因此，从其他来源获取的漏洞利用代码存在一定的投毒风险（约为10%）。例如，攻击者可能会添加后门，在成功注入键盘输入后，进一步执行恶意命令。

**漏洞利用方式:**
1.  **被动监听:** 攻击者监听附近的蓝牙设备。
2.  **模拟HID设备:**  攻击者创建一个假的蓝牙HID设备（如键盘）。
3.  **建立连接:** 利用漏洞，在未经用户授权的情况下与目标蓝牙主机建立加密连接。
4.  **注入HID消息:**  攻击者通过建立的连接发送恶意键盘输入，执行任意命令。

利用的关键在于绕过认证，并在建立连接后能够模拟键盘输入。

**项目地址:** [ladyg00se/CVE-2023-45866_WIP](https://github.com/ladyg00se/CVE-2023-45866_WIP)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #8

**来源**: [CVE-2023-45866-pentestfunctions_BlueDucky.md](../2023/CVE-2023-45866-pentestfunctions_BlueDucky.md)

## CVE-2023-45866

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID协议未授权连接漏洞

**影响应用:** BlueZ

**危害等级:** 高危，可能导致未授权的键盘输入注入

**影响版本:** bluez 5.64-0ubuntu1 in Ubuntu 22.04LTS (受影响版本可能更多)

**利用条件:** 攻击者需要在蓝牙通信范围内，目标设备开启蓝牙且未进行适当的配对授权

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙外围设备（如恶意键盘）在 BlueZ 中发起和建立加密连接，并发送 HID 键盘报告。由于在中央角色设备上未进行用户交互以授权访问，攻击者可以注入 HID 消息。POC代码 `BlueDucky.py` 通过模拟蓝牙键盘，尝试绕过认证过程并向目标主机发送预定义的按键序列（duckyscript）。

**有效性评估：**
根据漏洞描述和搜索引擎结果，该漏洞允许攻击者在没有用户交互的情况下，注入键盘输入，因此提供的POC代码理论上是有效的，只要满足漏洞利用的先决条件，如目标设备运行受影响的 BlueZ 版本，并且攻击者在蓝牙通信范围内。

**投毒风险评估：**
分析 `BlueDucky.py` 代码，存在一定的投毒风险，但风险较低。主要风险点体现在以下几个方面：
1.  **依赖项安装：** 代码依赖于 `pydbus` 和 `bluetooth` 库，如果攻击者篡改安装源，可能引入恶意依赖。
2.  **duckyscript内容：**虽然代码本身没有明显恶意行为，但duckyscript 内容可以被修改成任何指令，从而达到植入后门，执行恶意程序等目的。
3. **subprocess 滥用**: 代码中频繁使用了 `subprocess` 模块，如果参数构造不当，容易引入命令注入风险。
4.  **注册HID配置文件：** 代码使用 `register_hid_profile` 注册HID profile，如果profile内容被篡改，可以导致目标系统出现意外行为。
综合考虑，主要风险来自duckyscript的内容，和profile内容，以及对`subprocess`模块的滥用，因此投毒风险评估为10%。

**利用方式：**
1.  **扫描目标：** 攻击者使用蓝牙扫描工具找到可攻击的目标设备。
2.  **模拟蓝牙键盘：** 攻击者运行 `BlueDucky.py` 脚本，模拟一个蓝牙键盘。
3.  **绕过认证：** 脚本利用漏洞，尝试与目标设备建立未经授权的加密连接。
4.  **注入按键：** 成功建立连接后，脚本执行 duckyscript 文件中的指令，向目标主机注入预定义的按键序列，从而控制目标设备。

**项目地址:** [pentestfunctions/BlueDucky](https://github.com/pentestfunctions/BlueDucky)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #9

**来源**: [CVE-2023-45866-xG3nesis_RustyInjector.md](../2023/CVE-2023-45866-xG3nesis_RustyInjector.md)

## CVE-2023-45866 - BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能允许未经验证的外围设备注入HID消息

**影响版本:** bluez 5.64-0ubuntu1 in Ubuntu 22.04LTS及其他受影响版本

**利用条件:** 攻击者需在蓝牙范围内，目标设备开启蓝牙且允许未授权HID连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙HID设备在BlueZ主机上发起加密连接并发送HID报告，从而可能在无需用户交互的情况下注入HID消息。漏洞存在于BlueZ的蓝牙HID主机中，攻击者可以伪装成蓝牙键盘，在目标设备上执行任意按键操作，从而执行命令。PoC代码使用Rust编写，利用`bluer`库进行蓝牙通信，模拟HID设备发送恶意输入。尽管PoC自述文件声明仅用于教育目的，但存在一定的投毒风险，因为攻击者可以修改代码以适应特定的攻击场景或添加恶意功能。自述文件中警告使用者承担责任，降低了部分风险。该漏洞利用依赖于设备之间的BR/EDR连接，并且攻击者需要绕过配对和授权机制。PoC代码本身看起来直接实现了漏洞利用，但使用者需要自行承担风险。

**项目地址:** [xG3nesis/RustyInjector](https://github.com/xG3nesis/RustyInjector)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---



---

## POC #6

**来源**: [CVE-2023-45866-jjjjjjjj987_cve-2023-45866-py.md](../2023/CVE-2023-45866-jjjjjjjj987_cve-2023-45866-py.md)

## CVE-2023-45866-BlueZ-HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，允许未授权的设备注入HID消息

**影响版本:** bluez 5.64-0ubuntu1 (Ubuntu 22.04LTS)及其他受影响版本

**利用条件:** 攻击者需要在蓝牙范围内，目标设备使用受影响的BlueZ版本，且未应用CVE-2020-0556的缓解措施

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2023-45866 允许未经验证的外围设备 (Peripheral role HID Device) 在 BlueZ 中发起和建立加密连接，并接受 HID 键盘报告。这使得攻击者无需用户交互即可注入 HID 消息。从搜索引擎结果和漏洞库信息来看，攻击者可以利用该漏洞模拟键盘输入，从而执行任意命令。提供的POC代码似乎是重定向到Rick Astley的“Never Gonna Give You Up”视频，并不是真正的漏洞利用代码，仅仅是一个恶搞。但是考虑到提供的代码被包含在github上的一个项目中，该项目的目的是研究 CVE-2023-45866 漏洞，因此存在一定的投毒风险，即可能存在其他恶意代码被隐藏在仓库中的其他位置的可能性。由于POC本身不具备实际攻击能力，而 github上的其他代码内容未知。因此，投毒风险极高，判断为95%。利用方式主要通过模拟蓝牙键盘，在未经授权的情况下，向目标设备发送恶意指令。

**项目地址:** [jjjjjjjj987/cve-2023-45866-py](https://github.com/jjjjjjjj987/cve-2023-45866-py)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #7

**来源**: [CVE-2023-45866-ladyg00se_CVE-2023-45866_WIP.md](../2023/CVE-2023-45866-ladyg00se_CVE-2023-45866_WIP.md)

## CVE-2023-45866-BlueZ蓝牙HID主机未授权连接

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 认证绕过

**影响应用:** BlueZ

**危害等级:** 高危，可能导致未经授权的键盘输入和命令执行

**影响版本:** bluez <= 5.64 (例如Ubuntu 22.04LTS中的bluez 5.64-0ubuntu1)

**利用条件:** 攻击者需要在目标蓝牙设备的附近

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经验证的蓝牙 HID 设备（作为Peripheral角色）发起并建立加密连接，并接受 HID 键盘报告。这使得攻击者能够在Central角色没有用户交互的情况下注入 HID 消息。根据搜索结果，该漏洞影响 Apple、Android 和 Linux 设备，尤其是与 Apple Magic Keyboard 配对时。利用方式包括欺骗蓝牙主机状态机，使其与伪造的键盘配对，而无需用户确认。提供的漏洞利用代码仅包含 GNU GPL 许可证，没有发现直接的利用代码，但参考[webpage 7 begin]  reblog/cve-2023-45866/README.md at main  [description] The vulnerabilities work by tricking the Bluetooth host state-machine into pairing with a fake keyboard without user-confirmation.，说明存在绕过用户确认进行蓝牙配对的方式。

**有效性评估:**
  虽然提供的代码片段只是一个许可证，但结合漏洞描述和搜索结果可以推断出，如果结合特定的漏洞利用技术（例如欺骗蓝牙主机状态机），该漏洞是可利用的。

**投毒风险分析:**
  提供的代码片段是GNU通用公共许可证，本身不包含任何恶意代码。然而，考虑到漏洞利用通常需要编写额外的代码来模拟HID设备并发送恶意输入，攻击者可能在其他地方发布的POC中包含恶意代码。因此，从其他来源获取的漏洞利用代码存在一定的投毒风险（约为10%）。例如，攻击者可能会添加后门，在成功注入键盘输入后，进一步执行恶意命令。

**漏洞利用方式:**
1.  **被动监听:** 攻击者监听附近的蓝牙设备。
2.  **模拟HID设备:**  攻击者创建一个假的蓝牙HID设备（如键盘）。
3.  **建立连接:** 利用漏洞，在未经用户授权的情况下与目标蓝牙主机建立加密连接。
4.  **注入HID消息:**  攻击者通过建立的连接发送恶意键盘输入，执行任意命令。

利用的关键在于绕过认证，并在建立连接后能够模拟键盘输入。

**项目地址:** [ladyg00se/CVE-2023-45866_WIP](https://github.com/ladyg00se/CVE-2023-45866_WIP)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #8

**来源**: [CVE-2023-45866-pentestfunctions_BlueDucky.md](../2023/CVE-2023-45866-pentestfunctions_BlueDucky.md)

## CVE-2023-45866

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID协议未授权连接漏洞

**影响应用:** BlueZ

**危害等级:** 高危，可能导致未授权的键盘输入注入

**影响版本:** bluez 5.64-0ubuntu1 in Ubuntu 22.04LTS (受影响版本可能更多)

**利用条件:** 攻击者需要在蓝牙通信范围内，目标设备开启蓝牙且未进行适当的配对授权

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙外围设备（如恶意键盘）在 BlueZ 中发起和建立加密连接，并发送 HID 键盘报告。由于在中央角色设备上未进行用户交互以授权访问，攻击者可以注入 HID 消息。POC代码 `BlueDucky.py` 通过模拟蓝牙键盘，尝试绕过认证过程并向目标主机发送预定义的按键序列（duckyscript）。

**有效性评估：**
根据漏洞描述和搜索引擎结果，该漏洞允许攻击者在没有用户交互的情况下，注入键盘输入，因此提供的POC代码理论上是有效的，只要满足漏洞利用的先决条件，如目标设备运行受影响的 BlueZ 版本，并且攻击者在蓝牙通信范围内。

**投毒风险评估：**
分析 `BlueDucky.py` 代码，存在一定的投毒风险，但风险较低。主要风险点体现在以下几个方面：
1.  **依赖项安装：** 代码依赖于 `pydbus` 和 `bluetooth` 库，如果攻击者篡改安装源，可能引入恶意依赖。
2.  **duckyscript内容：**虽然代码本身没有明显恶意行为，但duckyscript 内容可以被修改成任何指令，从而达到植入后门，执行恶意程序等目的。
3. **subprocess 滥用**: 代码中频繁使用了 `subprocess` 模块，如果参数构造不当，容易引入命令注入风险。
4.  **注册HID配置文件：** 代码使用 `register_hid_profile` 注册HID profile，如果profile内容被篡改，可以导致目标系统出现意外行为。
综合考虑，主要风险来自duckyscript的内容，和profile内容，以及对`subprocess`模块的滥用，因此投毒风险评估为10%。

**利用方式：**
1.  **扫描目标：** 攻击者使用蓝牙扫描工具找到可攻击的目标设备。
2.  **模拟蓝牙键盘：** 攻击者运行 `BlueDucky.py` 脚本，模拟一个蓝牙键盘。
3.  **绕过认证：** 脚本利用漏洞，尝试与目标设备建立未经授权的加密连接。
4.  **注入按键：** 成功建立连接后，脚本执行 duckyscript 文件中的指令，向目标主机注入预定义的按键序列，从而控制目标设备。

**项目地址:** [pentestfunctions/BlueDucky](https://github.com/pentestfunctions/BlueDucky)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #9

**来源**: [CVE-2023-45866-xG3nesis_RustyInjector.md](../2023/CVE-2023-45866-xG3nesis_RustyInjector.md)

## CVE-2023-45866 - BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能允许未经验证的外围设备注入HID消息

**影响版本:** bluez 5.64-0ubuntu1 in Ubuntu 22.04LTS及其他受影响版本

**利用条件:** 攻击者需在蓝牙范围内，目标设备开启蓝牙且允许未授权HID连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙HID设备在BlueZ主机上发起加密连接并发送HID报告，从而可能在无需用户交互的情况下注入HID消息。漏洞存在于BlueZ的蓝牙HID主机中，攻击者可以伪装成蓝牙键盘，在目标设备上执行任意按键操作，从而执行命令。PoC代码使用Rust编写，利用`bluer`库进行蓝牙通信，模拟HID设备发送恶意输入。尽管PoC自述文件声明仅用于教育目的，但存在一定的投毒风险，因为攻击者可以修改代码以适应特定的攻击场景或添加恶意功能。自述文件中警告使用者承担责任，降低了部分风险。该漏洞利用依赖于设备之间的BR/EDR连接，并且攻击者需要绕过配对和授权机制。PoC代码本身看起来直接实现了漏洞利用，但使用者需要自行承担风险。

**项目地址:** [xG3nesis/RustyInjector](https://github.com/xG3nesis/RustyInjector)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---



---

## POC #6

**来源**: [CVE-2023-45866-jjjjjjjj987_cve-2023-45866-py.md](../2023/CVE-2023-45866-jjjjjjjj987_cve-2023-45866-py.md)

## CVE-2023-45866-BlueZ-HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，允许未授权的设备注入HID消息

**影响版本:** bluez 5.64-0ubuntu1 (Ubuntu 22.04LTS)及其他受影响版本

**利用条件:** 攻击者需要在蓝牙范围内，目标设备使用受影响的BlueZ版本，且未应用CVE-2020-0556的缓解措施

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2023-45866 允许未经验证的外围设备 (Peripheral role HID Device) 在 BlueZ 中发起和建立加密连接，并接受 HID 键盘报告。这使得攻击者无需用户交互即可注入 HID 消息。从搜索引擎结果和漏洞库信息来看，攻击者可以利用该漏洞模拟键盘输入，从而执行任意命令。提供的POC代码似乎是重定向到Rick Astley的“Never Gonna Give You Up”视频，并不是真正的漏洞利用代码，仅仅是一个恶搞。但是考虑到提供的代码被包含在github上的一个项目中，该项目的目的是研究 CVE-2023-45866 漏洞，因此存在一定的投毒风险，即可能存在其他恶意代码被隐藏在仓库中的其他位置的可能性。由于POC本身不具备实际攻击能力，而 github上的其他代码内容未知。因此，投毒风险极高，判断为95%。利用方式主要通过模拟蓝牙键盘，在未经授权的情况下，向目标设备发送恶意指令。

**项目地址:** [jjjjjjjj987/cve-2023-45866-py](https://github.com/jjjjjjjj987/cve-2023-45866-py)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #7

**来源**: [CVE-2023-45866-ladyg00se_CVE-2023-45866_WIP.md](../2023/CVE-2023-45866-ladyg00se_CVE-2023-45866_WIP.md)

## CVE-2023-45866-BlueZ蓝牙HID主机未授权连接

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 认证绕过

**影响应用:** BlueZ

**危害等级:** 高危，可能导致未经授权的键盘输入和命令执行

**影响版本:** bluez <= 5.64 (例如Ubuntu 22.04LTS中的bluez 5.64-0ubuntu1)

**利用条件:** 攻击者需要在目标蓝牙设备的附近

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经验证的蓝牙 HID 设备（作为Peripheral角色）发起并建立加密连接，并接受 HID 键盘报告。这使得攻击者能够在Central角色没有用户交互的情况下注入 HID 消息。根据搜索结果，该漏洞影响 Apple、Android 和 Linux 设备，尤其是与 Apple Magic Keyboard 配对时。利用方式包括欺骗蓝牙主机状态机，使其与伪造的键盘配对，而无需用户确认。提供的漏洞利用代码仅包含 GNU GPL 许可证，没有发现直接的利用代码，但参考[webpage 7 begin]  reblog/cve-2023-45866/README.md at main  [description] The vulnerabilities work by tricking the Bluetooth host state-machine into pairing with a fake keyboard without user-confirmation.，说明存在绕过用户确认进行蓝牙配对的方式。

**有效性评估:**
  虽然提供的代码片段只是一个许可证，但结合漏洞描述和搜索结果可以推断出，如果结合特定的漏洞利用技术（例如欺骗蓝牙主机状态机），该漏洞是可利用的。

**投毒风险分析:**
  提供的代码片段是GNU通用公共许可证，本身不包含任何恶意代码。然而，考虑到漏洞利用通常需要编写额外的代码来模拟HID设备并发送恶意输入，攻击者可能在其他地方发布的POC中包含恶意代码。因此，从其他来源获取的漏洞利用代码存在一定的投毒风险（约为10%）。例如，攻击者可能会添加后门，在成功注入键盘输入后，进一步执行恶意命令。

**漏洞利用方式:**
1.  **被动监听:** 攻击者监听附近的蓝牙设备。
2.  **模拟HID设备:**  攻击者创建一个假的蓝牙HID设备（如键盘）。
3.  **建立连接:** 利用漏洞，在未经用户授权的情况下与目标蓝牙主机建立加密连接。
4.  **注入HID消息:**  攻击者通过建立的连接发送恶意键盘输入，执行任意命令。

利用的关键在于绕过认证，并在建立连接后能够模拟键盘输入。

**项目地址:** [ladyg00se/CVE-2023-45866_WIP](https://github.com/ladyg00se/CVE-2023-45866_WIP)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #8

**来源**: [CVE-2023-45866-pentestfunctions_BlueDucky.md](../2023/CVE-2023-45866-pentestfunctions_BlueDucky.md)

## CVE-2023-45866

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID协议未授权连接漏洞

**影响应用:** BlueZ

**危害等级:** 高危，可能导致未授权的键盘输入注入

**影响版本:** bluez 5.64-0ubuntu1 in Ubuntu 22.04LTS (受影响版本可能更多)

**利用条件:** 攻击者需要在蓝牙通信范围内，目标设备开启蓝牙且未进行适当的配对授权

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙外围设备（如恶意键盘）在 BlueZ 中发起和建立加密连接，并发送 HID 键盘报告。由于在中央角色设备上未进行用户交互以授权访问，攻击者可以注入 HID 消息。POC代码 `BlueDucky.py` 通过模拟蓝牙键盘，尝试绕过认证过程并向目标主机发送预定义的按键序列（duckyscript）。

**有效性评估：**
根据漏洞描述和搜索引擎结果，该漏洞允许攻击者在没有用户交互的情况下，注入键盘输入，因此提供的POC代码理论上是有效的，只要满足漏洞利用的先决条件，如目标设备运行受影响的 BlueZ 版本，并且攻击者在蓝牙通信范围内。

**投毒风险评估：**
分析 `BlueDucky.py` 代码，存在一定的投毒风险，但风险较低。主要风险点体现在以下几个方面：
1.  **依赖项安装：** 代码依赖于 `pydbus` 和 `bluetooth` 库，如果攻击者篡改安装源，可能引入恶意依赖。
2.  **duckyscript内容：**虽然代码本身没有明显恶意行为，但duckyscript 内容可以被修改成任何指令，从而达到植入后门，执行恶意程序等目的。
3. **subprocess 滥用**: 代码中频繁使用了 `subprocess` 模块，如果参数构造不当，容易引入命令注入风险。
4.  **注册HID配置文件：** 代码使用 `register_hid_profile` 注册HID profile，如果profile内容被篡改，可以导致目标系统出现意外行为。
综合考虑，主要风险来自duckyscript的内容，和profile内容，以及对`subprocess`模块的滥用，因此投毒风险评估为10%。

**利用方式：**
1.  **扫描目标：** 攻击者使用蓝牙扫描工具找到可攻击的目标设备。
2.  **模拟蓝牙键盘：** 攻击者运行 `BlueDucky.py` 脚本，模拟一个蓝牙键盘。
3.  **绕过认证：** 脚本利用漏洞，尝试与目标设备建立未经授权的加密连接。
4.  **注入按键：** 成功建立连接后，脚本执行 duckyscript 文件中的指令，向目标主机注入预定义的按键序列，从而控制目标设备。

**项目地址:** [pentestfunctions/BlueDucky](https://github.com/pentestfunctions/BlueDucky)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #9

**来源**: [CVE-2023-45866-xG3nesis_RustyInjector.md](../2023/CVE-2023-45866-xG3nesis_RustyInjector.md)

## CVE-2023-45866 - BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能允许未经验证的外围设备注入HID消息

**影响版本:** bluez 5.64-0ubuntu1 in Ubuntu 22.04LTS及其他受影响版本

**利用条件:** 攻击者需在蓝牙范围内，目标设备开启蓝牙且允许未授权HID连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙HID设备在BlueZ主机上发起加密连接并发送HID报告，从而可能在无需用户交互的情况下注入HID消息。漏洞存在于BlueZ的蓝牙HID主机中，攻击者可以伪装成蓝牙键盘，在目标设备上执行任意按键操作，从而执行命令。PoC代码使用Rust编写，利用`bluer`库进行蓝牙通信，模拟HID设备发送恶意输入。尽管PoC自述文件声明仅用于教育目的，但存在一定的投毒风险，因为攻击者可以修改代码以适应特定的攻击场景或添加恶意功能。自述文件中警告使用者承担责任，降低了部分风险。该漏洞利用依赖于设备之间的BR/EDR连接，并且攻击者需要绕过配对和授权机制。PoC代码本身看起来直接实现了漏洞利用，但使用者需要自行承担风险。

**项目地址:** [xG3nesis/RustyInjector](https://github.com/xG3nesis/RustyInjector)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---



---

## POC #6

**来源**: [CVE-2023-45866-jjjjjjjj987_cve-2023-45866-py.md](../2023/CVE-2023-45866-jjjjjjjj987_cve-2023-45866-py.md)

## CVE-2023-45866-BlueZ-HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，允许未授权的设备注入HID消息

**影响版本:** bluez 5.64-0ubuntu1 (Ubuntu 22.04LTS)及其他受影响版本

**利用条件:** 攻击者需要在蓝牙范围内，目标设备使用受影响的BlueZ版本，且未应用CVE-2020-0556的缓解措施

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2023-45866 允许未经验证的外围设备 (Peripheral role HID Device) 在 BlueZ 中发起和建立加密连接，并接受 HID 键盘报告。这使得攻击者无需用户交互即可注入 HID 消息。从搜索引擎结果和漏洞库信息来看，攻击者可以利用该漏洞模拟键盘输入，从而执行任意命令。提供的POC代码似乎是重定向到Rick Astley的“Never Gonna Give You Up”视频，并不是真正的漏洞利用代码，仅仅是一个恶搞。但是考虑到提供的代码被包含在github上的一个项目中，该项目的目的是研究 CVE-2023-45866 漏洞，因此存在一定的投毒风险，即可能存在其他恶意代码被隐藏在仓库中的其他位置的可能性。由于POC本身不具备实际攻击能力，而 github上的其他代码内容未知。因此，投毒风险极高，判断为95%。利用方式主要通过模拟蓝牙键盘，在未经授权的情况下，向目标设备发送恶意指令。

**项目地址:** [jjjjjjjj987/cve-2023-45866-py](https://github.com/jjjjjjjj987/cve-2023-45866-py)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #7

**来源**: [CVE-2023-45866-ladyg00se_CVE-2023-45866_WIP.md](../2023/CVE-2023-45866-ladyg00se_CVE-2023-45866_WIP.md)

## CVE-2023-45866-BlueZ蓝牙HID主机未授权连接

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 认证绕过

**影响应用:** BlueZ

**危害等级:** 高危，可能导致未经授权的键盘输入和命令执行

**影响版本:** bluez <= 5.64 (例如Ubuntu 22.04LTS中的bluez 5.64-0ubuntu1)

**利用条件:** 攻击者需要在目标蓝牙设备的附近

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经验证的蓝牙 HID 设备（作为Peripheral角色）发起并建立加密连接，并接受 HID 键盘报告。这使得攻击者能够在Central角色没有用户交互的情况下注入 HID 消息。根据搜索结果，该漏洞影响 Apple、Android 和 Linux 设备，尤其是与 Apple Magic Keyboard 配对时。利用方式包括欺骗蓝牙主机状态机，使其与伪造的键盘配对，而无需用户确认。提供的漏洞利用代码仅包含 GNU GPL 许可证，没有发现直接的利用代码，但参考[webpage 7 begin]  reblog/cve-2023-45866/README.md at main  [description] The vulnerabilities work by tricking the Bluetooth host state-machine into pairing with a fake keyboard without user-confirmation.，说明存在绕过用户确认进行蓝牙配对的方式。

**有效性评估:**
  虽然提供的代码片段只是一个许可证，但结合漏洞描述和搜索结果可以推断出，如果结合特定的漏洞利用技术（例如欺骗蓝牙主机状态机），该漏洞是可利用的。

**投毒风险分析:**
  提供的代码片段是GNU通用公共许可证，本身不包含任何恶意代码。然而，考虑到漏洞利用通常需要编写额外的代码来模拟HID设备并发送恶意输入，攻击者可能在其他地方发布的POC中包含恶意代码。因此，从其他来源获取的漏洞利用代码存在一定的投毒风险（约为10%）。例如，攻击者可能会添加后门，在成功注入键盘输入后，进一步执行恶意命令。

**漏洞利用方式:**
1.  **被动监听:** 攻击者监听附近的蓝牙设备。
2.  **模拟HID设备:**  攻击者创建一个假的蓝牙HID设备（如键盘）。
3.  **建立连接:** 利用漏洞，在未经用户授权的情况下与目标蓝牙主机建立加密连接。
4.  **注入HID消息:**  攻击者通过建立的连接发送恶意键盘输入，执行任意命令。

利用的关键在于绕过认证，并在建立连接后能够模拟键盘输入。

**项目地址:** [ladyg00se/CVE-2023-45866_WIP](https://github.com/ladyg00se/CVE-2023-45866_WIP)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #8

**来源**: [CVE-2023-45866-pentestfunctions_BlueDucky.md](../2023/CVE-2023-45866-pentestfunctions_BlueDucky.md)

## CVE-2023-45866

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID协议未授权连接漏洞

**影响应用:** BlueZ

**危害等级:** 高危，可能导致未授权的键盘输入注入

**影响版本:** bluez 5.64-0ubuntu1 in Ubuntu 22.04LTS (受影响版本可能更多)

**利用条件:** 攻击者需要在蓝牙通信范围内，目标设备开启蓝牙且未进行适当的配对授权

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙外围设备（如恶意键盘）在 BlueZ 中发起和建立加密连接，并发送 HID 键盘报告。由于在中央角色设备上未进行用户交互以授权访问，攻击者可以注入 HID 消息。POC代码 `BlueDucky.py` 通过模拟蓝牙键盘，尝试绕过认证过程并向目标主机发送预定义的按键序列（duckyscript）。

**有效性评估：**
根据漏洞描述和搜索引擎结果，该漏洞允许攻击者在没有用户交互的情况下，注入键盘输入，因此提供的POC代码理论上是有效的，只要满足漏洞利用的先决条件，如目标设备运行受影响的 BlueZ 版本，并且攻击者在蓝牙通信范围内。

**投毒风险评估：**
分析 `BlueDucky.py` 代码，存在一定的投毒风险，但风险较低。主要风险点体现在以下几个方面：
1.  **依赖项安装：** 代码依赖于 `pydbus` 和 `bluetooth` 库，如果攻击者篡改安装源，可能引入恶意依赖。
2.  **duckyscript内容：**虽然代码本身没有明显恶意行为，但duckyscript 内容可以被修改成任何指令，从而达到植入后门，执行恶意程序等目的。
3. **subprocess 滥用**: 代码中频繁使用了 `subprocess` 模块，如果参数构造不当，容易引入命令注入风险。
4.  **注册HID配置文件：** 代码使用 `register_hid_profile` 注册HID profile，如果profile内容被篡改，可以导致目标系统出现意外行为。
综合考虑，主要风险来自duckyscript的内容，和profile内容，以及对`subprocess`模块的滥用，因此投毒风险评估为10%。

**利用方式：**
1.  **扫描目标：** 攻击者使用蓝牙扫描工具找到可攻击的目标设备。
2.  **模拟蓝牙键盘：** 攻击者运行 `BlueDucky.py` 脚本，模拟一个蓝牙键盘。
3.  **绕过认证：** 脚本利用漏洞，尝试与目标设备建立未经授权的加密连接。
4.  **注入按键：** 成功建立连接后，脚本执行 duckyscript 文件中的指令，向目标主机注入预定义的按键序列，从而控制目标设备。

**项目地址:** [pentestfunctions/BlueDucky](https://github.com/pentestfunctions/BlueDucky)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #9

**来源**: [CVE-2023-45866-xG3nesis_RustyInjector.md](../2023/CVE-2023-45866-xG3nesis_RustyInjector.md)

## CVE-2023-45866 - BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能允许未经验证的外围设备注入HID消息

**影响版本:** bluez 5.64-0ubuntu1 in Ubuntu 22.04LTS及其他受影响版本

**利用条件:** 攻击者需在蓝牙范围内，目标设备开启蓝牙且允许未授权HID连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙HID设备在BlueZ主机上发起加密连接并发送HID报告，从而可能在无需用户交互的情况下注入HID消息。漏洞存在于BlueZ的蓝牙HID主机中，攻击者可以伪装成蓝牙键盘，在目标设备上执行任意按键操作，从而执行命令。PoC代码使用Rust编写，利用`bluer`库进行蓝牙通信，模拟HID设备发送恶意输入。尽管PoC自述文件声明仅用于教育目的，但存在一定的投毒风险，因为攻击者可以修改代码以适应特定的攻击场景或添加恶意功能。自述文件中警告使用者承担责任，降低了部分风险。该漏洞利用依赖于设备之间的BR/EDR连接，并且攻击者需要绕过配对和授权机制。PoC代码本身看起来直接实现了漏洞利用，但使用者需要自行承担风险。

**项目地址:** [xG3nesis/RustyInjector](https://github.com/xG3nesis/RustyInjector)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---



---

## POC #6

**来源**: [CVE-2023-45866-jjjjjjjj987_cve-2023-45866-py.md](../2023/CVE-2023-45866-jjjjjjjj987_cve-2023-45866-py.md)

## CVE-2023-45866-BlueZ-HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，允许未授权的设备注入HID消息

**影响版本:** bluez 5.64-0ubuntu1 (Ubuntu 22.04LTS)及其他受影响版本

**利用条件:** 攻击者需要在蓝牙范围内，目标设备使用受影响的BlueZ版本，且未应用CVE-2020-0556的缓解措施

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2023-45866 允许未经验证的外围设备 (Peripheral role HID Device) 在 BlueZ 中发起和建立加密连接，并接受 HID 键盘报告。这使得攻击者无需用户交互即可注入 HID 消息。从搜索引擎结果和漏洞库信息来看，攻击者可以利用该漏洞模拟键盘输入，从而执行任意命令。提供的POC代码似乎是重定向到Rick Astley的“Never Gonna Give You Up”视频，并不是真正的漏洞利用代码，仅仅是一个恶搞。但是考虑到提供的代码被包含在github上的一个项目中，该项目的目的是研究 CVE-2023-45866 漏洞，因此存在一定的投毒风险，即可能存在其他恶意代码被隐藏在仓库中的其他位置的可能性。由于POC本身不具备实际攻击能力，而 github上的其他代码内容未知。因此，投毒风险极高，判断为95%。利用方式主要通过模拟蓝牙键盘，在未经授权的情况下，向目标设备发送恶意指令。

**项目地址:** [jjjjjjjj987/cve-2023-45866-py](https://github.com/jjjjjjjj987/cve-2023-45866-py)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #7

**来源**: [CVE-2023-45866-ladyg00se_CVE-2023-45866_WIP.md](../2023/CVE-2023-45866-ladyg00se_CVE-2023-45866_WIP.md)

## CVE-2023-45866-BlueZ蓝牙HID主机未授权连接

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 认证绕过

**影响应用:** BlueZ

**危害等级:** 高危，可能导致未经授权的键盘输入和命令执行

**影响版本:** bluez <= 5.64 (例如Ubuntu 22.04LTS中的bluez 5.64-0ubuntu1)

**利用条件:** 攻击者需要在目标蓝牙设备的附近

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经验证的蓝牙 HID 设备（作为Peripheral角色）发起并建立加密连接，并接受 HID 键盘报告。这使得攻击者能够在Central角色没有用户交互的情况下注入 HID 消息。根据搜索结果，该漏洞影响 Apple、Android 和 Linux 设备，尤其是与 Apple Magic Keyboard 配对时。利用方式包括欺骗蓝牙主机状态机，使其与伪造的键盘配对，而无需用户确认。提供的漏洞利用代码仅包含 GNU GPL 许可证，没有发现直接的利用代码，但参考[webpage 7 begin]  reblog/cve-2023-45866/README.md at main  [description] The vulnerabilities work by tricking the Bluetooth host state-machine into pairing with a fake keyboard without user-confirmation.，说明存在绕过用户确认进行蓝牙配对的方式。

**有效性评估:**
  虽然提供的代码片段只是一个许可证，但结合漏洞描述和搜索结果可以推断出，如果结合特定的漏洞利用技术（例如欺骗蓝牙主机状态机），该漏洞是可利用的。

**投毒风险分析:**
  提供的代码片段是GNU通用公共许可证，本身不包含任何恶意代码。然而，考虑到漏洞利用通常需要编写额外的代码来模拟HID设备并发送恶意输入，攻击者可能在其他地方发布的POC中包含恶意代码。因此，从其他来源获取的漏洞利用代码存在一定的投毒风险（约为10%）。例如，攻击者可能会添加后门，在成功注入键盘输入后，进一步执行恶意命令。

**漏洞利用方式:**
1.  **被动监听:** 攻击者监听附近的蓝牙设备。
2.  **模拟HID设备:**  攻击者创建一个假的蓝牙HID设备（如键盘）。
3.  **建立连接:** 利用漏洞，在未经用户授权的情况下与目标蓝牙主机建立加密连接。
4.  **注入HID消息:**  攻击者通过建立的连接发送恶意键盘输入，执行任意命令。

利用的关键在于绕过认证，并在建立连接后能够模拟键盘输入。

**项目地址:** [ladyg00se/CVE-2023-45866_WIP](https://github.com/ladyg00se/CVE-2023-45866_WIP)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #8

**来源**: [CVE-2023-45866-pentestfunctions_BlueDucky.md](../2023/CVE-2023-45866-pentestfunctions_BlueDucky.md)

## CVE-2023-45866

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID协议未授权连接漏洞

**影响应用:** BlueZ

**危害等级:** 高危，可能导致未授权的键盘输入注入

**影响版本:** bluez 5.64-0ubuntu1 in Ubuntu 22.04LTS (受影响版本可能更多)

**利用条件:** 攻击者需要在蓝牙通信范围内，目标设备开启蓝牙且未进行适当的配对授权

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙外围设备（如恶意键盘）在 BlueZ 中发起和建立加密连接，并发送 HID 键盘报告。由于在中央角色设备上未进行用户交互以授权访问，攻击者可以注入 HID 消息。POC代码 `BlueDucky.py` 通过模拟蓝牙键盘，尝试绕过认证过程并向目标主机发送预定义的按键序列（duckyscript）。

**有效性评估：**
根据漏洞描述和搜索引擎结果，该漏洞允许攻击者在没有用户交互的情况下，注入键盘输入，因此提供的POC代码理论上是有效的，只要满足漏洞利用的先决条件，如目标设备运行受影响的 BlueZ 版本，并且攻击者在蓝牙通信范围内。

**投毒风险评估：**
分析 `BlueDucky.py` 代码，存在一定的投毒风险，但风险较低。主要风险点体现在以下几个方面：
1.  **依赖项安装：** 代码依赖于 `pydbus` 和 `bluetooth` 库，如果攻击者篡改安装源，可能引入恶意依赖。
2.  **duckyscript内容：**虽然代码本身没有明显恶意行为，但duckyscript 内容可以被修改成任何指令，从而达到植入后门，执行恶意程序等目的。
3. **subprocess 滥用**: 代码中频繁使用了 `subprocess` 模块，如果参数构造不当，容易引入命令注入风险。
4.  **注册HID配置文件：** 代码使用 `register_hid_profile` 注册HID profile，如果profile内容被篡改，可以导致目标系统出现意外行为。
综合考虑，主要风险来自duckyscript的内容，和profile内容，以及对`subprocess`模块的滥用，因此投毒风险评估为10%。

**利用方式：**
1.  **扫描目标：** 攻击者使用蓝牙扫描工具找到可攻击的目标设备。
2.  **模拟蓝牙键盘：** 攻击者运行 `BlueDucky.py` 脚本，模拟一个蓝牙键盘。
3.  **绕过认证：** 脚本利用漏洞，尝试与目标设备建立未经授权的加密连接。
4.  **注入按键：** 成功建立连接后，脚本执行 duckyscript 文件中的指令，向目标主机注入预定义的按键序列，从而控制目标设备。

**项目地址:** [pentestfunctions/BlueDucky](https://github.com/pentestfunctions/BlueDucky)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #9

**来源**: [CVE-2023-45866-xG3nesis_RustyInjector.md](../2023/CVE-2023-45866-xG3nesis_RustyInjector.md)

## CVE-2023-45866 - BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能允许未经验证的外围设备注入HID消息

**影响版本:** bluez 5.64-0ubuntu1 in Ubuntu 22.04LTS及其他受影响版本

**利用条件:** 攻击者需在蓝牙范围内，目标设备开启蓝牙且允许未授权HID连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙HID设备在BlueZ主机上发起加密连接并发送HID报告，从而可能在无需用户交互的情况下注入HID消息。漏洞存在于BlueZ的蓝牙HID主机中，攻击者可以伪装成蓝牙键盘，在目标设备上执行任意按键操作，从而执行命令。PoC代码使用Rust编写，利用`bluer`库进行蓝牙通信，模拟HID设备发送恶意输入。尽管PoC自述文件声明仅用于教育目的，但存在一定的投毒风险，因为攻击者可以修改代码以适应特定的攻击场景或添加恶意功能。自述文件中警告使用者承担责任，降低了部分风险。该漏洞利用依赖于设备之间的BR/EDR连接，并且攻击者需要绕过配对和授权机制。PoC代码本身看起来直接实现了漏洞利用，但使用者需要自行承担风险。

**项目地址:** [xG3nesis/RustyInjector](https://github.com/xG3nesis/RustyInjector)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---



---

## POC #6

**来源**: [CVE-2023-45866-jjjjjjjj987_cve-2023-45866-py.md](../2023/CVE-2023-45866-jjjjjjjj987_cve-2023-45866-py.md)

## CVE-2023-45866-BlueZ-HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，允许未授权的设备注入HID消息

**影响版本:** bluez 5.64-0ubuntu1 (Ubuntu 22.04LTS)及其他受影响版本

**利用条件:** 攻击者需要在蓝牙范围内，目标设备使用受影响的BlueZ版本，且未应用CVE-2020-0556的缓解措施

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2023-45866 允许未经验证的外围设备 (Peripheral role HID Device) 在 BlueZ 中发起和建立加密连接，并接受 HID 键盘报告。这使得攻击者无需用户交互即可注入 HID 消息。从搜索引擎结果和漏洞库信息来看，攻击者可以利用该漏洞模拟键盘输入，从而执行任意命令。提供的POC代码似乎是重定向到Rick Astley的“Never Gonna Give You Up”视频，并不是真正的漏洞利用代码，仅仅是一个恶搞。但是考虑到提供的代码被包含在github上的一个项目中，该项目的目的是研究 CVE-2023-45866 漏洞，因此存在一定的投毒风险，即可能存在其他恶意代码被隐藏在仓库中的其他位置的可能性。由于POC本身不具备实际攻击能力，而 github上的其他代码内容未知。因此，投毒风险极高，判断为95%。利用方式主要通过模拟蓝牙键盘，在未经授权的情况下，向目标设备发送恶意指令。

**项目地址:** [jjjjjjjj987/cve-2023-45866-py](https://github.com/jjjjjjjj987/cve-2023-45866-py)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #7

**来源**: [CVE-2023-45866-ladyg00se_CVE-2023-45866_WIP.md](../2023/CVE-2023-45866-ladyg00se_CVE-2023-45866_WIP.md)

## CVE-2023-45866-BlueZ蓝牙HID主机未授权连接

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 认证绕过

**影响应用:** BlueZ

**危害等级:** 高危，可能导致未经授权的键盘输入和命令执行

**影响版本:** bluez <= 5.64 (例如Ubuntu 22.04LTS中的bluez 5.64-0ubuntu1)

**利用条件:** 攻击者需要在目标蓝牙设备的附近

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经验证的蓝牙 HID 设备（作为Peripheral角色）发起并建立加密连接，并接受 HID 键盘报告。这使得攻击者能够在Central角色没有用户交互的情况下注入 HID 消息。根据搜索结果，该漏洞影响 Apple、Android 和 Linux 设备，尤其是与 Apple Magic Keyboard 配对时。利用方式包括欺骗蓝牙主机状态机，使其与伪造的键盘配对，而无需用户确认。提供的漏洞利用代码仅包含 GNU GPL 许可证，没有发现直接的利用代码，但参考[webpage 7 begin]  reblog/cve-2023-45866/README.md at main  [description] The vulnerabilities work by tricking the Bluetooth host state-machine into pairing with a fake keyboard without user-confirmation.，说明存在绕过用户确认进行蓝牙配对的方式。

**有效性评估:**
  虽然提供的代码片段只是一个许可证，但结合漏洞描述和搜索结果可以推断出，如果结合特定的漏洞利用技术（例如欺骗蓝牙主机状态机），该漏洞是可利用的。

**投毒风险分析:**
  提供的代码片段是GNU通用公共许可证，本身不包含任何恶意代码。然而，考虑到漏洞利用通常需要编写额外的代码来模拟HID设备并发送恶意输入，攻击者可能在其他地方发布的POC中包含恶意代码。因此，从其他来源获取的漏洞利用代码存在一定的投毒风险（约为10%）。例如，攻击者可能会添加后门，在成功注入键盘输入后，进一步执行恶意命令。

**漏洞利用方式:**
1.  **被动监听:** 攻击者监听附近的蓝牙设备。
2.  **模拟HID设备:**  攻击者创建一个假的蓝牙HID设备（如键盘）。
3.  **建立连接:** 利用漏洞，在未经用户授权的情况下与目标蓝牙主机建立加密连接。
4.  **注入HID消息:**  攻击者通过建立的连接发送恶意键盘输入，执行任意命令。

利用的关键在于绕过认证，并在建立连接后能够模拟键盘输入。

**项目地址:** [ladyg00se/CVE-2023-45866_WIP](https://github.com/ladyg00se/CVE-2023-45866_WIP)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #8

**来源**: [CVE-2023-45866-pentestfunctions_BlueDucky.md](../2023/CVE-2023-45866-pentestfunctions_BlueDucky.md)

## CVE-2023-45866

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID协议未授权连接漏洞

**影响应用:** BlueZ

**危害等级:** 高危，可能导致未授权的键盘输入注入

**影响版本:** bluez 5.64-0ubuntu1 in Ubuntu 22.04LTS (受影响版本可能更多)

**利用条件:** 攻击者需要在蓝牙通信范围内，目标设备开启蓝牙且未进行适当的配对授权

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙外围设备（如恶意键盘）在 BlueZ 中发起和建立加密连接，并发送 HID 键盘报告。由于在中央角色设备上未进行用户交互以授权访问，攻击者可以注入 HID 消息。POC代码 `BlueDucky.py` 通过模拟蓝牙键盘，尝试绕过认证过程并向目标主机发送预定义的按键序列（duckyscript）。

**有效性评估：**
根据漏洞描述和搜索引擎结果，该漏洞允许攻击者在没有用户交互的情况下，注入键盘输入，因此提供的POC代码理论上是有效的，只要满足漏洞利用的先决条件，如目标设备运行受影响的 BlueZ 版本，并且攻击者在蓝牙通信范围内。

**投毒风险评估：**
分析 `BlueDucky.py` 代码，存在一定的投毒风险，但风险较低。主要风险点体现在以下几个方面：
1.  **依赖项安装：** 代码依赖于 `pydbus` 和 `bluetooth` 库，如果攻击者篡改安装源，可能引入恶意依赖。
2.  **duckyscript内容：**虽然代码本身没有明显恶意行为，但duckyscript 内容可以被修改成任何指令，从而达到植入后门，执行恶意程序等目的。
3. **subprocess 滥用**: 代码中频繁使用了 `subprocess` 模块，如果参数构造不当，容易引入命令注入风险。
4.  **注册HID配置文件：** 代码使用 `register_hid_profile` 注册HID profile，如果profile内容被篡改，可以导致目标系统出现意外行为。
综合考虑，主要风险来自duckyscript的内容，和profile内容，以及对`subprocess`模块的滥用，因此投毒风险评估为10%。

**利用方式：**
1.  **扫描目标：** 攻击者使用蓝牙扫描工具找到可攻击的目标设备。
2.  **模拟蓝牙键盘：** 攻击者运行 `BlueDucky.py` 脚本，模拟一个蓝牙键盘。
3.  **绕过认证：** 脚本利用漏洞，尝试与目标设备建立未经授权的加密连接。
4.  **注入按键：** 成功建立连接后，脚本执行 duckyscript 文件中的指令，向目标主机注入预定义的按键序列，从而控制目标设备。

**项目地址:** [pentestfunctions/BlueDucky](https://github.com/pentestfunctions/BlueDucky)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #9

**来源**: [CVE-2023-45866-xG3nesis_RustyInjector.md](../2023/CVE-2023-45866-xG3nesis_RustyInjector.md)

## CVE-2023-45866 - BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能允许未经验证的外围设备注入HID消息

**影响版本:** bluez 5.64-0ubuntu1 in Ubuntu 22.04LTS及其他受影响版本

**利用条件:** 攻击者需在蓝牙范围内，目标设备开启蓝牙且允许未授权HID连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙HID设备在BlueZ主机上发起加密连接并发送HID报告，从而可能在无需用户交互的情况下注入HID消息。漏洞存在于BlueZ的蓝牙HID主机中，攻击者可以伪装成蓝牙键盘，在目标设备上执行任意按键操作，从而执行命令。PoC代码使用Rust编写，利用`bluer`库进行蓝牙通信，模拟HID设备发送恶意输入。尽管PoC自述文件声明仅用于教育目的，但存在一定的投毒风险，因为攻击者可以修改代码以适应特定的攻击场景或添加恶意功能。自述文件中警告使用者承担责任，降低了部分风险。该漏洞利用依赖于设备之间的BR/EDR连接，并且攻击者需要绕过配对和授权机制。PoC代码本身看起来直接实现了漏洞利用，但使用者需要自行承担风险。

**项目地址:** [xG3nesis/RustyInjector](https://github.com/xG3nesis/RustyInjector)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---



---

## POC #6

**来源**: [CVE-2023-45866-jjjjjjjj987_cve-2023-45866-py.md](../2023/CVE-2023-45866-jjjjjjjj987_cve-2023-45866-py.md)

## CVE-2023-45866-BlueZ-HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，允许未授权的设备注入HID消息

**影响版本:** bluez 5.64-0ubuntu1 (Ubuntu 22.04LTS)及其他受影响版本

**利用条件:** 攻击者需要在蓝牙范围内，目标设备使用受影响的BlueZ版本，且未应用CVE-2020-0556的缓解措施

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2023-45866 允许未经验证的外围设备 (Peripheral role HID Device) 在 BlueZ 中发起和建立加密连接，并接受 HID 键盘报告。这使得攻击者无需用户交互即可注入 HID 消息。从搜索引擎结果和漏洞库信息来看，攻击者可以利用该漏洞模拟键盘输入，从而执行任意命令。提供的POC代码似乎是重定向到Rick Astley的“Never Gonna Give You Up”视频，并不是真正的漏洞利用代码，仅仅是一个恶搞。但是考虑到提供的代码被包含在github上的一个项目中，该项目的目的是研究 CVE-2023-45866 漏洞，因此存在一定的投毒风险，即可能存在其他恶意代码被隐藏在仓库中的其他位置的可能性。由于POC本身不具备实际攻击能力，而 github上的其他代码内容未知。因此，投毒风险极高，判断为95%。利用方式主要通过模拟蓝牙键盘，在未经授权的情况下，向目标设备发送恶意指令。

**项目地址:** [jjjjjjjj987/cve-2023-45866-py](https://github.com/jjjjjjjj987/cve-2023-45866-py)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #7

**来源**: [CVE-2023-45866-ladyg00se_CVE-2023-45866_WIP.md](../2023/CVE-2023-45866-ladyg00se_CVE-2023-45866_WIP.md)

## CVE-2023-45866-BlueZ蓝牙HID主机未授权连接

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 认证绕过

**影响应用:** BlueZ

**危害等级:** 高危，可能导致未经授权的键盘输入和命令执行

**影响版本:** bluez <= 5.64 (例如Ubuntu 22.04LTS中的bluez 5.64-0ubuntu1)

**利用条件:** 攻击者需要在目标蓝牙设备的附近

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经验证的蓝牙 HID 设备（作为Peripheral角色）发起并建立加密连接，并接受 HID 键盘报告。这使得攻击者能够在Central角色没有用户交互的情况下注入 HID 消息。根据搜索结果，该漏洞影响 Apple、Android 和 Linux 设备，尤其是与 Apple Magic Keyboard 配对时。利用方式包括欺骗蓝牙主机状态机，使其与伪造的键盘配对，而无需用户确认。提供的漏洞利用代码仅包含 GNU GPL 许可证，没有发现直接的利用代码，但参考[webpage 7 begin]  reblog/cve-2023-45866/README.md at main  [description] The vulnerabilities work by tricking the Bluetooth host state-machine into pairing with a fake keyboard without user-confirmation.，说明存在绕过用户确认进行蓝牙配对的方式。

**有效性评估:**
  虽然提供的代码片段只是一个许可证，但结合漏洞描述和搜索结果可以推断出，如果结合特定的漏洞利用技术（例如欺骗蓝牙主机状态机），该漏洞是可利用的。

**投毒风险分析:**
  提供的代码片段是GNU通用公共许可证，本身不包含任何恶意代码。然而，考虑到漏洞利用通常需要编写额外的代码来模拟HID设备并发送恶意输入，攻击者可能在其他地方发布的POC中包含恶意代码。因此，从其他来源获取的漏洞利用代码存在一定的投毒风险（约为10%）。例如，攻击者可能会添加后门，在成功注入键盘输入后，进一步执行恶意命令。

**漏洞利用方式:**
1.  **被动监听:** 攻击者监听附近的蓝牙设备。
2.  **模拟HID设备:**  攻击者创建一个假的蓝牙HID设备（如键盘）。
3.  **建立连接:** 利用漏洞，在未经用户授权的情况下与目标蓝牙主机建立加密连接。
4.  **注入HID消息:**  攻击者通过建立的连接发送恶意键盘输入，执行任意命令。

利用的关键在于绕过认证，并在建立连接后能够模拟键盘输入。

**项目地址:** [ladyg00se/CVE-2023-45866_WIP](https://github.com/ladyg00se/CVE-2023-45866_WIP)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #8

**来源**: [CVE-2023-45866-pentestfunctions_BlueDucky.md](../2023/CVE-2023-45866-pentestfunctions_BlueDucky.md)

## CVE-2023-45866

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID协议未授权连接漏洞

**影响应用:** BlueZ

**危害等级:** 高危，可能导致未授权的键盘输入注入

**影响版本:** bluez 5.64-0ubuntu1 in Ubuntu 22.04LTS (受影响版本可能更多)

**利用条件:** 攻击者需要在蓝牙通信范围内，目标设备开启蓝牙且未进行适当的配对授权

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙外围设备（如恶意键盘）在 BlueZ 中发起和建立加密连接，并发送 HID 键盘报告。由于在中央角色设备上未进行用户交互以授权访问，攻击者可以注入 HID 消息。POC代码 `BlueDucky.py` 通过模拟蓝牙键盘，尝试绕过认证过程并向目标主机发送预定义的按键序列（duckyscript）。

**有效性评估：**
根据漏洞描述和搜索引擎结果，该漏洞允许攻击者在没有用户交互的情况下，注入键盘输入，因此提供的POC代码理论上是有效的，只要满足漏洞利用的先决条件，如目标设备运行受影响的 BlueZ 版本，并且攻击者在蓝牙通信范围内。

**投毒风险评估：**
分析 `BlueDucky.py` 代码，存在一定的投毒风险，但风险较低。主要风险点体现在以下几个方面：
1.  **依赖项安装：** 代码依赖于 `pydbus` 和 `bluetooth` 库，如果攻击者篡改安装源，可能引入恶意依赖。
2.  **duckyscript内容：**虽然代码本身没有明显恶意行为，但duckyscript 内容可以被修改成任何指令，从而达到植入后门，执行恶意程序等目的。
3. **subprocess 滥用**: 代码中频繁使用了 `subprocess` 模块，如果参数构造不当，容易引入命令注入风险。
4.  **注册HID配置文件：** 代码使用 `register_hid_profile` 注册HID profile，如果profile内容被篡改，可以导致目标系统出现意外行为。
综合考虑，主要风险来自duckyscript的内容，和profile内容，以及对`subprocess`模块的滥用，因此投毒风险评估为10%。

**利用方式：**
1.  **扫描目标：** 攻击者使用蓝牙扫描工具找到可攻击的目标设备。
2.  **模拟蓝牙键盘：** 攻击者运行 `BlueDucky.py` 脚本，模拟一个蓝牙键盘。
3.  **绕过认证：** 脚本利用漏洞，尝试与目标设备建立未经授权的加密连接。
4.  **注入按键：** 成功建立连接后，脚本执行 duckyscript 文件中的指令，向目标主机注入预定义的按键序列，从而控制目标设备。

**项目地址:** [pentestfunctions/BlueDucky](https://github.com/pentestfunctions/BlueDucky)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #9

**来源**: [CVE-2023-45866-xG3nesis_RustyInjector.md](../2023/CVE-2023-45866-xG3nesis_RustyInjector.md)

## CVE-2023-45866 - BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能允许未经验证的外围设备注入HID消息

**影响版本:** bluez 5.64-0ubuntu1 in Ubuntu 22.04LTS及其他受影响版本

**利用条件:** 攻击者需在蓝牙范围内，目标设备开启蓝牙且允许未授权HID连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙HID设备在BlueZ主机上发起加密连接并发送HID报告，从而可能在无需用户交互的情况下注入HID消息。漏洞存在于BlueZ的蓝牙HID主机中，攻击者可以伪装成蓝牙键盘，在目标设备上执行任意按键操作，从而执行命令。PoC代码使用Rust编写，利用`bluer`库进行蓝牙通信，模拟HID设备发送恶意输入。尽管PoC自述文件声明仅用于教育目的，但存在一定的投毒风险，因为攻击者可以修改代码以适应特定的攻击场景或添加恶意功能。自述文件中警告使用者承担责任，降低了部分风险。该漏洞利用依赖于设备之间的BR/EDR连接，并且攻击者需要绕过配对和授权机制。PoC代码本身看起来直接实现了漏洞利用，但使用者需要自行承担风险。

**项目地址:** [xG3nesis/RustyInjector](https://github.com/xG3nesis/RustyInjector)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---



---

## POC #6

**来源**: [CVE-2023-45866-jjjjjjjj987_cve-2023-45866-py.md](../2023/CVE-2023-45866-jjjjjjjj987_cve-2023-45866-py.md)

## CVE-2023-45866-BlueZ-HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，允许未授权的设备注入HID消息

**影响版本:** bluez 5.64-0ubuntu1 (Ubuntu 22.04LTS)及其他受影响版本

**利用条件:** 攻击者需要在蓝牙范围内，目标设备使用受影响的BlueZ版本，且未应用CVE-2020-0556的缓解措施

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2023-45866 允许未经验证的外围设备 (Peripheral role HID Device) 在 BlueZ 中发起和建立加密连接，并接受 HID 键盘报告。这使得攻击者无需用户交互即可注入 HID 消息。从搜索引擎结果和漏洞库信息来看，攻击者可以利用该漏洞模拟键盘输入，从而执行任意命令。提供的POC代码似乎是重定向到Rick Astley的“Never Gonna Give You Up”视频，并不是真正的漏洞利用代码，仅仅是一个恶搞。但是考虑到提供的代码被包含在github上的一个项目中，该项目的目的是研究 CVE-2023-45866 漏洞，因此存在一定的投毒风险，即可能存在其他恶意代码被隐藏在仓库中的其他位置的可能性。由于POC本身不具备实际攻击能力，而 github上的其他代码内容未知。因此，投毒风险极高，判断为95%。利用方式主要通过模拟蓝牙键盘，在未经授权的情况下，向目标设备发送恶意指令。

**项目地址:** [jjjjjjjj987/cve-2023-45866-py](https://github.com/jjjjjjjj987/cve-2023-45866-py)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #7

**来源**: [CVE-2023-45866-ladyg00se_CVE-2023-45866_WIP.md](../2023/CVE-2023-45866-ladyg00se_CVE-2023-45866_WIP.md)

## CVE-2023-45866-BlueZ蓝牙HID主机未授权连接

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 认证绕过

**影响应用:** BlueZ

**危害等级:** 高危，可能导致未经授权的键盘输入和命令执行

**影响版本:** bluez <= 5.64 (例如Ubuntu 22.04LTS中的bluez 5.64-0ubuntu1)

**利用条件:** 攻击者需要在目标蓝牙设备的附近

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经验证的蓝牙 HID 设备（作为Peripheral角色）发起并建立加密连接，并接受 HID 键盘报告。这使得攻击者能够在Central角色没有用户交互的情况下注入 HID 消息。根据搜索结果，该漏洞影响 Apple、Android 和 Linux 设备，尤其是与 Apple Magic Keyboard 配对时。利用方式包括欺骗蓝牙主机状态机，使其与伪造的键盘配对，而无需用户确认。提供的漏洞利用代码仅包含 GNU GPL 许可证，没有发现直接的利用代码，但参考[webpage 7 begin]  reblog/cve-2023-45866/README.md at main  [description] The vulnerabilities work by tricking the Bluetooth host state-machine into pairing with a fake keyboard without user-confirmation.，说明存在绕过用户确认进行蓝牙配对的方式。

**有效性评估:**
  虽然提供的代码片段只是一个许可证，但结合漏洞描述和搜索结果可以推断出，如果结合特定的漏洞利用技术（例如欺骗蓝牙主机状态机），该漏洞是可利用的。

**投毒风险分析:**
  提供的代码片段是GNU通用公共许可证，本身不包含任何恶意代码。然而，考虑到漏洞利用通常需要编写额外的代码来模拟HID设备并发送恶意输入，攻击者可能在其他地方发布的POC中包含恶意代码。因此，从其他来源获取的漏洞利用代码存在一定的投毒风险（约为10%）。例如，攻击者可能会添加后门，在成功注入键盘输入后，进一步执行恶意命令。

**漏洞利用方式:**
1.  **被动监听:** 攻击者监听附近的蓝牙设备。
2.  **模拟HID设备:**  攻击者创建一个假的蓝牙HID设备（如键盘）。
3.  **建立连接:** 利用漏洞，在未经用户授权的情况下与目标蓝牙主机建立加密连接。
4.  **注入HID消息:**  攻击者通过建立的连接发送恶意键盘输入，执行任意命令。

利用的关键在于绕过认证，并在建立连接后能够模拟键盘输入。

**项目地址:** [ladyg00se/CVE-2023-45866_WIP](https://github.com/ladyg00se/CVE-2023-45866_WIP)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #8

**来源**: [CVE-2023-45866-pentestfunctions_BlueDucky.md](../2023/CVE-2023-45866-pentestfunctions_BlueDucky.md)

## CVE-2023-45866

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID协议未授权连接漏洞

**影响应用:** BlueZ

**危害等级:** 高危，可能导致未授权的键盘输入注入

**影响版本:** bluez 5.64-0ubuntu1 in Ubuntu 22.04LTS (受影响版本可能更多)

**利用条件:** 攻击者需要在蓝牙通信范围内，目标设备开启蓝牙且未进行适当的配对授权

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙外围设备（如恶意键盘）在 BlueZ 中发起和建立加密连接，并发送 HID 键盘报告。由于在中央角色设备上未进行用户交互以授权访问，攻击者可以注入 HID 消息。POC代码 `BlueDucky.py` 通过模拟蓝牙键盘，尝试绕过认证过程并向目标主机发送预定义的按键序列（duckyscript）。

**有效性评估：**
根据漏洞描述和搜索引擎结果，该漏洞允许攻击者在没有用户交互的情况下，注入键盘输入，因此提供的POC代码理论上是有效的，只要满足漏洞利用的先决条件，如目标设备运行受影响的 BlueZ 版本，并且攻击者在蓝牙通信范围内。

**投毒风险评估：**
分析 `BlueDucky.py` 代码，存在一定的投毒风险，但风险较低。主要风险点体现在以下几个方面：
1.  **依赖项安装：** 代码依赖于 `pydbus` 和 `bluetooth` 库，如果攻击者篡改安装源，可能引入恶意依赖。
2.  **duckyscript内容：**虽然代码本身没有明显恶意行为，但duckyscript 内容可以被修改成任何指令，从而达到植入后门，执行恶意程序等目的。
3. **subprocess 滥用**: 代码中频繁使用了 `subprocess` 模块，如果参数构造不当，容易引入命令注入风险。
4.  **注册HID配置文件：** 代码使用 `register_hid_profile` 注册HID profile，如果profile内容被篡改，可以导致目标系统出现意外行为。
综合考虑，主要风险来自duckyscript的内容，和profile内容，以及对`subprocess`模块的滥用，因此投毒风险评估为10%。

**利用方式：**
1.  **扫描目标：** 攻击者使用蓝牙扫描工具找到可攻击的目标设备。
2.  **模拟蓝牙键盘：** 攻击者运行 `BlueDucky.py` 脚本，模拟一个蓝牙键盘。
3.  **绕过认证：** 脚本利用漏洞，尝试与目标设备建立未经授权的加密连接。
4.  **注入按键：** 成功建立连接后，脚本执行 duckyscript 文件中的指令，向目标主机注入预定义的按键序列，从而控制目标设备。

**项目地址:** [pentestfunctions/BlueDucky](https://github.com/pentestfunctions/BlueDucky)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #9

**来源**: [CVE-2023-45866-xG3nesis_RustyInjector.md](../2023/CVE-2023-45866-xG3nesis_RustyInjector.md)

## CVE-2023-45866 - BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能允许未经验证的外围设备注入HID消息

**影响版本:** bluez 5.64-0ubuntu1 in Ubuntu 22.04LTS及其他受影响版本

**利用条件:** 攻击者需在蓝牙范围内，目标设备开启蓝牙且允许未授权HID连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙HID设备在BlueZ主机上发起加密连接并发送HID报告，从而可能在无需用户交互的情况下注入HID消息。漏洞存在于BlueZ的蓝牙HID主机中，攻击者可以伪装成蓝牙键盘，在目标设备上执行任意按键操作，从而执行命令。PoC代码使用Rust编写，利用`bluer`库进行蓝牙通信，模拟HID设备发送恶意输入。尽管PoC自述文件声明仅用于教育目的，但存在一定的投毒风险，因为攻击者可以修改代码以适应特定的攻击场景或添加恶意功能。自述文件中警告使用者承担责任，降低了部分风险。该漏洞利用依赖于设备之间的BR/EDR连接，并且攻击者需要绕过配对和授权机制。PoC代码本身看起来直接实现了漏洞利用，但使用者需要自行承担风险。

**项目地址:** [xG3nesis/RustyInjector](https://github.com/xG3nesis/RustyInjector)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---



---

## POC #6

**来源**: [CVE-2023-45866-jjjjjjjj987_cve-2023-45866-py.md](../2023/CVE-2023-45866-jjjjjjjj987_cve-2023-45866-py.md)

## CVE-2023-45866-BlueZ-HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，允许未授权的设备注入HID消息

**影响版本:** bluez 5.64-0ubuntu1 (Ubuntu 22.04LTS)及其他受影响版本

**利用条件:** 攻击者需要在蓝牙范围内，目标设备使用受影响的BlueZ版本，且未应用CVE-2020-0556的缓解措施

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2023-45866 允许未经验证的外围设备 (Peripheral role HID Device) 在 BlueZ 中发起和建立加密连接，并接受 HID 键盘报告。这使得攻击者无需用户交互即可注入 HID 消息。从搜索引擎结果和漏洞库信息来看，攻击者可以利用该漏洞模拟键盘输入，从而执行任意命令。提供的POC代码似乎是重定向到Rick Astley的“Never Gonna Give You Up”视频，并不是真正的漏洞利用代码，仅仅是一个恶搞。但是考虑到提供的代码被包含在github上的一个项目中，该项目的目的是研究 CVE-2023-45866 漏洞，因此存在一定的投毒风险，即可能存在其他恶意代码被隐藏在仓库中的其他位置的可能性。由于POC本身不具备实际攻击能力，而 github上的其他代码内容未知。因此，投毒风险极高，判断为95%。利用方式主要通过模拟蓝牙键盘，在未经授权的情况下，向目标设备发送恶意指令。

**项目地址:** [jjjjjjjj987/cve-2023-45866-py](https://github.com/jjjjjjjj987/cve-2023-45866-py)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #7

**来源**: [CVE-2023-45866-ladyg00se_CVE-2023-45866_WIP.md](../2023/CVE-2023-45866-ladyg00se_CVE-2023-45866_WIP.md)

## CVE-2023-45866-BlueZ蓝牙HID主机未授权连接

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 认证绕过

**影响应用:** BlueZ

**危害等级:** 高危，可能导致未经授权的键盘输入和命令执行

**影响版本:** bluez <= 5.64 (例如Ubuntu 22.04LTS中的bluez 5.64-0ubuntu1)

**利用条件:** 攻击者需要在目标蓝牙设备的附近

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经验证的蓝牙 HID 设备（作为Peripheral角色）发起并建立加密连接，并接受 HID 键盘报告。这使得攻击者能够在Central角色没有用户交互的情况下注入 HID 消息。根据搜索结果，该漏洞影响 Apple、Android 和 Linux 设备，尤其是与 Apple Magic Keyboard 配对时。利用方式包括欺骗蓝牙主机状态机，使其与伪造的键盘配对，而无需用户确认。提供的漏洞利用代码仅包含 GNU GPL 许可证，没有发现直接的利用代码，但参考[webpage 7 begin]  reblog/cve-2023-45866/README.md at main  [description] The vulnerabilities work by tricking the Bluetooth host state-machine into pairing with a fake keyboard without user-confirmation.，说明存在绕过用户确认进行蓝牙配对的方式。

**有效性评估:**
  虽然提供的代码片段只是一个许可证，但结合漏洞描述和搜索结果可以推断出，如果结合特定的漏洞利用技术（例如欺骗蓝牙主机状态机），该漏洞是可利用的。

**投毒风险分析:**
  提供的代码片段是GNU通用公共许可证，本身不包含任何恶意代码。然而，考虑到漏洞利用通常需要编写额外的代码来模拟HID设备并发送恶意输入，攻击者可能在其他地方发布的POC中包含恶意代码。因此，从其他来源获取的漏洞利用代码存在一定的投毒风险（约为10%）。例如，攻击者可能会添加后门，在成功注入键盘输入后，进一步执行恶意命令。

**漏洞利用方式:**
1.  **被动监听:** 攻击者监听附近的蓝牙设备。
2.  **模拟HID设备:**  攻击者创建一个假的蓝牙HID设备（如键盘）。
3.  **建立连接:** 利用漏洞，在未经用户授权的情况下与目标蓝牙主机建立加密连接。
4.  **注入HID消息:**  攻击者通过建立的连接发送恶意键盘输入，执行任意命令。

利用的关键在于绕过认证，并在建立连接后能够模拟键盘输入。

**项目地址:** [ladyg00se/CVE-2023-45866_WIP](https://github.com/ladyg00se/CVE-2023-45866_WIP)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #8

**来源**: [CVE-2023-45866-pentestfunctions_BlueDucky.md](../2023/CVE-2023-45866-pentestfunctions_BlueDucky.md)

## CVE-2023-45866

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID协议未授权连接漏洞

**影响应用:** BlueZ

**危害等级:** 高危，可能导致未授权的键盘输入注入

**影响版本:** bluez 5.64-0ubuntu1 in Ubuntu 22.04LTS (受影响版本可能更多)

**利用条件:** 攻击者需要在蓝牙通信范围内，目标设备开启蓝牙且未进行适当的配对授权

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙外围设备（如恶意键盘）在 BlueZ 中发起和建立加密连接，并发送 HID 键盘报告。由于在中央角色设备上未进行用户交互以授权访问，攻击者可以注入 HID 消息。POC代码 `BlueDucky.py` 通过模拟蓝牙键盘，尝试绕过认证过程并向目标主机发送预定义的按键序列（duckyscript）。

**有效性评估：**
根据漏洞描述和搜索引擎结果，该漏洞允许攻击者在没有用户交互的情况下，注入键盘输入，因此提供的POC代码理论上是有效的，只要满足漏洞利用的先决条件，如目标设备运行受影响的 BlueZ 版本，并且攻击者在蓝牙通信范围内。

**投毒风险评估：**
分析 `BlueDucky.py` 代码，存在一定的投毒风险，但风险较低。主要风险点体现在以下几个方面：
1.  **依赖项安装：** 代码依赖于 `pydbus` 和 `bluetooth` 库，如果攻击者篡改安装源，可能引入恶意依赖。
2.  **duckyscript内容：**虽然代码本身没有明显恶意行为，但duckyscript 内容可以被修改成任何指令，从而达到植入后门，执行恶意程序等目的。
3. **subprocess 滥用**: 代码中频繁使用了 `subprocess` 模块，如果参数构造不当，容易引入命令注入风险。
4.  **注册HID配置文件：** 代码使用 `register_hid_profile` 注册HID profile，如果profile内容被篡改，可以导致目标系统出现意外行为。
综合考虑，主要风险来自duckyscript的内容，和profile内容，以及对`subprocess`模块的滥用，因此投毒风险评估为10%。

**利用方式：**
1.  **扫描目标：** 攻击者使用蓝牙扫描工具找到可攻击的目标设备。
2.  **模拟蓝牙键盘：** 攻击者运行 `BlueDucky.py` 脚本，模拟一个蓝牙键盘。
3.  **绕过认证：** 脚本利用漏洞，尝试与目标设备建立未经授权的加密连接。
4.  **注入按键：** 成功建立连接后，脚本执行 duckyscript 文件中的指令，向目标主机注入预定义的按键序列，从而控制目标设备。

**项目地址:** [pentestfunctions/BlueDucky](https://github.com/pentestfunctions/BlueDucky)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #9

**来源**: [CVE-2023-45866-xG3nesis_RustyInjector.md](../2023/CVE-2023-45866-xG3nesis_RustyInjector.md)

## CVE-2023-45866 - BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能允许未经验证的外围设备注入HID消息

**影响版本:** bluez 5.64-0ubuntu1 in Ubuntu 22.04LTS及其他受影响版本

**利用条件:** 攻击者需在蓝牙范围内，目标设备开启蓝牙且允许未授权HID连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙HID设备在BlueZ主机上发起加密连接并发送HID报告，从而可能在无需用户交互的情况下注入HID消息。漏洞存在于BlueZ的蓝牙HID主机中，攻击者可以伪装成蓝牙键盘，在目标设备上执行任意按键操作，从而执行命令。PoC代码使用Rust编写，利用`bluer`库进行蓝牙通信，模拟HID设备发送恶意输入。尽管PoC自述文件声明仅用于教育目的，但存在一定的投毒风险，因为攻击者可以修改代码以适应特定的攻击场景或添加恶意功能。自述文件中警告使用者承担责任，降低了部分风险。该漏洞利用依赖于设备之间的BR/EDR连接，并且攻击者需要绕过配对和授权机制。PoC代码本身看起来直接实现了漏洞利用，但使用者需要自行承担风险。

**项目地址:** [xG3nesis/RustyInjector](https://github.com/xG3nesis/RustyInjector)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---



---

## POC #6

**来源**: [CVE-2023-45866-jjjjjjjj987_cve-2023-45866-py.md](../2023/CVE-2023-45866-jjjjjjjj987_cve-2023-45866-py.md)

## CVE-2023-45866-BlueZ-HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，允许未授权的设备注入HID消息

**影响版本:** bluez 5.64-0ubuntu1 (Ubuntu 22.04LTS)及其他受影响版本

**利用条件:** 攻击者需要在蓝牙范围内，目标设备使用受影响的BlueZ版本，且未应用CVE-2020-0556的缓解措施

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2023-45866 允许未经验证的外围设备 (Peripheral role HID Device) 在 BlueZ 中发起和建立加密连接，并接受 HID 键盘报告。这使得攻击者无需用户交互即可注入 HID 消息。从搜索引擎结果和漏洞库信息来看，攻击者可以利用该漏洞模拟键盘输入，从而执行任意命令。提供的POC代码似乎是重定向到Rick Astley的“Never Gonna Give You Up”视频，并不是真正的漏洞利用代码，仅仅是一个恶搞。但是考虑到提供的代码被包含在github上的一个项目中，该项目的目的是研究 CVE-2023-45866 漏洞，因此存在一定的投毒风险，即可能存在其他恶意代码被隐藏在仓库中的其他位置的可能性。由于POC本身不具备实际攻击能力，而 github上的其他代码内容未知。因此，投毒风险极高，判断为95%。利用方式主要通过模拟蓝牙键盘，在未经授权的情况下，向目标设备发送恶意指令。

**项目地址:** [jjjjjjjj987/cve-2023-45866-py](https://github.com/jjjjjjjj987/cve-2023-45866-py)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #7

**来源**: [CVE-2023-45866-ladyg00se_CVE-2023-45866_WIP.md](../2023/CVE-2023-45866-ladyg00se_CVE-2023-45866_WIP.md)

## CVE-2023-45866-BlueZ蓝牙HID主机未授权连接

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 认证绕过

**影响应用:** BlueZ

**危害等级:** 高危，可能导致未经授权的键盘输入和命令执行

**影响版本:** bluez <= 5.64 (例如Ubuntu 22.04LTS中的bluez 5.64-0ubuntu1)

**利用条件:** 攻击者需要在目标蓝牙设备的附近

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经验证的蓝牙 HID 设备（作为Peripheral角色）发起并建立加密连接，并接受 HID 键盘报告。这使得攻击者能够在Central角色没有用户交互的情况下注入 HID 消息。根据搜索结果，该漏洞影响 Apple、Android 和 Linux 设备，尤其是与 Apple Magic Keyboard 配对时。利用方式包括欺骗蓝牙主机状态机，使其与伪造的键盘配对，而无需用户确认。提供的漏洞利用代码仅包含 GNU GPL 许可证，没有发现直接的利用代码，但参考[webpage 7 begin]  reblog/cve-2023-45866/README.md at main  [description] The vulnerabilities work by tricking the Bluetooth host state-machine into pairing with a fake keyboard without user-confirmation.，说明存在绕过用户确认进行蓝牙配对的方式。

**有效性评估:**
  虽然提供的代码片段只是一个许可证，但结合漏洞描述和搜索结果可以推断出，如果结合特定的漏洞利用技术（例如欺骗蓝牙主机状态机），该漏洞是可利用的。

**投毒风险分析:**
  提供的代码片段是GNU通用公共许可证，本身不包含任何恶意代码。然而，考虑到漏洞利用通常需要编写额外的代码来模拟HID设备并发送恶意输入，攻击者可能在其他地方发布的POC中包含恶意代码。因此，从其他来源获取的漏洞利用代码存在一定的投毒风险（约为10%）。例如，攻击者可能会添加后门，在成功注入键盘输入后，进一步执行恶意命令。

**漏洞利用方式:**
1.  **被动监听:** 攻击者监听附近的蓝牙设备。
2.  **模拟HID设备:**  攻击者创建一个假的蓝牙HID设备（如键盘）。
3.  **建立连接:** 利用漏洞，在未经用户授权的情况下与目标蓝牙主机建立加密连接。
4.  **注入HID消息:**  攻击者通过建立的连接发送恶意键盘输入，执行任意命令。

利用的关键在于绕过认证，并在建立连接后能够模拟键盘输入。

**项目地址:** [ladyg00se/CVE-2023-45866_WIP](https://github.com/ladyg00se/CVE-2023-45866_WIP)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #8

**来源**: [CVE-2023-45866-pentestfunctions_BlueDucky.md](../2023/CVE-2023-45866-pentestfunctions_BlueDucky.md)

## CVE-2023-45866

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID协议未授权连接漏洞

**影响应用:** BlueZ

**危害等级:** 高危，可能导致未授权的键盘输入注入

**影响版本:** bluez 5.64-0ubuntu1 in Ubuntu 22.04LTS (受影响版本可能更多)

**利用条件:** 攻击者需要在蓝牙通信范围内，目标设备开启蓝牙且未进行适当的配对授权

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙外围设备（如恶意键盘）在 BlueZ 中发起和建立加密连接，并发送 HID 键盘报告。由于在中央角色设备上未进行用户交互以授权访问，攻击者可以注入 HID 消息。POC代码 `BlueDucky.py` 通过模拟蓝牙键盘，尝试绕过认证过程并向目标主机发送预定义的按键序列（duckyscript）。

**有效性评估：**
根据漏洞描述和搜索引擎结果，该漏洞允许攻击者在没有用户交互的情况下，注入键盘输入，因此提供的POC代码理论上是有效的，只要满足漏洞利用的先决条件，如目标设备运行受影响的 BlueZ 版本，并且攻击者在蓝牙通信范围内。

**投毒风险评估：**
分析 `BlueDucky.py` 代码，存在一定的投毒风险，但风险较低。主要风险点体现在以下几个方面：
1.  **依赖项安装：** 代码依赖于 `pydbus` 和 `bluetooth` 库，如果攻击者篡改安装源，可能引入恶意依赖。
2.  **duckyscript内容：**虽然代码本身没有明显恶意行为，但duckyscript 内容可以被修改成任何指令，从而达到植入后门，执行恶意程序等目的。
3. **subprocess 滥用**: 代码中频繁使用了 `subprocess` 模块，如果参数构造不当，容易引入命令注入风险。
4.  **注册HID配置文件：** 代码使用 `register_hid_profile` 注册HID profile，如果profile内容被篡改，可以导致目标系统出现意外行为。
综合考虑，主要风险来自duckyscript的内容，和profile内容，以及对`subprocess`模块的滥用，因此投毒风险评估为10%。

**利用方式：**
1.  **扫描目标：** 攻击者使用蓝牙扫描工具找到可攻击的目标设备。
2.  **模拟蓝牙键盘：** 攻击者运行 `BlueDucky.py` 脚本，模拟一个蓝牙键盘。
3.  **绕过认证：** 脚本利用漏洞，尝试与目标设备建立未经授权的加密连接。
4.  **注入按键：** 成功建立连接后，脚本执行 duckyscript 文件中的指令，向目标主机注入预定义的按键序列，从而控制目标设备。

**项目地址:** [pentestfunctions/BlueDucky](https://github.com/pentestfunctions/BlueDucky)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #9

**来源**: [CVE-2023-45866-xG3nesis_RustyInjector.md](../2023/CVE-2023-45866-xG3nesis_RustyInjector.md)

## CVE-2023-45866 - BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能允许未经验证的外围设备注入HID消息

**影响版本:** bluez 5.64-0ubuntu1 in Ubuntu 22.04LTS及其他受影响版本

**利用条件:** 攻击者需在蓝牙范围内，目标设备开启蓝牙且允许未授权HID连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙HID设备在BlueZ主机上发起加密连接并发送HID报告，从而可能在无需用户交互的情况下注入HID消息。漏洞存在于BlueZ的蓝牙HID主机中，攻击者可以伪装成蓝牙键盘，在目标设备上执行任意按键操作，从而执行命令。PoC代码使用Rust编写，利用`bluer`库进行蓝牙通信，模拟HID设备发送恶意输入。尽管PoC自述文件声明仅用于教育目的，但存在一定的投毒风险，因为攻击者可以修改代码以适应特定的攻击场景或添加恶意功能。自述文件中警告使用者承担责任，降低了部分风险。该漏洞利用依赖于设备之间的BR/EDR连接，并且攻击者需要绕过配对和授权机制。PoC代码本身看起来直接实现了漏洞利用，但使用者需要自行承担风险。

**项目地址:** [xG3nesis/RustyInjector](https://github.com/xG3nesis/RustyInjector)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---



---

## POC #6

**来源**: [CVE-2023-45866-jjjjjjjj987_cve-2023-45866-py.md](../2023/CVE-2023-45866-jjjjjjjj987_cve-2023-45866-py.md)

## CVE-2023-45866-BlueZ-HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，允许未授权的设备注入HID消息

**影响版本:** bluez 5.64-0ubuntu1 (Ubuntu 22.04LTS)及其他受影响版本

**利用条件:** 攻击者需要在蓝牙范围内，目标设备使用受影响的BlueZ版本，且未应用CVE-2020-0556的缓解措施

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2023-45866 允许未经验证的外围设备 (Peripheral role HID Device) 在 BlueZ 中发起和建立加密连接，并接受 HID 键盘报告。这使得攻击者无需用户交互即可注入 HID 消息。从搜索引擎结果和漏洞库信息来看，攻击者可以利用该漏洞模拟键盘输入，从而执行任意命令。提供的POC代码似乎是重定向到Rick Astley的“Never Gonna Give You Up”视频，并不是真正的漏洞利用代码，仅仅是一个恶搞。但是考虑到提供的代码被包含在github上的一个项目中，该项目的目的是研究 CVE-2023-45866 漏洞，因此存在一定的投毒风险，即可能存在其他恶意代码被隐藏在仓库中的其他位置的可能性。由于POC本身不具备实际攻击能力，而 github上的其他代码内容未知。因此，投毒风险极高，判断为95%。利用方式主要通过模拟蓝牙键盘，在未经授权的情况下，向目标设备发送恶意指令。

**项目地址:** [jjjjjjjj987/cve-2023-45866-py](https://github.com/jjjjjjjj987/cve-2023-45866-py)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #7

**来源**: [CVE-2023-45866-ladyg00se_CVE-2023-45866_WIP.md](../2023/CVE-2023-45866-ladyg00se_CVE-2023-45866_WIP.md)

## CVE-2023-45866-BlueZ蓝牙HID主机未授权连接

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 认证绕过

**影响应用:** BlueZ

**危害等级:** 高危，可能导致未经授权的键盘输入和命令执行

**影响版本:** bluez <= 5.64 (例如Ubuntu 22.04LTS中的bluez 5.64-0ubuntu1)

**利用条件:** 攻击者需要在目标蓝牙设备的附近

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经验证的蓝牙 HID 设备（作为Peripheral角色）发起并建立加密连接，并接受 HID 键盘报告。这使得攻击者能够在Central角色没有用户交互的情况下注入 HID 消息。根据搜索结果，该漏洞影响 Apple、Android 和 Linux 设备，尤其是与 Apple Magic Keyboard 配对时。利用方式包括欺骗蓝牙主机状态机，使其与伪造的键盘配对，而无需用户确认。提供的漏洞利用代码仅包含 GNU GPL 许可证，没有发现直接的利用代码，但参考[webpage 7 begin]  reblog/cve-2023-45866/README.md at main  [description] The vulnerabilities work by tricking the Bluetooth host state-machine into pairing with a fake keyboard without user-confirmation.，说明存在绕过用户确认进行蓝牙配对的方式。

**有效性评估:**
  虽然提供的代码片段只是一个许可证，但结合漏洞描述和搜索结果可以推断出，如果结合特定的漏洞利用技术（例如欺骗蓝牙主机状态机），该漏洞是可利用的。

**投毒风险分析:**
  提供的代码片段是GNU通用公共许可证，本身不包含任何恶意代码。然而，考虑到漏洞利用通常需要编写额外的代码来模拟HID设备并发送恶意输入，攻击者可能在其他地方发布的POC中包含恶意代码。因此，从其他来源获取的漏洞利用代码存在一定的投毒风险（约为10%）。例如，攻击者可能会添加后门，在成功注入键盘输入后，进一步执行恶意命令。

**漏洞利用方式:**
1.  **被动监听:** 攻击者监听附近的蓝牙设备。
2.  **模拟HID设备:**  攻击者创建一个假的蓝牙HID设备（如键盘）。
3.  **建立连接:** 利用漏洞，在未经用户授权的情况下与目标蓝牙主机建立加密连接。
4.  **注入HID消息:**  攻击者通过建立的连接发送恶意键盘输入，执行任意命令。

利用的关键在于绕过认证，并在建立连接后能够模拟键盘输入。

**项目地址:** [ladyg00se/CVE-2023-45866_WIP](https://github.com/ladyg00se/CVE-2023-45866_WIP)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #8

**来源**: [CVE-2023-45866-pentestfunctions_BlueDucky.md](../2023/CVE-2023-45866-pentestfunctions_BlueDucky.md)

## CVE-2023-45866

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID协议未授权连接漏洞

**影响应用:** BlueZ

**危害等级:** 高危，可能导致未授权的键盘输入注入

**影响版本:** bluez 5.64-0ubuntu1 in Ubuntu 22.04LTS (受影响版本可能更多)

**利用条件:** 攻击者需要在蓝牙通信范围内，目标设备开启蓝牙且未进行适当的配对授权

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙外围设备（如恶意键盘）在 BlueZ 中发起和建立加密连接，并发送 HID 键盘报告。由于在中央角色设备上未进行用户交互以授权访问，攻击者可以注入 HID 消息。POC代码 `BlueDucky.py` 通过模拟蓝牙键盘，尝试绕过认证过程并向目标主机发送预定义的按键序列（duckyscript）。

**有效性评估：**
根据漏洞描述和搜索引擎结果，该漏洞允许攻击者在没有用户交互的情况下，注入键盘输入，因此提供的POC代码理论上是有效的，只要满足漏洞利用的先决条件，如目标设备运行受影响的 BlueZ 版本，并且攻击者在蓝牙通信范围内。

**投毒风险评估：**
分析 `BlueDucky.py` 代码，存在一定的投毒风险，但风险较低。主要风险点体现在以下几个方面：
1.  **依赖项安装：** 代码依赖于 `pydbus` 和 `bluetooth` 库，如果攻击者篡改安装源，可能引入恶意依赖。
2.  **duckyscript内容：**虽然代码本身没有明显恶意行为，但duckyscript 内容可以被修改成任何指令，从而达到植入后门，执行恶意程序等目的。
3. **subprocess 滥用**: 代码中频繁使用了 `subprocess` 模块，如果参数构造不当，容易引入命令注入风险。
4.  **注册HID配置文件：** 代码使用 `register_hid_profile` 注册HID profile，如果profile内容被篡改，可以导致目标系统出现意外行为。
综合考虑，主要风险来自duckyscript的内容，和profile内容，以及对`subprocess`模块的滥用，因此投毒风险评估为10%。

**利用方式：**
1.  **扫描目标：** 攻击者使用蓝牙扫描工具找到可攻击的目标设备。
2.  **模拟蓝牙键盘：** 攻击者运行 `BlueDucky.py` 脚本，模拟一个蓝牙键盘。
3.  **绕过认证：** 脚本利用漏洞，尝试与目标设备建立未经授权的加密连接。
4.  **注入按键：** 成功建立连接后，脚本执行 duckyscript 文件中的指令，向目标主机注入预定义的按键序列，从而控制目标设备。

**项目地址:** [pentestfunctions/BlueDucky](https://github.com/pentestfunctions/BlueDucky)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #9

**来源**: [CVE-2023-45866-xG3nesis_RustyInjector.md](../2023/CVE-2023-45866-xG3nesis_RustyInjector.md)

## CVE-2023-45866 - BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能允许未经验证的外围设备注入HID消息

**影响版本:** bluez 5.64-0ubuntu1 in Ubuntu 22.04LTS及其他受影响版本

**利用条件:** 攻击者需在蓝牙范围内，目标设备开启蓝牙且允许未授权HID连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙HID设备在BlueZ主机上发起加密连接并发送HID报告，从而可能在无需用户交互的情况下注入HID消息。漏洞存在于BlueZ的蓝牙HID主机中，攻击者可以伪装成蓝牙键盘，在目标设备上执行任意按键操作，从而执行命令。PoC代码使用Rust编写，利用`bluer`库进行蓝牙通信，模拟HID设备发送恶意输入。尽管PoC自述文件声明仅用于教育目的，但存在一定的投毒风险，因为攻击者可以修改代码以适应特定的攻击场景或添加恶意功能。自述文件中警告使用者承担责任，降低了部分风险。该漏洞利用依赖于设备之间的BR/EDR连接，并且攻击者需要绕过配对和授权机制。PoC代码本身看起来直接实现了漏洞利用，但使用者需要自行承担风险。

**项目地址:** [xG3nesis/RustyInjector](https://github.com/xG3nesis/RustyInjector)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---



---

## POC #6

**来源**: [CVE-2023-45866-jjjjjjjj987_cve-2023-45866-py.md](../2023/CVE-2023-45866-jjjjjjjj987_cve-2023-45866-py.md)

## CVE-2023-45866-BlueZ-HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，允许未授权的设备注入HID消息

**影响版本:** bluez 5.64-0ubuntu1 (Ubuntu 22.04LTS)及其他受影响版本

**利用条件:** 攻击者需要在蓝牙范围内，目标设备使用受影响的BlueZ版本，且未应用CVE-2020-0556的缓解措施

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2023-45866 允许未经验证的外围设备 (Peripheral role HID Device) 在 BlueZ 中发起和建立加密连接，并接受 HID 键盘报告。这使得攻击者无需用户交互即可注入 HID 消息。从搜索引擎结果和漏洞库信息来看，攻击者可以利用该漏洞模拟键盘输入，从而执行任意命令。提供的POC代码似乎是重定向到Rick Astley的“Never Gonna Give You Up”视频，并不是真正的漏洞利用代码，仅仅是一个恶搞。但是考虑到提供的代码被包含在github上的一个项目中，该项目的目的是研究 CVE-2023-45866 漏洞，因此存在一定的投毒风险，即可能存在其他恶意代码被隐藏在仓库中的其他位置的可能性。由于POC本身不具备实际攻击能力，而 github上的其他代码内容未知。因此，投毒风险极高，判断为95%。利用方式主要通过模拟蓝牙键盘，在未经授权的情况下，向目标设备发送恶意指令。

**项目地址:** [jjjjjjjj987/cve-2023-45866-py](https://github.com/jjjjjjjj987/cve-2023-45866-py)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #7

**来源**: [CVE-2023-45866-ladyg00se_CVE-2023-45866_WIP.md](../2023/CVE-2023-45866-ladyg00se_CVE-2023-45866_WIP.md)

## CVE-2023-45866-BlueZ蓝牙HID主机未授权连接

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 认证绕过

**影响应用:** BlueZ

**危害等级:** 高危，可能导致未经授权的键盘输入和命令执行

**影响版本:** bluez <= 5.64 (例如Ubuntu 22.04LTS中的bluez 5.64-0ubuntu1)

**利用条件:** 攻击者需要在目标蓝牙设备的附近

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经验证的蓝牙 HID 设备（作为Peripheral角色）发起并建立加密连接，并接受 HID 键盘报告。这使得攻击者能够在Central角色没有用户交互的情况下注入 HID 消息。根据搜索结果，该漏洞影响 Apple、Android 和 Linux 设备，尤其是与 Apple Magic Keyboard 配对时。利用方式包括欺骗蓝牙主机状态机，使其与伪造的键盘配对，而无需用户确认。提供的漏洞利用代码仅包含 GNU GPL 许可证，没有发现直接的利用代码，但参考[webpage 7 begin]  reblog/cve-2023-45866/README.md at main  [description] The vulnerabilities work by tricking the Bluetooth host state-machine into pairing with a fake keyboard without user-confirmation.，说明存在绕过用户确认进行蓝牙配对的方式。

**有效性评估:**
  虽然提供的代码片段只是一个许可证，但结合漏洞描述和搜索结果可以推断出，如果结合特定的漏洞利用技术（例如欺骗蓝牙主机状态机），该漏洞是可利用的。

**投毒风险分析:**
  提供的代码片段是GNU通用公共许可证，本身不包含任何恶意代码。然而，考虑到漏洞利用通常需要编写额外的代码来模拟HID设备并发送恶意输入，攻击者可能在其他地方发布的POC中包含恶意代码。因此，从其他来源获取的漏洞利用代码存在一定的投毒风险（约为10%）。例如，攻击者可能会添加后门，在成功注入键盘输入后，进一步执行恶意命令。

**漏洞利用方式:**
1.  **被动监听:** 攻击者监听附近的蓝牙设备。
2.  **模拟HID设备:**  攻击者创建一个假的蓝牙HID设备（如键盘）。
3.  **建立连接:** 利用漏洞，在未经用户授权的情况下与目标蓝牙主机建立加密连接。
4.  **注入HID消息:**  攻击者通过建立的连接发送恶意键盘输入，执行任意命令。

利用的关键在于绕过认证，并在建立连接后能够模拟键盘输入。

**项目地址:** [ladyg00se/CVE-2023-45866_WIP](https://github.com/ladyg00se/CVE-2023-45866_WIP)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #8

**来源**: [CVE-2023-45866-pentestfunctions_BlueDucky.md](../2023/CVE-2023-45866-pentestfunctions_BlueDucky.md)

## CVE-2023-45866

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID协议未授权连接漏洞

**影响应用:** BlueZ

**危害等级:** 高危，可能导致未授权的键盘输入注入

**影响版本:** bluez 5.64-0ubuntu1 in Ubuntu 22.04LTS (受影响版本可能更多)

**利用条件:** 攻击者需要在蓝牙通信范围内，目标设备开启蓝牙且未进行适当的配对授权

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙外围设备（如恶意键盘）在 BlueZ 中发起和建立加密连接，并发送 HID 键盘报告。由于在中央角色设备上未进行用户交互以授权访问，攻击者可以注入 HID 消息。POC代码 `BlueDucky.py` 通过模拟蓝牙键盘，尝试绕过认证过程并向目标主机发送预定义的按键序列（duckyscript）。

**有效性评估：**
根据漏洞描述和搜索引擎结果，该漏洞允许攻击者在没有用户交互的情况下，注入键盘输入，因此提供的POC代码理论上是有效的，只要满足漏洞利用的先决条件，如目标设备运行受影响的 BlueZ 版本，并且攻击者在蓝牙通信范围内。

**投毒风险评估：**
分析 `BlueDucky.py` 代码，存在一定的投毒风险，但风险较低。主要风险点体现在以下几个方面：
1.  **依赖项安装：** 代码依赖于 `pydbus` 和 `bluetooth` 库，如果攻击者篡改安装源，可能引入恶意依赖。
2.  **duckyscript内容：**虽然代码本身没有明显恶意行为，但duckyscript 内容可以被修改成任何指令，从而达到植入后门，执行恶意程序等目的。
3. **subprocess 滥用**: 代码中频繁使用了 `subprocess` 模块，如果参数构造不当，容易引入命令注入风险。
4.  **注册HID配置文件：** 代码使用 `register_hid_profile` 注册HID profile，如果profile内容被篡改，可以导致目标系统出现意外行为。
综合考虑，主要风险来自duckyscript的内容，和profile内容，以及对`subprocess`模块的滥用，因此投毒风险评估为10%。

**利用方式：**
1.  **扫描目标：** 攻击者使用蓝牙扫描工具找到可攻击的目标设备。
2.  **模拟蓝牙键盘：** 攻击者运行 `BlueDucky.py` 脚本，模拟一个蓝牙键盘。
3.  **绕过认证：** 脚本利用漏洞，尝试与目标设备建立未经授权的加密连接。
4.  **注入按键：** 成功建立连接后，脚本执行 duckyscript 文件中的指令，向目标主机注入预定义的按键序列，从而控制目标设备。

**项目地址:** [pentestfunctions/BlueDucky](https://github.com/pentestfunctions/BlueDucky)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #9

**来源**: [CVE-2023-45866-xG3nesis_RustyInjector.md](../2023/CVE-2023-45866-xG3nesis_RustyInjector.md)

## CVE-2023-45866 - BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能允许未经验证的外围设备注入HID消息

**影响版本:** bluez 5.64-0ubuntu1 in Ubuntu 22.04LTS及其他受影响版本

**利用条件:** 攻击者需在蓝牙范围内，目标设备开启蓝牙且允许未授权HID连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙HID设备在BlueZ主机上发起加密连接并发送HID报告，从而可能在无需用户交互的情况下注入HID消息。漏洞存在于BlueZ的蓝牙HID主机中，攻击者可以伪装成蓝牙键盘，在目标设备上执行任意按键操作，从而执行命令。PoC代码使用Rust编写，利用`bluer`库进行蓝牙通信，模拟HID设备发送恶意输入。尽管PoC自述文件声明仅用于教育目的，但存在一定的投毒风险，因为攻击者可以修改代码以适应特定的攻击场景或添加恶意功能。自述文件中警告使用者承担责任，降低了部分风险。该漏洞利用依赖于设备之间的BR/EDR连接，并且攻击者需要绕过配对和授权机制。PoC代码本身看起来直接实现了漏洞利用，但使用者需要自行承担风险。

**项目地址:** [xG3nesis/RustyInjector](https://github.com/xG3nesis/RustyInjector)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---



---

## POC #6

**来源**: [CVE-2023-45866-jjjjjjjj987_cve-2023-45866-py.md](../2023/CVE-2023-45866-jjjjjjjj987_cve-2023-45866-py.md)

## CVE-2023-45866-BlueZ-HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，允许未授权的设备注入HID消息

**影响版本:** bluez 5.64-0ubuntu1 (Ubuntu 22.04LTS)及其他受影响版本

**利用条件:** 攻击者需要在蓝牙范围内，目标设备使用受影响的BlueZ版本，且未应用CVE-2020-0556的缓解措施

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2023-45866 允许未经验证的外围设备 (Peripheral role HID Device) 在 BlueZ 中发起和建立加密连接，并接受 HID 键盘报告。这使得攻击者无需用户交互即可注入 HID 消息。从搜索引擎结果和漏洞库信息来看，攻击者可以利用该漏洞模拟键盘输入，从而执行任意命令。提供的POC代码似乎是重定向到Rick Astley的“Never Gonna Give You Up”视频，并不是真正的漏洞利用代码，仅仅是一个恶搞。但是考虑到提供的代码被包含在github上的一个项目中，该项目的目的是研究 CVE-2023-45866 漏洞，因此存在一定的投毒风险，即可能存在其他恶意代码被隐藏在仓库中的其他位置的可能性。由于POC本身不具备实际攻击能力，而 github上的其他代码内容未知。因此，投毒风险极高，判断为95%。利用方式主要通过模拟蓝牙键盘，在未经授权的情况下，向目标设备发送恶意指令。

**项目地址:** [jjjjjjjj987/cve-2023-45866-py](https://github.com/jjjjjjjj987/cve-2023-45866-py)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #7

**来源**: [CVE-2023-45866-ladyg00se_CVE-2023-45866_WIP.md](../2023/CVE-2023-45866-ladyg00se_CVE-2023-45866_WIP.md)

## CVE-2023-45866-BlueZ蓝牙HID主机未授权连接

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 认证绕过

**影响应用:** BlueZ

**危害等级:** 高危，可能导致未经授权的键盘输入和命令执行

**影响版本:** bluez <= 5.64 (例如Ubuntu 22.04LTS中的bluez 5.64-0ubuntu1)

**利用条件:** 攻击者需要在目标蓝牙设备的附近

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经验证的蓝牙 HID 设备（作为Peripheral角色）发起并建立加密连接，并接受 HID 键盘报告。这使得攻击者能够在Central角色没有用户交互的情况下注入 HID 消息。根据搜索结果，该漏洞影响 Apple、Android 和 Linux 设备，尤其是与 Apple Magic Keyboard 配对时。利用方式包括欺骗蓝牙主机状态机，使其与伪造的键盘配对，而无需用户确认。提供的漏洞利用代码仅包含 GNU GPL 许可证，没有发现直接的利用代码，但参考[webpage 7 begin]  reblog/cve-2023-45866/README.md at main  [description] The vulnerabilities work by tricking the Bluetooth host state-machine into pairing with a fake keyboard without user-confirmation.，说明存在绕过用户确认进行蓝牙配对的方式。

**有效性评估:**
  虽然提供的代码片段只是一个许可证，但结合漏洞描述和搜索结果可以推断出，如果结合特定的漏洞利用技术（例如欺骗蓝牙主机状态机），该漏洞是可利用的。

**投毒风险分析:**
  提供的代码片段是GNU通用公共许可证，本身不包含任何恶意代码。然而，考虑到漏洞利用通常需要编写额外的代码来模拟HID设备并发送恶意输入，攻击者可能在其他地方发布的POC中包含恶意代码。因此，从其他来源获取的漏洞利用代码存在一定的投毒风险（约为10%）。例如，攻击者可能会添加后门，在成功注入键盘输入后，进一步执行恶意命令。

**漏洞利用方式:**
1.  **被动监听:** 攻击者监听附近的蓝牙设备。
2.  **模拟HID设备:**  攻击者创建一个假的蓝牙HID设备（如键盘）。
3.  **建立连接:** 利用漏洞，在未经用户授权的情况下与目标蓝牙主机建立加密连接。
4.  **注入HID消息:**  攻击者通过建立的连接发送恶意键盘输入，执行任意命令。

利用的关键在于绕过认证，并在建立连接后能够模拟键盘输入。

**项目地址:** [ladyg00se/CVE-2023-45866_WIP](https://github.com/ladyg00se/CVE-2023-45866_WIP)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #8

**来源**: [CVE-2023-45866-pentestfunctions_BlueDucky.md](../2023/CVE-2023-45866-pentestfunctions_BlueDucky.md)

## CVE-2023-45866

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID协议未授权连接漏洞

**影响应用:** BlueZ

**危害等级:** 高危，可能导致未授权的键盘输入注入

**影响版本:** bluez 5.64-0ubuntu1 in Ubuntu 22.04LTS (受影响版本可能更多)

**利用条件:** 攻击者需要在蓝牙通信范围内，目标设备开启蓝牙且未进行适当的配对授权

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙外围设备（如恶意键盘）在 BlueZ 中发起和建立加密连接，并发送 HID 键盘报告。由于在中央角色设备上未进行用户交互以授权访问，攻击者可以注入 HID 消息。POC代码 `BlueDucky.py` 通过模拟蓝牙键盘，尝试绕过认证过程并向目标主机发送预定义的按键序列（duckyscript）。

**有效性评估：**
根据漏洞描述和搜索引擎结果，该漏洞允许攻击者在没有用户交互的情况下，注入键盘输入，因此提供的POC代码理论上是有效的，只要满足漏洞利用的先决条件，如目标设备运行受影响的 BlueZ 版本，并且攻击者在蓝牙通信范围内。

**投毒风险评估：**
分析 `BlueDucky.py` 代码，存在一定的投毒风险，但风险较低。主要风险点体现在以下几个方面：
1.  **依赖项安装：** 代码依赖于 `pydbus` 和 `bluetooth` 库，如果攻击者篡改安装源，可能引入恶意依赖。
2.  **duckyscript内容：**虽然代码本身没有明显恶意行为，但duckyscript 内容可以被修改成任何指令，从而达到植入后门，执行恶意程序等目的。
3. **subprocess 滥用**: 代码中频繁使用了 `subprocess` 模块，如果参数构造不当，容易引入命令注入风险。
4.  **注册HID配置文件：** 代码使用 `register_hid_profile` 注册HID profile，如果profile内容被篡改，可以导致目标系统出现意外行为。
综合考虑，主要风险来自duckyscript的内容，和profile内容，以及对`subprocess`模块的滥用，因此投毒风险评估为10%。

**利用方式：**
1.  **扫描目标：** 攻击者使用蓝牙扫描工具找到可攻击的目标设备。
2.  **模拟蓝牙键盘：** 攻击者运行 `BlueDucky.py` 脚本，模拟一个蓝牙键盘。
3.  **绕过认证：** 脚本利用漏洞，尝试与目标设备建立未经授权的加密连接。
4.  **注入按键：** 成功建立连接后，脚本执行 duckyscript 文件中的指令，向目标主机注入预定义的按键序列，从而控制目标设备。

**项目地址:** [pentestfunctions/BlueDucky](https://github.com/pentestfunctions/BlueDucky)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

## POC #9

**来源**: [CVE-2023-45866-xG3nesis_RustyInjector.md](../2023/CVE-2023-45866-xG3nesis_RustyInjector.md)

## CVE-2023-45866 - BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能允许未经验证的外围设备注入HID消息

**影响版本:** bluez 5.64-0ubuntu1 in Ubuntu 22.04LTS及其他受影响版本

**利用条件:** 攻击者需在蓝牙范围内，目标设备开启蓝牙且允许未授权HID连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经身份验证的蓝牙HID设备在BlueZ主机上发起加密连接并发送HID报告，从而可能在无需用户交互的情况下注入HID消息。漏洞存在于BlueZ的蓝牙HID主机中，攻击者可以伪装成蓝牙键盘，在目标设备上执行任意按键操作，从而执行命令。PoC代码使用Rust编写，利用`bluer`库进行蓝牙通信，模拟HID设备发送恶意输入。尽管PoC自述文件声明仅用于教育目的，但存在一定的投毒风险，因为攻击者可以修改代码以适应特定的攻击场景或添加恶意功能。自述文件中警告使用者承担责任，降低了部分风险。该漏洞利用依赖于设备之间的BR/EDR连接，并且攻击者需要绕过配对和授权机制。PoC代码本身看起来直接实现了漏洞利用，但使用者需要自行承担风险。

**项目地址:** [xG3nesis/RustyInjector](https://github.com/xG3nesis/RustyInjector)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)

---

