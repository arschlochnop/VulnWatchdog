# CVE-2023-22515

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-22515-AIex-3_confluence-hack.md](../2023/CVE-2023-22515-AIex-3_confluence-hack.md)

## CVE-2023-22515-Atlassian Confluence Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，允许未经身份验证的攻击者创建管理员账户并完全控制 Confluence 实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence 实例需要公开访问，且处于未修复的版本范围内

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-22515 是 Atlassian Confluence Data Center 和 Server 中的一个严重漏洞，属于未授权访问控制漏洞。未经身份验证的远程攻击者可以通过利用此漏洞创建未经授权的 Confluence 管理员帐户，从而完全控制 Confluence 实例。

**有效性：**
提供的 `exploit.py` 脚本旨在利用 CVE-2023-22515 漏洞，通过发送特制的 HTTP 请求来创建一个新的管理员用户。脚本首先检查目标 Confluence 实例是否处于“Setup Successful”模式，这是漏洞利用的前提条件。如果满足条件，脚本会向 `/setup/setupadministrator.action` 端点发送 POST 请求，其中包含新管理员的用户名、密码和电子邮件地址等信息。成功创建管理员帐户后，脚本会尝试使用新创建的凭据验证登录，以确认漏洞利用成功。

根据提供的 `README.md` 文件，此漏洞已在 Confluence Server 8.5.1 上成功测试。

**投毒风险：**
虽然主要的 `exploit.py` 脚本看起来是直接实现了漏洞利用，但需要关注 `plugin_shellplug.jar` 和 `ShellServlet.java` 文件。`plugin_shellplug.jar` 是一个 Confluence 插件，提供了一个基于 Web 的 shell 接口，允许在服务器上执行命令行命令。`ShellServlet.java` 是该插件的反编译代码。如果攻击者成功利用 CVE-2023-22515 创建了管理员帐户，他们可以使用 Confluence 的 Web 管理 GUI 安装此恶意插件。插件安装后，攻击者可以通过 Web 界面执行任意命令，从而实现远程代码执行。

投毒风险评估：
*   `exploit.py`：虽然此脚本本身是漏洞利用工具，但并非恶意代码。0%
*   `plugin_shellplug.jar` 和 `ShellServlet.java`：这些文件包含一个 Web shell 插件，允许远程代码执行。这部分代码存在潜在的投毒风险。100%。此代码虽然是后门,但是否是作者本人添加存在争议,所以评估为投毒风险.

综合考虑，仓库整体的投毒风险评估为20%。虽然 `exploit.py` 本身没有投毒风险，但其中包含的 `plugin_shellplug.jar` 及其反编译的 `ShellServlet.java` 文件引入了远程代码执行的后门，如果使用者不加分析直接使用，可能会导致更大的安全风险。

**利用方式：**
1.  **检查目标 Confluence 实例是否易受攻击：** 通过访问 `/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false` 检查 Confluence 是否处于未完成设置的状态。
2.  **创建管理员帐户：** 如果 Confluence 处于未完成设置的状态，则使用 `exploit.py` 脚本通过向 `/setup/setupadministrator.action` 发送 POST 请求来创建一个新的管理员帐户。
3.  **登录 Confluence：** 使用新创建的管理员帐户登录 Confluence。
4.  **安装恶意插件：** 在 Confluence 的 Web 管理 GUI 中安装 `plugin_shellplug.jar` 插件。
5.  **执行任意命令：** 通过插件提供的 Web shell 界面执行任意命令，从而实现远程代码执行。

**项目地址:** [AIex-3/confluence-hack](https://github.com/AIex-3/confluence-hack)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #2

**来源**: [CVE-2023-22515-Arkha-Corvus_LetsDefend-SOC235-Atlassian-Confluence-Broken-Access-Control-0-Day-CVE-2023-22515-EventID-197.md](../2023/CVE-2023-22515-Arkha-Corvus_LetsDefend-SOC235-Atlassian-Confluence-Broken-Access-Control-0-Day-CVE-2023-22515-EventID-197.md)

## CVE-2023-22515-Atlassian Confluence 权限绕过

**漏洞编号:** CVE-2023-22515

**漏洞类型:** 权限绕过

**影响应用:** Atlassian Confluence Data Center/Server

**危害等级:** 高危，允许未经身份验证的攻击者创建管理员账户

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence Server/Data Center实例可公开访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22515是一个Atlassian Confluence Server和Data Center中的权限绕过漏洞。未经身份验证的攻击者可以利用此漏洞通过发送特制的GET请求到`/serverinfo.action?bootstrapStatusProvider.applicationConfig.setupComplete=false`端点，绕过初始设置向导，并创建具有管理员权限的账户。提供的漏洞利用代码展示了一个攻击示例，其中外部IP地址尝试访问Confluence服务器上的特定端点，以尝试获得未经授权的管理员访问权限。日志分析表明，如果请求返回200状态码，则攻击可能已成功执行。根据提供的代码，没有发现投毒的迹象，因为代码旨在展示如何检测和响应漏洞利用，而不是包含恶意负载。

**漏洞利用方式：**

1.  攻击者发送一个GET请求到目标Confluence服务器的`/serverinfo.action?bootstrapStatusProvider.applicationConfig.setupComplete=false`端点。
2.  如果服务器易受攻击，并且尚未完成初始设置，它将返回一个允许攻击者创建管理员账户的响应。
3.  攻击者随后利用这个机会创建一个新的管理员账户，从而获得对Confluence实例的完全控制权。
4.  在获取管理员权限后，攻击者可以安装后门，横向移动，或窃取数据。

**项目地址:** [Arkha-Corvus/LetsDefend-SOC235-Atlassian-Confluence-Broken-Access-Control-0-Day-CVE-2023-22515-EventID-197](https://github.com/Arkha-Corvus/LetsDefend-SOC235-Atlassian-Confluence-Broken-Access-Control-0-Day-CVE-2023-22515-EventID-197)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #3

**来源**: [CVE-2023-22515-C1ph3rX13_CVE-2023-22515.md](../2023/CVE-2023-22515-C1ph3rX13_CVE-2023-22515.md)

## CVE-2023-22515-Confluence-Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** Critical，未经身份验证的远程攻击者可以创建 Confluence 管理员账户并访问 Confluence 实例。

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence Data Center 和 Server 实例可以公开访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22515 是 Atlassian Confluence Data Center 和 Server 中的一个严重漏洞，属于 Broken Access Control。未经身份验证的攻击者可以通过发送特制的请求绕过身份验证机制，从而创建未经授权的 Confluence 管理员账户。漏洞利用方式如下：

1.  **利用方式：**
    *   攻击者首先访问 `/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false` 路径，该路径用于判断 Confluence 是否完成设置。
    *   如果未完成设置（即 `setupComplete=false`），攻击者可以访问 `/setup/setupadministrator.action` 路径，创建一个新的管理员账户。
    *   POC 代码通过生成随机用户名和密码，然后使用 POST 请求将这些信息发送到 `/setup/setupadministrator.action`。
    *   创建管理员账户后，POC 代码尝试访问 `/setup/finish` 完成安装。

2.  **有效性评估：**
    *   根据漏洞库信息、搜索引擎结果和提供的 POC 代码，该漏洞利用方式是有效的。多个来源都证实了该漏洞的存在和利用方式，并且 CISA 已将其列入已知被利用的漏洞目录。

3.  **投毒风险评估：**
    *   提供的 Go 语言 POC 代码主要功能是利用该漏洞创建管理员账户。投毒风险评估较低，但是依旧存在风险.
    *  `generateRandomString` 函数，虽然目的是生成随机用户名和密码，理论上存在被替换为恶意字符串的可能。虽然看似无害，但如果生成的用户名或密码被恶意构造，例如包含特定字符以触发后续的漏洞(例如SQL注入，虽然该CVE本身不是SQL注入), 这也是一种投毒方式。 这方面可能性评估：5%
    *  日志记录和错误处理：如果日志记录被修改，可能会隐藏攻击痕迹或者泄漏敏感信息。虽然可能性较小，但仍然需要注意。这方面可能性评估：5%
    *   总体评估：10%

4.  **结论：**
    *   CVE-2023-22515 是一个关键漏洞，需要立即修补。提供的 POC 代码可以有效利用该漏洞，但也需要仔细审查以确保其安全性。

**项目地址:** [C1ph3rX13/CVE-2023-22515](https://github.com/C1ph3rX13/CVE-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #4

**来源**: [CVE-2023-22515-CalegariMindSec_Exploit-CVE-2023-22515.md](../2023/CVE-2023-22515-CalegariMindSec_Exploit-CVE-2023-22515.md)

## CVE-2023-22515-Atlassian Confluence Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，允许未经身份验证的远程攻击者创建管理员账户并完全控制Confluence实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence实例对外开放，且未进行相关修复

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22515是一个存在于Atlassian Confluence Data Center和Server中的严重Broken Access Control漏洞。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞允许未经身份验证的攻击者通过访问`/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false`端点，重置Confluence的安装状态，然后通过向`/setup/setupadministrator.action`端点发送包含用户名、密码等信息的POST请求，创建一个新的管理员账户。该漏洞利用的有效性很高，因为公开的POC代码能够成功创建一个新的管理员账户。搜索结果也表明，该漏洞已被广泛利用。

**投毒风险分析：**
该POC代码主要包含一个bash脚本`xpl.sh`和一个说明文件`README.md`。`xpl.sh`脚本的功能是检测目标Confluence实例是否存在漏洞，并利用该漏洞创建一个新的管理员账户。脚本中定义了默认的用户名`a123456`和密码`ChangeMe123`。投毒风险主要体现在以下几个方面：

1.  **默认用户名和密码：** 攻击者可能修改脚本中的默认用户名和密码，诱导用户使用该脚本，从而在目标系统上创建一个攻击者已知的管理员账户。虽然用户可以修改这些值，但并非所有用户都会这样做，这使得攻击者有机会利用默认凭据进行进一步的攻击。
2.  **网络请求的潜在篡改：** 攻击者可能修改脚本中的curl命令，例如，添加额外的请求头或修改请求体，从而在利用漏洞的同时，向攻击者的服务器发送敏感信息或执行其他恶意操作。虽然目前脚本中的curl命令看起来比较简单，但攻击者可以很容易地对其进行修改，以实现更复杂的攻击目的。
3. **脚本本身的安全风险:** 脚本中使用的`curl -k`参数会忽略SSL证书验证，这可能导致中间人攻击。虽然这本身不是投毒，但增加了使用脚本的风险。此外，恶意作者可以在脚本中添加其他恶意代码，例如下载和执行其他恶意文件。

综合考虑以上因素，该POC代码存在一定的投毒风险，大约为10%。

**利用方式：**
1.  攻击者首先需要确定目标Confluence实例的版本是否在受影响的范围内。
2.  攻击者使用POC脚本`xpl.sh`，并提供目标Confluence实例的URL作为参数。
3.  脚本首先通过访问`/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false`端点来检查目标实例是否存在漏洞。
4.  如果目标实例存在漏洞，脚本将通过向`/setup/setupadministrator.action`端点发送POST请求来创建一个新的管理员账户。
5.  攻击者使用新创建的管理员账户登录Confluence实例，并获得完全控制权限。

**项目地址:** [CalegariMindSec/Exploit-CVE-2023-22515](https://github.com/CalegariMindSec/Exploit-CVE-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #5

**来源**: [CVE-2023-22515-Chocapikk_CVE-2023-22515.md](../2023/CVE-2023-22515-Chocapikk_CVE-2023-22515.md)

## CVE-2023-22515-Atlassian Confluence-Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，允许未授权用户创建管理员账户并访问Confluence实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence实例公开可访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-22515是一个Atlassian Confluence Server和Data Center中的一个严重漏洞，属于Broken Access Control类型。攻击者无需身份验证，即可通过该漏洞创建未经授权的Confluence管理员账户，从而完全控制Confluence实例。

**有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞利用的有效性较高。搜索结果中CISA发布了安全公告，多家安全厂商也发布了漏洞分析报告，表明该漏洞已被广泛利用。漏洞利用代码也提供了normal和mass两种模式，支持单个目标和批量目标利用。

**投毒风险：**
分析提供的POC代码，投毒风险较低。代码主要功能是触发漏洞，创建管理员账号并进行验证。虽然存在修改目标系统行为的操作，但没有发现明显恶意代码（例如反弹shell，安装后门等）。代码中requests库的使用存在一定风险，攻击者可能通过控制DNS等方式进行中间人攻击。综上所述，判定投毒风险为1%。

**利用方式：**
1.  攻击者向存在漏洞的Confluence实例发送特制的HTTP请求。
2.  该请求利用了Confluence中存在的Broken Access Control漏洞，绕过身份验证。
3.  成功绕过身份验证后，攻击者可以创建一个新的Confluence管理员账户。
4.  利用新创建的管理员账户，攻击者可以登录Confluence并执行各种管理操作，例如读取、修改或删除数据，甚至执行任意代码。

**项目地址:** [Chocapikk/CVE-2023-22515](https://github.com/Chocapikk/CVE-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #6

**来源**: [CVE-2023-22515-CyberSentinel321_cve-2023-22515-lab.md](../2023/CVE-2023-22515-CyberSentinel321_cve-2023-22515-lab.md)

## CVE-2023-22515-Confluence Authentication Bypass

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Authentication Bypass

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** Critical，未经授权的管理员权限访问和潜在的远程代码执行

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** 公开可访问的 Confluence Server 或 Data Center 实例

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

根据提供的文件，这是一个 CVE-2023-22515 的 PoC 实验环境。尽管给出了目录结构，但文件内容大多为空或者缺失，无法直接分析具体利用方式。漏洞库信息表明这是一个未授权的身份验证绕过漏洞，允许攻击者创建未经授权的 Confluence 管理员账户。利用方式很可能涉及发送特制的 HTTP 请求到 Confluence 服务器，绕过身份验证检查，创建一个新的管理员账户，然后使用该账户登录。根据提供的 PoC 代码片段（虽然不完整），`/exploit/exploit.sh` 可能是利用脚本，但由于文件内容为空，无法进一步分析其具体实现。由于缺少关键代码，此 PoC 的有效性存疑。该仓库包含LICENSE, README.md文件，看似比较正式，但关键代码缺失，作者可能是想通过这种方式来传播恶意代码，或者为了引流，所以存在一定的投毒风险。 无法确定server目录下js文件内容,如果存在未知的后门或恶意逻辑，可能会对受害者系统造成危害. 投毒风险预估为 60%。如果服务器本身存在后门，则可能会被判定为是利用，所以不判定为投毒。

**项目地址:** [CyberSentinel321/cve-2023-22515-lab](https://github.com/CyberSentinel321/cve-2023-22515-lab)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #7

**来源**: [CVE-2023-22515-DsaHen_cve-2023-22515-exp.md](../2023/CVE-2023-22515-DsaHen_cve-2023-22515-exp.md)

# CVE-2023-22515

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-22515-AIex-3_confluence-hack.md](../2023/CVE-2023-22515-AIex-3_confluence-hack.md)

## CVE-2023-22515-Atlassian Confluence Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，允许未经身份验证的攻击者创建管理员账户并完全控制 Confluence 实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence 实例需要公开访问，且处于未修复的版本范围内

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-22515 是 Atlassian Confluence Data Center 和 Server 中的一个严重漏洞，属于未授权访问控制漏洞。未经身份验证的远程攻击者可以通过利用此漏洞创建未经授权的 Confluence 管理员帐户，从而完全控制 Confluence 实例。

**有效性：**
提供的 `exploit.py` 脚本旨在利用 CVE-2023-22515 漏洞，通过发送特制的 HTTP 请求来创建一个新的管理员用户。脚本首先检查目标 Confluence 实例是否处于“Setup Successful”模式，这是漏洞利用的前提条件。如果满足条件，脚本会向 `/setup/setupadministrator.action` 端点发送 POST 请求，其中包含新管理员的用户名、密码和电子邮件地址等信息。成功创建管理员帐户后，脚本会尝试使用新创建的凭据验证登录，以确认漏洞利用成功。

根据提供的 `README.md` 文件，此漏洞已在 Confluence Server 8.5.1 上成功测试。

**投毒风险：**
虽然主要的 `exploit.py` 脚本看起来是直接实现了漏洞利用，但需要关注 `plugin_shellplug.jar` 和 `ShellServlet.java` 文件。`plugin_shellplug.jar` 是一个 Confluence 插件，提供了一个基于 Web 的 shell 接口，允许在服务器上执行命令行命令。`ShellServlet.java` 是该插件的反编译代码。如果攻击者成功利用 CVE-2023-22515 创建了管理员帐户，他们可以使用 Confluence 的 Web 管理 GUI 安装此恶意插件。插件安装后，攻击者可以通过 Web 界面执行任意命令，从而实现远程代码执行。

投毒风险评估：
*   `exploit.py`：虽然此脚本本身是漏洞利用工具，但并非恶意代码。0%
*   `plugin_shellplug.jar` 和 `ShellServlet.java`：这些文件包含一个 Web shell 插件，允许远程代码执行。这部分代码存在潜在的投毒风险。100%。此代码虽然是后门,但是否是作者本人添加存在争议,所以评估为投毒风险.

综合考虑，仓库整体的投毒风险评估为20%。虽然 `exploit.py` 本身没有投毒风险，但其中包含的 `plugin_shellplug.jar` 及其反编译的 `ShellServlet.java` 文件引入了远程代码执行的后门，如果使用者不加分析直接使用，可能会导致更大的安全风险。

**利用方式：**
1.  **检查目标 Confluence 实例是否易受攻击：** 通过访问 `/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false` 检查 Confluence 是否处于未完成设置的状态。
2.  **创建管理员帐户：** 如果 Confluence 处于未完成设置的状态，则使用 `exploit.py` 脚本通过向 `/setup/setupadministrator.action` 发送 POST 请求来创建一个新的管理员帐户。
3.  **登录 Confluence：** 使用新创建的管理员帐户登录 Confluence。
4.  **安装恶意插件：** 在 Confluence 的 Web 管理 GUI 中安装 `plugin_shellplug.jar` 插件。
5.  **执行任意命令：** 通过插件提供的 Web shell 界面执行任意命令，从而实现远程代码执行。

**项目地址:** [AIex-3/confluence-hack](https://github.com/AIex-3/confluence-hack)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #2

**来源**: [CVE-2023-22515-Arkha-Corvus_LetsDefend-SOC235-Atlassian-Confluence-Broken-Access-Control-0-Day-CVE-2023-22515-EventID-197.md](../2023/CVE-2023-22515-Arkha-Corvus_LetsDefend-SOC235-Atlassian-Confluence-Broken-Access-Control-0-Day-CVE-2023-22515-EventID-197.md)

## CVE-2023-22515-Atlassian Confluence 权限绕过

**漏洞编号:** CVE-2023-22515

**漏洞类型:** 权限绕过

**影响应用:** Atlassian Confluence Data Center/Server

**危害等级:** 高危，允许未经身份验证的攻击者创建管理员账户

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence Server/Data Center实例可公开访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22515是一个Atlassian Confluence Server和Data Center中的权限绕过漏洞。未经身份验证的攻击者可以利用此漏洞通过发送特制的GET请求到`/serverinfo.action?bootstrapStatusProvider.applicationConfig.setupComplete=false`端点，绕过初始设置向导，并创建具有管理员权限的账户。提供的漏洞利用代码展示了一个攻击示例，其中外部IP地址尝试访问Confluence服务器上的特定端点，以尝试获得未经授权的管理员访问权限。日志分析表明，如果请求返回200状态码，则攻击可能已成功执行。根据提供的代码，没有发现投毒的迹象，因为代码旨在展示如何检测和响应漏洞利用，而不是包含恶意负载。

**漏洞利用方式：**

1.  攻击者发送一个GET请求到目标Confluence服务器的`/serverinfo.action?bootstrapStatusProvider.applicationConfig.setupComplete=false`端点。
2.  如果服务器易受攻击，并且尚未完成初始设置，它将返回一个允许攻击者创建管理员账户的响应。
3.  攻击者随后利用这个机会创建一个新的管理员账户，从而获得对Confluence实例的完全控制权。
4.  在获取管理员权限后，攻击者可以安装后门，横向移动，或窃取数据。

**项目地址:** [Arkha-Corvus/LetsDefend-SOC235-Atlassian-Confluence-Broken-Access-Control-0-Day-CVE-2023-22515-EventID-197](https://github.com/Arkha-Corvus/LetsDefend-SOC235-Atlassian-Confluence-Broken-Access-Control-0-Day-CVE-2023-22515-EventID-197)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #3

**来源**: [CVE-2023-22515-C1ph3rX13_CVE-2023-22515.md](../2023/CVE-2023-22515-C1ph3rX13_CVE-2023-22515.md)

## CVE-2023-22515-Confluence-Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** Critical，未经身份验证的远程攻击者可以创建 Confluence 管理员账户并访问 Confluence 实例。

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence Data Center 和 Server 实例可以公开访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22515 是 Atlassian Confluence Data Center 和 Server 中的一个严重漏洞，属于 Broken Access Control。未经身份验证的攻击者可以通过发送特制的请求绕过身份验证机制，从而创建未经授权的 Confluence 管理员账户。漏洞利用方式如下：

1.  **利用方式：**
    *   攻击者首先访问 `/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false` 路径，该路径用于判断 Confluence 是否完成设置。
    *   如果未完成设置（即 `setupComplete=false`），攻击者可以访问 `/setup/setupadministrator.action` 路径，创建一个新的管理员账户。
    *   POC 代码通过生成随机用户名和密码，然后使用 POST 请求将这些信息发送到 `/setup/setupadministrator.action`。
    *   创建管理员账户后，POC 代码尝试访问 `/setup/finish` 完成安装。

2.  **有效性评估：**
    *   根据漏洞库信息、搜索引擎结果和提供的 POC 代码，该漏洞利用方式是有效的。多个来源都证实了该漏洞的存在和利用方式，并且 CISA 已将其列入已知被利用的漏洞目录。

3.  **投毒风险评估：**
    *   提供的 Go 语言 POC 代码主要功能是利用该漏洞创建管理员账户。投毒风险评估较低，但是依旧存在风险.
    *  `generateRandomString` 函数，虽然目的是生成随机用户名和密码，理论上存在被替换为恶意字符串的可能。虽然看似无害，但如果生成的用户名或密码被恶意构造，例如包含特定字符以触发后续的漏洞(例如SQL注入，虽然该CVE本身不是SQL注入), 这也是一种投毒方式。 这方面可能性评估：5%
    *  日志记录和错误处理：如果日志记录被修改，可能会隐藏攻击痕迹或者泄漏敏感信息。虽然可能性较小，但仍然需要注意。这方面可能性评估：5%
    *   总体评估：10%

4.  **结论：**
    *   CVE-2023-22515 是一个关键漏洞，需要立即修补。提供的 POC 代码可以有效利用该漏洞，但也需要仔细审查以确保其安全性。

**项目地址:** [C1ph3rX13/CVE-2023-22515](https://github.com/C1ph3rX13/CVE-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #4

**来源**: [CVE-2023-22515-CalegariMindSec_Exploit-CVE-2023-22515.md](../2023/CVE-2023-22515-CalegariMindSec_Exploit-CVE-2023-22515.md)

## CVE-2023-22515-Atlassian Confluence Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，允许未经身份验证的远程攻击者创建管理员账户并完全控制Confluence实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence实例对外开放，且未进行相关修复

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22515是一个存在于Atlassian Confluence Data Center和Server中的严重Broken Access Control漏洞。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞允许未经身份验证的攻击者通过访问`/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false`端点，重置Confluence的安装状态，然后通过向`/setup/setupadministrator.action`端点发送包含用户名、密码等信息的POST请求，创建一个新的管理员账户。该漏洞利用的有效性很高，因为公开的POC代码能够成功创建一个新的管理员账户。搜索结果也表明，该漏洞已被广泛利用。

**投毒风险分析：**
该POC代码主要包含一个bash脚本`xpl.sh`和一个说明文件`README.md`。`xpl.sh`脚本的功能是检测目标Confluence实例是否存在漏洞，并利用该漏洞创建一个新的管理员账户。脚本中定义了默认的用户名`a123456`和密码`ChangeMe123`。投毒风险主要体现在以下几个方面：

1.  **默认用户名和密码：** 攻击者可能修改脚本中的默认用户名和密码，诱导用户使用该脚本，从而在目标系统上创建一个攻击者已知的管理员账户。虽然用户可以修改这些值，但并非所有用户都会这样做，这使得攻击者有机会利用默认凭据进行进一步的攻击。
2.  **网络请求的潜在篡改：** 攻击者可能修改脚本中的curl命令，例如，添加额外的请求头或修改请求体，从而在利用漏洞的同时，向攻击者的服务器发送敏感信息或执行其他恶意操作。虽然目前脚本中的curl命令看起来比较简单，但攻击者可以很容易地对其进行修改，以实现更复杂的攻击目的。
3. **脚本本身的安全风险:** 脚本中使用的`curl -k`参数会忽略SSL证书验证，这可能导致中间人攻击。虽然这本身不是投毒，但增加了使用脚本的风险。此外，恶意作者可以在脚本中添加其他恶意代码，例如下载和执行其他恶意文件。

综合考虑以上因素，该POC代码存在一定的投毒风险，大约为10%。

**利用方式：**
1.  攻击者首先需要确定目标Confluence实例的版本是否在受影响的范围内。
2.  攻击者使用POC脚本`xpl.sh`，并提供目标Confluence实例的URL作为参数。
3.  脚本首先通过访问`/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false`端点来检查目标实例是否存在漏洞。
4.  如果目标实例存在漏洞，脚本将通过向`/setup/setupadministrator.action`端点发送POST请求来创建一个新的管理员账户。
5.  攻击者使用新创建的管理员账户登录Confluence实例，并获得完全控制权限。

**项目地址:** [CalegariMindSec/Exploit-CVE-2023-22515](https://github.com/CalegariMindSec/Exploit-CVE-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #5

**来源**: [CVE-2023-22515-Chocapikk_CVE-2023-22515.md](../2023/CVE-2023-22515-Chocapikk_CVE-2023-22515.md)

## CVE-2023-22515-Atlassian Confluence-Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，允许未授权用户创建管理员账户并访问Confluence实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence实例公开可访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-22515是一个Atlassian Confluence Server和Data Center中的一个严重漏洞，属于Broken Access Control类型。攻击者无需身份验证，即可通过该漏洞创建未经授权的Confluence管理员账户，从而完全控制Confluence实例。

**有效性：**
根据漏洞库信息、搜索结果以及漏洞利用代码，该漏洞利用的有效性较高。搜索结果中CISA发布了安全公告，多家安全厂商也发布了漏洞分析报告，表明该漏洞已被广泛利用。漏洞利用代码也提供了normal和mass两种模式，支持单个目标和批量目标利用。

**投毒风险：**
分析提供的POC代码，投毒风险较低。代码主要功能是触发漏洞，创建管理员账号并进行验证。虽然存在修改目标系统行为的操作，但没有发现明显恶意代码（例如反弹shell，安装后门等）。代码中requests库的使用存在一定风险，攻击者可能通过控制DNS等方式进行中间人攻击。综上所述，判定投毒风险为1%。

**利用方式：**
1.  攻击者向存在漏洞的Confluence实例发送特制的HTTP请求。
2.  该请求利用了Confluence中存在的Broken Access Control漏洞，绕过身份验证。
3.  成功绕过身份验证后，攻击者可以创建一个新的Confluence管理员账户。
4.  利用新创建的管理员账户，攻击者可以登录Confluence并执行各种管理操作，例如读取、修改或删除数据，甚至执行任意代码。

**项目地址:** [Chocapikk/CVE-2023-22515](https://github.com/Chocapikk/CVE-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #6

**来源**: [CVE-2023-22515-CyberSentinel321_cve-2023-22515-lab.md](../2023/CVE-2023-22515-CyberSentinel321_cve-2023-22515-lab.md)

## CVE-2023-22515-Confluence Authentication Bypass

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Authentication Bypass

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** Critical，未经授权的管理员权限访问和潜在的远程代码执行

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** 公开可访问的 Confluence Server 或 Data Center 实例

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

根据提供的文件，这是一个 CVE-2023-22515 的 PoC 实验环境。尽管给出了目录结构，但文件内容大多为空或者缺失，无法直接分析具体利用方式。漏洞库信息表明这是一个未授权的身份验证绕过漏洞，允许攻击者创建未经授权的 Confluence 管理员账户。利用方式很可能涉及发送特制的 HTTP 请求到 Confluence 服务器，绕过身份验证检查，创建一个新的管理员账户，然后使用该账户登录。根据提供的 PoC 代码片段（虽然不完整），`/exploit/exploit.sh` 可能是利用脚本，但由于文件内容为空，无法进一步分析其具体实现。由于缺少关键代码，此 PoC 的有效性存疑。该仓库包含LICENSE, README.md文件，看似比较正式，但关键代码缺失，作者可能是想通过这种方式来传播恶意代码，或者为了引流，所以存在一定的投毒风险。 无法确定server目录下js文件内容,如果存在未知的后门或恶意逻辑，可能会对受害者系统造成危害. 投毒风险预估为 60%。如果服务器本身存在后门，则可能会被判定为是利用，所以不判定为投毒。

**项目地址:** [CyberSentinel321/cve-2023-22515-lab](https://github.com/CyberSentinel321/cve-2023-22515-lab)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #7

**来源**: [CVE-2023-22515-DsaHen_cve-2023-22515-exp.md](../2023/CVE-2023-22515-DsaHen_cve-2023-22515-exp.md)

## CVE-2023-22515-Confluence-Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，未经身份验证的攻击者可以创建 Confluence 管理员帐户并访问 Confluence 实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence Data Center 和 Server 实例必须公开访问，且未完成初始化设置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22515 是 Atlassian Confluence Data Center 和 Server 中的一个严重漏洞，属于访问控制错误。未经身份验证的远程攻击者可以利用此漏洞创建未经授权的 Confluence 管理员帐户，从而完全控制受影响的 Confluence 实例。

**有效性分析：**

根据漏洞信息、搜索结果以及提供的漏洞利用代码，该漏洞的利用具有较高的有效性。

*   **漏洞信息：** CVE 信息明确指出这是一个 Broken Access Control 漏洞，且有实际利用案例。
*   **搜索结果：** 搜索结果显示，该漏洞已被广泛讨论和利用，多个安全厂商发布了相关报告和预警，CISA也将此漏洞收录到KEV。
*   **漏洞利用代码：** 提供的 Python 脚本 `cve-2023-22515.py` 实现了创建管理员帐户的功能，通过发送特定的 HTTP 请求到未完成设置的 Confluence 实例，可以绕过身份验证，创建新的管理员帐户。

**投毒风险分析：**

*   **README.md:**  `README.md` 文件描述了脚本的使用方法，没有发现可疑代码。
*   **cve-2023-22515.py:**  `cve-2023-22515.py` 主要功能是利用 Confluence 的未授权初始化设置接口创建管理员账号。代码逻辑较为清晰，主要包含以下步骤：
    1.  `request_1` 函数：用于检测 Confluence 实例是否处于未初始化状态 (`/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false`)，检查是否存在漏洞。
    2.  `request_2` 函数：通过 POST 请求向 `/setup/setupadministrator.action` 发送用户名、密码和邮箱等信息，创建管理员帐户。
    3.  `request_3` 函数：通过 POST 请求向 `/setup/finishsetup.action` 发送请求，完成设置。
代码中使用了 `requests` 库发送 HTTP 请求，并设置了一些常用的 Header。变量 `headers1`, `headers2`, `headers3` 中未发现恶意代码。 脚本通过参数 `-H`, `-U`, `-PW`, `-E`, `-P` 接受用户指定的 URL、用户名、密码、邮箱和代理设置，增强了脚本的灵活性。

综合来看，此脚本主要功能是利用漏洞创建管理员，但依然存在一定的投毒风险，例如：

*   **代理劫持风险：** 脚本支持代理设置 (`-P` 或 `--proxies`)。如果攻击者提供恶意代理服务器，可能会导致流量劫持或中间人攻击。
*   **依赖包风险：** 虽然代码本身没有明显的恶意行为，但如果 `requests` 或 `tld` 等依赖库被恶意篡改，同样可能引入安全风险。

因此，**投毒风险评估为 10%**。主要是考虑到用户可能会使用恶意代理或者依赖包存在被篡改的可能性。

**利用方式：**

1.  **目标检测：** 攻击者首先需要找到存在漏洞且未完成初始化的 Confluence Data Center 或 Server 实例。通过访问 `/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false` 接口，如果返回状态码为 200，则表明目标可能存在漏洞。
2.  **创建管理员帐户：** 攻击者使用漏洞利用脚本，指定目标 Confluence 实例的 URL，并提供用户名、密码和邮箱等信息。脚本会向 `/setup/setupadministrator.action` 接口发送 POST 请求，创建新的管理员帐户。
3.  **完成初始化设置：** 脚本会向 `/setup/finishsetup.action` 接口发送 POST 请求，完成 Confluence 的初始化设置。
4.  **登录和控制：** 攻击者使用新创建的管理员帐户登录 Confluence，获得管理员权限，从而可以完全控制 Confluence 实例。

**项目地址:** [DsaHen/cve-2023-22515-exp](https://github.com/DsaHen/cve-2023-22515-exp)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #8

**来源**: [CVE-2023-22515-ErikWynter_CVE-2023-22515-Scan.md](../2023/CVE-2023-22515-ErikWynter_CVE-2023-22515-Scan.md)

## CVE-2023-22515-Atlassian Confluence-Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，可能导致未授权访问和远程代码执行

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** 目标Confluence实例可公开访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22515是一个Atlassian Confluence Data Center和Server中的一个严重漏洞，它属于权限控制缺失类型。未经身份验证的远程攻击者可以通过利用此漏洞创建未经授权的Confluence管理员帐户，从而完全控制受影响的Confluence实例。

**有效性:**

根据提供的漏洞库信息、搜索结果（特别是[webpage 6]）以及大量安全厂商的分析，此漏洞的PoC代码是有效的。该漏洞已经被积极利用，且CISA已将其添加到已知被利用漏洞目录中。

**投毒风险:**

提供的漏洞利用代码片段仅包含GNU GPL许可证，不包含任何可执行代码，因此无法直接评估投毒风险。但是从github上下载的exp，需要仔细核查，**不排除**作者在其他文件中隐藏恶意代码的可能性，但就提供的LICENSE文件内容判断，投毒风险较低。保守估计投毒风险为0%。

**利用方式:**

根据漏洞描述，攻击者可以未经身份验证地创建Confluence管理员帐户。可能的利用方式是：

1.  **发送恶意请求：** 攻击者构造特定的HTTP请求，绕过身份验证检查。
2.  **创建管理员账户：**  通过恶意请求，在Confluence实例中创建一个新的管理员账户。
3.  **接管系统：** 使用新创建的管理员账户登录，完全控制Confluence实例，可以进行包括读取敏感数据、修改配置、安装恶意插件甚至执行任意代码等操作。

**项目地址:** [ErikWynter/CVE-2023-22515-Scan](https://github.com/ErikWynter/CVE-2023-22515-Scan)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #9

**来源**: [CVE-2023-22515-INTfinityConsulting_cve-2023-22515.md](../2023/CVE-2023-22515-INTfinityConsulting_cve-2023-22515.md)

## CVE-2023-22515 - Confluence 破损的访问控制

**漏洞编号:** CVE-2023-22515

**漏洞类型:** 破损的访问控制

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 严重，允许未授权的远程攻击者创建 Confluence 管理员账户并访问 Confluence 实例，最终导致远程代码执行。

**影响版本:** 受影响版本：8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence 实例需公开访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-22515 是 Atlassian Confluence Server 和 Data Center 中的一个破损的访问控制漏洞。该漏洞允许未经身份验证的攻击者创建未授权的 Confluence 管理员帐户，从而获得对 Confluence 实例的完全控制权。利用方式如下：

1.  **绕过初始化设置：** 攻击者发送一个 GET 请求到 `/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false`，使 Confluence 实例重新进入引导模式（bootstrap mode）。
2.  **创建管理员账户：** 攻击者使用 POST 请求向 `/setup/setupadministrator.action` 端点发送包含新管理员账户信息的请求，从而创建一个新的管理员账户。
3.  **完成引导过程：** 攻击者使用 POST 请求向 `/setup/finishsetup.action` 端点发送请求，完成引导过程。
4.  **获取 UPM Token：** 使用新创建的管理员账户的凭据进行 base64 编码，并通过 Basic 认证向 `/rest/plugins/1.0/?os_authType=basic` 发送 GET 请求，获取 UPM（Universal Plugin Manager）token。
5.  **上传恶意插件：** 攻击者使用获取的 UPM token，通过 POST 请求将包含恶意代码的插件上传到 `/rest/plugins/1.0/?token=<UPM_TOKEN>` 端点。
6.  **远程代码执行：** 恶意插件被安装后，其中的代码可以在 Confluence 服务器上执行，实现远程代码执行。

**有效性：** 根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断该POC代码是有效的。搜索结果中许多文章都提到了该漏洞被积极利用，并且提供了利用脚本的链接。提供的 Python 脚本实现了创建管理员账户并上传恶意插件以实现 RCE 的过程。

**投毒风险：** 漏洞利用代码包含两个 Python 脚本（CVE-2023-22515.py 和 confluence-client.py）以及一些插件相关的配置文件。主要的风险点在于上传的插件 (`logger-1.0.0-SNAPSHOT.jar`)。虽然提供了构建插件所需的 pom.xml 和一些其他文件，但**无法完全确定**该插件中是否包含作者隐藏的恶意代码。CVE-2023-22515.py本身的作用是创建一个新的管理员用户，并上传jar插件。confluence-client.py 用于与上传的恶意plugin进行交互，执行命令。LICENSE和README只是插件的辅助描述文件，不包含恶意代码。因此投毒的风险主要集中在 jar文件本身, 考虑jar文件需要进行二次开发，存在一定门槛，因此投毒风险为20%。

**利用方式：** 该漏洞的利用方式是未经授权创建管理员账户，然后利用管理员权限上传恶意插件以实现远程代码执行。

**项目地址:** [INTfinityConsulting/cve-2023-22515](https://github.com/INTfinityConsulting/cve-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #10

**来源**: [CVE-2023-22515-Le1a_CVE-2023-22515.md](../2023/CVE-2023-22515-Le1a_CVE-2023-22515.md)

## CVE-2023-22515-Confluence-Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center & Server

**危害等级:** 高危，允许未经身份验证的攻击者创建管理员账户

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence实例可以公开访问，且未完成初始化设置

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22515是一个Atlassian Confluence Data Center和Server中的一个严重漏洞，属于权限控制缺失类型。未经身份验证的远程攻击者可以通过利用/server-info.action端点判断Confluence是否已经初始化，如果未初始化，可以通过/setup/setupadministrator.action端点创建新的管理员账户。利用方式如下：

1.  **检测是否可利用：**  访问`/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false`，如果返回未完成设置的状态，则存在漏洞。
2.  **创建管理员账户：**  向`/setup/setupadministrator.action`发送POST请求，包含`username`、`fullName`、`email`、`password`和`confirm`参数，创建一个新的管理员账户。
3.  **完成设置：** 向 `/setup/finishsetup.action` 发送POST请求，完成安装。

提供的POC代码`CVE-2023-22515.py`实现了上述步骤，可以有效利用该漏洞。

**投毒风险分析：**

查看了`CVE-2023-22515.py`和`README.md`的内容，没有发现明显的恶意代码或者后门。该脚本的主要功能是自动化创建管理员账户，并没有执行任何与系统安全相关的敏感操作，例如文件读写、命令执行等。此外，`README.md`文件只是简单的介绍了漏洞和使用方法，也未发现任何可疑之处。综上所述，此仓库中存在作者隐藏的投毒代码的可能性极低，接近于0%。

**项目地址:** [Le1a/CVE-2023-22515](https://github.com/Le1a/CVE-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #11

**来源**: [CVE-2023-22515-LucasPDiniz_CVE-2023-22515.md](../2023/CVE-2023-22515-LucasPDiniz_CVE-2023-22515.md)

## CVE-2023-22515 - Atlassian Confluence Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，允许未授权用户创建管理员账户并完全控制Confluence实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence实例可以公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22515是一个存在于Atlassian Confluence Server和Data Center版本中的严重漏洞。未经身份验证的攻击者可以利用此漏洞重新进入Confluence的设置阶段，并创建一个新的管理员帐户，从而完全控制受影响的Confluence实例。

**漏洞利用方式：**

1.  攻击者向目标Confluence服务器发送特制的HTTP请求，该请求包含恶意的URL参数，以重置Confluence的安装状态。具体来说，攻击者访问`server-info.action`端点，并使用链式getter/setter操作将`bootstrapStatusProvider.applicationConfig.setupComplete`设置为`false`。

    ```
    http://<Confluence_URL>/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false
    ```

2.  成功执行此请求后，Confluence服务器将返回到初始设置页面，允许攻击者创建一个新的管理员帐户。
3.  攻击者访问`/setup/setupadministrator-start.action`端点，并按照设置流程创建一个新的管理员账户。
4.  使用新创建的管理员账户登录Confluence实例，并获得完全控制权限。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断此漏洞的POC代码是有效的。 搜索引擎结果中明确指出存在CVE-2023-22515的公开可用的利用脚本，并且多个安全厂商的文章和CISA的公告都确认了该漏洞的严重性和利用的广泛性。 提供的POC代码的README文件也详细描述了漏洞原理和利用方法。

**投毒风险：**

代码仓库`/tmp/9ac8e2d80e235c23c13ad9b691c524a1/README.md` 仅包含漏洞的描述和利用说明。漏洞本身不需要上传恶意文件，也没有迹象表明作者在利用代码中加入了隐藏的、恶意的功能。但仍需注意，从非官方渠道下载的任何漏洞利用代码都存在一定的风险。 由于只是一个说明文件，没有可以执行的代码。因此，投毒风险较低，大约为10%。 这个风险主要来自下载来源的不确定性，以及将来可能被替换或修改为恶意版本。

**项目地址:** [LucasPDiniz/CVE-2023-22515](https://github.com/LucasPDiniz/CVE-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #12

**来源**: [CVE-2023-22515-Onedy1703_CVE-2023-22515-Confluence.md](../2023/CVE-2023-22515-Onedy1703_CVE-2023-22515-Confluence.md)

## CVE-2023-22515-Atlassian Confluence Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，可创建未授权的管理员账户，完全控制Confluence实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence实例可公开访问且未完成初始化配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-22515是一个存在于Atlassian Confluence Server和Data Center中的严重Broken Access Control漏洞。未经身份验证的攻击者可以利用此漏洞创建未经授权的Confluence管理员帐户，从而完全控制受影响的Confluence实例。

**有效性分析：**
根据漏洞库信息和搜索结果，该漏洞已经被积极利用。提供的POC代码是一个Nmap脚本，用于检测和利用该漏洞。脚本通过以下步骤尝试利用漏洞：

1.  **检测安装向导状态：** 检查`/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false`是否返回200，判断Confluence是否处于未完成设置的状态。
2.  **注册管理员账户：** 如果处于未完成设置的状态，脚本会向`/setup/setupadministrator.action`发送POST请求，尝试注册一个管理员账户（用户名、密码等硬编码为"admin"）。同时附加header `X-Atlassian-Token: no-check`绕过token验证。
3.  **完成设置：**  向`/setup/finishsetup.action`发送POST请求，尝试完成安装设置
4.  **验证：** 检查注册管理员请求(`/setup/setupadministrator.action`)是否返回302重定向以及完成设置请求(`/setup/finishsetup.action`)是否返回200，以确认漏洞是否成功利用。

该POC代码的利用方式是利用Confluence未完成初始化配置时的安全缺陷，绕过权限检查，创建管理员账户。

**投毒风险分析：**
该仓库包含一个README.md和一个Nmap脚本myscrypt.nse。
*   **README.md：** 声明该仓库是教育目的，并提示用户注意执行文件的风险。这本身不构成投毒，但表明作者已知潜在风险。
*   **myscrypt.nse：** Nmap脚本的代码相对简单，主要功能是检测和利用CVE-2023-22515。代码中没有发现明显的恶意行为，如植入后门或执行其他未授权操作。但是，该脚本会尝试创建一个硬编码凭据（用户名：admin，密码：admin）的管理员帐户。如果攻击者成功利用此脚本，则创建的帐户本身可以被视为后门。投毒风险较低，大约为5%，因为主要风险是利用漏洞本身，而非植入额外恶意代码。

**漏洞利用方式总结：**
1.  漏洞存在于Confluence Server和Data Center版本中。
2.  漏洞允许未经身份验证的远程攻击者创建管理员账户。
3.  漏洞利用的前提是Confluence实例可以公开访问，并且尚未完成初始化设置。
4.  攻击者可以通过发送特制的HTTP请求到`/setup/setupadministrator.action`来创建管理员账户，然后使用`/setup/finishsetup.action`完成安装。
5.  成功利用此漏洞将导致完全控制受影响的Confluence实例。

**项目地址:** [Onedy1703/CVE-2023-22515-Confluence](https://github.com/Onedy1703/CVE-2023-22515-Confluence)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #13

**来源**: [CVE-2023-22515-Vulnmachines_confluence-cve-2023-22515.md](../2023/CVE-2023-22515-Vulnmachines_confluence-cve-2023-22515.md)

## CVE-2023-22515 - Atlassian Confluence Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，允许未经身份验证的攻击者创建Confluence管理员帐户并访问Confluence实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence实例可公开访问，且未完成初始化设置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-22515 是 Atlassian Confluence Data Center 和 Server 中的一个严重漏洞，属于 Broken Access Control 类型。根据漏洞信息，未经身份验证的远程攻击者可以通过利用此漏洞创建未经授权的 Confluence 管理员帐户，从而完全控制 Confluence 实例。

**漏洞利用方式：**

1.  **检查安装状态：**  攻击者首先发送一个GET请求到 `/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false` 以确定Confluence是否尚未完成设置。
2.  **创建管理员帐户：** 如果步骤 1 返回 `setupComplete=false`，表明Confluence尚未设置管理员帐户。然后，攻击者发送一个POST请求到 `/setup/setupadministrator.action`，其中包含用于创建管理员帐户的用户名、全名、电子邮件地址、密码和确认密码等信息。攻击者可以指定他们想要的任何凭据。
3.  **完成设置（可选）：** 攻击者可以选择发送一个POST请求到`/setup/finishsetup.action`来完成设置向导。

**有效性：**

提供的 POC 代码描述了利用此漏洞的步骤，并且根据搜索结果显示，该漏洞已被积极利用，因此POC代码是有效的。

**投毒风险：**

提供的POC代码非常简单，仅包含利用漏洞的步骤。该仓库只包含了README.md和payload文件，内容是漏洞利用的步骤，并无其他可疑代码。虽然不能完全排除投毒风险，但存在的可能性很低。判断投毒风险为 5%.

**总结：**

此漏洞利用简单，风险极高。攻击者可以无需任何身份验证，直接创建一个管理员账户，从而完全控制 Confluence 服务器。强烈建议受影响的用户尽快升级到不受影响的版本。

**项目地址:** [Vulnmachines/confluence-cve-2023-22515](https://github.com/Vulnmachines/confluence-cve-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #14

**来源**: [CVE-2023-22515-aaaademo_Confluence-EvilJar.md](../2023/CVE-2023-22515-aaaademo_Confluence-EvilJar.md)

## CVE-2023-22515-Confluence-Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control/RCE

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，可导致未授权访问和远程代码执行

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence 实例可以公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22515 是 Atlassian Confluence Data Center 和 Server 中的一个严重漏洞，允许未经身份验证的远程攻击者创建未经授权的 Confluence 管理员帐户，最终实现远程代码执行。该漏洞是由于不正确的访问控制导致的。

**有效性：**
根据漏洞库信息、搜索结果（尤其是 github 链接）以及提供的漏洞利用代码，可以判断该漏洞的 POC 代码是有效的。许多安全厂商和研究人员都发布了关于该漏洞的报告和利用方法，并且 CISA 将其列入已知被利用的漏洞目录中，确认该漏洞在野外已被利用。

**投毒风险：**
提供的 POC 代码包含一个 Maven 项目，用于构建一个恶意的 Confluence 插件（JAR 文件）。该插件包含三个 Servlet：`cmServlet`（CMDshell）、`gzServlet` (哥斯拉 webshell) 和 `bxServlet`。这些 Servlet 允许攻击者在 Confluence 服务器上执行任意命令。投毒风险较低，因为：
*   代码相对简单，易于审查。
*   明显的功能是创建 webshell，这本身就是恶意行为。
*   没有发现隐藏的、不相关的或者难以理解的代码。
但是，仍然存在一定的投毒风险，因为攻击者可能会在 `CommandExecutor.java` 或其他地方添加难以察觉的后门代码。因此，将投毒风险评估为 10%。

**利用方式：**
1.  攻击者首先利用 CVE-2023-22515 漏洞创建一个 Confluence 管理员帐户，无需任何身份验证。
2.  使用创建的管理员帐户登录 Confluence 管理控制台。
3.  上传并安装恶意插件（JAR 文件），这个恶意插件包含了 webshell。
4.  通过访问恶意插件提供的 webshell，攻击者可以在 Confluence 服务器上执行任意命令。

具体来说，`README.md` 文件中描述了两种 webshell 的连接方式：
*   **CMDshell:** 访问 `http://confluence.local/plugins/servlet/testbin/cmServlet` 可以直接执行命令。
*   **哥斯拉 webshell:** 访问 `http://confluence.local/plugins/servlet/testbin/gzServlet`，使用 `Referer: https://www.baidu.com/` 作为 header，密码为 `p@ssw0rd`，key 为 `key`，即可连接哥斯拉 webshell。

**项目地址:** [aaaademo/Confluence-EvilJar](https://github.com/aaaademo/Confluence-EvilJar)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #15

**来源**: [CVE-2023-22515-ad-calcium_CVE-2023-22515.md](../2023/CVE-2023-22515-ad-calcium_CVE-2023-22515.md)

## CVE-2023-22515-Confluence 破损的访问控制

**漏洞编号:** CVE-2023-22515

**漏洞类型:** 破损的访问控制

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，可能导致未授权的管理员账户创建和远程代码执行

**影响版本:** 8.0.0 <= version <= 8.0.4
8.1.0 <= version <= 8.1.4
8.2.0 <= version <= 8.2.3
8.3.0 <= version <= 8.3.2
8.4.0 <= version <= 8.4.2
8.5.0 <= version <= 8.5.1

**利用条件:** 目标Confluence实例对外开放，且未完成初始化设置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22515 是一个存在于 Atlassian Confluence Data Center 和 Server 中的破损的访问控制漏洞。未经身份验证的攻击者可以利用此漏洞创建未经授权的 Confluence 管理员帐户，从而完全控制受影响的 Confluence 实例。

**漏洞利用方式:**

1.  **检查安装状态:** 通过访问 `/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false` 接口判断 Confluence 是否已完成安装。如果返回包含 "Confluence" 字符串的页面，则表示可能存在漏洞。
2.  **创建管理员账户:**  通过向 `/setup/setupadministrator.action` 接口发送 POST 请求，并附带包含用户名、密码等信息的 payload 来创建新的管理员账户。请求头中需要包含 `X-Atlassian-Token: no-check`。
3.  **完成设置:** 通过向 `/setup/finishsetup.action` 接口发送 POST 请求，以完成设置过程。

**POC 代码分析:**

提供的 POC 代码 (main.go) 使用 Go 语言编写，实现了以下功能：

*   允许指定目标 Confluence 实例的 URL、用户名和密码。
*   如果未指定用户名和密码，则生成随机的用户名和密码。
*   检查 Confluence 的安装状态。
*   发送 POST 请求以创建管理员账户。
*   发送 POST 请求以完成设置。
*   支持通过代理服务器进行利用。

**投毒风险分析:**

POC 代码本身看起来比较直接，主要是实现漏洞利用，风险较低。但是，依旧存在一定的投毒风险，主要体现在：
* 依赖引入风险：代码中import了一些Go标准库，但如果攻击者修改代码，引入恶意的第三方库，则存在投毒的可能。
* 代码逻辑修改风险：攻击者可能修改代码，添加额外的操作，例如在成功创建管理员账户后，执行一些恶意操作，如上传 webshell 或修改系统配置。

综上，虽然POC代码本身的功能比较明确，但是仍然存在被植入恶意代码的风险，因此给出10%的投毒风险评估。

**项目地址:** [ad-calcium/CVE-2023-22515](https://github.com/ad-calcium/CVE-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #16

**来源**: [CVE-2023-22515-edsonjt81_CVE-2023-22515-Scan..md](../2023/CVE-2023-22515-edsonjt81_CVE-2023-22515-Scan..md)

## CVE-2023-22515-Atlassian Confluence-Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，未经身份验证的远程攻击者可以创建 Confluence 管理员帐户并访问 Confluence 实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence Data Center and Server实例可以公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22515是一个Atlassian Confluence Data Center和Server中的严重漏洞，属于权限控制缺失类型。攻击者无需身份验证，即可通过发送特制的请求，创建未授权的Confluence管理员账户，从而完全控制受影响的Confluence实例。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开可用的PoC利用代码。例如，Github上存在名为`CVE-2023-22515`的项目，证实了漏洞的可利用性。

**投毒风险：**
提供的漏洞利用代码仅包含GNU GPL协议声明，缺少实际的漏洞利用脚本，无法判断是否存在恶意代码。因此，假设该代码仓库包含其他利用脚本的可能性为10%。

**利用方式：**
1.  **漏洞发现：** 攻击者发现目标Confluence服务器存在CVE-2023-22515漏洞。
2.  **构造恶意请求：** 攻击者构造特定的HTTP请求，绕过Confluence的访问控制机制。
3.  **创建管理员账户：** 恶意请求成功后，攻击者可以在Confluence系统中创建一个新的管理员账户。
4.  **控制Confluence：** 使用新创建的管理员账户登录Confluence，获得完全控制权限，包括读取、修改、删除数据，甚至执行任意代码。

**项目地址:** [edsonjt81/CVE-2023-22515-Scan.](https://github.com/edsonjt81/CVE-2023-22515-Scan.)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #17

**来源**: [CVE-2023-22515-fyx1t_NSE--CVE-2023-22515.md](../2023/CVE-2023-22515-fyx1t_NSE--CVE-2023-22515.md)

## CVE-2023-22515-Confluence-Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，允许未经身份验证的远程攻击者创建 Confluence 管理员帐户，并完全控制 Confluence 实例。

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence Data Center 和 Server 实例必须可公开访问且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22515 是 Atlassian Confluence Data Center 和 Server 中的一个严重漏洞，允许未经身份验证的远程攻击者利用Broken Access Control漏洞创建未经授权的 Confluence 管理员帐户。 根据CISA信息，该漏洞已经被实际利用。

**漏洞利用方式：**
1.  攻击者首先发送一个 GET 请求到 `/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false`，该请求用于检查 Confluence 是否已完成设置。
2.  如果 Confluence 未完成设置（状态码为 200），攻击者会发送一个 POST 请求到 `/setup/setupadministrator.action`，并在请求体中包含要创建的管理员帐户的用户名、全名、电子邮件和密码。
3.  最后，攻击者发送一个 POST 请求到 `/setup/finishsetup.action` 以完成设置过程。成功后，攻击者即可使用新创建的管理员帐户登录 Confluence 并完全控制该实例。

**有效性：** 提供的 NSE 脚本 (cve-2023-22515.nse) 旨在检测目标主机是否存在 CVE-2023-22515 漏洞，并尝试利用该漏洞创建管理员账户。

**投毒风险：** 查看提供的 NSE 脚本，该脚本的功能是利用漏洞创建管理员账户以验证漏洞是否存在。该脚本本身并不包含任何恶意或隐藏的投毒代码，只是模拟了攻击过程来检查漏洞。因此，该仓库中存在作者隐藏的投毒代码的可能性极低，评估为0%。

**项目地址:** [fyx1t/NSE--CVE-2023-22515](https://github.com/fyx1t/NSE--CVE-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #18

**来源**: [CVE-2023-22515-iveresk_CVE-2023-22515.md](../2023/CVE-2023-22515-iveresk_CVE-2023-22515.md)

## CVE-2023-22515-Atlassian Confluence-Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，可创建未授权的Confluence管理员账户并完全控制Confluence实例。

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** 目标Confluence实例需要公开可访问，且版本位于受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22515 是一个存在于 Atlassian Confluence Data Center 和 Server 中的严重漏洞。攻击者可以通过未经身份验证的访问，利用该漏洞创建未经授权的 Confluence 管理员账户，从而完全控制受影响的 Confluence 实例。 

**利用方式：**

1.  **绕过身份验证:** 攻击者利用`/server-info.action`接口，通过设置`bootstrapStatusProvider.applicationConfig.setupComplete`参数为`false`，重置 Confluence 的安装状态。
2.  **创建管理员账户:**  在安装状态被重置后，攻击者通过访问`/setup/setupadministrator.action`接口，并提交包含用户名、密码等信息的 POST 请求，创建一个新的管理员账户。由于安装状态被重置，该过程无需任何身份验证。
3.  **完成安装:** 攻击者通过访问`/setup/finishsetup.action`接口，完成 Confluence 的安装流程，使新创建的管理员账户生效。

**POC有效性：**

提供的POC脚本 `cve-2023-22515.sh` 实现了上述利用方式。脚本首先检查目标是否存在，然后通过curl命令发送HTTP请求，重置安装状态、创建管理员账户并完成安装。 该POC脚本的有效性较高，因为它的逻辑与公开的漏洞利用方式一致，并且可以自动化漏洞利用过程。

**投毒风险：**

虽然脚本主体实现了漏洞利用逻辑，但仍然存在一定的投毒风险。风险主要来源于以下几个方面：

*   **默认用户名密码：** 脚本默认使用 `adm1n` 作为用户名和密码。如果攻击者修改了脚本，并使用更复杂的密码，可能会导致被攻击者难以发现新的管理员账户。
*   **文件读取的潜在风险：** 脚本中存在从文件读取IP地址的逻辑 (`while read LINE; do ... done <$IP`)。如果攻击者能够控制该文件的内容，可能会执行恶意命令。虽然此处的变量`$IP`很可能是一个笔误，应该是`$TARGET`，但不能排除被利用的风险。
*   **CURL参数的修改风险：** 攻击者可能会修改curl命令的参数，例如添加 `--proxy` 参数，将流量转发到恶意服务器，从而窃取敏感信息。或者将 `email=haxor%40localhost` 修改为其他钓鱼邮件。

综合来看，投毒风险约为 10%。该风险主要来源于脚本中可能存在的恶意修改或参数注入，而非脚本本身的漏洞利用逻辑。

**项目地址:** [iveresk/CVE-2023-22515](https://github.com/iveresk/CVE-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #19

**来源**: [CVE-2023-22515-j3seer_CVE-2023-22515-POC.md](../2023/CVE-2023-22515-j3seer_CVE-2023-22515-POC.md)

## CVE-2023-22515 Atlassian Confluence 权限提升/未授权管理员创建漏洞

**漏洞编号:** CVE-2023-22515

**漏洞类型:** 权限提升/Broken Access Control

**影响应用:** Atlassian Confluence Data Center/Server

**危害等级:** 高危，允许未授权用户创建管理员账户，完全控制 Confluence 实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence 实例可以公开访问，并且未完成初始化设置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22515 漏洞是一个 Atlassian Confluence Server 和 Data Center 实例上的严重权限提升漏洞。未经身份验证的攻击者可以利用此漏洞创建未经授权的 Confluence 管理员帐户并访问 Confluence 实例。

**漏洞利用方式：**

1.  **绕过安全检查:** 通过 `server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false`  设置 `setupComplete`  为 `false`，绕过 Confluence 的安装设置检查。
2.  **创建管理员账户:** 利用 `/setup/setupadministrator.action`  端点，创建一个新的管理员账户。攻击者可以指定用户名、全名、邮箱和密码。
3.  **完成安装设置:** 利用 `/setup/finishsetup.action`  端点，完成安装设置。
4.  **XSRF 绕过:** 使用 `X-Atlassian-Token: no-check`  header 绕过跨站请求伪造 (XSRF) 保护。

**有效性：**

提供的 YAML 文件和 README.md 描述了一种有效的攻击方式。多个搜索结果也表明该漏洞已被积极利用。

**投毒风险：**

该漏洞利用代码的仓库中未发现明显的投毒代码。YAML 文件和 README.md 仅包含漏洞利用的必要步骤和信息。没有任何迹象表明作者试图隐藏恶意代码或后门。

**漏洞分析:**

该漏洞的根本原因是 Confluence 在初始化设置过程中，存在不安全的访问控制。攻击者可以通过操纵特定的 HTTP 请求参数，绕过安全检查，从而创建管理员账户。`Xwork interceptors`解析参数的特性,使得攻击者可以利用`set`和`get`方法,结合`X-Atlassian-Token`绕过XSRF,最终利用`/setup/*`创建管理员.


**项目地址:** [j3seer/CVE-2023-22515-POC](https://github.com/j3seer/CVE-2023-22515-POC)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #20

**来源**: [CVE-2023-22515-joaoviictorti_CVE-2023-22515.md](../2023/CVE-2023-22515-joaoviictorti_CVE-2023-22515.md)

## CVE-2023-22515-Atlassian Confluence-Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，允许未经身份验证的攻击者创建Confluence管理员账户，进而可能导致完全控制Confluence实例。

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** 目标Confluence实例需公开可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22515是一个严重的Broken Access Control漏洞，影响Atlassian Confluence Data Center和Server。根据漏洞库信息、搜索结果和提供的漏洞利用代码，评估结果如下：

**有效性：**
搜索引擎结果显示，CVE-2023-22515漏洞已被积极利用。多个安全厂商和CISA均发布了关于此漏洞的警告，并确认了漏洞的严重性和可利用性。GitHub上存在公开可用的POC利用代码，进一步佐证了漏洞的有效性。综合来看，该漏洞利用的有效性高。

**投毒风险：**
提供的代码片段`Cargo.lock`是Rust项目的依赖锁定文件，它本身不包含可执行代码，因此直接在此文件中进行投毒的可能性较低。但是，存在通过篡改Cargo.lock文件，指定恶意的依赖版本，从而间接引入包含恶意代码的依赖项的风险。此风险较低，约 10%。

**利用方式：**
该漏洞允许未经身份验证的远程攻击者创建未经授权的Confluence管理员帐户。这通常通过发送特制的HTTP请求到Confluence服务器来实现，绕过身份验证检查，直接在系统中注册一个新的管理员用户。成功创建管理员账户后，攻击者可以使用该账户登录Confluence，并获得对系统的完全控制权限，包括读取、修改和删除数据，以及执行任意代码。

总而言之，CVE-2023-22515是一个高危漏洞，利用简单，影响范围广。建议受影响的用户尽快升级到不受影响的版本。

**项目地址:** [joaoviictorti/CVE-2023-22515](https://github.com/joaoviictorti/CVE-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #21

**来源**: [CVE-2023-22515-kh4sh3i_CVE-2023-22515.md](../2023/CVE-2023-22515-kh4sh3i_CVE-2023-22515.md)

## CVE-2023-22515 Atlassian Confluence 权限提升

**漏洞编号:** CVE-2023-22515

**漏洞类型:** 权限提升/Broken Access Control

**影响应用:** Atlassian Confluence Data Center 和 Server

**危害等级:** 严重，未授权的攻击者可以创建管理员账户并访问 Confluence 实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence 实例可以公开访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22515 是 Atlassian Confluence Data Center 和 Server 中的一个权限提升漏洞。攻击者可以通过利用 `/setup/setupadministrator-start.action` 和 `/setup/setupadministrator.action` 接口，在未授权的情况下创建一个 Confluence 管理员账户。漏洞利用方式如下：

1.  **绕过设置完成检查：** 通过访问 `/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=0` 接口，将 Confluence 标记为未完成设置。
2.  **访问管理员设置页面：** 访问 `/setup/setupadministrator-start.action` 接口，进入管理员设置页面。
3.  **创建管理员账户：** 通过 POST 请求向 `/setup/setupadministrator.action` 接口发送包含用户名、密码和邮箱等信息的表单数据，创建一个新的管理员账户。
4.  **登录：** 使用新创建的管理员账户登录 Confluence。

提供的 Nuclei YAML 模板 `CVE-2023-22515.yaml` 实现了上述攻击流程，通过多个 HTTP 请求模拟攻击者的行为，验证漏洞的存在。代码没有发现存在恶意行为，因此判断不存在投毒风险，投毒风险比例为0%。根据CISA的公告，该漏洞已被积极利用，因此确定提供的POC代码是有效的。

**项目地址:** [kh4sh3i/CVE-2023-22515](https://github.com/kh4sh3i/CVE-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #22

**来源**: [CVE-2023-22515-killvxk_CVE-2023-22515-joaoviictorti.md](../2023/CVE-2023-22515-killvxk_CVE-2023-22515-joaoviictorti.md)

## CVE-2023-22515-Atlassian Confluence-Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 严重，可能导致未经授权的管理员帐户创建和远程代码执行

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence实例对外可访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-22515是一个Atlassian Confluence Data Center和Server中的严重漏洞，它允许未经身份验证的远程攻击者创建未经授权的Confluence管理员帐户并访问Confluence实例。根据搜索引擎结果，该漏洞已被积极利用。漏洞利用方式是攻击者可以重新启用初始设置过程，从而获得创建新管理员帐户的能力。

**有效性：** 基于漏洞库信息和搜索引擎结果，该漏洞影响多个Confluence版本，且存在公开可用的利用代码，已经被CISA列入已知被利用的漏洞目录(KEV)，因此可以判断漏洞利用有效。

**投毒风险：** 提供的漏洞利用代码是一个Rust Cargo.lock文件，用于记录项目依赖的确切版本。分析该文件本身无法直接判断是否存在投毒代码。Cargo.lock文件只是依赖管理文件，实际的投毒可能存在于项目依赖的源代码中。 由于文件较长，人工审计所有依赖项的安全性是不现实的。但是，根据经验，虽然不能完全排除投毒的可能性，但直接在Cargo.lock文件中进行投毒的概率极低。所以投毒风险预估为1%。

**利用方式：** 攻击者利用该漏洞可以绕过身份验证，重新触发Confluence的安装向导，创建一个新的管理员帐户。然后，他们可以使用该帐户访问Confluence实例并执行任意操作，例如读取敏感数据、修改系统配置或执行恶意代码。

**项目地址:** [killvxk/CVE-2023-22515-joaoviictorti](https://github.com/killvxk/CVE-2023-22515-joaoviictorti)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #23

**来源**: [CVE-2023-22515-rxerium_CVE-2023-22515.md](../2023/CVE-2023-22515-rxerium_CVE-2023-22515.md)

## CVE-2023-22515 - Atlassian Confluence 权限绕过/未授权管理员创建

**漏洞编号:** CVE-2023-22515

**漏洞类型:** 权限绕过/未授权访问

**影响应用:** Atlassian Confluence Data Center/Server

**危害等级:** 高危，允许未授权用户创建管理员账户并完全控制Confluence实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence实例公开可访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-22515 是 Atlassian Confluence Data Center 和 Server 中一个严重的权限绕过漏洞。未经身份验证的攻击者可以利用此漏洞创建未经授权的 Confluence 管理员帐户，从而完全控制受影响的 Confluence 实例。

**有效性：**
根据漏洞信息和搜索结果，该漏洞已被积极利用，并且存在公开可用的PoC利用代码。提供的Nuclei模板用于检测易受攻击的Confluence版本，可以辅助验证漏洞的存在。

**投毒风险：**
提供的Nuclei模板主要用于漏洞检测，其目的是确定Confluence实例是否运行着易受攻击的版本。该模板通过发送HTTP GET请求到Confluence服务器的不同端点（/dologin.action, /, /pages, /confluence, /wiki），并从响应体中提取版本信息。然后，它会将提取的版本与已知的易受攻击的版本列表进行匹配。如果版本匹配，则认为该实例存在漏洞。

分析了该代码，发现投毒风险较低，约为 5%。主要原因如下：
*   **Nuclei 模板的性质：** Nuclei 模板主要设计用于检测漏洞，而不是利用漏洞。它的核心功能是发送请求并根据响应进行匹配，而不是执行恶意操作。
*   **代码的可见性：** 模板代码是公开的，易于审查。任何潜在的恶意代码都会很容易被发现。
*   **模板的简单性：** 该模板的功能相对简单，主要涉及发送 HTTP 请求和进行正则匹配。这降低了隐藏恶意代码的可能性。

然而，仍然存在一些微小的风险：
*   **依赖风险：** Nuclei 依赖于外部库和环境。如果 Nuclei 本身存在漏洞，或者其依赖项被篡改，可能会导致恶意代码的执行。
*   **配置错误风险：** 如果用户配置 Nuclei 不当，例如允许其执行任意代码，可能会增加风险。

总的来说，提供的 Nuclei 模板用于检测 CVE-2023-22515 漏洞的风险相对较低，因为它主要用于漏洞检测，而不是利用。

**利用方式：**
1.  **漏洞发现：** 使用提供的Nuclei模板或其他漏洞扫描工具识别存在CVE-2023-22515漏洞的Confluence实例。
2.  **管理员账户创建：** 攻击者发送特制的HTTP请求到Confluence服务器，绕过身份验证机制，创建一个新的管理员账户。
3.  **权限获取：** 使用新创建的管理员账户登录Confluence，获得对系统的完全控制权。
4.  **恶意行为：** 攻击者可以利用管理员权限执行任意操作，例如：
    *   窃取敏感数据
    *   篡改数据
    *   安装恶意软件
    *   进行拒绝服务攻击

**项目地址:** [rxerium/CVE-2023-22515](https://github.com/rxerium/CVE-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #24

**来源**: [CVE-2023-22515-s1d6point7bugcrowd_CVE-2023-22515-check.md](../2023/CVE-2023-22515-s1d6point7bugcrowd_CVE-2023-22515-check.md)

## CVE-2023-22515 Atlassian Confluence 破损的访问控制

**漏洞编号:** CVE-2023-22515

**漏洞类型:** 破损的访问控制

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，可能导致未授权管理员账户创建和远程代码执行

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence实例对外开放，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22515是一个存在于Atlassian Confluence Data Center和Server中的破损的访问控制漏洞。未经身份验证的攻击者可以通过此漏洞创建未经授权的Confluence管理员账户，并访问Confluence实例。根据漏洞库信息和搜索结果，该漏洞影响Confluence Data Center和Server 8.0.0到8.5.1之间的多个版本。提供的漏洞利用代码是一个检测脚本，用于确定Confluence实例是否容易受到攻击，而不是直接利用漏洞。它首先检查Confluence版本，然后尝试通过POST请求将应用设置为设置模式(setup mode)。如果版本在受影响范围内，并且成功设置了设置模式，则认为该实例易受攻击。

**有效性：**
该POC的有效性取决于目标Confluence实例的版本和是否能成功触发setup mode。如果目标版本在受影响范围内，且可以设置为setup mode，则该脚本能有效识别漏洞的存在，但它本身**不能直接利用漏洞**创建管理员账户。 该脚本只起到验证是否存在漏洞。

**投毒风险：**
该存储库存在投毒风险的可能性较低，约为10%。 原因是：
1. 该代码主要功能是版本检测和setup mode设置，没有执行恶意操作。
2.  虽然`X-Custom-Header`可用于识别用户，理论上存在追踪行为，但是此行为不属于后门或者恶意行为，所以投毒风险较低。

**利用方式：**
1.  **版本检测:**  利用脚本或者手动访问`login.action`页面，通过正则表达式提取Confluence版本号。
2.  **Setup Mode检查:** 发送POST请求到`/server-info.action`，设置`bootstrapStatusProvider.applicationConfig.setupComplete`为`false`尝试进入Setup Mode。
3.  **创建管理员账号:** 如果成功进入Setup Mode，即可创建新的管理员账户，从而控制Confluence实例。需要注意，提供的代码**不包含**创建管理员账户的步骤，只是检测漏洞是否存在。

**项目地址:** [s1d6point7bugcrowd/CVE-2023-22515-check](https://github.com/s1d6point7bugcrowd/CVE-2023-22515-check)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #25

**来源**: [CVE-2023-22515-sincere9_CVE-2023-22515.md](../2023/CVE-2023-22515-sincere9_CVE-2023-22515.md)

## CVE-2023-22515-Confluence-Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，允许未授权用户创建管理员账户，完全控制Confluence实例

**影响版本:** 8.0.0 <= version <= 8.5.1 (受影响版本不包括 8.3.3, 8.4.3, 8.5.2)

**利用条件:** Confluence实例可以公开访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-22515是一个Atlassian Confluence Server和Data Center中的Broken Access Control漏洞。未经身份验证的攻击者可以利用此漏洞创建未授权的Confluence管理员账户。 

**利用方式：**

1.  **检查漏洞是否存在：** 通过访问`/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false`页面来判断Confluence是否已完成初始化设置，如果返回包含"success"，则可能存在漏洞。
2.  **创建管理员账户：** 如果系统未完成设置，攻击者可以发送POST请求到`/setup/setupadministrator.action`，设置用户名、密码和邮箱等信息，创建一个新的管理员账户。
3.  **完成设置：** 创建管理员账户后，发送POST请求到`/setup/finishsetup.action`来完成设置。

**POC有效性：**

根据漏洞信息和利用代码，提供的POC代码有效。它可以自动化创建管理员账号的过程，从而验证漏洞的存在。

**投毒风险：**

虽然POC代码本身的功能是利用漏洞创建管理员账号，但我们需要评估是否存在作者隐藏的恶意代码。审查发现，代码主要功能为发送HTTP请求，生成随机用户名密码，没有发现明显的恶意行为，投毒风险极低,风险评估为1%。风险主要来源于对目标URL的误用和依赖库的安全。

**搜索引擎结果：**

搜索结果表明CVE-2023-22515是一个高危漏洞，被广泛利用。CISA也发布了相关的安全公告，敦促用户尽快修复。

**项目地址:** [sincere9/CVE-2023-22515](https://github.com/sincere9/CVE-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #26

**来源**: [CVE-2023-22515-spareack_CVE-2023-22515-NSE.md](../2023/CVE-2023-22515-spareack_CVE-2023-22515-NSE.md)

## CVE-2023-22515-Atlassian Confluence Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危，可能导致未经授权的管理员账户创建和系统完全控制

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** 目标Confluence实例必须公开可访问且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22515 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的远程攻击者创建未经授权的管理员帐户，从而完全控制受影响的 Confluence 实例。

**有效性：**

提供的 Nmap NSE 脚本 POC 代码有效。它通过发送请求到易受攻击的端点并分析响应来检查漏洞的存在。

**投毒风险：**

投毒风险评估为10%。虽然提供的代码主要用于检测漏洞，但存在细微的风险，恶意攻击者可能修改该脚本以包含在成功利用后执行恶意操作的代码。 例如，该脚本可能会被修改为静默地安装后门或收集敏感信息。然而，这种风险较低，因为核心功能是漏洞检测。

**利用方式：**

1.  **绕过身份验证：** 攻击者无需任何凭据即可与 Confluence 服务器进行交互。
2.  **重置安装状态：** 攻击者发送一个请求到 `bootstrapStatusProvider.applicationConfig.setupComplete=false`  端点，有效地将 Confluence 实例重置到未安装状态。
3.  **创建管理员账户：** 攻击者发送一个 POST 请求到 `/setup/setupadministrator.action` 端点，创建一个新的管理员账户。
4.  **完全控制：** 使用新创建的管理员账户，攻击者可以登录并完全控制 Confluence 服务器，包括访问敏感数据，修改配置以及执行任意代码。

**总结：**

该漏洞的利用非常简单，只需要几个 HTTP 请求即可。POC 代码的存在使得利用更加容易。 由于该漏洞允许完全控制受影响的系统，因此具有很高的风险。 建议受影响的用户尽快升级到已修复的版本。

**参考资料：**

*   CISA 建议：[https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-289a](https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-289a)
*   Rapid7 分析：[https://www.rapid7.com/blog/post/2023/10/04/etr-cve-2023-22515-zero-day-privilege-escalation-in-confluence-server-and-data-center/](https://www.rapid7.com/blog/post/2023/10/04/etr-cve-2023-22515-zero-day-privilege-escalation-in-confluence-server-and-data-center/)
*   Qualys 分析：[https://blog.qualys.com/vulnerabilities-threat-research/2023/11/15/atlassian-confluence-broken-access-control-vulnerability-cve-2023-22515](https://blog.qualys.com/vulnerabilities-threat-research/2023/11/15/atlassian-confluence-broken-access-control-vulnerability-cve-2023-22515)


**项目地址:** [spareack/CVE-2023-22515-NSE](https://github.com/spareack/CVE-2023-22515-NSE)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #27

**来源**: [CVE-2023-22515-vivigotnotime_CVE-2023-22515-Exploit-Script.md](../2023/CVE-2023-22515-vivigotnotime_CVE-2023-22515-Exploit-Script.md)

## CVE-2023-22515 - Atlassian Confluence Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 严重，允许未经身份验证的攻击者创建管理员帐户并完全控制受影响的实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence Server 或 Data Center 实例必须是公开可访问的，且位于受影响的版本范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-22515 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，属于未授权访问控制漏洞。未经身份验证的远程攻击者可以利用此漏洞在受影响的 Confluence 实例上创建未经授权的 Confluence 管理员帐户，从而获得对 Confluence 实例的完全控制权。

**漏洞利用方式：**

1.  **触发漏洞:** 首先，攻击者通过访问 `/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false` URL 来触发漏洞，该操作会将 Confluence 实例置于未设置完成的状态。
2.  **创建管理员帐户:** 然后，攻击者通过向 `/setup/setupadministrator.action` 发送 POST 请求，利用未授权访问控制漏洞创建一个新的管理员帐户。POST 请求包含用户名、密码和电子邮件等管理员帐户的信息。
3.  **身份验证:** 最后，攻击者使用新创建的管理员帐户登录 Confluence 实例，并获得完全的管理权限。

**投毒风险分析：**

提供的PoC代码主要功能是利用漏洞创建管理员账户，并未发现直接的恶意代码或后门植入行为。PoC代码虽然在创建管理员账户后，会将服务器、用户名和密码写入文件。这个行为本身不属于投毒，但如果该文件被泄露，可能会造成安全风险。 此外，该PoC使用了一些常用的库如`requests`, `rich`, `alive-progress`, `fire`，这些库本身被投毒的可能性较低，但需要确保从官方源安装，避免使用来源不明的第三方库。

因此，综合评估认为此仓库中存在作者隐藏的投毒代码的可能性较低，大约为5%。

**总结：**

此漏洞利用代码针对 CVE-2023-22515 进行了自动化利用，允许未经身份验证的攻击者创建管理员帐户。利用过程简单，只需要目标实例存在漏洞即可。该漏洞的风险极高，建议受影响的用户尽快升级到安全版本。

**项目地址:** [vivigotnotime/CVE-2023-22515-Exploit-Script](https://github.com/vivigotnotime/CVE-2023-22515-Exploit-Script)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #28

**来源**: [CVE-2023-22515-xorbbo_cve-2023-22515.md](../2023/CVE-2023-22515-xorbbo_cve-2023-22515.md)

## CVE-2023-22515 - Atlassian Confluence Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，允许未授权用户创建管理员账户，可能导致完全控制 Confluence 实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence 实例需要公开可访问，且未完成初始化配置（setupComplete = false）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-22515 漏洞是一个严重的权限绕过漏洞，影响 Atlassian Confluence Data Center 和 Server 实例。未经身份验证的攻击者可以通过该漏洞创建未经授权的 Confluence 管理员帐户，从而完全控制 Confluence 实例。

**利用方式：**

1.  **重置设置状态：** 攻击者发送一个GET请求到`/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false`。 这个请求会将 Confluence 实例重置到设置模式，即使它已经被设置过。
2.  **创建管理员账户：** 攻击者然后发送一个POST请求到`/setup/setupadministrator.action`，其中包含新管理员帐户的用户名、密码和电子邮件信息。该请求中的`X-Atlassian-Token: no-check` header用于绕过CSRF保护。
3.  **完成设置:** 攻击者发送一个POST请求到 `/setup/finishsetup.action`来关闭 Confluence的配置完成提示。

**POC有效性：**

提供的 POC 代码（包括 Burp Suite 请求示例和 Nmap NSE 脚本）看起来有效。它包含了利用该漏洞所需的步骤：首先通过 `/server-info.action` 接口将 Confluence 置于未安装状态，然后利用 `/setup/setupadministrator.action` 接口创建管理员用户，最后利用`/setup/finishsetup.action`接口关闭提示信息。

**投毒风险：**

投毒风险较低 (5%)。 虽然任何第三方提供的代码都存在潜在风险，但此处的代码相对简单且直接地实现了漏洞利用。主要风险在于攻击者可能会修改 Nmap 脚本或 Burp Suite 请求以包含其他恶意操作，例如安装后门、上传 webshell 或收集敏感信息。 但从目前的代码来看，没有明显的恶意代码。

**缓解措施：**

*   尽快升级到不受影响的 Confluence 版本（8.3.3 及更高版本，8.4.3 及更高版本，8.5.2 及更高版本）。
*   如果无法立即升级，请参考 Atlassian 官方指南采取临时缓解措施。
*   监控 Confluence 实例中是否存在未经授权的管理员帐户。
*   限制对 Confluence 实例的网络访问。

**项目地址:** [xorbbo/cve-2023-22515](https://github.com/xorbbo/cve-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #29

**来源**: [CVE-2023-22515-youcannotseemeagain_CVE-2023-22515_RCE.md](../2023/CVE-2023-22515-youcannotseemeagain_CVE-2023-22515_RCE.md)

## CVE-2023-22515-Atlassian Confluence Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，允许未经身份验证的远程攻击者创建管理员帐户并完全控制Confluence实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence实例可以公开访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-22515是一个Atlassian Confluence Server和Data Center的严重漏洞，属于权限控制缺陷。

**有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞被广泛利用，允许未经身份验证的攻击者创建Confluence管理员帐户。搜索结果[6]指向GitHub上存在利用此漏洞的公开PoC。

**投毒风险：**
提供的漏洞利用代码描述了一种在获得后台权限后进行RCE的方式，通过上传恶意插件实现。此代码本身描述的是后渗透阶段的利用方法，不是漏洞触发点。其中展示了上传插件的截图，并访问特定的servlet来执行命令。该利用方式依赖于已经获取的管理员权限，漏洞利用代码仓库本身只包含图片和说明文档，通过上传恶意插件从而达到了RCE目的，投毒风险较低。由于利用方式较为直接，可以判断没有显著的投毒行为，但是不排除图片中引用的插件中包含恶意代码的可能性，因此存在一定风险。

**利用方式：**
1.  攻击者利用未授权访问漏洞(CVE-2023-22515)创建一个管理员账号。
2.  使用创建的管理员账号登录Confluence后台。
3.  在Confluence后台，攻击者上传一个恶意插件。
4.  通过访问恶意插件提供的Servlet接口（例如 `plugins/servlet/com.jsos.shell/ShellServlet`），执行任意代码。

此漏洞利用的核心在于首先获得管理员权限，然后通过上传恶意插件实现RCE。提供的代码只是RCE的步骤，而非获取管理员权限的PoC。

**项目地址:** [youcannotseemeagain/CVE-2023-22515_RCE](https://github.com/youcannotseemeagain/CVE-2023-22515_RCE)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---



---

## POC #8

**来源**: [CVE-2023-22515-ErikWynter_CVE-2023-22515-Scan.md](../2023/CVE-2023-22515-ErikWynter_CVE-2023-22515-Scan.md)

## CVE-2023-22515-Atlassian Confluence-Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，可能导致未授权访问和远程代码执行

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** 目标Confluence实例可公开访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22515是一个Atlassian Confluence Data Center和Server中的一个严重漏洞，它属于权限控制缺失类型。未经身份验证的远程攻击者可以通过利用此漏洞创建未经授权的Confluence管理员帐户，从而完全控制受影响的Confluence实例。

**有效性:**

根据提供的漏洞库信息、搜索结果（特别是[webpage 6]）以及大量安全厂商的分析，此漏洞的PoC代码是有效的。该漏洞已经被积极利用，且CISA已将其添加到已知被利用漏洞目录中。

**投毒风险:**

提供的漏洞利用代码片段仅包含GNU GPL许可证，不包含任何可执行代码，因此无法直接评估投毒风险。但是从github上下载的exp，需要仔细核查，**不排除**作者在其他文件中隐藏恶意代码的可能性，但就提供的LICENSE文件内容判断，投毒风险较低。保守估计投毒风险为0%。

**利用方式:**

根据漏洞描述，攻击者可以未经身份验证地创建Confluence管理员帐户。可能的利用方式是：

1.  **发送恶意请求：** 攻击者构造特定的HTTP请求，绕过身份验证检查。
2.  **创建管理员账户：**  通过恶意请求，在Confluence实例中创建一个新的管理员账户。
3.  **接管系统：** 使用新创建的管理员账户登录，完全控制Confluence实例，可以进行包括读取敏感数据、修改配置、安装恶意插件甚至执行任意代码等操作。

**项目地址:** [ErikWynter/CVE-2023-22515-Scan](https://github.com/ErikWynter/CVE-2023-22515-Scan)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #9

**来源**: [CVE-2023-22515-INTfinityConsulting_cve-2023-22515.md](../2023/CVE-2023-22515-INTfinityConsulting_cve-2023-22515.md)

## CVE-2023-22515 - Confluence 破损的访问控制

**漏洞编号:** CVE-2023-22515

**漏洞类型:** 破损的访问控制

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 严重，允许未授权的远程攻击者创建 Confluence 管理员账户并访问 Confluence 实例，最终导致远程代码执行。

**影响版本:** 受影响版本：8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence 实例需公开访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-22515 是 Atlassian Confluence Server 和 Data Center 中的一个破损的访问控制漏洞。该漏洞允许未经身份验证的攻击者创建未授权的 Confluence 管理员帐户，从而获得对 Confluence 实例的完全控制权。利用方式如下：

1.  **绕过初始化设置：** 攻击者发送一个 GET 请求到 `/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false`，使 Confluence 实例重新进入引导模式（bootstrap mode）。
2.  **创建管理员账户：** 攻击者使用 POST 请求向 `/setup/setupadministrator.action` 端点发送包含新管理员账户信息的请求，从而创建一个新的管理员账户。
3.  **完成引导过程：** 攻击者使用 POST 请求向 `/setup/finishsetup.action` 端点发送请求，完成引导过程。
4.  **获取 UPM Token：** 使用新创建的管理员账户的凭据进行 base64 编码，并通过 Basic 认证向 `/rest/plugins/1.0/?os_authType=basic` 发送 GET 请求，获取 UPM（Universal Plugin Manager）token。
5.  **上传恶意插件：** 攻击者使用获取的 UPM token，通过 POST 请求将包含恶意代码的插件上传到 `/rest/plugins/1.0/?token=<UPM_TOKEN>` 端点。
6.  **远程代码执行：** 恶意插件被安装后，其中的代码可以在 Confluence 服务器上执行，实现远程代码执行。

**有效性：** 根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断该POC代码是有效的。搜索结果中许多文章都提到了该漏洞被积极利用，并且提供了利用脚本的链接。提供的 Python 脚本实现了创建管理员账户并上传恶意插件以实现 RCE 的过程。

**投毒风险：** 漏洞利用代码包含两个 Python 脚本（CVE-2023-22515.py 和 confluence-client.py）以及一些插件相关的配置文件。主要的风险点在于上传的插件 (`logger-1.0.0-SNAPSHOT.jar`)。虽然提供了构建插件所需的 pom.xml 和一些其他文件，但**无法完全确定**该插件中是否包含作者隐藏的恶意代码。CVE-2023-22515.py本身的作用是创建一个新的管理员用户，并上传jar插件。confluence-client.py 用于与上传的恶意plugin进行交互，执行命令。LICENSE和README只是插件的辅助描述文件，不包含恶意代码。因此投毒的风险主要集中在 jar文件本身, 考虑jar文件需要进行二次开发，存在一定门槛，因此投毒风险为20%。

**利用方式：** 该漏洞的利用方式是未经授权创建管理员账户，然后利用管理员权限上传恶意插件以实现远程代码执行。

**项目地址:** [INTfinityConsulting/cve-2023-22515](https://github.com/INTfinityConsulting/cve-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #10

**来源**: [CVE-2023-22515-Le1a_CVE-2023-22515.md](../2023/CVE-2023-22515-Le1a_CVE-2023-22515.md)

## CVE-2023-22515-Confluence-Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center & Server

**危害等级:** 高危，允许未经身份验证的攻击者创建管理员账户

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence实例可以公开访问，且未完成初始化设置

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22515是一个Atlassian Confluence Data Center和Server中的一个严重漏洞，属于权限控制缺失类型。未经身份验证的远程攻击者可以通过利用/server-info.action端点判断Confluence是否已经初始化，如果未初始化，可以通过/setup/setupadministrator.action端点创建新的管理员账户。利用方式如下：

1.  **检测是否可利用：**  访问`/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false`，如果返回未完成设置的状态，则存在漏洞。
2.  **创建管理员账户：**  向`/setup/setupadministrator.action`发送POST请求，包含`username`、`fullName`、`email`、`password`和`confirm`参数，创建一个新的管理员账户。
3.  **完成设置：** 向 `/setup/finishsetup.action` 发送POST请求，完成安装。

提供的POC代码`CVE-2023-22515.py`实现了上述步骤，可以有效利用该漏洞。

**投毒风险分析：**

查看了`CVE-2023-22515.py`和`README.md`的内容，没有发现明显的恶意代码或者后门。该脚本的主要功能是自动化创建管理员账户，并没有执行任何与系统安全相关的敏感操作，例如文件读写、命令执行等。此外，`README.md`文件只是简单的介绍了漏洞和使用方法，也未发现任何可疑之处。综上所述，此仓库中存在作者隐藏的投毒代码的可能性极低，接近于0%。

**项目地址:** [Le1a/CVE-2023-22515](https://github.com/Le1a/CVE-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #11

**来源**: [CVE-2023-22515-LucasPDiniz_CVE-2023-22515.md](../2023/CVE-2023-22515-LucasPDiniz_CVE-2023-22515.md)

## CVE-2023-22515 - Atlassian Confluence Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，允许未授权用户创建管理员账户并完全控制Confluence实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence实例可以公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22515是一个存在于Atlassian Confluence Server和Data Center版本中的严重漏洞。未经身份验证的攻击者可以利用此漏洞重新进入Confluence的设置阶段，并创建一个新的管理员帐户，从而完全控制受影响的Confluence实例。

**漏洞利用方式：**

1.  攻击者向目标Confluence服务器发送特制的HTTP请求，该请求包含恶意的URL参数，以重置Confluence的安装状态。具体来说，攻击者访问`server-info.action`端点，并使用链式getter/setter操作将`bootstrapStatusProvider.applicationConfig.setupComplete`设置为`false`。

    ```
    http://<Confluence_URL>/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false
    ```

2.  成功执行此请求后，Confluence服务器将返回到初始设置页面，允许攻击者创建一个新的管理员帐户。
3.  攻击者访问`/setup/setupadministrator-start.action`端点，并按照设置流程创建一个新的管理员账户。
4.  使用新创建的管理员账户登录Confluence实例，并获得完全控制权限。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断此漏洞的POC代码是有效的。 搜索引擎结果中明确指出存在CVE-2023-22515的公开可用的利用脚本，并且多个安全厂商的文章和CISA的公告都确认了该漏洞的严重性和利用的广泛性。 提供的POC代码的README文件也详细描述了漏洞原理和利用方法。

**投毒风险：**

代码仓库`/tmp/9ac8e2d80e235c23c13ad9b691c524a1/README.md` 仅包含漏洞的描述和利用说明。漏洞本身不需要上传恶意文件，也没有迹象表明作者在利用代码中加入了隐藏的、恶意的功能。但仍需注意，从非官方渠道下载的任何漏洞利用代码都存在一定的风险。 由于只是一个说明文件，没有可以执行的代码。因此，投毒风险较低，大约为10%。 这个风险主要来自下载来源的不确定性，以及将来可能被替换或修改为恶意版本。

**项目地址:** [LucasPDiniz/CVE-2023-22515](https://github.com/LucasPDiniz/CVE-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #12

**来源**: [CVE-2023-22515-Onedy1703_CVE-2023-22515-Confluence.md](../2023/CVE-2023-22515-Onedy1703_CVE-2023-22515-Confluence.md)

## CVE-2023-22515-Atlassian Confluence Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，可创建未授权的管理员账户，完全控制Confluence实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence实例可公开访问且未完成初始化配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-22515是一个存在于Atlassian Confluence Server和Data Center中的严重Broken Access Control漏洞。未经身份验证的攻击者可以利用此漏洞创建未经授权的Confluence管理员帐户，从而完全控制受影响的Confluence实例。

**有效性分析：**
根据漏洞库信息和搜索结果，该漏洞已经被积极利用。提供的POC代码是一个Nmap脚本，用于检测和利用该漏洞。脚本通过以下步骤尝试利用漏洞：

1.  **检测安装向导状态：** 检查`/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false`是否返回200，判断Confluence是否处于未完成设置的状态。
2.  **注册管理员账户：** 如果处于未完成设置的状态，脚本会向`/setup/setupadministrator.action`发送POST请求，尝试注册一个管理员账户（用户名、密码等硬编码为"admin"）。同时附加header `X-Atlassian-Token: no-check`绕过token验证。
3.  **完成设置：**  向`/setup/finishsetup.action`发送POST请求，尝试完成安装设置
4.  **验证：** 检查注册管理员请求(`/setup/setupadministrator.action`)是否返回302重定向以及完成设置请求(`/setup/finishsetup.action`)是否返回200，以确认漏洞是否成功利用。

该POC代码的利用方式是利用Confluence未完成初始化配置时的安全缺陷，绕过权限检查，创建管理员账户。

**投毒风险分析：**
该仓库包含一个README.md和一个Nmap脚本myscrypt.nse。
*   **README.md：** 声明该仓库是教育目的，并提示用户注意执行文件的风险。这本身不构成投毒，但表明作者已知潜在风险。
*   **myscrypt.nse：** Nmap脚本的代码相对简单，主要功能是检测和利用CVE-2023-22515。代码中没有发现明显的恶意行为，如植入后门或执行其他未授权操作。但是，该脚本会尝试创建一个硬编码凭据（用户名：admin，密码：admin）的管理员帐户。如果攻击者成功利用此脚本，则创建的帐户本身可以被视为后门。投毒风险较低，大约为5%，因为主要风险是利用漏洞本身，而非植入额外恶意代码。

**漏洞利用方式总结：**
1.  漏洞存在于Confluence Server和Data Center版本中。
2.  漏洞允许未经身份验证的远程攻击者创建管理员账户。
3.  漏洞利用的前提是Confluence实例可以公开访问，并且尚未完成初始化设置。
4.  攻击者可以通过发送特制的HTTP请求到`/setup/setupadministrator.action`来创建管理员账户，然后使用`/setup/finishsetup.action`完成安装。
5.  成功利用此漏洞将导致完全控制受影响的Confluence实例。

**项目地址:** [Onedy1703/CVE-2023-22515-Confluence](https://github.com/Onedy1703/CVE-2023-22515-Confluence)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #13

**来源**: [CVE-2023-22515-Vulnmachines_confluence-cve-2023-22515.md](../2023/CVE-2023-22515-Vulnmachines_confluence-cve-2023-22515.md)

## CVE-2023-22515 - Atlassian Confluence Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，允许未经身份验证的攻击者创建Confluence管理员帐户并访问Confluence实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence实例可公开访问，且未完成初始化设置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-22515 是 Atlassian Confluence Data Center 和 Server 中的一个严重漏洞，属于 Broken Access Control 类型。根据漏洞信息，未经身份验证的远程攻击者可以通过利用此漏洞创建未经授权的 Confluence 管理员帐户，从而完全控制 Confluence 实例。

**漏洞利用方式：**

1.  **检查安装状态：**  攻击者首先发送一个GET请求到 `/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false` 以确定Confluence是否尚未完成设置。
2.  **创建管理员帐户：** 如果步骤 1 返回 `setupComplete=false`，表明Confluence尚未设置管理员帐户。然后，攻击者发送一个POST请求到 `/setup/setupadministrator.action`，其中包含用于创建管理员帐户的用户名、全名、电子邮件地址、密码和确认密码等信息。攻击者可以指定他们想要的任何凭据。
3.  **完成设置（可选）：** 攻击者可以选择发送一个POST请求到`/setup/finishsetup.action`来完成设置向导。

**有效性：**

提供的 POC 代码描述了利用此漏洞的步骤，并且根据搜索结果显示，该漏洞已被积极利用，因此POC代码是有效的。

**投毒风险：**

提供的POC代码非常简单，仅包含利用漏洞的步骤。该仓库只包含了README.md和payload文件，内容是漏洞利用的步骤，并无其他可疑代码。虽然不能完全排除投毒风险，但存在的可能性很低。判断投毒风险为 5%.

**总结：**

此漏洞利用简单，风险极高。攻击者可以无需任何身份验证，直接创建一个管理员账户，从而完全控制 Confluence 服务器。强烈建议受影响的用户尽快升级到不受影响的版本。

**项目地址:** [Vulnmachines/confluence-cve-2023-22515](https://github.com/Vulnmachines/confluence-cve-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #14

**来源**: [CVE-2023-22515-aaaademo_Confluence-EvilJar.md](../2023/CVE-2023-22515-aaaademo_Confluence-EvilJar.md)

## CVE-2023-22515-Confluence-Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control/RCE

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，可导致未授权访问和远程代码执行

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence 实例可以公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22515 是 Atlassian Confluence Data Center 和 Server 中的一个严重漏洞，允许未经身份验证的远程攻击者创建未经授权的 Confluence 管理员帐户，最终实现远程代码执行。该漏洞是由于不正确的访问控制导致的。

**有效性：**
根据漏洞库信息、搜索结果（尤其是 github 链接）以及提供的漏洞利用代码，可以判断该漏洞的 POC 代码是有效的。许多安全厂商和研究人员都发布了关于该漏洞的报告和利用方法，并且 CISA 将其列入已知被利用的漏洞目录中，确认该漏洞在野外已被利用。

**投毒风险：**
提供的 POC 代码包含一个 Maven 项目，用于构建一个恶意的 Confluence 插件（JAR 文件）。该插件包含三个 Servlet：`cmServlet`（CMDshell）、`gzServlet` (哥斯拉 webshell) 和 `bxServlet`。这些 Servlet 允许攻击者在 Confluence 服务器上执行任意命令。投毒风险较低，因为：
*   代码相对简单，易于审查。
*   明显的功能是创建 webshell，这本身就是恶意行为。
*   没有发现隐藏的、不相关的或者难以理解的代码。
但是，仍然存在一定的投毒风险，因为攻击者可能会在 `CommandExecutor.java` 或其他地方添加难以察觉的后门代码。因此，将投毒风险评估为 10%。

**利用方式：**
1.  攻击者首先利用 CVE-2023-22515 漏洞创建一个 Confluence 管理员帐户，无需任何身份验证。
2.  使用创建的管理员帐户登录 Confluence 管理控制台。
3.  上传并安装恶意插件（JAR 文件），这个恶意插件包含了 webshell。
4.  通过访问恶意插件提供的 webshell，攻击者可以在 Confluence 服务器上执行任意命令。

具体来说，`README.md` 文件中描述了两种 webshell 的连接方式：
*   **CMDshell:** 访问 `http://confluence.local/plugins/servlet/testbin/cmServlet` 可以直接执行命令。
*   **哥斯拉 webshell:** 访问 `http://confluence.local/plugins/servlet/testbin/gzServlet`，使用 `Referer: https://www.baidu.com/` 作为 header，密码为 `p@ssw0rd`，key 为 `key`，即可连接哥斯拉 webshell。

**项目地址:** [aaaademo/Confluence-EvilJar](https://github.com/aaaademo/Confluence-EvilJar)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #15

**来源**: [CVE-2023-22515-ad-calcium_CVE-2023-22515.md](../2023/CVE-2023-22515-ad-calcium_CVE-2023-22515.md)

## CVE-2023-22515-Confluence 破损的访问控制

**漏洞编号:** CVE-2023-22515

**漏洞类型:** 破损的访问控制

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，可能导致未授权的管理员账户创建和远程代码执行

**影响版本:** 8.0.0 <= version <= 8.0.4
8.1.0 <= version <= 8.1.4
8.2.0 <= version <= 8.2.3
8.3.0 <= version <= 8.3.2
8.4.0 <= version <= 8.4.2
8.5.0 <= version <= 8.5.1

**利用条件:** 目标Confluence实例对外开放，且未完成初始化设置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22515 是一个存在于 Atlassian Confluence Data Center 和 Server 中的破损的访问控制漏洞。未经身份验证的攻击者可以利用此漏洞创建未经授权的 Confluence 管理员帐户，从而完全控制受影响的 Confluence 实例。

**漏洞利用方式:**

1.  **检查安装状态:** 通过访问 `/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false` 接口判断 Confluence 是否已完成安装。如果返回包含 "Confluence" 字符串的页面，则表示可能存在漏洞。
2.  **创建管理员账户:**  通过向 `/setup/setupadministrator.action` 接口发送 POST 请求，并附带包含用户名、密码等信息的 payload 来创建新的管理员账户。请求头中需要包含 `X-Atlassian-Token: no-check`。
3.  **完成设置:** 通过向 `/setup/finishsetup.action` 接口发送 POST 请求，以完成设置过程。

**POC 代码分析:**

提供的 POC 代码 (main.go) 使用 Go 语言编写，实现了以下功能：

*   允许指定目标 Confluence 实例的 URL、用户名和密码。
*   如果未指定用户名和密码，则生成随机的用户名和密码。
*   检查 Confluence 的安装状态。
*   发送 POST 请求以创建管理员账户。
*   发送 POST 请求以完成设置。
*   支持通过代理服务器进行利用。

**投毒风险分析:**

POC 代码本身看起来比较直接，主要是实现漏洞利用，风险较低。但是，依旧存在一定的投毒风险，主要体现在：
* 依赖引入风险：代码中import了一些Go标准库，但如果攻击者修改代码，引入恶意的第三方库，则存在投毒的可能。
* 代码逻辑修改风险：攻击者可能修改代码，添加额外的操作，例如在成功创建管理员账户后，执行一些恶意操作，如上传 webshell 或修改系统配置。

综上，虽然POC代码本身的功能比较明确，但是仍然存在被植入恶意代码的风险，因此给出10%的投毒风险评估。

**项目地址:** [ad-calcium/CVE-2023-22515](https://github.com/ad-calcium/CVE-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #16

**来源**: [CVE-2023-22515-edsonjt81_CVE-2023-22515-Scan..md](../2023/CVE-2023-22515-edsonjt81_CVE-2023-22515-Scan..md)

## CVE-2023-22515-Atlassian Confluence-Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，未经身份验证的远程攻击者可以创建 Confluence 管理员帐户并访问 Confluence 实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence Data Center and Server实例可以公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22515是一个Atlassian Confluence Data Center和Server中的严重漏洞，属于权限控制缺失类型。攻击者无需身份验证，即可通过发送特制的请求，创建未授权的Confluence管理员账户，从而完全控制受影响的Confluence实例。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开可用的PoC利用代码。例如，Github上存在名为`CVE-2023-22515`的项目，证实了漏洞的可利用性。

**投毒风险：**
提供的漏洞利用代码仅包含GNU GPL协议声明，缺少实际的漏洞利用脚本，无法判断是否存在恶意代码。因此，假设该代码仓库包含其他利用脚本的可能性为10%。

**利用方式：**
1.  **漏洞发现：** 攻击者发现目标Confluence服务器存在CVE-2023-22515漏洞。
2.  **构造恶意请求：** 攻击者构造特定的HTTP请求，绕过Confluence的访问控制机制。
3.  **创建管理员账户：** 恶意请求成功后，攻击者可以在Confluence系统中创建一个新的管理员账户。
4.  **控制Confluence：** 使用新创建的管理员账户登录Confluence，获得完全控制权限，包括读取、修改、删除数据，甚至执行任意代码。

**项目地址:** [edsonjt81/CVE-2023-22515-Scan.](https://github.com/edsonjt81/CVE-2023-22515-Scan.)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #17

**来源**: [CVE-2023-22515-fyx1t_NSE--CVE-2023-22515.md](../2023/CVE-2023-22515-fyx1t_NSE--CVE-2023-22515.md)

## CVE-2023-22515-Confluence-Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，允许未经身份验证的远程攻击者创建 Confluence 管理员帐户，并完全控制 Confluence 实例。

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence Data Center 和 Server 实例必须可公开访问且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22515 是 Atlassian Confluence Data Center 和 Server 中的一个严重漏洞，允许未经身份验证的远程攻击者利用Broken Access Control漏洞创建未经授权的 Confluence 管理员帐户。 根据CISA信息，该漏洞已经被实际利用。

**漏洞利用方式：**
1.  攻击者首先发送一个 GET 请求到 `/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false`，该请求用于检查 Confluence 是否已完成设置。
2.  如果 Confluence 未完成设置（状态码为 200），攻击者会发送一个 POST 请求到 `/setup/setupadministrator.action`，并在请求体中包含要创建的管理员帐户的用户名、全名、电子邮件和密码。
3.  最后，攻击者发送一个 POST 请求到 `/setup/finishsetup.action` 以完成设置过程。成功后，攻击者即可使用新创建的管理员帐户登录 Confluence 并完全控制该实例。

**有效性：** 提供的 NSE 脚本 (cve-2023-22515.nse) 旨在检测目标主机是否存在 CVE-2023-22515 漏洞，并尝试利用该漏洞创建管理员账户。

**投毒风险：** 查看提供的 NSE 脚本，该脚本的功能是利用漏洞创建管理员账户以验证漏洞是否存在。该脚本本身并不包含任何恶意或隐藏的投毒代码，只是模拟了攻击过程来检查漏洞。因此，该仓库中存在作者隐藏的投毒代码的可能性极低，评估为0%。

**项目地址:** [fyx1t/NSE--CVE-2023-22515](https://github.com/fyx1t/NSE--CVE-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #18

**来源**: [CVE-2023-22515-iveresk_CVE-2023-22515.md](../2023/CVE-2023-22515-iveresk_CVE-2023-22515.md)

## CVE-2023-22515-Atlassian Confluence-Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，可创建未授权的Confluence管理员账户并完全控制Confluence实例。

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** 目标Confluence实例需要公开可访问，且版本位于受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22515 是一个存在于 Atlassian Confluence Data Center 和 Server 中的严重漏洞。攻击者可以通过未经身份验证的访问，利用该漏洞创建未经授权的 Confluence 管理员账户，从而完全控制受影响的 Confluence 实例。 

**利用方式：**

1.  **绕过身份验证:** 攻击者利用`/server-info.action`接口，通过设置`bootstrapStatusProvider.applicationConfig.setupComplete`参数为`false`，重置 Confluence 的安装状态。
2.  **创建管理员账户:**  在安装状态被重置后，攻击者通过访问`/setup/setupadministrator.action`接口，并提交包含用户名、密码等信息的 POST 请求，创建一个新的管理员账户。由于安装状态被重置，该过程无需任何身份验证。
3.  **完成安装:** 攻击者通过访问`/setup/finishsetup.action`接口，完成 Confluence 的安装流程，使新创建的管理员账户生效。

**POC有效性：**

提供的POC脚本 `cve-2023-22515.sh` 实现了上述利用方式。脚本首先检查目标是否存在，然后通过curl命令发送HTTP请求，重置安装状态、创建管理员账户并完成安装。 该POC脚本的有效性较高，因为它的逻辑与公开的漏洞利用方式一致，并且可以自动化漏洞利用过程。

**投毒风险：**

虽然脚本主体实现了漏洞利用逻辑，但仍然存在一定的投毒风险。风险主要来源于以下几个方面：

*   **默认用户名密码：** 脚本默认使用 `adm1n` 作为用户名和密码。如果攻击者修改了脚本，并使用更复杂的密码，可能会导致被攻击者难以发现新的管理员账户。
*   **文件读取的潜在风险：** 脚本中存在从文件读取IP地址的逻辑 (`while read LINE; do ... done <$IP`)。如果攻击者能够控制该文件的内容，可能会执行恶意命令。虽然此处的变量`$IP`很可能是一个笔误，应该是`$TARGET`，但不能排除被利用的风险。
*   **CURL参数的修改风险：** 攻击者可能会修改curl命令的参数，例如添加 `--proxy` 参数，将流量转发到恶意服务器，从而窃取敏感信息。或者将 `email=haxor%40localhost` 修改为其他钓鱼邮件。

综合来看，投毒风险约为 10%。该风险主要来源于脚本中可能存在的恶意修改或参数注入，而非脚本本身的漏洞利用逻辑。

**项目地址:** [iveresk/CVE-2023-22515](https://github.com/iveresk/CVE-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #19

**来源**: [CVE-2023-22515-j3seer_CVE-2023-22515-POC.md](../2023/CVE-2023-22515-j3seer_CVE-2023-22515-POC.md)

## CVE-2023-22515 Atlassian Confluence 权限提升/未授权管理员创建漏洞

**漏洞编号:** CVE-2023-22515

**漏洞类型:** 权限提升/Broken Access Control

**影响应用:** Atlassian Confluence Data Center/Server

**危害等级:** 高危，允许未授权用户创建管理员账户，完全控制 Confluence 实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence 实例可以公开访问，并且未完成初始化设置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22515 漏洞是一个 Atlassian Confluence Server 和 Data Center 实例上的严重权限提升漏洞。未经身份验证的攻击者可以利用此漏洞创建未经授权的 Confluence 管理员帐户并访问 Confluence 实例。

**漏洞利用方式：**

1.  **绕过安全检查:** 通过 `server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false`  设置 `setupComplete`  为 `false`，绕过 Confluence 的安装设置检查。
2.  **创建管理员账户:** 利用 `/setup/setupadministrator.action`  端点，创建一个新的管理员账户。攻击者可以指定用户名、全名、邮箱和密码。
3.  **完成安装设置:** 利用 `/setup/finishsetup.action`  端点，完成安装设置。
4.  **XSRF 绕过:** 使用 `X-Atlassian-Token: no-check`  header 绕过跨站请求伪造 (XSRF) 保护。

**有效性：**

提供的 YAML 文件和 README.md 描述了一种有效的攻击方式。多个搜索结果也表明该漏洞已被积极利用。

**投毒风险：**

该漏洞利用代码的仓库中未发现明显的投毒代码。YAML 文件和 README.md 仅包含漏洞利用的必要步骤和信息。没有任何迹象表明作者试图隐藏恶意代码或后门。

**漏洞分析:**

该漏洞的根本原因是 Confluence 在初始化设置过程中，存在不安全的访问控制。攻击者可以通过操纵特定的 HTTP 请求参数，绕过安全检查，从而创建管理员账户。`Xwork interceptors`解析参数的特性,使得攻击者可以利用`set`和`get`方法,结合`X-Atlassian-Token`绕过XSRF,最终利用`/setup/*`创建管理员.


**项目地址:** [j3seer/CVE-2023-22515-POC](https://github.com/j3seer/CVE-2023-22515-POC)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #20

**来源**: [CVE-2023-22515-joaoviictorti_CVE-2023-22515.md](../2023/CVE-2023-22515-joaoviictorti_CVE-2023-22515.md)

## CVE-2023-22515-Atlassian Confluence-Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，允许未经身份验证的攻击者创建Confluence管理员账户，进而可能导致完全控制Confluence实例。

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** 目标Confluence实例需公开可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22515是一个严重的Broken Access Control漏洞，影响Atlassian Confluence Data Center和Server。根据漏洞库信息、搜索结果和提供的漏洞利用代码，评估结果如下：

**有效性：**
搜索引擎结果显示，CVE-2023-22515漏洞已被积极利用。多个安全厂商和CISA均发布了关于此漏洞的警告，并确认了漏洞的严重性和可利用性。GitHub上存在公开可用的POC利用代码，进一步佐证了漏洞的有效性。综合来看，该漏洞利用的有效性高。

**投毒风险：**
提供的代码片段`Cargo.lock`是Rust项目的依赖锁定文件，它本身不包含可执行代码，因此直接在此文件中进行投毒的可能性较低。但是，存在通过篡改Cargo.lock文件，指定恶意的依赖版本，从而间接引入包含恶意代码的依赖项的风险。此风险较低，约 10%。

**利用方式：**
该漏洞允许未经身份验证的远程攻击者创建未经授权的Confluence管理员帐户。这通常通过发送特制的HTTP请求到Confluence服务器来实现，绕过身份验证检查，直接在系统中注册一个新的管理员用户。成功创建管理员账户后，攻击者可以使用该账户登录Confluence，并获得对系统的完全控制权限，包括读取、修改和删除数据，以及执行任意代码。

总而言之，CVE-2023-22515是一个高危漏洞，利用简单，影响范围广。建议受影响的用户尽快升级到不受影响的版本。

**项目地址:** [joaoviictorti/CVE-2023-22515](https://github.com/joaoviictorti/CVE-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #21

**来源**: [CVE-2023-22515-kh4sh3i_CVE-2023-22515.md](../2023/CVE-2023-22515-kh4sh3i_CVE-2023-22515.md)

## CVE-2023-22515 Atlassian Confluence 权限提升

**漏洞编号:** CVE-2023-22515

**漏洞类型:** 权限提升/Broken Access Control

**影响应用:** Atlassian Confluence Data Center 和 Server

**危害等级:** 严重，未授权的攻击者可以创建管理员账户并访问 Confluence 实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence 实例可以公开访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22515 是 Atlassian Confluence Data Center 和 Server 中的一个权限提升漏洞。攻击者可以通过利用 `/setup/setupadministrator-start.action` 和 `/setup/setupadministrator.action` 接口，在未授权的情况下创建一个 Confluence 管理员账户。漏洞利用方式如下：

1.  **绕过设置完成检查：** 通过访问 `/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=0` 接口，将 Confluence 标记为未完成设置。
2.  **访问管理员设置页面：** 访问 `/setup/setupadministrator-start.action` 接口，进入管理员设置页面。
3.  **创建管理员账户：** 通过 POST 请求向 `/setup/setupadministrator.action` 接口发送包含用户名、密码和邮箱等信息的表单数据，创建一个新的管理员账户。
4.  **登录：** 使用新创建的管理员账户登录 Confluence。

提供的 Nuclei YAML 模板 `CVE-2023-22515.yaml` 实现了上述攻击流程，通过多个 HTTP 请求模拟攻击者的行为，验证漏洞的存在。代码没有发现存在恶意行为，因此判断不存在投毒风险，投毒风险比例为0%。根据CISA的公告，该漏洞已被积极利用，因此确定提供的POC代码是有效的。

**项目地址:** [kh4sh3i/CVE-2023-22515](https://github.com/kh4sh3i/CVE-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #22

**来源**: [CVE-2023-22515-killvxk_CVE-2023-22515-joaoviictorti.md](../2023/CVE-2023-22515-killvxk_CVE-2023-22515-joaoviictorti.md)

## CVE-2023-22515-Atlassian Confluence-Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 严重，可能导致未经授权的管理员帐户创建和远程代码执行

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence实例对外可访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-22515是一个Atlassian Confluence Data Center和Server中的严重漏洞，它允许未经身份验证的远程攻击者创建未经授权的Confluence管理员帐户并访问Confluence实例。根据搜索引擎结果，该漏洞已被积极利用。漏洞利用方式是攻击者可以重新启用初始设置过程，从而获得创建新管理员帐户的能力。

**有效性：** 基于漏洞库信息和搜索引擎结果，该漏洞影响多个Confluence版本，且存在公开可用的利用代码，已经被CISA列入已知被利用的漏洞目录(KEV)，因此可以判断漏洞利用有效。

**投毒风险：** 提供的漏洞利用代码是一个Rust Cargo.lock文件，用于记录项目依赖的确切版本。分析该文件本身无法直接判断是否存在投毒代码。Cargo.lock文件只是依赖管理文件，实际的投毒可能存在于项目依赖的源代码中。 由于文件较长，人工审计所有依赖项的安全性是不现实的。但是，根据经验，虽然不能完全排除投毒的可能性，但直接在Cargo.lock文件中进行投毒的概率极低。所以投毒风险预估为1%。

**利用方式：** 攻击者利用该漏洞可以绕过身份验证，重新触发Confluence的安装向导，创建一个新的管理员帐户。然后，他们可以使用该帐户访问Confluence实例并执行任意操作，例如读取敏感数据、修改系统配置或执行恶意代码。

**项目地址:** [killvxk/CVE-2023-22515-joaoviictorti](https://github.com/killvxk/CVE-2023-22515-joaoviictorti)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #23

**来源**: [CVE-2023-22515-rxerium_CVE-2023-22515.md](../2023/CVE-2023-22515-rxerium_CVE-2023-22515.md)

## CVE-2023-22515 - Atlassian Confluence 权限绕过/未授权管理员创建

**漏洞编号:** CVE-2023-22515

**漏洞类型:** 权限绕过/未授权访问

**影响应用:** Atlassian Confluence Data Center/Server

**危害等级:** 高危，允许未授权用户创建管理员账户并完全控制Confluence实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence实例公开可访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-22515 是 Atlassian Confluence Data Center 和 Server 中一个严重的权限绕过漏洞。未经身份验证的攻击者可以利用此漏洞创建未经授权的 Confluence 管理员帐户，从而完全控制受影响的 Confluence 实例。

**有效性：**
根据漏洞信息和搜索结果，该漏洞已被积极利用，并且存在公开可用的PoC利用代码。提供的Nuclei模板用于检测易受攻击的Confluence版本，可以辅助验证漏洞的存在。

**投毒风险：**
提供的Nuclei模板主要用于漏洞检测，其目的是确定Confluence实例是否运行着易受攻击的版本。该模板通过发送HTTP GET请求到Confluence服务器的不同端点（/dologin.action, /, /pages, /confluence, /wiki），并从响应体中提取版本信息。然后，它会将提取的版本与已知的易受攻击的版本列表进行匹配。如果版本匹配，则认为该实例存在漏洞。

分析了该代码，发现投毒风险较低，约为 5%。主要原因如下：
*   **Nuclei 模板的性质：** Nuclei 模板主要设计用于检测漏洞，而不是利用漏洞。它的核心功能是发送请求并根据响应进行匹配，而不是执行恶意操作。
*   **代码的可见性：** 模板代码是公开的，易于审查。任何潜在的恶意代码都会很容易被发现。
*   **模板的简单性：** 该模板的功能相对简单，主要涉及发送 HTTP 请求和进行正则匹配。这降低了隐藏恶意代码的可能性。

然而，仍然存在一些微小的风险：
*   **依赖风险：** Nuclei 依赖于外部库和环境。如果 Nuclei 本身存在漏洞，或者其依赖项被篡改，可能会导致恶意代码的执行。
*   **配置错误风险：** 如果用户配置 Nuclei 不当，例如允许其执行任意代码，可能会增加风险。

总的来说，提供的 Nuclei 模板用于检测 CVE-2023-22515 漏洞的风险相对较低，因为它主要用于漏洞检测，而不是利用。

**利用方式：**
1.  **漏洞发现：** 使用提供的Nuclei模板或其他漏洞扫描工具识别存在CVE-2023-22515漏洞的Confluence实例。
2.  **管理员账户创建：** 攻击者发送特制的HTTP请求到Confluence服务器，绕过身份验证机制，创建一个新的管理员账户。
3.  **权限获取：** 使用新创建的管理员账户登录Confluence，获得对系统的完全控制权。
4.  **恶意行为：** 攻击者可以利用管理员权限执行任意操作，例如：
    *   窃取敏感数据
    *   篡改数据
    *   安装恶意软件
    *   进行拒绝服务攻击

**项目地址:** [rxerium/CVE-2023-22515](https://github.com/rxerium/CVE-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #24

**来源**: [CVE-2023-22515-s1d6point7bugcrowd_CVE-2023-22515-check.md](../2023/CVE-2023-22515-s1d6point7bugcrowd_CVE-2023-22515-check.md)

## CVE-2023-22515 Atlassian Confluence 破损的访问控制

**漏洞编号:** CVE-2023-22515

**漏洞类型:** 破损的访问控制

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，可能导致未授权管理员账户创建和远程代码执行

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence实例对外开放，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22515是一个存在于Atlassian Confluence Data Center和Server中的破损的访问控制漏洞。未经身份验证的攻击者可以通过此漏洞创建未经授权的Confluence管理员账户，并访问Confluence实例。根据漏洞库信息和搜索结果，该漏洞影响Confluence Data Center和Server 8.0.0到8.5.1之间的多个版本。提供的漏洞利用代码是一个检测脚本，用于确定Confluence实例是否容易受到攻击，而不是直接利用漏洞。它首先检查Confluence版本，然后尝试通过POST请求将应用设置为设置模式(setup mode)。如果版本在受影响范围内，并且成功设置了设置模式，则认为该实例易受攻击。

**有效性：**
该POC的有效性取决于目标Confluence实例的版本和是否能成功触发setup mode。如果目标版本在受影响范围内，且可以设置为setup mode，则该脚本能有效识别漏洞的存在，但它本身**不能直接利用漏洞**创建管理员账户。 该脚本只起到验证是否存在漏洞。

**投毒风险：**
该存储库存在投毒风险的可能性较低，约为10%。 原因是：
1. 该代码主要功能是版本检测和setup mode设置，没有执行恶意操作。
2.  虽然`X-Custom-Header`可用于识别用户，理论上存在追踪行为，但是此行为不属于后门或者恶意行为，所以投毒风险较低。

**利用方式：**
1.  **版本检测:**  利用脚本或者手动访问`login.action`页面，通过正则表达式提取Confluence版本号。
2.  **Setup Mode检查:** 发送POST请求到`/server-info.action`，设置`bootstrapStatusProvider.applicationConfig.setupComplete`为`false`尝试进入Setup Mode。
3.  **创建管理员账号:** 如果成功进入Setup Mode，即可创建新的管理员账户，从而控制Confluence实例。需要注意，提供的代码**不包含**创建管理员账户的步骤，只是检测漏洞是否存在。

**项目地址:** [s1d6point7bugcrowd/CVE-2023-22515-check](https://github.com/s1d6point7bugcrowd/CVE-2023-22515-check)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #25

**来源**: [CVE-2023-22515-sincere9_CVE-2023-22515.md](../2023/CVE-2023-22515-sincere9_CVE-2023-22515.md)

## CVE-2023-22515-Confluence-Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，允许未授权用户创建管理员账户，完全控制Confluence实例

**影响版本:** 8.0.0 <= version <= 8.5.1 (受影响版本不包括 8.3.3, 8.4.3, 8.5.2)

**利用条件:** Confluence实例可以公开访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-22515是一个Atlassian Confluence Server和Data Center中的Broken Access Control漏洞。未经身份验证的攻击者可以利用此漏洞创建未授权的Confluence管理员账户。 

**利用方式：**

1.  **检查漏洞是否存在：** 通过访问`/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false`页面来判断Confluence是否已完成初始化设置，如果返回包含"success"，则可能存在漏洞。
2.  **创建管理员账户：** 如果系统未完成设置，攻击者可以发送POST请求到`/setup/setupadministrator.action`，设置用户名、密码和邮箱等信息，创建一个新的管理员账户。
3.  **完成设置：** 创建管理员账户后，发送POST请求到`/setup/finishsetup.action`来完成设置。

**POC有效性：**

根据漏洞信息和利用代码，提供的POC代码有效。它可以自动化创建管理员账号的过程，从而验证漏洞的存在。

**投毒风险：**

虽然POC代码本身的功能是利用漏洞创建管理员账号，但我们需要评估是否存在作者隐藏的恶意代码。审查发现，代码主要功能为发送HTTP请求，生成随机用户名密码，没有发现明显的恶意行为，投毒风险极低,风险评估为1%。风险主要来源于对目标URL的误用和依赖库的安全。

**搜索引擎结果：**

搜索结果表明CVE-2023-22515是一个高危漏洞，被广泛利用。CISA也发布了相关的安全公告，敦促用户尽快修复。

**项目地址:** [sincere9/CVE-2023-22515](https://github.com/sincere9/CVE-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #26

**来源**: [CVE-2023-22515-spareack_CVE-2023-22515-NSE.md](../2023/CVE-2023-22515-spareack_CVE-2023-22515-NSE.md)

## CVE-2023-22515-Atlassian Confluence Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危，可能导致未经授权的管理员账户创建和系统完全控制

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** 目标Confluence实例必须公开可访问且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22515 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的远程攻击者创建未经授权的管理员帐户，从而完全控制受影响的 Confluence 实例。

**有效性：**

提供的 Nmap NSE 脚本 POC 代码有效。它通过发送请求到易受攻击的端点并分析响应来检查漏洞的存在。

**投毒风险：**

投毒风险评估为10%。虽然提供的代码主要用于检测漏洞，但存在细微的风险，恶意攻击者可能修改该脚本以包含在成功利用后执行恶意操作的代码。 例如，该脚本可能会被修改为静默地安装后门或收集敏感信息。然而，这种风险较低，因为核心功能是漏洞检测。

**利用方式：**

1.  **绕过身份验证：** 攻击者无需任何凭据即可与 Confluence 服务器进行交互。
2.  **重置安装状态：** 攻击者发送一个请求到 `bootstrapStatusProvider.applicationConfig.setupComplete=false`  端点，有效地将 Confluence 实例重置到未安装状态。
3.  **创建管理员账户：** 攻击者发送一个 POST 请求到 `/setup/setupadministrator.action` 端点，创建一个新的管理员账户。
4.  **完全控制：** 使用新创建的管理员账户，攻击者可以登录并完全控制 Confluence 服务器，包括访问敏感数据，修改配置以及执行任意代码。

**总结：**

该漏洞的利用非常简单，只需要几个 HTTP 请求即可。POC 代码的存在使得利用更加容易。 由于该漏洞允许完全控制受影响的系统，因此具有很高的风险。 建议受影响的用户尽快升级到已修复的版本。

**参考资料：**

*   CISA 建议：[https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-289a](https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-289a)
*   Rapid7 分析：[https://www.rapid7.com/blog/post/2023/10/04/etr-cve-2023-22515-zero-day-privilege-escalation-in-confluence-server-and-data-center/](https://www.rapid7.com/blog/post/2023/10/04/etr-cve-2023-22515-zero-day-privilege-escalation-in-confluence-server-and-data-center/)
*   Qualys 分析：[https://blog.qualys.com/vulnerabilities-threat-research/2023/11/15/atlassian-confluence-broken-access-control-vulnerability-cve-2023-22515](https://blog.qualys.com/vulnerabilities-threat-research/2023/11/15/atlassian-confluence-broken-access-control-vulnerability-cve-2023-22515)


**项目地址:** [spareack/CVE-2023-22515-NSE](https://github.com/spareack/CVE-2023-22515-NSE)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #27

**来源**: [CVE-2023-22515-vivigotnotime_CVE-2023-22515-Exploit-Script.md](../2023/CVE-2023-22515-vivigotnotime_CVE-2023-22515-Exploit-Script.md)

## CVE-2023-22515 - Atlassian Confluence Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 严重，允许未经身份验证的攻击者创建管理员帐户并完全控制受影响的实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence Server 或 Data Center 实例必须是公开可访问的，且位于受影响的版本范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-22515 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，属于未授权访问控制漏洞。未经身份验证的远程攻击者可以利用此漏洞在受影响的 Confluence 实例上创建未经授权的 Confluence 管理员帐户，从而获得对 Confluence 实例的完全控制权。

**漏洞利用方式：**

1.  **触发漏洞:** 首先，攻击者通过访问 `/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false` URL 来触发漏洞，该操作会将 Confluence 实例置于未设置完成的状态。
2.  **创建管理员帐户:** 然后，攻击者通过向 `/setup/setupadministrator.action` 发送 POST 请求，利用未授权访问控制漏洞创建一个新的管理员帐户。POST 请求包含用户名、密码和电子邮件等管理员帐户的信息。
3.  **身份验证:** 最后，攻击者使用新创建的管理员帐户登录 Confluence 实例，并获得完全的管理权限。

**投毒风险分析：**

提供的PoC代码主要功能是利用漏洞创建管理员账户，并未发现直接的恶意代码或后门植入行为。PoC代码虽然在创建管理员账户后，会将服务器、用户名和密码写入文件。这个行为本身不属于投毒，但如果该文件被泄露，可能会造成安全风险。 此外，该PoC使用了一些常用的库如`requests`, `rich`, `alive-progress`, `fire`，这些库本身被投毒的可能性较低，但需要确保从官方源安装，避免使用来源不明的第三方库。

因此，综合评估认为此仓库中存在作者隐藏的投毒代码的可能性较低，大约为5%。

**总结：**

此漏洞利用代码针对 CVE-2023-22515 进行了自动化利用，允许未经身份验证的攻击者创建管理员帐户。利用过程简单，只需要目标实例存在漏洞即可。该漏洞的风险极高，建议受影响的用户尽快升级到安全版本。

**项目地址:** [vivigotnotime/CVE-2023-22515-Exploit-Script](https://github.com/vivigotnotime/CVE-2023-22515-Exploit-Script)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #28

**来源**: [CVE-2023-22515-xorbbo_cve-2023-22515.md](../2023/CVE-2023-22515-xorbbo_cve-2023-22515.md)

## CVE-2023-22515 - Atlassian Confluence Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，允许未授权用户创建管理员账户，可能导致完全控制 Confluence 实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence 实例需要公开可访问，且未完成初始化配置（setupComplete = false）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-22515 漏洞是一个严重的权限绕过漏洞，影响 Atlassian Confluence Data Center 和 Server 实例。未经身份验证的攻击者可以通过该漏洞创建未经授权的 Confluence 管理员帐户，从而完全控制 Confluence 实例。

**利用方式：**

1.  **重置设置状态：** 攻击者发送一个GET请求到`/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false`。 这个请求会将 Confluence 实例重置到设置模式，即使它已经被设置过。
2.  **创建管理员账户：** 攻击者然后发送一个POST请求到`/setup/setupadministrator.action`，其中包含新管理员帐户的用户名、密码和电子邮件信息。该请求中的`X-Atlassian-Token: no-check` header用于绕过CSRF保护。
3.  **完成设置:** 攻击者发送一个POST请求到 `/setup/finishsetup.action`来关闭 Confluence的配置完成提示。

**POC有效性：**

提供的 POC 代码（包括 Burp Suite 请求示例和 Nmap NSE 脚本）看起来有效。它包含了利用该漏洞所需的步骤：首先通过 `/server-info.action` 接口将 Confluence 置于未安装状态，然后利用 `/setup/setupadministrator.action` 接口创建管理员用户，最后利用`/setup/finishsetup.action`接口关闭提示信息。

**投毒风险：**

投毒风险较低 (5%)。 虽然任何第三方提供的代码都存在潜在风险，但此处的代码相对简单且直接地实现了漏洞利用。主要风险在于攻击者可能会修改 Nmap 脚本或 Burp Suite 请求以包含其他恶意操作，例如安装后门、上传 webshell 或收集敏感信息。 但从目前的代码来看，没有明显的恶意代码。

**缓解措施：**

*   尽快升级到不受影响的 Confluence 版本（8.3.3 及更高版本，8.4.3 及更高版本，8.5.2 及更高版本）。
*   如果无法立即升级，请参考 Atlassian 官方指南采取临时缓解措施。
*   监控 Confluence 实例中是否存在未经授权的管理员帐户。
*   限制对 Confluence 实例的网络访问。

**项目地址:** [xorbbo/cve-2023-22515](https://github.com/xorbbo/cve-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

## POC #29

**来源**: [CVE-2023-22515-youcannotseemeagain_CVE-2023-22515_RCE.md](../2023/CVE-2023-22515-youcannotseemeagain_CVE-2023-22515_RCE.md)

## CVE-2023-22515-Atlassian Confluence Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，允许未经身份验证的远程攻击者创建管理员帐户并完全控制Confluence实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence实例可以公开访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-22515是一个Atlassian Confluence Server和Data Center的严重漏洞，属于权限控制缺陷。

**有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞被广泛利用，允许未经身份验证的攻击者创建Confluence管理员帐户。搜索结果[6]指向GitHub上存在利用此漏洞的公开PoC。

**投毒风险：**
提供的漏洞利用代码描述了一种在获得后台权限后进行RCE的方式，通过上传恶意插件实现。此代码本身描述的是后渗透阶段的利用方法，不是漏洞触发点。其中展示了上传插件的截图，并访问特定的servlet来执行命令。该利用方式依赖于已经获取的管理员权限，漏洞利用代码仓库本身只包含图片和说明文档，通过上传恶意插件从而达到了RCE目的，投毒风险较低。由于利用方式较为直接，可以判断没有显著的投毒行为，但是不排除图片中引用的插件中包含恶意代码的可能性，因此存在一定风险。

**利用方式：**
1.  攻击者利用未授权访问漏洞(CVE-2023-22515)创建一个管理员账号。
2.  使用创建的管理员账号登录Confluence后台。
3.  在Confluence后台，攻击者上传一个恶意插件。
4.  通过访问恶意插件提供的Servlet接口（例如 `plugins/servlet/com.jsos.shell/ShellServlet`），执行任意代码。

此漏洞利用的核心在于首先获得管理员权限，然后通过上传恶意插件实现RCE。提供的代码只是RCE的步骤，而非获取管理员权限的PoC。

**项目地址:** [youcannotseemeagain/CVE-2023-22515_RCE](https://github.com/youcannotseemeagain/CVE-2023-22515_RCE)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)

---

