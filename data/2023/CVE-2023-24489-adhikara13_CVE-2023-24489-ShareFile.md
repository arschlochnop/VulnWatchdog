# CVE-2023-24489

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-24489-adhikara13_CVE-2023-24489-ShareFile.md](../2023/CVE-2023-24489-adhikara13_CVE-2023-24489-ShareFile.md)

# CVE-2023-24489

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-24489-adhikara13_CVE-2023-24489-ShareFile.md](../2023/CVE-2023-24489-adhikara13_CVE-2023-24489-ShareFile.md)

# CVE-2023-24489

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-24489-adhikara13_CVE-2023-24489-ShareFile.md](../2023/CVE-2023-24489-adhikara13_CVE-2023-24489-ShareFile.md)

# CVE-2023-24489

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-24489-adhikara13_CVE-2023-24489-ShareFile.md](../2023/CVE-2023-24489-adhikara13_CVE-2023-24489-ShareFile.md)

# CVE-2023-24489

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-24489-adhikara13_CVE-2023-24489-ShareFile.md](../2023/CVE-2023-24489-adhikara13_CVE-2023-24489-ShareFile.md)

# CVE-2023-24489

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-24489-adhikara13_CVE-2023-24489-ShareFile.md](../2023/CVE-2023-24489-adhikara13_CVE-2023-24489-ShareFile.md)

## CVE-2023-24489-Citrix ShareFile Storage Zones Controller-RCE

**æ¼æ´ç¼–å·:** CVE-2023-24489

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** Citrix ShareFile Storage Zones Controller

**å±å®³ç­‰çº§:** ä¸¥é‡ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥è¿œç¨‹å…¥ä¾µ Storage Zones Controller

**å½±å“ç‰ˆæœ¬:** < 5.11.24

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—® Storage Zones Controllerï¼Œä¸”ç›®æ ‡ç‰ˆæœ¬ä½äº5.11.24

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2023-24489 æ˜¯ Citrix ShareFile Storage Zones Controller ä¸­å‘ç°çš„ä¸€ä¸ªä¸¥é‡æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ¥å…¥ä¾µ Storage Zones Controllerã€‚æ ¹æ®æä¾›çš„æ¼æ´åº“ä¿¡æ¯ï¼ŒCVSS v3.1 è¯„åˆ†ä¸º 9.8ï¼Œè¡¨æ˜è¯¥æ¼æ´å…·æœ‰æé«˜çš„é£é™©ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜ï¼Œè¿™æ˜¯ä¸€ä¸ª Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ è¢«åˆ©ç”¨çš„æ¼æ´ï¼Œå¹¶ä¸”CISA å·²å°†å…¶æ·»åŠ åˆ°å·²çŸ¥è¢«åˆ©ç”¨æ¼æ´ç›®å½•ä¸­ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰CC0 1.0 Universalåè®®çš„LICENSEæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æ˜¯Creative Commons Legal Codeï¼Œæè¿°äº†æ”¾å¼ƒç‰ˆæƒå’Œç›¸å…³æƒåˆ©çš„æ³•å¾‹å£°æ˜ï¼Œæœ¬èº«ä¸å…·å¤‡æ¼æ´åˆ©ç”¨èƒ½åŠ›ï¼Œä½†è¡¨æ˜äº†ä»£ç ä½œè€…å¸Œæœ›ä»£ç è¢«è‡ªç”±ä½¿ç”¨å’Œä¿®æ”¹ã€‚å› æ­¤ï¼Œæ— æ³•ä»æä¾›çš„ä»£ç ä¸­åˆ¤æ–­æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§ã€‚ä½†æ ¹æ®æœç´¢ç»“æœï¼Œå­˜åœ¨å…¬å¼€å¯ç”¨çš„POCã€‚ç›®å‰æ— æ³•åˆ¤æ–­æŠ•æ¯’é£é™©ï¼Œå› ä¸ºLICENSEæ–‡ä»¶æœ¬èº«ä¸æ˜¯å¯æ‰§è¡Œä»£ç ã€‚åˆ©ç”¨æ–¹å¼æ˜¯æœªæˆæƒçš„è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå¯èƒ½æ¶‰åŠè·¯å¾„éå†å’Œæ–‡ä»¶ä¸Šä¼ ç­‰æŠ€æœ¯ã€‚

**é¡¹ç›®åœ°å€:** [adhikara13/CVE-2023-24489-ShareFile](https://github.com/adhikara13/CVE-2023-24489-ShareFile)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-24489](https://nvd.nist.gov/vuln/detail/CVE-2023-24489)

---

## POC #2

**æ¥æº**: [CVE-2023-24489-whalebone7_CVE-2023-24489-poc.md](../2023/CVE-2023-24489-whalebone7_CVE-2023-24489-poc.md)

## CVE-2023-24489-ShareFile Storage Zones Controller-è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2023-24489

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Citrix ShareFile Storage Zones Controller

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´æœåŠ¡å™¨å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** < 5.11.24

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„ShareFile Storage Zones Controllerï¼Œä¸”å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2023-24489æ˜¯ä¸€ä¸ªå­˜åœ¨äºCitrix ShareFile Storage Zones Controllerä¸­çš„è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚æœªæˆæƒçš„æ”»å‡»è€…å¯ä»¥é€šè¿‡åˆ©ç”¨æ­¤æ¼æ´è¿œç¨‹æ§åˆ¶ShareFile Storage Zones Controllerã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å·²ç»è¢«CISAåˆ—å…¥å·²çŸ¥è¢«åˆ©ç”¨çš„æ¼æ´ç›®å½•ï¼ˆKEVï¼‰ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒé€šè¿‡å‘ç›®æ ‡æœåŠ¡å™¨çš„`/documentum/upload.aspx`ç«¯ç‚¹å‘é€åŒ…å«æ¶æ„C#ä»£ç çš„POSTè¯·æ±‚ï¼Œåˆ©ç”¨äº†æœªæˆæƒçš„æ–‡ä»¶ä¸Šä¼ å’Œè·¯å¾„éå†æ¼æ´ã€‚ä¸Šä¼ çš„æ–‡ä»¶ä¼šè¢«ä¿å­˜åœ¨`cifs`ç›®å½•ä¸‹ï¼Œç„¶åæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¿é—®ä¸Šä¼ çš„`aspx`æ–‡ä»¶æ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚PoCä»£ç é¦–å…ˆä¸Šä¼ ä¸€ä¸ªåŒ…å«`whoami`å‘½ä»¤çš„webshell, ç„¶åé€šè¿‡è®¿é—®webshellç¡®å®šæ˜¯å¦æˆåŠŸã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„bashè„šæœ¬å’ŒREADME.mdæ–‡ä»¶,æ²¡æœ‰å‘ç°ä»»ä½•ä½œè€…éšè—çš„æ¶æ„ä»£ç , è¯¥ä»“åº“ç”¨äºéªŒè¯æ¼æ´ï¼Œè€Œéä¼ æ’­æ¶æ„è½¯ä»¶ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‡†å¤‡ä¸€ä¸ªåŒ…å«C#ä»£ç çš„POSTè¯·æ±‚ï¼Œè¯¥ä»£ç ä¼šåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚
2.  æ”»å‡»è€…å‘ç›®æ ‡ShareFile Storage Zones Controllerçš„`/documentum/upload.aspx`ç«¯ç‚¹å‘é€POSTè¯·æ±‚ï¼Œåˆ©ç”¨`parentid`ï¼Œ`raw`ï¼Œ`unzip`å’Œ`uploadid`å‚æ•°ç»•è¿‡èº«ä»½éªŒè¯å’Œæ–‡ä»¶ä¸Šä¼ é™åˆ¶ã€‚`uploadid`å‚æ•°åŒ…å«ä¸€ä¸ªè·¯å¾„éå†åºåˆ—ï¼Œå°†æ–‡ä»¶ä¸Šä¼ åˆ°`cifs`ç›®å½•ä¸‹ã€‚
3.  æœåŠ¡å™¨æ¥å—POSTè¯·æ±‚å¹¶å°†åŒ…å«C#ä»£ç çš„aspxæ–‡ä»¶ä¸Šä¼ åˆ°`cifs`ç›®å½•ã€‚
4.  æ”»å‡»è€…é€šè¿‡è®¿é—®ä¸Šä¼ çš„aspxæ–‡ä»¶æ¥æ‰§è¡ŒC#ä»£ç ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
5.  é€šè¿‡æ‰§è¡Œ`whoami`æŒ‡ä»¤ï¼Œæ¥éªŒè¯å‘½ä»¤æ‰§è¡Œçš„æˆåŠŸæ€§ã€‚

**é¡¹ç›®åœ°å€:** [whalebone7/CVE-2023-24489-poc](https://github.com/whalebone7/CVE-2023-24489-poc)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-24489](https://nvd.nist.gov/vuln/detail/CVE-2023-24489)

---



---

## POC #2

**æ¥æº**: [CVE-2023-24489-whalebone7_CVE-2023-24489-poc.md](../2023/CVE-2023-24489-whalebone7_CVE-2023-24489-poc.md)

## CVE-2023-24489-ShareFile Storage Zones Controller-è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2023-24489

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Citrix ShareFile Storage Zones Controller

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´æœåŠ¡å™¨å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** < 5.11.24

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„ShareFile Storage Zones Controllerï¼Œä¸”å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2023-24489æ˜¯ä¸€ä¸ªå­˜åœ¨äºCitrix ShareFile Storage Zones Controllerä¸­çš„è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚æœªæˆæƒçš„æ”»å‡»è€…å¯ä»¥é€šè¿‡åˆ©ç”¨æ­¤æ¼æ´è¿œç¨‹æ§åˆ¶ShareFile Storage Zones Controllerã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å·²ç»è¢«CISAåˆ—å…¥å·²çŸ¥è¢«åˆ©ç”¨çš„æ¼æ´ç›®å½•ï¼ˆKEVï¼‰ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒé€šè¿‡å‘ç›®æ ‡æœåŠ¡å™¨çš„`/documentum/upload.aspx`ç«¯ç‚¹å‘é€åŒ…å«æ¶æ„C#ä»£ç çš„POSTè¯·æ±‚ï¼Œåˆ©ç”¨äº†æœªæˆæƒçš„æ–‡ä»¶ä¸Šä¼ å’Œè·¯å¾„éå†æ¼æ´ã€‚ä¸Šä¼ çš„æ–‡ä»¶ä¼šè¢«ä¿å­˜åœ¨`cifs`ç›®å½•ä¸‹ï¼Œç„¶åæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¿é—®ä¸Šä¼ çš„`aspx`æ–‡ä»¶æ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚PoCä»£ç é¦–å…ˆä¸Šä¼ ä¸€ä¸ªåŒ…å«`whoami`å‘½ä»¤çš„webshell, ç„¶åé€šè¿‡è®¿é—®webshellç¡®å®šæ˜¯å¦æˆåŠŸã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„bashè„šæœ¬å’ŒREADME.mdæ–‡ä»¶,æ²¡æœ‰å‘ç°ä»»ä½•ä½œè€…éšè—çš„æ¶æ„ä»£ç , è¯¥ä»“åº“ç”¨äºéªŒè¯æ¼æ´ï¼Œè€Œéä¼ æ’­æ¶æ„è½¯ä»¶ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‡†å¤‡ä¸€ä¸ªåŒ…å«C#ä»£ç çš„POSTè¯·æ±‚ï¼Œè¯¥ä»£ç ä¼šåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚
2.  æ”»å‡»è€…å‘ç›®æ ‡ShareFile Storage Zones Controllerçš„`/documentum/upload.aspx`ç«¯ç‚¹å‘é€POSTè¯·æ±‚ï¼Œåˆ©ç”¨`parentid`ï¼Œ`raw`ï¼Œ`unzip`å’Œ`uploadid`å‚æ•°ç»•è¿‡èº«ä»½éªŒè¯å’Œæ–‡ä»¶ä¸Šä¼ é™åˆ¶ã€‚`uploadid`å‚æ•°åŒ…å«ä¸€ä¸ªè·¯å¾„éå†åºåˆ—ï¼Œå°†æ–‡ä»¶ä¸Šä¼ åˆ°`cifs`ç›®å½•ä¸‹ã€‚
3.  æœåŠ¡å™¨æ¥å—POSTè¯·æ±‚å¹¶å°†åŒ…å«C#ä»£ç çš„aspxæ–‡ä»¶ä¸Šä¼ åˆ°`cifs`ç›®å½•ã€‚
4.  æ”»å‡»è€…é€šè¿‡è®¿é—®ä¸Šä¼ çš„aspxæ–‡ä»¶æ¥æ‰§è¡ŒC#ä»£ç ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
5.  é€šè¿‡æ‰§è¡Œ`whoami`æŒ‡ä»¤ï¼Œæ¥éªŒè¯å‘½ä»¤æ‰§è¡Œçš„æˆåŠŸæ€§ã€‚

**é¡¹ç›®åœ°å€:** [whalebone7/CVE-2023-24489-poc](https://github.com/whalebone7/CVE-2023-24489-poc)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-24489](https://nvd.nist.gov/vuln/detail/CVE-2023-24489)

---



---

## POC #2

**æ¥æº**: [CVE-2023-24489-whalebone7_CVE-2023-24489-poc.md](../2023/CVE-2023-24489-whalebone7_CVE-2023-24489-poc.md)

## CVE-2023-24489-ShareFile Storage Zones Controller-è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2023-24489

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Citrix ShareFile Storage Zones Controller

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´æœåŠ¡å™¨å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** < 5.11.24

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„ShareFile Storage Zones Controllerï¼Œä¸”å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2023-24489æ˜¯ä¸€ä¸ªå­˜åœ¨äºCitrix ShareFile Storage Zones Controllerä¸­çš„è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚æœªæˆæƒçš„æ”»å‡»è€…å¯ä»¥é€šè¿‡åˆ©ç”¨æ­¤æ¼æ´è¿œç¨‹æ§åˆ¶ShareFile Storage Zones Controllerã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å·²ç»è¢«CISAåˆ—å…¥å·²çŸ¥è¢«åˆ©ç”¨çš„æ¼æ´ç›®å½•ï¼ˆKEVï¼‰ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒé€šè¿‡å‘ç›®æ ‡æœåŠ¡å™¨çš„`/documentum/upload.aspx`ç«¯ç‚¹å‘é€åŒ…å«æ¶æ„C#ä»£ç çš„POSTè¯·æ±‚ï¼Œåˆ©ç”¨äº†æœªæˆæƒçš„æ–‡ä»¶ä¸Šä¼ å’Œè·¯å¾„éå†æ¼æ´ã€‚ä¸Šä¼ çš„æ–‡ä»¶ä¼šè¢«ä¿å­˜åœ¨`cifs`ç›®å½•ä¸‹ï¼Œç„¶åæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¿é—®ä¸Šä¼ çš„`aspx`æ–‡ä»¶æ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚PoCä»£ç é¦–å…ˆä¸Šä¼ ä¸€ä¸ªåŒ…å«`whoami`å‘½ä»¤çš„webshell, ç„¶åé€šè¿‡è®¿é—®webshellç¡®å®šæ˜¯å¦æˆåŠŸã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„bashè„šæœ¬å’ŒREADME.mdæ–‡ä»¶,æ²¡æœ‰å‘ç°ä»»ä½•ä½œè€…éšè—çš„æ¶æ„ä»£ç , è¯¥ä»“åº“ç”¨äºéªŒè¯æ¼æ´ï¼Œè€Œéä¼ æ’­æ¶æ„è½¯ä»¶ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‡†å¤‡ä¸€ä¸ªåŒ…å«C#ä»£ç çš„POSTè¯·æ±‚ï¼Œè¯¥ä»£ç ä¼šåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚
2.  æ”»å‡»è€…å‘ç›®æ ‡ShareFile Storage Zones Controllerçš„`/documentum/upload.aspx`ç«¯ç‚¹å‘é€POSTè¯·æ±‚ï¼Œåˆ©ç”¨`parentid`ï¼Œ`raw`ï¼Œ`unzip`å’Œ`uploadid`å‚æ•°ç»•è¿‡èº«ä»½éªŒè¯å’Œæ–‡ä»¶ä¸Šä¼ é™åˆ¶ã€‚`uploadid`å‚æ•°åŒ…å«ä¸€ä¸ªè·¯å¾„éå†åºåˆ—ï¼Œå°†æ–‡ä»¶ä¸Šä¼ åˆ°`cifs`ç›®å½•ä¸‹ã€‚
3.  æœåŠ¡å™¨æ¥å—POSTè¯·æ±‚å¹¶å°†åŒ…å«C#ä»£ç çš„aspxæ–‡ä»¶ä¸Šä¼ åˆ°`cifs`ç›®å½•ã€‚
4.  æ”»å‡»è€…é€šè¿‡è®¿é—®ä¸Šä¼ çš„aspxæ–‡ä»¶æ¥æ‰§è¡ŒC#ä»£ç ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
5.  é€šè¿‡æ‰§è¡Œ`whoami`æŒ‡ä»¤ï¼Œæ¥éªŒè¯å‘½ä»¤æ‰§è¡Œçš„æˆåŠŸæ€§ã€‚

**é¡¹ç›®åœ°å€:** [whalebone7/CVE-2023-24489-poc](https://github.com/whalebone7/CVE-2023-24489-poc)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-24489](https://nvd.nist.gov/vuln/detail/CVE-2023-24489)

---



---

## POC #2

**æ¥æº**: [CVE-2023-24489-whalebone7_CVE-2023-24489-poc.md](../2023/CVE-2023-24489-whalebone7_CVE-2023-24489-poc.md)

## CVE-2023-24489-ShareFile Storage Zones Controller-è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2023-24489

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Citrix ShareFile Storage Zones Controller

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´æœåŠ¡å™¨å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** < 5.11.24

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„ShareFile Storage Zones Controllerï¼Œä¸”å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2023-24489æ˜¯ä¸€ä¸ªå­˜åœ¨äºCitrix ShareFile Storage Zones Controllerä¸­çš„è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚æœªæˆæƒçš„æ”»å‡»è€…å¯ä»¥é€šè¿‡åˆ©ç”¨æ­¤æ¼æ´è¿œç¨‹æ§åˆ¶ShareFile Storage Zones Controllerã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å·²ç»è¢«CISAåˆ—å…¥å·²çŸ¥è¢«åˆ©ç”¨çš„æ¼æ´ç›®å½•ï¼ˆKEVï¼‰ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒé€šè¿‡å‘ç›®æ ‡æœåŠ¡å™¨çš„`/documentum/upload.aspx`ç«¯ç‚¹å‘é€åŒ…å«æ¶æ„C#ä»£ç çš„POSTè¯·æ±‚ï¼Œåˆ©ç”¨äº†æœªæˆæƒçš„æ–‡ä»¶ä¸Šä¼ å’Œè·¯å¾„éå†æ¼æ´ã€‚ä¸Šä¼ çš„æ–‡ä»¶ä¼šè¢«ä¿å­˜åœ¨`cifs`ç›®å½•ä¸‹ï¼Œç„¶åæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¿é—®ä¸Šä¼ çš„`aspx`æ–‡ä»¶æ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚PoCä»£ç é¦–å…ˆä¸Šä¼ ä¸€ä¸ªåŒ…å«`whoami`å‘½ä»¤çš„webshell, ç„¶åé€šè¿‡è®¿é—®webshellç¡®å®šæ˜¯å¦æˆåŠŸã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„bashè„šæœ¬å’ŒREADME.mdæ–‡ä»¶,æ²¡æœ‰å‘ç°ä»»ä½•ä½œè€…éšè—çš„æ¶æ„ä»£ç , è¯¥ä»“åº“ç”¨äºéªŒè¯æ¼æ´ï¼Œè€Œéä¼ æ’­æ¶æ„è½¯ä»¶ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‡†å¤‡ä¸€ä¸ªåŒ…å«C#ä»£ç çš„POSTè¯·æ±‚ï¼Œè¯¥ä»£ç ä¼šåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚
2.  æ”»å‡»è€…å‘ç›®æ ‡ShareFile Storage Zones Controllerçš„`/documentum/upload.aspx`ç«¯ç‚¹å‘é€POSTè¯·æ±‚ï¼Œåˆ©ç”¨`parentid`ï¼Œ`raw`ï¼Œ`unzip`å’Œ`uploadid`å‚æ•°ç»•è¿‡èº«ä»½éªŒè¯å’Œæ–‡ä»¶ä¸Šä¼ é™åˆ¶ã€‚`uploadid`å‚æ•°åŒ…å«ä¸€ä¸ªè·¯å¾„éå†åºåˆ—ï¼Œå°†æ–‡ä»¶ä¸Šä¼ åˆ°`cifs`ç›®å½•ä¸‹ã€‚
3.  æœåŠ¡å™¨æ¥å—POSTè¯·æ±‚å¹¶å°†åŒ…å«C#ä»£ç çš„aspxæ–‡ä»¶ä¸Šä¼ åˆ°`cifs`ç›®å½•ã€‚
4.  æ”»å‡»è€…é€šè¿‡è®¿é—®ä¸Šä¼ çš„aspxæ–‡ä»¶æ¥æ‰§è¡ŒC#ä»£ç ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
5.  é€šè¿‡æ‰§è¡Œ`whoami`æŒ‡ä»¤ï¼Œæ¥éªŒè¯å‘½ä»¤æ‰§è¡Œçš„æˆåŠŸæ€§ã€‚

**é¡¹ç›®åœ°å€:** [whalebone7/CVE-2023-24489-poc](https://github.com/whalebone7/CVE-2023-24489-poc)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-24489](https://nvd.nist.gov/vuln/detail/CVE-2023-24489)

---



---

## POC #2

**æ¥æº**: [CVE-2023-24489-whalebone7_CVE-2023-24489-poc.md](../2023/CVE-2023-24489-whalebone7_CVE-2023-24489-poc.md)

## CVE-2023-24489-ShareFile Storage Zones Controller-è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2023-24489

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Citrix ShareFile Storage Zones Controller

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´æœåŠ¡å™¨å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** < 5.11.24

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„ShareFile Storage Zones Controllerï¼Œä¸”å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2023-24489æ˜¯ä¸€ä¸ªå­˜åœ¨äºCitrix ShareFile Storage Zones Controllerä¸­çš„è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚æœªæˆæƒçš„æ”»å‡»è€…å¯ä»¥é€šè¿‡åˆ©ç”¨æ­¤æ¼æ´è¿œç¨‹æ§åˆ¶ShareFile Storage Zones Controllerã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å·²ç»è¢«CISAåˆ—å…¥å·²çŸ¥è¢«åˆ©ç”¨çš„æ¼æ´ç›®å½•ï¼ˆKEVï¼‰ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒé€šè¿‡å‘ç›®æ ‡æœåŠ¡å™¨çš„`/documentum/upload.aspx`ç«¯ç‚¹å‘é€åŒ…å«æ¶æ„C#ä»£ç çš„POSTè¯·æ±‚ï¼Œåˆ©ç”¨äº†æœªæˆæƒçš„æ–‡ä»¶ä¸Šä¼ å’Œè·¯å¾„éå†æ¼æ´ã€‚ä¸Šä¼ çš„æ–‡ä»¶ä¼šè¢«ä¿å­˜åœ¨`cifs`ç›®å½•ä¸‹ï¼Œç„¶åæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¿é—®ä¸Šä¼ çš„`aspx`æ–‡ä»¶æ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚PoCä»£ç é¦–å…ˆä¸Šä¼ ä¸€ä¸ªåŒ…å«`whoami`å‘½ä»¤çš„webshell, ç„¶åé€šè¿‡è®¿é—®webshellç¡®å®šæ˜¯å¦æˆåŠŸã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„bashè„šæœ¬å’ŒREADME.mdæ–‡ä»¶,æ²¡æœ‰å‘ç°ä»»ä½•ä½œè€…éšè—çš„æ¶æ„ä»£ç , è¯¥ä»“åº“ç”¨äºéªŒè¯æ¼æ´ï¼Œè€Œéä¼ æ’­æ¶æ„è½¯ä»¶ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‡†å¤‡ä¸€ä¸ªåŒ…å«C#ä»£ç çš„POSTè¯·æ±‚ï¼Œè¯¥ä»£ç ä¼šåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚
2.  æ”»å‡»è€…å‘ç›®æ ‡ShareFile Storage Zones Controllerçš„`/documentum/upload.aspx`ç«¯ç‚¹å‘é€POSTè¯·æ±‚ï¼Œåˆ©ç”¨`parentid`ï¼Œ`raw`ï¼Œ`unzip`å’Œ`uploadid`å‚æ•°ç»•è¿‡èº«ä»½éªŒè¯å’Œæ–‡ä»¶ä¸Šä¼ é™åˆ¶ã€‚`uploadid`å‚æ•°åŒ…å«ä¸€ä¸ªè·¯å¾„éå†åºåˆ—ï¼Œå°†æ–‡ä»¶ä¸Šä¼ åˆ°`cifs`ç›®å½•ä¸‹ã€‚
3.  æœåŠ¡å™¨æ¥å—POSTè¯·æ±‚å¹¶å°†åŒ…å«C#ä»£ç çš„aspxæ–‡ä»¶ä¸Šä¼ åˆ°`cifs`ç›®å½•ã€‚
4.  æ”»å‡»è€…é€šè¿‡è®¿é—®ä¸Šä¼ çš„aspxæ–‡ä»¶æ¥æ‰§è¡ŒC#ä»£ç ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
5.  é€šè¿‡æ‰§è¡Œ`whoami`æŒ‡ä»¤ï¼Œæ¥éªŒè¯å‘½ä»¤æ‰§è¡Œçš„æˆåŠŸæ€§ã€‚

**é¡¹ç›®åœ°å€:** [whalebone7/CVE-2023-24489-poc](https://github.com/whalebone7/CVE-2023-24489-poc)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-24489](https://nvd.nist.gov/vuln/detail/CVE-2023-24489)

---



---

## POC #2

**æ¥æº**: [CVE-2023-24489-whalebone7_CVE-2023-24489-poc.md](../2023/CVE-2023-24489-whalebone7_CVE-2023-24489-poc.md)

## CVE-2023-24489-ShareFile Storage Zones Controller-è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2023-24489

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Citrix ShareFile Storage Zones Controller

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´æœåŠ¡å™¨å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** < 5.11.24

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„ShareFile Storage Zones Controllerï¼Œä¸”å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2023-24489æ˜¯ä¸€ä¸ªå­˜åœ¨äºCitrix ShareFile Storage Zones Controllerä¸­çš„è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚æœªæˆæƒçš„æ”»å‡»è€…å¯ä»¥é€šè¿‡åˆ©ç”¨æ­¤æ¼æ´è¿œç¨‹æ§åˆ¶ShareFile Storage Zones Controllerã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å·²ç»è¢«CISAåˆ—å…¥å·²çŸ¥è¢«åˆ©ç”¨çš„æ¼æ´ç›®å½•ï¼ˆKEVï¼‰ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒé€šè¿‡å‘ç›®æ ‡æœåŠ¡å™¨çš„`/documentum/upload.aspx`ç«¯ç‚¹å‘é€åŒ…å«æ¶æ„C#ä»£ç çš„POSTè¯·æ±‚ï¼Œåˆ©ç”¨äº†æœªæˆæƒçš„æ–‡ä»¶ä¸Šä¼ å’Œè·¯å¾„éå†æ¼æ´ã€‚ä¸Šä¼ çš„æ–‡ä»¶ä¼šè¢«ä¿å­˜åœ¨`cifs`ç›®å½•ä¸‹ï¼Œç„¶åæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¿é—®ä¸Šä¼ çš„`aspx`æ–‡ä»¶æ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚PoCä»£ç é¦–å…ˆä¸Šä¼ ä¸€ä¸ªåŒ…å«`whoami`å‘½ä»¤çš„webshell, ç„¶åé€šè¿‡è®¿é—®webshellç¡®å®šæ˜¯å¦æˆåŠŸã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„bashè„šæœ¬å’ŒREADME.mdæ–‡ä»¶,æ²¡æœ‰å‘ç°ä»»ä½•ä½œè€…éšè—çš„æ¶æ„ä»£ç , è¯¥ä»“åº“ç”¨äºéªŒè¯æ¼æ´ï¼Œè€Œéä¼ æ’­æ¶æ„è½¯ä»¶ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‡†å¤‡ä¸€ä¸ªåŒ…å«C#ä»£ç çš„POSTè¯·æ±‚ï¼Œè¯¥ä»£ç ä¼šåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚
2.  æ”»å‡»è€…å‘ç›®æ ‡ShareFile Storage Zones Controllerçš„`/documentum/upload.aspx`ç«¯ç‚¹å‘é€POSTè¯·æ±‚ï¼Œåˆ©ç”¨`parentid`ï¼Œ`raw`ï¼Œ`unzip`å’Œ`uploadid`å‚æ•°ç»•è¿‡èº«ä»½éªŒè¯å’Œæ–‡ä»¶ä¸Šä¼ é™åˆ¶ã€‚`uploadid`å‚æ•°åŒ…å«ä¸€ä¸ªè·¯å¾„éå†åºåˆ—ï¼Œå°†æ–‡ä»¶ä¸Šä¼ åˆ°`cifs`ç›®å½•ä¸‹ã€‚
3.  æœåŠ¡å™¨æ¥å—POSTè¯·æ±‚å¹¶å°†åŒ…å«C#ä»£ç çš„aspxæ–‡ä»¶ä¸Šä¼ åˆ°`cifs`ç›®å½•ã€‚
4.  æ”»å‡»è€…é€šè¿‡è®¿é—®ä¸Šä¼ çš„aspxæ–‡ä»¶æ¥æ‰§è¡ŒC#ä»£ç ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
5.  é€šè¿‡æ‰§è¡Œ`whoami`æŒ‡ä»¤ï¼Œæ¥éªŒè¯å‘½ä»¤æ‰§è¡Œçš„æˆåŠŸæ€§ã€‚

**é¡¹ç›®åœ°å€:** [whalebone7/CVE-2023-24489-poc](https://github.com/whalebone7/CVE-2023-24489-poc)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-24489](https://nvd.nist.gov/vuln/detail/CVE-2023-24489)

---

