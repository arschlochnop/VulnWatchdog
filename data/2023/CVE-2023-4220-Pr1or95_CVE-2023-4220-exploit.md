## CVE-2023-4220 - Chamilo LMS 任意文件上传导致的远程代码执行 (RCE)

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 任意文件上传导致的远程代码执行 (RCE)

**影响应用:** Chamilo LMS

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** <= 1.11.24

**利用条件:** 远程且无需身份验证，目标服务器存在脆弱路径 /main/inc/lib/javascript/bigupload/inc/bigUpload.php

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：本漏洞源于Chamilo LMS大文件上传功能（bigUpload）在处理上传请求时缺乏必要的身份验证和文件扩展名过滤。公开的POC脚本展示了通过向`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`发送multipart/form-data请求，即可将任意脚本文件（如PHP Webshell）上传至服务器。该POC逻辑严密，包含上传（curl）、触发（访问存储目录）和维持控制（nc监听）三个阶段。其有效性极高，因为该路径在默认配置下往往允许直接访问，且攻击者不需要任何账号权限。POC代码中使用了标准的curl和netcat命令，执行流程符合预期的漏洞触发链，能够稳定复现任意文件上传。利用步骤：1. 攻击者准备一个恶意的PHP Webshell文件。2. 使用POC脚本通过-u参数指定目标URL，-f参数指定Webshell文件。3. 脚本发送POST请求至目标路径，利用action=post-unsupported参数绕过常规检查。4. 上传后的文件被存储在`/main/inc/lib/javascript/bigupload/files/`目录下。5. 脚本随后通过HTTP GET请求访问该文件，触发PHP代码执行。6. 攻击者通过本地监听的端口接收反弹Shell，获取服务器控制权。投毒风险分析：该POC脚本由Shell编写，代码结构清晰，逻辑透明。风险评估为低（15%）。主要风险点在于脚本通过网络下载或执行外部命令的行为。虽然此脚本目前仅使用系统自带的curl和nc，且未发现明显的混淆、加密或恶意URL外联，但防御者在下载此类POC时应谨慎。脚本虽然没有内置恶意Payload，但其功能本身即为自动化利用工具，如果攻击者对脚本进行微调，例如在curl请求中加入隐藏的统计回连或在Webshell中植入隐蔽的持久化后门，则会产生实际危害。目前分析来看，代码中不包含针对研究员本机的破坏性指令，属于标准的防御性研究资源。然而，使用者必须在隔离环境中测试，防止POC中指定的反弹连接逻辑被指向恶意的第三方C2服务器。

**项目地址:** [https://github.com/m3m0o/CVE-2023-4220](https://www.google.com/search?q=https://github.com/m3m0o/CVE-2023-4220)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)
