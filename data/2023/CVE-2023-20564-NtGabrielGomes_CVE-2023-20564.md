## CVE-2023-20564 - AMD Ryzen Master Driver 物理内存读写/权限提升

**漏洞编号:** CVE-2023-20564

**漏洞类型:** 物理内存读写/权限提升

**影响应用:** AMD Ryzen Master Driver

**危害等级:** 高危 (High)

**CVSS评分:** 8.8

**影响版本:** AMD Ryzen Master Driver V17 及多个受影响版本

**利用条件:** 需要本地访问权限，且通常需要管理员权限来加载或与驱动交互，利用后可实现从普通用户到内核权限的提升

**POC 可用性:** 9/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该POC针对AMD Ryzen Master驱动程序（AMDRyzenMasterDriverV17.sys）中的IOCTL处理逻辑漏洞进行了实现。漏洞的核心在于驱动程序未能对用户态传入的物理地址和长度进行严格的边界检查与合法性校验。POC明确指出了两个关键的IOCTL控制码：0x81112F08用于读取物理内存，0x81112F0C用于写入物理内存。通过构造特定的输入缓冲区，攻击者可以绕过操作系统的内存保护机制。该POC代码结构完整，包含了驱动服务的管理（安装与卸载）、内存读写操作的循环验证以及针对Windows x64平台的特定实现。由于物理内存读写是内核提权的基础，该POC展示了极高的攻击价值。在测试环境中，攻击者可以通过读取内核结构（如EPROCESS）来定位系统进程并替换令牌，从而实现权限提升。代码使用了标准C++17编写，并依赖advapi32库进行服务操作，其逻辑清晰，具有极高的实战参考价值和复现成功率。利用步骤：首先，攻击者需在目标系统上部署受影响的驱动文件AMDRyzenMasterDriverV17.sys；其次，通过编译生成的poc_demo.exe以管理员权限运行（用于加载驱动），程序将调用Windows API创建并启动驱动服务；随后，POC通过CreateFile获取驱动设备的句柄，利用DeviceIoControl发送特定的IOCTL指令；攻击者可以输入目标物理地址进行数据读取或篡改；最后，利用完成后运行‘poc_demo.exe remove’清理痕迹。投毒风险分析：从公开的代码仓库架构分析，该项目属于典型的安全研究PoC，代码透明度高。投毒风险主要集中在以下几点：第一，该项目依赖于外部提供的受损驱动文件，如果用户从非官方或第三方渠道下载驱动，该驱动本身可能被植入内核级后门（Rootkit）。第二，编译脚本或Makefile中可能被注入隐蔽的恶意下载指令，在用户编译PoC时静默下载恶意负载。第三，虽然当前代码展示为标准C++，但需警惕其在处理驱动加载逻辑时是否存在隐藏的shellcode注入行为。由于该漏洞利用需要管理员权限，防御者在分析此类工具时应密切关注其是否尝试建立持久化的远程连接。目前该PoC代码库逻辑符合安全研究规范，未发现明显的代码混淆或加密Payload，因此投毒风险评定为低（15%），但仍建议在隔离的沙箱环境中使用交叉编译的方式进行审计和测试，防止在利用过程中引入二次感染。

**项目地址:** [https://github.com/NtGabrielGomes/CVE-2023-20564.git](https://github.com/NtGabrielGomes/CVE-2023-20564.git)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2023-20564](https://nvd.nist.gov/vuln/detail/CVE-2023-20564)
