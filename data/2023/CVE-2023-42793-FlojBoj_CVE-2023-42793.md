## CVE-2023-42793 - JetBrains TeamCity 身份认证绕过/远程代码执行(RCE)

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份认证绕过/远程代码执行(RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 严重 (Critical)

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 2023.05.3 之前的所有版本

**利用条件:** 无需身份验证，可直接通过网络访问受影响的服务器端口。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 持续集成/持续交付(CI/CD)服务器中的一个极其严重的身份认证绕过漏洞。该漏洞允许未经身份验证的远程攻击者获取受影响服务器的管理权限。POC有效性分析：提供的 python 脚本通过利用 /app/rest/users/id:1/tokens/RPC2 等路径绕过认证机制，从而为管理员用户（ID 为 1）生成新的访问令牌，或者直接创建具有管理员权限的新账户。这一过程不需要任何凭证，是典型的逻辑漏洞利用。由于 TeamCity 在开发管道中的核心地位，攻击者在获取管理权限后可以控制构建流程、窃取源代码、访问环境变量中的机密信息（如云服务凭证、API 密钥），甚至在构建产物中植入后门。搜索结果显示，此漏洞已被 APT 29 等国家级黑客组织广泛利用，证明了其在实战中的高成功率和高价值。利用步骤：1. 确认目标 TeamCity 版本是否低于 2023.05.3。2. 构造指向特定端点（如 REST API 路径）的恶意 HTTP 请求以触发绕过。3. 脚本会自动发送请求获取 ID 为 1 的用户令牌或利用泄露的上下文创建新管理员。4. 使用获取的凭证登录 Web 界面，通过插件上传或构建任务配置实现 RCE。投毒风险分析：经过对提供的 exploit.py 源码片段审查，该 POC 主要依赖标准库（argparse, requests, re, random）和 curl 命令进行操作，逻辑较为透明。脚本注释中虽然提示了可能返回凭证而非 RCE，但这属于功能限制而非恶意投毒行为。分析中未发现恶意混淆、未授权的敏感信息外发或对执行机本身的破坏性指令（如 rm -rf /）。然而，POC 项目引用的外部链接（如 flojboj.org）和未完全展示的 curl 调用可能存在下载并执行远程恶意脚本的潜在风险。对于此类关键漏洞的 POC，攻击者常会在现有的开源利用脚本中嵌入反弹 Shell 指令，诱导安全研究员在自己机器上测试时被反控。因此，在评估该 POC 时，投毒风险定位于较低水平，但仍建议在受控的沙盒环境中运行，并仔细检查 curl 请求的具体参数是否包含指向外部不受信域名的下载行为。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2023-42793](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2023-42793)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)
