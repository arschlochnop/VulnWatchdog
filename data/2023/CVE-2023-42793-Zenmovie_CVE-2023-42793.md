## CVE-2023-42793 - JetBrains TeamCity 身份验证绕过/远程代码执行(RCE)

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 身份验证绕过/远程代码执行(RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 严重 (CRITICAL)

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 2023.05.3 之前的版本

**利用条件:** 需要网络访问目标TeamCity服务器端口，无需预先认证。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：该漏洞是由于JetBrains TeamCity处理特定REST API端点时的逻辑漏洞导致的。提供的POC代码包含两个主要脚本：CVE-2023-42793_admin.sh用于创建管理员用户，CVE-2023-42793_rce.sh用于直接执行远程命令。其核心逻辑在于向 `/app/rest/users/id:1/tokens/RPC2` 发送POST请求，由于身份验证绕过漏洞，攻击者可以直接获取ID为1（通常是系统管理员）的用户Token。利用步骤如下：1. 通过上述端点获取管理员权限的Bearer Token。2. 利用Token访问 `/admin/dataDir.html` 修改内部属性，开启调试进程模式。3. 调用 `/app/rest/debug/processes` 接口，通过参数注入执行任意系统命令。此POC逻辑清晰，直接映射了CISA及其他安全机构披露的漏洞利用链，具有极高的实战参考价值和复现成功率。投毒风险分析：经过对提供的Bash脚本代码审计，未发现明显的恶意混淆或后门植入行为。脚本中使用的工具均为系统标准库中的 `curl`, `grep`, `awk` 等，没有调用外部不可信的远程二进制文件。脚本主要操作集中在与指定的目标 `BASE_URL` 进行交互。唯一值得注意的风险点是，脚本中硬编码了创建管理员的用户名和密码为 'Zenmovie'，在实际测试中若未修改并在生产环境执行，会留下可预测的后门账户。但从代码结构来看，这属于典型的漏洞证明逻辑，而非针对研究人员的投毒行为。该POC存储在GitHub个人仓库中，其README文档提供了完整的操作截图，透明度高。综合评估，该POC是纯粹的漏洞利用脚本，投毒风险极低，仅需在隔离的沙盒环境中对特定API调用进行监控即可确保安全。

**项目地址:** [https://github.com/Zenmovie/CVE-2023-42793](https://github.com/Zenmovie/CVE-2023-42793)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/cve-2023-42793](https://nvd.nist.gov/vuln/detail/cve-2023-42793)
