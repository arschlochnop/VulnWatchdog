## CVE-2023-27372 - SPIP CMS RCE (远程代码执行)

**漏洞编号:** CVE-2023-27372

**漏洞类型:** RCE (远程代码执行)

**影响应用:** SPIP CMS

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** SPIP < 4.2.1 (具体包括 3.2.18 之前, 4.0.10 之前, 4.1.8 之前, 4.2.1 之前)

**利用条件:** 无需认证，可通过公共区域表单进行访问利用。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC代码针对SPIP CMS中的反序列化处理不当导致的远程代码执行漏洞（CVE-2023-27372）编写。代码逻辑完整，包含了自动化漏洞扫描和利用的核心功能。首先，它通过BeautifulSoup解析目标页面（如spip_pass）来提取防CSRF令牌（formulaire_action_args），这是绕过安全检查的关键步骤。随后，POC构造了一个精心设计的POST请求，向公共区域表单提交恶意的序列化数据。通过操作表单字段，攻击者可以注入PHP代码执行。此POC集成了LeakIX搜索引擎支持，能够自动化发现潜在目标，并使用了多线程执行（ThreadPoolExecutor）和进度条显示（alive_bar），具备极高的实战化水平。经过审计，其核心利用链逻辑清晰，针对SPIP特定的表单处理逻辑进行了精准打击，验证了漏洞的可利用性。利用步骤：1. 环境准备：安装依赖库如requests, bs4, rich等。2. 目标获取：手动输入URL或通过集成的LeakIX API自动爬取潜在的SPIP站点。3. 漏洞扫描：脚本首先请求spip_pass页面获取必要的action参数。4. Payload构造：构造包含恶意PHP指令的序列化数据包。5. 命令执行：通过POST请求发送Payload至目标，并解析返回结果以确认命令是否成功执行。投毒风险分析：该POC来源于公开的安全研究社区，代码逻辑透明。经过对其导入库和网络行为的分析，未发现恶意混淆或第三方未授权的外连请求（除合法的LeakIX API和目标URL外）。风险点在于其对LeakIX API的使用，如果用户在脚本中配置了自己的API Key，该Key仅在本地内存中使用，未发现上传至恶意服务器的逻辑。脚本中使用了标准的Python库（如os, re, sys, base64），虽包含base64处理，但主要用于处理Payload编码，而非隐藏恶意后门。总体而言，该脚本属于典型的安全研究工具，投毒风险较低。然而，防御者在运行此类脚本时，仍应注意检查是否被植入了隐蔽的反弹Shell或凭据窃取逻辑。建议在隔离的沙箱环境中使用，并监控Python进程的非预期网络连接，以确保研究过程的安全性。

**项目地址:** [https://nvd.nist.gov/vuln/detail/CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)
