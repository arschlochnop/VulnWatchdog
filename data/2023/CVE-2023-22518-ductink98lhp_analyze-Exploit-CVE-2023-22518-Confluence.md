# CVE-2023-22518

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-22518-0x0d3ad_CVE-2023-22518.md](../2023/CVE-2023-22518-0x0d3ad_CVE-2023-22518.md)

## CVE-2023-22518-Confluence-不当授权

**漏洞编号:** CVE-2023-22518

**漏洞类型:** 不当授权

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 严重，可能导致完全机密性、完整性和可用性损失

**影响版本:** 所有受影响版本

**利用条件:** 目标Confluence实例未打补丁，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22518是一个存在于Atlassian Confluence Server和Data Center中的不当授权漏洞。未经身份验证的攻击者可以利用此漏洞重置Confluence并创建Confluence实例管理员帐户，从而执行所有可用的管理操作，包括但不限于完全控制系统。利用方式是攻击者发送一个包含恶意.zip文件的POST请求到/json/setup-restore.action端点，无需认证。'X-Atlassian-Token: no-check' header绕过了一些安全检查。如果利用成功，攻击者可以使用默认的'admin :: admin'凭据登录。虽然提供的POC代码本身看起来相对简单，直接利用了漏洞，但仍存在一些投毒风险，比如攻击者可能会修改上传的zip文件，在成功利用漏洞后植入后门或恶意软件，从而扩大攻击范围。`README.md` 文件中的免责声明表明作者已知此工具可能被用于非法目的。漏洞利用代码较为简单， 主要就是 zip 文件上传，理论上存在投毒风险，但主要取决于zip文件本身的内容，此代码只是简单构造了一个上传请求，并无恶意代码。因此，将`exploit.py`判定为存在高风险投毒是不准确的。风险主要来自于 zip 包的内容。因此，投毒风险定为10%。

**项目地址:** [0x0d3ad/CVE-2023-22518](https://github.com/0x0d3ad/CVE-2023-22518)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)

---

## POC #2

**来源**: [CVE-2023-22518-C1ph3rX13_CVE-2023-22518.md](../2023/CVE-2023-22518-C1ph3rX13_CVE-2023-22518.md)

## CVE-2023-22518-Atlassian Confluence 认证绕过

**漏洞编号:** CVE-2023-22518

**漏洞类型:** 认证绕过

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，可能导致完全控制 Confluence 实例

**影响版本:** 所有版本 < 7.19.16, < 8.3.4, < 8.4.4, < 8.5.3, < 8.6.1 的 Confluence Data Center and Server

**利用条件:** 目标 Confluence 实例未打补丁且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22518 是 Atlassian Confluence Data Center 和 Server 中的一个认证绕过漏洞。未经身份验证的攻击者可以利用此漏洞重置 Confluence 并创建一个 Confluence 实例管理员帐户，从而完全控制 Confluence 实例。\n\n**利用方式分析：**\n\n1.  **漏洞原理：** 该漏洞源于 Confluence 在特定恢复/安装场景下对认证的错误处理。攻击者可以利用特定的 API 端点在未授权的情况下执行系统恢复操作，并创建新的管理员账户。\n2.  **POC 代码分析：** 提供的 POC 代码首先尝试上传一个伪造的 ZIP 文件到 `/json/setup-restore.action` 或 `/json/setup-restore-local.action` 端点，目的是触发服务器返回包含服务器路径信息的响应。即使上传的文件内容无效，如果服务器响应包含特定的文本（"The zip file did not contain an entry" 和 "exportDescriptor.properties"），则表明目标存在漏洞。\n3.  **利用过程：** 漏洞成功利用后，攻击者可以上传包含恶意配置的 ZIP 文件，该文件能够重置系统并创建一个新的管理员账户，一般账户名为admin，密码admin。攻击者然后可以使用此账户登录并完全控制 Confluence 实例。\n\n**投毒风险分析：**\n\n代码中存在一定的投毒风险，例如，代码中`exp` 函数会尝试使用一个本地zip文件进行利用，如果这个zip文件被替换成恶意文件，比如植入webshell，存在后门风险。此外，虽然代码本身看起来简单，但是可能隐藏了更复杂的利用逻辑或者恶意行为（例如，尝试连接到外部服务器，收集信息等）。考虑到代码的简洁性以及主要功能集中于漏洞利用，投毒可能性较低，预估为10%。

**项目地址:** [C1ph3rX13/CVE-2023-22518](https://github.com/C1ph3rX13/CVE-2023-22518)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)

---

## POC #3

**来源**: [CVE-2023-22518-ForceFledgling_CVE-2023-22518.md](../2023/CVE-2023-22518-ForceFledgling_CVE-2023-22518.md)

## CVE-2023-22518 - Atlassian Confluence Improper Authorization

**漏洞编号:** CVE-2023-22518

**漏洞类型:** Improper Authorization

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，可能导致完全机密性、完整性和可用性损失

**影响版本:** 所有受影响版本（不包括不受影响版本）

**利用条件:** 需要网络访问Confluence实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22518是一个严重的未授权漏洞，影响Atlassian Confluence Data Center和Server的所有版本。未经身份验证的攻击者可以利用此漏洞重置Confluence实例并创建一个Confluence实例管理员帐户。利用该账户，攻击者可以执行Confluence实例管理员可用的所有管理操作，从而导致完全的机密性、完整性和可用性损失。

**有效性：**
根据漏洞描述和提供的POC代码，此漏洞利用方法有效。POC通过向`/json/setup-restore.action`发送POST请求，上传包含恶意数据的zip文件，绕过身份验证，从而重置Confluence并创建一个管理员账户。搜索引擎结果也表明该漏洞已经被积极利用。

**投毒风险：**
分析提供的POC代码，没有发现明显的投毒代码。该POC的核心功能是利用未授权的`/json/setup-restore.action`接口进行数据库恢复，从而创建一个新的管理员账户。风险点主要集中在上传的`exploit-restore.zip`文件中的数据，该数据用于重置Confluence实例。如果攻击者提供的ZIP数据包含恶意配置或后门，则可能存在投毒风险。这里我们仅分析仓库提供的POC代码，并未对ZIP文件进行分析，因此我们认为仓库本身投毒风险为0%。

**利用方式：**
1.  攻击者构造一个POST请求，目标URL为`/json/setup-restore.action?synchronous=true`。
2.  请求体包含`buildIndex`参数设置为`false`，`file`参数上传恶意构造的zip文件（`exploit-restore.zip`），以及`edit`参数设置为`Upload and import`。
3.  通过设置`synchronous=true`参数，确保恢复操作同步执行。
4.  由于`/json/setup-restore.action`接口缺少身份验证检查，攻击者可以绕过身份验证，成功上传恶意zip文件并触发恢复操作。
5.  `exploit-restore.zip`中的数据用于重置Confluence实例，包括创建一个新的管理员账户。
6.  攻击者使用新创建的管理员账户登录Confluence，并获得完全的管理权限。

**项目地址:** [ForceFledgling/CVE-2023-22518](https://github.com/ForceFledgling/CVE-2023-22518)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)

---

## POC #4

**来源**: [CVE-2023-22518-Lilly-dox_Exploit-CVE-2023-22518.md](../2023/CVE-2023-22518-Lilly-dox_Exploit-CVE-2023-22518.md)

## CVE-2023-22518-Confluence-不当授权漏洞

**漏洞编号:** CVE-2023-22518

**漏洞类型:** 不当授权

**影响应用:** Confluence Data Center and Server

**危害等级:** 严重，可能导致完全丧失机密性、完整性和可用性

**影响版本:** 所有版本（不受影响的版本除外，详见漏洞库信息）

**利用条件:** 需要网络访问 Confluence 服务

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2023-22518 是一个 Confluence Data Center 和 Server 的不当授权漏洞。未经身份验证的攻击者可以利用此漏洞重置 Confluence 并创建一个 Confluence 实例管理员帐户。使用此帐户，攻击者可以执行 Confluence 实例管理员可用的所有管理操作，从而导致完全丧失机密性、完整性和可用性。

**有效性：**
该POC代码主要侧重于环境搭建和调试分析，并没有提供直接可用的exp。文档描述了如何搭建存在漏洞的环境，并指导开发者如何通过diff新旧版本jar包，并使用断点调试来理解漏洞原理。因此，可以认为该POC代码提供了漏洞分析的基础，但缺乏直接利用的payload。

**投毒风险：**
该存储库包含了一些环境搭建和调试的截图，其中MySQL数据库配置部分包含了创建数据库和用户的SQL语句。这些SQL语句本身不具有投毒性，但如果用户直接复制粘贴到生产环境，并使用了文档中提供的弱口令（如`admin123`和`supersecure`），则会引入安全风险。同时，提供的`my.cnf`配置文件中的`log_bin_trust_function_creators = 1`配置，若非必要，在生产环境中开启也存在一定风险。代码仓库本身旨在分析漏洞，但其中一些配置如果被不安全地采用，可能会导致安全问题。因此，投毒风险评估为30%。

**利用方式：**
利用方式主要是通过未授权访问相关接口，重置 Confluence 实例并创建管理员账户。结合搜索引擎信息，确认漏洞利用无需认证。利用此漏洞可以完全控制受影响的 Confluence 服务器。

**漏洞细节补充:**
根据对提供的代码仓库分析，漏洞根源可能在于 `/json` 命名空间继承自 `/admin` 命名空间，导致原本需要管理员权限才能访问的 `/admin` 下的某些功能，可以直接通过 `/json` 命名空间访问，从而绕过权限校验。

**项目地址:** [Lilly-dox/Exploit-CVE-2023-22518](https://github.com/Lilly-dox/Exploit-CVE-2023-22518)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)

---

## POC #5

**来源**: [CVE-2023-22518-RevoltSecurities_CVE-2023-22518.md](../2023/CVE-2023-22518-RevoltSecurities_CVE-2023-22518.md)

## CVE-2023-22518 - Atlassian Confluence Improper Authorization

**漏洞编号:** CVE-2023-22518

**漏洞类型:** Improper Authorization

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，可能导致完全的机密性、完整性和可用性丧失

**影响版本:** 所有受影响版本（低于 7.19.16, 8.3.4, 8.4.4, 8.5.3, 8.6.1）

**利用条件:** 目标Confluence服务器未打补丁，且可通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22518 是一个严重的权限绕过漏洞，影响 Atlassian Confluence Data Center 和 Server 的多个版本。未经身份验证的攻击者可以利用此漏洞重置 Confluence 实例并创建管理员帐户。利用此管理员权限，攻击者可以执行所有管理操作，从而导致完全的信息泄露、数据篡改和拒绝服务。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，该漏洞的利用是有效的。搜索引擎结果显示该漏洞已被积极利用，并与勒索软件攻击相关联（如 C3RB3R 勒索软件）。Rapid7 也确认了漏洞的利用情况。

POC 代码提供了一个 Python 脚本，可以利用该漏洞。它包含必要的参数，如目标域、输出文件、代理和超时，允许用户测试和验证漏洞。

**投毒风险分析：**

代码中可能存在一些细微的投毒风险，尽管作者已经声明仅用于合法目的。例如，`exploit.py` 脚本在没有充分验证目标的情况下发送请求，这可能被滥用以进行未经授权的访问。此外，虽然代码本身没有明显的恶意功能，但攻击者可以修改该代码以包含后门或其他恶意有效负载。

风险评估：10%。风险较低是由于该POC结构比较简单，容易阅读和审计，不容易隐藏恶意代码。

**利用方式分析：**

1.  **权限绕过：** 漏洞允许未经身份验证的攻击者绕过身份验证机制。
2.  **实例重置：** 攻击者可以利用漏洞重置 Confluence 实例到初始状态。
3.  **管理员帐户创建：** 在重置后，攻击者可以创建一个新的管理员帐户。
4.  **完全控制：** 使用新创建的管理员帐户，攻击者获得对 Confluence 实例的完全控制权，能够访问和修改数据、安装恶意软件等。
5. **攻击方式:** 通过发送特定的恶意请求到未授权的接口，触发Confluence实例的重置流程。

**缓解措施：**

*   立即将 Confluence Server 和 Data Center 升级到不受影响的版本（7.19.16 或更高版本，8.3.4 或更高版本，8.4.4 或更高版本，8.5.3 或更高版本，8.6.1 或更高版本）。
*   如果无法立即升级，请应用 Atlassian 提供的临时缓解措施。
*   监控 Confluence 服务器是否存在可疑活动。

**项目地址:** [RevoltSecurities/CVE-2023-22518](https://github.com/RevoltSecurities/CVE-2023-22518)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)

---

## POC #6

**来源**: [CVE-2023-22518-bibo318_CVE-2023-22518.md](../2023/CVE-2023-22518-bibo318_CVE-2023-22518.md)

## CVE-2023-22518-Atlassian Confluence-未授权重置与管理员创建

**漏洞编号:** CVE-2023-22518

**漏洞类型:** 未授权访问

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，完全丧失机密性、完整性和可用性

**影响版本:** 所有受影响版本 (参考漏洞库信息)

**利用条件:** 需要网络访问Confluence实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22518是一个存在于Atlassian Confluence Server和Data Center中的未授权漏洞。未经身份验证的攻击者可以通过此漏洞重置Confluence并创建Confluence实例管理员帐户。利用此帐户，攻击者可以执行Confluence实例管理员可执行的所有管理操作，导致完全丧失机密性、完整性和可用性。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，此漏洞影响所有Confluence Data Center和Server版本，除了已修复的版本。Rapid7等机构也确认了该漏洞正在被利用。提供的PoC代码描述了一种利用方式，通过向`/json/setup-restore.action`端点发送特制的POST请求，可以绕过身份验证并重置Confluence实例。PoC中特别提到了将`synchronous`参数设置为`true`的重要性，这可能是在早期利用尝试中被忽略的一个关键因素。

**利用方式分析：**

1.  **目标端点：**/json/setup-restore.action
2.  **HTTP方法：**POST
3.  **绕过：**利用/json命名空间绕过WebSudoInterceptor的身份验证要求。
4.  **参数：**
    *   `synchronous=true`:  使恢复操作同步执行，这对于成功利用至关重要。
    *   `buildIndex=false`
    *   `file`: 包含恶意恢复数据的ZIP文件，用于创建管理员帐户。
    *   `edit=Upload and import`
5.  **结果：**成功利用此漏洞将允许攻击者创建Confluence实例管理员帐户，从而完全控制Confluence系统。

**投毒风险分析：**

提供的漏洞利用代码主要是一个漏洞分析报告，包含了利用该漏洞的原理和方法，还提供了基于发现的漏洞的利用示例 YAML。其中利用方式是通过上传 ZIP 数据控制confluence。因此，投毒风险主要集中在 ZIP_DATA 文件中，可能包含恶意代码（例如 webshell）。由于无法直接分析 ZIP_DATA 的内容，因此无法给出准确的投毒百分比。给出的10%是基于`exploit-restore.zip` 可能包含恶意代码的可能性进行评估的，即ZIP文件中可能包含植入后门的恶意脚本。


**项目地址:** [bibo318/CVE-2023-22518](https://github.com/bibo318/CVE-2023-22518)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)

---

## POC #7

**来源**: [CVE-2023-22518-davidfortytwo_CVE-2023-22518.md](../2023/CVE-2023-22518-davidfortytwo_CVE-2023-22518.md)

## CVE-2023-22518 - Confluence Server/Data Center Improper Authorization

**漏洞编号:** CVE-2023-22518

**漏洞类型:** Improper Authorization

**影响应用:** Confluence Server/Data Center

**危害等级:** 高危，完全丧失保密性、完整性和可用性

**影响版本:** All versions of Confluence Data Center and Server are affected except versions >= 7.19.16, >= 8.3.4, >= 8.4.4, >= 8.5.3, >= 8.6.1

**利用条件:** 需要网络访问未打补丁的Confluence实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-22518是一个Confluence Server和Data Center的严重漏洞，允许未经身份验证的攻击者重置Confluence并创建Confluence实例管理员帐户。根据漏洞库信息和搜索结果，该漏洞已被积极利用，甚至被用于部署Cerber勒索软件。提供的PoC代码通过以下步骤利用漏洞：

1.  **触发漏洞：** 通过发送GET请求到`/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false`，将Confluence置于未设置完成的状态。
2.  **创建管理员账户：** 向`/setup/setupadministrator.action`发送POST请求，创建一个新的管理员账户，用户名、密码等信息由用户提供。
3.  **验证：** 使用新创建的管理员账户登录，验证漏洞是否成功利用。

**有效性：** 根据漏洞描述、搜索结果以及PoC代码的逻辑，该PoC代码是有效的。 漏洞库信息和搜索结果也表明该漏洞已被积极利用。

**投毒风险：** PoC代码中未发现明显的恶意投毒代码。PoC的功能是利用漏洞创建管理员账户。需要关注的是，攻击者在使用PoC时可能修改账户相关配置，但PoC本身没有发现后门或其他恶意操作。PoC里存在一些可以被利用的点，比如可以修改默认创建的用户配置信息,该用户密码可能被作者提前记录,所以PoC存在一定的风险,综合考虑判断投毒风险为5%。

**利用方式：** 攻击者利用此漏洞，无需任何凭据，通过两次HTTP请求即可创建一个Confluence管理员帐户，从而完全控制Confluence实例。

**项目地址:** [davidfortytwo/CVE-2023-22518](https://github.com/davidfortytwo/CVE-2023-22518)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)

---

## POC #8

**来源**: [CVE-2023-22518-ductink98lhp_analyze-Exploit-CVE-2023-22518-Confluence.md](../2023/CVE-2023-22518-ductink98lhp_analyze-Exploit-CVE-2023-22518-Confluence.md)

# CVE-2023-22518

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-22518-0x0d3ad_CVE-2023-22518.md](../2023/CVE-2023-22518-0x0d3ad_CVE-2023-22518.md)

## CVE-2023-22518-Confluence-不当授权

**漏洞编号:** CVE-2023-22518

**漏洞类型:** 不当授权

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 严重，可能导致完全机密性、完整性和可用性损失

**影响版本:** 所有受影响版本

**利用条件:** 目标Confluence实例未打补丁，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22518是一个存在于Atlassian Confluence Server和Data Center中的不当授权漏洞。未经身份验证的攻击者可以利用此漏洞重置Confluence并创建Confluence实例管理员帐户，从而执行所有可用的管理操作，包括但不限于完全控制系统。利用方式是攻击者发送一个包含恶意.zip文件的POST请求到/json/setup-restore.action端点，无需认证。'X-Atlassian-Token: no-check' header绕过了一些安全检查。如果利用成功，攻击者可以使用默认的'admin :: admin'凭据登录。虽然提供的POC代码本身看起来相对简单，直接利用了漏洞，但仍存在一些投毒风险，比如攻击者可能会修改上传的zip文件，在成功利用漏洞后植入后门或恶意软件，从而扩大攻击范围。`README.md` 文件中的免责声明表明作者已知此工具可能被用于非法目的。漏洞利用代码较为简单， 主要就是 zip 文件上传，理论上存在投毒风险，但主要取决于zip文件本身的内容，此代码只是简单构造了一个上传请求，并无恶意代码。因此，将`exploit.py`判定为存在高风险投毒是不准确的。风险主要来自于 zip 包的内容。因此，投毒风险定为10%。

**项目地址:** [0x0d3ad/CVE-2023-22518](https://github.com/0x0d3ad/CVE-2023-22518)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)

---

## POC #2

**来源**: [CVE-2023-22518-C1ph3rX13_CVE-2023-22518.md](../2023/CVE-2023-22518-C1ph3rX13_CVE-2023-22518.md)

## CVE-2023-22518-Atlassian Confluence 认证绕过

**漏洞编号:** CVE-2023-22518

**漏洞类型:** 认证绕过

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，可能导致完全控制 Confluence 实例

**影响版本:** 所有版本 < 7.19.16, < 8.3.4, < 8.4.4, < 8.5.3, < 8.6.1 的 Confluence Data Center and Server

**利用条件:** 目标 Confluence 实例未打补丁且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22518 是 Atlassian Confluence Data Center 和 Server 中的一个认证绕过漏洞。未经身份验证的攻击者可以利用此漏洞重置 Confluence 并创建一个 Confluence 实例管理员帐户，从而完全控制 Confluence 实例。\n\n**利用方式分析：**\n\n1.  **漏洞原理：** 该漏洞源于 Confluence 在特定恢复/安装场景下对认证的错误处理。攻击者可以利用特定的 API 端点在未授权的情况下执行系统恢复操作，并创建新的管理员账户。\n2.  **POC 代码分析：** 提供的 POC 代码首先尝试上传一个伪造的 ZIP 文件到 `/json/setup-restore.action` 或 `/json/setup-restore-local.action` 端点，目的是触发服务器返回包含服务器路径信息的响应。即使上传的文件内容无效，如果服务器响应包含特定的文本（"The zip file did not contain an entry" 和 "exportDescriptor.properties"），则表明目标存在漏洞。\n3.  **利用过程：** 漏洞成功利用后，攻击者可以上传包含恶意配置的 ZIP 文件，该文件能够重置系统并创建一个新的管理员账户，一般账户名为admin，密码admin。攻击者然后可以使用此账户登录并完全控制 Confluence 实例。\n\n**投毒风险分析：**\n\n代码中存在一定的投毒风险，例如，代码中`exp` 函数会尝试使用一个本地zip文件进行利用，如果这个zip文件被替换成恶意文件，比如植入webshell，存在后门风险。此外，虽然代码本身看起来简单，但是可能隐藏了更复杂的利用逻辑或者恶意行为（例如，尝试连接到外部服务器，收集信息等）。考虑到代码的简洁性以及主要功能集中于漏洞利用，投毒可能性较低，预估为10%。

**项目地址:** [C1ph3rX13/CVE-2023-22518](https://github.com/C1ph3rX13/CVE-2023-22518)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)

---

## POC #3

**来源**: [CVE-2023-22518-ForceFledgling_CVE-2023-22518.md](../2023/CVE-2023-22518-ForceFledgling_CVE-2023-22518.md)

## CVE-2023-22518 - Atlassian Confluence Improper Authorization

**漏洞编号:** CVE-2023-22518

**漏洞类型:** Improper Authorization

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，可能导致完全机密性、完整性和可用性损失

**影响版本:** 所有受影响版本（不包括不受影响版本）

**利用条件:** 需要网络访问Confluence实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22518是一个严重的未授权漏洞，影响Atlassian Confluence Data Center和Server的所有版本。未经身份验证的攻击者可以利用此漏洞重置Confluence实例并创建一个Confluence实例管理员帐户。利用该账户，攻击者可以执行Confluence实例管理员可用的所有管理操作，从而导致完全的机密性、完整性和可用性损失。

**有效性：**
根据漏洞描述和提供的POC代码，此漏洞利用方法有效。POC通过向`/json/setup-restore.action`发送POST请求，上传包含恶意数据的zip文件，绕过身份验证，从而重置Confluence并创建一个管理员账户。搜索引擎结果也表明该漏洞已经被积极利用。

**投毒风险：**
分析提供的POC代码，没有发现明显的投毒代码。该POC的核心功能是利用未授权的`/json/setup-restore.action`接口进行数据库恢复，从而创建一个新的管理员账户。风险点主要集中在上传的`exploit-restore.zip`文件中的数据，该数据用于重置Confluence实例。如果攻击者提供的ZIP数据包含恶意配置或后门，则可能存在投毒风险。这里我们仅分析仓库提供的POC代码，并未对ZIP文件进行分析，因此我们认为仓库本身投毒风险为0%。

**利用方式：**
1.  攻击者构造一个POST请求，目标URL为`/json/setup-restore.action?synchronous=true`。
2.  请求体包含`buildIndex`参数设置为`false`，`file`参数上传恶意构造的zip文件（`exploit-restore.zip`），以及`edit`参数设置为`Upload and import`。
3.  通过设置`synchronous=true`参数，确保恢复操作同步执行。
4.  由于`/json/setup-restore.action`接口缺少身份验证检查，攻击者可以绕过身份验证，成功上传恶意zip文件并触发恢复操作。
5.  `exploit-restore.zip`中的数据用于重置Confluence实例，包括创建一个新的管理员账户。
6.  攻击者使用新创建的管理员账户登录Confluence，并获得完全的管理权限。

**项目地址:** [ForceFledgling/CVE-2023-22518](https://github.com/ForceFledgling/CVE-2023-22518)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)

---

## POC #4

**来源**: [CVE-2023-22518-Lilly-dox_Exploit-CVE-2023-22518.md](../2023/CVE-2023-22518-Lilly-dox_Exploit-CVE-2023-22518.md)

## CVE-2023-22518-Confluence-不当授权漏洞

**漏洞编号:** CVE-2023-22518

**漏洞类型:** 不当授权

**影响应用:** Confluence Data Center and Server

**危害等级:** 严重，可能导致完全丧失机密性、完整性和可用性

**影响版本:** 所有版本（不受影响的版本除外，详见漏洞库信息）

**利用条件:** 需要网络访问 Confluence 服务

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2023-22518 是一个 Confluence Data Center 和 Server 的不当授权漏洞。未经身份验证的攻击者可以利用此漏洞重置 Confluence 并创建一个 Confluence 实例管理员帐户。使用此帐户，攻击者可以执行 Confluence 实例管理员可用的所有管理操作，从而导致完全丧失机密性、完整性和可用性。

**有效性：**
该POC代码主要侧重于环境搭建和调试分析，并没有提供直接可用的exp。文档描述了如何搭建存在漏洞的环境，并指导开发者如何通过diff新旧版本jar包，并使用断点调试来理解漏洞原理。因此，可以认为该POC代码提供了漏洞分析的基础，但缺乏直接利用的payload。

**投毒风险：**
该存储库包含了一些环境搭建和调试的截图，其中MySQL数据库配置部分包含了创建数据库和用户的SQL语句。这些SQL语句本身不具有投毒性，但如果用户直接复制粘贴到生产环境，并使用了文档中提供的弱口令（如`admin123`和`supersecure`），则会引入安全风险。同时，提供的`my.cnf`配置文件中的`log_bin_trust_function_creators = 1`配置，若非必要，在生产环境中开启也存在一定风险。代码仓库本身旨在分析漏洞，但其中一些配置如果被不安全地采用，可能会导致安全问题。因此，投毒风险评估为30%。

**利用方式：**
利用方式主要是通过未授权访问相关接口，重置 Confluence 实例并创建管理员账户。结合搜索引擎信息，确认漏洞利用无需认证。利用此漏洞可以完全控制受影响的 Confluence 服务器。

**漏洞细节补充:**
根据对提供的代码仓库分析，漏洞根源可能在于 `/json` 命名空间继承自 `/admin` 命名空间，导致原本需要管理员权限才能访问的 `/admin` 下的某些功能，可以直接通过 `/json` 命名空间访问，从而绕过权限校验。

**项目地址:** [Lilly-dox/Exploit-CVE-2023-22518](https://github.com/Lilly-dox/Exploit-CVE-2023-22518)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)

---

## POC #5

**来源**: [CVE-2023-22518-RevoltSecurities_CVE-2023-22518.md](../2023/CVE-2023-22518-RevoltSecurities_CVE-2023-22518.md)

## CVE-2023-22518 - Atlassian Confluence Improper Authorization

**漏洞编号:** CVE-2023-22518

**漏洞类型:** Improper Authorization

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，可能导致完全的机密性、完整性和可用性丧失

**影响版本:** 所有受影响版本（低于 7.19.16, 8.3.4, 8.4.4, 8.5.3, 8.6.1）

**利用条件:** 目标Confluence服务器未打补丁，且可通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22518 是一个严重的权限绕过漏洞，影响 Atlassian Confluence Data Center 和 Server 的多个版本。未经身份验证的攻击者可以利用此漏洞重置 Confluence 实例并创建管理员帐户。利用此管理员权限，攻击者可以执行所有管理操作，从而导致完全的信息泄露、数据篡改和拒绝服务。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，该漏洞的利用是有效的。搜索引擎结果显示该漏洞已被积极利用，并与勒索软件攻击相关联（如 C3RB3R 勒索软件）。Rapid7 也确认了漏洞的利用情况。

POC 代码提供了一个 Python 脚本，可以利用该漏洞。它包含必要的参数，如目标域、输出文件、代理和超时，允许用户测试和验证漏洞。

**投毒风险分析：**

代码中可能存在一些细微的投毒风险，尽管作者已经声明仅用于合法目的。例如，`exploit.py` 脚本在没有充分验证目标的情况下发送请求，这可能被滥用以进行未经授权的访问。此外，虽然代码本身没有明显的恶意功能，但攻击者可以修改该代码以包含后门或其他恶意有效负载。

风险评估：10%。风险较低是由于该POC结构比较简单，容易阅读和审计，不容易隐藏恶意代码。

**利用方式分析：**

1.  **权限绕过：** 漏洞允许未经身份验证的攻击者绕过身份验证机制。
2.  **实例重置：** 攻击者可以利用漏洞重置 Confluence 实例到初始状态。
3.  **管理员帐户创建：** 在重置后，攻击者可以创建一个新的管理员帐户。
4.  **完全控制：** 使用新创建的管理员帐户，攻击者获得对 Confluence 实例的完全控制权，能够访问和修改数据、安装恶意软件等。
5. **攻击方式:** 通过发送特定的恶意请求到未授权的接口，触发Confluence实例的重置流程。

**缓解措施：**

*   立即将 Confluence Server 和 Data Center 升级到不受影响的版本（7.19.16 或更高版本，8.3.4 或更高版本，8.4.4 或更高版本，8.5.3 或更高版本，8.6.1 或更高版本）。
*   如果无法立即升级，请应用 Atlassian 提供的临时缓解措施。
*   监控 Confluence 服务器是否存在可疑活动。

**项目地址:** [RevoltSecurities/CVE-2023-22518](https://github.com/RevoltSecurities/CVE-2023-22518)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)

---

## POC #6

**来源**: [CVE-2023-22518-bibo318_CVE-2023-22518.md](../2023/CVE-2023-22518-bibo318_CVE-2023-22518.md)

## CVE-2023-22518-Atlassian Confluence-未授权重置与管理员创建

**漏洞编号:** CVE-2023-22518

**漏洞类型:** 未授权访问

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，完全丧失机密性、完整性和可用性

**影响版本:** 所有受影响版本 (参考漏洞库信息)

**利用条件:** 需要网络访问Confluence实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22518是一个存在于Atlassian Confluence Server和Data Center中的未授权漏洞。未经身份验证的攻击者可以通过此漏洞重置Confluence并创建Confluence实例管理员帐户。利用此帐户，攻击者可以执行Confluence实例管理员可执行的所有管理操作，导致完全丧失机密性、完整性和可用性。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，此漏洞影响所有Confluence Data Center和Server版本，除了已修复的版本。Rapid7等机构也确认了该漏洞正在被利用。提供的PoC代码描述了一种利用方式，通过向`/json/setup-restore.action`端点发送特制的POST请求，可以绕过身份验证并重置Confluence实例。PoC中特别提到了将`synchronous`参数设置为`true`的重要性，这可能是在早期利用尝试中被忽略的一个关键因素。

**利用方式分析：**

1.  **目标端点：**/json/setup-restore.action
2.  **HTTP方法：**POST
3.  **绕过：**利用/json命名空间绕过WebSudoInterceptor的身份验证要求。
4.  **参数：**
    *   `synchronous=true`:  使恢复操作同步执行，这对于成功利用至关重要。
    *   `buildIndex=false`
    *   `file`: 包含恶意恢复数据的ZIP文件，用于创建管理员帐户。
    *   `edit=Upload and import`
5.  **结果：**成功利用此漏洞将允许攻击者创建Confluence实例管理员帐户，从而完全控制Confluence系统。

**投毒风险分析：**

提供的漏洞利用代码主要是一个漏洞分析报告，包含了利用该漏洞的原理和方法，还提供了基于发现的漏洞的利用示例 YAML。其中利用方式是通过上传 ZIP 数据控制confluence。因此，投毒风险主要集中在 ZIP_DATA 文件中，可能包含恶意代码（例如 webshell）。由于无法直接分析 ZIP_DATA 的内容，因此无法给出准确的投毒百分比。给出的10%是基于`exploit-restore.zip` 可能包含恶意代码的可能性进行评估的，即ZIP文件中可能包含植入后门的恶意脚本。


**项目地址:** [bibo318/CVE-2023-22518](https://github.com/bibo318/CVE-2023-22518)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)

---

## POC #7

**来源**: [CVE-2023-22518-davidfortytwo_CVE-2023-22518.md](../2023/CVE-2023-22518-davidfortytwo_CVE-2023-22518.md)

## CVE-2023-22518 - Confluence Server/Data Center Improper Authorization

**漏洞编号:** CVE-2023-22518

**漏洞类型:** Improper Authorization

**影响应用:** Confluence Server/Data Center

**危害等级:** 高危，完全丧失保密性、完整性和可用性

**影响版本:** All versions of Confluence Data Center and Server are affected except versions >= 7.19.16, >= 8.3.4, >= 8.4.4, >= 8.5.3, >= 8.6.1

**利用条件:** 需要网络访问未打补丁的Confluence实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-22518是一个Confluence Server和Data Center的严重漏洞，允许未经身份验证的攻击者重置Confluence并创建Confluence实例管理员帐户。根据漏洞库信息和搜索结果，该漏洞已被积极利用，甚至被用于部署Cerber勒索软件。提供的PoC代码通过以下步骤利用漏洞：

1.  **触发漏洞：** 通过发送GET请求到`/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false`，将Confluence置于未设置完成的状态。
2.  **创建管理员账户：** 向`/setup/setupadministrator.action`发送POST请求，创建一个新的管理员账户，用户名、密码等信息由用户提供。
3.  **验证：** 使用新创建的管理员账户登录，验证漏洞是否成功利用。

**有效性：** 根据漏洞描述、搜索结果以及PoC代码的逻辑，该PoC代码是有效的。 漏洞库信息和搜索结果也表明该漏洞已被积极利用。

**投毒风险：** PoC代码中未发现明显的恶意投毒代码。PoC的功能是利用漏洞创建管理员账户。需要关注的是，攻击者在使用PoC时可能修改账户相关配置，但PoC本身没有发现后门或其他恶意操作。PoC里存在一些可以被利用的点，比如可以修改默认创建的用户配置信息,该用户密码可能被作者提前记录,所以PoC存在一定的风险,综合考虑判断投毒风险为5%。

**利用方式：** 攻击者利用此漏洞，无需任何凭据，通过两次HTTP请求即可创建一个Confluence管理员帐户，从而完全控制Confluence实例。

**项目地址:** [davidfortytwo/CVE-2023-22518](https://github.com/davidfortytwo/CVE-2023-22518)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)

---

## POC #8

**来源**: [CVE-2023-22518-ductink98lhp_analyze-Exploit-CVE-2023-22518-Confluence.md](../2023/CVE-2023-22518-ductink98lhp_analyze-Exploit-CVE-2023-22518-Confluence.md)

# CVE-2023-22518

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-22518-0x0d3ad_CVE-2023-22518.md](../2023/CVE-2023-22518-0x0d3ad_CVE-2023-22518.md)

## CVE-2023-22518-Confluence-不当授权

**漏洞编号:** CVE-2023-22518

**漏洞类型:** 不当授权

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 严重，可能导致完全机密性、完整性和可用性损失

**影响版本:** 所有受影响版本

**利用条件:** 目标Confluence实例未打补丁，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22518是一个存在于Atlassian Confluence Server和Data Center中的不当授权漏洞。未经身份验证的攻击者可以利用此漏洞重置Confluence并创建Confluence实例管理员帐户，从而执行所有可用的管理操作，包括但不限于完全控制系统。利用方式是攻击者发送一个包含恶意.zip文件的POST请求到/json/setup-restore.action端点，无需认证。'X-Atlassian-Token: no-check' header绕过了一些安全检查。如果利用成功，攻击者可以使用默认的'admin :: admin'凭据登录。虽然提供的POC代码本身看起来相对简单，直接利用了漏洞，但仍存在一些投毒风险，比如攻击者可能会修改上传的zip文件，在成功利用漏洞后植入后门或恶意软件，从而扩大攻击范围。`README.md` 文件中的免责声明表明作者已知此工具可能被用于非法目的。漏洞利用代码较为简单， 主要就是 zip 文件上传，理论上存在投毒风险，但主要取决于zip文件本身的内容，此代码只是简单构造了一个上传请求，并无恶意代码。因此，将`exploit.py`判定为存在高风险投毒是不准确的。风险主要来自于 zip 包的内容。因此，投毒风险定为10%。

**项目地址:** [0x0d3ad/CVE-2023-22518](https://github.com/0x0d3ad/CVE-2023-22518)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)

---

## POC #2

**来源**: [CVE-2023-22518-C1ph3rX13_CVE-2023-22518.md](../2023/CVE-2023-22518-C1ph3rX13_CVE-2023-22518.md)

## CVE-2023-22518-Atlassian Confluence 认证绕过

**漏洞编号:** CVE-2023-22518

**漏洞类型:** 认证绕过

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，可能导致完全控制 Confluence 实例

**影响版本:** 所有版本 < 7.19.16, < 8.3.4, < 8.4.4, < 8.5.3, < 8.6.1 的 Confluence Data Center and Server

**利用条件:** 目标 Confluence 实例未打补丁且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22518 是 Atlassian Confluence Data Center 和 Server 中的一个认证绕过漏洞。未经身份验证的攻击者可以利用此漏洞重置 Confluence 并创建一个 Confluence 实例管理员帐户，从而完全控制 Confluence 实例。\n\n**利用方式分析：**\n\n1.  **漏洞原理：** 该漏洞源于 Confluence 在特定恢复/安装场景下对认证的错误处理。攻击者可以利用特定的 API 端点在未授权的情况下执行系统恢复操作，并创建新的管理员账户。\n2.  **POC 代码分析：** 提供的 POC 代码首先尝试上传一个伪造的 ZIP 文件到 `/json/setup-restore.action` 或 `/json/setup-restore-local.action` 端点，目的是触发服务器返回包含服务器路径信息的响应。即使上传的文件内容无效，如果服务器响应包含特定的文本（"The zip file did not contain an entry" 和 "exportDescriptor.properties"），则表明目标存在漏洞。\n3.  **利用过程：** 漏洞成功利用后，攻击者可以上传包含恶意配置的 ZIP 文件，该文件能够重置系统并创建一个新的管理员账户，一般账户名为admin，密码admin。攻击者然后可以使用此账户登录并完全控制 Confluence 实例。\n\n**投毒风险分析：**\n\n代码中存在一定的投毒风险，例如，代码中`exp` 函数会尝试使用一个本地zip文件进行利用，如果这个zip文件被替换成恶意文件，比如植入webshell，存在后门风险。此外，虽然代码本身看起来简单，但是可能隐藏了更复杂的利用逻辑或者恶意行为（例如，尝试连接到外部服务器，收集信息等）。考虑到代码的简洁性以及主要功能集中于漏洞利用，投毒可能性较低，预估为10%。

**项目地址:** [C1ph3rX13/CVE-2023-22518](https://github.com/C1ph3rX13/CVE-2023-22518)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)

---

## POC #3

**来源**: [CVE-2023-22518-ForceFledgling_CVE-2023-22518.md](../2023/CVE-2023-22518-ForceFledgling_CVE-2023-22518.md)

## CVE-2023-22518 - Atlassian Confluence Improper Authorization

**漏洞编号:** CVE-2023-22518

**漏洞类型:** Improper Authorization

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，可能导致完全机密性、完整性和可用性损失

**影响版本:** 所有受影响版本（不包括不受影响版本）

**利用条件:** 需要网络访问Confluence实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22518是一个严重的未授权漏洞，影响Atlassian Confluence Data Center和Server的所有版本。未经身份验证的攻击者可以利用此漏洞重置Confluence实例并创建一个Confluence实例管理员帐户。利用该账户，攻击者可以执行Confluence实例管理员可用的所有管理操作，从而导致完全的机密性、完整性和可用性损失。

**有效性：**
根据漏洞描述和提供的POC代码，此漏洞利用方法有效。POC通过向`/json/setup-restore.action`发送POST请求，上传包含恶意数据的zip文件，绕过身份验证，从而重置Confluence并创建一个管理员账户。搜索引擎结果也表明该漏洞已经被积极利用。

**投毒风险：**
分析提供的POC代码，没有发现明显的投毒代码。该POC的核心功能是利用未授权的`/json/setup-restore.action`接口进行数据库恢复，从而创建一个新的管理员账户。风险点主要集中在上传的`exploit-restore.zip`文件中的数据，该数据用于重置Confluence实例。如果攻击者提供的ZIP数据包含恶意配置或后门，则可能存在投毒风险。这里我们仅分析仓库提供的POC代码，并未对ZIP文件进行分析，因此我们认为仓库本身投毒风险为0%。

**利用方式：**
1.  攻击者构造一个POST请求，目标URL为`/json/setup-restore.action?synchronous=true`。
2.  请求体包含`buildIndex`参数设置为`false`，`file`参数上传恶意构造的zip文件（`exploit-restore.zip`），以及`edit`参数设置为`Upload and import`。
3.  通过设置`synchronous=true`参数，确保恢复操作同步执行。
4.  由于`/json/setup-restore.action`接口缺少身份验证检查，攻击者可以绕过身份验证，成功上传恶意zip文件并触发恢复操作。
5.  `exploit-restore.zip`中的数据用于重置Confluence实例，包括创建一个新的管理员账户。
6.  攻击者使用新创建的管理员账户登录Confluence，并获得完全的管理权限。

**项目地址:** [ForceFledgling/CVE-2023-22518](https://github.com/ForceFledgling/CVE-2023-22518)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)

---

## POC #4

**来源**: [CVE-2023-22518-Lilly-dox_Exploit-CVE-2023-22518.md](../2023/CVE-2023-22518-Lilly-dox_Exploit-CVE-2023-22518.md)

## CVE-2023-22518-Confluence-不当授权漏洞

**漏洞编号:** CVE-2023-22518

**漏洞类型:** 不当授权

**影响应用:** Confluence Data Center and Server

**危害等级:** 严重，可能导致完全丧失机密性、完整性和可用性

**影响版本:** 所有版本（不受影响的版本除外，详见漏洞库信息）

**利用条件:** 需要网络访问 Confluence 服务

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2023-22518 是一个 Confluence Data Center 和 Server 的不当授权漏洞。未经身份验证的攻击者可以利用此漏洞重置 Confluence 并创建一个 Confluence 实例管理员帐户。使用此帐户，攻击者可以执行 Confluence 实例管理员可用的所有管理操作，从而导致完全丧失机密性、完整性和可用性。

**有效性：**
该POC代码主要侧重于环境搭建和调试分析，并没有提供直接可用的exp。文档描述了如何搭建存在漏洞的环境，并指导开发者如何通过diff新旧版本jar包，并使用断点调试来理解漏洞原理。因此，可以认为该POC代码提供了漏洞分析的基础，但缺乏直接利用的payload。

**投毒风险：**
该存储库包含了一些环境搭建和调试的截图，其中MySQL数据库配置部分包含了创建数据库和用户的SQL语句。这些SQL语句本身不具有投毒性，但如果用户直接复制粘贴到生产环境，并使用了文档中提供的弱口令（如`admin123`和`supersecure`），则会引入安全风险。同时，提供的`my.cnf`配置文件中的`log_bin_trust_function_creators = 1`配置，若非必要，在生产环境中开启也存在一定风险。代码仓库本身旨在分析漏洞，但其中一些配置如果被不安全地采用，可能会导致安全问题。因此，投毒风险评估为30%。

**利用方式：**
利用方式主要是通过未授权访问相关接口，重置 Confluence 实例并创建管理员账户。结合搜索引擎信息，确认漏洞利用无需认证。利用此漏洞可以完全控制受影响的 Confluence 服务器。

**漏洞细节补充:**
根据对提供的代码仓库分析，漏洞根源可能在于 `/json` 命名空间继承自 `/admin` 命名空间，导致原本需要管理员权限才能访问的 `/admin` 下的某些功能，可以直接通过 `/json` 命名空间访问，从而绕过权限校验。

**项目地址:** [Lilly-dox/Exploit-CVE-2023-22518](https://github.com/Lilly-dox/Exploit-CVE-2023-22518)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)

---

## POC #5

**来源**: [CVE-2023-22518-RevoltSecurities_CVE-2023-22518.md](../2023/CVE-2023-22518-RevoltSecurities_CVE-2023-22518.md)

## CVE-2023-22518 - Atlassian Confluence Improper Authorization

**漏洞编号:** CVE-2023-22518

**漏洞类型:** Improper Authorization

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，可能导致完全的机密性、完整性和可用性丧失

**影响版本:** 所有受影响版本（低于 7.19.16, 8.3.4, 8.4.4, 8.5.3, 8.6.1）

**利用条件:** 目标Confluence服务器未打补丁，且可通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22518 是一个严重的权限绕过漏洞，影响 Atlassian Confluence Data Center 和 Server 的多个版本。未经身份验证的攻击者可以利用此漏洞重置 Confluence 实例并创建管理员帐户。利用此管理员权限，攻击者可以执行所有管理操作，从而导致完全的信息泄露、数据篡改和拒绝服务。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，该漏洞的利用是有效的。搜索引擎结果显示该漏洞已被积极利用，并与勒索软件攻击相关联（如 C3RB3R 勒索软件）。Rapid7 也确认了漏洞的利用情况。

POC 代码提供了一个 Python 脚本，可以利用该漏洞。它包含必要的参数，如目标域、输出文件、代理和超时，允许用户测试和验证漏洞。

**投毒风险分析：**

代码中可能存在一些细微的投毒风险，尽管作者已经声明仅用于合法目的。例如，`exploit.py` 脚本在没有充分验证目标的情况下发送请求，这可能被滥用以进行未经授权的访问。此外，虽然代码本身没有明显的恶意功能，但攻击者可以修改该代码以包含后门或其他恶意有效负载。

风险评估：10%。风险较低是由于该POC结构比较简单，容易阅读和审计，不容易隐藏恶意代码。

**利用方式分析：**

1.  **权限绕过：** 漏洞允许未经身份验证的攻击者绕过身份验证机制。
2.  **实例重置：** 攻击者可以利用漏洞重置 Confluence 实例到初始状态。
3.  **管理员帐户创建：** 在重置后，攻击者可以创建一个新的管理员帐户。
4.  **完全控制：** 使用新创建的管理员帐户，攻击者获得对 Confluence 实例的完全控制权，能够访问和修改数据、安装恶意软件等。
5. **攻击方式:** 通过发送特定的恶意请求到未授权的接口，触发Confluence实例的重置流程。

**缓解措施：**

*   立即将 Confluence Server 和 Data Center 升级到不受影响的版本（7.19.16 或更高版本，8.3.4 或更高版本，8.4.4 或更高版本，8.5.3 或更高版本，8.6.1 或更高版本）。
*   如果无法立即升级，请应用 Atlassian 提供的临时缓解措施。
*   监控 Confluence 服务器是否存在可疑活动。

**项目地址:** [RevoltSecurities/CVE-2023-22518](https://github.com/RevoltSecurities/CVE-2023-22518)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)

---

## POC #6

**来源**: [CVE-2023-22518-bibo318_CVE-2023-22518.md](../2023/CVE-2023-22518-bibo318_CVE-2023-22518.md)

## CVE-2023-22518-Atlassian Confluence-未授权重置与管理员创建

**漏洞编号:** CVE-2023-22518

**漏洞类型:** 未授权访问

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，完全丧失机密性、完整性和可用性

**影响版本:** 所有受影响版本 (参考漏洞库信息)

**利用条件:** 需要网络访问Confluence实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22518是一个存在于Atlassian Confluence Server和Data Center中的未授权漏洞。未经身份验证的攻击者可以通过此漏洞重置Confluence并创建Confluence实例管理员帐户。利用此帐户，攻击者可以执行Confluence实例管理员可执行的所有管理操作，导致完全丧失机密性、完整性和可用性。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，此漏洞影响所有Confluence Data Center和Server版本，除了已修复的版本。Rapid7等机构也确认了该漏洞正在被利用。提供的PoC代码描述了一种利用方式，通过向`/json/setup-restore.action`端点发送特制的POST请求，可以绕过身份验证并重置Confluence实例。PoC中特别提到了将`synchronous`参数设置为`true`的重要性，这可能是在早期利用尝试中被忽略的一个关键因素。

**利用方式分析：**

1.  **目标端点：**/json/setup-restore.action
2.  **HTTP方法：**POST
3.  **绕过：**利用/json命名空间绕过WebSudoInterceptor的身份验证要求。
4.  **参数：**
    *   `synchronous=true`:  使恢复操作同步执行，这对于成功利用至关重要。
    *   `buildIndex=false`
    *   `file`: 包含恶意恢复数据的ZIP文件，用于创建管理员帐户。
    *   `edit=Upload and import`
5.  **结果：**成功利用此漏洞将允许攻击者创建Confluence实例管理员帐户，从而完全控制Confluence系统。

**投毒风险分析：**

提供的漏洞利用代码主要是一个漏洞分析报告，包含了利用该漏洞的原理和方法，还提供了基于发现的漏洞的利用示例 YAML。其中利用方式是通过上传 ZIP 数据控制confluence。因此，投毒风险主要集中在 ZIP_DATA 文件中，可能包含恶意代码（例如 webshell）。由于无法直接分析 ZIP_DATA 的内容，因此无法给出准确的投毒百分比。给出的10%是基于`exploit-restore.zip` 可能包含恶意代码的可能性进行评估的，即ZIP文件中可能包含植入后门的恶意脚本。


**项目地址:** [bibo318/CVE-2023-22518](https://github.com/bibo318/CVE-2023-22518)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)

---

## POC #7

**来源**: [CVE-2023-22518-davidfortytwo_CVE-2023-22518.md](../2023/CVE-2023-22518-davidfortytwo_CVE-2023-22518.md)

## CVE-2023-22518 - Confluence Server/Data Center Improper Authorization

**漏洞编号:** CVE-2023-22518

**漏洞类型:** Improper Authorization

**影响应用:** Confluence Server/Data Center

**危害等级:** 高危，完全丧失保密性、完整性和可用性

**影响版本:** All versions of Confluence Data Center and Server are affected except versions >= 7.19.16, >= 8.3.4, >= 8.4.4, >= 8.5.3, >= 8.6.1

**利用条件:** 需要网络访问未打补丁的Confluence实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-22518是一个Confluence Server和Data Center的严重漏洞，允许未经身份验证的攻击者重置Confluence并创建Confluence实例管理员帐户。根据漏洞库信息和搜索结果，该漏洞已被积极利用，甚至被用于部署Cerber勒索软件。提供的PoC代码通过以下步骤利用漏洞：

1.  **触发漏洞：** 通过发送GET请求到`/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false`，将Confluence置于未设置完成的状态。
2.  **创建管理员账户：** 向`/setup/setupadministrator.action`发送POST请求，创建一个新的管理员账户，用户名、密码等信息由用户提供。
3.  **验证：** 使用新创建的管理员账户登录，验证漏洞是否成功利用。

**有效性：** 根据漏洞描述、搜索结果以及PoC代码的逻辑，该PoC代码是有效的。 漏洞库信息和搜索结果也表明该漏洞已被积极利用。

**投毒风险：** PoC代码中未发现明显的恶意投毒代码。PoC的功能是利用漏洞创建管理员账户。需要关注的是，攻击者在使用PoC时可能修改账户相关配置，但PoC本身没有发现后门或其他恶意操作。PoC里存在一些可以被利用的点，比如可以修改默认创建的用户配置信息,该用户密码可能被作者提前记录,所以PoC存在一定的风险,综合考虑判断投毒风险为5%。

**利用方式：** 攻击者利用此漏洞，无需任何凭据，通过两次HTTP请求即可创建一个Confluence管理员帐户，从而完全控制Confluence实例。

**项目地址:** [davidfortytwo/CVE-2023-22518](https://github.com/davidfortytwo/CVE-2023-22518)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)

---

## POC #8

**来源**: [CVE-2023-22518-ductink98lhp_analyze-Exploit-CVE-2023-22518-Confluence.md](../2023/CVE-2023-22518-ductink98lhp_analyze-Exploit-CVE-2023-22518-Confluence.md)

# CVE-2023-22518

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-22518-0x0d3ad_CVE-2023-22518.md](../2023/CVE-2023-22518-0x0d3ad_CVE-2023-22518.md)

## CVE-2023-22518-Confluence-不当授权

**漏洞编号:** CVE-2023-22518

**漏洞类型:** 不当授权

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 严重，可能导致完全机密性、完整性和可用性损失

**影响版本:** 所有受影响版本

**利用条件:** 目标Confluence实例未打补丁，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22518是一个存在于Atlassian Confluence Server和Data Center中的不当授权漏洞。未经身份验证的攻击者可以利用此漏洞重置Confluence并创建Confluence实例管理员帐户，从而执行所有可用的管理操作，包括但不限于完全控制系统。利用方式是攻击者发送一个包含恶意.zip文件的POST请求到/json/setup-restore.action端点，无需认证。'X-Atlassian-Token: no-check' header绕过了一些安全检查。如果利用成功，攻击者可以使用默认的'admin :: admin'凭据登录。虽然提供的POC代码本身看起来相对简单，直接利用了漏洞，但仍存在一些投毒风险，比如攻击者可能会修改上传的zip文件，在成功利用漏洞后植入后门或恶意软件，从而扩大攻击范围。`README.md` 文件中的免责声明表明作者已知此工具可能被用于非法目的。漏洞利用代码较为简单， 主要就是 zip 文件上传，理论上存在投毒风险，但主要取决于zip文件本身的内容，此代码只是简单构造了一个上传请求，并无恶意代码。因此，将`exploit.py`判定为存在高风险投毒是不准确的。风险主要来自于 zip 包的内容。因此，投毒风险定为10%。

**项目地址:** [0x0d3ad/CVE-2023-22518](https://github.com/0x0d3ad/CVE-2023-22518)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)

---

## POC #2

**来源**: [CVE-2023-22518-C1ph3rX13_CVE-2023-22518.md](../2023/CVE-2023-22518-C1ph3rX13_CVE-2023-22518.md)

## CVE-2023-22518-Atlassian Confluence 认证绕过

**漏洞编号:** CVE-2023-22518

**漏洞类型:** 认证绕过

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，可能导致完全控制 Confluence 实例

**影响版本:** 所有版本 < 7.19.16, < 8.3.4, < 8.4.4, < 8.5.3, < 8.6.1 的 Confluence Data Center and Server

**利用条件:** 目标 Confluence 实例未打补丁且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22518 是 Atlassian Confluence Data Center 和 Server 中的一个认证绕过漏洞。未经身份验证的攻击者可以利用此漏洞重置 Confluence 并创建一个 Confluence 实例管理员帐户，从而完全控制 Confluence 实例。\n\n**利用方式分析：**\n\n1.  **漏洞原理：** 该漏洞源于 Confluence 在特定恢复/安装场景下对认证的错误处理。攻击者可以利用特定的 API 端点在未授权的情况下执行系统恢复操作，并创建新的管理员账户。\n2.  **POC 代码分析：** 提供的 POC 代码首先尝试上传一个伪造的 ZIP 文件到 `/json/setup-restore.action` 或 `/json/setup-restore-local.action` 端点，目的是触发服务器返回包含服务器路径信息的响应。即使上传的文件内容无效，如果服务器响应包含特定的文本（"The zip file did not contain an entry" 和 "exportDescriptor.properties"），则表明目标存在漏洞。\n3.  **利用过程：** 漏洞成功利用后，攻击者可以上传包含恶意配置的 ZIP 文件，该文件能够重置系统并创建一个新的管理员账户，一般账户名为admin，密码admin。攻击者然后可以使用此账户登录并完全控制 Confluence 实例。\n\n**投毒风险分析：**\n\n代码中存在一定的投毒风险，例如，代码中`exp` 函数会尝试使用一个本地zip文件进行利用，如果这个zip文件被替换成恶意文件，比如植入webshell，存在后门风险。此外，虽然代码本身看起来简单，但是可能隐藏了更复杂的利用逻辑或者恶意行为（例如，尝试连接到外部服务器，收集信息等）。考虑到代码的简洁性以及主要功能集中于漏洞利用，投毒可能性较低，预估为10%。

**项目地址:** [C1ph3rX13/CVE-2023-22518](https://github.com/C1ph3rX13/CVE-2023-22518)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)

---

## POC #3

**来源**: [CVE-2023-22518-ForceFledgling_CVE-2023-22518.md](../2023/CVE-2023-22518-ForceFledgling_CVE-2023-22518.md)

## CVE-2023-22518 - Atlassian Confluence Improper Authorization

**漏洞编号:** CVE-2023-22518

**漏洞类型:** Improper Authorization

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，可能导致完全机密性、完整性和可用性损失

**影响版本:** 所有受影响版本（不包括不受影响版本）

**利用条件:** 需要网络访问Confluence实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22518是一个严重的未授权漏洞，影响Atlassian Confluence Data Center和Server的所有版本。未经身份验证的攻击者可以利用此漏洞重置Confluence实例并创建一个Confluence实例管理员帐户。利用该账户，攻击者可以执行Confluence实例管理员可用的所有管理操作，从而导致完全的机密性、完整性和可用性损失。

**有效性：**
根据漏洞描述和提供的POC代码，此漏洞利用方法有效。POC通过向`/json/setup-restore.action`发送POST请求，上传包含恶意数据的zip文件，绕过身份验证，从而重置Confluence并创建一个管理员账户。搜索引擎结果也表明该漏洞已经被积极利用。

**投毒风险：**
分析提供的POC代码，没有发现明显的投毒代码。该POC的核心功能是利用未授权的`/json/setup-restore.action`接口进行数据库恢复，从而创建一个新的管理员账户。风险点主要集中在上传的`exploit-restore.zip`文件中的数据，该数据用于重置Confluence实例。如果攻击者提供的ZIP数据包含恶意配置或后门，则可能存在投毒风险。这里我们仅分析仓库提供的POC代码，并未对ZIP文件进行分析，因此我们认为仓库本身投毒风险为0%。

**利用方式：**
1.  攻击者构造一个POST请求，目标URL为`/json/setup-restore.action?synchronous=true`。
2.  请求体包含`buildIndex`参数设置为`false`，`file`参数上传恶意构造的zip文件（`exploit-restore.zip`），以及`edit`参数设置为`Upload and import`。
3.  通过设置`synchronous=true`参数，确保恢复操作同步执行。
4.  由于`/json/setup-restore.action`接口缺少身份验证检查，攻击者可以绕过身份验证，成功上传恶意zip文件并触发恢复操作。
5.  `exploit-restore.zip`中的数据用于重置Confluence实例，包括创建一个新的管理员账户。
6.  攻击者使用新创建的管理员账户登录Confluence，并获得完全的管理权限。

**项目地址:** [ForceFledgling/CVE-2023-22518](https://github.com/ForceFledgling/CVE-2023-22518)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)

---

## POC #4

**来源**: [CVE-2023-22518-Lilly-dox_Exploit-CVE-2023-22518.md](../2023/CVE-2023-22518-Lilly-dox_Exploit-CVE-2023-22518.md)

## CVE-2023-22518-Confluence-不当授权漏洞

**漏洞编号:** CVE-2023-22518

**漏洞类型:** 不当授权

**影响应用:** Confluence Data Center and Server

**危害等级:** 严重，可能导致完全丧失机密性、完整性和可用性

**影响版本:** 所有版本（不受影响的版本除外，详见漏洞库信息）

**利用条件:** 需要网络访问 Confluence 服务

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2023-22518 是一个 Confluence Data Center 和 Server 的不当授权漏洞。未经身份验证的攻击者可以利用此漏洞重置 Confluence 并创建一个 Confluence 实例管理员帐户。使用此帐户，攻击者可以执行 Confluence 实例管理员可用的所有管理操作，从而导致完全丧失机密性、完整性和可用性。

**有效性：**
该POC代码主要侧重于环境搭建和调试分析，并没有提供直接可用的exp。文档描述了如何搭建存在漏洞的环境，并指导开发者如何通过diff新旧版本jar包，并使用断点调试来理解漏洞原理。因此，可以认为该POC代码提供了漏洞分析的基础，但缺乏直接利用的payload。

**投毒风险：**
该存储库包含了一些环境搭建和调试的截图，其中MySQL数据库配置部分包含了创建数据库和用户的SQL语句。这些SQL语句本身不具有投毒性，但如果用户直接复制粘贴到生产环境，并使用了文档中提供的弱口令（如`admin123`和`supersecure`），则会引入安全风险。同时，提供的`my.cnf`配置文件中的`log_bin_trust_function_creators = 1`配置，若非必要，在生产环境中开启也存在一定风险。代码仓库本身旨在分析漏洞，但其中一些配置如果被不安全地采用，可能会导致安全问题。因此，投毒风险评估为30%。

**利用方式：**
利用方式主要是通过未授权访问相关接口，重置 Confluence 实例并创建管理员账户。结合搜索引擎信息，确认漏洞利用无需认证。利用此漏洞可以完全控制受影响的 Confluence 服务器。

**漏洞细节补充:**
根据对提供的代码仓库分析，漏洞根源可能在于 `/json` 命名空间继承自 `/admin` 命名空间，导致原本需要管理员权限才能访问的 `/admin` 下的某些功能，可以直接通过 `/json` 命名空间访问，从而绕过权限校验。

**项目地址:** [Lilly-dox/Exploit-CVE-2023-22518](https://github.com/Lilly-dox/Exploit-CVE-2023-22518)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)

---

## POC #5

**来源**: [CVE-2023-22518-RevoltSecurities_CVE-2023-22518.md](../2023/CVE-2023-22518-RevoltSecurities_CVE-2023-22518.md)

## CVE-2023-22518 - Atlassian Confluence Improper Authorization

**漏洞编号:** CVE-2023-22518

**漏洞类型:** Improper Authorization

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，可能导致完全的机密性、完整性和可用性丧失

**影响版本:** 所有受影响版本（低于 7.19.16, 8.3.4, 8.4.4, 8.5.3, 8.6.1）

**利用条件:** 目标Confluence服务器未打补丁，且可通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22518 是一个严重的权限绕过漏洞，影响 Atlassian Confluence Data Center 和 Server 的多个版本。未经身份验证的攻击者可以利用此漏洞重置 Confluence 实例并创建管理员帐户。利用此管理员权限，攻击者可以执行所有管理操作，从而导致完全的信息泄露、数据篡改和拒绝服务。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，该漏洞的利用是有效的。搜索引擎结果显示该漏洞已被积极利用，并与勒索软件攻击相关联（如 C3RB3R 勒索软件）。Rapid7 也确认了漏洞的利用情况。

POC 代码提供了一个 Python 脚本，可以利用该漏洞。它包含必要的参数，如目标域、输出文件、代理和超时，允许用户测试和验证漏洞。

**投毒风险分析：**

代码中可能存在一些细微的投毒风险，尽管作者已经声明仅用于合法目的。例如，`exploit.py` 脚本在没有充分验证目标的情况下发送请求，这可能被滥用以进行未经授权的访问。此外，虽然代码本身没有明显的恶意功能，但攻击者可以修改该代码以包含后门或其他恶意有效负载。

风险评估：10%。风险较低是由于该POC结构比较简单，容易阅读和审计，不容易隐藏恶意代码。

**利用方式分析：**

1.  **权限绕过：** 漏洞允许未经身份验证的攻击者绕过身份验证机制。
2.  **实例重置：** 攻击者可以利用漏洞重置 Confluence 实例到初始状态。
3.  **管理员帐户创建：** 在重置后，攻击者可以创建一个新的管理员帐户。
4.  **完全控制：** 使用新创建的管理员帐户，攻击者获得对 Confluence 实例的完全控制权，能够访问和修改数据、安装恶意软件等。
5. **攻击方式:** 通过发送特定的恶意请求到未授权的接口，触发Confluence实例的重置流程。

**缓解措施：**

*   立即将 Confluence Server 和 Data Center 升级到不受影响的版本（7.19.16 或更高版本，8.3.4 或更高版本，8.4.4 或更高版本，8.5.3 或更高版本，8.6.1 或更高版本）。
*   如果无法立即升级，请应用 Atlassian 提供的临时缓解措施。
*   监控 Confluence 服务器是否存在可疑活动。

**项目地址:** [RevoltSecurities/CVE-2023-22518](https://github.com/RevoltSecurities/CVE-2023-22518)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)

---

## POC #6

**来源**: [CVE-2023-22518-bibo318_CVE-2023-22518.md](../2023/CVE-2023-22518-bibo318_CVE-2023-22518.md)

## CVE-2023-22518-Atlassian Confluence-未授权重置与管理员创建

**漏洞编号:** CVE-2023-22518

**漏洞类型:** 未授权访问

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，完全丧失机密性、完整性和可用性

**影响版本:** 所有受影响版本 (参考漏洞库信息)

**利用条件:** 需要网络访问Confluence实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22518是一个存在于Atlassian Confluence Server和Data Center中的未授权漏洞。未经身份验证的攻击者可以通过此漏洞重置Confluence并创建Confluence实例管理员帐户。利用此帐户，攻击者可以执行Confluence实例管理员可执行的所有管理操作，导致完全丧失机密性、完整性和可用性。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，此漏洞影响所有Confluence Data Center和Server版本，除了已修复的版本。Rapid7等机构也确认了该漏洞正在被利用。提供的PoC代码描述了一种利用方式，通过向`/json/setup-restore.action`端点发送特制的POST请求，可以绕过身份验证并重置Confluence实例。PoC中特别提到了将`synchronous`参数设置为`true`的重要性，这可能是在早期利用尝试中被忽略的一个关键因素。

**利用方式分析：**

1.  **目标端点：**/json/setup-restore.action
2.  **HTTP方法：**POST
3.  **绕过：**利用/json命名空间绕过WebSudoInterceptor的身份验证要求。
4.  **参数：**
    *   `synchronous=true`:  使恢复操作同步执行，这对于成功利用至关重要。
    *   `buildIndex=false`
    *   `file`: 包含恶意恢复数据的ZIP文件，用于创建管理员帐户。
    *   `edit=Upload and import`
5.  **结果：**成功利用此漏洞将允许攻击者创建Confluence实例管理员帐户，从而完全控制Confluence系统。

**投毒风险分析：**

提供的漏洞利用代码主要是一个漏洞分析报告，包含了利用该漏洞的原理和方法，还提供了基于发现的漏洞的利用示例 YAML。其中利用方式是通过上传 ZIP 数据控制confluence。因此，投毒风险主要集中在 ZIP_DATA 文件中，可能包含恶意代码（例如 webshell）。由于无法直接分析 ZIP_DATA 的内容，因此无法给出准确的投毒百分比。给出的10%是基于`exploit-restore.zip` 可能包含恶意代码的可能性进行评估的，即ZIP文件中可能包含植入后门的恶意脚本。


**项目地址:** [bibo318/CVE-2023-22518](https://github.com/bibo318/CVE-2023-22518)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)

---

## POC #7

**来源**: [CVE-2023-22518-davidfortytwo_CVE-2023-22518.md](../2023/CVE-2023-22518-davidfortytwo_CVE-2023-22518.md)

## CVE-2023-22518 - Confluence Server/Data Center Improper Authorization

**漏洞编号:** CVE-2023-22518

**漏洞类型:** Improper Authorization

**影响应用:** Confluence Server/Data Center

**危害等级:** 高危，完全丧失保密性、完整性和可用性

**影响版本:** All versions of Confluence Data Center and Server are affected except versions >= 7.19.16, >= 8.3.4, >= 8.4.4, >= 8.5.3, >= 8.6.1

**利用条件:** 需要网络访问未打补丁的Confluence实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-22518是一个Confluence Server和Data Center的严重漏洞，允许未经身份验证的攻击者重置Confluence并创建Confluence实例管理员帐户。根据漏洞库信息和搜索结果，该漏洞已被积极利用，甚至被用于部署Cerber勒索软件。提供的PoC代码通过以下步骤利用漏洞：

1.  **触发漏洞：** 通过发送GET请求到`/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false`，将Confluence置于未设置完成的状态。
2.  **创建管理员账户：** 向`/setup/setupadministrator.action`发送POST请求，创建一个新的管理员账户，用户名、密码等信息由用户提供。
3.  **验证：** 使用新创建的管理员账户登录，验证漏洞是否成功利用。

**有效性：** 根据漏洞描述、搜索结果以及PoC代码的逻辑，该PoC代码是有效的。 漏洞库信息和搜索结果也表明该漏洞已被积极利用。

**投毒风险：** PoC代码中未发现明显的恶意投毒代码。PoC的功能是利用漏洞创建管理员账户。需要关注的是，攻击者在使用PoC时可能修改账户相关配置，但PoC本身没有发现后门或其他恶意操作。PoC里存在一些可以被利用的点，比如可以修改默认创建的用户配置信息,该用户密码可能被作者提前记录,所以PoC存在一定的风险,综合考虑判断投毒风险为5%。

**利用方式：** 攻击者利用此漏洞，无需任何凭据，通过两次HTTP请求即可创建一个Confluence管理员帐户，从而完全控制Confluence实例。

**项目地址:** [davidfortytwo/CVE-2023-22518](https://github.com/davidfortytwo/CVE-2023-22518)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)

---

## POC #8

**来源**: [CVE-2023-22518-ductink98lhp_analyze-Exploit-CVE-2023-22518-Confluence.md](../2023/CVE-2023-22518-ductink98lhp_analyze-Exploit-CVE-2023-22518-Confluence.md)

## CVE-2023-22518 - Atlassian Confluence Improper Authorization

**漏洞编号:** CVE-2023-22518

**漏洞类型:** Improper Authorization

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** Critical，完全控制 Confluence 实例，导致机密性、完整性和可用性完全丧失。

**影响版本:** All versions of Confluence Data Center and Server before fixes

**利用条件:** Confluence Server or Data Center is running and accessible over the network.

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22518 是一个未经授权的漏洞，影响所有版本的 Atlassian Confluence Data Center 和 Server。攻击者可以利用此漏洞重置 Confluence 并创建一个 Confluence 实例管理员帐户。利用此帐户，攻击者可以执行 Confluence 实例管理员可用的所有管理操作，从而导致完全丧失机密性、完整性和可用性。

**漏洞利用方式：**

1.  **未授权访问：** 未经身份验证的攻击者可以访问特定的 Confluence 端点。
2.  **重置 Confluence：** 攻击者利用漏洞重置 Confluence，绕过身份验证机制。
3.  **创建管理员账户：** 攻击者创建一个新的 Confluence 实例管理员账户。
4.  **完全控制：** 使用新创建的管理员账户，攻击者获得对 Confluence 实例的完全控制。

**PoC代码分析和有效性：**

提供的 PoC 代码片段侧重于漏洞的调试和环境搭建，展示了如何设置 Confluence 环境（使用特定版本 8.0.4）、配置数据库以及如何通过 diff 两个版本的文件（8.0.4 和 7.19.16）来查找漏洞点。代码片段表明，漏洞存在于身份验证和授权绕过中，与 CVE 描述相符。

通过分析`struts.xml`文件，可以发现/json namespace增强了/admin namespace，导致可以未授权访问。

**投毒风险分析：**
虽然 PoC 代码片段主要用于环境搭建和调试，没有明显的恶意代码，但仍存在一定的投毒风险。原因如下：

*   **依赖第三方资源：** PoC 涉及下载 MySQL 驱动程序，如果驱动程序来源被篡改，可能包含恶意代码。
*   **配置更改：** PoC 建议修改 MySQL 配置文件，如果修改不当，可能导致数据库安全问题。
*   **环境搭建复杂：** 搭建漏洞环境本身比较复杂，如果攻击者提供修改后的环境镜像，可能包含预先植入的后门。

鉴于以上风险，认为此仓库中存在作者隐藏的投毒代码的可能性为10%。

**总结：**

CVE-2023-22518 是一个严重的安全漏洞，允许未经身份验证的攻击者完全控制 Confluence 实例。该漏洞利用相对简单，已经有公开的 PoC，并且已被用于 ransomware 攻击。虽然提供的 PoC 代码片段主要用于调试和环境搭建，没有明显的恶意代码，但仍需警惕潜在的投毒风险。

**项目地址:** [ductink98lhp/analyze-Exploit-CVE-2023-22518-Confluence](https://github.com/ductink98lhp/analyze-Exploit-CVE-2023-22518-Confluence)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)

---



---



---



---

