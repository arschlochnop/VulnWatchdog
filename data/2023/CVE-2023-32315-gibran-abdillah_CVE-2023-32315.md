# CVE-2023-32315

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-32315-5rGJ5aCh5oCq5YW9_CVE-2023-32315exp.md](../2023/CVE-2023-32315-5rGJ5aCh5oCq5YW9_CVE-2023-32315exp.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 身份认证绕过 / 路径遍历

**影响应用:** Openfire

**危害等级:** 高危，允许未经授权访问管理控制台，可能导致敏感信息泄露和控制服务器

**影响版本:** 3.10.0 <= Openfire < 4.6.8, 4.7.0 <= Openfire < 4.7.5

**利用条件:** 目标系统运行受影响版本的Openfire，并且攻击者可以访问Openfire的Web管理界面(通常是9090端口)。需要目标服务器未完成初始化配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315 是一个 Openfire 的身份验证绕过漏洞，利用了路径遍历。攻击者可以利用此漏洞绕过身份验证，访问 Openfire 的管理控制台。\n\n**漏洞利用方式：**\n\n1.  **路径遍历：** 漏洞的根本原因是由于 Openfire 的安装设置页面存在路径遍历漏洞。攻击者可以构造特殊的 URL，例如`/setup/setup-s/%u002e%u002e/%u002e%u002e/log.jsp`，绕过身份验证检查，访问受限资源。其中`%u002e%u002e` 是 `..` 的 URL 编码，用于进行目录跳转。通过访问`log.jsp` 页面可以判断漏洞是否存在。\n2.  **创建管理员用户：** 利用路径遍历访问`user-create.jsp`页面，并结合一个有效的csrf token, 可以在无需认证的情况下创建新的管理员用户。 通过创建的管理员用户可以完全控制Openfire服务器。\n\n**POC 代码分析：**\n\n提供的 POC 代码 (Python) 演示了如何利用此漏洞。其步骤如下：\n\n1.  **获取 csrf token:** 访问`login.jsp`页面，从cookie中获取csrf token。\n2.  **构造 EXP URL：**  构造包含路径遍历的 URL，指向 `user-create.jsp` 页面，并附带创建管理员用户的必要参数，包括用户名、密码等。 URL 形式如: `{url}/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp?csrf={csrf_cookie}&username=admin4&name=admin4&email=admin4%40123.com&password=1234567&passwordConfirm=1234567&isadmin=on&create=%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7`。\n3.  **发送请求：** 使用 `HackRequests` 库发送构造的 URL 请求，创建新的管理员用户。\n\n**投毒风险分析：**\n\n对提供的代码进行了分析，并未发现任何明显的投毒代码。POC 代码的功能是利用漏洞创建管理员用户，所有操作均是为了验证漏洞的存在和利用，不存在植入后门或者恶意代码的行为。但是，请务必在非生产环境中使用此 POC，避免对实际系统造成损害。如果利用成功，攻击者可以通过新创建的管理员帐户完全控制 Openfire 服务器。

**项目地址:** [5rGJ5aCh5oCq5YW9/CVE-2023-32315exp](https://github.com/5rGJ5aCh5oCq5YW9/CVE-2023-32315exp)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #2

**来源**: [CVE-2023-32315-K3ysTr0K3R_CVE-2023-32315-EXPLOIT.md](../2023/CVE-2023-32315-K3ysTr0K3R_CVE-2023-32315-EXPLOIT.md)

## CVE-2023-32315-Openfire身份验证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致的身份验证绕过

**影响应用:** Openfire

**危害等级:** 高危，未经身份验证的攻击者可以创建管理员账户。

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** 目标系统运行受影响版本的Openfire，并且攻击者能够通过网络访问Openfire的Web管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 管理控制台身份验证绕过漏洞。由于存在路径遍历漏洞，未经身份验证的攻击者可以利用 Openfire 安装环境访问受限页面，从而在已配置的 Openfire 环境中创建管理员用户。漏洞利用方式如下：

1.  **漏洞原理：** 该漏洞利用了Openfire安装设置过程中的路径遍历缺陷，允许攻击者绕过身份验证，访问通常需要管理员权限才能访问的页面。
2.  **POC 代码分析：** 提供的Python脚本首先尝试从`/login.jsp`获取CSRF token。然后，它构造一个包含路径遍历的URL (`/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`)，以及要创建的管理员用户的用户名和密码。脚本使用`requests`库发送包含精心构造的URL的GET请求，并使用CSRF token绕过身份验证，从而创建新的管理员用户。
3.  **利用方式：**
    *   攻击者首先访问Openfire服务器的Web管理界面。
    *   攻击者使用包含路径遍历的恶意URL，绕过身份验证。
    *   攻击者通过构造的URL，创建一个新的管理员用户，从而获得对Openfire服务器的完全控制权。
4.  **投毒风险分析：** 该脚本的功能相对直接，主要用于利用漏洞创建管理员帐户。 脚本中使用了 `subprocess.Popen` 执行 curl 命令，如果目标服务器上 curl 被恶意修改，可能存在安全风险。此外，`mass_exploit` 函数从文件中读取目标 URL，如果该文件被篡改，可能导致脚本尝试攻击非预期目标。总体而言，投毒风险较低，约为10%， 主要集中在对外部命令的依赖以及批量攻击的目标文件。

**项目地址:** [K3ysTr0K3R/CVE-2023-32315-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2023-32315-EXPLOIT)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #3

**来源**: [CVE-2023-32315-ThatNotEasy_CVE-2023-32315.md](../2023/CVE-2023-32315-ThatNotEasy_CVE-2023-32315.md)

## CVE-2023-32315-Openfire-身份验证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 身份验证绕过/路径遍历

**影响应用:** Openfire

**危害等级:** 高危，可能导致未经授权的访问和潜在的远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8, 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务运行，目标端口开放，且Openfire版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 中的路径遍历漏洞。未经身份验证的攻击者可以通过向 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp` 发送特制的 HTTP 请求来绕过身份验证，访问受限的管理控制台页面。

**漏洞利用方式：**
1.  攻击者发送包含路径遍历序列（`%u002e%u002e/%u002e%u002e`）的恶意请求到 Openfire 服务器的 `/setup/setup-s/` 路径。
2.  路径遍历序列使得攻击者能够访问 `/user-groups.jsp` 等原本需要身份验证才能访问的管理页面。
3.  POC 代码首先尝试访问目标URL，如果成功获取JSESSIONID和CSRF token，则表明漏洞存在。代码会继续尝试利用该漏洞创建一个新的管理员用户。

**投毒风险评估：**
该 POC 代码主要包含以下功能：

*   发送包含路径遍历的 HTTP 请求。
*   提取服务器返回的 JSESSIONID 和 CSRF token。
*   构造并发送创建管理员用户的请求。

在提供的代码片段中，`generate_rando` 函数未完整定义，可能存在漏洞作者未公开的恶意行为。代码尝试从cookie中获取`JSESSIONID`和`csrf`,如果获取失败就无法继续利用。此外，该脚本依赖于 `HackRequests` 库，攻击者可能会篡改此库来植入恶意代码。虽然代码的主要目的是利用漏洞，但仍然存在一定的投毒风险，例如：

*   **潜在的后门创建：** 除了创建用户之外，攻击者可能添加额外的请求来执行其他恶意操作，例如部署 webshell 或修改系统配置。
*   **恶意库依赖：** `HackRequests` 库可能被替换为包含恶意代码的版本。
*   **信息收集：** 代码可能包含额外的逻辑来收集目标服务器的信息并发送给攻击者。

考虑到上述因素，该 POC 代码的投毒风险评估为 10%。需要人工审计整个代码才能完全确定是否存在恶意行为。

**项目地址:** [ThatNotEasy/CVE-2023-32315](https://github.com/ThatNotEasy/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #4

**来源**: [CVE-2023-32315-asepsaepdin_CVE-2023-32315.md](../2023/CVE-2023-32315-asepsaepdin_CVE-2023-32315.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可能导致未授权访问和控制Openfire服务器

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** 目标服务器运行存在漏洞版本的Openfire，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315是一个Openfire管理控制台的认证绕过漏洞。攻击者可以通过路径遍历攻击，利用未认证的Openfire安装环境，访问Openfire管理控制台的受限页面，从而创建新的管理员用户。该漏洞影响Openfire 3.10.0到4.6.7和4.7.0到4.7.4版本。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，以及搜索结果，该漏洞利用代码是有效的。搜索结果中提到该漏洞已经被野外利用，并且存在公开的PoC。

**投毒风险：**

提供的Python脚本`CVE-2023-32315.py`主要功能是利用CVE-2023-32315漏洞，通过构造恶意URL来绕过身份验证，在Openfire服务器上创建一个新的管理员用户。代码逻辑相对清晰，主要包括以下几个步骤：

1.  **获取CSRF Token:** 尝试从`/login.jsp`页面获取CSRF token，虽然这个token本身不是直接用于绕过认证，但是利用脚本在构造请求时会用到它。
2.  **构造恶意URL:** 使用路径遍历漏洞`setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`，直接访问用户创建页面，并设置用户名、密码以及管理员权限。
3.  **发送请求并验证结果:** 使用`requests`库发送GET请求，然后检查响应状态码，判断是否成功创建用户。

检查代码，没有发现明显的恶意行为，例如删除文件、传播恶意软件、或者进行其他未经授权的系统修改等。代码中使用的用户名和密码（hugme/HugmeNOW）也只是为了验证漏洞，并非后门。

代码中存在`subprocess.Popen`，理论上存在被注入命令的风险，但是代码中直接将构造好的命令赋值给`add_credentials_cmd`，其中`target_url`、`vuln_path`、`csrf_token` 等变量都经过了明确的赋值，没有用户可控的输入，因此被注入恶意命令的风险较低。

总体来说，该脚本本身被投毒的风险较低，大概为10%。风险主要来自于运行该脚本的环境是否安全，以及目标Openfire服务器的配置是否允许通过这种方式创建用户。

**利用方式：**

1.  **确定目标Openfire版本：** 确认目标Openfire服务器的版本在受影响的范围内（3.10.0 <= version < 4.6.8 或 4.7.0 <= version < 4.7.5）。
2.  **运行漏洞利用代码：** 运行提供的Python脚本，指定目标Openfire服务器的URL。
3.  **代码自动利用:**  脚本会自动尝试获取CSRF token，构造包含路径遍历的恶意URL，并发送请求创建新的管理员用户。
4.  **登录管理控制台：** 使用脚本中指定的用户名和密码（默认为hugme/HugmeNOW）登录Openfire的管理控制台。
5.  **控制服务器：** 成功登录后，攻击者可以执行任意管理操作，例如修改配置、安装插件、甚至执行系统命令。

**项目地址:** [asepsaepdin/CVE-2023-32315](https://github.com/asepsaepdin/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #5

**来源**: [CVE-2023-32315-gibran-abdillah_CVE-2023-32315.md](../2023/CVE-2023-32315-gibran-abdillah_CVE-2023-32315.md)

# CVE-2023-32315

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-32315-5rGJ5aCh5oCq5YW9_CVE-2023-32315exp.md](../2023/CVE-2023-32315-5rGJ5aCh5oCq5YW9_CVE-2023-32315exp.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 身份认证绕过 / 路径遍历

**影响应用:** Openfire

**危害等级:** 高危，允许未经授权访问管理控制台，可能导致敏感信息泄露和控制服务器

**影响版本:** 3.10.0 <= Openfire < 4.6.8, 4.7.0 <= Openfire < 4.7.5

**利用条件:** 目标系统运行受影响版本的Openfire，并且攻击者可以访问Openfire的Web管理界面(通常是9090端口)。需要目标服务器未完成初始化配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315 是一个 Openfire 的身份验证绕过漏洞，利用了路径遍历。攻击者可以利用此漏洞绕过身份验证，访问 Openfire 的管理控制台。\n\n**漏洞利用方式：**\n\n1.  **路径遍历：** 漏洞的根本原因是由于 Openfire 的安装设置页面存在路径遍历漏洞。攻击者可以构造特殊的 URL，例如`/setup/setup-s/%u002e%u002e/%u002e%u002e/log.jsp`，绕过身份验证检查，访问受限资源。其中`%u002e%u002e` 是 `..` 的 URL 编码，用于进行目录跳转。通过访问`log.jsp` 页面可以判断漏洞是否存在。\n2.  **创建管理员用户：** 利用路径遍历访问`user-create.jsp`页面，并结合一个有效的csrf token, 可以在无需认证的情况下创建新的管理员用户。 通过创建的管理员用户可以完全控制Openfire服务器。\n\n**POC 代码分析：**\n\n提供的 POC 代码 (Python) 演示了如何利用此漏洞。其步骤如下：\n\n1.  **获取 csrf token:** 访问`login.jsp`页面，从cookie中获取csrf token。\n2.  **构造 EXP URL：**  构造包含路径遍历的 URL，指向 `user-create.jsp` 页面，并附带创建管理员用户的必要参数，包括用户名、密码等。 URL 形式如: `{url}/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp?csrf={csrf_cookie}&username=admin4&name=admin4&email=admin4%40123.com&password=1234567&passwordConfirm=1234567&isadmin=on&create=%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7`。\n3.  **发送请求：** 使用 `HackRequests` 库发送构造的 URL 请求，创建新的管理员用户。\n\n**投毒风险分析：**\n\n对提供的代码进行了分析，并未发现任何明显的投毒代码。POC 代码的功能是利用漏洞创建管理员用户，所有操作均是为了验证漏洞的存在和利用，不存在植入后门或者恶意代码的行为。但是，请务必在非生产环境中使用此 POC，避免对实际系统造成损害。如果利用成功，攻击者可以通过新创建的管理员帐户完全控制 Openfire 服务器。

**项目地址:** [5rGJ5aCh5oCq5YW9/CVE-2023-32315exp](https://github.com/5rGJ5aCh5oCq5YW9/CVE-2023-32315exp)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #2

**来源**: [CVE-2023-32315-K3ysTr0K3R_CVE-2023-32315-EXPLOIT.md](../2023/CVE-2023-32315-K3ysTr0K3R_CVE-2023-32315-EXPLOIT.md)

## CVE-2023-32315-Openfire身份验证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致的身份验证绕过

**影响应用:** Openfire

**危害等级:** 高危，未经身份验证的攻击者可以创建管理员账户。

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** 目标系统运行受影响版本的Openfire，并且攻击者能够通过网络访问Openfire的Web管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 管理控制台身份验证绕过漏洞。由于存在路径遍历漏洞，未经身份验证的攻击者可以利用 Openfire 安装环境访问受限页面，从而在已配置的 Openfire 环境中创建管理员用户。漏洞利用方式如下：

1.  **漏洞原理：** 该漏洞利用了Openfire安装设置过程中的路径遍历缺陷，允许攻击者绕过身份验证，访问通常需要管理员权限才能访问的页面。
2.  **POC 代码分析：** 提供的Python脚本首先尝试从`/login.jsp`获取CSRF token。然后，它构造一个包含路径遍历的URL (`/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`)，以及要创建的管理员用户的用户名和密码。脚本使用`requests`库发送包含精心构造的URL的GET请求，并使用CSRF token绕过身份验证，从而创建新的管理员用户。
3.  **利用方式：**
    *   攻击者首先访问Openfire服务器的Web管理界面。
    *   攻击者使用包含路径遍历的恶意URL，绕过身份验证。
    *   攻击者通过构造的URL，创建一个新的管理员用户，从而获得对Openfire服务器的完全控制权。
4.  **投毒风险分析：** 该脚本的功能相对直接，主要用于利用漏洞创建管理员帐户。 脚本中使用了 `subprocess.Popen` 执行 curl 命令，如果目标服务器上 curl 被恶意修改，可能存在安全风险。此外，`mass_exploit` 函数从文件中读取目标 URL，如果该文件被篡改，可能导致脚本尝试攻击非预期目标。总体而言，投毒风险较低，约为10%， 主要集中在对外部命令的依赖以及批量攻击的目标文件。

**项目地址:** [K3ysTr0K3R/CVE-2023-32315-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2023-32315-EXPLOIT)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #3

**来源**: [CVE-2023-32315-ThatNotEasy_CVE-2023-32315.md](../2023/CVE-2023-32315-ThatNotEasy_CVE-2023-32315.md)

## CVE-2023-32315-Openfire-身份验证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 身份验证绕过/路径遍历

**影响应用:** Openfire

**危害等级:** 高危，可能导致未经授权的访问和潜在的远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8, 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务运行，目标端口开放，且Openfire版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 中的路径遍历漏洞。未经身份验证的攻击者可以通过向 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp` 发送特制的 HTTP 请求来绕过身份验证，访问受限的管理控制台页面。

**漏洞利用方式：**
1.  攻击者发送包含路径遍历序列（`%u002e%u002e/%u002e%u002e`）的恶意请求到 Openfire 服务器的 `/setup/setup-s/` 路径。
2.  路径遍历序列使得攻击者能够访问 `/user-groups.jsp` 等原本需要身份验证才能访问的管理页面。
3.  POC 代码首先尝试访问目标URL，如果成功获取JSESSIONID和CSRF token，则表明漏洞存在。代码会继续尝试利用该漏洞创建一个新的管理员用户。

**投毒风险评估：**
该 POC 代码主要包含以下功能：

*   发送包含路径遍历的 HTTP 请求。
*   提取服务器返回的 JSESSIONID 和 CSRF token。
*   构造并发送创建管理员用户的请求。

在提供的代码片段中，`generate_rando` 函数未完整定义，可能存在漏洞作者未公开的恶意行为。代码尝试从cookie中获取`JSESSIONID`和`csrf`,如果获取失败就无法继续利用。此外，该脚本依赖于 `HackRequests` 库，攻击者可能会篡改此库来植入恶意代码。虽然代码的主要目的是利用漏洞，但仍然存在一定的投毒风险，例如：

*   **潜在的后门创建：** 除了创建用户之外，攻击者可能添加额外的请求来执行其他恶意操作，例如部署 webshell 或修改系统配置。
*   **恶意库依赖：** `HackRequests` 库可能被替换为包含恶意代码的版本。
*   **信息收集：** 代码可能包含额外的逻辑来收集目标服务器的信息并发送给攻击者。

考虑到上述因素，该 POC 代码的投毒风险评估为 10%。需要人工审计整个代码才能完全确定是否存在恶意行为。

**项目地址:** [ThatNotEasy/CVE-2023-32315](https://github.com/ThatNotEasy/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #4

**来源**: [CVE-2023-32315-asepsaepdin_CVE-2023-32315.md](../2023/CVE-2023-32315-asepsaepdin_CVE-2023-32315.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可能导致未授权访问和控制Openfire服务器

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** 目标服务器运行存在漏洞版本的Openfire，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315是一个Openfire管理控制台的认证绕过漏洞。攻击者可以通过路径遍历攻击，利用未认证的Openfire安装环境，访问Openfire管理控制台的受限页面，从而创建新的管理员用户。该漏洞影响Openfire 3.10.0到4.6.7和4.7.0到4.7.4版本。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，以及搜索结果，该漏洞利用代码是有效的。搜索结果中提到该漏洞已经被野外利用，并且存在公开的PoC。

**投毒风险：**

提供的Python脚本`CVE-2023-32315.py`主要功能是利用CVE-2023-32315漏洞，通过构造恶意URL来绕过身份验证，在Openfire服务器上创建一个新的管理员用户。代码逻辑相对清晰，主要包括以下几个步骤：

1.  **获取CSRF Token:** 尝试从`/login.jsp`页面获取CSRF token，虽然这个token本身不是直接用于绕过认证，但是利用脚本在构造请求时会用到它。
2.  **构造恶意URL:** 使用路径遍历漏洞`setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`，直接访问用户创建页面，并设置用户名、密码以及管理员权限。
3.  **发送请求并验证结果:** 使用`requests`库发送GET请求，然后检查响应状态码，判断是否成功创建用户。

检查代码，没有发现明显的恶意行为，例如删除文件、传播恶意软件、或者进行其他未经授权的系统修改等。代码中使用的用户名和密码（hugme/HugmeNOW）也只是为了验证漏洞，并非后门。

代码中存在`subprocess.Popen`，理论上存在被注入命令的风险，但是代码中直接将构造好的命令赋值给`add_credentials_cmd`，其中`target_url`、`vuln_path`、`csrf_token` 等变量都经过了明确的赋值，没有用户可控的输入，因此被注入恶意命令的风险较低。

总体来说，该脚本本身被投毒的风险较低，大概为10%。风险主要来自于运行该脚本的环境是否安全，以及目标Openfire服务器的配置是否允许通过这种方式创建用户。

**利用方式：**

1.  **确定目标Openfire版本：** 确认目标Openfire服务器的版本在受影响的范围内（3.10.0 <= version < 4.6.8 或 4.7.0 <= version < 4.7.5）。
2.  **运行漏洞利用代码：** 运行提供的Python脚本，指定目标Openfire服务器的URL。
3.  **代码自动利用:**  脚本会自动尝试获取CSRF token，构造包含路径遍历的恶意URL，并发送请求创建新的管理员用户。
4.  **登录管理控制台：** 使用脚本中指定的用户名和密码（默认为hugme/HugmeNOW）登录Openfire的管理控制台。
5.  **控制服务器：** 成功登录后，攻击者可以执行任意管理操作，例如修改配置、安装插件、甚至执行系统命令。

**项目地址:** [asepsaepdin/CVE-2023-32315](https://github.com/asepsaepdin/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #5

**来源**: [CVE-2023-32315-gibran-abdillah_CVE-2023-32315.md](../2023/CVE-2023-32315-gibran-abdillah_CVE-2023-32315.md)

# CVE-2023-32315

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-32315-5rGJ5aCh5oCq5YW9_CVE-2023-32315exp.md](../2023/CVE-2023-32315-5rGJ5aCh5oCq5YW9_CVE-2023-32315exp.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 身份认证绕过 / 路径遍历

**影响应用:** Openfire

**危害等级:** 高危，允许未经授权访问管理控制台，可能导致敏感信息泄露和控制服务器

**影响版本:** 3.10.0 <= Openfire < 4.6.8, 4.7.0 <= Openfire < 4.7.5

**利用条件:** 目标系统运行受影响版本的Openfire，并且攻击者可以访问Openfire的Web管理界面(通常是9090端口)。需要目标服务器未完成初始化配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315 是一个 Openfire 的身份验证绕过漏洞，利用了路径遍历。攻击者可以利用此漏洞绕过身份验证，访问 Openfire 的管理控制台。\n\n**漏洞利用方式：**\n\n1.  **路径遍历：** 漏洞的根本原因是由于 Openfire 的安装设置页面存在路径遍历漏洞。攻击者可以构造特殊的 URL，例如`/setup/setup-s/%u002e%u002e/%u002e%u002e/log.jsp`，绕过身份验证检查，访问受限资源。其中`%u002e%u002e` 是 `..` 的 URL 编码，用于进行目录跳转。通过访问`log.jsp` 页面可以判断漏洞是否存在。\n2.  **创建管理员用户：** 利用路径遍历访问`user-create.jsp`页面，并结合一个有效的csrf token, 可以在无需认证的情况下创建新的管理员用户。 通过创建的管理员用户可以完全控制Openfire服务器。\n\n**POC 代码分析：**\n\n提供的 POC 代码 (Python) 演示了如何利用此漏洞。其步骤如下：\n\n1.  **获取 csrf token:** 访问`login.jsp`页面，从cookie中获取csrf token。\n2.  **构造 EXP URL：**  构造包含路径遍历的 URL，指向 `user-create.jsp` 页面，并附带创建管理员用户的必要参数，包括用户名、密码等。 URL 形式如: `{url}/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp?csrf={csrf_cookie}&username=admin4&name=admin4&email=admin4%40123.com&password=1234567&passwordConfirm=1234567&isadmin=on&create=%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7`。\n3.  **发送请求：** 使用 `HackRequests` 库发送构造的 URL 请求，创建新的管理员用户。\n\n**投毒风险分析：**\n\n对提供的代码进行了分析，并未发现任何明显的投毒代码。POC 代码的功能是利用漏洞创建管理员用户，所有操作均是为了验证漏洞的存在和利用，不存在植入后门或者恶意代码的行为。但是，请务必在非生产环境中使用此 POC，避免对实际系统造成损害。如果利用成功，攻击者可以通过新创建的管理员帐户完全控制 Openfire 服务器。

**项目地址:** [5rGJ5aCh5oCq5YW9/CVE-2023-32315exp](https://github.com/5rGJ5aCh5oCq5YW9/CVE-2023-32315exp)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #2

**来源**: [CVE-2023-32315-K3ysTr0K3R_CVE-2023-32315-EXPLOIT.md](../2023/CVE-2023-32315-K3ysTr0K3R_CVE-2023-32315-EXPLOIT.md)

## CVE-2023-32315-Openfire身份验证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致的身份验证绕过

**影响应用:** Openfire

**危害等级:** 高危，未经身份验证的攻击者可以创建管理员账户。

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** 目标系统运行受影响版本的Openfire，并且攻击者能够通过网络访问Openfire的Web管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 管理控制台身份验证绕过漏洞。由于存在路径遍历漏洞，未经身份验证的攻击者可以利用 Openfire 安装环境访问受限页面，从而在已配置的 Openfire 环境中创建管理员用户。漏洞利用方式如下：

1.  **漏洞原理：** 该漏洞利用了Openfire安装设置过程中的路径遍历缺陷，允许攻击者绕过身份验证，访问通常需要管理员权限才能访问的页面。
2.  **POC 代码分析：** 提供的Python脚本首先尝试从`/login.jsp`获取CSRF token。然后，它构造一个包含路径遍历的URL (`/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`)，以及要创建的管理员用户的用户名和密码。脚本使用`requests`库发送包含精心构造的URL的GET请求，并使用CSRF token绕过身份验证，从而创建新的管理员用户。
3.  **利用方式：**
    *   攻击者首先访问Openfire服务器的Web管理界面。
    *   攻击者使用包含路径遍历的恶意URL，绕过身份验证。
    *   攻击者通过构造的URL，创建一个新的管理员用户，从而获得对Openfire服务器的完全控制权。
4.  **投毒风险分析：** 该脚本的功能相对直接，主要用于利用漏洞创建管理员帐户。 脚本中使用了 `subprocess.Popen` 执行 curl 命令，如果目标服务器上 curl 被恶意修改，可能存在安全风险。此外，`mass_exploit` 函数从文件中读取目标 URL，如果该文件被篡改，可能导致脚本尝试攻击非预期目标。总体而言，投毒风险较低，约为10%， 主要集中在对外部命令的依赖以及批量攻击的目标文件。

**项目地址:** [K3ysTr0K3R/CVE-2023-32315-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2023-32315-EXPLOIT)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #3

**来源**: [CVE-2023-32315-ThatNotEasy_CVE-2023-32315.md](../2023/CVE-2023-32315-ThatNotEasy_CVE-2023-32315.md)

## CVE-2023-32315-Openfire-身份验证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 身份验证绕过/路径遍历

**影响应用:** Openfire

**危害等级:** 高危，可能导致未经授权的访问和潜在的远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8, 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务运行，目标端口开放，且Openfire版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 中的路径遍历漏洞。未经身份验证的攻击者可以通过向 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp` 发送特制的 HTTP 请求来绕过身份验证，访问受限的管理控制台页面。

**漏洞利用方式：**
1.  攻击者发送包含路径遍历序列（`%u002e%u002e/%u002e%u002e`）的恶意请求到 Openfire 服务器的 `/setup/setup-s/` 路径。
2.  路径遍历序列使得攻击者能够访问 `/user-groups.jsp` 等原本需要身份验证才能访问的管理页面。
3.  POC 代码首先尝试访问目标URL，如果成功获取JSESSIONID和CSRF token，则表明漏洞存在。代码会继续尝试利用该漏洞创建一个新的管理员用户。

**投毒风险评估：**
该 POC 代码主要包含以下功能：

*   发送包含路径遍历的 HTTP 请求。
*   提取服务器返回的 JSESSIONID 和 CSRF token。
*   构造并发送创建管理员用户的请求。

在提供的代码片段中，`generate_rando` 函数未完整定义，可能存在漏洞作者未公开的恶意行为。代码尝试从cookie中获取`JSESSIONID`和`csrf`,如果获取失败就无法继续利用。此外，该脚本依赖于 `HackRequests` 库，攻击者可能会篡改此库来植入恶意代码。虽然代码的主要目的是利用漏洞，但仍然存在一定的投毒风险，例如：

*   **潜在的后门创建：** 除了创建用户之外，攻击者可能添加额外的请求来执行其他恶意操作，例如部署 webshell 或修改系统配置。
*   **恶意库依赖：** `HackRequests` 库可能被替换为包含恶意代码的版本。
*   **信息收集：** 代码可能包含额外的逻辑来收集目标服务器的信息并发送给攻击者。

考虑到上述因素，该 POC 代码的投毒风险评估为 10%。需要人工审计整个代码才能完全确定是否存在恶意行为。

**项目地址:** [ThatNotEasy/CVE-2023-32315](https://github.com/ThatNotEasy/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #4

**来源**: [CVE-2023-32315-asepsaepdin_CVE-2023-32315.md](../2023/CVE-2023-32315-asepsaepdin_CVE-2023-32315.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可能导致未授权访问和控制Openfire服务器

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** 目标服务器运行存在漏洞版本的Openfire，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315是一个Openfire管理控制台的认证绕过漏洞。攻击者可以通过路径遍历攻击，利用未认证的Openfire安装环境，访问Openfire管理控制台的受限页面，从而创建新的管理员用户。该漏洞影响Openfire 3.10.0到4.6.7和4.7.0到4.7.4版本。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，以及搜索结果，该漏洞利用代码是有效的。搜索结果中提到该漏洞已经被野外利用，并且存在公开的PoC。

**投毒风险：**

提供的Python脚本`CVE-2023-32315.py`主要功能是利用CVE-2023-32315漏洞，通过构造恶意URL来绕过身份验证，在Openfire服务器上创建一个新的管理员用户。代码逻辑相对清晰，主要包括以下几个步骤：

1.  **获取CSRF Token:** 尝试从`/login.jsp`页面获取CSRF token，虽然这个token本身不是直接用于绕过认证，但是利用脚本在构造请求时会用到它。
2.  **构造恶意URL:** 使用路径遍历漏洞`setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`，直接访问用户创建页面，并设置用户名、密码以及管理员权限。
3.  **发送请求并验证结果:** 使用`requests`库发送GET请求，然后检查响应状态码，判断是否成功创建用户。

检查代码，没有发现明显的恶意行为，例如删除文件、传播恶意软件、或者进行其他未经授权的系统修改等。代码中使用的用户名和密码（hugme/HugmeNOW）也只是为了验证漏洞，并非后门。

代码中存在`subprocess.Popen`，理论上存在被注入命令的风险，但是代码中直接将构造好的命令赋值给`add_credentials_cmd`，其中`target_url`、`vuln_path`、`csrf_token` 等变量都经过了明确的赋值，没有用户可控的输入，因此被注入恶意命令的风险较低。

总体来说，该脚本本身被投毒的风险较低，大概为10%。风险主要来自于运行该脚本的环境是否安全，以及目标Openfire服务器的配置是否允许通过这种方式创建用户。

**利用方式：**

1.  **确定目标Openfire版本：** 确认目标Openfire服务器的版本在受影响的范围内（3.10.0 <= version < 4.6.8 或 4.7.0 <= version < 4.7.5）。
2.  **运行漏洞利用代码：** 运行提供的Python脚本，指定目标Openfire服务器的URL。
3.  **代码自动利用:**  脚本会自动尝试获取CSRF token，构造包含路径遍历的恶意URL，并发送请求创建新的管理员用户。
4.  **登录管理控制台：** 使用脚本中指定的用户名和密码（默认为hugme/HugmeNOW）登录Openfire的管理控制台。
5.  **控制服务器：** 成功登录后，攻击者可以执行任意管理操作，例如修改配置、安装插件、甚至执行系统命令。

**项目地址:** [asepsaepdin/CVE-2023-32315](https://github.com/asepsaepdin/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #5

**来源**: [CVE-2023-32315-gibran-abdillah_CVE-2023-32315.md](../2023/CVE-2023-32315-gibran-abdillah_CVE-2023-32315.md)

# CVE-2023-32315

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-32315-5rGJ5aCh5oCq5YW9_CVE-2023-32315exp.md](../2023/CVE-2023-32315-5rGJ5aCh5oCq5YW9_CVE-2023-32315exp.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 身份认证绕过 / 路径遍历

**影响应用:** Openfire

**危害等级:** 高危，允许未经授权访问管理控制台，可能导致敏感信息泄露和控制服务器

**影响版本:** 3.10.0 <= Openfire < 4.6.8, 4.7.0 <= Openfire < 4.7.5

**利用条件:** 目标系统运行受影响版本的Openfire，并且攻击者可以访问Openfire的Web管理界面(通常是9090端口)。需要目标服务器未完成初始化配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315 是一个 Openfire 的身份验证绕过漏洞，利用了路径遍历。攻击者可以利用此漏洞绕过身份验证，访问 Openfire 的管理控制台。\n\n**漏洞利用方式：**\n\n1.  **路径遍历：** 漏洞的根本原因是由于 Openfire 的安装设置页面存在路径遍历漏洞。攻击者可以构造特殊的 URL，例如`/setup/setup-s/%u002e%u002e/%u002e%u002e/log.jsp`，绕过身份验证检查，访问受限资源。其中`%u002e%u002e` 是 `..` 的 URL 编码，用于进行目录跳转。通过访问`log.jsp` 页面可以判断漏洞是否存在。\n2.  **创建管理员用户：** 利用路径遍历访问`user-create.jsp`页面，并结合一个有效的csrf token, 可以在无需认证的情况下创建新的管理员用户。 通过创建的管理员用户可以完全控制Openfire服务器。\n\n**POC 代码分析：**\n\n提供的 POC 代码 (Python) 演示了如何利用此漏洞。其步骤如下：\n\n1.  **获取 csrf token:** 访问`login.jsp`页面，从cookie中获取csrf token。\n2.  **构造 EXP URL：**  构造包含路径遍历的 URL，指向 `user-create.jsp` 页面，并附带创建管理员用户的必要参数，包括用户名、密码等。 URL 形式如: `{url}/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp?csrf={csrf_cookie}&username=admin4&name=admin4&email=admin4%40123.com&password=1234567&passwordConfirm=1234567&isadmin=on&create=%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7`。\n3.  **发送请求：** 使用 `HackRequests` 库发送构造的 URL 请求，创建新的管理员用户。\n\n**投毒风险分析：**\n\n对提供的代码进行了分析，并未发现任何明显的投毒代码。POC 代码的功能是利用漏洞创建管理员用户，所有操作均是为了验证漏洞的存在和利用，不存在植入后门或者恶意代码的行为。但是，请务必在非生产环境中使用此 POC，避免对实际系统造成损害。如果利用成功，攻击者可以通过新创建的管理员帐户完全控制 Openfire 服务器。

**项目地址:** [5rGJ5aCh5oCq5YW9/CVE-2023-32315exp](https://github.com/5rGJ5aCh5oCq5YW9/CVE-2023-32315exp)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #2

**来源**: [CVE-2023-32315-K3ysTr0K3R_CVE-2023-32315-EXPLOIT.md](../2023/CVE-2023-32315-K3ysTr0K3R_CVE-2023-32315-EXPLOIT.md)

## CVE-2023-32315-Openfire身份验证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致的身份验证绕过

**影响应用:** Openfire

**危害等级:** 高危，未经身份验证的攻击者可以创建管理员账户。

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** 目标系统运行受影响版本的Openfire，并且攻击者能够通过网络访问Openfire的Web管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 管理控制台身份验证绕过漏洞。由于存在路径遍历漏洞，未经身份验证的攻击者可以利用 Openfire 安装环境访问受限页面，从而在已配置的 Openfire 环境中创建管理员用户。漏洞利用方式如下：

1.  **漏洞原理：** 该漏洞利用了Openfire安装设置过程中的路径遍历缺陷，允许攻击者绕过身份验证，访问通常需要管理员权限才能访问的页面。
2.  **POC 代码分析：** 提供的Python脚本首先尝试从`/login.jsp`获取CSRF token。然后，它构造一个包含路径遍历的URL (`/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`)，以及要创建的管理员用户的用户名和密码。脚本使用`requests`库发送包含精心构造的URL的GET请求，并使用CSRF token绕过身份验证，从而创建新的管理员用户。
3.  **利用方式：**
    *   攻击者首先访问Openfire服务器的Web管理界面。
    *   攻击者使用包含路径遍历的恶意URL，绕过身份验证。
    *   攻击者通过构造的URL，创建一个新的管理员用户，从而获得对Openfire服务器的完全控制权。
4.  **投毒风险分析：** 该脚本的功能相对直接，主要用于利用漏洞创建管理员帐户。 脚本中使用了 `subprocess.Popen` 执行 curl 命令，如果目标服务器上 curl 被恶意修改，可能存在安全风险。此外，`mass_exploit` 函数从文件中读取目标 URL，如果该文件被篡改，可能导致脚本尝试攻击非预期目标。总体而言，投毒风险较低，约为10%， 主要集中在对外部命令的依赖以及批量攻击的目标文件。

**项目地址:** [K3ysTr0K3R/CVE-2023-32315-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2023-32315-EXPLOIT)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #3

**来源**: [CVE-2023-32315-ThatNotEasy_CVE-2023-32315.md](../2023/CVE-2023-32315-ThatNotEasy_CVE-2023-32315.md)

## CVE-2023-32315-Openfire-身份验证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 身份验证绕过/路径遍历

**影响应用:** Openfire

**危害等级:** 高危，可能导致未经授权的访问和潜在的远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8, 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务运行，目标端口开放，且Openfire版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 中的路径遍历漏洞。未经身份验证的攻击者可以通过向 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp` 发送特制的 HTTP 请求来绕过身份验证，访问受限的管理控制台页面。

**漏洞利用方式：**
1.  攻击者发送包含路径遍历序列（`%u002e%u002e/%u002e%u002e`）的恶意请求到 Openfire 服务器的 `/setup/setup-s/` 路径。
2.  路径遍历序列使得攻击者能够访问 `/user-groups.jsp` 等原本需要身份验证才能访问的管理页面。
3.  POC 代码首先尝试访问目标URL，如果成功获取JSESSIONID和CSRF token，则表明漏洞存在。代码会继续尝试利用该漏洞创建一个新的管理员用户。

**投毒风险评估：**
该 POC 代码主要包含以下功能：

*   发送包含路径遍历的 HTTP 请求。
*   提取服务器返回的 JSESSIONID 和 CSRF token。
*   构造并发送创建管理员用户的请求。

在提供的代码片段中，`generate_rando` 函数未完整定义，可能存在漏洞作者未公开的恶意行为。代码尝试从cookie中获取`JSESSIONID`和`csrf`,如果获取失败就无法继续利用。此外，该脚本依赖于 `HackRequests` 库，攻击者可能会篡改此库来植入恶意代码。虽然代码的主要目的是利用漏洞，但仍然存在一定的投毒风险，例如：

*   **潜在的后门创建：** 除了创建用户之外，攻击者可能添加额外的请求来执行其他恶意操作，例如部署 webshell 或修改系统配置。
*   **恶意库依赖：** `HackRequests` 库可能被替换为包含恶意代码的版本。
*   **信息收集：** 代码可能包含额外的逻辑来收集目标服务器的信息并发送给攻击者。

考虑到上述因素，该 POC 代码的投毒风险评估为 10%。需要人工审计整个代码才能完全确定是否存在恶意行为。

**项目地址:** [ThatNotEasy/CVE-2023-32315](https://github.com/ThatNotEasy/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #4

**来源**: [CVE-2023-32315-asepsaepdin_CVE-2023-32315.md](../2023/CVE-2023-32315-asepsaepdin_CVE-2023-32315.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可能导致未授权访问和控制Openfire服务器

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** 目标服务器运行存在漏洞版本的Openfire，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315是一个Openfire管理控制台的认证绕过漏洞。攻击者可以通过路径遍历攻击，利用未认证的Openfire安装环境，访问Openfire管理控制台的受限页面，从而创建新的管理员用户。该漏洞影响Openfire 3.10.0到4.6.7和4.7.0到4.7.4版本。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，以及搜索结果，该漏洞利用代码是有效的。搜索结果中提到该漏洞已经被野外利用，并且存在公开的PoC。

**投毒风险：**

提供的Python脚本`CVE-2023-32315.py`主要功能是利用CVE-2023-32315漏洞，通过构造恶意URL来绕过身份验证，在Openfire服务器上创建一个新的管理员用户。代码逻辑相对清晰，主要包括以下几个步骤：

1.  **获取CSRF Token:** 尝试从`/login.jsp`页面获取CSRF token，虽然这个token本身不是直接用于绕过认证，但是利用脚本在构造请求时会用到它。
2.  **构造恶意URL:** 使用路径遍历漏洞`setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`，直接访问用户创建页面，并设置用户名、密码以及管理员权限。
3.  **发送请求并验证结果:** 使用`requests`库发送GET请求，然后检查响应状态码，判断是否成功创建用户。

检查代码，没有发现明显的恶意行为，例如删除文件、传播恶意软件、或者进行其他未经授权的系统修改等。代码中使用的用户名和密码（hugme/HugmeNOW）也只是为了验证漏洞，并非后门。

代码中存在`subprocess.Popen`，理论上存在被注入命令的风险，但是代码中直接将构造好的命令赋值给`add_credentials_cmd`，其中`target_url`、`vuln_path`、`csrf_token` 等变量都经过了明确的赋值，没有用户可控的输入，因此被注入恶意命令的风险较低。

总体来说，该脚本本身被投毒的风险较低，大概为10%。风险主要来自于运行该脚本的环境是否安全，以及目标Openfire服务器的配置是否允许通过这种方式创建用户。

**利用方式：**

1.  **确定目标Openfire版本：** 确认目标Openfire服务器的版本在受影响的范围内（3.10.0 <= version < 4.6.8 或 4.7.0 <= version < 4.7.5）。
2.  **运行漏洞利用代码：** 运行提供的Python脚本，指定目标Openfire服务器的URL。
3.  **代码自动利用:**  脚本会自动尝试获取CSRF token，构造包含路径遍历的恶意URL，并发送请求创建新的管理员用户。
4.  **登录管理控制台：** 使用脚本中指定的用户名和密码（默认为hugme/HugmeNOW）登录Openfire的管理控制台。
5.  **控制服务器：** 成功登录后，攻击者可以执行任意管理操作，例如修改配置、安装插件、甚至执行系统命令。

**项目地址:** [asepsaepdin/CVE-2023-32315](https://github.com/asepsaepdin/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #5

**来源**: [CVE-2023-32315-gibran-abdillah_CVE-2023-32315.md](../2023/CVE-2023-32315-gibran-abdillah_CVE-2023-32315.md)

# CVE-2023-32315

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-32315-5rGJ5aCh5oCq5YW9_CVE-2023-32315exp.md](../2023/CVE-2023-32315-5rGJ5aCh5oCq5YW9_CVE-2023-32315exp.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 身份认证绕过 / 路径遍历

**影响应用:** Openfire

**危害等级:** 高危，允许未经授权访问管理控制台，可能导致敏感信息泄露和控制服务器

**影响版本:** 3.10.0 <= Openfire < 4.6.8, 4.7.0 <= Openfire < 4.7.5

**利用条件:** 目标系统运行受影响版本的Openfire，并且攻击者可以访问Openfire的Web管理界面(通常是9090端口)。需要目标服务器未完成初始化配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315 是一个 Openfire 的身份验证绕过漏洞，利用了路径遍历。攻击者可以利用此漏洞绕过身份验证，访问 Openfire 的管理控制台。\n\n**漏洞利用方式：**\n\n1.  **路径遍历：** 漏洞的根本原因是由于 Openfire 的安装设置页面存在路径遍历漏洞。攻击者可以构造特殊的 URL，例如`/setup/setup-s/%u002e%u002e/%u002e%u002e/log.jsp`，绕过身份验证检查，访问受限资源。其中`%u002e%u002e` 是 `..` 的 URL 编码，用于进行目录跳转。通过访问`log.jsp` 页面可以判断漏洞是否存在。\n2.  **创建管理员用户：** 利用路径遍历访问`user-create.jsp`页面，并结合一个有效的csrf token, 可以在无需认证的情况下创建新的管理员用户。 通过创建的管理员用户可以完全控制Openfire服务器。\n\n**POC 代码分析：**\n\n提供的 POC 代码 (Python) 演示了如何利用此漏洞。其步骤如下：\n\n1.  **获取 csrf token:** 访问`login.jsp`页面，从cookie中获取csrf token。\n2.  **构造 EXP URL：**  构造包含路径遍历的 URL，指向 `user-create.jsp` 页面，并附带创建管理员用户的必要参数，包括用户名、密码等。 URL 形式如: `{url}/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp?csrf={csrf_cookie}&username=admin4&name=admin4&email=admin4%40123.com&password=1234567&passwordConfirm=1234567&isadmin=on&create=%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7`。\n3.  **发送请求：** 使用 `HackRequests` 库发送构造的 URL 请求，创建新的管理员用户。\n\n**投毒风险分析：**\n\n对提供的代码进行了分析，并未发现任何明显的投毒代码。POC 代码的功能是利用漏洞创建管理员用户，所有操作均是为了验证漏洞的存在和利用，不存在植入后门或者恶意代码的行为。但是，请务必在非生产环境中使用此 POC，避免对实际系统造成损害。如果利用成功，攻击者可以通过新创建的管理员帐户完全控制 Openfire 服务器。

**项目地址:** [5rGJ5aCh5oCq5YW9/CVE-2023-32315exp](https://github.com/5rGJ5aCh5oCq5YW9/CVE-2023-32315exp)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #2

**来源**: [CVE-2023-32315-K3ysTr0K3R_CVE-2023-32315-EXPLOIT.md](../2023/CVE-2023-32315-K3ysTr0K3R_CVE-2023-32315-EXPLOIT.md)

## CVE-2023-32315-Openfire身份验证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致的身份验证绕过

**影响应用:** Openfire

**危害等级:** 高危，未经身份验证的攻击者可以创建管理员账户。

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** 目标系统运行受影响版本的Openfire，并且攻击者能够通过网络访问Openfire的Web管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 管理控制台身份验证绕过漏洞。由于存在路径遍历漏洞，未经身份验证的攻击者可以利用 Openfire 安装环境访问受限页面，从而在已配置的 Openfire 环境中创建管理员用户。漏洞利用方式如下：

1.  **漏洞原理：** 该漏洞利用了Openfire安装设置过程中的路径遍历缺陷，允许攻击者绕过身份验证，访问通常需要管理员权限才能访问的页面。
2.  **POC 代码分析：** 提供的Python脚本首先尝试从`/login.jsp`获取CSRF token。然后，它构造一个包含路径遍历的URL (`/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`)，以及要创建的管理员用户的用户名和密码。脚本使用`requests`库发送包含精心构造的URL的GET请求，并使用CSRF token绕过身份验证，从而创建新的管理员用户。
3.  **利用方式：**
    *   攻击者首先访问Openfire服务器的Web管理界面。
    *   攻击者使用包含路径遍历的恶意URL，绕过身份验证。
    *   攻击者通过构造的URL，创建一个新的管理员用户，从而获得对Openfire服务器的完全控制权。
4.  **投毒风险分析：** 该脚本的功能相对直接，主要用于利用漏洞创建管理员帐户。 脚本中使用了 `subprocess.Popen` 执行 curl 命令，如果目标服务器上 curl 被恶意修改，可能存在安全风险。此外，`mass_exploit` 函数从文件中读取目标 URL，如果该文件被篡改，可能导致脚本尝试攻击非预期目标。总体而言，投毒风险较低，约为10%， 主要集中在对外部命令的依赖以及批量攻击的目标文件。

**项目地址:** [K3ysTr0K3R/CVE-2023-32315-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2023-32315-EXPLOIT)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #3

**来源**: [CVE-2023-32315-ThatNotEasy_CVE-2023-32315.md](../2023/CVE-2023-32315-ThatNotEasy_CVE-2023-32315.md)

## CVE-2023-32315-Openfire-身份验证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 身份验证绕过/路径遍历

**影响应用:** Openfire

**危害等级:** 高危，可能导致未经授权的访问和潜在的远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8, 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务运行，目标端口开放，且Openfire版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 中的路径遍历漏洞。未经身份验证的攻击者可以通过向 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp` 发送特制的 HTTP 请求来绕过身份验证，访问受限的管理控制台页面。

**漏洞利用方式：**
1.  攻击者发送包含路径遍历序列（`%u002e%u002e/%u002e%u002e`）的恶意请求到 Openfire 服务器的 `/setup/setup-s/` 路径。
2.  路径遍历序列使得攻击者能够访问 `/user-groups.jsp` 等原本需要身份验证才能访问的管理页面。
3.  POC 代码首先尝试访问目标URL，如果成功获取JSESSIONID和CSRF token，则表明漏洞存在。代码会继续尝试利用该漏洞创建一个新的管理员用户。

**投毒风险评估：**
该 POC 代码主要包含以下功能：

*   发送包含路径遍历的 HTTP 请求。
*   提取服务器返回的 JSESSIONID 和 CSRF token。
*   构造并发送创建管理员用户的请求。

在提供的代码片段中，`generate_rando` 函数未完整定义，可能存在漏洞作者未公开的恶意行为。代码尝试从cookie中获取`JSESSIONID`和`csrf`,如果获取失败就无法继续利用。此外，该脚本依赖于 `HackRequests` 库，攻击者可能会篡改此库来植入恶意代码。虽然代码的主要目的是利用漏洞，但仍然存在一定的投毒风险，例如：

*   **潜在的后门创建：** 除了创建用户之外，攻击者可能添加额外的请求来执行其他恶意操作，例如部署 webshell 或修改系统配置。
*   **恶意库依赖：** `HackRequests` 库可能被替换为包含恶意代码的版本。
*   **信息收集：** 代码可能包含额外的逻辑来收集目标服务器的信息并发送给攻击者。

考虑到上述因素，该 POC 代码的投毒风险评估为 10%。需要人工审计整个代码才能完全确定是否存在恶意行为。

**项目地址:** [ThatNotEasy/CVE-2023-32315](https://github.com/ThatNotEasy/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #4

**来源**: [CVE-2023-32315-asepsaepdin_CVE-2023-32315.md](../2023/CVE-2023-32315-asepsaepdin_CVE-2023-32315.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可能导致未授权访问和控制Openfire服务器

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** 目标服务器运行存在漏洞版本的Openfire，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315是一个Openfire管理控制台的认证绕过漏洞。攻击者可以通过路径遍历攻击，利用未认证的Openfire安装环境，访问Openfire管理控制台的受限页面，从而创建新的管理员用户。该漏洞影响Openfire 3.10.0到4.6.7和4.7.0到4.7.4版本。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，以及搜索结果，该漏洞利用代码是有效的。搜索结果中提到该漏洞已经被野外利用，并且存在公开的PoC。

**投毒风险：**

提供的Python脚本`CVE-2023-32315.py`主要功能是利用CVE-2023-32315漏洞，通过构造恶意URL来绕过身份验证，在Openfire服务器上创建一个新的管理员用户。代码逻辑相对清晰，主要包括以下几个步骤：

1.  **获取CSRF Token:** 尝试从`/login.jsp`页面获取CSRF token，虽然这个token本身不是直接用于绕过认证，但是利用脚本在构造请求时会用到它。
2.  **构造恶意URL:** 使用路径遍历漏洞`setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`，直接访问用户创建页面，并设置用户名、密码以及管理员权限。
3.  **发送请求并验证结果:** 使用`requests`库发送GET请求，然后检查响应状态码，判断是否成功创建用户。

检查代码，没有发现明显的恶意行为，例如删除文件、传播恶意软件、或者进行其他未经授权的系统修改等。代码中使用的用户名和密码（hugme/HugmeNOW）也只是为了验证漏洞，并非后门。

代码中存在`subprocess.Popen`，理论上存在被注入命令的风险，但是代码中直接将构造好的命令赋值给`add_credentials_cmd`，其中`target_url`、`vuln_path`、`csrf_token` 等变量都经过了明确的赋值，没有用户可控的输入，因此被注入恶意命令的风险较低。

总体来说，该脚本本身被投毒的风险较低，大概为10%。风险主要来自于运行该脚本的环境是否安全，以及目标Openfire服务器的配置是否允许通过这种方式创建用户。

**利用方式：**

1.  **确定目标Openfire版本：** 确认目标Openfire服务器的版本在受影响的范围内（3.10.0 <= version < 4.6.8 或 4.7.0 <= version < 4.7.5）。
2.  **运行漏洞利用代码：** 运行提供的Python脚本，指定目标Openfire服务器的URL。
3.  **代码自动利用:**  脚本会自动尝试获取CSRF token，构造包含路径遍历的恶意URL，并发送请求创建新的管理员用户。
4.  **登录管理控制台：** 使用脚本中指定的用户名和密码（默认为hugme/HugmeNOW）登录Openfire的管理控制台。
5.  **控制服务器：** 成功登录后，攻击者可以执行任意管理操作，例如修改配置、安装插件、甚至执行系统命令。

**项目地址:** [asepsaepdin/CVE-2023-32315](https://github.com/asepsaepdin/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #5

**来源**: [CVE-2023-32315-gibran-abdillah_CVE-2023-32315.md](../2023/CVE-2023-32315-gibran-abdillah_CVE-2023-32315.md)

# CVE-2023-32315

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-32315-5rGJ5aCh5oCq5YW9_CVE-2023-32315exp.md](../2023/CVE-2023-32315-5rGJ5aCh5oCq5YW9_CVE-2023-32315exp.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 身份认证绕过 / 路径遍历

**影响应用:** Openfire

**危害等级:** 高危，允许未经授权访问管理控制台，可能导致敏感信息泄露和控制服务器

**影响版本:** 3.10.0 <= Openfire < 4.6.8, 4.7.0 <= Openfire < 4.7.5

**利用条件:** 目标系统运行受影响版本的Openfire，并且攻击者可以访问Openfire的Web管理界面(通常是9090端口)。需要目标服务器未完成初始化配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315 是一个 Openfire 的身份验证绕过漏洞，利用了路径遍历。攻击者可以利用此漏洞绕过身份验证，访问 Openfire 的管理控制台。\n\n**漏洞利用方式：**\n\n1.  **路径遍历：** 漏洞的根本原因是由于 Openfire 的安装设置页面存在路径遍历漏洞。攻击者可以构造特殊的 URL，例如`/setup/setup-s/%u002e%u002e/%u002e%u002e/log.jsp`，绕过身份验证检查，访问受限资源。其中`%u002e%u002e` 是 `..` 的 URL 编码，用于进行目录跳转。通过访问`log.jsp` 页面可以判断漏洞是否存在。\n2.  **创建管理员用户：** 利用路径遍历访问`user-create.jsp`页面，并结合一个有效的csrf token, 可以在无需认证的情况下创建新的管理员用户。 通过创建的管理员用户可以完全控制Openfire服务器。\n\n**POC 代码分析：**\n\n提供的 POC 代码 (Python) 演示了如何利用此漏洞。其步骤如下：\n\n1.  **获取 csrf token:** 访问`login.jsp`页面，从cookie中获取csrf token。\n2.  **构造 EXP URL：**  构造包含路径遍历的 URL，指向 `user-create.jsp` 页面，并附带创建管理员用户的必要参数，包括用户名、密码等。 URL 形式如: `{url}/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp?csrf={csrf_cookie}&username=admin4&name=admin4&email=admin4%40123.com&password=1234567&passwordConfirm=1234567&isadmin=on&create=%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7`。\n3.  **发送请求：** 使用 `HackRequests` 库发送构造的 URL 请求，创建新的管理员用户。\n\n**投毒风险分析：**\n\n对提供的代码进行了分析，并未发现任何明显的投毒代码。POC 代码的功能是利用漏洞创建管理员用户，所有操作均是为了验证漏洞的存在和利用，不存在植入后门或者恶意代码的行为。但是，请务必在非生产环境中使用此 POC，避免对实际系统造成损害。如果利用成功，攻击者可以通过新创建的管理员帐户完全控制 Openfire 服务器。

**项目地址:** [5rGJ5aCh5oCq5YW9/CVE-2023-32315exp](https://github.com/5rGJ5aCh5oCq5YW9/CVE-2023-32315exp)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #2

**来源**: [CVE-2023-32315-K3ysTr0K3R_CVE-2023-32315-EXPLOIT.md](../2023/CVE-2023-32315-K3ysTr0K3R_CVE-2023-32315-EXPLOIT.md)

## CVE-2023-32315-Openfire身份验证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致的身份验证绕过

**影响应用:** Openfire

**危害等级:** 高危，未经身份验证的攻击者可以创建管理员账户。

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** 目标系统运行受影响版本的Openfire，并且攻击者能够通过网络访问Openfire的Web管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 管理控制台身份验证绕过漏洞。由于存在路径遍历漏洞，未经身份验证的攻击者可以利用 Openfire 安装环境访问受限页面，从而在已配置的 Openfire 环境中创建管理员用户。漏洞利用方式如下：

1.  **漏洞原理：** 该漏洞利用了Openfire安装设置过程中的路径遍历缺陷，允许攻击者绕过身份验证，访问通常需要管理员权限才能访问的页面。
2.  **POC 代码分析：** 提供的Python脚本首先尝试从`/login.jsp`获取CSRF token。然后，它构造一个包含路径遍历的URL (`/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`)，以及要创建的管理员用户的用户名和密码。脚本使用`requests`库发送包含精心构造的URL的GET请求，并使用CSRF token绕过身份验证，从而创建新的管理员用户。
3.  **利用方式：**
    *   攻击者首先访问Openfire服务器的Web管理界面。
    *   攻击者使用包含路径遍历的恶意URL，绕过身份验证。
    *   攻击者通过构造的URL，创建一个新的管理员用户，从而获得对Openfire服务器的完全控制权。
4.  **投毒风险分析：** 该脚本的功能相对直接，主要用于利用漏洞创建管理员帐户。 脚本中使用了 `subprocess.Popen` 执行 curl 命令，如果目标服务器上 curl 被恶意修改，可能存在安全风险。此外，`mass_exploit` 函数从文件中读取目标 URL，如果该文件被篡改，可能导致脚本尝试攻击非预期目标。总体而言，投毒风险较低，约为10%， 主要集中在对外部命令的依赖以及批量攻击的目标文件。

**项目地址:** [K3ysTr0K3R/CVE-2023-32315-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2023-32315-EXPLOIT)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #3

**来源**: [CVE-2023-32315-ThatNotEasy_CVE-2023-32315.md](../2023/CVE-2023-32315-ThatNotEasy_CVE-2023-32315.md)

## CVE-2023-32315-Openfire-身份验证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 身份验证绕过/路径遍历

**影响应用:** Openfire

**危害等级:** 高危，可能导致未经授权的访问和潜在的远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8, 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务运行，目标端口开放，且Openfire版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 中的路径遍历漏洞。未经身份验证的攻击者可以通过向 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp` 发送特制的 HTTP 请求来绕过身份验证，访问受限的管理控制台页面。

**漏洞利用方式：**
1.  攻击者发送包含路径遍历序列（`%u002e%u002e/%u002e%u002e`）的恶意请求到 Openfire 服务器的 `/setup/setup-s/` 路径。
2.  路径遍历序列使得攻击者能够访问 `/user-groups.jsp` 等原本需要身份验证才能访问的管理页面。
3.  POC 代码首先尝试访问目标URL，如果成功获取JSESSIONID和CSRF token，则表明漏洞存在。代码会继续尝试利用该漏洞创建一个新的管理员用户。

**投毒风险评估：**
该 POC 代码主要包含以下功能：

*   发送包含路径遍历的 HTTP 请求。
*   提取服务器返回的 JSESSIONID 和 CSRF token。
*   构造并发送创建管理员用户的请求。

在提供的代码片段中，`generate_rando` 函数未完整定义，可能存在漏洞作者未公开的恶意行为。代码尝试从cookie中获取`JSESSIONID`和`csrf`,如果获取失败就无法继续利用。此外，该脚本依赖于 `HackRequests` 库，攻击者可能会篡改此库来植入恶意代码。虽然代码的主要目的是利用漏洞，但仍然存在一定的投毒风险，例如：

*   **潜在的后门创建：** 除了创建用户之外，攻击者可能添加额外的请求来执行其他恶意操作，例如部署 webshell 或修改系统配置。
*   **恶意库依赖：** `HackRequests` 库可能被替换为包含恶意代码的版本。
*   **信息收集：** 代码可能包含额外的逻辑来收集目标服务器的信息并发送给攻击者。

考虑到上述因素，该 POC 代码的投毒风险评估为 10%。需要人工审计整个代码才能完全确定是否存在恶意行为。

**项目地址:** [ThatNotEasy/CVE-2023-32315](https://github.com/ThatNotEasy/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #4

**来源**: [CVE-2023-32315-asepsaepdin_CVE-2023-32315.md](../2023/CVE-2023-32315-asepsaepdin_CVE-2023-32315.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可能导致未授权访问和控制Openfire服务器

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** 目标服务器运行存在漏洞版本的Openfire，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315是一个Openfire管理控制台的认证绕过漏洞。攻击者可以通过路径遍历攻击，利用未认证的Openfire安装环境，访问Openfire管理控制台的受限页面，从而创建新的管理员用户。该漏洞影响Openfire 3.10.0到4.6.7和4.7.0到4.7.4版本。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，以及搜索结果，该漏洞利用代码是有效的。搜索结果中提到该漏洞已经被野外利用，并且存在公开的PoC。

**投毒风险：**

提供的Python脚本`CVE-2023-32315.py`主要功能是利用CVE-2023-32315漏洞，通过构造恶意URL来绕过身份验证，在Openfire服务器上创建一个新的管理员用户。代码逻辑相对清晰，主要包括以下几个步骤：

1.  **获取CSRF Token:** 尝试从`/login.jsp`页面获取CSRF token，虽然这个token本身不是直接用于绕过认证，但是利用脚本在构造请求时会用到它。
2.  **构造恶意URL:** 使用路径遍历漏洞`setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`，直接访问用户创建页面，并设置用户名、密码以及管理员权限。
3.  **发送请求并验证结果:** 使用`requests`库发送GET请求，然后检查响应状态码，判断是否成功创建用户。

检查代码，没有发现明显的恶意行为，例如删除文件、传播恶意软件、或者进行其他未经授权的系统修改等。代码中使用的用户名和密码（hugme/HugmeNOW）也只是为了验证漏洞，并非后门。

代码中存在`subprocess.Popen`，理论上存在被注入命令的风险，但是代码中直接将构造好的命令赋值给`add_credentials_cmd`，其中`target_url`、`vuln_path`、`csrf_token` 等变量都经过了明确的赋值，没有用户可控的输入，因此被注入恶意命令的风险较低。

总体来说，该脚本本身被投毒的风险较低，大概为10%。风险主要来自于运行该脚本的环境是否安全，以及目标Openfire服务器的配置是否允许通过这种方式创建用户。

**利用方式：**

1.  **确定目标Openfire版本：** 确认目标Openfire服务器的版本在受影响的范围内（3.10.0 <= version < 4.6.8 或 4.7.0 <= version < 4.7.5）。
2.  **运行漏洞利用代码：** 运行提供的Python脚本，指定目标Openfire服务器的URL。
3.  **代码自动利用:**  脚本会自动尝试获取CSRF token，构造包含路径遍历的恶意URL，并发送请求创建新的管理员用户。
4.  **登录管理控制台：** 使用脚本中指定的用户名和密码（默认为hugme/HugmeNOW）登录Openfire的管理控制台。
5.  **控制服务器：** 成功登录后，攻击者可以执行任意管理操作，例如修改配置、安装插件、甚至执行系统命令。

**项目地址:** [asepsaepdin/CVE-2023-32315](https://github.com/asepsaepdin/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #5

**来源**: [CVE-2023-32315-gibran-abdillah_CVE-2023-32315.md](../2023/CVE-2023-32315-gibran-abdillah_CVE-2023-32315.md)

# CVE-2023-32315

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-32315-5rGJ5aCh5oCq5YW9_CVE-2023-32315exp.md](../2023/CVE-2023-32315-5rGJ5aCh5oCq5YW9_CVE-2023-32315exp.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 身份认证绕过 / 路径遍历

**影响应用:** Openfire

**危害等级:** 高危，允许未经授权访问管理控制台，可能导致敏感信息泄露和控制服务器

**影响版本:** 3.10.0 <= Openfire < 4.6.8, 4.7.0 <= Openfire < 4.7.5

**利用条件:** 目标系统运行受影响版本的Openfire，并且攻击者可以访问Openfire的Web管理界面(通常是9090端口)。需要目标服务器未完成初始化配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315 是一个 Openfire 的身份验证绕过漏洞，利用了路径遍历。攻击者可以利用此漏洞绕过身份验证，访问 Openfire 的管理控制台。\n\n**漏洞利用方式：**\n\n1.  **路径遍历：** 漏洞的根本原因是由于 Openfire 的安装设置页面存在路径遍历漏洞。攻击者可以构造特殊的 URL，例如`/setup/setup-s/%u002e%u002e/%u002e%u002e/log.jsp`，绕过身份验证检查，访问受限资源。其中`%u002e%u002e` 是 `..` 的 URL 编码，用于进行目录跳转。通过访问`log.jsp` 页面可以判断漏洞是否存在。\n2.  **创建管理员用户：** 利用路径遍历访问`user-create.jsp`页面，并结合一个有效的csrf token, 可以在无需认证的情况下创建新的管理员用户。 通过创建的管理员用户可以完全控制Openfire服务器。\n\n**POC 代码分析：**\n\n提供的 POC 代码 (Python) 演示了如何利用此漏洞。其步骤如下：\n\n1.  **获取 csrf token:** 访问`login.jsp`页面，从cookie中获取csrf token。\n2.  **构造 EXP URL：**  构造包含路径遍历的 URL，指向 `user-create.jsp` 页面，并附带创建管理员用户的必要参数，包括用户名、密码等。 URL 形式如: `{url}/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp?csrf={csrf_cookie}&username=admin4&name=admin4&email=admin4%40123.com&password=1234567&passwordConfirm=1234567&isadmin=on&create=%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7`。\n3.  **发送请求：** 使用 `HackRequests` 库发送构造的 URL 请求，创建新的管理员用户。\n\n**投毒风险分析：**\n\n对提供的代码进行了分析，并未发现任何明显的投毒代码。POC 代码的功能是利用漏洞创建管理员用户，所有操作均是为了验证漏洞的存在和利用，不存在植入后门或者恶意代码的行为。但是，请务必在非生产环境中使用此 POC，避免对实际系统造成损害。如果利用成功，攻击者可以通过新创建的管理员帐户完全控制 Openfire 服务器。

**项目地址:** [5rGJ5aCh5oCq5YW9/CVE-2023-32315exp](https://github.com/5rGJ5aCh5oCq5YW9/CVE-2023-32315exp)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #2

**来源**: [CVE-2023-32315-K3ysTr0K3R_CVE-2023-32315-EXPLOIT.md](../2023/CVE-2023-32315-K3ysTr0K3R_CVE-2023-32315-EXPLOIT.md)

## CVE-2023-32315-Openfire身份验证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致的身份验证绕过

**影响应用:** Openfire

**危害等级:** 高危，未经身份验证的攻击者可以创建管理员账户。

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** 目标系统运行受影响版本的Openfire，并且攻击者能够通过网络访问Openfire的Web管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 管理控制台身份验证绕过漏洞。由于存在路径遍历漏洞，未经身份验证的攻击者可以利用 Openfire 安装环境访问受限页面，从而在已配置的 Openfire 环境中创建管理员用户。漏洞利用方式如下：

1.  **漏洞原理：** 该漏洞利用了Openfire安装设置过程中的路径遍历缺陷，允许攻击者绕过身份验证，访问通常需要管理员权限才能访问的页面。
2.  **POC 代码分析：** 提供的Python脚本首先尝试从`/login.jsp`获取CSRF token。然后，它构造一个包含路径遍历的URL (`/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`)，以及要创建的管理员用户的用户名和密码。脚本使用`requests`库发送包含精心构造的URL的GET请求，并使用CSRF token绕过身份验证，从而创建新的管理员用户。
3.  **利用方式：**
    *   攻击者首先访问Openfire服务器的Web管理界面。
    *   攻击者使用包含路径遍历的恶意URL，绕过身份验证。
    *   攻击者通过构造的URL，创建一个新的管理员用户，从而获得对Openfire服务器的完全控制权。
4.  **投毒风险分析：** 该脚本的功能相对直接，主要用于利用漏洞创建管理员帐户。 脚本中使用了 `subprocess.Popen` 执行 curl 命令，如果目标服务器上 curl 被恶意修改，可能存在安全风险。此外，`mass_exploit` 函数从文件中读取目标 URL，如果该文件被篡改，可能导致脚本尝试攻击非预期目标。总体而言，投毒风险较低，约为10%， 主要集中在对外部命令的依赖以及批量攻击的目标文件。

**项目地址:** [K3ysTr0K3R/CVE-2023-32315-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2023-32315-EXPLOIT)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #3

**来源**: [CVE-2023-32315-ThatNotEasy_CVE-2023-32315.md](../2023/CVE-2023-32315-ThatNotEasy_CVE-2023-32315.md)

## CVE-2023-32315-Openfire-身份验证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 身份验证绕过/路径遍历

**影响应用:** Openfire

**危害等级:** 高危，可能导致未经授权的访问和潜在的远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8, 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务运行，目标端口开放，且Openfire版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 中的路径遍历漏洞。未经身份验证的攻击者可以通过向 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp` 发送特制的 HTTP 请求来绕过身份验证，访问受限的管理控制台页面。

**漏洞利用方式：**
1.  攻击者发送包含路径遍历序列（`%u002e%u002e/%u002e%u002e`）的恶意请求到 Openfire 服务器的 `/setup/setup-s/` 路径。
2.  路径遍历序列使得攻击者能够访问 `/user-groups.jsp` 等原本需要身份验证才能访问的管理页面。
3.  POC 代码首先尝试访问目标URL，如果成功获取JSESSIONID和CSRF token，则表明漏洞存在。代码会继续尝试利用该漏洞创建一个新的管理员用户。

**投毒风险评估：**
该 POC 代码主要包含以下功能：

*   发送包含路径遍历的 HTTP 请求。
*   提取服务器返回的 JSESSIONID 和 CSRF token。
*   构造并发送创建管理员用户的请求。

在提供的代码片段中，`generate_rando` 函数未完整定义，可能存在漏洞作者未公开的恶意行为。代码尝试从cookie中获取`JSESSIONID`和`csrf`,如果获取失败就无法继续利用。此外，该脚本依赖于 `HackRequests` 库，攻击者可能会篡改此库来植入恶意代码。虽然代码的主要目的是利用漏洞，但仍然存在一定的投毒风险，例如：

*   **潜在的后门创建：** 除了创建用户之外，攻击者可能添加额外的请求来执行其他恶意操作，例如部署 webshell 或修改系统配置。
*   **恶意库依赖：** `HackRequests` 库可能被替换为包含恶意代码的版本。
*   **信息收集：** 代码可能包含额外的逻辑来收集目标服务器的信息并发送给攻击者。

考虑到上述因素，该 POC 代码的投毒风险评估为 10%。需要人工审计整个代码才能完全确定是否存在恶意行为。

**项目地址:** [ThatNotEasy/CVE-2023-32315](https://github.com/ThatNotEasy/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #4

**来源**: [CVE-2023-32315-asepsaepdin_CVE-2023-32315.md](../2023/CVE-2023-32315-asepsaepdin_CVE-2023-32315.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可能导致未授权访问和控制Openfire服务器

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** 目标服务器运行存在漏洞版本的Openfire，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315是一个Openfire管理控制台的认证绕过漏洞。攻击者可以通过路径遍历攻击，利用未认证的Openfire安装环境，访问Openfire管理控制台的受限页面，从而创建新的管理员用户。该漏洞影响Openfire 3.10.0到4.6.7和4.7.0到4.7.4版本。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，以及搜索结果，该漏洞利用代码是有效的。搜索结果中提到该漏洞已经被野外利用，并且存在公开的PoC。

**投毒风险：**

提供的Python脚本`CVE-2023-32315.py`主要功能是利用CVE-2023-32315漏洞，通过构造恶意URL来绕过身份验证，在Openfire服务器上创建一个新的管理员用户。代码逻辑相对清晰，主要包括以下几个步骤：

1.  **获取CSRF Token:** 尝试从`/login.jsp`页面获取CSRF token，虽然这个token本身不是直接用于绕过认证，但是利用脚本在构造请求时会用到它。
2.  **构造恶意URL:** 使用路径遍历漏洞`setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`，直接访问用户创建页面，并设置用户名、密码以及管理员权限。
3.  **发送请求并验证结果:** 使用`requests`库发送GET请求，然后检查响应状态码，判断是否成功创建用户。

检查代码，没有发现明显的恶意行为，例如删除文件、传播恶意软件、或者进行其他未经授权的系统修改等。代码中使用的用户名和密码（hugme/HugmeNOW）也只是为了验证漏洞，并非后门。

代码中存在`subprocess.Popen`，理论上存在被注入命令的风险，但是代码中直接将构造好的命令赋值给`add_credentials_cmd`，其中`target_url`、`vuln_path`、`csrf_token` 等变量都经过了明确的赋值，没有用户可控的输入，因此被注入恶意命令的风险较低。

总体来说，该脚本本身被投毒的风险较低，大概为10%。风险主要来自于运行该脚本的环境是否安全，以及目标Openfire服务器的配置是否允许通过这种方式创建用户。

**利用方式：**

1.  **确定目标Openfire版本：** 确认目标Openfire服务器的版本在受影响的范围内（3.10.0 <= version < 4.6.8 或 4.7.0 <= version < 4.7.5）。
2.  **运行漏洞利用代码：** 运行提供的Python脚本，指定目标Openfire服务器的URL。
3.  **代码自动利用:**  脚本会自动尝试获取CSRF token，构造包含路径遍历的恶意URL，并发送请求创建新的管理员用户。
4.  **登录管理控制台：** 使用脚本中指定的用户名和密码（默认为hugme/HugmeNOW）登录Openfire的管理控制台。
5.  **控制服务器：** 成功登录后，攻击者可以执行任意管理操作，例如修改配置、安装插件、甚至执行系统命令。

**项目地址:** [asepsaepdin/CVE-2023-32315](https://github.com/asepsaepdin/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #5

**来源**: [CVE-2023-32315-gibran-abdillah_CVE-2023-32315.md](../2023/CVE-2023-32315-gibran-abdillah_CVE-2023-32315.md)

# CVE-2023-32315

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-32315-5rGJ5aCh5oCq5YW9_CVE-2023-32315exp.md](../2023/CVE-2023-32315-5rGJ5aCh5oCq5YW9_CVE-2023-32315exp.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 身份认证绕过 / 路径遍历

**影响应用:** Openfire

**危害等级:** 高危，允许未经授权访问管理控制台，可能导致敏感信息泄露和控制服务器

**影响版本:** 3.10.0 <= Openfire < 4.6.8, 4.7.0 <= Openfire < 4.7.5

**利用条件:** 目标系统运行受影响版本的Openfire，并且攻击者可以访问Openfire的Web管理界面(通常是9090端口)。需要目标服务器未完成初始化配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315 是一个 Openfire 的身份验证绕过漏洞，利用了路径遍历。攻击者可以利用此漏洞绕过身份验证，访问 Openfire 的管理控制台。\n\n**漏洞利用方式：**\n\n1.  **路径遍历：** 漏洞的根本原因是由于 Openfire 的安装设置页面存在路径遍历漏洞。攻击者可以构造特殊的 URL，例如`/setup/setup-s/%u002e%u002e/%u002e%u002e/log.jsp`，绕过身份验证检查，访问受限资源。其中`%u002e%u002e` 是 `..` 的 URL 编码，用于进行目录跳转。通过访问`log.jsp` 页面可以判断漏洞是否存在。\n2.  **创建管理员用户：** 利用路径遍历访问`user-create.jsp`页面，并结合一个有效的csrf token, 可以在无需认证的情况下创建新的管理员用户。 通过创建的管理员用户可以完全控制Openfire服务器。\n\n**POC 代码分析：**\n\n提供的 POC 代码 (Python) 演示了如何利用此漏洞。其步骤如下：\n\n1.  **获取 csrf token:** 访问`login.jsp`页面，从cookie中获取csrf token。\n2.  **构造 EXP URL：**  构造包含路径遍历的 URL，指向 `user-create.jsp` 页面，并附带创建管理员用户的必要参数，包括用户名、密码等。 URL 形式如: `{url}/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp?csrf={csrf_cookie}&username=admin4&name=admin4&email=admin4%40123.com&password=1234567&passwordConfirm=1234567&isadmin=on&create=%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7`。\n3.  **发送请求：** 使用 `HackRequests` 库发送构造的 URL 请求，创建新的管理员用户。\n\n**投毒风险分析：**\n\n对提供的代码进行了分析，并未发现任何明显的投毒代码。POC 代码的功能是利用漏洞创建管理员用户，所有操作均是为了验证漏洞的存在和利用，不存在植入后门或者恶意代码的行为。但是，请务必在非生产环境中使用此 POC，避免对实际系统造成损害。如果利用成功，攻击者可以通过新创建的管理员帐户完全控制 Openfire 服务器。

**项目地址:** [5rGJ5aCh5oCq5YW9/CVE-2023-32315exp](https://github.com/5rGJ5aCh5oCq5YW9/CVE-2023-32315exp)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #2

**来源**: [CVE-2023-32315-K3ysTr0K3R_CVE-2023-32315-EXPLOIT.md](../2023/CVE-2023-32315-K3ysTr0K3R_CVE-2023-32315-EXPLOIT.md)

## CVE-2023-32315-Openfire身份验证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致的身份验证绕过

**影响应用:** Openfire

**危害等级:** 高危，未经身份验证的攻击者可以创建管理员账户。

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** 目标系统运行受影响版本的Openfire，并且攻击者能够通过网络访问Openfire的Web管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 管理控制台身份验证绕过漏洞。由于存在路径遍历漏洞，未经身份验证的攻击者可以利用 Openfire 安装环境访问受限页面，从而在已配置的 Openfire 环境中创建管理员用户。漏洞利用方式如下：

1.  **漏洞原理：** 该漏洞利用了Openfire安装设置过程中的路径遍历缺陷，允许攻击者绕过身份验证，访问通常需要管理员权限才能访问的页面。
2.  **POC 代码分析：** 提供的Python脚本首先尝试从`/login.jsp`获取CSRF token。然后，它构造一个包含路径遍历的URL (`/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`)，以及要创建的管理员用户的用户名和密码。脚本使用`requests`库发送包含精心构造的URL的GET请求，并使用CSRF token绕过身份验证，从而创建新的管理员用户。
3.  **利用方式：**
    *   攻击者首先访问Openfire服务器的Web管理界面。
    *   攻击者使用包含路径遍历的恶意URL，绕过身份验证。
    *   攻击者通过构造的URL，创建一个新的管理员用户，从而获得对Openfire服务器的完全控制权。
4.  **投毒风险分析：** 该脚本的功能相对直接，主要用于利用漏洞创建管理员帐户。 脚本中使用了 `subprocess.Popen` 执行 curl 命令，如果目标服务器上 curl 被恶意修改，可能存在安全风险。此外，`mass_exploit` 函数从文件中读取目标 URL，如果该文件被篡改，可能导致脚本尝试攻击非预期目标。总体而言，投毒风险较低，约为10%， 主要集中在对外部命令的依赖以及批量攻击的目标文件。

**项目地址:** [K3ysTr0K3R/CVE-2023-32315-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2023-32315-EXPLOIT)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #3

**来源**: [CVE-2023-32315-ThatNotEasy_CVE-2023-32315.md](../2023/CVE-2023-32315-ThatNotEasy_CVE-2023-32315.md)

## CVE-2023-32315-Openfire-身份验证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 身份验证绕过/路径遍历

**影响应用:** Openfire

**危害等级:** 高危，可能导致未经授权的访问和潜在的远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8, 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务运行，目标端口开放，且Openfire版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 中的路径遍历漏洞。未经身份验证的攻击者可以通过向 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp` 发送特制的 HTTP 请求来绕过身份验证，访问受限的管理控制台页面。

**漏洞利用方式：**
1.  攻击者发送包含路径遍历序列（`%u002e%u002e/%u002e%u002e`）的恶意请求到 Openfire 服务器的 `/setup/setup-s/` 路径。
2.  路径遍历序列使得攻击者能够访问 `/user-groups.jsp` 等原本需要身份验证才能访问的管理页面。
3.  POC 代码首先尝试访问目标URL，如果成功获取JSESSIONID和CSRF token，则表明漏洞存在。代码会继续尝试利用该漏洞创建一个新的管理员用户。

**投毒风险评估：**
该 POC 代码主要包含以下功能：

*   发送包含路径遍历的 HTTP 请求。
*   提取服务器返回的 JSESSIONID 和 CSRF token。
*   构造并发送创建管理员用户的请求。

在提供的代码片段中，`generate_rando` 函数未完整定义，可能存在漏洞作者未公开的恶意行为。代码尝试从cookie中获取`JSESSIONID`和`csrf`,如果获取失败就无法继续利用。此外，该脚本依赖于 `HackRequests` 库，攻击者可能会篡改此库来植入恶意代码。虽然代码的主要目的是利用漏洞，但仍然存在一定的投毒风险，例如：

*   **潜在的后门创建：** 除了创建用户之外，攻击者可能添加额外的请求来执行其他恶意操作，例如部署 webshell 或修改系统配置。
*   **恶意库依赖：** `HackRequests` 库可能被替换为包含恶意代码的版本。
*   **信息收集：** 代码可能包含额外的逻辑来收集目标服务器的信息并发送给攻击者。

考虑到上述因素，该 POC 代码的投毒风险评估为 10%。需要人工审计整个代码才能完全确定是否存在恶意行为。

**项目地址:** [ThatNotEasy/CVE-2023-32315](https://github.com/ThatNotEasy/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #4

**来源**: [CVE-2023-32315-asepsaepdin_CVE-2023-32315.md](../2023/CVE-2023-32315-asepsaepdin_CVE-2023-32315.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可能导致未授权访问和控制Openfire服务器

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** 目标服务器运行存在漏洞版本的Openfire，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315是一个Openfire管理控制台的认证绕过漏洞。攻击者可以通过路径遍历攻击，利用未认证的Openfire安装环境，访问Openfire管理控制台的受限页面，从而创建新的管理员用户。该漏洞影响Openfire 3.10.0到4.6.7和4.7.0到4.7.4版本。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，以及搜索结果，该漏洞利用代码是有效的。搜索结果中提到该漏洞已经被野外利用，并且存在公开的PoC。

**投毒风险：**

提供的Python脚本`CVE-2023-32315.py`主要功能是利用CVE-2023-32315漏洞，通过构造恶意URL来绕过身份验证，在Openfire服务器上创建一个新的管理员用户。代码逻辑相对清晰，主要包括以下几个步骤：

1.  **获取CSRF Token:** 尝试从`/login.jsp`页面获取CSRF token，虽然这个token本身不是直接用于绕过认证，但是利用脚本在构造请求时会用到它。
2.  **构造恶意URL:** 使用路径遍历漏洞`setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`，直接访问用户创建页面，并设置用户名、密码以及管理员权限。
3.  **发送请求并验证结果:** 使用`requests`库发送GET请求，然后检查响应状态码，判断是否成功创建用户。

检查代码，没有发现明显的恶意行为，例如删除文件、传播恶意软件、或者进行其他未经授权的系统修改等。代码中使用的用户名和密码（hugme/HugmeNOW）也只是为了验证漏洞，并非后门。

代码中存在`subprocess.Popen`，理论上存在被注入命令的风险，但是代码中直接将构造好的命令赋值给`add_credentials_cmd`，其中`target_url`、`vuln_path`、`csrf_token` 等变量都经过了明确的赋值，没有用户可控的输入，因此被注入恶意命令的风险较低。

总体来说，该脚本本身被投毒的风险较低，大概为10%。风险主要来自于运行该脚本的环境是否安全，以及目标Openfire服务器的配置是否允许通过这种方式创建用户。

**利用方式：**

1.  **确定目标Openfire版本：** 确认目标Openfire服务器的版本在受影响的范围内（3.10.0 <= version < 4.6.8 或 4.7.0 <= version < 4.7.5）。
2.  **运行漏洞利用代码：** 运行提供的Python脚本，指定目标Openfire服务器的URL。
3.  **代码自动利用:**  脚本会自动尝试获取CSRF token，构造包含路径遍历的恶意URL，并发送请求创建新的管理员用户。
4.  **登录管理控制台：** 使用脚本中指定的用户名和密码（默认为hugme/HugmeNOW）登录Openfire的管理控制台。
5.  **控制服务器：** 成功登录后，攻击者可以执行任意管理操作，例如修改配置、安装插件、甚至执行系统命令。

**项目地址:** [asepsaepdin/CVE-2023-32315](https://github.com/asepsaepdin/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #5

**来源**: [CVE-2023-32315-gibran-abdillah_CVE-2023-32315.md](../2023/CVE-2023-32315-gibran-abdillah_CVE-2023-32315.md)

# CVE-2023-32315

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-32315-5rGJ5aCh5oCq5YW9_CVE-2023-32315exp.md](../2023/CVE-2023-32315-5rGJ5aCh5oCq5YW9_CVE-2023-32315exp.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 身份认证绕过 / 路径遍历

**影响应用:** Openfire

**危害等级:** 高危，允许未经授权访问管理控制台，可能导致敏感信息泄露和控制服务器

**影响版本:** 3.10.0 <= Openfire < 4.6.8, 4.7.0 <= Openfire < 4.7.5

**利用条件:** 目标系统运行受影响版本的Openfire，并且攻击者可以访问Openfire的Web管理界面(通常是9090端口)。需要目标服务器未完成初始化配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315 是一个 Openfire 的身份验证绕过漏洞，利用了路径遍历。攻击者可以利用此漏洞绕过身份验证，访问 Openfire 的管理控制台。\n\n**漏洞利用方式：**\n\n1.  **路径遍历：** 漏洞的根本原因是由于 Openfire 的安装设置页面存在路径遍历漏洞。攻击者可以构造特殊的 URL，例如`/setup/setup-s/%u002e%u002e/%u002e%u002e/log.jsp`，绕过身份验证检查，访问受限资源。其中`%u002e%u002e` 是 `..` 的 URL 编码，用于进行目录跳转。通过访问`log.jsp` 页面可以判断漏洞是否存在。\n2.  **创建管理员用户：** 利用路径遍历访问`user-create.jsp`页面，并结合一个有效的csrf token, 可以在无需认证的情况下创建新的管理员用户。 通过创建的管理员用户可以完全控制Openfire服务器。\n\n**POC 代码分析：**\n\n提供的 POC 代码 (Python) 演示了如何利用此漏洞。其步骤如下：\n\n1.  **获取 csrf token:** 访问`login.jsp`页面，从cookie中获取csrf token。\n2.  **构造 EXP URL：**  构造包含路径遍历的 URL，指向 `user-create.jsp` 页面，并附带创建管理员用户的必要参数，包括用户名、密码等。 URL 形式如: `{url}/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp?csrf={csrf_cookie}&username=admin4&name=admin4&email=admin4%40123.com&password=1234567&passwordConfirm=1234567&isadmin=on&create=%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7`。\n3.  **发送请求：** 使用 `HackRequests` 库发送构造的 URL 请求，创建新的管理员用户。\n\n**投毒风险分析：**\n\n对提供的代码进行了分析，并未发现任何明显的投毒代码。POC 代码的功能是利用漏洞创建管理员用户，所有操作均是为了验证漏洞的存在和利用，不存在植入后门或者恶意代码的行为。但是，请务必在非生产环境中使用此 POC，避免对实际系统造成损害。如果利用成功，攻击者可以通过新创建的管理员帐户完全控制 Openfire 服务器。

**项目地址:** [5rGJ5aCh5oCq5YW9/CVE-2023-32315exp](https://github.com/5rGJ5aCh5oCq5YW9/CVE-2023-32315exp)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #2

**来源**: [CVE-2023-32315-K3ysTr0K3R_CVE-2023-32315-EXPLOIT.md](../2023/CVE-2023-32315-K3ysTr0K3R_CVE-2023-32315-EXPLOIT.md)

## CVE-2023-32315-Openfire身份验证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致的身份验证绕过

**影响应用:** Openfire

**危害等级:** 高危，未经身份验证的攻击者可以创建管理员账户。

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** 目标系统运行受影响版本的Openfire，并且攻击者能够通过网络访问Openfire的Web管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 管理控制台身份验证绕过漏洞。由于存在路径遍历漏洞，未经身份验证的攻击者可以利用 Openfire 安装环境访问受限页面，从而在已配置的 Openfire 环境中创建管理员用户。漏洞利用方式如下：

1.  **漏洞原理：** 该漏洞利用了Openfire安装设置过程中的路径遍历缺陷，允许攻击者绕过身份验证，访问通常需要管理员权限才能访问的页面。
2.  **POC 代码分析：** 提供的Python脚本首先尝试从`/login.jsp`获取CSRF token。然后，它构造一个包含路径遍历的URL (`/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`)，以及要创建的管理员用户的用户名和密码。脚本使用`requests`库发送包含精心构造的URL的GET请求，并使用CSRF token绕过身份验证，从而创建新的管理员用户。
3.  **利用方式：**
    *   攻击者首先访问Openfire服务器的Web管理界面。
    *   攻击者使用包含路径遍历的恶意URL，绕过身份验证。
    *   攻击者通过构造的URL，创建一个新的管理员用户，从而获得对Openfire服务器的完全控制权。
4.  **投毒风险分析：** 该脚本的功能相对直接，主要用于利用漏洞创建管理员帐户。 脚本中使用了 `subprocess.Popen` 执行 curl 命令，如果目标服务器上 curl 被恶意修改，可能存在安全风险。此外，`mass_exploit` 函数从文件中读取目标 URL，如果该文件被篡改，可能导致脚本尝试攻击非预期目标。总体而言，投毒风险较低，约为10%， 主要集中在对外部命令的依赖以及批量攻击的目标文件。

**项目地址:** [K3ysTr0K3R/CVE-2023-32315-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2023-32315-EXPLOIT)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #3

**来源**: [CVE-2023-32315-ThatNotEasy_CVE-2023-32315.md](../2023/CVE-2023-32315-ThatNotEasy_CVE-2023-32315.md)

## CVE-2023-32315-Openfire-身份验证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 身份验证绕过/路径遍历

**影响应用:** Openfire

**危害等级:** 高危，可能导致未经授权的访问和潜在的远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8, 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务运行，目标端口开放，且Openfire版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 中的路径遍历漏洞。未经身份验证的攻击者可以通过向 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp` 发送特制的 HTTP 请求来绕过身份验证，访问受限的管理控制台页面。

**漏洞利用方式：**
1.  攻击者发送包含路径遍历序列（`%u002e%u002e/%u002e%u002e`）的恶意请求到 Openfire 服务器的 `/setup/setup-s/` 路径。
2.  路径遍历序列使得攻击者能够访问 `/user-groups.jsp` 等原本需要身份验证才能访问的管理页面。
3.  POC 代码首先尝试访问目标URL，如果成功获取JSESSIONID和CSRF token，则表明漏洞存在。代码会继续尝试利用该漏洞创建一个新的管理员用户。

**投毒风险评估：**
该 POC 代码主要包含以下功能：

*   发送包含路径遍历的 HTTP 请求。
*   提取服务器返回的 JSESSIONID 和 CSRF token。
*   构造并发送创建管理员用户的请求。

在提供的代码片段中，`generate_rando` 函数未完整定义，可能存在漏洞作者未公开的恶意行为。代码尝试从cookie中获取`JSESSIONID`和`csrf`,如果获取失败就无法继续利用。此外，该脚本依赖于 `HackRequests` 库，攻击者可能会篡改此库来植入恶意代码。虽然代码的主要目的是利用漏洞，但仍然存在一定的投毒风险，例如：

*   **潜在的后门创建：** 除了创建用户之外，攻击者可能添加额外的请求来执行其他恶意操作，例如部署 webshell 或修改系统配置。
*   **恶意库依赖：** `HackRequests` 库可能被替换为包含恶意代码的版本。
*   **信息收集：** 代码可能包含额外的逻辑来收集目标服务器的信息并发送给攻击者。

考虑到上述因素，该 POC 代码的投毒风险评估为 10%。需要人工审计整个代码才能完全确定是否存在恶意行为。

**项目地址:** [ThatNotEasy/CVE-2023-32315](https://github.com/ThatNotEasy/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #4

**来源**: [CVE-2023-32315-asepsaepdin_CVE-2023-32315.md](../2023/CVE-2023-32315-asepsaepdin_CVE-2023-32315.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可能导致未授权访问和控制Openfire服务器

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** 目标服务器运行存在漏洞版本的Openfire，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315是一个Openfire管理控制台的认证绕过漏洞。攻击者可以通过路径遍历攻击，利用未认证的Openfire安装环境，访问Openfire管理控制台的受限页面，从而创建新的管理员用户。该漏洞影响Openfire 3.10.0到4.6.7和4.7.0到4.7.4版本。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，以及搜索结果，该漏洞利用代码是有效的。搜索结果中提到该漏洞已经被野外利用，并且存在公开的PoC。

**投毒风险：**

提供的Python脚本`CVE-2023-32315.py`主要功能是利用CVE-2023-32315漏洞，通过构造恶意URL来绕过身份验证，在Openfire服务器上创建一个新的管理员用户。代码逻辑相对清晰，主要包括以下几个步骤：

1.  **获取CSRF Token:** 尝试从`/login.jsp`页面获取CSRF token，虽然这个token本身不是直接用于绕过认证，但是利用脚本在构造请求时会用到它。
2.  **构造恶意URL:** 使用路径遍历漏洞`setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`，直接访问用户创建页面，并设置用户名、密码以及管理员权限。
3.  **发送请求并验证结果:** 使用`requests`库发送GET请求，然后检查响应状态码，判断是否成功创建用户。

检查代码，没有发现明显的恶意行为，例如删除文件、传播恶意软件、或者进行其他未经授权的系统修改等。代码中使用的用户名和密码（hugme/HugmeNOW）也只是为了验证漏洞，并非后门。

代码中存在`subprocess.Popen`，理论上存在被注入命令的风险，但是代码中直接将构造好的命令赋值给`add_credentials_cmd`，其中`target_url`、`vuln_path`、`csrf_token` 等变量都经过了明确的赋值，没有用户可控的输入，因此被注入恶意命令的风险较低。

总体来说，该脚本本身被投毒的风险较低，大概为10%。风险主要来自于运行该脚本的环境是否安全，以及目标Openfire服务器的配置是否允许通过这种方式创建用户。

**利用方式：**

1.  **确定目标Openfire版本：** 确认目标Openfire服务器的版本在受影响的范围内（3.10.0 <= version < 4.6.8 或 4.7.0 <= version < 4.7.5）。
2.  **运行漏洞利用代码：** 运行提供的Python脚本，指定目标Openfire服务器的URL。
3.  **代码自动利用:**  脚本会自动尝试获取CSRF token，构造包含路径遍历的恶意URL，并发送请求创建新的管理员用户。
4.  **登录管理控制台：** 使用脚本中指定的用户名和密码（默认为hugme/HugmeNOW）登录Openfire的管理控制台。
5.  **控制服务器：** 成功登录后，攻击者可以执行任意管理操作，例如修改配置、安装插件、甚至执行系统命令。

**项目地址:** [asepsaepdin/CVE-2023-32315](https://github.com/asepsaepdin/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #5

**来源**: [CVE-2023-32315-gibran-abdillah_CVE-2023-32315.md](../2023/CVE-2023-32315-gibran-abdillah_CVE-2023-32315.md)

# CVE-2023-32315

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-32315-5rGJ5aCh5oCq5YW9_CVE-2023-32315exp.md](../2023/CVE-2023-32315-5rGJ5aCh5oCq5YW9_CVE-2023-32315exp.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 身份认证绕过 / 路径遍历

**影响应用:** Openfire

**危害等级:** 高危，允许未经授权访问管理控制台，可能导致敏感信息泄露和控制服务器

**影响版本:** 3.10.0 <= Openfire < 4.6.8, 4.7.0 <= Openfire < 4.7.5

**利用条件:** 目标系统运行受影响版本的Openfire，并且攻击者可以访问Openfire的Web管理界面(通常是9090端口)。需要目标服务器未完成初始化配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315 是一个 Openfire 的身份验证绕过漏洞，利用了路径遍历。攻击者可以利用此漏洞绕过身份验证，访问 Openfire 的管理控制台。\n\n**漏洞利用方式：**\n\n1.  **路径遍历：** 漏洞的根本原因是由于 Openfire 的安装设置页面存在路径遍历漏洞。攻击者可以构造特殊的 URL，例如`/setup/setup-s/%u002e%u002e/%u002e%u002e/log.jsp`，绕过身份验证检查，访问受限资源。其中`%u002e%u002e` 是 `..` 的 URL 编码，用于进行目录跳转。通过访问`log.jsp` 页面可以判断漏洞是否存在。\n2.  **创建管理员用户：** 利用路径遍历访问`user-create.jsp`页面，并结合一个有效的csrf token, 可以在无需认证的情况下创建新的管理员用户。 通过创建的管理员用户可以完全控制Openfire服务器。\n\n**POC 代码分析：**\n\n提供的 POC 代码 (Python) 演示了如何利用此漏洞。其步骤如下：\n\n1.  **获取 csrf token:** 访问`login.jsp`页面，从cookie中获取csrf token。\n2.  **构造 EXP URL：**  构造包含路径遍历的 URL，指向 `user-create.jsp` 页面，并附带创建管理员用户的必要参数，包括用户名、密码等。 URL 形式如: `{url}/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp?csrf={csrf_cookie}&username=admin4&name=admin4&email=admin4%40123.com&password=1234567&passwordConfirm=1234567&isadmin=on&create=%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7`。\n3.  **发送请求：** 使用 `HackRequests` 库发送构造的 URL 请求，创建新的管理员用户。\n\n**投毒风险分析：**\n\n对提供的代码进行了分析，并未发现任何明显的投毒代码。POC 代码的功能是利用漏洞创建管理员用户，所有操作均是为了验证漏洞的存在和利用，不存在植入后门或者恶意代码的行为。但是，请务必在非生产环境中使用此 POC，避免对实际系统造成损害。如果利用成功，攻击者可以通过新创建的管理员帐户完全控制 Openfire 服务器。

**项目地址:** [5rGJ5aCh5oCq5YW9/CVE-2023-32315exp](https://github.com/5rGJ5aCh5oCq5YW9/CVE-2023-32315exp)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #2

**来源**: [CVE-2023-32315-K3ysTr0K3R_CVE-2023-32315-EXPLOIT.md](../2023/CVE-2023-32315-K3ysTr0K3R_CVE-2023-32315-EXPLOIT.md)

## CVE-2023-32315-Openfire身份验证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致的身份验证绕过

**影响应用:** Openfire

**危害等级:** 高危，未经身份验证的攻击者可以创建管理员账户。

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** 目标系统运行受影响版本的Openfire，并且攻击者能够通过网络访问Openfire的Web管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 管理控制台身份验证绕过漏洞。由于存在路径遍历漏洞，未经身份验证的攻击者可以利用 Openfire 安装环境访问受限页面，从而在已配置的 Openfire 环境中创建管理员用户。漏洞利用方式如下：

1.  **漏洞原理：** 该漏洞利用了Openfire安装设置过程中的路径遍历缺陷，允许攻击者绕过身份验证，访问通常需要管理员权限才能访问的页面。
2.  **POC 代码分析：** 提供的Python脚本首先尝试从`/login.jsp`获取CSRF token。然后，它构造一个包含路径遍历的URL (`/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`)，以及要创建的管理员用户的用户名和密码。脚本使用`requests`库发送包含精心构造的URL的GET请求，并使用CSRF token绕过身份验证，从而创建新的管理员用户。
3.  **利用方式：**
    *   攻击者首先访问Openfire服务器的Web管理界面。
    *   攻击者使用包含路径遍历的恶意URL，绕过身份验证。
    *   攻击者通过构造的URL，创建一个新的管理员用户，从而获得对Openfire服务器的完全控制权。
4.  **投毒风险分析：** 该脚本的功能相对直接，主要用于利用漏洞创建管理员帐户。 脚本中使用了 `subprocess.Popen` 执行 curl 命令，如果目标服务器上 curl 被恶意修改，可能存在安全风险。此外，`mass_exploit` 函数从文件中读取目标 URL，如果该文件被篡改，可能导致脚本尝试攻击非预期目标。总体而言，投毒风险较低，约为10%， 主要集中在对外部命令的依赖以及批量攻击的目标文件。

**项目地址:** [K3ysTr0K3R/CVE-2023-32315-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2023-32315-EXPLOIT)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #3

**来源**: [CVE-2023-32315-ThatNotEasy_CVE-2023-32315.md](../2023/CVE-2023-32315-ThatNotEasy_CVE-2023-32315.md)

## CVE-2023-32315-Openfire-身份验证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 身份验证绕过/路径遍历

**影响应用:** Openfire

**危害等级:** 高危，可能导致未经授权的访问和潜在的远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8, 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务运行，目标端口开放，且Openfire版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 中的路径遍历漏洞。未经身份验证的攻击者可以通过向 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp` 发送特制的 HTTP 请求来绕过身份验证，访问受限的管理控制台页面。

**漏洞利用方式：**
1.  攻击者发送包含路径遍历序列（`%u002e%u002e/%u002e%u002e`）的恶意请求到 Openfire 服务器的 `/setup/setup-s/` 路径。
2.  路径遍历序列使得攻击者能够访问 `/user-groups.jsp` 等原本需要身份验证才能访问的管理页面。
3.  POC 代码首先尝试访问目标URL，如果成功获取JSESSIONID和CSRF token，则表明漏洞存在。代码会继续尝试利用该漏洞创建一个新的管理员用户。

**投毒风险评估：**
该 POC 代码主要包含以下功能：

*   发送包含路径遍历的 HTTP 请求。
*   提取服务器返回的 JSESSIONID 和 CSRF token。
*   构造并发送创建管理员用户的请求。

在提供的代码片段中，`generate_rando` 函数未完整定义，可能存在漏洞作者未公开的恶意行为。代码尝试从cookie中获取`JSESSIONID`和`csrf`,如果获取失败就无法继续利用。此外，该脚本依赖于 `HackRequests` 库，攻击者可能会篡改此库来植入恶意代码。虽然代码的主要目的是利用漏洞，但仍然存在一定的投毒风险，例如：

*   **潜在的后门创建：** 除了创建用户之外，攻击者可能添加额外的请求来执行其他恶意操作，例如部署 webshell 或修改系统配置。
*   **恶意库依赖：** `HackRequests` 库可能被替换为包含恶意代码的版本。
*   **信息收集：** 代码可能包含额外的逻辑来收集目标服务器的信息并发送给攻击者。

考虑到上述因素，该 POC 代码的投毒风险评估为 10%。需要人工审计整个代码才能完全确定是否存在恶意行为。

**项目地址:** [ThatNotEasy/CVE-2023-32315](https://github.com/ThatNotEasy/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #4

**来源**: [CVE-2023-32315-asepsaepdin_CVE-2023-32315.md](../2023/CVE-2023-32315-asepsaepdin_CVE-2023-32315.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可能导致未授权访问和控制Openfire服务器

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** 目标服务器运行存在漏洞版本的Openfire，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315是一个Openfire管理控制台的认证绕过漏洞。攻击者可以通过路径遍历攻击，利用未认证的Openfire安装环境，访问Openfire管理控制台的受限页面，从而创建新的管理员用户。该漏洞影响Openfire 3.10.0到4.6.7和4.7.0到4.7.4版本。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，以及搜索结果，该漏洞利用代码是有效的。搜索结果中提到该漏洞已经被野外利用，并且存在公开的PoC。

**投毒风险：**

提供的Python脚本`CVE-2023-32315.py`主要功能是利用CVE-2023-32315漏洞，通过构造恶意URL来绕过身份验证，在Openfire服务器上创建一个新的管理员用户。代码逻辑相对清晰，主要包括以下几个步骤：

1.  **获取CSRF Token:** 尝试从`/login.jsp`页面获取CSRF token，虽然这个token本身不是直接用于绕过认证，但是利用脚本在构造请求时会用到它。
2.  **构造恶意URL:** 使用路径遍历漏洞`setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`，直接访问用户创建页面，并设置用户名、密码以及管理员权限。
3.  **发送请求并验证结果:** 使用`requests`库发送GET请求，然后检查响应状态码，判断是否成功创建用户。

检查代码，没有发现明显的恶意行为，例如删除文件、传播恶意软件、或者进行其他未经授权的系统修改等。代码中使用的用户名和密码（hugme/HugmeNOW）也只是为了验证漏洞，并非后门。

代码中存在`subprocess.Popen`，理论上存在被注入命令的风险，但是代码中直接将构造好的命令赋值给`add_credentials_cmd`，其中`target_url`、`vuln_path`、`csrf_token` 等变量都经过了明确的赋值，没有用户可控的输入，因此被注入恶意命令的风险较低。

总体来说，该脚本本身被投毒的风险较低，大概为10%。风险主要来自于运行该脚本的环境是否安全，以及目标Openfire服务器的配置是否允许通过这种方式创建用户。

**利用方式：**

1.  **确定目标Openfire版本：** 确认目标Openfire服务器的版本在受影响的范围内（3.10.0 <= version < 4.6.8 或 4.7.0 <= version < 4.7.5）。
2.  **运行漏洞利用代码：** 运行提供的Python脚本，指定目标Openfire服务器的URL。
3.  **代码自动利用:**  脚本会自动尝试获取CSRF token，构造包含路径遍历的恶意URL，并发送请求创建新的管理员用户。
4.  **登录管理控制台：** 使用脚本中指定的用户名和密码（默认为hugme/HugmeNOW）登录Openfire的管理控制台。
5.  **控制服务器：** 成功登录后，攻击者可以执行任意管理操作，例如修改配置、安装插件、甚至执行系统命令。

**项目地址:** [asepsaepdin/CVE-2023-32315](https://github.com/asepsaepdin/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #5

**来源**: [CVE-2023-32315-gibran-abdillah_CVE-2023-32315.md](../2023/CVE-2023-32315-gibran-abdillah_CVE-2023-32315.md)

# CVE-2023-32315

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-32315-5rGJ5aCh5oCq5YW9_CVE-2023-32315exp.md](../2023/CVE-2023-32315-5rGJ5aCh5oCq5YW9_CVE-2023-32315exp.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 身份认证绕过 / 路径遍历

**影响应用:** Openfire

**危害等级:** 高危，允许未经授权访问管理控制台，可能导致敏感信息泄露和控制服务器

**影响版本:** 3.10.0 <= Openfire < 4.6.8, 4.7.0 <= Openfire < 4.7.5

**利用条件:** 目标系统运行受影响版本的Openfire，并且攻击者可以访问Openfire的Web管理界面(通常是9090端口)。需要目标服务器未完成初始化配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315 是一个 Openfire 的身份验证绕过漏洞，利用了路径遍历。攻击者可以利用此漏洞绕过身份验证，访问 Openfire 的管理控制台。\n\n**漏洞利用方式：**\n\n1.  **路径遍历：** 漏洞的根本原因是由于 Openfire 的安装设置页面存在路径遍历漏洞。攻击者可以构造特殊的 URL，例如`/setup/setup-s/%u002e%u002e/%u002e%u002e/log.jsp`，绕过身份验证检查，访问受限资源。其中`%u002e%u002e` 是 `..` 的 URL 编码，用于进行目录跳转。通过访问`log.jsp` 页面可以判断漏洞是否存在。\n2.  **创建管理员用户：** 利用路径遍历访问`user-create.jsp`页面，并结合一个有效的csrf token, 可以在无需认证的情况下创建新的管理员用户。 通过创建的管理员用户可以完全控制Openfire服务器。\n\n**POC 代码分析：**\n\n提供的 POC 代码 (Python) 演示了如何利用此漏洞。其步骤如下：\n\n1.  **获取 csrf token:** 访问`login.jsp`页面，从cookie中获取csrf token。\n2.  **构造 EXP URL：**  构造包含路径遍历的 URL，指向 `user-create.jsp` 页面，并附带创建管理员用户的必要参数，包括用户名、密码等。 URL 形式如: `{url}/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp?csrf={csrf_cookie}&username=admin4&name=admin4&email=admin4%40123.com&password=1234567&passwordConfirm=1234567&isadmin=on&create=%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7`。\n3.  **发送请求：** 使用 `HackRequests` 库发送构造的 URL 请求，创建新的管理员用户。\n\n**投毒风险分析：**\n\n对提供的代码进行了分析，并未发现任何明显的投毒代码。POC 代码的功能是利用漏洞创建管理员用户，所有操作均是为了验证漏洞的存在和利用，不存在植入后门或者恶意代码的行为。但是，请务必在非生产环境中使用此 POC，避免对实际系统造成损害。如果利用成功，攻击者可以通过新创建的管理员帐户完全控制 Openfire 服务器。

**项目地址:** [5rGJ5aCh5oCq5YW9/CVE-2023-32315exp](https://github.com/5rGJ5aCh5oCq5YW9/CVE-2023-32315exp)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #2

**来源**: [CVE-2023-32315-K3ysTr0K3R_CVE-2023-32315-EXPLOIT.md](../2023/CVE-2023-32315-K3ysTr0K3R_CVE-2023-32315-EXPLOIT.md)

## CVE-2023-32315-Openfire身份验证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致的身份验证绕过

**影响应用:** Openfire

**危害等级:** 高危，未经身份验证的攻击者可以创建管理员账户。

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** 目标系统运行受影响版本的Openfire，并且攻击者能够通过网络访问Openfire的Web管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 管理控制台身份验证绕过漏洞。由于存在路径遍历漏洞，未经身份验证的攻击者可以利用 Openfire 安装环境访问受限页面，从而在已配置的 Openfire 环境中创建管理员用户。漏洞利用方式如下：

1.  **漏洞原理：** 该漏洞利用了Openfire安装设置过程中的路径遍历缺陷，允许攻击者绕过身份验证，访问通常需要管理员权限才能访问的页面。
2.  **POC 代码分析：** 提供的Python脚本首先尝试从`/login.jsp`获取CSRF token。然后，它构造一个包含路径遍历的URL (`/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`)，以及要创建的管理员用户的用户名和密码。脚本使用`requests`库发送包含精心构造的URL的GET请求，并使用CSRF token绕过身份验证，从而创建新的管理员用户。
3.  **利用方式：**
    *   攻击者首先访问Openfire服务器的Web管理界面。
    *   攻击者使用包含路径遍历的恶意URL，绕过身份验证。
    *   攻击者通过构造的URL，创建一个新的管理员用户，从而获得对Openfire服务器的完全控制权。
4.  **投毒风险分析：** 该脚本的功能相对直接，主要用于利用漏洞创建管理员帐户。 脚本中使用了 `subprocess.Popen` 执行 curl 命令，如果目标服务器上 curl 被恶意修改，可能存在安全风险。此外，`mass_exploit` 函数从文件中读取目标 URL，如果该文件被篡改，可能导致脚本尝试攻击非预期目标。总体而言，投毒风险较低，约为10%， 主要集中在对外部命令的依赖以及批量攻击的目标文件。

**项目地址:** [K3ysTr0K3R/CVE-2023-32315-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2023-32315-EXPLOIT)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #3

**来源**: [CVE-2023-32315-ThatNotEasy_CVE-2023-32315.md](../2023/CVE-2023-32315-ThatNotEasy_CVE-2023-32315.md)

## CVE-2023-32315-Openfire-身份验证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 身份验证绕过/路径遍历

**影响应用:** Openfire

**危害等级:** 高危，可能导致未经授权的访问和潜在的远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8, 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务运行，目标端口开放，且Openfire版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 中的路径遍历漏洞。未经身份验证的攻击者可以通过向 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp` 发送特制的 HTTP 请求来绕过身份验证，访问受限的管理控制台页面。

**漏洞利用方式：**
1.  攻击者发送包含路径遍历序列（`%u002e%u002e/%u002e%u002e`）的恶意请求到 Openfire 服务器的 `/setup/setup-s/` 路径。
2.  路径遍历序列使得攻击者能够访问 `/user-groups.jsp` 等原本需要身份验证才能访问的管理页面。
3.  POC 代码首先尝试访问目标URL，如果成功获取JSESSIONID和CSRF token，则表明漏洞存在。代码会继续尝试利用该漏洞创建一个新的管理员用户。

**投毒风险评估：**
该 POC 代码主要包含以下功能：

*   发送包含路径遍历的 HTTP 请求。
*   提取服务器返回的 JSESSIONID 和 CSRF token。
*   构造并发送创建管理员用户的请求。

在提供的代码片段中，`generate_rando` 函数未完整定义，可能存在漏洞作者未公开的恶意行为。代码尝试从cookie中获取`JSESSIONID`和`csrf`,如果获取失败就无法继续利用。此外，该脚本依赖于 `HackRequests` 库，攻击者可能会篡改此库来植入恶意代码。虽然代码的主要目的是利用漏洞，但仍然存在一定的投毒风险，例如：

*   **潜在的后门创建：** 除了创建用户之外，攻击者可能添加额外的请求来执行其他恶意操作，例如部署 webshell 或修改系统配置。
*   **恶意库依赖：** `HackRequests` 库可能被替换为包含恶意代码的版本。
*   **信息收集：** 代码可能包含额外的逻辑来收集目标服务器的信息并发送给攻击者。

考虑到上述因素，该 POC 代码的投毒风险评估为 10%。需要人工审计整个代码才能完全确定是否存在恶意行为。

**项目地址:** [ThatNotEasy/CVE-2023-32315](https://github.com/ThatNotEasy/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #4

**来源**: [CVE-2023-32315-asepsaepdin_CVE-2023-32315.md](../2023/CVE-2023-32315-asepsaepdin_CVE-2023-32315.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可能导致未授权访问和控制Openfire服务器

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** 目标服务器运行存在漏洞版本的Openfire，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315是一个Openfire管理控制台的认证绕过漏洞。攻击者可以通过路径遍历攻击，利用未认证的Openfire安装环境，访问Openfire管理控制台的受限页面，从而创建新的管理员用户。该漏洞影响Openfire 3.10.0到4.6.7和4.7.0到4.7.4版本。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，以及搜索结果，该漏洞利用代码是有效的。搜索结果中提到该漏洞已经被野外利用，并且存在公开的PoC。

**投毒风险：**

提供的Python脚本`CVE-2023-32315.py`主要功能是利用CVE-2023-32315漏洞，通过构造恶意URL来绕过身份验证，在Openfire服务器上创建一个新的管理员用户。代码逻辑相对清晰，主要包括以下几个步骤：

1.  **获取CSRF Token:** 尝试从`/login.jsp`页面获取CSRF token，虽然这个token本身不是直接用于绕过认证，但是利用脚本在构造请求时会用到它。
2.  **构造恶意URL:** 使用路径遍历漏洞`setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`，直接访问用户创建页面，并设置用户名、密码以及管理员权限。
3.  **发送请求并验证结果:** 使用`requests`库发送GET请求，然后检查响应状态码，判断是否成功创建用户。

检查代码，没有发现明显的恶意行为，例如删除文件、传播恶意软件、或者进行其他未经授权的系统修改等。代码中使用的用户名和密码（hugme/HugmeNOW）也只是为了验证漏洞，并非后门。

代码中存在`subprocess.Popen`，理论上存在被注入命令的风险，但是代码中直接将构造好的命令赋值给`add_credentials_cmd`，其中`target_url`、`vuln_path`、`csrf_token` 等变量都经过了明确的赋值，没有用户可控的输入，因此被注入恶意命令的风险较低。

总体来说，该脚本本身被投毒的风险较低，大概为10%。风险主要来自于运行该脚本的环境是否安全，以及目标Openfire服务器的配置是否允许通过这种方式创建用户。

**利用方式：**

1.  **确定目标Openfire版本：** 确认目标Openfire服务器的版本在受影响的范围内（3.10.0 <= version < 4.6.8 或 4.7.0 <= version < 4.7.5）。
2.  **运行漏洞利用代码：** 运行提供的Python脚本，指定目标Openfire服务器的URL。
3.  **代码自动利用:**  脚本会自动尝试获取CSRF token，构造包含路径遍历的恶意URL，并发送请求创建新的管理员用户。
4.  **登录管理控制台：** 使用脚本中指定的用户名和密码（默认为hugme/HugmeNOW）登录Openfire的管理控制台。
5.  **控制服务器：** 成功登录后，攻击者可以执行任意管理操作，例如修改配置、安装插件、甚至执行系统命令。

**项目地址:** [asepsaepdin/CVE-2023-32315](https://github.com/asepsaepdin/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #5

**来源**: [CVE-2023-32315-gibran-abdillah_CVE-2023-32315.md](../2023/CVE-2023-32315-gibran-abdillah_CVE-2023-32315.md)

# CVE-2023-32315

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-32315-5rGJ5aCh5oCq5YW9_CVE-2023-32315exp.md](../2023/CVE-2023-32315-5rGJ5aCh5oCq5YW9_CVE-2023-32315exp.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 身份认证绕过 / 路径遍历

**影响应用:** Openfire

**危害等级:** 高危，允许未经授权访问管理控制台，可能导致敏感信息泄露和控制服务器

**影响版本:** 3.10.0 <= Openfire < 4.6.8, 4.7.0 <= Openfire < 4.7.5

**利用条件:** 目标系统运行受影响版本的Openfire，并且攻击者可以访问Openfire的Web管理界面(通常是9090端口)。需要目标服务器未完成初始化配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315 是一个 Openfire 的身份验证绕过漏洞，利用了路径遍历。攻击者可以利用此漏洞绕过身份验证，访问 Openfire 的管理控制台。\n\n**漏洞利用方式：**\n\n1.  **路径遍历：** 漏洞的根本原因是由于 Openfire 的安装设置页面存在路径遍历漏洞。攻击者可以构造特殊的 URL，例如`/setup/setup-s/%u002e%u002e/%u002e%u002e/log.jsp`，绕过身份验证检查，访问受限资源。其中`%u002e%u002e` 是 `..` 的 URL 编码，用于进行目录跳转。通过访问`log.jsp` 页面可以判断漏洞是否存在。\n2.  **创建管理员用户：** 利用路径遍历访问`user-create.jsp`页面，并结合一个有效的csrf token, 可以在无需认证的情况下创建新的管理员用户。 通过创建的管理员用户可以完全控制Openfire服务器。\n\n**POC 代码分析：**\n\n提供的 POC 代码 (Python) 演示了如何利用此漏洞。其步骤如下：\n\n1.  **获取 csrf token:** 访问`login.jsp`页面，从cookie中获取csrf token。\n2.  **构造 EXP URL：**  构造包含路径遍历的 URL，指向 `user-create.jsp` 页面，并附带创建管理员用户的必要参数，包括用户名、密码等。 URL 形式如: `{url}/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp?csrf={csrf_cookie}&username=admin4&name=admin4&email=admin4%40123.com&password=1234567&passwordConfirm=1234567&isadmin=on&create=%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7`。\n3.  **发送请求：** 使用 `HackRequests` 库发送构造的 URL 请求，创建新的管理员用户。\n\n**投毒风险分析：**\n\n对提供的代码进行了分析，并未发现任何明显的投毒代码。POC 代码的功能是利用漏洞创建管理员用户，所有操作均是为了验证漏洞的存在和利用，不存在植入后门或者恶意代码的行为。但是，请务必在非生产环境中使用此 POC，避免对实际系统造成损害。如果利用成功，攻击者可以通过新创建的管理员帐户完全控制 Openfire 服务器。

**项目地址:** [5rGJ5aCh5oCq5YW9/CVE-2023-32315exp](https://github.com/5rGJ5aCh5oCq5YW9/CVE-2023-32315exp)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #2

**来源**: [CVE-2023-32315-K3ysTr0K3R_CVE-2023-32315-EXPLOIT.md](../2023/CVE-2023-32315-K3ysTr0K3R_CVE-2023-32315-EXPLOIT.md)

## CVE-2023-32315-Openfire身份验证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致的身份验证绕过

**影响应用:** Openfire

**危害等级:** 高危，未经身份验证的攻击者可以创建管理员账户。

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** 目标系统运行受影响版本的Openfire，并且攻击者能够通过网络访问Openfire的Web管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 管理控制台身份验证绕过漏洞。由于存在路径遍历漏洞，未经身份验证的攻击者可以利用 Openfire 安装环境访问受限页面，从而在已配置的 Openfire 环境中创建管理员用户。漏洞利用方式如下：

1.  **漏洞原理：** 该漏洞利用了Openfire安装设置过程中的路径遍历缺陷，允许攻击者绕过身份验证，访问通常需要管理员权限才能访问的页面。
2.  **POC 代码分析：** 提供的Python脚本首先尝试从`/login.jsp`获取CSRF token。然后，它构造一个包含路径遍历的URL (`/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`)，以及要创建的管理员用户的用户名和密码。脚本使用`requests`库发送包含精心构造的URL的GET请求，并使用CSRF token绕过身份验证，从而创建新的管理员用户。
3.  **利用方式：**
    *   攻击者首先访问Openfire服务器的Web管理界面。
    *   攻击者使用包含路径遍历的恶意URL，绕过身份验证。
    *   攻击者通过构造的URL，创建一个新的管理员用户，从而获得对Openfire服务器的完全控制权。
4.  **投毒风险分析：** 该脚本的功能相对直接，主要用于利用漏洞创建管理员帐户。 脚本中使用了 `subprocess.Popen` 执行 curl 命令，如果目标服务器上 curl 被恶意修改，可能存在安全风险。此外，`mass_exploit` 函数从文件中读取目标 URL，如果该文件被篡改，可能导致脚本尝试攻击非预期目标。总体而言，投毒风险较低，约为10%， 主要集中在对外部命令的依赖以及批量攻击的目标文件。

**项目地址:** [K3ysTr0K3R/CVE-2023-32315-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2023-32315-EXPLOIT)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #3

**来源**: [CVE-2023-32315-ThatNotEasy_CVE-2023-32315.md](../2023/CVE-2023-32315-ThatNotEasy_CVE-2023-32315.md)

## CVE-2023-32315-Openfire-身份验证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 身份验证绕过/路径遍历

**影响应用:** Openfire

**危害等级:** 高危，可能导致未经授权的访问和潜在的远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8, 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务运行，目标端口开放，且Openfire版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 中的路径遍历漏洞。未经身份验证的攻击者可以通过向 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp` 发送特制的 HTTP 请求来绕过身份验证，访问受限的管理控制台页面。

**漏洞利用方式：**
1.  攻击者发送包含路径遍历序列（`%u002e%u002e/%u002e%u002e`）的恶意请求到 Openfire 服务器的 `/setup/setup-s/` 路径。
2.  路径遍历序列使得攻击者能够访问 `/user-groups.jsp` 等原本需要身份验证才能访问的管理页面。
3.  POC 代码首先尝试访问目标URL，如果成功获取JSESSIONID和CSRF token，则表明漏洞存在。代码会继续尝试利用该漏洞创建一个新的管理员用户。

**投毒风险评估：**
该 POC 代码主要包含以下功能：

*   发送包含路径遍历的 HTTP 请求。
*   提取服务器返回的 JSESSIONID 和 CSRF token。
*   构造并发送创建管理员用户的请求。

在提供的代码片段中，`generate_rando` 函数未完整定义，可能存在漏洞作者未公开的恶意行为。代码尝试从cookie中获取`JSESSIONID`和`csrf`,如果获取失败就无法继续利用。此外，该脚本依赖于 `HackRequests` 库，攻击者可能会篡改此库来植入恶意代码。虽然代码的主要目的是利用漏洞，但仍然存在一定的投毒风险，例如：

*   **潜在的后门创建：** 除了创建用户之外，攻击者可能添加额外的请求来执行其他恶意操作，例如部署 webshell 或修改系统配置。
*   **恶意库依赖：** `HackRequests` 库可能被替换为包含恶意代码的版本。
*   **信息收集：** 代码可能包含额外的逻辑来收集目标服务器的信息并发送给攻击者。

考虑到上述因素，该 POC 代码的投毒风险评估为 10%。需要人工审计整个代码才能完全确定是否存在恶意行为。

**项目地址:** [ThatNotEasy/CVE-2023-32315](https://github.com/ThatNotEasy/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #4

**来源**: [CVE-2023-32315-asepsaepdin_CVE-2023-32315.md](../2023/CVE-2023-32315-asepsaepdin_CVE-2023-32315.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可能导致未授权访问和控制Openfire服务器

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** 目标服务器运行存在漏洞版本的Openfire，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315是一个Openfire管理控制台的认证绕过漏洞。攻击者可以通过路径遍历攻击，利用未认证的Openfire安装环境，访问Openfire管理控制台的受限页面，从而创建新的管理员用户。该漏洞影响Openfire 3.10.0到4.6.7和4.7.0到4.7.4版本。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，以及搜索结果，该漏洞利用代码是有效的。搜索结果中提到该漏洞已经被野外利用，并且存在公开的PoC。

**投毒风险：**

提供的Python脚本`CVE-2023-32315.py`主要功能是利用CVE-2023-32315漏洞，通过构造恶意URL来绕过身份验证，在Openfire服务器上创建一个新的管理员用户。代码逻辑相对清晰，主要包括以下几个步骤：

1.  **获取CSRF Token:** 尝试从`/login.jsp`页面获取CSRF token，虽然这个token本身不是直接用于绕过认证，但是利用脚本在构造请求时会用到它。
2.  **构造恶意URL:** 使用路径遍历漏洞`setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`，直接访问用户创建页面，并设置用户名、密码以及管理员权限。
3.  **发送请求并验证结果:** 使用`requests`库发送GET请求，然后检查响应状态码，判断是否成功创建用户。

检查代码，没有发现明显的恶意行为，例如删除文件、传播恶意软件、或者进行其他未经授权的系统修改等。代码中使用的用户名和密码（hugme/HugmeNOW）也只是为了验证漏洞，并非后门。

代码中存在`subprocess.Popen`，理论上存在被注入命令的风险，但是代码中直接将构造好的命令赋值给`add_credentials_cmd`，其中`target_url`、`vuln_path`、`csrf_token` 等变量都经过了明确的赋值，没有用户可控的输入，因此被注入恶意命令的风险较低。

总体来说，该脚本本身被投毒的风险较低，大概为10%。风险主要来自于运行该脚本的环境是否安全，以及目标Openfire服务器的配置是否允许通过这种方式创建用户。

**利用方式：**

1.  **确定目标Openfire版本：** 确认目标Openfire服务器的版本在受影响的范围内（3.10.0 <= version < 4.6.8 或 4.7.0 <= version < 4.7.5）。
2.  **运行漏洞利用代码：** 运行提供的Python脚本，指定目标Openfire服务器的URL。
3.  **代码自动利用:**  脚本会自动尝试获取CSRF token，构造包含路径遍历的恶意URL，并发送请求创建新的管理员用户。
4.  **登录管理控制台：** 使用脚本中指定的用户名和密码（默认为hugme/HugmeNOW）登录Openfire的管理控制台。
5.  **控制服务器：** 成功登录后，攻击者可以执行任意管理操作，例如修改配置、安装插件、甚至执行系统命令。

**项目地址:** [asepsaepdin/CVE-2023-32315](https://github.com/asepsaepdin/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #5

**来源**: [CVE-2023-32315-gibran-abdillah_CVE-2023-32315.md](../2023/CVE-2023-32315-gibran-abdillah_CVE-2023-32315.md)

# CVE-2023-32315

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-32315-5rGJ5aCh5oCq5YW9_CVE-2023-32315exp.md](../2023/CVE-2023-32315-5rGJ5aCh5oCq5YW9_CVE-2023-32315exp.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 身份认证绕过 / 路径遍历

**影响应用:** Openfire

**危害等级:** 高危，允许未经授权访问管理控制台，可能导致敏感信息泄露和控制服务器

**影响版本:** 3.10.0 <= Openfire < 4.6.8, 4.7.0 <= Openfire < 4.7.5

**利用条件:** 目标系统运行受影响版本的Openfire，并且攻击者可以访问Openfire的Web管理界面(通常是9090端口)。需要目标服务器未完成初始化配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315 是一个 Openfire 的身份验证绕过漏洞，利用了路径遍历。攻击者可以利用此漏洞绕过身份验证，访问 Openfire 的管理控制台。\n\n**漏洞利用方式：**\n\n1.  **路径遍历：** 漏洞的根本原因是由于 Openfire 的安装设置页面存在路径遍历漏洞。攻击者可以构造特殊的 URL，例如`/setup/setup-s/%u002e%u002e/%u002e%u002e/log.jsp`，绕过身份验证检查，访问受限资源。其中`%u002e%u002e` 是 `..` 的 URL 编码，用于进行目录跳转。通过访问`log.jsp` 页面可以判断漏洞是否存在。\n2.  **创建管理员用户：** 利用路径遍历访问`user-create.jsp`页面，并结合一个有效的csrf token, 可以在无需认证的情况下创建新的管理员用户。 通过创建的管理员用户可以完全控制Openfire服务器。\n\n**POC 代码分析：**\n\n提供的 POC 代码 (Python) 演示了如何利用此漏洞。其步骤如下：\n\n1.  **获取 csrf token:** 访问`login.jsp`页面，从cookie中获取csrf token。\n2.  **构造 EXP URL：**  构造包含路径遍历的 URL，指向 `user-create.jsp` 页面，并附带创建管理员用户的必要参数，包括用户名、密码等。 URL 形式如: `{url}/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp?csrf={csrf_cookie}&username=admin4&name=admin4&email=admin4%40123.com&password=1234567&passwordConfirm=1234567&isadmin=on&create=%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7`。\n3.  **发送请求：** 使用 `HackRequests` 库发送构造的 URL 请求，创建新的管理员用户。\n\n**投毒风险分析：**\n\n对提供的代码进行了分析，并未发现任何明显的投毒代码。POC 代码的功能是利用漏洞创建管理员用户，所有操作均是为了验证漏洞的存在和利用，不存在植入后门或者恶意代码的行为。但是，请务必在非生产环境中使用此 POC，避免对实际系统造成损害。如果利用成功，攻击者可以通过新创建的管理员帐户完全控制 Openfire 服务器。

**项目地址:** [5rGJ5aCh5oCq5YW9/CVE-2023-32315exp](https://github.com/5rGJ5aCh5oCq5YW9/CVE-2023-32315exp)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #2

**来源**: [CVE-2023-32315-K3ysTr0K3R_CVE-2023-32315-EXPLOIT.md](../2023/CVE-2023-32315-K3ysTr0K3R_CVE-2023-32315-EXPLOIT.md)

## CVE-2023-32315-Openfire身份验证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致的身份验证绕过

**影响应用:** Openfire

**危害等级:** 高危，未经身份验证的攻击者可以创建管理员账户。

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** 目标系统运行受影响版本的Openfire，并且攻击者能够通过网络访问Openfire的Web管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 管理控制台身份验证绕过漏洞。由于存在路径遍历漏洞，未经身份验证的攻击者可以利用 Openfire 安装环境访问受限页面，从而在已配置的 Openfire 环境中创建管理员用户。漏洞利用方式如下：

1.  **漏洞原理：** 该漏洞利用了Openfire安装设置过程中的路径遍历缺陷，允许攻击者绕过身份验证，访问通常需要管理员权限才能访问的页面。
2.  **POC 代码分析：** 提供的Python脚本首先尝试从`/login.jsp`获取CSRF token。然后，它构造一个包含路径遍历的URL (`/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`)，以及要创建的管理员用户的用户名和密码。脚本使用`requests`库发送包含精心构造的URL的GET请求，并使用CSRF token绕过身份验证，从而创建新的管理员用户。
3.  **利用方式：**
    *   攻击者首先访问Openfire服务器的Web管理界面。
    *   攻击者使用包含路径遍历的恶意URL，绕过身份验证。
    *   攻击者通过构造的URL，创建一个新的管理员用户，从而获得对Openfire服务器的完全控制权。
4.  **投毒风险分析：** 该脚本的功能相对直接，主要用于利用漏洞创建管理员帐户。 脚本中使用了 `subprocess.Popen` 执行 curl 命令，如果目标服务器上 curl 被恶意修改，可能存在安全风险。此外，`mass_exploit` 函数从文件中读取目标 URL，如果该文件被篡改，可能导致脚本尝试攻击非预期目标。总体而言，投毒风险较低，约为10%， 主要集中在对外部命令的依赖以及批量攻击的目标文件。

**项目地址:** [K3ysTr0K3R/CVE-2023-32315-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2023-32315-EXPLOIT)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #3

**来源**: [CVE-2023-32315-ThatNotEasy_CVE-2023-32315.md](../2023/CVE-2023-32315-ThatNotEasy_CVE-2023-32315.md)

## CVE-2023-32315-Openfire-身份验证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 身份验证绕过/路径遍历

**影响应用:** Openfire

**危害等级:** 高危，可能导致未经授权的访问和潜在的远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8, 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务运行，目标端口开放，且Openfire版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 中的路径遍历漏洞。未经身份验证的攻击者可以通过向 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp` 发送特制的 HTTP 请求来绕过身份验证，访问受限的管理控制台页面。

**漏洞利用方式：**
1.  攻击者发送包含路径遍历序列（`%u002e%u002e/%u002e%u002e`）的恶意请求到 Openfire 服务器的 `/setup/setup-s/` 路径。
2.  路径遍历序列使得攻击者能够访问 `/user-groups.jsp` 等原本需要身份验证才能访问的管理页面。
3.  POC 代码首先尝试访问目标URL，如果成功获取JSESSIONID和CSRF token，则表明漏洞存在。代码会继续尝试利用该漏洞创建一个新的管理员用户。

**投毒风险评估：**
该 POC 代码主要包含以下功能：

*   发送包含路径遍历的 HTTP 请求。
*   提取服务器返回的 JSESSIONID 和 CSRF token。
*   构造并发送创建管理员用户的请求。

在提供的代码片段中，`generate_rando` 函数未完整定义，可能存在漏洞作者未公开的恶意行为。代码尝试从cookie中获取`JSESSIONID`和`csrf`,如果获取失败就无法继续利用。此外，该脚本依赖于 `HackRequests` 库，攻击者可能会篡改此库来植入恶意代码。虽然代码的主要目的是利用漏洞，但仍然存在一定的投毒风险，例如：

*   **潜在的后门创建：** 除了创建用户之外，攻击者可能添加额外的请求来执行其他恶意操作，例如部署 webshell 或修改系统配置。
*   **恶意库依赖：** `HackRequests` 库可能被替换为包含恶意代码的版本。
*   **信息收集：** 代码可能包含额外的逻辑来收集目标服务器的信息并发送给攻击者。

考虑到上述因素，该 POC 代码的投毒风险评估为 10%。需要人工审计整个代码才能完全确定是否存在恶意行为。

**项目地址:** [ThatNotEasy/CVE-2023-32315](https://github.com/ThatNotEasy/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #4

**来源**: [CVE-2023-32315-asepsaepdin_CVE-2023-32315.md](../2023/CVE-2023-32315-asepsaepdin_CVE-2023-32315.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可能导致未授权访问和控制Openfire服务器

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** 目标服务器运行存在漏洞版本的Openfire，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315是一个Openfire管理控制台的认证绕过漏洞。攻击者可以通过路径遍历攻击，利用未认证的Openfire安装环境，访问Openfire管理控制台的受限页面，从而创建新的管理员用户。该漏洞影响Openfire 3.10.0到4.6.7和4.7.0到4.7.4版本。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，以及搜索结果，该漏洞利用代码是有效的。搜索结果中提到该漏洞已经被野外利用，并且存在公开的PoC。

**投毒风险：**

提供的Python脚本`CVE-2023-32315.py`主要功能是利用CVE-2023-32315漏洞，通过构造恶意URL来绕过身份验证，在Openfire服务器上创建一个新的管理员用户。代码逻辑相对清晰，主要包括以下几个步骤：

1.  **获取CSRF Token:** 尝试从`/login.jsp`页面获取CSRF token，虽然这个token本身不是直接用于绕过认证，但是利用脚本在构造请求时会用到它。
2.  **构造恶意URL:** 使用路径遍历漏洞`setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`，直接访问用户创建页面，并设置用户名、密码以及管理员权限。
3.  **发送请求并验证结果:** 使用`requests`库发送GET请求，然后检查响应状态码，判断是否成功创建用户。

检查代码，没有发现明显的恶意行为，例如删除文件、传播恶意软件、或者进行其他未经授权的系统修改等。代码中使用的用户名和密码（hugme/HugmeNOW）也只是为了验证漏洞，并非后门。

代码中存在`subprocess.Popen`，理论上存在被注入命令的风险，但是代码中直接将构造好的命令赋值给`add_credentials_cmd`，其中`target_url`、`vuln_path`、`csrf_token` 等变量都经过了明确的赋值，没有用户可控的输入，因此被注入恶意命令的风险较低。

总体来说，该脚本本身被投毒的风险较低，大概为10%。风险主要来自于运行该脚本的环境是否安全，以及目标Openfire服务器的配置是否允许通过这种方式创建用户。

**利用方式：**

1.  **确定目标Openfire版本：** 确认目标Openfire服务器的版本在受影响的范围内（3.10.0 <= version < 4.6.8 或 4.7.0 <= version < 4.7.5）。
2.  **运行漏洞利用代码：** 运行提供的Python脚本，指定目标Openfire服务器的URL。
3.  **代码自动利用:**  脚本会自动尝试获取CSRF token，构造包含路径遍历的恶意URL，并发送请求创建新的管理员用户。
4.  **登录管理控制台：** 使用脚本中指定的用户名和密码（默认为hugme/HugmeNOW）登录Openfire的管理控制台。
5.  **控制服务器：** 成功登录后，攻击者可以执行任意管理操作，例如修改配置、安装插件、甚至执行系统命令。

**项目地址:** [asepsaepdin/CVE-2023-32315](https://github.com/asepsaepdin/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #5

**来源**: [CVE-2023-32315-gibran-abdillah_CVE-2023-32315.md](../2023/CVE-2023-32315-gibran-abdillah_CVE-2023-32315.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可能导致未授权访问管理控制台

**影响版本:** 3.10.0 <= version < 4.6.8; 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务已配置完成，但仍存在/setup路径可访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-32315 是 Openfire 中的一个路径遍历漏洞，攻击者可以通过该漏洞绕过身份验证，未经授权访问 Openfire 管理控制台。

**有效性分析：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用是有效的。漏洞利用代码通过访问 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp` 路径，创建一个新的管理员用户，从而绕过现有的身份验证机制。

**投毒风险分析：**
该POC代码的投毒风险较低。主要风险点在于：
1. `HackRequests` 库本身，该库是否安全可靠。需要进一步审计 `HackRequests` 库。
2. 创建的用户信息写入`results.txt`，该行为本身没有风险，但是可能导致信息泄露，如果攻击者利用此点监控`results.txt`，即可获取被攻击的站点和账号密码信息。
3. 代码中存在一些异常捕获，可能隐藏一些潜在的错误，但是不太可能是恶意代码。
综上所述，投毒风险较低，约为5%。

**利用方式：**
1.  **确定目标：** 确定目标 Openfire 服务器的 URL。
2.  **获取 CSRF Token 和 Session ID：** 访问 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp` 页面，获取 CSRF Token 和 Session ID。
3.  **创建管理员用户：** 使用获取的 CSRF Token 和 Session ID，构造一个包含用户名、密码等信息的请求，发送到 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp` 路径，创建一个新的管理员用户。
4.  **登录管理控制台：** 使用新创建的管理员用户登录 Openfire 管理控制台。

利用代码的关键部分：
*   `OpenfireExploit.createuser()`: 创建管理员用户。
*   `OpenfireExploit.getCsrf()`: 获取CSRF token。
*   `OpenfireExploit.login()`: 利用创建的账号密码登录后台。

**项目地址:** [gibran-abdillah/CVE-2023-32315](https://github.com/gibran-abdillah/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #6

**来源**: [CVE-2023-32315-izzz0_CVE-2023-32315-POC.md](../2023/CVE-2023-32315-izzz0_CVE-2023-32315-POC.md)

## CVE-2023-32315-Openfire-Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过

**影响应用:** Openfire

**危害等级:** 高危，允许未授权访问管理控制台，可能导致敏感信息泄露、配置更改甚至远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8 或 4.7.0 <= version < 4.7.5

**利用条件:** 目标Openfire实例处于漏洞影响版本范围，且setup未被禁用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 的路径遍历漏洞，允许未经身份验证的攻击者访问受限的管理页面。利用方式是访问 `/setup/setup-s/%u002e%u002e/%u002e%u002e/<受限页面>`。提供的POC代码尝试自动化这个过程，包括版本检测、获取JSESSIONID和CSRF令牌，并创建一个新的管理员用户。虽然代码本身看起来直接利用了该漏洞，但存在一些潜在的投毒风险：

*   **依赖性风险：** `requirements.txt` 文件中可能包含恶意依赖，虽然未在此次code中展示，但如果直接使用`pip install -r requirements.txt`仍存在潜在风险。
*   **远程资源风险：** README提到需要前往 `https://github.com/tangxiaofeng7/CVE-2023-32315-Openfire-Bypass/releases/tag/v0.1` 下载 webshell，这可能引入恶意代码。
*   **行为风险：** 该脚本本身执行创建用户的行为，如果滥用，可能对目标系统产生未授权的修改。

总的来说，POC代码的有效性较高，因为它直接利用了已知的路径遍历漏洞。投毒风险较低（约10%），主要集中在依赖和远程资源上，实际使用时，应该审核依赖文件，并尽量避免直接使用webshell。

**漏洞利用方式：**

1.  **版本检测：** 通过访问 `/login.jsp` 并解析HTML内容来确定Openfire的版本。
2.  **认证绕过：** 利用路径遍历漏洞，通过访问类似 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp` 的URL来绕过身份验证。
3.  **会话劫持：** 获取JSESSIONID和CSRF令牌（如果存在），用于后续的操作。
4.  **创建用户：** 构造包含用户名、密码和管理员权限的POST请求，发送到 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`，从而创建一个新的管理员用户。

**项目地址:** [izzz0/CVE-2023-32315-POC](https://github.com/izzz0/CVE-2023-32315-POC)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #7

**来源**: [CVE-2023-32315-miko550_CVE-2023-32315.md](../2023/CVE-2023-32315-miko550_CVE-2023-32315.md)

## CVE-2023-32315-Openfire-路径遍历导致认证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致认证绕过

**影响应用:** Openfire

**危害等级:** 高危，允许未授权访问管理控制台并创建管理员账户

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务器需要运行在存在漏洞的版本，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-32315 是一个存在于 Openfire 的路径遍历漏洞，它允许未经身份验证的攻击者通过 `setup` 目录访问受限的管理控制台页面，从而绕过身份验证。该漏洞的利用方式是利用`setup-s/%u002e%u002e/%u002e%u002e/` 路径，访问 `user-create.jsp` 页面，并创建一个新的管理员用户。提供的 Python 脚本通过构造包含恶意路径的 URL 来实现此攻击。该脚本首先尝试获取 JSESSIONID 和 csrf token，然后使用这些 token 创建一个新的管理员用户。脚本的`success.txt` 会记录成功创建管理员账户的URL,用户名和密码.投毒风险较低，因为该脚本的功能主要是利用漏洞，未发现恶意代码，但是创建管理员用户的行为本身具有一定的破坏性。

参考:
* [webpage 0]: NVD对该漏洞的描述
* [webpage 1]: Broadcom 对 Openfire Authentication Bypass Vulnerability的描述
* [webpage 2]: Rapid7 漏洞数据库描述
* [webpage 4]: Fortiguard 威胁信号报告，描述了该漏洞的影响
* [webpage 6]: VulnCheck blog 描述了该漏洞的利用方式
* [webpage 8]: Cybrary.it 描述了 Openfire (CVE-2023-32315) 的细节
* [webpage 9]: Acunetix 对 Openfire Path Traversal 的描述

漏洞利用有效性高，因为CVE库和搜索结果都确认了该漏洞的存在和可利用性。POC代码也提供了一个可行的利用方法。

由于CISA已将此漏洞添加到已知被利用漏洞目录，证明该漏洞已经在野外被利用。

**项目地址:** [miko550/CVE-2023-32315](https://github.com/miko550/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #8

**来源**: [CVE-2023-32315-ohnonoyesyes_CVE-2023-32315.md](../2023/CVE-2023-32315-ohnonoyesyes_CVE-2023-32315.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可未经授权访问管理控制台，甚至可能导致远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8; 4.7.0 <= version < 4.7.5

**利用条件:** Openfire实例已部署且允许未授权网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315是一个存在于Openfire管理控制台中的路径遍历漏洞。攻击者可以利用该漏洞绕过身份验证，未经授权访问管理控制台的受限页面。根据漏洞库信息，该漏洞影响自2015年4月以来发布的所有Openfire版本，即3.10.0到4.6.8以及4.7.0到4.7.5。提供的POC代码通过发送一个包含特殊构造的URL的GET请求 `/setup/setup-s/%002e%002e/Su002esu002e/log.jsp`尝试利用该漏洞。URL中的`%002e%002e`用于进行路径遍历攻击，尝试访问 `log.jsp` 文件。根据搜索结果和漏洞描述，该漏洞利用方式是有效的。虽然POC代码本身不包含明显的恶意代码, 但通常拿到控制台权限可以进行恶意插件的上传, 从而达到RCE的目的, 所以如果控制台权限被恶意利用，可能会被用来执行任意代码、窃取敏感信息或者进行其他恶意操作。 此仓库仅包含了漏洞验证的请求，未发现有其他恶意代码，因此投毒风险较低, 接近0%。

**项目地址:** [ohnonoyesyes/CVE-2023-32315](https://github.com/ohnonoyesyes/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #9

**来源**: [CVE-2023-32315-pulentoski_Explotaci-n-de-CVE-2023-32315-en-Openfire.md](../2023/CVE-2023-32315-pulentoski_Explotaci-n-de-CVE-2023-32315-en-Openfire.md)

## CVE-2023-32315-Openfire-认证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致的认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可能导致未授权访问和控制

**影响版本:** 3.10.0 <= version < 4.6.8, 4.7.0 <= version < 4.7.5

**利用条件:** 需要目标Openfire实例运行在受影响版本，且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315 是 Openfire 的一个认证绕过漏洞，攻击者可以通过构造包含路径遍历字符的 URL，未经身份验证即可访问 Openfire 管理控制台的敏感页面。该漏洞利用方式是利用`setup`目录下的文件，通过`../`进行目录穿越，访问到需要认证的页面。提供的POC代码首先尝试获取JSESSIONID和CSRF token，然后利用这些信息，通过构造恶意URL在目标系统上创建一个管理员用户。POC代码会添加一个随机用户名和密码的管理员账号。从代码分析来看，不存在明显的投毒行为，代码行为和漏洞描述相符，目的明确，即创建管理员账户，所以投毒风险极低。

根据CISA的已知被利用漏洞目录显示，该漏洞已被积极利用。

该漏洞影响Openfire 3.10.0 到 4.6.8 以及 4.7.0 到 4.7.5版本。

**项目地址:** [pulentoski/Explotaci-n-de-CVE-2023-32315-en-Openfire](https://github.com/pulentoski/Explotaci-n-de-CVE-2023-32315-en-Openfire)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #10

**来源**: [CVE-2023-32315-tangxiaofeng7_CVE-2023-32315-Openfire-Bypass.md](../2023/CVE-2023-32315-tangxiaofeng7_CVE-2023-32315-Openfire-Bypass.md)

## CVE-2023-32315-Openfire-认证绕过与RCE

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过/远程代码执行

**影响应用:** Openfire

**危害等级:** 高危，未经授权访问管理控制台并执行任意代码

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务需要运行，并且攻击者需要能够通过网络访问Openfire的管理端口（通常是9090）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞CVE-2023-32315是Openfire管理控制台中存在的路径遍历漏洞，允许未经身份验证的用户绕过身份验证，访问受限页面。利用方式主要分为以下几个步骤：

1.  **认证绕过：** 攻击者利用路径遍历漏洞，通过访问Openfire的Setup Environment绕过认证，访问管理控制台。
2.  **获取JSESSIONID和CSRFToken：** 访问设置页面获取JSESSIONID和CSRFToken, 用于后续创建用户的请求。
3.  **创建管理员用户：**  构造恶意请求，创建一个新的管理员用户。
4.  **插件上传：**  攻击者编译或下载恶意插件。该插件包含一个JSP页面，该页面允许执行任意命令。
5.  **远程代码执行：**  通过管理界面上传恶意插件，然后访问该JSP页面，实现远程代码执行。

**投毒风险分析：**

该POC主要由三部分构成：
*   `CVE-2023-32315-Openfire-Bypass/scan_all` 目录下的 go 代码，用于扫描和验证目标是否存在漏洞。
*   `pom.xml`、`src/` 目录下的代码用于编译恶意的 Openfire 插件，其中包含一个 Webshell，密码为123，功能是执行命令。
*   `README.md` 文件描述了漏洞利用的步骤。

其中 `scan_all` 目录下的 go 代码可能存在投毒风险，例如在扫描过程中执行恶意代码。`src/main/web/cmd.jsp` 是一个webshell，如果被植入恶意代码，也会造成安全风险。但是，从代码本身来看，大部分是漏洞利用代码，少部分代码有可能被用于投毒，因此判定投毒风险为10%。

**项目地址:** [tangxiaofeng7/CVE-2023-32315-Openfire-Bypass](https://github.com/tangxiaofeng7/CVE-2023-32315-Openfire-Bypass)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---



---

## POC #6

**来源**: [CVE-2023-32315-izzz0_CVE-2023-32315-POC.md](../2023/CVE-2023-32315-izzz0_CVE-2023-32315-POC.md)

## CVE-2023-32315-Openfire-Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过

**影响应用:** Openfire

**危害等级:** 高危，允许未授权访问管理控制台，可能导致敏感信息泄露、配置更改甚至远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8 或 4.7.0 <= version < 4.7.5

**利用条件:** 目标Openfire实例处于漏洞影响版本范围，且setup未被禁用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 的路径遍历漏洞，允许未经身份验证的攻击者访问受限的管理页面。利用方式是访问 `/setup/setup-s/%u002e%u002e/%u002e%u002e/<受限页面>`。提供的POC代码尝试自动化这个过程，包括版本检测、获取JSESSIONID和CSRF令牌，并创建一个新的管理员用户。虽然代码本身看起来直接利用了该漏洞，但存在一些潜在的投毒风险：

*   **依赖性风险：** `requirements.txt` 文件中可能包含恶意依赖，虽然未在此次code中展示，但如果直接使用`pip install -r requirements.txt`仍存在潜在风险。
*   **远程资源风险：** README提到需要前往 `https://github.com/tangxiaofeng7/CVE-2023-32315-Openfire-Bypass/releases/tag/v0.1` 下载 webshell，这可能引入恶意代码。
*   **行为风险：** 该脚本本身执行创建用户的行为，如果滥用，可能对目标系统产生未授权的修改。

总的来说，POC代码的有效性较高，因为它直接利用了已知的路径遍历漏洞。投毒风险较低（约10%），主要集中在依赖和远程资源上，实际使用时，应该审核依赖文件，并尽量避免直接使用webshell。

**漏洞利用方式：**

1.  **版本检测：** 通过访问 `/login.jsp` 并解析HTML内容来确定Openfire的版本。
2.  **认证绕过：** 利用路径遍历漏洞，通过访问类似 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp` 的URL来绕过身份验证。
3.  **会话劫持：** 获取JSESSIONID和CSRF令牌（如果存在），用于后续的操作。
4.  **创建用户：** 构造包含用户名、密码和管理员权限的POST请求，发送到 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`，从而创建一个新的管理员用户。

**项目地址:** [izzz0/CVE-2023-32315-POC](https://github.com/izzz0/CVE-2023-32315-POC)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #7

**来源**: [CVE-2023-32315-miko550_CVE-2023-32315.md](../2023/CVE-2023-32315-miko550_CVE-2023-32315.md)

## CVE-2023-32315-Openfire-路径遍历导致认证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致认证绕过

**影响应用:** Openfire

**危害等级:** 高危，允许未授权访问管理控制台并创建管理员账户

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务器需要运行在存在漏洞的版本，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-32315 是一个存在于 Openfire 的路径遍历漏洞，它允许未经身份验证的攻击者通过 `setup` 目录访问受限的管理控制台页面，从而绕过身份验证。该漏洞的利用方式是利用`setup-s/%u002e%u002e/%u002e%u002e/` 路径，访问 `user-create.jsp` 页面，并创建一个新的管理员用户。提供的 Python 脚本通过构造包含恶意路径的 URL 来实现此攻击。该脚本首先尝试获取 JSESSIONID 和 csrf token，然后使用这些 token 创建一个新的管理员用户。脚本的`success.txt` 会记录成功创建管理员账户的URL,用户名和密码.投毒风险较低，因为该脚本的功能主要是利用漏洞，未发现恶意代码，但是创建管理员用户的行为本身具有一定的破坏性。

参考:
* [webpage 0]: NVD对该漏洞的描述
* [webpage 1]: Broadcom 对 Openfire Authentication Bypass Vulnerability的描述
* [webpage 2]: Rapid7 漏洞数据库描述
* [webpage 4]: Fortiguard 威胁信号报告，描述了该漏洞的影响
* [webpage 6]: VulnCheck blog 描述了该漏洞的利用方式
* [webpage 8]: Cybrary.it 描述了 Openfire (CVE-2023-32315) 的细节
* [webpage 9]: Acunetix 对 Openfire Path Traversal 的描述

漏洞利用有效性高，因为CVE库和搜索结果都确认了该漏洞的存在和可利用性。POC代码也提供了一个可行的利用方法。

由于CISA已将此漏洞添加到已知被利用漏洞目录，证明该漏洞已经在野外被利用。

**项目地址:** [miko550/CVE-2023-32315](https://github.com/miko550/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #8

**来源**: [CVE-2023-32315-ohnonoyesyes_CVE-2023-32315.md](../2023/CVE-2023-32315-ohnonoyesyes_CVE-2023-32315.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可未经授权访问管理控制台，甚至可能导致远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8; 4.7.0 <= version < 4.7.5

**利用条件:** Openfire实例已部署且允许未授权网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315是一个存在于Openfire管理控制台中的路径遍历漏洞。攻击者可以利用该漏洞绕过身份验证，未经授权访问管理控制台的受限页面。根据漏洞库信息，该漏洞影响自2015年4月以来发布的所有Openfire版本，即3.10.0到4.6.8以及4.7.0到4.7.5。提供的POC代码通过发送一个包含特殊构造的URL的GET请求 `/setup/setup-s/%002e%002e/Su002esu002e/log.jsp`尝试利用该漏洞。URL中的`%002e%002e`用于进行路径遍历攻击，尝试访问 `log.jsp` 文件。根据搜索结果和漏洞描述，该漏洞利用方式是有效的。虽然POC代码本身不包含明显的恶意代码, 但通常拿到控制台权限可以进行恶意插件的上传, 从而达到RCE的目的, 所以如果控制台权限被恶意利用，可能会被用来执行任意代码、窃取敏感信息或者进行其他恶意操作。 此仓库仅包含了漏洞验证的请求，未发现有其他恶意代码，因此投毒风险较低, 接近0%。

**项目地址:** [ohnonoyesyes/CVE-2023-32315](https://github.com/ohnonoyesyes/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #9

**来源**: [CVE-2023-32315-pulentoski_Explotaci-n-de-CVE-2023-32315-en-Openfire.md](../2023/CVE-2023-32315-pulentoski_Explotaci-n-de-CVE-2023-32315-en-Openfire.md)

## CVE-2023-32315-Openfire-认证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致的认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可能导致未授权访问和控制

**影响版本:** 3.10.0 <= version < 4.6.8, 4.7.0 <= version < 4.7.5

**利用条件:** 需要目标Openfire实例运行在受影响版本，且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315 是 Openfire 的一个认证绕过漏洞，攻击者可以通过构造包含路径遍历字符的 URL，未经身份验证即可访问 Openfire 管理控制台的敏感页面。该漏洞利用方式是利用`setup`目录下的文件，通过`../`进行目录穿越，访问到需要认证的页面。提供的POC代码首先尝试获取JSESSIONID和CSRF token，然后利用这些信息，通过构造恶意URL在目标系统上创建一个管理员用户。POC代码会添加一个随机用户名和密码的管理员账号。从代码分析来看，不存在明显的投毒行为，代码行为和漏洞描述相符，目的明确，即创建管理员账户，所以投毒风险极低。

根据CISA的已知被利用漏洞目录显示，该漏洞已被积极利用。

该漏洞影响Openfire 3.10.0 到 4.6.8 以及 4.7.0 到 4.7.5版本。

**项目地址:** [pulentoski/Explotaci-n-de-CVE-2023-32315-en-Openfire](https://github.com/pulentoski/Explotaci-n-de-CVE-2023-32315-en-Openfire)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #10

**来源**: [CVE-2023-32315-tangxiaofeng7_CVE-2023-32315-Openfire-Bypass.md](../2023/CVE-2023-32315-tangxiaofeng7_CVE-2023-32315-Openfire-Bypass.md)

## CVE-2023-32315-Openfire-认证绕过与RCE

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过/远程代码执行

**影响应用:** Openfire

**危害等级:** 高危，未经授权访问管理控制台并执行任意代码

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务需要运行，并且攻击者需要能够通过网络访问Openfire的管理端口（通常是9090）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞CVE-2023-32315是Openfire管理控制台中存在的路径遍历漏洞，允许未经身份验证的用户绕过身份验证，访问受限页面。利用方式主要分为以下几个步骤：

1.  **认证绕过：** 攻击者利用路径遍历漏洞，通过访问Openfire的Setup Environment绕过认证，访问管理控制台。
2.  **获取JSESSIONID和CSRFToken：** 访问设置页面获取JSESSIONID和CSRFToken, 用于后续创建用户的请求。
3.  **创建管理员用户：**  构造恶意请求，创建一个新的管理员用户。
4.  **插件上传：**  攻击者编译或下载恶意插件。该插件包含一个JSP页面，该页面允许执行任意命令。
5.  **远程代码执行：**  通过管理界面上传恶意插件，然后访问该JSP页面，实现远程代码执行。

**投毒风险分析：**

该POC主要由三部分构成：
*   `CVE-2023-32315-Openfire-Bypass/scan_all` 目录下的 go 代码，用于扫描和验证目标是否存在漏洞。
*   `pom.xml`、`src/` 目录下的代码用于编译恶意的 Openfire 插件，其中包含一个 Webshell，密码为123，功能是执行命令。
*   `README.md` 文件描述了漏洞利用的步骤。

其中 `scan_all` 目录下的 go 代码可能存在投毒风险，例如在扫描过程中执行恶意代码。`src/main/web/cmd.jsp` 是一个webshell，如果被植入恶意代码，也会造成安全风险。但是，从代码本身来看，大部分是漏洞利用代码，少部分代码有可能被用于投毒，因此判定投毒风险为10%。

**项目地址:** [tangxiaofeng7/CVE-2023-32315-Openfire-Bypass](https://github.com/tangxiaofeng7/CVE-2023-32315-Openfire-Bypass)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---



---

## POC #6

**来源**: [CVE-2023-32315-izzz0_CVE-2023-32315-POC.md](../2023/CVE-2023-32315-izzz0_CVE-2023-32315-POC.md)

## CVE-2023-32315-Openfire-Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过

**影响应用:** Openfire

**危害等级:** 高危，允许未授权访问管理控制台，可能导致敏感信息泄露、配置更改甚至远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8 或 4.7.0 <= version < 4.7.5

**利用条件:** 目标Openfire实例处于漏洞影响版本范围，且setup未被禁用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 的路径遍历漏洞，允许未经身份验证的攻击者访问受限的管理页面。利用方式是访问 `/setup/setup-s/%u002e%u002e/%u002e%u002e/<受限页面>`。提供的POC代码尝试自动化这个过程，包括版本检测、获取JSESSIONID和CSRF令牌，并创建一个新的管理员用户。虽然代码本身看起来直接利用了该漏洞，但存在一些潜在的投毒风险：

*   **依赖性风险：** `requirements.txt` 文件中可能包含恶意依赖，虽然未在此次code中展示，但如果直接使用`pip install -r requirements.txt`仍存在潜在风险。
*   **远程资源风险：** README提到需要前往 `https://github.com/tangxiaofeng7/CVE-2023-32315-Openfire-Bypass/releases/tag/v0.1` 下载 webshell，这可能引入恶意代码。
*   **行为风险：** 该脚本本身执行创建用户的行为，如果滥用，可能对目标系统产生未授权的修改。

总的来说，POC代码的有效性较高，因为它直接利用了已知的路径遍历漏洞。投毒风险较低（约10%），主要集中在依赖和远程资源上，实际使用时，应该审核依赖文件，并尽量避免直接使用webshell。

**漏洞利用方式：**

1.  **版本检测：** 通过访问 `/login.jsp` 并解析HTML内容来确定Openfire的版本。
2.  **认证绕过：** 利用路径遍历漏洞，通过访问类似 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp` 的URL来绕过身份验证。
3.  **会话劫持：** 获取JSESSIONID和CSRF令牌（如果存在），用于后续的操作。
4.  **创建用户：** 构造包含用户名、密码和管理员权限的POST请求，发送到 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`，从而创建一个新的管理员用户。

**项目地址:** [izzz0/CVE-2023-32315-POC](https://github.com/izzz0/CVE-2023-32315-POC)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #7

**来源**: [CVE-2023-32315-miko550_CVE-2023-32315.md](../2023/CVE-2023-32315-miko550_CVE-2023-32315.md)

## CVE-2023-32315-Openfire-路径遍历导致认证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致认证绕过

**影响应用:** Openfire

**危害等级:** 高危，允许未授权访问管理控制台并创建管理员账户

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务器需要运行在存在漏洞的版本，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-32315 是一个存在于 Openfire 的路径遍历漏洞，它允许未经身份验证的攻击者通过 `setup` 目录访问受限的管理控制台页面，从而绕过身份验证。该漏洞的利用方式是利用`setup-s/%u002e%u002e/%u002e%u002e/` 路径，访问 `user-create.jsp` 页面，并创建一个新的管理员用户。提供的 Python 脚本通过构造包含恶意路径的 URL 来实现此攻击。该脚本首先尝试获取 JSESSIONID 和 csrf token，然后使用这些 token 创建一个新的管理员用户。脚本的`success.txt` 会记录成功创建管理员账户的URL,用户名和密码.投毒风险较低，因为该脚本的功能主要是利用漏洞，未发现恶意代码，但是创建管理员用户的行为本身具有一定的破坏性。

参考:
* [webpage 0]: NVD对该漏洞的描述
* [webpage 1]: Broadcom 对 Openfire Authentication Bypass Vulnerability的描述
* [webpage 2]: Rapid7 漏洞数据库描述
* [webpage 4]: Fortiguard 威胁信号报告，描述了该漏洞的影响
* [webpage 6]: VulnCheck blog 描述了该漏洞的利用方式
* [webpage 8]: Cybrary.it 描述了 Openfire (CVE-2023-32315) 的细节
* [webpage 9]: Acunetix 对 Openfire Path Traversal 的描述

漏洞利用有效性高，因为CVE库和搜索结果都确认了该漏洞的存在和可利用性。POC代码也提供了一个可行的利用方法。

由于CISA已将此漏洞添加到已知被利用漏洞目录，证明该漏洞已经在野外被利用。

**项目地址:** [miko550/CVE-2023-32315](https://github.com/miko550/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #8

**来源**: [CVE-2023-32315-ohnonoyesyes_CVE-2023-32315.md](../2023/CVE-2023-32315-ohnonoyesyes_CVE-2023-32315.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可未经授权访问管理控制台，甚至可能导致远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8; 4.7.0 <= version < 4.7.5

**利用条件:** Openfire实例已部署且允许未授权网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315是一个存在于Openfire管理控制台中的路径遍历漏洞。攻击者可以利用该漏洞绕过身份验证，未经授权访问管理控制台的受限页面。根据漏洞库信息，该漏洞影响自2015年4月以来发布的所有Openfire版本，即3.10.0到4.6.8以及4.7.0到4.7.5。提供的POC代码通过发送一个包含特殊构造的URL的GET请求 `/setup/setup-s/%002e%002e/Su002esu002e/log.jsp`尝试利用该漏洞。URL中的`%002e%002e`用于进行路径遍历攻击，尝试访问 `log.jsp` 文件。根据搜索结果和漏洞描述，该漏洞利用方式是有效的。虽然POC代码本身不包含明显的恶意代码, 但通常拿到控制台权限可以进行恶意插件的上传, 从而达到RCE的目的, 所以如果控制台权限被恶意利用，可能会被用来执行任意代码、窃取敏感信息或者进行其他恶意操作。 此仓库仅包含了漏洞验证的请求，未发现有其他恶意代码，因此投毒风险较低, 接近0%。

**项目地址:** [ohnonoyesyes/CVE-2023-32315](https://github.com/ohnonoyesyes/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #9

**来源**: [CVE-2023-32315-pulentoski_Explotaci-n-de-CVE-2023-32315-en-Openfire.md](../2023/CVE-2023-32315-pulentoski_Explotaci-n-de-CVE-2023-32315-en-Openfire.md)

## CVE-2023-32315-Openfire-认证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致的认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可能导致未授权访问和控制

**影响版本:** 3.10.0 <= version < 4.6.8, 4.7.0 <= version < 4.7.5

**利用条件:** 需要目标Openfire实例运行在受影响版本，且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315 是 Openfire 的一个认证绕过漏洞，攻击者可以通过构造包含路径遍历字符的 URL，未经身份验证即可访问 Openfire 管理控制台的敏感页面。该漏洞利用方式是利用`setup`目录下的文件，通过`../`进行目录穿越，访问到需要认证的页面。提供的POC代码首先尝试获取JSESSIONID和CSRF token，然后利用这些信息，通过构造恶意URL在目标系统上创建一个管理员用户。POC代码会添加一个随机用户名和密码的管理员账号。从代码分析来看，不存在明显的投毒行为，代码行为和漏洞描述相符，目的明确，即创建管理员账户，所以投毒风险极低。

根据CISA的已知被利用漏洞目录显示，该漏洞已被积极利用。

该漏洞影响Openfire 3.10.0 到 4.6.8 以及 4.7.0 到 4.7.5版本。

**项目地址:** [pulentoski/Explotaci-n-de-CVE-2023-32315-en-Openfire](https://github.com/pulentoski/Explotaci-n-de-CVE-2023-32315-en-Openfire)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #10

**来源**: [CVE-2023-32315-tangxiaofeng7_CVE-2023-32315-Openfire-Bypass.md](../2023/CVE-2023-32315-tangxiaofeng7_CVE-2023-32315-Openfire-Bypass.md)

## CVE-2023-32315-Openfire-认证绕过与RCE

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过/远程代码执行

**影响应用:** Openfire

**危害等级:** 高危，未经授权访问管理控制台并执行任意代码

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务需要运行，并且攻击者需要能够通过网络访问Openfire的管理端口（通常是9090）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞CVE-2023-32315是Openfire管理控制台中存在的路径遍历漏洞，允许未经身份验证的用户绕过身份验证，访问受限页面。利用方式主要分为以下几个步骤：

1.  **认证绕过：** 攻击者利用路径遍历漏洞，通过访问Openfire的Setup Environment绕过认证，访问管理控制台。
2.  **获取JSESSIONID和CSRFToken：** 访问设置页面获取JSESSIONID和CSRFToken, 用于后续创建用户的请求。
3.  **创建管理员用户：**  构造恶意请求，创建一个新的管理员用户。
4.  **插件上传：**  攻击者编译或下载恶意插件。该插件包含一个JSP页面，该页面允许执行任意命令。
5.  **远程代码执行：**  通过管理界面上传恶意插件，然后访问该JSP页面，实现远程代码执行。

**投毒风险分析：**

该POC主要由三部分构成：
*   `CVE-2023-32315-Openfire-Bypass/scan_all` 目录下的 go 代码，用于扫描和验证目标是否存在漏洞。
*   `pom.xml`、`src/` 目录下的代码用于编译恶意的 Openfire 插件，其中包含一个 Webshell，密码为123，功能是执行命令。
*   `README.md` 文件描述了漏洞利用的步骤。

其中 `scan_all` 目录下的 go 代码可能存在投毒风险，例如在扫描过程中执行恶意代码。`src/main/web/cmd.jsp` 是一个webshell，如果被植入恶意代码，也会造成安全风险。但是，从代码本身来看，大部分是漏洞利用代码，少部分代码有可能被用于投毒，因此判定投毒风险为10%。

**项目地址:** [tangxiaofeng7/CVE-2023-32315-Openfire-Bypass](https://github.com/tangxiaofeng7/CVE-2023-32315-Openfire-Bypass)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---



---

## POC #6

**来源**: [CVE-2023-32315-izzz0_CVE-2023-32315-POC.md](../2023/CVE-2023-32315-izzz0_CVE-2023-32315-POC.md)

## CVE-2023-32315-Openfire-Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过

**影响应用:** Openfire

**危害等级:** 高危，允许未授权访问管理控制台，可能导致敏感信息泄露、配置更改甚至远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8 或 4.7.0 <= version < 4.7.5

**利用条件:** 目标Openfire实例处于漏洞影响版本范围，且setup未被禁用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 的路径遍历漏洞，允许未经身份验证的攻击者访问受限的管理页面。利用方式是访问 `/setup/setup-s/%u002e%u002e/%u002e%u002e/<受限页面>`。提供的POC代码尝试自动化这个过程，包括版本检测、获取JSESSIONID和CSRF令牌，并创建一个新的管理员用户。虽然代码本身看起来直接利用了该漏洞，但存在一些潜在的投毒风险：

*   **依赖性风险：** `requirements.txt` 文件中可能包含恶意依赖，虽然未在此次code中展示，但如果直接使用`pip install -r requirements.txt`仍存在潜在风险。
*   **远程资源风险：** README提到需要前往 `https://github.com/tangxiaofeng7/CVE-2023-32315-Openfire-Bypass/releases/tag/v0.1` 下载 webshell，这可能引入恶意代码。
*   **行为风险：** 该脚本本身执行创建用户的行为，如果滥用，可能对目标系统产生未授权的修改。

总的来说，POC代码的有效性较高，因为它直接利用了已知的路径遍历漏洞。投毒风险较低（约10%），主要集中在依赖和远程资源上，实际使用时，应该审核依赖文件，并尽量避免直接使用webshell。

**漏洞利用方式：**

1.  **版本检测：** 通过访问 `/login.jsp` 并解析HTML内容来确定Openfire的版本。
2.  **认证绕过：** 利用路径遍历漏洞，通过访问类似 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp` 的URL来绕过身份验证。
3.  **会话劫持：** 获取JSESSIONID和CSRF令牌（如果存在），用于后续的操作。
4.  **创建用户：** 构造包含用户名、密码和管理员权限的POST请求，发送到 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`，从而创建一个新的管理员用户。

**项目地址:** [izzz0/CVE-2023-32315-POC](https://github.com/izzz0/CVE-2023-32315-POC)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #7

**来源**: [CVE-2023-32315-miko550_CVE-2023-32315.md](../2023/CVE-2023-32315-miko550_CVE-2023-32315.md)

## CVE-2023-32315-Openfire-路径遍历导致认证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致认证绕过

**影响应用:** Openfire

**危害等级:** 高危，允许未授权访问管理控制台并创建管理员账户

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务器需要运行在存在漏洞的版本，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-32315 是一个存在于 Openfire 的路径遍历漏洞，它允许未经身份验证的攻击者通过 `setup` 目录访问受限的管理控制台页面，从而绕过身份验证。该漏洞的利用方式是利用`setup-s/%u002e%u002e/%u002e%u002e/` 路径，访问 `user-create.jsp` 页面，并创建一个新的管理员用户。提供的 Python 脚本通过构造包含恶意路径的 URL 来实现此攻击。该脚本首先尝试获取 JSESSIONID 和 csrf token，然后使用这些 token 创建一个新的管理员用户。脚本的`success.txt` 会记录成功创建管理员账户的URL,用户名和密码.投毒风险较低，因为该脚本的功能主要是利用漏洞，未发现恶意代码，但是创建管理员用户的行为本身具有一定的破坏性。

参考:
* [webpage 0]: NVD对该漏洞的描述
* [webpage 1]: Broadcom 对 Openfire Authentication Bypass Vulnerability的描述
* [webpage 2]: Rapid7 漏洞数据库描述
* [webpage 4]: Fortiguard 威胁信号报告，描述了该漏洞的影响
* [webpage 6]: VulnCheck blog 描述了该漏洞的利用方式
* [webpage 8]: Cybrary.it 描述了 Openfire (CVE-2023-32315) 的细节
* [webpage 9]: Acunetix 对 Openfire Path Traversal 的描述

漏洞利用有效性高，因为CVE库和搜索结果都确认了该漏洞的存在和可利用性。POC代码也提供了一个可行的利用方法。

由于CISA已将此漏洞添加到已知被利用漏洞目录，证明该漏洞已经在野外被利用。

**项目地址:** [miko550/CVE-2023-32315](https://github.com/miko550/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #8

**来源**: [CVE-2023-32315-ohnonoyesyes_CVE-2023-32315.md](../2023/CVE-2023-32315-ohnonoyesyes_CVE-2023-32315.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可未经授权访问管理控制台，甚至可能导致远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8; 4.7.0 <= version < 4.7.5

**利用条件:** Openfire实例已部署且允许未授权网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315是一个存在于Openfire管理控制台中的路径遍历漏洞。攻击者可以利用该漏洞绕过身份验证，未经授权访问管理控制台的受限页面。根据漏洞库信息，该漏洞影响自2015年4月以来发布的所有Openfire版本，即3.10.0到4.6.8以及4.7.0到4.7.5。提供的POC代码通过发送一个包含特殊构造的URL的GET请求 `/setup/setup-s/%002e%002e/Su002esu002e/log.jsp`尝试利用该漏洞。URL中的`%002e%002e`用于进行路径遍历攻击，尝试访问 `log.jsp` 文件。根据搜索结果和漏洞描述，该漏洞利用方式是有效的。虽然POC代码本身不包含明显的恶意代码, 但通常拿到控制台权限可以进行恶意插件的上传, 从而达到RCE的目的, 所以如果控制台权限被恶意利用，可能会被用来执行任意代码、窃取敏感信息或者进行其他恶意操作。 此仓库仅包含了漏洞验证的请求，未发现有其他恶意代码，因此投毒风险较低, 接近0%。

**项目地址:** [ohnonoyesyes/CVE-2023-32315](https://github.com/ohnonoyesyes/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #9

**来源**: [CVE-2023-32315-pulentoski_Explotaci-n-de-CVE-2023-32315-en-Openfire.md](../2023/CVE-2023-32315-pulentoski_Explotaci-n-de-CVE-2023-32315-en-Openfire.md)

## CVE-2023-32315-Openfire-认证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致的认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可能导致未授权访问和控制

**影响版本:** 3.10.0 <= version < 4.6.8, 4.7.0 <= version < 4.7.5

**利用条件:** 需要目标Openfire实例运行在受影响版本，且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315 是 Openfire 的一个认证绕过漏洞，攻击者可以通过构造包含路径遍历字符的 URL，未经身份验证即可访问 Openfire 管理控制台的敏感页面。该漏洞利用方式是利用`setup`目录下的文件，通过`../`进行目录穿越，访问到需要认证的页面。提供的POC代码首先尝试获取JSESSIONID和CSRF token，然后利用这些信息，通过构造恶意URL在目标系统上创建一个管理员用户。POC代码会添加一个随机用户名和密码的管理员账号。从代码分析来看，不存在明显的投毒行为，代码行为和漏洞描述相符，目的明确，即创建管理员账户，所以投毒风险极低。

根据CISA的已知被利用漏洞目录显示，该漏洞已被积极利用。

该漏洞影响Openfire 3.10.0 到 4.6.8 以及 4.7.0 到 4.7.5版本。

**项目地址:** [pulentoski/Explotaci-n-de-CVE-2023-32315-en-Openfire](https://github.com/pulentoski/Explotaci-n-de-CVE-2023-32315-en-Openfire)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #10

**来源**: [CVE-2023-32315-tangxiaofeng7_CVE-2023-32315-Openfire-Bypass.md](../2023/CVE-2023-32315-tangxiaofeng7_CVE-2023-32315-Openfire-Bypass.md)

## CVE-2023-32315-Openfire-认证绕过与RCE

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过/远程代码执行

**影响应用:** Openfire

**危害等级:** 高危，未经授权访问管理控制台并执行任意代码

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务需要运行，并且攻击者需要能够通过网络访问Openfire的管理端口（通常是9090）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞CVE-2023-32315是Openfire管理控制台中存在的路径遍历漏洞，允许未经身份验证的用户绕过身份验证，访问受限页面。利用方式主要分为以下几个步骤：

1.  **认证绕过：** 攻击者利用路径遍历漏洞，通过访问Openfire的Setup Environment绕过认证，访问管理控制台。
2.  **获取JSESSIONID和CSRFToken：** 访问设置页面获取JSESSIONID和CSRFToken, 用于后续创建用户的请求。
3.  **创建管理员用户：**  构造恶意请求，创建一个新的管理员用户。
4.  **插件上传：**  攻击者编译或下载恶意插件。该插件包含一个JSP页面，该页面允许执行任意命令。
5.  **远程代码执行：**  通过管理界面上传恶意插件，然后访问该JSP页面，实现远程代码执行。

**投毒风险分析：**

该POC主要由三部分构成：
*   `CVE-2023-32315-Openfire-Bypass/scan_all` 目录下的 go 代码，用于扫描和验证目标是否存在漏洞。
*   `pom.xml`、`src/` 目录下的代码用于编译恶意的 Openfire 插件，其中包含一个 Webshell，密码为123，功能是执行命令。
*   `README.md` 文件描述了漏洞利用的步骤。

其中 `scan_all` 目录下的 go 代码可能存在投毒风险，例如在扫描过程中执行恶意代码。`src/main/web/cmd.jsp` 是一个webshell，如果被植入恶意代码，也会造成安全风险。但是，从代码本身来看，大部分是漏洞利用代码，少部分代码有可能被用于投毒，因此判定投毒风险为10%。

**项目地址:** [tangxiaofeng7/CVE-2023-32315-Openfire-Bypass](https://github.com/tangxiaofeng7/CVE-2023-32315-Openfire-Bypass)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---



---

## POC #6

**来源**: [CVE-2023-32315-izzz0_CVE-2023-32315-POC.md](../2023/CVE-2023-32315-izzz0_CVE-2023-32315-POC.md)

## CVE-2023-32315-Openfire-Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过

**影响应用:** Openfire

**危害等级:** 高危，允许未授权访问管理控制台，可能导致敏感信息泄露、配置更改甚至远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8 或 4.7.0 <= version < 4.7.5

**利用条件:** 目标Openfire实例处于漏洞影响版本范围，且setup未被禁用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 的路径遍历漏洞，允许未经身份验证的攻击者访问受限的管理页面。利用方式是访问 `/setup/setup-s/%u002e%u002e/%u002e%u002e/<受限页面>`。提供的POC代码尝试自动化这个过程，包括版本检测、获取JSESSIONID和CSRF令牌，并创建一个新的管理员用户。虽然代码本身看起来直接利用了该漏洞，但存在一些潜在的投毒风险：

*   **依赖性风险：** `requirements.txt` 文件中可能包含恶意依赖，虽然未在此次code中展示，但如果直接使用`pip install -r requirements.txt`仍存在潜在风险。
*   **远程资源风险：** README提到需要前往 `https://github.com/tangxiaofeng7/CVE-2023-32315-Openfire-Bypass/releases/tag/v0.1` 下载 webshell，这可能引入恶意代码。
*   **行为风险：** 该脚本本身执行创建用户的行为，如果滥用，可能对目标系统产生未授权的修改。

总的来说，POC代码的有效性较高，因为它直接利用了已知的路径遍历漏洞。投毒风险较低（约10%），主要集中在依赖和远程资源上，实际使用时，应该审核依赖文件，并尽量避免直接使用webshell。

**漏洞利用方式：**

1.  **版本检测：** 通过访问 `/login.jsp` 并解析HTML内容来确定Openfire的版本。
2.  **认证绕过：** 利用路径遍历漏洞，通过访问类似 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp` 的URL来绕过身份验证。
3.  **会话劫持：** 获取JSESSIONID和CSRF令牌（如果存在），用于后续的操作。
4.  **创建用户：** 构造包含用户名、密码和管理员权限的POST请求，发送到 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`，从而创建一个新的管理员用户。

**项目地址:** [izzz0/CVE-2023-32315-POC](https://github.com/izzz0/CVE-2023-32315-POC)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #7

**来源**: [CVE-2023-32315-miko550_CVE-2023-32315.md](../2023/CVE-2023-32315-miko550_CVE-2023-32315.md)

## CVE-2023-32315-Openfire-路径遍历导致认证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致认证绕过

**影响应用:** Openfire

**危害等级:** 高危，允许未授权访问管理控制台并创建管理员账户

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务器需要运行在存在漏洞的版本，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-32315 是一个存在于 Openfire 的路径遍历漏洞，它允许未经身份验证的攻击者通过 `setup` 目录访问受限的管理控制台页面，从而绕过身份验证。该漏洞的利用方式是利用`setup-s/%u002e%u002e/%u002e%u002e/` 路径，访问 `user-create.jsp` 页面，并创建一个新的管理员用户。提供的 Python 脚本通过构造包含恶意路径的 URL 来实现此攻击。该脚本首先尝试获取 JSESSIONID 和 csrf token，然后使用这些 token 创建一个新的管理员用户。脚本的`success.txt` 会记录成功创建管理员账户的URL,用户名和密码.投毒风险较低，因为该脚本的功能主要是利用漏洞，未发现恶意代码，但是创建管理员用户的行为本身具有一定的破坏性。

参考:
* [webpage 0]: NVD对该漏洞的描述
* [webpage 1]: Broadcom 对 Openfire Authentication Bypass Vulnerability的描述
* [webpage 2]: Rapid7 漏洞数据库描述
* [webpage 4]: Fortiguard 威胁信号报告，描述了该漏洞的影响
* [webpage 6]: VulnCheck blog 描述了该漏洞的利用方式
* [webpage 8]: Cybrary.it 描述了 Openfire (CVE-2023-32315) 的细节
* [webpage 9]: Acunetix 对 Openfire Path Traversal 的描述

漏洞利用有效性高，因为CVE库和搜索结果都确认了该漏洞的存在和可利用性。POC代码也提供了一个可行的利用方法。

由于CISA已将此漏洞添加到已知被利用漏洞目录，证明该漏洞已经在野外被利用。

**项目地址:** [miko550/CVE-2023-32315](https://github.com/miko550/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #8

**来源**: [CVE-2023-32315-ohnonoyesyes_CVE-2023-32315.md](../2023/CVE-2023-32315-ohnonoyesyes_CVE-2023-32315.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可未经授权访问管理控制台，甚至可能导致远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8; 4.7.0 <= version < 4.7.5

**利用条件:** Openfire实例已部署且允许未授权网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315是一个存在于Openfire管理控制台中的路径遍历漏洞。攻击者可以利用该漏洞绕过身份验证，未经授权访问管理控制台的受限页面。根据漏洞库信息，该漏洞影响自2015年4月以来发布的所有Openfire版本，即3.10.0到4.6.8以及4.7.0到4.7.5。提供的POC代码通过发送一个包含特殊构造的URL的GET请求 `/setup/setup-s/%002e%002e/Su002esu002e/log.jsp`尝试利用该漏洞。URL中的`%002e%002e`用于进行路径遍历攻击，尝试访问 `log.jsp` 文件。根据搜索结果和漏洞描述，该漏洞利用方式是有效的。虽然POC代码本身不包含明显的恶意代码, 但通常拿到控制台权限可以进行恶意插件的上传, 从而达到RCE的目的, 所以如果控制台权限被恶意利用，可能会被用来执行任意代码、窃取敏感信息或者进行其他恶意操作。 此仓库仅包含了漏洞验证的请求，未发现有其他恶意代码，因此投毒风险较低, 接近0%。

**项目地址:** [ohnonoyesyes/CVE-2023-32315](https://github.com/ohnonoyesyes/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #9

**来源**: [CVE-2023-32315-pulentoski_Explotaci-n-de-CVE-2023-32315-en-Openfire.md](../2023/CVE-2023-32315-pulentoski_Explotaci-n-de-CVE-2023-32315-en-Openfire.md)

## CVE-2023-32315-Openfire-认证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致的认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可能导致未授权访问和控制

**影响版本:** 3.10.0 <= version < 4.6.8, 4.7.0 <= version < 4.7.5

**利用条件:** 需要目标Openfire实例运行在受影响版本，且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315 是 Openfire 的一个认证绕过漏洞，攻击者可以通过构造包含路径遍历字符的 URL，未经身份验证即可访问 Openfire 管理控制台的敏感页面。该漏洞利用方式是利用`setup`目录下的文件，通过`../`进行目录穿越，访问到需要认证的页面。提供的POC代码首先尝试获取JSESSIONID和CSRF token，然后利用这些信息，通过构造恶意URL在目标系统上创建一个管理员用户。POC代码会添加一个随机用户名和密码的管理员账号。从代码分析来看，不存在明显的投毒行为，代码行为和漏洞描述相符，目的明确，即创建管理员账户，所以投毒风险极低。

根据CISA的已知被利用漏洞目录显示，该漏洞已被积极利用。

该漏洞影响Openfire 3.10.0 到 4.6.8 以及 4.7.0 到 4.7.5版本。

**项目地址:** [pulentoski/Explotaci-n-de-CVE-2023-32315-en-Openfire](https://github.com/pulentoski/Explotaci-n-de-CVE-2023-32315-en-Openfire)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #10

**来源**: [CVE-2023-32315-tangxiaofeng7_CVE-2023-32315-Openfire-Bypass.md](../2023/CVE-2023-32315-tangxiaofeng7_CVE-2023-32315-Openfire-Bypass.md)

## CVE-2023-32315-Openfire-认证绕过与RCE

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过/远程代码执行

**影响应用:** Openfire

**危害等级:** 高危，未经授权访问管理控制台并执行任意代码

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务需要运行，并且攻击者需要能够通过网络访问Openfire的管理端口（通常是9090）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞CVE-2023-32315是Openfire管理控制台中存在的路径遍历漏洞，允许未经身份验证的用户绕过身份验证，访问受限页面。利用方式主要分为以下几个步骤：

1.  **认证绕过：** 攻击者利用路径遍历漏洞，通过访问Openfire的Setup Environment绕过认证，访问管理控制台。
2.  **获取JSESSIONID和CSRFToken：** 访问设置页面获取JSESSIONID和CSRFToken, 用于后续创建用户的请求。
3.  **创建管理员用户：**  构造恶意请求，创建一个新的管理员用户。
4.  **插件上传：**  攻击者编译或下载恶意插件。该插件包含一个JSP页面，该页面允许执行任意命令。
5.  **远程代码执行：**  通过管理界面上传恶意插件，然后访问该JSP页面，实现远程代码执行。

**投毒风险分析：**

该POC主要由三部分构成：
*   `CVE-2023-32315-Openfire-Bypass/scan_all` 目录下的 go 代码，用于扫描和验证目标是否存在漏洞。
*   `pom.xml`、`src/` 目录下的代码用于编译恶意的 Openfire 插件，其中包含一个 Webshell，密码为123，功能是执行命令。
*   `README.md` 文件描述了漏洞利用的步骤。

其中 `scan_all` 目录下的 go 代码可能存在投毒风险，例如在扫描过程中执行恶意代码。`src/main/web/cmd.jsp` 是一个webshell，如果被植入恶意代码，也会造成安全风险。但是，从代码本身来看，大部分是漏洞利用代码，少部分代码有可能被用于投毒，因此判定投毒风险为10%。

**项目地址:** [tangxiaofeng7/CVE-2023-32315-Openfire-Bypass](https://github.com/tangxiaofeng7/CVE-2023-32315-Openfire-Bypass)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---



---

## POC #6

**来源**: [CVE-2023-32315-izzz0_CVE-2023-32315-POC.md](../2023/CVE-2023-32315-izzz0_CVE-2023-32315-POC.md)

## CVE-2023-32315-Openfire-Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过

**影响应用:** Openfire

**危害等级:** 高危，允许未授权访问管理控制台，可能导致敏感信息泄露、配置更改甚至远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8 或 4.7.0 <= version < 4.7.5

**利用条件:** 目标Openfire实例处于漏洞影响版本范围，且setup未被禁用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 的路径遍历漏洞，允许未经身份验证的攻击者访问受限的管理页面。利用方式是访问 `/setup/setup-s/%u002e%u002e/%u002e%u002e/<受限页面>`。提供的POC代码尝试自动化这个过程，包括版本检测、获取JSESSIONID和CSRF令牌，并创建一个新的管理员用户。虽然代码本身看起来直接利用了该漏洞，但存在一些潜在的投毒风险：

*   **依赖性风险：** `requirements.txt` 文件中可能包含恶意依赖，虽然未在此次code中展示，但如果直接使用`pip install -r requirements.txt`仍存在潜在风险。
*   **远程资源风险：** README提到需要前往 `https://github.com/tangxiaofeng7/CVE-2023-32315-Openfire-Bypass/releases/tag/v0.1` 下载 webshell，这可能引入恶意代码。
*   **行为风险：** 该脚本本身执行创建用户的行为，如果滥用，可能对目标系统产生未授权的修改。

总的来说，POC代码的有效性较高，因为它直接利用了已知的路径遍历漏洞。投毒风险较低（约10%），主要集中在依赖和远程资源上，实际使用时，应该审核依赖文件，并尽量避免直接使用webshell。

**漏洞利用方式：**

1.  **版本检测：** 通过访问 `/login.jsp` 并解析HTML内容来确定Openfire的版本。
2.  **认证绕过：** 利用路径遍历漏洞，通过访问类似 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp` 的URL来绕过身份验证。
3.  **会话劫持：** 获取JSESSIONID和CSRF令牌（如果存在），用于后续的操作。
4.  **创建用户：** 构造包含用户名、密码和管理员权限的POST请求，发送到 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`，从而创建一个新的管理员用户。

**项目地址:** [izzz0/CVE-2023-32315-POC](https://github.com/izzz0/CVE-2023-32315-POC)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #7

**来源**: [CVE-2023-32315-miko550_CVE-2023-32315.md](../2023/CVE-2023-32315-miko550_CVE-2023-32315.md)

## CVE-2023-32315-Openfire-路径遍历导致认证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致认证绕过

**影响应用:** Openfire

**危害等级:** 高危，允许未授权访问管理控制台并创建管理员账户

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务器需要运行在存在漏洞的版本，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-32315 是一个存在于 Openfire 的路径遍历漏洞，它允许未经身份验证的攻击者通过 `setup` 目录访问受限的管理控制台页面，从而绕过身份验证。该漏洞的利用方式是利用`setup-s/%u002e%u002e/%u002e%u002e/` 路径，访问 `user-create.jsp` 页面，并创建一个新的管理员用户。提供的 Python 脚本通过构造包含恶意路径的 URL 来实现此攻击。该脚本首先尝试获取 JSESSIONID 和 csrf token，然后使用这些 token 创建一个新的管理员用户。脚本的`success.txt` 会记录成功创建管理员账户的URL,用户名和密码.投毒风险较低，因为该脚本的功能主要是利用漏洞，未发现恶意代码，但是创建管理员用户的行为本身具有一定的破坏性。

参考:
* [webpage 0]: NVD对该漏洞的描述
* [webpage 1]: Broadcom 对 Openfire Authentication Bypass Vulnerability的描述
* [webpage 2]: Rapid7 漏洞数据库描述
* [webpage 4]: Fortiguard 威胁信号报告，描述了该漏洞的影响
* [webpage 6]: VulnCheck blog 描述了该漏洞的利用方式
* [webpage 8]: Cybrary.it 描述了 Openfire (CVE-2023-32315) 的细节
* [webpage 9]: Acunetix 对 Openfire Path Traversal 的描述

漏洞利用有效性高，因为CVE库和搜索结果都确认了该漏洞的存在和可利用性。POC代码也提供了一个可行的利用方法。

由于CISA已将此漏洞添加到已知被利用漏洞目录，证明该漏洞已经在野外被利用。

**项目地址:** [miko550/CVE-2023-32315](https://github.com/miko550/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #8

**来源**: [CVE-2023-32315-ohnonoyesyes_CVE-2023-32315.md](../2023/CVE-2023-32315-ohnonoyesyes_CVE-2023-32315.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可未经授权访问管理控制台，甚至可能导致远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8; 4.7.0 <= version < 4.7.5

**利用条件:** Openfire实例已部署且允许未授权网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315是一个存在于Openfire管理控制台中的路径遍历漏洞。攻击者可以利用该漏洞绕过身份验证，未经授权访问管理控制台的受限页面。根据漏洞库信息，该漏洞影响自2015年4月以来发布的所有Openfire版本，即3.10.0到4.6.8以及4.7.0到4.7.5。提供的POC代码通过发送一个包含特殊构造的URL的GET请求 `/setup/setup-s/%002e%002e/Su002esu002e/log.jsp`尝试利用该漏洞。URL中的`%002e%002e`用于进行路径遍历攻击，尝试访问 `log.jsp` 文件。根据搜索结果和漏洞描述，该漏洞利用方式是有效的。虽然POC代码本身不包含明显的恶意代码, 但通常拿到控制台权限可以进行恶意插件的上传, 从而达到RCE的目的, 所以如果控制台权限被恶意利用，可能会被用来执行任意代码、窃取敏感信息或者进行其他恶意操作。 此仓库仅包含了漏洞验证的请求，未发现有其他恶意代码，因此投毒风险较低, 接近0%。

**项目地址:** [ohnonoyesyes/CVE-2023-32315](https://github.com/ohnonoyesyes/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #9

**来源**: [CVE-2023-32315-pulentoski_Explotaci-n-de-CVE-2023-32315-en-Openfire.md](../2023/CVE-2023-32315-pulentoski_Explotaci-n-de-CVE-2023-32315-en-Openfire.md)

## CVE-2023-32315-Openfire-认证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致的认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可能导致未授权访问和控制

**影响版本:** 3.10.0 <= version < 4.6.8, 4.7.0 <= version < 4.7.5

**利用条件:** 需要目标Openfire实例运行在受影响版本，且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315 是 Openfire 的一个认证绕过漏洞，攻击者可以通过构造包含路径遍历字符的 URL，未经身份验证即可访问 Openfire 管理控制台的敏感页面。该漏洞利用方式是利用`setup`目录下的文件，通过`../`进行目录穿越，访问到需要认证的页面。提供的POC代码首先尝试获取JSESSIONID和CSRF token，然后利用这些信息，通过构造恶意URL在目标系统上创建一个管理员用户。POC代码会添加一个随机用户名和密码的管理员账号。从代码分析来看，不存在明显的投毒行为，代码行为和漏洞描述相符，目的明确，即创建管理员账户，所以投毒风险极低。

根据CISA的已知被利用漏洞目录显示，该漏洞已被积极利用。

该漏洞影响Openfire 3.10.0 到 4.6.8 以及 4.7.0 到 4.7.5版本。

**项目地址:** [pulentoski/Explotaci-n-de-CVE-2023-32315-en-Openfire](https://github.com/pulentoski/Explotaci-n-de-CVE-2023-32315-en-Openfire)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #10

**来源**: [CVE-2023-32315-tangxiaofeng7_CVE-2023-32315-Openfire-Bypass.md](../2023/CVE-2023-32315-tangxiaofeng7_CVE-2023-32315-Openfire-Bypass.md)

## CVE-2023-32315-Openfire-认证绕过与RCE

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过/远程代码执行

**影响应用:** Openfire

**危害等级:** 高危，未经授权访问管理控制台并执行任意代码

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务需要运行，并且攻击者需要能够通过网络访问Openfire的管理端口（通常是9090）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞CVE-2023-32315是Openfire管理控制台中存在的路径遍历漏洞，允许未经身份验证的用户绕过身份验证，访问受限页面。利用方式主要分为以下几个步骤：

1.  **认证绕过：** 攻击者利用路径遍历漏洞，通过访问Openfire的Setup Environment绕过认证，访问管理控制台。
2.  **获取JSESSIONID和CSRFToken：** 访问设置页面获取JSESSIONID和CSRFToken, 用于后续创建用户的请求。
3.  **创建管理员用户：**  构造恶意请求，创建一个新的管理员用户。
4.  **插件上传：**  攻击者编译或下载恶意插件。该插件包含一个JSP页面，该页面允许执行任意命令。
5.  **远程代码执行：**  通过管理界面上传恶意插件，然后访问该JSP页面，实现远程代码执行。

**投毒风险分析：**

该POC主要由三部分构成：
*   `CVE-2023-32315-Openfire-Bypass/scan_all` 目录下的 go 代码，用于扫描和验证目标是否存在漏洞。
*   `pom.xml`、`src/` 目录下的代码用于编译恶意的 Openfire 插件，其中包含一个 Webshell，密码为123，功能是执行命令。
*   `README.md` 文件描述了漏洞利用的步骤。

其中 `scan_all` 目录下的 go 代码可能存在投毒风险，例如在扫描过程中执行恶意代码。`src/main/web/cmd.jsp` 是一个webshell，如果被植入恶意代码，也会造成安全风险。但是，从代码本身来看，大部分是漏洞利用代码，少部分代码有可能被用于投毒，因此判定投毒风险为10%。

**项目地址:** [tangxiaofeng7/CVE-2023-32315-Openfire-Bypass](https://github.com/tangxiaofeng7/CVE-2023-32315-Openfire-Bypass)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---



---

## POC #6

**来源**: [CVE-2023-32315-izzz0_CVE-2023-32315-POC.md](../2023/CVE-2023-32315-izzz0_CVE-2023-32315-POC.md)

## CVE-2023-32315-Openfire-Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过

**影响应用:** Openfire

**危害等级:** 高危，允许未授权访问管理控制台，可能导致敏感信息泄露、配置更改甚至远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8 或 4.7.0 <= version < 4.7.5

**利用条件:** 目标Openfire实例处于漏洞影响版本范围，且setup未被禁用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 的路径遍历漏洞，允许未经身份验证的攻击者访问受限的管理页面。利用方式是访问 `/setup/setup-s/%u002e%u002e/%u002e%u002e/<受限页面>`。提供的POC代码尝试自动化这个过程，包括版本检测、获取JSESSIONID和CSRF令牌，并创建一个新的管理员用户。虽然代码本身看起来直接利用了该漏洞，但存在一些潜在的投毒风险：

*   **依赖性风险：** `requirements.txt` 文件中可能包含恶意依赖，虽然未在此次code中展示，但如果直接使用`pip install -r requirements.txt`仍存在潜在风险。
*   **远程资源风险：** README提到需要前往 `https://github.com/tangxiaofeng7/CVE-2023-32315-Openfire-Bypass/releases/tag/v0.1` 下载 webshell，这可能引入恶意代码。
*   **行为风险：** 该脚本本身执行创建用户的行为，如果滥用，可能对目标系统产生未授权的修改。

总的来说，POC代码的有效性较高，因为它直接利用了已知的路径遍历漏洞。投毒风险较低（约10%），主要集中在依赖和远程资源上，实际使用时，应该审核依赖文件，并尽量避免直接使用webshell。

**漏洞利用方式：**

1.  **版本检测：** 通过访问 `/login.jsp` 并解析HTML内容来确定Openfire的版本。
2.  **认证绕过：** 利用路径遍历漏洞，通过访问类似 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp` 的URL来绕过身份验证。
3.  **会话劫持：** 获取JSESSIONID和CSRF令牌（如果存在），用于后续的操作。
4.  **创建用户：** 构造包含用户名、密码和管理员权限的POST请求，发送到 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`，从而创建一个新的管理员用户。

**项目地址:** [izzz0/CVE-2023-32315-POC](https://github.com/izzz0/CVE-2023-32315-POC)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #7

**来源**: [CVE-2023-32315-miko550_CVE-2023-32315.md](../2023/CVE-2023-32315-miko550_CVE-2023-32315.md)

## CVE-2023-32315-Openfire-路径遍历导致认证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致认证绕过

**影响应用:** Openfire

**危害等级:** 高危，允许未授权访问管理控制台并创建管理员账户

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务器需要运行在存在漏洞的版本，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-32315 是一个存在于 Openfire 的路径遍历漏洞，它允许未经身份验证的攻击者通过 `setup` 目录访问受限的管理控制台页面，从而绕过身份验证。该漏洞的利用方式是利用`setup-s/%u002e%u002e/%u002e%u002e/` 路径，访问 `user-create.jsp` 页面，并创建一个新的管理员用户。提供的 Python 脚本通过构造包含恶意路径的 URL 来实现此攻击。该脚本首先尝试获取 JSESSIONID 和 csrf token，然后使用这些 token 创建一个新的管理员用户。脚本的`success.txt` 会记录成功创建管理员账户的URL,用户名和密码.投毒风险较低，因为该脚本的功能主要是利用漏洞，未发现恶意代码，但是创建管理员用户的行为本身具有一定的破坏性。

参考:
* [webpage 0]: NVD对该漏洞的描述
* [webpage 1]: Broadcom 对 Openfire Authentication Bypass Vulnerability的描述
* [webpage 2]: Rapid7 漏洞数据库描述
* [webpage 4]: Fortiguard 威胁信号报告，描述了该漏洞的影响
* [webpage 6]: VulnCheck blog 描述了该漏洞的利用方式
* [webpage 8]: Cybrary.it 描述了 Openfire (CVE-2023-32315) 的细节
* [webpage 9]: Acunetix 对 Openfire Path Traversal 的描述

漏洞利用有效性高，因为CVE库和搜索结果都确认了该漏洞的存在和可利用性。POC代码也提供了一个可行的利用方法。

由于CISA已将此漏洞添加到已知被利用漏洞目录，证明该漏洞已经在野外被利用。

**项目地址:** [miko550/CVE-2023-32315](https://github.com/miko550/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #8

**来源**: [CVE-2023-32315-ohnonoyesyes_CVE-2023-32315.md](../2023/CVE-2023-32315-ohnonoyesyes_CVE-2023-32315.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可未经授权访问管理控制台，甚至可能导致远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8; 4.7.0 <= version < 4.7.5

**利用条件:** Openfire实例已部署且允许未授权网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315是一个存在于Openfire管理控制台中的路径遍历漏洞。攻击者可以利用该漏洞绕过身份验证，未经授权访问管理控制台的受限页面。根据漏洞库信息，该漏洞影响自2015年4月以来发布的所有Openfire版本，即3.10.0到4.6.8以及4.7.0到4.7.5。提供的POC代码通过发送一个包含特殊构造的URL的GET请求 `/setup/setup-s/%002e%002e/Su002esu002e/log.jsp`尝试利用该漏洞。URL中的`%002e%002e`用于进行路径遍历攻击，尝试访问 `log.jsp` 文件。根据搜索结果和漏洞描述，该漏洞利用方式是有效的。虽然POC代码本身不包含明显的恶意代码, 但通常拿到控制台权限可以进行恶意插件的上传, 从而达到RCE的目的, 所以如果控制台权限被恶意利用，可能会被用来执行任意代码、窃取敏感信息或者进行其他恶意操作。 此仓库仅包含了漏洞验证的请求，未发现有其他恶意代码，因此投毒风险较低, 接近0%。

**项目地址:** [ohnonoyesyes/CVE-2023-32315](https://github.com/ohnonoyesyes/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #9

**来源**: [CVE-2023-32315-pulentoski_Explotaci-n-de-CVE-2023-32315-en-Openfire.md](../2023/CVE-2023-32315-pulentoski_Explotaci-n-de-CVE-2023-32315-en-Openfire.md)

## CVE-2023-32315-Openfire-认证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致的认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可能导致未授权访问和控制

**影响版本:** 3.10.0 <= version < 4.6.8, 4.7.0 <= version < 4.7.5

**利用条件:** 需要目标Openfire实例运行在受影响版本，且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315 是 Openfire 的一个认证绕过漏洞，攻击者可以通过构造包含路径遍历字符的 URL，未经身份验证即可访问 Openfire 管理控制台的敏感页面。该漏洞利用方式是利用`setup`目录下的文件，通过`../`进行目录穿越，访问到需要认证的页面。提供的POC代码首先尝试获取JSESSIONID和CSRF token，然后利用这些信息，通过构造恶意URL在目标系统上创建一个管理员用户。POC代码会添加一个随机用户名和密码的管理员账号。从代码分析来看，不存在明显的投毒行为，代码行为和漏洞描述相符，目的明确，即创建管理员账户，所以投毒风险极低。

根据CISA的已知被利用漏洞目录显示，该漏洞已被积极利用。

该漏洞影响Openfire 3.10.0 到 4.6.8 以及 4.7.0 到 4.7.5版本。

**项目地址:** [pulentoski/Explotaci-n-de-CVE-2023-32315-en-Openfire](https://github.com/pulentoski/Explotaci-n-de-CVE-2023-32315-en-Openfire)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #10

**来源**: [CVE-2023-32315-tangxiaofeng7_CVE-2023-32315-Openfire-Bypass.md](../2023/CVE-2023-32315-tangxiaofeng7_CVE-2023-32315-Openfire-Bypass.md)

## CVE-2023-32315-Openfire-认证绕过与RCE

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过/远程代码执行

**影响应用:** Openfire

**危害等级:** 高危，未经授权访问管理控制台并执行任意代码

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务需要运行，并且攻击者需要能够通过网络访问Openfire的管理端口（通常是9090）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞CVE-2023-32315是Openfire管理控制台中存在的路径遍历漏洞，允许未经身份验证的用户绕过身份验证，访问受限页面。利用方式主要分为以下几个步骤：

1.  **认证绕过：** 攻击者利用路径遍历漏洞，通过访问Openfire的Setup Environment绕过认证，访问管理控制台。
2.  **获取JSESSIONID和CSRFToken：** 访问设置页面获取JSESSIONID和CSRFToken, 用于后续创建用户的请求。
3.  **创建管理员用户：**  构造恶意请求，创建一个新的管理员用户。
4.  **插件上传：**  攻击者编译或下载恶意插件。该插件包含一个JSP页面，该页面允许执行任意命令。
5.  **远程代码执行：**  通过管理界面上传恶意插件，然后访问该JSP页面，实现远程代码执行。

**投毒风险分析：**

该POC主要由三部分构成：
*   `CVE-2023-32315-Openfire-Bypass/scan_all` 目录下的 go 代码，用于扫描和验证目标是否存在漏洞。
*   `pom.xml`、`src/` 目录下的代码用于编译恶意的 Openfire 插件，其中包含一个 Webshell，密码为123，功能是执行命令。
*   `README.md` 文件描述了漏洞利用的步骤。

其中 `scan_all` 目录下的 go 代码可能存在投毒风险，例如在扫描过程中执行恶意代码。`src/main/web/cmd.jsp` 是一个webshell，如果被植入恶意代码，也会造成安全风险。但是，从代码本身来看，大部分是漏洞利用代码，少部分代码有可能被用于投毒，因此判定投毒风险为10%。

**项目地址:** [tangxiaofeng7/CVE-2023-32315-Openfire-Bypass](https://github.com/tangxiaofeng7/CVE-2023-32315-Openfire-Bypass)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---



---

## POC #6

**来源**: [CVE-2023-32315-izzz0_CVE-2023-32315-POC.md](../2023/CVE-2023-32315-izzz0_CVE-2023-32315-POC.md)

## CVE-2023-32315-Openfire-Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过

**影响应用:** Openfire

**危害等级:** 高危，允许未授权访问管理控制台，可能导致敏感信息泄露、配置更改甚至远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8 或 4.7.0 <= version < 4.7.5

**利用条件:** 目标Openfire实例处于漏洞影响版本范围，且setup未被禁用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 的路径遍历漏洞，允许未经身份验证的攻击者访问受限的管理页面。利用方式是访问 `/setup/setup-s/%u002e%u002e/%u002e%u002e/<受限页面>`。提供的POC代码尝试自动化这个过程，包括版本检测、获取JSESSIONID和CSRF令牌，并创建一个新的管理员用户。虽然代码本身看起来直接利用了该漏洞，但存在一些潜在的投毒风险：

*   **依赖性风险：** `requirements.txt` 文件中可能包含恶意依赖，虽然未在此次code中展示，但如果直接使用`pip install -r requirements.txt`仍存在潜在风险。
*   **远程资源风险：** README提到需要前往 `https://github.com/tangxiaofeng7/CVE-2023-32315-Openfire-Bypass/releases/tag/v0.1` 下载 webshell，这可能引入恶意代码。
*   **行为风险：** 该脚本本身执行创建用户的行为，如果滥用，可能对目标系统产生未授权的修改。

总的来说，POC代码的有效性较高，因为它直接利用了已知的路径遍历漏洞。投毒风险较低（约10%），主要集中在依赖和远程资源上，实际使用时，应该审核依赖文件，并尽量避免直接使用webshell。

**漏洞利用方式：**

1.  **版本检测：** 通过访问 `/login.jsp` 并解析HTML内容来确定Openfire的版本。
2.  **认证绕过：** 利用路径遍历漏洞，通过访问类似 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp` 的URL来绕过身份验证。
3.  **会话劫持：** 获取JSESSIONID和CSRF令牌（如果存在），用于后续的操作。
4.  **创建用户：** 构造包含用户名、密码和管理员权限的POST请求，发送到 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`，从而创建一个新的管理员用户。

**项目地址:** [izzz0/CVE-2023-32315-POC](https://github.com/izzz0/CVE-2023-32315-POC)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #7

**来源**: [CVE-2023-32315-miko550_CVE-2023-32315.md](../2023/CVE-2023-32315-miko550_CVE-2023-32315.md)

## CVE-2023-32315-Openfire-路径遍历导致认证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致认证绕过

**影响应用:** Openfire

**危害等级:** 高危，允许未授权访问管理控制台并创建管理员账户

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务器需要运行在存在漏洞的版本，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-32315 是一个存在于 Openfire 的路径遍历漏洞，它允许未经身份验证的攻击者通过 `setup` 目录访问受限的管理控制台页面，从而绕过身份验证。该漏洞的利用方式是利用`setup-s/%u002e%u002e/%u002e%u002e/` 路径，访问 `user-create.jsp` 页面，并创建一个新的管理员用户。提供的 Python 脚本通过构造包含恶意路径的 URL 来实现此攻击。该脚本首先尝试获取 JSESSIONID 和 csrf token，然后使用这些 token 创建一个新的管理员用户。脚本的`success.txt` 会记录成功创建管理员账户的URL,用户名和密码.投毒风险较低，因为该脚本的功能主要是利用漏洞，未发现恶意代码，但是创建管理员用户的行为本身具有一定的破坏性。

参考:
* [webpage 0]: NVD对该漏洞的描述
* [webpage 1]: Broadcom 对 Openfire Authentication Bypass Vulnerability的描述
* [webpage 2]: Rapid7 漏洞数据库描述
* [webpage 4]: Fortiguard 威胁信号报告，描述了该漏洞的影响
* [webpage 6]: VulnCheck blog 描述了该漏洞的利用方式
* [webpage 8]: Cybrary.it 描述了 Openfire (CVE-2023-32315) 的细节
* [webpage 9]: Acunetix 对 Openfire Path Traversal 的描述

漏洞利用有效性高，因为CVE库和搜索结果都确认了该漏洞的存在和可利用性。POC代码也提供了一个可行的利用方法。

由于CISA已将此漏洞添加到已知被利用漏洞目录，证明该漏洞已经在野外被利用。

**项目地址:** [miko550/CVE-2023-32315](https://github.com/miko550/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #8

**来源**: [CVE-2023-32315-ohnonoyesyes_CVE-2023-32315.md](../2023/CVE-2023-32315-ohnonoyesyes_CVE-2023-32315.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可未经授权访问管理控制台，甚至可能导致远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8; 4.7.0 <= version < 4.7.5

**利用条件:** Openfire实例已部署且允许未授权网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315是一个存在于Openfire管理控制台中的路径遍历漏洞。攻击者可以利用该漏洞绕过身份验证，未经授权访问管理控制台的受限页面。根据漏洞库信息，该漏洞影响自2015年4月以来发布的所有Openfire版本，即3.10.0到4.6.8以及4.7.0到4.7.5。提供的POC代码通过发送一个包含特殊构造的URL的GET请求 `/setup/setup-s/%002e%002e/Su002esu002e/log.jsp`尝试利用该漏洞。URL中的`%002e%002e`用于进行路径遍历攻击，尝试访问 `log.jsp` 文件。根据搜索结果和漏洞描述，该漏洞利用方式是有效的。虽然POC代码本身不包含明显的恶意代码, 但通常拿到控制台权限可以进行恶意插件的上传, 从而达到RCE的目的, 所以如果控制台权限被恶意利用，可能会被用来执行任意代码、窃取敏感信息或者进行其他恶意操作。 此仓库仅包含了漏洞验证的请求，未发现有其他恶意代码，因此投毒风险较低, 接近0%。

**项目地址:** [ohnonoyesyes/CVE-2023-32315](https://github.com/ohnonoyesyes/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #9

**来源**: [CVE-2023-32315-pulentoski_Explotaci-n-de-CVE-2023-32315-en-Openfire.md](../2023/CVE-2023-32315-pulentoski_Explotaci-n-de-CVE-2023-32315-en-Openfire.md)

## CVE-2023-32315-Openfire-认证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致的认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可能导致未授权访问和控制

**影响版本:** 3.10.0 <= version < 4.6.8, 4.7.0 <= version < 4.7.5

**利用条件:** 需要目标Openfire实例运行在受影响版本，且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315 是 Openfire 的一个认证绕过漏洞，攻击者可以通过构造包含路径遍历字符的 URL，未经身份验证即可访问 Openfire 管理控制台的敏感页面。该漏洞利用方式是利用`setup`目录下的文件，通过`../`进行目录穿越，访问到需要认证的页面。提供的POC代码首先尝试获取JSESSIONID和CSRF token，然后利用这些信息，通过构造恶意URL在目标系统上创建一个管理员用户。POC代码会添加一个随机用户名和密码的管理员账号。从代码分析来看，不存在明显的投毒行为，代码行为和漏洞描述相符，目的明确，即创建管理员账户，所以投毒风险极低。

根据CISA的已知被利用漏洞目录显示，该漏洞已被积极利用。

该漏洞影响Openfire 3.10.0 到 4.6.8 以及 4.7.0 到 4.7.5版本。

**项目地址:** [pulentoski/Explotaci-n-de-CVE-2023-32315-en-Openfire](https://github.com/pulentoski/Explotaci-n-de-CVE-2023-32315-en-Openfire)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #10

**来源**: [CVE-2023-32315-tangxiaofeng7_CVE-2023-32315-Openfire-Bypass.md](../2023/CVE-2023-32315-tangxiaofeng7_CVE-2023-32315-Openfire-Bypass.md)

## CVE-2023-32315-Openfire-认证绕过与RCE

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过/远程代码执行

**影响应用:** Openfire

**危害等级:** 高危，未经授权访问管理控制台并执行任意代码

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务需要运行，并且攻击者需要能够通过网络访问Openfire的管理端口（通常是9090）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞CVE-2023-32315是Openfire管理控制台中存在的路径遍历漏洞，允许未经身份验证的用户绕过身份验证，访问受限页面。利用方式主要分为以下几个步骤：

1.  **认证绕过：** 攻击者利用路径遍历漏洞，通过访问Openfire的Setup Environment绕过认证，访问管理控制台。
2.  **获取JSESSIONID和CSRFToken：** 访问设置页面获取JSESSIONID和CSRFToken, 用于后续创建用户的请求。
3.  **创建管理员用户：**  构造恶意请求，创建一个新的管理员用户。
4.  **插件上传：**  攻击者编译或下载恶意插件。该插件包含一个JSP页面，该页面允许执行任意命令。
5.  **远程代码执行：**  通过管理界面上传恶意插件，然后访问该JSP页面，实现远程代码执行。

**投毒风险分析：**

该POC主要由三部分构成：
*   `CVE-2023-32315-Openfire-Bypass/scan_all` 目录下的 go 代码，用于扫描和验证目标是否存在漏洞。
*   `pom.xml`、`src/` 目录下的代码用于编译恶意的 Openfire 插件，其中包含一个 Webshell，密码为123，功能是执行命令。
*   `README.md` 文件描述了漏洞利用的步骤。

其中 `scan_all` 目录下的 go 代码可能存在投毒风险，例如在扫描过程中执行恶意代码。`src/main/web/cmd.jsp` 是一个webshell，如果被植入恶意代码，也会造成安全风险。但是，从代码本身来看，大部分是漏洞利用代码，少部分代码有可能被用于投毒，因此判定投毒风险为10%。

**项目地址:** [tangxiaofeng7/CVE-2023-32315-Openfire-Bypass](https://github.com/tangxiaofeng7/CVE-2023-32315-Openfire-Bypass)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---



---

## POC #6

**来源**: [CVE-2023-32315-izzz0_CVE-2023-32315-POC.md](../2023/CVE-2023-32315-izzz0_CVE-2023-32315-POC.md)

## CVE-2023-32315-Openfire-Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过

**影响应用:** Openfire

**危害等级:** 高危，允许未授权访问管理控制台，可能导致敏感信息泄露、配置更改甚至远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8 或 4.7.0 <= version < 4.7.5

**利用条件:** 目标Openfire实例处于漏洞影响版本范围，且setup未被禁用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 的路径遍历漏洞，允许未经身份验证的攻击者访问受限的管理页面。利用方式是访问 `/setup/setup-s/%u002e%u002e/%u002e%u002e/<受限页面>`。提供的POC代码尝试自动化这个过程，包括版本检测、获取JSESSIONID和CSRF令牌，并创建一个新的管理员用户。虽然代码本身看起来直接利用了该漏洞，但存在一些潜在的投毒风险：

*   **依赖性风险：** `requirements.txt` 文件中可能包含恶意依赖，虽然未在此次code中展示，但如果直接使用`pip install -r requirements.txt`仍存在潜在风险。
*   **远程资源风险：** README提到需要前往 `https://github.com/tangxiaofeng7/CVE-2023-32315-Openfire-Bypass/releases/tag/v0.1` 下载 webshell，这可能引入恶意代码。
*   **行为风险：** 该脚本本身执行创建用户的行为，如果滥用，可能对目标系统产生未授权的修改。

总的来说，POC代码的有效性较高，因为它直接利用了已知的路径遍历漏洞。投毒风险较低（约10%），主要集中在依赖和远程资源上，实际使用时，应该审核依赖文件，并尽量避免直接使用webshell。

**漏洞利用方式：**

1.  **版本检测：** 通过访问 `/login.jsp` 并解析HTML内容来确定Openfire的版本。
2.  **认证绕过：** 利用路径遍历漏洞，通过访问类似 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp` 的URL来绕过身份验证。
3.  **会话劫持：** 获取JSESSIONID和CSRF令牌（如果存在），用于后续的操作。
4.  **创建用户：** 构造包含用户名、密码和管理员权限的POST请求，发送到 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`，从而创建一个新的管理员用户。

**项目地址:** [izzz0/CVE-2023-32315-POC](https://github.com/izzz0/CVE-2023-32315-POC)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #7

**来源**: [CVE-2023-32315-miko550_CVE-2023-32315.md](../2023/CVE-2023-32315-miko550_CVE-2023-32315.md)

## CVE-2023-32315-Openfire-路径遍历导致认证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致认证绕过

**影响应用:** Openfire

**危害等级:** 高危，允许未授权访问管理控制台并创建管理员账户

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务器需要运行在存在漏洞的版本，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-32315 是一个存在于 Openfire 的路径遍历漏洞，它允许未经身份验证的攻击者通过 `setup` 目录访问受限的管理控制台页面，从而绕过身份验证。该漏洞的利用方式是利用`setup-s/%u002e%u002e/%u002e%u002e/` 路径，访问 `user-create.jsp` 页面，并创建一个新的管理员用户。提供的 Python 脚本通过构造包含恶意路径的 URL 来实现此攻击。该脚本首先尝试获取 JSESSIONID 和 csrf token，然后使用这些 token 创建一个新的管理员用户。脚本的`success.txt` 会记录成功创建管理员账户的URL,用户名和密码.投毒风险较低，因为该脚本的功能主要是利用漏洞，未发现恶意代码，但是创建管理员用户的行为本身具有一定的破坏性。

参考:
* [webpage 0]: NVD对该漏洞的描述
* [webpage 1]: Broadcom 对 Openfire Authentication Bypass Vulnerability的描述
* [webpage 2]: Rapid7 漏洞数据库描述
* [webpage 4]: Fortiguard 威胁信号报告，描述了该漏洞的影响
* [webpage 6]: VulnCheck blog 描述了该漏洞的利用方式
* [webpage 8]: Cybrary.it 描述了 Openfire (CVE-2023-32315) 的细节
* [webpage 9]: Acunetix 对 Openfire Path Traversal 的描述

漏洞利用有效性高，因为CVE库和搜索结果都确认了该漏洞的存在和可利用性。POC代码也提供了一个可行的利用方法。

由于CISA已将此漏洞添加到已知被利用漏洞目录，证明该漏洞已经在野外被利用。

**项目地址:** [miko550/CVE-2023-32315](https://github.com/miko550/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #8

**来源**: [CVE-2023-32315-ohnonoyesyes_CVE-2023-32315.md](../2023/CVE-2023-32315-ohnonoyesyes_CVE-2023-32315.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可未经授权访问管理控制台，甚至可能导致远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8; 4.7.0 <= version < 4.7.5

**利用条件:** Openfire实例已部署且允许未授权网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315是一个存在于Openfire管理控制台中的路径遍历漏洞。攻击者可以利用该漏洞绕过身份验证，未经授权访问管理控制台的受限页面。根据漏洞库信息，该漏洞影响自2015年4月以来发布的所有Openfire版本，即3.10.0到4.6.8以及4.7.0到4.7.5。提供的POC代码通过发送一个包含特殊构造的URL的GET请求 `/setup/setup-s/%002e%002e/Su002esu002e/log.jsp`尝试利用该漏洞。URL中的`%002e%002e`用于进行路径遍历攻击，尝试访问 `log.jsp` 文件。根据搜索结果和漏洞描述，该漏洞利用方式是有效的。虽然POC代码本身不包含明显的恶意代码, 但通常拿到控制台权限可以进行恶意插件的上传, 从而达到RCE的目的, 所以如果控制台权限被恶意利用，可能会被用来执行任意代码、窃取敏感信息或者进行其他恶意操作。 此仓库仅包含了漏洞验证的请求，未发现有其他恶意代码，因此投毒风险较低, 接近0%。

**项目地址:** [ohnonoyesyes/CVE-2023-32315](https://github.com/ohnonoyesyes/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #9

**来源**: [CVE-2023-32315-pulentoski_Explotaci-n-de-CVE-2023-32315-en-Openfire.md](../2023/CVE-2023-32315-pulentoski_Explotaci-n-de-CVE-2023-32315-en-Openfire.md)

## CVE-2023-32315-Openfire-认证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致的认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可能导致未授权访问和控制

**影响版本:** 3.10.0 <= version < 4.6.8, 4.7.0 <= version < 4.7.5

**利用条件:** 需要目标Openfire实例运行在受影响版本，且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315 是 Openfire 的一个认证绕过漏洞，攻击者可以通过构造包含路径遍历字符的 URL，未经身份验证即可访问 Openfire 管理控制台的敏感页面。该漏洞利用方式是利用`setup`目录下的文件，通过`../`进行目录穿越，访问到需要认证的页面。提供的POC代码首先尝试获取JSESSIONID和CSRF token，然后利用这些信息，通过构造恶意URL在目标系统上创建一个管理员用户。POC代码会添加一个随机用户名和密码的管理员账号。从代码分析来看，不存在明显的投毒行为，代码行为和漏洞描述相符，目的明确，即创建管理员账户，所以投毒风险极低。

根据CISA的已知被利用漏洞目录显示，该漏洞已被积极利用。

该漏洞影响Openfire 3.10.0 到 4.6.8 以及 4.7.0 到 4.7.5版本。

**项目地址:** [pulentoski/Explotaci-n-de-CVE-2023-32315-en-Openfire](https://github.com/pulentoski/Explotaci-n-de-CVE-2023-32315-en-Openfire)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #10

**来源**: [CVE-2023-32315-tangxiaofeng7_CVE-2023-32315-Openfire-Bypass.md](../2023/CVE-2023-32315-tangxiaofeng7_CVE-2023-32315-Openfire-Bypass.md)

## CVE-2023-32315-Openfire-认证绕过与RCE

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过/远程代码执行

**影响应用:** Openfire

**危害等级:** 高危，未经授权访问管理控制台并执行任意代码

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务需要运行，并且攻击者需要能够通过网络访问Openfire的管理端口（通常是9090）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞CVE-2023-32315是Openfire管理控制台中存在的路径遍历漏洞，允许未经身份验证的用户绕过身份验证，访问受限页面。利用方式主要分为以下几个步骤：

1.  **认证绕过：** 攻击者利用路径遍历漏洞，通过访问Openfire的Setup Environment绕过认证，访问管理控制台。
2.  **获取JSESSIONID和CSRFToken：** 访问设置页面获取JSESSIONID和CSRFToken, 用于后续创建用户的请求。
3.  **创建管理员用户：**  构造恶意请求，创建一个新的管理员用户。
4.  **插件上传：**  攻击者编译或下载恶意插件。该插件包含一个JSP页面，该页面允许执行任意命令。
5.  **远程代码执行：**  通过管理界面上传恶意插件，然后访问该JSP页面，实现远程代码执行。

**投毒风险分析：**

该POC主要由三部分构成：
*   `CVE-2023-32315-Openfire-Bypass/scan_all` 目录下的 go 代码，用于扫描和验证目标是否存在漏洞。
*   `pom.xml`、`src/` 目录下的代码用于编译恶意的 Openfire 插件，其中包含一个 Webshell，密码为123，功能是执行命令。
*   `README.md` 文件描述了漏洞利用的步骤。

其中 `scan_all` 目录下的 go 代码可能存在投毒风险，例如在扫描过程中执行恶意代码。`src/main/web/cmd.jsp` 是一个webshell，如果被植入恶意代码，也会造成安全风险。但是，从代码本身来看，大部分是漏洞利用代码，少部分代码有可能被用于投毒，因此判定投毒风险为10%。

**项目地址:** [tangxiaofeng7/CVE-2023-32315-Openfire-Bypass](https://github.com/tangxiaofeng7/CVE-2023-32315-Openfire-Bypass)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---



---

## POC #6

**来源**: [CVE-2023-32315-izzz0_CVE-2023-32315-POC.md](../2023/CVE-2023-32315-izzz0_CVE-2023-32315-POC.md)

## CVE-2023-32315-Openfire-Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过

**影响应用:** Openfire

**危害等级:** 高危，允许未授权访问管理控制台，可能导致敏感信息泄露、配置更改甚至远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8 或 4.7.0 <= version < 4.7.5

**利用条件:** 目标Openfire实例处于漏洞影响版本范围，且setup未被禁用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 的路径遍历漏洞，允许未经身份验证的攻击者访问受限的管理页面。利用方式是访问 `/setup/setup-s/%u002e%u002e/%u002e%u002e/<受限页面>`。提供的POC代码尝试自动化这个过程，包括版本检测、获取JSESSIONID和CSRF令牌，并创建一个新的管理员用户。虽然代码本身看起来直接利用了该漏洞，但存在一些潜在的投毒风险：

*   **依赖性风险：** `requirements.txt` 文件中可能包含恶意依赖，虽然未在此次code中展示，但如果直接使用`pip install -r requirements.txt`仍存在潜在风险。
*   **远程资源风险：** README提到需要前往 `https://github.com/tangxiaofeng7/CVE-2023-32315-Openfire-Bypass/releases/tag/v0.1` 下载 webshell，这可能引入恶意代码。
*   **行为风险：** 该脚本本身执行创建用户的行为，如果滥用，可能对目标系统产生未授权的修改。

总的来说，POC代码的有效性较高，因为它直接利用了已知的路径遍历漏洞。投毒风险较低（约10%），主要集中在依赖和远程资源上，实际使用时，应该审核依赖文件，并尽量避免直接使用webshell。

**漏洞利用方式：**

1.  **版本检测：** 通过访问 `/login.jsp` 并解析HTML内容来确定Openfire的版本。
2.  **认证绕过：** 利用路径遍历漏洞，通过访问类似 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp` 的URL来绕过身份验证。
3.  **会话劫持：** 获取JSESSIONID和CSRF令牌（如果存在），用于后续的操作。
4.  **创建用户：** 构造包含用户名、密码和管理员权限的POST请求，发送到 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`，从而创建一个新的管理员用户。

**项目地址:** [izzz0/CVE-2023-32315-POC](https://github.com/izzz0/CVE-2023-32315-POC)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #7

**来源**: [CVE-2023-32315-miko550_CVE-2023-32315.md](../2023/CVE-2023-32315-miko550_CVE-2023-32315.md)

## CVE-2023-32315-Openfire-路径遍历导致认证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致认证绕过

**影响应用:** Openfire

**危害等级:** 高危，允许未授权访问管理控制台并创建管理员账户

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务器需要运行在存在漏洞的版本，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-32315 是一个存在于 Openfire 的路径遍历漏洞，它允许未经身份验证的攻击者通过 `setup` 目录访问受限的管理控制台页面，从而绕过身份验证。该漏洞的利用方式是利用`setup-s/%u002e%u002e/%u002e%u002e/` 路径，访问 `user-create.jsp` 页面，并创建一个新的管理员用户。提供的 Python 脚本通过构造包含恶意路径的 URL 来实现此攻击。该脚本首先尝试获取 JSESSIONID 和 csrf token，然后使用这些 token 创建一个新的管理员用户。脚本的`success.txt` 会记录成功创建管理员账户的URL,用户名和密码.投毒风险较低，因为该脚本的功能主要是利用漏洞，未发现恶意代码，但是创建管理员用户的行为本身具有一定的破坏性。

参考:
* [webpage 0]: NVD对该漏洞的描述
* [webpage 1]: Broadcom 对 Openfire Authentication Bypass Vulnerability的描述
* [webpage 2]: Rapid7 漏洞数据库描述
* [webpage 4]: Fortiguard 威胁信号报告，描述了该漏洞的影响
* [webpage 6]: VulnCheck blog 描述了该漏洞的利用方式
* [webpage 8]: Cybrary.it 描述了 Openfire (CVE-2023-32315) 的细节
* [webpage 9]: Acunetix 对 Openfire Path Traversal 的描述

漏洞利用有效性高，因为CVE库和搜索结果都确认了该漏洞的存在和可利用性。POC代码也提供了一个可行的利用方法。

由于CISA已将此漏洞添加到已知被利用漏洞目录，证明该漏洞已经在野外被利用。

**项目地址:** [miko550/CVE-2023-32315](https://github.com/miko550/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #8

**来源**: [CVE-2023-32315-ohnonoyesyes_CVE-2023-32315.md](../2023/CVE-2023-32315-ohnonoyesyes_CVE-2023-32315.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可未经授权访问管理控制台，甚至可能导致远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8; 4.7.0 <= version < 4.7.5

**利用条件:** Openfire实例已部署且允许未授权网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315是一个存在于Openfire管理控制台中的路径遍历漏洞。攻击者可以利用该漏洞绕过身份验证，未经授权访问管理控制台的受限页面。根据漏洞库信息，该漏洞影响自2015年4月以来发布的所有Openfire版本，即3.10.0到4.6.8以及4.7.0到4.7.5。提供的POC代码通过发送一个包含特殊构造的URL的GET请求 `/setup/setup-s/%002e%002e/Su002esu002e/log.jsp`尝试利用该漏洞。URL中的`%002e%002e`用于进行路径遍历攻击，尝试访问 `log.jsp` 文件。根据搜索结果和漏洞描述，该漏洞利用方式是有效的。虽然POC代码本身不包含明显的恶意代码, 但通常拿到控制台权限可以进行恶意插件的上传, 从而达到RCE的目的, 所以如果控制台权限被恶意利用，可能会被用来执行任意代码、窃取敏感信息或者进行其他恶意操作。 此仓库仅包含了漏洞验证的请求，未发现有其他恶意代码，因此投毒风险较低, 接近0%。

**项目地址:** [ohnonoyesyes/CVE-2023-32315](https://github.com/ohnonoyesyes/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #9

**来源**: [CVE-2023-32315-pulentoski_Explotaci-n-de-CVE-2023-32315-en-Openfire.md](../2023/CVE-2023-32315-pulentoski_Explotaci-n-de-CVE-2023-32315-en-Openfire.md)

## CVE-2023-32315-Openfire-认证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致的认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可能导致未授权访问和控制

**影响版本:** 3.10.0 <= version < 4.6.8, 4.7.0 <= version < 4.7.5

**利用条件:** 需要目标Openfire实例运行在受影响版本，且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315 是 Openfire 的一个认证绕过漏洞，攻击者可以通过构造包含路径遍历字符的 URL，未经身份验证即可访问 Openfire 管理控制台的敏感页面。该漏洞利用方式是利用`setup`目录下的文件，通过`../`进行目录穿越，访问到需要认证的页面。提供的POC代码首先尝试获取JSESSIONID和CSRF token，然后利用这些信息，通过构造恶意URL在目标系统上创建一个管理员用户。POC代码会添加一个随机用户名和密码的管理员账号。从代码分析来看，不存在明显的投毒行为，代码行为和漏洞描述相符，目的明确，即创建管理员账户，所以投毒风险极低。

根据CISA的已知被利用漏洞目录显示，该漏洞已被积极利用。

该漏洞影响Openfire 3.10.0 到 4.6.8 以及 4.7.0 到 4.7.5版本。

**项目地址:** [pulentoski/Explotaci-n-de-CVE-2023-32315-en-Openfire](https://github.com/pulentoski/Explotaci-n-de-CVE-2023-32315-en-Openfire)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #10

**来源**: [CVE-2023-32315-tangxiaofeng7_CVE-2023-32315-Openfire-Bypass.md](../2023/CVE-2023-32315-tangxiaofeng7_CVE-2023-32315-Openfire-Bypass.md)

## CVE-2023-32315-Openfire-认证绕过与RCE

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过/远程代码执行

**影响应用:** Openfire

**危害等级:** 高危，未经授权访问管理控制台并执行任意代码

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务需要运行，并且攻击者需要能够通过网络访问Openfire的管理端口（通常是9090）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞CVE-2023-32315是Openfire管理控制台中存在的路径遍历漏洞，允许未经身份验证的用户绕过身份验证，访问受限页面。利用方式主要分为以下几个步骤：

1.  **认证绕过：** 攻击者利用路径遍历漏洞，通过访问Openfire的Setup Environment绕过认证，访问管理控制台。
2.  **获取JSESSIONID和CSRFToken：** 访问设置页面获取JSESSIONID和CSRFToken, 用于后续创建用户的请求。
3.  **创建管理员用户：**  构造恶意请求，创建一个新的管理员用户。
4.  **插件上传：**  攻击者编译或下载恶意插件。该插件包含一个JSP页面，该页面允许执行任意命令。
5.  **远程代码执行：**  通过管理界面上传恶意插件，然后访问该JSP页面，实现远程代码执行。

**投毒风险分析：**

该POC主要由三部分构成：
*   `CVE-2023-32315-Openfire-Bypass/scan_all` 目录下的 go 代码，用于扫描和验证目标是否存在漏洞。
*   `pom.xml`、`src/` 目录下的代码用于编译恶意的 Openfire 插件，其中包含一个 Webshell，密码为123，功能是执行命令。
*   `README.md` 文件描述了漏洞利用的步骤。

其中 `scan_all` 目录下的 go 代码可能存在投毒风险，例如在扫描过程中执行恶意代码。`src/main/web/cmd.jsp` 是一个webshell，如果被植入恶意代码，也会造成安全风险。但是，从代码本身来看，大部分是漏洞利用代码，少部分代码有可能被用于投毒，因此判定投毒风险为10%。

**项目地址:** [tangxiaofeng7/CVE-2023-32315-Openfire-Bypass](https://github.com/tangxiaofeng7/CVE-2023-32315-Openfire-Bypass)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---



---

## POC #6

**来源**: [CVE-2023-32315-izzz0_CVE-2023-32315-POC.md](../2023/CVE-2023-32315-izzz0_CVE-2023-32315-POC.md)

## CVE-2023-32315-Openfire-Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过

**影响应用:** Openfire

**危害等级:** 高危，允许未授权访问管理控制台，可能导致敏感信息泄露、配置更改甚至远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8 或 4.7.0 <= version < 4.7.5

**利用条件:** 目标Openfire实例处于漏洞影响版本范围，且setup未被禁用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 的路径遍历漏洞，允许未经身份验证的攻击者访问受限的管理页面。利用方式是访问 `/setup/setup-s/%u002e%u002e/%u002e%u002e/<受限页面>`。提供的POC代码尝试自动化这个过程，包括版本检测、获取JSESSIONID和CSRF令牌，并创建一个新的管理员用户。虽然代码本身看起来直接利用了该漏洞，但存在一些潜在的投毒风险：

*   **依赖性风险：** `requirements.txt` 文件中可能包含恶意依赖，虽然未在此次code中展示，但如果直接使用`pip install -r requirements.txt`仍存在潜在风险。
*   **远程资源风险：** README提到需要前往 `https://github.com/tangxiaofeng7/CVE-2023-32315-Openfire-Bypass/releases/tag/v0.1` 下载 webshell，这可能引入恶意代码。
*   **行为风险：** 该脚本本身执行创建用户的行为，如果滥用，可能对目标系统产生未授权的修改。

总的来说，POC代码的有效性较高，因为它直接利用了已知的路径遍历漏洞。投毒风险较低（约10%），主要集中在依赖和远程资源上，实际使用时，应该审核依赖文件，并尽量避免直接使用webshell。

**漏洞利用方式：**

1.  **版本检测：** 通过访问 `/login.jsp` 并解析HTML内容来确定Openfire的版本。
2.  **认证绕过：** 利用路径遍历漏洞，通过访问类似 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp` 的URL来绕过身份验证。
3.  **会话劫持：** 获取JSESSIONID和CSRF令牌（如果存在），用于后续的操作。
4.  **创建用户：** 构造包含用户名、密码和管理员权限的POST请求，发送到 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`，从而创建一个新的管理员用户。

**项目地址:** [izzz0/CVE-2023-32315-POC](https://github.com/izzz0/CVE-2023-32315-POC)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #7

**来源**: [CVE-2023-32315-miko550_CVE-2023-32315.md](../2023/CVE-2023-32315-miko550_CVE-2023-32315.md)

## CVE-2023-32315-Openfire-路径遍历导致认证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致认证绕过

**影响应用:** Openfire

**危害等级:** 高危，允许未授权访问管理控制台并创建管理员账户

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务器需要运行在存在漏洞的版本，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-32315 是一个存在于 Openfire 的路径遍历漏洞，它允许未经身份验证的攻击者通过 `setup` 目录访问受限的管理控制台页面，从而绕过身份验证。该漏洞的利用方式是利用`setup-s/%u002e%u002e/%u002e%u002e/` 路径，访问 `user-create.jsp` 页面，并创建一个新的管理员用户。提供的 Python 脚本通过构造包含恶意路径的 URL 来实现此攻击。该脚本首先尝试获取 JSESSIONID 和 csrf token，然后使用这些 token 创建一个新的管理员用户。脚本的`success.txt` 会记录成功创建管理员账户的URL,用户名和密码.投毒风险较低，因为该脚本的功能主要是利用漏洞，未发现恶意代码，但是创建管理员用户的行为本身具有一定的破坏性。

参考:
* [webpage 0]: NVD对该漏洞的描述
* [webpage 1]: Broadcom 对 Openfire Authentication Bypass Vulnerability的描述
* [webpage 2]: Rapid7 漏洞数据库描述
* [webpage 4]: Fortiguard 威胁信号报告，描述了该漏洞的影响
* [webpage 6]: VulnCheck blog 描述了该漏洞的利用方式
* [webpage 8]: Cybrary.it 描述了 Openfire (CVE-2023-32315) 的细节
* [webpage 9]: Acunetix 对 Openfire Path Traversal 的描述

漏洞利用有效性高，因为CVE库和搜索结果都确认了该漏洞的存在和可利用性。POC代码也提供了一个可行的利用方法。

由于CISA已将此漏洞添加到已知被利用漏洞目录，证明该漏洞已经在野外被利用。

**项目地址:** [miko550/CVE-2023-32315](https://github.com/miko550/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #8

**来源**: [CVE-2023-32315-ohnonoyesyes_CVE-2023-32315.md](../2023/CVE-2023-32315-ohnonoyesyes_CVE-2023-32315.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可未经授权访问管理控制台，甚至可能导致远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8; 4.7.0 <= version < 4.7.5

**利用条件:** Openfire实例已部署且允许未授权网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315是一个存在于Openfire管理控制台中的路径遍历漏洞。攻击者可以利用该漏洞绕过身份验证，未经授权访问管理控制台的受限页面。根据漏洞库信息，该漏洞影响自2015年4月以来发布的所有Openfire版本，即3.10.0到4.6.8以及4.7.0到4.7.5。提供的POC代码通过发送一个包含特殊构造的URL的GET请求 `/setup/setup-s/%002e%002e/Su002esu002e/log.jsp`尝试利用该漏洞。URL中的`%002e%002e`用于进行路径遍历攻击，尝试访问 `log.jsp` 文件。根据搜索结果和漏洞描述，该漏洞利用方式是有效的。虽然POC代码本身不包含明显的恶意代码, 但通常拿到控制台权限可以进行恶意插件的上传, 从而达到RCE的目的, 所以如果控制台权限被恶意利用，可能会被用来执行任意代码、窃取敏感信息或者进行其他恶意操作。 此仓库仅包含了漏洞验证的请求，未发现有其他恶意代码，因此投毒风险较低, 接近0%。

**项目地址:** [ohnonoyesyes/CVE-2023-32315](https://github.com/ohnonoyesyes/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #9

**来源**: [CVE-2023-32315-pulentoski_Explotaci-n-de-CVE-2023-32315-en-Openfire.md](../2023/CVE-2023-32315-pulentoski_Explotaci-n-de-CVE-2023-32315-en-Openfire.md)

## CVE-2023-32315-Openfire-认证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致的认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可能导致未授权访问和控制

**影响版本:** 3.10.0 <= version < 4.6.8, 4.7.0 <= version < 4.7.5

**利用条件:** 需要目标Openfire实例运行在受影响版本，且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315 是 Openfire 的一个认证绕过漏洞，攻击者可以通过构造包含路径遍历字符的 URL，未经身份验证即可访问 Openfire 管理控制台的敏感页面。该漏洞利用方式是利用`setup`目录下的文件，通过`../`进行目录穿越，访问到需要认证的页面。提供的POC代码首先尝试获取JSESSIONID和CSRF token，然后利用这些信息，通过构造恶意URL在目标系统上创建一个管理员用户。POC代码会添加一个随机用户名和密码的管理员账号。从代码分析来看，不存在明显的投毒行为，代码行为和漏洞描述相符，目的明确，即创建管理员账户，所以投毒风险极低。

根据CISA的已知被利用漏洞目录显示，该漏洞已被积极利用。

该漏洞影响Openfire 3.10.0 到 4.6.8 以及 4.7.0 到 4.7.5版本。

**项目地址:** [pulentoski/Explotaci-n-de-CVE-2023-32315-en-Openfire](https://github.com/pulentoski/Explotaci-n-de-CVE-2023-32315-en-Openfire)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #10

**来源**: [CVE-2023-32315-tangxiaofeng7_CVE-2023-32315-Openfire-Bypass.md](../2023/CVE-2023-32315-tangxiaofeng7_CVE-2023-32315-Openfire-Bypass.md)

## CVE-2023-32315-Openfire-认证绕过与RCE

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过/远程代码执行

**影响应用:** Openfire

**危害等级:** 高危，未经授权访问管理控制台并执行任意代码

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务需要运行，并且攻击者需要能够通过网络访问Openfire的管理端口（通常是9090）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞CVE-2023-32315是Openfire管理控制台中存在的路径遍历漏洞，允许未经身份验证的用户绕过身份验证，访问受限页面。利用方式主要分为以下几个步骤：

1.  **认证绕过：** 攻击者利用路径遍历漏洞，通过访问Openfire的Setup Environment绕过认证，访问管理控制台。
2.  **获取JSESSIONID和CSRFToken：** 访问设置页面获取JSESSIONID和CSRFToken, 用于后续创建用户的请求。
3.  **创建管理员用户：**  构造恶意请求，创建一个新的管理员用户。
4.  **插件上传：**  攻击者编译或下载恶意插件。该插件包含一个JSP页面，该页面允许执行任意命令。
5.  **远程代码执行：**  通过管理界面上传恶意插件，然后访问该JSP页面，实现远程代码执行。

**投毒风险分析：**

该POC主要由三部分构成：
*   `CVE-2023-32315-Openfire-Bypass/scan_all` 目录下的 go 代码，用于扫描和验证目标是否存在漏洞。
*   `pom.xml`、`src/` 目录下的代码用于编译恶意的 Openfire 插件，其中包含一个 Webshell，密码为123，功能是执行命令。
*   `README.md` 文件描述了漏洞利用的步骤。

其中 `scan_all` 目录下的 go 代码可能存在投毒风险，例如在扫描过程中执行恶意代码。`src/main/web/cmd.jsp` 是一个webshell，如果被植入恶意代码，也会造成安全风险。但是，从代码本身来看，大部分是漏洞利用代码，少部分代码有可能被用于投毒，因此判定投毒风险为10%。

**项目地址:** [tangxiaofeng7/CVE-2023-32315-Openfire-Bypass](https://github.com/tangxiaofeng7/CVE-2023-32315-Openfire-Bypass)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---



---

## POC #6

**来源**: [CVE-2023-32315-izzz0_CVE-2023-32315-POC.md](../2023/CVE-2023-32315-izzz0_CVE-2023-32315-POC.md)

## CVE-2023-32315-Openfire-Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过

**影响应用:** Openfire

**危害等级:** 高危，允许未授权访问管理控制台，可能导致敏感信息泄露、配置更改甚至远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8 或 4.7.0 <= version < 4.7.5

**利用条件:** 目标Openfire实例处于漏洞影响版本范围，且setup未被禁用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 的路径遍历漏洞，允许未经身份验证的攻击者访问受限的管理页面。利用方式是访问 `/setup/setup-s/%u002e%u002e/%u002e%u002e/<受限页面>`。提供的POC代码尝试自动化这个过程，包括版本检测、获取JSESSIONID和CSRF令牌，并创建一个新的管理员用户。虽然代码本身看起来直接利用了该漏洞，但存在一些潜在的投毒风险：

*   **依赖性风险：** `requirements.txt` 文件中可能包含恶意依赖，虽然未在此次code中展示，但如果直接使用`pip install -r requirements.txt`仍存在潜在风险。
*   **远程资源风险：** README提到需要前往 `https://github.com/tangxiaofeng7/CVE-2023-32315-Openfire-Bypass/releases/tag/v0.1` 下载 webshell，这可能引入恶意代码。
*   **行为风险：** 该脚本本身执行创建用户的行为，如果滥用，可能对目标系统产生未授权的修改。

总的来说，POC代码的有效性较高，因为它直接利用了已知的路径遍历漏洞。投毒风险较低（约10%），主要集中在依赖和远程资源上，实际使用时，应该审核依赖文件，并尽量避免直接使用webshell。

**漏洞利用方式：**

1.  **版本检测：** 通过访问 `/login.jsp` 并解析HTML内容来确定Openfire的版本。
2.  **认证绕过：** 利用路径遍历漏洞，通过访问类似 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp` 的URL来绕过身份验证。
3.  **会话劫持：** 获取JSESSIONID和CSRF令牌（如果存在），用于后续的操作。
4.  **创建用户：** 构造包含用户名、密码和管理员权限的POST请求，发送到 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`，从而创建一个新的管理员用户。

**项目地址:** [izzz0/CVE-2023-32315-POC](https://github.com/izzz0/CVE-2023-32315-POC)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #7

**来源**: [CVE-2023-32315-miko550_CVE-2023-32315.md](../2023/CVE-2023-32315-miko550_CVE-2023-32315.md)

## CVE-2023-32315-Openfire-路径遍历导致认证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致认证绕过

**影响应用:** Openfire

**危害等级:** 高危，允许未授权访问管理控制台并创建管理员账户

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务器需要运行在存在漏洞的版本，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-32315 是一个存在于 Openfire 的路径遍历漏洞，它允许未经身份验证的攻击者通过 `setup` 目录访问受限的管理控制台页面，从而绕过身份验证。该漏洞的利用方式是利用`setup-s/%u002e%u002e/%u002e%u002e/` 路径，访问 `user-create.jsp` 页面，并创建一个新的管理员用户。提供的 Python 脚本通过构造包含恶意路径的 URL 来实现此攻击。该脚本首先尝试获取 JSESSIONID 和 csrf token，然后使用这些 token 创建一个新的管理员用户。脚本的`success.txt` 会记录成功创建管理员账户的URL,用户名和密码.投毒风险较低，因为该脚本的功能主要是利用漏洞，未发现恶意代码，但是创建管理员用户的行为本身具有一定的破坏性。

参考:
* [webpage 0]: NVD对该漏洞的描述
* [webpage 1]: Broadcom 对 Openfire Authentication Bypass Vulnerability的描述
* [webpage 2]: Rapid7 漏洞数据库描述
* [webpage 4]: Fortiguard 威胁信号报告，描述了该漏洞的影响
* [webpage 6]: VulnCheck blog 描述了该漏洞的利用方式
* [webpage 8]: Cybrary.it 描述了 Openfire (CVE-2023-32315) 的细节
* [webpage 9]: Acunetix 对 Openfire Path Traversal 的描述

漏洞利用有效性高，因为CVE库和搜索结果都确认了该漏洞的存在和可利用性。POC代码也提供了一个可行的利用方法。

由于CISA已将此漏洞添加到已知被利用漏洞目录，证明该漏洞已经在野外被利用。

**项目地址:** [miko550/CVE-2023-32315](https://github.com/miko550/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #8

**来源**: [CVE-2023-32315-ohnonoyesyes_CVE-2023-32315.md](../2023/CVE-2023-32315-ohnonoyesyes_CVE-2023-32315.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可未经授权访问管理控制台，甚至可能导致远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8; 4.7.0 <= version < 4.7.5

**利用条件:** Openfire实例已部署且允许未授权网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315是一个存在于Openfire管理控制台中的路径遍历漏洞。攻击者可以利用该漏洞绕过身份验证，未经授权访问管理控制台的受限页面。根据漏洞库信息，该漏洞影响自2015年4月以来发布的所有Openfire版本，即3.10.0到4.6.8以及4.7.0到4.7.5。提供的POC代码通过发送一个包含特殊构造的URL的GET请求 `/setup/setup-s/%002e%002e/Su002esu002e/log.jsp`尝试利用该漏洞。URL中的`%002e%002e`用于进行路径遍历攻击，尝试访问 `log.jsp` 文件。根据搜索结果和漏洞描述，该漏洞利用方式是有效的。虽然POC代码本身不包含明显的恶意代码, 但通常拿到控制台权限可以进行恶意插件的上传, 从而达到RCE的目的, 所以如果控制台权限被恶意利用，可能会被用来执行任意代码、窃取敏感信息或者进行其他恶意操作。 此仓库仅包含了漏洞验证的请求，未发现有其他恶意代码，因此投毒风险较低, 接近0%。

**项目地址:** [ohnonoyesyes/CVE-2023-32315](https://github.com/ohnonoyesyes/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #9

**来源**: [CVE-2023-32315-pulentoski_Explotaci-n-de-CVE-2023-32315-en-Openfire.md](../2023/CVE-2023-32315-pulentoski_Explotaci-n-de-CVE-2023-32315-en-Openfire.md)

## CVE-2023-32315-Openfire-认证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致的认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可能导致未授权访问和控制

**影响版本:** 3.10.0 <= version < 4.6.8, 4.7.0 <= version < 4.7.5

**利用条件:** 需要目标Openfire实例运行在受影响版本，且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315 是 Openfire 的一个认证绕过漏洞，攻击者可以通过构造包含路径遍历字符的 URL，未经身份验证即可访问 Openfire 管理控制台的敏感页面。该漏洞利用方式是利用`setup`目录下的文件，通过`../`进行目录穿越，访问到需要认证的页面。提供的POC代码首先尝试获取JSESSIONID和CSRF token，然后利用这些信息，通过构造恶意URL在目标系统上创建一个管理员用户。POC代码会添加一个随机用户名和密码的管理员账号。从代码分析来看，不存在明显的投毒行为，代码行为和漏洞描述相符，目的明确，即创建管理员账户，所以投毒风险极低。

根据CISA的已知被利用漏洞目录显示，该漏洞已被积极利用。

该漏洞影响Openfire 3.10.0 到 4.6.8 以及 4.7.0 到 4.7.5版本。

**项目地址:** [pulentoski/Explotaci-n-de-CVE-2023-32315-en-Openfire](https://github.com/pulentoski/Explotaci-n-de-CVE-2023-32315-en-Openfire)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #10

**来源**: [CVE-2023-32315-tangxiaofeng7_CVE-2023-32315-Openfire-Bypass.md](../2023/CVE-2023-32315-tangxiaofeng7_CVE-2023-32315-Openfire-Bypass.md)

## CVE-2023-32315-Openfire-认证绕过与RCE

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过/远程代码执行

**影响应用:** Openfire

**危害等级:** 高危，未经授权访问管理控制台并执行任意代码

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务需要运行，并且攻击者需要能够通过网络访问Openfire的管理端口（通常是9090）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞CVE-2023-32315是Openfire管理控制台中存在的路径遍历漏洞，允许未经身份验证的用户绕过身份验证，访问受限页面。利用方式主要分为以下几个步骤：

1.  **认证绕过：** 攻击者利用路径遍历漏洞，通过访问Openfire的Setup Environment绕过认证，访问管理控制台。
2.  **获取JSESSIONID和CSRFToken：** 访问设置页面获取JSESSIONID和CSRFToken, 用于后续创建用户的请求。
3.  **创建管理员用户：**  构造恶意请求，创建一个新的管理员用户。
4.  **插件上传：**  攻击者编译或下载恶意插件。该插件包含一个JSP页面，该页面允许执行任意命令。
5.  **远程代码执行：**  通过管理界面上传恶意插件，然后访问该JSP页面，实现远程代码执行。

**投毒风险分析：**

该POC主要由三部分构成：
*   `CVE-2023-32315-Openfire-Bypass/scan_all` 目录下的 go 代码，用于扫描和验证目标是否存在漏洞。
*   `pom.xml`、`src/` 目录下的代码用于编译恶意的 Openfire 插件，其中包含一个 Webshell，密码为123，功能是执行命令。
*   `README.md` 文件描述了漏洞利用的步骤。

其中 `scan_all` 目录下的 go 代码可能存在投毒风险，例如在扫描过程中执行恶意代码。`src/main/web/cmd.jsp` 是一个webshell，如果被植入恶意代码，也会造成安全风险。但是，从代码本身来看，大部分是漏洞利用代码，少部分代码有可能被用于投毒，因此判定投毒风险为10%。

**项目地址:** [tangxiaofeng7/CVE-2023-32315-Openfire-Bypass](https://github.com/tangxiaofeng7/CVE-2023-32315-Openfire-Bypass)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---



---

## POC #6

**来源**: [CVE-2023-32315-izzz0_CVE-2023-32315-POC.md](../2023/CVE-2023-32315-izzz0_CVE-2023-32315-POC.md)

## CVE-2023-32315-Openfire-Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过

**影响应用:** Openfire

**危害等级:** 高危，允许未授权访问管理控制台，可能导致敏感信息泄露、配置更改甚至远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8 或 4.7.0 <= version < 4.7.5

**利用条件:** 目标Openfire实例处于漏洞影响版本范围，且setup未被禁用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 的路径遍历漏洞，允许未经身份验证的攻击者访问受限的管理页面。利用方式是访问 `/setup/setup-s/%u002e%u002e/%u002e%u002e/<受限页面>`。提供的POC代码尝试自动化这个过程，包括版本检测、获取JSESSIONID和CSRF令牌，并创建一个新的管理员用户。虽然代码本身看起来直接利用了该漏洞，但存在一些潜在的投毒风险：

*   **依赖性风险：** `requirements.txt` 文件中可能包含恶意依赖，虽然未在此次code中展示，但如果直接使用`pip install -r requirements.txt`仍存在潜在风险。
*   **远程资源风险：** README提到需要前往 `https://github.com/tangxiaofeng7/CVE-2023-32315-Openfire-Bypass/releases/tag/v0.1` 下载 webshell，这可能引入恶意代码。
*   **行为风险：** 该脚本本身执行创建用户的行为，如果滥用，可能对目标系统产生未授权的修改。

总的来说，POC代码的有效性较高，因为它直接利用了已知的路径遍历漏洞。投毒风险较低（约10%），主要集中在依赖和远程资源上，实际使用时，应该审核依赖文件，并尽量避免直接使用webshell。

**漏洞利用方式：**

1.  **版本检测：** 通过访问 `/login.jsp` 并解析HTML内容来确定Openfire的版本。
2.  **认证绕过：** 利用路径遍历漏洞，通过访问类似 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp` 的URL来绕过身份验证。
3.  **会话劫持：** 获取JSESSIONID和CSRF令牌（如果存在），用于后续的操作。
4.  **创建用户：** 构造包含用户名、密码和管理员权限的POST请求，发送到 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`，从而创建一个新的管理员用户。

**项目地址:** [izzz0/CVE-2023-32315-POC](https://github.com/izzz0/CVE-2023-32315-POC)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #7

**来源**: [CVE-2023-32315-miko550_CVE-2023-32315.md](../2023/CVE-2023-32315-miko550_CVE-2023-32315.md)

## CVE-2023-32315-Openfire-路径遍历导致认证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致认证绕过

**影响应用:** Openfire

**危害等级:** 高危，允许未授权访问管理控制台并创建管理员账户

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务器需要运行在存在漏洞的版本，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-32315 是一个存在于 Openfire 的路径遍历漏洞，它允许未经身份验证的攻击者通过 `setup` 目录访问受限的管理控制台页面，从而绕过身份验证。该漏洞的利用方式是利用`setup-s/%u002e%u002e/%u002e%u002e/` 路径，访问 `user-create.jsp` 页面，并创建一个新的管理员用户。提供的 Python 脚本通过构造包含恶意路径的 URL 来实现此攻击。该脚本首先尝试获取 JSESSIONID 和 csrf token，然后使用这些 token 创建一个新的管理员用户。脚本的`success.txt` 会记录成功创建管理员账户的URL,用户名和密码.投毒风险较低，因为该脚本的功能主要是利用漏洞，未发现恶意代码，但是创建管理员用户的行为本身具有一定的破坏性。

参考:
* [webpage 0]: NVD对该漏洞的描述
* [webpage 1]: Broadcom 对 Openfire Authentication Bypass Vulnerability的描述
* [webpage 2]: Rapid7 漏洞数据库描述
* [webpage 4]: Fortiguard 威胁信号报告，描述了该漏洞的影响
* [webpage 6]: VulnCheck blog 描述了该漏洞的利用方式
* [webpage 8]: Cybrary.it 描述了 Openfire (CVE-2023-32315) 的细节
* [webpage 9]: Acunetix 对 Openfire Path Traversal 的描述

漏洞利用有效性高，因为CVE库和搜索结果都确认了该漏洞的存在和可利用性。POC代码也提供了一个可行的利用方法。

由于CISA已将此漏洞添加到已知被利用漏洞目录，证明该漏洞已经在野外被利用。

**项目地址:** [miko550/CVE-2023-32315](https://github.com/miko550/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #8

**来源**: [CVE-2023-32315-ohnonoyesyes_CVE-2023-32315.md](../2023/CVE-2023-32315-ohnonoyesyes_CVE-2023-32315.md)

## CVE-2023-32315 - Openfire Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可未经授权访问管理控制台，甚至可能导致远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8; 4.7.0 <= version < 4.7.5

**利用条件:** Openfire实例已部署且允许未授权网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315是一个存在于Openfire管理控制台中的路径遍历漏洞。攻击者可以利用该漏洞绕过身份验证，未经授权访问管理控制台的受限页面。根据漏洞库信息，该漏洞影响自2015年4月以来发布的所有Openfire版本，即3.10.0到4.6.8以及4.7.0到4.7.5。提供的POC代码通过发送一个包含特殊构造的URL的GET请求 `/setup/setup-s/%002e%002e/Su002esu002e/log.jsp`尝试利用该漏洞。URL中的`%002e%002e`用于进行路径遍历攻击，尝试访问 `log.jsp` 文件。根据搜索结果和漏洞描述，该漏洞利用方式是有效的。虽然POC代码本身不包含明显的恶意代码, 但通常拿到控制台权限可以进行恶意插件的上传, 从而达到RCE的目的, 所以如果控制台权限被恶意利用，可能会被用来执行任意代码、窃取敏感信息或者进行其他恶意操作。 此仓库仅包含了漏洞验证的请求，未发现有其他恶意代码，因此投毒风险较低, 接近0%。

**项目地址:** [ohnonoyesyes/CVE-2023-32315](https://github.com/ohnonoyesyes/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #9

**来源**: [CVE-2023-32315-pulentoski_Explotaci-n-de-CVE-2023-32315-en-Openfire.md](../2023/CVE-2023-32315-pulentoski_Explotaci-n-de-CVE-2023-32315-en-Openfire.md)

## CVE-2023-32315-Openfire-认证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致的认证绕过

**影响应用:** Openfire

**危害等级:** 高危，可能导致未授权访问和控制

**影响版本:** 3.10.0 <= version < 4.6.8, 4.7.0 <= version < 4.7.5

**利用条件:** 需要目标Openfire实例运行在受影响版本，且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-32315 是 Openfire 的一个认证绕过漏洞，攻击者可以通过构造包含路径遍历字符的 URL，未经身份验证即可访问 Openfire 管理控制台的敏感页面。该漏洞利用方式是利用`setup`目录下的文件，通过`../`进行目录穿越，访问到需要认证的页面。提供的POC代码首先尝试获取JSESSIONID和CSRF token，然后利用这些信息，通过构造恶意URL在目标系统上创建一个管理员用户。POC代码会添加一个随机用户名和密码的管理员账号。从代码分析来看，不存在明显的投毒行为，代码行为和漏洞描述相符，目的明确，即创建管理员账户，所以投毒风险极低。

根据CISA的已知被利用漏洞目录显示，该漏洞已被积极利用。

该漏洞影响Openfire 3.10.0 到 4.6.8 以及 4.7.0 到 4.7.5版本。

**项目地址:** [pulentoski/Explotaci-n-de-CVE-2023-32315-en-Openfire](https://github.com/pulentoski/Explotaci-n-de-CVE-2023-32315-en-Openfire)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

## POC #10

**来源**: [CVE-2023-32315-tangxiaofeng7_CVE-2023-32315-Openfire-Bypass.md](../2023/CVE-2023-32315-tangxiaofeng7_CVE-2023-32315-Openfire-Bypass.md)

## CVE-2023-32315-Openfire-认证绕过与RCE

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过/远程代码执行

**影响应用:** Openfire

**危害等级:** 高危，未经授权访问管理控制台并执行任意代码

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务需要运行，并且攻击者需要能够通过网络访问Openfire的管理端口（通常是9090）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞CVE-2023-32315是Openfire管理控制台中存在的路径遍历漏洞，允许未经身份验证的用户绕过身份验证，访问受限页面。利用方式主要分为以下几个步骤：

1.  **认证绕过：** 攻击者利用路径遍历漏洞，通过访问Openfire的Setup Environment绕过认证，访问管理控制台。
2.  **获取JSESSIONID和CSRFToken：** 访问设置页面获取JSESSIONID和CSRFToken, 用于后续创建用户的请求。
3.  **创建管理员用户：**  构造恶意请求，创建一个新的管理员用户。
4.  **插件上传：**  攻击者编译或下载恶意插件。该插件包含一个JSP页面，该页面允许执行任意命令。
5.  **远程代码执行：**  通过管理界面上传恶意插件，然后访问该JSP页面，实现远程代码执行。

**投毒风险分析：**

该POC主要由三部分构成：
*   `CVE-2023-32315-Openfire-Bypass/scan_all` 目录下的 go 代码，用于扫描和验证目标是否存在漏洞。
*   `pom.xml`、`src/` 目录下的代码用于编译恶意的 Openfire 插件，其中包含一个 Webshell，密码为123，功能是执行命令。
*   `README.md` 文件描述了漏洞利用的步骤。

其中 `scan_all` 目录下的 go 代码可能存在投毒风险，例如在扫描过程中执行恶意代码。`src/main/web/cmd.jsp` 是一个webshell，如果被植入恶意代码，也会造成安全风险。但是，从代码本身来看，大部分是漏洞利用代码，少部分代码有可能被用于投毒，因此判定投毒风险为10%。

**项目地址:** [tangxiaofeng7/CVE-2023-32315-Openfire-Bypass](https://github.com/tangxiaofeng7/CVE-2023-32315-Openfire-Bypass)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)

---

