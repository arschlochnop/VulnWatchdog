# CVE-2023-3824

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-3824-bluefish3r_poc-cve.md](../2023/CVE-2023-3824-bluefish3r_poc-cve.md)

## CVE-2023-3824 - PHP Phar 堆栈缓冲区溢出

**漏洞编号:** CVE-2023-3824

**漏洞类型:** 堆栈缓冲区溢出

**影响应用:** PHP

**危害等级:** 高危，可能导致内存破坏或远程代码执行（RCE）

**影响版本:** PHP 8.0.* < 8.0.30, 8.1.* < 8.1.22, 8.2.* < 8.2.8

**利用条件:** 需要能够加载恶意的Phar文件

**POC 可用性:** 是，但需要进一步分析

**投毒风险:** 10%

## 详情

CVE-2023-3824 是 PHP 中 Phar 扩展中的一个堆栈缓冲区溢出漏洞。当 PHP 加载 Phar 文件并读取目录条目时，由于长度检查不足，可能导致缓冲区溢出，进而造成内存破坏或远程代码执行。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞是一个真实存在的，且影响多个PHP版本。由于提供的POC代码只是一个指向 codeberg 仓库的链接，需要进一步分析仓库内容来确定其有效性。但是考虑到漏洞描述的细节以及多个来源的确认，该漏洞具有较高的可利用性。

**投毒风险：** 提供的漏洞利用代码只有一个指向 codeberg 仓库的 README.md 文件。虽然直接评估这个文件无法判断是否存在投毒代码，但考虑到以下几点：
    * 仓库的来源 (codeberg) 相对比较干净，比github投毒风险低。
    * POC本身目的如果是漏洞验证，植入后门反而影响验证效果。
    * README.md的内容非常简洁，只有链接，没有明显的投毒迹象。

    因此，投毒的可能性较低。我们仍然不能排除下载的POC代码仓库中存在其他被隐藏的恶意代码的可能性。所以综合判断，认为存在10%的投毒风险。

**利用方式：** 利用方式主要分为以下几个步骤：

1.  **构造恶意的Phar文件：** 攻击者需要构造一个恶意的Phar文件，该文件包含特制的目录条目，这些条目的长度超过了PHP在读取时分配的缓冲区大小。
2.  **触发漏洞：** 攻击者需要找到一种方法让目标PHP应用程序加载这个恶意的Phar文件。这可能涉及文件上传、文件包含或其他允许加载phar文件的机制。
3.  **溢出利用：** 当PHP尝试读取Phar文件的目录条目时，由于长度检查不足，数据会溢出缓冲区，覆盖堆栈上的其他数据。攻击者可以利用这一点来覆盖函数返回地址，跳转到任意代码执行。

总而言之，该漏洞是一个严重的安全问题，攻击者可以利用它来实现远程代码执行，因此及时更新PHP版本至不受影响的版本至关重要。

**项目地址:** [bluefish3r/poc-cve](https://github.com/bluefish3r/poc-cve)

**漏洞详情:** [CVE-2023-3824](https://nvd.nist.gov/vuln/detail/CVE-2023-3824)

---

## POC #2

**来源**: [CVE-2023-3824-dadosneurais_cve-2023-3824.md](../2023/CVE-2023-3824-dadosneurais_cve-2023-3824.md)

## CVE-2023-3824-PHP-phar_dir_read栈缓冲区溢出

**漏洞编号:** CVE-2023-3824

**漏洞类型:** 栈缓冲区溢出

**影响应用:** PHP

**危害等级:** 高危，可能导致内存破坏或远程代码执行（RCE）

**影响版本:** < 8.0.30, < 8.1.22, < 8.2.8

**利用条件:** 需要目标系统运行存在漏洞的PHP版本，并允许上传phar文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-3824是PHP中PHAR扩展的一个栈缓冲区溢出漏洞，由于`phar_dir_read()`函数中缺乏足够的长度检查导致。当PHP加载phar文件并读取PHAR目录条目时，可以通过构造恶意的phar文件触发此漏洞，导致内存损坏或远程代码执行。

**利用方式：**

1.  攻击者创建一个恶意的phar文件，其中包含特制的目录条目，这些条目的长度超出了预期。
2.  攻击者将此phar文件上传到存在漏洞的PHP服务器上，如果服务器允许上传PHAR文件。
3.  攻击者通过触发PHP代码来处理上传的phar文件，例如，使用`new Phar()`函数来实例化该文件。
4.  当PHP尝试读取phar文件的目录条目时，由于长度检查不足，导致栈缓冲区溢出。
5.  攻击者可以利用此溢出来覆盖栈上的数据，从而可能实现远程代码执行。

**POC有效性：**

提供的POC代码利用此漏洞的原理。 Dockerfile设置了易受攻击的环境。 index.php允许上传phar文件，并尝试提取phar文件的内容。 exploit.zip应该包含恶意的phar文件，该文件在提取时会触发漏洞。该README提供了设置docker环境和利用方式的说明，可以通过反向shell获取权限。

**投毒风险：**

提供的代码片段中未发现明显的恶意代码。 index.php 文件目的是接收phar文件，然后提取文件，并没有执行其他恶意行为。`exploit.zip` 文件是被攻击的目标，不应该被定义为投毒代码。

因此，投毒风险评估为0%。

总而言之，此漏洞的利用相对直接，POC代码有效，并且没有明显的投毒风险。攻击者可以使用精心构造的phar文件来利用此漏洞，进而实现远程代码执行。

**项目地址:** [dadosneurais/cve-2023-3824](https://github.com/dadosneurais/cve-2023-3824)

**漏洞详情:** [CVE-2023-3824](https://nvd.nist.gov/vuln/detail/CVE-2023-3824)

---

## POC #3

**来源**: [CVE-2023-3824-jhonnybonny_CVE-2023-3824.md](../2023/CVE-2023-3824-jhonnybonny_CVE-2023-3824.md)

# CVE-2023-3824

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-3824-bluefish3r_poc-cve.md](../2023/CVE-2023-3824-bluefish3r_poc-cve.md)

## CVE-2023-3824 - PHP Phar 堆栈缓冲区溢出

**漏洞编号:** CVE-2023-3824

**漏洞类型:** 堆栈缓冲区溢出

**影响应用:** PHP

**危害等级:** 高危，可能导致内存破坏或远程代码执行（RCE）

**影响版本:** PHP 8.0.* < 8.0.30, 8.1.* < 8.1.22, 8.2.* < 8.2.8

**利用条件:** 需要能够加载恶意的Phar文件

**POC 可用性:** 是，但需要进一步分析

**投毒风险:** 10%

## 详情

CVE-2023-3824 是 PHP 中 Phar 扩展中的一个堆栈缓冲区溢出漏洞。当 PHP 加载 Phar 文件并读取目录条目时，由于长度检查不足，可能导致缓冲区溢出，进而造成内存破坏或远程代码执行。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞是一个真实存在的，且影响多个PHP版本。由于提供的POC代码只是一个指向 codeberg 仓库的链接，需要进一步分析仓库内容来确定其有效性。但是考虑到漏洞描述的细节以及多个来源的确认，该漏洞具有较高的可利用性。

**投毒风险：** 提供的漏洞利用代码只有一个指向 codeberg 仓库的 README.md 文件。虽然直接评估这个文件无法判断是否存在投毒代码，但考虑到以下几点：
    * 仓库的来源 (codeberg) 相对比较干净，比github投毒风险低。
    * POC本身目的如果是漏洞验证，植入后门反而影响验证效果。
    * README.md的内容非常简洁，只有链接，没有明显的投毒迹象。

    因此，投毒的可能性较低。我们仍然不能排除下载的POC代码仓库中存在其他被隐藏的恶意代码的可能性。所以综合判断，认为存在10%的投毒风险。

**利用方式：** 利用方式主要分为以下几个步骤：

1.  **构造恶意的Phar文件：** 攻击者需要构造一个恶意的Phar文件，该文件包含特制的目录条目，这些条目的长度超过了PHP在读取时分配的缓冲区大小。
2.  **触发漏洞：** 攻击者需要找到一种方法让目标PHP应用程序加载这个恶意的Phar文件。这可能涉及文件上传、文件包含或其他允许加载phar文件的机制。
3.  **溢出利用：** 当PHP尝试读取Phar文件的目录条目时，由于长度检查不足，数据会溢出缓冲区，覆盖堆栈上的其他数据。攻击者可以利用这一点来覆盖函数返回地址，跳转到任意代码执行。

总而言之，该漏洞是一个严重的安全问题，攻击者可以利用它来实现远程代码执行，因此及时更新PHP版本至不受影响的版本至关重要。

**项目地址:** [bluefish3r/poc-cve](https://github.com/bluefish3r/poc-cve)

**漏洞详情:** [CVE-2023-3824](https://nvd.nist.gov/vuln/detail/CVE-2023-3824)

---

## POC #2

**来源**: [CVE-2023-3824-dadosneurais_cve-2023-3824.md](../2023/CVE-2023-3824-dadosneurais_cve-2023-3824.md)

## CVE-2023-3824-PHP-phar_dir_read栈缓冲区溢出

**漏洞编号:** CVE-2023-3824

**漏洞类型:** 栈缓冲区溢出

**影响应用:** PHP

**危害等级:** 高危，可能导致内存破坏或远程代码执行（RCE）

**影响版本:** < 8.0.30, < 8.1.22, < 8.2.8

**利用条件:** 需要目标系统运行存在漏洞的PHP版本，并允许上传phar文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-3824是PHP中PHAR扩展的一个栈缓冲区溢出漏洞，由于`phar_dir_read()`函数中缺乏足够的长度检查导致。当PHP加载phar文件并读取PHAR目录条目时，可以通过构造恶意的phar文件触发此漏洞，导致内存损坏或远程代码执行。

**利用方式：**

1.  攻击者创建一个恶意的phar文件，其中包含特制的目录条目，这些条目的长度超出了预期。
2.  攻击者将此phar文件上传到存在漏洞的PHP服务器上，如果服务器允许上传PHAR文件。
3.  攻击者通过触发PHP代码来处理上传的phar文件，例如，使用`new Phar()`函数来实例化该文件。
4.  当PHP尝试读取phar文件的目录条目时，由于长度检查不足，导致栈缓冲区溢出。
5.  攻击者可以利用此溢出来覆盖栈上的数据，从而可能实现远程代码执行。

**POC有效性：**

提供的POC代码利用此漏洞的原理。 Dockerfile设置了易受攻击的环境。 index.php允许上传phar文件，并尝试提取phar文件的内容。 exploit.zip应该包含恶意的phar文件，该文件在提取时会触发漏洞。该README提供了设置docker环境和利用方式的说明，可以通过反向shell获取权限。

**投毒风险：**

提供的代码片段中未发现明显的恶意代码。 index.php 文件目的是接收phar文件，然后提取文件，并没有执行其他恶意行为。`exploit.zip` 文件是被攻击的目标，不应该被定义为投毒代码。

因此，投毒风险评估为0%。

总而言之，此漏洞的利用相对直接，POC代码有效，并且没有明显的投毒风险。攻击者可以使用精心构造的phar文件来利用此漏洞，进而实现远程代码执行。

**项目地址:** [dadosneurais/cve-2023-3824](https://github.com/dadosneurais/cve-2023-3824)

**漏洞详情:** [CVE-2023-3824](https://nvd.nist.gov/vuln/detail/CVE-2023-3824)

---

## POC #3

**来源**: [CVE-2023-3824-jhonnybonny_CVE-2023-3824.md](../2023/CVE-2023-3824-jhonnybonny_CVE-2023-3824.md)

# CVE-2023-3824

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-3824-bluefish3r_poc-cve.md](../2023/CVE-2023-3824-bluefish3r_poc-cve.md)

## CVE-2023-3824 - PHP Phar 堆栈缓冲区溢出

**漏洞编号:** CVE-2023-3824

**漏洞类型:** 堆栈缓冲区溢出

**影响应用:** PHP

**危害等级:** 高危，可能导致内存破坏或远程代码执行（RCE）

**影响版本:** PHP 8.0.* < 8.0.30, 8.1.* < 8.1.22, 8.2.* < 8.2.8

**利用条件:** 需要能够加载恶意的Phar文件

**POC 可用性:** 是，但需要进一步分析

**投毒风险:** 10%

## 详情

CVE-2023-3824 是 PHP 中 Phar 扩展中的一个堆栈缓冲区溢出漏洞。当 PHP 加载 Phar 文件并读取目录条目时，由于长度检查不足，可能导致缓冲区溢出，进而造成内存破坏或远程代码执行。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞是一个真实存在的，且影响多个PHP版本。由于提供的POC代码只是一个指向 codeberg 仓库的链接，需要进一步分析仓库内容来确定其有效性。但是考虑到漏洞描述的细节以及多个来源的确认，该漏洞具有较高的可利用性。

**投毒风险：** 提供的漏洞利用代码只有一个指向 codeberg 仓库的 README.md 文件。虽然直接评估这个文件无法判断是否存在投毒代码，但考虑到以下几点：
    * 仓库的来源 (codeberg) 相对比较干净，比github投毒风险低。
    * POC本身目的如果是漏洞验证，植入后门反而影响验证效果。
    * README.md的内容非常简洁，只有链接，没有明显的投毒迹象。

    因此，投毒的可能性较低。我们仍然不能排除下载的POC代码仓库中存在其他被隐藏的恶意代码的可能性。所以综合判断，认为存在10%的投毒风险。

**利用方式：** 利用方式主要分为以下几个步骤：

1.  **构造恶意的Phar文件：** 攻击者需要构造一个恶意的Phar文件，该文件包含特制的目录条目，这些条目的长度超过了PHP在读取时分配的缓冲区大小。
2.  **触发漏洞：** 攻击者需要找到一种方法让目标PHP应用程序加载这个恶意的Phar文件。这可能涉及文件上传、文件包含或其他允许加载phar文件的机制。
3.  **溢出利用：** 当PHP尝试读取Phar文件的目录条目时，由于长度检查不足，数据会溢出缓冲区，覆盖堆栈上的其他数据。攻击者可以利用这一点来覆盖函数返回地址，跳转到任意代码执行。

总而言之，该漏洞是一个严重的安全问题，攻击者可以利用它来实现远程代码执行，因此及时更新PHP版本至不受影响的版本至关重要。

**项目地址:** [bluefish3r/poc-cve](https://github.com/bluefish3r/poc-cve)

**漏洞详情:** [CVE-2023-3824](https://nvd.nist.gov/vuln/detail/CVE-2023-3824)

---

## POC #2

**来源**: [CVE-2023-3824-dadosneurais_cve-2023-3824.md](../2023/CVE-2023-3824-dadosneurais_cve-2023-3824.md)

## CVE-2023-3824-PHP-phar_dir_read栈缓冲区溢出

**漏洞编号:** CVE-2023-3824

**漏洞类型:** 栈缓冲区溢出

**影响应用:** PHP

**危害等级:** 高危，可能导致内存破坏或远程代码执行（RCE）

**影响版本:** < 8.0.30, < 8.1.22, < 8.2.8

**利用条件:** 需要目标系统运行存在漏洞的PHP版本，并允许上传phar文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-3824是PHP中PHAR扩展的一个栈缓冲区溢出漏洞，由于`phar_dir_read()`函数中缺乏足够的长度检查导致。当PHP加载phar文件并读取PHAR目录条目时，可以通过构造恶意的phar文件触发此漏洞，导致内存损坏或远程代码执行。

**利用方式：**

1.  攻击者创建一个恶意的phar文件，其中包含特制的目录条目，这些条目的长度超出了预期。
2.  攻击者将此phar文件上传到存在漏洞的PHP服务器上，如果服务器允许上传PHAR文件。
3.  攻击者通过触发PHP代码来处理上传的phar文件，例如，使用`new Phar()`函数来实例化该文件。
4.  当PHP尝试读取phar文件的目录条目时，由于长度检查不足，导致栈缓冲区溢出。
5.  攻击者可以利用此溢出来覆盖栈上的数据，从而可能实现远程代码执行。

**POC有效性：**

提供的POC代码利用此漏洞的原理。 Dockerfile设置了易受攻击的环境。 index.php允许上传phar文件，并尝试提取phar文件的内容。 exploit.zip应该包含恶意的phar文件，该文件在提取时会触发漏洞。该README提供了设置docker环境和利用方式的说明，可以通过反向shell获取权限。

**投毒风险：**

提供的代码片段中未发现明显的恶意代码。 index.php 文件目的是接收phar文件，然后提取文件，并没有执行其他恶意行为。`exploit.zip` 文件是被攻击的目标，不应该被定义为投毒代码。

因此，投毒风险评估为0%。

总而言之，此漏洞的利用相对直接，POC代码有效，并且没有明显的投毒风险。攻击者可以使用精心构造的phar文件来利用此漏洞，进而实现远程代码执行。

**项目地址:** [dadosneurais/cve-2023-3824](https://github.com/dadosneurais/cve-2023-3824)

**漏洞详情:** [CVE-2023-3824](https://nvd.nist.gov/vuln/detail/CVE-2023-3824)

---

## POC #3

**来源**: [CVE-2023-3824-jhonnybonny_CVE-2023-3824.md](../2023/CVE-2023-3824-jhonnybonny_CVE-2023-3824.md)

# CVE-2023-3824

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-3824-bluefish3r_poc-cve.md](../2023/CVE-2023-3824-bluefish3r_poc-cve.md)

## CVE-2023-3824 - PHP Phar 堆栈缓冲区溢出

**漏洞编号:** CVE-2023-3824

**漏洞类型:** 堆栈缓冲区溢出

**影响应用:** PHP

**危害等级:** 高危，可能导致内存破坏或远程代码执行（RCE）

**影响版本:** PHP 8.0.* < 8.0.30, 8.1.* < 8.1.22, 8.2.* < 8.2.8

**利用条件:** 需要能够加载恶意的Phar文件

**POC 可用性:** 是，但需要进一步分析

**投毒风险:** 10%

## 详情

CVE-2023-3824 是 PHP 中 Phar 扩展中的一个堆栈缓冲区溢出漏洞。当 PHP 加载 Phar 文件并读取目录条目时，由于长度检查不足，可能导致缓冲区溢出，进而造成内存破坏或远程代码执行。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞是一个真实存在的，且影响多个PHP版本。由于提供的POC代码只是一个指向 codeberg 仓库的链接，需要进一步分析仓库内容来确定其有效性。但是考虑到漏洞描述的细节以及多个来源的确认，该漏洞具有较高的可利用性。

**投毒风险：** 提供的漏洞利用代码只有一个指向 codeberg 仓库的 README.md 文件。虽然直接评估这个文件无法判断是否存在投毒代码，但考虑到以下几点：
    * 仓库的来源 (codeberg) 相对比较干净，比github投毒风险低。
    * POC本身目的如果是漏洞验证，植入后门反而影响验证效果。
    * README.md的内容非常简洁，只有链接，没有明显的投毒迹象。

    因此，投毒的可能性较低。我们仍然不能排除下载的POC代码仓库中存在其他被隐藏的恶意代码的可能性。所以综合判断，认为存在10%的投毒风险。

**利用方式：** 利用方式主要分为以下几个步骤：

1.  **构造恶意的Phar文件：** 攻击者需要构造一个恶意的Phar文件，该文件包含特制的目录条目，这些条目的长度超过了PHP在读取时分配的缓冲区大小。
2.  **触发漏洞：** 攻击者需要找到一种方法让目标PHP应用程序加载这个恶意的Phar文件。这可能涉及文件上传、文件包含或其他允许加载phar文件的机制。
3.  **溢出利用：** 当PHP尝试读取Phar文件的目录条目时，由于长度检查不足，数据会溢出缓冲区，覆盖堆栈上的其他数据。攻击者可以利用这一点来覆盖函数返回地址，跳转到任意代码执行。

总而言之，该漏洞是一个严重的安全问题，攻击者可以利用它来实现远程代码执行，因此及时更新PHP版本至不受影响的版本至关重要。

**项目地址:** [bluefish3r/poc-cve](https://github.com/bluefish3r/poc-cve)

**漏洞详情:** [CVE-2023-3824](https://nvd.nist.gov/vuln/detail/CVE-2023-3824)

---

## POC #2

**来源**: [CVE-2023-3824-dadosneurais_cve-2023-3824.md](../2023/CVE-2023-3824-dadosneurais_cve-2023-3824.md)

## CVE-2023-3824-PHP-phar_dir_read栈缓冲区溢出

**漏洞编号:** CVE-2023-3824

**漏洞类型:** 栈缓冲区溢出

**影响应用:** PHP

**危害等级:** 高危，可能导致内存破坏或远程代码执行（RCE）

**影响版本:** < 8.0.30, < 8.1.22, < 8.2.8

**利用条件:** 需要目标系统运行存在漏洞的PHP版本，并允许上传phar文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-3824是PHP中PHAR扩展的一个栈缓冲区溢出漏洞，由于`phar_dir_read()`函数中缺乏足够的长度检查导致。当PHP加载phar文件并读取PHAR目录条目时，可以通过构造恶意的phar文件触发此漏洞，导致内存损坏或远程代码执行。

**利用方式：**

1.  攻击者创建一个恶意的phar文件，其中包含特制的目录条目，这些条目的长度超出了预期。
2.  攻击者将此phar文件上传到存在漏洞的PHP服务器上，如果服务器允许上传PHAR文件。
3.  攻击者通过触发PHP代码来处理上传的phar文件，例如，使用`new Phar()`函数来实例化该文件。
4.  当PHP尝试读取phar文件的目录条目时，由于长度检查不足，导致栈缓冲区溢出。
5.  攻击者可以利用此溢出来覆盖栈上的数据，从而可能实现远程代码执行。

**POC有效性：**

提供的POC代码利用此漏洞的原理。 Dockerfile设置了易受攻击的环境。 index.php允许上传phar文件，并尝试提取phar文件的内容。 exploit.zip应该包含恶意的phar文件，该文件在提取时会触发漏洞。该README提供了设置docker环境和利用方式的说明，可以通过反向shell获取权限。

**投毒风险：**

提供的代码片段中未发现明显的恶意代码。 index.php 文件目的是接收phar文件，然后提取文件，并没有执行其他恶意行为。`exploit.zip` 文件是被攻击的目标，不应该被定义为投毒代码。

因此，投毒风险评估为0%。

总而言之，此漏洞的利用相对直接，POC代码有效，并且没有明显的投毒风险。攻击者可以使用精心构造的phar文件来利用此漏洞，进而实现远程代码执行。

**项目地址:** [dadosneurais/cve-2023-3824](https://github.com/dadosneurais/cve-2023-3824)

**漏洞详情:** [CVE-2023-3824](https://nvd.nist.gov/vuln/detail/CVE-2023-3824)

---

## POC #3

**来源**: [CVE-2023-3824-jhonnybonny_CVE-2023-3824.md](../2023/CVE-2023-3824-jhonnybonny_CVE-2023-3824.md)

# CVE-2023-3824

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-3824-bluefish3r_poc-cve.md](../2023/CVE-2023-3824-bluefish3r_poc-cve.md)

## CVE-2023-3824 - PHP Phar 堆栈缓冲区溢出

**漏洞编号:** CVE-2023-3824

**漏洞类型:** 堆栈缓冲区溢出

**影响应用:** PHP

**危害等级:** 高危，可能导致内存破坏或远程代码执行（RCE）

**影响版本:** PHP 8.0.* < 8.0.30, 8.1.* < 8.1.22, 8.2.* < 8.2.8

**利用条件:** 需要能够加载恶意的Phar文件

**POC 可用性:** 是，但需要进一步分析

**投毒风险:** 10%

## 详情

CVE-2023-3824 是 PHP 中 Phar 扩展中的一个堆栈缓冲区溢出漏洞。当 PHP 加载 Phar 文件并读取目录条目时，由于长度检查不足，可能导致缓冲区溢出，进而造成内存破坏或远程代码执行。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞是一个真实存在的，且影响多个PHP版本。由于提供的POC代码只是一个指向 codeberg 仓库的链接，需要进一步分析仓库内容来确定其有效性。但是考虑到漏洞描述的细节以及多个来源的确认，该漏洞具有较高的可利用性。

**投毒风险：** 提供的漏洞利用代码只有一个指向 codeberg 仓库的 README.md 文件。虽然直接评估这个文件无法判断是否存在投毒代码，但考虑到以下几点：
    * 仓库的来源 (codeberg) 相对比较干净，比github投毒风险低。
    * POC本身目的如果是漏洞验证，植入后门反而影响验证效果。
    * README.md的内容非常简洁，只有链接，没有明显的投毒迹象。

    因此，投毒的可能性较低。我们仍然不能排除下载的POC代码仓库中存在其他被隐藏的恶意代码的可能性。所以综合判断，认为存在10%的投毒风险。

**利用方式：** 利用方式主要分为以下几个步骤：

1.  **构造恶意的Phar文件：** 攻击者需要构造一个恶意的Phar文件，该文件包含特制的目录条目，这些条目的长度超过了PHP在读取时分配的缓冲区大小。
2.  **触发漏洞：** 攻击者需要找到一种方法让目标PHP应用程序加载这个恶意的Phar文件。这可能涉及文件上传、文件包含或其他允许加载phar文件的机制。
3.  **溢出利用：** 当PHP尝试读取Phar文件的目录条目时，由于长度检查不足，数据会溢出缓冲区，覆盖堆栈上的其他数据。攻击者可以利用这一点来覆盖函数返回地址，跳转到任意代码执行。

总而言之，该漏洞是一个严重的安全问题，攻击者可以利用它来实现远程代码执行，因此及时更新PHP版本至不受影响的版本至关重要。

**项目地址:** [bluefish3r/poc-cve](https://github.com/bluefish3r/poc-cve)

**漏洞详情:** [CVE-2023-3824](https://nvd.nist.gov/vuln/detail/CVE-2023-3824)

---

## POC #2

**来源**: [CVE-2023-3824-dadosneurais_cve-2023-3824.md](../2023/CVE-2023-3824-dadosneurais_cve-2023-3824.md)

## CVE-2023-3824-PHP-phar_dir_read栈缓冲区溢出

**漏洞编号:** CVE-2023-3824

**漏洞类型:** 栈缓冲区溢出

**影响应用:** PHP

**危害等级:** 高危，可能导致内存破坏或远程代码执行（RCE）

**影响版本:** < 8.0.30, < 8.1.22, < 8.2.8

**利用条件:** 需要目标系统运行存在漏洞的PHP版本，并允许上传phar文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-3824是PHP中PHAR扩展的一个栈缓冲区溢出漏洞，由于`phar_dir_read()`函数中缺乏足够的长度检查导致。当PHP加载phar文件并读取PHAR目录条目时，可以通过构造恶意的phar文件触发此漏洞，导致内存损坏或远程代码执行。

**利用方式：**

1.  攻击者创建一个恶意的phar文件，其中包含特制的目录条目，这些条目的长度超出了预期。
2.  攻击者将此phar文件上传到存在漏洞的PHP服务器上，如果服务器允许上传PHAR文件。
3.  攻击者通过触发PHP代码来处理上传的phar文件，例如，使用`new Phar()`函数来实例化该文件。
4.  当PHP尝试读取phar文件的目录条目时，由于长度检查不足，导致栈缓冲区溢出。
5.  攻击者可以利用此溢出来覆盖栈上的数据，从而可能实现远程代码执行。

**POC有效性：**

提供的POC代码利用此漏洞的原理。 Dockerfile设置了易受攻击的环境。 index.php允许上传phar文件，并尝试提取phar文件的内容。 exploit.zip应该包含恶意的phar文件，该文件在提取时会触发漏洞。该README提供了设置docker环境和利用方式的说明，可以通过反向shell获取权限。

**投毒风险：**

提供的代码片段中未发现明显的恶意代码。 index.php 文件目的是接收phar文件，然后提取文件，并没有执行其他恶意行为。`exploit.zip` 文件是被攻击的目标，不应该被定义为投毒代码。

因此，投毒风险评估为0%。

总而言之，此漏洞的利用相对直接，POC代码有效，并且没有明显的投毒风险。攻击者可以使用精心构造的phar文件来利用此漏洞，进而实现远程代码执行。

**项目地址:** [dadosneurais/cve-2023-3824](https://github.com/dadosneurais/cve-2023-3824)

**漏洞详情:** [CVE-2023-3824](https://nvd.nist.gov/vuln/detail/CVE-2023-3824)

---

## POC #3

**来源**: [CVE-2023-3824-jhonnybonny_CVE-2023-3824.md](../2023/CVE-2023-3824-jhonnybonny_CVE-2023-3824.md)

# CVE-2023-3824

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-3824-bluefish3r_poc-cve.md](../2023/CVE-2023-3824-bluefish3r_poc-cve.md)

## CVE-2023-3824 - PHP Phar 堆栈缓冲区溢出

**漏洞编号:** CVE-2023-3824

**漏洞类型:** 堆栈缓冲区溢出

**影响应用:** PHP

**危害等级:** 高危，可能导致内存破坏或远程代码执行（RCE）

**影响版本:** PHP 8.0.* < 8.0.30, 8.1.* < 8.1.22, 8.2.* < 8.2.8

**利用条件:** 需要能够加载恶意的Phar文件

**POC 可用性:** 是，但需要进一步分析

**投毒风险:** 10%

## 详情

CVE-2023-3824 是 PHP 中 Phar 扩展中的一个堆栈缓冲区溢出漏洞。当 PHP 加载 Phar 文件并读取目录条目时，由于长度检查不足，可能导致缓冲区溢出，进而造成内存破坏或远程代码执行。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞是一个真实存在的，且影响多个PHP版本。由于提供的POC代码只是一个指向 codeberg 仓库的链接，需要进一步分析仓库内容来确定其有效性。但是考虑到漏洞描述的细节以及多个来源的确认，该漏洞具有较高的可利用性。

**投毒风险：** 提供的漏洞利用代码只有一个指向 codeberg 仓库的 README.md 文件。虽然直接评估这个文件无法判断是否存在投毒代码，但考虑到以下几点：
    * 仓库的来源 (codeberg) 相对比较干净，比github投毒风险低。
    * POC本身目的如果是漏洞验证，植入后门反而影响验证效果。
    * README.md的内容非常简洁，只有链接，没有明显的投毒迹象。

    因此，投毒的可能性较低。我们仍然不能排除下载的POC代码仓库中存在其他被隐藏的恶意代码的可能性。所以综合判断，认为存在10%的投毒风险。

**利用方式：** 利用方式主要分为以下几个步骤：

1.  **构造恶意的Phar文件：** 攻击者需要构造一个恶意的Phar文件，该文件包含特制的目录条目，这些条目的长度超过了PHP在读取时分配的缓冲区大小。
2.  **触发漏洞：** 攻击者需要找到一种方法让目标PHP应用程序加载这个恶意的Phar文件。这可能涉及文件上传、文件包含或其他允许加载phar文件的机制。
3.  **溢出利用：** 当PHP尝试读取Phar文件的目录条目时，由于长度检查不足，数据会溢出缓冲区，覆盖堆栈上的其他数据。攻击者可以利用这一点来覆盖函数返回地址，跳转到任意代码执行。

总而言之，该漏洞是一个严重的安全问题，攻击者可以利用它来实现远程代码执行，因此及时更新PHP版本至不受影响的版本至关重要。

**项目地址:** [bluefish3r/poc-cve](https://github.com/bluefish3r/poc-cve)

**漏洞详情:** [CVE-2023-3824](https://nvd.nist.gov/vuln/detail/CVE-2023-3824)

---

## POC #2

**来源**: [CVE-2023-3824-dadosneurais_cve-2023-3824.md](../2023/CVE-2023-3824-dadosneurais_cve-2023-3824.md)

## CVE-2023-3824-PHP-phar_dir_read栈缓冲区溢出

**漏洞编号:** CVE-2023-3824

**漏洞类型:** 栈缓冲区溢出

**影响应用:** PHP

**危害等级:** 高危，可能导致内存破坏或远程代码执行（RCE）

**影响版本:** < 8.0.30, < 8.1.22, < 8.2.8

**利用条件:** 需要目标系统运行存在漏洞的PHP版本，并允许上传phar文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-3824是PHP中PHAR扩展的一个栈缓冲区溢出漏洞，由于`phar_dir_read()`函数中缺乏足够的长度检查导致。当PHP加载phar文件并读取PHAR目录条目时，可以通过构造恶意的phar文件触发此漏洞，导致内存损坏或远程代码执行。

**利用方式：**

1.  攻击者创建一个恶意的phar文件，其中包含特制的目录条目，这些条目的长度超出了预期。
2.  攻击者将此phar文件上传到存在漏洞的PHP服务器上，如果服务器允许上传PHAR文件。
3.  攻击者通过触发PHP代码来处理上传的phar文件，例如，使用`new Phar()`函数来实例化该文件。
4.  当PHP尝试读取phar文件的目录条目时，由于长度检查不足，导致栈缓冲区溢出。
5.  攻击者可以利用此溢出来覆盖栈上的数据，从而可能实现远程代码执行。

**POC有效性：**

提供的POC代码利用此漏洞的原理。 Dockerfile设置了易受攻击的环境。 index.php允许上传phar文件，并尝试提取phar文件的内容。 exploit.zip应该包含恶意的phar文件，该文件在提取时会触发漏洞。该README提供了设置docker环境和利用方式的说明，可以通过反向shell获取权限。

**投毒风险：**

提供的代码片段中未发现明显的恶意代码。 index.php 文件目的是接收phar文件，然后提取文件，并没有执行其他恶意行为。`exploit.zip` 文件是被攻击的目标，不应该被定义为投毒代码。

因此，投毒风险评估为0%。

总而言之，此漏洞的利用相对直接，POC代码有效，并且没有明显的投毒风险。攻击者可以使用精心构造的phar文件来利用此漏洞，进而实现远程代码执行。

**项目地址:** [dadosneurais/cve-2023-3824](https://github.com/dadosneurais/cve-2023-3824)

**漏洞详情:** [CVE-2023-3824](https://nvd.nist.gov/vuln/detail/CVE-2023-3824)

---

## POC #3

**来源**: [CVE-2023-3824-jhonnybonny_CVE-2023-3824.md](../2023/CVE-2023-3824-jhonnybonny_CVE-2023-3824.md)

## CVE-2023-3824 - PHP Phar 堆栈缓冲区溢出

**漏洞编号:** CVE-2023-3824

**漏洞类型:** 堆栈缓冲区溢出

**影响应用:** PHP

**危害等级:** 高危，可能导致内存损坏或远程代码执行

**影响版本:** < 8.0.30, < 8.1.22, < 8.2.8

**利用条件:** 需要能够加载并处理恶意的 Phar 文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-3824 是一个存在于 PHP Phar 扩展中的堆栈缓冲区溢出漏洞。当 PHP 加载 Phar 文件并读取目录条目时，由于缺少足够的长度检查，可能导致堆栈缓冲区溢出，从而导致内存损坏或远程代码执行。\n\n**有效性分析：**
根据漏洞信息和搜索引擎结果，该漏洞的存在已被确认，且有多个来源表明该漏洞影响特定版本的 PHP。提供的 POC 代码旨在创建一个恶意的 Phar 文件，该文件在被 PHP 处理时会触发缓冲区溢出。根据代码，`create_phar.php` 创建一个 `malicious.phar` 文件，其中包含一个长度接近 `PHP_MAXPATHLEN` 的文件名。`trigger_overflow.php` 使用 `opendir` 和 `readdir` 函数尝试读取恶意 Phar 文件的目录内容，这正是触发漏洞的地方。因此，提供的POC代码是有效的，可以触发该漏洞。
\n**投毒风险分析：**
提供的 POC 代码主要包含两个文件：`create_phar.php` 用于创建恶意的 PHAR 文件，`trigger_overflow.php` 用于触发漏洞。仔细检查这两个文件，可以发现 `create_phar.php` 中的恶意行为是将文件名长度设置为 `PHP_MAXPATHLEN - 1`，这会触发缓冲区溢出。`trigger_overflow.php` 只是简单地打开和读取该 PHAR 文件，并无其他恶意行为。因此，投毒风险较低，主要风险在于利用漏洞本身造成的损害。虽然存在隐蔽后门的可能，但该可能性很小。综合判断，投毒风险为 10%。
\n**利用方式分析：**
1.  **创建恶意 Phar 文件：** 攻击者首先使用 `create_phar.php` 中的代码创建一个包含超长文件名的 Phar 文件。这个文件名长度接近 PHP 允许的最大路径长度，目的是溢出缓冲区。
2.  **触发漏洞：** 然后，攻击者通过某种方式让目标 PHP 应用程序处理这个恶意的 Phar 文件。例如，可以通过上传功能上传该文件，或者通过包含文件的方式让 PHP 加载该文件。
3.  **利用 `opendir` 和 `readdir` 函数：** 当 PHP 尝试使用 `opendir` 和 `readdir` 函数读取 Phar 文件的目录条目时，由于文件名过长，会触发缓冲区溢出，覆盖堆栈上的其他数据。
4.  **潜在的 RCE：** 如果攻击者能够精确控制溢出的内容，他们可能可以覆盖返回地址，从而实现远程代码执行 (RCE)。即使不能直接 RCE，内存损坏也可能导致拒绝服务或其他安全问题。

**项目地址:** [jhonnybonny/CVE-2023-3824](https://github.com/jhonnybonny/CVE-2023-3824)

**漏洞详情:** [CVE-2023-3824](https://nvd.nist.gov/vuln/detail/CVE-2023-3824)

---



---



---



---



---



---

