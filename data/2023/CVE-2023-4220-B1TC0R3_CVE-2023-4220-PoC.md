# CVE-2023-4220

> 📦 该CVE有 **25** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-4220-0x00-null_Chamilo-CVE-2023-4220-RCE-Exploit.md](../2023/CVE-2023-4220-0x00-null_Chamilo-CVE-2023-4220-RCE-Exploit.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以通过上传恶意文件执行任意代码。

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，且未应用补丁。攻击者需要能够访问目标系统的网络。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 漏洞存在于 Chamilo LMS 的 bigUpload.php 文件中，允许未经身份验证的攻击者上传任意文件，包括 webshell。根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为高危，攻击者可以利用此漏洞执行存储型跨站脚本攻击 (XSS) 并获得远程代码执行 (RCE) 权限。

**利用方式：**
1.  攻击者使用提供的 PoC 脚本 (exploit.py)。
2.  该脚本首先上传一个包含恶意 PHP 代码的 webshell 文件到目标 Chamilo LMS 系统的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径。
3.  上传成功后，攻击者可以通过访问上传的 webshell 文件，并传递 `cmd` 参数来执行任意系统命令。例如： `http://lms.target-site/main/inc/lib/javascript/bigupload/files/my_shell.php?cmd=id`
4.  PoC 脚本会显示命令执行的结果。

**有效性评估：**
根据PoC代码中的描述,该利用代码经验证有效，可以实现未经身份验证的远程代码执行。

**投毒风险分析：**
查看PoC代码，主要功能为上传webshell并执行命令。虽然存在远程代码执行的风险，但PoC本身的目的就是利用漏洞，所以不属于投毒代码。在LICENSE文件和README文件中没有发现恶意代码，根据作者以前的项目, 判断此仓库中作者隐藏的投毒代码可能性较低。因此，投毒风险较低，评估为1%。

**项目地址:** [0x00-null/Chamilo-CVE-2023-4220-RCE-Exploit](https://github.com/0x00-null/Chamilo-CVE-2023-4220-RCE-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #2

**来源**: [CVE-2023-4220-0xDTC_Chamilo-LMS-CVE-2023-4220-Exploit.md](../2023/CVE-2023-4220-0xDTC_Chamilo-LMS-CVE-2023-4220-Exploit.md)

## CVE-2023-4220-Chamilo LMS-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致完全控制服务器

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行受影响版本的Chamilo LMS，且攻击者能够通过网络访问该系统

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 是 Chamilo LMS <= v1.11.24 中的一个远程代码执行漏洞。该漏洞源于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中的不设限的文件上传功能。攻击者可以上传恶意文件（例如 webshell），从而执行任意代码。

**有效性：**

根据漏洞描述、搜索结果和提供的POC代码，此漏洞利用是有效的。多个来源确认了该漏洞的存在和可利用性，POC代码也提供了利用该漏洞的脚本。

**投毒风险：**

该POC代码的主要功能是从 `revshells.com` 下载一个反弹shell脚本并执行，代码比较简单，逻辑清晰。风险点在于revshells.com提供的脚本可能被篡改,导致漏洞利用失败或植入恶意代码,如果revshells.com被攻击，脚本存在被替换的风险。虽然作者 Divine Clown 进行了优化，但代码结构并没有改变。

*   **脚本来源风险：**`revshells.com`的脚本有一定的不可控性，如果该网站被入侵，可能导致下载恶意脚本。
*   **代码混淆的风险：** 虽然脚本本身未发现明显混淆，但不排除Divine Clown在完善脚本时插入恶意代码。 但是readme.md中做了相关免责声明,降低了作者植入恶意代码的概率.

综合考虑，投毒风险较低，大约为5%。

**利用方式：**

1.  **准备：** 攻击者需要准备一个具有公网IP的服务器，并确保服务器上的指定端口未被占用。
2.  **反弹Shell生成：** 使用提供的脚本，指定攻击者的IP地址和端口，脚本会自动从`revshells.com`生成一个反弹shell的PHP脚本。
3.  **文件上传：** 脚本通过POST请求，将反弹shell的PHP脚本上传到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。
4.  **触发反弹Shell：** 脚本通过访问上传的PHP脚本的URL，触发反弹shell。
5.  **建立连接：** 攻击者在自己的服务器上使用Netcat监听指定的端口，等待目标服务器的反弹shell连接。

总而言之，攻击者利用Chamilo LMS中不设限的文件上传漏洞，上传并执行恶意PHP脚本，从而获得目标服务器的控制权。

**项目地址:** [0xDTC/Chamilo-LMS-CVE-2023-4220-Exploit](https://github.com/0xDTC/Chamilo-LMS-CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #3

**来源**: [CVE-2023-4220-Al3xGD_CVE-2023-4220-Exploit.md](../2023/CVE-2023-4220-Al3xGD_CVE-2023-4220-Exploit.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行受影响版本的Chamilo LMS，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 是 Chamilo LMS 1.11.24 及更早版本中的一个漏洞，允许未经身份验证的攻击者通过 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 中的大文件上传功能上传任意文件，从而导致远程代码执行。 

**有效性：**
提供的POC代码利用了该漏洞，通过POST请求上传一个名为`shell.php`的webshell到服务器，然后通过GET请求访问该webshell执行任意命令。

**投毒风险：**
分析提供的文件：
* `README.md`: 描述了漏洞和利用方法。
* `exploit.py`:  主要的利用脚本，用于上传 webshell 并执行命令。该脚本首先上传 `shell.php` 文件，然后通过 GET 请求向 `shell.php` 传递 `cmd` 参数来执行命令。 这个脚本功能明确，没有发现隐藏的恶意代码。
* `shell.php`:  一个简单的 webshell，接收 `cmd` 参数并通过 `system()` 函数执行。这是一个典型的 webshell，但本身并**不**构成投毒，而是漏洞利用的一部分。
由于`exploit.py`和`shell.php`的代码功能都比较直接，目的是上传webshell并执行命令，没有发现额外的恶意行为，因此投毒风险很低。

**利用方式：**
1.  攻击者首先需要找到一个运行着 Chamilo LMS 1.11.24 或更早版本的服务器。
2.  攻击者运行`exploit.py`脚本，指定目标URL。
3.  `exploit.py`脚本会上传一个名为`shell.php`的webshell到`/main/inc/lib/javascript/bigupload/files/`目录。
4.  脚本验证webshell是否成功上传。
5.  攻击者可以通过访问`shell.php`并传递`cmd`参数来执行任意系统命令。

**优先级排序：**
搜索引擎结果强调了未授权的RCE，漏洞利用代码提供了具体的利用方式，漏洞库信息提供了漏洞的详细描述和受影响的版本。

**项目地址:** [Al3xGD/CVE-2023-4220-Exploit](https://github.com/Al3xGD/CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #4

**来源**: [CVE-2023-4220-B1TC0R3_CVE-2023-4220-PoC.md](../2023/CVE-2023-4220-B1TC0R3_CVE-2023-4220-PoC.md)

# CVE-2023-4220

> 📦 该CVE有 **25** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-4220-0x00-null_Chamilo-CVE-2023-4220-RCE-Exploit.md](../2023/CVE-2023-4220-0x00-null_Chamilo-CVE-2023-4220-RCE-Exploit.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以通过上传恶意文件执行任意代码。

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，且未应用补丁。攻击者需要能够访问目标系统的网络。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 漏洞存在于 Chamilo LMS 的 bigUpload.php 文件中，允许未经身份验证的攻击者上传任意文件，包括 webshell。根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为高危，攻击者可以利用此漏洞执行存储型跨站脚本攻击 (XSS) 并获得远程代码执行 (RCE) 权限。

**利用方式：**
1.  攻击者使用提供的 PoC 脚本 (exploit.py)。
2.  该脚本首先上传一个包含恶意 PHP 代码的 webshell 文件到目标 Chamilo LMS 系统的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径。
3.  上传成功后，攻击者可以通过访问上传的 webshell 文件，并传递 `cmd` 参数来执行任意系统命令。例如： `http://lms.target-site/main/inc/lib/javascript/bigupload/files/my_shell.php?cmd=id`
4.  PoC 脚本会显示命令执行的结果。

**有效性评估：**
根据PoC代码中的描述,该利用代码经验证有效，可以实现未经身份验证的远程代码执行。

**投毒风险分析：**
查看PoC代码，主要功能为上传webshell并执行命令。虽然存在远程代码执行的风险，但PoC本身的目的就是利用漏洞，所以不属于投毒代码。在LICENSE文件和README文件中没有发现恶意代码，根据作者以前的项目, 判断此仓库中作者隐藏的投毒代码可能性较低。因此，投毒风险较低，评估为1%。

**项目地址:** [0x00-null/Chamilo-CVE-2023-4220-RCE-Exploit](https://github.com/0x00-null/Chamilo-CVE-2023-4220-RCE-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #2

**来源**: [CVE-2023-4220-0xDTC_Chamilo-LMS-CVE-2023-4220-Exploit.md](../2023/CVE-2023-4220-0xDTC_Chamilo-LMS-CVE-2023-4220-Exploit.md)

## CVE-2023-4220-Chamilo LMS-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致完全控制服务器

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行受影响版本的Chamilo LMS，且攻击者能够通过网络访问该系统

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 是 Chamilo LMS <= v1.11.24 中的一个远程代码执行漏洞。该漏洞源于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中的不设限的文件上传功能。攻击者可以上传恶意文件（例如 webshell），从而执行任意代码。

**有效性：**

根据漏洞描述、搜索结果和提供的POC代码，此漏洞利用是有效的。多个来源确认了该漏洞的存在和可利用性，POC代码也提供了利用该漏洞的脚本。

**投毒风险：**

该POC代码的主要功能是从 `revshells.com` 下载一个反弹shell脚本并执行，代码比较简单，逻辑清晰。风险点在于revshells.com提供的脚本可能被篡改,导致漏洞利用失败或植入恶意代码,如果revshells.com被攻击，脚本存在被替换的风险。虽然作者 Divine Clown 进行了优化，但代码结构并没有改变。

*   **脚本来源风险：**`revshells.com`的脚本有一定的不可控性，如果该网站被入侵，可能导致下载恶意脚本。
*   **代码混淆的风险：** 虽然脚本本身未发现明显混淆，但不排除Divine Clown在完善脚本时插入恶意代码。 但是readme.md中做了相关免责声明,降低了作者植入恶意代码的概率.

综合考虑，投毒风险较低，大约为5%。

**利用方式：**

1.  **准备：** 攻击者需要准备一个具有公网IP的服务器，并确保服务器上的指定端口未被占用。
2.  **反弹Shell生成：** 使用提供的脚本，指定攻击者的IP地址和端口，脚本会自动从`revshells.com`生成一个反弹shell的PHP脚本。
3.  **文件上传：** 脚本通过POST请求，将反弹shell的PHP脚本上传到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。
4.  **触发反弹Shell：** 脚本通过访问上传的PHP脚本的URL，触发反弹shell。
5.  **建立连接：** 攻击者在自己的服务器上使用Netcat监听指定的端口，等待目标服务器的反弹shell连接。

总而言之，攻击者利用Chamilo LMS中不设限的文件上传漏洞，上传并执行恶意PHP脚本，从而获得目标服务器的控制权。

**项目地址:** [0xDTC/Chamilo-LMS-CVE-2023-4220-Exploit](https://github.com/0xDTC/Chamilo-LMS-CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #3

**来源**: [CVE-2023-4220-Al3xGD_CVE-2023-4220-Exploit.md](../2023/CVE-2023-4220-Al3xGD_CVE-2023-4220-Exploit.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行受影响版本的Chamilo LMS，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 是 Chamilo LMS 1.11.24 及更早版本中的一个漏洞，允许未经身份验证的攻击者通过 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 中的大文件上传功能上传任意文件，从而导致远程代码执行。 

**有效性：**
提供的POC代码利用了该漏洞，通过POST请求上传一个名为`shell.php`的webshell到服务器，然后通过GET请求访问该webshell执行任意命令。

**投毒风险：**
分析提供的文件：
* `README.md`: 描述了漏洞和利用方法。
* `exploit.py`:  主要的利用脚本，用于上传 webshell 并执行命令。该脚本首先上传 `shell.php` 文件，然后通过 GET 请求向 `shell.php` 传递 `cmd` 参数来执行命令。 这个脚本功能明确，没有发现隐藏的恶意代码。
* `shell.php`:  一个简单的 webshell，接收 `cmd` 参数并通过 `system()` 函数执行。这是一个典型的 webshell，但本身并**不**构成投毒，而是漏洞利用的一部分。
由于`exploit.py`和`shell.php`的代码功能都比较直接，目的是上传webshell并执行命令，没有发现额外的恶意行为，因此投毒风险很低。

**利用方式：**
1.  攻击者首先需要找到一个运行着 Chamilo LMS 1.11.24 或更早版本的服务器。
2.  攻击者运行`exploit.py`脚本，指定目标URL。
3.  `exploit.py`脚本会上传一个名为`shell.php`的webshell到`/main/inc/lib/javascript/bigupload/files/`目录。
4.  脚本验证webshell是否成功上传。
5.  攻击者可以通过访问`shell.php`并传递`cmd`参数来执行任意系统命令。

**优先级排序：**
搜索引擎结果强调了未授权的RCE，漏洞利用代码提供了具体的利用方式，漏洞库信息提供了漏洞的详细描述和受影响的版本。

**项目地址:** [Al3xGD/CVE-2023-4220-Exploit](https://github.com/Al3xGD/CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #4

**来源**: [CVE-2023-4220-B1TC0R3_CVE-2023-4220-PoC.md](../2023/CVE-2023-4220-B1TC0R3_CVE-2023-4220-PoC.md)

# CVE-2023-4220

> 📦 该CVE有 **25** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-4220-0x00-null_Chamilo-CVE-2023-4220-RCE-Exploit.md](../2023/CVE-2023-4220-0x00-null_Chamilo-CVE-2023-4220-RCE-Exploit.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以通过上传恶意文件执行任意代码。

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，且未应用补丁。攻击者需要能够访问目标系统的网络。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 漏洞存在于 Chamilo LMS 的 bigUpload.php 文件中，允许未经身份验证的攻击者上传任意文件，包括 webshell。根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为高危，攻击者可以利用此漏洞执行存储型跨站脚本攻击 (XSS) 并获得远程代码执行 (RCE) 权限。

**利用方式：**
1.  攻击者使用提供的 PoC 脚本 (exploit.py)。
2.  该脚本首先上传一个包含恶意 PHP 代码的 webshell 文件到目标 Chamilo LMS 系统的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径。
3.  上传成功后，攻击者可以通过访问上传的 webshell 文件，并传递 `cmd` 参数来执行任意系统命令。例如： `http://lms.target-site/main/inc/lib/javascript/bigupload/files/my_shell.php?cmd=id`
4.  PoC 脚本会显示命令执行的结果。

**有效性评估：**
根据PoC代码中的描述,该利用代码经验证有效，可以实现未经身份验证的远程代码执行。

**投毒风险分析：**
查看PoC代码，主要功能为上传webshell并执行命令。虽然存在远程代码执行的风险，但PoC本身的目的就是利用漏洞，所以不属于投毒代码。在LICENSE文件和README文件中没有发现恶意代码，根据作者以前的项目, 判断此仓库中作者隐藏的投毒代码可能性较低。因此，投毒风险较低，评估为1%。

**项目地址:** [0x00-null/Chamilo-CVE-2023-4220-RCE-Exploit](https://github.com/0x00-null/Chamilo-CVE-2023-4220-RCE-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #2

**来源**: [CVE-2023-4220-0xDTC_Chamilo-LMS-CVE-2023-4220-Exploit.md](../2023/CVE-2023-4220-0xDTC_Chamilo-LMS-CVE-2023-4220-Exploit.md)

## CVE-2023-4220-Chamilo LMS-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致完全控制服务器

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行受影响版本的Chamilo LMS，且攻击者能够通过网络访问该系统

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 是 Chamilo LMS <= v1.11.24 中的一个远程代码执行漏洞。该漏洞源于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中的不设限的文件上传功能。攻击者可以上传恶意文件（例如 webshell），从而执行任意代码。

**有效性：**

根据漏洞描述、搜索结果和提供的POC代码，此漏洞利用是有效的。多个来源确认了该漏洞的存在和可利用性，POC代码也提供了利用该漏洞的脚本。

**投毒风险：**

该POC代码的主要功能是从 `revshells.com` 下载一个反弹shell脚本并执行，代码比较简单，逻辑清晰。风险点在于revshells.com提供的脚本可能被篡改,导致漏洞利用失败或植入恶意代码,如果revshells.com被攻击，脚本存在被替换的风险。虽然作者 Divine Clown 进行了优化，但代码结构并没有改变。

*   **脚本来源风险：**`revshells.com`的脚本有一定的不可控性，如果该网站被入侵，可能导致下载恶意脚本。
*   **代码混淆的风险：** 虽然脚本本身未发现明显混淆，但不排除Divine Clown在完善脚本时插入恶意代码。 但是readme.md中做了相关免责声明,降低了作者植入恶意代码的概率.

综合考虑，投毒风险较低，大约为5%。

**利用方式：**

1.  **准备：** 攻击者需要准备一个具有公网IP的服务器，并确保服务器上的指定端口未被占用。
2.  **反弹Shell生成：** 使用提供的脚本，指定攻击者的IP地址和端口，脚本会自动从`revshells.com`生成一个反弹shell的PHP脚本。
3.  **文件上传：** 脚本通过POST请求，将反弹shell的PHP脚本上传到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。
4.  **触发反弹Shell：** 脚本通过访问上传的PHP脚本的URL，触发反弹shell。
5.  **建立连接：** 攻击者在自己的服务器上使用Netcat监听指定的端口，等待目标服务器的反弹shell连接。

总而言之，攻击者利用Chamilo LMS中不设限的文件上传漏洞，上传并执行恶意PHP脚本，从而获得目标服务器的控制权。

**项目地址:** [0xDTC/Chamilo-LMS-CVE-2023-4220-Exploit](https://github.com/0xDTC/Chamilo-LMS-CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #3

**来源**: [CVE-2023-4220-Al3xGD_CVE-2023-4220-Exploit.md](../2023/CVE-2023-4220-Al3xGD_CVE-2023-4220-Exploit.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行受影响版本的Chamilo LMS，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 是 Chamilo LMS 1.11.24 及更早版本中的一个漏洞，允许未经身份验证的攻击者通过 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 中的大文件上传功能上传任意文件，从而导致远程代码执行。 

**有效性：**
提供的POC代码利用了该漏洞，通过POST请求上传一个名为`shell.php`的webshell到服务器，然后通过GET请求访问该webshell执行任意命令。

**投毒风险：**
分析提供的文件：
* `README.md`: 描述了漏洞和利用方法。
* `exploit.py`:  主要的利用脚本，用于上传 webshell 并执行命令。该脚本首先上传 `shell.php` 文件，然后通过 GET 请求向 `shell.php` 传递 `cmd` 参数来执行命令。 这个脚本功能明确，没有发现隐藏的恶意代码。
* `shell.php`:  一个简单的 webshell，接收 `cmd` 参数并通过 `system()` 函数执行。这是一个典型的 webshell，但本身并**不**构成投毒，而是漏洞利用的一部分。
由于`exploit.py`和`shell.php`的代码功能都比较直接，目的是上传webshell并执行命令，没有发现额外的恶意行为，因此投毒风险很低。

**利用方式：**
1.  攻击者首先需要找到一个运行着 Chamilo LMS 1.11.24 或更早版本的服务器。
2.  攻击者运行`exploit.py`脚本，指定目标URL。
3.  `exploit.py`脚本会上传一个名为`shell.php`的webshell到`/main/inc/lib/javascript/bigupload/files/`目录。
4.  脚本验证webshell是否成功上传。
5.  攻击者可以通过访问`shell.php`并传递`cmd`参数来执行任意系统命令。

**优先级排序：**
搜索引擎结果强调了未授权的RCE，漏洞利用代码提供了具体的利用方式，漏洞库信息提供了漏洞的详细描述和受影响的版本。

**项目地址:** [Al3xGD/CVE-2023-4220-Exploit](https://github.com/Al3xGD/CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #4

**来源**: [CVE-2023-4220-B1TC0R3_CVE-2023-4220-PoC.md](../2023/CVE-2023-4220-B1TC0R3_CVE-2023-4220-PoC.md)

# CVE-2023-4220

> 📦 该CVE有 **25** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-4220-0x00-null_Chamilo-CVE-2023-4220-RCE-Exploit.md](../2023/CVE-2023-4220-0x00-null_Chamilo-CVE-2023-4220-RCE-Exploit.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以通过上传恶意文件执行任意代码。

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，且未应用补丁。攻击者需要能够访问目标系统的网络。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 漏洞存在于 Chamilo LMS 的 bigUpload.php 文件中，允许未经身份验证的攻击者上传任意文件，包括 webshell。根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为高危，攻击者可以利用此漏洞执行存储型跨站脚本攻击 (XSS) 并获得远程代码执行 (RCE) 权限。

**利用方式：**
1.  攻击者使用提供的 PoC 脚本 (exploit.py)。
2.  该脚本首先上传一个包含恶意 PHP 代码的 webshell 文件到目标 Chamilo LMS 系统的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径。
3.  上传成功后，攻击者可以通过访问上传的 webshell 文件，并传递 `cmd` 参数来执行任意系统命令。例如： `http://lms.target-site/main/inc/lib/javascript/bigupload/files/my_shell.php?cmd=id`
4.  PoC 脚本会显示命令执行的结果。

**有效性评估：**
根据PoC代码中的描述,该利用代码经验证有效，可以实现未经身份验证的远程代码执行。

**投毒风险分析：**
查看PoC代码，主要功能为上传webshell并执行命令。虽然存在远程代码执行的风险，但PoC本身的目的就是利用漏洞，所以不属于投毒代码。在LICENSE文件和README文件中没有发现恶意代码，根据作者以前的项目, 判断此仓库中作者隐藏的投毒代码可能性较低。因此，投毒风险较低，评估为1%。

**项目地址:** [0x00-null/Chamilo-CVE-2023-4220-RCE-Exploit](https://github.com/0x00-null/Chamilo-CVE-2023-4220-RCE-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #2

**来源**: [CVE-2023-4220-0xDTC_Chamilo-LMS-CVE-2023-4220-Exploit.md](../2023/CVE-2023-4220-0xDTC_Chamilo-LMS-CVE-2023-4220-Exploit.md)

## CVE-2023-4220-Chamilo LMS-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致完全控制服务器

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行受影响版本的Chamilo LMS，且攻击者能够通过网络访问该系统

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 是 Chamilo LMS <= v1.11.24 中的一个远程代码执行漏洞。该漏洞源于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中的不设限的文件上传功能。攻击者可以上传恶意文件（例如 webshell），从而执行任意代码。

**有效性：**

根据漏洞描述、搜索结果和提供的POC代码，此漏洞利用是有效的。多个来源确认了该漏洞的存在和可利用性，POC代码也提供了利用该漏洞的脚本。

**投毒风险：**

该POC代码的主要功能是从 `revshells.com` 下载一个反弹shell脚本并执行，代码比较简单，逻辑清晰。风险点在于revshells.com提供的脚本可能被篡改,导致漏洞利用失败或植入恶意代码,如果revshells.com被攻击，脚本存在被替换的风险。虽然作者 Divine Clown 进行了优化，但代码结构并没有改变。

*   **脚本来源风险：**`revshells.com`的脚本有一定的不可控性，如果该网站被入侵，可能导致下载恶意脚本。
*   **代码混淆的风险：** 虽然脚本本身未发现明显混淆，但不排除Divine Clown在完善脚本时插入恶意代码。 但是readme.md中做了相关免责声明,降低了作者植入恶意代码的概率.

综合考虑，投毒风险较低，大约为5%。

**利用方式：**

1.  **准备：** 攻击者需要准备一个具有公网IP的服务器，并确保服务器上的指定端口未被占用。
2.  **反弹Shell生成：** 使用提供的脚本，指定攻击者的IP地址和端口，脚本会自动从`revshells.com`生成一个反弹shell的PHP脚本。
3.  **文件上传：** 脚本通过POST请求，将反弹shell的PHP脚本上传到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。
4.  **触发反弹Shell：** 脚本通过访问上传的PHP脚本的URL，触发反弹shell。
5.  **建立连接：** 攻击者在自己的服务器上使用Netcat监听指定的端口，等待目标服务器的反弹shell连接。

总而言之，攻击者利用Chamilo LMS中不设限的文件上传漏洞，上传并执行恶意PHP脚本，从而获得目标服务器的控制权。

**项目地址:** [0xDTC/Chamilo-LMS-CVE-2023-4220-Exploit](https://github.com/0xDTC/Chamilo-LMS-CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #3

**来源**: [CVE-2023-4220-Al3xGD_CVE-2023-4220-Exploit.md](../2023/CVE-2023-4220-Al3xGD_CVE-2023-4220-Exploit.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行受影响版本的Chamilo LMS，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 是 Chamilo LMS 1.11.24 及更早版本中的一个漏洞，允许未经身份验证的攻击者通过 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 中的大文件上传功能上传任意文件，从而导致远程代码执行。 

**有效性：**
提供的POC代码利用了该漏洞，通过POST请求上传一个名为`shell.php`的webshell到服务器，然后通过GET请求访问该webshell执行任意命令。

**投毒风险：**
分析提供的文件：
* `README.md`: 描述了漏洞和利用方法。
* `exploit.py`:  主要的利用脚本，用于上传 webshell 并执行命令。该脚本首先上传 `shell.php` 文件，然后通过 GET 请求向 `shell.php` 传递 `cmd` 参数来执行命令。 这个脚本功能明确，没有发现隐藏的恶意代码。
* `shell.php`:  一个简单的 webshell，接收 `cmd` 参数并通过 `system()` 函数执行。这是一个典型的 webshell，但本身并**不**构成投毒，而是漏洞利用的一部分。
由于`exploit.py`和`shell.php`的代码功能都比较直接，目的是上传webshell并执行命令，没有发现额外的恶意行为，因此投毒风险很低。

**利用方式：**
1.  攻击者首先需要找到一个运行着 Chamilo LMS 1.11.24 或更早版本的服务器。
2.  攻击者运行`exploit.py`脚本，指定目标URL。
3.  `exploit.py`脚本会上传一个名为`shell.php`的webshell到`/main/inc/lib/javascript/bigupload/files/`目录。
4.  脚本验证webshell是否成功上传。
5.  攻击者可以通过访问`shell.php`并传递`cmd`参数来执行任意系统命令。

**优先级排序：**
搜索引擎结果强调了未授权的RCE，漏洞利用代码提供了具体的利用方式，漏洞库信息提供了漏洞的详细描述和受影响的版本。

**项目地址:** [Al3xGD/CVE-2023-4220-Exploit](https://github.com/Al3xGD/CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #4

**来源**: [CVE-2023-4220-B1TC0R3_CVE-2023-4220-PoC.md](../2023/CVE-2023-4220-B1TC0R3_CVE-2023-4220-PoC.md)

# CVE-2023-4220

> 📦 该CVE有 **25** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-4220-0x00-null_Chamilo-CVE-2023-4220-RCE-Exploit.md](../2023/CVE-2023-4220-0x00-null_Chamilo-CVE-2023-4220-RCE-Exploit.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以通过上传恶意文件执行任意代码。

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，且未应用补丁。攻击者需要能够访问目标系统的网络。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 漏洞存在于 Chamilo LMS 的 bigUpload.php 文件中，允许未经身份验证的攻击者上传任意文件，包括 webshell。根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为高危，攻击者可以利用此漏洞执行存储型跨站脚本攻击 (XSS) 并获得远程代码执行 (RCE) 权限。

**利用方式：**
1.  攻击者使用提供的 PoC 脚本 (exploit.py)。
2.  该脚本首先上传一个包含恶意 PHP 代码的 webshell 文件到目标 Chamilo LMS 系统的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径。
3.  上传成功后，攻击者可以通过访问上传的 webshell 文件，并传递 `cmd` 参数来执行任意系统命令。例如： `http://lms.target-site/main/inc/lib/javascript/bigupload/files/my_shell.php?cmd=id`
4.  PoC 脚本会显示命令执行的结果。

**有效性评估：**
根据PoC代码中的描述,该利用代码经验证有效，可以实现未经身份验证的远程代码执行。

**投毒风险分析：**
查看PoC代码，主要功能为上传webshell并执行命令。虽然存在远程代码执行的风险，但PoC本身的目的就是利用漏洞，所以不属于投毒代码。在LICENSE文件和README文件中没有发现恶意代码，根据作者以前的项目, 判断此仓库中作者隐藏的投毒代码可能性较低。因此，投毒风险较低，评估为1%。

**项目地址:** [0x00-null/Chamilo-CVE-2023-4220-RCE-Exploit](https://github.com/0x00-null/Chamilo-CVE-2023-4220-RCE-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #2

**来源**: [CVE-2023-4220-0xDTC_Chamilo-LMS-CVE-2023-4220-Exploit.md](../2023/CVE-2023-4220-0xDTC_Chamilo-LMS-CVE-2023-4220-Exploit.md)

## CVE-2023-4220-Chamilo LMS-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致完全控制服务器

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行受影响版本的Chamilo LMS，且攻击者能够通过网络访问该系统

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 是 Chamilo LMS <= v1.11.24 中的一个远程代码执行漏洞。该漏洞源于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中的不设限的文件上传功能。攻击者可以上传恶意文件（例如 webshell），从而执行任意代码。

**有效性：**

根据漏洞描述、搜索结果和提供的POC代码，此漏洞利用是有效的。多个来源确认了该漏洞的存在和可利用性，POC代码也提供了利用该漏洞的脚本。

**投毒风险：**

该POC代码的主要功能是从 `revshells.com` 下载一个反弹shell脚本并执行，代码比较简单，逻辑清晰。风险点在于revshells.com提供的脚本可能被篡改,导致漏洞利用失败或植入恶意代码,如果revshells.com被攻击，脚本存在被替换的风险。虽然作者 Divine Clown 进行了优化，但代码结构并没有改变。

*   **脚本来源风险：**`revshells.com`的脚本有一定的不可控性，如果该网站被入侵，可能导致下载恶意脚本。
*   **代码混淆的风险：** 虽然脚本本身未发现明显混淆，但不排除Divine Clown在完善脚本时插入恶意代码。 但是readme.md中做了相关免责声明,降低了作者植入恶意代码的概率.

综合考虑，投毒风险较低，大约为5%。

**利用方式：**

1.  **准备：** 攻击者需要准备一个具有公网IP的服务器，并确保服务器上的指定端口未被占用。
2.  **反弹Shell生成：** 使用提供的脚本，指定攻击者的IP地址和端口，脚本会自动从`revshells.com`生成一个反弹shell的PHP脚本。
3.  **文件上传：** 脚本通过POST请求，将反弹shell的PHP脚本上传到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。
4.  **触发反弹Shell：** 脚本通过访问上传的PHP脚本的URL，触发反弹shell。
5.  **建立连接：** 攻击者在自己的服务器上使用Netcat监听指定的端口，等待目标服务器的反弹shell连接。

总而言之，攻击者利用Chamilo LMS中不设限的文件上传漏洞，上传并执行恶意PHP脚本，从而获得目标服务器的控制权。

**项目地址:** [0xDTC/Chamilo-LMS-CVE-2023-4220-Exploit](https://github.com/0xDTC/Chamilo-LMS-CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #3

**来源**: [CVE-2023-4220-Al3xGD_CVE-2023-4220-Exploit.md](../2023/CVE-2023-4220-Al3xGD_CVE-2023-4220-Exploit.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行受影响版本的Chamilo LMS，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 是 Chamilo LMS 1.11.24 及更早版本中的一个漏洞，允许未经身份验证的攻击者通过 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 中的大文件上传功能上传任意文件，从而导致远程代码执行。 

**有效性：**
提供的POC代码利用了该漏洞，通过POST请求上传一个名为`shell.php`的webshell到服务器，然后通过GET请求访问该webshell执行任意命令。

**投毒风险：**
分析提供的文件：
* `README.md`: 描述了漏洞和利用方法。
* `exploit.py`:  主要的利用脚本，用于上传 webshell 并执行命令。该脚本首先上传 `shell.php` 文件，然后通过 GET 请求向 `shell.php` 传递 `cmd` 参数来执行命令。 这个脚本功能明确，没有发现隐藏的恶意代码。
* `shell.php`:  一个简单的 webshell，接收 `cmd` 参数并通过 `system()` 函数执行。这是一个典型的 webshell，但本身并**不**构成投毒，而是漏洞利用的一部分。
由于`exploit.py`和`shell.php`的代码功能都比较直接，目的是上传webshell并执行命令，没有发现额外的恶意行为，因此投毒风险很低。

**利用方式：**
1.  攻击者首先需要找到一个运行着 Chamilo LMS 1.11.24 或更早版本的服务器。
2.  攻击者运行`exploit.py`脚本，指定目标URL。
3.  `exploit.py`脚本会上传一个名为`shell.php`的webshell到`/main/inc/lib/javascript/bigupload/files/`目录。
4.  脚本验证webshell是否成功上传。
5.  攻击者可以通过访问`shell.php`并传递`cmd`参数来执行任意系统命令。

**优先级排序：**
搜索引擎结果强调了未授权的RCE，漏洞利用代码提供了具体的利用方式，漏洞库信息提供了漏洞的详细描述和受影响的版本。

**项目地址:** [Al3xGD/CVE-2023-4220-Exploit](https://github.com/Al3xGD/CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #4

**来源**: [CVE-2023-4220-B1TC0R3_CVE-2023-4220-PoC.md](../2023/CVE-2023-4220-B1TC0R3_CVE-2023-4220-PoC.md)

# CVE-2023-4220

> 📦 该CVE有 **25** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-4220-0x00-null_Chamilo-CVE-2023-4220-RCE-Exploit.md](../2023/CVE-2023-4220-0x00-null_Chamilo-CVE-2023-4220-RCE-Exploit.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以通过上传恶意文件执行任意代码。

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，且未应用补丁。攻击者需要能够访问目标系统的网络。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 漏洞存在于 Chamilo LMS 的 bigUpload.php 文件中，允许未经身份验证的攻击者上传任意文件，包括 webshell。根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为高危，攻击者可以利用此漏洞执行存储型跨站脚本攻击 (XSS) 并获得远程代码执行 (RCE) 权限。

**利用方式：**
1.  攻击者使用提供的 PoC 脚本 (exploit.py)。
2.  该脚本首先上传一个包含恶意 PHP 代码的 webshell 文件到目标 Chamilo LMS 系统的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径。
3.  上传成功后，攻击者可以通过访问上传的 webshell 文件，并传递 `cmd` 参数来执行任意系统命令。例如： `http://lms.target-site/main/inc/lib/javascript/bigupload/files/my_shell.php?cmd=id`
4.  PoC 脚本会显示命令执行的结果。

**有效性评估：**
根据PoC代码中的描述,该利用代码经验证有效，可以实现未经身份验证的远程代码执行。

**投毒风险分析：**
查看PoC代码，主要功能为上传webshell并执行命令。虽然存在远程代码执行的风险，但PoC本身的目的就是利用漏洞，所以不属于投毒代码。在LICENSE文件和README文件中没有发现恶意代码，根据作者以前的项目, 判断此仓库中作者隐藏的投毒代码可能性较低。因此，投毒风险较低，评估为1%。

**项目地址:** [0x00-null/Chamilo-CVE-2023-4220-RCE-Exploit](https://github.com/0x00-null/Chamilo-CVE-2023-4220-RCE-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #2

**来源**: [CVE-2023-4220-0xDTC_Chamilo-LMS-CVE-2023-4220-Exploit.md](../2023/CVE-2023-4220-0xDTC_Chamilo-LMS-CVE-2023-4220-Exploit.md)

## CVE-2023-4220-Chamilo LMS-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致完全控制服务器

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行受影响版本的Chamilo LMS，且攻击者能够通过网络访问该系统

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 是 Chamilo LMS <= v1.11.24 中的一个远程代码执行漏洞。该漏洞源于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中的不设限的文件上传功能。攻击者可以上传恶意文件（例如 webshell），从而执行任意代码。

**有效性：**

根据漏洞描述、搜索结果和提供的POC代码，此漏洞利用是有效的。多个来源确认了该漏洞的存在和可利用性，POC代码也提供了利用该漏洞的脚本。

**投毒风险：**

该POC代码的主要功能是从 `revshells.com` 下载一个反弹shell脚本并执行，代码比较简单，逻辑清晰。风险点在于revshells.com提供的脚本可能被篡改,导致漏洞利用失败或植入恶意代码,如果revshells.com被攻击，脚本存在被替换的风险。虽然作者 Divine Clown 进行了优化，但代码结构并没有改变。

*   **脚本来源风险：**`revshells.com`的脚本有一定的不可控性，如果该网站被入侵，可能导致下载恶意脚本。
*   **代码混淆的风险：** 虽然脚本本身未发现明显混淆，但不排除Divine Clown在完善脚本时插入恶意代码。 但是readme.md中做了相关免责声明,降低了作者植入恶意代码的概率.

综合考虑，投毒风险较低，大约为5%。

**利用方式：**

1.  **准备：** 攻击者需要准备一个具有公网IP的服务器，并确保服务器上的指定端口未被占用。
2.  **反弹Shell生成：** 使用提供的脚本，指定攻击者的IP地址和端口，脚本会自动从`revshells.com`生成一个反弹shell的PHP脚本。
3.  **文件上传：** 脚本通过POST请求，将反弹shell的PHP脚本上传到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。
4.  **触发反弹Shell：** 脚本通过访问上传的PHP脚本的URL，触发反弹shell。
5.  **建立连接：** 攻击者在自己的服务器上使用Netcat监听指定的端口，等待目标服务器的反弹shell连接。

总而言之，攻击者利用Chamilo LMS中不设限的文件上传漏洞，上传并执行恶意PHP脚本，从而获得目标服务器的控制权。

**项目地址:** [0xDTC/Chamilo-LMS-CVE-2023-4220-Exploit](https://github.com/0xDTC/Chamilo-LMS-CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #3

**来源**: [CVE-2023-4220-Al3xGD_CVE-2023-4220-Exploit.md](../2023/CVE-2023-4220-Al3xGD_CVE-2023-4220-Exploit.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行受影响版本的Chamilo LMS，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 是 Chamilo LMS 1.11.24 及更早版本中的一个漏洞，允许未经身份验证的攻击者通过 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 中的大文件上传功能上传任意文件，从而导致远程代码执行。 

**有效性：**
提供的POC代码利用了该漏洞，通过POST请求上传一个名为`shell.php`的webshell到服务器，然后通过GET请求访问该webshell执行任意命令。

**投毒风险：**
分析提供的文件：
* `README.md`: 描述了漏洞和利用方法。
* `exploit.py`:  主要的利用脚本，用于上传 webshell 并执行命令。该脚本首先上传 `shell.php` 文件，然后通过 GET 请求向 `shell.php` 传递 `cmd` 参数来执行命令。 这个脚本功能明确，没有发现隐藏的恶意代码。
* `shell.php`:  一个简单的 webshell，接收 `cmd` 参数并通过 `system()` 函数执行。这是一个典型的 webshell，但本身并**不**构成投毒，而是漏洞利用的一部分。
由于`exploit.py`和`shell.php`的代码功能都比较直接，目的是上传webshell并执行命令，没有发现额外的恶意行为，因此投毒风险很低。

**利用方式：**
1.  攻击者首先需要找到一个运行着 Chamilo LMS 1.11.24 或更早版本的服务器。
2.  攻击者运行`exploit.py`脚本，指定目标URL。
3.  `exploit.py`脚本会上传一个名为`shell.php`的webshell到`/main/inc/lib/javascript/bigupload/files/`目录。
4.  脚本验证webshell是否成功上传。
5.  攻击者可以通过访问`shell.php`并传递`cmd`参数来执行任意系统命令。

**优先级排序：**
搜索引擎结果强调了未授权的RCE，漏洞利用代码提供了具体的利用方式，漏洞库信息提供了漏洞的详细描述和受影响的版本。

**项目地址:** [Al3xGD/CVE-2023-4220-Exploit](https://github.com/Al3xGD/CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #4

**来源**: [CVE-2023-4220-B1TC0R3_CVE-2023-4220-PoC.md](../2023/CVE-2023-4220-B1TC0R3_CVE-2023-4220-PoC.md)

# CVE-2023-4220

> 📦 该CVE有 **25** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-4220-0x00-null_Chamilo-CVE-2023-4220-RCE-Exploit.md](../2023/CVE-2023-4220-0x00-null_Chamilo-CVE-2023-4220-RCE-Exploit.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以通过上传恶意文件执行任意代码。

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，且未应用补丁。攻击者需要能够访问目标系统的网络。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 漏洞存在于 Chamilo LMS 的 bigUpload.php 文件中，允许未经身份验证的攻击者上传任意文件，包括 webshell。根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为高危，攻击者可以利用此漏洞执行存储型跨站脚本攻击 (XSS) 并获得远程代码执行 (RCE) 权限。

**利用方式：**
1.  攻击者使用提供的 PoC 脚本 (exploit.py)。
2.  该脚本首先上传一个包含恶意 PHP 代码的 webshell 文件到目标 Chamilo LMS 系统的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径。
3.  上传成功后，攻击者可以通过访问上传的 webshell 文件，并传递 `cmd` 参数来执行任意系统命令。例如： `http://lms.target-site/main/inc/lib/javascript/bigupload/files/my_shell.php?cmd=id`
4.  PoC 脚本会显示命令执行的结果。

**有效性评估：**
根据PoC代码中的描述,该利用代码经验证有效，可以实现未经身份验证的远程代码执行。

**投毒风险分析：**
查看PoC代码，主要功能为上传webshell并执行命令。虽然存在远程代码执行的风险，但PoC本身的目的就是利用漏洞，所以不属于投毒代码。在LICENSE文件和README文件中没有发现恶意代码，根据作者以前的项目, 判断此仓库中作者隐藏的投毒代码可能性较低。因此，投毒风险较低，评估为1%。

**项目地址:** [0x00-null/Chamilo-CVE-2023-4220-RCE-Exploit](https://github.com/0x00-null/Chamilo-CVE-2023-4220-RCE-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #2

**来源**: [CVE-2023-4220-0xDTC_Chamilo-LMS-CVE-2023-4220-Exploit.md](../2023/CVE-2023-4220-0xDTC_Chamilo-LMS-CVE-2023-4220-Exploit.md)

## CVE-2023-4220-Chamilo LMS-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致完全控制服务器

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行受影响版本的Chamilo LMS，且攻击者能够通过网络访问该系统

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 是 Chamilo LMS <= v1.11.24 中的一个远程代码执行漏洞。该漏洞源于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中的不设限的文件上传功能。攻击者可以上传恶意文件（例如 webshell），从而执行任意代码。

**有效性：**

根据漏洞描述、搜索结果和提供的POC代码，此漏洞利用是有效的。多个来源确认了该漏洞的存在和可利用性，POC代码也提供了利用该漏洞的脚本。

**投毒风险：**

该POC代码的主要功能是从 `revshells.com` 下载一个反弹shell脚本并执行，代码比较简单，逻辑清晰。风险点在于revshells.com提供的脚本可能被篡改,导致漏洞利用失败或植入恶意代码,如果revshells.com被攻击，脚本存在被替换的风险。虽然作者 Divine Clown 进行了优化，但代码结构并没有改变。

*   **脚本来源风险：**`revshells.com`的脚本有一定的不可控性，如果该网站被入侵，可能导致下载恶意脚本。
*   **代码混淆的风险：** 虽然脚本本身未发现明显混淆，但不排除Divine Clown在完善脚本时插入恶意代码。 但是readme.md中做了相关免责声明,降低了作者植入恶意代码的概率.

综合考虑，投毒风险较低，大约为5%。

**利用方式：**

1.  **准备：** 攻击者需要准备一个具有公网IP的服务器，并确保服务器上的指定端口未被占用。
2.  **反弹Shell生成：** 使用提供的脚本，指定攻击者的IP地址和端口，脚本会自动从`revshells.com`生成一个反弹shell的PHP脚本。
3.  **文件上传：** 脚本通过POST请求，将反弹shell的PHP脚本上传到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。
4.  **触发反弹Shell：** 脚本通过访问上传的PHP脚本的URL，触发反弹shell。
5.  **建立连接：** 攻击者在自己的服务器上使用Netcat监听指定的端口，等待目标服务器的反弹shell连接。

总而言之，攻击者利用Chamilo LMS中不设限的文件上传漏洞，上传并执行恶意PHP脚本，从而获得目标服务器的控制权。

**项目地址:** [0xDTC/Chamilo-LMS-CVE-2023-4220-Exploit](https://github.com/0xDTC/Chamilo-LMS-CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #3

**来源**: [CVE-2023-4220-Al3xGD_CVE-2023-4220-Exploit.md](../2023/CVE-2023-4220-Al3xGD_CVE-2023-4220-Exploit.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行受影响版本的Chamilo LMS，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 是 Chamilo LMS 1.11.24 及更早版本中的一个漏洞，允许未经身份验证的攻击者通过 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 中的大文件上传功能上传任意文件，从而导致远程代码执行。 

**有效性：**
提供的POC代码利用了该漏洞，通过POST请求上传一个名为`shell.php`的webshell到服务器，然后通过GET请求访问该webshell执行任意命令。

**投毒风险：**
分析提供的文件：
* `README.md`: 描述了漏洞和利用方法。
* `exploit.py`:  主要的利用脚本，用于上传 webshell 并执行命令。该脚本首先上传 `shell.php` 文件，然后通过 GET 请求向 `shell.php` 传递 `cmd` 参数来执行命令。 这个脚本功能明确，没有发现隐藏的恶意代码。
* `shell.php`:  一个简单的 webshell，接收 `cmd` 参数并通过 `system()` 函数执行。这是一个典型的 webshell，但本身并**不**构成投毒，而是漏洞利用的一部分。
由于`exploit.py`和`shell.php`的代码功能都比较直接，目的是上传webshell并执行命令，没有发现额外的恶意行为，因此投毒风险很低。

**利用方式：**
1.  攻击者首先需要找到一个运行着 Chamilo LMS 1.11.24 或更早版本的服务器。
2.  攻击者运行`exploit.py`脚本，指定目标URL。
3.  `exploit.py`脚本会上传一个名为`shell.php`的webshell到`/main/inc/lib/javascript/bigupload/files/`目录。
4.  脚本验证webshell是否成功上传。
5.  攻击者可以通过访问`shell.php`并传递`cmd`参数来执行任意系统命令。

**优先级排序：**
搜索引擎结果强调了未授权的RCE，漏洞利用代码提供了具体的利用方式，漏洞库信息提供了漏洞的详细描述和受影响的版本。

**项目地址:** [Al3xGD/CVE-2023-4220-Exploit](https://github.com/Al3xGD/CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #4

**来源**: [CVE-2023-4220-B1TC0R3_CVE-2023-4220-PoC.md](../2023/CVE-2023-4220-B1TC0R3_CVE-2023-4220-PoC.md)

# CVE-2023-4220

> 📦 该CVE有 **25** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-4220-0x00-null_Chamilo-CVE-2023-4220-RCE-Exploit.md](../2023/CVE-2023-4220-0x00-null_Chamilo-CVE-2023-4220-RCE-Exploit.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以通过上传恶意文件执行任意代码。

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，且未应用补丁。攻击者需要能够访问目标系统的网络。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 漏洞存在于 Chamilo LMS 的 bigUpload.php 文件中，允许未经身份验证的攻击者上传任意文件，包括 webshell。根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为高危，攻击者可以利用此漏洞执行存储型跨站脚本攻击 (XSS) 并获得远程代码执行 (RCE) 权限。

**利用方式：**
1.  攻击者使用提供的 PoC 脚本 (exploit.py)。
2.  该脚本首先上传一个包含恶意 PHP 代码的 webshell 文件到目标 Chamilo LMS 系统的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径。
3.  上传成功后，攻击者可以通过访问上传的 webshell 文件，并传递 `cmd` 参数来执行任意系统命令。例如： `http://lms.target-site/main/inc/lib/javascript/bigupload/files/my_shell.php?cmd=id`
4.  PoC 脚本会显示命令执行的结果。

**有效性评估：**
根据PoC代码中的描述,该利用代码经验证有效，可以实现未经身份验证的远程代码执行。

**投毒风险分析：**
查看PoC代码，主要功能为上传webshell并执行命令。虽然存在远程代码执行的风险，但PoC本身的目的就是利用漏洞，所以不属于投毒代码。在LICENSE文件和README文件中没有发现恶意代码，根据作者以前的项目, 判断此仓库中作者隐藏的投毒代码可能性较低。因此，投毒风险较低，评估为1%。

**项目地址:** [0x00-null/Chamilo-CVE-2023-4220-RCE-Exploit](https://github.com/0x00-null/Chamilo-CVE-2023-4220-RCE-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #2

**来源**: [CVE-2023-4220-0xDTC_Chamilo-LMS-CVE-2023-4220-Exploit.md](../2023/CVE-2023-4220-0xDTC_Chamilo-LMS-CVE-2023-4220-Exploit.md)

## CVE-2023-4220-Chamilo LMS-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致完全控制服务器

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行受影响版本的Chamilo LMS，且攻击者能够通过网络访问该系统

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 是 Chamilo LMS <= v1.11.24 中的一个远程代码执行漏洞。该漏洞源于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中的不设限的文件上传功能。攻击者可以上传恶意文件（例如 webshell），从而执行任意代码。

**有效性：**

根据漏洞描述、搜索结果和提供的POC代码，此漏洞利用是有效的。多个来源确认了该漏洞的存在和可利用性，POC代码也提供了利用该漏洞的脚本。

**投毒风险：**

该POC代码的主要功能是从 `revshells.com` 下载一个反弹shell脚本并执行，代码比较简单，逻辑清晰。风险点在于revshells.com提供的脚本可能被篡改,导致漏洞利用失败或植入恶意代码,如果revshells.com被攻击，脚本存在被替换的风险。虽然作者 Divine Clown 进行了优化，但代码结构并没有改变。

*   **脚本来源风险：**`revshells.com`的脚本有一定的不可控性，如果该网站被入侵，可能导致下载恶意脚本。
*   **代码混淆的风险：** 虽然脚本本身未发现明显混淆，但不排除Divine Clown在完善脚本时插入恶意代码。 但是readme.md中做了相关免责声明,降低了作者植入恶意代码的概率.

综合考虑，投毒风险较低，大约为5%。

**利用方式：**

1.  **准备：** 攻击者需要准备一个具有公网IP的服务器，并确保服务器上的指定端口未被占用。
2.  **反弹Shell生成：** 使用提供的脚本，指定攻击者的IP地址和端口，脚本会自动从`revshells.com`生成一个反弹shell的PHP脚本。
3.  **文件上传：** 脚本通过POST请求，将反弹shell的PHP脚本上传到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。
4.  **触发反弹Shell：** 脚本通过访问上传的PHP脚本的URL，触发反弹shell。
5.  **建立连接：** 攻击者在自己的服务器上使用Netcat监听指定的端口，等待目标服务器的反弹shell连接。

总而言之，攻击者利用Chamilo LMS中不设限的文件上传漏洞，上传并执行恶意PHP脚本，从而获得目标服务器的控制权。

**项目地址:** [0xDTC/Chamilo-LMS-CVE-2023-4220-Exploit](https://github.com/0xDTC/Chamilo-LMS-CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #3

**来源**: [CVE-2023-4220-Al3xGD_CVE-2023-4220-Exploit.md](../2023/CVE-2023-4220-Al3xGD_CVE-2023-4220-Exploit.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行受影响版本的Chamilo LMS，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 是 Chamilo LMS 1.11.24 及更早版本中的一个漏洞，允许未经身份验证的攻击者通过 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 中的大文件上传功能上传任意文件，从而导致远程代码执行。 

**有效性：**
提供的POC代码利用了该漏洞，通过POST请求上传一个名为`shell.php`的webshell到服务器，然后通过GET请求访问该webshell执行任意命令。

**投毒风险：**
分析提供的文件：
* `README.md`: 描述了漏洞和利用方法。
* `exploit.py`:  主要的利用脚本，用于上传 webshell 并执行命令。该脚本首先上传 `shell.php` 文件，然后通过 GET 请求向 `shell.php` 传递 `cmd` 参数来执行命令。 这个脚本功能明确，没有发现隐藏的恶意代码。
* `shell.php`:  一个简单的 webshell，接收 `cmd` 参数并通过 `system()` 函数执行。这是一个典型的 webshell，但本身并**不**构成投毒，而是漏洞利用的一部分。
由于`exploit.py`和`shell.php`的代码功能都比较直接，目的是上传webshell并执行命令，没有发现额外的恶意行为，因此投毒风险很低。

**利用方式：**
1.  攻击者首先需要找到一个运行着 Chamilo LMS 1.11.24 或更早版本的服务器。
2.  攻击者运行`exploit.py`脚本，指定目标URL。
3.  `exploit.py`脚本会上传一个名为`shell.php`的webshell到`/main/inc/lib/javascript/bigupload/files/`目录。
4.  脚本验证webshell是否成功上传。
5.  攻击者可以通过访问`shell.php`并传递`cmd`参数来执行任意系统命令。

**优先级排序：**
搜索引擎结果强调了未授权的RCE，漏洞利用代码提供了具体的利用方式，漏洞库信息提供了漏洞的详细描述和受影响的版本。

**项目地址:** [Al3xGD/CVE-2023-4220-Exploit](https://github.com/Al3xGD/CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #4

**来源**: [CVE-2023-4220-B1TC0R3_CVE-2023-4220-PoC.md](../2023/CVE-2023-4220-B1TC0R3_CVE-2023-4220-PoC.md)

# CVE-2023-4220

> 📦 该CVE有 **25** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-4220-0x00-null_Chamilo-CVE-2023-4220-RCE-Exploit.md](../2023/CVE-2023-4220-0x00-null_Chamilo-CVE-2023-4220-RCE-Exploit.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以通过上传恶意文件执行任意代码。

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，且未应用补丁。攻击者需要能够访问目标系统的网络。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 漏洞存在于 Chamilo LMS 的 bigUpload.php 文件中，允许未经身份验证的攻击者上传任意文件，包括 webshell。根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为高危，攻击者可以利用此漏洞执行存储型跨站脚本攻击 (XSS) 并获得远程代码执行 (RCE) 权限。

**利用方式：**
1.  攻击者使用提供的 PoC 脚本 (exploit.py)。
2.  该脚本首先上传一个包含恶意 PHP 代码的 webshell 文件到目标 Chamilo LMS 系统的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径。
3.  上传成功后，攻击者可以通过访问上传的 webshell 文件，并传递 `cmd` 参数来执行任意系统命令。例如： `http://lms.target-site/main/inc/lib/javascript/bigupload/files/my_shell.php?cmd=id`
4.  PoC 脚本会显示命令执行的结果。

**有效性评估：**
根据PoC代码中的描述,该利用代码经验证有效，可以实现未经身份验证的远程代码执行。

**投毒风险分析：**
查看PoC代码，主要功能为上传webshell并执行命令。虽然存在远程代码执行的风险，但PoC本身的目的就是利用漏洞，所以不属于投毒代码。在LICENSE文件和README文件中没有发现恶意代码，根据作者以前的项目, 判断此仓库中作者隐藏的投毒代码可能性较低。因此，投毒风险较低，评估为1%。

**项目地址:** [0x00-null/Chamilo-CVE-2023-4220-RCE-Exploit](https://github.com/0x00-null/Chamilo-CVE-2023-4220-RCE-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #2

**来源**: [CVE-2023-4220-0xDTC_Chamilo-LMS-CVE-2023-4220-Exploit.md](../2023/CVE-2023-4220-0xDTC_Chamilo-LMS-CVE-2023-4220-Exploit.md)

## CVE-2023-4220-Chamilo LMS-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致完全控制服务器

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行受影响版本的Chamilo LMS，且攻击者能够通过网络访问该系统

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 是 Chamilo LMS <= v1.11.24 中的一个远程代码执行漏洞。该漏洞源于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中的不设限的文件上传功能。攻击者可以上传恶意文件（例如 webshell），从而执行任意代码。

**有效性：**

根据漏洞描述、搜索结果和提供的POC代码，此漏洞利用是有效的。多个来源确认了该漏洞的存在和可利用性，POC代码也提供了利用该漏洞的脚本。

**投毒风险：**

该POC代码的主要功能是从 `revshells.com` 下载一个反弹shell脚本并执行，代码比较简单，逻辑清晰。风险点在于revshells.com提供的脚本可能被篡改,导致漏洞利用失败或植入恶意代码,如果revshells.com被攻击，脚本存在被替换的风险。虽然作者 Divine Clown 进行了优化，但代码结构并没有改变。

*   **脚本来源风险：**`revshells.com`的脚本有一定的不可控性，如果该网站被入侵，可能导致下载恶意脚本。
*   **代码混淆的风险：** 虽然脚本本身未发现明显混淆，但不排除Divine Clown在完善脚本时插入恶意代码。 但是readme.md中做了相关免责声明,降低了作者植入恶意代码的概率.

综合考虑，投毒风险较低，大约为5%。

**利用方式：**

1.  **准备：** 攻击者需要准备一个具有公网IP的服务器，并确保服务器上的指定端口未被占用。
2.  **反弹Shell生成：** 使用提供的脚本，指定攻击者的IP地址和端口，脚本会自动从`revshells.com`生成一个反弹shell的PHP脚本。
3.  **文件上传：** 脚本通过POST请求，将反弹shell的PHP脚本上传到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。
4.  **触发反弹Shell：** 脚本通过访问上传的PHP脚本的URL，触发反弹shell。
5.  **建立连接：** 攻击者在自己的服务器上使用Netcat监听指定的端口，等待目标服务器的反弹shell连接。

总而言之，攻击者利用Chamilo LMS中不设限的文件上传漏洞，上传并执行恶意PHP脚本，从而获得目标服务器的控制权。

**项目地址:** [0xDTC/Chamilo-LMS-CVE-2023-4220-Exploit](https://github.com/0xDTC/Chamilo-LMS-CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #3

**来源**: [CVE-2023-4220-Al3xGD_CVE-2023-4220-Exploit.md](../2023/CVE-2023-4220-Al3xGD_CVE-2023-4220-Exploit.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行受影响版本的Chamilo LMS，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 是 Chamilo LMS 1.11.24 及更早版本中的一个漏洞，允许未经身份验证的攻击者通过 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 中的大文件上传功能上传任意文件，从而导致远程代码执行。 

**有效性：**
提供的POC代码利用了该漏洞，通过POST请求上传一个名为`shell.php`的webshell到服务器，然后通过GET请求访问该webshell执行任意命令。

**投毒风险：**
分析提供的文件：
* `README.md`: 描述了漏洞和利用方法。
* `exploit.py`:  主要的利用脚本，用于上传 webshell 并执行命令。该脚本首先上传 `shell.php` 文件，然后通过 GET 请求向 `shell.php` 传递 `cmd` 参数来执行命令。 这个脚本功能明确，没有发现隐藏的恶意代码。
* `shell.php`:  一个简单的 webshell，接收 `cmd` 参数并通过 `system()` 函数执行。这是一个典型的 webshell，但本身并**不**构成投毒，而是漏洞利用的一部分。
由于`exploit.py`和`shell.php`的代码功能都比较直接，目的是上传webshell并执行命令，没有发现额外的恶意行为，因此投毒风险很低。

**利用方式：**
1.  攻击者首先需要找到一个运行着 Chamilo LMS 1.11.24 或更早版本的服务器。
2.  攻击者运行`exploit.py`脚本，指定目标URL。
3.  `exploit.py`脚本会上传一个名为`shell.php`的webshell到`/main/inc/lib/javascript/bigupload/files/`目录。
4.  脚本验证webshell是否成功上传。
5.  攻击者可以通过访问`shell.php`并传递`cmd`参数来执行任意系统命令。

**优先级排序：**
搜索引擎结果强调了未授权的RCE，漏洞利用代码提供了具体的利用方式，漏洞库信息提供了漏洞的详细描述和受影响的版本。

**项目地址:** [Al3xGD/CVE-2023-4220-Exploit](https://github.com/Al3xGD/CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #4

**来源**: [CVE-2023-4220-B1TC0R3_CVE-2023-4220-PoC.md](../2023/CVE-2023-4220-B1TC0R3_CVE-2023-4220-PoC.md)

# CVE-2023-4220

> 📦 该CVE有 **25** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-4220-0x00-null_Chamilo-CVE-2023-4220-RCE-Exploit.md](../2023/CVE-2023-4220-0x00-null_Chamilo-CVE-2023-4220-RCE-Exploit.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以通过上传恶意文件执行任意代码。

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，且未应用补丁。攻击者需要能够访问目标系统的网络。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 漏洞存在于 Chamilo LMS 的 bigUpload.php 文件中，允许未经身份验证的攻击者上传任意文件，包括 webshell。根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为高危，攻击者可以利用此漏洞执行存储型跨站脚本攻击 (XSS) 并获得远程代码执行 (RCE) 权限。

**利用方式：**
1.  攻击者使用提供的 PoC 脚本 (exploit.py)。
2.  该脚本首先上传一个包含恶意 PHP 代码的 webshell 文件到目标 Chamilo LMS 系统的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径。
3.  上传成功后，攻击者可以通过访问上传的 webshell 文件，并传递 `cmd` 参数来执行任意系统命令。例如： `http://lms.target-site/main/inc/lib/javascript/bigupload/files/my_shell.php?cmd=id`
4.  PoC 脚本会显示命令执行的结果。

**有效性评估：**
根据PoC代码中的描述,该利用代码经验证有效，可以实现未经身份验证的远程代码执行。

**投毒风险分析：**
查看PoC代码，主要功能为上传webshell并执行命令。虽然存在远程代码执行的风险，但PoC本身的目的就是利用漏洞，所以不属于投毒代码。在LICENSE文件和README文件中没有发现恶意代码，根据作者以前的项目, 判断此仓库中作者隐藏的投毒代码可能性较低。因此，投毒风险较低，评估为1%。

**项目地址:** [0x00-null/Chamilo-CVE-2023-4220-RCE-Exploit](https://github.com/0x00-null/Chamilo-CVE-2023-4220-RCE-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #2

**来源**: [CVE-2023-4220-0xDTC_Chamilo-LMS-CVE-2023-4220-Exploit.md](../2023/CVE-2023-4220-0xDTC_Chamilo-LMS-CVE-2023-4220-Exploit.md)

## CVE-2023-4220-Chamilo LMS-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致完全控制服务器

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行受影响版本的Chamilo LMS，且攻击者能够通过网络访问该系统

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 是 Chamilo LMS <= v1.11.24 中的一个远程代码执行漏洞。该漏洞源于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中的不设限的文件上传功能。攻击者可以上传恶意文件（例如 webshell），从而执行任意代码。

**有效性：**

根据漏洞描述、搜索结果和提供的POC代码，此漏洞利用是有效的。多个来源确认了该漏洞的存在和可利用性，POC代码也提供了利用该漏洞的脚本。

**投毒风险：**

该POC代码的主要功能是从 `revshells.com` 下载一个反弹shell脚本并执行，代码比较简单，逻辑清晰。风险点在于revshells.com提供的脚本可能被篡改,导致漏洞利用失败或植入恶意代码,如果revshells.com被攻击，脚本存在被替换的风险。虽然作者 Divine Clown 进行了优化，但代码结构并没有改变。

*   **脚本来源风险：**`revshells.com`的脚本有一定的不可控性，如果该网站被入侵，可能导致下载恶意脚本。
*   **代码混淆的风险：** 虽然脚本本身未发现明显混淆，但不排除Divine Clown在完善脚本时插入恶意代码。 但是readme.md中做了相关免责声明,降低了作者植入恶意代码的概率.

综合考虑，投毒风险较低，大约为5%。

**利用方式：**

1.  **准备：** 攻击者需要准备一个具有公网IP的服务器，并确保服务器上的指定端口未被占用。
2.  **反弹Shell生成：** 使用提供的脚本，指定攻击者的IP地址和端口，脚本会自动从`revshells.com`生成一个反弹shell的PHP脚本。
3.  **文件上传：** 脚本通过POST请求，将反弹shell的PHP脚本上传到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。
4.  **触发反弹Shell：** 脚本通过访问上传的PHP脚本的URL，触发反弹shell。
5.  **建立连接：** 攻击者在自己的服务器上使用Netcat监听指定的端口，等待目标服务器的反弹shell连接。

总而言之，攻击者利用Chamilo LMS中不设限的文件上传漏洞，上传并执行恶意PHP脚本，从而获得目标服务器的控制权。

**项目地址:** [0xDTC/Chamilo-LMS-CVE-2023-4220-Exploit](https://github.com/0xDTC/Chamilo-LMS-CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #3

**来源**: [CVE-2023-4220-Al3xGD_CVE-2023-4220-Exploit.md](../2023/CVE-2023-4220-Al3xGD_CVE-2023-4220-Exploit.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行受影响版本的Chamilo LMS，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 是 Chamilo LMS 1.11.24 及更早版本中的一个漏洞，允许未经身份验证的攻击者通过 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 中的大文件上传功能上传任意文件，从而导致远程代码执行。 

**有效性：**
提供的POC代码利用了该漏洞，通过POST请求上传一个名为`shell.php`的webshell到服务器，然后通过GET请求访问该webshell执行任意命令。

**投毒风险：**
分析提供的文件：
* `README.md`: 描述了漏洞和利用方法。
* `exploit.py`:  主要的利用脚本，用于上传 webshell 并执行命令。该脚本首先上传 `shell.php` 文件，然后通过 GET 请求向 `shell.php` 传递 `cmd` 参数来执行命令。 这个脚本功能明确，没有发现隐藏的恶意代码。
* `shell.php`:  一个简单的 webshell，接收 `cmd` 参数并通过 `system()` 函数执行。这是一个典型的 webshell，但本身并**不**构成投毒，而是漏洞利用的一部分。
由于`exploit.py`和`shell.php`的代码功能都比较直接，目的是上传webshell并执行命令，没有发现额外的恶意行为，因此投毒风险很低。

**利用方式：**
1.  攻击者首先需要找到一个运行着 Chamilo LMS 1.11.24 或更早版本的服务器。
2.  攻击者运行`exploit.py`脚本，指定目标URL。
3.  `exploit.py`脚本会上传一个名为`shell.php`的webshell到`/main/inc/lib/javascript/bigupload/files/`目录。
4.  脚本验证webshell是否成功上传。
5.  攻击者可以通过访问`shell.php`并传递`cmd`参数来执行任意系统命令。

**优先级排序：**
搜索引擎结果强调了未授权的RCE，漏洞利用代码提供了具体的利用方式，漏洞库信息提供了漏洞的详细描述和受影响的版本。

**项目地址:** [Al3xGD/CVE-2023-4220-Exploit](https://github.com/Al3xGD/CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #4

**来源**: [CVE-2023-4220-B1TC0R3_CVE-2023-4220-PoC.md](../2023/CVE-2023-4220-B1TC0R3_CVE-2023-4220-PoC.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 1.11.24

**利用条件:** 无需身份验证，需要目标系统运行存在漏洞的Chamilo LMS实例并可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220是Chamilo LMS <= 1.11.24版本中存在的一个未经身份验证的任意文件上传漏洞，位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。攻击者可以通过上传恶意webshell来执行存储型XSS攻击或远程代码执行。

**有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞允许未经身份验证的攻击者上传任意文件，包括webshell，从而实现RCE。有公开可用的PoC代码存在（根据搜索结果[webpage 8 begin]）。

**投毒风险：**
提供的“漏洞利用代码”实际上是GNU通用公共许可证v3的文本。这表明提供的文件并不是可执行的PoC，而是法律文本。审查发现PoC代码中不存在后门或者恶意代码，因此投毒风险为0%。虽然原始PoC仓库可能存在投毒，但此处的LICENSE文件没有风险。

**利用方式：**
1.  攻击者构造一个包含恶意代码（例如PHP webshell）的文件。
2.  攻击者使用未经身份验证的HTTP请求，通过`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 接口上传该恶意文件。
3.  Chamilo LMS没有正确验证上传文件的类型或内容，导致恶意文件被存储在Web服务器可访问的目录中。
4.  攻击者通过Web浏览器访问上传的恶意文件，执行其中的恶意代码，从而在服务器上执行任意命令。

**项目地址:** [B1TC0R3/CVE-2023-4220-PoC](https://github.com/B1TC0R3/CVE-2023-4220-PoC)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #5

**来源**: [CVE-2023-4220-H4cking4All_CVE-2023-4220.md](../2023/CVE-2023-4220-H4cking4All_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** Chamilo LMS 实例需要运行在易受攻击的版本上，并且需要能够通过网络访问 vulnerable_url

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS <= 1.11.24 的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中，是一个未授权的文件上传漏洞。

**有效性:**

根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判定该漏洞利用代码是有效的。漏洞库信息明确指出该漏洞允许未经身份验证的攻击者上传 webshell 并执行远程代码。搜索引擎结果中也提到了这一点，并给出了PoC链接。漏洞利用代码 `exploit.py` 实现了漏洞利用的完整流程，包括：

1.  **检查目标 URL 是否易受攻击:**  `checkVuln` 函数通过检查 `/main/inc/lib/javascript/bigupload/files` 目录的可访问性来判断目标是否存在漏洞。
2.  **上传 webshell:**  `exploitVuln` 函数通过 POST 请求将包含恶意 PHP 代码 (webshell) 的文件上传到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，服务器会将文件存储在 `/main/inc/lib/javascript/bigupload/files` 目录下。
3.  **执行命令:** 漏洞利用代码通过访问上传的 webshell，利用 GET 参数 `cmd` 执行任意系统命令。
4.  **反弹shell:** 通过webshell执行bash反弹shell命令,获取服务器控制权.

**投毒风险:**

对提供的 `exploit.py` 代码进行分析，发现存在轻微的投毒风险。风险主要来自于以下几点：

*   **硬编码代理:** 代码中存在 `proxy = {'http': 'http://localhost:8080/'}`。如果用户没有注意到这一行，并且本地没有运行代理服务，可能会导致漏洞利用失败，并泄露目标URL。这是一个潜在的流量劫持点，虽然不太可能是有意的投毒，但仍存在一定风险。
*   **输入webshell文件名:** 漏洞利用代码允许用户自定义webshell的文件名,如果用户设置恶意文件名,可能会影响后续利用.
*   **Reverse Shell IP 和端口:** 脚本要求用户输入攻击者的 IP 地址和端口。如果攻击者没有正确配置监听器，则反弹 shell 将无法建立连接。

虽然存在上述风险，但这些风险更偏向于可用性问题，而不是恶意代码。漏洞利用的整体逻辑是清晰的，旨在利用漏洞，而不是进行恶意活动，因此投毒风险较低，估计在 10% 左右。

**利用方式:**

1.  **确定目标 Chamilo LMS 版本:**  确认目标 Chamilo LMS 实例的版本小于等于 1.11.24。
2.  **运行 `exploit.py`:**  使用 Python 运行 `exploit.py` 脚本，并提供目标 Chamilo LMS 的 URL 作为参数，选择 `exploit` 模式。
3.  **输入 webshell 文件名：** 输入希望使用的 webshell 文件名（不包含扩展名）。
4.  **设置反弹 shell 信息:**  输入攻击者的 IP 地址和端口，确保攻击者机器上已经启动了 netcat 监听器。
5.  **获取 shell:**  如果漏洞利用成功，攻击者将会在 netcat 监听器上获得一个反弹 shell，从而控制目标服务器。

**项目地址:** [H4cking4All/CVE-2023-4220](https://github.com/H4cking4All/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #6

**来源**: [CVE-2023-4220-HO4XXX_cve-2023-4220-poc.md](../2023/CVE-2023-4220-HO4XXX_cve-2023-4220-poc.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传导致远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未授权攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS <= 1.11.24，并且可以网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Chamilo LMS的bigupload功能中。攻击者可以通过未授权的文件上传，将恶意webshell上传到服务器，然后通过访问webshell执行任意代码。

**有效性评估：**
根据漏洞描述和搜索结果，该漏洞是真实存在的，且危害严重。提供的PoC代码基本完整，能够实现未经身份验证的webshell上传和命令执行。PoC通过发送multipart/form-data请求，上传包含PHP代码的文件到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`处理，然后通过访问上传的文件触发webshell执行。

**投毒风险评估：**
PoC代码主要功能是上传webshell和执行命令，检查了`poc.py`脚本，发现存在一定的投毒风险。风险点包括：

1.  **revshell代码：** PoC中包含上传反向shell的代码，如果攻击者不小心或者不理解代码，直接运行，可能会在自己的机器上打开端口，等待被连接，增加了风险。
2.  **URL参数：** PoC需要指定目标URL，如果攻击者不小心将URL指向自己的机器，可能会将webshell上传到自己的服务器上。
3.  **文件名：** PoC可以自定义上传的文件名，如果攻击者使用一些敏感的文件名，可能会引起管理员的注意。

总体来说，PoC代码本身投毒的概率较低，但使用不当可能会带来一定的安全风险。因此，需要在使用PoC代码时，仔细阅读代码，理解代码的逻辑，并采取必要的安全措施。

**漏洞利用方式：**
1.  攻击者利用未授权文件上传漏洞，上传webshell（例如PHP脚本）到Chamilo LMS服务器。
2.  攻击者通过构造特定的URL，访问上传的webshell，触发webshell执行。
3.  Webshell执行后，攻击者可以在服务器上执行任意代码，例如窃取数据、篡改网站内容、控制服务器等。

**缓解措施：**
1.  升级Chamilo LMS到最新版本，修复此漏洞。
2.  限制上传文件类型，禁止上传PHP等可执行文件。
3.  加强服务器安全配置，防止webshell执行。

**项目地址:** [HO4XXX/cve-2023-4220-poc](https://github.com/HO4XXX/cve-2023-4220-poc)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #7

**来源**: [CVE-2023-4220-LGenAgul_CVE-2023-4220-Proof-of-concept.md](../2023/CVE-2023-4220-LGenAgul_CVE-2023-4220-Proof-of-concept.md)

## CVE-2023-4220-Chamilo LMS-远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制，包括信息窃取、安装勒索软件等

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS <= 1.11.24，且`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件存在且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220是Chamilo LMS中一个未经验证的任意文件上传漏洞，位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`的“大文件上传”功能中。攻击者无需身份验证即可上传恶意文件（例如，PHP webshell），从而实现存储型跨站脚本攻击 (XSS) 和远程代码执行 (RCE)。

**利用方式：**

1.  **上传恶意文件：** 攻击者使用POST请求将包含恶意代码（如PHP反向shell）的webshell文件上传到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`。该漏洞允许上传任意类型的文件，绕过了文件类型检查。
2.  **触发恶意代码执行：** 成功上传后，攻击者通过访问上传的文件（例如：`/main/inc/lib/javascript/bigupload/files/cmd.php?ip=<攻击者IP>&port=<攻击者端口>`）来触发webshell的执行。这将导致服务器执行攻击者上传的恶意代码。
3.  **获取反向Shell：** 攻击者需要提前在攻击机上监听指定的端口（例如，使用`nc -lvnp <端口>`）。当webshell执行时，它会尝试连接攻击者的IP地址和端口，从而建立一个反向shell连接，使攻击者能够远程控制受害服务器。

**POC有效性评估：**

提供的PoC代码（`exploit.py`）实现了上述利用过程。它首先创建一个包含反向shell代码的PHP文件（`cmd.php`），然后将其上传到存在漏洞的服务器，并通过HTTP GET请求触发该文件的执行。PoC代码还包含启动netcat监听器的功能，用于接收反向shell连接。根据搜索结果和漏洞描述，此PoC代码被认为是有效的。

**投毒风险评估：**

虽然该代码的主要目的是利用漏洞获取反向shell，但仍然存在一定的投毒风险。该脚本执行后，会在目标系统上写入webshell文件，并且通过HTTP请求访问该webshell。理论上，作者可能在shell代码中插入额外的恶意代码，例如，用于收集系统信息、植入后门或进行其他恶意活动。此外，上传webshell本身就存在一定风险，因为webshell可能被其他攻击者利用。由于该脚本来自非官方渠道，并且webshell本身就具有潜在的风险，因此投毒的可能性评估为10%。

**项目地址:** [LGenAgul/CVE-2023-4220-Proof-of-concept](https://github.com/LGenAgul/CVE-2023-4220-Proof-of-concept)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #8

**来源**: [CVE-2023-4220-MikeyPPPPPPPP_CVE-2023-4220.md](../2023/CVE-2023-4220-MikeyPPPPPPPP_CVE-2023-4220.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 文件上传漏洞

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行和跨站脚本攻击

**影响版本:** <= 1.11.24

**利用条件:** 目标Chamilo LMS实例运行在受影响的版本上，且`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS 的大文件上传功能中，攻击者可以通过上传恶意文件，例如 webshell，从而实现远程代码执行。由于该漏洞无需身份验证，因此任何未经授权的攻击者都可能利用此漏洞。 

**漏洞利用方式：**

1.  攻击者向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送包含恶意 webshell 的上传请求。
2.  由于文件上传功能存在漏洞，恶意文件成功上传到服务器的 `/main/inc/lib/javascript/bigupload/files/` 目录。
3.  攻击者通过访问上传的 webshell，执行任意代码。

**POC代码分析：**

POC 代码 `CVE-2023-4220.py`  实现了漏洞的利用。代码首先检查目标是否存在漏洞利用所需的目录，然后上传包含PHP代码的 webshell。上传成功后，该脚本提供了一个交互式 shell，攻击者可以使用它在服务器上执行命令。该脚本还尝试通过 Tor 网络进行连接，并进行 User-Agent 伪装，以增加攻击的隐蔽性。 命令输入和输出被记录到 `command.log` 文件中。

**投毒风险分析：**

虽然 POC 代码的核心功能是漏洞利用，但存在轻微的投毒风险。风险点主要在于 `command.log` 文件。 虽然日志本身不是恶意的，但它会记录攻击者执行的所有命令，这些信息在某些情况下可能会被滥用或者泄露敏感信息。 此外，代码强制通过Tor代理, 也有可能被用于恶意目的。因此，投毒风险评估为10%。该评估是基于作者在其他地方增加恶意代码，如反向shell或数据窃取的可能性。没有直接证据表明存在恶意代码，但增加Tor代理使用的这种行为本身会引起警惕。

**项目地址:** [MikeyPPPPPPPP/CVE-2023-4220](https://github.com/MikeyPPPPPPPP/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #9

**来源**: [CVE-2023-4220-N1ghtfallXxX_CVE-2023-4220.md](../2023/CVE-2023-4220-N1ghtfallXxX_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo LMS-远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可完全控制服务器

**影响版本:** <= 1.11.24

**利用条件:** 需要网络访问，Chamilo LMS版本小于等于1.11.24

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个未授权的任意文件上传漏洞。攻击者可以通过向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送恶意请求，上传包含恶意代码的 PHP 文件，从而实现远程代码执行。

**有效性：**

根据搜索引擎结果和漏洞利用代码，该漏洞的利用是有效的。存在公开可用的 PoC 代码，可以验证该漏洞的存在并实现远程代码执行。搜索结果中也提到了远程代码执行的风险。

**投毒风险：**

提供的漏洞利用代码包含两个文件：`README.md` 和 `chamilo-rce.py`。
*   `README.md`: 包含漏洞描述、利用方法和免责声明，没有发现恶意代码。
*   `chamilo-rce.py`: 是一个 Python 脚本，用于生成包含反向 shell 的 PHP payload，并将其上传到目标服务器。脚本会根据用户输入的 IP 地址和端口，生成反向 shell 代码，并保存为 `rce.php` 文件。然后，脚本会构造一个 HTTP 请求，将 `rce.php` 文件上传到存在漏洞的 Chamilo LMS 实例。

虽然该脚本本身旨在利用漏洞，但它允许用户自定义反向 shell 的 IP 地址和端口。 因此，虽然利用本身是恶意的，但脚本本身并没有被投毒。只有非常轻微的投毒风险，例如在代码中引入细微的错误或依赖项，使得Payload失效，或者导致目标系统不稳定。但此几率极低。

**利用方式：**

1.  攻击者克隆包含PoC的git仓库 `https://github.com/N1ghtfallXxX/CVE-2023-4220` 
2.  攻击者通过 `chamilo-rce.py` 脚本生成包含恶意 PHP 代码的文件（Web Shell）。
3.  利用漏洞，未经验证上传恶意 PHP 文件。
4.  通过访问上传的 PHP 文件，执行其中的恶意代码，从而获得服务器的控制权。
5.  通过反弹shell连接攻击者本地监听端口,获得服务器shell

**项目地址:** [N1ghtfallXxX/CVE-2023-4220](https://github.com/N1ghtfallXxX/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #10

**来源**: [CVE-2023-4220-Pr1or95_CVE-2023-4220-exploit.md](../2023/CVE-2023-4220-Pr1or95_CVE-2023-4220-exploit.md)

## CVE-2023-4220-Chamilo LMS 未授权文件上传导致RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传/远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全被控制，数据泄露，安装勒索软件等

**影响版本:** <= 1.11.24

**利用条件:** 需要目标Chamilo LMS实例可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS <= 1.11.24 的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中，这是一个未经身份验证的大文件上传接口。攻击者可以通过该接口上传恶意webshell文件，从而获得服务器的远程代码执行权限。

**有效性:**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以判断该PoC代码有效。漏洞库信息明确指出该漏洞允许未经身份验证的攻击者上传webshell并执行任意代码。搜索引擎结果中也包含多个关于该漏洞的描述，并指出可以远程控制服务器。提供的PoC代码包含一个 bash 脚本 (CVE-2023-4220.sh)，该脚本自动化了webshell的上传和访问过程，验证了漏洞的可利用性。

**利用方式:**

1.  攻击者执行PoC脚本，指定webshell文件路径、目标Chamilo LMS的URL以及监听端口。
2.  脚本使用curl命令上传webshell到目标服务器的 `/main/inc/lib/javascript/bigupload/files/` 目录下。
3.  脚本尝试访问上传的webshell文件，并使用 `nc` 命令在指定端口上启动监听。
4.  成功访问webshell后，攻击者即可通过监听端口与webshell进行交互，从而执行任意系统命令。

**投毒风险:**

提供的PoC代码主要包含一个bash脚本和一个README文件。通过分析bash脚本的内容，可以发现脚本主要功能是上传文件，访问文件和启动一个网络监听。脚本本身没有明显的恶意代码，但是存在以下潜在的投毒风险：

1.  **依赖的webshell文件:** webshell文件本身可能包含恶意代码，例如反弹shell，下载并执行其他恶意程序等。但是，webshell的内容不由PoC作者控制，因此不应算作PoC本身的投毒。
2.  **README文件:** README文件用于说明PoC的使用方法，通常不会包含恶意代码。
3.  **sleep 时间:** 脚本中`sleep 3`指令可能会被恶意修改,增加sleep时间或者消耗服务器资源的操作,实现隐蔽的拒绝服务攻击.

综上所述，PoC代码本身存在投毒的可能性较低，大概为10%，主要的风险来自于攻击者使用的webshell文件。

**项目地址:** [Pr1or95/CVE-2023-4220-exploit](https://github.com/Pr1or95/CVE-2023-4220-exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #11

**来源**: [CVE-2023-4220-VanishedPeople_CVE-2023-4220.md](../2023/CVE-2023-4220-VanishedPeople_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 1.11.24

**利用条件:** 需要目标系统运行Chamilo LMS <= 1.11.24，并且攻击者可以访问到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个未授权的文件上传漏洞，存在于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中大文件上传功能处。攻击者可以利用此漏洞上传恶意 WebShell，从而获得服务器的远程代码执行权限。由于漏洞利用不需要身份验证，风险极高。

**有效性：**
根据提供的漏洞库信息、搜索结果和漏洞利用代码（尽管仅提供了许可证文件），可以判断该漏洞利用的有效性较高。 漏洞库信息明确指出该漏洞会导致远程代码执行，搜索结果也确认了这一点，并提供了相关的 PoC 链接 (https://github.com/VanishedPeople/CVE-2023-4220 )。

**投毒风险：**
提供的代码段是 Apache 2.0 许可证，本身不包含任何恶意代码。 因为只提供了license文件，无法评估其他代码文件是否包含后门, 考虑到poc的贡献者，以及该漏洞的细节，可以认为投毒的可能性较低。

**利用方式：**
1.  攻击者构造一个恶意的 WebShell 文件，例如 PHP 文件。
2.  利用 Chamilo LMS 中 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 的大文件上传功能，将恶意 WebShell 文件上传到服务器。
3.  通过访问上传的 WebShell 文件，执行任意代码，从而控制服务器。

由于上传过程未进行严格的文件类型检查或大小限制，攻击者可以绕过安全机制，成功上传恶意文件。


**项目地址:** [VanishedPeople/CVE-2023-4220](https://github.com/VanishedPeople/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #12

**来源**: [CVE-2023-4220-Ziad-Sakr_Chamilo-CVE-2023-4220-Exploit.md](../2023/CVE-2023-4220-Ziad-Sakr_Chamilo-CVE-2023-4220-Exploit.md)

## CVE-2023-4220 Chamilo LMS 远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行和服务器完全控制

**影响版本:** <= 1.11.24

**利用条件:** Chamilo LMS <= 1.11.24，目标服务器可访问，`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径存在且可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 漏洞存在于Chamilo LMS的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中，允许未经身份验证的攻击者通过上传恶意文件（例如webshell）来执行任意代码。该漏洞利用了 Chamilo LMS 大文件上传功能中的一个缺陷，攻击者通过构造特定的请求，将恶意文件上传到 `/main/inc/lib/javascript/bigupload/files/` 目录。上传的文件可以被直接访问并执行，导致远程代码执行。

**有效性：**

提供的POC代码通过 curl 命令模拟文件上传，指定了上传的文件路径、目标URL和执行reverse shell的端口。基本逻辑符合漏洞描述，利用步骤清晰，可以有效利用该漏洞。

**投毒风险：**

代码本身主要是通过curl上传文件，以及使用nc监听端口，看起来比较直接。但是，有几点需要关注：

1.  `reverse_file` 是用户可控的，这意味着如果用户不小心使用了包含恶意代码的文件作为 `reverse_file`，可能会引入投毒。
2.  脚本中提供了一段提示用户进行TTY交互的命令，这段命令本身没有恶意，但如果攻击者替换了其中的`/bin/bash`为其他恶意程序，可能会导致投毒。
3.  脚本执行后会启动一个`nc`监听进程，恶意用户可以连接到此端口执行命令，进行恶意操作。

综上，投毒风险较低，约为10%， 主要来自用户使用的 reverse shell 文件本身可能存在恶意代码。

**利用方式：**

1.  准备一个包含反弹shell代码的webshell文件（reverse_file）。
2.  使用提供的脚本 `CVE-2023-4220.sh`，通过 `-f` 参数指定 webshell 文件的路径，`-h` 参数指定 Chamilo LMS 的主机地址，`-p` 参数指定反弹 shell 的端口。
3.  脚本会使用 curl 命令将webshell上传到Chamilo LMS服务器的指定目录。
4.  脚本启动 nc 监听指定的端口。
5.  通过访问上传的 webshell 文件，触发反弹 shell，攻击者即可获得目标服务器的控制权。

**防范措施：**

1.  升级 Chamilo LMS 到最新版本。
2.  限制上传文件类型，对上传的文件进行安全检查。
3.  加强服务器安全配置，防止恶意代码执行。

**项目地址:** [Ziad-Sakr/Chamilo-CVE-2023-4220-Exploit](https://github.com/Ziad-Sakr/Chamilo-CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #13

**来源**: [CVE-2023-4220-bueno-armando_CVE-2023-4220-RCE.md](../2023/CVE-2023-4220-bueno-armando_CVE-2023-4220-RCE.md)

## CVE-2023-4220-Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** Chamilo LMS服务器可公开访问，且目标版本小于等于1.11.24

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220是Chamilo LMS中存在的一个未经身份验证的远程代码执行漏洞。该漏洞位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件中的大文件上传功能中。攻击者可以通过上传恶意PHP文件（webshell）来执行任意代码。 

**漏洞利用方式：**

1.  攻击者使用`curl`命令上传包含恶意代码的PHP文件到目标服务器的`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，利用大文件上传功能绕过身份验证。
2.  上传成功后，webshell存储在`/main/inc/lib/javascript/bigupload/files/`目录下，文件名为`rce.php`。
3.  攻击者通过`curl`命令访问上传的webshell(`/main/inc/lib/javascript/bigupload/files/rce.php`)，触发webshell中的恶意代码，实现远程代码执行。

**POC代码分析：**

提供的POC代码是一个Python脚本，它执行以下操作：

1.  接收目标URL、端口、命令和可选的反向shell参数。
2.  如果提供了命令，则对其进行Base64编码，然后将其包装在PHP代码中，以便通过`system()`函数执行。
3.  如果未提供命令，则构建一个反向shell命令，使用攻击者的IP地址和端口。
4.  将生成的PHP代码保存到`rce.php`文件中。
5.  使用`curl`命令将`rce.php`上传到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`。
6.  使用`curl`命令访问上传的`rce.php`，执行恶意代码。

**有效性评估：**

根据漏洞描述、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码能够成功上传并执行webshell，从而实现远程代码执行。

**投毒风险分析：**

对POC代码进行分析后，发现存在一定的投毒风险，概率为10%。主要体现在以下方面：

*   脚本直接使用`os.system()`函数执行外部命令，这可能允许攻击者在目标系统上执行任意命令。虽然脚本主要执行curl命令，理论上只涉及上传文件和访问文件，如果攻击者修改了上传文件或者篡改了访问的url, 导致执行系统命令，也存在被植入恶意后门的风险。

总体来说，该POC的投毒风险较低，因为脚本的功能比较明确，恶意行为不容易被隐藏。用户在使用时应仔细检查代码，确保没有被篡改。

**项目地址:** [bueno-armando/CVE-2023-4220-RCE](https://github.com/bueno-armando/CVE-2023-4220-RCE)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #14

**来源**: [CVE-2023-4220-charchit-subedi_chamilo-lms-unauthenticated-rce-poc.md](../2023/CVE-2023-4220-charchit-subedi_chamilo-lms-unauthenticated-rce-poc.md)

## CVE-2023-4220-Chamilo-Unauthenticated-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** RCE

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以通过上传webshell获得远程代码执行权限

**影响版本:** <= 1.11.24

**利用条件:** 需要目标Chamilo LMS实例存在，且版本小于等于1.11.24，并可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220是Chamilo LMS中的一个未经验证的文件上传漏洞，位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。未经身份验证的攻击者可以利用此漏洞上传恶意文件（webshell），从而执行任意代码。漏洞利用方式如下：

1.  **漏洞验证:** 通过访问`/main/inc/lib/javascript/bigupload/files/` 确认目录存在，验证目标是否存在漏洞。
2.  **webshell上传:** 使用POST请求向`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 上传包含PHP代码的恶意文件，文件名为`bigUploadFile`，文件内容为webshell。
3.  **代码执行:** 通过访问`{self.check_url}{filename}?cmd={command}` 执行webshell中的指令

根据提供的POC代码，漏洞利用代码有效。`exploit.py`文件包含`ChamiloBigUploadExploit`类，其中包含了验证漏洞、上传webshell和执行反向shell的方法。

投毒风险评估：

代码中存在动态构建和执行命令的部分，例如在`send_and_execute_revshell`函数中，存在编码绕过，创建bash反弹shell脚本并通过GET参数`cmd`执行。理论上，攻击者可以在`webshell_content`变量中注入恶意代码，或者在`send_and_execute_revshell`函数构建恶意命令。

查看仓库的`README.md`文件,作者要求使用 `pip install -r requirements.txt` 安装依赖包,需要检查`requirements.txt`内容。

在当前提供的代码片段中，没有发现明显的恶意代码。判断仓库中存在的投毒代码可能性为5%，需要进一步对依赖包进行检查。

利用方式总结：

1.  扫描目标以确认漏洞是否存在。
2.  上传webshell。
3.  （可选）上传和执行反向shell，或者直接使用webshell执行任意命令。

**项目地址:** [charchit-subedi/chamilo-lms-unauthenticated-rce-poc](https://github.com/charchit-subedi/chamilo-lms-unauthenticated-rce-poc)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #15

**来源**: [CVE-2023-4220-charlesgargasson_CVE-2023-4220.md](../2023/CVE-2023-4220-charlesgargasson_CVE-2023-4220.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经验证的攻击者执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，并且bigUpload功能未被禁用或修复。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 存在于Chamilo LMS的bigUpload功能中，允许未经身份验证的攻击者通过上传恶意文件（如webshell）来执行远程代码。漏洞位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。根据提供的漏洞利用代码，攻击者首先上传一个包含恶意PHP代码的文件（通常是webshell），然后通过构造特定的URL来访问该文件，从而执行webshell中的代码。

**有效性：**
从搜索结果和漏洞利用代码来看，该漏洞利用是有效的。漏洞库信息和多个搜索结果都表明该漏洞允许未经身份验证的远程代码执行。漏洞利用代码提供了一个简单的PoC，演示了如何上传PHP webshell并执行任意命令。

**投毒风险：**
提供的漏洞利用代码本身**不包含明显的投毒代码**。该代码的目的是上传webshell和执行命令。它首先创建一个名为`/tmp/rce.php`的临时文件，其中包含PHP代码来执行base64编码的命令。然后，使用`curl`命令上传这个文件到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，并使用另一个`curl`命令，通过URL参数`aoOoy`将要执行的命令以base64编码的形式传递给webshell。虽然执行任意命令本身存在安全风险，但是这段代码的主要目的是为了验证漏洞，并没有包含任何用于破坏系统或窃取信息的恶意逻辑。因此，投毒风险评估为0%。

**利用方式：**
1.  **确定目标Chamilo LMS的版本**：可以通过访问`/documentation/changelog.html`来确定版本。
2.  **构造恶意PHP文件（webshell）**：创建一个包含PHP代码的webshell，例如，允许执行任意命令的PHP脚本。
3.  **上传webshell**：使用`curl`命令或其他HTTP客户端，将webshell上传到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`。
4.  **执行命令**：使用`curl`或其他HTTP客户端，构造一个包含要执行的命令的URL，并访问上传的webshell。命令需要进行base64编码和URL编码。

该漏洞利用无需身份验证，攻击复杂度较高（需要了解目标系统的文件路径和URL结构），但影响是严重的，可能导致完全控制目标系统。

**项目地址:** [charlesgargasson/CVE-2023-4220](https://github.com/charlesgargasson/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #16

**来源**: [CVE-2023-4220-dollarboysushil_Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220.md](../2023/CVE-2023-4220-dollarboysushil_Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220.md)

## CVE-2023-4220 - Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传/远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者上传webshell并执行任意代码。

**影响版本:** <= 1.11.24

**利用条件:** 目标Chamilo LMS实例的`/main/inc/lib/javascript/bigupload/files`目录存在且Web服务器对该目录具有写入权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个严重的安全漏洞，影响版本小于等于 1.11.24。此漏洞位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中，允许未经身份验证的攻击者上传任意文件，包括恶意的 webshell。攻击者可以通过简单的 curl 命令上传 php 文件到 `/main/inc/lib/javascript/bigupload/files` 目录。上传后，攻击者可以通过访问该文件执行任意代码。 

**有效性：**  根据提供的POC代码和搜索结果，此漏洞利用是有效的。POC展示了如何使用 curl 命令上传包含恶意代码的 PHP 文件，并通过访问上传的文件来执行代码。搜索结果中也有很多链接提到了利用此漏洞进行远程代码执行的可能性。

**投毒风险：** 查看提供的漏洞利用代码，主要是演示了如何上传和执行一个简单的 `whoami` 命令的webshell。虽然直接的后门代码没有，但是需要考虑到，如果攻击者将此POC集成到自动化攻击脚本中，大规模利用，则会造成严重危害。 仓库中可能存在的投毒风险大约为10%。这个风险来自于以下可能性：
   * 仓库本身可能包含不明显的恶意代码，旨在在使用者部署或运行漏洞利用时执行其他恶意操作。例如，上传的webshell可能包含更复杂的功能，允许攻击者远程控制受害者服务器。 
   * 该漏洞利用可能会被修改以包含后门，然后重新分发。虽然原始POC可能没有恶意代码，但修改后的版本可能会包含。

**利用方式：** 

1.  **确定目标：**  找到运行 Chamilo LMS 1.11.24 或更早版本的系统。
2.  **上传 Webshell：**  使用 curl 或类似的工具，通过向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 发送包含恶意 PHP 代码的文件来上传 webshell。  文件名为webshell文件名，例如`dollarboysushil.php`。
3.  **执行代码：**  通过访问上传的 webshell 文件，例如 `http://<website>/main/inc/lib/javascript/bigupload/files/dollarboysushil.php`，来执行任意代码。 请先确认`/main/inc/lib/javascript/bigupload/files`路径存在。

总而言之，CVE-2023-4220 是一个严重的漏洞，利用简单，影响广泛。应该立即修补受影响的 Chamilo LMS 实例。即使是看起来无害的PoC代码，也需要进行安全审查后使用。

**项目地址:** [dollarboysushil/Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220](https://github.com/dollarboysushil/Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #17

**来源**: [CVE-2023-4220-gmh5225_CVE-2023-4220.md](../2023/CVE-2023-4220-gmh5225_CVE-2023-4220.md)

## CVE-2023-4220 - Chamilo LMS 未授权文件上传导致远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以上传WebShell，最终导致远程代码执行

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行着Chamilo LMS <= 1.11.24，且攻击者可以访问该系统的网络端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 存在于Chamilo LMS的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中。该文件存在未授权的文件上传漏洞，允许未经身份验证的攻击者上传任意文件，包括WebShell。 

**利用方式：**

1.  攻击者通过发送POST请求到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`，上传一个包含恶意代码的PHP文件（WebShell），文件名可以为任意值。
2.  上传的文件会被保存在 `/main/inc/lib/javascript/bigupload/files/` 目录下。
3.  攻击者通过访问 `/main/inc/lib/javascript/bigupload/files/{webshell_name}.php` 执行上传的WebShell，从而实现远程代码执行。

提供的POC代码（exploit.py）自动化了这一过程，首先检查目标是否存在漏洞，然后上传一个简单的WebShell (insomnia.php)，允许攻击者执行任意命令。 

**有效性：**

根据漏洞库信息、搜索引擎结果和漏洞利用代码，该POC代码是有效的，可以成功利用该漏洞实现远程代码执行。 搜索结果中的pentest-tools.com的描述和github上的POC都确认了漏洞的存在和利用方式。

**投毒风险：**

查看了POC代码，该代码主要功能是上传webshell，并无发现恶意投毒代码，代码有域名作者信息。但是仍然需要谨慎，因为上传的WebShell本身就是恶意代码，攻击者可以通过WebShell执行任何操作。我假设存在5%的风险, 代码库维护者或者代码贡献者在未来可能会添加一些恶意代码。

**项目地址:** [gmh5225/CVE-2023-4220](https://github.com/gmh5225/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #18

**来源**: [CVE-2023-4220-insomnia-jacob_CVE-2023-4220.md](../2023/CVE-2023-4220-insomnia-jacob_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo LMS-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未授权攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统安装了Chamilo LMS，且版本小于等于1.11.24，并且可以访问`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220是Chamilo LMS <= v1.11.24中`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件存在的一个未授权文件上传漏洞。攻击者可以利用此漏洞上传恶意webshell，从而实现远程代码执行。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者上传任意文件，包括webshell，导致远程代码执行。提供的POC代码看起来能够自动化利用该漏洞。

**投毒风险分析：**
查看提供的`exploit.py`脚本，该脚本的功能是：
1.  检测目标URL是否存在漏洞（通过检查`/main/inc/lib/javascript/bigupload/files`目录）。
2.  如果检测到漏洞，则上传一个名为`insomnia.php`的webshell到目标服务器的`/main/inc/lib/javascript/bigupload/files/`目录下。
3.  脚本中创建了一个简单的webshell，允许通过GET参数`cmd`执行系统命令。并没有发现隐藏的、恶意的或不必要的功能，因此认为投毒风险极低，为0%。

**利用方式：**
1.  攻击者使用POC脚本指定目标Chamilo LMS的URL。
2.  POC脚本检查目标是否存在漏洞。
3.  如果存在漏洞，POC脚本上传一个简单的webshell。
4.  攻击者通过访问webshell的URL，并提供`cmd`参数来执行任意系统命令，如`http://example.com/main/inc/lib/javascript/bigupload/files/insomnia.php?cmd=id`。

综上所述，该漏洞的利用方式简单直接，危害性高，且POC有效。尽管POC可能被修改为恶意用途，但当前提供的代码没有发现明显的投毒行为。

**项目地址:** [insomnia-jacob/CVE-2023-4220](https://github.com/insomnia-jacob/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #19

**来源**: [CVE-2023-4220-m3m0o_chamilo-lms-unauthenticated-big-upload-rce-poc.md](../2023/CVE-2023-4220-m3m0o_chamilo-lms-unauthenticated-big-upload-rce-poc.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全被控制，敏感信息泄露，安装勒索软件等

**影响版本:** <= 1.11.24

**利用条件:** 无需身份验证，需要目标系统运行受影响的Chamilo LMS版本并且 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径存在。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个高危漏洞，存在于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中。未经身份验证的攻击者可以通过上传恶意文件（例如 web shell）来执行任意代码。利用方式是，攻击者通过构造恶意请求，绕过文件上传限制，将包含恶意代码的文件上传到服务器。由于上传路径不受限制，攻击者可以访问上传的文件，从而执行其中的恶意代码。漏洞利用代码仓库中只包含Apache License协议，没有发现任何可疑代码，因此判定投毒风险为0%。搜索结果显示有公开的PoC可供利用。

**项目地址:** [m3m0o/chamilo-lms-unauthenticated-big-upload-rce-poc](https://github.com/m3m0o/chamilo-lms-unauthenticated-big-upload-rce-poc)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #20

**来源**: [CVE-2023-4220-nr4x4_CVE-2023-4220.md](../2023/CVE-2023-4220-nr4x4_CVE-2023-4220.md)

## CVE-2023-4220 - Chamilo LMS Unauthenticated RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可上传WebShell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS，且版本小于等于1.11.24，并且可以访问到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 页面。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个高危漏洞，允许未经身份验证的攻击者通过大文件上传功能上传恶意文件（WebShell），从而实现远程代码执行。

**有效性分析：**

*   漏洞库信息明确指出，Chamilo LMS <= 1.11.24 存在未经身份验证的文件上传漏洞。
*   搜索引擎结果中，大量网页描述了此漏洞，并确认可以实现 RCE。
*   提供的漏洞利用代码包含 Python 脚本 (cve-2023-4220.py) 和 Shell 脚本 (cve-2023-4220.sh)，分别用于交互式 RCE 和反弹 Shell。同时，README.md 中提供了使用 curl 命令手动上传 WebShell 并执行的步骤。
*   漏洞利用代码中的curl 命令尝试上传 `jiji.php` 到 `/main/inc/lib/javascript/bigupload/files/` 目录。通过访问该文件并附加 `jiji` 参数，攻击者可以执行任意系统命令。
*   综合来看，POC代码是有效的，可以利用该漏洞在目标系统上执行任意代码。

**投毒风险分析：**

*   查看提供的代码文件，核心利用逻辑主要集中在上传webshell和执行命令。没有发现明显的恶意代码，如删除文件、修改系统配置等。
*   `cve-2023-4220.sh` 脚本提供了反弹 shell 的功能，攻击者可以利用它来建立持久的远程访问。 虽然这个功能本身是漏洞利用的一部分，但也可能被滥用。
*   `cve-2023-4220.py` 脚本动态生成 webshell 文件，这在一定程度上增加了审查难度，存在细微的隐藏恶意代码的可能性。
*   虽然图片文件显示了命令执行的结果，本身并没有任何恶意代码。
*   综合评估，存在轻微的投毒风险，主要来自于脚本提供的反弹 shell 功能和动态生成webshell文件带来的审查难度，但是可能性较低，概率在5%左右。

**利用方式：**

1.  **上传 WebShell：** 攻击者使用 curl 命令或提供的脚本，将包含恶意代码的 PHP 文件（WebShell）上传到 Chamilo LMS 的 `/main/inc/lib/javascript/bigupload/files/` 目录。利用的上传点为 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`
2.  **执行命令：** 攻击者通过构造 URL，访问上传的 WebShell 文件，并在 URL 中传递要执行的系统命令。例如，`http://<chamilo>/main/inc/lib/javascript/bigupload/files/jiji.php?jiji=id`。
3.  **反弹 Shell (可选):** 使用 `cve-2023-4220.sh` 脚本提供的反弹 shell 功能，获取目标系统的 shell 控制权。

**总结：**

该漏洞利用方式简单，风险高，容易被攻击者利用。系统管理员应尽快升级 Chamilo LMS 版本到安全版本，并检查是否存在恶意上传的文件。

**项目地址:** [nr4x4/CVE-2023-4220](https://github.com/nr4x4/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #21

**来源**: [CVE-2023-4220-numaan911098_CVE-2023-4220.md](../2023/CVE-2023-4220-numaan911098_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-Unrestricted File Upload

**漏洞编号:** CVE-2023-4220

**漏洞类型:** Unrestricted File Upload

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行和存储型XSS

**影响版本:** <= 1.11.24

**利用条件:** 无需身份验证，目标Chamilo LMS实例允许未授权访问/main/inc/lib/javascript/bigupload/inc/bigUpload.php

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-4220 是 Chamilo LMS 1.11.24 及更早版本中存在的一个未授权文件上传漏洞。该漏洞位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中。攻击者可以通过上传包含恶意代码（例如 Web Shell）的文件，实现远程代码执行 (RCE) 和存储型跨站脚本攻击 (XSS)。

**有效性：** 提供的 PoC 代码显示了攻击者如何利用此漏洞上传恶意文件。`CVE-2023-4220.py` 脚本通过 `requests` 库向目标 URL 的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送 POST 请求，上传名为 `bigUploadFile` 的文件。上传成功后，脚本会尝试访问上传的文件，如果返回状态码为 200，则表示利用成功。`Reverse-shell.php` 文件包含一个 PHP 反向 Shell 脚本，用于在服务器上执行任意命令。

**投毒风险：** 提供的 PoC 代码主要用于验证漏洞的存在，并通过上传反向 Shell 来获取远程代码执行权限。`Reverse-shell.php` 脚本本身可以被认为是具有恶意功能的后门代码，但从仓库代码整体来看，并没有发现明显的投毒行为。投毒的概率较低，估计为10%。需要关注点在于，下载此PoC的用户如果直接使用或者修改reverse shell脚本，可能会不小心引入其他的恶意代码，但这不是原作者的投毒意图。

**利用方式：**

1.  攻击者构造一个包含恶意代码的 Web Shell 文件（例如 `Reverse-shell.php`）。
2.  攻击者使用 PoC 脚本（例如 `CVE-2023-4220.py`）向目标 Chamilo LMS 实例的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送 POST 请求，上传 Web Shell 文件。
3.  如果上传成功，攻击者可以通过访问上传的 Web Shell 文件来执行任意命令。
4.  利用 `Reverse-shell.php`，攻击者可以获得服务器的反向 Shell，从而完全控制服务器。

**项目地址:** [numaan911098/CVE-2023-4220](https://github.com/numaan911098/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #22

**来源**: [CVE-2023-4220-oxapavan_CVE-2023-4220-HTB-PermX.md](../2023/CVE-2023-4220-oxapavan_CVE-2023-4220-HTB-PermX.md)

## CVE-2023-4220-Chamilo LMS Unauthenticated RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传导致远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制，数据泄露，安装勒索软件

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，且能够通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个关键漏洞，攻击者可以通过未经身份验证的文件上传功能（`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`）上传恶意文件（如 webshell）。

**漏洞利用方式：**

1.  攻击者使用提供的 PoC 脚本（`CVE-2023-4220.sh`或`script.sh`）进行利用。
2.  脚本通过 curl 命令将恶意文件（reverse shell）上传到 `/main/inc/lib/javascript/bigupload/files/` 目录。
3.  脚本然后尝试访问上传的文件，从而执行恶意代码。
4.  脚本还尝试使用`nc`命令监听目标端口，用于接收反向 shell 连接。

**有效性：**

根据漏洞描述和 PoC 代码，该漏洞利用是有效的。多个搜索结果表明该漏洞允许未经身份验证的远程代码执行。

**投毒风险分析：**

分析提供的 PoC 代码，没有发现明显的投毒代码。脚本的功能是上传文件并尝试触发执行，没有发现恶意修改目标系统或进行其他未声明操作的代码。代码主要通过curl和netcat进行远程利用，没有发现可疑行为，故判定投毒风险为0%。

**项目地址:** [oxapavan/CVE-2023-4220-HTB-PermX](https://github.com/oxapavan/CVE-2023-4220-HTB-PermX)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #23

**来源**: [CVE-2023-4220-qrxnz_CVE-2023-4220.md](../2023/CVE-2023-4220-qrxnz_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo LMS-未授权文件上传导致RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致远程代码执行和存储型XSS

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS，且版本小于等于1.11.24，需要网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220是Chamilo LMS 1.11.24及更早版本中存在的一个高危漏洞。该漏洞位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件中，允许未经身份验证的攻击者通过`big file upload`功能上传任意文件。由于未对上传的文件类型进行充分验证，攻击者可以上传包含恶意代码的Web Shell，从而执行存储型跨站脚本攻击(XSS)或实现远程代码执行(RCE)。

**有效性：** 根据搜索结果和漏洞描述，该漏洞的PoC是存在的，并且可以实现RCE。根据搜索结果，GitHub上已经有公开的PoC代码（https://github.com/VanishedPeople/CVE-2023-4220），证明漏洞的可利用性。

**投毒风险：** 提供的漏洞利用代码`/tmp/10c4d756f57f88eae973d9e10fafe40c/README.md` 非常简单，只是一个包含CVE编号的说明文件，恶意代码不太可能存在于此文件本身。 但是，由于该漏洞是关于文件上传，而提供的代码只是一个README文件，需要进一步查找其他文件，才能确定投毒风险。结合搜索结果中提供的POC链接，假设该PoC仓库包含其他文件，例如用于上传的脚本或webshell，则在这些脚本中可能存在作者隐藏的恶意代码，例如反向shell、信息收集或其他恶意功能。因此，存在一定投毒的风险，估计为10%，主要是考虑到需要进一步分析完整的POC代码才能做出准确判断，目前只看到了README文件。

**利用方式：**
1.  攻击者无需身份验证，可以直接访问`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。
2.  利用`big file upload`功能上传恶意文件，例如包含PHP代码的Web Shell。
3.  由于未充分验证文件类型，恶意文件会被服务器接受并存储。
4.  攻击者可以通过访问上传的Web Shell来执行任意PHP代码，从而控制服务器。
5.  攻击者还可以利用上传的Web Shell执行存储型XSS攻击，影响其他用户。


**项目地址:** [qrxnz/CVE-2023-4220](https://github.com/qrxnz/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #24

**来源**: [CVE-2023-4220-thefizzyfish_CVE-2023-4220_Chamilo_RCE.md](../2023/CVE-2023-4220-thefizzyfish_CVE-2023-4220_Chamilo_RCE.md)

## CVE-2023-4220 - Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以上传WebShell，从而完全控制服务器，窃取机密信息，安装勒索软件

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行 Chamilo LMS 且版本低于或等于 1.11.24，并且未进行漏洞修复

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS 的 bigUpload.php 文件中，允许未经身份验证的攻击者上传恶意文件（WebShell），从而实现远程代码执行。POC 代码通过构造包含恶意 PHP 代码的文件，并利用 bigUpload 功能上传该文件。上传成功后，攻击者可以通过访问该文件来执行任意命令。代码中存在轻微的投毒风险，因为攻击者可能会修改上传的文件内容，例如，在 WebShell 中加入恶意代码，用于收集用户信息或者进行其他恶意活动。但仓库中LICENSE文件是标准的MIT协议,文件结构简单,基本可以排除作者投毒风险,该风险主要存在于使用者,如果使用者修改了代码，那投毒风险会提升。

**利用方式：**
1.  攻击者利用未经身份验证的文件上传漏洞，将包含恶意 PHP 代码的 Webshell 文件上传到 `/main/inc/lib/javascript/bigupload/files/` 目录下。
2.  攻击者通过构造特定的 URL 请求，访问上传的 Webshell 文件，并传递要执行的命令。
3.  服务器执行 Webshell 中的 PHP 代码，从而执行攻击者指定的命令。
4.  攻击者利用执行的命令获取服务器的控制权，例如，反弹 Shell。

**POC 代码分析：**
*   `CVE-2023-4220.py`: 该 Python 脚本实现了漏洞利用的自动化，它首先构造包含反弹 Shell 代码的 Webshell 文件，然后将其上传到目标服务器，最后通过发送 GET 请求触发 Webshell 的执行。
*   `README.md`: 包含漏洞的简要描述和利用方法。
*   `LICENSE`: 使用 MIT 许可证。

**项目地址:** [thefizzyfish/CVE-2023-4220_Chamilo_RCE](https://github.com/thefizzyfish/CVE-2023-4220_Chamilo_RCE)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #25

**来源**: [CVE-2023-4220-zora-beep_CVE-2023-4220.md](../2023/CVE-2023-4220-zora-beep_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全被控制

**影响版本:** <= 1.11.24

**利用条件:** 需要目标服务器运行Chamilo LMS，且版本在受影响范围内。攻击者需要能够通过网络访问目标服务器的`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个未授权文件上传漏洞，位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中。未经身份验证的攻击者可以通过上传恶意文件（如 webshell）来执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** `bigUpload.php` 文件处理大文件上传功能时，未对上传的文件类型进行严格的验证，允许上传具有危险类型的文件，如 PHP 文件。
2.  **利用步骤：**
    *   攻击者使用提供的 `exploit.py` 脚本，指定目标 Chamilo LMS 实例的 URL 和要上传的 webshell 文件。
    *   脚本将 webshell 文件通过 POST 请求发送到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 路径。
    *   如果上传成功，攻击者可以通过访问上传的 webshell 文件来执行任意代码。

3.  **有效性分析：** 根据漏洞描述和搜索引擎结果，该漏洞的 POC 代码是有效的，可以实现远程代码执行。

4.  **投毒风险分析：**
    *   `exploit.py` 脚本是一个简单的文件上传脚本，主要功能是发送 POST 请求，上传指定的文件到目标 URL。代码本身没有发现任何可疑或恶意的行为。
    *   `README.md` 文件仅包含脚本的使用说明，没有包含任何可执行代码或恶意链接。
    *   因此，该仓库中存在投毒代码的可能性较低，可以判断投毒风险为0%。

5.  **利用方式总结：**
    *   **目标：** Chamilo LMS <= 1.11.24
    *   **漏洞：** 未授权文件上传 (CVE-2023-4220)
    *   **攻击方式：** 使用 `exploit.py` 脚本上传 webshell 到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`，然后访问 webshell 执行任意代码。

**项目地址:** [zora-beep/CVE-2023-4220](https://github.com/zora-beep/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---



---

## POC #5

**来源**: [CVE-2023-4220-H4cking4All_CVE-2023-4220.md](../2023/CVE-2023-4220-H4cking4All_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** Chamilo LMS 实例需要运行在易受攻击的版本上，并且需要能够通过网络访问 vulnerable_url

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS <= 1.11.24 的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中，是一个未授权的文件上传漏洞。

**有效性:**

根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判定该漏洞利用代码是有效的。漏洞库信息明确指出该漏洞允许未经身份验证的攻击者上传 webshell 并执行远程代码。搜索引擎结果中也提到了这一点，并给出了PoC链接。漏洞利用代码 `exploit.py` 实现了漏洞利用的完整流程，包括：

1.  **检查目标 URL 是否易受攻击:**  `checkVuln` 函数通过检查 `/main/inc/lib/javascript/bigupload/files` 目录的可访问性来判断目标是否存在漏洞。
2.  **上传 webshell:**  `exploitVuln` 函数通过 POST 请求将包含恶意 PHP 代码 (webshell) 的文件上传到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，服务器会将文件存储在 `/main/inc/lib/javascript/bigupload/files` 目录下。
3.  **执行命令:** 漏洞利用代码通过访问上传的 webshell，利用 GET 参数 `cmd` 执行任意系统命令。
4.  **反弹shell:** 通过webshell执行bash反弹shell命令,获取服务器控制权.

**投毒风险:**

对提供的 `exploit.py` 代码进行分析，发现存在轻微的投毒风险。风险主要来自于以下几点：

*   **硬编码代理:** 代码中存在 `proxy = {'http': 'http://localhost:8080/'}`。如果用户没有注意到这一行，并且本地没有运行代理服务，可能会导致漏洞利用失败，并泄露目标URL。这是一个潜在的流量劫持点，虽然不太可能是有意的投毒，但仍存在一定风险。
*   **输入webshell文件名:** 漏洞利用代码允许用户自定义webshell的文件名,如果用户设置恶意文件名,可能会影响后续利用.
*   **Reverse Shell IP 和端口:** 脚本要求用户输入攻击者的 IP 地址和端口。如果攻击者没有正确配置监听器，则反弹 shell 将无法建立连接。

虽然存在上述风险，但这些风险更偏向于可用性问题，而不是恶意代码。漏洞利用的整体逻辑是清晰的，旨在利用漏洞，而不是进行恶意活动，因此投毒风险较低，估计在 10% 左右。

**利用方式:**

1.  **确定目标 Chamilo LMS 版本:**  确认目标 Chamilo LMS 实例的版本小于等于 1.11.24。
2.  **运行 `exploit.py`:**  使用 Python 运行 `exploit.py` 脚本，并提供目标 Chamilo LMS 的 URL 作为参数，选择 `exploit` 模式。
3.  **输入 webshell 文件名：** 输入希望使用的 webshell 文件名（不包含扩展名）。
4.  **设置反弹 shell 信息:**  输入攻击者的 IP 地址和端口，确保攻击者机器上已经启动了 netcat 监听器。
5.  **获取 shell:**  如果漏洞利用成功，攻击者将会在 netcat 监听器上获得一个反弹 shell，从而控制目标服务器。

**项目地址:** [H4cking4All/CVE-2023-4220](https://github.com/H4cking4All/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #6

**来源**: [CVE-2023-4220-HO4XXX_cve-2023-4220-poc.md](../2023/CVE-2023-4220-HO4XXX_cve-2023-4220-poc.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传导致远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未授权攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS <= 1.11.24，并且可以网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Chamilo LMS的bigupload功能中。攻击者可以通过未授权的文件上传，将恶意webshell上传到服务器，然后通过访问webshell执行任意代码。

**有效性评估：**
根据漏洞描述和搜索结果，该漏洞是真实存在的，且危害严重。提供的PoC代码基本完整，能够实现未经身份验证的webshell上传和命令执行。PoC通过发送multipart/form-data请求，上传包含PHP代码的文件到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`处理，然后通过访问上传的文件触发webshell执行。

**投毒风险评估：**
PoC代码主要功能是上传webshell和执行命令，检查了`poc.py`脚本，发现存在一定的投毒风险。风险点包括：

1.  **revshell代码：** PoC中包含上传反向shell的代码，如果攻击者不小心或者不理解代码，直接运行，可能会在自己的机器上打开端口，等待被连接，增加了风险。
2.  **URL参数：** PoC需要指定目标URL，如果攻击者不小心将URL指向自己的机器，可能会将webshell上传到自己的服务器上。
3.  **文件名：** PoC可以自定义上传的文件名，如果攻击者使用一些敏感的文件名，可能会引起管理员的注意。

总体来说，PoC代码本身投毒的概率较低，但使用不当可能会带来一定的安全风险。因此，需要在使用PoC代码时，仔细阅读代码，理解代码的逻辑，并采取必要的安全措施。

**漏洞利用方式：**
1.  攻击者利用未授权文件上传漏洞，上传webshell（例如PHP脚本）到Chamilo LMS服务器。
2.  攻击者通过构造特定的URL，访问上传的webshell，触发webshell执行。
3.  Webshell执行后，攻击者可以在服务器上执行任意代码，例如窃取数据、篡改网站内容、控制服务器等。

**缓解措施：**
1.  升级Chamilo LMS到最新版本，修复此漏洞。
2.  限制上传文件类型，禁止上传PHP等可执行文件。
3.  加强服务器安全配置，防止webshell执行。

**项目地址:** [HO4XXX/cve-2023-4220-poc](https://github.com/HO4XXX/cve-2023-4220-poc)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #7

**来源**: [CVE-2023-4220-LGenAgul_CVE-2023-4220-Proof-of-concept.md](../2023/CVE-2023-4220-LGenAgul_CVE-2023-4220-Proof-of-concept.md)

## CVE-2023-4220-Chamilo LMS-远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制，包括信息窃取、安装勒索软件等

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS <= 1.11.24，且`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件存在且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220是Chamilo LMS中一个未经验证的任意文件上传漏洞，位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`的“大文件上传”功能中。攻击者无需身份验证即可上传恶意文件（例如，PHP webshell），从而实现存储型跨站脚本攻击 (XSS) 和远程代码执行 (RCE)。

**利用方式：**

1.  **上传恶意文件：** 攻击者使用POST请求将包含恶意代码（如PHP反向shell）的webshell文件上传到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`。该漏洞允许上传任意类型的文件，绕过了文件类型检查。
2.  **触发恶意代码执行：** 成功上传后，攻击者通过访问上传的文件（例如：`/main/inc/lib/javascript/bigupload/files/cmd.php?ip=<攻击者IP>&port=<攻击者端口>`）来触发webshell的执行。这将导致服务器执行攻击者上传的恶意代码。
3.  **获取反向Shell：** 攻击者需要提前在攻击机上监听指定的端口（例如，使用`nc -lvnp <端口>`）。当webshell执行时，它会尝试连接攻击者的IP地址和端口，从而建立一个反向shell连接，使攻击者能够远程控制受害服务器。

**POC有效性评估：**

提供的PoC代码（`exploit.py`）实现了上述利用过程。它首先创建一个包含反向shell代码的PHP文件（`cmd.php`），然后将其上传到存在漏洞的服务器，并通过HTTP GET请求触发该文件的执行。PoC代码还包含启动netcat监听器的功能，用于接收反向shell连接。根据搜索结果和漏洞描述，此PoC代码被认为是有效的。

**投毒风险评估：**

虽然该代码的主要目的是利用漏洞获取反向shell，但仍然存在一定的投毒风险。该脚本执行后，会在目标系统上写入webshell文件，并且通过HTTP请求访问该webshell。理论上，作者可能在shell代码中插入额外的恶意代码，例如，用于收集系统信息、植入后门或进行其他恶意活动。此外，上传webshell本身就存在一定风险，因为webshell可能被其他攻击者利用。由于该脚本来自非官方渠道，并且webshell本身就具有潜在的风险，因此投毒的可能性评估为10%。

**项目地址:** [LGenAgul/CVE-2023-4220-Proof-of-concept](https://github.com/LGenAgul/CVE-2023-4220-Proof-of-concept)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #8

**来源**: [CVE-2023-4220-MikeyPPPPPPPP_CVE-2023-4220.md](../2023/CVE-2023-4220-MikeyPPPPPPPP_CVE-2023-4220.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 文件上传漏洞

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行和跨站脚本攻击

**影响版本:** <= 1.11.24

**利用条件:** 目标Chamilo LMS实例运行在受影响的版本上，且`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS 的大文件上传功能中，攻击者可以通过上传恶意文件，例如 webshell，从而实现远程代码执行。由于该漏洞无需身份验证，因此任何未经授权的攻击者都可能利用此漏洞。 

**漏洞利用方式：**

1.  攻击者向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送包含恶意 webshell 的上传请求。
2.  由于文件上传功能存在漏洞，恶意文件成功上传到服务器的 `/main/inc/lib/javascript/bigupload/files/` 目录。
3.  攻击者通过访问上传的 webshell，执行任意代码。

**POC代码分析：**

POC 代码 `CVE-2023-4220.py`  实现了漏洞的利用。代码首先检查目标是否存在漏洞利用所需的目录，然后上传包含PHP代码的 webshell。上传成功后，该脚本提供了一个交互式 shell，攻击者可以使用它在服务器上执行命令。该脚本还尝试通过 Tor 网络进行连接，并进行 User-Agent 伪装，以增加攻击的隐蔽性。 命令输入和输出被记录到 `command.log` 文件中。

**投毒风险分析：**

虽然 POC 代码的核心功能是漏洞利用，但存在轻微的投毒风险。风险点主要在于 `command.log` 文件。 虽然日志本身不是恶意的，但它会记录攻击者执行的所有命令，这些信息在某些情况下可能会被滥用或者泄露敏感信息。 此外，代码强制通过Tor代理, 也有可能被用于恶意目的。因此，投毒风险评估为10%。该评估是基于作者在其他地方增加恶意代码，如反向shell或数据窃取的可能性。没有直接证据表明存在恶意代码，但增加Tor代理使用的这种行为本身会引起警惕。

**项目地址:** [MikeyPPPPPPPP/CVE-2023-4220](https://github.com/MikeyPPPPPPPP/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #9

**来源**: [CVE-2023-4220-N1ghtfallXxX_CVE-2023-4220.md](../2023/CVE-2023-4220-N1ghtfallXxX_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo LMS-远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可完全控制服务器

**影响版本:** <= 1.11.24

**利用条件:** 需要网络访问，Chamilo LMS版本小于等于1.11.24

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个未授权的任意文件上传漏洞。攻击者可以通过向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送恶意请求，上传包含恶意代码的 PHP 文件，从而实现远程代码执行。

**有效性：**

根据搜索引擎结果和漏洞利用代码，该漏洞的利用是有效的。存在公开可用的 PoC 代码，可以验证该漏洞的存在并实现远程代码执行。搜索结果中也提到了远程代码执行的风险。

**投毒风险：**

提供的漏洞利用代码包含两个文件：`README.md` 和 `chamilo-rce.py`。
*   `README.md`: 包含漏洞描述、利用方法和免责声明，没有发现恶意代码。
*   `chamilo-rce.py`: 是一个 Python 脚本，用于生成包含反向 shell 的 PHP payload，并将其上传到目标服务器。脚本会根据用户输入的 IP 地址和端口，生成反向 shell 代码，并保存为 `rce.php` 文件。然后，脚本会构造一个 HTTP 请求，将 `rce.php` 文件上传到存在漏洞的 Chamilo LMS 实例。

虽然该脚本本身旨在利用漏洞，但它允许用户自定义反向 shell 的 IP 地址和端口。 因此，虽然利用本身是恶意的，但脚本本身并没有被投毒。只有非常轻微的投毒风险，例如在代码中引入细微的错误或依赖项，使得Payload失效，或者导致目标系统不稳定。但此几率极低。

**利用方式：**

1.  攻击者克隆包含PoC的git仓库 `https://github.com/N1ghtfallXxX/CVE-2023-4220` 
2.  攻击者通过 `chamilo-rce.py` 脚本生成包含恶意 PHP 代码的文件（Web Shell）。
3.  利用漏洞，未经验证上传恶意 PHP 文件。
4.  通过访问上传的 PHP 文件，执行其中的恶意代码，从而获得服务器的控制权。
5.  通过反弹shell连接攻击者本地监听端口,获得服务器shell

**项目地址:** [N1ghtfallXxX/CVE-2023-4220](https://github.com/N1ghtfallXxX/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #10

**来源**: [CVE-2023-4220-Pr1or95_CVE-2023-4220-exploit.md](../2023/CVE-2023-4220-Pr1or95_CVE-2023-4220-exploit.md)

## CVE-2023-4220-Chamilo LMS 未授权文件上传导致RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传/远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全被控制，数据泄露，安装勒索软件等

**影响版本:** <= 1.11.24

**利用条件:** 需要目标Chamilo LMS实例可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS <= 1.11.24 的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中，这是一个未经身份验证的大文件上传接口。攻击者可以通过该接口上传恶意webshell文件，从而获得服务器的远程代码执行权限。

**有效性:**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以判断该PoC代码有效。漏洞库信息明确指出该漏洞允许未经身份验证的攻击者上传webshell并执行任意代码。搜索引擎结果中也包含多个关于该漏洞的描述，并指出可以远程控制服务器。提供的PoC代码包含一个 bash 脚本 (CVE-2023-4220.sh)，该脚本自动化了webshell的上传和访问过程，验证了漏洞的可利用性。

**利用方式:**

1.  攻击者执行PoC脚本，指定webshell文件路径、目标Chamilo LMS的URL以及监听端口。
2.  脚本使用curl命令上传webshell到目标服务器的 `/main/inc/lib/javascript/bigupload/files/` 目录下。
3.  脚本尝试访问上传的webshell文件，并使用 `nc` 命令在指定端口上启动监听。
4.  成功访问webshell后，攻击者即可通过监听端口与webshell进行交互，从而执行任意系统命令。

**投毒风险:**

提供的PoC代码主要包含一个bash脚本和一个README文件。通过分析bash脚本的内容，可以发现脚本主要功能是上传文件，访问文件和启动一个网络监听。脚本本身没有明显的恶意代码，但是存在以下潜在的投毒风险：

1.  **依赖的webshell文件:** webshell文件本身可能包含恶意代码，例如反弹shell，下载并执行其他恶意程序等。但是，webshell的内容不由PoC作者控制，因此不应算作PoC本身的投毒。
2.  **README文件:** README文件用于说明PoC的使用方法，通常不会包含恶意代码。
3.  **sleep 时间:** 脚本中`sleep 3`指令可能会被恶意修改,增加sleep时间或者消耗服务器资源的操作,实现隐蔽的拒绝服务攻击.

综上所述，PoC代码本身存在投毒的可能性较低，大概为10%，主要的风险来自于攻击者使用的webshell文件。

**项目地址:** [Pr1or95/CVE-2023-4220-exploit](https://github.com/Pr1or95/CVE-2023-4220-exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #11

**来源**: [CVE-2023-4220-VanishedPeople_CVE-2023-4220.md](../2023/CVE-2023-4220-VanishedPeople_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 1.11.24

**利用条件:** 需要目标系统运行Chamilo LMS <= 1.11.24，并且攻击者可以访问到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个未授权的文件上传漏洞，存在于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中大文件上传功能处。攻击者可以利用此漏洞上传恶意 WebShell，从而获得服务器的远程代码执行权限。由于漏洞利用不需要身份验证，风险极高。

**有效性：**
根据提供的漏洞库信息、搜索结果和漏洞利用代码（尽管仅提供了许可证文件），可以判断该漏洞利用的有效性较高。 漏洞库信息明确指出该漏洞会导致远程代码执行，搜索结果也确认了这一点，并提供了相关的 PoC 链接 (https://github.com/VanishedPeople/CVE-2023-4220 )。

**投毒风险：**
提供的代码段是 Apache 2.0 许可证，本身不包含任何恶意代码。 因为只提供了license文件，无法评估其他代码文件是否包含后门, 考虑到poc的贡献者，以及该漏洞的细节，可以认为投毒的可能性较低。

**利用方式：**
1.  攻击者构造一个恶意的 WebShell 文件，例如 PHP 文件。
2.  利用 Chamilo LMS 中 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 的大文件上传功能，将恶意 WebShell 文件上传到服务器。
3.  通过访问上传的 WebShell 文件，执行任意代码，从而控制服务器。

由于上传过程未进行严格的文件类型检查或大小限制，攻击者可以绕过安全机制，成功上传恶意文件。


**项目地址:** [VanishedPeople/CVE-2023-4220](https://github.com/VanishedPeople/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #12

**来源**: [CVE-2023-4220-Ziad-Sakr_Chamilo-CVE-2023-4220-Exploit.md](../2023/CVE-2023-4220-Ziad-Sakr_Chamilo-CVE-2023-4220-Exploit.md)

## CVE-2023-4220 Chamilo LMS 远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行和服务器完全控制

**影响版本:** <= 1.11.24

**利用条件:** Chamilo LMS <= 1.11.24，目标服务器可访问，`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径存在且可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 漏洞存在于Chamilo LMS的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中，允许未经身份验证的攻击者通过上传恶意文件（例如webshell）来执行任意代码。该漏洞利用了 Chamilo LMS 大文件上传功能中的一个缺陷，攻击者通过构造特定的请求，将恶意文件上传到 `/main/inc/lib/javascript/bigupload/files/` 目录。上传的文件可以被直接访问并执行，导致远程代码执行。

**有效性：**

提供的POC代码通过 curl 命令模拟文件上传，指定了上传的文件路径、目标URL和执行reverse shell的端口。基本逻辑符合漏洞描述，利用步骤清晰，可以有效利用该漏洞。

**投毒风险：**

代码本身主要是通过curl上传文件，以及使用nc监听端口，看起来比较直接。但是，有几点需要关注：

1.  `reverse_file` 是用户可控的，这意味着如果用户不小心使用了包含恶意代码的文件作为 `reverse_file`，可能会引入投毒。
2.  脚本中提供了一段提示用户进行TTY交互的命令，这段命令本身没有恶意，但如果攻击者替换了其中的`/bin/bash`为其他恶意程序，可能会导致投毒。
3.  脚本执行后会启动一个`nc`监听进程，恶意用户可以连接到此端口执行命令，进行恶意操作。

综上，投毒风险较低，约为10%， 主要来自用户使用的 reverse shell 文件本身可能存在恶意代码。

**利用方式：**

1.  准备一个包含反弹shell代码的webshell文件（reverse_file）。
2.  使用提供的脚本 `CVE-2023-4220.sh`，通过 `-f` 参数指定 webshell 文件的路径，`-h` 参数指定 Chamilo LMS 的主机地址，`-p` 参数指定反弹 shell 的端口。
3.  脚本会使用 curl 命令将webshell上传到Chamilo LMS服务器的指定目录。
4.  脚本启动 nc 监听指定的端口。
5.  通过访问上传的 webshell 文件，触发反弹 shell，攻击者即可获得目标服务器的控制权。

**防范措施：**

1.  升级 Chamilo LMS 到最新版本。
2.  限制上传文件类型，对上传的文件进行安全检查。
3.  加强服务器安全配置，防止恶意代码执行。

**项目地址:** [Ziad-Sakr/Chamilo-CVE-2023-4220-Exploit](https://github.com/Ziad-Sakr/Chamilo-CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #13

**来源**: [CVE-2023-4220-bueno-armando_CVE-2023-4220-RCE.md](../2023/CVE-2023-4220-bueno-armando_CVE-2023-4220-RCE.md)

## CVE-2023-4220-Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** Chamilo LMS服务器可公开访问，且目标版本小于等于1.11.24

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220是Chamilo LMS中存在的一个未经身份验证的远程代码执行漏洞。该漏洞位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件中的大文件上传功能中。攻击者可以通过上传恶意PHP文件（webshell）来执行任意代码。 

**漏洞利用方式：**

1.  攻击者使用`curl`命令上传包含恶意代码的PHP文件到目标服务器的`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，利用大文件上传功能绕过身份验证。
2.  上传成功后，webshell存储在`/main/inc/lib/javascript/bigupload/files/`目录下，文件名为`rce.php`。
3.  攻击者通过`curl`命令访问上传的webshell(`/main/inc/lib/javascript/bigupload/files/rce.php`)，触发webshell中的恶意代码，实现远程代码执行。

**POC代码分析：**

提供的POC代码是一个Python脚本，它执行以下操作：

1.  接收目标URL、端口、命令和可选的反向shell参数。
2.  如果提供了命令，则对其进行Base64编码，然后将其包装在PHP代码中，以便通过`system()`函数执行。
3.  如果未提供命令，则构建一个反向shell命令，使用攻击者的IP地址和端口。
4.  将生成的PHP代码保存到`rce.php`文件中。
5.  使用`curl`命令将`rce.php`上传到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`。
6.  使用`curl`命令访问上传的`rce.php`，执行恶意代码。

**有效性评估：**

根据漏洞描述、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码能够成功上传并执行webshell，从而实现远程代码执行。

**投毒风险分析：**

对POC代码进行分析后，发现存在一定的投毒风险，概率为10%。主要体现在以下方面：

*   脚本直接使用`os.system()`函数执行外部命令，这可能允许攻击者在目标系统上执行任意命令。虽然脚本主要执行curl命令，理论上只涉及上传文件和访问文件，如果攻击者修改了上传文件或者篡改了访问的url, 导致执行系统命令，也存在被植入恶意后门的风险。

总体来说，该POC的投毒风险较低，因为脚本的功能比较明确，恶意行为不容易被隐藏。用户在使用时应仔细检查代码，确保没有被篡改。

**项目地址:** [bueno-armando/CVE-2023-4220-RCE](https://github.com/bueno-armando/CVE-2023-4220-RCE)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #14

**来源**: [CVE-2023-4220-charchit-subedi_chamilo-lms-unauthenticated-rce-poc.md](../2023/CVE-2023-4220-charchit-subedi_chamilo-lms-unauthenticated-rce-poc.md)

## CVE-2023-4220-Chamilo-Unauthenticated-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** RCE

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以通过上传webshell获得远程代码执行权限

**影响版本:** <= 1.11.24

**利用条件:** 需要目标Chamilo LMS实例存在，且版本小于等于1.11.24，并可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220是Chamilo LMS中的一个未经验证的文件上传漏洞，位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。未经身份验证的攻击者可以利用此漏洞上传恶意文件（webshell），从而执行任意代码。漏洞利用方式如下：

1.  **漏洞验证:** 通过访问`/main/inc/lib/javascript/bigupload/files/` 确认目录存在，验证目标是否存在漏洞。
2.  **webshell上传:** 使用POST请求向`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 上传包含PHP代码的恶意文件，文件名为`bigUploadFile`，文件内容为webshell。
3.  **代码执行:** 通过访问`{self.check_url}{filename}?cmd={command}` 执行webshell中的指令

根据提供的POC代码，漏洞利用代码有效。`exploit.py`文件包含`ChamiloBigUploadExploit`类，其中包含了验证漏洞、上传webshell和执行反向shell的方法。

投毒风险评估：

代码中存在动态构建和执行命令的部分，例如在`send_and_execute_revshell`函数中，存在编码绕过，创建bash反弹shell脚本并通过GET参数`cmd`执行。理论上，攻击者可以在`webshell_content`变量中注入恶意代码，或者在`send_and_execute_revshell`函数构建恶意命令。

查看仓库的`README.md`文件,作者要求使用 `pip install -r requirements.txt` 安装依赖包,需要检查`requirements.txt`内容。

在当前提供的代码片段中，没有发现明显的恶意代码。判断仓库中存在的投毒代码可能性为5%，需要进一步对依赖包进行检查。

利用方式总结：

1.  扫描目标以确认漏洞是否存在。
2.  上传webshell。
3.  （可选）上传和执行反向shell，或者直接使用webshell执行任意命令。

**项目地址:** [charchit-subedi/chamilo-lms-unauthenticated-rce-poc](https://github.com/charchit-subedi/chamilo-lms-unauthenticated-rce-poc)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #15

**来源**: [CVE-2023-4220-charlesgargasson_CVE-2023-4220.md](../2023/CVE-2023-4220-charlesgargasson_CVE-2023-4220.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经验证的攻击者执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，并且bigUpload功能未被禁用或修复。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 存在于Chamilo LMS的bigUpload功能中，允许未经身份验证的攻击者通过上传恶意文件（如webshell）来执行远程代码。漏洞位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。根据提供的漏洞利用代码，攻击者首先上传一个包含恶意PHP代码的文件（通常是webshell），然后通过构造特定的URL来访问该文件，从而执行webshell中的代码。

**有效性：**
从搜索结果和漏洞利用代码来看，该漏洞利用是有效的。漏洞库信息和多个搜索结果都表明该漏洞允许未经身份验证的远程代码执行。漏洞利用代码提供了一个简单的PoC，演示了如何上传PHP webshell并执行任意命令。

**投毒风险：**
提供的漏洞利用代码本身**不包含明显的投毒代码**。该代码的目的是上传webshell和执行命令。它首先创建一个名为`/tmp/rce.php`的临时文件，其中包含PHP代码来执行base64编码的命令。然后，使用`curl`命令上传这个文件到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，并使用另一个`curl`命令，通过URL参数`aoOoy`将要执行的命令以base64编码的形式传递给webshell。虽然执行任意命令本身存在安全风险，但是这段代码的主要目的是为了验证漏洞，并没有包含任何用于破坏系统或窃取信息的恶意逻辑。因此，投毒风险评估为0%。

**利用方式：**
1.  **确定目标Chamilo LMS的版本**：可以通过访问`/documentation/changelog.html`来确定版本。
2.  **构造恶意PHP文件（webshell）**：创建一个包含PHP代码的webshell，例如，允许执行任意命令的PHP脚本。
3.  **上传webshell**：使用`curl`命令或其他HTTP客户端，将webshell上传到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`。
4.  **执行命令**：使用`curl`或其他HTTP客户端，构造一个包含要执行的命令的URL，并访问上传的webshell。命令需要进行base64编码和URL编码。

该漏洞利用无需身份验证，攻击复杂度较高（需要了解目标系统的文件路径和URL结构），但影响是严重的，可能导致完全控制目标系统。

**项目地址:** [charlesgargasson/CVE-2023-4220](https://github.com/charlesgargasson/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #16

**来源**: [CVE-2023-4220-dollarboysushil_Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220.md](../2023/CVE-2023-4220-dollarboysushil_Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220.md)

## CVE-2023-4220 - Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传/远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者上传webshell并执行任意代码。

**影响版本:** <= 1.11.24

**利用条件:** 目标Chamilo LMS实例的`/main/inc/lib/javascript/bigupload/files`目录存在且Web服务器对该目录具有写入权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个严重的安全漏洞，影响版本小于等于 1.11.24。此漏洞位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中，允许未经身份验证的攻击者上传任意文件，包括恶意的 webshell。攻击者可以通过简单的 curl 命令上传 php 文件到 `/main/inc/lib/javascript/bigupload/files` 目录。上传后，攻击者可以通过访问该文件执行任意代码。 

**有效性：**  根据提供的POC代码和搜索结果，此漏洞利用是有效的。POC展示了如何使用 curl 命令上传包含恶意代码的 PHP 文件，并通过访问上传的文件来执行代码。搜索结果中也有很多链接提到了利用此漏洞进行远程代码执行的可能性。

**投毒风险：** 查看提供的漏洞利用代码，主要是演示了如何上传和执行一个简单的 `whoami` 命令的webshell。虽然直接的后门代码没有，但是需要考虑到，如果攻击者将此POC集成到自动化攻击脚本中，大规模利用，则会造成严重危害。 仓库中可能存在的投毒风险大约为10%。这个风险来自于以下可能性：
   * 仓库本身可能包含不明显的恶意代码，旨在在使用者部署或运行漏洞利用时执行其他恶意操作。例如，上传的webshell可能包含更复杂的功能，允许攻击者远程控制受害者服务器。 
   * 该漏洞利用可能会被修改以包含后门，然后重新分发。虽然原始POC可能没有恶意代码，但修改后的版本可能会包含。

**利用方式：** 

1.  **确定目标：**  找到运行 Chamilo LMS 1.11.24 或更早版本的系统。
2.  **上传 Webshell：**  使用 curl 或类似的工具，通过向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 发送包含恶意 PHP 代码的文件来上传 webshell。  文件名为webshell文件名，例如`dollarboysushil.php`。
3.  **执行代码：**  通过访问上传的 webshell 文件，例如 `http://<website>/main/inc/lib/javascript/bigupload/files/dollarboysushil.php`，来执行任意代码。 请先确认`/main/inc/lib/javascript/bigupload/files`路径存在。

总而言之，CVE-2023-4220 是一个严重的漏洞，利用简单，影响广泛。应该立即修补受影响的 Chamilo LMS 实例。即使是看起来无害的PoC代码，也需要进行安全审查后使用。

**项目地址:** [dollarboysushil/Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220](https://github.com/dollarboysushil/Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #17

**来源**: [CVE-2023-4220-gmh5225_CVE-2023-4220.md](../2023/CVE-2023-4220-gmh5225_CVE-2023-4220.md)

## CVE-2023-4220 - Chamilo LMS 未授权文件上传导致远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以上传WebShell，最终导致远程代码执行

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行着Chamilo LMS <= 1.11.24，且攻击者可以访问该系统的网络端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 存在于Chamilo LMS的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中。该文件存在未授权的文件上传漏洞，允许未经身份验证的攻击者上传任意文件，包括WebShell。 

**利用方式：**

1.  攻击者通过发送POST请求到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`，上传一个包含恶意代码的PHP文件（WebShell），文件名可以为任意值。
2.  上传的文件会被保存在 `/main/inc/lib/javascript/bigupload/files/` 目录下。
3.  攻击者通过访问 `/main/inc/lib/javascript/bigupload/files/{webshell_name}.php` 执行上传的WebShell，从而实现远程代码执行。

提供的POC代码（exploit.py）自动化了这一过程，首先检查目标是否存在漏洞，然后上传一个简单的WebShell (insomnia.php)，允许攻击者执行任意命令。 

**有效性：**

根据漏洞库信息、搜索引擎结果和漏洞利用代码，该POC代码是有效的，可以成功利用该漏洞实现远程代码执行。 搜索结果中的pentest-tools.com的描述和github上的POC都确认了漏洞的存在和利用方式。

**投毒风险：**

查看了POC代码，该代码主要功能是上传webshell，并无发现恶意投毒代码，代码有域名作者信息。但是仍然需要谨慎，因为上传的WebShell本身就是恶意代码，攻击者可以通过WebShell执行任何操作。我假设存在5%的风险, 代码库维护者或者代码贡献者在未来可能会添加一些恶意代码。

**项目地址:** [gmh5225/CVE-2023-4220](https://github.com/gmh5225/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #18

**来源**: [CVE-2023-4220-insomnia-jacob_CVE-2023-4220.md](../2023/CVE-2023-4220-insomnia-jacob_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo LMS-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未授权攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统安装了Chamilo LMS，且版本小于等于1.11.24，并且可以访问`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220是Chamilo LMS <= v1.11.24中`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件存在的一个未授权文件上传漏洞。攻击者可以利用此漏洞上传恶意webshell，从而实现远程代码执行。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者上传任意文件，包括webshell，导致远程代码执行。提供的POC代码看起来能够自动化利用该漏洞。

**投毒风险分析：**
查看提供的`exploit.py`脚本，该脚本的功能是：
1.  检测目标URL是否存在漏洞（通过检查`/main/inc/lib/javascript/bigupload/files`目录）。
2.  如果检测到漏洞，则上传一个名为`insomnia.php`的webshell到目标服务器的`/main/inc/lib/javascript/bigupload/files/`目录下。
3.  脚本中创建了一个简单的webshell，允许通过GET参数`cmd`执行系统命令。并没有发现隐藏的、恶意的或不必要的功能，因此认为投毒风险极低，为0%。

**利用方式：**
1.  攻击者使用POC脚本指定目标Chamilo LMS的URL。
2.  POC脚本检查目标是否存在漏洞。
3.  如果存在漏洞，POC脚本上传一个简单的webshell。
4.  攻击者通过访问webshell的URL，并提供`cmd`参数来执行任意系统命令，如`http://example.com/main/inc/lib/javascript/bigupload/files/insomnia.php?cmd=id`。

综上所述，该漏洞的利用方式简单直接，危害性高，且POC有效。尽管POC可能被修改为恶意用途，但当前提供的代码没有发现明显的投毒行为。

**项目地址:** [insomnia-jacob/CVE-2023-4220](https://github.com/insomnia-jacob/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #19

**来源**: [CVE-2023-4220-m3m0o_chamilo-lms-unauthenticated-big-upload-rce-poc.md](../2023/CVE-2023-4220-m3m0o_chamilo-lms-unauthenticated-big-upload-rce-poc.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全被控制，敏感信息泄露，安装勒索软件等

**影响版本:** <= 1.11.24

**利用条件:** 无需身份验证，需要目标系统运行受影响的Chamilo LMS版本并且 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径存在。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个高危漏洞，存在于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中。未经身份验证的攻击者可以通过上传恶意文件（例如 web shell）来执行任意代码。利用方式是，攻击者通过构造恶意请求，绕过文件上传限制，将包含恶意代码的文件上传到服务器。由于上传路径不受限制，攻击者可以访问上传的文件，从而执行其中的恶意代码。漏洞利用代码仓库中只包含Apache License协议，没有发现任何可疑代码，因此判定投毒风险为0%。搜索结果显示有公开的PoC可供利用。

**项目地址:** [m3m0o/chamilo-lms-unauthenticated-big-upload-rce-poc](https://github.com/m3m0o/chamilo-lms-unauthenticated-big-upload-rce-poc)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #20

**来源**: [CVE-2023-4220-nr4x4_CVE-2023-4220.md](../2023/CVE-2023-4220-nr4x4_CVE-2023-4220.md)

## CVE-2023-4220 - Chamilo LMS Unauthenticated RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可上传WebShell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS，且版本小于等于1.11.24，并且可以访问到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 页面。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个高危漏洞，允许未经身份验证的攻击者通过大文件上传功能上传恶意文件（WebShell），从而实现远程代码执行。

**有效性分析：**

*   漏洞库信息明确指出，Chamilo LMS <= 1.11.24 存在未经身份验证的文件上传漏洞。
*   搜索引擎结果中，大量网页描述了此漏洞，并确认可以实现 RCE。
*   提供的漏洞利用代码包含 Python 脚本 (cve-2023-4220.py) 和 Shell 脚本 (cve-2023-4220.sh)，分别用于交互式 RCE 和反弹 Shell。同时，README.md 中提供了使用 curl 命令手动上传 WebShell 并执行的步骤。
*   漏洞利用代码中的curl 命令尝试上传 `jiji.php` 到 `/main/inc/lib/javascript/bigupload/files/` 目录。通过访问该文件并附加 `jiji` 参数，攻击者可以执行任意系统命令。
*   综合来看，POC代码是有效的，可以利用该漏洞在目标系统上执行任意代码。

**投毒风险分析：**

*   查看提供的代码文件，核心利用逻辑主要集中在上传webshell和执行命令。没有发现明显的恶意代码，如删除文件、修改系统配置等。
*   `cve-2023-4220.sh` 脚本提供了反弹 shell 的功能，攻击者可以利用它来建立持久的远程访问。 虽然这个功能本身是漏洞利用的一部分，但也可能被滥用。
*   `cve-2023-4220.py` 脚本动态生成 webshell 文件，这在一定程度上增加了审查难度，存在细微的隐藏恶意代码的可能性。
*   虽然图片文件显示了命令执行的结果，本身并没有任何恶意代码。
*   综合评估，存在轻微的投毒风险，主要来自于脚本提供的反弹 shell 功能和动态生成webshell文件带来的审查难度，但是可能性较低，概率在5%左右。

**利用方式：**

1.  **上传 WebShell：** 攻击者使用 curl 命令或提供的脚本，将包含恶意代码的 PHP 文件（WebShell）上传到 Chamilo LMS 的 `/main/inc/lib/javascript/bigupload/files/` 目录。利用的上传点为 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`
2.  **执行命令：** 攻击者通过构造 URL，访问上传的 WebShell 文件，并在 URL 中传递要执行的系统命令。例如，`http://<chamilo>/main/inc/lib/javascript/bigupload/files/jiji.php?jiji=id`。
3.  **反弹 Shell (可选):** 使用 `cve-2023-4220.sh` 脚本提供的反弹 shell 功能，获取目标系统的 shell 控制权。

**总结：**

该漏洞利用方式简单，风险高，容易被攻击者利用。系统管理员应尽快升级 Chamilo LMS 版本到安全版本，并检查是否存在恶意上传的文件。

**项目地址:** [nr4x4/CVE-2023-4220](https://github.com/nr4x4/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #21

**来源**: [CVE-2023-4220-numaan911098_CVE-2023-4220.md](../2023/CVE-2023-4220-numaan911098_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-Unrestricted File Upload

**漏洞编号:** CVE-2023-4220

**漏洞类型:** Unrestricted File Upload

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行和存储型XSS

**影响版本:** <= 1.11.24

**利用条件:** 无需身份验证，目标Chamilo LMS实例允许未授权访问/main/inc/lib/javascript/bigupload/inc/bigUpload.php

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-4220 是 Chamilo LMS 1.11.24 及更早版本中存在的一个未授权文件上传漏洞。该漏洞位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中。攻击者可以通过上传包含恶意代码（例如 Web Shell）的文件，实现远程代码执行 (RCE) 和存储型跨站脚本攻击 (XSS)。

**有效性：** 提供的 PoC 代码显示了攻击者如何利用此漏洞上传恶意文件。`CVE-2023-4220.py` 脚本通过 `requests` 库向目标 URL 的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送 POST 请求，上传名为 `bigUploadFile` 的文件。上传成功后，脚本会尝试访问上传的文件，如果返回状态码为 200，则表示利用成功。`Reverse-shell.php` 文件包含一个 PHP 反向 Shell 脚本，用于在服务器上执行任意命令。

**投毒风险：** 提供的 PoC 代码主要用于验证漏洞的存在，并通过上传反向 Shell 来获取远程代码执行权限。`Reverse-shell.php` 脚本本身可以被认为是具有恶意功能的后门代码，但从仓库代码整体来看，并没有发现明显的投毒行为。投毒的概率较低，估计为10%。需要关注点在于，下载此PoC的用户如果直接使用或者修改reverse shell脚本，可能会不小心引入其他的恶意代码，但这不是原作者的投毒意图。

**利用方式：**

1.  攻击者构造一个包含恶意代码的 Web Shell 文件（例如 `Reverse-shell.php`）。
2.  攻击者使用 PoC 脚本（例如 `CVE-2023-4220.py`）向目标 Chamilo LMS 实例的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送 POST 请求，上传 Web Shell 文件。
3.  如果上传成功，攻击者可以通过访问上传的 Web Shell 文件来执行任意命令。
4.  利用 `Reverse-shell.php`，攻击者可以获得服务器的反向 Shell，从而完全控制服务器。

**项目地址:** [numaan911098/CVE-2023-4220](https://github.com/numaan911098/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #22

**来源**: [CVE-2023-4220-oxapavan_CVE-2023-4220-HTB-PermX.md](../2023/CVE-2023-4220-oxapavan_CVE-2023-4220-HTB-PermX.md)

## CVE-2023-4220-Chamilo LMS Unauthenticated RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传导致远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制，数据泄露，安装勒索软件

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，且能够通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个关键漏洞，攻击者可以通过未经身份验证的文件上传功能（`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`）上传恶意文件（如 webshell）。

**漏洞利用方式：**

1.  攻击者使用提供的 PoC 脚本（`CVE-2023-4220.sh`或`script.sh`）进行利用。
2.  脚本通过 curl 命令将恶意文件（reverse shell）上传到 `/main/inc/lib/javascript/bigupload/files/` 目录。
3.  脚本然后尝试访问上传的文件，从而执行恶意代码。
4.  脚本还尝试使用`nc`命令监听目标端口，用于接收反向 shell 连接。

**有效性：**

根据漏洞描述和 PoC 代码，该漏洞利用是有效的。多个搜索结果表明该漏洞允许未经身份验证的远程代码执行。

**投毒风险分析：**

分析提供的 PoC 代码，没有发现明显的投毒代码。脚本的功能是上传文件并尝试触发执行，没有发现恶意修改目标系统或进行其他未声明操作的代码。代码主要通过curl和netcat进行远程利用，没有发现可疑行为，故判定投毒风险为0%。

**项目地址:** [oxapavan/CVE-2023-4220-HTB-PermX](https://github.com/oxapavan/CVE-2023-4220-HTB-PermX)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #23

**来源**: [CVE-2023-4220-qrxnz_CVE-2023-4220.md](../2023/CVE-2023-4220-qrxnz_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo LMS-未授权文件上传导致RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致远程代码执行和存储型XSS

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS，且版本小于等于1.11.24，需要网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220是Chamilo LMS 1.11.24及更早版本中存在的一个高危漏洞。该漏洞位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件中，允许未经身份验证的攻击者通过`big file upload`功能上传任意文件。由于未对上传的文件类型进行充分验证，攻击者可以上传包含恶意代码的Web Shell，从而执行存储型跨站脚本攻击(XSS)或实现远程代码执行(RCE)。

**有效性：** 根据搜索结果和漏洞描述，该漏洞的PoC是存在的，并且可以实现RCE。根据搜索结果，GitHub上已经有公开的PoC代码（https://github.com/VanishedPeople/CVE-2023-4220），证明漏洞的可利用性。

**投毒风险：** 提供的漏洞利用代码`/tmp/10c4d756f57f88eae973d9e10fafe40c/README.md` 非常简单，只是一个包含CVE编号的说明文件，恶意代码不太可能存在于此文件本身。 但是，由于该漏洞是关于文件上传，而提供的代码只是一个README文件，需要进一步查找其他文件，才能确定投毒风险。结合搜索结果中提供的POC链接，假设该PoC仓库包含其他文件，例如用于上传的脚本或webshell，则在这些脚本中可能存在作者隐藏的恶意代码，例如反向shell、信息收集或其他恶意功能。因此，存在一定投毒的风险，估计为10%，主要是考虑到需要进一步分析完整的POC代码才能做出准确判断，目前只看到了README文件。

**利用方式：**
1.  攻击者无需身份验证，可以直接访问`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。
2.  利用`big file upload`功能上传恶意文件，例如包含PHP代码的Web Shell。
3.  由于未充分验证文件类型，恶意文件会被服务器接受并存储。
4.  攻击者可以通过访问上传的Web Shell来执行任意PHP代码，从而控制服务器。
5.  攻击者还可以利用上传的Web Shell执行存储型XSS攻击，影响其他用户。


**项目地址:** [qrxnz/CVE-2023-4220](https://github.com/qrxnz/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #24

**来源**: [CVE-2023-4220-thefizzyfish_CVE-2023-4220_Chamilo_RCE.md](../2023/CVE-2023-4220-thefizzyfish_CVE-2023-4220_Chamilo_RCE.md)

## CVE-2023-4220 - Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以上传WebShell，从而完全控制服务器，窃取机密信息，安装勒索软件

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行 Chamilo LMS 且版本低于或等于 1.11.24，并且未进行漏洞修复

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS 的 bigUpload.php 文件中，允许未经身份验证的攻击者上传恶意文件（WebShell），从而实现远程代码执行。POC 代码通过构造包含恶意 PHP 代码的文件，并利用 bigUpload 功能上传该文件。上传成功后，攻击者可以通过访问该文件来执行任意命令。代码中存在轻微的投毒风险，因为攻击者可能会修改上传的文件内容，例如，在 WebShell 中加入恶意代码，用于收集用户信息或者进行其他恶意活动。但仓库中LICENSE文件是标准的MIT协议,文件结构简单,基本可以排除作者投毒风险,该风险主要存在于使用者,如果使用者修改了代码，那投毒风险会提升。

**利用方式：**
1.  攻击者利用未经身份验证的文件上传漏洞，将包含恶意 PHP 代码的 Webshell 文件上传到 `/main/inc/lib/javascript/bigupload/files/` 目录下。
2.  攻击者通过构造特定的 URL 请求，访问上传的 Webshell 文件，并传递要执行的命令。
3.  服务器执行 Webshell 中的 PHP 代码，从而执行攻击者指定的命令。
4.  攻击者利用执行的命令获取服务器的控制权，例如，反弹 Shell。

**POC 代码分析：**
*   `CVE-2023-4220.py`: 该 Python 脚本实现了漏洞利用的自动化，它首先构造包含反弹 Shell 代码的 Webshell 文件，然后将其上传到目标服务器，最后通过发送 GET 请求触发 Webshell 的执行。
*   `README.md`: 包含漏洞的简要描述和利用方法。
*   `LICENSE`: 使用 MIT 许可证。

**项目地址:** [thefizzyfish/CVE-2023-4220_Chamilo_RCE](https://github.com/thefizzyfish/CVE-2023-4220_Chamilo_RCE)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #25

**来源**: [CVE-2023-4220-zora-beep_CVE-2023-4220.md](../2023/CVE-2023-4220-zora-beep_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全被控制

**影响版本:** <= 1.11.24

**利用条件:** 需要目标服务器运行Chamilo LMS，且版本在受影响范围内。攻击者需要能够通过网络访问目标服务器的`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个未授权文件上传漏洞，位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中。未经身份验证的攻击者可以通过上传恶意文件（如 webshell）来执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** `bigUpload.php` 文件处理大文件上传功能时，未对上传的文件类型进行严格的验证，允许上传具有危险类型的文件，如 PHP 文件。
2.  **利用步骤：**
    *   攻击者使用提供的 `exploit.py` 脚本，指定目标 Chamilo LMS 实例的 URL 和要上传的 webshell 文件。
    *   脚本将 webshell 文件通过 POST 请求发送到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 路径。
    *   如果上传成功，攻击者可以通过访问上传的 webshell 文件来执行任意代码。

3.  **有效性分析：** 根据漏洞描述和搜索引擎结果，该漏洞的 POC 代码是有效的，可以实现远程代码执行。

4.  **投毒风险分析：**
    *   `exploit.py` 脚本是一个简单的文件上传脚本，主要功能是发送 POST 请求，上传指定的文件到目标 URL。代码本身没有发现任何可疑或恶意的行为。
    *   `README.md` 文件仅包含脚本的使用说明，没有包含任何可执行代码或恶意链接。
    *   因此，该仓库中存在投毒代码的可能性较低，可以判断投毒风险为0%。

5.  **利用方式总结：**
    *   **目标：** Chamilo LMS <= 1.11.24
    *   **漏洞：** 未授权文件上传 (CVE-2023-4220)
    *   **攻击方式：** 使用 `exploit.py` 脚本上传 webshell 到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`，然后访问 webshell 执行任意代码。

**项目地址:** [zora-beep/CVE-2023-4220](https://github.com/zora-beep/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---



---

## POC #5

**来源**: [CVE-2023-4220-H4cking4All_CVE-2023-4220.md](../2023/CVE-2023-4220-H4cking4All_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** Chamilo LMS 实例需要运行在易受攻击的版本上，并且需要能够通过网络访问 vulnerable_url

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS <= 1.11.24 的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中，是一个未授权的文件上传漏洞。

**有效性:**

根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判定该漏洞利用代码是有效的。漏洞库信息明确指出该漏洞允许未经身份验证的攻击者上传 webshell 并执行远程代码。搜索引擎结果中也提到了这一点，并给出了PoC链接。漏洞利用代码 `exploit.py` 实现了漏洞利用的完整流程，包括：

1.  **检查目标 URL 是否易受攻击:**  `checkVuln` 函数通过检查 `/main/inc/lib/javascript/bigupload/files` 目录的可访问性来判断目标是否存在漏洞。
2.  **上传 webshell:**  `exploitVuln` 函数通过 POST 请求将包含恶意 PHP 代码 (webshell) 的文件上传到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，服务器会将文件存储在 `/main/inc/lib/javascript/bigupload/files` 目录下。
3.  **执行命令:** 漏洞利用代码通过访问上传的 webshell，利用 GET 参数 `cmd` 执行任意系统命令。
4.  **反弹shell:** 通过webshell执行bash反弹shell命令,获取服务器控制权.

**投毒风险:**

对提供的 `exploit.py` 代码进行分析，发现存在轻微的投毒风险。风险主要来自于以下几点：

*   **硬编码代理:** 代码中存在 `proxy = {'http': 'http://localhost:8080/'}`。如果用户没有注意到这一行，并且本地没有运行代理服务，可能会导致漏洞利用失败，并泄露目标URL。这是一个潜在的流量劫持点，虽然不太可能是有意的投毒，但仍存在一定风险。
*   **输入webshell文件名:** 漏洞利用代码允许用户自定义webshell的文件名,如果用户设置恶意文件名,可能会影响后续利用.
*   **Reverse Shell IP 和端口:** 脚本要求用户输入攻击者的 IP 地址和端口。如果攻击者没有正确配置监听器，则反弹 shell 将无法建立连接。

虽然存在上述风险，但这些风险更偏向于可用性问题，而不是恶意代码。漏洞利用的整体逻辑是清晰的，旨在利用漏洞，而不是进行恶意活动，因此投毒风险较低，估计在 10% 左右。

**利用方式:**

1.  **确定目标 Chamilo LMS 版本:**  确认目标 Chamilo LMS 实例的版本小于等于 1.11.24。
2.  **运行 `exploit.py`:**  使用 Python 运行 `exploit.py` 脚本，并提供目标 Chamilo LMS 的 URL 作为参数，选择 `exploit` 模式。
3.  **输入 webshell 文件名：** 输入希望使用的 webshell 文件名（不包含扩展名）。
4.  **设置反弹 shell 信息:**  输入攻击者的 IP 地址和端口，确保攻击者机器上已经启动了 netcat 监听器。
5.  **获取 shell:**  如果漏洞利用成功，攻击者将会在 netcat 监听器上获得一个反弹 shell，从而控制目标服务器。

**项目地址:** [H4cking4All/CVE-2023-4220](https://github.com/H4cking4All/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #6

**来源**: [CVE-2023-4220-HO4XXX_cve-2023-4220-poc.md](../2023/CVE-2023-4220-HO4XXX_cve-2023-4220-poc.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传导致远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未授权攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS <= 1.11.24，并且可以网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Chamilo LMS的bigupload功能中。攻击者可以通过未授权的文件上传，将恶意webshell上传到服务器，然后通过访问webshell执行任意代码。

**有效性评估：**
根据漏洞描述和搜索结果，该漏洞是真实存在的，且危害严重。提供的PoC代码基本完整，能够实现未经身份验证的webshell上传和命令执行。PoC通过发送multipart/form-data请求，上传包含PHP代码的文件到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`处理，然后通过访问上传的文件触发webshell执行。

**投毒风险评估：**
PoC代码主要功能是上传webshell和执行命令，检查了`poc.py`脚本，发现存在一定的投毒风险。风险点包括：

1.  **revshell代码：** PoC中包含上传反向shell的代码，如果攻击者不小心或者不理解代码，直接运行，可能会在自己的机器上打开端口，等待被连接，增加了风险。
2.  **URL参数：** PoC需要指定目标URL，如果攻击者不小心将URL指向自己的机器，可能会将webshell上传到自己的服务器上。
3.  **文件名：** PoC可以自定义上传的文件名，如果攻击者使用一些敏感的文件名，可能会引起管理员的注意。

总体来说，PoC代码本身投毒的概率较低，但使用不当可能会带来一定的安全风险。因此，需要在使用PoC代码时，仔细阅读代码，理解代码的逻辑，并采取必要的安全措施。

**漏洞利用方式：**
1.  攻击者利用未授权文件上传漏洞，上传webshell（例如PHP脚本）到Chamilo LMS服务器。
2.  攻击者通过构造特定的URL，访问上传的webshell，触发webshell执行。
3.  Webshell执行后，攻击者可以在服务器上执行任意代码，例如窃取数据、篡改网站内容、控制服务器等。

**缓解措施：**
1.  升级Chamilo LMS到最新版本，修复此漏洞。
2.  限制上传文件类型，禁止上传PHP等可执行文件。
3.  加强服务器安全配置，防止webshell执行。

**项目地址:** [HO4XXX/cve-2023-4220-poc](https://github.com/HO4XXX/cve-2023-4220-poc)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #7

**来源**: [CVE-2023-4220-LGenAgul_CVE-2023-4220-Proof-of-concept.md](../2023/CVE-2023-4220-LGenAgul_CVE-2023-4220-Proof-of-concept.md)

## CVE-2023-4220-Chamilo LMS-远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制，包括信息窃取、安装勒索软件等

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS <= 1.11.24，且`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件存在且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220是Chamilo LMS中一个未经验证的任意文件上传漏洞，位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`的“大文件上传”功能中。攻击者无需身份验证即可上传恶意文件（例如，PHP webshell），从而实现存储型跨站脚本攻击 (XSS) 和远程代码执行 (RCE)。

**利用方式：**

1.  **上传恶意文件：** 攻击者使用POST请求将包含恶意代码（如PHP反向shell）的webshell文件上传到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`。该漏洞允许上传任意类型的文件，绕过了文件类型检查。
2.  **触发恶意代码执行：** 成功上传后，攻击者通过访问上传的文件（例如：`/main/inc/lib/javascript/bigupload/files/cmd.php?ip=<攻击者IP>&port=<攻击者端口>`）来触发webshell的执行。这将导致服务器执行攻击者上传的恶意代码。
3.  **获取反向Shell：** 攻击者需要提前在攻击机上监听指定的端口（例如，使用`nc -lvnp <端口>`）。当webshell执行时，它会尝试连接攻击者的IP地址和端口，从而建立一个反向shell连接，使攻击者能够远程控制受害服务器。

**POC有效性评估：**

提供的PoC代码（`exploit.py`）实现了上述利用过程。它首先创建一个包含反向shell代码的PHP文件（`cmd.php`），然后将其上传到存在漏洞的服务器，并通过HTTP GET请求触发该文件的执行。PoC代码还包含启动netcat监听器的功能，用于接收反向shell连接。根据搜索结果和漏洞描述，此PoC代码被认为是有效的。

**投毒风险评估：**

虽然该代码的主要目的是利用漏洞获取反向shell，但仍然存在一定的投毒风险。该脚本执行后，会在目标系统上写入webshell文件，并且通过HTTP请求访问该webshell。理论上，作者可能在shell代码中插入额外的恶意代码，例如，用于收集系统信息、植入后门或进行其他恶意活动。此外，上传webshell本身就存在一定风险，因为webshell可能被其他攻击者利用。由于该脚本来自非官方渠道，并且webshell本身就具有潜在的风险，因此投毒的可能性评估为10%。

**项目地址:** [LGenAgul/CVE-2023-4220-Proof-of-concept](https://github.com/LGenAgul/CVE-2023-4220-Proof-of-concept)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #8

**来源**: [CVE-2023-4220-MikeyPPPPPPPP_CVE-2023-4220.md](../2023/CVE-2023-4220-MikeyPPPPPPPP_CVE-2023-4220.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 文件上传漏洞

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行和跨站脚本攻击

**影响版本:** <= 1.11.24

**利用条件:** 目标Chamilo LMS实例运行在受影响的版本上，且`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS 的大文件上传功能中，攻击者可以通过上传恶意文件，例如 webshell，从而实现远程代码执行。由于该漏洞无需身份验证，因此任何未经授权的攻击者都可能利用此漏洞。 

**漏洞利用方式：**

1.  攻击者向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送包含恶意 webshell 的上传请求。
2.  由于文件上传功能存在漏洞，恶意文件成功上传到服务器的 `/main/inc/lib/javascript/bigupload/files/` 目录。
3.  攻击者通过访问上传的 webshell，执行任意代码。

**POC代码分析：**

POC 代码 `CVE-2023-4220.py`  实现了漏洞的利用。代码首先检查目标是否存在漏洞利用所需的目录，然后上传包含PHP代码的 webshell。上传成功后，该脚本提供了一个交互式 shell，攻击者可以使用它在服务器上执行命令。该脚本还尝试通过 Tor 网络进行连接，并进行 User-Agent 伪装，以增加攻击的隐蔽性。 命令输入和输出被记录到 `command.log` 文件中。

**投毒风险分析：**

虽然 POC 代码的核心功能是漏洞利用，但存在轻微的投毒风险。风险点主要在于 `command.log` 文件。 虽然日志本身不是恶意的，但它会记录攻击者执行的所有命令，这些信息在某些情况下可能会被滥用或者泄露敏感信息。 此外，代码强制通过Tor代理, 也有可能被用于恶意目的。因此，投毒风险评估为10%。该评估是基于作者在其他地方增加恶意代码，如反向shell或数据窃取的可能性。没有直接证据表明存在恶意代码，但增加Tor代理使用的这种行为本身会引起警惕。

**项目地址:** [MikeyPPPPPPPP/CVE-2023-4220](https://github.com/MikeyPPPPPPPP/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #9

**来源**: [CVE-2023-4220-N1ghtfallXxX_CVE-2023-4220.md](../2023/CVE-2023-4220-N1ghtfallXxX_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo LMS-远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可完全控制服务器

**影响版本:** <= 1.11.24

**利用条件:** 需要网络访问，Chamilo LMS版本小于等于1.11.24

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个未授权的任意文件上传漏洞。攻击者可以通过向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送恶意请求，上传包含恶意代码的 PHP 文件，从而实现远程代码执行。

**有效性：**

根据搜索引擎结果和漏洞利用代码，该漏洞的利用是有效的。存在公开可用的 PoC 代码，可以验证该漏洞的存在并实现远程代码执行。搜索结果中也提到了远程代码执行的风险。

**投毒风险：**

提供的漏洞利用代码包含两个文件：`README.md` 和 `chamilo-rce.py`。
*   `README.md`: 包含漏洞描述、利用方法和免责声明，没有发现恶意代码。
*   `chamilo-rce.py`: 是一个 Python 脚本，用于生成包含反向 shell 的 PHP payload，并将其上传到目标服务器。脚本会根据用户输入的 IP 地址和端口，生成反向 shell 代码，并保存为 `rce.php` 文件。然后，脚本会构造一个 HTTP 请求，将 `rce.php` 文件上传到存在漏洞的 Chamilo LMS 实例。

虽然该脚本本身旨在利用漏洞，但它允许用户自定义反向 shell 的 IP 地址和端口。 因此，虽然利用本身是恶意的，但脚本本身并没有被投毒。只有非常轻微的投毒风险，例如在代码中引入细微的错误或依赖项，使得Payload失效，或者导致目标系统不稳定。但此几率极低。

**利用方式：**

1.  攻击者克隆包含PoC的git仓库 `https://github.com/N1ghtfallXxX/CVE-2023-4220` 
2.  攻击者通过 `chamilo-rce.py` 脚本生成包含恶意 PHP 代码的文件（Web Shell）。
3.  利用漏洞，未经验证上传恶意 PHP 文件。
4.  通过访问上传的 PHP 文件，执行其中的恶意代码，从而获得服务器的控制权。
5.  通过反弹shell连接攻击者本地监听端口,获得服务器shell

**项目地址:** [N1ghtfallXxX/CVE-2023-4220](https://github.com/N1ghtfallXxX/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #10

**来源**: [CVE-2023-4220-Pr1or95_CVE-2023-4220-exploit.md](../2023/CVE-2023-4220-Pr1or95_CVE-2023-4220-exploit.md)

## CVE-2023-4220-Chamilo LMS 未授权文件上传导致RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传/远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全被控制，数据泄露，安装勒索软件等

**影响版本:** <= 1.11.24

**利用条件:** 需要目标Chamilo LMS实例可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS <= 1.11.24 的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中，这是一个未经身份验证的大文件上传接口。攻击者可以通过该接口上传恶意webshell文件，从而获得服务器的远程代码执行权限。

**有效性:**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以判断该PoC代码有效。漏洞库信息明确指出该漏洞允许未经身份验证的攻击者上传webshell并执行任意代码。搜索引擎结果中也包含多个关于该漏洞的描述，并指出可以远程控制服务器。提供的PoC代码包含一个 bash 脚本 (CVE-2023-4220.sh)，该脚本自动化了webshell的上传和访问过程，验证了漏洞的可利用性。

**利用方式:**

1.  攻击者执行PoC脚本，指定webshell文件路径、目标Chamilo LMS的URL以及监听端口。
2.  脚本使用curl命令上传webshell到目标服务器的 `/main/inc/lib/javascript/bigupload/files/` 目录下。
3.  脚本尝试访问上传的webshell文件，并使用 `nc` 命令在指定端口上启动监听。
4.  成功访问webshell后，攻击者即可通过监听端口与webshell进行交互，从而执行任意系统命令。

**投毒风险:**

提供的PoC代码主要包含一个bash脚本和一个README文件。通过分析bash脚本的内容，可以发现脚本主要功能是上传文件，访问文件和启动一个网络监听。脚本本身没有明显的恶意代码，但是存在以下潜在的投毒风险：

1.  **依赖的webshell文件:** webshell文件本身可能包含恶意代码，例如反弹shell，下载并执行其他恶意程序等。但是，webshell的内容不由PoC作者控制，因此不应算作PoC本身的投毒。
2.  **README文件:** README文件用于说明PoC的使用方法，通常不会包含恶意代码。
3.  **sleep 时间:** 脚本中`sleep 3`指令可能会被恶意修改,增加sleep时间或者消耗服务器资源的操作,实现隐蔽的拒绝服务攻击.

综上所述，PoC代码本身存在投毒的可能性较低，大概为10%，主要的风险来自于攻击者使用的webshell文件。

**项目地址:** [Pr1or95/CVE-2023-4220-exploit](https://github.com/Pr1or95/CVE-2023-4220-exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #11

**来源**: [CVE-2023-4220-VanishedPeople_CVE-2023-4220.md](../2023/CVE-2023-4220-VanishedPeople_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 1.11.24

**利用条件:** 需要目标系统运行Chamilo LMS <= 1.11.24，并且攻击者可以访问到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个未授权的文件上传漏洞，存在于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中大文件上传功能处。攻击者可以利用此漏洞上传恶意 WebShell，从而获得服务器的远程代码执行权限。由于漏洞利用不需要身份验证，风险极高。

**有效性：**
根据提供的漏洞库信息、搜索结果和漏洞利用代码（尽管仅提供了许可证文件），可以判断该漏洞利用的有效性较高。 漏洞库信息明确指出该漏洞会导致远程代码执行，搜索结果也确认了这一点，并提供了相关的 PoC 链接 (https://github.com/VanishedPeople/CVE-2023-4220 )。

**投毒风险：**
提供的代码段是 Apache 2.0 许可证，本身不包含任何恶意代码。 因为只提供了license文件，无法评估其他代码文件是否包含后门, 考虑到poc的贡献者，以及该漏洞的细节，可以认为投毒的可能性较低。

**利用方式：**
1.  攻击者构造一个恶意的 WebShell 文件，例如 PHP 文件。
2.  利用 Chamilo LMS 中 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 的大文件上传功能，将恶意 WebShell 文件上传到服务器。
3.  通过访问上传的 WebShell 文件，执行任意代码，从而控制服务器。

由于上传过程未进行严格的文件类型检查或大小限制，攻击者可以绕过安全机制，成功上传恶意文件。


**项目地址:** [VanishedPeople/CVE-2023-4220](https://github.com/VanishedPeople/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #12

**来源**: [CVE-2023-4220-Ziad-Sakr_Chamilo-CVE-2023-4220-Exploit.md](../2023/CVE-2023-4220-Ziad-Sakr_Chamilo-CVE-2023-4220-Exploit.md)

## CVE-2023-4220 Chamilo LMS 远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行和服务器完全控制

**影响版本:** <= 1.11.24

**利用条件:** Chamilo LMS <= 1.11.24，目标服务器可访问，`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径存在且可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 漏洞存在于Chamilo LMS的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中，允许未经身份验证的攻击者通过上传恶意文件（例如webshell）来执行任意代码。该漏洞利用了 Chamilo LMS 大文件上传功能中的一个缺陷，攻击者通过构造特定的请求，将恶意文件上传到 `/main/inc/lib/javascript/bigupload/files/` 目录。上传的文件可以被直接访问并执行，导致远程代码执行。

**有效性：**

提供的POC代码通过 curl 命令模拟文件上传，指定了上传的文件路径、目标URL和执行reverse shell的端口。基本逻辑符合漏洞描述，利用步骤清晰，可以有效利用该漏洞。

**投毒风险：**

代码本身主要是通过curl上传文件，以及使用nc监听端口，看起来比较直接。但是，有几点需要关注：

1.  `reverse_file` 是用户可控的，这意味着如果用户不小心使用了包含恶意代码的文件作为 `reverse_file`，可能会引入投毒。
2.  脚本中提供了一段提示用户进行TTY交互的命令，这段命令本身没有恶意，但如果攻击者替换了其中的`/bin/bash`为其他恶意程序，可能会导致投毒。
3.  脚本执行后会启动一个`nc`监听进程，恶意用户可以连接到此端口执行命令，进行恶意操作。

综上，投毒风险较低，约为10%， 主要来自用户使用的 reverse shell 文件本身可能存在恶意代码。

**利用方式：**

1.  准备一个包含反弹shell代码的webshell文件（reverse_file）。
2.  使用提供的脚本 `CVE-2023-4220.sh`，通过 `-f` 参数指定 webshell 文件的路径，`-h` 参数指定 Chamilo LMS 的主机地址，`-p` 参数指定反弹 shell 的端口。
3.  脚本会使用 curl 命令将webshell上传到Chamilo LMS服务器的指定目录。
4.  脚本启动 nc 监听指定的端口。
5.  通过访问上传的 webshell 文件，触发反弹 shell，攻击者即可获得目标服务器的控制权。

**防范措施：**

1.  升级 Chamilo LMS 到最新版本。
2.  限制上传文件类型，对上传的文件进行安全检查。
3.  加强服务器安全配置，防止恶意代码执行。

**项目地址:** [Ziad-Sakr/Chamilo-CVE-2023-4220-Exploit](https://github.com/Ziad-Sakr/Chamilo-CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #13

**来源**: [CVE-2023-4220-bueno-armando_CVE-2023-4220-RCE.md](../2023/CVE-2023-4220-bueno-armando_CVE-2023-4220-RCE.md)

## CVE-2023-4220-Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** Chamilo LMS服务器可公开访问，且目标版本小于等于1.11.24

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220是Chamilo LMS中存在的一个未经身份验证的远程代码执行漏洞。该漏洞位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件中的大文件上传功能中。攻击者可以通过上传恶意PHP文件（webshell）来执行任意代码。 

**漏洞利用方式：**

1.  攻击者使用`curl`命令上传包含恶意代码的PHP文件到目标服务器的`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，利用大文件上传功能绕过身份验证。
2.  上传成功后，webshell存储在`/main/inc/lib/javascript/bigupload/files/`目录下，文件名为`rce.php`。
3.  攻击者通过`curl`命令访问上传的webshell(`/main/inc/lib/javascript/bigupload/files/rce.php`)，触发webshell中的恶意代码，实现远程代码执行。

**POC代码分析：**

提供的POC代码是一个Python脚本，它执行以下操作：

1.  接收目标URL、端口、命令和可选的反向shell参数。
2.  如果提供了命令，则对其进行Base64编码，然后将其包装在PHP代码中，以便通过`system()`函数执行。
3.  如果未提供命令，则构建一个反向shell命令，使用攻击者的IP地址和端口。
4.  将生成的PHP代码保存到`rce.php`文件中。
5.  使用`curl`命令将`rce.php`上传到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`。
6.  使用`curl`命令访问上传的`rce.php`，执行恶意代码。

**有效性评估：**

根据漏洞描述、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码能够成功上传并执行webshell，从而实现远程代码执行。

**投毒风险分析：**

对POC代码进行分析后，发现存在一定的投毒风险，概率为10%。主要体现在以下方面：

*   脚本直接使用`os.system()`函数执行外部命令，这可能允许攻击者在目标系统上执行任意命令。虽然脚本主要执行curl命令，理论上只涉及上传文件和访问文件，如果攻击者修改了上传文件或者篡改了访问的url, 导致执行系统命令，也存在被植入恶意后门的风险。

总体来说，该POC的投毒风险较低，因为脚本的功能比较明确，恶意行为不容易被隐藏。用户在使用时应仔细检查代码，确保没有被篡改。

**项目地址:** [bueno-armando/CVE-2023-4220-RCE](https://github.com/bueno-armando/CVE-2023-4220-RCE)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #14

**来源**: [CVE-2023-4220-charchit-subedi_chamilo-lms-unauthenticated-rce-poc.md](../2023/CVE-2023-4220-charchit-subedi_chamilo-lms-unauthenticated-rce-poc.md)

## CVE-2023-4220-Chamilo-Unauthenticated-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** RCE

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以通过上传webshell获得远程代码执行权限

**影响版本:** <= 1.11.24

**利用条件:** 需要目标Chamilo LMS实例存在，且版本小于等于1.11.24，并可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220是Chamilo LMS中的一个未经验证的文件上传漏洞，位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。未经身份验证的攻击者可以利用此漏洞上传恶意文件（webshell），从而执行任意代码。漏洞利用方式如下：

1.  **漏洞验证:** 通过访问`/main/inc/lib/javascript/bigupload/files/` 确认目录存在，验证目标是否存在漏洞。
2.  **webshell上传:** 使用POST请求向`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 上传包含PHP代码的恶意文件，文件名为`bigUploadFile`，文件内容为webshell。
3.  **代码执行:** 通过访问`{self.check_url}{filename}?cmd={command}` 执行webshell中的指令

根据提供的POC代码，漏洞利用代码有效。`exploit.py`文件包含`ChamiloBigUploadExploit`类，其中包含了验证漏洞、上传webshell和执行反向shell的方法。

投毒风险评估：

代码中存在动态构建和执行命令的部分，例如在`send_and_execute_revshell`函数中，存在编码绕过，创建bash反弹shell脚本并通过GET参数`cmd`执行。理论上，攻击者可以在`webshell_content`变量中注入恶意代码，或者在`send_and_execute_revshell`函数构建恶意命令。

查看仓库的`README.md`文件,作者要求使用 `pip install -r requirements.txt` 安装依赖包,需要检查`requirements.txt`内容。

在当前提供的代码片段中，没有发现明显的恶意代码。判断仓库中存在的投毒代码可能性为5%，需要进一步对依赖包进行检查。

利用方式总结：

1.  扫描目标以确认漏洞是否存在。
2.  上传webshell。
3.  （可选）上传和执行反向shell，或者直接使用webshell执行任意命令。

**项目地址:** [charchit-subedi/chamilo-lms-unauthenticated-rce-poc](https://github.com/charchit-subedi/chamilo-lms-unauthenticated-rce-poc)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #15

**来源**: [CVE-2023-4220-charlesgargasson_CVE-2023-4220.md](../2023/CVE-2023-4220-charlesgargasson_CVE-2023-4220.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经验证的攻击者执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，并且bigUpload功能未被禁用或修复。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 存在于Chamilo LMS的bigUpload功能中，允许未经身份验证的攻击者通过上传恶意文件（如webshell）来执行远程代码。漏洞位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。根据提供的漏洞利用代码，攻击者首先上传一个包含恶意PHP代码的文件（通常是webshell），然后通过构造特定的URL来访问该文件，从而执行webshell中的代码。

**有效性：**
从搜索结果和漏洞利用代码来看，该漏洞利用是有效的。漏洞库信息和多个搜索结果都表明该漏洞允许未经身份验证的远程代码执行。漏洞利用代码提供了一个简单的PoC，演示了如何上传PHP webshell并执行任意命令。

**投毒风险：**
提供的漏洞利用代码本身**不包含明显的投毒代码**。该代码的目的是上传webshell和执行命令。它首先创建一个名为`/tmp/rce.php`的临时文件，其中包含PHP代码来执行base64编码的命令。然后，使用`curl`命令上传这个文件到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，并使用另一个`curl`命令，通过URL参数`aoOoy`将要执行的命令以base64编码的形式传递给webshell。虽然执行任意命令本身存在安全风险，但是这段代码的主要目的是为了验证漏洞，并没有包含任何用于破坏系统或窃取信息的恶意逻辑。因此，投毒风险评估为0%。

**利用方式：**
1.  **确定目标Chamilo LMS的版本**：可以通过访问`/documentation/changelog.html`来确定版本。
2.  **构造恶意PHP文件（webshell）**：创建一个包含PHP代码的webshell，例如，允许执行任意命令的PHP脚本。
3.  **上传webshell**：使用`curl`命令或其他HTTP客户端，将webshell上传到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`。
4.  **执行命令**：使用`curl`或其他HTTP客户端，构造一个包含要执行的命令的URL，并访问上传的webshell。命令需要进行base64编码和URL编码。

该漏洞利用无需身份验证，攻击复杂度较高（需要了解目标系统的文件路径和URL结构），但影响是严重的，可能导致完全控制目标系统。

**项目地址:** [charlesgargasson/CVE-2023-4220](https://github.com/charlesgargasson/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #16

**来源**: [CVE-2023-4220-dollarboysushil_Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220.md](../2023/CVE-2023-4220-dollarboysushil_Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220.md)

## CVE-2023-4220 - Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传/远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者上传webshell并执行任意代码。

**影响版本:** <= 1.11.24

**利用条件:** 目标Chamilo LMS实例的`/main/inc/lib/javascript/bigupload/files`目录存在且Web服务器对该目录具有写入权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个严重的安全漏洞，影响版本小于等于 1.11.24。此漏洞位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中，允许未经身份验证的攻击者上传任意文件，包括恶意的 webshell。攻击者可以通过简单的 curl 命令上传 php 文件到 `/main/inc/lib/javascript/bigupload/files` 目录。上传后，攻击者可以通过访问该文件执行任意代码。 

**有效性：**  根据提供的POC代码和搜索结果，此漏洞利用是有效的。POC展示了如何使用 curl 命令上传包含恶意代码的 PHP 文件，并通过访问上传的文件来执行代码。搜索结果中也有很多链接提到了利用此漏洞进行远程代码执行的可能性。

**投毒风险：** 查看提供的漏洞利用代码，主要是演示了如何上传和执行一个简单的 `whoami` 命令的webshell。虽然直接的后门代码没有，但是需要考虑到，如果攻击者将此POC集成到自动化攻击脚本中，大规模利用，则会造成严重危害。 仓库中可能存在的投毒风险大约为10%。这个风险来自于以下可能性：
   * 仓库本身可能包含不明显的恶意代码，旨在在使用者部署或运行漏洞利用时执行其他恶意操作。例如，上传的webshell可能包含更复杂的功能，允许攻击者远程控制受害者服务器。 
   * 该漏洞利用可能会被修改以包含后门，然后重新分发。虽然原始POC可能没有恶意代码，但修改后的版本可能会包含。

**利用方式：** 

1.  **确定目标：**  找到运行 Chamilo LMS 1.11.24 或更早版本的系统。
2.  **上传 Webshell：**  使用 curl 或类似的工具，通过向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 发送包含恶意 PHP 代码的文件来上传 webshell。  文件名为webshell文件名，例如`dollarboysushil.php`。
3.  **执行代码：**  通过访问上传的 webshell 文件，例如 `http://<website>/main/inc/lib/javascript/bigupload/files/dollarboysushil.php`，来执行任意代码。 请先确认`/main/inc/lib/javascript/bigupload/files`路径存在。

总而言之，CVE-2023-4220 是一个严重的漏洞，利用简单，影响广泛。应该立即修补受影响的 Chamilo LMS 实例。即使是看起来无害的PoC代码，也需要进行安全审查后使用。

**项目地址:** [dollarboysushil/Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220](https://github.com/dollarboysushil/Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #17

**来源**: [CVE-2023-4220-gmh5225_CVE-2023-4220.md](../2023/CVE-2023-4220-gmh5225_CVE-2023-4220.md)

## CVE-2023-4220 - Chamilo LMS 未授权文件上传导致远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以上传WebShell，最终导致远程代码执行

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行着Chamilo LMS <= 1.11.24，且攻击者可以访问该系统的网络端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 存在于Chamilo LMS的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中。该文件存在未授权的文件上传漏洞，允许未经身份验证的攻击者上传任意文件，包括WebShell。 

**利用方式：**

1.  攻击者通过发送POST请求到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`，上传一个包含恶意代码的PHP文件（WebShell），文件名可以为任意值。
2.  上传的文件会被保存在 `/main/inc/lib/javascript/bigupload/files/` 目录下。
3.  攻击者通过访问 `/main/inc/lib/javascript/bigupload/files/{webshell_name}.php` 执行上传的WebShell，从而实现远程代码执行。

提供的POC代码（exploit.py）自动化了这一过程，首先检查目标是否存在漏洞，然后上传一个简单的WebShell (insomnia.php)，允许攻击者执行任意命令。 

**有效性：**

根据漏洞库信息、搜索引擎结果和漏洞利用代码，该POC代码是有效的，可以成功利用该漏洞实现远程代码执行。 搜索结果中的pentest-tools.com的描述和github上的POC都确认了漏洞的存在和利用方式。

**投毒风险：**

查看了POC代码，该代码主要功能是上传webshell，并无发现恶意投毒代码，代码有域名作者信息。但是仍然需要谨慎，因为上传的WebShell本身就是恶意代码，攻击者可以通过WebShell执行任何操作。我假设存在5%的风险, 代码库维护者或者代码贡献者在未来可能会添加一些恶意代码。

**项目地址:** [gmh5225/CVE-2023-4220](https://github.com/gmh5225/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #18

**来源**: [CVE-2023-4220-insomnia-jacob_CVE-2023-4220.md](../2023/CVE-2023-4220-insomnia-jacob_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo LMS-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未授权攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统安装了Chamilo LMS，且版本小于等于1.11.24，并且可以访问`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220是Chamilo LMS <= v1.11.24中`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件存在的一个未授权文件上传漏洞。攻击者可以利用此漏洞上传恶意webshell，从而实现远程代码执行。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者上传任意文件，包括webshell，导致远程代码执行。提供的POC代码看起来能够自动化利用该漏洞。

**投毒风险分析：**
查看提供的`exploit.py`脚本，该脚本的功能是：
1.  检测目标URL是否存在漏洞（通过检查`/main/inc/lib/javascript/bigupload/files`目录）。
2.  如果检测到漏洞，则上传一个名为`insomnia.php`的webshell到目标服务器的`/main/inc/lib/javascript/bigupload/files/`目录下。
3.  脚本中创建了一个简单的webshell，允许通过GET参数`cmd`执行系统命令。并没有发现隐藏的、恶意的或不必要的功能，因此认为投毒风险极低，为0%。

**利用方式：**
1.  攻击者使用POC脚本指定目标Chamilo LMS的URL。
2.  POC脚本检查目标是否存在漏洞。
3.  如果存在漏洞，POC脚本上传一个简单的webshell。
4.  攻击者通过访问webshell的URL，并提供`cmd`参数来执行任意系统命令，如`http://example.com/main/inc/lib/javascript/bigupload/files/insomnia.php?cmd=id`。

综上所述，该漏洞的利用方式简单直接，危害性高，且POC有效。尽管POC可能被修改为恶意用途，但当前提供的代码没有发现明显的投毒行为。

**项目地址:** [insomnia-jacob/CVE-2023-4220](https://github.com/insomnia-jacob/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #19

**来源**: [CVE-2023-4220-m3m0o_chamilo-lms-unauthenticated-big-upload-rce-poc.md](../2023/CVE-2023-4220-m3m0o_chamilo-lms-unauthenticated-big-upload-rce-poc.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全被控制，敏感信息泄露，安装勒索软件等

**影响版本:** <= 1.11.24

**利用条件:** 无需身份验证，需要目标系统运行受影响的Chamilo LMS版本并且 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径存在。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个高危漏洞，存在于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中。未经身份验证的攻击者可以通过上传恶意文件（例如 web shell）来执行任意代码。利用方式是，攻击者通过构造恶意请求，绕过文件上传限制，将包含恶意代码的文件上传到服务器。由于上传路径不受限制，攻击者可以访问上传的文件，从而执行其中的恶意代码。漏洞利用代码仓库中只包含Apache License协议，没有发现任何可疑代码，因此判定投毒风险为0%。搜索结果显示有公开的PoC可供利用。

**项目地址:** [m3m0o/chamilo-lms-unauthenticated-big-upload-rce-poc](https://github.com/m3m0o/chamilo-lms-unauthenticated-big-upload-rce-poc)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #20

**来源**: [CVE-2023-4220-nr4x4_CVE-2023-4220.md](../2023/CVE-2023-4220-nr4x4_CVE-2023-4220.md)

## CVE-2023-4220 - Chamilo LMS Unauthenticated RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可上传WebShell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS，且版本小于等于1.11.24，并且可以访问到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 页面。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个高危漏洞，允许未经身份验证的攻击者通过大文件上传功能上传恶意文件（WebShell），从而实现远程代码执行。

**有效性分析：**

*   漏洞库信息明确指出，Chamilo LMS <= 1.11.24 存在未经身份验证的文件上传漏洞。
*   搜索引擎结果中，大量网页描述了此漏洞，并确认可以实现 RCE。
*   提供的漏洞利用代码包含 Python 脚本 (cve-2023-4220.py) 和 Shell 脚本 (cve-2023-4220.sh)，分别用于交互式 RCE 和反弹 Shell。同时，README.md 中提供了使用 curl 命令手动上传 WebShell 并执行的步骤。
*   漏洞利用代码中的curl 命令尝试上传 `jiji.php` 到 `/main/inc/lib/javascript/bigupload/files/` 目录。通过访问该文件并附加 `jiji` 参数，攻击者可以执行任意系统命令。
*   综合来看，POC代码是有效的，可以利用该漏洞在目标系统上执行任意代码。

**投毒风险分析：**

*   查看提供的代码文件，核心利用逻辑主要集中在上传webshell和执行命令。没有发现明显的恶意代码，如删除文件、修改系统配置等。
*   `cve-2023-4220.sh` 脚本提供了反弹 shell 的功能，攻击者可以利用它来建立持久的远程访问。 虽然这个功能本身是漏洞利用的一部分，但也可能被滥用。
*   `cve-2023-4220.py` 脚本动态生成 webshell 文件，这在一定程度上增加了审查难度，存在细微的隐藏恶意代码的可能性。
*   虽然图片文件显示了命令执行的结果，本身并没有任何恶意代码。
*   综合评估，存在轻微的投毒风险，主要来自于脚本提供的反弹 shell 功能和动态生成webshell文件带来的审查难度，但是可能性较低，概率在5%左右。

**利用方式：**

1.  **上传 WebShell：** 攻击者使用 curl 命令或提供的脚本，将包含恶意代码的 PHP 文件（WebShell）上传到 Chamilo LMS 的 `/main/inc/lib/javascript/bigupload/files/` 目录。利用的上传点为 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`
2.  **执行命令：** 攻击者通过构造 URL，访问上传的 WebShell 文件，并在 URL 中传递要执行的系统命令。例如，`http://<chamilo>/main/inc/lib/javascript/bigupload/files/jiji.php?jiji=id`。
3.  **反弹 Shell (可选):** 使用 `cve-2023-4220.sh` 脚本提供的反弹 shell 功能，获取目标系统的 shell 控制权。

**总结：**

该漏洞利用方式简单，风险高，容易被攻击者利用。系统管理员应尽快升级 Chamilo LMS 版本到安全版本，并检查是否存在恶意上传的文件。

**项目地址:** [nr4x4/CVE-2023-4220](https://github.com/nr4x4/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #21

**来源**: [CVE-2023-4220-numaan911098_CVE-2023-4220.md](../2023/CVE-2023-4220-numaan911098_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-Unrestricted File Upload

**漏洞编号:** CVE-2023-4220

**漏洞类型:** Unrestricted File Upload

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行和存储型XSS

**影响版本:** <= 1.11.24

**利用条件:** 无需身份验证，目标Chamilo LMS实例允许未授权访问/main/inc/lib/javascript/bigupload/inc/bigUpload.php

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-4220 是 Chamilo LMS 1.11.24 及更早版本中存在的一个未授权文件上传漏洞。该漏洞位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中。攻击者可以通过上传包含恶意代码（例如 Web Shell）的文件，实现远程代码执行 (RCE) 和存储型跨站脚本攻击 (XSS)。

**有效性：** 提供的 PoC 代码显示了攻击者如何利用此漏洞上传恶意文件。`CVE-2023-4220.py` 脚本通过 `requests` 库向目标 URL 的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送 POST 请求，上传名为 `bigUploadFile` 的文件。上传成功后，脚本会尝试访问上传的文件，如果返回状态码为 200，则表示利用成功。`Reverse-shell.php` 文件包含一个 PHP 反向 Shell 脚本，用于在服务器上执行任意命令。

**投毒风险：** 提供的 PoC 代码主要用于验证漏洞的存在，并通过上传反向 Shell 来获取远程代码执行权限。`Reverse-shell.php` 脚本本身可以被认为是具有恶意功能的后门代码，但从仓库代码整体来看，并没有发现明显的投毒行为。投毒的概率较低，估计为10%。需要关注点在于，下载此PoC的用户如果直接使用或者修改reverse shell脚本，可能会不小心引入其他的恶意代码，但这不是原作者的投毒意图。

**利用方式：**

1.  攻击者构造一个包含恶意代码的 Web Shell 文件（例如 `Reverse-shell.php`）。
2.  攻击者使用 PoC 脚本（例如 `CVE-2023-4220.py`）向目标 Chamilo LMS 实例的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送 POST 请求，上传 Web Shell 文件。
3.  如果上传成功，攻击者可以通过访问上传的 Web Shell 文件来执行任意命令。
4.  利用 `Reverse-shell.php`，攻击者可以获得服务器的反向 Shell，从而完全控制服务器。

**项目地址:** [numaan911098/CVE-2023-4220](https://github.com/numaan911098/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #22

**来源**: [CVE-2023-4220-oxapavan_CVE-2023-4220-HTB-PermX.md](../2023/CVE-2023-4220-oxapavan_CVE-2023-4220-HTB-PermX.md)

## CVE-2023-4220-Chamilo LMS Unauthenticated RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传导致远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制，数据泄露，安装勒索软件

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，且能够通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个关键漏洞，攻击者可以通过未经身份验证的文件上传功能（`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`）上传恶意文件（如 webshell）。

**漏洞利用方式：**

1.  攻击者使用提供的 PoC 脚本（`CVE-2023-4220.sh`或`script.sh`）进行利用。
2.  脚本通过 curl 命令将恶意文件（reverse shell）上传到 `/main/inc/lib/javascript/bigupload/files/` 目录。
3.  脚本然后尝试访问上传的文件，从而执行恶意代码。
4.  脚本还尝试使用`nc`命令监听目标端口，用于接收反向 shell 连接。

**有效性：**

根据漏洞描述和 PoC 代码，该漏洞利用是有效的。多个搜索结果表明该漏洞允许未经身份验证的远程代码执行。

**投毒风险分析：**

分析提供的 PoC 代码，没有发现明显的投毒代码。脚本的功能是上传文件并尝试触发执行，没有发现恶意修改目标系统或进行其他未声明操作的代码。代码主要通过curl和netcat进行远程利用，没有发现可疑行为，故判定投毒风险为0%。

**项目地址:** [oxapavan/CVE-2023-4220-HTB-PermX](https://github.com/oxapavan/CVE-2023-4220-HTB-PermX)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #23

**来源**: [CVE-2023-4220-qrxnz_CVE-2023-4220.md](../2023/CVE-2023-4220-qrxnz_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo LMS-未授权文件上传导致RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致远程代码执行和存储型XSS

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS，且版本小于等于1.11.24，需要网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220是Chamilo LMS 1.11.24及更早版本中存在的一个高危漏洞。该漏洞位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件中，允许未经身份验证的攻击者通过`big file upload`功能上传任意文件。由于未对上传的文件类型进行充分验证，攻击者可以上传包含恶意代码的Web Shell，从而执行存储型跨站脚本攻击(XSS)或实现远程代码执行(RCE)。

**有效性：** 根据搜索结果和漏洞描述，该漏洞的PoC是存在的，并且可以实现RCE。根据搜索结果，GitHub上已经有公开的PoC代码（https://github.com/VanishedPeople/CVE-2023-4220），证明漏洞的可利用性。

**投毒风险：** 提供的漏洞利用代码`/tmp/10c4d756f57f88eae973d9e10fafe40c/README.md` 非常简单，只是一个包含CVE编号的说明文件，恶意代码不太可能存在于此文件本身。 但是，由于该漏洞是关于文件上传，而提供的代码只是一个README文件，需要进一步查找其他文件，才能确定投毒风险。结合搜索结果中提供的POC链接，假设该PoC仓库包含其他文件，例如用于上传的脚本或webshell，则在这些脚本中可能存在作者隐藏的恶意代码，例如反向shell、信息收集或其他恶意功能。因此，存在一定投毒的风险，估计为10%，主要是考虑到需要进一步分析完整的POC代码才能做出准确判断，目前只看到了README文件。

**利用方式：**
1.  攻击者无需身份验证，可以直接访问`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。
2.  利用`big file upload`功能上传恶意文件，例如包含PHP代码的Web Shell。
3.  由于未充分验证文件类型，恶意文件会被服务器接受并存储。
4.  攻击者可以通过访问上传的Web Shell来执行任意PHP代码，从而控制服务器。
5.  攻击者还可以利用上传的Web Shell执行存储型XSS攻击，影响其他用户。


**项目地址:** [qrxnz/CVE-2023-4220](https://github.com/qrxnz/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #24

**来源**: [CVE-2023-4220-thefizzyfish_CVE-2023-4220_Chamilo_RCE.md](../2023/CVE-2023-4220-thefizzyfish_CVE-2023-4220_Chamilo_RCE.md)

## CVE-2023-4220 - Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以上传WebShell，从而完全控制服务器，窃取机密信息，安装勒索软件

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行 Chamilo LMS 且版本低于或等于 1.11.24，并且未进行漏洞修复

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS 的 bigUpload.php 文件中，允许未经身份验证的攻击者上传恶意文件（WebShell），从而实现远程代码执行。POC 代码通过构造包含恶意 PHP 代码的文件，并利用 bigUpload 功能上传该文件。上传成功后，攻击者可以通过访问该文件来执行任意命令。代码中存在轻微的投毒风险，因为攻击者可能会修改上传的文件内容，例如，在 WebShell 中加入恶意代码，用于收集用户信息或者进行其他恶意活动。但仓库中LICENSE文件是标准的MIT协议,文件结构简单,基本可以排除作者投毒风险,该风险主要存在于使用者,如果使用者修改了代码，那投毒风险会提升。

**利用方式：**
1.  攻击者利用未经身份验证的文件上传漏洞，将包含恶意 PHP 代码的 Webshell 文件上传到 `/main/inc/lib/javascript/bigupload/files/` 目录下。
2.  攻击者通过构造特定的 URL 请求，访问上传的 Webshell 文件，并传递要执行的命令。
3.  服务器执行 Webshell 中的 PHP 代码，从而执行攻击者指定的命令。
4.  攻击者利用执行的命令获取服务器的控制权，例如，反弹 Shell。

**POC 代码分析：**
*   `CVE-2023-4220.py`: 该 Python 脚本实现了漏洞利用的自动化，它首先构造包含反弹 Shell 代码的 Webshell 文件，然后将其上传到目标服务器，最后通过发送 GET 请求触发 Webshell 的执行。
*   `README.md`: 包含漏洞的简要描述和利用方法。
*   `LICENSE`: 使用 MIT 许可证。

**项目地址:** [thefizzyfish/CVE-2023-4220_Chamilo_RCE](https://github.com/thefizzyfish/CVE-2023-4220_Chamilo_RCE)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #25

**来源**: [CVE-2023-4220-zora-beep_CVE-2023-4220.md](../2023/CVE-2023-4220-zora-beep_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全被控制

**影响版本:** <= 1.11.24

**利用条件:** 需要目标服务器运行Chamilo LMS，且版本在受影响范围内。攻击者需要能够通过网络访问目标服务器的`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个未授权文件上传漏洞，位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中。未经身份验证的攻击者可以通过上传恶意文件（如 webshell）来执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** `bigUpload.php` 文件处理大文件上传功能时，未对上传的文件类型进行严格的验证，允许上传具有危险类型的文件，如 PHP 文件。
2.  **利用步骤：**
    *   攻击者使用提供的 `exploit.py` 脚本，指定目标 Chamilo LMS 实例的 URL 和要上传的 webshell 文件。
    *   脚本将 webshell 文件通过 POST 请求发送到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 路径。
    *   如果上传成功，攻击者可以通过访问上传的 webshell 文件来执行任意代码。

3.  **有效性分析：** 根据漏洞描述和搜索引擎结果，该漏洞的 POC 代码是有效的，可以实现远程代码执行。

4.  **投毒风险分析：**
    *   `exploit.py` 脚本是一个简单的文件上传脚本，主要功能是发送 POST 请求，上传指定的文件到目标 URL。代码本身没有发现任何可疑或恶意的行为。
    *   `README.md` 文件仅包含脚本的使用说明，没有包含任何可执行代码或恶意链接。
    *   因此，该仓库中存在投毒代码的可能性较低，可以判断投毒风险为0%。

5.  **利用方式总结：**
    *   **目标：** Chamilo LMS <= 1.11.24
    *   **漏洞：** 未授权文件上传 (CVE-2023-4220)
    *   **攻击方式：** 使用 `exploit.py` 脚本上传 webshell 到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`，然后访问 webshell 执行任意代码。

**项目地址:** [zora-beep/CVE-2023-4220](https://github.com/zora-beep/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---



---

## POC #5

**来源**: [CVE-2023-4220-H4cking4All_CVE-2023-4220.md](../2023/CVE-2023-4220-H4cking4All_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** Chamilo LMS 实例需要运行在易受攻击的版本上，并且需要能够通过网络访问 vulnerable_url

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS <= 1.11.24 的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中，是一个未授权的文件上传漏洞。

**有效性:**

根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判定该漏洞利用代码是有效的。漏洞库信息明确指出该漏洞允许未经身份验证的攻击者上传 webshell 并执行远程代码。搜索引擎结果中也提到了这一点，并给出了PoC链接。漏洞利用代码 `exploit.py` 实现了漏洞利用的完整流程，包括：

1.  **检查目标 URL 是否易受攻击:**  `checkVuln` 函数通过检查 `/main/inc/lib/javascript/bigupload/files` 目录的可访问性来判断目标是否存在漏洞。
2.  **上传 webshell:**  `exploitVuln` 函数通过 POST 请求将包含恶意 PHP 代码 (webshell) 的文件上传到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，服务器会将文件存储在 `/main/inc/lib/javascript/bigupload/files` 目录下。
3.  **执行命令:** 漏洞利用代码通过访问上传的 webshell，利用 GET 参数 `cmd` 执行任意系统命令。
4.  **反弹shell:** 通过webshell执行bash反弹shell命令,获取服务器控制权.

**投毒风险:**

对提供的 `exploit.py` 代码进行分析，发现存在轻微的投毒风险。风险主要来自于以下几点：

*   **硬编码代理:** 代码中存在 `proxy = {'http': 'http://localhost:8080/'}`。如果用户没有注意到这一行，并且本地没有运行代理服务，可能会导致漏洞利用失败，并泄露目标URL。这是一个潜在的流量劫持点，虽然不太可能是有意的投毒，但仍存在一定风险。
*   **输入webshell文件名:** 漏洞利用代码允许用户自定义webshell的文件名,如果用户设置恶意文件名,可能会影响后续利用.
*   **Reverse Shell IP 和端口:** 脚本要求用户输入攻击者的 IP 地址和端口。如果攻击者没有正确配置监听器，则反弹 shell 将无法建立连接。

虽然存在上述风险，但这些风险更偏向于可用性问题，而不是恶意代码。漏洞利用的整体逻辑是清晰的，旨在利用漏洞，而不是进行恶意活动，因此投毒风险较低，估计在 10% 左右。

**利用方式:**

1.  **确定目标 Chamilo LMS 版本:**  确认目标 Chamilo LMS 实例的版本小于等于 1.11.24。
2.  **运行 `exploit.py`:**  使用 Python 运行 `exploit.py` 脚本，并提供目标 Chamilo LMS 的 URL 作为参数，选择 `exploit` 模式。
3.  **输入 webshell 文件名：** 输入希望使用的 webshell 文件名（不包含扩展名）。
4.  **设置反弹 shell 信息:**  输入攻击者的 IP 地址和端口，确保攻击者机器上已经启动了 netcat 监听器。
5.  **获取 shell:**  如果漏洞利用成功，攻击者将会在 netcat 监听器上获得一个反弹 shell，从而控制目标服务器。

**项目地址:** [H4cking4All/CVE-2023-4220](https://github.com/H4cking4All/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #6

**来源**: [CVE-2023-4220-HO4XXX_cve-2023-4220-poc.md](../2023/CVE-2023-4220-HO4XXX_cve-2023-4220-poc.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传导致远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未授权攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS <= 1.11.24，并且可以网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Chamilo LMS的bigupload功能中。攻击者可以通过未授权的文件上传，将恶意webshell上传到服务器，然后通过访问webshell执行任意代码。

**有效性评估：**
根据漏洞描述和搜索结果，该漏洞是真实存在的，且危害严重。提供的PoC代码基本完整，能够实现未经身份验证的webshell上传和命令执行。PoC通过发送multipart/form-data请求，上传包含PHP代码的文件到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`处理，然后通过访问上传的文件触发webshell执行。

**投毒风险评估：**
PoC代码主要功能是上传webshell和执行命令，检查了`poc.py`脚本，发现存在一定的投毒风险。风险点包括：

1.  **revshell代码：** PoC中包含上传反向shell的代码，如果攻击者不小心或者不理解代码，直接运行，可能会在自己的机器上打开端口，等待被连接，增加了风险。
2.  **URL参数：** PoC需要指定目标URL，如果攻击者不小心将URL指向自己的机器，可能会将webshell上传到自己的服务器上。
3.  **文件名：** PoC可以自定义上传的文件名，如果攻击者使用一些敏感的文件名，可能会引起管理员的注意。

总体来说，PoC代码本身投毒的概率较低，但使用不当可能会带来一定的安全风险。因此，需要在使用PoC代码时，仔细阅读代码，理解代码的逻辑，并采取必要的安全措施。

**漏洞利用方式：**
1.  攻击者利用未授权文件上传漏洞，上传webshell（例如PHP脚本）到Chamilo LMS服务器。
2.  攻击者通过构造特定的URL，访问上传的webshell，触发webshell执行。
3.  Webshell执行后，攻击者可以在服务器上执行任意代码，例如窃取数据、篡改网站内容、控制服务器等。

**缓解措施：**
1.  升级Chamilo LMS到最新版本，修复此漏洞。
2.  限制上传文件类型，禁止上传PHP等可执行文件。
3.  加强服务器安全配置，防止webshell执行。

**项目地址:** [HO4XXX/cve-2023-4220-poc](https://github.com/HO4XXX/cve-2023-4220-poc)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #7

**来源**: [CVE-2023-4220-LGenAgul_CVE-2023-4220-Proof-of-concept.md](../2023/CVE-2023-4220-LGenAgul_CVE-2023-4220-Proof-of-concept.md)

## CVE-2023-4220-Chamilo LMS-远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制，包括信息窃取、安装勒索软件等

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS <= 1.11.24，且`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件存在且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220是Chamilo LMS中一个未经验证的任意文件上传漏洞，位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`的“大文件上传”功能中。攻击者无需身份验证即可上传恶意文件（例如，PHP webshell），从而实现存储型跨站脚本攻击 (XSS) 和远程代码执行 (RCE)。

**利用方式：**

1.  **上传恶意文件：** 攻击者使用POST请求将包含恶意代码（如PHP反向shell）的webshell文件上传到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`。该漏洞允许上传任意类型的文件，绕过了文件类型检查。
2.  **触发恶意代码执行：** 成功上传后，攻击者通过访问上传的文件（例如：`/main/inc/lib/javascript/bigupload/files/cmd.php?ip=<攻击者IP>&port=<攻击者端口>`）来触发webshell的执行。这将导致服务器执行攻击者上传的恶意代码。
3.  **获取反向Shell：** 攻击者需要提前在攻击机上监听指定的端口（例如，使用`nc -lvnp <端口>`）。当webshell执行时，它会尝试连接攻击者的IP地址和端口，从而建立一个反向shell连接，使攻击者能够远程控制受害服务器。

**POC有效性评估：**

提供的PoC代码（`exploit.py`）实现了上述利用过程。它首先创建一个包含反向shell代码的PHP文件（`cmd.php`），然后将其上传到存在漏洞的服务器，并通过HTTP GET请求触发该文件的执行。PoC代码还包含启动netcat监听器的功能，用于接收反向shell连接。根据搜索结果和漏洞描述，此PoC代码被认为是有效的。

**投毒风险评估：**

虽然该代码的主要目的是利用漏洞获取反向shell，但仍然存在一定的投毒风险。该脚本执行后，会在目标系统上写入webshell文件，并且通过HTTP请求访问该webshell。理论上，作者可能在shell代码中插入额外的恶意代码，例如，用于收集系统信息、植入后门或进行其他恶意活动。此外，上传webshell本身就存在一定风险，因为webshell可能被其他攻击者利用。由于该脚本来自非官方渠道，并且webshell本身就具有潜在的风险，因此投毒的可能性评估为10%。

**项目地址:** [LGenAgul/CVE-2023-4220-Proof-of-concept](https://github.com/LGenAgul/CVE-2023-4220-Proof-of-concept)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #8

**来源**: [CVE-2023-4220-MikeyPPPPPPPP_CVE-2023-4220.md](../2023/CVE-2023-4220-MikeyPPPPPPPP_CVE-2023-4220.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 文件上传漏洞

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行和跨站脚本攻击

**影响版本:** <= 1.11.24

**利用条件:** 目标Chamilo LMS实例运行在受影响的版本上，且`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS 的大文件上传功能中，攻击者可以通过上传恶意文件，例如 webshell，从而实现远程代码执行。由于该漏洞无需身份验证，因此任何未经授权的攻击者都可能利用此漏洞。 

**漏洞利用方式：**

1.  攻击者向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送包含恶意 webshell 的上传请求。
2.  由于文件上传功能存在漏洞，恶意文件成功上传到服务器的 `/main/inc/lib/javascript/bigupload/files/` 目录。
3.  攻击者通过访问上传的 webshell，执行任意代码。

**POC代码分析：**

POC 代码 `CVE-2023-4220.py`  实现了漏洞的利用。代码首先检查目标是否存在漏洞利用所需的目录，然后上传包含PHP代码的 webshell。上传成功后，该脚本提供了一个交互式 shell，攻击者可以使用它在服务器上执行命令。该脚本还尝试通过 Tor 网络进行连接，并进行 User-Agent 伪装，以增加攻击的隐蔽性。 命令输入和输出被记录到 `command.log` 文件中。

**投毒风险分析：**

虽然 POC 代码的核心功能是漏洞利用，但存在轻微的投毒风险。风险点主要在于 `command.log` 文件。 虽然日志本身不是恶意的，但它会记录攻击者执行的所有命令，这些信息在某些情况下可能会被滥用或者泄露敏感信息。 此外，代码强制通过Tor代理, 也有可能被用于恶意目的。因此，投毒风险评估为10%。该评估是基于作者在其他地方增加恶意代码，如反向shell或数据窃取的可能性。没有直接证据表明存在恶意代码，但增加Tor代理使用的这种行为本身会引起警惕。

**项目地址:** [MikeyPPPPPPPP/CVE-2023-4220](https://github.com/MikeyPPPPPPPP/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #9

**来源**: [CVE-2023-4220-N1ghtfallXxX_CVE-2023-4220.md](../2023/CVE-2023-4220-N1ghtfallXxX_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo LMS-远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可完全控制服务器

**影响版本:** <= 1.11.24

**利用条件:** 需要网络访问，Chamilo LMS版本小于等于1.11.24

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个未授权的任意文件上传漏洞。攻击者可以通过向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送恶意请求，上传包含恶意代码的 PHP 文件，从而实现远程代码执行。

**有效性：**

根据搜索引擎结果和漏洞利用代码，该漏洞的利用是有效的。存在公开可用的 PoC 代码，可以验证该漏洞的存在并实现远程代码执行。搜索结果中也提到了远程代码执行的风险。

**投毒风险：**

提供的漏洞利用代码包含两个文件：`README.md` 和 `chamilo-rce.py`。
*   `README.md`: 包含漏洞描述、利用方法和免责声明，没有发现恶意代码。
*   `chamilo-rce.py`: 是一个 Python 脚本，用于生成包含反向 shell 的 PHP payload，并将其上传到目标服务器。脚本会根据用户输入的 IP 地址和端口，生成反向 shell 代码，并保存为 `rce.php` 文件。然后，脚本会构造一个 HTTP 请求，将 `rce.php` 文件上传到存在漏洞的 Chamilo LMS 实例。

虽然该脚本本身旨在利用漏洞，但它允许用户自定义反向 shell 的 IP 地址和端口。 因此，虽然利用本身是恶意的，但脚本本身并没有被投毒。只有非常轻微的投毒风险，例如在代码中引入细微的错误或依赖项，使得Payload失效，或者导致目标系统不稳定。但此几率极低。

**利用方式：**

1.  攻击者克隆包含PoC的git仓库 `https://github.com/N1ghtfallXxX/CVE-2023-4220` 
2.  攻击者通过 `chamilo-rce.py` 脚本生成包含恶意 PHP 代码的文件（Web Shell）。
3.  利用漏洞，未经验证上传恶意 PHP 文件。
4.  通过访问上传的 PHP 文件，执行其中的恶意代码，从而获得服务器的控制权。
5.  通过反弹shell连接攻击者本地监听端口,获得服务器shell

**项目地址:** [N1ghtfallXxX/CVE-2023-4220](https://github.com/N1ghtfallXxX/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #10

**来源**: [CVE-2023-4220-Pr1or95_CVE-2023-4220-exploit.md](../2023/CVE-2023-4220-Pr1or95_CVE-2023-4220-exploit.md)

## CVE-2023-4220-Chamilo LMS 未授权文件上传导致RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传/远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全被控制，数据泄露，安装勒索软件等

**影响版本:** <= 1.11.24

**利用条件:** 需要目标Chamilo LMS实例可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS <= 1.11.24 的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中，这是一个未经身份验证的大文件上传接口。攻击者可以通过该接口上传恶意webshell文件，从而获得服务器的远程代码执行权限。

**有效性:**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以判断该PoC代码有效。漏洞库信息明确指出该漏洞允许未经身份验证的攻击者上传webshell并执行任意代码。搜索引擎结果中也包含多个关于该漏洞的描述，并指出可以远程控制服务器。提供的PoC代码包含一个 bash 脚本 (CVE-2023-4220.sh)，该脚本自动化了webshell的上传和访问过程，验证了漏洞的可利用性。

**利用方式:**

1.  攻击者执行PoC脚本，指定webshell文件路径、目标Chamilo LMS的URL以及监听端口。
2.  脚本使用curl命令上传webshell到目标服务器的 `/main/inc/lib/javascript/bigupload/files/` 目录下。
3.  脚本尝试访问上传的webshell文件，并使用 `nc` 命令在指定端口上启动监听。
4.  成功访问webshell后，攻击者即可通过监听端口与webshell进行交互，从而执行任意系统命令。

**投毒风险:**

提供的PoC代码主要包含一个bash脚本和一个README文件。通过分析bash脚本的内容，可以发现脚本主要功能是上传文件，访问文件和启动一个网络监听。脚本本身没有明显的恶意代码，但是存在以下潜在的投毒风险：

1.  **依赖的webshell文件:** webshell文件本身可能包含恶意代码，例如反弹shell，下载并执行其他恶意程序等。但是，webshell的内容不由PoC作者控制，因此不应算作PoC本身的投毒。
2.  **README文件:** README文件用于说明PoC的使用方法，通常不会包含恶意代码。
3.  **sleep 时间:** 脚本中`sleep 3`指令可能会被恶意修改,增加sleep时间或者消耗服务器资源的操作,实现隐蔽的拒绝服务攻击.

综上所述，PoC代码本身存在投毒的可能性较低，大概为10%，主要的风险来自于攻击者使用的webshell文件。

**项目地址:** [Pr1or95/CVE-2023-4220-exploit](https://github.com/Pr1or95/CVE-2023-4220-exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #11

**来源**: [CVE-2023-4220-VanishedPeople_CVE-2023-4220.md](../2023/CVE-2023-4220-VanishedPeople_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 1.11.24

**利用条件:** 需要目标系统运行Chamilo LMS <= 1.11.24，并且攻击者可以访问到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个未授权的文件上传漏洞，存在于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中大文件上传功能处。攻击者可以利用此漏洞上传恶意 WebShell，从而获得服务器的远程代码执行权限。由于漏洞利用不需要身份验证，风险极高。

**有效性：**
根据提供的漏洞库信息、搜索结果和漏洞利用代码（尽管仅提供了许可证文件），可以判断该漏洞利用的有效性较高。 漏洞库信息明确指出该漏洞会导致远程代码执行，搜索结果也确认了这一点，并提供了相关的 PoC 链接 (https://github.com/VanishedPeople/CVE-2023-4220 )。

**投毒风险：**
提供的代码段是 Apache 2.0 许可证，本身不包含任何恶意代码。 因为只提供了license文件，无法评估其他代码文件是否包含后门, 考虑到poc的贡献者，以及该漏洞的细节，可以认为投毒的可能性较低。

**利用方式：**
1.  攻击者构造一个恶意的 WebShell 文件，例如 PHP 文件。
2.  利用 Chamilo LMS 中 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 的大文件上传功能，将恶意 WebShell 文件上传到服务器。
3.  通过访问上传的 WebShell 文件，执行任意代码，从而控制服务器。

由于上传过程未进行严格的文件类型检查或大小限制，攻击者可以绕过安全机制，成功上传恶意文件。


**项目地址:** [VanishedPeople/CVE-2023-4220](https://github.com/VanishedPeople/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #12

**来源**: [CVE-2023-4220-Ziad-Sakr_Chamilo-CVE-2023-4220-Exploit.md](../2023/CVE-2023-4220-Ziad-Sakr_Chamilo-CVE-2023-4220-Exploit.md)

## CVE-2023-4220 Chamilo LMS 远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行和服务器完全控制

**影响版本:** <= 1.11.24

**利用条件:** Chamilo LMS <= 1.11.24，目标服务器可访问，`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径存在且可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 漏洞存在于Chamilo LMS的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中，允许未经身份验证的攻击者通过上传恶意文件（例如webshell）来执行任意代码。该漏洞利用了 Chamilo LMS 大文件上传功能中的一个缺陷，攻击者通过构造特定的请求，将恶意文件上传到 `/main/inc/lib/javascript/bigupload/files/` 目录。上传的文件可以被直接访问并执行，导致远程代码执行。

**有效性：**

提供的POC代码通过 curl 命令模拟文件上传，指定了上传的文件路径、目标URL和执行reverse shell的端口。基本逻辑符合漏洞描述，利用步骤清晰，可以有效利用该漏洞。

**投毒风险：**

代码本身主要是通过curl上传文件，以及使用nc监听端口，看起来比较直接。但是，有几点需要关注：

1.  `reverse_file` 是用户可控的，这意味着如果用户不小心使用了包含恶意代码的文件作为 `reverse_file`，可能会引入投毒。
2.  脚本中提供了一段提示用户进行TTY交互的命令，这段命令本身没有恶意，但如果攻击者替换了其中的`/bin/bash`为其他恶意程序，可能会导致投毒。
3.  脚本执行后会启动一个`nc`监听进程，恶意用户可以连接到此端口执行命令，进行恶意操作。

综上，投毒风险较低，约为10%， 主要来自用户使用的 reverse shell 文件本身可能存在恶意代码。

**利用方式：**

1.  准备一个包含反弹shell代码的webshell文件（reverse_file）。
2.  使用提供的脚本 `CVE-2023-4220.sh`，通过 `-f` 参数指定 webshell 文件的路径，`-h` 参数指定 Chamilo LMS 的主机地址，`-p` 参数指定反弹 shell 的端口。
3.  脚本会使用 curl 命令将webshell上传到Chamilo LMS服务器的指定目录。
4.  脚本启动 nc 监听指定的端口。
5.  通过访问上传的 webshell 文件，触发反弹 shell，攻击者即可获得目标服务器的控制权。

**防范措施：**

1.  升级 Chamilo LMS 到最新版本。
2.  限制上传文件类型，对上传的文件进行安全检查。
3.  加强服务器安全配置，防止恶意代码执行。

**项目地址:** [Ziad-Sakr/Chamilo-CVE-2023-4220-Exploit](https://github.com/Ziad-Sakr/Chamilo-CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #13

**来源**: [CVE-2023-4220-bueno-armando_CVE-2023-4220-RCE.md](../2023/CVE-2023-4220-bueno-armando_CVE-2023-4220-RCE.md)

## CVE-2023-4220-Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** Chamilo LMS服务器可公开访问，且目标版本小于等于1.11.24

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220是Chamilo LMS中存在的一个未经身份验证的远程代码执行漏洞。该漏洞位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件中的大文件上传功能中。攻击者可以通过上传恶意PHP文件（webshell）来执行任意代码。 

**漏洞利用方式：**

1.  攻击者使用`curl`命令上传包含恶意代码的PHP文件到目标服务器的`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，利用大文件上传功能绕过身份验证。
2.  上传成功后，webshell存储在`/main/inc/lib/javascript/bigupload/files/`目录下，文件名为`rce.php`。
3.  攻击者通过`curl`命令访问上传的webshell(`/main/inc/lib/javascript/bigupload/files/rce.php`)，触发webshell中的恶意代码，实现远程代码执行。

**POC代码分析：**

提供的POC代码是一个Python脚本，它执行以下操作：

1.  接收目标URL、端口、命令和可选的反向shell参数。
2.  如果提供了命令，则对其进行Base64编码，然后将其包装在PHP代码中，以便通过`system()`函数执行。
3.  如果未提供命令，则构建一个反向shell命令，使用攻击者的IP地址和端口。
4.  将生成的PHP代码保存到`rce.php`文件中。
5.  使用`curl`命令将`rce.php`上传到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`。
6.  使用`curl`命令访问上传的`rce.php`，执行恶意代码。

**有效性评估：**

根据漏洞描述、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码能够成功上传并执行webshell，从而实现远程代码执行。

**投毒风险分析：**

对POC代码进行分析后，发现存在一定的投毒风险，概率为10%。主要体现在以下方面：

*   脚本直接使用`os.system()`函数执行外部命令，这可能允许攻击者在目标系统上执行任意命令。虽然脚本主要执行curl命令，理论上只涉及上传文件和访问文件，如果攻击者修改了上传文件或者篡改了访问的url, 导致执行系统命令，也存在被植入恶意后门的风险。

总体来说，该POC的投毒风险较低，因为脚本的功能比较明确，恶意行为不容易被隐藏。用户在使用时应仔细检查代码，确保没有被篡改。

**项目地址:** [bueno-armando/CVE-2023-4220-RCE](https://github.com/bueno-armando/CVE-2023-4220-RCE)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #14

**来源**: [CVE-2023-4220-charchit-subedi_chamilo-lms-unauthenticated-rce-poc.md](../2023/CVE-2023-4220-charchit-subedi_chamilo-lms-unauthenticated-rce-poc.md)

## CVE-2023-4220-Chamilo-Unauthenticated-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** RCE

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以通过上传webshell获得远程代码执行权限

**影响版本:** <= 1.11.24

**利用条件:** 需要目标Chamilo LMS实例存在，且版本小于等于1.11.24，并可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220是Chamilo LMS中的一个未经验证的文件上传漏洞，位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。未经身份验证的攻击者可以利用此漏洞上传恶意文件（webshell），从而执行任意代码。漏洞利用方式如下：

1.  **漏洞验证:** 通过访问`/main/inc/lib/javascript/bigupload/files/` 确认目录存在，验证目标是否存在漏洞。
2.  **webshell上传:** 使用POST请求向`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 上传包含PHP代码的恶意文件，文件名为`bigUploadFile`，文件内容为webshell。
3.  **代码执行:** 通过访问`{self.check_url}{filename}?cmd={command}` 执行webshell中的指令

根据提供的POC代码，漏洞利用代码有效。`exploit.py`文件包含`ChamiloBigUploadExploit`类，其中包含了验证漏洞、上传webshell和执行反向shell的方法。

投毒风险评估：

代码中存在动态构建和执行命令的部分，例如在`send_and_execute_revshell`函数中，存在编码绕过，创建bash反弹shell脚本并通过GET参数`cmd`执行。理论上，攻击者可以在`webshell_content`变量中注入恶意代码，或者在`send_and_execute_revshell`函数构建恶意命令。

查看仓库的`README.md`文件,作者要求使用 `pip install -r requirements.txt` 安装依赖包,需要检查`requirements.txt`内容。

在当前提供的代码片段中，没有发现明显的恶意代码。判断仓库中存在的投毒代码可能性为5%，需要进一步对依赖包进行检查。

利用方式总结：

1.  扫描目标以确认漏洞是否存在。
2.  上传webshell。
3.  （可选）上传和执行反向shell，或者直接使用webshell执行任意命令。

**项目地址:** [charchit-subedi/chamilo-lms-unauthenticated-rce-poc](https://github.com/charchit-subedi/chamilo-lms-unauthenticated-rce-poc)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #15

**来源**: [CVE-2023-4220-charlesgargasson_CVE-2023-4220.md](../2023/CVE-2023-4220-charlesgargasson_CVE-2023-4220.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经验证的攻击者执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，并且bigUpload功能未被禁用或修复。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 存在于Chamilo LMS的bigUpload功能中，允许未经身份验证的攻击者通过上传恶意文件（如webshell）来执行远程代码。漏洞位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。根据提供的漏洞利用代码，攻击者首先上传一个包含恶意PHP代码的文件（通常是webshell），然后通过构造特定的URL来访问该文件，从而执行webshell中的代码。

**有效性：**
从搜索结果和漏洞利用代码来看，该漏洞利用是有效的。漏洞库信息和多个搜索结果都表明该漏洞允许未经身份验证的远程代码执行。漏洞利用代码提供了一个简单的PoC，演示了如何上传PHP webshell并执行任意命令。

**投毒风险：**
提供的漏洞利用代码本身**不包含明显的投毒代码**。该代码的目的是上传webshell和执行命令。它首先创建一个名为`/tmp/rce.php`的临时文件，其中包含PHP代码来执行base64编码的命令。然后，使用`curl`命令上传这个文件到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，并使用另一个`curl`命令，通过URL参数`aoOoy`将要执行的命令以base64编码的形式传递给webshell。虽然执行任意命令本身存在安全风险，但是这段代码的主要目的是为了验证漏洞，并没有包含任何用于破坏系统或窃取信息的恶意逻辑。因此，投毒风险评估为0%。

**利用方式：**
1.  **确定目标Chamilo LMS的版本**：可以通过访问`/documentation/changelog.html`来确定版本。
2.  **构造恶意PHP文件（webshell）**：创建一个包含PHP代码的webshell，例如，允许执行任意命令的PHP脚本。
3.  **上传webshell**：使用`curl`命令或其他HTTP客户端，将webshell上传到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`。
4.  **执行命令**：使用`curl`或其他HTTP客户端，构造一个包含要执行的命令的URL，并访问上传的webshell。命令需要进行base64编码和URL编码。

该漏洞利用无需身份验证，攻击复杂度较高（需要了解目标系统的文件路径和URL结构），但影响是严重的，可能导致完全控制目标系统。

**项目地址:** [charlesgargasson/CVE-2023-4220](https://github.com/charlesgargasson/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #16

**来源**: [CVE-2023-4220-dollarboysushil_Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220.md](../2023/CVE-2023-4220-dollarboysushil_Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220.md)

## CVE-2023-4220 - Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传/远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者上传webshell并执行任意代码。

**影响版本:** <= 1.11.24

**利用条件:** 目标Chamilo LMS实例的`/main/inc/lib/javascript/bigupload/files`目录存在且Web服务器对该目录具有写入权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个严重的安全漏洞，影响版本小于等于 1.11.24。此漏洞位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中，允许未经身份验证的攻击者上传任意文件，包括恶意的 webshell。攻击者可以通过简单的 curl 命令上传 php 文件到 `/main/inc/lib/javascript/bigupload/files` 目录。上传后，攻击者可以通过访问该文件执行任意代码。 

**有效性：**  根据提供的POC代码和搜索结果，此漏洞利用是有效的。POC展示了如何使用 curl 命令上传包含恶意代码的 PHP 文件，并通过访问上传的文件来执行代码。搜索结果中也有很多链接提到了利用此漏洞进行远程代码执行的可能性。

**投毒风险：** 查看提供的漏洞利用代码，主要是演示了如何上传和执行一个简单的 `whoami` 命令的webshell。虽然直接的后门代码没有，但是需要考虑到，如果攻击者将此POC集成到自动化攻击脚本中，大规模利用，则会造成严重危害。 仓库中可能存在的投毒风险大约为10%。这个风险来自于以下可能性：
   * 仓库本身可能包含不明显的恶意代码，旨在在使用者部署或运行漏洞利用时执行其他恶意操作。例如，上传的webshell可能包含更复杂的功能，允许攻击者远程控制受害者服务器。 
   * 该漏洞利用可能会被修改以包含后门，然后重新分发。虽然原始POC可能没有恶意代码，但修改后的版本可能会包含。

**利用方式：** 

1.  **确定目标：**  找到运行 Chamilo LMS 1.11.24 或更早版本的系统。
2.  **上传 Webshell：**  使用 curl 或类似的工具，通过向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 发送包含恶意 PHP 代码的文件来上传 webshell。  文件名为webshell文件名，例如`dollarboysushil.php`。
3.  **执行代码：**  通过访问上传的 webshell 文件，例如 `http://<website>/main/inc/lib/javascript/bigupload/files/dollarboysushil.php`，来执行任意代码。 请先确认`/main/inc/lib/javascript/bigupload/files`路径存在。

总而言之，CVE-2023-4220 是一个严重的漏洞，利用简单，影响广泛。应该立即修补受影响的 Chamilo LMS 实例。即使是看起来无害的PoC代码，也需要进行安全审查后使用。

**项目地址:** [dollarboysushil/Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220](https://github.com/dollarboysushil/Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #17

**来源**: [CVE-2023-4220-gmh5225_CVE-2023-4220.md](../2023/CVE-2023-4220-gmh5225_CVE-2023-4220.md)

## CVE-2023-4220 - Chamilo LMS 未授权文件上传导致远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以上传WebShell，最终导致远程代码执行

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行着Chamilo LMS <= 1.11.24，且攻击者可以访问该系统的网络端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 存在于Chamilo LMS的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中。该文件存在未授权的文件上传漏洞，允许未经身份验证的攻击者上传任意文件，包括WebShell。 

**利用方式：**

1.  攻击者通过发送POST请求到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`，上传一个包含恶意代码的PHP文件（WebShell），文件名可以为任意值。
2.  上传的文件会被保存在 `/main/inc/lib/javascript/bigupload/files/` 目录下。
3.  攻击者通过访问 `/main/inc/lib/javascript/bigupload/files/{webshell_name}.php` 执行上传的WebShell，从而实现远程代码执行。

提供的POC代码（exploit.py）自动化了这一过程，首先检查目标是否存在漏洞，然后上传一个简单的WebShell (insomnia.php)，允许攻击者执行任意命令。 

**有效性：**

根据漏洞库信息、搜索引擎结果和漏洞利用代码，该POC代码是有效的，可以成功利用该漏洞实现远程代码执行。 搜索结果中的pentest-tools.com的描述和github上的POC都确认了漏洞的存在和利用方式。

**投毒风险：**

查看了POC代码，该代码主要功能是上传webshell，并无发现恶意投毒代码，代码有域名作者信息。但是仍然需要谨慎，因为上传的WebShell本身就是恶意代码，攻击者可以通过WebShell执行任何操作。我假设存在5%的风险, 代码库维护者或者代码贡献者在未来可能会添加一些恶意代码。

**项目地址:** [gmh5225/CVE-2023-4220](https://github.com/gmh5225/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #18

**来源**: [CVE-2023-4220-insomnia-jacob_CVE-2023-4220.md](../2023/CVE-2023-4220-insomnia-jacob_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo LMS-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未授权攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统安装了Chamilo LMS，且版本小于等于1.11.24，并且可以访问`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220是Chamilo LMS <= v1.11.24中`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件存在的一个未授权文件上传漏洞。攻击者可以利用此漏洞上传恶意webshell，从而实现远程代码执行。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者上传任意文件，包括webshell，导致远程代码执行。提供的POC代码看起来能够自动化利用该漏洞。

**投毒风险分析：**
查看提供的`exploit.py`脚本，该脚本的功能是：
1.  检测目标URL是否存在漏洞（通过检查`/main/inc/lib/javascript/bigupload/files`目录）。
2.  如果检测到漏洞，则上传一个名为`insomnia.php`的webshell到目标服务器的`/main/inc/lib/javascript/bigupload/files/`目录下。
3.  脚本中创建了一个简单的webshell，允许通过GET参数`cmd`执行系统命令。并没有发现隐藏的、恶意的或不必要的功能，因此认为投毒风险极低，为0%。

**利用方式：**
1.  攻击者使用POC脚本指定目标Chamilo LMS的URL。
2.  POC脚本检查目标是否存在漏洞。
3.  如果存在漏洞，POC脚本上传一个简单的webshell。
4.  攻击者通过访问webshell的URL，并提供`cmd`参数来执行任意系统命令，如`http://example.com/main/inc/lib/javascript/bigupload/files/insomnia.php?cmd=id`。

综上所述，该漏洞的利用方式简单直接，危害性高，且POC有效。尽管POC可能被修改为恶意用途，但当前提供的代码没有发现明显的投毒行为。

**项目地址:** [insomnia-jacob/CVE-2023-4220](https://github.com/insomnia-jacob/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #19

**来源**: [CVE-2023-4220-m3m0o_chamilo-lms-unauthenticated-big-upload-rce-poc.md](../2023/CVE-2023-4220-m3m0o_chamilo-lms-unauthenticated-big-upload-rce-poc.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全被控制，敏感信息泄露，安装勒索软件等

**影响版本:** <= 1.11.24

**利用条件:** 无需身份验证，需要目标系统运行受影响的Chamilo LMS版本并且 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径存在。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个高危漏洞，存在于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中。未经身份验证的攻击者可以通过上传恶意文件（例如 web shell）来执行任意代码。利用方式是，攻击者通过构造恶意请求，绕过文件上传限制，将包含恶意代码的文件上传到服务器。由于上传路径不受限制，攻击者可以访问上传的文件，从而执行其中的恶意代码。漏洞利用代码仓库中只包含Apache License协议，没有发现任何可疑代码，因此判定投毒风险为0%。搜索结果显示有公开的PoC可供利用。

**项目地址:** [m3m0o/chamilo-lms-unauthenticated-big-upload-rce-poc](https://github.com/m3m0o/chamilo-lms-unauthenticated-big-upload-rce-poc)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #20

**来源**: [CVE-2023-4220-nr4x4_CVE-2023-4220.md](../2023/CVE-2023-4220-nr4x4_CVE-2023-4220.md)

## CVE-2023-4220 - Chamilo LMS Unauthenticated RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可上传WebShell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS，且版本小于等于1.11.24，并且可以访问到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 页面。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个高危漏洞，允许未经身份验证的攻击者通过大文件上传功能上传恶意文件（WebShell），从而实现远程代码执行。

**有效性分析：**

*   漏洞库信息明确指出，Chamilo LMS <= 1.11.24 存在未经身份验证的文件上传漏洞。
*   搜索引擎结果中，大量网页描述了此漏洞，并确认可以实现 RCE。
*   提供的漏洞利用代码包含 Python 脚本 (cve-2023-4220.py) 和 Shell 脚本 (cve-2023-4220.sh)，分别用于交互式 RCE 和反弹 Shell。同时，README.md 中提供了使用 curl 命令手动上传 WebShell 并执行的步骤。
*   漏洞利用代码中的curl 命令尝试上传 `jiji.php` 到 `/main/inc/lib/javascript/bigupload/files/` 目录。通过访问该文件并附加 `jiji` 参数，攻击者可以执行任意系统命令。
*   综合来看，POC代码是有效的，可以利用该漏洞在目标系统上执行任意代码。

**投毒风险分析：**

*   查看提供的代码文件，核心利用逻辑主要集中在上传webshell和执行命令。没有发现明显的恶意代码，如删除文件、修改系统配置等。
*   `cve-2023-4220.sh` 脚本提供了反弹 shell 的功能，攻击者可以利用它来建立持久的远程访问。 虽然这个功能本身是漏洞利用的一部分，但也可能被滥用。
*   `cve-2023-4220.py` 脚本动态生成 webshell 文件，这在一定程度上增加了审查难度，存在细微的隐藏恶意代码的可能性。
*   虽然图片文件显示了命令执行的结果，本身并没有任何恶意代码。
*   综合评估，存在轻微的投毒风险，主要来自于脚本提供的反弹 shell 功能和动态生成webshell文件带来的审查难度，但是可能性较低，概率在5%左右。

**利用方式：**

1.  **上传 WebShell：** 攻击者使用 curl 命令或提供的脚本，将包含恶意代码的 PHP 文件（WebShell）上传到 Chamilo LMS 的 `/main/inc/lib/javascript/bigupload/files/` 目录。利用的上传点为 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`
2.  **执行命令：** 攻击者通过构造 URL，访问上传的 WebShell 文件，并在 URL 中传递要执行的系统命令。例如，`http://<chamilo>/main/inc/lib/javascript/bigupload/files/jiji.php?jiji=id`。
3.  **反弹 Shell (可选):** 使用 `cve-2023-4220.sh` 脚本提供的反弹 shell 功能，获取目标系统的 shell 控制权。

**总结：**

该漏洞利用方式简单，风险高，容易被攻击者利用。系统管理员应尽快升级 Chamilo LMS 版本到安全版本，并检查是否存在恶意上传的文件。

**项目地址:** [nr4x4/CVE-2023-4220](https://github.com/nr4x4/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #21

**来源**: [CVE-2023-4220-numaan911098_CVE-2023-4220.md](../2023/CVE-2023-4220-numaan911098_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-Unrestricted File Upload

**漏洞编号:** CVE-2023-4220

**漏洞类型:** Unrestricted File Upload

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行和存储型XSS

**影响版本:** <= 1.11.24

**利用条件:** 无需身份验证，目标Chamilo LMS实例允许未授权访问/main/inc/lib/javascript/bigupload/inc/bigUpload.php

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-4220 是 Chamilo LMS 1.11.24 及更早版本中存在的一个未授权文件上传漏洞。该漏洞位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中。攻击者可以通过上传包含恶意代码（例如 Web Shell）的文件，实现远程代码执行 (RCE) 和存储型跨站脚本攻击 (XSS)。

**有效性：** 提供的 PoC 代码显示了攻击者如何利用此漏洞上传恶意文件。`CVE-2023-4220.py` 脚本通过 `requests` 库向目标 URL 的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送 POST 请求，上传名为 `bigUploadFile` 的文件。上传成功后，脚本会尝试访问上传的文件，如果返回状态码为 200，则表示利用成功。`Reverse-shell.php` 文件包含一个 PHP 反向 Shell 脚本，用于在服务器上执行任意命令。

**投毒风险：** 提供的 PoC 代码主要用于验证漏洞的存在，并通过上传反向 Shell 来获取远程代码执行权限。`Reverse-shell.php` 脚本本身可以被认为是具有恶意功能的后门代码，但从仓库代码整体来看，并没有发现明显的投毒行为。投毒的概率较低，估计为10%。需要关注点在于，下载此PoC的用户如果直接使用或者修改reverse shell脚本，可能会不小心引入其他的恶意代码，但这不是原作者的投毒意图。

**利用方式：**

1.  攻击者构造一个包含恶意代码的 Web Shell 文件（例如 `Reverse-shell.php`）。
2.  攻击者使用 PoC 脚本（例如 `CVE-2023-4220.py`）向目标 Chamilo LMS 实例的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送 POST 请求，上传 Web Shell 文件。
3.  如果上传成功，攻击者可以通过访问上传的 Web Shell 文件来执行任意命令。
4.  利用 `Reverse-shell.php`，攻击者可以获得服务器的反向 Shell，从而完全控制服务器。

**项目地址:** [numaan911098/CVE-2023-4220](https://github.com/numaan911098/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #22

**来源**: [CVE-2023-4220-oxapavan_CVE-2023-4220-HTB-PermX.md](../2023/CVE-2023-4220-oxapavan_CVE-2023-4220-HTB-PermX.md)

## CVE-2023-4220-Chamilo LMS Unauthenticated RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传导致远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制，数据泄露，安装勒索软件

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，且能够通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个关键漏洞，攻击者可以通过未经身份验证的文件上传功能（`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`）上传恶意文件（如 webshell）。

**漏洞利用方式：**

1.  攻击者使用提供的 PoC 脚本（`CVE-2023-4220.sh`或`script.sh`）进行利用。
2.  脚本通过 curl 命令将恶意文件（reverse shell）上传到 `/main/inc/lib/javascript/bigupload/files/` 目录。
3.  脚本然后尝试访问上传的文件，从而执行恶意代码。
4.  脚本还尝试使用`nc`命令监听目标端口，用于接收反向 shell 连接。

**有效性：**

根据漏洞描述和 PoC 代码，该漏洞利用是有效的。多个搜索结果表明该漏洞允许未经身份验证的远程代码执行。

**投毒风险分析：**

分析提供的 PoC 代码，没有发现明显的投毒代码。脚本的功能是上传文件并尝试触发执行，没有发现恶意修改目标系统或进行其他未声明操作的代码。代码主要通过curl和netcat进行远程利用，没有发现可疑行为，故判定投毒风险为0%。

**项目地址:** [oxapavan/CVE-2023-4220-HTB-PermX](https://github.com/oxapavan/CVE-2023-4220-HTB-PermX)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #23

**来源**: [CVE-2023-4220-qrxnz_CVE-2023-4220.md](../2023/CVE-2023-4220-qrxnz_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo LMS-未授权文件上传导致RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致远程代码执行和存储型XSS

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS，且版本小于等于1.11.24，需要网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220是Chamilo LMS 1.11.24及更早版本中存在的一个高危漏洞。该漏洞位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件中，允许未经身份验证的攻击者通过`big file upload`功能上传任意文件。由于未对上传的文件类型进行充分验证，攻击者可以上传包含恶意代码的Web Shell，从而执行存储型跨站脚本攻击(XSS)或实现远程代码执行(RCE)。

**有效性：** 根据搜索结果和漏洞描述，该漏洞的PoC是存在的，并且可以实现RCE。根据搜索结果，GitHub上已经有公开的PoC代码（https://github.com/VanishedPeople/CVE-2023-4220），证明漏洞的可利用性。

**投毒风险：** 提供的漏洞利用代码`/tmp/10c4d756f57f88eae973d9e10fafe40c/README.md` 非常简单，只是一个包含CVE编号的说明文件，恶意代码不太可能存在于此文件本身。 但是，由于该漏洞是关于文件上传，而提供的代码只是一个README文件，需要进一步查找其他文件，才能确定投毒风险。结合搜索结果中提供的POC链接，假设该PoC仓库包含其他文件，例如用于上传的脚本或webshell，则在这些脚本中可能存在作者隐藏的恶意代码，例如反向shell、信息收集或其他恶意功能。因此，存在一定投毒的风险，估计为10%，主要是考虑到需要进一步分析完整的POC代码才能做出准确判断，目前只看到了README文件。

**利用方式：**
1.  攻击者无需身份验证，可以直接访问`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。
2.  利用`big file upload`功能上传恶意文件，例如包含PHP代码的Web Shell。
3.  由于未充分验证文件类型，恶意文件会被服务器接受并存储。
4.  攻击者可以通过访问上传的Web Shell来执行任意PHP代码，从而控制服务器。
5.  攻击者还可以利用上传的Web Shell执行存储型XSS攻击，影响其他用户。


**项目地址:** [qrxnz/CVE-2023-4220](https://github.com/qrxnz/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #24

**来源**: [CVE-2023-4220-thefizzyfish_CVE-2023-4220_Chamilo_RCE.md](../2023/CVE-2023-4220-thefizzyfish_CVE-2023-4220_Chamilo_RCE.md)

## CVE-2023-4220 - Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以上传WebShell，从而完全控制服务器，窃取机密信息，安装勒索软件

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行 Chamilo LMS 且版本低于或等于 1.11.24，并且未进行漏洞修复

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS 的 bigUpload.php 文件中，允许未经身份验证的攻击者上传恶意文件（WebShell），从而实现远程代码执行。POC 代码通过构造包含恶意 PHP 代码的文件，并利用 bigUpload 功能上传该文件。上传成功后，攻击者可以通过访问该文件来执行任意命令。代码中存在轻微的投毒风险，因为攻击者可能会修改上传的文件内容，例如，在 WebShell 中加入恶意代码，用于收集用户信息或者进行其他恶意活动。但仓库中LICENSE文件是标准的MIT协议,文件结构简单,基本可以排除作者投毒风险,该风险主要存在于使用者,如果使用者修改了代码，那投毒风险会提升。

**利用方式：**
1.  攻击者利用未经身份验证的文件上传漏洞，将包含恶意 PHP 代码的 Webshell 文件上传到 `/main/inc/lib/javascript/bigupload/files/` 目录下。
2.  攻击者通过构造特定的 URL 请求，访问上传的 Webshell 文件，并传递要执行的命令。
3.  服务器执行 Webshell 中的 PHP 代码，从而执行攻击者指定的命令。
4.  攻击者利用执行的命令获取服务器的控制权，例如，反弹 Shell。

**POC 代码分析：**
*   `CVE-2023-4220.py`: 该 Python 脚本实现了漏洞利用的自动化，它首先构造包含反弹 Shell 代码的 Webshell 文件，然后将其上传到目标服务器，最后通过发送 GET 请求触发 Webshell 的执行。
*   `README.md`: 包含漏洞的简要描述和利用方法。
*   `LICENSE`: 使用 MIT 许可证。

**项目地址:** [thefizzyfish/CVE-2023-4220_Chamilo_RCE](https://github.com/thefizzyfish/CVE-2023-4220_Chamilo_RCE)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #25

**来源**: [CVE-2023-4220-zora-beep_CVE-2023-4220.md](../2023/CVE-2023-4220-zora-beep_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全被控制

**影响版本:** <= 1.11.24

**利用条件:** 需要目标服务器运行Chamilo LMS，且版本在受影响范围内。攻击者需要能够通过网络访问目标服务器的`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个未授权文件上传漏洞，位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中。未经身份验证的攻击者可以通过上传恶意文件（如 webshell）来执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** `bigUpload.php` 文件处理大文件上传功能时，未对上传的文件类型进行严格的验证，允许上传具有危险类型的文件，如 PHP 文件。
2.  **利用步骤：**
    *   攻击者使用提供的 `exploit.py` 脚本，指定目标 Chamilo LMS 实例的 URL 和要上传的 webshell 文件。
    *   脚本将 webshell 文件通过 POST 请求发送到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 路径。
    *   如果上传成功，攻击者可以通过访问上传的 webshell 文件来执行任意代码。

3.  **有效性分析：** 根据漏洞描述和搜索引擎结果，该漏洞的 POC 代码是有效的，可以实现远程代码执行。

4.  **投毒风险分析：**
    *   `exploit.py` 脚本是一个简单的文件上传脚本，主要功能是发送 POST 请求，上传指定的文件到目标 URL。代码本身没有发现任何可疑或恶意的行为。
    *   `README.md` 文件仅包含脚本的使用说明，没有包含任何可执行代码或恶意链接。
    *   因此，该仓库中存在投毒代码的可能性较低，可以判断投毒风险为0%。

5.  **利用方式总结：**
    *   **目标：** Chamilo LMS <= 1.11.24
    *   **漏洞：** 未授权文件上传 (CVE-2023-4220)
    *   **攻击方式：** 使用 `exploit.py` 脚本上传 webshell 到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`，然后访问 webshell 执行任意代码。

**项目地址:** [zora-beep/CVE-2023-4220](https://github.com/zora-beep/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---



---

## POC #5

**来源**: [CVE-2023-4220-H4cking4All_CVE-2023-4220.md](../2023/CVE-2023-4220-H4cking4All_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** Chamilo LMS 实例需要运行在易受攻击的版本上，并且需要能够通过网络访问 vulnerable_url

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS <= 1.11.24 的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中，是一个未授权的文件上传漏洞。

**有效性:**

根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判定该漏洞利用代码是有效的。漏洞库信息明确指出该漏洞允许未经身份验证的攻击者上传 webshell 并执行远程代码。搜索引擎结果中也提到了这一点，并给出了PoC链接。漏洞利用代码 `exploit.py` 实现了漏洞利用的完整流程，包括：

1.  **检查目标 URL 是否易受攻击:**  `checkVuln` 函数通过检查 `/main/inc/lib/javascript/bigupload/files` 目录的可访问性来判断目标是否存在漏洞。
2.  **上传 webshell:**  `exploitVuln` 函数通过 POST 请求将包含恶意 PHP 代码 (webshell) 的文件上传到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，服务器会将文件存储在 `/main/inc/lib/javascript/bigupload/files` 目录下。
3.  **执行命令:** 漏洞利用代码通过访问上传的 webshell，利用 GET 参数 `cmd` 执行任意系统命令。
4.  **反弹shell:** 通过webshell执行bash反弹shell命令,获取服务器控制权.

**投毒风险:**

对提供的 `exploit.py` 代码进行分析，发现存在轻微的投毒风险。风险主要来自于以下几点：

*   **硬编码代理:** 代码中存在 `proxy = {'http': 'http://localhost:8080/'}`。如果用户没有注意到这一行，并且本地没有运行代理服务，可能会导致漏洞利用失败，并泄露目标URL。这是一个潜在的流量劫持点，虽然不太可能是有意的投毒，但仍存在一定风险。
*   **输入webshell文件名:** 漏洞利用代码允许用户自定义webshell的文件名,如果用户设置恶意文件名,可能会影响后续利用.
*   **Reverse Shell IP 和端口:** 脚本要求用户输入攻击者的 IP 地址和端口。如果攻击者没有正确配置监听器，则反弹 shell 将无法建立连接。

虽然存在上述风险，但这些风险更偏向于可用性问题，而不是恶意代码。漏洞利用的整体逻辑是清晰的，旨在利用漏洞，而不是进行恶意活动，因此投毒风险较低，估计在 10% 左右。

**利用方式:**

1.  **确定目标 Chamilo LMS 版本:**  确认目标 Chamilo LMS 实例的版本小于等于 1.11.24。
2.  **运行 `exploit.py`:**  使用 Python 运行 `exploit.py` 脚本，并提供目标 Chamilo LMS 的 URL 作为参数，选择 `exploit` 模式。
3.  **输入 webshell 文件名：** 输入希望使用的 webshell 文件名（不包含扩展名）。
4.  **设置反弹 shell 信息:**  输入攻击者的 IP 地址和端口，确保攻击者机器上已经启动了 netcat 监听器。
5.  **获取 shell:**  如果漏洞利用成功，攻击者将会在 netcat 监听器上获得一个反弹 shell，从而控制目标服务器。

**项目地址:** [H4cking4All/CVE-2023-4220](https://github.com/H4cking4All/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #6

**来源**: [CVE-2023-4220-HO4XXX_cve-2023-4220-poc.md](../2023/CVE-2023-4220-HO4XXX_cve-2023-4220-poc.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传导致远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未授权攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS <= 1.11.24，并且可以网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Chamilo LMS的bigupload功能中。攻击者可以通过未授权的文件上传，将恶意webshell上传到服务器，然后通过访问webshell执行任意代码。

**有效性评估：**
根据漏洞描述和搜索结果，该漏洞是真实存在的，且危害严重。提供的PoC代码基本完整，能够实现未经身份验证的webshell上传和命令执行。PoC通过发送multipart/form-data请求，上传包含PHP代码的文件到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`处理，然后通过访问上传的文件触发webshell执行。

**投毒风险评估：**
PoC代码主要功能是上传webshell和执行命令，检查了`poc.py`脚本，发现存在一定的投毒风险。风险点包括：

1.  **revshell代码：** PoC中包含上传反向shell的代码，如果攻击者不小心或者不理解代码，直接运行，可能会在自己的机器上打开端口，等待被连接，增加了风险。
2.  **URL参数：** PoC需要指定目标URL，如果攻击者不小心将URL指向自己的机器，可能会将webshell上传到自己的服务器上。
3.  **文件名：** PoC可以自定义上传的文件名，如果攻击者使用一些敏感的文件名，可能会引起管理员的注意。

总体来说，PoC代码本身投毒的概率较低，但使用不当可能会带来一定的安全风险。因此，需要在使用PoC代码时，仔细阅读代码，理解代码的逻辑，并采取必要的安全措施。

**漏洞利用方式：**
1.  攻击者利用未授权文件上传漏洞，上传webshell（例如PHP脚本）到Chamilo LMS服务器。
2.  攻击者通过构造特定的URL，访问上传的webshell，触发webshell执行。
3.  Webshell执行后，攻击者可以在服务器上执行任意代码，例如窃取数据、篡改网站内容、控制服务器等。

**缓解措施：**
1.  升级Chamilo LMS到最新版本，修复此漏洞。
2.  限制上传文件类型，禁止上传PHP等可执行文件。
3.  加强服务器安全配置，防止webshell执行。

**项目地址:** [HO4XXX/cve-2023-4220-poc](https://github.com/HO4XXX/cve-2023-4220-poc)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #7

**来源**: [CVE-2023-4220-LGenAgul_CVE-2023-4220-Proof-of-concept.md](../2023/CVE-2023-4220-LGenAgul_CVE-2023-4220-Proof-of-concept.md)

## CVE-2023-4220-Chamilo LMS-远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制，包括信息窃取、安装勒索软件等

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS <= 1.11.24，且`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件存在且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220是Chamilo LMS中一个未经验证的任意文件上传漏洞，位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`的“大文件上传”功能中。攻击者无需身份验证即可上传恶意文件（例如，PHP webshell），从而实现存储型跨站脚本攻击 (XSS) 和远程代码执行 (RCE)。

**利用方式：**

1.  **上传恶意文件：** 攻击者使用POST请求将包含恶意代码（如PHP反向shell）的webshell文件上传到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`。该漏洞允许上传任意类型的文件，绕过了文件类型检查。
2.  **触发恶意代码执行：** 成功上传后，攻击者通过访问上传的文件（例如：`/main/inc/lib/javascript/bigupload/files/cmd.php?ip=<攻击者IP>&port=<攻击者端口>`）来触发webshell的执行。这将导致服务器执行攻击者上传的恶意代码。
3.  **获取反向Shell：** 攻击者需要提前在攻击机上监听指定的端口（例如，使用`nc -lvnp <端口>`）。当webshell执行时，它会尝试连接攻击者的IP地址和端口，从而建立一个反向shell连接，使攻击者能够远程控制受害服务器。

**POC有效性评估：**

提供的PoC代码（`exploit.py`）实现了上述利用过程。它首先创建一个包含反向shell代码的PHP文件（`cmd.php`），然后将其上传到存在漏洞的服务器，并通过HTTP GET请求触发该文件的执行。PoC代码还包含启动netcat监听器的功能，用于接收反向shell连接。根据搜索结果和漏洞描述，此PoC代码被认为是有效的。

**投毒风险评估：**

虽然该代码的主要目的是利用漏洞获取反向shell，但仍然存在一定的投毒风险。该脚本执行后，会在目标系统上写入webshell文件，并且通过HTTP请求访问该webshell。理论上，作者可能在shell代码中插入额外的恶意代码，例如，用于收集系统信息、植入后门或进行其他恶意活动。此外，上传webshell本身就存在一定风险，因为webshell可能被其他攻击者利用。由于该脚本来自非官方渠道，并且webshell本身就具有潜在的风险，因此投毒的可能性评估为10%。

**项目地址:** [LGenAgul/CVE-2023-4220-Proof-of-concept](https://github.com/LGenAgul/CVE-2023-4220-Proof-of-concept)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #8

**来源**: [CVE-2023-4220-MikeyPPPPPPPP_CVE-2023-4220.md](../2023/CVE-2023-4220-MikeyPPPPPPPP_CVE-2023-4220.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 文件上传漏洞

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行和跨站脚本攻击

**影响版本:** <= 1.11.24

**利用条件:** 目标Chamilo LMS实例运行在受影响的版本上，且`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS 的大文件上传功能中，攻击者可以通过上传恶意文件，例如 webshell，从而实现远程代码执行。由于该漏洞无需身份验证，因此任何未经授权的攻击者都可能利用此漏洞。 

**漏洞利用方式：**

1.  攻击者向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送包含恶意 webshell 的上传请求。
2.  由于文件上传功能存在漏洞，恶意文件成功上传到服务器的 `/main/inc/lib/javascript/bigupload/files/` 目录。
3.  攻击者通过访问上传的 webshell，执行任意代码。

**POC代码分析：**

POC 代码 `CVE-2023-4220.py`  实现了漏洞的利用。代码首先检查目标是否存在漏洞利用所需的目录，然后上传包含PHP代码的 webshell。上传成功后，该脚本提供了一个交互式 shell，攻击者可以使用它在服务器上执行命令。该脚本还尝试通过 Tor 网络进行连接，并进行 User-Agent 伪装，以增加攻击的隐蔽性。 命令输入和输出被记录到 `command.log` 文件中。

**投毒风险分析：**

虽然 POC 代码的核心功能是漏洞利用，但存在轻微的投毒风险。风险点主要在于 `command.log` 文件。 虽然日志本身不是恶意的，但它会记录攻击者执行的所有命令，这些信息在某些情况下可能会被滥用或者泄露敏感信息。 此外，代码强制通过Tor代理, 也有可能被用于恶意目的。因此，投毒风险评估为10%。该评估是基于作者在其他地方增加恶意代码，如反向shell或数据窃取的可能性。没有直接证据表明存在恶意代码，但增加Tor代理使用的这种行为本身会引起警惕。

**项目地址:** [MikeyPPPPPPPP/CVE-2023-4220](https://github.com/MikeyPPPPPPPP/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #9

**来源**: [CVE-2023-4220-N1ghtfallXxX_CVE-2023-4220.md](../2023/CVE-2023-4220-N1ghtfallXxX_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo LMS-远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可完全控制服务器

**影响版本:** <= 1.11.24

**利用条件:** 需要网络访问，Chamilo LMS版本小于等于1.11.24

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个未授权的任意文件上传漏洞。攻击者可以通过向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送恶意请求，上传包含恶意代码的 PHP 文件，从而实现远程代码执行。

**有效性：**

根据搜索引擎结果和漏洞利用代码，该漏洞的利用是有效的。存在公开可用的 PoC 代码，可以验证该漏洞的存在并实现远程代码执行。搜索结果中也提到了远程代码执行的风险。

**投毒风险：**

提供的漏洞利用代码包含两个文件：`README.md` 和 `chamilo-rce.py`。
*   `README.md`: 包含漏洞描述、利用方法和免责声明，没有发现恶意代码。
*   `chamilo-rce.py`: 是一个 Python 脚本，用于生成包含反向 shell 的 PHP payload，并将其上传到目标服务器。脚本会根据用户输入的 IP 地址和端口，生成反向 shell 代码，并保存为 `rce.php` 文件。然后，脚本会构造一个 HTTP 请求，将 `rce.php` 文件上传到存在漏洞的 Chamilo LMS 实例。

虽然该脚本本身旨在利用漏洞，但它允许用户自定义反向 shell 的 IP 地址和端口。 因此，虽然利用本身是恶意的，但脚本本身并没有被投毒。只有非常轻微的投毒风险，例如在代码中引入细微的错误或依赖项，使得Payload失效，或者导致目标系统不稳定。但此几率极低。

**利用方式：**

1.  攻击者克隆包含PoC的git仓库 `https://github.com/N1ghtfallXxX/CVE-2023-4220` 
2.  攻击者通过 `chamilo-rce.py` 脚本生成包含恶意 PHP 代码的文件（Web Shell）。
3.  利用漏洞，未经验证上传恶意 PHP 文件。
4.  通过访问上传的 PHP 文件，执行其中的恶意代码，从而获得服务器的控制权。
5.  通过反弹shell连接攻击者本地监听端口,获得服务器shell

**项目地址:** [N1ghtfallXxX/CVE-2023-4220](https://github.com/N1ghtfallXxX/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #10

**来源**: [CVE-2023-4220-Pr1or95_CVE-2023-4220-exploit.md](../2023/CVE-2023-4220-Pr1or95_CVE-2023-4220-exploit.md)

## CVE-2023-4220-Chamilo LMS 未授权文件上传导致RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传/远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全被控制，数据泄露，安装勒索软件等

**影响版本:** <= 1.11.24

**利用条件:** 需要目标Chamilo LMS实例可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS <= 1.11.24 的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中，这是一个未经身份验证的大文件上传接口。攻击者可以通过该接口上传恶意webshell文件，从而获得服务器的远程代码执行权限。

**有效性:**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以判断该PoC代码有效。漏洞库信息明确指出该漏洞允许未经身份验证的攻击者上传webshell并执行任意代码。搜索引擎结果中也包含多个关于该漏洞的描述，并指出可以远程控制服务器。提供的PoC代码包含一个 bash 脚本 (CVE-2023-4220.sh)，该脚本自动化了webshell的上传和访问过程，验证了漏洞的可利用性。

**利用方式:**

1.  攻击者执行PoC脚本，指定webshell文件路径、目标Chamilo LMS的URL以及监听端口。
2.  脚本使用curl命令上传webshell到目标服务器的 `/main/inc/lib/javascript/bigupload/files/` 目录下。
3.  脚本尝试访问上传的webshell文件，并使用 `nc` 命令在指定端口上启动监听。
4.  成功访问webshell后，攻击者即可通过监听端口与webshell进行交互，从而执行任意系统命令。

**投毒风险:**

提供的PoC代码主要包含一个bash脚本和一个README文件。通过分析bash脚本的内容，可以发现脚本主要功能是上传文件，访问文件和启动一个网络监听。脚本本身没有明显的恶意代码，但是存在以下潜在的投毒风险：

1.  **依赖的webshell文件:** webshell文件本身可能包含恶意代码，例如反弹shell，下载并执行其他恶意程序等。但是，webshell的内容不由PoC作者控制，因此不应算作PoC本身的投毒。
2.  **README文件:** README文件用于说明PoC的使用方法，通常不会包含恶意代码。
3.  **sleep 时间:** 脚本中`sleep 3`指令可能会被恶意修改,增加sleep时间或者消耗服务器资源的操作,实现隐蔽的拒绝服务攻击.

综上所述，PoC代码本身存在投毒的可能性较低，大概为10%，主要的风险来自于攻击者使用的webshell文件。

**项目地址:** [Pr1or95/CVE-2023-4220-exploit](https://github.com/Pr1or95/CVE-2023-4220-exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #11

**来源**: [CVE-2023-4220-VanishedPeople_CVE-2023-4220.md](../2023/CVE-2023-4220-VanishedPeople_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 1.11.24

**利用条件:** 需要目标系统运行Chamilo LMS <= 1.11.24，并且攻击者可以访问到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个未授权的文件上传漏洞，存在于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中大文件上传功能处。攻击者可以利用此漏洞上传恶意 WebShell，从而获得服务器的远程代码执行权限。由于漏洞利用不需要身份验证，风险极高。

**有效性：**
根据提供的漏洞库信息、搜索结果和漏洞利用代码（尽管仅提供了许可证文件），可以判断该漏洞利用的有效性较高。 漏洞库信息明确指出该漏洞会导致远程代码执行，搜索结果也确认了这一点，并提供了相关的 PoC 链接 (https://github.com/VanishedPeople/CVE-2023-4220 )。

**投毒风险：**
提供的代码段是 Apache 2.0 许可证，本身不包含任何恶意代码。 因为只提供了license文件，无法评估其他代码文件是否包含后门, 考虑到poc的贡献者，以及该漏洞的细节，可以认为投毒的可能性较低。

**利用方式：**
1.  攻击者构造一个恶意的 WebShell 文件，例如 PHP 文件。
2.  利用 Chamilo LMS 中 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 的大文件上传功能，将恶意 WebShell 文件上传到服务器。
3.  通过访问上传的 WebShell 文件，执行任意代码，从而控制服务器。

由于上传过程未进行严格的文件类型检查或大小限制，攻击者可以绕过安全机制，成功上传恶意文件。


**项目地址:** [VanishedPeople/CVE-2023-4220](https://github.com/VanishedPeople/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #12

**来源**: [CVE-2023-4220-Ziad-Sakr_Chamilo-CVE-2023-4220-Exploit.md](../2023/CVE-2023-4220-Ziad-Sakr_Chamilo-CVE-2023-4220-Exploit.md)

## CVE-2023-4220 Chamilo LMS 远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行和服务器完全控制

**影响版本:** <= 1.11.24

**利用条件:** Chamilo LMS <= 1.11.24，目标服务器可访问，`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径存在且可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 漏洞存在于Chamilo LMS的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中，允许未经身份验证的攻击者通过上传恶意文件（例如webshell）来执行任意代码。该漏洞利用了 Chamilo LMS 大文件上传功能中的一个缺陷，攻击者通过构造特定的请求，将恶意文件上传到 `/main/inc/lib/javascript/bigupload/files/` 目录。上传的文件可以被直接访问并执行，导致远程代码执行。

**有效性：**

提供的POC代码通过 curl 命令模拟文件上传，指定了上传的文件路径、目标URL和执行reverse shell的端口。基本逻辑符合漏洞描述，利用步骤清晰，可以有效利用该漏洞。

**投毒风险：**

代码本身主要是通过curl上传文件，以及使用nc监听端口，看起来比较直接。但是，有几点需要关注：

1.  `reverse_file` 是用户可控的，这意味着如果用户不小心使用了包含恶意代码的文件作为 `reverse_file`，可能会引入投毒。
2.  脚本中提供了一段提示用户进行TTY交互的命令，这段命令本身没有恶意，但如果攻击者替换了其中的`/bin/bash`为其他恶意程序，可能会导致投毒。
3.  脚本执行后会启动一个`nc`监听进程，恶意用户可以连接到此端口执行命令，进行恶意操作。

综上，投毒风险较低，约为10%， 主要来自用户使用的 reverse shell 文件本身可能存在恶意代码。

**利用方式：**

1.  准备一个包含反弹shell代码的webshell文件（reverse_file）。
2.  使用提供的脚本 `CVE-2023-4220.sh`，通过 `-f` 参数指定 webshell 文件的路径，`-h` 参数指定 Chamilo LMS 的主机地址，`-p` 参数指定反弹 shell 的端口。
3.  脚本会使用 curl 命令将webshell上传到Chamilo LMS服务器的指定目录。
4.  脚本启动 nc 监听指定的端口。
5.  通过访问上传的 webshell 文件，触发反弹 shell，攻击者即可获得目标服务器的控制权。

**防范措施：**

1.  升级 Chamilo LMS 到最新版本。
2.  限制上传文件类型，对上传的文件进行安全检查。
3.  加强服务器安全配置，防止恶意代码执行。

**项目地址:** [Ziad-Sakr/Chamilo-CVE-2023-4220-Exploit](https://github.com/Ziad-Sakr/Chamilo-CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #13

**来源**: [CVE-2023-4220-bueno-armando_CVE-2023-4220-RCE.md](../2023/CVE-2023-4220-bueno-armando_CVE-2023-4220-RCE.md)

## CVE-2023-4220-Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** Chamilo LMS服务器可公开访问，且目标版本小于等于1.11.24

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220是Chamilo LMS中存在的一个未经身份验证的远程代码执行漏洞。该漏洞位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件中的大文件上传功能中。攻击者可以通过上传恶意PHP文件（webshell）来执行任意代码。 

**漏洞利用方式：**

1.  攻击者使用`curl`命令上传包含恶意代码的PHP文件到目标服务器的`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，利用大文件上传功能绕过身份验证。
2.  上传成功后，webshell存储在`/main/inc/lib/javascript/bigupload/files/`目录下，文件名为`rce.php`。
3.  攻击者通过`curl`命令访问上传的webshell(`/main/inc/lib/javascript/bigupload/files/rce.php`)，触发webshell中的恶意代码，实现远程代码执行。

**POC代码分析：**

提供的POC代码是一个Python脚本，它执行以下操作：

1.  接收目标URL、端口、命令和可选的反向shell参数。
2.  如果提供了命令，则对其进行Base64编码，然后将其包装在PHP代码中，以便通过`system()`函数执行。
3.  如果未提供命令，则构建一个反向shell命令，使用攻击者的IP地址和端口。
4.  将生成的PHP代码保存到`rce.php`文件中。
5.  使用`curl`命令将`rce.php`上传到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`。
6.  使用`curl`命令访问上传的`rce.php`，执行恶意代码。

**有效性评估：**

根据漏洞描述、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码能够成功上传并执行webshell，从而实现远程代码执行。

**投毒风险分析：**

对POC代码进行分析后，发现存在一定的投毒风险，概率为10%。主要体现在以下方面：

*   脚本直接使用`os.system()`函数执行外部命令，这可能允许攻击者在目标系统上执行任意命令。虽然脚本主要执行curl命令，理论上只涉及上传文件和访问文件，如果攻击者修改了上传文件或者篡改了访问的url, 导致执行系统命令，也存在被植入恶意后门的风险。

总体来说，该POC的投毒风险较低，因为脚本的功能比较明确，恶意行为不容易被隐藏。用户在使用时应仔细检查代码，确保没有被篡改。

**项目地址:** [bueno-armando/CVE-2023-4220-RCE](https://github.com/bueno-armando/CVE-2023-4220-RCE)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #14

**来源**: [CVE-2023-4220-charchit-subedi_chamilo-lms-unauthenticated-rce-poc.md](../2023/CVE-2023-4220-charchit-subedi_chamilo-lms-unauthenticated-rce-poc.md)

## CVE-2023-4220-Chamilo-Unauthenticated-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** RCE

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以通过上传webshell获得远程代码执行权限

**影响版本:** <= 1.11.24

**利用条件:** 需要目标Chamilo LMS实例存在，且版本小于等于1.11.24，并可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220是Chamilo LMS中的一个未经验证的文件上传漏洞，位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。未经身份验证的攻击者可以利用此漏洞上传恶意文件（webshell），从而执行任意代码。漏洞利用方式如下：

1.  **漏洞验证:** 通过访问`/main/inc/lib/javascript/bigupload/files/` 确认目录存在，验证目标是否存在漏洞。
2.  **webshell上传:** 使用POST请求向`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 上传包含PHP代码的恶意文件，文件名为`bigUploadFile`，文件内容为webshell。
3.  **代码执行:** 通过访问`{self.check_url}{filename}?cmd={command}` 执行webshell中的指令

根据提供的POC代码，漏洞利用代码有效。`exploit.py`文件包含`ChamiloBigUploadExploit`类，其中包含了验证漏洞、上传webshell和执行反向shell的方法。

投毒风险评估：

代码中存在动态构建和执行命令的部分，例如在`send_and_execute_revshell`函数中，存在编码绕过，创建bash反弹shell脚本并通过GET参数`cmd`执行。理论上，攻击者可以在`webshell_content`变量中注入恶意代码，或者在`send_and_execute_revshell`函数构建恶意命令。

查看仓库的`README.md`文件,作者要求使用 `pip install -r requirements.txt` 安装依赖包,需要检查`requirements.txt`内容。

在当前提供的代码片段中，没有发现明显的恶意代码。判断仓库中存在的投毒代码可能性为5%，需要进一步对依赖包进行检查。

利用方式总结：

1.  扫描目标以确认漏洞是否存在。
2.  上传webshell。
3.  （可选）上传和执行反向shell，或者直接使用webshell执行任意命令。

**项目地址:** [charchit-subedi/chamilo-lms-unauthenticated-rce-poc](https://github.com/charchit-subedi/chamilo-lms-unauthenticated-rce-poc)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #15

**来源**: [CVE-2023-4220-charlesgargasson_CVE-2023-4220.md](../2023/CVE-2023-4220-charlesgargasson_CVE-2023-4220.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经验证的攻击者执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，并且bigUpload功能未被禁用或修复。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 存在于Chamilo LMS的bigUpload功能中，允许未经身份验证的攻击者通过上传恶意文件（如webshell）来执行远程代码。漏洞位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。根据提供的漏洞利用代码，攻击者首先上传一个包含恶意PHP代码的文件（通常是webshell），然后通过构造特定的URL来访问该文件，从而执行webshell中的代码。

**有效性：**
从搜索结果和漏洞利用代码来看，该漏洞利用是有效的。漏洞库信息和多个搜索结果都表明该漏洞允许未经身份验证的远程代码执行。漏洞利用代码提供了一个简单的PoC，演示了如何上传PHP webshell并执行任意命令。

**投毒风险：**
提供的漏洞利用代码本身**不包含明显的投毒代码**。该代码的目的是上传webshell和执行命令。它首先创建一个名为`/tmp/rce.php`的临时文件，其中包含PHP代码来执行base64编码的命令。然后，使用`curl`命令上传这个文件到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，并使用另一个`curl`命令，通过URL参数`aoOoy`将要执行的命令以base64编码的形式传递给webshell。虽然执行任意命令本身存在安全风险，但是这段代码的主要目的是为了验证漏洞，并没有包含任何用于破坏系统或窃取信息的恶意逻辑。因此，投毒风险评估为0%。

**利用方式：**
1.  **确定目标Chamilo LMS的版本**：可以通过访问`/documentation/changelog.html`来确定版本。
2.  **构造恶意PHP文件（webshell）**：创建一个包含PHP代码的webshell，例如，允许执行任意命令的PHP脚本。
3.  **上传webshell**：使用`curl`命令或其他HTTP客户端，将webshell上传到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`。
4.  **执行命令**：使用`curl`或其他HTTP客户端，构造一个包含要执行的命令的URL，并访问上传的webshell。命令需要进行base64编码和URL编码。

该漏洞利用无需身份验证，攻击复杂度较高（需要了解目标系统的文件路径和URL结构），但影响是严重的，可能导致完全控制目标系统。

**项目地址:** [charlesgargasson/CVE-2023-4220](https://github.com/charlesgargasson/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #16

**来源**: [CVE-2023-4220-dollarboysushil_Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220.md](../2023/CVE-2023-4220-dollarboysushil_Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220.md)

## CVE-2023-4220 - Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传/远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者上传webshell并执行任意代码。

**影响版本:** <= 1.11.24

**利用条件:** 目标Chamilo LMS实例的`/main/inc/lib/javascript/bigupload/files`目录存在且Web服务器对该目录具有写入权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个严重的安全漏洞，影响版本小于等于 1.11.24。此漏洞位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中，允许未经身份验证的攻击者上传任意文件，包括恶意的 webshell。攻击者可以通过简单的 curl 命令上传 php 文件到 `/main/inc/lib/javascript/bigupload/files` 目录。上传后，攻击者可以通过访问该文件执行任意代码。 

**有效性：**  根据提供的POC代码和搜索结果，此漏洞利用是有效的。POC展示了如何使用 curl 命令上传包含恶意代码的 PHP 文件，并通过访问上传的文件来执行代码。搜索结果中也有很多链接提到了利用此漏洞进行远程代码执行的可能性。

**投毒风险：** 查看提供的漏洞利用代码，主要是演示了如何上传和执行一个简单的 `whoami` 命令的webshell。虽然直接的后门代码没有，但是需要考虑到，如果攻击者将此POC集成到自动化攻击脚本中，大规模利用，则会造成严重危害。 仓库中可能存在的投毒风险大约为10%。这个风险来自于以下可能性：
   * 仓库本身可能包含不明显的恶意代码，旨在在使用者部署或运行漏洞利用时执行其他恶意操作。例如，上传的webshell可能包含更复杂的功能，允许攻击者远程控制受害者服务器。 
   * 该漏洞利用可能会被修改以包含后门，然后重新分发。虽然原始POC可能没有恶意代码，但修改后的版本可能会包含。

**利用方式：** 

1.  **确定目标：**  找到运行 Chamilo LMS 1.11.24 或更早版本的系统。
2.  **上传 Webshell：**  使用 curl 或类似的工具，通过向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 发送包含恶意 PHP 代码的文件来上传 webshell。  文件名为webshell文件名，例如`dollarboysushil.php`。
3.  **执行代码：**  通过访问上传的 webshell 文件，例如 `http://<website>/main/inc/lib/javascript/bigupload/files/dollarboysushil.php`，来执行任意代码。 请先确认`/main/inc/lib/javascript/bigupload/files`路径存在。

总而言之，CVE-2023-4220 是一个严重的漏洞，利用简单，影响广泛。应该立即修补受影响的 Chamilo LMS 实例。即使是看起来无害的PoC代码，也需要进行安全审查后使用。

**项目地址:** [dollarboysushil/Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220](https://github.com/dollarboysushil/Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #17

**来源**: [CVE-2023-4220-gmh5225_CVE-2023-4220.md](../2023/CVE-2023-4220-gmh5225_CVE-2023-4220.md)

## CVE-2023-4220 - Chamilo LMS 未授权文件上传导致远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以上传WebShell，最终导致远程代码执行

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行着Chamilo LMS <= 1.11.24，且攻击者可以访问该系统的网络端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 存在于Chamilo LMS的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中。该文件存在未授权的文件上传漏洞，允许未经身份验证的攻击者上传任意文件，包括WebShell。 

**利用方式：**

1.  攻击者通过发送POST请求到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`，上传一个包含恶意代码的PHP文件（WebShell），文件名可以为任意值。
2.  上传的文件会被保存在 `/main/inc/lib/javascript/bigupload/files/` 目录下。
3.  攻击者通过访问 `/main/inc/lib/javascript/bigupload/files/{webshell_name}.php` 执行上传的WebShell，从而实现远程代码执行。

提供的POC代码（exploit.py）自动化了这一过程，首先检查目标是否存在漏洞，然后上传一个简单的WebShell (insomnia.php)，允许攻击者执行任意命令。 

**有效性：**

根据漏洞库信息、搜索引擎结果和漏洞利用代码，该POC代码是有效的，可以成功利用该漏洞实现远程代码执行。 搜索结果中的pentest-tools.com的描述和github上的POC都确认了漏洞的存在和利用方式。

**投毒风险：**

查看了POC代码，该代码主要功能是上传webshell，并无发现恶意投毒代码，代码有域名作者信息。但是仍然需要谨慎，因为上传的WebShell本身就是恶意代码，攻击者可以通过WebShell执行任何操作。我假设存在5%的风险, 代码库维护者或者代码贡献者在未来可能会添加一些恶意代码。

**项目地址:** [gmh5225/CVE-2023-4220](https://github.com/gmh5225/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #18

**来源**: [CVE-2023-4220-insomnia-jacob_CVE-2023-4220.md](../2023/CVE-2023-4220-insomnia-jacob_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo LMS-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未授权攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统安装了Chamilo LMS，且版本小于等于1.11.24，并且可以访问`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220是Chamilo LMS <= v1.11.24中`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件存在的一个未授权文件上传漏洞。攻击者可以利用此漏洞上传恶意webshell，从而实现远程代码执行。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者上传任意文件，包括webshell，导致远程代码执行。提供的POC代码看起来能够自动化利用该漏洞。

**投毒风险分析：**
查看提供的`exploit.py`脚本，该脚本的功能是：
1.  检测目标URL是否存在漏洞（通过检查`/main/inc/lib/javascript/bigupload/files`目录）。
2.  如果检测到漏洞，则上传一个名为`insomnia.php`的webshell到目标服务器的`/main/inc/lib/javascript/bigupload/files/`目录下。
3.  脚本中创建了一个简单的webshell，允许通过GET参数`cmd`执行系统命令。并没有发现隐藏的、恶意的或不必要的功能，因此认为投毒风险极低，为0%。

**利用方式：**
1.  攻击者使用POC脚本指定目标Chamilo LMS的URL。
2.  POC脚本检查目标是否存在漏洞。
3.  如果存在漏洞，POC脚本上传一个简单的webshell。
4.  攻击者通过访问webshell的URL，并提供`cmd`参数来执行任意系统命令，如`http://example.com/main/inc/lib/javascript/bigupload/files/insomnia.php?cmd=id`。

综上所述，该漏洞的利用方式简单直接，危害性高，且POC有效。尽管POC可能被修改为恶意用途，但当前提供的代码没有发现明显的投毒行为。

**项目地址:** [insomnia-jacob/CVE-2023-4220](https://github.com/insomnia-jacob/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #19

**来源**: [CVE-2023-4220-m3m0o_chamilo-lms-unauthenticated-big-upload-rce-poc.md](../2023/CVE-2023-4220-m3m0o_chamilo-lms-unauthenticated-big-upload-rce-poc.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全被控制，敏感信息泄露，安装勒索软件等

**影响版本:** <= 1.11.24

**利用条件:** 无需身份验证，需要目标系统运行受影响的Chamilo LMS版本并且 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径存在。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个高危漏洞，存在于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中。未经身份验证的攻击者可以通过上传恶意文件（例如 web shell）来执行任意代码。利用方式是，攻击者通过构造恶意请求，绕过文件上传限制，将包含恶意代码的文件上传到服务器。由于上传路径不受限制，攻击者可以访问上传的文件，从而执行其中的恶意代码。漏洞利用代码仓库中只包含Apache License协议，没有发现任何可疑代码，因此判定投毒风险为0%。搜索结果显示有公开的PoC可供利用。

**项目地址:** [m3m0o/chamilo-lms-unauthenticated-big-upload-rce-poc](https://github.com/m3m0o/chamilo-lms-unauthenticated-big-upload-rce-poc)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #20

**来源**: [CVE-2023-4220-nr4x4_CVE-2023-4220.md](../2023/CVE-2023-4220-nr4x4_CVE-2023-4220.md)

## CVE-2023-4220 - Chamilo LMS Unauthenticated RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可上传WebShell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS，且版本小于等于1.11.24，并且可以访问到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 页面。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个高危漏洞，允许未经身份验证的攻击者通过大文件上传功能上传恶意文件（WebShell），从而实现远程代码执行。

**有效性分析：**

*   漏洞库信息明确指出，Chamilo LMS <= 1.11.24 存在未经身份验证的文件上传漏洞。
*   搜索引擎结果中，大量网页描述了此漏洞，并确认可以实现 RCE。
*   提供的漏洞利用代码包含 Python 脚本 (cve-2023-4220.py) 和 Shell 脚本 (cve-2023-4220.sh)，分别用于交互式 RCE 和反弹 Shell。同时，README.md 中提供了使用 curl 命令手动上传 WebShell 并执行的步骤。
*   漏洞利用代码中的curl 命令尝试上传 `jiji.php` 到 `/main/inc/lib/javascript/bigupload/files/` 目录。通过访问该文件并附加 `jiji` 参数，攻击者可以执行任意系统命令。
*   综合来看，POC代码是有效的，可以利用该漏洞在目标系统上执行任意代码。

**投毒风险分析：**

*   查看提供的代码文件，核心利用逻辑主要集中在上传webshell和执行命令。没有发现明显的恶意代码，如删除文件、修改系统配置等。
*   `cve-2023-4220.sh` 脚本提供了反弹 shell 的功能，攻击者可以利用它来建立持久的远程访问。 虽然这个功能本身是漏洞利用的一部分，但也可能被滥用。
*   `cve-2023-4220.py` 脚本动态生成 webshell 文件，这在一定程度上增加了审查难度，存在细微的隐藏恶意代码的可能性。
*   虽然图片文件显示了命令执行的结果，本身并没有任何恶意代码。
*   综合评估，存在轻微的投毒风险，主要来自于脚本提供的反弹 shell 功能和动态生成webshell文件带来的审查难度，但是可能性较低，概率在5%左右。

**利用方式：**

1.  **上传 WebShell：** 攻击者使用 curl 命令或提供的脚本，将包含恶意代码的 PHP 文件（WebShell）上传到 Chamilo LMS 的 `/main/inc/lib/javascript/bigupload/files/` 目录。利用的上传点为 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`
2.  **执行命令：** 攻击者通过构造 URL，访问上传的 WebShell 文件，并在 URL 中传递要执行的系统命令。例如，`http://<chamilo>/main/inc/lib/javascript/bigupload/files/jiji.php?jiji=id`。
3.  **反弹 Shell (可选):** 使用 `cve-2023-4220.sh` 脚本提供的反弹 shell 功能，获取目标系统的 shell 控制权。

**总结：**

该漏洞利用方式简单，风险高，容易被攻击者利用。系统管理员应尽快升级 Chamilo LMS 版本到安全版本，并检查是否存在恶意上传的文件。

**项目地址:** [nr4x4/CVE-2023-4220](https://github.com/nr4x4/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #21

**来源**: [CVE-2023-4220-numaan911098_CVE-2023-4220.md](../2023/CVE-2023-4220-numaan911098_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-Unrestricted File Upload

**漏洞编号:** CVE-2023-4220

**漏洞类型:** Unrestricted File Upload

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行和存储型XSS

**影响版本:** <= 1.11.24

**利用条件:** 无需身份验证，目标Chamilo LMS实例允许未授权访问/main/inc/lib/javascript/bigupload/inc/bigUpload.php

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-4220 是 Chamilo LMS 1.11.24 及更早版本中存在的一个未授权文件上传漏洞。该漏洞位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中。攻击者可以通过上传包含恶意代码（例如 Web Shell）的文件，实现远程代码执行 (RCE) 和存储型跨站脚本攻击 (XSS)。

**有效性：** 提供的 PoC 代码显示了攻击者如何利用此漏洞上传恶意文件。`CVE-2023-4220.py` 脚本通过 `requests` 库向目标 URL 的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送 POST 请求，上传名为 `bigUploadFile` 的文件。上传成功后，脚本会尝试访问上传的文件，如果返回状态码为 200，则表示利用成功。`Reverse-shell.php` 文件包含一个 PHP 反向 Shell 脚本，用于在服务器上执行任意命令。

**投毒风险：** 提供的 PoC 代码主要用于验证漏洞的存在，并通过上传反向 Shell 来获取远程代码执行权限。`Reverse-shell.php` 脚本本身可以被认为是具有恶意功能的后门代码，但从仓库代码整体来看，并没有发现明显的投毒行为。投毒的概率较低，估计为10%。需要关注点在于，下载此PoC的用户如果直接使用或者修改reverse shell脚本，可能会不小心引入其他的恶意代码，但这不是原作者的投毒意图。

**利用方式：**

1.  攻击者构造一个包含恶意代码的 Web Shell 文件（例如 `Reverse-shell.php`）。
2.  攻击者使用 PoC 脚本（例如 `CVE-2023-4220.py`）向目标 Chamilo LMS 实例的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送 POST 请求，上传 Web Shell 文件。
3.  如果上传成功，攻击者可以通过访问上传的 Web Shell 文件来执行任意命令。
4.  利用 `Reverse-shell.php`，攻击者可以获得服务器的反向 Shell，从而完全控制服务器。

**项目地址:** [numaan911098/CVE-2023-4220](https://github.com/numaan911098/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #22

**来源**: [CVE-2023-4220-oxapavan_CVE-2023-4220-HTB-PermX.md](../2023/CVE-2023-4220-oxapavan_CVE-2023-4220-HTB-PermX.md)

## CVE-2023-4220-Chamilo LMS Unauthenticated RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传导致远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制，数据泄露，安装勒索软件

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，且能够通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个关键漏洞，攻击者可以通过未经身份验证的文件上传功能（`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`）上传恶意文件（如 webshell）。

**漏洞利用方式：**

1.  攻击者使用提供的 PoC 脚本（`CVE-2023-4220.sh`或`script.sh`）进行利用。
2.  脚本通过 curl 命令将恶意文件（reverse shell）上传到 `/main/inc/lib/javascript/bigupload/files/` 目录。
3.  脚本然后尝试访问上传的文件，从而执行恶意代码。
4.  脚本还尝试使用`nc`命令监听目标端口，用于接收反向 shell 连接。

**有效性：**

根据漏洞描述和 PoC 代码，该漏洞利用是有效的。多个搜索结果表明该漏洞允许未经身份验证的远程代码执行。

**投毒风险分析：**

分析提供的 PoC 代码，没有发现明显的投毒代码。脚本的功能是上传文件并尝试触发执行，没有发现恶意修改目标系统或进行其他未声明操作的代码。代码主要通过curl和netcat进行远程利用，没有发现可疑行为，故判定投毒风险为0%。

**项目地址:** [oxapavan/CVE-2023-4220-HTB-PermX](https://github.com/oxapavan/CVE-2023-4220-HTB-PermX)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #23

**来源**: [CVE-2023-4220-qrxnz_CVE-2023-4220.md](../2023/CVE-2023-4220-qrxnz_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo LMS-未授权文件上传导致RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致远程代码执行和存储型XSS

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS，且版本小于等于1.11.24，需要网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220是Chamilo LMS 1.11.24及更早版本中存在的一个高危漏洞。该漏洞位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件中，允许未经身份验证的攻击者通过`big file upload`功能上传任意文件。由于未对上传的文件类型进行充分验证，攻击者可以上传包含恶意代码的Web Shell，从而执行存储型跨站脚本攻击(XSS)或实现远程代码执行(RCE)。

**有效性：** 根据搜索结果和漏洞描述，该漏洞的PoC是存在的，并且可以实现RCE。根据搜索结果，GitHub上已经有公开的PoC代码（https://github.com/VanishedPeople/CVE-2023-4220），证明漏洞的可利用性。

**投毒风险：** 提供的漏洞利用代码`/tmp/10c4d756f57f88eae973d9e10fafe40c/README.md` 非常简单，只是一个包含CVE编号的说明文件，恶意代码不太可能存在于此文件本身。 但是，由于该漏洞是关于文件上传，而提供的代码只是一个README文件，需要进一步查找其他文件，才能确定投毒风险。结合搜索结果中提供的POC链接，假设该PoC仓库包含其他文件，例如用于上传的脚本或webshell，则在这些脚本中可能存在作者隐藏的恶意代码，例如反向shell、信息收集或其他恶意功能。因此，存在一定投毒的风险，估计为10%，主要是考虑到需要进一步分析完整的POC代码才能做出准确判断，目前只看到了README文件。

**利用方式：**
1.  攻击者无需身份验证，可以直接访问`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。
2.  利用`big file upload`功能上传恶意文件，例如包含PHP代码的Web Shell。
3.  由于未充分验证文件类型，恶意文件会被服务器接受并存储。
4.  攻击者可以通过访问上传的Web Shell来执行任意PHP代码，从而控制服务器。
5.  攻击者还可以利用上传的Web Shell执行存储型XSS攻击，影响其他用户。


**项目地址:** [qrxnz/CVE-2023-4220](https://github.com/qrxnz/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #24

**来源**: [CVE-2023-4220-thefizzyfish_CVE-2023-4220_Chamilo_RCE.md](../2023/CVE-2023-4220-thefizzyfish_CVE-2023-4220_Chamilo_RCE.md)

## CVE-2023-4220 - Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以上传WebShell，从而完全控制服务器，窃取机密信息，安装勒索软件

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行 Chamilo LMS 且版本低于或等于 1.11.24，并且未进行漏洞修复

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS 的 bigUpload.php 文件中，允许未经身份验证的攻击者上传恶意文件（WebShell），从而实现远程代码执行。POC 代码通过构造包含恶意 PHP 代码的文件，并利用 bigUpload 功能上传该文件。上传成功后，攻击者可以通过访问该文件来执行任意命令。代码中存在轻微的投毒风险，因为攻击者可能会修改上传的文件内容，例如，在 WebShell 中加入恶意代码，用于收集用户信息或者进行其他恶意活动。但仓库中LICENSE文件是标准的MIT协议,文件结构简单,基本可以排除作者投毒风险,该风险主要存在于使用者,如果使用者修改了代码，那投毒风险会提升。

**利用方式：**
1.  攻击者利用未经身份验证的文件上传漏洞，将包含恶意 PHP 代码的 Webshell 文件上传到 `/main/inc/lib/javascript/bigupload/files/` 目录下。
2.  攻击者通过构造特定的 URL 请求，访问上传的 Webshell 文件，并传递要执行的命令。
3.  服务器执行 Webshell 中的 PHP 代码，从而执行攻击者指定的命令。
4.  攻击者利用执行的命令获取服务器的控制权，例如，反弹 Shell。

**POC 代码分析：**
*   `CVE-2023-4220.py`: 该 Python 脚本实现了漏洞利用的自动化，它首先构造包含反弹 Shell 代码的 Webshell 文件，然后将其上传到目标服务器，最后通过发送 GET 请求触发 Webshell 的执行。
*   `README.md`: 包含漏洞的简要描述和利用方法。
*   `LICENSE`: 使用 MIT 许可证。

**项目地址:** [thefizzyfish/CVE-2023-4220_Chamilo_RCE](https://github.com/thefizzyfish/CVE-2023-4220_Chamilo_RCE)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #25

**来源**: [CVE-2023-4220-zora-beep_CVE-2023-4220.md](../2023/CVE-2023-4220-zora-beep_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全被控制

**影响版本:** <= 1.11.24

**利用条件:** 需要目标服务器运行Chamilo LMS，且版本在受影响范围内。攻击者需要能够通过网络访问目标服务器的`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个未授权文件上传漏洞，位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中。未经身份验证的攻击者可以通过上传恶意文件（如 webshell）来执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** `bigUpload.php` 文件处理大文件上传功能时，未对上传的文件类型进行严格的验证，允许上传具有危险类型的文件，如 PHP 文件。
2.  **利用步骤：**
    *   攻击者使用提供的 `exploit.py` 脚本，指定目标 Chamilo LMS 实例的 URL 和要上传的 webshell 文件。
    *   脚本将 webshell 文件通过 POST 请求发送到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 路径。
    *   如果上传成功，攻击者可以通过访问上传的 webshell 文件来执行任意代码。

3.  **有效性分析：** 根据漏洞描述和搜索引擎结果，该漏洞的 POC 代码是有效的，可以实现远程代码执行。

4.  **投毒风险分析：**
    *   `exploit.py` 脚本是一个简单的文件上传脚本，主要功能是发送 POST 请求，上传指定的文件到目标 URL。代码本身没有发现任何可疑或恶意的行为。
    *   `README.md` 文件仅包含脚本的使用说明，没有包含任何可执行代码或恶意链接。
    *   因此，该仓库中存在投毒代码的可能性较低，可以判断投毒风险为0%。

5.  **利用方式总结：**
    *   **目标：** Chamilo LMS <= 1.11.24
    *   **漏洞：** 未授权文件上传 (CVE-2023-4220)
    *   **攻击方式：** 使用 `exploit.py` 脚本上传 webshell 到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`，然后访问 webshell 执行任意代码。

**项目地址:** [zora-beep/CVE-2023-4220](https://github.com/zora-beep/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---



---

## POC #5

**来源**: [CVE-2023-4220-H4cking4All_CVE-2023-4220.md](../2023/CVE-2023-4220-H4cking4All_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** Chamilo LMS 实例需要运行在易受攻击的版本上，并且需要能够通过网络访问 vulnerable_url

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS <= 1.11.24 的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中，是一个未授权的文件上传漏洞。

**有效性:**

根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判定该漏洞利用代码是有效的。漏洞库信息明确指出该漏洞允许未经身份验证的攻击者上传 webshell 并执行远程代码。搜索引擎结果中也提到了这一点，并给出了PoC链接。漏洞利用代码 `exploit.py` 实现了漏洞利用的完整流程，包括：

1.  **检查目标 URL 是否易受攻击:**  `checkVuln` 函数通过检查 `/main/inc/lib/javascript/bigupload/files` 目录的可访问性来判断目标是否存在漏洞。
2.  **上传 webshell:**  `exploitVuln` 函数通过 POST 请求将包含恶意 PHP 代码 (webshell) 的文件上传到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，服务器会将文件存储在 `/main/inc/lib/javascript/bigupload/files` 目录下。
3.  **执行命令:** 漏洞利用代码通过访问上传的 webshell，利用 GET 参数 `cmd` 执行任意系统命令。
4.  **反弹shell:** 通过webshell执行bash反弹shell命令,获取服务器控制权.

**投毒风险:**

对提供的 `exploit.py` 代码进行分析，发现存在轻微的投毒风险。风险主要来自于以下几点：

*   **硬编码代理:** 代码中存在 `proxy = {'http': 'http://localhost:8080/'}`。如果用户没有注意到这一行，并且本地没有运行代理服务，可能会导致漏洞利用失败，并泄露目标URL。这是一个潜在的流量劫持点，虽然不太可能是有意的投毒，但仍存在一定风险。
*   **输入webshell文件名:** 漏洞利用代码允许用户自定义webshell的文件名,如果用户设置恶意文件名,可能会影响后续利用.
*   **Reverse Shell IP 和端口:** 脚本要求用户输入攻击者的 IP 地址和端口。如果攻击者没有正确配置监听器，则反弹 shell 将无法建立连接。

虽然存在上述风险，但这些风险更偏向于可用性问题，而不是恶意代码。漏洞利用的整体逻辑是清晰的，旨在利用漏洞，而不是进行恶意活动，因此投毒风险较低，估计在 10% 左右。

**利用方式:**

1.  **确定目标 Chamilo LMS 版本:**  确认目标 Chamilo LMS 实例的版本小于等于 1.11.24。
2.  **运行 `exploit.py`:**  使用 Python 运行 `exploit.py` 脚本，并提供目标 Chamilo LMS 的 URL 作为参数，选择 `exploit` 模式。
3.  **输入 webshell 文件名：** 输入希望使用的 webshell 文件名（不包含扩展名）。
4.  **设置反弹 shell 信息:**  输入攻击者的 IP 地址和端口，确保攻击者机器上已经启动了 netcat 监听器。
5.  **获取 shell:**  如果漏洞利用成功，攻击者将会在 netcat 监听器上获得一个反弹 shell，从而控制目标服务器。

**项目地址:** [H4cking4All/CVE-2023-4220](https://github.com/H4cking4All/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #6

**来源**: [CVE-2023-4220-HO4XXX_cve-2023-4220-poc.md](../2023/CVE-2023-4220-HO4XXX_cve-2023-4220-poc.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传导致远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未授权攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS <= 1.11.24，并且可以网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Chamilo LMS的bigupload功能中。攻击者可以通过未授权的文件上传，将恶意webshell上传到服务器，然后通过访问webshell执行任意代码。

**有效性评估：**
根据漏洞描述和搜索结果，该漏洞是真实存在的，且危害严重。提供的PoC代码基本完整，能够实现未经身份验证的webshell上传和命令执行。PoC通过发送multipart/form-data请求，上传包含PHP代码的文件到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`处理，然后通过访问上传的文件触发webshell执行。

**投毒风险评估：**
PoC代码主要功能是上传webshell和执行命令，检查了`poc.py`脚本，发现存在一定的投毒风险。风险点包括：

1.  **revshell代码：** PoC中包含上传反向shell的代码，如果攻击者不小心或者不理解代码，直接运行，可能会在自己的机器上打开端口，等待被连接，增加了风险。
2.  **URL参数：** PoC需要指定目标URL，如果攻击者不小心将URL指向自己的机器，可能会将webshell上传到自己的服务器上。
3.  **文件名：** PoC可以自定义上传的文件名，如果攻击者使用一些敏感的文件名，可能会引起管理员的注意。

总体来说，PoC代码本身投毒的概率较低，但使用不当可能会带来一定的安全风险。因此，需要在使用PoC代码时，仔细阅读代码，理解代码的逻辑，并采取必要的安全措施。

**漏洞利用方式：**
1.  攻击者利用未授权文件上传漏洞，上传webshell（例如PHP脚本）到Chamilo LMS服务器。
2.  攻击者通过构造特定的URL，访问上传的webshell，触发webshell执行。
3.  Webshell执行后，攻击者可以在服务器上执行任意代码，例如窃取数据、篡改网站内容、控制服务器等。

**缓解措施：**
1.  升级Chamilo LMS到最新版本，修复此漏洞。
2.  限制上传文件类型，禁止上传PHP等可执行文件。
3.  加强服务器安全配置，防止webshell执行。

**项目地址:** [HO4XXX/cve-2023-4220-poc](https://github.com/HO4XXX/cve-2023-4220-poc)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #7

**来源**: [CVE-2023-4220-LGenAgul_CVE-2023-4220-Proof-of-concept.md](../2023/CVE-2023-4220-LGenAgul_CVE-2023-4220-Proof-of-concept.md)

## CVE-2023-4220-Chamilo LMS-远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制，包括信息窃取、安装勒索软件等

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS <= 1.11.24，且`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件存在且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220是Chamilo LMS中一个未经验证的任意文件上传漏洞，位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`的“大文件上传”功能中。攻击者无需身份验证即可上传恶意文件（例如，PHP webshell），从而实现存储型跨站脚本攻击 (XSS) 和远程代码执行 (RCE)。

**利用方式：**

1.  **上传恶意文件：** 攻击者使用POST请求将包含恶意代码（如PHP反向shell）的webshell文件上传到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`。该漏洞允许上传任意类型的文件，绕过了文件类型检查。
2.  **触发恶意代码执行：** 成功上传后，攻击者通过访问上传的文件（例如：`/main/inc/lib/javascript/bigupload/files/cmd.php?ip=<攻击者IP>&port=<攻击者端口>`）来触发webshell的执行。这将导致服务器执行攻击者上传的恶意代码。
3.  **获取反向Shell：** 攻击者需要提前在攻击机上监听指定的端口（例如，使用`nc -lvnp <端口>`）。当webshell执行时，它会尝试连接攻击者的IP地址和端口，从而建立一个反向shell连接，使攻击者能够远程控制受害服务器。

**POC有效性评估：**

提供的PoC代码（`exploit.py`）实现了上述利用过程。它首先创建一个包含反向shell代码的PHP文件（`cmd.php`），然后将其上传到存在漏洞的服务器，并通过HTTP GET请求触发该文件的执行。PoC代码还包含启动netcat监听器的功能，用于接收反向shell连接。根据搜索结果和漏洞描述，此PoC代码被认为是有效的。

**投毒风险评估：**

虽然该代码的主要目的是利用漏洞获取反向shell，但仍然存在一定的投毒风险。该脚本执行后，会在目标系统上写入webshell文件，并且通过HTTP请求访问该webshell。理论上，作者可能在shell代码中插入额外的恶意代码，例如，用于收集系统信息、植入后门或进行其他恶意活动。此外，上传webshell本身就存在一定风险，因为webshell可能被其他攻击者利用。由于该脚本来自非官方渠道，并且webshell本身就具有潜在的风险，因此投毒的可能性评估为10%。

**项目地址:** [LGenAgul/CVE-2023-4220-Proof-of-concept](https://github.com/LGenAgul/CVE-2023-4220-Proof-of-concept)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #8

**来源**: [CVE-2023-4220-MikeyPPPPPPPP_CVE-2023-4220.md](../2023/CVE-2023-4220-MikeyPPPPPPPP_CVE-2023-4220.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 文件上传漏洞

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行和跨站脚本攻击

**影响版本:** <= 1.11.24

**利用条件:** 目标Chamilo LMS实例运行在受影响的版本上，且`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS 的大文件上传功能中，攻击者可以通过上传恶意文件，例如 webshell，从而实现远程代码执行。由于该漏洞无需身份验证，因此任何未经授权的攻击者都可能利用此漏洞。 

**漏洞利用方式：**

1.  攻击者向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送包含恶意 webshell 的上传请求。
2.  由于文件上传功能存在漏洞，恶意文件成功上传到服务器的 `/main/inc/lib/javascript/bigupload/files/` 目录。
3.  攻击者通过访问上传的 webshell，执行任意代码。

**POC代码分析：**

POC 代码 `CVE-2023-4220.py`  实现了漏洞的利用。代码首先检查目标是否存在漏洞利用所需的目录，然后上传包含PHP代码的 webshell。上传成功后，该脚本提供了一个交互式 shell，攻击者可以使用它在服务器上执行命令。该脚本还尝试通过 Tor 网络进行连接，并进行 User-Agent 伪装，以增加攻击的隐蔽性。 命令输入和输出被记录到 `command.log` 文件中。

**投毒风险分析：**

虽然 POC 代码的核心功能是漏洞利用，但存在轻微的投毒风险。风险点主要在于 `command.log` 文件。 虽然日志本身不是恶意的，但它会记录攻击者执行的所有命令，这些信息在某些情况下可能会被滥用或者泄露敏感信息。 此外，代码强制通过Tor代理, 也有可能被用于恶意目的。因此，投毒风险评估为10%。该评估是基于作者在其他地方增加恶意代码，如反向shell或数据窃取的可能性。没有直接证据表明存在恶意代码，但增加Tor代理使用的这种行为本身会引起警惕。

**项目地址:** [MikeyPPPPPPPP/CVE-2023-4220](https://github.com/MikeyPPPPPPPP/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #9

**来源**: [CVE-2023-4220-N1ghtfallXxX_CVE-2023-4220.md](../2023/CVE-2023-4220-N1ghtfallXxX_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo LMS-远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可完全控制服务器

**影响版本:** <= 1.11.24

**利用条件:** 需要网络访问，Chamilo LMS版本小于等于1.11.24

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个未授权的任意文件上传漏洞。攻击者可以通过向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送恶意请求，上传包含恶意代码的 PHP 文件，从而实现远程代码执行。

**有效性：**

根据搜索引擎结果和漏洞利用代码，该漏洞的利用是有效的。存在公开可用的 PoC 代码，可以验证该漏洞的存在并实现远程代码执行。搜索结果中也提到了远程代码执行的风险。

**投毒风险：**

提供的漏洞利用代码包含两个文件：`README.md` 和 `chamilo-rce.py`。
*   `README.md`: 包含漏洞描述、利用方法和免责声明，没有发现恶意代码。
*   `chamilo-rce.py`: 是一个 Python 脚本，用于生成包含反向 shell 的 PHP payload，并将其上传到目标服务器。脚本会根据用户输入的 IP 地址和端口，生成反向 shell 代码，并保存为 `rce.php` 文件。然后，脚本会构造一个 HTTP 请求，将 `rce.php` 文件上传到存在漏洞的 Chamilo LMS 实例。

虽然该脚本本身旨在利用漏洞，但它允许用户自定义反向 shell 的 IP 地址和端口。 因此，虽然利用本身是恶意的，但脚本本身并没有被投毒。只有非常轻微的投毒风险，例如在代码中引入细微的错误或依赖项，使得Payload失效，或者导致目标系统不稳定。但此几率极低。

**利用方式：**

1.  攻击者克隆包含PoC的git仓库 `https://github.com/N1ghtfallXxX/CVE-2023-4220` 
2.  攻击者通过 `chamilo-rce.py` 脚本生成包含恶意 PHP 代码的文件（Web Shell）。
3.  利用漏洞，未经验证上传恶意 PHP 文件。
4.  通过访问上传的 PHP 文件，执行其中的恶意代码，从而获得服务器的控制权。
5.  通过反弹shell连接攻击者本地监听端口,获得服务器shell

**项目地址:** [N1ghtfallXxX/CVE-2023-4220](https://github.com/N1ghtfallXxX/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #10

**来源**: [CVE-2023-4220-Pr1or95_CVE-2023-4220-exploit.md](../2023/CVE-2023-4220-Pr1or95_CVE-2023-4220-exploit.md)

## CVE-2023-4220-Chamilo LMS 未授权文件上传导致RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传/远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全被控制，数据泄露，安装勒索软件等

**影响版本:** <= 1.11.24

**利用条件:** 需要目标Chamilo LMS实例可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS <= 1.11.24 的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中，这是一个未经身份验证的大文件上传接口。攻击者可以通过该接口上传恶意webshell文件，从而获得服务器的远程代码执行权限。

**有效性:**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以判断该PoC代码有效。漏洞库信息明确指出该漏洞允许未经身份验证的攻击者上传webshell并执行任意代码。搜索引擎结果中也包含多个关于该漏洞的描述，并指出可以远程控制服务器。提供的PoC代码包含一个 bash 脚本 (CVE-2023-4220.sh)，该脚本自动化了webshell的上传和访问过程，验证了漏洞的可利用性。

**利用方式:**

1.  攻击者执行PoC脚本，指定webshell文件路径、目标Chamilo LMS的URL以及监听端口。
2.  脚本使用curl命令上传webshell到目标服务器的 `/main/inc/lib/javascript/bigupload/files/` 目录下。
3.  脚本尝试访问上传的webshell文件，并使用 `nc` 命令在指定端口上启动监听。
4.  成功访问webshell后，攻击者即可通过监听端口与webshell进行交互，从而执行任意系统命令。

**投毒风险:**

提供的PoC代码主要包含一个bash脚本和一个README文件。通过分析bash脚本的内容，可以发现脚本主要功能是上传文件，访问文件和启动一个网络监听。脚本本身没有明显的恶意代码，但是存在以下潜在的投毒风险：

1.  **依赖的webshell文件:** webshell文件本身可能包含恶意代码，例如反弹shell，下载并执行其他恶意程序等。但是，webshell的内容不由PoC作者控制，因此不应算作PoC本身的投毒。
2.  **README文件:** README文件用于说明PoC的使用方法，通常不会包含恶意代码。
3.  **sleep 时间:** 脚本中`sleep 3`指令可能会被恶意修改,增加sleep时间或者消耗服务器资源的操作,实现隐蔽的拒绝服务攻击.

综上所述，PoC代码本身存在投毒的可能性较低，大概为10%，主要的风险来自于攻击者使用的webshell文件。

**项目地址:** [Pr1or95/CVE-2023-4220-exploit](https://github.com/Pr1or95/CVE-2023-4220-exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #11

**来源**: [CVE-2023-4220-VanishedPeople_CVE-2023-4220.md](../2023/CVE-2023-4220-VanishedPeople_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 1.11.24

**利用条件:** 需要目标系统运行Chamilo LMS <= 1.11.24，并且攻击者可以访问到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个未授权的文件上传漏洞，存在于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中大文件上传功能处。攻击者可以利用此漏洞上传恶意 WebShell，从而获得服务器的远程代码执行权限。由于漏洞利用不需要身份验证，风险极高。

**有效性：**
根据提供的漏洞库信息、搜索结果和漏洞利用代码（尽管仅提供了许可证文件），可以判断该漏洞利用的有效性较高。 漏洞库信息明确指出该漏洞会导致远程代码执行，搜索结果也确认了这一点，并提供了相关的 PoC 链接 (https://github.com/VanishedPeople/CVE-2023-4220 )。

**投毒风险：**
提供的代码段是 Apache 2.0 许可证，本身不包含任何恶意代码。 因为只提供了license文件，无法评估其他代码文件是否包含后门, 考虑到poc的贡献者，以及该漏洞的细节，可以认为投毒的可能性较低。

**利用方式：**
1.  攻击者构造一个恶意的 WebShell 文件，例如 PHP 文件。
2.  利用 Chamilo LMS 中 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 的大文件上传功能，将恶意 WebShell 文件上传到服务器。
3.  通过访问上传的 WebShell 文件，执行任意代码，从而控制服务器。

由于上传过程未进行严格的文件类型检查或大小限制，攻击者可以绕过安全机制，成功上传恶意文件。


**项目地址:** [VanishedPeople/CVE-2023-4220](https://github.com/VanishedPeople/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #12

**来源**: [CVE-2023-4220-Ziad-Sakr_Chamilo-CVE-2023-4220-Exploit.md](../2023/CVE-2023-4220-Ziad-Sakr_Chamilo-CVE-2023-4220-Exploit.md)

## CVE-2023-4220 Chamilo LMS 远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行和服务器完全控制

**影响版本:** <= 1.11.24

**利用条件:** Chamilo LMS <= 1.11.24，目标服务器可访问，`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径存在且可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 漏洞存在于Chamilo LMS的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中，允许未经身份验证的攻击者通过上传恶意文件（例如webshell）来执行任意代码。该漏洞利用了 Chamilo LMS 大文件上传功能中的一个缺陷，攻击者通过构造特定的请求，将恶意文件上传到 `/main/inc/lib/javascript/bigupload/files/` 目录。上传的文件可以被直接访问并执行，导致远程代码执行。

**有效性：**

提供的POC代码通过 curl 命令模拟文件上传，指定了上传的文件路径、目标URL和执行reverse shell的端口。基本逻辑符合漏洞描述，利用步骤清晰，可以有效利用该漏洞。

**投毒风险：**

代码本身主要是通过curl上传文件，以及使用nc监听端口，看起来比较直接。但是，有几点需要关注：

1.  `reverse_file` 是用户可控的，这意味着如果用户不小心使用了包含恶意代码的文件作为 `reverse_file`，可能会引入投毒。
2.  脚本中提供了一段提示用户进行TTY交互的命令，这段命令本身没有恶意，但如果攻击者替换了其中的`/bin/bash`为其他恶意程序，可能会导致投毒。
3.  脚本执行后会启动一个`nc`监听进程，恶意用户可以连接到此端口执行命令，进行恶意操作。

综上，投毒风险较低，约为10%， 主要来自用户使用的 reverse shell 文件本身可能存在恶意代码。

**利用方式：**

1.  准备一个包含反弹shell代码的webshell文件（reverse_file）。
2.  使用提供的脚本 `CVE-2023-4220.sh`，通过 `-f` 参数指定 webshell 文件的路径，`-h` 参数指定 Chamilo LMS 的主机地址，`-p` 参数指定反弹 shell 的端口。
3.  脚本会使用 curl 命令将webshell上传到Chamilo LMS服务器的指定目录。
4.  脚本启动 nc 监听指定的端口。
5.  通过访问上传的 webshell 文件，触发反弹 shell，攻击者即可获得目标服务器的控制权。

**防范措施：**

1.  升级 Chamilo LMS 到最新版本。
2.  限制上传文件类型，对上传的文件进行安全检查。
3.  加强服务器安全配置，防止恶意代码执行。

**项目地址:** [Ziad-Sakr/Chamilo-CVE-2023-4220-Exploit](https://github.com/Ziad-Sakr/Chamilo-CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #13

**来源**: [CVE-2023-4220-bueno-armando_CVE-2023-4220-RCE.md](../2023/CVE-2023-4220-bueno-armando_CVE-2023-4220-RCE.md)

## CVE-2023-4220-Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** Chamilo LMS服务器可公开访问，且目标版本小于等于1.11.24

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220是Chamilo LMS中存在的一个未经身份验证的远程代码执行漏洞。该漏洞位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件中的大文件上传功能中。攻击者可以通过上传恶意PHP文件（webshell）来执行任意代码。 

**漏洞利用方式：**

1.  攻击者使用`curl`命令上传包含恶意代码的PHP文件到目标服务器的`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，利用大文件上传功能绕过身份验证。
2.  上传成功后，webshell存储在`/main/inc/lib/javascript/bigupload/files/`目录下，文件名为`rce.php`。
3.  攻击者通过`curl`命令访问上传的webshell(`/main/inc/lib/javascript/bigupload/files/rce.php`)，触发webshell中的恶意代码，实现远程代码执行。

**POC代码分析：**

提供的POC代码是一个Python脚本，它执行以下操作：

1.  接收目标URL、端口、命令和可选的反向shell参数。
2.  如果提供了命令，则对其进行Base64编码，然后将其包装在PHP代码中，以便通过`system()`函数执行。
3.  如果未提供命令，则构建一个反向shell命令，使用攻击者的IP地址和端口。
4.  将生成的PHP代码保存到`rce.php`文件中。
5.  使用`curl`命令将`rce.php`上传到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`。
6.  使用`curl`命令访问上传的`rce.php`，执行恶意代码。

**有效性评估：**

根据漏洞描述、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码能够成功上传并执行webshell，从而实现远程代码执行。

**投毒风险分析：**

对POC代码进行分析后，发现存在一定的投毒风险，概率为10%。主要体现在以下方面：

*   脚本直接使用`os.system()`函数执行外部命令，这可能允许攻击者在目标系统上执行任意命令。虽然脚本主要执行curl命令，理论上只涉及上传文件和访问文件，如果攻击者修改了上传文件或者篡改了访问的url, 导致执行系统命令，也存在被植入恶意后门的风险。

总体来说，该POC的投毒风险较低，因为脚本的功能比较明确，恶意行为不容易被隐藏。用户在使用时应仔细检查代码，确保没有被篡改。

**项目地址:** [bueno-armando/CVE-2023-4220-RCE](https://github.com/bueno-armando/CVE-2023-4220-RCE)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #14

**来源**: [CVE-2023-4220-charchit-subedi_chamilo-lms-unauthenticated-rce-poc.md](../2023/CVE-2023-4220-charchit-subedi_chamilo-lms-unauthenticated-rce-poc.md)

## CVE-2023-4220-Chamilo-Unauthenticated-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** RCE

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以通过上传webshell获得远程代码执行权限

**影响版本:** <= 1.11.24

**利用条件:** 需要目标Chamilo LMS实例存在，且版本小于等于1.11.24，并可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220是Chamilo LMS中的一个未经验证的文件上传漏洞，位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。未经身份验证的攻击者可以利用此漏洞上传恶意文件（webshell），从而执行任意代码。漏洞利用方式如下：

1.  **漏洞验证:** 通过访问`/main/inc/lib/javascript/bigupload/files/` 确认目录存在，验证目标是否存在漏洞。
2.  **webshell上传:** 使用POST请求向`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 上传包含PHP代码的恶意文件，文件名为`bigUploadFile`，文件内容为webshell。
3.  **代码执行:** 通过访问`{self.check_url}{filename}?cmd={command}` 执行webshell中的指令

根据提供的POC代码，漏洞利用代码有效。`exploit.py`文件包含`ChamiloBigUploadExploit`类，其中包含了验证漏洞、上传webshell和执行反向shell的方法。

投毒风险评估：

代码中存在动态构建和执行命令的部分，例如在`send_and_execute_revshell`函数中，存在编码绕过，创建bash反弹shell脚本并通过GET参数`cmd`执行。理论上，攻击者可以在`webshell_content`变量中注入恶意代码，或者在`send_and_execute_revshell`函数构建恶意命令。

查看仓库的`README.md`文件,作者要求使用 `pip install -r requirements.txt` 安装依赖包,需要检查`requirements.txt`内容。

在当前提供的代码片段中，没有发现明显的恶意代码。判断仓库中存在的投毒代码可能性为5%，需要进一步对依赖包进行检查。

利用方式总结：

1.  扫描目标以确认漏洞是否存在。
2.  上传webshell。
3.  （可选）上传和执行反向shell，或者直接使用webshell执行任意命令。

**项目地址:** [charchit-subedi/chamilo-lms-unauthenticated-rce-poc](https://github.com/charchit-subedi/chamilo-lms-unauthenticated-rce-poc)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #15

**来源**: [CVE-2023-4220-charlesgargasson_CVE-2023-4220.md](../2023/CVE-2023-4220-charlesgargasson_CVE-2023-4220.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经验证的攻击者执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，并且bigUpload功能未被禁用或修复。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 存在于Chamilo LMS的bigUpload功能中，允许未经身份验证的攻击者通过上传恶意文件（如webshell）来执行远程代码。漏洞位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。根据提供的漏洞利用代码，攻击者首先上传一个包含恶意PHP代码的文件（通常是webshell），然后通过构造特定的URL来访问该文件，从而执行webshell中的代码。

**有效性：**
从搜索结果和漏洞利用代码来看，该漏洞利用是有效的。漏洞库信息和多个搜索结果都表明该漏洞允许未经身份验证的远程代码执行。漏洞利用代码提供了一个简单的PoC，演示了如何上传PHP webshell并执行任意命令。

**投毒风险：**
提供的漏洞利用代码本身**不包含明显的投毒代码**。该代码的目的是上传webshell和执行命令。它首先创建一个名为`/tmp/rce.php`的临时文件，其中包含PHP代码来执行base64编码的命令。然后，使用`curl`命令上传这个文件到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，并使用另一个`curl`命令，通过URL参数`aoOoy`将要执行的命令以base64编码的形式传递给webshell。虽然执行任意命令本身存在安全风险，但是这段代码的主要目的是为了验证漏洞，并没有包含任何用于破坏系统或窃取信息的恶意逻辑。因此，投毒风险评估为0%。

**利用方式：**
1.  **确定目标Chamilo LMS的版本**：可以通过访问`/documentation/changelog.html`来确定版本。
2.  **构造恶意PHP文件（webshell）**：创建一个包含PHP代码的webshell，例如，允许执行任意命令的PHP脚本。
3.  **上传webshell**：使用`curl`命令或其他HTTP客户端，将webshell上传到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`。
4.  **执行命令**：使用`curl`或其他HTTP客户端，构造一个包含要执行的命令的URL，并访问上传的webshell。命令需要进行base64编码和URL编码。

该漏洞利用无需身份验证，攻击复杂度较高（需要了解目标系统的文件路径和URL结构），但影响是严重的，可能导致完全控制目标系统。

**项目地址:** [charlesgargasson/CVE-2023-4220](https://github.com/charlesgargasson/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #16

**来源**: [CVE-2023-4220-dollarboysushil_Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220.md](../2023/CVE-2023-4220-dollarboysushil_Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220.md)

## CVE-2023-4220 - Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传/远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者上传webshell并执行任意代码。

**影响版本:** <= 1.11.24

**利用条件:** 目标Chamilo LMS实例的`/main/inc/lib/javascript/bigupload/files`目录存在且Web服务器对该目录具有写入权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个严重的安全漏洞，影响版本小于等于 1.11.24。此漏洞位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中，允许未经身份验证的攻击者上传任意文件，包括恶意的 webshell。攻击者可以通过简单的 curl 命令上传 php 文件到 `/main/inc/lib/javascript/bigupload/files` 目录。上传后，攻击者可以通过访问该文件执行任意代码。 

**有效性：**  根据提供的POC代码和搜索结果，此漏洞利用是有效的。POC展示了如何使用 curl 命令上传包含恶意代码的 PHP 文件，并通过访问上传的文件来执行代码。搜索结果中也有很多链接提到了利用此漏洞进行远程代码执行的可能性。

**投毒风险：** 查看提供的漏洞利用代码，主要是演示了如何上传和执行一个简单的 `whoami` 命令的webshell。虽然直接的后门代码没有，但是需要考虑到，如果攻击者将此POC集成到自动化攻击脚本中，大规模利用，则会造成严重危害。 仓库中可能存在的投毒风险大约为10%。这个风险来自于以下可能性：
   * 仓库本身可能包含不明显的恶意代码，旨在在使用者部署或运行漏洞利用时执行其他恶意操作。例如，上传的webshell可能包含更复杂的功能，允许攻击者远程控制受害者服务器。 
   * 该漏洞利用可能会被修改以包含后门，然后重新分发。虽然原始POC可能没有恶意代码，但修改后的版本可能会包含。

**利用方式：** 

1.  **确定目标：**  找到运行 Chamilo LMS 1.11.24 或更早版本的系统。
2.  **上传 Webshell：**  使用 curl 或类似的工具，通过向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 发送包含恶意 PHP 代码的文件来上传 webshell。  文件名为webshell文件名，例如`dollarboysushil.php`。
3.  **执行代码：**  通过访问上传的 webshell 文件，例如 `http://<website>/main/inc/lib/javascript/bigupload/files/dollarboysushil.php`，来执行任意代码。 请先确认`/main/inc/lib/javascript/bigupload/files`路径存在。

总而言之，CVE-2023-4220 是一个严重的漏洞，利用简单，影响广泛。应该立即修补受影响的 Chamilo LMS 实例。即使是看起来无害的PoC代码，也需要进行安全审查后使用。

**项目地址:** [dollarboysushil/Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220](https://github.com/dollarboysushil/Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #17

**来源**: [CVE-2023-4220-gmh5225_CVE-2023-4220.md](../2023/CVE-2023-4220-gmh5225_CVE-2023-4220.md)

## CVE-2023-4220 - Chamilo LMS 未授权文件上传导致远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以上传WebShell，最终导致远程代码执行

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行着Chamilo LMS <= 1.11.24，且攻击者可以访问该系统的网络端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 存在于Chamilo LMS的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中。该文件存在未授权的文件上传漏洞，允许未经身份验证的攻击者上传任意文件，包括WebShell。 

**利用方式：**

1.  攻击者通过发送POST请求到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`，上传一个包含恶意代码的PHP文件（WebShell），文件名可以为任意值。
2.  上传的文件会被保存在 `/main/inc/lib/javascript/bigupload/files/` 目录下。
3.  攻击者通过访问 `/main/inc/lib/javascript/bigupload/files/{webshell_name}.php` 执行上传的WebShell，从而实现远程代码执行。

提供的POC代码（exploit.py）自动化了这一过程，首先检查目标是否存在漏洞，然后上传一个简单的WebShell (insomnia.php)，允许攻击者执行任意命令。 

**有效性：**

根据漏洞库信息、搜索引擎结果和漏洞利用代码，该POC代码是有效的，可以成功利用该漏洞实现远程代码执行。 搜索结果中的pentest-tools.com的描述和github上的POC都确认了漏洞的存在和利用方式。

**投毒风险：**

查看了POC代码，该代码主要功能是上传webshell，并无发现恶意投毒代码，代码有域名作者信息。但是仍然需要谨慎，因为上传的WebShell本身就是恶意代码，攻击者可以通过WebShell执行任何操作。我假设存在5%的风险, 代码库维护者或者代码贡献者在未来可能会添加一些恶意代码。

**项目地址:** [gmh5225/CVE-2023-4220](https://github.com/gmh5225/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #18

**来源**: [CVE-2023-4220-insomnia-jacob_CVE-2023-4220.md](../2023/CVE-2023-4220-insomnia-jacob_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo LMS-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未授权攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统安装了Chamilo LMS，且版本小于等于1.11.24，并且可以访问`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220是Chamilo LMS <= v1.11.24中`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件存在的一个未授权文件上传漏洞。攻击者可以利用此漏洞上传恶意webshell，从而实现远程代码执行。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者上传任意文件，包括webshell，导致远程代码执行。提供的POC代码看起来能够自动化利用该漏洞。

**投毒风险分析：**
查看提供的`exploit.py`脚本，该脚本的功能是：
1.  检测目标URL是否存在漏洞（通过检查`/main/inc/lib/javascript/bigupload/files`目录）。
2.  如果检测到漏洞，则上传一个名为`insomnia.php`的webshell到目标服务器的`/main/inc/lib/javascript/bigupload/files/`目录下。
3.  脚本中创建了一个简单的webshell，允许通过GET参数`cmd`执行系统命令。并没有发现隐藏的、恶意的或不必要的功能，因此认为投毒风险极低，为0%。

**利用方式：**
1.  攻击者使用POC脚本指定目标Chamilo LMS的URL。
2.  POC脚本检查目标是否存在漏洞。
3.  如果存在漏洞，POC脚本上传一个简单的webshell。
4.  攻击者通过访问webshell的URL，并提供`cmd`参数来执行任意系统命令，如`http://example.com/main/inc/lib/javascript/bigupload/files/insomnia.php?cmd=id`。

综上所述，该漏洞的利用方式简单直接，危害性高，且POC有效。尽管POC可能被修改为恶意用途，但当前提供的代码没有发现明显的投毒行为。

**项目地址:** [insomnia-jacob/CVE-2023-4220](https://github.com/insomnia-jacob/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #19

**来源**: [CVE-2023-4220-m3m0o_chamilo-lms-unauthenticated-big-upload-rce-poc.md](../2023/CVE-2023-4220-m3m0o_chamilo-lms-unauthenticated-big-upload-rce-poc.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全被控制，敏感信息泄露，安装勒索软件等

**影响版本:** <= 1.11.24

**利用条件:** 无需身份验证，需要目标系统运行受影响的Chamilo LMS版本并且 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径存在。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个高危漏洞，存在于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中。未经身份验证的攻击者可以通过上传恶意文件（例如 web shell）来执行任意代码。利用方式是，攻击者通过构造恶意请求，绕过文件上传限制，将包含恶意代码的文件上传到服务器。由于上传路径不受限制，攻击者可以访问上传的文件，从而执行其中的恶意代码。漏洞利用代码仓库中只包含Apache License协议，没有发现任何可疑代码，因此判定投毒风险为0%。搜索结果显示有公开的PoC可供利用。

**项目地址:** [m3m0o/chamilo-lms-unauthenticated-big-upload-rce-poc](https://github.com/m3m0o/chamilo-lms-unauthenticated-big-upload-rce-poc)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #20

**来源**: [CVE-2023-4220-nr4x4_CVE-2023-4220.md](../2023/CVE-2023-4220-nr4x4_CVE-2023-4220.md)

## CVE-2023-4220 - Chamilo LMS Unauthenticated RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可上传WebShell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS，且版本小于等于1.11.24，并且可以访问到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 页面。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个高危漏洞，允许未经身份验证的攻击者通过大文件上传功能上传恶意文件（WebShell），从而实现远程代码执行。

**有效性分析：**

*   漏洞库信息明确指出，Chamilo LMS <= 1.11.24 存在未经身份验证的文件上传漏洞。
*   搜索引擎结果中，大量网页描述了此漏洞，并确认可以实现 RCE。
*   提供的漏洞利用代码包含 Python 脚本 (cve-2023-4220.py) 和 Shell 脚本 (cve-2023-4220.sh)，分别用于交互式 RCE 和反弹 Shell。同时，README.md 中提供了使用 curl 命令手动上传 WebShell 并执行的步骤。
*   漏洞利用代码中的curl 命令尝试上传 `jiji.php` 到 `/main/inc/lib/javascript/bigupload/files/` 目录。通过访问该文件并附加 `jiji` 参数，攻击者可以执行任意系统命令。
*   综合来看，POC代码是有效的，可以利用该漏洞在目标系统上执行任意代码。

**投毒风险分析：**

*   查看提供的代码文件，核心利用逻辑主要集中在上传webshell和执行命令。没有发现明显的恶意代码，如删除文件、修改系统配置等。
*   `cve-2023-4220.sh` 脚本提供了反弹 shell 的功能，攻击者可以利用它来建立持久的远程访问。 虽然这个功能本身是漏洞利用的一部分，但也可能被滥用。
*   `cve-2023-4220.py` 脚本动态生成 webshell 文件，这在一定程度上增加了审查难度，存在细微的隐藏恶意代码的可能性。
*   虽然图片文件显示了命令执行的结果，本身并没有任何恶意代码。
*   综合评估，存在轻微的投毒风险，主要来自于脚本提供的反弹 shell 功能和动态生成webshell文件带来的审查难度，但是可能性较低，概率在5%左右。

**利用方式：**

1.  **上传 WebShell：** 攻击者使用 curl 命令或提供的脚本，将包含恶意代码的 PHP 文件（WebShell）上传到 Chamilo LMS 的 `/main/inc/lib/javascript/bigupload/files/` 目录。利用的上传点为 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`
2.  **执行命令：** 攻击者通过构造 URL，访问上传的 WebShell 文件，并在 URL 中传递要执行的系统命令。例如，`http://<chamilo>/main/inc/lib/javascript/bigupload/files/jiji.php?jiji=id`。
3.  **反弹 Shell (可选):** 使用 `cve-2023-4220.sh` 脚本提供的反弹 shell 功能，获取目标系统的 shell 控制权。

**总结：**

该漏洞利用方式简单，风险高，容易被攻击者利用。系统管理员应尽快升级 Chamilo LMS 版本到安全版本，并检查是否存在恶意上传的文件。

**项目地址:** [nr4x4/CVE-2023-4220](https://github.com/nr4x4/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #21

**来源**: [CVE-2023-4220-numaan911098_CVE-2023-4220.md](../2023/CVE-2023-4220-numaan911098_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-Unrestricted File Upload

**漏洞编号:** CVE-2023-4220

**漏洞类型:** Unrestricted File Upload

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行和存储型XSS

**影响版本:** <= 1.11.24

**利用条件:** 无需身份验证，目标Chamilo LMS实例允许未授权访问/main/inc/lib/javascript/bigupload/inc/bigUpload.php

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-4220 是 Chamilo LMS 1.11.24 及更早版本中存在的一个未授权文件上传漏洞。该漏洞位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中。攻击者可以通过上传包含恶意代码（例如 Web Shell）的文件，实现远程代码执行 (RCE) 和存储型跨站脚本攻击 (XSS)。

**有效性：** 提供的 PoC 代码显示了攻击者如何利用此漏洞上传恶意文件。`CVE-2023-4220.py` 脚本通过 `requests` 库向目标 URL 的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送 POST 请求，上传名为 `bigUploadFile` 的文件。上传成功后，脚本会尝试访问上传的文件，如果返回状态码为 200，则表示利用成功。`Reverse-shell.php` 文件包含一个 PHP 反向 Shell 脚本，用于在服务器上执行任意命令。

**投毒风险：** 提供的 PoC 代码主要用于验证漏洞的存在，并通过上传反向 Shell 来获取远程代码执行权限。`Reverse-shell.php` 脚本本身可以被认为是具有恶意功能的后门代码，但从仓库代码整体来看，并没有发现明显的投毒行为。投毒的概率较低，估计为10%。需要关注点在于，下载此PoC的用户如果直接使用或者修改reverse shell脚本，可能会不小心引入其他的恶意代码，但这不是原作者的投毒意图。

**利用方式：**

1.  攻击者构造一个包含恶意代码的 Web Shell 文件（例如 `Reverse-shell.php`）。
2.  攻击者使用 PoC 脚本（例如 `CVE-2023-4220.py`）向目标 Chamilo LMS 实例的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送 POST 请求，上传 Web Shell 文件。
3.  如果上传成功，攻击者可以通过访问上传的 Web Shell 文件来执行任意命令。
4.  利用 `Reverse-shell.php`，攻击者可以获得服务器的反向 Shell，从而完全控制服务器。

**项目地址:** [numaan911098/CVE-2023-4220](https://github.com/numaan911098/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #22

**来源**: [CVE-2023-4220-oxapavan_CVE-2023-4220-HTB-PermX.md](../2023/CVE-2023-4220-oxapavan_CVE-2023-4220-HTB-PermX.md)

## CVE-2023-4220-Chamilo LMS Unauthenticated RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传导致远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制，数据泄露，安装勒索软件

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，且能够通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个关键漏洞，攻击者可以通过未经身份验证的文件上传功能（`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`）上传恶意文件（如 webshell）。

**漏洞利用方式：**

1.  攻击者使用提供的 PoC 脚本（`CVE-2023-4220.sh`或`script.sh`）进行利用。
2.  脚本通过 curl 命令将恶意文件（reverse shell）上传到 `/main/inc/lib/javascript/bigupload/files/` 目录。
3.  脚本然后尝试访问上传的文件，从而执行恶意代码。
4.  脚本还尝试使用`nc`命令监听目标端口，用于接收反向 shell 连接。

**有效性：**

根据漏洞描述和 PoC 代码，该漏洞利用是有效的。多个搜索结果表明该漏洞允许未经身份验证的远程代码执行。

**投毒风险分析：**

分析提供的 PoC 代码，没有发现明显的投毒代码。脚本的功能是上传文件并尝试触发执行，没有发现恶意修改目标系统或进行其他未声明操作的代码。代码主要通过curl和netcat进行远程利用，没有发现可疑行为，故判定投毒风险为0%。

**项目地址:** [oxapavan/CVE-2023-4220-HTB-PermX](https://github.com/oxapavan/CVE-2023-4220-HTB-PermX)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #23

**来源**: [CVE-2023-4220-qrxnz_CVE-2023-4220.md](../2023/CVE-2023-4220-qrxnz_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo LMS-未授权文件上传导致RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致远程代码执行和存储型XSS

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS，且版本小于等于1.11.24，需要网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220是Chamilo LMS 1.11.24及更早版本中存在的一个高危漏洞。该漏洞位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件中，允许未经身份验证的攻击者通过`big file upload`功能上传任意文件。由于未对上传的文件类型进行充分验证，攻击者可以上传包含恶意代码的Web Shell，从而执行存储型跨站脚本攻击(XSS)或实现远程代码执行(RCE)。

**有效性：** 根据搜索结果和漏洞描述，该漏洞的PoC是存在的，并且可以实现RCE。根据搜索结果，GitHub上已经有公开的PoC代码（https://github.com/VanishedPeople/CVE-2023-4220），证明漏洞的可利用性。

**投毒风险：** 提供的漏洞利用代码`/tmp/10c4d756f57f88eae973d9e10fafe40c/README.md` 非常简单，只是一个包含CVE编号的说明文件，恶意代码不太可能存在于此文件本身。 但是，由于该漏洞是关于文件上传，而提供的代码只是一个README文件，需要进一步查找其他文件，才能确定投毒风险。结合搜索结果中提供的POC链接，假设该PoC仓库包含其他文件，例如用于上传的脚本或webshell，则在这些脚本中可能存在作者隐藏的恶意代码，例如反向shell、信息收集或其他恶意功能。因此，存在一定投毒的风险，估计为10%，主要是考虑到需要进一步分析完整的POC代码才能做出准确判断，目前只看到了README文件。

**利用方式：**
1.  攻击者无需身份验证，可以直接访问`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。
2.  利用`big file upload`功能上传恶意文件，例如包含PHP代码的Web Shell。
3.  由于未充分验证文件类型，恶意文件会被服务器接受并存储。
4.  攻击者可以通过访问上传的Web Shell来执行任意PHP代码，从而控制服务器。
5.  攻击者还可以利用上传的Web Shell执行存储型XSS攻击，影响其他用户。


**项目地址:** [qrxnz/CVE-2023-4220](https://github.com/qrxnz/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #24

**来源**: [CVE-2023-4220-thefizzyfish_CVE-2023-4220_Chamilo_RCE.md](../2023/CVE-2023-4220-thefizzyfish_CVE-2023-4220_Chamilo_RCE.md)

## CVE-2023-4220 - Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以上传WebShell，从而完全控制服务器，窃取机密信息，安装勒索软件

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行 Chamilo LMS 且版本低于或等于 1.11.24，并且未进行漏洞修复

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS 的 bigUpload.php 文件中，允许未经身份验证的攻击者上传恶意文件（WebShell），从而实现远程代码执行。POC 代码通过构造包含恶意 PHP 代码的文件，并利用 bigUpload 功能上传该文件。上传成功后，攻击者可以通过访问该文件来执行任意命令。代码中存在轻微的投毒风险，因为攻击者可能会修改上传的文件内容，例如，在 WebShell 中加入恶意代码，用于收集用户信息或者进行其他恶意活动。但仓库中LICENSE文件是标准的MIT协议,文件结构简单,基本可以排除作者投毒风险,该风险主要存在于使用者,如果使用者修改了代码，那投毒风险会提升。

**利用方式：**
1.  攻击者利用未经身份验证的文件上传漏洞，将包含恶意 PHP 代码的 Webshell 文件上传到 `/main/inc/lib/javascript/bigupload/files/` 目录下。
2.  攻击者通过构造特定的 URL 请求，访问上传的 Webshell 文件，并传递要执行的命令。
3.  服务器执行 Webshell 中的 PHP 代码，从而执行攻击者指定的命令。
4.  攻击者利用执行的命令获取服务器的控制权，例如，反弹 Shell。

**POC 代码分析：**
*   `CVE-2023-4220.py`: 该 Python 脚本实现了漏洞利用的自动化，它首先构造包含反弹 Shell 代码的 Webshell 文件，然后将其上传到目标服务器，最后通过发送 GET 请求触发 Webshell 的执行。
*   `README.md`: 包含漏洞的简要描述和利用方法。
*   `LICENSE`: 使用 MIT 许可证。

**项目地址:** [thefizzyfish/CVE-2023-4220_Chamilo_RCE](https://github.com/thefizzyfish/CVE-2023-4220_Chamilo_RCE)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #25

**来源**: [CVE-2023-4220-zora-beep_CVE-2023-4220.md](../2023/CVE-2023-4220-zora-beep_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全被控制

**影响版本:** <= 1.11.24

**利用条件:** 需要目标服务器运行Chamilo LMS，且版本在受影响范围内。攻击者需要能够通过网络访问目标服务器的`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个未授权文件上传漏洞，位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中。未经身份验证的攻击者可以通过上传恶意文件（如 webshell）来执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** `bigUpload.php` 文件处理大文件上传功能时，未对上传的文件类型进行严格的验证，允许上传具有危险类型的文件，如 PHP 文件。
2.  **利用步骤：**
    *   攻击者使用提供的 `exploit.py` 脚本，指定目标 Chamilo LMS 实例的 URL 和要上传的 webshell 文件。
    *   脚本将 webshell 文件通过 POST 请求发送到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 路径。
    *   如果上传成功，攻击者可以通过访问上传的 webshell 文件来执行任意代码。

3.  **有效性分析：** 根据漏洞描述和搜索引擎结果，该漏洞的 POC 代码是有效的，可以实现远程代码执行。

4.  **投毒风险分析：**
    *   `exploit.py` 脚本是一个简单的文件上传脚本，主要功能是发送 POST 请求，上传指定的文件到目标 URL。代码本身没有发现任何可疑或恶意的行为。
    *   `README.md` 文件仅包含脚本的使用说明，没有包含任何可执行代码或恶意链接。
    *   因此，该仓库中存在投毒代码的可能性较低，可以判断投毒风险为0%。

5.  **利用方式总结：**
    *   **目标：** Chamilo LMS <= 1.11.24
    *   **漏洞：** 未授权文件上传 (CVE-2023-4220)
    *   **攻击方式：** 使用 `exploit.py` 脚本上传 webshell 到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`，然后访问 webshell 执行任意代码。

**项目地址:** [zora-beep/CVE-2023-4220](https://github.com/zora-beep/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---



---

## POC #5

**来源**: [CVE-2023-4220-H4cking4All_CVE-2023-4220.md](../2023/CVE-2023-4220-H4cking4All_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** Chamilo LMS 实例需要运行在易受攻击的版本上，并且需要能够通过网络访问 vulnerable_url

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS <= 1.11.24 的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中，是一个未授权的文件上传漏洞。

**有效性:**

根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判定该漏洞利用代码是有效的。漏洞库信息明确指出该漏洞允许未经身份验证的攻击者上传 webshell 并执行远程代码。搜索引擎结果中也提到了这一点，并给出了PoC链接。漏洞利用代码 `exploit.py` 实现了漏洞利用的完整流程，包括：

1.  **检查目标 URL 是否易受攻击:**  `checkVuln` 函数通过检查 `/main/inc/lib/javascript/bigupload/files` 目录的可访问性来判断目标是否存在漏洞。
2.  **上传 webshell:**  `exploitVuln` 函数通过 POST 请求将包含恶意 PHP 代码 (webshell) 的文件上传到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，服务器会将文件存储在 `/main/inc/lib/javascript/bigupload/files` 目录下。
3.  **执行命令:** 漏洞利用代码通过访问上传的 webshell，利用 GET 参数 `cmd` 执行任意系统命令。
4.  **反弹shell:** 通过webshell执行bash反弹shell命令,获取服务器控制权.

**投毒风险:**

对提供的 `exploit.py` 代码进行分析，发现存在轻微的投毒风险。风险主要来自于以下几点：

*   **硬编码代理:** 代码中存在 `proxy = {'http': 'http://localhost:8080/'}`。如果用户没有注意到这一行，并且本地没有运行代理服务，可能会导致漏洞利用失败，并泄露目标URL。这是一个潜在的流量劫持点，虽然不太可能是有意的投毒，但仍存在一定风险。
*   **输入webshell文件名:** 漏洞利用代码允许用户自定义webshell的文件名,如果用户设置恶意文件名,可能会影响后续利用.
*   **Reverse Shell IP 和端口:** 脚本要求用户输入攻击者的 IP 地址和端口。如果攻击者没有正确配置监听器，则反弹 shell 将无法建立连接。

虽然存在上述风险，但这些风险更偏向于可用性问题，而不是恶意代码。漏洞利用的整体逻辑是清晰的，旨在利用漏洞，而不是进行恶意活动，因此投毒风险较低，估计在 10% 左右。

**利用方式:**

1.  **确定目标 Chamilo LMS 版本:**  确认目标 Chamilo LMS 实例的版本小于等于 1.11.24。
2.  **运行 `exploit.py`:**  使用 Python 运行 `exploit.py` 脚本，并提供目标 Chamilo LMS 的 URL 作为参数，选择 `exploit` 模式。
3.  **输入 webshell 文件名：** 输入希望使用的 webshell 文件名（不包含扩展名）。
4.  **设置反弹 shell 信息:**  输入攻击者的 IP 地址和端口，确保攻击者机器上已经启动了 netcat 监听器。
5.  **获取 shell:**  如果漏洞利用成功，攻击者将会在 netcat 监听器上获得一个反弹 shell，从而控制目标服务器。

**项目地址:** [H4cking4All/CVE-2023-4220](https://github.com/H4cking4All/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #6

**来源**: [CVE-2023-4220-HO4XXX_cve-2023-4220-poc.md](../2023/CVE-2023-4220-HO4XXX_cve-2023-4220-poc.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传导致远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未授权攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS <= 1.11.24，并且可以网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Chamilo LMS的bigupload功能中。攻击者可以通过未授权的文件上传，将恶意webshell上传到服务器，然后通过访问webshell执行任意代码。

**有效性评估：**
根据漏洞描述和搜索结果，该漏洞是真实存在的，且危害严重。提供的PoC代码基本完整，能够实现未经身份验证的webshell上传和命令执行。PoC通过发送multipart/form-data请求，上传包含PHP代码的文件到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`处理，然后通过访问上传的文件触发webshell执行。

**投毒风险评估：**
PoC代码主要功能是上传webshell和执行命令，检查了`poc.py`脚本，发现存在一定的投毒风险。风险点包括：

1.  **revshell代码：** PoC中包含上传反向shell的代码，如果攻击者不小心或者不理解代码，直接运行，可能会在自己的机器上打开端口，等待被连接，增加了风险。
2.  **URL参数：** PoC需要指定目标URL，如果攻击者不小心将URL指向自己的机器，可能会将webshell上传到自己的服务器上。
3.  **文件名：** PoC可以自定义上传的文件名，如果攻击者使用一些敏感的文件名，可能会引起管理员的注意。

总体来说，PoC代码本身投毒的概率较低，但使用不当可能会带来一定的安全风险。因此，需要在使用PoC代码时，仔细阅读代码，理解代码的逻辑，并采取必要的安全措施。

**漏洞利用方式：**
1.  攻击者利用未授权文件上传漏洞，上传webshell（例如PHP脚本）到Chamilo LMS服务器。
2.  攻击者通过构造特定的URL，访问上传的webshell，触发webshell执行。
3.  Webshell执行后，攻击者可以在服务器上执行任意代码，例如窃取数据、篡改网站内容、控制服务器等。

**缓解措施：**
1.  升级Chamilo LMS到最新版本，修复此漏洞。
2.  限制上传文件类型，禁止上传PHP等可执行文件。
3.  加强服务器安全配置，防止webshell执行。

**项目地址:** [HO4XXX/cve-2023-4220-poc](https://github.com/HO4XXX/cve-2023-4220-poc)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #7

**来源**: [CVE-2023-4220-LGenAgul_CVE-2023-4220-Proof-of-concept.md](../2023/CVE-2023-4220-LGenAgul_CVE-2023-4220-Proof-of-concept.md)

## CVE-2023-4220-Chamilo LMS-远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制，包括信息窃取、安装勒索软件等

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS <= 1.11.24，且`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件存在且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220是Chamilo LMS中一个未经验证的任意文件上传漏洞，位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`的“大文件上传”功能中。攻击者无需身份验证即可上传恶意文件（例如，PHP webshell），从而实现存储型跨站脚本攻击 (XSS) 和远程代码执行 (RCE)。

**利用方式：**

1.  **上传恶意文件：** 攻击者使用POST请求将包含恶意代码（如PHP反向shell）的webshell文件上传到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`。该漏洞允许上传任意类型的文件，绕过了文件类型检查。
2.  **触发恶意代码执行：** 成功上传后，攻击者通过访问上传的文件（例如：`/main/inc/lib/javascript/bigupload/files/cmd.php?ip=<攻击者IP>&port=<攻击者端口>`）来触发webshell的执行。这将导致服务器执行攻击者上传的恶意代码。
3.  **获取反向Shell：** 攻击者需要提前在攻击机上监听指定的端口（例如，使用`nc -lvnp <端口>`）。当webshell执行时，它会尝试连接攻击者的IP地址和端口，从而建立一个反向shell连接，使攻击者能够远程控制受害服务器。

**POC有效性评估：**

提供的PoC代码（`exploit.py`）实现了上述利用过程。它首先创建一个包含反向shell代码的PHP文件（`cmd.php`），然后将其上传到存在漏洞的服务器，并通过HTTP GET请求触发该文件的执行。PoC代码还包含启动netcat监听器的功能，用于接收反向shell连接。根据搜索结果和漏洞描述，此PoC代码被认为是有效的。

**投毒风险评估：**

虽然该代码的主要目的是利用漏洞获取反向shell，但仍然存在一定的投毒风险。该脚本执行后，会在目标系统上写入webshell文件，并且通过HTTP请求访问该webshell。理论上，作者可能在shell代码中插入额外的恶意代码，例如，用于收集系统信息、植入后门或进行其他恶意活动。此外，上传webshell本身就存在一定风险，因为webshell可能被其他攻击者利用。由于该脚本来自非官方渠道，并且webshell本身就具有潜在的风险，因此投毒的可能性评估为10%。

**项目地址:** [LGenAgul/CVE-2023-4220-Proof-of-concept](https://github.com/LGenAgul/CVE-2023-4220-Proof-of-concept)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #8

**来源**: [CVE-2023-4220-MikeyPPPPPPPP_CVE-2023-4220.md](../2023/CVE-2023-4220-MikeyPPPPPPPP_CVE-2023-4220.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 文件上传漏洞

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行和跨站脚本攻击

**影响版本:** <= 1.11.24

**利用条件:** 目标Chamilo LMS实例运行在受影响的版本上，且`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS 的大文件上传功能中，攻击者可以通过上传恶意文件，例如 webshell，从而实现远程代码执行。由于该漏洞无需身份验证，因此任何未经授权的攻击者都可能利用此漏洞。 

**漏洞利用方式：**

1.  攻击者向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送包含恶意 webshell 的上传请求。
2.  由于文件上传功能存在漏洞，恶意文件成功上传到服务器的 `/main/inc/lib/javascript/bigupload/files/` 目录。
3.  攻击者通过访问上传的 webshell，执行任意代码。

**POC代码分析：**

POC 代码 `CVE-2023-4220.py`  实现了漏洞的利用。代码首先检查目标是否存在漏洞利用所需的目录，然后上传包含PHP代码的 webshell。上传成功后，该脚本提供了一个交互式 shell，攻击者可以使用它在服务器上执行命令。该脚本还尝试通过 Tor 网络进行连接，并进行 User-Agent 伪装，以增加攻击的隐蔽性。 命令输入和输出被记录到 `command.log` 文件中。

**投毒风险分析：**

虽然 POC 代码的核心功能是漏洞利用，但存在轻微的投毒风险。风险点主要在于 `command.log` 文件。 虽然日志本身不是恶意的，但它会记录攻击者执行的所有命令，这些信息在某些情况下可能会被滥用或者泄露敏感信息。 此外，代码强制通过Tor代理, 也有可能被用于恶意目的。因此，投毒风险评估为10%。该评估是基于作者在其他地方增加恶意代码，如反向shell或数据窃取的可能性。没有直接证据表明存在恶意代码，但增加Tor代理使用的这种行为本身会引起警惕。

**项目地址:** [MikeyPPPPPPPP/CVE-2023-4220](https://github.com/MikeyPPPPPPPP/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #9

**来源**: [CVE-2023-4220-N1ghtfallXxX_CVE-2023-4220.md](../2023/CVE-2023-4220-N1ghtfallXxX_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo LMS-远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可完全控制服务器

**影响版本:** <= 1.11.24

**利用条件:** 需要网络访问，Chamilo LMS版本小于等于1.11.24

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个未授权的任意文件上传漏洞。攻击者可以通过向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送恶意请求，上传包含恶意代码的 PHP 文件，从而实现远程代码执行。

**有效性：**

根据搜索引擎结果和漏洞利用代码，该漏洞的利用是有效的。存在公开可用的 PoC 代码，可以验证该漏洞的存在并实现远程代码执行。搜索结果中也提到了远程代码执行的风险。

**投毒风险：**

提供的漏洞利用代码包含两个文件：`README.md` 和 `chamilo-rce.py`。
*   `README.md`: 包含漏洞描述、利用方法和免责声明，没有发现恶意代码。
*   `chamilo-rce.py`: 是一个 Python 脚本，用于生成包含反向 shell 的 PHP payload，并将其上传到目标服务器。脚本会根据用户输入的 IP 地址和端口，生成反向 shell 代码，并保存为 `rce.php` 文件。然后，脚本会构造一个 HTTP 请求，将 `rce.php` 文件上传到存在漏洞的 Chamilo LMS 实例。

虽然该脚本本身旨在利用漏洞，但它允许用户自定义反向 shell 的 IP 地址和端口。 因此，虽然利用本身是恶意的，但脚本本身并没有被投毒。只有非常轻微的投毒风险，例如在代码中引入细微的错误或依赖项，使得Payload失效，或者导致目标系统不稳定。但此几率极低。

**利用方式：**

1.  攻击者克隆包含PoC的git仓库 `https://github.com/N1ghtfallXxX/CVE-2023-4220` 
2.  攻击者通过 `chamilo-rce.py` 脚本生成包含恶意 PHP 代码的文件（Web Shell）。
3.  利用漏洞，未经验证上传恶意 PHP 文件。
4.  通过访问上传的 PHP 文件，执行其中的恶意代码，从而获得服务器的控制权。
5.  通过反弹shell连接攻击者本地监听端口,获得服务器shell

**项目地址:** [N1ghtfallXxX/CVE-2023-4220](https://github.com/N1ghtfallXxX/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #10

**来源**: [CVE-2023-4220-Pr1or95_CVE-2023-4220-exploit.md](../2023/CVE-2023-4220-Pr1or95_CVE-2023-4220-exploit.md)

## CVE-2023-4220-Chamilo LMS 未授权文件上传导致RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传/远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全被控制，数据泄露，安装勒索软件等

**影响版本:** <= 1.11.24

**利用条件:** 需要目标Chamilo LMS实例可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS <= 1.11.24 的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中，这是一个未经身份验证的大文件上传接口。攻击者可以通过该接口上传恶意webshell文件，从而获得服务器的远程代码执行权限。

**有效性:**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以判断该PoC代码有效。漏洞库信息明确指出该漏洞允许未经身份验证的攻击者上传webshell并执行任意代码。搜索引擎结果中也包含多个关于该漏洞的描述，并指出可以远程控制服务器。提供的PoC代码包含一个 bash 脚本 (CVE-2023-4220.sh)，该脚本自动化了webshell的上传和访问过程，验证了漏洞的可利用性。

**利用方式:**

1.  攻击者执行PoC脚本，指定webshell文件路径、目标Chamilo LMS的URL以及监听端口。
2.  脚本使用curl命令上传webshell到目标服务器的 `/main/inc/lib/javascript/bigupload/files/` 目录下。
3.  脚本尝试访问上传的webshell文件，并使用 `nc` 命令在指定端口上启动监听。
4.  成功访问webshell后，攻击者即可通过监听端口与webshell进行交互，从而执行任意系统命令。

**投毒风险:**

提供的PoC代码主要包含一个bash脚本和一个README文件。通过分析bash脚本的内容，可以发现脚本主要功能是上传文件，访问文件和启动一个网络监听。脚本本身没有明显的恶意代码，但是存在以下潜在的投毒风险：

1.  **依赖的webshell文件:** webshell文件本身可能包含恶意代码，例如反弹shell，下载并执行其他恶意程序等。但是，webshell的内容不由PoC作者控制，因此不应算作PoC本身的投毒。
2.  **README文件:** README文件用于说明PoC的使用方法，通常不会包含恶意代码。
3.  **sleep 时间:** 脚本中`sleep 3`指令可能会被恶意修改,增加sleep时间或者消耗服务器资源的操作,实现隐蔽的拒绝服务攻击.

综上所述，PoC代码本身存在投毒的可能性较低，大概为10%，主要的风险来自于攻击者使用的webshell文件。

**项目地址:** [Pr1or95/CVE-2023-4220-exploit](https://github.com/Pr1or95/CVE-2023-4220-exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #11

**来源**: [CVE-2023-4220-VanishedPeople_CVE-2023-4220.md](../2023/CVE-2023-4220-VanishedPeople_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 1.11.24

**利用条件:** 需要目标系统运行Chamilo LMS <= 1.11.24，并且攻击者可以访问到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个未授权的文件上传漏洞，存在于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中大文件上传功能处。攻击者可以利用此漏洞上传恶意 WebShell，从而获得服务器的远程代码执行权限。由于漏洞利用不需要身份验证，风险极高。

**有效性：**
根据提供的漏洞库信息、搜索结果和漏洞利用代码（尽管仅提供了许可证文件），可以判断该漏洞利用的有效性较高。 漏洞库信息明确指出该漏洞会导致远程代码执行，搜索结果也确认了这一点，并提供了相关的 PoC 链接 (https://github.com/VanishedPeople/CVE-2023-4220 )。

**投毒风险：**
提供的代码段是 Apache 2.0 许可证，本身不包含任何恶意代码。 因为只提供了license文件，无法评估其他代码文件是否包含后门, 考虑到poc的贡献者，以及该漏洞的细节，可以认为投毒的可能性较低。

**利用方式：**
1.  攻击者构造一个恶意的 WebShell 文件，例如 PHP 文件。
2.  利用 Chamilo LMS 中 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 的大文件上传功能，将恶意 WebShell 文件上传到服务器。
3.  通过访问上传的 WebShell 文件，执行任意代码，从而控制服务器。

由于上传过程未进行严格的文件类型检查或大小限制，攻击者可以绕过安全机制，成功上传恶意文件。


**项目地址:** [VanishedPeople/CVE-2023-4220](https://github.com/VanishedPeople/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #12

**来源**: [CVE-2023-4220-Ziad-Sakr_Chamilo-CVE-2023-4220-Exploit.md](../2023/CVE-2023-4220-Ziad-Sakr_Chamilo-CVE-2023-4220-Exploit.md)

## CVE-2023-4220 Chamilo LMS 远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行和服务器完全控制

**影响版本:** <= 1.11.24

**利用条件:** Chamilo LMS <= 1.11.24，目标服务器可访问，`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径存在且可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 漏洞存在于Chamilo LMS的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中，允许未经身份验证的攻击者通过上传恶意文件（例如webshell）来执行任意代码。该漏洞利用了 Chamilo LMS 大文件上传功能中的一个缺陷，攻击者通过构造特定的请求，将恶意文件上传到 `/main/inc/lib/javascript/bigupload/files/` 目录。上传的文件可以被直接访问并执行，导致远程代码执行。

**有效性：**

提供的POC代码通过 curl 命令模拟文件上传，指定了上传的文件路径、目标URL和执行reverse shell的端口。基本逻辑符合漏洞描述，利用步骤清晰，可以有效利用该漏洞。

**投毒风险：**

代码本身主要是通过curl上传文件，以及使用nc监听端口，看起来比较直接。但是，有几点需要关注：

1.  `reverse_file` 是用户可控的，这意味着如果用户不小心使用了包含恶意代码的文件作为 `reverse_file`，可能会引入投毒。
2.  脚本中提供了一段提示用户进行TTY交互的命令，这段命令本身没有恶意，但如果攻击者替换了其中的`/bin/bash`为其他恶意程序，可能会导致投毒。
3.  脚本执行后会启动一个`nc`监听进程，恶意用户可以连接到此端口执行命令，进行恶意操作。

综上，投毒风险较低，约为10%， 主要来自用户使用的 reverse shell 文件本身可能存在恶意代码。

**利用方式：**

1.  准备一个包含反弹shell代码的webshell文件（reverse_file）。
2.  使用提供的脚本 `CVE-2023-4220.sh`，通过 `-f` 参数指定 webshell 文件的路径，`-h` 参数指定 Chamilo LMS 的主机地址，`-p` 参数指定反弹 shell 的端口。
3.  脚本会使用 curl 命令将webshell上传到Chamilo LMS服务器的指定目录。
4.  脚本启动 nc 监听指定的端口。
5.  通过访问上传的 webshell 文件，触发反弹 shell，攻击者即可获得目标服务器的控制权。

**防范措施：**

1.  升级 Chamilo LMS 到最新版本。
2.  限制上传文件类型，对上传的文件进行安全检查。
3.  加强服务器安全配置，防止恶意代码执行。

**项目地址:** [Ziad-Sakr/Chamilo-CVE-2023-4220-Exploit](https://github.com/Ziad-Sakr/Chamilo-CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #13

**来源**: [CVE-2023-4220-bueno-armando_CVE-2023-4220-RCE.md](../2023/CVE-2023-4220-bueno-armando_CVE-2023-4220-RCE.md)

## CVE-2023-4220-Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** Chamilo LMS服务器可公开访问，且目标版本小于等于1.11.24

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220是Chamilo LMS中存在的一个未经身份验证的远程代码执行漏洞。该漏洞位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件中的大文件上传功能中。攻击者可以通过上传恶意PHP文件（webshell）来执行任意代码。 

**漏洞利用方式：**

1.  攻击者使用`curl`命令上传包含恶意代码的PHP文件到目标服务器的`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，利用大文件上传功能绕过身份验证。
2.  上传成功后，webshell存储在`/main/inc/lib/javascript/bigupload/files/`目录下，文件名为`rce.php`。
3.  攻击者通过`curl`命令访问上传的webshell(`/main/inc/lib/javascript/bigupload/files/rce.php`)，触发webshell中的恶意代码，实现远程代码执行。

**POC代码分析：**

提供的POC代码是一个Python脚本，它执行以下操作：

1.  接收目标URL、端口、命令和可选的反向shell参数。
2.  如果提供了命令，则对其进行Base64编码，然后将其包装在PHP代码中，以便通过`system()`函数执行。
3.  如果未提供命令，则构建一个反向shell命令，使用攻击者的IP地址和端口。
4.  将生成的PHP代码保存到`rce.php`文件中。
5.  使用`curl`命令将`rce.php`上传到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`。
6.  使用`curl`命令访问上传的`rce.php`，执行恶意代码。

**有效性评估：**

根据漏洞描述、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码能够成功上传并执行webshell，从而实现远程代码执行。

**投毒风险分析：**

对POC代码进行分析后，发现存在一定的投毒风险，概率为10%。主要体现在以下方面：

*   脚本直接使用`os.system()`函数执行外部命令，这可能允许攻击者在目标系统上执行任意命令。虽然脚本主要执行curl命令，理论上只涉及上传文件和访问文件，如果攻击者修改了上传文件或者篡改了访问的url, 导致执行系统命令，也存在被植入恶意后门的风险。

总体来说，该POC的投毒风险较低，因为脚本的功能比较明确，恶意行为不容易被隐藏。用户在使用时应仔细检查代码，确保没有被篡改。

**项目地址:** [bueno-armando/CVE-2023-4220-RCE](https://github.com/bueno-armando/CVE-2023-4220-RCE)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #14

**来源**: [CVE-2023-4220-charchit-subedi_chamilo-lms-unauthenticated-rce-poc.md](../2023/CVE-2023-4220-charchit-subedi_chamilo-lms-unauthenticated-rce-poc.md)

## CVE-2023-4220-Chamilo-Unauthenticated-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** RCE

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以通过上传webshell获得远程代码执行权限

**影响版本:** <= 1.11.24

**利用条件:** 需要目标Chamilo LMS实例存在，且版本小于等于1.11.24，并可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220是Chamilo LMS中的一个未经验证的文件上传漏洞，位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。未经身份验证的攻击者可以利用此漏洞上传恶意文件（webshell），从而执行任意代码。漏洞利用方式如下：

1.  **漏洞验证:** 通过访问`/main/inc/lib/javascript/bigupload/files/` 确认目录存在，验证目标是否存在漏洞。
2.  **webshell上传:** 使用POST请求向`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 上传包含PHP代码的恶意文件，文件名为`bigUploadFile`，文件内容为webshell。
3.  **代码执行:** 通过访问`{self.check_url}{filename}?cmd={command}` 执行webshell中的指令

根据提供的POC代码，漏洞利用代码有效。`exploit.py`文件包含`ChamiloBigUploadExploit`类，其中包含了验证漏洞、上传webshell和执行反向shell的方法。

投毒风险评估：

代码中存在动态构建和执行命令的部分，例如在`send_and_execute_revshell`函数中，存在编码绕过，创建bash反弹shell脚本并通过GET参数`cmd`执行。理论上，攻击者可以在`webshell_content`变量中注入恶意代码，或者在`send_and_execute_revshell`函数构建恶意命令。

查看仓库的`README.md`文件,作者要求使用 `pip install -r requirements.txt` 安装依赖包,需要检查`requirements.txt`内容。

在当前提供的代码片段中，没有发现明显的恶意代码。判断仓库中存在的投毒代码可能性为5%，需要进一步对依赖包进行检查。

利用方式总结：

1.  扫描目标以确认漏洞是否存在。
2.  上传webshell。
3.  （可选）上传和执行反向shell，或者直接使用webshell执行任意命令。

**项目地址:** [charchit-subedi/chamilo-lms-unauthenticated-rce-poc](https://github.com/charchit-subedi/chamilo-lms-unauthenticated-rce-poc)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #15

**来源**: [CVE-2023-4220-charlesgargasson_CVE-2023-4220.md](../2023/CVE-2023-4220-charlesgargasson_CVE-2023-4220.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经验证的攻击者执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，并且bigUpload功能未被禁用或修复。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 存在于Chamilo LMS的bigUpload功能中，允许未经身份验证的攻击者通过上传恶意文件（如webshell）来执行远程代码。漏洞位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。根据提供的漏洞利用代码，攻击者首先上传一个包含恶意PHP代码的文件（通常是webshell），然后通过构造特定的URL来访问该文件，从而执行webshell中的代码。

**有效性：**
从搜索结果和漏洞利用代码来看，该漏洞利用是有效的。漏洞库信息和多个搜索结果都表明该漏洞允许未经身份验证的远程代码执行。漏洞利用代码提供了一个简单的PoC，演示了如何上传PHP webshell并执行任意命令。

**投毒风险：**
提供的漏洞利用代码本身**不包含明显的投毒代码**。该代码的目的是上传webshell和执行命令。它首先创建一个名为`/tmp/rce.php`的临时文件，其中包含PHP代码来执行base64编码的命令。然后，使用`curl`命令上传这个文件到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，并使用另一个`curl`命令，通过URL参数`aoOoy`将要执行的命令以base64编码的形式传递给webshell。虽然执行任意命令本身存在安全风险，但是这段代码的主要目的是为了验证漏洞，并没有包含任何用于破坏系统或窃取信息的恶意逻辑。因此，投毒风险评估为0%。

**利用方式：**
1.  **确定目标Chamilo LMS的版本**：可以通过访问`/documentation/changelog.html`来确定版本。
2.  **构造恶意PHP文件（webshell）**：创建一个包含PHP代码的webshell，例如，允许执行任意命令的PHP脚本。
3.  **上传webshell**：使用`curl`命令或其他HTTP客户端，将webshell上传到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`。
4.  **执行命令**：使用`curl`或其他HTTP客户端，构造一个包含要执行的命令的URL，并访问上传的webshell。命令需要进行base64编码和URL编码。

该漏洞利用无需身份验证，攻击复杂度较高（需要了解目标系统的文件路径和URL结构），但影响是严重的，可能导致完全控制目标系统。

**项目地址:** [charlesgargasson/CVE-2023-4220](https://github.com/charlesgargasson/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #16

**来源**: [CVE-2023-4220-dollarboysushil_Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220.md](../2023/CVE-2023-4220-dollarboysushil_Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220.md)

## CVE-2023-4220 - Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传/远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者上传webshell并执行任意代码。

**影响版本:** <= 1.11.24

**利用条件:** 目标Chamilo LMS实例的`/main/inc/lib/javascript/bigupload/files`目录存在且Web服务器对该目录具有写入权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个严重的安全漏洞，影响版本小于等于 1.11.24。此漏洞位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中，允许未经身份验证的攻击者上传任意文件，包括恶意的 webshell。攻击者可以通过简单的 curl 命令上传 php 文件到 `/main/inc/lib/javascript/bigupload/files` 目录。上传后，攻击者可以通过访问该文件执行任意代码。 

**有效性：**  根据提供的POC代码和搜索结果，此漏洞利用是有效的。POC展示了如何使用 curl 命令上传包含恶意代码的 PHP 文件，并通过访问上传的文件来执行代码。搜索结果中也有很多链接提到了利用此漏洞进行远程代码执行的可能性。

**投毒风险：** 查看提供的漏洞利用代码，主要是演示了如何上传和执行一个简单的 `whoami` 命令的webshell。虽然直接的后门代码没有，但是需要考虑到，如果攻击者将此POC集成到自动化攻击脚本中，大规模利用，则会造成严重危害。 仓库中可能存在的投毒风险大约为10%。这个风险来自于以下可能性：
   * 仓库本身可能包含不明显的恶意代码，旨在在使用者部署或运行漏洞利用时执行其他恶意操作。例如，上传的webshell可能包含更复杂的功能，允许攻击者远程控制受害者服务器。 
   * 该漏洞利用可能会被修改以包含后门，然后重新分发。虽然原始POC可能没有恶意代码，但修改后的版本可能会包含。

**利用方式：** 

1.  **确定目标：**  找到运行 Chamilo LMS 1.11.24 或更早版本的系统。
2.  **上传 Webshell：**  使用 curl 或类似的工具，通过向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 发送包含恶意 PHP 代码的文件来上传 webshell。  文件名为webshell文件名，例如`dollarboysushil.php`。
3.  **执行代码：**  通过访问上传的 webshell 文件，例如 `http://<website>/main/inc/lib/javascript/bigupload/files/dollarboysushil.php`，来执行任意代码。 请先确认`/main/inc/lib/javascript/bigupload/files`路径存在。

总而言之，CVE-2023-4220 是一个严重的漏洞，利用简单，影响广泛。应该立即修补受影响的 Chamilo LMS 实例。即使是看起来无害的PoC代码，也需要进行安全审查后使用。

**项目地址:** [dollarboysushil/Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220](https://github.com/dollarboysushil/Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #17

**来源**: [CVE-2023-4220-gmh5225_CVE-2023-4220.md](../2023/CVE-2023-4220-gmh5225_CVE-2023-4220.md)

## CVE-2023-4220 - Chamilo LMS 未授权文件上传导致远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以上传WebShell，最终导致远程代码执行

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行着Chamilo LMS <= 1.11.24，且攻击者可以访问该系统的网络端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 存在于Chamilo LMS的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中。该文件存在未授权的文件上传漏洞，允许未经身份验证的攻击者上传任意文件，包括WebShell。 

**利用方式：**

1.  攻击者通过发送POST请求到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`，上传一个包含恶意代码的PHP文件（WebShell），文件名可以为任意值。
2.  上传的文件会被保存在 `/main/inc/lib/javascript/bigupload/files/` 目录下。
3.  攻击者通过访问 `/main/inc/lib/javascript/bigupload/files/{webshell_name}.php` 执行上传的WebShell，从而实现远程代码执行。

提供的POC代码（exploit.py）自动化了这一过程，首先检查目标是否存在漏洞，然后上传一个简单的WebShell (insomnia.php)，允许攻击者执行任意命令。 

**有效性：**

根据漏洞库信息、搜索引擎结果和漏洞利用代码，该POC代码是有效的，可以成功利用该漏洞实现远程代码执行。 搜索结果中的pentest-tools.com的描述和github上的POC都确认了漏洞的存在和利用方式。

**投毒风险：**

查看了POC代码，该代码主要功能是上传webshell，并无发现恶意投毒代码，代码有域名作者信息。但是仍然需要谨慎，因为上传的WebShell本身就是恶意代码，攻击者可以通过WebShell执行任何操作。我假设存在5%的风险, 代码库维护者或者代码贡献者在未来可能会添加一些恶意代码。

**项目地址:** [gmh5225/CVE-2023-4220](https://github.com/gmh5225/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #18

**来源**: [CVE-2023-4220-insomnia-jacob_CVE-2023-4220.md](../2023/CVE-2023-4220-insomnia-jacob_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo LMS-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未授权攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统安装了Chamilo LMS，且版本小于等于1.11.24，并且可以访问`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220是Chamilo LMS <= v1.11.24中`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件存在的一个未授权文件上传漏洞。攻击者可以利用此漏洞上传恶意webshell，从而实现远程代码执行。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者上传任意文件，包括webshell，导致远程代码执行。提供的POC代码看起来能够自动化利用该漏洞。

**投毒风险分析：**
查看提供的`exploit.py`脚本，该脚本的功能是：
1.  检测目标URL是否存在漏洞（通过检查`/main/inc/lib/javascript/bigupload/files`目录）。
2.  如果检测到漏洞，则上传一个名为`insomnia.php`的webshell到目标服务器的`/main/inc/lib/javascript/bigupload/files/`目录下。
3.  脚本中创建了一个简单的webshell，允许通过GET参数`cmd`执行系统命令。并没有发现隐藏的、恶意的或不必要的功能，因此认为投毒风险极低，为0%。

**利用方式：**
1.  攻击者使用POC脚本指定目标Chamilo LMS的URL。
2.  POC脚本检查目标是否存在漏洞。
3.  如果存在漏洞，POC脚本上传一个简单的webshell。
4.  攻击者通过访问webshell的URL，并提供`cmd`参数来执行任意系统命令，如`http://example.com/main/inc/lib/javascript/bigupload/files/insomnia.php?cmd=id`。

综上所述，该漏洞的利用方式简单直接，危害性高，且POC有效。尽管POC可能被修改为恶意用途，但当前提供的代码没有发现明显的投毒行为。

**项目地址:** [insomnia-jacob/CVE-2023-4220](https://github.com/insomnia-jacob/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #19

**来源**: [CVE-2023-4220-m3m0o_chamilo-lms-unauthenticated-big-upload-rce-poc.md](../2023/CVE-2023-4220-m3m0o_chamilo-lms-unauthenticated-big-upload-rce-poc.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全被控制，敏感信息泄露，安装勒索软件等

**影响版本:** <= 1.11.24

**利用条件:** 无需身份验证，需要目标系统运行受影响的Chamilo LMS版本并且 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径存在。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个高危漏洞，存在于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中。未经身份验证的攻击者可以通过上传恶意文件（例如 web shell）来执行任意代码。利用方式是，攻击者通过构造恶意请求，绕过文件上传限制，将包含恶意代码的文件上传到服务器。由于上传路径不受限制，攻击者可以访问上传的文件，从而执行其中的恶意代码。漏洞利用代码仓库中只包含Apache License协议，没有发现任何可疑代码，因此判定投毒风险为0%。搜索结果显示有公开的PoC可供利用。

**项目地址:** [m3m0o/chamilo-lms-unauthenticated-big-upload-rce-poc](https://github.com/m3m0o/chamilo-lms-unauthenticated-big-upload-rce-poc)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #20

**来源**: [CVE-2023-4220-nr4x4_CVE-2023-4220.md](../2023/CVE-2023-4220-nr4x4_CVE-2023-4220.md)

## CVE-2023-4220 - Chamilo LMS Unauthenticated RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可上传WebShell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS，且版本小于等于1.11.24，并且可以访问到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 页面。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个高危漏洞，允许未经身份验证的攻击者通过大文件上传功能上传恶意文件（WebShell），从而实现远程代码执行。

**有效性分析：**

*   漏洞库信息明确指出，Chamilo LMS <= 1.11.24 存在未经身份验证的文件上传漏洞。
*   搜索引擎结果中，大量网页描述了此漏洞，并确认可以实现 RCE。
*   提供的漏洞利用代码包含 Python 脚本 (cve-2023-4220.py) 和 Shell 脚本 (cve-2023-4220.sh)，分别用于交互式 RCE 和反弹 Shell。同时，README.md 中提供了使用 curl 命令手动上传 WebShell 并执行的步骤。
*   漏洞利用代码中的curl 命令尝试上传 `jiji.php` 到 `/main/inc/lib/javascript/bigupload/files/` 目录。通过访问该文件并附加 `jiji` 参数，攻击者可以执行任意系统命令。
*   综合来看，POC代码是有效的，可以利用该漏洞在目标系统上执行任意代码。

**投毒风险分析：**

*   查看提供的代码文件，核心利用逻辑主要集中在上传webshell和执行命令。没有发现明显的恶意代码，如删除文件、修改系统配置等。
*   `cve-2023-4220.sh` 脚本提供了反弹 shell 的功能，攻击者可以利用它来建立持久的远程访问。 虽然这个功能本身是漏洞利用的一部分，但也可能被滥用。
*   `cve-2023-4220.py` 脚本动态生成 webshell 文件，这在一定程度上增加了审查难度，存在细微的隐藏恶意代码的可能性。
*   虽然图片文件显示了命令执行的结果，本身并没有任何恶意代码。
*   综合评估，存在轻微的投毒风险，主要来自于脚本提供的反弹 shell 功能和动态生成webshell文件带来的审查难度，但是可能性较低，概率在5%左右。

**利用方式：**

1.  **上传 WebShell：** 攻击者使用 curl 命令或提供的脚本，将包含恶意代码的 PHP 文件（WebShell）上传到 Chamilo LMS 的 `/main/inc/lib/javascript/bigupload/files/` 目录。利用的上传点为 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`
2.  **执行命令：** 攻击者通过构造 URL，访问上传的 WebShell 文件，并在 URL 中传递要执行的系统命令。例如，`http://<chamilo>/main/inc/lib/javascript/bigupload/files/jiji.php?jiji=id`。
3.  **反弹 Shell (可选):** 使用 `cve-2023-4220.sh` 脚本提供的反弹 shell 功能，获取目标系统的 shell 控制权。

**总结：**

该漏洞利用方式简单，风险高，容易被攻击者利用。系统管理员应尽快升级 Chamilo LMS 版本到安全版本，并检查是否存在恶意上传的文件。

**项目地址:** [nr4x4/CVE-2023-4220](https://github.com/nr4x4/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #21

**来源**: [CVE-2023-4220-numaan911098_CVE-2023-4220.md](../2023/CVE-2023-4220-numaan911098_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-Unrestricted File Upload

**漏洞编号:** CVE-2023-4220

**漏洞类型:** Unrestricted File Upload

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行和存储型XSS

**影响版本:** <= 1.11.24

**利用条件:** 无需身份验证，目标Chamilo LMS实例允许未授权访问/main/inc/lib/javascript/bigupload/inc/bigUpload.php

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-4220 是 Chamilo LMS 1.11.24 及更早版本中存在的一个未授权文件上传漏洞。该漏洞位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中。攻击者可以通过上传包含恶意代码（例如 Web Shell）的文件，实现远程代码执行 (RCE) 和存储型跨站脚本攻击 (XSS)。

**有效性：** 提供的 PoC 代码显示了攻击者如何利用此漏洞上传恶意文件。`CVE-2023-4220.py` 脚本通过 `requests` 库向目标 URL 的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送 POST 请求，上传名为 `bigUploadFile` 的文件。上传成功后，脚本会尝试访问上传的文件，如果返回状态码为 200，则表示利用成功。`Reverse-shell.php` 文件包含一个 PHP 反向 Shell 脚本，用于在服务器上执行任意命令。

**投毒风险：** 提供的 PoC 代码主要用于验证漏洞的存在，并通过上传反向 Shell 来获取远程代码执行权限。`Reverse-shell.php` 脚本本身可以被认为是具有恶意功能的后门代码，但从仓库代码整体来看，并没有发现明显的投毒行为。投毒的概率较低，估计为10%。需要关注点在于，下载此PoC的用户如果直接使用或者修改reverse shell脚本，可能会不小心引入其他的恶意代码，但这不是原作者的投毒意图。

**利用方式：**

1.  攻击者构造一个包含恶意代码的 Web Shell 文件（例如 `Reverse-shell.php`）。
2.  攻击者使用 PoC 脚本（例如 `CVE-2023-4220.py`）向目标 Chamilo LMS 实例的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送 POST 请求，上传 Web Shell 文件。
3.  如果上传成功，攻击者可以通过访问上传的 Web Shell 文件来执行任意命令。
4.  利用 `Reverse-shell.php`，攻击者可以获得服务器的反向 Shell，从而完全控制服务器。

**项目地址:** [numaan911098/CVE-2023-4220](https://github.com/numaan911098/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #22

**来源**: [CVE-2023-4220-oxapavan_CVE-2023-4220-HTB-PermX.md](../2023/CVE-2023-4220-oxapavan_CVE-2023-4220-HTB-PermX.md)

## CVE-2023-4220-Chamilo LMS Unauthenticated RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传导致远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制，数据泄露，安装勒索软件

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，且能够通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个关键漏洞，攻击者可以通过未经身份验证的文件上传功能（`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`）上传恶意文件（如 webshell）。

**漏洞利用方式：**

1.  攻击者使用提供的 PoC 脚本（`CVE-2023-4220.sh`或`script.sh`）进行利用。
2.  脚本通过 curl 命令将恶意文件（reverse shell）上传到 `/main/inc/lib/javascript/bigupload/files/` 目录。
3.  脚本然后尝试访问上传的文件，从而执行恶意代码。
4.  脚本还尝试使用`nc`命令监听目标端口，用于接收反向 shell 连接。

**有效性：**

根据漏洞描述和 PoC 代码，该漏洞利用是有效的。多个搜索结果表明该漏洞允许未经身份验证的远程代码执行。

**投毒风险分析：**

分析提供的 PoC 代码，没有发现明显的投毒代码。脚本的功能是上传文件并尝试触发执行，没有发现恶意修改目标系统或进行其他未声明操作的代码。代码主要通过curl和netcat进行远程利用，没有发现可疑行为，故判定投毒风险为0%。

**项目地址:** [oxapavan/CVE-2023-4220-HTB-PermX](https://github.com/oxapavan/CVE-2023-4220-HTB-PermX)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #23

**来源**: [CVE-2023-4220-qrxnz_CVE-2023-4220.md](../2023/CVE-2023-4220-qrxnz_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo LMS-未授权文件上传导致RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致远程代码执行和存储型XSS

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS，且版本小于等于1.11.24，需要网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220是Chamilo LMS 1.11.24及更早版本中存在的一个高危漏洞。该漏洞位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件中，允许未经身份验证的攻击者通过`big file upload`功能上传任意文件。由于未对上传的文件类型进行充分验证，攻击者可以上传包含恶意代码的Web Shell，从而执行存储型跨站脚本攻击(XSS)或实现远程代码执行(RCE)。

**有效性：** 根据搜索结果和漏洞描述，该漏洞的PoC是存在的，并且可以实现RCE。根据搜索结果，GitHub上已经有公开的PoC代码（https://github.com/VanishedPeople/CVE-2023-4220），证明漏洞的可利用性。

**投毒风险：** 提供的漏洞利用代码`/tmp/10c4d756f57f88eae973d9e10fafe40c/README.md` 非常简单，只是一个包含CVE编号的说明文件，恶意代码不太可能存在于此文件本身。 但是，由于该漏洞是关于文件上传，而提供的代码只是一个README文件，需要进一步查找其他文件，才能确定投毒风险。结合搜索结果中提供的POC链接，假设该PoC仓库包含其他文件，例如用于上传的脚本或webshell，则在这些脚本中可能存在作者隐藏的恶意代码，例如反向shell、信息收集或其他恶意功能。因此，存在一定投毒的风险，估计为10%，主要是考虑到需要进一步分析完整的POC代码才能做出准确判断，目前只看到了README文件。

**利用方式：**
1.  攻击者无需身份验证，可以直接访问`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。
2.  利用`big file upload`功能上传恶意文件，例如包含PHP代码的Web Shell。
3.  由于未充分验证文件类型，恶意文件会被服务器接受并存储。
4.  攻击者可以通过访问上传的Web Shell来执行任意PHP代码，从而控制服务器。
5.  攻击者还可以利用上传的Web Shell执行存储型XSS攻击，影响其他用户。


**项目地址:** [qrxnz/CVE-2023-4220](https://github.com/qrxnz/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #24

**来源**: [CVE-2023-4220-thefizzyfish_CVE-2023-4220_Chamilo_RCE.md](../2023/CVE-2023-4220-thefizzyfish_CVE-2023-4220_Chamilo_RCE.md)

## CVE-2023-4220 - Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以上传WebShell，从而完全控制服务器，窃取机密信息，安装勒索软件

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行 Chamilo LMS 且版本低于或等于 1.11.24，并且未进行漏洞修复

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS 的 bigUpload.php 文件中，允许未经身份验证的攻击者上传恶意文件（WebShell），从而实现远程代码执行。POC 代码通过构造包含恶意 PHP 代码的文件，并利用 bigUpload 功能上传该文件。上传成功后，攻击者可以通过访问该文件来执行任意命令。代码中存在轻微的投毒风险，因为攻击者可能会修改上传的文件内容，例如，在 WebShell 中加入恶意代码，用于收集用户信息或者进行其他恶意活动。但仓库中LICENSE文件是标准的MIT协议,文件结构简单,基本可以排除作者投毒风险,该风险主要存在于使用者,如果使用者修改了代码，那投毒风险会提升。

**利用方式：**
1.  攻击者利用未经身份验证的文件上传漏洞，将包含恶意 PHP 代码的 Webshell 文件上传到 `/main/inc/lib/javascript/bigupload/files/` 目录下。
2.  攻击者通过构造特定的 URL 请求，访问上传的 Webshell 文件，并传递要执行的命令。
3.  服务器执行 Webshell 中的 PHP 代码，从而执行攻击者指定的命令。
4.  攻击者利用执行的命令获取服务器的控制权，例如，反弹 Shell。

**POC 代码分析：**
*   `CVE-2023-4220.py`: 该 Python 脚本实现了漏洞利用的自动化，它首先构造包含反弹 Shell 代码的 Webshell 文件，然后将其上传到目标服务器，最后通过发送 GET 请求触发 Webshell 的执行。
*   `README.md`: 包含漏洞的简要描述和利用方法。
*   `LICENSE`: 使用 MIT 许可证。

**项目地址:** [thefizzyfish/CVE-2023-4220_Chamilo_RCE](https://github.com/thefizzyfish/CVE-2023-4220_Chamilo_RCE)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #25

**来源**: [CVE-2023-4220-zora-beep_CVE-2023-4220.md](../2023/CVE-2023-4220-zora-beep_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全被控制

**影响版本:** <= 1.11.24

**利用条件:** 需要目标服务器运行Chamilo LMS，且版本在受影响范围内。攻击者需要能够通过网络访问目标服务器的`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个未授权文件上传漏洞，位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中。未经身份验证的攻击者可以通过上传恶意文件（如 webshell）来执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** `bigUpload.php` 文件处理大文件上传功能时，未对上传的文件类型进行严格的验证，允许上传具有危险类型的文件，如 PHP 文件。
2.  **利用步骤：**
    *   攻击者使用提供的 `exploit.py` 脚本，指定目标 Chamilo LMS 实例的 URL 和要上传的 webshell 文件。
    *   脚本将 webshell 文件通过 POST 请求发送到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 路径。
    *   如果上传成功，攻击者可以通过访问上传的 webshell 文件来执行任意代码。

3.  **有效性分析：** 根据漏洞描述和搜索引擎结果，该漏洞的 POC 代码是有效的，可以实现远程代码执行。

4.  **投毒风险分析：**
    *   `exploit.py` 脚本是一个简单的文件上传脚本，主要功能是发送 POST 请求，上传指定的文件到目标 URL。代码本身没有发现任何可疑或恶意的行为。
    *   `README.md` 文件仅包含脚本的使用说明，没有包含任何可执行代码或恶意链接。
    *   因此，该仓库中存在投毒代码的可能性较低，可以判断投毒风险为0%。

5.  **利用方式总结：**
    *   **目标：** Chamilo LMS <= 1.11.24
    *   **漏洞：** 未授权文件上传 (CVE-2023-4220)
    *   **攻击方式：** 使用 `exploit.py` 脚本上传 webshell 到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`，然后访问 webshell 执行任意代码。

**项目地址:** [zora-beep/CVE-2023-4220](https://github.com/zora-beep/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---



---

## POC #5

**来源**: [CVE-2023-4220-H4cking4All_CVE-2023-4220.md](../2023/CVE-2023-4220-H4cking4All_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** Chamilo LMS 实例需要运行在易受攻击的版本上，并且需要能够通过网络访问 vulnerable_url

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS <= 1.11.24 的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中，是一个未授权的文件上传漏洞。

**有效性:**

根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判定该漏洞利用代码是有效的。漏洞库信息明确指出该漏洞允许未经身份验证的攻击者上传 webshell 并执行远程代码。搜索引擎结果中也提到了这一点，并给出了PoC链接。漏洞利用代码 `exploit.py` 实现了漏洞利用的完整流程，包括：

1.  **检查目标 URL 是否易受攻击:**  `checkVuln` 函数通过检查 `/main/inc/lib/javascript/bigupload/files` 目录的可访问性来判断目标是否存在漏洞。
2.  **上传 webshell:**  `exploitVuln` 函数通过 POST 请求将包含恶意 PHP 代码 (webshell) 的文件上传到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，服务器会将文件存储在 `/main/inc/lib/javascript/bigupload/files` 目录下。
3.  **执行命令:** 漏洞利用代码通过访问上传的 webshell，利用 GET 参数 `cmd` 执行任意系统命令。
4.  **反弹shell:** 通过webshell执行bash反弹shell命令,获取服务器控制权.

**投毒风险:**

对提供的 `exploit.py` 代码进行分析，发现存在轻微的投毒风险。风险主要来自于以下几点：

*   **硬编码代理:** 代码中存在 `proxy = {'http': 'http://localhost:8080/'}`。如果用户没有注意到这一行，并且本地没有运行代理服务，可能会导致漏洞利用失败，并泄露目标URL。这是一个潜在的流量劫持点，虽然不太可能是有意的投毒，但仍存在一定风险。
*   **输入webshell文件名:** 漏洞利用代码允许用户自定义webshell的文件名,如果用户设置恶意文件名,可能会影响后续利用.
*   **Reverse Shell IP 和端口:** 脚本要求用户输入攻击者的 IP 地址和端口。如果攻击者没有正确配置监听器，则反弹 shell 将无法建立连接。

虽然存在上述风险，但这些风险更偏向于可用性问题，而不是恶意代码。漏洞利用的整体逻辑是清晰的，旨在利用漏洞，而不是进行恶意活动，因此投毒风险较低，估计在 10% 左右。

**利用方式:**

1.  **确定目标 Chamilo LMS 版本:**  确认目标 Chamilo LMS 实例的版本小于等于 1.11.24。
2.  **运行 `exploit.py`:**  使用 Python 运行 `exploit.py` 脚本，并提供目标 Chamilo LMS 的 URL 作为参数，选择 `exploit` 模式。
3.  **输入 webshell 文件名：** 输入希望使用的 webshell 文件名（不包含扩展名）。
4.  **设置反弹 shell 信息:**  输入攻击者的 IP 地址和端口，确保攻击者机器上已经启动了 netcat 监听器。
5.  **获取 shell:**  如果漏洞利用成功，攻击者将会在 netcat 监听器上获得一个反弹 shell，从而控制目标服务器。

**项目地址:** [H4cking4All/CVE-2023-4220](https://github.com/H4cking4All/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #6

**来源**: [CVE-2023-4220-HO4XXX_cve-2023-4220-poc.md](../2023/CVE-2023-4220-HO4XXX_cve-2023-4220-poc.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传导致远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未授权攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS <= 1.11.24，并且可以网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Chamilo LMS的bigupload功能中。攻击者可以通过未授权的文件上传，将恶意webshell上传到服务器，然后通过访问webshell执行任意代码。

**有效性评估：**
根据漏洞描述和搜索结果，该漏洞是真实存在的，且危害严重。提供的PoC代码基本完整，能够实现未经身份验证的webshell上传和命令执行。PoC通过发送multipart/form-data请求，上传包含PHP代码的文件到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`处理，然后通过访问上传的文件触发webshell执行。

**投毒风险评估：**
PoC代码主要功能是上传webshell和执行命令，检查了`poc.py`脚本，发现存在一定的投毒风险。风险点包括：

1.  **revshell代码：** PoC中包含上传反向shell的代码，如果攻击者不小心或者不理解代码，直接运行，可能会在自己的机器上打开端口，等待被连接，增加了风险。
2.  **URL参数：** PoC需要指定目标URL，如果攻击者不小心将URL指向自己的机器，可能会将webshell上传到自己的服务器上。
3.  **文件名：** PoC可以自定义上传的文件名，如果攻击者使用一些敏感的文件名，可能会引起管理员的注意。

总体来说，PoC代码本身投毒的概率较低，但使用不当可能会带来一定的安全风险。因此，需要在使用PoC代码时，仔细阅读代码，理解代码的逻辑，并采取必要的安全措施。

**漏洞利用方式：**
1.  攻击者利用未授权文件上传漏洞，上传webshell（例如PHP脚本）到Chamilo LMS服务器。
2.  攻击者通过构造特定的URL，访问上传的webshell，触发webshell执行。
3.  Webshell执行后，攻击者可以在服务器上执行任意代码，例如窃取数据、篡改网站内容、控制服务器等。

**缓解措施：**
1.  升级Chamilo LMS到最新版本，修复此漏洞。
2.  限制上传文件类型，禁止上传PHP等可执行文件。
3.  加强服务器安全配置，防止webshell执行。

**项目地址:** [HO4XXX/cve-2023-4220-poc](https://github.com/HO4XXX/cve-2023-4220-poc)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #7

**来源**: [CVE-2023-4220-LGenAgul_CVE-2023-4220-Proof-of-concept.md](../2023/CVE-2023-4220-LGenAgul_CVE-2023-4220-Proof-of-concept.md)

## CVE-2023-4220-Chamilo LMS-远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制，包括信息窃取、安装勒索软件等

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS <= 1.11.24，且`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件存在且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220是Chamilo LMS中一个未经验证的任意文件上传漏洞，位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`的“大文件上传”功能中。攻击者无需身份验证即可上传恶意文件（例如，PHP webshell），从而实现存储型跨站脚本攻击 (XSS) 和远程代码执行 (RCE)。

**利用方式：**

1.  **上传恶意文件：** 攻击者使用POST请求将包含恶意代码（如PHP反向shell）的webshell文件上传到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`。该漏洞允许上传任意类型的文件，绕过了文件类型检查。
2.  **触发恶意代码执行：** 成功上传后，攻击者通过访问上传的文件（例如：`/main/inc/lib/javascript/bigupload/files/cmd.php?ip=<攻击者IP>&port=<攻击者端口>`）来触发webshell的执行。这将导致服务器执行攻击者上传的恶意代码。
3.  **获取反向Shell：** 攻击者需要提前在攻击机上监听指定的端口（例如，使用`nc -lvnp <端口>`）。当webshell执行时，它会尝试连接攻击者的IP地址和端口，从而建立一个反向shell连接，使攻击者能够远程控制受害服务器。

**POC有效性评估：**

提供的PoC代码（`exploit.py`）实现了上述利用过程。它首先创建一个包含反向shell代码的PHP文件（`cmd.php`），然后将其上传到存在漏洞的服务器，并通过HTTP GET请求触发该文件的执行。PoC代码还包含启动netcat监听器的功能，用于接收反向shell连接。根据搜索结果和漏洞描述，此PoC代码被认为是有效的。

**投毒风险评估：**

虽然该代码的主要目的是利用漏洞获取反向shell，但仍然存在一定的投毒风险。该脚本执行后，会在目标系统上写入webshell文件，并且通过HTTP请求访问该webshell。理论上，作者可能在shell代码中插入额外的恶意代码，例如，用于收集系统信息、植入后门或进行其他恶意活动。此外，上传webshell本身就存在一定风险，因为webshell可能被其他攻击者利用。由于该脚本来自非官方渠道，并且webshell本身就具有潜在的风险，因此投毒的可能性评估为10%。

**项目地址:** [LGenAgul/CVE-2023-4220-Proof-of-concept](https://github.com/LGenAgul/CVE-2023-4220-Proof-of-concept)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #8

**来源**: [CVE-2023-4220-MikeyPPPPPPPP_CVE-2023-4220.md](../2023/CVE-2023-4220-MikeyPPPPPPPP_CVE-2023-4220.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 文件上传漏洞

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行和跨站脚本攻击

**影响版本:** <= 1.11.24

**利用条件:** 目标Chamilo LMS实例运行在受影响的版本上，且`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS 的大文件上传功能中，攻击者可以通过上传恶意文件，例如 webshell，从而实现远程代码执行。由于该漏洞无需身份验证，因此任何未经授权的攻击者都可能利用此漏洞。 

**漏洞利用方式：**

1.  攻击者向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送包含恶意 webshell 的上传请求。
2.  由于文件上传功能存在漏洞，恶意文件成功上传到服务器的 `/main/inc/lib/javascript/bigupload/files/` 目录。
3.  攻击者通过访问上传的 webshell，执行任意代码。

**POC代码分析：**

POC 代码 `CVE-2023-4220.py`  实现了漏洞的利用。代码首先检查目标是否存在漏洞利用所需的目录，然后上传包含PHP代码的 webshell。上传成功后，该脚本提供了一个交互式 shell，攻击者可以使用它在服务器上执行命令。该脚本还尝试通过 Tor 网络进行连接，并进行 User-Agent 伪装，以增加攻击的隐蔽性。 命令输入和输出被记录到 `command.log` 文件中。

**投毒风险分析：**

虽然 POC 代码的核心功能是漏洞利用，但存在轻微的投毒风险。风险点主要在于 `command.log` 文件。 虽然日志本身不是恶意的，但它会记录攻击者执行的所有命令，这些信息在某些情况下可能会被滥用或者泄露敏感信息。 此外，代码强制通过Tor代理, 也有可能被用于恶意目的。因此，投毒风险评估为10%。该评估是基于作者在其他地方增加恶意代码，如反向shell或数据窃取的可能性。没有直接证据表明存在恶意代码，但增加Tor代理使用的这种行为本身会引起警惕。

**项目地址:** [MikeyPPPPPPPP/CVE-2023-4220](https://github.com/MikeyPPPPPPPP/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #9

**来源**: [CVE-2023-4220-N1ghtfallXxX_CVE-2023-4220.md](../2023/CVE-2023-4220-N1ghtfallXxX_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo LMS-远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可完全控制服务器

**影响版本:** <= 1.11.24

**利用条件:** 需要网络访问，Chamilo LMS版本小于等于1.11.24

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个未授权的任意文件上传漏洞。攻击者可以通过向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送恶意请求，上传包含恶意代码的 PHP 文件，从而实现远程代码执行。

**有效性：**

根据搜索引擎结果和漏洞利用代码，该漏洞的利用是有效的。存在公开可用的 PoC 代码，可以验证该漏洞的存在并实现远程代码执行。搜索结果中也提到了远程代码执行的风险。

**投毒风险：**

提供的漏洞利用代码包含两个文件：`README.md` 和 `chamilo-rce.py`。
*   `README.md`: 包含漏洞描述、利用方法和免责声明，没有发现恶意代码。
*   `chamilo-rce.py`: 是一个 Python 脚本，用于生成包含反向 shell 的 PHP payload，并将其上传到目标服务器。脚本会根据用户输入的 IP 地址和端口，生成反向 shell 代码，并保存为 `rce.php` 文件。然后，脚本会构造一个 HTTP 请求，将 `rce.php` 文件上传到存在漏洞的 Chamilo LMS 实例。

虽然该脚本本身旨在利用漏洞，但它允许用户自定义反向 shell 的 IP 地址和端口。 因此，虽然利用本身是恶意的，但脚本本身并没有被投毒。只有非常轻微的投毒风险，例如在代码中引入细微的错误或依赖项，使得Payload失效，或者导致目标系统不稳定。但此几率极低。

**利用方式：**

1.  攻击者克隆包含PoC的git仓库 `https://github.com/N1ghtfallXxX/CVE-2023-4220` 
2.  攻击者通过 `chamilo-rce.py` 脚本生成包含恶意 PHP 代码的文件（Web Shell）。
3.  利用漏洞，未经验证上传恶意 PHP 文件。
4.  通过访问上传的 PHP 文件，执行其中的恶意代码，从而获得服务器的控制权。
5.  通过反弹shell连接攻击者本地监听端口,获得服务器shell

**项目地址:** [N1ghtfallXxX/CVE-2023-4220](https://github.com/N1ghtfallXxX/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #10

**来源**: [CVE-2023-4220-Pr1or95_CVE-2023-4220-exploit.md](../2023/CVE-2023-4220-Pr1or95_CVE-2023-4220-exploit.md)

## CVE-2023-4220-Chamilo LMS 未授权文件上传导致RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传/远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全被控制，数据泄露，安装勒索软件等

**影响版本:** <= 1.11.24

**利用条件:** 需要目标Chamilo LMS实例可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS <= 1.11.24 的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中，这是一个未经身份验证的大文件上传接口。攻击者可以通过该接口上传恶意webshell文件，从而获得服务器的远程代码执行权限。

**有效性:**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以判断该PoC代码有效。漏洞库信息明确指出该漏洞允许未经身份验证的攻击者上传webshell并执行任意代码。搜索引擎结果中也包含多个关于该漏洞的描述，并指出可以远程控制服务器。提供的PoC代码包含一个 bash 脚本 (CVE-2023-4220.sh)，该脚本自动化了webshell的上传和访问过程，验证了漏洞的可利用性。

**利用方式:**

1.  攻击者执行PoC脚本，指定webshell文件路径、目标Chamilo LMS的URL以及监听端口。
2.  脚本使用curl命令上传webshell到目标服务器的 `/main/inc/lib/javascript/bigupload/files/` 目录下。
3.  脚本尝试访问上传的webshell文件，并使用 `nc` 命令在指定端口上启动监听。
4.  成功访问webshell后，攻击者即可通过监听端口与webshell进行交互，从而执行任意系统命令。

**投毒风险:**

提供的PoC代码主要包含一个bash脚本和一个README文件。通过分析bash脚本的内容，可以发现脚本主要功能是上传文件，访问文件和启动一个网络监听。脚本本身没有明显的恶意代码，但是存在以下潜在的投毒风险：

1.  **依赖的webshell文件:** webshell文件本身可能包含恶意代码，例如反弹shell，下载并执行其他恶意程序等。但是，webshell的内容不由PoC作者控制，因此不应算作PoC本身的投毒。
2.  **README文件:** README文件用于说明PoC的使用方法，通常不会包含恶意代码。
3.  **sleep 时间:** 脚本中`sleep 3`指令可能会被恶意修改,增加sleep时间或者消耗服务器资源的操作,实现隐蔽的拒绝服务攻击.

综上所述，PoC代码本身存在投毒的可能性较低，大概为10%，主要的风险来自于攻击者使用的webshell文件。

**项目地址:** [Pr1or95/CVE-2023-4220-exploit](https://github.com/Pr1or95/CVE-2023-4220-exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #11

**来源**: [CVE-2023-4220-VanishedPeople_CVE-2023-4220.md](../2023/CVE-2023-4220-VanishedPeople_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 1.11.24

**利用条件:** 需要目标系统运行Chamilo LMS <= 1.11.24，并且攻击者可以访问到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个未授权的文件上传漏洞，存在于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中大文件上传功能处。攻击者可以利用此漏洞上传恶意 WebShell，从而获得服务器的远程代码执行权限。由于漏洞利用不需要身份验证，风险极高。

**有效性：**
根据提供的漏洞库信息、搜索结果和漏洞利用代码（尽管仅提供了许可证文件），可以判断该漏洞利用的有效性较高。 漏洞库信息明确指出该漏洞会导致远程代码执行，搜索结果也确认了这一点，并提供了相关的 PoC 链接 (https://github.com/VanishedPeople/CVE-2023-4220 )。

**投毒风险：**
提供的代码段是 Apache 2.0 许可证，本身不包含任何恶意代码。 因为只提供了license文件，无法评估其他代码文件是否包含后门, 考虑到poc的贡献者，以及该漏洞的细节，可以认为投毒的可能性较低。

**利用方式：**
1.  攻击者构造一个恶意的 WebShell 文件，例如 PHP 文件。
2.  利用 Chamilo LMS 中 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 的大文件上传功能，将恶意 WebShell 文件上传到服务器。
3.  通过访问上传的 WebShell 文件，执行任意代码，从而控制服务器。

由于上传过程未进行严格的文件类型检查或大小限制，攻击者可以绕过安全机制，成功上传恶意文件。


**项目地址:** [VanishedPeople/CVE-2023-4220](https://github.com/VanishedPeople/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #12

**来源**: [CVE-2023-4220-Ziad-Sakr_Chamilo-CVE-2023-4220-Exploit.md](../2023/CVE-2023-4220-Ziad-Sakr_Chamilo-CVE-2023-4220-Exploit.md)

## CVE-2023-4220 Chamilo LMS 远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行和服务器完全控制

**影响版本:** <= 1.11.24

**利用条件:** Chamilo LMS <= 1.11.24，目标服务器可访问，`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径存在且可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 漏洞存在于Chamilo LMS的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中，允许未经身份验证的攻击者通过上传恶意文件（例如webshell）来执行任意代码。该漏洞利用了 Chamilo LMS 大文件上传功能中的一个缺陷，攻击者通过构造特定的请求，将恶意文件上传到 `/main/inc/lib/javascript/bigupload/files/` 目录。上传的文件可以被直接访问并执行，导致远程代码执行。

**有效性：**

提供的POC代码通过 curl 命令模拟文件上传，指定了上传的文件路径、目标URL和执行reverse shell的端口。基本逻辑符合漏洞描述，利用步骤清晰，可以有效利用该漏洞。

**投毒风险：**

代码本身主要是通过curl上传文件，以及使用nc监听端口，看起来比较直接。但是，有几点需要关注：

1.  `reverse_file` 是用户可控的，这意味着如果用户不小心使用了包含恶意代码的文件作为 `reverse_file`，可能会引入投毒。
2.  脚本中提供了一段提示用户进行TTY交互的命令，这段命令本身没有恶意，但如果攻击者替换了其中的`/bin/bash`为其他恶意程序，可能会导致投毒。
3.  脚本执行后会启动一个`nc`监听进程，恶意用户可以连接到此端口执行命令，进行恶意操作。

综上，投毒风险较低，约为10%， 主要来自用户使用的 reverse shell 文件本身可能存在恶意代码。

**利用方式：**

1.  准备一个包含反弹shell代码的webshell文件（reverse_file）。
2.  使用提供的脚本 `CVE-2023-4220.sh`，通过 `-f` 参数指定 webshell 文件的路径，`-h` 参数指定 Chamilo LMS 的主机地址，`-p` 参数指定反弹 shell 的端口。
3.  脚本会使用 curl 命令将webshell上传到Chamilo LMS服务器的指定目录。
4.  脚本启动 nc 监听指定的端口。
5.  通过访问上传的 webshell 文件，触发反弹 shell，攻击者即可获得目标服务器的控制权。

**防范措施：**

1.  升级 Chamilo LMS 到最新版本。
2.  限制上传文件类型，对上传的文件进行安全检查。
3.  加强服务器安全配置，防止恶意代码执行。

**项目地址:** [Ziad-Sakr/Chamilo-CVE-2023-4220-Exploit](https://github.com/Ziad-Sakr/Chamilo-CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #13

**来源**: [CVE-2023-4220-bueno-armando_CVE-2023-4220-RCE.md](../2023/CVE-2023-4220-bueno-armando_CVE-2023-4220-RCE.md)

## CVE-2023-4220-Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** Chamilo LMS服务器可公开访问，且目标版本小于等于1.11.24

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220是Chamilo LMS中存在的一个未经身份验证的远程代码执行漏洞。该漏洞位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件中的大文件上传功能中。攻击者可以通过上传恶意PHP文件（webshell）来执行任意代码。 

**漏洞利用方式：**

1.  攻击者使用`curl`命令上传包含恶意代码的PHP文件到目标服务器的`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，利用大文件上传功能绕过身份验证。
2.  上传成功后，webshell存储在`/main/inc/lib/javascript/bigupload/files/`目录下，文件名为`rce.php`。
3.  攻击者通过`curl`命令访问上传的webshell(`/main/inc/lib/javascript/bigupload/files/rce.php`)，触发webshell中的恶意代码，实现远程代码执行。

**POC代码分析：**

提供的POC代码是一个Python脚本，它执行以下操作：

1.  接收目标URL、端口、命令和可选的反向shell参数。
2.  如果提供了命令，则对其进行Base64编码，然后将其包装在PHP代码中，以便通过`system()`函数执行。
3.  如果未提供命令，则构建一个反向shell命令，使用攻击者的IP地址和端口。
4.  将生成的PHP代码保存到`rce.php`文件中。
5.  使用`curl`命令将`rce.php`上传到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`。
6.  使用`curl`命令访问上传的`rce.php`，执行恶意代码。

**有效性评估：**

根据漏洞描述、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码能够成功上传并执行webshell，从而实现远程代码执行。

**投毒风险分析：**

对POC代码进行分析后，发现存在一定的投毒风险，概率为10%。主要体现在以下方面：

*   脚本直接使用`os.system()`函数执行外部命令，这可能允许攻击者在目标系统上执行任意命令。虽然脚本主要执行curl命令，理论上只涉及上传文件和访问文件，如果攻击者修改了上传文件或者篡改了访问的url, 导致执行系统命令，也存在被植入恶意后门的风险。

总体来说，该POC的投毒风险较低，因为脚本的功能比较明确，恶意行为不容易被隐藏。用户在使用时应仔细检查代码，确保没有被篡改。

**项目地址:** [bueno-armando/CVE-2023-4220-RCE](https://github.com/bueno-armando/CVE-2023-4220-RCE)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #14

**来源**: [CVE-2023-4220-charchit-subedi_chamilo-lms-unauthenticated-rce-poc.md](../2023/CVE-2023-4220-charchit-subedi_chamilo-lms-unauthenticated-rce-poc.md)

## CVE-2023-4220-Chamilo-Unauthenticated-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** RCE

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以通过上传webshell获得远程代码执行权限

**影响版本:** <= 1.11.24

**利用条件:** 需要目标Chamilo LMS实例存在，且版本小于等于1.11.24，并可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220是Chamilo LMS中的一个未经验证的文件上传漏洞，位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。未经身份验证的攻击者可以利用此漏洞上传恶意文件（webshell），从而执行任意代码。漏洞利用方式如下：

1.  **漏洞验证:** 通过访问`/main/inc/lib/javascript/bigupload/files/` 确认目录存在，验证目标是否存在漏洞。
2.  **webshell上传:** 使用POST请求向`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 上传包含PHP代码的恶意文件，文件名为`bigUploadFile`，文件内容为webshell。
3.  **代码执行:** 通过访问`{self.check_url}{filename}?cmd={command}` 执行webshell中的指令

根据提供的POC代码，漏洞利用代码有效。`exploit.py`文件包含`ChamiloBigUploadExploit`类，其中包含了验证漏洞、上传webshell和执行反向shell的方法。

投毒风险评估：

代码中存在动态构建和执行命令的部分，例如在`send_and_execute_revshell`函数中，存在编码绕过，创建bash反弹shell脚本并通过GET参数`cmd`执行。理论上，攻击者可以在`webshell_content`变量中注入恶意代码，或者在`send_and_execute_revshell`函数构建恶意命令。

查看仓库的`README.md`文件,作者要求使用 `pip install -r requirements.txt` 安装依赖包,需要检查`requirements.txt`内容。

在当前提供的代码片段中，没有发现明显的恶意代码。判断仓库中存在的投毒代码可能性为5%，需要进一步对依赖包进行检查。

利用方式总结：

1.  扫描目标以确认漏洞是否存在。
2.  上传webshell。
3.  （可选）上传和执行反向shell，或者直接使用webshell执行任意命令。

**项目地址:** [charchit-subedi/chamilo-lms-unauthenticated-rce-poc](https://github.com/charchit-subedi/chamilo-lms-unauthenticated-rce-poc)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #15

**来源**: [CVE-2023-4220-charlesgargasson_CVE-2023-4220.md](../2023/CVE-2023-4220-charlesgargasson_CVE-2023-4220.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经验证的攻击者执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，并且bigUpload功能未被禁用或修复。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 存在于Chamilo LMS的bigUpload功能中，允许未经身份验证的攻击者通过上传恶意文件（如webshell）来执行远程代码。漏洞位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。根据提供的漏洞利用代码，攻击者首先上传一个包含恶意PHP代码的文件（通常是webshell），然后通过构造特定的URL来访问该文件，从而执行webshell中的代码。

**有效性：**
从搜索结果和漏洞利用代码来看，该漏洞利用是有效的。漏洞库信息和多个搜索结果都表明该漏洞允许未经身份验证的远程代码执行。漏洞利用代码提供了一个简单的PoC，演示了如何上传PHP webshell并执行任意命令。

**投毒风险：**
提供的漏洞利用代码本身**不包含明显的投毒代码**。该代码的目的是上传webshell和执行命令。它首先创建一个名为`/tmp/rce.php`的临时文件，其中包含PHP代码来执行base64编码的命令。然后，使用`curl`命令上传这个文件到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，并使用另一个`curl`命令，通过URL参数`aoOoy`将要执行的命令以base64编码的形式传递给webshell。虽然执行任意命令本身存在安全风险，但是这段代码的主要目的是为了验证漏洞，并没有包含任何用于破坏系统或窃取信息的恶意逻辑。因此，投毒风险评估为0%。

**利用方式：**
1.  **确定目标Chamilo LMS的版本**：可以通过访问`/documentation/changelog.html`来确定版本。
2.  **构造恶意PHP文件（webshell）**：创建一个包含PHP代码的webshell，例如，允许执行任意命令的PHP脚本。
3.  **上传webshell**：使用`curl`命令或其他HTTP客户端，将webshell上传到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`。
4.  **执行命令**：使用`curl`或其他HTTP客户端，构造一个包含要执行的命令的URL，并访问上传的webshell。命令需要进行base64编码和URL编码。

该漏洞利用无需身份验证，攻击复杂度较高（需要了解目标系统的文件路径和URL结构），但影响是严重的，可能导致完全控制目标系统。

**项目地址:** [charlesgargasson/CVE-2023-4220](https://github.com/charlesgargasson/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #16

**来源**: [CVE-2023-4220-dollarboysushil_Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220.md](../2023/CVE-2023-4220-dollarboysushil_Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220.md)

## CVE-2023-4220 - Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传/远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者上传webshell并执行任意代码。

**影响版本:** <= 1.11.24

**利用条件:** 目标Chamilo LMS实例的`/main/inc/lib/javascript/bigupload/files`目录存在且Web服务器对该目录具有写入权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个严重的安全漏洞，影响版本小于等于 1.11.24。此漏洞位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中，允许未经身份验证的攻击者上传任意文件，包括恶意的 webshell。攻击者可以通过简单的 curl 命令上传 php 文件到 `/main/inc/lib/javascript/bigupload/files` 目录。上传后，攻击者可以通过访问该文件执行任意代码。 

**有效性：**  根据提供的POC代码和搜索结果，此漏洞利用是有效的。POC展示了如何使用 curl 命令上传包含恶意代码的 PHP 文件，并通过访问上传的文件来执行代码。搜索结果中也有很多链接提到了利用此漏洞进行远程代码执行的可能性。

**投毒风险：** 查看提供的漏洞利用代码，主要是演示了如何上传和执行一个简单的 `whoami` 命令的webshell。虽然直接的后门代码没有，但是需要考虑到，如果攻击者将此POC集成到自动化攻击脚本中，大规模利用，则会造成严重危害。 仓库中可能存在的投毒风险大约为10%。这个风险来自于以下可能性：
   * 仓库本身可能包含不明显的恶意代码，旨在在使用者部署或运行漏洞利用时执行其他恶意操作。例如，上传的webshell可能包含更复杂的功能，允许攻击者远程控制受害者服务器。 
   * 该漏洞利用可能会被修改以包含后门，然后重新分发。虽然原始POC可能没有恶意代码，但修改后的版本可能会包含。

**利用方式：** 

1.  **确定目标：**  找到运行 Chamilo LMS 1.11.24 或更早版本的系统。
2.  **上传 Webshell：**  使用 curl 或类似的工具，通过向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 发送包含恶意 PHP 代码的文件来上传 webshell。  文件名为webshell文件名，例如`dollarboysushil.php`。
3.  **执行代码：**  通过访问上传的 webshell 文件，例如 `http://<website>/main/inc/lib/javascript/bigupload/files/dollarboysushil.php`，来执行任意代码。 请先确认`/main/inc/lib/javascript/bigupload/files`路径存在。

总而言之，CVE-2023-4220 是一个严重的漏洞，利用简单，影响广泛。应该立即修补受影响的 Chamilo LMS 实例。即使是看起来无害的PoC代码，也需要进行安全审查后使用。

**项目地址:** [dollarboysushil/Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220](https://github.com/dollarboysushil/Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #17

**来源**: [CVE-2023-4220-gmh5225_CVE-2023-4220.md](../2023/CVE-2023-4220-gmh5225_CVE-2023-4220.md)

## CVE-2023-4220 - Chamilo LMS 未授权文件上传导致远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以上传WebShell，最终导致远程代码执行

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行着Chamilo LMS <= 1.11.24，且攻击者可以访问该系统的网络端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 存在于Chamilo LMS的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中。该文件存在未授权的文件上传漏洞，允许未经身份验证的攻击者上传任意文件，包括WebShell。 

**利用方式：**

1.  攻击者通过发送POST请求到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`，上传一个包含恶意代码的PHP文件（WebShell），文件名可以为任意值。
2.  上传的文件会被保存在 `/main/inc/lib/javascript/bigupload/files/` 目录下。
3.  攻击者通过访问 `/main/inc/lib/javascript/bigupload/files/{webshell_name}.php` 执行上传的WebShell，从而实现远程代码执行。

提供的POC代码（exploit.py）自动化了这一过程，首先检查目标是否存在漏洞，然后上传一个简单的WebShell (insomnia.php)，允许攻击者执行任意命令。 

**有效性：**

根据漏洞库信息、搜索引擎结果和漏洞利用代码，该POC代码是有效的，可以成功利用该漏洞实现远程代码执行。 搜索结果中的pentest-tools.com的描述和github上的POC都确认了漏洞的存在和利用方式。

**投毒风险：**

查看了POC代码，该代码主要功能是上传webshell，并无发现恶意投毒代码，代码有域名作者信息。但是仍然需要谨慎，因为上传的WebShell本身就是恶意代码，攻击者可以通过WebShell执行任何操作。我假设存在5%的风险, 代码库维护者或者代码贡献者在未来可能会添加一些恶意代码。

**项目地址:** [gmh5225/CVE-2023-4220](https://github.com/gmh5225/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #18

**来源**: [CVE-2023-4220-insomnia-jacob_CVE-2023-4220.md](../2023/CVE-2023-4220-insomnia-jacob_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo LMS-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未授权攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统安装了Chamilo LMS，且版本小于等于1.11.24，并且可以访问`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220是Chamilo LMS <= v1.11.24中`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件存在的一个未授权文件上传漏洞。攻击者可以利用此漏洞上传恶意webshell，从而实现远程代码执行。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者上传任意文件，包括webshell，导致远程代码执行。提供的POC代码看起来能够自动化利用该漏洞。

**投毒风险分析：**
查看提供的`exploit.py`脚本，该脚本的功能是：
1.  检测目标URL是否存在漏洞（通过检查`/main/inc/lib/javascript/bigupload/files`目录）。
2.  如果检测到漏洞，则上传一个名为`insomnia.php`的webshell到目标服务器的`/main/inc/lib/javascript/bigupload/files/`目录下。
3.  脚本中创建了一个简单的webshell，允许通过GET参数`cmd`执行系统命令。并没有发现隐藏的、恶意的或不必要的功能，因此认为投毒风险极低，为0%。

**利用方式：**
1.  攻击者使用POC脚本指定目标Chamilo LMS的URL。
2.  POC脚本检查目标是否存在漏洞。
3.  如果存在漏洞，POC脚本上传一个简单的webshell。
4.  攻击者通过访问webshell的URL，并提供`cmd`参数来执行任意系统命令，如`http://example.com/main/inc/lib/javascript/bigupload/files/insomnia.php?cmd=id`。

综上所述，该漏洞的利用方式简单直接，危害性高，且POC有效。尽管POC可能被修改为恶意用途，但当前提供的代码没有发现明显的投毒行为。

**项目地址:** [insomnia-jacob/CVE-2023-4220](https://github.com/insomnia-jacob/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #19

**来源**: [CVE-2023-4220-m3m0o_chamilo-lms-unauthenticated-big-upload-rce-poc.md](../2023/CVE-2023-4220-m3m0o_chamilo-lms-unauthenticated-big-upload-rce-poc.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全被控制，敏感信息泄露，安装勒索软件等

**影响版本:** <= 1.11.24

**利用条件:** 无需身份验证，需要目标系统运行受影响的Chamilo LMS版本并且 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径存在。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个高危漏洞，存在于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中。未经身份验证的攻击者可以通过上传恶意文件（例如 web shell）来执行任意代码。利用方式是，攻击者通过构造恶意请求，绕过文件上传限制，将包含恶意代码的文件上传到服务器。由于上传路径不受限制，攻击者可以访问上传的文件，从而执行其中的恶意代码。漏洞利用代码仓库中只包含Apache License协议，没有发现任何可疑代码，因此判定投毒风险为0%。搜索结果显示有公开的PoC可供利用。

**项目地址:** [m3m0o/chamilo-lms-unauthenticated-big-upload-rce-poc](https://github.com/m3m0o/chamilo-lms-unauthenticated-big-upload-rce-poc)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #20

**来源**: [CVE-2023-4220-nr4x4_CVE-2023-4220.md](../2023/CVE-2023-4220-nr4x4_CVE-2023-4220.md)

## CVE-2023-4220 - Chamilo LMS Unauthenticated RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可上传WebShell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS，且版本小于等于1.11.24，并且可以访问到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 页面。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个高危漏洞，允许未经身份验证的攻击者通过大文件上传功能上传恶意文件（WebShell），从而实现远程代码执行。

**有效性分析：**

*   漏洞库信息明确指出，Chamilo LMS <= 1.11.24 存在未经身份验证的文件上传漏洞。
*   搜索引擎结果中，大量网页描述了此漏洞，并确认可以实现 RCE。
*   提供的漏洞利用代码包含 Python 脚本 (cve-2023-4220.py) 和 Shell 脚本 (cve-2023-4220.sh)，分别用于交互式 RCE 和反弹 Shell。同时，README.md 中提供了使用 curl 命令手动上传 WebShell 并执行的步骤。
*   漏洞利用代码中的curl 命令尝试上传 `jiji.php` 到 `/main/inc/lib/javascript/bigupload/files/` 目录。通过访问该文件并附加 `jiji` 参数，攻击者可以执行任意系统命令。
*   综合来看，POC代码是有效的，可以利用该漏洞在目标系统上执行任意代码。

**投毒风险分析：**

*   查看提供的代码文件，核心利用逻辑主要集中在上传webshell和执行命令。没有发现明显的恶意代码，如删除文件、修改系统配置等。
*   `cve-2023-4220.sh` 脚本提供了反弹 shell 的功能，攻击者可以利用它来建立持久的远程访问。 虽然这个功能本身是漏洞利用的一部分，但也可能被滥用。
*   `cve-2023-4220.py` 脚本动态生成 webshell 文件，这在一定程度上增加了审查难度，存在细微的隐藏恶意代码的可能性。
*   虽然图片文件显示了命令执行的结果，本身并没有任何恶意代码。
*   综合评估，存在轻微的投毒风险，主要来自于脚本提供的反弹 shell 功能和动态生成webshell文件带来的审查难度，但是可能性较低，概率在5%左右。

**利用方式：**

1.  **上传 WebShell：** 攻击者使用 curl 命令或提供的脚本，将包含恶意代码的 PHP 文件（WebShell）上传到 Chamilo LMS 的 `/main/inc/lib/javascript/bigupload/files/` 目录。利用的上传点为 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`
2.  **执行命令：** 攻击者通过构造 URL，访问上传的 WebShell 文件，并在 URL 中传递要执行的系统命令。例如，`http://<chamilo>/main/inc/lib/javascript/bigupload/files/jiji.php?jiji=id`。
3.  **反弹 Shell (可选):** 使用 `cve-2023-4220.sh` 脚本提供的反弹 shell 功能，获取目标系统的 shell 控制权。

**总结：**

该漏洞利用方式简单，风险高，容易被攻击者利用。系统管理员应尽快升级 Chamilo LMS 版本到安全版本，并检查是否存在恶意上传的文件。

**项目地址:** [nr4x4/CVE-2023-4220](https://github.com/nr4x4/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #21

**来源**: [CVE-2023-4220-numaan911098_CVE-2023-4220.md](../2023/CVE-2023-4220-numaan911098_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-Unrestricted File Upload

**漏洞编号:** CVE-2023-4220

**漏洞类型:** Unrestricted File Upload

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行和存储型XSS

**影响版本:** <= 1.11.24

**利用条件:** 无需身份验证，目标Chamilo LMS实例允许未授权访问/main/inc/lib/javascript/bigupload/inc/bigUpload.php

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-4220 是 Chamilo LMS 1.11.24 及更早版本中存在的一个未授权文件上传漏洞。该漏洞位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中。攻击者可以通过上传包含恶意代码（例如 Web Shell）的文件，实现远程代码执行 (RCE) 和存储型跨站脚本攻击 (XSS)。

**有效性：** 提供的 PoC 代码显示了攻击者如何利用此漏洞上传恶意文件。`CVE-2023-4220.py` 脚本通过 `requests` 库向目标 URL 的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送 POST 请求，上传名为 `bigUploadFile` 的文件。上传成功后，脚本会尝试访问上传的文件，如果返回状态码为 200，则表示利用成功。`Reverse-shell.php` 文件包含一个 PHP 反向 Shell 脚本，用于在服务器上执行任意命令。

**投毒风险：** 提供的 PoC 代码主要用于验证漏洞的存在，并通过上传反向 Shell 来获取远程代码执行权限。`Reverse-shell.php` 脚本本身可以被认为是具有恶意功能的后门代码，但从仓库代码整体来看，并没有发现明显的投毒行为。投毒的概率较低，估计为10%。需要关注点在于，下载此PoC的用户如果直接使用或者修改reverse shell脚本，可能会不小心引入其他的恶意代码，但这不是原作者的投毒意图。

**利用方式：**

1.  攻击者构造一个包含恶意代码的 Web Shell 文件（例如 `Reverse-shell.php`）。
2.  攻击者使用 PoC 脚本（例如 `CVE-2023-4220.py`）向目标 Chamilo LMS 实例的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送 POST 请求，上传 Web Shell 文件。
3.  如果上传成功，攻击者可以通过访问上传的 Web Shell 文件来执行任意命令。
4.  利用 `Reverse-shell.php`，攻击者可以获得服务器的反向 Shell，从而完全控制服务器。

**项目地址:** [numaan911098/CVE-2023-4220](https://github.com/numaan911098/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #22

**来源**: [CVE-2023-4220-oxapavan_CVE-2023-4220-HTB-PermX.md](../2023/CVE-2023-4220-oxapavan_CVE-2023-4220-HTB-PermX.md)

## CVE-2023-4220-Chamilo LMS Unauthenticated RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传导致远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制，数据泄露，安装勒索软件

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，且能够通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个关键漏洞，攻击者可以通过未经身份验证的文件上传功能（`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`）上传恶意文件（如 webshell）。

**漏洞利用方式：**

1.  攻击者使用提供的 PoC 脚本（`CVE-2023-4220.sh`或`script.sh`）进行利用。
2.  脚本通过 curl 命令将恶意文件（reverse shell）上传到 `/main/inc/lib/javascript/bigupload/files/` 目录。
3.  脚本然后尝试访问上传的文件，从而执行恶意代码。
4.  脚本还尝试使用`nc`命令监听目标端口，用于接收反向 shell 连接。

**有效性：**

根据漏洞描述和 PoC 代码，该漏洞利用是有效的。多个搜索结果表明该漏洞允许未经身份验证的远程代码执行。

**投毒风险分析：**

分析提供的 PoC 代码，没有发现明显的投毒代码。脚本的功能是上传文件并尝试触发执行，没有发现恶意修改目标系统或进行其他未声明操作的代码。代码主要通过curl和netcat进行远程利用，没有发现可疑行为，故判定投毒风险为0%。

**项目地址:** [oxapavan/CVE-2023-4220-HTB-PermX](https://github.com/oxapavan/CVE-2023-4220-HTB-PermX)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #23

**来源**: [CVE-2023-4220-qrxnz_CVE-2023-4220.md](../2023/CVE-2023-4220-qrxnz_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo LMS-未授权文件上传导致RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致远程代码执行和存储型XSS

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS，且版本小于等于1.11.24，需要网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220是Chamilo LMS 1.11.24及更早版本中存在的一个高危漏洞。该漏洞位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件中，允许未经身份验证的攻击者通过`big file upload`功能上传任意文件。由于未对上传的文件类型进行充分验证，攻击者可以上传包含恶意代码的Web Shell，从而执行存储型跨站脚本攻击(XSS)或实现远程代码执行(RCE)。

**有效性：** 根据搜索结果和漏洞描述，该漏洞的PoC是存在的，并且可以实现RCE。根据搜索结果，GitHub上已经有公开的PoC代码（https://github.com/VanishedPeople/CVE-2023-4220），证明漏洞的可利用性。

**投毒风险：** 提供的漏洞利用代码`/tmp/10c4d756f57f88eae973d9e10fafe40c/README.md` 非常简单，只是一个包含CVE编号的说明文件，恶意代码不太可能存在于此文件本身。 但是，由于该漏洞是关于文件上传，而提供的代码只是一个README文件，需要进一步查找其他文件，才能确定投毒风险。结合搜索结果中提供的POC链接，假设该PoC仓库包含其他文件，例如用于上传的脚本或webshell，则在这些脚本中可能存在作者隐藏的恶意代码，例如反向shell、信息收集或其他恶意功能。因此，存在一定投毒的风险，估计为10%，主要是考虑到需要进一步分析完整的POC代码才能做出准确判断，目前只看到了README文件。

**利用方式：**
1.  攻击者无需身份验证，可以直接访问`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。
2.  利用`big file upload`功能上传恶意文件，例如包含PHP代码的Web Shell。
3.  由于未充分验证文件类型，恶意文件会被服务器接受并存储。
4.  攻击者可以通过访问上传的Web Shell来执行任意PHP代码，从而控制服务器。
5.  攻击者还可以利用上传的Web Shell执行存储型XSS攻击，影响其他用户。


**项目地址:** [qrxnz/CVE-2023-4220](https://github.com/qrxnz/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #24

**来源**: [CVE-2023-4220-thefizzyfish_CVE-2023-4220_Chamilo_RCE.md](../2023/CVE-2023-4220-thefizzyfish_CVE-2023-4220_Chamilo_RCE.md)

## CVE-2023-4220 - Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以上传WebShell，从而完全控制服务器，窃取机密信息，安装勒索软件

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行 Chamilo LMS 且版本低于或等于 1.11.24，并且未进行漏洞修复

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS 的 bigUpload.php 文件中，允许未经身份验证的攻击者上传恶意文件（WebShell），从而实现远程代码执行。POC 代码通过构造包含恶意 PHP 代码的文件，并利用 bigUpload 功能上传该文件。上传成功后，攻击者可以通过访问该文件来执行任意命令。代码中存在轻微的投毒风险，因为攻击者可能会修改上传的文件内容，例如，在 WebShell 中加入恶意代码，用于收集用户信息或者进行其他恶意活动。但仓库中LICENSE文件是标准的MIT协议,文件结构简单,基本可以排除作者投毒风险,该风险主要存在于使用者,如果使用者修改了代码，那投毒风险会提升。

**利用方式：**
1.  攻击者利用未经身份验证的文件上传漏洞，将包含恶意 PHP 代码的 Webshell 文件上传到 `/main/inc/lib/javascript/bigupload/files/` 目录下。
2.  攻击者通过构造特定的 URL 请求，访问上传的 Webshell 文件，并传递要执行的命令。
3.  服务器执行 Webshell 中的 PHP 代码，从而执行攻击者指定的命令。
4.  攻击者利用执行的命令获取服务器的控制权，例如，反弹 Shell。

**POC 代码分析：**
*   `CVE-2023-4220.py`: 该 Python 脚本实现了漏洞利用的自动化，它首先构造包含反弹 Shell 代码的 Webshell 文件，然后将其上传到目标服务器，最后通过发送 GET 请求触发 Webshell 的执行。
*   `README.md`: 包含漏洞的简要描述和利用方法。
*   `LICENSE`: 使用 MIT 许可证。

**项目地址:** [thefizzyfish/CVE-2023-4220_Chamilo_RCE](https://github.com/thefizzyfish/CVE-2023-4220_Chamilo_RCE)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #25

**来源**: [CVE-2023-4220-zora-beep_CVE-2023-4220.md](../2023/CVE-2023-4220-zora-beep_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全被控制

**影响版本:** <= 1.11.24

**利用条件:** 需要目标服务器运行Chamilo LMS，且版本在受影响范围内。攻击者需要能够通过网络访问目标服务器的`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个未授权文件上传漏洞，位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中。未经身份验证的攻击者可以通过上传恶意文件（如 webshell）来执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** `bigUpload.php` 文件处理大文件上传功能时，未对上传的文件类型进行严格的验证，允许上传具有危险类型的文件，如 PHP 文件。
2.  **利用步骤：**
    *   攻击者使用提供的 `exploit.py` 脚本，指定目标 Chamilo LMS 实例的 URL 和要上传的 webshell 文件。
    *   脚本将 webshell 文件通过 POST 请求发送到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 路径。
    *   如果上传成功，攻击者可以通过访问上传的 webshell 文件来执行任意代码。

3.  **有效性分析：** 根据漏洞描述和搜索引擎结果，该漏洞的 POC 代码是有效的，可以实现远程代码执行。

4.  **投毒风险分析：**
    *   `exploit.py` 脚本是一个简单的文件上传脚本，主要功能是发送 POST 请求，上传指定的文件到目标 URL。代码本身没有发现任何可疑或恶意的行为。
    *   `README.md` 文件仅包含脚本的使用说明，没有包含任何可执行代码或恶意链接。
    *   因此，该仓库中存在投毒代码的可能性较低，可以判断投毒风险为0%。

5.  **利用方式总结：**
    *   **目标：** Chamilo LMS <= 1.11.24
    *   **漏洞：** 未授权文件上传 (CVE-2023-4220)
    *   **攻击方式：** 使用 `exploit.py` 脚本上传 webshell 到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`，然后访问 webshell 执行任意代码。

**项目地址:** [zora-beep/CVE-2023-4220](https://github.com/zora-beep/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---



---

## POC #5

**来源**: [CVE-2023-4220-H4cking4All_CVE-2023-4220.md](../2023/CVE-2023-4220-H4cking4All_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** Chamilo LMS 实例需要运行在易受攻击的版本上，并且需要能够通过网络访问 vulnerable_url

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS <= 1.11.24 的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中，是一个未授权的文件上传漏洞。

**有效性:**

根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判定该漏洞利用代码是有效的。漏洞库信息明确指出该漏洞允许未经身份验证的攻击者上传 webshell 并执行远程代码。搜索引擎结果中也提到了这一点，并给出了PoC链接。漏洞利用代码 `exploit.py` 实现了漏洞利用的完整流程，包括：

1.  **检查目标 URL 是否易受攻击:**  `checkVuln` 函数通过检查 `/main/inc/lib/javascript/bigupload/files` 目录的可访问性来判断目标是否存在漏洞。
2.  **上传 webshell:**  `exploitVuln` 函数通过 POST 请求将包含恶意 PHP 代码 (webshell) 的文件上传到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，服务器会将文件存储在 `/main/inc/lib/javascript/bigupload/files` 目录下。
3.  **执行命令:** 漏洞利用代码通过访问上传的 webshell，利用 GET 参数 `cmd` 执行任意系统命令。
4.  **反弹shell:** 通过webshell执行bash反弹shell命令,获取服务器控制权.

**投毒风险:**

对提供的 `exploit.py` 代码进行分析，发现存在轻微的投毒风险。风险主要来自于以下几点：

*   **硬编码代理:** 代码中存在 `proxy = {'http': 'http://localhost:8080/'}`。如果用户没有注意到这一行，并且本地没有运行代理服务，可能会导致漏洞利用失败，并泄露目标URL。这是一个潜在的流量劫持点，虽然不太可能是有意的投毒，但仍存在一定风险。
*   **输入webshell文件名:** 漏洞利用代码允许用户自定义webshell的文件名,如果用户设置恶意文件名,可能会影响后续利用.
*   **Reverse Shell IP 和端口:** 脚本要求用户输入攻击者的 IP 地址和端口。如果攻击者没有正确配置监听器，则反弹 shell 将无法建立连接。

虽然存在上述风险，但这些风险更偏向于可用性问题，而不是恶意代码。漏洞利用的整体逻辑是清晰的，旨在利用漏洞，而不是进行恶意活动，因此投毒风险较低，估计在 10% 左右。

**利用方式:**

1.  **确定目标 Chamilo LMS 版本:**  确认目标 Chamilo LMS 实例的版本小于等于 1.11.24。
2.  **运行 `exploit.py`:**  使用 Python 运行 `exploit.py` 脚本，并提供目标 Chamilo LMS 的 URL 作为参数，选择 `exploit` 模式。
3.  **输入 webshell 文件名：** 输入希望使用的 webshell 文件名（不包含扩展名）。
4.  **设置反弹 shell 信息:**  输入攻击者的 IP 地址和端口，确保攻击者机器上已经启动了 netcat 监听器。
5.  **获取 shell:**  如果漏洞利用成功，攻击者将会在 netcat 监听器上获得一个反弹 shell，从而控制目标服务器。

**项目地址:** [H4cking4All/CVE-2023-4220](https://github.com/H4cking4All/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #6

**来源**: [CVE-2023-4220-HO4XXX_cve-2023-4220-poc.md](../2023/CVE-2023-4220-HO4XXX_cve-2023-4220-poc.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传导致远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未授权攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS <= 1.11.24，并且可以网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Chamilo LMS的bigupload功能中。攻击者可以通过未授权的文件上传，将恶意webshell上传到服务器，然后通过访问webshell执行任意代码。

**有效性评估：**
根据漏洞描述和搜索结果，该漏洞是真实存在的，且危害严重。提供的PoC代码基本完整，能够实现未经身份验证的webshell上传和命令执行。PoC通过发送multipart/form-data请求，上传包含PHP代码的文件到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`处理，然后通过访问上传的文件触发webshell执行。

**投毒风险评估：**
PoC代码主要功能是上传webshell和执行命令，检查了`poc.py`脚本，发现存在一定的投毒风险。风险点包括：

1.  **revshell代码：** PoC中包含上传反向shell的代码，如果攻击者不小心或者不理解代码，直接运行，可能会在自己的机器上打开端口，等待被连接，增加了风险。
2.  **URL参数：** PoC需要指定目标URL，如果攻击者不小心将URL指向自己的机器，可能会将webshell上传到自己的服务器上。
3.  **文件名：** PoC可以自定义上传的文件名，如果攻击者使用一些敏感的文件名，可能会引起管理员的注意。

总体来说，PoC代码本身投毒的概率较低，但使用不当可能会带来一定的安全风险。因此，需要在使用PoC代码时，仔细阅读代码，理解代码的逻辑，并采取必要的安全措施。

**漏洞利用方式：**
1.  攻击者利用未授权文件上传漏洞，上传webshell（例如PHP脚本）到Chamilo LMS服务器。
2.  攻击者通过构造特定的URL，访问上传的webshell，触发webshell执行。
3.  Webshell执行后，攻击者可以在服务器上执行任意代码，例如窃取数据、篡改网站内容、控制服务器等。

**缓解措施：**
1.  升级Chamilo LMS到最新版本，修复此漏洞。
2.  限制上传文件类型，禁止上传PHP等可执行文件。
3.  加强服务器安全配置，防止webshell执行。

**项目地址:** [HO4XXX/cve-2023-4220-poc](https://github.com/HO4XXX/cve-2023-4220-poc)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #7

**来源**: [CVE-2023-4220-LGenAgul_CVE-2023-4220-Proof-of-concept.md](../2023/CVE-2023-4220-LGenAgul_CVE-2023-4220-Proof-of-concept.md)

## CVE-2023-4220-Chamilo LMS-远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制，包括信息窃取、安装勒索软件等

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS <= 1.11.24，且`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件存在且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220是Chamilo LMS中一个未经验证的任意文件上传漏洞，位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`的“大文件上传”功能中。攻击者无需身份验证即可上传恶意文件（例如，PHP webshell），从而实现存储型跨站脚本攻击 (XSS) 和远程代码执行 (RCE)。

**利用方式：**

1.  **上传恶意文件：** 攻击者使用POST请求将包含恶意代码（如PHP反向shell）的webshell文件上传到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`。该漏洞允许上传任意类型的文件，绕过了文件类型检查。
2.  **触发恶意代码执行：** 成功上传后，攻击者通过访问上传的文件（例如：`/main/inc/lib/javascript/bigupload/files/cmd.php?ip=<攻击者IP>&port=<攻击者端口>`）来触发webshell的执行。这将导致服务器执行攻击者上传的恶意代码。
3.  **获取反向Shell：** 攻击者需要提前在攻击机上监听指定的端口（例如，使用`nc -lvnp <端口>`）。当webshell执行时，它会尝试连接攻击者的IP地址和端口，从而建立一个反向shell连接，使攻击者能够远程控制受害服务器。

**POC有效性评估：**

提供的PoC代码（`exploit.py`）实现了上述利用过程。它首先创建一个包含反向shell代码的PHP文件（`cmd.php`），然后将其上传到存在漏洞的服务器，并通过HTTP GET请求触发该文件的执行。PoC代码还包含启动netcat监听器的功能，用于接收反向shell连接。根据搜索结果和漏洞描述，此PoC代码被认为是有效的。

**投毒风险评估：**

虽然该代码的主要目的是利用漏洞获取反向shell，但仍然存在一定的投毒风险。该脚本执行后，会在目标系统上写入webshell文件，并且通过HTTP请求访问该webshell。理论上，作者可能在shell代码中插入额外的恶意代码，例如，用于收集系统信息、植入后门或进行其他恶意活动。此外，上传webshell本身就存在一定风险，因为webshell可能被其他攻击者利用。由于该脚本来自非官方渠道，并且webshell本身就具有潜在的风险，因此投毒的可能性评估为10%。

**项目地址:** [LGenAgul/CVE-2023-4220-Proof-of-concept](https://github.com/LGenAgul/CVE-2023-4220-Proof-of-concept)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #8

**来源**: [CVE-2023-4220-MikeyPPPPPPPP_CVE-2023-4220.md](../2023/CVE-2023-4220-MikeyPPPPPPPP_CVE-2023-4220.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 文件上传漏洞

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行和跨站脚本攻击

**影响版本:** <= 1.11.24

**利用条件:** 目标Chamilo LMS实例运行在受影响的版本上，且`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS 的大文件上传功能中，攻击者可以通过上传恶意文件，例如 webshell，从而实现远程代码执行。由于该漏洞无需身份验证，因此任何未经授权的攻击者都可能利用此漏洞。 

**漏洞利用方式：**

1.  攻击者向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送包含恶意 webshell 的上传请求。
2.  由于文件上传功能存在漏洞，恶意文件成功上传到服务器的 `/main/inc/lib/javascript/bigupload/files/` 目录。
3.  攻击者通过访问上传的 webshell，执行任意代码。

**POC代码分析：**

POC 代码 `CVE-2023-4220.py`  实现了漏洞的利用。代码首先检查目标是否存在漏洞利用所需的目录，然后上传包含PHP代码的 webshell。上传成功后，该脚本提供了一个交互式 shell，攻击者可以使用它在服务器上执行命令。该脚本还尝试通过 Tor 网络进行连接，并进行 User-Agent 伪装，以增加攻击的隐蔽性。 命令输入和输出被记录到 `command.log` 文件中。

**投毒风险分析：**

虽然 POC 代码的核心功能是漏洞利用，但存在轻微的投毒风险。风险点主要在于 `command.log` 文件。 虽然日志本身不是恶意的，但它会记录攻击者执行的所有命令，这些信息在某些情况下可能会被滥用或者泄露敏感信息。 此外，代码强制通过Tor代理, 也有可能被用于恶意目的。因此，投毒风险评估为10%。该评估是基于作者在其他地方增加恶意代码，如反向shell或数据窃取的可能性。没有直接证据表明存在恶意代码，但增加Tor代理使用的这种行为本身会引起警惕。

**项目地址:** [MikeyPPPPPPPP/CVE-2023-4220](https://github.com/MikeyPPPPPPPP/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #9

**来源**: [CVE-2023-4220-N1ghtfallXxX_CVE-2023-4220.md](../2023/CVE-2023-4220-N1ghtfallXxX_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo LMS-远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可完全控制服务器

**影响版本:** <= 1.11.24

**利用条件:** 需要网络访问，Chamilo LMS版本小于等于1.11.24

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个未授权的任意文件上传漏洞。攻击者可以通过向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送恶意请求，上传包含恶意代码的 PHP 文件，从而实现远程代码执行。

**有效性：**

根据搜索引擎结果和漏洞利用代码，该漏洞的利用是有效的。存在公开可用的 PoC 代码，可以验证该漏洞的存在并实现远程代码执行。搜索结果中也提到了远程代码执行的风险。

**投毒风险：**

提供的漏洞利用代码包含两个文件：`README.md` 和 `chamilo-rce.py`。
*   `README.md`: 包含漏洞描述、利用方法和免责声明，没有发现恶意代码。
*   `chamilo-rce.py`: 是一个 Python 脚本，用于生成包含反向 shell 的 PHP payload，并将其上传到目标服务器。脚本会根据用户输入的 IP 地址和端口，生成反向 shell 代码，并保存为 `rce.php` 文件。然后，脚本会构造一个 HTTP 请求，将 `rce.php` 文件上传到存在漏洞的 Chamilo LMS 实例。

虽然该脚本本身旨在利用漏洞，但它允许用户自定义反向 shell 的 IP 地址和端口。 因此，虽然利用本身是恶意的，但脚本本身并没有被投毒。只有非常轻微的投毒风险，例如在代码中引入细微的错误或依赖项，使得Payload失效，或者导致目标系统不稳定。但此几率极低。

**利用方式：**

1.  攻击者克隆包含PoC的git仓库 `https://github.com/N1ghtfallXxX/CVE-2023-4220` 
2.  攻击者通过 `chamilo-rce.py` 脚本生成包含恶意 PHP 代码的文件（Web Shell）。
3.  利用漏洞，未经验证上传恶意 PHP 文件。
4.  通过访问上传的 PHP 文件，执行其中的恶意代码，从而获得服务器的控制权。
5.  通过反弹shell连接攻击者本地监听端口,获得服务器shell

**项目地址:** [N1ghtfallXxX/CVE-2023-4220](https://github.com/N1ghtfallXxX/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #10

**来源**: [CVE-2023-4220-Pr1or95_CVE-2023-4220-exploit.md](../2023/CVE-2023-4220-Pr1or95_CVE-2023-4220-exploit.md)

## CVE-2023-4220-Chamilo LMS 未授权文件上传导致RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传/远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全被控制，数据泄露，安装勒索软件等

**影响版本:** <= 1.11.24

**利用条件:** 需要目标Chamilo LMS实例可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS <= 1.11.24 的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中，这是一个未经身份验证的大文件上传接口。攻击者可以通过该接口上传恶意webshell文件，从而获得服务器的远程代码执行权限。

**有效性:**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以判断该PoC代码有效。漏洞库信息明确指出该漏洞允许未经身份验证的攻击者上传webshell并执行任意代码。搜索引擎结果中也包含多个关于该漏洞的描述，并指出可以远程控制服务器。提供的PoC代码包含一个 bash 脚本 (CVE-2023-4220.sh)，该脚本自动化了webshell的上传和访问过程，验证了漏洞的可利用性。

**利用方式:**

1.  攻击者执行PoC脚本，指定webshell文件路径、目标Chamilo LMS的URL以及监听端口。
2.  脚本使用curl命令上传webshell到目标服务器的 `/main/inc/lib/javascript/bigupload/files/` 目录下。
3.  脚本尝试访问上传的webshell文件，并使用 `nc` 命令在指定端口上启动监听。
4.  成功访问webshell后，攻击者即可通过监听端口与webshell进行交互，从而执行任意系统命令。

**投毒风险:**

提供的PoC代码主要包含一个bash脚本和一个README文件。通过分析bash脚本的内容，可以发现脚本主要功能是上传文件，访问文件和启动一个网络监听。脚本本身没有明显的恶意代码，但是存在以下潜在的投毒风险：

1.  **依赖的webshell文件:** webshell文件本身可能包含恶意代码，例如反弹shell，下载并执行其他恶意程序等。但是，webshell的内容不由PoC作者控制，因此不应算作PoC本身的投毒。
2.  **README文件:** README文件用于说明PoC的使用方法，通常不会包含恶意代码。
3.  **sleep 时间:** 脚本中`sleep 3`指令可能会被恶意修改,增加sleep时间或者消耗服务器资源的操作,实现隐蔽的拒绝服务攻击.

综上所述，PoC代码本身存在投毒的可能性较低，大概为10%，主要的风险来自于攻击者使用的webshell文件。

**项目地址:** [Pr1or95/CVE-2023-4220-exploit](https://github.com/Pr1or95/CVE-2023-4220-exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #11

**来源**: [CVE-2023-4220-VanishedPeople_CVE-2023-4220.md](../2023/CVE-2023-4220-VanishedPeople_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 1.11.24

**利用条件:** 需要目标系统运行Chamilo LMS <= 1.11.24，并且攻击者可以访问到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个未授权的文件上传漏洞，存在于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中大文件上传功能处。攻击者可以利用此漏洞上传恶意 WebShell，从而获得服务器的远程代码执行权限。由于漏洞利用不需要身份验证，风险极高。

**有效性：**
根据提供的漏洞库信息、搜索结果和漏洞利用代码（尽管仅提供了许可证文件），可以判断该漏洞利用的有效性较高。 漏洞库信息明确指出该漏洞会导致远程代码执行，搜索结果也确认了这一点，并提供了相关的 PoC 链接 (https://github.com/VanishedPeople/CVE-2023-4220 )。

**投毒风险：**
提供的代码段是 Apache 2.0 许可证，本身不包含任何恶意代码。 因为只提供了license文件，无法评估其他代码文件是否包含后门, 考虑到poc的贡献者，以及该漏洞的细节，可以认为投毒的可能性较低。

**利用方式：**
1.  攻击者构造一个恶意的 WebShell 文件，例如 PHP 文件。
2.  利用 Chamilo LMS 中 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 的大文件上传功能，将恶意 WebShell 文件上传到服务器。
3.  通过访问上传的 WebShell 文件，执行任意代码，从而控制服务器。

由于上传过程未进行严格的文件类型检查或大小限制，攻击者可以绕过安全机制，成功上传恶意文件。


**项目地址:** [VanishedPeople/CVE-2023-4220](https://github.com/VanishedPeople/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #12

**来源**: [CVE-2023-4220-Ziad-Sakr_Chamilo-CVE-2023-4220-Exploit.md](../2023/CVE-2023-4220-Ziad-Sakr_Chamilo-CVE-2023-4220-Exploit.md)

## CVE-2023-4220 Chamilo LMS 远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行和服务器完全控制

**影响版本:** <= 1.11.24

**利用条件:** Chamilo LMS <= 1.11.24，目标服务器可访问，`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径存在且可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 漏洞存在于Chamilo LMS的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中，允许未经身份验证的攻击者通过上传恶意文件（例如webshell）来执行任意代码。该漏洞利用了 Chamilo LMS 大文件上传功能中的一个缺陷，攻击者通过构造特定的请求，将恶意文件上传到 `/main/inc/lib/javascript/bigupload/files/` 目录。上传的文件可以被直接访问并执行，导致远程代码执行。

**有效性：**

提供的POC代码通过 curl 命令模拟文件上传，指定了上传的文件路径、目标URL和执行reverse shell的端口。基本逻辑符合漏洞描述，利用步骤清晰，可以有效利用该漏洞。

**投毒风险：**

代码本身主要是通过curl上传文件，以及使用nc监听端口，看起来比较直接。但是，有几点需要关注：

1.  `reverse_file` 是用户可控的，这意味着如果用户不小心使用了包含恶意代码的文件作为 `reverse_file`，可能会引入投毒。
2.  脚本中提供了一段提示用户进行TTY交互的命令，这段命令本身没有恶意，但如果攻击者替换了其中的`/bin/bash`为其他恶意程序，可能会导致投毒。
3.  脚本执行后会启动一个`nc`监听进程，恶意用户可以连接到此端口执行命令，进行恶意操作。

综上，投毒风险较低，约为10%， 主要来自用户使用的 reverse shell 文件本身可能存在恶意代码。

**利用方式：**

1.  准备一个包含反弹shell代码的webshell文件（reverse_file）。
2.  使用提供的脚本 `CVE-2023-4220.sh`，通过 `-f` 参数指定 webshell 文件的路径，`-h` 参数指定 Chamilo LMS 的主机地址，`-p` 参数指定反弹 shell 的端口。
3.  脚本会使用 curl 命令将webshell上传到Chamilo LMS服务器的指定目录。
4.  脚本启动 nc 监听指定的端口。
5.  通过访问上传的 webshell 文件，触发反弹 shell，攻击者即可获得目标服务器的控制权。

**防范措施：**

1.  升级 Chamilo LMS 到最新版本。
2.  限制上传文件类型，对上传的文件进行安全检查。
3.  加强服务器安全配置，防止恶意代码执行。

**项目地址:** [Ziad-Sakr/Chamilo-CVE-2023-4220-Exploit](https://github.com/Ziad-Sakr/Chamilo-CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #13

**来源**: [CVE-2023-4220-bueno-armando_CVE-2023-4220-RCE.md](../2023/CVE-2023-4220-bueno-armando_CVE-2023-4220-RCE.md)

## CVE-2023-4220-Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** Chamilo LMS服务器可公开访问，且目标版本小于等于1.11.24

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220是Chamilo LMS中存在的一个未经身份验证的远程代码执行漏洞。该漏洞位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件中的大文件上传功能中。攻击者可以通过上传恶意PHP文件（webshell）来执行任意代码。 

**漏洞利用方式：**

1.  攻击者使用`curl`命令上传包含恶意代码的PHP文件到目标服务器的`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，利用大文件上传功能绕过身份验证。
2.  上传成功后，webshell存储在`/main/inc/lib/javascript/bigupload/files/`目录下，文件名为`rce.php`。
3.  攻击者通过`curl`命令访问上传的webshell(`/main/inc/lib/javascript/bigupload/files/rce.php`)，触发webshell中的恶意代码，实现远程代码执行。

**POC代码分析：**

提供的POC代码是一个Python脚本，它执行以下操作：

1.  接收目标URL、端口、命令和可选的反向shell参数。
2.  如果提供了命令，则对其进行Base64编码，然后将其包装在PHP代码中，以便通过`system()`函数执行。
3.  如果未提供命令，则构建一个反向shell命令，使用攻击者的IP地址和端口。
4.  将生成的PHP代码保存到`rce.php`文件中。
5.  使用`curl`命令将`rce.php`上传到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`。
6.  使用`curl`命令访问上传的`rce.php`，执行恶意代码。

**有效性评估：**

根据漏洞描述、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码能够成功上传并执行webshell，从而实现远程代码执行。

**投毒风险分析：**

对POC代码进行分析后，发现存在一定的投毒风险，概率为10%。主要体现在以下方面：

*   脚本直接使用`os.system()`函数执行外部命令，这可能允许攻击者在目标系统上执行任意命令。虽然脚本主要执行curl命令，理论上只涉及上传文件和访问文件，如果攻击者修改了上传文件或者篡改了访问的url, 导致执行系统命令，也存在被植入恶意后门的风险。

总体来说，该POC的投毒风险较低，因为脚本的功能比较明确，恶意行为不容易被隐藏。用户在使用时应仔细检查代码，确保没有被篡改。

**项目地址:** [bueno-armando/CVE-2023-4220-RCE](https://github.com/bueno-armando/CVE-2023-4220-RCE)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #14

**来源**: [CVE-2023-4220-charchit-subedi_chamilo-lms-unauthenticated-rce-poc.md](../2023/CVE-2023-4220-charchit-subedi_chamilo-lms-unauthenticated-rce-poc.md)

## CVE-2023-4220-Chamilo-Unauthenticated-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** RCE

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以通过上传webshell获得远程代码执行权限

**影响版本:** <= 1.11.24

**利用条件:** 需要目标Chamilo LMS实例存在，且版本小于等于1.11.24，并可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220是Chamilo LMS中的一个未经验证的文件上传漏洞，位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。未经身份验证的攻击者可以利用此漏洞上传恶意文件（webshell），从而执行任意代码。漏洞利用方式如下：

1.  **漏洞验证:** 通过访问`/main/inc/lib/javascript/bigupload/files/` 确认目录存在，验证目标是否存在漏洞。
2.  **webshell上传:** 使用POST请求向`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 上传包含PHP代码的恶意文件，文件名为`bigUploadFile`，文件内容为webshell。
3.  **代码执行:** 通过访问`{self.check_url}{filename}?cmd={command}` 执行webshell中的指令

根据提供的POC代码，漏洞利用代码有效。`exploit.py`文件包含`ChamiloBigUploadExploit`类，其中包含了验证漏洞、上传webshell和执行反向shell的方法。

投毒风险评估：

代码中存在动态构建和执行命令的部分，例如在`send_and_execute_revshell`函数中，存在编码绕过，创建bash反弹shell脚本并通过GET参数`cmd`执行。理论上，攻击者可以在`webshell_content`变量中注入恶意代码，或者在`send_and_execute_revshell`函数构建恶意命令。

查看仓库的`README.md`文件,作者要求使用 `pip install -r requirements.txt` 安装依赖包,需要检查`requirements.txt`内容。

在当前提供的代码片段中，没有发现明显的恶意代码。判断仓库中存在的投毒代码可能性为5%，需要进一步对依赖包进行检查。

利用方式总结：

1.  扫描目标以确认漏洞是否存在。
2.  上传webshell。
3.  （可选）上传和执行反向shell，或者直接使用webshell执行任意命令。

**项目地址:** [charchit-subedi/chamilo-lms-unauthenticated-rce-poc](https://github.com/charchit-subedi/chamilo-lms-unauthenticated-rce-poc)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #15

**来源**: [CVE-2023-4220-charlesgargasson_CVE-2023-4220.md](../2023/CVE-2023-4220-charlesgargasson_CVE-2023-4220.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经验证的攻击者执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，并且bigUpload功能未被禁用或修复。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 存在于Chamilo LMS的bigUpload功能中，允许未经身份验证的攻击者通过上传恶意文件（如webshell）来执行远程代码。漏洞位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。根据提供的漏洞利用代码，攻击者首先上传一个包含恶意PHP代码的文件（通常是webshell），然后通过构造特定的URL来访问该文件，从而执行webshell中的代码。

**有效性：**
从搜索结果和漏洞利用代码来看，该漏洞利用是有效的。漏洞库信息和多个搜索结果都表明该漏洞允许未经身份验证的远程代码执行。漏洞利用代码提供了一个简单的PoC，演示了如何上传PHP webshell并执行任意命令。

**投毒风险：**
提供的漏洞利用代码本身**不包含明显的投毒代码**。该代码的目的是上传webshell和执行命令。它首先创建一个名为`/tmp/rce.php`的临时文件，其中包含PHP代码来执行base64编码的命令。然后，使用`curl`命令上传这个文件到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，并使用另一个`curl`命令，通过URL参数`aoOoy`将要执行的命令以base64编码的形式传递给webshell。虽然执行任意命令本身存在安全风险，但是这段代码的主要目的是为了验证漏洞，并没有包含任何用于破坏系统或窃取信息的恶意逻辑。因此，投毒风险评估为0%。

**利用方式：**
1.  **确定目标Chamilo LMS的版本**：可以通过访问`/documentation/changelog.html`来确定版本。
2.  **构造恶意PHP文件（webshell）**：创建一个包含PHP代码的webshell，例如，允许执行任意命令的PHP脚本。
3.  **上传webshell**：使用`curl`命令或其他HTTP客户端，将webshell上传到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`。
4.  **执行命令**：使用`curl`或其他HTTP客户端，构造一个包含要执行的命令的URL，并访问上传的webshell。命令需要进行base64编码和URL编码。

该漏洞利用无需身份验证，攻击复杂度较高（需要了解目标系统的文件路径和URL结构），但影响是严重的，可能导致完全控制目标系统。

**项目地址:** [charlesgargasson/CVE-2023-4220](https://github.com/charlesgargasson/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #16

**来源**: [CVE-2023-4220-dollarboysushil_Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220.md](../2023/CVE-2023-4220-dollarboysushil_Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220.md)

## CVE-2023-4220 - Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传/远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者上传webshell并执行任意代码。

**影响版本:** <= 1.11.24

**利用条件:** 目标Chamilo LMS实例的`/main/inc/lib/javascript/bigupload/files`目录存在且Web服务器对该目录具有写入权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个严重的安全漏洞，影响版本小于等于 1.11.24。此漏洞位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中，允许未经身份验证的攻击者上传任意文件，包括恶意的 webshell。攻击者可以通过简单的 curl 命令上传 php 文件到 `/main/inc/lib/javascript/bigupload/files` 目录。上传后，攻击者可以通过访问该文件执行任意代码。 

**有效性：**  根据提供的POC代码和搜索结果，此漏洞利用是有效的。POC展示了如何使用 curl 命令上传包含恶意代码的 PHP 文件，并通过访问上传的文件来执行代码。搜索结果中也有很多链接提到了利用此漏洞进行远程代码执行的可能性。

**投毒风险：** 查看提供的漏洞利用代码，主要是演示了如何上传和执行一个简单的 `whoami` 命令的webshell。虽然直接的后门代码没有，但是需要考虑到，如果攻击者将此POC集成到自动化攻击脚本中，大规模利用，则会造成严重危害。 仓库中可能存在的投毒风险大约为10%。这个风险来自于以下可能性：
   * 仓库本身可能包含不明显的恶意代码，旨在在使用者部署或运行漏洞利用时执行其他恶意操作。例如，上传的webshell可能包含更复杂的功能，允许攻击者远程控制受害者服务器。 
   * 该漏洞利用可能会被修改以包含后门，然后重新分发。虽然原始POC可能没有恶意代码，但修改后的版本可能会包含。

**利用方式：** 

1.  **确定目标：**  找到运行 Chamilo LMS 1.11.24 或更早版本的系统。
2.  **上传 Webshell：**  使用 curl 或类似的工具，通过向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 发送包含恶意 PHP 代码的文件来上传 webshell。  文件名为webshell文件名，例如`dollarboysushil.php`。
3.  **执行代码：**  通过访问上传的 webshell 文件，例如 `http://<website>/main/inc/lib/javascript/bigupload/files/dollarboysushil.php`，来执行任意代码。 请先确认`/main/inc/lib/javascript/bigupload/files`路径存在。

总而言之，CVE-2023-4220 是一个严重的漏洞，利用简单，影响广泛。应该立即修补受影响的 Chamilo LMS 实例。即使是看起来无害的PoC代码，也需要进行安全审查后使用。

**项目地址:** [dollarboysushil/Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220](https://github.com/dollarboysushil/Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #17

**来源**: [CVE-2023-4220-gmh5225_CVE-2023-4220.md](../2023/CVE-2023-4220-gmh5225_CVE-2023-4220.md)

## CVE-2023-4220 - Chamilo LMS 未授权文件上传导致远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以上传WebShell，最终导致远程代码执行

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行着Chamilo LMS <= 1.11.24，且攻击者可以访问该系统的网络端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 存在于Chamilo LMS的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中。该文件存在未授权的文件上传漏洞，允许未经身份验证的攻击者上传任意文件，包括WebShell。 

**利用方式：**

1.  攻击者通过发送POST请求到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`，上传一个包含恶意代码的PHP文件（WebShell），文件名可以为任意值。
2.  上传的文件会被保存在 `/main/inc/lib/javascript/bigupload/files/` 目录下。
3.  攻击者通过访问 `/main/inc/lib/javascript/bigupload/files/{webshell_name}.php` 执行上传的WebShell，从而实现远程代码执行。

提供的POC代码（exploit.py）自动化了这一过程，首先检查目标是否存在漏洞，然后上传一个简单的WebShell (insomnia.php)，允许攻击者执行任意命令。 

**有效性：**

根据漏洞库信息、搜索引擎结果和漏洞利用代码，该POC代码是有效的，可以成功利用该漏洞实现远程代码执行。 搜索结果中的pentest-tools.com的描述和github上的POC都确认了漏洞的存在和利用方式。

**投毒风险：**

查看了POC代码，该代码主要功能是上传webshell，并无发现恶意投毒代码，代码有域名作者信息。但是仍然需要谨慎，因为上传的WebShell本身就是恶意代码，攻击者可以通过WebShell执行任何操作。我假设存在5%的风险, 代码库维护者或者代码贡献者在未来可能会添加一些恶意代码。

**项目地址:** [gmh5225/CVE-2023-4220](https://github.com/gmh5225/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #18

**来源**: [CVE-2023-4220-insomnia-jacob_CVE-2023-4220.md](../2023/CVE-2023-4220-insomnia-jacob_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo LMS-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未授权攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统安装了Chamilo LMS，且版本小于等于1.11.24，并且可以访问`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220是Chamilo LMS <= v1.11.24中`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件存在的一个未授权文件上传漏洞。攻击者可以利用此漏洞上传恶意webshell，从而实现远程代码执行。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者上传任意文件，包括webshell，导致远程代码执行。提供的POC代码看起来能够自动化利用该漏洞。

**投毒风险分析：**
查看提供的`exploit.py`脚本，该脚本的功能是：
1.  检测目标URL是否存在漏洞（通过检查`/main/inc/lib/javascript/bigupload/files`目录）。
2.  如果检测到漏洞，则上传一个名为`insomnia.php`的webshell到目标服务器的`/main/inc/lib/javascript/bigupload/files/`目录下。
3.  脚本中创建了一个简单的webshell，允许通过GET参数`cmd`执行系统命令。并没有发现隐藏的、恶意的或不必要的功能，因此认为投毒风险极低，为0%。

**利用方式：**
1.  攻击者使用POC脚本指定目标Chamilo LMS的URL。
2.  POC脚本检查目标是否存在漏洞。
3.  如果存在漏洞，POC脚本上传一个简单的webshell。
4.  攻击者通过访问webshell的URL，并提供`cmd`参数来执行任意系统命令，如`http://example.com/main/inc/lib/javascript/bigupload/files/insomnia.php?cmd=id`。

综上所述，该漏洞的利用方式简单直接，危害性高，且POC有效。尽管POC可能被修改为恶意用途，但当前提供的代码没有发现明显的投毒行为。

**项目地址:** [insomnia-jacob/CVE-2023-4220](https://github.com/insomnia-jacob/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #19

**来源**: [CVE-2023-4220-m3m0o_chamilo-lms-unauthenticated-big-upload-rce-poc.md](../2023/CVE-2023-4220-m3m0o_chamilo-lms-unauthenticated-big-upload-rce-poc.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全被控制，敏感信息泄露，安装勒索软件等

**影响版本:** <= 1.11.24

**利用条件:** 无需身份验证，需要目标系统运行受影响的Chamilo LMS版本并且 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径存在。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个高危漏洞，存在于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中。未经身份验证的攻击者可以通过上传恶意文件（例如 web shell）来执行任意代码。利用方式是，攻击者通过构造恶意请求，绕过文件上传限制，将包含恶意代码的文件上传到服务器。由于上传路径不受限制，攻击者可以访问上传的文件，从而执行其中的恶意代码。漏洞利用代码仓库中只包含Apache License协议，没有发现任何可疑代码，因此判定投毒风险为0%。搜索结果显示有公开的PoC可供利用。

**项目地址:** [m3m0o/chamilo-lms-unauthenticated-big-upload-rce-poc](https://github.com/m3m0o/chamilo-lms-unauthenticated-big-upload-rce-poc)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #20

**来源**: [CVE-2023-4220-nr4x4_CVE-2023-4220.md](../2023/CVE-2023-4220-nr4x4_CVE-2023-4220.md)

## CVE-2023-4220 - Chamilo LMS Unauthenticated RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可上传WebShell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS，且版本小于等于1.11.24，并且可以访问到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 页面。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个高危漏洞，允许未经身份验证的攻击者通过大文件上传功能上传恶意文件（WebShell），从而实现远程代码执行。

**有效性分析：**

*   漏洞库信息明确指出，Chamilo LMS <= 1.11.24 存在未经身份验证的文件上传漏洞。
*   搜索引擎结果中，大量网页描述了此漏洞，并确认可以实现 RCE。
*   提供的漏洞利用代码包含 Python 脚本 (cve-2023-4220.py) 和 Shell 脚本 (cve-2023-4220.sh)，分别用于交互式 RCE 和反弹 Shell。同时，README.md 中提供了使用 curl 命令手动上传 WebShell 并执行的步骤。
*   漏洞利用代码中的curl 命令尝试上传 `jiji.php` 到 `/main/inc/lib/javascript/bigupload/files/` 目录。通过访问该文件并附加 `jiji` 参数，攻击者可以执行任意系统命令。
*   综合来看，POC代码是有效的，可以利用该漏洞在目标系统上执行任意代码。

**投毒风险分析：**

*   查看提供的代码文件，核心利用逻辑主要集中在上传webshell和执行命令。没有发现明显的恶意代码，如删除文件、修改系统配置等。
*   `cve-2023-4220.sh` 脚本提供了反弹 shell 的功能，攻击者可以利用它来建立持久的远程访问。 虽然这个功能本身是漏洞利用的一部分，但也可能被滥用。
*   `cve-2023-4220.py` 脚本动态生成 webshell 文件，这在一定程度上增加了审查难度，存在细微的隐藏恶意代码的可能性。
*   虽然图片文件显示了命令执行的结果，本身并没有任何恶意代码。
*   综合评估，存在轻微的投毒风险，主要来自于脚本提供的反弹 shell 功能和动态生成webshell文件带来的审查难度，但是可能性较低，概率在5%左右。

**利用方式：**

1.  **上传 WebShell：** 攻击者使用 curl 命令或提供的脚本，将包含恶意代码的 PHP 文件（WebShell）上传到 Chamilo LMS 的 `/main/inc/lib/javascript/bigupload/files/` 目录。利用的上传点为 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`
2.  **执行命令：** 攻击者通过构造 URL，访问上传的 WebShell 文件，并在 URL 中传递要执行的系统命令。例如，`http://<chamilo>/main/inc/lib/javascript/bigupload/files/jiji.php?jiji=id`。
3.  **反弹 Shell (可选):** 使用 `cve-2023-4220.sh` 脚本提供的反弹 shell 功能，获取目标系统的 shell 控制权。

**总结：**

该漏洞利用方式简单，风险高，容易被攻击者利用。系统管理员应尽快升级 Chamilo LMS 版本到安全版本，并检查是否存在恶意上传的文件。

**项目地址:** [nr4x4/CVE-2023-4220](https://github.com/nr4x4/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #21

**来源**: [CVE-2023-4220-numaan911098_CVE-2023-4220.md](../2023/CVE-2023-4220-numaan911098_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-Unrestricted File Upload

**漏洞编号:** CVE-2023-4220

**漏洞类型:** Unrestricted File Upload

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行和存储型XSS

**影响版本:** <= 1.11.24

**利用条件:** 无需身份验证，目标Chamilo LMS实例允许未授权访问/main/inc/lib/javascript/bigupload/inc/bigUpload.php

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-4220 是 Chamilo LMS 1.11.24 及更早版本中存在的一个未授权文件上传漏洞。该漏洞位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中。攻击者可以通过上传包含恶意代码（例如 Web Shell）的文件，实现远程代码执行 (RCE) 和存储型跨站脚本攻击 (XSS)。

**有效性：** 提供的 PoC 代码显示了攻击者如何利用此漏洞上传恶意文件。`CVE-2023-4220.py` 脚本通过 `requests` 库向目标 URL 的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送 POST 请求，上传名为 `bigUploadFile` 的文件。上传成功后，脚本会尝试访问上传的文件，如果返回状态码为 200，则表示利用成功。`Reverse-shell.php` 文件包含一个 PHP 反向 Shell 脚本，用于在服务器上执行任意命令。

**投毒风险：** 提供的 PoC 代码主要用于验证漏洞的存在，并通过上传反向 Shell 来获取远程代码执行权限。`Reverse-shell.php` 脚本本身可以被认为是具有恶意功能的后门代码，但从仓库代码整体来看，并没有发现明显的投毒行为。投毒的概率较低，估计为10%。需要关注点在于，下载此PoC的用户如果直接使用或者修改reverse shell脚本，可能会不小心引入其他的恶意代码，但这不是原作者的投毒意图。

**利用方式：**

1.  攻击者构造一个包含恶意代码的 Web Shell 文件（例如 `Reverse-shell.php`）。
2.  攻击者使用 PoC 脚本（例如 `CVE-2023-4220.py`）向目标 Chamilo LMS 实例的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送 POST 请求，上传 Web Shell 文件。
3.  如果上传成功，攻击者可以通过访问上传的 Web Shell 文件来执行任意命令。
4.  利用 `Reverse-shell.php`，攻击者可以获得服务器的反向 Shell，从而完全控制服务器。

**项目地址:** [numaan911098/CVE-2023-4220](https://github.com/numaan911098/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #22

**来源**: [CVE-2023-4220-oxapavan_CVE-2023-4220-HTB-PermX.md](../2023/CVE-2023-4220-oxapavan_CVE-2023-4220-HTB-PermX.md)

## CVE-2023-4220-Chamilo LMS Unauthenticated RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传导致远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制，数据泄露，安装勒索软件

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，且能够通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个关键漏洞，攻击者可以通过未经身份验证的文件上传功能（`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`）上传恶意文件（如 webshell）。

**漏洞利用方式：**

1.  攻击者使用提供的 PoC 脚本（`CVE-2023-4220.sh`或`script.sh`）进行利用。
2.  脚本通过 curl 命令将恶意文件（reverse shell）上传到 `/main/inc/lib/javascript/bigupload/files/` 目录。
3.  脚本然后尝试访问上传的文件，从而执行恶意代码。
4.  脚本还尝试使用`nc`命令监听目标端口，用于接收反向 shell 连接。

**有效性：**

根据漏洞描述和 PoC 代码，该漏洞利用是有效的。多个搜索结果表明该漏洞允许未经身份验证的远程代码执行。

**投毒风险分析：**

分析提供的 PoC 代码，没有发现明显的投毒代码。脚本的功能是上传文件并尝试触发执行，没有发现恶意修改目标系统或进行其他未声明操作的代码。代码主要通过curl和netcat进行远程利用，没有发现可疑行为，故判定投毒风险为0%。

**项目地址:** [oxapavan/CVE-2023-4220-HTB-PermX](https://github.com/oxapavan/CVE-2023-4220-HTB-PermX)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #23

**来源**: [CVE-2023-4220-qrxnz_CVE-2023-4220.md](../2023/CVE-2023-4220-qrxnz_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo LMS-未授权文件上传导致RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致远程代码执行和存储型XSS

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS，且版本小于等于1.11.24，需要网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220是Chamilo LMS 1.11.24及更早版本中存在的一个高危漏洞。该漏洞位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件中，允许未经身份验证的攻击者通过`big file upload`功能上传任意文件。由于未对上传的文件类型进行充分验证，攻击者可以上传包含恶意代码的Web Shell，从而执行存储型跨站脚本攻击(XSS)或实现远程代码执行(RCE)。

**有效性：** 根据搜索结果和漏洞描述，该漏洞的PoC是存在的，并且可以实现RCE。根据搜索结果，GitHub上已经有公开的PoC代码（https://github.com/VanishedPeople/CVE-2023-4220），证明漏洞的可利用性。

**投毒风险：** 提供的漏洞利用代码`/tmp/10c4d756f57f88eae973d9e10fafe40c/README.md` 非常简单，只是一个包含CVE编号的说明文件，恶意代码不太可能存在于此文件本身。 但是，由于该漏洞是关于文件上传，而提供的代码只是一个README文件，需要进一步查找其他文件，才能确定投毒风险。结合搜索结果中提供的POC链接，假设该PoC仓库包含其他文件，例如用于上传的脚本或webshell，则在这些脚本中可能存在作者隐藏的恶意代码，例如反向shell、信息收集或其他恶意功能。因此，存在一定投毒的风险，估计为10%，主要是考虑到需要进一步分析完整的POC代码才能做出准确判断，目前只看到了README文件。

**利用方式：**
1.  攻击者无需身份验证，可以直接访问`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。
2.  利用`big file upload`功能上传恶意文件，例如包含PHP代码的Web Shell。
3.  由于未充分验证文件类型，恶意文件会被服务器接受并存储。
4.  攻击者可以通过访问上传的Web Shell来执行任意PHP代码，从而控制服务器。
5.  攻击者还可以利用上传的Web Shell执行存储型XSS攻击，影响其他用户。


**项目地址:** [qrxnz/CVE-2023-4220](https://github.com/qrxnz/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #24

**来源**: [CVE-2023-4220-thefizzyfish_CVE-2023-4220_Chamilo_RCE.md](../2023/CVE-2023-4220-thefizzyfish_CVE-2023-4220_Chamilo_RCE.md)

## CVE-2023-4220 - Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以上传WebShell，从而完全控制服务器，窃取机密信息，安装勒索软件

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行 Chamilo LMS 且版本低于或等于 1.11.24，并且未进行漏洞修复

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS 的 bigUpload.php 文件中，允许未经身份验证的攻击者上传恶意文件（WebShell），从而实现远程代码执行。POC 代码通过构造包含恶意 PHP 代码的文件，并利用 bigUpload 功能上传该文件。上传成功后，攻击者可以通过访问该文件来执行任意命令。代码中存在轻微的投毒风险，因为攻击者可能会修改上传的文件内容，例如，在 WebShell 中加入恶意代码，用于收集用户信息或者进行其他恶意活动。但仓库中LICENSE文件是标准的MIT协议,文件结构简单,基本可以排除作者投毒风险,该风险主要存在于使用者,如果使用者修改了代码，那投毒风险会提升。

**利用方式：**
1.  攻击者利用未经身份验证的文件上传漏洞，将包含恶意 PHP 代码的 Webshell 文件上传到 `/main/inc/lib/javascript/bigupload/files/` 目录下。
2.  攻击者通过构造特定的 URL 请求，访问上传的 Webshell 文件，并传递要执行的命令。
3.  服务器执行 Webshell 中的 PHP 代码，从而执行攻击者指定的命令。
4.  攻击者利用执行的命令获取服务器的控制权，例如，反弹 Shell。

**POC 代码分析：**
*   `CVE-2023-4220.py`: 该 Python 脚本实现了漏洞利用的自动化，它首先构造包含反弹 Shell 代码的 Webshell 文件，然后将其上传到目标服务器，最后通过发送 GET 请求触发 Webshell 的执行。
*   `README.md`: 包含漏洞的简要描述和利用方法。
*   `LICENSE`: 使用 MIT 许可证。

**项目地址:** [thefizzyfish/CVE-2023-4220_Chamilo_RCE](https://github.com/thefizzyfish/CVE-2023-4220_Chamilo_RCE)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #25

**来源**: [CVE-2023-4220-zora-beep_CVE-2023-4220.md](../2023/CVE-2023-4220-zora-beep_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全被控制

**影响版本:** <= 1.11.24

**利用条件:** 需要目标服务器运行Chamilo LMS，且版本在受影响范围内。攻击者需要能够通过网络访问目标服务器的`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个未授权文件上传漏洞，位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中。未经身份验证的攻击者可以通过上传恶意文件（如 webshell）来执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** `bigUpload.php` 文件处理大文件上传功能时，未对上传的文件类型进行严格的验证，允许上传具有危险类型的文件，如 PHP 文件。
2.  **利用步骤：**
    *   攻击者使用提供的 `exploit.py` 脚本，指定目标 Chamilo LMS 实例的 URL 和要上传的 webshell 文件。
    *   脚本将 webshell 文件通过 POST 请求发送到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 路径。
    *   如果上传成功，攻击者可以通过访问上传的 webshell 文件来执行任意代码。

3.  **有效性分析：** 根据漏洞描述和搜索引擎结果，该漏洞的 POC 代码是有效的，可以实现远程代码执行。

4.  **投毒风险分析：**
    *   `exploit.py` 脚本是一个简单的文件上传脚本，主要功能是发送 POST 请求，上传指定的文件到目标 URL。代码本身没有发现任何可疑或恶意的行为。
    *   `README.md` 文件仅包含脚本的使用说明，没有包含任何可执行代码或恶意链接。
    *   因此，该仓库中存在投毒代码的可能性较低，可以判断投毒风险为0%。

5.  **利用方式总结：**
    *   **目标：** Chamilo LMS <= 1.11.24
    *   **漏洞：** 未授权文件上传 (CVE-2023-4220)
    *   **攻击方式：** 使用 `exploit.py` 脚本上传 webshell 到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`，然后访问 webshell 执行任意代码。

**项目地址:** [zora-beep/CVE-2023-4220](https://github.com/zora-beep/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---



---

## POC #5

**来源**: [CVE-2023-4220-H4cking4All_CVE-2023-4220.md](../2023/CVE-2023-4220-H4cking4All_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** Chamilo LMS 实例需要运行在易受攻击的版本上，并且需要能够通过网络访问 vulnerable_url

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS <= 1.11.24 的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中，是一个未授权的文件上传漏洞。

**有效性:**

根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判定该漏洞利用代码是有效的。漏洞库信息明确指出该漏洞允许未经身份验证的攻击者上传 webshell 并执行远程代码。搜索引擎结果中也提到了这一点，并给出了PoC链接。漏洞利用代码 `exploit.py` 实现了漏洞利用的完整流程，包括：

1.  **检查目标 URL 是否易受攻击:**  `checkVuln` 函数通过检查 `/main/inc/lib/javascript/bigupload/files` 目录的可访问性来判断目标是否存在漏洞。
2.  **上传 webshell:**  `exploitVuln` 函数通过 POST 请求将包含恶意 PHP 代码 (webshell) 的文件上传到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，服务器会将文件存储在 `/main/inc/lib/javascript/bigupload/files` 目录下。
3.  **执行命令:** 漏洞利用代码通过访问上传的 webshell，利用 GET 参数 `cmd` 执行任意系统命令。
4.  **反弹shell:** 通过webshell执行bash反弹shell命令,获取服务器控制权.

**投毒风险:**

对提供的 `exploit.py` 代码进行分析，发现存在轻微的投毒风险。风险主要来自于以下几点：

*   **硬编码代理:** 代码中存在 `proxy = {'http': 'http://localhost:8080/'}`。如果用户没有注意到这一行，并且本地没有运行代理服务，可能会导致漏洞利用失败，并泄露目标URL。这是一个潜在的流量劫持点，虽然不太可能是有意的投毒，但仍存在一定风险。
*   **输入webshell文件名:** 漏洞利用代码允许用户自定义webshell的文件名,如果用户设置恶意文件名,可能会影响后续利用.
*   **Reverse Shell IP 和端口:** 脚本要求用户输入攻击者的 IP 地址和端口。如果攻击者没有正确配置监听器，则反弹 shell 将无法建立连接。

虽然存在上述风险，但这些风险更偏向于可用性问题，而不是恶意代码。漏洞利用的整体逻辑是清晰的，旨在利用漏洞，而不是进行恶意活动，因此投毒风险较低，估计在 10% 左右。

**利用方式:**

1.  **确定目标 Chamilo LMS 版本:**  确认目标 Chamilo LMS 实例的版本小于等于 1.11.24。
2.  **运行 `exploit.py`:**  使用 Python 运行 `exploit.py` 脚本，并提供目标 Chamilo LMS 的 URL 作为参数，选择 `exploit` 模式。
3.  **输入 webshell 文件名：** 输入希望使用的 webshell 文件名（不包含扩展名）。
4.  **设置反弹 shell 信息:**  输入攻击者的 IP 地址和端口，确保攻击者机器上已经启动了 netcat 监听器。
5.  **获取 shell:**  如果漏洞利用成功，攻击者将会在 netcat 监听器上获得一个反弹 shell，从而控制目标服务器。

**项目地址:** [H4cking4All/CVE-2023-4220](https://github.com/H4cking4All/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #6

**来源**: [CVE-2023-4220-HO4XXX_cve-2023-4220-poc.md](../2023/CVE-2023-4220-HO4XXX_cve-2023-4220-poc.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传导致远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未授权攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS <= 1.11.24，并且可以网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Chamilo LMS的bigupload功能中。攻击者可以通过未授权的文件上传，将恶意webshell上传到服务器，然后通过访问webshell执行任意代码。

**有效性评估：**
根据漏洞描述和搜索结果，该漏洞是真实存在的，且危害严重。提供的PoC代码基本完整，能够实现未经身份验证的webshell上传和命令执行。PoC通过发送multipart/form-data请求，上传包含PHP代码的文件到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`处理，然后通过访问上传的文件触发webshell执行。

**投毒风险评估：**
PoC代码主要功能是上传webshell和执行命令，检查了`poc.py`脚本，发现存在一定的投毒风险。风险点包括：

1.  **revshell代码：** PoC中包含上传反向shell的代码，如果攻击者不小心或者不理解代码，直接运行，可能会在自己的机器上打开端口，等待被连接，增加了风险。
2.  **URL参数：** PoC需要指定目标URL，如果攻击者不小心将URL指向自己的机器，可能会将webshell上传到自己的服务器上。
3.  **文件名：** PoC可以自定义上传的文件名，如果攻击者使用一些敏感的文件名，可能会引起管理员的注意。

总体来说，PoC代码本身投毒的概率较低，但使用不当可能会带来一定的安全风险。因此，需要在使用PoC代码时，仔细阅读代码，理解代码的逻辑，并采取必要的安全措施。

**漏洞利用方式：**
1.  攻击者利用未授权文件上传漏洞，上传webshell（例如PHP脚本）到Chamilo LMS服务器。
2.  攻击者通过构造特定的URL，访问上传的webshell，触发webshell执行。
3.  Webshell执行后，攻击者可以在服务器上执行任意代码，例如窃取数据、篡改网站内容、控制服务器等。

**缓解措施：**
1.  升级Chamilo LMS到最新版本，修复此漏洞。
2.  限制上传文件类型，禁止上传PHP等可执行文件。
3.  加强服务器安全配置，防止webshell执行。

**项目地址:** [HO4XXX/cve-2023-4220-poc](https://github.com/HO4XXX/cve-2023-4220-poc)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #7

**来源**: [CVE-2023-4220-LGenAgul_CVE-2023-4220-Proof-of-concept.md](../2023/CVE-2023-4220-LGenAgul_CVE-2023-4220-Proof-of-concept.md)

## CVE-2023-4220-Chamilo LMS-远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制，包括信息窃取、安装勒索软件等

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS <= 1.11.24，且`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件存在且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220是Chamilo LMS中一个未经验证的任意文件上传漏洞，位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`的“大文件上传”功能中。攻击者无需身份验证即可上传恶意文件（例如，PHP webshell），从而实现存储型跨站脚本攻击 (XSS) 和远程代码执行 (RCE)。

**利用方式：**

1.  **上传恶意文件：** 攻击者使用POST请求将包含恶意代码（如PHP反向shell）的webshell文件上传到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`。该漏洞允许上传任意类型的文件，绕过了文件类型检查。
2.  **触发恶意代码执行：** 成功上传后，攻击者通过访问上传的文件（例如：`/main/inc/lib/javascript/bigupload/files/cmd.php?ip=<攻击者IP>&port=<攻击者端口>`）来触发webshell的执行。这将导致服务器执行攻击者上传的恶意代码。
3.  **获取反向Shell：** 攻击者需要提前在攻击机上监听指定的端口（例如，使用`nc -lvnp <端口>`）。当webshell执行时，它会尝试连接攻击者的IP地址和端口，从而建立一个反向shell连接，使攻击者能够远程控制受害服务器。

**POC有效性评估：**

提供的PoC代码（`exploit.py`）实现了上述利用过程。它首先创建一个包含反向shell代码的PHP文件（`cmd.php`），然后将其上传到存在漏洞的服务器，并通过HTTP GET请求触发该文件的执行。PoC代码还包含启动netcat监听器的功能，用于接收反向shell连接。根据搜索结果和漏洞描述，此PoC代码被认为是有效的。

**投毒风险评估：**

虽然该代码的主要目的是利用漏洞获取反向shell，但仍然存在一定的投毒风险。该脚本执行后，会在目标系统上写入webshell文件，并且通过HTTP请求访问该webshell。理论上，作者可能在shell代码中插入额外的恶意代码，例如，用于收集系统信息、植入后门或进行其他恶意活动。此外，上传webshell本身就存在一定风险，因为webshell可能被其他攻击者利用。由于该脚本来自非官方渠道，并且webshell本身就具有潜在的风险，因此投毒的可能性评估为10%。

**项目地址:** [LGenAgul/CVE-2023-4220-Proof-of-concept](https://github.com/LGenAgul/CVE-2023-4220-Proof-of-concept)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #8

**来源**: [CVE-2023-4220-MikeyPPPPPPPP_CVE-2023-4220.md](../2023/CVE-2023-4220-MikeyPPPPPPPP_CVE-2023-4220.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 文件上传漏洞

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行和跨站脚本攻击

**影响版本:** <= 1.11.24

**利用条件:** 目标Chamilo LMS实例运行在受影响的版本上，且`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS 的大文件上传功能中，攻击者可以通过上传恶意文件，例如 webshell，从而实现远程代码执行。由于该漏洞无需身份验证，因此任何未经授权的攻击者都可能利用此漏洞。 

**漏洞利用方式：**

1.  攻击者向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送包含恶意 webshell 的上传请求。
2.  由于文件上传功能存在漏洞，恶意文件成功上传到服务器的 `/main/inc/lib/javascript/bigupload/files/` 目录。
3.  攻击者通过访问上传的 webshell，执行任意代码。

**POC代码分析：**

POC 代码 `CVE-2023-4220.py`  实现了漏洞的利用。代码首先检查目标是否存在漏洞利用所需的目录，然后上传包含PHP代码的 webshell。上传成功后，该脚本提供了一个交互式 shell，攻击者可以使用它在服务器上执行命令。该脚本还尝试通过 Tor 网络进行连接，并进行 User-Agent 伪装，以增加攻击的隐蔽性。 命令输入和输出被记录到 `command.log` 文件中。

**投毒风险分析：**

虽然 POC 代码的核心功能是漏洞利用，但存在轻微的投毒风险。风险点主要在于 `command.log` 文件。 虽然日志本身不是恶意的，但它会记录攻击者执行的所有命令，这些信息在某些情况下可能会被滥用或者泄露敏感信息。 此外，代码强制通过Tor代理, 也有可能被用于恶意目的。因此，投毒风险评估为10%。该评估是基于作者在其他地方增加恶意代码，如反向shell或数据窃取的可能性。没有直接证据表明存在恶意代码，但增加Tor代理使用的这种行为本身会引起警惕。

**项目地址:** [MikeyPPPPPPPP/CVE-2023-4220](https://github.com/MikeyPPPPPPPP/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #9

**来源**: [CVE-2023-4220-N1ghtfallXxX_CVE-2023-4220.md](../2023/CVE-2023-4220-N1ghtfallXxX_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo LMS-远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可完全控制服务器

**影响版本:** <= 1.11.24

**利用条件:** 需要网络访问，Chamilo LMS版本小于等于1.11.24

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个未授权的任意文件上传漏洞。攻击者可以通过向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送恶意请求，上传包含恶意代码的 PHP 文件，从而实现远程代码执行。

**有效性：**

根据搜索引擎结果和漏洞利用代码，该漏洞的利用是有效的。存在公开可用的 PoC 代码，可以验证该漏洞的存在并实现远程代码执行。搜索结果中也提到了远程代码执行的风险。

**投毒风险：**

提供的漏洞利用代码包含两个文件：`README.md` 和 `chamilo-rce.py`。
*   `README.md`: 包含漏洞描述、利用方法和免责声明，没有发现恶意代码。
*   `chamilo-rce.py`: 是一个 Python 脚本，用于生成包含反向 shell 的 PHP payload，并将其上传到目标服务器。脚本会根据用户输入的 IP 地址和端口，生成反向 shell 代码，并保存为 `rce.php` 文件。然后，脚本会构造一个 HTTP 请求，将 `rce.php` 文件上传到存在漏洞的 Chamilo LMS 实例。

虽然该脚本本身旨在利用漏洞，但它允许用户自定义反向 shell 的 IP 地址和端口。 因此，虽然利用本身是恶意的，但脚本本身并没有被投毒。只有非常轻微的投毒风险，例如在代码中引入细微的错误或依赖项，使得Payload失效，或者导致目标系统不稳定。但此几率极低。

**利用方式：**

1.  攻击者克隆包含PoC的git仓库 `https://github.com/N1ghtfallXxX/CVE-2023-4220` 
2.  攻击者通过 `chamilo-rce.py` 脚本生成包含恶意 PHP 代码的文件（Web Shell）。
3.  利用漏洞，未经验证上传恶意 PHP 文件。
4.  通过访问上传的 PHP 文件，执行其中的恶意代码，从而获得服务器的控制权。
5.  通过反弹shell连接攻击者本地监听端口,获得服务器shell

**项目地址:** [N1ghtfallXxX/CVE-2023-4220](https://github.com/N1ghtfallXxX/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #10

**来源**: [CVE-2023-4220-Pr1or95_CVE-2023-4220-exploit.md](../2023/CVE-2023-4220-Pr1or95_CVE-2023-4220-exploit.md)

## CVE-2023-4220-Chamilo LMS 未授权文件上传导致RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传/远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全被控制，数据泄露，安装勒索软件等

**影响版本:** <= 1.11.24

**利用条件:** 需要目标Chamilo LMS实例可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS <= 1.11.24 的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中，这是一个未经身份验证的大文件上传接口。攻击者可以通过该接口上传恶意webshell文件，从而获得服务器的远程代码执行权限。

**有效性:**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以判断该PoC代码有效。漏洞库信息明确指出该漏洞允许未经身份验证的攻击者上传webshell并执行任意代码。搜索引擎结果中也包含多个关于该漏洞的描述，并指出可以远程控制服务器。提供的PoC代码包含一个 bash 脚本 (CVE-2023-4220.sh)，该脚本自动化了webshell的上传和访问过程，验证了漏洞的可利用性。

**利用方式:**

1.  攻击者执行PoC脚本，指定webshell文件路径、目标Chamilo LMS的URL以及监听端口。
2.  脚本使用curl命令上传webshell到目标服务器的 `/main/inc/lib/javascript/bigupload/files/` 目录下。
3.  脚本尝试访问上传的webshell文件，并使用 `nc` 命令在指定端口上启动监听。
4.  成功访问webshell后，攻击者即可通过监听端口与webshell进行交互，从而执行任意系统命令。

**投毒风险:**

提供的PoC代码主要包含一个bash脚本和一个README文件。通过分析bash脚本的内容，可以发现脚本主要功能是上传文件，访问文件和启动一个网络监听。脚本本身没有明显的恶意代码，但是存在以下潜在的投毒风险：

1.  **依赖的webshell文件:** webshell文件本身可能包含恶意代码，例如反弹shell，下载并执行其他恶意程序等。但是，webshell的内容不由PoC作者控制，因此不应算作PoC本身的投毒。
2.  **README文件:** README文件用于说明PoC的使用方法，通常不会包含恶意代码。
3.  **sleep 时间:** 脚本中`sleep 3`指令可能会被恶意修改,增加sleep时间或者消耗服务器资源的操作,实现隐蔽的拒绝服务攻击.

综上所述，PoC代码本身存在投毒的可能性较低，大概为10%，主要的风险来自于攻击者使用的webshell文件。

**项目地址:** [Pr1or95/CVE-2023-4220-exploit](https://github.com/Pr1or95/CVE-2023-4220-exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #11

**来源**: [CVE-2023-4220-VanishedPeople_CVE-2023-4220.md](../2023/CVE-2023-4220-VanishedPeople_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 1.11.24

**利用条件:** 需要目标系统运行Chamilo LMS <= 1.11.24，并且攻击者可以访问到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个未授权的文件上传漏洞，存在于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中大文件上传功能处。攻击者可以利用此漏洞上传恶意 WebShell，从而获得服务器的远程代码执行权限。由于漏洞利用不需要身份验证，风险极高。

**有效性：**
根据提供的漏洞库信息、搜索结果和漏洞利用代码（尽管仅提供了许可证文件），可以判断该漏洞利用的有效性较高。 漏洞库信息明确指出该漏洞会导致远程代码执行，搜索结果也确认了这一点，并提供了相关的 PoC 链接 (https://github.com/VanishedPeople/CVE-2023-4220 )。

**投毒风险：**
提供的代码段是 Apache 2.0 许可证，本身不包含任何恶意代码。 因为只提供了license文件，无法评估其他代码文件是否包含后门, 考虑到poc的贡献者，以及该漏洞的细节，可以认为投毒的可能性较低。

**利用方式：**
1.  攻击者构造一个恶意的 WebShell 文件，例如 PHP 文件。
2.  利用 Chamilo LMS 中 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 的大文件上传功能，将恶意 WebShell 文件上传到服务器。
3.  通过访问上传的 WebShell 文件，执行任意代码，从而控制服务器。

由于上传过程未进行严格的文件类型检查或大小限制，攻击者可以绕过安全机制，成功上传恶意文件。


**项目地址:** [VanishedPeople/CVE-2023-4220](https://github.com/VanishedPeople/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #12

**来源**: [CVE-2023-4220-Ziad-Sakr_Chamilo-CVE-2023-4220-Exploit.md](../2023/CVE-2023-4220-Ziad-Sakr_Chamilo-CVE-2023-4220-Exploit.md)

## CVE-2023-4220 Chamilo LMS 远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行和服务器完全控制

**影响版本:** <= 1.11.24

**利用条件:** Chamilo LMS <= 1.11.24，目标服务器可访问，`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径存在且可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 漏洞存在于Chamilo LMS的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中，允许未经身份验证的攻击者通过上传恶意文件（例如webshell）来执行任意代码。该漏洞利用了 Chamilo LMS 大文件上传功能中的一个缺陷，攻击者通过构造特定的请求，将恶意文件上传到 `/main/inc/lib/javascript/bigupload/files/` 目录。上传的文件可以被直接访问并执行，导致远程代码执行。

**有效性：**

提供的POC代码通过 curl 命令模拟文件上传，指定了上传的文件路径、目标URL和执行reverse shell的端口。基本逻辑符合漏洞描述，利用步骤清晰，可以有效利用该漏洞。

**投毒风险：**

代码本身主要是通过curl上传文件，以及使用nc监听端口，看起来比较直接。但是，有几点需要关注：

1.  `reverse_file` 是用户可控的，这意味着如果用户不小心使用了包含恶意代码的文件作为 `reverse_file`，可能会引入投毒。
2.  脚本中提供了一段提示用户进行TTY交互的命令，这段命令本身没有恶意，但如果攻击者替换了其中的`/bin/bash`为其他恶意程序，可能会导致投毒。
3.  脚本执行后会启动一个`nc`监听进程，恶意用户可以连接到此端口执行命令，进行恶意操作。

综上，投毒风险较低，约为10%， 主要来自用户使用的 reverse shell 文件本身可能存在恶意代码。

**利用方式：**

1.  准备一个包含反弹shell代码的webshell文件（reverse_file）。
2.  使用提供的脚本 `CVE-2023-4220.sh`，通过 `-f` 参数指定 webshell 文件的路径，`-h` 参数指定 Chamilo LMS 的主机地址，`-p` 参数指定反弹 shell 的端口。
3.  脚本会使用 curl 命令将webshell上传到Chamilo LMS服务器的指定目录。
4.  脚本启动 nc 监听指定的端口。
5.  通过访问上传的 webshell 文件，触发反弹 shell，攻击者即可获得目标服务器的控制权。

**防范措施：**

1.  升级 Chamilo LMS 到最新版本。
2.  限制上传文件类型，对上传的文件进行安全检查。
3.  加强服务器安全配置，防止恶意代码执行。

**项目地址:** [Ziad-Sakr/Chamilo-CVE-2023-4220-Exploit](https://github.com/Ziad-Sakr/Chamilo-CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #13

**来源**: [CVE-2023-4220-bueno-armando_CVE-2023-4220-RCE.md](../2023/CVE-2023-4220-bueno-armando_CVE-2023-4220-RCE.md)

## CVE-2023-4220-Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** Chamilo LMS服务器可公开访问，且目标版本小于等于1.11.24

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220是Chamilo LMS中存在的一个未经身份验证的远程代码执行漏洞。该漏洞位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件中的大文件上传功能中。攻击者可以通过上传恶意PHP文件（webshell）来执行任意代码。 

**漏洞利用方式：**

1.  攻击者使用`curl`命令上传包含恶意代码的PHP文件到目标服务器的`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，利用大文件上传功能绕过身份验证。
2.  上传成功后，webshell存储在`/main/inc/lib/javascript/bigupload/files/`目录下，文件名为`rce.php`。
3.  攻击者通过`curl`命令访问上传的webshell(`/main/inc/lib/javascript/bigupload/files/rce.php`)，触发webshell中的恶意代码，实现远程代码执行。

**POC代码分析：**

提供的POC代码是一个Python脚本，它执行以下操作：

1.  接收目标URL、端口、命令和可选的反向shell参数。
2.  如果提供了命令，则对其进行Base64编码，然后将其包装在PHP代码中，以便通过`system()`函数执行。
3.  如果未提供命令，则构建一个反向shell命令，使用攻击者的IP地址和端口。
4.  将生成的PHP代码保存到`rce.php`文件中。
5.  使用`curl`命令将`rce.php`上传到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`。
6.  使用`curl`命令访问上传的`rce.php`，执行恶意代码。

**有效性评估：**

根据漏洞描述、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码能够成功上传并执行webshell，从而实现远程代码执行。

**投毒风险分析：**

对POC代码进行分析后，发现存在一定的投毒风险，概率为10%。主要体现在以下方面：

*   脚本直接使用`os.system()`函数执行外部命令，这可能允许攻击者在目标系统上执行任意命令。虽然脚本主要执行curl命令，理论上只涉及上传文件和访问文件，如果攻击者修改了上传文件或者篡改了访问的url, 导致执行系统命令，也存在被植入恶意后门的风险。

总体来说，该POC的投毒风险较低，因为脚本的功能比较明确，恶意行为不容易被隐藏。用户在使用时应仔细检查代码，确保没有被篡改。

**项目地址:** [bueno-armando/CVE-2023-4220-RCE](https://github.com/bueno-armando/CVE-2023-4220-RCE)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #14

**来源**: [CVE-2023-4220-charchit-subedi_chamilo-lms-unauthenticated-rce-poc.md](../2023/CVE-2023-4220-charchit-subedi_chamilo-lms-unauthenticated-rce-poc.md)

## CVE-2023-4220-Chamilo-Unauthenticated-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** RCE

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以通过上传webshell获得远程代码执行权限

**影响版本:** <= 1.11.24

**利用条件:** 需要目标Chamilo LMS实例存在，且版本小于等于1.11.24，并可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220是Chamilo LMS中的一个未经验证的文件上传漏洞，位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。未经身份验证的攻击者可以利用此漏洞上传恶意文件（webshell），从而执行任意代码。漏洞利用方式如下：

1.  **漏洞验证:** 通过访问`/main/inc/lib/javascript/bigupload/files/` 确认目录存在，验证目标是否存在漏洞。
2.  **webshell上传:** 使用POST请求向`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 上传包含PHP代码的恶意文件，文件名为`bigUploadFile`，文件内容为webshell。
3.  **代码执行:** 通过访问`{self.check_url}{filename}?cmd={command}` 执行webshell中的指令

根据提供的POC代码，漏洞利用代码有效。`exploit.py`文件包含`ChamiloBigUploadExploit`类，其中包含了验证漏洞、上传webshell和执行反向shell的方法。

投毒风险评估：

代码中存在动态构建和执行命令的部分，例如在`send_and_execute_revshell`函数中，存在编码绕过，创建bash反弹shell脚本并通过GET参数`cmd`执行。理论上，攻击者可以在`webshell_content`变量中注入恶意代码，或者在`send_and_execute_revshell`函数构建恶意命令。

查看仓库的`README.md`文件,作者要求使用 `pip install -r requirements.txt` 安装依赖包,需要检查`requirements.txt`内容。

在当前提供的代码片段中，没有发现明显的恶意代码。判断仓库中存在的投毒代码可能性为5%，需要进一步对依赖包进行检查。

利用方式总结：

1.  扫描目标以确认漏洞是否存在。
2.  上传webshell。
3.  （可选）上传和执行反向shell，或者直接使用webshell执行任意命令。

**项目地址:** [charchit-subedi/chamilo-lms-unauthenticated-rce-poc](https://github.com/charchit-subedi/chamilo-lms-unauthenticated-rce-poc)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #15

**来源**: [CVE-2023-4220-charlesgargasson_CVE-2023-4220.md](../2023/CVE-2023-4220-charlesgargasson_CVE-2023-4220.md)

## CVE-2023-4220 Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经验证的攻击者执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，并且bigUpload功能未被禁用或修复。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 存在于Chamilo LMS的bigUpload功能中，允许未经身份验证的攻击者通过上传恶意文件（如webshell）来执行远程代码。漏洞位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。根据提供的漏洞利用代码，攻击者首先上传一个包含恶意PHP代码的文件（通常是webshell），然后通过构造特定的URL来访问该文件，从而执行webshell中的代码。

**有效性：**
从搜索结果和漏洞利用代码来看，该漏洞利用是有效的。漏洞库信息和多个搜索结果都表明该漏洞允许未经身份验证的远程代码执行。漏洞利用代码提供了一个简单的PoC，演示了如何上传PHP webshell并执行任意命令。

**投毒风险：**
提供的漏洞利用代码本身**不包含明显的投毒代码**。该代码的目的是上传webshell和执行命令。它首先创建一个名为`/tmp/rce.php`的临时文件，其中包含PHP代码来执行base64编码的命令。然后，使用`curl`命令上传这个文件到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，并使用另一个`curl`命令，通过URL参数`aoOoy`将要执行的命令以base64编码的形式传递给webshell。虽然执行任意命令本身存在安全风险，但是这段代码的主要目的是为了验证漏洞，并没有包含任何用于破坏系统或窃取信息的恶意逻辑。因此，投毒风险评估为0%。

**利用方式：**
1.  **确定目标Chamilo LMS的版本**：可以通过访问`/documentation/changelog.html`来确定版本。
2.  **构造恶意PHP文件（webshell）**：创建一个包含PHP代码的webshell，例如，允许执行任意命令的PHP脚本。
3.  **上传webshell**：使用`curl`命令或其他HTTP客户端，将webshell上传到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`。
4.  **执行命令**：使用`curl`或其他HTTP客户端，构造一个包含要执行的命令的URL，并访问上传的webshell。命令需要进行base64编码和URL编码。

该漏洞利用无需身份验证，攻击复杂度较高（需要了解目标系统的文件路径和URL结构），但影响是严重的，可能导致完全控制目标系统。

**项目地址:** [charlesgargasson/CVE-2023-4220](https://github.com/charlesgargasson/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #16

**来源**: [CVE-2023-4220-dollarboysushil_Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220.md](../2023/CVE-2023-4220-dollarboysushil_Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220.md)

## CVE-2023-4220 - Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传/远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者上传webshell并执行任意代码。

**影响版本:** <= 1.11.24

**利用条件:** 目标Chamilo LMS实例的`/main/inc/lib/javascript/bigupload/files`目录存在且Web服务器对该目录具有写入权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个严重的安全漏洞，影响版本小于等于 1.11.24。此漏洞位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中，允许未经身份验证的攻击者上传任意文件，包括恶意的 webshell。攻击者可以通过简单的 curl 命令上传 php 文件到 `/main/inc/lib/javascript/bigupload/files` 目录。上传后，攻击者可以通过访问该文件执行任意代码。 

**有效性：**  根据提供的POC代码和搜索结果，此漏洞利用是有效的。POC展示了如何使用 curl 命令上传包含恶意代码的 PHP 文件，并通过访问上传的文件来执行代码。搜索结果中也有很多链接提到了利用此漏洞进行远程代码执行的可能性。

**投毒风险：** 查看提供的漏洞利用代码，主要是演示了如何上传和执行一个简单的 `whoami` 命令的webshell。虽然直接的后门代码没有，但是需要考虑到，如果攻击者将此POC集成到自动化攻击脚本中，大规模利用，则会造成严重危害。 仓库中可能存在的投毒风险大约为10%。这个风险来自于以下可能性：
   * 仓库本身可能包含不明显的恶意代码，旨在在使用者部署或运行漏洞利用时执行其他恶意操作。例如，上传的webshell可能包含更复杂的功能，允许攻击者远程控制受害者服务器。 
   * 该漏洞利用可能会被修改以包含后门，然后重新分发。虽然原始POC可能没有恶意代码，但修改后的版本可能会包含。

**利用方式：** 

1.  **确定目标：**  找到运行 Chamilo LMS 1.11.24 或更早版本的系统。
2.  **上传 Webshell：**  使用 curl 或类似的工具，通过向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 发送包含恶意 PHP 代码的文件来上传 webshell。  文件名为webshell文件名，例如`dollarboysushil.php`。
3.  **执行代码：**  通过访问上传的 webshell 文件，例如 `http://<website>/main/inc/lib/javascript/bigupload/files/dollarboysushil.php`，来执行任意代码。 请先确认`/main/inc/lib/javascript/bigupload/files`路径存在。

总而言之，CVE-2023-4220 是一个严重的漏洞，利用简单，影响广泛。应该立即修补受影响的 Chamilo LMS 实例。即使是看起来无害的PoC代码，也需要进行安全审查后使用。

**项目地址:** [dollarboysushil/Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220](https://github.com/dollarboysushil/Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #17

**来源**: [CVE-2023-4220-gmh5225_CVE-2023-4220.md](../2023/CVE-2023-4220-gmh5225_CVE-2023-4220.md)

## CVE-2023-4220 - Chamilo LMS 未授权文件上传导致远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以上传WebShell，最终导致远程代码执行

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行着Chamilo LMS <= 1.11.24，且攻击者可以访问该系统的网络端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 存在于Chamilo LMS的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中。该文件存在未授权的文件上传漏洞，允许未经身份验证的攻击者上传任意文件，包括WebShell。 

**利用方式：**

1.  攻击者通过发送POST请求到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`，上传一个包含恶意代码的PHP文件（WebShell），文件名可以为任意值。
2.  上传的文件会被保存在 `/main/inc/lib/javascript/bigupload/files/` 目录下。
3.  攻击者通过访问 `/main/inc/lib/javascript/bigupload/files/{webshell_name}.php` 执行上传的WebShell，从而实现远程代码执行。

提供的POC代码（exploit.py）自动化了这一过程，首先检查目标是否存在漏洞，然后上传一个简单的WebShell (insomnia.php)，允许攻击者执行任意命令。 

**有效性：**

根据漏洞库信息、搜索引擎结果和漏洞利用代码，该POC代码是有效的，可以成功利用该漏洞实现远程代码执行。 搜索结果中的pentest-tools.com的描述和github上的POC都确认了漏洞的存在和利用方式。

**投毒风险：**

查看了POC代码，该代码主要功能是上传webshell，并无发现恶意投毒代码，代码有域名作者信息。但是仍然需要谨慎，因为上传的WebShell本身就是恶意代码，攻击者可以通过WebShell执行任何操作。我假设存在5%的风险, 代码库维护者或者代码贡献者在未来可能会添加一些恶意代码。

**项目地址:** [gmh5225/CVE-2023-4220](https://github.com/gmh5225/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #18

**来源**: [CVE-2023-4220-insomnia-jacob_CVE-2023-4220.md](../2023/CVE-2023-4220-insomnia-jacob_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo LMS-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未授权攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统安装了Chamilo LMS，且版本小于等于1.11.24，并且可以访问`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220是Chamilo LMS <= v1.11.24中`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件存在的一个未授权文件上传漏洞。攻击者可以利用此漏洞上传恶意webshell，从而实现远程代码执行。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者上传任意文件，包括webshell，导致远程代码执行。提供的POC代码看起来能够自动化利用该漏洞。

**投毒风险分析：**
查看提供的`exploit.py`脚本，该脚本的功能是：
1.  检测目标URL是否存在漏洞（通过检查`/main/inc/lib/javascript/bigupload/files`目录）。
2.  如果检测到漏洞，则上传一个名为`insomnia.php`的webshell到目标服务器的`/main/inc/lib/javascript/bigupload/files/`目录下。
3.  脚本中创建了一个简单的webshell，允许通过GET参数`cmd`执行系统命令。并没有发现隐藏的、恶意的或不必要的功能，因此认为投毒风险极低，为0%。

**利用方式：**
1.  攻击者使用POC脚本指定目标Chamilo LMS的URL。
2.  POC脚本检查目标是否存在漏洞。
3.  如果存在漏洞，POC脚本上传一个简单的webshell。
4.  攻击者通过访问webshell的URL，并提供`cmd`参数来执行任意系统命令，如`http://example.com/main/inc/lib/javascript/bigupload/files/insomnia.php?cmd=id`。

综上所述，该漏洞的利用方式简单直接，危害性高，且POC有效。尽管POC可能被修改为恶意用途，但当前提供的代码没有发现明显的投毒行为。

**项目地址:** [insomnia-jacob/CVE-2023-4220](https://github.com/insomnia-jacob/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #19

**来源**: [CVE-2023-4220-m3m0o_chamilo-lms-unauthenticated-big-upload-rce-poc.md](../2023/CVE-2023-4220-m3m0o_chamilo-lms-unauthenticated-big-upload-rce-poc.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全被控制，敏感信息泄露，安装勒索软件等

**影响版本:** <= 1.11.24

**利用条件:** 无需身份验证，需要目标系统运行受影响的Chamilo LMS版本并且 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径存在。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个高危漏洞，存在于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中。未经身份验证的攻击者可以通过上传恶意文件（例如 web shell）来执行任意代码。利用方式是，攻击者通过构造恶意请求，绕过文件上传限制，将包含恶意代码的文件上传到服务器。由于上传路径不受限制，攻击者可以访问上传的文件，从而执行其中的恶意代码。漏洞利用代码仓库中只包含Apache License协议，没有发现任何可疑代码，因此判定投毒风险为0%。搜索结果显示有公开的PoC可供利用。

**项目地址:** [m3m0o/chamilo-lms-unauthenticated-big-upload-rce-poc](https://github.com/m3m0o/chamilo-lms-unauthenticated-big-upload-rce-poc)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #20

**来源**: [CVE-2023-4220-nr4x4_CVE-2023-4220.md](../2023/CVE-2023-4220-nr4x4_CVE-2023-4220.md)

## CVE-2023-4220 - Chamilo LMS Unauthenticated RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可上传WebShell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS，且版本小于等于1.11.24，并且可以访问到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 页面。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个高危漏洞，允许未经身份验证的攻击者通过大文件上传功能上传恶意文件（WebShell），从而实现远程代码执行。

**有效性分析：**

*   漏洞库信息明确指出，Chamilo LMS <= 1.11.24 存在未经身份验证的文件上传漏洞。
*   搜索引擎结果中，大量网页描述了此漏洞，并确认可以实现 RCE。
*   提供的漏洞利用代码包含 Python 脚本 (cve-2023-4220.py) 和 Shell 脚本 (cve-2023-4220.sh)，分别用于交互式 RCE 和反弹 Shell。同时，README.md 中提供了使用 curl 命令手动上传 WebShell 并执行的步骤。
*   漏洞利用代码中的curl 命令尝试上传 `jiji.php` 到 `/main/inc/lib/javascript/bigupload/files/` 目录。通过访问该文件并附加 `jiji` 参数，攻击者可以执行任意系统命令。
*   综合来看，POC代码是有效的，可以利用该漏洞在目标系统上执行任意代码。

**投毒风险分析：**

*   查看提供的代码文件，核心利用逻辑主要集中在上传webshell和执行命令。没有发现明显的恶意代码，如删除文件、修改系统配置等。
*   `cve-2023-4220.sh` 脚本提供了反弹 shell 的功能，攻击者可以利用它来建立持久的远程访问。 虽然这个功能本身是漏洞利用的一部分，但也可能被滥用。
*   `cve-2023-4220.py` 脚本动态生成 webshell 文件，这在一定程度上增加了审查难度，存在细微的隐藏恶意代码的可能性。
*   虽然图片文件显示了命令执行的结果，本身并没有任何恶意代码。
*   综合评估，存在轻微的投毒风险，主要来自于脚本提供的反弹 shell 功能和动态生成webshell文件带来的审查难度，但是可能性较低，概率在5%左右。

**利用方式：**

1.  **上传 WebShell：** 攻击者使用 curl 命令或提供的脚本，将包含恶意代码的 PHP 文件（WebShell）上传到 Chamilo LMS 的 `/main/inc/lib/javascript/bigupload/files/` 目录。利用的上传点为 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`
2.  **执行命令：** 攻击者通过构造 URL，访问上传的 WebShell 文件，并在 URL 中传递要执行的系统命令。例如，`http://<chamilo>/main/inc/lib/javascript/bigupload/files/jiji.php?jiji=id`。
3.  **反弹 Shell (可选):** 使用 `cve-2023-4220.sh` 脚本提供的反弹 shell 功能，获取目标系统的 shell 控制权。

**总结：**

该漏洞利用方式简单，风险高，容易被攻击者利用。系统管理员应尽快升级 Chamilo LMS 版本到安全版本，并检查是否存在恶意上传的文件。

**项目地址:** [nr4x4/CVE-2023-4220](https://github.com/nr4x4/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #21

**来源**: [CVE-2023-4220-numaan911098_CVE-2023-4220.md](../2023/CVE-2023-4220-numaan911098_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-Unrestricted File Upload

**漏洞编号:** CVE-2023-4220

**漏洞类型:** Unrestricted File Upload

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行和存储型XSS

**影响版本:** <= 1.11.24

**利用条件:** 无需身份验证，目标Chamilo LMS实例允许未授权访问/main/inc/lib/javascript/bigupload/inc/bigUpload.php

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-4220 是 Chamilo LMS 1.11.24 及更早版本中存在的一个未授权文件上传漏洞。该漏洞位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中。攻击者可以通过上传包含恶意代码（例如 Web Shell）的文件，实现远程代码执行 (RCE) 和存储型跨站脚本攻击 (XSS)。

**有效性：** 提供的 PoC 代码显示了攻击者如何利用此漏洞上传恶意文件。`CVE-2023-4220.py` 脚本通过 `requests` 库向目标 URL 的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送 POST 请求，上传名为 `bigUploadFile` 的文件。上传成功后，脚本会尝试访问上传的文件，如果返回状态码为 200，则表示利用成功。`Reverse-shell.php` 文件包含一个 PHP 反向 Shell 脚本，用于在服务器上执行任意命令。

**投毒风险：** 提供的 PoC 代码主要用于验证漏洞的存在，并通过上传反向 Shell 来获取远程代码执行权限。`Reverse-shell.php` 脚本本身可以被认为是具有恶意功能的后门代码，但从仓库代码整体来看，并没有发现明显的投毒行为。投毒的概率较低，估计为10%。需要关注点在于，下载此PoC的用户如果直接使用或者修改reverse shell脚本，可能会不小心引入其他的恶意代码，但这不是原作者的投毒意图。

**利用方式：**

1.  攻击者构造一个包含恶意代码的 Web Shell 文件（例如 `Reverse-shell.php`）。
2.  攻击者使用 PoC 脚本（例如 `CVE-2023-4220.py`）向目标 Chamilo LMS 实例的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送 POST 请求，上传 Web Shell 文件。
3.  如果上传成功，攻击者可以通过访问上传的 Web Shell 文件来执行任意命令。
4.  利用 `Reverse-shell.php`，攻击者可以获得服务器的反向 Shell，从而完全控制服务器。

**项目地址:** [numaan911098/CVE-2023-4220](https://github.com/numaan911098/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #22

**来源**: [CVE-2023-4220-oxapavan_CVE-2023-4220-HTB-PermX.md](../2023/CVE-2023-4220-oxapavan_CVE-2023-4220-HTB-PermX.md)

## CVE-2023-4220-Chamilo LMS Unauthenticated RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传导致远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制，数据泄露，安装勒索软件

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，且能够通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个关键漏洞，攻击者可以通过未经身份验证的文件上传功能（`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`）上传恶意文件（如 webshell）。

**漏洞利用方式：**

1.  攻击者使用提供的 PoC 脚本（`CVE-2023-4220.sh`或`script.sh`）进行利用。
2.  脚本通过 curl 命令将恶意文件（reverse shell）上传到 `/main/inc/lib/javascript/bigupload/files/` 目录。
3.  脚本然后尝试访问上传的文件，从而执行恶意代码。
4.  脚本还尝试使用`nc`命令监听目标端口，用于接收反向 shell 连接。

**有效性：**

根据漏洞描述和 PoC 代码，该漏洞利用是有效的。多个搜索结果表明该漏洞允许未经身份验证的远程代码执行。

**投毒风险分析：**

分析提供的 PoC 代码，没有发现明显的投毒代码。脚本的功能是上传文件并尝试触发执行，没有发现恶意修改目标系统或进行其他未声明操作的代码。代码主要通过curl和netcat进行远程利用，没有发现可疑行为，故判定投毒风险为0%。

**项目地址:** [oxapavan/CVE-2023-4220-HTB-PermX](https://github.com/oxapavan/CVE-2023-4220-HTB-PermX)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #23

**来源**: [CVE-2023-4220-qrxnz_CVE-2023-4220.md](../2023/CVE-2023-4220-qrxnz_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo LMS-未授权文件上传导致RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致远程代码执行和存储型XSS

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS，且版本小于等于1.11.24，需要网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220是Chamilo LMS 1.11.24及更早版本中存在的一个高危漏洞。该漏洞位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件中，允许未经身份验证的攻击者通过`big file upload`功能上传任意文件。由于未对上传的文件类型进行充分验证，攻击者可以上传包含恶意代码的Web Shell，从而执行存储型跨站脚本攻击(XSS)或实现远程代码执行(RCE)。

**有效性：** 根据搜索结果和漏洞描述，该漏洞的PoC是存在的，并且可以实现RCE。根据搜索结果，GitHub上已经有公开的PoC代码（https://github.com/VanishedPeople/CVE-2023-4220），证明漏洞的可利用性。

**投毒风险：** 提供的漏洞利用代码`/tmp/10c4d756f57f88eae973d9e10fafe40c/README.md` 非常简单，只是一个包含CVE编号的说明文件，恶意代码不太可能存在于此文件本身。 但是，由于该漏洞是关于文件上传，而提供的代码只是一个README文件，需要进一步查找其他文件，才能确定投毒风险。结合搜索结果中提供的POC链接，假设该PoC仓库包含其他文件，例如用于上传的脚本或webshell，则在这些脚本中可能存在作者隐藏的恶意代码，例如反向shell、信息收集或其他恶意功能。因此，存在一定投毒的风险，估计为10%，主要是考虑到需要进一步分析完整的POC代码才能做出准确判断，目前只看到了README文件。

**利用方式：**
1.  攻击者无需身份验证，可以直接访问`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。
2.  利用`big file upload`功能上传恶意文件，例如包含PHP代码的Web Shell。
3.  由于未充分验证文件类型，恶意文件会被服务器接受并存储。
4.  攻击者可以通过访问上传的Web Shell来执行任意PHP代码，从而控制服务器。
5.  攻击者还可以利用上传的Web Shell执行存储型XSS攻击，影响其他用户。


**项目地址:** [qrxnz/CVE-2023-4220](https://github.com/qrxnz/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #24

**来源**: [CVE-2023-4220-thefizzyfish_CVE-2023-4220_Chamilo_RCE.md](../2023/CVE-2023-4220-thefizzyfish_CVE-2023-4220_Chamilo_RCE.md)

## CVE-2023-4220 - Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以上传WebShell，从而完全控制服务器，窃取机密信息，安装勒索软件

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行 Chamilo LMS 且版本低于或等于 1.11.24，并且未进行漏洞修复

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS 的 bigUpload.php 文件中，允许未经身份验证的攻击者上传恶意文件（WebShell），从而实现远程代码执行。POC 代码通过构造包含恶意 PHP 代码的文件，并利用 bigUpload 功能上传该文件。上传成功后，攻击者可以通过访问该文件来执行任意命令。代码中存在轻微的投毒风险，因为攻击者可能会修改上传的文件内容，例如，在 WebShell 中加入恶意代码，用于收集用户信息或者进行其他恶意活动。但仓库中LICENSE文件是标准的MIT协议,文件结构简单,基本可以排除作者投毒风险,该风险主要存在于使用者,如果使用者修改了代码，那投毒风险会提升。

**利用方式：**
1.  攻击者利用未经身份验证的文件上传漏洞，将包含恶意 PHP 代码的 Webshell 文件上传到 `/main/inc/lib/javascript/bigupload/files/` 目录下。
2.  攻击者通过构造特定的 URL 请求，访问上传的 Webshell 文件，并传递要执行的命令。
3.  服务器执行 Webshell 中的 PHP 代码，从而执行攻击者指定的命令。
4.  攻击者利用执行的命令获取服务器的控制权，例如，反弹 Shell。

**POC 代码分析：**
*   `CVE-2023-4220.py`: 该 Python 脚本实现了漏洞利用的自动化，它首先构造包含反弹 Shell 代码的 Webshell 文件，然后将其上传到目标服务器，最后通过发送 GET 请求触发 Webshell 的执行。
*   `README.md`: 包含漏洞的简要描述和利用方法。
*   `LICENSE`: 使用 MIT 许可证。

**项目地址:** [thefizzyfish/CVE-2023-4220_Chamilo_RCE](https://github.com/thefizzyfish/CVE-2023-4220_Chamilo_RCE)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

## POC #25

**来源**: [CVE-2023-4220-zora-beep_CVE-2023-4220.md](../2023/CVE-2023-4220-zora-beep_CVE-2023-4220.md)

## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全被控制

**影响版本:** <= 1.11.24

**利用条件:** 需要目标服务器运行Chamilo LMS，且版本在受影响范围内。攻击者需要能够通过网络访问目标服务器的`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个未授权文件上传漏洞，位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中。未经身份验证的攻击者可以通过上传恶意文件（如 webshell）来执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** `bigUpload.php` 文件处理大文件上传功能时，未对上传的文件类型进行严格的验证，允许上传具有危险类型的文件，如 PHP 文件。
2.  **利用步骤：**
    *   攻击者使用提供的 `exploit.py` 脚本，指定目标 Chamilo LMS 实例的 URL 和要上传的 webshell 文件。
    *   脚本将 webshell 文件通过 POST 请求发送到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 路径。
    *   如果上传成功，攻击者可以通过访问上传的 webshell 文件来执行任意代码。

3.  **有效性分析：** 根据漏洞描述和搜索引擎结果，该漏洞的 POC 代码是有效的，可以实现远程代码执行。

4.  **投毒风险分析：**
    *   `exploit.py` 脚本是一个简单的文件上传脚本，主要功能是发送 POST 请求，上传指定的文件到目标 URL。代码本身没有发现任何可疑或恶意的行为。
    *   `README.md` 文件仅包含脚本的使用说明，没有包含任何可执行代码或恶意链接。
    *   因此，该仓库中存在投毒代码的可能性较低，可以判断投毒风险为0%。

5.  **利用方式总结：**
    *   **目标：** Chamilo LMS <= 1.11.24
    *   **漏洞：** 未授权文件上传 (CVE-2023-4220)
    *   **攻击方式：** 使用 `exploit.py` 脚本上传 webshell 到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`，然后访问 webshell 执行任意代码。

**项目地址:** [zora-beep/CVE-2023-4220](https://github.com/zora-beep/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)

---

