## CVE-2023-4863 - Google Chrome / libwebp 堆缓冲区溢出 (Heap Buffer Overflow)

**漏洞编号:** CVE-2023-4863

**漏洞类型:** 堆缓冲区溢出 (Heap Buffer Overflow)

**影响应用:** Google Chrome / libwebp

**危害等级:** 高危

**CVSS评分:** 8.8

**影响版本:** Google Chrome < 116.0.5845.187 (Mac/Linux), < 116.0.5845.187/.188 (Windows); libwebp < 1.3.2

**利用条件:** 用户访问包含恶意构造的WebP图像的网页，无需身份验证

**POC 可用性:** 4/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

POC有效性分析：本漏洞源于libwebp库在处理无损压缩（Lossless）的WebP图像时，Huffman解码阶段存在堆缓冲区溢出。输入的POC代码片段展示了Android NDK环境下的构建配置文件（Android.mk），其中明确包含了webp解码核心源码（如vp8l_dec.c、tree_dec.c等）以及sharpyuv组件。这证实了该POC旨在针对移动端及嵌入式设备的webp集成环境进行构建。有效性方面，该代码仅为构建定义，并未包含触发溢出的特定Payload。真正的利用需要构造一个特定的Huffman树，使得解码器在分配的内存空间之外进行写操作。利用步骤：1. 攻击者构造一个恶意的.webp文件，在其Huffman编码表中定义超出预定buffer大小的数据。2. 将该图像嵌入HTML或通过支持webp的应用程序加载。3. 目标用户访问受污染页面。4. libwebp在解析图像头信息并分配内存后，在解码像素数据时发生溢出。5. 溢出可导致程序崩溃（DoS）或覆盖关键内存指针实现远程代码执行（RCE）。投毒风险分析：该POC代码主要由标准的Android构建脚本组成，引用的源文件路径符合libwebp官方库结构（src/dec, src/dsp等）。分析其编译选项（-Wall, -O2等），未发现异常的外部注入脚本或混淆指令。投毒风险极低，因为其内容主要为静态的构建描述文件。在安全研究中，此类文件的风险在于其可能引导研究员下载带有后门的二进制预编译库，但代码本身是清澈的。防御建议是确保系统链接的libwebp库版本高于1.3.2。对于威胁情报团队，应重点监控任何尝试在受限网络内编译此类包含旧版源码的行为，以防被利用于内网渗透。

**项目地址:** [https://github.com/webmproject/libwebp](https://github.com/webmproject/libwebp)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2023-4863](https://nvd.nist.gov/vuln/detail/CVE-2023-4863)
