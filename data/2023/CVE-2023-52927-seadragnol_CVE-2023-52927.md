# CVE-2023-52927

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-52927-HoangNhoo_Reproduce-CVE-2023-52927.md](../2023/CVE-2023-52927-HoangNhoo_Reproduce-CVE-2023-52927.md)

## CVE-2023-52927-Linux Kernel Netfilter Expectation Handling

**漏洞编号:** CVE-2023-52927

**漏洞类型:** 逻辑错误/拒绝服务

**影响应用:** Linux Kernel Netfilter

**危害等级:** 中危，可能导致拒绝服务

**影响版本:** < 6.1.130, < 6.6

**利用条件:** 需要配置Netfilter conntrack expectation规则

**POC 可用性:** 部分

**投毒风险:** 0%

## 详情

CVE-2023-52927 漏洞存在于 Linux 内核的 netfilter 子系统中，具体来说是在 `nf_ct_find_expectation` 函数中处理 conntrack expectation 的逻辑存在问题。漏洞描述表明，在某些场景下，期望的连接不应从哈希表中移除，但在受影响的代码中，`nf_ct_find_expectation` 会移除 expectation。此漏洞允许攻击者通过构造特定的数据包和 expectation 规则，导致 expectation 被错误地移除或重复创建，进而导致资源耗尽或连接跟踪出现异常，最终导致拒绝服务。根据漏洞库信息和搜索结果，此漏洞在较新版本的内核中已得到修复（>=6.1.130 和 >= 6.6）。

**有效性评估：**
根据提供的信息,漏洞POC代码有效性未知. 提供的代码仓库中仅包含一个 README.md 文件，描述为 `Reproduce-CVE-2023-52927`，但没有提供实际的利用代码。因此，无法直接判断提供的 POC 代码是否有效。

**投毒风险评估：**
由于提供的POC代码仅包含一个空的 README.md 文件，因此投毒风险很低，可以评估为 0%。没有可执行的代码可以被利用来植入恶意代码。

**利用方式分析：**
1.  **设置 Conntrack Expectation:** 攻击者需要首先设置一个 Netfilter conntrack expectation 规则。这通常涉及到使用 `iptables` 或 `nftables` 命令来配置规则。
2.  **触发漏洞：** 然后，攻击者发送与 expectation 匹配的数据包。在受影响的代码中，`nf_ct_find_expectation` 函数会被调用，并且会错误地移除 expectation。
3.  **资源耗尽/拒绝服务：** 通过重复上述步骤，攻击者可以导致 expectation 被重复创建或移除，最终耗尽系统资源或导致连接跟踪出现异常，从而实现拒绝服务攻击。

**项目地址:** [HoangNhoo/Reproduce-CVE-2023-52927](https://github.com/HoangNhoo/Reproduce-CVE-2023-52927)

**漏洞详情:** [CVE-2023-52927](https://nvd.nist.gov/vuln/detail/CVE-2023-52927)

---

## POC #2

**来源**: [CVE-2023-52927-seadragnol_CVE-2023-52927-private.md](../2023/CVE-2023-52927-seadragnol_CVE-2023-52927-private.md)

## CVE-2023-52927

**漏洞编号:** CVE-2023-52927

**漏洞类型:** UAF（Use-After-Free）

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地权限提升

**影响版本:** < 6.1.130, < 6.6

**利用条件:** 需要在受影响的内核版本上运行，并能够配置netfilter/nf_tables子系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-52927 是 Linux 内核 netfilter 模块中 nf_conntrack 功能中的一个 UAF 漏洞。该漏洞源于 `nf_ct_find_expectation` 函数在某些情况下没有正确地从哈希表中移除 expectation 对象。当 OVS 和 TC conntrack 不确认创建的 ct 时，会导致 expectation 对象被释放后仍然被使用。

**利用方式：**

1.  **分配 template nf_conn：** 通过调用 `nft_ct_set_zone_eval()` 分配一个 template nf_conn。
2.  **设置 nf_nat_setup_info()：** 设置 `nf_nat_setup_info()` 函数。
3.  **连接 template nf_conn：** 将 template nf_conn 连接到 `nf_nat_setup_info()`。
4.  **释放 template nf_conn：** 释放 template nf_conn。
5.  **链接另一个 nf_conn：** 将另一个 nf_conn 链接到 `nf_nat_bysource` 哈希表的相同 bucket。
6.  **触发 KASAN：** 触发 KASAN UAF 漏洞。
7. **漏洞利用**: 首先通过原始的UAF获得一个原始的读写能力，然后通过替换对象改变原始读写能力。通过泄露堆信息和控制使用的nf_conn，从而实现读写表达式的ops，最终通过控制RIP来完成提权。

**有效性：**

根据提供的漏洞利用代码（README.md），该漏洞存在可利用性。代码中详细描述了漏洞的根 Cause 分析，以及如何编写 PoC 来触发 KASAN 报告，并开发稳定的本地权限提升 exploit。

**投毒风险：**

虽然提供的文档看起来像是详细的漏洞分析和利用指南，但是仍然存在一定的投毒风险。代码中可能包含一些不易察觉的后门或恶意代码，例如：

*   **隐藏的函数调用：** 在 PoC 代码中插入一些看似无害但实际会执行恶意操作的函数调用。
*   **条件触发的恶意行为：** 只有在特定条件下才会触发的恶意代码，例如检查特定环境变量或系统配置。
*   **利用漏洞安装后门：** 利用漏洞在目标系统上安装后门程序，以便后续进行远程控制。

鉴于漏洞利用代码的复杂性，以及攻击者可能使用的各种隐藏手段，因此**投毒风险估计为 10%**。建议在使用此代码之前进行全面的安全审计，以确保其安全性。

**项目地址:** [seadragnol/CVE-2023-52927-private](https://github.com/seadragnol/CVE-2023-52927-private)

**漏洞详情:** [CVE-2023-52927](https://nvd.nist.gov/vuln/detail/CVE-2023-52927)

---

## POC #3

**来源**: [CVE-2023-52927-seadragnol_CVE-2023-52927.md](../2023/CVE-2023-52927-seadragnol_CVE-2023-52927.md)

# CVE-2023-52927

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-52927-HoangNhoo_Reproduce-CVE-2023-52927.md](../2023/CVE-2023-52927-HoangNhoo_Reproduce-CVE-2023-52927.md)

## CVE-2023-52927-Linux Kernel Netfilter Expectation Handling

**漏洞编号:** CVE-2023-52927

**漏洞类型:** 逻辑错误/拒绝服务

**影响应用:** Linux Kernel Netfilter

**危害等级:** 中危，可能导致拒绝服务

**影响版本:** < 6.1.130, < 6.6

**利用条件:** 需要配置Netfilter conntrack expectation规则

**POC 可用性:** 部分

**投毒风险:** 0%

## 详情

CVE-2023-52927 漏洞存在于 Linux 内核的 netfilter 子系统中，具体来说是在 `nf_ct_find_expectation` 函数中处理 conntrack expectation 的逻辑存在问题。漏洞描述表明，在某些场景下，期望的连接不应从哈希表中移除，但在受影响的代码中，`nf_ct_find_expectation` 会移除 expectation。此漏洞允许攻击者通过构造特定的数据包和 expectation 规则，导致 expectation 被错误地移除或重复创建，进而导致资源耗尽或连接跟踪出现异常，最终导致拒绝服务。根据漏洞库信息和搜索结果，此漏洞在较新版本的内核中已得到修复（>=6.1.130 和 >= 6.6）。

**有效性评估：**
根据提供的信息,漏洞POC代码有效性未知. 提供的代码仓库中仅包含一个 README.md 文件，描述为 `Reproduce-CVE-2023-52927`，但没有提供实际的利用代码。因此，无法直接判断提供的 POC 代码是否有效。

**投毒风险评估：**
由于提供的POC代码仅包含一个空的 README.md 文件，因此投毒风险很低，可以评估为 0%。没有可执行的代码可以被利用来植入恶意代码。

**利用方式分析：**
1.  **设置 Conntrack Expectation:** 攻击者需要首先设置一个 Netfilter conntrack expectation 规则。这通常涉及到使用 `iptables` 或 `nftables` 命令来配置规则。
2.  **触发漏洞：** 然后，攻击者发送与 expectation 匹配的数据包。在受影响的代码中，`nf_ct_find_expectation` 函数会被调用，并且会错误地移除 expectation。
3.  **资源耗尽/拒绝服务：** 通过重复上述步骤，攻击者可以导致 expectation 被重复创建或移除，最终耗尽系统资源或导致连接跟踪出现异常，从而实现拒绝服务攻击。

**项目地址:** [HoangNhoo/Reproduce-CVE-2023-52927](https://github.com/HoangNhoo/Reproduce-CVE-2023-52927)

**漏洞详情:** [CVE-2023-52927](https://nvd.nist.gov/vuln/detail/CVE-2023-52927)

---

## POC #2

**来源**: [CVE-2023-52927-seadragnol_CVE-2023-52927-private.md](../2023/CVE-2023-52927-seadragnol_CVE-2023-52927-private.md)

## CVE-2023-52927

**漏洞编号:** CVE-2023-52927

**漏洞类型:** UAF（Use-After-Free）

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地权限提升

**影响版本:** < 6.1.130, < 6.6

**利用条件:** 需要在受影响的内核版本上运行，并能够配置netfilter/nf_tables子系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-52927 是 Linux 内核 netfilter 模块中 nf_conntrack 功能中的一个 UAF 漏洞。该漏洞源于 `nf_ct_find_expectation` 函数在某些情况下没有正确地从哈希表中移除 expectation 对象。当 OVS 和 TC conntrack 不确认创建的 ct 时，会导致 expectation 对象被释放后仍然被使用。

**利用方式：**

1.  **分配 template nf_conn：** 通过调用 `nft_ct_set_zone_eval()` 分配一个 template nf_conn。
2.  **设置 nf_nat_setup_info()：** 设置 `nf_nat_setup_info()` 函数。
3.  **连接 template nf_conn：** 将 template nf_conn 连接到 `nf_nat_setup_info()`。
4.  **释放 template nf_conn：** 释放 template nf_conn。
5.  **链接另一个 nf_conn：** 将另一个 nf_conn 链接到 `nf_nat_bysource` 哈希表的相同 bucket。
6.  **触发 KASAN：** 触发 KASAN UAF 漏洞。
7. **漏洞利用**: 首先通过原始的UAF获得一个原始的读写能力，然后通过替换对象改变原始读写能力。通过泄露堆信息和控制使用的nf_conn，从而实现读写表达式的ops，最终通过控制RIP来完成提权。

**有效性：**

根据提供的漏洞利用代码（README.md），该漏洞存在可利用性。代码中详细描述了漏洞的根 Cause 分析，以及如何编写 PoC 来触发 KASAN 报告，并开发稳定的本地权限提升 exploit。

**投毒风险：**

虽然提供的文档看起来像是详细的漏洞分析和利用指南，但是仍然存在一定的投毒风险。代码中可能包含一些不易察觉的后门或恶意代码，例如：

*   **隐藏的函数调用：** 在 PoC 代码中插入一些看似无害但实际会执行恶意操作的函数调用。
*   **条件触发的恶意行为：** 只有在特定条件下才会触发的恶意代码，例如检查特定环境变量或系统配置。
*   **利用漏洞安装后门：** 利用漏洞在目标系统上安装后门程序，以便后续进行远程控制。

鉴于漏洞利用代码的复杂性，以及攻击者可能使用的各种隐藏手段，因此**投毒风险估计为 10%**。建议在使用此代码之前进行全面的安全审计，以确保其安全性。

**项目地址:** [seadragnol/CVE-2023-52927-private](https://github.com/seadragnol/CVE-2023-52927-private)

**漏洞详情:** [CVE-2023-52927](https://nvd.nist.gov/vuln/detail/CVE-2023-52927)

---

## POC #3

**来源**: [CVE-2023-52927-seadragnol_CVE-2023-52927.md](../2023/CVE-2023-52927-seadragnol_CVE-2023-52927.md)

# CVE-2023-52927

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-52927-HoangNhoo_Reproduce-CVE-2023-52927.md](../2023/CVE-2023-52927-HoangNhoo_Reproduce-CVE-2023-52927.md)

## CVE-2023-52927-Linux Kernel Netfilter Expectation Handling

**漏洞编号:** CVE-2023-52927

**漏洞类型:** 逻辑错误/拒绝服务

**影响应用:** Linux Kernel Netfilter

**危害等级:** 中危，可能导致拒绝服务

**影响版本:** < 6.1.130, < 6.6

**利用条件:** 需要配置Netfilter conntrack expectation规则

**POC 可用性:** 部分

**投毒风险:** 0%

## 详情

CVE-2023-52927 漏洞存在于 Linux 内核的 netfilter 子系统中，具体来说是在 `nf_ct_find_expectation` 函数中处理 conntrack expectation 的逻辑存在问题。漏洞描述表明，在某些场景下，期望的连接不应从哈希表中移除，但在受影响的代码中，`nf_ct_find_expectation` 会移除 expectation。此漏洞允许攻击者通过构造特定的数据包和 expectation 规则，导致 expectation 被错误地移除或重复创建，进而导致资源耗尽或连接跟踪出现异常，最终导致拒绝服务。根据漏洞库信息和搜索结果，此漏洞在较新版本的内核中已得到修复（>=6.1.130 和 >= 6.6）。

**有效性评估：**
根据提供的信息,漏洞POC代码有效性未知. 提供的代码仓库中仅包含一个 README.md 文件，描述为 `Reproduce-CVE-2023-52927`，但没有提供实际的利用代码。因此，无法直接判断提供的 POC 代码是否有效。

**投毒风险评估：**
由于提供的POC代码仅包含一个空的 README.md 文件，因此投毒风险很低，可以评估为 0%。没有可执行的代码可以被利用来植入恶意代码。

**利用方式分析：**
1.  **设置 Conntrack Expectation:** 攻击者需要首先设置一个 Netfilter conntrack expectation 规则。这通常涉及到使用 `iptables` 或 `nftables` 命令来配置规则。
2.  **触发漏洞：** 然后，攻击者发送与 expectation 匹配的数据包。在受影响的代码中，`nf_ct_find_expectation` 函数会被调用，并且会错误地移除 expectation。
3.  **资源耗尽/拒绝服务：** 通过重复上述步骤，攻击者可以导致 expectation 被重复创建或移除，最终耗尽系统资源或导致连接跟踪出现异常，从而实现拒绝服务攻击。

**项目地址:** [HoangNhoo/Reproduce-CVE-2023-52927](https://github.com/HoangNhoo/Reproduce-CVE-2023-52927)

**漏洞详情:** [CVE-2023-52927](https://nvd.nist.gov/vuln/detail/CVE-2023-52927)

---

## POC #2

**来源**: [CVE-2023-52927-seadragnol_CVE-2023-52927-private.md](../2023/CVE-2023-52927-seadragnol_CVE-2023-52927-private.md)

## CVE-2023-52927

**漏洞编号:** CVE-2023-52927

**漏洞类型:** UAF（Use-After-Free）

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地权限提升

**影响版本:** < 6.1.130, < 6.6

**利用条件:** 需要在受影响的内核版本上运行，并能够配置netfilter/nf_tables子系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-52927 是 Linux 内核 netfilter 模块中 nf_conntrack 功能中的一个 UAF 漏洞。该漏洞源于 `nf_ct_find_expectation` 函数在某些情况下没有正确地从哈希表中移除 expectation 对象。当 OVS 和 TC conntrack 不确认创建的 ct 时，会导致 expectation 对象被释放后仍然被使用。

**利用方式：**

1.  **分配 template nf_conn：** 通过调用 `nft_ct_set_zone_eval()` 分配一个 template nf_conn。
2.  **设置 nf_nat_setup_info()：** 设置 `nf_nat_setup_info()` 函数。
3.  **连接 template nf_conn：** 将 template nf_conn 连接到 `nf_nat_setup_info()`。
4.  **释放 template nf_conn：** 释放 template nf_conn。
5.  **链接另一个 nf_conn：** 将另一个 nf_conn 链接到 `nf_nat_bysource` 哈希表的相同 bucket。
6.  **触发 KASAN：** 触发 KASAN UAF 漏洞。
7. **漏洞利用**: 首先通过原始的UAF获得一个原始的读写能力，然后通过替换对象改变原始读写能力。通过泄露堆信息和控制使用的nf_conn，从而实现读写表达式的ops，最终通过控制RIP来完成提权。

**有效性：**

根据提供的漏洞利用代码（README.md），该漏洞存在可利用性。代码中详细描述了漏洞的根 Cause 分析，以及如何编写 PoC 来触发 KASAN 报告，并开发稳定的本地权限提升 exploit。

**投毒风险：**

虽然提供的文档看起来像是详细的漏洞分析和利用指南，但是仍然存在一定的投毒风险。代码中可能包含一些不易察觉的后门或恶意代码，例如：

*   **隐藏的函数调用：** 在 PoC 代码中插入一些看似无害但实际会执行恶意操作的函数调用。
*   **条件触发的恶意行为：** 只有在特定条件下才会触发的恶意代码，例如检查特定环境变量或系统配置。
*   **利用漏洞安装后门：** 利用漏洞在目标系统上安装后门程序，以便后续进行远程控制。

鉴于漏洞利用代码的复杂性，以及攻击者可能使用的各种隐藏手段，因此**投毒风险估计为 10%**。建议在使用此代码之前进行全面的安全审计，以确保其安全性。

**项目地址:** [seadragnol/CVE-2023-52927-private](https://github.com/seadragnol/CVE-2023-52927-private)

**漏洞详情:** [CVE-2023-52927](https://nvd.nist.gov/vuln/detail/CVE-2023-52927)

---

## POC #3

**来源**: [CVE-2023-52927-seadragnol_CVE-2023-52927.md](../2023/CVE-2023-52927-seadragnol_CVE-2023-52927.md)

# CVE-2023-52927

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-52927-HoangNhoo_Reproduce-CVE-2023-52927.md](../2023/CVE-2023-52927-HoangNhoo_Reproduce-CVE-2023-52927.md)

## CVE-2023-52927-Linux Kernel Netfilter Expectation Handling

**漏洞编号:** CVE-2023-52927

**漏洞类型:** 逻辑错误/拒绝服务

**影响应用:** Linux Kernel Netfilter

**危害等级:** 中危，可能导致拒绝服务

**影响版本:** < 6.1.130, < 6.6

**利用条件:** 需要配置Netfilter conntrack expectation规则

**POC 可用性:** 部分

**投毒风险:** 0%

## 详情

CVE-2023-52927 漏洞存在于 Linux 内核的 netfilter 子系统中，具体来说是在 `nf_ct_find_expectation` 函数中处理 conntrack expectation 的逻辑存在问题。漏洞描述表明，在某些场景下，期望的连接不应从哈希表中移除，但在受影响的代码中，`nf_ct_find_expectation` 会移除 expectation。此漏洞允许攻击者通过构造特定的数据包和 expectation 规则，导致 expectation 被错误地移除或重复创建，进而导致资源耗尽或连接跟踪出现异常，最终导致拒绝服务。根据漏洞库信息和搜索结果，此漏洞在较新版本的内核中已得到修复（>=6.1.130 和 >= 6.6）。

**有效性评估：**
根据提供的信息,漏洞POC代码有效性未知. 提供的代码仓库中仅包含一个 README.md 文件，描述为 `Reproduce-CVE-2023-52927`，但没有提供实际的利用代码。因此，无法直接判断提供的 POC 代码是否有效。

**投毒风险评估：**
由于提供的POC代码仅包含一个空的 README.md 文件，因此投毒风险很低，可以评估为 0%。没有可执行的代码可以被利用来植入恶意代码。

**利用方式分析：**
1.  **设置 Conntrack Expectation:** 攻击者需要首先设置一个 Netfilter conntrack expectation 规则。这通常涉及到使用 `iptables` 或 `nftables` 命令来配置规则。
2.  **触发漏洞：** 然后，攻击者发送与 expectation 匹配的数据包。在受影响的代码中，`nf_ct_find_expectation` 函数会被调用，并且会错误地移除 expectation。
3.  **资源耗尽/拒绝服务：** 通过重复上述步骤，攻击者可以导致 expectation 被重复创建或移除，最终耗尽系统资源或导致连接跟踪出现异常，从而实现拒绝服务攻击。

**项目地址:** [HoangNhoo/Reproduce-CVE-2023-52927](https://github.com/HoangNhoo/Reproduce-CVE-2023-52927)

**漏洞详情:** [CVE-2023-52927](https://nvd.nist.gov/vuln/detail/CVE-2023-52927)

---

## POC #2

**来源**: [CVE-2023-52927-seadragnol_CVE-2023-52927-private.md](../2023/CVE-2023-52927-seadragnol_CVE-2023-52927-private.md)

## CVE-2023-52927

**漏洞编号:** CVE-2023-52927

**漏洞类型:** UAF（Use-After-Free）

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地权限提升

**影响版本:** < 6.1.130, < 6.6

**利用条件:** 需要在受影响的内核版本上运行，并能够配置netfilter/nf_tables子系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-52927 是 Linux 内核 netfilter 模块中 nf_conntrack 功能中的一个 UAF 漏洞。该漏洞源于 `nf_ct_find_expectation` 函数在某些情况下没有正确地从哈希表中移除 expectation 对象。当 OVS 和 TC conntrack 不确认创建的 ct 时，会导致 expectation 对象被释放后仍然被使用。

**利用方式：**

1.  **分配 template nf_conn：** 通过调用 `nft_ct_set_zone_eval()` 分配一个 template nf_conn。
2.  **设置 nf_nat_setup_info()：** 设置 `nf_nat_setup_info()` 函数。
3.  **连接 template nf_conn：** 将 template nf_conn 连接到 `nf_nat_setup_info()`。
4.  **释放 template nf_conn：** 释放 template nf_conn。
5.  **链接另一个 nf_conn：** 将另一个 nf_conn 链接到 `nf_nat_bysource` 哈希表的相同 bucket。
6.  **触发 KASAN：** 触发 KASAN UAF 漏洞。
7. **漏洞利用**: 首先通过原始的UAF获得一个原始的读写能力，然后通过替换对象改变原始读写能力。通过泄露堆信息和控制使用的nf_conn，从而实现读写表达式的ops，最终通过控制RIP来完成提权。

**有效性：**

根据提供的漏洞利用代码（README.md），该漏洞存在可利用性。代码中详细描述了漏洞的根 Cause 分析，以及如何编写 PoC 来触发 KASAN 报告，并开发稳定的本地权限提升 exploit。

**投毒风险：**

虽然提供的文档看起来像是详细的漏洞分析和利用指南，但是仍然存在一定的投毒风险。代码中可能包含一些不易察觉的后门或恶意代码，例如：

*   **隐藏的函数调用：** 在 PoC 代码中插入一些看似无害但实际会执行恶意操作的函数调用。
*   **条件触发的恶意行为：** 只有在特定条件下才会触发的恶意代码，例如检查特定环境变量或系统配置。
*   **利用漏洞安装后门：** 利用漏洞在目标系统上安装后门程序，以便后续进行远程控制。

鉴于漏洞利用代码的复杂性，以及攻击者可能使用的各种隐藏手段，因此**投毒风险估计为 10%**。建议在使用此代码之前进行全面的安全审计，以确保其安全性。

**项目地址:** [seadragnol/CVE-2023-52927-private](https://github.com/seadragnol/CVE-2023-52927-private)

**漏洞详情:** [CVE-2023-52927](https://nvd.nist.gov/vuln/detail/CVE-2023-52927)

---

## POC #3

**来源**: [CVE-2023-52927-seadragnol_CVE-2023-52927.md](../2023/CVE-2023-52927-seadragnol_CVE-2023-52927.md)

# CVE-2023-52927

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-52927-HoangNhoo_Reproduce-CVE-2023-52927.md](../2023/CVE-2023-52927-HoangNhoo_Reproduce-CVE-2023-52927.md)

## CVE-2023-52927-Linux Kernel Netfilter Expectation Handling

**漏洞编号:** CVE-2023-52927

**漏洞类型:** 逻辑错误/拒绝服务

**影响应用:** Linux Kernel Netfilter

**危害等级:** 中危，可能导致拒绝服务

**影响版本:** < 6.1.130, < 6.6

**利用条件:** 需要配置Netfilter conntrack expectation规则

**POC 可用性:** 部分

**投毒风险:** 0%

## 详情

CVE-2023-52927 漏洞存在于 Linux 内核的 netfilter 子系统中，具体来说是在 `nf_ct_find_expectation` 函数中处理 conntrack expectation 的逻辑存在问题。漏洞描述表明，在某些场景下，期望的连接不应从哈希表中移除，但在受影响的代码中，`nf_ct_find_expectation` 会移除 expectation。此漏洞允许攻击者通过构造特定的数据包和 expectation 规则，导致 expectation 被错误地移除或重复创建，进而导致资源耗尽或连接跟踪出现异常，最终导致拒绝服务。根据漏洞库信息和搜索结果，此漏洞在较新版本的内核中已得到修复（>=6.1.130 和 >= 6.6）。

**有效性评估：**
根据提供的信息,漏洞POC代码有效性未知. 提供的代码仓库中仅包含一个 README.md 文件，描述为 `Reproduce-CVE-2023-52927`，但没有提供实际的利用代码。因此，无法直接判断提供的 POC 代码是否有效。

**投毒风险评估：**
由于提供的POC代码仅包含一个空的 README.md 文件，因此投毒风险很低，可以评估为 0%。没有可执行的代码可以被利用来植入恶意代码。

**利用方式分析：**
1.  **设置 Conntrack Expectation:** 攻击者需要首先设置一个 Netfilter conntrack expectation 规则。这通常涉及到使用 `iptables` 或 `nftables` 命令来配置规则。
2.  **触发漏洞：** 然后，攻击者发送与 expectation 匹配的数据包。在受影响的代码中，`nf_ct_find_expectation` 函数会被调用，并且会错误地移除 expectation。
3.  **资源耗尽/拒绝服务：** 通过重复上述步骤，攻击者可以导致 expectation 被重复创建或移除，最终耗尽系统资源或导致连接跟踪出现异常，从而实现拒绝服务攻击。

**项目地址:** [HoangNhoo/Reproduce-CVE-2023-52927](https://github.com/HoangNhoo/Reproduce-CVE-2023-52927)

**漏洞详情:** [CVE-2023-52927](https://nvd.nist.gov/vuln/detail/CVE-2023-52927)

---

## POC #2

**来源**: [CVE-2023-52927-seadragnol_CVE-2023-52927-private.md](../2023/CVE-2023-52927-seadragnol_CVE-2023-52927-private.md)

## CVE-2023-52927

**漏洞编号:** CVE-2023-52927

**漏洞类型:** UAF（Use-After-Free）

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地权限提升

**影响版本:** < 6.1.130, < 6.6

**利用条件:** 需要在受影响的内核版本上运行，并能够配置netfilter/nf_tables子系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-52927 是 Linux 内核 netfilter 模块中 nf_conntrack 功能中的一个 UAF 漏洞。该漏洞源于 `nf_ct_find_expectation` 函数在某些情况下没有正确地从哈希表中移除 expectation 对象。当 OVS 和 TC conntrack 不确认创建的 ct 时，会导致 expectation 对象被释放后仍然被使用。

**利用方式：**

1.  **分配 template nf_conn：** 通过调用 `nft_ct_set_zone_eval()` 分配一个 template nf_conn。
2.  **设置 nf_nat_setup_info()：** 设置 `nf_nat_setup_info()` 函数。
3.  **连接 template nf_conn：** 将 template nf_conn 连接到 `nf_nat_setup_info()`。
4.  **释放 template nf_conn：** 释放 template nf_conn。
5.  **链接另一个 nf_conn：** 将另一个 nf_conn 链接到 `nf_nat_bysource` 哈希表的相同 bucket。
6.  **触发 KASAN：** 触发 KASAN UAF 漏洞。
7. **漏洞利用**: 首先通过原始的UAF获得一个原始的读写能力，然后通过替换对象改变原始读写能力。通过泄露堆信息和控制使用的nf_conn，从而实现读写表达式的ops，最终通过控制RIP来完成提权。

**有效性：**

根据提供的漏洞利用代码（README.md），该漏洞存在可利用性。代码中详细描述了漏洞的根 Cause 分析，以及如何编写 PoC 来触发 KASAN 报告，并开发稳定的本地权限提升 exploit。

**投毒风险：**

虽然提供的文档看起来像是详细的漏洞分析和利用指南，但是仍然存在一定的投毒风险。代码中可能包含一些不易察觉的后门或恶意代码，例如：

*   **隐藏的函数调用：** 在 PoC 代码中插入一些看似无害但实际会执行恶意操作的函数调用。
*   **条件触发的恶意行为：** 只有在特定条件下才会触发的恶意代码，例如检查特定环境变量或系统配置。
*   **利用漏洞安装后门：** 利用漏洞在目标系统上安装后门程序，以便后续进行远程控制。

鉴于漏洞利用代码的复杂性，以及攻击者可能使用的各种隐藏手段，因此**投毒风险估计为 10%**。建议在使用此代码之前进行全面的安全审计，以确保其安全性。

**项目地址:** [seadragnol/CVE-2023-52927-private](https://github.com/seadragnol/CVE-2023-52927-private)

**漏洞详情:** [CVE-2023-52927](https://nvd.nist.gov/vuln/detail/CVE-2023-52927)

---

## POC #3

**来源**: [CVE-2023-52927-seadragnol_CVE-2023-52927.md](../2023/CVE-2023-52927-seadragnol_CVE-2023-52927.md)

## CVE-2023-52927 - Linux Kernel Netfilter UAF

**漏洞编号:** CVE-2023-52927

**漏洞类型:** Use-After-Free (UAF)

**影响应用:** Linux Kernel

**危害等级:** 高危，本地权限提升

**影响版本:** <= 6.1.129 和 < 6.6 的早期版本

**利用条件:** 需要能够与netfilter子系统交互，可能需要特定的网络配置和权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-52927 是 Linux 内核 netfilter 组件中的一个 Use-After-Free 漏洞，该漏洞发生在 `nf_ct_find_expectation` 函数中，当期望连接(expectation)未被正确移除时。 

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞存在于 Linux Kernel 直到版本 6.1.129。提供的漏洞利用代码包含 Makefile、README.md 和 exploit.c 等文件。README.md 提到了一个 kCTF 环境的利用，exploit.c 包含了利用漏洞的代码。Makefile 文件显示它使用了 `libnetfilter_queue`、`libnfnetlink`、`libnftnl` 和 `libmnl` 等 netfilter 相关的库。这些信息表明，该 POC 具备一定的有效性，因为它针对特定的内核版本和 netfilter 功能。

**投毒风险评估：**

虽然代码看起来像是合法的漏洞利用，但仍然存在一定的投毒风险。 代码中包含一些硬编码的地址(例如`INIT_NSPROXY`, `COMMIT_CREDS`等) 并且代码从网络中下载库文件，这存在潜在的风险，例如，如果下载链接被篡改，则可能引入恶意代码。此外，复杂的网络配置也可能被用来隐藏恶意行为。
综合来看，投毒风险大约为 10%。 这是因为:

*   漏洞利用代码直接利用了已知的漏洞，并且提供了相关的库依赖和编译方法。
*   但是，该漏洞需要联网下载依赖，如果依赖被篡改可能会植入恶意代码。
*   代码中硬编码的地址是针对特定内核版本编译的，不通用。

**利用方式：**

1.  **环境准备：** 搭建存在漏洞的内核环境，或者使用 kCTF 提供的环境。
2.  **依赖安装：** 使用 `make prerequisites` 下载并编译 netfilter 相关的库。
3.  **漏洞触发：** 通过构造特定的网络数据包，利用`nf_ct_find_expectation`函数，触发 Use-After-Free 漏洞。
4.  **权限提升：** 利用 UAF 漏洞，覆盖内核对象，修改进程的凭据结构体（`cred`），将当前进程的 uid 和 gid 设置为 0，从而获得 root 权限。

**总结：**

提供的 POC 代码具有较高的可信度，能够利用 CVE-2023-52927 漏洞实现本地权限提升。但是，仍然需要注意代码中存在的硬编码地址和潜在的投毒风险，使用前需要进行充分的评估和验证。

**项目地址:** [seadragnol/CVE-2023-52927](https://github.com/seadragnol/CVE-2023-52927)

**漏洞详情:** [CVE-2023-52927](https://nvd.nist.gov/vuln/detail/CVE-2023-52927)

---



---



---



---



---

