# CVE-2023-4226

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-4226-SkyW4r33x_CVE-2023-4226.md](../2023/CVE-2023-4226-SkyW4r33x_CVE-2023-4226.md)

## CVE-2023-4226-Chamilo-LMS-远程代码执行

**漏洞编号:** CVE-2023-4226

**漏洞类型:** 未授权文件上传

**影响应用:** Chamilo LMS

**危害等级:** 高危，远程代码执行

**影响版本:** <= 1.11.24

**利用条件:** 需要认证的learner角色

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4226 漏洞存在于 Chamilo LMS <= v1.11.24 的 `/main/inc/ajax/work.ajax.php` 文件中，允许经过身份验证的攻击者（具有learner角色）通过上传 PHP 文件来执行远程代码。

**利用方式：**
1.  攻击者需要拥有 Chamilo LMS 的 learner 角色账户并登录。
2.  攻击者利用`/main/inc/ajax/work.ajax.php`的文件上传功能。
3.  由于文件上传功能存在缺陷，攻击者可以上传包含恶意代码的 PHP 文件（例如webshell）。
4.  上传的 PHP 文件被存储在服务器的web可访问目录下。
5.  攻击者通过访问上传的 PHP 文件来执行其中的恶意代码，从而实现远程代码执行。

**有效性评估：**
根据漏洞描述和搜索结果，该漏洞利用的有效性较高。存在公开的POC代码（例如 krishnan-tech/CVE-2023-4226-POC），表明该漏洞是可利用的。 漏洞库信息也确认了可以通过上传php文件实现远程代码执行。
提供的Python POC代码 首先会检查是否存在rce.php和.htaccess文件， 如果没有rce.php,则退出， 如果没有.htaccess会创建，然后要求用户输入chamilo的URL，ch_sid cookie, defaultMyCourseView3 cookie, 以及反弹shell的IP和端口，然后上传webshell， 成功后访问URL执行webshell,实现RCE

**投毒风险分析：**
提供的漏洞利用代码 `/tmp/f692adaeb6248bf7f4717efbf128f318/CVE-2023-4226.py` 本身并未发现明显的投毒代码。代码逻辑较为清晰，主要功能是利用漏洞上传包含恶意代码的 PHP 文件，并执行。

  *   代码会检查 `rce.php` 和 `.htaccess` 文件是否存在，如果 `rce.php` 不存在，会提示用户创建，并退出， 这部分逻辑是正常的，`.htaccess` 文件用于允许执行上传的 PHP 文件。
  *   代码包含用于验证 IP 地址和端口的函数 `validate_ip` 和 `validate_port`，这有助于防止用户输入错误的 IP 地址和端口。

但是仍然存在极低的投毒风险（1%）：
 * 修改IP和PORT的函数存在被替换成恶意代码的风险，但是代码替换校验较为严格，只有特定的代码才会触发风险。
*  用户在使用该POC前，应当仔细检查代码，确保其安全性。建议从可信的来源获取POC代码。

**项目地址:** [SkyW4r33x/CVE-2023-4226](https://github.com/SkyW4r33x/CVE-2023-4226)

**漏洞详情:** [CVE-2023-4226](https://nvd.nist.gov/vuln/detail/CVE-2023-4226)

---

## POC #2

**来源**: [CVE-2023-4226-krishnan-tech_CVE-2023-4226-POC.md](../2023/CVE-2023-4226-krishnan-tech_CVE-2023-4226-POC.md)

# CVE-2023-4226

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-4226-SkyW4r33x_CVE-2023-4226.md](../2023/CVE-2023-4226-SkyW4r33x_CVE-2023-4226.md)

## CVE-2023-4226-Chamilo-LMS-远程代码执行

**漏洞编号:** CVE-2023-4226

**漏洞类型:** 未授权文件上传

**影响应用:** Chamilo LMS

**危害等级:** 高危，远程代码执行

**影响版本:** <= 1.11.24

**利用条件:** 需要认证的learner角色

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4226 漏洞存在于 Chamilo LMS <= v1.11.24 的 `/main/inc/ajax/work.ajax.php` 文件中，允许经过身份验证的攻击者（具有learner角色）通过上传 PHP 文件来执行远程代码。

**利用方式：**
1.  攻击者需要拥有 Chamilo LMS 的 learner 角色账户并登录。
2.  攻击者利用`/main/inc/ajax/work.ajax.php`的文件上传功能。
3.  由于文件上传功能存在缺陷，攻击者可以上传包含恶意代码的 PHP 文件（例如webshell）。
4.  上传的 PHP 文件被存储在服务器的web可访问目录下。
5.  攻击者通过访问上传的 PHP 文件来执行其中的恶意代码，从而实现远程代码执行。

**有效性评估：**
根据漏洞描述和搜索结果，该漏洞利用的有效性较高。存在公开的POC代码（例如 krishnan-tech/CVE-2023-4226-POC），表明该漏洞是可利用的。 漏洞库信息也确认了可以通过上传php文件实现远程代码执行。
提供的Python POC代码 首先会检查是否存在rce.php和.htaccess文件， 如果没有rce.php,则退出， 如果没有.htaccess会创建，然后要求用户输入chamilo的URL，ch_sid cookie, defaultMyCourseView3 cookie, 以及反弹shell的IP和端口，然后上传webshell， 成功后访问URL执行webshell,实现RCE

**投毒风险分析：**
提供的漏洞利用代码 `/tmp/f692adaeb6248bf7f4717efbf128f318/CVE-2023-4226.py` 本身并未发现明显的投毒代码。代码逻辑较为清晰，主要功能是利用漏洞上传包含恶意代码的 PHP 文件，并执行。

  *   代码会检查 `rce.php` 和 `.htaccess` 文件是否存在，如果 `rce.php` 不存在，会提示用户创建，并退出， 这部分逻辑是正常的，`.htaccess` 文件用于允许执行上传的 PHP 文件。
  *   代码包含用于验证 IP 地址和端口的函数 `validate_ip` 和 `validate_port`，这有助于防止用户输入错误的 IP 地址和端口。

但是仍然存在极低的投毒风险（1%）：
 * 修改IP和PORT的函数存在被替换成恶意代码的风险，但是代码替换校验较为严格，只有特定的代码才会触发风险。
*  用户在使用该POC前，应当仔细检查代码，确保其安全性。建议从可信的来源获取POC代码。

**项目地址:** [SkyW4r33x/CVE-2023-4226](https://github.com/SkyW4r33x/CVE-2023-4226)

**漏洞详情:** [CVE-2023-4226](https://nvd.nist.gov/vuln/detail/CVE-2023-4226)

---

## POC #2

**来源**: [CVE-2023-4226-krishnan-tech_CVE-2023-4226-POC.md](../2023/CVE-2023-4226-krishnan-tech_CVE-2023-4226-POC.md)

# CVE-2023-4226

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-4226-SkyW4r33x_CVE-2023-4226.md](../2023/CVE-2023-4226-SkyW4r33x_CVE-2023-4226.md)

## CVE-2023-4226-Chamilo-LMS-远程代码执行

**漏洞编号:** CVE-2023-4226

**漏洞类型:** 未授权文件上传

**影响应用:** Chamilo LMS

**危害等级:** 高危，远程代码执行

**影响版本:** <= 1.11.24

**利用条件:** 需要认证的learner角色

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4226 漏洞存在于 Chamilo LMS <= v1.11.24 的 `/main/inc/ajax/work.ajax.php` 文件中，允许经过身份验证的攻击者（具有learner角色）通过上传 PHP 文件来执行远程代码。

**利用方式：**
1.  攻击者需要拥有 Chamilo LMS 的 learner 角色账户并登录。
2.  攻击者利用`/main/inc/ajax/work.ajax.php`的文件上传功能。
3.  由于文件上传功能存在缺陷，攻击者可以上传包含恶意代码的 PHP 文件（例如webshell）。
4.  上传的 PHP 文件被存储在服务器的web可访问目录下。
5.  攻击者通过访问上传的 PHP 文件来执行其中的恶意代码，从而实现远程代码执行。

**有效性评估：**
根据漏洞描述和搜索结果，该漏洞利用的有效性较高。存在公开的POC代码（例如 krishnan-tech/CVE-2023-4226-POC），表明该漏洞是可利用的。 漏洞库信息也确认了可以通过上传php文件实现远程代码执行。
提供的Python POC代码 首先会检查是否存在rce.php和.htaccess文件， 如果没有rce.php,则退出， 如果没有.htaccess会创建，然后要求用户输入chamilo的URL，ch_sid cookie, defaultMyCourseView3 cookie, 以及反弹shell的IP和端口，然后上传webshell， 成功后访问URL执行webshell,实现RCE

**投毒风险分析：**
提供的漏洞利用代码 `/tmp/f692adaeb6248bf7f4717efbf128f318/CVE-2023-4226.py` 本身并未发现明显的投毒代码。代码逻辑较为清晰，主要功能是利用漏洞上传包含恶意代码的 PHP 文件，并执行。

  *   代码会检查 `rce.php` 和 `.htaccess` 文件是否存在，如果 `rce.php` 不存在，会提示用户创建，并退出， 这部分逻辑是正常的，`.htaccess` 文件用于允许执行上传的 PHP 文件。
  *   代码包含用于验证 IP 地址和端口的函数 `validate_ip` 和 `validate_port`，这有助于防止用户输入错误的 IP 地址和端口。

但是仍然存在极低的投毒风险（1%）：
 * 修改IP和PORT的函数存在被替换成恶意代码的风险，但是代码替换校验较为严格，只有特定的代码才会触发风险。
*  用户在使用该POC前，应当仔细检查代码，确保其安全性。建议从可信的来源获取POC代码。

**项目地址:** [SkyW4r33x/CVE-2023-4226](https://github.com/SkyW4r33x/CVE-2023-4226)

**漏洞详情:** [CVE-2023-4226](https://nvd.nist.gov/vuln/detail/CVE-2023-4226)

---

## POC #2

**来源**: [CVE-2023-4226-krishnan-tech_CVE-2023-4226-POC.md](../2023/CVE-2023-4226-krishnan-tech_CVE-2023-4226-POC.md)

# CVE-2023-4226

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-4226-SkyW4r33x_CVE-2023-4226.md](../2023/CVE-2023-4226-SkyW4r33x_CVE-2023-4226.md)

## CVE-2023-4226-Chamilo-LMS-远程代码执行

**漏洞编号:** CVE-2023-4226

**漏洞类型:** 未授权文件上传

**影响应用:** Chamilo LMS

**危害等级:** 高危，远程代码执行

**影响版本:** <= 1.11.24

**利用条件:** 需要认证的learner角色

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4226 漏洞存在于 Chamilo LMS <= v1.11.24 的 `/main/inc/ajax/work.ajax.php` 文件中，允许经过身份验证的攻击者（具有learner角色）通过上传 PHP 文件来执行远程代码。

**利用方式：**
1.  攻击者需要拥有 Chamilo LMS 的 learner 角色账户并登录。
2.  攻击者利用`/main/inc/ajax/work.ajax.php`的文件上传功能。
3.  由于文件上传功能存在缺陷，攻击者可以上传包含恶意代码的 PHP 文件（例如webshell）。
4.  上传的 PHP 文件被存储在服务器的web可访问目录下。
5.  攻击者通过访问上传的 PHP 文件来执行其中的恶意代码，从而实现远程代码执行。

**有效性评估：**
根据漏洞描述和搜索结果，该漏洞利用的有效性较高。存在公开的POC代码（例如 krishnan-tech/CVE-2023-4226-POC），表明该漏洞是可利用的。 漏洞库信息也确认了可以通过上传php文件实现远程代码执行。
提供的Python POC代码 首先会检查是否存在rce.php和.htaccess文件， 如果没有rce.php,则退出， 如果没有.htaccess会创建，然后要求用户输入chamilo的URL，ch_sid cookie, defaultMyCourseView3 cookie, 以及反弹shell的IP和端口，然后上传webshell， 成功后访问URL执行webshell,实现RCE

**投毒风险分析：**
提供的漏洞利用代码 `/tmp/f692adaeb6248bf7f4717efbf128f318/CVE-2023-4226.py` 本身并未发现明显的投毒代码。代码逻辑较为清晰，主要功能是利用漏洞上传包含恶意代码的 PHP 文件，并执行。

  *   代码会检查 `rce.php` 和 `.htaccess` 文件是否存在，如果 `rce.php` 不存在，会提示用户创建，并退出， 这部分逻辑是正常的，`.htaccess` 文件用于允许执行上传的 PHP 文件。
  *   代码包含用于验证 IP 地址和端口的函数 `validate_ip` 和 `validate_port`，这有助于防止用户输入错误的 IP 地址和端口。

但是仍然存在极低的投毒风险（1%）：
 * 修改IP和PORT的函数存在被替换成恶意代码的风险，但是代码替换校验较为严格，只有特定的代码才会触发风险。
*  用户在使用该POC前，应当仔细检查代码，确保其安全性。建议从可信的来源获取POC代码。

**项目地址:** [SkyW4r33x/CVE-2023-4226](https://github.com/SkyW4r33x/CVE-2023-4226)

**漏洞详情:** [CVE-2023-4226](https://nvd.nist.gov/vuln/detail/CVE-2023-4226)

---

## POC #2

**来源**: [CVE-2023-4226-krishnan-tech_CVE-2023-4226-POC.md](../2023/CVE-2023-4226-krishnan-tech_CVE-2023-4226-POC.md)

## CVE-2023-4226-Chamilo LMS-远程代码执行

**漏洞编号:** CVE-2023-4226

**漏洞类型:** 文件上传

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 1.11.24

**利用条件:** 需要经过身份验证的learner角色

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4226是Chamilo LMS <= v1.11.24中的一个文件上传漏洞。攻击者通过身份验证并拥有learner角色后，可以通过`/main/inc/ajax/work.ajax.php`上传恶意PHP文件，从而执行任意代码。从提供的搜索引擎结果和漏洞库信息来看，该漏洞允许通过上传webshell获取RCE。提供的POC代码尝试利用`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，这与漏洞描述的`/main/inc/ajax/work.ajax.php`不同。但是，github搜索结果显示存在一个名为`krishnan-tech/CVE-2023-4226-POC`的项目，该项目可能包含更合适的PoC。提供的代码可以上传恶意文件，但上传路径可能存在问题。

**有效性：** 根据漏洞描述，需要经过身份验证的learner角色，但POC中似乎没有处理身份验证的部分。因此，直接使用该POC可能无法成功利用该漏洞。POC利用的是`bigUpload.php`,而cve描述是`work.ajax.php`。

**投毒风险：** 提供的PoC代码主要功能是上传文件和执行命令或者反弹shell。代码本身没有明显的投毒行为，但是存在潜在风险。
*   **文件覆盖/删除:** 如果攻击者能够控制上传文件的内容和位置，他们可能会覆盖或删除系统中的重要文件，导致服务中断或数据丢失。
*   **资源耗尽:** 上传大量恶意文件可能会耗尽服务器的存储空间或带宽资源，导致拒绝服务。
*   **代码执行:** 虽然PoC主要关注上传文件，但如果服务器对上传的文件类型和内容没有进行充分的验证，攻击者可能会上传包含恶意代码的文件，并在服务器上执行。
因此，代码本身投毒风险较低，判断投毒概率为10%。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要获得Chamilo LMS的账号，并具有learner角色。
2.  **上传恶意文件：** 利用`/main/inc/ajax/work.ajax.php`或者`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`上传包含恶意PHP代码的文件（例如webshell）。
3.  **执行恶意代码：** 访问上传的PHP文件，触发恶意代码的执行，从而控制服务器。
提供的PoC尝试使用`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`，通过`bigUploadFile`参数上传PHP文件，并尝试访问`/main/inc/lib/javascript/bigupload/files/{rev_shell_filename}`来执行上传的文件。


**项目地址:** [krishnan-tech/CVE-2023-4226-POC](https://github.com/krishnan-tech/CVE-2023-4226-POC)

**漏洞详情:** [CVE-2023-4226](https://nvd.nist.gov/vuln/detail/CVE-2023-4226)

---



---



---



---

