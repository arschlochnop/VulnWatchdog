# CVE-2023-40931

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-40931-G4sp4rCS_CVE-2023-40931-POC.md](../2023/CVE-2023-40931-G4sp4rCS_CVE-2023-40931-POC.md)

## CVE-2023-40931-Nagios XI-SQL注入

**漏洞编号:** CVE-2023-40931

**漏洞类型:** SQL注入

**影响应用:** Nagios XI

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 5.11.0 <= version <= 5.11.1

**利用条件:** 需要Nagios XI管理员权限或已授权用户的身份验证

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以进行以下分析：

1.  **有效性：**
    *   漏洞库信息和搜索结果都表明 CVE-2023-40931 是 Nagios XI 5.11.0 到 5.11.1 版本中的 SQL 注入漏洞，攻击者可以通过该漏洞执行任意 SQL 命令。
    *   漏洞利用代码 `exploit.py` 提供了完整的利用流程，包括身份验证、获取 token、测试 SQL 注入以及利用 sqlmap 提取数据库。脚本会先尝试使用提供的用户名和密码获取身份验证令牌，然后使用该令牌加载主页，接着通过向 `/admin/banner_message-ajaxhelper.php` 发送包含恶意 `id` 参数的 POST 请求来测试 SQL 注入。
    *   `exploit.py` 脚本如果成功检测到 SQL 错误，会打印相应的提示信息。此外，脚本还集成了 sqlmap 工具，可以自动利用该漏洞提取数据库。
    *   综合来看，提供的 POC 代码是有效的，可以用于验证和利用 CVE-2023-40931 漏洞。

2.  **投毒风险：**
    *   查看`exploit.py`代码，该脚本主要功能是验证和利用SQL注入漏洞。没有发现任何明显的恶意代码或后门。脚本使用 `requests` 库发送 HTTP 请求，并使用 `subprocess` 模块调用 `sqlmap` 工具。这两个操作本身是正常的漏洞利用流程，不属于投毒行为。
    *   `readme.md`文件也只包含免责声明和项目描述，没有可疑内容。
    *   综上所述，该仓库中存在作者隐藏的投毒代码的可能性较低。因此评估的投毒风险为 1%。

3.  **利用方式：**
    *   攻击者首先需要拥有 Nagios XI 的有效用户名和密码。根据漏洞描述，需要是已授权的用户，或者管理员用户。
    *   攻击者使用 `exploit.py` 脚本，提供目标 Nagios XI 的 URL、用户名和密码。
    *   脚本自动完成以下步骤：
        *   使用提供的凭据向 `/api/v1/authenticate` 发送 POST 请求，获取身份验证 token。
        *   使用获取的 token 加载主页，验证身份验证是否成功。
        *   向 `/admin/banner_message-ajaxhelper.php` 发送包含恶意 SQL 注入 payload 的 POST 请求，利用 `id` 参数中的 SQL 注入漏洞。
        *   如果检测到 SQL 错误，则说明漏洞存在，脚本会调用 sqlmap 工具，利用该漏洞提取数据库中的数据。
    *   通过修改 `exploit.py` 脚本中的 sqlmap 命令，可以实现更高级的攻击，例如执行任意系统命令。



**项目地址:** [G4sp4rCS/CVE-2023-40931-POC](https://github.com/G4sp4rCS/CVE-2023-40931-POC)

**漏洞详情:** [CVE-2023-40931](https://nvd.nist.gov/vuln/detail/CVE-2023-40931)

---

## POC #2

**来源**: [CVE-2023-40931-datboi6942_Nagios-XI-s-CVE-2023-40931-Exploit.md](../2023/CVE-2023-40931-datboi6942_Nagios-XI-s-CVE-2023-40931-Exploit.md)

# CVE-2023-40931

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-40931-G4sp4rCS_CVE-2023-40931-POC.md](../2023/CVE-2023-40931-G4sp4rCS_CVE-2023-40931-POC.md)

## CVE-2023-40931-Nagios XI-SQL注入

**漏洞编号:** CVE-2023-40931

**漏洞类型:** SQL注入

**影响应用:** Nagios XI

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 5.11.0 <= version <= 5.11.1

**利用条件:** 需要Nagios XI管理员权限或已授权用户的身份验证

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以进行以下分析：

1.  **有效性：**
    *   漏洞库信息和搜索结果都表明 CVE-2023-40931 是 Nagios XI 5.11.0 到 5.11.1 版本中的 SQL 注入漏洞，攻击者可以通过该漏洞执行任意 SQL 命令。
    *   漏洞利用代码 `exploit.py` 提供了完整的利用流程，包括身份验证、获取 token、测试 SQL 注入以及利用 sqlmap 提取数据库。脚本会先尝试使用提供的用户名和密码获取身份验证令牌，然后使用该令牌加载主页，接着通过向 `/admin/banner_message-ajaxhelper.php` 发送包含恶意 `id` 参数的 POST 请求来测试 SQL 注入。
    *   `exploit.py` 脚本如果成功检测到 SQL 错误，会打印相应的提示信息。此外，脚本还集成了 sqlmap 工具，可以自动利用该漏洞提取数据库。
    *   综合来看，提供的 POC 代码是有效的，可以用于验证和利用 CVE-2023-40931 漏洞。

2.  **投毒风险：**
    *   查看`exploit.py`代码，该脚本主要功能是验证和利用SQL注入漏洞。没有发现任何明显的恶意代码或后门。脚本使用 `requests` 库发送 HTTP 请求，并使用 `subprocess` 模块调用 `sqlmap` 工具。这两个操作本身是正常的漏洞利用流程，不属于投毒行为。
    *   `readme.md`文件也只包含免责声明和项目描述，没有可疑内容。
    *   综上所述，该仓库中存在作者隐藏的投毒代码的可能性较低。因此评估的投毒风险为 1%。

3.  **利用方式：**
    *   攻击者首先需要拥有 Nagios XI 的有效用户名和密码。根据漏洞描述，需要是已授权的用户，或者管理员用户。
    *   攻击者使用 `exploit.py` 脚本，提供目标 Nagios XI 的 URL、用户名和密码。
    *   脚本自动完成以下步骤：
        *   使用提供的凭据向 `/api/v1/authenticate` 发送 POST 请求，获取身份验证 token。
        *   使用获取的 token 加载主页，验证身份验证是否成功。
        *   向 `/admin/banner_message-ajaxhelper.php` 发送包含恶意 SQL 注入 payload 的 POST 请求，利用 `id` 参数中的 SQL 注入漏洞。
        *   如果检测到 SQL 错误，则说明漏洞存在，脚本会调用 sqlmap 工具，利用该漏洞提取数据库中的数据。
    *   通过修改 `exploit.py` 脚本中的 sqlmap 命令，可以实现更高级的攻击，例如执行任意系统命令。



**项目地址:** [G4sp4rCS/CVE-2023-40931-POC](https://github.com/G4sp4rCS/CVE-2023-40931-POC)

**漏洞详情:** [CVE-2023-40931](https://nvd.nist.gov/vuln/detail/CVE-2023-40931)

---

## POC #2

**来源**: [CVE-2023-40931-sealldeveloper_CVE-2023-40931-PoC.md](../2023/CVE-2023-40931-sealldeveloper_CVE-2023-40931-PoC.md)

## CVE-2023-40931-Nagios XI-SQL注入

**漏洞编号:** CVE-2023-40931

**漏洞类型:** SQL注入

**影响应用:** Nagios XI

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 5.11.0 to 5.11.1

**利用条件:** 需要有效的Nagios XI用户名和密码，以及目标实例的网络访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-40931 是 Nagios XI 5.11.0 到 5.11.1 版本中存在的 SQL 注入漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许经过身份验证的攻击者通过向 `/nagiosxi/admin/banner_message-ajaxhelper.php` 发送包含恶意 `id` 参数的 POST 请求，执行任意 SQL 命令。

**有效性：**

提供的sqlmap命令看起来是有效的，它可以自动化漏洞利用过程。 它首先使用提供的用户名和密码向 API 进行身份验证以获取token，然后使用此token构造一个恶意的URL,其中`id`参数用于注入SQL payload。 sqlmap工具可以自动检测和利用SQL注入漏洞，并提取数据库信息。

**投毒风险：**

提供的POC代码是一个sqlmap命令，本身不包含直接执行恶意操作的代码。但是，需要注意以下几点：

*   **sqlmap 的安全性：** sqlmap 是一个功能强大的工具，但也可能被用于恶意目的。从不可信的来源下载或使用修改过的 sqlmap 可能存在风险。
*   **目标系统的风险：** 成功利用 SQL 注入漏洞可能导致完全控制目标系统。这取决于数据库权限和系统配置。
*   **Payload的风险:** 使用sqlmap进行--dump操作存在一定的数据泄露风险，攻击者可能通过该操作获取数据库中的敏感信息。

总体来说，直接的投毒风险较低，但使用该POC代码进行漏洞利用可能导致严重的后果，需要谨慎评估和使用。投毒风险评估为10%，主要是因为sqlmap本身可能存在未知的风险，或者用户在使用时可能引入额外的payload。

**利用方式：**

1.  **身份验证：** 攻击者需要拥有 Nagios XI 的有效用户名和密码。可以通过暴力破解、钓鱼等方式获取。
2.  **获取 Token：** 使用获得的用户名和密码，调用 Nagios XI 的 API `/nagiosxi/api/v1/authenticate` 获取身份验证 Token。
3.  **构造恶意请求：** 构造一个包含恶意 `id` 参数的 POST 请求，发送到 `/nagiosxi/admin/banner_message-ajaxhelper.php`。`id` 参数中包含 SQL 注入 Payload。
4.  **执行 SQL 命令：** Nagios XI 服务器在处理请求时，会将恶意 `id` 参数中的 SQL 代码注入到数据库查询中，导致任意 SQL 命令的执行。
5.  **提取数据/控制系统：** 攻击者可以通过执行 SQL 命令提取数据库中的敏感数据，或者修改数据库内容，甚至可以通过数据库执行操作系统命令，从而完全控制 Nagios XI 服务器。

**项目地址:** [sealldeveloper/CVE-2023-40931-PoC](https://github.com/sealldeveloper/CVE-2023-40931-PoC)

**漏洞详情:** [CVE-2023-40931](https://nvd.nist.gov/vuln/detail/CVE-2023-40931)

---



---

## POC #3

**来源**: [CVE-2023-40931-sealldeveloper_CVE-2023-40931-PoC.md](../2023/CVE-2023-40931-sealldeveloper_CVE-2023-40931-PoC.md)

## CVE-2023-40931-Nagios XI-SQL注入

**漏洞编号:** CVE-2023-40931

**漏洞类型:** SQL注入

**影响应用:** Nagios XI

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 5.11.0 to 5.11.1

**利用条件:** 需要有效的Nagios XI用户名和密码，以及目标实例的网络访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-40931 是 Nagios XI 5.11.0 到 5.11.1 版本中存在的 SQL 注入漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许经过身份验证的攻击者通过向 `/nagiosxi/admin/banner_message-ajaxhelper.php` 发送包含恶意 `id` 参数的 POST 请求，执行任意 SQL 命令。

**有效性：**

提供的sqlmap命令看起来是有效的，它可以自动化漏洞利用过程。 它首先使用提供的用户名和密码向 API 进行身份验证以获取token，然后使用此token构造一个恶意的URL,其中`id`参数用于注入SQL payload。 sqlmap工具可以自动检测和利用SQL注入漏洞，并提取数据库信息。

**投毒风险：**

提供的POC代码是一个sqlmap命令，本身不包含直接执行恶意操作的代码。但是，需要注意以下几点：

*   **sqlmap 的安全性：** sqlmap 是一个功能强大的工具，但也可能被用于恶意目的。从不可信的来源下载或使用修改过的 sqlmap 可能存在风险。
*   **目标系统的风险：** 成功利用 SQL 注入漏洞可能导致完全控制目标系统。这取决于数据库权限和系统配置。
*   **Payload的风险:** 使用sqlmap进行--dump操作存在一定的数据泄露风险，攻击者可能通过该操作获取数据库中的敏感信息。

总体来说，直接的投毒风险较低，但使用该POC代码进行漏洞利用可能导致严重的后果，需要谨慎评估和使用。投毒风险评估为10%，主要是因为sqlmap本身可能存在未知的风险，或者用户在使用时可能引入额外的payload。

**利用方式：**

1.  **身份验证：** 攻击者需要拥有 Nagios XI 的有效用户名和密码。可以通过暴力破解、钓鱼等方式获取。
2.  **获取 Token：** 使用获得的用户名和密码，调用 Nagios XI 的 API `/nagiosxi/api/v1/authenticate` 获取身份验证 Token。
3.  **构造恶意请求：** 构造一个包含恶意 `id` 参数的 POST 请求，发送到 `/nagiosxi/admin/banner_message-ajaxhelper.php`。`id` 参数中包含 SQL 注入 Payload。
4.  **执行 SQL 命令：** Nagios XI 服务器在处理请求时，会将恶意 `id` 参数中的 SQL 代码注入到数据库查询中，导致任意 SQL 命令的执行。
5.  **提取数据/控制系统：** 攻击者可以通过执行 SQL 命令提取数据库中的敏感数据，或者修改数据库内容，甚至可以通过数据库执行操作系统命令，从而完全控制 Nagios XI 服务器。

**项目地址:** [sealldeveloper/CVE-2023-40931-PoC](https://github.com/sealldeveloper/CVE-2023-40931-PoC)

**漏洞详情:** [CVE-2023-40931](https://nvd.nist.gov/vuln/detail/CVE-2023-40931)

---

