# CVE-2023-22894

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-22894-Saboor-Hakimi_CVE-2023-22894.md](../2023/CVE-2023-22894-Saboor-Hakimi_CVE-2023-22894.md)

## CVE-2023-22894-Strapi-敏感信息泄露

**漏洞编号:** CVE-2023-22894

**漏洞类型:** 敏感信息泄露

**影响应用:** Strapi

**危害等级:** 中危，可导致用户密码哈希和重置令牌泄露

**影响版本:** <= 4.5.5

**利用条件:** 需要访问Strapi管理面板

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-22894允许攻击者（需要访问管理面板）通过利用查询过滤器来发现敏感的用户详情。攻击者可以通过包含敏感信息的列来过滤用户，并从API响应中推断出值。如果攻击者具有超级管理员权限，则可以利用此漏洞来发现所有用户的密码哈希和密码重置令牌。如果攻击者拥有可以访问权限较低角色的API用户的用户名和电子邮件的管理面板访问权限（例如，编辑或作者），则可以利用此漏洞来发现所有API用户的敏感信息，但不能发现其他管理帐户的信息。

**有效性：**

根据漏洞描述和搜索引擎结果，提供的PoC代码是有效的。漏洞利用代码中的 `dump-auth.py` 脚本需要管理员权限，通过登录管理面板获取 API Token，然后利用 API 过滤功能，逐步猜测并dump出用户的密码哈希和密码重置 Token。代码中使用了多线程来加速密码哈希的猜测。

**投毒风险：**

代码主要功能是利用已知的 Strapi 漏洞，通过构造特定的 API 请求来获取敏感信息，并未发现明显的恶意代码或后门。`dump-authless.py`代码不完整，无法评估，不过可以推断出该代码会尝试在未经身份验证的情况下利用该漏洞。但是，也不能完全排除作者在代码中隐藏了不易察觉的投毒代码的可能性。保守估计投毒的概率为1%。

**利用方式：**

1.  **获取管理员权限：** 攻击者首先需要通过某种方式获取 Strapi 管理面板的访问权限，例如通过弱口令、社工或其他漏洞。
2.  **登录管理面板：** 使用有效的管理员凭据登录 Strapi 管理面板。
3.  **获取 API Token：**  `dump-auth.py` 脚本会自动完成，`dump-authless.py` 可能通过某些未知的漏洞实现。
4.  **利用 API 过滤：** 脚本通过构造恶意的 API 请求，利用 Strapi 的查询过滤器漏洞，筛选用户数据。
5.  **猜测密码哈希/Token：**  脚本通过逐个字符猜测的方式，dump 出用户的密码哈希和密码重置 Token。

总而言之，该漏洞利用的有效性较高，但前提是攻击者需要获得管理员权限。投毒风险较低，但仍需保持警惕。

**项目地址:** [Saboor-Hakimi/CVE-2023-22894](https://github.com/Saboor-Hakimi/CVE-2023-22894)

**漏洞详情:** [CVE-2023-22894](https://nvd.nist.gov/vuln/detail/CVE-2023-22894)

---

## POC #2

**来源**: [CVE-2023-22894-maxntv24_CVE-2023-22894-PoC.md](../2023/CVE-2023-22894-maxntv24_CVE-2023-22894-PoC.md)

# CVE-2023-22894

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-22894-Saboor-Hakimi_CVE-2023-22894.md](../2023/CVE-2023-22894-Saboor-Hakimi_CVE-2023-22894.md)

## CVE-2023-22894-Strapi-敏感信息泄露

**漏洞编号:** CVE-2023-22894

**漏洞类型:** 敏感信息泄露

**影响应用:** Strapi

**危害等级:** 中危，可导致用户密码哈希和重置令牌泄露

**影响版本:** <= 4.5.5

**利用条件:** 需要访问Strapi管理面板

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-22894允许攻击者（需要访问管理面板）通过利用查询过滤器来发现敏感的用户详情。攻击者可以通过包含敏感信息的列来过滤用户，并从API响应中推断出值。如果攻击者具有超级管理员权限，则可以利用此漏洞来发现所有用户的密码哈希和密码重置令牌。如果攻击者拥有可以访问权限较低角色的API用户的用户名和电子邮件的管理面板访问权限（例如，编辑或作者），则可以利用此漏洞来发现所有API用户的敏感信息，但不能发现其他管理帐户的信息。

**有效性：**

根据漏洞描述和搜索引擎结果，提供的PoC代码是有效的。漏洞利用代码中的 `dump-auth.py` 脚本需要管理员权限，通过登录管理面板获取 API Token，然后利用 API 过滤功能，逐步猜测并dump出用户的密码哈希和密码重置 Token。代码中使用了多线程来加速密码哈希的猜测。

**投毒风险：**

代码主要功能是利用已知的 Strapi 漏洞，通过构造特定的 API 请求来获取敏感信息，并未发现明显的恶意代码或后门。`dump-authless.py`代码不完整，无法评估，不过可以推断出该代码会尝试在未经身份验证的情况下利用该漏洞。但是，也不能完全排除作者在代码中隐藏了不易察觉的投毒代码的可能性。保守估计投毒的概率为1%。

**利用方式：**

1.  **获取管理员权限：** 攻击者首先需要通过某种方式获取 Strapi 管理面板的访问权限，例如通过弱口令、社工或其他漏洞。
2.  **登录管理面板：** 使用有效的管理员凭据登录 Strapi 管理面板。
3.  **获取 API Token：**  `dump-auth.py` 脚本会自动完成，`dump-authless.py` 可能通过某些未知的漏洞实现。
4.  **利用 API 过滤：** 脚本通过构造恶意的 API 请求，利用 Strapi 的查询过滤器漏洞，筛选用户数据。
5.  **猜测密码哈希/Token：**  脚本通过逐个字符猜测的方式，dump 出用户的密码哈希和密码重置 Token。

总而言之，该漏洞利用的有效性较高，但前提是攻击者需要获得管理员权限。投毒风险较低，但仍需保持警惕。

**项目地址:** [Saboor-Hakimi/CVE-2023-22894](https://github.com/Saboor-Hakimi/CVE-2023-22894)

**漏洞详情:** [CVE-2023-22894](https://nvd.nist.gov/vuln/detail/CVE-2023-22894)

---

## POC #2

**来源**: [CVE-2023-22894-maxntv24_CVE-2023-22894-PoC.md](../2023/CVE-2023-22894-maxntv24_CVE-2023-22894-PoC.md)

# CVE-2023-22894

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-22894-Saboor-Hakimi_CVE-2023-22894.md](../2023/CVE-2023-22894-Saboor-Hakimi_CVE-2023-22894.md)

## CVE-2023-22894-Strapi-敏感信息泄露

**漏洞编号:** CVE-2023-22894

**漏洞类型:** 敏感信息泄露

**影响应用:** Strapi

**危害等级:** 中危，可导致用户密码哈希和重置令牌泄露

**影响版本:** <= 4.5.5

**利用条件:** 需要访问Strapi管理面板

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-22894允许攻击者（需要访问管理面板）通过利用查询过滤器来发现敏感的用户详情。攻击者可以通过包含敏感信息的列来过滤用户，并从API响应中推断出值。如果攻击者具有超级管理员权限，则可以利用此漏洞来发现所有用户的密码哈希和密码重置令牌。如果攻击者拥有可以访问权限较低角色的API用户的用户名和电子邮件的管理面板访问权限（例如，编辑或作者），则可以利用此漏洞来发现所有API用户的敏感信息，但不能发现其他管理帐户的信息。

**有效性：**

根据漏洞描述和搜索引擎结果，提供的PoC代码是有效的。漏洞利用代码中的 `dump-auth.py` 脚本需要管理员权限，通过登录管理面板获取 API Token，然后利用 API 过滤功能，逐步猜测并dump出用户的密码哈希和密码重置 Token。代码中使用了多线程来加速密码哈希的猜测。

**投毒风险：**

代码主要功能是利用已知的 Strapi 漏洞，通过构造特定的 API 请求来获取敏感信息，并未发现明显的恶意代码或后门。`dump-authless.py`代码不完整，无法评估，不过可以推断出该代码会尝试在未经身份验证的情况下利用该漏洞。但是，也不能完全排除作者在代码中隐藏了不易察觉的投毒代码的可能性。保守估计投毒的概率为1%。

**利用方式：**

1.  **获取管理员权限：** 攻击者首先需要通过某种方式获取 Strapi 管理面板的访问权限，例如通过弱口令、社工或其他漏洞。
2.  **登录管理面板：** 使用有效的管理员凭据登录 Strapi 管理面板。
3.  **获取 API Token：**  `dump-auth.py` 脚本会自动完成，`dump-authless.py` 可能通过某些未知的漏洞实现。
4.  **利用 API 过滤：** 脚本通过构造恶意的 API 请求，利用 Strapi 的查询过滤器漏洞，筛选用户数据。
5.  **猜测密码哈希/Token：**  脚本通过逐个字符猜测的方式，dump 出用户的密码哈希和密码重置 Token。

总而言之，该漏洞利用的有效性较高，但前提是攻击者需要获得管理员权限。投毒风险较低，但仍需保持警惕。

**项目地址:** [Saboor-Hakimi/CVE-2023-22894](https://github.com/Saboor-Hakimi/CVE-2023-22894)

**漏洞详情:** [CVE-2023-22894](https://nvd.nist.gov/vuln/detail/CVE-2023-22894)

---

## POC #2

**来源**: [CVE-2023-22894-maxntv24_CVE-2023-22894-PoC.md](../2023/CVE-2023-22894-maxntv24_CVE-2023-22894-PoC.md)

# CVE-2023-22894

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-22894-Saboor-Hakimi_CVE-2023-22894.md](../2023/CVE-2023-22894-Saboor-Hakimi_CVE-2023-22894.md)

## CVE-2023-22894-Strapi-敏感信息泄露

**漏洞编号:** CVE-2023-22894

**漏洞类型:** 敏感信息泄露

**影响应用:** Strapi

**危害等级:** 中危，可导致用户密码哈希和重置令牌泄露

**影响版本:** <= 4.5.5

**利用条件:** 需要访问Strapi管理面板

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-22894允许攻击者（需要访问管理面板）通过利用查询过滤器来发现敏感的用户详情。攻击者可以通过包含敏感信息的列来过滤用户，并从API响应中推断出值。如果攻击者具有超级管理员权限，则可以利用此漏洞来发现所有用户的密码哈希和密码重置令牌。如果攻击者拥有可以访问权限较低角色的API用户的用户名和电子邮件的管理面板访问权限（例如，编辑或作者），则可以利用此漏洞来发现所有API用户的敏感信息，但不能发现其他管理帐户的信息。

**有效性：**

根据漏洞描述和搜索引擎结果，提供的PoC代码是有效的。漏洞利用代码中的 `dump-auth.py` 脚本需要管理员权限，通过登录管理面板获取 API Token，然后利用 API 过滤功能，逐步猜测并dump出用户的密码哈希和密码重置 Token。代码中使用了多线程来加速密码哈希的猜测。

**投毒风险：**

代码主要功能是利用已知的 Strapi 漏洞，通过构造特定的 API 请求来获取敏感信息，并未发现明显的恶意代码或后门。`dump-authless.py`代码不完整，无法评估，不过可以推断出该代码会尝试在未经身份验证的情况下利用该漏洞。但是，也不能完全排除作者在代码中隐藏了不易察觉的投毒代码的可能性。保守估计投毒的概率为1%。

**利用方式：**

1.  **获取管理员权限：** 攻击者首先需要通过某种方式获取 Strapi 管理面板的访问权限，例如通过弱口令、社工或其他漏洞。
2.  **登录管理面板：** 使用有效的管理员凭据登录 Strapi 管理面板。
3.  **获取 API Token：**  `dump-auth.py` 脚本会自动完成，`dump-authless.py` 可能通过某些未知的漏洞实现。
4.  **利用 API 过滤：** 脚本通过构造恶意的 API 请求，利用 Strapi 的查询过滤器漏洞，筛选用户数据。
5.  **猜测密码哈希/Token：**  脚本通过逐个字符猜测的方式，dump 出用户的密码哈希和密码重置 Token。

总而言之，该漏洞利用的有效性较高，但前提是攻击者需要获得管理员权限。投毒风险较低，但仍需保持警惕。

**项目地址:** [Saboor-Hakimi/CVE-2023-22894](https://github.com/Saboor-Hakimi/CVE-2023-22894)

**漏洞详情:** [CVE-2023-22894](https://nvd.nist.gov/vuln/detail/CVE-2023-22894)

---

## POC #2

**来源**: [CVE-2023-22894-maxntv24_CVE-2023-22894-PoC.md](../2023/CVE-2023-22894-maxntv24_CVE-2023-22894-PoC.md)

# CVE-2023-22894

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-22894-Saboor-Hakimi_CVE-2023-22894.md](../2023/CVE-2023-22894-Saboor-Hakimi_CVE-2023-22894.md)

## CVE-2023-22894-Strapi-敏感信息泄露

**漏洞编号:** CVE-2023-22894

**漏洞类型:** 敏感信息泄露

**影响应用:** Strapi

**危害等级:** 中危，可导致用户密码哈希和重置令牌泄露

**影响版本:** <= 4.5.5

**利用条件:** 需要访问Strapi管理面板

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-22894允许攻击者（需要访问管理面板）通过利用查询过滤器来发现敏感的用户详情。攻击者可以通过包含敏感信息的列来过滤用户，并从API响应中推断出值。如果攻击者具有超级管理员权限，则可以利用此漏洞来发现所有用户的密码哈希和密码重置令牌。如果攻击者拥有可以访问权限较低角色的API用户的用户名和电子邮件的管理面板访问权限（例如，编辑或作者），则可以利用此漏洞来发现所有API用户的敏感信息，但不能发现其他管理帐户的信息。

**有效性：**

根据漏洞描述和搜索引擎结果，提供的PoC代码是有效的。漏洞利用代码中的 `dump-auth.py` 脚本需要管理员权限，通过登录管理面板获取 API Token，然后利用 API 过滤功能，逐步猜测并dump出用户的密码哈希和密码重置 Token。代码中使用了多线程来加速密码哈希的猜测。

**投毒风险：**

代码主要功能是利用已知的 Strapi 漏洞，通过构造特定的 API 请求来获取敏感信息，并未发现明显的恶意代码或后门。`dump-authless.py`代码不完整，无法评估，不过可以推断出该代码会尝试在未经身份验证的情况下利用该漏洞。但是，也不能完全排除作者在代码中隐藏了不易察觉的投毒代码的可能性。保守估计投毒的概率为1%。

**利用方式：**

1.  **获取管理员权限：** 攻击者首先需要通过某种方式获取 Strapi 管理面板的访问权限，例如通过弱口令、社工或其他漏洞。
2.  **登录管理面板：** 使用有效的管理员凭据登录 Strapi 管理面板。
3.  **获取 API Token：**  `dump-auth.py` 脚本会自动完成，`dump-authless.py` 可能通过某些未知的漏洞实现。
4.  **利用 API 过滤：** 脚本通过构造恶意的 API 请求，利用 Strapi 的查询过滤器漏洞，筛选用户数据。
5.  **猜测密码哈希/Token：**  脚本通过逐个字符猜测的方式，dump 出用户的密码哈希和密码重置 Token。

总而言之，该漏洞利用的有效性较高，但前提是攻击者需要获得管理员权限。投毒风险较低，但仍需保持警惕。

**项目地址:** [Saboor-Hakimi/CVE-2023-22894](https://github.com/Saboor-Hakimi/CVE-2023-22894)

**漏洞详情:** [CVE-2023-22894](https://nvd.nist.gov/vuln/detail/CVE-2023-22894)

---

## POC #2

**来源**: [CVE-2023-22894-maxntv24_CVE-2023-22894-PoC.md](../2023/CVE-2023-22894-maxntv24_CVE-2023-22894-PoC.md)

# CVE-2023-22894

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-22894-Saboor-Hakimi_CVE-2023-22894.md](../2023/CVE-2023-22894-Saboor-Hakimi_CVE-2023-22894.md)

## CVE-2023-22894-Strapi-敏感信息泄露

**漏洞编号:** CVE-2023-22894

**漏洞类型:** 敏感信息泄露

**影响应用:** Strapi

**危害等级:** 中危，可导致用户密码哈希和重置令牌泄露

**影响版本:** <= 4.5.5

**利用条件:** 需要访问Strapi管理面板

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-22894允许攻击者（需要访问管理面板）通过利用查询过滤器来发现敏感的用户详情。攻击者可以通过包含敏感信息的列来过滤用户，并从API响应中推断出值。如果攻击者具有超级管理员权限，则可以利用此漏洞来发现所有用户的密码哈希和密码重置令牌。如果攻击者拥有可以访问权限较低角色的API用户的用户名和电子邮件的管理面板访问权限（例如，编辑或作者），则可以利用此漏洞来发现所有API用户的敏感信息，但不能发现其他管理帐户的信息。

**有效性：**

根据漏洞描述和搜索引擎结果，提供的PoC代码是有效的。漏洞利用代码中的 `dump-auth.py` 脚本需要管理员权限，通过登录管理面板获取 API Token，然后利用 API 过滤功能，逐步猜测并dump出用户的密码哈希和密码重置 Token。代码中使用了多线程来加速密码哈希的猜测。

**投毒风险：**

代码主要功能是利用已知的 Strapi 漏洞，通过构造特定的 API 请求来获取敏感信息，并未发现明显的恶意代码或后门。`dump-authless.py`代码不完整，无法评估，不过可以推断出该代码会尝试在未经身份验证的情况下利用该漏洞。但是，也不能完全排除作者在代码中隐藏了不易察觉的投毒代码的可能性。保守估计投毒的概率为1%。

**利用方式：**

1.  **获取管理员权限：** 攻击者首先需要通过某种方式获取 Strapi 管理面板的访问权限，例如通过弱口令、社工或其他漏洞。
2.  **登录管理面板：** 使用有效的管理员凭据登录 Strapi 管理面板。
3.  **获取 API Token：**  `dump-auth.py` 脚本会自动完成，`dump-authless.py` 可能通过某些未知的漏洞实现。
4.  **利用 API 过滤：** 脚本通过构造恶意的 API 请求，利用 Strapi 的查询过滤器漏洞，筛选用户数据。
5.  **猜测密码哈希/Token：**  脚本通过逐个字符猜测的方式，dump 出用户的密码哈希和密码重置 Token。

总而言之，该漏洞利用的有效性较高，但前提是攻击者需要获得管理员权限。投毒风险较低，但仍需保持警惕。

**项目地址:** [Saboor-Hakimi/CVE-2023-22894](https://github.com/Saboor-Hakimi/CVE-2023-22894)

**漏洞详情:** [CVE-2023-22894](https://nvd.nist.gov/vuln/detail/CVE-2023-22894)

---

## POC #2

**来源**: [CVE-2023-22894-maxntv24_CVE-2023-22894-PoC.md](../2023/CVE-2023-22894-maxntv24_CVE-2023-22894-PoC.md)

# CVE-2023-22894

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-22894-Saboor-Hakimi_CVE-2023-22894.md](../2023/CVE-2023-22894-Saboor-Hakimi_CVE-2023-22894.md)

## CVE-2023-22894-Strapi-敏感信息泄露

**漏洞编号:** CVE-2023-22894

**漏洞类型:** 敏感信息泄露

**影响应用:** Strapi

**危害等级:** 中危，可导致用户密码哈希和重置令牌泄露

**影响版本:** <= 4.5.5

**利用条件:** 需要访问Strapi管理面板

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-22894允许攻击者（需要访问管理面板）通过利用查询过滤器来发现敏感的用户详情。攻击者可以通过包含敏感信息的列来过滤用户，并从API响应中推断出值。如果攻击者具有超级管理员权限，则可以利用此漏洞来发现所有用户的密码哈希和密码重置令牌。如果攻击者拥有可以访问权限较低角色的API用户的用户名和电子邮件的管理面板访问权限（例如，编辑或作者），则可以利用此漏洞来发现所有API用户的敏感信息，但不能发现其他管理帐户的信息。

**有效性：**

根据漏洞描述和搜索引擎结果，提供的PoC代码是有效的。漏洞利用代码中的 `dump-auth.py` 脚本需要管理员权限，通过登录管理面板获取 API Token，然后利用 API 过滤功能，逐步猜测并dump出用户的密码哈希和密码重置 Token。代码中使用了多线程来加速密码哈希的猜测。

**投毒风险：**

代码主要功能是利用已知的 Strapi 漏洞，通过构造特定的 API 请求来获取敏感信息，并未发现明显的恶意代码或后门。`dump-authless.py`代码不完整，无法评估，不过可以推断出该代码会尝试在未经身份验证的情况下利用该漏洞。但是，也不能完全排除作者在代码中隐藏了不易察觉的投毒代码的可能性。保守估计投毒的概率为1%。

**利用方式：**

1.  **获取管理员权限：** 攻击者首先需要通过某种方式获取 Strapi 管理面板的访问权限，例如通过弱口令、社工或其他漏洞。
2.  **登录管理面板：** 使用有效的管理员凭据登录 Strapi 管理面板。
3.  **获取 API Token：**  `dump-auth.py` 脚本会自动完成，`dump-authless.py` 可能通过某些未知的漏洞实现。
4.  **利用 API 过滤：** 脚本通过构造恶意的 API 请求，利用 Strapi 的查询过滤器漏洞，筛选用户数据。
5.  **猜测密码哈希/Token：**  脚本通过逐个字符猜测的方式，dump 出用户的密码哈希和密码重置 Token。

总而言之，该漏洞利用的有效性较高，但前提是攻击者需要获得管理员权限。投毒风险较低，但仍需保持警惕。

**项目地址:** [Saboor-Hakimi/CVE-2023-22894](https://github.com/Saboor-Hakimi/CVE-2023-22894)

**漏洞详情:** [CVE-2023-22894](https://nvd.nist.gov/vuln/detail/CVE-2023-22894)

---

## POC #2

**来源**: [CVE-2023-22894-maxntv24_CVE-2023-22894-PoC.md](../2023/CVE-2023-22894-maxntv24_CVE-2023-22894-PoC.md)

# CVE-2023-22894

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-22894-Saboor-Hakimi_CVE-2023-22894.md](../2023/CVE-2023-22894-Saboor-Hakimi_CVE-2023-22894.md)

## CVE-2023-22894-Strapi-敏感信息泄露

**漏洞编号:** CVE-2023-22894

**漏洞类型:** 敏感信息泄露

**影响应用:** Strapi

**危害等级:** 中危，可导致用户密码哈希和重置令牌泄露

**影响版本:** <= 4.5.5

**利用条件:** 需要访问Strapi管理面板

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-22894允许攻击者（需要访问管理面板）通过利用查询过滤器来发现敏感的用户详情。攻击者可以通过包含敏感信息的列来过滤用户，并从API响应中推断出值。如果攻击者具有超级管理员权限，则可以利用此漏洞来发现所有用户的密码哈希和密码重置令牌。如果攻击者拥有可以访问权限较低角色的API用户的用户名和电子邮件的管理面板访问权限（例如，编辑或作者），则可以利用此漏洞来发现所有API用户的敏感信息，但不能发现其他管理帐户的信息。

**有效性：**

根据漏洞描述和搜索引擎结果，提供的PoC代码是有效的。漏洞利用代码中的 `dump-auth.py` 脚本需要管理员权限，通过登录管理面板获取 API Token，然后利用 API 过滤功能，逐步猜测并dump出用户的密码哈希和密码重置 Token。代码中使用了多线程来加速密码哈希的猜测。

**投毒风险：**

代码主要功能是利用已知的 Strapi 漏洞，通过构造特定的 API 请求来获取敏感信息，并未发现明显的恶意代码或后门。`dump-authless.py`代码不完整，无法评估，不过可以推断出该代码会尝试在未经身份验证的情况下利用该漏洞。但是，也不能完全排除作者在代码中隐藏了不易察觉的投毒代码的可能性。保守估计投毒的概率为1%。

**利用方式：**

1.  **获取管理员权限：** 攻击者首先需要通过某种方式获取 Strapi 管理面板的访问权限，例如通过弱口令、社工或其他漏洞。
2.  **登录管理面板：** 使用有效的管理员凭据登录 Strapi 管理面板。
3.  **获取 API Token：**  `dump-auth.py` 脚本会自动完成，`dump-authless.py` 可能通过某些未知的漏洞实现。
4.  **利用 API 过滤：** 脚本通过构造恶意的 API 请求，利用 Strapi 的查询过滤器漏洞，筛选用户数据。
5.  **猜测密码哈希/Token：**  脚本通过逐个字符猜测的方式，dump 出用户的密码哈希和密码重置 Token。

总而言之，该漏洞利用的有效性较高，但前提是攻击者需要获得管理员权限。投毒风险较低，但仍需保持警惕。

**项目地址:** [Saboor-Hakimi/CVE-2023-22894](https://github.com/Saboor-Hakimi/CVE-2023-22894)

**漏洞详情:** [CVE-2023-22894](https://nvd.nist.gov/vuln/detail/CVE-2023-22894)

---

## POC #2

**来源**: [CVE-2023-22894-maxntv24_CVE-2023-22894-PoC.md](../2023/CVE-2023-22894-maxntv24_CVE-2023-22894-PoC.md)

## CVE-2023-22894-Strapi敏感信息泄露

**漏洞编号:** CVE-2023-22894

**漏洞类型:** 信息泄露

**影响应用:** Strapi

**危害等级:** 中危，可能导致敏感用户信息泄露

**影响版本:** <= 4.5.5

**利用条件:** 需要访问Strapi管理面板或公共API端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-22894允许攻击者（需要访问管理面板或特定API端点）通过利用查询过滤器来发现敏感用户信息。攻击者可以根据包含敏感信息的列来过滤用户，并从API响应中推断出值。漏洞利用方式如下：

1.  **访问权限：** 攻击者需要具有访问 Strapi 管理面板或具有与用户关联的公共API端点的权限。
2.  **目标API端点：** 攻击者需要确定暴露用户数据的API端点，例如`/api/users`或者自定义的关联用户的端点。
3.  **构造恶意查询：** 攻击者通过构造包含特定过滤器的恶意查询来利用漏洞。例如，使用`filters[$and][0][createdBy][password][$startsWith]`参数尝试匹配用户密码哈希的开头字符。
4.  **信息泄露：** 通过不断尝试不同的字符，攻击者可以逐步推断出完整的密码哈希或密码重置令牌。

**关于投毒风险：**

POC代码主要功能是利用多线程爆破密码hash以及重置token,代码量不大,人工review,发现
  *   代码可能存在的风险点：
    1.  **依赖风险：**  代码依赖`requests`库，如果开发者在安装该库时使用了非官方源，存在被供应链攻击的风险。这是一个间接的风险。
    2.  **资源消耗：**  多线程爆破操作会消耗大量服务器资源，如果被恶意利用，可能导致目标服务器拒绝服务。
    3.  **错误处理：**  代码的错误处理机制相对简单，如果API端点出现异常，可能导致程序崩溃或泄露敏感信息。

 综合考虑，该POC代码本身**直接包含恶意投毒代码的可能性较低**，约为5%。但是不能排除通过依赖引入间接投毒的风险，使用时应注意。


**项目地址:** [maxntv24/CVE-2023-22894-PoC](https://github.com/maxntv24/CVE-2023-22894-PoC)

**漏洞详情:** [CVE-2023-22894](https://nvd.nist.gov/vuln/detail/CVE-2023-22894)

---



---



---



---



---



---



---



---

