# CVE-2023-1545

> ğŸ“¦ è¯¥CVEæœ‰ **5** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-1545-HarshRajSinghania_CVE-2023-1545-Exploit.md](../2023/CVE-2023-1545-HarshRajSinghania_CVE-2023-1545-Exploit.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œå¦‚ç”¨æˆ·åå’Œå¯†ç 

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Teampasså®ä¾‹å¼€å¯APIåŠŸèƒ½ä¸”ç½‘ç»œå¯è¾¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼ŒCVE-2023-1545æ˜¯Teampass 3.0.0.23ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„SQLæ³¨å…¥æ¼æ´ã€‚POCä»£ç é€šè¿‡æ„é€ æ¶æ„çš„`login`å‚æ•°ï¼Œåˆ©ç”¨UNION SELECTè¯­å¥å°†æ”»å‡»è€…æ³¨å…¥çš„SQLæŸ¥è¯¢ç»“æœä¸åˆæ³•æŸ¥è¯¢ç»“æœåˆå¹¶ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯ï¼Œæå–æ•°æ®åº“ä¸­çš„æ•æ„Ÿä¿¡æ¯ï¼Œå¦‚ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œã€‚è¯¥POCé¦–å…ˆæ£€æŸ¥APIåŠŸèƒ½æ˜¯å¦å¯ç”¨ï¼Œç„¶åæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„SQLæ³¨å…¥çš„JSON payloadå‘é€åˆ°`/api/index.php/authorize`ï¼Œåˆ©ç”¨`jq`å’Œ`base64`è§£ç ä»å“åº”ä¸­æå–æ‰€éœ€æ•°æ®ã€‚å¯¹äºæŠ•æ¯’é£é™©ï¼Œè¯¥è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨SQLæ³¨å…¥æ¼æ´æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚ä½†ä¾ç„¶éœ€è¦è°¨æ…ä½¿ç”¨ä»ç½‘ç»œè·å–çš„ä»£ç ï¼Œå­˜åœ¨æå°å¯èƒ½æ€§é€šè¿‡ä¾èµ–å¼•å…¥æ¶æ„ä»£ç ï¼Œå› æ­¤é¢„ä¼°æŠ•æ¯’æ¦‚ç‡ä¸º10%ã€‚åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š

1.  **æ£€æµ‹APIçŠ¶æ€ï¼š** ä½¿ç”¨curlæ£€æµ‹Teampasså®ä¾‹æ˜¯å¦å¯ç”¨äº†APIåŠŸèƒ½ã€‚
2.  **æ„é€ æ¶æ„SQLæ³¨å…¥ï¼š** é€šè¿‡ä¿®æ”¹`login`å‚æ•°ï¼Œæ³¨å…¥SQLè¯­å¥ï¼Œç»•è¿‡èº«ä»½éªŒè¯ã€‚
3.  **æå–æ•°æ®ï¼š** ä½¿ç”¨curlå‘é€æ„é€ å¥½çš„JSON payloadï¼Œç„¶ååˆ©ç”¨`jq`å’Œ`base64`è§£ç æå–æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [HarshRajSinghania/CVE-2023-1545-Exploit](https://github.com/HarshRajSinghania/CVE-2023-1545-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---

## POC #2

**æ¥æº**: [CVE-2023-1545-gunzf0x_CVE-2023-1545.md](../2023/CVE-2023-1545-gunzf0x_CVE-2023-1545.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ•°æ®æ³„éœ²ï¼Œä¾‹å¦‚ç”¨æˆ·åå’Œå¯†ç ã€‚

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿè®¿é—®Teampassçš„WebæœåŠ¡å™¨ï¼Œå¹¶ä¸”ç›®æ ‡Teampasså®ä¾‹çš„ç‰ˆæœ¬ä½äº3.0.0.23ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2023-1545æ˜¯Teampassç‰ˆæœ¬3.0.0.23ä¹‹å‰å­˜åœ¨çš„ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„CVSSè¯„åˆ†ä¸º7.5ï¼Œå±äºé«˜å±æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„Python POCä»£ç é€šè¿‡æ„é€ æ¶æ„çš„SQLè¯­å¥ï¼Œåˆ©ç”¨Teampassçš„èº«ä»½éªŒè¯æ¥å£ä¸­çš„SQLæ³¨å…¥æ¼æ´ï¼Œç»•è¿‡èº«ä»½éªŒè¯å¹¶æå–æ•°æ®åº“ä¸­çš„ç”¨æˆ·ä¿¡æ¯ã€‚POCä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡URLæ˜¯å¦å¯è®¿é—®ï¼Œç„¶åå°è¯•ä½¿ç”¨SQLæ³¨å…¥æšä¸¾ç”¨æˆ·ï¼Œå¹¶æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚æ ¹æ®ä»£ç é€»è¾‘å’Œæ¼æ´æè¿°ï¼Œè¯¥POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»”ç»†æ£€æŸ¥äº†æä¾›çš„POCä»£ç ï¼Œæœªå‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚è¯¥è„šæœ¬çš„åŠŸèƒ½æ˜ç¡®ä¸”é›†ä¸­äºåˆ©ç”¨SQLæ³¨å…¥æ¼æ´ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å°è¯•è¿›è¡Œæœªç»æˆæƒçš„æ–‡ä»¶è®¿é—®ã€ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œæˆ–å…¶ä»–æ¶æ„æ´»åŠ¨çš„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¯ä»¥è®¤ä¸ºé£é™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Teampasså®ä¾‹çš„ç‰ˆæœ¬æ˜¯å¦ä½äº3.0.0.23ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCä»£ç ï¼Œå‘Teampassçš„/api/index.php/authorizeæ¥å£å‘é€åŒ…å«æ¶æ„SQLæ³¨å…¥çš„POSTè¯·æ±‚ã€‚
3.  æ¶æ„SQLæ³¨å…¥è¯­å¥è¢«æ’å…¥åˆ°loginå­—æ®µä¸­ï¼Œç»•è¿‡èº«ä»½éªŒè¯ï¼Œå¹¶ä»teampass_usersè¡¨ä¸­æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚
4.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æå–åˆ°çš„å¯†ç å“ˆå¸Œå€¼ï¼Œé€šè¿‡å¯†ç ç ´è§£ç­‰æ‰‹æ®µè·å–ç”¨æˆ·å¯†ç ï¼Œä»è€Œè·å¾—å¯¹Teampassç³»ç»Ÿçš„è®¿é—®æƒé™ã€‚

**é¡¹ç›®åœ°å€:** [gunzf0x/CVE-2023-1545](https://github.com/gunzf0x/CVE-2023-1545)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---

## POC #3

**æ¥æº**: [CVE-2023-1545-lineeralgebra_CVE-2023-1545-POC.md](../2023/CVE-2023-1545-lineeralgebra_CVE-2023-1545-POC.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Teampasså®ä¾‹å¯ç”¨APIï¼Œä¸”ç½‘ç»œå¯è®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2023-1545æ˜¯Teampass 3.0.0.23ä¹‹å‰ç‰ˆæœ¬ä¸­å­˜åœ¨çš„SQLæ³¨å…¥æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç åˆ†æï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š**  è¯¥æ¼æ´ç”±äºTeampassåœ¨å¤„ç†ç”¨æˆ·ç™»å½•è®¤è¯æ—¶ï¼Œå¯¹è¾“å…¥å‚æ•°ï¼ˆloginï¼‰æœªè¿›è¡Œå……åˆ†çš„è¿‡æ»¤å’Œè½¬ä¹‰ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥åœ¨loginå­—æ®µä¸­æ³¨å…¥æ¶æ„çš„SQLä»£ç ã€‚
2.  **åˆ©ç”¨æ­¥éª¤ï¼š**
    *   é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®å®šç›®æ ‡Teampasså®ä¾‹æ˜¯å¦å¯ç”¨äº†APIåŠŸèƒ½ã€‚PoCä»£ç é€šè¿‡è®¿é—®`/api/index.php/authorize`æ¥æ£€æµ‹APIæ˜¯å¦å¯ç”¨ã€‚
    *   ç„¶åï¼Œæ”»å‡»è€…æ„é€ åŒ…å«SQLæ³¨å…¥è¯­å¥çš„loginå‚æ•°ã€‚PoCä»£ç ä¸­ä½¿ç”¨äº†`UNION SELECT`è¯­å¥ï¼Œå°†æ”»å‡»è€…çš„SQLæŸ¥è¯¢ç»“æœä¸åŸå§‹æŸ¥è¯¢ç»“æœåˆå¹¶ï¼Œä»è€Œè·å–æ•°æ®åº“ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚ç‰¹åˆ«æ„é€ äº†loginä¸º `none' UNION SELECT ...` è¿™æ ·çš„ Payloadï¼Œç»•è¿‡äº†åŸæœ‰çš„loginéªŒè¯ã€‚å¯†ç éšæ„å¡«å†™ï¼Œapikeyä¹Ÿéšæ„ã€‚
    *   é€šè¿‡å‘é€POSTè¯·æ±‚åˆ°`/api/index.php/authorize`ç«¯ç‚¹ï¼Œå°†åŒ…å«æ¶æ„SQLä»£ç çš„JSONæ•°æ®å‘é€ç»™TeampassæœåŠ¡å™¨ã€‚
    *   æœåŠ¡å™¨æ‰§è¡ŒSQLæŸ¥è¯¢åï¼Œä¼šå°†æŸ¥è¯¢ç»“æœåŒ…å«åœ¨è¿”å›çš„tokenä¸­ã€‚æ”»å‡»è€…å¯ä»¥ä»tokenä¸­æå–`public_key`å­—æ®µï¼Œè¯¥å­—æ®µåŒ…å«äº†SQLæŸ¥è¯¢çš„ç»“æœã€‚
3.  **PoCä»£ç åˆ†æï¼š**
    *   PoCä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡APIæ˜¯å¦å¯ç”¨ã€‚
    *   `exec_sql`å‡½æ•°å°è£…äº†SQLæ³¨å…¥çš„è¿‡ç¨‹ï¼Œæ¥æ”¶SQLæŸ¥è¯¢è¯­å¥ä½œä¸ºå‚æ•°ï¼Œæ„é€ åŒ…å«æ³¨å…¥è¯­å¥çš„JSONæ•°æ®ï¼Œå‘é€POSTè¯·æ±‚ï¼Œå¹¶ä»è¿”å›çš„tokenä¸­æå–æŸ¥è¯¢ç»“æœã€‚
    *   PoCä»£ç é¦–å…ˆä½¿ç”¨`SELECT COUNT(*) FROM teampass_users WHERE pw != ''`è¯­å¥è·å–ç”¨æˆ·æ•°é‡ï¼Œç„¶åå¾ªç¯éå†ç”¨æˆ·ï¼Œä½¿ç”¨`SELECT login FROM teampass_users WHERE pw != '' ORDER BY login ASC LIMIT {i},1`å’Œ`SELECT pw FROM teampass_users WHERE pw != '' ORDER BY login ASC LIMIT {i},1`è¯­å¥åˆ†åˆ«è·å–ç”¨æˆ·åå’Œå¯†ç ã€‚
4.  **æœ‰æ•ˆæ€§ï¼š**  æ ¹æ®æä¾›çš„æœç´¢å¼•æ“ç»“æœï¼Œå­˜åœ¨å…¬å¼€çš„æ¼æ´åˆ©ç”¨expï¼Œå¹¶ä¸”æ¼æ´å½±å“ç‰ˆæœ¬å°äº3.0.0.23ï¼Œåˆ©ç”¨ä»£ç å®Œæ•´ï¼Œå‚æ•°æ˜ç¡®ï¼Œå› æ­¤åˆ¤æ–­POCä»£ç æœ‰æ•ˆã€‚
5.  **æŠ•æ¯’é£é™©ï¼š**  è¯¥ä»£ç ä¸»è¦å®ç°äº†SQLæ³¨å…¥åˆ©ç”¨ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ã€‚æ¯”å¦‚ä¸‹è½½å…¶ä»–æ–‡ä»¶ã€æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ç­‰ã€‚ä»£ç ä¸­å­˜åœ¨çš„é£é™©ç‚¹åœ¨äºï¼Œå¯èƒ½ä¼šè¢«æ»¥ç”¨è¿›è¡Œæœªæˆæƒçš„æ•°æ®åº“ä¿¡æ¯çªƒå–ã€‚ä½†æ˜¯ä½œä¸ºPOCæœ¬èº«ï¼Œä¸å±äºæŠ•æ¯’è¡Œä¸ºã€‚ç»†å¾®æŠ•æ¯’å¯èƒ½åœ¨äºï¼ŒPoCä¸­ä½¿ç”¨çš„`arbitrary_hash`å¯èƒ½ä¼šè¯¯å¯¼ä½¿ç”¨è€…ï¼Œè®¤ä¸ºæ”»å‡»è€…å¯ä»¥é€šè¿‡è¯¥hashç›´æ¥ç™»å½•ï¼Œå®é™…ä¸Šéœ€è¦æ›¿æ¢æˆç›®æ ‡ç”¨æˆ·çš„å¯†ç hashã€‚æ•…æŠ•æ¯’é£é™©è¾ƒä½, ä¼°ç®—ä¸º 5%ã€‚

**é¡¹ç›®åœ°å€:** [lineeralgebra/CVE-2023-1545-POC](https://github.com/lineeralgebra/CVE-2023-1545-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---

## POC #4

**æ¥æº**: [CVE-2023-1545-sternstundes_CVE-2023-1545-POC-python.md](../2023/CVE-2023-1545-sternstundes_CVE-2023-1545-POC-python.md)

# CVE-2023-1545

> ğŸ“¦ è¯¥CVEæœ‰ **5** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-1545-HarshRajSinghania_CVE-2023-1545-Exploit.md](../2023/CVE-2023-1545-HarshRajSinghania_CVE-2023-1545-Exploit.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œå¦‚ç”¨æˆ·åå’Œå¯†ç 

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Teampasså®ä¾‹å¼€å¯APIåŠŸèƒ½ä¸”ç½‘ç»œå¯è¾¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼ŒCVE-2023-1545æ˜¯Teampass 3.0.0.23ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„SQLæ³¨å…¥æ¼æ´ã€‚POCä»£ç é€šè¿‡æ„é€ æ¶æ„çš„`login`å‚æ•°ï¼Œåˆ©ç”¨UNION SELECTè¯­å¥å°†æ”»å‡»è€…æ³¨å…¥çš„SQLæŸ¥è¯¢ç»“æœä¸åˆæ³•æŸ¥è¯¢ç»“æœåˆå¹¶ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯ï¼Œæå–æ•°æ®åº“ä¸­çš„æ•æ„Ÿä¿¡æ¯ï¼Œå¦‚ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œã€‚è¯¥POCé¦–å…ˆæ£€æŸ¥APIåŠŸèƒ½æ˜¯å¦å¯ç”¨ï¼Œç„¶åæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„SQLæ³¨å…¥çš„JSON payloadå‘é€åˆ°`/api/index.php/authorize`ï¼Œåˆ©ç”¨`jq`å’Œ`base64`è§£ç ä»å“åº”ä¸­æå–æ‰€éœ€æ•°æ®ã€‚å¯¹äºæŠ•æ¯’é£é™©ï¼Œè¯¥è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨SQLæ³¨å…¥æ¼æ´æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚ä½†ä¾ç„¶éœ€è¦è°¨æ…ä½¿ç”¨ä»ç½‘ç»œè·å–çš„ä»£ç ï¼Œå­˜åœ¨æå°å¯èƒ½æ€§é€šè¿‡ä¾èµ–å¼•å…¥æ¶æ„ä»£ç ï¼Œå› æ­¤é¢„ä¼°æŠ•æ¯’æ¦‚ç‡ä¸º10%ã€‚åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š

1.  **æ£€æµ‹APIçŠ¶æ€ï¼š** ä½¿ç”¨curlæ£€æµ‹Teampasså®ä¾‹æ˜¯å¦å¯ç”¨äº†APIåŠŸèƒ½ã€‚
2.  **æ„é€ æ¶æ„SQLæ³¨å…¥ï¼š** é€šè¿‡ä¿®æ”¹`login`å‚æ•°ï¼Œæ³¨å…¥SQLè¯­å¥ï¼Œç»•è¿‡èº«ä»½éªŒè¯ã€‚
3.  **æå–æ•°æ®ï¼š** ä½¿ç”¨curlå‘é€æ„é€ å¥½çš„JSON payloadï¼Œç„¶ååˆ©ç”¨`jq`å’Œ`base64`è§£ç æå–æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [HarshRajSinghania/CVE-2023-1545-Exploit](https://github.com/HarshRajSinghania/CVE-2023-1545-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---

## POC #2

**æ¥æº**: [CVE-2023-1545-gunzf0x_CVE-2023-1545.md](../2023/CVE-2023-1545-gunzf0x_CVE-2023-1545.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ•°æ®æ³„éœ²ï¼Œä¾‹å¦‚ç”¨æˆ·åå’Œå¯†ç ã€‚

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿè®¿é—®Teampassçš„WebæœåŠ¡å™¨ï¼Œå¹¶ä¸”ç›®æ ‡Teampasså®ä¾‹çš„ç‰ˆæœ¬ä½äº3.0.0.23ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2023-1545æ˜¯Teampassç‰ˆæœ¬3.0.0.23ä¹‹å‰å­˜åœ¨çš„ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„CVSSè¯„åˆ†ä¸º7.5ï¼Œå±äºé«˜å±æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„Python POCä»£ç é€šè¿‡æ„é€ æ¶æ„çš„SQLè¯­å¥ï¼Œåˆ©ç”¨Teampassçš„èº«ä»½éªŒè¯æ¥å£ä¸­çš„SQLæ³¨å…¥æ¼æ´ï¼Œç»•è¿‡èº«ä»½éªŒè¯å¹¶æå–æ•°æ®åº“ä¸­çš„ç”¨æˆ·ä¿¡æ¯ã€‚POCä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡URLæ˜¯å¦å¯è®¿é—®ï¼Œç„¶åå°è¯•ä½¿ç”¨SQLæ³¨å…¥æšä¸¾ç”¨æˆ·ï¼Œå¹¶æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚æ ¹æ®ä»£ç é€»è¾‘å’Œæ¼æ´æè¿°ï¼Œè¯¥POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»”ç»†æ£€æŸ¥äº†æä¾›çš„POCä»£ç ï¼Œæœªå‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚è¯¥è„šæœ¬çš„åŠŸèƒ½æ˜ç¡®ä¸”é›†ä¸­äºåˆ©ç”¨SQLæ³¨å…¥æ¼æ´ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å°è¯•è¿›è¡Œæœªç»æˆæƒçš„æ–‡ä»¶è®¿é—®ã€ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œæˆ–å…¶ä»–æ¶æ„æ´»åŠ¨çš„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¯ä»¥è®¤ä¸ºé£é™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Teampasså®ä¾‹çš„ç‰ˆæœ¬æ˜¯å¦ä½äº3.0.0.23ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCä»£ç ï¼Œå‘Teampassçš„/api/index.php/authorizeæ¥å£å‘é€åŒ…å«æ¶æ„SQLæ³¨å…¥çš„POSTè¯·æ±‚ã€‚
3.  æ¶æ„SQLæ³¨å…¥è¯­å¥è¢«æ’å…¥åˆ°loginå­—æ®µä¸­ï¼Œç»•è¿‡èº«ä»½éªŒè¯ï¼Œå¹¶ä»teampass_usersè¡¨ä¸­æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚
4.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æå–åˆ°çš„å¯†ç å“ˆå¸Œå€¼ï¼Œé€šè¿‡å¯†ç ç ´è§£ç­‰æ‰‹æ®µè·å–ç”¨æˆ·å¯†ç ï¼Œä»è€Œè·å¾—å¯¹Teampassç³»ç»Ÿçš„è®¿é—®æƒé™ã€‚

**é¡¹ç›®åœ°å€:** [gunzf0x/CVE-2023-1545](https://github.com/gunzf0x/CVE-2023-1545)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---

## POC #3

**æ¥æº**: [CVE-2023-1545-lineeralgebra_CVE-2023-1545-POC.md](../2023/CVE-2023-1545-lineeralgebra_CVE-2023-1545-POC.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Teampasså®ä¾‹å¯ç”¨APIï¼Œä¸”ç½‘ç»œå¯è®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2023-1545æ˜¯Teampass 3.0.0.23ä¹‹å‰ç‰ˆæœ¬ä¸­å­˜åœ¨çš„SQLæ³¨å…¥æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç åˆ†æï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š**  è¯¥æ¼æ´ç”±äºTeampassåœ¨å¤„ç†ç”¨æˆ·ç™»å½•è®¤è¯æ—¶ï¼Œå¯¹è¾“å…¥å‚æ•°ï¼ˆloginï¼‰æœªè¿›è¡Œå……åˆ†çš„è¿‡æ»¤å’Œè½¬ä¹‰ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥åœ¨loginå­—æ®µä¸­æ³¨å…¥æ¶æ„çš„SQLä»£ç ã€‚
2.  **åˆ©ç”¨æ­¥éª¤ï¼š**
    *   é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®å®šç›®æ ‡Teampasså®ä¾‹æ˜¯å¦å¯ç”¨äº†APIåŠŸèƒ½ã€‚PoCä»£ç é€šè¿‡è®¿é—®`/api/index.php/authorize`æ¥æ£€æµ‹APIæ˜¯å¦å¯ç”¨ã€‚
    *   ç„¶åï¼Œæ”»å‡»è€…æ„é€ åŒ…å«SQLæ³¨å…¥è¯­å¥çš„loginå‚æ•°ã€‚PoCä»£ç ä¸­ä½¿ç”¨äº†`UNION SELECT`è¯­å¥ï¼Œå°†æ”»å‡»è€…çš„SQLæŸ¥è¯¢ç»“æœä¸åŸå§‹æŸ¥è¯¢ç»“æœåˆå¹¶ï¼Œä»è€Œè·å–æ•°æ®åº“ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚ç‰¹åˆ«æ„é€ äº†loginä¸º `none' UNION SELECT ...` è¿™æ ·çš„ Payloadï¼Œç»•è¿‡äº†åŸæœ‰çš„loginéªŒè¯ã€‚å¯†ç éšæ„å¡«å†™ï¼Œapikeyä¹Ÿéšæ„ã€‚
    *   é€šè¿‡å‘é€POSTè¯·æ±‚åˆ°`/api/index.php/authorize`ç«¯ç‚¹ï¼Œå°†åŒ…å«æ¶æ„SQLä»£ç çš„JSONæ•°æ®å‘é€ç»™TeampassæœåŠ¡å™¨ã€‚
    *   æœåŠ¡å™¨æ‰§è¡ŒSQLæŸ¥è¯¢åï¼Œä¼šå°†æŸ¥è¯¢ç»“æœåŒ…å«åœ¨è¿”å›çš„tokenä¸­ã€‚æ”»å‡»è€…å¯ä»¥ä»tokenä¸­æå–`public_key`å­—æ®µï¼Œè¯¥å­—æ®µåŒ…å«äº†SQLæŸ¥è¯¢çš„ç»“æœã€‚
3.  **PoCä»£ç åˆ†æï¼š**
    *   PoCä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡APIæ˜¯å¦å¯ç”¨ã€‚
    *   `exec_sql`å‡½æ•°å°è£…äº†SQLæ³¨å…¥çš„è¿‡ç¨‹ï¼Œæ¥æ”¶SQLæŸ¥è¯¢è¯­å¥ä½œä¸ºå‚æ•°ï¼Œæ„é€ åŒ…å«æ³¨å…¥è¯­å¥çš„JSONæ•°æ®ï¼Œå‘é€POSTè¯·æ±‚ï¼Œå¹¶ä»è¿”å›çš„tokenä¸­æå–æŸ¥è¯¢ç»“æœã€‚
    *   PoCä»£ç é¦–å…ˆä½¿ç”¨`SELECT COUNT(*) FROM teampass_users WHERE pw != ''`è¯­å¥è·å–ç”¨æˆ·æ•°é‡ï¼Œç„¶åå¾ªç¯éå†ç”¨æˆ·ï¼Œä½¿ç”¨`SELECT login FROM teampass_users WHERE pw != '' ORDER BY login ASC LIMIT {i},1`å’Œ`SELECT pw FROM teampass_users WHERE pw != '' ORDER BY login ASC LIMIT {i},1`è¯­å¥åˆ†åˆ«è·å–ç”¨æˆ·åå’Œå¯†ç ã€‚
4.  **æœ‰æ•ˆæ€§ï¼š**  æ ¹æ®æä¾›çš„æœç´¢å¼•æ“ç»“æœï¼Œå­˜åœ¨å…¬å¼€çš„æ¼æ´åˆ©ç”¨expï¼Œå¹¶ä¸”æ¼æ´å½±å“ç‰ˆæœ¬å°äº3.0.0.23ï¼Œåˆ©ç”¨ä»£ç å®Œæ•´ï¼Œå‚æ•°æ˜ç¡®ï¼Œå› æ­¤åˆ¤æ–­POCä»£ç æœ‰æ•ˆã€‚
5.  **æŠ•æ¯’é£é™©ï¼š**  è¯¥ä»£ç ä¸»è¦å®ç°äº†SQLæ³¨å…¥åˆ©ç”¨ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ã€‚æ¯”å¦‚ä¸‹è½½å…¶ä»–æ–‡ä»¶ã€æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ç­‰ã€‚ä»£ç ä¸­å­˜åœ¨çš„é£é™©ç‚¹åœ¨äºï¼Œå¯èƒ½ä¼šè¢«æ»¥ç”¨è¿›è¡Œæœªæˆæƒçš„æ•°æ®åº“ä¿¡æ¯çªƒå–ã€‚ä½†æ˜¯ä½œä¸ºPOCæœ¬èº«ï¼Œä¸å±äºæŠ•æ¯’è¡Œä¸ºã€‚ç»†å¾®æŠ•æ¯’å¯èƒ½åœ¨äºï¼ŒPoCä¸­ä½¿ç”¨çš„`arbitrary_hash`å¯èƒ½ä¼šè¯¯å¯¼ä½¿ç”¨è€…ï¼Œè®¤ä¸ºæ”»å‡»è€…å¯ä»¥é€šè¿‡è¯¥hashç›´æ¥ç™»å½•ï¼Œå®é™…ä¸Šéœ€è¦æ›¿æ¢æˆç›®æ ‡ç”¨æˆ·çš„å¯†ç hashã€‚æ•…æŠ•æ¯’é£é™©è¾ƒä½, ä¼°ç®—ä¸º 5%ã€‚

**é¡¹ç›®åœ°å€:** [lineeralgebra/CVE-2023-1545-POC](https://github.com/lineeralgebra/CVE-2023-1545-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---

## POC #4

**æ¥æº**: [CVE-2023-1545-sternstundes_CVE-2023-1545-POC-python.md](../2023/CVE-2023-1545-sternstundes_CVE-2023-1545-POC-python.md)

# CVE-2023-1545

> ğŸ“¦ è¯¥CVEæœ‰ **5** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-1545-HarshRajSinghania_CVE-2023-1545-Exploit.md](../2023/CVE-2023-1545-HarshRajSinghania_CVE-2023-1545-Exploit.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œå¦‚ç”¨æˆ·åå’Œå¯†ç 

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Teampasså®ä¾‹å¼€å¯APIåŠŸèƒ½ä¸”ç½‘ç»œå¯è¾¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼ŒCVE-2023-1545æ˜¯Teampass 3.0.0.23ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„SQLæ³¨å…¥æ¼æ´ã€‚POCä»£ç é€šè¿‡æ„é€ æ¶æ„çš„`login`å‚æ•°ï¼Œåˆ©ç”¨UNION SELECTè¯­å¥å°†æ”»å‡»è€…æ³¨å…¥çš„SQLæŸ¥è¯¢ç»“æœä¸åˆæ³•æŸ¥è¯¢ç»“æœåˆå¹¶ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯ï¼Œæå–æ•°æ®åº“ä¸­çš„æ•æ„Ÿä¿¡æ¯ï¼Œå¦‚ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œã€‚è¯¥POCé¦–å…ˆæ£€æŸ¥APIåŠŸèƒ½æ˜¯å¦å¯ç”¨ï¼Œç„¶åæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„SQLæ³¨å…¥çš„JSON payloadå‘é€åˆ°`/api/index.php/authorize`ï¼Œåˆ©ç”¨`jq`å’Œ`base64`è§£ç ä»å“åº”ä¸­æå–æ‰€éœ€æ•°æ®ã€‚å¯¹äºæŠ•æ¯’é£é™©ï¼Œè¯¥è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨SQLæ³¨å…¥æ¼æ´æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚ä½†ä¾ç„¶éœ€è¦è°¨æ…ä½¿ç”¨ä»ç½‘ç»œè·å–çš„ä»£ç ï¼Œå­˜åœ¨æå°å¯èƒ½æ€§é€šè¿‡ä¾èµ–å¼•å…¥æ¶æ„ä»£ç ï¼Œå› æ­¤é¢„ä¼°æŠ•æ¯’æ¦‚ç‡ä¸º10%ã€‚åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š

1.  **æ£€æµ‹APIçŠ¶æ€ï¼š** ä½¿ç”¨curlæ£€æµ‹Teampasså®ä¾‹æ˜¯å¦å¯ç”¨äº†APIåŠŸèƒ½ã€‚
2.  **æ„é€ æ¶æ„SQLæ³¨å…¥ï¼š** é€šè¿‡ä¿®æ”¹`login`å‚æ•°ï¼Œæ³¨å…¥SQLè¯­å¥ï¼Œç»•è¿‡èº«ä»½éªŒè¯ã€‚
3.  **æå–æ•°æ®ï¼š** ä½¿ç”¨curlå‘é€æ„é€ å¥½çš„JSON payloadï¼Œç„¶ååˆ©ç”¨`jq`å’Œ`base64`è§£ç æå–æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [HarshRajSinghania/CVE-2023-1545-Exploit](https://github.com/HarshRajSinghania/CVE-2023-1545-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---

## POC #2

**æ¥æº**: [CVE-2023-1545-gunzf0x_CVE-2023-1545.md](../2023/CVE-2023-1545-gunzf0x_CVE-2023-1545.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ•°æ®æ³„éœ²ï¼Œä¾‹å¦‚ç”¨æˆ·åå’Œå¯†ç ã€‚

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿè®¿é—®Teampassçš„WebæœåŠ¡å™¨ï¼Œå¹¶ä¸”ç›®æ ‡Teampasså®ä¾‹çš„ç‰ˆæœ¬ä½äº3.0.0.23ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2023-1545æ˜¯Teampassç‰ˆæœ¬3.0.0.23ä¹‹å‰å­˜åœ¨çš„ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„CVSSè¯„åˆ†ä¸º7.5ï¼Œå±äºé«˜å±æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„Python POCä»£ç é€šè¿‡æ„é€ æ¶æ„çš„SQLè¯­å¥ï¼Œåˆ©ç”¨Teampassçš„èº«ä»½éªŒè¯æ¥å£ä¸­çš„SQLæ³¨å…¥æ¼æ´ï¼Œç»•è¿‡èº«ä»½éªŒè¯å¹¶æå–æ•°æ®åº“ä¸­çš„ç”¨æˆ·ä¿¡æ¯ã€‚POCä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡URLæ˜¯å¦å¯è®¿é—®ï¼Œç„¶åå°è¯•ä½¿ç”¨SQLæ³¨å…¥æšä¸¾ç”¨æˆ·ï¼Œå¹¶æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚æ ¹æ®ä»£ç é€»è¾‘å’Œæ¼æ´æè¿°ï¼Œè¯¥POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»”ç»†æ£€æŸ¥äº†æä¾›çš„POCä»£ç ï¼Œæœªå‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚è¯¥è„šæœ¬çš„åŠŸèƒ½æ˜ç¡®ä¸”é›†ä¸­äºåˆ©ç”¨SQLæ³¨å…¥æ¼æ´ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å°è¯•è¿›è¡Œæœªç»æˆæƒçš„æ–‡ä»¶è®¿é—®ã€ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œæˆ–å…¶ä»–æ¶æ„æ´»åŠ¨çš„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¯ä»¥è®¤ä¸ºé£é™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Teampasså®ä¾‹çš„ç‰ˆæœ¬æ˜¯å¦ä½äº3.0.0.23ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCä»£ç ï¼Œå‘Teampassçš„/api/index.php/authorizeæ¥å£å‘é€åŒ…å«æ¶æ„SQLæ³¨å…¥çš„POSTè¯·æ±‚ã€‚
3.  æ¶æ„SQLæ³¨å…¥è¯­å¥è¢«æ’å…¥åˆ°loginå­—æ®µä¸­ï¼Œç»•è¿‡èº«ä»½éªŒè¯ï¼Œå¹¶ä»teampass_usersè¡¨ä¸­æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚
4.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æå–åˆ°çš„å¯†ç å“ˆå¸Œå€¼ï¼Œé€šè¿‡å¯†ç ç ´è§£ç­‰æ‰‹æ®µè·å–ç”¨æˆ·å¯†ç ï¼Œä»è€Œè·å¾—å¯¹Teampassç³»ç»Ÿçš„è®¿é—®æƒé™ã€‚

**é¡¹ç›®åœ°å€:** [gunzf0x/CVE-2023-1545](https://github.com/gunzf0x/CVE-2023-1545)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---

## POC #3

**æ¥æº**: [CVE-2023-1545-lineeralgebra_CVE-2023-1545-POC.md](../2023/CVE-2023-1545-lineeralgebra_CVE-2023-1545-POC.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Teampasså®ä¾‹å¯ç”¨APIï¼Œä¸”ç½‘ç»œå¯è®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2023-1545æ˜¯Teampass 3.0.0.23ä¹‹å‰ç‰ˆæœ¬ä¸­å­˜åœ¨çš„SQLæ³¨å…¥æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç åˆ†æï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š**  è¯¥æ¼æ´ç”±äºTeampassåœ¨å¤„ç†ç”¨æˆ·ç™»å½•è®¤è¯æ—¶ï¼Œå¯¹è¾“å…¥å‚æ•°ï¼ˆloginï¼‰æœªè¿›è¡Œå……åˆ†çš„è¿‡æ»¤å’Œè½¬ä¹‰ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥åœ¨loginå­—æ®µä¸­æ³¨å…¥æ¶æ„çš„SQLä»£ç ã€‚
2.  **åˆ©ç”¨æ­¥éª¤ï¼š**
    *   é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®å®šç›®æ ‡Teampasså®ä¾‹æ˜¯å¦å¯ç”¨äº†APIåŠŸèƒ½ã€‚PoCä»£ç é€šè¿‡è®¿é—®`/api/index.php/authorize`æ¥æ£€æµ‹APIæ˜¯å¦å¯ç”¨ã€‚
    *   ç„¶åï¼Œæ”»å‡»è€…æ„é€ åŒ…å«SQLæ³¨å…¥è¯­å¥çš„loginå‚æ•°ã€‚PoCä»£ç ä¸­ä½¿ç”¨äº†`UNION SELECT`è¯­å¥ï¼Œå°†æ”»å‡»è€…çš„SQLæŸ¥è¯¢ç»“æœä¸åŸå§‹æŸ¥è¯¢ç»“æœåˆå¹¶ï¼Œä»è€Œè·å–æ•°æ®åº“ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚ç‰¹åˆ«æ„é€ äº†loginä¸º `none' UNION SELECT ...` è¿™æ ·çš„ Payloadï¼Œç»•è¿‡äº†åŸæœ‰çš„loginéªŒè¯ã€‚å¯†ç éšæ„å¡«å†™ï¼Œapikeyä¹Ÿéšæ„ã€‚
    *   é€šè¿‡å‘é€POSTè¯·æ±‚åˆ°`/api/index.php/authorize`ç«¯ç‚¹ï¼Œå°†åŒ…å«æ¶æ„SQLä»£ç çš„JSONæ•°æ®å‘é€ç»™TeampassæœåŠ¡å™¨ã€‚
    *   æœåŠ¡å™¨æ‰§è¡ŒSQLæŸ¥è¯¢åï¼Œä¼šå°†æŸ¥è¯¢ç»“æœåŒ…å«åœ¨è¿”å›çš„tokenä¸­ã€‚æ”»å‡»è€…å¯ä»¥ä»tokenä¸­æå–`public_key`å­—æ®µï¼Œè¯¥å­—æ®µåŒ…å«äº†SQLæŸ¥è¯¢çš„ç»“æœã€‚
3.  **PoCä»£ç åˆ†æï¼š**
    *   PoCä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡APIæ˜¯å¦å¯ç”¨ã€‚
    *   `exec_sql`å‡½æ•°å°è£…äº†SQLæ³¨å…¥çš„è¿‡ç¨‹ï¼Œæ¥æ”¶SQLæŸ¥è¯¢è¯­å¥ä½œä¸ºå‚æ•°ï¼Œæ„é€ åŒ…å«æ³¨å…¥è¯­å¥çš„JSONæ•°æ®ï¼Œå‘é€POSTè¯·æ±‚ï¼Œå¹¶ä»è¿”å›çš„tokenä¸­æå–æŸ¥è¯¢ç»“æœã€‚
    *   PoCä»£ç é¦–å…ˆä½¿ç”¨`SELECT COUNT(*) FROM teampass_users WHERE pw != ''`è¯­å¥è·å–ç”¨æˆ·æ•°é‡ï¼Œç„¶åå¾ªç¯éå†ç”¨æˆ·ï¼Œä½¿ç”¨`SELECT login FROM teampass_users WHERE pw != '' ORDER BY login ASC LIMIT {i},1`å’Œ`SELECT pw FROM teampass_users WHERE pw != '' ORDER BY login ASC LIMIT {i},1`è¯­å¥åˆ†åˆ«è·å–ç”¨æˆ·åå’Œå¯†ç ã€‚
4.  **æœ‰æ•ˆæ€§ï¼š**  æ ¹æ®æä¾›çš„æœç´¢å¼•æ“ç»“æœï¼Œå­˜åœ¨å…¬å¼€çš„æ¼æ´åˆ©ç”¨expï¼Œå¹¶ä¸”æ¼æ´å½±å“ç‰ˆæœ¬å°äº3.0.0.23ï¼Œåˆ©ç”¨ä»£ç å®Œæ•´ï¼Œå‚æ•°æ˜ç¡®ï¼Œå› æ­¤åˆ¤æ–­POCä»£ç æœ‰æ•ˆã€‚
5.  **æŠ•æ¯’é£é™©ï¼š**  è¯¥ä»£ç ä¸»è¦å®ç°äº†SQLæ³¨å…¥åˆ©ç”¨ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ã€‚æ¯”å¦‚ä¸‹è½½å…¶ä»–æ–‡ä»¶ã€æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ç­‰ã€‚ä»£ç ä¸­å­˜åœ¨çš„é£é™©ç‚¹åœ¨äºï¼Œå¯èƒ½ä¼šè¢«æ»¥ç”¨è¿›è¡Œæœªæˆæƒçš„æ•°æ®åº“ä¿¡æ¯çªƒå–ã€‚ä½†æ˜¯ä½œä¸ºPOCæœ¬èº«ï¼Œä¸å±äºæŠ•æ¯’è¡Œä¸ºã€‚ç»†å¾®æŠ•æ¯’å¯èƒ½åœ¨äºï¼ŒPoCä¸­ä½¿ç”¨çš„`arbitrary_hash`å¯èƒ½ä¼šè¯¯å¯¼ä½¿ç”¨è€…ï¼Œè®¤ä¸ºæ”»å‡»è€…å¯ä»¥é€šè¿‡è¯¥hashç›´æ¥ç™»å½•ï¼Œå®é™…ä¸Šéœ€è¦æ›¿æ¢æˆç›®æ ‡ç”¨æˆ·çš„å¯†ç hashã€‚æ•…æŠ•æ¯’é£é™©è¾ƒä½, ä¼°ç®—ä¸º 5%ã€‚

**é¡¹ç›®åœ°å€:** [lineeralgebra/CVE-2023-1545-POC](https://github.com/lineeralgebra/CVE-2023-1545-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---

## POC #4

**æ¥æº**: [CVE-2023-1545-sternstundes_CVE-2023-1545-POC-python.md](../2023/CVE-2023-1545-sternstundes_CVE-2023-1545-POC-python.md)

# CVE-2023-1545

> ğŸ“¦ è¯¥CVEæœ‰ **5** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-1545-HarshRajSinghania_CVE-2023-1545-Exploit.md](../2023/CVE-2023-1545-HarshRajSinghania_CVE-2023-1545-Exploit.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œå¦‚ç”¨æˆ·åå’Œå¯†ç 

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Teampasså®ä¾‹å¼€å¯APIåŠŸèƒ½ä¸”ç½‘ç»œå¯è¾¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼ŒCVE-2023-1545æ˜¯Teampass 3.0.0.23ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„SQLæ³¨å…¥æ¼æ´ã€‚POCä»£ç é€šè¿‡æ„é€ æ¶æ„çš„`login`å‚æ•°ï¼Œåˆ©ç”¨UNION SELECTè¯­å¥å°†æ”»å‡»è€…æ³¨å…¥çš„SQLæŸ¥è¯¢ç»“æœä¸åˆæ³•æŸ¥è¯¢ç»“æœåˆå¹¶ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯ï¼Œæå–æ•°æ®åº“ä¸­çš„æ•æ„Ÿä¿¡æ¯ï¼Œå¦‚ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œã€‚è¯¥POCé¦–å…ˆæ£€æŸ¥APIåŠŸèƒ½æ˜¯å¦å¯ç”¨ï¼Œç„¶åæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„SQLæ³¨å…¥çš„JSON payloadå‘é€åˆ°`/api/index.php/authorize`ï¼Œåˆ©ç”¨`jq`å’Œ`base64`è§£ç ä»å“åº”ä¸­æå–æ‰€éœ€æ•°æ®ã€‚å¯¹äºæŠ•æ¯’é£é™©ï¼Œè¯¥è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨SQLæ³¨å…¥æ¼æ´æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚ä½†ä¾ç„¶éœ€è¦è°¨æ…ä½¿ç”¨ä»ç½‘ç»œè·å–çš„ä»£ç ï¼Œå­˜åœ¨æå°å¯èƒ½æ€§é€šè¿‡ä¾èµ–å¼•å…¥æ¶æ„ä»£ç ï¼Œå› æ­¤é¢„ä¼°æŠ•æ¯’æ¦‚ç‡ä¸º10%ã€‚åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š

1.  **æ£€æµ‹APIçŠ¶æ€ï¼š** ä½¿ç”¨curlæ£€æµ‹Teampasså®ä¾‹æ˜¯å¦å¯ç”¨äº†APIåŠŸèƒ½ã€‚
2.  **æ„é€ æ¶æ„SQLæ³¨å…¥ï¼š** é€šè¿‡ä¿®æ”¹`login`å‚æ•°ï¼Œæ³¨å…¥SQLè¯­å¥ï¼Œç»•è¿‡èº«ä»½éªŒè¯ã€‚
3.  **æå–æ•°æ®ï¼š** ä½¿ç”¨curlå‘é€æ„é€ å¥½çš„JSON payloadï¼Œç„¶ååˆ©ç”¨`jq`å’Œ`base64`è§£ç æå–æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [HarshRajSinghania/CVE-2023-1545-Exploit](https://github.com/HarshRajSinghania/CVE-2023-1545-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---

## POC #2

**æ¥æº**: [CVE-2023-1545-gunzf0x_CVE-2023-1545.md](../2023/CVE-2023-1545-gunzf0x_CVE-2023-1545.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ•°æ®æ³„éœ²ï¼Œä¾‹å¦‚ç”¨æˆ·åå’Œå¯†ç ã€‚

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿè®¿é—®Teampassçš„WebæœåŠ¡å™¨ï¼Œå¹¶ä¸”ç›®æ ‡Teampasså®ä¾‹çš„ç‰ˆæœ¬ä½äº3.0.0.23ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2023-1545æ˜¯Teampassç‰ˆæœ¬3.0.0.23ä¹‹å‰å­˜åœ¨çš„ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„CVSSè¯„åˆ†ä¸º7.5ï¼Œå±äºé«˜å±æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„Python POCä»£ç é€šè¿‡æ„é€ æ¶æ„çš„SQLè¯­å¥ï¼Œåˆ©ç”¨Teampassçš„èº«ä»½éªŒè¯æ¥å£ä¸­çš„SQLæ³¨å…¥æ¼æ´ï¼Œç»•è¿‡èº«ä»½éªŒè¯å¹¶æå–æ•°æ®åº“ä¸­çš„ç”¨æˆ·ä¿¡æ¯ã€‚POCä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡URLæ˜¯å¦å¯è®¿é—®ï¼Œç„¶åå°è¯•ä½¿ç”¨SQLæ³¨å…¥æšä¸¾ç”¨æˆ·ï¼Œå¹¶æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚æ ¹æ®ä»£ç é€»è¾‘å’Œæ¼æ´æè¿°ï¼Œè¯¥POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»”ç»†æ£€æŸ¥äº†æä¾›çš„POCä»£ç ï¼Œæœªå‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚è¯¥è„šæœ¬çš„åŠŸèƒ½æ˜ç¡®ä¸”é›†ä¸­äºåˆ©ç”¨SQLæ³¨å…¥æ¼æ´ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å°è¯•è¿›è¡Œæœªç»æˆæƒçš„æ–‡ä»¶è®¿é—®ã€ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œæˆ–å…¶ä»–æ¶æ„æ´»åŠ¨çš„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¯ä»¥è®¤ä¸ºé£é™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Teampasså®ä¾‹çš„ç‰ˆæœ¬æ˜¯å¦ä½äº3.0.0.23ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCä»£ç ï¼Œå‘Teampassçš„/api/index.php/authorizeæ¥å£å‘é€åŒ…å«æ¶æ„SQLæ³¨å…¥çš„POSTè¯·æ±‚ã€‚
3.  æ¶æ„SQLæ³¨å…¥è¯­å¥è¢«æ’å…¥åˆ°loginå­—æ®µä¸­ï¼Œç»•è¿‡èº«ä»½éªŒè¯ï¼Œå¹¶ä»teampass_usersè¡¨ä¸­æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚
4.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æå–åˆ°çš„å¯†ç å“ˆå¸Œå€¼ï¼Œé€šè¿‡å¯†ç ç ´è§£ç­‰æ‰‹æ®µè·å–ç”¨æˆ·å¯†ç ï¼Œä»è€Œè·å¾—å¯¹Teampassç³»ç»Ÿçš„è®¿é—®æƒé™ã€‚

**é¡¹ç›®åœ°å€:** [gunzf0x/CVE-2023-1545](https://github.com/gunzf0x/CVE-2023-1545)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---

## POC #3

**æ¥æº**: [CVE-2023-1545-lineeralgebra_CVE-2023-1545-POC.md](../2023/CVE-2023-1545-lineeralgebra_CVE-2023-1545-POC.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Teampasså®ä¾‹å¯ç”¨APIï¼Œä¸”ç½‘ç»œå¯è®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2023-1545æ˜¯Teampass 3.0.0.23ä¹‹å‰ç‰ˆæœ¬ä¸­å­˜åœ¨çš„SQLæ³¨å…¥æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç åˆ†æï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š**  è¯¥æ¼æ´ç”±äºTeampassåœ¨å¤„ç†ç”¨æˆ·ç™»å½•è®¤è¯æ—¶ï¼Œå¯¹è¾“å…¥å‚æ•°ï¼ˆloginï¼‰æœªè¿›è¡Œå……åˆ†çš„è¿‡æ»¤å’Œè½¬ä¹‰ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥åœ¨loginå­—æ®µä¸­æ³¨å…¥æ¶æ„çš„SQLä»£ç ã€‚
2.  **åˆ©ç”¨æ­¥éª¤ï¼š**
    *   é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®å®šç›®æ ‡Teampasså®ä¾‹æ˜¯å¦å¯ç”¨äº†APIåŠŸèƒ½ã€‚PoCä»£ç é€šè¿‡è®¿é—®`/api/index.php/authorize`æ¥æ£€æµ‹APIæ˜¯å¦å¯ç”¨ã€‚
    *   ç„¶åï¼Œæ”»å‡»è€…æ„é€ åŒ…å«SQLæ³¨å…¥è¯­å¥çš„loginå‚æ•°ã€‚PoCä»£ç ä¸­ä½¿ç”¨äº†`UNION SELECT`è¯­å¥ï¼Œå°†æ”»å‡»è€…çš„SQLæŸ¥è¯¢ç»“æœä¸åŸå§‹æŸ¥è¯¢ç»“æœåˆå¹¶ï¼Œä»è€Œè·å–æ•°æ®åº“ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚ç‰¹åˆ«æ„é€ äº†loginä¸º `none' UNION SELECT ...` è¿™æ ·çš„ Payloadï¼Œç»•è¿‡äº†åŸæœ‰çš„loginéªŒè¯ã€‚å¯†ç éšæ„å¡«å†™ï¼Œapikeyä¹Ÿéšæ„ã€‚
    *   é€šè¿‡å‘é€POSTè¯·æ±‚åˆ°`/api/index.php/authorize`ç«¯ç‚¹ï¼Œå°†åŒ…å«æ¶æ„SQLä»£ç çš„JSONæ•°æ®å‘é€ç»™TeampassæœåŠ¡å™¨ã€‚
    *   æœåŠ¡å™¨æ‰§è¡ŒSQLæŸ¥è¯¢åï¼Œä¼šå°†æŸ¥è¯¢ç»“æœåŒ…å«åœ¨è¿”å›çš„tokenä¸­ã€‚æ”»å‡»è€…å¯ä»¥ä»tokenä¸­æå–`public_key`å­—æ®µï¼Œè¯¥å­—æ®µåŒ…å«äº†SQLæŸ¥è¯¢çš„ç»“æœã€‚
3.  **PoCä»£ç åˆ†æï¼š**
    *   PoCä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡APIæ˜¯å¦å¯ç”¨ã€‚
    *   `exec_sql`å‡½æ•°å°è£…äº†SQLæ³¨å…¥çš„è¿‡ç¨‹ï¼Œæ¥æ”¶SQLæŸ¥è¯¢è¯­å¥ä½œä¸ºå‚æ•°ï¼Œæ„é€ åŒ…å«æ³¨å…¥è¯­å¥çš„JSONæ•°æ®ï¼Œå‘é€POSTè¯·æ±‚ï¼Œå¹¶ä»è¿”å›çš„tokenä¸­æå–æŸ¥è¯¢ç»“æœã€‚
    *   PoCä»£ç é¦–å…ˆä½¿ç”¨`SELECT COUNT(*) FROM teampass_users WHERE pw != ''`è¯­å¥è·å–ç”¨æˆ·æ•°é‡ï¼Œç„¶åå¾ªç¯éå†ç”¨æˆ·ï¼Œä½¿ç”¨`SELECT login FROM teampass_users WHERE pw != '' ORDER BY login ASC LIMIT {i},1`å’Œ`SELECT pw FROM teampass_users WHERE pw != '' ORDER BY login ASC LIMIT {i},1`è¯­å¥åˆ†åˆ«è·å–ç”¨æˆ·åå’Œå¯†ç ã€‚
4.  **æœ‰æ•ˆæ€§ï¼š**  æ ¹æ®æä¾›çš„æœç´¢å¼•æ“ç»“æœï¼Œå­˜åœ¨å…¬å¼€çš„æ¼æ´åˆ©ç”¨expï¼Œå¹¶ä¸”æ¼æ´å½±å“ç‰ˆæœ¬å°äº3.0.0.23ï¼Œåˆ©ç”¨ä»£ç å®Œæ•´ï¼Œå‚æ•°æ˜ç¡®ï¼Œå› æ­¤åˆ¤æ–­POCä»£ç æœ‰æ•ˆã€‚
5.  **æŠ•æ¯’é£é™©ï¼š**  è¯¥ä»£ç ä¸»è¦å®ç°äº†SQLæ³¨å…¥åˆ©ç”¨ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ã€‚æ¯”å¦‚ä¸‹è½½å…¶ä»–æ–‡ä»¶ã€æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ç­‰ã€‚ä»£ç ä¸­å­˜åœ¨çš„é£é™©ç‚¹åœ¨äºï¼Œå¯èƒ½ä¼šè¢«æ»¥ç”¨è¿›è¡Œæœªæˆæƒçš„æ•°æ®åº“ä¿¡æ¯çªƒå–ã€‚ä½†æ˜¯ä½œä¸ºPOCæœ¬èº«ï¼Œä¸å±äºæŠ•æ¯’è¡Œä¸ºã€‚ç»†å¾®æŠ•æ¯’å¯èƒ½åœ¨äºï¼ŒPoCä¸­ä½¿ç”¨çš„`arbitrary_hash`å¯èƒ½ä¼šè¯¯å¯¼ä½¿ç”¨è€…ï¼Œè®¤ä¸ºæ”»å‡»è€…å¯ä»¥é€šè¿‡è¯¥hashç›´æ¥ç™»å½•ï¼Œå®é™…ä¸Šéœ€è¦æ›¿æ¢æˆç›®æ ‡ç”¨æˆ·çš„å¯†ç hashã€‚æ•…æŠ•æ¯’é£é™©è¾ƒä½, ä¼°ç®—ä¸º 5%ã€‚

**é¡¹ç›®åœ°å€:** [lineeralgebra/CVE-2023-1545-POC](https://github.com/lineeralgebra/CVE-2023-1545-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---

## POC #4

**æ¥æº**: [CVE-2023-1545-sternstundes_CVE-2023-1545-POC-python.md](../2023/CVE-2023-1545-sternstundes_CVE-2023-1545-POC-python.md)

# CVE-2023-1545

> ğŸ“¦ è¯¥CVEæœ‰ **5** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-1545-HarshRajSinghania_CVE-2023-1545-Exploit.md](../2023/CVE-2023-1545-HarshRajSinghania_CVE-2023-1545-Exploit.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œå¦‚ç”¨æˆ·åå’Œå¯†ç 

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Teampasså®ä¾‹å¼€å¯APIåŠŸèƒ½ä¸”ç½‘ç»œå¯è¾¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼ŒCVE-2023-1545æ˜¯Teampass 3.0.0.23ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„SQLæ³¨å…¥æ¼æ´ã€‚POCä»£ç é€šè¿‡æ„é€ æ¶æ„çš„`login`å‚æ•°ï¼Œåˆ©ç”¨UNION SELECTè¯­å¥å°†æ”»å‡»è€…æ³¨å…¥çš„SQLæŸ¥è¯¢ç»“æœä¸åˆæ³•æŸ¥è¯¢ç»“æœåˆå¹¶ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯ï¼Œæå–æ•°æ®åº“ä¸­çš„æ•æ„Ÿä¿¡æ¯ï¼Œå¦‚ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œã€‚è¯¥POCé¦–å…ˆæ£€æŸ¥APIåŠŸèƒ½æ˜¯å¦å¯ç”¨ï¼Œç„¶åæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„SQLæ³¨å…¥çš„JSON payloadå‘é€åˆ°`/api/index.php/authorize`ï¼Œåˆ©ç”¨`jq`å’Œ`base64`è§£ç ä»å“åº”ä¸­æå–æ‰€éœ€æ•°æ®ã€‚å¯¹äºæŠ•æ¯’é£é™©ï¼Œè¯¥è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨SQLæ³¨å…¥æ¼æ´æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚ä½†ä¾ç„¶éœ€è¦è°¨æ…ä½¿ç”¨ä»ç½‘ç»œè·å–çš„ä»£ç ï¼Œå­˜åœ¨æå°å¯èƒ½æ€§é€šè¿‡ä¾èµ–å¼•å…¥æ¶æ„ä»£ç ï¼Œå› æ­¤é¢„ä¼°æŠ•æ¯’æ¦‚ç‡ä¸º10%ã€‚åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š

1.  **æ£€æµ‹APIçŠ¶æ€ï¼š** ä½¿ç”¨curlæ£€æµ‹Teampasså®ä¾‹æ˜¯å¦å¯ç”¨äº†APIåŠŸèƒ½ã€‚
2.  **æ„é€ æ¶æ„SQLæ³¨å…¥ï¼š** é€šè¿‡ä¿®æ”¹`login`å‚æ•°ï¼Œæ³¨å…¥SQLè¯­å¥ï¼Œç»•è¿‡èº«ä»½éªŒè¯ã€‚
3.  **æå–æ•°æ®ï¼š** ä½¿ç”¨curlå‘é€æ„é€ å¥½çš„JSON payloadï¼Œç„¶ååˆ©ç”¨`jq`å’Œ`base64`è§£ç æå–æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [HarshRajSinghania/CVE-2023-1545-Exploit](https://github.com/HarshRajSinghania/CVE-2023-1545-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---

## POC #2

**æ¥æº**: [CVE-2023-1545-gunzf0x_CVE-2023-1545.md](../2023/CVE-2023-1545-gunzf0x_CVE-2023-1545.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ•°æ®æ³„éœ²ï¼Œä¾‹å¦‚ç”¨æˆ·åå’Œå¯†ç ã€‚

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿè®¿é—®Teampassçš„WebæœåŠ¡å™¨ï¼Œå¹¶ä¸”ç›®æ ‡Teampasså®ä¾‹çš„ç‰ˆæœ¬ä½äº3.0.0.23ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2023-1545æ˜¯Teampassç‰ˆæœ¬3.0.0.23ä¹‹å‰å­˜åœ¨çš„ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„CVSSè¯„åˆ†ä¸º7.5ï¼Œå±äºé«˜å±æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„Python POCä»£ç é€šè¿‡æ„é€ æ¶æ„çš„SQLè¯­å¥ï¼Œåˆ©ç”¨Teampassçš„èº«ä»½éªŒè¯æ¥å£ä¸­çš„SQLæ³¨å…¥æ¼æ´ï¼Œç»•è¿‡èº«ä»½éªŒè¯å¹¶æå–æ•°æ®åº“ä¸­çš„ç”¨æˆ·ä¿¡æ¯ã€‚POCä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡URLæ˜¯å¦å¯è®¿é—®ï¼Œç„¶åå°è¯•ä½¿ç”¨SQLæ³¨å…¥æšä¸¾ç”¨æˆ·ï¼Œå¹¶æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚æ ¹æ®ä»£ç é€»è¾‘å’Œæ¼æ´æè¿°ï¼Œè¯¥POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»”ç»†æ£€æŸ¥äº†æä¾›çš„POCä»£ç ï¼Œæœªå‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚è¯¥è„šæœ¬çš„åŠŸèƒ½æ˜ç¡®ä¸”é›†ä¸­äºåˆ©ç”¨SQLæ³¨å…¥æ¼æ´ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å°è¯•è¿›è¡Œæœªç»æˆæƒçš„æ–‡ä»¶è®¿é—®ã€ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œæˆ–å…¶ä»–æ¶æ„æ´»åŠ¨çš„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¯ä»¥è®¤ä¸ºé£é™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Teampasså®ä¾‹çš„ç‰ˆæœ¬æ˜¯å¦ä½äº3.0.0.23ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCä»£ç ï¼Œå‘Teampassçš„/api/index.php/authorizeæ¥å£å‘é€åŒ…å«æ¶æ„SQLæ³¨å…¥çš„POSTè¯·æ±‚ã€‚
3.  æ¶æ„SQLæ³¨å…¥è¯­å¥è¢«æ’å…¥åˆ°loginå­—æ®µä¸­ï¼Œç»•è¿‡èº«ä»½éªŒè¯ï¼Œå¹¶ä»teampass_usersè¡¨ä¸­æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚
4.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æå–åˆ°çš„å¯†ç å“ˆå¸Œå€¼ï¼Œé€šè¿‡å¯†ç ç ´è§£ç­‰æ‰‹æ®µè·å–ç”¨æˆ·å¯†ç ï¼Œä»è€Œè·å¾—å¯¹Teampassç³»ç»Ÿçš„è®¿é—®æƒé™ã€‚

**é¡¹ç›®åœ°å€:** [gunzf0x/CVE-2023-1545](https://github.com/gunzf0x/CVE-2023-1545)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---

## POC #3

**æ¥æº**: [CVE-2023-1545-lineeralgebra_CVE-2023-1545-POC.md](../2023/CVE-2023-1545-lineeralgebra_CVE-2023-1545-POC.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Teampasså®ä¾‹å¯ç”¨APIï¼Œä¸”ç½‘ç»œå¯è®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2023-1545æ˜¯Teampass 3.0.0.23ä¹‹å‰ç‰ˆæœ¬ä¸­å­˜åœ¨çš„SQLæ³¨å…¥æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç åˆ†æï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š**  è¯¥æ¼æ´ç”±äºTeampassåœ¨å¤„ç†ç”¨æˆ·ç™»å½•è®¤è¯æ—¶ï¼Œå¯¹è¾“å…¥å‚æ•°ï¼ˆloginï¼‰æœªè¿›è¡Œå……åˆ†çš„è¿‡æ»¤å’Œè½¬ä¹‰ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥åœ¨loginå­—æ®µä¸­æ³¨å…¥æ¶æ„çš„SQLä»£ç ã€‚
2.  **åˆ©ç”¨æ­¥éª¤ï¼š**
    *   é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®å®šç›®æ ‡Teampasså®ä¾‹æ˜¯å¦å¯ç”¨äº†APIåŠŸèƒ½ã€‚PoCä»£ç é€šè¿‡è®¿é—®`/api/index.php/authorize`æ¥æ£€æµ‹APIæ˜¯å¦å¯ç”¨ã€‚
    *   ç„¶åï¼Œæ”»å‡»è€…æ„é€ åŒ…å«SQLæ³¨å…¥è¯­å¥çš„loginå‚æ•°ã€‚PoCä»£ç ä¸­ä½¿ç”¨äº†`UNION SELECT`è¯­å¥ï¼Œå°†æ”»å‡»è€…çš„SQLæŸ¥è¯¢ç»“æœä¸åŸå§‹æŸ¥è¯¢ç»“æœåˆå¹¶ï¼Œä»è€Œè·å–æ•°æ®åº“ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚ç‰¹åˆ«æ„é€ äº†loginä¸º `none' UNION SELECT ...` è¿™æ ·çš„ Payloadï¼Œç»•è¿‡äº†åŸæœ‰çš„loginéªŒè¯ã€‚å¯†ç éšæ„å¡«å†™ï¼Œapikeyä¹Ÿéšæ„ã€‚
    *   é€šè¿‡å‘é€POSTè¯·æ±‚åˆ°`/api/index.php/authorize`ç«¯ç‚¹ï¼Œå°†åŒ…å«æ¶æ„SQLä»£ç çš„JSONæ•°æ®å‘é€ç»™TeampassæœåŠ¡å™¨ã€‚
    *   æœåŠ¡å™¨æ‰§è¡ŒSQLæŸ¥è¯¢åï¼Œä¼šå°†æŸ¥è¯¢ç»“æœåŒ…å«åœ¨è¿”å›çš„tokenä¸­ã€‚æ”»å‡»è€…å¯ä»¥ä»tokenä¸­æå–`public_key`å­—æ®µï¼Œè¯¥å­—æ®µåŒ…å«äº†SQLæŸ¥è¯¢çš„ç»“æœã€‚
3.  **PoCä»£ç åˆ†æï¼š**
    *   PoCä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡APIæ˜¯å¦å¯ç”¨ã€‚
    *   `exec_sql`å‡½æ•°å°è£…äº†SQLæ³¨å…¥çš„è¿‡ç¨‹ï¼Œæ¥æ”¶SQLæŸ¥è¯¢è¯­å¥ä½œä¸ºå‚æ•°ï¼Œæ„é€ åŒ…å«æ³¨å…¥è¯­å¥çš„JSONæ•°æ®ï¼Œå‘é€POSTè¯·æ±‚ï¼Œå¹¶ä»è¿”å›çš„tokenä¸­æå–æŸ¥è¯¢ç»“æœã€‚
    *   PoCä»£ç é¦–å…ˆä½¿ç”¨`SELECT COUNT(*) FROM teampass_users WHERE pw != ''`è¯­å¥è·å–ç”¨æˆ·æ•°é‡ï¼Œç„¶åå¾ªç¯éå†ç”¨æˆ·ï¼Œä½¿ç”¨`SELECT login FROM teampass_users WHERE pw != '' ORDER BY login ASC LIMIT {i},1`å’Œ`SELECT pw FROM teampass_users WHERE pw != '' ORDER BY login ASC LIMIT {i},1`è¯­å¥åˆ†åˆ«è·å–ç”¨æˆ·åå’Œå¯†ç ã€‚
4.  **æœ‰æ•ˆæ€§ï¼š**  æ ¹æ®æä¾›çš„æœç´¢å¼•æ“ç»“æœï¼Œå­˜åœ¨å…¬å¼€çš„æ¼æ´åˆ©ç”¨expï¼Œå¹¶ä¸”æ¼æ´å½±å“ç‰ˆæœ¬å°äº3.0.0.23ï¼Œåˆ©ç”¨ä»£ç å®Œæ•´ï¼Œå‚æ•°æ˜ç¡®ï¼Œå› æ­¤åˆ¤æ–­POCä»£ç æœ‰æ•ˆã€‚
5.  **æŠ•æ¯’é£é™©ï¼š**  è¯¥ä»£ç ä¸»è¦å®ç°äº†SQLæ³¨å…¥åˆ©ç”¨ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ã€‚æ¯”å¦‚ä¸‹è½½å…¶ä»–æ–‡ä»¶ã€æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ç­‰ã€‚ä»£ç ä¸­å­˜åœ¨çš„é£é™©ç‚¹åœ¨äºï¼Œå¯èƒ½ä¼šè¢«æ»¥ç”¨è¿›è¡Œæœªæˆæƒçš„æ•°æ®åº“ä¿¡æ¯çªƒå–ã€‚ä½†æ˜¯ä½œä¸ºPOCæœ¬èº«ï¼Œä¸å±äºæŠ•æ¯’è¡Œä¸ºã€‚ç»†å¾®æŠ•æ¯’å¯èƒ½åœ¨äºï¼ŒPoCä¸­ä½¿ç”¨çš„`arbitrary_hash`å¯èƒ½ä¼šè¯¯å¯¼ä½¿ç”¨è€…ï¼Œè®¤ä¸ºæ”»å‡»è€…å¯ä»¥é€šè¿‡è¯¥hashç›´æ¥ç™»å½•ï¼Œå®é™…ä¸Šéœ€è¦æ›¿æ¢æˆç›®æ ‡ç”¨æˆ·çš„å¯†ç hashã€‚æ•…æŠ•æ¯’é£é™©è¾ƒä½, ä¼°ç®—ä¸º 5%ã€‚

**é¡¹ç›®åœ°å€:** [lineeralgebra/CVE-2023-1545-POC](https://github.com/lineeralgebra/CVE-2023-1545-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---

## POC #4

**æ¥æº**: [CVE-2023-1545-sternstundes_CVE-2023-1545-POC-python.md](../2023/CVE-2023-1545-sternstundes_CVE-2023-1545-POC-python.md)

# CVE-2023-1545

> ğŸ“¦ è¯¥CVEæœ‰ **5** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-1545-HarshRajSinghania_CVE-2023-1545-Exploit.md](../2023/CVE-2023-1545-HarshRajSinghania_CVE-2023-1545-Exploit.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œå¦‚ç”¨æˆ·åå’Œå¯†ç 

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Teampasså®ä¾‹å¼€å¯APIåŠŸèƒ½ä¸”ç½‘ç»œå¯è¾¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼ŒCVE-2023-1545æ˜¯Teampass 3.0.0.23ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„SQLæ³¨å…¥æ¼æ´ã€‚POCä»£ç é€šè¿‡æ„é€ æ¶æ„çš„`login`å‚æ•°ï¼Œåˆ©ç”¨UNION SELECTè¯­å¥å°†æ”»å‡»è€…æ³¨å…¥çš„SQLæŸ¥è¯¢ç»“æœä¸åˆæ³•æŸ¥è¯¢ç»“æœåˆå¹¶ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯ï¼Œæå–æ•°æ®åº“ä¸­çš„æ•æ„Ÿä¿¡æ¯ï¼Œå¦‚ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œã€‚è¯¥POCé¦–å…ˆæ£€æŸ¥APIåŠŸèƒ½æ˜¯å¦å¯ç”¨ï¼Œç„¶åæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„SQLæ³¨å…¥çš„JSON payloadå‘é€åˆ°`/api/index.php/authorize`ï¼Œåˆ©ç”¨`jq`å’Œ`base64`è§£ç ä»å“åº”ä¸­æå–æ‰€éœ€æ•°æ®ã€‚å¯¹äºæŠ•æ¯’é£é™©ï¼Œè¯¥è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨SQLæ³¨å…¥æ¼æ´æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚ä½†ä¾ç„¶éœ€è¦è°¨æ…ä½¿ç”¨ä»ç½‘ç»œè·å–çš„ä»£ç ï¼Œå­˜åœ¨æå°å¯èƒ½æ€§é€šè¿‡ä¾èµ–å¼•å…¥æ¶æ„ä»£ç ï¼Œå› æ­¤é¢„ä¼°æŠ•æ¯’æ¦‚ç‡ä¸º10%ã€‚åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š

1.  **æ£€æµ‹APIçŠ¶æ€ï¼š** ä½¿ç”¨curlæ£€æµ‹Teampasså®ä¾‹æ˜¯å¦å¯ç”¨äº†APIåŠŸèƒ½ã€‚
2.  **æ„é€ æ¶æ„SQLæ³¨å…¥ï¼š** é€šè¿‡ä¿®æ”¹`login`å‚æ•°ï¼Œæ³¨å…¥SQLè¯­å¥ï¼Œç»•è¿‡èº«ä»½éªŒè¯ã€‚
3.  **æå–æ•°æ®ï¼š** ä½¿ç”¨curlå‘é€æ„é€ å¥½çš„JSON payloadï¼Œç„¶ååˆ©ç”¨`jq`å’Œ`base64`è§£ç æå–æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [HarshRajSinghania/CVE-2023-1545-Exploit](https://github.com/HarshRajSinghania/CVE-2023-1545-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---

## POC #2

**æ¥æº**: [CVE-2023-1545-gunzf0x_CVE-2023-1545.md](../2023/CVE-2023-1545-gunzf0x_CVE-2023-1545.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ•°æ®æ³„éœ²ï¼Œä¾‹å¦‚ç”¨æˆ·åå’Œå¯†ç ã€‚

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿè®¿é—®Teampassçš„WebæœåŠ¡å™¨ï¼Œå¹¶ä¸”ç›®æ ‡Teampasså®ä¾‹çš„ç‰ˆæœ¬ä½äº3.0.0.23ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2023-1545æ˜¯Teampassç‰ˆæœ¬3.0.0.23ä¹‹å‰å­˜åœ¨çš„ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„CVSSè¯„åˆ†ä¸º7.5ï¼Œå±äºé«˜å±æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„Python POCä»£ç é€šè¿‡æ„é€ æ¶æ„çš„SQLè¯­å¥ï¼Œåˆ©ç”¨Teampassçš„èº«ä»½éªŒè¯æ¥å£ä¸­çš„SQLæ³¨å…¥æ¼æ´ï¼Œç»•è¿‡èº«ä»½éªŒè¯å¹¶æå–æ•°æ®åº“ä¸­çš„ç”¨æˆ·ä¿¡æ¯ã€‚POCä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡URLæ˜¯å¦å¯è®¿é—®ï¼Œç„¶åå°è¯•ä½¿ç”¨SQLæ³¨å…¥æšä¸¾ç”¨æˆ·ï¼Œå¹¶æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚æ ¹æ®ä»£ç é€»è¾‘å’Œæ¼æ´æè¿°ï¼Œè¯¥POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»”ç»†æ£€æŸ¥äº†æä¾›çš„POCä»£ç ï¼Œæœªå‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚è¯¥è„šæœ¬çš„åŠŸèƒ½æ˜ç¡®ä¸”é›†ä¸­äºåˆ©ç”¨SQLæ³¨å…¥æ¼æ´ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å°è¯•è¿›è¡Œæœªç»æˆæƒçš„æ–‡ä»¶è®¿é—®ã€ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œæˆ–å…¶ä»–æ¶æ„æ´»åŠ¨çš„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¯ä»¥è®¤ä¸ºé£é™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Teampasså®ä¾‹çš„ç‰ˆæœ¬æ˜¯å¦ä½äº3.0.0.23ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCä»£ç ï¼Œå‘Teampassçš„/api/index.php/authorizeæ¥å£å‘é€åŒ…å«æ¶æ„SQLæ³¨å…¥çš„POSTè¯·æ±‚ã€‚
3.  æ¶æ„SQLæ³¨å…¥è¯­å¥è¢«æ’å…¥åˆ°loginå­—æ®µä¸­ï¼Œç»•è¿‡èº«ä»½éªŒè¯ï¼Œå¹¶ä»teampass_usersè¡¨ä¸­æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚
4.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æå–åˆ°çš„å¯†ç å“ˆå¸Œå€¼ï¼Œé€šè¿‡å¯†ç ç ´è§£ç­‰æ‰‹æ®µè·å–ç”¨æˆ·å¯†ç ï¼Œä»è€Œè·å¾—å¯¹Teampassç³»ç»Ÿçš„è®¿é—®æƒé™ã€‚

**é¡¹ç›®åœ°å€:** [gunzf0x/CVE-2023-1545](https://github.com/gunzf0x/CVE-2023-1545)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---

## POC #3

**æ¥æº**: [CVE-2023-1545-lineeralgebra_CVE-2023-1545-POC.md](../2023/CVE-2023-1545-lineeralgebra_CVE-2023-1545-POC.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Teampasså®ä¾‹å¯ç”¨APIï¼Œä¸”ç½‘ç»œå¯è®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2023-1545æ˜¯Teampass 3.0.0.23ä¹‹å‰ç‰ˆæœ¬ä¸­å­˜åœ¨çš„SQLæ³¨å…¥æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç åˆ†æï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š**  è¯¥æ¼æ´ç”±äºTeampassåœ¨å¤„ç†ç”¨æˆ·ç™»å½•è®¤è¯æ—¶ï¼Œå¯¹è¾“å…¥å‚æ•°ï¼ˆloginï¼‰æœªè¿›è¡Œå……åˆ†çš„è¿‡æ»¤å’Œè½¬ä¹‰ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥åœ¨loginå­—æ®µä¸­æ³¨å…¥æ¶æ„çš„SQLä»£ç ã€‚
2.  **åˆ©ç”¨æ­¥éª¤ï¼š**
    *   é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®å®šç›®æ ‡Teampasså®ä¾‹æ˜¯å¦å¯ç”¨äº†APIåŠŸèƒ½ã€‚PoCä»£ç é€šè¿‡è®¿é—®`/api/index.php/authorize`æ¥æ£€æµ‹APIæ˜¯å¦å¯ç”¨ã€‚
    *   ç„¶åï¼Œæ”»å‡»è€…æ„é€ åŒ…å«SQLæ³¨å…¥è¯­å¥çš„loginå‚æ•°ã€‚PoCä»£ç ä¸­ä½¿ç”¨äº†`UNION SELECT`è¯­å¥ï¼Œå°†æ”»å‡»è€…çš„SQLæŸ¥è¯¢ç»“æœä¸åŸå§‹æŸ¥è¯¢ç»“æœåˆå¹¶ï¼Œä»è€Œè·å–æ•°æ®åº“ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚ç‰¹åˆ«æ„é€ äº†loginä¸º `none' UNION SELECT ...` è¿™æ ·çš„ Payloadï¼Œç»•è¿‡äº†åŸæœ‰çš„loginéªŒè¯ã€‚å¯†ç éšæ„å¡«å†™ï¼Œapikeyä¹Ÿéšæ„ã€‚
    *   é€šè¿‡å‘é€POSTè¯·æ±‚åˆ°`/api/index.php/authorize`ç«¯ç‚¹ï¼Œå°†åŒ…å«æ¶æ„SQLä»£ç çš„JSONæ•°æ®å‘é€ç»™TeampassæœåŠ¡å™¨ã€‚
    *   æœåŠ¡å™¨æ‰§è¡ŒSQLæŸ¥è¯¢åï¼Œä¼šå°†æŸ¥è¯¢ç»“æœåŒ…å«åœ¨è¿”å›çš„tokenä¸­ã€‚æ”»å‡»è€…å¯ä»¥ä»tokenä¸­æå–`public_key`å­—æ®µï¼Œè¯¥å­—æ®µåŒ…å«äº†SQLæŸ¥è¯¢çš„ç»“æœã€‚
3.  **PoCä»£ç åˆ†æï¼š**
    *   PoCä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡APIæ˜¯å¦å¯ç”¨ã€‚
    *   `exec_sql`å‡½æ•°å°è£…äº†SQLæ³¨å…¥çš„è¿‡ç¨‹ï¼Œæ¥æ”¶SQLæŸ¥è¯¢è¯­å¥ä½œä¸ºå‚æ•°ï¼Œæ„é€ åŒ…å«æ³¨å…¥è¯­å¥çš„JSONæ•°æ®ï¼Œå‘é€POSTè¯·æ±‚ï¼Œå¹¶ä»è¿”å›çš„tokenä¸­æå–æŸ¥è¯¢ç»“æœã€‚
    *   PoCä»£ç é¦–å…ˆä½¿ç”¨`SELECT COUNT(*) FROM teampass_users WHERE pw != ''`è¯­å¥è·å–ç”¨æˆ·æ•°é‡ï¼Œç„¶åå¾ªç¯éå†ç”¨æˆ·ï¼Œä½¿ç”¨`SELECT login FROM teampass_users WHERE pw != '' ORDER BY login ASC LIMIT {i},1`å’Œ`SELECT pw FROM teampass_users WHERE pw != '' ORDER BY login ASC LIMIT {i},1`è¯­å¥åˆ†åˆ«è·å–ç”¨æˆ·åå’Œå¯†ç ã€‚
4.  **æœ‰æ•ˆæ€§ï¼š**  æ ¹æ®æä¾›çš„æœç´¢å¼•æ“ç»“æœï¼Œå­˜åœ¨å…¬å¼€çš„æ¼æ´åˆ©ç”¨expï¼Œå¹¶ä¸”æ¼æ´å½±å“ç‰ˆæœ¬å°äº3.0.0.23ï¼Œåˆ©ç”¨ä»£ç å®Œæ•´ï¼Œå‚æ•°æ˜ç¡®ï¼Œå› æ­¤åˆ¤æ–­POCä»£ç æœ‰æ•ˆã€‚
5.  **æŠ•æ¯’é£é™©ï¼š**  è¯¥ä»£ç ä¸»è¦å®ç°äº†SQLæ³¨å…¥åˆ©ç”¨ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ã€‚æ¯”å¦‚ä¸‹è½½å…¶ä»–æ–‡ä»¶ã€æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ç­‰ã€‚ä»£ç ä¸­å­˜åœ¨çš„é£é™©ç‚¹åœ¨äºï¼Œå¯èƒ½ä¼šè¢«æ»¥ç”¨è¿›è¡Œæœªæˆæƒçš„æ•°æ®åº“ä¿¡æ¯çªƒå–ã€‚ä½†æ˜¯ä½œä¸ºPOCæœ¬èº«ï¼Œä¸å±äºæŠ•æ¯’è¡Œä¸ºã€‚ç»†å¾®æŠ•æ¯’å¯èƒ½åœ¨äºï¼ŒPoCä¸­ä½¿ç”¨çš„`arbitrary_hash`å¯èƒ½ä¼šè¯¯å¯¼ä½¿ç”¨è€…ï¼Œè®¤ä¸ºæ”»å‡»è€…å¯ä»¥é€šè¿‡è¯¥hashç›´æ¥ç™»å½•ï¼Œå®é™…ä¸Šéœ€è¦æ›¿æ¢æˆç›®æ ‡ç”¨æˆ·çš„å¯†ç hashã€‚æ•…æŠ•æ¯’é£é™©è¾ƒä½, ä¼°ç®—ä¸º 5%ã€‚

**é¡¹ç›®åœ°å€:** [lineeralgebra/CVE-2023-1545-POC](https://github.com/lineeralgebra/CVE-2023-1545-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---

## POC #4

**æ¥æº**: [CVE-2023-1545-sternstundes_CVE-2023-1545-POC-python.md](../2023/CVE-2023-1545-sternstundes_CVE-2023-1545-POC-python.md)

# CVE-2023-1545

> ğŸ“¦ è¯¥CVEæœ‰ **5** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-1545-HarshRajSinghania_CVE-2023-1545-Exploit.md](../2023/CVE-2023-1545-HarshRajSinghania_CVE-2023-1545-Exploit.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œå¦‚ç”¨æˆ·åå’Œå¯†ç 

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Teampasså®ä¾‹å¼€å¯APIåŠŸèƒ½ä¸”ç½‘ç»œå¯è¾¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼ŒCVE-2023-1545æ˜¯Teampass 3.0.0.23ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„SQLæ³¨å…¥æ¼æ´ã€‚POCä»£ç é€šè¿‡æ„é€ æ¶æ„çš„`login`å‚æ•°ï¼Œåˆ©ç”¨UNION SELECTè¯­å¥å°†æ”»å‡»è€…æ³¨å…¥çš„SQLæŸ¥è¯¢ç»“æœä¸åˆæ³•æŸ¥è¯¢ç»“æœåˆå¹¶ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯ï¼Œæå–æ•°æ®åº“ä¸­çš„æ•æ„Ÿä¿¡æ¯ï¼Œå¦‚ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œã€‚è¯¥POCé¦–å…ˆæ£€æŸ¥APIåŠŸèƒ½æ˜¯å¦å¯ç”¨ï¼Œç„¶åæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„SQLæ³¨å…¥çš„JSON payloadå‘é€åˆ°`/api/index.php/authorize`ï¼Œåˆ©ç”¨`jq`å’Œ`base64`è§£ç ä»å“åº”ä¸­æå–æ‰€éœ€æ•°æ®ã€‚å¯¹äºæŠ•æ¯’é£é™©ï¼Œè¯¥è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨SQLæ³¨å…¥æ¼æ´æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚ä½†ä¾ç„¶éœ€è¦è°¨æ…ä½¿ç”¨ä»ç½‘ç»œè·å–çš„ä»£ç ï¼Œå­˜åœ¨æå°å¯èƒ½æ€§é€šè¿‡ä¾èµ–å¼•å…¥æ¶æ„ä»£ç ï¼Œå› æ­¤é¢„ä¼°æŠ•æ¯’æ¦‚ç‡ä¸º10%ã€‚åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š

1.  **æ£€æµ‹APIçŠ¶æ€ï¼š** ä½¿ç”¨curlæ£€æµ‹Teampasså®ä¾‹æ˜¯å¦å¯ç”¨äº†APIåŠŸèƒ½ã€‚
2.  **æ„é€ æ¶æ„SQLæ³¨å…¥ï¼š** é€šè¿‡ä¿®æ”¹`login`å‚æ•°ï¼Œæ³¨å…¥SQLè¯­å¥ï¼Œç»•è¿‡èº«ä»½éªŒè¯ã€‚
3.  **æå–æ•°æ®ï¼š** ä½¿ç”¨curlå‘é€æ„é€ å¥½çš„JSON payloadï¼Œç„¶ååˆ©ç”¨`jq`å’Œ`base64`è§£ç æå–æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [HarshRajSinghania/CVE-2023-1545-Exploit](https://github.com/HarshRajSinghania/CVE-2023-1545-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---

## POC #2

**æ¥æº**: [CVE-2023-1545-gunzf0x_CVE-2023-1545.md](../2023/CVE-2023-1545-gunzf0x_CVE-2023-1545.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ•°æ®æ³„éœ²ï¼Œä¾‹å¦‚ç”¨æˆ·åå’Œå¯†ç ã€‚

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿè®¿é—®Teampassçš„WebæœåŠ¡å™¨ï¼Œå¹¶ä¸”ç›®æ ‡Teampasså®ä¾‹çš„ç‰ˆæœ¬ä½äº3.0.0.23ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2023-1545æ˜¯Teampassç‰ˆæœ¬3.0.0.23ä¹‹å‰å­˜åœ¨çš„ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„CVSSè¯„åˆ†ä¸º7.5ï¼Œå±äºé«˜å±æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„Python POCä»£ç é€šè¿‡æ„é€ æ¶æ„çš„SQLè¯­å¥ï¼Œåˆ©ç”¨Teampassçš„èº«ä»½éªŒè¯æ¥å£ä¸­çš„SQLæ³¨å…¥æ¼æ´ï¼Œç»•è¿‡èº«ä»½éªŒè¯å¹¶æå–æ•°æ®åº“ä¸­çš„ç”¨æˆ·ä¿¡æ¯ã€‚POCä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡URLæ˜¯å¦å¯è®¿é—®ï¼Œç„¶åå°è¯•ä½¿ç”¨SQLæ³¨å…¥æšä¸¾ç”¨æˆ·ï¼Œå¹¶æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚æ ¹æ®ä»£ç é€»è¾‘å’Œæ¼æ´æè¿°ï¼Œè¯¥POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»”ç»†æ£€æŸ¥äº†æä¾›çš„POCä»£ç ï¼Œæœªå‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚è¯¥è„šæœ¬çš„åŠŸèƒ½æ˜ç¡®ä¸”é›†ä¸­äºåˆ©ç”¨SQLæ³¨å…¥æ¼æ´ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å°è¯•è¿›è¡Œæœªç»æˆæƒçš„æ–‡ä»¶è®¿é—®ã€ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œæˆ–å…¶ä»–æ¶æ„æ´»åŠ¨çš„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¯ä»¥è®¤ä¸ºé£é™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Teampasså®ä¾‹çš„ç‰ˆæœ¬æ˜¯å¦ä½äº3.0.0.23ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCä»£ç ï¼Œå‘Teampassçš„/api/index.php/authorizeæ¥å£å‘é€åŒ…å«æ¶æ„SQLæ³¨å…¥çš„POSTè¯·æ±‚ã€‚
3.  æ¶æ„SQLæ³¨å…¥è¯­å¥è¢«æ’å…¥åˆ°loginå­—æ®µä¸­ï¼Œç»•è¿‡èº«ä»½éªŒè¯ï¼Œå¹¶ä»teampass_usersè¡¨ä¸­æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚
4.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æå–åˆ°çš„å¯†ç å“ˆå¸Œå€¼ï¼Œé€šè¿‡å¯†ç ç ´è§£ç­‰æ‰‹æ®µè·å–ç”¨æˆ·å¯†ç ï¼Œä»è€Œè·å¾—å¯¹Teampassç³»ç»Ÿçš„è®¿é—®æƒé™ã€‚

**é¡¹ç›®åœ°å€:** [gunzf0x/CVE-2023-1545](https://github.com/gunzf0x/CVE-2023-1545)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---

## POC #3

**æ¥æº**: [CVE-2023-1545-lineeralgebra_CVE-2023-1545-POC.md](../2023/CVE-2023-1545-lineeralgebra_CVE-2023-1545-POC.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Teampasså®ä¾‹å¯ç”¨APIï¼Œä¸”ç½‘ç»œå¯è®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2023-1545æ˜¯Teampass 3.0.0.23ä¹‹å‰ç‰ˆæœ¬ä¸­å­˜åœ¨çš„SQLæ³¨å…¥æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç åˆ†æï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š**  è¯¥æ¼æ´ç”±äºTeampassåœ¨å¤„ç†ç”¨æˆ·ç™»å½•è®¤è¯æ—¶ï¼Œå¯¹è¾“å…¥å‚æ•°ï¼ˆloginï¼‰æœªè¿›è¡Œå……åˆ†çš„è¿‡æ»¤å’Œè½¬ä¹‰ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥åœ¨loginå­—æ®µä¸­æ³¨å…¥æ¶æ„çš„SQLä»£ç ã€‚
2.  **åˆ©ç”¨æ­¥éª¤ï¼š**
    *   é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®å®šç›®æ ‡Teampasså®ä¾‹æ˜¯å¦å¯ç”¨äº†APIåŠŸèƒ½ã€‚PoCä»£ç é€šè¿‡è®¿é—®`/api/index.php/authorize`æ¥æ£€æµ‹APIæ˜¯å¦å¯ç”¨ã€‚
    *   ç„¶åï¼Œæ”»å‡»è€…æ„é€ åŒ…å«SQLæ³¨å…¥è¯­å¥çš„loginå‚æ•°ã€‚PoCä»£ç ä¸­ä½¿ç”¨äº†`UNION SELECT`è¯­å¥ï¼Œå°†æ”»å‡»è€…çš„SQLæŸ¥è¯¢ç»“æœä¸åŸå§‹æŸ¥è¯¢ç»“æœåˆå¹¶ï¼Œä»è€Œè·å–æ•°æ®åº“ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚ç‰¹åˆ«æ„é€ äº†loginä¸º `none' UNION SELECT ...` è¿™æ ·çš„ Payloadï¼Œç»•è¿‡äº†åŸæœ‰çš„loginéªŒè¯ã€‚å¯†ç éšæ„å¡«å†™ï¼Œapikeyä¹Ÿéšæ„ã€‚
    *   é€šè¿‡å‘é€POSTè¯·æ±‚åˆ°`/api/index.php/authorize`ç«¯ç‚¹ï¼Œå°†åŒ…å«æ¶æ„SQLä»£ç çš„JSONæ•°æ®å‘é€ç»™TeampassæœåŠ¡å™¨ã€‚
    *   æœåŠ¡å™¨æ‰§è¡ŒSQLæŸ¥è¯¢åï¼Œä¼šå°†æŸ¥è¯¢ç»“æœåŒ…å«åœ¨è¿”å›çš„tokenä¸­ã€‚æ”»å‡»è€…å¯ä»¥ä»tokenä¸­æå–`public_key`å­—æ®µï¼Œè¯¥å­—æ®µåŒ…å«äº†SQLæŸ¥è¯¢çš„ç»“æœã€‚
3.  **PoCä»£ç åˆ†æï¼š**
    *   PoCä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡APIæ˜¯å¦å¯ç”¨ã€‚
    *   `exec_sql`å‡½æ•°å°è£…äº†SQLæ³¨å…¥çš„è¿‡ç¨‹ï¼Œæ¥æ”¶SQLæŸ¥è¯¢è¯­å¥ä½œä¸ºå‚æ•°ï¼Œæ„é€ åŒ…å«æ³¨å…¥è¯­å¥çš„JSONæ•°æ®ï¼Œå‘é€POSTè¯·æ±‚ï¼Œå¹¶ä»è¿”å›çš„tokenä¸­æå–æŸ¥è¯¢ç»“æœã€‚
    *   PoCä»£ç é¦–å…ˆä½¿ç”¨`SELECT COUNT(*) FROM teampass_users WHERE pw != ''`è¯­å¥è·å–ç”¨æˆ·æ•°é‡ï¼Œç„¶åå¾ªç¯éå†ç”¨æˆ·ï¼Œä½¿ç”¨`SELECT login FROM teampass_users WHERE pw != '' ORDER BY login ASC LIMIT {i},1`å’Œ`SELECT pw FROM teampass_users WHERE pw != '' ORDER BY login ASC LIMIT {i},1`è¯­å¥åˆ†åˆ«è·å–ç”¨æˆ·åå’Œå¯†ç ã€‚
4.  **æœ‰æ•ˆæ€§ï¼š**  æ ¹æ®æä¾›çš„æœç´¢å¼•æ“ç»“æœï¼Œå­˜åœ¨å…¬å¼€çš„æ¼æ´åˆ©ç”¨expï¼Œå¹¶ä¸”æ¼æ´å½±å“ç‰ˆæœ¬å°äº3.0.0.23ï¼Œåˆ©ç”¨ä»£ç å®Œæ•´ï¼Œå‚æ•°æ˜ç¡®ï¼Œå› æ­¤åˆ¤æ–­POCä»£ç æœ‰æ•ˆã€‚
5.  **æŠ•æ¯’é£é™©ï¼š**  è¯¥ä»£ç ä¸»è¦å®ç°äº†SQLæ³¨å…¥åˆ©ç”¨ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ã€‚æ¯”å¦‚ä¸‹è½½å…¶ä»–æ–‡ä»¶ã€æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ç­‰ã€‚ä»£ç ä¸­å­˜åœ¨çš„é£é™©ç‚¹åœ¨äºï¼Œå¯èƒ½ä¼šè¢«æ»¥ç”¨è¿›è¡Œæœªæˆæƒçš„æ•°æ®åº“ä¿¡æ¯çªƒå–ã€‚ä½†æ˜¯ä½œä¸ºPOCæœ¬èº«ï¼Œä¸å±äºæŠ•æ¯’è¡Œä¸ºã€‚ç»†å¾®æŠ•æ¯’å¯èƒ½åœ¨äºï¼ŒPoCä¸­ä½¿ç”¨çš„`arbitrary_hash`å¯èƒ½ä¼šè¯¯å¯¼ä½¿ç”¨è€…ï¼Œè®¤ä¸ºæ”»å‡»è€…å¯ä»¥é€šè¿‡è¯¥hashç›´æ¥ç™»å½•ï¼Œå®é™…ä¸Šéœ€è¦æ›¿æ¢æˆç›®æ ‡ç”¨æˆ·çš„å¯†ç hashã€‚æ•…æŠ•æ¯’é£é™©è¾ƒä½, ä¼°ç®—ä¸º 5%ã€‚

**é¡¹ç›®åœ°å€:** [lineeralgebra/CVE-2023-1545-POC](https://github.com/lineeralgebra/CVE-2023-1545-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---

## POC #4

**æ¥æº**: [CVE-2023-1545-sternstundes_CVE-2023-1545-POC-python.md](../2023/CVE-2023-1545-sternstundes_CVE-2023-1545-POC-python.md)

# CVE-2023-1545

> ğŸ“¦ è¯¥CVEæœ‰ **5** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-1545-HarshRajSinghania_CVE-2023-1545-Exploit.md](../2023/CVE-2023-1545-HarshRajSinghania_CVE-2023-1545-Exploit.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œå¦‚ç”¨æˆ·åå’Œå¯†ç 

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Teampasså®ä¾‹å¼€å¯APIåŠŸèƒ½ä¸”ç½‘ç»œå¯è¾¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼ŒCVE-2023-1545æ˜¯Teampass 3.0.0.23ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„SQLæ³¨å…¥æ¼æ´ã€‚POCä»£ç é€šè¿‡æ„é€ æ¶æ„çš„`login`å‚æ•°ï¼Œåˆ©ç”¨UNION SELECTè¯­å¥å°†æ”»å‡»è€…æ³¨å…¥çš„SQLæŸ¥è¯¢ç»“æœä¸åˆæ³•æŸ¥è¯¢ç»“æœåˆå¹¶ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯ï¼Œæå–æ•°æ®åº“ä¸­çš„æ•æ„Ÿä¿¡æ¯ï¼Œå¦‚ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œã€‚è¯¥POCé¦–å…ˆæ£€æŸ¥APIåŠŸèƒ½æ˜¯å¦å¯ç”¨ï¼Œç„¶åæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„SQLæ³¨å…¥çš„JSON payloadå‘é€åˆ°`/api/index.php/authorize`ï¼Œåˆ©ç”¨`jq`å’Œ`base64`è§£ç ä»å“åº”ä¸­æå–æ‰€éœ€æ•°æ®ã€‚å¯¹äºæŠ•æ¯’é£é™©ï¼Œè¯¥è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨SQLæ³¨å…¥æ¼æ´æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚ä½†ä¾ç„¶éœ€è¦è°¨æ…ä½¿ç”¨ä»ç½‘ç»œè·å–çš„ä»£ç ï¼Œå­˜åœ¨æå°å¯èƒ½æ€§é€šè¿‡ä¾èµ–å¼•å…¥æ¶æ„ä»£ç ï¼Œå› æ­¤é¢„ä¼°æŠ•æ¯’æ¦‚ç‡ä¸º10%ã€‚åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š

1.  **æ£€æµ‹APIçŠ¶æ€ï¼š** ä½¿ç”¨curlæ£€æµ‹Teampasså®ä¾‹æ˜¯å¦å¯ç”¨äº†APIåŠŸèƒ½ã€‚
2.  **æ„é€ æ¶æ„SQLæ³¨å…¥ï¼š** é€šè¿‡ä¿®æ”¹`login`å‚æ•°ï¼Œæ³¨å…¥SQLè¯­å¥ï¼Œç»•è¿‡èº«ä»½éªŒè¯ã€‚
3.  **æå–æ•°æ®ï¼š** ä½¿ç”¨curlå‘é€æ„é€ å¥½çš„JSON payloadï¼Œç„¶ååˆ©ç”¨`jq`å’Œ`base64`è§£ç æå–æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [HarshRajSinghania/CVE-2023-1545-Exploit](https://github.com/HarshRajSinghania/CVE-2023-1545-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---

## POC #2

**æ¥æº**: [CVE-2023-1545-gunzf0x_CVE-2023-1545.md](../2023/CVE-2023-1545-gunzf0x_CVE-2023-1545.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ•°æ®æ³„éœ²ï¼Œä¾‹å¦‚ç”¨æˆ·åå’Œå¯†ç ã€‚

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿè®¿é—®Teampassçš„WebæœåŠ¡å™¨ï¼Œå¹¶ä¸”ç›®æ ‡Teampasså®ä¾‹çš„ç‰ˆæœ¬ä½äº3.0.0.23ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2023-1545æ˜¯Teampassç‰ˆæœ¬3.0.0.23ä¹‹å‰å­˜åœ¨çš„ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„CVSSè¯„åˆ†ä¸º7.5ï¼Œå±äºé«˜å±æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„Python POCä»£ç é€šè¿‡æ„é€ æ¶æ„çš„SQLè¯­å¥ï¼Œåˆ©ç”¨Teampassçš„èº«ä»½éªŒè¯æ¥å£ä¸­çš„SQLæ³¨å…¥æ¼æ´ï¼Œç»•è¿‡èº«ä»½éªŒè¯å¹¶æå–æ•°æ®åº“ä¸­çš„ç”¨æˆ·ä¿¡æ¯ã€‚POCä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡URLæ˜¯å¦å¯è®¿é—®ï¼Œç„¶åå°è¯•ä½¿ç”¨SQLæ³¨å…¥æšä¸¾ç”¨æˆ·ï¼Œå¹¶æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚æ ¹æ®ä»£ç é€»è¾‘å’Œæ¼æ´æè¿°ï¼Œè¯¥POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»”ç»†æ£€æŸ¥äº†æä¾›çš„POCä»£ç ï¼Œæœªå‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚è¯¥è„šæœ¬çš„åŠŸèƒ½æ˜ç¡®ä¸”é›†ä¸­äºåˆ©ç”¨SQLæ³¨å…¥æ¼æ´ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å°è¯•è¿›è¡Œæœªç»æˆæƒçš„æ–‡ä»¶è®¿é—®ã€ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œæˆ–å…¶ä»–æ¶æ„æ´»åŠ¨çš„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¯ä»¥è®¤ä¸ºé£é™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Teampasså®ä¾‹çš„ç‰ˆæœ¬æ˜¯å¦ä½äº3.0.0.23ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCä»£ç ï¼Œå‘Teampassçš„/api/index.php/authorizeæ¥å£å‘é€åŒ…å«æ¶æ„SQLæ³¨å…¥çš„POSTè¯·æ±‚ã€‚
3.  æ¶æ„SQLæ³¨å…¥è¯­å¥è¢«æ’å…¥åˆ°loginå­—æ®µä¸­ï¼Œç»•è¿‡èº«ä»½éªŒè¯ï¼Œå¹¶ä»teampass_usersè¡¨ä¸­æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚
4.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æå–åˆ°çš„å¯†ç å“ˆå¸Œå€¼ï¼Œé€šè¿‡å¯†ç ç ´è§£ç­‰æ‰‹æ®µè·å–ç”¨æˆ·å¯†ç ï¼Œä»è€Œè·å¾—å¯¹Teampassç³»ç»Ÿçš„è®¿é—®æƒé™ã€‚

**é¡¹ç›®åœ°å€:** [gunzf0x/CVE-2023-1545](https://github.com/gunzf0x/CVE-2023-1545)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---

## POC #3

**æ¥æº**: [CVE-2023-1545-lineeralgebra_CVE-2023-1545-POC.md](../2023/CVE-2023-1545-lineeralgebra_CVE-2023-1545-POC.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Teampasså®ä¾‹å¯ç”¨APIï¼Œä¸”ç½‘ç»œå¯è®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2023-1545æ˜¯Teampass 3.0.0.23ä¹‹å‰ç‰ˆæœ¬ä¸­å­˜åœ¨çš„SQLæ³¨å…¥æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç åˆ†æï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š**  è¯¥æ¼æ´ç”±äºTeampassåœ¨å¤„ç†ç”¨æˆ·ç™»å½•è®¤è¯æ—¶ï¼Œå¯¹è¾“å…¥å‚æ•°ï¼ˆloginï¼‰æœªè¿›è¡Œå……åˆ†çš„è¿‡æ»¤å’Œè½¬ä¹‰ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥åœ¨loginå­—æ®µä¸­æ³¨å…¥æ¶æ„çš„SQLä»£ç ã€‚
2.  **åˆ©ç”¨æ­¥éª¤ï¼š**
    *   é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®å®šç›®æ ‡Teampasså®ä¾‹æ˜¯å¦å¯ç”¨äº†APIåŠŸèƒ½ã€‚PoCä»£ç é€šè¿‡è®¿é—®`/api/index.php/authorize`æ¥æ£€æµ‹APIæ˜¯å¦å¯ç”¨ã€‚
    *   ç„¶åï¼Œæ”»å‡»è€…æ„é€ åŒ…å«SQLæ³¨å…¥è¯­å¥çš„loginå‚æ•°ã€‚PoCä»£ç ä¸­ä½¿ç”¨äº†`UNION SELECT`è¯­å¥ï¼Œå°†æ”»å‡»è€…çš„SQLæŸ¥è¯¢ç»“æœä¸åŸå§‹æŸ¥è¯¢ç»“æœåˆå¹¶ï¼Œä»è€Œè·å–æ•°æ®åº“ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚ç‰¹åˆ«æ„é€ äº†loginä¸º `none' UNION SELECT ...` è¿™æ ·çš„ Payloadï¼Œç»•è¿‡äº†åŸæœ‰çš„loginéªŒè¯ã€‚å¯†ç éšæ„å¡«å†™ï¼Œapikeyä¹Ÿéšæ„ã€‚
    *   é€šè¿‡å‘é€POSTè¯·æ±‚åˆ°`/api/index.php/authorize`ç«¯ç‚¹ï¼Œå°†åŒ…å«æ¶æ„SQLä»£ç çš„JSONæ•°æ®å‘é€ç»™TeampassæœåŠ¡å™¨ã€‚
    *   æœåŠ¡å™¨æ‰§è¡ŒSQLæŸ¥è¯¢åï¼Œä¼šå°†æŸ¥è¯¢ç»“æœåŒ…å«åœ¨è¿”å›çš„tokenä¸­ã€‚æ”»å‡»è€…å¯ä»¥ä»tokenä¸­æå–`public_key`å­—æ®µï¼Œè¯¥å­—æ®µåŒ…å«äº†SQLæŸ¥è¯¢çš„ç»“æœã€‚
3.  **PoCä»£ç åˆ†æï¼š**
    *   PoCä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡APIæ˜¯å¦å¯ç”¨ã€‚
    *   `exec_sql`å‡½æ•°å°è£…äº†SQLæ³¨å…¥çš„è¿‡ç¨‹ï¼Œæ¥æ”¶SQLæŸ¥è¯¢è¯­å¥ä½œä¸ºå‚æ•°ï¼Œæ„é€ åŒ…å«æ³¨å…¥è¯­å¥çš„JSONæ•°æ®ï¼Œå‘é€POSTè¯·æ±‚ï¼Œå¹¶ä»è¿”å›çš„tokenä¸­æå–æŸ¥è¯¢ç»“æœã€‚
    *   PoCä»£ç é¦–å…ˆä½¿ç”¨`SELECT COUNT(*) FROM teampass_users WHERE pw != ''`è¯­å¥è·å–ç”¨æˆ·æ•°é‡ï¼Œç„¶åå¾ªç¯éå†ç”¨æˆ·ï¼Œä½¿ç”¨`SELECT login FROM teampass_users WHERE pw != '' ORDER BY login ASC LIMIT {i},1`å’Œ`SELECT pw FROM teampass_users WHERE pw != '' ORDER BY login ASC LIMIT {i},1`è¯­å¥åˆ†åˆ«è·å–ç”¨æˆ·åå’Œå¯†ç ã€‚
4.  **æœ‰æ•ˆæ€§ï¼š**  æ ¹æ®æä¾›çš„æœç´¢å¼•æ“ç»“æœï¼Œå­˜åœ¨å…¬å¼€çš„æ¼æ´åˆ©ç”¨expï¼Œå¹¶ä¸”æ¼æ´å½±å“ç‰ˆæœ¬å°äº3.0.0.23ï¼Œåˆ©ç”¨ä»£ç å®Œæ•´ï¼Œå‚æ•°æ˜ç¡®ï¼Œå› æ­¤åˆ¤æ–­POCä»£ç æœ‰æ•ˆã€‚
5.  **æŠ•æ¯’é£é™©ï¼š**  è¯¥ä»£ç ä¸»è¦å®ç°äº†SQLæ³¨å…¥åˆ©ç”¨ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ã€‚æ¯”å¦‚ä¸‹è½½å…¶ä»–æ–‡ä»¶ã€æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ç­‰ã€‚ä»£ç ä¸­å­˜åœ¨çš„é£é™©ç‚¹åœ¨äºï¼Œå¯èƒ½ä¼šè¢«æ»¥ç”¨è¿›è¡Œæœªæˆæƒçš„æ•°æ®åº“ä¿¡æ¯çªƒå–ã€‚ä½†æ˜¯ä½œä¸ºPOCæœ¬èº«ï¼Œä¸å±äºæŠ•æ¯’è¡Œä¸ºã€‚ç»†å¾®æŠ•æ¯’å¯èƒ½åœ¨äºï¼ŒPoCä¸­ä½¿ç”¨çš„`arbitrary_hash`å¯èƒ½ä¼šè¯¯å¯¼ä½¿ç”¨è€…ï¼Œè®¤ä¸ºæ”»å‡»è€…å¯ä»¥é€šè¿‡è¯¥hashç›´æ¥ç™»å½•ï¼Œå®é™…ä¸Šéœ€è¦æ›¿æ¢æˆç›®æ ‡ç”¨æˆ·çš„å¯†ç hashã€‚æ•…æŠ•æ¯’é£é™©è¾ƒä½, ä¼°ç®—ä¸º 5%ã€‚

**é¡¹ç›®åœ°å€:** [lineeralgebra/CVE-2023-1545-POC](https://github.com/lineeralgebra/CVE-2023-1545-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---

## POC #4

**æ¥æº**: [CVE-2023-1545-sternstundes_CVE-2023-1545-POC-python.md](../2023/CVE-2023-1545-sternstundes_CVE-2023-1545-POC-python.md)

# CVE-2023-1545

> ğŸ“¦ è¯¥CVEæœ‰ **5** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-1545-HarshRajSinghania_CVE-2023-1545-Exploit.md](../2023/CVE-2023-1545-HarshRajSinghania_CVE-2023-1545-Exploit.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œå¦‚ç”¨æˆ·åå’Œå¯†ç 

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Teampasså®ä¾‹å¼€å¯APIåŠŸèƒ½ä¸”ç½‘ç»œå¯è¾¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼ŒCVE-2023-1545æ˜¯Teampass 3.0.0.23ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„SQLæ³¨å…¥æ¼æ´ã€‚POCä»£ç é€šè¿‡æ„é€ æ¶æ„çš„`login`å‚æ•°ï¼Œåˆ©ç”¨UNION SELECTè¯­å¥å°†æ”»å‡»è€…æ³¨å…¥çš„SQLæŸ¥è¯¢ç»“æœä¸åˆæ³•æŸ¥è¯¢ç»“æœåˆå¹¶ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯ï¼Œæå–æ•°æ®åº“ä¸­çš„æ•æ„Ÿä¿¡æ¯ï¼Œå¦‚ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œã€‚è¯¥POCé¦–å…ˆæ£€æŸ¥APIåŠŸèƒ½æ˜¯å¦å¯ç”¨ï¼Œç„¶åæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„SQLæ³¨å…¥çš„JSON payloadå‘é€åˆ°`/api/index.php/authorize`ï¼Œåˆ©ç”¨`jq`å’Œ`base64`è§£ç ä»å“åº”ä¸­æå–æ‰€éœ€æ•°æ®ã€‚å¯¹äºæŠ•æ¯’é£é™©ï¼Œè¯¥è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨SQLæ³¨å…¥æ¼æ´æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚ä½†ä¾ç„¶éœ€è¦è°¨æ…ä½¿ç”¨ä»ç½‘ç»œè·å–çš„ä»£ç ï¼Œå­˜åœ¨æå°å¯èƒ½æ€§é€šè¿‡ä¾èµ–å¼•å…¥æ¶æ„ä»£ç ï¼Œå› æ­¤é¢„ä¼°æŠ•æ¯’æ¦‚ç‡ä¸º10%ã€‚åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š

1.  **æ£€æµ‹APIçŠ¶æ€ï¼š** ä½¿ç”¨curlæ£€æµ‹Teampasså®ä¾‹æ˜¯å¦å¯ç”¨äº†APIåŠŸèƒ½ã€‚
2.  **æ„é€ æ¶æ„SQLæ³¨å…¥ï¼š** é€šè¿‡ä¿®æ”¹`login`å‚æ•°ï¼Œæ³¨å…¥SQLè¯­å¥ï¼Œç»•è¿‡èº«ä»½éªŒè¯ã€‚
3.  **æå–æ•°æ®ï¼š** ä½¿ç”¨curlå‘é€æ„é€ å¥½çš„JSON payloadï¼Œç„¶ååˆ©ç”¨`jq`å’Œ`base64`è§£ç æå–æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [HarshRajSinghania/CVE-2023-1545-Exploit](https://github.com/HarshRajSinghania/CVE-2023-1545-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---

## POC #2

**æ¥æº**: [CVE-2023-1545-gunzf0x_CVE-2023-1545.md](../2023/CVE-2023-1545-gunzf0x_CVE-2023-1545.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ•°æ®æ³„éœ²ï¼Œä¾‹å¦‚ç”¨æˆ·åå’Œå¯†ç ã€‚

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿè®¿é—®Teampassçš„WebæœåŠ¡å™¨ï¼Œå¹¶ä¸”ç›®æ ‡Teampasså®ä¾‹çš„ç‰ˆæœ¬ä½äº3.0.0.23ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2023-1545æ˜¯Teampassç‰ˆæœ¬3.0.0.23ä¹‹å‰å­˜åœ¨çš„ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„CVSSè¯„åˆ†ä¸º7.5ï¼Œå±äºé«˜å±æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„Python POCä»£ç é€šè¿‡æ„é€ æ¶æ„çš„SQLè¯­å¥ï¼Œåˆ©ç”¨Teampassçš„èº«ä»½éªŒè¯æ¥å£ä¸­çš„SQLæ³¨å…¥æ¼æ´ï¼Œç»•è¿‡èº«ä»½éªŒè¯å¹¶æå–æ•°æ®åº“ä¸­çš„ç”¨æˆ·ä¿¡æ¯ã€‚POCä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡URLæ˜¯å¦å¯è®¿é—®ï¼Œç„¶åå°è¯•ä½¿ç”¨SQLæ³¨å…¥æšä¸¾ç”¨æˆ·ï¼Œå¹¶æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚æ ¹æ®ä»£ç é€»è¾‘å’Œæ¼æ´æè¿°ï¼Œè¯¥POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»”ç»†æ£€æŸ¥äº†æä¾›çš„POCä»£ç ï¼Œæœªå‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚è¯¥è„šæœ¬çš„åŠŸèƒ½æ˜ç¡®ä¸”é›†ä¸­äºåˆ©ç”¨SQLæ³¨å…¥æ¼æ´ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å°è¯•è¿›è¡Œæœªç»æˆæƒçš„æ–‡ä»¶è®¿é—®ã€ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œæˆ–å…¶ä»–æ¶æ„æ´»åŠ¨çš„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¯ä»¥è®¤ä¸ºé£é™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Teampasså®ä¾‹çš„ç‰ˆæœ¬æ˜¯å¦ä½äº3.0.0.23ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCä»£ç ï¼Œå‘Teampassçš„/api/index.php/authorizeæ¥å£å‘é€åŒ…å«æ¶æ„SQLæ³¨å…¥çš„POSTè¯·æ±‚ã€‚
3.  æ¶æ„SQLæ³¨å…¥è¯­å¥è¢«æ’å…¥åˆ°loginå­—æ®µä¸­ï¼Œç»•è¿‡èº«ä»½éªŒè¯ï¼Œå¹¶ä»teampass_usersè¡¨ä¸­æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚
4.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æå–åˆ°çš„å¯†ç å“ˆå¸Œå€¼ï¼Œé€šè¿‡å¯†ç ç ´è§£ç­‰æ‰‹æ®µè·å–ç”¨æˆ·å¯†ç ï¼Œä»è€Œè·å¾—å¯¹Teampassç³»ç»Ÿçš„è®¿é—®æƒé™ã€‚

**é¡¹ç›®åœ°å€:** [gunzf0x/CVE-2023-1545](https://github.com/gunzf0x/CVE-2023-1545)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---

## POC #3

**æ¥æº**: [CVE-2023-1545-lineeralgebra_CVE-2023-1545-POC.md](../2023/CVE-2023-1545-lineeralgebra_CVE-2023-1545-POC.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Teampasså®ä¾‹å¯ç”¨APIï¼Œä¸”ç½‘ç»œå¯è®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2023-1545æ˜¯Teampass 3.0.0.23ä¹‹å‰ç‰ˆæœ¬ä¸­å­˜åœ¨çš„SQLæ³¨å…¥æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç åˆ†æï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š**  è¯¥æ¼æ´ç”±äºTeampassåœ¨å¤„ç†ç”¨æˆ·ç™»å½•è®¤è¯æ—¶ï¼Œå¯¹è¾“å…¥å‚æ•°ï¼ˆloginï¼‰æœªè¿›è¡Œå……åˆ†çš„è¿‡æ»¤å’Œè½¬ä¹‰ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥åœ¨loginå­—æ®µä¸­æ³¨å…¥æ¶æ„çš„SQLä»£ç ã€‚
2.  **åˆ©ç”¨æ­¥éª¤ï¼š**
    *   é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®å®šç›®æ ‡Teampasså®ä¾‹æ˜¯å¦å¯ç”¨äº†APIåŠŸèƒ½ã€‚PoCä»£ç é€šè¿‡è®¿é—®`/api/index.php/authorize`æ¥æ£€æµ‹APIæ˜¯å¦å¯ç”¨ã€‚
    *   ç„¶åï¼Œæ”»å‡»è€…æ„é€ åŒ…å«SQLæ³¨å…¥è¯­å¥çš„loginå‚æ•°ã€‚PoCä»£ç ä¸­ä½¿ç”¨äº†`UNION SELECT`è¯­å¥ï¼Œå°†æ”»å‡»è€…çš„SQLæŸ¥è¯¢ç»“æœä¸åŸå§‹æŸ¥è¯¢ç»“æœåˆå¹¶ï¼Œä»è€Œè·å–æ•°æ®åº“ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚ç‰¹åˆ«æ„é€ äº†loginä¸º `none' UNION SELECT ...` è¿™æ ·çš„ Payloadï¼Œç»•è¿‡äº†åŸæœ‰çš„loginéªŒè¯ã€‚å¯†ç éšæ„å¡«å†™ï¼Œapikeyä¹Ÿéšæ„ã€‚
    *   é€šè¿‡å‘é€POSTè¯·æ±‚åˆ°`/api/index.php/authorize`ç«¯ç‚¹ï¼Œå°†åŒ…å«æ¶æ„SQLä»£ç çš„JSONæ•°æ®å‘é€ç»™TeampassæœåŠ¡å™¨ã€‚
    *   æœåŠ¡å™¨æ‰§è¡ŒSQLæŸ¥è¯¢åï¼Œä¼šå°†æŸ¥è¯¢ç»“æœåŒ…å«åœ¨è¿”å›çš„tokenä¸­ã€‚æ”»å‡»è€…å¯ä»¥ä»tokenä¸­æå–`public_key`å­—æ®µï¼Œè¯¥å­—æ®µåŒ…å«äº†SQLæŸ¥è¯¢çš„ç»“æœã€‚
3.  **PoCä»£ç åˆ†æï¼š**
    *   PoCä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡APIæ˜¯å¦å¯ç”¨ã€‚
    *   `exec_sql`å‡½æ•°å°è£…äº†SQLæ³¨å…¥çš„è¿‡ç¨‹ï¼Œæ¥æ”¶SQLæŸ¥è¯¢è¯­å¥ä½œä¸ºå‚æ•°ï¼Œæ„é€ åŒ…å«æ³¨å…¥è¯­å¥çš„JSONæ•°æ®ï¼Œå‘é€POSTè¯·æ±‚ï¼Œå¹¶ä»è¿”å›çš„tokenä¸­æå–æŸ¥è¯¢ç»“æœã€‚
    *   PoCä»£ç é¦–å…ˆä½¿ç”¨`SELECT COUNT(*) FROM teampass_users WHERE pw != ''`è¯­å¥è·å–ç”¨æˆ·æ•°é‡ï¼Œç„¶åå¾ªç¯éå†ç”¨æˆ·ï¼Œä½¿ç”¨`SELECT login FROM teampass_users WHERE pw != '' ORDER BY login ASC LIMIT {i},1`å’Œ`SELECT pw FROM teampass_users WHERE pw != '' ORDER BY login ASC LIMIT {i},1`è¯­å¥åˆ†åˆ«è·å–ç”¨æˆ·åå’Œå¯†ç ã€‚
4.  **æœ‰æ•ˆæ€§ï¼š**  æ ¹æ®æä¾›çš„æœç´¢å¼•æ“ç»“æœï¼Œå­˜åœ¨å…¬å¼€çš„æ¼æ´åˆ©ç”¨expï¼Œå¹¶ä¸”æ¼æ´å½±å“ç‰ˆæœ¬å°äº3.0.0.23ï¼Œåˆ©ç”¨ä»£ç å®Œæ•´ï¼Œå‚æ•°æ˜ç¡®ï¼Œå› æ­¤åˆ¤æ–­POCä»£ç æœ‰æ•ˆã€‚
5.  **æŠ•æ¯’é£é™©ï¼š**  è¯¥ä»£ç ä¸»è¦å®ç°äº†SQLæ³¨å…¥åˆ©ç”¨ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ã€‚æ¯”å¦‚ä¸‹è½½å…¶ä»–æ–‡ä»¶ã€æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ç­‰ã€‚ä»£ç ä¸­å­˜åœ¨çš„é£é™©ç‚¹åœ¨äºï¼Œå¯èƒ½ä¼šè¢«æ»¥ç”¨è¿›è¡Œæœªæˆæƒçš„æ•°æ®åº“ä¿¡æ¯çªƒå–ã€‚ä½†æ˜¯ä½œä¸ºPOCæœ¬èº«ï¼Œä¸å±äºæŠ•æ¯’è¡Œä¸ºã€‚ç»†å¾®æŠ•æ¯’å¯èƒ½åœ¨äºï¼ŒPoCä¸­ä½¿ç”¨çš„`arbitrary_hash`å¯èƒ½ä¼šè¯¯å¯¼ä½¿ç”¨è€…ï¼Œè®¤ä¸ºæ”»å‡»è€…å¯ä»¥é€šè¿‡è¯¥hashç›´æ¥ç™»å½•ï¼Œå®é™…ä¸Šéœ€è¦æ›¿æ¢æˆç›®æ ‡ç”¨æˆ·çš„å¯†ç hashã€‚æ•…æŠ•æ¯’é£é™©è¾ƒä½, ä¼°ç®—ä¸º 5%ã€‚

**é¡¹ç›®åœ°å€:** [lineeralgebra/CVE-2023-1545-POC](https://github.com/lineeralgebra/CVE-2023-1545-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---

## POC #4

**æ¥æº**: [CVE-2023-1545-sternstundes_CVE-2023-1545-POC-python.md](../2023/CVE-2023-1545-sternstundes_CVE-2023-1545-POC-python.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** Teampassçš„APIåŠŸèƒ½éœ€è¦å¯ç”¨ï¼Œä¸”ç›®æ ‡å­˜åœ¨æœªä¿®å¤æ¼æ´çš„Teampasså®ä¾‹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2023-1545æ˜¯Teampassç‰ˆæœ¬ä½äº3.0.0.23ä¸­å­˜åœ¨çš„ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„SQLè¯­å¥ï¼Œåˆ©ç”¨/api/index.php/authorizeæ¥å£ç»•è¿‡èº«ä»½éªŒè¯æˆ–æå–æ•æ„Ÿæ•°æ®ã€‚ä»æä¾›çš„POCä»£ç æ¥çœ‹ï¼Œåˆ©ç”¨æ–¹å¼ä¸ºï¼š

1.  **æ£€æŸ¥APIå¯ç”¨æ€§ï¼š** é¦–å…ˆéªŒè¯Teampasså®ä¾‹çš„APIåŠŸèƒ½æ˜¯å¦å¯ç”¨ã€‚
2.  **SQLæ³¨å…¥ï¼š** æ„é€ åŒ…å«SQLæ³¨å…¥çš„JSON payloadï¼Œå…¶ä¸­`login`å­—æ®µè¢«æ³¨å…¥æ¶æ„SQLä»£ç ã€‚ä»£ç ä½¿ç”¨äº†`UNION SELECT`è¯­å¥å°†æ”»å‡»è€…æ„é€ çš„SQLæŸ¥è¯¢ç»“æœé™„åŠ åˆ°åŸå§‹æŸ¥è¯¢ç»“æœä¸­ï¼Œç»•è¿‡èº«ä»½éªŒè¯ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** ä½¿ç”¨POSTè¯·æ±‚å°†åŒ…å«æ¶æ„payloadçš„JSONæ•°æ®å‘é€åˆ°`/api/index.php/authorize`æ¥å£ã€‚
4.  **æå–ä¿¡æ¯ï¼š** å¦‚æœæ³¨å…¥æˆåŠŸï¼ŒæœåŠ¡å™¨ä¼šè¿”å›ä¸€ä¸ªJWT tokenï¼ŒPOCä»£ç ä¼šè§£æJWT tokenä¸­çš„payloadéƒ¨åˆ†ï¼Œæå–`public_key`å­—æ®µçš„å†…å®¹ï¼Œå³SQLæ³¨å…¥æŸ¥è¯¢çš„ç»“æœã€‚è¯¥POCä»£ç é€šè¿‡æ³¨å…¥SQLè¯­å¥è·å–ç”¨æˆ·åå’Œå¯†ç ä¿¡æ¯ã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚å› ä¸ºå®ƒæ¨¡æ‹Ÿäº†åˆ©ç”¨CVE-2023-1545æ¼æ´çš„æ­¥éª¤ï¼ŒåŒ…æ‹¬æ„é€ æ¶æ„SQLè¯­å¥ï¼Œå‘é€APIè¯·æ±‚å’Œè§£æå“åº”ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„POCä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨SQLæ³¨å…¥æ¼æ´è¯»å–æ•°æ®åº“ä¿¡æ¯ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [sternstundes/CVE-2023-1545-POC-python](https://github.com/sternstundes/CVE-2023-1545-POC-python)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---

## POC #5

**æ¥æº**: [CVE-2023-1545-zer0-dave_CVE-2023-1545-POC.md](../2023/CVE-2023-1545-zer0-dave_CVE-2023-1545-POC.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** APIåŠŸèƒ½éœ€è¦å¯ç”¨ï¼Œéœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-1545æ˜¯Teampass 3.0.0.23ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æœªç»æˆæƒçš„æ”»å‡»è€…é€šè¿‡`/api/index.php/authorize`ç«¯ç‚¹è¿›è¡ŒSQLæ³¨å…¥ï¼Œä»è€Œè¯»å–æ•°æ®åº“ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚æä¾›çš„POCè„šæœ¬æ¼”ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚

**æ¼æ´åˆ©ç”¨æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCè„šæœ¬é€šè¿‡æ„é€ æ¶æ„çš„`login`å‚æ•°ï¼Œåˆ©ç”¨SQLæ³¨å…¥æ¼æ´ç»•è¿‡èº«ä»½éªŒè¯ã€‚è„šæœ¬é¦–å…ˆæ£€æŸ¥APIæ˜¯å¦å¯ç”¨ï¼Œç„¶åæ„é€ åŒ…å«SQLæ³¨å…¥çš„JSONæ•°æ®ï¼Œå¹¶ä½¿ç”¨curlå‘`/api/index.php/authorize`ç«¯ç‚¹å‘é€POSTè¯·æ±‚ã€‚å¦‚æœæ³¨å…¥æˆåŠŸï¼ŒAPIå°†è¿”å›åŒ…å«ç”¨æˆ·ä¿¡æ¯çš„tokenï¼Œè„šæœ¬è§£æè¯¥tokenä»¥æå–æ‰€éœ€çš„æ•°æ®ã€‚

**æŠ•æ¯’é£é™©ï¼š**
é€šè¯»POCè„šæœ¬ï¼Œä¸»è¦çš„é£é™©ç‚¹åœ¨äºè„šæœ¬çš„ç”¨é€”æè¿°æ˜¯"reference to those who might have missed the original.",  è¯´æ˜è¿™æœ¬èº«ä¸æ˜¯ä¸€ä¸ªæ­£å¼çš„POCï¼Œæœ‰å¯èƒ½æ˜¯ä½œè€…ä¸ºäº†è§„é¿é£é™©ã€‚
- è„šæœ¬ä¸­ä½¿ç”¨äº†ç¡¬ç¼–ç çš„å“ˆå¸Œå€¼`$2y$10$u5S27wYJCVbaPTRiHRsx7.iImx/WxRA8/tKvWdaWQ/iDuKlIkMbhq`ï¼Œå¹¶åœ¨SQLæ³¨å…¥ä¸­ä½¿ç”¨UNION SELECTè¯­å¥å°†å…¶æ’å…¥åˆ°pwå­—æ®µä¸­ï¼Œè¿™æ˜¯ä¸€ç§æ›¿æ¢å¯†ç çš„åé—¨å°è¯•ï¼Œä½†æœ¬èº«éªŒè¯äº†æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœç”¨æˆ·ç›´æ¥ä½¿ç”¨è¯¥è„šæœ¬ï¼Œå¯èƒ½ä¼šæ„å¤–åœ°å°†éƒ¨åˆ†ç”¨æˆ·çš„å¯†ç æ›¿æ¢ä¸ºè¯¥å“ˆå¸Œå€¼ã€‚è¯¥è¡Œä¸ºå…·æœ‰ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œå› ä¸ºåˆå­¦è€…å¯èƒ½ä¼šè¯¯ä»¥ä¸ºè¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦æ­¥éª¤ï¼Œè€Œå¿½ç•¥äº†å…¶æ½œåœ¨çš„é£é™©ã€‚
- `jq`å‘½ä»¤è¢«ç”¨äºè§£æJSONå“åº”ï¼Œå¦‚æœç›®æ ‡ç³»ç»Ÿä¸Šæ²¡æœ‰å®‰è£…`jq`ï¼Œè„šæœ¬ä¼šå‡ºé”™ã€‚è™½ç„¶è¿™ä¸æ˜¯æ¶æ„ä»£ç ï¼Œä½†å¯èƒ½å¯¼è‡´è„šæœ¬æ— æ³•æ­£å¸¸æ‰§è¡Œã€‚
-  `base64 -d` å‘½ä»¤å¦‚æœæ— æ³•æ­£å¸¸è§£ç å¯èƒ½ä¼šå¯¼è‡´é”™è¯¯.

ç»¼åˆæ¥çœ‹ï¼Œè„šæœ¬ä¸­å­˜åœ¨åé—¨æ€§è´¨çš„ä»£ç ï¼Œä½†å¯ä»¥åˆ¤å®šä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œå› ä¸ºåé—¨æ˜¯æ˜ç¡®å†™å…¥çš„ï¼Œä¸æ˜¯éšè—çš„æ¶æ„è¡Œä¸ºã€‚
è„šæœ¬çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º1%ã€‚é£é™©ä¸»è¦æ¥æºäºç”¨æˆ·æœªå®¡æŸ¥ä»£ç ç›´æ¥ä½¿ç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Teampassç‰ˆæœ¬ä½äº3.0.0.23ï¼Œå¹¶ä¸”å¯ç”¨äº†APIåŠŸèƒ½ã€‚
2.  ä¿®æ”¹POCè„šæœ¬ä¸­çš„`base-url`ä¸ºç›®æ ‡Teampassçš„URLã€‚
3.  è¿è¡Œè„šæœ¬ï¼Œè„šæœ¬å°†å°è¯•åˆ©ç”¨SQLæ³¨å…¥æ¼æ´æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚å¦‚æœæ³¨å…¥æˆåŠŸï¼Œè„šæœ¬å°†è¾“å‡ºæ•°æ®åº“ä¸­æ‰€æœ‰ç”¨æˆ·çš„ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚

**é¡¹ç›®åœ°å€:** [zer0-dave/CVE-2023-1545-POC](https://github.com/zer0-dave/CVE-2023-1545-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---



---

## POC #5

**æ¥æº**: [CVE-2023-1545-zer0-dave_CVE-2023-1545-POC.md](../2023/CVE-2023-1545-zer0-dave_CVE-2023-1545-POC.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** APIåŠŸèƒ½éœ€è¦å¯ç”¨ï¼Œéœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-1545æ˜¯Teampass 3.0.0.23ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æœªç»æˆæƒçš„æ”»å‡»è€…é€šè¿‡`/api/index.php/authorize`ç«¯ç‚¹è¿›è¡ŒSQLæ³¨å…¥ï¼Œä»è€Œè¯»å–æ•°æ®åº“ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚æä¾›çš„POCè„šæœ¬æ¼”ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚

**æ¼æ´åˆ©ç”¨æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCè„šæœ¬é€šè¿‡æ„é€ æ¶æ„çš„`login`å‚æ•°ï¼Œåˆ©ç”¨SQLæ³¨å…¥æ¼æ´ç»•è¿‡èº«ä»½éªŒè¯ã€‚è„šæœ¬é¦–å…ˆæ£€æŸ¥APIæ˜¯å¦å¯ç”¨ï¼Œç„¶åæ„é€ åŒ…å«SQLæ³¨å…¥çš„JSONæ•°æ®ï¼Œå¹¶ä½¿ç”¨curlå‘`/api/index.php/authorize`ç«¯ç‚¹å‘é€POSTè¯·æ±‚ã€‚å¦‚æœæ³¨å…¥æˆåŠŸï¼ŒAPIå°†è¿”å›åŒ…å«ç”¨æˆ·ä¿¡æ¯çš„tokenï¼Œè„šæœ¬è§£æè¯¥tokenä»¥æå–æ‰€éœ€çš„æ•°æ®ã€‚

**æŠ•æ¯’é£é™©ï¼š**
é€šè¯»POCè„šæœ¬ï¼Œä¸»è¦çš„é£é™©ç‚¹åœ¨äºè„šæœ¬çš„ç”¨é€”æè¿°æ˜¯"reference to those who might have missed the original.",  è¯´æ˜è¿™æœ¬èº«ä¸æ˜¯ä¸€ä¸ªæ­£å¼çš„POCï¼Œæœ‰å¯èƒ½æ˜¯ä½œè€…ä¸ºäº†è§„é¿é£é™©ã€‚
- è„šæœ¬ä¸­ä½¿ç”¨äº†ç¡¬ç¼–ç çš„å“ˆå¸Œå€¼`$2y$10$u5S27wYJCVbaPTRiHRsx7.iImx/WxRA8/tKvWdaWQ/iDuKlIkMbhq`ï¼Œå¹¶åœ¨SQLæ³¨å…¥ä¸­ä½¿ç”¨UNION SELECTè¯­å¥å°†å…¶æ’å…¥åˆ°pwå­—æ®µä¸­ï¼Œè¿™æ˜¯ä¸€ç§æ›¿æ¢å¯†ç çš„åé—¨å°è¯•ï¼Œä½†æœ¬èº«éªŒè¯äº†æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœç”¨æˆ·ç›´æ¥ä½¿ç”¨è¯¥è„šæœ¬ï¼Œå¯èƒ½ä¼šæ„å¤–åœ°å°†éƒ¨åˆ†ç”¨æˆ·çš„å¯†ç æ›¿æ¢ä¸ºè¯¥å“ˆå¸Œå€¼ã€‚è¯¥è¡Œä¸ºå…·æœ‰ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œå› ä¸ºåˆå­¦è€…å¯èƒ½ä¼šè¯¯ä»¥ä¸ºè¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦æ­¥éª¤ï¼Œè€Œå¿½ç•¥äº†å…¶æ½œåœ¨çš„é£é™©ã€‚
- `jq`å‘½ä»¤è¢«ç”¨äºè§£æJSONå“åº”ï¼Œå¦‚æœç›®æ ‡ç³»ç»Ÿä¸Šæ²¡æœ‰å®‰è£…`jq`ï¼Œè„šæœ¬ä¼šå‡ºé”™ã€‚è™½ç„¶è¿™ä¸æ˜¯æ¶æ„ä»£ç ï¼Œä½†å¯èƒ½å¯¼è‡´è„šæœ¬æ— æ³•æ­£å¸¸æ‰§è¡Œã€‚
-  `base64 -d` å‘½ä»¤å¦‚æœæ— æ³•æ­£å¸¸è§£ç å¯èƒ½ä¼šå¯¼è‡´é”™è¯¯.

ç»¼åˆæ¥çœ‹ï¼Œè„šæœ¬ä¸­å­˜åœ¨åé—¨æ€§è´¨çš„ä»£ç ï¼Œä½†å¯ä»¥åˆ¤å®šä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œå› ä¸ºåé—¨æ˜¯æ˜ç¡®å†™å…¥çš„ï¼Œä¸æ˜¯éšè—çš„æ¶æ„è¡Œä¸ºã€‚
è„šæœ¬çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º1%ã€‚é£é™©ä¸»è¦æ¥æºäºç”¨æˆ·æœªå®¡æŸ¥ä»£ç ç›´æ¥ä½¿ç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Teampassç‰ˆæœ¬ä½äº3.0.0.23ï¼Œå¹¶ä¸”å¯ç”¨äº†APIåŠŸèƒ½ã€‚
2.  ä¿®æ”¹POCè„šæœ¬ä¸­çš„`base-url`ä¸ºç›®æ ‡Teampassçš„URLã€‚
3.  è¿è¡Œè„šæœ¬ï¼Œè„šæœ¬å°†å°è¯•åˆ©ç”¨SQLæ³¨å…¥æ¼æ´æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚å¦‚æœæ³¨å…¥æˆåŠŸï¼Œè„šæœ¬å°†è¾“å‡ºæ•°æ®åº“ä¸­æ‰€æœ‰ç”¨æˆ·çš„ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚

**é¡¹ç›®åœ°å€:** [zer0-dave/CVE-2023-1545-POC](https://github.com/zer0-dave/CVE-2023-1545-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---



---

## POC #5

**æ¥æº**: [CVE-2023-1545-zer0-dave_CVE-2023-1545-POC.md](../2023/CVE-2023-1545-zer0-dave_CVE-2023-1545-POC.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** APIåŠŸèƒ½éœ€è¦å¯ç”¨ï¼Œéœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-1545æ˜¯Teampass 3.0.0.23ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æœªç»æˆæƒçš„æ”»å‡»è€…é€šè¿‡`/api/index.php/authorize`ç«¯ç‚¹è¿›è¡ŒSQLæ³¨å…¥ï¼Œä»è€Œè¯»å–æ•°æ®åº“ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚æä¾›çš„POCè„šæœ¬æ¼”ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚

**æ¼æ´åˆ©ç”¨æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCè„šæœ¬é€šè¿‡æ„é€ æ¶æ„çš„`login`å‚æ•°ï¼Œåˆ©ç”¨SQLæ³¨å…¥æ¼æ´ç»•è¿‡èº«ä»½éªŒè¯ã€‚è„šæœ¬é¦–å…ˆæ£€æŸ¥APIæ˜¯å¦å¯ç”¨ï¼Œç„¶åæ„é€ åŒ…å«SQLæ³¨å…¥çš„JSONæ•°æ®ï¼Œå¹¶ä½¿ç”¨curlå‘`/api/index.php/authorize`ç«¯ç‚¹å‘é€POSTè¯·æ±‚ã€‚å¦‚æœæ³¨å…¥æˆåŠŸï¼ŒAPIå°†è¿”å›åŒ…å«ç”¨æˆ·ä¿¡æ¯çš„tokenï¼Œè„šæœ¬è§£æè¯¥tokenä»¥æå–æ‰€éœ€çš„æ•°æ®ã€‚

**æŠ•æ¯’é£é™©ï¼š**
é€šè¯»POCè„šæœ¬ï¼Œä¸»è¦çš„é£é™©ç‚¹åœ¨äºè„šæœ¬çš„ç”¨é€”æè¿°æ˜¯"reference to those who might have missed the original.",  è¯´æ˜è¿™æœ¬èº«ä¸æ˜¯ä¸€ä¸ªæ­£å¼çš„POCï¼Œæœ‰å¯èƒ½æ˜¯ä½œè€…ä¸ºäº†è§„é¿é£é™©ã€‚
- è„šæœ¬ä¸­ä½¿ç”¨äº†ç¡¬ç¼–ç çš„å“ˆå¸Œå€¼`$2y$10$u5S27wYJCVbaPTRiHRsx7.iImx/WxRA8/tKvWdaWQ/iDuKlIkMbhq`ï¼Œå¹¶åœ¨SQLæ³¨å…¥ä¸­ä½¿ç”¨UNION SELECTè¯­å¥å°†å…¶æ’å…¥åˆ°pwå­—æ®µä¸­ï¼Œè¿™æ˜¯ä¸€ç§æ›¿æ¢å¯†ç çš„åé—¨å°è¯•ï¼Œä½†æœ¬èº«éªŒè¯äº†æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœç”¨æˆ·ç›´æ¥ä½¿ç”¨è¯¥è„šæœ¬ï¼Œå¯èƒ½ä¼šæ„å¤–åœ°å°†éƒ¨åˆ†ç”¨æˆ·çš„å¯†ç æ›¿æ¢ä¸ºè¯¥å“ˆå¸Œå€¼ã€‚è¯¥è¡Œä¸ºå…·æœ‰ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œå› ä¸ºåˆå­¦è€…å¯èƒ½ä¼šè¯¯ä»¥ä¸ºè¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦æ­¥éª¤ï¼Œè€Œå¿½ç•¥äº†å…¶æ½œåœ¨çš„é£é™©ã€‚
- `jq`å‘½ä»¤è¢«ç”¨äºè§£æJSONå“åº”ï¼Œå¦‚æœç›®æ ‡ç³»ç»Ÿä¸Šæ²¡æœ‰å®‰è£…`jq`ï¼Œè„šæœ¬ä¼šå‡ºé”™ã€‚è™½ç„¶è¿™ä¸æ˜¯æ¶æ„ä»£ç ï¼Œä½†å¯èƒ½å¯¼è‡´è„šæœ¬æ— æ³•æ­£å¸¸æ‰§è¡Œã€‚
-  `base64 -d` å‘½ä»¤å¦‚æœæ— æ³•æ­£å¸¸è§£ç å¯èƒ½ä¼šå¯¼è‡´é”™è¯¯.

ç»¼åˆæ¥çœ‹ï¼Œè„šæœ¬ä¸­å­˜åœ¨åé—¨æ€§è´¨çš„ä»£ç ï¼Œä½†å¯ä»¥åˆ¤å®šä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œå› ä¸ºåé—¨æ˜¯æ˜ç¡®å†™å…¥çš„ï¼Œä¸æ˜¯éšè—çš„æ¶æ„è¡Œä¸ºã€‚
è„šæœ¬çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º1%ã€‚é£é™©ä¸»è¦æ¥æºäºç”¨æˆ·æœªå®¡æŸ¥ä»£ç ç›´æ¥ä½¿ç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Teampassç‰ˆæœ¬ä½äº3.0.0.23ï¼Œå¹¶ä¸”å¯ç”¨äº†APIåŠŸèƒ½ã€‚
2.  ä¿®æ”¹POCè„šæœ¬ä¸­çš„`base-url`ä¸ºç›®æ ‡Teampassçš„URLã€‚
3.  è¿è¡Œè„šæœ¬ï¼Œè„šæœ¬å°†å°è¯•åˆ©ç”¨SQLæ³¨å…¥æ¼æ´æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚å¦‚æœæ³¨å…¥æˆåŠŸï¼Œè„šæœ¬å°†è¾“å‡ºæ•°æ®åº“ä¸­æ‰€æœ‰ç”¨æˆ·çš„ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚

**é¡¹ç›®åœ°å€:** [zer0-dave/CVE-2023-1545-POC](https://github.com/zer0-dave/CVE-2023-1545-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---



---

## POC #5

**æ¥æº**: [CVE-2023-1545-zer0-dave_CVE-2023-1545-POC.md](../2023/CVE-2023-1545-zer0-dave_CVE-2023-1545-POC.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** APIåŠŸèƒ½éœ€è¦å¯ç”¨ï¼Œéœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-1545æ˜¯Teampass 3.0.0.23ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æœªç»æˆæƒçš„æ”»å‡»è€…é€šè¿‡`/api/index.php/authorize`ç«¯ç‚¹è¿›è¡ŒSQLæ³¨å…¥ï¼Œä»è€Œè¯»å–æ•°æ®åº“ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚æä¾›çš„POCè„šæœ¬æ¼”ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚

**æ¼æ´åˆ©ç”¨æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCè„šæœ¬é€šè¿‡æ„é€ æ¶æ„çš„`login`å‚æ•°ï¼Œåˆ©ç”¨SQLæ³¨å…¥æ¼æ´ç»•è¿‡èº«ä»½éªŒè¯ã€‚è„šæœ¬é¦–å…ˆæ£€æŸ¥APIæ˜¯å¦å¯ç”¨ï¼Œç„¶åæ„é€ åŒ…å«SQLæ³¨å…¥çš„JSONæ•°æ®ï¼Œå¹¶ä½¿ç”¨curlå‘`/api/index.php/authorize`ç«¯ç‚¹å‘é€POSTè¯·æ±‚ã€‚å¦‚æœæ³¨å…¥æˆåŠŸï¼ŒAPIå°†è¿”å›åŒ…å«ç”¨æˆ·ä¿¡æ¯çš„tokenï¼Œè„šæœ¬è§£æè¯¥tokenä»¥æå–æ‰€éœ€çš„æ•°æ®ã€‚

**æŠ•æ¯’é£é™©ï¼š**
é€šè¯»POCè„šæœ¬ï¼Œä¸»è¦çš„é£é™©ç‚¹åœ¨äºè„šæœ¬çš„ç”¨é€”æè¿°æ˜¯"reference to those who might have missed the original.",  è¯´æ˜è¿™æœ¬èº«ä¸æ˜¯ä¸€ä¸ªæ­£å¼çš„POCï¼Œæœ‰å¯èƒ½æ˜¯ä½œè€…ä¸ºäº†è§„é¿é£é™©ã€‚
- è„šæœ¬ä¸­ä½¿ç”¨äº†ç¡¬ç¼–ç çš„å“ˆå¸Œå€¼`$2y$10$u5S27wYJCVbaPTRiHRsx7.iImx/WxRA8/tKvWdaWQ/iDuKlIkMbhq`ï¼Œå¹¶åœ¨SQLæ³¨å…¥ä¸­ä½¿ç”¨UNION SELECTè¯­å¥å°†å…¶æ’å…¥åˆ°pwå­—æ®µä¸­ï¼Œè¿™æ˜¯ä¸€ç§æ›¿æ¢å¯†ç çš„åé—¨å°è¯•ï¼Œä½†æœ¬èº«éªŒè¯äº†æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœç”¨æˆ·ç›´æ¥ä½¿ç”¨è¯¥è„šæœ¬ï¼Œå¯èƒ½ä¼šæ„å¤–åœ°å°†éƒ¨åˆ†ç”¨æˆ·çš„å¯†ç æ›¿æ¢ä¸ºè¯¥å“ˆå¸Œå€¼ã€‚è¯¥è¡Œä¸ºå…·æœ‰ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œå› ä¸ºåˆå­¦è€…å¯èƒ½ä¼šè¯¯ä»¥ä¸ºè¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦æ­¥éª¤ï¼Œè€Œå¿½ç•¥äº†å…¶æ½œåœ¨çš„é£é™©ã€‚
- `jq`å‘½ä»¤è¢«ç”¨äºè§£æJSONå“åº”ï¼Œå¦‚æœç›®æ ‡ç³»ç»Ÿä¸Šæ²¡æœ‰å®‰è£…`jq`ï¼Œè„šæœ¬ä¼šå‡ºé”™ã€‚è™½ç„¶è¿™ä¸æ˜¯æ¶æ„ä»£ç ï¼Œä½†å¯èƒ½å¯¼è‡´è„šæœ¬æ— æ³•æ­£å¸¸æ‰§è¡Œã€‚
-  `base64 -d` å‘½ä»¤å¦‚æœæ— æ³•æ­£å¸¸è§£ç å¯èƒ½ä¼šå¯¼è‡´é”™è¯¯.

ç»¼åˆæ¥çœ‹ï¼Œè„šæœ¬ä¸­å­˜åœ¨åé—¨æ€§è´¨çš„ä»£ç ï¼Œä½†å¯ä»¥åˆ¤å®šä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œå› ä¸ºåé—¨æ˜¯æ˜ç¡®å†™å…¥çš„ï¼Œä¸æ˜¯éšè—çš„æ¶æ„è¡Œä¸ºã€‚
è„šæœ¬çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º1%ã€‚é£é™©ä¸»è¦æ¥æºäºç”¨æˆ·æœªå®¡æŸ¥ä»£ç ç›´æ¥ä½¿ç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Teampassç‰ˆæœ¬ä½äº3.0.0.23ï¼Œå¹¶ä¸”å¯ç”¨äº†APIåŠŸèƒ½ã€‚
2.  ä¿®æ”¹POCè„šæœ¬ä¸­çš„`base-url`ä¸ºç›®æ ‡Teampassçš„URLã€‚
3.  è¿è¡Œè„šæœ¬ï¼Œè„šæœ¬å°†å°è¯•åˆ©ç”¨SQLæ³¨å…¥æ¼æ´æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚å¦‚æœæ³¨å…¥æˆåŠŸï¼Œè„šæœ¬å°†è¾“å‡ºæ•°æ®åº“ä¸­æ‰€æœ‰ç”¨æˆ·çš„ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚

**é¡¹ç›®åœ°å€:** [zer0-dave/CVE-2023-1545-POC](https://github.com/zer0-dave/CVE-2023-1545-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---



---

## POC #5

**æ¥æº**: [CVE-2023-1545-zer0-dave_CVE-2023-1545-POC.md](../2023/CVE-2023-1545-zer0-dave_CVE-2023-1545-POC.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** APIåŠŸèƒ½éœ€è¦å¯ç”¨ï¼Œéœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-1545æ˜¯Teampass 3.0.0.23ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æœªç»æˆæƒçš„æ”»å‡»è€…é€šè¿‡`/api/index.php/authorize`ç«¯ç‚¹è¿›è¡ŒSQLæ³¨å…¥ï¼Œä»è€Œè¯»å–æ•°æ®åº“ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚æä¾›çš„POCè„šæœ¬æ¼”ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚

**æ¼æ´åˆ©ç”¨æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCè„šæœ¬é€šè¿‡æ„é€ æ¶æ„çš„`login`å‚æ•°ï¼Œåˆ©ç”¨SQLæ³¨å…¥æ¼æ´ç»•è¿‡èº«ä»½éªŒè¯ã€‚è„šæœ¬é¦–å…ˆæ£€æŸ¥APIæ˜¯å¦å¯ç”¨ï¼Œç„¶åæ„é€ åŒ…å«SQLæ³¨å…¥çš„JSONæ•°æ®ï¼Œå¹¶ä½¿ç”¨curlå‘`/api/index.php/authorize`ç«¯ç‚¹å‘é€POSTè¯·æ±‚ã€‚å¦‚æœæ³¨å…¥æˆåŠŸï¼ŒAPIå°†è¿”å›åŒ…å«ç”¨æˆ·ä¿¡æ¯çš„tokenï¼Œè„šæœ¬è§£æè¯¥tokenä»¥æå–æ‰€éœ€çš„æ•°æ®ã€‚

**æŠ•æ¯’é£é™©ï¼š**
é€šè¯»POCè„šæœ¬ï¼Œä¸»è¦çš„é£é™©ç‚¹åœ¨äºè„šæœ¬çš„ç”¨é€”æè¿°æ˜¯"reference to those who might have missed the original.",  è¯´æ˜è¿™æœ¬èº«ä¸æ˜¯ä¸€ä¸ªæ­£å¼çš„POCï¼Œæœ‰å¯èƒ½æ˜¯ä½œè€…ä¸ºäº†è§„é¿é£é™©ã€‚
- è„šæœ¬ä¸­ä½¿ç”¨äº†ç¡¬ç¼–ç çš„å“ˆå¸Œå€¼`$2y$10$u5S27wYJCVbaPTRiHRsx7.iImx/WxRA8/tKvWdaWQ/iDuKlIkMbhq`ï¼Œå¹¶åœ¨SQLæ³¨å…¥ä¸­ä½¿ç”¨UNION SELECTè¯­å¥å°†å…¶æ’å…¥åˆ°pwå­—æ®µä¸­ï¼Œè¿™æ˜¯ä¸€ç§æ›¿æ¢å¯†ç çš„åé—¨å°è¯•ï¼Œä½†æœ¬èº«éªŒè¯äº†æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœç”¨æˆ·ç›´æ¥ä½¿ç”¨è¯¥è„šæœ¬ï¼Œå¯èƒ½ä¼šæ„å¤–åœ°å°†éƒ¨åˆ†ç”¨æˆ·çš„å¯†ç æ›¿æ¢ä¸ºè¯¥å“ˆå¸Œå€¼ã€‚è¯¥è¡Œä¸ºå…·æœ‰ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œå› ä¸ºåˆå­¦è€…å¯èƒ½ä¼šè¯¯ä»¥ä¸ºè¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦æ­¥éª¤ï¼Œè€Œå¿½ç•¥äº†å…¶æ½œåœ¨çš„é£é™©ã€‚
- `jq`å‘½ä»¤è¢«ç”¨äºè§£æJSONå“åº”ï¼Œå¦‚æœç›®æ ‡ç³»ç»Ÿä¸Šæ²¡æœ‰å®‰è£…`jq`ï¼Œè„šæœ¬ä¼šå‡ºé”™ã€‚è™½ç„¶è¿™ä¸æ˜¯æ¶æ„ä»£ç ï¼Œä½†å¯èƒ½å¯¼è‡´è„šæœ¬æ— æ³•æ­£å¸¸æ‰§è¡Œã€‚
-  `base64 -d` å‘½ä»¤å¦‚æœæ— æ³•æ­£å¸¸è§£ç å¯èƒ½ä¼šå¯¼è‡´é”™è¯¯.

ç»¼åˆæ¥çœ‹ï¼Œè„šæœ¬ä¸­å­˜åœ¨åé—¨æ€§è´¨çš„ä»£ç ï¼Œä½†å¯ä»¥åˆ¤å®šä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œå› ä¸ºåé—¨æ˜¯æ˜ç¡®å†™å…¥çš„ï¼Œä¸æ˜¯éšè—çš„æ¶æ„è¡Œä¸ºã€‚
è„šæœ¬çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º1%ã€‚é£é™©ä¸»è¦æ¥æºäºç”¨æˆ·æœªå®¡æŸ¥ä»£ç ç›´æ¥ä½¿ç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Teampassç‰ˆæœ¬ä½äº3.0.0.23ï¼Œå¹¶ä¸”å¯ç”¨äº†APIåŠŸèƒ½ã€‚
2.  ä¿®æ”¹POCè„šæœ¬ä¸­çš„`base-url`ä¸ºç›®æ ‡Teampassçš„URLã€‚
3.  è¿è¡Œè„šæœ¬ï¼Œè„šæœ¬å°†å°è¯•åˆ©ç”¨SQLæ³¨å…¥æ¼æ´æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚å¦‚æœæ³¨å…¥æˆåŠŸï¼Œè„šæœ¬å°†è¾“å‡ºæ•°æ®åº“ä¸­æ‰€æœ‰ç”¨æˆ·çš„ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚

**é¡¹ç›®åœ°å€:** [zer0-dave/CVE-2023-1545-POC](https://github.com/zer0-dave/CVE-2023-1545-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---



---

## POC #5

**æ¥æº**: [CVE-2023-1545-zer0-dave_CVE-2023-1545-POC.md](../2023/CVE-2023-1545-zer0-dave_CVE-2023-1545-POC.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** APIåŠŸèƒ½éœ€è¦å¯ç”¨ï¼Œéœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-1545æ˜¯Teampass 3.0.0.23ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æœªç»æˆæƒçš„æ”»å‡»è€…é€šè¿‡`/api/index.php/authorize`ç«¯ç‚¹è¿›è¡ŒSQLæ³¨å…¥ï¼Œä»è€Œè¯»å–æ•°æ®åº“ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚æä¾›çš„POCè„šæœ¬æ¼”ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚

**æ¼æ´åˆ©ç”¨æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCè„šæœ¬é€šè¿‡æ„é€ æ¶æ„çš„`login`å‚æ•°ï¼Œåˆ©ç”¨SQLæ³¨å…¥æ¼æ´ç»•è¿‡èº«ä»½éªŒè¯ã€‚è„šæœ¬é¦–å…ˆæ£€æŸ¥APIæ˜¯å¦å¯ç”¨ï¼Œç„¶åæ„é€ åŒ…å«SQLæ³¨å…¥çš„JSONæ•°æ®ï¼Œå¹¶ä½¿ç”¨curlå‘`/api/index.php/authorize`ç«¯ç‚¹å‘é€POSTè¯·æ±‚ã€‚å¦‚æœæ³¨å…¥æˆåŠŸï¼ŒAPIå°†è¿”å›åŒ…å«ç”¨æˆ·ä¿¡æ¯çš„tokenï¼Œè„šæœ¬è§£æè¯¥tokenä»¥æå–æ‰€éœ€çš„æ•°æ®ã€‚

**æŠ•æ¯’é£é™©ï¼š**
é€šè¯»POCè„šæœ¬ï¼Œä¸»è¦çš„é£é™©ç‚¹åœ¨äºè„šæœ¬çš„ç”¨é€”æè¿°æ˜¯"reference to those who might have missed the original.",  è¯´æ˜è¿™æœ¬èº«ä¸æ˜¯ä¸€ä¸ªæ­£å¼çš„POCï¼Œæœ‰å¯èƒ½æ˜¯ä½œè€…ä¸ºäº†è§„é¿é£é™©ã€‚
- è„šæœ¬ä¸­ä½¿ç”¨äº†ç¡¬ç¼–ç çš„å“ˆå¸Œå€¼`$2y$10$u5S27wYJCVbaPTRiHRsx7.iImx/WxRA8/tKvWdaWQ/iDuKlIkMbhq`ï¼Œå¹¶åœ¨SQLæ³¨å…¥ä¸­ä½¿ç”¨UNION SELECTè¯­å¥å°†å…¶æ’å…¥åˆ°pwå­—æ®µä¸­ï¼Œè¿™æ˜¯ä¸€ç§æ›¿æ¢å¯†ç çš„åé—¨å°è¯•ï¼Œä½†æœ¬èº«éªŒè¯äº†æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœç”¨æˆ·ç›´æ¥ä½¿ç”¨è¯¥è„šæœ¬ï¼Œå¯èƒ½ä¼šæ„å¤–åœ°å°†éƒ¨åˆ†ç”¨æˆ·çš„å¯†ç æ›¿æ¢ä¸ºè¯¥å“ˆå¸Œå€¼ã€‚è¯¥è¡Œä¸ºå…·æœ‰ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œå› ä¸ºåˆå­¦è€…å¯èƒ½ä¼šè¯¯ä»¥ä¸ºè¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦æ­¥éª¤ï¼Œè€Œå¿½ç•¥äº†å…¶æ½œåœ¨çš„é£é™©ã€‚
- `jq`å‘½ä»¤è¢«ç”¨äºè§£æJSONå“åº”ï¼Œå¦‚æœç›®æ ‡ç³»ç»Ÿä¸Šæ²¡æœ‰å®‰è£…`jq`ï¼Œè„šæœ¬ä¼šå‡ºé”™ã€‚è™½ç„¶è¿™ä¸æ˜¯æ¶æ„ä»£ç ï¼Œä½†å¯èƒ½å¯¼è‡´è„šæœ¬æ— æ³•æ­£å¸¸æ‰§è¡Œã€‚
-  `base64 -d` å‘½ä»¤å¦‚æœæ— æ³•æ­£å¸¸è§£ç å¯èƒ½ä¼šå¯¼è‡´é”™è¯¯.

ç»¼åˆæ¥çœ‹ï¼Œè„šæœ¬ä¸­å­˜åœ¨åé—¨æ€§è´¨çš„ä»£ç ï¼Œä½†å¯ä»¥åˆ¤å®šä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œå› ä¸ºåé—¨æ˜¯æ˜ç¡®å†™å…¥çš„ï¼Œä¸æ˜¯éšè—çš„æ¶æ„è¡Œä¸ºã€‚
è„šæœ¬çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º1%ã€‚é£é™©ä¸»è¦æ¥æºäºç”¨æˆ·æœªå®¡æŸ¥ä»£ç ç›´æ¥ä½¿ç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Teampassç‰ˆæœ¬ä½äº3.0.0.23ï¼Œå¹¶ä¸”å¯ç”¨äº†APIåŠŸèƒ½ã€‚
2.  ä¿®æ”¹POCè„šæœ¬ä¸­çš„`base-url`ä¸ºç›®æ ‡Teampassçš„URLã€‚
3.  è¿è¡Œè„šæœ¬ï¼Œè„šæœ¬å°†å°è¯•åˆ©ç”¨SQLæ³¨å…¥æ¼æ´æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚å¦‚æœæ³¨å…¥æˆåŠŸï¼Œè„šæœ¬å°†è¾“å‡ºæ•°æ®åº“ä¸­æ‰€æœ‰ç”¨æˆ·çš„ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚

**é¡¹ç›®åœ°å€:** [zer0-dave/CVE-2023-1545-POC](https://github.com/zer0-dave/CVE-2023-1545-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---



---

## POC #5

**æ¥æº**: [CVE-2023-1545-zer0-dave_CVE-2023-1545-POC.md](../2023/CVE-2023-1545-zer0-dave_CVE-2023-1545-POC.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** APIåŠŸèƒ½éœ€è¦å¯ç”¨ï¼Œéœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-1545æ˜¯Teampass 3.0.0.23ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æœªç»æˆæƒçš„æ”»å‡»è€…é€šè¿‡`/api/index.php/authorize`ç«¯ç‚¹è¿›è¡ŒSQLæ³¨å…¥ï¼Œä»è€Œè¯»å–æ•°æ®åº“ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚æä¾›çš„POCè„šæœ¬æ¼”ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚

**æ¼æ´åˆ©ç”¨æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCè„šæœ¬é€šè¿‡æ„é€ æ¶æ„çš„`login`å‚æ•°ï¼Œåˆ©ç”¨SQLæ³¨å…¥æ¼æ´ç»•è¿‡èº«ä»½éªŒè¯ã€‚è„šæœ¬é¦–å…ˆæ£€æŸ¥APIæ˜¯å¦å¯ç”¨ï¼Œç„¶åæ„é€ åŒ…å«SQLæ³¨å…¥çš„JSONæ•°æ®ï¼Œå¹¶ä½¿ç”¨curlå‘`/api/index.php/authorize`ç«¯ç‚¹å‘é€POSTè¯·æ±‚ã€‚å¦‚æœæ³¨å…¥æˆåŠŸï¼ŒAPIå°†è¿”å›åŒ…å«ç”¨æˆ·ä¿¡æ¯çš„tokenï¼Œè„šæœ¬è§£æè¯¥tokenä»¥æå–æ‰€éœ€çš„æ•°æ®ã€‚

**æŠ•æ¯’é£é™©ï¼š**
é€šè¯»POCè„šæœ¬ï¼Œä¸»è¦çš„é£é™©ç‚¹åœ¨äºè„šæœ¬çš„ç”¨é€”æè¿°æ˜¯"reference to those who might have missed the original.",  è¯´æ˜è¿™æœ¬èº«ä¸æ˜¯ä¸€ä¸ªæ­£å¼çš„POCï¼Œæœ‰å¯èƒ½æ˜¯ä½œè€…ä¸ºäº†è§„é¿é£é™©ã€‚
- è„šæœ¬ä¸­ä½¿ç”¨äº†ç¡¬ç¼–ç çš„å“ˆå¸Œå€¼`$2y$10$u5S27wYJCVbaPTRiHRsx7.iImx/WxRA8/tKvWdaWQ/iDuKlIkMbhq`ï¼Œå¹¶åœ¨SQLæ³¨å…¥ä¸­ä½¿ç”¨UNION SELECTè¯­å¥å°†å…¶æ’å…¥åˆ°pwå­—æ®µä¸­ï¼Œè¿™æ˜¯ä¸€ç§æ›¿æ¢å¯†ç çš„åé—¨å°è¯•ï¼Œä½†æœ¬èº«éªŒè¯äº†æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœç”¨æˆ·ç›´æ¥ä½¿ç”¨è¯¥è„šæœ¬ï¼Œå¯èƒ½ä¼šæ„å¤–åœ°å°†éƒ¨åˆ†ç”¨æˆ·çš„å¯†ç æ›¿æ¢ä¸ºè¯¥å“ˆå¸Œå€¼ã€‚è¯¥è¡Œä¸ºå…·æœ‰ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œå› ä¸ºåˆå­¦è€…å¯èƒ½ä¼šè¯¯ä»¥ä¸ºè¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦æ­¥éª¤ï¼Œè€Œå¿½ç•¥äº†å…¶æ½œåœ¨çš„é£é™©ã€‚
- `jq`å‘½ä»¤è¢«ç”¨äºè§£æJSONå“åº”ï¼Œå¦‚æœç›®æ ‡ç³»ç»Ÿä¸Šæ²¡æœ‰å®‰è£…`jq`ï¼Œè„šæœ¬ä¼šå‡ºé”™ã€‚è™½ç„¶è¿™ä¸æ˜¯æ¶æ„ä»£ç ï¼Œä½†å¯èƒ½å¯¼è‡´è„šæœ¬æ— æ³•æ­£å¸¸æ‰§è¡Œã€‚
-  `base64 -d` å‘½ä»¤å¦‚æœæ— æ³•æ­£å¸¸è§£ç å¯èƒ½ä¼šå¯¼è‡´é”™è¯¯.

ç»¼åˆæ¥çœ‹ï¼Œè„šæœ¬ä¸­å­˜åœ¨åé—¨æ€§è´¨çš„ä»£ç ï¼Œä½†å¯ä»¥åˆ¤å®šä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œå› ä¸ºåé—¨æ˜¯æ˜ç¡®å†™å…¥çš„ï¼Œä¸æ˜¯éšè—çš„æ¶æ„è¡Œä¸ºã€‚
è„šæœ¬çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º1%ã€‚é£é™©ä¸»è¦æ¥æºäºç”¨æˆ·æœªå®¡æŸ¥ä»£ç ç›´æ¥ä½¿ç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Teampassç‰ˆæœ¬ä½äº3.0.0.23ï¼Œå¹¶ä¸”å¯ç”¨äº†APIåŠŸèƒ½ã€‚
2.  ä¿®æ”¹POCè„šæœ¬ä¸­çš„`base-url`ä¸ºç›®æ ‡Teampassçš„URLã€‚
3.  è¿è¡Œè„šæœ¬ï¼Œè„šæœ¬å°†å°è¯•åˆ©ç”¨SQLæ³¨å…¥æ¼æ´æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚å¦‚æœæ³¨å…¥æˆåŠŸï¼Œè„šæœ¬å°†è¾“å‡ºæ•°æ®åº“ä¸­æ‰€æœ‰ç”¨æˆ·çš„ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚

**é¡¹ç›®åœ°å€:** [zer0-dave/CVE-2023-1545-POC](https://github.com/zer0-dave/CVE-2023-1545-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---



---

## POC #5

**æ¥æº**: [CVE-2023-1545-zer0-dave_CVE-2023-1545-POC.md](../2023/CVE-2023-1545-zer0-dave_CVE-2023-1545-POC.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** APIåŠŸèƒ½éœ€è¦å¯ç”¨ï¼Œéœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-1545æ˜¯Teampass 3.0.0.23ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æœªç»æˆæƒçš„æ”»å‡»è€…é€šè¿‡`/api/index.php/authorize`ç«¯ç‚¹è¿›è¡ŒSQLæ³¨å…¥ï¼Œä»è€Œè¯»å–æ•°æ®åº“ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚æä¾›çš„POCè„šæœ¬æ¼”ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚

**æ¼æ´åˆ©ç”¨æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCè„šæœ¬é€šè¿‡æ„é€ æ¶æ„çš„`login`å‚æ•°ï¼Œåˆ©ç”¨SQLæ³¨å…¥æ¼æ´ç»•è¿‡èº«ä»½éªŒè¯ã€‚è„šæœ¬é¦–å…ˆæ£€æŸ¥APIæ˜¯å¦å¯ç”¨ï¼Œç„¶åæ„é€ åŒ…å«SQLæ³¨å…¥çš„JSONæ•°æ®ï¼Œå¹¶ä½¿ç”¨curlå‘`/api/index.php/authorize`ç«¯ç‚¹å‘é€POSTè¯·æ±‚ã€‚å¦‚æœæ³¨å…¥æˆåŠŸï¼ŒAPIå°†è¿”å›åŒ…å«ç”¨æˆ·ä¿¡æ¯çš„tokenï¼Œè„šæœ¬è§£æè¯¥tokenä»¥æå–æ‰€éœ€çš„æ•°æ®ã€‚

**æŠ•æ¯’é£é™©ï¼š**
é€šè¯»POCè„šæœ¬ï¼Œä¸»è¦çš„é£é™©ç‚¹åœ¨äºè„šæœ¬çš„ç”¨é€”æè¿°æ˜¯"reference to those who might have missed the original.",  è¯´æ˜è¿™æœ¬èº«ä¸æ˜¯ä¸€ä¸ªæ­£å¼çš„POCï¼Œæœ‰å¯èƒ½æ˜¯ä½œè€…ä¸ºäº†è§„é¿é£é™©ã€‚
- è„šæœ¬ä¸­ä½¿ç”¨äº†ç¡¬ç¼–ç çš„å“ˆå¸Œå€¼`$2y$10$u5S27wYJCVbaPTRiHRsx7.iImx/WxRA8/tKvWdaWQ/iDuKlIkMbhq`ï¼Œå¹¶åœ¨SQLæ³¨å…¥ä¸­ä½¿ç”¨UNION SELECTè¯­å¥å°†å…¶æ’å…¥åˆ°pwå­—æ®µä¸­ï¼Œè¿™æ˜¯ä¸€ç§æ›¿æ¢å¯†ç çš„åé—¨å°è¯•ï¼Œä½†æœ¬èº«éªŒè¯äº†æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœç”¨æˆ·ç›´æ¥ä½¿ç”¨è¯¥è„šæœ¬ï¼Œå¯èƒ½ä¼šæ„å¤–åœ°å°†éƒ¨åˆ†ç”¨æˆ·çš„å¯†ç æ›¿æ¢ä¸ºè¯¥å“ˆå¸Œå€¼ã€‚è¯¥è¡Œä¸ºå…·æœ‰ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œå› ä¸ºåˆå­¦è€…å¯èƒ½ä¼šè¯¯ä»¥ä¸ºè¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦æ­¥éª¤ï¼Œè€Œå¿½ç•¥äº†å…¶æ½œåœ¨çš„é£é™©ã€‚
- `jq`å‘½ä»¤è¢«ç”¨äºè§£æJSONå“åº”ï¼Œå¦‚æœç›®æ ‡ç³»ç»Ÿä¸Šæ²¡æœ‰å®‰è£…`jq`ï¼Œè„šæœ¬ä¼šå‡ºé”™ã€‚è™½ç„¶è¿™ä¸æ˜¯æ¶æ„ä»£ç ï¼Œä½†å¯èƒ½å¯¼è‡´è„šæœ¬æ— æ³•æ­£å¸¸æ‰§è¡Œã€‚
-  `base64 -d` å‘½ä»¤å¦‚æœæ— æ³•æ­£å¸¸è§£ç å¯èƒ½ä¼šå¯¼è‡´é”™è¯¯.

ç»¼åˆæ¥çœ‹ï¼Œè„šæœ¬ä¸­å­˜åœ¨åé—¨æ€§è´¨çš„ä»£ç ï¼Œä½†å¯ä»¥åˆ¤å®šä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œå› ä¸ºåé—¨æ˜¯æ˜ç¡®å†™å…¥çš„ï¼Œä¸æ˜¯éšè—çš„æ¶æ„è¡Œä¸ºã€‚
è„šæœ¬çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º1%ã€‚é£é™©ä¸»è¦æ¥æºäºç”¨æˆ·æœªå®¡æŸ¥ä»£ç ç›´æ¥ä½¿ç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Teampassç‰ˆæœ¬ä½äº3.0.0.23ï¼Œå¹¶ä¸”å¯ç”¨äº†APIåŠŸèƒ½ã€‚
2.  ä¿®æ”¹POCè„šæœ¬ä¸­çš„`base-url`ä¸ºç›®æ ‡Teampassçš„URLã€‚
3.  è¿è¡Œè„šæœ¬ï¼Œè„šæœ¬å°†å°è¯•åˆ©ç”¨SQLæ³¨å…¥æ¼æ´æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚å¦‚æœæ³¨å…¥æˆåŠŸï¼Œè„šæœ¬å°†è¾“å‡ºæ•°æ®åº“ä¸­æ‰€æœ‰ç”¨æˆ·çš„ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚

**é¡¹ç›®åœ°å€:** [zer0-dave/CVE-2023-1545-POC](https://github.com/zer0-dave/CVE-2023-1545-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---



---

## POC #5

**æ¥æº**: [CVE-2023-1545-zer0-dave_CVE-2023-1545-POC.md](../2023/CVE-2023-1545-zer0-dave_CVE-2023-1545-POC.md)

## CVE-2023-1545-Teampass-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-1545

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** Teampass

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 3.0.0.23

**åˆ©ç”¨æ¡ä»¶:** APIåŠŸèƒ½éœ€è¦å¯ç”¨ï¼Œéœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-1545æ˜¯Teampass 3.0.0.23ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æœªç»æˆæƒçš„æ”»å‡»è€…é€šè¿‡`/api/index.php/authorize`ç«¯ç‚¹è¿›è¡ŒSQLæ³¨å…¥ï¼Œä»è€Œè¯»å–æ•°æ®åº“ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚æä¾›çš„POCè„šæœ¬æ¼”ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚

**æ¼æ´åˆ©ç”¨æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCè„šæœ¬é€šè¿‡æ„é€ æ¶æ„çš„`login`å‚æ•°ï¼Œåˆ©ç”¨SQLæ³¨å…¥æ¼æ´ç»•è¿‡èº«ä»½éªŒè¯ã€‚è„šæœ¬é¦–å…ˆæ£€æŸ¥APIæ˜¯å¦å¯ç”¨ï¼Œç„¶åæ„é€ åŒ…å«SQLæ³¨å…¥çš„JSONæ•°æ®ï¼Œå¹¶ä½¿ç”¨curlå‘`/api/index.php/authorize`ç«¯ç‚¹å‘é€POSTè¯·æ±‚ã€‚å¦‚æœæ³¨å…¥æˆåŠŸï¼ŒAPIå°†è¿”å›åŒ…å«ç”¨æˆ·ä¿¡æ¯çš„tokenï¼Œè„šæœ¬è§£æè¯¥tokenä»¥æå–æ‰€éœ€çš„æ•°æ®ã€‚

**æŠ•æ¯’é£é™©ï¼š**
é€šè¯»POCè„šæœ¬ï¼Œä¸»è¦çš„é£é™©ç‚¹åœ¨äºè„šæœ¬çš„ç”¨é€”æè¿°æ˜¯"reference to those who might have missed the original.",  è¯´æ˜è¿™æœ¬èº«ä¸æ˜¯ä¸€ä¸ªæ­£å¼çš„POCï¼Œæœ‰å¯èƒ½æ˜¯ä½œè€…ä¸ºäº†è§„é¿é£é™©ã€‚
- è„šæœ¬ä¸­ä½¿ç”¨äº†ç¡¬ç¼–ç çš„å“ˆå¸Œå€¼`$2y$10$u5S27wYJCVbaPTRiHRsx7.iImx/WxRA8/tKvWdaWQ/iDuKlIkMbhq`ï¼Œå¹¶åœ¨SQLæ³¨å…¥ä¸­ä½¿ç”¨UNION SELECTè¯­å¥å°†å…¶æ’å…¥åˆ°pwå­—æ®µä¸­ï¼Œè¿™æ˜¯ä¸€ç§æ›¿æ¢å¯†ç çš„åé—¨å°è¯•ï¼Œä½†æœ¬èº«éªŒè¯äº†æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœç”¨æˆ·ç›´æ¥ä½¿ç”¨è¯¥è„šæœ¬ï¼Œå¯èƒ½ä¼šæ„å¤–åœ°å°†éƒ¨åˆ†ç”¨æˆ·çš„å¯†ç æ›¿æ¢ä¸ºè¯¥å“ˆå¸Œå€¼ã€‚è¯¥è¡Œä¸ºå…·æœ‰ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œå› ä¸ºåˆå­¦è€…å¯èƒ½ä¼šè¯¯ä»¥ä¸ºè¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦æ­¥éª¤ï¼Œè€Œå¿½ç•¥äº†å…¶æ½œåœ¨çš„é£é™©ã€‚
- `jq`å‘½ä»¤è¢«ç”¨äºè§£æJSONå“åº”ï¼Œå¦‚æœç›®æ ‡ç³»ç»Ÿä¸Šæ²¡æœ‰å®‰è£…`jq`ï¼Œè„šæœ¬ä¼šå‡ºé”™ã€‚è™½ç„¶è¿™ä¸æ˜¯æ¶æ„ä»£ç ï¼Œä½†å¯èƒ½å¯¼è‡´è„šæœ¬æ— æ³•æ­£å¸¸æ‰§è¡Œã€‚
-  `base64 -d` å‘½ä»¤å¦‚æœæ— æ³•æ­£å¸¸è§£ç å¯èƒ½ä¼šå¯¼è‡´é”™è¯¯.

ç»¼åˆæ¥çœ‹ï¼Œè„šæœ¬ä¸­å­˜åœ¨åé—¨æ€§è´¨çš„ä»£ç ï¼Œä½†å¯ä»¥åˆ¤å®šä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œå› ä¸ºåé—¨æ˜¯æ˜ç¡®å†™å…¥çš„ï¼Œä¸æ˜¯éšè—çš„æ¶æ„è¡Œä¸ºã€‚
è„šæœ¬çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º1%ã€‚é£é™©ä¸»è¦æ¥æºäºç”¨æˆ·æœªå®¡æŸ¥ä»£ç ç›´æ¥ä½¿ç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Teampassç‰ˆæœ¬ä½äº3.0.0.23ï¼Œå¹¶ä¸”å¯ç”¨äº†APIåŠŸèƒ½ã€‚
2.  ä¿®æ”¹POCè„šæœ¬ä¸­çš„`base-url`ä¸ºç›®æ ‡Teampassçš„URLã€‚
3.  è¿è¡Œè„šæœ¬ï¼Œè„šæœ¬å°†å°è¯•åˆ©ç”¨SQLæ³¨å…¥æ¼æ´æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚å¦‚æœæ³¨å…¥æˆåŠŸï¼Œè„šæœ¬å°†è¾“å‡ºæ•°æ®åº“ä¸­æ‰€æœ‰ç”¨æˆ·çš„ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œå€¼ã€‚

**é¡¹ç›®åœ°å€:** [zer0-dave/CVE-2023-1545-POC](https://github.com/zer0-dave/CVE-2023-1545-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)

---

