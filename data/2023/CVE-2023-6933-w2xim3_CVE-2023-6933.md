# CVE-2023-6933

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md](../2023/CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md)

## CVE-2023-6933 - WordPress Better Search Replace Plugin PHP å¯¹è±¡æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-6933

**æ¼æ´ç±»å‹:** PHP å¯¹è±¡æ³¨å…¥

**å½±å“åº”ç”¨:** WordPress Better Search Replace Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 1.4.4

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Better Search Replaceæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯åˆ©ç”¨çš„POPé“¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-6933 å­˜åœ¨äº WordPress Better Search Replace æ’ä»¶ä¸­ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®è¿›è¡Œ PHP å¯¹è±¡æ³¨å…¥ã€‚æ¼æ´ä½äº`class-bsr-db.php`æ–‡ä»¶çš„`recursive_unserialize_replace()`å‡½æ•°ä¸­ï¼Œè¯¥å‡½æ•°ç›´æ¥å°†ç”¨æˆ·å¯æ§çš„`search_for`å‚æ•°ä¼ é€’ç»™ PHP çš„ `unserialize()` å‡½æ•°ï¼Œè€Œæ²¡æœ‰è¿›è¡Œé€‚å½“çš„éªŒè¯æˆ–æ¸…ç†ã€‚ ç”±äºè¯¥æ’ä»¶æœ¬èº«ä¸åŒ…å« POP é“¾ï¼Œå› æ­¤æ”»å‡»è€…éœ€è¦ä¾èµ–å…¶ä»–æ’ä»¶æˆ–ä¸»é¢˜ä¸­å­˜åœ¨çš„ POP é“¾æ‰èƒ½å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œåˆ©ç”¨ `search_replace_db` action è§¦å‘æ¼æ´ã€‚PoC ä½¿ç”¨ `dry_run=1` å‚æ•°ä»¥é¿å…æ•°æ®åº“ä¿®æ”¹ï¼Œå¹¶ä½¿ç”¨ `stdClass` å¯¹è±¡ä½œä¸º payloadï¼Œä»¥è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚ é€šè¿‡æ£€æŸ¥ HTTP çŠ¶æ€ä»£ç å’Œå“åº”å†…å®¹ï¼ŒPoC å¯ä»¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è¯¥ PoC æ—¨åœ¨è¿›è¡Œéä¾µå…¥å¼æµ‹è¯•ï¼Œå¹¶ä¸”åŒ…å«å®‰å…¨æªæ–½ï¼Œä¾‹å¦‚ `dry_run=1` å’Œä½¿ç”¨æ— å®³çš„ `stdClass` å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨ä¸€å®šé£é™©ã€‚è¿™é‡Œå‡è®¾æŠ•æ¯’é£é™©ä¸º1%, ä¸»è¦æ¥è‡ªäºä»¥ä¸‹è€ƒè™‘:

1.  **äººä¸ºé”™è¯¯ï¼š** ç”¨æˆ·åœ¨ä½¿ç”¨æˆ–ä¿®æ”¹PoCæ—¶ï¼Œå¯èƒ½ä¼šå¼•å…¥é”™è¯¯æˆ–æ¶æ„ä»£ç ã€‚
2.  **ä¾èµ–é¡¹é—®é¢˜ï¼š** è™½ç„¶ PoC æœ¬èº«çœ‹èµ·æ¥å®‰å…¨ï¼Œä½†å®ƒå¯èƒ½ä¾èµ–äºå…¶ä»–åº“æˆ–ç»„ä»¶ï¼Œè¿™äº›åº“æˆ–ç»„ä»¶å¯èƒ½å­˜åœ¨å®‰å…¨æ¼æ´ã€‚
3.  **ç¯å¢ƒå·®å¼‚ï¼š** PoC åœ¨ä¸åŒç¯å¢ƒä¸‹çš„è¡Œä¸ºå¯èƒ½æœ‰æ‰€ä¸åŒï¼ŒæŸäº›ç¯å¢ƒä¸‹å¯èƒ½ä¼šäº§ç”Ÿæ„æƒ³ä¸åˆ°çš„å‰¯ä½œç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ’ä»¶æ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®è®¤ç›®æ ‡ WordPress ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Better Search Replace æ’ä»¶ã€‚å¯ä»¥é€šè¿‡è®¿é—® `/wp-content/plugins/better-search-replace/README.txt` æ–‡ä»¶æ¥è·å–æ’ä»¶ç‰ˆæœ¬ä¿¡æ¯ã€‚
2.  **Payload æ„é€ ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªæ¶æ„çš„ PHP åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«ä¸€ä¸ª POP é“¾ï¼Œå¯ä»¥è§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚POP é“¾é€šå¸¸æ¶‰åŠå¤šä¸ªç±»çš„ç›¸äº’è°ƒç”¨ï¼Œæœ€ç»ˆæ‰§è¡Œæ¶æ„ä»£ç ã€‚
3.  **æ¼æ´è§¦å‘ï¼š** æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œå¹¶å°† `action` å‚æ•°è®¾ç½®ä¸º `search_replace_db`ï¼Œ`search_for` å‚æ•°è®¾ç½®ä¸ºæ„é€ çš„æ¶æ„åºåˆ—åŒ–å¯¹è±¡ã€‚å…¶ä»–å‚æ•°åŒ…æ‹¬ `replace_with`ï¼Œ `dry_run=1` å’Œ `select_tables[]`ã€‚
4.  **ä»£ç æ‰§è¡Œï¼š** å¦‚æœç›®æ ‡ç«™ç‚¹å­˜åœ¨å¯ç”¨çš„ POP é“¾ï¼Œå¹¶ä¸”åºåˆ—åŒ–å¯¹è±¡æˆåŠŸååºåˆ—åŒ–ï¼Œåˆ™ä¼šè§¦å‘ POP é“¾ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [Trex96/vulnerable-bsr-lab-CVE-2023-6933](https://github.com/Trex96/vulnerable-bsr-lab-CVE-2023-6933)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-6933](https://nvd.nist.gov/vuln/detail/CVE-2023-6933)

---

## POC #2

**æ¥æº**: [CVE-2023-6933-w2xim3_CVE-2023-6933.md](../2023/CVE-2023-6933-w2xim3_CVE-2023-6933.md)

# CVE-2023-6933

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md](../2023/CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md)

## CVE-2023-6933 - WordPress Better Search Replace Plugin PHP å¯¹è±¡æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-6933

**æ¼æ´ç±»å‹:** PHP å¯¹è±¡æ³¨å…¥

**å½±å“åº”ç”¨:** WordPress Better Search Replace Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 1.4.4

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Better Search Replaceæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯åˆ©ç”¨çš„POPé“¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-6933 å­˜åœ¨äº WordPress Better Search Replace æ’ä»¶ä¸­ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®è¿›è¡Œ PHP å¯¹è±¡æ³¨å…¥ã€‚æ¼æ´ä½äº`class-bsr-db.php`æ–‡ä»¶çš„`recursive_unserialize_replace()`å‡½æ•°ä¸­ï¼Œè¯¥å‡½æ•°ç›´æ¥å°†ç”¨æˆ·å¯æ§çš„`search_for`å‚æ•°ä¼ é€’ç»™ PHP çš„ `unserialize()` å‡½æ•°ï¼Œè€Œæ²¡æœ‰è¿›è¡Œé€‚å½“çš„éªŒè¯æˆ–æ¸…ç†ã€‚ ç”±äºè¯¥æ’ä»¶æœ¬èº«ä¸åŒ…å« POP é“¾ï¼Œå› æ­¤æ”»å‡»è€…éœ€è¦ä¾èµ–å…¶ä»–æ’ä»¶æˆ–ä¸»é¢˜ä¸­å­˜åœ¨çš„ POP é“¾æ‰èƒ½å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œåˆ©ç”¨ `search_replace_db` action è§¦å‘æ¼æ´ã€‚PoC ä½¿ç”¨ `dry_run=1` å‚æ•°ä»¥é¿å…æ•°æ®åº“ä¿®æ”¹ï¼Œå¹¶ä½¿ç”¨ `stdClass` å¯¹è±¡ä½œä¸º payloadï¼Œä»¥è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚ é€šè¿‡æ£€æŸ¥ HTTP çŠ¶æ€ä»£ç å’Œå“åº”å†…å®¹ï¼ŒPoC å¯ä»¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è¯¥ PoC æ—¨åœ¨è¿›è¡Œéä¾µå…¥å¼æµ‹è¯•ï¼Œå¹¶ä¸”åŒ…å«å®‰å…¨æªæ–½ï¼Œä¾‹å¦‚ `dry_run=1` å’Œä½¿ç”¨æ— å®³çš„ `stdClass` å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨ä¸€å®šé£é™©ã€‚è¿™é‡Œå‡è®¾æŠ•æ¯’é£é™©ä¸º1%, ä¸»è¦æ¥è‡ªäºä»¥ä¸‹è€ƒè™‘:

1.  **äººä¸ºé”™è¯¯ï¼š** ç”¨æˆ·åœ¨ä½¿ç”¨æˆ–ä¿®æ”¹PoCæ—¶ï¼Œå¯èƒ½ä¼šå¼•å…¥é”™è¯¯æˆ–æ¶æ„ä»£ç ã€‚
2.  **ä¾èµ–é¡¹é—®é¢˜ï¼š** è™½ç„¶ PoC æœ¬èº«çœ‹èµ·æ¥å®‰å…¨ï¼Œä½†å®ƒå¯èƒ½ä¾èµ–äºå…¶ä»–åº“æˆ–ç»„ä»¶ï¼Œè¿™äº›åº“æˆ–ç»„ä»¶å¯èƒ½å­˜åœ¨å®‰å…¨æ¼æ´ã€‚
3.  **ç¯å¢ƒå·®å¼‚ï¼š** PoC åœ¨ä¸åŒç¯å¢ƒä¸‹çš„è¡Œä¸ºå¯èƒ½æœ‰æ‰€ä¸åŒï¼ŒæŸäº›ç¯å¢ƒä¸‹å¯èƒ½ä¼šäº§ç”Ÿæ„æƒ³ä¸åˆ°çš„å‰¯ä½œç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ’ä»¶æ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®è®¤ç›®æ ‡ WordPress ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Better Search Replace æ’ä»¶ã€‚å¯ä»¥é€šè¿‡è®¿é—® `/wp-content/plugins/better-search-replace/README.txt` æ–‡ä»¶æ¥è·å–æ’ä»¶ç‰ˆæœ¬ä¿¡æ¯ã€‚
2.  **Payload æ„é€ ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªæ¶æ„çš„ PHP åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«ä¸€ä¸ª POP é“¾ï¼Œå¯ä»¥è§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚POP é“¾é€šå¸¸æ¶‰åŠå¤šä¸ªç±»çš„ç›¸äº’è°ƒç”¨ï¼Œæœ€ç»ˆæ‰§è¡Œæ¶æ„ä»£ç ã€‚
3.  **æ¼æ´è§¦å‘ï¼š** æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œå¹¶å°† `action` å‚æ•°è®¾ç½®ä¸º `search_replace_db`ï¼Œ`search_for` å‚æ•°è®¾ç½®ä¸ºæ„é€ çš„æ¶æ„åºåˆ—åŒ–å¯¹è±¡ã€‚å…¶ä»–å‚æ•°åŒ…æ‹¬ `replace_with`ï¼Œ `dry_run=1` å’Œ `select_tables[]`ã€‚
4.  **ä»£ç æ‰§è¡Œï¼š** å¦‚æœç›®æ ‡ç«™ç‚¹å­˜åœ¨å¯ç”¨çš„ POP é“¾ï¼Œå¹¶ä¸”åºåˆ—åŒ–å¯¹è±¡æˆåŠŸååºåˆ—åŒ–ï¼Œåˆ™ä¼šè§¦å‘ POP é“¾ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [Trex96/vulnerable-bsr-lab-CVE-2023-6933](https://github.com/Trex96/vulnerable-bsr-lab-CVE-2023-6933)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-6933](https://nvd.nist.gov/vuln/detail/CVE-2023-6933)

---

## POC #2

**æ¥æº**: [CVE-2023-6933-w2xim3_CVE-2023-6933.md](../2023/CVE-2023-6933-w2xim3_CVE-2023-6933.md)

# CVE-2023-6933

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md](../2023/CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md)

## CVE-2023-6933 - WordPress Better Search Replace Plugin PHP å¯¹è±¡æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-6933

**æ¼æ´ç±»å‹:** PHP å¯¹è±¡æ³¨å…¥

**å½±å“åº”ç”¨:** WordPress Better Search Replace Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 1.4.4

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Better Search Replaceæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯åˆ©ç”¨çš„POPé“¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-6933 å­˜åœ¨äº WordPress Better Search Replace æ’ä»¶ä¸­ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®è¿›è¡Œ PHP å¯¹è±¡æ³¨å…¥ã€‚æ¼æ´ä½äº`class-bsr-db.php`æ–‡ä»¶çš„`recursive_unserialize_replace()`å‡½æ•°ä¸­ï¼Œè¯¥å‡½æ•°ç›´æ¥å°†ç”¨æˆ·å¯æ§çš„`search_for`å‚æ•°ä¼ é€’ç»™ PHP çš„ `unserialize()` å‡½æ•°ï¼Œè€Œæ²¡æœ‰è¿›è¡Œé€‚å½“çš„éªŒè¯æˆ–æ¸…ç†ã€‚ ç”±äºè¯¥æ’ä»¶æœ¬èº«ä¸åŒ…å« POP é“¾ï¼Œå› æ­¤æ”»å‡»è€…éœ€è¦ä¾èµ–å…¶ä»–æ’ä»¶æˆ–ä¸»é¢˜ä¸­å­˜åœ¨çš„ POP é“¾æ‰èƒ½å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œåˆ©ç”¨ `search_replace_db` action è§¦å‘æ¼æ´ã€‚PoC ä½¿ç”¨ `dry_run=1` å‚æ•°ä»¥é¿å…æ•°æ®åº“ä¿®æ”¹ï¼Œå¹¶ä½¿ç”¨ `stdClass` å¯¹è±¡ä½œä¸º payloadï¼Œä»¥è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚ é€šè¿‡æ£€æŸ¥ HTTP çŠ¶æ€ä»£ç å’Œå“åº”å†…å®¹ï¼ŒPoC å¯ä»¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è¯¥ PoC æ—¨åœ¨è¿›è¡Œéä¾µå…¥å¼æµ‹è¯•ï¼Œå¹¶ä¸”åŒ…å«å®‰å…¨æªæ–½ï¼Œä¾‹å¦‚ `dry_run=1` å’Œä½¿ç”¨æ— å®³çš„ `stdClass` å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨ä¸€å®šé£é™©ã€‚è¿™é‡Œå‡è®¾æŠ•æ¯’é£é™©ä¸º1%, ä¸»è¦æ¥è‡ªäºä»¥ä¸‹è€ƒè™‘:

1.  **äººä¸ºé”™è¯¯ï¼š** ç”¨æˆ·åœ¨ä½¿ç”¨æˆ–ä¿®æ”¹PoCæ—¶ï¼Œå¯èƒ½ä¼šå¼•å…¥é”™è¯¯æˆ–æ¶æ„ä»£ç ã€‚
2.  **ä¾èµ–é¡¹é—®é¢˜ï¼š** è™½ç„¶ PoC æœ¬èº«çœ‹èµ·æ¥å®‰å…¨ï¼Œä½†å®ƒå¯èƒ½ä¾èµ–äºå…¶ä»–åº“æˆ–ç»„ä»¶ï¼Œè¿™äº›åº“æˆ–ç»„ä»¶å¯èƒ½å­˜åœ¨å®‰å…¨æ¼æ´ã€‚
3.  **ç¯å¢ƒå·®å¼‚ï¼š** PoC åœ¨ä¸åŒç¯å¢ƒä¸‹çš„è¡Œä¸ºå¯èƒ½æœ‰æ‰€ä¸åŒï¼ŒæŸäº›ç¯å¢ƒä¸‹å¯èƒ½ä¼šäº§ç”Ÿæ„æƒ³ä¸åˆ°çš„å‰¯ä½œç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ’ä»¶æ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®è®¤ç›®æ ‡ WordPress ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Better Search Replace æ’ä»¶ã€‚å¯ä»¥é€šè¿‡è®¿é—® `/wp-content/plugins/better-search-replace/README.txt` æ–‡ä»¶æ¥è·å–æ’ä»¶ç‰ˆæœ¬ä¿¡æ¯ã€‚
2.  **Payload æ„é€ ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªæ¶æ„çš„ PHP åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«ä¸€ä¸ª POP é“¾ï¼Œå¯ä»¥è§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚POP é“¾é€šå¸¸æ¶‰åŠå¤šä¸ªç±»çš„ç›¸äº’è°ƒç”¨ï¼Œæœ€ç»ˆæ‰§è¡Œæ¶æ„ä»£ç ã€‚
3.  **æ¼æ´è§¦å‘ï¼š** æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œå¹¶å°† `action` å‚æ•°è®¾ç½®ä¸º `search_replace_db`ï¼Œ`search_for` å‚æ•°è®¾ç½®ä¸ºæ„é€ çš„æ¶æ„åºåˆ—åŒ–å¯¹è±¡ã€‚å…¶ä»–å‚æ•°åŒ…æ‹¬ `replace_with`ï¼Œ `dry_run=1` å’Œ `select_tables[]`ã€‚
4.  **ä»£ç æ‰§è¡Œï¼š** å¦‚æœç›®æ ‡ç«™ç‚¹å­˜åœ¨å¯ç”¨çš„ POP é“¾ï¼Œå¹¶ä¸”åºåˆ—åŒ–å¯¹è±¡æˆåŠŸååºåˆ—åŒ–ï¼Œåˆ™ä¼šè§¦å‘ POP é“¾ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [Trex96/vulnerable-bsr-lab-CVE-2023-6933](https://github.com/Trex96/vulnerable-bsr-lab-CVE-2023-6933)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-6933](https://nvd.nist.gov/vuln/detail/CVE-2023-6933)

---

## POC #2

**æ¥æº**: [CVE-2023-6933-w2xim3_CVE-2023-6933.md](../2023/CVE-2023-6933-w2xim3_CVE-2023-6933.md)

# CVE-2023-6933

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md](../2023/CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md)

## CVE-2023-6933 - WordPress Better Search Replace Plugin PHP å¯¹è±¡æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-6933

**æ¼æ´ç±»å‹:** PHP å¯¹è±¡æ³¨å…¥

**å½±å“åº”ç”¨:** WordPress Better Search Replace Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 1.4.4

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Better Search Replaceæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯åˆ©ç”¨çš„POPé“¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-6933 å­˜åœ¨äº WordPress Better Search Replace æ’ä»¶ä¸­ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®è¿›è¡Œ PHP å¯¹è±¡æ³¨å…¥ã€‚æ¼æ´ä½äº`class-bsr-db.php`æ–‡ä»¶çš„`recursive_unserialize_replace()`å‡½æ•°ä¸­ï¼Œè¯¥å‡½æ•°ç›´æ¥å°†ç”¨æˆ·å¯æ§çš„`search_for`å‚æ•°ä¼ é€’ç»™ PHP çš„ `unserialize()` å‡½æ•°ï¼Œè€Œæ²¡æœ‰è¿›è¡Œé€‚å½“çš„éªŒè¯æˆ–æ¸…ç†ã€‚ ç”±äºè¯¥æ’ä»¶æœ¬èº«ä¸åŒ…å« POP é“¾ï¼Œå› æ­¤æ”»å‡»è€…éœ€è¦ä¾èµ–å…¶ä»–æ’ä»¶æˆ–ä¸»é¢˜ä¸­å­˜åœ¨çš„ POP é“¾æ‰èƒ½å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œåˆ©ç”¨ `search_replace_db` action è§¦å‘æ¼æ´ã€‚PoC ä½¿ç”¨ `dry_run=1` å‚æ•°ä»¥é¿å…æ•°æ®åº“ä¿®æ”¹ï¼Œå¹¶ä½¿ç”¨ `stdClass` å¯¹è±¡ä½œä¸º payloadï¼Œä»¥è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚ é€šè¿‡æ£€æŸ¥ HTTP çŠ¶æ€ä»£ç å’Œå“åº”å†…å®¹ï¼ŒPoC å¯ä»¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è¯¥ PoC æ—¨åœ¨è¿›è¡Œéä¾µå…¥å¼æµ‹è¯•ï¼Œå¹¶ä¸”åŒ…å«å®‰å…¨æªæ–½ï¼Œä¾‹å¦‚ `dry_run=1` å’Œä½¿ç”¨æ— å®³çš„ `stdClass` å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨ä¸€å®šé£é™©ã€‚è¿™é‡Œå‡è®¾æŠ•æ¯’é£é™©ä¸º1%, ä¸»è¦æ¥è‡ªäºä»¥ä¸‹è€ƒè™‘:

1.  **äººä¸ºé”™è¯¯ï¼š** ç”¨æˆ·åœ¨ä½¿ç”¨æˆ–ä¿®æ”¹PoCæ—¶ï¼Œå¯èƒ½ä¼šå¼•å…¥é”™è¯¯æˆ–æ¶æ„ä»£ç ã€‚
2.  **ä¾èµ–é¡¹é—®é¢˜ï¼š** è™½ç„¶ PoC æœ¬èº«çœ‹èµ·æ¥å®‰å…¨ï¼Œä½†å®ƒå¯èƒ½ä¾èµ–äºå…¶ä»–åº“æˆ–ç»„ä»¶ï¼Œè¿™äº›åº“æˆ–ç»„ä»¶å¯èƒ½å­˜åœ¨å®‰å…¨æ¼æ´ã€‚
3.  **ç¯å¢ƒå·®å¼‚ï¼š** PoC åœ¨ä¸åŒç¯å¢ƒä¸‹çš„è¡Œä¸ºå¯èƒ½æœ‰æ‰€ä¸åŒï¼ŒæŸäº›ç¯å¢ƒä¸‹å¯èƒ½ä¼šäº§ç”Ÿæ„æƒ³ä¸åˆ°çš„å‰¯ä½œç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ’ä»¶æ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®è®¤ç›®æ ‡ WordPress ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Better Search Replace æ’ä»¶ã€‚å¯ä»¥é€šè¿‡è®¿é—® `/wp-content/plugins/better-search-replace/README.txt` æ–‡ä»¶æ¥è·å–æ’ä»¶ç‰ˆæœ¬ä¿¡æ¯ã€‚
2.  **Payload æ„é€ ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªæ¶æ„çš„ PHP åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«ä¸€ä¸ª POP é“¾ï¼Œå¯ä»¥è§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚POP é“¾é€šå¸¸æ¶‰åŠå¤šä¸ªç±»çš„ç›¸äº’è°ƒç”¨ï¼Œæœ€ç»ˆæ‰§è¡Œæ¶æ„ä»£ç ã€‚
3.  **æ¼æ´è§¦å‘ï¼š** æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œå¹¶å°† `action` å‚æ•°è®¾ç½®ä¸º `search_replace_db`ï¼Œ`search_for` å‚æ•°è®¾ç½®ä¸ºæ„é€ çš„æ¶æ„åºåˆ—åŒ–å¯¹è±¡ã€‚å…¶ä»–å‚æ•°åŒ…æ‹¬ `replace_with`ï¼Œ `dry_run=1` å’Œ `select_tables[]`ã€‚
4.  **ä»£ç æ‰§è¡Œï¼š** å¦‚æœç›®æ ‡ç«™ç‚¹å­˜åœ¨å¯ç”¨çš„ POP é“¾ï¼Œå¹¶ä¸”åºåˆ—åŒ–å¯¹è±¡æˆåŠŸååºåˆ—åŒ–ï¼Œåˆ™ä¼šè§¦å‘ POP é“¾ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [Trex96/vulnerable-bsr-lab-CVE-2023-6933](https://github.com/Trex96/vulnerable-bsr-lab-CVE-2023-6933)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-6933](https://nvd.nist.gov/vuln/detail/CVE-2023-6933)

---

## POC #2

**æ¥æº**: [CVE-2023-6933-w2xim3_CVE-2023-6933.md](../2023/CVE-2023-6933-w2xim3_CVE-2023-6933.md)

# CVE-2023-6933

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md](../2023/CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md)

## CVE-2023-6933 - WordPress Better Search Replace Plugin PHP å¯¹è±¡æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-6933

**æ¼æ´ç±»å‹:** PHP å¯¹è±¡æ³¨å…¥

**å½±å“åº”ç”¨:** WordPress Better Search Replace Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 1.4.4

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Better Search Replaceæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯åˆ©ç”¨çš„POPé“¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-6933 å­˜åœ¨äº WordPress Better Search Replace æ’ä»¶ä¸­ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®è¿›è¡Œ PHP å¯¹è±¡æ³¨å…¥ã€‚æ¼æ´ä½äº`class-bsr-db.php`æ–‡ä»¶çš„`recursive_unserialize_replace()`å‡½æ•°ä¸­ï¼Œè¯¥å‡½æ•°ç›´æ¥å°†ç”¨æˆ·å¯æ§çš„`search_for`å‚æ•°ä¼ é€’ç»™ PHP çš„ `unserialize()` å‡½æ•°ï¼Œè€Œæ²¡æœ‰è¿›è¡Œé€‚å½“çš„éªŒè¯æˆ–æ¸…ç†ã€‚ ç”±äºè¯¥æ’ä»¶æœ¬èº«ä¸åŒ…å« POP é“¾ï¼Œå› æ­¤æ”»å‡»è€…éœ€è¦ä¾èµ–å…¶ä»–æ’ä»¶æˆ–ä¸»é¢˜ä¸­å­˜åœ¨çš„ POP é“¾æ‰èƒ½å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œåˆ©ç”¨ `search_replace_db` action è§¦å‘æ¼æ´ã€‚PoC ä½¿ç”¨ `dry_run=1` å‚æ•°ä»¥é¿å…æ•°æ®åº“ä¿®æ”¹ï¼Œå¹¶ä½¿ç”¨ `stdClass` å¯¹è±¡ä½œä¸º payloadï¼Œä»¥è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚ é€šè¿‡æ£€æŸ¥ HTTP çŠ¶æ€ä»£ç å’Œå“åº”å†…å®¹ï¼ŒPoC å¯ä»¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è¯¥ PoC æ—¨åœ¨è¿›è¡Œéä¾µå…¥å¼æµ‹è¯•ï¼Œå¹¶ä¸”åŒ…å«å®‰å…¨æªæ–½ï¼Œä¾‹å¦‚ `dry_run=1` å’Œä½¿ç”¨æ— å®³çš„ `stdClass` å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨ä¸€å®šé£é™©ã€‚è¿™é‡Œå‡è®¾æŠ•æ¯’é£é™©ä¸º1%, ä¸»è¦æ¥è‡ªäºä»¥ä¸‹è€ƒè™‘:

1.  **äººä¸ºé”™è¯¯ï¼š** ç”¨æˆ·åœ¨ä½¿ç”¨æˆ–ä¿®æ”¹PoCæ—¶ï¼Œå¯èƒ½ä¼šå¼•å…¥é”™è¯¯æˆ–æ¶æ„ä»£ç ã€‚
2.  **ä¾èµ–é¡¹é—®é¢˜ï¼š** è™½ç„¶ PoC æœ¬èº«çœ‹èµ·æ¥å®‰å…¨ï¼Œä½†å®ƒå¯èƒ½ä¾èµ–äºå…¶ä»–åº“æˆ–ç»„ä»¶ï¼Œè¿™äº›åº“æˆ–ç»„ä»¶å¯èƒ½å­˜åœ¨å®‰å…¨æ¼æ´ã€‚
3.  **ç¯å¢ƒå·®å¼‚ï¼š** PoC åœ¨ä¸åŒç¯å¢ƒä¸‹çš„è¡Œä¸ºå¯èƒ½æœ‰æ‰€ä¸åŒï¼ŒæŸäº›ç¯å¢ƒä¸‹å¯èƒ½ä¼šäº§ç”Ÿæ„æƒ³ä¸åˆ°çš„å‰¯ä½œç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ’ä»¶æ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®è®¤ç›®æ ‡ WordPress ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Better Search Replace æ’ä»¶ã€‚å¯ä»¥é€šè¿‡è®¿é—® `/wp-content/plugins/better-search-replace/README.txt` æ–‡ä»¶æ¥è·å–æ’ä»¶ç‰ˆæœ¬ä¿¡æ¯ã€‚
2.  **Payload æ„é€ ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªæ¶æ„çš„ PHP åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«ä¸€ä¸ª POP é“¾ï¼Œå¯ä»¥è§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚POP é“¾é€šå¸¸æ¶‰åŠå¤šä¸ªç±»çš„ç›¸äº’è°ƒç”¨ï¼Œæœ€ç»ˆæ‰§è¡Œæ¶æ„ä»£ç ã€‚
3.  **æ¼æ´è§¦å‘ï¼š** æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œå¹¶å°† `action` å‚æ•°è®¾ç½®ä¸º `search_replace_db`ï¼Œ`search_for` å‚æ•°è®¾ç½®ä¸ºæ„é€ çš„æ¶æ„åºåˆ—åŒ–å¯¹è±¡ã€‚å…¶ä»–å‚æ•°åŒ…æ‹¬ `replace_with`ï¼Œ `dry_run=1` å’Œ `select_tables[]`ã€‚
4.  **ä»£ç æ‰§è¡Œï¼š** å¦‚æœç›®æ ‡ç«™ç‚¹å­˜åœ¨å¯ç”¨çš„ POP é“¾ï¼Œå¹¶ä¸”åºåˆ—åŒ–å¯¹è±¡æˆåŠŸååºåˆ—åŒ–ï¼Œåˆ™ä¼šè§¦å‘ POP é“¾ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [Trex96/vulnerable-bsr-lab-CVE-2023-6933](https://github.com/Trex96/vulnerable-bsr-lab-CVE-2023-6933)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-6933](https://nvd.nist.gov/vuln/detail/CVE-2023-6933)

---

## POC #2

**æ¥æº**: [CVE-2023-6933-w2xim3_CVE-2023-6933.md](../2023/CVE-2023-6933-w2xim3_CVE-2023-6933.md)

# CVE-2023-6933

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md](../2023/CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md)

## CVE-2023-6933 - WordPress Better Search Replace Plugin PHP å¯¹è±¡æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-6933

**æ¼æ´ç±»å‹:** PHP å¯¹è±¡æ³¨å…¥

**å½±å“åº”ç”¨:** WordPress Better Search Replace Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 1.4.4

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Better Search Replaceæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯åˆ©ç”¨çš„POPé“¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-6933 å­˜åœ¨äº WordPress Better Search Replace æ’ä»¶ä¸­ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®è¿›è¡Œ PHP å¯¹è±¡æ³¨å…¥ã€‚æ¼æ´ä½äº`class-bsr-db.php`æ–‡ä»¶çš„`recursive_unserialize_replace()`å‡½æ•°ä¸­ï¼Œè¯¥å‡½æ•°ç›´æ¥å°†ç”¨æˆ·å¯æ§çš„`search_for`å‚æ•°ä¼ é€’ç»™ PHP çš„ `unserialize()` å‡½æ•°ï¼Œè€Œæ²¡æœ‰è¿›è¡Œé€‚å½“çš„éªŒè¯æˆ–æ¸…ç†ã€‚ ç”±äºè¯¥æ’ä»¶æœ¬èº«ä¸åŒ…å« POP é“¾ï¼Œå› æ­¤æ”»å‡»è€…éœ€è¦ä¾èµ–å…¶ä»–æ’ä»¶æˆ–ä¸»é¢˜ä¸­å­˜åœ¨çš„ POP é“¾æ‰èƒ½å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œåˆ©ç”¨ `search_replace_db` action è§¦å‘æ¼æ´ã€‚PoC ä½¿ç”¨ `dry_run=1` å‚æ•°ä»¥é¿å…æ•°æ®åº“ä¿®æ”¹ï¼Œå¹¶ä½¿ç”¨ `stdClass` å¯¹è±¡ä½œä¸º payloadï¼Œä»¥è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚ é€šè¿‡æ£€æŸ¥ HTTP çŠ¶æ€ä»£ç å’Œå“åº”å†…å®¹ï¼ŒPoC å¯ä»¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è¯¥ PoC æ—¨åœ¨è¿›è¡Œéä¾µå…¥å¼æµ‹è¯•ï¼Œå¹¶ä¸”åŒ…å«å®‰å…¨æªæ–½ï¼Œä¾‹å¦‚ `dry_run=1` å’Œä½¿ç”¨æ— å®³çš„ `stdClass` å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨ä¸€å®šé£é™©ã€‚è¿™é‡Œå‡è®¾æŠ•æ¯’é£é™©ä¸º1%, ä¸»è¦æ¥è‡ªäºä»¥ä¸‹è€ƒè™‘:

1.  **äººä¸ºé”™è¯¯ï¼š** ç”¨æˆ·åœ¨ä½¿ç”¨æˆ–ä¿®æ”¹PoCæ—¶ï¼Œå¯èƒ½ä¼šå¼•å…¥é”™è¯¯æˆ–æ¶æ„ä»£ç ã€‚
2.  **ä¾èµ–é¡¹é—®é¢˜ï¼š** è™½ç„¶ PoC æœ¬èº«çœ‹èµ·æ¥å®‰å…¨ï¼Œä½†å®ƒå¯èƒ½ä¾èµ–äºå…¶ä»–åº“æˆ–ç»„ä»¶ï¼Œè¿™äº›åº“æˆ–ç»„ä»¶å¯èƒ½å­˜åœ¨å®‰å…¨æ¼æ´ã€‚
3.  **ç¯å¢ƒå·®å¼‚ï¼š** PoC åœ¨ä¸åŒç¯å¢ƒä¸‹çš„è¡Œä¸ºå¯èƒ½æœ‰æ‰€ä¸åŒï¼ŒæŸäº›ç¯å¢ƒä¸‹å¯èƒ½ä¼šäº§ç”Ÿæ„æƒ³ä¸åˆ°çš„å‰¯ä½œç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ’ä»¶æ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®è®¤ç›®æ ‡ WordPress ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Better Search Replace æ’ä»¶ã€‚å¯ä»¥é€šè¿‡è®¿é—® `/wp-content/plugins/better-search-replace/README.txt` æ–‡ä»¶æ¥è·å–æ’ä»¶ç‰ˆæœ¬ä¿¡æ¯ã€‚
2.  **Payload æ„é€ ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªæ¶æ„çš„ PHP åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«ä¸€ä¸ª POP é“¾ï¼Œå¯ä»¥è§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚POP é“¾é€šå¸¸æ¶‰åŠå¤šä¸ªç±»çš„ç›¸äº’è°ƒç”¨ï¼Œæœ€ç»ˆæ‰§è¡Œæ¶æ„ä»£ç ã€‚
3.  **æ¼æ´è§¦å‘ï¼š** æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œå¹¶å°† `action` å‚æ•°è®¾ç½®ä¸º `search_replace_db`ï¼Œ`search_for` å‚æ•°è®¾ç½®ä¸ºæ„é€ çš„æ¶æ„åºåˆ—åŒ–å¯¹è±¡ã€‚å…¶ä»–å‚æ•°åŒ…æ‹¬ `replace_with`ï¼Œ `dry_run=1` å’Œ `select_tables[]`ã€‚
4.  **ä»£ç æ‰§è¡Œï¼š** å¦‚æœç›®æ ‡ç«™ç‚¹å­˜åœ¨å¯ç”¨çš„ POP é“¾ï¼Œå¹¶ä¸”åºåˆ—åŒ–å¯¹è±¡æˆåŠŸååºåˆ—åŒ–ï¼Œåˆ™ä¼šè§¦å‘ POP é“¾ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [Trex96/vulnerable-bsr-lab-CVE-2023-6933](https://github.com/Trex96/vulnerable-bsr-lab-CVE-2023-6933)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-6933](https://nvd.nist.gov/vuln/detail/CVE-2023-6933)

---

## POC #2

**æ¥æº**: [CVE-2023-6933-w2xim3_CVE-2023-6933.md](../2023/CVE-2023-6933-w2xim3_CVE-2023-6933.md)

# CVE-2023-6933

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md](../2023/CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md)

## CVE-2023-6933 - WordPress Better Search Replace Plugin PHP å¯¹è±¡æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-6933

**æ¼æ´ç±»å‹:** PHP å¯¹è±¡æ³¨å…¥

**å½±å“åº”ç”¨:** WordPress Better Search Replace Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 1.4.4

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Better Search Replaceæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯åˆ©ç”¨çš„POPé“¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-6933 å­˜åœ¨äº WordPress Better Search Replace æ’ä»¶ä¸­ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®è¿›è¡Œ PHP å¯¹è±¡æ³¨å…¥ã€‚æ¼æ´ä½äº`class-bsr-db.php`æ–‡ä»¶çš„`recursive_unserialize_replace()`å‡½æ•°ä¸­ï¼Œè¯¥å‡½æ•°ç›´æ¥å°†ç”¨æˆ·å¯æ§çš„`search_for`å‚æ•°ä¼ é€’ç»™ PHP çš„ `unserialize()` å‡½æ•°ï¼Œè€Œæ²¡æœ‰è¿›è¡Œé€‚å½“çš„éªŒè¯æˆ–æ¸…ç†ã€‚ ç”±äºè¯¥æ’ä»¶æœ¬èº«ä¸åŒ…å« POP é“¾ï¼Œå› æ­¤æ”»å‡»è€…éœ€è¦ä¾èµ–å…¶ä»–æ’ä»¶æˆ–ä¸»é¢˜ä¸­å­˜åœ¨çš„ POP é“¾æ‰èƒ½å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œåˆ©ç”¨ `search_replace_db` action è§¦å‘æ¼æ´ã€‚PoC ä½¿ç”¨ `dry_run=1` å‚æ•°ä»¥é¿å…æ•°æ®åº“ä¿®æ”¹ï¼Œå¹¶ä½¿ç”¨ `stdClass` å¯¹è±¡ä½œä¸º payloadï¼Œä»¥è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚ é€šè¿‡æ£€æŸ¥ HTTP çŠ¶æ€ä»£ç å’Œå“åº”å†…å®¹ï¼ŒPoC å¯ä»¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è¯¥ PoC æ—¨åœ¨è¿›è¡Œéä¾µå…¥å¼æµ‹è¯•ï¼Œå¹¶ä¸”åŒ…å«å®‰å…¨æªæ–½ï¼Œä¾‹å¦‚ `dry_run=1` å’Œä½¿ç”¨æ— å®³çš„ `stdClass` å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨ä¸€å®šé£é™©ã€‚è¿™é‡Œå‡è®¾æŠ•æ¯’é£é™©ä¸º1%, ä¸»è¦æ¥è‡ªäºä»¥ä¸‹è€ƒè™‘:

1.  **äººä¸ºé”™è¯¯ï¼š** ç”¨æˆ·åœ¨ä½¿ç”¨æˆ–ä¿®æ”¹PoCæ—¶ï¼Œå¯èƒ½ä¼šå¼•å…¥é”™è¯¯æˆ–æ¶æ„ä»£ç ã€‚
2.  **ä¾èµ–é¡¹é—®é¢˜ï¼š** è™½ç„¶ PoC æœ¬èº«çœ‹èµ·æ¥å®‰å…¨ï¼Œä½†å®ƒå¯èƒ½ä¾èµ–äºå…¶ä»–åº“æˆ–ç»„ä»¶ï¼Œè¿™äº›åº“æˆ–ç»„ä»¶å¯èƒ½å­˜åœ¨å®‰å…¨æ¼æ´ã€‚
3.  **ç¯å¢ƒå·®å¼‚ï¼š** PoC åœ¨ä¸åŒç¯å¢ƒä¸‹çš„è¡Œä¸ºå¯èƒ½æœ‰æ‰€ä¸åŒï¼ŒæŸäº›ç¯å¢ƒä¸‹å¯èƒ½ä¼šäº§ç”Ÿæ„æƒ³ä¸åˆ°çš„å‰¯ä½œç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ’ä»¶æ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®è®¤ç›®æ ‡ WordPress ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Better Search Replace æ’ä»¶ã€‚å¯ä»¥é€šè¿‡è®¿é—® `/wp-content/plugins/better-search-replace/README.txt` æ–‡ä»¶æ¥è·å–æ’ä»¶ç‰ˆæœ¬ä¿¡æ¯ã€‚
2.  **Payload æ„é€ ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªæ¶æ„çš„ PHP åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«ä¸€ä¸ª POP é“¾ï¼Œå¯ä»¥è§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚POP é“¾é€šå¸¸æ¶‰åŠå¤šä¸ªç±»çš„ç›¸äº’è°ƒç”¨ï¼Œæœ€ç»ˆæ‰§è¡Œæ¶æ„ä»£ç ã€‚
3.  **æ¼æ´è§¦å‘ï¼š** æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œå¹¶å°† `action` å‚æ•°è®¾ç½®ä¸º `search_replace_db`ï¼Œ`search_for` å‚æ•°è®¾ç½®ä¸ºæ„é€ çš„æ¶æ„åºåˆ—åŒ–å¯¹è±¡ã€‚å…¶ä»–å‚æ•°åŒ…æ‹¬ `replace_with`ï¼Œ `dry_run=1` å’Œ `select_tables[]`ã€‚
4.  **ä»£ç æ‰§è¡Œï¼š** å¦‚æœç›®æ ‡ç«™ç‚¹å­˜åœ¨å¯ç”¨çš„ POP é“¾ï¼Œå¹¶ä¸”åºåˆ—åŒ–å¯¹è±¡æˆåŠŸååºåˆ—åŒ–ï¼Œåˆ™ä¼šè§¦å‘ POP é“¾ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [Trex96/vulnerable-bsr-lab-CVE-2023-6933](https://github.com/Trex96/vulnerable-bsr-lab-CVE-2023-6933)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-6933](https://nvd.nist.gov/vuln/detail/CVE-2023-6933)

---

## POC #2

**æ¥æº**: [CVE-2023-6933-w2xim3_CVE-2023-6933.md](../2023/CVE-2023-6933-w2xim3_CVE-2023-6933.md)

# CVE-2023-6933

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md](../2023/CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md)

## CVE-2023-6933 - WordPress Better Search Replace Plugin PHP å¯¹è±¡æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-6933

**æ¼æ´ç±»å‹:** PHP å¯¹è±¡æ³¨å…¥

**å½±å“åº”ç”¨:** WordPress Better Search Replace Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 1.4.4

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Better Search Replaceæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯åˆ©ç”¨çš„POPé“¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-6933 å­˜åœ¨äº WordPress Better Search Replace æ’ä»¶ä¸­ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®è¿›è¡Œ PHP å¯¹è±¡æ³¨å…¥ã€‚æ¼æ´ä½äº`class-bsr-db.php`æ–‡ä»¶çš„`recursive_unserialize_replace()`å‡½æ•°ä¸­ï¼Œè¯¥å‡½æ•°ç›´æ¥å°†ç”¨æˆ·å¯æ§çš„`search_for`å‚æ•°ä¼ é€’ç»™ PHP çš„ `unserialize()` å‡½æ•°ï¼Œè€Œæ²¡æœ‰è¿›è¡Œé€‚å½“çš„éªŒè¯æˆ–æ¸…ç†ã€‚ ç”±äºè¯¥æ’ä»¶æœ¬èº«ä¸åŒ…å« POP é“¾ï¼Œå› æ­¤æ”»å‡»è€…éœ€è¦ä¾èµ–å…¶ä»–æ’ä»¶æˆ–ä¸»é¢˜ä¸­å­˜åœ¨çš„ POP é“¾æ‰èƒ½å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œåˆ©ç”¨ `search_replace_db` action è§¦å‘æ¼æ´ã€‚PoC ä½¿ç”¨ `dry_run=1` å‚æ•°ä»¥é¿å…æ•°æ®åº“ä¿®æ”¹ï¼Œå¹¶ä½¿ç”¨ `stdClass` å¯¹è±¡ä½œä¸º payloadï¼Œä»¥è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚ é€šè¿‡æ£€æŸ¥ HTTP çŠ¶æ€ä»£ç å’Œå“åº”å†…å®¹ï¼ŒPoC å¯ä»¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è¯¥ PoC æ—¨åœ¨è¿›è¡Œéä¾µå…¥å¼æµ‹è¯•ï¼Œå¹¶ä¸”åŒ…å«å®‰å…¨æªæ–½ï¼Œä¾‹å¦‚ `dry_run=1` å’Œä½¿ç”¨æ— å®³çš„ `stdClass` å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨ä¸€å®šé£é™©ã€‚è¿™é‡Œå‡è®¾æŠ•æ¯’é£é™©ä¸º1%, ä¸»è¦æ¥è‡ªäºä»¥ä¸‹è€ƒè™‘:

1.  **äººä¸ºé”™è¯¯ï¼š** ç”¨æˆ·åœ¨ä½¿ç”¨æˆ–ä¿®æ”¹PoCæ—¶ï¼Œå¯èƒ½ä¼šå¼•å…¥é”™è¯¯æˆ–æ¶æ„ä»£ç ã€‚
2.  **ä¾èµ–é¡¹é—®é¢˜ï¼š** è™½ç„¶ PoC æœ¬èº«çœ‹èµ·æ¥å®‰å…¨ï¼Œä½†å®ƒå¯èƒ½ä¾èµ–äºå…¶ä»–åº“æˆ–ç»„ä»¶ï¼Œè¿™äº›åº“æˆ–ç»„ä»¶å¯èƒ½å­˜åœ¨å®‰å…¨æ¼æ´ã€‚
3.  **ç¯å¢ƒå·®å¼‚ï¼š** PoC åœ¨ä¸åŒç¯å¢ƒä¸‹çš„è¡Œä¸ºå¯èƒ½æœ‰æ‰€ä¸åŒï¼ŒæŸäº›ç¯å¢ƒä¸‹å¯èƒ½ä¼šäº§ç”Ÿæ„æƒ³ä¸åˆ°çš„å‰¯ä½œç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ’ä»¶æ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®è®¤ç›®æ ‡ WordPress ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Better Search Replace æ’ä»¶ã€‚å¯ä»¥é€šè¿‡è®¿é—® `/wp-content/plugins/better-search-replace/README.txt` æ–‡ä»¶æ¥è·å–æ’ä»¶ç‰ˆæœ¬ä¿¡æ¯ã€‚
2.  **Payload æ„é€ ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªæ¶æ„çš„ PHP åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«ä¸€ä¸ª POP é“¾ï¼Œå¯ä»¥è§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚POP é“¾é€šå¸¸æ¶‰åŠå¤šä¸ªç±»çš„ç›¸äº’è°ƒç”¨ï¼Œæœ€ç»ˆæ‰§è¡Œæ¶æ„ä»£ç ã€‚
3.  **æ¼æ´è§¦å‘ï¼š** æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œå¹¶å°† `action` å‚æ•°è®¾ç½®ä¸º `search_replace_db`ï¼Œ`search_for` å‚æ•°è®¾ç½®ä¸ºæ„é€ çš„æ¶æ„åºåˆ—åŒ–å¯¹è±¡ã€‚å…¶ä»–å‚æ•°åŒ…æ‹¬ `replace_with`ï¼Œ `dry_run=1` å’Œ `select_tables[]`ã€‚
4.  **ä»£ç æ‰§è¡Œï¼š** å¦‚æœç›®æ ‡ç«™ç‚¹å­˜åœ¨å¯ç”¨çš„ POP é“¾ï¼Œå¹¶ä¸”åºåˆ—åŒ–å¯¹è±¡æˆåŠŸååºåˆ—åŒ–ï¼Œåˆ™ä¼šè§¦å‘ POP é“¾ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [Trex96/vulnerable-bsr-lab-CVE-2023-6933](https://github.com/Trex96/vulnerable-bsr-lab-CVE-2023-6933)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-6933](https://nvd.nist.gov/vuln/detail/CVE-2023-6933)

---

## POC #2

**æ¥æº**: [CVE-2023-6933-w2xim3_CVE-2023-6933.md](../2023/CVE-2023-6933-w2xim3_CVE-2023-6933.md)

# CVE-2023-6933

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md](../2023/CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md)

## CVE-2023-6933 - WordPress Better Search Replace Plugin PHP å¯¹è±¡æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-6933

**æ¼æ´ç±»å‹:** PHP å¯¹è±¡æ³¨å…¥

**å½±å“åº”ç”¨:** WordPress Better Search Replace Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 1.4.4

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Better Search Replaceæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯åˆ©ç”¨çš„POPé“¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-6933 å­˜åœ¨äº WordPress Better Search Replace æ’ä»¶ä¸­ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®è¿›è¡Œ PHP å¯¹è±¡æ³¨å…¥ã€‚æ¼æ´ä½äº`class-bsr-db.php`æ–‡ä»¶çš„`recursive_unserialize_replace()`å‡½æ•°ä¸­ï¼Œè¯¥å‡½æ•°ç›´æ¥å°†ç”¨æˆ·å¯æ§çš„`search_for`å‚æ•°ä¼ é€’ç»™ PHP çš„ `unserialize()` å‡½æ•°ï¼Œè€Œæ²¡æœ‰è¿›è¡Œé€‚å½“çš„éªŒè¯æˆ–æ¸…ç†ã€‚ ç”±äºè¯¥æ’ä»¶æœ¬èº«ä¸åŒ…å« POP é“¾ï¼Œå› æ­¤æ”»å‡»è€…éœ€è¦ä¾èµ–å…¶ä»–æ’ä»¶æˆ–ä¸»é¢˜ä¸­å­˜åœ¨çš„ POP é“¾æ‰èƒ½å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œåˆ©ç”¨ `search_replace_db` action è§¦å‘æ¼æ´ã€‚PoC ä½¿ç”¨ `dry_run=1` å‚æ•°ä»¥é¿å…æ•°æ®åº“ä¿®æ”¹ï¼Œå¹¶ä½¿ç”¨ `stdClass` å¯¹è±¡ä½œä¸º payloadï¼Œä»¥è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚ é€šè¿‡æ£€æŸ¥ HTTP çŠ¶æ€ä»£ç å’Œå“åº”å†…å®¹ï¼ŒPoC å¯ä»¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è¯¥ PoC æ—¨åœ¨è¿›è¡Œéä¾µå…¥å¼æµ‹è¯•ï¼Œå¹¶ä¸”åŒ…å«å®‰å…¨æªæ–½ï¼Œä¾‹å¦‚ `dry_run=1` å’Œä½¿ç”¨æ— å®³çš„ `stdClass` å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨ä¸€å®šé£é™©ã€‚è¿™é‡Œå‡è®¾æŠ•æ¯’é£é™©ä¸º1%, ä¸»è¦æ¥è‡ªäºä»¥ä¸‹è€ƒè™‘:

1.  **äººä¸ºé”™è¯¯ï¼š** ç”¨æˆ·åœ¨ä½¿ç”¨æˆ–ä¿®æ”¹PoCæ—¶ï¼Œå¯èƒ½ä¼šå¼•å…¥é”™è¯¯æˆ–æ¶æ„ä»£ç ã€‚
2.  **ä¾èµ–é¡¹é—®é¢˜ï¼š** è™½ç„¶ PoC æœ¬èº«çœ‹èµ·æ¥å®‰å…¨ï¼Œä½†å®ƒå¯èƒ½ä¾èµ–äºå…¶ä»–åº“æˆ–ç»„ä»¶ï¼Œè¿™äº›åº“æˆ–ç»„ä»¶å¯èƒ½å­˜åœ¨å®‰å…¨æ¼æ´ã€‚
3.  **ç¯å¢ƒå·®å¼‚ï¼š** PoC åœ¨ä¸åŒç¯å¢ƒä¸‹çš„è¡Œä¸ºå¯èƒ½æœ‰æ‰€ä¸åŒï¼ŒæŸäº›ç¯å¢ƒä¸‹å¯èƒ½ä¼šäº§ç”Ÿæ„æƒ³ä¸åˆ°çš„å‰¯ä½œç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ’ä»¶æ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®è®¤ç›®æ ‡ WordPress ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Better Search Replace æ’ä»¶ã€‚å¯ä»¥é€šè¿‡è®¿é—® `/wp-content/plugins/better-search-replace/README.txt` æ–‡ä»¶æ¥è·å–æ’ä»¶ç‰ˆæœ¬ä¿¡æ¯ã€‚
2.  **Payload æ„é€ ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªæ¶æ„çš„ PHP åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«ä¸€ä¸ª POP é“¾ï¼Œå¯ä»¥è§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚POP é“¾é€šå¸¸æ¶‰åŠå¤šä¸ªç±»çš„ç›¸äº’è°ƒç”¨ï¼Œæœ€ç»ˆæ‰§è¡Œæ¶æ„ä»£ç ã€‚
3.  **æ¼æ´è§¦å‘ï¼š** æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œå¹¶å°† `action` å‚æ•°è®¾ç½®ä¸º `search_replace_db`ï¼Œ`search_for` å‚æ•°è®¾ç½®ä¸ºæ„é€ çš„æ¶æ„åºåˆ—åŒ–å¯¹è±¡ã€‚å…¶ä»–å‚æ•°åŒ…æ‹¬ `replace_with`ï¼Œ `dry_run=1` å’Œ `select_tables[]`ã€‚
4.  **ä»£ç æ‰§è¡Œï¼š** å¦‚æœç›®æ ‡ç«™ç‚¹å­˜åœ¨å¯ç”¨çš„ POP é“¾ï¼Œå¹¶ä¸”åºåˆ—åŒ–å¯¹è±¡æˆåŠŸååºåˆ—åŒ–ï¼Œåˆ™ä¼šè§¦å‘ POP é“¾ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [Trex96/vulnerable-bsr-lab-CVE-2023-6933](https://github.com/Trex96/vulnerable-bsr-lab-CVE-2023-6933)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-6933](https://nvd.nist.gov/vuln/detail/CVE-2023-6933)

---

## POC #2

**æ¥æº**: [CVE-2023-6933-w2xim3_CVE-2023-6933.md](../2023/CVE-2023-6933-w2xim3_CVE-2023-6933.md)

## CVE-2023-6933 - WordPress Better Search Replace Plugin PHP å¯¹è±¡æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-6933

**æ¼æ´ç±»å‹:** PHP å¯¹è±¡æ³¨å…¥

**å½±å“åº”ç”¨:** WordPress Better Search Replace Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 1.4.4

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Better Search Replaceæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯åˆ©ç”¨çš„POPé“¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-6933 å­˜åœ¨äº WordPress Better Search Replace æ’ä»¶ä¸­ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®è¿›è¡Œ PHP å¯¹è±¡æ³¨å…¥ã€‚æ¼æ´ä½äº`class-bsr-db.php`æ–‡ä»¶çš„`recursive_unserialize_replace()`å‡½æ•°ä¸­ï¼Œè¯¥å‡½æ•°ç›´æ¥å°†ç”¨æˆ·å¯æ§çš„`search_for`å‚æ•°ä¼ é€’ç»™ PHP çš„ `unserialize()` å‡½æ•°ï¼Œè€Œæ²¡æœ‰è¿›è¡Œé€‚å½“çš„éªŒè¯æˆ–æ¸…ç†ã€‚ ç”±äºè¯¥æ’ä»¶æœ¬èº«ä¸åŒ…å« POP é“¾ï¼Œå› æ­¤æ”»å‡»è€…éœ€è¦ä¾èµ–å…¶ä»–æ’ä»¶æˆ–ä¸»é¢˜ä¸­å­˜åœ¨çš„ POP é“¾æ‰èƒ½å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œåˆ©ç”¨ `search_replace_db` action è§¦å‘æ¼æ´ã€‚PoC ä½¿ç”¨ `dry_run=1` å‚æ•°ä»¥é¿å…æ•°æ®åº“ä¿®æ”¹ï¼Œå¹¶ä½¿ç”¨ `stdClass` å¯¹è±¡ä½œä¸º payloadï¼Œä»¥è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚ é€šè¿‡æ£€æŸ¥ HTTP çŠ¶æ€ä»£ç å’Œå“åº”å†…å®¹ï¼ŒPoC å¯ä»¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è¯¥ PoC æ—¨åœ¨è¿›è¡Œéä¾µå…¥å¼æµ‹è¯•ï¼Œå¹¶ä¸”åŒ…å«å®‰å…¨æªæ–½ï¼Œä¾‹å¦‚ `dry_run=1` å’Œä½¿ç”¨æ— å®³çš„ `stdClass` å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨ä¸€å®šé£é™©ã€‚è¿™é‡Œå‡è®¾æŠ•æ¯’é£é™©ä¸º1%, ä¸»è¦æ¥è‡ªäºä»¥ä¸‹è€ƒè™‘:

1.  **äººä¸ºé”™è¯¯ï¼š** ç”¨æˆ·åœ¨ä½¿ç”¨æˆ–ä¿®æ”¹PoCæ—¶ï¼Œå¯èƒ½ä¼šå¼•å…¥é”™è¯¯æˆ–æ¶æ„ä»£ç ã€‚
2.  **ä¾èµ–é¡¹é—®é¢˜ï¼š** è™½ç„¶ PoC æœ¬èº«çœ‹èµ·æ¥å®‰å…¨ï¼Œä½†å®ƒå¯èƒ½ä¾èµ–äºå…¶ä»–åº“æˆ–ç»„ä»¶ï¼Œè¿™äº›åº“æˆ–ç»„ä»¶å¯èƒ½å­˜åœ¨å®‰å…¨æ¼æ´ã€‚
3.  **ç¯å¢ƒå·®å¼‚ï¼š** PoC åœ¨ä¸åŒç¯å¢ƒä¸‹çš„è¡Œä¸ºå¯èƒ½æœ‰æ‰€ä¸åŒï¼ŒæŸäº›ç¯å¢ƒä¸‹å¯èƒ½ä¼šäº§ç”Ÿæ„æƒ³ä¸åˆ°çš„å‰¯ä½œç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ’ä»¶æ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®è®¤ç›®æ ‡ WordPress ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Better Search Replace æ’ä»¶ã€‚å¯ä»¥é€šè¿‡è®¿é—® `/wp-content/plugins/better-search-replace/README.txt` æ–‡ä»¶æ¥è·å–æ’ä»¶ç‰ˆæœ¬ä¿¡æ¯ã€‚
2.  **Payload æ„é€ ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªæ¶æ„çš„ PHP åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«ä¸€ä¸ª POP é“¾ï¼Œå¯ä»¥è§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚POP é“¾é€šå¸¸æ¶‰åŠå¤šä¸ªç±»çš„ç›¸äº’è°ƒç”¨ï¼Œæœ€ç»ˆæ‰§è¡Œæ¶æ„ä»£ç ã€‚
3.  **æ¼æ´è§¦å‘ï¼š** æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œå¹¶å°† `action` å‚æ•°è®¾ç½®ä¸º `search_replace_db`ï¼Œ`search_for` å‚æ•°è®¾ç½®ä¸ºæ„é€ çš„æ¶æ„åºåˆ—åŒ–å¯¹è±¡ã€‚å…¶ä»–å‚æ•°åŒ…æ‹¬ `replace_with`ï¼Œ `dry_run=1` å’Œ `select_tables[]`ã€‚
4.  **ä»£ç æ‰§è¡Œï¼š** å¦‚æœç›®æ ‡ç«™ç‚¹å­˜åœ¨å¯ç”¨çš„ POP é“¾ï¼Œå¹¶ä¸”åºåˆ—åŒ–å¯¹è±¡æˆåŠŸååºåˆ—åŒ–ï¼Œåˆ™ä¼šè§¦å‘ POP é“¾ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [Trex96/vulnerable-bsr-lab-CVE-2023-6933](https://github.com/Trex96/vulnerable-bsr-lab-CVE-2023-6933)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-6933](https://nvd.nist.gov/vuln/detail/CVE-2023-6933)

---



---



---



---



---



---



---



---



---

