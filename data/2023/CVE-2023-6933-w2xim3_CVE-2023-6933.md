# CVE-2023-6933

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md](../2023/CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md)

## CVE-2023-6933 - WordPress Better Search Replace Plugin PHP å¯¹è±¡æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-6933

**æ¼æ´ç±»å‹:** PHP å¯¹è±¡æ³¨å…¥

**å½±å“åº”ç”¨:** WordPress Better Search Replace Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 1.4.4

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Better Search Replaceæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯åˆ©ç”¨çš„POPé“¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-6933 å­˜åœ¨äº WordPress Better Search Replace æ’ä»¶ä¸­ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®è¿›è¡Œ PHP å¯¹è±¡æ³¨å…¥ã€‚æ¼æ´ä½äº`class-bsr-db.php`æ–‡ä»¶çš„`recursive_unserialize_replace()`å‡½æ•°ä¸­ï¼Œè¯¥å‡½æ•°ç›´æ¥å°†ç”¨æˆ·å¯æ§çš„`search_for`å‚æ•°ä¼ é€’ç»™ PHP çš„ `unserialize()` å‡½æ•°ï¼Œè€Œæ²¡æœ‰è¿›è¡Œé€‚å½“çš„éªŒè¯æˆ–æ¸…ç†ã€‚ ç”±äºè¯¥æ’ä»¶æœ¬èº«ä¸åŒ…å« POP é“¾ï¼Œå› æ­¤æ”»å‡»è€…éœ€è¦ä¾èµ–å…¶ä»–æ’ä»¶æˆ–ä¸»é¢˜ä¸­å­˜åœ¨çš„ POP é“¾æ‰èƒ½å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œåˆ©ç”¨ `search_replace_db` action è§¦å‘æ¼æ´ã€‚PoC ä½¿ç”¨ `dry_run=1` å‚æ•°ä»¥é¿å…æ•°æ®åº“ä¿®æ”¹ï¼Œå¹¶ä½¿ç”¨ `stdClass` å¯¹è±¡ä½œä¸º payloadï¼Œä»¥è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚ é€šè¿‡æ£€æŸ¥ HTTP çŠ¶æ€ä»£ç å’Œå“åº”å†…å®¹ï¼ŒPoC å¯ä»¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è¯¥ PoC æ—¨åœ¨è¿›è¡Œéä¾µå…¥å¼æµ‹è¯•ï¼Œå¹¶ä¸”åŒ…å«å®‰å…¨æªæ–½ï¼Œä¾‹å¦‚ `dry_run=1` å’Œä½¿ç”¨æ— å®³çš„ `stdClass` å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨ä¸€å®šé£é™©ã€‚è¿™é‡Œå‡è®¾æŠ•æ¯’é£é™©ä¸º1%, ä¸»è¦æ¥è‡ªäºä»¥ä¸‹è€ƒè™‘:

1.  **äººä¸ºé”™è¯¯ï¼š** ç”¨æˆ·åœ¨ä½¿ç”¨æˆ–ä¿®æ”¹PoCæ—¶ï¼Œå¯èƒ½ä¼šå¼•å…¥é”™è¯¯æˆ–æ¶æ„ä»£ç ã€‚
2.  **ä¾èµ–é¡¹é—®é¢˜ï¼š** è™½ç„¶ PoC æœ¬èº«çœ‹èµ·æ¥å®‰å…¨ï¼Œä½†å®ƒå¯èƒ½ä¾èµ–äºå…¶ä»–åº“æˆ–ç»„ä»¶ï¼Œè¿™äº›åº“æˆ–ç»„ä»¶å¯èƒ½å­˜åœ¨å®‰å…¨æ¼æ´ã€‚
3.  **ç¯å¢ƒå·®å¼‚ï¼š** PoC åœ¨ä¸åŒç¯å¢ƒä¸‹çš„è¡Œä¸ºå¯èƒ½æœ‰æ‰€ä¸åŒï¼ŒæŸäº›ç¯å¢ƒä¸‹å¯èƒ½ä¼šäº§ç”Ÿæ„æƒ³ä¸åˆ°çš„å‰¯ä½œç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ’ä»¶æ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®è®¤ç›®æ ‡ WordPress ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Better Search Replace æ’ä»¶ã€‚å¯ä»¥é€šè¿‡è®¿é—® `/wp-content/plugins/better-search-replace/README.txt` æ–‡ä»¶æ¥è·å–æ’ä»¶ç‰ˆæœ¬ä¿¡æ¯ã€‚
2.  **Payload æ„é€ ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªæ¶æ„çš„ PHP åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«ä¸€ä¸ª POP é“¾ï¼Œå¯ä»¥è§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚POP é“¾é€šå¸¸æ¶‰åŠå¤šä¸ªç±»çš„ç›¸äº’è°ƒç”¨ï¼Œæœ€ç»ˆæ‰§è¡Œæ¶æ„ä»£ç ã€‚
3.  **æ¼æ´è§¦å‘ï¼š** æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œå¹¶å°† `action` å‚æ•°è®¾ç½®ä¸º `search_replace_db`ï¼Œ`search_for` å‚æ•°è®¾ç½®ä¸ºæ„é€ çš„æ¶æ„åºåˆ—åŒ–å¯¹è±¡ã€‚å…¶ä»–å‚æ•°åŒ…æ‹¬ `replace_with`ï¼Œ `dry_run=1` å’Œ `select_tables[]`ã€‚
4.  **ä»£ç æ‰§è¡Œï¼š** å¦‚æœç›®æ ‡ç«™ç‚¹å­˜åœ¨å¯ç”¨çš„ POP é“¾ï¼Œå¹¶ä¸”åºåˆ—åŒ–å¯¹è±¡æˆåŠŸååºåˆ—åŒ–ï¼Œåˆ™ä¼šè§¦å‘ POP é“¾ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [Trex96/vulnerable-bsr-lab-CVE-2023-6933](https://github.com/Trex96/vulnerable-bsr-lab-CVE-2023-6933)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-6933](https://nvd.nist.gov/vuln/detail/CVE-2023-6933)

---

## POC #2

**æ¥æº**: [CVE-2023-6933-w2xim3_CVE-2023-6933.md](../2023/CVE-2023-6933-w2xim3_CVE-2023-6933.md)

# CVE-2023-6933

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md](../2023/CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md)

## CVE-2023-6933 - WordPress Better Search Replace Plugin PHP å¯¹è±¡æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-6933

**æ¼æ´ç±»å‹:** PHP å¯¹è±¡æ³¨å…¥

**å½±å“åº”ç”¨:** WordPress Better Search Replace Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 1.4.4

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Better Search Replaceæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯åˆ©ç”¨çš„POPé“¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-6933 å­˜åœ¨äº WordPress Better Search Replace æ’ä»¶ä¸­ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®è¿›è¡Œ PHP å¯¹è±¡æ³¨å…¥ã€‚æ¼æ´ä½äº`class-bsr-db.php`æ–‡ä»¶çš„`recursive_unserialize_replace()`å‡½æ•°ä¸­ï¼Œè¯¥å‡½æ•°ç›´æ¥å°†ç”¨æˆ·å¯æ§çš„`search_for`å‚æ•°ä¼ é€’ç»™ PHP çš„ `unserialize()` å‡½æ•°ï¼Œè€Œæ²¡æœ‰è¿›è¡Œé€‚å½“çš„éªŒè¯æˆ–æ¸…ç†ã€‚ ç”±äºè¯¥æ’ä»¶æœ¬èº«ä¸åŒ…å« POP é“¾ï¼Œå› æ­¤æ”»å‡»è€…éœ€è¦ä¾èµ–å…¶ä»–æ’ä»¶æˆ–ä¸»é¢˜ä¸­å­˜åœ¨çš„ POP é“¾æ‰èƒ½å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œåˆ©ç”¨ `search_replace_db` action è§¦å‘æ¼æ´ã€‚PoC ä½¿ç”¨ `dry_run=1` å‚æ•°ä»¥é¿å…æ•°æ®åº“ä¿®æ”¹ï¼Œå¹¶ä½¿ç”¨ `stdClass` å¯¹è±¡ä½œä¸º payloadï¼Œä»¥è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚ é€šè¿‡æ£€æŸ¥ HTTP çŠ¶æ€ä»£ç å’Œå“åº”å†…å®¹ï¼ŒPoC å¯ä»¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è¯¥ PoC æ—¨åœ¨è¿›è¡Œéä¾µå…¥å¼æµ‹è¯•ï¼Œå¹¶ä¸”åŒ…å«å®‰å…¨æªæ–½ï¼Œä¾‹å¦‚ `dry_run=1` å’Œä½¿ç”¨æ— å®³çš„ `stdClass` å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨ä¸€å®šé£é™©ã€‚è¿™é‡Œå‡è®¾æŠ•æ¯’é£é™©ä¸º1%, ä¸»è¦æ¥è‡ªäºä»¥ä¸‹è€ƒè™‘:

1.  **äººä¸ºé”™è¯¯ï¼š** ç”¨æˆ·åœ¨ä½¿ç”¨æˆ–ä¿®æ”¹PoCæ—¶ï¼Œå¯èƒ½ä¼šå¼•å…¥é”™è¯¯æˆ–æ¶æ„ä»£ç ã€‚
2.  **ä¾èµ–é¡¹é—®é¢˜ï¼š** è™½ç„¶ PoC æœ¬èº«çœ‹èµ·æ¥å®‰å…¨ï¼Œä½†å®ƒå¯èƒ½ä¾èµ–äºå…¶ä»–åº“æˆ–ç»„ä»¶ï¼Œè¿™äº›åº“æˆ–ç»„ä»¶å¯èƒ½å­˜åœ¨å®‰å…¨æ¼æ´ã€‚
3.  **ç¯å¢ƒå·®å¼‚ï¼š** PoC åœ¨ä¸åŒç¯å¢ƒä¸‹çš„è¡Œä¸ºå¯èƒ½æœ‰æ‰€ä¸åŒï¼ŒæŸäº›ç¯å¢ƒä¸‹å¯èƒ½ä¼šäº§ç”Ÿæ„æƒ³ä¸åˆ°çš„å‰¯ä½œç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ’ä»¶æ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®è®¤ç›®æ ‡ WordPress ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Better Search Replace æ’ä»¶ã€‚å¯ä»¥é€šè¿‡è®¿é—® `/wp-content/plugins/better-search-replace/README.txt` æ–‡ä»¶æ¥è·å–æ’ä»¶ç‰ˆæœ¬ä¿¡æ¯ã€‚
2.  **Payload æ„é€ ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªæ¶æ„çš„ PHP åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«ä¸€ä¸ª POP é“¾ï¼Œå¯ä»¥è§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚POP é“¾é€šå¸¸æ¶‰åŠå¤šä¸ªç±»çš„ç›¸äº’è°ƒç”¨ï¼Œæœ€ç»ˆæ‰§è¡Œæ¶æ„ä»£ç ã€‚
3.  **æ¼æ´è§¦å‘ï¼š** æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œå¹¶å°† `action` å‚æ•°è®¾ç½®ä¸º `search_replace_db`ï¼Œ`search_for` å‚æ•°è®¾ç½®ä¸ºæ„é€ çš„æ¶æ„åºåˆ—åŒ–å¯¹è±¡ã€‚å…¶ä»–å‚æ•°åŒ…æ‹¬ `replace_with`ï¼Œ `dry_run=1` å’Œ `select_tables[]`ã€‚
4.  **ä»£ç æ‰§è¡Œï¼š** å¦‚æœç›®æ ‡ç«™ç‚¹å­˜åœ¨å¯ç”¨çš„ POP é“¾ï¼Œå¹¶ä¸”åºåˆ—åŒ–å¯¹è±¡æˆåŠŸååºåˆ—åŒ–ï¼Œåˆ™ä¼šè§¦å‘ POP é“¾ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [Trex96/vulnerable-bsr-lab-CVE-2023-6933](https://github.com/Trex96/vulnerable-bsr-lab-CVE-2023-6933)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-6933](https://nvd.nist.gov/vuln/detail/CVE-2023-6933)

---

## POC #2

**æ¥æº**: [CVE-2023-6933-w2xim3_CVE-2023-6933.md](../2023/CVE-2023-6933-w2xim3_CVE-2023-6933.md)

# CVE-2023-6933

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md](../2023/CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md)

## CVE-2023-6933 - WordPress Better Search Replace Plugin PHP å¯¹è±¡æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-6933

**æ¼æ´ç±»å‹:** PHP å¯¹è±¡æ³¨å…¥

**å½±å“åº”ç”¨:** WordPress Better Search Replace Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 1.4.4

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Better Search Replaceæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯åˆ©ç”¨çš„POPé“¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-6933 å­˜åœ¨äº WordPress Better Search Replace æ’ä»¶ä¸­ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®è¿›è¡Œ PHP å¯¹è±¡æ³¨å…¥ã€‚æ¼æ´ä½äº`class-bsr-db.php`æ–‡ä»¶çš„`recursive_unserialize_replace()`å‡½æ•°ä¸­ï¼Œè¯¥å‡½æ•°ç›´æ¥å°†ç”¨æˆ·å¯æ§çš„`search_for`å‚æ•°ä¼ é€’ç»™ PHP çš„ `unserialize()` å‡½æ•°ï¼Œè€Œæ²¡æœ‰è¿›è¡Œé€‚å½“çš„éªŒè¯æˆ–æ¸…ç†ã€‚ ç”±äºè¯¥æ’ä»¶æœ¬èº«ä¸åŒ…å« POP é“¾ï¼Œå› æ­¤æ”»å‡»è€…éœ€è¦ä¾èµ–å…¶ä»–æ’ä»¶æˆ–ä¸»é¢˜ä¸­å­˜åœ¨çš„ POP é“¾æ‰èƒ½å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œåˆ©ç”¨ `search_replace_db` action è§¦å‘æ¼æ´ã€‚PoC ä½¿ç”¨ `dry_run=1` å‚æ•°ä»¥é¿å…æ•°æ®åº“ä¿®æ”¹ï¼Œå¹¶ä½¿ç”¨ `stdClass` å¯¹è±¡ä½œä¸º payloadï¼Œä»¥è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚ é€šè¿‡æ£€æŸ¥ HTTP çŠ¶æ€ä»£ç å’Œå“åº”å†…å®¹ï¼ŒPoC å¯ä»¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è¯¥ PoC æ—¨åœ¨è¿›è¡Œéä¾µå…¥å¼æµ‹è¯•ï¼Œå¹¶ä¸”åŒ…å«å®‰å…¨æªæ–½ï¼Œä¾‹å¦‚ `dry_run=1` å’Œä½¿ç”¨æ— å®³çš„ `stdClass` å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨ä¸€å®šé£é™©ã€‚è¿™é‡Œå‡è®¾æŠ•æ¯’é£é™©ä¸º1%, ä¸»è¦æ¥è‡ªäºä»¥ä¸‹è€ƒè™‘:

1.  **äººä¸ºé”™è¯¯ï¼š** ç”¨æˆ·åœ¨ä½¿ç”¨æˆ–ä¿®æ”¹PoCæ—¶ï¼Œå¯èƒ½ä¼šå¼•å…¥é”™è¯¯æˆ–æ¶æ„ä»£ç ã€‚
2.  **ä¾èµ–é¡¹é—®é¢˜ï¼š** è™½ç„¶ PoC æœ¬èº«çœ‹èµ·æ¥å®‰å…¨ï¼Œä½†å®ƒå¯èƒ½ä¾èµ–äºå…¶ä»–åº“æˆ–ç»„ä»¶ï¼Œè¿™äº›åº“æˆ–ç»„ä»¶å¯èƒ½å­˜åœ¨å®‰å…¨æ¼æ´ã€‚
3.  **ç¯å¢ƒå·®å¼‚ï¼š** PoC åœ¨ä¸åŒç¯å¢ƒä¸‹çš„è¡Œä¸ºå¯èƒ½æœ‰æ‰€ä¸åŒï¼ŒæŸäº›ç¯å¢ƒä¸‹å¯èƒ½ä¼šäº§ç”Ÿæ„æƒ³ä¸åˆ°çš„å‰¯ä½œç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ’ä»¶æ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®è®¤ç›®æ ‡ WordPress ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Better Search Replace æ’ä»¶ã€‚å¯ä»¥é€šè¿‡è®¿é—® `/wp-content/plugins/better-search-replace/README.txt` æ–‡ä»¶æ¥è·å–æ’ä»¶ç‰ˆæœ¬ä¿¡æ¯ã€‚
2.  **Payload æ„é€ ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªæ¶æ„çš„ PHP åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«ä¸€ä¸ª POP é“¾ï¼Œå¯ä»¥è§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚POP é“¾é€šå¸¸æ¶‰åŠå¤šä¸ªç±»çš„ç›¸äº’è°ƒç”¨ï¼Œæœ€ç»ˆæ‰§è¡Œæ¶æ„ä»£ç ã€‚
3.  **æ¼æ´è§¦å‘ï¼š** æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œå¹¶å°† `action` å‚æ•°è®¾ç½®ä¸º `search_replace_db`ï¼Œ`search_for` å‚æ•°è®¾ç½®ä¸ºæ„é€ çš„æ¶æ„åºåˆ—åŒ–å¯¹è±¡ã€‚å…¶ä»–å‚æ•°åŒ…æ‹¬ `replace_with`ï¼Œ `dry_run=1` å’Œ `select_tables[]`ã€‚
4.  **ä»£ç æ‰§è¡Œï¼š** å¦‚æœç›®æ ‡ç«™ç‚¹å­˜åœ¨å¯ç”¨çš„ POP é“¾ï¼Œå¹¶ä¸”åºåˆ—åŒ–å¯¹è±¡æˆåŠŸååºåˆ—åŒ–ï¼Œåˆ™ä¼šè§¦å‘ POP é“¾ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [Trex96/vulnerable-bsr-lab-CVE-2023-6933](https://github.com/Trex96/vulnerable-bsr-lab-CVE-2023-6933)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-6933](https://nvd.nist.gov/vuln/detail/CVE-2023-6933)

---

## POC #2

**æ¥æº**: [CVE-2023-6933-w2xim3_CVE-2023-6933.md](../2023/CVE-2023-6933-w2xim3_CVE-2023-6933.md)

# CVE-2023-6933

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md](../2023/CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md)

## CVE-2023-6933 - WordPress Better Search Replace Plugin PHP å¯¹è±¡æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-6933

**æ¼æ´ç±»å‹:** PHP å¯¹è±¡æ³¨å…¥

**å½±å“åº”ç”¨:** WordPress Better Search Replace Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 1.4.4

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Better Search Replaceæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯åˆ©ç”¨çš„POPé“¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-6933 å­˜åœ¨äº WordPress Better Search Replace æ’ä»¶ä¸­ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®è¿›è¡Œ PHP å¯¹è±¡æ³¨å…¥ã€‚æ¼æ´ä½äº`class-bsr-db.php`æ–‡ä»¶çš„`recursive_unserialize_replace()`å‡½æ•°ä¸­ï¼Œè¯¥å‡½æ•°ç›´æ¥å°†ç”¨æˆ·å¯æ§çš„`search_for`å‚æ•°ä¼ é€’ç»™ PHP çš„ `unserialize()` å‡½æ•°ï¼Œè€Œæ²¡æœ‰è¿›è¡Œé€‚å½“çš„éªŒè¯æˆ–æ¸…ç†ã€‚ ç”±äºè¯¥æ’ä»¶æœ¬èº«ä¸åŒ…å« POP é“¾ï¼Œå› æ­¤æ”»å‡»è€…éœ€è¦ä¾èµ–å…¶ä»–æ’ä»¶æˆ–ä¸»é¢˜ä¸­å­˜åœ¨çš„ POP é“¾æ‰èƒ½å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œåˆ©ç”¨ `search_replace_db` action è§¦å‘æ¼æ´ã€‚PoC ä½¿ç”¨ `dry_run=1` å‚æ•°ä»¥é¿å…æ•°æ®åº“ä¿®æ”¹ï¼Œå¹¶ä½¿ç”¨ `stdClass` å¯¹è±¡ä½œä¸º payloadï¼Œä»¥è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚ é€šè¿‡æ£€æŸ¥ HTTP çŠ¶æ€ä»£ç å’Œå“åº”å†…å®¹ï¼ŒPoC å¯ä»¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è¯¥ PoC æ—¨åœ¨è¿›è¡Œéä¾µå…¥å¼æµ‹è¯•ï¼Œå¹¶ä¸”åŒ…å«å®‰å…¨æªæ–½ï¼Œä¾‹å¦‚ `dry_run=1` å’Œä½¿ç”¨æ— å®³çš„ `stdClass` å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨ä¸€å®šé£é™©ã€‚è¿™é‡Œå‡è®¾æŠ•æ¯’é£é™©ä¸º1%, ä¸»è¦æ¥è‡ªäºä»¥ä¸‹è€ƒè™‘:

1.  **äººä¸ºé”™è¯¯ï¼š** ç”¨æˆ·åœ¨ä½¿ç”¨æˆ–ä¿®æ”¹PoCæ—¶ï¼Œå¯èƒ½ä¼šå¼•å…¥é”™è¯¯æˆ–æ¶æ„ä»£ç ã€‚
2.  **ä¾èµ–é¡¹é—®é¢˜ï¼š** è™½ç„¶ PoC æœ¬èº«çœ‹èµ·æ¥å®‰å…¨ï¼Œä½†å®ƒå¯èƒ½ä¾èµ–äºå…¶ä»–åº“æˆ–ç»„ä»¶ï¼Œè¿™äº›åº“æˆ–ç»„ä»¶å¯èƒ½å­˜åœ¨å®‰å…¨æ¼æ´ã€‚
3.  **ç¯å¢ƒå·®å¼‚ï¼š** PoC åœ¨ä¸åŒç¯å¢ƒä¸‹çš„è¡Œä¸ºå¯èƒ½æœ‰æ‰€ä¸åŒï¼ŒæŸäº›ç¯å¢ƒä¸‹å¯èƒ½ä¼šäº§ç”Ÿæ„æƒ³ä¸åˆ°çš„å‰¯ä½œç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ’ä»¶æ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®è®¤ç›®æ ‡ WordPress ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Better Search Replace æ’ä»¶ã€‚å¯ä»¥é€šè¿‡è®¿é—® `/wp-content/plugins/better-search-replace/README.txt` æ–‡ä»¶æ¥è·å–æ’ä»¶ç‰ˆæœ¬ä¿¡æ¯ã€‚
2.  **Payload æ„é€ ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªæ¶æ„çš„ PHP åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«ä¸€ä¸ª POP é“¾ï¼Œå¯ä»¥è§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚POP é“¾é€šå¸¸æ¶‰åŠå¤šä¸ªç±»çš„ç›¸äº’è°ƒç”¨ï¼Œæœ€ç»ˆæ‰§è¡Œæ¶æ„ä»£ç ã€‚
3.  **æ¼æ´è§¦å‘ï¼š** æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œå¹¶å°† `action` å‚æ•°è®¾ç½®ä¸º `search_replace_db`ï¼Œ`search_for` å‚æ•°è®¾ç½®ä¸ºæ„é€ çš„æ¶æ„åºåˆ—åŒ–å¯¹è±¡ã€‚å…¶ä»–å‚æ•°åŒ…æ‹¬ `replace_with`ï¼Œ `dry_run=1` å’Œ `select_tables[]`ã€‚
4.  **ä»£ç æ‰§è¡Œï¼š** å¦‚æœç›®æ ‡ç«™ç‚¹å­˜åœ¨å¯ç”¨çš„ POP é“¾ï¼Œå¹¶ä¸”åºåˆ—åŒ–å¯¹è±¡æˆåŠŸååºåˆ—åŒ–ï¼Œåˆ™ä¼šè§¦å‘ POP é“¾ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [Trex96/vulnerable-bsr-lab-CVE-2023-6933](https://github.com/Trex96/vulnerable-bsr-lab-CVE-2023-6933)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-6933](https://nvd.nist.gov/vuln/detail/CVE-2023-6933)

---

## POC #2

**æ¥æº**: [CVE-2023-6933-w2xim3_CVE-2023-6933.md](../2023/CVE-2023-6933-w2xim3_CVE-2023-6933.md)

# CVE-2023-6933

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md](../2023/CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md)

## CVE-2023-6933 - WordPress Better Search Replace Plugin PHP å¯¹è±¡æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-6933

**æ¼æ´ç±»å‹:** PHP å¯¹è±¡æ³¨å…¥

**å½±å“åº”ç”¨:** WordPress Better Search Replace Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 1.4.4

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Better Search Replaceæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯åˆ©ç”¨çš„POPé“¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-6933 å­˜åœ¨äº WordPress Better Search Replace æ’ä»¶ä¸­ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®è¿›è¡Œ PHP å¯¹è±¡æ³¨å…¥ã€‚æ¼æ´ä½äº`class-bsr-db.php`æ–‡ä»¶çš„`recursive_unserialize_replace()`å‡½æ•°ä¸­ï¼Œè¯¥å‡½æ•°ç›´æ¥å°†ç”¨æˆ·å¯æ§çš„`search_for`å‚æ•°ä¼ é€’ç»™ PHP çš„ `unserialize()` å‡½æ•°ï¼Œè€Œæ²¡æœ‰è¿›è¡Œé€‚å½“çš„éªŒè¯æˆ–æ¸…ç†ã€‚ ç”±äºè¯¥æ’ä»¶æœ¬èº«ä¸åŒ…å« POP é“¾ï¼Œå› æ­¤æ”»å‡»è€…éœ€è¦ä¾èµ–å…¶ä»–æ’ä»¶æˆ–ä¸»é¢˜ä¸­å­˜åœ¨çš„ POP é“¾æ‰èƒ½å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œåˆ©ç”¨ `search_replace_db` action è§¦å‘æ¼æ´ã€‚PoC ä½¿ç”¨ `dry_run=1` å‚æ•°ä»¥é¿å…æ•°æ®åº“ä¿®æ”¹ï¼Œå¹¶ä½¿ç”¨ `stdClass` å¯¹è±¡ä½œä¸º payloadï¼Œä»¥è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚ é€šè¿‡æ£€æŸ¥ HTTP çŠ¶æ€ä»£ç å’Œå“åº”å†…å®¹ï¼ŒPoC å¯ä»¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è¯¥ PoC æ—¨åœ¨è¿›è¡Œéä¾µå…¥å¼æµ‹è¯•ï¼Œå¹¶ä¸”åŒ…å«å®‰å…¨æªæ–½ï¼Œä¾‹å¦‚ `dry_run=1` å’Œä½¿ç”¨æ— å®³çš„ `stdClass` å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨ä¸€å®šé£é™©ã€‚è¿™é‡Œå‡è®¾æŠ•æ¯’é£é™©ä¸º1%, ä¸»è¦æ¥è‡ªäºä»¥ä¸‹è€ƒè™‘:

1.  **äººä¸ºé”™è¯¯ï¼š** ç”¨æˆ·åœ¨ä½¿ç”¨æˆ–ä¿®æ”¹PoCæ—¶ï¼Œå¯èƒ½ä¼šå¼•å…¥é”™è¯¯æˆ–æ¶æ„ä»£ç ã€‚
2.  **ä¾èµ–é¡¹é—®é¢˜ï¼š** è™½ç„¶ PoC æœ¬èº«çœ‹èµ·æ¥å®‰å…¨ï¼Œä½†å®ƒå¯èƒ½ä¾èµ–äºå…¶ä»–åº“æˆ–ç»„ä»¶ï¼Œè¿™äº›åº“æˆ–ç»„ä»¶å¯èƒ½å­˜åœ¨å®‰å…¨æ¼æ´ã€‚
3.  **ç¯å¢ƒå·®å¼‚ï¼š** PoC åœ¨ä¸åŒç¯å¢ƒä¸‹çš„è¡Œä¸ºå¯èƒ½æœ‰æ‰€ä¸åŒï¼ŒæŸäº›ç¯å¢ƒä¸‹å¯èƒ½ä¼šäº§ç”Ÿæ„æƒ³ä¸åˆ°çš„å‰¯ä½œç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ’ä»¶æ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®è®¤ç›®æ ‡ WordPress ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Better Search Replace æ’ä»¶ã€‚å¯ä»¥é€šè¿‡è®¿é—® `/wp-content/plugins/better-search-replace/README.txt` æ–‡ä»¶æ¥è·å–æ’ä»¶ç‰ˆæœ¬ä¿¡æ¯ã€‚
2.  **Payload æ„é€ ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªæ¶æ„çš„ PHP åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«ä¸€ä¸ª POP é“¾ï¼Œå¯ä»¥è§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚POP é“¾é€šå¸¸æ¶‰åŠå¤šä¸ªç±»çš„ç›¸äº’è°ƒç”¨ï¼Œæœ€ç»ˆæ‰§è¡Œæ¶æ„ä»£ç ã€‚
3.  **æ¼æ´è§¦å‘ï¼š** æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œå¹¶å°† `action` å‚æ•°è®¾ç½®ä¸º `search_replace_db`ï¼Œ`search_for` å‚æ•°è®¾ç½®ä¸ºæ„é€ çš„æ¶æ„åºåˆ—åŒ–å¯¹è±¡ã€‚å…¶ä»–å‚æ•°åŒ…æ‹¬ `replace_with`ï¼Œ `dry_run=1` å’Œ `select_tables[]`ã€‚
4.  **ä»£ç æ‰§è¡Œï¼š** å¦‚æœç›®æ ‡ç«™ç‚¹å­˜åœ¨å¯ç”¨çš„ POP é“¾ï¼Œå¹¶ä¸”åºåˆ—åŒ–å¯¹è±¡æˆåŠŸååºåˆ—åŒ–ï¼Œåˆ™ä¼šè§¦å‘ POP é“¾ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [Trex96/vulnerable-bsr-lab-CVE-2023-6933](https://github.com/Trex96/vulnerable-bsr-lab-CVE-2023-6933)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-6933](https://nvd.nist.gov/vuln/detail/CVE-2023-6933)

---

## POC #2

**æ¥æº**: [CVE-2023-6933-w2xim3_CVE-2023-6933.md](../2023/CVE-2023-6933-w2xim3_CVE-2023-6933.md)

# CVE-2023-6933

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md](../2023/CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md)

## CVE-2023-6933 - WordPress Better Search Replace Plugin PHP å¯¹è±¡æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-6933

**æ¼æ´ç±»å‹:** PHP å¯¹è±¡æ³¨å…¥

**å½±å“åº”ç”¨:** WordPress Better Search Replace Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 1.4.4

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Better Search Replaceæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯åˆ©ç”¨çš„POPé“¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-6933 å­˜åœ¨äº WordPress Better Search Replace æ’ä»¶ä¸­ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®è¿›è¡Œ PHP å¯¹è±¡æ³¨å…¥ã€‚æ¼æ´ä½äº`class-bsr-db.php`æ–‡ä»¶çš„`recursive_unserialize_replace()`å‡½æ•°ä¸­ï¼Œè¯¥å‡½æ•°ç›´æ¥å°†ç”¨æˆ·å¯æ§çš„`search_for`å‚æ•°ä¼ é€’ç»™ PHP çš„ `unserialize()` å‡½æ•°ï¼Œè€Œæ²¡æœ‰è¿›è¡Œé€‚å½“çš„éªŒè¯æˆ–æ¸…ç†ã€‚ ç”±äºè¯¥æ’ä»¶æœ¬èº«ä¸åŒ…å« POP é“¾ï¼Œå› æ­¤æ”»å‡»è€…éœ€è¦ä¾èµ–å…¶ä»–æ’ä»¶æˆ–ä¸»é¢˜ä¸­å­˜åœ¨çš„ POP é“¾æ‰èƒ½å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œåˆ©ç”¨ `search_replace_db` action è§¦å‘æ¼æ´ã€‚PoC ä½¿ç”¨ `dry_run=1` å‚æ•°ä»¥é¿å…æ•°æ®åº“ä¿®æ”¹ï¼Œå¹¶ä½¿ç”¨ `stdClass` å¯¹è±¡ä½œä¸º payloadï¼Œä»¥è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚ é€šè¿‡æ£€æŸ¥ HTTP çŠ¶æ€ä»£ç å’Œå“åº”å†…å®¹ï¼ŒPoC å¯ä»¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è¯¥ PoC æ—¨åœ¨è¿›è¡Œéä¾µå…¥å¼æµ‹è¯•ï¼Œå¹¶ä¸”åŒ…å«å®‰å…¨æªæ–½ï¼Œä¾‹å¦‚ `dry_run=1` å’Œä½¿ç”¨æ— å®³çš„ `stdClass` å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨ä¸€å®šé£é™©ã€‚è¿™é‡Œå‡è®¾æŠ•æ¯’é£é™©ä¸º1%, ä¸»è¦æ¥è‡ªäºä»¥ä¸‹è€ƒè™‘:

1.  **äººä¸ºé”™è¯¯ï¼š** ç”¨æˆ·åœ¨ä½¿ç”¨æˆ–ä¿®æ”¹PoCæ—¶ï¼Œå¯èƒ½ä¼šå¼•å…¥é”™è¯¯æˆ–æ¶æ„ä»£ç ã€‚
2.  **ä¾èµ–é¡¹é—®é¢˜ï¼š** è™½ç„¶ PoC æœ¬èº«çœ‹èµ·æ¥å®‰å…¨ï¼Œä½†å®ƒå¯èƒ½ä¾èµ–äºå…¶ä»–åº“æˆ–ç»„ä»¶ï¼Œè¿™äº›åº“æˆ–ç»„ä»¶å¯èƒ½å­˜åœ¨å®‰å…¨æ¼æ´ã€‚
3.  **ç¯å¢ƒå·®å¼‚ï¼š** PoC åœ¨ä¸åŒç¯å¢ƒä¸‹çš„è¡Œä¸ºå¯èƒ½æœ‰æ‰€ä¸åŒï¼ŒæŸäº›ç¯å¢ƒä¸‹å¯èƒ½ä¼šäº§ç”Ÿæ„æƒ³ä¸åˆ°çš„å‰¯ä½œç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ’ä»¶æ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®è®¤ç›®æ ‡ WordPress ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Better Search Replace æ’ä»¶ã€‚å¯ä»¥é€šè¿‡è®¿é—® `/wp-content/plugins/better-search-replace/README.txt` æ–‡ä»¶æ¥è·å–æ’ä»¶ç‰ˆæœ¬ä¿¡æ¯ã€‚
2.  **Payload æ„é€ ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªæ¶æ„çš„ PHP åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«ä¸€ä¸ª POP é“¾ï¼Œå¯ä»¥è§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚POP é“¾é€šå¸¸æ¶‰åŠå¤šä¸ªç±»çš„ç›¸äº’è°ƒç”¨ï¼Œæœ€ç»ˆæ‰§è¡Œæ¶æ„ä»£ç ã€‚
3.  **æ¼æ´è§¦å‘ï¼š** æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œå¹¶å°† `action` å‚æ•°è®¾ç½®ä¸º `search_replace_db`ï¼Œ`search_for` å‚æ•°è®¾ç½®ä¸ºæ„é€ çš„æ¶æ„åºåˆ—åŒ–å¯¹è±¡ã€‚å…¶ä»–å‚æ•°åŒ…æ‹¬ `replace_with`ï¼Œ `dry_run=1` å’Œ `select_tables[]`ã€‚
4.  **ä»£ç æ‰§è¡Œï¼š** å¦‚æœç›®æ ‡ç«™ç‚¹å­˜åœ¨å¯ç”¨çš„ POP é“¾ï¼Œå¹¶ä¸”åºåˆ—åŒ–å¯¹è±¡æˆåŠŸååºåˆ—åŒ–ï¼Œåˆ™ä¼šè§¦å‘ POP é“¾ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [Trex96/vulnerable-bsr-lab-CVE-2023-6933](https://github.com/Trex96/vulnerable-bsr-lab-CVE-2023-6933)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-6933](https://nvd.nist.gov/vuln/detail/CVE-2023-6933)

---

## POC #2

**æ¥æº**: [CVE-2023-6933-w2xim3_CVE-2023-6933.md](../2023/CVE-2023-6933-w2xim3_CVE-2023-6933.md)

# CVE-2023-6933

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md](../2023/CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md)

## CVE-2023-6933 - WordPress Better Search Replace Plugin PHP å¯¹è±¡æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-6933

**æ¼æ´ç±»å‹:** PHP å¯¹è±¡æ³¨å…¥

**å½±å“åº”ç”¨:** WordPress Better Search Replace Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 1.4.4

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Better Search Replaceæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯åˆ©ç”¨çš„POPé“¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-6933 å­˜åœ¨äº WordPress Better Search Replace æ’ä»¶ä¸­ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®è¿›è¡Œ PHP å¯¹è±¡æ³¨å…¥ã€‚æ¼æ´ä½äº`class-bsr-db.php`æ–‡ä»¶çš„`recursive_unserialize_replace()`å‡½æ•°ä¸­ï¼Œè¯¥å‡½æ•°ç›´æ¥å°†ç”¨æˆ·å¯æ§çš„`search_for`å‚æ•°ä¼ é€’ç»™ PHP çš„ `unserialize()` å‡½æ•°ï¼Œè€Œæ²¡æœ‰è¿›è¡Œé€‚å½“çš„éªŒè¯æˆ–æ¸…ç†ã€‚ ç”±äºè¯¥æ’ä»¶æœ¬èº«ä¸åŒ…å« POP é“¾ï¼Œå› æ­¤æ”»å‡»è€…éœ€è¦ä¾èµ–å…¶ä»–æ’ä»¶æˆ–ä¸»é¢˜ä¸­å­˜åœ¨çš„ POP é“¾æ‰èƒ½å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œåˆ©ç”¨ `search_replace_db` action è§¦å‘æ¼æ´ã€‚PoC ä½¿ç”¨ `dry_run=1` å‚æ•°ä»¥é¿å…æ•°æ®åº“ä¿®æ”¹ï¼Œå¹¶ä½¿ç”¨ `stdClass` å¯¹è±¡ä½œä¸º payloadï¼Œä»¥è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚ é€šè¿‡æ£€æŸ¥ HTTP çŠ¶æ€ä»£ç å’Œå“åº”å†…å®¹ï¼ŒPoC å¯ä»¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è¯¥ PoC æ—¨åœ¨è¿›è¡Œéä¾µå…¥å¼æµ‹è¯•ï¼Œå¹¶ä¸”åŒ…å«å®‰å…¨æªæ–½ï¼Œä¾‹å¦‚ `dry_run=1` å’Œä½¿ç”¨æ— å®³çš„ `stdClass` å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨ä¸€å®šé£é™©ã€‚è¿™é‡Œå‡è®¾æŠ•æ¯’é£é™©ä¸º1%, ä¸»è¦æ¥è‡ªäºä»¥ä¸‹è€ƒè™‘:

1.  **äººä¸ºé”™è¯¯ï¼š** ç”¨æˆ·åœ¨ä½¿ç”¨æˆ–ä¿®æ”¹PoCæ—¶ï¼Œå¯èƒ½ä¼šå¼•å…¥é”™è¯¯æˆ–æ¶æ„ä»£ç ã€‚
2.  **ä¾èµ–é¡¹é—®é¢˜ï¼š** è™½ç„¶ PoC æœ¬èº«çœ‹èµ·æ¥å®‰å…¨ï¼Œä½†å®ƒå¯èƒ½ä¾èµ–äºå…¶ä»–åº“æˆ–ç»„ä»¶ï¼Œè¿™äº›åº“æˆ–ç»„ä»¶å¯èƒ½å­˜åœ¨å®‰å…¨æ¼æ´ã€‚
3.  **ç¯å¢ƒå·®å¼‚ï¼š** PoC åœ¨ä¸åŒç¯å¢ƒä¸‹çš„è¡Œä¸ºå¯èƒ½æœ‰æ‰€ä¸åŒï¼ŒæŸäº›ç¯å¢ƒä¸‹å¯èƒ½ä¼šäº§ç”Ÿæ„æƒ³ä¸åˆ°çš„å‰¯ä½œç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ’ä»¶æ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®è®¤ç›®æ ‡ WordPress ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Better Search Replace æ’ä»¶ã€‚å¯ä»¥é€šè¿‡è®¿é—® `/wp-content/plugins/better-search-replace/README.txt` æ–‡ä»¶æ¥è·å–æ’ä»¶ç‰ˆæœ¬ä¿¡æ¯ã€‚
2.  **Payload æ„é€ ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªæ¶æ„çš„ PHP åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«ä¸€ä¸ª POP é“¾ï¼Œå¯ä»¥è§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚POP é“¾é€šå¸¸æ¶‰åŠå¤šä¸ªç±»çš„ç›¸äº’è°ƒç”¨ï¼Œæœ€ç»ˆæ‰§è¡Œæ¶æ„ä»£ç ã€‚
3.  **æ¼æ´è§¦å‘ï¼š** æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œå¹¶å°† `action` å‚æ•°è®¾ç½®ä¸º `search_replace_db`ï¼Œ`search_for` å‚æ•°è®¾ç½®ä¸ºæ„é€ çš„æ¶æ„åºåˆ—åŒ–å¯¹è±¡ã€‚å…¶ä»–å‚æ•°åŒ…æ‹¬ `replace_with`ï¼Œ `dry_run=1` å’Œ `select_tables[]`ã€‚
4.  **ä»£ç æ‰§è¡Œï¼š** å¦‚æœç›®æ ‡ç«™ç‚¹å­˜åœ¨å¯ç”¨çš„ POP é“¾ï¼Œå¹¶ä¸”åºåˆ—åŒ–å¯¹è±¡æˆåŠŸååºåˆ—åŒ–ï¼Œåˆ™ä¼šè§¦å‘ POP é“¾ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [Trex96/vulnerable-bsr-lab-CVE-2023-6933](https://github.com/Trex96/vulnerable-bsr-lab-CVE-2023-6933)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-6933](https://nvd.nist.gov/vuln/detail/CVE-2023-6933)

---

## POC #2

**æ¥æº**: [CVE-2023-6933-w2xim3_CVE-2023-6933.md](../2023/CVE-2023-6933-w2xim3_CVE-2023-6933.md)

# CVE-2023-6933

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md](../2023/CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md)

## CVE-2023-6933 - WordPress Better Search Replace Plugin PHP å¯¹è±¡æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-6933

**æ¼æ´ç±»å‹:** PHP å¯¹è±¡æ³¨å…¥

**å½±å“åº”ç”¨:** WordPress Better Search Replace Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 1.4.4

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Better Search Replaceæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯åˆ©ç”¨çš„POPé“¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-6933 å­˜åœ¨äº WordPress Better Search Replace æ’ä»¶ä¸­ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®è¿›è¡Œ PHP å¯¹è±¡æ³¨å…¥ã€‚æ¼æ´ä½äº`class-bsr-db.php`æ–‡ä»¶çš„`recursive_unserialize_replace()`å‡½æ•°ä¸­ï¼Œè¯¥å‡½æ•°ç›´æ¥å°†ç”¨æˆ·å¯æ§çš„`search_for`å‚æ•°ä¼ é€’ç»™ PHP çš„ `unserialize()` å‡½æ•°ï¼Œè€Œæ²¡æœ‰è¿›è¡Œé€‚å½“çš„éªŒè¯æˆ–æ¸…ç†ã€‚ ç”±äºè¯¥æ’ä»¶æœ¬èº«ä¸åŒ…å« POP é“¾ï¼Œå› æ­¤æ”»å‡»è€…éœ€è¦ä¾èµ–å…¶ä»–æ’ä»¶æˆ–ä¸»é¢˜ä¸­å­˜åœ¨çš„ POP é“¾æ‰èƒ½å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œåˆ©ç”¨ `search_replace_db` action è§¦å‘æ¼æ´ã€‚PoC ä½¿ç”¨ `dry_run=1` å‚æ•°ä»¥é¿å…æ•°æ®åº“ä¿®æ”¹ï¼Œå¹¶ä½¿ç”¨ `stdClass` å¯¹è±¡ä½œä¸º payloadï¼Œä»¥è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚ é€šè¿‡æ£€æŸ¥ HTTP çŠ¶æ€ä»£ç å’Œå“åº”å†…å®¹ï¼ŒPoC å¯ä»¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è¯¥ PoC æ—¨åœ¨è¿›è¡Œéä¾µå…¥å¼æµ‹è¯•ï¼Œå¹¶ä¸”åŒ…å«å®‰å…¨æªæ–½ï¼Œä¾‹å¦‚ `dry_run=1` å’Œä½¿ç”¨æ— å®³çš„ `stdClass` å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨ä¸€å®šé£é™©ã€‚è¿™é‡Œå‡è®¾æŠ•æ¯’é£é™©ä¸º1%, ä¸»è¦æ¥è‡ªäºä»¥ä¸‹è€ƒè™‘:

1.  **äººä¸ºé”™è¯¯ï¼š** ç”¨æˆ·åœ¨ä½¿ç”¨æˆ–ä¿®æ”¹PoCæ—¶ï¼Œå¯èƒ½ä¼šå¼•å…¥é”™è¯¯æˆ–æ¶æ„ä»£ç ã€‚
2.  **ä¾èµ–é¡¹é—®é¢˜ï¼š** è™½ç„¶ PoC æœ¬èº«çœ‹èµ·æ¥å®‰å…¨ï¼Œä½†å®ƒå¯èƒ½ä¾èµ–äºå…¶ä»–åº“æˆ–ç»„ä»¶ï¼Œè¿™äº›åº“æˆ–ç»„ä»¶å¯èƒ½å­˜åœ¨å®‰å…¨æ¼æ´ã€‚
3.  **ç¯å¢ƒå·®å¼‚ï¼š** PoC åœ¨ä¸åŒç¯å¢ƒä¸‹çš„è¡Œä¸ºå¯èƒ½æœ‰æ‰€ä¸åŒï¼ŒæŸäº›ç¯å¢ƒä¸‹å¯èƒ½ä¼šäº§ç”Ÿæ„æƒ³ä¸åˆ°çš„å‰¯ä½œç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ’ä»¶æ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®è®¤ç›®æ ‡ WordPress ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Better Search Replace æ’ä»¶ã€‚å¯ä»¥é€šè¿‡è®¿é—® `/wp-content/plugins/better-search-replace/README.txt` æ–‡ä»¶æ¥è·å–æ’ä»¶ç‰ˆæœ¬ä¿¡æ¯ã€‚
2.  **Payload æ„é€ ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªæ¶æ„çš„ PHP åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«ä¸€ä¸ª POP é“¾ï¼Œå¯ä»¥è§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚POP é“¾é€šå¸¸æ¶‰åŠå¤šä¸ªç±»çš„ç›¸äº’è°ƒç”¨ï¼Œæœ€ç»ˆæ‰§è¡Œæ¶æ„ä»£ç ã€‚
3.  **æ¼æ´è§¦å‘ï¼š** æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œå¹¶å°† `action` å‚æ•°è®¾ç½®ä¸º `search_replace_db`ï¼Œ`search_for` å‚æ•°è®¾ç½®ä¸ºæ„é€ çš„æ¶æ„åºåˆ—åŒ–å¯¹è±¡ã€‚å…¶ä»–å‚æ•°åŒ…æ‹¬ `replace_with`ï¼Œ `dry_run=1` å’Œ `select_tables[]`ã€‚
4.  **ä»£ç æ‰§è¡Œï¼š** å¦‚æœç›®æ ‡ç«™ç‚¹å­˜åœ¨å¯ç”¨çš„ POP é“¾ï¼Œå¹¶ä¸”åºåˆ—åŒ–å¯¹è±¡æˆåŠŸååºåˆ—åŒ–ï¼Œåˆ™ä¼šè§¦å‘ POP é“¾ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [Trex96/vulnerable-bsr-lab-CVE-2023-6933](https://github.com/Trex96/vulnerable-bsr-lab-CVE-2023-6933)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-6933](https://nvd.nist.gov/vuln/detail/CVE-2023-6933)

---

## POC #2

**æ¥æº**: [CVE-2023-6933-w2xim3_CVE-2023-6933.md](../2023/CVE-2023-6933-w2xim3_CVE-2023-6933.md)

# CVE-2023-6933

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md](../2023/CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md)

## CVE-2023-6933 - WordPress Better Search Replace Plugin PHP å¯¹è±¡æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-6933

**æ¼æ´ç±»å‹:** PHP å¯¹è±¡æ³¨å…¥

**å½±å“åº”ç”¨:** WordPress Better Search Replace Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 1.4.4

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Better Search Replaceæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯åˆ©ç”¨çš„POPé“¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-6933 å­˜åœ¨äº WordPress Better Search Replace æ’ä»¶ä¸­ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®è¿›è¡Œ PHP å¯¹è±¡æ³¨å…¥ã€‚æ¼æ´ä½äº`class-bsr-db.php`æ–‡ä»¶çš„`recursive_unserialize_replace()`å‡½æ•°ä¸­ï¼Œè¯¥å‡½æ•°ç›´æ¥å°†ç”¨æˆ·å¯æ§çš„`search_for`å‚æ•°ä¼ é€’ç»™ PHP çš„ `unserialize()` å‡½æ•°ï¼Œè€Œæ²¡æœ‰è¿›è¡Œé€‚å½“çš„éªŒè¯æˆ–æ¸…ç†ã€‚ ç”±äºè¯¥æ’ä»¶æœ¬èº«ä¸åŒ…å« POP é“¾ï¼Œå› æ­¤æ”»å‡»è€…éœ€è¦ä¾èµ–å…¶ä»–æ’ä»¶æˆ–ä¸»é¢˜ä¸­å­˜åœ¨çš„ POP é“¾æ‰èƒ½å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œåˆ©ç”¨ `search_replace_db` action è§¦å‘æ¼æ´ã€‚PoC ä½¿ç”¨ `dry_run=1` å‚æ•°ä»¥é¿å…æ•°æ®åº“ä¿®æ”¹ï¼Œå¹¶ä½¿ç”¨ `stdClass` å¯¹è±¡ä½œä¸º payloadï¼Œä»¥è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚ é€šè¿‡æ£€æŸ¥ HTTP çŠ¶æ€ä»£ç å’Œå“åº”å†…å®¹ï¼ŒPoC å¯ä»¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è¯¥ PoC æ—¨åœ¨è¿›è¡Œéä¾µå…¥å¼æµ‹è¯•ï¼Œå¹¶ä¸”åŒ…å«å®‰å…¨æªæ–½ï¼Œä¾‹å¦‚ `dry_run=1` å’Œä½¿ç”¨æ— å®³çš„ `stdClass` å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨ä¸€å®šé£é™©ã€‚è¿™é‡Œå‡è®¾æŠ•æ¯’é£é™©ä¸º1%, ä¸»è¦æ¥è‡ªäºä»¥ä¸‹è€ƒè™‘:

1.  **äººä¸ºé”™è¯¯ï¼š** ç”¨æˆ·åœ¨ä½¿ç”¨æˆ–ä¿®æ”¹PoCæ—¶ï¼Œå¯èƒ½ä¼šå¼•å…¥é”™è¯¯æˆ–æ¶æ„ä»£ç ã€‚
2.  **ä¾èµ–é¡¹é—®é¢˜ï¼š** è™½ç„¶ PoC æœ¬èº«çœ‹èµ·æ¥å®‰å…¨ï¼Œä½†å®ƒå¯èƒ½ä¾èµ–äºå…¶ä»–åº“æˆ–ç»„ä»¶ï¼Œè¿™äº›åº“æˆ–ç»„ä»¶å¯èƒ½å­˜åœ¨å®‰å…¨æ¼æ´ã€‚
3.  **ç¯å¢ƒå·®å¼‚ï¼š** PoC åœ¨ä¸åŒç¯å¢ƒä¸‹çš„è¡Œä¸ºå¯èƒ½æœ‰æ‰€ä¸åŒï¼ŒæŸäº›ç¯å¢ƒä¸‹å¯èƒ½ä¼šäº§ç”Ÿæ„æƒ³ä¸åˆ°çš„å‰¯ä½œç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ’ä»¶æ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®è®¤ç›®æ ‡ WordPress ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Better Search Replace æ’ä»¶ã€‚å¯ä»¥é€šè¿‡è®¿é—® `/wp-content/plugins/better-search-replace/README.txt` æ–‡ä»¶æ¥è·å–æ’ä»¶ç‰ˆæœ¬ä¿¡æ¯ã€‚
2.  **Payload æ„é€ ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªæ¶æ„çš„ PHP åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«ä¸€ä¸ª POP é“¾ï¼Œå¯ä»¥è§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚POP é“¾é€šå¸¸æ¶‰åŠå¤šä¸ªç±»çš„ç›¸äº’è°ƒç”¨ï¼Œæœ€ç»ˆæ‰§è¡Œæ¶æ„ä»£ç ã€‚
3.  **æ¼æ´è§¦å‘ï¼š** æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œå¹¶å°† `action` å‚æ•°è®¾ç½®ä¸º `search_replace_db`ï¼Œ`search_for` å‚æ•°è®¾ç½®ä¸ºæ„é€ çš„æ¶æ„åºåˆ—åŒ–å¯¹è±¡ã€‚å…¶ä»–å‚æ•°åŒ…æ‹¬ `replace_with`ï¼Œ `dry_run=1` å’Œ `select_tables[]`ã€‚
4.  **ä»£ç æ‰§è¡Œï¼š** å¦‚æœç›®æ ‡ç«™ç‚¹å­˜åœ¨å¯ç”¨çš„ POP é“¾ï¼Œå¹¶ä¸”åºåˆ—åŒ–å¯¹è±¡æˆåŠŸååºåˆ—åŒ–ï¼Œåˆ™ä¼šè§¦å‘ POP é“¾ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [Trex96/vulnerable-bsr-lab-CVE-2023-6933](https://github.com/Trex96/vulnerable-bsr-lab-CVE-2023-6933)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-6933](https://nvd.nist.gov/vuln/detail/CVE-2023-6933)

---

## POC #2

**æ¥æº**: [CVE-2023-6933-w2xim3_CVE-2023-6933.md](../2023/CVE-2023-6933-w2xim3_CVE-2023-6933.md)

# CVE-2023-6933

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md](../2023/CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md)

## CVE-2023-6933 - WordPress Better Search Replace Plugin PHP å¯¹è±¡æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-6933

**æ¼æ´ç±»å‹:** PHP å¯¹è±¡æ³¨å…¥

**å½±å“åº”ç”¨:** WordPress Better Search Replace Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 1.4.4

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Better Search Replaceæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯åˆ©ç”¨çš„POPé“¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-6933 å­˜åœ¨äº WordPress Better Search Replace æ’ä»¶ä¸­ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®è¿›è¡Œ PHP å¯¹è±¡æ³¨å…¥ã€‚æ¼æ´ä½äº`class-bsr-db.php`æ–‡ä»¶çš„`recursive_unserialize_replace()`å‡½æ•°ä¸­ï¼Œè¯¥å‡½æ•°ç›´æ¥å°†ç”¨æˆ·å¯æ§çš„`search_for`å‚æ•°ä¼ é€’ç»™ PHP çš„ `unserialize()` å‡½æ•°ï¼Œè€Œæ²¡æœ‰è¿›è¡Œé€‚å½“çš„éªŒè¯æˆ–æ¸…ç†ã€‚ ç”±äºè¯¥æ’ä»¶æœ¬èº«ä¸åŒ…å« POP é“¾ï¼Œå› æ­¤æ”»å‡»è€…éœ€è¦ä¾èµ–å…¶ä»–æ’ä»¶æˆ–ä¸»é¢˜ä¸­å­˜åœ¨çš„ POP é“¾æ‰èƒ½å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œåˆ©ç”¨ `search_replace_db` action è§¦å‘æ¼æ´ã€‚PoC ä½¿ç”¨ `dry_run=1` å‚æ•°ä»¥é¿å…æ•°æ®åº“ä¿®æ”¹ï¼Œå¹¶ä½¿ç”¨ `stdClass` å¯¹è±¡ä½œä¸º payloadï¼Œä»¥è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚ é€šè¿‡æ£€æŸ¥ HTTP çŠ¶æ€ä»£ç å’Œå“åº”å†…å®¹ï¼ŒPoC å¯ä»¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è¯¥ PoC æ—¨åœ¨è¿›è¡Œéä¾µå…¥å¼æµ‹è¯•ï¼Œå¹¶ä¸”åŒ…å«å®‰å…¨æªæ–½ï¼Œä¾‹å¦‚ `dry_run=1` å’Œä½¿ç”¨æ— å®³çš„ `stdClass` å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨ä¸€å®šé£é™©ã€‚è¿™é‡Œå‡è®¾æŠ•æ¯’é£é™©ä¸º1%, ä¸»è¦æ¥è‡ªäºä»¥ä¸‹è€ƒè™‘:

1.  **äººä¸ºé”™è¯¯ï¼š** ç”¨æˆ·åœ¨ä½¿ç”¨æˆ–ä¿®æ”¹PoCæ—¶ï¼Œå¯èƒ½ä¼šå¼•å…¥é”™è¯¯æˆ–æ¶æ„ä»£ç ã€‚
2.  **ä¾èµ–é¡¹é—®é¢˜ï¼š** è™½ç„¶ PoC æœ¬èº«çœ‹èµ·æ¥å®‰å…¨ï¼Œä½†å®ƒå¯èƒ½ä¾èµ–äºå…¶ä»–åº“æˆ–ç»„ä»¶ï¼Œè¿™äº›åº“æˆ–ç»„ä»¶å¯èƒ½å­˜åœ¨å®‰å…¨æ¼æ´ã€‚
3.  **ç¯å¢ƒå·®å¼‚ï¼š** PoC åœ¨ä¸åŒç¯å¢ƒä¸‹çš„è¡Œä¸ºå¯èƒ½æœ‰æ‰€ä¸åŒï¼ŒæŸäº›ç¯å¢ƒä¸‹å¯èƒ½ä¼šäº§ç”Ÿæ„æƒ³ä¸åˆ°çš„å‰¯ä½œç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ’ä»¶æ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®è®¤ç›®æ ‡ WordPress ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Better Search Replace æ’ä»¶ã€‚å¯ä»¥é€šè¿‡è®¿é—® `/wp-content/plugins/better-search-replace/README.txt` æ–‡ä»¶æ¥è·å–æ’ä»¶ç‰ˆæœ¬ä¿¡æ¯ã€‚
2.  **Payload æ„é€ ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªæ¶æ„çš„ PHP åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«ä¸€ä¸ª POP é“¾ï¼Œå¯ä»¥è§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚POP é“¾é€šå¸¸æ¶‰åŠå¤šä¸ªç±»çš„ç›¸äº’è°ƒç”¨ï¼Œæœ€ç»ˆæ‰§è¡Œæ¶æ„ä»£ç ã€‚
3.  **æ¼æ´è§¦å‘ï¼š** æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œå¹¶å°† `action` å‚æ•°è®¾ç½®ä¸º `search_replace_db`ï¼Œ`search_for` å‚æ•°è®¾ç½®ä¸ºæ„é€ çš„æ¶æ„åºåˆ—åŒ–å¯¹è±¡ã€‚å…¶ä»–å‚æ•°åŒ…æ‹¬ `replace_with`ï¼Œ `dry_run=1` å’Œ `select_tables[]`ã€‚
4.  **ä»£ç æ‰§è¡Œï¼š** å¦‚æœç›®æ ‡ç«™ç‚¹å­˜åœ¨å¯ç”¨çš„ POP é“¾ï¼Œå¹¶ä¸”åºåˆ—åŒ–å¯¹è±¡æˆåŠŸååºåˆ—åŒ–ï¼Œåˆ™ä¼šè§¦å‘ POP é“¾ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [Trex96/vulnerable-bsr-lab-CVE-2023-6933](https://github.com/Trex96/vulnerable-bsr-lab-CVE-2023-6933)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-6933](https://nvd.nist.gov/vuln/detail/CVE-2023-6933)

---

## POC #2

**æ¥æº**: [CVE-2023-6933-w2xim3_CVE-2023-6933.md](../2023/CVE-2023-6933-w2xim3_CVE-2023-6933.md)

# CVE-2023-6933

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md](../2023/CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md)

## CVE-2023-6933 - WordPress Better Search Replace Plugin PHP å¯¹è±¡æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-6933

**æ¼æ´ç±»å‹:** PHP å¯¹è±¡æ³¨å…¥

**å½±å“åº”ç”¨:** WordPress Better Search Replace Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 1.4.4

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Better Search Replaceæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯åˆ©ç”¨çš„POPé“¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-6933 å­˜åœ¨äº WordPress Better Search Replace æ’ä»¶ä¸­ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®è¿›è¡Œ PHP å¯¹è±¡æ³¨å…¥ã€‚æ¼æ´ä½äº`class-bsr-db.php`æ–‡ä»¶çš„`recursive_unserialize_replace()`å‡½æ•°ä¸­ï¼Œè¯¥å‡½æ•°ç›´æ¥å°†ç”¨æˆ·å¯æ§çš„`search_for`å‚æ•°ä¼ é€’ç»™ PHP çš„ `unserialize()` å‡½æ•°ï¼Œè€Œæ²¡æœ‰è¿›è¡Œé€‚å½“çš„éªŒè¯æˆ–æ¸…ç†ã€‚ ç”±äºè¯¥æ’ä»¶æœ¬èº«ä¸åŒ…å« POP é“¾ï¼Œå› æ­¤æ”»å‡»è€…éœ€è¦ä¾èµ–å…¶ä»–æ’ä»¶æˆ–ä¸»é¢˜ä¸­å­˜åœ¨çš„ POP é“¾æ‰èƒ½å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œåˆ©ç”¨ `search_replace_db` action è§¦å‘æ¼æ´ã€‚PoC ä½¿ç”¨ `dry_run=1` å‚æ•°ä»¥é¿å…æ•°æ®åº“ä¿®æ”¹ï¼Œå¹¶ä½¿ç”¨ `stdClass` å¯¹è±¡ä½œä¸º payloadï¼Œä»¥è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚ é€šè¿‡æ£€æŸ¥ HTTP çŠ¶æ€ä»£ç å’Œå“åº”å†…å®¹ï¼ŒPoC å¯ä»¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è¯¥ PoC æ—¨åœ¨è¿›è¡Œéä¾µå…¥å¼æµ‹è¯•ï¼Œå¹¶ä¸”åŒ…å«å®‰å…¨æªæ–½ï¼Œä¾‹å¦‚ `dry_run=1` å’Œä½¿ç”¨æ— å®³çš„ `stdClass` å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨ä¸€å®šé£é™©ã€‚è¿™é‡Œå‡è®¾æŠ•æ¯’é£é™©ä¸º1%, ä¸»è¦æ¥è‡ªäºä»¥ä¸‹è€ƒè™‘:

1.  **äººä¸ºé”™è¯¯ï¼š** ç”¨æˆ·åœ¨ä½¿ç”¨æˆ–ä¿®æ”¹PoCæ—¶ï¼Œå¯èƒ½ä¼šå¼•å…¥é”™è¯¯æˆ–æ¶æ„ä»£ç ã€‚
2.  **ä¾èµ–é¡¹é—®é¢˜ï¼š** è™½ç„¶ PoC æœ¬èº«çœ‹èµ·æ¥å®‰å…¨ï¼Œä½†å®ƒå¯èƒ½ä¾èµ–äºå…¶ä»–åº“æˆ–ç»„ä»¶ï¼Œè¿™äº›åº“æˆ–ç»„ä»¶å¯èƒ½å­˜åœ¨å®‰å…¨æ¼æ´ã€‚
3.  **ç¯å¢ƒå·®å¼‚ï¼š** PoC åœ¨ä¸åŒç¯å¢ƒä¸‹çš„è¡Œä¸ºå¯èƒ½æœ‰æ‰€ä¸åŒï¼ŒæŸäº›ç¯å¢ƒä¸‹å¯èƒ½ä¼šäº§ç”Ÿæ„æƒ³ä¸åˆ°çš„å‰¯ä½œç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ’ä»¶æ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®è®¤ç›®æ ‡ WordPress ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Better Search Replace æ’ä»¶ã€‚å¯ä»¥é€šè¿‡è®¿é—® `/wp-content/plugins/better-search-replace/README.txt` æ–‡ä»¶æ¥è·å–æ’ä»¶ç‰ˆæœ¬ä¿¡æ¯ã€‚
2.  **Payload æ„é€ ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªæ¶æ„çš„ PHP åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«ä¸€ä¸ª POP é“¾ï¼Œå¯ä»¥è§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚POP é“¾é€šå¸¸æ¶‰åŠå¤šä¸ªç±»çš„ç›¸äº’è°ƒç”¨ï¼Œæœ€ç»ˆæ‰§è¡Œæ¶æ„ä»£ç ã€‚
3.  **æ¼æ´è§¦å‘ï¼š** æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œå¹¶å°† `action` å‚æ•°è®¾ç½®ä¸º `search_replace_db`ï¼Œ`search_for` å‚æ•°è®¾ç½®ä¸ºæ„é€ çš„æ¶æ„åºåˆ—åŒ–å¯¹è±¡ã€‚å…¶ä»–å‚æ•°åŒ…æ‹¬ `replace_with`ï¼Œ `dry_run=1` å’Œ `select_tables[]`ã€‚
4.  **ä»£ç æ‰§è¡Œï¼š** å¦‚æœç›®æ ‡ç«™ç‚¹å­˜åœ¨å¯ç”¨çš„ POP é“¾ï¼Œå¹¶ä¸”åºåˆ—åŒ–å¯¹è±¡æˆåŠŸååºåˆ—åŒ–ï¼Œåˆ™ä¼šè§¦å‘ POP é“¾ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [Trex96/vulnerable-bsr-lab-CVE-2023-6933](https://github.com/Trex96/vulnerable-bsr-lab-CVE-2023-6933)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-6933](https://nvd.nist.gov/vuln/detail/CVE-2023-6933)

---

## POC #2

**æ¥æº**: [CVE-2023-6933-w2xim3_CVE-2023-6933.md](../2023/CVE-2023-6933-w2xim3_CVE-2023-6933.md)

# CVE-2023-6933

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md](../2023/CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md)

## CVE-2023-6933 - WordPress Better Search Replace Plugin PHP å¯¹è±¡æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-6933

**æ¼æ´ç±»å‹:** PHP å¯¹è±¡æ³¨å…¥

**å½±å“åº”ç”¨:** WordPress Better Search Replace Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 1.4.4

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Better Search Replaceæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯åˆ©ç”¨çš„POPé“¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-6933 å­˜åœ¨äº WordPress Better Search Replace æ’ä»¶ä¸­ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®è¿›è¡Œ PHP å¯¹è±¡æ³¨å…¥ã€‚æ¼æ´ä½äº`class-bsr-db.php`æ–‡ä»¶çš„`recursive_unserialize_replace()`å‡½æ•°ä¸­ï¼Œè¯¥å‡½æ•°ç›´æ¥å°†ç”¨æˆ·å¯æ§çš„`search_for`å‚æ•°ä¼ é€’ç»™ PHP çš„ `unserialize()` å‡½æ•°ï¼Œè€Œæ²¡æœ‰è¿›è¡Œé€‚å½“çš„éªŒè¯æˆ–æ¸…ç†ã€‚ ç”±äºè¯¥æ’ä»¶æœ¬èº«ä¸åŒ…å« POP é“¾ï¼Œå› æ­¤æ”»å‡»è€…éœ€è¦ä¾èµ–å…¶ä»–æ’ä»¶æˆ–ä¸»é¢˜ä¸­å­˜åœ¨çš„ POP é“¾æ‰èƒ½å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œåˆ©ç”¨ `search_replace_db` action è§¦å‘æ¼æ´ã€‚PoC ä½¿ç”¨ `dry_run=1` å‚æ•°ä»¥é¿å…æ•°æ®åº“ä¿®æ”¹ï¼Œå¹¶ä½¿ç”¨ `stdClass` å¯¹è±¡ä½œä¸º payloadï¼Œä»¥è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚ é€šè¿‡æ£€æŸ¥ HTTP çŠ¶æ€ä»£ç å’Œå“åº”å†…å®¹ï¼ŒPoC å¯ä»¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è¯¥ PoC æ—¨åœ¨è¿›è¡Œéä¾µå…¥å¼æµ‹è¯•ï¼Œå¹¶ä¸”åŒ…å«å®‰å…¨æªæ–½ï¼Œä¾‹å¦‚ `dry_run=1` å’Œä½¿ç”¨æ— å®³çš„ `stdClass` å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨ä¸€å®šé£é™©ã€‚è¿™é‡Œå‡è®¾æŠ•æ¯’é£é™©ä¸º1%, ä¸»è¦æ¥è‡ªäºä»¥ä¸‹è€ƒè™‘:

1.  **äººä¸ºé”™è¯¯ï¼š** ç”¨æˆ·åœ¨ä½¿ç”¨æˆ–ä¿®æ”¹PoCæ—¶ï¼Œå¯èƒ½ä¼šå¼•å…¥é”™è¯¯æˆ–æ¶æ„ä»£ç ã€‚
2.  **ä¾èµ–é¡¹é—®é¢˜ï¼š** è™½ç„¶ PoC æœ¬èº«çœ‹èµ·æ¥å®‰å…¨ï¼Œä½†å®ƒå¯èƒ½ä¾èµ–äºå…¶ä»–åº“æˆ–ç»„ä»¶ï¼Œè¿™äº›åº“æˆ–ç»„ä»¶å¯èƒ½å­˜åœ¨å®‰å…¨æ¼æ´ã€‚
3.  **ç¯å¢ƒå·®å¼‚ï¼š** PoC åœ¨ä¸åŒç¯å¢ƒä¸‹çš„è¡Œä¸ºå¯èƒ½æœ‰æ‰€ä¸åŒï¼ŒæŸäº›ç¯å¢ƒä¸‹å¯èƒ½ä¼šäº§ç”Ÿæ„æƒ³ä¸åˆ°çš„å‰¯ä½œç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ’ä»¶æ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®è®¤ç›®æ ‡ WordPress ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Better Search Replace æ’ä»¶ã€‚å¯ä»¥é€šè¿‡è®¿é—® `/wp-content/plugins/better-search-replace/README.txt` æ–‡ä»¶æ¥è·å–æ’ä»¶ç‰ˆæœ¬ä¿¡æ¯ã€‚
2.  **Payload æ„é€ ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªæ¶æ„çš„ PHP åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«ä¸€ä¸ª POP é“¾ï¼Œå¯ä»¥è§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚POP é“¾é€šå¸¸æ¶‰åŠå¤šä¸ªç±»çš„ç›¸äº’è°ƒç”¨ï¼Œæœ€ç»ˆæ‰§è¡Œæ¶æ„ä»£ç ã€‚
3.  **æ¼æ´è§¦å‘ï¼š** æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œå¹¶å°† `action` å‚æ•°è®¾ç½®ä¸º `search_replace_db`ï¼Œ`search_for` å‚æ•°è®¾ç½®ä¸ºæ„é€ çš„æ¶æ„åºåˆ—åŒ–å¯¹è±¡ã€‚å…¶ä»–å‚æ•°åŒ…æ‹¬ `replace_with`ï¼Œ `dry_run=1` å’Œ `select_tables[]`ã€‚
4.  **ä»£ç æ‰§è¡Œï¼š** å¦‚æœç›®æ ‡ç«™ç‚¹å­˜åœ¨å¯ç”¨çš„ POP é“¾ï¼Œå¹¶ä¸”åºåˆ—åŒ–å¯¹è±¡æˆåŠŸååºåˆ—åŒ–ï¼Œåˆ™ä¼šè§¦å‘ POP é“¾ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [Trex96/vulnerable-bsr-lab-CVE-2023-6933](https://github.com/Trex96/vulnerable-bsr-lab-CVE-2023-6933)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-6933](https://nvd.nist.gov/vuln/detail/CVE-2023-6933)

---

## POC #2

**æ¥æº**: [CVE-2023-6933-w2xim3_CVE-2023-6933.md](../2023/CVE-2023-6933-w2xim3_CVE-2023-6933.md)

# CVE-2023-6933

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md](../2023/CVE-2023-6933-Trex96_vulnerable-bsr-lab-CVE-2023-6933.md)

## CVE-2023-6933 - WordPress Better Search Replace Plugin PHP å¯¹è±¡æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-6933

**æ¼æ´ç±»å‹:** PHP å¯¹è±¡æ³¨å…¥

**å½±å“åº”ç”¨:** WordPress Better Search Replace Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 1.4.4

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„Better Search Replaceæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯åˆ©ç”¨çš„POPé“¾

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2023-6933 å­˜åœ¨äº WordPress Better Search Replace æ’ä»¶ä¸­ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®è¿›è¡Œ PHP å¯¹è±¡æ³¨å…¥ã€‚æ¼æ´ä½äº`class-bsr-db.php`æ–‡ä»¶çš„`recursive_unserialize_replace()`å‡½æ•°ä¸­ï¼Œè¯¥å‡½æ•°ç›´æ¥å°†ç”¨æˆ·å¯æ§çš„`search_for`å‚æ•°ä¼ é€’ç»™ PHP çš„ `unserialize()` å‡½æ•°ï¼Œè€Œæ²¡æœ‰è¿›è¡Œé€‚å½“çš„éªŒè¯æˆ–æ¸…ç†ã€‚ ç”±äºè¯¥æ’ä»¶æœ¬èº«ä¸åŒ…å« POP é“¾ï¼Œå› æ­¤æ”»å‡»è€…éœ€è¦ä¾èµ–å…¶ä»–æ’ä»¶æˆ–ä¸»é¢˜ä¸­å­˜åœ¨çš„ POP é“¾æ‰èƒ½å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œåˆ©ç”¨ `search_replace_db` action è§¦å‘æ¼æ´ã€‚PoC ä½¿ç”¨ `dry_run=1` å‚æ•°ä»¥é¿å…æ•°æ®åº“ä¿®æ”¹ï¼Œå¹¶ä½¿ç”¨ `stdClass` å¯¹è±¡ä½œä¸º payloadï¼Œä»¥è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚ é€šè¿‡æ£€æŸ¥ HTTP çŠ¶æ€ä»£ç å’Œå“åº”å†…å®¹ï¼ŒPoC å¯ä»¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è¯¥ PoC æ—¨åœ¨è¿›è¡Œéä¾µå…¥å¼æµ‹è¯•ï¼Œå¹¶ä¸”åŒ…å«å®‰å…¨æªæ–½ï¼Œä¾‹å¦‚ `dry_run=1` å’Œä½¿ç”¨æ— å®³çš„ `stdClass` å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨ä¸€å®šé£é™©ã€‚è¿™é‡Œå‡è®¾æŠ•æ¯’é£é™©ä¸º1%, ä¸»è¦æ¥è‡ªäºä»¥ä¸‹è€ƒè™‘:

1.  **äººä¸ºé”™è¯¯ï¼š** ç”¨æˆ·åœ¨ä½¿ç”¨æˆ–ä¿®æ”¹PoCæ—¶ï¼Œå¯èƒ½ä¼šå¼•å…¥é”™è¯¯æˆ–æ¶æ„ä»£ç ã€‚
2.  **ä¾èµ–é¡¹é—®é¢˜ï¼š** è™½ç„¶ PoC æœ¬èº«çœ‹èµ·æ¥å®‰å…¨ï¼Œä½†å®ƒå¯èƒ½ä¾èµ–äºå…¶ä»–åº“æˆ–ç»„ä»¶ï¼Œè¿™äº›åº“æˆ–ç»„ä»¶å¯èƒ½å­˜åœ¨å®‰å…¨æ¼æ´ã€‚
3.  **ç¯å¢ƒå·®å¼‚ï¼š** PoC åœ¨ä¸åŒç¯å¢ƒä¸‹çš„è¡Œä¸ºå¯èƒ½æœ‰æ‰€ä¸åŒï¼ŒæŸäº›ç¯å¢ƒä¸‹å¯èƒ½ä¼šäº§ç”Ÿæ„æƒ³ä¸åˆ°çš„å‰¯ä½œç”¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ’ä»¶æ£€æµ‹ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦ç¡®è®¤ç›®æ ‡ WordPress ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Better Search Replace æ’ä»¶ã€‚å¯ä»¥é€šè¿‡è®¿é—® `/wp-content/plugins/better-search-replace/README.txt` æ–‡ä»¶æ¥è·å–æ’ä»¶ç‰ˆæœ¬ä¿¡æ¯ã€‚
2.  **Payload æ„é€ ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªæ¶æ„çš„ PHP åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«ä¸€ä¸ª POP é“¾ï¼Œå¯ä»¥è§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚POP é“¾é€šå¸¸æ¶‰åŠå¤šä¸ªç±»çš„ç›¸äº’è°ƒç”¨ï¼Œæœ€ç»ˆæ‰§è¡Œæ¶æ„ä»£ç ã€‚
3.  **æ¼æ´è§¦å‘ï¼š** æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œå¹¶å°† `action` å‚æ•°è®¾ç½®ä¸º `search_replace_db`ï¼Œ`search_for` å‚æ•°è®¾ç½®ä¸ºæ„é€ çš„æ¶æ„åºåˆ—åŒ–å¯¹è±¡ã€‚å…¶ä»–å‚æ•°åŒ…æ‹¬ `replace_with`ï¼Œ `dry_run=1` å’Œ `select_tables[]`ã€‚
4.  **ä»£ç æ‰§è¡Œï¼š** å¦‚æœç›®æ ‡ç«™ç‚¹å­˜åœ¨å¯ç”¨çš„ POP é“¾ï¼Œå¹¶ä¸”åºåˆ—åŒ–å¯¹è±¡æˆåŠŸååºåˆ—åŒ–ï¼Œåˆ™ä¼šè§¦å‘ POP é“¾ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [Trex96/vulnerable-bsr-lab-CVE-2023-6933](https://github.com/Trex96/vulnerable-bsr-lab-CVE-2023-6933)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-6933](https://nvd.nist.gov/vuln/detail/CVE-2023-6933)

---

## POC #2

**æ¥æº**: [CVE-2023-6933-w2xim3_CVE-2023-6933.md](../2023/CVE-2023-6933-w2xim3_CVE-2023-6933.md)

## CVE-2023-6933 - WordPress Better Search Replace Plugin PHPå¯¹è±¡æ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2023-6933

**æ¼æ´ç±»å‹:** PHPå¯¹è±¡æ³¨å…¥

**å½±å“åº”ç”¨:** WordPress Better Search Replace Plugin

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶åˆ é™¤ã€æ•æ„Ÿæ•°æ®æ³„éœ²æˆ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 1.4.4

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿéœ€è¦å®‰è£…å—å½±å“çš„Better Search Replaceæ’ä»¶ï¼Œå¹¶ä¸”å­˜åœ¨å…¶ä»–å«æœ‰POPé“¾çš„æ’ä»¶æˆ–ä¸»é¢˜ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2023-6933å­˜åœ¨äºWordPressçš„Better Search Replaceæ’ä»¶ä¸­ï¼Œç‰ˆæœ¬ä½äºæˆ–ç­‰äº1.4.4ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡çš„è¾“å…¥æ¥æ³¨å…¥PHPå¯¹è±¡ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
è¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§å–å†³äºç›®æ ‡ç³»ç»Ÿä¸Šæ˜¯å¦å­˜åœ¨POPé“¾ã€‚ Better Search Replaceæ’ä»¶æœ¬èº«ä¸åŒ…å«POPé“¾ã€‚å¦‚æœç›®æ ‡ç³»ç»Ÿä¸Šå®‰è£…äº†å¦ä¸€ä¸ªåŒ…å«POPé“¾çš„æ’ä»¶æˆ–ä¸»é¢˜ï¼Œé‚£ä¹ˆåˆ©ç”¨è¿™ä¸ªæ¼æ´æ˜¯å¯è¡Œçš„ã€‚æä¾›çš„PoCå±•ç¤ºäº†åˆ©ç”¨WordPress 6.4.0ä¸­ `WP_HTML_Token` ç±»ï¼Œé€šè¿‡ `call_user_func` å‡½æ•°å®ç°ä»£ç æ‰§è¡Œçš„æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•ä¾èµ–äºå¯æ§çš„ `on_destroy` å±æ€§æŒ‡å‘æ¶æ„å‡½æ•°ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åœ¨æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸­ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚ä¸»è¦é£é™©åœ¨äºï¼š
1.  **æ¶æ„ä»£ç æ‰§è¡Œï¼š** PoCçš„æ ¸å¿ƒæ˜¯åˆ©ç”¨`call_user_func`æ¥æ‰§è¡Œä»£ç ï¼Œå¦‚æœ`on_destroy`è¢«è®¾ç½®ä¸ºæŒ‡å‘æ¶æ„å‡½æ•°ï¼Œå°±å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
2.  **ä¾èµ–å¤–éƒ¨ç¯å¢ƒï¼š** è¯¥PoCä¾èµ–äºç›®æ ‡ç«™ç‚¹å®‰è£…çš„å…¶ä»–æ’ä»¶æˆ–ä¸»é¢˜æ¥æä¾›POPé“¾ã€‚å¦‚æœç›®æ ‡ç«™ç‚¹ä¸å…·å¤‡è¿™ä¸ªæ¡ä»¶ï¼Œé‚£ä¹ˆè¯¥PoCæ— æ³•ç›´æ¥åˆ©ç”¨æˆåŠŸã€‚ä½†æ½œåœ¨çš„é£é™©æ˜¯ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šè¯±å¯¼ç”¨æˆ·å®‰è£…å­˜åœ¨POPé“¾çš„æ’ä»¶ï¼Œä»è€Œä¸ºæ”»å‡»åˆ›é€ æ¡ä»¶ã€‚
è¯¥ä»£ç çœ‹èµ·æ¥ä¸»è¦ç”¨äºæ¼”ç¤ºå’ŒéªŒè¯æ¼æ´ï¼Œå¹¶æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œæ¯”å¦‚ä¸Šä¼ åé—¨æˆ–çªƒå–ä¿¡æ¯ï¼Œä½†é€šè¿‡ç²¾å¿ƒæ„é€ çš„`on_destroy`,å¯ä»¥å†™å…¥æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **æ‰¾åˆ°å¯åˆ©ç”¨çš„æ³¨å…¥ç‚¹ï¼š** é€šè¿‡Better Search Replaceæ’ä»¶çš„æœç´¢æ›¿æ¢åŠŸèƒ½ï¼Œå°†åºåˆ—åŒ–çš„PHPå¯¹è±¡æ³¨å…¥åˆ°æ•°æ®åº“ä¸­ã€‚  æ ¹æ®PoCï¼Œå¯ä»¥é€šè¿‡æ’ä»¶çš„æœç´¢å’Œæ›¿æ¢åŠŸèƒ½å°†åºåˆ—åŒ–çš„å¯¹è±¡æ³¨å…¥åˆ°æ•°æ®åº“è¡¨ä¸­ã€‚
2.  **æ„é€ æ¶æ„çš„PHPå¯¹è±¡ï¼š** æ„é€ åŒ…å«POPé“¾çš„PHPå¯¹è±¡ã€‚ è¯¥PHPå¯¹è±¡éœ€è¦åˆ©ç”¨ç›®æ ‡ç³»ç»Ÿä¸Šå·²å­˜åœ¨çš„ç±»ï¼Œå¹¶æœ€ç»ˆè°ƒç”¨`call_user_func`æˆ–ç±»ä¼¼å‡½æ•°ï¼Œæ‰§è¡Œä»»æ„ä»£ç ã€‚
3.  **è§¦å‘ååºåˆ—åŒ–ï¼š** å½“æ’ä»¶å¤„ç†åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„æ•°æ®åº“è®°å½•æ—¶ï¼ŒPHPä¼šå°è¯•ååºåˆ—åŒ–è¯¥å¯¹è±¡ï¼Œä»è€Œè§¦å‘POPé“¾ï¼Œæœ€ç»ˆå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚
4. **åˆ©ç”¨WP_HTML_Tokenç±»** WordPress 6.4.0 ä¸­å¼•å…¥çš„`WP_HTML_Token`ç±»å¯ä»¥è¢«ç”¨äºæ„é€ POPé“¾ï¼Œæ§åˆ¶`on_destroy`å±æ€§æŒ‡å‘æ¶æ„å‡½æ•°ï¼Œä»è€Œå®ç°ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [w2xim3/CVE-2023-6933](https://github.com/w2xim3/CVE-2023-6933)

**æ¼æ´è¯¦æƒ…:** [CVE-2023-6933](https://nvd.nist.gov/vuln/detail/CVE-2023-6933)

---



---



---



---



---



---



---



---



---



---



---



---



---

