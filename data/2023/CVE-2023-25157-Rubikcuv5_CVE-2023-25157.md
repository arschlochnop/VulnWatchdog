# CVE-2023-25157

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-25157-0x2458bughunt_CVE-2023-25157.md](../2023/CVE-2023-25157-0x2458bughunt_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问到存在漏洞的GeoServer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。根据漏洞库信息，该漏洞存在于2.22.0到2.22.2之前的版本以及2.21.4之前的版本。搜索引擎结果也确认了该漏洞的存在，并提供了相关的分析和检测方法。提供的POC代码包含两个Python脚本：

*   `GeoServer_Path-Finder.py`: 这个脚本用于检测目标主机上是否存在GeoServer的WFS服务，通过访问`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`路径来判断。如果返回状态码为200，则认为服务存在，并将URL写入到输出文件中。
*   `GeoServer_Keyword-Checker.py`: 这个脚本用于检查目标网站的响应内容中是否包含特定的关键词，例如`<Title>GeoServer Web Feature Service</Title>`，用于验证GeoServer是否运行，但该脚本和SQL注入漏洞本身关联不大.

虽然提供的Python脚本本身并不直接利用SQL注入漏洞，但是它们可以作为漏洞利用的前期侦察手段，用于发现目标环境中存在的GeoServer实例。找到目标实例后，攻击者可以利用CQL注入点构造恶意的SQL查询，从而读取数据库信息甚至执行任意代码。

**有效性：**

提供的脚本本身并不能直接利用SQL注入，但可以作为漏洞利用前期信息收集的辅助工具。其有效性体现在能够快速识别目标网络中运行的Geoserver服务。

**投毒风险：**

通过分析代码，发现投毒风险较低。`GeoServer_Path-Finder.py` 和 `GeoServer_Keyword-Checker.py` 的主要功能是发送HTTP请求并检查响应。虽然存在通过hosts文件传入目标地址，但该操作属于脚本的正常功能，而非恶意代码植入。脚本对输入的主机列表没有做任何过滤和校验，如果攻击者控制了hosts文件，是有可能通过注入恶意链接来redirect到其他站点，造成信息泄露或者XSS。所以风险评估为10%。

**利用方式：**

1.  **信息收集：** 使用 `GeoServer_Path-Finder.py` 扫描目标网络，查找运行Geoserver的实例。
2.  **验证服务：** 找到Geoserver实例后,通过访问`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`路径验证Geoserver服务是否存在。
3.  **SQL注入：** 确定存在漏洞的GeoServer实例后，利用OGC Filter表达式语言或CQL中的SQL注入点，构造恶意的SQL查询语句，发送到服务器。
4.  **数据窃取/代码执行：** 成功注入后，根据具体的注入点和数据库配置，可以读取敏感数据、修改数据库内容，甚至执行任意代码。

**项目地址:** [0x2458bughunt/CVE-2023-25157](https://github.com/0x2458bughunt/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #2

**来源**: [CVE-2023-25157-7imbitz_CVE-2023-25157-checker.md](../2023/CVE-2023-25157-7imbitz_CVE-2023-25157-checker.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 严重，可导致数据泄露、篡改、拒绝服务，甚至远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要能够访问存在漏洞的GeoServer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。根据漏洞库信息，该漏洞存在于OGC Filter表达式语言和OGC Common Query Language (CQL) 中，影响Web Feature Service (WFS)和Web Map Service (WMS) 协议，以及Web Coverage Service (WCS) 协议的ImageMosaic覆盖。搜索引擎结果也证实了该漏洞的存在，并提供了相关的分析报告和修复建议。漏洞利用代码（Go语言编写的POC）首先检查GeoServer实例是否存活，然后尝试列出可用的feature names，接着针对每个feature name, 结合CQL_FILTER，尝试使用`strEndsWith` 函数注入恶意的SQL语句。这个恶意SQL尝试执行 `SELECT current_user`。由于Go语言代码本身主要用于验证和利用漏洞，不存在明显的后门或者恶意代码。但需要注意的是，该POC代码可能被恶意使用者修改后进行传播，加入恶意代码，因此存在一定的投毒风险。该漏洞利用方式主要依赖于构造恶意的CQL_FILTER，其中包含SQL注入语句，如果GeoServer实例未能正确过滤或转义这些输入，则可能执行攻击者构造的SQL查询，导致信息泄露或权限提升。

**项目地址:** [7imbitz/CVE-2023-25157-checker](https://github.com/7imbitz/CVE-2023-25157-checker)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #3

**来源**: [CVE-2023-25157-Rubikcuv5_CVE-2023-25157.md](../2023/CVE-2023-25157-Rubikcuv5_CVE-2023-25157.md)

# CVE-2023-25157

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-25157-0x2458bughunt_CVE-2023-25157.md](../2023/CVE-2023-25157-0x2458bughunt_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问到存在漏洞的GeoServer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。根据漏洞库信息，该漏洞存在于2.22.0到2.22.2之前的版本以及2.21.4之前的版本。搜索引擎结果也确认了该漏洞的存在，并提供了相关的分析和检测方法。提供的POC代码包含两个Python脚本：

*   `GeoServer_Path-Finder.py`: 这个脚本用于检测目标主机上是否存在GeoServer的WFS服务，通过访问`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`路径来判断。如果返回状态码为200，则认为服务存在，并将URL写入到输出文件中。
*   `GeoServer_Keyword-Checker.py`: 这个脚本用于检查目标网站的响应内容中是否包含特定的关键词，例如`<Title>GeoServer Web Feature Service</Title>`，用于验证GeoServer是否运行，但该脚本和SQL注入漏洞本身关联不大.

虽然提供的Python脚本本身并不直接利用SQL注入漏洞，但是它们可以作为漏洞利用的前期侦察手段，用于发现目标环境中存在的GeoServer实例。找到目标实例后，攻击者可以利用CQL注入点构造恶意的SQL查询，从而读取数据库信息甚至执行任意代码。

**有效性：**

提供的脚本本身并不能直接利用SQL注入，但可以作为漏洞利用前期信息收集的辅助工具。其有效性体现在能够快速识别目标网络中运行的Geoserver服务。

**投毒风险：**

通过分析代码，发现投毒风险较低。`GeoServer_Path-Finder.py` 和 `GeoServer_Keyword-Checker.py` 的主要功能是发送HTTP请求并检查响应。虽然存在通过hosts文件传入目标地址，但该操作属于脚本的正常功能，而非恶意代码植入。脚本对输入的主机列表没有做任何过滤和校验，如果攻击者控制了hosts文件，是有可能通过注入恶意链接来redirect到其他站点，造成信息泄露或者XSS。所以风险评估为10%。

**利用方式：**

1.  **信息收集：** 使用 `GeoServer_Path-Finder.py` 扫描目标网络，查找运行Geoserver的实例。
2.  **验证服务：** 找到Geoserver实例后,通过访问`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`路径验证Geoserver服务是否存在。
3.  **SQL注入：** 确定存在漏洞的GeoServer实例后，利用OGC Filter表达式语言或CQL中的SQL注入点，构造恶意的SQL查询语句，发送到服务器。
4.  **数据窃取/代码执行：** 成功注入后，根据具体的注入点和数据库配置，可以读取敏感数据、修改数据库内容，甚至执行任意代码。

**项目地址:** [0x2458bughunt/CVE-2023-25157](https://github.com/0x2458bughunt/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #2

**来源**: [CVE-2023-25157-7imbitz_CVE-2023-25157-checker.md](../2023/CVE-2023-25157-7imbitz_CVE-2023-25157-checker.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 严重，可导致数据泄露、篡改、拒绝服务，甚至远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要能够访问存在漏洞的GeoServer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。根据漏洞库信息，该漏洞存在于OGC Filter表达式语言和OGC Common Query Language (CQL) 中，影响Web Feature Service (WFS)和Web Map Service (WMS) 协议，以及Web Coverage Service (WCS) 协议的ImageMosaic覆盖。搜索引擎结果也证实了该漏洞的存在，并提供了相关的分析报告和修复建议。漏洞利用代码（Go语言编写的POC）首先检查GeoServer实例是否存活，然后尝试列出可用的feature names，接着针对每个feature name, 结合CQL_FILTER，尝试使用`strEndsWith` 函数注入恶意的SQL语句。这个恶意SQL尝试执行 `SELECT current_user`。由于Go语言代码本身主要用于验证和利用漏洞，不存在明显的后门或者恶意代码。但需要注意的是，该POC代码可能被恶意使用者修改后进行传播，加入恶意代码，因此存在一定的投毒风险。该漏洞利用方式主要依赖于构造恶意的CQL_FILTER，其中包含SQL注入语句，如果GeoServer实例未能正确过滤或转义这些输入，则可能执行攻击者构造的SQL查询，导致信息泄露或权限提升。

**项目地址:** [7imbitz/CVE-2023-25157-checker](https://github.com/7imbitz/CVE-2023-25157-checker)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #3

**来源**: [CVE-2023-25157-Rubikcuv5_CVE-2023-25157.md](../2023/CVE-2023-25157-Rubikcuv5_CVE-2023-25157.md)

# CVE-2023-25157

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-25157-0x2458bughunt_CVE-2023-25157.md](../2023/CVE-2023-25157-0x2458bughunt_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问到存在漏洞的GeoServer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。根据漏洞库信息，该漏洞存在于2.22.0到2.22.2之前的版本以及2.21.4之前的版本。搜索引擎结果也确认了该漏洞的存在，并提供了相关的分析和检测方法。提供的POC代码包含两个Python脚本：

*   `GeoServer_Path-Finder.py`: 这个脚本用于检测目标主机上是否存在GeoServer的WFS服务，通过访问`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`路径来判断。如果返回状态码为200，则认为服务存在，并将URL写入到输出文件中。
*   `GeoServer_Keyword-Checker.py`: 这个脚本用于检查目标网站的响应内容中是否包含特定的关键词，例如`<Title>GeoServer Web Feature Service</Title>`，用于验证GeoServer是否运行，但该脚本和SQL注入漏洞本身关联不大.

虽然提供的Python脚本本身并不直接利用SQL注入漏洞，但是它们可以作为漏洞利用的前期侦察手段，用于发现目标环境中存在的GeoServer实例。找到目标实例后，攻击者可以利用CQL注入点构造恶意的SQL查询，从而读取数据库信息甚至执行任意代码。

**有效性：**

提供的脚本本身并不能直接利用SQL注入，但可以作为漏洞利用前期信息收集的辅助工具。其有效性体现在能够快速识别目标网络中运行的Geoserver服务。

**投毒风险：**

通过分析代码，发现投毒风险较低。`GeoServer_Path-Finder.py` 和 `GeoServer_Keyword-Checker.py` 的主要功能是发送HTTP请求并检查响应。虽然存在通过hosts文件传入目标地址，但该操作属于脚本的正常功能，而非恶意代码植入。脚本对输入的主机列表没有做任何过滤和校验，如果攻击者控制了hosts文件，是有可能通过注入恶意链接来redirect到其他站点，造成信息泄露或者XSS。所以风险评估为10%。

**利用方式：**

1.  **信息收集：** 使用 `GeoServer_Path-Finder.py` 扫描目标网络，查找运行Geoserver的实例。
2.  **验证服务：** 找到Geoserver实例后,通过访问`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`路径验证Geoserver服务是否存在。
3.  **SQL注入：** 确定存在漏洞的GeoServer实例后，利用OGC Filter表达式语言或CQL中的SQL注入点，构造恶意的SQL查询语句，发送到服务器。
4.  **数据窃取/代码执行：** 成功注入后，根据具体的注入点和数据库配置，可以读取敏感数据、修改数据库内容，甚至执行任意代码。

**项目地址:** [0x2458bughunt/CVE-2023-25157](https://github.com/0x2458bughunt/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #2

**来源**: [CVE-2023-25157-7imbitz_CVE-2023-25157-checker.md](../2023/CVE-2023-25157-7imbitz_CVE-2023-25157-checker.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 严重，可导致数据泄露、篡改、拒绝服务，甚至远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要能够访问存在漏洞的GeoServer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。根据漏洞库信息，该漏洞存在于OGC Filter表达式语言和OGC Common Query Language (CQL) 中，影响Web Feature Service (WFS)和Web Map Service (WMS) 协议，以及Web Coverage Service (WCS) 协议的ImageMosaic覆盖。搜索引擎结果也证实了该漏洞的存在，并提供了相关的分析报告和修复建议。漏洞利用代码（Go语言编写的POC）首先检查GeoServer实例是否存活，然后尝试列出可用的feature names，接着针对每个feature name, 结合CQL_FILTER，尝试使用`strEndsWith` 函数注入恶意的SQL语句。这个恶意SQL尝试执行 `SELECT current_user`。由于Go语言代码本身主要用于验证和利用漏洞，不存在明显的后门或者恶意代码。但需要注意的是，该POC代码可能被恶意使用者修改后进行传播，加入恶意代码，因此存在一定的投毒风险。该漏洞利用方式主要依赖于构造恶意的CQL_FILTER，其中包含SQL注入语句，如果GeoServer实例未能正确过滤或转义这些输入，则可能执行攻击者构造的SQL查询，导致信息泄露或权限提升。

**项目地址:** [7imbitz/CVE-2023-25157-checker](https://github.com/7imbitz/CVE-2023-25157-checker)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #3

**来源**: [CVE-2023-25157-Rubikcuv5_CVE-2023-25157.md](../2023/CVE-2023-25157-Rubikcuv5_CVE-2023-25157.md)

# CVE-2023-25157

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-25157-0x2458bughunt_CVE-2023-25157.md](../2023/CVE-2023-25157-0x2458bughunt_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问到存在漏洞的GeoServer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。根据漏洞库信息，该漏洞存在于2.22.0到2.22.2之前的版本以及2.21.4之前的版本。搜索引擎结果也确认了该漏洞的存在，并提供了相关的分析和检测方法。提供的POC代码包含两个Python脚本：

*   `GeoServer_Path-Finder.py`: 这个脚本用于检测目标主机上是否存在GeoServer的WFS服务，通过访问`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`路径来判断。如果返回状态码为200，则认为服务存在，并将URL写入到输出文件中。
*   `GeoServer_Keyword-Checker.py`: 这个脚本用于检查目标网站的响应内容中是否包含特定的关键词，例如`<Title>GeoServer Web Feature Service</Title>`，用于验证GeoServer是否运行，但该脚本和SQL注入漏洞本身关联不大.

虽然提供的Python脚本本身并不直接利用SQL注入漏洞，但是它们可以作为漏洞利用的前期侦察手段，用于发现目标环境中存在的GeoServer实例。找到目标实例后，攻击者可以利用CQL注入点构造恶意的SQL查询，从而读取数据库信息甚至执行任意代码。

**有效性：**

提供的脚本本身并不能直接利用SQL注入，但可以作为漏洞利用前期信息收集的辅助工具。其有效性体现在能够快速识别目标网络中运行的Geoserver服务。

**投毒风险：**

通过分析代码，发现投毒风险较低。`GeoServer_Path-Finder.py` 和 `GeoServer_Keyword-Checker.py` 的主要功能是发送HTTP请求并检查响应。虽然存在通过hosts文件传入目标地址，但该操作属于脚本的正常功能，而非恶意代码植入。脚本对输入的主机列表没有做任何过滤和校验，如果攻击者控制了hosts文件，是有可能通过注入恶意链接来redirect到其他站点，造成信息泄露或者XSS。所以风险评估为10%。

**利用方式：**

1.  **信息收集：** 使用 `GeoServer_Path-Finder.py` 扫描目标网络，查找运行Geoserver的实例。
2.  **验证服务：** 找到Geoserver实例后,通过访问`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`路径验证Geoserver服务是否存在。
3.  **SQL注入：** 确定存在漏洞的GeoServer实例后，利用OGC Filter表达式语言或CQL中的SQL注入点，构造恶意的SQL查询语句，发送到服务器。
4.  **数据窃取/代码执行：** 成功注入后，根据具体的注入点和数据库配置，可以读取敏感数据、修改数据库内容，甚至执行任意代码。

**项目地址:** [0x2458bughunt/CVE-2023-25157](https://github.com/0x2458bughunt/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #2

**来源**: [CVE-2023-25157-7imbitz_CVE-2023-25157-checker.md](../2023/CVE-2023-25157-7imbitz_CVE-2023-25157-checker.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 严重，可导致数据泄露、篡改、拒绝服务，甚至远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要能够访问存在漏洞的GeoServer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。根据漏洞库信息，该漏洞存在于OGC Filter表达式语言和OGC Common Query Language (CQL) 中，影响Web Feature Service (WFS)和Web Map Service (WMS) 协议，以及Web Coverage Service (WCS) 协议的ImageMosaic覆盖。搜索引擎结果也证实了该漏洞的存在，并提供了相关的分析报告和修复建议。漏洞利用代码（Go语言编写的POC）首先检查GeoServer实例是否存活，然后尝试列出可用的feature names，接着针对每个feature name, 结合CQL_FILTER，尝试使用`strEndsWith` 函数注入恶意的SQL语句。这个恶意SQL尝试执行 `SELECT current_user`。由于Go语言代码本身主要用于验证和利用漏洞，不存在明显的后门或者恶意代码。但需要注意的是，该POC代码可能被恶意使用者修改后进行传播，加入恶意代码，因此存在一定的投毒风险。该漏洞利用方式主要依赖于构造恶意的CQL_FILTER，其中包含SQL注入语句，如果GeoServer实例未能正确过滤或转义这些输入，则可能执行攻击者构造的SQL查询，导致信息泄露或权限提升。

**项目地址:** [7imbitz/CVE-2023-25157-checker](https://github.com/7imbitz/CVE-2023-25157-checker)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #3

**来源**: [CVE-2023-25157-Rubikcuv5_CVE-2023-25157.md](../2023/CVE-2023-25157-Rubikcuv5_CVE-2023-25157.md)

# CVE-2023-25157

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-25157-0x2458bughunt_CVE-2023-25157.md](../2023/CVE-2023-25157-0x2458bughunt_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问到存在漏洞的GeoServer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。根据漏洞库信息，该漏洞存在于2.22.0到2.22.2之前的版本以及2.21.4之前的版本。搜索引擎结果也确认了该漏洞的存在，并提供了相关的分析和检测方法。提供的POC代码包含两个Python脚本：

*   `GeoServer_Path-Finder.py`: 这个脚本用于检测目标主机上是否存在GeoServer的WFS服务，通过访问`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`路径来判断。如果返回状态码为200，则认为服务存在，并将URL写入到输出文件中。
*   `GeoServer_Keyword-Checker.py`: 这个脚本用于检查目标网站的响应内容中是否包含特定的关键词，例如`<Title>GeoServer Web Feature Service</Title>`，用于验证GeoServer是否运行，但该脚本和SQL注入漏洞本身关联不大.

虽然提供的Python脚本本身并不直接利用SQL注入漏洞，但是它们可以作为漏洞利用的前期侦察手段，用于发现目标环境中存在的GeoServer实例。找到目标实例后，攻击者可以利用CQL注入点构造恶意的SQL查询，从而读取数据库信息甚至执行任意代码。

**有效性：**

提供的脚本本身并不能直接利用SQL注入，但可以作为漏洞利用前期信息收集的辅助工具。其有效性体现在能够快速识别目标网络中运行的Geoserver服务。

**投毒风险：**

通过分析代码，发现投毒风险较低。`GeoServer_Path-Finder.py` 和 `GeoServer_Keyword-Checker.py` 的主要功能是发送HTTP请求并检查响应。虽然存在通过hosts文件传入目标地址，但该操作属于脚本的正常功能，而非恶意代码植入。脚本对输入的主机列表没有做任何过滤和校验，如果攻击者控制了hosts文件，是有可能通过注入恶意链接来redirect到其他站点，造成信息泄露或者XSS。所以风险评估为10%。

**利用方式：**

1.  **信息收集：** 使用 `GeoServer_Path-Finder.py` 扫描目标网络，查找运行Geoserver的实例。
2.  **验证服务：** 找到Geoserver实例后,通过访问`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`路径验证Geoserver服务是否存在。
3.  **SQL注入：** 确定存在漏洞的GeoServer实例后，利用OGC Filter表达式语言或CQL中的SQL注入点，构造恶意的SQL查询语句，发送到服务器。
4.  **数据窃取/代码执行：** 成功注入后，根据具体的注入点和数据库配置，可以读取敏感数据、修改数据库内容，甚至执行任意代码。

**项目地址:** [0x2458bughunt/CVE-2023-25157](https://github.com/0x2458bughunt/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #2

**来源**: [CVE-2023-25157-7imbitz_CVE-2023-25157-checker.md](../2023/CVE-2023-25157-7imbitz_CVE-2023-25157-checker.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 严重，可导致数据泄露、篡改、拒绝服务，甚至远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要能够访问存在漏洞的GeoServer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。根据漏洞库信息，该漏洞存在于OGC Filter表达式语言和OGC Common Query Language (CQL) 中，影响Web Feature Service (WFS)和Web Map Service (WMS) 协议，以及Web Coverage Service (WCS) 协议的ImageMosaic覆盖。搜索引擎结果也证实了该漏洞的存在，并提供了相关的分析报告和修复建议。漏洞利用代码（Go语言编写的POC）首先检查GeoServer实例是否存活，然后尝试列出可用的feature names，接着针对每个feature name, 结合CQL_FILTER，尝试使用`strEndsWith` 函数注入恶意的SQL语句。这个恶意SQL尝试执行 `SELECT current_user`。由于Go语言代码本身主要用于验证和利用漏洞，不存在明显的后门或者恶意代码。但需要注意的是，该POC代码可能被恶意使用者修改后进行传播，加入恶意代码，因此存在一定的投毒风险。该漏洞利用方式主要依赖于构造恶意的CQL_FILTER，其中包含SQL注入语句，如果GeoServer实例未能正确过滤或转义这些输入，则可能执行攻击者构造的SQL查询，导致信息泄露或权限提升。

**项目地址:** [7imbitz/CVE-2023-25157-checker](https://github.com/7imbitz/CVE-2023-25157-checker)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #3

**来源**: [CVE-2023-25157-Rubikcuv5_CVE-2023-25157.md](../2023/CVE-2023-25157-Rubikcuv5_CVE-2023-25157.md)

# CVE-2023-25157

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-25157-0x2458bughunt_CVE-2023-25157.md](../2023/CVE-2023-25157-0x2458bughunt_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问到存在漏洞的GeoServer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。根据漏洞库信息，该漏洞存在于2.22.0到2.22.2之前的版本以及2.21.4之前的版本。搜索引擎结果也确认了该漏洞的存在，并提供了相关的分析和检测方法。提供的POC代码包含两个Python脚本：

*   `GeoServer_Path-Finder.py`: 这个脚本用于检测目标主机上是否存在GeoServer的WFS服务，通过访问`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`路径来判断。如果返回状态码为200，则认为服务存在，并将URL写入到输出文件中。
*   `GeoServer_Keyword-Checker.py`: 这个脚本用于检查目标网站的响应内容中是否包含特定的关键词，例如`<Title>GeoServer Web Feature Service</Title>`，用于验证GeoServer是否运行，但该脚本和SQL注入漏洞本身关联不大.

虽然提供的Python脚本本身并不直接利用SQL注入漏洞，但是它们可以作为漏洞利用的前期侦察手段，用于发现目标环境中存在的GeoServer实例。找到目标实例后，攻击者可以利用CQL注入点构造恶意的SQL查询，从而读取数据库信息甚至执行任意代码。

**有效性：**

提供的脚本本身并不能直接利用SQL注入，但可以作为漏洞利用前期信息收集的辅助工具。其有效性体现在能够快速识别目标网络中运行的Geoserver服务。

**投毒风险：**

通过分析代码，发现投毒风险较低。`GeoServer_Path-Finder.py` 和 `GeoServer_Keyword-Checker.py` 的主要功能是发送HTTP请求并检查响应。虽然存在通过hosts文件传入目标地址，但该操作属于脚本的正常功能，而非恶意代码植入。脚本对输入的主机列表没有做任何过滤和校验，如果攻击者控制了hosts文件，是有可能通过注入恶意链接来redirect到其他站点，造成信息泄露或者XSS。所以风险评估为10%。

**利用方式：**

1.  **信息收集：** 使用 `GeoServer_Path-Finder.py` 扫描目标网络，查找运行Geoserver的实例。
2.  **验证服务：** 找到Geoserver实例后,通过访问`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`路径验证Geoserver服务是否存在。
3.  **SQL注入：** 确定存在漏洞的GeoServer实例后，利用OGC Filter表达式语言或CQL中的SQL注入点，构造恶意的SQL查询语句，发送到服务器。
4.  **数据窃取/代码执行：** 成功注入后，根据具体的注入点和数据库配置，可以读取敏感数据、修改数据库内容，甚至执行任意代码。

**项目地址:** [0x2458bughunt/CVE-2023-25157](https://github.com/0x2458bughunt/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #2

**来源**: [CVE-2023-25157-7imbitz_CVE-2023-25157-checker.md](../2023/CVE-2023-25157-7imbitz_CVE-2023-25157-checker.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 严重，可导致数据泄露、篡改、拒绝服务，甚至远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要能够访问存在漏洞的GeoServer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。根据漏洞库信息，该漏洞存在于OGC Filter表达式语言和OGC Common Query Language (CQL) 中，影响Web Feature Service (WFS)和Web Map Service (WMS) 协议，以及Web Coverage Service (WCS) 协议的ImageMosaic覆盖。搜索引擎结果也证实了该漏洞的存在，并提供了相关的分析报告和修复建议。漏洞利用代码（Go语言编写的POC）首先检查GeoServer实例是否存活，然后尝试列出可用的feature names，接着针对每个feature name, 结合CQL_FILTER，尝试使用`strEndsWith` 函数注入恶意的SQL语句。这个恶意SQL尝试执行 `SELECT current_user`。由于Go语言代码本身主要用于验证和利用漏洞，不存在明显的后门或者恶意代码。但需要注意的是，该POC代码可能被恶意使用者修改后进行传播，加入恶意代码，因此存在一定的投毒风险。该漏洞利用方式主要依赖于构造恶意的CQL_FILTER，其中包含SQL注入语句，如果GeoServer实例未能正确过滤或转义这些输入，则可能执行攻击者构造的SQL查询，导致信息泄露或权限提升。

**项目地址:** [7imbitz/CVE-2023-25157-checker](https://github.com/7imbitz/CVE-2023-25157-checker)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #3

**来源**: [CVE-2023-25157-Rubikcuv5_CVE-2023-25157.md](../2023/CVE-2023-25157-Rubikcuv5_CVE-2023-25157.md)

# CVE-2023-25157

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-25157-0x2458bughunt_CVE-2023-25157.md](../2023/CVE-2023-25157-0x2458bughunt_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问到存在漏洞的GeoServer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。根据漏洞库信息，该漏洞存在于2.22.0到2.22.2之前的版本以及2.21.4之前的版本。搜索引擎结果也确认了该漏洞的存在，并提供了相关的分析和检测方法。提供的POC代码包含两个Python脚本：

*   `GeoServer_Path-Finder.py`: 这个脚本用于检测目标主机上是否存在GeoServer的WFS服务，通过访问`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`路径来判断。如果返回状态码为200，则认为服务存在，并将URL写入到输出文件中。
*   `GeoServer_Keyword-Checker.py`: 这个脚本用于检查目标网站的响应内容中是否包含特定的关键词，例如`<Title>GeoServer Web Feature Service</Title>`，用于验证GeoServer是否运行，但该脚本和SQL注入漏洞本身关联不大.

虽然提供的Python脚本本身并不直接利用SQL注入漏洞，但是它们可以作为漏洞利用的前期侦察手段，用于发现目标环境中存在的GeoServer实例。找到目标实例后，攻击者可以利用CQL注入点构造恶意的SQL查询，从而读取数据库信息甚至执行任意代码。

**有效性：**

提供的脚本本身并不能直接利用SQL注入，但可以作为漏洞利用前期信息收集的辅助工具。其有效性体现在能够快速识别目标网络中运行的Geoserver服务。

**投毒风险：**

通过分析代码，发现投毒风险较低。`GeoServer_Path-Finder.py` 和 `GeoServer_Keyword-Checker.py` 的主要功能是发送HTTP请求并检查响应。虽然存在通过hosts文件传入目标地址，但该操作属于脚本的正常功能，而非恶意代码植入。脚本对输入的主机列表没有做任何过滤和校验，如果攻击者控制了hosts文件，是有可能通过注入恶意链接来redirect到其他站点，造成信息泄露或者XSS。所以风险评估为10%。

**利用方式：**

1.  **信息收集：** 使用 `GeoServer_Path-Finder.py` 扫描目标网络，查找运行Geoserver的实例。
2.  **验证服务：** 找到Geoserver实例后,通过访问`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`路径验证Geoserver服务是否存在。
3.  **SQL注入：** 确定存在漏洞的GeoServer实例后，利用OGC Filter表达式语言或CQL中的SQL注入点，构造恶意的SQL查询语句，发送到服务器。
4.  **数据窃取/代码执行：** 成功注入后，根据具体的注入点和数据库配置，可以读取敏感数据、修改数据库内容，甚至执行任意代码。

**项目地址:** [0x2458bughunt/CVE-2023-25157](https://github.com/0x2458bughunt/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #2

**来源**: [CVE-2023-25157-7imbitz_CVE-2023-25157-checker.md](../2023/CVE-2023-25157-7imbitz_CVE-2023-25157-checker.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 严重，可导致数据泄露、篡改、拒绝服务，甚至远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要能够访问存在漏洞的GeoServer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。根据漏洞库信息，该漏洞存在于OGC Filter表达式语言和OGC Common Query Language (CQL) 中，影响Web Feature Service (WFS)和Web Map Service (WMS) 协议，以及Web Coverage Service (WCS) 协议的ImageMosaic覆盖。搜索引擎结果也证实了该漏洞的存在，并提供了相关的分析报告和修复建议。漏洞利用代码（Go语言编写的POC）首先检查GeoServer实例是否存活，然后尝试列出可用的feature names，接着针对每个feature name, 结合CQL_FILTER，尝试使用`strEndsWith` 函数注入恶意的SQL语句。这个恶意SQL尝试执行 `SELECT current_user`。由于Go语言代码本身主要用于验证和利用漏洞，不存在明显的后门或者恶意代码。但需要注意的是，该POC代码可能被恶意使用者修改后进行传播，加入恶意代码，因此存在一定的投毒风险。该漏洞利用方式主要依赖于构造恶意的CQL_FILTER，其中包含SQL注入语句，如果GeoServer实例未能正确过滤或转义这些输入，则可能执行攻击者构造的SQL查询，导致信息泄露或权限提升。

**项目地址:** [7imbitz/CVE-2023-25157-checker](https://github.com/7imbitz/CVE-2023-25157-checker)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #3

**来源**: [CVE-2023-25157-Rubikcuv5_CVE-2023-25157.md](../2023/CVE-2023-25157-Rubikcuv5_CVE-2023-25157.md)

# CVE-2023-25157

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-25157-0x2458bughunt_CVE-2023-25157.md](../2023/CVE-2023-25157-0x2458bughunt_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问到存在漏洞的GeoServer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。根据漏洞库信息，该漏洞存在于2.22.0到2.22.2之前的版本以及2.21.4之前的版本。搜索引擎结果也确认了该漏洞的存在，并提供了相关的分析和检测方法。提供的POC代码包含两个Python脚本：

*   `GeoServer_Path-Finder.py`: 这个脚本用于检测目标主机上是否存在GeoServer的WFS服务，通过访问`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`路径来判断。如果返回状态码为200，则认为服务存在，并将URL写入到输出文件中。
*   `GeoServer_Keyword-Checker.py`: 这个脚本用于检查目标网站的响应内容中是否包含特定的关键词，例如`<Title>GeoServer Web Feature Service</Title>`，用于验证GeoServer是否运行，但该脚本和SQL注入漏洞本身关联不大.

虽然提供的Python脚本本身并不直接利用SQL注入漏洞，但是它们可以作为漏洞利用的前期侦察手段，用于发现目标环境中存在的GeoServer实例。找到目标实例后，攻击者可以利用CQL注入点构造恶意的SQL查询，从而读取数据库信息甚至执行任意代码。

**有效性：**

提供的脚本本身并不能直接利用SQL注入，但可以作为漏洞利用前期信息收集的辅助工具。其有效性体现在能够快速识别目标网络中运行的Geoserver服务。

**投毒风险：**

通过分析代码，发现投毒风险较低。`GeoServer_Path-Finder.py` 和 `GeoServer_Keyword-Checker.py` 的主要功能是发送HTTP请求并检查响应。虽然存在通过hosts文件传入目标地址，但该操作属于脚本的正常功能，而非恶意代码植入。脚本对输入的主机列表没有做任何过滤和校验，如果攻击者控制了hosts文件，是有可能通过注入恶意链接来redirect到其他站点，造成信息泄露或者XSS。所以风险评估为10%。

**利用方式：**

1.  **信息收集：** 使用 `GeoServer_Path-Finder.py` 扫描目标网络，查找运行Geoserver的实例。
2.  **验证服务：** 找到Geoserver实例后,通过访问`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`路径验证Geoserver服务是否存在。
3.  **SQL注入：** 确定存在漏洞的GeoServer实例后，利用OGC Filter表达式语言或CQL中的SQL注入点，构造恶意的SQL查询语句，发送到服务器。
4.  **数据窃取/代码执行：** 成功注入后，根据具体的注入点和数据库配置，可以读取敏感数据、修改数据库内容，甚至执行任意代码。

**项目地址:** [0x2458bughunt/CVE-2023-25157](https://github.com/0x2458bughunt/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #2

**来源**: [CVE-2023-25157-7imbitz_CVE-2023-25157-checker.md](../2023/CVE-2023-25157-7imbitz_CVE-2023-25157-checker.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 严重，可导致数据泄露、篡改、拒绝服务，甚至远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要能够访问存在漏洞的GeoServer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。根据漏洞库信息，该漏洞存在于OGC Filter表达式语言和OGC Common Query Language (CQL) 中，影响Web Feature Service (WFS)和Web Map Service (WMS) 协议，以及Web Coverage Service (WCS) 协议的ImageMosaic覆盖。搜索引擎结果也证实了该漏洞的存在，并提供了相关的分析报告和修复建议。漏洞利用代码（Go语言编写的POC）首先检查GeoServer实例是否存活，然后尝试列出可用的feature names，接着针对每个feature name, 结合CQL_FILTER，尝试使用`strEndsWith` 函数注入恶意的SQL语句。这个恶意SQL尝试执行 `SELECT current_user`。由于Go语言代码本身主要用于验证和利用漏洞，不存在明显的后门或者恶意代码。但需要注意的是，该POC代码可能被恶意使用者修改后进行传播，加入恶意代码，因此存在一定的投毒风险。该漏洞利用方式主要依赖于构造恶意的CQL_FILTER，其中包含SQL注入语句，如果GeoServer实例未能正确过滤或转义这些输入，则可能执行攻击者构造的SQL查询，导致信息泄露或权限提升。

**项目地址:** [7imbitz/CVE-2023-25157-checker](https://github.com/7imbitz/CVE-2023-25157-checker)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #3

**来源**: [CVE-2023-25157-Rubikcuv5_CVE-2023-25157.md](../2023/CVE-2023-25157-Rubikcuv5_CVE-2023-25157.md)

# CVE-2023-25157

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-25157-0x2458bughunt_CVE-2023-25157.md](../2023/CVE-2023-25157-0x2458bughunt_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问到存在漏洞的GeoServer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。根据漏洞库信息，该漏洞存在于2.22.0到2.22.2之前的版本以及2.21.4之前的版本。搜索引擎结果也确认了该漏洞的存在，并提供了相关的分析和检测方法。提供的POC代码包含两个Python脚本：

*   `GeoServer_Path-Finder.py`: 这个脚本用于检测目标主机上是否存在GeoServer的WFS服务，通过访问`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`路径来判断。如果返回状态码为200，则认为服务存在，并将URL写入到输出文件中。
*   `GeoServer_Keyword-Checker.py`: 这个脚本用于检查目标网站的响应内容中是否包含特定的关键词，例如`<Title>GeoServer Web Feature Service</Title>`，用于验证GeoServer是否运行，但该脚本和SQL注入漏洞本身关联不大.

虽然提供的Python脚本本身并不直接利用SQL注入漏洞，但是它们可以作为漏洞利用的前期侦察手段，用于发现目标环境中存在的GeoServer实例。找到目标实例后，攻击者可以利用CQL注入点构造恶意的SQL查询，从而读取数据库信息甚至执行任意代码。

**有效性：**

提供的脚本本身并不能直接利用SQL注入，但可以作为漏洞利用前期信息收集的辅助工具。其有效性体现在能够快速识别目标网络中运行的Geoserver服务。

**投毒风险：**

通过分析代码，发现投毒风险较低。`GeoServer_Path-Finder.py` 和 `GeoServer_Keyword-Checker.py` 的主要功能是发送HTTP请求并检查响应。虽然存在通过hosts文件传入目标地址，但该操作属于脚本的正常功能，而非恶意代码植入。脚本对输入的主机列表没有做任何过滤和校验，如果攻击者控制了hosts文件，是有可能通过注入恶意链接来redirect到其他站点，造成信息泄露或者XSS。所以风险评估为10%。

**利用方式：**

1.  **信息收集：** 使用 `GeoServer_Path-Finder.py` 扫描目标网络，查找运行Geoserver的实例。
2.  **验证服务：** 找到Geoserver实例后,通过访问`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`路径验证Geoserver服务是否存在。
3.  **SQL注入：** 确定存在漏洞的GeoServer实例后，利用OGC Filter表达式语言或CQL中的SQL注入点，构造恶意的SQL查询语句，发送到服务器。
4.  **数据窃取/代码执行：** 成功注入后，根据具体的注入点和数据库配置，可以读取敏感数据、修改数据库内容，甚至执行任意代码。

**项目地址:** [0x2458bughunt/CVE-2023-25157](https://github.com/0x2458bughunt/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #2

**来源**: [CVE-2023-25157-7imbitz_CVE-2023-25157-checker.md](../2023/CVE-2023-25157-7imbitz_CVE-2023-25157-checker.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 严重，可导致数据泄露、篡改、拒绝服务，甚至远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要能够访问存在漏洞的GeoServer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。根据漏洞库信息，该漏洞存在于OGC Filter表达式语言和OGC Common Query Language (CQL) 中，影响Web Feature Service (WFS)和Web Map Service (WMS) 协议，以及Web Coverage Service (WCS) 协议的ImageMosaic覆盖。搜索引擎结果也证实了该漏洞的存在，并提供了相关的分析报告和修复建议。漏洞利用代码（Go语言编写的POC）首先检查GeoServer实例是否存活，然后尝试列出可用的feature names，接着针对每个feature name, 结合CQL_FILTER，尝试使用`strEndsWith` 函数注入恶意的SQL语句。这个恶意SQL尝试执行 `SELECT current_user`。由于Go语言代码本身主要用于验证和利用漏洞，不存在明显的后门或者恶意代码。但需要注意的是，该POC代码可能被恶意使用者修改后进行传播，加入恶意代码，因此存在一定的投毒风险。该漏洞利用方式主要依赖于构造恶意的CQL_FILTER，其中包含SQL注入语句，如果GeoServer实例未能正确过滤或转义这些输入，则可能执行攻击者构造的SQL查询，导致信息泄露或权限提升。

**项目地址:** [7imbitz/CVE-2023-25157-checker](https://github.com/7imbitz/CVE-2023-25157-checker)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #3

**来源**: [CVE-2023-25157-Rubikcuv5_CVE-2023-25157.md](../2023/CVE-2023-25157-Rubikcuv5_CVE-2023-25157.md)

# CVE-2023-25157

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-25157-0x2458bughunt_CVE-2023-25157.md](../2023/CVE-2023-25157-0x2458bughunt_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问到存在漏洞的GeoServer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。根据漏洞库信息，该漏洞存在于2.22.0到2.22.2之前的版本以及2.21.4之前的版本。搜索引擎结果也确认了该漏洞的存在，并提供了相关的分析和检测方法。提供的POC代码包含两个Python脚本：

*   `GeoServer_Path-Finder.py`: 这个脚本用于检测目标主机上是否存在GeoServer的WFS服务，通过访问`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`路径来判断。如果返回状态码为200，则认为服务存在，并将URL写入到输出文件中。
*   `GeoServer_Keyword-Checker.py`: 这个脚本用于检查目标网站的响应内容中是否包含特定的关键词，例如`<Title>GeoServer Web Feature Service</Title>`，用于验证GeoServer是否运行，但该脚本和SQL注入漏洞本身关联不大.

虽然提供的Python脚本本身并不直接利用SQL注入漏洞，但是它们可以作为漏洞利用的前期侦察手段，用于发现目标环境中存在的GeoServer实例。找到目标实例后，攻击者可以利用CQL注入点构造恶意的SQL查询，从而读取数据库信息甚至执行任意代码。

**有效性：**

提供的脚本本身并不能直接利用SQL注入，但可以作为漏洞利用前期信息收集的辅助工具。其有效性体现在能够快速识别目标网络中运行的Geoserver服务。

**投毒风险：**

通过分析代码，发现投毒风险较低。`GeoServer_Path-Finder.py` 和 `GeoServer_Keyword-Checker.py` 的主要功能是发送HTTP请求并检查响应。虽然存在通过hosts文件传入目标地址，但该操作属于脚本的正常功能，而非恶意代码植入。脚本对输入的主机列表没有做任何过滤和校验，如果攻击者控制了hosts文件，是有可能通过注入恶意链接来redirect到其他站点，造成信息泄露或者XSS。所以风险评估为10%。

**利用方式：**

1.  **信息收集：** 使用 `GeoServer_Path-Finder.py` 扫描目标网络，查找运行Geoserver的实例。
2.  **验证服务：** 找到Geoserver实例后,通过访问`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`路径验证Geoserver服务是否存在。
3.  **SQL注入：** 确定存在漏洞的GeoServer实例后，利用OGC Filter表达式语言或CQL中的SQL注入点，构造恶意的SQL查询语句，发送到服务器。
4.  **数据窃取/代码执行：** 成功注入后，根据具体的注入点和数据库配置，可以读取敏感数据、修改数据库内容，甚至执行任意代码。

**项目地址:** [0x2458bughunt/CVE-2023-25157](https://github.com/0x2458bughunt/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #2

**来源**: [CVE-2023-25157-7imbitz_CVE-2023-25157-checker.md](../2023/CVE-2023-25157-7imbitz_CVE-2023-25157-checker.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 严重，可导致数据泄露、篡改、拒绝服务，甚至远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要能够访问存在漏洞的GeoServer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。根据漏洞库信息，该漏洞存在于OGC Filter表达式语言和OGC Common Query Language (CQL) 中，影响Web Feature Service (WFS)和Web Map Service (WMS) 协议，以及Web Coverage Service (WCS) 协议的ImageMosaic覆盖。搜索引擎结果也证实了该漏洞的存在，并提供了相关的分析报告和修复建议。漏洞利用代码（Go语言编写的POC）首先检查GeoServer实例是否存活，然后尝试列出可用的feature names，接着针对每个feature name, 结合CQL_FILTER，尝试使用`strEndsWith` 函数注入恶意的SQL语句。这个恶意SQL尝试执行 `SELECT current_user`。由于Go语言代码本身主要用于验证和利用漏洞，不存在明显的后门或者恶意代码。但需要注意的是，该POC代码可能被恶意使用者修改后进行传播，加入恶意代码，因此存在一定的投毒风险。该漏洞利用方式主要依赖于构造恶意的CQL_FILTER，其中包含SQL注入语句，如果GeoServer实例未能正确过滤或转义这些输入，则可能执行攻击者构造的SQL查询，导致信息泄露或权限提升。

**项目地址:** [7imbitz/CVE-2023-25157-checker](https://github.com/7imbitz/CVE-2023-25157-checker)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #3

**来源**: [CVE-2023-25157-Rubikcuv5_CVE-2023-25157.md](../2023/CVE-2023-25157-Rubikcuv5_CVE-2023-25157.md)

# CVE-2023-25157

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-25157-0x2458bughunt_CVE-2023-25157.md](../2023/CVE-2023-25157-0x2458bughunt_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问到存在漏洞的GeoServer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。根据漏洞库信息，该漏洞存在于2.22.0到2.22.2之前的版本以及2.21.4之前的版本。搜索引擎结果也确认了该漏洞的存在，并提供了相关的分析和检测方法。提供的POC代码包含两个Python脚本：

*   `GeoServer_Path-Finder.py`: 这个脚本用于检测目标主机上是否存在GeoServer的WFS服务，通过访问`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`路径来判断。如果返回状态码为200，则认为服务存在，并将URL写入到输出文件中。
*   `GeoServer_Keyword-Checker.py`: 这个脚本用于检查目标网站的响应内容中是否包含特定的关键词，例如`<Title>GeoServer Web Feature Service</Title>`，用于验证GeoServer是否运行，但该脚本和SQL注入漏洞本身关联不大.

虽然提供的Python脚本本身并不直接利用SQL注入漏洞，但是它们可以作为漏洞利用的前期侦察手段，用于发现目标环境中存在的GeoServer实例。找到目标实例后，攻击者可以利用CQL注入点构造恶意的SQL查询，从而读取数据库信息甚至执行任意代码。

**有效性：**

提供的脚本本身并不能直接利用SQL注入，但可以作为漏洞利用前期信息收集的辅助工具。其有效性体现在能够快速识别目标网络中运行的Geoserver服务。

**投毒风险：**

通过分析代码，发现投毒风险较低。`GeoServer_Path-Finder.py` 和 `GeoServer_Keyword-Checker.py` 的主要功能是发送HTTP请求并检查响应。虽然存在通过hosts文件传入目标地址，但该操作属于脚本的正常功能，而非恶意代码植入。脚本对输入的主机列表没有做任何过滤和校验，如果攻击者控制了hosts文件，是有可能通过注入恶意链接来redirect到其他站点，造成信息泄露或者XSS。所以风险评估为10%。

**利用方式：**

1.  **信息收集：** 使用 `GeoServer_Path-Finder.py` 扫描目标网络，查找运行Geoserver的实例。
2.  **验证服务：** 找到Geoserver实例后,通过访问`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`路径验证Geoserver服务是否存在。
3.  **SQL注入：** 确定存在漏洞的GeoServer实例后，利用OGC Filter表达式语言或CQL中的SQL注入点，构造恶意的SQL查询语句，发送到服务器。
4.  **数据窃取/代码执行：** 成功注入后，根据具体的注入点和数据库配置，可以读取敏感数据、修改数据库内容，甚至执行任意代码。

**项目地址:** [0x2458bughunt/CVE-2023-25157](https://github.com/0x2458bughunt/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #2

**来源**: [CVE-2023-25157-7imbitz_CVE-2023-25157-checker.md](../2023/CVE-2023-25157-7imbitz_CVE-2023-25157-checker.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 严重，可导致数据泄露、篡改、拒绝服务，甚至远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要能够访问存在漏洞的GeoServer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。根据漏洞库信息，该漏洞存在于OGC Filter表达式语言和OGC Common Query Language (CQL) 中，影响Web Feature Service (WFS)和Web Map Service (WMS) 协议，以及Web Coverage Service (WCS) 协议的ImageMosaic覆盖。搜索引擎结果也证实了该漏洞的存在，并提供了相关的分析报告和修复建议。漏洞利用代码（Go语言编写的POC）首先检查GeoServer实例是否存活，然后尝试列出可用的feature names，接着针对每个feature name, 结合CQL_FILTER，尝试使用`strEndsWith` 函数注入恶意的SQL语句。这个恶意SQL尝试执行 `SELECT current_user`。由于Go语言代码本身主要用于验证和利用漏洞，不存在明显的后门或者恶意代码。但需要注意的是，该POC代码可能被恶意使用者修改后进行传播，加入恶意代码，因此存在一定的投毒风险。该漏洞利用方式主要依赖于构造恶意的CQL_FILTER，其中包含SQL注入语句，如果GeoServer实例未能正确过滤或转义这些输入，则可能执行攻击者构造的SQL查询，导致信息泄露或权限提升。

**项目地址:** [7imbitz/CVE-2023-25157-checker](https://github.com/7imbitz/CVE-2023-25157-checker)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #3

**来源**: [CVE-2023-25157-Rubikcuv5_CVE-2023-25157.md](../2023/CVE-2023-25157-Rubikcuv5_CVE-2023-25157.md)

# CVE-2023-25157

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-25157-0x2458bughunt_CVE-2023-25157.md](../2023/CVE-2023-25157-0x2458bughunt_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问到存在漏洞的GeoServer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。根据漏洞库信息，该漏洞存在于2.22.0到2.22.2之前的版本以及2.21.4之前的版本。搜索引擎结果也确认了该漏洞的存在，并提供了相关的分析和检测方法。提供的POC代码包含两个Python脚本：

*   `GeoServer_Path-Finder.py`: 这个脚本用于检测目标主机上是否存在GeoServer的WFS服务，通过访问`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`路径来判断。如果返回状态码为200，则认为服务存在，并将URL写入到输出文件中。
*   `GeoServer_Keyword-Checker.py`: 这个脚本用于检查目标网站的响应内容中是否包含特定的关键词，例如`<Title>GeoServer Web Feature Service</Title>`，用于验证GeoServer是否运行，但该脚本和SQL注入漏洞本身关联不大.

虽然提供的Python脚本本身并不直接利用SQL注入漏洞，但是它们可以作为漏洞利用的前期侦察手段，用于发现目标环境中存在的GeoServer实例。找到目标实例后，攻击者可以利用CQL注入点构造恶意的SQL查询，从而读取数据库信息甚至执行任意代码。

**有效性：**

提供的脚本本身并不能直接利用SQL注入，但可以作为漏洞利用前期信息收集的辅助工具。其有效性体现在能够快速识别目标网络中运行的Geoserver服务。

**投毒风险：**

通过分析代码，发现投毒风险较低。`GeoServer_Path-Finder.py` 和 `GeoServer_Keyword-Checker.py` 的主要功能是发送HTTP请求并检查响应。虽然存在通过hosts文件传入目标地址，但该操作属于脚本的正常功能，而非恶意代码植入。脚本对输入的主机列表没有做任何过滤和校验，如果攻击者控制了hosts文件，是有可能通过注入恶意链接来redirect到其他站点，造成信息泄露或者XSS。所以风险评估为10%。

**利用方式：**

1.  **信息收集：** 使用 `GeoServer_Path-Finder.py` 扫描目标网络，查找运行Geoserver的实例。
2.  **验证服务：** 找到Geoserver实例后,通过访问`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`路径验证Geoserver服务是否存在。
3.  **SQL注入：** 确定存在漏洞的GeoServer实例后，利用OGC Filter表达式语言或CQL中的SQL注入点，构造恶意的SQL查询语句，发送到服务器。
4.  **数据窃取/代码执行：** 成功注入后，根据具体的注入点和数据库配置，可以读取敏感数据、修改数据库内容，甚至执行任意代码。

**项目地址:** [0x2458bughunt/CVE-2023-25157](https://github.com/0x2458bughunt/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #2

**来源**: [CVE-2023-25157-7imbitz_CVE-2023-25157-checker.md](../2023/CVE-2023-25157-7imbitz_CVE-2023-25157-checker.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 严重，可导致数据泄露、篡改、拒绝服务，甚至远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要能够访问存在漏洞的GeoServer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。根据漏洞库信息，该漏洞存在于OGC Filter表达式语言和OGC Common Query Language (CQL) 中，影响Web Feature Service (WFS)和Web Map Service (WMS) 协议，以及Web Coverage Service (WCS) 协议的ImageMosaic覆盖。搜索引擎结果也证实了该漏洞的存在，并提供了相关的分析报告和修复建议。漏洞利用代码（Go语言编写的POC）首先检查GeoServer实例是否存活，然后尝试列出可用的feature names，接着针对每个feature name, 结合CQL_FILTER，尝试使用`strEndsWith` 函数注入恶意的SQL语句。这个恶意SQL尝试执行 `SELECT current_user`。由于Go语言代码本身主要用于验证和利用漏洞，不存在明显的后门或者恶意代码。但需要注意的是，该POC代码可能被恶意使用者修改后进行传播，加入恶意代码，因此存在一定的投毒风险。该漏洞利用方式主要依赖于构造恶意的CQL_FILTER，其中包含SQL注入语句，如果GeoServer实例未能正确过滤或转义这些输入，则可能执行攻击者构造的SQL查询，导致信息泄露或权限提升。

**项目地址:** [7imbitz/CVE-2023-25157-checker](https://github.com/7imbitz/CVE-2023-25157-checker)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #3

**来源**: [CVE-2023-25157-Rubikcuv5_CVE-2023-25157.md](../2023/CVE-2023-25157-Rubikcuv5_CVE-2023-25157.md)

# CVE-2023-25157

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2023-25157-0x2458bughunt_CVE-2023-25157.md](../2023/CVE-2023-25157-0x2458bughunt_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问到存在漏洞的GeoServer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。根据漏洞库信息，该漏洞存在于2.22.0到2.22.2之前的版本以及2.21.4之前的版本。搜索引擎结果也确认了该漏洞的存在，并提供了相关的分析和检测方法。提供的POC代码包含两个Python脚本：

*   `GeoServer_Path-Finder.py`: 这个脚本用于检测目标主机上是否存在GeoServer的WFS服务，通过访问`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`路径来判断。如果返回状态码为200，则认为服务存在，并将URL写入到输出文件中。
*   `GeoServer_Keyword-Checker.py`: 这个脚本用于检查目标网站的响应内容中是否包含特定的关键词，例如`<Title>GeoServer Web Feature Service</Title>`，用于验证GeoServer是否运行，但该脚本和SQL注入漏洞本身关联不大.

虽然提供的Python脚本本身并不直接利用SQL注入漏洞，但是它们可以作为漏洞利用的前期侦察手段，用于发现目标环境中存在的GeoServer实例。找到目标实例后，攻击者可以利用CQL注入点构造恶意的SQL查询，从而读取数据库信息甚至执行任意代码。

**有效性：**

提供的脚本本身并不能直接利用SQL注入，但可以作为漏洞利用前期信息收集的辅助工具。其有效性体现在能够快速识别目标网络中运行的Geoserver服务。

**投毒风险：**

通过分析代码，发现投毒风险较低。`GeoServer_Path-Finder.py` 和 `GeoServer_Keyword-Checker.py` 的主要功能是发送HTTP请求并检查响应。虽然存在通过hosts文件传入目标地址，但该操作属于脚本的正常功能，而非恶意代码植入。脚本对输入的主机列表没有做任何过滤和校验，如果攻击者控制了hosts文件，是有可能通过注入恶意链接来redirect到其他站点，造成信息泄露或者XSS。所以风险评估为10%。

**利用方式：**

1.  **信息收集：** 使用 `GeoServer_Path-Finder.py` 扫描目标网络，查找运行Geoserver的实例。
2.  **验证服务：** 找到Geoserver实例后,通过访问`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`路径验证Geoserver服务是否存在。
3.  **SQL注入：** 确定存在漏洞的GeoServer实例后，利用OGC Filter表达式语言或CQL中的SQL注入点，构造恶意的SQL查询语句，发送到服务器。
4.  **数据窃取/代码执行：** 成功注入后，根据具体的注入点和数据库配置，可以读取敏感数据、修改数据库内容，甚至执行任意代码。

**项目地址:** [0x2458bughunt/CVE-2023-25157](https://github.com/0x2458bughunt/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #2

**来源**: [CVE-2023-25157-7imbitz_CVE-2023-25157-checker.md](../2023/CVE-2023-25157-7imbitz_CVE-2023-25157-checker.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 严重，可导致数据泄露、篡改、拒绝服务，甚至远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要能够访问存在漏洞的GeoServer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。根据漏洞库信息，该漏洞存在于OGC Filter表达式语言和OGC Common Query Language (CQL) 中，影响Web Feature Service (WFS)和Web Map Service (WMS) 协议，以及Web Coverage Service (WCS) 协议的ImageMosaic覆盖。搜索引擎结果也证实了该漏洞的存在，并提供了相关的分析报告和修复建议。漏洞利用代码（Go语言编写的POC）首先检查GeoServer实例是否存活，然后尝试列出可用的feature names，接着针对每个feature name, 结合CQL_FILTER，尝试使用`strEndsWith` 函数注入恶意的SQL语句。这个恶意SQL尝试执行 `SELECT current_user`。由于Go语言代码本身主要用于验证和利用漏洞，不存在明显的后门或者恶意代码。但需要注意的是，该POC代码可能被恶意使用者修改后进行传播，加入恶意代码，因此存在一定的投毒风险。该漏洞利用方式主要依赖于构造恶意的CQL_FILTER，其中包含SQL注入语句，如果GeoServer实例未能正确过滤或转义这些输入，则可能执行攻击者构造的SQL查询，导致信息泄露或权限提升。

**项目地址:** [7imbitz/CVE-2023-25157-checker](https://github.com/7imbitz/CVE-2023-25157-checker)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #3

**来源**: [CVE-2023-25157-charis3306_CVE-2023-25157.md](../2023/CVE-2023-25157-charis3306_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致敏感信息泄露、数据篡改、甚至服务器权限获取

**影响版本:** 2.20.x < 2.20.7, 2.19.x < 2.19.7, 2.18.x < 2.18.7, 2.21.x < 2.21.4, 2.22.x < 2.22.2

**利用条件:** GeoServer服务开启，目标存在漏洞版本，且允许未授权网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。由于GeoServer对用户输入过滤不严格，远程未授权攻击者可以构造畸形的过滤语法，绕过GeoServer的词法解析，从而造成SQL注入。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的利用是有效的。PoC代码中提供了利用此漏洞的请求示例，以及用于自动化检测的Python脚本。

**投毒风险：**
虽然提供的Python脚本主要功能是利用SQL注入漏洞，但仍存在一定的投毒风险。风险点在于`PROXY`变量的使用。如果攻击者修改了脚本中的代理地址，例如设置为一个恶意代理服务器，则可以通过该代理服务器捕获或篡改经过该代理的流量。例如脚本片段：
`PROXY = "http://127.0.0.1:8080/" if False else None`
如果将`False`修改为`True`， 并且用户使用了恶意的代理，则可能被投毒。此外，如果脚本被修改为执行恶意代码（例如下载和执行其他程序），则存在更大的风险。总体来说，投毒风险较低，约为10%，主要取决于用户是否会使用来路不明的代理或修改脚本本身。

**利用方式：**
利用方式如下：
1.  **获取可用功能名称：** 通过发送`GetCapabilities`请求到`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`端点，获取GeoServer支持的WFS功能名称。
2.  **获取相关功能可用属性：** 针对特定功能名称，例如`vulhub:example`，发送`DescribeFeatureType`请求到`/geoserver/wfs?request=DescribeFeatureType&version=2.0.0&service=WFS&outputFormat=application/json&typeName=vulhub:example`端点，获取该功能的可用属性列表。
3.  **构造SQL注入Payload：** 针对特定属性，构造包含SQL注入的`CQL_FILTER`参数，发送`GetFeature`请求到`/geoserver/ows`端点。例如：
`/geoserver/ows?service=wfs&version=1.0.0&request=GetFeature&typeName=vulhub:example&CQL_FILTER=strStartsWith(name,'x'')+=+true+and+1=(SELECT+CAST+((SELECT+version())+AS+INTEGER))+--+')+=+true`
此payload利用了`strStartsWith`函数和`CQL_FILTER`参数，注入SQL代码来执行数据库操作，如获取数据库版本信息。
4.  **验证与自动化：** 提供的`exp.py`脚本自动化了上述过程。它首先从目标GeoServer获取功能列表和属性，然后针对每个属性构造SQL注入payload，并检查响应中是否包含错误信息，以此判断漏洞是否存在。

**项目地址:** [charis3306/CVE-2023-25157](https://github.com/charis3306/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #4

**来源**: [CVE-2023-25157-custiya_geoserver-CVE-2023-25157.md](../2023/CVE-2023-25157-custiya_geoserver-CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，GeoServer实例运行，存在可访问的WFS/WMS/WCS服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-25157是GeoServer中的一个SQL注入漏洞。漏洞存在于OGC Filter表达式语言和OGC Common Query Language (CQL) 的处理中，影响Web Feature Service (WFS)、Web Map Service (WMS) 协议以及Web Coverage Service (WCS)协议中ImageMosaic coverages对CQL的支持。

**有效性：**
提供的`docker-compose.yml`文件设置了一个包含易受攻击的GeoServer实例(2.22.1)的环境，它依赖于PostGIS数据库。 `startup.sh`启动脚本如果包含恶意代码，则能成功搭建环境并执行攻击，验证此漏洞的存在。综合搜索引擎结果和漏洞库信息,漏洞利用是有效的。

**投毒风险：**
`docker-compose.yml` 文件本身并不包含恶意代码，但它挂载了`./startup.sh`脚本，这引入了投毒的可能。如果 `startup.sh` 包含任何恶意指令 (例如下载并执行恶意脚本、修改GeoServer配置以允许未授权访问、或安装后门)，那么该仓库就存在投毒风险。在没有`startup.sh` 脚本内容的情况下，无法完全确定投毒的程度，推测投毒概率为10%。 谨慎使用此仓库。

**利用方式：**
该漏洞的利用方式通常涉及构造恶意的CQL或OGC Filter表达式，将其注入到WFS/WMS/WCS请求的参数中。由于GeoServer没有正确过滤这些表达式，恶意SQL代码会被执行，从而可能允许攻击者执行任意SQL命令，包括读取、修改或删除数据库中的数据，甚至执行操作系统命令（如果数据库配置允许）。攻击者可能通过 `PropertyIsLike` filter（配合String字段和任意数据库DataStore，或PostGIS DataStore且开启 encode functions）或 `FeatureId` 配合不安全的设置触发漏洞。修复方案包括升级到指定版本或禁用/启用相应的PostGIS Datastore设置。

**项目地址:** [custiya/geoserver-CVE-2023-25157](https://github.com/custiya/geoserver-CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #5

**来源**: [CVE-2023-25157-dr-cable-tv_Geoserver-CVE-2023-25157.md](../2023/CVE-2023-25157-dr-cable-tv_Geoserver-CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，目标GeoServer实例存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞是GeoServer中的SQL注入漏洞，源于对OGC Filter表达式语言和OGC Common Query Language (CQL) 的不当处理。攻击者可以通过构造恶意的CQL_FILTER参数，利用`strEndsWith`，`strStartsWith`和`PropertyIsLike`函数，或者`FeatureId`绕过防御，执行任意SQL查询。

**有效性：**
根据提供的漏洞库信息和搜索引擎结果，此漏洞影响特定版本的GeoServer，且有可用的PoC代码。PoC代码通过构造恶意的CQL_FILTER参数进行攻击，尝试注入SQL语句以获取数据库版本信息。提供的`dbFinder.py`脚本首先尝试连接到目标GeoServer实例，然后获取FeatureType名称，并使用精心构造的CQL_FILTER尝试执行SQL注入。PoC代码有效。

**投毒风险：**
分析提供的PoC代码，`dbFinder.py` 主要功能是检测目标是否存在漏洞，其核心在于构造恶意的CQL_FILTER，没有发现明显的恶意行为或后门代码。`README.md` 只是提供了漏洞说明和使用方法。投毒风险较低，但仍需注意，因为任何从互联网上获取的代码都存在潜在风险，建议在使用前进行代码审查。 此处的投毒风险主要考虑作者是否在代码中隐藏了其他恶意行为，例如上传敏感信息等。鉴于代码功能较为简单，且主要依赖于SQL注入，因此判断投毒可能性较低，为5%。

**利用方式：**
1.  攻击者首先需要确定目标GeoServer实例的版本是否在受影响范围内（< 2.21.4, >= 2.22.0, < 2.22.2）。
2.  利用提供的PoC脚本或者其他方式，构造包含恶意SQL语句的CQL_FILTER参数。
3.  将构造的CQL_FILTER参数附加到WFS GetFeature请求中，例如：
    `/geoserver/ows?service=wfs&version=1.0.0&request=GetFeature&typeName=<featureType>&CQL_FILTER=<恶意CQL_FILTER>`
4.  如果目标存在漏洞，恶意SQL语句将被执行，攻击者可以获取数据库中的敏感信息，甚至执行任意代码。

**缓解措施：**
*   升级GeoServer到不受影响的版本（>= 2.21.4 或 >= 2.22.2）。
*   如果无法升级，禁用PostGIS Datastore的*encode functions*设置，并启用*preparedStatements*设置。

**项目地址:** [dr-cable-tv/Geoserver-CVE-2023-25157](https://github.com/dr-cable-tv/Geoserver-CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #6

**来源**: [CVE-2023-25157-murataydemir_CVE-2023-25157-and-CVE-2023-25158.md](../2023/CVE-2023-25157-murataydemir_CVE-2023-25157-and-CVE-2023-25158.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致未授权信息泄露、数据篡改和服务中断

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要GeoServer实例运行，且满足特定配置条件，例如PostGIS DataStore启用encode functions，或数据库表具有String主键列且prepared statements被禁用等。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的SQL注入漏洞，利用OGC Filter表达式语言和CQL（Common Query Language）的不当处理。根据漏洞利用代码描述，多个函数和过滤器都存在注入点：

*   `PropertyIsLike` filter: 当与String字段一起使用时，任何关系数据库的存储都会受到影响；PostGIS DataStore启用encode functions；或者image mosaic的索引存储在关系数据库中。
*   `strEndsWith` function: 当与PostGIS DataStore一起使用且encode functions启用时。
*   `strStartsWith` function: 当与PostGIS DataStore一起使用且encode functions启用时。
*   `FeatureId` filter: 当数据库表的String主键列使用时且prepared statements禁用时。
*   `jsonArrayContains` function: 当与String或JSON字段一起使用且与PostGIS或Oracle DataStore（仅在GeoServer 2.22.0及更高版本中）一起使用时。
*   `DWithin` filter: 当与Oracle DataStore一起使用时。

利用方式包括构造恶意的OGC Filter或CQL表达式，通过WFS、WMS或WCS协议发送给GeoServer，从而执行任意SQL命令。这可能导致敏感数据泄露、数据修改甚至服务中断。提供的POC代码库包含漏洞的详细描述和复现步骤，表明该漏洞的有效性较高。搜索引擎结果也证实了该漏洞的存在和危害。

关于投毒风险，由于POC代码只是提供漏洞复现和利用的步骤，主要关注点在于利用方式，并无发现明显的恶意代码，比如下载执行恶意脚本，上传恶意文件等操作。但是，如果攻击者修改了提供的POC并植入恶意代码，使用户在测试时受到攻击，则存在一定投毒风险。因此，将投毒风险评估为10%。

**项目地址:** [murataydemir/CVE-2023-25157-and-CVE-2023-25158](https://github.com/murataydemir/CVE-2023-25157-and-CVE-2023-25158)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #7

**来源**: [CVE-2023-25157-win3zz_CVE-2023-25157.md](../2023/CVE-2023-25157-win3zz_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，GeoServer服务开启，目标存在漏洞版本的GeoServer

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞，存在于OGC Filter表达式语言和OGC Common Query Language (CQL)的支持中。攻击者可以通过WFS和WMS协议，或者WCS协议（针对ImageMosaic覆盖），注入恶意的SQL代码。PoC代码通过构造包含恶意SQL语句的CQL_FILTER参数，发送到存在漏洞的GeoServer实例，利用`strStartsWith`等函数进行SQL注入。虽然代码整体上是用于验证漏洞的，但存在潜在投毒风险，例如，攻击者可能会修改PoC，使其包含更具破坏性的SQL payload，或者在大型环境中分发这些修改后的PoC，达到攻击的目的。代码本身的危害较小，但被恶意修改后风险增大。

**项目地址:** [win3zz/CVE-2023-25157](https://github.com/win3zz/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---



---

## POC #4

**来源**: [CVE-2023-25157-charis3306_CVE-2023-25157.md](../2023/CVE-2023-25157-charis3306_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致敏感信息泄露、数据篡改、甚至服务器权限获取

**影响版本:** 2.20.x < 2.20.7, 2.19.x < 2.19.7, 2.18.x < 2.18.7, 2.21.x < 2.21.4, 2.22.x < 2.22.2

**利用条件:** GeoServer服务开启，目标存在漏洞版本，且允许未授权网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。由于GeoServer对用户输入过滤不严格，远程未授权攻击者可以构造畸形的过滤语法，绕过GeoServer的词法解析，从而造成SQL注入。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的利用是有效的。PoC代码中提供了利用此漏洞的请求示例，以及用于自动化检测的Python脚本。

**投毒风险：**
虽然提供的Python脚本主要功能是利用SQL注入漏洞，但仍存在一定的投毒风险。风险点在于`PROXY`变量的使用。如果攻击者修改了脚本中的代理地址，例如设置为一个恶意代理服务器，则可以通过该代理服务器捕获或篡改经过该代理的流量。例如脚本片段：
`PROXY = "http://127.0.0.1:8080/" if False else None`
如果将`False`修改为`True`， 并且用户使用了恶意的代理，则可能被投毒。此外，如果脚本被修改为执行恶意代码（例如下载和执行其他程序），则存在更大的风险。总体来说，投毒风险较低，约为10%，主要取决于用户是否会使用来路不明的代理或修改脚本本身。

**利用方式：**
利用方式如下：
1.  **获取可用功能名称：** 通过发送`GetCapabilities`请求到`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`端点，获取GeoServer支持的WFS功能名称。
2.  **获取相关功能可用属性：** 针对特定功能名称，例如`vulhub:example`，发送`DescribeFeatureType`请求到`/geoserver/wfs?request=DescribeFeatureType&version=2.0.0&service=WFS&outputFormat=application/json&typeName=vulhub:example`端点，获取该功能的可用属性列表。
3.  **构造SQL注入Payload：** 针对特定属性，构造包含SQL注入的`CQL_FILTER`参数，发送`GetFeature`请求到`/geoserver/ows`端点。例如：
`/geoserver/ows?service=wfs&version=1.0.0&request=GetFeature&typeName=vulhub:example&CQL_FILTER=strStartsWith(name,'x'')+=+true+and+1=(SELECT+CAST+((SELECT+version())+AS+INTEGER))+--+')+=+true`
此payload利用了`strStartsWith`函数和`CQL_FILTER`参数，注入SQL代码来执行数据库操作，如获取数据库版本信息。
4.  **验证与自动化：** 提供的`exp.py`脚本自动化了上述过程。它首先从目标GeoServer获取功能列表和属性，然后针对每个属性构造SQL注入payload，并检查响应中是否包含错误信息，以此判断漏洞是否存在。

**项目地址:** [charis3306/CVE-2023-25157](https://github.com/charis3306/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #5

**来源**: [CVE-2023-25157-custiya_geoserver-CVE-2023-25157.md](../2023/CVE-2023-25157-custiya_geoserver-CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，GeoServer实例运行，存在可访问的WFS/WMS/WCS服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-25157是GeoServer中的一个SQL注入漏洞。漏洞存在于OGC Filter表达式语言和OGC Common Query Language (CQL) 的处理中，影响Web Feature Service (WFS)、Web Map Service (WMS) 协议以及Web Coverage Service (WCS)协议中ImageMosaic coverages对CQL的支持。

**有效性：**
提供的`docker-compose.yml`文件设置了一个包含易受攻击的GeoServer实例(2.22.1)的环境，它依赖于PostGIS数据库。 `startup.sh`启动脚本如果包含恶意代码，则能成功搭建环境并执行攻击，验证此漏洞的存在。综合搜索引擎结果和漏洞库信息,漏洞利用是有效的。

**投毒风险：**
`docker-compose.yml` 文件本身并不包含恶意代码，但它挂载了`./startup.sh`脚本，这引入了投毒的可能。如果 `startup.sh` 包含任何恶意指令 (例如下载并执行恶意脚本、修改GeoServer配置以允许未授权访问、或安装后门)，那么该仓库就存在投毒风险。在没有`startup.sh` 脚本内容的情况下，无法完全确定投毒的程度，推测投毒概率为10%。 谨慎使用此仓库。

**利用方式：**
该漏洞的利用方式通常涉及构造恶意的CQL或OGC Filter表达式，将其注入到WFS/WMS/WCS请求的参数中。由于GeoServer没有正确过滤这些表达式，恶意SQL代码会被执行，从而可能允许攻击者执行任意SQL命令，包括读取、修改或删除数据库中的数据，甚至执行操作系统命令（如果数据库配置允许）。攻击者可能通过 `PropertyIsLike` filter（配合String字段和任意数据库DataStore，或PostGIS DataStore且开启 encode functions）或 `FeatureId` 配合不安全的设置触发漏洞。修复方案包括升级到指定版本或禁用/启用相应的PostGIS Datastore设置。

**项目地址:** [custiya/geoserver-CVE-2023-25157](https://github.com/custiya/geoserver-CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #6

**来源**: [CVE-2023-25157-dr-cable-tv_Geoserver-CVE-2023-25157.md](../2023/CVE-2023-25157-dr-cable-tv_Geoserver-CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，目标GeoServer实例存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞是GeoServer中的SQL注入漏洞，源于对OGC Filter表达式语言和OGC Common Query Language (CQL) 的不当处理。攻击者可以通过构造恶意的CQL_FILTER参数，利用`strEndsWith`，`strStartsWith`和`PropertyIsLike`函数，或者`FeatureId`绕过防御，执行任意SQL查询。

**有效性：**
根据提供的漏洞库信息和搜索引擎结果，此漏洞影响特定版本的GeoServer，且有可用的PoC代码。PoC代码通过构造恶意的CQL_FILTER参数进行攻击，尝试注入SQL语句以获取数据库版本信息。提供的`dbFinder.py`脚本首先尝试连接到目标GeoServer实例，然后获取FeatureType名称，并使用精心构造的CQL_FILTER尝试执行SQL注入。PoC代码有效。

**投毒风险：**
分析提供的PoC代码，`dbFinder.py` 主要功能是检测目标是否存在漏洞，其核心在于构造恶意的CQL_FILTER，没有发现明显的恶意行为或后门代码。`README.md` 只是提供了漏洞说明和使用方法。投毒风险较低，但仍需注意，因为任何从互联网上获取的代码都存在潜在风险，建议在使用前进行代码审查。 此处的投毒风险主要考虑作者是否在代码中隐藏了其他恶意行为，例如上传敏感信息等。鉴于代码功能较为简单，且主要依赖于SQL注入，因此判断投毒可能性较低，为5%。

**利用方式：**
1.  攻击者首先需要确定目标GeoServer实例的版本是否在受影响范围内（< 2.21.4, >= 2.22.0, < 2.22.2）。
2.  利用提供的PoC脚本或者其他方式，构造包含恶意SQL语句的CQL_FILTER参数。
3.  将构造的CQL_FILTER参数附加到WFS GetFeature请求中，例如：
    `/geoserver/ows?service=wfs&version=1.0.0&request=GetFeature&typeName=<featureType>&CQL_FILTER=<恶意CQL_FILTER>`
4.  如果目标存在漏洞，恶意SQL语句将被执行，攻击者可以获取数据库中的敏感信息，甚至执行任意代码。

**缓解措施：**
*   升级GeoServer到不受影响的版本（>= 2.21.4 或 >= 2.22.2）。
*   如果无法升级，禁用PostGIS Datastore的*encode functions*设置，并启用*preparedStatements*设置。

**项目地址:** [dr-cable-tv/Geoserver-CVE-2023-25157](https://github.com/dr-cable-tv/Geoserver-CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #7

**来源**: [CVE-2023-25157-murataydemir_CVE-2023-25157-and-CVE-2023-25158.md](../2023/CVE-2023-25157-murataydemir_CVE-2023-25157-and-CVE-2023-25158.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致未授权信息泄露、数据篡改和服务中断

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要GeoServer实例运行，且满足特定配置条件，例如PostGIS DataStore启用encode functions，或数据库表具有String主键列且prepared statements被禁用等。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的SQL注入漏洞，利用OGC Filter表达式语言和CQL（Common Query Language）的不当处理。根据漏洞利用代码描述，多个函数和过滤器都存在注入点：

*   `PropertyIsLike` filter: 当与String字段一起使用时，任何关系数据库的存储都会受到影响；PostGIS DataStore启用encode functions；或者image mosaic的索引存储在关系数据库中。
*   `strEndsWith` function: 当与PostGIS DataStore一起使用且encode functions启用时。
*   `strStartsWith` function: 当与PostGIS DataStore一起使用且encode functions启用时。
*   `FeatureId` filter: 当数据库表的String主键列使用时且prepared statements禁用时。
*   `jsonArrayContains` function: 当与String或JSON字段一起使用且与PostGIS或Oracle DataStore（仅在GeoServer 2.22.0及更高版本中）一起使用时。
*   `DWithin` filter: 当与Oracle DataStore一起使用时。

利用方式包括构造恶意的OGC Filter或CQL表达式，通过WFS、WMS或WCS协议发送给GeoServer，从而执行任意SQL命令。这可能导致敏感数据泄露、数据修改甚至服务中断。提供的POC代码库包含漏洞的详细描述和复现步骤，表明该漏洞的有效性较高。搜索引擎结果也证实了该漏洞的存在和危害。

关于投毒风险，由于POC代码只是提供漏洞复现和利用的步骤，主要关注点在于利用方式，并无发现明显的恶意代码，比如下载执行恶意脚本，上传恶意文件等操作。但是，如果攻击者修改了提供的POC并植入恶意代码，使用户在测试时受到攻击，则存在一定投毒风险。因此，将投毒风险评估为10%。

**项目地址:** [murataydemir/CVE-2023-25157-and-CVE-2023-25158](https://github.com/murataydemir/CVE-2023-25157-and-CVE-2023-25158)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #8

**来源**: [CVE-2023-25157-win3zz_CVE-2023-25157.md](../2023/CVE-2023-25157-win3zz_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，GeoServer服务开启，目标存在漏洞版本的GeoServer

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞，存在于OGC Filter表达式语言和OGC Common Query Language (CQL)的支持中。攻击者可以通过WFS和WMS协议，或者WCS协议（针对ImageMosaic覆盖），注入恶意的SQL代码。PoC代码通过构造包含恶意SQL语句的CQL_FILTER参数，发送到存在漏洞的GeoServer实例，利用`strStartsWith`等函数进行SQL注入。虽然代码整体上是用于验证漏洞的，但存在潜在投毒风险，例如，攻击者可能会修改PoC，使其包含更具破坏性的SQL payload，或者在大型环境中分发这些修改后的PoC，达到攻击的目的。代码本身的危害较小，但被恶意修改后风险增大。

**项目地址:** [win3zz/CVE-2023-25157](https://github.com/win3zz/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---



---

## POC #4

**来源**: [CVE-2023-25157-charis3306_CVE-2023-25157.md](../2023/CVE-2023-25157-charis3306_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致敏感信息泄露、数据篡改、甚至服务器权限获取

**影响版本:** 2.20.x < 2.20.7, 2.19.x < 2.19.7, 2.18.x < 2.18.7, 2.21.x < 2.21.4, 2.22.x < 2.22.2

**利用条件:** GeoServer服务开启，目标存在漏洞版本，且允许未授权网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。由于GeoServer对用户输入过滤不严格，远程未授权攻击者可以构造畸形的过滤语法，绕过GeoServer的词法解析，从而造成SQL注入。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的利用是有效的。PoC代码中提供了利用此漏洞的请求示例，以及用于自动化检测的Python脚本。

**投毒风险：**
虽然提供的Python脚本主要功能是利用SQL注入漏洞，但仍存在一定的投毒风险。风险点在于`PROXY`变量的使用。如果攻击者修改了脚本中的代理地址，例如设置为一个恶意代理服务器，则可以通过该代理服务器捕获或篡改经过该代理的流量。例如脚本片段：
`PROXY = "http://127.0.0.1:8080/" if False else None`
如果将`False`修改为`True`， 并且用户使用了恶意的代理，则可能被投毒。此外，如果脚本被修改为执行恶意代码（例如下载和执行其他程序），则存在更大的风险。总体来说，投毒风险较低，约为10%，主要取决于用户是否会使用来路不明的代理或修改脚本本身。

**利用方式：**
利用方式如下：
1.  **获取可用功能名称：** 通过发送`GetCapabilities`请求到`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`端点，获取GeoServer支持的WFS功能名称。
2.  **获取相关功能可用属性：** 针对特定功能名称，例如`vulhub:example`，发送`DescribeFeatureType`请求到`/geoserver/wfs?request=DescribeFeatureType&version=2.0.0&service=WFS&outputFormat=application/json&typeName=vulhub:example`端点，获取该功能的可用属性列表。
3.  **构造SQL注入Payload：** 针对特定属性，构造包含SQL注入的`CQL_FILTER`参数，发送`GetFeature`请求到`/geoserver/ows`端点。例如：
`/geoserver/ows?service=wfs&version=1.0.0&request=GetFeature&typeName=vulhub:example&CQL_FILTER=strStartsWith(name,'x'')+=+true+and+1=(SELECT+CAST+((SELECT+version())+AS+INTEGER))+--+')+=+true`
此payload利用了`strStartsWith`函数和`CQL_FILTER`参数，注入SQL代码来执行数据库操作，如获取数据库版本信息。
4.  **验证与自动化：** 提供的`exp.py`脚本自动化了上述过程。它首先从目标GeoServer获取功能列表和属性，然后针对每个属性构造SQL注入payload，并检查响应中是否包含错误信息，以此判断漏洞是否存在。

**项目地址:** [charis3306/CVE-2023-25157](https://github.com/charis3306/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #5

**来源**: [CVE-2023-25157-custiya_geoserver-CVE-2023-25157.md](../2023/CVE-2023-25157-custiya_geoserver-CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，GeoServer实例运行，存在可访问的WFS/WMS/WCS服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-25157是GeoServer中的一个SQL注入漏洞。漏洞存在于OGC Filter表达式语言和OGC Common Query Language (CQL) 的处理中，影响Web Feature Service (WFS)、Web Map Service (WMS) 协议以及Web Coverage Service (WCS)协议中ImageMosaic coverages对CQL的支持。

**有效性：**
提供的`docker-compose.yml`文件设置了一个包含易受攻击的GeoServer实例(2.22.1)的环境，它依赖于PostGIS数据库。 `startup.sh`启动脚本如果包含恶意代码，则能成功搭建环境并执行攻击，验证此漏洞的存在。综合搜索引擎结果和漏洞库信息,漏洞利用是有效的。

**投毒风险：**
`docker-compose.yml` 文件本身并不包含恶意代码，但它挂载了`./startup.sh`脚本，这引入了投毒的可能。如果 `startup.sh` 包含任何恶意指令 (例如下载并执行恶意脚本、修改GeoServer配置以允许未授权访问、或安装后门)，那么该仓库就存在投毒风险。在没有`startup.sh` 脚本内容的情况下，无法完全确定投毒的程度，推测投毒概率为10%。 谨慎使用此仓库。

**利用方式：**
该漏洞的利用方式通常涉及构造恶意的CQL或OGC Filter表达式，将其注入到WFS/WMS/WCS请求的参数中。由于GeoServer没有正确过滤这些表达式，恶意SQL代码会被执行，从而可能允许攻击者执行任意SQL命令，包括读取、修改或删除数据库中的数据，甚至执行操作系统命令（如果数据库配置允许）。攻击者可能通过 `PropertyIsLike` filter（配合String字段和任意数据库DataStore，或PostGIS DataStore且开启 encode functions）或 `FeatureId` 配合不安全的设置触发漏洞。修复方案包括升级到指定版本或禁用/启用相应的PostGIS Datastore设置。

**项目地址:** [custiya/geoserver-CVE-2023-25157](https://github.com/custiya/geoserver-CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #6

**来源**: [CVE-2023-25157-dr-cable-tv_Geoserver-CVE-2023-25157.md](../2023/CVE-2023-25157-dr-cable-tv_Geoserver-CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，目标GeoServer实例存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞是GeoServer中的SQL注入漏洞，源于对OGC Filter表达式语言和OGC Common Query Language (CQL) 的不当处理。攻击者可以通过构造恶意的CQL_FILTER参数，利用`strEndsWith`，`strStartsWith`和`PropertyIsLike`函数，或者`FeatureId`绕过防御，执行任意SQL查询。

**有效性：**
根据提供的漏洞库信息和搜索引擎结果，此漏洞影响特定版本的GeoServer，且有可用的PoC代码。PoC代码通过构造恶意的CQL_FILTER参数进行攻击，尝试注入SQL语句以获取数据库版本信息。提供的`dbFinder.py`脚本首先尝试连接到目标GeoServer实例，然后获取FeatureType名称，并使用精心构造的CQL_FILTER尝试执行SQL注入。PoC代码有效。

**投毒风险：**
分析提供的PoC代码，`dbFinder.py` 主要功能是检测目标是否存在漏洞，其核心在于构造恶意的CQL_FILTER，没有发现明显的恶意行为或后门代码。`README.md` 只是提供了漏洞说明和使用方法。投毒风险较低，但仍需注意，因为任何从互联网上获取的代码都存在潜在风险，建议在使用前进行代码审查。 此处的投毒风险主要考虑作者是否在代码中隐藏了其他恶意行为，例如上传敏感信息等。鉴于代码功能较为简单，且主要依赖于SQL注入，因此判断投毒可能性较低，为5%。

**利用方式：**
1.  攻击者首先需要确定目标GeoServer实例的版本是否在受影响范围内（< 2.21.4, >= 2.22.0, < 2.22.2）。
2.  利用提供的PoC脚本或者其他方式，构造包含恶意SQL语句的CQL_FILTER参数。
3.  将构造的CQL_FILTER参数附加到WFS GetFeature请求中，例如：
    `/geoserver/ows?service=wfs&version=1.0.0&request=GetFeature&typeName=<featureType>&CQL_FILTER=<恶意CQL_FILTER>`
4.  如果目标存在漏洞，恶意SQL语句将被执行，攻击者可以获取数据库中的敏感信息，甚至执行任意代码。

**缓解措施：**
*   升级GeoServer到不受影响的版本（>= 2.21.4 或 >= 2.22.2）。
*   如果无法升级，禁用PostGIS Datastore的*encode functions*设置，并启用*preparedStatements*设置。

**项目地址:** [dr-cable-tv/Geoserver-CVE-2023-25157](https://github.com/dr-cable-tv/Geoserver-CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #7

**来源**: [CVE-2023-25157-murataydemir_CVE-2023-25157-and-CVE-2023-25158.md](../2023/CVE-2023-25157-murataydemir_CVE-2023-25157-and-CVE-2023-25158.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致未授权信息泄露、数据篡改和服务中断

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要GeoServer实例运行，且满足特定配置条件，例如PostGIS DataStore启用encode functions，或数据库表具有String主键列且prepared statements被禁用等。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的SQL注入漏洞，利用OGC Filter表达式语言和CQL（Common Query Language）的不当处理。根据漏洞利用代码描述，多个函数和过滤器都存在注入点：

*   `PropertyIsLike` filter: 当与String字段一起使用时，任何关系数据库的存储都会受到影响；PostGIS DataStore启用encode functions；或者image mosaic的索引存储在关系数据库中。
*   `strEndsWith` function: 当与PostGIS DataStore一起使用且encode functions启用时。
*   `strStartsWith` function: 当与PostGIS DataStore一起使用且encode functions启用时。
*   `FeatureId` filter: 当数据库表的String主键列使用时且prepared statements禁用时。
*   `jsonArrayContains` function: 当与String或JSON字段一起使用且与PostGIS或Oracle DataStore（仅在GeoServer 2.22.0及更高版本中）一起使用时。
*   `DWithin` filter: 当与Oracle DataStore一起使用时。

利用方式包括构造恶意的OGC Filter或CQL表达式，通过WFS、WMS或WCS协议发送给GeoServer，从而执行任意SQL命令。这可能导致敏感数据泄露、数据修改甚至服务中断。提供的POC代码库包含漏洞的详细描述和复现步骤，表明该漏洞的有效性较高。搜索引擎结果也证实了该漏洞的存在和危害。

关于投毒风险，由于POC代码只是提供漏洞复现和利用的步骤，主要关注点在于利用方式，并无发现明显的恶意代码，比如下载执行恶意脚本，上传恶意文件等操作。但是，如果攻击者修改了提供的POC并植入恶意代码，使用户在测试时受到攻击，则存在一定投毒风险。因此，将投毒风险评估为10%。

**项目地址:** [murataydemir/CVE-2023-25157-and-CVE-2023-25158](https://github.com/murataydemir/CVE-2023-25157-and-CVE-2023-25158)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #8

**来源**: [CVE-2023-25157-win3zz_CVE-2023-25157.md](../2023/CVE-2023-25157-win3zz_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，GeoServer服务开启，目标存在漏洞版本的GeoServer

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞，存在于OGC Filter表达式语言和OGC Common Query Language (CQL)的支持中。攻击者可以通过WFS和WMS协议，或者WCS协议（针对ImageMosaic覆盖），注入恶意的SQL代码。PoC代码通过构造包含恶意SQL语句的CQL_FILTER参数，发送到存在漏洞的GeoServer实例，利用`strStartsWith`等函数进行SQL注入。虽然代码整体上是用于验证漏洞的，但存在潜在投毒风险，例如，攻击者可能会修改PoC，使其包含更具破坏性的SQL payload，或者在大型环境中分发这些修改后的PoC，达到攻击的目的。代码本身的危害较小，但被恶意修改后风险增大。

**项目地址:** [win3zz/CVE-2023-25157](https://github.com/win3zz/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---



---

## POC #4

**来源**: [CVE-2023-25157-charis3306_CVE-2023-25157.md](../2023/CVE-2023-25157-charis3306_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致敏感信息泄露、数据篡改、甚至服务器权限获取

**影响版本:** 2.20.x < 2.20.7, 2.19.x < 2.19.7, 2.18.x < 2.18.7, 2.21.x < 2.21.4, 2.22.x < 2.22.2

**利用条件:** GeoServer服务开启，目标存在漏洞版本，且允许未授权网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。由于GeoServer对用户输入过滤不严格，远程未授权攻击者可以构造畸形的过滤语法，绕过GeoServer的词法解析，从而造成SQL注入。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的利用是有效的。PoC代码中提供了利用此漏洞的请求示例，以及用于自动化检测的Python脚本。

**投毒风险：**
虽然提供的Python脚本主要功能是利用SQL注入漏洞，但仍存在一定的投毒风险。风险点在于`PROXY`变量的使用。如果攻击者修改了脚本中的代理地址，例如设置为一个恶意代理服务器，则可以通过该代理服务器捕获或篡改经过该代理的流量。例如脚本片段：
`PROXY = "http://127.0.0.1:8080/" if False else None`
如果将`False`修改为`True`， 并且用户使用了恶意的代理，则可能被投毒。此外，如果脚本被修改为执行恶意代码（例如下载和执行其他程序），则存在更大的风险。总体来说，投毒风险较低，约为10%，主要取决于用户是否会使用来路不明的代理或修改脚本本身。

**利用方式：**
利用方式如下：
1.  **获取可用功能名称：** 通过发送`GetCapabilities`请求到`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`端点，获取GeoServer支持的WFS功能名称。
2.  **获取相关功能可用属性：** 针对特定功能名称，例如`vulhub:example`，发送`DescribeFeatureType`请求到`/geoserver/wfs?request=DescribeFeatureType&version=2.0.0&service=WFS&outputFormat=application/json&typeName=vulhub:example`端点，获取该功能的可用属性列表。
3.  **构造SQL注入Payload：** 针对特定属性，构造包含SQL注入的`CQL_FILTER`参数，发送`GetFeature`请求到`/geoserver/ows`端点。例如：
`/geoserver/ows?service=wfs&version=1.0.0&request=GetFeature&typeName=vulhub:example&CQL_FILTER=strStartsWith(name,'x'')+=+true+and+1=(SELECT+CAST+((SELECT+version())+AS+INTEGER))+--+')+=+true`
此payload利用了`strStartsWith`函数和`CQL_FILTER`参数，注入SQL代码来执行数据库操作，如获取数据库版本信息。
4.  **验证与自动化：** 提供的`exp.py`脚本自动化了上述过程。它首先从目标GeoServer获取功能列表和属性，然后针对每个属性构造SQL注入payload，并检查响应中是否包含错误信息，以此判断漏洞是否存在。

**项目地址:** [charis3306/CVE-2023-25157](https://github.com/charis3306/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #5

**来源**: [CVE-2023-25157-custiya_geoserver-CVE-2023-25157.md](../2023/CVE-2023-25157-custiya_geoserver-CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，GeoServer实例运行，存在可访问的WFS/WMS/WCS服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-25157是GeoServer中的一个SQL注入漏洞。漏洞存在于OGC Filter表达式语言和OGC Common Query Language (CQL) 的处理中，影响Web Feature Service (WFS)、Web Map Service (WMS) 协议以及Web Coverage Service (WCS)协议中ImageMosaic coverages对CQL的支持。

**有效性：**
提供的`docker-compose.yml`文件设置了一个包含易受攻击的GeoServer实例(2.22.1)的环境，它依赖于PostGIS数据库。 `startup.sh`启动脚本如果包含恶意代码，则能成功搭建环境并执行攻击，验证此漏洞的存在。综合搜索引擎结果和漏洞库信息,漏洞利用是有效的。

**投毒风险：**
`docker-compose.yml` 文件本身并不包含恶意代码，但它挂载了`./startup.sh`脚本，这引入了投毒的可能。如果 `startup.sh` 包含任何恶意指令 (例如下载并执行恶意脚本、修改GeoServer配置以允许未授权访问、或安装后门)，那么该仓库就存在投毒风险。在没有`startup.sh` 脚本内容的情况下，无法完全确定投毒的程度，推测投毒概率为10%。 谨慎使用此仓库。

**利用方式：**
该漏洞的利用方式通常涉及构造恶意的CQL或OGC Filter表达式，将其注入到WFS/WMS/WCS请求的参数中。由于GeoServer没有正确过滤这些表达式，恶意SQL代码会被执行，从而可能允许攻击者执行任意SQL命令，包括读取、修改或删除数据库中的数据，甚至执行操作系统命令（如果数据库配置允许）。攻击者可能通过 `PropertyIsLike` filter（配合String字段和任意数据库DataStore，或PostGIS DataStore且开启 encode functions）或 `FeatureId` 配合不安全的设置触发漏洞。修复方案包括升级到指定版本或禁用/启用相应的PostGIS Datastore设置。

**项目地址:** [custiya/geoserver-CVE-2023-25157](https://github.com/custiya/geoserver-CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #6

**来源**: [CVE-2023-25157-dr-cable-tv_Geoserver-CVE-2023-25157.md](../2023/CVE-2023-25157-dr-cable-tv_Geoserver-CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，目标GeoServer实例存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞是GeoServer中的SQL注入漏洞，源于对OGC Filter表达式语言和OGC Common Query Language (CQL) 的不当处理。攻击者可以通过构造恶意的CQL_FILTER参数，利用`strEndsWith`，`strStartsWith`和`PropertyIsLike`函数，或者`FeatureId`绕过防御，执行任意SQL查询。

**有效性：**
根据提供的漏洞库信息和搜索引擎结果，此漏洞影响特定版本的GeoServer，且有可用的PoC代码。PoC代码通过构造恶意的CQL_FILTER参数进行攻击，尝试注入SQL语句以获取数据库版本信息。提供的`dbFinder.py`脚本首先尝试连接到目标GeoServer实例，然后获取FeatureType名称，并使用精心构造的CQL_FILTER尝试执行SQL注入。PoC代码有效。

**投毒风险：**
分析提供的PoC代码，`dbFinder.py` 主要功能是检测目标是否存在漏洞，其核心在于构造恶意的CQL_FILTER，没有发现明显的恶意行为或后门代码。`README.md` 只是提供了漏洞说明和使用方法。投毒风险较低，但仍需注意，因为任何从互联网上获取的代码都存在潜在风险，建议在使用前进行代码审查。 此处的投毒风险主要考虑作者是否在代码中隐藏了其他恶意行为，例如上传敏感信息等。鉴于代码功能较为简单，且主要依赖于SQL注入，因此判断投毒可能性较低，为5%。

**利用方式：**
1.  攻击者首先需要确定目标GeoServer实例的版本是否在受影响范围内（< 2.21.4, >= 2.22.0, < 2.22.2）。
2.  利用提供的PoC脚本或者其他方式，构造包含恶意SQL语句的CQL_FILTER参数。
3.  将构造的CQL_FILTER参数附加到WFS GetFeature请求中，例如：
    `/geoserver/ows?service=wfs&version=1.0.0&request=GetFeature&typeName=<featureType>&CQL_FILTER=<恶意CQL_FILTER>`
4.  如果目标存在漏洞，恶意SQL语句将被执行，攻击者可以获取数据库中的敏感信息，甚至执行任意代码。

**缓解措施：**
*   升级GeoServer到不受影响的版本（>= 2.21.4 或 >= 2.22.2）。
*   如果无法升级，禁用PostGIS Datastore的*encode functions*设置，并启用*preparedStatements*设置。

**项目地址:** [dr-cable-tv/Geoserver-CVE-2023-25157](https://github.com/dr-cable-tv/Geoserver-CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #7

**来源**: [CVE-2023-25157-murataydemir_CVE-2023-25157-and-CVE-2023-25158.md](../2023/CVE-2023-25157-murataydemir_CVE-2023-25157-and-CVE-2023-25158.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致未授权信息泄露、数据篡改和服务中断

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要GeoServer实例运行，且满足特定配置条件，例如PostGIS DataStore启用encode functions，或数据库表具有String主键列且prepared statements被禁用等。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的SQL注入漏洞，利用OGC Filter表达式语言和CQL（Common Query Language）的不当处理。根据漏洞利用代码描述，多个函数和过滤器都存在注入点：

*   `PropertyIsLike` filter: 当与String字段一起使用时，任何关系数据库的存储都会受到影响；PostGIS DataStore启用encode functions；或者image mosaic的索引存储在关系数据库中。
*   `strEndsWith` function: 当与PostGIS DataStore一起使用且encode functions启用时。
*   `strStartsWith` function: 当与PostGIS DataStore一起使用且encode functions启用时。
*   `FeatureId` filter: 当数据库表的String主键列使用时且prepared statements禁用时。
*   `jsonArrayContains` function: 当与String或JSON字段一起使用且与PostGIS或Oracle DataStore（仅在GeoServer 2.22.0及更高版本中）一起使用时。
*   `DWithin` filter: 当与Oracle DataStore一起使用时。

利用方式包括构造恶意的OGC Filter或CQL表达式，通过WFS、WMS或WCS协议发送给GeoServer，从而执行任意SQL命令。这可能导致敏感数据泄露、数据修改甚至服务中断。提供的POC代码库包含漏洞的详细描述和复现步骤，表明该漏洞的有效性较高。搜索引擎结果也证实了该漏洞的存在和危害。

关于投毒风险，由于POC代码只是提供漏洞复现和利用的步骤，主要关注点在于利用方式，并无发现明显的恶意代码，比如下载执行恶意脚本，上传恶意文件等操作。但是，如果攻击者修改了提供的POC并植入恶意代码，使用户在测试时受到攻击，则存在一定投毒风险。因此，将投毒风险评估为10%。

**项目地址:** [murataydemir/CVE-2023-25157-and-CVE-2023-25158](https://github.com/murataydemir/CVE-2023-25157-and-CVE-2023-25158)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #8

**来源**: [CVE-2023-25157-win3zz_CVE-2023-25157.md](../2023/CVE-2023-25157-win3zz_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，GeoServer服务开启，目标存在漏洞版本的GeoServer

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞，存在于OGC Filter表达式语言和OGC Common Query Language (CQL)的支持中。攻击者可以通过WFS和WMS协议，或者WCS协议（针对ImageMosaic覆盖），注入恶意的SQL代码。PoC代码通过构造包含恶意SQL语句的CQL_FILTER参数，发送到存在漏洞的GeoServer实例，利用`strStartsWith`等函数进行SQL注入。虽然代码整体上是用于验证漏洞的，但存在潜在投毒风险，例如，攻击者可能会修改PoC，使其包含更具破坏性的SQL payload，或者在大型环境中分发这些修改后的PoC，达到攻击的目的。代码本身的危害较小，但被恶意修改后风险增大。

**项目地址:** [win3zz/CVE-2023-25157](https://github.com/win3zz/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---



---

## POC #4

**来源**: [CVE-2023-25157-charis3306_CVE-2023-25157.md](../2023/CVE-2023-25157-charis3306_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致敏感信息泄露、数据篡改、甚至服务器权限获取

**影响版本:** 2.20.x < 2.20.7, 2.19.x < 2.19.7, 2.18.x < 2.18.7, 2.21.x < 2.21.4, 2.22.x < 2.22.2

**利用条件:** GeoServer服务开启，目标存在漏洞版本，且允许未授权网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。由于GeoServer对用户输入过滤不严格，远程未授权攻击者可以构造畸形的过滤语法，绕过GeoServer的词法解析，从而造成SQL注入。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的利用是有效的。PoC代码中提供了利用此漏洞的请求示例，以及用于自动化检测的Python脚本。

**投毒风险：**
虽然提供的Python脚本主要功能是利用SQL注入漏洞，但仍存在一定的投毒风险。风险点在于`PROXY`变量的使用。如果攻击者修改了脚本中的代理地址，例如设置为一个恶意代理服务器，则可以通过该代理服务器捕获或篡改经过该代理的流量。例如脚本片段：
`PROXY = "http://127.0.0.1:8080/" if False else None`
如果将`False`修改为`True`， 并且用户使用了恶意的代理，则可能被投毒。此外，如果脚本被修改为执行恶意代码（例如下载和执行其他程序），则存在更大的风险。总体来说，投毒风险较低，约为10%，主要取决于用户是否会使用来路不明的代理或修改脚本本身。

**利用方式：**
利用方式如下：
1.  **获取可用功能名称：** 通过发送`GetCapabilities`请求到`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`端点，获取GeoServer支持的WFS功能名称。
2.  **获取相关功能可用属性：** 针对特定功能名称，例如`vulhub:example`，发送`DescribeFeatureType`请求到`/geoserver/wfs?request=DescribeFeatureType&version=2.0.0&service=WFS&outputFormat=application/json&typeName=vulhub:example`端点，获取该功能的可用属性列表。
3.  **构造SQL注入Payload：** 针对特定属性，构造包含SQL注入的`CQL_FILTER`参数，发送`GetFeature`请求到`/geoserver/ows`端点。例如：
`/geoserver/ows?service=wfs&version=1.0.0&request=GetFeature&typeName=vulhub:example&CQL_FILTER=strStartsWith(name,'x'')+=+true+and+1=(SELECT+CAST+((SELECT+version())+AS+INTEGER))+--+')+=+true`
此payload利用了`strStartsWith`函数和`CQL_FILTER`参数，注入SQL代码来执行数据库操作，如获取数据库版本信息。
4.  **验证与自动化：** 提供的`exp.py`脚本自动化了上述过程。它首先从目标GeoServer获取功能列表和属性，然后针对每个属性构造SQL注入payload，并检查响应中是否包含错误信息，以此判断漏洞是否存在。

**项目地址:** [charis3306/CVE-2023-25157](https://github.com/charis3306/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #5

**来源**: [CVE-2023-25157-custiya_geoserver-CVE-2023-25157.md](../2023/CVE-2023-25157-custiya_geoserver-CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，GeoServer实例运行，存在可访问的WFS/WMS/WCS服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-25157是GeoServer中的一个SQL注入漏洞。漏洞存在于OGC Filter表达式语言和OGC Common Query Language (CQL) 的处理中，影响Web Feature Service (WFS)、Web Map Service (WMS) 协议以及Web Coverage Service (WCS)协议中ImageMosaic coverages对CQL的支持。

**有效性：**
提供的`docker-compose.yml`文件设置了一个包含易受攻击的GeoServer实例(2.22.1)的环境，它依赖于PostGIS数据库。 `startup.sh`启动脚本如果包含恶意代码，则能成功搭建环境并执行攻击，验证此漏洞的存在。综合搜索引擎结果和漏洞库信息,漏洞利用是有效的。

**投毒风险：**
`docker-compose.yml` 文件本身并不包含恶意代码，但它挂载了`./startup.sh`脚本，这引入了投毒的可能。如果 `startup.sh` 包含任何恶意指令 (例如下载并执行恶意脚本、修改GeoServer配置以允许未授权访问、或安装后门)，那么该仓库就存在投毒风险。在没有`startup.sh` 脚本内容的情况下，无法完全确定投毒的程度，推测投毒概率为10%。 谨慎使用此仓库。

**利用方式：**
该漏洞的利用方式通常涉及构造恶意的CQL或OGC Filter表达式，将其注入到WFS/WMS/WCS请求的参数中。由于GeoServer没有正确过滤这些表达式，恶意SQL代码会被执行，从而可能允许攻击者执行任意SQL命令，包括读取、修改或删除数据库中的数据，甚至执行操作系统命令（如果数据库配置允许）。攻击者可能通过 `PropertyIsLike` filter（配合String字段和任意数据库DataStore，或PostGIS DataStore且开启 encode functions）或 `FeatureId` 配合不安全的设置触发漏洞。修复方案包括升级到指定版本或禁用/启用相应的PostGIS Datastore设置。

**项目地址:** [custiya/geoserver-CVE-2023-25157](https://github.com/custiya/geoserver-CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #6

**来源**: [CVE-2023-25157-dr-cable-tv_Geoserver-CVE-2023-25157.md](../2023/CVE-2023-25157-dr-cable-tv_Geoserver-CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，目标GeoServer实例存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞是GeoServer中的SQL注入漏洞，源于对OGC Filter表达式语言和OGC Common Query Language (CQL) 的不当处理。攻击者可以通过构造恶意的CQL_FILTER参数，利用`strEndsWith`，`strStartsWith`和`PropertyIsLike`函数，或者`FeatureId`绕过防御，执行任意SQL查询。

**有效性：**
根据提供的漏洞库信息和搜索引擎结果，此漏洞影响特定版本的GeoServer，且有可用的PoC代码。PoC代码通过构造恶意的CQL_FILTER参数进行攻击，尝试注入SQL语句以获取数据库版本信息。提供的`dbFinder.py`脚本首先尝试连接到目标GeoServer实例，然后获取FeatureType名称，并使用精心构造的CQL_FILTER尝试执行SQL注入。PoC代码有效。

**投毒风险：**
分析提供的PoC代码，`dbFinder.py` 主要功能是检测目标是否存在漏洞，其核心在于构造恶意的CQL_FILTER，没有发现明显的恶意行为或后门代码。`README.md` 只是提供了漏洞说明和使用方法。投毒风险较低，但仍需注意，因为任何从互联网上获取的代码都存在潜在风险，建议在使用前进行代码审查。 此处的投毒风险主要考虑作者是否在代码中隐藏了其他恶意行为，例如上传敏感信息等。鉴于代码功能较为简单，且主要依赖于SQL注入，因此判断投毒可能性较低，为5%。

**利用方式：**
1.  攻击者首先需要确定目标GeoServer实例的版本是否在受影响范围内（< 2.21.4, >= 2.22.0, < 2.22.2）。
2.  利用提供的PoC脚本或者其他方式，构造包含恶意SQL语句的CQL_FILTER参数。
3.  将构造的CQL_FILTER参数附加到WFS GetFeature请求中，例如：
    `/geoserver/ows?service=wfs&version=1.0.0&request=GetFeature&typeName=<featureType>&CQL_FILTER=<恶意CQL_FILTER>`
4.  如果目标存在漏洞，恶意SQL语句将被执行，攻击者可以获取数据库中的敏感信息，甚至执行任意代码。

**缓解措施：**
*   升级GeoServer到不受影响的版本（>= 2.21.4 或 >= 2.22.2）。
*   如果无法升级，禁用PostGIS Datastore的*encode functions*设置，并启用*preparedStatements*设置。

**项目地址:** [dr-cable-tv/Geoserver-CVE-2023-25157](https://github.com/dr-cable-tv/Geoserver-CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #7

**来源**: [CVE-2023-25157-murataydemir_CVE-2023-25157-and-CVE-2023-25158.md](../2023/CVE-2023-25157-murataydemir_CVE-2023-25157-and-CVE-2023-25158.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致未授权信息泄露、数据篡改和服务中断

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要GeoServer实例运行，且满足特定配置条件，例如PostGIS DataStore启用encode functions，或数据库表具有String主键列且prepared statements被禁用等。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的SQL注入漏洞，利用OGC Filter表达式语言和CQL（Common Query Language）的不当处理。根据漏洞利用代码描述，多个函数和过滤器都存在注入点：

*   `PropertyIsLike` filter: 当与String字段一起使用时，任何关系数据库的存储都会受到影响；PostGIS DataStore启用encode functions；或者image mosaic的索引存储在关系数据库中。
*   `strEndsWith` function: 当与PostGIS DataStore一起使用且encode functions启用时。
*   `strStartsWith` function: 当与PostGIS DataStore一起使用且encode functions启用时。
*   `FeatureId` filter: 当数据库表的String主键列使用时且prepared statements禁用时。
*   `jsonArrayContains` function: 当与String或JSON字段一起使用且与PostGIS或Oracle DataStore（仅在GeoServer 2.22.0及更高版本中）一起使用时。
*   `DWithin` filter: 当与Oracle DataStore一起使用时。

利用方式包括构造恶意的OGC Filter或CQL表达式，通过WFS、WMS或WCS协议发送给GeoServer，从而执行任意SQL命令。这可能导致敏感数据泄露、数据修改甚至服务中断。提供的POC代码库包含漏洞的详细描述和复现步骤，表明该漏洞的有效性较高。搜索引擎结果也证实了该漏洞的存在和危害。

关于投毒风险，由于POC代码只是提供漏洞复现和利用的步骤，主要关注点在于利用方式，并无发现明显的恶意代码，比如下载执行恶意脚本，上传恶意文件等操作。但是，如果攻击者修改了提供的POC并植入恶意代码，使用户在测试时受到攻击，则存在一定投毒风险。因此，将投毒风险评估为10%。

**项目地址:** [murataydemir/CVE-2023-25157-and-CVE-2023-25158](https://github.com/murataydemir/CVE-2023-25157-and-CVE-2023-25158)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #8

**来源**: [CVE-2023-25157-win3zz_CVE-2023-25157.md](../2023/CVE-2023-25157-win3zz_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，GeoServer服务开启，目标存在漏洞版本的GeoServer

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞，存在于OGC Filter表达式语言和OGC Common Query Language (CQL)的支持中。攻击者可以通过WFS和WMS协议，或者WCS协议（针对ImageMosaic覆盖），注入恶意的SQL代码。PoC代码通过构造包含恶意SQL语句的CQL_FILTER参数，发送到存在漏洞的GeoServer实例，利用`strStartsWith`等函数进行SQL注入。虽然代码整体上是用于验证漏洞的，但存在潜在投毒风险，例如，攻击者可能会修改PoC，使其包含更具破坏性的SQL payload，或者在大型环境中分发这些修改后的PoC，达到攻击的目的。代码本身的危害较小，但被恶意修改后风险增大。

**项目地址:** [win3zz/CVE-2023-25157](https://github.com/win3zz/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---



---

## POC #4

**来源**: [CVE-2023-25157-charis3306_CVE-2023-25157.md](../2023/CVE-2023-25157-charis3306_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致敏感信息泄露、数据篡改、甚至服务器权限获取

**影响版本:** 2.20.x < 2.20.7, 2.19.x < 2.19.7, 2.18.x < 2.18.7, 2.21.x < 2.21.4, 2.22.x < 2.22.2

**利用条件:** GeoServer服务开启，目标存在漏洞版本，且允许未授权网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。由于GeoServer对用户输入过滤不严格，远程未授权攻击者可以构造畸形的过滤语法，绕过GeoServer的词法解析，从而造成SQL注入。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的利用是有效的。PoC代码中提供了利用此漏洞的请求示例，以及用于自动化检测的Python脚本。

**投毒风险：**
虽然提供的Python脚本主要功能是利用SQL注入漏洞，但仍存在一定的投毒风险。风险点在于`PROXY`变量的使用。如果攻击者修改了脚本中的代理地址，例如设置为一个恶意代理服务器，则可以通过该代理服务器捕获或篡改经过该代理的流量。例如脚本片段：
`PROXY = "http://127.0.0.1:8080/" if False else None`
如果将`False`修改为`True`， 并且用户使用了恶意的代理，则可能被投毒。此外，如果脚本被修改为执行恶意代码（例如下载和执行其他程序），则存在更大的风险。总体来说，投毒风险较低，约为10%，主要取决于用户是否会使用来路不明的代理或修改脚本本身。

**利用方式：**
利用方式如下：
1.  **获取可用功能名称：** 通过发送`GetCapabilities`请求到`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`端点，获取GeoServer支持的WFS功能名称。
2.  **获取相关功能可用属性：** 针对特定功能名称，例如`vulhub:example`，发送`DescribeFeatureType`请求到`/geoserver/wfs?request=DescribeFeatureType&version=2.0.0&service=WFS&outputFormat=application/json&typeName=vulhub:example`端点，获取该功能的可用属性列表。
3.  **构造SQL注入Payload：** 针对特定属性，构造包含SQL注入的`CQL_FILTER`参数，发送`GetFeature`请求到`/geoserver/ows`端点。例如：
`/geoserver/ows?service=wfs&version=1.0.0&request=GetFeature&typeName=vulhub:example&CQL_FILTER=strStartsWith(name,'x'')+=+true+and+1=(SELECT+CAST+((SELECT+version())+AS+INTEGER))+--+')+=+true`
此payload利用了`strStartsWith`函数和`CQL_FILTER`参数，注入SQL代码来执行数据库操作，如获取数据库版本信息。
4.  **验证与自动化：** 提供的`exp.py`脚本自动化了上述过程。它首先从目标GeoServer获取功能列表和属性，然后针对每个属性构造SQL注入payload，并检查响应中是否包含错误信息，以此判断漏洞是否存在。

**项目地址:** [charis3306/CVE-2023-25157](https://github.com/charis3306/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #5

**来源**: [CVE-2023-25157-custiya_geoserver-CVE-2023-25157.md](../2023/CVE-2023-25157-custiya_geoserver-CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，GeoServer实例运行，存在可访问的WFS/WMS/WCS服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-25157是GeoServer中的一个SQL注入漏洞。漏洞存在于OGC Filter表达式语言和OGC Common Query Language (CQL) 的处理中，影响Web Feature Service (WFS)、Web Map Service (WMS) 协议以及Web Coverage Service (WCS)协议中ImageMosaic coverages对CQL的支持。

**有效性：**
提供的`docker-compose.yml`文件设置了一个包含易受攻击的GeoServer实例(2.22.1)的环境，它依赖于PostGIS数据库。 `startup.sh`启动脚本如果包含恶意代码，则能成功搭建环境并执行攻击，验证此漏洞的存在。综合搜索引擎结果和漏洞库信息,漏洞利用是有效的。

**投毒风险：**
`docker-compose.yml` 文件本身并不包含恶意代码，但它挂载了`./startup.sh`脚本，这引入了投毒的可能。如果 `startup.sh` 包含任何恶意指令 (例如下载并执行恶意脚本、修改GeoServer配置以允许未授权访问、或安装后门)，那么该仓库就存在投毒风险。在没有`startup.sh` 脚本内容的情况下，无法完全确定投毒的程度，推测投毒概率为10%。 谨慎使用此仓库。

**利用方式：**
该漏洞的利用方式通常涉及构造恶意的CQL或OGC Filter表达式，将其注入到WFS/WMS/WCS请求的参数中。由于GeoServer没有正确过滤这些表达式，恶意SQL代码会被执行，从而可能允许攻击者执行任意SQL命令，包括读取、修改或删除数据库中的数据，甚至执行操作系统命令（如果数据库配置允许）。攻击者可能通过 `PropertyIsLike` filter（配合String字段和任意数据库DataStore，或PostGIS DataStore且开启 encode functions）或 `FeatureId` 配合不安全的设置触发漏洞。修复方案包括升级到指定版本或禁用/启用相应的PostGIS Datastore设置。

**项目地址:** [custiya/geoserver-CVE-2023-25157](https://github.com/custiya/geoserver-CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #6

**来源**: [CVE-2023-25157-dr-cable-tv_Geoserver-CVE-2023-25157.md](../2023/CVE-2023-25157-dr-cable-tv_Geoserver-CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，目标GeoServer实例存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞是GeoServer中的SQL注入漏洞，源于对OGC Filter表达式语言和OGC Common Query Language (CQL) 的不当处理。攻击者可以通过构造恶意的CQL_FILTER参数，利用`strEndsWith`，`strStartsWith`和`PropertyIsLike`函数，或者`FeatureId`绕过防御，执行任意SQL查询。

**有效性：**
根据提供的漏洞库信息和搜索引擎结果，此漏洞影响特定版本的GeoServer，且有可用的PoC代码。PoC代码通过构造恶意的CQL_FILTER参数进行攻击，尝试注入SQL语句以获取数据库版本信息。提供的`dbFinder.py`脚本首先尝试连接到目标GeoServer实例，然后获取FeatureType名称，并使用精心构造的CQL_FILTER尝试执行SQL注入。PoC代码有效。

**投毒风险：**
分析提供的PoC代码，`dbFinder.py` 主要功能是检测目标是否存在漏洞，其核心在于构造恶意的CQL_FILTER，没有发现明显的恶意行为或后门代码。`README.md` 只是提供了漏洞说明和使用方法。投毒风险较低，但仍需注意，因为任何从互联网上获取的代码都存在潜在风险，建议在使用前进行代码审查。 此处的投毒风险主要考虑作者是否在代码中隐藏了其他恶意行为，例如上传敏感信息等。鉴于代码功能较为简单，且主要依赖于SQL注入，因此判断投毒可能性较低，为5%。

**利用方式：**
1.  攻击者首先需要确定目标GeoServer实例的版本是否在受影响范围内（< 2.21.4, >= 2.22.0, < 2.22.2）。
2.  利用提供的PoC脚本或者其他方式，构造包含恶意SQL语句的CQL_FILTER参数。
3.  将构造的CQL_FILTER参数附加到WFS GetFeature请求中，例如：
    `/geoserver/ows?service=wfs&version=1.0.0&request=GetFeature&typeName=<featureType>&CQL_FILTER=<恶意CQL_FILTER>`
4.  如果目标存在漏洞，恶意SQL语句将被执行，攻击者可以获取数据库中的敏感信息，甚至执行任意代码。

**缓解措施：**
*   升级GeoServer到不受影响的版本（>= 2.21.4 或 >= 2.22.2）。
*   如果无法升级，禁用PostGIS Datastore的*encode functions*设置，并启用*preparedStatements*设置。

**项目地址:** [dr-cable-tv/Geoserver-CVE-2023-25157](https://github.com/dr-cable-tv/Geoserver-CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #7

**来源**: [CVE-2023-25157-murataydemir_CVE-2023-25157-and-CVE-2023-25158.md](../2023/CVE-2023-25157-murataydemir_CVE-2023-25157-and-CVE-2023-25158.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致未授权信息泄露、数据篡改和服务中断

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要GeoServer实例运行，且满足特定配置条件，例如PostGIS DataStore启用encode functions，或数据库表具有String主键列且prepared statements被禁用等。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的SQL注入漏洞，利用OGC Filter表达式语言和CQL（Common Query Language）的不当处理。根据漏洞利用代码描述，多个函数和过滤器都存在注入点：

*   `PropertyIsLike` filter: 当与String字段一起使用时，任何关系数据库的存储都会受到影响；PostGIS DataStore启用encode functions；或者image mosaic的索引存储在关系数据库中。
*   `strEndsWith` function: 当与PostGIS DataStore一起使用且encode functions启用时。
*   `strStartsWith` function: 当与PostGIS DataStore一起使用且encode functions启用时。
*   `FeatureId` filter: 当数据库表的String主键列使用时且prepared statements禁用时。
*   `jsonArrayContains` function: 当与String或JSON字段一起使用且与PostGIS或Oracle DataStore（仅在GeoServer 2.22.0及更高版本中）一起使用时。
*   `DWithin` filter: 当与Oracle DataStore一起使用时。

利用方式包括构造恶意的OGC Filter或CQL表达式，通过WFS、WMS或WCS协议发送给GeoServer，从而执行任意SQL命令。这可能导致敏感数据泄露、数据修改甚至服务中断。提供的POC代码库包含漏洞的详细描述和复现步骤，表明该漏洞的有效性较高。搜索引擎结果也证实了该漏洞的存在和危害。

关于投毒风险，由于POC代码只是提供漏洞复现和利用的步骤，主要关注点在于利用方式，并无发现明显的恶意代码，比如下载执行恶意脚本，上传恶意文件等操作。但是，如果攻击者修改了提供的POC并植入恶意代码，使用户在测试时受到攻击，则存在一定投毒风险。因此，将投毒风险评估为10%。

**项目地址:** [murataydemir/CVE-2023-25157-and-CVE-2023-25158](https://github.com/murataydemir/CVE-2023-25157-and-CVE-2023-25158)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #8

**来源**: [CVE-2023-25157-win3zz_CVE-2023-25157.md](../2023/CVE-2023-25157-win3zz_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，GeoServer服务开启，目标存在漏洞版本的GeoServer

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞，存在于OGC Filter表达式语言和OGC Common Query Language (CQL)的支持中。攻击者可以通过WFS和WMS协议，或者WCS协议（针对ImageMosaic覆盖），注入恶意的SQL代码。PoC代码通过构造包含恶意SQL语句的CQL_FILTER参数，发送到存在漏洞的GeoServer实例，利用`strStartsWith`等函数进行SQL注入。虽然代码整体上是用于验证漏洞的，但存在潜在投毒风险，例如，攻击者可能会修改PoC，使其包含更具破坏性的SQL payload，或者在大型环境中分发这些修改后的PoC，达到攻击的目的。代码本身的危害较小，但被恶意修改后风险增大。

**项目地址:** [win3zz/CVE-2023-25157](https://github.com/win3zz/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---



---

## POC #4

**来源**: [CVE-2023-25157-charis3306_CVE-2023-25157.md](../2023/CVE-2023-25157-charis3306_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致敏感信息泄露、数据篡改、甚至服务器权限获取

**影响版本:** 2.20.x < 2.20.7, 2.19.x < 2.19.7, 2.18.x < 2.18.7, 2.21.x < 2.21.4, 2.22.x < 2.22.2

**利用条件:** GeoServer服务开启，目标存在漏洞版本，且允许未授权网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。由于GeoServer对用户输入过滤不严格，远程未授权攻击者可以构造畸形的过滤语法，绕过GeoServer的词法解析，从而造成SQL注入。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的利用是有效的。PoC代码中提供了利用此漏洞的请求示例，以及用于自动化检测的Python脚本。

**投毒风险：**
虽然提供的Python脚本主要功能是利用SQL注入漏洞，但仍存在一定的投毒风险。风险点在于`PROXY`变量的使用。如果攻击者修改了脚本中的代理地址，例如设置为一个恶意代理服务器，则可以通过该代理服务器捕获或篡改经过该代理的流量。例如脚本片段：
`PROXY = "http://127.0.0.1:8080/" if False else None`
如果将`False`修改为`True`， 并且用户使用了恶意的代理，则可能被投毒。此外，如果脚本被修改为执行恶意代码（例如下载和执行其他程序），则存在更大的风险。总体来说，投毒风险较低，约为10%，主要取决于用户是否会使用来路不明的代理或修改脚本本身。

**利用方式：**
利用方式如下：
1.  **获取可用功能名称：** 通过发送`GetCapabilities`请求到`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`端点，获取GeoServer支持的WFS功能名称。
2.  **获取相关功能可用属性：** 针对特定功能名称，例如`vulhub:example`，发送`DescribeFeatureType`请求到`/geoserver/wfs?request=DescribeFeatureType&version=2.0.0&service=WFS&outputFormat=application/json&typeName=vulhub:example`端点，获取该功能的可用属性列表。
3.  **构造SQL注入Payload：** 针对特定属性，构造包含SQL注入的`CQL_FILTER`参数，发送`GetFeature`请求到`/geoserver/ows`端点。例如：
`/geoserver/ows?service=wfs&version=1.0.0&request=GetFeature&typeName=vulhub:example&CQL_FILTER=strStartsWith(name,'x'')+=+true+and+1=(SELECT+CAST+((SELECT+version())+AS+INTEGER))+--+')+=+true`
此payload利用了`strStartsWith`函数和`CQL_FILTER`参数，注入SQL代码来执行数据库操作，如获取数据库版本信息。
4.  **验证与自动化：** 提供的`exp.py`脚本自动化了上述过程。它首先从目标GeoServer获取功能列表和属性，然后针对每个属性构造SQL注入payload，并检查响应中是否包含错误信息，以此判断漏洞是否存在。

**项目地址:** [charis3306/CVE-2023-25157](https://github.com/charis3306/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #5

**来源**: [CVE-2023-25157-custiya_geoserver-CVE-2023-25157.md](../2023/CVE-2023-25157-custiya_geoserver-CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，GeoServer实例运行，存在可访问的WFS/WMS/WCS服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-25157是GeoServer中的一个SQL注入漏洞。漏洞存在于OGC Filter表达式语言和OGC Common Query Language (CQL) 的处理中，影响Web Feature Service (WFS)、Web Map Service (WMS) 协议以及Web Coverage Service (WCS)协议中ImageMosaic coverages对CQL的支持。

**有效性：**
提供的`docker-compose.yml`文件设置了一个包含易受攻击的GeoServer实例(2.22.1)的环境，它依赖于PostGIS数据库。 `startup.sh`启动脚本如果包含恶意代码，则能成功搭建环境并执行攻击，验证此漏洞的存在。综合搜索引擎结果和漏洞库信息,漏洞利用是有效的。

**投毒风险：**
`docker-compose.yml` 文件本身并不包含恶意代码，但它挂载了`./startup.sh`脚本，这引入了投毒的可能。如果 `startup.sh` 包含任何恶意指令 (例如下载并执行恶意脚本、修改GeoServer配置以允许未授权访问、或安装后门)，那么该仓库就存在投毒风险。在没有`startup.sh` 脚本内容的情况下，无法完全确定投毒的程度，推测投毒概率为10%。 谨慎使用此仓库。

**利用方式：**
该漏洞的利用方式通常涉及构造恶意的CQL或OGC Filter表达式，将其注入到WFS/WMS/WCS请求的参数中。由于GeoServer没有正确过滤这些表达式，恶意SQL代码会被执行，从而可能允许攻击者执行任意SQL命令，包括读取、修改或删除数据库中的数据，甚至执行操作系统命令（如果数据库配置允许）。攻击者可能通过 `PropertyIsLike` filter（配合String字段和任意数据库DataStore，或PostGIS DataStore且开启 encode functions）或 `FeatureId` 配合不安全的设置触发漏洞。修复方案包括升级到指定版本或禁用/启用相应的PostGIS Datastore设置。

**项目地址:** [custiya/geoserver-CVE-2023-25157](https://github.com/custiya/geoserver-CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #6

**来源**: [CVE-2023-25157-dr-cable-tv_Geoserver-CVE-2023-25157.md](../2023/CVE-2023-25157-dr-cable-tv_Geoserver-CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，目标GeoServer实例存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞是GeoServer中的SQL注入漏洞，源于对OGC Filter表达式语言和OGC Common Query Language (CQL) 的不当处理。攻击者可以通过构造恶意的CQL_FILTER参数，利用`strEndsWith`，`strStartsWith`和`PropertyIsLike`函数，或者`FeatureId`绕过防御，执行任意SQL查询。

**有效性：**
根据提供的漏洞库信息和搜索引擎结果，此漏洞影响特定版本的GeoServer，且有可用的PoC代码。PoC代码通过构造恶意的CQL_FILTER参数进行攻击，尝试注入SQL语句以获取数据库版本信息。提供的`dbFinder.py`脚本首先尝试连接到目标GeoServer实例，然后获取FeatureType名称，并使用精心构造的CQL_FILTER尝试执行SQL注入。PoC代码有效。

**投毒风险：**
分析提供的PoC代码，`dbFinder.py` 主要功能是检测目标是否存在漏洞，其核心在于构造恶意的CQL_FILTER，没有发现明显的恶意行为或后门代码。`README.md` 只是提供了漏洞说明和使用方法。投毒风险较低，但仍需注意，因为任何从互联网上获取的代码都存在潜在风险，建议在使用前进行代码审查。 此处的投毒风险主要考虑作者是否在代码中隐藏了其他恶意行为，例如上传敏感信息等。鉴于代码功能较为简单，且主要依赖于SQL注入，因此判断投毒可能性较低，为5%。

**利用方式：**
1.  攻击者首先需要确定目标GeoServer实例的版本是否在受影响范围内（< 2.21.4, >= 2.22.0, < 2.22.2）。
2.  利用提供的PoC脚本或者其他方式，构造包含恶意SQL语句的CQL_FILTER参数。
3.  将构造的CQL_FILTER参数附加到WFS GetFeature请求中，例如：
    `/geoserver/ows?service=wfs&version=1.0.0&request=GetFeature&typeName=<featureType>&CQL_FILTER=<恶意CQL_FILTER>`
4.  如果目标存在漏洞，恶意SQL语句将被执行，攻击者可以获取数据库中的敏感信息，甚至执行任意代码。

**缓解措施：**
*   升级GeoServer到不受影响的版本（>= 2.21.4 或 >= 2.22.2）。
*   如果无法升级，禁用PostGIS Datastore的*encode functions*设置，并启用*preparedStatements*设置。

**项目地址:** [dr-cable-tv/Geoserver-CVE-2023-25157](https://github.com/dr-cable-tv/Geoserver-CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #7

**来源**: [CVE-2023-25157-murataydemir_CVE-2023-25157-and-CVE-2023-25158.md](../2023/CVE-2023-25157-murataydemir_CVE-2023-25157-and-CVE-2023-25158.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致未授权信息泄露、数据篡改和服务中断

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要GeoServer实例运行，且满足特定配置条件，例如PostGIS DataStore启用encode functions，或数据库表具有String主键列且prepared statements被禁用等。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的SQL注入漏洞，利用OGC Filter表达式语言和CQL（Common Query Language）的不当处理。根据漏洞利用代码描述，多个函数和过滤器都存在注入点：

*   `PropertyIsLike` filter: 当与String字段一起使用时，任何关系数据库的存储都会受到影响；PostGIS DataStore启用encode functions；或者image mosaic的索引存储在关系数据库中。
*   `strEndsWith` function: 当与PostGIS DataStore一起使用且encode functions启用时。
*   `strStartsWith` function: 当与PostGIS DataStore一起使用且encode functions启用时。
*   `FeatureId` filter: 当数据库表的String主键列使用时且prepared statements禁用时。
*   `jsonArrayContains` function: 当与String或JSON字段一起使用且与PostGIS或Oracle DataStore（仅在GeoServer 2.22.0及更高版本中）一起使用时。
*   `DWithin` filter: 当与Oracle DataStore一起使用时。

利用方式包括构造恶意的OGC Filter或CQL表达式，通过WFS、WMS或WCS协议发送给GeoServer，从而执行任意SQL命令。这可能导致敏感数据泄露、数据修改甚至服务中断。提供的POC代码库包含漏洞的详细描述和复现步骤，表明该漏洞的有效性较高。搜索引擎结果也证实了该漏洞的存在和危害。

关于投毒风险，由于POC代码只是提供漏洞复现和利用的步骤，主要关注点在于利用方式，并无发现明显的恶意代码，比如下载执行恶意脚本，上传恶意文件等操作。但是，如果攻击者修改了提供的POC并植入恶意代码，使用户在测试时受到攻击，则存在一定投毒风险。因此，将投毒风险评估为10%。

**项目地址:** [murataydemir/CVE-2023-25157-and-CVE-2023-25158](https://github.com/murataydemir/CVE-2023-25157-and-CVE-2023-25158)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #8

**来源**: [CVE-2023-25157-win3zz_CVE-2023-25157.md](../2023/CVE-2023-25157-win3zz_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，GeoServer服务开启，目标存在漏洞版本的GeoServer

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞，存在于OGC Filter表达式语言和OGC Common Query Language (CQL)的支持中。攻击者可以通过WFS和WMS协议，或者WCS协议（针对ImageMosaic覆盖），注入恶意的SQL代码。PoC代码通过构造包含恶意SQL语句的CQL_FILTER参数，发送到存在漏洞的GeoServer实例，利用`strStartsWith`等函数进行SQL注入。虽然代码整体上是用于验证漏洞的，但存在潜在投毒风险，例如，攻击者可能会修改PoC，使其包含更具破坏性的SQL payload，或者在大型环境中分发这些修改后的PoC，达到攻击的目的。代码本身的危害较小，但被恶意修改后风险增大。

**项目地址:** [win3zz/CVE-2023-25157](https://github.com/win3zz/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---



---

## POC #4

**来源**: [CVE-2023-25157-charis3306_CVE-2023-25157.md](../2023/CVE-2023-25157-charis3306_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致敏感信息泄露、数据篡改、甚至服务器权限获取

**影响版本:** 2.20.x < 2.20.7, 2.19.x < 2.19.7, 2.18.x < 2.18.7, 2.21.x < 2.21.4, 2.22.x < 2.22.2

**利用条件:** GeoServer服务开启，目标存在漏洞版本，且允许未授权网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。由于GeoServer对用户输入过滤不严格，远程未授权攻击者可以构造畸形的过滤语法，绕过GeoServer的词法解析，从而造成SQL注入。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的利用是有效的。PoC代码中提供了利用此漏洞的请求示例，以及用于自动化检测的Python脚本。

**投毒风险：**
虽然提供的Python脚本主要功能是利用SQL注入漏洞，但仍存在一定的投毒风险。风险点在于`PROXY`变量的使用。如果攻击者修改了脚本中的代理地址，例如设置为一个恶意代理服务器，则可以通过该代理服务器捕获或篡改经过该代理的流量。例如脚本片段：
`PROXY = "http://127.0.0.1:8080/" if False else None`
如果将`False`修改为`True`， 并且用户使用了恶意的代理，则可能被投毒。此外，如果脚本被修改为执行恶意代码（例如下载和执行其他程序），则存在更大的风险。总体来说，投毒风险较低，约为10%，主要取决于用户是否会使用来路不明的代理或修改脚本本身。

**利用方式：**
利用方式如下：
1.  **获取可用功能名称：** 通过发送`GetCapabilities`请求到`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`端点，获取GeoServer支持的WFS功能名称。
2.  **获取相关功能可用属性：** 针对特定功能名称，例如`vulhub:example`，发送`DescribeFeatureType`请求到`/geoserver/wfs?request=DescribeFeatureType&version=2.0.0&service=WFS&outputFormat=application/json&typeName=vulhub:example`端点，获取该功能的可用属性列表。
3.  **构造SQL注入Payload：** 针对特定属性，构造包含SQL注入的`CQL_FILTER`参数，发送`GetFeature`请求到`/geoserver/ows`端点。例如：
`/geoserver/ows?service=wfs&version=1.0.0&request=GetFeature&typeName=vulhub:example&CQL_FILTER=strStartsWith(name,'x'')+=+true+and+1=(SELECT+CAST+((SELECT+version())+AS+INTEGER))+--+')+=+true`
此payload利用了`strStartsWith`函数和`CQL_FILTER`参数，注入SQL代码来执行数据库操作，如获取数据库版本信息。
4.  **验证与自动化：** 提供的`exp.py`脚本自动化了上述过程。它首先从目标GeoServer获取功能列表和属性，然后针对每个属性构造SQL注入payload，并检查响应中是否包含错误信息，以此判断漏洞是否存在。

**项目地址:** [charis3306/CVE-2023-25157](https://github.com/charis3306/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #5

**来源**: [CVE-2023-25157-custiya_geoserver-CVE-2023-25157.md](../2023/CVE-2023-25157-custiya_geoserver-CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，GeoServer实例运行，存在可访问的WFS/WMS/WCS服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-25157是GeoServer中的一个SQL注入漏洞。漏洞存在于OGC Filter表达式语言和OGC Common Query Language (CQL) 的处理中，影响Web Feature Service (WFS)、Web Map Service (WMS) 协议以及Web Coverage Service (WCS)协议中ImageMosaic coverages对CQL的支持。

**有效性：**
提供的`docker-compose.yml`文件设置了一个包含易受攻击的GeoServer实例(2.22.1)的环境，它依赖于PostGIS数据库。 `startup.sh`启动脚本如果包含恶意代码，则能成功搭建环境并执行攻击，验证此漏洞的存在。综合搜索引擎结果和漏洞库信息,漏洞利用是有效的。

**投毒风险：**
`docker-compose.yml` 文件本身并不包含恶意代码，但它挂载了`./startup.sh`脚本，这引入了投毒的可能。如果 `startup.sh` 包含任何恶意指令 (例如下载并执行恶意脚本、修改GeoServer配置以允许未授权访问、或安装后门)，那么该仓库就存在投毒风险。在没有`startup.sh` 脚本内容的情况下，无法完全确定投毒的程度，推测投毒概率为10%。 谨慎使用此仓库。

**利用方式：**
该漏洞的利用方式通常涉及构造恶意的CQL或OGC Filter表达式，将其注入到WFS/WMS/WCS请求的参数中。由于GeoServer没有正确过滤这些表达式，恶意SQL代码会被执行，从而可能允许攻击者执行任意SQL命令，包括读取、修改或删除数据库中的数据，甚至执行操作系统命令（如果数据库配置允许）。攻击者可能通过 `PropertyIsLike` filter（配合String字段和任意数据库DataStore，或PostGIS DataStore且开启 encode functions）或 `FeatureId` 配合不安全的设置触发漏洞。修复方案包括升级到指定版本或禁用/启用相应的PostGIS Datastore设置。

**项目地址:** [custiya/geoserver-CVE-2023-25157](https://github.com/custiya/geoserver-CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #6

**来源**: [CVE-2023-25157-dr-cable-tv_Geoserver-CVE-2023-25157.md](../2023/CVE-2023-25157-dr-cable-tv_Geoserver-CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，目标GeoServer实例存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞是GeoServer中的SQL注入漏洞，源于对OGC Filter表达式语言和OGC Common Query Language (CQL) 的不当处理。攻击者可以通过构造恶意的CQL_FILTER参数，利用`strEndsWith`，`strStartsWith`和`PropertyIsLike`函数，或者`FeatureId`绕过防御，执行任意SQL查询。

**有效性：**
根据提供的漏洞库信息和搜索引擎结果，此漏洞影响特定版本的GeoServer，且有可用的PoC代码。PoC代码通过构造恶意的CQL_FILTER参数进行攻击，尝试注入SQL语句以获取数据库版本信息。提供的`dbFinder.py`脚本首先尝试连接到目标GeoServer实例，然后获取FeatureType名称，并使用精心构造的CQL_FILTER尝试执行SQL注入。PoC代码有效。

**投毒风险：**
分析提供的PoC代码，`dbFinder.py` 主要功能是检测目标是否存在漏洞，其核心在于构造恶意的CQL_FILTER，没有发现明显的恶意行为或后门代码。`README.md` 只是提供了漏洞说明和使用方法。投毒风险较低，但仍需注意，因为任何从互联网上获取的代码都存在潜在风险，建议在使用前进行代码审查。 此处的投毒风险主要考虑作者是否在代码中隐藏了其他恶意行为，例如上传敏感信息等。鉴于代码功能较为简单，且主要依赖于SQL注入，因此判断投毒可能性较低，为5%。

**利用方式：**
1.  攻击者首先需要确定目标GeoServer实例的版本是否在受影响范围内（< 2.21.4, >= 2.22.0, < 2.22.2）。
2.  利用提供的PoC脚本或者其他方式，构造包含恶意SQL语句的CQL_FILTER参数。
3.  将构造的CQL_FILTER参数附加到WFS GetFeature请求中，例如：
    `/geoserver/ows?service=wfs&version=1.0.0&request=GetFeature&typeName=<featureType>&CQL_FILTER=<恶意CQL_FILTER>`
4.  如果目标存在漏洞，恶意SQL语句将被执行，攻击者可以获取数据库中的敏感信息，甚至执行任意代码。

**缓解措施：**
*   升级GeoServer到不受影响的版本（>= 2.21.4 或 >= 2.22.2）。
*   如果无法升级，禁用PostGIS Datastore的*encode functions*设置，并启用*preparedStatements*设置。

**项目地址:** [dr-cable-tv/Geoserver-CVE-2023-25157](https://github.com/dr-cable-tv/Geoserver-CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #7

**来源**: [CVE-2023-25157-murataydemir_CVE-2023-25157-and-CVE-2023-25158.md](../2023/CVE-2023-25157-murataydemir_CVE-2023-25157-and-CVE-2023-25158.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致未授权信息泄露、数据篡改和服务中断

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要GeoServer实例运行，且满足特定配置条件，例如PostGIS DataStore启用encode functions，或数据库表具有String主键列且prepared statements被禁用等。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的SQL注入漏洞，利用OGC Filter表达式语言和CQL（Common Query Language）的不当处理。根据漏洞利用代码描述，多个函数和过滤器都存在注入点：

*   `PropertyIsLike` filter: 当与String字段一起使用时，任何关系数据库的存储都会受到影响；PostGIS DataStore启用encode functions；或者image mosaic的索引存储在关系数据库中。
*   `strEndsWith` function: 当与PostGIS DataStore一起使用且encode functions启用时。
*   `strStartsWith` function: 当与PostGIS DataStore一起使用且encode functions启用时。
*   `FeatureId` filter: 当数据库表的String主键列使用时且prepared statements禁用时。
*   `jsonArrayContains` function: 当与String或JSON字段一起使用且与PostGIS或Oracle DataStore（仅在GeoServer 2.22.0及更高版本中）一起使用时。
*   `DWithin` filter: 当与Oracle DataStore一起使用时。

利用方式包括构造恶意的OGC Filter或CQL表达式，通过WFS、WMS或WCS协议发送给GeoServer，从而执行任意SQL命令。这可能导致敏感数据泄露、数据修改甚至服务中断。提供的POC代码库包含漏洞的详细描述和复现步骤，表明该漏洞的有效性较高。搜索引擎结果也证实了该漏洞的存在和危害。

关于投毒风险，由于POC代码只是提供漏洞复现和利用的步骤，主要关注点在于利用方式，并无发现明显的恶意代码，比如下载执行恶意脚本，上传恶意文件等操作。但是，如果攻击者修改了提供的POC并植入恶意代码，使用户在测试时受到攻击，则存在一定投毒风险。因此，将投毒风险评估为10%。

**项目地址:** [murataydemir/CVE-2023-25157-and-CVE-2023-25158](https://github.com/murataydemir/CVE-2023-25157-and-CVE-2023-25158)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #8

**来源**: [CVE-2023-25157-win3zz_CVE-2023-25157.md](../2023/CVE-2023-25157-win3zz_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，GeoServer服务开启，目标存在漏洞版本的GeoServer

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞，存在于OGC Filter表达式语言和OGC Common Query Language (CQL)的支持中。攻击者可以通过WFS和WMS协议，或者WCS协议（针对ImageMosaic覆盖），注入恶意的SQL代码。PoC代码通过构造包含恶意SQL语句的CQL_FILTER参数，发送到存在漏洞的GeoServer实例，利用`strStartsWith`等函数进行SQL注入。虽然代码整体上是用于验证漏洞的，但存在潜在投毒风险，例如，攻击者可能会修改PoC，使其包含更具破坏性的SQL payload，或者在大型环境中分发这些修改后的PoC，达到攻击的目的。代码本身的危害较小，但被恶意修改后风险增大。

**项目地址:** [win3zz/CVE-2023-25157](https://github.com/win3zz/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---



---

## POC #4

**来源**: [CVE-2023-25157-charis3306_CVE-2023-25157.md](../2023/CVE-2023-25157-charis3306_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致敏感信息泄露、数据篡改、甚至服务器权限获取

**影响版本:** 2.20.x < 2.20.7, 2.19.x < 2.19.7, 2.18.x < 2.18.7, 2.21.x < 2.21.4, 2.22.x < 2.22.2

**利用条件:** GeoServer服务开启，目标存在漏洞版本，且允许未授权网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。由于GeoServer对用户输入过滤不严格，远程未授权攻击者可以构造畸形的过滤语法，绕过GeoServer的词法解析，从而造成SQL注入。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的利用是有效的。PoC代码中提供了利用此漏洞的请求示例，以及用于自动化检测的Python脚本。

**投毒风险：**
虽然提供的Python脚本主要功能是利用SQL注入漏洞，但仍存在一定的投毒风险。风险点在于`PROXY`变量的使用。如果攻击者修改了脚本中的代理地址，例如设置为一个恶意代理服务器，则可以通过该代理服务器捕获或篡改经过该代理的流量。例如脚本片段：
`PROXY = "http://127.0.0.1:8080/" if False else None`
如果将`False`修改为`True`， 并且用户使用了恶意的代理，则可能被投毒。此外，如果脚本被修改为执行恶意代码（例如下载和执行其他程序），则存在更大的风险。总体来说，投毒风险较低，约为10%，主要取决于用户是否会使用来路不明的代理或修改脚本本身。

**利用方式：**
利用方式如下：
1.  **获取可用功能名称：** 通过发送`GetCapabilities`请求到`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`端点，获取GeoServer支持的WFS功能名称。
2.  **获取相关功能可用属性：** 针对特定功能名称，例如`vulhub:example`，发送`DescribeFeatureType`请求到`/geoserver/wfs?request=DescribeFeatureType&version=2.0.0&service=WFS&outputFormat=application/json&typeName=vulhub:example`端点，获取该功能的可用属性列表。
3.  **构造SQL注入Payload：** 针对特定属性，构造包含SQL注入的`CQL_FILTER`参数，发送`GetFeature`请求到`/geoserver/ows`端点。例如：
`/geoserver/ows?service=wfs&version=1.0.0&request=GetFeature&typeName=vulhub:example&CQL_FILTER=strStartsWith(name,'x'')+=+true+and+1=(SELECT+CAST+((SELECT+version())+AS+INTEGER))+--+')+=+true`
此payload利用了`strStartsWith`函数和`CQL_FILTER`参数，注入SQL代码来执行数据库操作，如获取数据库版本信息。
4.  **验证与自动化：** 提供的`exp.py`脚本自动化了上述过程。它首先从目标GeoServer获取功能列表和属性，然后针对每个属性构造SQL注入payload，并检查响应中是否包含错误信息，以此判断漏洞是否存在。

**项目地址:** [charis3306/CVE-2023-25157](https://github.com/charis3306/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #5

**来源**: [CVE-2023-25157-custiya_geoserver-CVE-2023-25157.md](../2023/CVE-2023-25157-custiya_geoserver-CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，GeoServer实例运行，存在可访问的WFS/WMS/WCS服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-25157是GeoServer中的一个SQL注入漏洞。漏洞存在于OGC Filter表达式语言和OGC Common Query Language (CQL) 的处理中，影响Web Feature Service (WFS)、Web Map Service (WMS) 协议以及Web Coverage Service (WCS)协议中ImageMosaic coverages对CQL的支持。

**有效性：**
提供的`docker-compose.yml`文件设置了一个包含易受攻击的GeoServer实例(2.22.1)的环境，它依赖于PostGIS数据库。 `startup.sh`启动脚本如果包含恶意代码，则能成功搭建环境并执行攻击，验证此漏洞的存在。综合搜索引擎结果和漏洞库信息,漏洞利用是有效的。

**投毒风险：**
`docker-compose.yml` 文件本身并不包含恶意代码，但它挂载了`./startup.sh`脚本，这引入了投毒的可能。如果 `startup.sh` 包含任何恶意指令 (例如下载并执行恶意脚本、修改GeoServer配置以允许未授权访问、或安装后门)，那么该仓库就存在投毒风险。在没有`startup.sh` 脚本内容的情况下，无法完全确定投毒的程度，推测投毒概率为10%。 谨慎使用此仓库。

**利用方式：**
该漏洞的利用方式通常涉及构造恶意的CQL或OGC Filter表达式，将其注入到WFS/WMS/WCS请求的参数中。由于GeoServer没有正确过滤这些表达式，恶意SQL代码会被执行，从而可能允许攻击者执行任意SQL命令，包括读取、修改或删除数据库中的数据，甚至执行操作系统命令（如果数据库配置允许）。攻击者可能通过 `PropertyIsLike` filter（配合String字段和任意数据库DataStore，或PostGIS DataStore且开启 encode functions）或 `FeatureId` 配合不安全的设置触发漏洞。修复方案包括升级到指定版本或禁用/启用相应的PostGIS Datastore设置。

**项目地址:** [custiya/geoserver-CVE-2023-25157](https://github.com/custiya/geoserver-CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #6

**来源**: [CVE-2023-25157-dr-cable-tv_Geoserver-CVE-2023-25157.md](../2023/CVE-2023-25157-dr-cable-tv_Geoserver-CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，目标GeoServer实例存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞是GeoServer中的SQL注入漏洞，源于对OGC Filter表达式语言和OGC Common Query Language (CQL) 的不当处理。攻击者可以通过构造恶意的CQL_FILTER参数，利用`strEndsWith`，`strStartsWith`和`PropertyIsLike`函数，或者`FeatureId`绕过防御，执行任意SQL查询。

**有效性：**
根据提供的漏洞库信息和搜索引擎结果，此漏洞影响特定版本的GeoServer，且有可用的PoC代码。PoC代码通过构造恶意的CQL_FILTER参数进行攻击，尝试注入SQL语句以获取数据库版本信息。提供的`dbFinder.py`脚本首先尝试连接到目标GeoServer实例，然后获取FeatureType名称，并使用精心构造的CQL_FILTER尝试执行SQL注入。PoC代码有效。

**投毒风险：**
分析提供的PoC代码，`dbFinder.py` 主要功能是检测目标是否存在漏洞，其核心在于构造恶意的CQL_FILTER，没有发现明显的恶意行为或后门代码。`README.md` 只是提供了漏洞说明和使用方法。投毒风险较低，但仍需注意，因为任何从互联网上获取的代码都存在潜在风险，建议在使用前进行代码审查。 此处的投毒风险主要考虑作者是否在代码中隐藏了其他恶意行为，例如上传敏感信息等。鉴于代码功能较为简单，且主要依赖于SQL注入，因此判断投毒可能性较低，为5%。

**利用方式：**
1.  攻击者首先需要确定目标GeoServer实例的版本是否在受影响范围内（< 2.21.4, >= 2.22.0, < 2.22.2）。
2.  利用提供的PoC脚本或者其他方式，构造包含恶意SQL语句的CQL_FILTER参数。
3.  将构造的CQL_FILTER参数附加到WFS GetFeature请求中，例如：
    `/geoserver/ows?service=wfs&version=1.0.0&request=GetFeature&typeName=<featureType>&CQL_FILTER=<恶意CQL_FILTER>`
4.  如果目标存在漏洞，恶意SQL语句将被执行，攻击者可以获取数据库中的敏感信息，甚至执行任意代码。

**缓解措施：**
*   升级GeoServer到不受影响的版本（>= 2.21.4 或 >= 2.22.2）。
*   如果无法升级，禁用PostGIS Datastore的*encode functions*设置，并启用*preparedStatements*设置。

**项目地址:** [dr-cable-tv/Geoserver-CVE-2023-25157](https://github.com/dr-cable-tv/Geoserver-CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #7

**来源**: [CVE-2023-25157-murataydemir_CVE-2023-25157-and-CVE-2023-25158.md](../2023/CVE-2023-25157-murataydemir_CVE-2023-25157-and-CVE-2023-25158.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致未授权信息泄露、数据篡改和服务中断

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要GeoServer实例运行，且满足特定配置条件，例如PostGIS DataStore启用encode functions，或数据库表具有String主键列且prepared statements被禁用等。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的SQL注入漏洞，利用OGC Filter表达式语言和CQL（Common Query Language）的不当处理。根据漏洞利用代码描述，多个函数和过滤器都存在注入点：

*   `PropertyIsLike` filter: 当与String字段一起使用时，任何关系数据库的存储都会受到影响；PostGIS DataStore启用encode functions；或者image mosaic的索引存储在关系数据库中。
*   `strEndsWith` function: 当与PostGIS DataStore一起使用且encode functions启用时。
*   `strStartsWith` function: 当与PostGIS DataStore一起使用且encode functions启用时。
*   `FeatureId` filter: 当数据库表的String主键列使用时且prepared statements禁用时。
*   `jsonArrayContains` function: 当与String或JSON字段一起使用且与PostGIS或Oracle DataStore（仅在GeoServer 2.22.0及更高版本中）一起使用时。
*   `DWithin` filter: 当与Oracle DataStore一起使用时。

利用方式包括构造恶意的OGC Filter或CQL表达式，通过WFS、WMS或WCS协议发送给GeoServer，从而执行任意SQL命令。这可能导致敏感数据泄露、数据修改甚至服务中断。提供的POC代码库包含漏洞的详细描述和复现步骤，表明该漏洞的有效性较高。搜索引擎结果也证实了该漏洞的存在和危害。

关于投毒风险，由于POC代码只是提供漏洞复现和利用的步骤，主要关注点在于利用方式，并无发现明显的恶意代码，比如下载执行恶意脚本，上传恶意文件等操作。但是，如果攻击者修改了提供的POC并植入恶意代码，使用户在测试时受到攻击，则存在一定投毒风险。因此，将投毒风险评估为10%。

**项目地址:** [murataydemir/CVE-2023-25157-and-CVE-2023-25158](https://github.com/murataydemir/CVE-2023-25157-and-CVE-2023-25158)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #8

**来源**: [CVE-2023-25157-win3zz_CVE-2023-25157.md](../2023/CVE-2023-25157-win3zz_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，GeoServer服务开启，目标存在漏洞版本的GeoServer

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞，存在于OGC Filter表达式语言和OGC Common Query Language (CQL)的支持中。攻击者可以通过WFS和WMS协议，或者WCS协议（针对ImageMosaic覆盖），注入恶意的SQL代码。PoC代码通过构造包含恶意SQL语句的CQL_FILTER参数，发送到存在漏洞的GeoServer实例，利用`strStartsWith`等函数进行SQL注入。虽然代码整体上是用于验证漏洞的，但存在潜在投毒风险，例如，攻击者可能会修改PoC，使其包含更具破坏性的SQL payload，或者在大型环境中分发这些修改后的PoC，达到攻击的目的。代码本身的危害较小，但被恶意修改后风险增大。

**项目地址:** [win3zz/CVE-2023-25157](https://github.com/win3zz/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---



---

## POC #4

**来源**: [CVE-2023-25157-charis3306_CVE-2023-25157.md](../2023/CVE-2023-25157-charis3306_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致敏感信息泄露、数据篡改、甚至服务器权限获取

**影响版本:** 2.20.x < 2.20.7, 2.19.x < 2.19.7, 2.18.x < 2.18.7, 2.21.x < 2.21.4, 2.22.x < 2.22.2

**利用条件:** GeoServer服务开启，目标存在漏洞版本，且允许未授权网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。由于GeoServer对用户输入过滤不严格，远程未授权攻击者可以构造畸形的过滤语法，绕过GeoServer的词法解析，从而造成SQL注入。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的利用是有效的。PoC代码中提供了利用此漏洞的请求示例，以及用于自动化检测的Python脚本。

**投毒风险：**
虽然提供的Python脚本主要功能是利用SQL注入漏洞，但仍存在一定的投毒风险。风险点在于`PROXY`变量的使用。如果攻击者修改了脚本中的代理地址，例如设置为一个恶意代理服务器，则可以通过该代理服务器捕获或篡改经过该代理的流量。例如脚本片段：
`PROXY = "http://127.0.0.1:8080/" if False else None`
如果将`False`修改为`True`， 并且用户使用了恶意的代理，则可能被投毒。此外，如果脚本被修改为执行恶意代码（例如下载和执行其他程序），则存在更大的风险。总体来说，投毒风险较低，约为10%，主要取决于用户是否会使用来路不明的代理或修改脚本本身。

**利用方式：**
利用方式如下：
1.  **获取可用功能名称：** 通过发送`GetCapabilities`请求到`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`端点，获取GeoServer支持的WFS功能名称。
2.  **获取相关功能可用属性：** 针对特定功能名称，例如`vulhub:example`，发送`DescribeFeatureType`请求到`/geoserver/wfs?request=DescribeFeatureType&version=2.0.0&service=WFS&outputFormat=application/json&typeName=vulhub:example`端点，获取该功能的可用属性列表。
3.  **构造SQL注入Payload：** 针对特定属性，构造包含SQL注入的`CQL_FILTER`参数，发送`GetFeature`请求到`/geoserver/ows`端点。例如：
`/geoserver/ows?service=wfs&version=1.0.0&request=GetFeature&typeName=vulhub:example&CQL_FILTER=strStartsWith(name,'x'')+=+true+and+1=(SELECT+CAST+((SELECT+version())+AS+INTEGER))+--+')+=+true`
此payload利用了`strStartsWith`函数和`CQL_FILTER`参数，注入SQL代码来执行数据库操作，如获取数据库版本信息。
4.  **验证与自动化：** 提供的`exp.py`脚本自动化了上述过程。它首先从目标GeoServer获取功能列表和属性，然后针对每个属性构造SQL注入payload，并检查响应中是否包含错误信息，以此判断漏洞是否存在。

**项目地址:** [charis3306/CVE-2023-25157](https://github.com/charis3306/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #5

**来源**: [CVE-2023-25157-custiya_geoserver-CVE-2023-25157.md](../2023/CVE-2023-25157-custiya_geoserver-CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，GeoServer实例运行，存在可访问的WFS/WMS/WCS服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-25157是GeoServer中的一个SQL注入漏洞。漏洞存在于OGC Filter表达式语言和OGC Common Query Language (CQL) 的处理中，影响Web Feature Service (WFS)、Web Map Service (WMS) 协议以及Web Coverage Service (WCS)协议中ImageMosaic coverages对CQL的支持。

**有效性：**
提供的`docker-compose.yml`文件设置了一个包含易受攻击的GeoServer实例(2.22.1)的环境，它依赖于PostGIS数据库。 `startup.sh`启动脚本如果包含恶意代码，则能成功搭建环境并执行攻击，验证此漏洞的存在。综合搜索引擎结果和漏洞库信息,漏洞利用是有效的。

**投毒风险：**
`docker-compose.yml` 文件本身并不包含恶意代码，但它挂载了`./startup.sh`脚本，这引入了投毒的可能。如果 `startup.sh` 包含任何恶意指令 (例如下载并执行恶意脚本、修改GeoServer配置以允许未授权访问、或安装后门)，那么该仓库就存在投毒风险。在没有`startup.sh` 脚本内容的情况下，无法完全确定投毒的程度，推测投毒概率为10%。 谨慎使用此仓库。

**利用方式：**
该漏洞的利用方式通常涉及构造恶意的CQL或OGC Filter表达式，将其注入到WFS/WMS/WCS请求的参数中。由于GeoServer没有正确过滤这些表达式，恶意SQL代码会被执行，从而可能允许攻击者执行任意SQL命令，包括读取、修改或删除数据库中的数据，甚至执行操作系统命令（如果数据库配置允许）。攻击者可能通过 `PropertyIsLike` filter（配合String字段和任意数据库DataStore，或PostGIS DataStore且开启 encode functions）或 `FeatureId` 配合不安全的设置触发漏洞。修复方案包括升级到指定版本或禁用/启用相应的PostGIS Datastore设置。

**项目地址:** [custiya/geoserver-CVE-2023-25157](https://github.com/custiya/geoserver-CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #6

**来源**: [CVE-2023-25157-dr-cable-tv_Geoserver-CVE-2023-25157.md](../2023/CVE-2023-25157-dr-cable-tv_Geoserver-CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，目标GeoServer实例存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞是GeoServer中的SQL注入漏洞，源于对OGC Filter表达式语言和OGC Common Query Language (CQL) 的不当处理。攻击者可以通过构造恶意的CQL_FILTER参数，利用`strEndsWith`，`strStartsWith`和`PropertyIsLike`函数，或者`FeatureId`绕过防御，执行任意SQL查询。

**有效性：**
根据提供的漏洞库信息和搜索引擎结果，此漏洞影响特定版本的GeoServer，且有可用的PoC代码。PoC代码通过构造恶意的CQL_FILTER参数进行攻击，尝试注入SQL语句以获取数据库版本信息。提供的`dbFinder.py`脚本首先尝试连接到目标GeoServer实例，然后获取FeatureType名称，并使用精心构造的CQL_FILTER尝试执行SQL注入。PoC代码有效。

**投毒风险：**
分析提供的PoC代码，`dbFinder.py` 主要功能是检测目标是否存在漏洞，其核心在于构造恶意的CQL_FILTER，没有发现明显的恶意行为或后门代码。`README.md` 只是提供了漏洞说明和使用方法。投毒风险较低，但仍需注意，因为任何从互联网上获取的代码都存在潜在风险，建议在使用前进行代码审查。 此处的投毒风险主要考虑作者是否在代码中隐藏了其他恶意行为，例如上传敏感信息等。鉴于代码功能较为简单，且主要依赖于SQL注入，因此判断投毒可能性较低，为5%。

**利用方式：**
1.  攻击者首先需要确定目标GeoServer实例的版本是否在受影响范围内（< 2.21.4, >= 2.22.0, < 2.22.2）。
2.  利用提供的PoC脚本或者其他方式，构造包含恶意SQL语句的CQL_FILTER参数。
3.  将构造的CQL_FILTER参数附加到WFS GetFeature请求中，例如：
    `/geoserver/ows?service=wfs&version=1.0.0&request=GetFeature&typeName=<featureType>&CQL_FILTER=<恶意CQL_FILTER>`
4.  如果目标存在漏洞，恶意SQL语句将被执行，攻击者可以获取数据库中的敏感信息，甚至执行任意代码。

**缓解措施：**
*   升级GeoServer到不受影响的版本（>= 2.21.4 或 >= 2.22.2）。
*   如果无法升级，禁用PostGIS Datastore的*encode functions*设置，并启用*preparedStatements*设置。

**项目地址:** [dr-cable-tv/Geoserver-CVE-2023-25157](https://github.com/dr-cable-tv/Geoserver-CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #7

**来源**: [CVE-2023-25157-murataydemir_CVE-2023-25157-and-CVE-2023-25158.md](../2023/CVE-2023-25157-murataydemir_CVE-2023-25157-and-CVE-2023-25158.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致未授权信息泄露、数据篡改和服务中断

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要GeoServer实例运行，且满足特定配置条件，例如PostGIS DataStore启用encode functions，或数据库表具有String主键列且prepared statements被禁用等。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的SQL注入漏洞，利用OGC Filter表达式语言和CQL（Common Query Language）的不当处理。根据漏洞利用代码描述，多个函数和过滤器都存在注入点：

*   `PropertyIsLike` filter: 当与String字段一起使用时，任何关系数据库的存储都会受到影响；PostGIS DataStore启用encode functions；或者image mosaic的索引存储在关系数据库中。
*   `strEndsWith` function: 当与PostGIS DataStore一起使用且encode functions启用时。
*   `strStartsWith` function: 当与PostGIS DataStore一起使用且encode functions启用时。
*   `FeatureId` filter: 当数据库表的String主键列使用时且prepared statements禁用时。
*   `jsonArrayContains` function: 当与String或JSON字段一起使用且与PostGIS或Oracle DataStore（仅在GeoServer 2.22.0及更高版本中）一起使用时。
*   `DWithin` filter: 当与Oracle DataStore一起使用时。

利用方式包括构造恶意的OGC Filter或CQL表达式，通过WFS、WMS或WCS协议发送给GeoServer，从而执行任意SQL命令。这可能导致敏感数据泄露、数据修改甚至服务中断。提供的POC代码库包含漏洞的详细描述和复现步骤，表明该漏洞的有效性较高。搜索引擎结果也证实了该漏洞的存在和危害。

关于投毒风险，由于POC代码只是提供漏洞复现和利用的步骤，主要关注点在于利用方式，并无发现明显的恶意代码，比如下载执行恶意脚本，上传恶意文件等操作。但是，如果攻击者修改了提供的POC并植入恶意代码，使用户在测试时受到攻击，则存在一定投毒风险。因此，将投毒风险评估为10%。

**项目地址:** [murataydemir/CVE-2023-25157-and-CVE-2023-25158](https://github.com/murataydemir/CVE-2023-25157-and-CVE-2023-25158)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #8

**来源**: [CVE-2023-25157-win3zz_CVE-2023-25157.md](../2023/CVE-2023-25157-win3zz_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，GeoServer服务开启，目标存在漏洞版本的GeoServer

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞，存在于OGC Filter表达式语言和OGC Common Query Language (CQL)的支持中。攻击者可以通过WFS和WMS协议，或者WCS协议（针对ImageMosaic覆盖），注入恶意的SQL代码。PoC代码通过构造包含恶意SQL语句的CQL_FILTER参数，发送到存在漏洞的GeoServer实例，利用`strStartsWith`等函数进行SQL注入。虽然代码整体上是用于验证漏洞的，但存在潜在投毒风险，例如，攻击者可能会修改PoC，使其包含更具破坏性的SQL payload，或者在大型环境中分发这些修改后的PoC，达到攻击的目的。代码本身的危害较小，但被恶意修改后风险增大。

**项目地址:** [win3zz/CVE-2023-25157](https://github.com/win3zz/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---



---

## POC #4

**来源**: [CVE-2023-25157-charis3306_CVE-2023-25157.md](../2023/CVE-2023-25157-charis3306_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致敏感信息泄露、数据篡改、甚至服务器权限获取

**影响版本:** 2.20.x < 2.20.7, 2.19.x < 2.19.7, 2.18.x < 2.18.7, 2.21.x < 2.21.4, 2.22.x < 2.22.2

**利用条件:** GeoServer服务开启，目标存在漏洞版本，且允许未授权网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。由于GeoServer对用户输入过滤不严格，远程未授权攻击者可以构造畸形的过滤语法，绕过GeoServer的词法解析，从而造成SQL注入。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的利用是有效的。PoC代码中提供了利用此漏洞的请求示例，以及用于自动化检测的Python脚本。

**投毒风险：**
虽然提供的Python脚本主要功能是利用SQL注入漏洞，但仍存在一定的投毒风险。风险点在于`PROXY`变量的使用。如果攻击者修改了脚本中的代理地址，例如设置为一个恶意代理服务器，则可以通过该代理服务器捕获或篡改经过该代理的流量。例如脚本片段：
`PROXY = "http://127.0.0.1:8080/" if False else None`
如果将`False`修改为`True`， 并且用户使用了恶意的代理，则可能被投毒。此外，如果脚本被修改为执行恶意代码（例如下载和执行其他程序），则存在更大的风险。总体来说，投毒风险较低，约为10%，主要取决于用户是否会使用来路不明的代理或修改脚本本身。

**利用方式：**
利用方式如下：
1.  **获取可用功能名称：** 通过发送`GetCapabilities`请求到`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`端点，获取GeoServer支持的WFS功能名称。
2.  **获取相关功能可用属性：** 针对特定功能名称，例如`vulhub:example`，发送`DescribeFeatureType`请求到`/geoserver/wfs?request=DescribeFeatureType&version=2.0.0&service=WFS&outputFormat=application/json&typeName=vulhub:example`端点，获取该功能的可用属性列表。
3.  **构造SQL注入Payload：** 针对特定属性，构造包含SQL注入的`CQL_FILTER`参数，发送`GetFeature`请求到`/geoserver/ows`端点。例如：
`/geoserver/ows?service=wfs&version=1.0.0&request=GetFeature&typeName=vulhub:example&CQL_FILTER=strStartsWith(name,'x'')+=+true+and+1=(SELECT+CAST+((SELECT+version())+AS+INTEGER))+--+')+=+true`
此payload利用了`strStartsWith`函数和`CQL_FILTER`参数，注入SQL代码来执行数据库操作，如获取数据库版本信息。
4.  **验证与自动化：** 提供的`exp.py`脚本自动化了上述过程。它首先从目标GeoServer获取功能列表和属性，然后针对每个属性构造SQL注入payload，并检查响应中是否包含错误信息，以此判断漏洞是否存在。

**项目地址:** [charis3306/CVE-2023-25157](https://github.com/charis3306/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #5

**来源**: [CVE-2023-25157-custiya_geoserver-CVE-2023-25157.md](../2023/CVE-2023-25157-custiya_geoserver-CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，GeoServer实例运行，存在可访问的WFS/WMS/WCS服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-25157是GeoServer中的一个SQL注入漏洞。漏洞存在于OGC Filter表达式语言和OGC Common Query Language (CQL) 的处理中，影响Web Feature Service (WFS)、Web Map Service (WMS) 协议以及Web Coverage Service (WCS)协议中ImageMosaic coverages对CQL的支持。

**有效性：**
提供的`docker-compose.yml`文件设置了一个包含易受攻击的GeoServer实例(2.22.1)的环境，它依赖于PostGIS数据库。 `startup.sh`启动脚本如果包含恶意代码，则能成功搭建环境并执行攻击，验证此漏洞的存在。综合搜索引擎结果和漏洞库信息,漏洞利用是有效的。

**投毒风险：**
`docker-compose.yml` 文件本身并不包含恶意代码，但它挂载了`./startup.sh`脚本，这引入了投毒的可能。如果 `startup.sh` 包含任何恶意指令 (例如下载并执行恶意脚本、修改GeoServer配置以允许未授权访问、或安装后门)，那么该仓库就存在投毒风险。在没有`startup.sh` 脚本内容的情况下，无法完全确定投毒的程度，推测投毒概率为10%。 谨慎使用此仓库。

**利用方式：**
该漏洞的利用方式通常涉及构造恶意的CQL或OGC Filter表达式，将其注入到WFS/WMS/WCS请求的参数中。由于GeoServer没有正确过滤这些表达式，恶意SQL代码会被执行，从而可能允许攻击者执行任意SQL命令，包括读取、修改或删除数据库中的数据，甚至执行操作系统命令（如果数据库配置允许）。攻击者可能通过 `PropertyIsLike` filter（配合String字段和任意数据库DataStore，或PostGIS DataStore且开启 encode functions）或 `FeatureId` 配合不安全的设置触发漏洞。修复方案包括升级到指定版本或禁用/启用相应的PostGIS Datastore设置。

**项目地址:** [custiya/geoserver-CVE-2023-25157](https://github.com/custiya/geoserver-CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #6

**来源**: [CVE-2023-25157-dr-cable-tv_Geoserver-CVE-2023-25157.md](../2023/CVE-2023-25157-dr-cable-tv_Geoserver-CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，目标GeoServer实例存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞是GeoServer中的SQL注入漏洞，源于对OGC Filter表达式语言和OGC Common Query Language (CQL) 的不当处理。攻击者可以通过构造恶意的CQL_FILTER参数，利用`strEndsWith`，`strStartsWith`和`PropertyIsLike`函数，或者`FeatureId`绕过防御，执行任意SQL查询。

**有效性：**
根据提供的漏洞库信息和搜索引擎结果，此漏洞影响特定版本的GeoServer，且有可用的PoC代码。PoC代码通过构造恶意的CQL_FILTER参数进行攻击，尝试注入SQL语句以获取数据库版本信息。提供的`dbFinder.py`脚本首先尝试连接到目标GeoServer实例，然后获取FeatureType名称，并使用精心构造的CQL_FILTER尝试执行SQL注入。PoC代码有效。

**投毒风险：**
分析提供的PoC代码，`dbFinder.py` 主要功能是检测目标是否存在漏洞，其核心在于构造恶意的CQL_FILTER，没有发现明显的恶意行为或后门代码。`README.md` 只是提供了漏洞说明和使用方法。投毒风险较低，但仍需注意，因为任何从互联网上获取的代码都存在潜在风险，建议在使用前进行代码审查。 此处的投毒风险主要考虑作者是否在代码中隐藏了其他恶意行为，例如上传敏感信息等。鉴于代码功能较为简单，且主要依赖于SQL注入，因此判断投毒可能性较低，为5%。

**利用方式：**
1.  攻击者首先需要确定目标GeoServer实例的版本是否在受影响范围内（< 2.21.4, >= 2.22.0, < 2.22.2）。
2.  利用提供的PoC脚本或者其他方式，构造包含恶意SQL语句的CQL_FILTER参数。
3.  将构造的CQL_FILTER参数附加到WFS GetFeature请求中，例如：
    `/geoserver/ows?service=wfs&version=1.0.0&request=GetFeature&typeName=<featureType>&CQL_FILTER=<恶意CQL_FILTER>`
4.  如果目标存在漏洞，恶意SQL语句将被执行，攻击者可以获取数据库中的敏感信息，甚至执行任意代码。

**缓解措施：**
*   升级GeoServer到不受影响的版本（>= 2.21.4 或 >= 2.22.2）。
*   如果无法升级，禁用PostGIS Datastore的*encode functions*设置，并启用*preparedStatements*设置。

**项目地址:** [dr-cable-tv/Geoserver-CVE-2023-25157](https://github.com/dr-cable-tv/Geoserver-CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #7

**来源**: [CVE-2023-25157-murataydemir_CVE-2023-25157-and-CVE-2023-25158.md](../2023/CVE-2023-25157-murataydemir_CVE-2023-25157-and-CVE-2023-25158.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致未授权信息泄露、数据篡改和服务中断

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要GeoServer实例运行，且满足特定配置条件，例如PostGIS DataStore启用encode functions，或数据库表具有String主键列且prepared statements被禁用等。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的SQL注入漏洞，利用OGC Filter表达式语言和CQL（Common Query Language）的不当处理。根据漏洞利用代码描述，多个函数和过滤器都存在注入点：

*   `PropertyIsLike` filter: 当与String字段一起使用时，任何关系数据库的存储都会受到影响；PostGIS DataStore启用encode functions；或者image mosaic的索引存储在关系数据库中。
*   `strEndsWith` function: 当与PostGIS DataStore一起使用且encode functions启用时。
*   `strStartsWith` function: 当与PostGIS DataStore一起使用且encode functions启用时。
*   `FeatureId` filter: 当数据库表的String主键列使用时且prepared statements禁用时。
*   `jsonArrayContains` function: 当与String或JSON字段一起使用且与PostGIS或Oracle DataStore（仅在GeoServer 2.22.0及更高版本中）一起使用时。
*   `DWithin` filter: 当与Oracle DataStore一起使用时。

利用方式包括构造恶意的OGC Filter或CQL表达式，通过WFS、WMS或WCS协议发送给GeoServer，从而执行任意SQL命令。这可能导致敏感数据泄露、数据修改甚至服务中断。提供的POC代码库包含漏洞的详细描述和复现步骤，表明该漏洞的有效性较高。搜索引擎结果也证实了该漏洞的存在和危害。

关于投毒风险，由于POC代码只是提供漏洞复现和利用的步骤，主要关注点在于利用方式，并无发现明显的恶意代码，比如下载执行恶意脚本，上传恶意文件等操作。但是，如果攻击者修改了提供的POC并植入恶意代码，使用户在测试时受到攻击，则存在一定投毒风险。因此，将投毒风险评估为10%。

**项目地址:** [murataydemir/CVE-2023-25157-and-CVE-2023-25158](https://github.com/murataydemir/CVE-2023-25157-and-CVE-2023-25158)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #8

**来源**: [CVE-2023-25157-win3zz_CVE-2023-25157.md](../2023/CVE-2023-25157-win3zz_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，GeoServer服务开启，目标存在漏洞版本的GeoServer

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞，存在于OGC Filter表达式语言和OGC Common Query Language (CQL)的支持中。攻击者可以通过WFS和WMS协议，或者WCS协议（针对ImageMosaic覆盖），注入恶意的SQL代码。PoC代码通过构造包含恶意SQL语句的CQL_FILTER参数，发送到存在漏洞的GeoServer实例，利用`strStartsWith`等函数进行SQL注入。虽然代码整体上是用于验证漏洞的，但存在潜在投毒风险，例如，攻击者可能会修改PoC，使其包含更具破坏性的SQL payload，或者在大型环境中分发这些修改后的PoC，达到攻击的目的。代码本身的危害较小，但被恶意修改后风险增大。

**项目地址:** [win3zz/CVE-2023-25157](https://github.com/win3zz/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---



---

## POC #4

**来源**: [CVE-2023-25157-charis3306_CVE-2023-25157.md](../2023/CVE-2023-25157-charis3306_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致敏感信息泄露、数据篡改、甚至服务器权限获取

**影响版本:** 2.20.x < 2.20.7, 2.19.x < 2.19.7, 2.18.x < 2.18.7, 2.21.x < 2.21.4, 2.22.x < 2.22.2

**利用条件:** GeoServer服务开启，目标存在漏洞版本，且允许未授权网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。由于GeoServer对用户输入过滤不严格，远程未授权攻击者可以构造畸形的过滤语法，绕过GeoServer的词法解析，从而造成SQL注入。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的利用是有效的。PoC代码中提供了利用此漏洞的请求示例，以及用于自动化检测的Python脚本。

**投毒风险：**
虽然提供的Python脚本主要功能是利用SQL注入漏洞，但仍存在一定的投毒风险。风险点在于`PROXY`变量的使用。如果攻击者修改了脚本中的代理地址，例如设置为一个恶意代理服务器，则可以通过该代理服务器捕获或篡改经过该代理的流量。例如脚本片段：
`PROXY = "http://127.0.0.1:8080/" if False else None`
如果将`False`修改为`True`， 并且用户使用了恶意的代理，则可能被投毒。此外，如果脚本被修改为执行恶意代码（例如下载和执行其他程序），则存在更大的风险。总体来说，投毒风险较低，约为10%，主要取决于用户是否会使用来路不明的代理或修改脚本本身。

**利用方式：**
利用方式如下：
1.  **获取可用功能名称：** 通过发送`GetCapabilities`请求到`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`端点，获取GeoServer支持的WFS功能名称。
2.  **获取相关功能可用属性：** 针对特定功能名称，例如`vulhub:example`，发送`DescribeFeatureType`请求到`/geoserver/wfs?request=DescribeFeatureType&version=2.0.0&service=WFS&outputFormat=application/json&typeName=vulhub:example`端点，获取该功能的可用属性列表。
3.  **构造SQL注入Payload：** 针对特定属性，构造包含SQL注入的`CQL_FILTER`参数，发送`GetFeature`请求到`/geoserver/ows`端点。例如：
`/geoserver/ows?service=wfs&version=1.0.0&request=GetFeature&typeName=vulhub:example&CQL_FILTER=strStartsWith(name,'x'')+=+true+and+1=(SELECT+CAST+((SELECT+version())+AS+INTEGER))+--+')+=+true`
此payload利用了`strStartsWith`函数和`CQL_FILTER`参数，注入SQL代码来执行数据库操作，如获取数据库版本信息。
4.  **验证与自动化：** 提供的`exp.py`脚本自动化了上述过程。它首先从目标GeoServer获取功能列表和属性，然后针对每个属性构造SQL注入payload，并检查响应中是否包含错误信息，以此判断漏洞是否存在。

**项目地址:** [charis3306/CVE-2023-25157](https://github.com/charis3306/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #5

**来源**: [CVE-2023-25157-custiya_geoserver-CVE-2023-25157.md](../2023/CVE-2023-25157-custiya_geoserver-CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，GeoServer实例运行，存在可访问的WFS/WMS/WCS服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-25157是GeoServer中的一个SQL注入漏洞。漏洞存在于OGC Filter表达式语言和OGC Common Query Language (CQL) 的处理中，影响Web Feature Service (WFS)、Web Map Service (WMS) 协议以及Web Coverage Service (WCS)协议中ImageMosaic coverages对CQL的支持。

**有效性：**
提供的`docker-compose.yml`文件设置了一个包含易受攻击的GeoServer实例(2.22.1)的环境，它依赖于PostGIS数据库。 `startup.sh`启动脚本如果包含恶意代码，则能成功搭建环境并执行攻击，验证此漏洞的存在。综合搜索引擎结果和漏洞库信息,漏洞利用是有效的。

**投毒风险：**
`docker-compose.yml` 文件本身并不包含恶意代码，但它挂载了`./startup.sh`脚本，这引入了投毒的可能。如果 `startup.sh` 包含任何恶意指令 (例如下载并执行恶意脚本、修改GeoServer配置以允许未授权访问、或安装后门)，那么该仓库就存在投毒风险。在没有`startup.sh` 脚本内容的情况下，无法完全确定投毒的程度，推测投毒概率为10%。 谨慎使用此仓库。

**利用方式：**
该漏洞的利用方式通常涉及构造恶意的CQL或OGC Filter表达式，将其注入到WFS/WMS/WCS请求的参数中。由于GeoServer没有正确过滤这些表达式，恶意SQL代码会被执行，从而可能允许攻击者执行任意SQL命令，包括读取、修改或删除数据库中的数据，甚至执行操作系统命令（如果数据库配置允许）。攻击者可能通过 `PropertyIsLike` filter（配合String字段和任意数据库DataStore，或PostGIS DataStore且开启 encode functions）或 `FeatureId` 配合不安全的设置触发漏洞。修复方案包括升级到指定版本或禁用/启用相应的PostGIS Datastore设置。

**项目地址:** [custiya/geoserver-CVE-2023-25157](https://github.com/custiya/geoserver-CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #6

**来源**: [CVE-2023-25157-dr-cable-tv_Geoserver-CVE-2023-25157.md](../2023/CVE-2023-25157-dr-cable-tv_Geoserver-CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，目标GeoServer实例存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞是GeoServer中的SQL注入漏洞，源于对OGC Filter表达式语言和OGC Common Query Language (CQL) 的不当处理。攻击者可以通过构造恶意的CQL_FILTER参数，利用`strEndsWith`，`strStartsWith`和`PropertyIsLike`函数，或者`FeatureId`绕过防御，执行任意SQL查询。

**有效性：**
根据提供的漏洞库信息和搜索引擎结果，此漏洞影响特定版本的GeoServer，且有可用的PoC代码。PoC代码通过构造恶意的CQL_FILTER参数进行攻击，尝试注入SQL语句以获取数据库版本信息。提供的`dbFinder.py`脚本首先尝试连接到目标GeoServer实例，然后获取FeatureType名称，并使用精心构造的CQL_FILTER尝试执行SQL注入。PoC代码有效。

**投毒风险：**
分析提供的PoC代码，`dbFinder.py` 主要功能是检测目标是否存在漏洞，其核心在于构造恶意的CQL_FILTER，没有发现明显的恶意行为或后门代码。`README.md` 只是提供了漏洞说明和使用方法。投毒风险较低，但仍需注意，因为任何从互联网上获取的代码都存在潜在风险，建议在使用前进行代码审查。 此处的投毒风险主要考虑作者是否在代码中隐藏了其他恶意行为，例如上传敏感信息等。鉴于代码功能较为简单，且主要依赖于SQL注入，因此判断投毒可能性较低，为5%。

**利用方式：**
1.  攻击者首先需要确定目标GeoServer实例的版本是否在受影响范围内（< 2.21.4, >= 2.22.0, < 2.22.2）。
2.  利用提供的PoC脚本或者其他方式，构造包含恶意SQL语句的CQL_FILTER参数。
3.  将构造的CQL_FILTER参数附加到WFS GetFeature请求中，例如：
    `/geoserver/ows?service=wfs&version=1.0.0&request=GetFeature&typeName=<featureType>&CQL_FILTER=<恶意CQL_FILTER>`
4.  如果目标存在漏洞，恶意SQL语句将被执行，攻击者可以获取数据库中的敏感信息，甚至执行任意代码。

**缓解措施：**
*   升级GeoServer到不受影响的版本（>= 2.21.4 或 >= 2.22.2）。
*   如果无法升级，禁用PostGIS Datastore的*encode functions*设置，并启用*preparedStatements*设置。

**项目地址:** [dr-cable-tv/Geoserver-CVE-2023-25157](https://github.com/dr-cable-tv/Geoserver-CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #7

**来源**: [CVE-2023-25157-murataydemir_CVE-2023-25157-and-CVE-2023-25158.md](../2023/CVE-2023-25157-murataydemir_CVE-2023-25157-and-CVE-2023-25158.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致未授权信息泄露、数据篡改和服务中断

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要GeoServer实例运行，且满足特定配置条件，例如PostGIS DataStore启用encode functions，或数据库表具有String主键列且prepared statements被禁用等。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的SQL注入漏洞，利用OGC Filter表达式语言和CQL（Common Query Language）的不当处理。根据漏洞利用代码描述，多个函数和过滤器都存在注入点：

*   `PropertyIsLike` filter: 当与String字段一起使用时，任何关系数据库的存储都会受到影响；PostGIS DataStore启用encode functions；或者image mosaic的索引存储在关系数据库中。
*   `strEndsWith` function: 当与PostGIS DataStore一起使用且encode functions启用时。
*   `strStartsWith` function: 当与PostGIS DataStore一起使用且encode functions启用时。
*   `FeatureId` filter: 当数据库表的String主键列使用时且prepared statements禁用时。
*   `jsonArrayContains` function: 当与String或JSON字段一起使用且与PostGIS或Oracle DataStore（仅在GeoServer 2.22.0及更高版本中）一起使用时。
*   `DWithin` filter: 当与Oracle DataStore一起使用时。

利用方式包括构造恶意的OGC Filter或CQL表达式，通过WFS、WMS或WCS协议发送给GeoServer，从而执行任意SQL命令。这可能导致敏感数据泄露、数据修改甚至服务中断。提供的POC代码库包含漏洞的详细描述和复现步骤，表明该漏洞的有效性较高。搜索引擎结果也证实了该漏洞的存在和危害。

关于投毒风险，由于POC代码只是提供漏洞复现和利用的步骤，主要关注点在于利用方式，并无发现明显的恶意代码，比如下载执行恶意脚本，上传恶意文件等操作。但是，如果攻击者修改了提供的POC并植入恶意代码，使用户在测试时受到攻击，则存在一定投毒风险。因此，将投毒风险评估为10%。

**项目地址:** [murataydemir/CVE-2023-25157-and-CVE-2023-25158](https://github.com/murataydemir/CVE-2023-25157-and-CVE-2023-25158)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #8

**来源**: [CVE-2023-25157-win3zz_CVE-2023-25157.md](../2023/CVE-2023-25157-win3zz_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，GeoServer服务开启，目标存在漏洞版本的GeoServer

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞，存在于OGC Filter表达式语言和OGC Common Query Language (CQL)的支持中。攻击者可以通过WFS和WMS协议，或者WCS协议（针对ImageMosaic覆盖），注入恶意的SQL代码。PoC代码通过构造包含恶意SQL语句的CQL_FILTER参数，发送到存在漏洞的GeoServer实例，利用`strStartsWith`等函数进行SQL注入。虽然代码整体上是用于验证漏洞的，但存在潜在投毒风险，例如，攻击者可能会修改PoC，使其包含更具破坏性的SQL payload，或者在大型环境中分发这些修改后的PoC，达到攻击的目的。代码本身的危害较小，但被恶意修改后风险增大。

**项目地址:** [win3zz/CVE-2023-25157](https://github.com/win3zz/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---



---

## POC #4

**来源**: [CVE-2023-25157-charis3306_CVE-2023-25157.md](../2023/CVE-2023-25157-charis3306_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致敏感信息泄露、数据篡改、甚至服务器权限获取

**影响版本:** 2.20.x < 2.20.7, 2.19.x < 2.19.7, 2.18.x < 2.18.7, 2.21.x < 2.21.4, 2.22.x < 2.22.2

**利用条件:** GeoServer服务开启，目标存在漏洞版本，且允许未授权网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。由于GeoServer对用户输入过滤不严格，远程未授权攻击者可以构造畸形的过滤语法，绕过GeoServer的词法解析，从而造成SQL注入。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的利用是有效的。PoC代码中提供了利用此漏洞的请求示例，以及用于自动化检测的Python脚本。

**投毒风险：**
虽然提供的Python脚本主要功能是利用SQL注入漏洞，但仍存在一定的投毒风险。风险点在于`PROXY`变量的使用。如果攻击者修改了脚本中的代理地址，例如设置为一个恶意代理服务器，则可以通过该代理服务器捕获或篡改经过该代理的流量。例如脚本片段：
`PROXY = "http://127.0.0.1:8080/" if False else None`
如果将`False`修改为`True`， 并且用户使用了恶意的代理，则可能被投毒。此外，如果脚本被修改为执行恶意代码（例如下载和执行其他程序），则存在更大的风险。总体来说，投毒风险较低，约为10%，主要取决于用户是否会使用来路不明的代理或修改脚本本身。

**利用方式：**
利用方式如下：
1.  **获取可用功能名称：** 通过发送`GetCapabilities`请求到`/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities`端点，获取GeoServer支持的WFS功能名称。
2.  **获取相关功能可用属性：** 针对特定功能名称，例如`vulhub:example`，发送`DescribeFeatureType`请求到`/geoserver/wfs?request=DescribeFeatureType&version=2.0.0&service=WFS&outputFormat=application/json&typeName=vulhub:example`端点，获取该功能的可用属性列表。
3.  **构造SQL注入Payload：** 针对特定属性，构造包含SQL注入的`CQL_FILTER`参数，发送`GetFeature`请求到`/geoserver/ows`端点。例如：
`/geoserver/ows?service=wfs&version=1.0.0&request=GetFeature&typeName=vulhub:example&CQL_FILTER=strStartsWith(name,'x'')+=+true+and+1=(SELECT+CAST+((SELECT+version())+AS+INTEGER))+--+')+=+true`
此payload利用了`strStartsWith`函数和`CQL_FILTER`参数，注入SQL代码来执行数据库操作，如获取数据库版本信息。
4.  **验证与自动化：** 提供的`exp.py`脚本自动化了上述过程。它首先从目标GeoServer获取功能列表和属性，然后针对每个属性构造SQL注入payload，并检查响应中是否包含错误信息，以此判断漏洞是否存在。

**项目地址:** [charis3306/CVE-2023-25157](https://github.com/charis3306/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #5

**来源**: [CVE-2023-25157-custiya_geoserver-CVE-2023-25157.md](../2023/CVE-2023-25157-custiya_geoserver-CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，GeoServer实例运行，存在可访问的WFS/WMS/WCS服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-25157是GeoServer中的一个SQL注入漏洞。漏洞存在于OGC Filter表达式语言和OGC Common Query Language (CQL) 的处理中，影响Web Feature Service (WFS)、Web Map Service (WMS) 协议以及Web Coverage Service (WCS)协议中ImageMosaic coverages对CQL的支持。

**有效性：**
提供的`docker-compose.yml`文件设置了一个包含易受攻击的GeoServer实例(2.22.1)的环境，它依赖于PostGIS数据库。 `startup.sh`启动脚本如果包含恶意代码，则能成功搭建环境并执行攻击，验证此漏洞的存在。综合搜索引擎结果和漏洞库信息,漏洞利用是有效的。

**投毒风险：**
`docker-compose.yml` 文件本身并不包含恶意代码，但它挂载了`./startup.sh`脚本，这引入了投毒的可能。如果 `startup.sh` 包含任何恶意指令 (例如下载并执行恶意脚本、修改GeoServer配置以允许未授权访问、或安装后门)，那么该仓库就存在投毒风险。在没有`startup.sh` 脚本内容的情况下，无法完全确定投毒的程度，推测投毒概率为10%。 谨慎使用此仓库。

**利用方式：**
该漏洞的利用方式通常涉及构造恶意的CQL或OGC Filter表达式，将其注入到WFS/WMS/WCS请求的参数中。由于GeoServer没有正确过滤这些表达式，恶意SQL代码会被执行，从而可能允许攻击者执行任意SQL命令，包括读取、修改或删除数据库中的数据，甚至执行操作系统命令（如果数据库配置允许）。攻击者可能通过 `PropertyIsLike` filter（配合String字段和任意数据库DataStore，或PostGIS DataStore且开启 encode functions）或 `FeatureId` 配合不安全的设置触发漏洞。修复方案包括升级到指定版本或禁用/启用相应的PostGIS Datastore设置。

**项目地址:** [custiya/geoserver-CVE-2023-25157](https://github.com/custiya/geoserver-CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #6

**来源**: [CVE-2023-25157-dr-cable-tv_Geoserver-CVE-2023-25157.md](../2023/CVE-2023-25157-dr-cable-tv_Geoserver-CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，目标GeoServer实例存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞是GeoServer中的SQL注入漏洞，源于对OGC Filter表达式语言和OGC Common Query Language (CQL) 的不当处理。攻击者可以通过构造恶意的CQL_FILTER参数，利用`strEndsWith`，`strStartsWith`和`PropertyIsLike`函数，或者`FeatureId`绕过防御，执行任意SQL查询。

**有效性：**
根据提供的漏洞库信息和搜索引擎结果，此漏洞影响特定版本的GeoServer，且有可用的PoC代码。PoC代码通过构造恶意的CQL_FILTER参数进行攻击，尝试注入SQL语句以获取数据库版本信息。提供的`dbFinder.py`脚本首先尝试连接到目标GeoServer实例，然后获取FeatureType名称，并使用精心构造的CQL_FILTER尝试执行SQL注入。PoC代码有效。

**投毒风险：**
分析提供的PoC代码，`dbFinder.py` 主要功能是检测目标是否存在漏洞，其核心在于构造恶意的CQL_FILTER，没有发现明显的恶意行为或后门代码。`README.md` 只是提供了漏洞说明和使用方法。投毒风险较低，但仍需注意，因为任何从互联网上获取的代码都存在潜在风险，建议在使用前进行代码审查。 此处的投毒风险主要考虑作者是否在代码中隐藏了其他恶意行为，例如上传敏感信息等。鉴于代码功能较为简单，且主要依赖于SQL注入，因此判断投毒可能性较低，为5%。

**利用方式：**
1.  攻击者首先需要确定目标GeoServer实例的版本是否在受影响范围内（< 2.21.4, >= 2.22.0, < 2.22.2）。
2.  利用提供的PoC脚本或者其他方式，构造包含恶意SQL语句的CQL_FILTER参数。
3.  将构造的CQL_FILTER参数附加到WFS GetFeature请求中，例如：
    `/geoserver/ows?service=wfs&version=1.0.0&request=GetFeature&typeName=<featureType>&CQL_FILTER=<恶意CQL_FILTER>`
4.  如果目标存在漏洞，恶意SQL语句将被执行，攻击者可以获取数据库中的敏感信息，甚至执行任意代码。

**缓解措施：**
*   升级GeoServer到不受影响的版本（>= 2.21.4 或 >= 2.22.2）。
*   如果无法升级，禁用PostGIS Datastore的*encode functions*设置，并启用*preparedStatements*设置。

**项目地址:** [dr-cable-tv/Geoserver-CVE-2023-25157](https://github.com/dr-cable-tv/Geoserver-CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #7

**来源**: [CVE-2023-25157-murataydemir_CVE-2023-25157-and-CVE-2023-25158.md](../2023/CVE-2023-25157-murataydemir_CVE-2023-25157-and-CVE-2023-25158.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致未授权信息泄露、数据篡改和服务中断

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要GeoServer实例运行，且满足特定配置条件，例如PostGIS DataStore启用encode functions，或数据库表具有String主键列且prepared statements被禁用等。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的SQL注入漏洞，利用OGC Filter表达式语言和CQL（Common Query Language）的不当处理。根据漏洞利用代码描述，多个函数和过滤器都存在注入点：

*   `PropertyIsLike` filter: 当与String字段一起使用时，任何关系数据库的存储都会受到影响；PostGIS DataStore启用encode functions；或者image mosaic的索引存储在关系数据库中。
*   `strEndsWith` function: 当与PostGIS DataStore一起使用且encode functions启用时。
*   `strStartsWith` function: 当与PostGIS DataStore一起使用且encode functions启用时。
*   `FeatureId` filter: 当数据库表的String主键列使用时且prepared statements禁用时。
*   `jsonArrayContains` function: 当与String或JSON字段一起使用且与PostGIS或Oracle DataStore（仅在GeoServer 2.22.0及更高版本中）一起使用时。
*   `DWithin` filter: 当与Oracle DataStore一起使用时。

利用方式包括构造恶意的OGC Filter或CQL表达式，通过WFS、WMS或WCS协议发送给GeoServer，从而执行任意SQL命令。这可能导致敏感数据泄露、数据修改甚至服务中断。提供的POC代码库包含漏洞的详细描述和复现步骤，表明该漏洞的有效性较高。搜索引擎结果也证实了该漏洞的存在和危害。

关于投毒风险，由于POC代码只是提供漏洞复现和利用的步骤，主要关注点在于利用方式，并无发现明显的恶意代码，比如下载执行恶意脚本，上传恶意文件等操作。但是，如果攻击者修改了提供的POC并植入恶意代码，使用户在测试时受到攻击，则存在一定投毒风险。因此，将投毒风险评估为10%。

**项目地址:** [murataydemir/CVE-2023-25157-and-CVE-2023-25158](https://github.com/murataydemir/CVE-2023-25157-and-CVE-2023-25158)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

## POC #8

**来源**: [CVE-2023-25157-win3zz_CVE-2023-25157.md](../2023/CVE-2023-25157-win3zz_CVE-2023-25157.md)

## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，GeoServer服务开启，目标存在漏洞版本的GeoServer

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞，存在于OGC Filter表达式语言和OGC Common Query Language (CQL)的支持中。攻击者可以通过WFS和WMS协议，或者WCS协议（针对ImageMosaic覆盖），注入恶意的SQL代码。PoC代码通过构造包含恶意SQL语句的CQL_FILTER参数，发送到存在漏洞的GeoServer实例，利用`strStartsWith`等函数进行SQL注入。虽然代码整体上是用于验证漏洞的，但存在潜在投毒风险，例如，攻击者可能会修改PoC，使其包含更具破坏性的SQL payload，或者在大型环境中分发这些修改后的PoC，达到攻击的目的。代码本身的危害较小，但被恶意修改后风险增大。

**项目地址:** [win3zz/CVE-2023-25157](https://github.com/win3zz/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)

---

