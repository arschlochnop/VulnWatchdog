## CVE-2025-46295 - Apache Commons Text, Apache Commons Lang, Claris FileMaker Server 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-46295

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Commons Text, Apache Commons Lang, Claris FileMaker Server

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** Apache Commons Text < 1.10.0, Apache Commons Lang < 3.18.0, 启用了 Web Publishing Engine 的 FileMaker Server 相关版本

**利用条件:** 应用程序必须将不受信任的用户输入直接传递给 Apache Commons Text 的字符串插值（String Interpolation）功能，且环境未打补丁。

**POC 可用性:** 8/10

**POC 类型:** 工具脚本/修复引导

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】：此POC并非传统的攻击性Exploit，而是一个针对Claris FileMaker Server的自动化修复/漏洞验证套件。该工具通过自动化脚本替换受影响的commons-text和commons-lang3 JAR文件来缓解CVE-2025-46295。其有效性在于它遵循了Claris官方的修复指南（anum=000049055），提供了Windows (PowerShell)、macOS (Bash)和Ubuntu (Bash)的跨平台实现。代码结构清晰，通过直接定位FileMaker Server安装目录下的Web Publishing Engine组件进行补丁更新。对于安全研究员而言，该项目揭示了漏洞在特定商业集成环境中的存在形态，即通过‘插值器’（Interpolator）处理不受信任字符串导致的代码路径触发。虽然它不包含弹计算器的攻击Payload，但其提供的修复逻辑反向印证了攻击面位于特定目录下的类加载路径中。通过分析其替换的1.11.0+版本，可以确认漏洞核心在于旧版本对动态替换文本（如script, dns, url等前缀）缺乏严格的过滤检查。\n\n【利用步骤】：1. 确定目标系统是否安装了FileMaker Server并启用了Web Publishing Engine。2. 寻找使用了Apache Commons Text插值功能的输入点，例如某些搜索框、配置项或模板渲染引擎。3. 构造特定的插值Payload，例如使用脚本前缀：${script:javascript:java.lang.Runtime.getRuntime().exec('id')}。4. 观察系统是否执行命令或发起DNS/URL请求。5. 在本POC环境下，用户通过执行replace-filemaker-jars脚本来确认当前版本是否低于安全水位并进行替换。\n\n【投毒风险分析】：该项目的投毒风险处于较低水平（15%），但仍需警惕恶意软件供应链攻击的可能性。分析发现：1. 仓库README极力引导用户直接下载预编译的二进制文件（Releases page中的zip/tar.gz），而不是通过源码构建。这种‘Quick Download’引导是典型的社会工程学手段，攻击者可能在预编译的二进制程序或PowerShell/Bash脚本中植入恶意代码，如反弹Shell或数据窃取逻辑。2. 脚本需要以Administrator或sudo权限运行，这给予了恶意代码最高级别的系统控制权。3. 风险点在于GitHub仓库本身。如果此项目为非官方人员维护（如README中的your-org占位符），且其提供的JAR包来源不明，可能存在‘补丁套投毒’的情况，即下载的所谓‘安全版本’JAR文件可能被二次修改。建议防御方在下载后务必校验文件的SHA-256哈希值，并优先从Apache官方镜像站获取JAR包，而非依赖此类第三方自动化工具。在企业生产环境中，直接执行未审核的远程脚本（curl | bash）应被视为高危行为。

**项目地址:** [https://github.com/your-org/filemaker-jar-replacer](https://www.google.com/search?q=https://github.com/your-org/filemaker-jar-replacer)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-46295](https://nvd.nist.gov/vuln/detail/CVE-2025-46295)
