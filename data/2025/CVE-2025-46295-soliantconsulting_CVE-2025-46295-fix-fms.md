## CVE-2025-46295 - Apache Commons Text, Apache Commons Lang, Claris FileMaker Server 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-46295

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Commons Text, Apache Commons Lang, Claris FileMaker Server

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** Apache Commons Text < 1.10.0, Apache Commons Lang < 3.18.0, FileMaker Server 各版本

**利用条件:** 应用程序必须将不受信任的、用户可控的输入传递给 Apache Commons Text 的变量插值（Interpolation）功能且未进行适当过滤。

**POC 可用性:** 4/10

**POC 类型:** 概念验证/工具说明

**攻击复杂度:** 低

**投毒风险:** 45%

## 详情

【POC有效性分析】该提供的POC代码本质上是一个针对Claris FileMaker Server的自动化补丁工具，而非攻击性的Exploit。其核心逻辑是根据Claris官方修复建议，通过脚本替换服务器中受影响的JAR文件。从防御研究角度看，该POC文档详尽，指出了漏洞触发点在于1.10.0版本之前的Apache Commons Text库中的字符串插值（String Interpolation）功能。该功能在处理如 `${prefix:name}` 格式的字符串时，若输入由外部控制，攻击者可构造特殊的Lookup前缀（如script, dns, url等）来实现任意代码执行或信息泄露。虽然该README并未直接给出Payload，但其指引的二进制发布页面（Releases）属于不可控的第三方资源，其有效性取决于二进制文件的真实性，存在被劫持用于分发木马的可能。\n\n【利用步骤】1. 识别目标：扫描使用Apache Commons Text库且开启了Web发布引擎的FileMaker Server或其他Java Web应用。2. 探测注入点：寻找将用户输入直接代入文本替换逻辑的接口。3. 构造Payload：利用插值语法，例如构造 `${script:javascript:java.lang.Runtime.getRuntime().exec('id')}`。4. 发送请求：将Payload通过HTTP参数或Header发送至后端。5. 获取权限：若后端未对插值变量进行受限配置，系统将解析并执行Payload，攻击者从而获得远程命令执行权限。\n\n【投毒风险分析】本项目存在显著的投毒风险，评分定为45%。首先，README中高度引导用户点击『Download Latest Release』并运行预编译的二进制文件（.zip, .tar.gz），这种『解压即运行』的模式是投毒攻击的典型温床。防御研究人员应警惕，此类工具往往打着『快速修复』或『漏洞检测』的旗号，诱导运维人员以管理员（Administrator/sudo）权限运行未经审计的脚本或二进制程序。如果该项目仓库是非官方或不受信任的开发者创建，其Release包中极易被植入内存马、反弹Shell或持久化后门。其次，该工具针对的是处于紧急维护状态的生产环境服务器，一旦投毒成功，攻击者将直接获得服务器的最高控制权，危害极大。研究人员在测试时务必在隔离沙箱环境中对脚本源码进行手动逐行审查，绝对禁止直接运行来源不明的二进制程序。

**项目地址:** [https://github.com/your-org/filemaker-jar-replacer](https://www.google.com/search?q=https://github.com/your-org/filemaker-jar-replacer)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-46295](https://nvd.nist.gov/vuln/detail/CVE-2025-46295)
