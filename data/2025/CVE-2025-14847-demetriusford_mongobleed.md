## CVE-2025-14847 - MongoDB Server 内存泄露 (Heap Buffer Over-read)

**漏洞编号:** CVE-2025-14847

**漏洞类型:** 内存泄露 (Heap Buffer Over-read)

**影响应用:** MongoDB Server

**危害等级:** 高 (High)

**CVSS评分:** 8.7

**影响版本:** 多个支持的版本及旧版本 (multiple supported and legacy MongoDB Server versions)

**利用条件:** 远程、无需认证、网络访问 MongoDB 服务端口

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：该POC（名为Mongobleed）是针对MongoDB OP_COMPRESSED处理器中堆内存越界读取漏洞的完整实现。漏洞的核心在于服务器未能校验`uncompressed_size`字段与解压后实际数据的匹配性。在POC有效性方面，代码逻辑清晰且具有高度可执行性：它首先构造一个合法的BSON文档并利用zlib进行压缩，随后封装进OP_COMPRESSED消息格式中。关键点在于POC故意将`uncompressed_size`设置为大于实际有效载荷的值（如实际大小+500字节）。当MongoDB服务端接收并处理该消息时，BSON解析器会尝试读取用户声明的大小，从而导致指针越过当前解压缓冲区的边界，进入堆内存区域。由于解析器在遇到不符合BSON规范的堆内存残留数据时会生成错误信息，并将这些非法数据片段作为错误上下文返回给客户端，攻击者借此可实现内存内容的带外泄露。该POC集成了Ruby环境下的自动化流程，包含Gemfile依赖管理及Makefile简化操作，其利用逻辑与安全研究员Joe Desimone披露的机制完全一致，属于极高价值且有效的漏洞利用脚本。利用步骤：1. 环境准备，确保安装Ruby 2.7+并执行`bundle install`安装colorize与sorbet-runtime依赖。2. 目标定位，获取目标MongoDB服务器的IP与端口（默认27017）。3. 执行攻击，运行`ruby mongobleed.rb --host <target>`。4. 漏洞触发，脚本发送精心构造的OP_COMPRESSED包。5. 数据提取，观察脚本输出或生成的.bin文件，其中包含了从服务端堆内存中泄露出的原始数据。投毒风险分析：经过对提供的POC源码（mongobleed.rb、Gemfile、Makefile）的深入审查，该项目表现出极低的投毒风险。首先，依赖项配置（Gemfile）中引用的均为RubyGems官方源的知名库（如colorize用于终端着色，sorbet用于类型检查），未发现恶意抢注域名或指向可疑GitHub仓库的依赖。其次，Makefile脚本行为透明，仅包含标准的安装、静态检查及运行指令，不存在预执行脚本或隐藏的后门触发逻辑。在核心业务逻辑mongobleed.rb中，代码采用高度结构化的Sorbet类型标注，逻辑清晰，主要操作集中在Socket通信与二进制数据包的构造上。代码中未见任何混淆混淆（Obfuscation）手段，也没有发现尝试访问系统敏感文件、执行shell命令、反弹Shell或向第三方服务器发送敏感数据的网络请求。唯一的文件写入操作受控于用户指定的`--output`参数，用于保存泄露的内存数据。综上所述，该POC属于典型的安全研究产物，其代码编写规范，意图明确，主要用于合法的漏洞验证与防御性检测，投毒风险评级为5%，属于安全范畴。

**项目地址:** [https://github.com/advisories/GHSA-4742-mr57-2r9j](https://github.com/advisories/GHSA-4742-mr57-2r9j)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-14847](https://nvd.nist.gov/vuln/detail/CVE-2025-14847)
