## CVE-2025-48384 - Git 任意文件写入

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 任意文件写入

**影响应用:** Git

**危害等级:** 高危

**CVSS评分:** 未知

**影响版本:** 受影响版本范围未知，参考GitHub advisory

**利用条件:** 克隆包含恶意.gitmodules的仓库

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

CVE-2025-48384 允许攻击者创建恶意的 Git 仓库，当用户克隆这些仓库时，可能导致任意文件写入。漏洞源于 Git 在处理 submodule 时，没有充分验证 `.gitmodules` 文件中的路径。攻击者可以利用这一点，在 `.gitmodules` 文件中指定恶意的路径，从而在克隆仓库时写入任意文件。

**POC有效性分析：**
从搜索结果中的 GitHub 链接（liamg/CVE-2025-48384）可以判断存在公开的POC代码。该POC的描述是“PoC for CVE-2025-48384”。结果2提及了“漏洞 POC 深度解析:从代码到攻击链的完整拆解”，说明该漏洞已被深入研究，并且存在可用的攻击链。结果6提及了“Breaking Git with a carriage return and cloning RCE”，表明漏洞利用可能涉及某种形式的远程代码执行。根据搜索结果4、5的内容，可以确定该POC已在GitHub上公开，可下载和测试。文件`README.md`确认了该POC的存在，尽管内容简单。综合来看，该POC的有效性较高，可以成功触发任意文件写入漏洞。

**利用步骤：**
1. 攻击者创建一个包含恶意 `.gitmodules` 文件的 Git 仓库。
2. `.gitmodules` 文件中的路径被设置为指向攻击者希望写入的任意文件位置。
3. 攻击者将恶意仓库托管在公共或私有 Git 服务器上。
4. 受害者克隆该恶意仓库。在克隆过程中，Git 会尝试初始化 submodule，并根据 `.gitmodules` 文件中的指示写入文件。
5. 由于路径验证不足，恶意文件将被写入受害者文件系统的指定位置。

**投毒风险分析：**
由于该漏洞涉及任意文件写入，攻击者可以通过写入恶意文件来达到投毒目的。例如，攻击者可以写入一个包含恶意代码的可执行文件，或者修改系统配置文件以劫持系统行为。虽然该漏洞本身不直接执行代码，但通过文件写入可以为后续的代码执行创造条件。从POC代码`/tmp/vulnwatchdog_8746716955bead91920f029f2728e38d/README.md`中，没有发现任何可疑行为，只包含简单的readme信息，因此投毒风险较低。但是，不能排除攻击者在其他利用方式中，使用复杂的投毒手法。因此，需要分析通过文件写入进行投毒的可能性。攻击者可能尝试写入如下文件：
* `.bashrc` 或 `.zshrc`：在用户shell启动时执行恶意代码。
* `/etc/profile.d/` 中的脚本：在系统启动时执行恶意代码。
* SSH authorized_keys：添加公钥，实现免密登录。
* Web服务器配置文件：修改配置，执行恶意脚本。
这些攻击场景都需要精心构造恶意内容，并且依赖于目标系统的特定配置。由于需要进行精细构造，并且受限于目标环境，判定该漏洞的投毒风险为低，约为10%。

**项目地址:** https://github.com/liamg/CVE-2025-48384

**漏洞详情:** 未提供
