## CVE-2025-49144 - Notepad++ (Installer) DLL劫持 (DLL Hijacking)

**漏洞编号:** CVE-2025-49144

**漏洞类型:** DLL劫持 (DLL Hijacking)

**影响应用:** Notepad++ (Installer)

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**影响版本:** 7.13 之前的版本 (具体取决于安装包版本)

**利用条件:** 攻击者需要诱导用户将恶意的 regsvr32.exe 放置在 Notepad++ 安装程序（Installer）所在的同一工作目录中，并运行安装程序。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该POC针对CVE-2025-49144漏洞提供了非常清晰且完整的复现逻辑。该漏洞本质上是由于Notepad++安装程序在调用系统组件‘regsvr32’时，使用了非绝对路径且未加引号的搜索路径。在Windows系统的路径搜索机制下，程序会首先在当前工作目录（CWD）中查找同名可执行文件。POC通过编写一个简单的C#代码，利用File.WriteAllText在系统临时目录下生成标志性文件，以此证明获得了SYSTEM级别的执行权限。随后，POC展示了如何使用donut工具将该C#逻辑转化为Shellcode，并嵌入到一个C语言编写的加载器中。该加载器被命名为regsvr32.exe。当用户运行位于同一目录下的Notepad++安装程序时，安装程序会错误地调用这个伪造的regsvr32.exe，从而在内存中加载并执行攻击者的Payload。整个POC代码结构清晰，使用了标准的Windows API如VirtualAlloc、VirtualProtect和CreateThread进行内存操作和线程注入，技术路径完整，具有极高的实战复现价值。利用步骤：首先，攻击者根据POC提供的C#逻辑生成Payload并转换为Shellcode。其次，将Shellcode植入到提供的C语言模板中，编译生成名为regsvr32.exe的恶意程序。最后，将该程序放置在Notepad++安装包所在的文件夹。当安装程序启动并尝试注册组件时，恶意代码即被触发，从而实现从普通权限到系统权限的提升。投毒风险分析：该POC的投毒风险处于低至中等水平（约15%）。代码本身是透明且模块化的，核心Payload仅为创建一个测试用的txt文件（NOTEPAD_VULNERABIL.txt），这符合安全研究中‘良性证明’的原则。然而，风险点在于其使用了donut工具生成的Shellcode加载模式。由于Shellcode本身是二进制格式，且内嵌在payload.h中，防御者或研究员在未经反汇编的情况下难以直接肉眼判断其真实行为。如果该POC在非官方渠道传播，攻击者可以轻易地将payload.h中的内容替换为真正的勒索软件或远控后门。虽然当前的POC示例是安全的，但由于其采用了‘Shellcode + Loader’的结构，这种结构常被恶意软件开发者用于逃避静态查杀，因此在下载和测试此类POC时，必须在隔离的沙箱环境中进行。此外，该POC引用的外部Gitbook链接（0xczr.gitbook.io）虽然在当前上下文中是作为文档支持，但在供应链安全视角下，这类外部链接若被篡改或劫持，也可能导致下载到受污染的编译模板或预编译二进制文件。综合来看，代码逻辑本身无恶意，但其形式容易被二次利用进行投毒。

**项目地址:** [https://0xczr.gitbook.io/0xczr/pocs/notepad++-cve-2025-49144](https://0xczr.gitbook.io/0xczr/pocs/notepad++-cve-2025-49144)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49144](https://nvd.nist.gov/vuln/detail/CVE-2025-49144)
