## CVE-2025-49144 - Notepad++ Installer DLL劫持 / 权限提升

**漏洞编号:** CVE-2025-49144

**漏洞类型:** DLL劫持 / 权限提升

**影响应用:** Notepad++ Installer

**危害等级:** 高危

**CVSS评分:** CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H

**影响版本:** 未知 (基于2025年发布的Installer版本)

**利用条件:** 攻击者需在Notepad++安装程序所在目录放置恶意文件，并诱导具备SYSTEM权限的进程或管理员运行安装程序。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该POC展示了一个经典的DLL劫持漏洞，具体表现为Notepad++安装程序在查找名为'regsvr32.exe'的组件时，由于搜索路径未进行引号保护且未指定绝对路径，导致程序优先从当前工作目录（Working Directory）进行查找。POC通过两部分实现：一是C#编写的逻辑负载，用于在系统临时目录下生成证明文件，并显示具备SYSTEM权限；二是一个基于C语言编写的加载器，它利用Windows API（VirtualAlloc, VirtualProtect, CreateThread）将Shellcode注入内存执行。该加载器被编译为'regsvr32.exe'并放置在安装包同级目录，从而被安装程序错误调用。从技术实现角度看，该POC逻辑严密，展示了从环境准备到权限获取的完整链条，验证了安装程序在组件调用路径处理上的严重缺陷。利用步骤：1. 准备payload.h，其中包含由C#代码通过donut转换而来的Shellcode。2. 编译C加载器源码，生成伪造的regsvr32.exe可执行文件。3. 将该恶意regsvr32.exe放置在Notepad++安装包（如npp.8.x.Installer.exe）相同的目录下。4. 诱导用户以管理员身份运行安装程序。5. 安装程序在初始化阶段会尝试查找并运行regsvr32，此时会优先加载并执行同目录下的伪造文件。6. 观察C:\Windows\Temp\目录，若出现NOTEPAD_VULNERABIL.txt且内容符合预期，则证明提权成功。投毒风险分析：该POC代码本身逻辑透明，使用的C#负载仅为文件写入操作，未包含混淆或外部C2连接。C加载器部分采用了标准的内存加载技术，虽常被杀毒软件标记为报毒，但在安全研究语境下属于标准的无文件执行示例。投毒风险主要存在于第三方分发该POC时，可能会将payload.h中的十六进制字节替换为实际的勒索软件或远控木马（如Cobalt Strike Beacon）。由于POC依赖于编译过程，研究人员在复现时应仔细核查payload.h的原始字节来源，并建议在隔离的沙箱环境中进行。当前公开的源码库未发现明显的恶意混淆，但在威胁情报视角下，此类利用‘安装程序劫持’的漏洞POC极易被供应链攻击者利用，封装入虚假的‘汉化版’或‘优化版’安装包中进行二次分发，具有一定的潜在风险。建议组织加强对安装程序运行环境的监控，并确保使用官方渠道分发的安装包。

**项目地址:** [https://0xczr.gitbook.io/0xczr/pocs/notepad++-cve-2025-49144](https://0xczr.gitbook.io/0xczr/pocs/notepad++-cve-2025-49144)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49144](https://nvd.nist.gov/vuln/detail/CVE-2025-49144)
