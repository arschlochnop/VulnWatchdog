## CVE-2025-49144 - Notepad++ 权限提升 (Privilege Escalation)

**漏洞编号:** CVE-2025-49144

**漏洞类型:** 权限提升 (Privilege Escalation)

**影响应用:** Notepad++

**危害等级:** 高危

**CVSS评分:** N/A

**影响版本:** Notepad++ v8.8.1

**利用条件:** 本地访问，需要用户运行受感染的安装程序。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-49144描述了影响Notepad++ v8.8.1安装程序的本地权限提升（LPE）漏洞。此漏洞的核心是一个“不受控的可执行文件搜索路径”（Binary Planting）问题。当Notepad++安装程序尝试调用系统工具`regsvr32.exe`时，它未能指定其完整路径，而是优先在其当前工作目录中搜索该可执行文件。这种行为使得攻击者能够将一个恶意构造的`regsvr32.exe`放置在与合法Notepad++安装程序相同的目录中。当用户从该目录运行安装程序时，它会错误地加载并以SYSTEM权限执行攻击者提供的恶意`regsvr32.exe`，从而授予攻击者对系统的完全控制权。这是一个典型的供应链攻击向量，利用了用户对合法软件的信任。建议所有用户立即升级Notepad++至8.8.2或更高版本。

**POC有效性分析：**
所提供的Proof-of-Concept (POC) 代码是高度有效的，并清晰地演示了漏洞的利用机制。它包含两部分：一个C#载荷（通过`donut`转换为Shellcode，其功能是在`C:\Windows\Temp\`创建`NOTEPAD_VULNERABIL.txt`文件，并注明以SYSTEM权限执行），以及一个C语言编写的Shellcode加载器（编译为`regsvr32.exe`）。通过将此恶意`regsvr32.exe`放置在与Notepad++ v8.8.1安装程序相同的目录中并运行安装程序，POC成功证明了恶意代码能够以SYSTEM权限执行。在`C:\Windows\Temp`目录下成功创建带有特定消息的文本文件，明确验证了漏洞的存在和可利用性。POC的文档和源代码完整，易于复现。

**利用步骤：**
1.  **获取目标安装程序：** 获取Notepad++ v8.8.1的合法安装程序。
2.  **准备恶意载荷：** 编写恶意C#代码（例如，POC中的文件写入载荷），使用`donut`转换为Shellcode，然后嵌入到C语言加载器中。将该C加载器编译为`regsvr32.exe`。
3.  **构建攻击目录：** 创建一个目录，将合法Notepad++ v8.8.1安装程序和恶意`regsvr32.exe`都放置在该目录中。
4.  **诱导执行：** 诱导目标用户下载并运行来自此受控目录的Notepad++安装程序（例如通过社会工程学）。
5.  **权限提升与载荷执行：** 用户运行安装程序时，它会优先执行目录中的恶意`regsvr32.exe`，从而以SYSTEM权限执行嵌入的Shellcode，完成攻击者预设的恶意操作。

**投毒风险分析：**
针对所提供的POC代码，其投毒风险评估为非常低（5%）。此风险评估严格限于POC代码本身的内容和行为，而非此漏洞在真实世界中被利用的潜在危害。

**代码透明度和意图：** POC中的C#和C代码都非常简洁、清晰且易于理解，未采用任何形式的代码混淆或加密技术。C#载荷的唯一目的是在`C:\Windows\Temp\`目录下创建一个无害的文本文件，其中包含明确的权限提升成功消息。C加载器也仅执行标准的内存管理和线程创建以运行Shellcode。这种直接和透明的代码结构清楚地表明其作为安全研究工具，用于演示漏洞机制，而非作为恶意载荷。

**缺乏恶意行为迹象：** 对POC代码的详细审查表明，它不包含任何通常与恶意软件相关的行为模式或指标。具体来说，它没有：网络通信（未尝试与外部C2服务器建立连接）、持久性机制（未在系统上创建持久性条目如注册表修改、计划任务）、二次载荷投放（未尝试从外部下载或在本地投放、执行额外的恶意文件）、敏感数据访问（未尝试访问或窃取用户敏感数据）、系统破坏或侧向移动（未包含任何导致系统破坏或网络横向移动的代码）。

**技术细节与库使用：** 代码主要依赖标准的Windows API调用（如`VirtualAlloc`、`CreateThread`等）和C#的`System.IO`命名空间来执行其功能。这些都是操作系统提供的合法且常见的编程接口，其使用方式符合安全研究和系统开发的范例，而非规避检测或执行恶意操作。

**结论与警示：** 鉴于上述分析，可以断定此特定POC代码的投毒风险极低。它是一个干净且专注于技术演示的工具。然而，必须强调的是，低投毒风险仅限于此POC代码本身。该POC所利用的底层Notepad++漏洞（CVE-2025-49144）是一个严重的权限提升漏洞。攻击者完全可以基于相同的利用原理，轻松替换POC中的良性C#载荷，植入高度恶意的代码（例如，远程访问木马、勒索软件、凭据窃取器等），从而在受害者系统上造成灾难性后果。因此，安全团队在评估此漏洞时，应将注意力集中在漏洞本身的严重性及其在实际攻击场景中被滥用的可能性，而非仅仅依赖于这个演示性POC的良性性质。在任何测试或分析活动中，始终建议在严格隔离和受控的环境中进行，并对任何潜在的修改或变种保持高度警惕。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-49144
