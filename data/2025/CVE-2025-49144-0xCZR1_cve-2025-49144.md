## CVE-2025-49144 - Notepad++ (Installer) 二进制文件搜索路径不当/DLL劫持

**漏洞编号:** CVE-2025-49144

**漏洞类型:** 二进制文件搜索路径不当/DLL劫持

**影响应用:** Notepad++ (Installer)

**危害等级:** 高危 (High)

**CVSS评分:** CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H

**影响版本:** 7.13版本之前的Installer (具体受影响版本需根据发布日志确认)

**利用条件:** 攻击者需在Notepad++安装程序所在的同一目录下放置恶意构造的regsvr32.exe，并诱导用户执行安装程序。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该POC展示了Notepad++安装程序在执行过程中存在的一个典型二进制搜索路径漏洞。开发者指出，安装程序在尝试调用系统组件regsvr32时，未使用绝对路径且未对路径加引号，导致其优先在当前工作目录（即安装程序所在目录）中搜索。提供的POC包含两部分：一个C#编写的恶意负载代码，其功能是在C:\Windows\Temp\目录下创建一个证明文件；另一个是用C语言编写的加载器，它通过VirtualAlloc申请内存，将由donut工具生成的Shellcode载入，并通过VirtualProtect修改内存权限为PAGE_EXECUTE_READ后启动线程执行。从代码逻辑看，这是一个非常标准且有效的DLL劫持/二进制替换利用链。在Windows环境下，如果安装程序具有管理员权限，那么被劫持运行的恶意regsvr32.exe也将继承SYSTEM或管理员权限，从而实现本地提权。利用步骤：1. 将POC中的C#代码编译并使用donut转换为Shellcode。2. 将Shellcode嵌入C语言加载器的payload.h中。3. 将C加载器编译为名为regsvr32.exe的可执行文件。4. 将生成的regsvr32.exe放置在Notepad++安装程序所在的目录中。5. 启动Notepad++安装程序，系统将优先加载该目录下的恶意regsvr32.exe，从而在Temp目录下生成验证文件。 投毒风险分析：该POC代码具有较低的投毒风险，约为15%。分析理由如下：首先，代码逻辑完全透明，C#部分的Payload仅为创建文本文件（File.WriteAllText），这是典型的无害安全研究证明行为（PoC），而非恶意破坏。其次，C语言加载器使用了标准的Windows API（VirtualAlloc, CreateThread），虽然这些API常被恶意软件使用，但在安全研究上下文中，其调用流程清晰且未经过任何混淆或加壳处理，易于安全人员审计。第三，POC提供的链接指向Gitbook文档，属于知名的技术分享平台。唯一潜在的风险点在于用户如果直接下载未经审核的预编译二进制文件，可能存在被他人替换payload的风险，但就目前公开的代码片段而言，它是纯粹的功能性验证脚本，不包含后门或向外发送敏感信息的逻辑。对于防御方而言，应重点关注此类利用安装程序执行权限进行提权的行为，并建议软件厂商在调用外部命令时务必使用固定路径。此POC的结构完整，不仅解释了原理，还提供了从Payload编写到内存加载的完整路径，对威胁研究人员极具参考价值。

**项目地址:** [https://0xczr.gitbook.io/0xczr/pocs/notepad++-cve-2025-49144](https://0xczr.gitbook.io/0xczr/pocs/notepad++-cve-2025-49144)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49144](https://nvd.nist.gov/vuln/detail/CVE-2025-49144)
