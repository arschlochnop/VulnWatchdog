## CVE-2025-49144 - Notepad++ Installer DLL劫持/权限提升

**漏洞编号:** CVE-2025-49144

**漏洞类型:** DLL劫持/权限提升

**影响应用:** Notepad++ Installer

**危害等级:** 高危

**CVSS评分:** 7.8 (预计)

**影响版本:** 具体版本待定（包含受影响安装程序的版本）

**利用条件:** 攻击者需要能够在Notepad++安装程序运行的同一目录下放置恶意可执行文件

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞属于典型的路径未加引号（Unquoted Service/Process Path）导致的执行流劫持。在Notepad++安装程序执行期间，系统会尝试调用regsvr32来注册组件。由于安装程序在查找regsvr32时未指定绝对路径，且路径字符串未被引号包裹，Windows API的搜索顺序会导致它首先在当前工作目录（Working Directory）中寻找名为regsvr32.exe的文件。POC代码展示了如何利用这一特性：通过编写一个简单的C#程序（生成一个标识文件以证明SYSTEM权限）并使用donut工具转换为shellcode，再由一个模仿regsvr32.exe的C程序载入执行。经过分析，该POC逻辑清晰，直接展示了从路径探测到代码执行的全过程。利用步骤如下：1. 编写恶意载荷（如C#编译成的DLL或Shellcode）；2. 编译并命名为regsvr32.exe；3. 将该伪造的exe放置在Notepad++安装包所在的同一文件夹内；4. 以管理员权限运行安装程序。此时，安装程序会优先调用当前目录下的伪造regsvr32.exe而非系统自带程序，从而实现以高权限执行任意代码。 投毒风险分析：该POC本身具有较高的透明度，代码逻辑可读性强，主要由C#和标准C语言组成，未发现明显的恶意混淆或外部可疑连接。POC中的载荷仅在C:\Windows\Temp\目录下创建一个文本文件作为权限证明，属于典型的安全研究行为，不具备自我传播或破坏性特征。然而，由于该漏洞利用了安装程序的执行环境，在供应链安全或共享下载站场景下，如果黑客将合法的Notepad++安装包与该恶意regsvr32.exe一同打包分发，普通用户极难发现。尽管POC代码本身是安全的防御性研究资料，但其利用方式简单且有效，容易被武器化。对于防御方而言，该代码库的风险点主要在于其提供的shellcode加载模板，这可能被恶意行为者直接套用于真实的恶意软件中。整体而言，该POC在研究环境中投毒风险较低，但在分发环节需警惕伪装成工具包的恶意利用。

**项目地址:** [https://0xczr.gitbook.io/0xczr/pocs/notepad++-cve-2025-49144](https://0xczr.gitbook.io/0xczr/pocs/notepad++-cve-2025-49144)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49144](https://nvd.nist.gov/vuln/detail/CVE-2025-49144)
