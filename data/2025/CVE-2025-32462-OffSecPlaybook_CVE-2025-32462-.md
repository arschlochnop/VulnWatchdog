## CVE-2025-32462 - Sudo 本地权限提升 (LPE)

**漏洞编号:** CVE-2025-32462

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** Sudo

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Sudo 1.9.14 之前的版本 (特别是 1.9.5p2 至 1.9.13 之间的版本)

**利用条件:** 攻击者需拥有本地低权限账户访问权限，且目标系统的 sudoers 配置文件中存在基于主机名（Hostname-restricted）限制的特定规则。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】CVE-2025-32462 是 Sudo 在处理主机名逻辑时的一个严重设计缺陷。在 Sudo 的历史版本中，`-h`（host）选项允许用户指定在特定主机上运行命令。根据 POC 代码分析，该漏洞的根源在于 Sudo 在验证 sudoers 规则时，过度信任了用户通过命令行参数 `-h` 传递的主机名字符串，而不是强制使用系统内核定义的真实主机名。在典型的企业级部署中，管理员可能在 sudoers 中设置如 'attacker-host ALL=(ALL) /usr/bin/apt' 的规则，原意是限制该权限仅在特定机器生效。然而，漏洞允许攻击者在非 'attacker-host' 的机器上，通过执行 'sudo -h attacker-host [command]' 来欺骗权限校验引擎。POC 脚本通过创建低权限用户并利用此逻辑偏差实现提权。该 POC 提供了完整的 Docker 复现环境和详细的分步说明，经分析其逻辑闭环，在未打补丁的 Debian 11 等环境具有极高的成功率。由于 Sudo 几乎是所有 Linux 发行版的标配，此绕过技巧直接打破了基于主机的安全隔离边界。利用步骤通常涉及：1. 识别 sudoers 中带有主机限制的条目；2. 使用 `-h` 参数注入对应主机名；3. 绕过权限检查执行特权命令。此利用方式无需复杂的缓冲区溢出或内存破坏，属于纯逻辑绕过，稳定性极高。

【投毒风险分析】针对该漏洞的 POC 投毒风险处于低至中等水平（约15%）。分析 GitHub 仓库 'MAAYTHM/CVE-2025-32462_32463-Lab' 的代码结构发现，其主要由 Dockerfile、README 和标准的 Bash 脚本组成，代码透明度较高。主要的潜在风险点在于：首先，部分安全研究员可能会在复现脚本中集成自动化下载反弹 Shell 的指令，虽然当前分析的 POC 侧重于实验室环境构建，但攻击者极易修改脚本中的二进制下载地址。其次，该 POC 涉及修改系统的 sudoers 配置文件和创建新用户，若在生产环境运行而非隔离的容器环境，可能导致系统权限配置混乱或留下隐蔽的后门账户。该 POC 项目目前表现为纯净的教学用途，未发现混淆代码或异常的外部链接。然而，由于 2025 年此类提权漏洞关注度极高，社区中已出现名为 'sudo-checker' 或 'exploit-installer' 的衍生脚本，此类脚本往往包含 Base64 加密的恶意 Payload，旨在窃取研究者的本地 SSH 密钥或环境变量。防御建议：在运行任何此类提权 POC 前，务必检查其是否包含 'eval'、'curl | bash' 或未说明的二进制文件引用。本 POC 脚本建议仅在受控的 Docker 隔离环境中使用，避免对宿主机造成配置污染。

**项目地址:** [https://github.com/MAAYTHM/CVE-2025-32462_32463-Lab](https://github.com/MAAYTHM/CVE-2025-32462_32463-Lab)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32462](https://nvd.nist.gov/vuln/detail/CVE-2025-32462)
