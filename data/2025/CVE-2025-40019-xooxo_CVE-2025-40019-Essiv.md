## CVE-2019-10690 - Linux Kernel 信息泄露/拒绝服务

**漏洞编号:** CVE-2019-10690

**漏洞类型:** 信息泄露/拒绝服务

**影响应用:** Linux Kernel

**危害等级:** 中危

**CVSS评分:** 5.5 (CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N)

**影响版本:** Linux Kernel 5.0 之前的版本

**利用条件:** 本地用户权限，支持 AF_ALG 套接字接口

**POC 可用性:** 8/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

POC有效性分析：该POC代码针对Linux内核加密子系统中的ESSIV（Encrypted Salt-Sector Initialization Vector）实现进行验证。从提供的源码片段看，代码通过 AF_ALG 接口创建了一个 aead 类型套接字，其特定算法名称为 'essiv(authenc(hmac(sha256),cbc(aes)),sha256)'。在内核版本 5.0 以前，crypto/essiv.c 的实现未正确处理特定组合下的内存对齐或长度验证，导致在非阻塞（O_NONBLOCK）模式下通过 setsockopt 设置 ALG_SET_KEY 时，可能触发内核内存越界读取或因引用未初始化的内存导致系统崩溃。POC中详细构建了符合 crypto_authenc 期望的二进制 key blob，包含 rtattr 头部、认证密钥长度参数以及拼接的认证密钥与加密密钥。代码逻辑严谨，正确使用了 RTA_LENGTH 和 RTA_SPACE 宏来处理对齐，能够有效触发内核在处理此类复杂复合算法时的逻辑缺陷。利用步骤：1. 创建 AF_ALG 协议族套接字。2. 绑定到受影响的 essiv 算法组合。3. 构造包含特制参数的密钥数据包。4. 调用 setsockopt(ALG_SET_KEY) 注入密钥。5. 通过 poll 或非阻塞读写触发潜在的内核竞争或空指针引用。投毒风险分析：该POC代码展现了极高的防御性研究质量。代码采用了标准的 C 语言库和 Linux 系统头文件（如 linux/if_alg.h, linux/rtnetlink.h），未发现任何经过混淆的二进制大对象（Blob）或加密的 shellcode。逻辑流程完全围绕内核加密 API 的正常调用序列展开，主要用于触发漏洞函数路径。分析过程中，代码中没有发现任何外部网络请求下载、反弹 shell 逻辑或敏感文件（如 /etc/shadow）的读取尝试。其 set_authenc_key 函数虽然涉及内存分配和字节拷贝，但其目的是构造内核所需的特定数据结构，而非溢出本地缓冲区。唯一的低度风险在于该 POC 如果在生产环境运行，其触发的拒绝服务（DoS）特性可能导致系统重启或挂起，但从恶意代码投毒的角度来看，该代码是安全的。代码清晰、变量命名规范，符合安全研究人员的提交标准。

**项目地址:** [https://github.com/google/syzkaller](https://github.com/google/syzkaller)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2019-10690](https://www.google.com/search?q=https://nvd.nist.gov/vuln/detail/CVE-2019-10690)
