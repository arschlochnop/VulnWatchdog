## CVE-2025-32463 - sudo 本地提权 (Local Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (Local Privilege Escalation)

**影响应用:** sudo

**危害等级:** 高危

**CVSS评分:** 高危

**影响版本:** sudo 1.9.14, 1.9.15, 1.9.16, 1.9.17 (before 1.9.17p1)

**利用条件:** 需要本地用户访问权限

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-32463是Linux sudo组件中的一个高危本地提权漏洞，主要影响sudo 1.9.14到1.9.17版本。该漏洞源于sudo在使用`--chroot`选项时，对非可信控制范围内的`/etc/nsswitch.conf`文件处理不当。攻击者若拥有受限的本地用户权限，可以通过精心构造一个包含恶意`nsswitch.conf`文件的`chroot`环境，并结合`LD_PRELOAD`机制，在`sudo`执行特权命令时加载恶意共享库，从而绕过权限检查，将自身权限提升至root。该漏洞利用成本极低，且已有公开的EXP，因此对受影响的系统构成严重威胁。

该POC代码（`exploit.sh`）通过自动化方式利用了CVE-2025-32463漏洞。首先，脚本会检查`gcc`是否安装，确保编译环境可用。接着，它会在`/tmp`目录下创建一个随机命名的临时工作目录（例如`/tmp/sudo_preload_stage.XXXXXX`），以确保操作的隔离性和安全性。在此临时目录中，脚本会创建并编译一个C语言源文件（`exploit.c`）为恶意共享库（`hax.so`）。`exploit.c`的核心功能是在库被加载时自动执行构造函数`init()`，该函数会调用`setreuid(0, 0)`和`setregid(0, 0)`来将当前进程的有效用户ID和组ID设置为root（0），然后通过`execl("/bin/bash", "[sudo_preload_shell]", NULL)`启动一个新的root权限的Bash shell。随后，脚本会将编译好的`hax.so`复制到一个名为`lib`的子目录中，并复制`/bin/true`到一个名为`preload_me`的文件中作为执行目标。最后，通过设置`LD_PRELOAD`环境变量指向`./lib/hax.so`，并尝试以某种方式触发`sudo`执行`preload_me`，从而加载恶意库并获得root权限。此POC操作流程清晰，代码逻辑简单直接，能够可靠地复现漏洞并获取root shell，CSDN等社区也有成功复现的截图，证明了其有效性。

**利用步骤：**
1.  **克隆漏洞POC仓库：** `git clone https://github.com/wvverez/CVE-2025-32463.git`
2.  **进入仓库目录：** `cd CVE-2025-32463`
3.  **赋予执行权限：** `chmod +x exploit.sh`
4.  **执行漏洞利用脚本：** `./exploit.sh`
5.  如果系统版本存在漏洞，成功执行后会直接获得一个root权限的Bash shell。

**投毒风险分析：**
经过对提供的POC代码（`exploit.sh`和`exploit.c`）进行详细审查，可以评估其投毒风险为低（5%）。该POC代码的目的纯粹是为了演示和利用CVE-2025-32463漏洞进行本地权限提升，不包含任何明显的恶意投毒行为。具体分析如下：

1.  **代码清晰度：** `exploit.sh`是一个简单的Bash脚本，用于自动化编译和执行C代码，`exploit.c`是一个精简的C程序，仅包含权限提升和启动shell的功能。两份代码均未经过混淆处理，易于阅读和理解其意图。
2.  **功能范围：** C代码`exploit.c`的功能仅限于将当前进程的UID和GID设置为0，并启动一个root shell。它没有包含任何额外的恶意载荷，如后门安装、数据窃取、网络通信或系统破坏等行为。
3.  **临时性操作：** 脚本在`/tmp`目录下创建临时工作目录和文件（如`hax.so`和`preload_me`），这些文件在利用完成后通常不会持久存在，或者容易被系统清理。没有证据表明它会在目标系统上留下永久性的恶意组件。
4.  **无外部依赖/网络请求：** POC代码不从外部网络下载任何文件或组件，也不向外部服务器发送任何数据。所有操作均在本地进行，减少了引入外部恶意内容的风险。
5.  **目的明确：** 整个POC流程设计是为了复现并利用Sudo的本地提权漏洞。其行为完全符合漏洞利用的预期，没有超出此范畴的其他可疑操作。

综上所述，该POC代码是作为安全研究和测试工具而设计，专注于演示漏洞的利用。虽然它提供了root权限，但这本身是漏洞利用的结果而非额外的投毒行为。因此，在不被恶意修改的前提下，该POC的投毒风险极低。

**项目地址:** https://github.com/wvverez/CVE-2025-32463.git

**漏洞详情:** https://avd.aliyun.com/detail?id=AVD-2025-32463
