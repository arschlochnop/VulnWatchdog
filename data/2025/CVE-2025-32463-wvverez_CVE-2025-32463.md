## CVE-2025-32463 - Sudo 本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** Sudo v1.8.8至1.9.17 (在1.9.17p1中修复)

**利用条件:** 需要本地用户权限，利用Sudo的chroot功能或LD_PRELOAD加载恶意动态库

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

该POC (CVE-2025-32463/exploit.sh) 旨在针对Sudo中与LD_PRELOAD环境变量相关的本地提权漏洞。脚本首先检查gcc编译器是否安装，然后在临时目录中编译一个C语言文件(exploit.c)为共享库(hax.so)。hax.so利用GCC的__attribute__((constructor))特性，确保在加载时自动执行init()函数，该函数包含提权逻辑：通过setreuid(0, 0)和setregid(0, 0)将当前进程的用户ID和组ID提升至root，随后启动一个root权限的bash shell。脚本设置LD_PRELOAD环境变量指向此恶意共享库。但提供的POC代码片段在设置LD_PRELOAD后便截断，未包含最终触发漏洞的sudo命令（如手动执行sudo /bin/bash或利用--chroot选项的sudo命令）。尽管POC不完整，其核心组件和利用原理是正确的。

利用步骤:
1. 确保系统安装gcc。
2. 克隆POC仓库: git clone https://github.com/wvverez/CVE-2025-32463.git
3. 进入目录: cd CVE-2025-32463
4. 赋予执行权限: chmod +x exploit.sh
5. 执行脚本: ./exploit.sh
6. （手动补充）执行触发命令，例如 sudo /bin/bash 或 sudo --chroot=/tmp/sudo_preload_stage.<tempdir> /bin/bash。

投毒风险分析: 该POC代码的投毒风险极低。代码完全开源且可见，未进行任何混淆处理。exploit.sh脚本仅使用标准的Linux命令在临时目录中进行环境设置、编译和环境变量配置，确保了操作的透明性和安全性。exploit.c的核心载荷功能明确：通过setreuid(0, 0)和setregid(0, 0)将进程权限提升至root并启动bash shell。这是一种标准的本地提权攻击手法，旨在演示漏洞利用效果，而非植入后门或其他恶意软件。分析发现，POC中没有嵌入任何外部网络请求、下载可疑文件、执行eval或其他动态代码注入的迹象。也没有发现对敏感系统文件进行非预期修改的行为。因此，此POC是为了合法的安全研究目的而设计，不包含任何恶意代码或投毒行为。安全分析人员可以放心地在受控环境中进行测试和分析，无需担心潜在的系统污染或信息泄露风险。

**项目地址:** https://github.com/wvverez/CVE-2025-32463.git

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-32463
