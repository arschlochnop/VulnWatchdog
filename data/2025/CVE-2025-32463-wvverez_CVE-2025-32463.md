## CVE-2025-32463 - Sudo (Linux/Unix) 本地权限提升 (Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (Privilege Escalation)

**影响应用:** Sudo (Linux/Unix)

**危害等级:** 高 (High)

**CVSS评分:** CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H (9.3)

**影响版本:** 几乎所有受影响的 Linux 和 Unix 系统版本（特定于外部资源引用不当的版本）

**利用条件:** 具有本地低权限用户访问权限，系统安装有 GCC 编译环境

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：此POC脚本（exploit.sh）针对CVE-2025-32463漏洞，该漏洞根源在于Sudo对环境变量及外部资源引用的处理不当。POC采用经典的共享库预加载技术（LD_PRELOAD）进行漏洞验证。脚本流程逻辑严密：首先，它创建了一个安全的临时工作目录，避免污染系统路径；其次，通过GCC动态编译一个包含‘__attribute__((constructor))’构造函数的C语言共享库（hax.so）。该构造函数的核心逻辑是调用setreuid(0, 0)和setregid(0, 0)来将进程的实际和有效用户/组ID提升为root，随后通过execl启动一个新的bash Shell。在利用阶段，POC将一个无害的可执行文件（/bin/true）复制到临时目录，并设置LD_PRELOAD环境变量指向恶意的so文件。当通过sudo执行该目标二进制文件时，由于Sudo在特定配置或版本下未能清除或正确校验LD_PRELOAD，导致恶意库在sudo提权后的上下文中被加载，从而直接劫持执行流并获取root权限。此POC能够清晰地展示提权过程，且自动化程度高，在受影响的系统上具有极高的成功率。利用步骤：1. 攻击者以低权限用户登录Linux系统；2. 将exploit.sh上传至系统并赋予执行权限；3. 脚本自动检测gcc环境并创建/tmp目录下的工作空间；4. 脚本编写exploit.c源码并编译生成hax.so；5. 脚本设置LD_PRELOAD环境变量；6. 脚本执行‘sudo ./preload_me’，由于LD_PRELOAD指向的库被加载，系统弹出具有root权限的bash。投毒风险分析：该POC代码表现出较高的防御研究透明度。其内部逻辑完全公开，使用的是标准的C语言系统调用和Shell脚本编写，未发现任何二进制混淆、Base64编码的隐藏payload或未说明的外部网络请求。脚本中虽然涉及到了/tmp目录的操作，但通过mktemp确保了路径的随机性和安全性。投毒风险主要集中在两个方面：第一，虽然脚本目前是清晰的，但攻击者可能在分发此类脚本时，在.so文件的编译源码中插入反弹Shell代码（如利用/dev/tcp进行静默连接），而普通研究员可能仅关注提权结果而忽略了后台的异常连接。第二，脚本中的清理逻辑（虽然在截断部分）若被修改，可能留下具有SUID权限的后门文件。然而，就目前提供的代码片段来看，该POC属于标准的防御性验证代码，不存在恶意投毒行为，风险等级评定为低（15%），主要风险源于用户直接运行来源不明的自动化脚本的通用风险。建议在隔离的沙箱环境或虚拟机中进行复现研究。

**项目地址:** 本地模拟项目 (vulnwatchdog)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
