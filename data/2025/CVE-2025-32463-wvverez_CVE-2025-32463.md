## CVE-2025-32463 - Sudo 本地提权 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (LPE)

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** Sudo 1.9.14 至 1.9.17 (不含 1.9.17p1)

**利用条件:** 本地用户访问权限，系统安装有受影响版本的Sudo，且支持-R (chroot) 选项

**POC 可用性:** 4/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

【POC有效性分析】CVE-2025-32463是一个存在于Sudo中的高危本地提权漏洞。该漏洞的核心在于Sudo处理其'-R'（--chroot）选项时的逻辑缺陷。在受影响的版本中，当使用chroot功能时，Sudo未能正确隔离或重置NSS（Name Service Switch）配置文件的加载路径。根据搜索结果分析，漏洞允许本地攻击者通过提供用户控制目录下的/etc/nsswitch.conf文件，进而劫持Sudo在chroot环境下加载的动态链接库。然而，对比输入的POC代码发现，该POC（exploit.sh）存在明显的逻辑偏差。该POC尝试利用LD_PRELOAD环境变量来加载恶意库（hax.so），这是一种传统的提权手法，在现代Sudo版本中，除非在sudoers配置文件中明确允许（Defaults env_keep += "LD_PRELOAD"），否则Sudo默认会清除LD_PRELOAD等危险环境变量。因此，本输入中的POC代码对于CVE-2025-32463的真实漏洞机理（chroot结合nss劫持）复现并不准确，更像是一个通用的、依赖特定配置的模板化脚本，其直接有效性较低，仅具参考价值。真实的漏洞利用需要构造特定的chroot目录结构并操纵nsswitch配置。【利用步骤】1. 准备攻击目录，并在其中伪造/etc/nsswitch.conf以及对应的恶意动态链接库。2. 执行sudo -R [攻击目录] [程序]。3. 触发Sudo加载伪造的NSS配置。4. NSS库加载恶意SO文件，执行构造函数中的提权代码。5. 获取Root Shell。【投毒风险分析】该POC代码虽然在逻辑上与CVE-2025-32463的底层机理匹配度不高，但从防御性安全研究角度看，其代码透明度较高，投毒风险较低。分析其exploit.sh脚本可见：首先，脚本使用了标准的Shell命令和GCC编译器，没有进行任何混淆或加密处理。其次，恶意Payload部分（exploit.c）清晰地展示了其行为——通过setreuid(0, 0)和setregid(0, 0)尝试提升权限并执行/bin/bash。这种行为是典型的提权漏洞验证行为，而非隐藏的后门。再次，脚本中虽然包含了外部连接引用（GitHub链接），但并未在执行过程中尝试从远程服务器下载或执行二进制文件。最后，脚本包含了清理逻辑（rm -rf ${STAGE}），表现出较好的可控性。尽管如此，安全研究人员在使用此类来自非官方渠道的脚本时，仍需警惕其可能被修改为删除系统文件或泄露敏感环境变量（如SSH Key、History等）的风险。建议在隔离的沙箱环境中进行复现分析，并严格审计GCC编译前的C源码，确保payload不包含向外连回（Reverse Shell）或破坏宿主机的逻辑。

**项目地址:** [https://github.com/wvverez/CVE-2025-32463](https://github.com/wvverez/CVE-2025-32463)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
