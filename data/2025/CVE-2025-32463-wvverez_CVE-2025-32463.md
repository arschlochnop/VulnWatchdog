## CVE-2025-32463 - Sudo 本地权限提升 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** Sudo

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 1.9.14 至 1.9.17p1 之前的版本

**利用条件:** 攻击者需拥有目标系统的本地普通用户权限，且系统安装了受影响版本的 Sudo。

**POC 可用性:** 4/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该提供的PoC脚本在技术逻辑上与CVE-2025-32463的官方漏洞成因存在明显的偏差。CVE-2025-32463的真实根源在于Sudo处理chroot操作时，错误地加载了用户可控目录下的/etc/nsswitch.conf文件，或者在chroot环境切换前后未能正确清理环境变量和文件描述符，导致非特权用户可以诱导Sudo加载恶意的共享库。然而，该脚本（exploit.sh）实际上演示的是一种非常基础且经典的LD_PRELOAD劫持技术。它通过设置LD_PRELOAD环境变量指向一个带有__attribute__((constructor))属性的恶意动态库（exploit.c），该库在被加载时会调用setreuid(0, 0)并执行shell。虽然脚本最后执行了sudo ${TARGET_BIN}，但在现代Linux系统中，sudo在执行时默认会重置环境变量（env_reset），除非在/etc/sudoers中明确配置了SETENV。因此，该脚本在标准配置的系统中无法直接提权。它更多是一个关于动态库劫持的教育性示例，而非针对CVE-2025-32463 chroot漏洞缺陷的深度利用代码。该脚本的有效性极低，仅能作为权限维持或在极其松散配置下的实验，不能代表该CVE的真实威力。【利用步骤】1. 攻击者在本地创建一个临时工作目录。2. 编写一个C语言源文件（exploit.c），利用GCC将其编译为共享库文件（.so），其中包含在库初始化时自动运行的提权代码。3. 创建一个占位用的二进制文件（如复制/bin/true）。4. 设置环境变量LD_PRELOAD指向该恶意库。5. 尝试运行sudo执行该占位二进制文件，期望Sudo在加载动态库时加载该恶意库以获取Root Shell。【投毒风险分析】该脚本的投毒风险评级为低（15%）。代码逻辑公开透明，使用了标准的Bash和C语法，所有操作均在本地/tmp目录下创建的随机目录中进行。分析脚本发现，它并不包含任何远程下载、数据外泄或混淆代码。唯一的风险点在于其引用的GitHub仓库地址（[https://github.com/wvverez](https://www.google.com/search?q=https://github.com/wvverez)），如果该仓库被恶意接管，后续更新的脚本可能包含更复杂的逻辑。由于该脚本在README中声称是针对CVE-2025-32463，但实际代码却是通用的LD_PRELOAD注入，这种‘名不副实’的情况在威胁情报领域通常被视为低质量工具或钓鱼陷阱的特征。防御者在分析此类GitHub项目时，应警惕那些蹭漏洞热度但实现逻辑与漏洞原理完全无关的代码，防止在研究过程中意外执行了带有恶意后门的脚本。本代码段本身是安全的，主要用于安全研究演示。

**项目地址:** [https://github.com/wvverez/CVE-2025-32463](https://github.com/wvverez/CVE-2025-32463)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
