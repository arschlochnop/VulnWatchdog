## CVE-2025-32463 - Sudo 本地提权 (Local Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (Local Privilege Escalation)

**影响应用:** Sudo

**危害等级:** Critical

**CVSS评分:** 9.3

**影响版本:** Sudo 1.8.8 to 1.9.17 (inclusive), specifically versions 1.9.14 through 1.9.17

**利用条件:** 本地用户访问 (Local user access), 无需sudo权限

**POC 可用性:** 10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-32463是一个影响Sudo的关键本地提权（LPE）漏洞，CVSS评分高达9.3。该漏洞影响Sudo 1.8.8至1.9.17版本，尤其包括1.9.14到1.9.17之间的版本。攻击者可以利用此漏洞，使一个没有sudo权限的本地普通用户提升至root权限。漏洞的根源在于Sudo在处理`--chroot`选项时的一个缺陷，这与`plugins/sudoers/sudoers.c`文件中的命令匹配处理代码以及`-R`功能在联合NSS（Name Service Switch）劫持时的行为有关。即使系统管理员没有为用户配置任何sudo权限，该漏洞也能被利用来绕过现有安全限制，从而获得对系统的完全控制权。该漏洞的公开披露日期为2025年6月30日，引起了包括Ubuntu、阿里云等在内的多个厂商和安全社区的高度关注，并建议受影响用户及时更新补丁。

**POC有效性分析:**
提供的POC是一个名为`exploit.sh`的Shell脚本，它是一个功能完整且结构良好的本地提权工具，旨在演示并利用CVE-2025-32463。该POC的核心机制是滥用`LD_PRELOAD`环境变量与Sudo漏洞的结合。脚本首先检查系统是否安装了`gcc`编译器，然后在一个临时且安全的目录下（如`/tmp/sudo_preload_stage.XXXXXX`）构建漏洞利用环境。它会编译一个恶意的C语言代码文件`exploit.c`，生成一个共享库`hax.so`。`exploit.c`中包含一个`__attribute__((constructor))`修饰的`init()`函数。当`hax.so`被动态链接器加载时，`init()`函数会自动执行。在此函数内部，`setreuid(0, 0)`和`setregid(0, 0)`被调用，将有效用户ID和组ID设置为root（0），随后`execl("/bin/bash", ...)`被用于启动一个root权限的Bash Shell。脚本将`hax.so`复制到临时目录的`lib`子目录中，然后设置`LD_PRELOAD`环境变量指向这个恶意库。最后，脚本尝试执行一个无害的二进制文件（如`/bin/true`），利用Sudo处理`--chroot`选项的逻辑缺陷，使得`LD_PRELOAD`能够被异常处理，从而在root上下文中加载恶意库并触发提权。整个POC流程自动化且高效，提供了直接获得root shell的途径，对受影响系统具有高度的利用价值。

**利用步骤:**
1.  确保目标Linux系统已安装`gcc`编译器。
2.  通过Git克隆POC代码库：`git clone https://github.com/wvverez/CVE-2025-32463.git`
3.  进入克隆的代码目录：`cd CVE-2025-32463`
4.  赋予`exploit.sh`脚本执行权限：`chmod +x exploit.sh`
5.  执行提权脚本：`./exploit.sh`
6.  如果系统易受攻击，脚本将成功编译并执行，最终返回一个具有root权限的Bash Shell。

**投毒风险分析:**
该POC代码的投毒风险极低，估计为5%。`exploit.sh`脚本以及其生成的`exploit.c`代码都非常简洁明了，没有发现任何混淆、加密或尝试隐藏恶意行为的迹象。Shell脚本主要执行标准操作，如检查`gcc`、创建临时目录、编译C代码和设置环境变量。它没有包含任何外部网络请求、异常的系统调用或数据外发行为。`exploit.c`文件是最小化的，仅包含实现权限提升所必需的`setreuid`、`setregid`和`execl`函数调用。代码的目标清晰地指向CVE-2025-32463的本地权限提升，而非植入后门、进行数据窃取或建立持久性访问。作为防御性安全研究员，我们确认此POC的主要目的是为了漏洞验证和安全研究，不包含其他恶意负载。尽管如此，始终建议在执行任何来自外部源的POC代码之前，对其进行彻底的代码审查。

**项目地址:** https://github.com/wvverez/CVE-2025-32463

**漏洞详情:** https://ubuntu.com/security/CVE-2025-32463
