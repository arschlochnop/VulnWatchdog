## CVE-2025-32463 - Sudo (Linux/Unix 系统通用组件) 本地权限提升 (Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (Privilege Escalation)

**影响应用:** Sudo (Linux/Unix 系统通用组件)

**危害等级:** 高 (High)

**CVSS评分:** 9.3

**影响版本:** 几乎所有主流 Linux 和 Unix 系统中的 Sudo 版本 (具体受影响版本视官方修复补丁发布前而定)

**利用条件:** 需要低权限用户访问权限，且系统环境允许执行 gcc 编译及设置环境变量

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

【POC有效性分析】该POC针对CVE-2025-32463提供了一个完整的本地权限提升自动化脚本。漏洞根源在于Sudo对外部资源（特别是动态链接库环境变量）的引用处理不当。该POC脚本（exploit.sh）通过以下逻辑验证漏洞：首先，它检查本地环境是否具备编译条件（gcc）；随后，通过cat指令动态生成一个名为exploit.c的C语言源码文件。该源码的核心在于使用了__attribute__((constructor))属性，这使得编译出的共享库（.so文件）在被加载时会立即执行init函数。在该函数内部，脚本调用setreuid(0, 0)和setregid(0, 0)尝试将进程的有效用户ID和组ID提升至root权限，并最终通过execl启动一个交互式的bash shell。脚本随后利用export LD_PRELOAD机制，将编译好的恶意库注入到受控的二进制执行过程中。通过执行带有sudo权限的伪装程序，触发动态链接器加载LD_PRELOAD指定的库，从而实现非特权用户向root用户的提权。经分析，该代码逻辑闭环，利用了经典的动态链接库注入技术配合Sudo的配置缺陷，在满足特定环境条件下具有极高的成功率。利用步骤如下：1. 下载POC脚本及配套文件；2. 赋予exploit.sh执行权限；3. 运行脚本，脚本会自动创建临时目录并生成C源码；4. 脚本调用gcc编译生成hax.so；5. 设置LD_PRELOAD环境变量指向该库；6. 脚本执行sudo命令触发提权；7. 成功获取root shell。 【投毒风险分析】作为威胁情报团队，对该POC的投毒风险评估为低风险（10%）。代码透明度极高，整个利用过程完全由明文的Shell脚本和标准的C语言源码组成，不包含任何混淆过的二进制数据、Base64加密载荷或远程指令下载行为。脚本中所有操作均在本地/tmp目录下的随机临时文件夹中进行，并包含自动化的清理逻辑（rm -rf ${STAGE}），这符合安全研究人员编写概念验证代码的习惯。代码中唯一敏感的行为是尝试获取root权限，但这属于PoC的核心功能，而非隐蔽的后门。在Github仓库及代码注释中，作者明确标识了身份（wvverez）及项目意图。虽然此类POC常被黑客利用，但从防御性安全研究角度看，该脚本本身不具备针对研究人员开发机进行恶意破坏或窃取信息的投毒特征。主要的风险点仅在于：如果用户在未审计的情况下直接运行，脚本会由于setreuid(0, 0)的成功执行而改变系统的权限上下文。整体来看，这是一个纯粹的、用于演示安全漏洞的技术脚本，未发现任何集成恶意软件、勒索病毒或远程监控（RAT）组件的迹象。

**项目地址:** [https://github.com/wvverez/CVE-2025-32463](https://github.com/wvverez/CVE-2025-32463)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
