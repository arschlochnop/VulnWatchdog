## CVE-2025-32463 - Sudo (Linux/Unix Utility) 权限提升 (Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 权限提升 (Privilege Escalation)

**影响应用:** Sudo (Linux/Unix Utility)

**危害等级:** 高危

**CVSS评分:** 9.3 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 几乎所有主流 Linux 和 Unix 系统中的特定 Sudo 版本（通常为 1.9.x 之前的旧版本或特定配置版本）

**利用条件:** 具有本地低权限用户访问权限，且目标系统上的 Sudo 配置允许特定环境变量（如 LD_PRELOAD）的传递，或存在可被 Sudo 执行的特定二进制文件。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC代码针对CVE-2025-32463提供了一个完整的本地提权利用脚本。脚本通过创建一个伪造的共享库（exploit.c），利用__attribute__((constructor))特性，在库加载时自动执行setreuid(0,0)和setregid(0,0)来提升进程权限至root，随后调用execl启动交互式shell。其核心逻辑在于利用Sudo在执行特定二进制文件时对LD_PRELOAD环境变量处理不当的漏洞。该POC结构清晰，包含了自动化编译（gcc）、环境搭建（mktemp）、利用执行（sudo ./preload_me）以及清理现场（rm -rf）的全过程。从防御研究角度看，该POC能有效复现权限提升过程，证明了如果Sudo配置不当，攻击者可以通过注入恶意动态链接库的方式完全接管系统。脚本逻辑自洽，在具备gcc环境和漏洞前提条件的Linux系统上具有极高的成功率。利用步骤：1. 在受影响系统中以低权限用户运行exploit.sh。2. 脚本创建临时工作目录并生成恶意C源代码。3. 调用gcc将C代码编译为名为hax.so的共享对象文件。4. 脚本将/bin/true复制到当前目录并重命名，作为触发载体。5. 设置环境变量LD_PRELOAD指向该恶意so文件。6. 通过sudo命令执行载体文件，Sudo在加载程序时会预加载恶意库，触发init函数获取root shell。7. 用户退出shell后，脚本自动删除所有临时文件。投毒风险分析：该POC的投毒风险评级为低（15%）。代码主要使用了标准的Linux命令和GCC编译器，逻辑完全透明，没有经过任何混淆或加密处理。通过审计exploit.sh和exploit.c，可以确认其行为仅限于在/tmp目录下创建临时文件、提升权限并打开本地shell，未发现任何向外部IP发送敏感数据（如/etc/shadow）、建立反弹shell到远程服务器、或者安装持久性后门（如修改crontab或添加SSH Key）的恶意逻辑。脚本中虽然使用了curl/wget（注：本脚本未包含，仅为审计考量），但其主要依赖本地编译。唯一的潜在风险点在于GitHub仓库可能在未来版本中引入恶意的二进制预编译文件，但在当前提供的脚本源码中，所有操作都是基于可阅读的明文代码，对于安全研究员来说是安全的。建议在使用此类POC时，始终在隔离的沙箱环境中执行，并确保GCC编译的源代码与脚本所述一致。

**项目地址:** [https://github.com/wvverez/CVE-2025-32463](https://github.com/wvverez/CVE-2025-32463)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
