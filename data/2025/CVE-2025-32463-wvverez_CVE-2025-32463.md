## CVE-2025-32463 - Sudo 本地提权 (Local Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (Local Privilege Escalation)

**影响应用:** Sudo

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 1.9.14 至 1.9.17p1 之前的版本

**利用条件:** 本地低权限用户访问，目标系统安装有受影响版本的Sudo，且gcc环境可用（用于编译PoC）。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞源于Sudo自1.9.14版本引入的chroot机制缺陷。当sudo执行具有chroot限制的命令时，由于对用户可控目录下的配置文件（如/etc/nsswitch.conf）处理不当，导致攻击者可以诱导系统加载恶意路径下的动态链接库。提供的Bash脚本PoC通过创建一个伪造的C语言环境，利用__attribute__((constructor))特性编写了一个共享对象（.so文件）。脚本核心逻辑在于设置LD_PRELOAD环境变量指向该恶意库。当执行sudo命令时，loader会优先加载该库并触发init函数，该函数调用setreuid(0,0)和setregid(0,0)将当前进程权限提升至root，并最终弹出bash shell。经分析，该PoC逻辑清晰，完全符合Sudo劫持共享库进行提权的攻击向量。但在实际现代Linux发行版中，sudo通常会清理LD_PRELOAD等危险环境变量（Secure-Execution模式），因此该PoC的成功极度依赖于Sudo在处理chroot指令时未能正确重置执行环境。利用步骤：1. 本地登录低权限账号；2. 运行exploit.sh脚本；3. 脚本自动创建临时目录并生成恶意C代码；4. 脚本调用gcc编译生成hax.so；5. 脚本设置LD_PRELOAD环境变量并尝试通过sudo执行/bin/true；6. 触发库加载，获得root shell。 投毒风险分析：该代码段投毒风险较低。代码采用透明的Bash脚本编写，所有行为均在本地可见，不涉及任何远程服务器连接（C2）、二进制混淆或自动下载外部不明脚本的行为。其清理机制（rm -rf ${STAGE}）属于常规的开发习惯，用于擦除利用痕迹，而非恶意破坏系统数据。主要的风险点在于：首先，该PoC使用了mktemp创建临时目录，若在多用户环境下，不当的权限设置可能导致竞争条件；其次，脚本依赖外部gcc编译器，在生产环境直接运行编译行为可能被安防软件拦截并标记为可疑。代码库虽然链接到了GitHub，但其逻辑简单、易于审计，没有发现任何尝试窃取SSH密钥、修改环境变量持久化或植入木马的隐藏代码。风险百分比定为15%，主要考虑到脚本执行了chmod/rm等操作，且提升权限后若被非法修改，可能造成系统损坏。

**项目地址:** [https://github.com/wvverez/CVE-2025-32463](https://github.com/wvverez/CVE-2025-32463)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
