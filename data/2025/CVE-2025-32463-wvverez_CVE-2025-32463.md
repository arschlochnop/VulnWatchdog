## CVE-2025-32463 - Sudo 本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 

**影响版本:** Sudo 1.9.14, 1.9.15, 1.9.16, 1.9.17 (在1.9.17p1版本之前)

**利用条件:** 需要本地低权限用户访问

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-32463 是 Linux `sudo` 组件中的一个高危本地提权漏洞。根据已披露的信息和提供的PoC代码，该漏洞允许本地低权限用户绕过安全限制，获取系统root权限。尽管一些搜索结果提到了与 `chroot` 功能中 `nsswitch.conf` 文件处理不当相关的缺陷（如 `Sudo before 1.9.17p1` 版本），但本分析主要基于所提供的PoC，其核心利用机制是滥用 `LD_PRELOAD` 环境变量。 `sudo` 在某些配置或版本中，在执行需要root权限的命令时，未能正确清除或限制 `LD_PRELOAD` 环境变量，导致恶意加载的共享库在 `sudo` 进程上下文中运行并继承其高权限。攻击者可以精心构造一个恶意共享库，通过 `LD_PRELOAD` 机制在 `sudo` 提升权限时自动执行其中代码，从而实现权限提升。此漏洞对运行受影响 `sudo` 版本的Linux系统构成严重威胁，因为一旦攻击者获得本地访问权限，即可迅速取得系统最高控制权。

**POC有效性分析与利用步骤：**
所提供的PoC是一个名为 `exploit.sh` 的bash脚本，其功能完整且高度自动化，能够有效利用 `LD_PRELOAD` 机制实现本地提权。
1.  **PoC有效性分析：**
    *   **代码透明度：** `exploit.sh` 脚本和其编译的 `exploit.c` 代码都非常清晰，没有混淆或隐藏的恶意行为（除了预期的提权）。
    *   **核心机制：** `exploit.c` 文件包含一个 `__attribute__((constructor))` 修饰的 `init()` 函数。这意味着当该共享库被动态链接器加载时，`init()` 函数会自动执行。`init()` 函数内部调用 `setreuid(0, 0)` 和 `setregid(0, 0)` 将当前进程的用户ID和组ID设置为0（即root），然后通过 `execl("/bin/bash", "[sudo_preload_shell]", NULL)` 启动一个root权限的bash shell。
    *   **利用流程：** `exploit.sh` 脚本首先检查 `gcc` 是否安装，然后在一个临时目录 (`/tmp/sudo_preload_stage.XXXXXX`) 中创建 `exploit.c` 文件并编译成共享库 `hax.so`。接着，它将 `hax.so` 复制到一个名为 `lib` 的子目录中，并将 `/bin/true` 复制为 `preload_me`。最后，脚本将 `LD_PRELOAD` 环境变量设置为 `./lib/hax.so`，并尝试以 `sudo` 权限执行 `preload_me`。当 `sudo` 执行 `preload_me` 时，由于 `LD_PRELOAD` 的存在，恶意库 `hax.so` 会被加载，其 `init()` 函数执行，从而获得root权限的shell。
    *   **漏洞版本覆盖：** PoC README明确指出受影响版本包括 `sudo 1.9.14`, `1.9.15`, `1.9.16`, `1.9.17`。结合搜索结果中提到的 "Sudo before 1.9.17p1"，该PoC在这些版本上应能成功。
    *   **环境依赖：** 仅依赖 `gcc` 用于编译，以及目标系统存在受影响的 `sudo` 版本。
    *   **结论：** 该PoC是功能完整的，自动化程度高，代码直接实现权限提升，具备高有效性。

2.  **利用步骤：**
    *   在受影响的Linux系统上（需要本地低权限用户访问），执行以下命令：
    *   `git clone https://github.com/wvverez/CVE-2025-32463.git`
    *   `cd CVE-2025-32463`
    *   `chmod +x exploit.sh`
    *   `./exploit.sh`
    *   成功执行后，当前shell将变为root权限。

**投毒风险分析：**
对于此PoC，投毒风险评估为 **5% (低风险)**。
*   **代码透明度高：** PoC的 `exploit.sh` 和 `exploit.c` 代码逻辑清晰，没有使用任何形式的代码混淆或加密。所有操作都是可见且易于理解的。
*   **核心功能单一：** `exploit.c` 的核心功能仅限于修改进程的用户和组ID为root，然后启动一个bash shell。没有发现任何执行其他恶意操作的代码，例如窃取数据、安装后门、连接C2服务器、下载额外payload或进行网络扫描等。
*   **无外部依赖或可疑请求：** 脚本不从外部下载任何组件，也不向任何远程服务器发送数据。所有操作都在本地执行，并且不涉及不必要的网络通信。
*   **标准库使用：** `exploit.c` 使用的是标准的C库函数 (`stdio.h`, `stdlib.h`, `unistd.h`)，并无异常或第三方库的引入。
*   **攻击意图明确：** PoC的目的是明确地展示CVE-2025-32463漏洞的本地权限提升能力，而非隐藏其他恶意功能。从代码角度看，其行为完全符合漏洞验证的目的。
*   **结论：** 鉴于代码的高度透明性、单一的攻击目的以及缺乏任何可疑的外部依赖或恶意行为，该PoC被认为投毒风险非常低。在防御性安全研究中使用时，对其进行代码审计应能轻松验证其无害性（除了预期的权限提升）。

**项目地址:** https://github.com/wvverez/CVE-2025-32463

**漏洞详情:** https://www.sogou.com//link?url=hedJjaC291MuI-PTV1Yb895SGbo6UZPT9dIRNizanyZnyfgRyID3pO_nc2oEXi8eNxcUTSw_Dim_8_sVDrvNTg..
