## CVE-2025-30208 - Vite 任意文件读取

**漏洞编号:** CVE-2025-30208

**漏洞类型:** 任意文件读取

**影响应用:** Vite

**危害等级:** 高危

**CVSS评分:** 7.5 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N)

**影响版本:** Vite 6.2.0-6.2.2, 6.1.0-6.1.1, 6.0.0-6.0.11, 5.0.0-5.4.14, 以及 4.5.5 以下版本

**利用条件:** Vite 开发服务器处于运行状态，且配置了 server.host 或通过 --host 参数允许外部访问。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：提供的Bash脚本（vite.sh）是一个针对Vite开发服务器任意文件读取漏洞的自动化扫描和利用工具。该POC的核心逻辑在于利用Vite在开发模式下处理`/@fs/`路径时的逻辑缺陷。Vite为了方便开发，允许通过该前缀访问本地文件系统，但由于对URL参数（如`raw`, `import`, `inline`等）的组合处理不当，导致攻击者可以绕过预设的安全沙箱限制。脚本中定义了庞大的`PAYLOADS`数组，尝试了各种查询参数组合（例如`?raw??`、`?import&raw`等），这些组合旨在触发Vite内部不同的解析分支，从而绕过文件路径校验。脚本同时内置了大量的敏感文件路径列表（`FILES`），包括`/etc/passwd`、`.env`、`.aws/credentials`、SSH密钥等，具有极强的针对性。在实际测试中，只要Vite服务器暴露在公网或攻击者可达的网络中，该脚本能够高效地遍历并提取敏感配置。其利用步骤如下：1. 确认目标Vite开发服务器地址。2. 运行脚本并指定目标URL。3. 脚本会自动循环遍历不同的Payload前缀与敏感文件路径的组合。4. 脚本通过HTTP请求检测响应状态码和内容特征。5. 如果成功，攻击者将获得目标服务器上不受限的文件读取权限。该漏洞不仅威胁源代码安全，更可能导致云服务凭据、数据库密码等核心机密泄露。

投毒风险分析：经过对提供的Bash脚本代码分析，该POC主要表现为功能性的漏洞利用工具，其代码逻辑相对透明。脚本使用了标准的Bash语法、curl命令以及常见的循环结构，没有发现明显的二进制植入、远程Shell反弹或混淆代码。然而，存在以下潜在的投毒或误用风险：首先，脚本中包含极长且详细的敏感路径扫描列表，如果攻击者将其修改为包含恶意下载命令的URL，初级用户在未检查代码的情况下直接运行可能导致非预期的副作用。其次，脚本末尾（虽然在截断部分未显示，但通常此类脚本会包含结果上传逻辑）如果被植入将截获的数据发送到第三方监控服务器的逻辑，则构成了数据窃取型的投毒。目前分析的这段代码属于‘清洁’的漏洞研究脚本，但用户从第三方存储库下载时应高度警惕其是否被二次修改。由于该漏洞在2025年3月底披露后迅速引起关注，Github等平台可能出现伪装成此CVE修复工具或一键POC的恶意程序，建议研究人员仅在隔离环境中运行此类自动化脚本，并审查脚本中curl请求的每一个目标地址，确保数据不会流向攻击者控制的C2服务器。整体而言，该脚本本身投毒风险较低，但其作为攻击工具的杀伤力较大，需严格限制使用范围。

**项目地址:** [https://github.com/ThumpBo/CVE-2025-30208-EXP](https://github.com/ThumpBo/CVE-2025-30208-EXP)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-30208](https://nvd.nist.gov/vuln/detail/CVE-2025-30208)
