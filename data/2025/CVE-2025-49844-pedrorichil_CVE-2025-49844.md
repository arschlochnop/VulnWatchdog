## CVE-2025-49844 - Redis RCE (Use-After-Free)

**漏洞编号:** CVE-2025-49844

**漏洞类型:** RCE (Use-After-Free)

**影响应用:** Redis

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** Redis < 6.2.20, 7.2.0 ≤ Redis < 7.2.11, 7.4.0 ≤ Redis < 7.4.6, 8.0.0 ≤ Redis < 8.0.4, 8.2.0 ≤ Redis < 8.2.2

**利用条件:** 需要经过身份验证（拥有执行Lua脚本的权限），可通过网络访问Redis端口（默认6379）。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC（代号RediShell）针对Redis Lua脚本引擎中的Use-After-Free（UAF）漏洞。通过分析提供的Dockerfile和README，此POC提供了一个完整的漏洞实验室环境。有效性体现在其结构化的测试模式：包含‘check’（版本检测）、‘basic’（UAF基础测试）、‘sandbox’（沙箱逃逸）及‘advanced’（高级内存损坏）。漏洞核心在于Lua脚本在执行过程中，通过精心构造的垃圾回收（GC）操控，诱发内存释放后重用，从而绕过Lua沙箱限制并在Redis进程上下文中执行系统命令。由于Redis通常以较高权限运行，此利用可直接导致底层服务器失陷。提供的Python脚本具有高度的可操作性，支持自动化利用流，是一个具备实战价值的利用工具。【利用步骤】1. 环境部署：使用Docker启动包含漏洞的Redis 7.2.0镜像，配置关闭保护模式以允许外部连接。2. 依赖安装：在攻击机安装redis及colorama等Python库。3. 漏洞验证：运行脚本并使用-m check参数确认目标是否存在受影响版本。4. 漏洞利用：执行python3 exploit_poc.py -H [目标IP] -p [端口] -m all，脚本将依次触发内存损坏、逃逸沙箱并尝试获取Shell。如果设置了密码，需通过-a参数提供凭证。【投毒风险分析】该POC项目结构清晰，主要风险点在于其依赖项和复杂的Python利用脚本。分析显示，脚本可能通过调用外部库或动态生成的Lua字节码来执行操作，此类混淆或复杂的二进制负载是隐藏后门的常见位置。风险评估为15%，属于较低水平，因为其主要逻辑位于公开的Dockerfile和README中，且作为实验室环境发布，透明度较高。然而，防御者仍需警惕利用脚本中是否存在非必要的网络连接（Outbound connections）或在内存注入阶段植入额外的持久化后门。建议在隔离的沙箱环境中使用静态分析工具扫描exploit_poc.py，并监控其利用过程中的异常网络流量。此POC虽然功能强大，但其开放的代码结构降低了其作为投毒载体的隐蔽性，更倾向于教育与渗透测试工具。

**项目地址:** [https://github.com/redis/redis/security/advisories/GHSA-4789-qfc9-5f9q](https://github.com/redis/redis/security/advisories/GHSA-4789-qfc9-5f9q)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)
