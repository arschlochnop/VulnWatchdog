## CVE-2025-49844 - Redis RCE (Remote Code Execution)

**漏洞编号:** CVE-2025-49844

**漏洞类型:** RCE (Remote Code Execution)

**影响应用:** Redis

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** Redis < 8.2.2, < 8.0.4, < 7.4.6, < 7.2.11 (影响 6.x, 7.x, 8.x 分支)

**利用条件:** 需要经过身份验证的远程访问权限（低权限用户即可），且Redis实例启用了Lua脚本功能。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC（RediShell）针对的是Redis Lua脚本引擎中的Use-After-Free (UAF) 漏洞。分析提供的代码结构，包含完整的Dockerfile实验环境、README文档以及功能分类明确的Python利用脚本。该POC不仅提供了基础的UAF检测逻辑，还包含了针对不同层面的验证模式，如沙箱逃逸测试、内存损坏测试以及高级利用模式。代码逻辑清晰，使用了标准的redis-py和colorama库，未发现明显的恶意混淆或后门注入。实验环境采用Redis 7.2.0镜像，能够稳定复现漏洞点。利用核心在于通过精心构造的Lua脚本触发内存释放后的重用，从而绕过Lua沙箱执行系统级命令。由于该漏洞获得了CVSS 10.0的满分评分，且POC代码展现了从内存崩溃到指令执行的完整路径，因此该POC具有极高的实战参考价值和防御研究意义。【利用步骤】1. 环境准备：通过Docker部署受影响的Redis 7.2.0版本，确保端口6379开放且非保护模式运行。2. 依赖安装：安装Python环境及redis客户端库。3. 漏洞检测：运行脚本使用-m check参数，通过发送特定的Lua脚本观察Redis返回的错误信息或内存响应，确认目标是否具有UAF特征。4. 漏洞触发：选择-m basic或-m sandbox模式，脚本会向服务端发送特定的EVAL命令，触发Lua解释器在处理特定变量时的释放重用。5. 远程执行：在advanced模式下，利用内存布局控制覆盖函数指针，实现从Lua执行流切换到libc system函数，从而执行OS指令。【投毒风险分析】当前获取的POC代码主要用于防御性安全研究和教育目的，具有较高的透明度。风险分析如下：首先，项目结构规范，所有依赖均为Python官方生态库，未见加载远程未知二进制文件的行为。其次，虽然利用代码中包含复杂的内存偏移操作，但这是实现RCE的技术必要手段，而非恶意投毒特征。然而，作为首个Redis CVSS 10.0漏洞，由于其危害巨大，后续可能会出现大量基于此POC修改的变体，攻击者可能会在这些变体中植入反弹Shell或窃取Redis数据的恶意代码。目前的15%风险主要源于此类高价值POC在二次传播中极易被恶意篡改。防御建议：在隔离环境中运行此类POC，并严格审查Python脚本中的网络连接（除目标Redis外）和外部命令调用逻辑。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-49844-RediShell](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-49844-RediShell)

**漏洞详情:** [https://redis.io/blog/security-advisory-cve-2025-49844/](https://redis.io/blog/security-advisory-cve-2025-49844/)
