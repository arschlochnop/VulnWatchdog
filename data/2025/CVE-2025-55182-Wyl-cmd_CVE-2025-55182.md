## CVE-2025-55182 - React Server Components, Next.js, Shopify Hydrogen, Gatsby 5 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React Server Components, Next.js, Shopify Hydrogen, Gatsby 5

**危害等级:** 高危

**CVSS评分:** 未提供具体CVSS评分，但根据多家安全厂商报告，该漏洞被评估为“核弹级”高危漏洞，具备影响范围广、攻击门槛低、危害程度高等特点。

**影响版本:** 受影响的React Server Components及其相关框架（如Next.js、Shopify Hydrogen、Gatsby 5）中处理Flight协议反序列化机制的特定版本。漏洞公开后迅速被利用，表明其影响的是广泛部署的版本，但具体受影响版本范围未详细披露。

**利用条件:** 未经身份验证的远程攻击，通过HTTP/HTTPS网络访问目标服务即可利用，攻击门槛低。

**POC 可用性:** 9/10

**POC 类型:** 完整利用/批量扫描工具

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-55182，被命名为“React2Shell”，是React Server Components (RSC) 中发现的一个高危远程代码执行（RCE）漏洞。该“核弹级”漏洞源于React Flight反序列化机制对对象属性访问路径（如`__proto__`、`constructor`）校验不足。攻击者可通过构造恶意`multipart/form-data`请求，利用`$B`引用结合可控的`_response._prefix`和被劫持为`Function`的`_formData.get`，动态生成包含任意系统命令的函数，并将其赋值给对象的`.then`属性。当服务器处理这些精心构造的反序列化数据时，就会触发远程代码执行。由于React Server Components广泛应用于Next.js、Shopify Hydrogen、Gatsby 5等主流框架，此漏洞的潜在影响范围极其广泛。

**POC有效性分析与利用步骤:**
提供的Python POC脚本`CVE-2025-55182批量测试脚本.py`是一个功能完整且高度有效的自动化漏洞检测与利用工具。该脚本能够高效地批量扫描目标，识别并验证CVE-2025-55182漏洞的存在。
1.  **构造恶意请求**: 脚本首先构建一个精心设计的HTTP POST请求。请求头中包含必要的`Host`、`Next-Action`、`X-Nextjs-Request-Id`、`X-Nextjs-Html-Request-Id`等字段，并将`Content-Type`设置为`multipart/form-data`，并指定一个边界字符串。
2.  **生成恶意Payload**: 请求体中的`multipart/form-data`部分包含了一个高度复杂的、符合React Flight协议的JSON-like流式数据。这个Payload利用了原型链污染（Prototype Pollution）技术，通过控制`$B`引用（React Flight协议中的一种引用机制）并结合对`__proto__`和`constructor`等对象属性的劫持，实现了对内部函数行为的篡改。
3.  **劫持函数与注入命令**: 攻击的核心在于通过操纵`_formData.get`等内部方法，使其动态生成一个包含任意系统命令（例如，执行`echo test123`命令）的JavaScript函数。随后，该恶意函数被赋值给某个对象的`.then`属性。
4.  **触发RCE**: 当易受攻击的React Server Component在服务器端接收并反序列化这个Flight Payload时，由于其对对象属性访问路径的校验不足，会导致恶意注入的`.then`属性被调用，从而触发预设的系统命令执行，实现远程代码执行。
5.  **结果验证**: 脚本通过检查响应头中是否包含特定的字符串（例如“test123”），来判断命令是否成功执行。这种被动验证方式（而非直接获取命令输出）在许多RCE场景下是有效的，尤其当直接输出到HTTP响应体不可行时。
该POC脚本支持多线程并发检测，具有良好的用户界面提示（使用`tqdm`显示进度），并将发现的漏洞URL写入`vuln.txt`文件，显示出其作为实战化批量检测工具的可靠性。其无需认证的特性和低攻击复杂度，使得该漏洞一旦暴露，极易被大规模利用。

**投毒风险分析:**
对`CVE-2025-55182批量测试脚本.py`的详细分析表明，该POC脚本的投毒风险极低，评估为10%。
1.  **代码透明度高**: 脚本代码未经过任何混淆处理，结构清晰，逻辑一目了然。所有操作，包括文件读写、网络请求和Payload构建，都可以直接在代码中审查，便于安全研究人员进行代码审计，确保其行为的合法性。
2.  **标准库使用**: 脚本仅依赖Python标准库（如`os`, `sys`, `json`, `threading`, `time`, `concurrent.futures`）以及常用的第三方库`requests`, `urllib3`, `tqdm`。这些库都是Python生态系统中广泛使用且经过严格审查的成熟组件，不包含已知的恶意功能或安全漏洞。`urllib3.disable_warnings`是一个常见且无害的操作，用于抑制HTTPS证书警告。
3.  **无外部恶意连接**: 脚本的核心功能是向用户指定的目标URL发送探测请求。分析其网络通信模式，没有发现任何尝试连接到外部不明C2服务器、下载额外恶意负载或进行数据窃取的行为。所有的网络流量都指向用户明确提供的目标地址。
4.  **文件系统操作受限**: 脚本对本地文件系统的操作仅限于读取可能存在的URL列表（如果支持从文件加载目标）以及将发现的漏洞URL写入一个名为`vuln.txt`的文本文件。这些操作是安全扫描工具的常规行为，且没有迹象表明脚本会写入、修改或删除任何系统关键文件，也不会执行任何未经授权的文件操作。
5.  **Payload隔离**: 尽管POC中的Payload本身旨在执行远程命令，但这部分逻辑是用于攻击远程目标，而不是感染运行POC的本地系统。脚本自身不会在本地执行该恶意Payload。它只是将Payload作为HTTP请求的一部分发送出去。
6.  **无混淆或动态加载**: 脚本中没有发现使用`eval()`、`exec()`等动态代码执行函数来加载外部或混淆代码的行为，也没有动态加载模块或组件，进一步降低了隐藏恶意行为的可能性。
综合来看，该POC脚本被设计为一个纯粹的漏洞验证工具，其代码行为符合预期，未包含任何恶意载荷或旨在危害使用者系统的功能。因此，研究人员可以相对放心地使用该POC进行防御性安全研究和漏洞应急响应工作。

**项目地址:** 未提供

**漏洞详情:** https://www.cert.org.cn/publish/main/10/2025/20251230133838902987706/20251230133838902987706_.html
