# CVE-2025-27636

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-27636-akamai_CVE-2025-27636-Apache-Camel-PoC.md](../2025/CVE-2025-27636-akamai_CVE-2025-27636-Apache-Camel-PoC.md)

## CVE-2025-27636-Apache Camel-Header注入

**漏洞编号:** CVE-2025-27636

**漏洞类型:** Header注入/方法调用

**影响应用:** Apache Camel

**危害等级:** 中危，可能导致远程代码执行或未经授权的访问

**影响版本:** 4.10.0-4.10.1, 4.8.0-4.8.4, 3.10.0-3.22.3

**利用条件:** Apache Camel应用需要直接或间接接收HTTP请求，且使用了受影响的组件（如camel-servlet, camel-jetty, camel-undertow等）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-27636是Apache Camel中的一个Header注入漏洞，源于不正确的Header过滤机制。默认情况下，Camel会过滤以"Camel", "camel", 或 "org.apache.camel."开头的Header，但由于大小写处理不当，攻击者可以构造类似"CAmelExecCommandExecutable"这样的Header来绕过过滤，从而注入恶意的Camel Header。根据POC代码，攻击者可以通过注入`CamelExecCommandExecutable` Header来覆盖`exec`组件中静态定义的命令，实现任意命令执行。攻击者还可以通过`CamelExecCommandArgs` Header传递参数。POC中还提到了CVE-2025-29891，该漏洞是header注入通过参数进行利用。

**有效性评估：**

提供的POC代码有效，成功演示了如何利用大小写绕过Header过滤，实现任意命令执行。

**投毒风险评估：**

检查了提供的`pom.xml`, `README.MD`，没有发现任何可疑的恶意代码或者后门，唯一需要注意的是该程序本身就是漏洞利用的演示，运行之后会开放端口接受任意命令执行，从这方面来说，运行该程序本身就存在一定的风险，但不能将其称之为投毒。
`README.MD`说明了该漏洞的利用方式以及如何构建和运行示例应用程序，以及license信息，该文件没有发现存在可疑代码。
`pom.xml`是Maven的项目配置文件，用于管理项目依赖、构建过程等。检查了`pom.xml`文件，主要关注了依赖项部分，没有发现任何不常见的、可疑的依赖项。声明了Apache Camel Core库的版本为4.10.0，并且声明了`maven-exec-plugin`插件，用于直接从Maven运行Java程序。
因此，投毒风险较低，判断为5%。

**利用方式：**

1.  攻击者向易受攻击的Apache Camel应用发送HTTP请求。
2.  请求中包含精心构造的Header，Header名称通过改变大小写绕过默认的Header过滤规则。
3.  利用注入的Header，攻击者可以改变Camel组件的行为，例如：
    *   通过`CamelExecCommandExecutable` Header覆盖`exec`组件的执行命令，实现任意命令执行（RCE）。
    *   利用`camel-bean`组件，调用Bean中的其他方法。
    *   利用`camel-jms`组件，将消息发送到其他队列。
4.  服务器执行攻击者指定的命令或操作，导致安全风险。

**项目地址:** [akamai/CVE-2025-27636-Apache-Camel-PoC](https://github.com/akamai/CVE-2025-27636-Apache-Camel-PoC)

**漏洞详情:** [CVE-2025-27636](https://nvd.nist.gov/vuln/detail/CVE-2025-27636)

---

## POC #2

**来源**: [CVE-2025-27636-enochgitgamefied_CVE-2025-27636-Pratctical-Lab.md](../2025/CVE-2025-27636-enochgitgamefied_CVE-2025-27636-Pratctical-Lab.md)

## CVE-2025-27636-Apache Camel-Header注入

**漏洞编号:** CVE-2025-27636

**漏洞类型:** Header注入/RCE

**影响应用:** Apache Camel

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 4.10.0 <= version <= 4.10.1, 4.8.0 <= version <= 4.8.4, 3.10.0 <= version <= 3.22.3

**利用条件:** 需要Camel应用通过HTTP暴露endpoint，且使用了受影响的组件，如camel-servlet, camel-jetty, camel-undertow, camel-platform-http, 和 camel-netty-http等。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-27636 是 Apache Camel 中的一个 Header 注入漏洞，允许攻击者通过发送特制的 HTTP 请求，绕过默认的 Header 过滤器，注入恶意 Camel 特定的 Header，进而利用 `camel-exec` 等组件执行任意代码。 

**漏洞分析：**

Apache Camel 的 `DefaultHeaderFilterStrategy` 旨在阻止内部 Header 被外部用户控制，但存在 case-sensitive 的缺陷。 漏洞利用代码（README.md）展示了，可以通过改变 Header 名称的大小写来绕过过滤器，例如将 `CamelExecCommandExecutable` 更改为 `cAmeLexecCommandExecutable`。如果 Camel 应用使用了 `camel-exec` 组件，攻击者就可以通过注入 `cAmeLexecCommandExecutable` Header，执行任意系统命令。

**POC 有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，POC 代码是有效的。POC 代码给出了一个可以直接使用的例子，可以利用该漏洞执行 `whoami`、`uname -a` 等命令。

**投毒风险：**

漏洞利用代码是一个 GitHub 仓库，其中包含一个 README.md 文件和一个 pom.xml 文件，以及java代码。 主要目的是演示 CVE-2025-27636 漏洞的利用方法。 代码本身看起来是用于复现漏洞的，但仍存在一定的投毒风险。例如，作者可能在 java 代码中隐藏一些后门，比如反弹 shell 代码，或者搜集用户信息的代码。 pom.xml 文件中可能引入了恶意的依赖包。 因此，评估投毒风险为 10%。

**利用方式：**

1.  攻击者向存在漏洞的 Apache Camel 应用发送 HTTP 请求。
2.  在 HTTP 请求中，攻击者添加一个大小写混合的 Camel 特定的 Header，例如 `cAmeLexecCommandExecutable: <command>`。
3.  Camel 应用的 `DefaultHeaderFilterStrategy` 因为 case-sensitive 的缺陷，未能正确过滤该 Header。
4.  该 Header 被传递到 `camel-exec` 组件。
5.  `camel-exec` 组件执行 Header 中指定的命令，导致远程代码执行。

**缓解措施：**

1.  升级 Apache Camel 到已修复的版本。
2.  使用自定义的 `HeaderFilterStrategy`，确保 Header 过滤是 case-insensitive 的。
3.  避免将 `exec:` 路由直接暴露给 HTTP。

**项目地址:** [enochgitgamefied/CVE-2025-27636-Pratctical-Lab](https://github.com/enochgitgamefied/CVE-2025-27636-Pratctical-Lab)

**漏洞详情:** [CVE-2025-27636](https://nvd.nist.gov/vuln/detail/CVE-2025-27636)

---

