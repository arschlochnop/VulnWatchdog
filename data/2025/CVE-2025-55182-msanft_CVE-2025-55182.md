## CVE-2025-55182 - React Server Functions, Next.js RCE

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE

**影响应用:** React Server Functions, Next.js

**危害等级:** Critical

**CVSS评分:** 未提供，根据漏洞类型和影响，预估为9.0以上

**影响版本:** 受影响版本范围未知，参考commit[^3]之前的版本

**利用条件:** 需要网络访问，可能需要一定的React/Next.js应用交互

**POC 可用性:** 8/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 40%

## 详情

CVE-2025-55182 允许在 React Server Functions 中执行远程代码，该漏洞源于 React Flight Protocol 在反序列化过程中对用户输入验证不足。攻击者可以利用不安全的 prototype 引用来访问和修改对象的原型链，最终导致任意代码执行。

POC有效性分析：
POC 代码提供了一个概念验证，展示了如何利用该漏洞来获取 Function 构造器。攻击者可以通过构造特制的 payload，利用 React Flight Protocol 的反序列化过程中的缺陷，访问对象的 `__proto__` 属性，从而获得对 Function 构造器的控制权。该 POC 通过发送包含特定格式数据的请求，触发原型链污染，导致服务器端执行恶意代码。具体来说，攻击者可以将 `then` 键设置为 Function 构造器，从而在 Next.js 的 `decodeReplyFromBusboy` 函数中执行任意代码。

利用步骤：
1. 攻击者构造包含恶意 payload 的 HTTP 请求，利用 React Flight Protocol 将 payload 发送到服务器。
2. 服务器端在反序列化 payload 时，由于缺少对用户输入的验证，允许访问对象的 `__proto__` 属性。
3. 攻击者利用原型链污染，将 Function 构造器注入到服务器端的上下文中。
4. Next.js 的 `decodeReplyFromBusboy` 函数在处理反序列化的数据时，会执行攻击者注入的 Function 构造器，从而实现任意代码执行。
5. 攻击者可以利用执行的任意代码来获取服务器的敏感信息、篡改数据或执行其他恶意操作。

投毒风险分析：
该漏洞的投毒风险较高。攻击者可以通过将恶意代码注入到 React 组件或 Next.js 应用中，诱使用户下载并安装受污染的应用程序。一旦用户安装了受污染的应用程序，攻击者就可以利用该漏洞在用户的设备上执行任意代码，从而窃取用户的个人信息、安装恶意软件或执行其他恶意操作。由于该漏洞涉及到原型链污染和任意代码执行，因此其潜在的危害非常大。例如，攻击者可以利用该漏洞来修改 JavaScript 标准库中的函数，从而影响所有使用该库的应用程序。此外，攻击者还可以利用该漏洞来执行供应链攻击，通过修改第三方依赖项来感染大量的应用程序。

由于POC使用了 `__proto__`，存在一定的风险，但整体代码逻辑清晰，主要依赖于React和Next.js的内部机制，未发现明显的外部恶意脚本或代码混淆。但是，如果攻击者成功利用该漏洞，则可能通过Function构造器执行恶意代码，从而实现持久化攻击或数据窃取。因此，该漏洞的投毒风险评估为中等。

**项目地址:** https://github.com/XionngYu/CVE-2025-55182

**漏洞详情:** N/A
