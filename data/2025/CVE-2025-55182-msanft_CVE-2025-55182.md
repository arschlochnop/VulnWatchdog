## CVE-2025-55182 - React Server Components, Next.js RCE

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE

**影响应用:** React Server Components, Next.js

**危害等级:** Critical

**CVSS评分:** 10

**影响版本:** Multiple versions affected, refer to vendor advisories for specific ranges.

**利用条件:** Unauthenticated, remote attacker can exploit by sending a specially crafted payload to a vulnerable React Server Function endpoint.

**POC 可用性:** 8/10

**POC 类型:** Proof of Concept

**攻击复杂度:** Low

**投毒风险:** 40%

## 详情

CVE-2025-55182 is a critical remote code execution (RCE) vulnerability affecting React Server Components and Next.js. The vulnerability stems from unsafe deserialization of user input within React Server Functions. An unauthenticated, remote attacker can exploit this vulnerability by sending a specially crafted payload to a vulnerable endpoint, leading to arbitrary code execution on the server. The root cause is the lack of proper validation of keys during reference resolving in the React Flight Protocol, specifically when traversing chunks. Prior to a fix, React didn't verify whether the requested key was actually set on the object during deserialization, allowing attackers to access the object prototype. This can be exploited to retrieve the Function constructor and subsequently execute arbitrary code. 

The provided Proof of Concept (PoC) demonstrates this vulnerability by crafting a payload that exploits the insecure prototype references. The PoC includes a Python script to generate the malicious payload and a detailed explanation of the vulnerability. The PoC works by sending chunks to the server via form data. These chunks contain references to each other, allowing the attacker to manipulate the deserialization process. The critical part of the payload is the exploitation of the `__proto__` property to gain access to the Function constructor. By setting the `then` key to the function constructor, the attacker can trigger the execution of arbitrary code when the returned object is awaited by Next.js. The PoC successfully demonstrates the vulnerability by triggering a SyntaxError due to the attempted execution of the Function constructor's string representation.

**Exploitation Steps:**

1.  Prepare the environment: Ensure a vulnerable version of React and Next.js is running.
2.  Craft the malicious payload: Use the provided Python script or manually create a payload similar to the example in the PoC.
3.  Send the payload to a vulnerable endpoint: Identify a React Server Function endpoint in the application.
4.  Trigger the vulnerability: Send the crafted payload to the endpoint. The server should execute the code specified in the payload.

**投毒风险分析:**
While the provided PoC focuses on demonstrating the RCE vulnerability, it also presents a moderate risk of code poisoning. The PoC leverages the Function constructor to achieve code execution. Attackers could potentially use this vulnerability to inject malicious code into the server's runtime environment. This injected code could be used for various malicious purposes, such as stealing sensitive data, compromising other systems on the network, or disrupting the application's functionality. The risk is moderate because the PoC itself does not contain explicitly malicious code, but the nature of the vulnerability allows for arbitrary code execution. The payload is not heavily obfuscated, but a real-world attack could involve more sophisticated techniques to hide the malicious intent. The PoC uses standard libraries, but the overall exploitation relies on a specific vulnerability in React's deserialization process, increasing the complexity for defenders to detect and prevent. Further analysis could assess the potential impact on dependent applications and the feasibility of privilege escalation following successful exploitation. The ability to retrieve and use the `Function` constructor makes it easier to load malicious code and evade detection.

**项目地址:** https://github.com/vulnwatchdog_ae5c515e77d33be2544e86ef94982728

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
