## CVE-2025-55182 - React Server Components (如Next.js) 不安全反序列化导致的远程代码执行(RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 不安全反序列化导致的远程代码执行(RCE)

**影响应用:** React Server Components (如Next.js)

**危害等级:** Critical

**CVSS评分:** 10.0

**影响版本:** 19.0 to 19.2.0

**利用条件:** 未经授权的网络访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2025-55182 存在于 React Server Components 中，允许未经身份验证的远程代码执行，这源于不安全的反序列化。该漏洞与 Next.js 的 CVE-2025-66478 相关联。攻击者可以利用 React Flight Protocol 序列化过程中原型链引用的不安全处理来执行任意代码。 

POC 有效性分析：
POC 代码通过构造恶意的序列化数据块，利用 React 在反序列化过程中对对象属性的验证不足，从而访问到对象的 `__proto__` 属性，进而访问到 `constructor` 属性，最终获得 Function 构造函数。通过 Function 构造函数，攻击者可以执行任意 JavaScript 代码。

利用步骤：
1. 构造包含恶意引用的数据块，例如：
```py
files = {
    "0": (None, '{"then":"$1:__proto__:constructor:constructor"}'),
    "1": (None, '{"x":1}'),
}
```
2. 将构造的数据块作为 form data 发送到服务器。
3. 服务器在反序列化过程中，会由于 `__proto__` 的访问，暴露出 Function 构造函数。
4. 通过 Function 构造函数，执行任意 JavaScript 代码，例如执行系统命令。

该漏洞的严重性在于，攻击者无需任何凭据即可利用此漏洞，从而完全控制受影响的服务器。

投毒风险分析：
该 POC 的投毒风险较低。虽然它允许执行任意代码，但其核心机制依赖于 React 本身的反序列化过程。POC 代码清晰，主要利用了 React Flight Protocol 的特性，没有使用任何混淆技术或恶意外部脚本。但是，攻击者可以修改 POC，使其在目标系统上执行恶意操作，例如安装后门或窃取敏感数据。因此，尽管漏洞本身不涉及投毒，但利用此漏洞的攻击可能包含投毒行为。 总体来看，该POC主要关注漏洞利用本身，没有明显的投毒企图，风险较低。

为了降低投毒风险，建议安全研究人员在分析和测试 POC 时，使用隔离环境，并监控任何潜在的恶意行为。

**项目地址:** https://github.com/0x7556/CVE-2025-59287

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
