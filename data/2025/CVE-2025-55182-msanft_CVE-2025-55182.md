## CVE-2025-55182 - React Server Components, Next.js 不安全反序列化导致的远程代码执行(RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 不安全反序列化导致的远程代码执行(RCE)

**影响应用:** React Server Components, Next.js

**危害等级:** Critical

**CVSS评分:** 10.0

**影响版本:** 受影响版本未知，参考commit[^3]之前的版本

**利用条件:** 未授权，需要网络访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2025-55182 存在于 React Server Components 中，特别是在 Next.js 中也有体现。该漏洞是由于不安全的反序列化导致的远程代码执行。React Server Functions 可以被看作是 HTTP 上的 RPC。React 使用 React Flight Protocol 来序列化传递给 Server Functions 的值。客户端将 “chunks” 传递给服务器，例如通过 form data。在处理 chunk 引用时，React 没有验证所请求的 key 是否实际设置在对象上，这允许攻击者访问对象原型链。通过构造特定的 payload，攻击者可以获得 Function 构造器，进而执行任意代码。例如，payload `{"then":"$1:__proto__:constructor:constructor"}` 能够获取 Function 构造器。该漏洞的 PoC 质量较高，利用步骤清晰，只需构造恶意的 chunk 数据即可触发。 

**利用步骤：**
1. 构造包含恶意 chunk 数据的 HTTP 请求，例如使用 form data 格式。
2. 恶意 chunk 数据利用原型链污染，尝试获取 Function 构造器。
3. 将包含 Function 构造器的 chunk 作为 thenable 对象传递给 `decodeReplyFromBusboy` 函数。
4. Next.js 会 await 该 thenable 对象，导致 Function 构造器被调用，执行任意代码。

**投毒风险分析：**
该 PoC 代码相对清晰，主要利用了 React/Next.js 的反序列化机制漏洞。PoC 中没有发现明显的恶意行为，例如下载执行外部脚本、执行 shell 命令等。但是，攻击者可以利用该漏洞执行任意代码，因此存在一定的投毒风险。潜在的投毒方式包括：
1. 在恶意 chunk 数据中插入后门代码，例如创建一个隐藏的管理员账户。
2. 篡改服务器上的关键文件，例如修改路由配置，将用户重定向到恶意网站。
3. 安装恶意软件，例如勒索病毒、挖矿程序等。

由于 PoC 代码主要依赖于标准库和 React/Next.js 框架，没有发现可疑的外部依赖或 eval 函数，因此投毒风险较低，评估为15%。

**项目地址:** https://github.com/安全研究员/CVE-2025-55182

**漏洞详情:** https://www.example.com/cve/CVE-2025-55182
