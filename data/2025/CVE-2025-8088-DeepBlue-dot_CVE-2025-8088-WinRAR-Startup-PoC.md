## CVE-2025-8088 - WinRAR 路径遍历/目录穿越/任意文件写入/任意代码执行

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历/目录穿越/任意文件写入/任意代码执行

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** CVSS v3.1 8.4

**影响版本:** WinRAR Windows版本 (包括RAR, UnRAR, 便携式UnRAR源代码及UnRAR.dll) v7.00 build 10 之前

**利用条件:** 需要用户解压特制恶意压缩包，无需认证，需要Windows NTFS文件系统支持

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

CVE-2025-8088是一个影响WinRAR软件的严重安全漏洞，攻击者可以通过巧妙利用Windows NTFS备用数据流（ADS）特性和路径遍历技术，绕过WinRAR的文件验证机制，从而将恶意文件释放至系统任意位置。该漏洞最危险的利用方式是将其释放到Windows启动文件夹（Startup folder），从而实现持久化和任意代码执行。ESET安全研究人员发现了此零日漏洞，并指出其CVSS v3.1评分高达8.4，威胁等级为高危。WinRAR的Windows版本以及其RAR、UnRAR、便携式UnRAR源代码及UnRAR.dll组件在v7.00 build 10之前的版本都受此漏洞影响。

**POC有效性分析:** 提供的POC（`CVE-2025-8088-WinRAR-Startup-Exploit`）是一个功能完整的概念验证利用工具，旨在演示如何通过CVE-2025-8088漏洞实现任意文件写入到Windows启动文件夹，进而达到持久化和自动执行恶意代码的目的。该POC采用Python 3.7+编写，要求在Windows操作系统上运行，并且目标系统需要支持NTFS文件系统以利用备用数据流（ADS）特性。它依赖于WinRAR的命令行工具`rar.exe`来创建特制的恶意RAR压缩包。POC的文档非常详尽，清晰地概述了漏洞原理、受影响版本、环境要求、安装步骤以及详细的使用方法和参数说明。它通过构造一个包含特定ADS名称的压缩文件，利用WinRAR解压时的路径遍历缺陷，使得恶意文件（由用户指定）能够被释放到非用户指定的目标路径，例如系统的启动文件夹。一旦用户解压这个恶意压缩包，且操作系统重新启动，位于启动文件夹的恶意载荷将自动执行，从而实现了任意代码执行。该POC的设计和说明表明其在技术上是可行的，并且能够有效地复现和利用CVE-2025-8088漏洞，达到其声明的任意代码执行和持久化目的。考虑到其详细的文档和描述的攻击机制，该POC的质量评估为9/10，表明其功能完整且易于使用。

**利用步骤:**
1. **环境准备:**
   * 确保操作系统为Windows，且文件系统为NTFS。
   * 安装Python 3.7或更高版本。
   * 安装WinRAR软件，并确保`rar.exe`在系统PATH中，或者在运行POC时手动指定其路径。
   * 克隆POC代码库：`git clone https://github.com/your-username/CVE-2025-8088-WinRAR-Startup-Exploit.git`
   * 进入POC目录：`cd CVE-2025-8088-WinRAR-Startup-Exploit`
2. **准备诱饵文件和载荷文件:**
   * 准备一个`decoy.txt`（或任意名称的诱饵文件，例如PDF文档），用于迷惑受害者。
   * 准备一个`payload.bat`（或任意可执行脚本/程序），这是攻击者希望在目标系统上执行的恶意载荷。
   * 如果文件不存在，POC脚本将自动创建占位文件。
3. **生成恶意压缩包:**
   * 使用以下命令运行POC脚本，生成恶意RAR压缩包：
     `python cve-2025-8088-poc.py --decoy document.txt --payload script.bat`
   * 可以通过 `--rar`, `--out`, `--workdir`, `--placeholder_len` 等参数自定义输出和行为。
     例如：`python cve-2025-8088-poc.py --decoy "Important Document.pdf" --payload "payload.bat" --rar "C:\Program Files\WinRAR\rar.exe" --out "malicious_archive.rar"`
4. **传播和诱导:**
   * 将生成的`malicious_archive.rar`发送给目标受害者，通常通过鱼叉式钓鱼邮件，并附带具有吸引力的地缘政治相关诱饵（如搜索结果1和3所示，攻击者利用定制化的诱饵）。
5. **受害者操作:**
   * 受害者下载并使用受影响版本的WinRAR解压此恶意压缩包。
6. **执行:**
   * 由于路径遍历漏洞，`payload.bat`会被释放到Windows启动文件夹。
   * 当受害者下次重启电脑时，`payload.bat`将自动执行，从而实现攻击者的任意代码执行。

**投毒风险分析:** 对所提供的POC代码（基于`README.md`的描述）进行投毒风险评估，结果为低风险（5%）。此评估主要基于以下几点：
1. **明确的声明:** POC的`README.md`明确指出该工具仅用于教育和研究目的，并强调作者不对任何滥用负责。这表明其意图是透明和防御性的。
2. **代码行为透明:** POC描述了其核心功能是创建特制的恶意RAR压缩包。它要求用户提供`decoy`文件和`payload`文件，这意味着恶意内容本身由用户控制，POC脚本本身并非恶意代码。
3. **依赖标准工具和库:** POC依赖于Python 3.7+和WinRAR的命令行工具`rar.exe`，这些都是标准的、经过广泛验证的软件。`README.md`中没有提及任何异常的第三方库、外部网络请求或二进制文件，这降低了隐藏恶意功能的可能性。
4. **无代码混淆迹象:** 从`README.md`的描述来看，POC脚本的逻辑是清晰的，没有提到代码混淆或其他旨在隐藏其真实意图的技术。
5. **防御性研究目的:** 鉴于该漏洞已被APT组织广泛利用（如UNC4895/RomCom、APT44、Turla），发布此类POC对于安全研究人员、防御团队和IT管理员及时理解漏洞机制、测试防御措施和进行应急响应至关重要。将POC验证的后门代码（即用户自定义的`payload.bat`）视为POC自身的投毒代码是错误的。POC的目的是生成一个攻击样本，而非自身携带攻击性。
综合来看，该POC在披露的信息范围内，没有表现出超出其研究目的的任何恶意行为或隐蔽功能，因此被评定为低投毒风险。使用者应自行核查下载的完整POC代码，以确保其与`README.md`描述一致，并避免执行来源不明的二进制文件。

**项目地址:** https://github.com/your-username/CVE-2025-8088-WinRAR-Startup-Exploit.git

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8088
