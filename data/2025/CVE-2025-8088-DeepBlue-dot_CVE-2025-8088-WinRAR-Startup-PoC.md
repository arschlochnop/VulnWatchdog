## CVE-2025-8088 - WinRAR 路径遍历 / 任意文件写入

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历 / 任意文件写入

**影响应用:** WinRAR

**危害等级:** 严重 (Critical)

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**影响版本:** WinRAR 7.00 (build 10) 之前的版本 (包括 7.12 及以下版本)

**利用条件:** 用户需要下载并使用受影响版本的 WinRAR 解压经过特殊构造的恶意 RAR 压缩文件；系统需使用 NTFS 文件系统以支持 ADS 特性。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞是 WinRAR 在处理 Windows NTFS 备用数据流（Alternate Data Streams, ADS）时的路径遍历缺陷。根据公开的 POC 代码分析，攻击者通过在 RAR 压缩包中构造特殊的 ADS 文件名，可以绕过 WinRAR 的安全检查。POC 核心原理是利用 ADS 的占位符特性，在解压过程中通过路径遍历符号（../）将恶意负载（如 .bat 或 .exe 脚本）写入到用户的 Windows 启动文件夹（Startup folder）或其他关键系统目录中。此 POC 展示了高度的自动化能力，只需提供诱饵文件和 Payload 即可生成恶意压缩包。由于 WinRAR 处理 ADS 的逻辑在受影响版本中未对遍历字符进行充分过滤，该 POC 具有极高的实战转化率，能够稳定在 Windows 平台上实现持久化控制。相比于之前的 CVE-2025-6218，该漏洞利用了 ADS 的隐蔽性，使得传统的基于文件名的安全扫描更难发现其恶意意图。【利用步骤】1. 环境准备：安装 Python 3.7+ 及受影响版本的 WinRAR（用于打包或测试环境）。2. 准备载荷：创建一个诱饵文档（如 document.txt）和一个恶意脚本（如 payload.bat）。3. 执行脚本：运行 POC 脚本，指定诱饵文件和 Payload。脚本会自动计算 ADS 占位符长度。4. 生成文件：脚本将调用 rar.exe 生成名为 cve-2025-8088-startup-poc.rar 的恶意压缩包。5. 攻击实施：将该压缩包发送给目标用户。用户一旦右键解压，payload.bat 就会被静默写入到用户的启动文件夹中。6. 权限维持：目标用户下次登录 Windows 时，恶意脚本将自动运行。【投毒风险分析】该 POC 来源于 GitHub 仓库副本，其主要风险点在于其对底层 rar.exe 的调用过程。虽然 POC 代码逻辑清晰，主要使用 Python 标准库进行文件流操作，但存在被攻击者二次修改的风险。在防御性研究中，风险主要体现在：1. 供应链投毒：攻击者可能在公开的 POC 仓库中植入隐蔽的后门，例如在 cve-2025-8088-poc.py 的参数处理逻辑中加入远程下载恶意指令的 base64 编码字符串，研究员在生成测试用例时可能导致自身环境中毒。2. 恶意载荷混淆：某些变种 POC 可能会预置一个看似无害但实际上具有窃密功能的 payload.bat 作为默认选项。3. 依赖项污染：若 POC 要求安装非标准第三方库，可能存在依赖项劫持。当前分析的 POC 代码结构符合安全研究规范，代码透明度高，未发现明显的恶意行为或代码混淆，属于低投毒风险范畴，但建议在隔离的沙盒环境中运行。研究人员应重点关注生成的 .rar 文件内部结构，而非仅仅依赖自动化脚本。

**项目地址:** [https://github.com/your-username/CVE-2025-8088-WinRAR-Startup-Exploit](https://www.google.com/search?q=https://github.com/your-username/CVE-2025-8088-WinRAR-Startup-Exploit)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-8088](https://avd.aliyun.com/detail?id=AVD-2025-8088)
