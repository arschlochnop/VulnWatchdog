## CVE-2025-30208 - Vite 任意文件读取

**漏洞编号:** CVE-2025-30208

**漏洞类型:** 任意文件读取

**影响应用:** Vite

**危害等级:** 高危

**CVSS评分:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N

**影响版本:** < 6.2.3, < 6.1.2, < 6.0.12, < 5.4.15, < 4.5.10

**利用条件:** Vite开发服务器处于运行状态，且通过 --host 或 server.host 配置显式暴露在网络中。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：该漏洞源于Vite开发服务器在处理静态资源请求时的路径解析逻辑缺陷。Vite使用 `@fs` 路径前缀来访问本地文件系统，并设有白名单限制。然而，由于内部在规范化URL时会移除末尾的分隔符（如问号），但在匹配查询字符串的正则表达式时未能正确处理此类多重分隔符，导致攻击者可以通过构造 `/@fs/etc/passwd?raw??` 或 `/@fs/C:/windows/win.ini?import&raw??` 这种特殊URL绕过安全边界。POC代码基于Python开发，逻辑清晰且经过实测验证，通过 requests 库向目标发送带有 ?raw 后缀的路径请求。如果服务器返回 200 状态码并包含文件内容，则证明漏洞存在。利用步骤：1. 识别并确定目标使用了受影响版本的 Vite 开发模式（通常端口为 5173）。2. 确认目标配置了 `--host` 允许外部访问。3. 使用 POC 工具输入目标 URL 及尝试读取的敏感文件路径（如 /etc/passwd）。4. 工具构造恶意 URL 并发送 GET 请求。5. 接收服务器返回的原始文件流。投毒风险分析：该 POC 代码（CVE-2025-30208.py）由已知安全研究员 4m3rr0r 提供，整体结构透明，主要使用标准库如 argparse 和第三方成熟库 requests、colorama。代码中不存在恶意混淆、未授权的外部域名回连（C2）、执行二进制文件或篡改本地系统文件的逻辑。唯一的敏感操作是读取服务器端文件，这是漏洞验证的核心功能。通过代码审计，未发现 eval()、os.system() 等高风险函数调用，亦无恶意的 base64 加密负载。代码中的 SSL 告警忽略属于安全扫描器的常规配置，不构成投毒风险。虽然该工具在自动化扫描场景下具有攻击性，但从代码分发角度看，属于低风险的安全研究工具。建议使用者在隔离环境或授权范围内使用，并从官方来源下载。

**项目地址:** [https://github.com/ThumpBo/CVE-2025-30208-EXP](https://github.com/ThumpBo/CVE-2025-30208-EXP)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-30208](https://nvd.nist.gov/vuln/detail/CVE-2025-30208)
