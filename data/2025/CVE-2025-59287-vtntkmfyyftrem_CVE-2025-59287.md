## CVE-2025-59287 - Microsoft Windows Server Update Service (WSUS) RCE (反序列化漏洞)

**漏洞编号:** CVE-2025-59287

**漏洞类型:** RCE (反序列化漏洞)

**影响应用:** Microsoft Windows Server Update Service (WSUS)

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Windows Server 2012, 2016, 2019, 2022, 2025

**利用条件:** 无需身份验证，可通过网络访问WSUS Web端点（通常为8530/8531/8533端口）

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 45%

## 详情

【POC有效性分析】该POC针对WSUS组件中处理SOAP请求时的不安全反序列化漏洞。根据代码结构分析，poc_quality被评为8/10，因为它提供了较为完整的攻击链实现：首先通过`encrypt.py`对恶意的.NET BinaryFormatter载荷进行加密封装，模拟WSUS预期的加密数据格式；随后通过`exp.py`构建特制的SOAP消息，利用WSUS在处理事件上报或同步逻辑时的漏洞，将载荷注入到反序列化执行流中。该POC具有较高的实战价值，因为它不需要目标系统的预验证凭据，且利用过程相对直接，只要WSUS服务暴露在网络中即可被触发。代码中使用了标准的SOAP结构和常见的.NET反序列化利用链（如YSOSERIAL生成的载荷），证明其在技术逻辑上是闭环且有效的。利用步骤如下：1. 环境准备：安装Python 3.4+。2. 载荷生成：使用.NET序列化工具生成针对BinaryFormatter的Base64编码载荷。3. 载荷配置：将载荷填入payload.txt或直接修改exp.py源码。4. 执行攻击：运行python exp.py指向目标WSUS服务器URL。执行成功后，载荷将在目标系统以SYSTEM权限运行。 【投毒风险分析】此POC项目的投毒风险被评估为45%。主要风险点在于其分发方式和部分受限的代码逻辑。首先，README中提到了‘DMG文件’供macOS用户使用，这对于一个针对Windows Server漏洞的Python POC来说极其反常。在安全研究领域，分发二进制文件（如DMG或EXE）是常见的投毒手段，攻击者往往在二进制文件中植入木马以反向控制安全研究员的机器。其次，代码片段中出现了对`subprocess`的使用以及对十六进制密钥的复杂处理，虽然在漏洞利用中这可能是为了加密，但也可能被用于隐藏恶意的Shellcode执行。代码中提到的`encrypt.py`部分逻辑被截断，无法完全确认其是否存在后门连接。此外，该项目刻意强调‘教育用途’但又引导下载不明二进制文件，具有典型的社会工程学诱导特征。防御者在分析此POC时，应严格限制在隔离的沙箱环境运行，切勿下载运行其提供的任何编译后程序或二进制安装包，重点应放在其构造的SOAP Payload特征上，以编写对应的IDS/IPS规则。

**项目地址:** /tmp/vulnwatchdog_50f837b66f0708d0dee88fb505f23276/

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)
