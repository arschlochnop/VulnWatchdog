## CVE-2025-27591 - below (Facebook performance monitoring tool) 本地权限提升 (Privilege Escalation)

**漏洞编号:** CVE-2025-27591

**漏洞类型:** 本地权限提升 (Privilege Escalation)

**影响应用:** below (Facebook performance monitoring tool)

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** < 0.9.0

**利用条件:** 1. 目标系统安装了 0.9.0 版本以下的 below 工具；2. 目录 /var/log/below 具有全局可写权限；3. 攻击者拥有本地低权限账户，且能够触发 sudo below record 命令执行。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

【POC有效性分析】：此POC代码针对的是Facebook开发的开源性能监控工具below。该漏洞的根源在于该服务在初始化或运行过程中，错误地将日志目录/var/log/below设置为全局可写（World-writable）。POC利用了Linux系统中的符号链接（Symlink）竞争机制。由于该工具在写入日志文件（如error_root.log）之前未进行严格的所有权检查，低权限攻击者可以在该目录下预先创建一个指向敏感文件（如/etc/passwd）的符号链接。当特权进程（如通过sudo运行的below）尝试向该日志文件写入数据时，实际上会将受控的内容写入到/etc/passwd中。POC通过构造一行具有root权限且无密码的伪造用户信息（fakeadmin::0:0:fakeadmin:/root:/bin/bash），利用below的日志写入逻辑将其强行注入到系统密码文件中。经过分析，该POC逻辑清晰，直接利用了经典的文件系统竞态和权限配置错误，在满足环境条件下具有极高的执行成功率。其包含自动化的清理和权限切换步骤，是一份高质量的防御性研究样本。【利用步骤】：1. 检查目标系统是否存在 /var/log/below 目录及其权限；2. 在该目录下创建一个名为 error_root.log 的符号链接，指向 /etc/passwd；3. 准备构造好的 root 用户 Payload 字符串；4. 触发 sudo below record 命令，该操作通常由系统管理员或计划任务执行，导致 below 以 root 权限将日志内容（含 Payload）写入符号链接目标；5. 使用 su fakeadmin 命令直接切换至 root 账户，无需密码；6. 进入系统后清理 /etc/passwd 中的恶意条目以隐藏痕迹。【投毒风险分析】：该POC托管于GitHub公开仓库，主要由Bash脚本组成。经过静态代码审计，脚本内容透明，仅使用了ln、sudo、su、timeout等标准系统命令。脚本的主要逻辑集中在符号链接的创建和Payload的拼接，未发现经过混淆的十六进制编码或Base64加密字符串。代码中没有出现通过curl或wget请求外部恶意域名的行为，亦无隐藏的后门持久化指令。唯一的风险点在于攻击者可能会将此脚本重新打包并在非官方渠道传播，加入窃取本地SSH密钥或环境变量的逻辑。目前该特定GitHub项目（BridgerAlderson/CVE-2025-27591-PoC）表现为纯粹的技术验证，投毒风险极低，属于安全的防御性研究范畴。但鉴于其提权效果立竿见影，建议安全团队在沙箱环境中进行测试，并重点监控/var/log目录下的符号链接创建行为。

**项目地址:** [https://github.com/BridgerAlderson/CVE-2025-27591-PoC](https://github.com/BridgerAlderson/CVE-2025-27591-PoC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-27591](https://nvd.nist.gov/vuln/detail/CVE-2025-27591)
