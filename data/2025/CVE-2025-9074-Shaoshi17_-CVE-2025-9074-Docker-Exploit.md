## CVE-2025-9074 - Docker Desktop for Windows / macOS SSRF/未授权访问/容器逃逸

**漏洞编号:** CVE-2025-9074

**漏洞类型:** SSRF/未授权访问/容器逃逸

**影响应用:** Docker Desktop for Windows / macOS

**危害等级:** 致命 (Critical)

**CVSS评分:** 9.3

**影响版本:** Docker Desktop < 4.44.3

**利用条件:** 攻击者可以访问受害主机的特定内网IP（通常为 192.168.65.7）上的 Docker Engine API 端口（2375）

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞源于 Windows 和 macOS 版 Docker Desktop 的 Docker Engine HTTP API 配置不当，默认暴露在 192.168.65.7:2375。由于该接口缺乏认证机制，任何能够与该内部地址通信的进程或处于同一网络环境的攻击者，都可以通过发送标准的 Docker API 请求来完全控制 Docker 服务。提供的 Python 代码片段显示了其具备获取容器列表、执行任意命令、规范化 Windows 路径并挂载宿主机文件系统的能力。这种利用方式极为直接且有效，因为它直接调用了 Docker 的原生管理功能。通过将宿主机的根目录（如 C:\）挂载到新容器中，攻击者可以实现完全的容器逃逸，进而控制整个 Windows 宿主机系统。此 POC 代码逻辑清晰，使用了标准的 requests 和 json 库，具备高度的可执行性。利用步骤：1. 扫描内网环境，定位 Docker Desktop 默认的 API 监听地址 192.168.65.7。2. 通过 API 获取当前运行的容器列表及镜像信息。3. 构造请求在现有容器中执行恶意命令，或创建一个带有高权限配置（如 privileged 或 挂载宿主机路径）的新容器。4. 通过挂载的宿主机路径（例如映射 C:/ 到容器内的 /mnt/host/c）读写宿主机敏感文件。5. 利用计划任务、服务替换或 SSH 密钥植入实现持久化。投毒风险分析：经过对 POC 源代码的防御性审查，该脚本主要包含的是 Docker API 的交互逻辑，如 normalize_host_path 函数用于处理 Windows 与 Linux 容器之间的路径映射，属于典型的渗透测试工具逻辑。代码中使用了常见的 python 库（requests, json, socket），目前未发现明显的混淆、恶意二进制静默下载或针对执行环境的破坏性行为。然而，由于该脚本涉及到敏感的 Docker API 操作，防御者在运行此类脚本时仍需谨慎。潜在的投毒风险点在于：脚本可能会将采集到的容器敏感元数据（如环境变量、挂载点信息）异步外传至攻击者控制的 C2 服务器。尽管当前片段未展示此类行为，但建议在隔离的沙箱环境中进行复现，并使用流量监控工具检查是否存在非 192.168.65.7 的异常外发请求。总体而言，该 POC 的代码风格偏向于技术研究与复现，投毒风险较低，属于中低风险等级。

**项目地址:** [https://github.com/zenzue/CVE-2025-9074](https://www.google.com/search?q=https://github.com/zenzue/CVE-2025-9074)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-9074](https://nvd.nist.gov/vuln/detail/CVE-2025-9074)
