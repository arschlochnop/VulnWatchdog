## CVE-2025-48384 - Git 任意文件写入

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 任意文件写入

**影响应用:** Git

**危害等级:** 高危

**CVSS评分:** 未提供，参考描述推测较高

**影响版本:** 受影响版本范围未知，需进一步分析

**利用条件:** 克隆包含恶意配置的Git仓库

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 70%

## 详情

CVE-2025-48384 允许攻击者通过创建包含恶意配置的 Git 仓库，在受害者系统上写入任意文件，导致远程命令执行。该漏洞源于 Git 在处理 submodule 时，未对 `.gitmodules` 文件中的配置进行充分的安全检查。攻击者可以精心构造 `.gitmodules` 文件，诱导受害者克隆该仓库，从而在受害者本地文件系统中写入恶意文件，例如 shell 脚本，并进一步通过 Git hooks（如 `post-checkout`）触发执行。PoC 代码 `liamg/CVE-2025-48384` 提供了一个可复现该漏洞的示例。通过分析该 PoC，可以确认漏洞的有效性。利用步骤如下：

1. 攻击者创建一个包含恶意 `.gitmodules` 文件的 Git 仓库。
2. `.gitmodules` 文件包含指向攻击者控制的恶意 submodule 仓库的 URL。
3. 受害者克隆该恶意仓库。
4. Git 自动初始化并更新 submodule，从攻击者控制的 URL 下载恶意 submodule。
5. 恶意 submodule 在受害者系统上写入任意文件，例如在 `.git/hooks/post-checkout` 中写入恶意脚本。
6. 当受害者执行 `git checkout` 等操作时，`post-checkout` hook 会被触发，执行恶意脚本，导致远程命令执行。

`sogou.com`的搜索结果显示该漏洞影响非Windows系统。`Arctic Wolf` 的结果表明该漏洞的严重性很高。`Breaking Git with a carriage return and cloning RCE`表明漏洞与克隆子模块有关。

**投毒风险分析：**

该 PoC 包含通过 `curl` 下载并执行远程脚本的行为，具有较高的投毒风险。攻击者可能在远程脚本中嵌入恶意代码，例如窃取用户敏感信息、植入后门等。此外，由于该 PoC 修改了 Git 仓库的配置文件，攻击者可以通过篡改配置文件，诱导用户执行恶意操作。考虑到 `curl` 命令的普遍性和脚本执行的隐蔽性，该 PoC 的投毒风险较高，评为 70%。

防范措施包括：

* 及时更新 Git 版本，修复该漏洞。
* 谨慎克隆来自未知来源的 Git 仓库。
* 审查 `.gitmodules` 文件，确保 submodule URL 指向可信的仓库。
* 禁用 Git hooks，或者对 Git hooks 进行严格的安全审查。

**项目地址:** https://github.com/liamg/CVE-2025-48384

**漏洞详情:** 未提供，需要查询NVD
