# CVE-2025-21333

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21333-160102_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-160102_CVE-2025-21333-POC.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致权限提升

**影响版本:** 受影响的Windows版本包括Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等。

**利用条件:** 需要本地访问，在Hyper-V环境中。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP（Virtual Service Provider）权限提升漏洞。根据漏洞信息和搜索结果，该漏洞存在于Hyper-V的NT内核集成组件中，允许攻击者提升权限。漏洞利用代码显示这是一个C++项目，利用了WNF（Windows Notification Facility）状态数据和I/O ring IOP_MC_BUFFER_ENTRY来触发堆缓冲区溢出。该POC的Visual Studio解决方案文件表明它是一个可编译的项目，但存在投毒风险，因为从github下载zip存在未知风险。从代码来看，大量使用了Windows API，直接与内核交互，存在恶意修改内核的可能性，投毒风险评估为20%。利用方式通常包括：

1.  **触发漏洞：** 通过精心构造的WNF状态数据和I/O ring操作，触发NT内核集成组件中的堆缓冲区溢出。
2.  **控制执行流：** 覆盖堆上的关键数据结构，以控制内核的执行流程。
3.  **权限提升：** 通过修改当前进程的Token，将其权限提升到SYSTEM级别。

从搜索结果来看，该漏洞已经被CISA列入已知被利用漏洞目录，表明该漏洞具有较高的实际威胁。

**有效性评估：** 根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的，因为存在可编译的POC，并且CISA已经确认该漏洞被利用。

**投毒风险评估：** 该POC代码存在一定的投毒风险。因为需要下载压缩包，压缩包内部可能包含恶意代码，但主要代码是利用windows api进行操作，函数功能明确，没有发现明显的恶意行为，风险较低。


**项目地址:** [160102/CVE-2025-21333-POC](https://github.com/160102/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #2

**来源**: [CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md](../2025/CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 提权漏洞/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机逃逸，主机权限获取

**影响版本:** 受影响的Windows版本 (见漏洞库信息)

**利用条件:** 需要Guest虚拟机权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (虚拟机服务提供者) 中的提权漏洞，本质是堆溢出。攻击者（虚拟机内的用户）可以利用此漏洞，通过特制的请求导致在主机操作系统内核中发生堆缓冲区溢出，从而获得主机操作系统的管理员权限。

**有效性：**

根据搜索引擎结果，此漏洞已经被公开披露，并且存在公开可用的PoC（例如 GitHub上的`MrAle98/CVE-2025-21333-POC`仓库），表明该漏洞的利用已经得到验证。 漏洞库信息也表明CISA ADP已经将此漏洞添加到已知被利用漏洞列表中，进一步证明了其有效性。

提供的漏洞利用代码`/tmp/32315364bfebb19c9bcece1aca1942c9/README.md` 仅包含CVE编号的信息，本身并没有可执行的利用代码。但是，结合搜索引擎结果，可以找到其他存储库中提供的PoC 代码。

**投毒风险：**

由于提供的代码只是一个包含CVE编号的`README.md`文件，因此直接分析该文件进行投毒判断没有意义。真正的PoC代码位于其他存储库。但是，在实际利用PoC的过程中，需要仔细审查代码，因为PoC代码可能包含恶意修改。 

假设用户下载并执行了某个声称是CVE-2025-21333的PoC代码。 评估投毒风险。鉴于漏洞利用开发和安全研究的复杂性，有以下可能性：

*   **有意后门：** 某些代码作者可能会故意在PoC中添加后门，以便进一步攻击或控制目标系统。风险较高，因为内核漏洞利用通常需要精心的内存操作，很容易隐藏恶意代码。
*   **代码质量问题：** PoC代码可能未经充分测试或包含错误，导致系统崩溃或不稳定。这虽然不是直接的投毒，但也可能对系统造成损害。
*   **依赖项风险：** PoC可能依赖于外部库或组件，这些库或组件本身可能存在漏洞或恶意代码。

考虑到这些因素，初步估计投毒风险为10%。更详细的代码审计可以提供更准确的风险评估。

**利用方式：**

1.  **触发漏洞：** 虚拟机内的攻击者，通过构造恶意的请求发送给Hyper-V主机。
2.  **堆溢出：** 恶意的请求会触发 Hyper-V NT Kernel Integration VSP 组件中的堆缓冲区溢出。
3.  **控制流劫持：** 利用堆溢出覆盖关键内核数据结构，例如函数指针，从而控制内核执行流。
4.  **权限提升：** 执行恶意代码，例如调用`PsLookupProcessByProcessId`和`SeAssignPrivileges`等函数，以提升虚拟机内的进程权限到 SYSTEM。
5.  **虚拟机逃逸：** 利用获得的 SYSTEM 权限，攻击者可以执行虚拟机逃逸操作，例如访问Hyper-V主机的文件系统，甚至控制整个主机。


**项目地址:** [B1ack4sh/Blackash-CVE-2025-21333](https://github.com/B1ack4sh/Blackash-CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #3

**来源**: [CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致系统权限提升

**影响版本:** Windows 10 21H2 (<= 10.0.19044.5371), Windows 11 22H2 (<= 10.0.22621.4751), Windows 10 22H2 (<= 10.0.19045.5371), Windows Server 2025 (<= 10.0.26100.2894), Windows 11 23H2 (<= 10.0.22631.4751), Windows 11 24H2 (<= 10.0.26100.2894), Windows Server 23H2 (<= 10.0.25398.1369)

**利用条件:** 需要Guest OS环境, 并需要利用I/O Ring机制进行攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 的特权提升漏洞。该漏洞是由于内核驱动`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。 

**漏洞利用方式：**

1.  **I/O Ring机制：** PoC利用了Windows I/O Ring机制，通过伪造IOP_MC_BUFFER_ENTRY结构体，从而实现内核任意地址读写。
2.  **堆溢出：** 通过在分页池中分配大量内存，然后触发堆溢出，覆盖IOP_MC_BUFFER_ENTRY结构体指针。
3.  **任意读写：** 覆盖后的`Address`可以指向任意内核地址，从而实现任意地址读写。
4. **提权：** 通过任意读写能力，可以修改当前进程的Token，从而提升权限。

**有效性：**

根据提供的PoC代码和搜索结果，该漏洞PoC的存在，并且已经被CISA列入已知被利用漏洞目录。PoC代码的README描述了如何在Windows 11 23h2上利用此漏洞进行提权，同时也说明了该PoC的可靠性可能不高。

**投毒风险：**

PoC代码本身是一个Visual Studio解决方案，包含C++源代码。 代码主要功能是利用堆溢出和I/O Ring机制实现内核任意地址读写，从而提升权限。审查代码后，发现潜在的投毒风险较低，例如：

*   **复杂性：** 代码相对复杂，阅读和理解需要一定的内核安全知识，增加了隐藏恶意代码的难度。
*   **公开性：** PoC本身是为了演示漏洞利用，作者倾向于公开透明，减少隐藏恶意代码的动机。
    但是，仍然存在一些微小的风险：
*   **细微修改：** 攻击者可能会在PoC代码中添加一些细微的修改，例如修改内存地址或增加延时，从而绕过安全检测。
*   **依赖项：** PoC可能依赖一些外部库或驱动，这些依赖项可能存在安全风险。

综上所述，该PoC代码存在10%的投毒风险，主要是考虑到细微修改和依赖项的潜在风险。


**项目地址:** [MrAle98/CVE-2025-21333-POC](https://github.com/MrAle98/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #4

**来源**: [CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致SYSTEM权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2 等受影响版本

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (Virtual Service Provider) 中的权限提升漏洞。该漏洞是由于 NT 内核集成 VSP 中存在堆缓冲区溢出造成的，攻击者可以利用此漏洞获得 SYSTEM 权限。

**有效性评估：**

根据漏洞描述和搜索结果，该漏洞是一个已知的、存在被利用的漏洞，CISA 已将其添加到已知被利用的漏洞目录中。 Reddit的帖子也表明有人发布了POC。提供的POC代码是一个Visual Studio解决方案，包含C++源代码，这进一步表明该漏洞是可以被利用的。readme描述利用了WNF state data 和 I/O ring IOP_MC_BUFFER_ENTRY，指向了具体利用的技术细节。

**投毒风险评估：**

评估POC代码的投毒风险需要仔细分析代码。从提供的代码片段来看，代码主要涉及Windows API调用，包括内存操作、对象操作、线程管理和进程管理等。初步分析没有发现明显的恶意代码或后门。但是考虑到漏洞利用代码本身的复杂性以及缺乏完整代码，存在一定的投毒风险，例如：

*   **隐蔽的权限提升：** 代码可能包含不易察觉的后门，在提权后执行恶意操作，例如安装恶意软件或收集敏感信息。
*   **代码注入：** 恶意代码可能会注入到其他进程中，从而绕过安全检测。
* **依赖风险:** readme中的链接可能指向恶意网站或包含恶意软件的下载链接。

虽然不能完全排除投毒的可能性，考虑到漏洞利用的复杂性，作者隐藏恶意代码的概率较低，因此暂定投毒风险为10%。

**利用方式分析：**

1.  **漏洞触发：** 攻击者利用Hyper-V NT Kernel Integration VSP中的漏洞，该漏洞位于内核态驱动中，允许从虚拟机内部触发。
2.  **堆溢出：** 利用特定的输入或操作，触发堆缓冲区溢出，覆盖相邻的内存区域。搜索结果表明是Paged Pool中的heap-based buffer overflow
3.  **权限提升：** 通过控制溢出的内容，例如覆盖内核对象或函数指针，攻击者可以将自己的权限提升到SYSTEM。
4.  **执行恶意代码：** 获得SYSTEM权限后，攻击者可以执行任意代码，例如安装恶意软件、窃取数据或控制系统。

**项目地址:** [Mukesh-blend/CVE-2025-21333-POC](https://github.com/Mukesh-blend/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #5

**来源**: [CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机数据泄露、完整性破坏和拒绝服务

**影响版本:** Windows 10 21H2 (版本 10.0.19043.0 到 10.0.19044.5371), Windows 11 22H2 (版本 10.0.22621.0 到 10.0.22621.4751), Windows 10 22H2 (版本 10.0.19045.0 到 10.0.19045.5371), Windows Server 2025 (版本 10.0.26100.0 到 10.0.26100.2894), Windows 11 23H2 (版本 10.0.22631.0 到 10.0.22631.4751), Windows Server 23H2 (版本 10.0.25398.0 到 10.0.25398.1369), Windows 11 24H2 (版本 10.0.26100.0 到 10.0.26100.2894)

**利用条件:** 本地用户权限，需要启用并运行Hyper-V。

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞。根据漏洞描述和搜索结果，攻击者可以利用恶意构造的 Virtual Service Provider (VSP) 来提升权限，最终控制 Hyper-V 主机。这是一个堆溢出漏洞（CWE-122）。

**有效性：**
提供的 POC 代码是一个 Visual Studio 解决方案，包含 C++ 代码。代码中包含Windows头文件，如 `<Windows.h>`, `<ioringapi.h>`和自定义头文件`wnf.h`。通过检查代码，可以发现其中利用了Windows Notification Facility（WNF）状态数据和I/O ring IOP_MC_BUFFER_ENTRY。搜索结果中reddit论坛的帖子也说明这是一个windows内核堆溢出漏洞，并提供了github链接。

**投毒风险：**
提供的代码片段中，最可疑的部分是 `README.md` 文件中提供的下载链接：`[Download Exploit](https://github.com/file/Soft.zip)`。该链接指向一个名为 `Soft.zip` 的 ZIP 文件，从不可信来源下载未经验证的可执行文件具有极高的风险。虽然直接提供的C++代码本身看起来是标准漏洞利用代码，但`README.md`文件中的下载链接是潜在的恶意软件投放点。用户可能被诱导下载包含恶意payload的zip文件，而非真正的漏洞利用程序。因此，存在较高的投毒风险。
另外，`wnf.h`等自定义头文件没有提供，意味着使用者必须自己查找或编写相关代码，这增加了利用难度，也为潜在的投毒留下了空间。攻击者可以提供带有恶意代码的`wnf.h`文件，诱导用户使用。
总体来说，投毒风险较高，估计为80%。

**利用方式：**
1.  **触发漏洞:** 利用特制的 VSP 触发 Hyper-V NT Kernel Integration 中的堆溢出。
2.  **WNF状态数据操控:** 通过操纵WNF状态数据，控制内核内存的布局。
3. **I/O ring IOP_MC_BUFFER_ENTRY：** 通过操控I/O环，控制内核内存的读写。
4.  **权限提升:** 覆盖关键内核数据结构，例如当前进程的 Token，将其替换为 SYSTEM 用户的 Token，从而提升权限。

**项目地址:** [SerabiLem/CVE-2025-21333-POC](https://github.com/SerabiLem/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #6

**来源**: [CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md](../2025/CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，本地攻击者可利用该漏洞获得SYSTEM权限

**影响版本:** Windows 10 21H2 (versionStartIncluding: 10.0.19043.0, versionEndExcluding: 10.0.19044.5371), Windows 11 22H2 (versionStartIncluding: 10.0.22621.0, versionEndExcluding: 10.0.22621.4751), Windows 10 22H2 (versionStartIncluding: 10.0.19045.0, versionEndExcluding: 10.0.19045.5371), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows Server 23H2 (versionStartIncluding: 10.0.25398.0, versionEndExcluding: 10.0.25398.1369), Windows 11 24H2 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894)

**利用条件:** 本地访问，需要运行受影响的Windows Hyper-V。

**POC 可用性:** 是，根据搜索结果，存在可用的POC代码

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 特权提升漏洞。该漏洞是由于`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。攻击者可以利用此漏洞在本地获得 SYSTEM 权限。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞影响多个Windows版本，并且CISA已将其列入已知被利用的漏洞目录，表明该漏洞具有实际的利用价值。搜索引擎结果显示存在公开的POC代码，进一步佐证了漏洞的可利用性。

**投毒风险：** 提供的漏洞利用代码是 KQL 查询语句，用于检测与 CVE-2025-21333 相关的可疑活动。代码本身用于安全事件的监控和分析，而非直接的漏洞利用。因此，可以认为该代码的投毒风险较低，但也需要人工审查代码的逻辑，判断是否存在恶意隐藏。例如，代码中可能会被利用来误报，影响正常的安全事件分析，所以投毒风险为 10%。

**利用方式：**  攻击者可以利用该漏洞通过与Hyper-V的NT内核集成VSP相关的组件，触发堆缓冲区溢出，最终获得SYSTEM权限。具体来说，`vkrnlintvsp.sys` 组件在处理来自虚拟机的数据时，如果没有进行充分的边界检查，可能导致缓冲区溢出。根据搜索结果，漏洞存在于主机操作系统和容器类型虚拟机之间的通信组件中。攻击者需要在受影响的系统上执行恶意代码，触发溢出，从而提升权限。实际的利用可能涉及到内存地址的计算、shellcode的注入等技术。

 简而言之，这是一个本地提权漏洞，攻击者通过精心构造的数据包与Hyper-V的内核集成服务进行交互，导致内核堆缓冲区溢出，从而覆盖关键数据并获得SYSTEM权限。

**项目地址:** [aleongx/KQL_sentinel_CVE-2025-21333](https://github.com/aleongx/KQL_sentinel_CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #7

**来源**: [CVE-2025-21333-pradip022_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-pradip022_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V NT Kernel Integration VSP

**危害等级:** 高危，可提升权限

**影响版本:** 受影响的版本包括Windows 10 21H2，Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等，具体版本范围见CVE描述。

**利用条件:** 需要目标系统运行Hyper-V，且虚拟机集成服务（VSP）存在漏洞。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP的权限提升漏洞，这是一个堆溢出漏洞(CWE-122)。根据搜索结果，存在公开的POC代码，并且该漏洞已被积极利用。漏洞利用代码的README.md文件描述了如何下载和运行该POC，指出利用涉及WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY。代码库中提供的Visual Studio解决方案文件，进一步证实了漏洞利用的存在。虽然github仓库描述了POC的简单用法,但是下载地址却指向了另一个github地址,存在诱导下载其他恶意文件的可能性. 同时考虑到windows内核漏洞利用通常需要较高的技术水平，且可能涉及复杂的内存操作, 因此存在投毒风险，风险概率评估为30%。

利用方式：攻击者可以利用此漏洞在Hyper-V环境中提升权限。具体利用方式涉及构造特定的WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY，触发堆溢出，从而执行恶意代码。

**项目地址:** [pradip022/CVE-2025-21333-POC](https://github.com/pradip022/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #8

**来源**: [CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md](../2025/CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2。具体版本范围参考CVE详情。

**利用条件:** 需要Hyper-V环境，guest操作系统执行漏洞利用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP权限提升漏洞，是一个基于堆的缓冲区溢出(CWE-122)。

**有效性评估：**
根据搜索结果和提供的PoC代码，该漏洞的PoC是有效的。搜索引擎结果中提到有writeup，POC代码可用，并且该漏洞已被积极利用。漏洞库信息也表明该漏洞已被CISA加入已知被利用漏洞列表(KEV)。 提供的PoC代码是一个用于演示缓冲区溢出漏洞的demo，虽然它不是直接可用的exp，但是它再现了崩溃行为，并且提供测试环境的搭建方法，以及调试的思路，对于理解漏洞原理非常有帮助。 

**投毒风险分析：**
提供的PoC代码主要由以下部分组成：
*   `LAB_SETUP.md`: 提供实验环境搭建的说明，强调安全措施。
*   `README.md`: 描述项目目标是用于教育和防御研究，不包含exploit代码。
*   `windbg_notes.md`: 提供WinDbg的使用提示。
*   `build.sh`: 用于编译`vuln_demo.c`的脚本。
*   `run_and_crash.md`:  提供运行demo并产生崩溃的指导。
*   `vuln_demo.c`: 包含一个故意存在漏洞的程序，用于演示缓冲区溢出。
*   `reports/analysis.md`: 分析报告模板

综合来看，代码库明确声明了其教育目的，并提供了安全建议以防止滥用。`vuln_demo.c`中的`strcpy`函数存在明显的缓冲区溢出漏洞，这与CVE描述相符。代码库没有发现任何恶意代码或隐藏功能。 投毒的可能来自于作者可能故意留下一些隐蔽的后门代码，例如在`vuln_demo.c`中添加一些不明显的恶意操作，或者在`build.sh`脚本中添加一些下载和执行恶意代码的命令。但考虑到代码的简单性和开源性质，以及作者声明的教育目的，这种可能性较低， 估计投毒风险在5%左右。

**利用方式分析：**
1.  **漏洞原理：** 该漏洞是由于Windows Hyper-V NT Kernel Integration VSP组件中存在堆缓冲区溢出漏洞(CWE-122)。 
2.  **利用步骤：**
    *   攻击者首先需要访问运行Hyper-V的系统，并且最好在Guest操作系统内。
    *   然后，攻击者可以通过向易受攻击的VSP组件发送特制的输入，触发堆缓冲区溢出。
    *   通过精巧的构造输入数据，攻击者可以覆盖相邻的内存区域，从而控制程序的执行流程。
    *   最终，攻击者可以利用此漏洞提升权限，例如从普通用户权限提升到系统管理员权限。
3.  **利用限制：** 漏洞利用需要在启用了Hyper-V的系统上进行，并且可能需要特定的系统配置和权限。


**项目地址:** [rahul0xkr/Hyper-V-CVE-2025-21333-Analysis](https://github.com/rahul0xkr/Hyper-V-CVE-2025-21333-Analysis)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #9

**来源**: [CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md](../2025/CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md)

# CVE-2025-21333

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21333-160102_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-160102_CVE-2025-21333-POC.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致权限提升

**影响版本:** 受影响的Windows版本包括Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等。

**利用条件:** 需要本地访问，在Hyper-V环境中。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP（Virtual Service Provider）权限提升漏洞。根据漏洞信息和搜索结果，该漏洞存在于Hyper-V的NT内核集成组件中，允许攻击者提升权限。漏洞利用代码显示这是一个C++项目，利用了WNF（Windows Notification Facility）状态数据和I/O ring IOP_MC_BUFFER_ENTRY来触发堆缓冲区溢出。该POC的Visual Studio解决方案文件表明它是一个可编译的项目，但存在投毒风险，因为从github下载zip存在未知风险。从代码来看，大量使用了Windows API，直接与内核交互，存在恶意修改内核的可能性，投毒风险评估为20%。利用方式通常包括：

1.  **触发漏洞：** 通过精心构造的WNF状态数据和I/O ring操作，触发NT内核集成组件中的堆缓冲区溢出。
2.  **控制执行流：** 覆盖堆上的关键数据结构，以控制内核的执行流程。
3.  **权限提升：** 通过修改当前进程的Token，将其权限提升到SYSTEM级别。

从搜索结果来看，该漏洞已经被CISA列入已知被利用漏洞目录，表明该漏洞具有较高的实际威胁。

**有效性评估：** 根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的，因为存在可编译的POC，并且CISA已经确认该漏洞被利用。

**投毒风险评估：** 该POC代码存在一定的投毒风险。因为需要下载压缩包，压缩包内部可能包含恶意代码，但主要代码是利用windows api进行操作，函数功能明确，没有发现明显的恶意行为，风险较低。


**项目地址:** [160102/CVE-2025-21333-POC](https://github.com/160102/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #2

**来源**: [CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md](../2025/CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 提权漏洞/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机逃逸，主机权限获取

**影响版本:** 受影响的Windows版本 (见漏洞库信息)

**利用条件:** 需要Guest虚拟机权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (虚拟机服务提供者) 中的提权漏洞，本质是堆溢出。攻击者（虚拟机内的用户）可以利用此漏洞，通过特制的请求导致在主机操作系统内核中发生堆缓冲区溢出，从而获得主机操作系统的管理员权限。

**有效性：**

根据搜索引擎结果，此漏洞已经被公开披露，并且存在公开可用的PoC（例如 GitHub上的`MrAle98/CVE-2025-21333-POC`仓库），表明该漏洞的利用已经得到验证。 漏洞库信息也表明CISA ADP已经将此漏洞添加到已知被利用漏洞列表中，进一步证明了其有效性。

提供的漏洞利用代码`/tmp/32315364bfebb19c9bcece1aca1942c9/README.md` 仅包含CVE编号的信息，本身并没有可执行的利用代码。但是，结合搜索引擎结果，可以找到其他存储库中提供的PoC 代码。

**投毒风险：**

由于提供的代码只是一个包含CVE编号的`README.md`文件，因此直接分析该文件进行投毒判断没有意义。真正的PoC代码位于其他存储库。但是，在实际利用PoC的过程中，需要仔细审查代码，因为PoC代码可能包含恶意修改。 

假设用户下载并执行了某个声称是CVE-2025-21333的PoC代码。 评估投毒风险。鉴于漏洞利用开发和安全研究的复杂性，有以下可能性：

*   **有意后门：** 某些代码作者可能会故意在PoC中添加后门，以便进一步攻击或控制目标系统。风险较高，因为内核漏洞利用通常需要精心的内存操作，很容易隐藏恶意代码。
*   **代码质量问题：** PoC代码可能未经充分测试或包含错误，导致系统崩溃或不稳定。这虽然不是直接的投毒，但也可能对系统造成损害。
*   **依赖项风险：** PoC可能依赖于外部库或组件，这些库或组件本身可能存在漏洞或恶意代码。

考虑到这些因素，初步估计投毒风险为10%。更详细的代码审计可以提供更准确的风险评估。

**利用方式：**

1.  **触发漏洞：** 虚拟机内的攻击者，通过构造恶意的请求发送给Hyper-V主机。
2.  **堆溢出：** 恶意的请求会触发 Hyper-V NT Kernel Integration VSP 组件中的堆缓冲区溢出。
3.  **控制流劫持：** 利用堆溢出覆盖关键内核数据结构，例如函数指针，从而控制内核执行流。
4.  **权限提升：** 执行恶意代码，例如调用`PsLookupProcessByProcessId`和`SeAssignPrivileges`等函数，以提升虚拟机内的进程权限到 SYSTEM。
5.  **虚拟机逃逸：** 利用获得的 SYSTEM 权限，攻击者可以执行虚拟机逃逸操作，例如访问Hyper-V主机的文件系统，甚至控制整个主机。


**项目地址:** [B1ack4sh/Blackash-CVE-2025-21333](https://github.com/B1ack4sh/Blackash-CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #3

**来源**: [CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致系统权限提升

**影响版本:** Windows 10 21H2 (<= 10.0.19044.5371), Windows 11 22H2 (<= 10.0.22621.4751), Windows 10 22H2 (<= 10.0.19045.5371), Windows Server 2025 (<= 10.0.26100.2894), Windows 11 23H2 (<= 10.0.22631.4751), Windows 11 24H2 (<= 10.0.26100.2894), Windows Server 23H2 (<= 10.0.25398.1369)

**利用条件:** 需要Guest OS环境, 并需要利用I/O Ring机制进行攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 的特权提升漏洞。该漏洞是由于内核驱动`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。 

**漏洞利用方式：**

1.  **I/O Ring机制：** PoC利用了Windows I/O Ring机制，通过伪造IOP_MC_BUFFER_ENTRY结构体，从而实现内核任意地址读写。
2.  **堆溢出：** 通过在分页池中分配大量内存，然后触发堆溢出，覆盖IOP_MC_BUFFER_ENTRY结构体指针。
3.  **任意读写：** 覆盖后的`Address`可以指向任意内核地址，从而实现任意地址读写。
4. **提权：** 通过任意读写能力，可以修改当前进程的Token，从而提升权限。

**有效性：**

根据提供的PoC代码和搜索结果，该漏洞PoC的存在，并且已经被CISA列入已知被利用漏洞目录。PoC代码的README描述了如何在Windows 11 23h2上利用此漏洞进行提权，同时也说明了该PoC的可靠性可能不高。

**投毒风险：**

PoC代码本身是一个Visual Studio解决方案，包含C++源代码。 代码主要功能是利用堆溢出和I/O Ring机制实现内核任意地址读写，从而提升权限。审查代码后，发现潜在的投毒风险较低，例如：

*   **复杂性：** 代码相对复杂，阅读和理解需要一定的内核安全知识，增加了隐藏恶意代码的难度。
*   **公开性：** PoC本身是为了演示漏洞利用，作者倾向于公开透明，减少隐藏恶意代码的动机。
    但是，仍然存在一些微小的风险：
*   **细微修改：** 攻击者可能会在PoC代码中添加一些细微的修改，例如修改内存地址或增加延时，从而绕过安全检测。
*   **依赖项：** PoC可能依赖一些外部库或驱动，这些依赖项可能存在安全风险。

综上所述，该PoC代码存在10%的投毒风险，主要是考虑到细微修改和依赖项的潜在风险。


**项目地址:** [MrAle98/CVE-2025-21333-POC](https://github.com/MrAle98/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #4

**来源**: [CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致SYSTEM权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2 等受影响版本

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (Virtual Service Provider) 中的权限提升漏洞。该漏洞是由于 NT 内核集成 VSP 中存在堆缓冲区溢出造成的，攻击者可以利用此漏洞获得 SYSTEM 权限。

**有效性评估：**

根据漏洞描述和搜索结果，该漏洞是一个已知的、存在被利用的漏洞，CISA 已将其添加到已知被利用的漏洞目录中。 Reddit的帖子也表明有人发布了POC。提供的POC代码是一个Visual Studio解决方案，包含C++源代码，这进一步表明该漏洞是可以被利用的。readme描述利用了WNF state data 和 I/O ring IOP_MC_BUFFER_ENTRY，指向了具体利用的技术细节。

**投毒风险评估：**

评估POC代码的投毒风险需要仔细分析代码。从提供的代码片段来看，代码主要涉及Windows API调用，包括内存操作、对象操作、线程管理和进程管理等。初步分析没有发现明显的恶意代码或后门。但是考虑到漏洞利用代码本身的复杂性以及缺乏完整代码，存在一定的投毒风险，例如：

*   **隐蔽的权限提升：** 代码可能包含不易察觉的后门，在提权后执行恶意操作，例如安装恶意软件或收集敏感信息。
*   **代码注入：** 恶意代码可能会注入到其他进程中，从而绕过安全检测。
* **依赖风险:** readme中的链接可能指向恶意网站或包含恶意软件的下载链接。

虽然不能完全排除投毒的可能性，考虑到漏洞利用的复杂性，作者隐藏恶意代码的概率较低，因此暂定投毒风险为10%。

**利用方式分析：**

1.  **漏洞触发：** 攻击者利用Hyper-V NT Kernel Integration VSP中的漏洞，该漏洞位于内核态驱动中，允许从虚拟机内部触发。
2.  **堆溢出：** 利用特定的输入或操作，触发堆缓冲区溢出，覆盖相邻的内存区域。搜索结果表明是Paged Pool中的heap-based buffer overflow
3.  **权限提升：** 通过控制溢出的内容，例如覆盖内核对象或函数指针，攻击者可以将自己的权限提升到SYSTEM。
4.  **执行恶意代码：** 获得SYSTEM权限后，攻击者可以执行任意代码，例如安装恶意软件、窃取数据或控制系统。

**项目地址:** [Mukesh-blend/CVE-2025-21333-POC](https://github.com/Mukesh-blend/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #5

**来源**: [CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机数据泄露、完整性破坏和拒绝服务

**影响版本:** Windows 10 21H2 (版本 10.0.19043.0 到 10.0.19044.5371), Windows 11 22H2 (版本 10.0.22621.0 到 10.0.22621.4751), Windows 10 22H2 (版本 10.0.19045.0 到 10.0.19045.5371), Windows Server 2025 (版本 10.0.26100.0 到 10.0.26100.2894), Windows 11 23H2 (版本 10.0.22631.0 到 10.0.22631.4751), Windows Server 23H2 (版本 10.0.25398.0 到 10.0.25398.1369), Windows 11 24H2 (版本 10.0.26100.0 到 10.0.26100.2894)

**利用条件:** 本地用户权限，需要启用并运行Hyper-V。

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞。根据漏洞描述和搜索结果，攻击者可以利用恶意构造的 Virtual Service Provider (VSP) 来提升权限，最终控制 Hyper-V 主机。这是一个堆溢出漏洞（CWE-122）。

**有效性：**
提供的 POC 代码是一个 Visual Studio 解决方案，包含 C++ 代码。代码中包含Windows头文件，如 `<Windows.h>`, `<ioringapi.h>`和自定义头文件`wnf.h`。通过检查代码，可以发现其中利用了Windows Notification Facility（WNF）状态数据和I/O ring IOP_MC_BUFFER_ENTRY。搜索结果中reddit论坛的帖子也说明这是一个windows内核堆溢出漏洞，并提供了github链接。

**投毒风险：**
提供的代码片段中，最可疑的部分是 `README.md` 文件中提供的下载链接：`[Download Exploit](https://github.com/file/Soft.zip)`。该链接指向一个名为 `Soft.zip` 的 ZIP 文件，从不可信来源下载未经验证的可执行文件具有极高的风险。虽然直接提供的C++代码本身看起来是标准漏洞利用代码，但`README.md`文件中的下载链接是潜在的恶意软件投放点。用户可能被诱导下载包含恶意payload的zip文件，而非真正的漏洞利用程序。因此，存在较高的投毒风险。
另外，`wnf.h`等自定义头文件没有提供，意味着使用者必须自己查找或编写相关代码，这增加了利用难度，也为潜在的投毒留下了空间。攻击者可以提供带有恶意代码的`wnf.h`文件，诱导用户使用。
总体来说，投毒风险较高，估计为80%。

**利用方式：**
1.  **触发漏洞:** 利用特制的 VSP 触发 Hyper-V NT Kernel Integration 中的堆溢出。
2.  **WNF状态数据操控:** 通过操纵WNF状态数据，控制内核内存的布局。
3. **I/O ring IOP_MC_BUFFER_ENTRY：** 通过操控I/O环，控制内核内存的读写。
4.  **权限提升:** 覆盖关键内核数据结构，例如当前进程的 Token，将其替换为 SYSTEM 用户的 Token，从而提升权限。

**项目地址:** [SerabiLem/CVE-2025-21333-POC](https://github.com/SerabiLem/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #6

**来源**: [CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md](../2025/CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，本地攻击者可利用该漏洞获得SYSTEM权限

**影响版本:** Windows 10 21H2 (versionStartIncluding: 10.0.19043.0, versionEndExcluding: 10.0.19044.5371), Windows 11 22H2 (versionStartIncluding: 10.0.22621.0, versionEndExcluding: 10.0.22621.4751), Windows 10 22H2 (versionStartIncluding: 10.0.19045.0, versionEndExcluding: 10.0.19045.5371), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows Server 23H2 (versionStartIncluding: 10.0.25398.0, versionEndExcluding: 10.0.25398.1369), Windows 11 24H2 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894)

**利用条件:** 本地访问，需要运行受影响的Windows Hyper-V。

**POC 可用性:** 是，根据搜索结果，存在可用的POC代码

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 特权提升漏洞。该漏洞是由于`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。攻击者可以利用此漏洞在本地获得 SYSTEM 权限。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞影响多个Windows版本，并且CISA已将其列入已知被利用的漏洞目录，表明该漏洞具有实际的利用价值。搜索引擎结果显示存在公开的POC代码，进一步佐证了漏洞的可利用性。

**投毒风险：** 提供的漏洞利用代码是 KQL 查询语句，用于检测与 CVE-2025-21333 相关的可疑活动。代码本身用于安全事件的监控和分析，而非直接的漏洞利用。因此，可以认为该代码的投毒风险较低，但也需要人工审查代码的逻辑，判断是否存在恶意隐藏。例如，代码中可能会被利用来误报，影响正常的安全事件分析，所以投毒风险为 10%。

**利用方式：**  攻击者可以利用该漏洞通过与Hyper-V的NT内核集成VSP相关的组件，触发堆缓冲区溢出，最终获得SYSTEM权限。具体来说，`vkrnlintvsp.sys` 组件在处理来自虚拟机的数据时，如果没有进行充分的边界检查，可能导致缓冲区溢出。根据搜索结果，漏洞存在于主机操作系统和容器类型虚拟机之间的通信组件中。攻击者需要在受影响的系统上执行恶意代码，触发溢出，从而提升权限。实际的利用可能涉及到内存地址的计算、shellcode的注入等技术。

 简而言之，这是一个本地提权漏洞，攻击者通过精心构造的数据包与Hyper-V的内核集成服务进行交互，导致内核堆缓冲区溢出，从而覆盖关键数据并获得SYSTEM权限。

**项目地址:** [aleongx/KQL_sentinel_CVE-2025-21333](https://github.com/aleongx/KQL_sentinel_CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #7

**来源**: [CVE-2025-21333-pradip022_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-pradip022_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V NT Kernel Integration VSP

**危害等级:** 高危，可提升权限

**影响版本:** 受影响的版本包括Windows 10 21H2，Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等，具体版本范围见CVE描述。

**利用条件:** 需要目标系统运行Hyper-V，且虚拟机集成服务（VSP）存在漏洞。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP的权限提升漏洞，这是一个堆溢出漏洞(CWE-122)。根据搜索结果，存在公开的POC代码，并且该漏洞已被积极利用。漏洞利用代码的README.md文件描述了如何下载和运行该POC，指出利用涉及WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY。代码库中提供的Visual Studio解决方案文件，进一步证实了漏洞利用的存在。虽然github仓库描述了POC的简单用法,但是下载地址却指向了另一个github地址,存在诱导下载其他恶意文件的可能性. 同时考虑到windows内核漏洞利用通常需要较高的技术水平，且可能涉及复杂的内存操作, 因此存在投毒风险，风险概率评估为30%。

利用方式：攻击者可以利用此漏洞在Hyper-V环境中提升权限。具体利用方式涉及构造特定的WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY，触发堆溢出，从而执行恶意代码。

**项目地址:** [pradip022/CVE-2025-21333-POC](https://github.com/pradip022/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #8

**来源**: [CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md](../2025/CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2。具体版本范围参考CVE详情。

**利用条件:** 需要Hyper-V环境，guest操作系统执行漏洞利用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP权限提升漏洞，是一个基于堆的缓冲区溢出(CWE-122)。

**有效性评估：**
根据搜索结果和提供的PoC代码，该漏洞的PoC是有效的。搜索引擎结果中提到有writeup，POC代码可用，并且该漏洞已被积极利用。漏洞库信息也表明该漏洞已被CISA加入已知被利用漏洞列表(KEV)。 提供的PoC代码是一个用于演示缓冲区溢出漏洞的demo，虽然它不是直接可用的exp，但是它再现了崩溃行为，并且提供测试环境的搭建方法，以及调试的思路，对于理解漏洞原理非常有帮助。 

**投毒风险分析：**
提供的PoC代码主要由以下部分组成：
*   `LAB_SETUP.md`: 提供实验环境搭建的说明，强调安全措施。
*   `README.md`: 描述项目目标是用于教育和防御研究，不包含exploit代码。
*   `windbg_notes.md`: 提供WinDbg的使用提示。
*   `build.sh`: 用于编译`vuln_demo.c`的脚本。
*   `run_and_crash.md`:  提供运行demo并产生崩溃的指导。
*   `vuln_demo.c`: 包含一个故意存在漏洞的程序，用于演示缓冲区溢出。
*   `reports/analysis.md`: 分析报告模板

综合来看，代码库明确声明了其教育目的，并提供了安全建议以防止滥用。`vuln_demo.c`中的`strcpy`函数存在明显的缓冲区溢出漏洞，这与CVE描述相符。代码库没有发现任何恶意代码或隐藏功能。 投毒的可能来自于作者可能故意留下一些隐蔽的后门代码，例如在`vuln_demo.c`中添加一些不明显的恶意操作，或者在`build.sh`脚本中添加一些下载和执行恶意代码的命令。但考虑到代码的简单性和开源性质，以及作者声明的教育目的，这种可能性较低， 估计投毒风险在5%左右。

**利用方式分析：**
1.  **漏洞原理：** 该漏洞是由于Windows Hyper-V NT Kernel Integration VSP组件中存在堆缓冲区溢出漏洞(CWE-122)。 
2.  **利用步骤：**
    *   攻击者首先需要访问运行Hyper-V的系统，并且最好在Guest操作系统内。
    *   然后，攻击者可以通过向易受攻击的VSP组件发送特制的输入，触发堆缓冲区溢出。
    *   通过精巧的构造输入数据，攻击者可以覆盖相邻的内存区域，从而控制程序的执行流程。
    *   最终，攻击者可以利用此漏洞提升权限，例如从普通用户权限提升到系统管理员权限。
3.  **利用限制：** 漏洞利用需要在启用了Hyper-V的系统上进行，并且可能需要特定的系统配置和权限。


**项目地址:** [rahul0xkr/Hyper-V-CVE-2025-21333-Analysis](https://github.com/rahul0xkr/Hyper-V-CVE-2025-21333-Analysis)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #9

**来源**: [CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md](../2025/CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md)

# CVE-2025-21333

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21333-160102_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-160102_CVE-2025-21333-POC.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致权限提升

**影响版本:** 受影响的Windows版本包括Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等。

**利用条件:** 需要本地访问，在Hyper-V环境中。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP（Virtual Service Provider）权限提升漏洞。根据漏洞信息和搜索结果，该漏洞存在于Hyper-V的NT内核集成组件中，允许攻击者提升权限。漏洞利用代码显示这是一个C++项目，利用了WNF（Windows Notification Facility）状态数据和I/O ring IOP_MC_BUFFER_ENTRY来触发堆缓冲区溢出。该POC的Visual Studio解决方案文件表明它是一个可编译的项目，但存在投毒风险，因为从github下载zip存在未知风险。从代码来看，大量使用了Windows API，直接与内核交互，存在恶意修改内核的可能性，投毒风险评估为20%。利用方式通常包括：

1.  **触发漏洞：** 通过精心构造的WNF状态数据和I/O ring操作，触发NT内核集成组件中的堆缓冲区溢出。
2.  **控制执行流：** 覆盖堆上的关键数据结构，以控制内核的执行流程。
3.  **权限提升：** 通过修改当前进程的Token，将其权限提升到SYSTEM级别。

从搜索结果来看，该漏洞已经被CISA列入已知被利用漏洞目录，表明该漏洞具有较高的实际威胁。

**有效性评估：** 根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的，因为存在可编译的POC，并且CISA已经确认该漏洞被利用。

**投毒风险评估：** 该POC代码存在一定的投毒风险。因为需要下载压缩包，压缩包内部可能包含恶意代码，但主要代码是利用windows api进行操作，函数功能明确，没有发现明显的恶意行为，风险较低。


**项目地址:** [160102/CVE-2025-21333-POC](https://github.com/160102/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #2

**来源**: [CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md](../2025/CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 提权漏洞/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机逃逸，主机权限获取

**影响版本:** 受影响的Windows版本 (见漏洞库信息)

**利用条件:** 需要Guest虚拟机权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (虚拟机服务提供者) 中的提权漏洞，本质是堆溢出。攻击者（虚拟机内的用户）可以利用此漏洞，通过特制的请求导致在主机操作系统内核中发生堆缓冲区溢出，从而获得主机操作系统的管理员权限。

**有效性：**

根据搜索引擎结果，此漏洞已经被公开披露，并且存在公开可用的PoC（例如 GitHub上的`MrAle98/CVE-2025-21333-POC`仓库），表明该漏洞的利用已经得到验证。 漏洞库信息也表明CISA ADP已经将此漏洞添加到已知被利用漏洞列表中，进一步证明了其有效性。

提供的漏洞利用代码`/tmp/32315364bfebb19c9bcece1aca1942c9/README.md` 仅包含CVE编号的信息，本身并没有可执行的利用代码。但是，结合搜索引擎结果，可以找到其他存储库中提供的PoC 代码。

**投毒风险：**

由于提供的代码只是一个包含CVE编号的`README.md`文件，因此直接分析该文件进行投毒判断没有意义。真正的PoC代码位于其他存储库。但是，在实际利用PoC的过程中，需要仔细审查代码，因为PoC代码可能包含恶意修改。 

假设用户下载并执行了某个声称是CVE-2025-21333的PoC代码。 评估投毒风险。鉴于漏洞利用开发和安全研究的复杂性，有以下可能性：

*   **有意后门：** 某些代码作者可能会故意在PoC中添加后门，以便进一步攻击或控制目标系统。风险较高，因为内核漏洞利用通常需要精心的内存操作，很容易隐藏恶意代码。
*   **代码质量问题：** PoC代码可能未经充分测试或包含错误，导致系统崩溃或不稳定。这虽然不是直接的投毒，但也可能对系统造成损害。
*   **依赖项风险：** PoC可能依赖于外部库或组件，这些库或组件本身可能存在漏洞或恶意代码。

考虑到这些因素，初步估计投毒风险为10%。更详细的代码审计可以提供更准确的风险评估。

**利用方式：**

1.  **触发漏洞：** 虚拟机内的攻击者，通过构造恶意的请求发送给Hyper-V主机。
2.  **堆溢出：** 恶意的请求会触发 Hyper-V NT Kernel Integration VSP 组件中的堆缓冲区溢出。
3.  **控制流劫持：** 利用堆溢出覆盖关键内核数据结构，例如函数指针，从而控制内核执行流。
4.  **权限提升：** 执行恶意代码，例如调用`PsLookupProcessByProcessId`和`SeAssignPrivileges`等函数，以提升虚拟机内的进程权限到 SYSTEM。
5.  **虚拟机逃逸：** 利用获得的 SYSTEM 权限，攻击者可以执行虚拟机逃逸操作，例如访问Hyper-V主机的文件系统，甚至控制整个主机。


**项目地址:** [B1ack4sh/Blackash-CVE-2025-21333](https://github.com/B1ack4sh/Blackash-CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #3

**来源**: [CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致系统权限提升

**影响版本:** Windows 10 21H2 (<= 10.0.19044.5371), Windows 11 22H2 (<= 10.0.22621.4751), Windows 10 22H2 (<= 10.0.19045.5371), Windows Server 2025 (<= 10.0.26100.2894), Windows 11 23H2 (<= 10.0.22631.4751), Windows 11 24H2 (<= 10.0.26100.2894), Windows Server 23H2 (<= 10.0.25398.1369)

**利用条件:** 需要Guest OS环境, 并需要利用I/O Ring机制进行攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 的特权提升漏洞。该漏洞是由于内核驱动`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。 

**漏洞利用方式：**

1.  **I/O Ring机制：** PoC利用了Windows I/O Ring机制，通过伪造IOP_MC_BUFFER_ENTRY结构体，从而实现内核任意地址读写。
2.  **堆溢出：** 通过在分页池中分配大量内存，然后触发堆溢出，覆盖IOP_MC_BUFFER_ENTRY结构体指针。
3.  **任意读写：** 覆盖后的`Address`可以指向任意内核地址，从而实现任意地址读写。
4. **提权：** 通过任意读写能力，可以修改当前进程的Token，从而提升权限。

**有效性：**

根据提供的PoC代码和搜索结果，该漏洞PoC的存在，并且已经被CISA列入已知被利用漏洞目录。PoC代码的README描述了如何在Windows 11 23h2上利用此漏洞进行提权，同时也说明了该PoC的可靠性可能不高。

**投毒风险：**

PoC代码本身是一个Visual Studio解决方案，包含C++源代码。 代码主要功能是利用堆溢出和I/O Ring机制实现内核任意地址读写，从而提升权限。审查代码后，发现潜在的投毒风险较低，例如：

*   **复杂性：** 代码相对复杂，阅读和理解需要一定的内核安全知识，增加了隐藏恶意代码的难度。
*   **公开性：** PoC本身是为了演示漏洞利用，作者倾向于公开透明，减少隐藏恶意代码的动机。
    但是，仍然存在一些微小的风险：
*   **细微修改：** 攻击者可能会在PoC代码中添加一些细微的修改，例如修改内存地址或增加延时，从而绕过安全检测。
*   **依赖项：** PoC可能依赖一些外部库或驱动，这些依赖项可能存在安全风险。

综上所述，该PoC代码存在10%的投毒风险，主要是考虑到细微修改和依赖项的潜在风险。


**项目地址:** [MrAle98/CVE-2025-21333-POC](https://github.com/MrAle98/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #4

**来源**: [CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致SYSTEM权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2 等受影响版本

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (Virtual Service Provider) 中的权限提升漏洞。该漏洞是由于 NT 内核集成 VSP 中存在堆缓冲区溢出造成的，攻击者可以利用此漏洞获得 SYSTEM 权限。

**有效性评估：**

根据漏洞描述和搜索结果，该漏洞是一个已知的、存在被利用的漏洞，CISA 已将其添加到已知被利用的漏洞目录中。 Reddit的帖子也表明有人发布了POC。提供的POC代码是一个Visual Studio解决方案，包含C++源代码，这进一步表明该漏洞是可以被利用的。readme描述利用了WNF state data 和 I/O ring IOP_MC_BUFFER_ENTRY，指向了具体利用的技术细节。

**投毒风险评估：**

评估POC代码的投毒风险需要仔细分析代码。从提供的代码片段来看，代码主要涉及Windows API调用，包括内存操作、对象操作、线程管理和进程管理等。初步分析没有发现明显的恶意代码或后门。但是考虑到漏洞利用代码本身的复杂性以及缺乏完整代码，存在一定的投毒风险，例如：

*   **隐蔽的权限提升：** 代码可能包含不易察觉的后门，在提权后执行恶意操作，例如安装恶意软件或收集敏感信息。
*   **代码注入：** 恶意代码可能会注入到其他进程中，从而绕过安全检测。
* **依赖风险:** readme中的链接可能指向恶意网站或包含恶意软件的下载链接。

虽然不能完全排除投毒的可能性，考虑到漏洞利用的复杂性，作者隐藏恶意代码的概率较低，因此暂定投毒风险为10%。

**利用方式分析：**

1.  **漏洞触发：** 攻击者利用Hyper-V NT Kernel Integration VSP中的漏洞，该漏洞位于内核态驱动中，允许从虚拟机内部触发。
2.  **堆溢出：** 利用特定的输入或操作，触发堆缓冲区溢出，覆盖相邻的内存区域。搜索结果表明是Paged Pool中的heap-based buffer overflow
3.  **权限提升：** 通过控制溢出的内容，例如覆盖内核对象或函数指针，攻击者可以将自己的权限提升到SYSTEM。
4.  **执行恶意代码：** 获得SYSTEM权限后，攻击者可以执行任意代码，例如安装恶意软件、窃取数据或控制系统。

**项目地址:** [Mukesh-blend/CVE-2025-21333-POC](https://github.com/Mukesh-blend/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #5

**来源**: [CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机数据泄露、完整性破坏和拒绝服务

**影响版本:** Windows 10 21H2 (版本 10.0.19043.0 到 10.0.19044.5371), Windows 11 22H2 (版本 10.0.22621.0 到 10.0.22621.4751), Windows 10 22H2 (版本 10.0.19045.0 到 10.0.19045.5371), Windows Server 2025 (版本 10.0.26100.0 到 10.0.26100.2894), Windows 11 23H2 (版本 10.0.22631.0 到 10.0.22631.4751), Windows Server 23H2 (版本 10.0.25398.0 到 10.0.25398.1369), Windows 11 24H2 (版本 10.0.26100.0 到 10.0.26100.2894)

**利用条件:** 本地用户权限，需要启用并运行Hyper-V。

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞。根据漏洞描述和搜索结果，攻击者可以利用恶意构造的 Virtual Service Provider (VSP) 来提升权限，最终控制 Hyper-V 主机。这是一个堆溢出漏洞（CWE-122）。

**有效性：**
提供的 POC 代码是一个 Visual Studio 解决方案，包含 C++ 代码。代码中包含Windows头文件，如 `<Windows.h>`, `<ioringapi.h>`和自定义头文件`wnf.h`。通过检查代码，可以发现其中利用了Windows Notification Facility（WNF）状态数据和I/O ring IOP_MC_BUFFER_ENTRY。搜索结果中reddit论坛的帖子也说明这是一个windows内核堆溢出漏洞，并提供了github链接。

**投毒风险：**
提供的代码片段中，最可疑的部分是 `README.md` 文件中提供的下载链接：`[Download Exploit](https://github.com/file/Soft.zip)`。该链接指向一个名为 `Soft.zip` 的 ZIP 文件，从不可信来源下载未经验证的可执行文件具有极高的风险。虽然直接提供的C++代码本身看起来是标准漏洞利用代码，但`README.md`文件中的下载链接是潜在的恶意软件投放点。用户可能被诱导下载包含恶意payload的zip文件，而非真正的漏洞利用程序。因此，存在较高的投毒风险。
另外，`wnf.h`等自定义头文件没有提供，意味着使用者必须自己查找或编写相关代码，这增加了利用难度，也为潜在的投毒留下了空间。攻击者可以提供带有恶意代码的`wnf.h`文件，诱导用户使用。
总体来说，投毒风险较高，估计为80%。

**利用方式：**
1.  **触发漏洞:** 利用特制的 VSP 触发 Hyper-V NT Kernel Integration 中的堆溢出。
2.  **WNF状态数据操控:** 通过操纵WNF状态数据，控制内核内存的布局。
3. **I/O ring IOP_MC_BUFFER_ENTRY：** 通过操控I/O环，控制内核内存的读写。
4.  **权限提升:** 覆盖关键内核数据结构，例如当前进程的 Token，将其替换为 SYSTEM 用户的 Token，从而提升权限。

**项目地址:** [SerabiLem/CVE-2025-21333-POC](https://github.com/SerabiLem/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #6

**来源**: [CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md](../2025/CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，本地攻击者可利用该漏洞获得SYSTEM权限

**影响版本:** Windows 10 21H2 (versionStartIncluding: 10.0.19043.0, versionEndExcluding: 10.0.19044.5371), Windows 11 22H2 (versionStartIncluding: 10.0.22621.0, versionEndExcluding: 10.0.22621.4751), Windows 10 22H2 (versionStartIncluding: 10.0.19045.0, versionEndExcluding: 10.0.19045.5371), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows Server 23H2 (versionStartIncluding: 10.0.25398.0, versionEndExcluding: 10.0.25398.1369), Windows 11 24H2 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894)

**利用条件:** 本地访问，需要运行受影响的Windows Hyper-V。

**POC 可用性:** 是，根据搜索结果，存在可用的POC代码

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 特权提升漏洞。该漏洞是由于`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。攻击者可以利用此漏洞在本地获得 SYSTEM 权限。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞影响多个Windows版本，并且CISA已将其列入已知被利用的漏洞目录，表明该漏洞具有实际的利用价值。搜索引擎结果显示存在公开的POC代码，进一步佐证了漏洞的可利用性。

**投毒风险：** 提供的漏洞利用代码是 KQL 查询语句，用于检测与 CVE-2025-21333 相关的可疑活动。代码本身用于安全事件的监控和分析，而非直接的漏洞利用。因此，可以认为该代码的投毒风险较低，但也需要人工审查代码的逻辑，判断是否存在恶意隐藏。例如，代码中可能会被利用来误报，影响正常的安全事件分析，所以投毒风险为 10%。

**利用方式：**  攻击者可以利用该漏洞通过与Hyper-V的NT内核集成VSP相关的组件，触发堆缓冲区溢出，最终获得SYSTEM权限。具体来说，`vkrnlintvsp.sys` 组件在处理来自虚拟机的数据时，如果没有进行充分的边界检查，可能导致缓冲区溢出。根据搜索结果，漏洞存在于主机操作系统和容器类型虚拟机之间的通信组件中。攻击者需要在受影响的系统上执行恶意代码，触发溢出，从而提升权限。实际的利用可能涉及到内存地址的计算、shellcode的注入等技术。

 简而言之，这是一个本地提权漏洞，攻击者通过精心构造的数据包与Hyper-V的内核集成服务进行交互，导致内核堆缓冲区溢出，从而覆盖关键数据并获得SYSTEM权限。

**项目地址:** [aleongx/KQL_sentinel_CVE-2025-21333](https://github.com/aleongx/KQL_sentinel_CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #7

**来源**: [CVE-2025-21333-pradip022_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-pradip022_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V NT Kernel Integration VSP

**危害等级:** 高危，可提升权限

**影响版本:** 受影响的版本包括Windows 10 21H2，Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等，具体版本范围见CVE描述。

**利用条件:** 需要目标系统运行Hyper-V，且虚拟机集成服务（VSP）存在漏洞。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP的权限提升漏洞，这是一个堆溢出漏洞(CWE-122)。根据搜索结果，存在公开的POC代码，并且该漏洞已被积极利用。漏洞利用代码的README.md文件描述了如何下载和运行该POC，指出利用涉及WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY。代码库中提供的Visual Studio解决方案文件，进一步证实了漏洞利用的存在。虽然github仓库描述了POC的简单用法,但是下载地址却指向了另一个github地址,存在诱导下载其他恶意文件的可能性. 同时考虑到windows内核漏洞利用通常需要较高的技术水平，且可能涉及复杂的内存操作, 因此存在投毒风险，风险概率评估为30%。

利用方式：攻击者可以利用此漏洞在Hyper-V环境中提升权限。具体利用方式涉及构造特定的WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY，触发堆溢出，从而执行恶意代码。

**项目地址:** [pradip022/CVE-2025-21333-POC](https://github.com/pradip022/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #8

**来源**: [CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md](../2025/CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2。具体版本范围参考CVE详情。

**利用条件:** 需要Hyper-V环境，guest操作系统执行漏洞利用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP权限提升漏洞，是一个基于堆的缓冲区溢出(CWE-122)。

**有效性评估：**
根据搜索结果和提供的PoC代码，该漏洞的PoC是有效的。搜索引擎结果中提到有writeup，POC代码可用，并且该漏洞已被积极利用。漏洞库信息也表明该漏洞已被CISA加入已知被利用漏洞列表(KEV)。 提供的PoC代码是一个用于演示缓冲区溢出漏洞的demo，虽然它不是直接可用的exp，但是它再现了崩溃行为，并且提供测试环境的搭建方法，以及调试的思路，对于理解漏洞原理非常有帮助。 

**投毒风险分析：**
提供的PoC代码主要由以下部分组成：
*   `LAB_SETUP.md`: 提供实验环境搭建的说明，强调安全措施。
*   `README.md`: 描述项目目标是用于教育和防御研究，不包含exploit代码。
*   `windbg_notes.md`: 提供WinDbg的使用提示。
*   `build.sh`: 用于编译`vuln_demo.c`的脚本。
*   `run_and_crash.md`:  提供运行demo并产生崩溃的指导。
*   `vuln_demo.c`: 包含一个故意存在漏洞的程序，用于演示缓冲区溢出。
*   `reports/analysis.md`: 分析报告模板

综合来看，代码库明确声明了其教育目的，并提供了安全建议以防止滥用。`vuln_demo.c`中的`strcpy`函数存在明显的缓冲区溢出漏洞，这与CVE描述相符。代码库没有发现任何恶意代码或隐藏功能。 投毒的可能来自于作者可能故意留下一些隐蔽的后门代码，例如在`vuln_demo.c`中添加一些不明显的恶意操作，或者在`build.sh`脚本中添加一些下载和执行恶意代码的命令。但考虑到代码的简单性和开源性质，以及作者声明的教育目的，这种可能性较低， 估计投毒风险在5%左右。

**利用方式分析：**
1.  **漏洞原理：** 该漏洞是由于Windows Hyper-V NT Kernel Integration VSP组件中存在堆缓冲区溢出漏洞(CWE-122)。 
2.  **利用步骤：**
    *   攻击者首先需要访问运行Hyper-V的系统，并且最好在Guest操作系统内。
    *   然后，攻击者可以通过向易受攻击的VSP组件发送特制的输入，触发堆缓冲区溢出。
    *   通过精巧的构造输入数据，攻击者可以覆盖相邻的内存区域，从而控制程序的执行流程。
    *   最终，攻击者可以利用此漏洞提升权限，例如从普通用户权限提升到系统管理员权限。
3.  **利用限制：** 漏洞利用需要在启用了Hyper-V的系统上进行，并且可能需要特定的系统配置和权限。


**项目地址:** [rahul0xkr/Hyper-V-CVE-2025-21333-Analysis](https://github.com/rahul0xkr/Hyper-V-CVE-2025-21333-Analysis)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #9

**来源**: [CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md](../2025/CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md)

# CVE-2025-21333

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21333-160102_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-160102_CVE-2025-21333-POC.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致权限提升

**影响版本:** 受影响的Windows版本包括Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等。

**利用条件:** 需要本地访问，在Hyper-V环境中。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP（Virtual Service Provider）权限提升漏洞。根据漏洞信息和搜索结果，该漏洞存在于Hyper-V的NT内核集成组件中，允许攻击者提升权限。漏洞利用代码显示这是一个C++项目，利用了WNF（Windows Notification Facility）状态数据和I/O ring IOP_MC_BUFFER_ENTRY来触发堆缓冲区溢出。该POC的Visual Studio解决方案文件表明它是一个可编译的项目，但存在投毒风险，因为从github下载zip存在未知风险。从代码来看，大量使用了Windows API，直接与内核交互，存在恶意修改内核的可能性，投毒风险评估为20%。利用方式通常包括：

1.  **触发漏洞：** 通过精心构造的WNF状态数据和I/O ring操作，触发NT内核集成组件中的堆缓冲区溢出。
2.  **控制执行流：** 覆盖堆上的关键数据结构，以控制内核的执行流程。
3.  **权限提升：** 通过修改当前进程的Token，将其权限提升到SYSTEM级别。

从搜索结果来看，该漏洞已经被CISA列入已知被利用漏洞目录，表明该漏洞具有较高的实际威胁。

**有效性评估：** 根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的，因为存在可编译的POC，并且CISA已经确认该漏洞被利用。

**投毒风险评估：** 该POC代码存在一定的投毒风险。因为需要下载压缩包，压缩包内部可能包含恶意代码，但主要代码是利用windows api进行操作，函数功能明确，没有发现明显的恶意行为，风险较低。


**项目地址:** [160102/CVE-2025-21333-POC](https://github.com/160102/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #2

**来源**: [CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md](../2025/CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 提权漏洞/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机逃逸，主机权限获取

**影响版本:** 受影响的Windows版本 (见漏洞库信息)

**利用条件:** 需要Guest虚拟机权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (虚拟机服务提供者) 中的提权漏洞，本质是堆溢出。攻击者（虚拟机内的用户）可以利用此漏洞，通过特制的请求导致在主机操作系统内核中发生堆缓冲区溢出，从而获得主机操作系统的管理员权限。

**有效性：**

根据搜索引擎结果，此漏洞已经被公开披露，并且存在公开可用的PoC（例如 GitHub上的`MrAle98/CVE-2025-21333-POC`仓库），表明该漏洞的利用已经得到验证。 漏洞库信息也表明CISA ADP已经将此漏洞添加到已知被利用漏洞列表中，进一步证明了其有效性。

提供的漏洞利用代码`/tmp/32315364bfebb19c9bcece1aca1942c9/README.md` 仅包含CVE编号的信息，本身并没有可执行的利用代码。但是，结合搜索引擎结果，可以找到其他存储库中提供的PoC 代码。

**投毒风险：**

由于提供的代码只是一个包含CVE编号的`README.md`文件，因此直接分析该文件进行投毒判断没有意义。真正的PoC代码位于其他存储库。但是，在实际利用PoC的过程中，需要仔细审查代码，因为PoC代码可能包含恶意修改。 

假设用户下载并执行了某个声称是CVE-2025-21333的PoC代码。 评估投毒风险。鉴于漏洞利用开发和安全研究的复杂性，有以下可能性：

*   **有意后门：** 某些代码作者可能会故意在PoC中添加后门，以便进一步攻击或控制目标系统。风险较高，因为内核漏洞利用通常需要精心的内存操作，很容易隐藏恶意代码。
*   **代码质量问题：** PoC代码可能未经充分测试或包含错误，导致系统崩溃或不稳定。这虽然不是直接的投毒，但也可能对系统造成损害。
*   **依赖项风险：** PoC可能依赖于外部库或组件，这些库或组件本身可能存在漏洞或恶意代码。

考虑到这些因素，初步估计投毒风险为10%。更详细的代码审计可以提供更准确的风险评估。

**利用方式：**

1.  **触发漏洞：** 虚拟机内的攻击者，通过构造恶意的请求发送给Hyper-V主机。
2.  **堆溢出：** 恶意的请求会触发 Hyper-V NT Kernel Integration VSP 组件中的堆缓冲区溢出。
3.  **控制流劫持：** 利用堆溢出覆盖关键内核数据结构，例如函数指针，从而控制内核执行流。
4.  **权限提升：** 执行恶意代码，例如调用`PsLookupProcessByProcessId`和`SeAssignPrivileges`等函数，以提升虚拟机内的进程权限到 SYSTEM。
5.  **虚拟机逃逸：** 利用获得的 SYSTEM 权限，攻击者可以执行虚拟机逃逸操作，例如访问Hyper-V主机的文件系统，甚至控制整个主机。


**项目地址:** [B1ack4sh/Blackash-CVE-2025-21333](https://github.com/B1ack4sh/Blackash-CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #3

**来源**: [CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致系统权限提升

**影响版本:** Windows 10 21H2 (<= 10.0.19044.5371), Windows 11 22H2 (<= 10.0.22621.4751), Windows 10 22H2 (<= 10.0.19045.5371), Windows Server 2025 (<= 10.0.26100.2894), Windows 11 23H2 (<= 10.0.22631.4751), Windows 11 24H2 (<= 10.0.26100.2894), Windows Server 23H2 (<= 10.0.25398.1369)

**利用条件:** 需要Guest OS环境, 并需要利用I/O Ring机制进行攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 的特权提升漏洞。该漏洞是由于内核驱动`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。 

**漏洞利用方式：**

1.  **I/O Ring机制：** PoC利用了Windows I/O Ring机制，通过伪造IOP_MC_BUFFER_ENTRY结构体，从而实现内核任意地址读写。
2.  **堆溢出：** 通过在分页池中分配大量内存，然后触发堆溢出，覆盖IOP_MC_BUFFER_ENTRY结构体指针。
3.  **任意读写：** 覆盖后的`Address`可以指向任意内核地址，从而实现任意地址读写。
4. **提权：** 通过任意读写能力，可以修改当前进程的Token，从而提升权限。

**有效性：**

根据提供的PoC代码和搜索结果，该漏洞PoC的存在，并且已经被CISA列入已知被利用漏洞目录。PoC代码的README描述了如何在Windows 11 23h2上利用此漏洞进行提权，同时也说明了该PoC的可靠性可能不高。

**投毒风险：**

PoC代码本身是一个Visual Studio解决方案，包含C++源代码。 代码主要功能是利用堆溢出和I/O Ring机制实现内核任意地址读写，从而提升权限。审查代码后，发现潜在的投毒风险较低，例如：

*   **复杂性：** 代码相对复杂，阅读和理解需要一定的内核安全知识，增加了隐藏恶意代码的难度。
*   **公开性：** PoC本身是为了演示漏洞利用，作者倾向于公开透明，减少隐藏恶意代码的动机。
    但是，仍然存在一些微小的风险：
*   **细微修改：** 攻击者可能会在PoC代码中添加一些细微的修改，例如修改内存地址或增加延时，从而绕过安全检测。
*   **依赖项：** PoC可能依赖一些外部库或驱动，这些依赖项可能存在安全风险。

综上所述，该PoC代码存在10%的投毒风险，主要是考虑到细微修改和依赖项的潜在风险。


**项目地址:** [MrAle98/CVE-2025-21333-POC](https://github.com/MrAle98/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #4

**来源**: [CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致SYSTEM权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2 等受影响版本

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (Virtual Service Provider) 中的权限提升漏洞。该漏洞是由于 NT 内核集成 VSP 中存在堆缓冲区溢出造成的，攻击者可以利用此漏洞获得 SYSTEM 权限。

**有效性评估：**

根据漏洞描述和搜索结果，该漏洞是一个已知的、存在被利用的漏洞，CISA 已将其添加到已知被利用的漏洞目录中。 Reddit的帖子也表明有人发布了POC。提供的POC代码是一个Visual Studio解决方案，包含C++源代码，这进一步表明该漏洞是可以被利用的。readme描述利用了WNF state data 和 I/O ring IOP_MC_BUFFER_ENTRY，指向了具体利用的技术细节。

**投毒风险评估：**

评估POC代码的投毒风险需要仔细分析代码。从提供的代码片段来看，代码主要涉及Windows API调用，包括内存操作、对象操作、线程管理和进程管理等。初步分析没有发现明显的恶意代码或后门。但是考虑到漏洞利用代码本身的复杂性以及缺乏完整代码，存在一定的投毒风险，例如：

*   **隐蔽的权限提升：** 代码可能包含不易察觉的后门，在提权后执行恶意操作，例如安装恶意软件或收集敏感信息。
*   **代码注入：** 恶意代码可能会注入到其他进程中，从而绕过安全检测。
* **依赖风险:** readme中的链接可能指向恶意网站或包含恶意软件的下载链接。

虽然不能完全排除投毒的可能性，考虑到漏洞利用的复杂性，作者隐藏恶意代码的概率较低，因此暂定投毒风险为10%。

**利用方式分析：**

1.  **漏洞触发：** 攻击者利用Hyper-V NT Kernel Integration VSP中的漏洞，该漏洞位于内核态驱动中，允许从虚拟机内部触发。
2.  **堆溢出：** 利用特定的输入或操作，触发堆缓冲区溢出，覆盖相邻的内存区域。搜索结果表明是Paged Pool中的heap-based buffer overflow
3.  **权限提升：** 通过控制溢出的内容，例如覆盖内核对象或函数指针，攻击者可以将自己的权限提升到SYSTEM。
4.  **执行恶意代码：** 获得SYSTEM权限后，攻击者可以执行任意代码，例如安装恶意软件、窃取数据或控制系统。

**项目地址:** [Mukesh-blend/CVE-2025-21333-POC](https://github.com/Mukesh-blend/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #5

**来源**: [CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机数据泄露、完整性破坏和拒绝服务

**影响版本:** Windows 10 21H2 (版本 10.0.19043.0 到 10.0.19044.5371), Windows 11 22H2 (版本 10.0.22621.0 到 10.0.22621.4751), Windows 10 22H2 (版本 10.0.19045.0 到 10.0.19045.5371), Windows Server 2025 (版本 10.0.26100.0 到 10.0.26100.2894), Windows 11 23H2 (版本 10.0.22631.0 到 10.0.22631.4751), Windows Server 23H2 (版本 10.0.25398.0 到 10.0.25398.1369), Windows 11 24H2 (版本 10.0.26100.0 到 10.0.26100.2894)

**利用条件:** 本地用户权限，需要启用并运行Hyper-V。

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞。根据漏洞描述和搜索结果，攻击者可以利用恶意构造的 Virtual Service Provider (VSP) 来提升权限，最终控制 Hyper-V 主机。这是一个堆溢出漏洞（CWE-122）。

**有效性：**
提供的 POC 代码是一个 Visual Studio 解决方案，包含 C++ 代码。代码中包含Windows头文件，如 `<Windows.h>`, `<ioringapi.h>`和自定义头文件`wnf.h`。通过检查代码，可以发现其中利用了Windows Notification Facility（WNF）状态数据和I/O ring IOP_MC_BUFFER_ENTRY。搜索结果中reddit论坛的帖子也说明这是一个windows内核堆溢出漏洞，并提供了github链接。

**投毒风险：**
提供的代码片段中，最可疑的部分是 `README.md` 文件中提供的下载链接：`[Download Exploit](https://github.com/file/Soft.zip)`。该链接指向一个名为 `Soft.zip` 的 ZIP 文件，从不可信来源下载未经验证的可执行文件具有极高的风险。虽然直接提供的C++代码本身看起来是标准漏洞利用代码，但`README.md`文件中的下载链接是潜在的恶意软件投放点。用户可能被诱导下载包含恶意payload的zip文件，而非真正的漏洞利用程序。因此，存在较高的投毒风险。
另外，`wnf.h`等自定义头文件没有提供，意味着使用者必须自己查找或编写相关代码，这增加了利用难度，也为潜在的投毒留下了空间。攻击者可以提供带有恶意代码的`wnf.h`文件，诱导用户使用。
总体来说，投毒风险较高，估计为80%。

**利用方式：**
1.  **触发漏洞:** 利用特制的 VSP 触发 Hyper-V NT Kernel Integration 中的堆溢出。
2.  **WNF状态数据操控:** 通过操纵WNF状态数据，控制内核内存的布局。
3. **I/O ring IOP_MC_BUFFER_ENTRY：** 通过操控I/O环，控制内核内存的读写。
4.  **权限提升:** 覆盖关键内核数据结构，例如当前进程的 Token，将其替换为 SYSTEM 用户的 Token，从而提升权限。

**项目地址:** [SerabiLem/CVE-2025-21333-POC](https://github.com/SerabiLem/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #6

**来源**: [CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md](../2025/CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，本地攻击者可利用该漏洞获得SYSTEM权限

**影响版本:** Windows 10 21H2 (versionStartIncluding: 10.0.19043.0, versionEndExcluding: 10.0.19044.5371), Windows 11 22H2 (versionStartIncluding: 10.0.22621.0, versionEndExcluding: 10.0.22621.4751), Windows 10 22H2 (versionStartIncluding: 10.0.19045.0, versionEndExcluding: 10.0.19045.5371), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows Server 23H2 (versionStartIncluding: 10.0.25398.0, versionEndExcluding: 10.0.25398.1369), Windows 11 24H2 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894)

**利用条件:** 本地访问，需要运行受影响的Windows Hyper-V。

**POC 可用性:** 是，根据搜索结果，存在可用的POC代码

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 特权提升漏洞。该漏洞是由于`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。攻击者可以利用此漏洞在本地获得 SYSTEM 权限。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞影响多个Windows版本，并且CISA已将其列入已知被利用的漏洞目录，表明该漏洞具有实际的利用价值。搜索引擎结果显示存在公开的POC代码，进一步佐证了漏洞的可利用性。

**投毒风险：** 提供的漏洞利用代码是 KQL 查询语句，用于检测与 CVE-2025-21333 相关的可疑活动。代码本身用于安全事件的监控和分析，而非直接的漏洞利用。因此，可以认为该代码的投毒风险较低，但也需要人工审查代码的逻辑，判断是否存在恶意隐藏。例如，代码中可能会被利用来误报，影响正常的安全事件分析，所以投毒风险为 10%。

**利用方式：**  攻击者可以利用该漏洞通过与Hyper-V的NT内核集成VSP相关的组件，触发堆缓冲区溢出，最终获得SYSTEM权限。具体来说，`vkrnlintvsp.sys` 组件在处理来自虚拟机的数据时，如果没有进行充分的边界检查，可能导致缓冲区溢出。根据搜索结果，漏洞存在于主机操作系统和容器类型虚拟机之间的通信组件中。攻击者需要在受影响的系统上执行恶意代码，触发溢出，从而提升权限。实际的利用可能涉及到内存地址的计算、shellcode的注入等技术。

 简而言之，这是一个本地提权漏洞，攻击者通过精心构造的数据包与Hyper-V的内核集成服务进行交互，导致内核堆缓冲区溢出，从而覆盖关键数据并获得SYSTEM权限。

**项目地址:** [aleongx/KQL_sentinel_CVE-2025-21333](https://github.com/aleongx/KQL_sentinel_CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #7

**来源**: [CVE-2025-21333-pradip022_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-pradip022_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V NT Kernel Integration VSP

**危害等级:** 高危，可提升权限

**影响版本:** 受影响的版本包括Windows 10 21H2，Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等，具体版本范围见CVE描述。

**利用条件:** 需要目标系统运行Hyper-V，且虚拟机集成服务（VSP）存在漏洞。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP的权限提升漏洞，这是一个堆溢出漏洞(CWE-122)。根据搜索结果，存在公开的POC代码，并且该漏洞已被积极利用。漏洞利用代码的README.md文件描述了如何下载和运行该POC，指出利用涉及WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY。代码库中提供的Visual Studio解决方案文件，进一步证实了漏洞利用的存在。虽然github仓库描述了POC的简单用法,但是下载地址却指向了另一个github地址,存在诱导下载其他恶意文件的可能性. 同时考虑到windows内核漏洞利用通常需要较高的技术水平，且可能涉及复杂的内存操作, 因此存在投毒风险，风险概率评估为30%。

利用方式：攻击者可以利用此漏洞在Hyper-V环境中提升权限。具体利用方式涉及构造特定的WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY，触发堆溢出，从而执行恶意代码。

**项目地址:** [pradip022/CVE-2025-21333-POC](https://github.com/pradip022/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #8

**来源**: [CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md](../2025/CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2。具体版本范围参考CVE详情。

**利用条件:** 需要Hyper-V环境，guest操作系统执行漏洞利用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP权限提升漏洞，是一个基于堆的缓冲区溢出(CWE-122)。

**有效性评估：**
根据搜索结果和提供的PoC代码，该漏洞的PoC是有效的。搜索引擎结果中提到有writeup，POC代码可用，并且该漏洞已被积极利用。漏洞库信息也表明该漏洞已被CISA加入已知被利用漏洞列表(KEV)。 提供的PoC代码是一个用于演示缓冲区溢出漏洞的demo，虽然它不是直接可用的exp，但是它再现了崩溃行为，并且提供测试环境的搭建方法，以及调试的思路，对于理解漏洞原理非常有帮助。 

**投毒风险分析：**
提供的PoC代码主要由以下部分组成：
*   `LAB_SETUP.md`: 提供实验环境搭建的说明，强调安全措施。
*   `README.md`: 描述项目目标是用于教育和防御研究，不包含exploit代码。
*   `windbg_notes.md`: 提供WinDbg的使用提示。
*   `build.sh`: 用于编译`vuln_demo.c`的脚本。
*   `run_and_crash.md`:  提供运行demo并产生崩溃的指导。
*   `vuln_demo.c`: 包含一个故意存在漏洞的程序，用于演示缓冲区溢出。
*   `reports/analysis.md`: 分析报告模板

综合来看，代码库明确声明了其教育目的，并提供了安全建议以防止滥用。`vuln_demo.c`中的`strcpy`函数存在明显的缓冲区溢出漏洞，这与CVE描述相符。代码库没有发现任何恶意代码或隐藏功能。 投毒的可能来自于作者可能故意留下一些隐蔽的后门代码，例如在`vuln_demo.c`中添加一些不明显的恶意操作，或者在`build.sh`脚本中添加一些下载和执行恶意代码的命令。但考虑到代码的简单性和开源性质，以及作者声明的教育目的，这种可能性较低， 估计投毒风险在5%左右。

**利用方式分析：**
1.  **漏洞原理：** 该漏洞是由于Windows Hyper-V NT Kernel Integration VSP组件中存在堆缓冲区溢出漏洞(CWE-122)。 
2.  **利用步骤：**
    *   攻击者首先需要访问运行Hyper-V的系统，并且最好在Guest操作系统内。
    *   然后，攻击者可以通过向易受攻击的VSP组件发送特制的输入，触发堆缓冲区溢出。
    *   通过精巧的构造输入数据，攻击者可以覆盖相邻的内存区域，从而控制程序的执行流程。
    *   最终，攻击者可以利用此漏洞提升权限，例如从普通用户权限提升到系统管理员权限。
3.  **利用限制：** 漏洞利用需要在启用了Hyper-V的系统上进行，并且可能需要特定的系统配置和权限。


**项目地址:** [rahul0xkr/Hyper-V-CVE-2025-21333-Analysis](https://github.com/rahul0xkr/Hyper-V-CVE-2025-21333-Analysis)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #9

**来源**: [CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md](../2025/CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md)

# CVE-2025-21333

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21333-160102_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-160102_CVE-2025-21333-POC.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致权限提升

**影响版本:** 受影响的Windows版本包括Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等。

**利用条件:** 需要本地访问，在Hyper-V环境中。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP（Virtual Service Provider）权限提升漏洞。根据漏洞信息和搜索结果，该漏洞存在于Hyper-V的NT内核集成组件中，允许攻击者提升权限。漏洞利用代码显示这是一个C++项目，利用了WNF（Windows Notification Facility）状态数据和I/O ring IOP_MC_BUFFER_ENTRY来触发堆缓冲区溢出。该POC的Visual Studio解决方案文件表明它是一个可编译的项目，但存在投毒风险，因为从github下载zip存在未知风险。从代码来看，大量使用了Windows API，直接与内核交互，存在恶意修改内核的可能性，投毒风险评估为20%。利用方式通常包括：

1.  **触发漏洞：** 通过精心构造的WNF状态数据和I/O ring操作，触发NT内核集成组件中的堆缓冲区溢出。
2.  **控制执行流：** 覆盖堆上的关键数据结构，以控制内核的执行流程。
3.  **权限提升：** 通过修改当前进程的Token，将其权限提升到SYSTEM级别。

从搜索结果来看，该漏洞已经被CISA列入已知被利用漏洞目录，表明该漏洞具有较高的实际威胁。

**有效性评估：** 根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的，因为存在可编译的POC，并且CISA已经确认该漏洞被利用。

**投毒风险评估：** 该POC代码存在一定的投毒风险。因为需要下载压缩包，压缩包内部可能包含恶意代码，但主要代码是利用windows api进行操作，函数功能明确，没有发现明显的恶意行为，风险较低。


**项目地址:** [160102/CVE-2025-21333-POC](https://github.com/160102/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #2

**来源**: [CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md](../2025/CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 提权漏洞/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机逃逸，主机权限获取

**影响版本:** 受影响的Windows版本 (见漏洞库信息)

**利用条件:** 需要Guest虚拟机权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (虚拟机服务提供者) 中的提权漏洞，本质是堆溢出。攻击者（虚拟机内的用户）可以利用此漏洞，通过特制的请求导致在主机操作系统内核中发生堆缓冲区溢出，从而获得主机操作系统的管理员权限。

**有效性：**

根据搜索引擎结果，此漏洞已经被公开披露，并且存在公开可用的PoC（例如 GitHub上的`MrAle98/CVE-2025-21333-POC`仓库），表明该漏洞的利用已经得到验证。 漏洞库信息也表明CISA ADP已经将此漏洞添加到已知被利用漏洞列表中，进一步证明了其有效性。

提供的漏洞利用代码`/tmp/32315364bfebb19c9bcece1aca1942c9/README.md` 仅包含CVE编号的信息，本身并没有可执行的利用代码。但是，结合搜索引擎结果，可以找到其他存储库中提供的PoC 代码。

**投毒风险：**

由于提供的代码只是一个包含CVE编号的`README.md`文件，因此直接分析该文件进行投毒判断没有意义。真正的PoC代码位于其他存储库。但是，在实际利用PoC的过程中，需要仔细审查代码，因为PoC代码可能包含恶意修改。 

假设用户下载并执行了某个声称是CVE-2025-21333的PoC代码。 评估投毒风险。鉴于漏洞利用开发和安全研究的复杂性，有以下可能性：

*   **有意后门：** 某些代码作者可能会故意在PoC中添加后门，以便进一步攻击或控制目标系统。风险较高，因为内核漏洞利用通常需要精心的内存操作，很容易隐藏恶意代码。
*   **代码质量问题：** PoC代码可能未经充分测试或包含错误，导致系统崩溃或不稳定。这虽然不是直接的投毒，但也可能对系统造成损害。
*   **依赖项风险：** PoC可能依赖于外部库或组件，这些库或组件本身可能存在漏洞或恶意代码。

考虑到这些因素，初步估计投毒风险为10%。更详细的代码审计可以提供更准确的风险评估。

**利用方式：**

1.  **触发漏洞：** 虚拟机内的攻击者，通过构造恶意的请求发送给Hyper-V主机。
2.  **堆溢出：** 恶意的请求会触发 Hyper-V NT Kernel Integration VSP 组件中的堆缓冲区溢出。
3.  **控制流劫持：** 利用堆溢出覆盖关键内核数据结构，例如函数指针，从而控制内核执行流。
4.  **权限提升：** 执行恶意代码，例如调用`PsLookupProcessByProcessId`和`SeAssignPrivileges`等函数，以提升虚拟机内的进程权限到 SYSTEM。
5.  **虚拟机逃逸：** 利用获得的 SYSTEM 权限，攻击者可以执行虚拟机逃逸操作，例如访问Hyper-V主机的文件系统，甚至控制整个主机。


**项目地址:** [B1ack4sh/Blackash-CVE-2025-21333](https://github.com/B1ack4sh/Blackash-CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #3

**来源**: [CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致系统权限提升

**影响版本:** Windows 10 21H2 (<= 10.0.19044.5371), Windows 11 22H2 (<= 10.0.22621.4751), Windows 10 22H2 (<= 10.0.19045.5371), Windows Server 2025 (<= 10.0.26100.2894), Windows 11 23H2 (<= 10.0.22631.4751), Windows 11 24H2 (<= 10.0.26100.2894), Windows Server 23H2 (<= 10.0.25398.1369)

**利用条件:** 需要Guest OS环境, 并需要利用I/O Ring机制进行攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 的特权提升漏洞。该漏洞是由于内核驱动`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。 

**漏洞利用方式：**

1.  **I/O Ring机制：** PoC利用了Windows I/O Ring机制，通过伪造IOP_MC_BUFFER_ENTRY结构体，从而实现内核任意地址读写。
2.  **堆溢出：** 通过在分页池中分配大量内存，然后触发堆溢出，覆盖IOP_MC_BUFFER_ENTRY结构体指针。
3.  **任意读写：** 覆盖后的`Address`可以指向任意内核地址，从而实现任意地址读写。
4. **提权：** 通过任意读写能力，可以修改当前进程的Token，从而提升权限。

**有效性：**

根据提供的PoC代码和搜索结果，该漏洞PoC的存在，并且已经被CISA列入已知被利用漏洞目录。PoC代码的README描述了如何在Windows 11 23h2上利用此漏洞进行提权，同时也说明了该PoC的可靠性可能不高。

**投毒风险：**

PoC代码本身是一个Visual Studio解决方案，包含C++源代码。 代码主要功能是利用堆溢出和I/O Ring机制实现内核任意地址读写，从而提升权限。审查代码后，发现潜在的投毒风险较低，例如：

*   **复杂性：** 代码相对复杂，阅读和理解需要一定的内核安全知识，增加了隐藏恶意代码的难度。
*   **公开性：** PoC本身是为了演示漏洞利用，作者倾向于公开透明，减少隐藏恶意代码的动机。
    但是，仍然存在一些微小的风险：
*   **细微修改：** 攻击者可能会在PoC代码中添加一些细微的修改，例如修改内存地址或增加延时，从而绕过安全检测。
*   **依赖项：** PoC可能依赖一些外部库或驱动，这些依赖项可能存在安全风险。

综上所述，该PoC代码存在10%的投毒风险，主要是考虑到细微修改和依赖项的潜在风险。


**项目地址:** [MrAle98/CVE-2025-21333-POC](https://github.com/MrAle98/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #4

**来源**: [CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致SYSTEM权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2 等受影响版本

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (Virtual Service Provider) 中的权限提升漏洞。该漏洞是由于 NT 内核集成 VSP 中存在堆缓冲区溢出造成的，攻击者可以利用此漏洞获得 SYSTEM 权限。

**有效性评估：**

根据漏洞描述和搜索结果，该漏洞是一个已知的、存在被利用的漏洞，CISA 已将其添加到已知被利用的漏洞目录中。 Reddit的帖子也表明有人发布了POC。提供的POC代码是一个Visual Studio解决方案，包含C++源代码，这进一步表明该漏洞是可以被利用的。readme描述利用了WNF state data 和 I/O ring IOP_MC_BUFFER_ENTRY，指向了具体利用的技术细节。

**投毒风险评估：**

评估POC代码的投毒风险需要仔细分析代码。从提供的代码片段来看，代码主要涉及Windows API调用，包括内存操作、对象操作、线程管理和进程管理等。初步分析没有发现明显的恶意代码或后门。但是考虑到漏洞利用代码本身的复杂性以及缺乏完整代码，存在一定的投毒风险，例如：

*   **隐蔽的权限提升：** 代码可能包含不易察觉的后门，在提权后执行恶意操作，例如安装恶意软件或收集敏感信息。
*   **代码注入：** 恶意代码可能会注入到其他进程中，从而绕过安全检测。
* **依赖风险:** readme中的链接可能指向恶意网站或包含恶意软件的下载链接。

虽然不能完全排除投毒的可能性，考虑到漏洞利用的复杂性，作者隐藏恶意代码的概率较低，因此暂定投毒风险为10%。

**利用方式分析：**

1.  **漏洞触发：** 攻击者利用Hyper-V NT Kernel Integration VSP中的漏洞，该漏洞位于内核态驱动中，允许从虚拟机内部触发。
2.  **堆溢出：** 利用特定的输入或操作，触发堆缓冲区溢出，覆盖相邻的内存区域。搜索结果表明是Paged Pool中的heap-based buffer overflow
3.  **权限提升：** 通过控制溢出的内容，例如覆盖内核对象或函数指针，攻击者可以将自己的权限提升到SYSTEM。
4.  **执行恶意代码：** 获得SYSTEM权限后，攻击者可以执行任意代码，例如安装恶意软件、窃取数据或控制系统。

**项目地址:** [Mukesh-blend/CVE-2025-21333-POC](https://github.com/Mukesh-blend/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #5

**来源**: [CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机数据泄露、完整性破坏和拒绝服务

**影响版本:** Windows 10 21H2 (版本 10.0.19043.0 到 10.0.19044.5371), Windows 11 22H2 (版本 10.0.22621.0 到 10.0.22621.4751), Windows 10 22H2 (版本 10.0.19045.0 到 10.0.19045.5371), Windows Server 2025 (版本 10.0.26100.0 到 10.0.26100.2894), Windows 11 23H2 (版本 10.0.22631.0 到 10.0.22631.4751), Windows Server 23H2 (版本 10.0.25398.0 到 10.0.25398.1369), Windows 11 24H2 (版本 10.0.26100.0 到 10.0.26100.2894)

**利用条件:** 本地用户权限，需要启用并运行Hyper-V。

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞。根据漏洞描述和搜索结果，攻击者可以利用恶意构造的 Virtual Service Provider (VSP) 来提升权限，最终控制 Hyper-V 主机。这是一个堆溢出漏洞（CWE-122）。

**有效性：**
提供的 POC 代码是一个 Visual Studio 解决方案，包含 C++ 代码。代码中包含Windows头文件，如 `<Windows.h>`, `<ioringapi.h>`和自定义头文件`wnf.h`。通过检查代码，可以发现其中利用了Windows Notification Facility（WNF）状态数据和I/O ring IOP_MC_BUFFER_ENTRY。搜索结果中reddit论坛的帖子也说明这是一个windows内核堆溢出漏洞，并提供了github链接。

**投毒风险：**
提供的代码片段中，最可疑的部分是 `README.md` 文件中提供的下载链接：`[Download Exploit](https://github.com/file/Soft.zip)`。该链接指向一个名为 `Soft.zip` 的 ZIP 文件，从不可信来源下载未经验证的可执行文件具有极高的风险。虽然直接提供的C++代码本身看起来是标准漏洞利用代码，但`README.md`文件中的下载链接是潜在的恶意软件投放点。用户可能被诱导下载包含恶意payload的zip文件，而非真正的漏洞利用程序。因此，存在较高的投毒风险。
另外，`wnf.h`等自定义头文件没有提供，意味着使用者必须自己查找或编写相关代码，这增加了利用难度，也为潜在的投毒留下了空间。攻击者可以提供带有恶意代码的`wnf.h`文件，诱导用户使用。
总体来说，投毒风险较高，估计为80%。

**利用方式：**
1.  **触发漏洞:** 利用特制的 VSP 触发 Hyper-V NT Kernel Integration 中的堆溢出。
2.  **WNF状态数据操控:** 通过操纵WNF状态数据，控制内核内存的布局。
3. **I/O ring IOP_MC_BUFFER_ENTRY：** 通过操控I/O环，控制内核内存的读写。
4.  **权限提升:** 覆盖关键内核数据结构，例如当前进程的 Token，将其替换为 SYSTEM 用户的 Token，从而提升权限。

**项目地址:** [SerabiLem/CVE-2025-21333-POC](https://github.com/SerabiLem/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #6

**来源**: [CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md](../2025/CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，本地攻击者可利用该漏洞获得SYSTEM权限

**影响版本:** Windows 10 21H2 (versionStartIncluding: 10.0.19043.0, versionEndExcluding: 10.0.19044.5371), Windows 11 22H2 (versionStartIncluding: 10.0.22621.0, versionEndExcluding: 10.0.22621.4751), Windows 10 22H2 (versionStartIncluding: 10.0.19045.0, versionEndExcluding: 10.0.19045.5371), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows Server 23H2 (versionStartIncluding: 10.0.25398.0, versionEndExcluding: 10.0.25398.1369), Windows 11 24H2 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894)

**利用条件:** 本地访问，需要运行受影响的Windows Hyper-V。

**POC 可用性:** 是，根据搜索结果，存在可用的POC代码

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 特权提升漏洞。该漏洞是由于`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。攻击者可以利用此漏洞在本地获得 SYSTEM 权限。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞影响多个Windows版本，并且CISA已将其列入已知被利用的漏洞目录，表明该漏洞具有实际的利用价值。搜索引擎结果显示存在公开的POC代码，进一步佐证了漏洞的可利用性。

**投毒风险：** 提供的漏洞利用代码是 KQL 查询语句，用于检测与 CVE-2025-21333 相关的可疑活动。代码本身用于安全事件的监控和分析，而非直接的漏洞利用。因此，可以认为该代码的投毒风险较低，但也需要人工审查代码的逻辑，判断是否存在恶意隐藏。例如，代码中可能会被利用来误报，影响正常的安全事件分析，所以投毒风险为 10%。

**利用方式：**  攻击者可以利用该漏洞通过与Hyper-V的NT内核集成VSP相关的组件，触发堆缓冲区溢出，最终获得SYSTEM权限。具体来说，`vkrnlintvsp.sys` 组件在处理来自虚拟机的数据时，如果没有进行充分的边界检查，可能导致缓冲区溢出。根据搜索结果，漏洞存在于主机操作系统和容器类型虚拟机之间的通信组件中。攻击者需要在受影响的系统上执行恶意代码，触发溢出，从而提升权限。实际的利用可能涉及到内存地址的计算、shellcode的注入等技术。

 简而言之，这是一个本地提权漏洞，攻击者通过精心构造的数据包与Hyper-V的内核集成服务进行交互，导致内核堆缓冲区溢出，从而覆盖关键数据并获得SYSTEM权限。

**项目地址:** [aleongx/KQL_sentinel_CVE-2025-21333](https://github.com/aleongx/KQL_sentinel_CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #7

**来源**: [CVE-2025-21333-pradip022_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-pradip022_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V NT Kernel Integration VSP

**危害等级:** 高危，可提升权限

**影响版本:** 受影响的版本包括Windows 10 21H2，Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等，具体版本范围见CVE描述。

**利用条件:** 需要目标系统运行Hyper-V，且虚拟机集成服务（VSP）存在漏洞。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP的权限提升漏洞，这是一个堆溢出漏洞(CWE-122)。根据搜索结果，存在公开的POC代码，并且该漏洞已被积极利用。漏洞利用代码的README.md文件描述了如何下载和运行该POC，指出利用涉及WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY。代码库中提供的Visual Studio解决方案文件，进一步证实了漏洞利用的存在。虽然github仓库描述了POC的简单用法,但是下载地址却指向了另一个github地址,存在诱导下载其他恶意文件的可能性. 同时考虑到windows内核漏洞利用通常需要较高的技术水平，且可能涉及复杂的内存操作, 因此存在投毒风险，风险概率评估为30%。

利用方式：攻击者可以利用此漏洞在Hyper-V环境中提升权限。具体利用方式涉及构造特定的WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY，触发堆溢出，从而执行恶意代码。

**项目地址:** [pradip022/CVE-2025-21333-POC](https://github.com/pradip022/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #8

**来源**: [CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md](../2025/CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2。具体版本范围参考CVE详情。

**利用条件:** 需要Hyper-V环境，guest操作系统执行漏洞利用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP权限提升漏洞，是一个基于堆的缓冲区溢出(CWE-122)。

**有效性评估：**
根据搜索结果和提供的PoC代码，该漏洞的PoC是有效的。搜索引擎结果中提到有writeup，POC代码可用，并且该漏洞已被积极利用。漏洞库信息也表明该漏洞已被CISA加入已知被利用漏洞列表(KEV)。 提供的PoC代码是一个用于演示缓冲区溢出漏洞的demo，虽然它不是直接可用的exp，但是它再现了崩溃行为，并且提供测试环境的搭建方法，以及调试的思路，对于理解漏洞原理非常有帮助。 

**投毒风险分析：**
提供的PoC代码主要由以下部分组成：
*   `LAB_SETUP.md`: 提供实验环境搭建的说明，强调安全措施。
*   `README.md`: 描述项目目标是用于教育和防御研究，不包含exploit代码。
*   `windbg_notes.md`: 提供WinDbg的使用提示。
*   `build.sh`: 用于编译`vuln_demo.c`的脚本。
*   `run_and_crash.md`:  提供运行demo并产生崩溃的指导。
*   `vuln_demo.c`: 包含一个故意存在漏洞的程序，用于演示缓冲区溢出。
*   `reports/analysis.md`: 分析报告模板

综合来看，代码库明确声明了其教育目的，并提供了安全建议以防止滥用。`vuln_demo.c`中的`strcpy`函数存在明显的缓冲区溢出漏洞，这与CVE描述相符。代码库没有发现任何恶意代码或隐藏功能。 投毒的可能来自于作者可能故意留下一些隐蔽的后门代码，例如在`vuln_demo.c`中添加一些不明显的恶意操作，或者在`build.sh`脚本中添加一些下载和执行恶意代码的命令。但考虑到代码的简单性和开源性质，以及作者声明的教育目的，这种可能性较低， 估计投毒风险在5%左右。

**利用方式分析：**
1.  **漏洞原理：** 该漏洞是由于Windows Hyper-V NT Kernel Integration VSP组件中存在堆缓冲区溢出漏洞(CWE-122)。 
2.  **利用步骤：**
    *   攻击者首先需要访问运行Hyper-V的系统，并且最好在Guest操作系统内。
    *   然后，攻击者可以通过向易受攻击的VSP组件发送特制的输入，触发堆缓冲区溢出。
    *   通过精巧的构造输入数据，攻击者可以覆盖相邻的内存区域，从而控制程序的执行流程。
    *   最终，攻击者可以利用此漏洞提升权限，例如从普通用户权限提升到系统管理员权限。
3.  **利用限制：** 漏洞利用需要在启用了Hyper-V的系统上进行，并且可能需要特定的系统配置和权限。


**项目地址:** [rahul0xkr/Hyper-V-CVE-2025-21333-Analysis](https://github.com/rahul0xkr/Hyper-V-CVE-2025-21333-Analysis)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #9

**来源**: [CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md](../2025/CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md)

# CVE-2025-21333

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21333-160102_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-160102_CVE-2025-21333-POC.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致权限提升

**影响版本:** 受影响的Windows版本包括Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等。

**利用条件:** 需要本地访问，在Hyper-V环境中。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP（Virtual Service Provider）权限提升漏洞。根据漏洞信息和搜索结果，该漏洞存在于Hyper-V的NT内核集成组件中，允许攻击者提升权限。漏洞利用代码显示这是一个C++项目，利用了WNF（Windows Notification Facility）状态数据和I/O ring IOP_MC_BUFFER_ENTRY来触发堆缓冲区溢出。该POC的Visual Studio解决方案文件表明它是一个可编译的项目，但存在投毒风险，因为从github下载zip存在未知风险。从代码来看，大量使用了Windows API，直接与内核交互，存在恶意修改内核的可能性，投毒风险评估为20%。利用方式通常包括：

1.  **触发漏洞：** 通过精心构造的WNF状态数据和I/O ring操作，触发NT内核集成组件中的堆缓冲区溢出。
2.  **控制执行流：** 覆盖堆上的关键数据结构，以控制内核的执行流程。
3.  **权限提升：** 通过修改当前进程的Token，将其权限提升到SYSTEM级别。

从搜索结果来看，该漏洞已经被CISA列入已知被利用漏洞目录，表明该漏洞具有较高的实际威胁。

**有效性评估：** 根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的，因为存在可编译的POC，并且CISA已经确认该漏洞被利用。

**投毒风险评估：** 该POC代码存在一定的投毒风险。因为需要下载压缩包，压缩包内部可能包含恶意代码，但主要代码是利用windows api进行操作，函数功能明确，没有发现明显的恶意行为，风险较低。


**项目地址:** [160102/CVE-2025-21333-POC](https://github.com/160102/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #2

**来源**: [CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md](../2025/CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 提权漏洞/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机逃逸，主机权限获取

**影响版本:** 受影响的Windows版本 (见漏洞库信息)

**利用条件:** 需要Guest虚拟机权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (虚拟机服务提供者) 中的提权漏洞，本质是堆溢出。攻击者（虚拟机内的用户）可以利用此漏洞，通过特制的请求导致在主机操作系统内核中发生堆缓冲区溢出，从而获得主机操作系统的管理员权限。

**有效性：**

根据搜索引擎结果，此漏洞已经被公开披露，并且存在公开可用的PoC（例如 GitHub上的`MrAle98/CVE-2025-21333-POC`仓库），表明该漏洞的利用已经得到验证。 漏洞库信息也表明CISA ADP已经将此漏洞添加到已知被利用漏洞列表中，进一步证明了其有效性。

提供的漏洞利用代码`/tmp/32315364bfebb19c9bcece1aca1942c9/README.md` 仅包含CVE编号的信息，本身并没有可执行的利用代码。但是，结合搜索引擎结果，可以找到其他存储库中提供的PoC 代码。

**投毒风险：**

由于提供的代码只是一个包含CVE编号的`README.md`文件，因此直接分析该文件进行投毒判断没有意义。真正的PoC代码位于其他存储库。但是，在实际利用PoC的过程中，需要仔细审查代码，因为PoC代码可能包含恶意修改。 

假设用户下载并执行了某个声称是CVE-2025-21333的PoC代码。 评估投毒风险。鉴于漏洞利用开发和安全研究的复杂性，有以下可能性：

*   **有意后门：** 某些代码作者可能会故意在PoC中添加后门，以便进一步攻击或控制目标系统。风险较高，因为内核漏洞利用通常需要精心的内存操作，很容易隐藏恶意代码。
*   **代码质量问题：** PoC代码可能未经充分测试或包含错误，导致系统崩溃或不稳定。这虽然不是直接的投毒，但也可能对系统造成损害。
*   **依赖项风险：** PoC可能依赖于外部库或组件，这些库或组件本身可能存在漏洞或恶意代码。

考虑到这些因素，初步估计投毒风险为10%。更详细的代码审计可以提供更准确的风险评估。

**利用方式：**

1.  **触发漏洞：** 虚拟机内的攻击者，通过构造恶意的请求发送给Hyper-V主机。
2.  **堆溢出：** 恶意的请求会触发 Hyper-V NT Kernel Integration VSP 组件中的堆缓冲区溢出。
3.  **控制流劫持：** 利用堆溢出覆盖关键内核数据结构，例如函数指针，从而控制内核执行流。
4.  **权限提升：** 执行恶意代码，例如调用`PsLookupProcessByProcessId`和`SeAssignPrivileges`等函数，以提升虚拟机内的进程权限到 SYSTEM。
5.  **虚拟机逃逸：** 利用获得的 SYSTEM 权限，攻击者可以执行虚拟机逃逸操作，例如访问Hyper-V主机的文件系统，甚至控制整个主机。


**项目地址:** [B1ack4sh/Blackash-CVE-2025-21333](https://github.com/B1ack4sh/Blackash-CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #3

**来源**: [CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致系统权限提升

**影响版本:** Windows 10 21H2 (<= 10.0.19044.5371), Windows 11 22H2 (<= 10.0.22621.4751), Windows 10 22H2 (<= 10.0.19045.5371), Windows Server 2025 (<= 10.0.26100.2894), Windows 11 23H2 (<= 10.0.22631.4751), Windows 11 24H2 (<= 10.0.26100.2894), Windows Server 23H2 (<= 10.0.25398.1369)

**利用条件:** 需要Guest OS环境, 并需要利用I/O Ring机制进行攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 的特权提升漏洞。该漏洞是由于内核驱动`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。 

**漏洞利用方式：**

1.  **I/O Ring机制：** PoC利用了Windows I/O Ring机制，通过伪造IOP_MC_BUFFER_ENTRY结构体，从而实现内核任意地址读写。
2.  **堆溢出：** 通过在分页池中分配大量内存，然后触发堆溢出，覆盖IOP_MC_BUFFER_ENTRY结构体指针。
3.  **任意读写：** 覆盖后的`Address`可以指向任意内核地址，从而实现任意地址读写。
4. **提权：** 通过任意读写能力，可以修改当前进程的Token，从而提升权限。

**有效性：**

根据提供的PoC代码和搜索结果，该漏洞PoC的存在，并且已经被CISA列入已知被利用漏洞目录。PoC代码的README描述了如何在Windows 11 23h2上利用此漏洞进行提权，同时也说明了该PoC的可靠性可能不高。

**投毒风险：**

PoC代码本身是一个Visual Studio解决方案，包含C++源代码。 代码主要功能是利用堆溢出和I/O Ring机制实现内核任意地址读写，从而提升权限。审查代码后，发现潜在的投毒风险较低，例如：

*   **复杂性：** 代码相对复杂，阅读和理解需要一定的内核安全知识，增加了隐藏恶意代码的难度。
*   **公开性：** PoC本身是为了演示漏洞利用，作者倾向于公开透明，减少隐藏恶意代码的动机。
    但是，仍然存在一些微小的风险：
*   **细微修改：** 攻击者可能会在PoC代码中添加一些细微的修改，例如修改内存地址或增加延时，从而绕过安全检测。
*   **依赖项：** PoC可能依赖一些外部库或驱动，这些依赖项可能存在安全风险。

综上所述，该PoC代码存在10%的投毒风险，主要是考虑到细微修改和依赖项的潜在风险。


**项目地址:** [MrAle98/CVE-2025-21333-POC](https://github.com/MrAle98/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #4

**来源**: [CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致SYSTEM权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2 等受影响版本

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (Virtual Service Provider) 中的权限提升漏洞。该漏洞是由于 NT 内核集成 VSP 中存在堆缓冲区溢出造成的，攻击者可以利用此漏洞获得 SYSTEM 权限。

**有效性评估：**

根据漏洞描述和搜索结果，该漏洞是一个已知的、存在被利用的漏洞，CISA 已将其添加到已知被利用的漏洞目录中。 Reddit的帖子也表明有人发布了POC。提供的POC代码是一个Visual Studio解决方案，包含C++源代码，这进一步表明该漏洞是可以被利用的。readme描述利用了WNF state data 和 I/O ring IOP_MC_BUFFER_ENTRY，指向了具体利用的技术细节。

**投毒风险评估：**

评估POC代码的投毒风险需要仔细分析代码。从提供的代码片段来看，代码主要涉及Windows API调用，包括内存操作、对象操作、线程管理和进程管理等。初步分析没有发现明显的恶意代码或后门。但是考虑到漏洞利用代码本身的复杂性以及缺乏完整代码，存在一定的投毒风险，例如：

*   **隐蔽的权限提升：** 代码可能包含不易察觉的后门，在提权后执行恶意操作，例如安装恶意软件或收集敏感信息。
*   **代码注入：** 恶意代码可能会注入到其他进程中，从而绕过安全检测。
* **依赖风险:** readme中的链接可能指向恶意网站或包含恶意软件的下载链接。

虽然不能完全排除投毒的可能性，考虑到漏洞利用的复杂性，作者隐藏恶意代码的概率较低，因此暂定投毒风险为10%。

**利用方式分析：**

1.  **漏洞触发：** 攻击者利用Hyper-V NT Kernel Integration VSP中的漏洞，该漏洞位于内核态驱动中，允许从虚拟机内部触发。
2.  **堆溢出：** 利用特定的输入或操作，触发堆缓冲区溢出，覆盖相邻的内存区域。搜索结果表明是Paged Pool中的heap-based buffer overflow
3.  **权限提升：** 通过控制溢出的内容，例如覆盖内核对象或函数指针，攻击者可以将自己的权限提升到SYSTEM。
4.  **执行恶意代码：** 获得SYSTEM权限后，攻击者可以执行任意代码，例如安装恶意软件、窃取数据或控制系统。

**项目地址:** [Mukesh-blend/CVE-2025-21333-POC](https://github.com/Mukesh-blend/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #5

**来源**: [CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机数据泄露、完整性破坏和拒绝服务

**影响版本:** Windows 10 21H2 (版本 10.0.19043.0 到 10.0.19044.5371), Windows 11 22H2 (版本 10.0.22621.0 到 10.0.22621.4751), Windows 10 22H2 (版本 10.0.19045.0 到 10.0.19045.5371), Windows Server 2025 (版本 10.0.26100.0 到 10.0.26100.2894), Windows 11 23H2 (版本 10.0.22631.0 到 10.0.22631.4751), Windows Server 23H2 (版本 10.0.25398.0 到 10.0.25398.1369), Windows 11 24H2 (版本 10.0.26100.0 到 10.0.26100.2894)

**利用条件:** 本地用户权限，需要启用并运行Hyper-V。

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞。根据漏洞描述和搜索结果，攻击者可以利用恶意构造的 Virtual Service Provider (VSP) 来提升权限，最终控制 Hyper-V 主机。这是一个堆溢出漏洞（CWE-122）。

**有效性：**
提供的 POC 代码是一个 Visual Studio 解决方案，包含 C++ 代码。代码中包含Windows头文件，如 `<Windows.h>`, `<ioringapi.h>`和自定义头文件`wnf.h`。通过检查代码，可以发现其中利用了Windows Notification Facility（WNF）状态数据和I/O ring IOP_MC_BUFFER_ENTRY。搜索结果中reddit论坛的帖子也说明这是一个windows内核堆溢出漏洞，并提供了github链接。

**投毒风险：**
提供的代码片段中，最可疑的部分是 `README.md` 文件中提供的下载链接：`[Download Exploit](https://github.com/file/Soft.zip)`。该链接指向一个名为 `Soft.zip` 的 ZIP 文件，从不可信来源下载未经验证的可执行文件具有极高的风险。虽然直接提供的C++代码本身看起来是标准漏洞利用代码，但`README.md`文件中的下载链接是潜在的恶意软件投放点。用户可能被诱导下载包含恶意payload的zip文件，而非真正的漏洞利用程序。因此，存在较高的投毒风险。
另外，`wnf.h`等自定义头文件没有提供，意味着使用者必须自己查找或编写相关代码，这增加了利用难度，也为潜在的投毒留下了空间。攻击者可以提供带有恶意代码的`wnf.h`文件，诱导用户使用。
总体来说，投毒风险较高，估计为80%。

**利用方式：**
1.  **触发漏洞:** 利用特制的 VSP 触发 Hyper-V NT Kernel Integration 中的堆溢出。
2.  **WNF状态数据操控:** 通过操纵WNF状态数据，控制内核内存的布局。
3. **I/O ring IOP_MC_BUFFER_ENTRY：** 通过操控I/O环，控制内核内存的读写。
4.  **权限提升:** 覆盖关键内核数据结构，例如当前进程的 Token，将其替换为 SYSTEM 用户的 Token，从而提升权限。

**项目地址:** [SerabiLem/CVE-2025-21333-POC](https://github.com/SerabiLem/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #6

**来源**: [CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md](../2025/CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，本地攻击者可利用该漏洞获得SYSTEM权限

**影响版本:** Windows 10 21H2 (versionStartIncluding: 10.0.19043.0, versionEndExcluding: 10.0.19044.5371), Windows 11 22H2 (versionStartIncluding: 10.0.22621.0, versionEndExcluding: 10.0.22621.4751), Windows 10 22H2 (versionStartIncluding: 10.0.19045.0, versionEndExcluding: 10.0.19045.5371), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows Server 23H2 (versionStartIncluding: 10.0.25398.0, versionEndExcluding: 10.0.25398.1369), Windows 11 24H2 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894)

**利用条件:** 本地访问，需要运行受影响的Windows Hyper-V。

**POC 可用性:** 是，根据搜索结果，存在可用的POC代码

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 特权提升漏洞。该漏洞是由于`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。攻击者可以利用此漏洞在本地获得 SYSTEM 权限。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞影响多个Windows版本，并且CISA已将其列入已知被利用的漏洞目录，表明该漏洞具有实际的利用价值。搜索引擎结果显示存在公开的POC代码，进一步佐证了漏洞的可利用性。

**投毒风险：** 提供的漏洞利用代码是 KQL 查询语句，用于检测与 CVE-2025-21333 相关的可疑活动。代码本身用于安全事件的监控和分析，而非直接的漏洞利用。因此，可以认为该代码的投毒风险较低，但也需要人工审查代码的逻辑，判断是否存在恶意隐藏。例如，代码中可能会被利用来误报，影响正常的安全事件分析，所以投毒风险为 10%。

**利用方式：**  攻击者可以利用该漏洞通过与Hyper-V的NT内核集成VSP相关的组件，触发堆缓冲区溢出，最终获得SYSTEM权限。具体来说，`vkrnlintvsp.sys` 组件在处理来自虚拟机的数据时，如果没有进行充分的边界检查，可能导致缓冲区溢出。根据搜索结果，漏洞存在于主机操作系统和容器类型虚拟机之间的通信组件中。攻击者需要在受影响的系统上执行恶意代码，触发溢出，从而提升权限。实际的利用可能涉及到内存地址的计算、shellcode的注入等技术。

 简而言之，这是一个本地提权漏洞，攻击者通过精心构造的数据包与Hyper-V的内核集成服务进行交互，导致内核堆缓冲区溢出，从而覆盖关键数据并获得SYSTEM权限。

**项目地址:** [aleongx/KQL_sentinel_CVE-2025-21333](https://github.com/aleongx/KQL_sentinel_CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #7

**来源**: [CVE-2025-21333-pradip022_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-pradip022_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V NT Kernel Integration VSP

**危害等级:** 高危，可提升权限

**影响版本:** 受影响的版本包括Windows 10 21H2，Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等，具体版本范围见CVE描述。

**利用条件:** 需要目标系统运行Hyper-V，且虚拟机集成服务（VSP）存在漏洞。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP的权限提升漏洞，这是一个堆溢出漏洞(CWE-122)。根据搜索结果，存在公开的POC代码，并且该漏洞已被积极利用。漏洞利用代码的README.md文件描述了如何下载和运行该POC，指出利用涉及WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY。代码库中提供的Visual Studio解决方案文件，进一步证实了漏洞利用的存在。虽然github仓库描述了POC的简单用法,但是下载地址却指向了另一个github地址,存在诱导下载其他恶意文件的可能性. 同时考虑到windows内核漏洞利用通常需要较高的技术水平，且可能涉及复杂的内存操作, 因此存在投毒风险，风险概率评估为30%。

利用方式：攻击者可以利用此漏洞在Hyper-V环境中提升权限。具体利用方式涉及构造特定的WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY，触发堆溢出，从而执行恶意代码。

**项目地址:** [pradip022/CVE-2025-21333-POC](https://github.com/pradip022/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #8

**来源**: [CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md](../2025/CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2。具体版本范围参考CVE详情。

**利用条件:** 需要Hyper-V环境，guest操作系统执行漏洞利用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP权限提升漏洞，是一个基于堆的缓冲区溢出(CWE-122)。

**有效性评估：**
根据搜索结果和提供的PoC代码，该漏洞的PoC是有效的。搜索引擎结果中提到有writeup，POC代码可用，并且该漏洞已被积极利用。漏洞库信息也表明该漏洞已被CISA加入已知被利用漏洞列表(KEV)。 提供的PoC代码是一个用于演示缓冲区溢出漏洞的demo，虽然它不是直接可用的exp，但是它再现了崩溃行为，并且提供测试环境的搭建方法，以及调试的思路，对于理解漏洞原理非常有帮助。 

**投毒风险分析：**
提供的PoC代码主要由以下部分组成：
*   `LAB_SETUP.md`: 提供实验环境搭建的说明，强调安全措施。
*   `README.md`: 描述项目目标是用于教育和防御研究，不包含exploit代码。
*   `windbg_notes.md`: 提供WinDbg的使用提示。
*   `build.sh`: 用于编译`vuln_demo.c`的脚本。
*   `run_and_crash.md`:  提供运行demo并产生崩溃的指导。
*   `vuln_demo.c`: 包含一个故意存在漏洞的程序，用于演示缓冲区溢出。
*   `reports/analysis.md`: 分析报告模板

综合来看，代码库明确声明了其教育目的，并提供了安全建议以防止滥用。`vuln_demo.c`中的`strcpy`函数存在明显的缓冲区溢出漏洞，这与CVE描述相符。代码库没有发现任何恶意代码或隐藏功能。 投毒的可能来自于作者可能故意留下一些隐蔽的后门代码，例如在`vuln_demo.c`中添加一些不明显的恶意操作，或者在`build.sh`脚本中添加一些下载和执行恶意代码的命令。但考虑到代码的简单性和开源性质，以及作者声明的教育目的，这种可能性较低， 估计投毒风险在5%左右。

**利用方式分析：**
1.  **漏洞原理：** 该漏洞是由于Windows Hyper-V NT Kernel Integration VSP组件中存在堆缓冲区溢出漏洞(CWE-122)。 
2.  **利用步骤：**
    *   攻击者首先需要访问运行Hyper-V的系统，并且最好在Guest操作系统内。
    *   然后，攻击者可以通过向易受攻击的VSP组件发送特制的输入，触发堆缓冲区溢出。
    *   通过精巧的构造输入数据，攻击者可以覆盖相邻的内存区域，从而控制程序的执行流程。
    *   最终，攻击者可以利用此漏洞提升权限，例如从普通用户权限提升到系统管理员权限。
3.  **利用限制：** 漏洞利用需要在启用了Hyper-V的系统上进行，并且可能需要特定的系统配置和权限。


**项目地址:** [rahul0xkr/Hyper-V-CVE-2025-21333-Analysis](https://github.com/rahul0xkr/Hyper-V-CVE-2025-21333-Analysis)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #9

**来源**: [CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md](../2025/CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md)

# CVE-2025-21333

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21333-160102_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-160102_CVE-2025-21333-POC.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致权限提升

**影响版本:** 受影响的Windows版本包括Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等。

**利用条件:** 需要本地访问，在Hyper-V环境中。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP（Virtual Service Provider）权限提升漏洞。根据漏洞信息和搜索结果，该漏洞存在于Hyper-V的NT内核集成组件中，允许攻击者提升权限。漏洞利用代码显示这是一个C++项目，利用了WNF（Windows Notification Facility）状态数据和I/O ring IOP_MC_BUFFER_ENTRY来触发堆缓冲区溢出。该POC的Visual Studio解决方案文件表明它是一个可编译的项目，但存在投毒风险，因为从github下载zip存在未知风险。从代码来看，大量使用了Windows API，直接与内核交互，存在恶意修改内核的可能性，投毒风险评估为20%。利用方式通常包括：

1.  **触发漏洞：** 通过精心构造的WNF状态数据和I/O ring操作，触发NT内核集成组件中的堆缓冲区溢出。
2.  **控制执行流：** 覆盖堆上的关键数据结构，以控制内核的执行流程。
3.  **权限提升：** 通过修改当前进程的Token，将其权限提升到SYSTEM级别。

从搜索结果来看，该漏洞已经被CISA列入已知被利用漏洞目录，表明该漏洞具有较高的实际威胁。

**有效性评估：** 根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的，因为存在可编译的POC，并且CISA已经确认该漏洞被利用。

**投毒风险评估：** 该POC代码存在一定的投毒风险。因为需要下载压缩包，压缩包内部可能包含恶意代码，但主要代码是利用windows api进行操作，函数功能明确，没有发现明显的恶意行为，风险较低。


**项目地址:** [160102/CVE-2025-21333-POC](https://github.com/160102/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #2

**来源**: [CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md](../2025/CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 提权漏洞/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机逃逸，主机权限获取

**影响版本:** 受影响的Windows版本 (见漏洞库信息)

**利用条件:** 需要Guest虚拟机权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (虚拟机服务提供者) 中的提权漏洞，本质是堆溢出。攻击者（虚拟机内的用户）可以利用此漏洞，通过特制的请求导致在主机操作系统内核中发生堆缓冲区溢出，从而获得主机操作系统的管理员权限。

**有效性：**

根据搜索引擎结果，此漏洞已经被公开披露，并且存在公开可用的PoC（例如 GitHub上的`MrAle98/CVE-2025-21333-POC`仓库），表明该漏洞的利用已经得到验证。 漏洞库信息也表明CISA ADP已经将此漏洞添加到已知被利用漏洞列表中，进一步证明了其有效性。

提供的漏洞利用代码`/tmp/32315364bfebb19c9bcece1aca1942c9/README.md` 仅包含CVE编号的信息，本身并没有可执行的利用代码。但是，结合搜索引擎结果，可以找到其他存储库中提供的PoC 代码。

**投毒风险：**

由于提供的代码只是一个包含CVE编号的`README.md`文件，因此直接分析该文件进行投毒判断没有意义。真正的PoC代码位于其他存储库。但是，在实际利用PoC的过程中，需要仔细审查代码，因为PoC代码可能包含恶意修改。 

假设用户下载并执行了某个声称是CVE-2025-21333的PoC代码。 评估投毒风险。鉴于漏洞利用开发和安全研究的复杂性，有以下可能性：

*   **有意后门：** 某些代码作者可能会故意在PoC中添加后门，以便进一步攻击或控制目标系统。风险较高，因为内核漏洞利用通常需要精心的内存操作，很容易隐藏恶意代码。
*   **代码质量问题：** PoC代码可能未经充分测试或包含错误，导致系统崩溃或不稳定。这虽然不是直接的投毒，但也可能对系统造成损害。
*   **依赖项风险：** PoC可能依赖于外部库或组件，这些库或组件本身可能存在漏洞或恶意代码。

考虑到这些因素，初步估计投毒风险为10%。更详细的代码审计可以提供更准确的风险评估。

**利用方式：**

1.  **触发漏洞：** 虚拟机内的攻击者，通过构造恶意的请求发送给Hyper-V主机。
2.  **堆溢出：** 恶意的请求会触发 Hyper-V NT Kernel Integration VSP 组件中的堆缓冲区溢出。
3.  **控制流劫持：** 利用堆溢出覆盖关键内核数据结构，例如函数指针，从而控制内核执行流。
4.  **权限提升：** 执行恶意代码，例如调用`PsLookupProcessByProcessId`和`SeAssignPrivileges`等函数，以提升虚拟机内的进程权限到 SYSTEM。
5.  **虚拟机逃逸：** 利用获得的 SYSTEM 权限，攻击者可以执行虚拟机逃逸操作，例如访问Hyper-V主机的文件系统，甚至控制整个主机。


**项目地址:** [B1ack4sh/Blackash-CVE-2025-21333](https://github.com/B1ack4sh/Blackash-CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #3

**来源**: [CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致系统权限提升

**影响版本:** Windows 10 21H2 (<= 10.0.19044.5371), Windows 11 22H2 (<= 10.0.22621.4751), Windows 10 22H2 (<= 10.0.19045.5371), Windows Server 2025 (<= 10.0.26100.2894), Windows 11 23H2 (<= 10.0.22631.4751), Windows 11 24H2 (<= 10.0.26100.2894), Windows Server 23H2 (<= 10.0.25398.1369)

**利用条件:** 需要Guest OS环境, 并需要利用I/O Ring机制进行攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 的特权提升漏洞。该漏洞是由于内核驱动`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。 

**漏洞利用方式：**

1.  **I/O Ring机制：** PoC利用了Windows I/O Ring机制，通过伪造IOP_MC_BUFFER_ENTRY结构体，从而实现内核任意地址读写。
2.  **堆溢出：** 通过在分页池中分配大量内存，然后触发堆溢出，覆盖IOP_MC_BUFFER_ENTRY结构体指针。
3.  **任意读写：** 覆盖后的`Address`可以指向任意内核地址，从而实现任意地址读写。
4. **提权：** 通过任意读写能力，可以修改当前进程的Token，从而提升权限。

**有效性：**

根据提供的PoC代码和搜索结果，该漏洞PoC的存在，并且已经被CISA列入已知被利用漏洞目录。PoC代码的README描述了如何在Windows 11 23h2上利用此漏洞进行提权，同时也说明了该PoC的可靠性可能不高。

**投毒风险：**

PoC代码本身是一个Visual Studio解决方案，包含C++源代码。 代码主要功能是利用堆溢出和I/O Ring机制实现内核任意地址读写，从而提升权限。审查代码后，发现潜在的投毒风险较低，例如：

*   **复杂性：** 代码相对复杂，阅读和理解需要一定的内核安全知识，增加了隐藏恶意代码的难度。
*   **公开性：** PoC本身是为了演示漏洞利用，作者倾向于公开透明，减少隐藏恶意代码的动机。
    但是，仍然存在一些微小的风险：
*   **细微修改：** 攻击者可能会在PoC代码中添加一些细微的修改，例如修改内存地址或增加延时，从而绕过安全检测。
*   **依赖项：** PoC可能依赖一些外部库或驱动，这些依赖项可能存在安全风险。

综上所述，该PoC代码存在10%的投毒风险，主要是考虑到细微修改和依赖项的潜在风险。


**项目地址:** [MrAle98/CVE-2025-21333-POC](https://github.com/MrAle98/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #4

**来源**: [CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致SYSTEM权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2 等受影响版本

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (Virtual Service Provider) 中的权限提升漏洞。该漏洞是由于 NT 内核集成 VSP 中存在堆缓冲区溢出造成的，攻击者可以利用此漏洞获得 SYSTEM 权限。

**有效性评估：**

根据漏洞描述和搜索结果，该漏洞是一个已知的、存在被利用的漏洞，CISA 已将其添加到已知被利用的漏洞目录中。 Reddit的帖子也表明有人发布了POC。提供的POC代码是一个Visual Studio解决方案，包含C++源代码，这进一步表明该漏洞是可以被利用的。readme描述利用了WNF state data 和 I/O ring IOP_MC_BUFFER_ENTRY，指向了具体利用的技术细节。

**投毒风险评估：**

评估POC代码的投毒风险需要仔细分析代码。从提供的代码片段来看，代码主要涉及Windows API调用，包括内存操作、对象操作、线程管理和进程管理等。初步分析没有发现明显的恶意代码或后门。但是考虑到漏洞利用代码本身的复杂性以及缺乏完整代码，存在一定的投毒风险，例如：

*   **隐蔽的权限提升：** 代码可能包含不易察觉的后门，在提权后执行恶意操作，例如安装恶意软件或收集敏感信息。
*   **代码注入：** 恶意代码可能会注入到其他进程中，从而绕过安全检测。
* **依赖风险:** readme中的链接可能指向恶意网站或包含恶意软件的下载链接。

虽然不能完全排除投毒的可能性，考虑到漏洞利用的复杂性，作者隐藏恶意代码的概率较低，因此暂定投毒风险为10%。

**利用方式分析：**

1.  **漏洞触发：** 攻击者利用Hyper-V NT Kernel Integration VSP中的漏洞，该漏洞位于内核态驱动中，允许从虚拟机内部触发。
2.  **堆溢出：** 利用特定的输入或操作，触发堆缓冲区溢出，覆盖相邻的内存区域。搜索结果表明是Paged Pool中的heap-based buffer overflow
3.  **权限提升：** 通过控制溢出的内容，例如覆盖内核对象或函数指针，攻击者可以将自己的权限提升到SYSTEM。
4.  **执行恶意代码：** 获得SYSTEM权限后，攻击者可以执行任意代码，例如安装恶意软件、窃取数据或控制系统。

**项目地址:** [Mukesh-blend/CVE-2025-21333-POC](https://github.com/Mukesh-blend/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #5

**来源**: [CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机数据泄露、完整性破坏和拒绝服务

**影响版本:** Windows 10 21H2 (版本 10.0.19043.0 到 10.0.19044.5371), Windows 11 22H2 (版本 10.0.22621.0 到 10.0.22621.4751), Windows 10 22H2 (版本 10.0.19045.0 到 10.0.19045.5371), Windows Server 2025 (版本 10.0.26100.0 到 10.0.26100.2894), Windows 11 23H2 (版本 10.0.22631.0 到 10.0.22631.4751), Windows Server 23H2 (版本 10.0.25398.0 到 10.0.25398.1369), Windows 11 24H2 (版本 10.0.26100.0 到 10.0.26100.2894)

**利用条件:** 本地用户权限，需要启用并运行Hyper-V。

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞。根据漏洞描述和搜索结果，攻击者可以利用恶意构造的 Virtual Service Provider (VSP) 来提升权限，最终控制 Hyper-V 主机。这是一个堆溢出漏洞（CWE-122）。

**有效性：**
提供的 POC 代码是一个 Visual Studio 解决方案，包含 C++ 代码。代码中包含Windows头文件，如 `<Windows.h>`, `<ioringapi.h>`和自定义头文件`wnf.h`。通过检查代码，可以发现其中利用了Windows Notification Facility（WNF）状态数据和I/O ring IOP_MC_BUFFER_ENTRY。搜索结果中reddit论坛的帖子也说明这是一个windows内核堆溢出漏洞，并提供了github链接。

**投毒风险：**
提供的代码片段中，最可疑的部分是 `README.md` 文件中提供的下载链接：`[Download Exploit](https://github.com/file/Soft.zip)`。该链接指向一个名为 `Soft.zip` 的 ZIP 文件，从不可信来源下载未经验证的可执行文件具有极高的风险。虽然直接提供的C++代码本身看起来是标准漏洞利用代码，但`README.md`文件中的下载链接是潜在的恶意软件投放点。用户可能被诱导下载包含恶意payload的zip文件，而非真正的漏洞利用程序。因此，存在较高的投毒风险。
另外，`wnf.h`等自定义头文件没有提供，意味着使用者必须自己查找或编写相关代码，这增加了利用难度，也为潜在的投毒留下了空间。攻击者可以提供带有恶意代码的`wnf.h`文件，诱导用户使用。
总体来说，投毒风险较高，估计为80%。

**利用方式：**
1.  **触发漏洞:** 利用特制的 VSP 触发 Hyper-V NT Kernel Integration 中的堆溢出。
2.  **WNF状态数据操控:** 通过操纵WNF状态数据，控制内核内存的布局。
3. **I/O ring IOP_MC_BUFFER_ENTRY：** 通过操控I/O环，控制内核内存的读写。
4.  **权限提升:** 覆盖关键内核数据结构，例如当前进程的 Token，将其替换为 SYSTEM 用户的 Token，从而提升权限。

**项目地址:** [SerabiLem/CVE-2025-21333-POC](https://github.com/SerabiLem/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #6

**来源**: [CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md](../2025/CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，本地攻击者可利用该漏洞获得SYSTEM权限

**影响版本:** Windows 10 21H2 (versionStartIncluding: 10.0.19043.0, versionEndExcluding: 10.0.19044.5371), Windows 11 22H2 (versionStartIncluding: 10.0.22621.0, versionEndExcluding: 10.0.22621.4751), Windows 10 22H2 (versionStartIncluding: 10.0.19045.0, versionEndExcluding: 10.0.19045.5371), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows Server 23H2 (versionStartIncluding: 10.0.25398.0, versionEndExcluding: 10.0.25398.1369), Windows 11 24H2 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894)

**利用条件:** 本地访问，需要运行受影响的Windows Hyper-V。

**POC 可用性:** 是，根据搜索结果，存在可用的POC代码

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 特权提升漏洞。该漏洞是由于`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。攻击者可以利用此漏洞在本地获得 SYSTEM 权限。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞影响多个Windows版本，并且CISA已将其列入已知被利用的漏洞目录，表明该漏洞具有实际的利用价值。搜索引擎结果显示存在公开的POC代码，进一步佐证了漏洞的可利用性。

**投毒风险：** 提供的漏洞利用代码是 KQL 查询语句，用于检测与 CVE-2025-21333 相关的可疑活动。代码本身用于安全事件的监控和分析，而非直接的漏洞利用。因此，可以认为该代码的投毒风险较低，但也需要人工审查代码的逻辑，判断是否存在恶意隐藏。例如，代码中可能会被利用来误报，影响正常的安全事件分析，所以投毒风险为 10%。

**利用方式：**  攻击者可以利用该漏洞通过与Hyper-V的NT内核集成VSP相关的组件，触发堆缓冲区溢出，最终获得SYSTEM权限。具体来说，`vkrnlintvsp.sys` 组件在处理来自虚拟机的数据时，如果没有进行充分的边界检查，可能导致缓冲区溢出。根据搜索结果，漏洞存在于主机操作系统和容器类型虚拟机之间的通信组件中。攻击者需要在受影响的系统上执行恶意代码，触发溢出，从而提升权限。实际的利用可能涉及到内存地址的计算、shellcode的注入等技术。

 简而言之，这是一个本地提权漏洞，攻击者通过精心构造的数据包与Hyper-V的内核集成服务进行交互，导致内核堆缓冲区溢出，从而覆盖关键数据并获得SYSTEM权限。

**项目地址:** [aleongx/KQL_sentinel_CVE-2025-21333](https://github.com/aleongx/KQL_sentinel_CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #7

**来源**: [CVE-2025-21333-pradip022_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-pradip022_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V NT Kernel Integration VSP

**危害等级:** 高危，可提升权限

**影响版本:** 受影响的版本包括Windows 10 21H2，Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等，具体版本范围见CVE描述。

**利用条件:** 需要目标系统运行Hyper-V，且虚拟机集成服务（VSP）存在漏洞。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP的权限提升漏洞，这是一个堆溢出漏洞(CWE-122)。根据搜索结果，存在公开的POC代码，并且该漏洞已被积极利用。漏洞利用代码的README.md文件描述了如何下载和运行该POC，指出利用涉及WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY。代码库中提供的Visual Studio解决方案文件，进一步证实了漏洞利用的存在。虽然github仓库描述了POC的简单用法,但是下载地址却指向了另一个github地址,存在诱导下载其他恶意文件的可能性. 同时考虑到windows内核漏洞利用通常需要较高的技术水平，且可能涉及复杂的内存操作, 因此存在投毒风险，风险概率评估为30%。

利用方式：攻击者可以利用此漏洞在Hyper-V环境中提升权限。具体利用方式涉及构造特定的WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY，触发堆溢出，从而执行恶意代码。

**项目地址:** [pradip022/CVE-2025-21333-POC](https://github.com/pradip022/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #8

**来源**: [CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md](../2025/CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2。具体版本范围参考CVE详情。

**利用条件:** 需要Hyper-V环境，guest操作系统执行漏洞利用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP权限提升漏洞，是一个基于堆的缓冲区溢出(CWE-122)。

**有效性评估：**
根据搜索结果和提供的PoC代码，该漏洞的PoC是有效的。搜索引擎结果中提到有writeup，POC代码可用，并且该漏洞已被积极利用。漏洞库信息也表明该漏洞已被CISA加入已知被利用漏洞列表(KEV)。 提供的PoC代码是一个用于演示缓冲区溢出漏洞的demo，虽然它不是直接可用的exp，但是它再现了崩溃行为，并且提供测试环境的搭建方法，以及调试的思路，对于理解漏洞原理非常有帮助。 

**投毒风险分析：**
提供的PoC代码主要由以下部分组成：
*   `LAB_SETUP.md`: 提供实验环境搭建的说明，强调安全措施。
*   `README.md`: 描述项目目标是用于教育和防御研究，不包含exploit代码。
*   `windbg_notes.md`: 提供WinDbg的使用提示。
*   `build.sh`: 用于编译`vuln_demo.c`的脚本。
*   `run_and_crash.md`:  提供运行demo并产生崩溃的指导。
*   `vuln_demo.c`: 包含一个故意存在漏洞的程序，用于演示缓冲区溢出。
*   `reports/analysis.md`: 分析报告模板

综合来看，代码库明确声明了其教育目的，并提供了安全建议以防止滥用。`vuln_demo.c`中的`strcpy`函数存在明显的缓冲区溢出漏洞，这与CVE描述相符。代码库没有发现任何恶意代码或隐藏功能。 投毒的可能来自于作者可能故意留下一些隐蔽的后门代码，例如在`vuln_demo.c`中添加一些不明显的恶意操作，或者在`build.sh`脚本中添加一些下载和执行恶意代码的命令。但考虑到代码的简单性和开源性质，以及作者声明的教育目的，这种可能性较低， 估计投毒风险在5%左右。

**利用方式分析：**
1.  **漏洞原理：** 该漏洞是由于Windows Hyper-V NT Kernel Integration VSP组件中存在堆缓冲区溢出漏洞(CWE-122)。 
2.  **利用步骤：**
    *   攻击者首先需要访问运行Hyper-V的系统，并且最好在Guest操作系统内。
    *   然后，攻击者可以通过向易受攻击的VSP组件发送特制的输入，触发堆缓冲区溢出。
    *   通过精巧的构造输入数据，攻击者可以覆盖相邻的内存区域，从而控制程序的执行流程。
    *   最终，攻击者可以利用此漏洞提升权限，例如从普通用户权限提升到系统管理员权限。
3.  **利用限制：** 漏洞利用需要在启用了Hyper-V的系统上进行，并且可能需要特定的系统配置和权限。


**项目地址:** [rahul0xkr/Hyper-V-CVE-2025-21333-Analysis](https://github.com/rahul0xkr/Hyper-V-CVE-2025-21333-Analysis)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #9

**来源**: [CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md](../2025/CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md)

# CVE-2025-21333

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21333-160102_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-160102_CVE-2025-21333-POC.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致权限提升

**影响版本:** 受影响的Windows版本包括Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等。

**利用条件:** 需要本地访问，在Hyper-V环境中。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP（Virtual Service Provider）权限提升漏洞。根据漏洞信息和搜索结果，该漏洞存在于Hyper-V的NT内核集成组件中，允许攻击者提升权限。漏洞利用代码显示这是一个C++项目，利用了WNF（Windows Notification Facility）状态数据和I/O ring IOP_MC_BUFFER_ENTRY来触发堆缓冲区溢出。该POC的Visual Studio解决方案文件表明它是一个可编译的项目，但存在投毒风险，因为从github下载zip存在未知风险。从代码来看，大量使用了Windows API，直接与内核交互，存在恶意修改内核的可能性，投毒风险评估为20%。利用方式通常包括：

1.  **触发漏洞：** 通过精心构造的WNF状态数据和I/O ring操作，触发NT内核集成组件中的堆缓冲区溢出。
2.  **控制执行流：** 覆盖堆上的关键数据结构，以控制内核的执行流程。
3.  **权限提升：** 通过修改当前进程的Token，将其权限提升到SYSTEM级别。

从搜索结果来看，该漏洞已经被CISA列入已知被利用漏洞目录，表明该漏洞具有较高的实际威胁。

**有效性评估：** 根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的，因为存在可编译的POC，并且CISA已经确认该漏洞被利用。

**投毒风险评估：** 该POC代码存在一定的投毒风险。因为需要下载压缩包，压缩包内部可能包含恶意代码，但主要代码是利用windows api进行操作，函数功能明确，没有发现明显的恶意行为，风险较低。


**项目地址:** [160102/CVE-2025-21333-POC](https://github.com/160102/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #2

**来源**: [CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md](../2025/CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 提权漏洞/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机逃逸，主机权限获取

**影响版本:** 受影响的Windows版本 (见漏洞库信息)

**利用条件:** 需要Guest虚拟机权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (虚拟机服务提供者) 中的提权漏洞，本质是堆溢出。攻击者（虚拟机内的用户）可以利用此漏洞，通过特制的请求导致在主机操作系统内核中发生堆缓冲区溢出，从而获得主机操作系统的管理员权限。

**有效性：**

根据搜索引擎结果，此漏洞已经被公开披露，并且存在公开可用的PoC（例如 GitHub上的`MrAle98/CVE-2025-21333-POC`仓库），表明该漏洞的利用已经得到验证。 漏洞库信息也表明CISA ADP已经将此漏洞添加到已知被利用漏洞列表中，进一步证明了其有效性。

提供的漏洞利用代码`/tmp/32315364bfebb19c9bcece1aca1942c9/README.md` 仅包含CVE编号的信息，本身并没有可执行的利用代码。但是，结合搜索引擎结果，可以找到其他存储库中提供的PoC 代码。

**投毒风险：**

由于提供的代码只是一个包含CVE编号的`README.md`文件，因此直接分析该文件进行投毒判断没有意义。真正的PoC代码位于其他存储库。但是，在实际利用PoC的过程中，需要仔细审查代码，因为PoC代码可能包含恶意修改。 

假设用户下载并执行了某个声称是CVE-2025-21333的PoC代码。 评估投毒风险。鉴于漏洞利用开发和安全研究的复杂性，有以下可能性：

*   **有意后门：** 某些代码作者可能会故意在PoC中添加后门，以便进一步攻击或控制目标系统。风险较高，因为内核漏洞利用通常需要精心的内存操作，很容易隐藏恶意代码。
*   **代码质量问题：** PoC代码可能未经充分测试或包含错误，导致系统崩溃或不稳定。这虽然不是直接的投毒，但也可能对系统造成损害。
*   **依赖项风险：** PoC可能依赖于外部库或组件，这些库或组件本身可能存在漏洞或恶意代码。

考虑到这些因素，初步估计投毒风险为10%。更详细的代码审计可以提供更准确的风险评估。

**利用方式：**

1.  **触发漏洞：** 虚拟机内的攻击者，通过构造恶意的请求发送给Hyper-V主机。
2.  **堆溢出：** 恶意的请求会触发 Hyper-V NT Kernel Integration VSP 组件中的堆缓冲区溢出。
3.  **控制流劫持：** 利用堆溢出覆盖关键内核数据结构，例如函数指针，从而控制内核执行流。
4.  **权限提升：** 执行恶意代码，例如调用`PsLookupProcessByProcessId`和`SeAssignPrivileges`等函数，以提升虚拟机内的进程权限到 SYSTEM。
5.  **虚拟机逃逸：** 利用获得的 SYSTEM 权限，攻击者可以执行虚拟机逃逸操作，例如访问Hyper-V主机的文件系统，甚至控制整个主机。


**项目地址:** [B1ack4sh/Blackash-CVE-2025-21333](https://github.com/B1ack4sh/Blackash-CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #3

**来源**: [CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致系统权限提升

**影响版本:** Windows 10 21H2 (<= 10.0.19044.5371), Windows 11 22H2 (<= 10.0.22621.4751), Windows 10 22H2 (<= 10.0.19045.5371), Windows Server 2025 (<= 10.0.26100.2894), Windows 11 23H2 (<= 10.0.22631.4751), Windows 11 24H2 (<= 10.0.26100.2894), Windows Server 23H2 (<= 10.0.25398.1369)

**利用条件:** 需要Guest OS环境, 并需要利用I/O Ring机制进行攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 的特权提升漏洞。该漏洞是由于内核驱动`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。 

**漏洞利用方式：**

1.  **I/O Ring机制：** PoC利用了Windows I/O Ring机制，通过伪造IOP_MC_BUFFER_ENTRY结构体，从而实现内核任意地址读写。
2.  **堆溢出：** 通过在分页池中分配大量内存，然后触发堆溢出，覆盖IOP_MC_BUFFER_ENTRY结构体指针。
3.  **任意读写：** 覆盖后的`Address`可以指向任意内核地址，从而实现任意地址读写。
4. **提权：** 通过任意读写能力，可以修改当前进程的Token，从而提升权限。

**有效性：**

根据提供的PoC代码和搜索结果，该漏洞PoC的存在，并且已经被CISA列入已知被利用漏洞目录。PoC代码的README描述了如何在Windows 11 23h2上利用此漏洞进行提权，同时也说明了该PoC的可靠性可能不高。

**投毒风险：**

PoC代码本身是一个Visual Studio解决方案，包含C++源代码。 代码主要功能是利用堆溢出和I/O Ring机制实现内核任意地址读写，从而提升权限。审查代码后，发现潜在的投毒风险较低，例如：

*   **复杂性：** 代码相对复杂，阅读和理解需要一定的内核安全知识，增加了隐藏恶意代码的难度。
*   **公开性：** PoC本身是为了演示漏洞利用，作者倾向于公开透明，减少隐藏恶意代码的动机。
    但是，仍然存在一些微小的风险：
*   **细微修改：** 攻击者可能会在PoC代码中添加一些细微的修改，例如修改内存地址或增加延时，从而绕过安全检测。
*   **依赖项：** PoC可能依赖一些外部库或驱动，这些依赖项可能存在安全风险。

综上所述，该PoC代码存在10%的投毒风险，主要是考虑到细微修改和依赖项的潜在风险。


**项目地址:** [MrAle98/CVE-2025-21333-POC](https://github.com/MrAle98/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #4

**来源**: [CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致SYSTEM权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2 等受影响版本

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (Virtual Service Provider) 中的权限提升漏洞。该漏洞是由于 NT 内核集成 VSP 中存在堆缓冲区溢出造成的，攻击者可以利用此漏洞获得 SYSTEM 权限。

**有效性评估：**

根据漏洞描述和搜索结果，该漏洞是一个已知的、存在被利用的漏洞，CISA 已将其添加到已知被利用的漏洞目录中。 Reddit的帖子也表明有人发布了POC。提供的POC代码是一个Visual Studio解决方案，包含C++源代码，这进一步表明该漏洞是可以被利用的。readme描述利用了WNF state data 和 I/O ring IOP_MC_BUFFER_ENTRY，指向了具体利用的技术细节。

**投毒风险评估：**

评估POC代码的投毒风险需要仔细分析代码。从提供的代码片段来看，代码主要涉及Windows API调用，包括内存操作、对象操作、线程管理和进程管理等。初步分析没有发现明显的恶意代码或后门。但是考虑到漏洞利用代码本身的复杂性以及缺乏完整代码，存在一定的投毒风险，例如：

*   **隐蔽的权限提升：** 代码可能包含不易察觉的后门，在提权后执行恶意操作，例如安装恶意软件或收集敏感信息。
*   **代码注入：** 恶意代码可能会注入到其他进程中，从而绕过安全检测。
* **依赖风险:** readme中的链接可能指向恶意网站或包含恶意软件的下载链接。

虽然不能完全排除投毒的可能性，考虑到漏洞利用的复杂性，作者隐藏恶意代码的概率较低，因此暂定投毒风险为10%。

**利用方式分析：**

1.  **漏洞触发：** 攻击者利用Hyper-V NT Kernel Integration VSP中的漏洞，该漏洞位于内核态驱动中，允许从虚拟机内部触发。
2.  **堆溢出：** 利用特定的输入或操作，触发堆缓冲区溢出，覆盖相邻的内存区域。搜索结果表明是Paged Pool中的heap-based buffer overflow
3.  **权限提升：** 通过控制溢出的内容，例如覆盖内核对象或函数指针，攻击者可以将自己的权限提升到SYSTEM。
4.  **执行恶意代码：** 获得SYSTEM权限后，攻击者可以执行任意代码，例如安装恶意软件、窃取数据或控制系统。

**项目地址:** [Mukesh-blend/CVE-2025-21333-POC](https://github.com/Mukesh-blend/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #5

**来源**: [CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机数据泄露、完整性破坏和拒绝服务

**影响版本:** Windows 10 21H2 (版本 10.0.19043.0 到 10.0.19044.5371), Windows 11 22H2 (版本 10.0.22621.0 到 10.0.22621.4751), Windows 10 22H2 (版本 10.0.19045.0 到 10.0.19045.5371), Windows Server 2025 (版本 10.0.26100.0 到 10.0.26100.2894), Windows 11 23H2 (版本 10.0.22631.0 到 10.0.22631.4751), Windows Server 23H2 (版本 10.0.25398.0 到 10.0.25398.1369), Windows 11 24H2 (版本 10.0.26100.0 到 10.0.26100.2894)

**利用条件:** 本地用户权限，需要启用并运行Hyper-V。

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞。根据漏洞描述和搜索结果，攻击者可以利用恶意构造的 Virtual Service Provider (VSP) 来提升权限，最终控制 Hyper-V 主机。这是一个堆溢出漏洞（CWE-122）。

**有效性：**
提供的 POC 代码是一个 Visual Studio 解决方案，包含 C++ 代码。代码中包含Windows头文件，如 `<Windows.h>`, `<ioringapi.h>`和自定义头文件`wnf.h`。通过检查代码，可以发现其中利用了Windows Notification Facility（WNF）状态数据和I/O ring IOP_MC_BUFFER_ENTRY。搜索结果中reddit论坛的帖子也说明这是一个windows内核堆溢出漏洞，并提供了github链接。

**投毒风险：**
提供的代码片段中，最可疑的部分是 `README.md` 文件中提供的下载链接：`[Download Exploit](https://github.com/file/Soft.zip)`。该链接指向一个名为 `Soft.zip` 的 ZIP 文件，从不可信来源下载未经验证的可执行文件具有极高的风险。虽然直接提供的C++代码本身看起来是标准漏洞利用代码，但`README.md`文件中的下载链接是潜在的恶意软件投放点。用户可能被诱导下载包含恶意payload的zip文件，而非真正的漏洞利用程序。因此，存在较高的投毒风险。
另外，`wnf.h`等自定义头文件没有提供，意味着使用者必须自己查找或编写相关代码，这增加了利用难度，也为潜在的投毒留下了空间。攻击者可以提供带有恶意代码的`wnf.h`文件，诱导用户使用。
总体来说，投毒风险较高，估计为80%。

**利用方式：**
1.  **触发漏洞:** 利用特制的 VSP 触发 Hyper-V NT Kernel Integration 中的堆溢出。
2.  **WNF状态数据操控:** 通过操纵WNF状态数据，控制内核内存的布局。
3. **I/O ring IOP_MC_BUFFER_ENTRY：** 通过操控I/O环，控制内核内存的读写。
4.  **权限提升:** 覆盖关键内核数据结构，例如当前进程的 Token，将其替换为 SYSTEM 用户的 Token，从而提升权限。

**项目地址:** [SerabiLem/CVE-2025-21333-POC](https://github.com/SerabiLem/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #6

**来源**: [CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md](../2025/CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，本地攻击者可利用该漏洞获得SYSTEM权限

**影响版本:** Windows 10 21H2 (versionStartIncluding: 10.0.19043.0, versionEndExcluding: 10.0.19044.5371), Windows 11 22H2 (versionStartIncluding: 10.0.22621.0, versionEndExcluding: 10.0.22621.4751), Windows 10 22H2 (versionStartIncluding: 10.0.19045.0, versionEndExcluding: 10.0.19045.5371), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows Server 23H2 (versionStartIncluding: 10.0.25398.0, versionEndExcluding: 10.0.25398.1369), Windows 11 24H2 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894)

**利用条件:** 本地访问，需要运行受影响的Windows Hyper-V。

**POC 可用性:** 是，根据搜索结果，存在可用的POC代码

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 特权提升漏洞。该漏洞是由于`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。攻击者可以利用此漏洞在本地获得 SYSTEM 权限。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞影响多个Windows版本，并且CISA已将其列入已知被利用的漏洞目录，表明该漏洞具有实际的利用价值。搜索引擎结果显示存在公开的POC代码，进一步佐证了漏洞的可利用性。

**投毒风险：** 提供的漏洞利用代码是 KQL 查询语句，用于检测与 CVE-2025-21333 相关的可疑活动。代码本身用于安全事件的监控和分析，而非直接的漏洞利用。因此，可以认为该代码的投毒风险较低，但也需要人工审查代码的逻辑，判断是否存在恶意隐藏。例如，代码中可能会被利用来误报，影响正常的安全事件分析，所以投毒风险为 10%。

**利用方式：**  攻击者可以利用该漏洞通过与Hyper-V的NT内核集成VSP相关的组件，触发堆缓冲区溢出，最终获得SYSTEM权限。具体来说，`vkrnlintvsp.sys` 组件在处理来自虚拟机的数据时，如果没有进行充分的边界检查，可能导致缓冲区溢出。根据搜索结果，漏洞存在于主机操作系统和容器类型虚拟机之间的通信组件中。攻击者需要在受影响的系统上执行恶意代码，触发溢出，从而提升权限。实际的利用可能涉及到内存地址的计算、shellcode的注入等技术。

 简而言之，这是一个本地提权漏洞，攻击者通过精心构造的数据包与Hyper-V的内核集成服务进行交互，导致内核堆缓冲区溢出，从而覆盖关键数据并获得SYSTEM权限。

**项目地址:** [aleongx/KQL_sentinel_CVE-2025-21333](https://github.com/aleongx/KQL_sentinel_CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #7

**来源**: [CVE-2025-21333-pradip022_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-pradip022_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V NT Kernel Integration VSP

**危害等级:** 高危，可提升权限

**影响版本:** 受影响的版本包括Windows 10 21H2，Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等，具体版本范围见CVE描述。

**利用条件:** 需要目标系统运行Hyper-V，且虚拟机集成服务（VSP）存在漏洞。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP的权限提升漏洞，这是一个堆溢出漏洞(CWE-122)。根据搜索结果，存在公开的POC代码，并且该漏洞已被积极利用。漏洞利用代码的README.md文件描述了如何下载和运行该POC，指出利用涉及WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY。代码库中提供的Visual Studio解决方案文件，进一步证实了漏洞利用的存在。虽然github仓库描述了POC的简单用法,但是下载地址却指向了另一个github地址,存在诱导下载其他恶意文件的可能性. 同时考虑到windows内核漏洞利用通常需要较高的技术水平，且可能涉及复杂的内存操作, 因此存在投毒风险，风险概率评估为30%。

利用方式：攻击者可以利用此漏洞在Hyper-V环境中提升权限。具体利用方式涉及构造特定的WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY，触发堆溢出，从而执行恶意代码。

**项目地址:** [pradip022/CVE-2025-21333-POC](https://github.com/pradip022/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #8

**来源**: [CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md](../2025/CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2。具体版本范围参考CVE详情。

**利用条件:** 需要Hyper-V环境，guest操作系统执行漏洞利用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP权限提升漏洞，是一个基于堆的缓冲区溢出(CWE-122)。

**有效性评估：**
根据搜索结果和提供的PoC代码，该漏洞的PoC是有效的。搜索引擎结果中提到有writeup，POC代码可用，并且该漏洞已被积极利用。漏洞库信息也表明该漏洞已被CISA加入已知被利用漏洞列表(KEV)。 提供的PoC代码是一个用于演示缓冲区溢出漏洞的demo，虽然它不是直接可用的exp，但是它再现了崩溃行为，并且提供测试环境的搭建方法，以及调试的思路，对于理解漏洞原理非常有帮助。 

**投毒风险分析：**
提供的PoC代码主要由以下部分组成：
*   `LAB_SETUP.md`: 提供实验环境搭建的说明，强调安全措施。
*   `README.md`: 描述项目目标是用于教育和防御研究，不包含exploit代码。
*   `windbg_notes.md`: 提供WinDbg的使用提示。
*   `build.sh`: 用于编译`vuln_demo.c`的脚本。
*   `run_and_crash.md`:  提供运行demo并产生崩溃的指导。
*   `vuln_demo.c`: 包含一个故意存在漏洞的程序，用于演示缓冲区溢出。
*   `reports/analysis.md`: 分析报告模板

综合来看，代码库明确声明了其教育目的，并提供了安全建议以防止滥用。`vuln_demo.c`中的`strcpy`函数存在明显的缓冲区溢出漏洞，这与CVE描述相符。代码库没有发现任何恶意代码或隐藏功能。 投毒的可能来自于作者可能故意留下一些隐蔽的后门代码，例如在`vuln_demo.c`中添加一些不明显的恶意操作，或者在`build.sh`脚本中添加一些下载和执行恶意代码的命令。但考虑到代码的简单性和开源性质，以及作者声明的教育目的，这种可能性较低， 估计投毒风险在5%左右。

**利用方式分析：**
1.  **漏洞原理：** 该漏洞是由于Windows Hyper-V NT Kernel Integration VSP组件中存在堆缓冲区溢出漏洞(CWE-122)。 
2.  **利用步骤：**
    *   攻击者首先需要访问运行Hyper-V的系统，并且最好在Guest操作系统内。
    *   然后，攻击者可以通过向易受攻击的VSP组件发送特制的输入，触发堆缓冲区溢出。
    *   通过精巧的构造输入数据，攻击者可以覆盖相邻的内存区域，从而控制程序的执行流程。
    *   最终，攻击者可以利用此漏洞提升权限，例如从普通用户权限提升到系统管理员权限。
3.  **利用限制：** 漏洞利用需要在启用了Hyper-V的系统上进行，并且可能需要特定的系统配置和权限。


**项目地址:** [rahul0xkr/Hyper-V-CVE-2025-21333-Analysis](https://github.com/rahul0xkr/Hyper-V-CVE-2025-21333-Analysis)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #9

**来源**: [CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md](../2025/CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md)

# CVE-2025-21333

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21333-160102_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-160102_CVE-2025-21333-POC.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致权限提升

**影响版本:** 受影响的Windows版本包括Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等。

**利用条件:** 需要本地访问，在Hyper-V环境中。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP（Virtual Service Provider）权限提升漏洞。根据漏洞信息和搜索结果，该漏洞存在于Hyper-V的NT内核集成组件中，允许攻击者提升权限。漏洞利用代码显示这是一个C++项目，利用了WNF（Windows Notification Facility）状态数据和I/O ring IOP_MC_BUFFER_ENTRY来触发堆缓冲区溢出。该POC的Visual Studio解决方案文件表明它是一个可编译的项目，但存在投毒风险，因为从github下载zip存在未知风险。从代码来看，大量使用了Windows API，直接与内核交互，存在恶意修改内核的可能性，投毒风险评估为20%。利用方式通常包括：

1.  **触发漏洞：** 通过精心构造的WNF状态数据和I/O ring操作，触发NT内核集成组件中的堆缓冲区溢出。
2.  **控制执行流：** 覆盖堆上的关键数据结构，以控制内核的执行流程。
3.  **权限提升：** 通过修改当前进程的Token，将其权限提升到SYSTEM级别。

从搜索结果来看，该漏洞已经被CISA列入已知被利用漏洞目录，表明该漏洞具有较高的实际威胁。

**有效性评估：** 根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的，因为存在可编译的POC，并且CISA已经确认该漏洞被利用。

**投毒风险评估：** 该POC代码存在一定的投毒风险。因为需要下载压缩包，压缩包内部可能包含恶意代码，但主要代码是利用windows api进行操作，函数功能明确，没有发现明显的恶意行为，风险较低。


**项目地址:** [160102/CVE-2025-21333-POC](https://github.com/160102/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #2

**来源**: [CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md](../2025/CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 提权漏洞/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机逃逸，主机权限获取

**影响版本:** 受影响的Windows版本 (见漏洞库信息)

**利用条件:** 需要Guest虚拟机权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (虚拟机服务提供者) 中的提权漏洞，本质是堆溢出。攻击者（虚拟机内的用户）可以利用此漏洞，通过特制的请求导致在主机操作系统内核中发生堆缓冲区溢出，从而获得主机操作系统的管理员权限。

**有效性：**

根据搜索引擎结果，此漏洞已经被公开披露，并且存在公开可用的PoC（例如 GitHub上的`MrAle98/CVE-2025-21333-POC`仓库），表明该漏洞的利用已经得到验证。 漏洞库信息也表明CISA ADP已经将此漏洞添加到已知被利用漏洞列表中，进一步证明了其有效性。

提供的漏洞利用代码`/tmp/32315364bfebb19c9bcece1aca1942c9/README.md` 仅包含CVE编号的信息，本身并没有可执行的利用代码。但是，结合搜索引擎结果，可以找到其他存储库中提供的PoC 代码。

**投毒风险：**

由于提供的代码只是一个包含CVE编号的`README.md`文件，因此直接分析该文件进行投毒判断没有意义。真正的PoC代码位于其他存储库。但是，在实际利用PoC的过程中，需要仔细审查代码，因为PoC代码可能包含恶意修改。 

假设用户下载并执行了某个声称是CVE-2025-21333的PoC代码。 评估投毒风险。鉴于漏洞利用开发和安全研究的复杂性，有以下可能性：

*   **有意后门：** 某些代码作者可能会故意在PoC中添加后门，以便进一步攻击或控制目标系统。风险较高，因为内核漏洞利用通常需要精心的内存操作，很容易隐藏恶意代码。
*   **代码质量问题：** PoC代码可能未经充分测试或包含错误，导致系统崩溃或不稳定。这虽然不是直接的投毒，但也可能对系统造成损害。
*   **依赖项风险：** PoC可能依赖于外部库或组件，这些库或组件本身可能存在漏洞或恶意代码。

考虑到这些因素，初步估计投毒风险为10%。更详细的代码审计可以提供更准确的风险评估。

**利用方式：**

1.  **触发漏洞：** 虚拟机内的攻击者，通过构造恶意的请求发送给Hyper-V主机。
2.  **堆溢出：** 恶意的请求会触发 Hyper-V NT Kernel Integration VSP 组件中的堆缓冲区溢出。
3.  **控制流劫持：** 利用堆溢出覆盖关键内核数据结构，例如函数指针，从而控制内核执行流。
4.  **权限提升：** 执行恶意代码，例如调用`PsLookupProcessByProcessId`和`SeAssignPrivileges`等函数，以提升虚拟机内的进程权限到 SYSTEM。
5.  **虚拟机逃逸：** 利用获得的 SYSTEM 权限，攻击者可以执行虚拟机逃逸操作，例如访问Hyper-V主机的文件系统，甚至控制整个主机。


**项目地址:** [B1ack4sh/Blackash-CVE-2025-21333](https://github.com/B1ack4sh/Blackash-CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #3

**来源**: [CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致系统权限提升

**影响版本:** Windows 10 21H2 (<= 10.0.19044.5371), Windows 11 22H2 (<= 10.0.22621.4751), Windows 10 22H2 (<= 10.0.19045.5371), Windows Server 2025 (<= 10.0.26100.2894), Windows 11 23H2 (<= 10.0.22631.4751), Windows 11 24H2 (<= 10.0.26100.2894), Windows Server 23H2 (<= 10.0.25398.1369)

**利用条件:** 需要Guest OS环境, 并需要利用I/O Ring机制进行攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 的特权提升漏洞。该漏洞是由于内核驱动`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。 

**漏洞利用方式：**

1.  **I/O Ring机制：** PoC利用了Windows I/O Ring机制，通过伪造IOP_MC_BUFFER_ENTRY结构体，从而实现内核任意地址读写。
2.  **堆溢出：** 通过在分页池中分配大量内存，然后触发堆溢出，覆盖IOP_MC_BUFFER_ENTRY结构体指针。
3.  **任意读写：** 覆盖后的`Address`可以指向任意内核地址，从而实现任意地址读写。
4. **提权：** 通过任意读写能力，可以修改当前进程的Token，从而提升权限。

**有效性：**

根据提供的PoC代码和搜索结果，该漏洞PoC的存在，并且已经被CISA列入已知被利用漏洞目录。PoC代码的README描述了如何在Windows 11 23h2上利用此漏洞进行提权，同时也说明了该PoC的可靠性可能不高。

**投毒风险：**

PoC代码本身是一个Visual Studio解决方案，包含C++源代码。 代码主要功能是利用堆溢出和I/O Ring机制实现内核任意地址读写，从而提升权限。审查代码后，发现潜在的投毒风险较低，例如：

*   **复杂性：** 代码相对复杂，阅读和理解需要一定的内核安全知识，增加了隐藏恶意代码的难度。
*   **公开性：** PoC本身是为了演示漏洞利用，作者倾向于公开透明，减少隐藏恶意代码的动机。
    但是，仍然存在一些微小的风险：
*   **细微修改：** 攻击者可能会在PoC代码中添加一些细微的修改，例如修改内存地址或增加延时，从而绕过安全检测。
*   **依赖项：** PoC可能依赖一些外部库或驱动，这些依赖项可能存在安全风险。

综上所述，该PoC代码存在10%的投毒风险，主要是考虑到细微修改和依赖项的潜在风险。


**项目地址:** [MrAle98/CVE-2025-21333-POC](https://github.com/MrAle98/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #4

**来源**: [CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致SYSTEM权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2 等受影响版本

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (Virtual Service Provider) 中的权限提升漏洞。该漏洞是由于 NT 内核集成 VSP 中存在堆缓冲区溢出造成的，攻击者可以利用此漏洞获得 SYSTEM 权限。

**有效性评估：**

根据漏洞描述和搜索结果，该漏洞是一个已知的、存在被利用的漏洞，CISA 已将其添加到已知被利用的漏洞目录中。 Reddit的帖子也表明有人发布了POC。提供的POC代码是一个Visual Studio解决方案，包含C++源代码，这进一步表明该漏洞是可以被利用的。readme描述利用了WNF state data 和 I/O ring IOP_MC_BUFFER_ENTRY，指向了具体利用的技术细节。

**投毒风险评估：**

评估POC代码的投毒风险需要仔细分析代码。从提供的代码片段来看，代码主要涉及Windows API调用，包括内存操作、对象操作、线程管理和进程管理等。初步分析没有发现明显的恶意代码或后门。但是考虑到漏洞利用代码本身的复杂性以及缺乏完整代码，存在一定的投毒风险，例如：

*   **隐蔽的权限提升：** 代码可能包含不易察觉的后门，在提权后执行恶意操作，例如安装恶意软件或收集敏感信息。
*   **代码注入：** 恶意代码可能会注入到其他进程中，从而绕过安全检测。
* **依赖风险:** readme中的链接可能指向恶意网站或包含恶意软件的下载链接。

虽然不能完全排除投毒的可能性，考虑到漏洞利用的复杂性，作者隐藏恶意代码的概率较低，因此暂定投毒风险为10%。

**利用方式分析：**

1.  **漏洞触发：** 攻击者利用Hyper-V NT Kernel Integration VSP中的漏洞，该漏洞位于内核态驱动中，允许从虚拟机内部触发。
2.  **堆溢出：** 利用特定的输入或操作，触发堆缓冲区溢出，覆盖相邻的内存区域。搜索结果表明是Paged Pool中的heap-based buffer overflow
3.  **权限提升：** 通过控制溢出的内容，例如覆盖内核对象或函数指针，攻击者可以将自己的权限提升到SYSTEM。
4.  **执行恶意代码：** 获得SYSTEM权限后，攻击者可以执行任意代码，例如安装恶意软件、窃取数据或控制系统。

**项目地址:** [Mukesh-blend/CVE-2025-21333-POC](https://github.com/Mukesh-blend/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #5

**来源**: [CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机数据泄露、完整性破坏和拒绝服务

**影响版本:** Windows 10 21H2 (版本 10.0.19043.0 到 10.0.19044.5371), Windows 11 22H2 (版本 10.0.22621.0 到 10.0.22621.4751), Windows 10 22H2 (版本 10.0.19045.0 到 10.0.19045.5371), Windows Server 2025 (版本 10.0.26100.0 到 10.0.26100.2894), Windows 11 23H2 (版本 10.0.22631.0 到 10.0.22631.4751), Windows Server 23H2 (版本 10.0.25398.0 到 10.0.25398.1369), Windows 11 24H2 (版本 10.0.26100.0 到 10.0.26100.2894)

**利用条件:** 本地用户权限，需要启用并运行Hyper-V。

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞。根据漏洞描述和搜索结果，攻击者可以利用恶意构造的 Virtual Service Provider (VSP) 来提升权限，最终控制 Hyper-V 主机。这是一个堆溢出漏洞（CWE-122）。

**有效性：**
提供的 POC 代码是一个 Visual Studio 解决方案，包含 C++ 代码。代码中包含Windows头文件，如 `<Windows.h>`, `<ioringapi.h>`和自定义头文件`wnf.h`。通过检查代码，可以发现其中利用了Windows Notification Facility（WNF）状态数据和I/O ring IOP_MC_BUFFER_ENTRY。搜索结果中reddit论坛的帖子也说明这是一个windows内核堆溢出漏洞，并提供了github链接。

**投毒风险：**
提供的代码片段中，最可疑的部分是 `README.md` 文件中提供的下载链接：`[Download Exploit](https://github.com/file/Soft.zip)`。该链接指向一个名为 `Soft.zip` 的 ZIP 文件，从不可信来源下载未经验证的可执行文件具有极高的风险。虽然直接提供的C++代码本身看起来是标准漏洞利用代码，但`README.md`文件中的下载链接是潜在的恶意软件投放点。用户可能被诱导下载包含恶意payload的zip文件，而非真正的漏洞利用程序。因此，存在较高的投毒风险。
另外，`wnf.h`等自定义头文件没有提供，意味着使用者必须自己查找或编写相关代码，这增加了利用难度，也为潜在的投毒留下了空间。攻击者可以提供带有恶意代码的`wnf.h`文件，诱导用户使用。
总体来说，投毒风险较高，估计为80%。

**利用方式：**
1.  **触发漏洞:** 利用特制的 VSP 触发 Hyper-V NT Kernel Integration 中的堆溢出。
2.  **WNF状态数据操控:** 通过操纵WNF状态数据，控制内核内存的布局。
3. **I/O ring IOP_MC_BUFFER_ENTRY：** 通过操控I/O环，控制内核内存的读写。
4.  **权限提升:** 覆盖关键内核数据结构，例如当前进程的 Token，将其替换为 SYSTEM 用户的 Token，从而提升权限。

**项目地址:** [SerabiLem/CVE-2025-21333-POC](https://github.com/SerabiLem/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #6

**来源**: [CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md](../2025/CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，本地攻击者可利用该漏洞获得SYSTEM权限

**影响版本:** Windows 10 21H2 (versionStartIncluding: 10.0.19043.0, versionEndExcluding: 10.0.19044.5371), Windows 11 22H2 (versionStartIncluding: 10.0.22621.0, versionEndExcluding: 10.0.22621.4751), Windows 10 22H2 (versionStartIncluding: 10.0.19045.0, versionEndExcluding: 10.0.19045.5371), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows Server 23H2 (versionStartIncluding: 10.0.25398.0, versionEndExcluding: 10.0.25398.1369), Windows 11 24H2 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894)

**利用条件:** 本地访问，需要运行受影响的Windows Hyper-V。

**POC 可用性:** 是，根据搜索结果，存在可用的POC代码

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 特权提升漏洞。该漏洞是由于`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。攻击者可以利用此漏洞在本地获得 SYSTEM 权限。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞影响多个Windows版本，并且CISA已将其列入已知被利用的漏洞目录，表明该漏洞具有实际的利用价值。搜索引擎结果显示存在公开的POC代码，进一步佐证了漏洞的可利用性。

**投毒风险：** 提供的漏洞利用代码是 KQL 查询语句，用于检测与 CVE-2025-21333 相关的可疑活动。代码本身用于安全事件的监控和分析，而非直接的漏洞利用。因此，可以认为该代码的投毒风险较低，但也需要人工审查代码的逻辑，判断是否存在恶意隐藏。例如，代码中可能会被利用来误报，影响正常的安全事件分析，所以投毒风险为 10%。

**利用方式：**  攻击者可以利用该漏洞通过与Hyper-V的NT内核集成VSP相关的组件，触发堆缓冲区溢出，最终获得SYSTEM权限。具体来说，`vkrnlintvsp.sys` 组件在处理来自虚拟机的数据时，如果没有进行充分的边界检查，可能导致缓冲区溢出。根据搜索结果，漏洞存在于主机操作系统和容器类型虚拟机之间的通信组件中。攻击者需要在受影响的系统上执行恶意代码，触发溢出，从而提升权限。实际的利用可能涉及到内存地址的计算、shellcode的注入等技术。

 简而言之，这是一个本地提权漏洞，攻击者通过精心构造的数据包与Hyper-V的内核集成服务进行交互，导致内核堆缓冲区溢出，从而覆盖关键数据并获得SYSTEM权限。

**项目地址:** [aleongx/KQL_sentinel_CVE-2025-21333](https://github.com/aleongx/KQL_sentinel_CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #7

**来源**: [CVE-2025-21333-pradip022_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-pradip022_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V NT Kernel Integration VSP

**危害等级:** 高危，可提升权限

**影响版本:** 受影响的版本包括Windows 10 21H2，Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等，具体版本范围见CVE描述。

**利用条件:** 需要目标系统运行Hyper-V，且虚拟机集成服务（VSP）存在漏洞。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP的权限提升漏洞，这是一个堆溢出漏洞(CWE-122)。根据搜索结果，存在公开的POC代码，并且该漏洞已被积极利用。漏洞利用代码的README.md文件描述了如何下载和运行该POC，指出利用涉及WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY。代码库中提供的Visual Studio解决方案文件，进一步证实了漏洞利用的存在。虽然github仓库描述了POC的简单用法,但是下载地址却指向了另一个github地址,存在诱导下载其他恶意文件的可能性. 同时考虑到windows内核漏洞利用通常需要较高的技术水平，且可能涉及复杂的内存操作, 因此存在投毒风险，风险概率评估为30%。

利用方式：攻击者可以利用此漏洞在Hyper-V环境中提升权限。具体利用方式涉及构造特定的WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY，触发堆溢出，从而执行恶意代码。

**项目地址:** [pradip022/CVE-2025-21333-POC](https://github.com/pradip022/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #8

**来源**: [CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md](../2025/CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2。具体版本范围参考CVE详情。

**利用条件:** 需要Hyper-V环境，guest操作系统执行漏洞利用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP权限提升漏洞，是一个基于堆的缓冲区溢出(CWE-122)。

**有效性评估：**
根据搜索结果和提供的PoC代码，该漏洞的PoC是有效的。搜索引擎结果中提到有writeup，POC代码可用，并且该漏洞已被积极利用。漏洞库信息也表明该漏洞已被CISA加入已知被利用漏洞列表(KEV)。 提供的PoC代码是一个用于演示缓冲区溢出漏洞的demo，虽然它不是直接可用的exp，但是它再现了崩溃行为，并且提供测试环境的搭建方法，以及调试的思路，对于理解漏洞原理非常有帮助。 

**投毒风险分析：**
提供的PoC代码主要由以下部分组成：
*   `LAB_SETUP.md`: 提供实验环境搭建的说明，强调安全措施。
*   `README.md`: 描述项目目标是用于教育和防御研究，不包含exploit代码。
*   `windbg_notes.md`: 提供WinDbg的使用提示。
*   `build.sh`: 用于编译`vuln_demo.c`的脚本。
*   `run_and_crash.md`:  提供运行demo并产生崩溃的指导。
*   `vuln_demo.c`: 包含一个故意存在漏洞的程序，用于演示缓冲区溢出。
*   `reports/analysis.md`: 分析报告模板

综合来看，代码库明确声明了其教育目的，并提供了安全建议以防止滥用。`vuln_demo.c`中的`strcpy`函数存在明显的缓冲区溢出漏洞，这与CVE描述相符。代码库没有发现任何恶意代码或隐藏功能。 投毒的可能来自于作者可能故意留下一些隐蔽的后门代码，例如在`vuln_demo.c`中添加一些不明显的恶意操作，或者在`build.sh`脚本中添加一些下载和执行恶意代码的命令。但考虑到代码的简单性和开源性质，以及作者声明的教育目的，这种可能性较低， 估计投毒风险在5%左右。

**利用方式分析：**
1.  **漏洞原理：** 该漏洞是由于Windows Hyper-V NT Kernel Integration VSP组件中存在堆缓冲区溢出漏洞(CWE-122)。 
2.  **利用步骤：**
    *   攻击者首先需要访问运行Hyper-V的系统，并且最好在Guest操作系统内。
    *   然后，攻击者可以通过向易受攻击的VSP组件发送特制的输入，触发堆缓冲区溢出。
    *   通过精巧的构造输入数据，攻击者可以覆盖相邻的内存区域，从而控制程序的执行流程。
    *   最终，攻击者可以利用此漏洞提升权限，例如从普通用户权限提升到系统管理员权限。
3.  **利用限制：** 漏洞利用需要在启用了Hyper-V的系统上进行，并且可能需要特定的系统配置和权限。


**项目地址:** [rahul0xkr/Hyper-V-CVE-2025-21333-Analysis](https://github.com/rahul0xkr/Hyper-V-CVE-2025-21333-Analysis)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #9

**来源**: [CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md](../2025/CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md)

# CVE-2025-21333

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21333-160102_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-160102_CVE-2025-21333-POC.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致权限提升

**影响版本:** 受影响的Windows版本包括Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等。

**利用条件:** 需要本地访问，在Hyper-V环境中。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP（Virtual Service Provider）权限提升漏洞。根据漏洞信息和搜索结果，该漏洞存在于Hyper-V的NT内核集成组件中，允许攻击者提升权限。漏洞利用代码显示这是一个C++项目，利用了WNF（Windows Notification Facility）状态数据和I/O ring IOP_MC_BUFFER_ENTRY来触发堆缓冲区溢出。该POC的Visual Studio解决方案文件表明它是一个可编译的项目，但存在投毒风险，因为从github下载zip存在未知风险。从代码来看，大量使用了Windows API，直接与内核交互，存在恶意修改内核的可能性，投毒风险评估为20%。利用方式通常包括：

1.  **触发漏洞：** 通过精心构造的WNF状态数据和I/O ring操作，触发NT内核集成组件中的堆缓冲区溢出。
2.  **控制执行流：** 覆盖堆上的关键数据结构，以控制内核的执行流程。
3.  **权限提升：** 通过修改当前进程的Token，将其权限提升到SYSTEM级别。

从搜索结果来看，该漏洞已经被CISA列入已知被利用漏洞目录，表明该漏洞具有较高的实际威胁。

**有效性评估：** 根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的，因为存在可编译的POC，并且CISA已经确认该漏洞被利用。

**投毒风险评估：** 该POC代码存在一定的投毒风险。因为需要下载压缩包，压缩包内部可能包含恶意代码，但主要代码是利用windows api进行操作，函数功能明确，没有发现明显的恶意行为，风险较低。


**项目地址:** [160102/CVE-2025-21333-POC](https://github.com/160102/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #2

**来源**: [CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md](../2025/CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 提权漏洞/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机逃逸，主机权限获取

**影响版本:** 受影响的Windows版本 (见漏洞库信息)

**利用条件:** 需要Guest虚拟机权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (虚拟机服务提供者) 中的提权漏洞，本质是堆溢出。攻击者（虚拟机内的用户）可以利用此漏洞，通过特制的请求导致在主机操作系统内核中发生堆缓冲区溢出，从而获得主机操作系统的管理员权限。

**有效性：**

根据搜索引擎结果，此漏洞已经被公开披露，并且存在公开可用的PoC（例如 GitHub上的`MrAle98/CVE-2025-21333-POC`仓库），表明该漏洞的利用已经得到验证。 漏洞库信息也表明CISA ADP已经将此漏洞添加到已知被利用漏洞列表中，进一步证明了其有效性。

提供的漏洞利用代码`/tmp/32315364bfebb19c9bcece1aca1942c9/README.md` 仅包含CVE编号的信息，本身并没有可执行的利用代码。但是，结合搜索引擎结果，可以找到其他存储库中提供的PoC 代码。

**投毒风险：**

由于提供的代码只是一个包含CVE编号的`README.md`文件，因此直接分析该文件进行投毒判断没有意义。真正的PoC代码位于其他存储库。但是，在实际利用PoC的过程中，需要仔细审查代码，因为PoC代码可能包含恶意修改。 

假设用户下载并执行了某个声称是CVE-2025-21333的PoC代码。 评估投毒风险。鉴于漏洞利用开发和安全研究的复杂性，有以下可能性：

*   **有意后门：** 某些代码作者可能会故意在PoC中添加后门，以便进一步攻击或控制目标系统。风险较高，因为内核漏洞利用通常需要精心的内存操作，很容易隐藏恶意代码。
*   **代码质量问题：** PoC代码可能未经充分测试或包含错误，导致系统崩溃或不稳定。这虽然不是直接的投毒，但也可能对系统造成损害。
*   **依赖项风险：** PoC可能依赖于外部库或组件，这些库或组件本身可能存在漏洞或恶意代码。

考虑到这些因素，初步估计投毒风险为10%。更详细的代码审计可以提供更准确的风险评估。

**利用方式：**

1.  **触发漏洞：** 虚拟机内的攻击者，通过构造恶意的请求发送给Hyper-V主机。
2.  **堆溢出：** 恶意的请求会触发 Hyper-V NT Kernel Integration VSP 组件中的堆缓冲区溢出。
3.  **控制流劫持：** 利用堆溢出覆盖关键内核数据结构，例如函数指针，从而控制内核执行流。
4.  **权限提升：** 执行恶意代码，例如调用`PsLookupProcessByProcessId`和`SeAssignPrivileges`等函数，以提升虚拟机内的进程权限到 SYSTEM。
5.  **虚拟机逃逸：** 利用获得的 SYSTEM 权限，攻击者可以执行虚拟机逃逸操作，例如访问Hyper-V主机的文件系统，甚至控制整个主机。


**项目地址:** [B1ack4sh/Blackash-CVE-2025-21333](https://github.com/B1ack4sh/Blackash-CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #3

**来源**: [CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致系统权限提升

**影响版本:** Windows 10 21H2 (<= 10.0.19044.5371), Windows 11 22H2 (<= 10.0.22621.4751), Windows 10 22H2 (<= 10.0.19045.5371), Windows Server 2025 (<= 10.0.26100.2894), Windows 11 23H2 (<= 10.0.22631.4751), Windows 11 24H2 (<= 10.0.26100.2894), Windows Server 23H2 (<= 10.0.25398.1369)

**利用条件:** 需要Guest OS环境, 并需要利用I/O Ring机制进行攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 的特权提升漏洞。该漏洞是由于内核驱动`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。 

**漏洞利用方式：**

1.  **I/O Ring机制：** PoC利用了Windows I/O Ring机制，通过伪造IOP_MC_BUFFER_ENTRY结构体，从而实现内核任意地址读写。
2.  **堆溢出：** 通过在分页池中分配大量内存，然后触发堆溢出，覆盖IOP_MC_BUFFER_ENTRY结构体指针。
3.  **任意读写：** 覆盖后的`Address`可以指向任意内核地址，从而实现任意地址读写。
4. **提权：** 通过任意读写能力，可以修改当前进程的Token，从而提升权限。

**有效性：**

根据提供的PoC代码和搜索结果，该漏洞PoC的存在，并且已经被CISA列入已知被利用漏洞目录。PoC代码的README描述了如何在Windows 11 23h2上利用此漏洞进行提权，同时也说明了该PoC的可靠性可能不高。

**投毒风险：**

PoC代码本身是一个Visual Studio解决方案，包含C++源代码。 代码主要功能是利用堆溢出和I/O Ring机制实现内核任意地址读写，从而提升权限。审查代码后，发现潜在的投毒风险较低，例如：

*   **复杂性：** 代码相对复杂，阅读和理解需要一定的内核安全知识，增加了隐藏恶意代码的难度。
*   **公开性：** PoC本身是为了演示漏洞利用，作者倾向于公开透明，减少隐藏恶意代码的动机。
    但是，仍然存在一些微小的风险：
*   **细微修改：** 攻击者可能会在PoC代码中添加一些细微的修改，例如修改内存地址或增加延时，从而绕过安全检测。
*   **依赖项：** PoC可能依赖一些外部库或驱动，这些依赖项可能存在安全风险。

综上所述，该PoC代码存在10%的投毒风险，主要是考虑到细微修改和依赖项的潜在风险。


**项目地址:** [MrAle98/CVE-2025-21333-POC](https://github.com/MrAle98/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #4

**来源**: [CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致SYSTEM权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2 等受影响版本

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (Virtual Service Provider) 中的权限提升漏洞。该漏洞是由于 NT 内核集成 VSP 中存在堆缓冲区溢出造成的，攻击者可以利用此漏洞获得 SYSTEM 权限。

**有效性评估：**

根据漏洞描述和搜索结果，该漏洞是一个已知的、存在被利用的漏洞，CISA 已将其添加到已知被利用的漏洞目录中。 Reddit的帖子也表明有人发布了POC。提供的POC代码是一个Visual Studio解决方案，包含C++源代码，这进一步表明该漏洞是可以被利用的。readme描述利用了WNF state data 和 I/O ring IOP_MC_BUFFER_ENTRY，指向了具体利用的技术细节。

**投毒风险评估：**

评估POC代码的投毒风险需要仔细分析代码。从提供的代码片段来看，代码主要涉及Windows API调用，包括内存操作、对象操作、线程管理和进程管理等。初步分析没有发现明显的恶意代码或后门。但是考虑到漏洞利用代码本身的复杂性以及缺乏完整代码，存在一定的投毒风险，例如：

*   **隐蔽的权限提升：** 代码可能包含不易察觉的后门，在提权后执行恶意操作，例如安装恶意软件或收集敏感信息。
*   **代码注入：** 恶意代码可能会注入到其他进程中，从而绕过安全检测。
* **依赖风险:** readme中的链接可能指向恶意网站或包含恶意软件的下载链接。

虽然不能完全排除投毒的可能性，考虑到漏洞利用的复杂性，作者隐藏恶意代码的概率较低，因此暂定投毒风险为10%。

**利用方式分析：**

1.  **漏洞触发：** 攻击者利用Hyper-V NT Kernel Integration VSP中的漏洞，该漏洞位于内核态驱动中，允许从虚拟机内部触发。
2.  **堆溢出：** 利用特定的输入或操作，触发堆缓冲区溢出，覆盖相邻的内存区域。搜索结果表明是Paged Pool中的heap-based buffer overflow
3.  **权限提升：** 通过控制溢出的内容，例如覆盖内核对象或函数指针，攻击者可以将自己的权限提升到SYSTEM。
4.  **执行恶意代码：** 获得SYSTEM权限后，攻击者可以执行任意代码，例如安装恶意软件、窃取数据或控制系统。

**项目地址:** [Mukesh-blend/CVE-2025-21333-POC](https://github.com/Mukesh-blend/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #5

**来源**: [CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机数据泄露、完整性破坏和拒绝服务

**影响版本:** Windows 10 21H2 (版本 10.0.19043.0 到 10.0.19044.5371), Windows 11 22H2 (版本 10.0.22621.0 到 10.0.22621.4751), Windows 10 22H2 (版本 10.0.19045.0 到 10.0.19045.5371), Windows Server 2025 (版本 10.0.26100.0 到 10.0.26100.2894), Windows 11 23H2 (版本 10.0.22631.0 到 10.0.22631.4751), Windows Server 23H2 (版本 10.0.25398.0 到 10.0.25398.1369), Windows 11 24H2 (版本 10.0.26100.0 到 10.0.26100.2894)

**利用条件:** 本地用户权限，需要启用并运行Hyper-V。

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞。根据漏洞描述和搜索结果，攻击者可以利用恶意构造的 Virtual Service Provider (VSP) 来提升权限，最终控制 Hyper-V 主机。这是一个堆溢出漏洞（CWE-122）。

**有效性：**
提供的 POC 代码是一个 Visual Studio 解决方案，包含 C++ 代码。代码中包含Windows头文件，如 `<Windows.h>`, `<ioringapi.h>`和自定义头文件`wnf.h`。通过检查代码，可以发现其中利用了Windows Notification Facility（WNF）状态数据和I/O ring IOP_MC_BUFFER_ENTRY。搜索结果中reddit论坛的帖子也说明这是一个windows内核堆溢出漏洞，并提供了github链接。

**投毒风险：**
提供的代码片段中，最可疑的部分是 `README.md` 文件中提供的下载链接：`[Download Exploit](https://github.com/file/Soft.zip)`。该链接指向一个名为 `Soft.zip` 的 ZIP 文件，从不可信来源下载未经验证的可执行文件具有极高的风险。虽然直接提供的C++代码本身看起来是标准漏洞利用代码，但`README.md`文件中的下载链接是潜在的恶意软件投放点。用户可能被诱导下载包含恶意payload的zip文件，而非真正的漏洞利用程序。因此，存在较高的投毒风险。
另外，`wnf.h`等自定义头文件没有提供，意味着使用者必须自己查找或编写相关代码，这增加了利用难度，也为潜在的投毒留下了空间。攻击者可以提供带有恶意代码的`wnf.h`文件，诱导用户使用。
总体来说，投毒风险较高，估计为80%。

**利用方式：**
1.  **触发漏洞:** 利用特制的 VSP 触发 Hyper-V NT Kernel Integration 中的堆溢出。
2.  **WNF状态数据操控:** 通过操纵WNF状态数据，控制内核内存的布局。
3. **I/O ring IOP_MC_BUFFER_ENTRY：** 通过操控I/O环，控制内核内存的读写。
4.  **权限提升:** 覆盖关键内核数据结构，例如当前进程的 Token，将其替换为 SYSTEM 用户的 Token，从而提升权限。

**项目地址:** [SerabiLem/CVE-2025-21333-POC](https://github.com/SerabiLem/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #6

**来源**: [CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md](../2025/CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，本地攻击者可利用该漏洞获得SYSTEM权限

**影响版本:** Windows 10 21H2 (versionStartIncluding: 10.0.19043.0, versionEndExcluding: 10.0.19044.5371), Windows 11 22H2 (versionStartIncluding: 10.0.22621.0, versionEndExcluding: 10.0.22621.4751), Windows 10 22H2 (versionStartIncluding: 10.0.19045.0, versionEndExcluding: 10.0.19045.5371), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows Server 23H2 (versionStartIncluding: 10.0.25398.0, versionEndExcluding: 10.0.25398.1369), Windows 11 24H2 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894)

**利用条件:** 本地访问，需要运行受影响的Windows Hyper-V。

**POC 可用性:** 是，根据搜索结果，存在可用的POC代码

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 特权提升漏洞。该漏洞是由于`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。攻击者可以利用此漏洞在本地获得 SYSTEM 权限。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞影响多个Windows版本，并且CISA已将其列入已知被利用的漏洞目录，表明该漏洞具有实际的利用价值。搜索引擎结果显示存在公开的POC代码，进一步佐证了漏洞的可利用性。

**投毒风险：** 提供的漏洞利用代码是 KQL 查询语句，用于检测与 CVE-2025-21333 相关的可疑活动。代码本身用于安全事件的监控和分析，而非直接的漏洞利用。因此，可以认为该代码的投毒风险较低，但也需要人工审查代码的逻辑，判断是否存在恶意隐藏。例如，代码中可能会被利用来误报，影响正常的安全事件分析，所以投毒风险为 10%。

**利用方式：**  攻击者可以利用该漏洞通过与Hyper-V的NT内核集成VSP相关的组件，触发堆缓冲区溢出，最终获得SYSTEM权限。具体来说，`vkrnlintvsp.sys` 组件在处理来自虚拟机的数据时，如果没有进行充分的边界检查，可能导致缓冲区溢出。根据搜索结果，漏洞存在于主机操作系统和容器类型虚拟机之间的通信组件中。攻击者需要在受影响的系统上执行恶意代码，触发溢出，从而提升权限。实际的利用可能涉及到内存地址的计算、shellcode的注入等技术。

 简而言之，这是一个本地提权漏洞，攻击者通过精心构造的数据包与Hyper-V的内核集成服务进行交互，导致内核堆缓冲区溢出，从而覆盖关键数据并获得SYSTEM权限。

**项目地址:** [aleongx/KQL_sentinel_CVE-2025-21333](https://github.com/aleongx/KQL_sentinel_CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #7

**来源**: [CVE-2025-21333-pradip022_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-pradip022_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V NT Kernel Integration VSP

**危害等级:** 高危，可提升权限

**影响版本:** 受影响的版本包括Windows 10 21H2，Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等，具体版本范围见CVE描述。

**利用条件:** 需要目标系统运行Hyper-V，且虚拟机集成服务（VSP）存在漏洞。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP的权限提升漏洞，这是一个堆溢出漏洞(CWE-122)。根据搜索结果，存在公开的POC代码，并且该漏洞已被积极利用。漏洞利用代码的README.md文件描述了如何下载和运行该POC，指出利用涉及WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY。代码库中提供的Visual Studio解决方案文件，进一步证实了漏洞利用的存在。虽然github仓库描述了POC的简单用法,但是下载地址却指向了另一个github地址,存在诱导下载其他恶意文件的可能性. 同时考虑到windows内核漏洞利用通常需要较高的技术水平，且可能涉及复杂的内存操作, 因此存在投毒风险，风险概率评估为30%。

利用方式：攻击者可以利用此漏洞在Hyper-V环境中提升权限。具体利用方式涉及构造特定的WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY，触发堆溢出，从而执行恶意代码。

**项目地址:** [pradip022/CVE-2025-21333-POC](https://github.com/pradip022/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #8

**来源**: [CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md](../2025/CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2。具体版本范围参考CVE详情。

**利用条件:** 需要Hyper-V环境，guest操作系统执行漏洞利用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP权限提升漏洞，是一个基于堆的缓冲区溢出(CWE-122)。

**有效性评估：**
根据搜索结果和提供的PoC代码，该漏洞的PoC是有效的。搜索引擎结果中提到有writeup，POC代码可用，并且该漏洞已被积极利用。漏洞库信息也表明该漏洞已被CISA加入已知被利用漏洞列表(KEV)。 提供的PoC代码是一个用于演示缓冲区溢出漏洞的demo，虽然它不是直接可用的exp，但是它再现了崩溃行为，并且提供测试环境的搭建方法，以及调试的思路，对于理解漏洞原理非常有帮助。 

**投毒风险分析：**
提供的PoC代码主要由以下部分组成：
*   `LAB_SETUP.md`: 提供实验环境搭建的说明，强调安全措施。
*   `README.md`: 描述项目目标是用于教育和防御研究，不包含exploit代码。
*   `windbg_notes.md`: 提供WinDbg的使用提示。
*   `build.sh`: 用于编译`vuln_demo.c`的脚本。
*   `run_and_crash.md`:  提供运行demo并产生崩溃的指导。
*   `vuln_demo.c`: 包含一个故意存在漏洞的程序，用于演示缓冲区溢出。
*   `reports/analysis.md`: 分析报告模板

综合来看，代码库明确声明了其教育目的，并提供了安全建议以防止滥用。`vuln_demo.c`中的`strcpy`函数存在明显的缓冲区溢出漏洞，这与CVE描述相符。代码库没有发现任何恶意代码或隐藏功能。 投毒的可能来自于作者可能故意留下一些隐蔽的后门代码，例如在`vuln_demo.c`中添加一些不明显的恶意操作，或者在`build.sh`脚本中添加一些下载和执行恶意代码的命令。但考虑到代码的简单性和开源性质，以及作者声明的教育目的，这种可能性较低， 估计投毒风险在5%左右。

**利用方式分析：**
1.  **漏洞原理：** 该漏洞是由于Windows Hyper-V NT Kernel Integration VSP组件中存在堆缓冲区溢出漏洞(CWE-122)。 
2.  **利用步骤：**
    *   攻击者首先需要访问运行Hyper-V的系统，并且最好在Guest操作系统内。
    *   然后，攻击者可以通过向易受攻击的VSP组件发送特制的输入，触发堆缓冲区溢出。
    *   通过精巧的构造输入数据，攻击者可以覆盖相邻的内存区域，从而控制程序的执行流程。
    *   最终，攻击者可以利用此漏洞提升权限，例如从普通用户权限提升到系统管理员权限。
3.  **利用限制：** 漏洞利用需要在启用了Hyper-V的系统上进行，并且可能需要特定的系统配置和权限。


**项目地址:** [rahul0xkr/Hyper-V-CVE-2025-21333-Analysis](https://github.com/rahul0xkr/Hyper-V-CVE-2025-21333-Analysis)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #9

**来源**: [CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md](../2025/CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md)

# CVE-2025-21333

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21333-160102_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-160102_CVE-2025-21333-POC.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致权限提升

**影响版本:** 受影响的Windows版本包括Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等。

**利用条件:** 需要本地访问，在Hyper-V环境中。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP（Virtual Service Provider）权限提升漏洞。根据漏洞信息和搜索结果，该漏洞存在于Hyper-V的NT内核集成组件中，允许攻击者提升权限。漏洞利用代码显示这是一个C++项目，利用了WNF（Windows Notification Facility）状态数据和I/O ring IOP_MC_BUFFER_ENTRY来触发堆缓冲区溢出。该POC的Visual Studio解决方案文件表明它是一个可编译的项目，但存在投毒风险，因为从github下载zip存在未知风险。从代码来看，大量使用了Windows API，直接与内核交互，存在恶意修改内核的可能性，投毒风险评估为20%。利用方式通常包括：

1.  **触发漏洞：** 通过精心构造的WNF状态数据和I/O ring操作，触发NT内核集成组件中的堆缓冲区溢出。
2.  **控制执行流：** 覆盖堆上的关键数据结构，以控制内核的执行流程。
3.  **权限提升：** 通过修改当前进程的Token，将其权限提升到SYSTEM级别。

从搜索结果来看，该漏洞已经被CISA列入已知被利用漏洞目录，表明该漏洞具有较高的实际威胁。

**有效性评估：** 根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的，因为存在可编译的POC，并且CISA已经确认该漏洞被利用。

**投毒风险评估：** 该POC代码存在一定的投毒风险。因为需要下载压缩包，压缩包内部可能包含恶意代码，但主要代码是利用windows api进行操作，函数功能明确，没有发现明显的恶意行为，风险较低。


**项目地址:** [160102/CVE-2025-21333-POC](https://github.com/160102/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #2

**来源**: [CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md](../2025/CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 提权漏洞/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机逃逸，主机权限获取

**影响版本:** 受影响的Windows版本 (见漏洞库信息)

**利用条件:** 需要Guest虚拟机权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (虚拟机服务提供者) 中的提权漏洞，本质是堆溢出。攻击者（虚拟机内的用户）可以利用此漏洞，通过特制的请求导致在主机操作系统内核中发生堆缓冲区溢出，从而获得主机操作系统的管理员权限。

**有效性：**

根据搜索引擎结果，此漏洞已经被公开披露，并且存在公开可用的PoC（例如 GitHub上的`MrAle98/CVE-2025-21333-POC`仓库），表明该漏洞的利用已经得到验证。 漏洞库信息也表明CISA ADP已经将此漏洞添加到已知被利用漏洞列表中，进一步证明了其有效性。

提供的漏洞利用代码`/tmp/32315364bfebb19c9bcece1aca1942c9/README.md` 仅包含CVE编号的信息，本身并没有可执行的利用代码。但是，结合搜索引擎结果，可以找到其他存储库中提供的PoC 代码。

**投毒风险：**

由于提供的代码只是一个包含CVE编号的`README.md`文件，因此直接分析该文件进行投毒判断没有意义。真正的PoC代码位于其他存储库。但是，在实际利用PoC的过程中，需要仔细审查代码，因为PoC代码可能包含恶意修改。 

假设用户下载并执行了某个声称是CVE-2025-21333的PoC代码。 评估投毒风险。鉴于漏洞利用开发和安全研究的复杂性，有以下可能性：

*   **有意后门：** 某些代码作者可能会故意在PoC中添加后门，以便进一步攻击或控制目标系统。风险较高，因为内核漏洞利用通常需要精心的内存操作，很容易隐藏恶意代码。
*   **代码质量问题：** PoC代码可能未经充分测试或包含错误，导致系统崩溃或不稳定。这虽然不是直接的投毒，但也可能对系统造成损害。
*   **依赖项风险：** PoC可能依赖于外部库或组件，这些库或组件本身可能存在漏洞或恶意代码。

考虑到这些因素，初步估计投毒风险为10%。更详细的代码审计可以提供更准确的风险评估。

**利用方式：**

1.  **触发漏洞：** 虚拟机内的攻击者，通过构造恶意的请求发送给Hyper-V主机。
2.  **堆溢出：** 恶意的请求会触发 Hyper-V NT Kernel Integration VSP 组件中的堆缓冲区溢出。
3.  **控制流劫持：** 利用堆溢出覆盖关键内核数据结构，例如函数指针，从而控制内核执行流。
4.  **权限提升：** 执行恶意代码，例如调用`PsLookupProcessByProcessId`和`SeAssignPrivileges`等函数，以提升虚拟机内的进程权限到 SYSTEM。
5.  **虚拟机逃逸：** 利用获得的 SYSTEM 权限，攻击者可以执行虚拟机逃逸操作，例如访问Hyper-V主机的文件系统，甚至控制整个主机。


**项目地址:** [B1ack4sh/Blackash-CVE-2025-21333](https://github.com/B1ack4sh/Blackash-CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #3

**来源**: [CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致系统权限提升

**影响版本:** Windows 10 21H2 (<= 10.0.19044.5371), Windows 11 22H2 (<= 10.0.22621.4751), Windows 10 22H2 (<= 10.0.19045.5371), Windows Server 2025 (<= 10.0.26100.2894), Windows 11 23H2 (<= 10.0.22631.4751), Windows 11 24H2 (<= 10.0.26100.2894), Windows Server 23H2 (<= 10.0.25398.1369)

**利用条件:** 需要Guest OS环境, 并需要利用I/O Ring机制进行攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 的特权提升漏洞。该漏洞是由于内核驱动`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。 

**漏洞利用方式：**

1.  **I/O Ring机制：** PoC利用了Windows I/O Ring机制，通过伪造IOP_MC_BUFFER_ENTRY结构体，从而实现内核任意地址读写。
2.  **堆溢出：** 通过在分页池中分配大量内存，然后触发堆溢出，覆盖IOP_MC_BUFFER_ENTRY结构体指针。
3.  **任意读写：** 覆盖后的`Address`可以指向任意内核地址，从而实现任意地址读写。
4. **提权：** 通过任意读写能力，可以修改当前进程的Token，从而提升权限。

**有效性：**

根据提供的PoC代码和搜索结果，该漏洞PoC的存在，并且已经被CISA列入已知被利用漏洞目录。PoC代码的README描述了如何在Windows 11 23h2上利用此漏洞进行提权，同时也说明了该PoC的可靠性可能不高。

**投毒风险：**

PoC代码本身是一个Visual Studio解决方案，包含C++源代码。 代码主要功能是利用堆溢出和I/O Ring机制实现内核任意地址读写，从而提升权限。审查代码后，发现潜在的投毒风险较低，例如：

*   **复杂性：** 代码相对复杂，阅读和理解需要一定的内核安全知识，增加了隐藏恶意代码的难度。
*   **公开性：** PoC本身是为了演示漏洞利用，作者倾向于公开透明，减少隐藏恶意代码的动机。
    但是，仍然存在一些微小的风险：
*   **细微修改：** 攻击者可能会在PoC代码中添加一些细微的修改，例如修改内存地址或增加延时，从而绕过安全检测。
*   **依赖项：** PoC可能依赖一些外部库或驱动，这些依赖项可能存在安全风险。

综上所述，该PoC代码存在10%的投毒风险，主要是考虑到细微修改和依赖项的潜在风险。


**项目地址:** [MrAle98/CVE-2025-21333-POC](https://github.com/MrAle98/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #4

**来源**: [CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致SYSTEM权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2 等受影响版本

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (Virtual Service Provider) 中的权限提升漏洞。该漏洞是由于 NT 内核集成 VSP 中存在堆缓冲区溢出造成的，攻击者可以利用此漏洞获得 SYSTEM 权限。

**有效性评估：**

根据漏洞描述和搜索结果，该漏洞是一个已知的、存在被利用的漏洞，CISA 已将其添加到已知被利用的漏洞目录中。 Reddit的帖子也表明有人发布了POC。提供的POC代码是一个Visual Studio解决方案，包含C++源代码，这进一步表明该漏洞是可以被利用的。readme描述利用了WNF state data 和 I/O ring IOP_MC_BUFFER_ENTRY，指向了具体利用的技术细节。

**投毒风险评估：**

评估POC代码的投毒风险需要仔细分析代码。从提供的代码片段来看，代码主要涉及Windows API调用，包括内存操作、对象操作、线程管理和进程管理等。初步分析没有发现明显的恶意代码或后门。但是考虑到漏洞利用代码本身的复杂性以及缺乏完整代码，存在一定的投毒风险，例如：

*   **隐蔽的权限提升：** 代码可能包含不易察觉的后门，在提权后执行恶意操作，例如安装恶意软件或收集敏感信息。
*   **代码注入：** 恶意代码可能会注入到其他进程中，从而绕过安全检测。
* **依赖风险:** readme中的链接可能指向恶意网站或包含恶意软件的下载链接。

虽然不能完全排除投毒的可能性，考虑到漏洞利用的复杂性，作者隐藏恶意代码的概率较低，因此暂定投毒风险为10%。

**利用方式分析：**

1.  **漏洞触发：** 攻击者利用Hyper-V NT Kernel Integration VSP中的漏洞，该漏洞位于内核态驱动中，允许从虚拟机内部触发。
2.  **堆溢出：** 利用特定的输入或操作，触发堆缓冲区溢出，覆盖相邻的内存区域。搜索结果表明是Paged Pool中的heap-based buffer overflow
3.  **权限提升：** 通过控制溢出的内容，例如覆盖内核对象或函数指针，攻击者可以将自己的权限提升到SYSTEM。
4.  **执行恶意代码：** 获得SYSTEM权限后，攻击者可以执行任意代码，例如安装恶意软件、窃取数据或控制系统。

**项目地址:** [Mukesh-blend/CVE-2025-21333-POC](https://github.com/Mukesh-blend/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #5

**来源**: [CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机数据泄露、完整性破坏和拒绝服务

**影响版本:** Windows 10 21H2 (版本 10.0.19043.0 到 10.0.19044.5371), Windows 11 22H2 (版本 10.0.22621.0 到 10.0.22621.4751), Windows 10 22H2 (版本 10.0.19045.0 到 10.0.19045.5371), Windows Server 2025 (版本 10.0.26100.0 到 10.0.26100.2894), Windows 11 23H2 (版本 10.0.22631.0 到 10.0.22631.4751), Windows Server 23H2 (版本 10.0.25398.0 到 10.0.25398.1369), Windows 11 24H2 (版本 10.0.26100.0 到 10.0.26100.2894)

**利用条件:** 本地用户权限，需要启用并运行Hyper-V。

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞。根据漏洞描述和搜索结果，攻击者可以利用恶意构造的 Virtual Service Provider (VSP) 来提升权限，最终控制 Hyper-V 主机。这是一个堆溢出漏洞（CWE-122）。

**有效性：**
提供的 POC 代码是一个 Visual Studio 解决方案，包含 C++ 代码。代码中包含Windows头文件，如 `<Windows.h>`, `<ioringapi.h>`和自定义头文件`wnf.h`。通过检查代码，可以发现其中利用了Windows Notification Facility（WNF）状态数据和I/O ring IOP_MC_BUFFER_ENTRY。搜索结果中reddit论坛的帖子也说明这是一个windows内核堆溢出漏洞，并提供了github链接。

**投毒风险：**
提供的代码片段中，最可疑的部分是 `README.md` 文件中提供的下载链接：`[Download Exploit](https://github.com/file/Soft.zip)`。该链接指向一个名为 `Soft.zip` 的 ZIP 文件，从不可信来源下载未经验证的可执行文件具有极高的风险。虽然直接提供的C++代码本身看起来是标准漏洞利用代码，但`README.md`文件中的下载链接是潜在的恶意软件投放点。用户可能被诱导下载包含恶意payload的zip文件，而非真正的漏洞利用程序。因此，存在较高的投毒风险。
另外，`wnf.h`等自定义头文件没有提供，意味着使用者必须自己查找或编写相关代码，这增加了利用难度，也为潜在的投毒留下了空间。攻击者可以提供带有恶意代码的`wnf.h`文件，诱导用户使用。
总体来说，投毒风险较高，估计为80%。

**利用方式：**
1.  **触发漏洞:** 利用特制的 VSP 触发 Hyper-V NT Kernel Integration 中的堆溢出。
2.  **WNF状态数据操控:** 通过操纵WNF状态数据，控制内核内存的布局。
3. **I/O ring IOP_MC_BUFFER_ENTRY：** 通过操控I/O环，控制内核内存的读写。
4.  **权限提升:** 覆盖关键内核数据结构，例如当前进程的 Token，将其替换为 SYSTEM 用户的 Token，从而提升权限。

**项目地址:** [SerabiLem/CVE-2025-21333-POC](https://github.com/SerabiLem/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #6

**来源**: [CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md](../2025/CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，本地攻击者可利用该漏洞获得SYSTEM权限

**影响版本:** Windows 10 21H2 (versionStartIncluding: 10.0.19043.0, versionEndExcluding: 10.0.19044.5371), Windows 11 22H2 (versionStartIncluding: 10.0.22621.0, versionEndExcluding: 10.0.22621.4751), Windows 10 22H2 (versionStartIncluding: 10.0.19045.0, versionEndExcluding: 10.0.19045.5371), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows Server 23H2 (versionStartIncluding: 10.0.25398.0, versionEndExcluding: 10.0.25398.1369), Windows 11 24H2 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894)

**利用条件:** 本地访问，需要运行受影响的Windows Hyper-V。

**POC 可用性:** 是，根据搜索结果，存在可用的POC代码

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 特权提升漏洞。该漏洞是由于`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。攻击者可以利用此漏洞在本地获得 SYSTEM 权限。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞影响多个Windows版本，并且CISA已将其列入已知被利用的漏洞目录，表明该漏洞具有实际的利用价值。搜索引擎结果显示存在公开的POC代码，进一步佐证了漏洞的可利用性。

**投毒风险：** 提供的漏洞利用代码是 KQL 查询语句，用于检测与 CVE-2025-21333 相关的可疑活动。代码本身用于安全事件的监控和分析，而非直接的漏洞利用。因此，可以认为该代码的投毒风险较低，但也需要人工审查代码的逻辑，判断是否存在恶意隐藏。例如，代码中可能会被利用来误报，影响正常的安全事件分析，所以投毒风险为 10%。

**利用方式：**  攻击者可以利用该漏洞通过与Hyper-V的NT内核集成VSP相关的组件，触发堆缓冲区溢出，最终获得SYSTEM权限。具体来说，`vkrnlintvsp.sys` 组件在处理来自虚拟机的数据时，如果没有进行充分的边界检查，可能导致缓冲区溢出。根据搜索结果，漏洞存在于主机操作系统和容器类型虚拟机之间的通信组件中。攻击者需要在受影响的系统上执行恶意代码，触发溢出，从而提升权限。实际的利用可能涉及到内存地址的计算、shellcode的注入等技术。

 简而言之，这是一个本地提权漏洞，攻击者通过精心构造的数据包与Hyper-V的内核集成服务进行交互，导致内核堆缓冲区溢出，从而覆盖关键数据并获得SYSTEM权限。

**项目地址:** [aleongx/KQL_sentinel_CVE-2025-21333](https://github.com/aleongx/KQL_sentinel_CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #7

**来源**: [CVE-2025-21333-pradip022_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-pradip022_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V NT Kernel Integration VSP

**危害等级:** 高危，可提升权限

**影响版本:** 受影响的版本包括Windows 10 21H2，Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等，具体版本范围见CVE描述。

**利用条件:** 需要目标系统运行Hyper-V，且虚拟机集成服务（VSP）存在漏洞。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP的权限提升漏洞，这是一个堆溢出漏洞(CWE-122)。根据搜索结果，存在公开的POC代码，并且该漏洞已被积极利用。漏洞利用代码的README.md文件描述了如何下载和运行该POC，指出利用涉及WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY。代码库中提供的Visual Studio解决方案文件，进一步证实了漏洞利用的存在。虽然github仓库描述了POC的简单用法,但是下载地址却指向了另一个github地址,存在诱导下载其他恶意文件的可能性. 同时考虑到windows内核漏洞利用通常需要较高的技术水平，且可能涉及复杂的内存操作, 因此存在投毒风险，风险概率评估为30%。

利用方式：攻击者可以利用此漏洞在Hyper-V环境中提升权限。具体利用方式涉及构造特定的WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY，触发堆溢出，从而执行恶意代码。

**项目地址:** [pradip022/CVE-2025-21333-POC](https://github.com/pradip022/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #8

**来源**: [CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md](../2025/CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2。具体版本范围参考CVE详情。

**利用条件:** 需要Hyper-V环境，guest操作系统执行漏洞利用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP权限提升漏洞，是一个基于堆的缓冲区溢出(CWE-122)。

**有效性评估：**
根据搜索结果和提供的PoC代码，该漏洞的PoC是有效的。搜索引擎结果中提到有writeup，POC代码可用，并且该漏洞已被积极利用。漏洞库信息也表明该漏洞已被CISA加入已知被利用漏洞列表(KEV)。 提供的PoC代码是一个用于演示缓冲区溢出漏洞的demo，虽然它不是直接可用的exp，但是它再现了崩溃行为，并且提供测试环境的搭建方法，以及调试的思路，对于理解漏洞原理非常有帮助。 

**投毒风险分析：**
提供的PoC代码主要由以下部分组成：
*   `LAB_SETUP.md`: 提供实验环境搭建的说明，强调安全措施。
*   `README.md`: 描述项目目标是用于教育和防御研究，不包含exploit代码。
*   `windbg_notes.md`: 提供WinDbg的使用提示。
*   `build.sh`: 用于编译`vuln_demo.c`的脚本。
*   `run_and_crash.md`:  提供运行demo并产生崩溃的指导。
*   `vuln_demo.c`: 包含一个故意存在漏洞的程序，用于演示缓冲区溢出。
*   `reports/analysis.md`: 分析报告模板

综合来看，代码库明确声明了其教育目的，并提供了安全建议以防止滥用。`vuln_demo.c`中的`strcpy`函数存在明显的缓冲区溢出漏洞，这与CVE描述相符。代码库没有发现任何恶意代码或隐藏功能。 投毒的可能来自于作者可能故意留下一些隐蔽的后门代码，例如在`vuln_demo.c`中添加一些不明显的恶意操作，或者在`build.sh`脚本中添加一些下载和执行恶意代码的命令。但考虑到代码的简单性和开源性质，以及作者声明的教育目的，这种可能性较低， 估计投毒风险在5%左右。

**利用方式分析：**
1.  **漏洞原理：** 该漏洞是由于Windows Hyper-V NT Kernel Integration VSP组件中存在堆缓冲区溢出漏洞(CWE-122)。 
2.  **利用步骤：**
    *   攻击者首先需要访问运行Hyper-V的系统，并且最好在Guest操作系统内。
    *   然后，攻击者可以通过向易受攻击的VSP组件发送特制的输入，触发堆缓冲区溢出。
    *   通过精巧的构造输入数据，攻击者可以覆盖相邻的内存区域，从而控制程序的执行流程。
    *   最终，攻击者可以利用此漏洞提升权限，例如从普通用户权限提升到系统管理员权限。
3.  **利用限制：** 漏洞利用需要在启用了Hyper-V的系统上进行，并且可能需要特定的系统配置和权限。


**项目地址:** [rahul0xkr/Hyper-V-CVE-2025-21333-Analysis](https://github.com/rahul0xkr/Hyper-V-CVE-2025-21333-Analysis)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #9

**来源**: [CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md](../2025/CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md)

# CVE-2025-21333

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21333-160102_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-160102_CVE-2025-21333-POC.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致权限提升

**影响版本:** 受影响的Windows版本包括Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等。

**利用条件:** 需要本地访问，在Hyper-V环境中。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP（Virtual Service Provider）权限提升漏洞。根据漏洞信息和搜索结果，该漏洞存在于Hyper-V的NT内核集成组件中，允许攻击者提升权限。漏洞利用代码显示这是一个C++项目，利用了WNF（Windows Notification Facility）状态数据和I/O ring IOP_MC_BUFFER_ENTRY来触发堆缓冲区溢出。该POC的Visual Studio解决方案文件表明它是一个可编译的项目，但存在投毒风险，因为从github下载zip存在未知风险。从代码来看，大量使用了Windows API，直接与内核交互，存在恶意修改内核的可能性，投毒风险评估为20%。利用方式通常包括：

1.  **触发漏洞：** 通过精心构造的WNF状态数据和I/O ring操作，触发NT内核集成组件中的堆缓冲区溢出。
2.  **控制执行流：** 覆盖堆上的关键数据结构，以控制内核的执行流程。
3.  **权限提升：** 通过修改当前进程的Token，将其权限提升到SYSTEM级别。

从搜索结果来看，该漏洞已经被CISA列入已知被利用漏洞目录，表明该漏洞具有较高的实际威胁。

**有效性评估：** 根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的，因为存在可编译的POC，并且CISA已经确认该漏洞被利用。

**投毒风险评估：** 该POC代码存在一定的投毒风险。因为需要下载压缩包，压缩包内部可能包含恶意代码，但主要代码是利用windows api进行操作，函数功能明确，没有发现明显的恶意行为，风险较低。


**项目地址:** [160102/CVE-2025-21333-POC](https://github.com/160102/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #2

**来源**: [CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md](../2025/CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 提权漏洞/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机逃逸，主机权限获取

**影响版本:** 受影响的Windows版本 (见漏洞库信息)

**利用条件:** 需要Guest虚拟机权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (虚拟机服务提供者) 中的提权漏洞，本质是堆溢出。攻击者（虚拟机内的用户）可以利用此漏洞，通过特制的请求导致在主机操作系统内核中发生堆缓冲区溢出，从而获得主机操作系统的管理员权限。

**有效性：**

根据搜索引擎结果，此漏洞已经被公开披露，并且存在公开可用的PoC（例如 GitHub上的`MrAle98/CVE-2025-21333-POC`仓库），表明该漏洞的利用已经得到验证。 漏洞库信息也表明CISA ADP已经将此漏洞添加到已知被利用漏洞列表中，进一步证明了其有效性。

提供的漏洞利用代码`/tmp/32315364bfebb19c9bcece1aca1942c9/README.md` 仅包含CVE编号的信息，本身并没有可执行的利用代码。但是，结合搜索引擎结果，可以找到其他存储库中提供的PoC 代码。

**投毒风险：**

由于提供的代码只是一个包含CVE编号的`README.md`文件，因此直接分析该文件进行投毒判断没有意义。真正的PoC代码位于其他存储库。但是，在实际利用PoC的过程中，需要仔细审查代码，因为PoC代码可能包含恶意修改。 

假设用户下载并执行了某个声称是CVE-2025-21333的PoC代码。 评估投毒风险。鉴于漏洞利用开发和安全研究的复杂性，有以下可能性：

*   **有意后门：** 某些代码作者可能会故意在PoC中添加后门，以便进一步攻击或控制目标系统。风险较高，因为内核漏洞利用通常需要精心的内存操作，很容易隐藏恶意代码。
*   **代码质量问题：** PoC代码可能未经充分测试或包含错误，导致系统崩溃或不稳定。这虽然不是直接的投毒，但也可能对系统造成损害。
*   **依赖项风险：** PoC可能依赖于外部库或组件，这些库或组件本身可能存在漏洞或恶意代码。

考虑到这些因素，初步估计投毒风险为10%。更详细的代码审计可以提供更准确的风险评估。

**利用方式：**

1.  **触发漏洞：** 虚拟机内的攻击者，通过构造恶意的请求发送给Hyper-V主机。
2.  **堆溢出：** 恶意的请求会触发 Hyper-V NT Kernel Integration VSP 组件中的堆缓冲区溢出。
3.  **控制流劫持：** 利用堆溢出覆盖关键内核数据结构，例如函数指针，从而控制内核执行流。
4.  **权限提升：** 执行恶意代码，例如调用`PsLookupProcessByProcessId`和`SeAssignPrivileges`等函数，以提升虚拟机内的进程权限到 SYSTEM。
5.  **虚拟机逃逸：** 利用获得的 SYSTEM 权限，攻击者可以执行虚拟机逃逸操作，例如访问Hyper-V主机的文件系统，甚至控制整个主机。


**项目地址:** [B1ack4sh/Blackash-CVE-2025-21333](https://github.com/B1ack4sh/Blackash-CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #3

**来源**: [CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致系统权限提升

**影响版本:** Windows 10 21H2 (<= 10.0.19044.5371), Windows 11 22H2 (<= 10.0.22621.4751), Windows 10 22H2 (<= 10.0.19045.5371), Windows Server 2025 (<= 10.0.26100.2894), Windows 11 23H2 (<= 10.0.22631.4751), Windows 11 24H2 (<= 10.0.26100.2894), Windows Server 23H2 (<= 10.0.25398.1369)

**利用条件:** 需要Guest OS环境, 并需要利用I/O Ring机制进行攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 的特权提升漏洞。该漏洞是由于内核驱动`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。 

**漏洞利用方式：**

1.  **I/O Ring机制：** PoC利用了Windows I/O Ring机制，通过伪造IOP_MC_BUFFER_ENTRY结构体，从而实现内核任意地址读写。
2.  **堆溢出：** 通过在分页池中分配大量内存，然后触发堆溢出，覆盖IOP_MC_BUFFER_ENTRY结构体指针。
3.  **任意读写：** 覆盖后的`Address`可以指向任意内核地址，从而实现任意地址读写。
4. **提权：** 通过任意读写能力，可以修改当前进程的Token，从而提升权限。

**有效性：**

根据提供的PoC代码和搜索结果，该漏洞PoC的存在，并且已经被CISA列入已知被利用漏洞目录。PoC代码的README描述了如何在Windows 11 23h2上利用此漏洞进行提权，同时也说明了该PoC的可靠性可能不高。

**投毒风险：**

PoC代码本身是一个Visual Studio解决方案，包含C++源代码。 代码主要功能是利用堆溢出和I/O Ring机制实现内核任意地址读写，从而提升权限。审查代码后，发现潜在的投毒风险较低，例如：

*   **复杂性：** 代码相对复杂，阅读和理解需要一定的内核安全知识，增加了隐藏恶意代码的难度。
*   **公开性：** PoC本身是为了演示漏洞利用，作者倾向于公开透明，减少隐藏恶意代码的动机。
    但是，仍然存在一些微小的风险：
*   **细微修改：** 攻击者可能会在PoC代码中添加一些细微的修改，例如修改内存地址或增加延时，从而绕过安全检测。
*   **依赖项：** PoC可能依赖一些外部库或驱动，这些依赖项可能存在安全风险。

综上所述，该PoC代码存在10%的投毒风险，主要是考虑到细微修改和依赖项的潜在风险。


**项目地址:** [MrAle98/CVE-2025-21333-POC](https://github.com/MrAle98/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #4

**来源**: [CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致SYSTEM权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2 等受影响版本

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (Virtual Service Provider) 中的权限提升漏洞。该漏洞是由于 NT 内核集成 VSP 中存在堆缓冲区溢出造成的，攻击者可以利用此漏洞获得 SYSTEM 权限。

**有效性评估：**

根据漏洞描述和搜索结果，该漏洞是一个已知的、存在被利用的漏洞，CISA 已将其添加到已知被利用的漏洞目录中。 Reddit的帖子也表明有人发布了POC。提供的POC代码是一个Visual Studio解决方案，包含C++源代码，这进一步表明该漏洞是可以被利用的。readme描述利用了WNF state data 和 I/O ring IOP_MC_BUFFER_ENTRY，指向了具体利用的技术细节。

**投毒风险评估：**

评估POC代码的投毒风险需要仔细分析代码。从提供的代码片段来看，代码主要涉及Windows API调用，包括内存操作、对象操作、线程管理和进程管理等。初步分析没有发现明显的恶意代码或后门。但是考虑到漏洞利用代码本身的复杂性以及缺乏完整代码，存在一定的投毒风险，例如：

*   **隐蔽的权限提升：** 代码可能包含不易察觉的后门，在提权后执行恶意操作，例如安装恶意软件或收集敏感信息。
*   **代码注入：** 恶意代码可能会注入到其他进程中，从而绕过安全检测。
* **依赖风险:** readme中的链接可能指向恶意网站或包含恶意软件的下载链接。

虽然不能完全排除投毒的可能性，考虑到漏洞利用的复杂性，作者隐藏恶意代码的概率较低，因此暂定投毒风险为10%。

**利用方式分析：**

1.  **漏洞触发：** 攻击者利用Hyper-V NT Kernel Integration VSP中的漏洞，该漏洞位于内核态驱动中，允许从虚拟机内部触发。
2.  **堆溢出：** 利用特定的输入或操作，触发堆缓冲区溢出，覆盖相邻的内存区域。搜索结果表明是Paged Pool中的heap-based buffer overflow
3.  **权限提升：** 通过控制溢出的内容，例如覆盖内核对象或函数指针，攻击者可以将自己的权限提升到SYSTEM。
4.  **执行恶意代码：** 获得SYSTEM权限后，攻击者可以执行任意代码，例如安装恶意软件、窃取数据或控制系统。

**项目地址:** [Mukesh-blend/CVE-2025-21333-POC](https://github.com/Mukesh-blend/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #5

**来源**: [CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机数据泄露、完整性破坏和拒绝服务

**影响版本:** Windows 10 21H2 (版本 10.0.19043.0 到 10.0.19044.5371), Windows 11 22H2 (版本 10.0.22621.0 到 10.0.22621.4751), Windows 10 22H2 (版本 10.0.19045.0 到 10.0.19045.5371), Windows Server 2025 (版本 10.0.26100.0 到 10.0.26100.2894), Windows 11 23H2 (版本 10.0.22631.0 到 10.0.22631.4751), Windows Server 23H2 (版本 10.0.25398.0 到 10.0.25398.1369), Windows 11 24H2 (版本 10.0.26100.0 到 10.0.26100.2894)

**利用条件:** 本地用户权限，需要启用并运行Hyper-V。

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞。根据漏洞描述和搜索结果，攻击者可以利用恶意构造的 Virtual Service Provider (VSP) 来提升权限，最终控制 Hyper-V 主机。这是一个堆溢出漏洞（CWE-122）。

**有效性：**
提供的 POC 代码是一个 Visual Studio 解决方案，包含 C++ 代码。代码中包含Windows头文件，如 `<Windows.h>`, `<ioringapi.h>`和自定义头文件`wnf.h`。通过检查代码，可以发现其中利用了Windows Notification Facility（WNF）状态数据和I/O ring IOP_MC_BUFFER_ENTRY。搜索结果中reddit论坛的帖子也说明这是一个windows内核堆溢出漏洞，并提供了github链接。

**投毒风险：**
提供的代码片段中，最可疑的部分是 `README.md` 文件中提供的下载链接：`[Download Exploit](https://github.com/file/Soft.zip)`。该链接指向一个名为 `Soft.zip` 的 ZIP 文件，从不可信来源下载未经验证的可执行文件具有极高的风险。虽然直接提供的C++代码本身看起来是标准漏洞利用代码，但`README.md`文件中的下载链接是潜在的恶意软件投放点。用户可能被诱导下载包含恶意payload的zip文件，而非真正的漏洞利用程序。因此，存在较高的投毒风险。
另外，`wnf.h`等自定义头文件没有提供，意味着使用者必须自己查找或编写相关代码，这增加了利用难度，也为潜在的投毒留下了空间。攻击者可以提供带有恶意代码的`wnf.h`文件，诱导用户使用。
总体来说，投毒风险较高，估计为80%。

**利用方式：**
1.  **触发漏洞:** 利用特制的 VSP 触发 Hyper-V NT Kernel Integration 中的堆溢出。
2.  **WNF状态数据操控:** 通过操纵WNF状态数据，控制内核内存的布局。
3. **I/O ring IOP_MC_BUFFER_ENTRY：** 通过操控I/O环，控制内核内存的读写。
4.  **权限提升:** 覆盖关键内核数据结构，例如当前进程的 Token，将其替换为 SYSTEM 用户的 Token，从而提升权限。

**项目地址:** [SerabiLem/CVE-2025-21333-POC](https://github.com/SerabiLem/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #6

**来源**: [CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md](../2025/CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，本地攻击者可利用该漏洞获得SYSTEM权限

**影响版本:** Windows 10 21H2 (versionStartIncluding: 10.0.19043.0, versionEndExcluding: 10.0.19044.5371), Windows 11 22H2 (versionStartIncluding: 10.0.22621.0, versionEndExcluding: 10.0.22621.4751), Windows 10 22H2 (versionStartIncluding: 10.0.19045.0, versionEndExcluding: 10.0.19045.5371), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows Server 23H2 (versionStartIncluding: 10.0.25398.0, versionEndExcluding: 10.0.25398.1369), Windows 11 24H2 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894)

**利用条件:** 本地访问，需要运行受影响的Windows Hyper-V。

**POC 可用性:** 是，根据搜索结果，存在可用的POC代码

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 特权提升漏洞。该漏洞是由于`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。攻击者可以利用此漏洞在本地获得 SYSTEM 权限。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞影响多个Windows版本，并且CISA已将其列入已知被利用的漏洞目录，表明该漏洞具有实际的利用价值。搜索引擎结果显示存在公开的POC代码，进一步佐证了漏洞的可利用性。

**投毒风险：** 提供的漏洞利用代码是 KQL 查询语句，用于检测与 CVE-2025-21333 相关的可疑活动。代码本身用于安全事件的监控和分析，而非直接的漏洞利用。因此，可以认为该代码的投毒风险较低，但也需要人工审查代码的逻辑，判断是否存在恶意隐藏。例如，代码中可能会被利用来误报，影响正常的安全事件分析，所以投毒风险为 10%。

**利用方式：**  攻击者可以利用该漏洞通过与Hyper-V的NT内核集成VSP相关的组件，触发堆缓冲区溢出，最终获得SYSTEM权限。具体来说，`vkrnlintvsp.sys` 组件在处理来自虚拟机的数据时，如果没有进行充分的边界检查，可能导致缓冲区溢出。根据搜索结果，漏洞存在于主机操作系统和容器类型虚拟机之间的通信组件中。攻击者需要在受影响的系统上执行恶意代码，触发溢出，从而提升权限。实际的利用可能涉及到内存地址的计算、shellcode的注入等技术。

 简而言之，这是一个本地提权漏洞，攻击者通过精心构造的数据包与Hyper-V的内核集成服务进行交互，导致内核堆缓冲区溢出，从而覆盖关键数据并获得SYSTEM权限。

**项目地址:** [aleongx/KQL_sentinel_CVE-2025-21333](https://github.com/aleongx/KQL_sentinel_CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #7

**来源**: [CVE-2025-21333-pradip022_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-pradip022_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V NT Kernel Integration VSP

**危害等级:** 高危，可提升权限

**影响版本:** 受影响的版本包括Windows 10 21H2，Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等，具体版本范围见CVE描述。

**利用条件:** 需要目标系统运行Hyper-V，且虚拟机集成服务（VSP）存在漏洞。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP的权限提升漏洞，这是一个堆溢出漏洞(CWE-122)。根据搜索结果，存在公开的POC代码，并且该漏洞已被积极利用。漏洞利用代码的README.md文件描述了如何下载和运行该POC，指出利用涉及WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY。代码库中提供的Visual Studio解决方案文件，进一步证实了漏洞利用的存在。虽然github仓库描述了POC的简单用法,但是下载地址却指向了另一个github地址,存在诱导下载其他恶意文件的可能性. 同时考虑到windows内核漏洞利用通常需要较高的技术水平，且可能涉及复杂的内存操作, 因此存在投毒风险，风险概率评估为30%。

利用方式：攻击者可以利用此漏洞在Hyper-V环境中提升权限。具体利用方式涉及构造特定的WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY，触发堆溢出，从而执行恶意代码。

**项目地址:** [pradip022/CVE-2025-21333-POC](https://github.com/pradip022/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #8

**来源**: [CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md](../2025/CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2。具体版本范围参考CVE详情。

**利用条件:** 需要Hyper-V环境，guest操作系统执行漏洞利用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP权限提升漏洞，是一个基于堆的缓冲区溢出(CWE-122)。

**有效性评估：**
根据搜索结果和提供的PoC代码，该漏洞的PoC是有效的。搜索引擎结果中提到有writeup，POC代码可用，并且该漏洞已被积极利用。漏洞库信息也表明该漏洞已被CISA加入已知被利用漏洞列表(KEV)。 提供的PoC代码是一个用于演示缓冲区溢出漏洞的demo，虽然它不是直接可用的exp，但是它再现了崩溃行为，并且提供测试环境的搭建方法，以及调试的思路，对于理解漏洞原理非常有帮助。 

**投毒风险分析：**
提供的PoC代码主要由以下部分组成：
*   `LAB_SETUP.md`: 提供实验环境搭建的说明，强调安全措施。
*   `README.md`: 描述项目目标是用于教育和防御研究，不包含exploit代码。
*   `windbg_notes.md`: 提供WinDbg的使用提示。
*   `build.sh`: 用于编译`vuln_demo.c`的脚本。
*   `run_and_crash.md`:  提供运行demo并产生崩溃的指导。
*   `vuln_demo.c`: 包含一个故意存在漏洞的程序，用于演示缓冲区溢出。
*   `reports/analysis.md`: 分析报告模板

综合来看，代码库明确声明了其教育目的，并提供了安全建议以防止滥用。`vuln_demo.c`中的`strcpy`函数存在明显的缓冲区溢出漏洞，这与CVE描述相符。代码库没有发现任何恶意代码或隐藏功能。 投毒的可能来自于作者可能故意留下一些隐蔽的后门代码，例如在`vuln_demo.c`中添加一些不明显的恶意操作，或者在`build.sh`脚本中添加一些下载和执行恶意代码的命令。但考虑到代码的简单性和开源性质，以及作者声明的教育目的，这种可能性较低， 估计投毒风险在5%左右。

**利用方式分析：**
1.  **漏洞原理：** 该漏洞是由于Windows Hyper-V NT Kernel Integration VSP组件中存在堆缓冲区溢出漏洞(CWE-122)。 
2.  **利用步骤：**
    *   攻击者首先需要访问运行Hyper-V的系统，并且最好在Guest操作系统内。
    *   然后，攻击者可以通过向易受攻击的VSP组件发送特制的输入，触发堆缓冲区溢出。
    *   通过精巧的构造输入数据，攻击者可以覆盖相邻的内存区域，从而控制程序的执行流程。
    *   最终，攻击者可以利用此漏洞提升权限，例如从普通用户权限提升到系统管理员权限。
3.  **利用限制：** 漏洞利用需要在启用了Hyper-V的系统上进行，并且可能需要特定的系统配置和权限。


**项目地址:** [rahul0xkr/Hyper-V-CVE-2025-21333-Analysis](https://github.com/rahul0xkr/Hyper-V-CVE-2025-21333-Analysis)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #9

**来源**: [CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md](../2025/CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md)

# CVE-2025-21333

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21333-160102_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-160102_CVE-2025-21333-POC.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致权限提升

**影响版本:** 受影响的Windows版本包括Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等。

**利用条件:** 需要本地访问，在Hyper-V环境中。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP（Virtual Service Provider）权限提升漏洞。根据漏洞信息和搜索结果，该漏洞存在于Hyper-V的NT内核集成组件中，允许攻击者提升权限。漏洞利用代码显示这是一个C++项目，利用了WNF（Windows Notification Facility）状态数据和I/O ring IOP_MC_BUFFER_ENTRY来触发堆缓冲区溢出。该POC的Visual Studio解决方案文件表明它是一个可编译的项目，但存在投毒风险，因为从github下载zip存在未知风险。从代码来看，大量使用了Windows API，直接与内核交互，存在恶意修改内核的可能性，投毒风险评估为20%。利用方式通常包括：

1.  **触发漏洞：** 通过精心构造的WNF状态数据和I/O ring操作，触发NT内核集成组件中的堆缓冲区溢出。
2.  **控制执行流：** 覆盖堆上的关键数据结构，以控制内核的执行流程。
3.  **权限提升：** 通过修改当前进程的Token，将其权限提升到SYSTEM级别。

从搜索结果来看，该漏洞已经被CISA列入已知被利用漏洞目录，表明该漏洞具有较高的实际威胁。

**有效性评估：** 根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的，因为存在可编译的POC，并且CISA已经确认该漏洞被利用。

**投毒风险评估：** 该POC代码存在一定的投毒风险。因为需要下载压缩包，压缩包内部可能包含恶意代码，但主要代码是利用windows api进行操作，函数功能明确，没有发现明显的恶意行为，风险较低。


**项目地址:** [160102/CVE-2025-21333-POC](https://github.com/160102/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #2

**来源**: [CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md](../2025/CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 提权漏洞/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机逃逸，主机权限获取

**影响版本:** 受影响的Windows版本 (见漏洞库信息)

**利用条件:** 需要Guest虚拟机权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (虚拟机服务提供者) 中的提权漏洞，本质是堆溢出。攻击者（虚拟机内的用户）可以利用此漏洞，通过特制的请求导致在主机操作系统内核中发生堆缓冲区溢出，从而获得主机操作系统的管理员权限。

**有效性：**

根据搜索引擎结果，此漏洞已经被公开披露，并且存在公开可用的PoC（例如 GitHub上的`MrAle98/CVE-2025-21333-POC`仓库），表明该漏洞的利用已经得到验证。 漏洞库信息也表明CISA ADP已经将此漏洞添加到已知被利用漏洞列表中，进一步证明了其有效性。

提供的漏洞利用代码`/tmp/32315364bfebb19c9bcece1aca1942c9/README.md` 仅包含CVE编号的信息，本身并没有可执行的利用代码。但是，结合搜索引擎结果，可以找到其他存储库中提供的PoC 代码。

**投毒风险：**

由于提供的代码只是一个包含CVE编号的`README.md`文件，因此直接分析该文件进行投毒判断没有意义。真正的PoC代码位于其他存储库。但是，在实际利用PoC的过程中，需要仔细审查代码，因为PoC代码可能包含恶意修改。 

假设用户下载并执行了某个声称是CVE-2025-21333的PoC代码。 评估投毒风险。鉴于漏洞利用开发和安全研究的复杂性，有以下可能性：

*   **有意后门：** 某些代码作者可能会故意在PoC中添加后门，以便进一步攻击或控制目标系统。风险较高，因为内核漏洞利用通常需要精心的内存操作，很容易隐藏恶意代码。
*   **代码质量问题：** PoC代码可能未经充分测试或包含错误，导致系统崩溃或不稳定。这虽然不是直接的投毒，但也可能对系统造成损害。
*   **依赖项风险：** PoC可能依赖于外部库或组件，这些库或组件本身可能存在漏洞或恶意代码。

考虑到这些因素，初步估计投毒风险为10%。更详细的代码审计可以提供更准确的风险评估。

**利用方式：**

1.  **触发漏洞：** 虚拟机内的攻击者，通过构造恶意的请求发送给Hyper-V主机。
2.  **堆溢出：** 恶意的请求会触发 Hyper-V NT Kernel Integration VSP 组件中的堆缓冲区溢出。
3.  **控制流劫持：** 利用堆溢出覆盖关键内核数据结构，例如函数指针，从而控制内核执行流。
4.  **权限提升：** 执行恶意代码，例如调用`PsLookupProcessByProcessId`和`SeAssignPrivileges`等函数，以提升虚拟机内的进程权限到 SYSTEM。
5.  **虚拟机逃逸：** 利用获得的 SYSTEM 权限，攻击者可以执行虚拟机逃逸操作，例如访问Hyper-V主机的文件系统，甚至控制整个主机。


**项目地址:** [B1ack4sh/Blackash-CVE-2025-21333](https://github.com/B1ack4sh/Blackash-CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #3

**来源**: [CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致系统权限提升

**影响版本:** Windows 10 21H2 (<= 10.0.19044.5371), Windows 11 22H2 (<= 10.0.22621.4751), Windows 10 22H2 (<= 10.0.19045.5371), Windows Server 2025 (<= 10.0.26100.2894), Windows 11 23H2 (<= 10.0.22631.4751), Windows 11 24H2 (<= 10.0.26100.2894), Windows Server 23H2 (<= 10.0.25398.1369)

**利用条件:** 需要Guest OS环境, 并需要利用I/O Ring机制进行攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 的特权提升漏洞。该漏洞是由于内核驱动`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。 

**漏洞利用方式：**

1.  **I/O Ring机制：** PoC利用了Windows I/O Ring机制，通过伪造IOP_MC_BUFFER_ENTRY结构体，从而实现内核任意地址读写。
2.  **堆溢出：** 通过在分页池中分配大量内存，然后触发堆溢出，覆盖IOP_MC_BUFFER_ENTRY结构体指针。
3.  **任意读写：** 覆盖后的`Address`可以指向任意内核地址，从而实现任意地址读写。
4. **提权：** 通过任意读写能力，可以修改当前进程的Token，从而提升权限。

**有效性：**

根据提供的PoC代码和搜索结果，该漏洞PoC的存在，并且已经被CISA列入已知被利用漏洞目录。PoC代码的README描述了如何在Windows 11 23h2上利用此漏洞进行提权，同时也说明了该PoC的可靠性可能不高。

**投毒风险：**

PoC代码本身是一个Visual Studio解决方案，包含C++源代码。 代码主要功能是利用堆溢出和I/O Ring机制实现内核任意地址读写，从而提升权限。审查代码后，发现潜在的投毒风险较低，例如：

*   **复杂性：** 代码相对复杂，阅读和理解需要一定的内核安全知识，增加了隐藏恶意代码的难度。
*   **公开性：** PoC本身是为了演示漏洞利用，作者倾向于公开透明，减少隐藏恶意代码的动机。
    但是，仍然存在一些微小的风险：
*   **细微修改：** 攻击者可能会在PoC代码中添加一些细微的修改，例如修改内存地址或增加延时，从而绕过安全检测。
*   **依赖项：** PoC可能依赖一些外部库或驱动，这些依赖项可能存在安全风险。

综上所述，该PoC代码存在10%的投毒风险，主要是考虑到细微修改和依赖项的潜在风险。


**项目地址:** [MrAle98/CVE-2025-21333-POC](https://github.com/MrAle98/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #4

**来源**: [CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致SYSTEM权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2 等受影响版本

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (Virtual Service Provider) 中的权限提升漏洞。该漏洞是由于 NT 内核集成 VSP 中存在堆缓冲区溢出造成的，攻击者可以利用此漏洞获得 SYSTEM 权限。

**有效性评估：**

根据漏洞描述和搜索结果，该漏洞是一个已知的、存在被利用的漏洞，CISA 已将其添加到已知被利用的漏洞目录中。 Reddit的帖子也表明有人发布了POC。提供的POC代码是一个Visual Studio解决方案，包含C++源代码，这进一步表明该漏洞是可以被利用的。readme描述利用了WNF state data 和 I/O ring IOP_MC_BUFFER_ENTRY，指向了具体利用的技术细节。

**投毒风险评估：**

评估POC代码的投毒风险需要仔细分析代码。从提供的代码片段来看，代码主要涉及Windows API调用，包括内存操作、对象操作、线程管理和进程管理等。初步分析没有发现明显的恶意代码或后门。但是考虑到漏洞利用代码本身的复杂性以及缺乏完整代码，存在一定的投毒风险，例如：

*   **隐蔽的权限提升：** 代码可能包含不易察觉的后门，在提权后执行恶意操作，例如安装恶意软件或收集敏感信息。
*   **代码注入：** 恶意代码可能会注入到其他进程中，从而绕过安全检测。
* **依赖风险:** readme中的链接可能指向恶意网站或包含恶意软件的下载链接。

虽然不能完全排除投毒的可能性，考虑到漏洞利用的复杂性，作者隐藏恶意代码的概率较低，因此暂定投毒风险为10%。

**利用方式分析：**

1.  **漏洞触发：** 攻击者利用Hyper-V NT Kernel Integration VSP中的漏洞，该漏洞位于内核态驱动中，允许从虚拟机内部触发。
2.  **堆溢出：** 利用特定的输入或操作，触发堆缓冲区溢出，覆盖相邻的内存区域。搜索结果表明是Paged Pool中的heap-based buffer overflow
3.  **权限提升：** 通过控制溢出的内容，例如覆盖内核对象或函数指针，攻击者可以将自己的权限提升到SYSTEM。
4.  **执行恶意代码：** 获得SYSTEM权限后，攻击者可以执行任意代码，例如安装恶意软件、窃取数据或控制系统。

**项目地址:** [Mukesh-blend/CVE-2025-21333-POC](https://github.com/Mukesh-blend/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #5

**来源**: [CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机数据泄露、完整性破坏和拒绝服务

**影响版本:** Windows 10 21H2 (版本 10.0.19043.0 到 10.0.19044.5371), Windows 11 22H2 (版本 10.0.22621.0 到 10.0.22621.4751), Windows 10 22H2 (版本 10.0.19045.0 到 10.0.19045.5371), Windows Server 2025 (版本 10.0.26100.0 到 10.0.26100.2894), Windows 11 23H2 (版本 10.0.22631.0 到 10.0.22631.4751), Windows Server 23H2 (版本 10.0.25398.0 到 10.0.25398.1369), Windows 11 24H2 (版本 10.0.26100.0 到 10.0.26100.2894)

**利用条件:** 本地用户权限，需要启用并运行Hyper-V。

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞。根据漏洞描述和搜索结果，攻击者可以利用恶意构造的 Virtual Service Provider (VSP) 来提升权限，最终控制 Hyper-V 主机。这是一个堆溢出漏洞（CWE-122）。

**有效性：**
提供的 POC 代码是一个 Visual Studio 解决方案，包含 C++ 代码。代码中包含Windows头文件，如 `<Windows.h>`, `<ioringapi.h>`和自定义头文件`wnf.h`。通过检查代码，可以发现其中利用了Windows Notification Facility（WNF）状态数据和I/O ring IOP_MC_BUFFER_ENTRY。搜索结果中reddit论坛的帖子也说明这是一个windows内核堆溢出漏洞，并提供了github链接。

**投毒风险：**
提供的代码片段中，最可疑的部分是 `README.md` 文件中提供的下载链接：`[Download Exploit](https://github.com/file/Soft.zip)`。该链接指向一个名为 `Soft.zip` 的 ZIP 文件，从不可信来源下载未经验证的可执行文件具有极高的风险。虽然直接提供的C++代码本身看起来是标准漏洞利用代码，但`README.md`文件中的下载链接是潜在的恶意软件投放点。用户可能被诱导下载包含恶意payload的zip文件，而非真正的漏洞利用程序。因此，存在较高的投毒风险。
另外，`wnf.h`等自定义头文件没有提供，意味着使用者必须自己查找或编写相关代码，这增加了利用难度，也为潜在的投毒留下了空间。攻击者可以提供带有恶意代码的`wnf.h`文件，诱导用户使用。
总体来说，投毒风险较高，估计为80%。

**利用方式：**
1.  **触发漏洞:** 利用特制的 VSP 触发 Hyper-V NT Kernel Integration 中的堆溢出。
2.  **WNF状态数据操控:** 通过操纵WNF状态数据，控制内核内存的布局。
3. **I/O ring IOP_MC_BUFFER_ENTRY：** 通过操控I/O环，控制内核内存的读写。
4.  **权限提升:** 覆盖关键内核数据结构，例如当前进程的 Token，将其替换为 SYSTEM 用户的 Token，从而提升权限。

**项目地址:** [SerabiLem/CVE-2025-21333-POC](https://github.com/SerabiLem/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #6

**来源**: [CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md](../2025/CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，本地攻击者可利用该漏洞获得SYSTEM权限

**影响版本:** Windows 10 21H2 (versionStartIncluding: 10.0.19043.0, versionEndExcluding: 10.0.19044.5371), Windows 11 22H2 (versionStartIncluding: 10.0.22621.0, versionEndExcluding: 10.0.22621.4751), Windows 10 22H2 (versionStartIncluding: 10.0.19045.0, versionEndExcluding: 10.0.19045.5371), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows Server 23H2 (versionStartIncluding: 10.0.25398.0, versionEndExcluding: 10.0.25398.1369), Windows 11 24H2 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894)

**利用条件:** 本地访问，需要运行受影响的Windows Hyper-V。

**POC 可用性:** 是，根据搜索结果，存在可用的POC代码

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 特权提升漏洞。该漏洞是由于`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。攻击者可以利用此漏洞在本地获得 SYSTEM 权限。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞影响多个Windows版本，并且CISA已将其列入已知被利用的漏洞目录，表明该漏洞具有实际的利用价值。搜索引擎结果显示存在公开的POC代码，进一步佐证了漏洞的可利用性。

**投毒风险：** 提供的漏洞利用代码是 KQL 查询语句，用于检测与 CVE-2025-21333 相关的可疑活动。代码本身用于安全事件的监控和分析，而非直接的漏洞利用。因此，可以认为该代码的投毒风险较低，但也需要人工审查代码的逻辑，判断是否存在恶意隐藏。例如，代码中可能会被利用来误报，影响正常的安全事件分析，所以投毒风险为 10%。

**利用方式：**  攻击者可以利用该漏洞通过与Hyper-V的NT内核集成VSP相关的组件，触发堆缓冲区溢出，最终获得SYSTEM权限。具体来说，`vkrnlintvsp.sys` 组件在处理来自虚拟机的数据时，如果没有进行充分的边界检查，可能导致缓冲区溢出。根据搜索结果，漏洞存在于主机操作系统和容器类型虚拟机之间的通信组件中。攻击者需要在受影响的系统上执行恶意代码，触发溢出，从而提升权限。实际的利用可能涉及到内存地址的计算、shellcode的注入等技术。

 简而言之，这是一个本地提权漏洞，攻击者通过精心构造的数据包与Hyper-V的内核集成服务进行交互，导致内核堆缓冲区溢出，从而覆盖关键数据并获得SYSTEM权限。

**项目地址:** [aleongx/KQL_sentinel_CVE-2025-21333](https://github.com/aleongx/KQL_sentinel_CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #7

**来源**: [CVE-2025-21333-pradip022_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-pradip022_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V NT Kernel Integration VSP

**危害等级:** 高危，可提升权限

**影响版本:** 受影响的版本包括Windows 10 21H2，Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等，具体版本范围见CVE描述。

**利用条件:** 需要目标系统运行Hyper-V，且虚拟机集成服务（VSP）存在漏洞。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP的权限提升漏洞，这是一个堆溢出漏洞(CWE-122)。根据搜索结果，存在公开的POC代码，并且该漏洞已被积极利用。漏洞利用代码的README.md文件描述了如何下载和运行该POC，指出利用涉及WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY。代码库中提供的Visual Studio解决方案文件，进一步证实了漏洞利用的存在。虽然github仓库描述了POC的简单用法,但是下载地址却指向了另一个github地址,存在诱导下载其他恶意文件的可能性. 同时考虑到windows内核漏洞利用通常需要较高的技术水平，且可能涉及复杂的内存操作, 因此存在投毒风险，风险概率评估为30%。

利用方式：攻击者可以利用此漏洞在Hyper-V环境中提升权限。具体利用方式涉及构造特定的WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY，触发堆溢出，从而执行恶意代码。

**项目地址:** [pradip022/CVE-2025-21333-POC](https://github.com/pradip022/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #8

**来源**: [CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md](../2025/CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2。具体版本范围参考CVE详情。

**利用条件:** 需要Hyper-V环境，guest操作系统执行漏洞利用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP权限提升漏洞，是一个基于堆的缓冲区溢出(CWE-122)。

**有效性评估：**
根据搜索结果和提供的PoC代码，该漏洞的PoC是有效的。搜索引擎结果中提到有writeup，POC代码可用，并且该漏洞已被积极利用。漏洞库信息也表明该漏洞已被CISA加入已知被利用漏洞列表(KEV)。 提供的PoC代码是一个用于演示缓冲区溢出漏洞的demo，虽然它不是直接可用的exp，但是它再现了崩溃行为，并且提供测试环境的搭建方法，以及调试的思路，对于理解漏洞原理非常有帮助。 

**投毒风险分析：**
提供的PoC代码主要由以下部分组成：
*   `LAB_SETUP.md`: 提供实验环境搭建的说明，强调安全措施。
*   `README.md`: 描述项目目标是用于教育和防御研究，不包含exploit代码。
*   `windbg_notes.md`: 提供WinDbg的使用提示。
*   `build.sh`: 用于编译`vuln_demo.c`的脚本。
*   `run_and_crash.md`:  提供运行demo并产生崩溃的指导。
*   `vuln_demo.c`: 包含一个故意存在漏洞的程序，用于演示缓冲区溢出。
*   `reports/analysis.md`: 分析报告模板

综合来看，代码库明确声明了其教育目的，并提供了安全建议以防止滥用。`vuln_demo.c`中的`strcpy`函数存在明显的缓冲区溢出漏洞，这与CVE描述相符。代码库没有发现任何恶意代码或隐藏功能。 投毒的可能来自于作者可能故意留下一些隐蔽的后门代码，例如在`vuln_demo.c`中添加一些不明显的恶意操作，或者在`build.sh`脚本中添加一些下载和执行恶意代码的命令。但考虑到代码的简单性和开源性质，以及作者声明的教育目的，这种可能性较低， 估计投毒风险在5%左右。

**利用方式分析：**
1.  **漏洞原理：** 该漏洞是由于Windows Hyper-V NT Kernel Integration VSP组件中存在堆缓冲区溢出漏洞(CWE-122)。 
2.  **利用步骤：**
    *   攻击者首先需要访问运行Hyper-V的系统，并且最好在Guest操作系统内。
    *   然后，攻击者可以通过向易受攻击的VSP组件发送特制的输入，触发堆缓冲区溢出。
    *   通过精巧的构造输入数据，攻击者可以覆盖相邻的内存区域，从而控制程序的执行流程。
    *   最终，攻击者可以利用此漏洞提升权限，例如从普通用户权限提升到系统管理员权限。
3.  **利用限制：** 漏洞利用需要在启用了Hyper-V的系统上进行，并且可能需要特定的系统配置和权限。


**项目地址:** [rahul0xkr/Hyper-V-CVE-2025-21333-Analysis](https://github.com/rahul0xkr/Hyper-V-CVE-2025-21333-Analysis)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #9

**来源**: [CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md](../2025/CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md)

# CVE-2025-21333

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21333-160102_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-160102_CVE-2025-21333-POC.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致权限提升

**影响版本:** 受影响的Windows版本包括Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等。

**利用条件:** 需要本地访问，在Hyper-V环境中。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP（Virtual Service Provider）权限提升漏洞。根据漏洞信息和搜索结果，该漏洞存在于Hyper-V的NT内核集成组件中，允许攻击者提升权限。漏洞利用代码显示这是一个C++项目，利用了WNF（Windows Notification Facility）状态数据和I/O ring IOP_MC_BUFFER_ENTRY来触发堆缓冲区溢出。该POC的Visual Studio解决方案文件表明它是一个可编译的项目，但存在投毒风险，因为从github下载zip存在未知风险。从代码来看，大量使用了Windows API，直接与内核交互，存在恶意修改内核的可能性，投毒风险评估为20%。利用方式通常包括：

1.  **触发漏洞：** 通过精心构造的WNF状态数据和I/O ring操作，触发NT内核集成组件中的堆缓冲区溢出。
2.  **控制执行流：** 覆盖堆上的关键数据结构，以控制内核的执行流程。
3.  **权限提升：** 通过修改当前进程的Token，将其权限提升到SYSTEM级别。

从搜索结果来看，该漏洞已经被CISA列入已知被利用漏洞目录，表明该漏洞具有较高的实际威胁。

**有效性评估：** 根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的，因为存在可编译的POC，并且CISA已经确认该漏洞被利用。

**投毒风险评估：** 该POC代码存在一定的投毒风险。因为需要下载压缩包，压缩包内部可能包含恶意代码，但主要代码是利用windows api进行操作，函数功能明确，没有发现明显的恶意行为，风险较低。


**项目地址:** [160102/CVE-2025-21333-POC](https://github.com/160102/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #2

**来源**: [CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md](../2025/CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 提权漏洞/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机逃逸，主机权限获取

**影响版本:** 受影响的Windows版本 (见漏洞库信息)

**利用条件:** 需要Guest虚拟机权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (虚拟机服务提供者) 中的提权漏洞，本质是堆溢出。攻击者（虚拟机内的用户）可以利用此漏洞，通过特制的请求导致在主机操作系统内核中发生堆缓冲区溢出，从而获得主机操作系统的管理员权限。

**有效性：**

根据搜索引擎结果，此漏洞已经被公开披露，并且存在公开可用的PoC（例如 GitHub上的`MrAle98/CVE-2025-21333-POC`仓库），表明该漏洞的利用已经得到验证。 漏洞库信息也表明CISA ADP已经将此漏洞添加到已知被利用漏洞列表中，进一步证明了其有效性。

提供的漏洞利用代码`/tmp/32315364bfebb19c9bcece1aca1942c9/README.md` 仅包含CVE编号的信息，本身并没有可执行的利用代码。但是，结合搜索引擎结果，可以找到其他存储库中提供的PoC 代码。

**投毒风险：**

由于提供的代码只是一个包含CVE编号的`README.md`文件，因此直接分析该文件进行投毒判断没有意义。真正的PoC代码位于其他存储库。但是，在实际利用PoC的过程中，需要仔细审查代码，因为PoC代码可能包含恶意修改。 

假设用户下载并执行了某个声称是CVE-2025-21333的PoC代码。 评估投毒风险。鉴于漏洞利用开发和安全研究的复杂性，有以下可能性：

*   **有意后门：** 某些代码作者可能会故意在PoC中添加后门，以便进一步攻击或控制目标系统。风险较高，因为内核漏洞利用通常需要精心的内存操作，很容易隐藏恶意代码。
*   **代码质量问题：** PoC代码可能未经充分测试或包含错误，导致系统崩溃或不稳定。这虽然不是直接的投毒，但也可能对系统造成损害。
*   **依赖项风险：** PoC可能依赖于外部库或组件，这些库或组件本身可能存在漏洞或恶意代码。

考虑到这些因素，初步估计投毒风险为10%。更详细的代码审计可以提供更准确的风险评估。

**利用方式：**

1.  **触发漏洞：** 虚拟机内的攻击者，通过构造恶意的请求发送给Hyper-V主机。
2.  **堆溢出：** 恶意的请求会触发 Hyper-V NT Kernel Integration VSP 组件中的堆缓冲区溢出。
3.  **控制流劫持：** 利用堆溢出覆盖关键内核数据结构，例如函数指针，从而控制内核执行流。
4.  **权限提升：** 执行恶意代码，例如调用`PsLookupProcessByProcessId`和`SeAssignPrivileges`等函数，以提升虚拟机内的进程权限到 SYSTEM。
5.  **虚拟机逃逸：** 利用获得的 SYSTEM 权限，攻击者可以执行虚拟机逃逸操作，例如访问Hyper-V主机的文件系统，甚至控制整个主机。


**项目地址:** [B1ack4sh/Blackash-CVE-2025-21333](https://github.com/B1ack4sh/Blackash-CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #3

**来源**: [CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致系统权限提升

**影响版本:** Windows 10 21H2 (<= 10.0.19044.5371), Windows 11 22H2 (<= 10.0.22621.4751), Windows 10 22H2 (<= 10.0.19045.5371), Windows Server 2025 (<= 10.0.26100.2894), Windows 11 23H2 (<= 10.0.22631.4751), Windows 11 24H2 (<= 10.0.26100.2894), Windows Server 23H2 (<= 10.0.25398.1369)

**利用条件:** 需要Guest OS环境, 并需要利用I/O Ring机制进行攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 的特权提升漏洞。该漏洞是由于内核驱动`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。 

**漏洞利用方式：**

1.  **I/O Ring机制：** PoC利用了Windows I/O Ring机制，通过伪造IOP_MC_BUFFER_ENTRY结构体，从而实现内核任意地址读写。
2.  **堆溢出：** 通过在分页池中分配大量内存，然后触发堆溢出，覆盖IOP_MC_BUFFER_ENTRY结构体指针。
3.  **任意读写：** 覆盖后的`Address`可以指向任意内核地址，从而实现任意地址读写。
4. **提权：** 通过任意读写能力，可以修改当前进程的Token，从而提升权限。

**有效性：**

根据提供的PoC代码和搜索结果，该漏洞PoC的存在，并且已经被CISA列入已知被利用漏洞目录。PoC代码的README描述了如何在Windows 11 23h2上利用此漏洞进行提权，同时也说明了该PoC的可靠性可能不高。

**投毒风险：**

PoC代码本身是一个Visual Studio解决方案，包含C++源代码。 代码主要功能是利用堆溢出和I/O Ring机制实现内核任意地址读写，从而提升权限。审查代码后，发现潜在的投毒风险较低，例如：

*   **复杂性：** 代码相对复杂，阅读和理解需要一定的内核安全知识，增加了隐藏恶意代码的难度。
*   **公开性：** PoC本身是为了演示漏洞利用，作者倾向于公开透明，减少隐藏恶意代码的动机。
    但是，仍然存在一些微小的风险：
*   **细微修改：** 攻击者可能会在PoC代码中添加一些细微的修改，例如修改内存地址或增加延时，从而绕过安全检测。
*   **依赖项：** PoC可能依赖一些外部库或驱动，这些依赖项可能存在安全风险。

综上所述，该PoC代码存在10%的投毒风险，主要是考虑到细微修改和依赖项的潜在风险。


**项目地址:** [MrAle98/CVE-2025-21333-POC](https://github.com/MrAle98/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #4

**来源**: [CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致SYSTEM权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2 等受影响版本

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (Virtual Service Provider) 中的权限提升漏洞。该漏洞是由于 NT 内核集成 VSP 中存在堆缓冲区溢出造成的，攻击者可以利用此漏洞获得 SYSTEM 权限。

**有效性评估：**

根据漏洞描述和搜索结果，该漏洞是一个已知的、存在被利用的漏洞，CISA 已将其添加到已知被利用的漏洞目录中。 Reddit的帖子也表明有人发布了POC。提供的POC代码是一个Visual Studio解决方案，包含C++源代码，这进一步表明该漏洞是可以被利用的。readme描述利用了WNF state data 和 I/O ring IOP_MC_BUFFER_ENTRY，指向了具体利用的技术细节。

**投毒风险评估：**

评估POC代码的投毒风险需要仔细分析代码。从提供的代码片段来看，代码主要涉及Windows API调用，包括内存操作、对象操作、线程管理和进程管理等。初步分析没有发现明显的恶意代码或后门。但是考虑到漏洞利用代码本身的复杂性以及缺乏完整代码，存在一定的投毒风险，例如：

*   **隐蔽的权限提升：** 代码可能包含不易察觉的后门，在提权后执行恶意操作，例如安装恶意软件或收集敏感信息。
*   **代码注入：** 恶意代码可能会注入到其他进程中，从而绕过安全检测。
* **依赖风险:** readme中的链接可能指向恶意网站或包含恶意软件的下载链接。

虽然不能完全排除投毒的可能性，考虑到漏洞利用的复杂性，作者隐藏恶意代码的概率较低，因此暂定投毒风险为10%。

**利用方式分析：**

1.  **漏洞触发：** 攻击者利用Hyper-V NT Kernel Integration VSP中的漏洞，该漏洞位于内核态驱动中，允许从虚拟机内部触发。
2.  **堆溢出：** 利用特定的输入或操作，触发堆缓冲区溢出，覆盖相邻的内存区域。搜索结果表明是Paged Pool中的heap-based buffer overflow
3.  **权限提升：** 通过控制溢出的内容，例如覆盖内核对象或函数指针，攻击者可以将自己的权限提升到SYSTEM。
4.  **执行恶意代码：** 获得SYSTEM权限后，攻击者可以执行任意代码，例如安装恶意软件、窃取数据或控制系统。

**项目地址:** [Mukesh-blend/CVE-2025-21333-POC](https://github.com/Mukesh-blend/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #5

**来源**: [CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机数据泄露、完整性破坏和拒绝服务

**影响版本:** Windows 10 21H2 (版本 10.0.19043.0 到 10.0.19044.5371), Windows 11 22H2 (版本 10.0.22621.0 到 10.0.22621.4751), Windows 10 22H2 (版本 10.0.19045.0 到 10.0.19045.5371), Windows Server 2025 (版本 10.0.26100.0 到 10.0.26100.2894), Windows 11 23H2 (版本 10.0.22631.0 到 10.0.22631.4751), Windows Server 23H2 (版本 10.0.25398.0 到 10.0.25398.1369), Windows 11 24H2 (版本 10.0.26100.0 到 10.0.26100.2894)

**利用条件:** 本地用户权限，需要启用并运行Hyper-V。

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞。根据漏洞描述和搜索结果，攻击者可以利用恶意构造的 Virtual Service Provider (VSP) 来提升权限，最终控制 Hyper-V 主机。这是一个堆溢出漏洞（CWE-122）。

**有效性：**
提供的 POC 代码是一个 Visual Studio 解决方案，包含 C++ 代码。代码中包含Windows头文件，如 `<Windows.h>`, `<ioringapi.h>`和自定义头文件`wnf.h`。通过检查代码，可以发现其中利用了Windows Notification Facility（WNF）状态数据和I/O ring IOP_MC_BUFFER_ENTRY。搜索结果中reddit论坛的帖子也说明这是一个windows内核堆溢出漏洞，并提供了github链接。

**投毒风险：**
提供的代码片段中，最可疑的部分是 `README.md` 文件中提供的下载链接：`[Download Exploit](https://github.com/file/Soft.zip)`。该链接指向一个名为 `Soft.zip` 的 ZIP 文件，从不可信来源下载未经验证的可执行文件具有极高的风险。虽然直接提供的C++代码本身看起来是标准漏洞利用代码，但`README.md`文件中的下载链接是潜在的恶意软件投放点。用户可能被诱导下载包含恶意payload的zip文件，而非真正的漏洞利用程序。因此，存在较高的投毒风险。
另外，`wnf.h`等自定义头文件没有提供，意味着使用者必须自己查找或编写相关代码，这增加了利用难度，也为潜在的投毒留下了空间。攻击者可以提供带有恶意代码的`wnf.h`文件，诱导用户使用。
总体来说，投毒风险较高，估计为80%。

**利用方式：**
1.  **触发漏洞:** 利用特制的 VSP 触发 Hyper-V NT Kernel Integration 中的堆溢出。
2.  **WNF状态数据操控:** 通过操纵WNF状态数据，控制内核内存的布局。
3. **I/O ring IOP_MC_BUFFER_ENTRY：** 通过操控I/O环，控制内核内存的读写。
4.  **权限提升:** 覆盖关键内核数据结构，例如当前进程的 Token，将其替换为 SYSTEM 用户的 Token，从而提升权限。

**项目地址:** [SerabiLem/CVE-2025-21333-POC](https://github.com/SerabiLem/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #6

**来源**: [CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md](../2025/CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，本地攻击者可利用该漏洞获得SYSTEM权限

**影响版本:** Windows 10 21H2 (versionStartIncluding: 10.0.19043.0, versionEndExcluding: 10.0.19044.5371), Windows 11 22H2 (versionStartIncluding: 10.0.22621.0, versionEndExcluding: 10.0.22621.4751), Windows 10 22H2 (versionStartIncluding: 10.0.19045.0, versionEndExcluding: 10.0.19045.5371), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows Server 23H2 (versionStartIncluding: 10.0.25398.0, versionEndExcluding: 10.0.25398.1369), Windows 11 24H2 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894)

**利用条件:** 本地访问，需要运行受影响的Windows Hyper-V。

**POC 可用性:** 是，根据搜索结果，存在可用的POC代码

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 特权提升漏洞。该漏洞是由于`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。攻击者可以利用此漏洞在本地获得 SYSTEM 权限。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞影响多个Windows版本，并且CISA已将其列入已知被利用的漏洞目录，表明该漏洞具有实际的利用价值。搜索引擎结果显示存在公开的POC代码，进一步佐证了漏洞的可利用性。

**投毒风险：** 提供的漏洞利用代码是 KQL 查询语句，用于检测与 CVE-2025-21333 相关的可疑活动。代码本身用于安全事件的监控和分析，而非直接的漏洞利用。因此，可以认为该代码的投毒风险较低，但也需要人工审查代码的逻辑，判断是否存在恶意隐藏。例如，代码中可能会被利用来误报，影响正常的安全事件分析，所以投毒风险为 10%。

**利用方式：**  攻击者可以利用该漏洞通过与Hyper-V的NT内核集成VSP相关的组件，触发堆缓冲区溢出，最终获得SYSTEM权限。具体来说，`vkrnlintvsp.sys` 组件在处理来自虚拟机的数据时，如果没有进行充分的边界检查，可能导致缓冲区溢出。根据搜索结果，漏洞存在于主机操作系统和容器类型虚拟机之间的通信组件中。攻击者需要在受影响的系统上执行恶意代码，触发溢出，从而提升权限。实际的利用可能涉及到内存地址的计算、shellcode的注入等技术。

 简而言之，这是一个本地提权漏洞，攻击者通过精心构造的数据包与Hyper-V的内核集成服务进行交互，导致内核堆缓冲区溢出，从而覆盖关键数据并获得SYSTEM权限。

**项目地址:** [aleongx/KQL_sentinel_CVE-2025-21333](https://github.com/aleongx/KQL_sentinel_CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #7

**来源**: [CVE-2025-21333-pradip022_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-pradip022_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V NT Kernel Integration VSP

**危害等级:** 高危，可提升权限

**影响版本:** 受影响的版本包括Windows 10 21H2，Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等，具体版本范围见CVE描述。

**利用条件:** 需要目标系统运行Hyper-V，且虚拟机集成服务（VSP）存在漏洞。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP的权限提升漏洞，这是一个堆溢出漏洞(CWE-122)。根据搜索结果，存在公开的POC代码，并且该漏洞已被积极利用。漏洞利用代码的README.md文件描述了如何下载和运行该POC，指出利用涉及WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY。代码库中提供的Visual Studio解决方案文件，进一步证实了漏洞利用的存在。虽然github仓库描述了POC的简单用法,但是下载地址却指向了另一个github地址,存在诱导下载其他恶意文件的可能性. 同时考虑到windows内核漏洞利用通常需要较高的技术水平，且可能涉及复杂的内存操作, 因此存在投毒风险，风险概率评估为30%。

利用方式：攻击者可以利用此漏洞在Hyper-V环境中提升权限。具体利用方式涉及构造特定的WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY，触发堆溢出，从而执行恶意代码。

**项目地址:** [pradip022/CVE-2025-21333-POC](https://github.com/pradip022/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #8

**来源**: [CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md](../2025/CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2。具体版本范围参考CVE详情。

**利用条件:** 需要Hyper-V环境，guest操作系统执行漏洞利用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP权限提升漏洞，是一个基于堆的缓冲区溢出(CWE-122)。

**有效性评估：**
根据搜索结果和提供的PoC代码，该漏洞的PoC是有效的。搜索引擎结果中提到有writeup，POC代码可用，并且该漏洞已被积极利用。漏洞库信息也表明该漏洞已被CISA加入已知被利用漏洞列表(KEV)。 提供的PoC代码是一个用于演示缓冲区溢出漏洞的demo，虽然它不是直接可用的exp，但是它再现了崩溃行为，并且提供测试环境的搭建方法，以及调试的思路，对于理解漏洞原理非常有帮助。 

**投毒风险分析：**
提供的PoC代码主要由以下部分组成：
*   `LAB_SETUP.md`: 提供实验环境搭建的说明，强调安全措施。
*   `README.md`: 描述项目目标是用于教育和防御研究，不包含exploit代码。
*   `windbg_notes.md`: 提供WinDbg的使用提示。
*   `build.sh`: 用于编译`vuln_demo.c`的脚本。
*   `run_and_crash.md`:  提供运行demo并产生崩溃的指导。
*   `vuln_demo.c`: 包含一个故意存在漏洞的程序，用于演示缓冲区溢出。
*   `reports/analysis.md`: 分析报告模板

综合来看，代码库明确声明了其教育目的，并提供了安全建议以防止滥用。`vuln_demo.c`中的`strcpy`函数存在明显的缓冲区溢出漏洞，这与CVE描述相符。代码库没有发现任何恶意代码或隐藏功能。 投毒的可能来自于作者可能故意留下一些隐蔽的后门代码，例如在`vuln_demo.c`中添加一些不明显的恶意操作，或者在`build.sh`脚本中添加一些下载和执行恶意代码的命令。但考虑到代码的简单性和开源性质，以及作者声明的教育目的，这种可能性较低， 估计投毒风险在5%左右。

**利用方式分析：**
1.  **漏洞原理：** 该漏洞是由于Windows Hyper-V NT Kernel Integration VSP组件中存在堆缓冲区溢出漏洞(CWE-122)。 
2.  **利用步骤：**
    *   攻击者首先需要访问运行Hyper-V的系统，并且最好在Guest操作系统内。
    *   然后，攻击者可以通过向易受攻击的VSP组件发送特制的输入，触发堆缓冲区溢出。
    *   通过精巧的构造输入数据，攻击者可以覆盖相邻的内存区域，从而控制程序的执行流程。
    *   最终，攻击者可以利用此漏洞提升权限，例如从普通用户权限提升到系统管理员权限。
3.  **利用限制：** 漏洞利用需要在启用了Hyper-V的系统上进行，并且可能需要特定的系统配置和权限。


**项目地址:** [rahul0xkr/Hyper-V-CVE-2025-21333-Analysis](https://github.com/rahul0xkr/Hyper-V-CVE-2025-21333-Analysis)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #9

**来源**: [CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md](../2025/CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md)

# CVE-2025-21333

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21333-160102_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-160102_CVE-2025-21333-POC.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致权限提升

**影响版本:** 受影响的Windows版本包括Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等。

**利用条件:** 需要本地访问，在Hyper-V环境中。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP（Virtual Service Provider）权限提升漏洞。根据漏洞信息和搜索结果，该漏洞存在于Hyper-V的NT内核集成组件中，允许攻击者提升权限。漏洞利用代码显示这是一个C++项目，利用了WNF（Windows Notification Facility）状态数据和I/O ring IOP_MC_BUFFER_ENTRY来触发堆缓冲区溢出。该POC的Visual Studio解决方案文件表明它是一个可编译的项目，但存在投毒风险，因为从github下载zip存在未知风险。从代码来看，大量使用了Windows API，直接与内核交互，存在恶意修改内核的可能性，投毒风险评估为20%。利用方式通常包括：

1.  **触发漏洞：** 通过精心构造的WNF状态数据和I/O ring操作，触发NT内核集成组件中的堆缓冲区溢出。
2.  **控制执行流：** 覆盖堆上的关键数据结构，以控制内核的执行流程。
3.  **权限提升：** 通过修改当前进程的Token，将其权限提升到SYSTEM级别。

从搜索结果来看，该漏洞已经被CISA列入已知被利用漏洞目录，表明该漏洞具有较高的实际威胁。

**有效性评估：** 根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的，因为存在可编译的POC，并且CISA已经确认该漏洞被利用。

**投毒风险评估：** 该POC代码存在一定的投毒风险。因为需要下载压缩包，压缩包内部可能包含恶意代码，但主要代码是利用windows api进行操作，函数功能明确，没有发现明显的恶意行为，风险较低。


**项目地址:** [160102/CVE-2025-21333-POC](https://github.com/160102/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #2

**来源**: [CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md](../2025/CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 提权漏洞/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机逃逸，主机权限获取

**影响版本:** 受影响的Windows版本 (见漏洞库信息)

**利用条件:** 需要Guest虚拟机权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (虚拟机服务提供者) 中的提权漏洞，本质是堆溢出。攻击者（虚拟机内的用户）可以利用此漏洞，通过特制的请求导致在主机操作系统内核中发生堆缓冲区溢出，从而获得主机操作系统的管理员权限。

**有效性：**

根据搜索引擎结果，此漏洞已经被公开披露，并且存在公开可用的PoC（例如 GitHub上的`MrAle98/CVE-2025-21333-POC`仓库），表明该漏洞的利用已经得到验证。 漏洞库信息也表明CISA ADP已经将此漏洞添加到已知被利用漏洞列表中，进一步证明了其有效性。

提供的漏洞利用代码`/tmp/32315364bfebb19c9bcece1aca1942c9/README.md` 仅包含CVE编号的信息，本身并没有可执行的利用代码。但是，结合搜索引擎结果，可以找到其他存储库中提供的PoC 代码。

**投毒风险：**

由于提供的代码只是一个包含CVE编号的`README.md`文件，因此直接分析该文件进行投毒判断没有意义。真正的PoC代码位于其他存储库。但是，在实际利用PoC的过程中，需要仔细审查代码，因为PoC代码可能包含恶意修改。 

假设用户下载并执行了某个声称是CVE-2025-21333的PoC代码。 评估投毒风险。鉴于漏洞利用开发和安全研究的复杂性，有以下可能性：

*   **有意后门：** 某些代码作者可能会故意在PoC中添加后门，以便进一步攻击或控制目标系统。风险较高，因为内核漏洞利用通常需要精心的内存操作，很容易隐藏恶意代码。
*   **代码质量问题：** PoC代码可能未经充分测试或包含错误，导致系统崩溃或不稳定。这虽然不是直接的投毒，但也可能对系统造成损害。
*   **依赖项风险：** PoC可能依赖于外部库或组件，这些库或组件本身可能存在漏洞或恶意代码。

考虑到这些因素，初步估计投毒风险为10%。更详细的代码审计可以提供更准确的风险评估。

**利用方式：**

1.  **触发漏洞：** 虚拟机内的攻击者，通过构造恶意的请求发送给Hyper-V主机。
2.  **堆溢出：** 恶意的请求会触发 Hyper-V NT Kernel Integration VSP 组件中的堆缓冲区溢出。
3.  **控制流劫持：** 利用堆溢出覆盖关键内核数据结构，例如函数指针，从而控制内核执行流。
4.  **权限提升：** 执行恶意代码，例如调用`PsLookupProcessByProcessId`和`SeAssignPrivileges`等函数，以提升虚拟机内的进程权限到 SYSTEM。
5.  **虚拟机逃逸：** 利用获得的 SYSTEM 权限，攻击者可以执行虚拟机逃逸操作，例如访问Hyper-V主机的文件系统，甚至控制整个主机。


**项目地址:** [B1ack4sh/Blackash-CVE-2025-21333](https://github.com/B1ack4sh/Blackash-CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #3

**来源**: [CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致系统权限提升

**影响版本:** Windows 10 21H2 (<= 10.0.19044.5371), Windows 11 22H2 (<= 10.0.22621.4751), Windows 10 22H2 (<= 10.0.19045.5371), Windows Server 2025 (<= 10.0.26100.2894), Windows 11 23H2 (<= 10.0.22631.4751), Windows 11 24H2 (<= 10.0.26100.2894), Windows Server 23H2 (<= 10.0.25398.1369)

**利用条件:** 需要Guest OS环境, 并需要利用I/O Ring机制进行攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 的特权提升漏洞。该漏洞是由于内核驱动`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。 

**漏洞利用方式：**

1.  **I/O Ring机制：** PoC利用了Windows I/O Ring机制，通过伪造IOP_MC_BUFFER_ENTRY结构体，从而实现内核任意地址读写。
2.  **堆溢出：** 通过在分页池中分配大量内存，然后触发堆溢出，覆盖IOP_MC_BUFFER_ENTRY结构体指针。
3.  **任意读写：** 覆盖后的`Address`可以指向任意内核地址，从而实现任意地址读写。
4. **提权：** 通过任意读写能力，可以修改当前进程的Token，从而提升权限。

**有效性：**

根据提供的PoC代码和搜索结果，该漏洞PoC的存在，并且已经被CISA列入已知被利用漏洞目录。PoC代码的README描述了如何在Windows 11 23h2上利用此漏洞进行提权，同时也说明了该PoC的可靠性可能不高。

**投毒风险：**

PoC代码本身是一个Visual Studio解决方案，包含C++源代码。 代码主要功能是利用堆溢出和I/O Ring机制实现内核任意地址读写，从而提升权限。审查代码后，发现潜在的投毒风险较低，例如：

*   **复杂性：** 代码相对复杂，阅读和理解需要一定的内核安全知识，增加了隐藏恶意代码的难度。
*   **公开性：** PoC本身是为了演示漏洞利用，作者倾向于公开透明，减少隐藏恶意代码的动机。
    但是，仍然存在一些微小的风险：
*   **细微修改：** 攻击者可能会在PoC代码中添加一些细微的修改，例如修改内存地址或增加延时，从而绕过安全检测。
*   **依赖项：** PoC可能依赖一些外部库或驱动，这些依赖项可能存在安全风险。

综上所述，该PoC代码存在10%的投毒风险，主要是考虑到细微修改和依赖项的潜在风险。


**项目地址:** [MrAle98/CVE-2025-21333-POC](https://github.com/MrAle98/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #4

**来源**: [CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致SYSTEM权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2 等受影响版本

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (Virtual Service Provider) 中的权限提升漏洞。该漏洞是由于 NT 内核集成 VSP 中存在堆缓冲区溢出造成的，攻击者可以利用此漏洞获得 SYSTEM 权限。

**有效性评估：**

根据漏洞描述和搜索结果，该漏洞是一个已知的、存在被利用的漏洞，CISA 已将其添加到已知被利用的漏洞目录中。 Reddit的帖子也表明有人发布了POC。提供的POC代码是一个Visual Studio解决方案，包含C++源代码，这进一步表明该漏洞是可以被利用的。readme描述利用了WNF state data 和 I/O ring IOP_MC_BUFFER_ENTRY，指向了具体利用的技术细节。

**投毒风险评估：**

评估POC代码的投毒风险需要仔细分析代码。从提供的代码片段来看，代码主要涉及Windows API调用，包括内存操作、对象操作、线程管理和进程管理等。初步分析没有发现明显的恶意代码或后门。但是考虑到漏洞利用代码本身的复杂性以及缺乏完整代码，存在一定的投毒风险，例如：

*   **隐蔽的权限提升：** 代码可能包含不易察觉的后门，在提权后执行恶意操作，例如安装恶意软件或收集敏感信息。
*   **代码注入：** 恶意代码可能会注入到其他进程中，从而绕过安全检测。
* **依赖风险:** readme中的链接可能指向恶意网站或包含恶意软件的下载链接。

虽然不能完全排除投毒的可能性，考虑到漏洞利用的复杂性，作者隐藏恶意代码的概率较低，因此暂定投毒风险为10%。

**利用方式分析：**

1.  **漏洞触发：** 攻击者利用Hyper-V NT Kernel Integration VSP中的漏洞，该漏洞位于内核态驱动中，允许从虚拟机内部触发。
2.  **堆溢出：** 利用特定的输入或操作，触发堆缓冲区溢出，覆盖相邻的内存区域。搜索结果表明是Paged Pool中的heap-based buffer overflow
3.  **权限提升：** 通过控制溢出的内容，例如覆盖内核对象或函数指针，攻击者可以将自己的权限提升到SYSTEM。
4.  **执行恶意代码：** 获得SYSTEM权限后，攻击者可以执行任意代码，例如安装恶意软件、窃取数据或控制系统。

**项目地址:** [Mukesh-blend/CVE-2025-21333-POC](https://github.com/Mukesh-blend/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #5

**来源**: [CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机数据泄露、完整性破坏和拒绝服务

**影响版本:** Windows 10 21H2 (版本 10.0.19043.0 到 10.0.19044.5371), Windows 11 22H2 (版本 10.0.22621.0 到 10.0.22621.4751), Windows 10 22H2 (版本 10.0.19045.0 到 10.0.19045.5371), Windows Server 2025 (版本 10.0.26100.0 到 10.0.26100.2894), Windows 11 23H2 (版本 10.0.22631.0 到 10.0.22631.4751), Windows Server 23H2 (版本 10.0.25398.0 到 10.0.25398.1369), Windows 11 24H2 (版本 10.0.26100.0 到 10.0.26100.2894)

**利用条件:** 本地用户权限，需要启用并运行Hyper-V。

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞。根据漏洞描述和搜索结果，攻击者可以利用恶意构造的 Virtual Service Provider (VSP) 来提升权限，最终控制 Hyper-V 主机。这是一个堆溢出漏洞（CWE-122）。

**有效性：**
提供的 POC 代码是一个 Visual Studio 解决方案，包含 C++ 代码。代码中包含Windows头文件，如 `<Windows.h>`, `<ioringapi.h>`和自定义头文件`wnf.h`。通过检查代码，可以发现其中利用了Windows Notification Facility（WNF）状态数据和I/O ring IOP_MC_BUFFER_ENTRY。搜索结果中reddit论坛的帖子也说明这是一个windows内核堆溢出漏洞，并提供了github链接。

**投毒风险：**
提供的代码片段中，最可疑的部分是 `README.md` 文件中提供的下载链接：`[Download Exploit](https://github.com/file/Soft.zip)`。该链接指向一个名为 `Soft.zip` 的 ZIP 文件，从不可信来源下载未经验证的可执行文件具有极高的风险。虽然直接提供的C++代码本身看起来是标准漏洞利用代码，但`README.md`文件中的下载链接是潜在的恶意软件投放点。用户可能被诱导下载包含恶意payload的zip文件，而非真正的漏洞利用程序。因此，存在较高的投毒风险。
另外，`wnf.h`等自定义头文件没有提供，意味着使用者必须自己查找或编写相关代码，这增加了利用难度，也为潜在的投毒留下了空间。攻击者可以提供带有恶意代码的`wnf.h`文件，诱导用户使用。
总体来说，投毒风险较高，估计为80%。

**利用方式：**
1.  **触发漏洞:** 利用特制的 VSP 触发 Hyper-V NT Kernel Integration 中的堆溢出。
2.  **WNF状态数据操控:** 通过操纵WNF状态数据，控制内核内存的布局。
3. **I/O ring IOP_MC_BUFFER_ENTRY：** 通过操控I/O环，控制内核内存的读写。
4.  **权限提升:** 覆盖关键内核数据结构，例如当前进程的 Token，将其替换为 SYSTEM 用户的 Token，从而提升权限。

**项目地址:** [SerabiLem/CVE-2025-21333-POC](https://github.com/SerabiLem/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #6

**来源**: [CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md](../2025/CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，本地攻击者可利用该漏洞获得SYSTEM权限

**影响版本:** Windows 10 21H2 (versionStartIncluding: 10.0.19043.0, versionEndExcluding: 10.0.19044.5371), Windows 11 22H2 (versionStartIncluding: 10.0.22621.0, versionEndExcluding: 10.0.22621.4751), Windows 10 22H2 (versionStartIncluding: 10.0.19045.0, versionEndExcluding: 10.0.19045.5371), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows Server 23H2 (versionStartIncluding: 10.0.25398.0, versionEndExcluding: 10.0.25398.1369), Windows 11 24H2 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894)

**利用条件:** 本地访问，需要运行受影响的Windows Hyper-V。

**POC 可用性:** 是，根据搜索结果，存在可用的POC代码

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 特权提升漏洞。该漏洞是由于`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。攻击者可以利用此漏洞在本地获得 SYSTEM 权限。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞影响多个Windows版本，并且CISA已将其列入已知被利用的漏洞目录，表明该漏洞具有实际的利用价值。搜索引擎结果显示存在公开的POC代码，进一步佐证了漏洞的可利用性。

**投毒风险：** 提供的漏洞利用代码是 KQL 查询语句，用于检测与 CVE-2025-21333 相关的可疑活动。代码本身用于安全事件的监控和分析，而非直接的漏洞利用。因此，可以认为该代码的投毒风险较低，但也需要人工审查代码的逻辑，判断是否存在恶意隐藏。例如，代码中可能会被利用来误报，影响正常的安全事件分析，所以投毒风险为 10%。

**利用方式：**  攻击者可以利用该漏洞通过与Hyper-V的NT内核集成VSP相关的组件，触发堆缓冲区溢出，最终获得SYSTEM权限。具体来说，`vkrnlintvsp.sys` 组件在处理来自虚拟机的数据时，如果没有进行充分的边界检查，可能导致缓冲区溢出。根据搜索结果，漏洞存在于主机操作系统和容器类型虚拟机之间的通信组件中。攻击者需要在受影响的系统上执行恶意代码，触发溢出，从而提升权限。实际的利用可能涉及到内存地址的计算、shellcode的注入等技术。

 简而言之，这是一个本地提权漏洞，攻击者通过精心构造的数据包与Hyper-V的内核集成服务进行交互，导致内核堆缓冲区溢出，从而覆盖关键数据并获得SYSTEM权限。

**项目地址:** [aleongx/KQL_sentinel_CVE-2025-21333](https://github.com/aleongx/KQL_sentinel_CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #7

**来源**: [CVE-2025-21333-pradip022_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-pradip022_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V NT Kernel Integration VSP

**危害等级:** 高危，可提升权限

**影响版本:** 受影响的版本包括Windows 10 21H2，Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等，具体版本范围见CVE描述。

**利用条件:** 需要目标系统运行Hyper-V，且虚拟机集成服务（VSP）存在漏洞。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP的权限提升漏洞，这是一个堆溢出漏洞(CWE-122)。根据搜索结果，存在公开的POC代码，并且该漏洞已被积极利用。漏洞利用代码的README.md文件描述了如何下载和运行该POC，指出利用涉及WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY。代码库中提供的Visual Studio解决方案文件，进一步证实了漏洞利用的存在。虽然github仓库描述了POC的简单用法,但是下载地址却指向了另一个github地址,存在诱导下载其他恶意文件的可能性. 同时考虑到windows内核漏洞利用通常需要较高的技术水平，且可能涉及复杂的内存操作, 因此存在投毒风险，风险概率评估为30%。

利用方式：攻击者可以利用此漏洞在Hyper-V环境中提升权限。具体利用方式涉及构造特定的WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY，触发堆溢出，从而执行恶意代码。

**项目地址:** [pradip022/CVE-2025-21333-POC](https://github.com/pradip022/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #8

**来源**: [CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md](../2025/CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2。具体版本范围参考CVE详情。

**利用条件:** 需要Hyper-V环境，guest操作系统执行漏洞利用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP权限提升漏洞，是一个基于堆的缓冲区溢出(CWE-122)。

**有效性评估：**
根据搜索结果和提供的PoC代码，该漏洞的PoC是有效的。搜索引擎结果中提到有writeup，POC代码可用，并且该漏洞已被积极利用。漏洞库信息也表明该漏洞已被CISA加入已知被利用漏洞列表(KEV)。 提供的PoC代码是一个用于演示缓冲区溢出漏洞的demo，虽然它不是直接可用的exp，但是它再现了崩溃行为，并且提供测试环境的搭建方法，以及调试的思路，对于理解漏洞原理非常有帮助。 

**投毒风险分析：**
提供的PoC代码主要由以下部分组成：
*   `LAB_SETUP.md`: 提供实验环境搭建的说明，强调安全措施。
*   `README.md`: 描述项目目标是用于教育和防御研究，不包含exploit代码。
*   `windbg_notes.md`: 提供WinDbg的使用提示。
*   `build.sh`: 用于编译`vuln_demo.c`的脚本。
*   `run_and_crash.md`:  提供运行demo并产生崩溃的指导。
*   `vuln_demo.c`: 包含一个故意存在漏洞的程序，用于演示缓冲区溢出。
*   `reports/analysis.md`: 分析报告模板

综合来看，代码库明确声明了其教育目的，并提供了安全建议以防止滥用。`vuln_demo.c`中的`strcpy`函数存在明显的缓冲区溢出漏洞，这与CVE描述相符。代码库没有发现任何恶意代码或隐藏功能。 投毒的可能来自于作者可能故意留下一些隐蔽的后门代码，例如在`vuln_demo.c`中添加一些不明显的恶意操作，或者在`build.sh`脚本中添加一些下载和执行恶意代码的命令。但考虑到代码的简单性和开源性质，以及作者声明的教育目的，这种可能性较低， 估计投毒风险在5%左右。

**利用方式分析：**
1.  **漏洞原理：** 该漏洞是由于Windows Hyper-V NT Kernel Integration VSP组件中存在堆缓冲区溢出漏洞(CWE-122)。 
2.  **利用步骤：**
    *   攻击者首先需要访问运行Hyper-V的系统，并且最好在Guest操作系统内。
    *   然后，攻击者可以通过向易受攻击的VSP组件发送特制的输入，触发堆缓冲区溢出。
    *   通过精巧的构造输入数据，攻击者可以覆盖相邻的内存区域，从而控制程序的执行流程。
    *   最终，攻击者可以利用此漏洞提升权限，例如从普通用户权限提升到系统管理员权限。
3.  **利用限制：** 漏洞利用需要在启用了Hyper-V的系统上进行，并且可能需要特定的系统配置和权限。


**项目地址:** [rahul0xkr/Hyper-V-CVE-2025-21333-Analysis](https://github.com/rahul0xkr/Hyper-V-CVE-2025-21333-Analysis)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #9

**来源**: [CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md](../2025/CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md)

# CVE-2025-21333

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21333-160102_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-160102_CVE-2025-21333-POC.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致权限提升

**影响版本:** 受影响的Windows版本包括Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等。

**利用条件:** 需要本地访问，在Hyper-V环境中。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP（Virtual Service Provider）权限提升漏洞。根据漏洞信息和搜索结果，该漏洞存在于Hyper-V的NT内核集成组件中，允许攻击者提升权限。漏洞利用代码显示这是一个C++项目，利用了WNF（Windows Notification Facility）状态数据和I/O ring IOP_MC_BUFFER_ENTRY来触发堆缓冲区溢出。该POC的Visual Studio解决方案文件表明它是一个可编译的项目，但存在投毒风险，因为从github下载zip存在未知风险。从代码来看，大量使用了Windows API，直接与内核交互，存在恶意修改内核的可能性，投毒风险评估为20%。利用方式通常包括：

1.  **触发漏洞：** 通过精心构造的WNF状态数据和I/O ring操作，触发NT内核集成组件中的堆缓冲区溢出。
2.  **控制执行流：** 覆盖堆上的关键数据结构，以控制内核的执行流程。
3.  **权限提升：** 通过修改当前进程的Token，将其权限提升到SYSTEM级别。

从搜索结果来看，该漏洞已经被CISA列入已知被利用漏洞目录，表明该漏洞具有较高的实际威胁。

**有效性评估：** 根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的，因为存在可编译的POC，并且CISA已经确认该漏洞被利用。

**投毒风险评估：** 该POC代码存在一定的投毒风险。因为需要下载压缩包，压缩包内部可能包含恶意代码，但主要代码是利用windows api进行操作，函数功能明确，没有发现明显的恶意行为，风险较低。


**项目地址:** [160102/CVE-2025-21333-POC](https://github.com/160102/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #2

**来源**: [CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md](../2025/CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 提权漏洞/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机逃逸，主机权限获取

**影响版本:** 受影响的Windows版本 (见漏洞库信息)

**利用条件:** 需要Guest虚拟机权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (虚拟机服务提供者) 中的提权漏洞，本质是堆溢出。攻击者（虚拟机内的用户）可以利用此漏洞，通过特制的请求导致在主机操作系统内核中发生堆缓冲区溢出，从而获得主机操作系统的管理员权限。

**有效性：**

根据搜索引擎结果，此漏洞已经被公开披露，并且存在公开可用的PoC（例如 GitHub上的`MrAle98/CVE-2025-21333-POC`仓库），表明该漏洞的利用已经得到验证。 漏洞库信息也表明CISA ADP已经将此漏洞添加到已知被利用漏洞列表中，进一步证明了其有效性。

提供的漏洞利用代码`/tmp/32315364bfebb19c9bcece1aca1942c9/README.md` 仅包含CVE编号的信息，本身并没有可执行的利用代码。但是，结合搜索引擎结果，可以找到其他存储库中提供的PoC 代码。

**投毒风险：**

由于提供的代码只是一个包含CVE编号的`README.md`文件，因此直接分析该文件进行投毒判断没有意义。真正的PoC代码位于其他存储库。但是，在实际利用PoC的过程中，需要仔细审查代码，因为PoC代码可能包含恶意修改。 

假设用户下载并执行了某个声称是CVE-2025-21333的PoC代码。 评估投毒风险。鉴于漏洞利用开发和安全研究的复杂性，有以下可能性：

*   **有意后门：** 某些代码作者可能会故意在PoC中添加后门，以便进一步攻击或控制目标系统。风险较高，因为内核漏洞利用通常需要精心的内存操作，很容易隐藏恶意代码。
*   **代码质量问题：** PoC代码可能未经充分测试或包含错误，导致系统崩溃或不稳定。这虽然不是直接的投毒，但也可能对系统造成损害。
*   **依赖项风险：** PoC可能依赖于外部库或组件，这些库或组件本身可能存在漏洞或恶意代码。

考虑到这些因素，初步估计投毒风险为10%。更详细的代码审计可以提供更准确的风险评估。

**利用方式：**

1.  **触发漏洞：** 虚拟机内的攻击者，通过构造恶意的请求发送给Hyper-V主机。
2.  **堆溢出：** 恶意的请求会触发 Hyper-V NT Kernel Integration VSP 组件中的堆缓冲区溢出。
3.  **控制流劫持：** 利用堆溢出覆盖关键内核数据结构，例如函数指针，从而控制内核执行流。
4.  **权限提升：** 执行恶意代码，例如调用`PsLookupProcessByProcessId`和`SeAssignPrivileges`等函数，以提升虚拟机内的进程权限到 SYSTEM。
5.  **虚拟机逃逸：** 利用获得的 SYSTEM 权限，攻击者可以执行虚拟机逃逸操作，例如访问Hyper-V主机的文件系统，甚至控制整个主机。


**项目地址:** [B1ack4sh/Blackash-CVE-2025-21333](https://github.com/B1ack4sh/Blackash-CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #3

**来源**: [CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致系统权限提升

**影响版本:** Windows 10 21H2 (<= 10.0.19044.5371), Windows 11 22H2 (<= 10.0.22621.4751), Windows 10 22H2 (<= 10.0.19045.5371), Windows Server 2025 (<= 10.0.26100.2894), Windows 11 23H2 (<= 10.0.22631.4751), Windows 11 24H2 (<= 10.0.26100.2894), Windows Server 23H2 (<= 10.0.25398.1369)

**利用条件:** 需要Guest OS环境, 并需要利用I/O Ring机制进行攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 的特权提升漏洞。该漏洞是由于内核驱动`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。 

**漏洞利用方式：**

1.  **I/O Ring机制：** PoC利用了Windows I/O Ring机制，通过伪造IOP_MC_BUFFER_ENTRY结构体，从而实现内核任意地址读写。
2.  **堆溢出：** 通过在分页池中分配大量内存，然后触发堆溢出，覆盖IOP_MC_BUFFER_ENTRY结构体指针。
3.  **任意读写：** 覆盖后的`Address`可以指向任意内核地址，从而实现任意地址读写。
4. **提权：** 通过任意读写能力，可以修改当前进程的Token，从而提升权限。

**有效性：**

根据提供的PoC代码和搜索结果，该漏洞PoC的存在，并且已经被CISA列入已知被利用漏洞目录。PoC代码的README描述了如何在Windows 11 23h2上利用此漏洞进行提权，同时也说明了该PoC的可靠性可能不高。

**投毒风险：**

PoC代码本身是一个Visual Studio解决方案，包含C++源代码。 代码主要功能是利用堆溢出和I/O Ring机制实现内核任意地址读写，从而提升权限。审查代码后，发现潜在的投毒风险较低，例如：

*   **复杂性：** 代码相对复杂，阅读和理解需要一定的内核安全知识，增加了隐藏恶意代码的难度。
*   **公开性：** PoC本身是为了演示漏洞利用，作者倾向于公开透明，减少隐藏恶意代码的动机。
    但是，仍然存在一些微小的风险：
*   **细微修改：** 攻击者可能会在PoC代码中添加一些细微的修改，例如修改内存地址或增加延时，从而绕过安全检测。
*   **依赖项：** PoC可能依赖一些外部库或驱动，这些依赖项可能存在安全风险。

综上所述，该PoC代码存在10%的投毒风险，主要是考虑到细微修改和依赖项的潜在风险。


**项目地址:** [MrAle98/CVE-2025-21333-POC](https://github.com/MrAle98/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #4

**来源**: [CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致SYSTEM权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2 等受影响版本

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (Virtual Service Provider) 中的权限提升漏洞。该漏洞是由于 NT 内核集成 VSP 中存在堆缓冲区溢出造成的，攻击者可以利用此漏洞获得 SYSTEM 权限。

**有效性评估：**

根据漏洞描述和搜索结果，该漏洞是一个已知的、存在被利用的漏洞，CISA 已将其添加到已知被利用的漏洞目录中。 Reddit的帖子也表明有人发布了POC。提供的POC代码是一个Visual Studio解决方案，包含C++源代码，这进一步表明该漏洞是可以被利用的。readme描述利用了WNF state data 和 I/O ring IOP_MC_BUFFER_ENTRY，指向了具体利用的技术细节。

**投毒风险评估：**

评估POC代码的投毒风险需要仔细分析代码。从提供的代码片段来看，代码主要涉及Windows API调用，包括内存操作、对象操作、线程管理和进程管理等。初步分析没有发现明显的恶意代码或后门。但是考虑到漏洞利用代码本身的复杂性以及缺乏完整代码，存在一定的投毒风险，例如：

*   **隐蔽的权限提升：** 代码可能包含不易察觉的后门，在提权后执行恶意操作，例如安装恶意软件或收集敏感信息。
*   **代码注入：** 恶意代码可能会注入到其他进程中，从而绕过安全检测。
* **依赖风险:** readme中的链接可能指向恶意网站或包含恶意软件的下载链接。

虽然不能完全排除投毒的可能性，考虑到漏洞利用的复杂性，作者隐藏恶意代码的概率较低，因此暂定投毒风险为10%。

**利用方式分析：**

1.  **漏洞触发：** 攻击者利用Hyper-V NT Kernel Integration VSP中的漏洞，该漏洞位于内核态驱动中，允许从虚拟机内部触发。
2.  **堆溢出：** 利用特定的输入或操作，触发堆缓冲区溢出，覆盖相邻的内存区域。搜索结果表明是Paged Pool中的heap-based buffer overflow
3.  **权限提升：** 通过控制溢出的内容，例如覆盖内核对象或函数指针，攻击者可以将自己的权限提升到SYSTEM。
4.  **执行恶意代码：** 获得SYSTEM权限后，攻击者可以执行任意代码，例如安装恶意软件、窃取数据或控制系统。

**项目地址:** [Mukesh-blend/CVE-2025-21333-POC](https://github.com/Mukesh-blend/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #5

**来源**: [CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机数据泄露、完整性破坏和拒绝服务

**影响版本:** Windows 10 21H2 (版本 10.0.19043.0 到 10.0.19044.5371), Windows 11 22H2 (版本 10.0.22621.0 到 10.0.22621.4751), Windows 10 22H2 (版本 10.0.19045.0 到 10.0.19045.5371), Windows Server 2025 (版本 10.0.26100.0 到 10.0.26100.2894), Windows 11 23H2 (版本 10.0.22631.0 到 10.0.22631.4751), Windows Server 23H2 (版本 10.0.25398.0 到 10.0.25398.1369), Windows 11 24H2 (版本 10.0.26100.0 到 10.0.26100.2894)

**利用条件:** 本地用户权限，需要启用并运行Hyper-V。

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞。根据漏洞描述和搜索结果，攻击者可以利用恶意构造的 Virtual Service Provider (VSP) 来提升权限，最终控制 Hyper-V 主机。这是一个堆溢出漏洞（CWE-122）。

**有效性：**
提供的 POC 代码是一个 Visual Studio 解决方案，包含 C++ 代码。代码中包含Windows头文件，如 `<Windows.h>`, `<ioringapi.h>`和自定义头文件`wnf.h`。通过检查代码，可以发现其中利用了Windows Notification Facility（WNF）状态数据和I/O ring IOP_MC_BUFFER_ENTRY。搜索结果中reddit论坛的帖子也说明这是一个windows内核堆溢出漏洞，并提供了github链接。

**投毒风险：**
提供的代码片段中，最可疑的部分是 `README.md` 文件中提供的下载链接：`[Download Exploit](https://github.com/file/Soft.zip)`。该链接指向一个名为 `Soft.zip` 的 ZIP 文件，从不可信来源下载未经验证的可执行文件具有极高的风险。虽然直接提供的C++代码本身看起来是标准漏洞利用代码，但`README.md`文件中的下载链接是潜在的恶意软件投放点。用户可能被诱导下载包含恶意payload的zip文件，而非真正的漏洞利用程序。因此，存在较高的投毒风险。
另外，`wnf.h`等自定义头文件没有提供，意味着使用者必须自己查找或编写相关代码，这增加了利用难度，也为潜在的投毒留下了空间。攻击者可以提供带有恶意代码的`wnf.h`文件，诱导用户使用。
总体来说，投毒风险较高，估计为80%。

**利用方式：**
1.  **触发漏洞:** 利用特制的 VSP 触发 Hyper-V NT Kernel Integration 中的堆溢出。
2.  **WNF状态数据操控:** 通过操纵WNF状态数据，控制内核内存的布局。
3. **I/O ring IOP_MC_BUFFER_ENTRY：** 通过操控I/O环，控制内核内存的读写。
4.  **权限提升:** 覆盖关键内核数据结构，例如当前进程的 Token，将其替换为 SYSTEM 用户的 Token，从而提升权限。

**项目地址:** [SerabiLem/CVE-2025-21333-POC](https://github.com/SerabiLem/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #6

**来源**: [CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md](../2025/CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，本地攻击者可利用该漏洞获得SYSTEM权限

**影响版本:** Windows 10 21H2 (versionStartIncluding: 10.0.19043.0, versionEndExcluding: 10.0.19044.5371), Windows 11 22H2 (versionStartIncluding: 10.0.22621.0, versionEndExcluding: 10.0.22621.4751), Windows 10 22H2 (versionStartIncluding: 10.0.19045.0, versionEndExcluding: 10.0.19045.5371), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows Server 23H2 (versionStartIncluding: 10.0.25398.0, versionEndExcluding: 10.0.25398.1369), Windows 11 24H2 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894)

**利用条件:** 本地访问，需要运行受影响的Windows Hyper-V。

**POC 可用性:** 是，根据搜索结果，存在可用的POC代码

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 特权提升漏洞。该漏洞是由于`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。攻击者可以利用此漏洞在本地获得 SYSTEM 权限。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞影响多个Windows版本，并且CISA已将其列入已知被利用的漏洞目录，表明该漏洞具有实际的利用价值。搜索引擎结果显示存在公开的POC代码，进一步佐证了漏洞的可利用性。

**投毒风险：** 提供的漏洞利用代码是 KQL 查询语句，用于检测与 CVE-2025-21333 相关的可疑活动。代码本身用于安全事件的监控和分析，而非直接的漏洞利用。因此，可以认为该代码的投毒风险较低，但也需要人工审查代码的逻辑，判断是否存在恶意隐藏。例如，代码中可能会被利用来误报，影响正常的安全事件分析，所以投毒风险为 10%。

**利用方式：**  攻击者可以利用该漏洞通过与Hyper-V的NT内核集成VSP相关的组件，触发堆缓冲区溢出，最终获得SYSTEM权限。具体来说，`vkrnlintvsp.sys` 组件在处理来自虚拟机的数据时，如果没有进行充分的边界检查，可能导致缓冲区溢出。根据搜索结果，漏洞存在于主机操作系统和容器类型虚拟机之间的通信组件中。攻击者需要在受影响的系统上执行恶意代码，触发溢出，从而提升权限。实际的利用可能涉及到内存地址的计算、shellcode的注入等技术。

 简而言之，这是一个本地提权漏洞，攻击者通过精心构造的数据包与Hyper-V的内核集成服务进行交互，导致内核堆缓冲区溢出，从而覆盖关键数据并获得SYSTEM权限。

**项目地址:** [aleongx/KQL_sentinel_CVE-2025-21333](https://github.com/aleongx/KQL_sentinel_CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #7

**来源**: [CVE-2025-21333-pradip022_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-pradip022_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V NT Kernel Integration VSP

**危害等级:** 高危，可提升权限

**影响版本:** 受影响的版本包括Windows 10 21H2，Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等，具体版本范围见CVE描述。

**利用条件:** 需要目标系统运行Hyper-V，且虚拟机集成服务（VSP）存在漏洞。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP的权限提升漏洞，这是一个堆溢出漏洞(CWE-122)。根据搜索结果，存在公开的POC代码，并且该漏洞已被积极利用。漏洞利用代码的README.md文件描述了如何下载和运行该POC，指出利用涉及WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY。代码库中提供的Visual Studio解决方案文件，进一步证实了漏洞利用的存在。虽然github仓库描述了POC的简单用法,但是下载地址却指向了另一个github地址,存在诱导下载其他恶意文件的可能性. 同时考虑到windows内核漏洞利用通常需要较高的技术水平，且可能涉及复杂的内存操作, 因此存在投毒风险，风险概率评估为30%。

利用方式：攻击者可以利用此漏洞在Hyper-V环境中提升权限。具体利用方式涉及构造特定的WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY，触发堆溢出，从而执行恶意代码。

**项目地址:** [pradip022/CVE-2025-21333-POC](https://github.com/pradip022/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #8

**来源**: [CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md](../2025/CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2。具体版本范围参考CVE详情。

**利用条件:** 需要Hyper-V环境，guest操作系统执行漏洞利用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP权限提升漏洞，是一个基于堆的缓冲区溢出(CWE-122)。

**有效性评估：**
根据搜索结果和提供的PoC代码，该漏洞的PoC是有效的。搜索引擎结果中提到有writeup，POC代码可用，并且该漏洞已被积极利用。漏洞库信息也表明该漏洞已被CISA加入已知被利用漏洞列表(KEV)。 提供的PoC代码是一个用于演示缓冲区溢出漏洞的demo，虽然它不是直接可用的exp，但是它再现了崩溃行为，并且提供测试环境的搭建方法，以及调试的思路，对于理解漏洞原理非常有帮助。 

**投毒风险分析：**
提供的PoC代码主要由以下部分组成：
*   `LAB_SETUP.md`: 提供实验环境搭建的说明，强调安全措施。
*   `README.md`: 描述项目目标是用于教育和防御研究，不包含exploit代码。
*   `windbg_notes.md`: 提供WinDbg的使用提示。
*   `build.sh`: 用于编译`vuln_demo.c`的脚本。
*   `run_and_crash.md`:  提供运行demo并产生崩溃的指导。
*   `vuln_demo.c`: 包含一个故意存在漏洞的程序，用于演示缓冲区溢出。
*   `reports/analysis.md`: 分析报告模板

综合来看，代码库明确声明了其教育目的，并提供了安全建议以防止滥用。`vuln_demo.c`中的`strcpy`函数存在明显的缓冲区溢出漏洞，这与CVE描述相符。代码库没有发现任何恶意代码或隐藏功能。 投毒的可能来自于作者可能故意留下一些隐蔽的后门代码，例如在`vuln_demo.c`中添加一些不明显的恶意操作，或者在`build.sh`脚本中添加一些下载和执行恶意代码的命令。但考虑到代码的简单性和开源性质，以及作者声明的教育目的，这种可能性较低， 估计投毒风险在5%左右。

**利用方式分析：**
1.  **漏洞原理：** 该漏洞是由于Windows Hyper-V NT Kernel Integration VSP组件中存在堆缓冲区溢出漏洞(CWE-122)。 
2.  **利用步骤：**
    *   攻击者首先需要访问运行Hyper-V的系统，并且最好在Guest操作系统内。
    *   然后，攻击者可以通过向易受攻击的VSP组件发送特制的输入，触发堆缓冲区溢出。
    *   通过精巧的构造输入数据，攻击者可以覆盖相邻的内存区域，从而控制程序的执行流程。
    *   最终，攻击者可以利用此漏洞提升权限，例如从普通用户权限提升到系统管理员权限。
3.  **利用限制：** 漏洞利用需要在启用了Hyper-V的系统上进行，并且可能需要特定的系统配置和权限。


**项目地址:** [rahul0xkr/Hyper-V-CVE-2025-21333-Analysis](https://github.com/rahul0xkr/Hyper-V-CVE-2025-21333-Analysis)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #9

**来源**: [CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md](../2025/CVE-2025-21333-rahul0xkr_Reproducing-CVE-2025-21333-.md)

# CVE-2025-21333

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21333-160102_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-160102_CVE-2025-21333-POC.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致权限提升

**影响版本:** 受影响的Windows版本包括Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等。

**利用条件:** 需要本地访问，在Hyper-V环境中。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP（Virtual Service Provider）权限提升漏洞。根据漏洞信息和搜索结果，该漏洞存在于Hyper-V的NT内核集成组件中，允许攻击者提升权限。漏洞利用代码显示这是一个C++项目，利用了WNF（Windows Notification Facility）状态数据和I/O ring IOP_MC_BUFFER_ENTRY来触发堆缓冲区溢出。该POC的Visual Studio解决方案文件表明它是一个可编译的项目，但存在投毒风险，因为从github下载zip存在未知风险。从代码来看，大量使用了Windows API，直接与内核交互，存在恶意修改内核的可能性，投毒风险评估为20%。利用方式通常包括：

1.  **触发漏洞：** 通过精心构造的WNF状态数据和I/O ring操作，触发NT内核集成组件中的堆缓冲区溢出。
2.  **控制执行流：** 覆盖堆上的关键数据结构，以控制内核的执行流程。
3.  **权限提升：** 通过修改当前进程的Token，将其权限提升到SYSTEM级别。

从搜索结果来看，该漏洞已经被CISA列入已知被利用漏洞目录，表明该漏洞具有较高的实际威胁。

**有效性评估：** 根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的，因为存在可编译的POC，并且CISA已经确认该漏洞被利用。

**投毒风险评估：** 该POC代码存在一定的投毒风险。因为需要下载压缩包，压缩包内部可能包含恶意代码，但主要代码是利用windows api进行操作，函数功能明确，没有发现明显的恶意行为，风险较低。


**项目地址:** [160102/CVE-2025-21333-POC](https://github.com/160102/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #2

**来源**: [CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md](../2025/CVE-2025-21333-B1ack4sh_Blackash-CVE-2025-21333.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 提权漏洞/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机逃逸，主机权限获取

**影响版本:** 受影响的Windows版本 (见漏洞库信息)

**利用条件:** 需要Guest虚拟机权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (虚拟机服务提供者) 中的提权漏洞，本质是堆溢出。攻击者（虚拟机内的用户）可以利用此漏洞，通过特制的请求导致在主机操作系统内核中发生堆缓冲区溢出，从而获得主机操作系统的管理员权限。

**有效性：**

根据搜索引擎结果，此漏洞已经被公开披露，并且存在公开可用的PoC（例如 GitHub上的`MrAle98/CVE-2025-21333-POC`仓库），表明该漏洞的利用已经得到验证。 漏洞库信息也表明CISA ADP已经将此漏洞添加到已知被利用漏洞列表中，进一步证明了其有效性。

提供的漏洞利用代码`/tmp/32315364bfebb19c9bcece1aca1942c9/README.md` 仅包含CVE编号的信息，本身并没有可执行的利用代码。但是，结合搜索引擎结果，可以找到其他存储库中提供的PoC 代码。

**投毒风险：**

由于提供的代码只是一个包含CVE编号的`README.md`文件，因此直接分析该文件进行投毒判断没有意义。真正的PoC代码位于其他存储库。但是，在实际利用PoC的过程中，需要仔细审查代码，因为PoC代码可能包含恶意修改。 

假设用户下载并执行了某个声称是CVE-2025-21333的PoC代码。 评估投毒风险。鉴于漏洞利用开发和安全研究的复杂性，有以下可能性：

*   **有意后门：** 某些代码作者可能会故意在PoC中添加后门，以便进一步攻击或控制目标系统。风险较高，因为内核漏洞利用通常需要精心的内存操作，很容易隐藏恶意代码。
*   **代码质量问题：** PoC代码可能未经充分测试或包含错误，导致系统崩溃或不稳定。这虽然不是直接的投毒，但也可能对系统造成损害。
*   **依赖项风险：** PoC可能依赖于外部库或组件，这些库或组件本身可能存在漏洞或恶意代码。

考虑到这些因素，初步估计投毒风险为10%。更详细的代码审计可以提供更准确的风险评估。

**利用方式：**

1.  **触发漏洞：** 虚拟机内的攻击者，通过构造恶意的请求发送给Hyper-V主机。
2.  **堆溢出：** 恶意的请求会触发 Hyper-V NT Kernel Integration VSP 组件中的堆缓冲区溢出。
3.  **控制流劫持：** 利用堆溢出覆盖关键内核数据结构，例如函数指针，从而控制内核执行流。
4.  **权限提升：** 执行恶意代码，例如调用`PsLookupProcessByProcessId`和`SeAssignPrivileges`等函数，以提升虚拟机内的进程权限到 SYSTEM。
5.  **虚拟机逃逸：** 利用获得的 SYSTEM 权限，攻击者可以执行虚拟机逃逸操作，例如访问Hyper-V主机的文件系统，甚至控制整个主机。


**项目地址:** [B1ack4sh/Blackash-CVE-2025-21333](https://github.com/B1ack4sh/Blackash-CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #3

**来源**: [CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-MrAle98_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致系统权限提升

**影响版本:** Windows 10 21H2 (<= 10.0.19044.5371), Windows 11 22H2 (<= 10.0.22621.4751), Windows 10 22H2 (<= 10.0.19045.5371), Windows Server 2025 (<= 10.0.26100.2894), Windows 11 23H2 (<= 10.0.22631.4751), Windows 11 24H2 (<= 10.0.26100.2894), Windows Server 23H2 (<= 10.0.25398.1369)

**利用条件:** 需要Guest OS环境, 并需要利用I/O Ring机制进行攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 的特权提升漏洞。该漏洞是由于内核驱动`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。 

**漏洞利用方式：**

1.  **I/O Ring机制：** PoC利用了Windows I/O Ring机制，通过伪造IOP_MC_BUFFER_ENTRY结构体，从而实现内核任意地址读写。
2.  **堆溢出：** 通过在分页池中分配大量内存，然后触发堆溢出，覆盖IOP_MC_BUFFER_ENTRY结构体指针。
3.  **任意读写：** 覆盖后的`Address`可以指向任意内核地址，从而实现任意地址读写。
4. **提权：** 通过任意读写能力，可以修改当前进程的Token，从而提升权限。

**有效性：**

根据提供的PoC代码和搜索结果，该漏洞PoC的存在，并且已经被CISA列入已知被利用漏洞目录。PoC代码的README描述了如何在Windows 11 23h2上利用此漏洞进行提权，同时也说明了该PoC的可靠性可能不高。

**投毒风险：**

PoC代码本身是一个Visual Studio解决方案，包含C++源代码。 代码主要功能是利用堆溢出和I/O Ring机制实现内核任意地址读写，从而提升权限。审查代码后，发现潜在的投毒风险较低，例如：

*   **复杂性：** 代码相对复杂，阅读和理解需要一定的内核安全知识，增加了隐藏恶意代码的难度。
*   **公开性：** PoC本身是为了演示漏洞利用，作者倾向于公开透明，减少隐藏恶意代码的动机。
    但是，仍然存在一些微小的风险：
*   **细微修改：** 攻击者可能会在PoC代码中添加一些细微的修改，例如修改内存地址或增加延时，从而绕过安全检测。
*   **依赖项：** PoC可能依赖一些外部库或驱动，这些依赖项可能存在安全风险。

综上所述，该PoC代码存在10%的投毒风险，主要是考虑到细微修改和依赖项的潜在风险。


**项目地址:** [MrAle98/CVE-2025-21333-POC](https://github.com/MrAle98/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #4

**来源**: [CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-Mukesh-blend_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致SYSTEM权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2 等受影响版本

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (Virtual Service Provider) 中的权限提升漏洞。该漏洞是由于 NT 内核集成 VSP 中存在堆缓冲区溢出造成的，攻击者可以利用此漏洞获得 SYSTEM 权限。

**有效性评估：**

根据漏洞描述和搜索结果，该漏洞是一个已知的、存在被利用的漏洞，CISA 已将其添加到已知被利用的漏洞目录中。 Reddit的帖子也表明有人发布了POC。提供的POC代码是一个Visual Studio解决方案，包含C++源代码，这进一步表明该漏洞是可以被利用的。readme描述利用了WNF state data 和 I/O ring IOP_MC_BUFFER_ENTRY，指向了具体利用的技术细节。

**投毒风险评估：**

评估POC代码的投毒风险需要仔细分析代码。从提供的代码片段来看，代码主要涉及Windows API调用，包括内存操作、对象操作、线程管理和进程管理等。初步分析没有发现明显的恶意代码或后门。但是考虑到漏洞利用代码本身的复杂性以及缺乏完整代码，存在一定的投毒风险，例如：

*   **隐蔽的权限提升：** 代码可能包含不易察觉的后门，在提权后执行恶意操作，例如安装恶意软件或收集敏感信息。
*   **代码注入：** 恶意代码可能会注入到其他进程中，从而绕过安全检测。
* **依赖风险:** readme中的链接可能指向恶意网站或包含恶意软件的下载链接。

虽然不能完全排除投毒的可能性，考虑到漏洞利用的复杂性，作者隐藏恶意代码的概率较低，因此暂定投毒风险为10%。

**利用方式分析：**

1.  **漏洞触发：** 攻击者利用Hyper-V NT Kernel Integration VSP中的漏洞，该漏洞位于内核态驱动中，允许从虚拟机内部触发。
2.  **堆溢出：** 利用特定的输入或操作，触发堆缓冲区溢出，覆盖相邻的内存区域。搜索结果表明是Paged Pool中的heap-based buffer overflow
3.  **权限提升：** 通过控制溢出的内容，例如覆盖内核对象或函数指针，攻击者可以将自己的权限提升到SYSTEM。
4.  **执行恶意代码：** 获得SYSTEM权限后，攻击者可以执行任意代码，例如安装恶意软件、窃取数据或控制系统。

**项目地址:** [Mukesh-blend/CVE-2025-21333-POC](https://github.com/Mukesh-blend/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #5

**来源**: [CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-SerabiLem_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机数据泄露、完整性破坏和拒绝服务

**影响版本:** Windows 10 21H2 (版本 10.0.19043.0 到 10.0.19044.5371), Windows 11 22H2 (版本 10.0.22621.0 到 10.0.22621.4751), Windows 10 22H2 (版本 10.0.19045.0 到 10.0.19045.5371), Windows Server 2025 (版本 10.0.26100.0 到 10.0.26100.2894), Windows 11 23H2 (版本 10.0.22631.0 到 10.0.22631.4751), Windows Server 23H2 (版本 10.0.25398.0 到 10.0.25398.1369), Windows 11 24H2 (版本 10.0.26100.0 到 10.0.26100.2894)

**利用条件:** 本地用户权限，需要启用并运行Hyper-V。

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞。根据漏洞描述和搜索结果，攻击者可以利用恶意构造的 Virtual Service Provider (VSP) 来提升权限，最终控制 Hyper-V 主机。这是一个堆溢出漏洞（CWE-122）。

**有效性：**
提供的 POC 代码是一个 Visual Studio 解决方案，包含 C++ 代码。代码中包含Windows头文件，如 `<Windows.h>`, `<ioringapi.h>`和自定义头文件`wnf.h`。通过检查代码，可以发现其中利用了Windows Notification Facility（WNF）状态数据和I/O ring IOP_MC_BUFFER_ENTRY。搜索结果中reddit论坛的帖子也说明这是一个windows内核堆溢出漏洞，并提供了github链接。

**投毒风险：**
提供的代码片段中，最可疑的部分是 `README.md` 文件中提供的下载链接：`[Download Exploit](https://github.com/file/Soft.zip)`。该链接指向一个名为 `Soft.zip` 的 ZIP 文件，从不可信来源下载未经验证的可执行文件具有极高的风险。虽然直接提供的C++代码本身看起来是标准漏洞利用代码，但`README.md`文件中的下载链接是潜在的恶意软件投放点。用户可能被诱导下载包含恶意payload的zip文件，而非真正的漏洞利用程序。因此，存在较高的投毒风险。
另外，`wnf.h`等自定义头文件没有提供，意味着使用者必须自己查找或编写相关代码，这增加了利用难度，也为潜在的投毒留下了空间。攻击者可以提供带有恶意代码的`wnf.h`文件，诱导用户使用。
总体来说，投毒风险较高，估计为80%。

**利用方式：**
1.  **触发漏洞:** 利用特制的 VSP 触发 Hyper-V NT Kernel Integration 中的堆溢出。
2.  **WNF状态数据操控:** 通过操纵WNF状态数据，控制内核内存的布局。
3. **I/O ring IOP_MC_BUFFER_ENTRY：** 通过操控I/O环，控制内核内存的读写。
4.  **权限提升:** 覆盖关键内核数据结构，例如当前进程的 Token，将其替换为 SYSTEM 用户的 Token，从而提升权限。

**项目地址:** [SerabiLem/CVE-2025-21333-POC](https://github.com/SerabiLem/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #6

**来源**: [CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md](../2025/CVE-2025-21333-aleongx_KQL_sentinel_CVE-2025-21333.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，本地攻击者可利用该漏洞获得SYSTEM权限

**影响版本:** Windows 10 21H2 (versionStartIncluding: 10.0.19043.0, versionEndExcluding: 10.0.19044.5371), Windows 11 22H2 (versionStartIncluding: 10.0.22621.0, versionEndExcluding: 10.0.22621.4751), Windows 10 22H2 (versionStartIncluding: 10.0.19045.0, versionEndExcluding: 10.0.19045.5371), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows Server 23H2 (versionStartIncluding: 10.0.25398.0, versionEndExcluding: 10.0.25398.1369), Windows 11 24H2 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894)

**利用条件:** 本地访问，需要运行受影响的Windows Hyper-V。

**POC 可用性:** 是，根据搜索结果，存在可用的POC代码

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 特权提升漏洞。该漏洞是由于`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。攻击者可以利用此漏洞在本地获得 SYSTEM 权限。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞影响多个Windows版本，并且CISA已将其列入已知被利用的漏洞目录，表明该漏洞具有实际的利用价值。搜索引擎结果显示存在公开的POC代码，进一步佐证了漏洞的可利用性。

**投毒风险：** 提供的漏洞利用代码是 KQL 查询语句，用于检测与 CVE-2025-21333 相关的可疑活动。代码本身用于安全事件的监控和分析，而非直接的漏洞利用。因此，可以认为该代码的投毒风险较低，但也需要人工审查代码的逻辑，判断是否存在恶意隐藏。例如，代码中可能会被利用来误报，影响正常的安全事件分析，所以投毒风险为 10%。

**利用方式：**  攻击者可以利用该漏洞通过与Hyper-V的NT内核集成VSP相关的组件，触发堆缓冲区溢出，最终获得SYSTEM权限。具体来说，`vkrnlintvsp.sys` 组件在处理来自虚拟机的数据时，如果没有进行充分的边界检查，可能导致缓冲区溢出。根据搜索结果，漏洞存在于主机操作系统和容器类型虚拟机之间的通信组件中。攻击者需要在受影响的系统上执行恶意代码，触发溢出，从而提升权限。实际的利用可能涉及到内存地址的计算、shellcode的注入等技术。

 简而言之，这是一个本地提权漏洞，攻击者通过精心构造的数据包与Hyper-V的内核集成服务进行交互，导致内核堆缓冲区溢出，从而覆盖关键数据并获得SYSTEM权限。

**项目地址:** [aleongx/KQL_sentinel_CVE-2025-21333](https://github.com/aleongx/KQL_sentinel_CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #7

**来源**: [CVE-2025-21333-pradip022_CVE-2025-21333-POC.md](../2025/CVE-2025-21333-pradip022_CVE-2025-21333-POC.md)

## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V NT Kernel Integration VSP

**危害等级:** 高危，可提升权限

**影响版本:** 受影响的版本包括Windows 10 21H2，Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等，具体版本范围见CVE描述。

**利用条件:** 需要目标系统运行Hyper-V，且虚拟机集成服务（VSP）存在漏洞。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP的权限提升漏洞，这是一个堆溢出漏洞(CWE-122)。根据搜索结果，存在公开的POC代码，并且该漏洞已被积极利用。漏洞利用代码的README.md文件描述了如何下载和运行该POC，指出利用涉及WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY。代码库中提供的Visual Studio解决方案文件，进一步证实了漏洞利用的存在。虽然github仓库描述了POC的简单用法,但是下载地址却指向了另一个github地址,存在诱导下载其他恶意文件的可能性. 同时考虑到windows内核漏洞利用通常需要较高的技术水平，且可能涉及复杂的内存操作, 因此存在投毒风险，风险概率评估为30%。

利用方式：攻击者可以利用此漏洞在Hyper-V环境中提升权限。具体利用方式涉及构造特定的WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY，触发堆溢出，从而执行恶意代码。

**项目地址:** [pradip022/CVE-2025-21333-POC](https://github.com/pradip022/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---

## POC #8

**来源**: [CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md](../2025/CVE-2025-21333-rahul0xkr_Hyper-V-CVE-2025-21333-Analysis.md)

## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2。具体版本范围参考CVE详情。

**利用条件:** 需要Hyper-V环境，guest操作系统执行漏洞利用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP权限提升漏洞，是一个基于堆的缓冲区溢出(CWE-122)。

**有效性评估：**
根据搜索结果和提供的PoC代码，该漏洞的PoC是有效的。搜索引擎结果中提到有writeup，POC代码可用，并且该漏洞已被积极利用。漏洞库信息也表明该漏洞已被CISA加入已知被利用漏洞列表(KEV)。 提供的PoC代码是一个用于演示缓冲区溢出漏洞的demo，虽然它不是直接可用的exp，但是它再现了崩溃行为，并且提供测试环境的搭建方法，以及调试的思路，对于理解漏洞原理非常有帮助。 

**投毒风险分析：**
提供的PoC代码主要由以下部分组成：
*   `LAB_SETUP.md`: 提供实验环境搭建的说明，强调安全措施。
*   `README.md`: 描述项目目标是用于教育和防御研究，不包含exploit代码。
*   `windbg_notes.md`: 提供WinDbg的使用提示。
*   `build.sh`: 用于编译`vuln_demo.c`的脚本。
*   `run_and_crash.md`:  提供运行demo并产生崩溃的指导。
*   `vuln_demo.c`: 包含一个故意存在漏洞的程序，用于演示缓冲区溢出。
*   `reports/analysis.md`: 分析报告模板

综合来看，代码库明确声明了其教育目的，并提供了安全建议以防止滥用。`vuln_demo.c`中的`strcpy`函数存在明显的缓冲区溢出漏洞，这与CVE描述相符。代码库没有发现任何恶意代码或隐藏功能。 投毒的可能来自于作者可能故意留下一些隐蔽的后门代码，例如在`vuln_demo.c`中添加一些不明显的恶意操作，或者在`build.sh`脚本中添加一些下载和执行恶意代码的命令。但考虑到代码的简单性和开源性质，以及作者声明的教育目的，这种可能性较低， 估计投毒风险在5%左右。

**利用方式分析：**
1.  **漏洞原理：** 该漏洞是由于Windows Hyper-V NT Kernel Integration VSP组件中存在堆缓冲区溢出漏洞(CWE-122)。 
2.  **利用步骤：**
    *   攻击者首先需要访问运行Hyper-V的系统，并且最好在Guest操作系统内。
    *   然后，攻击者可以通过向易受攻击的VSP组件发送特制的输入，触发堆缓冲区溢出。
    *   通过精巧的构造输入数据，攻击者可以覆盖相邻的内存区域，从而控制程序的执行流程。
    *   最终，攻击者可以利用此漏洞提升权限，例如从普通用户权限提升到系统管理员权限。
3.  **利用限制：** 漏洞利用需要在启用了Hyper-V的系统上进行，并且可能需要特定的系统配置和权限。


**项目地址:** [rahul0xkr/Hyper-V-CVE-2025-21333-Analysis](https://github.com/rahul0xkr/Hyper-V-CVE-2025-21333-Analysis)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)

---



---



---



---



---



---



---



---



---



---



---



---



---



---



---



---



---

