## CVE-2025-32463 - Sudo 本地权限提升 (Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (Privilege Escalation)

**影响应用:** Sudo

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 1.9.14 <= Sudo < 1.9.17p1

**利用条件:** 攻击者需拥有本地低权限 shell 访问权限，且系统安装有受影响版本的 Sudo

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

【POC有效性分析】该漏洞（CVE-2025-32463）存在于 Sudo 的 --chroot (-R) 参数处理逻辑中。在受影响的版本（1.9.14 至 1.9.17）里，Sudo 会在执行完整的权限检查和安全验证之前，过早地对用户提供的 chroot 路径进行处理，并尝试读取该路径下的配置文件（如 /etc/nsswitch.conf）。POC 代码展示了极高的有效性：首先，它创建了一个伪造的 chroot 环境目录结构，包含恶意的 nsswitch.conf 文件。该文件通过配置指向一个自定义的动态链接库（.so）。随后，攻击者编译一个包含 __attribute__((constructor)) 属性的 C 语言共享库。当 Sudo 以 root 身份启动并尝试解析 chroot 环境中的名称服务（NSS）时，它会加载这个恶意库。由于 constructor 属性，恶意代码会在库加载瞬间执行。POC 中的代码通过 setreuid(0, 0) 将进程的实际和有效用户 ID 设置为 root，随后调用 /bin/bash，从而直接绕过 Sudo 的常规策略限制获取 root Shell。该利用链逻辑严密，不依赖复杂的内存破坏，仅利用程序逻辑缺陷，成功率极高且稳定。

【利用步骤】1. 创建临时工作目录；2. 编写恶意 C 源码，利用构造函数执行 setreuid(0,0) 并启动 /bin/bash；3. 在受控目录下构建伪造的根文件系统结构，重点是创建 etc 目录并写入恶意 nsswitch.conf，配置其加载自定义模块；4. 使用 gcc 将 C 源码编译为共享库，并放置在 Sudo 预期的加载路径下（如 libnss_ 目录）；5. 执行命令 `sudo -R [受控目录] /bin/true`。Sudo 在处理 -R 参数时会进入该目录并加载恶意库，从而触发提权。

【投毒风险分析】该 POC 的投毒风险被评估为低（10%）。代码逻辑透明，使用了标准的 Bash 脚本、C 语言和系统工具（gcc, mktemp, sudo）。脚本中定义的 woot1337 函数明确执行的是提权至 root 并开启交互式 shell 的操作，这符合安全研究中对提权漏洞 POC 的定义。虽然脚本中包含了从远程仓库下载（git clone）和开启 Python 简易服务器的指令，但这些是作为分发指引存在，而非隐藏的恶意行为。代码本身不包含混淆、加密或非必要的外部网络连接（除了 wget 获取脚本本身的逻辑）。对于防御性安全研究员而言，只需检查 woot1337.c 的内容即可确认其安全性。唯一的潜在风险点在于用户在使用 git clone 下载不明来源的完整项目时可能引入其他脚本，但 cwoot.sh 脚本本身是清洁且具有教育价值的。建议在隔离的沙箱环境或虚拟机中进行复现，以防止意外的系统配置更改。

**项目地址:** [https://github.com/justjoeyking/CVE-2025-32463.git](https://github.com/justjoeyking/CVE-2025-32463.git)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
