## CVE-2025-32463 - Sudo 本地权限提升 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** Sudo

**危害等级:** 高危 (Critical)

**CVSS评分:** 9.3 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** 1.9.14 至 1.9.17

**利用条件:** 本地用户访问权限，系统安装有 GCC 或具备预编译库上传条件，Sudo 支持 -R (--chroot) 选项

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞（CVE-2025-32463）存在于 Sudo 的 -R（或 --chroot）参数处理逻辑中。在受影响的版本（1.9.14 - 1.9.17）里，Sudo 会在执行完整的权限检查和安全约束之前，先行处理 chroot 环境的切换。分析提供的 POC 代码（cwoot.sh）可知，其利用逻辑非常精准：首先通过 mktemp 创建工作空间，随后构造一个虚假的 chroot 根目录。关键点在于利用了 glibc 的 Name Service Switch (NSS) 机制。攻击者在受控目录中伪造了 etc/nsswitch.conf 文件，并将 passwd 查询重定向到名为 woot1337 的恶意动态库。POC 使用 gcc 编译了一个 C 语言构造函数，该函数调用 setreuid(0, 0) 将进程有效用户 ID 设置为 root，随后启动 /bin/bash。当执行 sudo -R woot /bin/true 时，由于 Sudo 尚未放弃 root 权限便已进入了攻击者控制的 chroot 环境，系统加载动态库时会优先从攻击者指定的路径加载，从而触发恶意代码执行并返回 root shell。经评估，该 POC 逻辑闭环，直接利用了 Sudo 在环境切换与权限校验之间的顺序缺陷，其有效性极高，属于典型的 NSS 劫持结合 chroot 越狱攻击。利用步骤如下：1. 创建临时目录并编写包含提升权限代码的 C 语言源文件；2. 在该目录下构建符合 Linux 系统规范的 /etc 目录结构并放置伪造的 nsswitch.conf；3. 编译 C 代码为共享库，并确保路径与配置文件对应；4. 调用 sudo -R 参数指向当前伪造目录执行任意命令，触发加载即获得 root。 【投毒风险分析】针对该 POC 及相关开源库的投毒风险评估为低（约15%）。目前披露的 cwoot.sh 脚本代码透明，功能纯粹，仅包含标准的 C 编译命令和文件系统操作。核心 payload 使用了标准的 **attribute**((constructor)) 属性，这是安全研究中常用的劫持技术，不包含模糊处理或隐藏的远程连接代码。然而，在威胁情报视角下，此类高价值 LPE（本地提权）漏洞极易被恶意攻击者利用进行二次包装。风险点主要在于：1. 脚本通过 wget 从外部获取，如果分发服务器（如示例中的 Python 简易服务器）被劫持，脚本内容可能被篡改；2. 攻击者可能在 C 代码中添加隐蔽的持久化逻辑（如在 /etc/shadow 中添加后门账户或植入 SSH 公钥），而用户可能仅关注是否获得了 root 权限；3. 提供的 GitHub 地址需警惕，某些仿冒项目可能会在 cwoot.sh 中混入反弹 Shell。当前 POC 虽无恶意行为，但防御者在下载利用工具时必须审阅其 C 代码部分和 shell 环境设置，防止在测试过程中遭受二次伤害。该漏洞的严重性在于其 CVSS 评分高达 9.3，意味着一旦内网中存在低权限账号失陷，攻击者可以极低成本瞬间接管整台主机，建议所有 Linux 运维人员立即升级 Sudo 至 1.9.17p1 或更高版本。

**项目地址:** [https://github.com/justjoeyking/CVE-2025-32463](https://www.google.com/search?q=https://github.com/justjoeyking/CVE-2025-32463)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
