## CVE-2025-59287 - Microsoft Windows Server Update Services (WSUS) 远程代码执行 (RCE), 不安全的反序列化

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 远程代码执行 (RCE), 不安全的反序列化

**影响应用:** Microsoft Windows Server Update Services (WSUS)

**危害等级:** 高危/严重 (Critical)

**CVSS评分:** 9.8

**影响版本:** Windows Server 2012 (6.2.9200.0 – < 6.2.9200.25728), Windows Server 2012 R2 (6.3.9600.0 – < 6.3.9600.22826), Windows Server 2016 (10.0.14393.0 – < 10.0.14393.8524), Windows Server 2019 (10.0.17763.0 – < 10.0.17763.7922), Windows Server 2022 (10.0.20348.0 – < 10.0.20348.4297), Windows Server 2025 (10.0.26100.0 – < 10.0.26100.6905), Windows Server 23H2 (10.0.25398.0 – < 10.0.25398.1916)

**利用条件:** 未经身份验证的远程攻击者，需要网络连接

**POC 可用性:** 7

**POC 类型:** 概念验证 (PoC), 仅说明及部分代码

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

CVE-2025-59287是一个针对Microsoft Windows Server Update Services (WSUS) 组件的高危远程代码执行（RCE）漏洞，其CVSS评分为9.8。该漏洞的根本原因在于WSUS处理数据时存在不安全的反序列化缺陷。未经身份验证的远程攻击者可以利用此漏洞，通过发送特制事件触发传统序列化机制中不安全的对象反序列化，从而在目标服务器上执行任意代码，实现完全控制。

**POC有效性分析：**
提供的POC是一个`README.md`文件，详细描述了CVE-2025-59287漏洞的工作原理。它明确指出漏洞是由于对不受信任数据进行不安全的反序列化所致，这与搜索结果中提及的“不安全的反序列化”和“.NET的BinaryForma...”相吻合（尽管POC中提及`System.Xml.Linq.XElement`）。POC详细阐述了攻击者如何通过操纵`UpdateStream.xml`文件实现RCE：攻击者可以在XML文件的`<SourcePath>`元素中注入任意值，该值随后会被WSUS服务作为绝对路径写入磁盘；同时，在`<Command>`标签中嵌入的PowerShell命令也会被执行。这种XML反序列化、路径操纵和命令执行的组合构成了高效的RCE攻击链。POC中提供的XML payload示例直接展示了如何通过PowerShell执行`cmd.exe`，进一步验证了其概念的有效性。该漏洞已被赋予9.8的CVSS评分，证实了其严重性，且据称已在野外被观察到，这进一步强化了POC所描述的漏洞可利用性和潜在影响。POC还提供了受影响的详细版本列表，包括具体的构建号范围，这对于识别易受攻击的系统至关重要。虽然此POC并非一个完整的可执行脚本，但其对漏洞机制的详尽解释、清晰的XML payload示例以及与外部威胁情报的一致性，都强有力地表明了这种攻击向量的概念有效性和高度潜力。它为技术熟练的攻击者提供了足够的信息来构建功能性利用工具。此PoC的文档清晰易懂，是理解漏洞及其潜在利用的优秀资源。

**利用步骤：**
利用CVE-2025-59287漏洞通常涉及以下关键步骤：
1.  **目标识别**：攻击者首先需要识别网络环境中正在运行Microsoft Windows Server Update Services (WSUS) 的服务器。
2.  **构造恶意XML**：攻击者构造一个恶意的`UpdateStream.xml`文件。此文件包含一个`<SourcePath>`元素，其值将被WSUS服务以绝对路径的形式写入目标服务器的磁盘。同时，该文件还包含一个`<Command>`元素，其中嵌入了攻击者希望在目标服务器上执行的任意PowerShell命令。POC中提供的示例如下：
    ```xml
    <?xml version="1.0" encoding="utf-8"?>
    <UpdateStream>
      <Metadata>
        <Title>WSUS Exploit</Title>
        <Description>Injected by local attacker.</Description>
      </Metadata>
      <SourcePath>C:\Windows\System32\cmd.exe</SourcePath>
      <Command><![CDATA[
          powershell -NoProfile -ExecutionPolicy Bypass `
              -File C:\Windows\System32\cmd.exe
      ]]></Command>
    </UpdateStream>
    ```
    在实际攻击中，`cmd.exe`可以替换为任何恶意命令，例如下载并执行恶意payload，或建立反向shell连接。
3.  **发送特制请求**：攻击者通过网络向WSUS服务器发送特制的请求或事件。这些请求旨在触发WSUS服务在处理诸如`AuthorizationCookie`或其他特定输入时，存在的不安全对象反序列化过程。
4.  **服务处理与反序列化**：WSUS服务接收到恶意请求后，会尝试从被攻击者控制的远程源或通过其他方式获取并反序列化攻击者构造的`UpdateStream.xml`文件。在此过程中，`System.Xml.Linq.XElement`被用于处理XML数据。
5.  **代码执行**：由于WSUS对`<SourcePath>`和`<Command>`元素的内容缺乏充分的验证，在反序列化并处理XML数据时，它会将`<SourcePath>`中指定的内容写入磁盘，并随后执行`<Command>`标签内包含的PowerShell命令。这一过程最终导致未经身份验证的远程代码执行，攻击者从而获得对目标WSUS服务器的完全控制。

**投毒风险分析：**
提供的POC是一个`README.md`文件，其内容主要包括漏洞的详细描述、受影响的产品及版本列表、漏洞工作原理的解释，以及一个XML格式的payload示例。**此文件本身不包含任何可执行代码、外部脚本引用、混淆内容或可疑的网络请求。** 因此，直接分析或使用这个`README.md`文件，其**投毒风险评估为0%**。它是一个纯粹的信息性文档，旨在说明漏洞的机制，而非实际的利用工具。

然而，尽管该POC文件本身不构成直接的投毒风险，但组织在基于其内容自行开发或寻找完整的利用工具时，仍需保持高度警惕。原因如下：
1.  **衍生工具的潜在风险**：如果威胁行为者根据此公开信息开发了完整的利用工具，他们很有可能在其中嵌入恶意代码，例如后门、持久化机制、数据窃取功能或蠕虫特性，以在受害网络中进行横向移动。
2.  **不安全的第三方利用脚本**：互联网上可能出现的“一键利用”脚本，其来源和安全性难以保证。这些脚本可能不仅利用WSUS漏洞，还可能包含额外的恶意功能，如安装挖矿软件、勒索软件，甚至攻击使用者的系统本身。
3.  **概念验证到实际攻击的转化**：虽然此POC提供了关键的攻击思路和payload示例，但将其转化为一个稳定、隐蔽且高效的实际利用程序还需要进一步的开发工作。在任何开发过程中，都应严格遵循安全编码实践，并对所有外部引入的代码或依赖项进行彻底的安全审计，以防止引入新的漏洞或恶意功能。

综上所述，当前提供的POC不构成直接的投毒风险，但它作为重要的威胁情报，强调了该漏洞的严重性以及未来可能出现的恶意利用工具的潜在风险。组织在面对此类高危漏洞时，应将及时部署补丁作为首要任务，并持续加强网络监控和入侵检测能力，以有效防范基于此漏洞的真实世界攻击。

**项目地址:** Not available

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-59287
