## CVE-2025-27591 - Below (Facebook/Meta 开源的系统监控工具) 本地权限提升 (LPE) / 错误权限分配

**漏洞编号:** CVE-2025-27591

**漏洞类型:** 本地权限提升 (LPE) / 错误权限分配

**影响应用:** Below (Facebook/Meta 开源的系统监控工具)

**危害等级:** 高 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** < 0.9.0

**利用条件:** 本地普通用户权限，系统安装有受影响版本的 Below 服务

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：该漏洞源于 Below 服务在运行时以 root 权限创建了一个全局可写（world-writable）的目录 /var/log/below。由于普通用户对该目录具有写权限，攻击者可以利用符号链接（Symlink）攻击。POC 脚本（exploit.py）展示了完整的攻击链路：首先删除已有的 error_root.log，然后创建一个指向 /etc/passwd 的同名符号链接。当 Below 服务尝试检查或修改该日志文件的权限为 666 时，实际上是通过符号链接修改了 /etc/passwd 的权限。此 POC 在逻辑上高度可行，因为它直接针对 Linux 权限管理中的经典 Race Condition 和不当目录权限配置。代码通过循环监控 /etc/passwd 的权限状态，并在检测到权限变为可写后，立即通过追加 root 无密码条目的方式实现提权。该 POC 针对 Hack The Box (HTB) 的 'Outbound' 机器编写，实测证明其逻辑严密且能够自动化执行。利用步骤：1. 确认 /var/log/below 目录存在且权限为 777。2. 运行脚本，脚本会删除旧日志并建立指向敏感系统文件（如 /etc/passwd）的软连接。3. 触发 Below 服务运行（如调用 sudo below record），使服务以 root 身份误操作软连接。4. 脚本检测到 /etc/passwd 变为 666 权限后，向其中写入一个新的 UID 0 用户或清空 root 密码。5. 攻击者切换到 root 账户。投毒风险分析：该 POC 代码透明度高，主要使用了 Python 标准库如 os, sys, pathlib, subprocess 和 shutil，没有引入第三方混淆库或远程下载行为。代码逻辑清晰，其写入 /etc/passwd 的行为是漏洞利用的必要组成部分，而非恶意后门。虽然代码中包含删除 /var/log/below/error_root.log 的操作，但这是漏洞利用的前置步骤。由于该 POC 来源于 BridgerAlderson 的 GitHub 仓库，且明确标注用于 HTB 教育用途，其意图是为了展示漏洞原理而非恶意分发。经过静态分析，代码中不存在隐藏的反弹 shell、恶意二进制文件释放或敏感信息外传逻辑。风险主要集中在使用者可能在生产环境误运行导致系统文件损坏，但代码本身不具备恶意软件特征，投毒风险极低（5%）。建议安全研究人员在隔离的实验环境下运行此脚本。

**项目地址:** [https://github.com/BridgerAlderson/CVE-2025-27591-PoC](https://github.com/BridgerAlderson/CVE-2025-27591-PoC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-27591](https://nvd.nist.gov/vuln/detail/CVE-2025-27591)
