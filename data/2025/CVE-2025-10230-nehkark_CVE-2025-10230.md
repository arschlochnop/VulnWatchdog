# CVE-2025-10230

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-10230-B1ack4sh_Blackash-CVE-2025-10230.md](../2025/CVE-2025-10230-B1ack4sh_Blackash-CVE-2025-10230.md)

## CVE-2025-10230 - Samba WINS Hook Command Injection

**漏洞编号:** CVE-2025-10230

**漏洞类型:** 命令注入

**影响应用:** Samba

**危害等级:** 严重，可能导致远程代码执行

**影响版本:** < 4.21.9, 4.22.0 < 4.22.5, 4.23.0 < 4.23.2

**利用条件:** 需要目标系统运行受影响版本的Samba，并且启用了WINS服务器功能。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-10230是一个Samba的命令注入漏洞，位于WINS服务器的hook脚本处理中。漏洞原因是由于NetBIOS名称在传递给shell之前没有经过适当的验证或转义。攻击者可以通过发送特制的WINS注册数据包，将恶意命令注入到由Samba进程执行的shell命令中，从而实现远程代码执行。攻击者无需身份验证即可利用此漏洞。提供的POC代码`/tmp/3dfb58991396dc8e70e0e3ceeac7d5f0/README.md`本身只包含一个简单的README文件，说明存在可用的PoC，但PoC具体实现未提供。投毒风险较低，仅为5%，因为提供的代码仅仅是描述文件，不包含任何实际的利用代码。利用方式：

1.  攻击者构建一个包含恶意NetBIOS名称的WINS注册数据包。
2.  攻击者将此数据包发送到Samba服务器。
3.  Samba服务器的WINS hook脚本接收到数据包并提取NetBIOS名称。
4.  由于缺乏适当的验证或转义，恶意NetBIOS名称被直接插入到shell命令中。
5.  Samba服务器执行包含恶意命令的shell命令，导致远程代码执行。

由于PoC代码仅仅为README，并未提供具体的利用代码，所以实际的利用效果依赖于攻击者实现的具体PoC。


**项目地址:** [B1ack4sh/Blackash-CVE-2025-10230](https://github.com/B1ack4sh/Blackash-CVE-2025-10230)

**漏洞详情:** [CVE-2025-10230](https://nvd.nist.gov/vuln/detail/CVE-2025-10230)

---

## POC #2

**来源**: [CVE-2025-10230-dptsec_CVE-2025-10230.md](../2025/CVE-2025-10230-dptsec_CVE-2025-10230.md)

## CVE-2025-10230 - Samba WINS Hook Command Injection

**漏洞编号:** CVE-2025-10230

**漏洞类型:** 命令注入

**影响应用:** Samba

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 4.23.2, 4.22.5, and 4.21.9

**利用条件:** WINS 服务启用且配置了 wins hook

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-10230 漏洞是 Samba 4.x 中存在的一个 WINS hook 命令注入漏洞。当 Samba 服务器启用了 WINS 支持并配置了 'wins hook' 时，攻击者可以通过发送特制的 NetBIOS 名字注册请求，将恶意命令注入到 'wins hook' 中，从而实现远程代码执行。

**漏洞利用方式：**

1.  **构造恶意的 NetBIOS 名字：** 攻击者需要在 NetBIOS 名字中嵌入要执行的恶意命令。由于 NetBIOS 名字长度限制为15个字符，因此攻击者需要巧妙地构造命令，使其满足长度限制。需要注意的是，根据POC代码中的描述 `< > ;` 这些字符会被过滤
2.  **创建 WINS 注册数据包：** 攻击者使用 PoC 代码提供的 `create_wins_registration_packet` 函数创建包含恶意 NetBIOS 名字的 WINS 注册数据包。该数据包模拟一个 NetBIOS 名字注册请求。
3.  **发送 WINS 注册数据包：** 攻击者使用 PoC 代码提供的 `send_wins_registration` 函数将构造好的 WINS 注册数据包发送到目标 Samba 服务器的 WINS 端口（默认为 137）。
4.  **触发命令注入：** 当 Samba 服务器收到 WINS 注册请求后，会调用配置的 'wins hook'，并将包含恶意命令的 NetBIOS 名字传递给 'wins hook'。如果 'wins hook' 没有对输入进行充分的过滤，恶意命令就会被执行。

**有效性：**

根据提供的 PoC 代码，该漏洞利用的有效性较高。该 PoC 代码实现了 WINS 注册数据包的构造和发送，能够模拟攻击者利用该漏洞的过程。

**投毒风险：**

PoC 代码中存在一定程度的投毒风险。虽然该 PoC 代码本身实现了漏洞利用的功能，但作者可能在代码中隐藏了额外的恶意代码，例如：

*   **反弹 Shell：** 在成功利用漏洞后，PoC 代码可能会尝试连接到攻击者的服务器并反弹 Shell，从而使攻击者能够完全控制受害主机。
*   **安装后门：** PoC 代码可能会在受害主机上安装后门程序，以便攻击者能够长期访问受害主机。
*   **传播恶意软件：** PoC 代码可能会尝试在受害主机上下载并执行恶意软件，从而进一步扩大攻击范围。

由于无法直接运行该PoC进行分析，只能通过代码内容进行判断，所以投毒风险判断为10%。 主要依据是代码整体结构清晰，功能明确，但仍不能排除作者隐藏了不易察觉的恶意代码。

**项目地址:** [dptsec/CVE-2025-10230](https://github.com/dptsec/CVE-2025-10230)

**漏洞详情:** [CVE-2025-10230](https://nvd.nist.gov/vuln/detail/CVE-2025-10230)

---

## POC #3

**来源**: [CVE-2025-10230-nehkark_CVE-2025-10230.md](../2025/CVE-2025-10230-nehkark_CVE-2025-10230.md)

## CVE-2025-10230-Samba-WINS Hook命令注入

**漏洞编号:** CVE-2025-10230

**漏洞类型:** 命令注入

**影响应用:** Samba

**危害等级:** 高危，允许未经身份验证的远程攻击者以Samba进程权限执行任意命令

**影响版本:** Samba版本小于4.21.9，4.22.x版本小于4.22.5，4.23.x版本小于4.23.2且wins support = yes, 并且配置了wins hook

**利用条件:** Samba服务器启用WINS支持（wins support = yes）并且配置了WINS hook（wins hook = ...），服务器监听137/UDP端口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-10230是Samba WINS hook处理中的命令注入漏洞。当Samba作为Active Directory域控制器，并启用了`wins support = yes`和配置了`wins hook = ...`时，攻击者可以通过发送特制的NetBIOS注册数据包到UDP 137端口，在NetBIOS名称中包含恶意shell命令，由于Samba没有对NetBIOS名称进行充分的验证和转义，直接将其拼接进shell命令中执行，从而以Samba进程的权限（通常是root权限）执行任意命令。PoC代码通过构造包含恶意payload的NetBIOS数据包来利用此漏洞。由于代码量少, 且作者已经声明研究目的是教育和防御目的, 故投毒概率极低。

**漏洞利用方式：**

1.  **目标确定：**  确定运行存在漏洞Samba版本，且启用了WINS支持，并配置了WINS hook的服务器。
2.  **数据包构造：**  使用PoC脚本（`cve-2025-10230.py`）构造包含恶意payload的NetBIOS Name Service (NBNS) 注册数据包。Payload需要满足 ≤15 字符的限制，并且不能包含 `< > ;` 等字符。
3.  **发送数据包：**  将构造的数据包发送到目标Samba服务器的UDP 137端口。
4.  **命令执行：**  Samba服务器接收到数据包后，WINS hook处理程序会执行包含恶意payload的shell命令。
5.  **权限获取：**  恶意命令以Samba进程的权限执行，从而可能获取服务器的控制权。

**项目地址:** [nehkark/CVE-2025-10230](https://github.com/nehkark/CVE-2025-10230)

**漏洞详情:** [CVE-2025-10230](https://nvd.nist.gov/vuln/detail/CVE-2025-10230)

---

