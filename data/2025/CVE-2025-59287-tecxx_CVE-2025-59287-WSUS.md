## CVE-2025-59287 - Microsoft Windows Server Update Services (WSUS) 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Server Update Services (WSUS)

**危害等级:** 高危

**CVSS评分:** 9.8

**影响版本:** Windows Server 2025, Windows Server 2022, Windows Server 2019

**利用条件:** 未经身份验证的远程攻击者可利用，需要网络访问

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

所提供的POC包含一个PowerShell脚本`wsus-rce.ps1`和`README.md`，旨在利用CVE-2025-59287，即Microsoft Windows Server Update Services (WSUS) 中的高危远程代码执行漏洞。该漏洞源于WSUS服务在处理其`AuthorizationCookie`时存在的不安全反序列化缺陷。`README.md`中的说明及附带截图表明，此POC已在未打补丁的Windows Server 2022 (WSUS版本10.0.20348.1) 上成功验证。POC的利用流程自动化且高效：它首先通过合法的SOAP请求获取一个有效的`AuthorizationCookie`，随后自动下载并利用`ysoserial.net`这一业界标准工具生成恶意.NET反序列化payload。此payload被嵌入特制的SOAP请求中，并发送至目标WSUS服务器。当WSUS管理控制台被（重新）打开时，服务器会尝试反序列化包含恶意payload的`AuthorizationCookie`，从而触发远程代码执行。攻击成功后，尽管WSUS控制台会显示错误，但目标服务器会根据payload执行预设指令，本例中即建立一个指向攻击者监听机器的反向shell。`README.md`中的截图清晰地展示了从POC执行到反向shell建立的全过程，充分证明了该POC的实战有效性和可复现性。

**利用步骤:**
攻击者可按以下步骤利用此漏洞：
1.  **准备攻击环境**: 攻击者需要一台具备网络访问能力的主机（如Kali Linux），并配置Netcat监听器以接收来自受害服务器的反向shell连接。
2.  **配置POC脚本**: 编辑`wsus-rce.ps1`脚本中的相关变量，包括目标WSUS服务器的URL、端口，以及攻击者监听器的IP地址和端口。
3.  **执行POC**: 在攻击者机器上执行配置好的`wsus-rce.ps1` PowerShell脚本。脚本将自动处理`ysoserial.net`的下载与payload生成，随后通过SOAP请求将恶意反序列化payload发送到目标WSUS服务器。
4.  **触发漏洞**: 攻击者需要确保目标WSUS服务器上的管理员或自动化进程（重新）打开WSUS管理控制台。此操作将导致服务器处理此前发送的恶意`AuthorizationCookie`，触发不安全反序列化漏洞并执行注入的恶意代码。
5.  **建立反向Shell**: 一旦漏洞被成功触发，攻击者在Netcat上启动的监听器将接收到来自目标WSUS服务器的反向shell连接，从而获得对服务器的远程代码执行权限和控制。

**投毒风险分析:**
对所提供的POC代码（`wsus-rce.ps1`）及其相关文件进行分析后，评估其投毒风险为**低（15%）**。此评估基于以下几个关键考量：
1.  **代码透明度与可读性**: `wsus-rce.ps1`脚本采用PowerShell编写，代码逻辑清晰、未经过混淆，使得安全分析人员能够直接审查其功能。脚本的核心逻辑包括SOAP请求的构建、cookie的获取以及payload的发送，均清晰可见，没有发现隐藏的恶意模块或复杂加密。
2.  **外部依赖的安全性**: 脚本的核心外部依赖是`ysoserial.net`，这是一个在安全社区中被广泛认可和使用的开源工具，专门用于生成.NET反序列化payload。虽然脚本会自动化下载此工具，但`ysoserial.net`本身并非恶意软件，其代码和行为是公开透明且可信的。脚本中没有迹象表明它会从未知或可疑来源下载恶意二进制文件或脚本。
3.  **无额外恶意功能**: POC的唯一目的和功能是利用CVE-2025-59287漏洞以实现远程代码执行，并获取反向shell。获取反向shell是漏洞成功利用的直接结果，并非代码本身携带的额外投毒载荷。脚本中没有发现诸如持久化后门、数据窃取、僵尸网络C2通信或横向移动等超出漏洞利用范围的恶意功能。
4.  **标准化利用技术**: 反序列化漏洞的利用通常涉及生成特定的序列化数据（即payload），并诱导目标系统反序列化这些数据。该POC采用的技术是此领域的标准做法，并未引入任何异常或可疑的行为模式。
5.  **免责声明**: `README.md`中包含的“use at your own risk. no support, no guarantees.”等免责声明，是合法的安全研究和工具共享中常见的做法，进一步佐证了其作为研究性POC的性质，而非恶意软件。
综上，尽管此POC旨在获取目标系统的控制权，但其代码本身没有植入额外的恶意功能或通过不透明的方式进行“投毒”。它是一个专注于特定漏洞利用的透明且功能单一的安全工具。

**项目地址:** N/A - Not explicitly provided in input data

**漏洞详情:** https://hawktrace.com/blog/CVE-2025-59287-UNAUTH
