## CVE-2025-8088 - WinRAR 目录遍历/路径穿越

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 目录遍历/路径穿越

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** 8.4

**影响版本:** WinRAR 7.12及更早版本

**利用条件:** 需要用户交互（解压特制压缩包）并需要知晓目标Windows用户名

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

POC有效性分析: 该POC是一个针对CVE-2025-8088 WinRAR目录遍历漏洞的完整利用实现，被命名为“valentines”。根据`README.md`的详细描述，该利用工具旨在通过巧妙结合Windows NTFS备用数据流 (ADS) 特性和路径遍历（Path Traversal）技术，有效绕过WinRAR在解压过程中对文件路径的验证机制。当受害用户解压一个经过该工具特殊构造的RAR压缩包时，恶意负载（Payload），例如可执行文件、PowerShell脚本，甚至是伪装成图片文件的恶意载荷，会被成功重定向并提取到攻击者指定的目标路径。通常，这个目标路径是Windows系统的用户启动文件夹（Startup folder）。一旦系统在下次启动或用户下次登录时，位于启动文件夹的恶意负载将自动执行，从而在受害者机器上实现任意代码执行（Remote Code Execution, RCE），给予攻击者极高的控制权限。
`README.md`中详细列出了该POC的使用步骤和必要参数，包括需要攻击者输入目标受害者的Windows用户名、一个包含“真实”或诱饵文件的可见文件夹路径（用于混淆），以及恶意负载文件的实际路径。这些说明清晰地表明该工具能够生成一个功能完善、可立即用于攻击的恶意压缩包。
该POC也坦诚地指出了其已知的局限性：首先，为了将Payload准确放置到用户特定的启动文件夹，攻击者需要预先获取目标受害者的Windows用户名。尽管`README.md`指出这一点通常“容易获取”，但在某些特定场景下可能增加攻击的复杂度。其次，此漏洞仅对WinRAR 7.12及更早版本有效。WinRAR的最新版本已经修补了此漏洞。然而，鉴于WinRAR庞大的用户基础以及许多用户不及时更新软件的习惯，该漏洞在实际环境中仍可能具有广泛且深远的影响力，使其成为一个值得高度关注的威胁。
通过提供标准的Microsoft Visual Studio解决方案文件（`valentines.sln`）和项目文件（`valentines.vcxproj`），该POC明确指示这是一个可编译的C++项目，预期能够生成一个功能强大的利用工具。`README.md`中提及的“showcase”链接（尽管是GitHub assets链接）进一步暗示了其功能的有效性和可视化验证。
综合来看，该POC提供了一个高度有效的目录遍历漏洞利用方案，通过利用用户解压操作，能够成功将恶意文件植入系统关键位置（如启动项），最终实现持久化和高权限的远程代码执行。其利用原理清晰，实现方案完整，对受影响系统构成严重威胁。

利用步骤: 
1. 环境准备: 攻击者首先需要在一台装有Microsoft Visual Studio (支持C++ 20或更高版本) 的开发环境中进行操作。此外，系统需要配置`zlib`库，因为这是该项目的一个依赖项。
2. 获取与编译: 从POC的存储库中获取代码。然后，在Visual Studio中打开`valentines.sln`解决方案文件，并进行编译。这将生成一个名为`valentines.exe`或类似的可执行文件，即攻击工具。
3. 情报收集: 攻击者需要进行初步侦察，以获取目标受害者的Windows登录用户名。这是确保恶意负载能被精准投放到受害者个人启动文件夹的关键信息。
4. 运行利用工具: 攻击者执行编译好的`valentines.exe`程序。该程序会通过命令行界面或图形界面引导用户输入必要的参数。
5. 配置攻击参数:
    * 输入目标用户名: 根据程序提示，准确输入已获取的目标Windows用户名。这是构建针对性恶意路径的关键。
    * 指定诱饵文件目录: 输入一个本地文件夹的路径，该文件夹中包含攻击者希望在RAR压缩包中显示给受害者的“正常”文件。这些文件充当诱饵，使得压缩包看起来无害，降低受害者的警惕性。
    * 指定恶意Payload文件: 输入本地存储的恶意可执行文件（例如`.exe`、`.dll`）、脚本文件（例如`.ps1`、`.vbs`）或任何其他攻击者希望在目标系统上执行的文件路径。该文件将是利用成功后实际执行的恶意载荷。
6. 生成恶意压缩包: `valentines.exe`工具将利用上述参数，结合ADS和路径遍历技术，自动创建一个特制的WinRAR压缩包（例如`evil.rar`）。这个压缩包在表面上可能只显示诱饵文件，但内部已嵌入了指向启动文件夹的恶意路径。
7. 社会工程学投递: 攻击者需要通过社会工程学手段（如钓鱼邮件、恶意网站下载、即时通讯工具发送等）将这个特制的RAR压缩包发送给目标受害者。
8. 受害者解压与Payload执行:
    * 受害者接收并使用受影响版本的WinRAR（7.12或更早版本）解压该恶意压缩包。
    * 由于WinRAR的漏洞，恶意Payload文件将绕过正常的解压路径，被静默释放到受害者的Windows启动文件夹中（例如`C:\Users\<username>\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup`）。
    * 在受害者下次登录Windows系统或重启计算机时，位于启动文件夹的恶意Payload将自动被操作系统加载并执行，从而在受害者的机器上实现任意代码执行，攻击成功。

投毒风险分析: 对所提供的POC文件进行严格分析后，即`README.md`、`valentines.sln`和`valentines.vcxproj`，我们可以得出结论：**直接的投毒风险极低**。这些文件主要构成了该项目的文档说明和Visual Studio项目构建配置，而非实际的恶意代码或预编译的二进制文件。
具体来说：
* `README.md`文件是项目的说明文档，其中明确阐述了该POC的教育和研究目的，并无任何隐藏的恶意指令、远程调用或可疑行为。它详细解释了漏洞原理和利用方式，但其本身不具备执行能力。
* `valentines.sln`是Visual Studio解决方案文件，用于组织和管理项目。`valentines.vcxproj`是Visual C++项目文件，包含了编译器设置、源文件引用、依赖库（如zlib）等信息。这些文件是标准的开发配置，其内容不包含任何可执行的恶意负载、代码混淆、外部恶意脚本引用，或任何试图在用户系统上执行未经授权操作的指令。
此POC的核心功能是作为一个**工具**，用于生成一个恶意的WinRAR压缩包，而不是POC代码自身包含恶意负载并试图感染系统。换句话说，该POC为攻击者提供的是“制造武器”的能力，而非“武器本身”。攻击者在使用该POC生成恶意压缩包时，需要**主动提供**其希望注入的恶意Payload文件。
因此，从当前提供的文件内容来看，该POC存储库本身不具备代码混淆、可疑网络请求、自修改或调用`eval()`等高风险特征。
潜在风险来源（与POC本身无关）:
1. 预编译版本的分发: 如果用户从非官方、非GitHub存储库的渠道下载了该POC工具的预编译可执行文件（例如`valentines.exe`），那么这些文件可能已被恶意第三方篡改并植入真实的恶意代码。
2. 攻击者提供的Payload: 攻击者在利用此POC生成恶意压缩包时，可以选择嵌入真正的恶意软件（如勒索病毒、远控木马）作为Payload。这是该工具的预期用途，但这种风险来源于攻击者选择的Payload，而非POC工具本身的投毒。
3. 未提供源代码: 由于未提供实际的C++源代码文件，我们无法对构建工具的内部实现进行代码审计，以完全排除在源代码中存在隐蔽恶意逻辑的可能性。然而，根据`.sln`和`.vcxproj`文件，这似乎是一个标准项目，且`README`强调教育目的。
鉴于上述详细分析，对于仅分析这些提供的文件，该POC的投毒风险评定为**低风险（10%）**。尽管如此，防御性安全研究人员和普通用户在处理任何与漏洞利用相关的工具时，仍应保持高度警惕，务必从可信来源获取代码，并在隔离且受控的环境中进行测试和分析，以避免不必要的风险。

**项目地址:** Not directly provided in input

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8088
