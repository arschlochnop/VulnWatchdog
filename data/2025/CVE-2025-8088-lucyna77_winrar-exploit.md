## CVE-2025-8088 - WinRAR 路径遍历/目录遍历 (Path Traversal/Directory Traversal)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历/目录遍历 (Path Traversal/Directory Traversal)

**影响应用:** WinRAR

**危害等级:** Critical

**CVSS评分:** Not explicitly provided in source, but described as Critical

**影响版本:** 7.12及以下版本 (建议更新至7.13或更高版本)

**利用条件:** 需要用户交互（受害者解压恶意RAR压缩包），攻击者需知晓目标Windows用户名

**POC 可用性:** 9/10

**POC 类型:** 完整利用 (Full exploitation)

**攻击复杂度:** 中 (Medium)

**投毒风险:** 10%

## 详情

CVE-2025-8088是WinRAR压缩软件中发现的一个关键路径遍历漏洞。该零日漏洞影响WinRAR的7.12及更早版本，并已被发现活跃于野外，尤其被与俄罗斯相关的威胁组织利用来传播RomCom恶意软件。攻击者可以精心制作一个恶意的RAR压缩包。当不知情的用户使用受影响版本的WinRAR解压此档案时，路径遍历漏洞允许攻击者绕过正常的安全检查和目录限制，将任意文件写入到受害者系统上的非预期位置。这种能力极其危险，因为它可被用于将恶意可执行文件或脚本放置到关键系统目录，例如Windows的“启动”文件夹，从而在系统重启时实现持久的代码执行。鉴于WinRAR的广泛使用，大量系统可能因此面临风险。强烈建议用户更新到WinRAR 7.13或更高版本以缓解此漏洞。

**POC有效性分析**
所提供的POC展现了CVE-2025-8088漏洞的有效且实用的利用方法。`README.md`文件清晰地概述了利用技术，即结合使用NTFS数据流（Alternate Data Streams, ADS）和在RAR压缩包内进行路径修补。其核心思想是将恶意载荷嵌入到ADS中，然后通过路径遍历漏洞将其重定向到目标目录，通常是受害者的Windows“启动”文件夹。该POC工具使用C++编写（需要C++20和zlib库），它生成一个看似正常的`.rar`文件，但其中包含隐藏的恶意组件。当受害者使用易受攻击的WinRAR版本（7.12或更早版本）解压此压缩包时，经过修补的ADS载荷（可以是任何文件类型，例如可执行文件、PowerShell脚本，甚至是配置为自动执行的看似无害的图像文件）将被投放到“启动”文件夹中。这确保了载荷在系统下次启动时自动执行，从而实现持久性。此POC的有效性很高，因为它针对常见的用户行为（解压压缩包）并利用了关键漏洞。然而，它确实有一个前提条件：攻击者需要知道受害者的确切Windows用户名，以便正确地指向“启动”文件夹路径。虽然这看似一个限制，但用户名通常可以通过各种侦察方法轻松获取，因此这只是一个次要障碍。此外，`README`指出该漏洞对不经常更新软件的用户使用的旧版本WinRAR有效。

**利用步骤**
要使用此POC演示CVE-2025-8088漏洞的利用，攻击者需要遵循以下步骤：
1.  **环境准备**：确保安装了兼容C++20的编译器和`zlib`库。POC是一个Visual Studio项目（包含`.sln`和`.vcxproj`文件），表明它旨在Windows开发环境中编译。
2.  **编译**：编译提供的C++项目（例如`valentines.sln`）以生成漏洞利用的可执行文件。
3.  **执行**：从命令行运行编译后的可执行文件。该工具将提示输入必要的信息。
4.  **目标用户名输入**：攻击者必须输入目标受害者的确切Windows用户名。此信息对于POC正确构建受害者“启动”文件夹的路径至关重要（例如，`C:\Users\<username>\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup`）。
5.  **可见文件文件夹输入**：提供包含“真实”或诱饵文件的本地文件夹路径。这些文件将可见地包含在制作的`.rar`压缩包中，使其对受害者来说显得合法，并可能诱使他们解压。
6.  **载荷文件路径输入**：指定恶意载荷文件的完整路径。此文件可以是任何可执行文件（`.exe`）、脚本（`.ps1`、`.vbs`），甚至是看似无害的文件类型（如PNG），只要其配置能执行或触发进一步的恶意活动即可。此载荷将隐藏在NTFS数据流中。
7.  **压缩包生成**：POC工具将生成一个恶意的`.rar`压缩包，其中包含可见的诱饵文件和隐藏的、经路径修补的载荷。
8.  **分发**：攻击者将此精心制作的`.rar`压缩包分发给受害者，通常通过网络钓鱼邮件、恶意网站或即时消息。
9.  **受害者交互**：受害者在接收并使用未修补的WinRAR版本解压该压缩包时，会在不知情的情况下触发漏洞。路径遍历漏洞与ADS技术结合，将隐藏的载荷文件写入到指定的“启动”目录。
10. **载荷执行**：在下次系统启动或用户登录时，操作系统会自动执行“启动”文件夹中的任何文件，从而激活攻击者的载荷并实现持久性的任意代码执行。

**投毒风险分析**
对所提供的POC代码本身的投毒风险评估为低（10%）。“投毒风险”指的是POC代码（旨在用于安全研究或漏洞利用演示）包含可能损害运行POC的用户或系统的隐藏恶意功能的可能性。
1.  **明确意图**：`README.md`明确指出：“此存储库仅用于教育目的。”这一声明，结合其详细解释如何制作恶意压缩包，表明该工具的目的是**生成**载荷，而不是本身作为载荷或执行未经授权的操作。
2.  **代码可见性**：提供的代码片段仅限于`README.md`、`valentines.sln`（Visual Studio解决方案文件）和`valentines.vcxproj`（Visual Studio项目文件）。这些文件描述了项目结构和依赖项（C++20，zlib），但不包含执行压缩包操作和漏洞利用逻辑的实际C++源代码（`.cpp`、`.h`文件）。在没有完整源代码的情况下，无法对隐藏后门、未经授权的网络通信或其他恶意功能进行深入分析。
3.  **依赖分析**：POC依赖于`zlib`等标准库。尽管外部依赖项有时可能成为供应链攻击的载体，但`zlib`是一个广受信赖且经过审计的压缩库。C++20的要求表明其使用了现代C++特性。
4.  **观察行为**：根据`README`中描述的用法，该工具接收输入（用户名、文件路径）并输出一个`.rar`文件。没有迹象表明该工具本身在执行过程中会进行任何网络请求、数据外泄、系统修改（超出创建`.rar`文件）或其他可疑活动。
5.  **用户缓解措施**：对于可能下载此类POC的安全研究人员或从业者，最佳实践包括：
    *   **源代码审查**：如果提供完整源代码，应进行彻底的人工审查，以查找可疑的API调用、异常网络活动或超出其声明目的的文件系统操作。
    *   **沙盒环境**：始终在隔离的沙盒环境（例如，没有网络访问或敏感数据的虚拟机）中编译和运行POC，以防止任何潜在的意外后果。
    *   **依赖验证**：确保任何外部库或依赖项都从受信任的来源获取，并在可能的情况下验证其完整性。
    *   **行为监控**：在执行期间监控POC的进程活动、网络连接和文件系统更改，以检测任何异常行为。
综上所述，虽然未提供完整的C++源代码进行全面审计，但现有文档和项目文件并未表明POC生成工具本身存在任何固有的恶意意图或“投毒”行为。POC工具本身被投毒的风险较低，但用户在处理来自外部来源的任何可执行文件或源代码时，应始终保持警惕并进行自身的尽职调查。

**项目地址:** Not explicitly provided in the input data, but implied to be hosted on GitHub.

**漏洞详情:** Not explicitly provided in the input data.
