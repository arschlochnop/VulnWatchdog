## CVE-2025-8088 - WinRAR 路径遍历

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** 高危

**影响版本:** WinRAR的旧版本 (包括Windows版RAR、UnRAR、便携式UnRAR源代码及UnRAR.dll)

**利用条件:** 需要用户交互 (解压恶意压缩包), 需要目标用户Windows用户名

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

CVE-2025-8088是一个影响WinRAR软件的严重安全漏洞，其核心在于WinRAR在处理特制压缩文件时存在的目录遍历缺陷。攻击者可以巧妙利用Windows NTFS备用数据流 (ADS) 特性以及压缩包内的路径修补技术，绕过WinRAR的文件验证机制。当受害者解压攻击者构造的恶意RAR文件时，该漏洞会导致恶意文件被释放到非预期的系统位置，例如用户的“启动”文件夹，最终实现任意代码执行。

**POC有效性分析:**
该POC代码提供了一个用于利用CVE-2025-8088 WinRAR路径遍历漏洞的工具实现。根据`README.md`文件，该工具是一个C++程序，旨在通过利用Windows NTFS备用数据流 (ADS) 特性以及压缩包内的路径修补技术，构造恶意的RAR压缩文件。当受害者使用未打补丁的WinRAR版本解压此类压缩包时，攻击者指定的payload（例如可执行文件、PowerShell脚本或伪装文件）会被重定向并释放到目标路径，通常是受害者的“启动”文件夹。这意味着在受害者下次系统启动时，该payload将自动执行，从而实现任意代码执行。POC的`README.md`详细说明了其工作原理、使用方法（包括需要目标Windows用户名、提供正常文件作诱饵、指定payload文件路径等），并指出了利用的局限性（需知道用户名，仅对未更新的WinRAR版本有效）。Visual Studio解决方案文件（`.sln`, `.vcxproj`）的存在表明这是一个完整的、可编译的项目，支持C++20及zlib库，进一步验证了其功能性和可用性。因此，该POC被评估为功能完整且可用于重现和利用该漏洞。

**利用步骤:**
1. **信息收集**: 攻击者首先需要获取目标受害者的Windows用户名，这是POC成功投放payload到“启动”文件夹的关键前提。
2. **环境准备**: 攻击者在自己的系统上编译并运行提供的C++ POC工具，该工具将用于生成恶意RAR压缩包。
3. **参数输入**: 攻击者按照工具的提示，依次输入受害者的Windows用户名、一个包含正常文件的文件夹路径（这些文件将作为诱饵在压缩包中显示，以降低受害者警惕），以及一个恶意payload文件的路径（例如一个恶意可执行文件或脚本）。
4. **生成恶意压缩包**: 工具根据输入参数，利用WinRAR的路径遍历漏洞和ADS特性，自动生成一个特制的恶意RAR压缩包。
5. **诱骗传播**: 攻击者通过社会工程学手段（如钓鱼邮件、恶意网站下载等）将此恶意RAR压缩包发送给受害者，并诱导受害者下载并解压。
6. **漏洞触发与执行**: 当受害者使用存在漏洞的WinRAR版本解压该压缩包时，恶意payload文件会在不经意间被释放到其“启动”文件夹中。
7. **持久化与代码执行**: 受害者在下次重启其Windows系统时，位于“启动”文件夹中的恶意payload将自动执行，从而赋予攻击者在目标系统上任意代码执行的能力。

**投毒风险分析:**
对所提供的POC代码进行投毒风险评估，旨在判断该代码自身是否包含恶意成分，可能在研究员进行分析或编译时对其系统造成损害。
首先，从**代码可读性与审查**方面看，该POC代码是基于C++开发的，并提供了标准的Visual Studio项目文件（`.sln`和`.vcxproj`）。C++代码在编译为可执行文件之前，通常可以通过源代码审计进行详细审查。`README.md`文件对POC的原理、功能和使用方法进行了详细描述，这种透明度有助于研究人员理解代码意图，降低潜在的隐蔽恶意行为风险。
其次，关于**依赖项和外部资源**，POC明确指出需要`zlib`库，并要求C++20或更高版本。`zlib`是一个广泛认可且安全的开源数据压缩库，其自身通常不携带恶意代码。在提供的POC代码片段中，没有迹象表明该工具会从外部网络下载额外的代码或更新恶意组件，这意味着其行为主要受限于本地提供的源代码。
再者，关于**代码混淆和加密**，所提供的代码片段和项目文件均未显示明显的混淆或加密技术。标准的Visual Studio项目结构和普通的C++源代码使得对代码的静态分析相对容易。
最关键的是对**恶意行为**的分析。需要明确区分POC代码的“目的”与POC代码“自身”是否恶意。该POC的明确目的是 *生成* 一个用于利用WinRAR漏洞的恶意RAR文件，该恶意文件在受害者系统上解压后可能导致任意代码执行。但POC代码本身，即用于生成恶意RAR文件的工具，并不包含自我传播、破坏研究环境、窃取研究员数据或以其他方式危害研究员系统的功能。它是一个 *攻击工具的构建器*，而不是一个 *攻击载荷*。换句话说，其功能是按照用户指令创建恶意文件，而非自行执行恶意行为。
综合以上分析，该POC代码被评估为**低投毒风险 (10%)**。主要理由是：代码清晰可审计，使用标准库，无明显混淆或加密，且其自身不包含针对研究人员系统的恶意功能。研究人员应始终在隔离且受控的环境中进行代码审查、编译和执行，并对由该工具生成的任何恶意压缩包进行沙箱分析，以确保其安全地用于防御性研究目的。遵循这些最佳实践，可以有效规避潜在风险。

**项目地址:** 未提供公开项目地址

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8088
