## CVE-2025-8088 - WinRAR 路径遍历 (Path Traversal), 任意代码执行 (Arbitrary Code Execution)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历 (Path Traversal), 任意代码执行 (Arbitrary Code Execution)

**影响应用:** WinRAR

**危害等级:** 高危 (High)

**CVSS评分:** 8.4

**影响版本:** Older or unpatched versions of WinRAR, including Windows RAR, UnRAR, portable UnRAR source code, and UnRAR.dll.

**利用条件:** Victim interaction required: decompressing a specially crafted RAR archive; requires knowledge of target's Windows username for specific payload placement (e.g., Startup folder).

**POC 可用性:** 9/10

**POC 类型:** 完整利用 (Full Exploit)

**攻击复杂度:** 中 (Medium)

**投毒风险:** 10%

## 详情

CVE-2025-8088是一个影响WinRAR软件的严重安全漏洞，攻击者可以通过精心构造的恶意压缩包，利用Windows NTFS备用数据流（ADS）特性和路径遍历技术，绕过WinRAR的文件验证机制，将恶意文件释放到系统任意位置（如启动文件夹），最终实现任意代码执行。

**POC有效性分析:**
提供的POC代码是一个用C++实现的漏洞利用工具，其目标是生成一个恶意的RAR压缩包。该POC通过操纵压缩包内的文件路径，并结合ADS，使得在受害者解压时，预设的恶意负载能够被重定向并放置到攻击者指定的目标路径，特别是Windows的启动文件夹。README文件清晰地阐述了这一机制，并指出当受害者下次系统启动时，位于启动文件夹的负载将自动执行。POC的实现需要zlib库并支持C++20及更高版本，这表明它是一个完整的、可编译的程序。提供的Visual Studio解决方案文件（.sln）和项目文件（.vcxproj）进一步证实了其工程化和可用性。POC作者也明确提及该漏洞已在最新版WinRAR中修复，因此仅对未及时更新的老旧版本有效，且成功利用需要知道目标系统的Windows用户名，以便将恶意文件精准投放至用户特定的启动路径。综合来看，该POC是一个高度有效且功能完整的漏洞利用工具，能够成功演示并利用CVE-2025-8088来实现任意代码执行。

**利用步骤:**
1.  **环境准备**：攻击者首先需要在C++开发环境中（如Visual Studio）编译POC代码，确保zlib库已正确配置，从而生成漏洞利用工具的可执行文件。
2.  **信息收集**：攻击者需预先获取目标受害者的Windows用户名，这是确保恶意负载能被准确放置到目标启动文件夹的关键信息。
3.  **准备诱饵与负载**：攻击者需准备一个看似无害的文件夹作为RAR压缩包的正常内容，以迷惑受害者。同时，准备一个恶意负载文件，可以是可执行文件（.exe）、PowerShell脚本（.ps1），甚至是伪装成图片文件（如.png）的可执行文件。
4.  **生成恶意RAR**：运行编译后的POC工具，按照提示输入目标Windows用户名、诱饵文件夹的路径以及恶意负载文件的路径。POC工具将自动构造一个包含路径遍历逻辑的恶意RAR压缩包。
5.  **社会工程**：攻击者通过钓鱼邮件、即时消息、恶意网站下载等社会工程手段，将特制的恶意RAR压缩包发送给受害者，并诱导其下载并解压。诱饵内容通常会与时事、地缘政治或受害者个人兴趣高度相关，以提高打开率。
6.  **触发执行**：当受害者使用存在漏洞的WinRAR版本（包括Windows版RAR、UnRAR或其DLL组件）解压该恶意压缩包时，利用路径遍历漏洞，恶意负载将通过ADS被释放到受害者的Windows启动文件夹中。
7.  **持久化与执行**：一旦受害者下次重启系统，位于启动文件夹中的恶意负载便会自动执行，从而赋予攻击者在受害者系统上执行任意代码的能力，实现攻击目的。

**投毒风险分析:**
针对此POC代码本身的投毒风险评估为低（约10%）。该POC的主要功能是作为一个工具，用于创建恶意WinRAR压缩包，而非其自身在执行时对研究人员的系统造成危害。README文件明确指出该项目仅用于“教育目的”，旨在帮助安全研究人员理解和复现CVE-2025-8088漏洞。代码的依赖项主要包括zlib，这是一个广泛使用的标准压缩库，不具备恶意性。提供的文件是Visual Studio解决方案和项目文件（.sln, .vcxproj），这些是标准的开发环境配置文件，用于管理C++项目的构建过程，本身不包含或执行恶意代码。在提供的代码片段和描述中，没有发现任何迹象表明POC代码包含混淆逻辑、会从外部可疑源下载并执行额外代码、或者具备自我复制、数据窃取等恶意行为。因此，运行和编译这个POC工具，其直接的投毒风险极低。然而，任何安全研究人员在处理这类攻击性工具时，仍应保持警惕，建议在隔离的沙盒环境中进行编译和测试，并对完整的源代码进行审查，以确保其行为完全符合其声明的教育目的，避免意外或未知的风险。

**项目地址:** N/A - Repository URL not explicitly provided in the input, only local file paths and an asset link.

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8088
