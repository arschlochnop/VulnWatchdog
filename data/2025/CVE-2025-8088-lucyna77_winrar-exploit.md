## CVE-2025-8088 - WinRAR (Windows 版本) 路径遍历 / 任意文件写入

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历 / 任意文件写入

**影响应用:** WinRAR (Windows 版本)

**危害等级:** 高危 (High)

**CVSS评分:** CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H (估算 7.8)

**影响版本:** 7.12 及以下版本

**利用条件:** 用户下载并使用受影响版本的 WinRAR 解压经过恶意构造的压缩包文件

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞是WinRAR在处理Windows NTFS备用数据流（ADS）和文件提取逻辑时存在的安全缺陷。通过搜索结果和提供的POC代码分析，漏洞利用的核心在于构建一个包含特殊路径映射的压缩包。攻击者利用ADS特性（如 filename:stream_name）配合路径遍历序列（..\），可以绕过WinRAR原有的解压路径限制。提供的POC代码是一个基于C++ 20编写的自动化生成工具，它通过修改压缩包内部的文件头结构，将恶意载荷重定向到系统关键位置。代码逻辑显示其通过zlib库操作压缩结构，利用'valentines'这一占位符作为混淆或触发点，能够精准地将文件写入用户启动目录。该POC不仅是概念验证，更是一个武器化的生成器，只需提供目标用户名和载荷路径即可生成恶意RAR。由于漏洞利用依赖于解压时的文件系统交互，只要用户在未打补丁（7.13版本以下）的环境中双击解压，文件就会被静默释放到指定路径。利用步骤通常包括：1. 确认目标Windows系统的用户名；2. 使用POC工具指定合法的展示文件和恶意的Payload文件（如.exe或.ps1）；3. 工具生成恶意RAR包；4. 诱导受害者解压该包；5. 系统重启后启动项中的恶意程序自动运行。【投毒风险分析】该POC项目目前的投毒风险评级为低。代码库采用了标准的C++ Visual Studio工程结构，代码逻辑主要围绕文件I/O、字符串处理及zlib压缩库调用。通过对README和代码框架的审查，未发现明显的恶意行为。项目开发者明确指出该工具仅用于教育目的，且代码中未发现隐藏的远程下载指令、反弹Shell或自我复制逻辑。虽然其生成的压缩包会导致载荷植入（这是POC本身的功能），但POC生成器源码本身是透明的。风险主要集中在两点：一是该项目依赖外部zlib库，若用户从非官方源获取预编译库可能存在风险；二是项目描述中提到的'valentines'可能带有社交工程色彩，容易被恶意攻击者稍加修改后直接用于钓鱼攻击。从防御者角度看，该代码库是典型的安全研究产物，其风险更多在于被非法利用而非代码本身携带后门。然而，安全人员在下载和编译此类POC时，仍建议在隔离的沙盒环境中运行，以防止生成过程中由于路径配置错误导致本地环境意外受损。

**项目地址:** [https://github.com/user-attachments/assets/d7fc4825-26f7-4452-824c-231815050c03](https://github.com/user-attachments/assets/d7fc4825-26f7-4452-824c-231815050c03) (视频展示链接/模拟地址)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)
