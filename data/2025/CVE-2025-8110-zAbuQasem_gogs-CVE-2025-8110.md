## CVE-2025-8110 - Gogs 符号链接绕过, 任意文件写入, 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-8110

**漏洞类型:** 符号链接绕过, 任意文件写入, 远程代码执行 (RCE)

**影响应用:** Gogs

**危害等级:** 高危

**CVSS评分:** CVSS 4.0: 8.7, CVSS 3.1: 7.8

**影响版本:** Gogs <= (版本号待确定，绕过了CVE-2024-55947的修复)

**利用条件:** 需要经过认证（低权限用户即可），需要网络访问

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-8110是Gogs自托管Git服务的一项高危远程代码执行（RCE）漏洞，CVSS 4.0评分为8.7，CVSS 3.1评分为7.8。该漏洞源于Gogs在处理Git仓库中的符号链接时过滤不当，使得攻击者能够绕过CVE-2024-55947的修复，通过创建指向敏感文件的符号链接实现任意文件写入。最终，攻击者可覆盖如Go模板文件（例如`templates/base/head.tmpl`）或SSH授权文件，从而在服务器上执行任意代码。

提供的Python PoC脚本功能完整且高度自动化。它首先进行用户认证（可注册新用户），然后创建一个新的Git仓库。核心利用步骤包括：在本地构造一个包含恶意符号链接（指向服务器上的Go模板文件）的Git仓库，并将其推送到Gogs服务器。当服务器处理此仓库时，符号链接被误用，导致任意文件写入。PoC利用Gogs的`PutContents` API将Python反向Shell代码注入到受影响的模板文件中。一旦访问相关页面，注入代码即被执行，成功获取目标服务器的反向Shell，实现RCE。

该PoC脚本的投毒风险评估为低（5%）。代码清晰可读，无混淆，仅使用标准Python库，且所有外部通信均指向目标Gogs服务器。脚本中的反向Shell payload是标准的演示性代码，旨在展示漏洞影响，不含任何隐蔽的恶意功能或第三方回调。这是一个合法的安全研究工具，旨在帮助防御者理解和验证漏洞，而非进行恶意攻击。

**项目地址:** N/A (本地文件，无公开仓库链接)

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8110
