## CVE-2025-8110 - Gogs 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-8110

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Gogs

**危害等级:** 严重 (Critical)

**CVSS评分:** 9.8 (预测)

**影响版本:** Gogs < 0.13.0 (根据历史修复版本推断)

**利用条件:** 需要经过身份验证的用户权限，且目标系统允许创建符号链接（Symlinks）

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞（CVE-2025-8110）是针对Gogs先前漏洞修复（如CVE-2024-55947）的绕过。漏洞核心在于Gogs在处理Git仓库中的文件上传或解压时，未能对符号链接（Symbolic Links）进行深度递归检查。攻击者可以通过构造一个包含指向敏感路径（如.git目录或内部配置文件）的符号链接的恶意Git仓库，在服务器端触发文件覆盖。提供的Python POC代码展示了完整的利用链：首先通过自动化流程注册并登录用户，随后利用获取的API令牌或CSRF Token创建新仓库。利用的关键在于构造特殊的git tree，使符号链接指向内部配置文件。当Gogs执行后台git操作或特定的Web Hooks时，攻击者可以通过路径穿越执行任意OS命令。该POC使用了requests、BeautifulSoup和Rich库，逻辑清晰，涵盖了从身份验证到payload触发的全过程，具有极高的实战参考价值和复现成功率。【利用步骤】1. 使用POC中的register/login模块在目标Gogs实例获取有效会话。2. 获取CSRF令牌以进行后续API操作。3. 自动化生成一个包含恶意符号链接的仓库结构，该链接指向Gogs运行环境下的敏感系统文件或git配置文件。4. 推送或通过Web上传该结构至服务器。5. 触发特定的文件读取或写入动作（如查看源文件、编辑文件），导致Gogs在执行内部git命令时解析了攻击者控制的参数，从而实现远程命令注入。【投毒风险分析】经过对提供的POC代码前部及逻辑结构的静态分析，该脚本表现出高度的专业性，主要依赖Python标准库及通用的第三方库（如requests、bs4、rich）。代码中未发现明显的混淆（Obfuscation）手段，逻辑流（注册 -> 登录 -> 获取Token -> 操作仓库）符合常规的安全研究路径。然而，风险点在于脚本引入了外部依赖库，且在复杂的攻击载荷构建部分（截断部分）可能包含Base64编码的Payload，若该Payload包含反弹Shell之外的恶意逻辑（如删除系统文件、窃取环境变量），则存在潜在的二阶风险。目前分析认为投毒风险较低（15%），主要属于合法的安全研究辅助工具。但使用者在生产或敏感环境中运行此类脚本前，应仔细检查脚本中的代理设置（如硬编码的localhost:8080）以及后续可能出现的OS命令拼接部分，确保Payload仅用于回显验证而非破坏性操作。建议在隔离的沙箱环境中使用该POC，并对传出的网络流量进行监控。

**项目地址:** [https://github.com/zAbuQasem/CVE-2025-8110-Exploit](https://www.google.com/search?q=https://github.com/zAbuQasem/CVE-2025-8110-Exploit)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8110](https://nvd.nist.gov/vuln/detail/CVE-2025-8110)
