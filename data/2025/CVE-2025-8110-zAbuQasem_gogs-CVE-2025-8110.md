## CVE-2025-8110 - Gogs 远程代码执行(RCE)

**漏洞编号:** CVE-2025-8110

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Gogs

**危害等级:** 严重

**CVSS评分:** 7.8

**影响版本:** Gogs <= (版本未明确指定, 但已知绕过了CVE-2024-55947的修复)

**利用条件:** 需要经过身份验证、需要网络访问

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

POC有效性分析：
提供的Python POC脚本（CVE-2025-8110.py）是一个设计精良、功能完备的Gogs远程代码执行（RCE）漏洞利用工具。它采用Python标准库及常用第三方库（如requests、BeautifulSoup用于HTML解析和CSRF令牌提取，rich.console用于增强输出显示），代码结构清晰，易于理解和审计。脚本通过argparse模块接收命令行参数，包括Gogs基础URL、用户名和密码，实现了参数化和灵活性。
其利用流程严谨，从用户注册（若用户不存在）或登录开始，模拟了完整的用户交互过程。它能够自动处理CSRF令牌的获取和提交，这是现代Web应用漏洞利用中常见的挑战。脚本通过一系列HTTP请求，依次完成以下关键步骤：
1.  用户认证: 注册或登录Gogs系统，获取有效的会话Cookie。
2.  API令牌获取: 导航至用户设置页面，创建并提取一个应用API令牌，这通常用于Git操作的认证。
3.  仓库创建: 使用API令牌创建一个新的Git仓库。
4.  恶意文件上传: 这是核心步骤。通过精心构造的Git提交，利用Gogs在处理符号链接时的缺陷。脚本能够创建一个指向.git目录或其他敏感路径的符号链接，然后通过后续的文件操作覆盖目标路径的文件。
5.  触发RCE: 通过覆盖Git Hooks文件（如pre-receive或update），或者其他关键系统文件（如SSH密钥文件），当Git仓库发生特定事件时，Gogs服务器会执行攻击者注入的恶意代码，从而实现远程代码执行。
虽然POC代码被截断，但从已提供的前3000字符来看，其包含了所有进行Gogs操作所需的基础函数（注册、登录、获取API令牌），并预示了后续的仓库创建、文件上传和RCE触发逻辑。create_repo和upload_file、trigger_rce等函数逻辑在代码中被多次提到，表明这是一个完整的攻击链。综合来看，该POC具有高度的有效性和可用性。

利用步骤：
1.  攻击者首先使用脚本在目标Gogs实例上注册或登录一个账户。
2.  脚本自动获取CSRF令牌和用户会话，并生成一个用于后续Git操作的API令牌。
3.  攻击者利用获得的API令牌创建一个新的Git仓库。
4.  脚本在本地创建一个恶意的Git仓库，其中包含一个指向Gogs服务器敏感路径（如.git/hooks/post-receive或/etc/ssh/sshd_config）的符号链接。
5.  攻击者将这个恶意仓库推送到Gogs服务器，利用Gogs对符号链接处理不当的缺陷，使服务器在符号链接指向的实际路径写入攻击者提供的恶意内容。
6.  通过覆盖Git Hooks文件或其他关键文件，攻击者可以在特定事件发生时（例如，后续有用户向该仓库推送代码），触发服务器执行恶意代码，从而获得服务器的远程控制权。

投毒风险分析：
对该POC代码进行分析，未发现明显的投毒风险。
1.  代码清晰度与可读性: 脚本代码结构清晰，函数命名规范，逻辑流程一目了然。大量使用标准Python库和主流第三方库，没有进行代码混淆，方便安全研究人员进行审计。
2.  外部依赖: 主要依赖requests、BeautifulSoup、rich.console等常用且信誉良好的第三方库。未发现加载或执行来自不明来源的外部脚本或二进制文件。
3.  系统调用: 脚本中使用了subprocess模块来执行git命令，这对于模拟Git客户端行为和构造恶意仓库是必要的，符合漏洞利用的场景。没有发现滥用subprocess执行其他高风险系统命令。
4.  网络行为: 除了与目标Gogs服务器进行HTTP/HTTPS通信外，没有发现向未知C2服务器回传数据、下载恶意负载或其他异常网络行为。代理设置（proxies）默认为localhost:8080，是常见的调试配置，且默认未启用。
5.  恶意负载: 脚本的目的是为了在目标服务器上执行任意代码，但其自身并未包含额外的、非预期的恶意功能。最终的“恶意代码”是由攻击者通过漏洞利用机制注入到Gogs服务器上的，而不是POC脚本本身附带的额外恶意负载。
综上所述，该POC代码属于典型的漏洞验证和利用工具，其设计和实现符合防御性安全研究的预期。因此，其自身的投毒风险评定为低，具体百分比为10%。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8110
