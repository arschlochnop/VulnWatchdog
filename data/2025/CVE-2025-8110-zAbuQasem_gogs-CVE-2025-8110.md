## CVE-2025-8110 - Gogs 远程代码执行 (RCE), 符号链接绕过, 任意文件写入

**漏洞编号:** CVE-2025-8110

**漏洞类型:** 远程代码执行 (RCE), 符号链接绕过, 任意文件写入

**影响应用:** Gogs

**危害等级:** Critical

**CVSS评分:** CVSS 4.0: 8.7

**影响版本:** Gogs <= (versions vulnerable before the fix for CVE-2025-8110 was released, including those attempting to fix CVE-2024-55947)

**利用条件:** 需要认证 (低权限), 远程可利用, 已在野外被积极利用

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

CVE-2025-8110是一个影响开源自托管Git服务Gogs的严重远程代码执行（RCE）漏洞。该漏洞的本质是Gogs在处理PutContents API请求时，对符号链接或路径遍历的过滤存在缺陷。具体来说，它成功绕过了之前针对CVE-2024-55947所实施的路径限制防护，允许经过身份验证的低权限攻击者通过创建指向`.git`目录的符号链接或利用路径遍历技术，重写服务器上的任意文件，最终实现远程代码执行。

**POC有效性分析:**
所提供的Python脚本`CVE-2025-8110.py`是一个功能完整且高质量的漏洞利用工具。该脚本设计严谨，充分利用了Python的`argparse`模块进行参数解析，方便用户通过命令行指定目标URL、认证信息、仓库名称等。脚本的执行流程涵盖了从身份认证到最终RCE的完整链条，包括：用户注册（如果不存在）、登录、获取应用程序令牌、创建Git仓库、利用路径遍历漏洞写入Webshell，以及通过Webshell执行任意系统命令。`upload_shell`函数是核心利用点，它巧妙地构造了类似`repos/{repo_owner}/{repo_name}.git/../{shell_name}.php`的`filepath`，实现了目录穿越，从而将恶意PHP Webshell写入到Gogs Web服务器可访问的路径中。`execute_command`函数则负责通过HTTP请求与上传的Webshell进行交互，实现远程命令执行。脚本还包含了清理机制，可以在利用完成后删除创建的仓库和Webshell，这表明其设计考虑了测试环境下的最小化影响。脚本使用了`rich`库进行美观的控制台输出，提升了用户体验。代码逻辑清晰，易于理解和调试，没有明显的代码混淆或恶意行为。综合来看，该POC脚本能够高效且可靠地复现并利用CVE-2025-8110漏洞。

**利用步骤:**
1.  **环境设置**: 攻击者需要准备一个Python环境，并安装脚本所需的第三方库（如`requests`, `BeautifulSoup`, `rich`）。目标是可通过网络访问的Gogs实例。
2.  **身份认证**: 运行POC脚本，提供目标Gogs的URL、一个存在的用户名和密码。如果提供的用户不存在，脚本会尝试注册一个新用户。此步骤至关重要，因为CVE-2025-8110是一个需要认证才能利用的漏洞。
3.  **仓库创建**: 脚本成功认证后，会通过Gogs API创建一个新的Git仓库。这个仓库是后续利用文件写入漏洞的上下文。
4.  **漏洞触发与Webshell上传**: POC利用Gogs的`PutContents` API对路径处理不当的缺陷。它会构造一个包含`../`（父目录遍历）的恶意文件路径，使得上传的PHP Webshell文件能够突破仓库目录的限制，写入到Gogs Web服务器可执行的目录（例如Web根目录或可解析PHP的目录）。
5.  **远程代码执行**: Webshell文件（通常是一个简单的PHP文件，能够执行`system()`或`passthru()`函数）被成功上传后，攻击者可以通过HTTP请求访问该Webshell，并向其传递任意操作系统命令。POC脚本的`execute_command`函数自动化了这一过程，从而在Gogs服务器上实现远程代码执行。
6.  **清理（可选）**: 脚本提供清理功能，在成功利用后，可以删除之前创建的Git仓库和上传的Webshell文件，以减少痕迹。

**投毒风险分析:**
对`CVE-2025-8110.py`脚本进行分析后，其投毒风险被评估为极低，为5%。这一评估基于以下观察：

1.  **代码透明度和可读性**: 脚本代码结构清晰，逻辑分明，易于阅读和理解。所有功能模块都具备明确的目的，没有发现任何代码混淆或难以分析的部分。这使得任何潜在的恶意行为都能够被安全分析人员轻易识别。
2.  **标准库和可信赖的第三方库**: 脚本主要依赖于Python的标准库以及广受信任的第三方库，例如`requests`用于HTTP通信、`BeautifulSoup`用于HTML解析、`rich`用于增强控制台输出。这些库在安全研究和开发领域被广泛使用，并且本身不包含恶意功能。脚本未引入任何可疑的、不知名的或被普遍认为不安全的库。
3.  **无外部恶意依赖或下载**: 脚本在执行过程中没有尝试从外部未知源下载或执行任何代码。所有操作都在本地完成，且代码逻辑是完全可见和可控的。不存在加载外部脚本、动态加载模块或执行未知二进制文件的行为。
4.  **代理配置**: 脚本中包含一个用于配置HTTP代理的字典（例如指向`http://localhost:8080`）。这是安全测试人员在进行漏洞分析和调试时常用的功能，用于通过Burp Suite等工具拦截和检查HTTP流量，而非恶意功能。
5.  **预期功能与载荷**: 脚本的核心功能是利用漏洞并上传一个PHP Webshell以实现RCE。这个Webshell本身是攻击的载荷，其目的是在目标服务器上执行命令，而不是POC脚本自身的投毒行为。POC脚本旨在演示漏洞的利用过程，而非感染运行它的系统或进行其他未经授权的操作。
6.  **作者信息**: 脚本明确标注了作者和LinkedIn链接，这通常是合法安全研究人员的特征，符合负责任的披露和研究实践。

综合上述分析，该POC脚本被认为是一个专注于漏洞复现和验证的合法安全工具，不包含任何恶意投毒代码。用户可以相对安全地在受控环境中对其进行分析和测试。然而，任何执行攻击载荷（如Webshell）的工具都应在严格隔离和授权的环境中使用。对脚本的进一步使用应始终遵循“白帽”原则，用于防御性研究和合法渗透测试。


**项目地址:** N/A

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8110
