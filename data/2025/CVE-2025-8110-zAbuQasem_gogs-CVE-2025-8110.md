## CVE-2025-8110 - Gogs 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-8110

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Gogs

**危害等级:** 高危

**CVSS评分:** 8.7 (CVSS 4.0)

**影响版本:** Gogs <= 最新受影响版本 (具体版本未在公开信息中明确指出)

**利用条件:** 需要认证 (POC支持注册新用户)，需要网络访问

**POC 可用性:** 10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

该POC脚本 (CVE-2025-8110.py) 是一个为Gogs自托管Git服务远程代码执行 (RCE) 漏洞开发的完整且功能强大的利用工具。该漏洞源于Gogs对符号链接处理不当，允许攻击者绕过CVE-2024-55947的路径限制防护，实现任意文件写入，并最终导致RCE。

**POC有效性分析:**
提供的Python POC脚本展现出极高的有效性和完整性。它是一个结构良好、模块化的脚本，利用`argparse`进行参数解析，`requests`进行HTTP请求，`BeautifulSoup`进行HTML解析以提取CSRF令牌，并使用`rich`库美化控制台输出。脚本实现了完整的漏洞利用链，包括用户注册、登录、应用令牌获取、仓库创建、恶意文件上传、符号链接创建以及命令执行。它能准确处理Gogs的CSRF防御机制和会话管理，确保利用流程的顺畅。`subprocess`模块被用于模拟本地Git操作，如初始化仓库、添加文件、创建符号链接和提交更改，这精确地模拟了攻击者在准备恶意载荷时的行为。脚本还包含一个`clean_up`函数，旨在清除利用过程中产生的痕迹，这体现了其作为安全研究工具的专业性。总的来说，该POC是高度可靠和可复现的，适用于对目标Gogs实例进行漏洞验证和影响评估。

**利用步骤:**
1.  **身份认证或注册**: POC首先尝试使用提供的凭据登录Gogs实例。如果登录失败，或未提供凭据但允许公开注册，它将尝试注册一个新用户以获取必要的认证权限。
2.  **获取应用令牌**: 登录成功后，POC会导航至用户设置页面，生成并提取一个API应用令牌。该令牌可能在后续与Gogs API的交互中用于认证。
3.  **本地构造恶意仓库**: 攻击者在本地创建一个Git仓库。该仓库包含一个经过精心构造的恶意文件（例如，一个包含WebShell或命令执行代码的脚本）和一个指向Gogs服务器上敏感目录（如`.git`目录，或更广泛地，任意可写目录）的符号链接。这个符号链接是绕过Gogs文件路径限制的关键，使得上传的文件可以被写入到预期外的任意位置。
4.  **上传恶意载荷**: POC通过Gogs的`PutContents` API，将本地构造的恶意Git仓库推送到目标Gogs实例。利用Gogs对符号链接解析的缺陷，当Gogs处理此上传请求时，恶意文件不会被限制在仓库目录内，而是通过符号链接的指向，被写入到服务器上的任意指定文件，例如Web根目录下的可执行脚本文件。
5.  **触发远程代码执行 (RCE)**: 一旦恶意文件（如`cmd.php`或`shell.jsp`）成功写入到Gogs服务器的Web可访问路径，攻击者即可通过Web请求访问该文件。POC通过`run_command`函数发送特定的HTTP请求，触发恶意文件中预设的命令执行代码，从而在目标服务器上执行任意系统命令。
6.  **清理操作 (可选)**: POC包含清理功能，尝试删除在攻击过程中创建的远程仓库和本地临时文件，以减少攻击痕迹。

**投毒风险分析:**
该POC脚本的投毒风险评估为**低 (10%)**。
1.  **代码透明度**: 脚本代码清晰、结构化，易于阅读和理解。它遵循标准的Python编码规范，没有发现任何代码混淆或加密，使得安全审计人员可以轻松审查其功能和行为。
2.  **依赖管理**: 脚本主要依赖于Python标准库以及`requests`、`BeautifulSoup`和`rich`等业界广泛使用且受信赖的第三方库。这些库都是开源的，并且在安全社区具有良好的声誉。脚本未引入任何未知来源或可疑的外部依赖项，降低了潜在的供应链风险。
3.  **网络活动**: 除了与目标Gogs实例进行必要的HTTP通信以实现漏洞利用外，脚本没有发起任何其他与外部服务器的可疑网络连接。代码中定义的`proxies`变量指向`http://localhost:8080`，这通常是安全研究人员使用Burp Suite等工具进行流量拦截和调试的标准配置，不构成恶意行为。
4.  **文件系统操作**: 脚本在执行过程中会在本地文件系统上创建临时目录和Git仓库以构造恶意载荷。这些操作是POC正常工作所必需的，并且设计了清理机制来删除这些临时文件。脚本未显示出任何对本地系统进行非授权文件修改、数据窃取或安装恶意软件的行为。
5.  **动态代码执行**: 脚本本身没有使用`eval()`、`exec()`等函数来动态执行来自不可信源的代码。`subprocess.run`被用于执行本地`git`命令以及在远程目标上执行最终的命令，这属于POC的核心功能和攻击载荷的组成部分，而非POC自身的恶意行为。
综上所述，该POC是一个合法的、专注于漏洞验证的安全工具，其设计和实现均未包含任何恶意或可疑的投毒组件，因此投毒风险极低。

**项目地址:** 未提供

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8110
