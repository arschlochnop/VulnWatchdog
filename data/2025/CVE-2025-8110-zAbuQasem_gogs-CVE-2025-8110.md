## CVE-2025-8110 - Gogs 远程代码执行 (RCE) / 命令注入

**漏洞编号:** CVE-2025-8110

**漏洞类型:** 远程代码执行 (RCE) / 命令注入

**影响应用:** Gogs

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** Gogs < 0.13.0 (具体受影响版本取决于CVE-2024-55947修复后的版本)

**利用条件:** 需要经过身份验证的用户权限，能够创建和操作Git仓库

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

POC有效性分析：该POC是一个功能完整的Python脚本，旨在利用Gogs中的符号链接处理漏洞。漏洞的核心在于Gogs在处理Git仓库中的符号链接时，未能正确限制其指向范围。攻击者可以通过创建一个指向内部敏感目录（如 .git 目录或配置文件）的符号链接，绕过之前CVE-2024-55947的修复补丁。POC代码展示了完整的攻击链：首先，脚本通过自动化流程注册新用户并登录以获取必要的CSRF令牌和Session；接着，它通过API生成应用令牌，创建一个新的仓库；随后，利用本地Git命令创建一个恶意的符号链接，该链接指向仓库内部的敏感路径；最后，通过上传或推送该恶意结构到Gogs服务器。一旦服务器在处理这些文件时触发了不安全的操作（如文件覆盖或非预期的Git钩子触发），攻击者即可在宿主机上执行任意系统命令。此POC逻辑清晰，使用了标准的requests、BeautifulSoup和subprocess库，不仅验证了目录穿越的可能性，还通过自动化步骤极大降低了复现难度，是极高价值的防御研究参考资料。利用步骤：1. 使用脚本自动注册或手动登录获取有效Session。2. 提取页面CSRF令牌。3. 生成API Token用于后续操作。4. 本地初始化Git仓库并创建指向敏感文件（如 config 或 .git/hooks）的符号链接。5. 将恶意仓库内容推送到目标Gogs服务器。6. 触发Gogs对符号链接的解析以实现文件篡改或代码执行。投毒风险分析：该脚本展示了极低的投毒风险。首先，代码结构透明，开发者使用了业界通用的Python库（requests, rich, bs4），未见任何混淆或加密处理。其次，所有的网络请求均指向用户定义的 base_url 参数，没有发现向第三方服务器发送敏感数据或心跳包的行为。脚本中包含的 proxies 配置（localhost:8080）说明开发者习惯于使用Burp Suite等工具进行调试，这是典型的安全研究人员特征。虽然脚本涉及到本地命令执行（subprocess），但这些命令仅用于操作本地临时Git目录以构造Payload，而非针对运行脚本的宿主机进行破坏。代码中显式标注了作者身份及LinkedIn链接，增加了代码的可信度。综合评估，该POC是纯粹的安全研究工具，不含恶意后门，但在生产环境测试时仍需谨慎，以防对目标数据库造成非预期破坏。

**项目地址:** [https://github.com/zAbuQasem/CVE-2025-8110-Exploit](https://www.google.com/search?q=https://github.com/zAbuQasem/CVE-2025-8110-Exploit)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8110](https://nvd.nist.gov/vuln/detail/CVE-2025-8110)
