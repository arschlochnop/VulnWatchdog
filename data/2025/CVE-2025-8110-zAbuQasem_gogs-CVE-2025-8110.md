## CVE-2025-8110 - Gogs Remote Code Execution (RCE), Arbitrary File Write, Symlink Bypass

**漏洞编号:** CVE-2025-8110

**漏洞类型:** Remote Code Execution (RCE), Arbitrary File Write, Symlink Bypass

**影响应用:** Gogs

**危害等级:** High

**CVSS评分:** CVSS 4.0: 8.7, CVSS v3.1: 7.8

**影响版本:** Gogs <= (versions affected prior to patch)

**利用条件:** Authenticated access required (can be low-privilege/self-registered user), network access to Gogs instance.

**POC 可用性:** 9

**POC 类型:** 完整利用 (Full Exploit)

**攻击复杂度:** Medium

**投毒风险:** 10%

## 详情

CVE-2025-8110是一个影响Gogs自托管Git服务的高危远程代码执行漏洞。该漏洞源于Gogs的`PutContents` API在处理文件路径时存在符号链接缺陷，成功绕过了先前CVE-2024-55947的路径限制保护。攻击者利用此缺陷，通过创建指向关键系统文件的符号链接或利用其对符号链接的错误解析，实现任意文件写入。最终，低权限或已认证的攻击者可通过覆盖Gogs服务器上的模板文件（例如`templates/user/settings/applications.tmpl`），注入恶意代码并触发远程代码执行（RCE）。该漏洞的CVSS 4.0评分为8.7分，CVSS v3.1评分为7.8分，且已在野外被积极利用，据报告已造成超过700个公网暴露的Gogs实例遭到入侵。受影响的产品为Gogs所有未打补丁的版本。

**POC有效性分析与利用步骤:**
提供的Python POC脚本（CVE-2025-8110.py）是一个高度自动化且功能完整的漏洞利用工具。脚本通过`argparse`模块接收目标Gogs URL、用户名、密码以及RCE类型（反弹shell或执行命令）等参数。

1.  **自动化认证与设置:** 脚本首先会尝试注册或登录指定用户，并通过模拟HTTP请求和处理CSRF令牌来建立有效的会话。随后，它会自动从用户设置页面获取API应用程序令牌，这是后续API交互的关键。为执行漏洞，脚本会在Gogs上创建一个临时的Git仓库。
2.  **核心漏洞利用:** 漏洞的核心在于利用Gogs `api/v1/repos/{owner}/{repo}/contents/{filepath}` PUT接口的符号链接处理缺陷。该缺陷允许攻击者绕过路径限制，将任意内容写入到Gogs服务器上的任意文件。POC利用此能力，将RCE payload注入到Go语言编写的反弹shell或命令执行代码中。脚本然后构造一个恶意的Gogs模板文件（例如`templates/user/settings/applications.tmpl`），其中包含经过Base64编码的RCE payload。
3.  **任意文件写入:** 脚本使用`put_contents`函数，利用漏洞将此恶意模板写入到Gogs服务器应用根目录下的`web/src/templates/user/settings/applications.tmpl`文件。尽管路径看似在攻击者创建的仓库内部，但Gogs内部对符号链接的错误解析导致实际写入操作能够越界，覆盖了Gogs服务器上的关键模板文件。
4.  **RCE触发:** 恶意模板文件被成功覆盖后，脚本通过发送一个GET请求到`/user/settings/applications`路径，强制Gogs渲染已被篡改的模板。当服务器渲染该模板时，其中嵌入的恶意Go代码被执行，从而在Gogs服务器上实现远程代码执行。如果攻击者选择反弹shell，脚本将指示在攻击机上启动相应的监听器。

该POC代码结构清晰，易于理解，并且包含了丰富的错误处理和用户提示，确保了较高的利用成功率。它提供了完整的自动化利用链，从认证到最终RCE触发，使其成为一个高质量的漏洞利用工具。

**投毒风险分析:**
对POC代码（CVE-2025-8110.py）进行了全面的投毒风险评估。该脚本使用了Python的标准库，包括`requests`、`os`、`subprocess`等，并未引入任何非标准或可疑的第三方依赖。脚本的核心功能完全围绕利用CVE-2025-8110漏洞展开，其所有网络请求都明确指向用户指定的目标Gogs URL，没有发现任何向未经授权的外部服务器发送数据、收集敏感信息或植入后门的尝试。

脚本中`subprocess`模块的使用仅限于在本地编译Go语言的反弹shell payload，此操作发生在执行POC的攻击者机器上，而非目标服务器，因此并非恶意行为。生成的Go payload也是为了实现漏洞验证所需的RCE功能，并非POC代码本身的额外恶意载荷。代码结构清晰，未进行任何形式的混淆或加密，易于安全研究人员审计。

综合来看，该POC代码的结构、依赖、功能和执行流程都符合合法漏洞利用工具的特征。它专注于实现CVE-2025-8110的漏洞利用，未包含任何额外的恶意功能。因此，该POC的投毒风险评估为**低 (10%)**。然而，作为安全研究的最佳实践，建议在沙箱环境中运行此类工具，并在运行前进行详细的代码审计，以确保其安全性。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8110
