## CVE-2025-55182 - React Server Components, Next.js RCE

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE

**影响应用:** React Server Components, Next.js

**危害等级:** Critical

**CVSS评分:** 10.0

**影响版本:** react-server-dom-webpack/parcel/turbopack: 19.0.0, 19.1.0, 19.1.1, 19.2.0; Next.js: 15.x, 16.x (App Router)

**利用条件:** Unauthenticated, requires network access

**POC 可用性:** 7/10

**POC 类型:** Concept Verification

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2025-55182是React Server Components中存在的一个严重远程代码执行（RCE）漏洞，该漏洞源于React Flight Protocol中的原型链污染。POC通过原型链污染访问`Function`构造函数，当Next.js `await`反序列化的对象时，它会调用`.then()`方法。然而，`.then()`是用V8的内部`resolve`和`reject`函数调用的，这些函数不受攻击者控制。这些内部函数在字符串化时序列化为`function () { [native code] }`，导致`SyntaxError: Unexpected token 'function'`。该漏洞影响`react-server-dom-webpack`、`react-server-dom-parcel`和`react-server-dom-turbopack`的19.0.0、19.1.0、19.1.1和19.2.0版本，以及Next.js 15.x和16.x（App Router）。

**利用步骤：**
1. 攻击者发送特制的请求，包含恶意的原型链污染payload。
2. React Server Components反序列化该payload，导致原型链被污染。
3. 当Next.js处理反序列化的对象时，会触发`.then()`方法，但由于内部函数序列化问题，导致错误。
4. 尽管该POC无法直接实现RCE，但它验证了原型链污染漏洞的存在，为进一步的RCE利用提供了基础。

**POC有效性分析：**
POC提供了一个Nuclei模板，用于检测受影响的应用程序是否易受攻击。它通过发送包含原型链污染payload的HTTP请求来工作。如果应用程序返回特定的错误消息（`SyntaxError: Unexpected token 'function'`），则表明该应用程序易受攻击。

**投毒风险分析：**
此POC的投毒风险较低，因为它不包含任何恶意代码或后门。它仅用于验证漏洞的存在。该POC主要使用标准的HTTP请求和Nuclei模板，没有发现任何可疑行为，也没有使用eval或外部脚本。代码清晰易懂，风险较低。但是，需要注意的是，如果攻击者将此POC与其他漏洞利用技术结合使用，则可能会导致更严重的后果。例如，攻击者可以使用此POC来污染原型链，然后利用另一个漏洞来执行任意代码。此POC的投毒风险估计为15%。

**项目地址:** https://github.com/msanft/CVE-2025-55182

**漏洞详情:** https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-55182
