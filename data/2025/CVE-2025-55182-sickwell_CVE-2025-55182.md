## CVE-2025-55182 - Next.js 远程代码执行

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行

**影响应用:** Next.js

**危害等级:** 严重

**CVSS评分:** 10.0

**影响版本:** Next.js: 15.x, 16.x (App Router); react-server-dom-webpack/react-server-dom-parcel/react-server-dom-turbopack: 19.0.0, 19.1.0, 19.1.1, 19.2.0

**利用条件:** 需要网络访问，可能需要特定gadget

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

CVE-2025-55182是一个存在于React Server Components中的远程代码执行漏洞，该漏洞的CVSS评分为10.0，属于最高危漏洞。攻击者可以通过React Flight Protocol中的原型污染来利用此漏洞。POC利用了`__proto__:constructor:constructor`来访问Function构造函数。该漏洞允许客户端调用服务器上的函数，React将客户端的请求转换为HTTP请求。当Next.js等待反序列化的对象时，它会调用`.then()`方法，但是`.then()`方法是通过V8内部的`resolve`和`reject`函数调用的，这些函数不受攻击者控制。这些内部函数在字符串化时会序列化为`function () { [native code] }`，从而导致`SyntaxError: Unexpected token 'function'`。该漏洞影响Next.js 15.x和16.x（App Router），以及react-server-dom-webpack、react-server-dom-parcel和react-server-dom-turbopack的19.0.0、19.1.0、19.1.1和19.2.0版本。

利用步骤：
1. 攻击者构造恶意的HTTP请求，其中包含原型污染的payload。
2. React Server Components接收到请求后，使用React Flight Protocol反序列化payload。
3. 原型污染允许攻击者访问Function构造函数。
4. 攻击者使用Function构造函数注入恶意代码。
5. 恶意代码在服务器端执行，从而导致远程代码执行。

POC有效性分析：
POC代码提供了一个Nuclei模板，用于检测目标系统是否存在CVE-2025-55182漏洞。该模板通过发送包含原型污染payload的HTTP请求来触发漏洞。如果目标系统存在漏洞，则Nuclei将检测到该漏洞并报告。同时，poc还提供了一个可以执行"id"命令并检索NEXT_REDIRECT头输出的yaml文件，可以验证rce。

投毒风险分析：
此POC的投毒风险较低，因为该POC代码主要用于检测漏洞是否存在，并没有包含恶意代码。该POC使用标准的JavaScript库，没有使用任何可疑的函数或API。此外，该POC的代码结构清晰，易于理解，没有进行任何混淆。该POC利用原型污染实现RCE，但是依赖于V8内部函数的行为，存在一定的局限性。但由于能够执行任意命令，仍然存在一定的安全风险，需要加以防范。

**项目地址:** https://github.com/msanft/CVE-2025-55182

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
