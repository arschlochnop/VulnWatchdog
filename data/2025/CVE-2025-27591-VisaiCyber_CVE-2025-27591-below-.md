## CVE-2025-27591 - Below (facebookincubator/below) 权限提升 (Privilege Escalation)

**漏洞编号:** CVE-2025-27591

**漏洞类型:** 权限提升 (Privilege Escalation)

**影响应用:** Below (facebookincubator/below)

**危害等级:** 高 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** < 0.9.0

**利用条件:** 本地普通用户访问权限，且目标系统安装了受影响版本的 below 服务并在运行（或可通过 sudo 触发）。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-27591 是存在于 Facebook 开发的系统监控工具 Below 中的权限提升漏洞。该漏洞的根源在于 below 服务在运行时会以 root 权限创建一个全局可写的目录 /var/log/below（权限为 0777），并且在该目录下生成的日志文件（如 error_root.log）也被赋予了宽松的写权限（0666）。由于该目录对所有用户开放写权限，且未应用粘滞位（Sticky Bit），本地低权限攻击者可以利用符号链接攻击（Symlink Attack）将日志文件替换为指向系统关键文件的符号链接，如 /etc/passwd。当 below 服务以 root 身份向该日志文件执行写操作时，由于其不安全地处理文件路径，实际写入的内容会被重定向到目标敏感文件中。POC 有效性分析显示，该利用脚本非常高效且直接。它首先通过备份 /etc/passwd 确保可恢复性，随后利用 openssl 生成一个新的 root 权限用户（root2）的哈希值。通过创建一个指向 /etc/passwd 的符号链接 /var/log/below/error_root.log，并调用 sudo /usr/bin/below replay 触发错误日志记录。关键步骤在于利用 shell 的重定向机制，由于 /var/log/below/error_root.log 已被攻击者控制且具有全局写权限，即使 kernel 开启了符号链接保护，在 0777 且无 sticky bit 的目录下，这种攻击依然具有极高的成功率。一旦 root 权限的进程触发写入，攻击者便能成功向 /etc/passwd 注入新用户。该 POC 流程完整，包含了环境检测、备份、载荷生成、触发利用及最终验证，是一个极具实战性的本地提权验证脚本。投毒风险分析：对该 POC 及其配套 README 进行静态分析，未发现恶意混淆、加密的 shellcode 或未经授权的外部网络请求。脚本中的关键操作如 cp /etc/passwd /tmp/passwd.bak 是标准的防御性备份行为，防止系统崩溃。生成的哈希值使用的是 openssl 标准命令，透明度高。虽然脚本涉及到修改系统核心文件 /etc/passwd，但这属于该类漏洞 POC 的标准提权验证逻辑，而非投毒行为。唯一潜在风险在于脚本使用 sudo -l 检测权限，在某些极其严苛的沙箱环境中可能触发警报，但对于安全研究员而言，这是合理的探测逻辑。代码逻辑清晰，所有操作均在本地执行，且脚本内容与 CVE 描述的利用链完全吻合，因此判定为低风险（5%），主要风险点在于用户需谨慎操作，避免在生产环境直接运行导致系统配置损坏。建议在隔离的虚拟机或容器环境中进行复现验证。

**项目地址:** [https://github.com/BridgerAlderson/CVE-2025-27591-PoC](https://github.com/BridgerAlderson/CVE-2025-27591-PoC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-27591](https://nvd.nist.gov/vuln/detail/CVE-2025-27591)
