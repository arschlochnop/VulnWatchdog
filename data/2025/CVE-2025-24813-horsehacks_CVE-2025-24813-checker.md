## CVE-2025-24813 - Apache Tomcat Remote Code Execution (RCE)

**漏洞编号:** CVE-2025-24813

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Apache Tomcat

**危害等级:** Critical

**CVSS评分:** 未提供，待补充

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98, 8.5.0 through 8.5.100 (EOL)

**利用条件:** Unauthenticated remote access, requires the partial PUT feature to be enabled.

**POC 可用性:** 7/10

**POC 类型:** Exploit

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2025-24813 is a critical unauthenticated remote code execution (RCE) vulnerability in Apache Tomcat related to the improper handling of partial PUT requests. The vulnerability arises from a flaw in how Tomcat processes PUT requests when the 'readonly' initialization parameter of the DefaultServlet is set to 'false' and the 'allowLinking' parameter is set to 'true'. This combination allows an attacker to upload arbitrary JSP files to the server, leading to remote code execution. The provided Python POC script, CVE-2025-24813-checker.py, attempts to verify the vulnerability by sending a PUT request to the target server with a JSP payload. It first checks if the server allows PUT requests. If PUT requests are allowed, it proceeds to check the Tomcat version by examining the 'Server' header in the HTTP response. If a vulnerable Tomcat version (e.g., 9.0.0.M1, 10.1.0-M1, 11.0.0-M1) is detected, the script reports that the server is vulnerable. The script uses the `requests` library to send HTTP requests and regular expressions to parse the Tomcat version from the server header. The script also includes basic error handling for network-related issues. The effectiveness of the POC depends on several factors: the target server must have the vulnerable configuration (i.e., DefaultServlet's 'readonly' parameter set to 'false' and 'allowLinking' set to 'true'), the Tomcat version must be within the vulnerable range, and the attacker must have network access to the target server. To exploit this vulnerability, an attacker would typically follow these steps: 1. Identify a target server running Apache Tomcat. 2. Determine if the server has the vulnerable configuration by sending a GET request and checking the server header. 3. If the configuration is vulnerable, send a PUT request with a malicious JSP payload to a known location on the server. 4. Access the uploaded JSP file via a web browser to execute the code on the server. 5. Establish a reverse shell or perform other malicious activities. The `verify=False` parameter is used in the requests to bypass SSL certificate verification. This can be risky, but necessary in environments with self-signed certificates. The inclusion of version check and PUT request verification are good security practices for the POC script. The risk of poisoning associated with the provided POC code is relatively low. The script primarily uses standard Python libraries such as `requests` and `re`, and its functionality is focused on vulnerability detection rather than exploitation. The script does not contain any obfuscated code or external dependencies that could introduce malicious behavior. However, there is a slight risk that the script could be modified to include malicious payloads or to exfiltrate sensitive information from the target server. Therefore, it is important to carefully review and sanitize the script before using it in a production environment. The script uses `verify=False` which could be modified to accept a custom CA, or automatically trust all CAs, which may lead to an MITM attack. The banner itself doesn't pose a security risk, but it can be used to identify the script and potentially target users with malicious versions. Also, error messages do not expose sensitive information. Overall, the poisoning risk is estimated to be around 15% due to the potential for modification, MITM via SSL, and the use of a banner that could attract malicious actors.

**项目地址:** https://github.com/vulnwatchdog/vulnwatchdog_cb3976630ebdef9d040eb75b7e1c77fb

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-24813
