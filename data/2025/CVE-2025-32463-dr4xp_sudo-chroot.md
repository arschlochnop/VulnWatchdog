## CVE-2025-32463 - sudo 本地权限提升 (Local Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** sudo

**危害等级:** 高 (High)

**CVSS评分:** 9.3 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** sudo >= 1.9.14 且 < 1.9.17p1

**利用条件:** 本地低权限用户访问，目标系统启用了sudo的--chroot (-R) 选项功能

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

【POC有效性分析】该POC代码通过Python脚本自动化实现了针对CVE-2025-32463的完整利用过程。漏洞的核心逻辑在于sudo在处理--chroot（或-R）参数时，未能正确隔离用户可控目录下的配置文件加载。POC首先在/tmp目录下创建一个随机的临时工作目录，并生成一个名为woot1337.c的C语言源文件。该源码利用__attribute__((constructor))特性定义了一个在库加载时自动执行的函数，其功能是调用setreuid(0,0)和setregid(0,0)将当前进程的有效UID/GID提升至root，并执行/bin/bash。随后，POC创建了模拟的文件系统结构（woot/etc），并伪造了nsswitch.conf文件。关键点在于，当sudo在执行chroot操作时，它会尝试解析该目录下的nsswitch.conf，POC将其配置为通过自定义的动态库（libnss_/woot1337.so.2）处理passwd查询。脚本通过gcc将其编译为共享库，最后执行'sudo -R woot woot'命令。由于sudo在进入chroot环境后仍保持部分高权限上下文并加载了用户伪造的NSS模块，从而导致攻击者定义的恶意代码以root权限执行。经分析，该POC逻辑严密，路径处理正确，直接针对漏洞触发点，在受影响版本的Linux系统上具有极高的成功率。【利用步骤】1. 攻击者以普通用户身份登录系统。2. 将exploit.py脚本放置在具有写权限的目录下（如/tmp）。3. 确保系统安装了gcc编译器。4. 执行python3 exploit.py。5. 脚本将自动：(a) 创建临时环境；(b) 编写提升权限的劫持源码；(c) 构造虚假的etc/nsswitch.conf；(d) 编译恶意共享库；(e) 调用sudo -R触发漏洞。6. 成功后将获得一个root权限的bash shell。【投毒风险分析】该POC代码具有极低的投毒风险。首先，代码完全开源且逻辑清晰，使用了Python的标准库（os, subprocess, shutil, tempfile），未引入任何第三方混淆库或加密模块。其次，代码中所有的操作均在本地临时目录中进行，且在利用结束后通过shutil.rmtree(temp_dir)清理了生成的临时文件，表现出良好的自清理行为。脚本中没有发现任何网络通信代码（如requests或socket），不存在将敏感数据外传或下载远程恶意负载的风险。代码中的核心提权逻辑（setreuid/execl）是典型的权限提升验证手段，不属于隐蔽后门。唯一的外部调用是gcc编译器和sudo系统命令，均属于标准的系统维护工具。开发者未对代码进行任何形式的混淆，每一行功能都直接对应漏洞的PoC验证需求。因此，该脚本被判定为纯粹的技术研究与防御验证工具，而非投毒载体。

**项目地址:** [https://github.com/user-attachments/assets/666442e5-7ae5-485d-9dff-2667aa8efb7e](https://www.google.com/search?q=https://github.com/user-attachments/assets/666442e5-7ae5-485d-9dff-2667aa8efb7e)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
