## CVE-2025-32463 - Sudo 本地提权 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (LPE)

**影响应用:** Sudo

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 1.9.14 至 1.9.17p1 之前版本

**利用条件:** 本地普通用户权限，系统安装有受影响版本的sudo并启用了chroot支持

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：该POC代码针对CVE-2025-32463漏洞提供了完整且高效的利用逻辑。漏洞的核心在于sudo在处理'--chroot'选项（或相关的-R选项）时，存在错误的逻辑顺序。它在进入chroot环境之前未充分校验环境的安全性，导致系统会从用户控制的chroot目录中加载/etc/nsswitch.conf文件。POC利用此特性，首先创建了一个临时工作目录，并在其中构造了一个伪造的root环境。该环境包含一个恶意的nsswitch.conf，该配置文件指示系统在查询用户数据库时加载名为'woot1337'的库。POC接着通过C语言编写并编译了一个共享对象文件（.so），利用__attribute__((constructor))构造函数确保在库加载时立即执行提权代码。提权代码调用setreuid(0,0)和setregid(0,0)来获取root身份，并生成一个bash shell。由于sudo -R（即--chroot）命令是以root权限运行的，当它在新的chroot环境中尝试解析用户信息时，会以root权限加载攻击者提供的so库，从而实现完美的本地权限提升。经分析，该POC结构清晰，利用链完整，在满足版本条件的Linux系统上具有极高的成功率。利用步骤：1. 在/tmp目录下创建一个随机名称的临时目录作为伪造的根环境。2. 编写恶意C代码，其中包含获取root shell的逻辑。3. 在临时目录中创建etc子目录，并写入伪造的nsswitch.conf文件，将其配置为指向恶意的NSS库。4. 使用gcc将C代码编译为共享对象文件，并放置在libnss_目录下，命名符合NSS加载规范。5. 执行'sudo -R woot woot'命令，触发sudo进入chroot环境并加载恶意库。6. 成功获取root shell后，POC会自动清理临时目录。投毒风险分析：该POC的投毒风险极低，被评定为10%。通过对exploit.py脚本的深度静态分析，其所有行为均透明且符合合法的安全研究范畴。脚本仅依赖Python标准库（os, subprocess, shutil, tempfile），未发现任何base64加密、混淆代码或可疑的远程网络请求（如尝试从外部服务器下载Payload）。恶意C代码部分逻辑简单明确，仅限于本地提权操作（setreuid, execl），不包含任何凭据窃取、持久化后门植入或对系统关键文件的非授权破坏。脚本末尾包含清理逻辑，能够删除测试过程中产生的临时文件，表现出良好的合规性。唯一的风险点在于攻击者可能通过修改编译参数或在C代码中隐藏额外的系统调用来实现恶意目的，但在当前的开源代码版本中，其行为是安全的。对于防御方而言，可以安全地在隔离测试环境中使用此脚本进行漏洞复现和防御验证，而无需担心其本身携带恶意木马。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-32463](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-32463)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
