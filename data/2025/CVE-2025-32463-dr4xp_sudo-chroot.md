## CVE-2025-32463 - Sudo 本地提权 (Local Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (Local Privilege Escalation)

**影响应用:** Sudo

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 1.9.14 <= Sudo < 1.9.17p1

**利用条件:** 攻击者需拥有本地低权限用户访问权限，且系统中安装了受影响版本的Sudo组件，Sudo需支持-R或--chroot选项。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

【POC有效性分析】该POC代码是一个高度精简且有效的本地提权漏洞利用脚本。其核心逻辑在于利用Sudo在处理--chroot选项时的一个设计缺陷：Sudo在进入chroot环境前，会错误地加载用户可控目录下的/etc/nsswitch.conf文件。脚本首先创建一个临时工作目录，并构造了一个虚假的chroot环境。在该环境中，脚本写入了一个伪造的nsswitch.conf，将passwd数据库查询指向一个自定义的库。紧接着，脚本使用C语言编写了一个共享对象（.so），利用__attribute__((constructor))特性，在库被加载时立即执行提权代码。提权代码调用setreuid(0,0)和setregid(0,0)来获取root权限，并启动一个交互式的/bin/bash。最后，脚本通过gcc编译该库，并放置在LD_LIBRARY_PATH或Sudo解析nss查找路径时能触及的位置（libnss_目录下）。执行'sudo -R woot woot'时，Sudo会以root权限加载攻击者控制的恶意库，从而完成从普通用户到root用户的提升。此POC逻辑严密，直接针对漏洞原理，不依赖复杂的堆溢出或竞态条件，在受影响的1.9.14至1.9.17p1版本上具有极高的成功率。【利用步骤】1. 创建受控的chroot镜像目录结构（如woot/etc）。2. 编写恶意C源码，定义构造函数执行setreuid(0,0)并运行shell。3. 将恶意源码编译为共享库，命名为nss插件格式（如libnss_woot1337.so.2）。4. 在镜像目录的etc下创建nsswitch.conf，配置其使用恶意插件。5. 执行sudo命令，使用-R或--chroot参数指向该镜像目录，触发恶意库加载。【投毒风险分析】经过对提供的Python脚本和C代码片段的审查，该POC的投毒风险极低（约10%）。脚本逻辑透明，使用了标准的Python库如os、subprocess和shutil，没有发现任何网络外连行为或敏感信息窃取逻辑。代码中的所有操作均限于/tmp目录下的临时文件夹内，且在执行结束后会通过shutil.rmtree进行清理，表现出良好的合规性。脚本的核心动作——获取root shell——是安全研究中典型的POC验证行为，而非恶意破坏。尽管脚本中使用了gcc编译及动态库注入技术，这属于漏洞利用的必要环节，而非混淆手段。唯一的风险点在于攻击者可能通过修改compile_code或run_e中的参数来执行其他指令，但就当前代码而言，它是一个纯粹的、用于防御性研究的功能性PoC。该代码没有经过任何混淆处理，所有变量命名直观（如temp_dir, code, compile_code），易于审计，符合安全研究社区的发布规范。

**项目地址:** [https://www.freebuf.com/articles/vuls/437488.html](https://www.freebuf.com/articles/vuls/437488.html)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
