## CVE-2025-49844 - Redis 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-49844

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Redis

**危害等级:** 关键 (Critical)

**CVSS评分:** 10.0

**影响版本:** Redis 版本 8.2.1 及以下所有版本

**利用条件:** 需要经过身份验证的远程攻击者权限（低权限用户即可），且目标实例启用了Lua脚本功能

**POC 可用性:** 7/10

**POC 类型:** 概念验证/扫描器

**攻击复杂度:** 中

**投毒风险:** 25%

## 详情

POC有效性分析：提供的POC代码主要是一个使用Go语言编写的扫描工具（rscan），用于检测Redis实例是否受CVE-2025-49844漏洞影响。该工具通过验证Redis版本号以及尝试执行特定的Lua脚本指令来判断目标是否存在Use-After-Free（UAF）风险。从防御性研究角度看，该POC的扫描逻辑相对清晰，它并未直接实现复杂的RCE利用链（如ROP链构造），而是侧重于漏洞探测。其README文档详细说明了编译和使用方法，并提供了针对性的加固建议。此漏洞的根源在于Redis Lua引擎在处理内存分配时存在逻辑缺陷，当脚本触发特定的内存管理流程时，已释放的内存块可能被重新引用。利用该漏洞需要攻击者具备执行EVAL或EVALSHA命令的权限，虽然这属于‘授权攻击’，但在许多云服务环境或共享Redis集群中，获取低权限凭据并不困难，因此该POC具有极高的实战验证价值。利用步骤：首先，攻击者需要获取Redis服务器的访问凭据（如果有）；其次，通过redis-cli或自动化工具连接到目标；然后，发送精心构造的Lua脚本（通过EVAL命令），该脚本旨在触发Lua堆栈中的UAF条件，使内存指针指向攻击者控制的数据区域；最后，通过覆盖函数指针或跳转指令，实现任意代码执行。投毒风险分析：该POC代码库表现出较低的投毒风险。代码采用Go语言标准库编写，没有发现明显的恶意代码混淆、非法外部URL请求或隐藏的二进制后门。其提供的README包含清晰的免责声明和修复方案，符合安全研究工具的特征。然而，作为一种针对高危漏洞的检测工具，仍需警惕恶意第三方通过‘二次打包’的方式在编译好的二进制文件中植入木马。虽然本源码本身安全，但其利用方式涉及到对敏感内存区域的操作，如果攻击者将此扫描器修改为自动静默提权工具并传播，则会构成威胁。对于防御者而言，在运行此类公开POC前，应在隔离环境审计go.mod依赖项及核心扫描逻辑，防止供应链投毒攻击。综合评估，该POC是合法的安全检测工具，风险受控。

**项目地址:** n/a

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)
