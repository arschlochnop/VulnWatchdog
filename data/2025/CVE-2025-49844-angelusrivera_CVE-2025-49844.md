## CVE-2025-49844 - Redis RCE (Remote Code Execution) / Use-After-Free

**漏洞编号:** CVE-2025-49844

**漏洞类型:** RCE (Remote Code Execution) / Use-After-Free

**影响应用:** Redis

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** Redis 6.x, 7.x, 8.x 版本，具体修复版本为 8.2.2 之前的版本 (8.2.1 及更早版本受影响)

**利用条件:** 需要远程网络访问，且攻击者需要拥有低权限（具有执行 Lua 脚本的权限，如 EVAL 或 EVALSHA 命令的使用权）的身份验证凭据。

**POC 可用性:** 4/10

**POC 类型:** 概念验证/扫描工具

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：提供的POC代码实际上是一个使用Go语言编写的漏洞扫描器（rscan），而非完整的漏洞利用程序（Exploit）。该工具的主要逻辑在于检测目标Redis实例的版本信息以及Lua脚本执行权限（ACL）的配置情况。它通过尝试连接目标主机并执行基本的Redis指令来判断其安全性。该POC对于安全研究员识别受影响资产具有参考价值，但并未包含触发Use-After-Free（UAF）的具体Lua payload。漏洞利用的核心在于利用Redis Lua引擎在处理特定内存管理逻辑时的缺陷，通过精心构造的Lua脚本使引擎访问已释放的内存块，从而劫持程序流。利用步骤：1. 侦察阶段：识别目标网络中开放的6379端口及Redis服务。2. 身份认证：获取具备执行脚本权限的用户凭据。3. 触发漏洞：构造包含特定逻辑的Lua脚本（利用UAF漏洞），通过EVAL命令提交给Redis。4. 提权执行：在Lua沙箱之外实现任意代码执行。投毒风险分析：该POC文件虽然包含了较为清晰的项目结构（如Go mod文件和README），但其代码片段表现出了一些非正式的安全研究特征。投毒风险主要体现在：第一，README中使用了带有煽动性的语言（如'RediShell'这种自定义名称）和非专业的表达方式，这常见于恶意攻击者发布的‘一键利用工具’。第二，代码中可能存在虚假的检测逻辑。虽然目前看到的只是扫描器的骨架，但在实际分发的二进制版本中，攻击者可能会植入后门代码，将扫描到的受害主机信息、认证凭据回传至攻击者控制的C2服务器。第三，由于漏洞级别极高（CVSS 10.0），此类工具极易被修改并夹带恶意脚本发布在非官方渠道，误导初级安全人员在自己的生产环境运行，从而导致凭据泄露。建议防御者在审计代码前，仅在隔离的沙箱环境中使用此类Go源码编译生成的工具，严禁运行未经验证的预编译二进制文件。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-49844](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-49844) (基于描述推测)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)
