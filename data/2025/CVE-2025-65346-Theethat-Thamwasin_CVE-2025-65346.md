## CVE-2025-65346 - laravel-file-manager 任意文件写入

**漏洞编号:** CVE-2025-65346

**漏洞类型:** 任意文件写入

**影响应用:** laravel-file-manager

**危害等级:** 高危

**CVSS评分:** 待定

**影响版本:** <= 3.3.1

**利用条件:** 需要认证

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

CVE-2025-65346 存在于 laravel-file-manager <= 3.3.1 版本中，是一个经过身份验证的目录遍历漏洞，可导致任意文件写入。攻击者可以通过文件管理界面使用 unzip 功能将 zip 文件中的文件放入预期范围之外的目录中，原因是路径验证不当，如果文件名相同，还会覆盖文件。 

POC的有效性分析：该POC提供了一个分步的利用过程，包括安装和配置 Laravel File Manager，上传恶意文件并将其压缩，然后利用路径遍历漏洞通过unzip功能将文件写入到目标目录。POC中提供了清晰的截图，展示了每个步骤的操作过程，以及成功利用漏洞后的结果。通过修改zip文件的目标路径，可以写入任意文件，从而导致远程代码执行。

利用步骤：
1. 安装和配置 Laravel File Manager。
2. 创建或上传包含恶意代码（例如 PHP shell）的文件。
3. 将该文件压缩成 zip 文件。
4. 在文件管理界面中，选择上传的 zip 文件并进行解压。
5. 拦截解压请求，修改目标路径，利用路径遍历漏洞将文件写入到 Web 根目录或其他可写目录。
6. 访问写入的文件，执行恶意代码。

投毒风险分析：
该POC的投毒风险较低。主要风险在于攻击者可能会在上传的zip文件中包含恶意代码，例如webshell。但是，POC本身提供的利用方法是清晰的，没有发现明显的混淆或恶意行为。由于该漏洞需要身份验证，并且需要用户交互来上传和解压zip文件，因此可以降低利用的风险。此外，通过对上传的zip文件进行安全扫描，可以检测潜在的恶意代码。总体而言，该POC的投毒风险较低，但需要注意上传文件的安全性。

**项目地址:** https://github.com/ThumpBo/CVE-2025-30208-EXP

**漏洞详情:** 待定
