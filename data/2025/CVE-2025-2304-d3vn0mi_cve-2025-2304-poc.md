## CVE-2025-2304 - Camaleon CMS 特权升级, Mass Assignment

**漏洞编号:** CVE-2025-2304

**漏洞类型:** 特权升级, Mass Assignment

**影响应用:** Camaleon CMS

**危害等级:** Critical

**CVSS评分:** 9.4

**影响版本:** 低于 2.9.1 版本 (less than 2.9.1)

**利用条件:** 需要认证，需要网络访问

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

该PoC针对CVE-2025-2304，一个存在于Camaleon CMS中的关键Mass Assignment漏洞，旨在实现低权限用户到管理员的特权升级。从提供的README文件来看，该PoC具有高度的有效性和专业性。它清晰地指出了漏洞的根源在于Rails框架中`UsersController`的`updated_ajax`方法不当使用了`params.require(:user).permit!`，导致所有用户提供的参数未经任何过滤就被接受。这种设计缺陷使得攻击者能够通过注入未授权的参数（如`user[role]=admin`）来修改用户角色。PoC的特性，例如“Safe Testing”（安全测试）、“Multiple Payloads”（多种攻击载荷）、“Version Detection”（版本检测）和“Non-Destructive Option”（无损选项），都表明它是一个经过精心设计和充分测试的工具。它不仅能够准确识别受影响的CMS版本，还能以多种技术实现攻击，并且强调在测试过程中保护用户密码，进一步提升了其可靠性和作为防御性安全研究工具的价值。CVSS 9.4的评级也印证了该漏洞的严重性，即便是拥有基本编程知识和网络安全理解的用户，也能通过此PoC快速验证并利用该漏洞。

**利用步骤:**
利用CVE-2025-2304的特权升级漏洞涉及以下关键步骤：
1.  **获取低权限认证凭证**: 攻击者首先需要获取Camaleon CMS中任意一个低权限用户（例如，“client”角色）的有效登录凭证。这可以通过各种方式实现，例如社会工程、凭证填充攻击或利用其他较低级别的漏洞。
2.  **识别目标和用户ID**: 登录系统后，攻击者需要确定目标Camaleon CMS实例的URL，并识别希望提升权限的目标用户ID（通常是攻击者自己或其他低权限用户）。
3.  **分析API请求**: 攻击者需要使用浏览器开发者工具或HTTP代理（如Burp Suite）捕获并分析用户修改个人资料或密码时发送的HTTP POST请求。特别是关注`/admin/users/{id}/updated_ajax`端点及其参数结构。
4.  **构造恶意Payload**: 在捕获到的请求基础上，攻击者将构造一个恶意的POST请求体。除了正常的字段（如密码更新字段，如果需要）外，攻击者会注入额外的参数，例如`user[role]=admin`。这个参数利用了`permit!`方法的缺陷，指示系统将用户的角色更新为“管理员”。
5.  **发送恶意请求**: 使用修改后的请求体，通过HTTP客户端（如Python脚本、Postman或curl）将恶意POST请求发送到Camaleon CMS服务器。确保请求中包含有效的会话Cookie或其他认证令牌。
6.  **验证特权升级**: 请求成功后，攻击者尝试以升级后的用户身份登录或访问管理员专属功能和界面。如果能够成功访问，则表明特权升级成功。同时，也可以检查数据库中对应用户的角色字段是否已变为“admin”。

**投毒风险分析:**
对该PoC的投毒风险评估为低，约为10%。主要基于以下几点：
1.  **高度透明和文档完善**: PoC的README文件提供了详尽的漏洞描述、攻击原理、利用步骤和工具功能，没有任何模糊或隐藏的信息。这种透明度是合法安全研究工具的标志，有助于用户理解其工作方式。
2.  **专注于安全测试功能**: PoC明确列出了“安全测试”、“无损选项”和“保护用户密码”等特性，这些都表明其设计目标是安全验证而非恶意破坏。例如，`--no-password-field` 选项允许用户在不修改密码的情况下测试漏洞，大大降低了意外损失的风险。
3.  **无明显恶意行为指标**: 在提供的PoC信息中，没有发现任何代码混淆、植入后门、与未知外部C2服务器通信、下载恶意载荷或执行其他可疑系统操作的迹象。其代码片段直接指向Rails框架的已知缺陷，而非引入新的恶意逻辑。
4.  **许可协议**: PoC标明了MIT许可证，这通常与开源项目和社区共享精神相关联，进一步增强了其可信度。开源社区的审查机制也使得恶意代码难以长时间隐藏。
5.  **目标明确，范围受限**: PoC专注于利用Camaleon CMS的特定缺陷，目标明确且范围受限。它不是一个通用漏洞利用框架，也不包含能够滥用系统资源的广泛功能。
6.  **总结**: 尽管任何PoC代码都可能被恶意分子修改和滥用，但就其原始形式而言，此PoC被认为是合法的安全研究工具，其设计原则和公开信息均指向低投毒风险。组织在使用此类工具进行内部安全评估时，仍应遵循严格的代码审查流程和沙箱环境，以防范任何潜在的外部篡改风险，但PoC本身并不构成直接的“投毒”威胁。

**项目地址:** None

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-2304
