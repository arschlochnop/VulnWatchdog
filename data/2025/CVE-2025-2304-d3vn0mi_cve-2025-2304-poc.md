## CVE-2025-2304 - Camaleon CMS 特权升级 (Mass Assignment)

**漏洞编号:** CVE-2025-2304

**漏洞类型:** 特权升级 (Mass Assignment)

**影响应用:** Camaleon CMS

**危害等级:** 关键

**CVSS评分:** 9.4

**影响版本:** 低于 (不包括) 2.9.1

**利用条件:** 需要认证 (低权限用户), 需要网络访问

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

该PoC旨在验证CVE-2025-2304，一个存在于Camaleon CMS中的关键特权升级漏洞。漏洞根源在于 `UsersController` 的 `updated_ajax` 方法中不安全的 `params.require(:user).permit!` 使用。在Ruby on Rails应用中，`permit!` 方法会绕过强参数过滤，导致"大批量赋值"漏洞 (Mass Assignment)，允许攻击者注入任意参数来修改用户对象属性。PoC的 `README.md` 详细描述了利用过程：一个已认证的低权限用户可以通过向 `/admin/users/{id}/updated_ajax` 端点发送特制的POST请求，并在请求体中注入 `user[role]=admin` 参数，从而将自身角色提升至管理员权限。由于 `permit!` 方法的缺陷，应用程序会无条件处理此注入，完成特权升级。PoC项目提供了多项增强功能，例如“安全测试”（在利用时不更改用户密码）、“多重Payloads”以测试不同的注入技术、“版本检测”功能可自动识别受影响的CMS版本，以及“非破坏性选项” (`--no-password-field` 标志) 来确保测试过程的安全性。这些特性表明该PoC不仅功能完善，而且设计严谨，能够有效、准确地复现并验证CVE-2025-2304漏洞。PoC的详细说明和功能列表也增强了其作为可靠安全研究工具的地位，充分证明了其有效性。

**利用步骤：**
1.  攻击者首先需要获得Camaleon CMS的低权限用户凭证并成功认证。
2.  然后，攻击者向 `/admin/users/{id}/updated_ajax` 端点发送一个特制的POST请求。
3.  在这个请求中，除了合法的用户更新参数（例如密码修改字段）外，攻击者会注入一个额外参数，如 `user[role]=admin`。
4.  由于 `updated_ajax` 方法使用了不安全的 `permit!`，它会无差别地接受并处理所有提交的参数，包括注入的 `role=admin`。
5.  系统因此将当前用户的角色更新为管理员，从而实现特权升级。
6.  PoC工具自动化了这一过程，提供了多种注入技术，甚至可以进行版本检测和非破坏性测试。

**投毒风险分析：**
对该PoC项目（基于其 `README.md` 内容）的分析显示，其投毒风险极低。该 `README.md` 内容清晰，明确指出这是一个旨在演示CVE-2025-2304漏洞的PoC。它强调了“安全测试”、“非破坏性选项”等特性，表明作者旨在提供一个负责任的、用于安全研究和验证的工具。项目中未提及使用代码混淆、加载外部恶意脚本或执行异常的文件/网络操作（除了针对目标CMS的合法请求）。项目使用Python语言，并遵循MIT开源许可证，这些都与恶意软件的典型特征不符。虽然任何执行第三方代码都存在固有风险，建议用户在隔离环境中运行并审计源代码，但根据已披露信息，该PoC似乎完全专注于漏洞的合法复现，不包含恶意载荷或行为。其设计目标是帮助组织理解并防御漏洞。因此，其投毒风险评估为非常低。

**项目地址:** https://github.com/d3vn0mi/cve-2025-2304-poc

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-2304
