## CVE-2025-2304 - Camaleon CMS 权限提升 (Mass Assignment)

**漏洞编号:** CVE-2025-2304

**漏洞类型:** 权限提升 (Mass Assignment)

**影响应用:** Camaleon CMS

**危害等级:** 关键 (Critical)

**CVSS评分:** 9.4 (Critical)

**影响版本:** < 2.9.1

**利用条件:** 需要认证 (低权限用户), 网络访问

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-2304 是一款存在于Camaleon CMS中的关键性权限提升漏洞，其根源在于一个严重的Mass Assignment（批量赋值）缺陷。该漏洞具体发生在`UsersController`的`updated_ajax`方法中，由于代码不当使用了Ruby on Rails框架中危险的`permit!`方法，导致应用程序在处理用户提交的参数时，未能对所有参数进行有效过滤和验证，从而允许恶意用户注入未经授权的参数。

**POC有效性分析:**
所提供的概念验证（PoC）代码具有高度的有效性，它直接针对Camaleon CMS中的这一批量赋值漏洞，并能成功实现低权限用户到管理员角色的权限提升。PoC的README文档清晰地阐述了漏洞的原理、攻击向量以及利用机制，并强调了PoC能够演示“认证用户如何通过低权限提升至管理员角色”。该PoC不仅提供了核心的利用逻辑，还包含了多项增强功能，例如“安全测试（Safe Testing）”模式，能够确保在执行过程中尽量不影响目标系统的正常运行；“多种Payload（Multiple Payloads）”选项，可以测试不同的注入技术以提高成功率；“版本检测（Version Detection）”功能，帮助用户识别目标CMS是否处于易受攻击的版本范围；以及“无密码字段（Non-Destructive Option）”标记，可以在不修改用户密码的情况下进行测试，进一步验证了PoC的健壮性和实战可用性。PoC对漏洞根源（`params.require(:user).permit!`）的精准定位以及对攻击向量的详细描述，都强有力地证明了其复现和利用该漏洞的能力。这个PoC的质量评分为9分（满分10分），因为它功能完整、文档齐全，并提供了多种实用功能以确保测试的有效性和安全性。

**利用步骤:**
1.  **认证身份**: 攻击者首先需要获取一个Camaleon CMS的低权限用户账号并成功登录系统。例如，一个“client”角色用户。
2.  **识别目标用户ID**: 攻击者需要确定其自身的用户ID，因为攻击是针对当前已认证用户的角色进行修改。
3.  **构造恶意请求**: 攻击者需要构造一个特定的POST请求，发送至`/admin/users/{id}/updated_ajax`端点。这个请求中除了包含合法的用户参数（例如修改密码的字段）外，还需要巧妙地注入一个额外的参数：`user[role]=admin`。
4.  **执行请求**: 发送构造好的POST请求到服务器。由于`updated_ajax`方法中使用了`params.require(:user).permit!`，它会无差别地接受所有用户提交的参数，包括被注入的`user[role]=admin`。
5.  **权限提升成功**: 服务器在处理该请求时，会将当前已认证用户的角色更新为“admin”，从而完成权限提升，使低权限用户获得管理员权限。

**投毒风险分析:**
根据所提供的PoC的`README.md`内容，其投毒风险被评估为低（约为10%）。这份文档表现出高度的专业性和透明度，详细解释了漏洞、利用方法、工具特性以及缓解措施。在已提供的信息中，没有发现任何代码混淆、可疑的外部脚本引用、恶意文件下载或执行、以及与预期功能无关的网络请求等高风险特征。PoC强调了“安全测试”和“无损选项”，这表明其设计目标是为了合法安全研究和测试，而非恶意利用。通常，高质量的PoC项目会遵循负责任的披露原则，提供清晰的代码和使用说明。然而，任何从非官方或非信任来源获取的PoC代码都存在潜在的投毒风险。即使README文件看起来无害，实际的Python脚本仍可能包含恶意代码。因此，尽管基于当前信息风险较低，防御性安全研究人员在实际执行任何PoC代码之前，仍应遵循严格的安全实践，包括在隔离环境中运行、对代码进行深入审查（静态分析和动态分析），并监控其网络行为，以确保没有隐藏的恶意功能或后门。此PoC的公开可用于帮助攻击者，也用于帮助防御者理解和复现漏洞，以便及时修补系统。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-2304
