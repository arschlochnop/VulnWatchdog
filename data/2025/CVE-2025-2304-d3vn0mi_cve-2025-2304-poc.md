## CVE-2025-2304 - Camaleon CMS Mass Assignment (特权升级)

**漏洞编号:** CVE-2025-2304

**漏洞类型:** Mass Assignment (特权升级)

**影响应用:** Camaleon CMS

**危害等级:** Critical

**CVSS评分:** 9.4

**影响版本:** All versions < 2.9.1

**利用条件:** 需要认证 (low-privileged user), 需要网络访问 (send crafted POST request)

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

CVE-2025-2304 指的是 Camaleon CMS 中的一个关键特权升级漏洞，具体表现为“Mass Assignment”缺陷。该漏洞存在于 `UsersController` 的 `updated_ajax` 方法中。根本原因在于不当使用了 Ruby on Rails 框架中的 `permit!` 方法，此方法允许所有用户提供的参数绕过标准过滤和验证机制，导致攻击者能够直接注入并修改用户对象的未经授权的属性。

**POC有效性分析：**
该 PoC (Proof of Concept) 用于 CVE-2025-2304，根据其详细的 `README.md` 文档，是一个功能强大、文档齐全且设计用于高效利用和安全测试的工具。它旨在演示 Camaleon CMS 中从低权限用户到管理员的特权升级。PoC 精确地识别了漏洞的根本原因，即 `updated_ajax` 方法中 `params.require(:user).permit!` 导致的 Mass Assignment 缺陷。它明确描述了攻击向量：一个经过身份验证的低权限用户向 `/admin/users/{id}/updated_ajax` 发送精心构造的 POST 请求，并注入 `user[role]=admin` 参数以提升权限。该 PoC 的质量通过其丰富的功能集进一步凸显，包括“安全测试”选项（例如，在利用过程中保留用户密码，并提供 `--no-password-field` 标志以实现最安全的测试）、支持多种注入技术（超过 7 种不同的Payload）、自动检测易受攻击的 CMS 版本，以及代理支持。这些功能表明该 PoC 经过深思熟虑的设计，不仅能有效地验证漏洞，还能以负责任和灵活的方式进行。其 CVSS 评分 9.4（关键）与特权升级的严重性相符。作为基于 Python 3.7+ 的 MIT 许可 PoC，它易于审查和集成，进一步增强了其有效性和可信度。总体而言，该 PoC 是一个高度有效且可靠的工具，用于验证 CVE-2025-2304 的存在和可利用性。

**利用步骤：**
CVE-2025-2304 的利用过程相对直接，利用了 Mass Assignment 漏洞。主要步骤如下：
1.  **身份验证：** 攻击者首先必须作为低权限用户（例如，“客户端”角色）获得 Camaleon CMS 的认证访问权限。
2.  **识别目标用户ID：** 攻击者需要确定其自身账户在 CMS 中的用户 ID (`{id}`)，通常可以通过用户配置文件 URL 或简单枚举发现。
3.  **构造恶意请求：** 攻击的核心是向易受攻击的端点 `/admin/users/{id}/updated_ajax` 发送一个特制的 HTTP POST 请求。
4.  **注入角色参数：** 在 POST 请求正文中，攻击者注入一个未经授权的参数 `user[role]=admin`，同时包含其他合法的用户更新参数（例如，密码更改参数，尽管 PoC 提到了非破坏性选项）。由于 `permit!` 方法的作用，应用程序将处理此 `role` 参数并更新数据库中的用户角色。
5.  **特权升级：** 成功执行构造的请求后，低权限用户账户的角色将更新为“管理员”。攻击者随后可以注销并重新登录，或者有时立即获得管理员权限，从而完全控制 CMS。

**投毒风险分析：**
针对 CVE-2025-2304 的 PoC 的投毒风险被评估为极低（10%）。这一评估基于以下几个关键因素：
首先，该 PoC 的 `README.md` 文档极其清晰和透明，明确阐述了其目的：演示通过 Mass Assignment 实现的特权升级。文档中详细说明了漏洞、攻击向量，并特别强调了为“安全测试”和“非破坏性选项”（`--no-password-field`）而设计的功能。这种高度的透明度大大降低了代码中隐藏恶意意图的可能性。
其次，该项目在 MIT 许可下发布。MIT 等开源许可鼓励社区审查和共享，这使得 PoC 作者在其中隐藏恶意负载面临更高的风险。尽管许可本身不能完全阻止恶意行为，但它表明了一种开放和可审计的代码共享意图。
再者，PoC 是用 Python 编写的。Python 是一种高级解释型语言，相比编译后的二进制文件或高度混淆的脚本，其代码通常更容易阅读和审计。潜在的恶意负载，如反向 Shell、数据窃取或加密挖矿程序，通过常规的代码审查通常是可识别的。
此外，从提供的 PoC 片段来看，没有迹象表明存在代码混淆、加密字符串或依赖于不可信来源的未知外部二进制文件或脚本。文档中提到的“代理支持”是合法的安全工具功能，而非恶意行为的迹象。PoC 的核心功能——“多 Payload”和“版本检测”——都直接服务于有效演示和利用 Mass Assignment 漏洞的目标，而不是用于可能隐藏恶意组件的无关活动。其明确的目标是更改 `user[role]` 参数，这与其声称要利用的漏洞完全一致，而不是作为 PoC 固有恶意性的一部分来安装后门或泄露数据。
综上所述，鉴于其专业的文档、明确的安全测试功能、MIT 许可和透明的 Python 语言，此 PoC 的投毒风险被评定为非常低。它似乎是一个合法的安全研究工具。然而，与任何第三方代码一样，在任何受控环境中执行之前，始终建议对完整的代码库（如果可用）进行彻底的静态和动态分析，以确认这些初步发现并确保没有引入任何意外的恶意组件。

**项目地址:** None

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-2304
