## CVE-2025-2304 - Camaleon CMS 权限升级 (Mass Assignment)

**漏洞编号:** CVE-2025-2304

**漏洞类型:** 权限升级 (Mass Assignment)

**影响应用:** Camaleon CMS

**危害等级:** 关键 (Critical)

**CVSS评分:** 9.4

**影响版本:** < 2.9.1

**利用条件:** 需要认证 (低权限用户), 需要网络访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

此PoC针对Camaleon CMS中的CVE-2025-2304权限升级漏洞，该漏洞是由于其`UsersController`中的`updated_ajax`方法不当使用了Rails的`permit!`方法导致的“Mass Assignment”问题。`permit!`方法允许所有用户提供的参数通过，而没有进行任何过滤。该PoC旨在演示一个已认证的低权限用户如何通过注入`user[role]=admin`参数，在执行密码更改等用户更新操作时，将其角色提升为管理员。PoC的`README.md`文件详细说明了漏洞原理、攻击向量以及实现方式。它还强调了“安全测试”、“多种利用载荷”、“版本检测”和“非破坏性选项”等功能，表明这是一个经过精心设计且功能完整的漏洞利用工具。Python语言的标签也暗示了其脚本实现。从描述来看，该PoC具有高度的有效性，能够准确复现并利用Camaleon CMS的这一关键漏洞。

**利用步骤:**
攻击者首先需要获取Camaleon CMS的有效低权限用户凭据并成功登录。一旦获得认证会话，攻击者便可以构造一个特制的HTTP POST请求。该请求的目标URL为`/admin/users/{id}/updated_ajax`，其中`{id}`是当前登录用户的ID。在POST请求的请求体中，除了包含合法的用户数据（例如用户尝试更改的新密码字段）之外，攻击者还会恶意注入`user[role]=admin`参数。由于目标CMS中`updated_ajax`方法对`permit!`的危险使用，系统会不加验证地处理所有传入参数，从而将当前用户的角色从低权限（如“client”）更新为“admin”。一旦角色被成功更新，攻击者将获得CMS的全部管理员权限，从而实现完全控制。

**投毒风险分析:**
根据所提供的PoC的`README.md`文件内容，该PoC的投毒风险评估为**低风险（10%）**。分析如下：
1.  **代码透明度高**: `README.md`对漏洞的背景、原理、攻击方法、PoC的特性和使用都进行了详尽且清晰的说明。这种透明度是良性安全研究工具的典型特征，没有发现任何代码混淆或意图隐藏恶意行为的迹象。
2.  **强调安全和非破坏性**: PoC的特性列表中明确提到了“安全测试”（Safe Testing）和“非破坏性选项”（Non-Destructive Option，如`--no-password-field`），这些都表明PoC的开发者致力于提供一个安全、可控的漏洞验证工具，而非进行恶意攻击。它甚至特意说明在利用过程中会保留用户密码，以避免对目标系统造成不必要的损害。
3.  **无外部依赖或可疑行为**: `README.md`中没有暗示PoC会下载、执行外部脚本、或连接到任何可疑的远程服务器。恶意PoC常通过这些方式植入后门、收集信息或进行其他未经授权的操作。
4.  **恶意负载明确且有限**: PoC的核心“恶意”部分是注入`user[role]=admin`参数以实现权限升级，这完全符合漏洞本身的利用逻辑，并没有超出描述范围的额外恶意负载。
5.  **专业且符合规范**: 整个文档内容结构清晰，专业术语使用规范，符合安全研究和漏洞披露的最佳实践。它提供了详细的安装和使用指导，以及漏洞缓解措施，进一步证实了其作为防御性安全工具的定位。
综上所述，该PoC的文档内容展现出高度的专业性和透明度，旨在用于漏洞研究和防御，而非用于分发恶意软件。因此，将其评定为低投毒风险。组织在复现和测试时，仍应在受控的隔离环境中进行，以确保安全。

**项目地址:** N/A

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-2304
