## CVE-2025-2304 - Camaleon CMS Privilege Escalation (Mass Assignment)

**漏洞编号:** CVE-2025-2304

**漏洞类型:** Privilege Escalation (Mass Assignment)

**影响应用:** Camaleon CMS

**危害等级:** Critical

**CVSS评分:** 9.4

**影响版本:** Less than 2.9.1

**利用条件:** Requires authentication as a low-privileged user; network access.

**POC 可用性:** 9

**POC 类型:** Complete Exploit

**攻击复杂度:** Low

**投毒风险:** 5%

## 详情

POC有效性分析：
提供的Proof of Concept (PoC) for CVE-2025-2304，如其README文件所详述，是一个高度有效且文档完善的利用工具，旨在利用Camaleon CMS中已识别的权限提升漏洞。该漏洞源于UsersController中`updated_ajax`方法内的关键的批量赋值（Mass Assignment）缺陷，具体是由于危险地使用了`params.require(:user).permit!`，它允许无过滤地接受用户提供的参数。该PoC明确强调了多项功能，例如“安全测试”、“多种Payload”（声称超过7种不同的注入技术）、针对易受攻击CMS实例的“版本检测”、通过`--no-password-field`标志实现“非破坏性选项”（以保留用户密码），以及“代理支持”。这些功能表明这是一个功能强大且多用途的工具，不仅用于演示漏洞，还以受控方式促进其评估。对根本原因（未过滤的参数接受）的清晰解释以及精确的攻击向量进一步增强了PoC的可信度及其在目标环境中成功利用的潜力。使用Python 3.7+也意味着一个现代且可维护的代码库。

利用步骤：
利用CVE-2025-2304涉及攻击者的一个直接的多步骤过程：
1.  **初始认证**：攻击者必须首先使用低权限用户凭据（例如，“客户端”角色账户）获得对Camaleon CMS实例的认证访问权限。
2.  **目标请求**：然后向易受攻击的端点：`/admin/users/{id}/updated_ajax`发送一个专门构造的HTTP POST请求。`{id}`占位符指的是当前已认证的低权限用户的ID，其角色将被提升。
3.  **参数注入**：在此POST请求的主体中，攻击者注入一个未经授权的`user[role]=admin`参数。此恶意参数通常与合法的用户更新字段（例如，用于更改密码的字段）结合使用。
4.  **角色提升**：由于`permit!`方法缺乏参数过滤，Camaleon CMS应用程序会无意中处理注入的`user[role]=admin`参数，从而将已认证用户的角色提升为管理员权限。

投毒风险分析：
根据提供的`README.md`内容，此PoC的投毒风险被评估为低，大约5%。该文档将其PoC定位为一个合法且符合道德规范的安全研究工具。主要指标包括明确提及“安全测试”、“非破坏性选项”以及对漏洞及其利用的清晰详细解释。这些特征与负责任的漏洞披露和测试实践相符，而非恶意意图。README中没有提供任何文本证据表明存在混淆代码、可疑的外部依赖项或除了所述权限提升之外的隐蔽恶意payload。该工具描述的功能完全专注于演示CVE-2025-2304。虽然无法获得实际的Python源代码进行深入的静态分析，但README中概述的高度细节和道德考量最大限度地减少了对此特定PoC被“投毒”以包含恶意软件或其他意外有害功能的直接担忧。然而，标准安全建议始终适用：组织应在隔离的受控环境中对任何PoC进行彻底的源代码审查和执行。

**项目地址:** Not explicitly provided in the input, the path `/tmp/vulnwatchdog_5f18ad3730112633ce18969318da7a4a/README.md` suggests a local copy.

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-2304
