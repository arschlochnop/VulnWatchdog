## CVE-2025-49144 - Notepad++ 特权提升

**漏洞编号:** CVE-2025-49144

**漏洞类型:** 特权提升

**影响应用:** Notepad++

**危害等级:** 高危

**CVSS评分:** 待定

**影响版本:** 8.8.1及之前版本

**利用条件:** 本地用户，利用不安全的可执行文件搜索路径

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 40%

## 详情

CVE-2025-49144是一个存在于Notepad++ v8.8.1及之前版本安装程序中的本地特权提升漏洞。该漏洞允许非特权用户通过不安全的可执行文件搜索路径获得SYSTEM级别的权限。根据Tenable的描述，未经授权的用户可以通过社工或者点击劫持诱骗用户将合法的安装程序和一个恶意的可执行文件下载到同一目录（通常是Downloads文件夹），从而利用该漏洞。 

POC有效性分析：
根据GitHub上的POC代码（TheTorjanCaptain/CVE-2025-49144_PoC），该漏洞利用了Windows在查找可执行文件时的默认行为。当用户双击运行Notepad++的安装程序时，如果攻击者在同一目录下放置了一个恶意的可执行文件，并且该文件的名称与安装程序尝试加载的某个DLL名称相同，那么该恶意DLL就会被优先加载，从而允许攻击者执行任意代码，并提升到SYSTEM权限。该PoC通过模拟这种情况，展示了如何利用该漏洞。根据README.md文件显示，该POC工具可以帮助安全研究人员测试和探索漏洞。下载并解压该工具后，按照说明，可以在Windows 10或更高版本上运行。该工具简化了安全评估，并提供了明确的步骤来配置和运行测试，并在应用程序窗口中报告任何发现。该POC的有效性较高，因为它提供了一个完整的利用链，可以直接在目标系统上进行测试。

利用步骤：
1. 攻击者需要诱骗用户下载Notepad++的安装程序和一个恶意的DLL文件到同一目录。
2. 用户双击运行Notepad++的安装程序。
3. 恶意DLL被加载，攻击者获得SYSTEM权限。

投毒风险分析：
该POC存在一定的投毒风险。虽然该POC本身的代码是公开的，但攻击者可以修改POC代码，使其在提升权限的同时执行恶意操作，例如安装后门、窃取敏感信息等。此外，攻击者还可以将该POC与其他漏洞利用代码结合起来，形成一个更加复杂的攻击链。下载链接指向 raw.githubusercontent.com，虽然是GitHub的官方域名，但是直接下载zip文件存在一定的风险，用户可能会下载到被篡改的恶意版本，需要验证文件的哈希值。由于PoC需要用户手动下载和运行，存在一定的社工风险，用户可能会因为缺乏安全意识而忽略潜在的威胁。该POC代码使用了相对简单的脚本，但如果攻击者对代码进行混淆或加密，可能会增加分析和检测的难度，从而提高投毒的成功率。总体而言，CVE-2025-49144的PoC投毒风险为中等，为40%。

**项目地址:** https://github.com/TheTorjanCaptain/CVE-2025-49144_PoC

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-49144
