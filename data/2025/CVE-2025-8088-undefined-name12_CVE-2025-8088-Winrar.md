## CVE-2025-8088 - WinRAR 路径遍历 (Path Traversal)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** 

**影响版本:** 低于 7.13 版本

**利用条件:** 需要用户解压恶意构造的RAR压缩包

**POC 可用性:** 10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

POC有效性分析: 提供的POC代码，名为“CVE-2025-8088 Explotación WinRAR”，是一个基于Python的GUI工具，专门设计用于利用WinRAR的路径遍历漏洞（CVE-2025-8088）。该工具通过结合利用Windows NTFS备用数据流（ADS）来隐藏恶意Payload，并直接操纵RAR5存档头以实现路径注入。其核心模块`exploit_core.py`的运作流程包括：首先定位`rar.exe`命令行工具；接着创建包含诱饵文件和隐藏在ADS流中的Payload的基础RAR存档；关键步骤是，它会对生成的RAR5存档头进行二进制修补，注入一个精心构造的路径遍历序列（例如`..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\Users\Administrator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\payload.exe`）。此方法能够绕过WinRAR的文件验证机制，强制将恶意文件释放到系统指定位置，例如Windows启动文件夹，从而在系统启动时实现持久化和任意代码执行。同时，它还会重新计算CRC校验和以确保存档的完整性。从其详细的实现方式和友好的GUI界面来看，这是一个功能完备且易于操作的漏洞利用工具生成器。

利用步骤: 攻击者首先需要安装Python 3.6+和WinRAR CLI工具，并安装POC所需的Python依赖（通过`pip install -r requirements.txt`）。随后，运行`python gui.py`启动GUI界面。在界面中，攻击者可以选择要作为恶意Payload的文件（例如`.exe`或`.bat`脚本），并可选择一个无害的诱饵文件，然后输入要生成的恶意RAR压缩包的名称。点击“Build”按钮后，工具将生成一个恶意的`.rar`压缩包。当受害者解压此恶意RAR文件时，利用WinRAR的路径遍历漏洞和NTFS备用数据流特性，恶意Payload将被释放到Windows启动文件夹（例如`C:\Users\Administrator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\`）中，从而在系统启动时自动执行，最终实现任意代码执行。

投毒风险分析: 对POC代码本身的分析显示，其投毒风险为低（10%）。该Python工具旨在作为一种合法的防御性安全研究或渗透测试工具，其目的是创建利用特定漏洞的恶意压缩文件。代码透明度高，未发现明显的代码混淆、加密或任何不透明的行为。它主要依赖Python标准库（如`os`、`shutil`、`subprocess`、`struct`、`zlib`、`pathlib`）以及系统上已安装的WinRAR CLI工具，并未引入任何可疑的第三方库或外部恶意脚本。该工具的核心功能是*生成*用于漏洞利用的恶意RAR压缩包，而非其自身包含或执行恶意代码，未发现进行C2通信、数据窃取或其他未经授权的系统修改行为。此外，README文件中明确指出了该工具仅供“教育目的和授权测试”，并强调了在“受控环境”下使用的重要性。因此，就POC代码本身而言，它是一个干净、功能明确的漏洞利用工具。然而，必须强调的是，由该工具创建的*输出文件*（即恶意RAR压缩包）是高度危险的，旨在实现任意代码执行，故在处理和测试时必须极其谨慎，并严格限制其使用范围。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8088
