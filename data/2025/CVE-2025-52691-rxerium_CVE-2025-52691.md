## CVE-2025-52691 - SmarterTools SmarterMail 任意文件上传 (RCE)

**漏洞编号:** CVE-2025-52691

**漏洞类型:** 任意文件上传 (RCE)

**影响应用:** SmarterTools SmarterMail

**危害等级:** Critical (严重)

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** Build 9406 及更早版本 (小于 9413)

**利用条件:** 无需身份验证，远程网络访问

**POC 可用性:** 4/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：提供的POC代码是一个基于Nuclei模板编写的自动化扫描脚本。该脚本主要功能是探测目标服务器是否运行了受影响版本的SmarterMail软件。通过向路径 `/interface/root#/login` 发送 GET 请求，脚本会匹配响应体中的 `ng-app="smartermail"` 关键词以确认产品身份。随后，利用正则表达式提取 `stProductVersion` 变量中的版本号和 Build 号。其核心逻辑在于版本比对：如果检测到的 Build 号小于或等于 9406，则判定为漏洞存在。尽管该 POC 本身并不包含实际触发文件上传或执行远程命令的 Payload，但它展示了漏洞定位的自动化方法。对于防御者而言，此 POC 能够快速识别内网资产暴露面。然而，由于它仅通过版本号判定，可能存在误报（如系统已应用补丁但未更改版本字符串）。利用步骤：1. 攻击者扫描互联网上使用特定 Favicon 哈希（-1935525788）的 SmarterMail 实例。2. 通过访问登录页面获取版本信息，确认目标处于受影响范围内。3. 构造恶意 HTTP 报文利用 CVE-2025-52691 的文件上传接口（由于此 POC 截断，具体接口未显示，但通常涉及特定的 API 或上传处理器）。4. 将 WebShell 或恶意可执行文件上传至服务器的敏感路径（如 Web 根目录）。5. 通过浏览器或命令行访问上传的文件，实现远程代码执行。 投毒风险分析：该 POC 模板使用的是标准的 Nuclei DSL 语法，且由社区贡献者编写。代码逻辑透明，仅包含 HTTP 请求和版本提取逻辑，未涉及任何混淆代码、外部二进制下载或敏感信息外发行为。代码中的 matcher 部分使用了合法的版本比较函数 `compare_versions`，没有发现潜在的恶意投毒迹象。唯一需要注意的是，在使用类似自动扫描工具时，应确保从受信任的存储库获取模板。由于此漏洞评分为 10.0 且利用复杂度极低，公开的 POC 极易被集成到僵尸网络或自动化攻击工具中。从防御性研究角度看，该 POC 的投毒风险极低（约5%），属于纯粹的安全检测工具。建议安全团队在沙箱环境中验证模板行为后，将其集成到内部扫描流程中，以排查所有低于 Build 9413 的实例并进行强制升级。

**项目地址:** [https://github.com/rxerium/CVE-2025-52691](https://www.google.com/search?q=https://github.com/rxerium/CVE-2025-52691)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-52691](https://nvd.nist.gov/vuln/detail/CVE-2025-52691)
