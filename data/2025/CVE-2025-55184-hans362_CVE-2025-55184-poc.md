## CVE-2025-55184 - React Server Components, Next.js, Waku 拒绝服务 (Denial of Service)

**漏洞编号:** CVE-2025-55184

**漏洞类型:** 拒绝服务 (Denial of Service)

**影响应用:** React Server Components, Next.js, Waku

**危害等级:** High

**CVSS评分:** 7.5

**影响版本:** React Server Components running vulnerable versions, specifically impacting frameworks like Next.js and Waku prior to patches for CVE-2025-55184 and CVE-2025-67779.

**利用条件:** 无需认证, 通过恶意构造的HTTP POST请求, 利用不安全的反序列化缺陷, 需要网络访问。

**POC 可用性:** 8/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析:
提供的POC代码针对CVE-2025-55184，成功演示了React Server Components (RSC) 中的拒绝服务（DoS）漏洞，尤其影响基于Next.js和Waku等框架构建的应用。POC包含两个Python脚本：`poc-nextjs.py`和`poc-waku.py`，分别针对特定的目标环境进行了优化。

该漏洞的核心在于利用`requests`库向目标服务器发送一个特制HTTP POST请求。攻击的关键在于请求中的特定负载：`files={"0": ("", '"$@0"')}`。根据威胁情报分析（如腾讯云和知道创宇的报告），当服务器尝试反序列化此特定输入时，会在其处理逻辑中触发一个无限循环。这个无限循环会迅速消耗服务器的所有可用CPU周期和内存资源，导致服务器进程挂起，进而无法响应后续的合法HTTP请求，从而造成彻底的拒绝服务。

`poc-nextjs.py`脚本专门针对`http://localhost:3000`（Next.js应用常用的默认端口），并额外包含`Next-Action: x` HTTP头。此头对于引导请求进入Next.js框架内特定的服务器函数或动作端点至关重要，从而确保请求能到达处理反序列化操作的易受攻击路径，最大限度地提高了触发漏洞的可能性。

`poc-waku.py`脚本则针对`http://localhost:8080/RSC/x.txt`，这表明Waku-based RSC应用可能具有不同的端点结构。尽管目标URL和头信息有所不同，但核心攻击机制——即`files={"0": ("", '"$@0"')}`负载及其与不安全反序列化逻辑的交互——保持不变。两个脚本都包含健壮的`try-except`块来处理`requests.exceptions.RequestException`。如果服务器因无限循环成功进入DoS状态，它将在`timeout`时间内停止响应，导致`requests.post`调用抛出异常。这种行为清晰地表明DoS尝试成功，且目标存在漏洞。输出消息`[+] DoS attempt sent.`仅确认请求已发送，而未出现“Target not vulnerable”消息（或出现异常）则强烈暗示攻击成功。此攻击的简单性，仅需一次网络交互（单个POST请求），突显了其高影响和极低的攻击复杂度，使其成为RSC应用管理员的当务之急。此关键缺陷要求立即修补以减轻服务中断的风险。

利用步骤:
1.  **识别目标**: 寻找正在运行的、基于React Server Components构建的应用程序，特别是使用Next.js或Waku，且可能尚未针对CVE-2025-55184打补丁的应用。Next.js的默认端口通常是`3000`，Waku是`8080`，但实际可能有所不同。
2.  **准备POC**: 将相应的Python脚本（Next.js为`poc-nextjs.py`，Waku为`poc-waku.py`）下载或复制到已安装Python和`requests`库的机器上。
3.  **配置目标（如有必要）**: 修改脚本中的`target`变量，使其指向目标应用程序的实际URL和端口。
4.  **执行POC**: 从命令行运行Python脚本（例如，`python poc-nextjs.py`）。
5.  **观察影响**: 监控目标服务器。成功利用将导致服务器无响应、挂起，并无法处理后续请求，符合拒绝服务的情况。Python脚本可能会超时并打印相应的消息，表明服务器无响应。

投毒风险分析:
此POC代码的投毒风险极低，估计为10%。这一评估基于对其代码结构、依赖项和操作逻辑的全面审查。

首先，代码非常清晰、简洁且易于理解。它使用标准的Python编写，并且仅依赖于广泛使用且信誉良好的`requests`库，这是一个用于发送HTTP请求的常用且受信任的库。代码中没有发现任何可能隐藏恶意功能的模糊或自定义依赖项。

其次，代码中没有混淆、加密或任何旨在隐藏恶意意图的技术迹象。所有操作都以明文形式透明可见。代码的唯一目的是构造并发送特定的HTTP POST请求，这直接与报告的DoS漏洞相关。它不会尝试下载外部脚本、连接到未知的命令和控制服务器，也不会在运行POC的系统上执行任意命令。代码中没有`eval()`调用、`subprocess`调用或任何其他可能被利用进行任意代码执行或系统操作的功能，其影响仅限于对*目标*服务器的DoS能力。

第三，POC在运行它的主机上不执行任何文件系统操作（例如读取、写入或删除文件）。它不修改系统配置、不安装持久性后门，也不尝试窃取任何数据。其影响仅限于与指定目标的网络交互，旨在诱导目标进入DoS状态，而不是对运行POC的主机本身造成损害。

综上所述，所提供的`CVE-2025-55184-poc`代码是用于演示拒绝服务漏洞的良性代码。用户可以放心地审查和执行此POC以进行防御性研究或测试，而无需担心自愿感染或供应链投毒的显著风险。由于其清晰简单的性质，该特定POC被额外、隐藏的恶意负载或功能武器化的风险极小。任何实际的投毒风险通常源于不受信任的第三方对POC进行的修改，而非原始代码本身。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55184
