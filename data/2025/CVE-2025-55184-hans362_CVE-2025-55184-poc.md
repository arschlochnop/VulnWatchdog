## CVE-2025-55184 - React Server Components, Next.js, Waku 拒绝服务(Denial of Service)

**漏洞编号:** CVE-2025-55184

**漏洞类型:** 拒绝服务(Denial of Service)

**影响应用:** React Server Components, Next.js, Waku

**危害等级:** 高危

**CVSS评分:** 7.5

**影响版本:** 所有版本在安全补丁发布之前，影响React Server Components及其依赖框架（如Next.js, Waku）。官方强烈建议立即升级。

**利用条件:** 无需认证，可通过HTTP请求远程利用，需要网络访问。

**POC 可用性:** 7

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-55184是一个高危的预认证拒绝服务（DoS）漏洞，影响使用React Server Components（RSC）的应用程序，包括基于RSC构建的框架，如Next.js和Waku。该漏洞的核心在于服务器函数端点对接收到的HTTP请求有效负载进行不安全的反序列化处理。攻击者可以通过构造恶意的HTTP POST请求，发送一个特定格式的payload（如 `{"0": ("", '"$@0"')}`），在服务器端触发一个无限循环。这会导致服务器进程挂起，耗尽系统资源，进而阻止后续的HTTP请求得到响应，最终造成拒绝服务。

**POC有效性分析:**
提供的POC代码包含两个Python脚本：`poc-nextjs.py`和`poc-waku.py`，分别针对Next.js和Waku环境。这两个脚本都使用了Python的`requests`库来发送精心构造的HTTP POST请求。它们的目标分别是`http://localhost:3000`（Next.js）和`http://localhost:8080/RSC/x.txt`（Waku）。核心攻击载荷是 `files={"0": ("", '"$@0"')}`。当这个特定的payload被发送到易受攻击的服务器函数端点时，服务器在尝试反序列化它时会陷入无限循环。POC脚本通过设置一个短的超时时间（5秒），并捕获`requests.exceptions.RequestException`来判断攻击是否成功。如果服务器因陷入无限循环而无法在规定时间内响应，Python的请求将超时并抛出异常，此时POC会打印 "[+] DoS attempt sent." 这表明目标可能已受到攻击。若无异常，则打印 "[-] Target not vulnerable."。这种基于异常捕获的验证机制对于DoS漏洞来说是有效且常见的。代码简洁明了，没有混淆，直接展示了如何触发漏洞，因此可以认为这些POC是有效的概念验证工具，能够可靠地复现CVE-2025-55184所描述的拒绝服务状况。

**利用步骤:**
1.  **环境准备:** 确保您拥有一个运行着易受攻击版本React Server Components的应用程序，例如一个基于Next.js或Waku的Web应用。这些应用程序通常会在开发环境或特定配置下暴露服务器函数端点。例如，Next.js应用可能运行在`http://localhost:3000`，Waku应用可能运行在`http://localhost:8080/RSC/x.txt`。
2.  **安装依赖:** 在攻击者的机器上安装Python及其`requests`库（如果尚未安装）：`pip install requests`。
3.  **选择POC:** 根据目标应用程序的类型，选择相应的POC脚本（`poc-nextjs.py`或`poc-waku.py`）。
4.  **配置目标:** 根据实际情况修改POC脚本中的`target`变量，指向受害服务器的正确URL和端口。
5.  **执行POC:** 在命令行中运行选定的POC脚本，例如 `python poc-nextjs.py`。
6.  **观察结果:** 执行后，POC脚本会发送恶意请求并等待响应。如果目标服务器易受攻击，它将进入无限循环并停止响应。POC脚本将因此捕获到`RequestException`（如连接超时），并输出“DoS attempt sent.”消息。此时，尝试通过浏览器或其他方式访问受攻击应用程序的其他页面，您会发现服务已不可用，从而确认拒绝服务攻击成功。

**投毒风险分析:**
对提供的POC代码进行分析后，其投毒风险极低，评估为10%。

1.  **代码透明度与可读性:** 两个POC脚本（`poc-nextjs.py`和`poc-waku.py`）均使用标准Python编写，代码量少，逻辑清晰，易于理解和审计。没有发现任何代码混淆、加密或难以理解的部分。
2.  **依赖库安全性:** 脚本仅依赖于Python标准库和广受欢迎且经过充分审查的第三方库`requests`。`requests`库本身是HTTP请求的标准库，被广泛使用和信任，不包含已知恶意行为。
3.  **恶意行为缺失:** POC代码的核心功能是发送一个特制的HTTP POST请求，其payload (`"$@0"`)是针对RSC反序列化漏洞的特定触发器，旨在导致服务器端的无限循环。此payload本身不包含任何可执行代码、shell命令、病毒、蠕虫或其他恶意程序。脚本没有执行文件写入、系统命令调用（如`os.system()`）、网络扫描、数据窃取、C2通信、外部资源下载或任何其他可疑的副作用。
4.  **无外部连接:** 脚本除了与目标服务器建立HTTP连接外，没有尝试连接任何其他外部或未知IP地址/域名，这排除了通过外部控制进行恶意操作的风险。
5.  **仅概念验证:** 这些POC的目的是演示漏洞的存在和影响，而非进行持久化攻击或横向移动。它们只会尝试触发拒绝服务，一旦目标服务器恢复（例如通过重启服务），其影响即告结束。

综上所述，此POC代码是用于安全研究和测试的纯净、无害的工具。在受控环境中进行防御性测试时，使用此POC的风险非常低。

**项目地址:** Not available in input data.

**漏洞详情:** Not available in input data.
