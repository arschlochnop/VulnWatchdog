## CVE-2025-55184 - React Server Components (RSC) 及基于其构建的应用，如 Next.js 和 Waku 拒绝服务 (Denial of Service)

**漏洞编号:** CVE-2025-55184

**漏洞类型:** 拒绝服务 (Denial of Service)

**影响应用:** React Server Components (RSC) 及基于其构建的应用，如 Next.js 和 Waku

**危害等级:** 高危

**CVSS评分:** 7.5

**影响版本:** 所有受影响的 React Server Components 版本，尤其是在初始补丁发布之前及未完全修复的版本

**利用条件:** 无需认证、需要网络访问、发送恶意构造的HTTP POST请求至RSC端点

**POC 可用性:** 8

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

CVE-2025-55184 是一个针对 React Server Components (RSC) 的高危拒绝服务 (DoS) 漏洞，CVSS 评分为 7.5。该漏洞源于 RSC 服务器函数端点在处理 HTTP 请求时存在不安全的有效负载反序列化问题。攻击者可以构造一个恶意的 HTTP 请求，该请求包含一个特殊的有效负载，当服务器尝试反序列化此有效负载时，会导致触发一个无限循环。这个无限循环会迅速耗尽服务器的 CPU 资源，使服务器进程挂起，进而导致整个服务无法响应新的 HTTP 请求，最终造成服务彻底瘫痪。此漏洞被归类为预认证（pre-authentication）拒绝服务，意味着攻击者无需任何认证即可发起攻击，大大降低了攻击门槛和复杂度。随后的 CVE-2025-67779 被发现是 CVE-2025-55184 的一个补丁绕过，再次强调了这类反序列化缺陷的严重性和修复的复杂性。除了拒绝服务外，一些相关漏洞（如 CVE-2025-55183）还可能导致源代码泄露，暴露敏感信息，进一步加剧了威胁。

**POC有效性分析**:
提供的 POC 代码包含两个 Python 脚本：`poc-nextjs.py` 和 `poc-waku.py`。这两个脚本设计简洁，分别针对使用 React Server Components 的 Next.js 和 Waku 框架的默认端口和路径。它们使用 Python 的 `requests` 库发送一个 HTTP POST 请求。核心的恶意负载在于 `files={"0": ("", '"$@0"')}`。这个构造的 payload `"$@0"` 模拟了 React Flight Payload 中一个循环引用的 Promise 对象。在 React Server Components 的内部处理中，当服务器尝试反序列化这个包含循环引用的 payload 时，会陷入一个无限递归或循环处理中，从而耗尽服务器资源。
脚本的有效性体现在以下几个方面：
1.  **目标明确**: 脚本针对 Next.js 和 Waku 框架，这是 React Server Components 的主要应用场景。
2.  **攻击载荷精确**: `"$@0"` 被广泛认为是能够触发此反序列化无限循环的经典载荷。
3.  **攻击方式直接**: 通过 HTTP POST 请求发送，模拟了实际攻击场景。
4.  **结果检测**: 脚本通过捕获 `requests.exceptions.RequestException` 来判断目标是否可能已被 DoS。如果请求成功返回，则认为目标未受影响；如果请求挂起或超时（导致异常），则认为 DoS 尝试已发送，并可能成功。
这种设计使得 POC 代码在功能上是完整的，能够有效验证目标系统是否存在该拒绝服务漏洞。在实际测试中，运行这些脚本后，预期的结果是目标服务器的 CPU 使用率飙升，服务响应变慢直至完全无响应，符合拒绝服务攻击的特征。由于其简洁性和直接性，该 POC 具有较高的复现性和可用性。

**利用步骤**:
1.  **识别目标**: 确定目标应用程序是否使用了 React Server Components，并且存在可访问的 RSC 端点。通常这些端点处理 HTTP POST 请求，其 URL 可能类似于 `/`（Next.js 默认）或 `/RSC/x.txt`（Waku 示例）。
2.  **安装依赖**: 确保本地环境安装了 Python `requests` 库 (`pip install requests`)。
3.  **准备POC**: 下载或编写提供的 POC Python 脚本 (`poc-nextjs.py` 或 `poc-waku.py`)。
4.  **配置目标**: 根据目标应用程序的实际部署情况，修改脚本中的 `target` 变量，将其指向受害应用程序的 RSC 端点。例如，如果目标是运行在 `http://example.com:3000` 的 Next.js 应用，则将 `target` 设置为 `"http://example.com:3000"`。
5.  **执行攻击**: 运行 Python 脚本 (`python poc-nextjs.py`)。脚本会向目标发送一个包含恶意 payload 的 HTTP POST 请求。
6.  **观察效果**: 观察目标服务器的响应。如果攻击成功，服务器的 CPU 使用率将急剧上升，服务将变得无响应或彻底瘫痪。攻击者可能会观察到 HTTP 请求超时或连接断开的现象。
7.  **后续攻击 (可选)**: 在服务被 DoS 后，如果存在其他漏洞（如 CVE-2025-55183 源代码泄露），攻击者可能会尝试利用这些漏洞来获取更多信息，因为 DoS 攻击本身是为了中断服务而非数据窃取。

**投毒风险分析**:
针对此次分析的 POC 代码，其投毒风险评估为 **0% (低风险)**。这一评估基于对代码的详尽审查和对其行为模式的全面理解。
1.  **代码透明度高且可审计**: POC 代码由简洁的 Python 脚本组成，完全开源且无任何加密、混淆或隐藏逻辑。所有操作都清晰地呈现在代码中，任何人都可以轻易地阅读、理解并验证其功能。这种高透明度是判断投毒风险的重要依据，因为它排除了恶意行为被秘密嵌入的可能性。没有发现任何动态代码执行（如 `eval()`）、自修改代码或反射机制，这些通常是恶意软件常用的伪装手段。
2.  **依赖标准且可信的库**: 脚本的核心功能仅依赖于 Python 的标准库以及 `requests` 这个广受欢迎且经过严格审查的第三方 HTTP 客户端库。`requests` 库拥有庞大的用户群体和活跃的社区维护，其安全性得到了广泛认可。代码中没有引入任何不常见的、来源不明的或安全性存疑的外部库或二进制文件。这种对成熟、可信赖组件的依赖进一步降低了引入供应链攻击或恶意功能的风险。
3.  **无恶意副作用行为**: 代码的唯一目的是构造并发送一个特定的 HTTP POST 请求，该请求的 payload (`"$@0"`) 旨在触发目标服务器的反序列化漏洞，从而导致拒绝服务。除了这个预期且公开的攻击行为之外，代码中未包含任何其他可疑操作。具体来说，它不会尝试：
    *   建立与未经授权的外部服务器的连接，进行数据渗漏或接收进一步的指令。
    *   在本地文件系统上进行非预期的读写操作，如窃取敏感文件、植入后门或修改系统配置。
    *   执行系统命令或利用其他漏洞来提升权限。
    *   对本地环境进行任何形式的持久化改造，以确保攻击者能够在未来重新访问系统。
    *   利用任何已知的或未知的漏洞来危害运行 POC 的本地机器。
4.  **Payload 特定性**: `"$@0"` 这一恶意 payload 是专门针对 React Server Components 的反序列化机制中的循环引用问题而设计的，其作用高度聚焦于触发特定的 DoS 漏洞。它并非一种通用的恶意指令或代码注入载荷。这表明 POC 的设计是为了精确地验证漏洞，而非作为一种多功能攻击工具。
5.  **缺少典型投毒指标**: 投毒型 POC 常见的一些指标，如代码混淆、未签名的可执行文件、恶意宏、加密通信、利用社会工程学诱导用户执行额外步骤、或试图绕过安全防护机制等，在此次分析的 POC 代码中均未发现。
综上所述，这份 POC 代码是完全符合防御性安全研究目的的标准概念验证工具。它以透明、直接且无害（指对运行 POC 的机器本身无害）的方式演示了漏洞的存在和可利用性。因此，安全分析师可以放心地在受控的测试环境中利用这份 POC 进行漏洞复现、威胁评估和防御策略开发，而无需担忧其本身会成为恶意软件的载体或引入任何额外的安全风险。

**项目地址:** None

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55184
