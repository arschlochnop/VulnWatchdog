## CVE-2025-55184 - React Server Components (RSC), 影响使用RSC的框架如Next.js和Waku 拒绝服务 (Denial of Service)

**漏洞编号:** CVE-2025-55184

**漏洞类型:** 拒绝服务 (Denial of Service)

**影响应用:** React Server Components (RSC), 影响使用RSC的框架如Next.js和Waku

**危害等级:** 高危

**CVSS评分:** 7.5

**影响版本:** 未明确提及受影响的具体版本范围，但已知影响使用React Server Components的应用程序，包括Next.js和Waku框架。

**利用条件:** 无需认证，需要网络访问，通过发送恶意构造的HTTP POST请求至React Server Function端点进行利用。

**POC 可用性:** 8/10

**POC 类型:** 概念验证 (Proof of Concept)

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-55184被披露为一个针对React Server Components (RSC) 的高危拒绝服务（DoS）漏洞，其CVSS评分为7.5。该漏洞的核心在于React Server Function端点在反序列化传入的HTTP请求负载时存在严重的安全缺陷。攻击者无需任何认证，即可通过发送一个精心构造的恶意HTTP POST请求，利用这个不安全的反序列化过程。当服务器尝试处理这个恶意负载时，它会被诱导进入一个无限循环或递归状态，从而迅速耗尽所有可用的CPU资源。这种资源耗尽会导致服务器进程挂起，使其无法处理任何进一步的合法HTTP请求，最终导致服务完全不可用。此漏洞的利用门槛极低，属于预认证攻击类别，使得广泛的应用程序面临风险。

提供的POC代码包含两个Python脚本：`poc-nextjs.py` 和 `poc-waku.py`。这两个脚本旨在针对使用React Server Components的应用程序，演示在不同框架下（如流行的Next.js和新兴的Waku）如何触发拒绝服务攻击。
`poc-nextjs.py` 脚本针对的是运行Next.js的应用程序，默认目标为 `http://localhost:3000`。它通过构造一个HTTP POST请求，并在 `files` 参数中注入一个特定的负载 `{"0": ("", '"$@0"')}`。此外，该脚本还设置了HTTP头部 `Next-Action: x`，这个头部对于Next.js应用程序的服务器动作（Server Actions）路由至关重要，确保恶意请求能够被正确分发到RSC处理逻辑。这个独特的负载 `"$@0"` 在React的反序列化上下文中被设计为一个自引用结构，一旦进入不安全的RSC反序列化流程，便会触发无限递归或循环。这种行为导致服务器的CPU使用率迅速飙升至100%，进而引发进程阻塞和完全无响应状态。
`poc-waku.py` 脚本的功能与 `poc-nextjs.py` 类似，但其目标是使用Waku框架的应用程序，默认目标为 `http://localhost:8080/RSC/x.txt`。虽然目标URL和框架环境有所不同，但其核心攻击向量是相同的：利用 `files={"0": ("", '"$@0"')}` 负载来触发React Server Components的基础反序列化缺陷。这两个POC都充分利用了这一共同漏洞点，展现了其在多种RSC实现中的普适性。

**POC有效性分析**:
这两个POC脚本均展现出高度的有效性和可靠性，可以直接用于验证目标系统是否存在CVE-2025-55184漏洞。脚本代码结构简洁，逻辑清晰，使得安全研究人员和开发人员能够轻松理解和执行。它们通过模拟攻击者发送精确构造的HTTP请求，直指目标服务器的反序列化逻辑缺陷。一旦这些请求被发送到易受攻击的RSC端点，目标服务器的性能会立即受到严重影响，通常表现为CPU利用率飙升至上限，服务器响应速度急剧下降，直至完全停止响应。脚本内部精心设计的 `try-except requests.exceptions.RequestException` 块能够妥善处理因服务器无响应而导致的连接超时或错误，这正是DoS攻击成功后的典型特征，进一步增强了其作为概念验证工具的严谨性。通过简单地修改脚本中的 `target` 变量，使其指向实际的受害者URL（例如，一个暴露的RSC端点），研究人员便能够在受控的测试环境中轻松复现该漏洞。由于此漏洞利用过程无需任何认证，且仅需发送单个精心构造的HTTP POST请求，这使得这些POC成为一个强大、高效且易于使用的漏洞验证工具。在实际测试中，重要的是确保目标服务器正在运行受影响版本的React Server Components，并且其RSC相关的端点是可以通过网络访问的。POC的成功执行将迅速消耗目标服务器的计算资源，使其进程陷入无限循环，从而使其无法处理任何新的合法请求，达到彻底的拒绝服务效果。这种利用方式的效率极高，仅需一个恶意请求便足以导致服务器崩溃，凸显了此漏洞的严重性。

**利用步骤**:
1.  **环境准备**: 确保您的攻击机器上安装了Python 3环境以及`requests`库。如果尚未安装，可以通过命令行 `pip install requests` 进行安装。
2.  **选择POC脚本**: 根据您要测试的目标应用程序所使用的前端框架（例如，Next.js或Waku），选择相应的Python POC脚本 (`poc-nextjs.py` 或 `poc-waku.py`)。
3.  **识别目标URL**: 确定目标应用程序中暴露的React Server Component端点URL。对于Next.js应用，通常是其主域名或包含Server Actions的路由；对于Waku，可能是 `/RSC/x.txt` 或类似路径。
4.  **修改POC脚本**: 使用文本编辑器打开选定的POC脚本，找到 `target` 变量。将其值修改为识别出的目标应用程序的实际可访问URL。例如，如果目标是 `https://vulnerable-app.com`，则将 `target = "http://localhost:3000"` 修改为 `target = "https://vulnerable-app.com"`。
5.  **执行攻击**: 在命令行终端中导航到POC脚本所在的目录，并执行选择的Python脚本。例如：`python poc-nextjs.py`。
6.  **验证攻击效果**: 密切观察目标服务器的运行状态。如果攻击成功，您会发现服务器的CPU使用率急剧上升，服务响应时间显著延长，最终完全停止响应。POC脚本在发送请求后会打印 `[+] DoS attempt sent.`。如果服务器未受影响，可能会在请求超时后打印 `[-] Target not vulnerable.`。
7.  **服务恢复**: 由于该漏洞导致服务器进程挂起，通常需要手动重启受影响的服务器或相关服务才能恢复正常运行。

**投毒风险分析**:
针对CVE-2025-55184提供的POC代码（`poc-nextjs.py`和`poc-waku.py`）经过全面细致的审查，其被“投毒”的风险被评估为极低，从而使其成为一个相对安全的防御性安全研究工具。代码的设计理念是高度透明和功能单一的，其唯一的目的就是通过发送特定的HTTP请求来触发和验证拒绝服务漏洞。
1.  **代码透明度与可读性**: 两个Python脚本都极其简洁，每个脚本的有效代码行数不足20行，且没有任何形式的代码混淆或加密。代码逻辑直观，所有函数调用和参数都清晰地暴露，这使得任何具备基本Python知识的安全研究人员都能够逐行审阅并完全理解其执行的每一个操作。这种高度的透明性是评估投毒风险的关键因素，因为它允许用户在执行前彻底检查代码，确保没有隐藏的恶意功能。
2.  **依赖库的安全性**: 脚本仅依赖于标准的Python `requests`库，这是一个在Python社区中广泛使用、高度信任且经过长期安全验证的HTTP客户端库。`requests`库本身被认为是安全的，并且其维护者致力于修复任何已知的安全问题。在代码中未发现有引入任何其他可疑的第三方库、外部二进制文件或自定义模块，这大大降低了引入潜在恶意组件的风险。
3.  **缺乏恶意行为**: 对代码内容的分析表明，它没有包含任何超出其明确声明目的的恶意功能。脚本不会执行诸如文件系统操作（例如创建、修改、删除文件）、修改操作系统注册表、尝试进程注入、安装后门程序、窃取敏感凭据、进行网络端口扫描、建立命令与控制（C2）通信、下载并执行任意外部代码，或者进行加密货币挖矿等任何形式的恶意活动。其唯一的交互行为是构造并发送一个符合HTTP协议规范的POST请求。
4.  **有限的网络活动**: 除了向用户指定的 `target` URL发送POC请求之外，脚本没有尝试连接任何其他IP地址或域名。这意味着不存在潜在的数据泄露风险（例如，将敏感系统信息发送给攻击者）或回连外部恶意服务器以获取进一步指令的风险。这种隔离的网络行为进一步强化了其安全性。
5.  **资源消耗最小化**: 脚本自身在执行时对本地攻击机器的系统资源消耗极低，不会尝试利用本地计算资源进行任何未声明的活动，如大规模计算或内存密集型操作。
综上所述，这份POC代码可以被视为一个纯粹的功能性验证工具，严格遵循了防御性安全研究领域的最佳实践。对于下载和使用此POC的组织和个人，只要确保代码是从可信的官方渠道获取，并且在执行前进行基本的代码审查（尽管在此案例中代码的透明性已经提供了很强的信心），其被“投毒”（即包含超出漏洞验证之外的隐藏恶意功能）的风险几乎可以忽略不计。这与一些复杂的开源项目可能面临的供应链攻击风险形成了鲜明对比，该POC的简洁和聚焦性使其成为一个低风险、高可信度的分析工具。

**项目地址:** 未在提供数据中明确给出

**漏洞详情:** https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-55184
