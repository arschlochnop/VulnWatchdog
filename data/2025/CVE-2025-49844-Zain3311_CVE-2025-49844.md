## CVE-2025-49844 - Redis RCE (Remote Code Execution)

**漏洞编号:** CVE-2025-49844

**漏洞类型:** RCE (Remote Code Execution)

**影响应用:** Redis

**危害等级:** Critical

**CVSS评分:** 10.0

**影响版本:** 具体受影响版本需参照官方最新公告，通常涉及支持Lua脚本的多个Redis分支

**利用条件:** 需要对Redis服务器进行身份验证，并且有权执行Lua脚本（通过EVAL或EVALSHA命令）

**POC 可用性:** 4/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 25%

## 详情

【POC有效性分析】该漏洞属于Lua引擎在处理特定脚本时的释放后重用（Use-After-Free, UAF）漏洞。根据提供的搜索结果，攻击者可以通过构造特殊的Lua脚本，诱导Redis在执行过程中访问已经释放的内存地址，从而实现任意代码执行。提供的POC代码片段显示为一个名为'DesiShop'的.NET 5.0项目结构，这与Redis Lua RCE漏洞的攻击载体存在明显背离。该.NET项目包含典型的Web应用结构（Startup.cs, Program.cs, DesiShop.csproj），其内容更倾向于一个普通的Web商城后端，并未包含针对Redis Lua引擎的底层Exploit逻辑。因此，当前提供的源码集合在针对CVE-2025-49844的验证上是无效的，可能只是项目模板或被误关联的文件。真正的利用代码应当包含针对Redis二进制协议的Socket通信以及精心构造的Lua脚本负载。【利用步骤】1. 获取目标Redis实例的访问权限（通常需要密码认证）。2. 构造能够触发UAF状态的Lua脚本，例如涉及协程切换或全局变量清理的复杂逻辑。3. 使用EVAL命令发送该脚本。4. 触发内存损坏后，通过覆盖函数指针或跳转至Shellcode实现控制流接管。5. 执行系统级命令或反弹Shell。【投毒风险分析】在针对此类高危漏洞的防御研究中，存在较高的供应端投毒风险。虽然本次提供的.NET项目代码库相对清晰，使用了标准的NuGet包（如Microsoft.AspNetCore.Authentication.JwtBearer），且未见明显的恶意二进制混淆，但其不匹配的特性本身就是一个红旗。常见的投毒方式包括：在所谓的'一键复现脚本'中加入隐藏的curl请求，将受害者的Redis凭据或系统信息发送到攻击者控制的C2服务器；或者在.csproj文件的预编译脚本（Pre-build event）中植入恶意命令。鉴于该POC与其宣称的漏洞类型严重不符，安全研究员应警惕该项目可能在未显示的Startup.cs逻辑中包含恶意中间件或在未完全显示的DesiShop.ManagementClasses命名空间下潜伏后门。建议在完全隔离的沙盒环境中审计所有第三方包的哈希值，严禁在生产环境直接编译或运行此类来源不明的'POC'项目。

**项目地址:** [https://github.com/raminfp/redis_exploit](https://github.com/raminfp/redis_exploit)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)
