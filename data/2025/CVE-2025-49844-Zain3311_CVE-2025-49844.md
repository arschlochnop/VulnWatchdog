## CVE-2025-49844 - Redis 远程代码执行

**漏洞编号:** CVE-2025-49844

**漏洞类型:** 远程代码执行

**影响应用:** Redis

**危害等级:** 严重

**CVSS评分:** 10.0

**影响版本:** 所有支持Lua脚本的Redis版本

**利用条件:** 需要身份验证

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

CVE-2025-49844 (RediShell) 是 Redis 数据库的一个严重漏洞，CVSS 评分为 10.0。该漏洞是一个 Use-After-Free (UAF) 漏洞，存在于 Lua 解释器中，允许经过身份验证的远程攻击者执行任意代码。漏洞影响所有支持 Lua 脚本的 Redis 版本。

POC 代码分析：
分析提供的 C# 代码片段，可以发现它构建了一个名为 "DesiShop" 的 ASP.NET Core Web 应用程序。从 Startup.cs 的代码片段可以看出，应用程序使用了 JWT Bearer 身份验证，并配置了 Swagger。csproj 文件显示应用程序依赖于 NewtonsoftJson、Swashbuckle.AspNetCore 和 System.Data.SqlClient 等包。这些信息表明应用程序可能容易受到各种 Web 应用程序漏洞的攻击，例如 SQL 注入、跨站点脚本 (XSS) 和身份验证绕过。提供的 POC 代码本身不包含直接触发 Redis 漏洞的代码，但是，它创建了一个 Web 应用程序，可以作为利用 Redis 漏洞的跳板。该应用程序可能使用 Redis 作为缓存或会话存储，如果配置不当，则可能容易受到攻击。

利用步骤：

1.  **环境准备：** 搭建 Redis 服务器，并确保启用 Lua 脚本支持。
2.  **身份验证：** 攻击者需要获得 Redis 服务器的身份验证凭据。这可以通过各种方式实现，例如爆破弱密码、利用其他漏洞或通过社会工程学。
3.  **漏洞利用：** 攻击者可以使用 Redis 客户端连接到服务器，并执行恶意的 Lua 脚本，该脚本将利用 UAF 漏洞执行任意代码。

POC有效性分析：根据搜索结果，GitHub上存在该漏洞的POC，名称为"redis_exploit"。CSDN博客中也提到了该漏洞的利用和修复方式。考虑到该漏洞的CVSS评分为10.0，且存在公开可用的POC，因此该漏洞的威胁程度非常高。

投毒风险分析：
该漏洞的投毒风险相对较低，因为利用该漏洞需要身份验证，并且需要执行恶意的 Lua 脚本。恶意 Lua 脚本可能包含混淆的代码或尝试下载和执行其他恶意软件。但是，由于 Redis 通常在受控环境中运行，因此投毒风险相对较低。另外，检查POC代码发现使用了标准库和常规函数，未发现恶意行为和外部脚本调用，因此投毒风险较低。

缓解措施：

*   **禁用 Lua 脚本：** 如果不需要 Lua 脚本支持，可以禁用它。
*   **限制 Lua 脚本的权限：** 可以使用 Redis 的权限控制机制来限制 Lua 脚本可以执行的操作。
*   **更新 Redis 版本：** 将 Redis 更新到最新版本，其中包含针对此漏洞的修复。
*   **禁用EVAL命令：** 在redis.conf中禁用EVAL命令。
*   **使用redis锁的不能禁用EVAL：** 确保使用redis锁的服务不会因此受到影响。
*   **限制客户端连接：** 仅允许受信任的客户端连接到 Redis 服务器。

**项目地址:** https://github.com/raminfp/redis_exploit

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-49844
