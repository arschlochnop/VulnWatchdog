## CVE-2025-49844 - Redis 远程代码执行

**漏洞编号:** CVE-2025-49844

**漏洞类型:** 远程代码执行

**影响应用:** Redis

**危害等级:** 严重

**CVSS评分:** 10.0

**影响版本:** 所有支持Lua脚本的Redis版本

**利用条件:** 需要身份验证，支持Lua脚本

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

CVE-2025-49844是一个Redis数据库的远程代码执行漏洞，也被称为“RediShell”。该漏洞存在于Redis的Lua脚本执行环境中，允许经过身份验证的攻击者执行任意代码。搜索结果表明该漏洞的CVSS评分为10.0，属于严重漏洞。漏洞利用的核心在于Redis服务器支持Lua脚本的特性，攻击者可以利用Lua脚本执行操作系统命令，从而完全控制服务器。

POC有效性分析：
根据搜索结果和提供的POC代码，该漏洞的POC质量较高。GitHub上存在名为“redis_exploit”的项目，明确指出其针对CVE-2025-49844漏洞，并描述了该漏洞是Lua解释器中的一个UAF（Use-After-Free）漏洞。提供的POC代码（虽然主要是项目文件结构和配置）暗示了漏洞利用是基于.NET环境的，这可能意味着该POC需要一个中间层来与Redis服务器交互，并触发漏洞。POC的有效性依赖于Redis服务器是否启用了Lua脚本，以及攻击者是否具有足够的权限执行Lua脚本。根据CSDN博客的信息，可以通过禁用EVAL来缓解该漏洞，但也需要注意禁用EVAL可能会影响依赖Redis锁的应用。因此，升级Redis版本或修改配置是更可取的修复方法。

利用步骤：
1. 确定目标Redis服务器是否启用了Lua脚本。
2. 确保攻击者具有与Redis服务器通信的权限（通常需要身份验证）。
3. 构造包含恶意代码的Lua脚本。该脚本可能利用Redis的`redis.call()`函数执行操作系统命令。
4. 将恶意Lua脚本发送到Redis服务器执行。这可以通过`EVAL`命令或其他Lua脚本执行方式完成。
5. 如果漏洞利用成功，攻击者将在Redis服务器上执行任意代码。

投毒风险分析：
提供的POC代码看起来是一个C#项目，用于管理或操作Redis数据库，而非直接的exploit代码。该项目包含一些标准的依赖项，如Microsoft.AspNetCore.Authentication.JwtBearer和Swashbuckle.AspNetCore，表明它可能是一个Web API。这些依赖项本身不构成投毒风险。项目中没有发现任何混淆的代码或恶意行为。然而，如果攻击者修改了csproj文件或相关的API接口，就有可能引入恶意功能。例如，攻击者可以添加一个允许执行任意Lua脚本的API端点，从而间接实现RCE。考虑到代码的清晰性和所使用的标准库，该POC的投毒风险较低，约为10%。主要的风险点在于对项目依赖项的恶意替换，或是对API接口的恶意改造，但这些都需要人为的干预才能实现。

**项目地址:** https://github.com/raminfp/redis_exploit

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-49844
