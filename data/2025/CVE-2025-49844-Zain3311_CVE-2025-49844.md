## CVE-2025-49844 - Redis 远程代码执行(RCE)

**漏洞编号:** CVE-2025-49844

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Redis

**危害等级:** Critical

**CVSS评分:** 10.0

**影响版本:** All versions supporting Lua scripting

**利用条件:** Authenticated remote attacker

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 30%

## 详情

CVE-2025-49844，也被称为RediShell，是Redis数据库中一个严重的远程代码执行漏洞。该漏洞存在于Redis的Lua脚本解释器中，允许经过身份验证的远程攻击者执行任意代码。该漏洞CVSS评分为10.0，表明其具有极高的严重性。

POC有效性分析：根据搜索结果，存在公开可用的POC代码（例如，GitHub上的"redis_exploit"项目）。这些POC利用了Lua脚本解释器中的use-after-free漏洞。通过发送特制的Lua脚本，攻击者可以触发内存错误，进而执行任意代码。POC代码通常需要配置Redis服务器的连接参数，例如IP地址、端口和身份验证凭据。由于该漏洞存在于Lua脚本解释器中，因此受影响的Redis版本包括所有支持Lua脚本的版本。

利用步骤：
1. 攻击者需要具有对Redis服务器的身份验证访问权限。
2. 攻击者构造一个恶意Lua脚本，该脚本包含利用use-after-free漏洞的代码。
3. 攻击者将恶意Lua脚本发送到Redis服务器。
4. Redis服务器执行该脚本，触发漏洞，允许攻击者执行任意代码。
5. 攻击者可以利用此代码执行来安装后门、窃取数据或破坏系统。

投毒风险分析：该POC代码的投毒风险为中等。首先，该漏洞利用涉及使用Lua脚本，这本身就可能被滥用以执行恶意操作。其次，一些POC可能包含混淆代码或不必要的外部依赖项。虽然该漏洞利用本身旨在利用已知的安全漏洞，但是攻击者可能会修改POC代码以包含其他恶意功能，例如，添加额外的后门或收集敏感信息。此外，攻击者可能会尝试分发带有恶意修改的POC代码，以欺骗安全研究人员或开发人员，诱使他们运行恶意代码。由于利用过程依赖于Lua脚本的执行，因此存在利用Lua脚本的特性来隐藏恶意意图的风险。例如，可以利用Lua的动态特性来加载和执行外部代码，或者使用字符串操作来混淆恶意代码。此外，某些利用程序可能需要特定的库或模块，这些库或模块本身可能包含漏洞或恶意代码。因此，在使用或分析此类POC代码时，必须保持警惕，并采取适当的安全措施，例如代码审查、沙箱执行和信誉检查。

考虑到以上几点，对该POC的投毒风险评估为30%。

**项目地址:** https://github.com/raminfp/redis_exploit

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-49844
