## CVE-2025-54253 - Adobe Experience Manager (AEM) Forms on JEE 远程代码执行(RCE)、认证绕过、OGNL表达式注入

**漏洞编号:** CVE-2025-54253

**漏洞类型:** 远程代码执行(RCE)、认证绕过、OGNL表达式注入

**影响应用:** Adobe Experience Manager (AEM) Forms on JEE

**危害等级:** 高危

**CVSS评分:** 9.8 (推断)

**影响版本:** Adobe于2025年8月修复前的版本

**利用条件:** 未认证攻击者、低复杂度攻击、无需用户交互、网络可达

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析: 提供的AEMPWN工具是一个针对CVE-2025-54253和CVE-2025-54254的专业扫描和利用工具，专注于Adobe Experience Manager (AEM) Forms on JEE。该工具设计了三种操作模式：安全PoC模式、OOB XXE模式和RCE模式，覆盖了从漏洞检测到完整利用的整个流程。在“安全PoC”模式下，工具能够识别XML反射、非HTML结构化响应和Canary令牌反射等指标，提供低噪声的验证，避免了潜在的破坏性操作。针对CVE-2025-54254的“OOB XXE”模式，通过监控从目标服务器到攻击者控制的HTTP服务器的出站请求，可确认盲XXE漏洞的存在，并证明可以获取外部实体及泄露敏感文件。最关键的“RCE模式”则致力于实现实际的代码执行。此模式利用XML解析中的JNDI注入，要求攻击者预先配置LDAP服务器（如marshalsec）以提供Java类引用，并配置HTTP服务器以托管编译后的恶意Java类。文档详细阐述了LDAP在解析JNDI引用中的作用，说明AEM服务器如何连接到攻击者的LDAP监听器，并最终加载执行指定的Java类。其中包含的恶意类示例（如创建文件或反弹Shell）清晰地演示了如何实现远程代码执行。AEMPWN工具的全面性、清晰的文档以及对必要基础设施的详细说明，证明了其作为概念验证和完整漏洞利用工具的高度有效性和可靠性，符合实际渗透测试和红队行动的需求。

利用步骤: 攻击者可以遵循以下步骤利用CVE-2025-54253：
1.  **目标识别**: 利用AEMPWN工具或其他手段，识别运行Adobe Experience Manager Forms on JEE的易受攻击实例。该漏洞的核心在于AEM Forms中的Apache Struts的“devMode”在管理界面中被启用，同时存在认证绕过漏洞。
2.  **环境准备**: 为了实现RCE攻击，攻击者需要设置两个关键的外部基础设施：
    *   **LDAP服务器**: 运行一个JNDI注入辅助工具，例如`marshalsec`，并使其监听特定端口（如1389）。该服务器将用于响应AEM服务器发出的JNDI查询，并重定向AEM服务器去加载恶意Java类。
    *   **HTTP服务器**: 用于托管一个预编译的恶意Java类文件（例如`Exploit.class`）。当AEM服务器成功加载并执行该恶意类后，即可执行攻击者指定的任意命令（例如在目标系统上创建文件、执行反弹Shell等）。
3.  **执行攻击**: 
    *   攻击者使用AEMPWN工具的`--rce`模式，并提供目标AEM Forms实例的URL以及已搭建好的LDAP和HTTP服务器地址。
    *   AEMPWN工具将利用认证绕过漏洞和Apache Struts的OGNL表达式解析缺陷，向AEM Forms发送恶意构造的请求。
    *   AEM服务器在处理这些恶意请求时，会解析其中包含的XML输入，触发JNDI查找操作，并连接到攻击者控制的LDAP服务器。
    *   LDAP服务器接收到连接后，会响应并引导AEM服务器从攻击者的HTTP服务器下载并加载恶意Java类。
    *   最终，AEM服务器的Java虚拟机(JVM)将加载并执行该恶意Java类，从而在AEM服务器上实现远程代码执行，获得对系统的完全控制。

投毒风险分析: 对提供的AEMPWN工具（从README.md文件内容判断）进行投毒风险评估为低（10%）。主要基于以下几点分析：
*   **透明的工具目的**: `README.md`文件清晰地声明了AEMPWN是一个针对Adobe Experience Manager (AEM) Forms漏洞的扫描和利用工具，并明确指出其设计初衷是用于“授权安全测试”。这种高度透明的自我描述是合法安全工具的显著特征，而非恶意软件的惯用伎俩。
*   **模块化与用户控制**: 工具提供了多种操作模式，尤其是RCE模式，需要用户主动配置外部的LDAP和HTTP服务器，并提供自定义的恶意Java类。这意味着工具本身并不内嵌执行最终RCE的恶意载荷，而是充当一个协调器。用户对核心的攻击载荷拥有完全的控制权和可见性，降低了工具被预置隐蔽恶意行为的风险。
*   **无代码混淆迹象**: 提供的文档内容详尽且清晰，对漏洞原理、利用方式（如JNDI注入、marshalsec的使用）的描述均符合标准的攻击技术解释，没有发现任何代码混淆或试图隐藏其真实功能的迹象。
*   **“恶意类示例”的语境**: 文档中提及的“Malicious class example”是为了演示远程代码执行的效果，作为攻击载荷的示例代码片段。这并非`AEMPWN`工具本身包含的恶意代码。在安全研究和漏洞利用概念验证中，提供此类示例是标准且必要的实践，不应被误判为工具投毒。
*   **依赖外部基础设施**: 工具的RCE功能需要攻击者搭建并控制外部的LDAP和HTTP服务器。这种外部依赖性使得工具本身难以悄悄地执行预设的恶意动作，因为其最终的攻击行为是由用户提供的外部组件决定的。

综上所述，AEMPWN工具表现出高透明度、良好的可控性和无恶意隐藏行为的特征，因此其作为恶意工具或被投毒的风险极低。它是一个典型的、用于合法安全研究和渗透测试的专业工具。

**项目地址:** https://github.com/topics/cve-2025-54253

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-54253
