## CVE-2025-68613 - n8n Workflow Automation Platform RCE (Remote Code Execution)

**漏洞编号:** CVE-2025-68613

**漏洞类型:** RCE (Remote Code Execution)

**影响应用:** n8n Workflow Automation Platform

**危害等级:** CRITICAL

**CVSS评分:** 9.9

**影响版本:** 0.211.0 ≤ n8n < 1.120.4, 1.121.1, 1.122.0

**利用条件:** 需要用户认证，默认配置即可触发

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞是典型的Node.js环境下的沙箱逃逸。n8n通过双大括号'{{ }}'支持动态表达式评估，但在底层处理时，未能对JavaScript执行上下文进行严格隔离。通过POC代码分析，攻击者利用了Node.js中的全局对象引用特性，具体路径为：通过'this'关键字回溯至Node.js的全局进程对象（process），进而访问'mainModule'。由于n8n主进程拥有完整的系统模块访问权限，攻击者可以通过'require'方法加载原生'child_process'模块。利用步骤如下：1. 攻击者以合法用户身份登录n8n平台；2. 创建或编辑一个包含表达式的工作流节点；3. 在表达式字段输入精心构造的payload，例如：(function(){ return this.process.mainModule.require('child_process').execSync('id').toString() })(); 4. 当该节点被触发执行时，n8n后端引擎会评估此表达式，绕过应用层逻辑直接在宿主机执行系统命令。此POC展示了从表达式注入到系统权限获取的完整链路，由于其直接利用了Node.js语言层面的对象模型，其在受影响版本上的成功率接近100%，具备极高的实战威胁价值。投毒风险分析：该POC来源于知名的技术社区（如CSDN、微信公众号及TryHackMe实验文档），代码逻辑透明，主要使用了Node.js的标准API（process, require, execSync），没有发现明显的恶意代码混淆、外部非法连接或敏感信息窃取行为。尽管在复杂环境中利用需要理解Node.js对象链，但提供的Payload非常直接。投毒风险评定为15%，属于较低水平，主要风险在于这类公开的高质量POC会被攻击者直接整合进自动化扫描工具中。对于防御方而言，此类POC是绝佳的漏洞复现素材，但需警惕某些非官方渠道下载的所谓‘一键利用脚本’，这些脚本可能被二次封装了反弹Shell至第三方服务器的指令。在测试此类漏洞时，建议始终在隔离的容器环境中进行，并对执行的Payload进行白名单审计，防止在验证过程中意外泄露内部网络信息。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-68613](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-68613)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-68613](https://nvd.nist.gov/vuln/detail/CVE-2025-68613)
