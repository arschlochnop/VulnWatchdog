## CVE-2025-59287 - Microsoft Windows Server Update Services (WSUS) 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Server Update Services (WSUS)

**危害等级:** 严重 (Critical)

**CVSS评分:** 9.8

**影响版本:** 受支持的Windows Server上的WSUS服务

**利用条件:** 无需认证，需要网络访问WSUS服务

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-59287是一个严重的远程代码执行（RCE）漏洞，影响Microsoft Windows Server Update Services (WSUS)。此漏洞的CVSS评分高达9.8，允许未经身份验证的攻击者在WSUS服务器上执行任意代码。根据搜索结果，该漏洞已被积极利用，用于分发ShadowPad恶意软件，并促使Microsoft发布了紧急带外安全更新。WSUS是IT管理员用于集中管理系统更新的基础工具，因此此漏洞因其广泛部署和在企业补丁管理中的关键作用而具有极高的影响。该漏洞的积极利用情况凸显了其严峻性和立即修补的重要性。

POC有效性分析:
所提供的Python POC脚本（CVE-2025-59287.py）是一个健壮且功能完善的工具，旨在利用此RCE漏洞。它利用了.NET反序列化缺陷，特别是通过DataSet小工具链，针对SoapFormatter进行攻击。脚本的方法是可靠的：它首先从`/SimpleAuthWebService/SimpleAuth.asmx`端点获取授权Cookie，这是与WSUS服务交互的常见先决条件或步骤。此初始步骤使用包含客户端ID的标准SOAP请求。漏洞利用的核心在于它能够生成和传递恶意序列化的.NET对象。脚本没有直接嵌入复杂的小工具链，而是巧妙地将此任务委托给`ysoserial.net`，这是一个广受认可和信任的开源工具，用于生成.NET反序列化有效载荷。这种方法增强了POC的灵活性，使其能够为各种命令执行场景生成有效载荷。`generate_ysoserial_payload`函数精心构造了`subprocess.run`命令，确保使用了正确的小工具（`DataSet`）、格式器（`SoapFormatter`）和输出格式（`raw`）。生成的有效载荷是一个原始的序列化.NET对象，随后被嵌入到目标WSUS易受攻击端点（例如，`/UpdateServer/UpdateServer.asmx`，根据典型的WSUS攻击向量推断，尽管POC片段中确切的最终端点被截断，但`UpdateServer`上下文是清晰的）的SOAP请求中。脚本处理了错误条件，例如`ysoserial.net`未找到或无法生成有效载荷，这使其对安全研究人员而言是用户友好的。该脚本演示了从初始服务交互到有效载荷传递的完整利用链，证实了其在易受攻击的WSUS安装上实现RCE的高效性。搜索结果中报告的积极利用进一步证实了此缺陷的严重性和可利用性。

利用步骤:
要成功使用此POC，请遵循以下步骤：
1.  **先决条件：** 确保已安装Python 3。从其官方存储库（例如GitHub Releases）下载`ysoserial.net`可执行文件（例如`ysoserial.exe`）。此工具对于生成.NET反序列化有效载荷至关重要。
2.  **脚本准备：** 将提供的Python代码保存为`CVE-2025-59287.py`。
3.  **执行命令：** 从终端运行脚本，提供目标WSUS服务器URL、`ysoserial.net`可执行文件的完整路径以及您希望在远程WSUS服务器上执行的任意命令。
    *   例如（针对Windows目标）：`python CVE-2025-59287.py --target "https://wsus.example.com" --ysoserial "C:\path\to\ysoserial.exe" --command "calc.exe"`
    *   例如（Linux攻击者为Windows目标生成有效载荷）：`python CVE-2025-59287.py --target "https://wsus.example.com" --ysoserial "/usr/local/bin/ysoserial.exe" --command "powershell -c Start-Process cmd -ArgumentList '/c calc.exe'"`
4.  **观察：** 脚本将首先尝试检索身份验证Cookie，然后生成反序列化有效载荷，最后将其发送到WSUS服务器。成功的利用应导致在目标系统上执行指定的命令。

投毒风险分析:
与`CVE-2025-59287.py` POC代码相关的投毒风险极低，估计约为5%。此评估基于对所提供代码片段的全面审查。该脚本遵循标准防御性安全研究实践。它主要依赖于知名且标准的Python库（`requests`、`urllib3`、`xml.etree.ElementTree`、`datetime`、`sys`、`uuid`、`subprocess`、`os`、`argparse`），这些库经过广泛审查且本身不具有恶意性。在其他情况下可能引起关注的关键组件——`subprocess.run`调用，在此处被合法地用于调用`ysoserial.net`。这个外部依赖项是网络安全界公认的工具，用于创建.NET反序列化有效载荷，而不是隐藏的恶意组件。脚本的目的明确：通过反序列化小工具传递用户定义的命令来利用特定的RCE漏洞。没有证据表明代码混淆、对指定WSUS目标之外的域进行异常或未经请求的网络连接、尝试从互联网下载或执行其他不受信任的二进制文件，或任何旨在从攻击者系统窃取数据的机制。`command`参数明确用于在*目标*服务器上执行，而不是在运行POC的本地机器上执行。鉴于其操作的透明性以及对现有合法工具和库的依赖，此特定POC代码被“投毒”或包含隐藏恶意功能的可能性极小。然而，作为一般的安全最佳实践，用户应始终从官方来源下载`ysoserial.net`并验证其完整性，以防止与外部依赖项相关的供应链攻击。

**项目地址:** 

**漏洞详情:** https://www.sogou.com//link?url=hedJjaC291OT1KzyjerxM1uWkymzJPK99gAHtPfHXHl5vAV7UCaVa8f-geW9JwLzIDNAVdEdFEMyeFZ86WHW40lVnezfefvp
