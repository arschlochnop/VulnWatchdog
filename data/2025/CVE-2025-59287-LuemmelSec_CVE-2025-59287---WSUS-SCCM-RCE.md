## CVE-2025-59287 - Microsoft Windows Server Update Services (WSUS) 远程代码执行(RCE)

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Microsoft Windows Server Update Services (WSUS)

**危害等级:** 高危

**CVSS评分:** 9.8

**影响版本:** Windows Server 2025, Windows Server 2022, Windows Server 2019, Windows Server 2012

**利用条件:** 无需认证，远程可利用，需要网络访问

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-59287是Microsoft Windows Server Update Services (WSUS)中存在的一个高危远程代码执行(RCE)漏洞，其根本原因是服务端在处理特定SOAP请求（如涉及AuthorizationCookie时）存在不安全的反序列化缺陷。未经身份验证的远程攻击者可以通过发送特制事件，触发传统序列化机制中的不安全对象反序列化，从而在WSUS服务器上执行任意代码。该漏洞被赋予CVSS 9.8的高分评级，攻击者无需任何身份凭证即可通过网络远程利用。

POC有效性分析:
提供的Python POC脚本是一个功能完整且高度有效的利用工具。它巧妙地结合了Python的脚本能力和业界知名的.NET反序列化利用工具`ysoserial.net`。脚本的主要功能包括：
1.  **payload生成**: 通过调用`ysoserial.net`（一个外部可执行文件），脚本能够生成各种.NET反序列化payload，支持如`DataSet`等gadget chain和`SoapFormatter`格式，实现了高度灵活的命令执行能力。
2.  **认证cookie获取**: 脚本能够与WSUS的`/SimpleAuthWebService/SimpleAuth.asmx`服务交互，获取有效的AuthorizationCookie，这是成功触发反序列化漏洞的关键步骤之一。
虽然POC需要用户手动提供`ysoserial.exe`的路径，但这对于熟悉.NET反序列化攻击的攻击者或防御者来说是标准操作。整体而言，该POC设计合理，流程清晰，自动化程度高，对于验证该漏洞的实际存在和危害具有极高的有效性。

利用步骤:
1.  **环境准备**: 攻击者需要一台安装Python环境的机器，并下载`ysoserial.net`的可执行文件`ysoserial.exe`，确保POC脚本能够访问到它。
2.  **执行POC**: 攻击者运行Python POC脚本，指定目标WSUS服务器的URL和`ysoserial.exe`的路径，并提供要执行的任意系统命令。
    示例命令: `python3 CVE-2025-59287.py --target https://[WSUS_IP]:8531 --ysoserial /path/to/ysoserial.exe --command "calc.exe"`
3.  **获取认证**: POC脚本首先会向WSUS服务器的`/SimpleAuthWebService/SimpleAuth.asmx`端点发送SOAP请求，获取一个临时的AuthorizationCookie。
4.  **生成payload**: 脚本内部调用`ysoserial.exe`，根据攻击者提供的命令生成恶意的.NET反序列化payload。
5.  **发送攻击请求**: 脚本将生成的恶意payload嵌入到另一个SOAP请求中（通常是AuthorizationCookie或其他在服务端进行反序列化的参数），并将其发送到WSUS服务器的受影响服务接口。
6.  **代码执行**: WSUS服务器在处理该SOAP请求时，会尝试反序列化恶意payload，从而触发其中的攻击者指定命令的执行，实现远程代码执行。

投毒风险分析:
本POC代码`CVE-2025-59287.py`的投毒风险评估为低风险（约10%）。代码本身结构清晰，使用Python标准库和`requests`等常用第三方库进行网络通信。其核心逻辑是调用外部工具`ysoserial.net`来生成反序列化payload，并将用户提供的命令作为参数传递给该工具。这种设计是利用.NET反序列化漏洞的常见且标准做法，`ysoserial.net`本身是一个广泛认可的开源安全工具。在提供的代码片段中，没有发现恶意代码混淆、从未知URL下载并执行外部脚本、或者滥用`eval`等高风险函数的情况。POC的目的明确，即通过不安全反序列化实现命令执行，不包含任何与后门、持久化或恶意数据窃取相关的逻辑。搜索结果中提及的“攻击者利用PowerCat获取系统shell”是指实际攻击者在利用漏洞成功后进行的后渗透操作，而非此POC脚本自带的恶意行为。因此，对于进行合法防御性安全研究和漏洞验证的组织而言，在确保`ysoserial.net`来源可信的前提下，使用该POC进行测试的风险极低，不会引入额外的恶意软件或后门。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-59287
