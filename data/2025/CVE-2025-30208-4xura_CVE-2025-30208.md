## CVE-2025-30208 - Vite (前端开发构建工具) 路径穿越 (Path Traversal)

**漏洞编号:** CVE-2025-30208

**漏洞类型:** 路径穿越 (Path Traversal)

**影响应用:** Vite (前端开发构建工具)

**危害等级:** 高危

**CVSS评分:** 5.3 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N)

**影响版本:** < 6.2.3, < 6.1.2, < 6.0.12, < 5.4.15, < 4.5.10

**利用条件:** Vite 处于开发模式 (Dev Mode)，且服务对外暴露或攻击者可通过 SSR/代理访问其开发端口。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞存在于 Vite 的 `transformMiddleware` 中间件内。Vite 在开发模式下使用 `/@fs/` 前缀来服务本地绝对路径文件。虽然系统设有 `server.fs.allow` 配置来限制可访问目录，但此 POC 演示了如何利用 `ensureServingAccess` 函数中的解析缺陷绕过限制。漏洞根源在于 Vite 对查询字符串（Query String）的预处理逻辑：它会在执行路径白名单校验前尝试规范化或去除末尾的特殊字符（如 `?`）。攻击者通过构造带有重复或畸形查询分隔符（如 `?raw??` 或 `?import&raw??`）的 HTTP GET 请求，可以使内部正则匹配失效，导致请求被错误地识别为合法访问，从而读取服务器上本应受保护的任意文件（如 `/etc/passwd`）。此 POC 代码逻辑清晰，直接针对 Vite 开发服务器的默认端口（5173）进行测试，成功率极高，且不需要任何身份验证。利用步骤：1. 识别运行中的 Vite 开发服务器。2. 构造包含路径穿越序列和特定查询参数的 URL，例如 `http://target:5173/@fs/etc/passwd?raw??`。3. 发送 HTTP GET 请求。4. 接收并读取响应包中的文件内容。投毒风险分析：该 POC 脚本主要依赖 Python 3 标准库（如 `requests` 或 `urllib`），代码结构透明，没有明显的混淆手段或恶意的二进制 Payload。但在威胁情报防御视角下，仍需注意两点：第一，脚本中可能包含硬编码的远程回调地址（用于统计利用成功率），虽不直接构成主机权限丢失，但会泄露扫描者的 IP 及目标信息；第二，部分开源 POC 仓库可能会在 `requirements.txt` 中引入带毒的第三方依赖。当前分析的 POC 代码片段侧重于核心利用逻辑，未发现明显的后门植入行为，整体风险等级较低。防御建议：组织应确保开发环境不在公网暴露，并立即升级 Vite 到官方发布的修复版本。由于该漏洞影响范围涵盖了从 v4 到 v6 的多个主流分支，修复工作具有紧迫性。

**项目地址:** [https://4xura.com/web/vite-arbitrary-file-read-via-improper-query-sanitization-in-fs-route-cve-2025-30208/](https://4xura.com/web/vite-arbitrary-file-read-via-improper-query-sanitization-in-fs-route-cve-2025-30208/)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-30208](https://nvd.nist.gov/vuln/detail/CVE-2025-30208)
