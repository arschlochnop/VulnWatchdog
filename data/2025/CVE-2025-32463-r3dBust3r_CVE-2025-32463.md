## CVE-2025-32463 - Sudo 本地提权 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (LPE)

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 1.9.14 至 1.9.17 (低于 1.9.17p1)

**利用条件:** 具有本地普通用户访问权限，目标系统安装了受影响版本的 Sudo

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

【POC有效性分析】该POC代码是一个高度完整的本地提权利用脚本，其核心逻辑在于利用Sudo在处理chroot选项（-R 或 --chroot）时的实现缺陷。从代码分析来看，有效性极高：1. 环境准备：脚本通过mktemp创建临时工作目录，并构建了一个精简的chroot根目录结构（包含etc和libnss_子目录）。2. 配置文件劫持：通过向临时目录下的etc/nsswitch.conf写入自定义配置，指示系统从非标准路径加载NSS库。3. 恶意共享库编译：脚本包含一段C代码，利用__attribute__((constructor))属性定义了一个构造函数woot()。该函数在库加载时会自动执行，调用setreuid(0,0)和setregid(0,0)尝试获取root标识，并执行/bin/bash。4. 漏洞触发：最后一行执行命令`sudo -R woot woot`，这是触发漏洞的关键。当Sudo尝试切换到指定的chroot环境（woot目录）时，由于1.9.14版本后的代码在处理chroot逻辑中对/etc/nsswitch.conf及其对应的共享库搜索路径处理不当，导致其在提权后、限制权限前加载了位于用户受控目录下的恶意libnss_woot.so.2。由于此时程序已经具备高权限，加载的恶意代码将直接获取root Shell。该POC流程清晰，符合公开披露的漏洞原理，且具备实战化的自动化执行能力。【利用步骤】1. 本地普通用户登录系统。2. 确认Sudo版本在1.9.14至1.9.17之间。3. 将脚本内容保存为exploit.sh并赋予执行权限。4. 运行脚本，脚本将自动创建临时chroot环境，编译包含提权逻辑的动态链接库。5. 脚本调用sudo -R，通过劫持nsswitch配置诱导Sudo加载恶意库，最终弹回root权限的Shell。【投毒风险分析】该POC代码投毒风险极低，属于典型的安全研究及PoC验证脚本。分析依据如下：1. 透明度：脚本完全由易于阅读的Bash命令和简单的C源码组成，没有任何二进制黑盒组件。2. 网络行为：脚本不包含任何curl、wget或反弹Shell到外部IP的指令，所有操作均在本地临时目录完成。3. 逻辑清晰：代码逻辑直接对应CVE-2025-32463的漏洞特征（chroot下的NSS加载问题），没有冗余或隐藏的混淆指令。4. 临时性：脚本使用了mktemp，在运行后可以通过清理临时目录消除痕迹。5. 后门检测：C代码中虽然有提权操作，但那是提权POC的必要核心逻辑，目的是将当前进程提升为root bash，而非在系统中安装隐蔽的持久化后门或窃取凭据。整体来看，该脚本是一个纯粹的漏洞验证工具，不具备投毒特征，对研究人员而言是安全的。

**项目地址:** [https://www.exploit-db.com/exploits/52352](https://www.exploit-db.com/exploits/52352)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
