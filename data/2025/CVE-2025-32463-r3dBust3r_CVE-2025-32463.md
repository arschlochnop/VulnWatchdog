## CVE-2025-32463 - Sudo 本地提权 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (LPE)

**影响应用:** Sudo

**危害等级:** 高危 (Critical)

**CVSS评分:** 9.3

**影响版本:** 1.9.14 至 1.9.17 (不含 1.9.17p1)

**利用条件:** 本地普通用户访问权限，系统中安装了受影响版本的sudo且未禁用-R (chroot) 选项。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

【POC有效性分析】该POC代码是一个高度自动化的Bash脚本，利用了Sudo在处理--chroot (-R) 选项时的实现缺陷。该漏洞的核心在于Sudo在切换至chroot环境后，未正确隔离或校验NSS（Name Service Switch）配置文件的加载路径。POC通过创建一个伪造的chroot目录，并在其中构造恶意的/etc/nsswitch.conf文件，指向攻击者预先编译好的恶意共享库libnss_woot.so.2。当执行'sudo -R woot woot'时，sudo会以root权限进入该目录并尝试解析用户/组信息，此时会根据伪造的nsswitch.conf加载恶意库。恶意库中的__attribute__((constructor))构造函数会在加载瞬间执行，调用setreuid(0,0)提升进程权限并弹出root shell。经分析，该代码逻辑严密，路径处理准确，直接针对Sudo 1.9.14+引入的新特性进行攻击，具有极高的实战有效性，在标准Ubuntu环境中可实现秒级提权。

【利用步骤】1. 准备环境：在本地创建一个临时工作目录（如/tmp/sudo.woot.xxxx）。2. 编写Payload：编写一个C语言源文件，使用构造函数定义提权逻辑（setreuid/setregid为0并执行/bin/bash）。3. 构造伪装根目录：在临时目录下创建woot/etc等目录结构。4. 配置NSS劫持：在woot/etc/nsswitch.conf中写入‘passwd: /woot’，迫使sudo在解析用户时寻找名为libnss_/woot.so.2的动态库。5. 编译与部署：使用gcc编译成共享库，并放置在预定路径下。6. 触发漏洞：执行命令‘sudo -R woot woot’。由于sudo -R会切换根目录到指定的woot文件夹并保持root身份运行解析逻辑，系统将加载恶意库并返回root shell。

【投毒风险分析】该POC脚本表现出极高的透明度和纯粹的防御研究目的，投毒风险极低。首先，脚本逻辑完全公开，没有任何形式的代码混淆或Base64加密处理，所有操作如创建目录、写入文件、调用gcc等均一目了然。其次，脚本未包含任何外部网络请求（如curl或wget下载远程负载），所有攻击载荷均在本地即时生成，避免了供应链污染。再者，脚本虽然实现了提权逻辑，但其目的明确指向漏洞验证，且在README中附带了详尽的免责声明和法律警告。代码中的提权行为（exec /bin/bash）是LPE漏洞PoC的标准行为，不应被视为恶意投毒。唯一的潜在风险点在于用户需确保在受控环境中运行，因为该脚本会创建临时文件，若在生产环境直接运行可能留下痕迹，但这属于安全测试规范范畴而非恶意投毒。整体代码符合威胁情报团队对高质量、低风险PoC的定义。

**项目地址:** [https://www.exploit-db.com/exploits/52352](https://www.exploit-db.com/exploits/52352)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
