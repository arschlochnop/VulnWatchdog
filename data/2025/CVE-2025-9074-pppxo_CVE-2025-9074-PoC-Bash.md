## CVE-2025-9074 - Docker Desktop (Windows & macOS) 未授权访问/越权访问 (Broken Access Control)

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 未授权访问/越权访问 (Broken Access Control)

**影响应用:** Docker Desktop (Windows & macOS)

**危害等级:** CRITICAL

**CVSS评分:** 9.3

**影响版本:** < 4.44.3

**利用条件:** 攻击者需在受影响的宿主机上运行一个恶意的 Linux 容器；无需身份验证即可通过默认子网访问宿主机 Docker Engine API。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

【POC有效性分析】该漏洞源于 Docker Desktop 在 Windows 和 macOS 平台上的网络隔离机制缺陷。在默认配置下，宿主机上的 Docker Engine API 监听在特定的内部子网地址（通常为 192.168.65.7:2375），且未开启身份验证。本 POC（cve-2025-9074-poc.sh）通过简单的 Bash 脚本利用该缺陷。首先，脚本在容器内部探测 2375 端口的开放情况。一旦确认连通性，它通过标准 HTTP API 调用执行四个关键步骤：1. 创建容器：构造一个带有恶意 HostConfig 的 POST 请求，其核心在于 'Binds':['/mnt/host/c:/host_root']。这一步利用了 Docker Engine API 的权限，将宿主机的 C 盘根目录挂载到新创建容器的目录中。2. 启动容器：激活该新容器并执行指定的 shell 命令。3. 日志获取：通过 API 获取执行结果，从而实现对宿主机敏感文件的读取或命令回显。4. 清理痕迹：通过 DELETE 请求删除中间容器。该 POC 代码逻辑严密，利用了 Docker 标准 API，不依赖复杂的 Exploit 载荷，在存在漏洞的环境中具有极高的成功率。由于其采用 Bash 编写且仅依赖 curl，极大降低了在精简版 Linux 镜像（如 Alpine）中的利用门槛，证明了漏洞的严重性，即任何本地容器都可能沦为接管宿主机的跳板。

【利用步骤】1. 在 Docker Desktop 容器内运行环境，使用探测循环（for ip in ...）检查 192.168.65.7:2375 是否可达。2. 准备 cve-2025-9074-poc.sh 脚本，并赋予执行权限。3. 运行脚本并指定目标 IP（192.168.65.7）、端口（2375）以及希望在宿主机环境执行的命令（如 'cat /host_root/Users/Admin/secrets.txt'）。4. 脚本会自动向 API 发送创建请求，配置目录挂载参数。5. 脚本启动容器并自动捕获 stdout 输出。6. 脚本执行清理操作，删除用于攻击的临时容器实例。

【投毒风险分析】该 POC 代码具有较低的投毒风险。分析其脚本内容：代码主要使用标准的系统变量（IP, PORT, CMD）和通用的 curl 命令与 Docker Engine API 交互。未发现混淆代码、Base64 加密的未知载荷或对外部第三方服务器的非法连接（除了目标 API 地址）。脚本逻辑透明，步骤清晰（Create, Start, Logs, Stop, Delete），完全符合安全研究中概念验证的定义。唯一潜在的风险点在于用户在使用脚本时，如果不加检查地传入 CMD 参数，可能会对自身系统造成误操作。此外，虽然 POC 指向的 GitHub 项目（j3r1ch0123）是该漏洞的已知来源，但建议研究人员在下载此类脚本时，务必检查其是否包含针对执行者环境的恶意命令劫持。目前的 Bash 版本相比原版 Python 版本更易于审计，没有引入隐藏的后门逻辑，属于高度可信的防御性研究样本。

**项目地址:** [https://github.com/j3r1ch0123/CVE-2025-9074](https://github.com/j3r1ch0123/CVE-2025-9074)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-9074](https://nvd.nist.gov/vuln/detail/CVE-2025-9074)
