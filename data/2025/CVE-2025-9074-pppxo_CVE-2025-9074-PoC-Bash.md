## CVE-2025-9074 - Docker Desktop (Windows & macOS) 未授权访问/容器逃逸

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 未授权访问/容器逃逸

**影响应用:** Docker Desktop (Windows & macOS)

**危害等级:** 关键 (Critical)

**CVSS评分:** 9.3

**影响版本:** Docker Desktop 4.34 之前的版本

**利用条件:** 攻击者需在本地 Linux 容器内拥有执行权限，且 Docker Desktop 配置了默认的子网接口（如 192.168.65.7）

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：本漏洞源于 Docker Desktop 内部通信机制的安全缺陷。在受影响的版本中，Docker Desktop 暴露了 Docker Engine API（通常在 192.168.65.7:2375），本意是供宿主机内部组件通信，但由于隔离机制不完善，导致在 Docker 环境中运行的普通 Linux 容器能够直接通过网络请求访问该 API。提供的 Bash POC 代码非常简洁高效，具有极高的实战价值。利用步骤分为四个核心环节：1. 环境探测：利用 Bash 的内建 /dev/tcp 协议栈扫描常见的网关 IP 和已知 API 接口（如 192.168.65.7:2375），确认接口是否开放；2. 容器创建：一旦发现接口可访问，通过 API 发送 POST 请求创建一个新的 Alpine 镜像容器。该步骤的关键在于 'HostConfig' 中的 'Binds' 参数，POC 将宿主机的 C 盘根目录（/mnt/host/c）挂载到了新容器的 /host_root 目录，这是实现逃逸的关键；3. 触发利用：启动该特权容器并执行用户定义的命令，此时由于新容器具备宿主机文件系统权限，攻击者可直接读取或修改宿主机敏感文件；4. 清理痕迹：通过 API 停止并删除创建的恶意容器，整个过程仅需 curl 和 bash，无需任何外部依赖。经过分析，该 POC 逻辑清晰，完全符合 Docker Engine API 的标准交互流程，只要目标版本处于受影响范围且未进行加固，成功率接近 100%。

投毒风险分析：该 POC 代码表现出极高的透明度和安全性，投毒风险极低（约 10%）。代码逻辑完全由基础的 Linux shell 命令和标准 curl 调用组成，没有经过任何形式的混淆（如 Base64 编码、Hex 转义或隐藏脚本执行）。脚本中所有执行的操作均针对指定的 $IP 和 $PORT 进行，不存在向第三方恶意服务器发送敏感数据（如宿主机密钥、环境变量等）的隐蔽行为。其 README 文件明确引用了原始研究来源，并解释了从 Python 版本重写为 Bash 版本是为了提高在受限容器环境下的兼容性。唯一的潜在风险点在于用户在使用脚本时，可能会由于误操作导致宿主机文件系统被篡改，但这属于漏洞利用本身的破坏性，而非脚本作者植入的恶意后门。在防御性研究过程中，可以直接通过阅读代码逻辑来确认其安全性。建议安全从业者在受控隔离环境中使用该 POC 进行漏洞复现，以验证组织的防御体系（如防火墙规则或 Docker 升级补丁）是否生效。脚本清理逻辑完善，在执行完攻击指令后会主动删除痕迹，这体现了其作为工具的专业性，但也提醒研究人员在使用时需注意备份相关日志以供取证分析。

**项目地址:** [https://github.com/j3r1ch0123/CVE-2025-9074](https://github.com/j3r1ch0123/CVE-2025-9074)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-9074](https://nvd.nist.gov/vuln/detail/CVE-2025-9074)
