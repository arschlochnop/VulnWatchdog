## CVE-2025-9074 - Docker Desktop 容器逃逸/权限提升/未授权访问

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸/权限提升/未授权访问

**影响应用:** Docker Desktop

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** Docker Desktop < 4.44.3 (适用于Windows和macOS)

**利用条件:** 本地运行恶意Linux容器，并通过默认子网访问Docker Engine API，不依赖挂载

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-9074是一个影响Docker Desktop应用程序的严重安全漏洞，该应用程序主要用于在Windows和macOS系统上运行和管理Linux容器。该漏洞的CVSS评分为9.3（高危），允许本地运行的恶意Linux容器绕过隔离机制，通过默认子网（如192.168.65.7:2375）直接访问宿主机上的Docker Engine API。这种未授权访问使得攻击者能够执行特权操作，例如创建具有主机文件系统挂载权限的新容器，从而实现容器逃逸并完全控制宿主操作系统。此漏洞不依赖于预先存在的挂载配置，而是利用了Docker Desktop内部网络配置中对Docker Engine API的默认暴露。受影响的版本是Docker Desktop 4.44.3之前的版本，Docker已于2025年8月20日在4.44.3版本中修复此漏洞。

所提供的POC代码是一个bash脚本（`cve-2025-9074-poc.sh`），它提供了一个完整且功能强大的利用示例，展示了如何通过该漏洞实现主机接管。该POC首先尝试发现可访问的Docker API接口（例如172.18.0.1、172.17.0.1、192.168.65.7的2375端口）。一旦找到，它将利用`curl`命令向目标Docker Engine API发送请求，执行以下四个核心步骤：
1.  **创建容器**：通过调用`/containers/create` API，使用`alpine`镜像创建一个新容器。关键在于`HostConfig`中的`Binds`配置，它将宿主机的C盘（`/mnt/host/c`，通常用于Windows系统，该POC的示例图片也显示为Windows C盘）挂载到容器内部的`/host_root`目录。同时，它还会设置一个通过`CMD`参数传入的任意命令在容器启动时执行。
2.  **启动容器**：调用`/containers/$ID/start` API启动新创建的容器。
3.  **获取日志**：调用`/containers/$ID/logs` API获取容器的输出日志，以便攻击者查看其执行命令的结果。
4.  **清理**：停止并删除所创建的容器及其镜像，以清除攻击痕迹。
通过这种方式，恶意容器能够利用Docker Engine API在宿主机上创建并运行一个特权容器，该容器拥有直接访问宿主机文件系统的能力，并能执行任意命令。POC代码清晰、简洁，直接展示了漏洞的危害。

**利用步骤**：
1.  确保已在一个Docker Desktop环境中运行的Linux容器内部拥有命令行访问权限。
2.  在容器内部，运行以下命令探测可用的Docker API接口：
    `for ip in 172.18.0.1 172.17.0.1 192.168.65.7; do (echo > /dev/tcp/$ip/2375 2>/dev/null && echo "[+] $ip:2375 open") || :; done`
    这将识别出宿主机上暴露的Docker API服务的IP地址和端口。
3.  下载并执行POC脚本。假设检测到的IP和端口为`<IP>`和`<PORT>`，并希望在宿主机上执行`ls /host_root/`（列出宿主机C盘根目录的内容），则运行：
    `./cve-2025-9074-poc.sh <IP> <PORT> "ls /host_root/"`
    脚本将输出命令执行的结果，从而证明宿主机文件系统已被成功访问。

**投毒风险分析**：
该POC代码的投毒风险极低（10%）。代码逻辑清晰，主要使用了标准的`curl`命令与Docker Engine API进行交互，没有发现任何混淆、加密、外部可疑链接或下载恶意负载的行为。脚本的目的是纯粹地演示如何利用CVE-2025-9074漏洞，即在容器内部通过未授权的Docker API访问来创建特权容器并挂载宿主机文件系统。虽然攻击者可以利用POC的`CMD`参数注入恶意命令（例如，下载并执行恶意脚本、部署后门等），但这种恶意行为是由POC的执行者决定的，而不是POC脚本本身内嵌的恶意逻辑。POC本身不包含任何后门或植入恶意代码的功能，其设计符合合法安全研究中概念验证工具的范畴。因此，从POC代码本身的安全性角度来看，其投毒风险非常低。

**项目地址:** https://github.com/j3r1ch0123/CVE-2025-9074

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-9074
