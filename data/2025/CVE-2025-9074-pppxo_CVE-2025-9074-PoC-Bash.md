## CVE-2025-9074 - Docker Desktop 容器逃逸/权限提升

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸/权限提升

**影响应用:** Docker Desktop

**危害等级:** 严重

**CVSS评分:** 9.3

**影响版本:** 4.44.3之前的版本

**利用条件:** 本地运行的Linux容器内执行代码，无需认证

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-9074是Docker Desktop（Windows/macOS）中的一个容器逃逸漏洞。该漏洞允许在本地运行的恶意Linux容器绕过隔离机制，通过默认子网（如192.168.65.7:2375）直接访问Docker Engine API，从而获得对宿主机系统的完全控制。此漏洞不依赖挂载Docker socket，也不受“Expose daemon on tcp://localhost:2375 without TLS”设置的影响。该漏洞的CVSS评分为9.3（严重），已在Docker Desktop 4.44.3版本（2025年8月20日发布）中修复，影响此版本之前的所有版本。
POC有效性分析：提供的PoC代码`cve-2025-9074-poc.sh`是一个功能完整且文档清晰的Bash脚本。它首先通过扫描常见子网（如192.168.65.7:2375）来探测可访问的Docker Engine API。一旦发现，脚本便利用`curl`工具与API进行交互，创建一个新的`alpine`容器。关键步骤在于，新创建的容器会挂载宿主机的C盘（`/mnt/host/c`）到容器内部的`/host_root`目录，实现宿主机文件系统的访问。随后，脚本会在该容器内执行用户指定的任意命令，获取其输出，并最终清理（停止并删除）创建的容器。此过程清晰地演示了如何从容器内部逃逸并获得对宿主机的任意命令执行能力，从而实现完全的系统控制。
利用步骤：
1. 攻击者已在Docker Desktop上运行的某个Linux容器中获得代码执行能力。
2. 在该容器内部，攻击者运行PoC提供的扫描命令（`for ip in ...`）以发现Docker Engine API的实际IP和端口（通常是`192.168.65.7:2375`）。
3. 执行`./cve-2025-9074-poc.sh <Docker API IP> <Docker API Port> <要执行的宿主机命令>`。例如，`./cve-2025-9074-poc.sh 192.168.65.7 2375 "ls -la /host_root/Users/"`以列出宿主机用户目录。
4. 脚本将自动创建、启动容器，执行命令，并显示宿主机命令的输出结果，确认漏洞利用成功。

**项目地址:** https://github.com/j3r1ch0123/CVE-2025-9074

**漏洞详情:** https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-9074
