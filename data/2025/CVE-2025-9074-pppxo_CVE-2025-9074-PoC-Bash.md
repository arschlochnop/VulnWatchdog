## CVE-2025-9074 - Docker Desktop 容器逃逸/越权访问

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸/越权访问

**影响应用:** Docker Desktop

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** 小于 4.44.3

**利用条件:** 需要本地运行恶意容器，且恶意容器可访问Docker Engine API（默认子网如192.168.65.7:2375），无需额外认证。

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10

## 详情

CVE-2025-9074是一个针对Docker Desktop应用程序的容器逃逸和越权访问漏洞，严重影响了在Windows和macOS系统上运行的Docker环境。该漏洞允许一个本地运行的恶意Linux容器，绕过其设计上的隔离机制，通过默认子网（如192.168.65.7:2375）直接访问并操作宿主机的Docker Engine API。这意味着攻击者可以从容器内部获取对宿主机的完全控制权，执行任意命令、访问敏感文件或植入恶意软件。根据公开信息，该漏洞的CVSSv3评分为9.3（满分10分），被认定为高危甚至关键级别的安全威胁。Docker官方已于2025年8月20日在Docker Desktop 4.44.3版本中发布了修复程序，因此所有低于此版本的Docker Desktop用户均受影响，应尽快升级以防范潜在攻击。此漏洞的发现凸显了容器化环境中“本地”攻击面的重要性，即使容器本身被视为隔离的，其与宿主机接口的交互也可能成为突破口。

**POC有效性分析**:
提供的POC代码是一个名为`cve-2025-9074-poc.sh`的bash脚本，其功能和逻辑非常清晰，是一个完整且高度有效的利用工具。该脚本首先执行了一个端口扫描，探测常见的Docker Engine API默认子网IP（如172.18.0.1, 172.17.0.1, 192.168.65.7）上2375端口的可达性，以确认是否存在可利用的API端点。一旦找到可用的API，脚本便利用`curl`命令向Docker Engine API的`/containers/create`接口发送HTTP POST请求。此请求的核心部分在于`HostConfig":{"Binds":["/mnt/host/c:/host_root"]}`。在Windows系统上，这会将宿主机的C盘挂载到新创建的容器内部的`/host_root`目录；而在macOS上，它通常是指向主机根目录的特定路径，或根据POC作者的习惯命名。通过这种方式，恶意容器获得了对宿主机文件系统的直接读写权限。接着，脚本会启动这个新创建的容器，并在容器内执行由攻击者在命令行中指定的任意命令（`Cmd":["sh","-c","'"$CMD"'"]`）。执行命令后，脚本还会获取容器的执行日志，最后为了清理痕迹，会自动停止并删除该容器。从整个流程来看，该POC完整地演示了从容器内部实现宿主机文件系统访问和任意命令执行，充分验证了CVE-2025-9074漏洞的危害性。其直接利用Docker API的特性，绕过了容器隔离，实现了对宿主机的接管，因此是高度有效和可靠的。

**利用步骤**:
1.  **前提条件**: 攻击者首先需要获得在受影响的Docker Desktop环境中，运行一个Linux容器的权限。这可以通过多种方式实现，例如通过一个受感染的应用程序、一个有漏洞的Web服务，或者直接通过在开发环境中运行恶意镜像。
2.  **探测Docker API**: 在恶意容器内部，攻击者可以运行POC README中提供的探测命令，以确定Docker Engine API的准确IP地址和端口。例如：`for ip in 172.18.0.1 172.17.0.1 192.168.65.7; do (echo > /dev/tcp/$ip/2375 2>/dev/null && echo "[+] $ip:2375 open") || : done`。通常，默认端口是2375。
3.  **下载并执行POC脚本**: 将`cve-2025-9074-poc.sh`脚本下载到恶意容器内部。
4.  **发起攻击**: 执行POC脚本，提供探测到的Docker API的IP地址、端口和希望在宿主机上执行的命令。例如，要列出Windows宿主机C盘根目录的内容，可以执行：`./cve-2025-9074-poc.sh 192.168.65.7 2375 "ls /host_root"`。
5.  **命令执行与数据窃取**: 攻击者可以通过`CMD`参数执行各种恶意操作，包括但不限于：读取宿主机的敏感文件，如配置文件、凭据文件（例如`/host_root/Users/<username>/AppData/Roaming/Docker/settings.json`或SSH密钥）；通过写入计划任务或启动项来建立持久化后门；下载并执行宿主机上的恶意二进制文件；查看宿主机的用户列表、网络配置等系统信息。
6.  **结果获取与清理**: POC脚本在执行完命令后，会获取容器的日志，其中包含了命令的输出结果。随后，脚本会自动停止并删除为此次攻击创建的临时容器，以减少被发现的风险。

**投毒风险分析**:
针对`cve-2025-9074-poc.sh`这份POC代码进行分析，其投毒风险被评估为极低，具体百分比为10%。主要原因如下：
首先，该POC是一个简洁的bash脚本，代码完全公开且未经过任何形式的混淆处理。代码的每一行都易于阅读和理解，其操作逻辑清晰地展示了如何利用Docker Engine API来创建、启动和管理容器，并实现宿主机文件系统的挂载和命令执行。
其次，脚本中所有网络请求都明确地使用了`curl`命令，且目标IP和端口均由用户在命令行参数中指定，没有硬编码任何外部恶意服务器地址。脚本也未包含任何从外部URL下载并执行代码（如`wget | bash`或`curl | sh`）的行为。
再者，该POC主要利用了Linux系统和Docker提供的标准工具和接口，如`echo`、`/dev/tcp`（用于端口探测）、`curl`和Docker Engine API。没有发现使用任何非标准库、加密通信或难以理解的复杂算法。脚本的核心功能是创建一个带有特定绑定挂载的新容器，并在其中执行用户指定的命令。
最后，脚本中没有发现任何试图窃取用户数据、植入后门、进行加密货币挖矿或其他恶意负载的代码。它专注于证明和利用容器逃逸这一漏洞，用户的攻击意图完全体现在`CMD`参数上。因此，作为防御性安全研究或漏洞验证工具，该POC可以被认为是安全的，不会自带额外的“投毒”风险。用户在使用时只需确保对传递给`CMD`参数的命令有清晰的理解和控制即可。

**项目地址:** https://github.com/j3r1ch0123/CVE-2025-9074

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-9074
