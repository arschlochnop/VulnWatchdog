## CVE-2025-9074 - Docker Desktop (Windows和macOS) 容器逃逸/权限提升/远程代码执行

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸/权限提升/远程代码执行

**影响应用:** Docker Desktop (Windows和macOS)

**危害等级:** 高危 (CVSS 9.3)

**CVSS评分:** 9.3

**影响版本:** Docker Desktop版本低于4.44.3 (Windows和macOS)

**利用条件:** 需要从本地运行的恶意Linux容器内部进行攻击；恶意容器需能通过本地子网访问Docker Engine API (如192.168.65.7:2375)；API访问无需认证；攻击不依赖特殊挂载。

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-9074是一个影响Docker官方桌面端应用Docker Desktop的容器越权访问漏洞，主要存在于Windows和macOS系统上。该漏洞的严重评分为9.3分（满分10分），被归类为高危漏洞。它允许在本地运行的恶意Linux容器绕过Docker的隔离机制，通过默认或配置的本地子网（例如192.168.65.7:2375）直接访问Docker Engine API。由于此API未经验证即可访问，攻击者可以利用这一缺陷在宿主机上执行未授权操作，从而实现容器逃逸、权限提升，并最终完全控制宿主机系统。该漏洞已于2025年8月20日在Docker Desktop 4.44.3版本中得到修复，因此所有早于此版本的Docker Desktop都受到影响。

**POC有效性分析**
所提供的Bash PoC脚本`cve-2025-9074-poc.sh`是一个高度有效且功能完整的漏洞利用工具，它清晰地演示了CVE-2025-9074的完整影响。该脚本利用`curl`命令直接与未受保护的Docker Engine API进行交互，以实现其恶意目的。其核心利用在于通过`containers/create` API端点创建一个新的Docker容器，并在创建时特别配置了`HostConfig:{"Binds":["/mnt/host/c:/host_root"]}`参数。这一关键步骤使得宿主机的C盘（对于Windows系统）被完整地挂载到新创建容器内的`/host_root`目录。这直接绕过了容器原有的隔离限制，赋予了攻击者对宿主机文件系统的完全读写权限。随后，脚本在新容器中执行由攻击者指定的任意命令（`$CMD`），例如读取敏感的宿主机文件、修改系统配置或部署持久化后门。PoC通过获取容器的日志来确认命令的执行结果，最后执行清理工作，停止并删除临时容器。整个过程简洁明了，无需复杂的依赖，直接展示了从容器内部实现容器逃逸、权限提升并最终在宿主机上执行任意代码的能力。脚本的可靠性和直接性使其成为一个非常强大的概念验证和利用工具。

**利用步骤**
1.  **初始立足点**：攻击者首先需要在运行Docker Desktop的Windows或macOS宿主机上获得一个运行中的Linux容器的访问权限。这可能通过利用容器内运行的应用程序漏洞、容器配置错误允许命令注入，或者通过诱导用户运行一个恶意容器镜像来实现。
2.  **发现Docker API端点**：在已受控的容器内部，攻击者使用PoC中提供的网络扫描命令（如`for ip in 172.18.0.1 172.17.0.1 192.168.65.7; do (echo > /dev/tcp/$ip/2375 2>/dev/null && echo "[+] $ip:2375 open") || :; done`）来探测本地子网中开放的Docker Engine API端口（默认为2375）。通常，Docker Desktop会在特定的内部子网上暴露此API。
3.  **执行PoC脚本**：一旦确定了可用的Docker API端点（IP和端口），攻击者将上传并执行PoC脚本`cve-2025-9074-poc.sh`，并提供目标IP、端口以及要在宿主机上执行的命令。例如：`./cve-2025-9074-poc.sh 192.168.65.7 2375 "cat /host_root/Users/Public/Desktop/sensitive_file.txt"`，或者`"cmd.exe /c type C:\Windows\System32\config\SAM"`用于Windows系统。
4.  **宿主机系统攻陷**：PoC脚本将按以下流程执行：
    *   向Docker Engine API发送请求，创建一个新的`alpine`容器。
    *   在创建容器时，通过`HostConfig`参数将宿主机的C盘（或macOS上的对应根目录）挂载到容器内的`/host_root`路径。
    *   启动该容器并执行预设的命令`$CMD`。
    *   获取并显示命令的执行日志，从而将宿主机上的敏感信息暴露给攻击者。
    *   最后，脚本将停止并删除为利用目的而创建的临时容器。
5.  **后续攻击**：通过这种方式，攻击者可以读取宿主机上的任意文件、写入恶意文件、创建新的用户账户、安装持久化后门或执行其他任意系统命令，从而实现对Docker Desktop宿主机的完全控制。

**投毒风险分析**
对`cve-2025-9074-poc.sh`脚本的分析表明，其投毒风险极低，估计为10%。该脚本采用清晰的Bash语言编写，代码逻辑直观，没有任何形式的混淆、加密或不透明的二进制组件。脚本仅依赖标准的Unix/Linux命令，如`echo`、`curl`、`grep`和`sleep`，这些都是操作系统自带的常用工具，不存在引入外部恶意依赖的风险。脚本的核心功能是通过`curl`命令与Docker Engine API进行直接交互，旨在演示漏洞的利用流程，而不是偷偷执行其他恶意操作。脚本中没有任何迹象表明存在收集用户信息、回传数据到未知服务器、下载并执行第三方恶意代码或试图建立非授权持久化机制的代码。脚本本身不包含任何隐藏的恶意负载；所有对宿主机造成的“恶意”行为（例如读取文件或执行命令）都完全由用户通过`$CMD`参数显式控制，是漏洞验证的预期结果，而非PoC作者暗中植入。虽然脚本确实挂载了宿主机的C盘，但这是为了证明容器逃逸和宿主机文件系统访问的核心漏洞能力，并非附加的恶意行为。因此，对于安全研究人员或测试人员而言，在使用此PoC进行合法安全评估时，其自带的恶意代码风险微乎其微。尽管如此，始终建议用户从官方或信任的来源获取PoC代码，并在执行前仔细审查其内容。

**项目地址:** https://github.com/j3r1ch0123/CVE-2025-9074

**漏洞详情:** https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-9074
