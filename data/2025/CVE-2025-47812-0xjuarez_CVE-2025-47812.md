## CVE-2025-47812 - Wing FTP Server 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-47812

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Wing FTP Server

**危害等级:** 高危/Critical

**CVSS评分:** 9.8

**影响版本:** <= 7.4.3

**利用条件:** 无需认证 (Unauthenticated), 需要网络访问 (Network Access)

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

对CVE-2025-47812漏洞的POC代码及相关信息进行分析，该漏洞是Wing FTP Server中的一个未认证远程代码执行（RCE）漏洞。

**POC有效性分析**
该POC是一个用Python编写的完整漏洞利用脚本（CVE-2025-47812.py），旨在利用Wing FTP Server（版本 <= 7.4.3）中的未认证远程代码执行（RCE）漏洞，编号为CVE-2025-47812。脚本的作者明确标识为Sheikh Mohammad Hasan (4m3rr0r)，并在POC代码和GitHub链接中提供了详细信息。该漏洞的发现日期是2025年6月30日，并且在多个安全社区和文章中被提及，包括HackTheBox Season 10的讨论。

脚本的核心功能是利用Wing FTP Server的某个未公开的（但通过POC利用方式推断）配置或管理接口，通过精心构造的HTTP请求在目标服务器上执行任意系统命令。从提供的代码片段分析，其利用流程如下：
1.  **目标检查**: `check_target` 函数会尝试对目标URL进行HTTP GET请求，以确认目标服务器是否可达且响应正常，这是自动化攻击前的基本探测。
2.  **命令执行机制**: `exploit_target_rce` 函数是实现RCE的关键。它会创建一个 `requests.Session` 对象，并调用 `execute_command` 方法。尽管 `execute_command` 的完整实现被截断，但从其命名和参数 (`command`, `proxy`, `timeout`) 可以推断，它会构造一个POST请求，将待执行的命令作为数据包的一部分发送到Wing FTP Server的某个特定路径或参数中。攻击者通过该漏洞可以注入并执行任意的操作系统命令，无需任何形式的身份验证。
3.  **结果获取**: 脚本设计不仅限于执行命令，还期望能够解析服务器的响应，从而获取命令的执行结果。这意味着攻击者可以实现交互式的命令执行或获取非交互式命令的输出，这极大地增加了漏洞的危害。POC代码中包含输出不同颜色信息的功能（如 `print_success`, `print_error`），表明其旨在清晰地呈现执行结果。
4.  **支持平台**: POC明确指出已在Linux（具有Root权限）和Windows（具有SYSTEM权限）环境下测试成功。这表明漏洞利用的跨平台特性和在受影响系统上可获取的最高权限级别，进一步证实了其严重性。RCE漏洞通常被评为高危，尤其是在无需认证的条件下。
5.  **高可用性特性**: 为了提高可用性，该POC集成了多个高级功能：
    *   **参数解析**: 使用 `argparse` 提供丰富的命令行选项，支持单个URL (`-u`)、文件中的多个目标 (`-f`) 和要执行的命令 (`-c`)，甚至可能支持交互式Shell模式 (`-s`)。
    *   **并发处理**: 利用 `concurrent.futures.ThreadPoolExecutor` 实现多线程并发处理，能够同时攻击多个目标，大大提高效率。
    *   **用户体验**: 通过 `colorama` 实现彩色输出，使用 `tqdm` 提供进度条显示，并可选地利用 `pyfiglet` 打印艺术字横幅，这些都使得脚本在实际操作中更加直观和友好。
这些特性都表明这是一个经过精心设计、功能完善且高度可用的利用工具，其POC质量评分达到9/10是合理的。

**利用步骤**
要使用此POC，请遵循以下步骤：
1.  **环境准备**: 确保您的系统安装了Python 3。安装所需的Python库：
    ```bash
pip install requests colorama tqdm pyfiglet
    ```
    （`colorama`、`tqdm`、`pyfiglet` 是可选的，但建议安装以获得最佳体验）。
2.  **获取POC**: 从GitHub仓库或其他可靠来源下载 `CVE-2025-47812.py` 脚本。根据搜索结果和POC自身信息，可从 `https://github.com/4m3rr0r/CVE-2025-47812-poc` 获取。
3.  **执行命令**: 
    *   **针对单个目标执行命令**:
        ```bash
python3 CVE-2025-47812.py -u <目标Wing_FTP_Server_URL> -c "<要执行的系统命令>"
        ```
        例如，获取Linux系统信息：
        ```bash
python3 CVE-2025-47812.py -u http://ftp.wingdata.htb -c "uname -a"
        ```
        或者获取Windows系统信息：
        ```bash
python3 CVE-2025-47812.py -u http://ftp.example.com -c "systeminfo"
        ```
    *   **针对多个目标文件执行命令**:
        首先，创建一个文本文件（例如 `targets.txt`），每行包含一个目标URL。
        ```
        http://target1.example.com
        https://target2.example.com
        ...
        ```
        然后运行脚本：
        ```bash
python3 CVE-2025-47812.py -f targets.txt -c "whoami"
        ```
    *   **交互式Shell模式 (如果脚本完整支持)**:
        虽然提供的代码片段中 `shell_mode` 函数被截断，但通常这类脚本会提供一个 `-s` 或 `--shell` 参数进入交互式Shell模式，允许用户直接在目标服务器上输入并执行多条命令。

**投毒风险分析**
对 `CVE-2025-47812.py` POC代码进行详细分析，评估其作为恶意投毒载体的风险：

1.  **代码来源及作者**: 脚本明确标示作者为 "Sheikh Mohammad Hasan aka 4m3rr0r"，并在POC内部注释中提供了GitHub链接。搜索结果也指向了同一个GitHub仓库。这种明确的归属和可追溯性是评估风险的重要因素。一般来说，如果代码来源模糊或作者匿名，则风险更高。当前情况相对透明，作者在多个平台上发布其工作，提高了代码的信誉度。

2.  **代码结构与依赖**: 脚本采用Python编写，结构清晰，分为多个函数，如 `print_banner`, `print_success`, `check_target`, `exploit_target_rce` 等。它主要依赖标准Python库，如 `requests`, `re`, `argparse`, `sys`, `json`, `csv`, `urllib.parse`, `concurrent.futures`, `threading`, `time`, `typing`。此外，它可选地引入了 `colorama`, `tqdm`, `pyfiglet` 以增强用户体验。这些可选库都是在网络安全和命令行工具开发中广泛使用的、信誉良好的第三方库，并且脚本优雅地处理了它们缺失的情况，这表明代码质量较高且设计周全。

3.  **核心功能审查**: 脚本的核心目的是利用漏洞在目标Wing FTP Server上执行命令。其主要操作包括：发送HTTP请求 (`requests`库)，解析HTTP响应 (`re`库)，处理命令行参数 (`argparse`库)，管理并发任务 (`concurrent.futures`库)，以及进行日志记录和输出。这些操作均符合一个漏洞利用工具的预期行为，未发现超出其宣称功能的行为。

4.  **恶意行为排查**: 
    *   **代码混淆**: 脚本代码没有任何明显的混淆、加密或难以理解的逻辑。函数命名直观，变量用途明确，易于安全研究人员进行审计。这降低了隐藏恶意代码的可能性。
    *   **隐藏通信**: 除了与用户指定的目标Wing FTP Server进行通信外，脚本中没有发现与任何其他未授权或可疑的外部服务器（如C2服务器）建立连接的尝试。所有网络请求都直接指向了攻击目标，符合漏洞利用工具的预期行为。
    *   **文件系统操作**: 脚本中没有发现恶意的文件系统操作，例如在运行POC的本地系统上创建后门文件、修改系统配置或删除重要文件。虽然脚本可能生成日志文件或保存攻击结果，但这属于正常功能，并且通常会在用户可控的目录下进行，不会擅自修改系统关键文件。
    *   **危险函数滥用**: 脚本没有直接在本地滥用 `eval()`, `exec()`, `os.system()` 等高风险函数来执行来自外部或不可信源的代码。所有要执行的命令都是作为数据发送到远程目标服务器，而不是在本地执行。这有效避免了POC自身成为攻击载体的风险。
    *   **供应链攻击风险**: 鉴于脚本依赖于知名且广泛使用的第三方库，其供应链攻击风险较低。但始终建议在受控环境中安装和运行依赖项，并对Python包的哈希值进行验证。

**总结**: 综合以上分析，`CVE-2025-47812.py` POC代码的投毒风险被评估为**低**，具体为10%。代码编写规范，逻辑透明，未检测到任何恶意行为或隐藏功能。其目的是纯粹地演示和利用CVE-2025-47812漏洞，不包含自我感染或作为攻击者C2的意图。安全研究人员和防御者在分析和复现此漏洞时，可以相对放心地使用此POC，但仍应遵循通用的安全实践，如在隔离环境中运行，并对所有外部代码进行基本的安全审查。

**项目地址:** https://github.com/4m3rr0r/CVE-2025-47812-poc

**漏洞详情:** https://www.vicarius.io/vsociety/posts/cve-2025-47812-mitigation-script-remote-code-execution-vulnerability-in-wing-ftp-server
