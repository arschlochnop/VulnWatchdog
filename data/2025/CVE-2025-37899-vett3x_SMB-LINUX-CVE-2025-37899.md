# CVE-2025-37899

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-37899-SeanHeelan_o3_finds_cve-2025-37899.md](../2025/CVE-2025-37899-SeanHeelan_o3_finds_cve-2025-37899.md)

## CVE-2025-37899 - Linux Kernel ksmbd use-after-free

**æ¼æ´ç¼–å·:** CVE-2025-37899

**æ¼æ´ç±»å‹:** Use-After-Free

**å½±å“åº”ç”¨:** Linux Kernel ksmbd

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ‹’ç»æœåŠ¡æˆ–ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 5.15 <= version < 6.12.28, 5.15 <= version < 6.14.6, 5.15 <= version < 6.15-rc5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å¯ç”¨ksmbdæœåŠ¡ï¼Œå¹¶é€šè¿‡SMBåè®®ä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹è¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-37899æ˜¯Linuxå†…æ ¸ksmbdæœåŠ¡ä¸­å‘ç°çš„use-after-freeæ¼æ´ï¼Œå­˜åœ¨äºä¼šè¯æ³¨é”€è¿‡ç¨‹ä¸­ã€‚

**æ¼æ´åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œæ¼æ´ä½äº`fs/smb/server/smb2pdu.c`æ–‡ä»¶ä¸­ã€‚å½“ä¼šè¯æ³¨é”€æ—¶ï¼Œ`sess->user`å¯¹è±¡å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹ä½¿ç”¨ï¼Œä¾‹å¦‚å¦ä¸€ä¸ªè¿æ¥å‘é€äº†ä¼šè¯è®¾ç½®è¯·æ±‚å¹¶ç»‘å®šåˆ°æ­£åœ¨é‡Šæ”¾çš„ä¼šè¯ã€‚å¦‚æœè¯¥è¿æ¥çš„å¤„ç†ç¨‹åºåœ¨`smb2_sess_setup`å‡½æ•°ä¸­ï¼Œåˆ™å¯èƒ½ä¼šä½¿ç”¨`sess->user`ï¼Œå¯¼è‡´use-after-freeã€‚

æ ¹æ®æä¾›çš„PoCä»£ç ï¼Œæ”»å‡»è€…åˆ©ç”¨krb5è®¤è¯æµç¨‹ä¸­çš„ä¸€ä¸ªç«äº‰æ¡ä»¶ã€‚åœ¨`krb5_authenticate`å‡½æ•°ä¸­ï¼Œå¦‚æœä¼šè¯æœ‰æ•ˆï¼Œ`sess->user`ä¼šè¢«æå‰é‡Šæ”¾ï¼Œç„¶åå°è¯•è¿›è¡Œkrb5è®¤è¯ã€‚å¦‚æœkrb5è®¤è¯å¤±è´¥ï¼Œ`sess->user`å°†ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œä½†ä¼šè¯ä»ç„¶å­˜åœ¨ï¼Œç•™ä¸‹æ‚¬æŒ‚æŒ‡é’ˆï¼Œå¯¼è‡´åç»­è®¿é—®è¯¥æŒ‡é’ˆæ—¶è§¦å‘use-after-freeæ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  åˆ©ç”¨PoCä¸­çš„krb5è®¤è¯æ–¹æ³•ï¼Œæ„é€ æ¶æ„çš„SMBè¯·æ±‚æ•°æ®åŒ…ï¼Œè§¦å‘`krb5_authenticate`å‡½æ•°ä¸­çš„æ¼æ´ä»£ç ã€‚
2.  å‘é€SMB2ä¼šè¯å»ºç«‹è¯·æ±‚ï¼Œè¿›è¡Œkrb5è®¤è¯ã€‚
3.  åœ¨`ksmbd_krb5_authenticate`å‡½æ•°ä¸­ï¼Œé€šè¿‡ç‰¹å®šçš„è¾“å…¥è§¦å‘è®¤è¯å¤±è´¥ï¼Œä¾‹å¦‚æä¾›æ— æ•ˆçš„SPNEGOä»¤ç‰Œæˆ–krb5ç¥¨æ®ã€‚
4.  è®¤è¯å¤±è´¥åï¼Œ`sess->user`ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œåç»­è®¿é—®è§¦å‘use-after-freeã€‚
5.  åˆ©ç”¨use-after-freeæ¼æ´ï¼Œæ§åˆ¶ç¨‹åºæ‰§è¡Œæµç¨‹æˆ–é€ æˆæ‹’ç»æœåŠ¡ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®åˆ†æå’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ï¼ŒPoCä»£ç éªŒè¯äº†æ­¤æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ä»£ç ä»“åº“ä¸»è¦åŒ…å«æ¼æ´åˆ†ææ–‡æ¡£ï¼Œauditè¯·æ±‚å’Œåˆ©ç”¨ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†ä½œè€…å¯èƒ½éšè—äº†æœªå…¬å¼€çš„åˆ©ç”¨æ–¹å¼ã€‚ç”±äºè¯¥PoCçš„ç›®çš„æ˜¯å±•ç¤ºæ¼æ´å‘ç°çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥å­˜åœ¨ä¸€å®šä½é£é™©çš„æŠ•æ¯’å¯èƒ½ï¼Œä½†æ¦‚ç‡è¾ƒä½ã€‚ è¯„ä¼°æŠ•æ¯’é£é™©ä¸º5%ã€‚


**é¡¹ç›®åœ°å€:** [SeanHeelan/o3_finds_cve-2025-37899](https://github.com/SeanHeelan/o3_finds_cve-2025-37899)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-37899](https://nvd.nist.gov/vuln/detail/CVE-2025-37899)

---

## POC #2

**æ¥æº**: [CVE-2025-37899-vett3x_SMB-LINUX-CVE-2025-37899.md](../2025/CVE-2025-37899-vett3x_SMB-LINUX-CVE-2025-37899.md)

# CVE-2025-37899

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-37899-SeanHeelan_o3_finds_cve-2025-37899.md](../2025/CVE-2025-37899-SeanHeelan_o3_finds_cve-2025-37899.md)

## CVE-2025-37899 - Linux Kernel ksmbd use-after-free

**æ¼æ´ç¼–å·:** CVE-2025-37899

**æ¼æ´ç±»å‹:** Use-After-Free

**å½±å“åº”ç”¨:** Linux Kernel ksmbd

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ‹’ç»æœåŠ¡æˆ–ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 5.15 <= version < 6.12.28, 5.15 <= version < 6.14.6, 5.15 <= version < 6.15-rc5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å¯ç”¨ksmbdæœåŠ¡ï¼Œå¹¶é€šè¿‡SMBåè®®ä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹è¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-37899æ˜¯Linuxå†…æ ¸ksmbdæœåŠ¡ä¸­å‘ç°çš„use-after-freeæ¼æ´ï¼Œå­˜åœ¨äºä¼šè¯æ³¨é”€è¿‡ç¨‹ä¸­ã€‚

**æ¼æ´åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œæ¼æ´ä½äº`fs/smb/server/smb2pdu.c`æ–‡ä»¶ä¸­ã€‚å½“ä¼šè¯æ³¨é”€æ—¶ï¼Œ`sess->user`å¯¹è±¡å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹ä½¿ç”¨ï¼Œä¾‹å¦‚å¦ä¸€ä¸ªè¿æ¥å‘é€äº†ä¼šè¯è®¾ç½®è¯·æ±‚å¹¶ç»‘å®šåˆ°æ­£åœ¨é‡Šæ”¾çš„ä¼šè¯ã€‚å¦‚æœè¯¥è¿æ¥çš„å¤„ç†ç¨‹åºåœ¨`smb2_sess_setup`å‡½æ•°ä¸­ï¼Œåˆ™å¯èƒ½ä¼šä½¿ç”¨`sess->user`ï¼Œå¯¼è‡´use-after-freeã€‚

æ ¹æ®æä¾›çš„PoCä»£ç ï¼Œæ”»å‡»è€…åˆ©ç”¨krb5è®¤è¯æµç¨‹ä¸­çš„ä¸€ä¸ªç«äº‰æ¡ä»¶ã€‚åœ¨`krb5_authenticate`å‡½æ•°ä¸­ï¼Œå¦‚æœä¼šè¯æœ‰æ•ˆï¼Œ`sess->user`ä¼šè¢«æå‰é‡Šæ”¾ï¼Œç„¶åå°è¯•è¿›è¡Œkrb5è®¤è¯ã€‚å¦‚æœkrb5è®¤è¯å¤±è´¥ï¼Œ`sess->user`å°†ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œä½†ä¼šè¯ä»ç„¶å­˜åœ¨ï¼Œç•™ä¸‹æ‚¬æŒ‚æŒ‡é’ˆï¼Œå¯¼è‡´åç»­è®¿é—®è¯¥æŒ‡é’ˆæ—¶è§¦å‘use-after-freeæ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  åˆ©ç”¨PoCä¸­çš„krb5è®¤è¯æ–¹æ³•ï¼Œæ„é€ æ¶æ„çš„SMBè¯·æ±‚æ•°æ®åŒ…ï¼Œè§¦å‘`krb5_authenticate`å‡½æ•°ä¸­çš„æ¼æ´ä»£ç ã€‚
2.  å‘é€SMB2ä¼šè¯å»ºç«‹è¯·æ±‚ï¼Œè¿›è¡Œkrb5è®¤è¯ã€‚
3.  åœ¨`ksmbd_krb5_authenticate`å‡½æ•°ä¸­ï¼Œé€šè¿‡ç‰¹å®šçš„è¾“å…¥è§¦å‘è®¤è¯å¤±è´¥ï¼Œä¾‹å¦‚æä¾›æ— æ•ˆçš„SPNEGOä»¤ç‰Œæˆ–krb5ç¥¨æ®ã€‚
4.  è®¤è¯å¤±è´¥åï¼Œ`sess->user`ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œåç»­è®¿é—®è§¦å‘use-after-freeã€‚
5.  åˆ©ç”¨use-after-freeæ¼æ´ï¼Œæ§åˆ¶ç¨‹åºæ‰§è¡Œæµç¨‹æˆ–é€ æˆæ‹’ç»æœåŠ¡ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®åˆ†æå’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ï¼ŒPoCä»£ç éªŒè¯äº†æ­¤æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ä»£ç ä»“åº“ä¸»è¦åŒ…å«æ¼æ´åˆ†ææ–‡æ¡£ï¼Œauditè¯·æ±‚å’Œåˆ©ç”¨ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†ä½œè€…å¯èƒ½éšè—äº†æœªå…¬å¼€çš„åˆ©ç”¨æ–¹å¼ã€‚ç”±äºè¯¥PoCçš„ç›®çš„æ˜¯å±•ç¤ºæ¼æ´å‘ç°çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥å­˜åœ¨ä¸€å®šä½é£é™©çš„æŠ•æ¯’å¯èƒ½ï¼Œä½†æ¦‚ç‡è¾ƒä½ã€‚ è¯„ä¼°æŠ•æ¯’é£é™©ä¸º5%ã€‚


**é¡¹ç›®åœ°å€:** [SeanHeelan/o3_finds_cve-2025-37899](https://github.com/SeanHeelan/o3_finds_cve-2025-37899)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-37899](https://nvd.nist.gov/vuln/detail/CVE-2025-37899)

---

## POC #2

**æ¥æº**: [CVE-2025-37899-vett3x_SMB-LINUX-CVE-2025-37899.md](../2025/CVE-2025-37899-vett3x_SMB-LINUX-CVE-2025-37899.md)

# CVE-2025-37899

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-37899-SeanHeelan_o3_finds_cve-2025-37899.md](../2025/CVE-2025-37899-SeanHeelan_o3_finds_cve-2025-37899.md)

## CVE-2025-37899 - Linux Kernel ksmbd use-after-free

**æ¼æ´ç¼–å·:** CVE-2025-37899

**æ¼æ´ç±»å‹:** Use-After-Free

**å½±å“åº”ç”¨:** Linux Kernel ksmbd

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ‹’ç»æœåŠ¡æˆ–ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 5.15 <= version < 6.12.28, 5.15 <= version < 6.14.6, 5.15 <= version < 6.15-rc5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å¯ç”¨ksmbdæœåŠ¡ï¼Œå¹¶é€šè¿‡SMBåè®®ä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹è¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-37899æ˜¯Linuxå†…æ ¸ksmbdæœåŠ¡ä¸­å‘ç°çš„use-after-freeæ¼æ´ï¼Œå­˜åœ¨äºä¼šè¯æ³¨é”€è¿‡ç¨‹ä¸­ã€‚

**æ¼æ´åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œæ¼æ´ä½äº`fs/smb/server/smb2pdu.c`æ–‡ä»¶ä¸­ã€‚å½“ä¼šè¯æ³¨é”€æ—¶ï¼Œ`sess->user`å¯¹è±¡å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹ä½¿ç”¨ï¼Œä¾‹å¦‚å¦ä¸€ä¸ªè¿æ¥å‘é€äº†ä¼šè¯è®¾ç½®è¯·æ±‚å¹¶ç»‘å®šåˆ°æ­£åœ¨é‡Šæ”¾çš„ä¼šè¯ã€‚å¦‚æœè¯¥è¿æ¥çš„å¤„ç†ç¨‹åºåœ¨`smb2_sess_setup`å‡½æ•°ä¸­ï¼Œåˆ™å¯èƒ½ä¼šä½¿ç”¨`sess->user`ï¼Œå¯¼è‡´use-after-freeã€‚

æ ¹æ®æä¾›çš„PoCä»£ç ï¼Œæ”»å‡»è€…åˆ©ç”¨krb5è®¤è¯æµç¨‹ä¸­çš„ä¸€ä¸ªç«äº‰æ¡ä»¶ã€‚åœ¨`krb5_authenticate`å‡½æ•°ä¸­ï¼Œå¦‚æœä¼šè¯æœ‰æ•ˆï¼Œ`sess->user`ä¼šè¢«æå‰é‡Šæ”¾ï¼Œç„¶åå°è¯•è¿›è¡Œkrb5è®¤è¯ã€‚å¦‚æœkrb5è®¤è¯å¤±è´¥ï¼Œ`sess->user`å°†ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œä½†ä¼šè¯ä»ç„¶å­˜åœ¨ï¼Œç•™ä¸‹æ‚¬æŒ‚æŒ‡é’ˆï¼Œå¯¼è‡´åç»­è®¿é—®è¯¥æŒ‡é’ˆæ—¶è§¦å‘use-after-freeæ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  åˆ©ç”¨PoCä¸­çš„krb5è®¤è¯æ–¹æ³•ï¼Œæ„é€ æ¶æ„çš„SMBè¯·æ±‚æ•°æ®åŒ…ï¼Œè§¦å‘`krb5_authenticate`å‡½æ•°ä¸­çš„æ¼æ´ä»£ç ã€‚
2.  å‘é€SMB2ä¼šè¯å»ºç«‹è¯·æ±‚ï¼Œè¿›è¡Œkrb5è®¤è¯ã€‚
3.  åœ¨`ksmbd_krb5_authenticate`å‡½æ•°ä¸­ï¼Œé€šè¿‡ç‰¹å®šçš„è¾“å…¥è§¦å‘è®¤è¯å¤±è´¥ï¼Œä¾‹å¦‚æä¾›æ— æ•ˆçš„SPNEGOä»¤ç‰Œæˆ–krb5ç¥¨æ®ã€‚
4.  è®¤è¯å¤±è´¥åï¼Œ`sess->user`ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œåç»­è®¿é—®è§¦å‘use-after-freeã€‚
5.  åˆ©ç”¨use-after-freeæ¼æ´ï¼Œæ§åˆ¶ç¨‹åºæ‰§è¡Œæµç¨‹æˆ–é€ æˆæ‹’ç»æœåŠ¡ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®åˆ†æå’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ï¼ŒPoCä»£ç éªŒè¯äº†æ­¤æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ä»£ç ä»“åº“ä¸»è¦åŒ…å«æ¼æ´åˆ†ææ–‡æ¡£ï¼Œauditè¯·æ±‚å’Œåˆ©ç”¨ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†ä½œè€…å¯èƒ½éšè—äº†æœªå…¬å¼€çš„åˆ©ç”¨æ–¹å¼ã€‚ç”±äºè¯¥PoCçš„ç›®çš„æ˜¯å±•ç¤ºæ¼æ´å‘ç°çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥å­˜åœ¨ä¸€å®šä½é£é™©çš„æŠ•æ¯’å¯èƒ½ï¼Œä½†æ¦‚ç‡è¾ƒä½ã€‚ è¯„ä¼°æŠ•æ¯’é£é™©ä¸º5%ã€‚


**é¡¹ç›®åœ°å€:** [SeanHeelan/o3_finds_cve-2025-37899](https://github.com/SeanHeelan/o3_finds_cve-2025-37899)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-37899](https://nvd.nist.gov/vuln/detail/CVE-2025-37899)

---

## POC #2

**æ¥æº**: [CVE-2025-37899-vett3x_SMB-LINUX-CVE-2025-37899.md](../2025/CVE-2025-37899-vett3x_SMB-LINUX-CVE-2025-37899.md)

# CVE-2025-37899

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-37899-SeanHeelan_o3_finds_cve-2025-37899.md](../2025/CVE-2025-37899-SeanHeelan_o3_finds_cve-2025-37899.md)

## CVE-2025-37899 - Linux Kernel ksmbd use-after-free

**æ¼æ´ç¼–å·:** CVE-2025-37899

**æ¼æ´ç±»å‹:** Use-After-Free

**å½±å“åº”ç”¨:** Linux Kernel ksmbd

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ‹’ç»æœåŠ¡æˆ–ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 5.15 <= version < 6.12.28, 5.15 <= version < 6.14.6, 5.15 <= version < 6.15-rc5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å¯ç”¨ksmbdæœåŠ¡ï¼Œå¹¶é€šè¿‡SMBåè®®ä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹è¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-37899æ˜¯Linuxå†…æ ¸ksmbdæœåŠ¡ä¸­å‘ç°çš„use-after-freeæ¼æ´ï¼Œå­˜åœ¨äºä¼šè¯æ³¨é”€è¿‡ç¨‹ä¸­ã€‚

**æ¼æ´åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œæ¼æ´ä½äº`fs/smb/server/smb2pdu.c`æ–‡ä»¶ä¸­ã€‚å½“ä¼šè¯æ³¨é”€æ—¶ï¼Œ`sess->user`å¯¹è±¡å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹ä½¿ç”¨ï¼Œä¾‹å¦‚å¦ä¸€ä¸ªè¿æ¥å‘é€äº†ä¼šè¯è®¾ç½®è¯·æ±‚å¹¶ç»‘å®šåˆ°æ­£åœ¨é‡Šæ”¾çš„ä¼šè¯ã€‚å¦‚æœè¯¥è¿æ¥çš„å¤„ç†ç¨‹åºåœ¨`smb2_sess_setup`å‡½æ•°ä¸­ï¼Œåˆ™å¯èƒ½ä¼šä½¿ç”¨`sess->user`ï¼Œå¯¼è‡´use-after-freeã€‚

æ ¹æ®æä¾›çš„PoCä»£ç ï¼Œæ”»å‡»è€…åˆ©ç”¨krb5è®¤è¯æµç¨‹ä¸­çš„ä¸€ä¸ªç«äº‰æ¡ä»¶ã€‚åœ¨`krb5_authenticate`å‡½æ•°ä¸­ï¼Œå¦‚æœä¼šè¯æœ‰æ•ˆï¼Œ`sess->user`ä¼šè¢«æå‰é‡Šæ”¾ï¼Œç„¶åå°è¯•è¿›è¡Œkrb5è®¤è¯ã€‚å¦‚æœkrb5è®¤è¯å¤±è´¥ï¼Œ`sess->user`å°†ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œä½†ä¼šè¯ä»ç„¶å­˜åœ¨ï¼Œç•™ä¸‹æ‚¬æŒ‚æŒ‡é’ˆï¼Œå¯¼è‡´åç»­è®¿é—®è¯¥æŒ‡é’ˆæ—¶è§¦å‘use-after-freeæ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  åˆ©ç”¨PoCä¸­çš„krb5è®¤è¯æ–¹æ³•ï¼Œæ„é€ æ¶æ„çš„SMBè¯·æ±‚æ•°æ®åŒ…ï¼Œè§¦å‘`krb5_authenticate`å‡½æ•°ä¸­çš„æ¼æ´ä»£ç ã€‚
2.  å‘é€SMB2ä¼šè¯å»ºç«‹è¯·æ±‚ï¼Œè¿›è¡Œkrb5è®¤è¯ã€‚
3.  åœ¨`ksmbd_krb5_authenticate`å‡½æ•°ä¸­ï¼Œé€šè¿‡ç‰¹å®šçš„è¾“å…¥è§¦å‘è®¤è¯å¤±è´¥ï¼Œä¾‹å¦‚æä¾›æ— æ•ˆçš„SPNEGOä»¤ç‰Œæˆ–krb5ç¥¨æ®ã€‚
4.  è®¤è¯å¤±è´¥åï¼Œ`sess->user`ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œåç»­è®¿é—®è§¦å‘use-after-freeã€‚
5.  åˆ©ç”¨use-after-freeæ¼æ´ï¼Œæ§åˆ¶ç¨‹åºæ‰§è¡Œæµç¨‹æˆ–é€ æˆæ‹’ç»æœåŠ¡ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®åˆ†æå’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ï¼ŒPoCä»£ç éªŒè¯äº†æ­¤æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ä»£ç ä»“åº“ä¸»è¦åŒ…å«æ¼æ´åˆ†ææ–‡æ¡£ï¼Œauditè¯·æ±‚å’Œåˆ©ç”¨ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†ä½œè€…å¯èƒ½éšè—äº†æœªå…¬å¼€çš„åˆ©ç”¨æ–¹å¼ã€‚ç”±äºè¯¥PoCçš„ç›®çš„æ˜¯å±•ç¤ºæ¼æ´å‘ç°çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥å­˜åœ¨ä¸€å®šä½é£é™©çš„æŠ•æ¯’å¯èƒ½ï¼Œä½†æ¦‚ç‡è¾ƒä½ã€‚ è¯„ä¼°æŠ•æ¯’é£é™©ä¸º5%ã€‚


**é¡¹ç›®åœ°å€:** [SeanHeelan/o3_finds_cve-2025-37899](https://github.com/SeanHeelan/o3_finds_cve-2025-37899)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-37899](https://nvd.nist.gov/vuln/detail/CVE-2025-37899)

---

## POC #2

**æ¥æº**: [CVE-2025-37899-vett3x_SMB-LINUX-CVE-2025-37899.md](../2025/CVE-2025-37899-vett3x_SMB-LINUX-CVE-2025-37899.md)

# CVE-2025-37899

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-37899-SeanHeelan_o3_finds_cve-2025-37899.md](../2025/CVE-2025-37899-SeanHeelan_o3_finds_cve-2025-37899.md)

## CVE-2025-37899 - Linux Kernel ksmbd use-after-free

**æ¼æ´ç¼–å·:** CVE-2025-37899

**æ¼æ´ç±»å‹:** Use-After-Free

**å½±å“åº”ç”¨:** Linux Kernel ksmbd

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ‹’ç»æœåŠ¡æˆ–ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 5.15 <= version < 6.12.28, 5.15 <= version < 6.14.6, 5.15 <= version < 6.15-rc5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å¯ç”¨ksmbdæœåŠ¡ï¼Œå¹¶é€šè¿‡SMBåè®®ä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹è¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-37899æ˜¯Linuxå†…æ ¸ksmbdæœåŠ¡ä¸­å‘ç°çš„use-after-freeæ¼æ´ï¼Œå­˜åœ¨äºä¼šè¯æ³¨é”€è¿‡ç¨‹ä¸­ã€‚

**æ¼æ´åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œæ¼æ´ä½äº`fs/smb/server/smb2pdu.c`æ–‡ä»¶ä¸­ã€‚å½“ä¼šè¯æ³¨é”€æ—¶ï¼Œ`sess->user`å¯¹è±¡å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹ä½¿ç”¨ï¼Œä¾‹å¦‚å¦ä¸€ä¸ªè¿æ¥å‘é€äº†ä¼šè¯è®¾ç½®è¯·æ±‚å¹¶ç»‘å®šåˆ°æ­£åœ¨é‡Šæ”¾çš„ä¼šè¯ã€‚å¦‚æœè¯¥è¿æ¥çš„å¤„ç†ç¨‹åºåœ¨`smb2_sess_setup`å‡½æ•°ä¸­ï¼Œåˆ™å¯èƒ½ä¼šä½¿ç”¨`sess->user`ï¼Œå¯¼è‡´use-after-freeã€‚

æ ¹æ®æä¾›çš„PoCä»£ç ï¼Œæ”»å‡»è€…åˆ©ç”¨krb5è®¤è¯æµç¨‹ä¸­çš„ä¸€ä¸ªç«äº‰æ¡ä»¶ã€‚åœ¨`krb5_authenticate`å‡½æ•°ä¸­ï¼Œå¦‚æœä¼šè¯æœ‰æ•ˆï¼Œ`sess->user`ä¼šè¢«æå‰é‡Šæ”¾ï¼Œç„¶åå°è¯•è¿›è¡Œkrb5è®¤è¯ã€‚å¦‚æœkrb5è®¤è¯å¤±è´¥ï¼Œ`sess->user`å°†ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œä½†ä¼šè¯ä»ç„¶å­˜åœ¨ï¼Œç•™ä¸‹æ‚¬æŒ‚æŒ‡é’ˆï¼Œå¯¼è‡´åç»­è®¿é—®è¯¥æŒ‡é’ˆæ—¶è§¦å‘use-after-freeæ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  åˆ©ç”¨PoCä¸­çš„krb5è®¤è¯æ–¹æ³•ï¼Œæ„é€ æ¶æ„çš„SMBè¯·æ±‚æ•°æ®åŒ…ï¼Œè§¦å‘`krb5_authenticate`å‡½æ•°ä¸­çš„æ¼æ´ä»£ç ã€‚
2.  å‘é€SMB2ä¼šè¯å»ºç«‹è¯·æ±‚ï¼Œè¿›è¡Œkrb5è®¤è¯ã€‚
3.  åœ¨`ksmbd_krb5_authenticate`å‡½æ•°ä¸­ï¼Œé€šè¿‡ç‰¹å®šçš„è¾“å…¥è§¦å‘è®¤è¯å¤±è´¥ï¼Œä¾‹å¦‚æä¾›æ— æ•ˆçš„SPNEGOä»¤ç‰Œæˆ–krb5ç¥¨æ®ã€‚
4.  è®¤è¯å¤±è´¥åï¼Œ`sess->user`ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œåç»­è®¿é—®è§¦å‘use-after-freeã€‚
5.  åˆ©ç”¨use-after-freeæ¼æ´ï¼Œæ§åˆ¶ç¨‹åºæ‰§è¡Œæµç¨‹æˆ–é€ æˆæ‹’ç»æœåŠ¡ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®åˆ†æå’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ï¼ŒPoCä»£ç éªŒè¯äº†æ­¤æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ä»£ç ä»“åº“ä¸»è¦åŒ…å«æ¼æ´åˆ†ææ–‡æ¡£ï¼Œauditè¯·æ±‚å’Œåˆ©ç”¨ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†ä½œè€…å¯èƒ½éšè—äº†æœªå…¬å¼€çš„åˆ©ç”¨æ–¹å¼ã€‚ç”±äºè¯¥PoCçš„ç›®çš„æ˜¯å±•ç¤ºæ¼æ´å‘ç°çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥å­˜åœ¨ä¸€å®šä½é£é™©çš„æŠ•æ¯’å¯èƒ½ï¼Œä½†æ¦‚ç‡è¾ƒä½ã€‚ è¯„ä¼°æŠ•æ¯’é£é™©ä¸º5%ã€‚


**é¡¹ç›®åœ°å€:** [SeanHeelan/o3_finds_cve-2025-37899](https://github.com/SeanHeelan/o3_finds_cve-2025-37899)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-37899](https://nvd.nist.gov/vuln/detail/CVE-2025-37899)

---

## POC #2

**æ¥æº**: [CVE-2025-37899-vett3x_SMB-LINUX-CVE-2025-37899.md](../2025/CVE-2025-37899-vett3x_SMB-LINUX-CVE-2025-37899.md)

# CVE-2025-37899

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-37899-SeanHeelan_o3_finds_cve-2025-37899.md](../2025/CVE-2025-37899-SeanHeelan_o3_finds_cve-2025-37899.md)

## CVE-2025-37899 - Linux Kernel ksmbd use-after-free

**æ¼æ´ç¼–å·:** CVE-2025-37899

**æ¼æ´ç±»å‹:** Use-After-Free

**å½±å“åº”ç”¨:** Linux Kernel ksmbd

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ‹’ç»æœåŠ¡æˆ–ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 5.15 <= version < 6.12.28, 5.15 <= version < 6.14.6, 5.15 <= version < 6.15-rc5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å¯ç”¨ksmbdæœåŠ¡ï¼Œå¹¶é€šè¿‡SMBåè®®ä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹è¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-37899æ˜¯Linuxå†…æ ¸ksmbdæœåŠ¡ä¸­å‘ç°çš„use-after-freeæ¼æ´ï¼Œå­˜åœ¨äºä¼šè¯æ³¨é”€è¿‡ç¨‹ä¸­ã€‚

**æ¼æ´åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œæ¼æ´ä½äº`fs/smb/server/smb2pdu.c`æ–‡ä»¶ä¸­ã€‚å½“ä¼šè¯æ³¨é”€æ—¶ï¼Œ`sess->user`å¯¹è±¡å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹ä½¿ç”¨ï¼Œä¾‹å¦‚å¦ä¸€ä¸ªè¿æ¥å‘é€äº†ä¼šè¯è®¾ç½®è¯·æ±‚å¹¶ç»‘å®šåˆ°æ­£åœ¨é‡Šæ”¾çš„ä¼šè¯ã€‚å¦‚æœè¯¥è¿æ¥çš„å¤„ç†ç¨‹åºåœ¨`smb2_sess_setup`å‡½æ•°ä¸­ï¼Œåˆ™å¯èƒ½ä¼šä½¿ç”¨`sess->user`ï¼Œå¯¼è‡´use-after-freeã€‚

æ ¹æ®æä¾›çš„PoCä»£ç ï¼Œæ”»å‡»è€…åˆ©ç”¨krb5è®¤è¯æµç¨‹ä¸­çš„ä¸€ä¸ªç«äº‰æ¡ä»¶ã€‚åœ¨`krb5_authenticate`å‡½æ•°ä¸­ï¼Œå¦‚æœä¼šè¯æœ‰æ•ˆï¼Œ`sess->user`ä¼šè¢«æå‰é‡Šæ”¾ï¼Œç„¶åå°è¯•è¿›è¡Œkrb5è®¤è¯ã€‚å¦‚æœkrb5è®¤è¯å¤±è´¥ï¼Œ`sess->user`å°†ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œä½†ä¼šè¯ä»ç„¶å­˜åœ¨ï¼Œç•™ä¸‹æ‚¬æŒ‚æŒ‡é’ˆï¼Œå¯¼è‡´åç»­è®¿é—®è¯¥æŒ‡é’ˆæ—¶è§¦å‘use-after-freeæ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  åˆ©ç”¨PoCä¸­çš„krb5è®¤è¯æ–¹æ³•ï¼Œæ„é€ æ¶æ„çš„SMBè¯·æ±‚æ•°æ®åŒ…ï¼Œè§¦å‘`krb5_authenticate`å‡½æ•°ä¸­çš„æ¼æ´ä»£ç ã€‚
2.  å‘é€SMB2ä¼šè¯å»ºç«‹è¯·æ±‚ï¼Œè¿›è¡Œkrb5è®¤è¯ã€‚
3.  åœ¨`ksmbd_krb5_authenticate`å‡½æ•°ä¸­ï¼Œé€šè¿‡ç‰¹å®šçš„è¾“å…¥è§¦å‘è®¤è¯å¤±è´¥ï¼Œä¾‹å¦‚æä¾›æ— æ•ˆçš„SPNEGOä»¤ç‰Œæˆ–krb5ç¥¨æ®ã€‚
4.  è®¤è¯å¤±è´¥åï¼Œ`sess->user`ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œåç»­è®¿é—®è§¦å‘use-after-freeã€‚
5.  åˆ©ç”¨use-after-freeæ¼æ´ï¼Œæ§åˆ¶ç¨‹åºæ‰§è¡Œæµç¨‹æˆ–é€ æˆæ‹’ç»æœåŠ¡ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®åˆ†æå’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ï¼ŒPoCä»£ç éªŒè¯äº†æ­¤æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ä»£ç ä»“åº“ä¸»è¦åŒ…å«æ¼æ´åˆ†ææ–‡æ¡£ï¼Œauditè¯·æ±‚å’Œåˆ©ç”¨ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†ä½œè€…å¯èƒ½éšè—äº†æœªå…¬å¼€çš„åˆ©ç”¨æ–¹å¼ã€‚ç”±äºè¯¥PoCçš„ç›®çš„æ˜¯å±•ç¤ºæ¼æ´å‘ç°çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥å­˜åœ¨ä¸€å®šä½é£é™©çš„æŠ•æ¯’å¯èƒ½ï¼Œä½†æ¦‚ç‡è¾ƒä½ã€‚ è¯„ä¼°æŠ•æ¯’é£é™©ä¸º5%ã€‚


**é¡¹ç›®åœ°å€:** [SeanHeelan/o3_finds_cve-2025-37899](https://github.com/SeanHeelan/o3_finds_cve-2025-37899)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-37899](https://nvd.nist.gov/vuln/detail/CVE-2025-37899)

---

## POC #2

**æ¥æº**: [CVE-2025-37899-vett3x_SMB-LINUX-CVE-2025-37899.md](../2025/CVE-2025-37899-vett3x_SMB-LINUX-CVE-2025-37899.md)

# CVE-2025-37899

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-37899-SeanHeelan_o3_finds_cve-2025-37899.md](../2025/CVE-2025-37899-SeanHeelan_o3_finds_cve-2025-37899.md)

## CVE-2025-37899 - Linux Kernel ksmbd use-after-free

**æ¼æ´ç¼–å·:** CVE-2025-37899

**æ¼æ´ç±»å‹:** Use-After-Free

**å½±å“åº”ç”¨:** Linux Kernel ksmbd

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ‹’ç»æœåŠ¡æˆ–ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 5.15 <= version < 6.12.28, 5.15 <= version < 6.14.6, 5.15 <= version < 6.15-rc5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å¯ç”¨ksmbdæœåŠ¡ï¼Œå¹¶é€šè¿‡SMBåè®®ä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹è¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-37899æ˜¯Linuxå†…æ ¸ksmbdæœåŠ¡ä¸­å‘ç°çš„use-after-freeæ¼æ´ï¼Œå­˜åœ¨äºä¼šè¯æ³¨é”€è¿‡ç¨‹ä¸­ã€‚

**æ¼æ´åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œæ¼æ´ä½äº`fs/smb/server/smb2pdu.c`æ–‡ä»¶ä¸­ã€‚å½“ä¼šè¯æ³¨é”€æ—¶ï¼Œ`sess->user`å¯¹è±¡å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹ä½¿ç”¨ï¼Œä¾‹å¦‚å¦ä¸€ä¸ªè¿æ¥å‘é€äº†ä¼šè¯è®¾ç½®è¯·æ±‚å¹¶ç»‘å®šåˆ°æ­£åœ¨é‡Šæ”¾çš„ä¼šè¯ã€‚å¦‚æœè¯¥è¿æ¥çš„å¤„ç†ç¨‹åºåœ¨`smb2_sess_setup`å‡½æ•°ä¸­ï¼Œåˆ™å¯èƒ½ä¼šä½¿ç”¨`sess->user`ï¼Œå¯¼è‡´use-after-freeã€‚

æ ¹æ®æä¾›çš„PoCä»£ç ï¼Œæ”»å‡»è€…åˆ©ç”¨krb5è®¤è¯æµç¨‹ä¸­çš„ä¸€ä¸ªç«äº‰æ¡ä»¶ã€‚åœ¨`krb5_authenticate`å‡½æ•°ä¸­ï¼Œå¦‚æœä¼šè¯æœ‰æ•ˆï¼Œ`sess->user`ä¼šè¢«æå‰é‡Šæ”¾ï¼Œç„¶åå°è¯•è¿›è¡Œkrb5è®¤è¯ã€‚å¦‚æœkrb5è®¤è¯å¤±è´¥ï¼Œ`sess->user`å°†ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œä½†ä¼šè¯ä»ç„¶å­˜åœ¨ï¼Œç•™ä¸‹æ‚¬æŒ‚æŒ‡é’ˆï¼Œå¯¼è‡´åç»­è®¿é—®è¯¥æŒ‡é’ˆæ—¶è§¦å‘use-after-freeæ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  åˆ©ç”¨PoCä¸­çš„krb5è®¤è¯æ–¹æ³•ï¼Œæ„é€ æ¶æ„çš„SMBè¯·æ±‚æ•°æ®åŒ…ï¼Œè§¦å‘`krb5_authenticate`å‡½æ•°ä¸­çš„æ¼æ´ä»£ç ã€‚
2.  å‘é€SMB2ä¼šè¯å»ºç«‹è¯·æ±‚ï¼Œè¿›è¡Œkrb5è®¤è¯ã€‚
3.  åœ¨`ksmbd_krb5_authenticate`å‡½æ•°ä¸­ï¼Œé€šè¿‡ç‰¹å®šçš„è¾“å…¥è§¦å‘è®¤è¯å¤±è´¥ï¼Œä¾‹å¦‚æä¾›æ— æ•ˆçš„SPNEGOä»¤ç‰Œæˆ–krb5ç¥¨æ®ã€‚
4.  è®¤è¯å¤±è´¥åï¼Œ`sess->user`ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œåç»­è®¿é—®è§¦å‘use-after-freeã€‚
5.  åˆ©ç”¨use-after-freeæ¼æ´ï¼Œæ§åˆ¶ç¨‹åºæ‰§è¡Œæµç¨‹æˆ–é€ æˆæ‹’ç»æœåŠ¡ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®åˆ†æå’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ï¼ŒPoCä»£ç éªŒè¯äº†æ­¤æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ä»£ç ä»“åº“ä¸»è¦åŒ…å«æ¼æ´åˆ†ææ–‡æ¡£ï¼Œauditè¯·æ±‚å’Œåˆ©ç”¨ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†ä½œè€…å¯èƒ½éšè—äº†æœªå…¬å¼€çš„åˆ©ç”¨æ–¹å¼ã€‚ç”±äºè¯¥PoCçš„ç›®çš„æ˜¯å±•ç¤ºæ¼æ´å‘ç°çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥å­˜åœ¨ä¸€å®šä½é£é™©çš„æŠ•æ¯’å¯èƒ½ï¼Œä½†æ¦‚ç‡è¾ƒä½ã€‚ è¯„ä¼°æŠ•æ¯’é£é™©ä¸º5%ã€‚


**é¡¹ç›®åœ°å€:** [SeanHeelan/o3_finds_cve-2025-37899](https://github.com/SeanHeelan/o3_finds_cve-2025-37899)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-37899](https://nvd.nist.gov/vuln/detail/CVE-2025-37899)

---

## POC #2

**æ¥æº**: [CVE-2025-37899-vett3x_SMB-LINUX-CVE-2025-37899.md](../2025/CVE-2025-37899-vett3x_SMB-LINUX-CVE-2025-37899.md)

# CVE-2025-37899

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-37899-SeanHeelan_o3_finds_cve-2025-37899.md](../2025/CVE-2025-37899-SeanHeelan_o3_finds_cve-2025-37899.md)

## CVE-2025-37899 - Linux Kernel ksmbd use-after-free

**æ¼æ´ç¼–å·:** CVE-2025-37899

**æ¼æ´ç±»å‹:** Use-After-Free

**å½±å“åº”ç”¨:** Linux Kernel ksmbd

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ‹’ç»æœåŠ¡æˆ–ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 5.15 <= version < 6.12.28, 5.15 <= version < 6.14.6, 5.15 <= version < 6.15-rc5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å¯ç”¨ksmbdæœåŠ¡ï¼Œå¹¶é€šè¿‡SMBåè®®ä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹è¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-37899æ˜¯Linuxå†…æ ¸ksmbdæœåŠ¡ä¸­å‘ç°çš„use-after-freeæ¼æ´ï¼Œå­˜åœ¨äºä¼šè¯æ³¨é”€è¿‡ç¨‹ä¸­ã€‚

**æ¼æ´åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œæ¼æ´ä½äº`fs/smb/server/smb2pdu.c`æ–‡ä»¶ä¸­ã€‚å½“ä¼šè¯æ³¨é”€æ—¶ï¼Œ`sess->user`å¯¹è±¡å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹ä½¿ç”¨ï¼Œä¾‹å¦‚å¦ä¸€ä¸ªè¿æ¥å‘é€äº†ä¼šè¯è®¾ç½®è¯·æ±‚å¹¶ç»‘å®šåˆ°æ­£åœ¨é‡Šæ”¾çš„ä¼šè¯ã€‚å¦‚æœè¯¥è¿æ¥çš„å¤„ç†ç¨‹åºåœ¨`smb2_sess_setup`å‡½æ•°ä¸­ï¼Œåˆ™å¯èƒ½ä¼šä½¿ç”¨`sess->user`ï¼Œå¯¼è‡´use-after-freeã€‚

æ ¹æ®æä¾›çš„PoCä»£ç ï¼Œæ”»å‡»è€…åˆ©ç”¨krb5è®¤è¯æµç¨‹ä¸­çš„ä¸€ä¸ªç«äº‰æ¡ä»¶ã€‚åœ¨`krb5_authenticate`å‡½æ•°ä¸­ï¼Œå¦‚æœä¼šè¯æœ‰æ•ˆï¼Œ`sess->user`ä¼šè¢«æå‰é‡Šæ”¾ï¼Œç„¶åå°è¯•è¿›è¡Œkrb5è®¤è¯ã€‚å¦‚æœkrb5è®¤è¯å¤±è´¥ï¼Œ`sess->user`å°†ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œä½†ä¼šè¯ä»ç„¶å­˜åœ¨ï¼Œç•™ä¸‹æ‚¬æŒ‚æŒ‡é’ˆï¼Œå¯¼è‡´åç»­è®¿é—®è¯¥æŒ‡é’ˆæ—¶è§¦å‘use-after-freeæ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  åˆ©ç”¨PoCä¸­çš„krb5è®¤è¯æ–¹æ³•ï¼Œæ„é€ æ¶æ„çš„SMBè¯·æ±‚æ•°æ®åŒ…ï¼Œè§¦å‘`krb5_authenticate`å‡½æ•°ä¸­çš„æ¼æ´ä»£ç ã€‚
2.  å‘é€SMB2ä¼šè¯å»ºç«‹è¯·æ±‚ï¼Œè¿›è¡Œkrb5è®¤è¯ã€‚
3.  åœ¨`ksmbd_krb5_authenticate`å‡½æ•°ä¸­ï¼Œé€šè¿‡ç‰¹å®šçš„è¾“å…¥è§¦å‘è®¤è¯å¤±è´¥ï¼Œä¾‹å¦‚æä¾›æ— æ•ˆçš„SPNEGOä»¤ç‰Œæˆ–krb5ç¥¨æ®ã€‚
4.  è®¤è¯å¤±è´¥åï¼Œ`sess->user`ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œåç»­è®¿é—®è§¦å‘use-after-freeã€‚
5.  åˆ©ç”¨use-after-freeæ¼æ´ï¼Œæ§åˆ¶ç¨‹åºæ‰§è¡Œæµç¨‹æˆ–é€ æˆæ‹’ç»æœåŠ¡ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®åˆ†æå’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ï¼ŒPoCä»£ç éªŒè¯äº†æ­¤æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ä»£ç ä»“åº“ä¸»è¦åŒ…å«æ¼æ´åˆ†ææ–‡æ¡£ï¼Œauditè¯·æ±‚å’Œåˆ©ç”¨ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†ä½œè€…å¯èƒ½éšè—äº†æœªå…¬å¼€çš„åˆ©ç”¨æ–¹å¼ã€‚ç”±äºè¯¥PoCçš„ç›®çš„æ˜¯å±•ç¤ºæ¼æ´å‘ç°çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥å­˜åœ¨ä¸€å®šä½é£é™©çš„æŠ•æ¯’å¯èƒ½ï¼Œä½†æ¦‚ç‡è¾ƒä½ã€‚ è¯„ä¼°æŠ•æ¯’é£é™©ä¸º5%ã€‚


**é¡¹ç›®åœ°å€:** [SeanHeelan/o3_finds_cve-2025-37899](https://github.com/SeanHeelan/o3_finds_cve-2025-37899)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-37899](https://nvd.nist.gov/vuln/detail/CVE-2025-37899)

---

## POC #2

**æ¥æº**: [CVE-2025-37899-vett3x_SMB-LINUX-CVE-2025-37899.md](../2025/CVE-2025-37899-vett3x_SMB-LINUX-CVE-2025-37899.md)

# CVE-2025-37899

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-37899-SeanHeelan_o3_finds_cve-2025-37899.md](../2025/CVE-2025-37899-SeanHeelan_o3_finds_cve-2025-37899.md)

## CVE-2025-37899 - Linux Kernel ksmbd use-after-free

**æ¼æ´ç¼–å·:** CVE-2025-37899

**æ¼æ´ç±»å‹:** Use-After-Free

**å½±å“åº”ç”¨:** Linux Kernel ksmbd

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ‹’ç»æœåŠ¡æˆ–ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 5.15 <= version < 6.12.28, 5.15 <= version < 6.14.6, 5.15 <= version < 6.15-rc5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å¯ç”¨ksmbdæœåŠ¡ï¼Œå¹¶é€šè¿‡SMBåè®®ä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹è¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-37899æ˜¯Linuxå†…æ ¸ksmbdæœåŠ¡ä¸­å‘ç°çš„use-after-freeæ¼æ´ï¼Œå­˜åœ¨äºä¼šè¯æ³¨é”€è¿‡ç¨‹ä¸­ã€‚

**æ¼æ´åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œæ¼æ´ä½äº`fs/smb/server/smb2pdu.c`æ–‡ä»¶ä¸­ã€‚å½“ä¼šè¯æ³¨é”€æ—¶ï¼Œ`sess->user`å¯¹è±¡å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹ä½¿ç”¨ï¼Œä¾‹å¦‚å¦ä¸€ä¸ªè¿æ¥å‘é€äº†ä¼šè¯è®¾ç½®è¯·æ±‚å¹¶ç»‘å®šåˆ°æ­£åœ¨é‡Šæ”¾çš„ä¼šè¯ã€‚å¦‚æœè¯¥è¿æ¥çš„å¤„ç†ç¨‹åºåœ¨`smb2_sess_setup`å‡½æ•°ä¸­ï¼Œåˆ™å¯èƒ½ä¼šä½¿ç”¨`sess->user`ï¼Œå¯¼è‡´use-after-freeã€‚

æ ¹æ®æä¾›çš„PoCä»£ç ï¼Œæ”»å‡»è€…åˆ©ç”¨krb5è®¤è¯æµç¨‹ä¸­çš„ä¸€ä¸ªç«äº‰æ¡ä»¶ã€‚åœ¨`krb5_authenticate`å‡½æ•°ä¸­ï¼Œå¦‚æœä¼šè¯æœ‰æ•ˆï¼Œ`sess->user`ä¼šè¢«æå‰é‡Šæ”¾ï¼Œç„¶åå°è¯•è¿›è¡Œkrb5è®¤è¯ã€‚å¦‚æœkrb5è®¤è¯å¤±è´¥ï¼Œ`sess->user`å°†ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œä½†ä¼šè¯ä»ç„¶å­˜åœ¨ï¼Œç•™ä¸‹æ‚¬æŒ‚æŒ‡é’ˆï¼Œå¯¼è‡´åç»­è®¿é—®è¯¥æŒ‡é’ˆæ—¶è§¦å‘use-after-freeæ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  åˆ©ç”¨PoCä¸­çš„krb5è®¤è¯æ–¹æ³•ï¼Œæ„é€ æ¶æ„çš„SMBè¯·æ±‚æ•°æ®åŒ…ï¼Œè§¦å‘`krb5_authenticate`å‡½æ•°ä¸­çš„æ¼æ´ä»£ç ã€‚
2.  å‘é€SMB2ä¼šè¯å»ºç«‹è¯·æ±‚ï¼Œè¿›è¡Œkrb5è®¤è¯ã€‚
3.  åœ¨`ksmbd_krb5_authenticate`å‡½æ•°ä¸­ï¼Œé€šè¿‡ç‰¹å®šçš„è¾“å…¥è§¦å‘è®¤è¯å¤±è´¥ï¼Œä¾‹å¦‚æä¾›æ— æ•ˆçš„SPNEGOä»¤ç‰Œæˆ–krb5ç¥¨æ®ã€‚
4.  è®¤è¯å¤±è´¥åï¼Œ`sess->user`ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œåç»­è®¿é—®è§¦å‘use-after-freeã€‚
5.  åˆ©ç”¨use-after-freeæ¼æ´ï¼Œæ§åˆ¶ç¨‹åºæ‰§è¡Œæµç¨‹æˆ–é€ æˆæ‹’ç»æœåŠ¡ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®åˆ†æå’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ï¼ŒPoCä»£ç éªŒè¯äº†æ­¤æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ä»£ç ä»“åº“ä¸»è¦åŒ…å«æ¼æ´åˆ†ææ–‡æ¡£ï¼Œauditè¯·æ±‚å’Œåˆ©ç”¨ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†ä½œè€…å¯èƒ½éšè—äº†æœªå…¬å¼€çš„åˆ©ç”¨æ–¹å¼ã€‚ç”±äºè¯¥PoCçš„ç›®çš„æ˜¯å±•ç¤ºæ¼æ´å‘ç°çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥å­˜åœ¨ä¸€å®šä½é£é™©çš„æŠ•æ¯’å¯èƒ½ï¼Œä½†æ¦‚ç‡è¾ƒä½ã€‚ è¯„ä¼°æŠ•æ¯’é£é™©ä¸º5%ã€‚


**é¡¹ç›®åœ°å€:** [SeanHeelan/o3_finds_cve-2025-37899](https://github.com/SeanHeelan/o3_finds_cve-2025-37899)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-37899](https://nvd.nist.gov/vuln/detail/CVE-2025-37899)

---

## POC #2

**æ¥æº**: [CVE-2025-37899-vett3x_SMB-LINUX-CVE-2025-37899.md](../2025/CVE-2025-37899-vett3x_SMB-LINUX-CVE-2025-37899.md)

# CVE-2025-37899

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-37899-SeanHeelan_o3_finds_cve-2025-37899.md](../2025/CVE-2025-37899-SeanHeelan_o3_finds_cve-2025-37899.md)

## CVE-2025-37899 - Linux Kernel ksmbd use-after-free

**æ¼æ´ç¼–å·:** CVE-2025-37899

**æ¼æ´ç±»å‹:** Use-After-Free

**å½±å“åº”ç”¨:** Linux Kernel ksmbd

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ‹’ç»æœåŠ¡æˆ–ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 5.15 <= version < 6.12.28, 5.15 <= version < 6.14.6, 5.15 <= version < 6.15-rc5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å¯ç”¨ksmbdæœåŠ¡ï¼Œå¹¶é€šè¿‡SMBåè®®ä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹è¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-37899æ˜¯Linuxå†…æ ¸ksmbdæœåŠ¡ä¸­å‘ç°çš„use-after-freeæ¼æ´ï¼Œå­˜åœ¨äºä¼šè¯æ³¨é”€è¿‡ç¨‹ä¸­ã€‚

**æ¼æ´åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œæ¼æ´ä½äº`fs/smb/server/smb2pdu.c`æ–‡ä»¶ä¸­ã€‚å½“ä¼šè¯æ³¨é”€æ—¶ï¼Œ`sess->user`å¯¹è±¡å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹ä½¿ç”¨ï¼Œä¾‹å¦‚å¦ä¸€ä¸ªè¿æ¥å‘é€äº†ä¼šè¯è®¾ç½®è¯·æ±‚å¹¶ç»‘å®šåˆ°æ­£åœ¨é‡Šæ”¾çš„ä¼šè¯ã€‚å¦‚æœè¯¥è¿æ¥çš„å¤„ç†ç¨‹åºåœ¨`smb2_sess_setup`å‡½æ•°ä¸­ï¼Œåˆ™å¯èƒ½ä¼šä½¿ç”¨`sess->user`ï¼Œå¯¼è‡´use-after-freeã€‚

æ ¹æ®æä¾›çš„PoCä»£ç ï¼Œæ”»å‡»è€…åˆ©ç”¨krb5è®¤è¯æµç¨‹ä¸­çš„ä¸€ä¸ªç«äº‰æ¡ä»¶ã€‚åœ¨`krb5_authenticate`å‡½æ•°ä¸­ï¼Œå¦‚æœä¼šè¯æœ‰æ•ˆï¼Œ`sess->user`ä¼šè¢«æå‰é‡Šæ”¾ï¼Œç„¶åå°è¯•è¿›è¡Œkrb5è®¤è¯ã€‚å¦‚æœkrb5è®¤è¯å¤±è´¥ï¼Œ`sess->user`å°†ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œä½†ä¼šè¯ä»ç„¶å­˜åœ¨ï¼Œç•™ä¸‹æ‚¬æŒ‚æŒ‡é’ˆï¼Œå¯¼è‡´åç»­è®¿é—®è¯¥æŒ‡é’ˆæ—¶è§¦å‘use-after-freeæ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  åˆ©ç”¨PoCä¸­çš„krb5è®¤è¯æ–¹æ³•ï¼Œæ„é€ æ¶æ„çš„SMBè¯·æ±‚æ•°æ®åŒ…ï¼Œè§¦å‘`krb5_authenticate`å‡½æ•°ä¸­çš„æ¼æ´ä»£ç ã€‚
2.  å‘é€SMB2ä¼šè¯å»ºç«‹è¯·æ±‚ï¼Œè¿›è¡Œkrb5è®¤è¯ã€‚
3.  åœ¨`ksmbd_krb5_authenticate`å‡½æ•°ä¸­ï¼Œé€šè¿‡ç‰¹å®šçš„è¾“å…¥è§¦å‘è®¤è¯å¤±è´¥ï¼Œä¾‹å¦‚æä¾›æ— æ•ˆçš„SPNEGOä»¤ç‰Œæˆ–krb5ç¥¨æ®ã€‚
4.  è®¤è¯å¤±è´¥åï¼Œ`sess->user`ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œåç»­è®¿é—®è§¦å‘use-after-freeã€‚
5.  åˆ©ç”¨use-after-freeæ¼æ´ï¼Œæ§åˆ¶ç¨‹åºæ‰§è¡Œæµç¨‹æˆ–é€ æˆæ‹’ç»æœåŠ¡ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®åˆ†æå’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ï¼ŒPoCä»£ç éªŒè¯äº†æ­¤æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ä»£ç ä»“åº“ä¸»è¦åŒ…å«æ¼æ´åˆ†ææ–‡æ¡£ï¼Œauditè¯·æ±‚å’Œåˆ©ç”¨ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†ä½œè€…å¯èƒ½éšè—äº†æœªå…¬å¼€çš„åˆ©ç”¨æ–¹å¼ã€‚ç”±äºè¯¥PoCçš„ç›®çš„æ˜¯å±•ç¤ºæ¼æ´å‘ç°çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥å­˜åœ¨ä¸€å®šä½é£é™©çš„æŠ•æ¯’å¯èƒ½ï¼Œä½†æ¦‚ç‡è¾ƒä½ã€‚ è¯„ä¼°æŠ•æ¯’é£é™©ä¸º5%ã€‚


**é¡¹ç›®åœ°å€:** [SeanHeelan/o3_finds_cve-2025-37899](https://github.com/SeanHeelan/o3_finds_cve-2025-37899)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-37899](https://nvd.nist.gov/vuln/detail/CVE-2025-37899)

---

## POC #2

**æ¥æº**: [CVE-2025-37899-vett3x_SMB-LINUX-CVE-2025-37899.md](../2025/CVE-2025-37899-vett3x_SMB-LINUX-CVE-2025-37899.md)

# CVE-2025-37899

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-37899-SeanHeelan_o3_finds_cve-2025-37899.md](../2025/CVE-2025-37899-SeanHeelan_o3_finds_cve-2025-37899.md)

## CVE-2025-37899 - Linux Kernel ksmbd use-after-free

**æ¼æ´ç¼–å·:** CVE-2025-37899

**æ¼æ´ç±»å‹:** Use-After-Free

**å½±å“åº”ç”¨:** Linux Kernel ksmbd

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ‹’ç»æœåŠ¡æˆ–ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 5.15 <= version < 6.12.28, 5.15 <= version < 6.14.6, 5.15 <= version < 6.15-rc5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å¯ç”¨ksmbdæœåŠ¡ï¼Œå¹¶é€šè¿‡SMBåè®®ä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹è¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-37899æ˜¯Linuxå†…æ ¸ksmbdæœåŠ¡ä¸­å‘ç°çš„use-after-freeæ¼æ´ï¼Œå­˜åœ¨äºä¼šè¯æ³¨é”€è¿‡ç¨‹ä¸­ã€‚

**æ¼æ´åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œæ¼æ´ä½äº`fs/smb/server/smb2pdu.c`æ–‡ä»¶ä¸­ã€‚å½“ä¼šè¯æ³¨é”€æ—¶ï¼Œ`sess->user`å¯¹è±¡å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹ä½¿ç”¨ï¼Œä¾‹å¦‚å¦ä¸€ä¸ªè¿æ¥å‘é€äº†ä¼šè¯è®¾ç½®è¯·æ±‚å¹¶ç»‘å®šåˆ°æ­£åœ¨é‡Šæ”¾çš„ä¼šè¯ã€‚å¦‚æœè¯¥è¿æ¥çš„å¤„ç†ç¨‹åºåœ¨`smb2_sess_setup`å‡½æ•°ä¸­ï¼Œåˆ™å¯èƒ½ä¼šä½¿ç”¨`sess->user`ï¼Œå¯¼è‡´use-after-freeã€‚

æ ¹æ®æä¾›çš„PoCä»£ç ï¼Œæ”»å‡»è€…åˆ©ç”¨krb5è®¤è¯æµç¨‹ä¸­çš„ä¸€ä¸ªç«äº‰æ¡ä»¶ã€‚åœ¨`krb5_authenticate`å‡½æ•°ä¸­ï¼Œå¦‚æœä¼šè¯æœ‰æ•ˆï¼Œ`sess->user`ä¼šè¢«æå‰é‡Šæ”¾ï¼Œç„¶åå°è¯•è¿›è¡Œkrb5è®¤è¯ã€‚å¦‚æœkrb5è®¤è¯å¤±è´¥ï¼Œ`sess->user`å°†ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œä½†ä¼šè¯ä»ç„¶å­˜åœ¨ï¼Œç•™ä¸‹æ‚¬æŒ‚æŒ‡é’ˆï¼Œå¯¼è‡´åç»­è®¿é—®è¯¥æŒ‡é’ˆæ—¶è§¦å‘use-after-freeæ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  åˆ©ç”¨PoCä¸­çš„krb5è®¤è¯æ–¹æ³•ï¼Œæ„é€ æ¶æ„çš„SMBè¯·æ±‚æ•°æ®åŒ…ï¼Œè§¦å‘`krb5_authenticate`å‡½æ•°ä¸­çš„æ¼æ´ä»£ç ã€‚
2.  å‘é€SMB2ä¼šè¯å»ºç«‹è¯·æ±‚ï¼Œè¿›è¡Œkrb5è®¤è¯ã€‚
3.  åœ¨`ksmbd_krb5_authenticate`å‡½æ•°ä¸­ï¼Œé€šè¿‡ç‰¹å®šçš„è¾“å…¥è§¦å‘è®¤è¯å¤±è´¥ï¼Œä¾‹å¦‚æä¾›æ— æ•ˆçš„SPNEGOä»¤ç‰Œæˆ–krb5ç¥¨æ®ã€‚
4.  è®¤è¯å¤±è´¥åï¼Œ`sess->user`ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œåç»­è®¿é—®è§¦å‘use-after-freeã€‚
5.  åˆ©ç”¨use-after-freeæ¼æ´ï¼Œæ§åˆ¶ç¨‹åºæ‰§è¡Œæµç¨‹æˆ–é€ æˆæ‹’ç»æœåŠ¡ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®åˆ†æå’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ï¼ŒPoCä»£ç éªŒè¯äº†æ­¤æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ä»£ç ä»“åº“ä¸»è¦åŒ…å«æ¼æ´åˆ†ææ–‡æ¡£ï¼Œauditè¯·æ±‚å’Œåˆ©ç”¨ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†ä½œè€…å¯èƒ½éšè—äº†æœªå…¬å¼€çš„åˆ©ç”¨æ–¹å¼ã€‚ç”±äºè¯¥PoCçš„ç›®çš„æ˜¯å±•ç¤ºæ¼æ´å‘ç°çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥å­˜åœ¨ä¸€å®šä½é£é™©çš„æŠ•æ¯’å¯èƒ½ï¼Œä½†æ¦‚ç‡è¾ƒä½ã€‚ è¯„ä¼°æŠ•æ¯’é£é™©ä¸º5%ã€‚


**é¡¹ç›®åœ°å€:** [SeanHeelan/o3_finds_cve-2025-37899](https://github.com/SeanHeelan/o3_finds_cve-2025-37899)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-37899](https://nvd.nist.gov/vuln/detail/CVE-2025-37899)

---

## POC #2

**æ¥æº**: [CVE-2025-37899-vett3x_SMB-LINUX-CVE-2025-37899.md](../2025/CVE-2025-37899-vett3x_SMB-LINUX-CVE-2025-37899.md)

# CVE-2025-37899

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-37899-SeanHeelan_o3_finds_cve-2025-37899.md](../2025/CVE-2025-37899-SeanHeelan_o3_finds_cve-2025-37899.md)

## CVE-2025-37899 - Linux Kernel ksmbd use-after-free

**æ¼æ´ç¼–å·:** CVE-2025-37899

**æ¼æ´ç±»å‹:** Use-After-Free

**å½±å“åº”ç”¨:** Linux Kernel ksmbd

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ‹’ç»æœåŠ¡æˆ–ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 5.15 <= version < 6.12.28, 5.15 <= version < 6.14.6, 5.15 <= version < 6.15-rc5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å¯ç”¨ksmbdæœåŠ¡ï¼Œå¹¶é€šè¿‡SMBåè®®ä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹è¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-37899æ˜¯Linuxå†…æ ¸ksmbdæœåŠ¡ä¸­å‘ç°çš„use-after-freeæ¼æ´ï¼Œå­˜åœ¨äºä¼šè¯æ³¨é”€è¿‡ç¨‹ä¸­ã€‚

**æ¼æ´åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œæ¼æ´ä½äº`fs/smb/server/smb2pdu.c`æ–‡ä»¶ä¸­ã€‚å½“ä¼šè¯æ³¨é”€æ—¶ï¼Œ`sess->user`å¯¹è±¡å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹ä½¿ç”¨ï¼Œä¾‹å¦‚å¦ä¸€ä¸ªè¿æ¥å‘é€äº†ä¼šè¯è®¾ç½®è¯·æ±‚å¹¶ç»‘å®šåˆ°æ­£åœ¨é‡Šæ”¾çš„ä¼šè¯ã€‚å¦‚æœè¯¥è¿æ¥çš„å¤„ç†ç¨‹åºåœ¨`smb2_sess_setup`å‡½æ•°ä¸­ï¼Œåˆ™å¯èƒ½ä¼šä½¿ç”¨`sess->user`ï¼Œå¯¼è‡´use-after-freeã€‚

æ ¹æ®æä¾›çš„PoCä»£ç ï¼Œæ”»å‡»è€…åˆ©ç”¨krb5è®¤è¯æµç¨‹ä¸­çš„ä¸€ä¸ªç«äº‰æ¡ä»¶ã€‚åœ¨`krb5_authenticate`å‡½æ•°ä¸­ï¼Œå¦‚æœä¼šè¯æœ‰æ•ˆï¼Œ`sess->user`ä¼šè¢«æå‰é‡Šæ”¾ï¼Œç„¶åå°è¯•è¿›è¡Œkrb5è®¤è¯ã€‚å¦‚æœkrb5è®¤è¯å¤±è´¥ï¼Œ`sess->user`å°†ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œä½†ä¼šè¯ä»ç„¶å­˜åœ¨ï¼Œç•™ä¸‹æ‚¬æŒ‚æŒ‡é’ˆï¼Œå¯¼è‡´åç»­è®¿é—®è¯¥æŒ‡é’ˆæ—¶è§¦å‘use-after-freeæ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  åˆ©ç”¨PoCä¸­çš„krb5è®¤è¯æ–¹æ³•ï¼Œæ„é€ æ¶æ„çš„SMBè¯·æ±‚æ•°æ®åŒ…ï¼Œè§¦å‘`krb5_authenticate`å‡½æ•°ä¸­çš„æ¼æ´ä»£ç ã€‚
2.  å‘é€SMB2ä¼šè¯å»ºç«‹è¯·æ±‚ï¼Œè¿›è¡Œkrb5è®¤è¯ã€‚
3.  åœ¨`ksmbd_krb5_authenticate`å‡½æ•°ä¸­ï¼Œé€šè¿‡ç‰¹å®šçš„è¾“å…¥è§¦å‘è®¤è¯å¤±è´¥ï¼Œä¾‹å¦‚æä¾›æ— æ•ˆçš„SPNEGOä»¤ç‰Œæˆ–krb5ç¥¨æ®ã€‚
4.  è®¤è¯å¤±è´¥åï¼Œ`sess->user`ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œåç»­è®¿é—®è§¦å‘use-after-freeã€‚
5.  åˆ©ç”¨use-after-freeæ¼æ´ï¼Œæ§åˆ¶ç¨‹åºæ‰§è¡Œæµç¨‹æˆ–é€ æˆæ‹’ç»æœåŠ¡ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®åˆ†æå’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ï¼ŒPoCä»£ç éªŒè¯äº†æ­¤æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ä»£ç ä»“åº“ä¸»è¦åŒ…å«æ¼æ´åˆ†ææ–‡æ¡£ï¼Œauditè¯·æ±‚å’Œåˆ©ç”¨ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†ä½œè€…å¯èƒ½éšè—äº†æœªå…¬å¼€çš„åˆ©ç”¨æ–¹å¼ã€‚ç”±äºè¯¥PoCçš„ç›®çš„æ˜¯å±•ç¤ºæ¼æ´å‘ç°çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥å­˜åœ¨ä¸€å®šä½é£é™©çš„æŠ•æ¯’å¯èƒ½ï¼Œä½†æ¦‚ç‡è¾ƒä½ã€‚ è¯„ä¼°æŠ•æ¯’é£é™©ä¸º5%ã€‚


**é¡¹ç›®åœ°å€:** [SeanHeelan/o3_finds_cve-2025-37899](https://github.com/SeanHeelan/o3_finds_cve-2025-37899)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-37899](https://nvd.nist.gov/vuln/detail/CVE-2025-37899)

---

## POC #2

**æ¥æº**: [CVE-2025-37899-vett3x_SMB-LINUX-CVE-2025-37899.md](../2025/CVE-2025-37899-vett3x_SMB-LINUX-CVE-2025-37899.md)

# CVE-2025-37899

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-37899-SeanHeelan_o3_finds_cve-2025-37899.md](../2025/CVE-2025-37899-SeanHeelan_o3_finds_cve-2025-37899.md)

## CVE-2025-37899 - Linux Kernel ksmbd use-after-free

**æ¼æ´ç¼–å·:** CVE-2025-37899

**æ¼æ´ç±»å‹:** Use-After-Free

**å½±å“åº”ç”¨:** Linux Kernel ksmbd

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ‹’ç»æœåŠ¡æˆ–ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 5.15 <= version < 6.12.28, 5.15 <= version < 6.14.6, 5.15 <= version < 6.15-rc5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å¯ç”¨ksmbdæœåŠ¡ï¼Œå¹¶é€šè¿‡SMBåè®®ä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹è¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-37899æ˜¯Linuxå†…æ ¸ksmbdæœåŠ¡ä¸­å‘ç°çš„use-after-freeæ¼æ´ï¼Œå­˜åœ¨äºä¼šè¯æ³¨é”€è¿‡ç¨‹ä¸­ã€‚

**æ¼æ´åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œæ¼æ´ä½äº`fs/smb/server/smb2pdu.c`æ–‡ä»¶ä¸­ã€‚å½“ä¼šè¯æ³¨é”€æ—¶ï¼Œ`sess->user`å¯¹è±¡å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹ä½¿ç”¨ï¼Œä¾‹å¦‚å¦ä¸€ä¸ªè¿æ¥å‘é€äº†ä¼šè¯è®¾ç½®è¯·æ±‚å¹¶ç»‘å®šåˆ°æ­£åœ¨é‡Šæ”¾çš„ä¼šè¯ã€‚å¦‚æœè¯¥è¿æ¥çš„å¤„ç†ç¨‹åºåœ¨`smb2_sess_setup`å‡½æ•°ä¸­ï¼Œåˆ™å¯èƒ½ä¼šä½¿ç”¨`sess->user`ï¼Œå¯¼è‡´use-after-freeã€‚

æ ¹æ®æä¾›çš„PoCä»£ç ï¼Œæ”»å‡»è€…åˆ©ç”¨krb5è®¤è¯æµç¨‹ä¸­çš„ä¸€ä¸ªç«äº‰æ¡ä»¶ã€‚åœ¨`krb5_authenticate`å‡½æ•°ä¸­ï¼Œå¦‚æœä¼šè¯æœ‰æ•ˆï¼Œ`sess->user`ä¼šè¢«æå‰é‡Šæ”¾ï¼Œç„¶åå°è¯•è¿›è¡Œkrb5è®¤è¯ã€‚å¦‚æœkrb5è®¤è¯å¤±è´¥ï¼Œ`sess->user`å°†ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œä½†ä¼šè¯ä»ç„¶å­˜åœ¨ï¼Œç•™ä¸‹æ‚¬æŒ‚æŒ‡é’ˆï¼Œå¯¼è‡´åç»­è®¿é—®è¯¥æŒ‡é’ˆæ—¶è§¦å‘use-after-freeæ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  åˆ©ç”¨PoCä¸­çš„krb5è®¤è¯æ–¹æ³•ï¼Œæ„é€ æ¶æ„çš„SMBè¯·æ±‚æ•°æ®åŒ…ï¼Œè§¦å‘`krb5_authenticate`å‡½æ•°ä¸­çš„æ¼æ´ä»£ç ã€‚
2.  å‘é€SMB2ä¼šè¯å»ºç«‹è¯·æ±‚ï¼Œè¿›è¡Œkrb5è®¤è¯ã€‚
3.  åœ¨`ksmbd_krb5_authenticate`å‡½æ•°ä¸­ï¼Œé€šè¿‡ç‰¹å®šçš„è¾“å…¥è§¦å‘è®¤è¯å¤±è´¥ï¼Œä¾‹å¦‚æä¾›æ— æ•ˆçš„SPNEGOä»¤ç‰Œæˆ–krb5ç¥¨æ®ã€‚
4.  è®¤è¯å¤±è´¥åï¼Œ`sess->user`ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œåç»­è®¿é—®è§¦å‘use-after-freeã€‚
5.  åˆ©ç”¨use-after-freeæ¼æ´ï¼Œæ§åˆ¶ç¨‹åºæ‰§è¡Œæµç¨‹æˆ–é€ æˆæ‹’ç»æœåŠ¡ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®åˆ†æå’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ï¼ŒPoCä»£ç éªŒè¯äº†æ­¤æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ä»£ç ä»“åº“ä¸»è¦åŒ…å«æ¼æ´åˆ†ææ–‡æ¡£ï¼Œauditè¯·æ±‚å’Œåˆ©ç”¨ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†ä½œè€…å¯èƒ½éšè—äº†æœªå…¬å¼€çš„åˆ©ç”¨æ–¹å¼ã€‚ç”±äºè¯¥PoCçš„ç›®çš„æ˜¯å±•ç¤ºæ¼æ´å‘ç°çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥å­˜åœ¨ä¸€å®šä½é£é™©çš„æŠ•æ¯’å¯èƒ½ï¼Œä½†æ¦‚ç‡è¾ƒä½ã€‚ è¯„ä¼°æŠ•æ¯’é£é™©ä¸º5%ã€‚


**é¡¹ç›®åœ°å€:** [SeanHeelan/o3_finds_cve-2025-37899](https://github.com/SeanHeelan/o3_finds_cve-2025-37899)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-37899](https://nvd.nist.gov/vuln/detail/CVE-2025-37899)

---

## POC #2

**æ¥æº**: [CVE-2025-37899-vett3x_SMB-LINUX-CVE-2025-37899.md](../2025/CVE-2025-37899-vett3x_SMB-LINUX-CVE-2025-37899.md)

# CVE-2025-37899

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-37899-SeanHeelan_o3_finds_cve-2025-37899.md](../2025/CVE-2025-37899-SeanHeelan_o3_finds_cve-2025-37899.md)

## CVE-2025-37899 - Linux Kernel ksmbd use-after-free

**æ¼æ´ç¼–å·:** CVE-2025-37899

**æ¼æ´ç±»å‹:** Use-After-Free

**å½±å“åº”ç”¨:** Linux Kernel ksmbd

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ‹’ç»æœåŠ¡æˆ–ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 5.15 <= version < 6.12.28, 5.15 <= version < 6.14.6, 5.15 <= version < 6.15-rc5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å¯ç”¨ksmbdæœåŠ¡ï¼Œå¹¶é€šè¿‡SMBåè®®ä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹è¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-37899æ˜¯Linuxå†…æ ¸ksmbdæœåŠ¡ä¸­å‘ç°çš„use-after-freeæ¼æ´ï¼Œå­˜åœ¨äºä¼šè¯æ³¨é”€è¿‡ç¨‹ä¸­ã€‚

**æ¼æ´åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œæ¼æ´ä½äº`fs/smb/server/smb2pdu.c`æ–‡ä»¶ä¸­ã€‚å½“ä¼šè¯æ³¨é”€æ—¶ï¼Œ`sess->user`å¯¹è±¡å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹ä½¿ç”¨ï¼Œä¾‹å¦‚å¦ä¸€ä¸ªè¿æ¥å‘é€äº†ä¼šè¯è®¾ç½®è¯·æ±‚å¹¶ç»‘å®šåˆ°æ­£åœ¨é‡Šæ”¾çš„ä¼šè¯ã€‚å¦‚æœè¯¥è¿æ¥çš„å¤„ç†ç¨‹åºåœ¨`smb2_sess_setup`å‡½æ•°ä¸­ï¼Œåˆ™å¯èƒ½ä¼šä½¿ç”¨`sess->user`ï¼Œå¯¼è‡´use-after-freeã€‚

æ ¹æ®æä¾›çš„PoCä»£ç ï¼Œæ”»å‡»è€…åˆ©ç”¨krb5è®¤è¯æµç¨‹ä¸­çš„ä¸€ä¸ªç«äº‰æ¡ä»¶ã€‚åœ¨`krb5_authenticate`å‡½æ•°ä¸­ï¼Œå¦‚æœä¼šè¯æœ‰æ•ˆï¼Œ`sess->user`ä¼šè¢«æå‰é‡Šæ”¾ï¼Œç„¶åå°è¯•è¿›è¡Œkrb5è®¤è¯ã€‚å¦‚æœkrb5è®¤è¯å¤±è´¥ï¼Œ`sess->user`å°†ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œä½†ä¼šè¯ä»ç„¶å­˜åœ¨ï¼Œç•™ä¸‹æ‚¬æŒ‚æŒ‡é’ˆï¼Œå¯¼è‡´åç»­è®¿é—®è¯¥æŒ‡é’ˆæ—¶è§¦å‘use-after-freeæ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  åˆ©ç”¨PoCä¸­çš„krb5è®¤è¯æ–¹æ³•ï¼Œæ„é€ æ¶æ„çš„SMBè¯·æ±‚æ•°æ®åŒ…ï¼Œè§¦å‘`krb5_authenticate`å‡½æ•°ä¸­çš„æ¼æ´ä»£ç ã€‚
2.  å‘é€SMB2ä¼šè¯å»ºç«‹è¯·æ±‚ï¼Œè¿›è¡Œkrb5è®¤è¯ã€‚
3.  åœ¨`ksmbd_krb5_authenticate`å‡½æ•°ä¸­ï¼Œé€šè¿‡ç‰¹å®šçš„è¾“å…¥è§¦å‘è®¤è¯å¤±è´¥ï¼Œä¾‹å¦‚æä¾›æ— æ•ˆçš„SPNEGOä»¤ç‰Œæˆ–krb5ç¥¨æ®ã€‚
4.  è®¤è¯å¤±è´¥åï¼Œ`sess->user`ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œåç»­è®¿é—®è§¦å‘use-after-freeã€‚
5.  åˆ©ç”¨use-after-freeæ¼æ´ï¼Œæ§åˆ¶ç¨‹åºæ‰§è¡Œæµç¨‹æˆ–é€ æˆæ‹’ç»æœåŠ¡ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®åˆ†æå’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ï¼ŒPoCä»£ç éªŒè¯äº†æ­¤æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ä»£ç ä»“åº“ä¸»è¦åŒ…å«æ¼æ´åˆ†ææ–‡æ¡£ï¼Œauditè¯·æ±‚å’Œåˆ©ç”¨ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†ä½œè€…å¯èƒ½éšè—äº†æœªå…¬å¼€çš„åˆ©ç”¨æ–¹å¼ã€‚ç”±äºè¯¥PoCçš„ç›®çš„æ˜¯å±•ç¤ºæ¼æ´å‘ç°çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥å­˜åœ¨ä¸€å®šä½é£é™©çš„æŠ•æ¯’å¯èƒ½ï¼Œä½†æ¦‚ç‡è¾ƒä½ã€‚ è¯„ä¼°æŠ•æ¯’é£é™©ä¸º5%ã€‚


**é¡¹ç›®åœ°å€:** [SeanHeelan/o3_finds_cve-2025-37899](https://github.com/SeanHeelan/o3_finds_cve-2025-37899)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-37899](https://nvd.nist.gov/vuln/detail/CVE-2025-37899)

---

## POC #2

**æ¥æº**: [CVE-2025-37899-vett3x_SMB-LINUX-CVE-2025-37899.md](../2025/CVE-2025-37899-vett3x_SMB-LINUX-CVE-2025-37899.md)

# CVE-2025-37899

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-37899-SeanHeelan_o3_finds_cve-2025-37899.md](../2025/CVE-2025-37899-SeanHeelan_o3_finds_cve-2025-37899.md)

## CVE-2025-37899 - Linux Kernel ksmbd use-after-free

**æ¼æ´ç¼–å·:** CVE-2025-37899

**æ¼æ´ç±»å‹:** Use-After-Free

**å½±å“åº”ç”¨:** Linux Kernel ksmbd

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ‹’ç»æœåŠ¡æˆ–ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 5.15 <= version < 6.12.28, 5.15 <= version < 6.14.6, 5.15 <= version < 6.15-rc5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å¯ç”¨ksmbdæœåŠ¡ï¼Œå¹¶é€šè¿‡SMBåè®®ä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹è¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-37899æ˜¯Linuxå†…æ ¸ksmbdæœåŠ¡ä¸­å‘ç°çš„use-after-freeæ¼æ´ï¼Œå­˜åœ¨äºä¼šè¯æ³¨é”€è¿‡ç¨‹ä¸­ã€‚

**æ¼æ´åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œæ¼æ´ä½äº`fs/smb/server/smb2pdu.c`æ–‡ä»¶ä¸­ã€‚å½“ä¼šè¯æ³¨é”€æ—¶ï¼Œ`sess->user`å¯¹è±¡å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹ä½¿ç”¨ï¼Œä¾‹å¦‚å¦ä¸€ä¸ªè¿æ¥å‘é€äº†ä¼šè¯è®¾ç½®è¯·æ±‚å¹¶ç»‘å®šåˆ°æ­£åœ¨é‡Šæ”¾çš„ä¼šè¯ã€‚å¦‚æœè¯¥è¿æ¥çš„å¤„ç†ç¨‹åºåœ¨`smb2_sess_setup`å‡½æ•°ä¸­ï¼Œåˆ™å¯èƒ½ä¼šä½¿ç”¨`sess->user`ï¼Œå¯¼è‡´use-after-freeã€‚

æ ¹æ®æä¾›çš„PoCä»£ç ï¼Œæ”»å‡»è€…åˆ©ç”¨krb5è®¤è¯æµç¨‹ä¸­çš„ä¸€ä¸ªç«äº‰æ¡ä»¶ã€‚åœ¨`krb5_authenticate`å‡½æ•°ä¸­ï¼Œå¦‚æœä¼šè¯æœ‰æ•ˆï¼Œ`sess->user`ä¼šè¢«æå‰é‡Šæ”¾ï¼Œç„¶åå°è¯•è¿›è¡Œkrb5è®¤è¯ã€‚å¦‚æœkrb5è®¤è¯å¤±è´¥ï¼Œ`sess->user`å°†ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œä½†ä¼šè¯ä»ç„¶å­˜åœ¨ï¼Œç•™ä¸‹æ‚¬æŒ‚æŒ‡é’ˆï¼Œå¯¼è‡´åç»­è®¿é—®è¯¥æŒ‡é’ˆæ—¶è§¦å‘use-after-freeæ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  åˆ©ç”¨PoCä¸­çš„krb5è®¤è¯æ–¹æ³•ï¼Œæ„é€ æ¶æ„çš„SMBè¯·æ±‚æ•°æ®åŒ…ï¼Œè§¦å‘`krb5_authenticate`å‡½æ•°ä¸­çš„æ¼æ´ä»£ç ã€‚
2.  å‘é€SMB2ä¼šè¯å»ºç«‹è¯·æ±‚ï¼Œè¿›è¡Œkrb5è®¤è¯ã€‚
3.  åœ¨`ksmbd_krb5_authenticate`å‡½æ•°ä¸­ï¼Œé€šè¿‡ç‰¹å®šçš„è¾“å…¥è§¦å‘è®¤è¯å¤±è´¥ï¼Œä¾‹å¦‚æä¾›æ— æ•ˆçš„SPNEGOä»¤ç‰Œæˆ–krb5ç¥¨æ®ã€‚
4.  è®¤è¯å¤±è´¥åï¼Œ`sess->user`ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œåç»­è®¿é—®è§¦å‘use-after-freeã€‚
5.  åˆ©ç”¨use-after-freeæ¼æ´ï¼Œæ§åˆ¶ç¨‹åºæ‰§è¡Œæµç¨‹æˆ–é€ æˆæ‹’ç»æœåŠ¡ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®åˆ†æå’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ï¼ŒPoCä»£ç éªŒè¯äº†æ­¤æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ä»£ç ä»“åº“ä¸»è¦åŒ…å«æ¼æ´åˆ†ææ–‡æ¡£ï¼Œauditè¯·æ±‚å’Œåˆ©ç”¨ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†ä½œè€…å¯èƒ½éšè—äº†æœªå…¬å¼€çš„åˆ©ç”¨æ–¹å¼ã€‚ç”±äºè¯¥PoCçš„ç›®çš„æ˜¯å±•ç¤ºæ¼æ´å‘ç°çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥å­˜åœ¨ä¸€å®šä½é£é™©çš„æŠ•æ¯’å¯èƒ½ï¼Œä½†æ¦‚ç‡è¾ƒä½ã€‚ è¯„ä¼°æŠ•æ¯’é£é™©ä¸º5%ã€‚


**é¡¹ç›®åœ°å€:** [SeanHeelan/o3_finds_cve-2025-37899](https://github.com/SeanHeelan/o3_finds_cve-2025-37899)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-37899](https://nvd.nist.gov/vuln/detail/CVE-2025-37899)

---

## POC #2

**æ¥æº**: [CVE-2025-37899-vett3x_SMB-LINUX-CVE-2025-37899.md](../2025/CVE-2025-37899-vett3x_SMB-LINUX-CVE-2025-37899.md)

## CVE-2025-37899 - Linux Kernel ksmbd use-after-free

**æ¼æ´ç¼–å·:** CVE-2025-37899

**æ¼æ´ç±»å‹:** Use-After-Free

**å½±å“åº”ç”¨:** Linux Kernel ksmbd

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ‹’ç»æœåŠ¡æˆ–ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 5.15 <= version < 6.12.28, 5.15 <= version < 6.14.6, 5.15 <= version < 6.15-rc5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å¯ç”¨ksmbdæœåŠ¡ï¼Œå¹¶é€šè¿‡SMBåè®®ä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹è¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-37899æ˜¯Linuxå†…æ ¸ksmbdæœåŠ¡ä¸­å‘ç°çš„use-after-freeæ¼æ´ï¼Œå­˜åœ¨äºä¼šè¯æ³¨é”€è¿‡ç¨‹ä¸­ã€‚

**æ¼æ´åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œæ¼æ´ä½äº`fs/smb/server/smb2pdu.c`æ–‡ä»¶ä¸­ã€‚å½“ä¼šè¯æ³¨é”€æ—¶ï¼Œ`sess->user`å¯¹è±¡å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹ä½¿ç”¨ï¼Œä¾‹å¦‚å¦ä¸€ä¸ªè¿æ¥å‘é€äº†ä¼šè¯è®¾ç½®è¯·æ±‚å¹¶ç»‘å®šåˆ°æ­£åœ¨é‡Šæ”¾çš„ä¼šè¯ã€‚å¦‚æœè¯¥è¿æ¥çš„å¤„ç†ç¨‹åºåœ¨`smb2_sess_setup`å‡½æ•°ä¸­ï¼Œåˆ™å¯èƒ½ä¼šä½¿ç”¨`sess->user`ï¼Œå¯¼è‡´use-after-freeã€‚

æ ¹æ®æä¾›çš„PoCä»£ç ï¼Œæ”»å‡»è€…åˆ©ç”¨krb5è®¤è¯æµç¨‹ä¸­çš„ä¸€ä¸ªç«äº‰æ¡ä»¶ã€‚åœ¨`krb5_authenticate`å‡½æ•°ä¸­ï¼Œå¦‚æœä¼šè¯æœ‰æ•ˆï¼Œ`sess->user`ä¼šè¢«æå‰é‡Šæ”¾ï¼Œç„¶åå°è¯•è¿›è¡Œkrb5è®¤è¯ã€‚å¦‚æœkrb5è®¤è¯å¤±è´¥ï¼Œ`sess->user`å°†ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œä½†ä¼šè¯ä»ç„¶å­˜åœ¨ï¼Œç•™ä¸‹æ‚¬æŒ‚æŒ‡é’ˆï¼Œå¯¼è‡´åç»­è®¿é—®è¯¥æŒ‡é’ˆæ—¶è§¦å‘use-after-freeæ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  åˆ©ç”¨PoCä¸­çš„krb5è®¤è¯æ–¹æ³•ï¼Œæ„é€ æ¶æ„çš„SMBè¯·æ±‚æ•°æ®åŒ…ï¼Œè§¦å‘`krb5_authenticate`å‡½æ•°ä¸­çš„æ¼æ´ä»£ç ã€‚
2.  å‘é€SMB2ä¼šè¯å»ºç«‹è¯·æ±‚ï¼Œè¿›è¡Œkrb5è®¤è¯ã€‚
3.  åœ¨`ksmbd_krb5_authenticate`å‡½æ•°ä¸­ï¼Œé€šè¿‡ç‰¹å®šçš„è¾“å…¥è§¦å‘è®¤è¯å¤±è´¥ï¼Œä¾‹å¦‚æä¾›æ— æ•ˆçš„SPNEGOä»¤ç‰Œæˆ–krb5ç¥¨æ®ã€‚
4.  è®¤è¯å¤±è´¥åï¼Œ`sess->user`ä¿æŒé‡Šæ”¾çŠ¶æ€ï¼Œåç»­è®¿é—®è§¦å‘use-after-freeã€‚
5.  åˆ©ç”¨use-after-freeæ¼æ´ï¼Œæ§åˆ¶ç¨‹åºæ‰§è¡Œæµç¨‹æˆ–é€ æˆæ‹’ç»æœåŠ¡ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®åˆ†æå’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ï¼ŒPoCä»£ç éªŒè¯äº†æ­¤æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ä»£ç ä»“åº“ä¸»è¦åŒ…å«æ¼æ´åˆ†ææ–‡æ¡£ï¼Œauditè¯·æ±‚å’Œåˆ©ç”¨ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†ä½œè€…å¯èƒ½éšè—äº†æœªå…¬å¼€çš„åˆ©ç”¨æ–¹å¼ã€‚ç”±äºè¯¥PoCçš„ç›®çš„æ˜¯å±•ç¤ºæ¼æ´å‘ç°çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥å­˜åœ¨ä¸€å®šä½é£é™©çš„æŠ•æ¯’å¯èƒ½ï¼Œä½†æ¦‚ç‡è¾ƒä½ã€‚ è¯„ä¼°æŠ•æ¯’é£é™©ä¸º5%ã€‚


**é¡¹ç›®åœ°å€:** [SeanHeelan/o3_finds_cve-2025-37899](https://github.com/SeanHeelan/o3_finds_cve-2025-37899)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-37899](https://nvd.nist.gov/vuln/detail/CVE-2025-37899)

---



---



---



---



---



---



---



---



---



---



---



---



---



---



---

