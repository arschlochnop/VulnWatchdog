## CVE-2025-65741 - Sublime Text 3 Dylib Injection (动态库注入)

**漏洞编号:** CVE-2025-65741

**漏洞类型:** Dylib Injection (动态库注入)

**影响应用:** Sublime Text 3

**危害等级:** 中到高 (取决于本地权限及后续利用路径)

**CVSS评分:** CVSS评分暂未完全公布，评估为 7.8 (AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**影响版本:** Sublime Text 3 Build 3208 及更早版本 (macOS)

**利用条件:** 需要本地执行环境或通过诱导用户运行特定命令；目标系统为 macOS

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-65741是一个针对macOS平台上Sublime Text 3编辑器的库注入漏洞。该漏洞的核心在于Sublime Text 3 Build 3208及更早版本在加载动态库时，未能正确验证二进制文件的签名或代码签名权限，导致其可以被强制加载外部未签名的.dylib文件。POC有效性分析：提供的POC代码通过定义一个具有__attribute__((constructor))属性的C函数，确保了该动态库一旦被进程加载，就会立即执行其中的恶意代码（在本例中为启动计算器）。通过设置环境变量DYLIB_INSERT_LIBRARIES并指向编译好的.dylib文件，攻击者可以直接在Sublime Text的进程上下文中执行任意代码。此攻击方式在macOS安全语境下属于典型的“库注入”，它允许恶意代码绕过常规的应用层限制，继承主应用的权限。利用步骤：首先，攻击者编写包含恶意payload的C语言源码；其次，使用gcc编译器将其编译为针对x86_64架构（或通用架构）的动态库（.dylib）；最后，利用macOS动态链接器的特性，通过命令行启动Sublime Text并插入该库。由于Sublime Text在该版本中缺乏Hardened Runtime（强化运行时）保护或未正确配置Library Validation，注入将直接成功。投毒风险分析：该POC项目展现出极高的透明度和教育意义，其投毒风险极低，约为5%。代码逻辑极其清晰，仅依赖标准库stdio.h和stdlib.h，没有任何混淆处理。Payload部分明确指向了/System/Applications/Calculator.app，这是安全研究领域公认的无害化概念验证标志（即“弹计算器”）。编译命令和运行指令均为标准操作，不包含任何尝试连接外部服务器、下载恶意脚本、读取用户私钥或修改系统持久化配置的操作。虽然漏洞本身属于代码执行类，但POC本身是纯净的防御性研究工具。防御者应注意，该漏洞已在Build 3209中修复，建议用户尽快升级。对于安全团队，应监控DYLIB_INSERT_LIBRARIES这类敏感环境变量的异常使用，并确保存储在应用目录下的二进制文件具有完整的代码签名校验。

**项目地址:** [https://github.com/user-attachments/assets/3ba45f05-b54a-4d79-9c66-b09562a2200f](https://github.com/user-attachments/assets/3ba45f05-b54a-4d79-9c66-b09562a2200f) (Reference via README)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-65741](https://nvd.nist.gov/vuln/detail/CVE-2025-65741)
