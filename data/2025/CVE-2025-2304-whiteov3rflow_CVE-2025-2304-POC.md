## CVE-2025-2304 - Camaleon CMS 权限提升 (Privilege Escalation), 质量赋值 (Mass Assignment)

**漏洞编号:** CVE-2025-2304

**漏洞类型:** 权限提升 (Privilege Escalation), 质量赋值 (Mass Assignment)

**影响应用:** Camaleon CMS

**危害等级:** 高危

**CVSS评分:** N/A

**影响版本:** < 2.9.1

**利用条件:** 需要认证 (Authenticated)

**POC 可用性:** 9/10

**POC 类型:** 完整利用 (Full Exploitation)

**攻击复杂度:** 中 (Medium)

**投毒风险:** 10%

## 详情

POC有效性分析: 提供的POC包含Python脚本`exploit.py`和`README.md`。漏洞为Camaleon CMS < 2.9.1的质量赋值权限提升。`exploit.py`是一个完整的利用脚本，它首先使用提供的凭据登录CMS，获取CSRF令牌。随后，脚本获取当前用户ID和用于密码更新的CSRF令牌。核心步骤是向`/admin/users/{user_id}/updated_ajax`发送PATCH请求，注入`password[role]=admin`参数，利用质量赋值漏洞将当前用户权限提升为管理员。脚本使用Python `requests`库和正则表达式处理HTTP通信和信息解析。`README.md`中的截图证实了攻击成功。该POC代码有效且直接地复现了所述漏洞。
利用步骤:
1. 确认目标Camaleon CMS版本低于2.9.1。
2. 准备一个有效的非管理员账户凭据。
3. 执行：`python3 exploit.py <目标URL> <用户名> <密码>`。
4. 例：`python3 exploit.py http://target.com attacker attacker`。
5. 脚本将自动完成登录、令牌获取及权限提升。
6. 攻击成功后，需登出并重新登录以激活管理员权限。
投毒风险分析: 对`exploit.py`脚本的代码审查显示，其投毒风险极低。脚本仅依赖Python标准库 `requests`, `re`, `sys`，这些均为安全且广泛使用的组件。代码逻辑透明，无混淆。功能仅限于利用Camaleon CMS的特定漏洞进行权限提升演示。未发现任何连接外部C2、窃取数据、下载恶意载荷或创建额外后门的迹象。`requests.packages.urllib3.disable_warnings()`仅用于禁用SSL警告，不具恶意性。该POC是纯粹的漏洞验证工具，不含额外恶意功能。

**项目地址:** N/A

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-2304
