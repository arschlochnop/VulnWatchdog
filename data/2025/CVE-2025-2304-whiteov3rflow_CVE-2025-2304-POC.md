## CVE-2025-2304 - Camaleon CMS Privilege Escalation

**漏洞编号:** CVE-2025-2304

**漏洞类型:** Privilege Escalation

**影响应用:** Camaleon CMS

**危害等级:** High

**CVSS评分:** 

**影响版本:** versions prior to 2.9.1

**利用条件:** 需要认证

**POC 可用性:** 10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

The provided Python script (`exploit.py`) for CVE-2025-2304 is a robust and highly effective tool designed to demonstrate and exploit the privilege escalation vulnerability in Camaleon CMS. This vulnerability, stemming from a mass assignment flaw in versions prior to 2.9.1, allows an authenticated user to elevate their role to administrator. The script systematically automates the entire attack chain. It begins by performing an authenticated login to the target Camaleon CMS instance using the provided username and password. During this phase, it intelligently extracts the necessary anti-CSRF token from the login page, a crucial step for bypassing typical web application security controls. Following successful authentication, the script navigates to the user's profile edit page. Here, it dynamically identifies the unique user ID associated with the logged-in account and retrieves another anti-CSRF token specifically designated for the profile update form. This meticulous token handling significantly enhances the reliability of the exploit.

The core of the exploitation lies in a carefully crafted HTTP POST request sent to the `/admin/users/{user_id}/updated_ajax` endpoint. This request mimics a legitimate password change operation but cleverly injects an additional parameter: `password[role]=admin`. This `password` hash structure, combined with the `role` key, leverages the mass assignment vulnerability. The application, without proper input sanitization or whitelist filtering for parameters that can be mass-assigned, inadvertently processes the `role` parameter, thereby updating the user's role to 'admin'. The script uses the `requests` library, a standard and reliable Python module for HTTP communications, ensuring seamless interaction with the target web server. It also correctly sets HTTP headers like `X-Requested-With`, `X-CSRF-Token`, and `Referer`, which are often checked by modern web applications to prevent cross-site request forgery and other attacks. The exploit’s success is indicated by an HTTP 200 status code, confirming the server processed the request as intended. After the script reports success, the user is advised to log out and then log back into the Camaleon CMS. This re-authentication step is typically required for changes in user roles or permissions to fully take effect within a session. The overall design of the POC demonstrates a thorough understanding of the vulnerability and the target application's architecture, making it a complete and practical exploitation tool. The visual confirmation suggested by the README's screenshot (though not directly viewable here) further implies the effectiveness of this exploit in achieving the advertised privilege escalation.

Exploitation Steps:
1.  **Prerequisites**: Ensure the target server is running a vulnerable version of Camaleon CMS (specifically, any version older than 2.9.1). You must also possess valid login credentials for any non-administrative user account on the CMS.
2.  **Obtain the POC**: Download the `exploit.py` script from its source (or use the provided local copy).
3.  **Execute the Script**: Open a terminal or command prompt and run the exploit using Python 3. The syntax is `python3 exploit.py <target_url> <username> <password>`. Replace `<target_url>` with the base URL of the Camaleon CMS instance (e.g., `http://target.com`), and `<username>` and `<password>` with the credentials of the authenticated user you wish to escalate.
4.  **Monitor Output**: The script will provide real-time feedback on its progress, including login attempts, CSRF token retrieval, user ID discovery, and the status of the exploit payload delivery.
5.  **Verify Escalation**: Upon successful execution (indicated by the script's output), log out from the Camaleon CMS web interface. Immediately after, log back in using the *same* username and password. You should now find that your user account has been successfully elevated to administrator privileges, granting full control over the CMS.

Poisoning Risk Analysis: The poisoning risk associated with the `exploit.py` script for CVE-2025-2304 is remarkably low, assessed at approximately 5%. This low rating is attributed to several key factors observed during a detailed security review of the script's source code. Firstly, the script is written in clear, human-readable Python 3, a widely adopted programming language. Its logic is straightforward, devoid of any obfuscation techniques, making it easy for any security researcher or administrator to audit its functionality line by line. All imported modules are standard and legitimate; the script primarily uses the `requests` library, which is a reputable and commonly used tool for handling HTTP communications in Python. There are no indications of attempts to load or execute external, untrusted code or binaries.

Crucially, the script does not contain any suspicious functionalities beyond its stated purpose of exploiting the Camaleon CMS privilege escalation vulnerability. It does not attempt to establish reverse shells, exfiltrate sensitive data from the local machine, install persistent backdoors, or perform any actions that could compromise the system where the exploit is executed. The network interactions are strictly confined to targeting the specified Camaleon CMS instance with precisely defined HTTP requests. The `data` payload, which includes the malicious `password[role]=admin` parameter, is explicitly visible in the code, leaving no ambiguity about its intent. Furthermore, the use of `requests.packages.urllib3.disable_warnings()` is a benign practice often employed in testing environments to bypass SSL certificate warnings and does not introduce a security vulnerability in the script itself. While any public exploit could theoretically be modified by malicious actors, the original code for `exploit.py` adheres to best practices for a defensive security tool. Its transparency and reliance on standard, well-vetted components significantly reduce the inherent risk of 'poisoning' for legitimate users who acquire and utilize this specific version of the POC. Users are always encouraged to review any code, especially exploit code, before execution, but in this instance, the code's clarity offers considerable assurance of its safety and purpose-driven nature.

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-2304
