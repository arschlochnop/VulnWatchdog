## CVE-2025-2304 - Camaleon CMS 权限提升 (Mass Assignment)

**漏洞编号:** CVE-2025-2304

**漏洞类型:** 权限提升 (Mass Assignment)

**影响应用:** Camaleon CMS

**危害等级:** 高危

**CVSS评分:** N/A

**影响版本:** < 2.9.1

**利用条件:** 需要认证 (普通用户凭据), 需要网络访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

POC有效性分析:
提供的POC（`exploit.py`脚本）非常有效地利用了Camaleon CMS（版本低于2.9.1）中的一个权限提升漏洞（CVE-2025-2304）。此漏洞是由于`updated_ajax`方法中存在的大量赋值（Mass Assignment）缺陷导致的。脚本的设计旨在模拟合法的用户交互流程，使得漏洞利用过程流畅且可靠。

首先，脚本使用提供的非管理员用户名和密码对目标Camaleon CMS实例进行身份验证，这一关键步骤确保攻击者在一个已认证的会话中操作，满足了漏洞利用的首要条件。成功登录后，脚本会智能地访问`/admin/profile/edit`页面，并利用正则表达式从页面的HTML内容中提取两个至关重要的信息：反跨站请求伪造（CSRF）令牌（`authenticity_token`）和与当前认证账户关联的用户ID（`user_id`）。这些令牌对于绕过CMS的安全机制、确保后续恶意请求被接受至关重要。

漏洞利用的核心在于向`/admin/users/{user_id}/updated_ajax`端点发送一个精心构造的POST请求。该请求的`data`负载中，除了标准的密码更新字段（`password[password]`和`password[password_confirmation]`）之外，还特别包含了`password[role]=admin`参数。这种大量赋值的漏洞允许`role`属性被直接通过输入修改，尽管对于普通用户而言，这个字段通常是不可访问的。脚本还正确设置了`X-Requested-With: XMLHttpRequest`和`X-CSRF-Token`头部，以模拟AJAX请求，这通常是此类漏洞的特定入口点。当接收到此POST请求的HTTP 200状态码响应时，脚本即认为漏洞利用成功。`README.md`明确指示用户登出并重新登录以观察已提升的权限，这是会话角色更改生效的常见要求。

根据清晰的代码逻辑、对漏洞的精确目标定位以及包含的成功利用截图，该POC具有很高的有效性，为在受影响的Camaleon CMS安装上获取管理员权限提供了一个可靠且自动化的方法。它所需的设置极少，可直接执行，证实了其作为完整利用工具的实用性。

利用步骤:
1.  **环境准备**: 确保攻击机器上安装了Python 3环境，并且已安装`requests`库。如果未安装，可通过`pip install requests`命令进行安装。
2.  **获取POC**: 获得`exploit.py`脚本文件。
3.  **目标识别**: 确定受Camaleon CMS漏洞影响的目标系统URL，以及一个已知的普通用户凭据（用户名和密码）。
4.  **执行脚本**: 打开命令行终端，执行以下命令，将`http://target.com`替换为实际目标URL，`attacker`替换为普通用户的用户名和密码：
    `python3 exploit.py http://target.com attacker attacker`
5.  **确认提升**: 脚本成功执行后，会显示“Login successful!”和“Sending exploit...”等信息。此时，用户需手动从Camaleon CMS中登出，然后使用相同的`attacker`用户名和密码重新登录。
6.  **验证结果**: 重新登录后，用户界面和可访问的功能将显示其账户已拥有管理员权限，验证了权限提升的成功。

投毒风险分析:
对提供的`exploit.py`脚本进行详细的代码审计后，我们评估其投毒风险为**低**，具体百分比约为10%。这一评估基于对脚本内容、行为模式和所用库的全面分析。

代码透明度和可读性: 脚本代码是纯Python，结构清晰，逻辑直接，没有经过任何形式的代码混淆。这意味着任何具有Python基础知识的安全研究人员都可以轻松地审查其完整功能，并验证其不包含隐藏的恶意负载。

标准库依赖: `exploit.py`仅依赖于Python的标准库（`sys`用于命令行参数、`re`用于正则表达式解析）以及一个广泛认可和安全的第三方库`requests`。`requests`库是Python生态系统中进行HTTP通信的事实标准，其安全性经过了大量社区的验证。脚本中未引入任何来源不明或可疑的外部库，这显著降低了引入供应链攻击的风险。

无外部资源加载或代码执行: 脚本的核心功能完全限定在执行HTTP请求和解析响应。它未尝试从任何外部（非目标CMS）URL下载或执行额外的代码或二进制文件。同时，代码中不包含`eval()`、`exec()`等动态代码执行函数的使用，这些函数往往是恶意POC利用来加载或执行混淆代码的常见途径。

非入侵性操作: 该脚本的目的仅在于修改目标CMS数据库中特定用户的权限角色，使其从普通用户变为管理员。它不涉及任何文件系统操作（如创建、修改、删除非临时文件）、操作系统命令执行（RCE），也不包含建立反向Shell、数据窃取、加密货币挖矿或DDoS攻击等恶意负载。

有限的网络交互: 除与目标Camaleon CMS实例进行合法的登录、信息获取和权限提升请求外，脚本未进行任何其他出站网络连接。这表明它没有尝试与攻击者的命令与控制（C2）服务器通信，也不会将任何敏感信息（如受害者IP、系统指纹）回传。

SSL警告禁用: 脚本中包含`requests.packages.urllib3.disable_warnings()`，用于禁用SSL/TLS证书验证警告。虽然在生产环境中不鼓励这种做法，因为它可能导致中间人攻击的风险，但在漏洞利用和测试场景中，为了简化测试过程或应对自签名证书，这种做法非常普遍，且其本身并非恶意行为。

结论: 综合来看，该POC脚本被认为是一个专注于其声明目标的、无额外恶意行为的干净工具。其高度透明的代码、对标准库的依赖以及缺乏任何可疑操作，使其投毒风险保持在较低水平。防御者在使用此POC进行测试和验证时，可以相对放心地运行它，而无需担心其引入其他隐性威胁。

**项目地址:** N/A

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-2304
