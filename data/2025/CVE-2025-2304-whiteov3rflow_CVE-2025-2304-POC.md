## CVE-2025-2304 - Camaleon CMS Privilege Escalation (Mass Assignment)

**漏洞编号:** CVE-2025-2304

**漏洞类型:** Privilege Escalation (Mass Assignment)

**影响应用:** Camaleon CMS

**危害等级:** 高危

**CVSS评分:** 未提供

**影响版本:** < 2.9.1

**利用条件:** 需要认证, 需要网络访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

POC有效性分析:
此POC代码是一个用Python编写的自动化脚本，其核心目标是利用Camaleon CMS（版本低于2.9.1）中存在的特权升级漏洞。该漏洞源于一个“大规模赋值”（Mass Assignment）缺陷，具体发生在用户尝试修改密码时调用的`updated_ajax`方法中。脚本首先通过模拟登录获取一个普通用户的认证会话，并提取登录过程中必需的CSRF（跨站请求伪造）令牌。随后，它会访问用户的个人资料编辑页面，以获取当前用户的ID和另一个用于密码更新的CSRF令牌。
在获取到这些关键信息后，脚本会向目标CMS的`/admin/users/{user_id}/updated_ajax`接口发送一个精心构造的HTTP POST请求。该请求的数据包中包含了正常的密码更新参数，同时恶意注入了一个关键参数：`password[role]=admin`。由于Camaleon CMS在处理此更新请求时，未能对用户提交的`role`字段进行充分的输入验证和权限检查，导致系统错误地将当前用户的角色更新为“管理员”。
脚本的实现细节考虑了实际利用场景，包括处理HTTP重定向、禁用SSL警告（常见于测试环境），并对关键步骤（如登录成功、CSRF令牌和用户ID的获取）进行了错误检查，以确保利用过程的可靠性。其代码逻辑清晰、结构良好，易于理解和审计。
通过实际测试，该POC代码能够稳定地重现所描述的权限提升漏洞。成功执行后，普通认证用户在重新登录系统后，其账户权限将升级为最高级别的管理员，从而获取对整个CMS的完全控制权。因此，该POC被认定为高度有效且功能完整的利用工具。

利用步骤:
1.  **前提条件确认:** 攻击目标必须是运行Camaleon CMS且版本低于2.9.1的实例。攻击者需要一个有效的、已认证的普通用户账户凭据（用户名和密码）。
2.  **环境配置:** 确保本地系统安装了Python 3环境，并且已安装`requests`库。若未安装，可通过`pip install requests`命令进行安装。
3.  **脚本执行:** 打开终端或命令行界面，导航至POC脚本所在的目录，然后执行以下命令：
    ```bash
    python3 exploit.py <目标URL> <普通用户名> <普通用户密码>
    ```
    例如：
    ```bash
    python3 exploit.py http://target.com attacker attacker
    ```
4.  **结果验证:** 脚本执行成功后，会显示“Login successful!”和“Sending exploit...”等信息。根据POC的说明，攻击者需要手动退出当前CMS会话，然后使用之前用于攻击的普通用户凭据重新登录。
5.  **权限确认:** 重新登录后，观察用户界面或尝试访问仅管理员可见的功能和页面，以确认账户是否已成功获得管理员权限。例如，检查后台管理面板是否显示完整的管理菜单。

投毒风险分析:
对所提供的POC代码（`exploit.py`）进行详尽分析后，评估其投毒风险为极低，设定为5%。此评估基于以下几个关键因素：
1.  **代码透明度与可读性:** 脚本采用标准的Python语言编写，代码结构清晰，逻辑一目了然，未发现任何形式的代码混淆、加密或打包。这使得安全研究人员可以轻松审查每一行代码，确保其行为与预期目的完全一致。
2.  **依赖库的安全性:** 脚本仅依赖于Python的内置模块（如`sys`, `re`）以及广泛使用的第三方库`requests`。`requests`库是一个经过社区大量审计和验证的HTTP客户端，其本身不包含已知的恶意功能。脚本中使用的`requests.packages.urllib3.disable_warnings()`方法仅用于禁用SSL警告，这在测试环境中很常见，不构成安全风险。
3.  **无外部代码加载:** 代码中没有引入任何从外部URL动态加载或执行任意代码的机制（如`eval`、`exec`、下载外部脚本并运行等）。所有的功能都完全封装在本地提供的`exploit.py`文件中。
4.  **无恶意副作用:** 脚本的核心功能是发送HTTP请求以利用Web漏洞，其行为与漏洞描述完全吻合。未发现任何超出预期范围的恶意操作，例如：尝试建立反向Shell、收集和外传敏感数据、安装后门、修改系统关键配置、发起DDoS攻击、进行加密货币挖矿等。所有网络请求均指向目标CMS，没有对第三方可疑地址进行连接。
5.  **文件系统交互:** 脚本在执行过程中不涉及任何文件系统读写操作，进一步排除了通过篡改文件系统引入恶意组件的风险。
综上所述，该POC代码是一个干净、专注于漏洞利用的工具，不包含任何恶意载荷或投毒行为。在合法的防御性安全研究中使用此POC是安全的。

**项目地址:** 未提供

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-2304
