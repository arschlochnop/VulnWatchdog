## CVE-2025-2304 - Camaleon CMS 特权升级 (Privilege Escalation), 批量赋值 (Mass Assignment)

**漏洞编号:** CVE-2025-2304

**漏洞类型:** 特权升级 (Privilege Escalation), 批量赋值 (Mass Assignment)

**影响应用:** Camaleon CMS

**危害等级:** 高

**CVSS评分:** 

**影响版本:** < 2.9.1

**利用条件:** 需要认证, 需要网络访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

POC有效性分析: 该Python脚本`CVE-2025-2304.py`是一个针对Camaleon CMS批量赋值特权升级漏洞（CVE-2025-2304）的完整功能性利用工具。脚本结构良好，使用标准Python库，如`requests`进行HTTP通信、`BeautifulSoup`进行HTML解析以及`argparse`处理命令行参数。脚本能够准确识别并提取登录和个人资料页面中的CSRF（跨站请求伪造）token，处理用户认证，并针对`/admin/profile/updated_ajax`端点发起攻击。漏洞利用的核心在于脚本通过在合法的密码更改参数中巧妙地注入`password[role]=admin`参数。由于受影响的端点错误地使用了`permit!`方法，未能正确过滤所有传入的参数，导致`password[role]=admin`被处理并更新了当前用户的角色为管理员。脚本包含了健全的错误处理机制，能够应对网络问题和CSRF token获取失败的情况，并通过在漏洞利用后尝试重新获取用户角色信息来验证是否成功升级到管理员权限。代码清晰可读，自成一体，并且似乎能够可靠地将已认证用户提升为Camaleon CMS受影响版本中的管理员。

利用步骤:
1.  **环境准备**: 确保目标Camaleon CMS版本低于2.9.1。攻击者需要一个有效的Camaleon CMS用户账户及其凭据。
2.  **下载POC**: 获取提供的Python POC脚本`CVE-2025-2304.py`。
3.  **安装依赖**: 如果尚未安装，需要安装Python依赖库，特别是`requests`和`BeautifulSoup4`。可以使用`pip install requests beautifulsoup4`命令进行安装。
4.  **执行POC**: 使用命令行运行脚本，提供目标CMS的URL、已认证的用户名和密码。
    *   示例命令：`python3 CVE-2025-2304.py http://TARGET_CMS_URL -u YOUR_USERNAME -p YOUR_PASSWORD`
5.  **POC执行流程**: 
    *   脚本首先使用提供的凭据尝试登录到Camaleon CMS的`/admin/login`页面。
    *   在登录过程中，它会从登录页面抓取CSRF token，以确保后续POST请求的有效性。
    *   成功登录后，脚本将访问`/admin/profile/edit`页面，尝试获取当前用户的ID和角色信息。
    *   脚本构造一个恶意请求，目标是`/admin/profile/updated_ajax`端点。此请求包含一个新的密码（可以是旧密码或新密码），但关键在于它额外注入了`password[role]=admin`参数。
    *   由于CMS在该端点使用了不当的`permit!`方法，未能正确过滤输入参数，`password[role]=admin`参数会被处理并更新当前用户的角色为管理员。
    *   最后，脚本会再次获取用户的角色信息，并验证是否已成功升级为管理员。

投毒风险分析: 该POC代码的投毒风险极低，评估为5%。
1.  **代码透明度**: 脚本以纯Python编写，代码逻辑清晰易懂，未进行任何形式的代码混淆或加密。所有功能直接可见，便于安全研究人员进行审计。
2.  **依赖库使用**: 脚本仅使用了标准的、广受信任的Python库，包括`sys`, `requests`, `argparse`, `re`, `BeautifulSoup`和`urllib.parse`。这些库是Python生态系统中的常用组件，本身不包含恶意功能。未发现引入未知或第三方可疑库的行为。
3.  **外部网络请求**: 除了针对目标CMS进行漏洞利用的HTTP请求外，脚本未向任何其他外部地址发送请求。它不下载或执行任何远程脚本或资源，从而避免了通过外部资源引入恶意代码的风险。
4.  **文件系统操作**: 脚本不进行任何文件系统读写操作，除了其自身的执行外，不创建、修改或删除任何本地文件，进一步降低了潜在的恶意影响。
5.  **命令执行**: 脚本中没有发现`os.system()`、`subprocess.call()`或`eval()`等可能导致任意命令执行的代码，这表明其设计专注于HTTP请求和响应处理，而非执行系统级恶意操作。
6.  **代码行为**: 脚本的行为完全符合其描述——登录、获取信息、发送特定参数进行特权升级，并验证结果。未发现额外的、未声明的或与漏洞利用无关的恶意行为，例如数据窃取、后门安装或拒绝服务攻击。
综上所述，这份POC代码是一个典型的、专注于验证和利用特定漏洞的防御性安全工具，其设计和实现均遵循安全实践，不含恶意投毒成分。

**项目地址:** 

**漏洞详情:** https://rubysec.com/advisories/CVE-2025-2304/
