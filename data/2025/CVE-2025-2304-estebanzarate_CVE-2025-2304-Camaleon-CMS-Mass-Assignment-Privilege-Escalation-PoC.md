## CVE-2025-2304 - Camaleon CMS Mass Assignment Privilege Escalation

**漏洞编号:** CVE-2025-2304

**漏洞类型:** Mass Assignment Privilege Escalation

**影响应用:** Camaleon CMS

**危害等级:** 高

**CVSS评分:** 

**影响版本:** Camaleon CMS < 2.9.1

**利用条件:** 需要认证, 网络访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

所提供的Python脚本`CVE-2025-2304.py`是一个针对Camaleon CMS 2.9.1及以下版本中“大规模赋值（Mass Assignment）”权限提升漏洞的有效漏洞利用工具。此漏洞存在于`/admin/users/{user_id}/updated_ajax`端点，该端点在处理参数时错误地使用了`permit!`方法，导致攻击者可以在密码更改请求中注入任意参数，包括`password[role]=admin`，从而将低权限用户的角色提升至管理员。

**POC有效性分析:** 该脚本结构良好，功能完整。它自动化了CSRF令牌的获取、用户登录以及当前用户ID的识别。随后，它构造一个POST请求，将恶意的`password[role]=admin`有效载荷注入到`/admin/users/{user_id}/updated_ajax`端点。脚本包含了错误处理和成功消息，提高了用户体验。其清晰的逻辑和对漏洞的直接利用表明，在提供有效的用户凭据的情况下，该POC对受影响的Camaleon CMS实例具有高度的有效性。

**利用步骤:**
1.  **前提条件:** 拥有Camaleon CMS < 2.9.1的已认证用户账户（即使是低权限账户）。
2.  **执行:** 运行命令 `python3 CVE-2025-2304.py http://TARGET_URL -u USERNAME -p PASSWORD`。
3.  **自动化处理:** 脚本会自动处理CSRF令牌的获取、登录和用户ID的提取。
4.  **有效载荷投递:** 脚本向`/admin/users/{user_id}/updated_ajax`发送一个POST请求，其中包含精心构造的`password[role]=admin`有效载荷。
5.  **权限提升:** 存在漏洞的端点处理`role`参数，将当前用户的权限提升至“管理员”。
6.  **验证:** 脚本会尝试重新认证并验证用户角色是否已成功更改为“管理员”。

**投毒风险分析:** 该POC代码呈现**低投毒风险 (10%)**。脚本以清晰、可读的Python语言编写，仅使用了`requests`、`BeautifulSoup`和`argparse`等标准库。代码中没有发现任何混淆、可疑的外部模块导入或动态代码执行（如`eval()`/`exec()`）的迹象。其所有网络请求都明确指向Camaleon CMS的特定端点，旨在演示和利用所描述的大规模赋值漏洞以提升权限。脚本的目的是纯粹的漏洞利用，不包含任何建立后门、数据泄露或部署其他恶意载荷的额外行为。尽管任何来自公共来源的代码都存在固有风险，但该脚本似乎是为合法的漏洞研究和演示而设计，未发现额外的恶意载荷。用户仍应谨慎行事，审查代码并在受控环境中运行。

**项目地址:** https://github.com/d3vn0mi/cve-2025-2304-poc.git

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-2304
