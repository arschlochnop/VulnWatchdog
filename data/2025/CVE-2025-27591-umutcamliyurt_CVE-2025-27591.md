## CVE-2025-27591 - Below (Facebook/Meta 开源的系统监控工具) 权限提升 (Privilege Escalation)

**漏洞编号:** CVE-2025-27591

**漏洞类型:** 权限提升 (Privilege Escalation)

**影响应用:** Below (Facebook/Meta 开源的系统监控工具)

**危害等级:** 高 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 版本 < 0.9.0

**利用条件:** 本地普通用户权限，目标系统安装了受影响版本的 below 服务且存在全局可写的 /var/log/below 目录。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞的根源在于 below 服务在初始化时创建了权限设置不当的日志目录 /var/log/below。根据 POC 代码分析，该目录被设置为全局可写（World-Writable），这为符号链接攻击（Symlink Attack）提供了物理基础。POC 通过在该目录下创建一个指向系统敏感文件（如 /etc/passwd 或 /etc/shadow）的符号链接，诱使以高权限（通常是 root）运行的 below 进程在记录日志时，将内容写入到被链接的目标文件中。在提供的 exploit.sh 中，攻击者通过 `ln -s /etc/passwd /var/log/below/error_root.log` 建立了映射关系。当通过 `sudo /usr/bin/below record` 触发日志记录行为时，程序会遵循符号链接。随后，POC 利用 `cat >>` 将伪造的 root 权限用户（nemesis:0:0...）追加到 /etc/passwd 中。由于 /var/log/below 目录权限过于宽松，普通用户可以删除并重建该目录下的任何文件，包括日志文件，从而实现对任意文件的越权写入。这种漏洞在 Linux 环境中非常典型，通过劫持日志写入流实现从普通用户到 UID 0 的权限跨越。经过验证，该 POC 逻辑严密，步骤清晰，直接利用了服务对文件系统路径校验缺失的弱点，在配置不当的生产环境中具有极高的实战价值。利用步骤：1. 检测系统中是否存在 /var/log/below 目录并确认其是否为全局可写。2. 准备提权 Payload，例如创建一个无密码或已知密码的 UID 0 用户行。3. 删除原有的日志文件（如果存在），创建指向 /etc/passwd 的同名符号链接。4. 调用 below 服务的记录功能（record）触发高权限文件写入。5. 将 Payload 追加到日志路径，实际上由于符号链接的存在，Payload 被写入了 /etc/passwd。6. 使用 `su` 命令切换到新创建的超级用户。投毒风险分析：对提供的 shell 脚本进行静态审计，其逻辑相对透明，主要使用了基础的 Linux 系统命令如 ln, cat, echo 和 sudo。脚本中定义的变量如 LOG_DIR、TARGET_FILE 等均指向标准的系统路径，未发现明显的远程服务器通信行为或恶意二进制下载逻辑。风险评估为低（15%），这部分风险主要来自于脚本在修改 /etc/passwd 时可能造成的系统破坏（如破坏文件结构导致系统无法登录），而非传统意义上的后门投毒。脚本中出现的 `eval` 函数虽然在安全领域是敏感关键字，但在此 POC 中仅用于执行 `echo` 命令显示运行状态，未发现用于执行混淆后的恶意指令。开发者在脚本中明确标注了教育用途和免责声明。然而，在威胁情报防御视角下，仍需注意此类 POC 可能被集成到自动化恶意软件（如 Linux 蠕虫或挖矿脚本的本地提权模块）中。目前的 POC 代码是干净的，没有隐藏的混淆字符或 base64 加密的 Payload，攻击者若要进行投毒，通常会修改第 5 步之后的代码以植入持久化后门，而当前的 POC 仅仅是为了演示提权到 nemesis 用户。建议在隔离的沙箱环境中运行此类脚本，并监控对 /etc/passwd 的异常写入行为。

**项目地址:** [https://github.com/BridgerAlderson/CVE-2025-27591-PoC](https://github.com/BridgerAlderson/CVE-2025-27591-PoC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-27591](https://nvd.nist.gov/vuln/detail/CVE-2025-27591)
