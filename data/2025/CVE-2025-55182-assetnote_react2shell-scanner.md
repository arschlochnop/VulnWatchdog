## CVE-2025-55182 & CVE-2025-66478 - React/Next.js Server Components RCE

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React/Next.js

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 受影响版本信息请参考相关安全公告

**利用条件:** 目标应用使用了易受攻击的React Server Components版本，且暴露了Server Functions endpoint。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-55182 和 CVE-2025-66478 是 React 和 Next.js 应用中 React Server Components (RSC) 模块的远程代码执行漏洞。 根据搜索结果显示，该漏洞是由于对传入 Flight 请求的反序列化处理不安全造成的，攻击者可以通过发送特制的 payload 到易受攻击的 React Server Function 端点来利用此漏洞。

**有效性：**

根据提供的漏洞利用代码（`react2shell-scanner`），该 POC 旨在通过发送精心构造的 multipart POST 请求来触发易受攻击版本的 React Server Components 中的特定错误条件。该 POC 检查响应状态码是否为 500，并且响应体是否包含 `E{"digest"` 字符串，以此来判断目标主机是否存在漏洞。 此方法是利用了漏洞的特征行为进行检测, 因此较为有效。POC 代码提供了扫描单个主机、主机列表的功能，并支持多线程扫描，提高了效率。

**投毒风险：**

该代码的主要功能是检测漏洞，而非直接利用漏洞执行任意代码。代码中只包含了发送特定请求和检查响应的逻辑，没有发现明显的恶意代码或后门。依赖的第三方库 (`requests`, `tqdm`, `urllib3`) 是常用的 Python 库，本身被投毒的可能性较低。但是，仍然存在极小的风险，比如：

*   **依赖库风险：** 虽然当前版本看起来安全，但未来版本可能被恶意篡改。
*   **开发者账号风险：** 开发者账号被盗用，导致代码被篡改。

考虑到代码的功能和依赖，投毒风险较低，估计为 1%。这个数字表示存在微小的风险，但可能性不高。

**利用方式：**

此漏洞的利用方式为：

1.  **攻击者发送特制的 payload：** 攻击者构造恶意的序列化数据，并将其作为 Flight 请求的一部分发送到易受攻击的 React Server Function 端点。
2.  **触发反序列化漏洞：** 由于对传入数据处理不当，React Server Components 会尝试反序列化恶意数据，从而导致代码执行。
3.  **执行任意代码：** 攻击者可以利用反序列化漏洞执行任意代码，例如在服务器上执行系统命令。

`react2shell-scanner` 工具通过模拟攻击者发送的恶意 payload 来检测是否存在漏洞，但它本身不执行任意代码。此工具只是用于判断是否存在漏洞。

**总结：**

CVE-2025-55182 和 CVE-2025-66478 是 React 和 Next.js 应用中非常严重的安全漏洞，可能导致远程代码执行。`react2shell-scanner` 是一个用于检测这些漏洞的工具，它本身不包含恶意代码，但仍需注意潜在的供应链风险。修复此漏洞的关键在于更新到不受影响的 React 和 Next.js 版本，并采取适当的安全措施来保护 Server Functions 端点。

**项目地址:** [assetnote/react2shell-scanner](https://github.com/assetnote/react2shell-scanner)

**漏洞详情:** [CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)