## CVE-2025-24813 - Apache Tomcat Remote Code Execution (RCE)

**漏洞编号:** CVE-2025-24813

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Apache Tomcat

**危害等级:** Critical

**CVSS评分:** Unknown

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98, 8.5.0 through 8.5.100 (EOL)

**利用条件:** Unauthenticated network access, partial PUT feature enabled

**POC 可用性:** 8/10

**POC 类型:** Complete exploit

**攻击复杂度:** Low

**投毒风险:** 35%

## 详情

CVE-2025-24813 is a critical security vulnerability in Apache Tomcat that allows for unauthenticated remote code execution (RCE). The vulnerability stems from improper handling of partial PUT requests. Specifically, the vulnerability exists within the `org.apache.catalina.servlets.DefaultServlet` class, where a malicious actor can leverage the partial PUT functionality to upload a JSP file to an arbitrary location within the web application's directory structure. This uploaded JSP file can then be accessed through a web request, leading to the execution of arbitrary code on the server. The provided Python POC exploit, POC-Exploit_CVE_2025_24813.py, automates this process. First, the script sends a specially crafted PUT request to the target Tomcat server. This request contains the malicious JSP payload and manipulates the header information to bypass security checks. Then the script requests the malicious jsp, which results in the execution of arbitrary code on the server. The script includes functions for banner display, log management, and checks for target validity, including URL validation and connection testing. Further, the exploit uses the `requests` library to send HTTP requests, `urllib.parse` to parse URLs, and `colorama` and `rich` libraries for colored terminal output and enhanced user interface features. The `futuristabanner()` function displays an animated, stylized banner indicating the exploit's detection, adding a visually appealing element. The POC exploit provided automates the process of exploiting the vulnerability. The initial checks performed by the script validate the target URL and confirm that the application is reachable. Once validated, the script constructs the malicious PUT request, specifying the path to the desired JSP file. Upon successful execution, the Tomcat server processes the crafted PUT request without appropriate validation, allowing the attacker to place the JSP file at the intended location. This capability enables the attacker to execute arbitrary code on the compromised system, potentially leading to full system compromise.

**投毒风险分析:** The POC code, while functional, presents a moderate poisoning risk. The risk is not considered high because the code is relatively straightforward, utilizes standard Python libraries, and does not directly incorporate any explicitly malicious functionalities such as downloading and executing external scripts or manipulating system binaries. However, several factors contribute to an elevated risk level compared to benign, proof-of-concept code. Firstly, the code includes a visually appealing "futuristic" banner that could obscure the malicious intent from cursory inspection. While the banner itself is not malicious, it adds complexity and visual distraction to the codebase. Secondly, the logging functionality, while beneficial for debugging, could be used to mask malicious actions by writing misleading log messages. Thirdly, the code contains functions to create files in a specified directory which could be leveraged to deploy webshells. Additionally, the usage of the `requests` library with `verify=False` disables SSL certificate verification, which makes the exploit susceptible to man-in-the-middle attacks. The risk is mitigated by the fact that the core exploit logic is explicit and the dependencies are standard. The calculated poisoning risk is approximately 35%, indicating a moderate level of caution should be exercised when utilizing or distributing this code.

**项目地址:** https://github.com/...

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-24813
