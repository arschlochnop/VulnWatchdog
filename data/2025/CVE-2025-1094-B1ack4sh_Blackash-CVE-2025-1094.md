# CVE-2025-1094

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-1094-B1ack4sh_Blackash-CVE-2025-1094.md](../2025/CVE-2025-1094-B1ack4sh_Blackash-CVE-2025-1094.md)

# CVE-2025-1094

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-1094-B1ack4sh_Blackash-CVE-2025-1094.md](../2025/CVE-2025-1094-B1ack4sh_Blackash-CVE-2025-1094.md)

# CVE-2025-1094

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-1094-B1ack4sh_Blackash-CVE-2025-1094.md](../2025/CVE-2025-1094-B1ack4sh_Blackash-CVE-2025-1094.md)

# CVE-2025-1094

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-1094-B1ack4sh_Blackash-CVE-2025-1094.md](../2025/CVE-2025-1094-B1ack4sh_Blackash-CVE-2025-1094.md)

# CVE-2025-1094

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-1094-B1ack4sh_Blackash-CVE-2025-1094.md](../2025/CVE-2025-1094-B1ack4sh_Blackash-CVE-2025-1094.md)

# CVE-2025-1094

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-1094-B1ack4sh_Blackash-CVE-2025-1094.md](../2025/CVE-2025-1094-B1ack4sh_Blackash-CVE-2025-1094.md)

# CVE-2025-1094

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-1094-B1ack4sh_Blackash-CVE-2025-1094.md](../2025/CVE-2025-1094-B1ack4sh_Blackash-CVE-2025-1094.md)

# CVE-2025-1094

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-1094-B1ack4sh_Blackash-CVE-2025-1094.md](../2025/CVE-2025-1094-B1ack4sh_Blackash-CVE-2025-1094.md)

# CVE-2025-1094

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-1094-B1ack4sh_Blackash-CVE-2025-1094.md](../2025/CVE-2025-1094-B1ack4sh_Blackash-CVE-2025-1094.md)

# CVE-2025-1094

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-1094-B1ack4sh_Blackash-CVE-2025-1094.md](../2025/CVE-2025-1094-B1ack4sh_Blackash-CVE-2025-1094.md)

## CVE-2025-1094-PostgreSQL-SQL注入到RCE

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要目标系统存在漏洞版本的PostgreSQL，并且存在可利用的SQL注入点，WebSocket服务也需要开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1094是一个存在于PostgreSQL的SQL注入漏洞。该漏洞是由于 `PQescapeLiteral()`、`PQescapeIdentifier()`、`PQescapeString()` 和 `PQescapeStringConn()` 函数在处理特定编码时未能正确转义引号语法导致的。 攻击者首先利用SQL注入漏洞，读取服务器上的敏感文件（例如/etc/passwd）并将其保存到服务器上的一个可访问的位置。 然后，攻击者会劫持一个WebSocket连接，并利用该连接在服务器上执行任意代码，从而获得反向shell。该PoC中，虽然有执行系统命令的操作，需要用户自行替换IP和端口，但整体逻辑符合漏洞描述，可以判定为有效的PoC。投毒风险评估为10%，主要风险点在于需要用户替换REVERSE_IP和REVERSE_PORT，如果用户不小心使用了错误的IP地址或端口，可能会将反向shell发送到错误的地址。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-1094](https://github.com/B1ack4sh/Blackash-CVE-2025-1094)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #2

**来源**: [CVE-2025-1094-PinkArmor_CVE-2025-1094-Lab-Setup.md](../2025/CVE-2025-1094-PinkArmor_CVE-2025-1094-Lab-Setup.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要目标PostgreSQL服务器client_encoding为BIG5, server_encoding为EUC_TW或MULE_INTERNAL, 以及目标应用使用PQescapeLiteral(), PQescapeIdentifier(), PQescapeString(), 和 PQescapeStringConn()函数且未进行充分的输入验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1094漏洞存在于PostgreSQL的libpq函数中，由于在PQescapeLiteral(), PQescapeIdentifier(), PQescapeString(), 和 PQescapeStringConn()中未正确处理编码验证失败的文本中的引号语法，导致SQL注入。

**有效性评估：**
提供的POC代码针对PostgreSQL 14.15版本，该版本在受影响的版本范围内。通过Docker部署了易受攻击的PostgreSQL实例，并提供了一个Python脚本来利用该漏洞。利用方式是注入畸形的UTF-8编码，绕过输入验证，并使用`COPY ... TO PROGRAM`执行任意shell命令，最终获得反向shell。根据描述和代码逻辑，POC代码应该是有效的。

**投毒风险分析：**
提供的代码包含两个文件：`README.md` 和 `exploit.py`。`README.md` 描述了漏洞和利用过程，其中包含免责声明。`exploit.py` 是实际的漏洞利用代码，负责连接到PostgreSQL服务器并发送恶意payload。代码主要功能是利用漏洞获取反向shell。然而，在`exploit.py`中，存在可疑的`im`，怀疑作者存在隐藏的投毒代码。因此，投毒风险评估为10%。

**利用方式：**
1.  **环境准备：** 使用Docker部署易受攻击的PostgreSQL版本（<= 14.15）。
2.  **配置目标服务器：** 设置目标PostgreSQL服务器的`client_encoding`为`BIG5`，`server_encoding`为`EUC_TW`或`MULE_INTERNAL`。
3.  **启动监听器：** 在攻击者机器上启动一个监听器（例如，使用`nc -lvnp 4444`）以接收反向shell。
4.  **运行攻击脚本：** 运行提供的Python脚本，指定目标PostgreSQL服务器的IP地址、攻击者机器的IP地址和监听端口。
5.  **获取反向shell：** 如果利用成功，攻击者将收到来自易受攻击的PostgreSQL容器的反向shell，从而可以在服务器上执行任意命令。

**项目地址:** [PinkArmor/CVE-2025-1094-Lab-Setup](https://github.com/PinkArmor/CVE-2025-1094-Lab-Setup)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #3

**来源**: [CVE-2025-1094-aninfosec_CVE-2025-1094.md](../2025/CVE-2025-1094-aninfosec_CVE-2025-1094.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要目标应用程序使用受影响的PostgreSQL版本，并且使用libpq函数或psql命令行工具处理用户提供的、经过编码转换（BIG5到EUC_TW或MULE_INTERNAL）的输入。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1094是PostgreSQL中的一个SQL注入漏洞，影响多个版本。漏洞根源在于PostgreSQL的`PQescapeLiteral()`、`PQescapeIdentifier()`、`PQescapeString()`和`PQescapeStringConn()`等libpq函数，以及psql命令行工具在处理编码转换时，未能正确转义引号语法。如果应用程序使用这些函数的结果来构造传递给psql的输入，或者psql处理来自命令行参数的输入时，存在被SQL注入的风险。

**有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，该漏洞是有效的。搜索结果表明，Rapid7的研究人员发现了这个漏洞，并且已经有针对性的攻击发生。PoC代码通过设置`PGCLIENTENCODING`环境变量为`BIG5`，并构造恶意的SQL注入payload，利用`COPY ... TO PROGRAM`语句执行任意shell命令，从而获得反向shell。

**投毒风险：**
PoC代码分析：
* `exploit.py`脚本的目的是利用CVE-2025-1094漏洞。它通过构造特定的SQL payload，该payload包含`COPY ... TO PROGRAM`语句来执行系统命令，从而获得反向shell。
* `README.md`文件只包含CVE编号。
结论：
该仓库中**没有发现**明显的投毒代码。该脚本的目的是利用漏洞，而不是安装恶意软件或执行其他恶意行为。因此，投毒风险为0%。

**利用方式：**
1.  **环境配置：** 设置环境变量`PGCLIENTENCODING`为`BIG5`，模拟编码转换的环境。
2.  **构造Payload：** 构造包含恶意SQL代码的payload。PoC中使用了`COPY ... TO PROGRAM`语句，允许执行系统命令。
3.  **发送请求：** 将payload作为参数发送到目标应用程序，触发SQL注入。
4.  **反向Shell：** 如果利用成功，目标服务器会连接到攻击者的IP地址和端口，建立反向shell连接。

**项目地址:** [aninfosec/CVE-2025-1094](https://github.com/aninfosec/CVE-2025-1094)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #4

**来源**: [CVE-2025-1094-ishwardeepp_CVE-2025-1094-PoC-Postgre-SQLi.md](../2025/CVE-2025-1094-ishwardeepp_CVE-2025-1094-PoC-Postgre-SQLi.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 服务器编码为EUC_TW或MULE_INTERNAL，客户端编码为BIG5

**POC 可用性:** 是

**投毒风险:** 99%

## 详情

CVE-2025-1094是PostgreSQL中的一个高危SQL注入漏洞。由于`PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`和`PQescapeStringConn()`等函数在处理特定编码组合时（服务器编码为EUC_TW或MULE_INTERNAL，客户端编码为BIG5）未能正确转义引号，攻击者可以通过操纵数据库输入或命令行参数来执行任意SQL命令。

**有效性分析：**

提供的PoC代码通过利用编码不匹配，特别是`server_encoding=EUC_TW`和`client_encoding=BIG5`的组合，成功地绕过了PostgreSQL的转义机制。`exploit.py`文件发送包含恶意SQL代码的POST请求到`app.py`，该请求经过`psql`执行。`init.sql`创建了一个测试表，为SQL注入提供上下文。Docker环境的配置确保了编码环境正确。

**投毒风险分析：**

PoC代码存在极高的投毒风险。 理由如下：

1.  **任意文件读取：** PoC允许读取`/etc/passwd`文件，这表明可以读取服务器上的任何文件，包括敏感配置文件和私钥。
2.  **远程代码执行（RCE）：** 通过注入SQL，攻击者可以创建large object，读取文件，并将其导出到文件系统。这意味着，虽然PoC中示例是读取/etc/passwd，但是它可以执行任何数据库支持的操作，包括调用外部程序或库，进而实现RCE。
3.  **环境依赖：** PoC依赖于特定的编码设置，这使得在不同环境下利用的难度增加。 但如果攻击者控制了数据库的配置，则可以轻松设置正确的编码以利用该漏洞。
4.  **真实漏洞利用案例：** 搜索结果表明，此漏洞已被用于攻击BeyondTrust和美国财政部等机构，这表明真实环境中存在利用。

**漏洞利用方式：**

1.  **编码不匹配：** 利用`client_encoding`和`server_encoding`之间的差异绕过转义。
2.  **注入恶意SQL：** 通过`PQescapeLiteral()`等函数的缺陷，将恶意的SQL代码注入到`psql`命令中。
3.  **执行任意命令：**  利用SQL注入执行`pg_read_file`等函数，读取服务器上的文件，然后通过large object将内容导出到指定位置。

**总结：**

CVE-2025-1094是一个严重的安全漏洞，允许攻击者执行任意SQL命令，读取敏感文件甚至实现远程代码执行。提供的PoC代码有效，并存在极高的投毒风险。

**项目地址:** [ishwardeepp/CVE-2025-1094-PoC-Postgre-SQLi](https://github.com/ishwardeepp/CVE-2025-1094-PoC-Postgre-SQLi)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #5

**来源**: [CVE-2025-1094-shacojx_CVE-2025-1094-Exploit.md](../2025/CVE-2025-1094-shacojx_CVE-2025-1094-Exploit.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要数据库连接和特定的client/server encoding配置(BIG5, EUC_TW, MULE_INTERNAL)

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-1094 漏洞是 PostgreSQL 中由于不正确的引用语法中和导致的 SQL 注入漏洞。漏洞存在于 `PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`, 和 `PQescapeStringConn()` 等libpq函数中，以及 psql 命令行工具。\n\n**漏洞利用方式：**\n\n1.  **SQL 注入：** 攻击者通过构造恶意的 SQL 语句，利用 `lo_export` 函数读取服务器上的敏感文件，例如 `/etc/passwd`。payload首先使用 `pg_read_file`读取文件内容,然后使用`convert_from`将内容转换为UTF8编码。\n2.  **WebSocket 劫持（PoC 中的利用方式）：** 该 PoC 尝试劫持一个已建立的 WebSocket 连接，并发送恶意 payload，以执行远程代码。\n3.  **远程代码执行（RCE）：** 通过反弹 shell，攻击者可以完全控制服务器。\n\n**投毒风险分析：**\n\nPoC 代码包含一个WebSocket劫持部分，其中包含一段python反弹shell的代码，需要将`REVERSE_IP`和`REVERSE_PORT`替换为攻击者控制的地址。该部分有风险，需要使用者确认该地址为其所拥有。如果该部分地址不是poc使用者所控制的,那么相当于poc使用者主动连接了poc编写者的服务器,存在一定的风险，但是不属于典型的投毒。\n
此外，PoC 代码依赖于特定版本的 JDK (22) 和 okhttp3 库，如果构建环境与预期不符，可能导致 PoC 无法正常运行。虽然这增加了使用难度，但并不构成主动投毒行为。\n
SQL注入本身就存在一定的数据库被植入后门的风险.但是该风险是SQL注入攻击本身具有的,不能算是POC的投毒风险.综合来看，POC 代码存在一定风险，但不属于典型的投毒行为，主要是webshell劫持部分需要确认。\n\n**缓解措施：**\n\n*   在引用输入之前，确认输入通过编码验证。\n*   升级到 PostgreSQL 17.3, 16.7, 15.11, 14.16, 或 13.19 或更高版本。

**项目地址:** [shacojx/CVE-2025-1094-Exploit](https://github.com/shacojx/CVE-2025-1094-Exploit)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #6

**来源**: [CVE-2025-1094-soltanali0_CVE-2025-1094-Exploit.md](../2025/CVE-2025-1094-soltanali0_CVE-2025-1094-Exploit.md)

## CVE-2025-1094-PostgreSQL-SQL注入到RCE

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致数据泄露和远程代码执行

**影响版本:** PostgreSQL 17.3之前, 16.7之前, 15.11之前, 14.16之前, 13.19之前

**利用条件:** 需要应用程序使用受影响的`PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`, 和 `PQescapeStringConn()` 函数的结果构建输入到 `psql`，或当`client_encoding`是`BIG5`且`server_encoding`是`EUC_TW`或`MULE_INTERNAL`时，利用命令行参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1094 是一个存在于 PostgreSQL 的 SQL 注入漏洞，允许攻击者通过注入恶意 SQL 代码读取敏感文件并执行任意命令，最终实现远程代码执行。漏洞利用涉及多个阶段：

1.  **SQL 注入**：攻击者利用 `PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`, 和 `PQescapeStringConn()` 函数中的不当转义，向PostgreSQL数据库注入恶意的SQL语句。从PoC代码来看，此处的SQL注入是通过`lo_export`和`pg_read_file`函数读取`/etc/passwd`文件，并将其保存到`/tmp/payload`。

2.  **WebSocket 劫持**：攻击者劫持一个已建立的WebSocket连接，并发送恶意payload，目的是在服务器上执行任意命令。

3.  **远程代码执行 (RCE)**：通过WebSocket连接发送的payload包含反向shell代码，该代码会连接到攻击者的监听端口，从而使攻击者获得服务器的控制权。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该PoC代码在满足特定条件的情况下是有效的。条件包括：
*   PostgreSQL 版本在受影响范围内。
*   应用程序使用了易受攻击的转义函数，或者使用了不安全的命令行参数。
*   存在可被劫持的 WebSocket 连接（PoC 代码假设存在）。

**投毒风险分析：**

该PoC代码存在一定的投毒风险，风险评估为10%。主要风险点在于：

*   **依赖外部 WebSocket 连接：** 该PoC假设存在一个可劫持的WebSocket连接。如果攻击者诱导用户使用包含恶意WebSocket连接的PoC，可能导致意外行为或信息泄露。
*   **反向Shell依赖：** PoC代码通过建立反向shell获取服务器控制权，如果攻击者修改了反向shell连接的IP和端口，可能会将受害者暴露给未知的第三方。
*  **文件读写**:虽然PoC读取`/etc/passwd`是为了演示，但未经授权的文件读写行为本身就是高危的。攻击者可能会更改读取的文件，或写入恶意文件，从而引入其他安全风险。
*   **隐蔽性**：攻击者可以将恶意代码隐藏在看似无害的WebSocket消息中，增加检测的难度。

**利用方式总结：**

1.  利用SQL注入漏洞，读取服务器上的敏感文件，例如`/etc/passwd`。
2.  劫持已建立的WebSocket连接。
3.  通过WebSocket连接，发送包含反向shell的恶意payload，从而在服务器上执行任意命令，获得服务器的远程控制权限。

**项目地址:** [soltanali0/CVE-2025-1094-Exploit](https://github.com/soltanali0/CVE-2025-1094-Exploit)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---



---

## POC #2

**来源**: [CVE-2025-1094-PinkArmor_CVE-2025-1094-Lab-Setup.md](../2025/CVE-2025-1094-PinkArmor_CVE-2025-1094-Lab-Setup.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要目标PostgreSQL服务器client_encoding为BIG5, server_encoding为EUC_TW或MULE_INTERNAL, 以及目标应用使用PQescapeLiteral(), PQescapeIdentifier(), PQescapeString(), 和 PQescapeStringConn()函数且未进行充分的输入验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1094漏洞存在于PostgreSQL的libpq函数中，由于在PQescapeLiteral(), PQescapeIdentifier(), PQescapeString(), 和 PQescapeStringConn()中未正确处理编码验证失败的文本中的引号语法，导致SQL注入。

**有效性评估：**
提供的POC代码针对PostgreSQL 14.15版本，该版本在受影响的版本范围内。通过Docker部署了易受攻击的PostgreSQL实例，并提供了一个Python脚本来利用该漏洞。利用方式是注入畸形的UTF-8编码，绕过输入验证，并使用`COPY ... TO PROGRAM`执行任意shell命令，最终获得反向shell。根据描述和代码逻辑，POC代码应该是有效的。

**投毒风险分析：**
提供的代码包含两个文件：`README.md` 和 `exploit.py`。`README.md` 描述了漏洞和利用过程，其中包含免责声明。`exploit.py` 是实际的漏洞利用代码，负责连接到PostgreSQL服务器并发送恶意payload。代码主要功能是利用漏洞获取反向shell。然而，在`exploit.py`中，存在可疑的`im`，怀疑作者存在隐藏的投毒代码。因此，投毒风险评估为10%。

**利用方式：**
1.  **环境准备：** 使用Docker部署易受攻击的PostgreSQL版本（<= 14.15）。
2.  **配置目标服务器：** 设置目标PostgreSQL服务器的`client_encoding`为`BIG5`，`server_encoding`为`EUC_TW`或`MULE_INTERNAL`。
3.  **启动监听器：** 在攻击者机器上启动一个监听器（例如，使用`nc -lvnp 4444`）以接收反向shell。
4.  **运行攻击脚本：** 运行提供的Python脚本，指定目标PostgreSQL服务器的IP地址、攻击者机器的IP地址和监听端口。
5.  **获取反向shell：** 如果利用成功，攻击者将收到来自易受攻击的PostgreSQL容器的反向shell，从而可以在服务器上执行任意命令。

**项目地址:** [PinkArmor/CVE-2025-1094-Lab-Setup](https://github.com/PinkArmor/CVE-2025-1094-Lab-Setup)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #3

**来源**: [CVE-2025-1094-aninfosec_CVE-2025-1094.md](../2025/CVE-2025-1094-aninfosec_CVE-2025-1094.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要目标应用程序使用受影响的PostgreSQL版本，并且使用libpq函数或psql命令行工具处理用户提供的、经过编码转换（BIG5到EUC_TW或MULE_INTERNAL）的输入。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1094是PostgreSQL中的一个SQL注入漏洞，影响多个版本。漏洞根源在于PostgreSQL的`PQescapeLiteral()`、`PQescapeIdentifier()`、`PQescapeString()`和`PQescapeStringConn()`等libpq函数，以及psql命令行工具在处理编码转换时，未能正确转义引号语法。如果应用程序使用这些函数的结果来构造传递给psql的输入，或者psql处理来自命令行参数的输入时，存在被SQL注入的风险。

**有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，该漏洞是有效的。搜索结果表明，Rapid7的研究人员发现了这个漏洞，并且已经有针对性的攻击发生。PoC代码通过设置`PGCLIENTENCODING`环境变量为`BIG5`，并构造恶意的SQL注入payload，利用`COPY ... TO PROGRAM`语句执行任意shell命令，从而获得反向shell。

**投毒风险：**
PoC代码分析：
* `exploit.py`脚本的目的是利用CVE-2025-1094漏洞。它通过构造特定的SQL payload，该payload包含`COPY ... TO PROGRAM`语句来执行系统命令，从而获得反向shell。
* `README.md`文件只包含CVE编号。
结论：
该仓库中**没有发现**明显的投毒代码。该脚本的目的是利用漏洞，而不是安装恶意软件或执行其他恶意行为。因此，投毒风险为0%。

**利用方式：**
1.  **环境配置：** 设置环境变量`PGCLIENTENCODING`为`BIG5`，模拟编码转换的环境。
2.  **构造Payload：** 构造包含恶意SQL代码的payload。PoC中使用了`COPY ... TO PROGRAM`语句，允许执行系统命令。
3.  **发送请求：** 将payload作为参数发送到目标应用程序，触发SQL注入。
4.  **反向Shell：** 如果利用成功，目标服务器会连接到攻击者的IP地址和端口，建立反向shell连接。

**项目地址:** [aninfosec/CVE-2025-1094](https://github.com/aninfosec/CVE-2025-1094)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #4

**来源**: [CVE-2025-1094-ishwardeepp_CVE-2025-1094-PoC-Postgre-SQLi.md](../2025/CVE-2025-1094-ishwardeepp_CVE-2025-1094-PoC-Postgre-SQLi.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 服务器编码为EUC_TW或MULE_INTERNAL，客户端编码为BIG5

**POC 可用性:** 是

**投毒风险:** 99%

## 详情

CVE-2025-1094是PostgreSQL中的一个高危SQL注入漏洞。由于`PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`和`PQescapeStringConn()`等函数在处理特定编码组合时（服务器编码为EUC_TW或MULE_INTERNAL，客户端编码为BIG5）未能正确转义引号，攻击者可以通过操纵数据库输入或命令行参数来执行任意SQL命令。

**有效性分析：**

提供的PoC代码通过利用编码不匹配，特别是`server_encoding=EUC_TW`和`client_encoding=BIG5`的组合，成功地绕过了PostgreSQL的转义机制。`exploit.py`文件发送包含恶意SQL代码的POST请求到`app.py`，该请求经过`psql`执行。`init.sql`创建了一个测试表，为SQL注入提供上下文。Docker环境的配置确保了编码环境正确。

**投毒风险分析：**

PoC代码存在极高的投毒风险。 理由如下：

1.  **任意文件读取：** PoC允许读取`/etc/passwd`文件，这表明可以读取服务器上的任何文件，包括敏感配置文件和私钥。
2.  **远程代码执行（RCE）：** 通过注入SQL，攻击者可以创建large object，读取文件，并将其导出到文件系统。这意味着，虽然PoC中示例是读取/etc/passwd，但是它可以执行任何数据库支持的操作，包括调用外部程序或库，进而实现RCE。
3.  **环境依赖：** PoC依赖于特定的编码设置，这使得在不同环境下利用的难度增加。 但如果攻击者控制了数据库的配置，则可以轻松设置正确的编码以利用该漏洞。
4.  **真实漏洞利用案例：** 搜索结果表明，此漏洞已被用于攻击BeyondTrust和美国财政部等机构，这表明真实环境中存在利用。

**漏洞利用方式：**

1.  **编码不匹配：** 利用`client_encoding`和`server_encoding`之间的差异绕过转义。
2.  **注入恶意SQL：** 通过`PQescapeLiteral()`等函数的缺陷，将恶意的SQL代码注入到`psql`命令中。
3.  **执行任意命令：**  利用SQL注入执行`pg_read_file`等函数，读取服务器上的文件，然后通过large object将内容导出到指定位置。

**总结：**

CVE-2025-1094是一个严重的安全漏洞，允许攻击者执行任意SQL命令，读取敏感文件甚至实现远程代码执行。提供的PoC代码有效，并存在极高的投毒风险。

**项目地址:** [ishwardeepp/CVE-2025-1094-PoC-Postgre-SQLi](https://github.com/ishwardeepp/CVE-2025-1094-PoC-Postgre-SQLi)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #5

**来源**: [CVE-2025-1094-shacojx_CVE-2025-1094-Exploit.md](../2025/CVE-2025-1094-shacojx_CVE-2025-1094-Exploit.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要数据库连接和特定的client/server encoding配置(BIG5, EUC_TW, MULE_INTERNAL)

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-1094 漏洞是 PostgreSQL 中由于不正确的引用语法中和导致的 SQL 注入漏洞。漏洞存在于 `PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`, 和 `PQescapeStringConn()` 等libpq函数中，以及 psql 命令行工具。\n\n**漏洞利用方式：**\n\n1.  **SQL 注入：** 攻击者通过构造恶意的 SQL 语句，利用 `lo_export` 函数读取服务器上的敏感文件，例如 `/etc/passwd`。payload首先使用 `pg_read_file`读取文件内容,然后使用`convert_from`将内容转换为UTF8编码。\n2.  **WebSocket 劫持（PoC 中的利用方式）：** 该 PoC 尝试劫持一个已建立的 WebSocket 连接，并发送恶意 payload，以执行远程代码。\n3.  **远程代码执行（RCE）：** 通过反弹 shell，攻击者可以完全控制服务器。\n\n**投毒风险分析：**\n\nPoC 代码包含一个WebSocket劫持部分，其中包含一段python反弹shell的代码，需要将`REVERSE_IP`和`REVERSE_PORT`替换为攻击者控制的地址。该部分有风险，需要使用者确认该地址为其所拥有。如果该部分地址不是poc使用者所控制的,那么相当于poc使用者主动连接了poc编写者的服务器,存在一定的风险，但是不属于典型的投毒。\n
此外，PoC 代码依赖于特定版本的 JDK (22) 和 okhttp3 库，如果构建环境与预期不符，可能导致 PoC 无法正常运行。虽然这增加了使用难度，但并不构成主动投毒行为。\n
SQL注入本身就存在一定的数据库被植入后门的风险.但是该风险是SQL注入攻击本身具有的,不能算是POC的投毒风险.综合来看，POC 代码存在一定风险，但不属于典型的投毒行为，主要是webshell劫持部分需要确认。\n\n**缓解措施：**\n\n*   在引用输入之前，确认输入通过编码验证。\n*   升级到 PostgreSQL 17.3, 16.7, 15.11, 14.16, 或 13.19 或更高版本。

**项目地址:** [shacojx/CVE-2025-1094-Exploit](https://github.com/shacojx/CVE-2025-1094-Exploit)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #6

**来源**: [CVE-2025-1094-soltanali0_CVE-2025-1094-Exploit.md](../2025/CVE-2025-1094-soltanali0_CVE-2025-1094-Exploit.md)

## CVE-2025-1094-PostgreSQL-SQL注入到RCE

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致数据泄露和远程代码执行

**影响版本:** PostgreSQL 17.3之前, 16.7之前, 15.11之前, 14.16之前, 13.19之前

**利用条件:** 需要应用程序使用受影响的`PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`, 和 `PQescapeStringConn()` 函数的结果构建输入到 `psql`，或当`client_encoding`是`BIG5`且`server_encoding`是`EUC_TW`或`MULE_INTERNAL`时，利用命令行参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1094 是一个存在于 PostgreSQL 的 SQL 注入漏洞，允许攻击者通过注入恶意 SQL 代码读取敏感文件并执行任意命令，最终实现远程代码执行。漏洞利用涉及多个阶段：

1.  **SQL 注入**：攻击者利用 `PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`, 和 `PQescapeStringConn()` 函数中的不当转义，向PostgreSQL数据库注入恶意的SQL语句。从PoC代码来看，此处的SQL注入是通过`lo_export`和`pg_read_file`函数读取`/etc/passwd`文件，并将其保存到`/tmp/payload`。

2.  **WebSocket 劫持**：攻击者劫持一个已建立的WebSocket连接，并发送恶意payload，目的是在服务器上执行任意命令。

3.  **远程代码执行 (RCE)**：通过WebSocket连接发送的payload包含反向shell代码，该代码会连接到攻击者的监听端口，从而使攻击者获得服务器的控制权。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该PoC代码在满足特定条件的情况下是有效的。条件包括：
*   PostgreSQL 版本在受影响范围内。
*   应用程序使用了易受攻击的转义函数，或者使用了不安全的命令行参数。
*   存在可被劫持的 WebSocket 连接（PoC 代码假设存在）。

**投毒风险分析：**

该PoC代码存在一定的投毒风险，风险评估为10%。主要风险点在于：

*   **依赖外部 WebSocket 连接：** 该PoC假设存在一个可劫持的WebSocket连接。如果攻击者诱导用户使用包含恶意WebSocket连接的PoC，可能导致意外行为或信息泄露。
*   **反向Shell依赖：** PoC代码通过建立反向shell获取服务器控制权，如果攻击者修改了反向shell连接的IP和端口，可能会将受害者暴露给未知的第三方。
*  **文件读写**:虽然PoC读取`/etc/passwd`是为了演示，但未经授权的文件读写行为本身就是高危的。攻击者可能会更改读取的文件，或写入恶意文件，从而引入其他安全风险。
*   **隐蔽性**：攻击者可以将恶意代码隐藏在看似无害的WebSocket消息中，增加检测的难度。

**利用方式总结：**

1.  利用SQL注入漏洞，读取服务器上的敏感文件，例如`/etc/passwd`。
2.  劫持已建立的WebSocket连接。
3.  通过WebSocket连接，发送包含反向shell的恶意payload，从而在服务器上执行任意命令，获得服务器的远程控制权限。

**项目地址:** [soltanali0/CVE-2025-1094-Exploit](https://github.com/soltanali0/CVE-2025-1094-Exploit)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---



---

## POC #2

**来源**: [CVE-2025-1094-PinkArmor_CVE-2025-1094-Lab-Setup.md](../2025/CVE-2025-1094-PinkArmor_CVE-2025-1094-Lab-Setup.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要目标PostgreSQL服务器client_encoding为BIG5, server_encoding为EUC_TW或MULE_INTERNAL, 以及目标应用使用PQescapeLiteral(), PQescapeIdentifier(), PQescapeString(), 和 PQescapeStringConn()函数且未进行充分的输入验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1094漏洞存在于PostgreSQL的libpq函数中，由于在PQescapeLiteral(), PQescapeIdentifier(), PQescapeString(), 和 PQescapeStringConn()中未正确处理编码验证失败的文本中的引号语法，导致SQL注入。

**有效性评估：**
提供的POC代码针对PostgreSQL 14.15版本，该版本在受影响的版本范围内。通过Docker部署了易受攻击的PostgreSQL实例，并提供了一个Python脚本来利用该漏洞。利用方式是注入畸形的UTF-8编码，绕过输入验证，并使用`COPY ... TO PROGRAM`执行任意shell命令，最终获得反向shell。根据描述和代码逻辑，POC代码应该是有效的。

**投毒风险分析：**
提供的代码包含两个文件：`README.md` 和 `exploit.py`。`README.md` 描述了漏洞和利用过程，其中包含免责声明。`exploit.py` 是实际的漏洞利用代码，负责连接到PostgreSQL服务器并发送恶意payload。代码主要功能是利用漏洞获取反向shell。然而，在`exploit.py`中，存在可疑的`im`，怀疑作者存在隐藏的投毒代码。因此，投毒风险评估为10%。

**利用方式：**
1.  **环境准备：** 使用Docker部署易受攻击的PostgreSQL版本（<= 14.15）。
2.  **配置目标服务器：** 设置目标PostgreSQL服务器的`client_encoding`为`BIG5`，`server_encoding`为`EUC_TW`或`MULE_INTERNAL`。
3.  **启动监听器：** 在攻击者机器上启动一个监听器（例如，使用`nc -lvnp 4444`）以接收反向shell。
4.  **运行攻击脚本：** 运行提供的Python脚本，指定目标PostgreSQL服务器的IP地址、攻击者机器的IP地址和监听端口。
5.  **获取反向shell：** 如果利用成功，攻击者将收到来自易受攻击的PostgreSQL容器的反向shell，从而可以在服务器上执行任意命令。

**项目地址:** [PinkArmor/CVE-2025-1094-Lab-Setup](https://github.com/PinkArmor/CVE-2025-1094-Lab-Setup)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #3

**来源**: [CVE-2025-1094-aninfosec_CVE-2025-1094.md](../2025/CVE-2025-1094-aninfosec_CVE-2025-1094.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要目标应用程序使用受影响的PostgreSQL版本，并且使用libpq函数或psql命令行工具处理用户提供的、经过编码转换（BIG5到EUC_TW或MULE_INTERNAL）的输入。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1094是PostgreSQL中的一个SQL注入漏洞，影响多个版本。漏洞根源在于PostgreSQL的`PQescapeLiteral()`、`PQescapeIdentifier()`、`PQescapeString()`和`PQescapeStringConn()`等libpq函数，以及psql命令行工具在处理编码转换时，未能正确转义引号语法。如果应用程序使用这些函数的结果来构造传递给psql的输入，或者psql处理来自命令行参数的输入时，存在被SQL注入的风险。

**有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，该漏洞是有效的。搜索结果表明，Rapid7的研究人员发现了这个漏洞，并且已经有针对性的攻击发生。PoC代码通过设置`PGCLIENTENCODING`环境变量为`BIG5`，并构造恶意的SQL注入payload，利用`COPY ... TO PROGRAM`语句执行任意shell命令，从而获得反向shell。

**投毒风险：**
PoC代码分析：
* `exploit.py`脚本的目的是利用CVE-2025-1094漏洞。它通过构造特定的SQL payload，该payload包含`COPY ... TO PROGRAM`语句来执行系统命令，从而获得反向shell。
* `README.md`文件只包含CVE编号。
结论：
该仓库中**没有发现**明显的投毒代码。该脚本的目的是利用漏洞，而不是安装恶意软件或执行其他恶意行为。因此，投毒风险为0%。

**利用方式：**
1.  **环境配置：** 设置环境变量`PGCLIENTENCODING`为`BIG5`，模拟编码转换的环境。
2.  **构造Payload：** 构造包含恶意SQL代码的payload。PoC中使用了`COPY ... TO PROGRAM`语句，允许执行系统命令。
3.  **发送请求：** 将payload作为参数发送到目标应用程序，触发SQL注入。
4.  **反向Shell：** 如果利用成功，目标服务器会连接到攻击者的IP地址和端口，建立反向shell连接。

**项目地址:** [aninfosec/CVE-2025-1094](https://github.com/aninfosec/CVE-2025-1094)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #4

**来源**: [CVE-2025-1094-ishwardeepp_CVE-2025-1094-PoC-Postgre-SQLi.md](../2025/CVE-2025-1094-ishwardeepp_CVE-2025-1094-PoC-Postgre-SQLi.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 服务器编码为EUC_TW或MULE_INTERNAL，客户端编码为BIG5

**POC 可用性:** 是

**投毒风险:** 99%

## 详情

CVE-2025-1094是PostgreSQL中的一个高危SQL注入漏洞。由于`PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`和`PQescapeStringConn()`等函数在处理特定编码组合时（服务器编码为EUC_TW或MULE_INTERNAL，客户端编码为BIG5）未能正确转义引号，攻击者可以通过操纵数据库输入或命令行参数来执行任意SQL命令。

**有效性分析：**

提供的PoC代码通过利用编码不匹配，特别是`server_encoding=EUC_TW`和`client_encoding=BIG5`的组合，成功地绕过了PostgreSQL的转义机制。`exploit.py`文件发送包含恶意SQL代码的POST请求到`app.py`，该请求经过`psql`执行。`init.sql`创建了一个测试表，为SQL注入提供上下文。Docker环境的配置确保了编码环境正确。

**投毒风险分析：**

PoC代码存在极高的投毒风险。 理由如下：

1.  **任意文件读取：** PoC允许读取`/etc/passwd`文件，这表明可以读取服务器上的任何文件，包括敏感配置文件和私钥。
2.  **远程代码执行（RCE）：** 通过注入SQL，攻击者可以创建large object，读取文件，并将其导出到文件系统。这意味着，虽然PoC中示例是读取/etc/passwd，但是它可以执行任何数据库支持的操作，包括调用外部程序或库，进而实现RCE。
3.  **环境依赖：** PoC依赖于特定的编码设置，这使得在不同环境下利用的难度增加。 但如果攻击者控制了数据库的配置，则可以轻松设置正确的编码以利用该漏洞。
4.  **真实漏洞利用案例：** 搜索结果表明，此漏洞已被用于攻击BeyondTrust和美国财政部等机构，这表明真实环境中存在利用。

**漏洞利用方式：**

1.  **编码不匹配：** 利用`client_encoding`和`server_encoding`之间的差异绕过转义。
2.  **注入恶意SQL：** 通过`PQescapeLiteral()`等函数的缺陷，将恶意的SQL代码注入到`psql`命令中。
3.  **执行任意命令：**  利用SQL注入执行`pg_read_file`等函数，读取服务器上的文件，然后通过large object将内容导出到指定位置。

**总结：**

CVE-2025-1094是一个严重的安全漏洞，允许攻击者执行任意SQL命令，读取敏感文件甚至实现远程代码执行。提供的PoC代码有效，并存在极高的投毒风险。

**项目地址:** [ishwardeepp/CVE-2025-1094-PoC-Postgre-SQLi](https://github.com/ishwardeepp/CVE-2025-1094-PoC-Postgre-SQLi)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #5

**来源**: [CVE-2025-1094-shacojx_CVE-2025-1094-Exploit.md](../2025/CVE-2025-1094-shacojx_CVE-2025-1094-Exploit.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要数据库连接和特定的client/server encoding配置(BIG5, EUC_TW, MULE_INTERNAL)

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-1094 漏洞是 PostgreSQL 中由于不正确的引用语法中和导致的 SQL 注入漏洞。漏洞存在于 `PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`, 和 `PQescapeStringConn()` 等libpq函数中，以及 psql 命令行工具。\n\n**漏洞利用方式：**\n\n1.  **SQL 注入：** 攻击者通过构造恶意的 SQL 语句，利用 `lo_export` 函数读取服务器上的敏感文件，例如 `/etc/passwd`。payload首先使用 `pg_read_file`读取文件内容,然后使用`convert_from`将内容转换为UTF8编码。\n2.  **WebSocket 劫持（PoC 中的利用方式）：** 该 PoC 尝试劫持一个已建立的 WebSocket 连接，并发送恶意 payload，以执行远程代码。\n3.  **远程代码执行（RCE）：** 通过反弹 shell，攻击者可以完全控制服务器。\n\n**投毒风险分析：**\n\nPoC 代码包含一个WebSocket劫持部分，其中包含一段python反弹shell的代码，需要将`REVERSE_IP`和`REVERSE_PORT`替换为攻击者控制的地址。该部分有风险，需要使用者确认该地址为其所拥有。如果该部分地址不是poc使用者所控制的,那么相当于poc使用者主动连接了poc编写者的服务器,存在一定的风险，但是不属于典型的投毒。\n
此外，PoC 代码依赖于特定版本的 JDK (22) 和 okhttp3 库，如果构建环境与预期不符，可能导致 PoC 无法正常运行。虽然这增加了使用难度，但并不构成主动投毒行为。\n
SQL注入本身就存在一定的数据库被植入后门的风险.但是该风险是SQL注入攻击本身具有的,不能算是POC的投毒风险.综合来看，POC 代码存在一定风险，但不属于典型的投毒行为，主要是webshell劫持部分需要确认。\n\n**缓解措施：**\n\n*   在引用输入之前，确认输入通过编码验证。\n*   升级到 PostgreSQL 17.3, 16.7, 15.11, 14.16, 或 13.19 或更高版本。

**项目地址:** [shacojx/CVE-2025-1094-Exploit](https://github.com/shacojx/CVE-2025-1094-Exploit)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #6

**来源**: [CVE-2025-1094-soltanali0_CVE-2025-1094-Exploit.md](../2025/CVE-2025-1094-soltanali0_CVE-2025-1094-Exploit.md)

## CVE-2025-1094-PostgreSQL-SQL注入到RCE

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致数据泄露和远程代码执行

**影响版本:** PostgreSQL 17.3之前, 16.7之前, 15.11之前, 14.16之前, 13.19之前

**利用条件:** 需要应用程序使用受影响的`PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`, 和 `PQescapeStringConn()` 函数的结果构建输入到 `psql`，或当`client_encoding`是`BIG5`且`server_encoding`是`EUC_TW`或`MULE_INTERNAL`时，利用命令行参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1094 是一个存在于 PostgreSQL 的 SQL 注入漏洞，允许攻击者通过注入恶意 SQL 代码读取敏感文件并执行任意命令，最终实现远程代码执行。漏洞利用涉及多个阶段：

1.  **SQL 注入**：攻击者利用 `PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`, 和 `PQescapeStringConn()` 函数中的不当转义，向PostgreSQL数据库注入恶意的SQL语句。从PoC代码来看，此处的SQL注入是通过`lo_export`和`pg_read_file`函数读取`/etc/passwd`文件，并将其保存到`/tmp/payload`。

2.  **WebSocket 劫持**：攻击者劫持一个已建立的WebSocket连接，并发送恶意payload，目的是在服务器上执行任意命令。

3.  **远程代码执行 (RCE)**：通过WebSocket连接发送的payload包含反向shell代码，该代码会连接到攻击者的监听端口，从而使攻击者获得服务器的控制权。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该PoC代码在满足特定条件的情况下是有效的。条件包括：
*   PostgreSQL 版本在受影响范围内。
*   应用程序使用了易受攻击的转义函数，或者使用了不安全的命令行参数。
*   存在可被劫持的 WebSocket 连接（PoC 代码假设存在）。

**投毒风险分析：**

该PoC代码存在一定的投毒风险，风险评估为10%。主要风险点在于：

*   **依赖外部 WebSocket 连接：** 该PoC假设存在一个可劫持的WebSocket连接。如果攻击者诱导用户使用包含恶意WebSocket连接的PoC，可能导致意外行为或信息泄露。
*   **反向Shell依赖：** PoC代码通过建立反向shell获取服务器控制权，如果攻击者修改了反向shell连接的IP和端口，可能会将受害者暴露给未知的第三方。
*  **文件读写**:虽然PoC读取`/etc/passwd`是为了演示，但未经授权的文件读写行为本身就是高危的。攻击者可能会更改读取的文件，或写入恶意文件，从而引入其他安全风险。
*   **隐蔽性**：攻击者可以将恶意代码隐藏在看似无害的WebSocket消息中，增加检测的难度。

**利用方式总结：**

1.  利用SQL注入漏洞，读取服务器上的敏感文件，例如`/etc/passwd`。
2.  劫持已建立的WebSocket连接。
3.  通过WebSocket连接，发送包含反向shell的恶意payload，从而在服务器上执行任意命令，获得服务器的远程控制权限。

**项目地址:** [soltanali0/CVE-2025-1094-Exploit](https://github.com/soltanali0/CVE-2025-1094-Exploit)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---



---

## POC #2

**来源**: [CVE-2025-1094-PinkArmor_CVE-2025-1094-Lab-Setup.md](../2025/CVE-2025-1094-PinkArmor_CVE-2025-1094-Lab-Setup.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要目标PostgreSQL服务器client_encoding为BIG5, server_encoding为EUC_TW或MULE_INTERNAL, 以及目标应用使用PQescapeLiteral(), PQescapeIdentifier(), PQescapeString(), 和 PQescapeStringConn()函数且未进行充分的输入验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1094漏洞存在于PostgreSQL的libpq函数中，由于在PQescapeLiteral(), PQescapeIdentifier(), PQescapeString(), 和 PQescapeStringConn()中未正确处理编码验证失败的文本中的引号语法，导致SQL注入。

**有效性评估：**
提供的POC代码针对PostgreSQL 14.15版本，该版本在受影响的版本范围内。通过Docker部署了易受攻击的PostgreSQL实例，并提供了一个Python脚本来利用该漏洞。利用方式是注入畸形的UTF-8编码，绕过输入验证，并使用`COPY ... TO PROGRAM`执行任意shell命令，最终获得反向shell。根据描述和代码逻辑，POC代码应该是有效的。

**投毒风险分析：**
提供的代码包含两个文件：`README.md` 和 `exploit.py`。`README.md` 描述了漏洞和利用过程，其中包含免责声明。`exploit.py` 是实际的漏洞利用代码，负责连接到PostgreSQL服务器并发送恶意payload。代码主要功能是利用漏洞获取反向shell。然而，在`exploit.py`中，存在可疑的`im`，怀疑作者存在隐藏的投毒代码。因此，投毒风险评估为10%。

**利用方式：**
1.  **环境准备：** 使用Docker部署易受攻击的PostgreSQL版本（<= 14.15）。
2.  **配置目标服务器：** 设置目标PostgreSQL服务器的`client_encoding`为`BIG5`，`server_encoding`为`EUC_TW`或`MULE_INTERNAL`。
3.  **启动监听器：** 在攻击者机器上启动一个监听器（例如，使用`nc -lvnp 4444`）以接收反向shell。
4.  **运行攻击脚本：** 运行提供的Python脚本，指定目标PostgreSQL服务器的IP地址、攻击者机器的IP地址和监听端口。
5.  **获取反向shell：** 如果利用成功，攻击者将收到来自易受攻击的PostgreSQL容器的反向shell，从而可以在服务器上执行任意命令。

**项目地址:** [PinkArmor/CVE-2025-1094-Lab-Setup](https://github.com/PinkArmor/CVE-2025-1094-Lab-Setup)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #3

**来源**: [CVE-2025-1094-aninfosec_CVE-2025-1094.md](../2025/CVE-2025-1094-aninfosec_CVE-2025-1094.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要目标应用程序使用受影响的PostgreSQL版本，并且使用libpq函数或psql命令行工具处理用户提供的、经过编码转换（BIG5到EUC_TW或MULE_INTERNAL）的输入。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1094是PostgreSQL中的一个SQL注入漏洞，影响多个版本。漏洞根源在于PostgreSQL的`PQescapeLiteral()`、`PQescapeIdentifier()`、`PQescapeString()`和`PQescapeStringConn()`等libpq函数，以及psql命令行工具在处理编码转换时，未能正确转义引号语法。如果应用程序使用这些函数的结果来构造传递给psql的输入，或者psql处理来自命令行参数的输入时，存在被SQL注入的风险。

**有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，该漏洞是有效的。搜索结果表明，Rapid7的研究人员发现了这个漏洞，并且已经有针对性的攻击发生。PoC代码通过设置`PGCLIENTENCODING`环境变量为`BIG5`，并构造恶意的SQL注入payload，利用`COPY ... TO PROGRAM`语句执行任意shell命令，从而获得反向shell。

**投毒风险：**
PoC代码分析：
* `exploit.py`脚本的目的是利用CVE-2025-1094漏洞。它通过构造特定的SQL payload，该payload包含`COPY ... TO PROGRAM`语句来执行系统命令，从而获得反向shell。
* `README.md`文件只包含CVE编号。
结论：
该仓库中**没有发现**明显的投毒代码。该脚本的目的是利用漏洞，而不是安装恶意软件或执行其他恶意行为。因此，投毒风险为0%。

**利用方式：**
1.  **环境配置：** 设置环境变量`PGCLIENTENCODING`为`BIG5`，模拟编码转换的环境。
2.  **构造Payload：** 构造包含恶意SQL代码的payload。PoC中使用了`COPY ... TO PROGRAM`语句，允许执行系统命令。
3.  **发送请求：** 将payload作为参数发送到目标应用程序，触发SQL注入。
4.  **反向Shell：** 如果利用成功，目标服务器会连接到攻击者的IP地址和端口，建立反向shell连接。

**项目地址:** [aninfosec/CVE-2025-1094](https://github.com/aninfosec/CVE-2025-1094)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #4

**来源**: [CVE-2025-1094-ishwardeepp_CVE-2025-1094-PoC-Postgre-SQLi.md](../2025/CVE-2025-1094-ishwardeepp_CVE-2025-1094-PoC-Postgre-SQLi.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 服务器编码为EUC_TW或MULE_INTERNAL，客户端编码为BIG5

**POC 可用性:** 是

**投毒风险:** 99%

## 详情

CVE-2025-1094是PostgreSQL中的一个高危SQL注入漏洞。由于`PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`和`PQescapeStringConn()`等函数在处理特定编码组合时（服务器编码为EUC_TW或MULE_INTERNAL，客户端编码为BIG5）未能正确转义引号，攻击者可以通过操纵数据库输入或命令行参数来执行任意SQL命令。

**有效性分析：**

提供的PoC代码通过利用编码不匹配，特别是`server_encoding=EUC_TW`和`client_encoding=BIG5`的组合，成功地绕过了PostgreSQL的转义机制。`exploit.py`文件发送包含恶意SQL代码的POST请求到`app.py`，该请求经过`psql`执行。`init.sql`创建了一个测试表，为SQL注入提供上下文。Docker环境的配置确保了编码环境正确。

**投毒风险分析：**

PoC代码存在极高的投毒风险。 理由如下：

1.  **任意文件读取：** PoC允许读取`/etc/passwd`文件，这表明可以读取服务器上的任何文件，包括敏感配置文件和私钥。
2.  **远程代码执行（RCE）：** 通过注入SQL，攻击者可以创建large object，读取文件，并将其导出到文件系统。这意味着，虽然PoC中示例是读取/etc/passwd，但是它可以执行任何数据库支持的操作，包括调用外部程序或库，进而实现RCE。
3.  **环境依赖：** PoC依赖于特定的编码设置，这使得在不同环境下利用的难度增加。 但如果攻击者控制了数据库的配置，则可以轻松设置正确的编码以利用该漏洞。
4.  **真实漏洞利用案例：** 搜索结果表明，此漏洞已被用于攻击BeyondTrust和美国财政部等机构，这表明真实环境中存在利用。

**漏洞利用方式：**

1.  **编码不匹配：** 利用`client_encoding`和`server_encoding`之间的差异绕过转义。
2.  **注入恶意SQL：** 通过`PQescapeLiteral()`等函数的缺陷，将恶意的SQL代码注入到`psql`命令中。
3.  **执行任意命令：**  利用SQL注入执行`pg_read_file`等函数，读取服务器上的文件，然后通过large object将内容导出到指定位置。

**总结：**

CVE-2025-1094是一个严重的安全漏洞，允许攻击者执行任意SQL命令，读取敏感文件甚至实现远程代码执行。提供的PoC代码有效，并存在极高的投毒风险。

**项目地址:** [ishwardeepp/CVE-2025-1094-PoC-Postgre-SQLi](https://github.com/ishwardeepp/CVE-2025-1094-PoC-Postgre-SQLi)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #5

**来源**: [CVE-2025-1094-shacojx_CVE-2025-1094-Exploit.md](../2025/CVE-2025-1094-shacojx_CVE-2025-1094-Exploit.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要数据库连接和特定的client/server encoding配置(BIG5, EUC_TW, MULE_INTERNAL)

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-1094 漏洞是 PostgreSQL 中由于不正确的引用语法中和导致的 SQL 注入漏洞。漏洞存在于 `PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`, 和 `PQescapeStringConn()` 等libpq函数中，以及 psql 命令行工具。\n\n**漏洞利用方式：**\n\n1.  **SQL 注入：** 攻击者通过构造恶意的 SQL 语句，利用 `lo_export` 函数读取服务器上的敏感文件，例如 `/etc/passwd`。payload首先使用 `pg_read_file`读取文件内容,然后使用`convert_from`将内容转换为UTF8编码。\n2.  **WebSocket 劫持（PoC 中的利用方式）：** 该 PoC 尝试劫持一个已建立的 WebSocket 连接，并发送恶意 payload，以执行远程代码。\n3.  **远程代码执行（RCE）：** 通过反弹 shell，攻击者可以完全控制服务器。\n\n**投毒风险分析：**\n\nPoC 代码包含一个WebSocket劫持部分，其中包含一段python反弹shell的代码，需要将`REVERSE_IP`和`REVERSE_PORT`替换为攻击者控制的地址。该部分有风险，需要使用者确认该地址为其所拥有。如果该部分地址不是poc使用者所控制的,那么相当于poc使用者主动连接了poc编写者的服务器,存在一定的风险，但是不属于典型的投毒。\n
此外，PoC 代码依赖于特定版本的 JDK (22) 和 okhttp3 库，如果构建环境与预期不符，可能导致 PoC 无法正常运行。虽然这增加了使用难度，但并不构成主动投毒行为。\n
SQL注入本身就存在一定的数据库被植入后门的风险.但是该风险是SQL注入攻击本身具有的,不能算是POC的投毒风险.综合来看，POC 代码存在一定风险，但不属于典型的投毒行为，主要是webshell劫持部分需要确认。\n\n**缓解措施：**\n\n*   在引用输入之前，确认输入通过编码验证。\n*   升级到 PostgreSQL 17.3, 16.7, 15.11, 14.16, 或 13.19 或更高版本。

**项目地址:** [shacojx/CVE-2025-1094-Exploit](https://github.com/shacojx/CVE-2025-1094-Exploit)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #6

**来源**: [CVE-2025-1094-soltanali0_CVE-2025-1094-Exploit.md](../2025/CVE-2025-1094-soltanali0_CVE-2025-1094-Exploit.md)

## CVE-2025-1094-PostgreSQL-SQL注入到RCE

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致数据泄露和远程代码执行

**影响版本:** PostgreSQL 17.3之前, 16.7之前, 15.11之前, 14.16之前, 13.19之前

**利用条件:** 需要应用程序使用受影响的`PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`, 和 `PQescapeStringConn()` 函数的结果构建输入到 `psql`，或当`client_encoding`是`BIG5`且`server_encoding`是`EUC_TW`或`MULE_INTERNAL`时，利用命令行参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1094 是一个存在于 PostgreSQL 的 SQL 注入漏洞，允许攻击者通过注入恶意 SQL 代码读取敏感文件并执行任意命令，最终实现远程代码执行。漏洞利用涉及多个阶段：

1.  **SQL 注入**：攻击者利用 `PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`, 和 `PQescapeStringConn()` 函数中的不当转义，向PostgreSQL数据库注入恶意的SQL语句。从PoC代码来看，此处的SQL注入是通过`lo_export`和`pg_read_file`函数读取`/etc/passwd`文件，并将其保存到`/tmp/payload`。

2.  **WebSocket 劫持**：攻击者劫持一个已建立的WebSocket连接，并发送恶意payload，目的是在服务器上执行任意命令。

3.  **远程代码执行 (RCE)**：通过WebSocket连接发送的payload包含反向shell代码，该代码会连接到攻击者的监听端口，从而使攻击者获得服务器的控制权。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该PoC代码在满足特定条件的情况下是有效的。条件包括：
*   PostgreSQL 版本在受影响范围内。
*   应用程序使用了易受攻击的转义函数，或者使用了不安全的命令行参数。
*   存在可被劫持的 WebSocket 连接（PoC 代码假设存在）。

**投毒风险分析：**

该PoC代码存在一定的投毒风险，风险评估为10%。主要风险点在于：

*   **依赖外部 WebSocket 连接：** 该PoC假设存在一个可劫持的WebSocket连接。如果攻击者诱导用户使用包含恶意WebSocket连接的PoC，可能导致意外行为或信息泄露。
*   **反向Shell依赖：** PoC代码通过建立反向shell获取服务器控制权，如果攻击者修改了反向shell连接的IP和端口，可能会将受害者暴露给未知的第三方。
*  **文件读写**:虽然PoC读取`/etc/passwd`是为了演示，但未经授权的文件读写行为本身就是高危的。攻击者可能会更改读取的文件，或写入恶意文件，从而引入其他安全风险。
*   **隐蔽性**：攻击者可以将恶意代码隐藏在看似无害的WebSocket消息中，增加检测的难度。

**利用方式总结：**

1.  利用SQL注入漏洞，读取服务器上的敏感文件，例如`/etc/passwd`。
2.  劫持已建立的WebSocket连接。
3.  通过WebSocket连接，发送包含反向shell的恶意payload，从而在服务器上执行任意命令，获得服务器的远程控制权限。

**项目地址:** [soltanali0/CVE-2025-1094-Exploit](https://github.com/soltanali0/CVE-2025-1094-Exploit)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---



---

## POC #2

**来源**: [CVE-2025-1094-PinkArmor_CVE-2025-1094-Lab-Setup.md](../2025/CVE-2025-1094-PinkArmor_CVE-2025-1094-Lab-Setup.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要目标PostgreSQL服务器client_encoding为BIG5, server_encoding为EUC_TW或MULE_INTERNAL, 以及目标应用使用PQescapeLiteral(), PQescapeIdentifier(), PQescapeString(), 和 PQescapeStringConn()函数且未进行充分的输入验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1094漏洞存在于PostgreSQL的libpq函数中，由于在PQescapeLiteral(), PQescapeIdentifier(), PQescapeString(), 和 PQescapeStringConn()中未正确处理编码验证失败的文本中的引号语法，导致SQL注入。

**有效性评估：**
提供的POC代码针对PostgreSQL 14.15版本，该版本在受影响的版本范围内。通过Docker部署了易受攻击的PostgreSQL实例，并提供了一个Python脚本来利用该漏洞。利用方式是注入畸形的UTF-8编码，绕过输入验证，并使用`COPY ... TO PROGRAM`执行任意shell命令，最终获得反向shell。根据描述和代码逻辑，POC代码应该是有效的。

**投毒风险分析：**
提供的代码包含两个文件：`README.md` 和 `exploit.py`。`README.md` 描述了漏洞和利用过程，其中包含免责声明。`exploit.py` 是实际的漏洞利用代码，负责连接到PostgreSQL服务器并发送恶意payload。代码主要功能是利用漏洞获取反向shell。然而，在`exploit.py`中，存在可疑的`im`，怀疑作者存在隐藏的投毒代码。因此，投毒风险评估为10%。

**利用方式：**
1.  **环境准备：** 使用Docker部署易受攻击的PostgreSQL版本（<= 14.15）。
2.  **配置目标服务器：** 设置目标PostgreSQL服务器的`client_encoding`为`BIG5`，`server_encoding`为`EUC_TW`或`MULE_INTERNAL`。
3.  **启动监听器：** 在攻击者机器上启动一个监听器（例如，使用`nc -lvnp 4444`）以接收反向shell。
4.  **运行攻击脚本：** 运行提供的Python脚本，指定目标PostgreSQL服务器的IP地址、攻击者机器的IP地址和监听端口。
5.  **获取反向shell：** 如果利用成功，攻击者将收到来自易受攻击的PostgreSQL容器的反向shell，从而可以在服务器上执行任意命令。

**项目地址:** [PinkArmor/CVE-2025-1094-Lab-Setup](https://github.com/PinkArmor/CVE-2025-1094-Lab-Setup)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #3

**来源**: [CVE-2025-1094-aninfosec_CVE-2025-1094.md](../2025/CVE-2025-1094-aninfosec_CVE-2025-1094.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要目标应用程序使用受影响的PostgreSQL版本，并且使用libpq函数或psql命令行工具处理用户提供的、经过编码转换（BIG5到EUC_TW或MULE_INTERNAL）的输入。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1094是PostgreSQL中的一个SQL注入漏洞，影响多个版本。漏洞根源在于PostgreSQL的`PQescapeLiteral()`、`PQescapeIdentifier()`、`PQescapeString()`和`PQescapeStringConn()`等libpq函数，以及psql命令行工具在处理编码转换时，未能正确转义引号语法。如果应用程序使用这些函数的结果来构造传递给psql的输入，或者psql处理来自命令行参数的输入时，存在被SQL注入的风险。

**有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，该漏洞是有效的。搜索结果表明，Rapid7的研究人员发现了这个漏洞，并且已经有针对性的攻击发生。PoC代码通过设置`PGCLIENTENCODING`环境变量为`BIG5`，并构造恶意的SQL注入payload，利用`COPY ... TO PROGRAM`语句执行任意shell命令，从而获得反向shell。

**投毒风险：**
PoC代码分析：
* `exploit.py`脚本的目的是利用CVE-2025-1094漏洞。它通过构造特定的SQL payload，该payload包含`COPY ... TO PROGRAM`语句来执行系统命令，从而获得反向shell。
* `README.md`文件只包含CVE编号。
结论：
该仓库中**没有发现**明显的投毒代码。该脚本的目的是利用漏洞，而不是安装恶意软件或执行其他恶意行为。因此，投毒风险为0%。

**利用方式：**
1.  **环境配置：** 设置环境变量`PGCLIENTENCODING`为`BIG5`，模拟编码转换的环境。
2.  **构造Payload：** 构造包含恶意SQL代码的payload。PoC中使用了`COPY ... TO PROGRAM`语句，允许执行系统命令。
3.  **发送请求：** 将payload作为参数发送到目标应用程序，触发SQL注入。
4.  **反向Shell：** 如果利用成功，目标服务器会连接到攻击者的IP地址和端口，建立反向shell连接。

**项目地址:** [aninfosec/CVE-2025-1094](https://github.com/aninfosec/CVE-2025-1094)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #4

**来源**: [CVE-2025-1094-ishwardeepp_CVE-2025-1094-PoC-Postgre-SQLi.md](../2025/CVE-2025-1094-ishwardeepp_CVE-2025-1094-PoC-Postgre-SQLi.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 服务器编码为EUC_TW或MULE_INTERNAL，客户端编码为BIG5

**POC 可用性:** 是

**投毒风险:** 99%

## 详情

CVE-2025-1094是PostgreSQL中的一个高危SQL注入漏洞。由于`PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`和`PQescapeStringConn()`等函数在处理特定编码组合时（服务器编码为EUC_TW或MULE_INTERNAL，客户端编码为BIG5）未能正确转义引号，攻击者可以通过操纵数据库输入或命令行参数来执行任意SQL命令。

**有效性分析：**

提供的PoC代码通过利用编码不匹配，特别是`server_encoding=EUC_TW`和`client_encoding=BIG5`的组合，成功地绕过了PostgreSQL的转义机制。`exploit.py`文件发送包含恶意SQL代码的POST请求到`app.py`，该请求经过`psql`执行。`init.sql`创建了一个测试表，为SQL注入提供上下文。Docker环境的配置确保了编码环境正确。

**投毒风险分析：**

PoC代码存在极高的投毒风险。 理由如下：

1.  **任意文件读取：** PoC允许读取`/etc/passwd`文件，这表明可以读取服务器上的任何文件，包括敏感配置文件和私钥。
2.  **远程代码执行（RCE）：** 通过注入SQL，攻击者可以创建large object，读取文件，并将其导出到文件系统。这意味着，虽然PoC中示例是读取/etc/passwd，但是它可以执行任何数据库支持的操作，包括调用外部程序或库，进而实现RCE。
3.  **环境依赖：** PoC依赖于特定的编码设置，这使得在不同环境下利用的难度增加。 但如果攻击者控制了数据库的配置，则可以轻松设置正确的编码以利用该漏洞。
4.  **真实漏洞利用案例：** 搜索结果表明，此漏洞已被用于攻击BeyondTrust和美国财政部等机构，这表明真实环境中存在利用。

**漏洞利用方式：**

1.  **编码不匹配：** 利用`client_encoding`和`server_encoding`之间的差异绕过转义。
2.  **注入恶意SQL：** 通过`PQescapeLiteral()`等函数的缺陷，将恶意的SQL代码注入到`psql`命令中。
3.  **执行任意命令：**  利用SQL注入执行`pg_read_file`等函数，读取服务器上的文件，然后通过large object将内容导出到指定位置。

**总结：**

CVE-2025-1094是一个严重的安全漏洞，允许攻击者执行任意SQL命令，读取敏感文件甚至实现远程代码执行。提供的PoC代码有效，并存在极高的投毒风险。

**项目地址:** [ishwardeepp/CVE-2025-1094-PoC-Postgre-SQLi](https://github.com/ishwardeepp/CVE-2025-1094-PoC-Postgre-SQLi)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #5

**来源**: [CVE-2025-1094-shacojx_CVE-2025-1094-Exploit.md](../2025/CVE-2025-1094-shacojx_CVE-2025-1094-Exploit.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要数据库连接和特定的client/server encoding配置(BIG5, EUC_TW, MULE_INTERNAL)

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-1094 漏洞是 PostgreSQL 中由于不正确的引用语法中和导致的 SQL 注入漏洞。漏洞存在于 `PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`, 和 `PQescapeStringConn()` 等libpq函数中，以及 psql 命令行工具。\n\n**漏洞利用方式：**\n\n1.  **SQL 注入：** 攻击者通过构造恶意的 SQL 语句，利用 `lo_export` 函数读取服务器上的敏感文件，例如 `/etc/passwd`。payload首先使用 `pg_read_file`读取文件内容,然后使用`convert_from`将内容转换为UTF8编码。\n2.  **WebSocket 劫持（PoC 中的利用方式）：** 该 PoC 尝试劫持一个已建立的 WebSocket 连接，并发送恶意 payload，以执行远程代码。\n3.  **远程代码执行（RCE）：** 通过反弹 shell，攻击者可以完全控制服务器。\n\n**投毒风险分析：**\n\nPoC 代码包含一个WebSocket劫持部分，其中包含一段python反弹shell的代码，需要将`REVERSE_IP`和`REVERSE_PORT`替换为攻击者控制的地址。该部分有风险，需要使用者确认该地址为其所拥有。如果该部分地址不是poc使用者所控制的,那么相当于poc使用者主动连接了poc编写者的服务器,存在一定的风险，但是不属于典型的投毒。\n
此外，PoC 代码依赖于特定版本的 JDK (22) 和 okhttp3 库，如果构建环境与预期不符，可能导致 PoC 无法正常运行。虽然这增加了使用难度，但并不构成主动投毒行为。\n
SQL注入本身就存在一定的数据库被植入后门的风险.但是该风险是SQL注入攻击本身具有的,不能算是POC的投毒风险.综合来看，POC 代码存在一定风险，但不属于典型的投毒行为，主要是webshell劫持部分需要确认。\n\n**缓解措施：**\n\n*   在引用输入之前，确认输入通过编码验证。\n*   升级到 PostgreSQL 17.3, 16.7, 15.11, 14.16, 或 13.19 或更高版本。

**项目地址:** [shacojx/CVE-2025-1094-Exploit](https://github.com/shacojx/CVE-2025-1094-Exploit)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #6

**来源**: [CVE-2025-1094-soltanali0_CVE-2025-1094-Exploit.md](../2025/CVE-2025-1094-soltanali0_CVE-2025-1094-Exploit.md)

## CVE-2025-1094-PostgreSQL-SQL注入到RCE

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致数据泄露和远程代码执行

**影响版本:** PostgreSQL 17.3之前, 16.7之前, 15.11之前, 14.16之前, 13.19之前

**利用条件:** 需要应用程序使用受影响的`PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`, 和 `PQescapeStringConn()` 函数的结果构建输入到 `psql`，或当`client_encoding`是`BIG5`且`server_encoding`是`EUC_TW`或`MULE_INTERNAL`时，利用命令行参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1094 是一个存在于 PostgreSQL 的 SQL 注入漏洞，允许攻击者通过注入恶意 SQL 代码读取敏感文件并执行任意命令，最终实现远程代码执行。漏洞利用涉及多个阶段：

1.  **SQL 注入**：攻击者利用 `PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`, 和 `PQescapeStringConn()` 函数中的不当转义，向PostgreSQL数据库注入恶意的SQL语句。从PoC代码来看，此处的SQL注入是通过`lo_export`和`pg_read_file`函数读取`/etc/passwd`文件，并将其保存到`/tmp/payload`。

2.  **WebSocket 劫持**：攻击者劫持一个已建立的WebSocket连接，并发送恶意payload，目的是在服务器上执行任意命令。

3.  **远程代码执行 (RCE)**：通过WebSocket连接发送的payload包含反向shell代码，该代码会连接到攻击者的监听端口，从而使攻击者获得服务器的控制权。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该PoC代码在满足特定条件的情况下是有效的。条件包括：
*   PostgreSQL 版本在受影响范围内。
*   应用程序使用了易受攻击的转义函数，或者使用了不安全的命令行参数。
*   存在可被劫持的 WebSocket 连接（PoC 代码假设存在）。

**投毒风险分析：**

该PoC代码存在一定的投毒风险，风险评估为10%。主要风险点在于：

*   **依赖外部 WebSocket 连接：** 该PoC假设存在一个可劫持的WebSocket连接。如果攻击者诱导用户使用包含恶意WebSocket连接的PoC，可能导致意外行为或信息泄露。
*   **反向Shell依赖：** PoC代码通过建立反向shell获取服务器控制权，如果攻击者修改了反向shell连接的IP和端口，可能会将受害者暴露给未知的第三方。
*  **文件读写**:虽然PoC读取`/etc/passwd`是为了演示，但未经授权的文件读写行为本身就是高危的。攻击者可能会更改读取的文件，或写入恶意文件，从而引入其他安全风险。
*   **隐蔽性**：攻击者可以将恶意代码隐藏在看似无害的WebSocket消息中，增加检测的难度。

**利用方式总结：**

1.  利用SQL注入漏洞，读取服务器上的敏感文件，例如`/etc/passwd`。
2.  劫持已建立的WebSocket连接。
3.  通过WebSocket连接，发送包含反向shell的恶意payload，从而在服务器上执行任意命令，获得服务器的远程控制权限。

**项目地址:** [soltanali0/CVE-2025-1094-Exploit](https://github.com/soltanali0/CVE-2025-1094-Exploit)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---



---

## POC #2

**来源**: [CVE-2025-1094-PinkArmor_CVE-2025-1094-Lab-Setup.md](../2025/CVE-2025-1094-PinkArmor_CVE-2025-1094-Lab-Setup.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要目标PostgreSQL服务器client_encoding为BIG5, server_encoding为EUC_TW或MULE_INTERNAL, 以及目标应用使用PQescapeLiteral(), PQescapeIdentifier(), PQescapeString(), 和 PQescapeStringConn()函数且未进行充分的输入验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1094漏洞存在于PostgreSQL的libpq函数中，由于在PQescapeLiteral(), PQescapeIdentifier(), PQescapeString(), 和 PQescapeStringConn()中未正确处理编码验证失败的文本中的引号语法，导致SQL注入。

**有效性评估：**
提供的POC代码针对PostgreSQL 14.15版本，该版本在受影响的版本范围内。通过Docker部署了易受攻击的PostgreSQL实例，并提供了一个Python脚本来利用该漏洞。利用方式是注入畸形的UTF-8编码，绕过输入验证，并使用`COPY ... TO PROGRAM`执行任意shell命令，最终获得反向shell。根据描述和代码逻辑，POC代码应该是有效的。

**投毒风险分析：**
提供的代码包含两个文件：`README.md` 和 `exploit.py`。`README.md` 描述了漏洞和利用过程，其中包含免责声明。`exploit.py` 是实际的漏洞利用代码，负责连接到PostgreSQL服务器并发送恶意payload。代码主要功能是利用漏洞获取反向shell。然而，在`exploit.py`中，存在可疑的`im`，怀疑作者存在隐藏的投毒代码。因此，投毒风险评估为10%。

**利用方式：**
1.  **环境准备：** 使用Docker部署易受攻击的PostgreSQL版本（<= 14.15）。
2.  **配置目标服务器：** 设置目标PostgreSQL服务器的`client_encoding`为`BIG5`，`server_encoding`为`EUC_TW`或`MULE_INTERNAL`。
3.  **启动监听器：** 在攻击者机器上启动一个监听器（例如，使用`nc -lvnp 4444`）以接收反向shell。
4.  **运行攻击脚本：** 运行提供的Python脚本，指定目标PostgreSQL服务器的IP地址、攻击者机器的IP地址和监听端口。
5.  **获取反向shell：** 如果利用成功，攻击者将收到来自易受攻击的PostgreSQL容器的反向shell，从而可以在服务器上执行任意命令。

**项目地址:** [PinkArmor/CVE-2025-1094-Lab-Setup](https://github.com/PinkArmor/CVE-2025-1094-Lab-Setup)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #3

**来源**: [CVE-2025-1094-aninfosec_CVE-2025-1094.md](../2025/CVE-2025-1094-aninfosec_CVE-2025-1094.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要目标应用程序使用受影响的PostgreSQL版本，并且使用libpq函数或psql命令行工具处理用户提供的、经过编码转换（BIG5到EUC_TW或MULE_INTERNAL）的输入。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1094是PostgreSQL中的一个SQL注入漏洞，影响多个版本。漏洞根源在于PostgreSQL的`PQescapeLiteral()`、`PQescapeIdentifier()`、`PQescapeString()`和`PQescapeStringConn()`等libpq函数，以及psql命令行工具在处理编码转换时，未能正确转义引号语法。如果应用程序使用这些函数的结果来构造传递给psql的输入，或者psql处理来自命令行参数的输入时，存在被SQL注入的风险。

**有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，该漏洞是有效的。搜索结果表明，Rapid7的研究人员发现了这个漏洞，并且已经有针对性的攻击发生。PoC代码通过设置`PGCLIENTENCODING`环境变量为`BIG5`，并构造恶意的SQL注入payload，利用`COPY ... TO PROGRAM`语句执行任意shell命令，从而获得反向shell。

**投毒风险：**
PoC代码分析：
* `exploit.py`脚本的目的是利用CVE-2025-1094漏洞。它通过构造特定的SQL payload，该payload包含`COPY ... TO PROGRAM`语句来执行系统命令，从而获得反向shell。
* `README.md`文件只包含CVE编号。
结论：
该仓库中**没有发现**明显的投毒代码。该脚本的目的是利用漏洞，而不是安装恶意软件或执行其他恶意行为。因此，投毒风险为0%。

**利用方式：**
1.  **环境配置：** 设置环境变量`PGCLIENTENCODING`为`BIG5`，模拟编码转换的环境。
2.  **构造Payload：** 构造包含恶意SQL代码的payload。PoC中使用了`COPY ... TO PROGRAM`语句，允许执行系统命令。
3.  **发送请求：** 将payload作为参数发送到目标应用程序，触发SQL注入。
4.  **反向Shell：** 如果利用成功，目标服务器会连接到攻击者的IP地址和端口，建立反向shell连接。

**项目地址:** [aninfosec/CVE-2025-1094](https://github.com/aninfosec/CVE-2025-1094)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #4

**来源**: [CVE-2025-1094-ishwardeepp_CVE-2025-1094-PoC-Postgre-SQLi.md](../2025/CVE-2025-1094-ishwardeepp_CVE-2025-1094-PoC-Postgre-SQLi.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 服务器编码为EUC_TW或MULE_INTERNAL，客户端编码为BIG5

**POC 可用性:** 是

**投毒风险:** 99%

## 详情

CVE-2025-1094是PostgreSQL中的一个高危SQL注入漏洞。由于`PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`和`PQescapeStringConn()`等函数在处理特定编码组合时（服务器编码为EUC_TW或MULE_INTERNAL，客户端编码为BIG5）未能正确转义引号，攻击者可以通过操纵数据库输入或命令行参数来执行任意SQL命令。

**有效性分析：**

提供的PoC代码通过利用编码不匹配，特别是`server_encoding=EUC_TW`和`client_encoding=BIG5`的组合，成功地绕过了PostgreSQL的转义机制。`exploit.py`文件发送包含恶意SQL代码的POST请求到`app.py`，该请求经过`psql`执行。`init.sql`创建了一个测试表，为SQL注入提供上下文。Docker环境的配置确保了编码环境正确。

**投毒风险分析：**

PoC代码存在极高的投毒风险。 理由如下：

1.  **任意文件读取：** PoC允许读取`/etc/passwd`文件，这表明可以读取服务器上的任何文件，包括敏感配置文件和私钥。
2.  **远程代码执行（RCE）：** 通过注入SQL，攻击者可以创建large object，读取文件，并将其导出到文件系统。这意味着，虽然PoC中示例是读取/etc/passwd，但是它可以执行任何数据库支持的操作，包括调用外部程序或库，进而实现RCE。
3.  **环境依赖：** PoC依赖于特定的编码设置，这使得在不同环境下利用的难度增加。 但如果攻击者控制了数据库的配置，则可以轻松设置正确的编码以利用该漏洞。
4.  **真实漏洞利用案例：** 搜索结果表明，此漏洞已被用于攻击BeyondTrust和美国财政部等机构，这表明真实环境中存在利用。

**漏洞利用方式：**

1.  **编码不匹配：** 利用`client_encoding`和`server_encoding`之间的差异绕过转义。
2.  **注入恶意SQL：** 通过`PQescapeLiteral()`等函数的缺陷，将恶意的SQL代码注入到`psql`命令中。
3.  **执行任意命令：**  利用SQL注入执行`pg_read_file`等函数，读取服务器上的文件，然后通过large object将内容导出到指定位置。

**总结：**

CVE-2025-1094是一个严重的安全漏洞，允许攻击者执行任意SQL命令，读取敏感文件甚至实现远程代码执行。提供的PoC代码有效，并存在极高的投毒风险。

**项目地址:** [ishwardeepp/CVE-2025-1094-PoC-Postgre-SQLi](https://github.com/ishwardeepp/CVE-2025-1094-PoC-Postgre-SQLi)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #5

**来源**: [CVE-2025-1094-shacojx_CVE-2025-1094-Exploit.md](../2025/CVE-2025-1094-shacojx_CVE-2025-1094-Exploit.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要数据库连接和特定的client/server encoding配置(BIG5, EUC_TW, MULE_INTERNAL)

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-1094 漏洞是 PostgreSQL 中由于不正确的引用语法中和导致的 SQL 注入漏洞。漏洞存在于 `PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`, 和 `PQescapeStringConn()` 等libpq函数中，以及 psql 命令行工具。\n\n**漏洞利用方式：**\n\n1.  **SQL 注入：** 攻击者通过构造恶意的 SQL 语句，利用 `lo_export` 函数读取服务器上的敏感文件，例如 `/etc/passwd`。payload首先使用 `pg_read_file`读取文件内容,然后使用`convert_from`将内容转换为UTF8编码。\n2.  **WebSocket 劫持（PoC 中的利用方式）：** 该 PoC 尝试劫持一个已建立的 WebSocket 连接，并发送恶意 payload，以执行远程代码。\n3.  **远程代码执行（RCE）：** 通过反弹 shell，攻击者可以完全控制服务器。\n\n**投毒风险分析：**\n\nPoC 代码包含一个WebSocket劫持部分，其中包含一段python反弹shell的代码，需要将`REVERSE_IP`和`REVERSE_PORT`替换为攻击者控制的地址。该部分有风险，需要使用者确认该地址为其所拥有。如果该部分地址不是poc使用者所控制的,那么相当于poc使用者主动连接了poc编写者的服务器,存在一定的风险，但是不属于典型的投毒。\n
此外，PoC 代码依赖于特定版本的 JDK (22) 和 okhttp3 库，如果构建环境与预期不符，可能导致 PoC 无法正常运行。虽然这增加了使用难度，但并不构成主动投毒行为。\n
SQL注入本身就存在一定的数据库被植入后门的风险.但是该风险是SQL注入攻击本身具有的,不能算是POC的投毒风险.综合来看，POC 代码存在一定风险，但不属于典型的投毒行为，主要是webshell劫持部分需要确认。\n\n**缓解措施：**\n\n*   在引用输入之前，确认输入通过编码验证。\n*   升级到 PostgreSQL 17.3, 16.7, 15.11, 14.16, 或 13.19 或更高版本。

**项目地址:** [shacojx/CVE-2025-1094-Exploit](https://github.com/shacojx/CVE-2025-1094-Exploit)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #6

**来源**: [CVE-2025-1094-soltanali0_CVE-2025-1094-Exploit.md](../2025/CVE-2025-1094-soltanali0_CVE-2025-1094-Exploit.md)

## CVE-2025-1094-PostgreSQL-SQL注入到RCE

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致数据泄露和远程代码执行

**影响版本:** PostgreSQL 17.3之前, 16.7之前, 15.11之前, 14.16之前, 13.19之前

**利用条件:** 需要应用程序使用受影响的`PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`, 和 `PQescapeStringConn()` 函数的结果构建输入到 `psql`，或当`client_encoding`是`BIG5`且`server_encoding`是`EUC_TW`或`MULE_INTERNAL`时，利用命令行参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1094 是一个存在于 PostgreSQL 的 SQL 注入漏洞，允许攻击者通过注入恶意 SQL 代码读取敏感文件并执行任意命令，最终实现远程代码执行。漏洞利用涉及多个阶段：

1.  **SQL 注入**：攻击者利用 `PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`, 和 `PQescapeStringConn()` 函数中的不当转义，向PostgreSQL数据库注入恶意的SQL语句。从PoC代码来看，此处的SQL注入是通过`lo_export`和`pg_read_file`函数读取`/etc/passwd`文件，并将其保存到`/tmp/payload`。

2.  **WebSocket 劫持**：攻击者劫持一个已建立的WebSocket连接，并发送恶意payload，目的是在服务器上执行任意命令。

3.  **远程代码执行 (RCE)**：通过WebSocket连接发送的payload包含反向shell代码，该代码会连接到攻击者的监听端口，从而使攻击者获得服务器的控制权。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该PoC代码在满足特定条件的情况下是有效的。条件包括：
*   PostgreSQL 版本在受影响范围内。
*   应用程序使用了易受攻击的转义函数，或者使用了不安全的命令行参数。
*   存在可被劫持的 WebSocket 连接（PoC 代码假设存在）。

**投毒风险分析：**

该PoC代码存在一定的投毒风险，风险评估为10%。主要风险点在于：

*   **依赖外部 WebSocket 连接：** 该PoC假设存在一个可劫持的WebSocket连接。如果攻击者诱导用户使用包含恶意WebSocket连接的PoC，可能导致意外行为或信息泄露。
*   **反向Shell依赖：** PoC代码通过建立反向shell获取服务器控制权，如果攻击者修改了反向shell连接的IP和端口，可能会将受害者暴露给未知的第三方。
*  **文件读写**:虽然PoC读取`/etc/passwd`是为了演示，但未经授权的文件读写行为本身就是高危的。攻击者可能会更改读取的文件，或写入恶意文件，从而引入其他安全风险。
*   **隐蔽性**：攻击者可以将恶意代码隐藏在看似无害的WebSocket消息中，增加检测的难度。

**利用方式总结：**

1.  利用SQL注入漏洞，读取服务器上的敏感文件，例如`/etc/passwd`。
2.  劫持已建立的WebSocket连接。
3.  通过WebSocket连接，发送包含反向shell的恶意payload，从而在服务器上执行任意命令，获得服务器的远程控制权限。

**项目地址:** [soltanali0/CVE-2025-1094-Exploit](https://github.com/soltanali0/CVE-2025-1094-Exploit)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---



---

## POC #2

**来源**: [CVE-2025-1094-PinkArmor_CVE-2025-1094-Lab-Setup.md](../2025/CVE-2025-1094-PinkArmor_CVE-2025-1094-Lab-Setup.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要目标PostgreSQL服务器client_encoding为BIG5, server_encoding为EUC_TW或MULE_INTERNAL, 以及目标应用使用PQescapeLiteral(), PQescapeIdentifier(), PQescapeString(), 和 PQescapeStringConn()函数且未进行充分的输入验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1094漏洞存在于PostgreSQL的libpq函数中，由于在PQescapeLiteral(), PQescapeIdentifier(), PQescapeString(), 和 PQescapeStringConn()中未正确处理编码验证失败的文本中的引号语法，导致SQL注入。

**有效性评估：**
提供的POC代码针对PostgreSQL 14.15版本，该版本在受影响的版本范围内。通过Docker部署了易受攻击的PostgreSQL实例，并提供了一个Python脚本来利用该漏洞。利用方式是注入畸形的UTF-8编码，绕过输入验证，并使用`COPY ... TO PROGRAM`执行任意shell命令，最终获得反向shell。根据描述和代码逻辑，POC代码应该是有效的。

**投毒风险分析：**
提供的代码包含两个文件：`README.md` 和 `exploit.py`。`README.md` 描述了漏洞和利用过程，其中包含免责声明。`exploit.py` 是实际的漏洞利用代码，负责连接到PostgreSQL服务器并发送恶意payload。代码主要功能是利用漏洞获取反向shell。然而，在`exploit.py`中，存在可疑的`im`，怀疑作者存在隐藏的投毒代码。因此，投毒风险评估为10%。

**利用方式：**
1.  **环境准备：** 使用Docker部署易受攻击的PostgreSQL版本（<= 14.15）。
2.  **配置目标服务器：** 设置目标PostgreSQL服务器的`client_encoding`为`BIG5`，`server_encoding`为`EUC_TW`或`MULE_INTERNAL`。
3.  **启动监听器：** 在攻击者机器上启动一个监听器（例如，使用`nc -lvnp 4444`）以接收反向shell。
4.  **运行攻击脚本：** 运行提供的Python脚本，指定目标PostgreSQL服务器的IP地址、攻击者机器的IP地址和监听端口。
5.  **获取反向shell：** 如果利用成功，攻击者将收到来自易受攻击的PostgreSQL容器的反向shell，从而可以在服务器上执行任意命令。

**项目地址:** [PinkArmor/CVE-2025-1094-Lab-Setup](https://github.com/PinkArmor/CVE-2025-1094-Lab-Setup)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #3

**来源**: [CVE-2025-1094-aninfosec_CVE-2025-1094.md](../2025/CVE-2025-1094-aninfosec_CVE-2025-1094.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要目标应用程序使用受影响的PostgreSQL版本，并且使用libpq函数或psql命令行工具处理用户提供的、经过编码转换（BIG5到EUC_TW或MULE_INTERNAL）的输入。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1094是PostgreSQL中的一个SQL注入漏洞，影响多个版本。漏洞根源在于PostgreSQL的`PQescapeLiteral()`、`PQescapeIdentifier()`、`PQescapeString()`和`PQescapeStringConn()`等libpq函数，以及psql命令行工具在处理编码转换时，未能正确转义引号语法。如果应用程序使用这些函数的结果来构造传递给psql的输入，或者psql处理来自命令行参数的输入时，存在被SQL注入的风险。

**有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，该漏洞是有效的。搜索结果表明，Rapid7的研究人员发现了这个漏洞，并且已经有针对性的攻击发生。PoC代码通过设置`PGCLIENTENCODING`环境变量为`BIG5`，并构造恶意的SQL注入payload，利用`COPY ... TO PROGRAM`语句执行任意shell命令，从而获得反向shell。

**投毒风险：**
PoC代码分析：
* `exploit.py`脚本的目的是利用CVE-2025-1094漏洞。它通过构造特定的SQL payload，该payload包含`COPY ... TO PROGRAM`语句来执行系统命令，从而获得反向shell。
* `README.md`文件只包含CVE编号。
结论：
该仓库中**没有发现**明显的投毒代码。该脚本的目的是利用漏洞，而不是安装恶意软件或执行其他恶意行为。因此，投毒风险为0%。

**利用方式：**
1.  **环境配置：** 设置环境变量`PGCLIENTENCODING`为`BIG5`，模拟编码转换的环境。
2.  **构造Payload：** 构造包含恶意SQL代码的payload。PoC中使用了`COPY ... TO PROGRAM`语句，允许执行系统命令。
3.  **发送请求：** 将payload作为参数发送到目标应用程序，触发SQL注入。
4.  **反向Shell：** 如果利用成功，目标服务器会连接到攻击者的IP地址和端口，建立反向shell连接。

**项目地址:** [aninfosec/CVE-2025-1094](https://github.com/aninfosec/CVE-2025-1094)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #4

**来源**: [CVE-2025-1094-ishwardeepp_CVE-2025-1094-PoC-Postgre-SQLi.md](../2025/CVE-2025-1094-ishwardeepp_CVE-2025-1094-PoC-Postgre-SQLi.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 服务器编码为EUC_TW或MULE_INTERNAL，客户端编码为BIG5

**POC 可用性:** 是

**投毒风险:** 99%

## 详情

CVE-2025-1094是PostgreSQL中的一个高危SQL注入漏洞。由于`PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`和`PQescapeStringConn()`等函数在处理特定编码组合时（服务器编码为EUC_TW或MULE_INTERNAL，客户端编码为BIG5）未能正确转义引号，攻击者可以通过操纵数据库输入或命令行参数来执行任意SQL命令。

**有效性分析：**

提供的PoC代码通过利用编码不匹配，特别是`server_encoding=EUC_TW`和`client_encoding=BIG5`的组合，成功地绕过了PostgreSQL的转义机制。`exploit.py`文件发送包含恶意SQL代码的POST请求到`app.py`，该请求经过`psql`执行。`init.sql`创建了一个测试表，为SQL注入提供上下文。Docker环境的配置确保了编码环境正确。

**投毒风险分析：**

PoC代码存在极高的投毒风险。 理由如下：

1.  **任意文件读取：** PoC允许读取`/etc/passwd`文件，这表明可以读取服务器上的任何文件，包括敏感配置文件和私钥。
2.  **远程代码执行（RCE）：** 通过注入SQL，攻击者可以创建large object，读取文件，并将其导出到文件系统。这意味着，虽然PoC中示例是读取/etc/passwd，但是它可以执行任何数据库支持的操作，包括调用外部程序或库，进而实现RCE。
3.  **环境依赖：** PoC依赖于特定的编码设置，这使得在不同环境下利用的难度增加。 但如果攻击者控制了数据库的配置，则可以轻松设置正确的编码以利用该漏洞。
4.  **真实漏洞利用案例：** 搜索结果表明，此漏洞已被用于攻击BeyondTrust和美国财政部等机构，这表明真实环境中存在利用。

**漏洞利用方式：**

1.  **编码不匹配：** 利用`client_encoding`和`server_encoding`之间的差异绕过转义。
2.  **注入恶意SQL：** 通过`PQescapeLiteral()`等函数的缺陷，将恶意的SQL代码注入到`psql`命令中。
3.  **执行任意命令：**  利用SQL注入执行`pg_read_file`等函数，读取服务器上的文件，然后通过large object将内容导出到指定位置。

**总结：**

CVE-2025-1094是一个严重的安全漏洞，允许攻击者执行任意SQL命令，读取敏感文件甚至实现远程代码执行。提供的PoC代码有效，并存在极高的投毒风险。

**项目地址:** [ishwardeepp/CVE-2025-1094-PoC-Postgre-SQLi](https://github.com/ishwardeepp/CVE-2025-1094-PoC-Postgre-SQLi)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #5

**来源**: [CVE-2025-1094-shacojx_CVE-2025-1094-Exploit.md](../2025/CVE-2025-1094-shacojx_CVE-2025-1094-Exploit.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要数据库连接和特定的client/server encoding配置(BIG5, EUC_TW, MULE_INTERNAL)

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-1094 漏洞是 PostgreSQL 中由于不正确的引用语法中和导致的 SQL 注入漏洞。漏洞存在于 `PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`, 和 `PQescapeStringConn()` 等libpq函数中，以及 psql 命令行工具。\n\n**漏洞利用方式：**\n\n1.  **SQL 注入：** 攻击者通过构造恶意的 SQL 语句，利用 `lo_export` 函数读取服务器上的敏感文件，例如 `/etc/passwd`。payload首先使用 `pg_read_file`读取文件内容,然后使用`convert_from`将内容转换为UTF8编码。\n2.  **WebSocket 劫持（PoC 中的利用方式）：** 该 PoC 尝试劫持一个已建立的 WebSocket 连接，并发送恶意 payload，以执行远程代码。\n3.  **远程代码执行（RCE）：** 通过反弹 shell，攻击者可以完全控制服务器。\n\n**投毒风险分析：**\n\nPoC 代码包含一个WebSocket劫持部分，其中包含一段python反弹shell的代码，需要将`REVERSE_IP`和`REVERSE_PORT`替换为攻击者控制的地址。该部分有风险，需要使用者确认该地址为其所拥有。如果该部分地址不是poc使用者所控制的,那么相当于poc使用者主动连接了poc编写者的服务器,存在一定的风险，但是不属于典型的投毒。\n
此外，PoC 代码依赖于特定版本的 JDK (22) 和 okhttp3 库，如果构建环境与预期不符，可能导致 PoC 无法正常运行。虽然这增加了使用难度，但并不构成主动投毒行为。\n
SQL注入本身就存在一定的数据库被植入后门的风险.但是该风险是SQL注入攻击本身具有的,不能算是POC的投毒风险.综合来看，POC 代码存在一定风险，但不属于典型的投毒行为，主要是webshell劫持部分需要确认。\n\n**缓解措施：**\n\n*   在引用输入之前，确认输入通过编码验证。\n*   升级到 PostgreSQL 17.3, 16.7, 15.11, 14.16, 或 13.19 或更高版本。

**项目地址:** [shacojx/CVE-2025-1094-Exploit](https://github.com/shacojx/CVE-2025-1094-Exploit)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #6

**来源**: [CVE-2025-1094-soltanali0_CVE-2025-1094-Exploit.md](../2025/CVE-2025-1094-soltanali0_CVE-2025-1094-Exploit.md)

## CVE-2025-1094-PostgreSQL-SQL注入到RCE

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致数据泄露和远程代码执行

**影响版本:** PostgreSQL 17.3之前, 16.7之前, 15.11之前, 14.16之前, 13.19之前

**利用条件:** 需要应用程序使用受影响的`PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`, 和 `PQescapeStringConn()` 函数的结果构建输入到 `psql`，或当`client_encoding`是`BIG5`且`server_encoding`是`EUC_TW`或`MULE_INTERNAL`时，利用命令行参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1094 是一个存在于 PostgreSQL 的 SQL 注入漏洞，允许攻击者通过注入恶意 SQL 代码读取敏感文件并执行任意命令，最终实现远程代码执行。漏洞利用涉及多个阶段：

1.  **SQL 注入**：攻击者利用 `PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`, 和 `PQescapeStringConn()` 函数中的不当转义，向PostgreSQL数据库注入恶意的SQL语句。从PoC代码来看，此处的SQL注入是通过`lo_export`和`pg_read_file`函数读取`/etc/passwd`文件，并将其保存到`/tmp/payload`。

2.  **WebSocket 劫持**：攻击者劫持一个已建立的WebSocket连接，并发送恶意payload，目的是在服务器上执行任意命令。

3.  **远程代码执行 (RCE)**：通过WebSocket连接发送的payload包含反向shell代码，该代码会连接到攻击者的监听端口，从而使攻击者获得服务器的控制权。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该PoC代码在满足特定条件的情况下是有效的。条件包括：
*   PostgreSQL 版本在受影响范围内。
*   应用程序使用了易受攻击的转义函数，或者使用了不安全的命令行参数。
*   存在可被劫持的 WebSocket 连接（PoC 代码假设存在）。

**投毒风险分析：**

该PoC代码存在一定的投毒风险，风险评估为10%。主要风险点在于：

*   **依赖外部 WebSocket 连接：** 该PoC假设存在一个可劫持的WebSocket连接。如果攻击者诱导用户使用包含恶意WebSocket连接的PoC，可能导致意外行为或信息泄露。
*   **反向Shell依赖：** PoC代码通过建立反向shell获取服务器控制权，如果攻击者修改了反向shell连接的IP和端口，可能会将受害者暴露给未知的第三方。
*  **文件读写**:虽然PoC读取`/etc/passwd`是为了演示，但未经授权的文件读写行为本身就是高危的。攻击者可能会更改读取的文件，或写入恶意文件，从而引入其他安全风险。
*   **隐蔽性**：攻击者可以将恶意代码隐藏在看似无害的WebSocket消息中，增加检测的难度。

**利用方式总结：**

1.  利用SQL注入漏洞，读取服务器上的敏感文件，例如`/etc/passwd`。
2.  劫持已建立的WebSocket连接。
3.  通过WebSocket连接，发送包含反向shell的恶意payload，从而在服务器上执行任意命令，获得服务器的远程控制权限。

**项目地址:** [soltanali0/CVE-2025-1094-Exploit](https://github.com/soltanali0/CVE-2025-1094-Exploit)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---



---

## POC #2

**来源**: [CVE-2025-1094-PinkArmor_CVE-2025-1094-Lab-Setup.md](../2025/CVE-2025-1094-PinkArmor_CVE-2025-1094-Lab-Setup.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要目标PostgreSQL服务器client_encoding为BIG5, server_encoding为EUC_TW或MULE_INTERNAL, 以及目标应用使用PQescapeLiteral(), PQescapeIdentifier(), PQescapeString(), 和 PQescapeStringConn()函数且未进行充分的输入验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1094漏洞存在于PostgreSQL的libpq函数中，由于在PQescapeLiteral(), PQescapeIdentifier(), PQescapeString(), 和 PQescapeStringConn()中未正确处理编码验证失败的文本中的引号语法，导致SQL注入。

**有效性评估：**
提供的POC代码针对PostgreSQL 14.15版本，该版本在受影响的版本范围内。通过Docker部署了易受攻击的PostgreSQL实例，并提供了一个Python脚本来利用该漏洞。利用方式是注入畸形的UTF-8编码，绕过输入验证，并使用`COPY ... TO PROGRAM`执行任意shell命令，最终获得反向shell。根据描述和代码逻辑，POC代码应该是有效的。

**投毒风险分析：**
提供的代码包含两个文件：`README.md` 和 `exploit.py`。`README.md` 描述了漏洞和利用过程，其中包含免责声明。`exploit.py` 是实际的漏洞利用代码，负责连接到PostgreSQL服务器并发送恶意payload。代码主要功能是利用漏洞获取反向shell。然而，在`exploit.py`中，存在可疑的`im`，怀疑作者存在隐藏的投毒代码。因此，投毒风险评估为10%。

**利用方式：**
1.  **环境准备：** 使用Docker部署易受攻击的PostgreSQL版本（<= 14.15）。
2.  **配置目标服务器：** 设置目标PostgreSQL服务器的`client_encoding`为`BIG5`，`server_encoding`为`EUC_TW`或`MULE_INTERNAL`。
3.  **启动监听器：** 在攻击者机器上启动一个监听器（例如，使用`nc -lvnp 4444`）以接收反向shell。
4.  **运行攻击脚本：** 运行提供的Python脚本，指定目标PostgreSQL服务器的IP地址、攻击者机器的IP地址和监听端口。
5.  **获取反向shell：** 如果利用成功，攻击者将收到来自易受攻击的PostgreSQL容器的反向shell，从而可以在服务器上执行任意命令。

**项目地址:** [PinkArmor/CVE-2025-1094-Lab-Setup](https://github.com/PinkArmor/CVE-2025-1094-Lab-Setup)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #3

**来源**: [CVE-2025-1094-aninfosec_CVE-2025-1094.md](../2025/CVE-2025-1094-aninfosec_CVE-2025-1094.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要目标应用程序使用受影响的PostgreSQL版本，并且使用libpq函数或psql命令行工具处理用户提供的、经过编码转换（BIG5到EUC_TW或MULE_INTERNAL）的输入。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1094是PostgreSQL中的一个SQL注入漏洞，影响多个版本。漏洞根源在于PostgreSQL的`PQescapeLiteral()`、`PQescapeIdentifier()`、`PQescapeString()`和`PQescapeStringConn()`等libpq函数，以及psql命令行工具在处理编码转换时，未能正确转义引号语法。如果应用程序使用这些函数的结果来构造传递给psql的输入，或者psql处理来自命令行参数的输入时，存在被SQL注入的风险。

**有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，该漏洞是有效的。搜索结果表明，Rapid7的研究人员发现了这个漏洞，并且已经有针对性的攻击发生。PoC代码通过设置`PGCLIENTENCODING`环境变量为`BIG5`，并构造恶意的SQL注入payload，利用`COPY ... TO PROGRAM`语句执行任意shell命令，从而获得反向shell。

**投毒风险：**
PoC代码分析：
* `exploit.py`脚本的目的是利用CVE-2025-1094漏洞。它通过构造特定的SQL payload，该payload包含`COPY ... TO PROGRAM`语句来执行系统命令，从而获得反向shell。
* `README.md`文件只包含CVE编号。
结论：
该仓库中**没有发现**明显的投毒代码。该脚本的目的是利用漏洞，而不是安装恶意软件或执行其他恶意行为。因此，投毒风险为0%。

**利用方式：**
1.  **环境配置：** 设置环境变量`PGCLIENTENCODING`为`BIG5`，模拟编码转换的环境。
2.  **构造Payload：** 构造包含恶意SQL代码的payload。PoC中使用了`COPY ... TO PROGRAM`语句，允许执行系统命令。
3.  **发送请求：** 将payload作为参数发送到目标应用程序，触发SQL注入。
4.  **反向Shell：** 如果利用成功，目标服务器会连接到攻击者的IP地址和端口，建立反向shell连接。

**项目地址:** [aninfosec/CVE-2025-1094](https://github.com/aninfosec/CVE-2025-1094)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #4

**来源**: [CVE-2025-1094-ishwardeepp_CVE-2025-1094-PoC-Postgre-SQLi.md](../2025/CVE-2025-1094-ishwardeepp_CVE-2025-1094-PoC-Postgre-SQLi.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 服务器编码为EUC_TW或MULE_INTERNAL，客户端编码为BIG5

**POC 可用性:** 是

**投毒风险:** 99%

## 详情

CVE-2025-1094是PostgreSQL中的一个高危SQL注入漏洞。由于`PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`和`PQescapeStringConn()`等函数在处理特定编码组合时（服务器编码为EUC_TW或MULE_INTERNAL，客户端编码为BIG5）未能正确转义引号，攻击者可以通过操纵数据库输入或命令行参数来执行任意SQL命令。

**有效性分析：**

提供的PoC代码通过利用编码不匹配，特别是`server_encoding=EUC_TW`和`client_encoding=BIG5`的组合，成功地绕过了PostgreSQL的转义机制。`exploit.py`文件发送包含恶意SQL代码的POST请求到`app.py`，该请求经过`psql`执行。`init.sql`创建了一个测试表，为SQL注入提供上下文。Docker环境的配置确保了编码环境正确。

**投毒风险分析：**

PoC代码存在极高的投毒风险。 理由如下：

1.  **任意文件读取：** PoC允许读取`/etc/passwd`文件，这表明可以读取服务器上的任何文件，包括敏感配置文件和私钥。
2.  **远程代码执行（RCE）：** 通过注入SQL，攻击者可以创建large object，读取文件，并将其导出到文件系统。这意味着，虽然PoC中示例是读取/etc/passwd，但是它可以执行任何数据库支持的操作，包括调用外部程序或库，进而实现RCE。
3.  **环境依赖：** PoC依赖于特定的编码设置，这使得在不同环境下利用的难度增加。 但如果攻击者控制了数据库的配置，则可以轻松设置正确的编码以利用该漏洞。
4.  **真实漏洞利用案例：** 搜索结果表明，此漏洞已被用于攻击BeyondTrust和美国财政部等机构，这表明真实环境中存在利用。

**漏洞利用方式：**

1.  **编码不匹配：** 利用`client_encoding`和`server_encoding`之间的差异绕过转义。
2.  **注入恶意SQL：** 通过`PQescapeLiteral()`等函数的缺陷，将恶意的SQL代码注入到`psql`命令中。
3.  **执行任意命令：**  利用SQL注入执行`pg_read_file`等函数，读取服务器上的文件，然后通过large object将内容导出到指定位置。

**总结：**

CVE-2025-1094是一个严重的安全漏洞，允许攻击者执行任意SQL命令，读取敏感文件甚至实现远程代码执行。提供的PoC代码有效，并存在极高的投毒风险。

**项目地址:** [ishwardeepp/CVE-2025-1094-PoC-Postgre-SQLi](https://github.com/ishwardeepp/CVE-2025-1094-PoC-Postgre-SQLi)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #5

**来源**: [CVE-2025-1094-shacojx_CVE-2025-1094-Exploit.md](../2025/CVE-2025-1094-shacojx_CVE-2025-1094-Exploit.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要数据库连接和特定的client/server encoding配置(BIG5, EUC_TW, MULE_INTERNAL)

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-1094 漏洞是 PostgreSQL 中由于不正确的引用语法中和导致的 SQL 注入漏洞。漏洞存在于 `PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`, 和 `PQescapeStringConn()` 等libpq函数中，以及 psql 命令行工具。\n\n**漏洞利用方式：**\n\n1.  **SQL 注入：** 攻击者通过构造恶意的 SQL 语句，利用 `lo_export` 函数读取服务器上的敏感文件，例如 `/etc/passwd`。payload首先使用 `pg_read_file`读取文件内容,然后使用`convert_from`将内容转换为UTF8编码。\n2.  **WebSocket 劫持（PoC 中的利用方式）：** 该 PoC 尝试劫持一个已建立的 WebSocket 连接，并发送恶意 payload，以执行远程代码。\n3.  **远程代码执行（RCE）：** 通过反弹 shell，攻击者可以完全控制服务器。\n\n**投毒风险分析：**\n\nPoC 代码包含一个WebSocket劫持部分，其中包含一段python反弹shell的代码，需要将`REVERSE_IP`和`REVERSE_PORT`替换为攻击者控制的地址。该部分有风险，需要使用者确认该地址为其所拥有。如果该部分地址不是poc使用者所控制的,那么相当于poc使用者主动连接了poc编写者的服务器,存在一定的风险，但是不属于典型的投毒。\n
此外，PoC 代码依赖于特定版本的 JDK (22) 和 okhttp3 库，如果构建环境与预期不符，可能导致 PoC 无法正常运行。虽然这增加了使用难度，但并不构成主动投毒行为。\n
SQL注入本身就存在一定的数据库被植入后门的风险.但是该风险是SQL注入攻击本身具有的,不能算是POC的投毒风险.综合来看，POC 代码存在一定风险，但不属于典型的投毒行为，主要是webshell劫持部分需要确认。\n\n**缓解措施：**\n\n*   在引用输入之前，确认输入通过编码验证。\n*   升级到 PostgreSQL 17.3, 16.7, 15.11, 14.16, 或 13.19 或更高版本。

**项目地址:** [shacojx/CVE-2025-1094-Exploit](https://github.com/shacojx/CVE-2025-1094-Exploit)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #6

**来源**: [CVE-2025-1094-soltanali0_CVE-2025-1094-Exploit.md](../2025/CVE-2025-1094-soltanali0_CVE-2025-1094-Exploit.md)

## CVE-2025-1094-PostgreSQL-SQL注入到RCE

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致数据泄露和远程代码执行

**影响版本:** PostgreSQL 17.3之前, 16.7之前, 15.11之前, 14.16之前, 13.19之前

**利用条件:** 需要应用程序使用受影响的`PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`, 和 `PQescapeStringConn()` 函数的结果构建输入到 `psql`，或当`client_encoding`是`BIG5`且`server_encoding`是`EUC_TW`或`MULE_INTERNAL`时，利用命令行参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1094 是一个存在于 PostgreSQL 的 SQL 注入漏洞，允许攻击者通过注入恶意 SQL 代码读取敏感文件并执行任意命令，最终实现远程代码执行。漏洞利用涉及多个阶段：

1.  **SQL 注入**：攻击者利用 `PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`, 和 `PQescapeStringConn()` 函数中的不当转义，向PostgreSQL数据库注入恶意的SQL语句。从PoC代码来看，此处的SQL注入是通过`lo_export`和`pg_read_file`函数读取`/etc/passwd`文件，并将其保存到`/tmp/payload`。

2.  **WebSocket 劫持**：攻击者劫持一个已建立的WebSocket连接，并发送恶意payload，目的是在服务器上执行任意命令。

3.  **远程代码执行 (RCE)**：通过WebSocket连接发送的payload包含反向shell代码，该代码会连接到攻击者的监听端口，从而使攻击者获得服务器的控制权。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该PoC代码在满足特定条件的情况下是有效的。条件包括：
*   PostgreSQL 版本在受影响范围内。
*   应用程序使用了易受攻击的转义函数，或者使用了不安全的命令行参数。
*   存在可被劫持的 WebSocket 连接（PoC 代码假设存在）。

**投毒风险分析：**

该PoC代码存在一定的投毒风险，风险评估为10%。主要风险点在于：

*   **依赖外部 WebSocket 连接：** 该PoC假设存在一个可劫持的WebSocket连接。如果攻击者诱导用户使用包含恶意WebSocket连接的PoC，可能导致意外行为或信息泄露。
*   **反向Shell依赖：** PoC代码通过建立反向shell获取服务器控制权，如果攻击者修改了反向shell连接的IP和端口，可能会将受害者暴露给未知的第三方。
*  **文件读写**:虽然PoC读取`/etc/passwd`是为了演示，但未经授权的文件读写行为本身就是高危的。攻击者可能会更改读取的文件，或写入恶意文件，从而引入其他安全风险。
*   **隐蔽性**：攻击者可以将恶意代码隐藏在看似无害的WebSocket消息中，增加检测的难度。

**利用方式总结：**

1.  利用SQL注入漏洞，读取服务器上的敏感文件，例如`/etc/passwd`。
2.  劫持已建立的WebSocket连接。
3.  通过WebSocket连接，发送包含反向shell的恶意payload，从而在服务器上执行任意命令，获得服务器的远程控制权限。

**项目地址:** [soltanali0/CVE-2025-1094-Exploit](https://github.com/soltanali0/CVE-2025-1094-Exploit)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---



---

## POC #2

**来源**: [CVE-2025-1094-PinkArmor_CVE-2025-1094-Lab-Setup.md](../2025/CVE-2025-1094-PinkArmor_CVE-2025-1094-Lab-Setup.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要目标PostgreSQL服务器client_encoding为BIG5, server_encoding为EUC_TW或MULE_INTERNAL, 以及目标应用使用PQescapeLiteral(), PQescapeIdentifier(), PQescapeString(), 和 PQescapeStringConn()函数且未进行充分的输入验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1094漏洞存在于PostgreSQL的libpq函数中，由于在PQescapeLiteral(), PQescapeIdentifier(), PQescapeString(), 和 PQescapeStringConn()中未正确处理编码验证失败的文本中的引号语法，导致SQL注入。

**有效性评估：**
提供的POC代码针对PostgreSQL 14.15版本，该版本在受影响的版本范围内。通过Docker部署了易受攻击的PostgreSQL实例，并提供了一个Python脚本来利用该漏洞。利用方式是注入畸形的UTF-8编码，绕过输入验证，并使用`COPY ... TO PROGRAM`执行任意shell命令，最终获得反向shell。根据描述和代码逻辑，POC代码应该是有效的。

**投毒风险分析：**
提供的代码包含两个文件：`README.md` 和 `exploit.py`。`README.md` 描述了漏洞和利用过程，其中包含免责声明。`exploit.py` 是实际的漏洞利用代码，负责连接到PostgreSQL服务器并发送恶意payload。代码主要功能是利用漏洞获取反向shell。然而，在`exploit.py`中，存在可疑的`im`，怀疑作者存在隐藏的投毒代码。因此，投毒风险评估为10%。

**利用方式：**
1.  **环境准备：** 使用Docker部署易受攻击的PostgreSQL版本（<= 14.15）。
2.  **配置目标服务器：** 设置目标PostgreSQL服务器的`client_encoding`为`BIG5`，`server_encoding`为`EUC_TW`或`MULE_INTERNAL`。
3.  **启动监听器：** 在攻击者机器上启动一个监听器（例如，使用`nc -lvnp 4444`）以接收反向shell。
4.  **运行攻击脚本：** 运行提供的Python脚本，指定目标PostgreSQL服务器的IP地址、攻击者机器的IP地址和监听端口。
5.  **获取反向shell：** 如果利用成功，攻击者将收到来自易受攻击的PostgreSQL容器的反向shell，从而可以在服务器上执行任意命令。

**项目地址:** [PinkArmor/CVE-2025-1094-Lab-Setup](https://github.com/PinkArmor/CVE-2025-1094-Lab-Setup)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #3

**来源**: [CVE-2025-1094-aninfosec_CVE-2025-1094.md](../2025/CVE-2025-1094-aninfosec_CVE-2025-1094.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要目标应用程序使用受影响的PostgreSQL版本，并且使用libpq函数或psql命令行工具处理用户提供的、经过编码转换（BIG5到EUC_TW或MULE_INTERNAL）的输入。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1094是PostgreSQL中的一个SQL注入漏洞，影响多个版本。漏洞根源在于PostgreSQL的`PQescapeLiteral()`、`PQescapeIdentifier()`、`PQescapeString()`和`PQescapeStringConn()`等libpq函数，以及psql命令行工具在处理编码转换时，未能正确转义引号语法。如果应用程序使用这些函数的结果来构造传递给psql的输入，或者psql处理来自命令行参数的输入时，存在被SQL注入的风险。

**有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，该漏洞是有效的。搜索结果表明，Rapid7的研究人员发现了这个漏洞，并且已经有针对性的攻击发生。PoC代码通过设置`PGCLIENTENCODING`环境变量为`BIG5`，并构造恶意的SQL注入payload，利用`COPY ... TO PROGRAM`语句执行任意shell命令，从而获得反向shell。

**投毒风险：**
PoC代码分析：
* `exploit.py`脚本的目的是利用CVE-2025-1094漏洞。它通过构造特定的SQL payload，该payload包含`COPY ... TO PROGRAM`语句来执行系统命令，从而获得反向shell。
* `README.md`文件只包含CVE编号。
结论：
该仓库中**没有发现**明显的投毒代码。该脚本的目的是利用漏洞，而不是安装恶意软件或执行其他恶意行为。因此，投毒风险为0%。

**利用方式：**
1.  **环境配置：** 设置环境变量`PGCLIENTENCODING`为`BIG5`，模拟编码转换的环境。
2.  **构造Payload：** 构造包含恶意SQL代码的payload。PoC中使用了`COPY ... TO PROGRAM`语句，允许执行系统命令。
3.  **发送请求：** 将payload作为参数发送到目标应用程序，触发SQL注入。
4.  **反向Shell：** 如果利用成功，目标服务器会连接到攻击者的IP地址和端口，建立反向shell连接。

**项目地址:** [aninfosec/CVE-2025-1094](https://github.com/aninfosec/CVE-2025-1094)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #4

**来源**: [CVE-2025-1094-ishwardeepp_CVE-2025-1094-PoC-Postgre-SQLi.md](../2025/CVE-2025-1094-ishwardeepp_CVE-2025-1094-PoC-Postgre-SQLi.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 服务器编码为EUC_TW或MULE_INTERNAL，客户端编码为BIG5

**POC 可用性:** 是

**投毒风险:** 99%

## 详情

CVE-2025-1094是PostgreSQL中的一个高危SQL注入漏洞。由于`PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`和`PQescapeStringConn()`等函数在处理特定编码组合时（服务器编码为EUC_TW或MULE_INTERNAL，客户端编码为BIG5）未能正确转义引号，攻击者可以通过操纵数据库输入或命令行参数来执行任意SQL命令。

**有效性分析：**

提供的PoC代码通过利用编码不匹配，特别是`server_encoding=EUC_TW`和`client_encoding=BIG5`的组合，成功地绕过了PostgreSQL的转义机制。`exploit.py`文件发送包含恶意SQL代码的POST请求到`app.py`，该请求经过`psql`执行。`init.sql`创建了一个测试表，为SQL注入提供上下文。Docker环境的配置确保了编码环境正确。

**投毒风险分析：**

PoC代码存在极高的投毒风险。 理由如下：

1.  **任意文件读取：** PoC允许读取`/etc/passwd`文件，这表明可以读取服务器上的任何文件，包括敏感配置文件和私钥。
2.  **远程代码执行（RCE）：** 通过注入SQL，攻击者可以创建large object，读取文件，并将其导出到文件系统。这意味着，虽然PoC中示例是读取/etc/passwd，但是它可以执行任何数据库支持的操作，包括调用外部程序或库，进而实现RCE。
3.  **环境依赖：** PoC依赖于特定的编码设置，这使得在不同环境下利用的难度增加。 但如果攻击者控制了数据库的配置，则可以轻松设置正确的编码以利用该漏洞。
4.  **真实漏洞利用案例：** 搜索结果表明，此漏洞已被用于攻击BeyondTrust和美国财政部等机构，这表明真实环境中存在利用。

**漏洞利用方式：**

1.  **编码不匹配：** 利用`client_encoding`和`server_encoding`之间的差异绕过转义。
2.  **注入恶意SQL：** 通过`PQescapeLiteral()`等函数的缺陷，将恶意的SQL代码注入到`psql`命令中。
3.  **执行任意命令：**  利用SQL注入执行`pg_read_file`等函数，读取服务器上的文件，然后通过large object将内容导出到指定位置。

**总结：**

CVE-2025-1094是一个严重的安全漏洞，允许攻击者执行任意SQL命令，读取敏感文件甚至实现远程代码执行。提供的PoC代码有效，并存在极高的投毒风险。

**项目地址:** [ishwardeepp/CVE-2025-1094-PoC-Postgre-SQLi](https://github.com/ishwardeepp/CVE-2025-1094-PoC-Postgre-SQLi)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #5

**来源**: [CVE-2025-1094-shacojx_CVE-2025-1094-Exploit.md](../2025/CVE-2025-1094-shacojx_CVE-2025-1094-Exploit.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要数据库连接和特定的client/server encoding配置(BIG5, EUC_TW, MULE_INTERNAL)

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-1094 漏洞是 PostgreSQL 中由于不正确的引用语法中和导致的 SQL 注入漏洞。漏洞存在于 `PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`, 和 `PQescapeStringConn()` 等libpq函数中，以及 psql 命令行工具。\n\n**漏洞利用方式：**\n\n1.  **SQL 注入：** 攻击者通过构造恶意的 SQL 语句，利用 `lo_export` 函数读取服务器上的敏感文件，例如 `/etc/passwd`。payload首先使用 `pg_read_file`读取文件内容,然后使用`convert_from`将内容转换为UTF8编码。\n2.  **WebSocket 劫持（PoC 中的利用方式）：** 该 PoC 尝试劫持一个已建立的 WebSocket 连接，并发送恶意 payload，以执行远程代码。\n3.  **远程代码执行（RCE）：** 通过反弹 shell，攻击者可以完全控制服务器。\n\n**投毒风险分析：**\n\nPoC 代码包含一个WebSocket劫持部分，其中包含一段python反弹shell的代码，需要将`REVERSE_IP`和`REVERSE_PORT`替换为攻击者控制的地址。该部分有风险，需要使用者确认该地址为其所拥有。如果该部分地址不是poc使用者所控制的,那么相当于poc使用者主动连接了poc编写者的服务器,存在一定的风险，但是不属于典型的投毒。\n
此外，PoC 代码依赖于特定版本的 JDK (22) 和 okhttp3 库，如果构建环境与预期不符，可能导致 PoC 无法正常运行。虽然这增加了使用难度，但并不构成主动投毒行为。\n
SQL注入本身就存在一定的数据库被植入后门的风险.但是该风险是SQL注入攻击本身具有的,不能算是POC的投毒风险.综合来看，POC 代码存在一定风险，但不属于典型的投毒行为，主要是webshell劫持部分需要确认。\n\n**缓解措施：**\n\n*   在引用输入之前，确认输入通过编码验证。\n*   升级到 PostgreSQL 17.3, 16.7, 15.11, 14.16, 或 13.19 或更高版本。

**项目地址:** [shacojx/CVE-2025-1094-Exploit](https://github.com/shacojx/CVE-2025-1094-Exploit)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #6

**来源**: [CVE-2025-1094-soltanali0_CVE-2025-1094-Exploit.md](../2025/CVE-2025-1094-soltanali0_CVE-2025-1094-Exploit.md)

## CVE-2025-1094-PostgreSQL-SQL注入到RCE

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致数据泄露和远程代码执行

**影响版本:** PostgreSQL 17.3之前, 16.7之前, 15.11之前, 14.16之前, 13.19之前

**利用条件:** 需要应用程序使用受影响的`PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`, 和 `PQescapeStringConn()` 函数的结果构建输入到 `psql`，或当`client_encoding`是`BIG5`且`server_encoding`是`EUC_TW`或`MULE_INTERNAL`时，利用命令行参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1094 是一个存在于 PostgreSQL 的 SQL 注入漏洞，允许攻击者通过注入恶意 SQL 代码读取敏感文件并执行任意命令，最终实现远程代码执行。漏洞利用涉及多个阶段：

1.  **SQL 注入**：攻击者利用 `PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`, 和 `PQescapeStringConn()` 函数中的不当转义，向PostgreSQL数据库注入恶意的SQL语句。从PoC代码来看，此处的SQL注入是通过`lo_export`和`pg_read_file`函数读取`/etc/passwd`文件，并将其保存到`/tmp/payload`。

2.  **WebSocket 劫持**：攻击者劫持一个已建立的WebSocket连接，并发送恶意payload，目的是在服务器上执行任意命令。

3.  **远程代码执行 (RCE)**：通过WebSocket连接发送的payload包含反向shell代码，该代码会连接到攻击者的监听端口，从而使攻击者获得服务器的控制权。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该PoC代码在满足特定条件的情况下是有效的。条件包括：
*   PostgreSQL 版本在受影响范围内。
*   应用程序使用了易受攻击的转义函数，或者使用了不安全的命令行参数。
*   存在可被劫持的 WebSocket 连接（PoC 代码假设存在）。

**投毒风险分析：**

该PoC代码存在一定的投毒风险，风险评估为10%。主要风险点在于：

*   **依赖外部 WebSocket 连接：** 该PoC假设存在一个可劫持的WebSocket连接。如果攻击者诱导用户使用包含恶意WebSocket连接的PoC，可能导致意外行为或信息泄露。
*   **反向Shell依赖：** PoC代码通过建立反向shell获取服务器控制权，如果攻击者修改了反向shell连接的IP和端口，可能会将受害者暴露给未知的第三方。
*  **文件读写**:虽然PoC读取`/etc/passwd`是为了演示，但未经授权的文件读写行为本身就是高危的。攻击者可能会更改读取的文件，或写入恶意文件，从而引入其他安全风险。
*   **隐蔽性**：攻击者可以将恶意代码隐藏在看似无害的WebSocket消息中，增加检测的难度。

**利用方式总结：**

1.  利用SQL注入漏洞，读取服务器上的敏感文件，例如`/etc/passwd`。
2.  劫持已建立的WebSocket连接。
3.  通过WebSocket连接，发送包含反向shell的恶意payload，从而在服务器上执行任意命令，获得服务器的远程控制权限。

**项目地址:** [soltanali0/CVE-2025-1094-Exploit](https://github.com/soltanali0/CVE-2025-1094-Exploit)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---



---

## POC #2

**来源**: [CVE-2025-1094-PinkArmor_CVE-2025-1094-Lab-Setup.md](../2025/CVE-2025-1094-PinkArmor_CVE-2025-1094-Lab-Setup.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要目标PostgreSQL服务器client_encoding为BIG5, server_encoding为EUC_TW或MULE_INTERNAL, 以及目标应用使用PQescapeLiteral(), PQescapeIdentifier(), PQescapeString(), 和 PQescapeStringConn()函数且未进行充分的输入验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1094漏洞存在于PostgreSQL的libpq函数中，由于在PQescapeLiteral(), PQescapeIdentifier(), PQescapeString(), 和 PQescapeStringConn()中未正确处理编码验证失败的文本中的引号语法，导致SQL注入。

**有效性评估：**
提供的POC代码针对PostgreSQL 14.15版本，该版本在受影响的版本范围内。通过Docker部署了易受攻击的PostgreSQL实例，并提供了一个Python脚本来利用该漏洞。利用方式是注入畸形的UTF-8编码，绕过输入验证，并使用`COPY ... TO PROGRAM`执行任意shell命令，最终获得反向shell。根据描述和代码逻辑，POC代码应该是有效的。

**投毒风险分析：**
提供的代码包含两个文件：`README.md` 和 `exploit.py`。`README.md` 描述了漏洞和利用过程，其中包含免责声明。`exploit.py` 是实际的漏洞利用代码，负责连接到PostgreSQL服务器并发送恶意payload。代码主要功能是利用漏洞获取反向shell。然而，在`exploit.py`中，存在可疑的`im`，怀疑作者存在隐藏的投毒代码。因此，投毒风险评估为10%。

**利用方式：**
1.  **环境准备：** 使用Docker部署易受攻击的PostgreSQL版本（<= 14.15）。
2.  **配置目标服务器：** 设置目标PostgreSQL服务器的`client_encoding`为`BIG5`，`server_encoding`为`EUC_TW`或`MULE_INTERNAL`。
3.  **启动监听器：** 在攻击者机器上启动一个监听器（例如，使用`nc -lvnp 4444`）以接收反向shell。
4.  **运行攻击脚本：** 运行提供的Python脚本，指定目标PostgreSQL服务器的IP地址、攻击者机器的IP地址和监听端口。
5.  **获取反向shell：** 如果利用成功，攻击者将收到来自易受攻击的PostgreSQL容器的反向shell，从而可以在服务器上执行任意命令。

**项目地址:** [PinkArmor/CVE-2025-1094-Lab-Setup](https://github.com/PinkArmor/CVE-2025-1094-Lab-Setup)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #3

**来源**: [CVE-2025-1094-aninfosec_CVE-2025-1094.md](../2025/CVE-2025-1094-aninfosec_CVE-2025-1094.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要目标应用程序使用受影响的PostgreSQL版本，并且使用libpq函数或psql命令行工具处理用户提供的、经过编码转换（BIG5到EUC_TW或MULE_INTERNAL）的输入。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1094是PostgreSQL中的一个SQL注入漏洞，影响多个版本。漏洞根源在于PostgreSQL的`PQescapeLiteral()`、`PQescapeIdentifier()`、`PQescapeString()`和`PQescapeStringConn()`等libpq函数，以及psql命令行工具在处理编码转换时，未能正确转义引号语法。如果应用程序使用这些函数的结果来构造传递给psql的输入，或者psql处理来自命令行参数的输入时，存在被SQL注入的风险。

**有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，该漏洞是有效的。搜索结果表明，Rapid7的研究人员发现了这个漏洞，并且已经有针对性的攻击发生。PoC代码通过设置`PGCLIENTENCODING`环境变量为`BIG5`，并构造恶意的SQL注入payload，利用`COPY ... TO PROGRAM`语句执行任意shell命令，从而获得反向shell。

**投毒风险：**
PoC代码分析：
* `exploit.py`脚本的目的是利用CVE-2025-1094漏洞。它通过构造特定的SQL payload，该payload包含`COPY ... TO PROGRAM`语句来执行系统命令，从而获得反向shell。
* `README.md`文件只包含CVE编号。
结论：
该仓库中**没有发现**明显的投毒代码。该脚本的目的是利用漏洞，而不是安装恶意软件或执行其他恶意行为。因此，投毒风险为0%。

**利用方式：**
1.  **环境配置：** 设置环境变量`PGCLIENTENCODING`为`BIG5`，模拟编码转换的环境。
2.  **构造Payload：** 构造包含恶意SQL代码的payload。PoC中使用了`COPY ... TO PROGRAM`语句，允许执行系统命令。
3.  **发送请求：** 将payload作为参数发送到目标应用程序，触发SQL注入。
4.  **反向Shell：** 如果利用成功，目标服务器会连接到攻击者的IP地址和端口，建立反向shell连接。

**项目地址:** [aninfosec/CVE-2025-1094](https://github.com/aninfosec/CVE-2025-1094)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #4

**来源**: [CVE-2025-1094-ishwardeepp_CVE-2025-1094-PoC-Postgre-SQLi.md](../2025/CVE-2025-1094-ishwardeepp_CVE-2025-1094-PoC-Postgre-SQLi.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 服务器编码为EUC_TW或MULE_INTERNAL，客户端编码为BIG5

**POC 可用性:** 是

**投毒风险:** 99%

## 详情

CVE-2025-1094是PostgreSQL中的一个高危SQL注入漏洞。由于`PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`和`PQescapeStringConn()`等函数在处理特定编码组合时（服务器编码为EUC_TW或MULE_INTERNAL，客户端编码为BIG5）未能正确转义引号，攻击者可以通过操纵数据库输入或命令行参数来执行任意SQL命令。

**有效性分析：**

提供的PoC代码通过利用编码不匹配，特别是`server_encoding=EUC_TW`和`client_encoding=BIG5`的组合，成功地绕过了PostgreSQL的转义机制。`exploit.py`文件发送包含恶意SQL代码的POST请求到`app.py`，该请求经过`psql`执行。`init.sql`创建了一个测试表，为SQL注入提供上下文。Docker环境的配置确保了编码环境正确。

**投毒风险分析：**

PoC代码存在极高的投毒风险。 理由如下：

1.  **任意文件读取：** PoC允许读取`/etc/passwd`文件，这表明可以读取服务器上的任何文件，包括敏感配置文件和私钥。
2.  **远程代码执行（RCE）：** 通过注入SQL，攻击者可以创建large object，读取文件，并将其导出到文件系统。这意味着，虽然PoC中示例是读取/etc/passwd，但是它可以执行任何数据库支持的操作，包括调用外部程序或库，进而实现RCE。
3.  **环境依赖：** PoC依赖于特定的编码设置，这使得在不同环境下利用的难度增加。 但如果攻击者控制了数据库的配置，则可以轻松设置正确的编码以利用该漏洞。
4.  **真实漏洞利用案例：** 搜索结果表明，此漏洞已被用于攻击BeyondTrust和美国财政部等机构，这表明真实环境中存在利用。

**漏洞利用方式：**

1.  **编码不匹配：** 利用`client_encoding`和`server_encoding`之间的差异绕过转义。
2.  **注入恶意SQL：** 通过`PQescapeLiteral()`等函数的缺陷，将恶意的SQL代码注入到`psql`命令中。
3.  **执行任意命令：**  利用SQL注入执行`pg_read_file`等函数，读取服务器上的文件，然后通过large object将内容导出到指定位置。

**总结：**

CVE-2025-1094是一个严重的安全漏洞，允许攻击者执行任意SQL命令，读取敏感文件甚至实现远程代码执行。提供的PoC代码有效，并存在极高的投毒风险。

**项目地址:** [ishwardeepp/CVE-2025-1094-PoC-Postgre-SQLi](https://github.com/ishwardeepp/CVE-2025-1094-PoC-Postgre-SQLi)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #5

**来源**: [CVE-2025-1094-shacojx_CVE-2025-1094-Exploit.md](../2025/CVE-2025-1094-shacojx_CVE-2025-1094-Exploit.md)

## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要数据库连接和特定的client/server encoding配置(BIG5, EUC_TW, MULE_INTERNAL)

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-1094 漏洞是 PostgreSQL 中由于不正确的引用语法中和导致的 SQL 注入漏洞。漏洞存在于 `PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`, 和 `PQescapeStringConn()` 等libpq函数中，以及 psql 命令行工具。\n\n**漏洞利用方式：**\n\n1.  **SQL 注入：** 攻击者通过构造恶意的 SQL 语句，利用 `lo_export` 函数读取服务器上的敏感文件，例如 `/etc/passwd`。payload首先使用 `pg_read_file`读取文件内容,然后使用`convert_from`将内容转换为UTF8编码。\n2.  **WebSocket 劫持（PoC 中的利用方式）：** 该 PoC 尝试劫持一个已建立的 WebSocket 连接，并发送恶意 payload，以执行远程代码。\n3.  **远程代码执行（RCE）：** 通过反弹 shell，攻击者可以完全控制服务器。\n\n**投毒风险分析：**\n\nPoC 代码包含一个WebSocket劫持部分，其中包含一段python反弹shell的代码，需要将`REVERSE_IP`和`REVERSE_PORT`替换为攻击者控制的地址。该部分有风险，需要使用者确认该地址为其所拥有。如果该部分地址不是poc使用者所控制的,那么相当于poc使用者主动连接了poc编写者的服务器,存在一定的风险，但是不属于典型的投毒。\n
此外，PoC 代码依赖于特定版本的 JDK (22) 和 okhttp3 库，如果构建环境与预期不符，可能导致 PoC 无法正常运行。虽然这增加了使用难度，但并不构成主动投毒行为。\n
SQL注入本身就存在一定的数据库被植入后门的风险.但是该风险是SQL注入攻击本身具有的,不能算是POC的投毒风险.综合来看，POC 代码存在一定风险，但不属于典型的投毒行为，主要是webshell劫持部分需要确认。\n\n**缓解措施：**\n\n*   在引用输入之前，确认输入通过编码验证。\n*   升级到 PostgreSQL 17.3, 16.7, 15.11, 14.16, 或 13.19 或更高版本。

**项目地址:** [shacojx/CVE-2025-1094-Exploit](https://github.com/shacojx/CVE-2025-1094-Exploit)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

## POC #6

**来源**: [CVE-2025-1094-soltanali0_CVE-2025-1094-Exploit.md](../2025/CVE-2025-1094-soltanali0_CVE-2025-1094-Exploit.md)

## CVE-2025-1094-PostgreSQL-SQL注入到RCE

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致数据泄露和远程代码执行

**影响版本:** PostgreSQL 17.3之前, 16.7之前, 15.11之前, 14.16之前, 13.19之前

**利用条件:** 需要应用程序使用受影响的`PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`, 和 `PQescapeStringConn()` 函数的结果构建输入到 `psql`，或当`client_encoding`是`BIG5`且`server_encoding`是`EUC_TW`或`MULE_INTERNAL`时，利用命令行参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1094 是一个存在于 PostgreSQL 的 SQL 注入漏洞，允许攻击者通过注入恶意 SQL 代码读取敏感文件并执行任意命令，最终实现远程代码执行。漏洞利用涉及多个阶段：

1.  **SQL 注入**：攻击者利用 `PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`, 和 `PQescapeStringConn()` 函数中的不当转义，向PostgreSQL数据库注入恶意的SQL语句。从PoC代码来看，此处的SQL注入是通过`lo_export`和`pg_read_file`函数读取`/etc/passwd`文件，并将其保存到`/tmp/payload`。

2.  **WebSocket 劫持**：攻击者劫持一个已建立的WebSocket连接，并发送恶意payload，目的是在服务器上执行任意命令。

3.  **远程代码执行 (RCE)**：通过WebSocket连接发送的payload包含反向shell代码，该代码会连接到攻击者的监听端口，从而使攻击者获得服务器的控制权。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该PoC代码在满足特定条件的情况下是有效的。条件包括：
*   PostgreSQL 版本在受影响范围内。
*   应用程序使用了易受攻击的转义函数，或者使用了不安全的命令行参数。
*   存在可被劫持的 WebSocket 连接（PoC 代码假设存在）。

**投毒风险分析：**

该PoC代码存在一定的投毒风险，风险评估为10%。主要风险点在于：

*   **依赖外部 WebSocket 连接：** 该PoC假设存在一个可劫持的WebSocket连接。如果攻击者诱导用户使用包含恶意WebSocket连接的PoC，可能导致意外行为或信息泄露。
*   **反向Shell依赖：** PoC代码通过建立反向shell获取服务器控制权，如果攻击者修改了反向shell连接的IP和端口，可能会将受害者暴露给未知的第三方。
*  **文件读写**:虽然PoC读取`/etc/passwd`是为了演示，但未经授权的文件读写行为本身就是高危的。攻击者可能会更改读取的文件，或写入恶意文件，从而引入其他安全风险。
*   **隐蔽性**：攻击者可以将恶意代码隐藏在看似无害的WebSocket消息中，增加检测的难度。

**利用方式总结：**

1.  利用SQL注入漏洞，读取服务器上的敏感文件，例如`/etc/passwd`。
2.  劫持已建立的WebSocket连接。
3.  通过WebSocket连接，发送包含反向shell的恶意payload，从而在服务器上执行任意命令，获得服务器的远程控制权限。

**项目地址:** [soltanali0/CVE-2025-1094-Exploit](https://github.com/soltanali0/CVE-2025-1094-Exploit)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)

---

