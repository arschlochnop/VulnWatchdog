## CVE-2025-55182 - React Server Components RCE

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE

**影响应用:** React Server Components

**危害等级:** Critical

**CVSS评分:** N/A

**影响版本:** 19.0.0, 19.1.0, 19.1.1, 19.2.0

**利用条件:** Unauthenticated, remote access to React Server Function endpoint

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 30%

## 详情

CVE-2025-55182 是 React Server Components (RSC) 中的一个严重的未经验证的远程代码执行漏洞。该漏洞影响 React Server Components 的 19.0.0、19.1.0、19.1.1 和 19.2.0 版本，包括 react-server-dom-parcel、react-server-dom-turbopack 和 react-server-dom-webpack 包。未经身份验证的远程攻击者可以通过向易受攻击的 React Server Function 端点发送特制 payload 来利用此漏洞。根据Rapid7的报告，这是一个影响构建现代 Web 应用程序的非常流行的库 React 的关键未经验证的远程代码执行漏洞。通过分析提供的POC代码，该工具包旨在检测和缓解AWS环境中此漏洞的影响。核心检测机制依赖于将恶意IP地址添加到GuardDuty威胁情报集中，并通过EventBridge规则触发警报。检测脚本能够扫描CloudTrail、VPC流日志和WAF日志以识别潜在的攻击尝试。为了验证POC的有效性，我们可以使用提供的Python脚本`src/react2shell_detector.py`进行测试。首先需要安装依赖项`pip install -r requirements.txt`。然后，可以使用不同的参数运行脚本，例如`python src/react2shell_detector.py --hours 24`进行基本扫描，或者使用更复杂的命令，例如`python src/react2shell_detector.py --organization --role-name SecurityAuditRole --security-hub --guardduty-bucket my-threat-intel-bucket --vpc-log-group /aws/vpc/flowlogs --waf-log-group aws-waf-logs-react2shell --sns-topic arn:aws:sns:us-east-1:123456789012:alerts --output json --output-file findings.json`进行组织范围的扫描，并与其他AWS服务集成。此外，提供的Terraform脚本可用于自动化基础设施的部署。利用步骤概述如下：
1. 准备环境：设置React Server Components应用程序并确保版本在受影响范围内。
2. 部署检测工具：配置GuardDuty ThreatIntelSet和EventBridge规则。
3. 发送恶意请求：构造并发送包含恶意payload的请求到React Server Function端点。
4. 监控和响应：观察GuardDuty是否检测到恶意活动，并通过配置的SNS主题接收警报。
5. 修复漏洞：升级React Server Components到修复版本。

投毒风险分析：
该POC主要通过IP地址匹配和日志分析进行检测，因此投毒风险相对较低。尽管如此，仍存在一些潜在的风险：
1. 恶意IP列表污染：攻击者可能尝试将良性IP地址添加到威胁情报集中，导致误报。
2. 日志欺骗：攻击者可能尝试伪造或篡改日志，以逃避检测。
3. 代码注入：虽然POC代码本身看起来相对干净，但如果攻击者能够修改`react2shell_detector.py`脚本或相关的配置文件（如`config/iocs.yaml`），他们可能会引入恶意代码。由于`react2shell_detector.py`脚本中使用了`pip install -r requirements.txt`安装依赖，攻击者可能会通过篡改requirements.txt文件来引入恶意依赖包，实现供应链投毒。此外，脚本中使用的IOC数据库`config/iocs.yaml`也可能被篡改以引入恶意IP地址或域名，从而导致误报或漏报。最后，脚本支持从多个AWS服务（如CloudTrail、VPC流日志、WAF日志）收集数据，如果攻击者能够控制这些服务的数据源，他们可能会注入恶意数据以逃避检测。

**项目地址:** N/A

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
