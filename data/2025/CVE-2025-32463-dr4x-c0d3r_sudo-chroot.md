## CVE-2025-32463 - Sudo 本地权限提升 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** 1.9.14 至 1.9.17

**利用条件:** 具有本地普通用户访问权限，且系统安装有受影响版本的Sudo

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：该漏洞源于Sudo在实现--chroot（-R参数）选项时存在逻辑缺陷。漏洞的核心在于，当用户指定一个受控目录作为chroot环境时，Sudo在切换root权限后，会尝试根据该受控目录下的/etc/nsswitch.conf配置加载名称服务交换（NSS）模块。由于NSS模块本质上是动态链接库（.so文件），攻击者可以在其控制的目录下伪造配置文件和恶意的共享库文件。POC代码展示了这一完整逻辑：首先创建一个临时目录，构造伪造的etc/nsswitch.conf，并将其中的passwd查询指向一个自定义的库。接着，编写一段C代码，利用__attribute__((constructor))属性定义构造函数，在库加载时立即执行setreuid(0,0)和exec启动shell。POC使用gcc编译该代码为共享库，并放置在预定路径下。最后，执行sudo -R指向该目录。实验证明，该POC利用方式直接且高效，能够稳定地绕过chroot限制并在宿主机上获取真正的root Shell，具有极高的实战价值和威胁性。利用步骤：1. 创建一个用户可写的临时目录作为伪造的根环境。2. 在该目录下建立etc结构，并写入恶意的nsswitch.conf文件。3. 编写C语言利用代码，实现提权并执行/bin/bash。4. 使用gcc将C代码编译为符合NSS命名规范的动态链接库。5. 执行带有-R参数的sudo命令，指向该临时目录，触发恶意库的加载。投毒风险分析：经过对提供的Python利用脚本进行静态代码分析，其风险处于低位。脚本逻辑清晰，使用了标准的Python库（os, subprocess, shutil, tempfile），未发现任何经过混淆的代码块或Base64编码的隐藏指令。脚本中的恶意逻辑（C代码部分）明确指向了提权验证，即通过setreuid/setregid获取root权限并启动bash，这是典型的LPE利用载荷，不属于针对研究员主机的后门行为。脚本操作的路径均位于/tmp目录下，且在退出时包含清理逻辑（shutil.rmtree），表现出良好的开发规范。虽然在执行过程中调用了gcc编译，这在安全研究脚本中是常见操作，但用户在使用时仍需注意编译参数是否被篡改。整体而言，该POC代码未尝试向外部IP发起非预期的连接，也未尝试持久化注入到用户的家目录或系统敏感配置中，投毒风险较低，主要风险在于其强大的提权功能本身。建议在隔离的沙箱环境中进行验证，以防利用成功后对实验机器造成意外的系统状态修改。

**项目地址:** [https://github.com/user-attachments/assets/666442e5-7ae5-485d-9dff-2667aa8efb7e](https://www.google.com/search?q=https://github.com/user-attachments/assets/666442e5-7ae5-485d-9dff-2667aa8efb7e)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-32463](https://avd.aliyun.com/detail?id=AVD-2025-32463)
