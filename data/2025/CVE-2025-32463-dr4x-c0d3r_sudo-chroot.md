## CVE-2025-32463 - Sudo 本地权限提升 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** Sudo

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 1.9.14 <= Sudo < 1.9.17p1

**利用条件:** 本地低权限用户访问权限，且目标系统安装了受影响版本的 Sudo

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

【POC有效性分析】该POC代码是一个高度精简且有效的本地权限提升利用脚本。其核心逻辑在于利用 Sudo 在执行带有 --chroot (-R) 选项的任务时，对环境初始化的不安全实现。具体而言，当使用 -R 选项指定 chroot 目录时，Sudo 在某些版本（1.9.14至1.9.17p1）中会尝试在 chroot 后的环境中加载 NSS（Name Service Switch）配置。POC 通过以下步骤验证有效性：首先，它创建一个临时目录并模拟根目录结构，特别是在其中伪造了 /etc/nsswitch.conf 文件。该伪造文件将 passwd 数据库的查询重定向到一个攻击者可控的库名 'woot1337'。接着，脚本编写并编译了一个带有 __attribute__((constructor)) 属性的 C 语言共享库。这个构造函数会在库被加载时立即执行，调用 setreuid(0,0) 和 setregid(0,0) 来获取 root 权限，并启动一个交互式的 /bin/bash。最后，通过调用 'sudo -R woot woot'，触发 Sudo 进入受控目录并加载恶意的 libnss_woot1337.so.2 库，从而实现提权。该 POC 逻辑严密，直接针对漏洞成因，在受影响系统上具有极高的成功率。利用步骤如下：1. 创建包含伪造 /etc/nsswitch.conf 的临时 chroot 环境；2. 编译恶意共享库并放置在 Sudo 搜索路径内；3. 执行带有 -R 参数的 Sudo 命令触发库加载；4. 获取 root Shell。【投毒风险分析】该 POC 的投毒风险被评估为低（10%）。代码本身透明度高，使用标准的 Python 和 C 语言编写，未进行任何代码混淆或加壳处理。所有操作（如创建临时目录、写入文件、调用 gcc 编译）均为合法的渗透测试和漏洞验证行为。脚本中的关键动作——提权后的 shell 启动——是攻击者手动验证成功的标准方式，不包含任何自动化的远程回连（Reverse Shell）、敏感数据外传（如打包 /etc/shadow）或持久化后门植入逻辑。代码逻辑完全局限在本地临时目录（/tmp/sudowoot.stage.*）中，且在运行结束或发生异常时会尝试清理临时文件（shutil.rmtree），表现出良好的脚本编写习惯。虽然 POC 具备完整的提权功能，但其目的是为了防御性研究和漏洞复现，并未发现任何隐藏的恶意负载或针对安全研究员主机的破坏性指令。使用者在使用时仅需关注编译环境（gcc）的安全性和运行权限即可。

**项目地址:** [https://www.freebuf.com/articles/vuls/437488.html](https://www.freebuf.com/articles/vuls/437488.html)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
