## CVE-2025-49144 - WinRAR / Windows 系统组件 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-49144

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR / Windows 系统组件

**危害等级:** 高危

**CVSS评分:** 9.8 (预测值)

**影响版本:** WinRAR < 7.13 及其相关路径处理组件

**利用条件:** 用户下载并打开恶意构造的压缩文件，或者在特定环境下触发路径解析逻辑

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 45%

## 详情

【POC有效性分析】该POC代码是一个典型的漏洞利用生成器。从技术实现上看，它通过调用msfvenom生成针对Windows x64架构的交互式反弹Shell（shell_reverse_tcp）。POC的核心逻辑是将生成的Shellcode进行XOR异或加密处理，以绕过基础的静态特征检测。随后，它动态生成一个C语言源文件（regsvr32.c），该文件包含了远程进程注入的实现代码。利用流程采用了典型的‘镂空注入’或‘远程线程注入’技术：通过CreateProcess启动挂起的notepad.exe进程，利用VirtualAllocEx在目标进程中分配内存，使用WriteProcessMemory写入加密后的Shellcode，并通过CreateRemoteThread触发执行。最后，脚本调用mingw-w64交叉编译器将C代码编译成EXE可执行文件。此POC并非直接触发某个特定软件溢出的Payload，而是一个用于构建后续阶段利用载荷（Payload Delivery）的自动化工具。由于它集成了Shellcode生成、加密、注入代码生成和自动化编译，其实战化程度较高，能够帮助安全研究员复现受害者在打开恶意文件后触发的后渗透行为，验证防护系统对进程注入和异常行为的检测能力。【利用步骤】1. 配置LHOST和LPORT参数；2. 脚本自动调用msfvenom生成原始Shellcode；3. 脚本执行XOR加密并生成包含注入逻辑的regsvr32.c源代码；4. 脚本调用交叉编译器生成regsvr32.exe；5. 将生成的载荷配合WinRAR等路径遍历漏洞（如搜索结果中提到的CVE-2025-8088）进行封装分发。【投毒风险分析】该POC存在明显的中等投毒风险。首先，脚本依赖subprocess调用外部命令（msfvenom, x86_64-w64-mingw32-gcc），如果攻击者修改了这些环境变量或在本地环境中预置了恶意编译器，执行该脚本会导致本地环境被污染。其次，脚本生成的代码包含高度隐蔽的异或解密和内存注入代码，这在安全审计中往往被视为恶意样本的特征。虽然代码中目前没有发现明显的反向针对研究员主机的‘第二层载荷’（即在生成过程中偷偷感染研究员电脑），但其自动化编译和混淆逻辑（如-fno-ident, -mwindows, -s参数）完全是为了躲避EDR/AV检测而设计的。如果此脚本从非官方渠道获得，攻击者极易在生成代码的逻辑中插入额外的后门（例如在C代码模板中多加一行网络请求），而研究员往往只关注生成的EXE是否有效，从而忽略了脚本本身的安全性。此外，脚本操作了系统临时目录和底层文件写入，具备一定的持久化潜力和权限敏感操作。由于其具备高度的武器化属性，建议在完全隔离的沙箱环境中使用，严禁在生产环境或连接外网的敏感办公机上直接运行该生成脚本。

**项目地址:** 本地分析路径: /tmp/vulnwatchdog_a249c1cdb43f7b7eb24f4f2f2e733241/CVE-2025-49144.py

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49144](https://nvd.nist.gov/vuln/detail/CVE-2025-49144)
