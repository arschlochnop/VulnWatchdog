## CVE-2025-59532 - OpenAI Codex CLI 沙箱绕过/目录遍历/任意文件写入

**漏洞编号:** CVE-2025-59532

**漏洞类型:** 沙箱绕过/目录遍历/任意文件写入

**影响应用:** OpenAI Codex CLI

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (High)

**影响版本:** 0.2.0 至 0.38.0

**利用条件:** 攻击者需能够诱导或影响Codex CLI生成或处理特定的工作目录(cwd)路径，通常通过恶意Prompt或构造的工程环境实现。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

【POC有效性分析】该POC通过提供一个高度工程化的Docker研究环境，展示了CVE-2025-59532的触发逻辑。漏洞核心在于Codex CLI在配置其Landlock沙箱逻辑时存在缺陷。在受影响的版本（0.2.0-0.38.0）中，程序逻辑错误地将模型生成的当前工作目录（cwd）视作沙箱的可写根目录，而非限定在用户启动会话时的初始文件夹内。这意味着如果LLM生成的代码或其执行环境涉及外部路径，Codex CLI会绕过预设的workspace边界，赋予程序在宿主机（或容器）内任意路径的写权限。POC代码非常完整，通过Dockerfile自动化构建了易受攻击版本（v0.38.0）和已修复版本（v0.39.0/v0.50.0）的对比环境，并配置了Linux内核的Landlock沙箱支持，证明了漏洞在真实沙箱环境下的可复现性。利用步骤包括：1. 启动Docker环境；2. 在/workspace/child目录下启动漏洞版本；3. 注入能够操纵cwd的指令，使Codex CLI将沙箱根重定向至/etc或/usr等敏感目录；4. 执行写操作覆盖关键系统文件。【投毒风险分析】该POC项目的投毒风险较低（10%）。代码主要由Dockerfile、Rust构建脚本和Shell辅助脚本组成，透明度极高。分析其Dockerfile可见，所有组件均从OpenAI官方GitHub仓库（[https://github.com/openai/codex.git](https://github.com/openai/codex.git)）拉取，并使用了特定的git checkout命令定位版本，无私有服务器下载行为。虽然脚本中包含对内核参数（landlock.syscall）的修改和容器权限的调整（chmod 777），但这些均属于为了复现安全防御漏洞而进行的标准环境配置。项目中未发现混淆代码、Base64加密的恶意PayLoad或未经授权的反弹Shell行为。其主要用途是卡内基梅隆大学（CMU）2025秋季课程18-739的教学研究。防御者应注意，此类POC虽本身安全，但其展示的利用手法可被集成到恶意Prompt注入攻击中，用于针对开发者工作站的供应链攻击。

**项目地址:** [https://github.com/openai/codex.git](https://github.com/openai/codex.git) (Base Project)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-59532](https://nvd.nist.gov/vuln/detail/CVE-2025-59532)
