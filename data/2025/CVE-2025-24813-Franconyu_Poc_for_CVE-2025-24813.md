## CVE-2025-24813 - Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** RCE

**影响应用:** Apache Tomcat

**危害等级:** Critical

**CVSS评分:** 未提供，参考Rapid7博客可能为高危

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要网络访问，未经身份验证

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-24813是一个Apache Tomcat中的未授权远程代码执行漏洞，存在于处理PUT请求的部分功能中。POC代码显示了如何利用此漏洞。利用此漏洞，攻击者可以发送特制的PUT请求到Tomcat服务器，通过反序列化操作执行任意代码。该漏洞存在于Apache Tomcat的多个版本中，包括9.0.0.M1到9.0.98，10.1.0-M1到10.1.34以及11.0.0-M1到11.0.2。利用步骤如下：

1. 确保目标系统上运行着受影响的Apache Tomcat版本。
2. 准备好ysoserial工具，并将其放置在与POC脚本相同的目录下。
3. 运行POC脚本，指定目标地址（IP:端口或域名）和会话存储路径（需要与Tomcat配置匹配）。
4. 根据需要选择利用模式，例如弹计算器、DNS验证或执行其他命令。
5. 如果选择DNS验证模式，则需要提供DNSLog域名。
6. 脚本将发送特制的PUT请求到目标Tomcat服务器，触发反序列化漏洞并执行指定的代码。
7. 验证漏洞是否成功利用，例如检查计算器是否弹出或DNS查询是否成功。

POC有效性分析：POC代码提供了一个完整的利用链，能够直接在目标系统上执行任意代码。通过指定不同的模式，攻击者可以执行不同的操作，例如弹计算器、DNS验证或执行其他命令。脚本还包含版本检测功能，可以帮助用户确认目标系统是否受到漏洞影响。

投毒风险分析：该POC的投毒风险较低，约为10%。主要风险在于ysoserial工具的使用，该工具本身包含多种payload，其中一些payload可能被用于执行恶意操作。然而，POC代码本身相对清晰，主要使用标准库和subprocess模块，没有明显的混淆或恶意行为。此外，POC代码没有包含任何外部脚本或eval函数，降低了投毒风险。尽管如此，用户在使用POC时仍应保持警惕，仔细审查代码，并确保在安全的环境中进行测试。特别是需要关注ysoserial的payload选择，避免使用可能导致意外行为的payload。

总结：CVE-2025-24813是一个严重的远程代码执行漏洞，攻击者可以利用该漏洞在受影响的Apache Tomcat服务器上执行任意代码。POC代码提供了一个完整的利用链，可以帮助安全研究人员和系统管理员评估和修复漏洞。尽管POC代码的投毒风险较低，但用户在使用时仍应保持警惕，仔细审查代码，并确保在安全的环境中进行测试。

**项目地址:** /tmp/vulnwatchdog_ce66fccbaf33e5ff31a46afc6b93cea5

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-24813
