## CVE-2025-24813 - Apache Tomcat 远程代码执行(RCE)

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Tomcat

**危害等级:** 严重

**CVSS评分:** 未知，需参考NVD更新

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98, 8.5.0 through 8.5.100 (EOL)

**利用条件:** 无需认证，需要网络访问

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个未经身份验证的远程代码执行漏洞，该漏洞利用了不正确处理的Partial PUT请求。POC代码分析：提供的Python脚本通过HTTP PUT请求发送序列化的session数据，然后通过GET请求触发反序列化。利用步骤如下：
1. 使用`argparse`解析目标主机、端口、Base64编码的payload以及session ID。
2. 将Base64编码的payload解码为原始的序列化数据。
3. 构造包含序列化数据的PUT请求，设置`Content-Length`和`Content-Range`头，发送到目标服务器的`/session`路径。
4. 构造包含JSESSIONID cookie的GET请求，发送到目标服务器的根路径，触发session反序列化。
5. 检查PUT和GET请求的响应状态码。
有效性分析：该POC通过发送特制的PUT请求来上传恶意序列化对象到Tomcat服务器的session中。然后，通过发送包含特定Session ID的GET请求，Tomcat会尝试反序列化该session，从而执行攻击者预先设置的恶意代码。该POC的有效性取决于目标Tomcat服务器是否启用了`Allow linking`，该配置允许PUT请求创建新的session。此外，还需存在可用的反序列化Gadget，例如`CommonsBeanutils1`，才能成功利用。为了利用该漏洞，需要在Tomcat服务器上部署包含特定依赖的jar包，比如`commons-beanutils-1.9.2.jar`、`commons-collections-3.2.1.jar`和`commons-logging-1.1.1.jar`，以支持反序列化链的执行。

投毒风险分析：
该POC脚本主要涉及发送PUT和GET请求，其本身的代码较为清晰，没有明显的恶意行为。风险主要集中在Base64编码的payload上。如果攻击者提供的payload包含恶意代码，例如下载并执行外部脚本，或者直接执行系统命令，则可能存在投毒风险。由于payload是经过Base64编码的，可以一定程度上隐藏恶意代码，增加了分析的难度。
由于该POC需要用户提供Base64编码的payload，这为攻击者投毒提供了机会。攻击者可以构造包含恶意代码的payload，诱导用户使用，从而感染用户的机器或者在目标服务器上执行恶意代码。
综合来看，该POC的投毒风险较低，大约在10%左右。主要风险在于用户提供的payload可能包含恶意代码，但可以通过对payload进行安全分析来降低风险。

**项目地址:** https://github.com/vulhub/vulhub/tree/master/tomcat/CVE-2025-24813

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-24813
