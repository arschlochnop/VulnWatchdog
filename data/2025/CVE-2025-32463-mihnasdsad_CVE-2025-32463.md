## CVE-2025-32463 - Sudo 本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 未知

**影响版本:** 1.9.17p1之前

**利用条件:** 本地用户，需要chroot环境

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 30%

## 详情

CVE-2025-32463是一个存在于Sudo 1.9.17p1之前版本中的本地提权漏洞。该漏洞允许本地用户通过`sudo --chroot`命令获得root权限，其根本原因是由于Sudo在chroot实现中不正确地处理了用户控制的/etc/nsswitch.conf文件。攻击者可以利用该漏洞，通过创建一个恶意的nsswitch.conf文件，并将其放置在一个用户可控的目录下。当Sudo以chroot模式运行时，会加载该文件，从而允许攻击者执行任意代码并提升权限。

POC有效性分析：
根据GitHub上的POC代码（K1tt3h/CVE-2025-32463-POC和mihnasdsad/CVE-2025-32463），该漏洞存在可利用性。POC代码提供了一个自包含的bash脚本，它创建一个伪造的chroot环境，构建一个恶意的NSS模块，并使用sudo -R来触发漏洞。通过分析这些POC代码，可以确认攻击者可以通过以下步骤利用该漏洞：
1.  创建一个包含恶意配置的nsswitch.conf文件，该文件指向一个恶意的NSS模块。
2.  将该文件放置在一个用户可控的目录下。
3.  使用`sudo --chroot`命令，指定该目录作为chroot环境。
4.  当Sudo加载nsswitch.conf文件时，会执行恶意的NSS模块，从而提升权限。

利用步骤：
1.  下载或编写exp代码，例如参考：K1tt3h/CVE-2025-32463-POC.sh
2.  搭建漏洞环境，即存在漏洞版本的Linux系统和Sudo。
3.  运行exp，根据提示操作。
4.  验证是否提权成功。

投毒风险分析：
该漏洞的投毒风险主要来自以下几个方面：
1.  POC代码中可能包含恶意代码，例如后门或键盘记录器。尽管目前提供的POC代码似乎是无害的，但攻击者可能会修改这些代码，以包含恶意功能。
2.  攻击者可能会创建一个包含恶意配置的nsswitch.conf文件，该文件会下载并执行来自远程服务器的代码。如果攻击者能够控制远程服务器，他们就可以向受害者传播恶意软件。
3.  攻击者可能会利用该漏洞，在受害者的系统上安装一个持久性的后门，以便在将来重新获得访问权限。

考虑到POC的实现方式，以及潜在的攻击场景，该漏洞的投毒风险评估为中等。POC代码本身相对清晰，主要依赖于标准库，但攻击者可能通过修改nsswitch.conf文件来引入远程代码执行，从而增加投毒风险。zip包的下载方式也存在一定的风险，因为攻击者可以替换zip包中的内容。
综上所述，需要仔细审查POC代码，并从可信的来源下载相关工具，以降低投毒风险。

**项目地址:** https://github.com/K1tt3h/CVE-2025-32463-POC

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-32463
