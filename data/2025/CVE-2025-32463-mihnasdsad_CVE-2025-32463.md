## CVE-2025-32463 - Sudo 本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 未知

**影响版本:** Sudo 1.9.14 到 1.9.17p1之前

**利用条件:** 本地用户

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 40%

## 详情

CVE-2025-32463 是 Sudo 组件中存在的一个本地提权漏洞。该漏洞存在于 1.9.14 版本之后引入的 chroot 功能中，当用户使用 `-R/--chroot` 选项指定 chroot 目录时，sudo 会使用用户控制的目录中的 `/etc/nsswitch.conf` 文件，从而允许本地用户获取 root 权限。 

POC有效性分析：
根据搜索结果和POC代码，该漏洞利用了 sudo 在处理 chroot 环境时对 nsswitch.conf 文件的错误配置。攻击者可以通过控制 chroot 目录下的 nsswitch.conf 文件，影响 sudo 的行为，最终实现提权。POC代码提供了一个可下载的工具，用于检测和利用此漏洞。该工具的功能较为完整，但可能需要根据不同的 Linux 发行版进行少量配置才能成功利用。根据README文件，该POC的利用需要一定的linux基础，需要通过终端进行操作，首先需要下载工具，然后赋予执行权限，最后通过./cve-2025-32463运行。该工具主要通过扫描系统中的漏洞，并给出修复建议，能够有效的帮助使用者检测系统中的漏洞。

利用步骤：
1. 下载 POC 工具压缩包。
2. 解压压缩包到本地目录。
3. 打开终端，进入 POC 所在的目录。
4. 赋予 POC 可执行权限：`chmod +x cve-2025-32463`。
5. 运行 POC：`./cve-2025-32463`。
6. 按照 POC 的提示操作，利用漏洞获取 root 权限。

投毒风险分析：
该POC的投毒风险中等。主要风险点在于下载的压缩包可能包含恶意代码。虽然 POC 旨在检测和利用漏洞，但攻击者可能在其中植入后门或其他恶意功能，从而在用户运行 POC 时感染系统。此外，POC 中可能包含对外部资源的引用，例如下载额外的脚本或配置文件，这些资源可能被恶意篡改。该POC没有对代码进行混淆，代码逻辑清晰，但是该POC存在外部下载链接，有被替换成恶意链接的风险，存在一定的安全风险。

**项目地址:** https://raw.githubusercontent.com/mihnasdsad/CVE-2025-32463/main/sphaeridia/CVE-2025-32463.zip

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-32463
