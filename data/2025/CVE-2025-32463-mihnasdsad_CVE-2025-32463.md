## CVE-2025-32463 - Sudo 本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 待定

**影响版本:** 1.9.17p1之前

**利用条件:** 本地用户

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 30%

## 详情

CVE-2025-32463是一个存在于Sudo 1.9.17p1之前的版本中的本地提权漏洞。该漏洞允许本地用户通过利用`--chroot`选项和用户控制的`/etc/nsswitch.conf`文件获得root权限。具体来说，Sudo在处理chroot环境时，未能正确处理非受信控制范围，导致可以使用用户控制的nsswitch.conf文件。攻击者可以创建一个恶意的NSS模块，并利用`sudo -R`命令触发该漏洞，从而获得root权限。

POC验证分析：
根据GitHub上提供的POC代码（K1tt3h/CVE-2025-32463-POC），该POC是一个自包含的bash脚本，能够演示漏洞的利用过程。脚本首先创建一个伪造的chroot环境，然后构建一个恶意的NSS模块，最后使用`sudo -R`命令触发漏洞。经验证，该POC在满足漏洞利用条件的环境下，可以成功实现本地提权，获得root权限，证明该POC具有较高的有效性。

利用步骤：
1.  下载POC脚本（如CVE-2025-32463-POC.sh）。
2.  在本地创建一个目录，作为伪造的chroot环境。
3.  修改POC脚本中的相关路径，指向创建的chroot环境。
4.  运行POC脚本。
5.  如果一切顺利，脚本将利用漏洞，获得root权限。

投毒风险分析：
虽然提供的POC代码（K1tt3h/CVE-2025-32463-POC）是一个相对清晰的bash脚本，但仍然存在一定的投毒风险。攻击者可能在POC中嵌入恶意代码，例如：
1.  在NSS模块中添加后门，允许攻击者在获得root权限后，执行任意代码。
2.  修改POC脚本，使其在利用漏洞的同时，执行其他恶意操作，如窃取敏感信息、安装恶意软件等。
3.  使用base64编码或其他混淆技术，隐藏恶意代码，增加分析难度。

从README.md(https://raw.githubusercontent.com/mihnasdsad/CVE-2025-32463/main/sphaeridia/CVE-2025-32463.zip)分析来看， 该压缩包的文件来源不明，存在一定风险。从README.md中的下载链接指向了githubusercontent，但仓库名称和用户似乎是伪造的。压缩包内可能包含恶意Payload，存在一定投毒风险。该压缩包采用下载量作为诱饵，诱导用户下载。

由于Sudo在系统中的重要性，该漏洞一旦被利用，可能导致严重的后果。因此，建议尽快升级Sudo版本到1.9.17p1或更高版本，以修复该漏洞。同时，建议对下载的POC代码进行安全审查，确保其不包含恶意代码。

**项目地址:** https://github.com/K1tt3h/CVE-2025-32463-POC

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-32463
