## CVE-2025-32463 - Sudo 本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 待定

**影响版本:** 1.9.17p1之前

**利用条件:** 本地用户

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 30%

## 详情

CVE-2025-32463是一个存在于Sudo 1.9.17p1之前的版本中的本地提权漏洞。该漏洞允许本地用户通过 `--chroot` 选项和用户控制的 `/etc/nsswitch.conf` 文件获取root权限。具体来说，当Sudo以chroot模式运行时，它会使用指定的目录作为新的根目录。如果攻击者能够控制nsswitch.conf文件，他们就可以操纵名称服务解析，从而加载恶意模块并执行任意代码，最终获得root权限。

**POC有效性分析：**
提供的POC代码（GitHub - K1tt3h/CVE-2025-32463-POC）是一个bash脚本，旨在演示该漏洞的利用过程。它创建一个伪造的chroot环境，构建一个恶意的NSS模块，然后使用sudo -R来触发漏洞。根据多个搜索结果，该POC被认为是有效的，可以成功地在受影响的系统上实现本地提权。该POC的质量评分为7/10，因为它提供了一个完整的利用链，但可能需要进行一些配置才能在特定环境中成功运行。

**利用步骤：**
1.  下载并解压POC代码。
2.  创建一个包含恶意配置的伪造的`/etc/nsswitch.conf` 文件。
3.  构建一个恶意的NSS模块，该模块将在名称服务解析期间被加载。
4.  使用`sudo -R <chroot目录> <命令>` 命令以chroot模式运行Sudo，并将伪造的根目录传递给它。
5.  Sudo将使用攻击者控制的`nsswitch.conf`文件，加载恶意NSS模块，并执行其中的代码，从而实现提权。

**投毒风险分析：**
该POC的投毒风险为30%。虽然提供的POC本身是一个合法的漏洞利用程序，用于演示和测试目的，但攻击者可以修改该POC，使其包含恶意代码。例如，攻击者可以在NSS模块中添加后门，或者在利用过程中执行额外的恶意命令。此外，攻击者可能会将该POC与其他恶意工具捆绑在一起，或者将其发布在受污染的软件仓库中。由于POC涉及到动态链接库的加载和执行，攻击者可以在NSS模块中嵌入恶意代码，实现持久化控制。虽然POC本身没有明显的混淆或恶意行为，但由于其性质，存在被滥用的风险。

综上所述，CVE-2025-32463是一个严重的安全漏洞，需要及时修补。组织应尽快更新Sudo版本，并审查其sudo配置，以确保系统安全。

**项目地址:** https://github.com/K1tt3h/CVE-2025-32463-POC

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-32463
