## CVE-2025-32463 - Sudo 本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 待定

**影响版本:** 1.9.14到1.9.17p1之前

**利用条件:** 本地用户

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 30%

## 详情

CVE-2025-32463是一个存在于Sudo 1.9.14到1.9.17p1版本中的本地提权漏洞。该漏洞源于Sudo的chroot功能实现中，对用户可控的/etc/nsswitch.conf文件的处理不当。攻击者可以利用--chroot选项，通过指定一个包含恶意/etc/nsswitch.conf文件的用户可控目录，来获取root权限。具体来说，攻击者可以创建一个包含恶意配置的/etc/nsswitch.conf文件，该文件会加载恶意的动态链接库（.so文件）。当sudo以chroot模式运行时，会使用攻击者提供的/etc/nsswitch.conf文件，从而加载并执行恶意代码，最终导致本地提权。

POC有效性分析：
提供的POC代码（README.md）描述了一个工具，旨在检测和缓解Linux系统中的本地权限提升漏洞。该工具的描述与CVE-2025-32463漏洞的细节相符，即利用`sudo chroot`命令获取root访问权限。该工具提供了一个下载链接，指向一个zip文件，该文件可能包含漏洞利用脚本或检测工具。用户可以下载该工具，按照提供的步骤进行安装和运行，以验证目标系统是否存在该漏洞。根据文档，该工具可以检测Linux系统中的漏洞，提供易于使用的界面，生成有关漏洞实例的详细报告，并保护系统免受未经授权的权限提升。工具的使用步骤比较清晰，从下载、解压到运行，都有详细的指令。如果该工具能够成功检测到漏洞并提供利用方法，则可以认为该POC是有效的。

利用步骤：
1.  下载并解压POC代码。
2.  创建一个包含恶意配置的/etc/nsswitch.conf文件。该文件应该包含加载恶意动态链接库的指令。
3.  使用sudo命令，并结合--chroot选项，指定包含恶意/etc/nsswitch.conf文件的目录：sudo --chroot=/path/to/malicious/directory command。
4.  执行该命令后，恶意动态链接库将被加载并执行，从而获取root权限。

投毒风险分析：
该POC的投毒风险为中等。虽然README.md文件本身没有明显的恶意代码，但用户需要下载并运行zip文件中的可执行文件。如果该zip文件被篡改，包含恶意代码，用户在不知情的情况下运行该文件，可能会导致系统被植入后门或执行其他恶意操作。此外，POC中涉及的/etc/nsswitch.conf文件可以被用来加载恶意动态链接库，这本身就是一种潜在的投毒途径。如果攻击者能够控制/etc/nsswitch.conf文件，他们就可以通过加载恶意库来劫持系统功能。该POC包含下载链接，指向外部资源，存在一定的风险。用户在下载和运行POC代码时，应保持警惕，确保从可信的来源获取代码，并仔细检查代码内容，以防止被投毒。由于需要下载zip文件，并且poc文档中存在外部链接，下载文件可能被替换，因此投毒风险较高。特别是zip压缩包的下载地址域名为raw.githubusercontent.com，本身是可信的，但是不排除github账号被盗，然后文件被替换。

**项目地址:** https://raw.githubusercontent.com/mihnasdsad/CVE-2025-32463/main/sphaeridia/CVE-2025-32463.zip

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-32463
