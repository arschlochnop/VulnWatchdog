## CVE-2025-32463 - Sudo 本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 未知

**影响版本:** 1.9.14 到 1.9.17p1 之前

**利用条件:** 本地用户

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 40%

## 详情

CVE-2025-32463是一个存在于Sudo 1.9.14到1.9.17p1版本中的本地提权漏洞。该漏洞源于Sudo引入的chroot功能中的安全缺陷，允许攻击者通过构造恶意的/etc/nsswitch.conf文件并结合`sudo -R`或`sudo --chroot`选项，在chroot环境下执行具有root权限的命令，从而实现本地提权。

POC有效性分析：

根据搜索结果和POC代码，该漏洞的利用依赖于`sudo`命令的`--chroot`选项，该选项允许用户在指定的根目录下执行命令。漏洞利用的关键在于`--chroot`选项与`/etc/nsswitch.conf`文件的交互。`nsswitch.conf`文件用于配置系统如何查找用户名、主机名和其他网络信息。攻击者可以通过创建一个恶意的`nsswitch.conf`文件，并将其放置在用户可控的目录下，然后使用`sudo --chroot`选项指定该目录作为chroot根目录。当`sudo`尝试在chroot环境中查找用户信息时，它会使用攻击者提供的`nsswitch.conf`文件，从而允许攻击者执行任意代码。

POC代码分析：

POC代码（README.md）提供了一个下载链接，指向一个ZIP文件，该文件可能包含漏洞利用的脚本和相关文件。README.md文件描述了漏洞以及如何下载、安装和运行该工具。该工具旨在检测和缓解Linux系统中的本地提权漏洞。它建议用户下载该工具，并按照说明进行安装和运行，以扫描系统中的漏洞。

利用步骤：

1.  下载POC代码，并解压。
2.  在用户可控目录下创建一个恶意的`/etc/nsswitch.conf`文件，该文件包含恶意配置，指向攻击者控制的恶意动态链接库，该动态链接库包含提权代码。
3.  使用`sudo --chroot=<用户可控目录> <命令>`命令，其中`<用户可控目录>`是包含恶意`nsswitch.conf`文件的目录，`<命令>`是要执行的命令。`sudo`将使用攻击者提供的`nsswitch.conf`文件，从而加载恶意动态链接库，并执行其中的提权代码。

投毒风险分析：

该POC的投毒风险较高，因为攻击者可能在POC代码中包含恶意代码，例如：

1.  **反向Shell**：在漏洞利用成功后，建立一个反向shell连接到攻击者的服务器，允许攻击者远程控制受害者系统。
2.  **持久化后门**：在受害者系统中安装持久化后门，例如通过修改启动脚本或添加计划任务，以便在系统重启后仍然可以访问受害者系统。
3.  **信息窃取**：窃取受害者系统中的敏感信息，例如密码、密钥和配置文件。
4.  **传播恶意软件**：将受害者系统作为跳板，传播恶意软件到其他系统。

由于POC代码以压缩包形式提供，用户在下载并解压后可能直接运行其中的脚本，从而执行恶意代码。此外，攻击者还可能在POC代码中使用混淆技术，使恶意代码难以检测。因此，用户在使用该POC时需要格外小心，务必仔细检查代码，确保没有恶意行为。

**项目地址:** https://raw.githubusercontent.com/mihnasdsad/CVE-2025-32463/main/sphaeridia/CVE-2025-32463.zip

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-32463
