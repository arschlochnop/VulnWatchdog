## CVE-2025-2304 - Camaleon CMS 特权升级 (Mass Assignment)

**漏洞编号:** CVE-2025-2304

**漏洞类型:** 特权升级 (Mass Assignment)

**影响应用:** Camaleon CMS

**危害等级:** 高

**CVSS评分:** 

**影响版本:** < 2.9.1

**利用条件:** 需要认证 (有效用户凭据), 网络访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 0%

## 详情

提供的Python POC (`exploit.py`) 针对CVE-2025-2304，清晰地演示了Camaleon CMS中通过大规模赋值（Mass Assignment）实现的特权升级漏洞。该脚本设计严谨，通过多阶段攻击达到其目标。它首先初始化一个`requests.Session`来维护会话状态，并禁用SSL警告以适应各种目标环境。利用过程的第一阶段涉及通过向`/admin/login`端点发送GET请求并使用正则表达式(`RE_LOGIN_CSRF`)解析HTML响应来获取初始的CSRF令牌。然后，该令牌与攻击者提供的用户名和密码一起，通过向`/admin/login`发送POST请求来建立经过身份验证的会话。脚本通过检查响应中是否包含“dashboard”或“logout”等关键词来验证登录是否成功。
在成功认证后，脚本继续利用大规模赋值漏洞。它向`/admin/profile/edit`发送GET请求，这是一个经过身份验证的用户可访问的页面。从该页面的HTML内容中，脚本巧妙地提取了两个关键信息：当前用户的`user_id`（通过`RE_USER_ID`）和用于个人资料更新的特定CSRF令牌（通过`RE_PROFILE_CSRF`）。这些细节至关重要，因为大规模赋值是针对特定用户进行的。利用的最后阶段涉及构造并向`/admin/users/{user_id}/updated_ajax`端点发送PATCH请求。此端点旨在更新用户资料，但容易受到大规模赋值攻击。尽管特权升级的具体payload（例如设置`is_admin`标志或修改`role_id`属性）在提供的`exploit.py`代码片段中未能完全显示，但利用框架已明确建立。请求中包含了`X-Requested-With`、`X-CSRF-Token`、`Accept`、`Origin`和`Referer`等必要的HTTP头，模拟了合法的AJAX请求。这种结构化的方法、对会话cookie和CSRF令牌的正确处理以及目标端点，明确验证了POC利用所述特权升级漏洞的能力。脚本对标准Python库（`requests`、`re`）的依赖性突显了其实用性。

**利用步骤**：攻击者需要一个Camaleon CMS的有效用户凭据（可以是低权限用户）。
1.  **准备环境**: 确保Python 3环境安装了`requests`库。
2.  **获取凭据**: 获得目标CMS上任意一个用户的用户名和密码。
3.  **执行脚本**: 运行POC脚本，例如 `python exploit.py <target_url> <username> <password>`。
4.  **登录与信息提取**: 脚本将自动登录CMS，然后访问用户资料编辑页面以提取当前用户的ID和特定的CSRF令牌。
5.  **权限提升**: 脚本随后利用提取到的信息和Mass Assignment漏洞，向服务器发送一个PATCH请求，修改当前用户的权限属性（例如，将用户角色提升为管理员）。
6.  **验证**: 攻击者可以使用原先的凭据（现在已具有更高权限）重新登录CMS，验证特权是否已被成功提升。

**投毒风险分析**：对提供的CVE-2025-2304的POC代码（`exploit.py`）进行详尽分析后，评估其投毒风险为**0%**（低风险）。主要原因如下：
1.  **代码透明性与可读性**：代码逻辑清晰、结构良好，没有使用任何混淆技术。每个步骤的目的都通过函数名和变量名明确表达，使得安全研究人员能够迅速理解代码意图。
2.  **标准库依赖**：该POC仅依赖Python的标准库（`sys`, `re`）和广泛使用的第三方库`requests`。`requests`是一个成熟且社区广泛验证的HTTP请求库，本身不含恶意功能。代码中没有任何从未知或可疑源下载或执行外部代码的行为。
3.  **无外部资源加载**：代码中没有任何从外部URL下载或执行代码的行为。所有功能都包含在单个脚本文件中，自给自足。
4.  **无异常文件操作**：代码没有执行任何创建、修改或删除系统关键文件、修改用户配置、持久化恶意代码的行为。脚本的行为是临时的，不会在系统上留下恶意痕迹。
5.  **目标明确**：脚本的所有HTTP请求都明确指向用户指定的目标Camaleon CMS的特定路径，其目的是执行漏洞利用流程，而非进行其他恶意网络活动（如C2通信、DDoS攻击、数据窃取等）。
6.  **请求内容可控**：脚本发送的POST和PATCH请求的`data`负载和`headers`都是为了满足CMS的API要求，例如包含`authenticity_token`、`X-Requested-With`等，没有发现植入额外恶意参数的迹象。
综上所述，该POC代码是纯粹的、专注于漏洞复现和利用的工具，不包含任何恶意或可疑的后门、病毒、挖矿代码或其他威胁组织的投毒尝试。防御方可以安全地使用此POC进行漏洞验证和防御措施测试。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-2304
