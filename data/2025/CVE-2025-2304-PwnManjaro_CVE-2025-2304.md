## CVE-2025-2304 - Camaleon CMS 特权升级 (Mass Assignment)

**漏洞编号:** CVE-2025-2304

**漏洞类型:** 特权升级 (Mass Assignment)

**影响应用:** Camaleon CMS

**危害等级:** 高

**CVSS评分:** 未提供

**影响版本:** < 2.9.1

**利用条件:** 需要认证 (有效用户凭据), 网络可达

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

CVE-2025-2304：Camaleon CMS 特权升级漏洞分析

POC有效性分析:
提供的Python脚本（`exploit.py`）是一个针对CVE-2025-2304的完整且高度有效的概念验证（POC）。此漏洞利用了Camaleon CMS中存在的Mass Assignment缺陷，允许经过身份验证的普通用户将其权限提升至管理员级别。脚本自动化了漏洞利用的各个阶段，包括：
1.  **会话建立与CSRF令牌获取**: 脚本首先对目标CMS的`/admin/login`路径发起GET请求，解析HTML响应以提取用于登录的`authenticity_token`。这确保了后续登录请求能绕过CSRF防护。
2.  **用户认证**: 脚本使用预设的有效用户名和密码，连同获取的CSRF令牌，向`/admin/login`路径发送POST请求进行认证。通过检查响应内容（如“dashboard”或“logout”），脚本能确认登录是否成功并建立会话。
3.  **用户ID及特定CSRF令牌提取**: 登录成功后，脚本访问`/admin/profile/edit`页面。从该页面HTML中，脚本利用正则表达式精准提取当前用户的数字ID（用于标识被攻击的用户账户）以及一个专用于更新用户配置文件的CSRF令牌。这些信息对于构造特权升级请求至关重要。
4.  **执行特权升级**: 核心攻击步骤在于向`/admin/users/{user_id}/updated_ajax`路径发送一个精心构造的PATCH请求。该请求的HTTP头中包含了`X-CSRF-Token`和其他模拟浏览器行为的字段。请求体中包含利用Mass Assignment漏洞的参数，例如`user[admin]=true`。Camaleon CMS由于对传入参数的过滤或验证不足，未能正确处理`admin`属性，导致用户的权限被非法修改，从普通用户提升为管理员。
该脚本设计简洁、逻辑清晰，所有操作均通过标准HTTP请求完成，并包含基本的错误处理机制。其可靠性高，能有效验证漏洞的存在性及其可利用性，为安全研究和防御测试提供了强大的工具。

利用步骤:
要利用此漏洞，攻击者需遵循以下步骤：
1.  **获取POC**: 从可信来源获取`exploit.py`脚本。
2.  **准备环境**: 确保本地系统安装了Python 3及`requests`库（`pip install requests`）。
3.  **获取凭据**: 获得目标Camaleon CMS系统中一个有效用户的用户名和密码。
4.  **执行脚本**: 在命令行中运行脚本，指定目标CMS的URL、获取的用户名和密码。例如：`python3 exploit.py --target "https://target-cms.com" --username "user" --password "password"`。
5.  **自动化流程**: 脚本将自动完成CSRF令牌获取、用户登录、用户ID和配置文件更新令牌的提取。
6.  **注入特权参数**: 脚本随后会构建并发送一个PATCH请求，在请求体中包含恶意参数（如`user[admin]=true`），通过Mass Assignment漏洞将当前用户的权限提升为管理员。
7.  **验证**: 攻击者可尝试用原用户凭据重新登录，检查是否已获得管理员功能或访问管理员仪表板。

投毒风险分析:
对该POC代码的安全性进行分析，其投毒风险评估为低（约10%）。代码完全用Python编写，结构清晰，未见任何混淆或恶意加密。它仅依赖于Python标准库和广受欢迎的`requests`库，这两者本身是安全的。脚本的核心功能是执行合法的HTTP请求序列来模拟漏洞利用过程，不涉及文件系统写入、任意命令执行（如`os.system`）、外部可执行文件下载或动态代码执行（如`eval`）等高风险操作。所有的网络通信都指向目标CMS，没有发现与不明外部C2服务器进行通信或发送敏感数据的行为。`requests.packages.urllib3.disable_warnings()`的使用是常见的调试或测试实践，并非恶意指示。因此，在未被外部篡改的情况下，此POC脚本自身不构成直接的投毒风险。然而，任何从非官方渠道获取的代码都应在隔离环境中进行严格审查，以防范潜在的二次打包恶意软件。建议使用者始终从官方或高度可信的来源获取POC，并在专用的安全测试环境中运行。

**项目地址:** 未提供

**漏洞详情:** https://www.cve.org/CVERecord?id=CVE-2025-2304
