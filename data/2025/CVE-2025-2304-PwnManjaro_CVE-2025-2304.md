## CVE-2025-2304 - Camaleon CMS 特权升级 (Privilege Escalation) / 批量赋值 (Mass Assignment)

**漏洞编号:** CVE-2025-2304

**漏洞类型:** 特权升级 (Privilege Escalation) / 批量赋值 (Mass Assignment)

**影响应用:** Camaleon CMS

**危害等级:** 高危 (High)

**CVSS评分:** 

**影响版本:** < 2.9.1

**利用条件:** 需要认证 (Authenticated Access), 需要网络访问 (Network Access)

**POC 可用性:** 9/10

**POC 类型:** 完整利用 (Complete Exploitation)

**攻击复杂度:** 中 (Medium)

**投毒风险:** 10%

## 详情

Camaleon CMS (CVE-2025-2304) 存在一个通过批量赋值导致的特权升级漏洞。此漏洞允许经过身份验证的攻击者提升其在系统中的权限至管理员级别。

**POC有效性分析：**
提供的 `exploit.py` 脚本是一个高度有效的概念验证（POC），通过 Python 3 自动化了漏洞利用过程。脚本首先向 `/admin/login` 发送 GET 请求以获取 CSRF 令牌，然后使用有效凭据进行登录，建立认证会话。接着，脚本访问 `/admin/profile/edit` 页面，提取当前用户的 `user_id` 和用于配置文件更新的特定 CSRF 令牌。核心利用步骤是向 `/admin/users/{user_id}/updated_ajax` 端点发送 PATCH 请求。此请求包含 `X-CSRF-Token` 头部和 JSON 有效载荷 `{"user":{"is_admin":true}}`。该漏洞是由于 Camaleon CMS 在处理用户输入时未能充分限制哪些属性可以被更新，导致普通用户能够通过批量赋值机制修改 `is_admin` 属性。脚本的逻辑严谨，包括对令牌和 ID 的稳健提取，以及精确的请求构造，确保了对易受攻击的 Camaleon CMS 实例的高度成功率，只要提供有效的非管理员凭据。200 OK 的响应表明特权升级成功。

**利用步骤：**
1.  确保安装 Python 3 和 `requests` 库 (`pip install requests`)。
2.  保存 `exploit.py` 脚本。
3.  执行命令：`python3 exploit.py https://[target_url] [non_admin_username] [password]`。
4.  脚本将自动完成登录、令牌/ID提取及特权升级。
5.  成功后，使用原用户名和密码登录 CMS，将发现已获得管理员权限。

**投毒风险分析：**
`exploit.py` 脚本的投毒风险评估为低（约 10%）。脚本仅使用标准的 Python 3 库 (`requests`, `re`, `sys`)，代码清晰透明，无任何混淆或动态加载外部模块。脚本的功能完全专注于演示 CVE-2025-2304 的特权升级，没有发现任何与挖矿、数据窃取、C2通信或恶意软件投递相关的可疑行为。禁用 SSL 警告是为了方便测试，并非恶意行为。有效载荷 `{"user":{"is_admin":true}}` 是漏洞利用的核心机制，旨在修改 `is_admin` 属性以实现特权升级，并非 POC 作者植入的恶意载荷。因此，运行此 POC 不会意外危害用户系统，其主要风险在于被滥用攻击未经授权的目标。

**项目地址:** 

**漏洞详情:** https://www.cve.org/CVERecord?id=CVE-2025-2304
