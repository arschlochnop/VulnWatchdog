## CVE-2025-68613 - n8n RCE (远程代码执行)

**漏洞编号:** CVE-2025-68613

**漏洞类型:** RCE (远程代码执行)

**影响应用:** n8n

**危害等级:** CRITICAL

**CVSS评分:** 9.9

**影响版本:** 0.211.0 ≤ n8n < 1.120.4, n8n < 1.121.1, n8n < 1.122.0

**利用条件:** 需要用户认证，需拥有创建或编辑工作流的权限以输入恶意表达式

**POC 可用性:** 4/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

【POC有效性分析】该漏洞源于n8n工作流自动化平台在评估表达式时未能正确限制动态管理的转换资源，属于CWE-913类型缺陷。根据提供的POC片段（表现为HTML文档形式的深度分析报告），虽然未给出完整的Exploit脚本，但明确指出了漏洞点位于表达式评估系统。该系统允许用户通过特定的JavaScript对象绕过内置的沙箱限制。在n8n的早期版本中，表达式引擎对Node.js底层对象的隔离不够彻底，攻击者可以利用如constructor或特定全局对象的链式调用来执行任意系统命令。此POC主要作为安全教育和漏洞原理展示，有效性体现在其对利用链的逻辑梳理，而非直接的一键攻击工具。利用该漏洞，攻击者可以提升权限或在服务器端实现持久化控制。针对该CVE的修复通常涉及对vm2或类似沙箱库的加固及更严格的输入过滤。【利用步骤】1. 登录n8n实例；2. 创建一个新的工作流或编辑现有工作流；3. 在节点属性中使用表达式（Expression）功能；4. 构造能够绕过沙箱的Payload（如：{{ $node["test"].constructor.constructor("return process")().mainModule.require("child_process").execSync("id") }}）；5. 执行该工作流或预览表达式结果，触发后端代码执行。【投毒风险分析】目前提供的POC代码主要是一个HTML格式的分析页面，其投毒风险极低（约10%）。代码内容多为CSS样式定义和结构化文字描述，未发现恶意混淆的JavaScript、Base64编码的Payload或尝试连接异常外部C2服务器的行为。风险点仅在于此类“深度研究”页面可能被攻击者用来托管浏览器溢出代码或钓鱼攻击，但在本次提供的输入中，代码逻辑清晰且符合安全研究文档的特征。其包含的Payload示例仅用于展示漏洞存在性，不具备自我复制或窃取本地凭据的隐蔽后门。防御人员在引用此类POC时，应重点关注其提供的Payload模板，避免在生产环境直接测试。建议通过官方补丁进行修复，目前n8n已发布多个分支的更新版本（如1.120.4+）来封堵该逃逸路径。在分析过程中，需警惕那些宣称提供‘全自动Exploit’且代码经过高度压缩或加密的项目，那类项目往往存在更高比例的投毒风险。

**项目地址:** n/a

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-68613](https://nvd.nist.gov/vuln/detail/CVE-2025-68613)
