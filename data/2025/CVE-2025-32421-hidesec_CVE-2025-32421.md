# CVE-2025-32421

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-32421-hidesec_CVE-2025-32421.md](../2025/CVE-2025-32421-hidesec_CVE-2025-32421.md)

# CVE-2025-32421

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-32421-hidesec_CVE-2025-32421.md](../2025/CVE-2025-32421-hidesec_CVE-2025-32421.md)

# CVE-2025-32421

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-32421-hidesec_CVE-2025-32421.md](../2025/CVE-2025-32421-hidesec_CVE-2025-32421.md)

# CVE-2025-32421

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-32421-hidesec_CVE-2025-32421.md](../2025/CVE-2025-32421-hidesec_CVE-2025-32421.md)

# CVE-2025-32421

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-32421-hidesec_CVE-2025-32421.md](../2025/CVE-2025-32421-hidesec_CVE-2025-32421.md)

## CVE-2025-32421 Next.js Race Condition to Cache Poisoning + XSS

**漏洞编号:** CVE-2025-32421

**漏洞类型:** 缓存投毒 + XSS

**影响应用:** Next.js

**危害等级:** 高危，可能导致敏感信息泄露和任意代码执行

**影响版本:** < 14.2.24 and >= 15.0.0, < 15.1.6

**利用条件:** 需要目标应用存在特定的配置缺陷（Pages Router 使用不当，且未正确处理 `x-now-route-matches` 头部），且存在XSS漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是 Next.js 在特定配置下的竞态条件导致的缓存投毒，结合 XSS 漏洞可造成更大的危害。

**漏洞利用有效性：**
提供的PoC代码有效。它演示了如何利用竞态条件结合XSS漏洞，从而暴露敏感信息。

**投毒风险分析：**
虽然PoC代码本身侧重于演示漏洞利用，但存在一定的投毒风险，大约为10%。PoC中涉及XSS payload，可能被用于注入恶意脚本。攻击者可以在PoC的基础上修改XSS payload，从而实现更隐蔽和恶意的攻击，例如窃取用户凭据、篡改页面内容或进行DDoS攻击。

**漏洞利用方式：**
1.  **竞态条件（Race Condition）：** 利用 Next.js 在处理并发请求时的竞态条件，通过同时发送多个请求，尝试触发缓存投毒。
2.  **头部操纵：** 利用`x-now-route-matches` 头部来影响路由匹配。
3.  **XSS 注入：**  通过构造恶意的Cookie（theme、userInput等）包含XSS payload，利用 `dangerouslySetInnerHTML` 执行任意JavaScript代码。
4.  **信息泄露：**  利用 XSS 读取隐藏的全局数据（`globalData`），包括监控配置（dsn、apiKey）、用户偏好和管理员权限。
5.  **权限提升：** 如果成功窃取管理员权限，攻击者可以执行管理操作。

**缓解措施：**
*   升级 Next.js 到 14.2.24 或 15.1.6 或更高版本。
*   在 CDN 或反向代理层剥离 `x-now-route-matches` 头部。
*   对所有响应设置 `cache-control: no-store`。
*   只缓存带有显式 `cache-control` 头的响应。
*   对用户输入进行严格的验证和转义，防止 XSS 攻击。
*   使用 HTTPOnly 保护 Cookie，防止客户端脚本访问敏感 Cookie。
*   实施内容安全策略 (CSP)，限制可执行脚本的来源。

**项目地址:** [hidesec/CVE-2025-32421](https://github.com/hidesec/CVE-2025-32421)

**漏洞详情:** [CVE-2025-32421](https://nvd.nist.gov/vuln/detail/CVE-2025-32421)

---

## POC #2

**来源**: [CVE-2025-32421-zeroc00I_CVE-2025-32421.md](../2025/CVE-2025-32421-zeroc00I_CVE-2025-32421.md)

## CVE-2025-32421-Next.js-缓存投毒

**漏洞编号:** CVE-2025-32421

**漏洞类型:** 缓存投毒

**影响应用:** Next.js

**危害等级:** 中危，可能导致敏感信息泄露或页面内容篡改

**影响版本:** < 14.2.24 或 >= 15.0.0, < 15.1.6

**利用条件:** Pages Router，特定的错误配置，自托管Next.js部署，未使用显式缓存控制，存在竞态条件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-32421是Next.js框架中的一个竞态条件漏洞，可能导致缓存投毒。漏洞出现在Pages Router中，影响版本低于14.2.24和15.0.0到15.1.6的版本。该漏洞的利用需要满足特定条件：自托管的Next.js部署，以及缺乏显式的缓存控制。漏洞利用的核心在于利用竞态条件，使得正常的端点提供`pageProps`数据而不是标准的HTML，从而影响缓存的内容。根据漏洞库信息，Vercel平台不受此漏洞影响，因为该平台不会仅基于`200 OK`状态缓存响应。提供的POC代码尝试模拟一个容易受到攻击的场景，但更侧重于验证堆栈对齐，而不是实际的缓存投毒。它使用了混淆的通信通道，向一个URL发送请求，并期望验证失败。POC的目的是帮助分析人员了解漏洞利用过程中的堆栈行为，而不是提供一个可以直接使用的攻击载荷。POC代码中未发现明显的投毒代码。

**项目地址:** [zeroc00I/CVE-2025-32421](https://github.com/zeroc00I/CVE-2025-32421)

**漏洞详情:** [CVE-2025-32421](https://nvd.nist.gov/vuln/detail/CVE-2025-32421)

---



---

## POC #2

**来源**: [CVE-2025-32421-zeroc00I_CVE-2025-32421.md](../2025/CVE-2025-32421-zeroc00I_CVE-2025-32421.md)

## CVE-2025-32421-Next.js-缓存投毒

**漏洞编号:** CVE-2025-32421

**漏洞类型:** 缓存投毒

**影响应用:** Next.js

**危害等级:** 中危，可能导致敏感信息泄露或页面内容篡改

**影响版本:** < 14.2.24 或 >= 15.0.0, < 15.1.6

**利用条件:** Pages Router，特定的错误配置，自托管Next.js部署，未使用显式缓存控制，存在竞态条件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-32421是Next.js框架中的一个竞态条件漏洞，可能导致缓存投毒。漏洞出现在Pages Router中，影响版本低于14.2.24和15.0.0到15.1.6的版本。该漏洞的利用需要满足特定条件：自托管的Next.js部署，以及缺乏显式的缓存控制。漏洞利用的核心在于利用竞态条件，使得正常的端点提供`pageProps`数据而不是标准的HTML，从而影响缓存的内容。根据漏洞库信息，Vercel平台不受此漏洞影响，因为该平台不会仅基于`200 OK`状态缓存响应。提供的POC代码尝试模拟一个容易受到攻击的场景，但更侧重于验证堆栈对齐，而不是实际的缓存投毒。它使用了混淆的通信通道，向一个URL发送请求，并期望验证失败。POC的目的是帮助分析人员了解漏洞利用过程中的堆栈行为，而不是提供一个可以直接使用的攻击载荷。POC代码中未发现明显的投毒代码。

**项目地址:** [zeroc00I/CVE-2025-32421](https://github.com/zeroc00I/CVE-2025-32421)

**漏洞详情:** [CVE-2025-32421](https://nvd.nist.gov/vuln/detail/CVE-2025-32421)

---



---

## POC #2

**来源**: [CVE-2025-32421-zeroc00I_CVE-2025-32421.md](../2025/CVE-2025-32421-zeroc00I_CVE-2025-32421.md)

## CVE-2025-32421-Next.js-缓存投毒

**漏洞编号:** CVE-2025-32421

**漏洞类型:** 缓存投毒

**影响应用:** Next.js

**危害等级:** 中危，可能导致敏感信息泄露或页面内容篡改

**影响版本:** < 14.2.24 或 >= 15.0.0, < 15.1.6

**利用条件:** Pages Router，特定的错误配置，自托管Next.js部署，未使用显式缓存控制，存在竞态条件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-32421是Next.js框架中的一个竞态条件漏洞，可能导致缓存投毒。漏洞出现在Pages Router中，影响版本低于14.2.24和15.0.0到15.1.6的版本。该漏洞的利用需要满足特定条件：自托管的Next.js部署，以及缺乏显式的缓存控制。漏洞利用的核心在于利用竞态条件，使得正常的端点提供`pageProps`数据而不是标准的HTML，从而影响缓存的内容。根据漏洞库信息，Vercel平台不受此漏洞影响，因为该平台不会仅基于`200 OK`状态缓存响应。提供的POC代码尝试模拟一个容易受到攻击的场景，但更侧重于验证堆栈对齐，而不是实际的缓存投毒。它使用了混淆的通信通道，向一个URL发送请求，并期望验证失败。POC的目的是帮助分析人员了解漏洞利用过程中的堆栈行为，而不是提供一个可以直接使用的攻击载荷。POC代码中未发现明显的投毒代码。

**项目地址:** [zeroc00I/CVE-2025-32421](https://github.com/zeroc00I/CVE-2025-32421)

**漏洞详情:** [CVE-2025-32421](https://nvd.nist.gov/vuln/detail/CVE-2025-32421)

---



---

## POC #2

**来源**: [CVE-2025-32421-zeroc00I_CVE-2025-32421.md](../2025/CVE-2025-32421-zeroc00I_CVE-2025-32421.md)

## CVE-2025-32421-Next.js-缓存投毒

**漏洞编号:** CVE-2025-32421

**漏洞类型:** 缓存投毒

**影响应用:** Next.js

**危害等级:** 中危，可能导致敏感信息泄露或页面内容篡改

**影响版本:** < 14.2.24 或 >= 15.0.0, < 15.1.6

**利用条件:** Pages Router，特定的错误配置，自托管Next.js部署，未使用显式缓存控制，存在竞态条件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-32421是Next.js框架中的一个竞态条件漏洞，可能导致缓存投毒。漏洞出现在Pages Router中，影响版本低于14.2.24和15.0.0到15.1.6的版本。该漏洞的利用需要满足特定条件：自托管的Next.js部署，以及缺乏显式的缓存控制。漏洞利用的核心在于利用竞态条件，使得正常的端点提供`pageProps`数据而不是标准的HTML，从而影响缓存的内容。根据漏洞库信息，Vercel平台不受此漏洞影响，因为该平台不会仅基于`200 OK`状态缓存响应。提供的POC代码尝试模拟一个容易受到攻击的场景，但更侧重于验证堆栈对齐，而不是实际的缓存投毒。它使用了混淆的通信通道，向一个URL发送请求，并期望验证失败。POC的目的是帮助分析人员了解漏洞利用过程中的堆栈行为，而不是提供一个可以直接使用的攻击载荷。POC代码中未发现明显的投毒代码。

**项目地址:** [zeroc00I/CVE-2025-32421](https://github.com/zeroc00I/CVE-2025-32421)

**漏洞详情:** [CVE-2025-32421](https://nvd.nist.gov/vuln/detail/CVE-2025-32421)

---



---

## POC #2

**来源**: [CVE-2025-32421-zeroc00I_CVE-2025-32421.md](../2025/CVE-2025-32421-zeroc00I_CVE-2025-32421.md)

## CVE-2025-32421-Next.js-缓存投毒

**漏洞编号:** CVE-2025-32421

**漏洞类型:** 缓存投毒

**影响应用:** Next.js

**危害等级:** 中危，可能导致敏感信息泄露或页面内容篡改

**影响版本:** < 14.2.24 或 >= 15.0.0, < 15.1.6

**利用条件:** Pages Router，特定的错误配置，自托管Next.js部署，未使用显式缓存控制，存在竞态条件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-32421是Next.js框架中的一个竞态条件漏洞，可能导致缓存投毒。漏洞出现在Pages Router中，影响版本低于14.2.24和15.0.0到15.1.6的版本。该漏洞的利用需要满足特定条件：自托管的Next.js部署，以及缺乏显式的缓存控制。漏洞利用的核心在于利用竞态条件，使得正常的端点提供`pageProps`数据而不是标准的HTML，从而影响缓存的内容。根据漏洞库信息，Vercel平台不受此漏洞影响，因为该平台不会仅基于`200 OK`状态缓存响应。提供的POC代码尝试模拟一个容易受到攻击的场景，但更侧重于验证堆栈对齐，而不是实际的缓存投毒。它使用了混淆的通信通道，向一个URL发送请求，并期望验证失败。POC的目的是帮助分析人员了解漏洞利用过程中的堆栈行为，而不是提供一个可以直接使用的攻击载荷。POC代码中未发现明显的投毒代码。

**项目地址:** [zeroc00I/CVE-2025-32421](https://github.com/zeroc00I/CVE-2025-32421)

**漏洞详情:** [CVE-2025-32421](https://nvd.nist.gov/vuln/detail/CVE-2025-32421)

---

