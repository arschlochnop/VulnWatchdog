## CVE-2025-32433 - Erlang/OTP SSH library RCE

**漏洞编号:** CVE-2025-32433

**漏洞类型:** RCE

**影响应用:** Erlang/OTP SSH library

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** < OTP-27.3.3, < OTP-26.2.5.11, < OTP-25.3.2.20

**利用条件:** 目标系统启用了Erlang/OTP的SSH服务，无需任何身份验证。

**POC 可用性:** 7/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-32433是一个存在于Erlang/OTP SSH实现中的严重远程代码执行漏洞。该漏洞源于SSH协议消息处理逻辑中的缺陷，允许未经身份验证的攻击者通过发送特制的SSH通道请求（Channel Request）来绕过身份验证机制，并在受影响的系统上执行任意代码。POC有效性分析：提供的POC是一个基于Nmap的NSE脚本，其核心逻辑高度模拟了漏洞触发过程。脚本通过构建原始的SSH报文，首先发送KEXINIT（密钥交换初始化）包，随后在未完成标准身份验证流的情况下，尝试直接发送'SSH_MSG_CHANNEL_OPEN'（0x5a）开启session通道，并紧接着发送'SSH_MSG_CHANNEL_REQUEST'（0x62）请求执行'exec'操作。代码中定义的'erlang:node().'作为默认命令，是典型的Erlang环境无害检测指令。从代码结构看，脚本使用了Lua的bin.pack和socket库手动封装SSH二进制流，逻辑清晰且符合SSH RFC文档规范。该POC并非完整的一键式利用脚本，因为它并未处理复杂的密钥交换加密过程，而是利用了某些Erland SSH实现中在加密协商初期对未认证通道处理不当的逻辑漏洞进行探测。如果服务器对这种非对称时序的通道请求返回了预期的响应（而非连接重置或忽略），则可判定漏洞存在。利用步骤：1. 确认目标系统运行着受影响版本的Erlang SSH服务；2. 攻击者向目标22端口发起TCP连接；3. 发送SSH版本标识字符串；4. 构造并发送包含受影响算法列表的KEXINIT报文；5. 在不调用身份验证报文的情况下，直接构造并发送Channel Open（session类型）报文；6. 紧随其后发送包含恶意命令（如erlang:os:cmd）的Channel Request报文；7. 服务器解析错误的协议状态，并在内部执行该命令。投毒风险分析：该POC脚本表现出极低的投毒风险。代码完全由透明的Lua脚本编写，主要依赖Nmap标准库（nmap, shortport, stdnse, bin, socket），没有引入任何外部二进制组件或经过混淆的Base64/十六进制字符串。分析过程中未发现'eval'、'os.execute'等敏感系统调用用于非法目的，所有的socket通信均严格限于与目标主机的漏洞探测。其功能仅限于漏洞存在性的判定，不包含任何将本地凭证、环境变量或系统敏感信息上传至第三方服务器的回连代码。作者'becrevex'在脚本分类中明确标记为'safe'和'discovery'，符合合法的漏洞扫描脚本规范。虽然该代码可被用于非法探测，但其本身作为代码载体是安全的，不存在针对分析人员工作环境的后门投毒行为。建议在使用前检查nmap环境的完整性，并确保在授权范围内进行扫描测试。

**项目地址:** [https://github.com/vulnwatchdog/cve-2025-32433-scanner](https://www.google.com/search?q=https://github.com/vulnwatchdog/cve-2025-32433-scanner)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32433](https://nvd.nist.gov/vuln/detail/CVE-2025-32433)
