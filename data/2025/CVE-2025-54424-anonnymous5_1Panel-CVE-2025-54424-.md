## CVE-2025-54424 - 1Panel 证书验证绕过/远程代码执行(RCE)

**漏洞编号:** CVE-2025-54424

**漏洞类型:** 证书验证绕过/远程代码执行(RCE)

**影响应用:** 1Panel

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** v2.0.5及以下版本

**利用条件:** 需要网络可达，Agent组件暴露在公网或内网可访问环境，无需初始认证凭据

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：该POC针对1Panel管理面板Agent组件的TLS证书验证绕过漏洞进行了针对性实现。漏洞核心在于Agent在处理来自客户端的HTTPS请求时，未能对双向TLS（mTLS）证书进行严格的合法性校验。POC通过`cryptography`库动态生成一个Common Name (CN) 为 'panel_client' 的自签名伪造证书。由于服务端代码逻辑缺陷，仅通过证书的CN字段识别身份而未校验签发链，攻击者可以利用此伪造证书通过身份验证。POC展示了两步利用流程：第一步利用`requests`库携带伪造证书访问`/api/v2/dashboard/base/os`接口进行预检，验证证书是否被接受；第二步则是通过`websocket`库建立加密连接，利用该特权通道执行系统命令。此代码结构清晰，依赖项明确，逻辑符合1Panel Agent的通信协议，具有极高的利用成功率。在防御性测试中，该POC能有效验证资产是否存在由于证书校验配置不当导致的未授权访问风险。利用步骤：1. 攻击者在本地环境安装必要的Python依赖（requests, cryptography, websocket-client）；2. 运行脚本并指定目标1Panel Agent的IP和端口；3. 脚本自动调用`generate_self_signed_cert`函数，生成满足服务端硬编码校验规则（如CN=panel_client）的自签名证书文件；4. 脚本发起HTTPS GET请求，携带上述伪造证书尝试访问管理API；5. 若响应成功，脚本将尝试升级协议至WebSocket，通过该隧道发送特定格式的JSON指令以触发远程命令执行。投毒风险分析：经过对提供的POC源码进行深度静态审计，未发现明显的投毒行为。代码中使用了标准的第三方库如`cryptography`处理加解密，`requests`和`websocket`处理通信，均属于合规的渗透测试工具范畴。生成的证书存储在系统临时目录（`tempfile.NamedTemporaryFile`），并在逻辑中尝试进行环境清理，表现出良好的开发规范。虽然代码包含攻击载荷构造，但这属于POC功能的必要组成部分，而非针对执行者机器的恶意行为。代码中不存在`eval()`、混淆加密、反弹Shell到第三方域名、敏感信息上传（如环境变量、SSH密钥抓取）等典型投毒特征。唯一的外部通信仅指向用户输入的`target_host`。然而，作为安全研究员，仍需警惕此类脚本在分发过程中被他人二次修改添加恶意代码。目前该版本风险极低，可安全用于实验室环境的漏洞复现与防御加固测试。建议在隔离环境运行，并监控脚本产生的网络流量。

**项目地址:** 未在搜索结果中提供具体项目URL

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-54424](https://nvd.nist.gov/vuln/detail/CVE-2025-54424)
