## CVE-2025-54424 - 1Panel (Agent 端) RCE

**漏洞编号:** CVE-2025-54424

**漏洞类型:** RCE

**影响应用:** 1Panel (Agent 端)

**危害等级:** 严重 (Critical)

**CVSS评分:** 9.8

**影响版本:** 1Panel v2.0.0 - v2.0.5 (专业版 Agent 架构)

**利用条件:** 目标系统开启了 1Panel Agent 服务的端口（通常为 HTTPS 通信），无需预先获取合法认证凭据，仅需网络可达。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

【POC有效性分析】该漏洞的核心在于 1Panel v2 版本引入的 Core-Agent 架构中，Agent 端在处理 TLS 握手时使用了错误的认证策略 `tls.RequireAnyClientCert`。这种策略虽然要求客户端提供证书，但并未对证书的签名来源进行校验证实，仅在应用层代码中检查了证书的 Common Name (CN) 字段是否为 'panel_client'。提供的 Python POC 代码完整展示了这一利用过程。代码首先通过 `cryptography` 库动态生成了一个自签名的 RSA 证书，并将其 CN 属性硬编码设置为 'panel_client'。随后，POC 使用该伪造证书发起 HTTPS 请求访问 Agent 的 API 接口。如果预检请求成功，POC 会进一步通过 WebSocket (wss) 协议建立连接，利用 Agent 提供的运维接口执行任意系统命令。此 POC 逻辑清晰，包含了证书生成、身份伪造、协议升级（WebSocket）和指令下发等完整链条，经分析属于高度有效的自动化漏洞利用工具。【利用步骤】1. 攻击者扫描互联网上暴露的 1Panel Agent 服务端口。2. 使用 Python 脚本动态生成一对 Common Name 为 'panel_client' 的自签名 SSL/TLS 证书和私钥。3. 利用伪造的证书与目标 Agent 端口建立 HTTPS 连接，绕过身份验证。4. 通过加密信道向 API 接口（如 /api/v2/dashboard/base/os 或 WebSocket 接口）发送恶意构造的 JSON payload，其中包含欲执行的 Shell 命令。5. 目标 Agent 在系统权限下执行该命令并返回执行结果给攻击者。【投毒风险分析】在对此 POC 代码进行安全性审计后，认为其投毒风险较低。首先，代码依赖项均为 Python 标准库或主流安全库（如 requests, cryptography, websocket-client），未发现远程加载未知第三方脚本的逻辑。其次，代码逻辑透明，从证书生成到请求发送的流程均有明确的 print 提示，且未使用 `eval()`、`exec()` 或 Base64 混淆的恶意 Payload。代码中的 base64 模块仅用于正常的 Web 数据传输编码。脚本中虽然存在临时文件操作 `tempfile`，但其用途是存储生成的伪造证书以供 `requests` 调用，而非用于植入持久化后门。此外，未发现代码向开发者控制的第三方服务器发送受害者 IP 或敏感信息的行为。尽管如此，用户在运行此类涉及网络请求的 POC 时，仍应在沙箱或隔离的 VPS 环境中操作，防止针对攻击者自身的反向渗透风险。整体来看，该 POC 属于纯粹的安全研究代码，旨在演示认证绕过机制，而非恶意投毒样本。

**项目地址:** [https://github.com/Mr-xn/CVE-2025-54424](https://github.com/Mr-xn/CVE-2025-54424)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-54424](https://nvd.nist.gov/vuln/detail/CVE-2025-54424)
