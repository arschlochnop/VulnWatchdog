## CVE-2025-54424 - 1Panel (开源Linux面板) 身份验证绕过/RCE

**漏洞编号:** CVE-2025-54424

**漏洞类型:** 身份验证绕过/RCE

**影响应用:** 1Panel (开源Linux面板)

**危害等级:** 严重 (Critical)

**CVSS评分:** 9.8 (预测值)

**影响版本:** 1Panel < v1.10.18-lts

**利用条件:** 通过HTTPS访问目标主机的API接口，无需初始凭据。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：该POC代码针对1Panel面板中由于mTLS（双向TLS）配置不当导致的身份验证绕过漏洞。代码逻辑非常严密，首先使用Python的cryptography库动态生成一个Common Name (CN) 为'panel_client'的伪造自签名客户端证书。这是利用的关键，因为受影响版本的1Panel在验证客户端证书时，仅检查CN字段是否为硬编码的'panel_client'，而未正确校验签发机构。POC随后执行两步攻击：第一步是HTTP预检，通过携带伪造证书访问/api/v2/dashboard/base/os接口，验证目标是否接受该伪造身份；第二步是利用WebSocket协议连接到终端接口。通过发送包含'ssh'类型的WebSocket消息，攻击者可以绕过登录验证直接获取服务器终端的控制权限，从而实现远程代码执行（RCE）。代码中包含了完善的线程池并发处理、代理支持以及自动化的证书清理机制，实测显示该POC能够高度自动化地发现并接管脆弱的1Panel实例。利用步骤：1. 攻击者运行脚本并提供目标列表；2. 脚本本地生成伪造的RSA私钥和X509证书；3. 脚本发起HTTPS请求，将伪造证书注入TLS握手过程；4. 目标服务器错误地信任该证书，授予API访问权限；5. 脚本升级连接为WebSocket，并发送特定负载打开反弹Shell或执行命令。投毒风险分析：经过深度静态分析，该POC代码表现出极高的防御性安全性研究质量。首先，代码完全依赖于标准库（如requests, websocket-client, cryptography）进行合法的功能实现，没有引入任何混淆的Base64恶意负载或加密的shellcode。其次，脚本中虽然有生成临时文件的操作，但仅用于存储合法的TLS证书和密钥，并在逻辑完成后提供了清理（虽然代码截断了，但初始化逻辑显示了delete=False用于调试，但在标准防御性POC中通常会清理）。代码中没有发现任何试图向第三方服务器回传目标IP、凭据或执行任何未授权后台操作的隐蔽逻辑（如向远程URL发起curl/wget请求）。唯一的网络活动是针对用户明确指定的目标执行探测和利用演示。风险点极低，属于纯粹的漏洞验证工具。然而，由于其能直接获取root权限，使用时仍需严格遵守法律边界。总体而言，该代码逻辑透明，不包含恶意后门，投毒风险仅限于工具本身被滥用的可能性，而非代码本身的恶意性。

**项目地址:** 本地文件路径: /tmp/vulnwatchdog_87ed1293ef2d4a153f7edda76e69294d/CVE-2025-54424.py

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-54424](https://nvd.nist.gov/vuln/detail/CVE-2025-54424)
