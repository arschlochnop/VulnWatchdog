## CVE-2025-24813 - Apache Tomcat Remote Code Execution (RCE)

**漏洞编号:** CVE-2025-24813

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Apache Tomcat

**危害等级:** Critical

**CVSS评分:** Unknown

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98, 8.5.0 through 8.5.100

**利用条件:** Unauthenticated network access

**POC 可用性:** 8/10

**POC 类型:** Complete exploit

**攻击复杂度:** Low

**投毒风险:** 15%

## 详情

CVE-2025-24813 is a critical security vulnerability in Apache Tomcat that allows for unauthenticated remote code execution (RCE). This vulnerability stems from improper handling of partial PUT requests. The provided Python POC script, CVE-2025-24813-Scanner.py, effectively tests for this vulnerability. 

The POC script first sends a PUT request to create a session file on the target Tomcat server. This is achieved by sending a crafted PUT request to the server, attempting to write a session file using a specific session ID. The script then checks the response status code to determine if the PUT request was successful. If the status code indicates success (200, 201, or 204), it proceeds to the next step. Subsequently, the script sends a GET request to the same server, attempting to access the created session file using the same session ID. This GET request is designed to trigger the vulnerability if it exists. If the server returns a 500 error, it signifies that the vulnerability is present, and the target is flagged as vulnerable. The script uses the 'requests' library to send HTTP requests and the 'colorama' library to provide colored output for better readability. It also incorporates multithreading to scan multiple targets concurrently.

The script attempts to create a session file and then access it to trigger a server error, which indicates vulnerability. The initial PUT request tries to upload a serialized Java object, while the subsequent GET request attempts to execute it within the Tomcat server's context. The vulnerability exists because Tomcat incorrectly handles these partial PUT requests, allowing attackers to potentially overwrite existing session data or execute arbitrary code.

To exploit this vulnerability, an attacker would first send a malicious PUT request to create or modify a session file on the target Tomcat server. This request would contain a payload designed to execute arbitrary code when the session file is accessed. Then, the attacker would send a GET request to trigger the processing of the malicious session file, leading to code execution on the server. This could allow the attacker to gain complete control over the affected Tomcat server.

**投毒风险分析:**
The provided POC code itself poses a low poisoning risk. It primarily uses standard Python libraries such as 'requests', 'argparse', 'sys', 'pandas', 'colorama', 'threading', 'queue', and 'time'. There are no immediately obvious signs of malicious intent or obfuscation. The script's functionality is focused on sending HTTP requests and analyzing the responses to detect the vulnerability. 

However, the script does use `verify=False` in the requests, which disables SSL certificate verification. While this might be necessary in some testing environments, it also introduces a potential security risk by making the script susceptible to man-in-the-middle attacks. An attacker could intercept the requests and inject malicious code into the responses, potentially compromising the system running the script. The use of a dummy payload `b"\xac\xed\x00\x05sr\x00\x11java.lang.String"` also requires careful consideration. While it seems benign in the context of the PoC, an attacker could replace this with a more malicious payload designed to exploit other vulnerabilities or perform harmful actions if the script is modified or used in a different context.

Therefore, while the base script itself is relatively safe, users should exercise caution and be aware of the potential risks associated with disabling SSL verification and the possibility of malicious payload injection. Modifying the script or using it in untrusted environments could increase the poisoning risk. Overall, the poisoning risk is estimated to be around 15% due to the use of `verify=False` and the potential for malicious payload substitution.

**项目地址:** https://github.com/randomseed1234/CVE-2025-24813-Scanner

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-24813
