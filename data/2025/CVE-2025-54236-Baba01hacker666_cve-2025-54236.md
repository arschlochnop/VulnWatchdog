## CVE-2025-54236 - Adobe Commerce / Magento Open Source 反序列化漏洞 (CWE-502)

**漏洞编号:** CVE-2025-54236

**漏洞类型:** 反序列化漏洞 (CWE-502)

**影响应用:** Adobe Commerce / Magento Open Source

**危害等级:** CRITICAL

**CVSS评分:** 9.1 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N)

**影响版本:** Adobe Commerce versions 2.4.9-alpha2, 2.4.8-p2, 2.4.7-p7, 2.4.6-p12, 2.4.5-p14, 2.4.4-p15 及更早版本

**利用条件:** 未经身份验证的远程网络访问，可通过 REST API 端点访问

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：本漏洞被称为“SessionReaper”，其核心原因在于 Adobe Commerce 的 `ServiceInputProcessor` 类在处理 REST API 请求时，未能对嵌套对象（如 `address` 中的 `region` 字段）进行严格的类型校验和安全过滤。攻击者可以通过向 `/rest/V1/guest-carts` 等端点发送精心构造的 JSON 请求，将恶意的 PHP 序列化字符串注入到原本预期为字符串或对象的字段中。由于 Magento 框架内集成了 `Laminas` 等第三方库，这些库中存在的 Gadget Chain（如 `Laminas\Http\Uri` 或 `Laminas\Filter\Decompress`）会被反序列化操作触发。提供的 POC 代码展示了两种利用路径：第一种是通过 YAML 定义的 Nuclei 模板，利用 DNSlog (interactsh) 进行带外数据探测（OAST），通过触发 `Laminas\Http\Uri` 的实例化来发起远程请求，验证漏洞存在性；第二种是 Python 脚本，尝试利用 `Laminas\Filter\Decompress` 结合 `system` 方法执行系统命令，这种方式在特定环境下可实现完全的远程代码执行（RCE）或账户接管。该 POC 逻辑清晰，利用点准确，具有极高的实战参考价值和复现成功率。利用步骤：1. 识别目标是否存在 Magento 环境及公开的 REST API 接口；2. 构造包含恶意序列化 payload 的 JSON 数据包，目标字段通常为 `address.region`；3. 使用 POST 方法向 `/rest/V1/guest-carts` 发送请求；4. 观察后端响应或带外服务器的连接请求以确认利用成功。投毒风险分析：经过对提供的代码段进行安全审计，未发现明显的恶意行为。Python 脚本中定义的 PAYLOAD `'O:24:"Laminas\\Filter\\Decompress":2:{s:7:"adapter";s:4:"Zlib";...}'` 属于标准的安全研究用 Gadget，旨在验证命令执行能力，而非窃取研究者本机的敏感信息。脚本中的 User-Agent 标记为 `BABA01HACKER-POC`，便于防御方进行流量溯源。尽管代码本身是安全的，但作为防御性研究员，仍需注意此类 POC 往往被用于武器化改造。目前的投毒风险评级为低（15%），主要风险点在于研究人员在使用此类 POC 时，若直接针对生产环境运行，可能导致服务不稳定或数据损坏。建议在隔离的沙箱环境中，配合 Burp Suite 或 Wireshark 监控网络出口流量，确保脚本没有隐藏的后连行为。代码库本身遵循了标准的漏洞报告逻辑，无混淆代码，无可疑的第三方库依赖，属于质量较高的安全研究资源。

**项目地址:** /tmp/vulnwatchdog_6daa432f6eb49022826962dfef9bd691/

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-54236](https://nvd.nist.gov/vuln/detail/CVE-2025-54236)
