## CVE-2025-54236 - Adobe Commerce, Magento Open Source RCE (不安全的反序列化)

**漏洞编号:** CVE-2025-54236

**漏洞类型:** RCE (不安全的反序列化)

**影响应用:** Adobe Commerce, Magento Open Source

**危害等级:** Critical

**CVSS评分:** 9.1 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N)

**影响版本:** Adobe Commerce 和 Magento Open Source 受影响版本（具体见 APSB25-88）

**利用条件:** 无需认证，可通过 REST API 接口远程访问

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞被称为“SessionReaper”，源于 Adobe Commerce 和 Magento 的 ServiceInputProcessor 类在处理 REST API 请求时，未能正确验证嵌套对象的类型，导致攻击者可以注入恶意的序列化字符串。POC代码展示了两个核心部分：一个是 Nuclei 模板形式的 yaml 文件，用于通过 OAST（带外应用安全测试）技术探测漏洞，利用 Laminas\\Http\\Uri 触发 DNS 请求以验证漏洞存在；另一个是 Python 脚本，展示了如何构造 POST 请求至 /rest/V1/guest-carts 接口。在 Python POC 中，通过在 address 对象的 region 字段注入 Laminas 反序列化 Gadget（如 Laminas\\Filter\\Decompress），理论上可以实现系统命令执行。该 POC 逻辑清晰，符合已知漏洞机理，具有较高的实战验证价值，但需要目标环境存在特定的 Gadget Chain 才能成功执行命令。利用步骤：1. 确定目标 Magento 站点的 REST API 路径。2. 构造 JSON 负载，在 address 对象的 region 属性中嵌入精心构造的 PHP 序列化字符串。3. 向 /rest/V1/guest-carts 发送 POST 请求。4. 观察服务器响应或通过 DNSLog/OAST 获取回调结果。投毒风险分析：该 POC 代码主要由标准的 Python requests 库和 Nuclei 语法构成，结构透明，未发现明显的恶意混淆或后门植入。脚本中的 User-Agent 包含 'BABA01HACKER-POC' 标识，便于防御方识别。尽管 README 中标注为 'not tested'，但其代码逻辑与官方披露的攻击向量吻合。风险点在于该 POC 引用了第三方 gadget，如果用户在未经审计的情况下从不可信源下载配套的 Payload 生成工具，可能面临风险。目前代码本身是安全的，属于防御性研究范畴，投毒风险较低，主要风险在于漏洞本身的极高危害性和易利用性。建议安全从业者在隔离环境中使用，并密切关注官方补丁更新。

**项目地址:** [https://github.com/holmquistc407/ai-tishici](https://github.com/holmquistc407/ai-tishici) (注：搜索结果暗示该代码可能在多个仓库流转)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-54236](https://nvd.nist.gov/vuln/detail/CVE-2025-54236)
