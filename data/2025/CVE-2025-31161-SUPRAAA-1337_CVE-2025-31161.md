# CVE-2025-31161

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-31161-0xDTC_CrushFTP-auth-bypass-CVE-2025-31161.md](../2025/CVE-2025-31161-0xDTC_CrushFTP-auth-bypass-CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP身份认证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份认证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 10.0.0 <= version < 10.8.4 and 11.0.0 <= version < 11.3.1

**利用条件:** 目标CrushFTP实例必须暴露在公网上，且未配置DMZ代理

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-31161 是 CrushFTP 10 和 11 版本中存在的一个关键身份验证绕过漏洞。未经身份验证的攻击者可以利用此漏洞接管 crushadmin 账户，从而完全控制系统。

**有效性：**
根据漏洞信息和搜索结果，此漏洞已经被野外利用。提供的 POC 代码旨在利用此漏洞，通过发送特制的 HTTP 请求绕过身份验证，进而列出现有用户或添加新用户。该POC提供了Go和Bash两种实现，增强了其有效性。

**投毒风险：**
该POC代码主要功能是利用漏洞进行用户枚举和添加用户。虽然没有明显的恶意代码植入，但任何利用漏洞的代码都可能被滥用。风险主要在于以下几点：

*   **滥用风险：** 该工具简化了漏洞利用过程，降低了攻击门槛，可能导致大规模攻击。
*   **依赖性风险：** Bash脚本依赖`curl`，Go脚本依赖Go环境。虽然常用，但如果攻击者修改脚本增加恶意依赖，则存在风险。
*   **更新滞后风险：** 如果 CrushFTP 发布补丁，但使用者未及时更新 POC 代码，可能导致利用失败或留下痕迹。
*   **信息泄露风险：** 使用`-lu`参数列出用户可能泄露信息，方便后续攻击。

综合来看，投毒风险较低，主要风险在于工具本身的利用，以及使用者是否保持更新。因此，评估投毒风险为5%。

**利用方式：**
1.  **漏洞原理：** 该漏洞基于 CrushFTP 中 HTTP 组件的 AWS4-HMAC 授权方法中的竞态条件和缺陷。服务器在验证用户时，首先调用 `login_user_pass()` 函数，无需密码即可验证用户是否存在。攻击者通过发送格式错误的 AWS4-HMAC 头部，可以绕过后续的用户验证，并导致代码索引越界错误，阻止会话清理。
2.  **利用步骤：**
    *   **用户枚举：** 使用 `-lu` 参数列出现有用户列表，例如：`go run cve-2025-31161.go -t example.com -lu`
    *   **添加用户：** 使用 `-au` 参数添加新用户（通常是管理员权限），例如：`go run cve-2025-31161.go -t example.com -au`，然后按照提示输入用户名和密码。
3.  **利用结果：** 成功利用漏洞后，攻击者可以创建任意用户，并通过该用户登录 CrushFTP 系统，执行任意操作，包括读取、修改、删除文件，以及执行系统命令。

**项目地址:** [0xDTC/CrushFTP-auth-bypass-CVE-2025-31161](https://github.com/0xDTC/CrushFTP-auth-bypass-CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #2

**来源**: [CVE-2025-31161-0xgh057r3c0n_CVE-2025-31161.md](../2025/CVE-2025-31161-0xgh057r3c0n_CVE-2025-31161.md)

## CVE-2025-31161 - CrushFTP Authentication Bypass and User Creation Exploit

**漏洞编号:** CVE-2025-31161

**漏洞类型:** Authentication Bypass

**影响应用:** CrushFTP

**危害等级:** 高危，可导致完全服务器控制

**影响版本:** 10 before 10.8.4, 11 before 11.3.1

**利用条件:** 目标 CrushFTP 实例必须未应用补丁且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-31161 是 CrushFTP 中的一个身份验证绕过漏洞，允许未经身份验证的攻击者创建新的管理用户并完全控制服务器。根据漏洞库信息和搜索结果，该漏洞已被积极利用。漏洞利用代码 `README.md` 描述了一个 Python 脚本，该脚本通过发送特制的 XML payload 到 WebInterface 来创建一个新的管理员用户。该脚本需要 `requests` 和 `colorama` 库。 

**有效性:**

根据漏洞库信息、搜索引擎结果（特别是 Huntress 的博客）以及漏洞利用代码中的描述，可以确认该漏洞是有效的，并且已经被在野利用。该漏洞利用代码似乎实现了利用漏洞创建用户的过程。

**投毒风险:**

分析提供的代码，该漏洞利用代码主要由一个 `README.md` 文件组成，其中描述了如何使用一个名为 `CVE-2025-31161.py` 的Python脚本来利用该漏洞。目前只提供了 `README.md` 文件的内容,无法确定脚本本身是否携带恶意代码。根据作者声明此工具仅用于授权安全测试目的。投毒风险评估为 10%，因为在缺少实际可执行的 Python 脚本情况下, 仅能推测存在隐藏恶意行为的可能性。如果Python脚本内容包含远程下载恶意 payload 或者执行其他恶意操作的代码，那么投毒的风险会更高，但根据现有的信息，只能初步评估为较低的风险。

**利用方式:**

利用方式是向 CrushFTP WebInterface 发送特制的 XML payload 来创建一个新的用户账户（通常是管理员权限）。成功创建账户后，攻击者就可以使用新账户登录并完全控制服务器。具体步骤如下：

1.  **准备:** 安装Python环境和所需的依赖库 (`requests`, `colorama`)。
2.  **配置:** 根据目标 CrushFTP 实例的 IP 地址、端口和想要创建的用户名、密码等信息配置漏洞利用脚本。
3.  **执行:** 运行漏洞利用脚本，脚本会发送特制的 HTTP 请求到目标服务器。
4.  **控制:** 如果漏洞利用成功，使用新创建的用户凭据登录 CrushFTP 管理界面，并获取对服务器的完全控制权。

根据 Censys 的数据，存在大量暴露在外的 CrushFTP 实例，其中一部分存在该漏洞，使得该漏洞具有较高的潜在影响。

**项目地址:** [0xgh057r3c0n/CVE-2025-31161](https://github.com/0xgh057r3c0n/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #3

**来源**: [CVE-2025-31161-B1ack4sh_Blackash-CVE-2025-31161.md](../2025/CVE-2025-31161-B1ack4sh_Blackash-CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP-认证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 认证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可导致完全控制系统

**影响版本:** 10 < 10.8.4, 11 < 11.3.1

**利用条件:** 需要目标CrushFTP实例可以通过HTTP(S)访问，且未启用DMZ代理

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-31161是CrushFTP 10（10.8.4之前）和11（11.3.1之前）版本中存在的一个认证绕过漏洞。该漏洞允许未经身份验证的攻击者绕过身份验证并接管crushadmin帐户，除非使用了DMZ代理实例。漏洞利用涉及利用AWS4-HMAC授权方法中的竞争条件或通过发送损坏的AWS4-HMAC标头来稳定地绕过身份验证。POC代码通过发送包含用户名和一个斜杠（/）的恶意构造的AWS4-HMAC请求，触发服务器端的index-out-of-bounds错误，阻止服务器执行会话清理，从而允许攻击者以任何已知或可猜测的用户身份进行身份验证。利用方式如下：

1.  **发送带有恶意构造的Authorization header的HTTP请求：** 该请求模仿AWS4-HMAC身份验证，但故意省略或篡改某些字段。具体来说，`Credential`字段只包含用户名和一个斜杠，例如 `Credential=crushadmin/`。
2.  **绕过身份验证检查：** 由于构造的请求，服务器在初步的用户验证阶段会成功找到用户名，触发身份验证过程。但后续对`SignedHeaders`的检查会失败，导致 index-out-of-bounds 错误。
3.  **创建新用户：**  利用绕过的身份验证，攻击者发送一个POST请求到`/WebInterface/function/`，包含`setUserItem`命令，以及新用户的XML配置信息，从而创建一个具有管理员权限的新用户。

**有效性：** 根据提供的漏洞信息和搜索引擎结果，该POC代码很可能有效。CVE已被广泛报道，并有证据表明该漏洞已被实际利用。

**投毒风险：** 风险较低 (5%)，尽管无法完全排除。POC代码相对简单，主要功能是利用漏洞创建新用户。但需要注意的是以下几点：
    *   **依赖项：** 该脚本依赖于`requests`库，如果通过`requirements.txt`文件安装依赖，可能会存在通过恶意依赖进行投毒的风险，不过这里直接提供了代码，风险降低。
    *   **目标账户：** 脚本默认针对`crushadmin`账户，如果攻击者修改脚本针对其他账户，可能会造成拒绝服务或权限提升。
    *   **后门植入：** 理论上，作者可以在创建新用户的同时，添加额外的配置，例如植入后门或修改现有用户的权限，但提供的代码中没有发现此类行为。
    *  **网络风险:** 代码需要通过网络连接到目标，存在被中间人攻击的风险

总体而言，POC代码本身的投毒风险较低，但使用者需要注意代码的来源和潜在的风险，并在安全的环境中进行测试。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-31161](https://github.com/B1ack4sh/Blackash-CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #4

**来源**: [CVE-2025-31161-Immersive-Labs-Sec_CVE-2025-31161.md](../2025/CVE-2025-31161-Immersive-Labs-Sec_CVE-2025-31161.md)

## CVE-2025-31161 - CrushFTP 身份验证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统接管

**影响版本:** CrushFTP 10 (10.0 - 10.8.3) 和 CrushFTP 11 (11.0 - 11.3.0)

**利用条件:** 目标 CrushFTP 实例未配置 DMZ 代理

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许未经身份验证的攻击者绕过身份验证并接管 crushadmin 帐户，从而完全控制系统。漏洞利用方式主要有两种：一种是利用 AWS4-HMAC 授权方法中的竞争条件，另一种是发送篡改过的 AWS4-HMAC 标头。POC 代码利用第二种方式，通过提供用户名和一个斜杠（/），服务器会成功找到用户名，但随后无法找到预期的 SignedHeaders 条目，导致索引超出范围错误，从而阻止代码到达会话清理步骤，实现身份验证绕过。POC 脚本创建了一个新的管理员用户。该漏洞利用的有效性高，因为漏洞库信息和搜索引擎结果都表明该漏洞已在野外被积极利用。代码本身未发现明显的投毒代码，该仓库的LICENSE使用的MIT许可，且逻辑较为清晰，主要功能是创建用户，因此投毒风险评估为0%。

**利用方式:**

1.  **身份验证绕过:** 通过构造特定的 HTTP 请求，绕过 CrushFTP 的身份验证机制，模拟成已有用户（通常是`crushadmin`）。
2.  **创建管理员账户:**  绕过身份验证后，利用服务器的管理功能，创建一个新的具有管理员权限的用户账户。
3.  **完全控制系统:** 使用新创建的管理员账户登录，获取对 CrushFTP 服务器的完全控制权，包括文件访问、用户管理等。

**项目地址:** [Immersive-Labs-Sec/CVE-2025-31161](https://github.com/Immersive-Labs-Sec/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #5

**来源**: [CVE-2025-31161-SUPRAAA-1337_CVE-2025-31161.md](../2025/CVE-2025-31161-SUPRAAA-1337_CVE-2025-31161.md)

# CVE-2025-31161

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-31161-0xDTC_CrushFTP-auth-bypass-CVE-2025-31161.md](../2025/CVE-2025-31161-0xDTC_CrushFTP-auth-bypass-CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP身份认证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份认证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 10.0.0 <= version < 10.8.4 and 11.0.0 <= version < 11.3.1

**利用条件:** 目标CrushFTP实例必须暴露在公网上，且未配置DMZ代理

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-31161 是 CrushFTP 10 和 11 版本中存在的一个关键身份验证绕过漏洞。未经身份验证的攻击者可以利用此漏洞接管 crushadmin 账户，从而完全控制系统。

**有效性：**
根据漏洞信息和搜索结果，此漏洞已经被野外利用。提供的 POC 代码旨在利用此漏洞，通过发送特制的 HTTP 请求绕过身份验证，进而列出现有用户或添加新用户。该POC提供了Go和Bash两种实现，增强了其有效性。

**投毒风险：**
该POC代码主要功能是利用漏洞进行用户枚举和添加用户。虽然没有明显的恶意代码植入，但任何利用漏洞的代码都可能被滥用。风险主要在于以下几点：

*   **滥用风险：** 该工具简化了漏洞利用过程，降低了攻击门槛，可能导致大规模攻击。
*   **依赖性风险：** Bash脚本依赖`curl`，Go脚本依赖Go环境。虽然常用，但如果攻击者修改脚本增加恶意依赖，则存在风险。
*   **更新滞后风险：** 如果 CrushFTP 发布补丁，但使用者未及时更新 POC 代码，可能导致利用失败或留下痕迹。
*   **信息泄露风险：** 使用`-lu`参数列出用户可能泄露信息，方便后续攻击。

综合来看，投毒风险较低，主要风险在于工具本身的利用，以及使用者是否保持更新。因此，评估投毒风险为5%。

**利用方式：**
1.  **漏洞原理：** 该漏洞基于 CrushFTP 中 HTTP 组件的 AWS4-HMAC 授权方法中的竞态条件和缺陷。服务器在验证用户时，首先调用 `login_user_pass()` 函数，无需密码即可验证用户是否存在。攻击者通过发送格式错误的 AWS4-HMAC 头部，可以绕过后续的用户验证，并导致代码索引越界错误，阻止会话清理。
2.  **利用步骤：**
    *   **用户枚举：** 使用 `-lu` 参数列出现有用户列表，例如：`go run cve-2025-31161.go -t example.com -lu`
    *   **添加用户：** 使用 `-au` 参数添加新用户（通常是管理员权限），例如：`go run cve-2025-31161.go -t example.com -au`，然后按照提示输入用户名和密码。
3.  **利用结果：** 成功利用漏洞后，攻击者可以创建任意用户，并通过该用户登录 CrushFTP 系统，执行任意操作，包括读取、修改、删除文件，以及执行系统命令。

**项目地址:** [0xDTC/CrushFTP-auth-bypass-CVE-2025-31161](https://github.com/0xDTC/CrushFTP-auth-bypass-CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #2

**来源**: [CVE-2025-31161-0xgh057r3c0n_CVE-2025-31161.md](../2025/CVE-2025-31161-0xgh057r3c0n_CVE-2025-31161.md)

## CVE-2025-31161 - CrushFTP Authentication Bypass and User Creation Exploit

**漏洞编号:** CVE-2025-31161

**漏洞类型:** Authentication Bypass

**影响应用:** CrushFTP

**危害等级:** 高危，可导致完全服务器控制

**影响版本:** 10 before 10.8.4, 11 before 11.3.1

**利用条件:** 目标 CrushFTP 实例必须未应用补丁且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-31161 是 CrushFTP 中的一个身份验证绕过漏洞，允许未经身份验证的攻击者创建新的管理用户并完全控制服务器。根据漏洞库信息和搜索结果，该漏洞已被积极利用。漏洞利用代码 `README.md` 描述了一个 Python 脚本，该脚本通过发送特制的 XML payload 到 WebInterface 来创建一个新的管理员用户。该脚本需要 `requests` 和 `colorama` 库。 

**有效性:**

根据漏洞库信息、搜索引擎结果（特别是 Huntress 的博客）以及漏洞利用代码中的描述，可以确认该漏洞是有效的，并且已经被在野利用。该漏洞利用代码似乎实现了利用漏洞创建用户的过程。

**投毒风险:**

分析提供的代码，该漏洞利用代码主要由一个 `README.md` 文件组成，其中描述了如何使用一个名为 `CVE-2025-31161.py` 的Python脚本来利用该漏洞。目前只提供了 `README.md` 文件的内容,无法确定脚本本身是否携带恶意代码。根据作者声明此工具仅用于授权安全测试目的。投毒风险评估为 10%，因为在缺少实际可执行的 Python 脚本情况下, 仅能推测存在隐藏恶意行为的可能性。如果Python脚本内容包含远程下载恶意 payload 或者执行其他恶意操作的代码，那么投毒的风险会更高，但根据现有的信息，只能初步评估为较低的风险。

**利用方式:**

利用方式是向 CrushFTP WebInterface 发送特制的 XML payload 来创建一个新的用户账户（通常是管理员权限）。成功创建账户后，攻击者就可以使用新账户登录并完全控制服务器。具体步骤如下：

1.  **准备:** 安装Python环境和所需的依赖库 (`requests`, `colorama`)。
2.  **配置:** 根据目标 CrushFTP 实例的 IP 地址、端口和想要创建的用户名、密码等信息配置漏洞利用脚本。
3.  **执行:** 运行漏洞利用脚本，脚本会发送特制的 HTTP 请求到目标服务器。
4.  **控制:** 如果漏洞利用成功，使用新创建的用户凭据登录 CrushFTP 管理界面，并获取对服务器的完全控制权。

根据 Censys 的数据，存在大量暴露在外的 CrushFTP 实例，其中一部分存在该漏洞，使得该漏洞具有较高的潜在影响。

**项目地址:** [0xgh057r3c0n/CVE-2025-31161](https://github.com/0xgh057r3c0n/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #3

**来源**: [CVE-2025-31161-B1ack4sh_Blackash-CVE-2025-31161.md](../2025/CVE-2025-31161-B1ack4sh_Blackash-CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP-认证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 认证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可导致完全控制系统

**影响版本:** 10 < 10.8.4, 11 < 11.3.1

**利用条件:** 需要目标CrushFTP实例可以通过HTTP(S)访问，且未启用DMZ代理

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-31161是CrushFTP 10（10.8.4之前）和11（11.3.1之前）版本中存在的一个认证绕过漏洞。该漏洞允许未经身份验证的攻击者绕过身份验证并接管crushadmin帐户，除非使用了DMZ代理实例。漏洞利用涉及利用AWS4-HMAC授权方法中的竞争条件或通过发送损坏的AWS4-HMAC标头来稳定地绕过身份验证。POC代码通过发送包含用户名和一个斜杠（/）的恶意构造的AWS4-HMAC请求，触发服务器端的index-out-of-bounds错误，阻止服务器执行会话清理，从而允许攻击者以任何已知或可猜测的用户身份进行身份验证。利用方式如下：

1.  **发送带有恶意构造的Authorization header的HTTP请求：** 该请求模仿AWS4-HMAC身份验证，但故意省略或篡改某些字段。具体来说，`Credential`字段只包含用户名和一个斜杠，例如 `Credential=crushadmin/`。
2.  **绕过身份验证检查：** 由于构造的请求，服务器在初步的用户验证阶段会成功找到用户名，触发身份验证过程。但后续对`SignedHeaders`的检查会失败，导致 index-out-of-bounds 错误。
3.  **创建新用户：**  利用绕过的身份验证，攻击者发送一个POST请求到`/WebInterface/function/`，包含`setUserItem`命令，以及新用户的XML配置信息，从而创建一个具有管理员权限的新用户。

**有效性：** 根据提供的漏洞信息和搜索引擎结果，该POC代码很可能有效。CVE已被广泛报道，并有证据表明该漏洞已被实际利用。

**投毒风险：** 风险较低 (5%)，尽管无法完全排除。POC代码相对简单，主要功能是利用漏洞创建新用户。但需要注意的是以下几点：
    *   **依赖项：** 该脚本依赖于`requests`库，如果通过`requirements.txt`文件安装依赖，可能会存在通过恶意依赖进行投毒的风险，不过这里直接提供了代码，风险降低。
    *   **目标账户：** 脚本默认针对`crushadmin`账户，如果攻击者修改脚本针对其他账户，可能会造成拒绝服务或权限提升。
    *   **后门植入：** 理论上，作者可以在创建新用户的同时，添加额外的配置，例如植入后门或修改现有用户的权限，但提供的代码中没有发现此类行为。
    *  **网络风险:** 代码需要通过网络连接到目标，存在被中间人攻击的风险

总体而言，POC代码本身的投毒风险较低，但使用者需要注意代码的来源和潜在的风险，并在安全的环境中进行测试。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-31161](https://github.com/B1ack4sh/Blackash-CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #4

**来源**: [CVE-2025-31161-Immersive-Labs-Sec_CVE-2025-31161.md](../2025/CVE-2025-31161-Immersive-Labs-Sec_CVE-2025-31161.md)

## CVE-2025-31161 - CrushFTP 身份验证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统接管

**影响版本:** CrushFTP 10 (10.0 - 10.8.3) 和 CrushFTP 11 (11.0 - 11.3.0)

**利用条件:** 目标 CrushFTP 实例未配置 DMZ 代理

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许未经身份验证的攻击者绕过身份验证并接管 crushadmin 帐户，从而完全控制系统。漏洞利用方式主要有两种：一种是利用 AWS4-HMAC 授权方法中的竞争条件，另一种是发送篡改过的 AWS4-HMAC 标头。POC 代码利用第二种方式，通过提供用户名和一个斜杠（/），服务器会成功找到用户名，但随后无法找到预期的 SignedHeaders 条目，导致索引超出范围错误，从而阻止代码到达会话清理步骤，实现身份验证绕过。POC 脚本创建了一个新的管理员用户。该漏洞利用的有效性高，因为漏洞库信息和搜索引擎结果都表明该漏洞已在野外被积极利用。代码本身未发现明显的投毒代码，该仓库的LICENSE使用的MIT许可，且逻辑较为清晰，主要功能是创建用户，因此投毒风险评估为0%。

**利用方式:**

1.  **身份验证绕过:** 通过构造特定的 HTTP 请求，绕过 CrushFTP 的身份验证机制，模拟成已有用户（通常是`crushadmin`）。
2.  **创建管理员账户:**  绕过身份验证后，利用服务器的管理功能，创建一个新的具有管理员权限的用户账户。
3.  **完全控制系统:** 使用新创建的管理员账户登录，获取对 CrushFTP 服务器的完全控制权，包括文件访问、用户管理等。

**项目地址:** [Immersive-Labs-Sec/CVE-2025-31161](https://github.com/Immersive-Labs-Sec/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #5

**来源**: [CVE-2025-31161-SUPRAAA-1337_CVE-2025-31161.md](../2025/CVE-2025-31161-SUPRAAA-1337_CVE-2025-31161.md)

# CVE-2025-31161

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-31161-0xDTC_CrushFTP-auth-bypass-CVE-2025-31161.md](../2025/CVE-2025-31161-0xDTC_CrushFTP-auth-bypass-CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP身份认证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份认证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 10.0.0 <= version < 10.8.4 and 11.0.0 <= version < 11.3.1

**利用条件:** 目标CrushFTP实例必须暴露在公网上，且未配置DMZ代理

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-31161 是 CrushFTP 10 和 11 版本中存在的一个关键身份验证绕过漏洞。未经身份验证的攻击者可以利用此漏洞接管 crushadmin 账户，从而完全控制系统。

**有效性：**
根据漏洞信息和搜索结果，此漏洞已经被野外利用。提供的 POC 代码旨在利用此漏洞，通过发送特制的 HTTP 请求绕过身份验证，进而列出现有用户或添加新用户。该POC提供了Go和Bash两种实现，增强了其有效性。

**投毒风险：**
该POC代码主要功能是利用漏洞进行用户枚举和添加用户。虽然没有明显的恶意代码植入，但任何利用漏洞的代码都可能被滥用。风险主要在于以下几点：

*   **滥用风险：** 该工具简化了漏洞利用过程，降低了攻击门槛，可能导致大规模攻击。
*   **依赖性风险：** Bash脚本依赖`curl`，Go脚本依赖Go环境。虽然常用，但如果攻击者修改脚本增加恶意依赖，则存在风险。
*   **更新滞后风险：** 如果 CrushFTP 发布补丁，但使用者未及时更新 POC 代码，可能导致利用失败或留下痕迹。
*   **信息泄露风险：** 使用`-lu`参数列出用户可能泄露信息，方便后续攻击。

综合来看，投毒风险较低，主要风险在于工具本身的利用，以及使用者是否保持更新。因此，评估投毒风险为5%。

**利用方式：**
1.  **漏洞原理：** 该漏洞基于 CrushFTP 中 HTTP 组件的 AWS4-HMAC 授权方法中的竞态条件和缺陷。服务器在验证用户时，首先调用 `login_user_pass()` 函数，无需密码即可验证用户是否存在。攻击者通过发送格式错误的 AWS4-HMAC 头部，可以绕过后续的用户验证，并导致代码索引越界错误，阻止会话清理。
2.  **利用步骤：**
    *   **用户枚举：** 使用 `-lu` 参数列出现有用户列表，例如：`go run cve-2025-31161.go -t example.com -lu`
    *   **添加用户：** 使用 `-au` 参数添加新用户（通常是管理员权限），例如：`go run cve-2025-31161.go -t example.com -au`，然后按照提示输入用户名和密码。
3.  **利用结果：** 成功利用漏洞后，攻击者可以创建任意用户，并通过该用户登录 CrushFTP 系统，执行任意操作，包括读取、修改、删除文件，以及执行系统命令。

**项目地址:** [0xDTC/CrushFTP-auth-bypass-CVE-2025-31161](https://github.com/0xDTC/CrushFTP-auth-bypass-CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #2

**来源**: [CVE-2025-31161-0xgh057r3c0n_CVE-2025-31161.md](../2025/CVE-2025-31161-0xgh057r3c0n_CVE-2025-31161.md)

## CVE-2025-31161 - CrushFTP Authentication Bypass and User Creation Exploit

**漏洞编号:** CVE-2025-31161

**漏洞类型:** Authentication Bypass

**影响应用:** CrushFTP

**危害等级:** 高危，可导致完全服务器控制

**影响版本:** 10 before 10.8.4, 11 before 11.3.1

**利用条件:** 目标 CrushFTP 实例必须未应用补丁且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-31161 是 CrushFTP 中的一个身份验证绕过漏洞，允许未经身份验证的攻击者创建新的管理用户并完全控制服务器。根据漏洞库信息和搜索结果，该漏洞已被积极利用。漏洞利用代码 `README.md` 描述了一个 Python 脚本，该脚本通过发送特制的 XML payload 到 WebInterface 来创建一个新的管理员用户。该脚本需要 `requests` 和 `colorama` 库。 

**有效性:**

根据漏洞库信息、搜索引擎结果（特别是 Huntress 的博客）以及漏洞利用代码中的描述，可以确认该漏洞是有效的，并且已经被在野利用。该漏洞利用代码似乎实现了利用漏洞创建用户的过程。

**投毒风险:**

分析提供的代码，该漏洞利用代码主要由一个 `README.md` 文件组成，其中描述了如何使用一个名为 `CVE-2025-31161.py` 的Python脚本来利用该漏洞。目前只提供了 `README.md` 文件的内容,无法确定脚本本身是否携带恶意代码。根据作者声明此工具仅用于授权安全测试目的。投毒风险评估为 10%，因为在缺少实际可执行的 Python 脚本情况下, 仅能推测存在隐藏恶意行为的可能性。如果Python脚本内容包含远程下载恶意 payload 或者执行其他恶意操作的代码，那么投毒的风险会更高，但根据现有的信息，只能初步评估为较低的风险。

**利用方式:**

利用方式是向 CrushFTP WebInterface 发送特制的 XML payload 来创建一个新的用户账户（通常是管理员权限）。成功创建账户后，攻击者就可以使用新账户登录并完全控制服务器。具体步骤如下：

1.  **准备:** 安装Python环境和所需的依赖库 (`requests`, `colorama`)。
2.  **配置:** 根据目标 CrushFTP 实例的 IP 地址、端口和想要创建的用户名、密码等信息配置漏洞利用脚本。
3.  **执行:** 运行漏洞利用脚本，脚本会发送特制的 HTTP 请求到目标服务器。
4.  **控制:** 如果漏洞利用成功，使用新创建的用户凭据登录 CrushFTP 管理界面，并获取对服务器的完全控制权。

根据 Censys 的数据，存在大量暴露在外的 CrushFTP 实例，其中一部分存在该漏洞，使得该漏洞具有较高的潜在影响。

**项目地址:** [0xgh057r3c0n/CVE-2025-31161](https://github.com/0xgh057r3c0n/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #3

**来源**: [CVE-2025-31161-B1ack4sh_Blackash-CVE-2025-31161.md](../2025/CVE-2025-31161-B1ack4sh_Blackash-CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP-认证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 认证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可导致完全控制系统

**影响版本:** 10 < 10.8.4, 11 < 11.3.1

**利用条件:** 需要目标CrushFTP实例可以通过HTTP(S)访问，且未启用DMZ代理

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-31161是CrushFTP 10（10.8.4之前）和11（11.3.1之前）版本中存在的一个认证绕过漏洞。该漏洞允许未经身份验证的攻击者绕过身份验证并接管crushadmin帐户，除非使用了DMZ代理实例。漏洞利用涉及利用AWS4-HMAC授权方法中的竞争条件或通过发送损坏的AWS4-HMAC标头来稳定地绕过身份验证。POC代码通过发送包含用户名和一个斜杠（/）的恶意构造的AWS4-HMAC请求，触发服务器端的index-out-of-bounds错误，阻止服务器执行会话清理，从而允许攻击者以任何已知或可猜测的用户身份进行身份验证。利用方式如下：

1.  **发送带有恶意构造的Authorization header的HTTP请求：** 该请求模仿AWS4-HMAC身份验证，但故意省略或篡改某些字段。具体来说，`Credential`字段只包含用户名和一个斜杠，例如 `Credential=crushadmin/`。
2.  **绕过身份验证检查：** 由于构造的请求，服务器在初步的用户验证阶段会成功找到用户名，触发身份验证过程。但后续对`SignedHeaders`的检查会失败，导致 index-out-of-bounds 错误。
3.  **创建新用户：**  利用绕过的身份验证，攻击者发送一个POST请求到`/WebInterface/function/`，包含`setUserItem`命令，以及新用户的XML配置信息，从而创建一个具有管理员权限的新用户。

**有效性：** 根据提供的漏洞信息和搜索引擎结果，该POC代码很可能有效。CVE已被广泛报道，并有证据表明该漏洞已被实际利用。

**投毒风险：** 风险较低 (5%)，尽管无法完全排除。POC代码相对简单，主要功能是利用漏洞创建新用户。但需要注意的是以下几点：
    *   **依赖项：** 该脚本依赖于`requests`库，如果通过`requirements.txt`文件安装依赖，可能会存在通过恶意依赖进行投毒的风险，不过这里直接提供了代码，风险降低。
    *   **目标账户：** 脚本默认针对`crushadmin`账户，如果攻击者修改脚本针对其他账户，可能会造成拒绝服务或权限提升。
    *   **后门植入：** 理论上，作者可以在创建新用户的同时，添加额外的配置，例如植入后门或修改现有用户的权限，但提供的代码中没有发现此类行为。
    *  **网络风险:** 代码需要通过网络连接到目标，存在被中间人攻击的风险

总体而言，POC代码本身的投毒风险较低，但使用者需要注意代码的来源和潜在的风险，并在安全的环境中进行测试。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-31161](https://github.com/B1ack4sh/Blackash-CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #4

**来源**: [CVE-2025-31161-Immersive-Labs-Sec_CVE-2025-31161.md](../2025/CVE-2025-31161-Immersive-Labs-Sec_CVE-2025-31161.md)

## CVE-2025-31161 - CrushFTP 身份验证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统接管

**影响版本:** CrushFTP 10 (10.0 - 10.8.3) 和 CrushFTP 11 (11.0 - 11.3.0)

**利用条件:** 目标 CrushFTP 实例未配置 DMZ 代理

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许未经身份验证的攻击者绕过身份验证并接管 crushadmin 帐户，从而完全控制系统。漏洞利用方式主要有两种：一种是利用 AWS4-HMAC 授权方法中的竞争条件，另一种是发送篡改过的 AWS4-HMAC 标头。POC 代码利用第二种方式，通过提供用户名和一个斜杠（/），服务器会成功找到用户名，但随后无法找到预期的 SignedHeaders 条目，导致索引超出范围错误，从而阻止代码到达会话清理步骤，实现身份验证绕过。POC 脚本创建了一个新的管理员用户。该漏洞利用的有效性高，因为漏洞库信息和搜索引擎结果都表明该漏洞已在野外被积极利用。代码本身未发现明显的投毒代码，该仓库的LICENSE使用的MIT许可，且逻辑较为清晰，主要功能是创建用户，因此投毒风险评估为0%。

**利用方式:**

1.  **身份验证绕过:** 通过构造特定的 HTTP 请求，绕过 CrushFTP 的身份验证机制，模拟成已有用户（通常是`crushadmin`）。
2.  **创建管理员账户:**  绕过身份验证后，利用服务器的管理功能，创建一个新的具有管理员权限的用户账户。
3.  **完全控制系统:** 使用新创建的管理员账户登录，获取对 CrushFTP 服务器的完全控制权，包括文件访问、用户管理等。

**项目地址:** [Immersive-Labs-Sec/CVE-2025-31161](https://github.com/Immersive-Labs-Sec/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #5

**来源**: [CVE-2025-31161-SUPRAAA-1337_CVE-2025-31161.md](../2025/CVE-2025-31161-SUPRAAA-1337_CVE-2025-31161.md)

# CVE-2025-31161

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-31161-0xDTC_CrushFTP-auth-bypass-CVE-2025-31161.md](../2025/CVE-2025-31161-0xDTC_CrushFTP-auth-bypass-CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP身份认证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份认证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 10.0.0 <= version < 10.8.4 and 11.0.0 <= version < 11.3.1

**利用条件:** 目标CrushFTP实例必须暴露在公网上，且未配置DMZ代理

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-31161 是 CrushFTP 10 和 11 版本中存在的一个关键身份验证绕过漏洞。未经身份验证的攻击者可以利用此漏洞接管 crushadmin 账户，从而完全控制系统。

**有效性：**
根据漏洞信息和搜索结果，此漏洞已经被野外利用。提供的 POC 代码旨在利用此漏洞，通过发送特制的 HTTP 请求绕过身份验证，进而列出现有用户或添加新用户。该POC提供了Go和Bash两种实现，增强了其有效性。

**投毒风险：**
该POC代码主要功能是利用漏洞进行用户枚举和添加用户。虽然没有明显的恶意代码植入，但任何利用漏洞的代码都可能被滥用。风险主要在于以下几点：

*   **滥用风险：** 该工具简化了漏洞利用过程，降低了攻击门槛，可能导致大规模攻击。
*   **依赖性风险：** Bash脚本依赖`curl`，Go脚本依赖Go环境。虽然常用，但如果攻击者修改脚本增加恶意依赖，则存在风险。
*   **更新滞后风险：** 如果 CrushFTP 发布补丁，但使用者未及时更新 POC 代码，可能导致利用失败或留下痕迹。
*   **信息泄露风险：** 使用`-lu`参数列出用户可能泄露信息，方便后续攻击。

综合来看，投毒风险较低，主要风险在于工具本身的利用，以及使用者是否保持更新。因此，评估投毒风险为5%。

**利用方式：**
1.  **漏洞原理：** 该漏洞基于 CrushFTP 中 HTTP 组件的 AWS4-HMAC 授权方法中的竞态条件和缺陷。服务器在验证用户时，首先调用 `login_user_pass()` 函数，无需密码即可验证用户是否存在。攻击者通过发送格式错误的 AWS4-HMAC 头部，可以绕过后续的用户验证，并导致代码索引越界错误，阻止会话清理。
2.  **利用步骤：**
    *   **用户枚举：** 使用 `-lu` 参数列出现有用户列表，例如：`go run cve-2025-31161.go -t example.com -lu`
    *   **添加用户：** 使用 `-au` 参数添加新用户（通常是管理员权限），例如：`go run cve-2025-31161.go -t example.com -au`，然后按照提示输入用户名和密码。
3.  **利用结果：** 成功利用漏洞后，攻击者可以创建任意用户，并通过该用户登录 CrushFTP 系统，执行任意操作，包括读取、修改、删除文件，以及执行系统命令。

**项目地址:** [0xDTC/CrushFTP-auth-bypass-CVE-2025-31161](https://github.com/0xDTC/CrushFTP-auth-bypass-CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #2

**来源**: [CVE-2025-31161-0xgh057r3c0n_CVE-2025-31161.md](../2025/CVE-2025-31161-0xgh057r3c0n_CVE-2025-31161.md)

## CVE-2025-31161 - CrushFTP Authentication Bypass and User Creation Exploit

**漏洞编号:** CVE-2025-31161

**漏洞类型:** Authentication Bypass

**影响应用:** CrushFTP

**危害等级:** 高危，可导致完全服务器控制

**影响版本:** 10 before 10.8.4, 11 before 11.3.1

**利用条件:** 目标 CrushFTP 实例必须未应用补丁且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-31161 是 CrushFTP 中的一个身份验证绕过漏洞，允许未经身份验证的攻击者创建新的管理用户并完全控制服务器。根据漏洞库信息和搜索结果，该漏洞已被积极利用。漏洞利用代码 `README.md` 描述了一个 Python 脚本，该脚本通过发送特制的 XML payload 到 WebInterface 来创建一个新的管理员用户。该脚本需要 `requests` 和 `colorama` 库。 

**有效性:**

根据漏洞库信息、搜索引擎结果（特别是 Huntress 的博客）以及漏洞利用代码中的描述，可以确认该漏洞是有效的，并且已经被在野利用。该漏洞利用代码似乎实现了利用漏洞创建用户的过程。

**投毒风险:**

分析提供的代码，该漏洞利用代码主要由一个 `README.md` 文件组成，其中描述了如何使用一个名为 `CVE-2025-31161.py` 的Python脚本来利用该漏洞。目前只提供了 `README.md` 文件的内容,无法确定脚本本身是否携带恶意代码。根据作者声明此工具仅用于授权安全测试目的。投毒风险评估为 10%，因为在缺少实际可执行的 Python 脚本情况下, 仅能推测存在隐藏恶意行为的可能性。如果Python脚本内容包含远程下载恶意 payload 或者执行其他恶意操作的代码，那么投毒的风险会更高，但根据现有的信息，只能初步评估为较低的风险。

**利用方式:**

利用方式是向 CrushFTP WebInterface 发送特制的 XML payload 来创建一个新的用户账户（通常是管理员权限）。成功创建账户后，攻击者就可以使用新账户登录并完全控制服务器。具体步骤如下：

1.  **准备:** 安装Python环境和所需的依赖库 (`requests`, `colorama`)。
2.  **配置:** 根据目标 CrushFTP 实例的 IP 地址、端口和想要创建的用户名、密码等信息配置漏洞利用脚本。
3.  **执行:** 运行漏洞利用脚本，脚本会发送特制的 HTTP 请求到目标服务器。
4.  **控制:** 如果漏洞利用成功，使用新创建的用户凭据登录 CrushFTP 管理界面，并获取对服务器的完全控制权。

根据 Censys 的数据，存在大量暴露在外的 CrushFTP 实例，其中一部分存在该漏洞，使得该漏洞具有较高的潜在影响。

**项目地址:** [0xgh057r3c0n/CVE-2025-31161](https://github.com/0xgh057r3c0n/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #3

**来源**: [CVE-2025-31161-B1ack4sh_Blackash-CVE-2025-31161.md](../2025/CVE-2025-31161-B1ack4sh_Blackash-CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP-认证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 认证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可导致完全控制系统

**影响版本:** 10 < 10.8.4, 11 < 11.3.1

**利用条件:** 需要目标CrushFTP实例可以通过HTTP(S)访问，且未启用DMZ代理

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-31161是CrushFTP 10（10.8.4之前）和11（11.3.1之前）版本中存在的一个认证绕过漏洞。该漏洞允许未经身份验证的攻击者绕过身份验证并接管crushadmin帐户，除非使用了DMZ代理实例。漏洞利用涉及利用AWS4-HMAC授权方法中的竞争条件或通过发送损坏的AWS4-HMAC标头来稳定地绕过身份验证。POC代码通过发送包含用户名和一个斜杠（/）的恶意构造的AWS4-HMAC请求，触发服务器端的index-out-of-bounds错误，阻止服务器执行会话清理，从而允许攻击者以任何已知或可猜测的用户身份进行身份验证。利用方式如下：

1.  **发送带有恶意构造的Authorization header的HTTP请求：** 该请求模仿AWS4-HMAC身份验证，但故意省略或篡改某些字段。具体来说，`Credential`字段只包含用户名和一个斜杠，例如 `Credential=crushadmin/`。
2.  **绕过身份验证检查：** 由于构造的请求，服务器在初步的用户验证阶段会成功找到用户名，触发身份验证过程。但后续对`SignedHeaders`的检查会失败，导致 index-out-of-bounds 错误。
3.  **创建新用户：**  利用绕过的身份验证，攻击者发送一个POST请求到`/WebInterface/function/`，包含`setUserItem`命令，以及新用户的XML配置信息，从而创建一个具有管理员权限的新用户。

**有效性：** 根据提供的漏洞信息和搜索引擎结果，该POC代码很可能有效。CVE已被广泛报道，并有证据表明该漏洞已被实际利用。

**投毒风险：** 风险较低 (5%)，尽管无法完全排除。POC代码相对简单，主要功能是利用漏洞创建新用户。但需要注意的是以下几点：
    *   **依赖项：** 该脚本依赖于`requests`库，如果通过`requirements.txt`文件安装依赖，可能会存在通过恶意依赖进行投毒的风险，不过这里直接提供了代码，风险降低。
    *   **目标账户：** 脚本默认针对`crushadmin`账户，如果攻击者修改脚本针对其他账户，可能会造成拒绝服务或权限提升。
    *   **后门植入：** 理论上，作者可以在创建新用户的同时，添加额外的配置，例如植入后门或修改现有用户的权限，但提供的代码中没有发现此类行为。
    *  **网络风险:** 代码需要通过网络连接到目标，存在被中间人攻击的风险

总体而言，POC代码本身的投毒风险较低，但使用者需要注意代码的来源和潜在的风险，并在安全的环境中进行测试。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-31161](https://github.com/B1ack4sh/Blackash-CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #4

**来源**: [CVE-2025-31161-Immersive-Labs-Sec_CVE-2025-31161.md](../2025/CVE-2025-31161-Immersive-Labs-Sec_CVE-2025-31161.md)

## CVE-2025-31161 - CrushFTP 身份验证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统接管

**影响版本:** CrushFTP 10 (10.0 - 10.8.3) 和 CrushFTP 11 (11.0 - 11.3.0)

**利用条件:** 目标 CrushFTP 实例未配置 DMZ 代理

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许未经身份验证的攻击者绕过身份验证并接管 crushadmin 帐户，从而完全控制系统。漏洞利用方式主要有两种：一种是利用 AWS4-HMAC 授权方法中的竞争条件，另一种是发送篡改过的 AWS4-HMAC 标头。POC 代码利用第二种方式，通过提供用户名和一个斜杠（/），服务器会成功找到用户名，但随后无法找到预期的 SignedHeaders 条目，导致索引超出范围错误，从而阻止代码到达会话清理步骤，实现身份验证绕过。POC 脚本创建了一个新的管理员用户。该漏洞利用的有效性高，因为漏洞库信息和搜索引擎结果都表明该漏洞已在野外被积极利用。代码本身未发现明显的投毒代码，该仓库的LICENSE使用的MIT许可，且逻辑较为清晰，主要功能是创建用户，因此投毒风险评估为0%。

**利用方式:**

1.  **身份验证绕过:** 通过构造特定的 HTTP 请求，绕过 CrushFTP 的身份验证机制，模拟成已有用户（通常是`crushadmin`）。
2.  **创建管理员账户:**  绕过身份验证后，利用服务器的管理功能，创建一个新的具有管理员权限的用户账户。
3.  **完全控制系统:** 使用新创建的管理员账户登录，获取对 CrushFTP 服务器的完全控制权，包括文件访问、用户管理等。

**项目地址:** [Immersive-Labs-Sec/CVE-2025-31161](https://github.com/Immersive-Labs-Sec/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #5

**来源**: [CVE-2025-31161-SUPRAAA-1337_CVE-2025-31161.md](../2025/CVE-2025-31161-SUPRAAA-1337_CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP认证绕过漏洞

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 认证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可完全控制系统

**影响版本:** 10 before 10.8.4, 11 before 11.3.1

**利用条件:** CrushFTP实例暴露在公网上，且未启用DMZ代理

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-31161是CrushFTP 10 (10.8.4之前) 和 11 (11.3.1之前) 版本中的一个认证绕过漏洞。根据漏洞描述，攻击者可以通过构造特定的HTTP请求，绕过身份验证，接管`crushadmin`账户，从而完全控制CrushFTP系统。漏洞利用涉及到AWS4-HMAC认证方式的缺陷，以及请求处理中的索引越界错误。提供的POC代码是一个简单的GET请求，用于检测目标是否存在`/WebInterface/function`路径，该路径的存在可能是存在漏洞的标志。但是这个POC本身并不是漏洞利用代码，而是一个检测脚本。根据搜索结果显示，该漏洞已经在野外被利用，并且存在公开的漏洞利用方法。漏洞利用方式包括两种：一种是利用AWS4-HMAC认证的竞态条件，另一种是通过修改AWS4-HMAC头部，导致服务器发生索引越界错误。由于提供的POC仅仅是一个检测脚本，没有执行恶意操作，因此不存在投毒风险。

**项目地址:** [SUPRAAA-1337/CVE-2025-31161](https://github.com/SUPRAAA-1337/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #6

**来源**: [CVE-2025-31161-SUPRAAA-1337_CVE-2025-31161_exploit.md](../2025/CVE-2025-31161-SUPRAAA-1337_CVE-2025-31161_exploit.md)

## CVE-2025-31161 CrushFTP Authentication Bypass

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统接管

**影响版本:** CrushFTP 10 before 10.8.4 和 CrushFTP 11 before 11.3.1

**利用条件:** 目标服务器未部署 DMZ 代理实例，并且开放 HTTP(S) 端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-31161 允许未经身份验证的远程攻击者绕过 CrushFTP 的身份验证，并可能接管 crushadmin 帐户。漏洞存在于AWS4-HMAC授权过程中，由于服务器在执行用户验证时存在竞争条件或可通过畸形的AWS4-HMAC头导致索引越界，从而允许攻击者使用任意用户名进行身份验证。POC代码（`python3 script.py -u http://example.com` 或 `python3 script.py -l urls.txt`）通过发送特制的请求来利用此漏洞。脚本将尝试访问 CrushFTP 服务器，并检查响应中是否包含 'crushadmin' 字符串，从而判断是否成功绕过身份验证。由于 `README.md` 仅仅给出了使用说明，并没有给出`script.py`的具体内容，因此存在一定投毒的风险，无法确定是否会在利用过程中执行恶意操作，例如植入后门或者修改系统配置。这里估计投毒的概率较低，因为脚本似乎只是用于检测漏洞是否存在，并将包含 'crushadmin' 的结果写入文件。但不能完全排除风险，例如URL文件被替换，恶意篡改等。

**项目地址:** [SUPRAAA-1337/CVE-2025-31161_exploit](https://github.com/SUPRAAA-1337/CVE-2025-31161_exploit)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #7

**来源**: [CVE-2025-31161-SUPRAAA-1337_Nuclei_CVE-2025-31161_CVE-2025-2825.md](../2025/CVE-2025-31161-SUPRAAA-1337_Nuclei_CVE-2025-31161_CVE-2025-2825.md)

## CVE-2025-31161 - CrushFTP Authentication Bypass

**漏洞编号:** CVE-2025-31161

**漏洞类型:** Authentication Bypass

**影响应用:** CrushFTP

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.0.0 <= version < 10.8.4 和 11.0.0 <= version < 11.3.1

**利用条件:** 目标CrushFTP服务器未部署DMZ代理，并且HTTP(S)端口对外开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码 (CVE-2025-2825.yaml)，可以评估此漏洞利用的有效性并分析利用方式。首先，CVE-2025-31161 允许未经身份验证的攻击者绕过身份验证，接管 crushadmin 帐户，从而完全控制 CrushFTP 服务器。提供的漏洞利用代码针对 CVE-2025-2825，虽然编号不同，但描述和影响的组件与 CVE-2025-31161 相同，根据securityweek.com的描述，这两个CVE针对的是同一个漏洞。该漏洞利用代码通过发送特制的 HTTP 请求，利用 AWS4-HMAC 认证过程中的缺陷。具体来说，通过在 Authorization 头部中只提供用户名（例如 crushadmin/）来绕过身份验证。服务器在验证用户存在时，会因为缺少 SignedHeaders 条目而发生 index-out-of-bounds 错误，阻止会话清理，从而允许攻击者以指定用户身份进行身份验证。该漏洞利用代码通过发送包含恶意 Authorization 头的 GET 请求来尝试获取用户列表，以此验证身份绕过是否成功。如果返回的 XML 包含 crushadmin 用户，则表明身份绕过成功。

**有效性：**根据多个信息来源表明，该漏洞已被积极利用，且漏洞利用代码能够有效绕过身份验证。提供的漏洞利用代码通过构造特定的HTTP请求，模拟未经授权的身份验证过程，从而验证目标是否存在漏洞。因此，该POC有效。

**投毒风险：** 在提供的漏洞利用代码中，没有明显的投毒代码。该YAML文件定义了HTTP请求的结构和匹配规则，没有发现任何执行恶意操作的后门或隐藏指令。所以，投毒风险为0%。

**利用方式：** 漏洞利用方式如下：
1.  攻击者向目标 CrushFTP 服务器发送特制的 HTTP 请求。
2.  该请求的 Authorization 头部包含 AWS4-HMAC-SHA256 Credential，但只包含用户名，例如 crushadmin/。
3.  由于服务器代码中的缺陷，攻击者可以绕过身份验证。
4.  攻击者可以执行管理员操作，例如获取用户列表，甚至接管整个服务器。

**排序优先级说明：**
在此次分析中，搜索引擎结果提供了关于漏洞已被利用的证据，以及受影响服务器的大致数量，优先级较高。漏洞利用代码本身提供了漏洞利用的技术细节，其次是漏洞库信息，它提供了漏洞的基本描述和受影响的版本信息。

**项目地址:** [SUPRAAA-1337/Nuclei_CVE-2025-31161_CVE-2025-2825](https://github.com/SUPRAAA-1337/Nuclei_CVE-2025-31161_CVE-2025-2825)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #8

**来源**: [CVE-2025-31161-TX-One_CVE-2025-31161.md](../2025/CVE-2025-31161-TX-One_CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP-认证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 认证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** 10 (低于 10.8.4) 和 11 (低于 11.3.1)

**利用条件:** 目标CrushFTP实例必须暴露在公网上或可访问的网络中，且未启用DMZ代理

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-31161是CrushFTP中的一个认证绕过漏洞。攻击者可以通过构造特殊的HTTP请求头，绕过身份验证，并以任意用户（例如 crushadmin）的身份登录。漏洞的根本原因是AWS4-HMAC认证机制中的竞态条件和不完善的错误处理。通过发送畸形的AWS4-HMAC头，攻击者可以触发服务器的index-out-of-bounds错误，阻止会话清理，从而成功进行身份验证。

**有效性分析：**

*   根据漏洞库信息，搜索引擎结果（尤其是huntress的博客）以及提供的漏洞利用代码，可以确定该漏洞真实存在且已被在野利用，POC代码具有实际的有效性。
*   POC代码的`README.md`文件描述了漏洞原理和利用方法，提供了详细的参数说明和使用示例。`tx-crush.py`文件实现了漏洞利用的完整流程，包括版本检测、用户枚举、身份验证绕过等功能。

**投毒风险分析：**

*   通过阅读`tx-crush.py`的代码，未发现明显的恶意代码或后门。该脚本主要功能是利用漏洞进行认证绕过，没有发现额外的网络扫描，敏感信息收集或修改系统设置的操作。
*   但仍需注意，任何未经授权的漏洞利用都可能造成安全风险。如果用户在使用此POC时连接了不可信的网络，或者使用了恶意构造的用户名列表，仍然可能导致安全问题。
*   此外，虽然脚本本身没有明显的投毒代码，但下载的第三方库可能存在潜在的风险。建议在使用前对所有依赖项进行安全审计。
*   基于以上分析，认为该POC代码存在1%的投毒风险，主要来自于可能被恶意修改或依赖的第三方库。

**利用方式分析：**

1.  **版本检测：** 脚本首先通过发送HEAD请求检测目标CrushFTP服务器的版本。
2.  **用户名枚举：**  攻击者需要提供一个包含用户名列表的文件，脚本会尝试使用这些用户名进行身份验证绕过。
3.  **认证绕过：** 脚本通过构造特殊的HTTP Authorization header，利用CrushFTP的AWS4-HMAC认证机制中的漏洞，绕过身份验证。
4.  **会话获取：** 如果认证绕过成功，脚本会提取服务器返回的sessionID cookie，用于后续的会话维持。
5.  **结果输出：**  脚本将利用结果以JSON格式输出到指定的文件中，包括目标URL、用户名、是否成功绕过、认证方法、sessionID cookie等信息。


**项目地址:** [TX-One/CVE-2025-31161](https://github.com/TX-One/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #9

**来源**: [CVE-2025-31161-Teexo_CVE-2025-31161.md](../2025/CVE-2025-31161-Teexo_CVE-2025-31161.md)

## CVE-2025-31161 CrushFTP Authentication Bypass

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 严重，可能导致完全系统接管

**影响版本:** 10.0.0 - 10.8.3, 11.0.0 - 11.3.0

**利用条件:** CrushFTP服务器必须在受影响版本范围内，且可通过HTTP(S)访问，非DMZ代理实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-31161 是 CrushFTP 中的一个身份验证绕过漏洞。攻击者可以通过构造畸形的 AWS4-HMAC 头部来绕过身份验证，从而以任何已知或可猜测的用户身份进行身份验证（例如 crushadmin），从而完全控制系统。漏洞存在于HTTP组件的AWS4-HMAC授权方法中，存在竞态条件，通过发送只包含用户名和斜杠的请求，服务器会成功找到用户名，但后续SignedHeaders验证失败，导致索引越界错误，阻止清理会话，从而绕过身份验证。

漏洞利用方式：
1.  向目标 CrushFTP 服务器发送特制的 HTTP 请求，该请求包含畸形的 AWS4-HMAC 头部，仅提供用户名和斜杠。
2.  服务器尝试使用提供的用户名进行身份验证，由于畸形的头部，身份验证过程中的某些检查会被绕过。
3.  攻击者成功以指定用户身份（如 crushadmin）进行身份验证。
4.  攻击者可以利用获得的管理员权限来执行任意操作，例如上传恶意文件、修改系统配置等，从而完全控制系统。

根据提供的POC代码，该代码是一个扫描器，用于检测目标是否存在CVE-2025-31161漏洞，而不是一个直接的利用工具。因此，投毒风险较低，主要集中在代码的扫描行为可能被用于恶意目的，如扫描大量目标进行信息收集。README.md中的`git clone https://github.com/yourusername/CVE-2025-31161.py`表明原始仓库可能并不存在，存在一定的钓鱼风险，诱导用户访问恶意仓库。

综合搜索结果，表明此漏洞已经在野外被利用，并且多个安全厂商提供了缓解措施和检测方法。

投毒风险分析：
* LICENSE文件声明了MIT许可，表明代码开源。
* README.md 文件描述了漏洞和使用方法，提示用户安装依赖`requirements.txt`。
* requirements.txt 文件中定义了requests和urllib3的版本要求，未发现恶意依赖。

可能的投毒点在于：
1.  作者可能在 CVE-2025-31161.py 文件中加入恶意代码，比如反弹shell，信息收集等。
2.  诱导用户访问恶意仓库，下载包含恶意代码的扫描器。

综合判断，该仓库本身投毒概率较低，但用户仍需谨慎分析 CVE-2025-31161.py 脚本，以及避免从不可信的来源下载工具，并且注意代码的潜在恶意行为。并且，该扫描器本身也可能被用于非授权的漏洞扫描。

**项目地址:** [Teexo/CVE-2025-31161](https://github.com/Teexo/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #10

**来源**: [CVE-2025-31161-acan0007_CVE-2025-31161.md](../2025/CVE-2025-31161-acan0007_CVE-2025-31161.md)

## CVE-2025-31161 - CrushFTP身份验证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统权限被获取

**影响版本:** 10.0.0 - 10.8.3 和 11.0.0 - 11.3.0

**利用条件:** 目标CrushFTP服务器的HTTP(S)端口可公开访问，且未使用DMZ代理实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-31161是一个影响CrushFTP 10版本（10.0.0到10.8.3）和11版本（11.0.0到11.3.0）的身份验证绕过漏洞。根据漏洞信息和搜索结果，攻击者可以通过构造特定的HTTP请求绕过身份验证，从而接管 crushadmin 账户，导致对系统的完全控制。

**有效性：**
漏洞库信息、搜索引擎结果均表明该漏洞已在野外被利用，并且提供了详细的漏洞描述。POC的存在进一步支持了该漏洞的有效性。虽然提供的POC仅仅包含一个README.md文件，但搜索结果中的参考链接（如Outpost24的博客）提供了关于漏洞利用的详细信息，包括构造恶意请求的细节。

**投毒风险：**
提供的POC代码（README.md）非常简单，只包含漏洞的名称和描述，没有可执行代码，因此不存在投毒风险。 投毒风险：0%。

**利用方式：**
根据漏洞描述，利用方式主要有两种：

1.  **竞争条件：** 通过AWS4-HMAC授权方法中的竞争条件，在服务器验证用户存在之后，服务器进行用户验证之前，利用时间差绕过身份验证。
2.  **Mangled AWS4-HMAC Header:** 通过发送损坏的AWS4-HMAC头，仅提供用户名和斜杠（/），触发服务器的 anypass 身份验证过程，并导致索引越界错误，从而阻止会话清理，允许以任意已知或可猜测的用户（如 crushadmin）进行身份验证。

总而言之，利用此漏洞无需任何身份验证即可访问系统，从而导致完全的系统破坏。

**项目地址:** [acan0007/CVE-2025-31161](https://github.com/acan0007/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #11

**来源**: [CVE-2025-31161-cesarbtakeda_CVE-2025-31161.md](../2025/CVE-2025-31161-cesarbtakeda_CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP-Authentication Bypass

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** CrushFTP 10 (before 10.8.4) and 11 (before 11.3.1)

**利用条件:** 需要网络访问CrushFTP服务器，且目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-31161 允许未经身份验证的攻击者绕过身份验证并接管 crushadmin 帐户 (除非使用 DMZ 代理实例)。此漏洞是由于 FTP 服务器的 HTTP 组件的 AWS4-HMAC 授权方法中存在竞争条件。服务器首先通过调用 login_user_pass() 验证用户的存在，而无需密码要求。通过发送篡改的 AWS4-HMAC 标头，可以进一步稳定该漏洞，从而无需成功触发竞争条件。通过仅提供用户名和后面的斜杠 (/)，服务器将成功找到用户名，从而触发成功的 anypass 身份验证过程，但服务器将无法找到预期的 SignedHeaders 条目，从而导致索引越界错误，从而阻止代码到达会话清理。总之，这些问题使得以任何已知或可猜测的用户（例如，crushadmin）进行身份验证变得非常容易，并且可能导致通过获得管理帐户来完全破坏系统。

**利用方式：**

1.  利用 AWS4-HMAC 授权中的漏洞，通过发送包含用户名和斜杠的畸形请求绕过身份验证。
2.  使用绕过的身份验证会话，通过 WebInterface/function/ 调用创建新的管理员用户或修改现有用户密码。
3.  如果目标是 crushadmin 帐户，则攻击者可以完全控制 CrushFTP 系统。

**关于PoC代码的有效性：**
提供的 PoC 代码 (exploit.c) 尝试利用此漏洞。它包含设置 HTTP 标头、构造 URL 以及使用 libcurl 执行 HTTP 请求的功能。漏洞利用尝试通过设置带有畸形 'Authorization' 标头的 Cookie 并向易受攻击的端点发送请求来利用身份验证绕过。

**关于投毒风险：**
风险较低，大约 5%。 虽然代码包含常见漏洞利用所需的网络功能（通过 libcurl），但其中未发现任何明显的恶意或不必要的操作，例如下载和执行任意二进制文件、修改系统文件或建立后门。代码相对简单，主要是为了演示身份验证绕过漏洞利用，而不是进行恶意活动。但存在一些风险，例如错误处理不当或意外崩溃，因此谨慎使用。

**项目地址:** [cesarbtakeda/CVE-2025-31161](https://github.com/cesarbtakeda/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #12

**来源**: [CVE-2025-31161-f4dee-backup_CVE-2025-31161.md](../2025/CVE-2025-31161-f4dee-backup_CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP-身份验证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** 10.0.0-10.8.3, 11.0.0-11.3.0

**利用条件:** 需要能通过HTTP(S)访问CrushFTP服务器

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-31161是一个影响CrushFTP的身份验证绕过漏洞，允许未经身份验证的远程攻击者在受影响的服务器上冒充任何用户，包括管理员crushadmin。

**有效性:**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断此漏洞是有效的。漏洞库信息明确指出该漏洞已在野外被利用。搜索引擎结果中包含多个安全厂商的分析报告和预警信息，证实了该漏洞的存在和危害。漏洞利用代码提供了一个自动化创建管理员用户的脚本，进一步验证了该漏洞的可利用性。

**投毒风险:**
对漏洞利用代码进行分析后，发现该脚本主要是通过构造特定的HTTP请求来利用CrushFTP的身份验证绕过漏洞。脚本首先生成一个伪造的`CrushAuth` token，然后利用此token发送恶意payload来创建一个新的管理员用户。脚本包含curl，shuf 依赖检测和安装语句，存在风险，但结合脚本逻辑，判断为正常功能，而非恶意投毒。综上所述，该脚本存在投毒的可能性较低。

**利用方式:**
1.  **目标确定:** 确定目标CrushFTP服务器的URL和端口。
2.  **参数设置:** 设置目标用户名(可以是现有或猜测的用户名，如crushadmin)，以及要创建的新用户名和密码。
3.  **脚本执行:** 运行提供的bash脚本，并传入目标URL、端口、目标用户名、新用户名和密码等参数。
4.  **身份验证绕过:** 脚本会利用CrushFTP的身份验证绕过漏洞，伪造一个有效的`CrushAuth` token。
5.  **用户创建:** 脚本会利用伪造的`CrushAuth` token发送一个HTTP请求，在CrushFTP服务器上创建一个新的管理员用户。
6.  **访问控制:** 使用新创建的管理员用户登录CrushFTP Web界面，从而完全控制系统。

**项目地址:** [f4dee-backup/CVE-2025-31161](https://github.com/f4dee-backup/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #13

**来源**: [CVE-2025-31161-ibrahimsql_CVE-2025-31161.md](../2025/CVE-2025-31161-ibrahimsql_CVE-2025-31161.md)

## CVE-2025-31161 CrushFTP 身份验证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** CrushFTP 10 before 10.8.4 and 11 before 11.3.1

**利用条件:** 目标 CrushFTP 服务器可通过 HTTP(S) 访问，且未部署 DMZ 代理实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-31161 是 CrushFTP 中 WebInterface 组件的一个严重身份验证绕过漏洞。未经身份验证的攻击者可以通过操纵特定的 cookie 和授权标头值来执行管理功能。

**漏洞利用方式:**

1.  **身份验证绕过:** 攻击者通过发送特制的 HTTP 请求，其中包含特定的 cookie 值 (`currentAuth=31If; CrushAuth=1744110584619_p38s3LvsGAfk4GvVu0vWtsEQEv31If`) 和授权标头 (`AWS4-HMAC-SHA256 Credential=crushadmin/`)，来绕过身份验证控制。
2.  **创建管理员账户:**  成功绕过身份验证后，攻击者可以利用用户管理功能创建一个新的管理员账户，从而获得对 CrushFTP 服务器的完全控制权限。

**投毒风险评估：**

虽然提供的漏洞利用代码看起来功能完善，但仍存在一定的投毒风险。具体来说，`requirements.txt` 文件中可能包含恶意依赖项，或者 `cve_2025_31161.py` 脚本本身可能包含隐藏的后门代码，例如数据窃取或远程代码执行功能。此外，截图`https://github.com/user-attachments/assets/c278226c-a5f8-452a-a1e8-96062b226dd7` 存在钓鱼风险,诱导用户点击恶意链接.虽然代码本身的功能是利用漏洞创建管理员用户,并不能直接判断为投毒代码,考虑到github账号创建时间,代码编写质量等原因综合评估投毒风险为10%。

**有效性:**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞利用代码是有效的。多个来源都证实了 CVE-2025-31161 漏洞的存在以及被实际利用的情况。提供的 POC 代码也给出了明确的利用方法，即通过构造特定的 HTTP 请求来绕过身份验证并创建新的管理员账户。但实际利用时，务必对代码进行审计，确保不存在恶意代码。

**项目地址:** [ibrahimsql/CVE-2025-31161](https://github.com/ibrahimsql/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #14

**来源**: [CVE-2025-31161-ibrahmsql_CVE-2025-31161.md](../2025/CVE-2025-31161-ibrahmsql_CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP-身份验证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致管理员权限获取，系统完全控制

**影响版本:** < 10.8.4 (CrushFTP 10), < 11.3.1 (CrushFTP 11)

**利用条件:** 需要网络访问CrushFTP服务，并且目标版本在受影响范围内，非DMZ代理实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-31161 存在于 CrushFTP 10 (版本低于 10.8.4) 和 11 (版本低于 11.3.1) 中。该漏洞允许未经身份验证的攻击者绕过身份验证并接管 crushadmin 帐户，除非使用了 DMZ 代理实例。该漏洞利用 AWS4-HMAC 授权方法中的竞争条件和头部解析缺陷。通过发送畸形的 AWS4-HMAC 头部，可以触发服务器的 index-out-of-bounds 错误，阻止会话清理，从而允许攻击者以任何已知或可猜测的用户（例如 crushadmin）身份进行身份验证，最终完全控制系统。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确定该漏洞的PoC代码是有效的。搜索引擎结果中有多篇文章提到该漏洞已被在野利用。PoC代码也描述了具体的利用方法。

**投毒风险：**

评估PoC代码后，存在一定的投毒风险。具体分析如下：

*   **代码结构：** 代码结构比较清晰，包含了常见的漏洞利用流程。但是，代码中仍然可能存在作者隐藏的恶意代码，例如：
    *   **未记录的远程连接：** 代码中可能包含未记录的远程连接功能，例如连接到特定的服务器以下载或上传数据。
    *   **恶意Payload：** 代码中可以嵌入恶意的Payload，例如用于执行系统命令或安装后门程序。
    *   **信息收集：** 代码可以收集目标系统的敏感信息，例如用户名、密码、IP地址等，并将这些信息发送给攻击者。

基于上述分析，我估计该PoC代码的投毒风险为10%。

**利用方式：**

1.  **目标确认：** 确定目标CrushFTP服务器的版本是否在受影响范围内（低于 10.8.4 (CrushFTP 10) 或低于 11.3.1 (CrushFTP 11)），并且未使用 DMZ 代理。
2.  **构造恶意请求：**  构造包含畸形的AWS4-HMAC头部的HTTP(S)请求。关键在于提供用户名，但是缺少或篡改SignedHeaders条目以触发index-out-of-bounds错误。
3.  **绕过身份验证：**  利用漏洞绕过身份验证，以 crushadmin 或其他已知用户身份登录。
4.  **控制系统：**  成功登录后，攻击者可以执行任意操作，包括上传恶意文件、修改配置、创建新用户等，从而完全控制 CrushFTP 服务器。

**项目地址:** [ibrahmsql/CVE-2025-31161](https://github.com/ibrahmsql/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #15

**来源**: [CVE-2025-31161-llussiess_CVE-2025-31161.md](../2025/CVE-2025-31161-llussiess_CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP身份验证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统接管

**影响版本:** 10 (10.0 - 10.8.3) 和 11 (11.0 - 11.3.0)

**利用条件:** 目标系统运行受影响版本的CrushFTP，且未启用DMZ代理

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码（仅包含README.md），分析如下：

**有效性：** 提供的POC代码仅仅包含一个README.md文件，没有实际的利用代码，因此无法直接验证漏洞的有效性。但是，漏洞库信息和搜索结果都表明该漏洞已在野外被利用，说明该漏洞是真实存在的。参考搜索结果[webpage 3]，Huntress公司观察到CVE-2025-31161 在野外被利用,验证该漏洞存在。

**投毒风险：** 提供的漏洞利用代码只包含一个README.md文件，其中仅包含CVE编号，没有发现任何恶意代码，因此投毒风险极低，评估为0%。

**利用方式：** 

1.  **漏洞概述：** CrushFTP 10 (10.0 - 10.8.3) 和 11 (11.0 - 11.3.0) 存在一个身份验证绕过漏洞，攻击者可以绕过身份验证并接管`crushadmin`账户（除非使用了DMZ代理实例）。
2.  **漏洞原理：** 漏洞的根源在于HTTP组件的AWS4-HMAC认证方法存在缺陷。服务器首先通过调用`login_user_pass()`验证用户是否存在，而不需要密码。攻击者可以通过发送带有用户名但缺少`SignedHeaders`条目的畸形AWS4-HMAC头部，触发索引越界错误，阻止会话清理，从而成功以任意已知或可猜测的用户（例如`crushadmin`）进行身份验证。参考漏洞库信息和搜索结果[webpage 4]。
3.  **利用步骤：** 
    *   构造一个畸形的AWS4-HMAC头部，只包含用户名和一个斜杠(`/`)。
    *   发送该头部到CrushFTP服务器。
    *   服务器会成功找到用户名，触发`anypass`身份验证过程。
    *   由于缺少`SignedHeaders`条目，服务器会发生索引越界错误，阻止会话清理。
    *   攻击者成功以指定用户身份登录。
4.  **缓解措施：** 升级CrushFTP到10.8.4或11.3.1及以上版本。参考漏洞库信息和搜索结果。

总之，该漏洞利用方式较为简单，危害严重，需要尽快修复。

**项目地址:** [llussiess/CVE-2025-31161](https://github.com/llussiess/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #16

**来源**: [CVE-2025-31161-r0otk3r_CVE-2025-31161.md](../2025/CVE-2025-31161-r0otk3r_CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP-认证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 认证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统权限控制

**影响版本:** 10.0.0 - 10.8.3 和 11.0.0 - 11.3.0

**利用条件:** CrushFTP服务需要通过HTTP(S)协议对外开放

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-31161 允许未经身份验证的攻击者绕过 CrushFTP 的身份验证，并接管 crushadmin 帐户（除非使用 DMZ 代理实例）。该漏洞利用了 HTTP 组件中 AWS4-HMAC (与 S3 兼容) 授权方法中的竞争条件。服务器首先调用 login_user_pass()，而无需密码，从而验证用户的存在。通过提供带有用户名和后缀斜杠（/）的伪造 AWS4-HMAC 标头，服务器可以成功找到用户名，从而触发 anypass 身份验证过程，但服务器将无法找到预期的 SignedHeaders 条目，从而导致索引越界错误，从而阻止代码到达会话清理。PoC 代码使用带有构造的 `CrushAuth` cookie 和 `Authorization` 标头的 GET 请求，通过 `/WebInterface/function/?command=getUserList&serverGroup=MainUsers` 端点获取用户列表，以证明认证绕过。由于其依赖于标准库并且没有执行任何可疑操作,投毒风险极低。

**项目地址:** [r0otk3r/CVE-2025-31161](https://github.com/r0otk3r/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---



---

## POC #6

**来源**: [CVE-2025-31161-SUPRAAA-1337_CVE-2025-31161_exploit.md](../2025/CVE-2025-31161-SUPRAAA-1337_CVE-2025-31161_exploit.md)

## CVE-2025-31161 CrushFTP Authentication Bypass

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统接管

**影响版本:** CrushFTP 10 before 10.8.4 和 CrushFTP 11 before 11.3.1

**利用条件:** 目标服务器未部署 DMZ 代理实例，并且开放 HTTP(S) 端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-31161 允许未经身份验证的远程攻击者绕过 CrushFTP 的身份验证，并可能接管 crushadmin 帐户。漏洞存在于AWS4-HMAC授权过程中，由于服务器在执行用户验证时存在竞争条件或可通过畸形的AWS4-HMAC头导致索引越界，从而允许攻击者使用任意用户名进行身份验证。POC代码（`python3 script.py -u http://example.com` 或 `python3 script.py -l urls.txt`）通过发送特制的请求来利用此漏洞。脚本将尝试访问 CrushFTP 服务器，并检查响应中是否包含 'crushadmin' 字符串，从而判断是否成功绕过身份验证。由于 `README.md` 仅仅给出了使用说明，并没有给出`script.py`的具体内容，因此存在一定投毒的风险，无法确定是否会在利用过程中执行恶意操作，例如植入后门或者修改系统配置。这里估计投毒的概率较低，因为脚本似乎只是用于检测漏洞是否存在，并将包含 'crushadmin' 的结果写入文件。但不能完全排除风险，例如URL文件被替换，恶意篡改等。

**项目地址:** [SUPRAAA-1337/CVE-2025-31161_exploit](https://github.com/SUPRAAA-1337/CVE-2025-31161_exploit)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #7

**来源**: [CVE-2025-31161-SUPRAAA-1337_Nuclei_CVE-2025-31161_CVE-2025-2825.md](../2025/CVE-2025-31161-SUPRAAA-1337_Nuclei_CVE-2025-31161_CVE-2025-2825.md)

## CVE-2025-31161 - CrushFTP Authentication Bypass

**漏洞编号:** CVE-2025-31161

**漏洞类型:** Authentication Bypass

**影响应用:** CrushFTP

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.0.0 <= version < 10.8.4 和 11.0.0 <= version < 11.3.1

**利用条件:** 目标CrushFTP服务器未部署DMZ代理，并且HTTP(S)端口对外开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码 (CVE-2025-2825.yaml)，可以评估此漏洞利用的有效性并分析利用方式。首先，CVE-2025-31161 允许未经身份验证的攻击者绕过身份验证，接管 crushadmin 帐户，从而完全控制 CrushFTP 服务器。提供的漏洞利用代码针对 CVE-2025-2825，虽然编号不同，但描述和影响的组件与 CVE-2025-31161 相同，根据securityweek.com的描述，这两个CVE针对的是同一个漏洞。该漏洞利用代码通过发送特制的 HTTP 请求，利用 AWS4-HMAC 认证过程中的缺陷。具体来说，通过在 Authorization 头部中只提供用户名（例如 crushadmin/）来绕过身份验证。服务器在验证用户存在时，会因为缺少 SignedHeaders 条目而发生 index-out-of-bounds 错误，阻止会话清理，从而允许攻击者以指定用户身份进行身份验证。该漏洞利用代码通过发送包含恶意 Authorization 头的 GET 请求来尝试获取用户列表，以此验证身份绕过是否成功。如果返回的 XML 包含 crushadmin 用户，则表明身份绕过成功。

**有效性：**根据多个信息来源表明，该漏洞已被积极利用，且漏洞利用代码能够有效绕过身份验证。提供的漏洞利用代码通过构造特定的HTTP请求，模拟未经授权的身份验证过程，从而验证目标是否存在漏洞。因此，该POC有效。

**投毒风险：** 在提供的漏洞利用代码中，没有明显的投毒代码。该YAML文件定义了HTTP请求的结构和匹配规则，没有发现任何执行恶意操作的后门或隐藏指令。所以，投毒风险为0%。

**利用方式：** 漏洞利用方式如下：
1.  攻击者向目标 CrushFTP 服务器发送特制的 HTTP 请求。
2.  该请求的 Authorization 头部包含 AWS4-HMAC-SHA256 Credential，但只包含用户名，例如 crushadmin/。
3.  由于服务器代码中的缺陷，攻击者可以绕过身份验证。
4.  攻击者可以执行管理员操作，例如获取用户列表，甚至接管整个服务器。

**排序优先级说明：**
在此次分析中，搜索引擎结果提供了关于漏洞已被利用的证据，以及受影响服务器的大致数量，优先级较高。漏洞利用代码本身提供了漏洞利用的技术细节，其次是漏洞库信息，它提供了漏洞的基本描述和受影响的版本信息。

**项目地址:** [SUPRAAA-1337/Nuclei_CVE-2025-31161_CVE-2025-2825](https://github.com/SUPRAAA-1337/Nuclei_CVE-2025-31161_CVE-2025-2825)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #8

**来源**: [CVE-2025-31161-TX-One_CVE-2025-31161.md](../2025/CVE-2025-31161-TX-One_CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP-认证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 认证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** 10 (低于 10.8.4) 和 11 (低于 11.3.1)

**利用条件:** 目标CrushFTP实例必须暴露在公网上或可访问的网络中，且未启用DMZ代理

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-31161是CrushFTP中的一个认证绕过漏洞。攻击者可以通过构造特殊的HTTP请求头，绕过身份验证，并以任意用户（例如 crushadmin）的身份登录。漏洞的根本原因是AWS4-HMAC认证机制中的竞态条件和不完善的错误处理。通过发送畸形的AWS4-HMAC头，攻击者可以触发服务器的index-out-of-bounds错误，阻止会话清理，从而成功进行身份验证。

**有效性分析：**

*   根据漏洞库信息，搜索引擎结果（尤其是huntress的博客）以及提供的漏洞利用代码，可以确定该漏洞真实存在且已被在野利用，POC代码具有实际的有效性。
*   POC代码的`README.md`文件描述了漏洞原理和利用方法，提供了详细的参数说明和使用示例。`tx-crush.py`文件实现了漏洞利用的完整流程，包括版本检测、用户枚举、身份验证绕过等功能。

**投毒风险分析：**

*   通过阅读`tx-crush.py`的代码，未发现明显的恶意代码或后门。该脚本主要功能是利用漏洞进行认证绕过，没有发现额外的网络扫描，敏感信息收集或修改系统设置的操作。
*   但仍需注意，任何未经授权的漏洞利用都可能造成安全风险。如果用户在使用此POC时连接了不可信的网络，或者使用了恶意构造的用户名列表，仍然可能导致安全问题。
*   此外，虽然脚本本身没有明显的投毒代码，但下载的第三方库可能存在潜在的风险。建议在使用前对所有依赖项进行安全审计。
*   基于以上分析，认为该POC代码存在1%的投毒风险，主要来自于可能被恶意修改或依赖的第三方库。

**利用方式分析：**

1.  **版本检测：** 脚本首先通过发送HEAD请求检测目标CrushFTP服务器的版本。
2.  **用户名枚举：**  攻击者需要提供一个包含用户名列表的文件，脚本会尝试使用这些用户名进行身份验证绕过。
3.  **认证绕过：** 脚本通过构造特殊的HTTP Authorization header，利用CrushFTP的AWS4-HMAC认证机制中的漏洞，绕过身份验证。
4.  **会话获取：** 如果认证绕过成功，脚本会提取服务器返回的sessionID cookie，用于后续的会话维持。
5.  **结果输出：**  脚本将利用结果以JSON格式输出到指定的文件中，包括目标URL、用户名、是否成功绕过、认证方法、sessionID cookie等信息。


**项目地址:** [TX-One/CVE-2025-31161](https://github.com/TX-One/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #9

**来源**: [CVE-2025-31161-Teexo_CVE-2025-31161.md](../2025/CVE-2025-31161-Teexo_CVE-2025-31161.md)

## CVE-2025-31161 CrushFTP Authentication Bypass

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 严重，可能导致完全系统接管

**影响版本:** 10.0.0 - 10.8.3, 11.0.0 - 11.3.0

**利用条件:** CrushFTP服务器必须在受影响版本范围内，且可通过HTTP(S)访问，非DMZ代理实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-31161 是 CrushFTP 中的一个身份验证绕过漏洞。攻击者可以通过构造畸形的 AWS4-HMAC 头部来绕过身份验证，从而以任何已知或可猜测的用户身份进行身份验证（例如 crushadmin），从而完全控制系统。漏洞存在于HTTP组件的AWS4-HMAC授权方法中，存在竞态条件，通过发送只包含用户名和斜杠的请求，服务器会成功找到用户名，但后续SignedHeaders验证失败，导致索引越界错误，阻止清理会话，从而绕过身份验证。

漏洞利用方式：
1.  向目标 CrushFTP 服务器发送特制的 HTTP 请求，该请求包含畸形的 AWS4-HMAC 头部，仅提供用户名和斜杠。
2.  服务器尝试使用提供的用户名进行身份验证，由于畸形的头部，身份验证过程中的某些检查会被绕过。
3.  攻击者成功以指定用户身份（如 crushadmin）进行身份验证。
4.  攻击者可以利用获得的管理员权限来执行任意操作，例如上传恶意文件、修改系统配置等，从而完全控制系统。

根据提供的POC代码，该代码是一个扫描器，用于检测目标是否存在CVE-2025-31161漏洞，而不是一个直接的利用工具。因此，投毒风险较低，主要集中在代码的扫描行为可能被用于恶意目的，如扫描大量目标进行信息收集。README.md中的`git clone https://github.com/yourusername/CVE-2025-31161.py`表明原始仓库可能并不存在，存在一定的钓鱼风险，诱导用户访问恶意仓库。

综合搜索结果，表明此漏洞已经在野外被利用，并且多个安全厂商提供了缓解措施和检测方法。

投毒风险分析：
* LICENSE文件声明了MIT许可，表明代码开源。
* README.md 文件描述了漏洞和使用方法，提示用户安装依赖`requirements.txt`。
* requirements.txt 文件中定义了requests和urllib3的版本要求，未发现恶意依赖。

可能的投毒点在于：
1.  作者可能在 CVE-2025-31161.py 文件中加入恶意代码，比如反弹shell，信息收集等。
2.  诱导用户访问恶意仓库，下载包含恶意代码的扫描器。

综合判断，该仓库本身投毒概率较低，但用户仍需谨慎分析 CVE-2025-31161.py 脚本，以及避免从不可信的来源下载工具，并且注意代码的潜在恶意行为。并且，该扫描器本身也可能被用于非授权的漏洞扫描。

**项目地址:** [Teexo/CVE-2025-31161](https://github.com/Teexo/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #10

**来源**: [CVE-2025-31161-acan0007_CVE-2025-31161.md](../2025/CVE-2025-31161-acan0007_CVE-2025-31161.md)

## CVE-2025-31161 - CrushFTP身份验证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统权限被获取

**影响版本:** 10.0.0 - 10.8.3 和 11.0.0 - 11.3.0

**利用条件:** 目标CrushFTP服务器的HTTP(S)端口可公开访问，且未使用DMZ代理实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-31161是一个影响CrushFTP 10版本（10.0.0到10.8.3）和11版本（11.0.0到11.3.0）的身份验证绕过漏洞。根据漏洞信息和搜索结果，攻击者可以通过构造特定的HTTP请求绕过身份验证，从而接管 crushadmin 账户，导致对系统的完全控制。

**有效性：**
漏洞库信息、搜索引擎结果均表明该漏洞已在野外被利用，并且提供了详细的漏洞描述。POC的存在进一步支持了该漏洞的有效性。虽然提供的POC仅仅包含一个README.md文件，但搜索结果中的参考链接（如Outpost24的博客）提供了关于漏洞利用的详细信息，包括构造恶意请求的细节。

**投毒风险：**
提供的POC代码（README.md）非常简单，只包含漏洞的名称和描述，没有可执行代码，因此不存在投毒风险。 投毒风险：0%。

**利用方式：**
根据漏洞描述，利用方式主要有两种：

1.  **竞争条件：** 通过AWS4-HMAC授权方法中的竞争条件，在服务器验证用户存在之后，服务器进行用户验证之前，利用时间差绕过身份验证。
2.  **Mangled AWS4-HMAC Header:** 通过发送损坏的AWS4-HMAC头，仅提供用户名和斜杠（/），触发服务器的 anypass 身份验证过程，并导致索引越界错误，从而阻止会话清理，允许以任意已知或可猜测的用户（如 crushadmin）进行身份验证。

总而言之，利用此漏洞无需任何身份验证即可访问系统，从而导致完全的系统破坏。

**项目地址:** [acan0007/CVE-2025-31161](https://github.com/acan0007/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #11

**来源**: [CVE-2025-31161-cesarbtakeda_CVE-2025-31161.md](../2025/CVE-2025-31161-cesarbtakeda_CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP-Authentication Bypass

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** CrushFTP 10 (before 10.8.4) and 11 (before 11.3.1)

**利用条件:** 需要网络访问CrushFTP服务器，且目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-31161 允许未经身份验证的攻击者绕过身份验证并接管 crushadmin 帐户 (除非使用 DMZ 代理实例)。此漏洞是由于 FTP 服务器的 HTTP 组件的 AWS4-HMAC 授权方法中存在竞争条件。服务器首先通过调用 login_user_pass() 验证用户的存在，而无需密码要求。通过发送篡改的 AWS4-HMAC 标头，可以进一步稳定该漏洞，从而无需成功触发竞争条件。通过仅提供用户名和后面的斜杠 (/)，服务器将成功找到用户名，从而触发成功的 anypass 身份验证过程，但服务器将无法找到预期的 SignedHeaders 条目，从而导致索引越界错误，从而阻止代码到达会话清理。总之，这些问题使得以任何已知或可猜测的用户（例如，crushadmin）进行身份验证变得非常容易，并且可能导致通过获得管理帐户来完全破坏系统。

**利用方式：**

1.  利用 AWS4-HMAC 授权中的漏洞，通过发送包含用户名和斜杠的畸形请求绕过身份验证。
2.  使用绕过的身份验证会话，通过 WebInterface/function/ 调用创建新的管理员用户或修改现有用户密码。
3.  如果目标是 crushadmin 帐户，则攻击者可以完全控制 CrushFTP 系统。

**关于PoC代码的有效性：**
提供的 PoC 代码 (exploit.c) 尝试利用此漏洞。它包含设置 HTTP 标头、构造 URL 以及使用 libcurl 执行 HTTP 请求的功能。漏洞利用尝试通过设置带有畸形 'Authorization' 标头的 Cookie 并向易受攻击的端点发送请求来利用身份验证绕过。

**关于投毒风险：**
风险较低，大约 5%。 虽然代码包含常见漏洞利用所需的网络功能（通过 libcurl），但其中未发现任何明显的恶意或不必要的操作，例如下载和执行任意二进制文件、修改系统文件或建立后门。代码相对简单，主要是为了演示身份验证绕过漏洞利用，而不是进行恶意活动。但存在一些风险，例如错误处理不当或意外崩溃，因此谨慎使用。

**项目地址:** [cesarbtakeda/CVE-2025-31161](https://github.com/cesarbtakeda/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #12

**来源**: [CVE-2025-31161-f4dee-backup_CVE-2025-31161.md](../2025/CVE-2025-31161-f4dee-backup_CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP-身份验证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** 10.0.0-10.8.3, 11.0.0-11.3.0

**利用条件:** 需要能通过HTTP(S)访问CrushFTP服务器

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-31161是一个影响CrushFTP的身份验证绕过漏洞，允许未经身份验证的远程攻击者在受影响的服务器上冒充任何用户，包括管理员crushadmin。

**有效性:**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断此漏洞是有效的。漏洞库信息明确指出该漏洞已在野外被利用。搜索引擎结果中包含多个安全厂商的分析报告和预警信息，证实了该漏洞的存在和危害。漏洞利用代码提供了一个自动化创建管理员用户的脚本，进一步验证了该漏洞的可利用性。

**投毒风险:**
对漏洞利用代码进行分析后，发现该脚本主要是通过构造特定的HTTP请求来利用CrushFTP的身份验证绕过漏洞。脚本首先生成一个伪造的`CrushAuth` token，然后利用此token发送恶意payload来创建一个新的管理员用户。脚本包含curl，shuf 依赖检测和安装语句，存在风险，但结合脚本逻辑，判断为正常功能，而非恶意投毒。综上所述，该脚本存在投毒的可能性较低。

**利用方式:**
1.  **目标确定:** 确定目标CrushFTP服务器的URL和端口。
2.  **参数设置:** 设置目标用户名(可以是现有或猜测的用户名，如crushadmin)，以及要创建的新用户名和密码。
3.  **脚本执行:** 运行提供的bash脚本，并传入目标URL、端口、目标用户名、新用户名和密码等参数。
4.  **身份验证绕过:** 脚本会利用CrushFTP的身份验证绕过漏洞，伪造一个有效的`CrushAuth` token。
5.  **用户创建:** 脚本会利用伪造的`CrushAuth` token发送一个HTTP请求，在CrushFTP服务器上创建一个新的管理员用户。
6.  **访问控制:** 使用新创建的管理员用户登录CrushFTP Web界面，从而完全控制系统。

**项目地址:** [f4dee-backup/CVE-2025-31161](https://github.com/f4dee-backup/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #13

**来源**: [CVE-2025-31161-ibrahimsql_CVE-2025-31161.md](../2025/CVE-2025-31161-ibrahimsql_CVE-2025-31161.md)

## CVE-2025-31161 CrushFTP 身份验证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** CrushFTP 10 before 10.8.4 and 11 before 11.3.1

**利用条件:** 目标 CrushFTP 服务器可通过 HTTP(S) 访问，且未部署 DMZ 代理实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-31161 是 CrushFTP 中 WebInterface 组件的一个严重身份验证绕过漏洞。未经身份验证的攻击者可以通过操纵特定的 cookie 和授权标头值来执行管理功能。

**漏洞利用方式:**

1.  **身份验证绕过:** 攻击者通过发送特制的 HTTP 请求，其中包含特定的 cookie 值 (`currentAuth=31If; CrushAuth=1744110584619_p38s3LvsGAfk4GvVu0vWtsEQEv31If`) 和授权标头 (`AWS4-HMAC-SHA256 Credential=crushadmin/`)，来绕过身份验证控制。
2.  **创建管理员账户:**  成功绕过身份验证后，攻击者可以利用用户管理功能创建一个新的管理员账户，从而获得对 CrushFTP 服务器的完全控制权限。

**投毒风险评估：**

虽然提供的漏洞利用代码看起来功能完善，但仍存在一定的投毒风险。具体来说，`requirements.txt` 文件中可能包含恶意依赖项，或者 `cve_2025_31161.py` 脚本本身可能包含隐藏的后门代码，例如数据窃取或远程代码执行功能。此外，截图`https://github.com/user-attachments/assets/c278226c-a5f8-452a-a1e8-96062b226dd7` 存在钓鱼风险,诱导用户点击恶意链接.虽然代码本身的功能是利用漏洞创建管理员用户,并不能直接判断为投毒代码,考虑到github账号创建时间,代码编写质量等原因综合评估投毒风险为10%。

**有效性:**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞利用代码是有效的。多个来源都证实了 CVE-2025-31161 漏洞的存在以及被实际利用的情况。提供的 POC 代码也给出了明确的利用方法，即通过构造特定的 HTTP 请求来绕过身份验证并创建新的管理员账户。但实际利用时，务必对代码进行审计，确保不存在恶意代码。

**项目地址:** [ibrahimsql/CVE-2025-31161](https://github.com/ibrahimsql/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #14

**来源**: [CVE-2025-31161-ibrahmsql_CVE-2025-31161.md](../2025/CVE-2025-31161-ibrahmsql_CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP-身份验证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致管理员权限获取，系统完全控制

**影响版本:** < 10.8.4 (CrushFTP 10), < 11.3.1 (CrushFTP 11)

**利用条件:** 需要网络访问CrushFTP服务，并且目标版本在受影响范围内，非DMZ代理实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-31161 存在于 CrushFTP 10 (版本低于 10.8.4) 和 11 (版本低于 11.3.1) 中。该漏洞允许未经身份验证的攻击者绕过身份验证并接管 crushadmin 帐户，除非使用了 DMZ 代理实例。该漏洞利用 AWS4-HMAC 授权方法中的竞争条件和头部解析缺陷。通过发送畸形的 AWS4-HMAC 头部，可以触发服务器的 index-out-of-bounds 错误，阻止会话清理，从而允许攻击者以任何已知或可猜测的用户（例如 crushadmin）身份进行身份验证，最终完全控制系统。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确定该漏洞的PoC代码是有效的。搜索引擎结果中有多篇文章提到该漏洞已被在野利用。PoC代码也描述了具体的利用方法。

**投毒风险：**

评估PoC代码后，存在一定的投毒风险。具体分析如下：

*   **代码结构：** 代码结构比较清晰，包含了常见的漏洞利用流程。但是，代码中仍然可能存在作者隐藏的恶意代码，例如：
    *   **未记录的远程连接：** 代码中可能包含未记录的远程连接功能，例如连接到特定的服务器以下载或上传数据。
    *   **恶意Payload：** 代码中可以嵌入恶意的Payload，例如用于执行系统命令或安装后门程序。
    *   **信息收集：** 代码可以收集目标系统的敏感信息，例如用户名、密码、IP地址等，并将这些信息发送给攻击者。

基于上述分析，我估计该PoC代码的投毒风险为10%。

**利用方式：**

1.  **目标确认：** 确定目标CrushFTP服务器的版本是否在受影响范围内（低于 10.8.4 (CrushFTP 10) 或低于 11.3.1 (CrushFTP 11)），并且未使用 DMZ 代理。
2.  **构造恶意请求：**  构造包含畸形的AWS4-HMAC头部的HTTP(S)请求。关键在于提供用户名，但是缺少或篡改SignedHeaders条目以触发index-out-of-bounds错误。
3.  **绕过身份验证：**  利用漏洞绕过身份验证，以 crushadmin 或其他已知用户身份登录。
4.  **控制系统：**  成功登录后，攻击者可以执行任意操作，包括上传恶意文件、修改配置、创建新用户等，从而完全控制 CrushFTP 服务器。

**项目地址:** [ibrahmsql/CVE-2025-31161](https://github.com/ibrahmsql/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #15

**来源**: [CVE-2025-31161-llussiess_CVE-2025-31161.md](../2025/CVE-2025-31161-llussiess_CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP身份验证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统接管

**影响版本:** 10 (10.0 - 10.8.3) 和 11 (11.0 - 11.3.0)

**利用条件:** 目标系统运行受影响版本的CrushFTP，且未启用DMZ代理

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码（仅包含README.md），分析如下：

**有效性：** 提供的POC代码仅仅包含一个README.md文件，没有实际的利用代码，因此无法直接验证漏洞的有效性。但是，漏洞库信息和搜索结果都表明该漏洞已在野外被利用，说明该漏洞是真实存在的。参考搜索结果[webpage 3]，Huntress公司观察到CVE-2025-31161 在野外被利用,验证该漏洞存在。

**投毒风险：** 提供的漏洞利用代码只包含一个README.md文件，其中仅包含CVE编号，没有发现任何恶意代码，因此投毒风险极低，评估为0%。

**利用方式：** 

1.  **漏洞概述：** CrushFTP 10 (10.0 - 10.8.3) 和 11 (11.0 - 11.3.0) 存在一个身份验证绕过漏洞，攻击者可以绕过身份验证并接管`crushadmin`账户（除非使用了DMZ代理实例）。
2.  **漏洞原理：** 漏洞的根源在于HTTP组件的AWS4-HMAC认证方法存在缺陷。服务器首先通过调用`login_user_pass()`验证用户是否存在，而不需要密码。攻击者可以通过发送带有用户名但缺少`SignedHeaders`条目的畸形AWS4-HMAC头部，触发索引越界错误，阻止会话清理，从而成功以任意已知或可猜测的用户（例如`crushadmin`）进行身份验证。参考漏洞库信息和搜索结果[webpage 4]。
3.  **利用步骤：** 
    *   构造一个畸形的AWS4-HMAC头部，只包含用户名和一个斜杠(`/`)。
    *   发送该头部到CrushFTP服务器。
    *   服务器会成功找到用户名，触发`anypass`身份验证过程。
    *   由于缺少`SignedHeaders`条目，服务器会发生索引越界错误，阻止会话清理。
    *   攻击者成功以指定用户身份登录。
4.  **缓解措施：** 升级CrushFTP到10.8.4或11.3.1及以上版本。参考漏洞库信息和搜索结果。

总之，该漏洞利用方式较为简单，危害严重，需要尽快修复。

**项目地址:** [llussiess/CVE-2025-31161](https://github.com/llussiess/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #16

**来源**: [CVE-2025-31161-r0otk3r_CVE-2025-31161.md](../2025/CVE-2025-31161-r0otk3r_CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP-认证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 认证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统权限控制

**影响版本:** 10.0.0 - 10.8.3 和 11.0.0 - 11.3.0

**利用条件:** CrushFTP服务需要通过HTTP(S)协议对外开放

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-31161 允许未经身份验证的攻击者绕过 CrushFTP 的身份验证，并接管 crushadmin 帐户（除非使用 DMZ 代理实例）。该漏洞利用了 HTTP 组件中 AWS4-HMAC (与 S3 兼容) 授权方法中的竞争条件。服务器首先调用 login_user_pass()，而无需密码，从而验证用户的存在。通过提供带有用户名和后缀斜杠（/）的伪造 AWS4-HMAC 标头，服务器可以成功找到用户名，从而触发 anypass 身份验证过程，但服务器将无法找到预期的 SignedHeaders 条目，从而导致索引越界错误，从而阻止代码到达会话清理。PoC 代码使用带有构造的 `CrushAuth` cookie 和 `Authorization` 标头的 GET 请求，通过 `/WebInterface/function/?command=getUserList&serverGroup=MainUsers` 端点获取用户列表，以证明认证绕过。由于其依赖于标准库并且没有执行任何可疑操作,投毒风险极低。

**项目地址:** [r0otk3r/CVE-2025-31161](https://github.com/r0otk3r/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---



---

## POC #6

**来源**: [CVE-2025-31161-SUPRAAA-1337_CVE-2025-31161_exploit.md](../2025/CVE-2025-31161-SUPRAAA-1337_CVE-2025-31161_exploit.md)

## CVE-2025-31161 CrushFTP Authentication Bypass

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统接管

**影响版本:** CrushFTP 10 before 10.8.4 和 CrushFTP 11 before 11.3.1

**利用条件:** 目标服务器未部署 DMZ 代理实例，并且开放 HTTP(S) 端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-31161 允许未经身份验证的远程攻击者绕过 CrushFTP 的身份验证，并可能接管 crushadmin 帐户。漏洞存在于AWS4-HMAC授权过程中，由于服务器在执行用户验证时存在竞争条件或可通过畸形的AWS4-HMAC头导致索引越界，从而允许攻击者使用任意用户名进行身份验证。POC代码（`python3 script.py -u http://example.com` 或 `python3 script.py -l urls.txt`）通过发送特制的请求来利用此漏洞。脚本将尝试访问 CrushFTP 服务器，并检查响应中是否包含 'crushadmin' 字符串，从而判断是否成功绕过身份验证。由于 `README.md` 仅仅给出了使用说明，并没有给出`script.py`的具体内容，因此存在一定投毒的风险，无法确定是否会在利用过程中执行恶意操作，例如植入后门或者修改系统配置。这里估计投毒的概率较低，因为脚本似乎只是用于检测漏洞是否存在，并将包含 'crushadmin' 的结果写入文件。但不能完全排除风险，例如URL文件被替换，恶意篡改等。

**项目地址:** [SUPRAAA-1337/CVE-2025-31161_exploit](https://github.com/SUPRAAA-1337/CVE-2025-31161_exploit)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #7

**来源**: [CVE-2025-31161-SUPRAAA-1337_Nuclei_CVE-2025-31161_CVE-2025-2825.md](../2025/CVE-2025-31161-SUPRAAA-1337_Nuclei_CVE-2025-31161_CVE-2025-2825.md)

## CVE-2025-31161 - CrushFTP Authentication Bypass

**漏洞编号:** CVE-2025-31161

**漏洞类型:** Authentication Bypass

**影响应用:** CrushFTP

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.0.0 <= version < 10.8.4 和 11.0.0 <= version < 11.3.1

**利用条件:** 目标CrushFTP服务器未部署DMZ代理，并且HTTP(S)端口对外开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码 (CVE-2025-2825.yaml)，可以评估此漏洞利用的有效性并分析利用方式。首先，CVE-2025-31161 允许未经身份验证的攻击者绕过身份验证，接管 crushadmin 帐户，从而完全控制 CrushFTP 服务器。提供的漏洞利用代码针对 CVE-2025-2825，虽然编号不同，但描述和影响的组件与 CVE-2025-31161 相同，根据securityweek.com的描述，这两个CVE针对的是同一个漏洞。该漏洞利用代码通过发送特制的 HTTP 请求，利用 AWS4-HMAC 认证过程中的缺陷。具体来说，通过在 Authorization 头部中只提供用户名（例如 crushadmin/）来绕过身份验证。服务器在验证用户存在时，会因为缺少 SignedHeaders 条目而发生 index-out-of-bounds 错误，阻止会话清理，从而允许攻击者以指定用户身份进行身份验证。该漏洞利用代码通过发送包含恶意 Authorization 头的 GET 请求来尝试获取用户列表，以此验证身份绕过是否成功。如果返回的 XML 包含 crushadmin 用户，则表明身份绕过成功。

**有效性：**根据多个信息来源表明，该漏洞已被积极利用，且漏洞利用代码能够有效绕过身份验证。提供的漏洞利用代码通过构造特定的HTTP请求，模拟未经授权的身份验证过程，从而验证目标是否存在漏洞。因此，该POC有效。

**投毒风险：** 在提供的漏洞利用代码中，没有明显的投毒代码。该YAML文件定义了HTTP请求的结构和匹配规则，没有发现任何执行恶意操作的后门或隐藏指令。所以，投毒风险为0%。

**利用方式：** 漏洞利用方式如下：
1.  攻击者向目标 CrushFTP 服务器发送特制的 HTTP 请求。
2.  该请求的 Authorization 头部包含 AWS4-HMAC-SHA256 Credential，但只包含用户名，例如 crushadmin/。
3.  由于服务器代码中的缺陷，攻击者可以绕过身份验证。
4.  攻击者可以执行管理员操作，例如获取用户列表，甚至接管整个服务器。

**排序优先级说明：**
在此次分析中，搜索引擎结果提供了关于漏洞已被利用的证据，以及受影响服务器的大致数量，优先级较高。漏洞利用代码本身提供了漏洞利用的技术细节，其次是漏洞库信息，它提供了漏洞的基本描述和受影响的版本信息。

**项目地址:** [SUPRAAA-1337/Nuclei_CVE-2025-31161_CVE-2025-2825](https://github.com/SUPRAAA-1337/Nuclei_CVE-2025-31161_CVE-2025-2825)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #8

**来源**: [CVE-2025-31161-TX-One_CVE-2025-31161.md](../2025/CVE-2025-31161-TX-One_CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP-认证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 认证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** 10 (低于 10.8.4) 和 11 (低于 11.3.1)

**利用条件:** 目标CrushFTP实例必须暴露在公网上或可访问的网络中，且未启用DMZ代理

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-31161是CrushFTP中的一个认证绕过漏洞。攻击者可以通过构造特殊的HTTP请求头，绕过身份验证，并以任意用户（例如 crushadmin）的身份登录。漏洞的根本原因是AWS4-HMAC认证机制中的竞态条件和不完善的错误处理。通过发送畸形的AWS4-HMAC头，攻击者可以触发服务器的index-out-of-bounds错误，阻止会话清理，从而成功进行身份验证。

**有效性分析：**

*   根据漏洞库信息，搜索引擎结果（尤其是huntress的博客）以及提供的漏洞利用代码，可以确定该漏洞真实存在且已被在野利用，POC代码具有实际的有效性。
*   POC代码的`README.md`文件描述了漏洞原理和利用方法，提供了详细的参数说明和使用示例。`tx-crush.py`文件实现了漏洞利用的完整流程，包括版本检测、用户枚举、身份验证绕过等功能。

**投毒风险分析：**

*   通过阅读`tx-crush.py`的代码，未发现明显的恶意代码或后门。该脚本主要功能是利用漏洞进行认证绕过，没有发现额外的网络扫描，敏感信息收集或修改系统设置的操作。
*   但仍需注意，任何未经授权的漏洞利用都可能造成安全风险。如果用户在使用此POC时连接了不可信的网络，或者使用了恶意构造的用户名列表，仍然可能导致安全问题。
*   此外，虽然脚本本身没有明显的投毒代码，但下载的第三方库可能存在潜在的风险。建议在使用前对所有依赖项进行安全审计。
*   基于以上分析，认为该POC代码存在1%的投毒风险，主要来自于可能被恶意修改或依赖的第三方库。

**利用方式分析：**

1.  **版本检测：** 脚本首先通过发送HEAD请求检测目标CrushFTP服务器的版本。
2.  **用户名枚举：**  攻击者需要提供一个包含用户名列表的文件，脚本会尝试使用这些用户名进行身份验证绕过。
3.  **认证绕过：** 脚本通过构造特殊的HTTP Authorization header，利用CrushFTP的AWS4-HMAC认证机制中的漏洞，绕过身份验证。
4.  **会话获取：** 如果认证绕过成功，脚本会提取服务器返回的sessionID cookie，用于后续的会话维持。
5.  **结果输出：**  脚本将利用结果以JSON格式输出到指定的文件中，包括目标URL、用户名、是否成功绕过、认证方法、sessionID cookie等信息。


**项目地址:** [TX-One/CVE-2025-31161](https://github.com/TX-One/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #9

**来源**: [CVE-2025-31161-Teexo_CVE-2025-31161.md](../2025/CVE-2025-31161-Teexo_CVE-2025-31161.md)

## CVE-2025-31161 CrushFTP Authentication Bypass

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 严重，可能导致完全系统接管

**影响版本:** 10.0.0 - 10.8.3, 11.0.0 - 11.3.0

**利用条件:** CrushFTP服务器必须在受影响版本范围内，且可通过HTTP(S)访问，非DMZ代理实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-31161 是 CrushFTP 中的一个身份验证绕过漏洞。攻击者可以通过构造畸形的 AWS4-HMAC 头部来绕过身份验证，从而以任何已知或可猜测的用户身份进行身份验证（例如 crushadmin），从而完全控制系统。漏洞存在于HTTP组件的AWS4-HMAC授权方法中，存在竞态条件，通过发送只包含用户名和斜杠的请求，服务器会成功找到用户名，但后续SignedHeaders验证失败，导致索引越界错误，阻止清理会话，从而绕过身份验证。

漏洞利用方式：
1.  向目标 CrushFTP 服务器发送特制的 HTTP 请求，该请求包含畸形的 AWS4-HMAC 头部，仅提供用户名和斜杠。
2.  服务器尝试使用提供的用户名进行身份验证，由于畸形的头部，身份验证过程中的某些检查会被绕过。
3.  攻击者成功以指定用户身份（如 crushadmin）进行身份验证。
4.  攻击者可以利用获得的管理员权限来执行任意操作，例如上传恶意文件、修改系统配置等，从而完全控制系统。

根据提供的POC代码，该代码是一个扫描器，用于检测目标是否存在CVE-2025-31161漏洞，而不是一个直接的利用工具。因此，投毒风险较低，主要集中在代码的扫描行为可能被用于恶意目的，如扫描大量目标进行信息收集。README.md中的`git clone https://github.com/yourusername/CVE-2025-31161.py`表明原始仓库可能并不存在，存在一定的钓鱼风险，诱导用户访问恶意仓库。

综合搜索结果，表明此漏洞已经在野外被利用，并且多个安全厂商提供了缓解措施和检测方法。

投毒风险分析：
* LICENSE文件声明了MIT许可，表明代码开源。
* README.md 文件描述了漏洞和使用方法，提示用户安装依赖`requirements.txt`。
* requirements.txt 文件中定义了requests和urllib3的版本要求，未发现恶意依赖。

可能的投毒点在于：
1.  作者可能在 CVE-2025-31161.py 文件中加入恶意代码，比如反弹shell，信息收集等。
2.  诱导用户访问恶意仓库，下载包含恶意代码的扫描器。

综合判断，该仓库本身投毒概率较低，但用户仍需谨慎分析 CVE-2025-31161.py 脚本，以及避免从不可信的来源下载工具，并且注意代码的潜在恶意行为。并且，该扫描器本身也可能被用于非授权的漏洞扫描。

**项目地址:** [Teexo/CVE-2025-31161](https://github.com/Teexo/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #10

**来源**: [CVE-2025-31161-acan0007_CVE-2025-31161.md](../2025/CVE-2025-31161-acan0007_CVE-2025-31161.md)

## CVE-2025-31161 - CrushFTP身份验证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统权限被获取

**影响版本:** 10.0.0 - 10.8.3 和 11.0.0 - 11.3.0

**利用条件:** 目标CrushFTP服务器的HTTP(S)端口可公开访问，且未使用DMZ代理实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-31161是一个影响CrushFTP 10版本（10.0.0到10.8.3）和11版本（11.0.0到11.3.0）的身份验证绕过漏洞。根据漏洞信息和搜索结果，攻击者可以通过构造特定的HTTP请求绕过身份验证，从而接管 crushadmin 账户，导致对系统的完全控制。

**有效性：**
漏洞库信息、搜索引擎结果均表明该漏洞已在野外被利用，并且提供了详细的漏洞描述。POC的存在进一步支持了该漏洞的有效性。虽然提供的POC仅仅包含一个README.md文件，但搜索结果中的参考链接（如Outpost24的博客）提供了关于漏洞利用的详细信息，包括构造恶意请求的细节。

**投毒风险：**
提供的POC代码（README.md）非常简单，只包含漏洞的名称和描述，没有可执行代码，因此不存在投毒风险。 投毒风险：0%。

**利用方式：**
根据漏洞描述，利用方式主要有两种：

1.  **竞争条件：** 通过AWS4-HMAC授权方法中的竞争条件，在服务器验证用户存在之后，服务器进行用户验证之前，利用时间差绕过身份验证。
2.  **Mangled AWS4-HMAC Header:** 通过发送损坏的AWS4-HMAC头，仅提供用户名和斜杠（/），触发服务器的 anypass 身份验证过程，并导致索引越界错误，从而阻止会话清理，允许以任意已知或可猜测的用户（如 crushadmin）进行身份验证。

总而言之，利用此漏洞无需任何身份验证即可访问系统，从而导致完全的系统破坏。

**项目地址:** [acan0007/CVE-2025-31161](https://github.com/acan0007/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #11

**来源**: [CVE-2025-31161-cesarbtakeda_CVE-2025-31161.md](../2025/CVE-2025-31161-cesarbtakeda_CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP-Authentication Bypass

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** CrushFTP 10 (before 10.8.4) and 11 (before 11.3.1)

**利用条件:** 需要网络访问CrushFTP服务器，且目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-31161 允许未经身份验证的攻击者绕过身份验证并接管 crushadmin 帐户 (除非使用 DMZ 代理实例)。此漏洞是由于 FTP 服务器的 HTTP 组件的 AWS4-HMAC 授权方法中存在竞争条件。服务器首先通过调用 login_user_pass() 验证用户的存在，而无需密码要求。通过发送篡改的 AWS4-HMAC 标头，可以进一步稳定该漏洞，从而无需成功触发竞争条件。通过仅提供用户名和后面的斜杠 (/)，服务器将成功找到用户名，从而触发成功的 anypass 身份验证过程，但服务器将无法找到预期的 SignedHeaders 条目，从而导致索引越界错误，从而阻止代码到达会话清理。总之，这些问题使得以任何已知或可猜测的用户（例如，crushadmin）进行身份验证变得非常容易，并且可能导致通过获得管理帐户来完全破坏系统。

**利用方式：**

1.  利用 AWS4-HMAC 授权中的漏洞，通过发送包含用户名和斜杠的畸形请求绕过身份验证。
2.  使用绕过的身份验证会话，通过 WebInterface/function/ 调用创建新的管理员用户或修改现有用户密码。
3.  如果目标是 crushadmin 帐户，则攻击者可以完全控制 CrushFTP 系统。

**关于PoC代码的有效性：**
提供的 PoC 代码 (exploit.c) 尝试利用此漏洞。它包含设置 HTTP 标头、构造 URL 以及使用 libcurl 执行 HTTP 请求的功能。漏洞利用尝试通过设置带有畸形 'Authorization' 标头的 Cookie 并向易受攻击的端点发送请求来利用身份验证绕过。

**关于投毒风险：**
风险较低，大约 5%。 虽然代码包含常见漏洞利用所需的网络功能（通过 libcurl），但其中未发现任何明显的恶意或不必要的操作，例如下载和执行任意二进制文件、修改系统文件或建立后门。代码相对简单，主要是为了演示身份验证绕过漏洞利用，而不是进行恶意活动。但存在一些风险，例如错误处理不当或意外崩溃，因此谨慎使用。

**项目地址:** [cesarbtakeda/CVE-2025-31161](https://github.com/cesarbtakeda/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #12

**来源**: [CVE-2025-31161-f4dee-backup_CVE-2025-31161.md](../2025/CVE-2025-31161-f4dee-backup_CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP-身份验证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** 10.0.0-10.8.3, 11.0.0-11.3.0

**利用条件:** 需要能通过HTTP(S)访问CrushFTP服务器

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-31161是一个影响CrushFTP的身份验证绕过漏洞，允许未经身份验证的远程攻击者在受影响的服务器上冒充任何用户，包括管理员crushadmin。

**有效性:**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断此漏洞是有效的。漏洞库信息明确指出该漏洞已在野外被利用。搜索引擎结果中包含多个安全厂商的分析报告和预警信息，证实了该漏洞的存在和危害。漏洞利用代码提供了一个自动化创建管理员用户的脚本，进一步验证了该漏洞的可利用性。

**投毒风险:**
对漏洞利用代码进行分析后，发现该脚本主要是通过构造特定的HTTP请求来利用CrushFTP的身份验证绕过漏洞。脚本首先生成一个伪造的`CrushAuth` token，然后利用此token发送恶意payload来创建一个新的管理员用户。脚本包含curl，shuf 依赖检测和安装语句，存在风险，但结合脚本逻辑，判断为正常功能，而非恶意投毒。综上所述，该脚本存在投毒的可能性较低。

**利用方式:**
1.  **目标确定:** 确定目标CrushFTP服务器的URL和端口。
2.  **参数设置:** 设置目标用户名(可以是现有或猜测的用户名，如crushadmin)，以及要创建的新用户名和密码。
3.  **脚本执行:** 运行提供的bash脚本，并传入目标URL、端口、目标用户名、新用户名和密码等参数。
4.  **身份验证绕过:** 脚本会利用CrushFTP的身份验证绕过漏洞，伪造一个有效的`CrushAuth` token。
5.  **用户创建:** 脚本会利用伪造的`CrushAuth` token发送一个HTTP请求，在CrushFTP服务器上创建一个新的管理员用户。
6.  **访问控制:** 使用新创建的管理员用户登录CrushFTP Web界面，从而完全控制系统。

**项目地址:** [f4dee-backup/CVE-2025-31161](https://github.com/f4dee-backup/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #13

**来源**: [CVE-2025-31161-ibrahimsql_CVE-2025-31161.md](../2025/CVE-2025-31161-ibrahimsql_CVE-2025-31161.md)

## CVE-2025-31161 CrushFTP 身份验证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** CrushFTP 10 before 10.8.4 and 11 before 11.3.1

**利用条件:** 目标 CrushFTP 服务器可通过 HTTP(S) 访问，且未部署 DMZ 代理实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-31161 是 CrushFTP 中 WebInterface 组件的一个严重身份验证绕过漏洞。未经身份验证的攻击者可以通过操纵特定的 cookie 和授权标头值来执行管理功能。

**漏洞利用方式:**

1.  **身份验证绕过:** 攻击者通过发送特制的 HTTP 请求，其中包含特定的 cookie 值 (`currentAuth=31If; CrushAuth=1744110584619_p38s3LvsGAfk4GvVu0vWtsEQEv31If`) 和授权标头 (`AWS4-HMAC-SHA256 Credential=crushadmin/`)，来绕过身份验证控制。
2.  **创建管理员账户:**  成功绕过身份验证后，攻击者可以利用用户管理功能创建一个新的管理员账户，从而获得对 CrushFTP 服务器的完全控制权限。

**投毒风险评估：**

虽然提供的漏洞利用代码看起来功能完善，但仍存在一定的投毒风险。具体来说，`requirements.txt` 文件中可能包含恶意依赖项，或者 `cve_2025_31161.py` 脚本本身可能包含隐藏的后门代码，例如数据窃取或远程代码执行功能。此外，截图`https://github.com/user-attachments/assets/c278226c-a5f8-452a-a1e8-96062b226dd7` 存在钓鱼风险,诱导用户点击恶意链接.虽然代码本身的功能是利用漏洞创建管理员用户,并不能直接判断为投毒代码,考虑到github账号创建时间,代码编写质量等原因综合评估投毒风险为10%。

**有效性:**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞利用代码是有效的。多个来源都证实了 CVE-2025-31161 漏洞的存在以及被实际利用的情况。提供的 POC 代码也给出了明确的利用方法，即通过构造特定的 HTTP 请求来绕过身份验证并创建新的管理员账户。但实际利用时，务必对代码进行审计，确保不存在恶意代码。

**项目地址:** [ibrahimsql/CVE-2025-31161](https://github.com/ibrahimsql/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #14

**来源**: [CVE-2025-31161-ibrahmsql_CVE-2025-31161.md](../2025/CVE-2025-31161-ibrahmsql_CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP-身份验证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致管理员权限获取，系统完全控制

**影响版本:** < 10.8.4 (CrushFTP 10), < 11.3.1 (CrushFTP 11)

**利用条件:** 需要网络访问CrushFTP服务，并且目标版本在受影响范围内，非DMZ代理实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-31161 存在于 CrushFTP 10 (版本低于 10.8.4) 和 11 (版本低于 11.3.1) 中。该漏洞允许未经身份验证的攻击者绕过身份验证并接管 crushadmin 帐户，除非使用了 DMZ 代理实例。该漏洞利用 AWS4-HMAC 授权方法中的竞争条件和头部解析缺陷。通过发送畸形的 AWS4-HMAC 头部，可以触发服务器的 index-out-of-bounds 错误，阻止会话清理，从而允许攻击者以任何已知或可猜测的用户（例如 crushadmin）身份进行身份验证，最终完全控制系统。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确定该漏洞的PoC代码是有效的。搜索引擎结果中有多篇文章提到该漏洞已被在野利用。PoC代码也描述了具体的利用方法。

**投毒风险：**

评估PoC代码后，存在一定的投毒风险。具体分析如下：

*   **代码结构：** 代码结构比较清晰，包含了常见的漏洞利用流程。但是，代码中仍然可能存在作者隐藏的恶意代码，例如：
    *   **未记录的远程连接：** 代码中可能包含未记录的远程连接功能，例如连接到特定的服务器以下载或上传数据。
    *   **恶意Payload：** 代码中可以嵌入恶意的Payload，例如用于执行系统命令或安装后门程序。
    *   **信息收集：** 代码可以收集目标系统的敏感信息，例如用户名、密码、IP地址等，并将这些信息发送给攻击者。

基于上述分析，我估计该PoC代码的投毒风险为10%。

**利用方式：**

1.  **目标确认：** 确定目标CrushFTP服务器的版本是否在受影响范围内（低于 10.8.4 (CrushFTP 10) 或低于 11.3.1 (CrushFTP 11)），并且未使用 DMZ 代理。
2.  **构造恶意请求：**  构造包含畸形的AWS4-HMAC头部的HTTP(S)请求。关键在于提供用户名，但是缺少或篡改SignedHeaders条目以触发index-out-of-bounds错误。
3.  **绕过身份验证：**  利用漏洞绕过身份验证，以 crushadmin 或其他已知用户身份登录。
4.  **控制系统：**  成功登录后，攻击者可以执行任意操作，包括上传恶意文件、修改配置、创建新用户等，从而完全控制 CrushFTP 服务器。

**项目地址:** [ibrahmsql/CVE-2025-31161](https://github.com/ibrahmsql/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #15

**来源**: [CVE-2025-31161-llussiess_CVE-2025-31161.md](../2025/CVE-2025-31161-llussiess_CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP身份验证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统接管

**影响版本:** 10 (10.0 - 10.8.3) 和 11 (11.0 - 11.3.0)

**利用条件:** 目标系统运行受影响版本的CrushFTP，且未启用DMZ代理

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码（仅包含README.md），分析如下：

**有效性：** 提供的POC代码仅仅包含一个README.md文件，没有实际的利用代码，因此无法直接验证漏洞的有效性。但是，漏洞库信息和搜索结果都表明该漏洞已在野外被利用，说明该漏洞是真实存在的。参考搜索结果[webpage 3]，Huntress公司观察到CVE-2025-31161 在野外被利用,验证该漏洞存在。

**投毒风险：** 提供的漏洞利用代码只包含一个README.md文件，其中仅包含CVE编号，没有发现任何恶意代码，因此投毒风险极低，评估为0%。

**利用方式：** 

1.  **漏洞概述：** CrushFTP 10 (10.0 - 10.8.3) 和 11 (11.0 - 11.3.0) 存在一个身份验证绕过漏洞，攻击者可以绕过身份验证并接管`crushadmin`账户（除非使用了DMZ代理实例）。
2.  **漏洞原理：** 漏洞的根源在于HTTP组件的AWS4-HMAC认证方法存在缺陷。服务器首先通过调用`login_user_pass()`验证用户是否存在，而不需要密码。攻击者可以通过发送带有用户名但缺少`SignedHeaders`条目的畸形AWS4-HMAC头部，触发索引越界错误，阻止会话清理，从而成功以任意已知或可猜测的用户（例如`crushadmin`）进行身份验证。参考漏洞库信息和搜索结果[webpage 4]。
3.  **利用步骤：** 
    *   构造一个畸形的AWS4-HMAC头部，只包含用户名和一个斜杠(`/`)。
    *   发送该头部到CrushFTP服务器。
    *   服务器会成功找到用户名，触发`anypass`身份验证过程。
    *   由于缺少`SignedHeaders`条目，服务器会发生索引越界错误，阻止会话清理。
    *   攻击者成功以指定用户身份登录。
4.  **缓解措施：** 升级CrushFTP到10.8.4或11.3.1及以上版本。参考漏洞库信息和搜索结果。

总之，该漏洞利用方式较为简单，危害严重，需要尽快修复。

**项目地址:** [llussiess/CVE-2025-31161](https://github.com/llussiess/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #16

**来源**: [CVE-2025-31161-r0otk3r_CVE-2025-31161.md](../2025/CVE-2025-31161-r0otk3r_CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP-认证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 认证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统权限控制

**影响版本:** 10.0.0 - 10.8.3 和 11.0.0 - 11.3.0

**利用条件:** CrushFTP服务需要通过HTTP(S)协议对外开放

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-31161 允许未经身份验证的攻击者绕过 CrushFTP 的身份验证，并接管 crushadmin 帐户（除非使用 DMZ 代理实例）。该漏洞利用了 HTTP 组件中 AWS4-HMAC (与 S3 兼容) 授权方法中的竞争条件。服务器首先调用 login_user_pass()，而无需密码，从而验证用户的存在。通过提供带有用户名和后缀斜杠（/）的伪造 AWS4-HMAC 标头，服务器可以成功找到用户名，从而触发 anypass 身份验证过程，但服务器将无法找到预期的 SignedHeaders 条目，从而导致索引越界错误，从而阻止代码到达会话清理。PoC 代码使用带有构造的 `CrushAuth` cookie 和 `Authorization` 标头的 GET 请求，通过 `/WebInterface/function/?command=getUserList&serverGroup=MainUsers` 端点获取用户列表，以证明认证绕过。由于其依赖于标准库并且没有执行任何可疑操作,投毒风险极低。

**项目地址:** [r0otk3r/CVE-2025-31161](https://github.com/r0otk3r/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---



---

## POC #6

**来源**: [CVE-2025-31161-SUPRAAA-1337_CVE-2025-31161_exploit.md](../2025/CVE-2025-31161-SUPRAAA-1337_CVE-2025-31161_exploit.md)

## CVE-2025-31161 CrushFTP Authentication Bypass

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统接管

**影响版本:** CrushFTP 10 before 10.8.4 和 CrushFTP 11 before 11.3.1

**利用条件:** 目标服务器未部署 DMZ 代理实例，并且开放 HTTP(S) 端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-31161 允许未经身份验证的远程攻击者绕过 CrushFTP 的身份验证，并可能接管 crushadmin 帐户。漏洞存在于AWS4-HMAC授权过程中，由于服务器在执行用户验证时存在竞争条件或可通过畸形的AWS4-HMAC头导致索引越界，从而允许攻击者使用任意用户名进行身份验证。POC代码（`python3 script.py -u http://example.com` 或 `python3 script.py -l urls.txt`）通过发送特制的请求来利用此漏洞。脚本将尝试访问 CrushFTP 服务器，并检查响应中是否包含 'crushadmin' 字符串，从而判断是否成功绕过身份验证。由于 `README.md` 仅仅给出了使用说明，并没有给出`script.py`的具体内容，因此存在一定投毒的风险，无法确定是否会在利用过程中执行恶意操作，例如植入后门或者修改系统配置。这里估计投毒的概率较低，因为脚本似乎只是用于检测漏洞是否存在，并将包含 'crushadmin' 的结果写入文件。但不能完全排除风险，例如URL文件被替换，恶意篡改等。

**项目地址:** [SUPRAAA-1337/CVE-2025-31161_exploit](https://github.com/SUPRAAA-1337/CVE-2025-31161_exploit)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #7

**来源**: [CVE-2025-31161-SUPRAAA-1337_Nuclei_CVE-2025-31161_CVE-2025-2825.md](../2025/CVE-2025-31161-SUPRAAA-1337_Nuclei_CVE-2025-31161_CVE-2025-2825.md)

## CVE-2025-31161 - CrushFTP Authentication Bypass

**漏洞编号:** CVE-2025-31161

**漏洞类型:** Authentication Bypass

**影响应用:** CrushFTP

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.0.0 <= version < 10.8.4 和 11.0.0 <= version < 11.3.1

**利用条件:** 目标CrushFTP服务器未部署DMZ代理，并且HTTP(S)端口对外开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码 (CVE-2025-2825.yaml)，可以评估此漏洞利用的有效性并分析利用方式。首先，CVE-2025-31161 允许未经身份验证的攻击者绕过身份验证，接管 crushadmin 帐户，从而完全控制 CrushFTP 服务器。提供的漏洞利用代码针对 CVE-2025-2825，虽然编号不同，但描述和影响的组件与 CVE-2025-31161 相同，根据securityweek.com的描述，这两个CVE针对的是同一个漏洞。该漏洞利用代码通过发送特制的 HTTP 请求，利用 AWS4-HMAC 认证过程中的缺陷。具体来说，通过在 Authorization 头部中只提供用户名（例如 crushadmin/）来绕过身份验证。服务器在验证用户存在时，会因为缺少 SignedHeaders 条目而发生 index-out-of-bounds 错误，阻止会话清理，从而允许攻击者以指定用户身份进行身份验证。该漏洞利用代码通过发送包含恶意 Authorization 头的 GET 请求来尝试获取用户列表，以此验证身份绕过是否成功。如果返回的 XML 包含 crushadmin 用户，则表明身份绕过成功。

**有效性：**根据多个信息来源表明，该漏洞已被积极利用，且漏洞利用代码能够有效绕过身份验证。提供的漏洞利用代码通过构造特定的HTTP请求，模拟未经授权的身份验证过程，从而验证目标是否存在漏洞。因此，该POC有效。

**投毒风险：** 在提供的漏洞利用代码中，没有明显的投毒代码。该YAML文件定义了HTTP请求的结构和匹配规则，没有发现任何执行恶意操作的后门或隐藏指令。所以，投毒风险为0%。

**利用方式：** 漏洞利用方式如下：
1.  攻击者向目标 CrushFTP 服务器发送特制的 HTTP 请求。
2.  该请求的 Authorization 头部包含 AWS4-HMAC-SHA256 Credential，但只包含用户名，例如 crushadmin/。
3.  由于服务器代码中的缺陷，攻击者可以绕过身份验证。
4.  攻击者可以执行管理员操作，例如获取用户列表，甚至接管整个服务器。

**排序优先级说明：**
在此次分析中，搜索引擎结果提供了关于漏洞已被利用的证据，以及受影响服务器的大致数量，优先级较高。漏洞利用代码本身提供了漏洞利用的技术细节，其次是漏洞库信息，它提供了漏洞的基本描述和受影响的版本信息。

**项目地址:** [SUPRAAA-1337/Nuclei_CVE-2025-31161_CVE-2025-2825](https://github.com/SUPRAAA-1337/Nuclei_CVE-2025-31161_CVE-2025-2825)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #8

**来源**: [CVE-2025-31161-TX-One_CVE-2025-31161.md](../2025/CVE-2025-31161-TX-One_CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP-认证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 认证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** 10 (低于 10.8.4) 和 11 (低于 11.3.1)

**利用条件:** 目标CrushFTP实例必须暴露在公网上或可访问的网络中，且未启用DMZ代理

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-31161是CrushFTP中的一个认证绕过漏洞。攻击者可以通过构造特殊的HTTP请求头，绕过身份验证，并以任意用户（例如 crushadmin）的身份登录。漏洞的根本原因是AWS4-HMAC认证机制中的竞态条件和不完善的错误处理。通过发送畸形的AWS4-HMAC头，攻击者可以触发服务器的index-out-of-bounds错误，阻止会话清理，从而成功进行身份验证。

**有效性分析：**

*   根据漏洞库信息，搜索引擎结果（尤其是huntress的博客）以及提供的漏洞利用代码，可以确定该漏洞真实存在且已被在野利用，POC代码具有实际的有效性。
*   POC代码的`README.md`文件描述了漏洞原理和利用方法，提供了详细的参数说明和使用示例。`tx-crush.py`文件实现了漏洞利用的完整流程，包括版本检测、用户枚举、身份验证绕过等功能。

**投毒风险分析：**

*   通过阅读`tx-crush.py`的代码，未发现明显的恶意代码或后门。该脚本主要功能是利用漏洞进行认证绕过，没有发现额外的网络扫描，敏感信息收集或修改系统设置的操作。
*   但仍需注意，任何未经授权的漏洞利用都可能造成安全风险。如果用户在使用此POC时连接了不可信的网络，或者使用了恶意构造的用户名列表，仍然可能导致安全问题。
*   此外，虽然脚本本身没有明显的投毒代码，但下载的第三方库可能存在潜在的风险。建议在使用前对所有依赖项进行安全审计。
*   基于以上分析，认为该POC代码存在1%的投毒风险，主要来自于可能被恶意修改或依赖的第三方库。

**利用方式分析：**

1.  **版本检测：** 脚本首先通过发送HEAD请求检测目标CrushFTP服务器的版本。
2.  **用户名枚举：**  攻击者需要提供一个包含用户名列表的文件，脚本会尝试使用这些用户名进行身份验证绕过。
3.  **认证绕过：** 脚本通过构造特殊的HTTP Authorization header，利用CrushFTP的AWS4-HMAC认证机制中的漏洞，绕过身份验证。
4.  **会话获取：** 如果认证绕过成功，脚本会提取服务器返回的sessionID cookie，用于后续的会话维持。
5.  **结果输出：**  脚本将利用结果以JSON格式输出到指定的文件中，包括目标URL、用户名、是否成功绕过、认证方法、sessionID cookie等信息。


**项目地址:** [TX-One/CVE-2025-31161](https://github.com/TX-One/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #9

**来源**: [CVE-2025-31161-Teexo_CVE-2025-31161.md](../2025/CVE-2025-31161-Teexo_CVE-2025-31161.md)

## CVE-2025-31161 CrushFTP Authentication Bypass

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 严重，可能导致完全系统接管

**影响版本:** 10.0.0 - 10.8.3, 11.0.0 - 11.3.0

**利用条件:** CrushFTP服务器必须在受影响版本范围内，且可通过HTTP(S)访问，非DMZ代理实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-31161 是 CrushFTP 中的一个身份验证绕过漏洞。攻击者可以通过构造畸形的 AWS4-HMAC 头部来绕过身份验证，从而以任何已知或可猜测的用户身份进行身份验证（例如 crushadmin），从而完全控制系统。漏洞存在于HTTP组件的AWS4-HMAC授权方法中，存在竞态条件，通过发送只包含用户名和斜杠的请求，服务器会成功找到用户名，但后续SignedHeaders验证失败，导致索引越界错误，阻止清理会话，从而绕过身份验证。

漏洞利用方式：
1.  向目标 CrushFTP 服务器发送特制的 HTTP 请求，该请求包含畸形的 AWS4-HMAC 头部，仅提供用户名和斜杠。
2.  服务器尝试使用提供的用户名进行身份验证，由于畸形的头部，身份验证过程中的某些检查会被绕过。
3.  攻击者成功以指定用户身份（如 crushadmin）进行身份验证。
4.  攻击者可以利用获得的管理员权限来执行任意操作，例如上传恶意文件、修改系统配置等，从而完全控制系统。

根据提供的POC代码，该代码是一个扫描器，用于检测目标是否存在CVE-2025-31161漏洞，而不是一个直接的利用工具。因此，投毒风险较低，主要集中在代码的扫描行为可能被用于恶意目的，如扫描大量目标进行信息收集。README.md中的`git clone https://github.com/yourusername/CVE-2025-31161.py`表明原始仓库可能并不存在，存在一定的钓鱼风险，诱导用户访问恶意仓库。

综合搜索结果，表明此漏洞已经在野外被利用，并且多个安全厂商提供了缓解措施和检测方法。

投毒风险分析：
* LICENSE文件声明了MIT许可，表明代码开源。
* README.md 文件描述了漏洞和使用方法，提示用户安装依赖`requirements.txt`。
* requirements.txt 文件中定义了requests和urllib3的版本要求，未发现恶意依赖。

可能的投毒点在于：
1.  作者可能在 CVE-2025-31161.py 文件中加入恶意代码，比如反弹shell，信息收集等。
2.  诱导用户访问恶意仓库，下载包含恶意代码的扫描器。

综合判断，该仓库本身投毒概率较低，但用户仍需谨慎分析 CVE-2025-31161.py 脚本，以及避免从不可信的来源下载工具，并且注意代码的潜在恶意行为。并且，该扫描器本身也可能被用于非授权的漏洞扫描。

**项目地址:** [Teexo/CVE-2025-31161](https://github.com/Teexo/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #10

**来源**: [CVE-2025-31161-acan0007_CVE-2025-31161.md](../2025/CVE-2025-31161-acan0007_CVE-2025-31161.md)

## CVE-2025-31161 - CrushFTP身份验证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统权限被获取

**影响版本:** 10.0.0 - 10.8.3 和 11.0.0 - 11.3.0

**利用条件:** 目标CrushFTP服务器的HTTP(S)端口可公开访问，且未使用DMZ代理实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-31161是一个影响CrushFTP 10版本（10.0.0到10.8.3）和11版本（11.0.0到11.3.0）的身份验证绕过漏洞。根据漏洞信息和搜索结果，攻击者可以通过构造特定的HTTP请求绕过身份验证，从而接管 crushadmin 账户，导致对系统的完全控制。

**有效性：**
漏洞库信息、搜索引擎结果均表明该漏洞已在野外被利用，并且提供了详细的漏洞描述。POC的存在进一步支持了该漏洞的有效性。虽然提供的POC仅仅包含一个README.md文件，但搜索结果中的参考链接（如Outpost24的博客）提供了关于漏洞利用的详细信息，包括构造恶意请求的细节。

**投毒风险：**
提供的POC代码（README.md）非常简单，只包含漏洞的名称和描述，没有可执行代码，因此不存在投毒风险。 投毒风险：0%。

**利用方式：**
根据漏洞描述，利用方式主要有两种：

1.  **竞争条件：** 通过AWS4-HMAC授权方法中的竞争条件，在服务器验证用户存在之后，服务器进行用户验证之前，利用时间差绕过身份验证。
2.  **Mangled AWS4-HMAC Header:** 通过发送损坏的AWS4-HMAC头，仅提供用户名和斜杠（/），触发服务器的 anypass 身份验证过程，并导致索引越界错误，从而阻止会话清理，允许以任意已知或可猜测的用户（如 crushadmin）进行身份验证。

总而言之，利用此漏洞无需任何身份验证即可访问系统，从而导致完全的系统破坏。

**项目地址:** [acan0007/CVE-2025-31161](https://github.com/acan0007/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #11

**来源**: [CVE-2025-31161-cesarbtakeda_CVE-2025-31161.md](../2025/CVE-2025-31161-cesarbtakeda_CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP-Authentication Bypass

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** CrushFTP 10 (before 10.8.4) and 11 (before 11.3.1)

**利用条件:** 需要网络访问CrushFTP服务器，且目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-31161 允许未经身份验证的攻击者绕过身份验证并接管 crushadmin 帐户 (除非使用 DMZ 代理实例)。此漏洞是由于 FTP 服务器的 HTTP 组件的 AWS4-HMAC 授权方法中存在竞争条件。服务器首先通过调用 login_user_pass() 验证用户的存在，而无需密码要求。通过发送篡改的 AWS4-HMAC 标头，可以进一步稳定该漏洞，从而无需成功触发竞争条件。通过仅提供用户名和后面的斜杠 (/)，服务器将成功找到用户名，从而触发成功的 anypass 身份验证过程，但服务器将无法找到预期的 SignedHeaders 条目，从而导致索引越界错误，从而阻止代码到达会话清理。总之，这些问题使得以任何已知或可猜测的用户（例如，crushadmin）进行身份验证变得非常容易，并且可能导致通过获得管理帐户来完全破坏系统。

**利用方式：**

1.  利用 AWS4-HMAC 授权中的漏洞，通过发送包含用户名和斜杠的畸形请求绕过身份验证。
2.  使用绕过的身份验证会话，通过 WebInterface/function/ 调用创建新的管理员用户或修改现有用户密码。
3.  如果目标是 crushadmin 帐户，则攻击者可以完全控制 CrushFTP 系统。

**关于PoC代码的有效性：**
提供的 PoC 代码 (exploit.c) 尝试利用此漏洞。它包含设置 HTTP 标头、构造 URL 以及使用 libcurl 执行 HTTP 请求的功能。漏洞利用尝试通过设置带有畸形 'Authorization' 标头的 Cookie 并向易受攻击的端点发送请求来利用身份验证绕过。

**关于投毒风险：**
风险较低，大约 5%。 虽然代码包含常见漏洞利用所需的网络功能（通过 libcurl），但其中未发现任何明显的恶意或不必要的操作，例如下载和执行任意二进制文件、修改系统文件或建立后门。代码相对简单，主要是为了演示身份验证绕过漏洞利用，而不是进行恶意活动。但存在一些风险，例如错误处理不当或意外崩溃，因此谨慎使用。

**项目地址:** [cesarbtakeda/CVE-2025-31161](https://github.com/cesarbtakeda/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #12

**来源**: [CVE-2025-31161-f4dee-backup_CVE-2025-31161.md](../2025/CVE-2025-31161-f4dee-backup_CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP-身份验证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** 10.0.0-10.8.3, 11.0.0-11.3.0

**利用条件:** 需要能通过HTTP(S)访问CrushFTP服务器

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-31161是一个影响CrushFTP的身份验证绕过漏洞，允许未经身份验证的远程攻击者在受影响的服务器上冒充任何用户，包括管理员crushadmin。

**有效性:**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断此漏洞是有效的。漏洞库信息明确指出该漏洞已在野外被利用。搜索引擎结果中包含多个安全厂商的分析报告和预警信息，证实了该漏洞的存在和危害。漏洞利用代码提供了一个自动化创建管理员用户的脚本，进一步验证了该漏洞的可利用性。

**投毒风险:**
对漏洞利用代码进行分析后，发现该脚本主要是通过构造特定的HTTP请求来利用CrushFTP的身份验证绕过漏洞。脚本首先生成一个伪造的`CrushAuth` token，然后利用此token发送恶意payload来创建一个新的管理员用户。脚本包含curl，shuf 依赖检测和安装语句，存在风险，但结合脚本逻辑，判断为正常功能，而非恶意投毒。综上所述，该脚本存在投毒的可能性较低。

**利用方式:**
1.  **目标确定:** 确定目标CrushFTP服务器的URL和端口。
2.  **参数设置:** 设置目标用户名(可以是现有或猜测的用户名，如crushadmin)，以及要创建的新用户名和密码。
3.  **脚本执行:** 运行提供的bash脚本，并传入目标URL、端口、目标用户名、新用户名和密码等参数。
4.  **身份验证绕过:** 脚本会利用CrushFTP的身份验证绕过漏洞，伪造一个有效的`CrushAuth` token。
5.  **用户创建:** 脚本会利用伪造的`CrushAuth` token发送一个HTTP请求，在CrushFTP服务器上创建一个新的管理员用户。
6.  **访问控制:** 使用新创建的管理员用户登录CrushFTP Web界面，从而完全控制系统。

**项目地址:** [f4dee-backup/CVE-2025-31161](https://github.com/f4dee-backup/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #13

**来源**: [CVE-2025-31161-ibrahimsql_CVE-2025-31161.md](../2025/CVE-2025-31161-ibrahimsql_CVE-2025-31161.md)

## CVE-2025-31161 CrushFTP 身份验证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** CrushFTP 10 before 10.8.4 and 11 before 11.3.1

**利用条件:** 目标 CrushFTP 服务器可通过 HTTP(S) 访问，且未部署 DMZ 代理实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-31161 是 CrushFTP 中 WebInterface 组件的一个严重身份验证绕过漏洞。未经身份验证的攻击者可以通过操纵特定的 cookie 和授权标头值来执行管理功能。

**漏洞利用方式:**

1.  **身份验证绕过:** 攻击者通过发送特制的 HTTP 请求，其中包含特定的 cookie 值 (`currentAuth=31If; CrushAuth=1744110584619_p38s3LvsGAfk4GvVu0vWtsEQEv31If`) 和授权标头 (`AWS4-HMAC-SHA256 Credential=crushadmin/`)，来绕过身份验证控制。
2.  **创建管理员账户:**  成功绕过身份验证后，攻击者可以利用用户管理功能创建一个新的管理员账户，从而获得对 CrushFTP 服务器的完全控制权限。

**投毒风险评估：**

虽然提供的漏洞利用代码看起来功能完善，但仍存在一定的投毒风险。具体来说，`requirements.txt` 文件中可能包含恶意依赖项，或者 `cve_2025_31161.py` 脚本本身可能包含隐藏的后门代码，例如数据窃取或远程代码执行功能。此外，截图`https://github.com/user-attachments/assets/c278226c-a5f8-452a-a1e8-96062b226dd7` 存在钓鱼风险,诱导用户点击恶意链接.虽然代码本身的功能是利用漏洞创建管理员用户,并不能直接判断为投毒代码,考虑到github账号创建时间,代码编写质量等原因综合评估投毒风险为10%。

**有效性:**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞利用代码是有效的。多个来源都证实了 CVE-2025-31161 漏洞的存在以及被实际利用的情况。提供的 POC 代码也给出了明确的利用方法，即通过构造特定的 HTTP 请求来绕过身份验证并创建新的管理员账户。但实际利用时，务必对代码进行审计，确保不存在恶意代码。

**项目地址:** [ibrahimsql/CVE-2025-31161](https://github.com/ibrahimsql/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #14

**来源**: [CVE-2025-31161-ibrahmsql_CVE-2025-31161.md](../2025/CVE-2025-31161-ibrahmsql_CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP-身份验证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致管理员权限获取，系统完全控制

**影响版本:** < 10.8.4 (CrushFTP 10), < 11.3.1 (CrushFTP 11)

**利用条件:** 需要网络访问CrushFTP服务，并且目标版本在受影响范围内，非DMZ代理实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-31161 存在于 CrushFTP 10 (版本低于 10.8.4) 和 11 (版本低于 11.3.1) 中。该漏洞允许未经身份验证的攻击者绕过身份验证并接管 crushadmin 帐户，除非使用了 DMZ 代理实例。该漏洞利用 AWS4-HMAC 授权方法中的竞争条件和头部解析缺陷。通过发送畸形的 AWS4-HMAC 头部，可以触发服务器的 index-out-of-bounds 错误，阻止会话清理，从而允许攻击者以任何已知或可猜测的用户（例如 crushadmin）身份进行身份验证，最终完全控制系统。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确定该漏洞的PoC代码是有效的。搜索引擎结果中有多篇文章提到该漏洞已被在野利用。PoC代码也描述了具体的利用方法。

**投毒风险：**

评估PoC代码后，存在一定的投毒风险。具体分析如下：

*   **代码结构：** 代码结构比较清晰，包含了常见的漏洞利用流程。但是，代码中仍然可能存在作者隐藏的恶意代码，例如：
    *   **未记录的远程连接：** 代码中可能包含未记录的远程连接功能，例如连接到特定的服务器以下载或上传数据。
    *   **恶意Payload：** 代码中可以嵌入恶意的Payload，例如用于执行系统命令或安装后门程序。
    *   **信息收集：** 代码可以收集目标系统的敏感信息，例如用户名、密码、IP地址等，并将这些信息发送给攻击者。

基于上述分析，我估计该PoC代码的投毒风险为10%。

**利用方式：**

1.  **目标确认：** 确定目标CrushFTP服务器的版本是否在受影响范围内（低于 10.8.4 (CrushFTP 10) 或低于 11.3.1 (CrushFTP 11)），并且未使用 DMZ 代理。
2.  **构造恶意请求：**  构造包含畸形的AWS4-HMAC头部的HTTP(S)请求。关键在于提供用户名，但是缺少或篡改SignedHeaders条目以触发index-out-of-bounds错误。
3.  **绕过身份验证：**  利用漏洞绕过身份验证，以 crushadmin 或其他已知用户身份登录。
4.  **控制系统：**  成功登录后，攻击者可以执行任意操作，包括上传恶意文件、修改配置、创建新用户等，从而完全控制 CrushFTP 服务器。

**项目地址:** [ibrahmsql/CVE-2025-31161](https://github.com/ibrahmsql/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #15

**来源**: [CVE-2025-31161-llussiess_CVE-2025-31161.md](../2025/CVE-2025-31161-llussiess_CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP身份验证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统接管

**影响版本:** 10 (10.0 - 10.8.3) 和 11 (11.0 - 11.3.0)

**利用条件:** 目标系统运行受影响版本的CrushFTP，且未启用DMZ代理

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码（仅包含README.md），分析如下：

**有效性：** 提供的POC代码仅仅包含一个README.md文件，没有实际的利用代码，因此无法直接验证漏洞的有效性。但是，漏洞库信息和搜索结果都表明该漏洞已在野外被利用，说明该漏洞是真实存在的。参考搜索结果[webpage 3]，Huntress公司观察到CVE-2025-31161 在野外被利用,验证该漏洞存在。

**投毒风险：** 提供的漏洞利用代码只包含一个README.md文件，其中仅包含CVE编号，没有发现任何恶意代码，因此投毒风险极低，评估为0%。

**利用方式：** 

1.  **漏洞概述：** CrushFTP 10 (10.0 - 10.8.3) 和 11 (11.0 - 11.3.0) 存在一个身份验证绕过漏洞，攻击者可以绕过身份验证并接管`crushadmin`账户（除非使用了DMZ代理实例）。
2.  **漏洞原理：** 漏洞的根源在于HTTP组件的AWS4-HMAC认证方法存在缺陷。服务器首先通过调用`login_user_pass()`验证用户是否存在，而不需要密码。攻击者可以通过发送带有用户名但缺少`SignedHeaders`条目的畸形AWS4-HMAC头部，触发索引越界错误，阻止会话清理，从而成功以任意已知或可猜测的用户（例如`crushadmin`）进行身份验证。参考漏洞库信息和搜索结果[webpage 4]。
3.  **利用步骤：** 
    *   构造一个畸形的AWS4-HMAC头部，只包含用户名和一个斜杠(`/`)。
    *   发送该头部到CrushFTP服务器。
    *   服务器会成功找到用户名，触发`anypass`身份验证过程。
    *   由于缺少`SignedHeaders`条目，服务器会发生索引越界错误，阻止会话清理。
    *   攻击者成功以指定用户身份登录。
4.  **缓解措施：** 升级CrushFTP到10.8.4或11.3.1及以上版本。参考漏洞库信息和搜索结果。

总之，该漏洞利用方式较为简单，危害严重，需要尽快修复。

**项目地址:** [llussiess/CVE-2025-31161](https://github.com/llussiess/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

## POC #16

**来源**: [CVE-2025-31161-r0otk3r_CVE-2025-31161.md](../2025/CVE-2025-31161-r0otk3r_CVE-2025-31161.md)

## CVE-2025-31161-CrushFTP-认证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 认证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统权限控制

**影响版本:** 10.0.0 - 10.8.3 和 11.0.0 - 11.3.0

**利用条件:** CrushFTP服务需要通过HTTP(S)协议对外开放

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-31161 允许未经身份验证的攻击者绕过 CrushFTP 的身份验证，并接管 crushadmin 帐户（除非使用 DMZ 代理实例）。该漏洞利用了 HTTP 组件中 AWS4-HMAC (与 S3 兼容) 授权方法中的竞争条件。服务器首先调用 login_user_pass()，而无需密码，从而验证用户的存在。通过提供带有用户名和后缀斜杠（/）的伪造 AWS4-HMAC 标头，服务器可以成功找到用户名，从而触发 anypass 身份验证过程，但服务器将无法找到预期的 SignedHeaders 条目，从而导致索引越界错误，从而阻止代码到达会话清理。PoC 代码使用带有构造的 `CrushAuth` cookie 和 `Authorization` 标头的 GET 请求，通过 `/WebInterface/function/?command=getUserList&serverGroup=MainUsers` 端点获取用户列表，以证明认证绕过。由于其依赖于标准库并且没有执行任何可疑操作,投毒风险极低。

**项目地址:** [r0otk3r/CVE-2025-31161](https://github.com/r0otk3r/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)

---

