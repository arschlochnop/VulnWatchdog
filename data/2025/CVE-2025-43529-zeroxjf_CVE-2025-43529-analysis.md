## CVE-2025-43529 - Apple iOS, macOS (WebKit/JavaScriptCore) Use-After-Free (UAF) / 内存损坏

**漏洞编号:** CVE-2025-43529

**漏洞类型:** Use-After-Free (UAF) / 内存损坏

**影响应用:** Apple iOS, macOS (WebKit/JavaScriptCore)

**危害等级:** Critical (严重)

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** iOS < 26.2, macOS < 26.2

**利用条件:** 远程访问，诱导用户访问恶意网页，需触发DFG/FTL JIT编译优化

**POC 可用性:** 4/10

**POC 类型:** 概念验证/仅说明

**攻击复杂度:** 高

**投毒风险:** 10%

## 详情

【POC有效性分析】该漏洞存在于JavaScriptCore的DFG/FTL JIT编译器中，核心问题在于ObjectAllocationSinkingPhase（对象分配下沉阶段）的处理逻辑。通过分析POC文档，在26.1版本中，promoteLocalHeap函数在创建OSR退出提示（hints）时，未通过isUnescapedAllocation检查底层分配是否已经逃逸。这导致编译器可能为已经通过Phi合并逃逸的对象创建过时的提示。当系统触发OSR退出（从优化代码回退到解释器）时，运行时环境会根据这些错误的提示重建值，从而读取到已被释放或损坏的内存空间。虽然提供的代码片段主要是关键逻辑对比和汇编分析，没有直接给出完整的Python或JS利用脚本，但其深入到了二进制层面（如LocalHeap Entry大小从0x38变为0x48），为构造完整的RCE利用链提供了核心原语，证明了漏洞的可利用性极高且处于被积极利用状态。【利用步骤】1. 构造一个包含复杂循环和Phi合并逻辑的严格模式（strict-mode）JavaScript函数；2. 通过多次执行诱导DFG/FTL JIT编译器对该函数进行优化编译；3. 在循环中触发特定的对象逃逸场景（如存入全局变量或传递给外部函数）；4. 强制触发OSR退出（例如通过类型改变或异常），使系统使用错误的堆分配提示重建现场；5. 实现内存占位，通过UAF读取敏感信息或覆盖对象指针，最终实现代码执行。【投毒风险分析】目前该POC主要以技术文档和关键汇编对比的形式存在，尚未发现混淆的二进制包或自动化的恶意脚本，因此投毒风险较低（10%）。风险点主要在于后续可能出现的‘一键式利用脚本’。此类WebKit漏洞通常需要复杂的内存布局配合，攻击者可能在公开的利用框架中植入后门。防御人员在下载此类Exploit时，应重点关注脚本是否包含反连shell、是否尝试修改系统证书或下载额外的加密负载。建议在完全隔离的沙箱环境中进行复现分析，并对比补丁中新增的isUnescapedAllocation检查逻辑。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-43529](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-43529)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-43529](https://nvd.nist.gov/vuln/detail/CVE-2025-43529)
