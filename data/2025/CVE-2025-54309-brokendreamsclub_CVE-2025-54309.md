## CVE-2025-54309 - CrushFTP 身份验证绕过

**漏洞编号:** CVE-2025-54309

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 严重

**CVSS评分:** 未提供，参考描述为零日漏洞，严重

**影响版本:** 10.x < 10.8.5, 11.x < 11.3.4_23

**利用条件:** 无需身份验证，需要网络访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-54309是CrushFTP中的一个身份验证绕过漏洞，允许未经授权的管理员通过AS2标头操作创建用户。该漏洞位于`crushftp/server/ServerSessionHTTP.java`文件的`loginCheckHeaderAuth()`方法（第2285行），根本原因是AS2标头验证逻辑不正确。当HTTP请求包含一个空的或缺少`-_-`分隔符的`AS2-To`标头时，并且配置禁用`blank_passwords`（默认情况），该方法会过早返回，跳过任何身份验证过程。攻击者可以通过向`/WebInterface/function/`发送一个POST请求，并在请求体中包含`setUserItem`命令来利用此漏洞。由于`AS2-To`标头中缺少`-_-`分隔符，服务器绕过身份验证，从而在未经适当身份验证的情况下创建管理用户。提供的PoC脚本`cve_2025_54309.py`允许攻击者通过发送特制的HTTP请求到CrushFTP服务器来利用此漏洞。该脚本允许指定目标URL、用户名和密码。它还会验证登录是否成功。PoC有效性分析：该PoC通过构造包含恶意`AS2-To`标头的HTTP POST请求，成功绕过CrushFTP的身份验证机制。利用步骤如下：1.设置CrushFTP服务器；2.运行PoC脚本，提供目标URL和所需用户名和密码；3.验证是否使用提供的凭据创建了管理用户，并成功登录。投毒风险分析：此PoC代码清晰，仅使用标准Python库`requests`，未发现任何可疑行为。脚本目的是利用已知的身份验证绕过漏洞，而不是部署恶意软件或后门。虽然该脚本本身不包含恶意代码，但它可能被滥用于未经授权的访问。投毒风险较低，约为10%。大部分风险来自于攻击者可能修改脚本以包含其他恶意功能，但原始代码本身是干净的。

**项目地址:** https://github.com/blueisbeautiful/CVE-2025-54309

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-54309
