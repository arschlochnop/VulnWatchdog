## CVE-2025-32463 - Sudo 本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** Critical

**CVSS评分:** 9.3

**影响版本:** Sudo versions 1.9.14 to 1.9.17

**利用条件:** 需要本地低权限用户访问

**POC 可用性:** 10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

CVE-2025-32463 是 Linux sudo 组件中一个严重的高危本地提权漏洞，该漏洞影响 Sudo 从 1.9.14 版本到 1.9.17 版本的安装。漏洞的核心在于 Sudo 的 `--chroot` (或 `-R`) 选项在执行特权操作前，对非可信控制范围内的 `/etc/nsswitch.conf` 配置文件处理不当。攻击者可以利用这一缺陷，通过控制 chroot 环境下的 NSS (Name Service Switch) 配置文件，加载恶意构造的共享库，从而绕过权限限制，将低权限用户提升至 root 权限。该漏洞的利用成本极低，且已有公开的利用代码 (EXP)。官方已在 1.9.17p1 版本中修复此漏洞。

**POC有效性分析：**
该 POC 代码 (`CVE-2025-32463.sh`) 是一个功能完整的 Bash 脚本，用于演示和利用此本地提权漏洞。脚本首先创建一个临时目录，并在其中编译一个恶意的 C 代码文件 (`woot.c`)。该 C 代码包含一个构造函数 `woot`，其作用是将当前进程的有效用户ID和组ID设置为 0 (即 root)，然后执行 `/bin/bash` 以获得一个 root shell。接着，脚本在临时目录中构造一个伪造的 `chroot` 环境：它创建 `woot/etc` 和 `libnss_` 目录，并在 `woot/etc` 中生成一个恶意的 `nsswitch.conf` 文件，其中包含 `passwd: /woot` 配置，旨在将 NSS 模块的查找路径指向用户控制的目录。随后，脚本将编译后的恶意共享库命名为 `libnss_/woot.so.2` 放入 `libnss_` 目录。最后，通过执行 `sudo -R woot woot` 命令，利用 Sudo `--chroot` 选项的缺陷。当 Sudo 在 chroot 到 `woot` 目录并尝试加载 NSS 模块时，会读取伪造的 `nsswitch.conf`，并加载位于 `libnss_/woot.so.2` 的恶意共享库。恶意共享库的 `woot` 构造函数在加载时被执行，从而实现权限提升并获得一个 root shell。搜索结果中的 CSDN 链接也展示了成功复现的截图 (`id uid=0(root) gid=0(root)`), 进一步证实了 POC 的有效性。

**利用步骤：**
1.  下载 `CVE-2025-32463.sh` 脚本到本地机器。
2.  授予脚本执行权限：`chmod +x CVE-2025-32463.sh`。
3.  以低权限用户身份执行脚本：`./CVE-2025-32463.sh`。
4.  脚本将自动完成恶意文件的创建、编译和漏洞利用，最终会弹出一个 root 权限的 Bash shell。

**投毒风险分析：**
经分析，此 POC 代码的投毒风险极低。该脚本代码逻辑清晰，并未包含任何混淆代码。它完全在本地操作，不进行任何外部网络通信或下载外部资源。脚本的主要功能是编译一个简单的 C 代码，该代码的唯一目的就是通过设置 `setreuid(0,0)` 和 `setregid(0,0)` 来获取 root 权限，然后执行 `/bin/bash` 获得一个交互式 shell。这个 C 代码是标准的本地提权 Payload，并非恶意后门或病毒。脚本中使用的其他命令如 `mktemp`、`cd`、`echo`、`mkdir`、`cp`、`gcc` 和 `sudo` 都是标准 Linux 命令，且其用法符合漏洞利用的上下文。没有发现任何可疑的加密操作、反调试技术或其他恶意行为迹象。根据防御性安全研究的原则，不应将为验证漏洞而设计的、明确用于权限提升的后门代码视为投毒代码。因此，此 POC 不构成投毒风险。

**项目地址:** 

**漏洞详情:** https://avd.aliyun.com/detail?id=AVD-2025-32463
