## CVE-2025-31200 - Apple iOS, iPadOS, tvOS, visionOS 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-31200

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apple iOS, iPadOS, tvOS, visionOS

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** iOS 18.4 及以下版本

**利用条件:** 无需用户交互 (Zero-Click)，通过 iMessage 发送恶意 MP4 音频文件即可触发

**POC 可用性:** 4/10

**POC 类型:** 攻击链说明与逻辑分析

**攻击复杂度:** 高

**投毒风险:** 0%

## 详情

POC有效性分析：本报告分析的POC代码主要为攻击链文档描述，详细记录了如何通过iMessage利用CVE-2025-31200和CVE-2025-31201实现从远程代码执行到内核提权的完整过程。CVE-2025-31200存在于CoreAudio组件的AudioConverterService中。在处理AAC编码的恶意MP4文件时，由于对inMagicCookie参数的边界检查不足，攻击者可构造特殊的内存布局引发堆损坏。根据攻击链描述，由于iMessage在处理已知联系人发送的附件时会放宽BlastDoor沙箱的限制，使得恶意音频文件能够直接被音频解码服务解析。虽然提供的文档并非可直接运行的二进制利用工具，但其披露的攻击路径（AudioConverterService堆溢出 -> AppleBCMWLAN驱动提权 -> CryptoTokenKit越权操作）具有极高的技术参考价值。利用步骤：1. 攻击者获取目标联系方式，通过iMessage发送包含精心构造的inMagicCookie元数据的恶意MP4文件。2. 接收设备自动启动IMTransferAgent下载附件，音频子系统（audiomxd）在尝试解析文件头时触发AAC解码器的堆内存越权访问。3. 利用堆损坏控制执行流后，攻击者利用CVE-2025-31201（Wi-Fi驱动中的AMPDU处理漏洞）从沙箱环境逃逸至内核层。4. 获取内核权限后，攻击者调用CryptoTokenKit API绕过Secure Enclave的授权验证，实现对身份令牌的非法签名和设备伪造。投毒风险分析：由于本次分析的对象是基于Markdown格式的攻击链技术分析文档，不包含任何可执行脚本、混淆的二进制数据或外部下载请求，因此投毒风险评定为0%。在防御性研究场景下，此类文档通常作为内部威胁建模的参考，不涉及恶意库依赖。然而，由于该漏洞涉及iOS底层的密码学信任模型（CryptoTokenKit与Secure Enclave），防御者应注意：即使系统升级到18.4.1修复了内存破坏点，攻击者若在修复前已建立持久化或获取了签名凭证，仍可能造成持续影响。研究人员在复现该漏洞逻辑时应在隔离的MacOS/iOS研究环境中分析CoreAudio解析器，避免直接在生产环境测试此类零点击路径，以防意外触发真实的系统崩溃或非预期的内核状态变更。

**项目地址:** Internal Research - Vulnerability Watchdog

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/cve-2025-31200](https://nvd.nist.gov/vuln/detail/cve-2025-31200)
