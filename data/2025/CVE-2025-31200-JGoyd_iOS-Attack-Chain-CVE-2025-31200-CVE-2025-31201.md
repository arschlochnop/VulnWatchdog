## CVE-2025-31200 - Apple iOS, iPadOS, macOS, tvOS, visionOS RCE (远程代码执行)

**漏洞编号:** CVE-2025-31200

**漏洞类型:** RCE (远程代码执行)

**影响应用:** Apple iOS, iPadOS, macOS, tvOS, visionOS

**危害等级:** Critical (紧急)

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** iOS 18.4及以下版本, iPadOS 18.4及以下, macOS 15.3及以下等

**利用条件:** 无需用户交互 (Zero-Click)，通过iMessage、SMS或网页等途径发送恶意媒体文件即可触发

**POC 可用性:** 4/10

**POC 类型:** 概念验证/仅说明

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞（CVE-2025-31200）是位于Apple CoreAudio框架中AudioConverterService组件的堆溢出漏洞。根据提供的攻击链文档和搜索结果，该漏洞的有效性极高，已在野外被发现用于针对性攻击。POC的核心逻辑在于构造一个带有恶意‘inMagicCookie’的AAC编码音频流，封装在MP4容器中。由于AudioConverterService在处理AAC解码时未能正确验证Magic Cookie的大小或内容，导致内存越界写入。此漏洞不仅限于iMessage路径，任何调用CoreAudio进行自动预览或处理的组件（如Safari、邮件、第三方通讯软件）均可能触发。虽然目前公开的GitHub项目主要是攻击链的文档化描述和流程图，并未直接提供一键式二进制利用脚本，但其对攻击路径（绕过BlastDoor防护、触发堆损坏、结合CVE-2025-31201进行内核提权）的描述非常详尽，为专业攻击者提供了清晰的路线图。该漏洞通过iMessage传播时表现为Zero-Click（零点击），这意味着受害者无需点击文件，系统在后台进行附件预处理（如IMTransferAgent解密并物化附件）时即会触发漏洞，利用门槛极低，危害性极大。利用步骤通常包括：1. 构造畸形AAC音频文件；2. 将其封装为合法媒体格式；3. 通过iMessage向目标发送；4. 触发CoreAudio堆损坏执行初步Payload；5. 结合内核漏洞（如CVE-2025-31201）获取系统最高权限并持久化。此外，利用成功后即使不持久化，攻击者也能通过CryptoTokenKit滥用Secure Enclave保护的密钥进行非授权签名，这彻底瓦解了苹果的硬件信任根基。 【投毒风险分析】目前该CVE相关的GitHub仓库（如JGoyd/iOS-Attack-Chain-CVE-2025-31200-CVE-2025-31201）主要以披露攻击研究和技术文档为主。尽管如此，投毒风险评估为15%（低风险）。风险点在于：首先，此类极高价值的0-Day漏洞文档极易吸引安全研究员和恶意开发者下载，某些虚假的POC仓库可能会利用这种‘急切获取漏洞细节’的心理，在所谓的‘Exploit’脚本或环境搭建脚本中植入恶意代码（如针对研究员主机的窃密木马）。其次，由于真正的利用代码通常极为复杂且高度定制化，市面上出现的‘一键自动化工具’往往带有高度的可疑性，可能包含外部脚本请求或混淆的后门。在本案例中，JGoyd的仓库代码清晰度较高，主要由Markdown组成，暂未发现明显的投毒行为。但防御性研究员在复现此类涉及iMessage和CoreAudio的深层漏洞时，务必在隔离的实验环境中分析任何二进制附件，防止攻击者利用‘假POC’进行反向渗透。目前社区内关于此漏洞的讨论多集中在威胁预警和补丁比对上，真正的恶意投毒行为通常出现在漏洞刚公开的前48小时，建议组织内部仅参考Wiz、CISA或TAG等权威机构发布的缓解措施。

**项目地址:** [https://github.com/JGoyd/iOS-Attack-Chain-CVE-2025-31200-CVE-2025-31201](https://github.com/JGoyd/iOS-Attack-Chain-CVE-2025-31200-CVE-2025-31201)

**漏洞详情:** [https://www.wiz.io/vulnerability-database/cve/cve-2025-31200](https://www.wiz.io/vulnerability-database/cve/cve-2025-31200)
