## CVE-2025-55182 - React, Next.js 不安全反序列化导致的远程代码执行(RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 不安全反序列化导致的远程代码执行(RCE)

**影响应用:** React, Next.js

**危害等级:** Critical

**CVSS评分:** 10.0

**影响版本:** Next.js 15.0.4

**利用条件:** 未经身份验证的网络访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-55182 和 CVE-2025-66478 描述了 React Server Components (RSC) 使用的 Flight 协议中的一个严重漏洞。由于在反序列化传递给 Server Actions 的参数期间缺少类型验证，攻击者可以提供专门构造的“类数组”对象，这些对象被错误地解释为合法的参数列表。如果开发人员在敏感操作（如系统命令、SQL 查询或文件操作）中使用这些未经验证的参数，则该问题可能会升级为远程代码执行 (RCE)。该漏洞本身不会执行代码；它允许将任意参数注入到服务器端函数中。Flight 协议序列化各种类型的数据，包括对服务器操作及其绑定参数的引用。`.bind()` 机制允许 Server Actions 在运行之前接收预定义的参数。React Server DOM 的实现采用 `bound.value` 而不验证其类型。它假定它是一个数组，但实际上它可以是任何对象。然后服务器执行 `fn.bind.apply(fn, [null].concat(boundArgs))`。当传递给 `apply()` 时，JavaScript 将任何具有数字键和 `length` 属性的对象视为“类数组”。这允许攻击者将任意参数注入到开发人员定义的 Server Actions 中。 

POC有效性分析：提供的POC代码（README.md）详细描述了漏洞原理、利用方法和缓解措施，可以判断这是一个高质量的POC。漏洞利用发生在服务器端，利用React Server Components的反序列化过程，将恶意构造的参数注入到服务器端函数中，从而实现远程代码执行。PoC 描述的利用方法是有效的，因为该方法绕过了类型验证，并且利用了 JavaScript 的 `apply` 函数的特性。此PoC允许未经身份验证的攻击者通过发送特制的请求来控制服务器端的行为。 

利用步骤：
1. 攻击者构造一个包含恶意参数的“类数组”对象。
2. 攻击者将该对象作为参数发送到易受攻击的 Server Action。
3. 服务器端反序列化该对象，并将其作为参数传递给 `fn.bind.apply()`。
4. 恶意参数被注入到服务器端函数中，导致远程代码执行。

投毒风险分析：由于此漏洞允许远程代码执行，因此存在很高的投毒风险。攻击者可能会通过此漏洞在服务器上安装恶意软件、窃取敏感数据或篡改系统配置。此外，攻击者还可以利用此漏洞传播恶意代码，例如通过将恶意代码注入到网站的 JavaScript 文件中。由于 POC 本身仅包含漏洞的分析和利用说明，不包含实际的攻击代码，因此投毒风险较低。但是，攻击者可以根据此 POC 开发出包含恶意代码的攻击工具，从而提高投毒风险。此PoC代码相对清晰，主要用于演示漏洞原理，没有发现明显的混淆或恶意行为。使用的技术是标准的JavaScript库和函数，没有引入外部脚本或可疑请求。因此，初步判断该PoC的投毒风险较低，大约为10%。

**项目地址:** https://github.com/kalirsec/CVE-2025-55182

**漏洞详情:** https://www.example.com/CVE-2025-55182
