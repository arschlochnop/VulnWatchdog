## CVE-2025-30208 - Vite (Frontend Development Tooling) 任意文件读取/路径穿越

**漏洞编号:** CVE-2025-30208

**漏洞类型:** 任意文件读取/路径穿越

**影响应用:** Vite (Frontend Development Tooling)

**危害等级:** 高危 (High)

**CVSS评分:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (预估 7.5)

**影响版本:** < 6.2.3, < 6.1.2, < 6.0.12, < 5.4.15, < 4.5.10

**利用条件:** 远程未经身份验证，Vite 开发服务器正在运行且可被访问

**POC 可用性:** 8/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞是 Vite 开发服务器中的一个严重路径穿越缺陷，通过绕过对 `@fs` 路径的访问控制限制，允许攻击者读取服务器文件系统上的任意文件。所提供的 Python POC 代码逻辑非常清晰且直接。它通过向目标主机发送构造好的 HTTP GET 请求，访问 `/etc/passwd?raw` 路径来验证漏洞。在漏洞利用层面，关键点在于 Vite 的 `@fs` 机制旨在允许访问项目根目录外的文件，但由于对特殊编码或路径序列的校验不严，导致了权限绕过。该 POC 使用了 `requests` 库进行多线程扫描，并配合 `ThreadPoolExecutor` 提高检测效率。经过代码审计，该 POC 准确命中漏洞触发点，即利用 Vite 默认对特定查询参数（如 `?raw`）的处理逻辑来获取文件内容。此 POC 无需任何复杂的依赖环境，只需标准的 Python 环境和 requests 库即可运行，具备极高的实战验证价值，能够快速定位受影响资产。【利用步骤】1. 确定目标主机的 Vite 开发服务器运行端口（通常为 5173 等）。2. 使用 POC 工具，通过 `-u` 参数指定目标 URL。3. POC 将尝试拼接路径 `/etc/passwd?raw`。4. 观察响应状态码是否为 200 以及返回内容是否包含敏感系统信息（如 root:x:0:0）。5. 如果返回非空内容，则确认存在任意文件读取漏洞。【投毒风险分析】在对此提供的 POC 代码进行投毒分析后，结果显示该脚本的投毒风险处于较低水平（约 15%）。代码主要使用了 Python 的标准库（argparse, sys, threading, concurrent.futures）和常用的第三方库 requests。通过逐行审查，未发现任何明显的混淆代码、Base64 编码的恶意载荷或向第三方服务器发送敏感数据的行为。POC 的主要功能集中在循环请求和结果展示上。唯一的风险点通常在于此类自动化扫描脚本可能会在后台执行 `pip install -r requirements.txt`，如果 requirements 文件被篡改指向恶意包，则存在投毒可能。此外，虽然当前的 Python 脚本 `POC_CVE-2025-30208.py` 是安全的，但用户在下载此类包含 README 图片链接的存储库时，应警惕 README 中可能存在的钓鱼链接或图片隐写。该脚本在执行完毕后会创建一个 `vul_url.txt` 文件，这属于正常的扫描结果记录，不属于恶意投毒行为。总体而言，该 POC 是一个典型的安全研究工具，代码透明度高，但在使用前仍建议在隔离的沙箱环境中执行，以防其引用的依赖包存在供应链安全问题。

**项目地址:** [https://github.com/user-attachments/assets/fd5d0351-be2b-4f8e-8ef8-265d048a4116](https://github.com/user-attachments/assets/fd5d0351-be2b-4f8e-8ef8-265d048a4116) (相关资产路径)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-30208](https://nvd.nist.gov/vuln/detail/CVE-2025-30208)
