## CVE-2025-68613 - n8n (工作流自动化工具) RCE/沙箱逃逸

**漏洞编号:** CVE-2025-68613

**漏洞类型:** RCE/沙箱逃逸

**影响应用:** n8n (工作流自动化工具)

**危害等级:** 严重 (Critical)

**CVSS评分:** 9.9 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** 0.211.0 ≤ n8n < 1.120.4, n8n < 1.121.1, n8n < 1.122.0

**利用条件:** 需要用户认证(Authenticated)，默认配置下即可通过构造恶意表达式触发。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该POC脚本由B0NE$编写，是一个结构化的Python漏洞利用工具。代码逻辑清晰，首先通过`/rest/login`接口进行身份验证获取`n8n-auth`令牌，随后通过构造恶意的JavaScript表达式利用n8n内置表达式引擎的沙箱逃逸缺陷。该漏洞的核心在于n8n在处理特定工作流节点中的表达式时，未能完全隔离Node.js运行时环境，导致攻击者可以绕过沙箱限制调用系统底层命令。POC通过自动化流程实现登录、令牌提取、Payload注入及命令执行，展示了极高的可用性。其Payload通常利用Node.js的内置模块（如`child_process`）在沙箱内获取执行权限。利用步骤：1. 攻击者获取具有合法访问权限的n8n账号（低权限即可）；2. 使用POC工具提供目标URL及凭据进行登录，获取Session或API Key；3. POC向目标服务器发送特定的API请求，创建一个包含恶意表达式的工作流节点；4. 触发该节点的执行，导致恶意表达式在后台沙箱环境中解析并逃逸；5. 成功在服务器操作系统层面执行任意命令（如反弹Shell或读取敏感文件）。投毒风险分析：该脚本代码可读性强，主要依赖`requests`、`argparse`等标准库，未见混淆处理。虽然脚本中包含Banner艺术字和作者标识，但其核心逻辑专注于漏洞利用还原，没有发现明显的恶意外部连接（如回传Token到第三方服务器）或自我复制行为。脚本中的敏感操作（如执行反弹Shell的Payload）是由用户输入参数控制的，符合安全研究工具的特征。然而，由于此类RCE工具在地下黑客社区传播极快，且其身份验证逻辑可以被恶意修改为窃取用户输入的凭据，因此仍存在低度风险。建议防御者在受控沙箱环境下运行此POC，并严格监控其网络流量，防止其在不知情的情况下泄露测试环境的敏感信息。目前该POC主要风险在于其便利性降低了攻击门槛，而非代码本身的恶意性注入。

**项目地址:** [https://github.com/n8n-io/n8n](https://github.com/n8n-io/n8n)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-68613](https://nvd.nist.gov/vuln/detail/CVE-2025-68613)
