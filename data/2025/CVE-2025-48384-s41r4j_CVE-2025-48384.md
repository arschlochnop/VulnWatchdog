## CVE-2025-48384 - Git 任意文件写入

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 任意文件写入

**影响应用:** Git

**危害等级:** 高危

**CVSS评分:** 未知

**影响版本:** 受影响的Git CLI版本未知

**利用条件:** 需要用户克隆包含恶意配置的Git仓库

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 20%

## 详情

CVE-2025-48384是Git中存在的一个严重漏洞，该漏洞源于Git对配置值中回车符（CR）处理不当，可能导致子模块检出期间出现路径遍历问题。攻击者可以利用此漏洞在特定条件下执行任意代码。该漏洞于2025年7月8日公开披露，并于2025年8月26日进行了最后修改。它已于2025年8月25日被添加到美国网络安全和基础设施安全局（CISA）已知被利用漏洞（KEV）目录中，表明该漏洞已在野外被积极利用，补救到期日为2025年9月15日。

该问题源于Git处理配置值的方式：在读取配置值时，Git会删除任何尾随的回车符和换行符（CRLF）。但是，在写入配置条目时，包含尾随CR的值未被正确引用，导致CR在后续读取期间丢失。这种差异会导致子模块被检出到错误的位置（如果其路径包含尾随CR）。如果攻击者设置一个将此更改后的路径指向子模块的hooks目录的符号链接，并且子模块包含一个可执行的post-checkout hook，则在检出后可能会无意中执行该hook脚本，从而导致任意代码执行。

**POC有效性分析：**

根据提供的Dockerfile和README.md，该POC旨在演示CVE-2025-48384漏洞。Dockerfile用于构建一个包含易受攻击的Git版本的环境，README.md文件详细解释了漏洞的原理和利用方法。POC代码通过创建一个包含恶意配置的Git仓库，并诱导用户克隆该仓库来触发漏洞。通过精心构造的子模块路径和符号链接，攻击者可以在用户克隆仓库时执行任意代码。POC代码的有效性在于它能够重现漏洞的利用过程，并证明攻击者可以利用该漏洞在目标系统上执行恶意操作。

**利用步骤：**

1.  攻击者创建一个包含恶意.gitmodules文件的Git仓库，该文件中的子模块路径包含尾随CR字符。
2.  攻击者在仓库中创建一个符号链接，将修改后的子模块路径指向.git/hooks/post-checkout。
3.  攻击者将包含恶意配置和符号链接的仓库托管在公共服务器上或通过其他方式分发给目标用户。
4.  目标用户克隆该恶意仓库。
5.  当Git尝试检出子模块时，由于CR字符的处理不当，子模块将被检出到错误的位置，即符号链接指向的.git/hooks/post-checkout目录。
6.  如果子模块包含一个可执行的post-checkout hook，则该hook脚本将被执行，从而导致任意代码执行。

**投毒风险分析：**

该POC的投毒风险较低，因为提供的代码主要用于演示漏洞的利用，并没有明显的恶意行为。Dockerfile用于构建测试环境，README.md用于解释漏洞原理，POC代码本身也没有包含任何可疑的代码或外部依赖。然而，攻击者可能会修改POC代码，添加恶意功能，例如：

*   **代码混淆：** 攻击者可以使用代码混淆技术来隐藏恶意代码，使其更难被检测。
*   **恶意行为：** 攻击者可以在post-checkout hook中添加恶意代码，例如：安装后门、窃取敏感信息、破坏系统等。
*   **外部脚本：** 攻击者可以从外部服务器下载恶意脚本并在post-checkout hook中执行。

尽管存在这些潜在的风险，但原始POC代码的投毒风险较低，约为20%。在实际应用中，用户应谨慎克隆来自不受信任来源的Git仓库，并仔细检查.gitmodules文件和post-checkout hook，以防止受到攻击。

**项目地址:** https://github.com/liamg/CVE-2025-48384

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-48384
