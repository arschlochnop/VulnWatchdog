## CVE-2024-34351 - Next.js / React Framework 原型链污染 (Prototype Pollution) / SSRF

**漏洞编号:** CVE-2024-34351

**漏洞类型:** 原型链污染 (Prototype Pollution) / SSRF

**影响应用:** Next.js / React Framework

**危害等级:** 高危 (High)

**CVSS评分:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

**影响版本:** Next.js < 14.1.1

**利用条件:** 应用使用了 Next.js Server Actions 功能，且未对参数进行严格校验。

**POC 可用性:** 7/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：提供的 Go 语言 POC 代码主要针对 Next.js 的 Server Actions 漏洞进行自动化测试。该漏洞（CVE-2024-34351）源于 Next.js 在处理 Server Actions 时，由于服务端函数对接收参数的校验存在缺陷，允许攻击者通过精心构造的 JSON Payload 触发 JavaScript 原型链污染。在服务端环境中，这种污染可以被利用来覆盖全局对象属性，进而干扰内部的网络请求逻辑。通过污染如 'protocol' 或 'hostname' 等属性，攻击者能够诱导服务器向恶意第三方地址发起请求，实现 SSRF（服务端请求伪造）。在特定配置下，若攻击者能够进一步控制重定向后的响应内容或干扰模块加载流程，甚至可能演变为远程代码执行（RCE）。此 POC 代码通过 multipart/form-data 格式发送包含污染 payload 的 POST 请求，并设置特定的 'Next-Action' 头部，这符合该漏洞的触发特征。代码逻辑清晰，使用了 errgroup 实现高并发请求，能有效验证目标服务器在处理高频恶意请求时的响应稳定性，具有较高的实战验证参考价值。利用步骤：1. 识别目标 Next.js 应用是否启用了 Server Actions。2. 构造包含 __proto__ 键值的 JSON 对象。3. 向目标 URL 发送 POST 请求，Header 需包含 Next-Action ID。4. 观察服务端是否执行了预期的越权操作或发起了外部连接。投毒风险分析：该 POC 脚本编写规范，主要依赖 Go 标准库（net/http, mime/multipart, sync 等）以及 golang.org/x/sync 扩展库。代码逻辑透明，直接展示了如何构造恶意的 HTTP 请求包，并未发现任何代码混淆、二进制下载或敏感信息窃取逻辑。唯一潜在的风险点在于 POC 中硬编码的请求循环可能对目标造成拒绝服务（DoS）影响，而非传统的恶意后门投毒。虽然代码中引用了外部同步库，但这是 Go 开发中的常规依赖。经过静态审计，未发现该 POC 会对执行环境造成持久化威胁或文件系统破坏。对于防御者而言，此代码是安全的分析样本，主要风险在于如果被恶意用户修改并发参数，可能演变成简单的攻击工具。整体投毒风险极低，属于典型的安全研究验证脚本。

**项目地址:** N/A

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-34351](https://nvd.nist.gov/vuln/detail/CVE-2024-34351)
