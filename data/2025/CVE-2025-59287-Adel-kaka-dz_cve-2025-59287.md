## CVE-2025-59287 - Microsoft Windows Server Update Services (WSUS) 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Server Update Services (WSUS)

**危害等级:** 高危

**CVSS评分:** 9.8

**影响版本:** Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022, Windows Server 2025

**利用条件:** 无需认证，远程网络访问

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-59287是一个存在于Microsoft Windows Server Update Services (WSUS)中的高危远程代码执行漏洞。该漏洞的根本原因是WSUS在处理AuthorizationCookie时，使用了.NET的BinaryFormatter进行不安全的对象反序列化，导致未经身份验证的远程攻击者可以发送特制的事件来触发漏洞。攻击者无需任何身份凭证即可通过网络远程触发此漏洞，实现对目标WSUS服务器的完全控制，CVSS评分为9.8分（满分10分）。

**POC有效性分析:**
该POC是一个名为“CVE-2025-59287-WSUS-Exploit”的Python工具包，由“adel-h4x0a”开发。根据提供的`README.md`文件，该工具包旨在演示CVE-2025-59287这一Windows Server Update Services (WSUS)中远程代码执行漏洞的利用过程。此POC结构清晰，包含两个核心模块：`cve-2025-59287-encr.py`用于负载（payload）加密，支持传统（legacy）和安全（secure）两种AES加密模式，并允许自定义负载生成；`cve-2025-59287-exp.py`则是完整的漏洞利用模块，负责执行攻击链。该利用模块设计得相当健壮，内置了错误处理和重试逻辑，并支持自定义加密后的负载。使用前需要安装`requirements.txt`中列出的依赖项。`README.md`提供了详细的用法说明和命令行参数示例，涵盖了从负载生成到实际利用的整个过程，例如使用`--command "calc"`或`--command "whoami /all"`来执行命令。其模块化设计和清晰的文档表明这是一个功能完善且易于使用的漏洞利用工具，表明其具备较高的利用可靠性和有效性。此POC的出现进一步证实了CVE-2025-59287漏洞的真实性和可利用性，并可能被威胁行为者用于实际攻击。

**利用步骤:**
利用此POC的步骤如下：
1.  **环境准备**：首先确保系统已安装Python环境。然后，下载或克隆该POC工具包到本地。进入项目目录后，通过运行`pip install -r requirements.txt`命令安装所有必要的Python依赖库。
2.  **负载生成（可选）**：如果需要执行自定义命令而非默认的`calc`，可以使用`cve-2025-59287-encr.py`模块来生成加密的负载。例如，要执行`whoami /all`命令并将结果保存到`custom_payload.txt`文件，可以运行命令：`python cve-2025-59287-encr.py --command "whoami /all" --output custom_payload.txt`。此步骤允许攻击者灵活地定制执行的恶意代码。
3.  **执行漏洞利用**：使用`cve-2025-59287-exp.py`模块对目标WSUS服务器执行攻击。命令格式为`python cve-2025-59287-exp.py [WSUS服务器URL] [选项]`。例如，如果目标WSUS服务器地址为`http://wsus.internal.com:8530`，并且希望使用之前生成的`custom_payload.txt`作为负载，则执行命令：`python cve-2025-59287-exp.py http://wsus.internal.com:8530 --payload custom_payload.txt`。如果不指定`--payload`参数，POC将使用默认的`calc`命令作为负载进行尝试。利用模块会处理与WSUS服务器的通信、不安全的反序列化触发，最终在目标服务器上执行指定的命令。攻击者还可以通过`--timeout`和`--retries`等参数调整请求超时和重试次数，以适应不同的网络环境。

**投毒风险分析:**
针对此POC的投毒风险评估为**低**（10%）。主要原因如下：
首先，该POC的`README.md`文件明确指出其用途是“出于教育和授权测试目的”，并包含详细的“法律免责声明”，强调未经授权使用是非法的。这表明其设计初衷是用于合法安全研究和渗透测试，而非恶意投毒。
其次，POC的代码是公开的Python脚本，这意味着代码是透明的，可以由安全研究人员进行审查。在`README.md`中，POC的结构和功能描述得非常清晰，包括负载加密模块(`cve-2025-59287-encr.py`)和漏洞利用模块(`cve-2025-59287-exp.py`)。其依赖项列于`requirements.txt`中，这些依赖库通常是标准的Python库或常见的安全库，没有迹象表明引入了恶意或可疑的第三方代码。
第三，POC的示例用法中，指定的命令都是良性的，例如`calc`（打开计算器）、`whoami /all`（显示当前用户和组信息）和`ipconfig`（显示网络配置），这些都是典型的用于验证代码执行漏洞的测试命令，不具有直接的恶意破坏性。代码中没有发现混淆、加密的恶意载荷、或在后台静默执行可疑操作的机制。
第四，虽然搜索结果中提到“攻击者针对启用WSUS的Windows服务器，利用CVE-2025-59287获取初始访问权限，然后使用PowerCat获取系统shell”，但这描述的是真实攻击者在成功利用漏洞后进一步的**后渗透阶段**所使用的工具和方法，并非此POC代码本身包含PowerCat或任何其他恶意后门程序。此POC专注于实现漏洞触发和命令执行，至于执行何种命令，则由使用者通过`--command`或`--payload`参数自行决定。这意味着，虽然POC可以被恶意利用，但其本身不携带恶意代码，也未在自身内部嵌入投毒逻辑。
综上所述，该POC的代码质量、透明度以及明确的免责声明，都使其直接的投毒风险极低。潜在的风险在于，恶意行为者可能会下载并修改该POC，在其中植入恶意代码以进行投毒攻击，或者利用该POC执行恶意的自定义payload。然而，这属于POC的滥用范畴，而非POC本身携带投毒风险。因此，在使用该POC时，建议对其所有代码（包括依赖库）进行彻底的安全审查，并仅在授权的环境中使用。

**项目地址:** https://github.com/adel-h4x0a/CVE-2025-59287-WSUS-Exploit

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-59287
