## CVE-2025-59287 - Windows Server Update Service (WSUS) 远程代码执行

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 远程代码执行

**影响应用:** Windows Server Update Service (WSUS)

**危害等级:** 关键

**CVSS评分:** 9.8

**影响版本:** 未指定

**利用条件:** 需要网络访问，可能无需认证

**POC 可用性:** 10/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-59287是微软Windows Server Update Services (WSUS)中发现的一个关键远程代码执行（RCE）漏洞，CVSS评分高达9.8。该漏洞允许未经授权的攻击者在受影响的WSUS服务器上远程执行任意代码，从而可能导致系统完全受控、敏感数据泄露或进一步的网络渗透。根据公开信息，该漏洞在微软发布补丁后仅10天内就被黑客武器化，且从PoC公开到首次攻击落地间隔不足48小时，表明其利用难度低，威胁等级高。美国境内的大学、科技公司、制造企业及医疗机构已率先“中招”。

**POC有效性分析:**
所提供的PoC代码文档（`README.md`）详细描述了一个功能完整的利用工具包，名为"CVE-2025-59287 - WSUS Exploitation Toolkit"，由adel-h4x0a开发。该工具包包含两个核心组件：`cve-2025-59287-encr.py`（加密模块）和`cve-2025-59287-exp.py`（利用模块）。加密模块负责为WSUS通信进行AES负载加密，支持传统和安全两种加密模式，并允许自定义负载生成。利用模块则实现了针对CVE-2025-59287的完整利用链，具备健壮的错误处理和重试逻辑，同样支持自定义负载。`README.md`中提供了清晰的组件说明、项目结构、详细的安装先决条件（`pip install -r requirements.txt`）以及丰富的用法示例，包括基础加密、带自定义密钥的加密、输出保存、基础利用、带自定义负载的利用以及高级设置（如超时和重试次数）。此外，还提供了“Complete Example”演示了从生成自定义负载到执行利用的完整工作流程。这些信息表明该PoC代码是高度完整、可用且文档齐全的，能够有效地验证和演示CVE-2025-59287漏洞的利用过程。搜索结果中提到该漏洞在PoC公开后不到48小时内即被武器化并用于实际攻击，也间接证明了该PoC或类似利用代码的有效性和易用性。因此，该PoC的质量非常高，被评为10/10。

**利用步骤:**
1.  **环境准备:** 确保系统已安装Python环境，并根据`requirements.txt`文件安装所有必要的依赖项。命令示例：`pip install -r requirements.txt`。
2.  **生成加密负载（可选但推荐）:** 攻击者可以使用`cve-2025-59287-encr.py`模块来生成经过AES加密的命令负载。例如，要执行`whoami /all`命令并将结果保存到`custom_payload.txt`文件中：`python cve-2025-59287-encr.py --command "whoami /all" --output custom_payload.txt`。该模块还支持指定AES密钥和加密模式。
3.  **执行漏洞利用:** 使用`cve-2025-59287-exp.py`模块对目标WSUS服务器发起攻击。攻击者需要提供目标WSUS服务器的URL（例如`http://wsus.internal.com:8530`）。如果之前生成了自定义负载，可以通过`--payload`参数指定负载文件。例如：`python cve-2025-59287-exp.py http://wsus.internal.com:8530 --payload custom_payload.txt`。执行后，如果利用成功，指定的命令将在WSUS服务器上远程执行。利用模块还支持设置请求超时和重试次数，以提高攻击的可靠性。

**投毒风险分析:**
根据提供的PoC代码`README.md`内容，该工具包明确声明“仅用于教育和授权测试目的”，并且包含详细的法律免责声明，警告用户不得将其用于未经授权的系统。代码结构清晰，分为加密和利用两个模块，功能围绕漏洞利用的核心需求：生成并发送恶意负载以执行命令。文档中未提及任何代码混淆、外部恶意连接、在攻击者机器上植入后门或进行其他未声明的恶意行为。生成的负载内容是用户明确指定的命令（例如`calc`、`whoami`、`ipconfig`），这些是标准的安全测试命令，并非固定的恶意负载。因此，从已披露的PoC描述来看，该PoC代码本身被“投毒”的风险极低，评估为10%。作为防御性安全研究员，在使用任何公开PoC时，始终建议在受控环境中进行沙盒分析，审查所有代码和依赖项，以确保其安全性。但就目前掌握的信息而言，该PoC旨在提供一个合法且功能完整的漏洞验证工具。

**项目地址:** 未在提供的数据中找到

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-59287
