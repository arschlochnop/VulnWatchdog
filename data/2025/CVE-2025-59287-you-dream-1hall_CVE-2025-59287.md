## CVE-2025-59287 - Microsoft Windows Server Update Services (WSUS) 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Server Update Services (WSUS)

**危害等级:** 高危

**CVSS评分:** 9.8

**影响版本:** Microsoft Windows Server (所有受支持版本，需WSUS组件)

**利用条件:** 需要网络访问，未经认证

**POC 可用性:** 10/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-59287是一个针对Microsoft Windows Server Update Services (WSUS) 的高危远程代码执行漏洞，CVSS评分为9.8。根据公开披露的信息，微软已为此漏洞发布了紧急带外安全更新，表明其威胁等级极高。此漏洞允许未经身份验证的攻击者通过网络向WSUS服务器发送特制的请求，从而在目标系统上以SYSTEM权限执行任意代码。搜索结果也明确指出此漏洞已被积极利用，用于分发如ShadowPad等恶意软件，这进一步印证了其严重的现实威胁。

**POC有效性分析：**
提供的POC代码是一个名为“WSUS Security Research Toolkit”的Python工具集，包含`exp.py`主执行脚本和`encrypt.py`负载准备工具。README文档非常详尽，提供了清晰的系统要求、安装步骤、Python版本检查、文件下载、负载准备方法（通过`payload.txt`文件或`encrypt.py`工具）、运行命令示例以及详细的故障排除指南。该工具通过向目标WSUS服务器发送SOAP请求来利用漏洞，并提及了输出中包含“SOAP request/response information”和“deserialization attempts”的成功/失败状态，这强烈暗示该漏洞与.NET反序列化有关。攻击者可以准备Base64编码的.NET序列化数据作为恶意负载，并由`exp.py`发送到WSUS服务器。鉴于该POC工具旨在准备和发送任意Base64编码的数据，并且在输出中清晰地展示了反序列化尝试的结果，可以判断这是一个高度完整且功能强大的漏洞利用工具。结合漏洞已被积极利用来分发恶意软件的背景，该POC的有效性极高，能够用于验证和利用此RCE漏洞。

**利用步骤：**
1.  **环境准备**：确保攻击机上安装了Python 3.4或更高版本。通过Git克隆POC代码仓库：`git clone https://github.com/you-dream-1hall/CVE-2025-59287`。
2.  **负载准备**：创建或编辑`payload.txt`文件，将预先准备好的Base64编码的.NET反序列化负载粘贴到其中。或者，使用`encrypt.py`工具从二进制文件生成格式化的Base64负载：`python encrypt.py -i input_file.bin -o output.txt --key YOUR_HEX_KEY`。此负载应设计为在目标WSUS服务器上执行恶意命令（例如，下载并执行恶意软件、创建后门账户等）。
3.  **执行攻击**：运行`exp.py`脚本，指定目标WSUS服务器的URL和端口：`python exp.py http://wsus-server.example.local:8533`。根据需要，可以添加`--no-wait`等选项以跳过请求间的延迟。
4.  **结果观察**：观察工具输出，确认连接状态、SOAP请求/响应以及反序列化尝试的结果。如果负载成功执行，则表示攻击成功，目标WSUS服务器将执行恶意负载中的代码。

**投毒风险分析：**
该POC代码本身的投毒风险评估为低（5%）。README文档明确声明这是一个“WSUS Security Research Toolkit”，并强调“Only use on systems you own or have written authorization to test”以及“Recommended for isolated lab environments”。代码结构清晰，主要分为用于利用的`exp.py`和用于负载准备的`encrypt.py`。`encrypt.py`的功能是生成用于漏洞利用的Base64编码数据，而不是在工具本身中嵌入恶意功能。在提供的README信息中，没有发现代码混淆、调用外部未知资源、执行可疑系统命令或其他恶意行为的迹象。该工具的目的是作为安全研究和漏洞验证的辅助工具，其设计理念是帮助用户利用此漏洞，而不是攻击运行POC的用户。用户自行准备和提供的“test data”或“custom test data”才是承载实际恶意逻辑的部分，POC工具本身不包含这些恶意代码。因此，从防御性安全研究的角度来看，虽然此POC能够造成严重的RCE攻击，但其代码本身并不构成对使用者主机的“投毒”风险。

**项目地址:** https://github.com/you-dream-1hall/CVE-2025-59287

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-59287
