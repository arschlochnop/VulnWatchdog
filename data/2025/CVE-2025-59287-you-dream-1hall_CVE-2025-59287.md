## CVE-2025-59287 - Microsoft Windows Server Update Services (WSUS) 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Server Update Services (WSUS)

**危害等级:** 高危

**CVSS评分:** 9.8

**影响版本:** Windows Server 2025, Windows Server 2022, Windows Server 2019

**利用条件:** 未经身份验证的远程攻击者, 需要网络访问

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-59287 是一个高危的远程代码执行 (RCE) 漏洞，影响 Microsoft Windows Server Update Services (WSUS)，CVSS 评分高达 9.8。此漏洞的根本原因是 WSUS 在处理 `AuthorizationCookie` 时存在不安全的传统序列化机制，尤其涉及 .NET 的 `BinaryFormatter`。未经身份验证的远程攻击者可以通过发送特制的事件来触发不安全的对象反序列化，从而导致在目标服务器上执行任意代码，无需任何身份凭证即可实现完全控制。受影响的 Windows Server 版本包括 Windows Server 2025、Windows Server 2022 和 Windows Server 2019。

**POC有效性分析 (POC Effectiveness Analysis)**:
所提供的“WSUS Security Research Toolkit”是一个功能强大且文档完备的 CVE-2025-59287 漏洞利用工具。其 `README.md` 文件清晰地概述了利用 WSUS 中不安全反序列化漏洞的全面框架。`exp.py` 被明确描述为主执行脚本，可能包含了构建和发送恶意 `AuthorizationCookie` 有效载荷的核心逻辑。该工具包还包括 `encrypt.py`，一个“有效载荷准备工具”，这表明它支持自定义有效载荷的生成，以满足特定的 RCE 目标。此工具至关重要，因为它允许攻击者（或研究人员）创建格式正确的 Base64 编码数据，从而绕过 .NET 反序列化过程的安全检查。清晰的系统要求（Windows/Linux，Python 3.4+）、详细的安装步骤（Git 克隆、文件验证）以及多种有效载荷配置方法（通过 `payload.txt` 或 `encrypt.py`）都突显了该工具的完整性和易用性。此外，提供命令行选项（例如 `--no-wait`）和各种场景（基本测试、自定义端口）的示例命令，进一步证明了该工具的成熟度。故障排除部分，解决了“Connection refused”或“Module not found”等常见问题，也证实了其操作就绪性和在测试环境中的实际适用性。该工具包的设计通过针对 `AuthorizationCookie` 的 .NET 反序列化处理，直接解决了 CVE-2025-59287 的核心问题，使其在演示和利用此特定 RCE 漏洞方面非常有效。

**利用步骤 (Exploitation Steps)**:
使用此工具包利用 CVE-2025-59287 涉及以下步骤：
1.  **环境设置**：准备一台安装有 Python 3.4 或更高版本且能够网络访问目标 WSUS 服务器（通常在 8533 或 8534 端口）的攻击机。
2.  **获取工具包**：通过 Git 克隆提供的 GitHub 存储库：`git clone https://github.com/you-dream-1hall/CVE-2025-59287`。
3.  **文件验证**：确认克隆目录中存在 `exp.py`（主漏洞利用脚本）、`encrypt.py`（有效载荷准备）和 `payload.txt`（可选的 Base64 编码数据）。
4.  **有效载荷准备**：
    *   **方法 A (通过 `payload.txt`)**：在工具包目录中创建或修改 `payload.txt`，并插入 Base64 编码的恶意 .NET 序列化有效载荷。
    *   **方法 B (通过 `encrypt.py`)**：为了生成自定义有效载荷，使用命令 `python encrypt.py -i input_file.bin -o output.txt --key YOUR_HEX_KEY`，这将生成所需的 Base64 格式数据。
5.  **执行**：通过执行 `exp.py` 并指定目标 WSUS 服务器的 URL 和端口来启动漏洞利用：`python exp.py http://wsus-server.example.local:8533`。请将占位符替换为实际的目标地址。
6.  **后续操作**：观察工具包的输出，包括连接状态、SOAP 请求/响应详情、生成的事件 ID，以及反序列化尝试的最终成功或失败状态，以判断是否成功远程代码执行。

**投毒风险分析 (Poisoning Risk Analysis)**:
根据“WSUS Security Research Toolkit”的 `README.md` 文件，与此 POC 相关的投毒风险被认为较低（评级为 10%）。有几个因素促成了这一评估：首先，文档对其目的非常清晰透明：它是一个“安全研究工具包”，旨在演示一个已知漏洞（CVE-2025-59287）。这种明确的意图声明显著降低了存在隐藏恶意功能的可能性。其次，`README.md` 包含一个专门的“安全注意事项”部分，强烈建议用户“仅在您拥有或获得书面授权的系统上使用”并推荐在“隔离的实验室环境”中使用。它还强调了记录所有测试活动并断开与生产系统连接的重要性。此类道德免责声明是合法安全研究工具的特征，并强烈表明其不含恶意意图。第三，所提及的组件（`exp.py`、`encrypt.py`、`payload.txt`）都符合反序列化漏洞的标准利用工作流程。`exp.py` 被描述为“主执行脚本”，预计包含核心利用逻辑。`encrypt.py` 被明确定义为“有效载荷准备工具”，这是生成利用所需的格式正确有效载荷（例如，Base64 编码的 .NET 小工具）的常见组件。在提供的文档中，没有提及外部混淆脚本、对未知 C2 服务器的可疑网络请求，或以无法追踪的方式使用 `eval()` 或其他危险函数。最后，存储库 URL `https://github.com/you-dream-1hall/CVE-2025-59287` 看起来是一个用于安全项目的标准 GitHub 链接。虽然 GitHub 存储库可能托管恶意代码，但此处随附的清晰且符合道德规范的文档表明这是一项合法的研究工作，而非供应链攻击载体。该工具包的重点纯粹是通过不安全的反序列化来演示 RCE 漏洞，而不是嵌入后门或其他秘密功能。因此，遵守所提供说明和安全注意事项的用户不太可能从 POC 本身遇到隐藏的恶意代码或意外的系统危害，除了对目标 WSUS 服务器的预期利用之外。

**项目地址:** https://github.com/you-dream-1hall/CVE-2025-59287

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-59287
