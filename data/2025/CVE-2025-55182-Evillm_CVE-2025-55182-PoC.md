## CVE-2025-55182 - React Server Components, Next.js 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React Server Components, Next.js

**危害等级:** 危急

**CVSS评分:** 10.0

**影响版本:** 未在公开披露中详细说明具体版本号，但影响使用“Flight”协议的React Server Components和Next.js应用程序，尤其是与`react-server-dom-we`相关的组件。

**利用条件:** 无需认证，通过网络可访问，攻击者需构造精心设计的请求。

**POC 可用性:** 9

**POC 类型:** 完整利用 (验证型)

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-55182，绰号“React2Shell”，是一个严重的远程代码执行（RCE）漏洞，其CVSS评分为10.0（最高危）。该漏洞主要影响React Server Components (RSC) 及其上构建的Next.js应用程序。漏洞核心在于RSC架构中“Flight”协议对用户输入处理不当，导致不安全的反序列化，最终允许未认证的攻击者通过精心构造的请求在服务端执行任意代码。自2025年12月3日公开披露以来，该漏洞已遭到大规模的实际利用，甚至有与国家背景相关的威胁行为者积极利用此漏洞，使其成为安全界的“新顶流”和“核弹级”威胁。

**POC有效性分析：**
所提供的POC是一个结构完善的Python扫描器，旨在安全地验证CVE-2025-55182漏洞。它通过Docker Compose提供了一个完整的、易于部署的易受攻击的Next.js应用程序环境，极大降低了复现门槛。POC的`scanner.py`脚本利用`httpx`等标准库，能够向目标URL发送特制的请求，以触发漏洞并执行预设的“安全”命令，如`id`和`ping`。通过解析返回的响应，POC能够判断目标系统是否易受攻击，并打印出命令执行的结果，从而直观地证明RCE的存在和可利用性。POC的README文档清晰地描述了部署和运行步骤，包括预期的成功输出，例如“VULNERABLE! RCE confirmed.”和命令`id`的输出（如`uid=1001(nextjs)...`）。整体而言，该POC功能完整，易于操作，且明确表示为安全验证而非恶意攻击，是进行防御性研究和应急响应的有效工具。

**利用步骤：**
1.  **部署易受攻击的环境：** 进入`Stand`目录，执行`docker compose up --build`命令，启动一个存在漏洞的Next.js应用程序，通常会在`http://localhost:3011`运行。
2.  **准备POC环境：** 进入`PoC/src`目录。
3.  **安装依赖：** 确保Python环境就绪，并使用`poetry install`安装项目所需的依赖，如`httpx`等。
4.  **运行扫描器：** 执行`poetry run python scanner.py http://localhost:3011`命令（将`http://localhost:3011`替换为实际的目标URL）。
5.  **观察结果：** 扫描器将输出检测结果。如果目标存在漏洞，它将显示“VULNERABLE! RCE confirmed.”以及执行`id`或`ping`等安全命令的输出结果。扫描结果还会保存到`result.txt`文件中。

**投毒风险分析：**
根据对提供的POC代码的分析，其投毒风险评估为低（10%）。主要理由如下：
1.  **明确的防御目的：** POC的`README.md`和`scanner.py`代码中的注释（即使部分是阿拉伯语）都明确指出这是一个“安全扫描器”，用于验证CVE-2025-55182的可利用性，并使用“安全命令”进行验证。其目的在于帮助安全研究人员和组织进行漏洞排查，而非进行恶意攻击。
2.  **代码透明度：** POC的代码结构清晰，没有发现明显的混淆。所依赖的Python库（`httpx`, `rich-click`, `fake-useragent`）均为业界标准且广泛使用的库，没有引入可疑的第三方依赖。
3.  **无恶意负载迹象：** 在可见的`scanner.py`代码片段中，没有检测到任何执行恶意操作（如下载恶意文件、建立反向shell、修改系统配置等）的代码逻辑。其演示RCE的方式是执行像`id`或`ping`这样无害的系统命令，以确认远程代码执行的能力。
4.  **SSL警告处理：** `scanner.py`中`urllib3.disable_warnings`和`self.verify_ssl = False`的设置是为了在实验室或特定测试环境中绕过SSL证书验证，这在安全测试工具中是常见做法，并附有“重要：请勿在实验室外使用此功能！”的警告，表明其是为了测试便利性而非恶意行为。
综上所述，尽管任何从非官方渠道获取的代码都应谨慎对待，但此POC从其代码逻辑和声明来看，表现出较低的投毒风险，是一个用于合法防御性安全研究的工具。

**项目地址:** N/A - POC文件以本地文件形式提供

**漏洞详情:** https://cloud.tencent.com/developer/article/2609893
