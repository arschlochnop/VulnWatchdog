## CVE-2025-55182 - React Server Components, Next.js, react-server-dom-webpack 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React Server Components, Next.js, react-server-dom-webpack

**危害等级:** 高危

**CVSS评分:** 未明确提供，但被描述为'高危'/'核弹级'安全漏洞

**影响版本:** React 19.2.0, React DOM 19.2.0, Next.js 15.4.0, react-server-dom-webpack 19.2.0

**利用条件:** 无需认证，可通过构造恶意multipart表单进行远程利用，攻击门槛低

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-55182，又名React2Shell，是一个影响React Server Components (RSC) 的高危远程代码执行（RCE）漏洞。RSC是React的一项核心功能，旨在提升性能和用户体验，它允许开发者在服务器端渲染组件，并通过“Flight”协议以JSON-like流式格式将结果发送到客户端。此漏洞的核心问题在于Next.js中使用React Flight反序列化机制时，未能充分校验对象属性访问路径，特别是对`__proto__`和`constructor`等原型链属性的访问，从而导致原型链污染。攻击者可以通过精心构造恶意的multipart表单请求，利用`$B`引用结合可控的`_response._prefix`和被劫持为`Function`类型的`_formData.get`，在服务端动态生成包含任意系统命令的函数。这些恶意函数随后会被赋值给对象的`.then`属性，当特定条件触发时，导致任意系统命令在服务器上执行，实现远程代码执行。该漏洞不仅影响核心的React Server Components，也广泛波及到基于RSC构建的流行框架，如Next.js、Shopify Hydrogen和Gatsby 5等，使得其影响范围极为广泛。

本次分析的POC代码是一个完整且高质量的利用工具。它包含一个基于Docker的易受攻击Next.js应用程序环境（使用React 19.2.0, Next 15.4.0, react-server-dom-webpack 19.2.0），以及一个用Python编写的“安全扫描器” (`scanner.py`)。该POC的有效性极高，其`README.md`中明确展示了预期的成功利用输出，包括“VULNERABLE! RCE confirmed.”的确认信息、实际执行的命令输出（例如`uid=1001(nextjs)...`）以及网络连通性测试（`ping`）的结果。整个部署和利用过程清晰明了，通过`docker compose up --build`快速搭建靶场，并通过`poetry run python scanner.py`即可执行漏洞检测和利用，证明了该漏洞的真实性和RCE能力。POC的文档也相当完善，提供了详细的快速启动指南和预期结果，极大地降低了复现和验证的门槛。

**利用步骤：**
1. **部署易受攻击的环境：** 首先，导航到POC代码中的`Stand`目录。在该目录下，执行`docker compose up --build`命令。这会构建并启动一个包含易受攻击的Next.js应用程序的Docker容器。应用程序将在`http://localhost:3011`上运行。
2. **准备POC扫描器：** 接下来，进入`PoC/src`目录。运行`poetry install`命令，安装Python扫描器所需的所有依赖项。确保`poetry`环境已正确配置。
3. **执行POC扫描：** 完成环境准备后，在`PoC/src`目录中，执行命令`poetry run python scanner.py http://localhost:3011`。此命令将启动扫描器，并向目标易受攻击的Next.js应用程序发送精心构造的HTTP请求。
4. **触发漏洞与命令执行：** 扫描器发送的请求会利用React Flight的反序列化漏洞，在服务器端触发原型链污染，进而动态生成并执行恶意函数。这些函数包含预设的系统命令（例如`id`或`ping`）。
5. **验证RCE结果：** 扫描器将捕获服务器返回的命令执行结果（例如`uid=1001(nextjs)`的输出），并在控制台显示“VULNERABLE! RCE confirmed.”信息，同时将详细结果保存到`result.txt`文件中。这证实了远程代码执行的成功。

**投毒风险分析：**
对该POC代码的投毒风险评估结果为“低风险”（约5%）。这一判断基于对POC代码结构、依赖项和预期行为的详细分析。
1. **POC环境安全性：** 易受攻击的应用程序环境由`Stand`目录下的`Dockerfile`和`docker-compose.yml`文件清晰定义。`Dockerfile`基于官方的`node:20-alpine`镜像构建，并执行标准的`npm install`、`npm run build`等命令来设置Next.js应用程序。`docker-compose.yml`也仅用于标准地编排Docker容器，通过端口映射暴露服务。在这些配置中，未发现任何可疑的外部镜像引用、非标准或定制化的Docker指令、或者恶意脚本植入。所有配置步骤都严格遵循了构建和运行Next.js应用程序的常规、透明的最佳实践。
2. **POC扫描器行为分析：** 尽管`PoC/src/scanner.py`的完整源代码未在提供的数据中，但其在`README.md`中的描述为“Safe PoC Scanner”。其执行的测试命令（如`id`和`ping`）是验证RCE漏洞的行业标准和无害方法。已审查的POC信息中，没有迹象表明该Python脚本包含以下潜在的投毒特征：代码混淆或加密、恶意外部请求（例如向未知或可疑服务器发起数据回传、下载恶意负载）、非标准库依赖（即使用已知存在漏洞或恶意行为的特定库版本）、持久化机制（例如在目标系统上建立后门或修改关键系统文件），或者不当的资源利用（例如进行挖矿或DDoS攻击）。
3. **整体评估：** 综合上述分析，该POC被设计为合法地演示和验证CVE-2025-55182漏洞，而非作为恶意载体。它提供了明确的漏洞利用机制和可验证的输出结果，且在提供的代码结构和描述中，没有表现出任何恶意或可疑的行为。因此，其作为安全测试工具本身的投毒风险非常低。然而，值得强调的是，任何能够成功执行远程代码的POC工具，都可能被恶意使用者加以修改，以传递真正的恶意载荷并对目标系统造成实际损害。但这属于漏洞本身的风险，而非此POC代码固有携带的投毒风险。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
