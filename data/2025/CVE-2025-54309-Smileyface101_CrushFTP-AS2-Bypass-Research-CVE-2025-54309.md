## CVE-2025-54309 - CrushFTP 认证绕过

**漏洞编号:** CVE-2025-54309

**漏洞类型:** 认证绕过

**影响应用:** CrushFTP

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** 10.x (tested on 10.5.x branch), 11.x (tested on 11.1.x branch)

**利用条件:** 无需认证，网络可达

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

该漏洞是CrushFTP中的一个关键身份验证绕过漏洞，允许通过AS2标头操作完全的管理员访问权限。此漏洞无需身份验证，可以通过单个HTTP请求利用。根据提供的README.md文件，CrushFTP的Web界面不正确地信任AS2协议标头，而没有进行适当的验证。服务器假定AS2请求已经过预先身份验证，并绕过正常的身份验证过程。通过设置特定的HTTP Header（X-DMZ-Proxy: disabled, X-AS2-Version: 1.0, User-Agent: AS2Server/1.0）可以绕过身份验证，直接访问管理页面。PoC利用的有效性很高，可以通过简单的curl命令触发，直接获取管理员权限。该漏洞已在CrushFTP 10.x（在10.5.x分支上测试）和CrushFTP 11.x（在11.1.x分支上测试）中得到确认。该漏洞在CrushFTP 10.7.0+和CrushFTP 11.2.0+版本中已修复。

利用步骤：
1. 使用curl或其他HTTP客户端。
2. 发送包含特定HTTP标头的请求到CrushFTP服务器的管理页面（例如：/WebInterface/admin/index.html）。
3. 成功绕过身份验证，获得管理员访问权限。

投毒风险分析：该POC代码主要通过HTTP Header进行身份验证绕过，本身的代码较为简洁，没有发现明显的恶意行为，例如执行系统命令或包含外部恶意链接。 但是，攻击者有可能修改POC代码，添加恶意功能。例如，在成功绕过身份验证后，植入后门或收集敏感信息。虽然当前的POC只利用了标准库，代码可读性高，但存在被修改后用于恶意目的的风险。该项目依赖CrushFTP服务器的存在，以及特定版本的存在。如果攻击者能够结合其他漏洞或利用，提升权限或执行恶意代码，那么投毒风险将会增加。因此，综合评估投毒风险为10%。该漏洞的CVSS评分为9.8，属于危急漏洞，需要尽快修复。

**项目地址:** https://github.com/SmileyFace101/CrushFTP-AS2-Authentication-Bypass-Research

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-54309
