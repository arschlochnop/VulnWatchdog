# CVE-2025-21420

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21420-Network-Sec_CVE-2025-21420-PoC.md](../2025/CVE-2025-21420-Network-Sec_CVE-2025-21420-PoC.md)

# CVE-2025-21420

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21420-Network-Sec_CVE-2025-21420-PoC.md](../2025/CVE-2025-21420-Network-Sec_CVE-2025-21420-PoC.md)

# CVE-2025-21420

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21420-Network-Sec_CVE-2025-21420-PoC.md](../2025/CVE-2025-21420-Network-Sec_CVE-2025-21420-PoC.md)

# CVE-2025-21420

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21420-Network-Sec_CVE-2025-21420-PoC.md](../2025/CVE-2025-21420-Network-Sec_CVE-2025-21420-PoC.md)

# CVE-2025-21420

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21420-Network-Sec_CVE-2025-21420-PoC.md](../2025/CVE-2025-21420-Network-Sec_CVE-2025-21420-PoC.md)

# CVE-2025-21420

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21420-Network-Sec_CVE-2025-21420-PoC.md](../2025/CVE-2025-21420-Network-Sec_CVE-2025-21420-PoC.md)

# CVE-2025-21420

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21420-Network-Sec_CVE-2025-21420-PoC.md](../2025/CVE-2025-21420-Network-Sec_CVE-2025-21420-PoC.md)

# CVE-2025-21420

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21420-Network-Sec_CVE-2025-21420-PoC.md](../2025/CVE-2025-21420-Network-Sec_CVE-2025-21420-PoC.md)

# CVE-2025-21420

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21420-Network-Sec_CVE-2025-21420-PoC.md](../2025/CVE-2025-21420-Network-Sec_CVE-2025-21420-PoC.md)

# CVE-2025-21420

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21420-Network-Sec_CVE-2025-21420-PoC.md](../2025/CVE-2025-21420-Network-Sec_CVE-2025-21420-PoC.md)

# CVE-2025-21420

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21420-Network-Sec_CVE-2025-21420-PoC.md](../2025/CVE-2025-21420-Network-Sec_CVE-2025-21420-PoC.md)

# CVE-2025-21420

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21420-Network-Sec_CVE-2025-21420-PoC.md](../2025/CVE-2025-21420-Network-Sec_CVE-2025-21420-PoC.md)

## CVE-2025-21420 - Windows Disk Cleanup Tool Elevation of Privilege

**漏洞编号:** CVE-2025-21420

**漏洞类型:** 权限提升

**影响应用:** Windows Disk Cleanup Tool (cleanmgr.exe)

**危害等级:** 高危，可获取SYSTEM权限

**影响版本:** 受影响的Windows版本详见CVE描述

**利用条件:** 需要本地访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-21420 是 Windows 磁盘清理工具中的一个权限提升漏洞。根据搜索结果，该漏洞允许攻击者获取系统（SYSTEM）权限。根据CVE描述，该漏洞是由于不正确的链接解析导致的，攻击者可能通过操纵磁盘清理工具使用的链接来提升权限。

**有效性：** 根据搜索结果中的链接 ([https://github.com/Network-Sec/CVE-2025-21420-PoC](https://github.com/Network-Sec/CVE-2025-21420-PoC)) 指向GitHub上的POC，表明该漏洞存在可利用的POC代码。 综合漏洞库信息和搜索引擎内容，可以判断该漏洞的POC是有效的。

**投毒风险：** 提供的漏洞利用代码仅包含一个LICENSE文件，该文件是Creative Commons Legal Code，与漏洞利用本身无关。因此，无法从该代码片段中判断是否存在投毒代码。假设GitHub上的POC是独立的，并且仅包含利用漏洞的代码，则投毒风险较低。但是，在实际利用任何POC代码之前，都应该对其进行仔细的审查，以确保其中不包含恶意代码，**投毒风险预估为0%**。

**利用方式：** 该漏洞的利用方式是利用磁盘清理工具对不正确链接的解析，通常涉及以下步骤：

1.  攻击者需要具有本地访问权限。
2.  攻击者创建或修改磁盘清理工具使用的不安全链接或配置文件。
3.  当磁盘清理工具运行时，它会尝试解析这些链接，由于漏洞的存在，攻击者可以利用这一点来执行任意代码或获得更高的权限。
4.  通过这种方式，攻击者可以将权限从普通用户提升到SYSTEM。

**项目地址:** [Network-Sec/CVE-2025-21420-PoC](https://github.com/Network-Sec/CVE-2025-21420-PoC)

**漏洞详情:** [CVE-2025-21420](https://nvd.nist.gov/vuln/detail/CVE-2025-21420)

---

## POC #2

**来源**: [CVE-2025-21420-moiz-2x_CVE-2025-21420_POC.md](../2025/CVE-2025-21420-moiz-2x_CVE-2025-21420_POC.md)

## CVE-2025-21420 Windows Disk Cleanup Tool Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21420

**漏洞类型:** 权限提升

**影响应用:** Windows Disk Cleanup Tool (cleanmgr.exe)

**危害等级:** 高危，允许低权限用户获取SYSTEM权限

**影响版本:** 受影响的Windows版本详见CVE信息，在指定版本范围内

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-21420 存在于 Windows 磁盘清理工具中，是一个权限提升漏洞。根据漏洞库信息，多个 Windows 版本均受影响。搜索引擎结果显示，该漏洞允许攻击者获得 SYSTEM 权限。PoC 代码利用了 `SilentCleanup` 任务中存在的任意文件夹删除/移动/重命名漏洞，通过创建特定目录结构和结合其他 PoC（FolderOrFileDeleteToSystem, FolderContentsDeleteToFolderDelete）将清理操作重定向到 `C:/Config.msi` 目录，最终导致权限提升。 Diffing cleanmgr.exe表明新版本引入了 ProcessRedirectionTrustPolicy 缓解措施，暗示了漏洞与目录重定向有关。

**有效性：**
PoC代码似乎是有效的，因为它指向了利用 `SilentCleanup` 任务进行权限提升的已知方法。

**投毒风险：**
PoC 代码主要包含创建目录、写入文件和运行计划任务的命令。虽然这些操作本身看起来无害，但是结合文档中的描述，利用这个PoC需要下载另外的两个存储库，即`FolderOrFileDeleteToSystem`和`FolderContentsDeleteToFolderDelete`。因此，投毒风险主要来自未提供的两个利用代码，此处PoC只是一种触发方式，投毒可能性较低，风险估计为 5% 。

**利用方式：**
1.  创建必要的目录结构：`C:\$Windows.~WS`, `C:\ESD\Windows`, `C:\ESD\Download`，并在每个目录中创建一个 `text.txt` 文件。
2.  利用`FolderOrFileDeleteToSystem`设置`Config.msi`目录
3.  利用`FolderContentsDeleteToFolderDelete`重定向清理目标
4.  运行 `SilentCleanup` 计划任务，触发磁盘清理工具。
5.  利用权限提升执行任意代码（例如，通过 `osk.exe`）。

**项目地址:** [moiz-2x/CVE-2025-21420_POC](https://github.com/moiz-2x/CVE-2025-21420_POC)

**漏洞详情:** [CVE-2025-21420](https://nvd.nist.gov/vuln/detail/CVE-2025-21420)

---

## POC #3

**来源**: [CVE-2025-21420-toxy4ny_edge-maradeur.md](../2025/CVE-2025-21420-toxy4ny_edge-maradeur.md)

## CVE-2025-21420-Windows Disk Cleanup Tool-权限提升

**漏洞编号:** CVE-2025-21420

**漏洞类型:** 权限提升

**影响应用:** Windows Disk Cleanup Tool

**危害等级:** 高危，可导致系统权限被获取

**影响版本:** 受影响的Windows版本见CVE描述

**利用条件:** 需要物理访问（BadUSB）或者已控制目标机器执行powershell

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和提供的POC代码，此漏洞利用的有效性较高。漏洞CVE-2025-21420允许攻击者通过Windows Disk Cleanup Tool获得权限提升。利用方式如下：

1.  **漏洞描述：** CVE-2025-21420 是 Windows Disk Cleanup Tool 的一个权限提升漏洞，攻击者可以利用此漏洞获取 SYSTEM 权限。

2.  **利用方式：** 提供的POC代码（`edge-maradeur.txt`）是一个BadUSB脚本，它模拟键盘输入，执行以下步骤：
    *   创建一个计划任务 `ElevatePrivileges`，该任务使用 SYSTEM 权限运行 PowerShell。
    *   该PowerShell脚本的功能是:
        *   获取当前用户名。
        *   定位Edge浏览器的Login Data数据库文件。
        *   在C:\temp创建临时目录
        *   复制Login Data数据库到临时目录。
        *   使用提供的 FTP 凭据将Login Data数据库上传到远程FTP服务器。
        *   删除临时文件。
        *   退出 PowerShell。
    *   该脚本结合了CVE-2025-21420和CVE-2025-21401（根据README.md）。

3.  **有效性：** 该POC的有效性取决于以下因素：
    *   目标系统是否受 CVE-2025-21420 影响。
    *   目标系统是否安装了Edge浏览器，且存在Login Data数据库。
    *   攻击者是否拥有可用的FTP服务器和有效的凭据。
    *   目标系统是否允许执行powershell

4.  **投毒风险分析：**  POC 中存在一定的投毒风险，虽然主要功能是利用漏洞提升权限并导出Edge浏览器的数据，但以下几点需要关注：
    *   **FTP 上传：** 恶意攻击者可能通过控制 FTP 服务器来收集受害者的数据，例如浏览器保存的密码等敏感信息，存在信息泄露的风险。
    *   **计划任务：** 计划任务如果被滥用，可能被用于持久化后门。
    *   **C:\temp目录创建:** 如果创建临时目录失败，或者删除临时文件失败，也可能会导致拒绝服务或者留下恶意文件。

    综合考虑，我认为投毒风险为 10%。主要的风险在于，攻击者可能会利用此脚本在目标系统上植入后门或者窃取信息，但脚本本身的功能和目标相对明确，隐藏恶意代码的空间有限。 该脚本主要是配合BadUSB实现的攻击，如果用户对BadUSB设备不了解,容易被攻击.


**项目地址:** [toxy4ny/edge-maradeur](https://github.com/toxy4ny/edge-maradeur)

**漏洞详情:** [CVE-2025-21420](https://nvd.nist.gov/vuln/detail/CVE-2025-21420)

---



---

## POC #2

**来源**: [CVE-2025-21420-moiz-2x_CVE-2025-21420_POC.md](../2025/CVE-2025-21420-moiz-2x_CVE-2025-21420_POC.md)

## CVE-2025-21420 Windows Disk Cleanup Tool Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21420

**漏洞类型:** 权限提升

**影响应用:** Windows Disk Cleanup Tool (cleanmgr.exe)

**危害等级:** 高危，允许低权限用户获取SYSTEM权限

**影响版本:** 受影响的Windows版本详见CVE信息，在指定版本范围内

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-21420 存在于 Windows 磁盘清理工具中，是一个权限提升漏洞。根据漏洞库信息，多个 Windows 版本均受影响。搜索引擎结果显示，该漏洞允许攻击者获得 SYSTEM 权限。PoC 代码利用了 `SilentCleanup` 任务中存在的任意文件夹删除/移动/重命名漏洞，通过创建特定目录结构和结合其他 PoC（FolderOrFileDeleteToSystem, FolderContentsDeleteToFolderDelete）将清理操作重定向到 `C:/Config.msi` 目录，最终导致权限提升。 Diffing cleanmgr.exe表明新版本引入了 ProcessRedirectionTrustPolicy 缓解措施，暗示了漏洞与目录重定向有关。

**有效性：**
PoC代码似乎是有效的，因为它指向了利用 `SilentCleanup` 任务进行权限提升的已知方法。

**投毒风险：**
PoC 代码主要包含创建目录、写入文件和运行计划任务的命令。虽然这些操作本身看起来无害，但是结合文档中的描述，利用这个PoC需要下载另外的两个存储库，即`FolderOrFileDeleteToSystem`和`FolderContentsDeleteToFolderDelete`。因此，投毒风险主要来自未提供的两个利用代码，此处PoC只是一种触发方式，投毒可能性较低，风险估计为 5% 。

**利用方式：**
1.  创建必要的目录结构：`C:\$Windows.~WS`, `C:\ESD\Windows`, `C:\ESD\Download`，并在每个目录中创建一个 `text.txt` 文件。
2.  利用`FolderOrFileDeleteToSystem`设置`Config.msi`目录
3.  利用`FolderContentsDeleteToFolderDelete`重定向清理目标
4.  运行 `SilentCleanup` 计划任务，触发磁盘清理工具。
5.  利用权限提升执行任意代码（例如，通过 `osk.exe`）。

**项目地址:** [moiz-2x/CVE-2025-21420_POC](https://github.com/moiz-2x/CVE-2025-21420_POC)

**漏洞详情:** [CVE-2025-21420](https://nvd.nist.gov/vuln/detail/CVE-2025-21420)

---

## POC #3

**来源**: [CVE-2025-21420-toxy4ny_edge-maradeur.md](../2025/CVE-2025-21420-toxy4ny_edge-maradeur.md)

## CVE-2025-21420-Windows Disk Cleanup Tool-权限提升

**漏洞编号:** CVE-2025-21420

**漏洞类型:** 权限提升

**影响应用:** Windows Disk Cleanup Tool

**危害等级:** 高危，可导致系统权限被获取

**影响版本:** 受影响的Windows版本见CVE描述

**利用条件:** 需要物理访问（BadUSB）或者已控制目标机器执行powershell

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和提供的POC代码，此漏洞利用的有效性较高。漏洞CVE-2025-21420允许攻击者通过Windows Disk Cleanup Tool获得权限提升。利用方式如下：

1.  **漏洞描述：** CVE-2025-21420 是 Windows Disk Cleanup Tool 的一个权限提升漏洞，攻击者可以利用此漏洞获取 SYSTEM 权限。

2.  **利用方式：** 提供的POC代码（`edge-maradeur.txt`）是一个BadUSB脚本，它模拟键盘输入，执行以下步骤：
    *   创建一个计划任务 `ElevatePrivileges`，该任务使用 SYSTEM 权限运行 PowerShell。
    *   该PowerShell脚本的功能是:
        *   获取当前用户名。
        *   定位Edge浏览器的Login Data数据库文件。
        *   在C:\temp创建临时目录
        *   复制Login Data数据库到临时目录。
        *   使用提供的 FTP 凭据将Login Data数据库上传到远程FTP服务器。
        *   删除临时文件。
        *   退出 PowerShell。
    *   该脚本结合了CVE-2025-21420和CVE-2025-21401（根据README.md）。

3.  **有效性：** 该POC的有效性取决于以下因素：
    *   目标系统是否受 CVE-2025-21420 影响。
    *   目标系统是否安装了Edge浏览器，且存在Login Data数据库。
    *   攻击者是否拥有可用的FTP服务器和有效的凭据。
    *   目标系统是否允许执行powershell

4.  **投毒风险分析：**  POC 中存在一定的投毒风险，虽然主要功能是利用漏洞提升权限并导出Edge浏览器的数据，但以下几点需要关注：
    *   **FTP 上传：** 恶意攻击者可能通过控制 FTP 服务器来收集受害者的数据，例如浏览器保存的密码等敏感信息，存在信息泄露的风险。
    *   **计划任务：** 计划任务如果被滥用，可能被用于持久化后门。
    *   **C:\temp目录创建:** 如果创建临时目录失败，或者删除临时文件失败，也可能会导致拒绝服务或者留下恶意文件。

    综合考虑，我认为投毒风险为 10%。主要的风险在于，攻击者可能会利用此脚本在目标系统上植入后门或者窃取信息，但脚本本身的功能和目标相对明确，隐藏恶意代码的空间有限。 该脚本主要是配合BadUSB实现的攻击，如果用户对BadUSB设备不了解,容易被攻击.


**项目地址:** [toxy4ny/edge-maradeur](https://github.com/toxy4ny/edge-maradeur)

**漏洞详情:** [CVE-2025-21420](https://nvd.nist.gov/vuln/detail/CVE-2025-21420)

---



---

## POC #2

**来源**: [CVE-2025-21420-moiz-2x_CVE-2025-21420_POC.md](../2025/CVE-2025-21420-moiz-2x_CVE-2025-21420_POC.md)

## CVE-2025-21420 Windows Disk Cleanup Tool Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21420

**漏洞类型:** 权限提升

**影响应用:** Windows Disk Cleanup Tool (cleanmgr.exe)

**危害等级:** 高危，允许低权限用户获取SYSTEM权限

**影响版本:** 受影响的Windows版本详见CVE信息，在指定版本范围内

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-21420 存在于 Windows 磁盘清理工具中，是一个权限提升漏洞。根据漏洞库信息，多个 Windows 版本均受影响。搜索引擎结果显示，该漏洞允许攻击者获得 SYSTEM 权限。PoC 代码利用了 `SilentCleanup` 任务中存在的任意文件夹删除/移动/重命名漏洞，通过创建特定目录结构和结合其他 PoC（FolderOrFileDeleteToSystem, FolderContentsDeleteToFolderDelete）将清理操作重定向到 `C:/Config.msi` 目录，最终导致权限提升。 Diffing cleanmgr.exe表明新版本引入了 ProcessRedirectionTrustPolicy 缓解措施，暗示了漏洞与目录重定向有关。

**有效性：**
PoC代码似乎是有效的，因为它指向了利用 `SilentCleanup` 任务进行权限提升的已知方法。

**投毒风险：**
PoC 代码主要包含创建目录、写入文件和运行计划任务的命令。虽然这些操作本身看起来无害，但是结合文档中的描述，利用这个PoC需要下载另外的两个存储库，即`FolderOrFileDeleteToSystem`和`FolderContentsDeleteToFolderDelete`。因此，投毒风险主要来自未提供的两个利用代码，此处PoC只是一种触发方式，投毒可能性较低，风险估计为 5% 。

**利用方式：**
1.  创建必要的目录结构：`C:\$Windows.~WS`, `C:\ESD\Windows`, `C:\ESD\Download`，并在每个目录中创建一个 `text.txt` 文件。
2.  利用`FolderOrFileDeleteToSystem`设置`Config.msi`目录
3.  利用`FolderContentsDeleteToFolderDelete`重定向清理目标
4.  运行 `SilentCleanup` 计划任务，触发磁盘清理工具。
5.  利用权限提升执行任意代码（例如，通过 `osk.exe`）。

**项目地址:** [moiz-2x/CVE-2025-21420_POC](https://github.com/moiz-2x/CVE-2025-21420_POC)

**漏洞详情:** [CVE-2025-21420](https://nvd.nist.gov/vuln/detail/CVE-2025-21420)

---

## POC #3

**来源**: [CVE-2025-21420-toxy4ny_edge-maradeur.md](../2025/CVE-2025-21420-toxy4ny_edge-maradeur.md)

## CVE-2025-21420-Windows Disk Cleanup Tool-权限提升

**漏洞编号:** CVE-2025-21420

**漏洞类型:** 权限提升

**影响应用:** Windows Disk Cleanup Tool

**危害等级:** 高危，可导致系统权限被获取

**影响版本:** 受影响的Windows版本见CVE描述

**利用条件:** 需要物理访问（BadUSB）或者已控制目标机器执行powershell

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和提供的POC代码，此漏洞利用的有效性较高。漏洞CVE-2025-21420允许攻击者通过Windows Disk Cleanup Tool获得权限提升。利用方式如下：

1.  **漏洞描述：** CVE-2025-21420 是 Windows Disk Cleanup Tool 的一个权限提升漏洞，攻击者可以利用此漏洞获取 SYSTEM 权限。

2.  **利用方式：** 提供的POC代码（`edge-maradeur.txt`）是一个BadUSB脚本，它模拟键盘输入，执行以下步骤：
    *   创建一个计划任务 `ElevatePrivileges`，该任务使用 SYSTEM 权限运行 PowerShell。
    *   该PowerShell脚本的功能是:
        *   获取当前用户名。
        *   定位Edge浏览器的Login Data数据库文件。
        *   在C:\temp创建临时目录
        *   复制Login Data数据库到临时目录。
        *   使用提供的 FTP 凭据将Login Data数据库上传到远程FTP服务器。
        *   删除临时文件。
        *   退出 PowerShell。
    *   该脚本结合了CVE-2025-21420和CVE-2025-21401（根据README.md）。

3.  **有效性：** 该POC的有效性取决于以下因素：
    *   目标系统是否受 CVE-2025-21420 影响。
    *   目标系统是否安装了Edge浏览器，且存在Login Data数据库。
    *   攻击者是否拥有可用的FTP服务器和有效的凭据。
    *   目标系统是否允许执行powershell

4.  **投毒风险分析：**  POC 中存在一定的投毒风险，虽然主要功能是利用漏洞提升权限并导出Edge浏览器的数据，但以下几点需要关注：
    *   **FTP 上传：** 恶意攻击者可能通过控制 FTP 服务器来收集受害者的数据，例如浏览器保存的密码等敏感信息，存在信息泄露的风险。
    *   **计划任务：** 计划任务如果被滥用，可能被用于持久化后门。
    *   **C:\temp目录创建:** 如果创建临时目录失败，或者删除临时文件失败，也可能会导致拒绝服务或者留下恶意文件。

    综合考虑，我认为投毒风险为 10%。主要的风险在于，攻击者可能会利用此脚本在目标系统上植入后门或者窃取信息，但脚本本身的功能和目标相对明确，隐藏恶意代码的空间有限。 该脚本主要是配合BadUSB实现的攻击，如果用户对BadUSB设备不了解,容易被攻击.


**项目地址:** [toxy4ny/edge-maradeur](https://github.com/toxy4ny/edge-maradeur)

**漏洞详情:** [CVE-2025-21420](https://nvd.nist.gov/vuln/detail/CVE-2025-21420)

---



---

## POC #2

**来源**: [CVE-2025-21420-moiz-2x_CVE-2025-21420_POC.md](../2025/CVE-2025-21420-moiz-2x_CVE-2025-21420_POC.md)

## CVE-2025-21420 Windows Disk Cleanup Tool Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21420

**漏洞类型:** 权限提升

**影响应用:** Windows Disk Cleanup Tool (cleanmgr.exe)

**危害等级:** 高危，允许低权限用户获取SYSTEM权限

**影响版本:** 受影响的Windows版本详见CVE信息，在指定版本范围内

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-21420 存在于 Windows 磁盘清理工具中，是一个权限提升漏洞。根据漏洞库信息，多个 Windows 版本均受影响。搜索引擎结果显示，该漏洞允许攻击者获得 SYSTEM 权限。PoC 代码利用了 `SilentCleanup` 任务中存在的任意文件夹删除/移动/重命名漏洞，通过创建特定目录结构和结合其他 PoC（FolderOrFileDeleteToSystem, FolderContentsDeleteToFolderDelete）将清理操作重定向到 `C:/Config.msi` 目录，最终导致权限提升。 Diffing cleanmgr.exe表明新版本引入了 ProcessRedirectionTrustPolicy 缓解措施，暗示了漏洞与目录重定向有关。

**有效性：**
PoC代码似乎是有效的，因为它指向了利用 `SilentCleanup` 任务进行权限提升的已知方法。

**投毒风险：**
PoC 代码主要包含创建目录、写入文件和运行计划任务的命令。虽然这些操作本身看起来无害，但是结合文档中的描述，利用这个PoC需要下载另外的两个存储库，即`FolderOrFileDeleteToSystem`和`FolderContentsDeleteToFolderDelete`。因此，投毒风险主要来自未提供的两个利用代码，此处PoC只是一种触发方式，投毒可能性较低，风险估计为 5% 。

**利用方式：**
1.  创建必要的目录结构：`C:\$Windows.~WS`, `C:\ESD\Windows`, `C:\ESD\Download`，并在每个目录中创建一个 `text.txt` 文件。
2.  利用`FolderOrFileDeleteToSystem`设置`Config.msi`目录
3.  利用`FolderContentsDeleteToFolderDelete`重定向清理目标
4.  运行 `SilentCleanup` 计划任务，触发磁盘清理工具。
5.  利用权限提升执行任意代码（例如，通过 `osk.exe`）。

**项目地址:** [moiz-2x/CVE-2025-21420_POC](https://github.com/moiz-2x/CVE-2025-21420_POC)

**漏洞详情:** [CVE-2025-21420](https://nvd.nist.gov/vuln/detail/CVE-2025-21420)

---

## POC #3

**来源**: [CVE-2025-21420-toxy4ny_edge-maradeur.md](../2025/CVE-2025-21420-toxy4ny_edge-maradeur.md)

## CVE-2025-21420-Windows Disk Cleanup Tool-权限提升

**漏洞编号:** CVE-2025-21420

**漏洞类型:** 权限提升

**影响应用:** Windows Disk Cleanup Tool

**危害等级:** 高危，可导致系统权限被获取

**影响版本:** 受影响的Windows版本见CVE描述

**利用条件:** 需要物理访问（BadUSB）或者已控制目标机器执行powershell

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和提供的POC代码，此漏洞利用的有效性较高。漏洞CVE-2025-21420允许攻击者通过Windows Disk Cleanup Tool获得权限提升。利用方式如下：

1.  **漏洞描述：** CVE-2025-21420 是 Windows Disk Cleanup Tool 的一个权限提升漏洞，攻击者可以利用此漏洞获取 SYSTEM 权限。

2.  **利用方式：** 提供的POC代码（`edge-maradeur.txt`）是一个BadUSB脚本，它模拟键盘输入，执行以下步骤：
    *   创建一个计划任务 `ElevatePrivileges`，该任务使用 SYSTEM 权限运行 PowerShell。
    *   该PowerShell脚本的功能是:
        *   获取当前用户名。
        *   定位Edge浏览器的Login Data数据库文件。
        *   在C:\temp创建临时目录
        *   复制Login Data数据库到临时目录。
        *   使用提供的 FTP 凭据将Login Data数据库上传到远程FTP服务器。
        *   删除临时文件。
        *   退出 PowerShell。
    *   该脚本结合了CVE-2025-21420和CVE-2025-21401（根据README.md）。

3.  **有效性：** 该POC的有效性取决于以下因素：
    *   目标系统是否受 CVE-2025-21420 影响。
    *   目标系统是否安装了Edge浏览器，且存在Login Data数据库。
    *   攻击者是否拥有可用的FTP服务器和有效的凭据。
    *   目标系统是否允许执行powershell

4.  **投毒风险分析：**  POC 中存在一定的投毒风险，虽然主要功能是利用漏洞提升权限并导出Edge浏览器的数据，但以下几点需要关注：
    *   **FTP 上传：** 恶意攻击者可能通过控制 FTP 服务器来收集受害者的数据，例如浏览器保存的密码等敏感信息，存在信息泄露的风险。
    *   **计划任务：** 计划任务如果被滥用，可能被用于持久化后门。
    *   **C:\temp目录创建:** 如果创建临时目录失败，或者删除临时文件失败，也可能会导致拒绝服务或者留下恶意文件。

    综合考虑，我认为投毒风险为 10%。主要的风险在于，攻击者可能会利用此脚本在目标系统上植入后门或者窃取信息，但脚本本身的功能和目标相对明确，隐藏恶意代码的空间有限。 该脚本主要是配合BadUSB实现的攻击，如果用户对BadUSB设备不了解,容易被攻击.


**项目地址:** [toxy4ny/edge-maradeur](https://github.com/toxy4ny/edge-maradeur)

**漏洞详情:** [CVE-2025-21420](https://nvd.nist.gov/vuln/detail/CVE-2025-21420)

---



---

## POC #2

**来源**: [CVE-2025-21420-moiz-2x_CVE-2025-21420_POC.md](../2025/CVE-2025-21420-moiz-2x_CVE-2025-21420_POC.md)

## CVE-2025-21420 Windows Disk Cleanup Tool Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21420

**漏洞类型:** 权限提升

**影响应用:** Windows Disk Cleanup Tool (cleanmgr.exe)

**危害等级:** 高危，允许低权限用户获取SYSTEM权限

**影响版本:** 受影响的Windows版本详见CVE信息，在指定版本范围内

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-21420 存在于 Windows 磁盘清理工具中，是一个权限提升漏洞。根据漏洞库信息，多个 Windows 版本均受影响。搜索引擎结果显示，该漏洞允许攻击者获得 SYSTEM 权限。PoC 代码利用了 `SilentCleanup` 任务中存在的任意文件夹删除/移动/重命名漏洞，通过创建特定目录结构和结合其他 PoC（FolderOrFileDeleteToSystem, FolderContentsDeleteToFolderDelete）将清理操作重定向到 `C:/Config.msi` 目录，最终导致权限提升。 Diffing cleanmgr.exe表明新版本引入了 ProcessRedirectionTrustPolicy 缓解措施，暗示了漏洞与目录重定向有关。

**有效性：**
PoC代码似乎是有效的，因为它指向了利用 `SilentCleanup` 任务进行权限提升的已知方法。

**投毒风险：**
PoC 代码主要包含创建目录、写入文件和运行计划任务的命令。虽然这些操作本身看起来无害，但是结合文档中的描述，利用这个PoC需要下载另外的两个存储库，即`FolderOrFileDeleteToSystem`和`FolderContentsDeleteToFolderDelete`。因此，投毒风险主要来自未提供的两个利用代码，此处PoC只是一种触发方式，投毒可能性较低，风险估计为 5% 。

**利用方式：**
1.  创建必要的目录结构：`C:\$Windows.~WS`, `C:\ESD\Windows`, `C:\ESD\Download`，并在每个目录中创建一个 `text.txt` 文件。
2.  利用`FolderOrFileDeleteToSystem`设置`Config.msi`目录
3.  利用`FolderContentsDeleteToFolderDelete`重定向清理目标
4.  运行 `SilentCleanup` 计划任务，触发磁盘清理工具。
5.  利用权限提升执行任意代码（例如，通过 `osk.exe`）。

**项目地址:** [moiz-2x/CVE-2025-21420_POC](https://github.com/moiz-2x/CVE-2025-21420_POC)

**漏洞详情:** [CVE-2025-21420](https://nvd.nist.gov/vuln/detail/CVE-2025-21420)

---

## POC #3

**来源**: [CVE-2025-21420-toxy4ny_edge-maradeur.md](../2025/CVE-2025-21420-toxy4ny_edge-maradeur.md)

## CVE-2025-21420-Windows Disk Cleanup Tool-权限提升

**漏洞编号:** CVE-2025-21420

**漏洞类型:** 权限提升

**影响应用:** Windows Disk Cleanup Tool

**危害等级:** 高危，可导致系统权限被获取

**影响版本:** 受影响的Windows版本见CVE描述

**利用条件:** 需要物理访问（BadUSB）或者已控制目标机器执行powershell

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和提供的POC代码，此漏洞利用的有效性较高。漏洞CVE-2025-21420允许攻击者通过Windows Disk Cleanup Tool获得权限提升。利用方式如下：

1.  **漏洞描述：** CVE-2025-21420 是 Windows Disk Cleanup Tool 的一个权限提升漏洞，攻击者可以利用此漏洞获取 SYSTEM 权限。

2.  **利用方式：** 提供的POC代码（`edge-maradeur.txt`）是一个BadUSB脚本，它模拟键盘输入，执行以下步骤：
    *   创建一个计划任务 `ElevatePrivileges`，该任务使用 SYSTEM 权限运行 PowerShell。
    *   该PowerShell脚本的功能是:
        *   获取当前用户名。
        *   定位Edge浏览器的Login Data数据库文件。
        *   在C:\temp创建临时目录
        *   复制Login Data数据库到临时目录。
        *   使用提供的 FTP 凭据将Login Data数据库上传到远程FTP服务器。
        *   删除临时文件。
        *   退出 PowerShell。
    *   该脚本结合了CVE-2025-21420和CVE-2025-21401（根据README.md）。

3.  **有效性：** 该POC的有效性取决于以下因素：
    *   目标系统是否受 CVE-2025-21420 影响。
    *   目标系统是否安装了Edge浏览器，且存在Login Data数据库。
    *   攻击者是否拥有可用的FTP服务器和有效的凭据。
    *   目标系统是否允许执行powershell

4.  **投毒风险分析：**  POC 中存在一定的投毒风险，虽然主要功能是利用漏洞提升权限并导出Edge浏览器的数据，但以下几点需要关注：
    *   **FTP 上传：** 恶意攻击者可能通过控制 FTP 服务器来收集受害者的数据，例如浏览器保存的密码等敏感信息，存在信息泄露的风险。
    *   **计划任务：** 计划任务如果被滥用，可能被用于持久化后门。
    *   **C:\temp目录创建:** 如果创建临时目录失败，或者删除临时文件失败，也可能会导致拒绝服务或者留下恶意文件。

    综合考虑，我认为投毒风险为 10%。主要的风险在于，攻击者可能会利用此脚本在目标系统上植入后门或者窃取信息，但脚本本身的功能和目标相对明确，隐藏恶意代码的空间有限。 该脚本主要是配合BadUSB实现的攻击，如果用户对BadUSB设备不了解,容易被攻击.


**项目地址:** [toxy4ny/edge-maradeur](https://github.com/toxy4ny/edge-maradeur)

**漏洞详情:** [CVE-2025-21420](https://nvd.nist.gov/vuln/detail/CVE-2025-21420)

---



---

## POC #2

**来源**: [CVE-2025-21420-moiz-2x_CVE-2025-21420_POC.md](../2025/CVE-2025-21420-moiz-2x_CVE-2025-21420_POC.md)

## CVE-2025-21420 Windows Disk Cleanup Tool Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21420

**漏洞类型:** 权限提升

**影响应用:** Windows Disk Cleanup Tool (cleanmgr.exe)

**危害等级:** 高危，允许低权限用户获取SYSTEM权限

**影响版本:** 受影响的Windows版本详见CVE信息，在指定版本范围内

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-21420 存在于 Windows 磁盘清理工具中，是一个权限提升漏洞。根据漏洞库信息，多个 Windows 版本均受影响。搜索引擎结果显示，该漏洞允许攻击者获得 SYSTEM 权限。PoC 代码利用了 `SilentCleanup` 任务中存在的任意文件夹删除/移动/重命名漏洞，通过创建特定目录结构和结合其他 PoC（FolderOrFileDeleteToSystem, FolderContentsDeleteToFolderDelete）将清理操作重定向到 `C:/Config.msi` 目录，最终导致权限提升。 Diffing cleanmgr.exe表明新版本引入了 ProcessRedirectionTrustPolicy 缓解措施，暗示了漏洞与目录重定向有关。

**有效性：**
PoC代码似乎是有效的，因为它指向了利用 `SilentCleanup` 任务进行权限提升的已知方法。

**投毒风险：**
PoC 代码主要包含创建目录、写入文件和运行计划任务的命令。虽然这些操作本身看起来无害，但是结合文档中的描述，利用这个PoC需要下载另外的两个存储库，即`FolderOrFileDeleteToSystem`和`FolderContentsDeleteToFolderDelete`。因此，投毒风险主要来自未提供的两个利用代码，此处PoC只是一种触发方式，投毒可能性较低，风险估计为 5% 。

**利用方式：**
1.  创建必要的目录结构：`C:\$Windows.~WS`, `C:\ESD\Windows`, `C:\ESD\Download`，并在每个目录中创建一个 `text.txt` 文件。
2.  利用`FolderOrFileDeleteToSystem`设置`Config.msi`目录
3.  利用`FolderContentsDeleteToFolderDelete`重定向清理目标
4.  运行 `SilentCleanup` 计划任务，触发磁盘清理工具。
5.  利用权限提升执行任意代码（例如，通过 `osk.exe`）。

**项目地址:** [moiz-2x/CVE-2025-21420_POC](https://github.com/moiz-2x/CVE-2025-21420_POC)

**漏洞详情:** [CVE-2025-21420](https://nvd.nist.gov/vuln/detail/CVE-2025-21420)

---

## POC #3

**来源**: [CVE-2025-21420-toxy4ny_edge-maradeur.md](../2025/CVE-2025-21420-toxy4ny_edge-maradeur.md)

## CVE-2025-21420-Windows Disk Cleanup Tool-权限提升

**漏洞编号:** CVE-2025-21420

**漏洞类型:** 权限提升

**影响应用:** Windows Disk Cleanup Tool

**危害等级:** 高危，可导致系统权限被获取

**影响版本:** 受影响的Windows版本见CVE描述

**利用条件:** 需要物理访问（BadUSB）或者已控制目标机器执行powershell

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和提供的POC代码，此漏洞利用的有效性较高。漏洞CVE-2025-21420允许攻击者通过Windows Disk Cleanup Tool获得权限提升。利用方式如下：

1.  **漏洞描述：** CVE-2025-21420 是 Windows Disk Cleanup Tool 的一个权限提升漏洞，攻击者可以利用此漏洞获取 SYSTEM 权限。

2.  **利用方式：** 提供的POC代码（`edge-maradeur.txt`）是一个BadUSB脚本，它模拟键盘输入，执行以下步骤：
    *   创建一个计划任务 `ElevatePrivileges`，该任务使用 SYSTEM 权限运行 PowerShell。
    *   该PowerShell脚本的功能是:
        *   获取当前用户名。
        *   定位Edge浏览器的Login Data数据库文件。
        *   在C:\temp创建临时目录
        *   复制Login Data数据库到临时目录。
        *   使用提供的 FTP 凭据将Login Data数据库上传到远程FTP服务器。
        *   删除临时文件。
        *   退出 PowerShell。
    *   该脚本结合了CVE-2025-21420和CVE-2025-21401（根据README.md）。

3.  **有效性：** 该POC的有效性取决于以下因素：
    *   目标系统是否受 CVE-2025-21420 影响。
    *   目标系统是否安装了Edge浏览器，且存在Login Data数据库。
    *   攻击者是否拥有可用的FTP服务器和有效的凭据。
    *   目标系统是否允许执行powershell

4.  **投毒风险分析：**  POC 中存在一定的投毒风险，虽然主要功能是利用漏洞提升权限并导出Edge浏览器的数据，但以下几点需要关注：
    *   **FTP 上传：** 恶意攻击者可能通过控制 FTP 服务器来收集受害者的数据，例如浏览器保存的密码等敏感信息，存在信息泄露的风险。
    *   **计划任务：** 计划任务如果被滥用，可能被用于持久化后门。
    *   **C:\temp目录创建:** 如果创建临时目录失败，或者删除临时文件失败，也可能会导致拒绝服务或者留下恶意文件。

    综合考虑，我认为投毒风险为 10%。主要的风险在于，攻击者可能会利用此脚本在目标系统上植入后门或者窃取信息，但脚本本身的功能和目标相对明确，隐藏恶意代码的空间有限。 该脚本主要是配合BadUSB实现的攻击，如果用户对BadUSB设备不了解,容易被攻击.


**项目地址:** [toxy4ny/edge-maradeur](https://github.com/toxy4ny/edge-maradeur)

**漏洞详情:** [CVE-2025-21420](https://nvd.nist.gov/vuln/detail/CVE-2025-21420)

---



---

## POC #2

**来源**: [CVE-2025-21420-moiz-2x_CVE-2025-21420_POC.md](../2025/CVE-2025-21420-moiz-2x_CVE-2025-21420_POC.md)

## CVE-2025-21420 Windows Disk Cleanup Tool Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21420

**漏洞类型:** 权限提升

**影响应用:** Windows Disk Cleanup Tool (cleanmgr.exe)

**危害等级:** 高危，允许低权限用户获取SYSTEM权限

**影响版本:** 受影响的Windows版本详见CVE信息，在指定版本范围内

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-21420 存在于 Windows 磁盘清理工具中，是一个权限提升漏洞。根据漏洞库信息，多个 Windows 版本均受影响。搜索引擎结果显示，该漏洞允许攻击者获得 SYSTEM 权限。PoC 代码利用了 `SilentCleanup` 任务中存在的任意文件夹删除/移动/重命名漏洞，通过创建特定目录结构和结合其他 PoC（FolderOrFileDeleteToSystem, FolderContentsDeleteToFolderDelete）将清理操作重定向到 `C:/Config.msi` 目录，最终导致权限提升。 Diffing cleanmgr.exe表明新版本引入了 ProcessRedirectionTrustPolicy 缓解措施，暗示了漏洞与目录重定向有关。

**有效性：**
PoC代码似乎是有效的，因为它指向了利用 `SilentCleanup` 任务进行权限提升的已知方法。

**投毒风险：**
PoC 代码主要包含创建目录、写入文件和运行计划任务的命令。虽然这些操作本身看起来无害，但是结合文档中的描述，利用这个PoC需要下载另外的两个存储库，即`FolderOrFileDeleteToSystem`和`FolderContentsDeleteToFolderDelete`。因此，投毒风险主要来自未提供的两个利用代码，此处PoC只是一种触发方式，投毒可能性较低，风险估计为 5% 。

**利用方式：**
1.  创建必要的目录结构：`C:\$Windows.~WS`, `C:\ESD\Windows`, `C:\ESD\Download`，并在每个目录中创建一个 `text.txt` 文件。
2.  利用`FolderOrFileDeleteToSystem`设置`Config.msi`目录
3.  利用`FolderContentsDeleteToFolderDelete`重定向清理目标
4.  运行 `SilentCleanup` 计划任务，触发磁盘清理工具。
5.  利用权限提升执行任意代码（例如，通过 `osk.exe`）。

**项目地址:** [moiz-2x/CVE-2025-21420_POC](https://github.com/moiz-2x/CVE-2025-21420_POC)

**漏洞详情:** [CVE-2025-21420](https://nvd.nist.gov/vuln/detail/CVE-2025-21420)

---

## POC #3

**来源**: [CVE-2025-21420-toxy4ny_edge-maradeur.md](../2025/CVE-2025-21420-toxy4ny_edge-maradeur.md)

## CVE-2025-21420-Windows Disk Cleanup Tool-权限提升

**漏洞编号:** CVE-2025-21420

**漏洞类型:** 权限提升

**影响应用:** Windows Disk Cleanup Tool

**危害等级:** 高危，可导致系统权限被获取

**影响版本:** 受影响的Windows版本见CVE描述

**利用条件:** 需要物理访问（BadUSB）或者已控制目标机器执行powershell

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和提供的POC代码，此漏洞利用的有效性较高。漏洞CVE-2025-21420允许攻击者通过Windows Disk Cleanup Tool获得权限提升。利用方式如下：

1.  **漏洞描述：** CVE-2025-21420 是 Windows Disk Cleanup Tool 的一个权限提升漏洞，攻击者可以利用此漏洞获取 SYSTEM 权限。

2.  **利用方式：** 提供的POC代码（`edge-maradeur.txt`）是一个BadUSB脚本，它模拟键盘输入，执行以下步骤：
    *   创建一个计划任务 `ElevatePrivileges`，该任务使用 SYSTEM 权限运行 PowerShell。
    *   该PowerShell脚本的功能是:
        *   获取当前用户名。
        *   定位Edge浏览器的Login Data数据库文件。
        *   在C:\temp创建临时目录
        *   复制Login Data数据库到临时目录。
        *   使用提供的 FTP 凭据将Login Data数据库上传到远程FTP服务器。
        *   删除临时文件。
        *   退出 PowerShell。
    *   该脚本结合了CVE-2025-21420和CVE-2025-21401（根据README.md）。

3.  **有效性：** 该POC的有效性取决于以下因素：
    *   目标系统是否受 CVE-2025-21420 影响。
    *   目标系统是否安装了Edge浏览器，且存在Login Data数据库。
    *   攻击者是否拥有可用的FTP服务器和有效的凭据。
    *   目标系统是否允许执行powershell

4.  **投毒风险分析：**  POC 中存在一定的投毒风险，虽然主要功能是利用漏洞提升权限并导出Edge浏览器的数据，但以下几点需要关注：
    *   **FTP 上传：** 恶意攻击者可能通过控制 FTP 服务器来收集受害者的数据，例如浏览器保存的密码等敏感信息，存在信息泄露的风险。
    *   **计划任务：** 计划任务如果被滥用，可能被用于持久化后门。
    *   **C:\temp目录创建:** 如果创建临时目录失败，或者删除临时文件失败，也可能会导致拒绝服务或者留下恶意文件。

    综合考虑，我认为投毒风险为 10%。主要的风险在于，攻击者可能会利用此脚本在目标系统上植入后门或者窃取信息，但脚本本身的功能和目标相对明确，隐藏恶意代码的空间有限。 该脚本主要是配合BadUSB实现的攻击，如果用户对BadUSB设备不了解,容易被攻击.


**项目地址:** [toxy4ny/edge-maradeur](https://github.com/toxy4ny/edge-maradeur)

**漏洞详情:** [CVE-2025-21420](https://nvd.nist.gov/vuln/detail/CVE-2025-21420)

---



---

## POC #2

**来源**: [CVE-2025-21420-moiz-2x_CVE-2025-21420_POC.md](../2025/CVE-2025-21420-moiz-2x_CVE-2025-21420_POC.md)

## CVE-2025-21420 Windows Disk Cleanup Tool Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21420

**漏洞类型:** 权限提升

**影响应用:** Windows Disk Cleanup Tool (cleanmgr.exe)

**危害等级:** 高危，允许低权限用户获取SYSTEM权限

**影响版本:** 受影响的Windows版本详见CVE信息，在指定版本范围内

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-21420 存在于 Windows 磁盘清理工具中，是一个权限提升漏洞。根据漏洞库信息，多个 Windows 版本均受影响。搜索引擎结果显示，该漏洞允许攻击者获得 SYSTEM 权限。PoC 代码利用了 `SilentCleanup` 任务中存在的任意文件夹删除/移动/重命名漏洞，通过创建特定目录结构和结合其他 PoC（FolderOrFileDeleteToSystem, FolderContentsDeleteToFolderDelete）将清理操作重定向到 `C:/Config.msi` 目录，最终导致权限提升。 Diffing cleanmgr.exe表明新版本引入了 ProcessRedirectionTrustPolicy 缓解措施，暗示了漏洞与目录重定向有关。

**有效性：**
PoC代码似乎是有效的，因为它指向了利用 `SilentCleanup` 任务进行权限提升的已知方法。

**投毒风险：**
PoC 代码主要包含创建目录、写入文件和运行计划任务的命令。虽然这些操作本身看起来无害，但是结合文档中的描述，利用这个PoC需要下载另外的两个存储库，即`FolderOrFileDeleteToSystem`和`FolderContentsDeleteToFolderDelete`。因此，投毒风险主要来自未提供的两个利用代码，此处PoC只是一种触发方式，投毒可能性较低，风险估计为 5% 。

**利用方式：**
1.  创建必要的目录结构：`C:\$Windows.~WS`, `C:\ESD\Windows`, `C:\ESD\Download`，并在每个目录中创建一个 `text.txt` 文件。
2.  利用`FolderOrFileDeleteToSystem`设置`Config.msi`目录
3.  利用`FolderContentsDeleteToFolderDelete`重定向清理目标
4.  运行 `SilentCleanup` 计划任务，触发磁盘清理工具。
5.  利用权限提升执行任意代码（例如，通过 `osk.exe`）。

**项目地址:** [moiz-2x/CVE-2025-21420_POC](https://github.com/moiz-2x/CVE-2025-21420_POC)

**漏洞详情:** [CVE-2025-21420](https://nvd.nist.gov/vuln/detail/CVE-2025-21420)

---

## POC #3

**来源**: [CVE-2025-21420-toxy4ny_edge-maradeur.md](../2025/CVE-2025-21420-toxy4ny_edge-maradeur.md)

## CVE-2025-21420-Windows Disk Cleanup Tool-权限提升

**漏洞编号:** CVE-2025-21420

**漏洞类型:** 权限提升

**影响应用:** Windows Disk Cleanup Tool

**危害等级:** 高危，可导致系统权限被获取

**影响版本:** 受影响的Windows版本见CVE描述

**利用条件:** 需要物理访问（BadUSB）或者已控制目标机器执行powershell

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和提供的POC代码，此漏洞利用的有效性较高。漏洞CVE-2025-21420允许攻击者通过Windows Disk Cleanup Tool获得权限提升。利用方式如下：

1.  **漏洞描述：** CVE-2025-21420 是 Windows Disk Cleanup Tool 的一个权限提升漏洞，攻击者可以利用此漏洞获取 SYSTEM 权限。

2.  **利用方式：** 提供的POC代码（`edge-maradeur.txt`）是一个BadUSB脚本，它模拟键盘输入，执行以下步骤：
    *   创建一个计划任务 `ElevatePrivileges`，该任务使用 SYSTEM 权限运行 PowerShell。
    *   该PowerShell脚本的功能是:
        *   获取当前用户名。
        *   定位Edge浏览器的Login Data数据库文件。
        *   在C:\temp创建临时目录
        *   复制Login Data数据库到临时目录。
        *   使用提供的 FTP 凭据将Login Data数据库上传到远程FTP服务器。
        *   删除临时文件。
        *   退出 PowerShell。
    *   该脚本结合了CVE-2025-21420和CVE-2025-21401（根据README.md）。

3.  **有效性：** 该POC的有效性取决于以下因素：
    *   目标系统是否受 CVE-2025-21420 影响。
    *   目标系统是否安装了Edge浏览器，且存在Login Data数据库。
    *   攻击者是否拥有可用的FTP服务器和有效的凭据。
    *   目标系统是否允许执行powershell

4.  **投毒风险分析：**  POC 中存在一定的投毒风险，虽然主要功能是利用漏洞提升权限并导出Edge浏览器的数据，但以下几点需要关注：
    *   **FTP 上传：** 恶意攻击者可能通过控制 FTP 服务器来收集受害者的数据，例如浏览器保存的密码等敏感信息，存在信息泄露的风险。
    *   **计划任务：** 计划任务如果被滥用，可能被用于持久化后门。
    *   **C:\temp目录创建:** 如果创建临时目录失败，或者删除临时文件失败，也可能会导致拒绝服务或者留下恶意文件。

    综合考虑，我认为投毒风险为 10%。主要的风险在于，攻击者可能会利用此脚本在目标系统上植入后门或者窃取信息，但脚本本身的功能和目标相对明确，隐藏恶意代码的空间有限。 该脚本主要是配合BadUSB实现的攻击，如果用户对BadUSB设备不了解,容易被攻击.


**项目地址:** [toxy4ny/edge-maradeur](https://github.com/toxy4ny/edge-maradeur)

**漏洞详情:** [CVE-2025-21420](https://nvd.nist.gov/vuln/detail/CVE-2025-21420)

---



---

## POC #2

**来源**: [CVE-2025-21420-moiz-2x_CVE-2025-21420_POC.md](../2025/CVE-2025-21420-moiz-2x_CVE-2025-21420_POC.md)

## CVE-2025-21420 Windows Disk Cleanup Tool Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21420

**漏洞类型:** 权限提升

**影响应用:** Windows Disk Cleanup Tool (cleanmgr.exe)

**危害等级:** 高危，允许低权限用户获取SYSTEM权限

**影响版本:** 受影响的Windows版本详见CVE信息，在指定版本范围内

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-21420 存在于 Windows 磁盘清理工具中，是一个权限提升漏洞。根据漏洞库信息，多个 Windows 版本均受影响。搜索引擎结果显示，该漏洞允许攻击者获得 SYSTEM 权限。PoC 代码利用了 `SilentCleanup` 任务中存在的任意文件夹删除/移动/重命名漏洞，通过创建特定目录结构和结合其他 PoC（FolderOrFileDeleteToSystem, FolderContentsDeleteToFolderDelete）将清理操作重定向到 `C:/Config.msi` 目录，最终导致权限提升。 Diffing cleanmgr.exe表明新版本引入了 ProcessRedirectionTrustPolicy 缓解措施，暗示了漏洞与目录重定向有关。

**有效性：**
PoC代码似乎是有效的，因为它指向了利用 `SilentCleanup` 任务进行权限提升的已知方法。

**投毒风险：**
PoC 代码主要包含创建目录、写入文件和运行计划任务的命令。虽然这些操作本身看起来无害，但是结合文档中的描述，利用这个PoC需要下载另外的两个存储库，即`FolderOrFileDeleteToSystem`和`FolderContentsDeleteToFolderDelete`。因此，投毒风险主要来自未提供的两个利用代码，此处PoC只是一种触发方式，投毒可能性较低，风险估计为 5% 。

**利用方式：**
1.  创建必要的目录结构：`C:\$Windows.~WS`, `C:\ESD\Windows`, `C:\ESD\Download`，并在每个目录中创建一个 `text.txt` 文件。
2.  利用`FolderOrFileDeleteToSystem`设置`Config.msi`目录
3.  利用`FolderContentsDeleteToFolderDelete`重定向清理目标
4.  运行 `SilentCleanup` 计划任务，触发磁盘清理工具。
5.  利用权限提升执行任意代码（例如，通过 `osk.exe`）。

**项目地址:** [moiz-2x/CVE-2025-21420_POC](https://github.com/moiz-2x/CVE-2025-21420_POC)

**漏洞详情:** [CVE-2025-21420](https://nvd.nist.gov/vuln/detail/CVE-2025-21420)

---

## POC #3

**来源**: [CVE-2025-21420-toxy4ny_edge-maradeur.md](../2025/CVE-2025-21420-toxy4ny_edge-maradeur.md)

## CVE-2025-21420-Windows Disk Cleanup Tool-权限提升

**漏洞编号:** CVE-2025-21420

**漏洞类型:** 权限提升

**影响应用:** Windows Disk Cleanup Tool

**危害等级:** 高危，可导致系统权限被获取

**影响版本:** 受影响的Windows版本见CVE描述

**利用条件:** 需要物理访问（BadUSB）或者已控制目标机器执行powershell

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和提供的POC代码，此漏洞利用的有效性较高。漏洞CVE-2025-21420允许攻击者通过Windows Disk Cleanup Tool获得权限提升。利用方式如下：

1.  **漏洞描述：** CVE-2025-21420 是 Windows Disk Cleanup Tool 的一个权限提升漏洞，攻击者可以利用此漏洞获取 SYSTEM 权限。

2.  **利用方式：** 提供的POC代码（`edge-maradeur.txt`）是一个BadUSB脚本，它模拟键盘输入，执行以下步骤：
    *   创建一个计划任务 `ElevatePrivileges`，该任务使用 SYSTEM 权限运行 PowerShell。
    *   该PowerShell脚本的功能是:
        *   获取当前用户名。
        *   定位Edge浏览器的Login Data数据库文件。
        *   在C:\temp创建临时目录
        *   复制Login Data数据库到临时目录。
        *   使用提供的 FTP 凭据将Login Data数据库上传到远程FTP服务器。
        *   删除临时文件。
        *   退出 PowerShell。
    *   该脚本结合了CVE-2025-21420和CVE-2025-21401（根据README.md）。

3.  **有效性：** 该POC的有效性取决于以下因素：
    *   目标系统是否受 CVE-2025-21420 影响。
    *   目标系统是否安装了Edge浏览器，且存在Login Data数据库。
    *   攻击者是否拥有可用的FTP服务器和有效的凭据。
    *   目标系统是否允许执行powershell

4.  **投毒风险分析：**  POC 中存在一定的投毒风险，虽然主要功能是利用漏洞提升权限并导出Edge浏览器的数据，但以下几点需要关注：
    *   **FTP 上传：** 恶意攻击者可能通过控制 FTP 服务器来收集受害者的数据，例如浏览器保存的密码等敏感信息，存在信息泄露的风险。
    *   **计划任务：** 计划任务如果被滥用，可能被用于持久化后门。
    *   **C:\temp目录创建:** 如果创建临时目录失败，或者删除临时文件失败，也可能会导致拒绝服务或者留下恶意文件。

    综合考虑，我认为投毒风险为 10%。主要的风险在于，攻击者可能会利用此脚本在目标系统上植入后门或者窃取信息，但脚本本身的功能和目标相对明确，隐藏恶意代码的空间有限。 该脚本主要是配合BadUSB实现的攻击，如果用户对BadUSB设备不了解,容易被攻击.


**项目地址:** [toxy4ny/edge-maradeur](https://github.com/toxy4ny/edge-maradeur)

**漏洞详情:** [CVE-2025-21420](https://nvd.nist.gov/vuln/detail/CVE-2025-21420)

---



---

## POC #2

**来源**: [CVE-2025-21420-moiz-2x_CVE-2025-21420_POC.md](../2025/CVE-2025-21420-moiz-2x_CVE-2025-21420_POC.md)

## CVE-2025-21420 Windows Disk Cleanup Tool Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21420

**漏洞类型:** 权限提升

**影响应用:** Windows Disk Cleanup Tool (cleanmgr.exe)

**危害等级:** 高危，允许低权限用户获取SYSTEM权限

**影响版本:** 受影响的Windows版本详见CVE信息，在指定版本范围内

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-21420 存在于 Windows 磁盘清理工具中，是一个权限提升漏洞。根据漏洞库信息，多个 Windows 版本均受影响。搜索引擎结果显示，该漏洞允许攻击者获得 SYSTEM 权限。PoC 代码利用了 `SilentCleanup` 任务中存在的任意文件夹删除/移动/重命名漏洞，通过创建特定目录结构和结合其他 PoC（FolderOrFileDeleteToSystem, FolderContentsDeleteToFolderDelete）将清理操作重定向到 `C:/Config.msi` 目录，最终导致权限提升。 Diffing cleanmgr.exe表明新版本引入了 ProcessRedirectionTrustPolicy 缓解措施，暗示了漏洞与目录重定向有关。

**有效性：**
PoC代码似乎是有效的，因为它指向了利用 `SilentCleanup` 任务进行权限提升的已知方法。

**投毒风险：**
PoC 代码主要包含创建目录、写入文件和运行计划任务的命令。虽然这些操作本身看起来无害，但是结合文档中的描述，利用这个PoC需要下载另外的两个存储库，即`FolderOrFileDeleteToSystem`和`FolderContentsDeleteToFolderDelete`。因此，投毒风险主要来自未提供的两个利用代码，此处PoC只是一种触发方式，投毒可能性较低，风险估计为 5% 。

**利用方式：**
1.  创建必要的目录结构：`C:\$Windows.~WS`, `C:\ESD\Windows`, `C:\ESD\Download`，并在每个目录中创建一个 `text.txt` 文件。
2.  利用`FolderOrFileDeleteToSystem`设置`Config.msi`目录
3.  利用`FolderContentsDeleteToFolderDelete`重定向清理目标
4.  运行 `SilentCleanup` 计划任务，触发磁盘清理工具。
5.  利用权限提升执行任意代码（例如，通过 `osk.exe`）。

**项目地址:** [moiz-2x/CVE-2025-21420_POC](https://github.com/moiz-2x/CVE-2025-21420_POC)

**漏洞详情:** [CVE-2025-21420](https://nvd.nist.gov/vuln/detail/CVE-2025-21420)

---

## POC #3

**来源**: [CVE-2025-21420-toxy4ny_edge-maradeur.md](../2025/CVE-2025-21420-toxy4ny_edge-maradeur.md)

## CVE-2025-21420-Windows Disk Cleanup Tool-权限提升

**漏洞编号:** CVE-2025-21420

**漏洞类型:** 权限提升

**影响应用:** Windows Disk Cleanup Tool

**危害等级:** 高危，可导致系统权限被获取

**影响版本:** 受影响的Windows版本见CVE描述

**利用条件:** 需要物理访问（BadUSB）或者已控制目标机器执行powershell

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和提供的POC代码，此漏洞利用的有效性较高。漏洞CVE-2025-21420允许攻击者通过Windows Disk Cleanup Tool获得权限提升。利用方式如下：

1.  **漏洞描述：** CVE-2025-21420 是 Windows Disk Cleanup Tool 的一个权限提升漏洞，攻击者可以利用此漏洞获取 SYSTEM 权限。

2.  **利用方式：** 提供的POC代码（`edge-maradeur.txt`）是一个BadUSB脚本，它模拟键盘输入，执行以下步骤：
    *   创建一个计划任务 `ElevatePrivileges`，该任务使用 SYSTEM 权限运行 PowerShell。
    *   该PowerShell脚本的功能是:
        *   获取当前用户名。
        *   定位Edge浏览器的Login Data数据库文件。
        *   在C:\temp创建临时目录
        *   复制Login Data数据库到临时目录。
        *   使用提供的 FTP 凭据将Login Data数据库上传到远程FTP服务器。
        *   删除临时文件。
        *   退出 PowerShell。
    *   该脚本结合了CVE-2025-21420和CVE-2025-21401（根据README.md）。

3.  **有效性：** 该POC的有效性取决于以下因素：
    *   目标系统是否受 CVE-2025-21420 影响。
    *   目标系统是否安装了Edge浏览器，且存在Login Data数据库。
    *   攻击者是否拥有可用的FTP服务器和有效的凭据。
    *   目标系统是否允许执行powershell

4.  **投毒风险分析：**  POC 中存在一定的投毒风险，虽然主要功能是利用漏洞提升权限并导出Edge浏览器的数据，但以下几点需要关注：
    *   **FTP 上传：** 恶意攻击者可能通过控制 FTP 服务器来收集受害者的数据，例如浏览器保存的密码等敏感信息，存在信息泄露的风险。
    *   **计划任务：** 计划任务如果被滥用，可能被用于持久化后门。
    *   **C:\temp目录创建:** 如果创建临时目录失败，或者删除临时文件失败，也可能会导致拒绝服务或者留下恶意文件。

    综合考虑，我认为投毒风险为 10%。主要的风险在于，攻击者可能会利用此脚本在目标系统上植入后门或者窃取信息，但脚本本身的功能和目标相对明确，隐藏恶意代码的空间有限。 该脚本主要是配合BadUSB实现的攻击，如果用户对BadUSB设备不了解,容易被攻击.


**项目地址:** [toxy4ny/edge-maradeur](https://github.com/toxy4ny/edge-maradeur)

**漏洞详情:** [CVE-2025-21420](https://nvd.nist.gov/vuln/detail/CVE-2025-21420)

---



---

## POC #2

**来源**: [CVE-2025-21420-moiz-2x_CVE-2025-21420_POC.md](../2025/CVE-2025-21420-moiz-2x_CVE-2025-21420_POC.md)

## CVE-2025-21420 Windows Disk Cleanup Tool Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21420

**漏洞类型:** 权限提升

**影响应用:** Windows Disk Cleanup Tool (cleanmgr.exe)

**危害等级:** 高危，允许低权限用户获取SYSTEM权限

**影响版本:** 受影响的Windows版本详见CVE信息，在指定版本范围内

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-21420 存在于 Windows 磁盘清理工具中，是一个权限提升漏洞。根据漏洞库信息，多个 Windows 版本均受影响。搜索引擎结果显示，该漏洞允许攻击者获得 SYSTEM 权限。PoC 代码利用了 `SilentCleanup` 任务中存在的任意文件夹删除/移动/重命名漏洞，通过创建特定目录结构和结合其他 PoC（FolderOrFileDeleteToSystem, FolderContentsDeleteToFolderDelete）将清理操作重定向到 `C:/Config.msi` 目录，最终导致权限提升。 Diffing cleanmgr.exe表明新版本引入了 ProcessRedirectionTrustPolicy 缓解措施，暗示了漏洞与目录重定向有关。

**有效性：**
PoC代码似乎是有效的，因为它指向了利用 `SilentCleanup` 任务进行权限提升的已知方法。

**投毒风险：**
PoC 代码主要包含创建目录、写入文件和运行计划任务的命令。虽然这些操作本身看起来无害，但是结合文档中的描述，利用这个PoC需要下载另外的两个存储库，即`FolderOrFileDeleteToSystem`和`FolderContentsDeleteToFolderDelete`。因此，投毒风险主要来自未提供的两个利用代码，此处PoC只是一种触发方式，投毒可能性较低，风险估计为 5% 。

**利用方式：**
1.  创建必要的目录结构：`C:\$Windows.~WS`, `C:\ESD\Windows`, `C:\ESD\Download`，并在每个目录中创建一个 `text.txt` 文件。
2.  利用`FolderOrFileDeleteToSystem`设置`Config.msi`目录
3.  利用`FolderContentsDeleteToFolderDelete`重定向清理目标
4.  运行 `SilentCleanup` 计划任务，触发磁盘清理工具。
5.  利用权限提升执行任意代码（例如，通过 `osk.exe`）。

**项目地址:** [moiz-2x/CVE-2025-21420_POC](https://github.com/moiz-2x/CVE-2025-21420_POC)

**漏洞详情:** [CVE-2025-21420](https://nvd.nist.gov/vuln/detail/CVE-2025-21420)

---

## POC #3

**来源**: [CVE-2025-21420-toxy4ny_edge-maradeur.md](../2025/CVE-2025-21420-toxy4ny_edge-maradeur.md)

## CVE-2025-21420-Windows Disk Cleanup Tool-权限提升

**漏洞编号:** CVE-2025-21420

**漏洞类型:** 权限提升

**影响应用:** Windows Disk Cleanup Tool

**危害等级:** 高危，可导致系统权限被获取

**影响版本:** 受影响的Windows版本见CVE描述

**利用条件:** 需要物理访问（BadUSB）或者已控制目标机器执行powershell

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和提供的POC代码，此漏洞利用的有效性较高。漏洞CVE-2025-21420允许攻击者通过Windows Disk Cleanup Tool获得权限提升。利用方式如下：

1.  **漏洞描述：** CVE-2025-21420 是 Windows Disk Cleanup Tool 的一个权限提升漏洞，攻击者可以利用此漏洞获取 SYSTEM 权限。

2.  **利用方式：** 提供的POC代码（`edge-maradeur.txt`）是一个BadUSB脚本，它模拟键盘输入，执行以下步骤：
    *   创建一个计划任务 `ElevatePrivileges`，该任务使用 SYSTEM 权限运行 PowerShell。
    *   该PowerShell脚本的功能是:
        *   获取当前用户名。
        *   定位Edge浏览器的Login Data数据库文件。
        *   在C:\temp创建临时目录
        *   复制Login Data数据库到临时目录。
        *   使用提供的 FTP 凭据将Login Data数据库上传到远程FTP服务器。
        *   删除临时文件。
        *   退出 PowerShell。
    *   该脚本结合了CVE-2025-21420和CVE-2025-21401（根据README.md）。

3.  **有效性：** 该POC的有效性取决于以下因素：
    *   目标系统是否受 CVE-2025-21420 影响。
    *   目标系统是否安装了Edge浏览器，且存在Login Data数据库。
    *   攻击者是否拥有可用的FTP服务器和有效的凭据。
    *   目标系统是否允许执行powershell

4.  **投毒风险分析：**  POC 中存在一定的投毒风险，虽然主要功能是利用漏洞提升权限并导出Edge浏览器的数据，但以下几点需要关注：
    *   **FTP 上传：** 恶意攻击者可能通过控制 FTP 服务器来收集受害者的数据，例如浏览器保存的密码等敏感信息，存在信息泄露的风险。
    *   **计划任务：** 计划任务如果被滥用，可能被用于持久化后门。
    *   **C:\temp目录创建:** 如果创建临时目录失败，或者删除临时文件失败，也可能会导致拒绝服务或者留下恶意文件。

    综合考虑，我认为投毒风险为 10%。主要的风险在于，攻击者可能会利用此脚本在目标系统上植入后门或者窃取信息，但脚本本身的功能和目标相对明确，隐藏恶意代码的空间有限。 该脚本主要是配合BadUSB实现的攻击，如果用户对BadUSB设备不了解,容易被攻击.


**项目地址:** [toxy4ny/edge-maradeur](https://github.com/toxy4ny/edge-maradeur)

**漏洞详情:** [CVE-2025-21420](https://nvd.nist.gov/vuln/detail/CVE-2025-21420)

---



---

## POC #2

**来源**: [CVE-2025-21420-moiz-2x_CVE-2025-21420_POC.md](../2025/CVE-2025-21420-moiz-2x_CVE-2025-21420_POC.md)

## CVE-2025-21420 Windows Disk Cleanup Tool Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21420

**漏洞类型:** 权限提升

**影响应用:** Windows Disk Cleanup Tool (cleanmgr.exe)

**危害等级:** 高危，允许低权限用户获取SYSTEM权限

**影响版本:** 受影响的Windows版本详见CVE信息，在指定版本范围内

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-21420 存在于 Windows 磁盘清理工具中，是一个权限提升漏洞。根据漏洞库信息，多个 Windows 版本均受影响。搜索引擎结果显示，该漏洞允许攻击者获得 SYSTEM 权限。PoC 代码利用了 `SilentCleanup` 任务中存在的任意文件夹删除/移动/重命名漏洞，通过创建特定目录结构和结合其他 PoC（FolderOrFileDeleteToSystem, FolderContentsDeleteToFolderDelete）将清理操作重定向到 `C:/Config.msi` 目录，最终导致权限提升。 Diffing cleanmgr.exe表明新版本引入了 ProcessRedirectionTrustPolicy 缓解措施，暗示了漏洞与目录重定向有关。

**有效性：**
PoC代码似乎是有效的，因为它指向了利用 `SilentCleanup` 任务进行权限提升的已知方法。

**投毒风险：**
PoC 代码主要包含创建目录、写入文件和运行计划任务的命令。虽然这些操作本身看起来无害，但是结合文档中的描述，利用这个PoC需要下载另外的两个存储库，即`FolderOrFileDeleteToSystem`和`FolderContentsDeleteToFolderDelete`。因此，投毒风险主要来自未提供的两个利用代码，此处PoC只是一种触发方式，投毒可能性较低，风险估计为 5% 。

**利用方式：**
1.  创建必要的目录结构：`C:\$Windows.~WS`, `C:\ESD\Windows`, `C:\ESD\Download`，并在每个目录中创建一个 `text.txt` 文件。
2.  利用`FolderOrFileDeleteToSystem`设置`Config.msi`目录
3.  利用`FolderContentsDeleteToFolderDelete`重定向清理目标
4.  运行 `SilentCleanup` 计划任务，触发磁盘清理工具。
5.  利用权限提升执行任意代码（例如，通过 `osk.exe`）。

**项目地址:** [moiz-2x/CVE-2025-21420_POC](https://github.com/moiz-2x/CVE-2025-21420_POC)

**漏洞详情:** [CVE-2025-21420](https://nvd.nist.gov/vuln/detail/CVE-2025-21420)

---

## POC #3

**来源**: [CVE-2025-21420-toxy4ny_edge-maradeur.md](../2025/CVE-2025-21420-toxy4ny_edge-maradeur.md)

## CVE-2025-21420-Windows Disk Cleanup Tool-权限提升

**漏洞编号:** CVE-2025-21420

**漏洞类型:** 权限提升

**影响应用:** Windows Disk Cleanup Tool

**危害等级:** 高危，可导致系统权限被获取

**影响版本:** 受影响的Windows版本见CVE描述

**利用条件:** 需要物理访问（BadUSB）或者已控制目标机器执行powershell

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和提供的POC代码，此漏洞利用的有效性较高。漏洞CVE-2025-21420允许攻击者通过Windows Disk Cleanup Tool获得权限提升。利用方式如下：

1.  **漏洞描述：** CVE-2025-21420 是 Windows Disk Cleanup Tool 的一个权限提升漏洞，攻击者可以利用此漏洞获取 SYSTEM 权限。

2.  **利用方式：** 提供的POC代码（`edge-maradeur.txt`）是一个BadUSB脚本，它模拟键盘输入，执行以下步骤：
    *   创建一个计划任务 `ElevatePrivileges`，该任务使用 SYSTEM 权限运行 PowerShell。
    *   该PowerShell脚本的功能是:
        *   获取当前用户名。
        *   定位Edge浏览器的Login Data数据库文件。
        *   在C:\temp创建临时目录
        *   复制Login Data数据库到临时目录。
        *   使用提供的 FTP 凭据将Login Data数据库上传到远程FTP服务器。
        *   删除临时文件。
        *   退出 PowerShell。
    *   该脚本结合了CVE-2025-21420和CVE-2025-21401（根据README.md）。

3.  **有效性：** 该POC的有效性取决于以下因素：
    *   目标系统是否受 CVE-2025-21420 影响。
    *   目标系统是否安装了Edge浏览器，且存在Login Data数据库。
    *   攻击者是否拥有可用的FTP服务器和有效的凭据。
    *   目标系统是否允许执行powershell

4.  **投毒风险分析：**  POC 中存在一定的投毒风险，虽然主要功能是利用漏洞提升权限并导出Edge浏览器的数据，但以下几点需要关注：
    *   **FTP 上传：** 恶意攻击者可能通过控制 FTP 服务器来收集受害者的数据，例如浏览器保存的密码等敏感信息，存在信息泄露的风险。
    *   **计划任务：** 计划任务如果被滥用，可能被用于持久化后门。
    *   **C:\temp目录创建:** 如果创建临时目录失败，或者删除临时文件失败，也可能会导致拒绝服务或者留下恶意文件。

    综合考虑，我认为投毒风险为 10%。主要的风险在于，攻击者可能会利用此脚本在目标系统上植入后门或者窃取信息，但脚本本身的功能和目标相对明确，隐藏恶意代码的空间有限。 该脚本主要是配合BadUSB实现的攻击，如果用户对BadUSB设备不了解,容易被攻击.


**项目地址:** [toxy4ny/edge-maradeur](https://github.com/toxy4ny/edge-maradeur)

**漏洞详情:** [CVE-2025-21420](https://nvd.nist.gov/vuln/detail/CVE-2025-21420)

---

