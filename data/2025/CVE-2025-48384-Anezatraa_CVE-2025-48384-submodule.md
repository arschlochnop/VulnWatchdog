## CVE-2025-48384 - Git 任意文件写入

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 任意文件写入

**影响应用:** Git

**危害等级:** 高危

**CVSS评分:** 待定

**影响版本:** 受影响版本范围未知，参考GitHub advisory

**利用条件:** 需要克隆包含恶意配置的Git仓库

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 40%

## 详情

CVE-2025-48384 允许攻击者创建恶意的 Git 仓库，当用户克隆该仓库时，可能导致任意文件写入。该漏洞源于 Git 在处理 submodule 时存在缺陷。通过在 `.gitmodules` 文件中构造恶意的路径，攻击者可以控制 `git clone` 命令将文件写入到非预期的位置。 

POC有效性分析：
根据搜索结果和POC代码（liamg/CVE-2025-48384），该漏洞存在可利用性。POC代码包含一个 `.gitmodules` 文件和一个 `post-checkout` 脚本。`.gitmodules` 文件中定义了一个恶意 submodule，其路径被设置为一个绝对路径，指向系统中的敏感位置。`post-checkout` 脚本会在 `git clone` 之后自动执行，从而完成任意文件写入。执行 POC 需要先创建一个包含恶意 `.gitmodules` 文件的 Git 仓库，然后诱导用户克隆该仓库。当用户克隆仓库时，Git 会解析 `.gitmodules` 文件，并尝试初始化 submodule。由于 submodule 的路径被设置为恶意路径，Git 会将文件写入到该路径所指向的位置。

利用步骤：
1. 创建一个包含恶意 `.gitmodules` 文件的 Git 仓库。
2. 将恶意仓库托管到公共代码托管平台或通过其他方式传播给目标用户。
3. 诱导目标用户克隆该仓库。
4. 当用户克隆仓库时，`post-checkout` 脚本被执行，完成任意文件写入。

投毒风险分析：
该POC的投毒风险为中等。虽然 POC 本身的功能是演示任意文件写入漏洞，但攻击者可能利用该漏洞进行恶意活动，例如：
*   植入后门：攻击者可以将恶意代码写入到系统启动脚本或常用工具中，从而在用户系统上植入后门。
*   篡改配置文件：攻击者可以修改系统配置文件，例如 SSH 配置文件，从而控制用户系统。
*   窃取敏感信息：攻击者可以将用户敏感信息，例如 SSH 密钥，写入到公共目录，从而窃取用户敏感信息。

该POC的 `post-checkout` 脚本包含 `echo` 和 `id` 命令，这本身不是恶意代码。但是，攻击者可以修改该脚本，使其包含更具破坏性的恶意代码。此外，该POC使用绝对路径来指定 submodule 的位置，这可能会引起用户的怀疑。攻击者可以通过使用相对路径或环境变量来隐藏恶意路径，从而提高攻击的隐蔽性。由于该漏洞影响 Git，一个被广泛使用的版本控制系统，因此利用该漏洞进行大规模攻击是可能的。但是，由于利用该漏洞需要用户克隆恶意仓库，因此攻击的成功率取决于用户的警惕性。
总的来说，该漏洞的投毒风险为中等，约为40%。攻击者可以利用该漏洞进行恶意活动，但攻击的成功率取决于用户的警惕性和攻击者的技术水平。

**项目地址:** https://github.com/liamg/CVE-2025-48384

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-48384
