## CVE-2025-2011 - Depicter Slider & Popup Builder (WordPress Plugin) SQL注入

**漏洞编号:** CVE-2025-2011

**漏洞类型:** SQL注入

**影响应用:** Depicter Slider & Popup Builder (WordPress Plugin)

**危害等级:** 高危 (High)

**CVSS评分:** 8.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** <= 3.6.1

**利用条件:** 远程网络访问，通常需要具备一定权限访问admin-ajax.php（取决于具体配置，但该POC显示可通过depicter-lead-index动作触发）

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC代码针对WordPress的Depicter插件中的SQL注入漏洞进行了高度自动化的实现。其核心逻辑集中在通过's'参数注入Union-based SQL负载。代码首先利用'9999')union'闭合原始查询，随后通过'admin-ajax.php'接口发起请求。有效性方面，POC展示了完整的数据库提取链路：从获取当前数据库名称、枚举所有数据库、提取表名到最后的批量拖取数据。POC使用了python的requests库配合tqdm进度条，具备极高的实战价值。其逻辑严密，通过分块（limit/offset）方式处理大数据量采集，解决了SQL注入在提取海量数据时的稳定性问题。代码中定义的sql_query函数封装了核心注入点，这使得该工具可以直接用于验证目标系统是否受到CVE-2025-2011的影响。利用步骤如下：1. 攻击者确定目标WordPress站点安装了Depicter插件且版本低于3.6.2。2. 构造包含恶意SQL负载的GET或POST请求发送至wp-admin/admin-ajax.php。3. 通过控制'action'参数为'depicter-lead-index'并操作's'查询参数，注入UNION SELECT语句。4. 插件未对's'参数进行充分转义即代入SQL查询，导致攻击者可以回显数据库中的敏感信息，包括用户凭据、站点配置等。5. 攻击者可以使用POC中提供的自动化脚本一键导出整站数据库。该漏洞的修复方案是将插件升级至3.6.2版本，该版本引入了预编译语句和严格的参数过滤。

【投毒风险分析】经过对POC代码的静态分析，该脚本表现出较低的投毒风险（约15%）。代码主要使用了标准库如argparse、os以及知名的第三方库requests和tqdm。脚本中禁用了urllib3的SSL警告（disable_warnings），这是安全测试工具中常见的做法，并非恶意行为。代码逻辑清晰，其主要功能围绕SQL数据提取展开，未发现明显的恶意行为特征，如：1. 远程反弹Shell：代码中没有涉及socket或subprocess调用来建立后门连接。2. 敏感信息上传：脚本未发现将本地敏感文件（如ssh keys, env文件）异步上传至攻击者C2服务器的代码段。3. 文件加密或自删：不存在勒索插件或破坏性的IO操作。4. 混淆编码：代码完全开源可见，没有任何base64混淆或动态exec/eval代码执行。潜在风险点在于，该脚本可能会被恶意攻击者重新包装成更复杂的漏洞利用框架，或者在复杂的供应链环境中被插入恶意更新。但就目前提供的代码片段而言，它是一个纯粹的安全研究工具。防御者在使用时仍应注意，虽然代码本身无毒，但在非授权环境下运行此脚本可能导致法律风险和目标数据库的性能损耗。

**项目地址:** [https://www.wiz.io/vulnerability-database/cve/cve-2025-2011](https://www.wiz.io/vulnerability-database/cve/cve-2025-2011)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-2011](https://nvd.nist.gov/vuln/detail/CVE-2025-2011)
