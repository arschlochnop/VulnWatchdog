## CVE-2025-6440 - WooCommerce Designer Pro (WordPress Plugin) 任意文件上传 (Unrestricted File Upload)

**漏洞编号:** CVE-2025-6440

**漏洞类型:** 任意文件上传 (Unrestricted File Upload)

**影响应用:** WooCommerce Designer Pro (WordPress Plugin)

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (Estimated)

**影响版本:** 未知 (BETA分析中)

**利用条件:** 需要能够访问wp-admin/admin-ajax.php接口，无需特定管理员权限即可触发AJAX动作

**POC 可用性:** 8/10

**POC 类型:** 概念验证 (Nuclei Template)

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：该漏洞存在于WooCommerce Designer Pro插件的wcdp_save_canvas_design_ajax功能中。通过对POC代码的深入分析，该攻击向量利用了WordPress的AJAX处理机制。攻击者通过发送一个带有特定action参数（wcdp_save_canvas_design_ajax）的POST请求，并在params JSON对象中定义文件元数据（如ext: txt），可以绕过常规的文件类型检查。POC展示了如何将一个包含随机字符串的.txt文件上传到/wp-content/uploads/wcdp-uploads/temp/目录下。此POC被证明是高度有效的，因为它不仅包含了上传逻辑，还包含了一个自动化的验证步骤，即通过GET请求访问上传后的路径并匹配特定内容（nuclei-cve-2025-6440-test）。如果该插件未对上传文件的扩展名或MIME类型进行严格的白名单校验，攻击者可以轻易将.txt更换为.php，从而实现远程代码执行（RCE）。该POC代码结构清晰，基于Nuclei引擎编写，具有极高的可复现性和自动化潜力。利用步骤：1. 构造一个指向/wp-admin/admin-ajax.php的POST请求。2. 设置Content-Type为multipart/form-data并包含边界标识。3. 在表单数据中设置action为wcdp_save_canvas_design_ajax。4. 在params参数中构造JSON负载，定义目标文件名、扩展名及随机生成的目录名。5. 在后续部分上传实际的文件内容。6. 访问返回路径或默认生成的临时目录确认文件是否成功持久化。投毒风险分析：经过对提供文件的代码审计，投毒风险极低。该POC是以YAML格式编写的Nuclei模板，其行为完全透明。代码逻辑中不包含任何混淆加密、外部Shellcode下载或未授权的敏感信息外泄操作。唯一涉及的外部通信是针对目标主机的正常漏洞检测请求。其上传的内容为硬编码的测试字符串，不具备恶意破坏性。项目中虽然标注为BETA版本，但其核心逻辑使用了Nuclei的内置标准函数（如randstr），没有调用系统级危险命令。此类模板通常由安全社区维护，旨在用于合法的防御性扫描。分析结论显示，该文件未发现后门植入或供应链污染迹象，可安全用于组织内部的资产扫描和漏洞验证工作。

**项目地址:** /tmp/vulnwatchdog_dfe7b2982245f1205c409de3a107cdad/

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-6440](https://nvd.nist.gov/vuln/detail/CVE-2025-6440)
