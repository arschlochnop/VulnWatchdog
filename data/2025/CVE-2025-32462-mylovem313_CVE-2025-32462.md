## CVE-2025-32462 - Sudo 权限提升

**漏洞编号:** CVE-2025-32462

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高 (High)

**CVSS评分:** CVSS评分暂未完全公布，预估 7.0-8.5

**影响版本:** Sudo 1.9.17p1 之前的版本

**利用条件:** 本地用户访问权限，且 sudoers 文件中配置了特定的主机限制（非 ALL 且非当前主机）

**POC 可用性:** 4/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

【POC有效性分析】该漏洞（CVE-2025-32462）存在于 Sudo 实用程序中。当 sudoers 文件配置了特定的主机名限制时，Sudo 在处理逻辑上存在缺陷。正常情况下，如果 sudoers 指定了命令仅能在特定主机（非当前主机）执行，本地用户不应能运行该命令。然而，漏洞允许列出的用户通过特定的参数绕过这一限制。提供的 C 语言 POC 代码本质上是一个简单的封装器，它通过提示用户输入目标主机和命令，并调用 `system()` 函数执行 `sudo -h [host] [command]`。从技术角度看，此 POC 的有效性取决于目标系统的 sudoers 配置是否符合受影响的特定模式。如果环境配置正确（即存在限制性的 Host 别名），该 POC 可以通过 `-h` 参数触发 Sudo 的逻辑错误，从而在不应获得权限的主机环境中尝试执行提权操作。但该代码本身并未实现复杂的溢出或逻辑绕过算法，仅作为命令行调用的演示。在现代 Linux 发行版中，默认的 sudoers 配置通常为 ALL，因此该漏洞的影响范围局限于特定企业级复杂配置环境。利用步骤如下：1. 编译 Exploit.c 文件；2. 运行生成的二进制文件；3. 根据提示输入在 sudoers 中配置的非本地主机名；4. 输入希望以 root 权限运行的命令。如果系统易受攻击，Sudo 将错误地允许在当前主机上执行该命令。【投毒风险分析】经过对提供的 C 源代码进行静态扫描和人工审计，未发现任何恶意行为。代码中仅使用了标准库函数（stdio.h, stdlib.h, string.h），没有包含任何混淆代码、外部下载逻辑、敏感信息嗅探或反弹 Shell 等典型投毒特征。程序的核心逻辑是透明的字符串拼接与系统调用。其行为完全符合安全研究人员用于验证漏洞的合法工具范畴。由于代码量极小且逻辑直观，攻击者难以在其中隐藏后门而不被察觉。因此，该 POC 的投毒风险极低（5%），主要风险仅在于其作为提权工具可能被未经授权的人员用于非法目的。建议在隔离的沙箱环境中编译和运行此类代码，并始终在执行前检查 `system()` 函数调用的参数安全性，防止在编译环境中引入意外的侧向移动。

**项目地址:** 本地文件路径: /tmp/vulnwatchdog_7b3b89ba19b994befdaee03e3c772053/Exploit.c

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32462](https://nvd.nist.gov/vuln/detail/CVE-2025-32462)
