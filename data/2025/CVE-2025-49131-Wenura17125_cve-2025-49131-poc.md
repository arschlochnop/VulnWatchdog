## CVE-2025-49131 - FastGPT (fastgpt-sandbox container) 沙箱逃逸 (Sandbox Escape)

**漏洞编号:** CVE-2025-49131

**漏洞类型:** 沙箱逃逸 (Sandbox Escape)

**影响应用:** FastGPT (fastgpt-sandbox container)

**危害等级:** 中危 (Medium)

**CVSS评分:** 6.3 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L)

**影响版本:** < 4.9.11

**利用条件:** 需要具备基础用户权限 (PR:L)，能够访问并向 FastGPT 发送需要 Python 执行的请求或指令。

**POC 可用性:** 4/10

**POC 类型:** 概念验证 (POC)

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

【POC有效性分析】该漏洞存在于 FastGPT 的 fastgpt-sandbox 容器组件中，属于典型的 Python 环境沙箱限制不严导致的逃逸问题。通过分析 POC 文档可知，受影响版本的 FastGPT 在处理 Python 代码执行时，未能在底层对 Python 内建函数（Builtins）进行严格隔离。POC 指出，攻击者可以通过特定的绕过技巧（如利用 __builtins__ 的引用或特定的类继承链 __subclasses__）重新获取被禁用的危险模块，如 os 或 subprocess。由于 sandbox 容器未对危险系统调用（Syscalls）进行拦截，一旦逃逸成功，攻击者将获得该容器上下文的文件系统读写权限。从 POC 提供的 README 信息看，该漏洞利用逻辑清晰，但在实际生产环境中，其有效性取决于容器内是否部署了额外的安全增强工具（如 Seccomp 或 AppArmor）。目前 POC 仅提供了结构化说明和部分代码片段，需要研究人员自行复现绕过逻辑。【利用步骤】1. 确定目标 FastGPT 实例版本是否低于 4.9.11。2. 登录具有执行权限的用户账号。3. 在自定义代码执行模块或对话请求中，构造恶意 Python 代码片段，尝试访问 __builtins__ 或通过反射机制绕过 import 限制。4. 使用绕过后的句柄调用系统命令，例如执行 `ls /` 或 `cat /etc/passwd` 进行敏感文件读取。5. 尝试向容器内写入持久化脚本或进行内网嗅探。【投毒风险分析】当前获取到的 POC 信息主要来源于 README 示例文档，并未包含复杂的二进制负载或经过混淆的攻击脚本。然而，鉴于该漏洞涉及 FastGPT 这一流行的 AI 应用框架，在 GitHub 或其他技术社区（如搜索结果中提到的 fearsoff-org 仓库）中，不排除存在被恶意修改的 EXP 脚本。典型的投毒风险包括：1. 伪装成利用工具的 Python 脚本，在执行时会静默收集攻击者的系统环境变量、API 密钥并上传至远程服务器。2. 利用开发者复现漏洞的急迫心理，在所谓的 'Automated EXP' 中植入反弹 Shell 代码，使研究人员的机器反被控制。3. 搜索结果中出现的 CSDN 链接（CVE-2025-49131 的更多内容）常伴随广告或需要积分下载的工具，此类文件可能携带恶意捆绑包。经评估，目前的纯文档形式 POC 投毒风险较低（约 10%），但若下载并运行来自非官方仓库的 .py 或 .sh 脚本，风险将迅速上升。

**项目地址:** [https://github.com/fearsoff-org/CVE-2025-49113](https://github.com/fearsoff-org/CVE-2025-49113)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49131](https://nvd.nist.gov/vuln/detail/CVE-2025-49131)
