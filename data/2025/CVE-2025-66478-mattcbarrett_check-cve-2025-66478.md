## CVE-2025-66478 - Next.js RCE

**漏洞编号:** CVE-2025-66478

**漏洞类型:** RCE

**影响应用:** Next.js

**危害等级:** Critical

**CVSS评分:** 10.0

**影响版本:** Unknown, requires upgrade to patched versions

**利用条件:** Unauthenticated remote access

**POC 可用性:** 7/10

**POC 类型:** Complete exploit

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2025-66478 is a critical remote code execution (RCE) vulnerability affecting Next.js applications, stemming from insecure deserialization within the React Server Components (RSC) architecture, specifically within the Flight protocol. The vulnerability is located in the react-server package and its implementation of the RSC Flight protocol.

The provided POC code consists of a bash script (`check_cve-2025-66478.sh`) and a README file. The script checks if a given Next.js server is vulnerable by sending a crafted HTTP POST request with specific headers and data. The request is designed to trigger the insecure deserialization vulnerability. The script analyzes the response body for a specific string ('E{"digest"') which indicates that the server is likely vulnerable.

**POC有效性分析:**
The POC is relatively simple but effective. It automates the process of sending a malicious request and checking for a specific indicator in the response. The script uses `curl` to send the request, making it easy to execute. The script also includes basic error handling and color-coded output to indicate the vulnerability status. The effectiveness of the POC relies on the accuracy of the 'E{"digest"' string as a reliable indicator of the vulnerability. Searchlight's research is used to validate the exploit; thus, assuming their research is valid will allow a user to detect the vulnerability. The use of HTTP headers such as `Next-Action`, `X-Nextjs-Request-Id`, `Next-Router-State-Tree`, `Content-Type`, and `X-Nextjs-Html-Request-Id` suggests that the vulnerability is related to how Next.js handles RSC requests and data serialization.

**利用步骤:**
1. Download the `check_cve-2025-66478.sh` script.
2. Make the script executable: `chmod +x check_cve-2025-66478.sh`.
3. Run the script with the target URL as an argument: `./check_cve-2025-66478.sh https://target.example.com`.
4. The script will print the HTTP status code and indicate whether the host appears vulnerable based on the response body.
5. If the host is vulnerable, the script will also print the response body for further analysis.

**投毒风险分析:**
The provided POC code has a low poisoning risk. The script is relatively simple and does not contain any obfuscated or malicious code. The script only sends an HTTP request and analyzes the response. The main risk is that the script relies on `curl`, which could potentially be modified or replaced with a malicious version on the target system. However, this is a general risk associated with using any external command-line tool. The script also includes a User-Agent string ('Assetnote/1.0.0') that identifies the tool, which could be used to track its usage. The risk associated with external dependencies is low, since `curl` is a standard tool. Additionally, the reliance on a specific string for vulnerability detection could lead to false positives or false negatives if the server response is modified or if the vulnerability manifests differently in different environments. The script does not execute any code on the target system, which further reduces the risk of poisoning. The fact the code is primarily a shell script and uses standard libraries indicates a low likelihood of malicious activity. The script's purpose is to check for a vulnerability, not to exploit it directly.

**项目地址:** https://github.com/random-user/random-repo (This is a placeholder, the real repo wasn't provided)

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-66478
