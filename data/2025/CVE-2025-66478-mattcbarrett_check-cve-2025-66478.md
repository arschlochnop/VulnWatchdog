## CVE-2025-66478 - Next.js RCE

**漏洞编号:** CVE-2025-66478

**漏洞类型:** RCE

**影响应用:** Next.js

**危害等级:** 高危

**CVSS评分:** 10.0

**影响版本:** 受影响版本范围未知，项目使用AppRouter+RSC时极有可能默认处于风险之下

**利用条件:** 无需任何权限，只需要一次特制请求

**POC 可用性:** 7/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-66478 是 Next.js 框架中的一个高危远程代码执行 (RCE) 漏洞。根据搜索结果，该漏洞的 CVSS 评分为 10.0，属于最高级别。这意味着攻击者几乎无需任何权限，只需发送一次特制的 HTTP 请求，即可在服务器上执行任意代码。该漏洞主要影响使用 AppRouter 和 RSC（React Server Components）的 Next.js 项目。

POC 代码分析:
POC 代码是一个 bash 脚本，用于检测 Next.js 服务器是否存在 CVE-2025-66478 漏洞。该脚本通过发送包含特定 Header 的 POST 请求到目标 URL，并检查响应内容是否包含特定的字符串 "E{\"digest\"". 如果响应包含该字符串，则认为目标服务器存在漏洞。该脚本使用了 curl 命令来发送 HTTP 请求，并使用 grep 命令来检查响应内容。脚本的逻辑较为简单，易于理解和使用。请求中的关键Header包括 "Next-Action: x", "X-Nextjs-Request-Id: b5dce965", "Next-Router-State-Tree", "Content-Type: multipart/form-data", "X-Nextjs-Html-Request-Id"，以及构造的form-data内容。这些header和数据是触发漏洞的关键。

利用步骤:
1.  运行 check_cve-2025-66478.sh 脚本，并提供目标 Next.js 服务器的 URL 作为参数。
2.  脚本将发送包含特定 Header 的 POST 请求到目标 URL。
3.  脚本检查响应内容是否包含特定的字符串 "E{\"digest\"".
4.  如果响应包含该字符串，则表明目标服务器存在漏洞。
5.  如果目标服务器存在漏洞，攻击者可以利用该漏洞在服务器上执行任意代码。

根据POC验证结果，漏洞利用的关键在于构造特定的HTTP请求头和请求体，如果目标服务器返回包含 "E{\"digest\" 的响应，则表示可能存在RCE漏洞。

投毒风险分析(400-600字):
该POC脚本的投毒风险较低。脚本主要使用了 curl 和 grep 等标准 Linux 命令，没有执行任何可能导致恶意行为的操作。脚本没有包含任何混淆代码或外部脚本，代码可读性高，易于审计。此外，该脚本的目的是检测漏洞，而不是利用漏洞，因此不存在直接的攻击行为。

然而，仍然存在一些潜在的投毒风险：
1.  攻击者可能会修改该脚本，添加恶意代码，例如，在检测到漏洞后，自动执行恶意命令。但因为脚本内容简单，这种修改容易被发现。
2.  攻击者可能会将该脚本与其他恶意脚本捆绑在一起，从而提高攻击的成功率。但本脚本本身的功能单一，捆绑其他恶意脚本会增加复杂度和被检测的风险。
3.  攻击者可能会利用该脚本来扫描大量 Next.js 服务器，从而找到存在漏洞的目标。这是一个信息收集的风险。

总体而言，该POC脚本的投毒风险较低，但仍然需要保持警惕，并采取必要的安全措施，例如，对脚本进行代码审计，确保其不包含恶意代码，以及限制脚本的执行权限。

**项目地址:** https://github.com/lincemorado97/CVE-2025-64446_CVE-2025-58034

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-66478
