## CVE-2025-59287 - Windows Server Update Services (WSUS) RCE (Remote Code Execution) / Insecure Deserialization

**漏洞编号:** CVE-2025-59287

**漏洞类型:** RCE (Remote Code Execution) / Insecure Deserialization

**影响应用:** Windows Server Update Services (WSUS)

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Windows Server 2012, Windows Server 2012 R2, Windows Server 2016 (<= 10.0.14393.8524), Windows Server 2019 (<= 10.0.17763.7922), Windows Server 2022 (<= 10.0.20348.4297), Windows Server 2022 23H2 (<= 10.0.25398.1916), Windows Server 2025 (<= 10.0.26100.6905)

**利用条件:** 攻击者需要能够通过网络访问 WSUS 管理端口（默认 HTTP 8530 或 HTTPS 8531），无需身份验证。

**POC 可用性:** 4/10

**POC 类型:** 概念验证/部分源码分析

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：本报告分析的POC属于深度漏洞分析文档，而非一键式攻击脚本。该漏洞存在于WSUS的Web管理接口中，核心原因是由于不安全地使用了 .NET 的 BinaryFormatter.Deserialize() 函数来处理加密的 cookie 数据。在 DecryptData() 函数中，WSUS 会尝试解密来自客户端的 cookie，随后在解密出的字节流上直接调用反序列化。由于 BinaryFormatter 在反序列化时会将类信息包含在字节流中，攻击者可以通过构造特殊的恶意的序列化 Payload（例如使用 YSOSERIAL.NET 生成的 Gadget 链），在解密并反序列化过程中触发任意代码执行。尽管 POC 中截断了部分具体的解密逻辑代码，但它明确指出了漏洞点在于对解密后的字节流缺乏类型校验。该 POC 具备极高的防御研究价值，通过该分析，研究员可以准确定位受影响的 DLL 文件（通常是 Microsoft.UpdateServices.Internal.Cookie 相关的处理程序）并编写检测规则。利用步骤：1. 识别目标 WSUS 服务器的开放端口（8530/8531）；2. 构造包含恶意反序列化 Payload 的字节数组；3. 模仿 WSUS 的加密逻辑（或寻找已知的加密密钥泄露点/逻辑缺陷）对 Payload 进行加密封装；4. 将加密后的数据注入到 HTTP 请求的 Cookie 或相关 SOAP 头部中发送给 WSUS 服务器；5. 服务器端的 DecryptData 触发并执行代码。投毒风险分析：该 POC 提供的形式为技术分析文档（Markdown 格式），其本身不包含经过混淆的可执行二进制文件或自动化投毒脚本。代码片段均为 C# 源码片段，用于说明漏洞原理，逻辑清晰，无恶意外部请求或 eval 注入。然而，由于此类高价值 RCE 漏洞通常会吸引恶意软件开发者利用其原理编写蠕虫病毒，防范重点在于后续出现的自动化工具。当前分析文档风险极低，仅 15%，主要源于其描述的利用技术可能被攻击者快速武器化。建议防御人员重点监控 WSUS 进程（如 w3wp.exe 承载的 WSUS 应用程序池）的异常子进程创建行为，并及时应用 Microsoft 发布的高外版本（Out-of-band）安全更新 KB5070882 或更高版本。

**项目地址:** 无（基于 VulnWatchdog 内部研究文档）

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)
