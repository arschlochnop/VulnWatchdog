## CVE-2025-68613 - n8n (开源工作流自动化平台) RCE (远程代码执行)

**漏洞编号:** CVE-2025-68613

**漏洞类型:** RCE (远程代码执行)

**影响应用:** n8n (开源工作流自动化平台)

**危害等级:** CRITICAL

**CVSS评分:** 9.9

**影响版本:** 0.211.0 <= version < 1.120.4, 1.121.1, 1.122.0

**利用条件:** 需要认证的用户权限（Authenticated）

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该POC是一个基于Nuclei框架的YAML自动化利用脚本，其逻辑设计非常完整且具有极高的实战价值。脚本通过四个核心步骤实现攻击闭环：1. 认证阶段：通过POST /rest/login接口使用提供的凭证获取会话；2. 注入阶段：利用n8n工作流表达式评估系统的缺陷，创建一个包含恶意JavaScript代码的工作流。具体Payload通过Node.js的process对象（如this.process.platform）提取系统敏感信息，这证明了表达式执行上下文并未被完全隔离；3. 执行阶段：调用/api/v1/workflows/run接口触发工作流，迫使服务器执行注入的代码；4. 清理阶段：自动删除创建的恶意工作流以隐藏踪迹。该POC不仅能验证漏洞存在（通过匹配platform和nodeVersion），还展示了如何通过受控的表达式沙箱逃逸获取系统级信息。利用步骤：首先，攻击者需获取目标n8n实例的有效登录凭证（邮箱与密码）。其次，配置Nuclei变量并运行该YAML模板。脚本将自动完成登录、创建恶意工作流（注入包含JS代码的Set节点）、触发工作流运行并捕获返回的系统环境数据（如操作系统类型、Node版本、当前目录），最后执行删除操作。投毒风险分析：该POC代码本身结构清晰，完全遵循Nuclei模板的标准规范，没有发现恶意混淆、外部非法反连或隐藏的二进制文件下载行为。其核心Payload `(function() { return this.process.platform; })()` 仅用于读取系统属性以证明RCE的可能性，属于典型的无害化漏洞验证行为。脚本中的cookie-reuse和req-condition设置表明其是一个成熟的测试工具而非恶意软件。虽然该POC由第三方‘intelligent-ears’编写，但其行为完全透明，可审计。风险点仅在于其自动化清理逻辑（DELETE操作），在某些极端不稳定的环境下可能导致审计日志缺失，但整体投毒风险极低，评估为15%，主要源于其对敏感系统变量的读取能力，而非代码本身的投毒属性。

**项目地址:** 本地存储路径: /tmp/vulnwatchdog_99be4c942142a0888887c3392e44077f/CVE-2025-68613-exploit.yaml

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-68613](https://nvd.nist.gov/vuln/detail/CVE-2025-68613)
